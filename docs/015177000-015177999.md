# StackOverflow 问答 15177000-15177999

# python - 如果管理员在 Django 中创建了事件，我如何通知用户？

> ID：15177002
> 
> 赞同：0
> 
> 时间：2013-03-02T16:55:21.663
> 
> 标签：python, django

我们目前正在为某个组织开发一个系统。其中一项要求是在管理员创建事件时通知用户。不应通过电子邮件通知所有站点用户，而应通过类似于 Facebook 通知的方式通知所有站点用户。如何在不使用 Django 通知、Django 活动流等的情况下在 Django 中实现此类功能。我们是 Django 的新手，我们希望尽可能简单地实现此类功能。我希望你能帮助我们解决这个问题。谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T07:24:58.977

> @Zayatzz 我们计划通知用户一次。但在用户查看通知后，他/她仍然可以稍后查看。

在这种情况下，您可能需要在管理员中创建通知对象。对象可能需要是这样的：

```
class Notification(models.Model):
  message = models.TextField()
  type = models.IntegerField()
  relevancy_end_date = models.DateField()
  notified_users = models.ManyToManyField(django.contrib.auth.User, null = True) 
```

在您的管理表单中，您需要覆盖该 models.IntegerField 以获得带有选择的小部件。您可以从中获得的选择：

[https://docs.djangoproject.com/en/dev/ref/contrib/messages/#creating-custom-message-levels](https://docs.djangoproject.com/en/dev/ref/contrib/messages/#creating-custom-message-levels)

它们基本上是数字，10、20、30、40、50。

在视图中，您可以检查是否有应通知用户的通知：

```
notes = Notification.objects.filter(notified_users__id = request.user.id).filter(relevancy_end_date__gte = datetime.datetime.now()) 
```

如果有任何通知，请使用 djanogs 自己的消息框架创建消息：

```
from django.contrib import messages
if notes:
    for note in notes:
        messages.add_message(request, note.type, 'Hello world.')
        note.notified_users.add(request.user) 
```

它是什么类型的消息（信息、错误、成功）保存在您的通知类型列中。所以是的 - 你需要在那里添加某种检查，根据通知类型改变消息类型。

将该块写入要显示消息的每个视图的开头并不是很干。因此，您应该为此创建自己的视图装饰器。

这两个链接应该可以帮助您做到这一点： [https://docs.djangoproject.com/en/dev/topics/http/decorators/](https://docs.djangoproject.com/en/dev/topics/http/decorators/) [How create decorator in Django for decorating view](https://stackoverflow.com/questions/11817854/how-create-decorator-in-django-for-decorating-view)

现在在这一点上。如果有消息需要通知用户 - 它在由消息框架处理的请求中。要在视图中显示它，您需要这样做： [https ://docs.djangoproject.com/en/dev/ref/contrib/messages/#displaying-messages](https://docs.djangoproject.com/en/dev/ref/contrib/messages/#displaying-messages)

或者。就像 Brandon 说的那样——如果您还希望通过 ajax/json 调用传递消息，那么您需要“手动”处理它们并将它们插入到 json 响应中。像这样的东西：

[https://docs.djangoproject.com/en/dev/ref/contrib/messages/#expiration-of-messages](https://docs.djangoproject.com/en/dev/ref/contrib/messages/#expiration-of-messages)

```
from django.utils import simplejson
feedback = messages.get_messages(request)
for message in feedback:
    response[message.tags] = response.get(message.tags, [])
    message_text = smart_str(message.message, encoding='utf-8', strings_only=True)
    response[message.tags].append(message_text)
return simplejson.dumps(response) 
```

拥有 Notification 对象后，拥有视图装饰器，然后您只需要创建一个视图来向用户显示他已显示的通知。我相信您可以弄清楚如何创建该查询。

您还可以调整此 Notification 类以使用额外的布尔字段或 relevancy_end_date 字段。使打开或关闭它更容易。

注意！这段代码完全未经测试，可能会给出一些错误，但它能让你朝着正确的方向前进，我认为根据你的输入判断，这可能最适合你。

艾伦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T01:16:10.397

所以，我真的只能给你一些大致的方向，因为我不知道细节，但基本上你可以做这样的事情：

首先，我会为您的管理类的 save_model() 方法添加一个覆盖。在这里您可以检查您的对象是否有主键。如果没有，您可以设置一个标志来创建事件（不确定您是否还需要通过外键将您的事件与通知相关联。

如果您不需要在事件和通知之间建立关联，则可以跳过设置标志，只需在需要时创建通知对象。

其次，创建一个为您的事件返回 JSON 的视图。我不确定您需要如何过滤这些对象。是否仅适用于登录用户等，但您只想返回以前未查看过的用户。

第三，通过 ajax 在间隔内调用视图，传入过滤结果并记录已查看通知所需的任何标准。

希望这能让你继续前进。

# javascript - MongoDB - JSON“所有者”：{“$id”：“511e152bd482f6bd1e000000”}

> ID：15177004
> 
> 赞同：0
> 
> 时间：2013-03-02T16:55:36.390
> 
> 标签：javascript, json, mongodb, cordova, jsonp

我正在创建一个 iPhone 应用程序，我需要将它从 PHP 数组转换为 JSON

现在我想知道一旦我在 JSON 格式中拥有它，我如何告诉 javascript 获取所有者 ID

```
"owner":{"$id":"511e152bd482f6bd1e000000"}

xmlhttp=new XMLHttpRequest();
    xmlhttp.open("POST","http://service.ipetfindr.com/iOS/?uri=fetchpet/" + n[1],false);
    xmlhttp.send();

    var petJSON = JSON.parse(xmlhttp.responseText);
navigator.notification.alert(petJSON[0].owner); 
```

谢谢

编辑

我最终让它工作了

```
petJSON[0].owner.$id 
```

# symfony - 教义实体多对一关系

> ID：15177005
> 
> 赞同：1
> 
> 时间：2013-03-02T16:55:48.623
> 
> 标签：symfony, orm, doctrine-orm, doctrine

我想知道，什么是最好的解决我的问题：

我有两个实体： Cattery 和 Cat。Cattery 实体有两个属性：Cats 和 Kittens。每个属性都有类型，对于 Cats Cat.type = 'Cat'，Kitten.type = 'kitten'。

如何描述这种关系？现在我只使用两个方法，getCats()、getKittens()，其中使用 foreach 方法比较每种猫类型，并返回猫/小猫数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T16:59:33.497

如果您想到数据库，为什么不拥有三个类和表

*   柑橘
*   猫
*   小猫（可能继承自猫）

您的 Cittery 课程将有两种方法，例如

```
getCats 
```

和

```
getKitten 
```

所以你不需要处理任何类型。一个 cittery 对象将容纳两组不同的猫和小猫。

# android - 循环填充数组以在 listview 中使用（从 txt 文件字符串填充数组）

> ID：15177013
> 
> 赞同：0
> 
> 时间：2013-03-02T16:56:31.650
> 
> 标签：android, android-listview, android-arrayadapter

我正在尝试填充一个数组以在 android 的列表视图中使用。我希望数组填充存储在 sdcard 上的几个 .txt 文件中的数据。我有一个 Int 名称 Mx，它告诉循环运行多少次（这就是我想要它做的）。值 Mx 也是数组中所需的条目数。

我目前正在使用此代码，但它不起作用：

```
 public void arrayload() {
        ///////////////////////////////////working here///////////////////////////////// 
         //new looping code
         for (int i=1; i<=Mx; i++){
                try{
                     String fileName = String.valueOf(i) +".txt";   
                     File myFile = new File("/sdcard/mx/" +fileName);
                     FileInputStream fIn = new FileInputStream(myFile);
                        BufferedReader myReader = new BufferedReader(
                                new InputStreamReader(fIn));
                        String aDataRow = "";
                        String aBuffer = "";
                        while ((aDataRow = myReader.readLine()) != null) {
                            aBuffer += aDataRow + "\n";
                        }
                String[] lvdata = new String[Mx];
                lvdata[i] = aBuffer;
                ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.logbooklayout, lvdata);
                   lv1.setAdapter(adapter);
                   lv1.scrollTo(0, mxlv); // set the listview at a sensible point
                }
                 catch (Exception e) {
                        Toast.makeText(getBaseContext(), e.getMessage(),
                                Toast.LENGTH_SHORT).show();
                    }
         } 
```

我之前一直在将每个条目硬编码到数组中，但我正在尝试整理代码，以便它根据值 Mx 循环。我知道如果我手动填充数组和列表视图工作正常，当我使用应用程序崩溃下方的代码时。

Logcat 输出为

```
03-02 16:41:23.888: E/AndroidRuntime(31497): FATAL EXCEPTION: main
03-02 16:41:23.888: E/AndroidRuntime(31497): java.lang.NullPointerException
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:394)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.ArrayAdapter.getView(ArrayAdapter.java:362)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.AbsListView.obtainView(AbsListView.java:2159)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.ListView.measureHeightOfChildren(ListView.java:1246)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.ListView.onMeasure(ListView.java:1158)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.View.measure(View.java:15513)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.RelativeLayout.measureChildHorizontal(RelativeLayout.java:645)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:425)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.View.measure(View.java:15513)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.View.measure(View.java:15513)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.LinearLayout.measureVertical(LinearLayout.java:847)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.LinearLayout.onMeasure(LinearLayout.java:588)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.View.measure(View.java:15513)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:4827)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.widget.FrameLayout.onMeasure(FrameLayout.java:310)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at com.android.internal.policy.impl.PhoneWindow$DecorView.onMeasure(PhoneWindow.java:2176)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.View.measure(View.java:15513)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewRootImpl.performMeasure(ViewRootImpl.java:1874)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewRootImpl.measureHierarchy(ViewRootImpl.java:1089)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1265)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:989)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4351)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.Choreographer.doCallbacks(Choreographer.java:562)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.Choreographer.doFrame(Choreographer.java:532)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.os.Handler.handleCallback(Handler.java:725)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.os.Handler.dispatchMessage(Handler.java:92)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.os.Looper.loop(Looper.java:137)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at android.app.ActivityThread.main(ActivityThread.java:5191)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at java.lang.reflect.Method.invokeNative(Native Method)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at java.lang.reflect.Method.invoke(Method.java:511)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
03-02 16:41:23.888: E/AndroidRuntime(31497):    at dalvik.system.NativeStart.main(Native Method) 
```

对此的任何帮助都非常受欢迎。我只是在使用 Java，所以我的代码需要改进很多！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:10:20.723

试试这个 ！

```
public void arrayload() {
        ///////////////////////////////////working here///////////////////////////////// 

     String[] lvdata = new String[Mx];

     for (int i=0 ; i < Mx ;i++){
        lvdata[i]="";
     }

         for (int i=0; i<Mx; i++){
                try{
                     String fileName = String.valueOf(i) +".txt";   
                     File myFile = new File("/sdcard/mx/" +fileName);
                     FileInputStream fIn = new FileInputStream(myFile);
                        BufferedReader myReader = new BufferedReader(
                                new InputStreamReader(fIn));
                        String aDataRow = "";
                        String aBuffer = "";
                        while ((aDataRow = myReader.readLine()) != null) {
                            aBuffer += aDataRow + "\n";
                        }

                lvdata[i] = aBuffer;

                }
                 catch (Exception e) {
                        Toast.makeText(getBaseContext(), e.getMessage(),
                                Toast.LENGTH_SHORT).show();
                }
     }  
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, R.layout.logbooklayout, lvdata);
    lv1.setAdapter(adapter);
        lv1.scrollTo(0, mxlv); // set the listview at a sensible point
} 
```

您的代码中有两个问题：

*   首先，您将在每个循环中填充的数组实例化。所以想象 Mx=3 i =2，因为你只是在 lvDate[2] 中输入了一个值，所以 lvdata[0] 和 lvdata[1] 为空，因此为 NullpointerException。
*   其次，您也实例化每个循环的适配器。

尝试使用 Logcat 而不是 Toast "Log.e(tag, msg, tr)" 你可以直接传递你的异常。

希望它会有所帮助

# c++ - C++数组分配分段错误11新手

> ID：15177018
> 
> 赞同：1
> 
> 时间：2013-03-02T16:57:21.217
> 
> 标签：c++, memory-management, segmentation-fault, sieve-of-eratosthenes

我正在从 Robert Sedgewick 的 C++ 算法中学习 C++。现在，我正在研究 Eratosthenes 筛，用户指定了最大素数的上限。当我以最大 46349 运行代码时，它会运行并打印出最多 46349 的所有素数，但是当我以最大 46350 运行代码时，会发生分段错误。有人可以帮忙解释为什么吗？

```
./sieve.exe 46349
 2 3 5 7 11 13 17 19 23 29 31 ...

./sieve.exe 46350
 Segmentation fault: 11 
```

代码：

```
#include<iostream>

using namespace std;

static const int N = 1000;

int main(int argc, char *argv[]) {
    int i, M;

    //parse argument as integer
    if( argv[1] ) {
        M = atoi(argv[1]);
    }

    if( not M ) {
        M = N;
    }

    //allocate memory to the array
    int *a = new int[M];

    //are we out of memory?
    if( a == 0 ) {
        cout << "Out of memory" << endl;
        return 0;
    }

    // set every number to be prime
    for( i = 2; i < M; i++) {
        a[i] = 1;
    }

    for( i = 2; i < M; i++ ) {
        //if i is prime
        if( a[i] ) {
            //mark its multiples as non-prime
            for( int j = i; j * i < M; j++ ) {
                a[i * j] = 0;
            }
        }
    }

    for( i = 2; i < M; i++ ) {
        if( a[i] ) {
            cout << " " << i;
        }    
    }
    cout << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T17:01:41.657

你在这里有整数溢出：

```
 for( int j = i; j * i < M; j++ ) {
            a[i * j] = 0;
        } 
```

`46349 * 46349`不适合`int`.

在我的机器上，将类型更改为`j`可以`long`为更大的输入运行程序：

```
 for( long j = i; j * i < M; j++ ) { 
```

根据您的编译器和架构，您可能必须使用`long long`才能获得相同的效果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T17:05:20.903

当您使用调试器运行程序时，您会看到它在

```
a[i * j] = 0; 
```

`i * j`溢出并变为负数。这个负数小于`M`，这就是它再次进入循环然后访问失败的原因`a[-2146737495]`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T17:01:06.200

我明白了，问题在于将 M 声明为 int。当我声明 i,M 和 j 时，这似乎工作正常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T17:01:07.057

在任何相当现代的 C++ 中，如果分配失败，您将不会从 new 返回空指针，除非您使用非抛出 new。您的代码的那部分不会像您期望的那样工作 - 您必须捕获`std::bad_alloc`可能从调用中发出的内容`new`。

您还想将数组索引声明为 type `size_t`。

# cuda - Cuda program does not give the correct output when using a CUDA compatible GPU

> ID：15177019
> 
> 赞同：0
> 
> 时间：2013-03-02T16:57:21.333
> 
> 标签：cuda, gpu

I found the following program from [http://llpanorama.wordpress.com/2008/05/21/my-first-cuda-program/](http://llpanorama.wordpress.com/2008/05/21/my-first-cuda-program/)

Unfortunately I can't copy paste it here because the code becomes messy

It takes as input a vector of numbers and then gives as an output the vector multiplied by itself, I run it on the emulator that I have installed on my computer and it gives the following output:

```
0 0.000000
1 1.000000
2 4.000000
3 9.000000
4 16.000000
5 25.000000
6 36.000000
7 49.000000
8 64.000000
9 81.000000 
```

however if I decide to run it on a remote computer which runs debian and has cuda compatible gpu by entering

```
nvcc test.cu -lcudart -o test
./test 
```

it gives me the following output

```
0 0.000000
1 1.000000
2 2.000000
3 3.000000
4 4.000000
5 5.000000
6 6.000000
7 7.000000
8 8.000000
9 9.000000 
```

why does this happen? Thank you in advance!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:06:48.020

The problem is that code has no error checking, and there is something wrong with the remote computer. Add [error checking](https://stackoverflow.com/questions/14038589/what-is-the-canonical-way-to-check-for-errors-using-the-cuda-runtime-api) to that code (it's not hard to do), re-run it, and then see what happens. If you still have trouble, report back.

Here is the code suitably modified with error checking:

```
// example1.cpp : Defines the entry point for the console application.
//

#include <stdio.h>
#include <cuda.h>

#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

// Kernel that executes on the CUDA device
__global__ void square_array(float *a, int N)
{
  int idx = blockIdx.x * blockDim.x + threadIdx.x;
  if (idx<N) a[idx] = a[idx] * a[idx];
}

// main routine that executes on the host
int main(void)
{
  float *a_h, *a_d;  // Pointer to host & device arrays
  const int N = 10;  // Number of elements in arrays
  size_t size = N * sizeof(float);
  a_h = (float *)malloc(size);        // Allocate array on host
  cudaMalloc((void **) &a_d, size);   // Allocate array on device
  cudaCheckErrors("cudaMalloc fail");
  // Initialize host array and copy it to CUDA device
  for (int i=0; i<N; i++) a_h[i] = (float)i;
  cudaMemcpy(a_d, a_h, size, cudaMemcpyHostToDevice);
  cudaCheckErrors("cudaMemcpy 1 fail");
  // Do calculation on device:
  int block_size = 4;
  int n_blocks = N/block_size + (N%block_size == 0 ? 0:1);
  square_array <<< n_blocks, block_size >>> (a_d, N);
  cudaDeviceSynchronize();
  cudaCheckErrors("kernel fail");
  // Retrieve result from device and store it in host array
  cudaMemcpy(a_h, a_d, sizeof(float)*N, cudaMemcpyDeviceToHost);
  cudaCheckErrors("cudaMemcpy 2 fail");
  // Print results
  for (int i=0; i<N; i++) printf("%d %f\n", i, a_h[i]);
  // Cleanup
  free(a_h); cudaFree(a_d);

} 
```

# coronasdk - CoronaSDK 内容缩放问题

> ID：15177024
> 
> 赞同：0
> 
> 时间：2013-03-02T16:57:59.697
> 
> 标签：coronasdk

我在 iPhone3g、iPhone 4 和 iPhone 5 之间缩放时遇到问题。我在这里使用了终极配置文件[http://www.coronalabs.com/blog/2012/12/04/the-ultimate-config-lua-文件/](http://www.coronalabs.com/blog/2012/12/04/the-ultimate-config-lua-file/)我正在使用以下方法设置背景图像：

```
bgimage = display.newImageRect("images/moonbase.png", 570, 360)
bgimage:setReferencePoint( display.CenterReferencePoint )
bgimage.x = _W / 2
bgimage.y = _H / 2 
```

我正在开发敌人的游戏的一部分遵循一条路径，为了绘制它，我创建了一条线并使用了贝塞尔插件。您将从以下屏幕截图中看到路径和卫星位于错误的位置。我怎样才能让这些在设备上是相同的？只有 zoomstretch 似乎有效，但图像质量下降。

截图： http: [//lukestirk.com/screen_resolution.png](http://lukestirk.com/screen_resolution.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:08:17.330

我的猜测是你的贝塞尔插件应该被“意识到”

```
display.contentHeight 
```

并且应该从 config.lua 文件中删除固定的 width=x,height=y 设置

# android - Android 在文本视图中查看数组列表

> ID：15177028
> 
> 赞同：0
> 
> 时间：2013-03-02T16:58:24.510
> 
> 标签：android, textview

我有一个具有文本输入和按钮的程序。当我在输入中输入内容并按下按钮时，我希望`String`将其添加到 a`String Arraylist`并`Arraylist`显示在 a 中`TextView`。现在我有一个方法：

```
public void addString(View view)
{
    EditText editText = (EditText) findViewById(R.id.edit_choice);
    String message = editText.getText().toString();
    choices.add(message);
} 
```

*“edit-choices”*是文本输入的名称，*“choices”*是数组列表的名称。首先，我这样做正确吗？其次，如何让文本视图显示“选择”的内容。现在我的`TextView`id只是`textView1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:14:48.027

请记住，这不是在`TextView`. 您可以使用`ListView`. 无论如何，请参阅下面的伪代码（没有在 Eclipse 中测试，但是，它应该显示它基本上是如何工作的）：

```
public class YourActivity extends Activity {

  Vector<String> choices = new Vector<String>();

  public void onCreate(Bundle ....) {
    (Button) myButton =  (Button) findViewById(R.id.button);

    myButton.setOnClickListener(new OnClickListener() {
        @Override
        public boolean button.onClick() {
          addString();
          TextView textView = (TextView) findViewById(R.id.text_view);

          String listRepresentation = "";
          for (String choice : choices)
            if ("".equals(listRepresentation))
              listRepresentation  =       choice; else 
              listRepresentation  = ", " +choice;

          textView.setText(listRepresentation );
        }
     });
  }

  public void addString(View view)
  {
    EditText editText = (EditText) findViewById(R.id.edit_choice);
    String message = editText.getText().toString();
    choices.add(message);
  }
} 
```

因此，只需为您的按钮分配一个`OnClickListener`即可完成您需要的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:09:17.817

问题是您希望如何显示文本......无论是列表视图还是普通文本。如果你想在文本视图中将文本显示为普通文本，你可以简单地做这样的事情。

```
for(String msg : choices)
{
textView1.setText(textView1.getText()+msg);
} 
```

如果您希望在列表视图中显示选项，则需要使用您拥有的选项将适配器设置为列表视图。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-02T17:09:22.580

> 首先，我这样做正确吗？

如果它对你有用，当然。我可能会缓存它，`EditText`这样您就不必每次想要访问它的内容时都“找到”它。

* * *

您唯一的“问题”是， a`TextView`没有接受 a 的方法`List<String>`。因此，您需要从字符串列表中创建一个*字符串*。

您可以简单地遍历列表并将它们组合在一起：

```
StringBuilder b = new StringBuilder();
for (String s : choices){
  b.append(s+"\n");
}
textview.setText(b.toString()); 
```

这将简单地从列表中的所有项目构建一个字符串，在每个项目后添加换行符。

您需要将`TextView`'s [`android:inputType`-attribute](http://developer.android.com/reference/android/widget/TextView.html#attr_android%3ainputType)设置为`textMultiLine`，因此它实际上会显示多行。

# javascript - Javascript - 使用选项替换文本

> ID：15177035
> 
> 赞同：-1
> 
> 时间：2013-03-02T16:58:59.847
> 
> 标签：javascript, html, dom

我正在尝试替换文本“JSON String Here”，但是当我从选项中选择一个项目时，它会消失。我是 Javascript 编程新手，有人可以看看这个吗？谢谢！

```
<title>Local Testing</title>

 <script>

    function swapJson(){

      var div = document.getElementById("jsonToSwap");
      var dropdown = document.getElementById("dd");
      div.src = dropdown.options[dropdown.selectedIndex].value; 
      document.write(div.src);

    };

 </script> 
```

```
<div id="jsonToSwap">JSON String Here</div>

<select id="dd" onChange="swapJson()">
    <option value="1" id="1">Headset</option>
    <option value="2" id="2">Taxi</option>
    <option value="3" id="3">Buildings</option>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:05:30.587

更改读取的行

```
div.src = dropdown.options[dropdown.selectedIndex].value; 
```

对此

```
div.innerText = dropdown.options[dropdown.selectedIndex].value; 
```

所以整个事情看起来像这样

```
<script>

    function swapJson(){

      var div = document.getElementById("jsonToSwap");
      var dropdown = document.getElementById("dd");
      div.innerText = dropdown.options[dropdown.selectedIndex].value;
    };

 </script> 
```

示例
[http://jsfiddle.net/FxwQW/1/](http://jsfiddle.net/FxwQW/1/)

# regex - 正则表达式跳过中间字符

> ID：15177038
> 
> 赞同：0
> 
> 时间：2013-03-02T16:59:44.410
> 
> 标签：regex

给定以下字符串`"Mon Feb 01 02:42:27 +0000 2013"`，正则表达式应该是什么才能获得以下“Feb 01 2013”​​。

以下正则表达式`"\w{3}\s\w{3}\s\d{1,2}"`将产生`"Mon Feb 01"`. 如何编写正则表达式以忽略日期（星期一）和时间和秒？

我在之前的帖子中提出了一个相关问题，社区友好地回答了这个问题 -[无法解析正则表达式中的空格](https://stackoverflow.com/questions/15175768/unable-to-parse-whitespace-in-regex/15175794#15175794)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:04:29.603

这可以工作：

```
(Mon|Tue|Wed|Thu|Fri|Sat|Sun) [a-zA-Z]{3} ([0-9]{2}) ([0-9]{2})\:([0-9]{2})\:([0-9]{2}) \+([0-9]{4}) ([0-9]{4}) 
```

# qt - QTestLib 结果与程序输出不同

> ID：15177039
> 
> 赞同：0
> 
> 时间：2013-03-02T16:59:46.453
> 
> 标签：qt, unicode, qstring, qtestlib

我有一些反转 QString 的简单代码。

```
const QString reverse_qstring(const QString& str_in)
{
    QString out;
    Q_FOREACH(const QChar c, str_in) {
        out.push_front(c);
    }
    return out;
} 
```

当我使用非 ASCII 字符从命令行输入文本时，事情按预期进行：

```
"¿como estás?" :  "?sátse omoc¿" 
```

但是，当我进行以下单元测试（使用 QTestLib）时：

```
QCOMPARE(reverse_qstring(QString("¿como estás?")), QString("?sátse omoc¿")); 
```

我得到：

```
FAIL!  : program::test_qstring() Compared values are not the same
   Actual (reverse_qstring(QString("??como est??s?"))): ?s??tse omoc??
   Expected (QString("?s??tse omoc??")): ?s??tse omoc?? 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T01:36:18.147

我认为您可以为 Utf8 设置编解码器：http: [//doc.qt.io/qt-4.8/qtextcodec.html#setCodecForCStrings](http://doc.qt.io/qt-4.8/qtextcodec.html#setCodecForCStrings)

或者您可以使用它来代替：`QString::fromUtf8("?sátse omoc¿")`

# python - 我从 Internet 复制的 Python 代码中的无效语法错误

> ID：15177040
> 
> 赞同：0
> 
> 时间：2013-03-02T16:59:56.557
> 
> 标签：python, syntax

我参加的大学早期课程之一是 3 年前的 Python 基础培训。现在我正在寻找一个可以帮助我调整一些 Grid 东西大小的程序，我发现了一些可以在 Python 中帮助我的东西。我将 Python 重新安装到我的 PC 并找到了我的旧编辑器。但是，当我运行代码时，我得到一个我无法理解的无效语法错误。这是出现错误的代码部分：

```
def downsize(mode, cell_size, inpath, outpath):

  from VolumeData import fileformats
  try:
    grid_data = fileformats.open_file(inpath)
  except fileformats.Uknown_File_Type, e:
    sys.stderr.write(str(e))
    sys.exit(1)

  reduced = Reduced_Grid(grid_data, mode, cell_size)

  from VolumeData.netcdf.netcdf_grid import write_grid_as_netcdf
  write_grid_as_netcdf(reduced, outpath) 
```

确切的无效语法错误在“除了 fileformats.Uknown_File_Type, e:”行中。你能帮助我吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:06:37.103

如果您使用的是 Python 3.x，则不能使用`except fileformats.Uknown_File_Type, e`. 逗号用作`as`语句（在`try`/`except`块中），因此您应该将其替换为：`except fileformats.Uknown_File_Type as e`。

逗号适用于 Python 2.7，但不适用于 3.x。但是，`as`应该适用于两者。

参考：[在 Python 3.3 中处理错误](http://docs.python.org/3.3/tutorial/errors.html#handling-exceptions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:01:22.127

也许你拼错了“未知”？

# android - 使用 WebView 实现 Android OAuth

> ID：15177042
> 
> 赞同：0
> 
> 时间：2013-03-02T17:00:13.780
> 
> 标签：android, oauth-2.0

我正在尝试`OAuth`通过 android 应用程序实现实时连接的流程。对于身份验证和同意部分，我使用`WebView`将用户重定向到相应的页面。我试图实现的流程是 -

1.  启动`MyActivity`。
2.  在`onCreate()`中，启动`auth url`并等待。
3.  用户使用帐户登录并被重定向到同意页面。
4.  用户同意访问权限。
5.  解析授权码。
6.  返回并使用代码`MyActivity`执行操作。`auth`

下面是代码片段：

```
public class MyActivity extends Activity {
        public void onCreate(Bundle savedInstanceState) {
          super.onCreate(savedInstanceState)
          WebView myWebView = (WebView) findViewById(R.id.webview);
          AuthFlowWebView authView = new AuthFlowWebView(); //AuthFlowWebView extends WebViewClient
          myWebView.getSettings().setJavaScriptEnabled(true);
          myWebView.setWebViewClient(authView);
          myWebView.loadUrl("https://login.live.com/oauth20_authorize.srf?client_id=<CLIENT_ID>&scope=wl.signin%20wl.offline_access&response_type=code&redirect_uri=https%3A%2F%2Flogin.live.com%2Foauth20_desktop.srf&display=touch");
          Log.i("", "Here already before the auth process is complete");
          }
    }

//Here is the Overriden onPageFinished method used to parse the auth code in AuthFlowWebView class:
@Override
        public void onPageFinished(WebView view, String url) {

            super.onPageFinished(view, url);
                Thread.dumpStack();
            if (url.contains("oauth20_desktop.srf?code=")) {
                authSuccess = true;
                Uri uri = Uri.parse(url);
                authCode = uri.getQueryParameter("code");
                Log.i("", "CODE : " + authCode);
                authProcessComplete = true;
            } 
```

我坚持要`MyActivity`等到步骤 3-5 完成。请提出替代方案来实施这种流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T16:44:01.857

如下所示更新了我的 WebViewClient 实现，解决了问题。希望有人觉得这很有用。

```
myWebView.setWebViewClient(new WebViewClient() {

        boolean authComplete = false;
        Intent resultIntent = new Intent();

        @Override public void onPageStarted(WebView view, String url, Bitmap favicon){
         super.onPageStarted(view, url, favicon);
         pDialog = ProgressDialog.show(view.getContext(), "",
                    "Connecting to " + provider + " server", false);
        }

        @Override
        public void onPageFinished(WebView view, String url) {
            super.onPageFinished(view, url);
                pDialog.dismiss();

            if (url.contains("?code=") && authComplete != true) {
                Uri uri = Uri.parse(url);
                authCode = uri.getQueryParameter("code");
                Log.i("", "CODE : " + authCode);
                authComplete = true;
                resultIntent.putExtra("code", authCode);
                WebActivity.this
                        .setResult(Activity.RESULT_OK, resultIntent);
                resultIntent.putExtra("status", WebActivity.Status.SUCCESS.toString());
                setResult(Activity.RESULT_CANCELED, resultIntent);
                finish();
            }else if(url.contains("error=access_denied")){
                Log.i("", "ACCESS_DENIED_HERE");
                resultIntent.putExtra("code", authCode);
                resultIntent.putExtra("status", WebActivity.Status.ACCESS_DENIED.toString());
                authComplete = true;
                setResult(Activity.RESULT_CANCELED, resultIntent);
                finish();
            }
        }
    }); 
```

# jquery - 使用 jQuery 重命名复选框

> ID：15177043
> 
> 赞同：0
> 
> 时间：2013-03-02T17:00:27.563
> 
> 标签：jquery, html

当我将新的表格行插入表格时，我需要重命名一个复选框。为了皮特的爱，我不知道为什么这不起作用

```
$('.productSelect').blur(function() {
      $('#invoiceTable tbody>tr:last').clone(true)
          .insertAfter('#invoiceTable tbody>tr:last').find("input").val("")
          .find("select").val("").find("checkbox")
          .attr('name', "soldOut[" +rowCount + "]");
    rowCount++;
    return false;
    }); 
```

的HTML：

```
<tr>
<td><img src="/pics/deleteRow.png" class="delete"> </td>
<td class="productColumn">

    <select name="productID[]" class="productSelect" >
        <option value="0"></option>
    </select>

</td>

<td>
    <select name="lotID[]" class="lotNumber" >
        <option value=0>Lot #</option>
    </select>
</td>
<td>
    <select name="wheelID[]" class="wheelNumber">
        <option value=0>Wheel</option>
    </select>

</td>
<td>
    <select name="packageType[]" class="packageType">
        <option value=0>Pkg Type</option>
    </select>
</td>
<td class="numberPieces"><input name="numberPieces[]" class="numberOfPieces"></td>
<td class="quantityField"><input name="weight[]" class="weight" ></td>
<td class=priceField><input name="price[]" type="number" step="any">
</td>
<td class="subtotalField"><input type="number" step="any" readonly="readonly"></td>
<td class="soldOut"><input type="checkbox" name="soldOut[<?php echo $rowNum; ?>]" class="soldOutBox" ></td> 
```

知道问题是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:05:20.840

当您执行 find() 时，您需要执行[.end()](http://api.jquery.com/end/)以返回堆栈，以便返回上一个元素

```
$('div').find('span') // you are now at the span level.. so you have to do 
$('div').find('span').end() // to get back at the div level 
```

另一个例子

```
$('div').find('p').find('span') // <-- you are at the span level
$('div').find('p').find('span').end() // <-- you are now at the p level
$('div').find('p').find('span').end().end() // back at the div level 
```

所以你必须做

```
 $('#invoiceTable tbody>tr:last').clone(true)
      .insertAfter('#invoiceTable tbody>tr:last').find("input").val("").end() // add end
      .find("select").val("").end() // add end
      .find("checkbox").attr('name', "soldOut[" +rowCount + "]"); 
```

另一个错误是这个

```
.find("checkbox") // <-- there are no checkbox elements 
```

改成这个

```
.find("input[type=checkbox]") // they are input with type=checkbox 
```

[小提琴](http://jsfiddle.net/wXXA9/)

# c - Gstreamer 应用程序rc

> ID：15177045
> 
> 赞同：3
> 
> 时间：2013-03-02T17:00:57.123
> 
> 标签：c, gstreamer

Gstreamer（**0.10 版**）允许使用“Appsrc”元素加载外部数据。

Appsrc 有一个控制属性，用于定义在考虑队列已满之前可以在 appsrc 中排队多少数据。它被命名为“最大字节数”。

当队列大小达到预定义的限制时，appsrc 会发出“足够数据”信号。

有一个应用程序：

1.  它有一个馈送函数 X 从文件系统读取数据。
2.  负责函数 X 执行的“开始”和“停止”函数。使用appsrc注册的两个函数：

    ```
    g_signal_connect(app->appsrc_v, "need-data", G_CALLBACK(start_feed),   app);       
    g_signal_connect(app->appsrc_v, "enough-data", G_CALLBACK(stop_feed),    app); 
    ```

3.  使用“max-bytes”属性定义的队列限制为：40960 字节

一切似乎都定义得很好——管道正在运行，appsrc 消耗数据，馈送正在工作，appsrc 发出“需要”和“足够”的信号。

但有时我可以看到以下内容：

```
appsrc gstappsrc.c:1451:gst_app_src_push_buffer_full:<appsrc_v> queue filled (**890033** >= **40960**)
appsrc gstappsrc.c:1451:gst_app_src_push_buffer_full:<appsrc_v> queue filled (**898225** >= **40960**)
appsrc gstappsrc.c:1451:gst_app_src_push_buffer_full:<appsrc_v> queue filled (**898225** >= **40960**) 
```

已达到队列限制，但未发出“足够”的信号。馈送功能将继续将数据推送到appsrc，而不是40K，它可以推送到1Mb或更多。

你能帮我理解这个原因吗？

# javascript - 正则表达式匹配所有以 T 开头的字符串

> ID：15177046
> 
> 赞同：0
> 
> 时间：2013-03-02T17:00:59.033
> 
> 标签：javascript, regex, dom, google-chrome-extension

我需要一些帮助来编写正则表达式。

我需要找到以开头`T.`和结尾的字符串的所有子字符串`.`（在这种情况下，这些子字符串是数字）。这些字符串必须是唯一的。

例如：

```
 T.220431.2 = 1.16363965404949
    T.220431.1 = 1.16363965404949
    T.3923331.2 = 0.335752950772576
    T.3923331.1 = 0.335752950772576
    T.4125531.2 = 0.335752950772576
    T.4125531.1 = 0.335752950772576 
```

我想得到一个数组 {220431, 392331, 4124431}

有任何想法吗？

提前致谢，

**编辑：**由于我得到了大量的反对票，我只想说我确实尝试过使用`^[T]\.[0-9]+[\.]`，但它对我不起作用。小伙伴们放轻松，我只是想在这里学习...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:24:33.940

从正则表达式中删除 $？显然你不匹配整行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:00:19.503

正则表达式是`/\bT\.(\d+)\./g`. 我的正则表达式不起作用的原因是我没有考虑到字符串开头的空格。

无论如何，在使用这个正则表达式后，得到了具有所需数字的子字符串，并使用 join() 将所有内容合并在一起。

感谢 Rob W 的回答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T18:44:56.817

与任何正则表达式一样，有无限可能的解决方案可以让事情飞起来。在下面的 main.js 中查找`parseValues(...)`函数。

jsFiddle[在](http://jsfiddle.net/uwe_guenther/rYSwx/)这里：http: [//jsfiddle.net/uwe_guenther/rYSwx/](http://jsfiddle.net/uwe_guenther/rYSwx/)

*索引.html*

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
    <div id='output'></div>
    <script src='main.js'></script>
</body>
</html> 
```

*main.js*

```
(function (document) {
    function parseValues(values) {
        var results = [];
        var regex = /T\.(\d+)?.*/;
        var len = values.length;
        var i;
        var result;
        for (i = 0; i < len; i++) {
            result = values[i].replace(regex, '$1');
            if (result) {
                if (results.indexOf(result) < 0) {
                    results.push(result);
                }
            }
        }
        return results;
    };

    function main() {
        var values = [
            'T.220431.2 = 1.16363965404949',
            'T.220431.1 = 1.16363965404949',
            'T.3923331.2 = 0.335752950772576',
            'T.3923331.1 = 0.335752950772576',
            'T.4125531.2 = 0.335752950772576',
            'T.4125531.1 = 0.335752950772576'
        ];
        var results = parseValues(values);
        var output = document.getElementById('output');
        var len = results.length;
        var i;
        for (i = 0; i < len; i += 1) {
            output.innerHTML += results[i] + '<br/>';
        }
    };

    main();

})(document); 
```

# android - Android libgdx使用手势监听器左右滑动检测

> ID：15177049
> 
> 赞同：5
> 
> 时间：2013-03-02T17:01:07.180
> 
> 标签：android, libgdx, android-gesture

我用 libgdx 在屏幕中央显示了一个图像。如果我向左滑动图像应该*向左移动*，如果我向右滑动图像应该*向右移动*。

随后向左滑动应将图像向左移动。权利也应该如此。我用过`GestureListener`。

如果我向左滑动第一个图像向左移动，它在某种意义上是有效的。但在那之后，如果我尝试向右滑动，图像仍然会向左移动。

那么我如何在 libgdx 中克服这个问题？

```
 class MyGestureListener implements GestureListener {

        @Override
        public boolean fling(float arg0, float arg1, int arg2) {
            // TODO Auto-generated method stub

              if(arg0>0)
               iX += 20;
              else
             // else if(arg0*100>iX)
                  iX-=20;
               System.out.println("Hello..............."+iX);
            return true;
        }

   Gdx.input.setInputProcessor(new GestureDetector(0.0f, 0.0f,0.0f, 5f,new MyGestureListener()));

   batch.draw(splashTexture, iX, iY); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T17:36:59.223

我使用了此链接中的示例。[https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/GestureDetectorTest.java](https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/GestureDetectorTest.java)。

```
 @Override
   public boolean fling(float velocityX, float velocityY, int button) {
       if(Math.abs(velocityX)>Math.abs(velocityY)){
               if(velocityX>0){
                       iX+=20;//x cordinate
               }else if (velocityX<0){
                      iX-=20;
               } else {
                 // Do nothing.
               }
       }else{

          // Ignore the input, because we don't care about up/down swipes.
       }
 return true; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T10:01:01.693

```
 public class Test extends Activity{

private GestureDetector gesturedetector = null;

View layout;

@Override

public void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);

setContentView(R.layout.test);

layout = (LinearLayout)findViewById(R.id.container);

gesturedetector = new GestureDetector(new MyGestureListener());

layout.setOnTouchListener(new OnTouchListener() {

@Override

public boolean onTouch(View v, MotionEvent event) {

gesturedetector.onTouchEvent(event);

return true;

}

});

}

public boolean dispatchTouchEvent(MotionEvent ev){

super.dispatchTouchEvent(ev);

return gesturedetector.onTouchEvent(ev);

}

class MyGestureListener extends GestureDetector.SimpleOnGestureListener{

private static final int SWIPE_MIN_DISTANCE = 150;

private static final int SWIPE_MAX_OFF_PATH = 100;

private static final int SWIPE_THRESHOLD_VELOCITY = 100;

@Override

public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX,

float velocityY) {

float dX = e2.getX()-e1.getX();

float dY = e1.getY()-e2.getY();

if (Math.abs(dY)<SWIPE_MAX_OFF_PATH &&

Math.abs(velocityX)>=SWIPE_THRESHOLD_VELOCITY &&

Math.abs(dX)>=SWIPE_MIN_DISTANCE ) {

if (dX>0) {

Toast.makeText(getApplicationContext(), “Right Swipe”, Toast.LENGTH_SHORT).show();

} else {

Toast.makeText(getApplicationContext(), “Left Swipe”, Toast.LENGTH_SHORT).show();

}

return true;

} else if (Math.abs(dX)<SWIPE_MAX_OFF_PATH &&

Math.abs(velocityY)>=SWIPE_THRESHOLD_VELOCITY &&

Math.abs(dY)>=SWIPE_MIN_DISTANCE ) {

if (dY>0) {

Toast.makeText(getApplicationContext(), “Up Swipe”, Toast.LENGTH_SHORT).show();

} else {

Toast.makeText(getApplicationContext(), “Down Swipe”, Toast.LENGTH_SHORT).show();

}

return true;

}

return false;

}

}

} 
```

# jquery - Jquery添加类删除类不适用于div

> ID：15177056
> 
> 赞同：0
> 
> 时间：2013-03-02T17:01:23.777
> 
> 标签：jquery, html

我有 2 个具有相同类“orig”的 div [id1，id2] 和一个具有“orig2”的 div [id3]。鼠标悬停在任何 .orig 上会使所有 div[id1, id2] 变为粉红色，而在 .orig2 上使 div[id3] 变为绿色。

```
<div id="id1" class="orig">Some Text</div>
<div id="id2" class="orig">Second Div of name 1</div>
<div id="id3" class="orig2">Third div</div>
<input type="button" id="btn1" value="CLICK ME" /> 
```

Jquery 翻滚

```
 $('.orig').on('mouseenter',function () {
  $('.orig').css('background-color', '#e31b3f');
 });

$('.orig').on('mouseleave',function () {
 $('.orig').css('background-color', '#7d7d7d');
});

$('.orig2').on ('mouseenter', function () {
 $('.orig2').css('background-color', '#80bd3c');
});
$('.orig2').on('mouseleave',function () {
 $('.orig2').css('background-color', '#464646');
}); 
```

现在单击按钮，我将从 div id3 中删除 orig2 类并向其添加 orig 类。所以现在理想情况下，当我滚动 id3 div 时，它应该与 id1 和 id2 一起变成粉红色。但这并没有发生。当我在 id1 或 id2 上滚动时，id3 变为粉红色，表示 .orig 类已成功添加。但是滚动 id3 什么也没做。

```
$('#btn1').on('click', function () {
 $('#name2').addClass('orig');
 $('#id3').removeClass('orig2');
}); 
```

这是 jsFiddle 链接：http: [//jsfiddle.net/monologish/Eprym/](http://jsfiddle.net/monologish/Eprym/)

这是我的问题的简化版本，我尝试在持有人 div 中添加一个全新的 div，但没有任何改变。我不明白为什么会这样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:06:28.583

事件处理程序在绑定处理程序时附加到与选择器匹配的元素，因此更改元素类不会删除旧的事件处理程序，或者使以前附加到新类的事件处理程序开始工作。为此，您必须将事件处理程序重新附加到与选择器匹配的新元素，或者使用附加到父元素的委托事件处理程序，在执行期间检查选择器，如下所示：

```
$(document).on({
    mouseenter: function () {
        $('.orig').css('background-color', '#e31b3f');
    },
    mouseleave: function () {
        $('.orig').css('background-color', '#7d7d7d');
    }
}, '.orig'); 
```

[**小提琴**](http://jsfiddle.net/adeneo/Eprym/4/)

# jquery - 使用 jquery 对块进行排序和搜索

> ID：15177058
> 
> 赞同：0
> 
> 时间：2013-03-02T17:01:34.623
> 
> 标签：jquery, sorting, search

有没有一些简单的方法来搜索和排序块。我只需要基本的 soting 脚本，它可以按名称或年龄进行排序，并且在同一个排序按钮上同时具有升序或降序功能。我看到很多表格排序器，但我找不到任何可以对块进行排序的东西。
PS：我尝试了 listjs 并且它可以工作，但是当我安装不同的 wordpress 插件时它停止工作（我已经像以前的插件一样加载了所有脚本，但它仍然无法工作）

一个块看起来像这样：（看起来我不是在排序块而是对行进行排序，但是使用 css 看起来像[这样](http://profithing.com/business/)

```
<li class="one"><a href="link"><img src="link" height="125" width="125"/>
<p class="name">name</p>
<p class="age">age</p>
<p></a></li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:45:18.610

您可以很容易地编写自己的脚本，您所需要的只是拥有一个`comparater`定义您的排序标准的函数。例如，要按降序对年龄进行排序，您可以执行以下操作。

```
var comparater = function (a, b) {
    var result = 0;

    if ($(a).find('.age').text() > $(b).find('.age').text()) {
        result = -1;
    } else {
        result = 1;
    }

    return result; 
}      

var nodes = $('.one');
nodes.sort(comparater); 
```

她是一个完整的执行升序，降序。 [http://jsfiddle.net/H77Ve/](http://jsfiddle.net/H77Ve/)。

# python - 插入数据库时 出现语法错误 [Google 应用引擎]

> ID：15177062
> 
> 赞同：0
> 
> 时间：2013-03-02T17:01:49.887
> 
> 标签：python, database, google-app-engine, syntax

尝试插入数据存储时出现语法错误，在另一个项目中工作的完全相同的代码行

```
 B = db_Person(nafn='Alex') 
```

这是其余的代码：

[http://pastebin.com/bW37aUuT](http://pastebin.com/bW37aUuT)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:02:59.310

```
def post(self):
    q = db.Query(db_Person)

    message = "Innsetning tokst"

    in_kennitala = int(self.request.get('p_kennitala'))
    in_nafn = self.request.get('p_nafn')
    in_heimili = self.request.get('p_heimili')
    in_postnumer = self.request.get('p_postnumer')
    in_stadur = self.request.get('p_stadur')
    in_land = self.request.get('p_land')
    in_simi = int(self.request.get('p_simi'))
    in_gsm = int(self.request.get('p_gsm')    # <- missing right parenthesis

    B = db_Person(nafn='Alex')                # <- parser gets confused here
    B.put()

    template_values = {
            'message': message
    }

    template = jinja_environment.get_template('breyta.html')
    self.response.out.write(template.render(template_values)) 
```

这是固定代码：

```
def post(self):
    q = db.Query(db_Person)

    message = "Innsetning tokst"

    in_kennitala = int(self.request.get('p_kennitala'))
    in_nafn = self.request.get('p_nafn')
    in_heimili = self.request.get('p_heimili')
    in_postnumer = self.request.get('p_postnumer')
    in_stadur = self.request.get('p_stadur')
    in_land = self.request.get('p_land')
    in_simi = int(self.request.get('p_simi'))
    in_gsm = int(self.request.get('p_gsm'))

    B = db_Person(nafn='Alex')
    B.put()

    template_values = {
            'message': message
    }

    template = jinja_environment.get_template('breyta.html')
    self.response.out.write(template.render(template_values)) 
```

# security - 反向公钥/私钥加密？

> ID：15177069
> 
> 赞同：0
> 
> 时间：2013-03-02T17:02:24.530
> 
> 标签：security, authentication, encryption

可能是一个不合格的问题，但是否有任何加密系统生成两个加密密钥（一个公共，一个私人），并且......

A) 公钥用于加密信息，但不能用于解密 B) 私钥用于解密信息，不能用于加密。

我之所以问，是因为我认为这是在不使用 SSL/HTTPS 的情况下保护 Web 服务（例如论坛）的登录会话的唯一实用方法。不过，由于我对系统安全和密码学的了解有限，我很可能是错的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:07:13.050

最常见的私钥加密算法是 RSA。但是，如果您不知道自己在做什么，请坚持使用更高级别的结构，例如 SSL/TLS。

# python - 对象的字符串替换（非字典）

> ID：15177072
> 
> 赞同：1
> 
> 时间：2013-03-02T17:02:45.297
> 
> 标签：python, string

Python 有一种很好的方法来使用字典进行字符串替换。
如何在我自己的对象中复制相同的行为（而不是使用字典）？

```
In [1]: d = {'hello': 'world'}

In [2]: '%(hello)s' % d
Out[2]: 'world' 
```

例如，如果我有一个类`MyClass`：

```
In [3]: class MyClass():
            a = 'x'
            b = 'y'

In [4]: m = MyClass() 
```

*在没有任何映射的情况下，我们希望字符串替换会引发错误（确实如此），但假设我希望它表现得像`{'a' : 'x'}`ie 具有以下 return `'x'`：*

```
In [5]: '%(a)s' % m
TypeError: format requires a mapping 
```

*我一直在搞乱[格式字符串语法 ( `__format__`)](http://docs.python.org/2/library/string.html#format-string-syntax)或[模板字符串](http://docs.python.org/2/library/string.html#template-strings)，但没有成功。*

如何为我的班级提供“映射”（字典？）以用于字符串替换？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:05:05.527

您的`MyClass()`实例确实有一个与之关联的字典，请使用以下[`vars()`函数](http://docs.python.org/2/library/functions.html#vars)访问它：

```
'%(a)s' % vars(m) 
```

这适用于所有不使用`__slots__`属性的自定义类。

或者，您可以使用更新的[`''.format()`字符串格式化方法](http://docs.python.org/2/library/stdtypes.html#str.format)，它允许您访问对象属性：

```
'{0.a}'.format(m) 
```

正是这种格式化`.__format__(format_spec)`方法在您的自定义类上查找方法，请参阅[`format()`函数文档](http://docs.python.org/2/library/functions.html#format)。

最后但同样重要的是，任何具有[`.__getitem__()`方法](http://docs.python.org/2/reference/datamodel.html#object.__getitem__)的对象都可以用于字符串格式化，就好像它是一个字典一样：

```
>>> class Foo(object):
...     def __getitem__(self, name):
...         if name == 'bar': return 'baz'
...         raise AttributeError(name)
... 
>>> '%(bar)s' % Foo()
'baz' 
```

# javascript - javascript闭包和范围的问题

> ID：15177073
> 
> 赞同：2
> 
> 时间：2013-03-02T17:02:52.250
> 
> 标签：javascript, scope, closures

我有一个名为 writeMessage 的函数。writeMessage 调用 ajax 请求来获取本地化内容。一旦从 ajax 请求返回内容，它还会在“n”秒后淡出消息。所以这一切都有效，我已经测试了许多调用，但是，我觉得它过于复杂，因为在处理 javascript 闭包语句时我不完全理解变量的范围。谁能告诉我我是否在这里跳过了太多的箍来完成以下任务。

函数**getTextResource**接受参数，（字符串、字符串、对象、函数）

*   'function' 参数是一个回调，在 ajax 请求完成后调用。
*   'object' 参数是一个 arguments 对象，包含有关如何以及在何处写入消息的所有详细信息。
*   'string' & 'string' 参数被传递到 ajax 请求中。

在 getTextResource 中，我正在调用一个 ajax 方法，将“object”参数作为上下文以及原始默认文本和回调函数传递 ajax 请求完成后，通过上下文，我现在调用回调函数，将结果传递给它服务调用以及参数。

如果再次调用该函数，我是否需要继续传递上下文，或者传递给 getTextResoruce 的所有内容都不会被分配不同的值？

```
function writeMessage(args) {
    var d = $('<div></div>');

    getTextResource(args.resourceId, args.message, { args: args, messageElement: d },
        function (text, context) {
            var args = context.args;
            var d = context.messageElement;

            d.empty();
            d.append(text);

            args.element.append(d);

            if (args.fadeTimeOut > 0)
                setTimeout(function () {
                    d.fadeOut('slow', function () {
                        $(this).remove();
                    });
                }, args.fadeTimeOut);
        }
    );
}

var getTextResource = function (resourceId, defaultText, context, cb) {
    resourceId = resourceId + '';
    defaultText = defaultText + '';

    if (resourceId == '') resourceId = defaultText;
    if (defaultText == '') defaultText = resourceId;

    try{
        var request = $.ajax({
            type: 'GET',
            url: 'http://localhost/EaiCCM/api/' + BusinessScope.Version + '/' + BusinessScope.CampaignSegment + '/TextResource',//?' + qs,
            data:  {ResourceId: resourceId, DefaultText: defaultText},
            cache: false,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            context: { defaultText: defaultText, context: context, cb: cb }
        });

        request.done(function (result) {
            var txt = this.defaultText;
            try {
                if ($.isPlainObject(result))
                    txt = result.Detail;
            }
            catch (e) {
            }
            finally {
                if (typeof this.cb == 'function')
                    this.cb(txt, this.context);
            }
        });

        request.fail(function (jqXHR, textStatus, context) {
            if (typeof this.cb == 'function')
                this.cb(this.defaultText, this.context);
        });
    }
    catch (e) {
        if (typeof cb == 'function')
            cb(defaultText, context);
    }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:10:46.900

不，`context`如果您在`writeMessage`. （作用域对于函数的每次调用都是本地的。）

这个：

```
 function (text, context) {
        var args = context.args;
        var d = context.messageElement; 
```

可以很容易地：

```
 function (text) { 
```

并且`request.done`可以阅读：

```
 request.done(function (result) {
        var txt = defaultText;
        try {
            if ($.isPlainObject(result))
                txt = result.Detail;
        }
        catch (e) {
        }
        finally {
            if (typeof cb == 'function')
                cb(txt);
        }
    }); 
```

参数的范围仅限于作为参数的函数的每次调用。`var`变量的范围仅限于语句`function`上方第一个的调用。**范围仅持续到关闭它的大括号****。**`var`**`function`**

所以，在这段代码中：

```
function writeMessage(args) {
  var d = $('<div></div>');
  var rid = args.resourceId;

  var cb = function (text) {
    var exampleVar = text.toUpper();
    d.textContent = exampleVar + rid;
  }

  getTextResource(rid+'-san', 'foo', cb)
  getTextResource(rid+'-chan', 'bar', cb)
}

function getTextResource(resourceId,defaultText,cb) {
  // for simplicity's sake let's just simulate a default scenario

  // Note that the `resourceId` passed to `getTextResource`
    // is in no way passed to the callback here

  cb(defaultText);
} 
```

*   `args`, `rid`, 和`d`对 的每次调用都是本地的`writeMessage`。
*   `text`并且`exampleVar`对于回调的每个调用都是本地的`cb`。
*   `resourceId`并且对于 .`defaultText`的每次调用都是本地的`getTextResource`。
*   `cb`是我们构造的`writeMessage`回调，也是我们传入的回调`getTextResource`。尽管它们具有相同的名称，但不同的作用域意味着它们实际上被视为两个不同的变量。（如果这令人困惑，请参见下面的类比。）
*   当使用`getTextResource`调用回调时`'bar'`，它会修改与`d`调用回调时相同的修改`'foo'`，因为回调中使用的是构造它`d`的本地的。`writeMessage`
*   `exampleVar`但是，`textContent`of设置为的值`d`在每次调用中都会有所不同，因为它是回调本地的。
*   的值`exampleVar`不会以附加的 or 结尾*，*`'-san'`因为`'-chan'`它们被附加到`resourceId`的范围内`getTextResource`，这对范围是不可见的`writeMessage`（变量被调用的地方`rid`，`resourceId`无论如何也不可见）。

### 不同作用域同名变量的类比

变量名称在不同的上下文中指代不同的值，例如“Bob”在*Bob's Burgers*中的含义与在*Bob the Builder*中的含义不同。然而，在一个上下文中，“Bob”可能指的是在其原始上下文中也被称为“Bob”的东西，例如在*Archer*第 4 季的第一集中，Sterling 被称为“Bob”并在“Bob's Burgers”工作"（作为参考 H. Jon Benjamin 为两个角色提供声音）。您可以声称这是一个巧合，“真正*的”鲍勃汉堡“鲍勃”存在于**Archer*世界的其他地方，但无论他是否是同一个“鲍勃”*弓箭手*到下一个。

# android - 在同一个活动中是否可以有 2 个上下文菜单？

> ID：15177074
> 
> 赞同：1
> 
> 时间：2013-03-02T17:02:55.153
> 
> 标签：android, android-contextmenu

我有一个带有`TextView`图像图标的活动。我已经通过覆盖为图像图标创建了上下文菜单[`onCreateContextMenu()`](http://developer.android.com/reference/android/app/Activity.html#onCreateContextMenu%28android.view.ContextMenu,%20android.view.View,%20android.view.ContextMenu.ContextMenuInfo%29)。

但是，我还想为`TextView`. 但是，我注意到我已经在使用`onCreateContextMenu()`：

```
public void onCreateContextMenu(ContextMenu menu, View v,ContextMenuInfo menuInfo) {  
    super.onCreateContextMenu(menu, v, menuInfo);  
    menu.setHeaderTitle(getString(R.string.option1));  
    menu.add(0, v.getId(), 0, getString(R.string.option2));  
    menu.add(0, v.getId(), 0, getString(R.string.options3));  
} 
```

因此，是否可以为`TextView`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:07:44.030

您可以使用**onCreateContextMenu**中传递的 View 对象来确定菜单的所有者并相应地填充菜单。

您的代码应如下所示：

```
public void onCreateContextMenu(ContextMenu menu, View v,ContextMenuInfo menuInfo) {  
    super.onCreateContextMenu(menu, v, menuInfo);  
        switch (v.getId()) {
          case R.id.imageIconId:
             menu.setHeaderTitle(getString(R.string.option1));  
             menu.add(0, v.getId(), 0, getString(R.string.option2));   
             menu.add(0, v.getId(), 0, getString(R.string.options3));  
           break;
          case R.id.textViewid:
            // do whatever you want with the menu object.
           break;
}
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T17:09:17.623

通过该方法传递给您的参数将帮助您分支到不同的事物。

这是一个例子：

```
public void onCreateContextMenu(ContextMenu menu, View v,ContextMenuInfo menuInfo) {  
    super.onCreateContextMenu(menu, v, menuInfo);
        if( v.equals(yourImgView) ){
            menu.setHeaderTitle(getString(R.string.option1));  
            menu.add(0, v.getId(), 0, getString(R.string.option2));  
            menu.add(0, v.getId(), 0, getString(R.string.options3));  
        }else if ( v.equals(yourTxtView) ) {
            //Do your textView things.
        }

    } 
```

# jquery - 在 Internet Explorer 中，图像上传预览不起作用并且表单仅在第二次单击后提交

> ID：15177076
> 
> 赞同：0
> 
> 时间：2013-03-02T17:03:01.087
> 
> 标签：jquery, internet-explorer, submit

我创建了一个简单的表单来上传图片。

它允许在选择后立即预览图像。

它在 Chrome 和 Firefox 中完美运行，但在 IE 中却不行，其中： - 图像预览根本不起作用；- 只有在第二次（提交）按钮单击后才能成功提交表单。

任何想法如何解决它？

[您可以在http://jsfiddle.net/renatogil/qFjrE/](http://jsfiddle.net/renatogil/qFjrE/)上看到它的发生

代码是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//PT" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<!-- Include The jQuery Library -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script>
//----------------------------------------------------
// img preview
//----------------------------------------------------
//
function readURL(input, pic) {
    if (input.files && input.files[0]) {
        var reader = new FileReader();

        reader.onload = function (e) {
            $('#' + pic)
                .attr('src', e.target.result)
                .width(120)
                .height(120);
        };
        reader.readAsDataURL(input.files[0]);
    }
}
</script>
</head>
<body>

    <form method="post" action="<?php echo $_SERVER["PHP_SELF"]; ?>"
        enctype="multipart/form-data">

        <img id="product_pic" src="img/default_product_pic.jpg" width="120"
            height="120" alt="Click to upload..." /><input id="product"
            name="product" type="file"
            style="visibility: hidden; overflow: hidden; display: none;"
            onchange="readURL(this, 'product_pic');"><br> <br> <input
            id="add_pic" type="button" value="Add picture">
        </div>

        <script>$('#product_pic').click(function() { $('#product').click(); });$('#add_pic').click(function() { $('#product').click(); });</script>

        <input type="submit" value="Upload" />
        </div>
    </form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:05:38.167

在检查您的代码后，您似乎有一个 clising 它没有在任何地方打开？

# c# - 如何在 XAML 中将多个 StatusBarItems 对齐到右侧？

> ID：15177079
> 
> 赞同：18
> 
> 时间：2013-03-02T17:03:32.320
> 
> 标签：c#, xaml, alignment

我的`StatusBar`C# 应用程序中有 4 个项目。我基本上想把最后两个浮动`StatusBarItems`到右边。我已经尝试将它们都设置为`HorizontalAlignment="Right"`，但这仅适用于最后一项。

```
<StatusBar Name="statusBar1" Height="23" HorizontalAlignment="Stretch"
        VerticalAlignment="Bottom">
    <StatusBarItem />
    <StatusBarItem />
    <StatusBarItem HorizontalAlignment="Right" />
    <StatusBarItem HorizontalAlignment="Right" />
</StatusBar> 
```

我开始用谷歌搜索，我想出了以下网址：

[博客点](http://kentb.blogspot.ch/2007/10/perfect-wpf-statusbar.html)

这真的是唯一的解决方案，还是有更简单的方法？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-02T17:13:33.983

您可以利用默认`ItemsPanel`值`StatusBar`是`DockPanel`. 默认情况下`DockPanel`，遗嘱会尝试用最后一项填充剩余空间。因此，`StatusBarItem`您添加到的最后一个`StatusBar`将填充剩余的空间。要利用这一点，您可以`StatusBarItems`像这样简单地嵌套：

```
<StatusBar Name="statusBar1" Height="23" HorizontalAlignment="Stretch" VerticalAlignment="Bottom">
  <StatusBarItem Content="Item 1"/>
  <StatusBarItem Content="Item 2" />
  <StatusBarItem HorizontalAlignment="Right">
    <StackPanel Orientation="Horizontal">
      <StatusBarItem  Content="Item 3"/>
      <StatusBarItem Content="Item 4"/>
      <ProgressBar Height="15" Width="50" IsIndeterminate="True" Margin="5,0"/>
    </StackPanel>
  </StatusBarItem>
</StatusBar> 
```

请注意，`HorizontalAlignment`将 3rd`StatusBarItem`设置为，`Right`以便其内容右对齐。

当然，您不必拥有 Item 3 和 Item 4 be `StatusBarItems`，它们也可以是其他控件，例如`Buttons`或`ProgressBar`我在上面演示的。`StatusBarItem`只是一个将项目包装在 a 中的容器，`StatusBar`类似于 a`ComboBoxItem`将项目包装在 a 中的方式`ComboBox`。

如果您不使用它们，它将自动`StatusBar`包装它的内容，因此项目 1 和 2 可以很容易地成为. 使用的主要原因是在您想要控制工作方式的情况下，例如在第三个中手动设置，而不是依赖默认值。`StatusBarItems``TextBoxes``StatusBarItems``StatusBarItem``StatusBarItem``HorizontalAlignment`

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-03-24T15:46:09.540

如前所述，默认容器是`DockPanel`. 因此，您可以根据需要设置任意数量的项目`DockPanel.Dock="Right"`。只要确保该`fill`项目是最后一个。

```
<StatusBar>
    <StatusBarItem DockPanel.Dock="Right">
        <Slider Width="100" />
    </StatusBarItem>
    <StatusBarItem DockPanel.Dock="Right">
        <Label>Zoom: 100 %</Label>
    </StatusBarItem>
    <StatusBarItem>
        <TextBlock>Ready</TextBlock>
    </StatusBarItem>
</StatusBar> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-19T15:56:35.763

您也可以设置`LastChildFill`为`false`然后`DockPanel.Dock=Right`像上面的解决方案一样使用，而不必担心最后一项会占用所有空间：

```
<StatusBar>
  <StatusBar.ItemsPanel>
    <ItemsPanelTemplate>
      <DockPanel LastChildFill="False" />
    </ItemsPanelTemplate>
  </StatusBar.ItemsPanel>
</StatusBar> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-12T03:49:51.027

实现此目的的另一种有趣方法是将默认面板替换为`StatusBar`，`Grid`这将使您可以更好地控制项目的布局。

```
<StatusBar Height="30">
  <StatusBar.ItemsPanel>
    <ItemsPanelTemplate>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
      </Grid>
    </ItemsPanelTemplate>
  </StatusBar.ItemsPanel>

  <StatusBarItem Grid.Column="0">
    <TextBlock Text="{Binding ProgressMessage, Mode=OneWay}" />
  </StatusBarItem>

  <StatusBarItem Grid.Column="1">
    <ProgressBar Value="{Binding ProgressValue, Mode=OneWay}" Width="100" Height="10" />
  </StatusBarItem>

  <StatusBarItem Grid.Column="2">
    <Ellipse Width="12" Height="12" Stroke="Gray" Fill="Red" />
  </StatusBarItem>
</StatusBar> 
```

# sed - 将多行输出转换为单行

> ID：15177084
> 
> 赞同：0
> 
> 时间：2013-03-02T17:03:45.510
> 
> 标签：sed, awk

我管理一个有 40 台 ubuntu 机器的计算机实验室，我拼凑了这个命令来查找学生主目录中大于 100M 的文件的总磁盘使用情况：

```
for i in `cat ./lab-machines.txt ` ; do ssh $i "nohup find /home -size +100M -print0 | du --files0-from=- -ch | tail -1 && hostname && ls /home" ; done > lab-disk-usage.txt 
```

文件“lab-machines.txt”在单独的一行中包含计算机的主机名。该命令从一个配置了无密码登录的服务器运行到 root 用户的实验室机器。文件 lab-disk-usage.txt 中的输出包含每台机器的类似内容（我在括号中插入了注释）：

```
69G total    
hostname
student-username (changes)
admin-username (always the same)
lost+found (always the same) 
```

我希望每台机器的输出看起来像这样：

> 69G 主机名 学生-用户名

我对文本过滤不够熟悉，无法及时完成。你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:38:17.283

## `tr`通过命令管道输出

您可以尝试更简单的解决方案，例如通过*tr*命令管道输出。例如：

```
tr -s "\n" ' ' < lab-disk-usage.txt 
```

不过，这假设文件中只有一条记录。如果您计划拥有多条记录，则需要先通过*tr*管道过滤每条记录，然后再将其附加到输出文件。例如：

```
your_pipeline_commands | tr -s "\n" ' ' > lab-disk-usage.txt 
```

## 使用 Perl 的触发器运算符

如果您有一组多行记录，则需要更加聪明。Perl 在处理多行记录方面比 AWK 提供了一些优势，包括触发器运算符。例如：

```
perl -ne 'if ( /total/../^lost/ ) {
              chomp $_; print $_ . " "
          } else {
              print "\n"
          };
          END { print "\n" };' lab-disk-usage.txt 
```

根据您的实际语料库，您可能需要稍微调整正则表达式以使事情正常工作，但在我的系统上它做正确的事情。

### 用于测试 Perl 的语料库

```
69G total
hostname
student-username
admin-username
lost+found

69G total
hostname
student-username
admin-username
lost+found 
```

### Perl 的示例输出

```
69G total     hostname student-username admin-username lost+found 
69G total     hostname student-username admin-username lost+found 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:15:32.730

尝试这个：

```
awk -vORS=" " 'NR==1{sub("total","")}NR<=3' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T17:26:25.600

我稍微修改了您的示例数据：

```
69G total    
host1
jane
admin-username
lost+found
65G total    
host2
albert
admin-username
lost+found 
```

这可以变成一个表格：

```
[ghoti@pc ~/tmp]$ awk 'NR%5==1{size=$1} NR%5==2{host=$1} NR%5==3{user=$1; printf("%-8s%-16s%s\n", size, host, user)}' lab-disk-usage.txt
69G     host1           jane
65G     host2           albert 
```

她最重要的是我们使用模运算符 ( `NR%5`) 来确定我们在每组五行中的位置。

如果您不能依赖每组五行，那么请澄清您的输入数据的结构。还有其他方法可以检测记录边界，例如查找`/[0-9]+G total$/`，如果`NR%5`不能使用：

```
[ghoti@pc ~/tmp]$ awk '/G total$/{size=$1; getline host; getline user; printf("%-8s%-16s%s\n", size, host, user)}' lab-disk-usage.txt 
69G     host1           jane
65G     host2           albert 
```

这基本上只是 potong 的*GNU sed*建议的 awk 版本，它也可以移植（即不仅仅是 GNU sed）：

```
[ghoti@pc ~/tmp]$ sed -ne '/G total/{s/ .*//;N;N;s/\n/  /g;p;}' lab-disk-usage.txt 
69G  host1  jane
65G  host2  albert 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T19:52:58.130

如果记录之间没有空行，您可以先引入一个：

```
awk '/total/{print x}1' | awk '{print $1,$3,$4}' RS= OFS='\t' 
```

带有文件内容：

```
69G total    
host1
jane
admin-username
lost+found
65G total    
host2
albert
admin-username
lost+found 
```

这会产生：

```
69G host1   jane
65G host2   albert 
```

如果记录之间已经有一个空行，您可以跳过管道之前的部分并使用：

```
awk '{print $1,$3,$4}' RS= OFS='\t' file 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-02T18:30:49.230

这可能对您有用（GNU sed）：

```
sed -nr '/ total/{N;N;s/( total\s*)?\n/ /gp}' file 
```

# mapreduce - 计算 Haskell MapReduce 代码中的字符数

> ID：15177085
> 
> 赞同：0
> 
> 时间：2013-03-02T17:03:48.400
> 
> 标签：mapreduce, haskell

在 Real World Haskell 第 24 章的 Haskell 代码中，使用 MapReduce 计算文件中 LINES 数量的示例实现如下：

```
import qualified Data.ByteString.Lazy.Char8 as LB
lineCount :: [LB.ByteString] -> Int64
lineCount = mapReduce rdeepseq (LB.count '\n')
                      rdeepseq sum 
```

我很清楚这是在计算换行符的数量。如果我想计算 a 的数量，我会这样做：

```
import qualified Data.ByteString.Lazy.Char8 as LB
lineCount :: [LB.ByteString] -> Int64
lineCount = mapReduce rdeepseq (LB.count 'a')
                      rdeepseq sum 
```

我已经尝试过了，它有效。如何修改此代码以计算字符数（即存在的字符总数？我可以使用某种正则表达式框架吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T17:27:23.293

> 我很清楚这是在计算换行符的数量。

嗯，不是真的。A`ByteString`是一个字节串。（如果你想要一个字符串，你应该在[文本](http://hackage.haskell.org/package/text)`Text`包中使用[Data.Text](http://hackage.haskell.org/packages/archive/text/0.11.2.3/doc/html/Data-Text.html)或[Data.Text.Lazy](http://hackage.haskell.org/packages/archive/text/0.11.2.3/doc/html/Data-Text-Lazy.html)。）

Data.ByteString.Lazy.Char8 导出一个界面，让您假装您正在处理字符，但它假定一个字符 = 一个字节，即 ISO-8859-1 或 ASCII。Unicode 不是。

> 如何修改此代码以计算字符数（即存在的字符总数？

[`LB.count :: Char -> ByteString -> Int64`](http://www.haskell.org/ghc/docs/latest/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy-Char8.html#v%3acount)，所以我们正在寻找 type 的函数`ByteString -> Int64`。那个函数是[`LB.length`](http://www.haskell.org/ghc/docs/latest/html/libraries/bytestring-0.10.0.2/Data-ByteString-Lazy-Char8.html#v%3alength)。

```
lineCount = mapReduce rdeepseq LB.length
                      rdeepseq sum 
```

> 我可以使用某种正则表达式框架吗？

在 Haskell 中使用成熟的解析器很容易，我们（至少我）使用解析器而不是正则表达式。如果您的数据采用 a `ByteString`（或 a `Text`，就此而言）的形式，我建议使用[attoparsec](http://hackage.haskell.org/package/attoparsec)。

# java - 频繁 Integer.toString() 转换的内存问题

> ID：15177087
> 
> 赞同：4
> 
> 时间：2013-03-02T17:03:58.107
> 
> 标签：java, android, string, performance

我目前正在将用 C#（用于 Windows Phone）开发的游戏移植到 Java（Android）。

我们在 Java 版本中遇到了内存问题，在分析之后，这似乎来自`String`内存中的大量对象，这显然是由于`String`'s. 现在，我已经设法将其追溯到将玩家的分数呈现到屏幕上的方法，`Integer.toString()`每次分数变化时都会使用 a （每秒多次）。我不能真正使用 a `StringBuilder`（这是我们在 C# 版本中所拥有的），因为我们使用的框架的文本渲染方法只接受`String`'s 作为参数，因此无论如何都会发生转换。

这是Java中的常见问题吗？任何人都可以推荐一个解决方案（除了联系框架开发人员要求他们修改他们的方法！）？

更新：

游戏节奏非常快，分数部分基于从当前“阶段”开始所经过的时间。它每秒更新 15 次。

我们没有保留对字符串的引用，但我在想可能是框架泄漏或复制了这些字符串，所以我试图调查一下（它不是一个公共框架，据我所知它没有被使用过对于这种快节奏的游戏呢）。

池化是一个很好的建议，我想尝试一下，但是必须修改评分系统才能获得一组固定的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:11:23.833

我不确定它是否对您的特定情况有帮助，但一般来说，当您使用一些**固定**的字符串值集进行操作时，将它们全部添加到字符串池中是有意义的。在这种情况下，您可以强制 JVM 不在堆上为每个新字符串创建对象，而是使用字符串池。

您必须更改代码以从池中返回字符串，例如：

```
return String.valueOf(123).intern(); 
```

javadoc的一些额外解释：

> 当调用 intern 方法时，如果池中已经包含一个等于该 String 对象的字符串，由 equals(Object) 方法确定，则返回池中的字符串。否则，将此 String 对象添加到池中并返回对该 String 对象的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T13:56:36.200

我们最终通过创建我们自己的由固定长度的 char 数组支持的可修改字符串类来解决这个问题，并编写我们自己的文本渲染方法，一旦初始化就实现零分配。

在此之后，一切都运行得更加顺利，但我们仍然有一些由 GC 引起的“冻结”。分析后发现这是由于在主游戏循环期间在循环中创建了大量迭代器。然后我们编写了一个使用迭代器池的自定义数组类，现在一切运行良好！

# asp.net-mvc - SignalR 跨域：Access-Control-Allow-Origin 不允许的错误

> ID：15177088
> 
> 赞同：2
> 
> 时间：2013-03-02T17:04:08.490
> 
> 标签：asp.net-mvc, asp.net-web-api, signalr

尝试从另一个域调用 signalR，并继续收到此错误：

> XMLHttpRequest 无法加载 localhost:62150/signalr/negotiate?_=1362242757692。Access-Control-Allow-Origin 不允许 Origin localhost:4982。

这是我试图运行的代码：

```
$(function () {
    jQuery.support.cors = true;
    $.connection.hub.url = 'http://localhost:62150/signalr';
    $.connection.hub.start()
        .done(function () { alert("Now connected!"); })
        .fail(function () { alert("Could not Connect!"); });
}); 
```

jquery 和 jquery.signalr.js 已加载，localhost:62150/signalr/hubs 以 JS 响应，localhost:62150/signalr/hubs/negotiate?_=1362243021215 如果我在浏览器中运行它会返回 JSON - 所以它不是缺少脚本或无效路径问题。

我试过的：

*   [http://coding4life.wordpress.com/2012/03/30/making-cross-domain-calls-in-signalr/](http://coding4life.wordpress.com/2012/03/30/making-cross-domain-calls-in-signalr/) （设置 jQuery.support.cors 和 $.connection.hub.url）
*   使用“Access-Control-Allow-Origin”值=“*”在 web.config 中添加自定义标头（这仅在 IIS 中有效？）
*   创建一个 http 模块，该模块将在每个请求上返回此标头。还尝试返回实际域名而不是 *.

以及以上所有内容的组合。

任何人都知道我还能尝试什么？

服务应用程序是 MVC 和 WebAPI 的组合（不要认为它有任何区别）。如果我尝试来自同一域的代码 - 它可以工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:33:03.717

如果您使用的是 1.0 或更高版本，您是否在服务器上启用了跨域？（现在默认禁用）

```
RouteTable.Routes.MapHubs(new HubConfiguration { EnableCrossDomain = true }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-10T19:52:00.537

在浪费了几个小时之后，我认为分享我的经验很好：

1.  **不要**将 Access-Control-Allow-Origin 添加到您的 web.config 中（是的，它永远不会添加它，但是在尝试事情时，这实际上是我第一次做的事情，并且在一个简单的 jquery 跨域访问测试之后将它留在那里）

2.  `RouteTable.Routes.MapHubs( new HubConfiguration() { EnableCrossDomain = true } );`适用于继承 Hub 的类

3.  `RouteTable.Routes.MapConnection<MyConnection>( "foo", "/foo", new ConnectionConfiguration { EnableCrossDomain = true } );`这对于继承 PersistentConnection 的类也很有效

# ember.js - {{#linkTo}} 点击期间没有方法“addArrayObserver”

> ID：15177093
> 
> 赞同：2
> 
> 时间：2013-03-02T17:04:38.227
> 
> 标签：ember.js

嘿，不确定是否有人可以帮助我，但我长期以来一直在努力解决这个错误：

`"Uncaught TypeError: Object <App.AssetType:ember408:2> has no method 'addArrayObserver'"`

这是带有 's 的模板，`{{#linkTo}}`单击时会产生此错误

```
<div class="row">
  <div class="twelve columns">
    <h2>{{title}} - Assets</h2>
  </div>
</div>
<div class="row">
  <div class="three columns">
    <ul>
      {{#each assetTypes}}
      {{#linkTo 'product.filter' this}}{{title}}{{/linkTo}}
      {{/each}}
    </ul>
  </div>
  <div class="nine columns">
    {{outlet}}
  </div>
</div> 
```

和应用程序代码

```
window.App = Ember.Application.create
  rootElement: '.solution_products_documents'

App.ApplicationRoute = Ember.Route.extend
  model: ->
    App.Product.find()
App.ApplicationController = Ember.ArrayController.extend
  sortProperties: ['title']

App.ProductRoute = Ember.Route.extend
  model: (params) ->
    App.Product.find params.product_id
  setupController: (controller, model) ->
    controller.set 'documents', model.get 'document_ids'

App.ProductController = Ember.ObjectController.extend
  assetTypes: (->
    docs = @get('documents')
    docs.getEach 'asset_type_id'
  ).property('documents')

App.ProductFilterRoute = Ember.Route.extend
  model: (params) ->
    type = App.AssetType.find params.asset_type_id
    product = this.modelFor 'product'
    docs = product.get 'document_ids'
    model = docs.filterProperty 'asset_type_id', type
App.ProductFilterController = Ember.ArrayController.extend()

App.Router.map ->
  @route 'index', { path: '/' }
  @resource 'product', { path: '/products/:product_id' }, ->
    @route 'filter', { path: '/filter-by/:asset_type_id' }

##
# MODELS / EMBER-DATA
##

serializer = DS.JSONSerializer.create()

serializer.configure 'App.Document',
  sideloadAs: 'documents'

serializer.configure 'App.AssetType',
  sideloadAs: 'asset_types'

serializer.configure 'App.Product',
  sideloadAs: 'products'

App.RestAdaptor = DS.RESTAdapter.extend
  serializer: serializer
  namespace: URL.slice 1
DS.Store.extend(
  adapter: App.RestAdaptor
  revision: 11
).create()

App.Product = DS.Model.extend
  title: DS.attr 'string'
  document_ids: DS.hasMany 'App.Document'

App.Document = DS.Model.extend
  title: DS.attr 'string'
  product_id: DS.belongsTo 'App.Product'
  asset_type_id: DS.belongsTo 'App.AssetType'

App.AssetType = DS.Model.extend
  title: DS.attr 'string'
  document_ids: DS.hasMany 'App.Document'

######### /> END MODELS ################# 
```

如果我将 URL`#/products/4/filter-by/2`放入地址栏中，一切都会按计划进行。只有当我单击`{{#linkTo}}`'s 时才会出现此错误并且不显示内容。错误在到达之前被抛出，`App.ProductFilterRoute`因为`debugger`路由中的语句没有执行，而是在页面刷新时。

非常感谢任何帮助或指导，因为我真的不知道在哪里看。

**更新：**

如果我不使用`{{#linkTo}}`帮助程序而是手动构建 url

`<a href="#/products/{{unbound controller.content.id}}/filter-by/{{unbound this.id}}">{{title}}</a>`

一切正常。linkTo 和手动 href 有什么不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T17:51:37.533

该错误基本上表明当您导航到 ProductFilterRoute 时，Ember 需要一个数组。

**为什么 Ember 在这里需要一个数组？**

1.  您的路线 (ProductFilterController)的**控制器****是 ArrayController 类型**。
2.  我对coffeescript 不是很熟悉，但是您的**模型钩子**似乎也返回了一个数组。**重要提示：模型钩子只是在通过 Url 进入您的 App 时执行。**（这就是为什么您的 Url 手动导航和 href 都可以工作的原因。引用[EmberDoc](http://emberjs.com/api/classes/Ember.Route.html#method_model)：“您可以实现将 URL 转换为该路由的模型的钩子。”）

**为什么会抛出错误？** 所以你的路线围绕着一个数组。你只是传递一个普通的对象。所以黄金法则是：**将相同的数据结构（在本例中为数组）传递给您的 {{linkTo}} 帮助程序，该帮助程序由您的模型挂钩实现返回。**

**一个可能的解决方案：**

1.  使用动作代替 {{linkTo}}
2.  在您的路线中实施一个操作，查找具有给定资产类型的所有文档并将其传递给您的路线。

模板修改：

```
<a {{action 'filterProductByAsset' this}}> {{title}} </a> 
```

ProductFilterRoute 的扩展：

```
events:{
    filterProductByAsset : function(assetTypeId){
        type = App.AssetType.find(asset_type_id);
        product = this.modelFor('product');
        docs = product.get('document_ids');
        models = docs.filterProperty('asset_type_id', type);
        this.transitionTo("product.filter", models)
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:49:51.767

我怀疑这是问题所在：

```
assetTypes: (->
  docs = @get('documents')
  docs.getEach 'asset_type_id'
).property('documents') 
```

这看起来会产生一个像这样的数组：

```
[1,2,3,4,5] 
```

当你真的需要一个响应 id 的对象数组时，例如

```
object1 = Em.Object.create id: 1
object2 = Em.Object.create id: 2
[object1, object2] #etc 
```

如果你想改变这种行为，你需要查看你链接*到*的路由的序列化钩子，在这种情况下`product.filter`

关于`{{linkTo}}`与手动创建的链接，linkTo 助手启用了 js，您应该始终使用它而不是手动链接。当使用 HistoryLocation / pushState 支持时，这会成为一个真正的问题，因为它会强制重新加载整个页面。

这里还有一个问题：你不能像这样观察文件。你必须使用类似的东西`property('documents.@each')`

# jquery - 如何自定义搜索规则以处理 JQGrid 中的日期范围

> ID：15177094
> 
> 赞同：1
> 
> 时间：2013-03-02T17:04:46.247
> 
> 标签：jquery, search, jqgrid, datepicker, date-range

我从服务器加载一次数据，并在高级搜索和工具栏搜索中本地过滤数据。有一个日期时间列，我应该在其上过滤特定日期，如下所示：

`(2013/01/01 --to--> 2013/01/05)`

我将搜索与应用于其他列的其他过滤器一起应用。

我正在使用以下版本：

```
 jQuery: 1.9.1
 jQuery-UI: 1.10.0
 jQGrid: 4.4.4 
 dateRangePicker: http://www.filamentgroup.com/examples/daterangepicker 
```

这是我的代码：

```
 var grid;

    var filters = { groupOp: "AND", rules: [] };

    var toolbarSearchOpts = {
        defaultSearch: "cn",
        multipleSearch: true,
        multipleGroup: false,

        stringResult: true,
        closeOnEscape: true,
        closeAfterSearch: true,
        closeAfterReset: true,
        searchOnEnter: false,

        ignoreCase: true
    };

    $(function () {
        grid = $("#Grid");
        grid.jqGrid({
            url: 'TestHandler.ashx',
            datatype: 'json',
            autowidth: false,
            shrinkToFit: true,
            width: 600,
            height: 'auto',
            colNames: ['ID', 'Created Date'],
            colModel: [
                        { name: 'ID', width: '50%', index: 'ID', key: true, sortable: true, sorttype: "int", searchtype: "integer", searchrules: { "required": true, "number": true, "maxValue": 2000 }, searchoptions: { sopt: ['cn', 'eq', 'ne', 'gt', 'lt', 'ge', 'le', 'bw']} },
                        { name: 'CreatedOn', width: '50%', index: 'CreatedOn', align: 'center', sortable: true, searchtype: "date", datefmt: "Y/m/d h:i",
                            /*searchrules: { custom: true, custom_func: searchRange }, */
                            searchoptions: {
                                sopt: ['cn']
                            , dataInit: function (el) { $(el).daterangepicker({ dateFormat: 'yy/mm/dd', onChange: datePick }); }
                            , beforeSearch: function () {
                                console.log('beforeSearch at ' + ' ' + (new Date()).toLocaleTimeString());
                            }
                            , attr: { title: "Select Date" }
                            }
                        }
                    ],
            rowNum: 500,
            rownumbers: true,
            rowList: [50, 100, 200, 500],
            pager: '#GridPager',
            toppager: true,
            gridview: true,
            viewrecords: true,
            sortname: 'ID',
            sortorder: 'desc',

            loadonce: true,
            cache: true,
            multiselect: true,
            repeatitems: false,

            loadComplete: function () {
                grid.jqGrid('navGrid', '#GridPager', { view: false, add: false, edit: false, del: false, cloneToTop: true }, 
                            {}, // settings for edit
                            {}, // settings for add
                            {},  //settings for delete
                            {multipleSearch: true, multipleGroup: false, stringResult: true, defaultSearch: "cn", ignoreCase: true}, // enable the advanced searching
                            {closeOnEscape:true} /* allow the view dialog to be closed when user press ESC key*/
                            );
                grid.jqGrid('filterToolbar', toolbarSearchOpts);
            },
            caption: 'Test'
        });

    });

    datePick = function () {
        grid[0].triggerToolbar();
        grid.trigger('reloadGrid', [{ page: 1}]);
    }

    searchRange = function (value, columnName) {
        //Value seems to be null here on using cust search. 
        //How to get the applied search rules and modify the same??
        //For date range
        filters.rules.push({ field: "CreatedOn", op: "ge", data: "2013/02/01" });
        filters.rules.push({ field: "CreatedOn", op: "le", data: "2013/02/24" });
        // for specific dates
        //filters.rules.push({ field: "CreatedOn", op: "cn", data: "2013/02/24" });

        // add filters applied for other columns here??
        return filters.rules;
    } 
```

# git - 从两个不同的代码行（常规发布分支和修补程序分支）合并到 Prod 分支的 Git 策略

> ID：15177100
> 
> 赞同：3
> 
> 时间：2013-03-02T17:05:14.570
> 
> 标签：git

我们长期运行的 git 分支是**Master**、**UAT**和**Prod**，这样新的功能就开始工作并最初提交给 Master，然后提升到 UAT（准备好进行 UAT），然后提升到 Prod（准备好进行生产）。我们现在需要能够在生产中创建修补程序。我们计划创建一个与**Prod**分支链接的**Hotfix**分支。除了长时间运行之外，这些分支彼此分开，因为合并是使用“非快进”合并完成的，以保持分支分开（这样我们可以很容易地看到每个分支上发生了什么活动，例如从 Master 到 UAT 的代码提升等）。

 **下面显示了一个最终需要修补程序的常规开发版本的提交流程。由于开发一直在发生，Master 拥有大部分提交。UAT 和 Prod 仅具有代表代码提升的提交。当需要修补程序时，我们从 prod 合并到修补程序，在修补程序分支上进行更改，在修补程序环境中对其进行测试，然后将其合并到 prod 中。

```
hotfix ----------------------o-o----------   [1 commit for the merge prod->hotfix to get the latest state of prod into the hotfix environment, 1 commit of a bugfix to the hotfix environment]
prod   --------------------o-----o--------   [1 commit for the promotion uat-> prod to get the latest uat-tested code into prod, 1 commit for the promotion of the bugfix hotfix->prod]
uat    -----------------o-----------------   [1 commit for the promotion of master->uat of 4 master commits]
master --o---o---o---o----o-o--o---o-o--o-   [10 commits of new functionality] 
```

请注意，在修补程序之后，修补程序更改会手动合并到主分支中。这是因为根据 hotfix 发布的时间和当前开发线的状态（可能是几个月后），Master 和 Hotfix 之间的代码可能过于分歧，从 Hotfix 到 Master 的自动合并可能没有意义. 因此，对于从 UAT 到 PROD、从 PROD 到 HOTFIX 以及从 HOTFIX 到 PROD 的合并，我们不会进行常规的 git 合并，而是使用**git merge -s theirs 策略**，如此处所述：[git使一个分支像另一个分支的命令](https://stackoverflow.com/questions/4911794/git-command-for-making-one-branch-like-another/4912267#4912267)（我们将专门进行模拟#3）。

该策略的作用是说“请合并从上游到下游的所有更改，并消除下游的状态并用来自上游的确切内容替换它”。因此，当我们使用这种策略从 UAT 转到 PROD 时，我们基本上会说“让 PROD 看起来完全像 UAT”。这确保了进入生产环境的正是 UAT 中的代码状态。

**当您有两个分支将更改引入生产（一个用于常规版本，一个用于修补程序）时， git merge -s theirs 策略是执行这种合并策略的正确方法吗？**

如果我们没有修补程序分支，我们将简单地从 master 到 uat 再到 prod 进行常规（非快进）合并，而不使用 git merge -s theirs 策略，因为它不需要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:40:00.587

你有三个选择：

*   要么你只是将你的分支重置为新版本。（在您的情况下似乎没有选择。）
*   你用你的“他们的策略”告诉 git “扔掉旧版本并用新版本替换它”（但 git 并不容易支持这一点）
*   或者您通过使用 --ours 选项将 PROD 合并到 master 来“使”master 的修补程序更改“无效”。

如果可以从 PROD 定期合并到 master，请执行此操作。否则与 --ours 合并并手动对 master 进行相应的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:44:26.820

请考虑您的分支策略。对于一种项目来说完美的策略可能会成为另一个项目的真正负担。

在您的情况下，我会建议一个具有正常开发的开发分支（例如 master），并为每个发布一个单独的分支（基于发布的名称）。

发布分支从 master 开始，进入 UAT。在此阶段发现的问题可以应用小修复。之后它进入生产阶段，可以直接应用任何修补程序。

在您的情况下，确实没有充分的理由链接两个不同版本的提交。**

# php - 使用 PHP file_get_contents 添加到 Delicious 的链接

> ID：15177102
> 
> 赞同：0
> 
> 时间：2013-03-02T17:05:17.437
> 
> 标签：php, json, file-get-contents, delicious-api

我知道这可以通过 curl 来完成，但是如果客户端服务器没有 curl，我会将此作为一个选项。(jic)

我正在这样做，这很有效-

```
$del_url = 'https:// { $user } ':' { $pwd } @api.del.icio.us/v1/posts/add?url='.urlencode( $post_link ).'&description='.urlencode( $post_excerpt );

$data = file_get_contents( $del_url ); 
```

但是当我使用 stream_context_create 时，它​​不起作用，并给我一个“拒绝访问”，我似乎无法理解为什么。

```
$context = stream_context_create(array(
'http' => array(
'method'    => 'GET',
'header'    => "Authorization: Basic " . base64_encode( $user.':'.$pwd ). "\r\nConnection: close\r\n",
'timeout'    => 60
)
));
$del_url = 'https://api.del.icio.us/v1/posts/add?url='.urlencode( $post_link ).'&description='.urlencode( $post_excerpt );

$data = file_get_contents( $del_url, false, $context ); 
```

我不想在 URL 中使用明文密码，....所以我想使用 stream_context_create

如果有人能指出我错过了什么。

# node.js - 为什么我看到一个新的 sess: key in redis 每个请求？

> ID：15177105
> 
> 赞同：3
> 
> 时间：2013-03-02T17:05:27.263
> 
> 标签：node.js, redis, connect

我有一个简单的 node.js 服务器测试 connect-redis 模块作为会话存储。一切正常，但我注意到我得到了一个新的 sess：在每个请求上输入 redis。我希望只有一个键，因为只有一个会话。

![redis-cli 显示多个 sess: 键](../Images/a86116d371eb6eba3b21f0973a1ba7b4.png)

这是我的代码：

```
var connect = require('connect');
var util = require("util");
var RedisStore = require("connect-redis")(connect);
var http = require('http');

var app = connect()
  .use(connect.cookieParser('keyboard cat'))
  .use(connect.query())
  .use(connect.session( {
      secret:"elms",
      store:new RedisStore({prefix:'sid_'}),
      cookie:{maxAge:60000, secure:false}
    }))
  .use(function(req, res, next) {
    var sess = req.session;
    if (sess.views) {
      res.setHeader('Content-Type', 'text/html');
      res.write("<p>" + util.inspect(req.cookies) + "</p>");
      sess.basket = sess.basket || {book1:0, book2:0, book3:0};
      if(req.query.buyBook1) {sess.basket.book1 ++;}
      if(req.query.buyBook2) {sess.basket.book2 ++;}
      if(req.query.buyBook3) {sess.basket.book3 ++;}
      if(req.query.expiresession) {
        sess.cookie.maxAge = 0;
      }
      res.write('<p>views: ' + sess.views + '</p>');
      res.write('<ul>\
                  <li>book1 ' + sess.basket.book1 + ' - <a href="/?buyBook1=true">Add</a></li>\
                  <li>book2 ' + sess.basket.book2 + ' - <a href="/?buyBook2=true">Add</a></li>\
                  <li>book3 ' + sess.basket.book3 + ' - <a href="/?buyBook3=true">Add</a></li>\
                </ul>\
                <a href="/?expiresession=true">Expire session</a>');
      res.write('<p>expires in: ' + (sess.cookie.maxAge / 1000) + 's</p>');
      res.write('<p>httpOnly: ' + sess.cookie.httpOnly + '</p>');
      res.write('<p>path: ' + sess.cookie.path + '</p>');
      res.write('<p>domain: ' + sess.cookie.domain + '</p>');
      res.write('<p>secure: ' + sess.cookie.secure + '</p>');
      sess.views ++;
    } else {
      sess.views = 1;
    }

    res.write("<p>" + util.inspect(req.cookies) + "</p>");
    res.end('welcome to the session demo. refresh!');
  });
http.createServer(app).listen(3000); 
```

我注意到 req.session.cookie.domain 始终为空。我在 Windows 8 上并使用主机文件将 127.0.0.1 映射到 www.gaz-node.com，这就是我希望 cookie 域位于服务器上的内容。可能有关系。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-03T08:52:12.790

答案很简单。这个星期天早上我起得特别早，为了调试它，在我第一杯咖啡的中途，答案突然变得清晰，后来尝起来比前半杯好。

**/favicon.ico 请求的复仇**

我没有处理来自浏览器对 /favicon.ico 的请求，这对于像我这样的节点新手来说有点困难。每个请求后面都有一个 /favicon.ico 请求（至少是 Chrome 请求），因此浏览器可以显示站点的图标。在获得 favicon.ico 之前，它永远不会放弃。

实际的会话运行良好，只有一个会话 ID，但对 /favicon.ico 的请求没有发送任何 cookie，并且每个请求都触发了一个新的僵尸会话。

为了解决这个问题，我添加了一个模块来处理 /favicon.ico 请求并提供 404 响应。我可以很容易地给无情的浏览器一个图标并使用“fs”模块发送它。

在使用会话模块之前，处理 /favicon.ico 并结束响应，而不调用 next()，这一点很重要！这是固定代码：

```
var connect = require('connect');
var util = require("util");
var RedisStore = require("connect-redis")(connect);
var http = require('http');

var app = connect()
  .use(function(req, res, next) {
    if(req.url == '/favicon.ico') {
      serve404(res);
    } else {
      next();
    } 
  })
  .use(connect.cookieParser())//"elms123"))
  .use(connect.query())
  .use(connect.session( {
      secret:"elms123",
      store:new RedisStore({prefix:'sid_'}),
      cookie:{maxAge:60000, secure:false, domain:"gaz-node.com"}
    }))
  .use(function(req, res, next) {
    var sess = req.session;
    res.setHeader('Content-Type', 'text/html');
    res.write('welcome to the session demo. refresh!');
    if (sess.views) {

      res.write("<p>" + util.inspect(req.cookies) + "</p>");
      sess.basket = sess.basket || {book1:0, book2:0, book3:0};
      if(req.query.buyBook1) {sess.basket.book1 ++;}
      if(req.query.buyBook2) {sess.basket.book2 ++;}
      if(req.query.buyBook3) {sess.basket.book3 ++;}
      if(req.query.expiresession) {sess.cookie.maxAge=0;}
      if(req.query.forceerror) {/*idontexist()*/throw new Error('ahhhh!');}

      res.write('<p>views: ' + sess.views + '</p>');
      res.write('<ul>\
                  <li>book1 ' + sess.basket.book1 + ' - <a href="/?buyBook1=true">Add</a></li>\
                  <li>book2 ' + sess.basket.book2 + ' - <a href="/?buyBook2=true">Add</a></li>\
                  <li>book3 ' + sess.basket.book3 + ' - <a href="/?buyBook3=true">Add</a></li>\
                </ul>\
                <a href="/?expiresession=true">Expire session</a>\
                <a href="/?forceerror=true">Force error</a>');
      res.write('<p>expires in: ' + (sess.cookie.maxAge / 1000) + 's</p>');
      res.write('<p>httpOnly: ' + sess.cookie.httpOnly + '</p>');
      res.write('<p>path: ' + sess.cookie.path + '</p>');
      res.write('<p>domain: ' + sess.cookie.domain + '</p>');
      res.write('<p>secure: ' + sess.cookie.secure + '</p>');
      sess.views ++;
    } else {
      sess.views = 1;
    }

    res.end("<p>" + util.inspect(req.cookies) + "</p>");
  })
  .use(connect.errorHandler());
http.createServer(app).listen(3000);

function serve404(res) {
  res.writeHead(404, {"content-type": "text/plain"});
  res.end("Error : Resource not found");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T15:24:13.380

我也有这个问题。当然，我们应该使用“favicon”中间件。并确保将“会话”中间件放在“静态”下方。查看我的答案[https://stackoverflow.com/a/21094838/3190612](https://stackoverflow.com/a/21094838/3190612)

# c++ - 关于容器中元素的引用

> ID：15177111
> 
> 赞同：0
> 
> 时间：2013-03-02T17:05:57.230
> 
> 标签：c++, reference, containers

谁能告诉我函数返回`Type&`容器（例如）中元素的引用（即）是否安全`boost::unordered_map`？

如果我们可以这样做，为什么？因为我认为引用类型的工作方式和指针一样（如果我错了请纠正我），并且容器中元素的内存地址可能会随着时间的推移而改变，所以如果引用不再是以前的样子怎么办。我对吗？

如果可以，我们可以返回容器中元素的指针吗？

我有这个问题是因为我看到这发生在其他人的代码中，它工作得很好......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:07:46.180

这取决于。

完全没问题，只要容器从未被修改过。如果容器**被**修改，那么每个容器类都有自己的规则来决定对现有元素的引用何时失效。

C++ 标准是查找规则的官方方法，但在大多数情况下，您可以安全地阅读良好的在线参考（没有双关语），例如[http://cppreference.com](http://cppreference.com)。例如，我们知道这[`std::vector::insert`](http://en.cppreference.com/w/cpp/container/vector/insert)肯定会使对所有后续元素的引用无效，并且可能会使对所有元素的引用无效。

# macros - Autohotkey - 条码宏 - 如果扫描了某个条码，如何触发脚本？

> ID：15177112
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:06:04.050
> 
> 标签：macros, triggers, barcode, autohotkey

我想创建条形码宏 - 如果用户扫描某个条形码，它将运行一个脚本。条码可以是任意字符串，只是为了触发脚本。有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:17:15.067

要根据特定输入（例如键盘）运行脚本，请执行以下操作：

扫描字符串示例：asdkffasdf

```
:?*:asdkffasdf::
    SoundBeep, 500,500
    MsgBox, String asdkffasdf has been scanned
Return 
```

# scala - scala 集合转换

> ID：15177113
> 
> 赞同：3
> 
> 时间：2013-03-02T17:06:08.063
> 
> 标签：scala, scala-collections

不同 scala.collection 对象之间最有效的转换方式是什么？

例如

```
 val a=scala.collection.mutable.ListBuffer(1,2,0,3) 
```

我想得到`scala.collection.mutable.ArrayBuffer`.

1.  根据[http://docs.scala-lang.org/resources/images/collections.mutable.png](http://docs.scala-lang.org/resources/images/collections.mutable.png)应该可以通过转换为`Buffer`和`ArrayBuffer`之后。正确的？

2.  一般来说，我可以通过它的共同祖先在 scala 集合中进行任何转换吗？（在前面的例子中，共同祖先是`Buffer`）

PS我阅读了[http://docs.scala-lang.org/overviews/collections/introduction.html](http://docs.scala-lang.org/overviews/collections/introduction.html)，但找不到关于各种类型之间一般转换的任何信息（我知道.toArray之类的方法）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:22:38.200

语法上最有效的应该是[`to`](http://www.scala-lang.org/api/current/index.html#scala.collection.Traversable)2.10 中引入的方法：

```
def to[Col[_]]: Col[A] 
```

> 通过复制所有元素将此集合转换为另一个集合。注意：对于无限大小的集合不会终止。

将其用作`a.to[scala.collection.mutable.ArrayBuffer]`.

效率方面，除非您进行类似向上转换的转换，将子类型转换为更通用的集合，否则转换将涉及复制元素。在您的示例中，将列表缓冲区转换为缓冲区然后转换为数组缓冲区并不重要——您可以直接使用 执行此操作`to`，因为您会导致将元素从链表复制到数组中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:23:26.667

回答第 2 题：

```
Welcome to Scala version 2.10.0 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_07).
Type in expressions to have them evaluated.
Type :help for more information.

scala> import collection.mutable._
import collection.mutable._

scala> List(1,2,3,4,5)
res0: List[Int] = List(1, 2, 3, 4, 5)

scala> res0.to[ArrayBuffer]
res1: scala.collection.mutable.ArrayBuffer[Int] = ArrayBuffer(1, 2, 3, 4, 5)

scala> res0.to[ListBuffer]
res2: scala.collection.mutable.ListBuffer[Int] = ListBuffer(1, 2, 3, 4, 5) 
```

只要保持兼容性，您就可以随意转换它们：

```
scala> res0.to[Map]
<console>:12: error: scala.collection.mutable.Map takes two type parameters, expected: one
              res0.to[Map]
                      ^ 
```

# ajax - MVC - Ajax - Chrome 和 IE 9 之间的不一致

> ID：15177114
> 
> 赞同：0
> 
> 时间：2013-03-02T17:06:13.847
> 
> 标签：ajax, asp.net-mvc-4, pagedlist

我有一个 MVC 视图，我正在使用该`PagedList`组件对数据进行一些分页。我支持此功能的 JavaScript 如下所示：

```
$(function () {

    var getPage = function () {
        var $a = $(this);

        var options = {
            url: $a.attr("href"),
            type: "get"
        };

        $.ajax(options).done(function (data) {
            var target = $a.parents("div.pagedList").attr("data-ExchangeSite-target");
            data: $("form").serialize(),
            $(target).replaceWith(data);
        });

        return false;
    };

    $(".main-content").on("click", ".pagedList a", getPage);

}); 
```

我的 .cshtml 文件部分看起来像这样：

```
 @model ExchangeSite.Entities.BicycleSearchSeller

    <div id="itemList">

        <div class="pagedList" data-ExchangeSite-target="#itemList">
            @Html.PagedListPager(Model.BicycleSellerListingList, pageNumber => Url.Action("Index", new {pageNumber}),
            PagedListRenderOptions.ClassicPlusFirstAndLast)
        </div>
   ...
   ... 
```

在 IE9 中，这非常有效。当我单击特定页码或下一页/上一页时，将对我的控制器进行异步调用以刷新数据列表（“​​itemList”）。但是，在 Chrome 中，对我的控制器进行了两次调用。一个是 Ajax 调用，另一个不是。谁能告诉我为什么在 Chrome 中对我的控制器进行了两次调用？如果您需要查看更多代码，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:43:25.523

您的成功回调中似乎有一些错误线：

```
data: $("form").serialize(), 
```

它以逗号而不是分号结束。它后面还包含一个冒号`data`。与 Google Chrome 相比，IE 对损坏的 javascript 可能更宽容一些。

# python - Python 请求无法使用端口？

> ID：15177115
> 
> 赞同：3
> 
> 时间：2013-03-02T17:06:28.260
> 
> 标签：python, urllib2, urllib, python-requests

我在端口 X 上有一个 http 服务器。现在我尝试使用 request.get("host:X") 来获取一个网站。我得到一个状态码 400。之后我尝试了 urllib2.open("host:X") 并且它起作用了。

Requests 中是否有使用端口的特殊参数？我没有找到。或者它根本不起作用？

# cordova - phoneGap 应用程序能否禁用电子邮件和短信等电话功能？

> ID：15177125
> 
> 赞同：0
> 
> 时间：2013-03-02T17:07:18.983
> 
> 标签：cordova

我希望创建一个应用程序，通过禁用某些手机功能来帮助我集中注意力并消除干扰。

我在应用程序开发方面没有太多经验，但我确实有一些 javascript/html 背景。我想知道使用phonegap是否可以实现以下操作：

1.  在一天中的特定时间禁用短信通知并自动回复。
2.  禁用对特定网站/域的 Internet 访问。
3.  禁用电子邮件警报
4.  把手机调成飞行模式

我无法通过 phonegap api 找到答案，并希望有 phonegap 经验的人可以为我节省大量时间，避免陷入死胡同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:11:24.373

由于 PhoneGap 允许您向现有项目添加[插件，因此您可以在基于 Objective C 的原生应用程序中做任何您可以做的事情。](http://docs.phonegap.com/en/2.2.0/guide_plugin-development_index.md.html)但是PhoneGap背后的想法是编写一次并部署在多个设备上，如果您要为iOS定制应用程序，那么您不妨编写一个实际的iOS应用程序。

# ruby-on-rails - Rails - 在新对象表单上，如何显示关联对象 ID 的列表

> ID：15177133
> 
> 赞同：1
> 
> 时间：2013-03-02T17:08:00.113
> 
> 标签：ruby-on-rails

当创建一个新的插图对象时，我希望显示一个可选择的现有小说 ID（主键）列表。也就是说，插图必须添加到现有的小说中。我找不到这样做的正确语法。这些关联经过测试并正常工作。将来我想从小说标题列表中进行选择，但将 novel_id 分配给幕后的插图。谢谢你。

这就是我到目前为止所拥有的，我已经尝试了许多不同风格的这个语句，但没有运气：

```
<div class="field">
  <%= f.label :novel_id%><br />
  <%= f.collection_select(:novel_id, Novel.all, :id, :prompt => true) %>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:14:59.513

用这个...

```
 <%= f.select(:novel_id, options_from_collection_for_select(Novel.all, 'id', 'name')) %> 
```

# javascript - 我无法根据条件旋转桌子

> ID：15177135
> 
> 赞同：2
> 
> 时间：2013-03-02T17:08:12.780
> 
> 标签：javascript, html, css, transform

我想将我的桌子旋转 180 度。我写了一个 CSS 来工作，但它不起作用。这是代码

```
function rotateTable()
{
 table.className="tablecss";
}

<style type="text/css">
        .tablecss
        {       
         transform:rotate(180deg);
        }
</style> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T17:12:52.867

也添加以下内容：

```
-webkit-transform: rotate(180deg);
-o-transform: rotate(180deg);
-moz-transform: rotate(180deg); 
```

你会得到[这样](http://jsfiddle.net/YmS4E/embedded/result/)的输出。

# html - 当我使用 angularJS ng-repeat 时，它没有显示我在 javascript 中附加的内容

> ID：15177145
> 
> 赞同：1
> 
> 时间：2013-03-02T17:09:43.643
> 
> 标签：html, angularjs

> 在 HTML 中，我想显示多行项目（任务时间线）。在每一行中，gantt-items,gantt-days 用于绘制一年 365 天呈现的 365 个小盒子。并且每一行都需要显示一个蓝色块，表示该任务的分配周期。{{timeline(item.data.sDate,item.data.eDate)}}，每一行只包含一个蓝色块。

**HTML**

```
<ul>
   <li ng-repeat="item in items.entities">
     <ul class="gantt-items" style="width: 9150px; height: 35px" >
        <li class="gantt-item" >            
           <ul class="gantt-days">
           </ul>       
         </li>          
       </ul>
     {{timeline(item.data.sDate,item.data.eDate)}}
   </li>
 </ul> 
```

**JS**

```
angular.module('myApp', ['ngResource']);
   function MainCtrl($scope,$resource){
      $(document).ready(function(){
         ...
         for(var i = 1; i < 366; i++){
            $(".gantt-item ul.gantt-days").append('<li class="gantt-day" style="width: 25px"><span style="line-height: 35px; height: 35px">' + year + "-" + d.getMonth() + "-" + d.getDate() + '</span></li>');
            d = new Date(d.getTime() + (24 * 60 * 60 * 1000));
         }
         ...});

$scope.timeline = function GetLength(startDate, endDate){
    var firstDay = new Date(new Date().getFullYear(), 0, 1);

    var st1 = startDate.split("/");
    var dt1 = new Date(st1[2], st1[1] - 1, st1[0]);

    var st2 = endDate.split("/");
    var dt2 = new Date(st2[2], st2[1] - 1, st2[0]);

    var startPoint = ((dt1.getTime() - firstDay.getTime())/1000/60/60/24)*25;
    var length = (1+(dt2.getTime() - dt1.getTime())/1000/60/60/24)*25;
    $(".gantt-item ul.gantt-days").append('<span class="gantt-block" style="left:' + startPoint + 'px; width: ' + length + 'px; height: 27px"><strong class="gantt-block-label">Duration</strong></span>');
}; 
```

> 当我使用 ng-repeat 时，$(".gantt-item ul.gantt-days").append 不起作用。并且时间线(item.data.sDate,item.data.eDate) 在每一行中重复 n 次，这假设每个原始 n 行只显示一个项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:30:48.240

这是因为`ng-repeat`指令中的元素出现在 DOM 编译之后。
尝试使用[`$watch`](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24watch)：

```
$scope.$watch('items.entities', function(){
    for(var i = 1; i < 366; i++){
        $(".gantt-item ul.gantt-days").append('<li class="gantt-day" style="width: 25px"><span style="line-height: 35px; height: 35px">' + year + "-" + d.getMonth() + "-" + d.getDate() + '</span></li>');
        d = new Date(d.getTime() + (24 * 60 * 60 * 1000));
     }
}); 
```

# python - Windows 7 64 位上的 PyDev 2.7.1：获取解释器信息时出错（与 QGIS 相关）

> ID：15177149
> 
> 赞同：0
> 
> 时间：2013-03-02T17:10:22.793
> 
> 标签：python, python-2.7, pydev, qgis

我从 OSGeo4W 包中安装了 QGIS，其中还包括 Python 2.7 和许多用于 Python 的空间库。

我在 Windows 7 中设置了以下环境变量：

```
Path = [...];C:\OSGeo4W\bin

PYTHONPATH = C:\OSGeo4W\apps\python27\lib;
C:\OSGeo4W\apps\qgis\python;
C:\Users\username\.qgis\python;
C:\Users\username\.qgis\python\plugins;
C:\OSGeo4W\apps\qgis\python\plugins;
C:\OSGeo4W\apps\python27\DLLs;
C:\OSGeo4W\apps\qgis\bin;
C:\OSGeo4W\apps\python27\lib\site-packages;
C:\OSGeo4W\apps\qgis\python\plugins\fTools; 
```

从 W7 CLI 执行 C:\OSGeo4W\bin\python.exe 或只是 python（因为它得到正确解析）时，我可以导入`import pyspatialite`没有问题的东西，所以我假设 PYTHONPATH 设置正确。

但是，当尝试在 PyDev 中添加 Python 解释器时，出现以下错误：

```
Error getting info on interpreter: See error log for details.
No output was in the standard output when trying to create the interpreter info.
The error output contains:>>ImportError: No module named site<< 
```

就好像 PyDev 无法识别 PYTHONPATH。此外，在“库”-选项卡下，我没有看到任何条目（这再次暗示 PyDev 无法识别 PYTHONPATH）。

我已经重新启动了 Eclipse，但没有成功。

**更新：重新启动整个系统工作。天哪，我们还生活在 90 年代。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:51:18.327

重新启动整个 W7 系统有所帮助。它仍然像回到 Windows XP 时代..

# drupal - 颜色框“此内容加载失败。” 错误

> ID：15177154
> 
> 赞同：0
> 
> 时间：2013-03-02T17:10:54.987
> 
> 标签：drupal, load, colorbox

我需要在页面加载时加载带有颜色框的订阅表单。颜色框在页面加载时打开，但在里面我只看到一条错误消息“此内容加载失败。”。这是我使用的代码

**JS**

```
jQuery(document).ready(function($) {
    $('.colorbox5').colorbox({open:true, href:'div#content5'});  
    });
    .... 
```

**HTML**

```
 <body>
       <div style="display:none;">
        <div id="content5" class="colorbox5">
        ... my form here
        </div>
       </div> 
```

有人可以帮我解决这个问题吗？（我正在使用 Drupal）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:30:05.743

在“内容类型”下查看[此处](http://www.jacklmoore.com/colorbox)，您需要告诉 colorbox 它正在显示内联内容。所以，我认为你需要这个：`$('.colorbox5').colorbox({open:true, href:'div#content5', inline:true,});`

# ios - 如何通过objective-c代码提交web表单（发送POST信息并保留cookies）

> ID：15177155
> 
> 赞同：2
> 
> 时间：2013-03-02T17:11:02.263
> 
> 标签：ios, objective-c, ios5, ios6, nsxmlparser

我正在为其创建应用程序的网站没有 API，但我需要使用它。我可以通过解析 HTML 和处理节点轻松地从网站获取信息，但我还需要能够输入数据。瞬间，我需要使用用户已经在设置中输入的信息“登录”。要在现实生活中执行此操作，我会单击用户名字段，然后单击密码字段，然后单击确定，但是通过代码，我需要直接通过 POST 发送。

此外，我需要能够保留会话 cookie。

我该怎么做呢？

# mysql - Rails 模型未与数据库正确同步

> ID：15177159
> 
> 赞同：1
> 
> 时间：2013-03-02T17:11:36.740
> 
> 标签：mysql, ruby-on-rails

我有一个`Merchant`带有属性`name`和`id`. 我遇到了一个问题，rails 和我的数据库在某个商家的名称上存在分歧。

这是 Rails 发生的事情：

```
1.9.2p320 :001 > Merchant.where(:id=>550).count 
=> 1 
1.9.2p320 :002 > Merchant.where(:id=>550).first.name
=> nil 
```

这就是mysql发生的事情：

```
mysql> SELECT name FROM merchants WHERE id=550;
+----------+
| name     |
+----------+
| Testname |
+----------+
1 row in set (0.00 sec) 
```

根据`FlyersAdmin::Application.config.database_configuration[::Rails.env]`我的第一个代码窗口中rails使用的数据库与第二个窗口中mysql使用的数据库相同。为什么商家的名字是`nil`“Testname”而不是“Testname”是我难倒的。

值得注意的是，最近我用新数据更新了他们都使用的数据库，这是否可能导致差异？也许 Rails 缓存了数据，所以还没有查看更新的数据库？我很难过，任何帮助表示赞赏。

编辑：这是另一个增加谜团的线索：运行`Merchant.where(:name => nil)`返回空列表！为什么不选择 id 为 550 的商家？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:21:22.490

这应该是什么输出`Merchant.where(:id=>550).first.name`？可能您创建了一个 Merchant，但您只是没有定义名称，因此它获得了默认值`nil`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:02:45.407

无论如何，当您选择一条记录时，为什么要执行 .first ？

```
Merchant.find(550).name 
```

应该给你你的记录。

尝试

```
Merchant.first.name 
```

获得模型的第一条记录。

# java - 给出错误的 AlertDialog 示例

> ID：15177160
> 
> 赞同：4
> 
> 时间：2013-03-02T17:11:56.957
> 
> 标签：java, android, android-dialogfragment

我是 Java/Android 开发的新手（我昨晚开始学习），所以我完全有可能在做一些非常愚蠢的事情。然而，经过一个多小时的谷歌搜索，我什么也没想到。我使用 Eclipse 作为我的编辑器。

我正在阅读[此处](http://developer.android.com/reference/android/app/DialogFragment.html)的文档`AlertDialog`，其中给出了一个示例：

```
public static class MyAlertDialogFragment extends DialogFragment {

    public static MyAlertDialogFragment newInstance(int title) {
        MyAlertDialogFragment frag = new MyAlertDialogFragment();
        Bundle args = new Bundle();
        args.putInt("title", title);
        frag.setArguments(args);
        return frag;
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        int title = getArguments().getInt("title");

        return new AlertDialog.Builder(getActivity())
                .setIcon(R.drawable.alert_dialog_icon)
                .setTitle(title)
                .setPositiveButton(R.string.alert_dialog_ok,
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int whichButton) {
                            ((FragmentAlertDialog)getActivity()).doPositiveClick();
                        }
                    }
                )
                .setNegativeButton(R.string.alert_dialog_cancel,
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int whichButton) {
                            ((FragmentAlertDialog)getActivity()).doNegativeClick();
                        }
                    }
                )
                .create();
    }
} 
```

我最初重写了它，所以我可以开始将一些方法提交到内存中，但是得到一个错误*"FragmentAlertDialog cannot be resolve to a type"*。我点击`Ctrl`++`Shift`以`O`确保我有正确的导入，但它仍然没有消失。

所以我复制/粘贴了示例代码并按以下顺序执行了以下操作：

1.  点击`Ctrl`++以获得正确的导入（使用, not `Shift`）`O``android.app.DialogFragment``android.support.v4.app.DialogFragment`
2.  在顶部声明我的包裹
3.  分别替换为`R.string.alert_dialog_ok`和_`R.string.alert_dialog_cancel``android.R.string.ok``android.R.string.cancel`
4.  已删除`setIcon()`，因为我还没有要放入的图标

我仍然收到错误：

1.  `FragmentAlertDialog`无法解析为类型 (x4)
2.  类的非法修饰符`MyAlertDialogFragment`；只有`public`, `abstract`&`final`是允许的

我做错了什么，还是示例代码有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:17:48.430

> 1.FragmentAlertDialog

确保您要投射到的 Activity 被命名为`FragmentAlertDialog`。确保还保存所有内容 - 有时 Eclipse 在保存所有内容之前不会建立连接。

> 2.MyAlertDialogFragment 类的非法修饰符；只允许公开、抽象和最终

取出`static`修饰符：

```
public class MyAlertDialogFragment extends DialogFragment { 
```

或保留`static`并移动此 Fragment，使其包含在您想要的 Activity 中。这意味着它`MyAlertDialogFragment`应该在您的 Activity 中，*在*该 Activity 的右括号之前。

> 我是 Java/Android 开发的新手

不要从这么复杂的事情开始。学习[Java](http://docs.oracle.com/javase/tutorial/)，然后转向[Android。](http://developer.android.com/training/basics/firstapp/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:21:37.757

嗨，试试这些代码来实现警报对话框

```
 AlertDialog.Builder alert2 = new AlertDialog.Builder(this);  
            alert2.setTitle("Your Title");
            alert2.setMessage("Your Messages");
            final EditText input2 = new EditText(this);
            input2.setInputType(InputType.TYPE_CLASS_PHONE);
            alert2.setView(input2);
            alert2.setPositiveButton(GButton, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int whichButton) {
                    // Do something with value!                 
                    try
                    {
                    // do your stuff here   
                    }
                    catch(Exception e)
                    {

                    }
                } 
            });

            alert2.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int whichButton) {
                    // Canceled.
                }
            });

            alert2.show(); 
```

# knockout.js - Knockout css binding 渲染 => class=" 0 1 2 3 4 5 6 with KO 2.0

> ID：15177163
> 
> 赞同：7
> 
> 时间：2013-03-02T17:12:10.573
> 
> 标签：knockout.js

我用这段代码得到一个奇怪的样式文本：

```
self.styleClass = ko.computed(function () {
            return self.isFollowing() ? "button" : "secondary button";
        });

      <button data-bind="text: followButtonText,click: toggleIsFollowing, css: styleClass"></button> 
```

它呈现：

```
<button data-bind="text: followButtonText,click: toggleIsFollowing, css: styleClass" class=" 0 1 2 3 4 5 6 7 8 9 10 11 12">Unfollow</button> 
```

model.styleClass() 在控制台中呈现良好

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-02T18:04:16.603

绑定的语义`css`已从 KO 2.1.0 更改为 KO 2.2.0

从[Knockout 2.2.0 发布](http://blog.stevensanderson.com/2012/10/29/knockout-2-2-0-released/)：

> 我们还使一些功能更像您一直认为它们应该工作的那样工作。例如，css 绑定现在可以将编程生成的 CSS 类名附加到元素（以前，它仅限于切换预定义的 CSS 类名）。

所以升级到**KO 2.2.1**就可以了。

如果您无法升级，您可以使用`attr`绑定作为解决方法：

```
<button data-bind="text: followButtonText, 
                   click: toggleIsFollowing,
                   attr:{ class: styleClass}" /> 
```

演示[JSFiddle 使用 KO 2.0.0 和 attr 绑定](http://jsfiddle.net/JtJQz/1/)

# iphone - iOS 上的快速纹理数据更新

> ID：15177164
> 
> 赞同：2
> 
> 时间：2013-03-02T17:12:14.070
> 
> 标签：iphone, opengl-es-2.0

我需要在每一帧更新一个纹理的纹理数据。有什么方法可以非常快地做到这一点？对我来说最好的选择是与 GL_APPLE_client_storage 类似的东西，但 iOS 不支持。显而易见的解决方案是每帧调用 glTexImage2D ，但这会复制数据，而且我必须在内存中保留相同的纹理 2 次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T04:10:34.473

也许你应该使用`glTexSubImage2D`更新纹理。看[这里](http://www.opengl.org/wiki/Common_Mistakes#Updating_a_texture)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:32:53.853

纹理缓存（在 iOS 5.0 中添加）提供与`GL_APPLE_client_storage`iOS 相同的功能。在最初创建时，它们似乎确实触发`glTexImage2D()`了`GL_APPLE_client_storage`.

它们在处理相机帧时提供了特殊的性能提升，因为 AV Foundation 针对这种情况进行了优化。我在相机的[这个答案中详细描述了它是如何工作的。](https://stackoverflow.com/questions/9544293/where-is-the-official-documentation-for-cvopenglestexture-method-types/9574798#9574798)对于原始数据，您可以创建自己的 CVPixelBufferRef 用于此，然后写入其内部内容以直接更新纹理。

您必须对此小心一点，因为您可能会在渲染场景时覆盖纹理数据，从而导致撕裂和其他伪影。

# ios - FMDB ios 没有这个表

> ID：15177165
> 
> 赞同：10
> 
> 时间：2013-03-02T17:12:46.657
> 
> 标签：ios, sqlite, fmdb

我正在做的一个 sqlite 项目有问题，我正在使用 FMDB，我遵循了一个简单的示例，但不起作用。而且我找不到错误。我从终端做了我的数据库模式，我在上面放了一些数据。我对 ios dev 很陌生，所以我不知道我是否正确地执行了这些步骤。这就是我所做的：

1 - 我制作了我的数据库模式并添加了一些字段。2 - 我将 database.db 复制到 xcode 中的项目文件夹中。3 - 我添加了 FMDB 文件。4 - 我添加 sqlite3.dylib 5 - 我把这段代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.dbname = @"database.db";
    NSArray * docPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString * docDIr = [docPath objectAtIndex:0];
    self.dbpath = [docDIr stringByAppendingPathComponent:dbname];

    [self checkDB];

    [self getQ];

    return YES;
}
-(void) getQ
{
    FMDatabase * db = [FMDatabase databaseWithPath:dbpath];
    [db open];

    FMResultSet * result = [db executeQuery:@"SELECT * FROM table1"];

    NSLog(@"last Error: %@",[db lastErrorMessage]);
    NSLog(@"result: %@", result);
}
-(void) checkDB
{
    BOOL success;
    NSFileManager * fm = [NSFileManager defaultManager];
    success = [fm fileExistsAtPath:dbpath];
    NSError * error = [[NSError alloc] init];
    if (success) return;
    NSLog(@"result:");
    NSString * dbPathFromApp = [[[NSBundle mainBundle] resourcePath]stringByAppendingPathComponent:self.dbname];

    [fm copyItemAtPath:dbPathFromApp toPath:dbpath error:&error];           
} 
```

显然数据库是空的，所以发生了什么？为什么我找不到 table1 ？如果我用任何 sqlite gui 打开文件，表格看起来就好了。感谢您的帮助控制台向我显示下一行：2013-03-02 14:03:31.839 myApp[21433:c07] 最后错误：没有这样的表：table1 2013-03-02 14:03:31.841 myApp[21433: c07] 结果：（空）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-02T17:20:36.110

几个想法：

1.  我会确认数据库已添加到您的捆绑包中。转到您的目标设置，选择“Build Phases”，展开“Copy Bundle Resources”，并确保您的数据库在此处列出。如果没有，请单击“+”按钮并添加它。

    ![捆](../Images/77e91df126360e370e88ae42f61cad97.png)

2.  我会重置你的模拟器。如果您曾经运行过该应用程序并且没有正确复制数据库，它会在您的文档文件夹中为您创建一个空白数据库。通过重置您的模拟器，您可以摆脱可能存在的任何空白数据库。

3.  如果它仍然无法正常工作，我会在您的模拟器中检查捆绑数据库。导航到模拟器文件夹（~/Library/Application Support/iPhone Simulator），找到应用程序，打开包（通过控制单击应用程序本身并说“显示包内容”），然后检查那里的数据库并制作确定它有你的`table1`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-03-08T10:35:51.430

添加数据库文件后，请选择该文件并勾选标记目标成员。

![检查附件](../Images/c0382539e0d97ccd2a9e2d143c755149.png)

# javascript - HighCharts - 图表底部和 Xaxis 标签之间需要更多空间

> ID：15177166
> 
> 赞同：2
> 
> 时间：2013-03-02T17:12:48.550
> 
> 标签：javascript, highcharts

我试图在我的 highcharts plotArea 和 xAxis 之间获得更多空间......到目前为止似乎没有任何工作。图片显示了它们有多接近，我想再添加大约 30 像素。

感谢您的帮助！！

![在此处输入图像描述](../Images/28f8f983a0b92296cdb36408b92ec67b.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T20:20:27.963

假设我正确理解了您的问题...

这是[Highcharts 文档](http://api.highcharts.com/highcharts#xAxis.labels)的标准`xAxis`和修改。`yAxis`

[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/labels-x/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/xaxis/labels-x/)

* * *

现在，这是小提琴的一个叉子，但**标签**`xAxis`被推得更远。

[http://jsfiddle.net/BCPL5/](http://jsfiddle.net/BCPL5/)

相关的 Highcharts API 文档：
[http ://api.highcharts.com/highcharts#xAxis.labels](http://api.highcharts.com/highcharts#xAxis.labels)

* * *

对 的更改`xAxis`在此声明中。

```
 ...

    xAxis: {
        labels: {
            y: 25
        }
    },

    ... 
```

* * *

现在，您也可以使用[offset](http://api.highcharts.com/highcharts#xAxis.offset)，如下面的 Highcharts 示例所示，但我认为这不是您想要的。

[http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/yaxis/offset/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/yaxis/offset/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T14:04:48.247

您可以尝试设置 min/maxPadding [http://api.highcharts.com/highstock#yAxis.minPadding](http://api.highcharts.com/highstock#yAxis.minPadding)

# ruby - 与子类的超类的实例方法调用混淆

> ID：15177169
> 
> 赞同：1
> 
> 时间：2013-03-02T17:12:54.617
> 
> 标签：ruby

我只是想看看来自子类的实例方法调用，并使用了下面的测试代码：

```
class Animal
  def bark
    p "hukkhh"
  end
end
#=> nil

class Cow < Animal
end
#=> nil

Cow.public_instance_method(:bark)
#=> #<UnboundMethod: Cow(Animal)#bark>

class Cow
  bark
end
#=> NameError: undefined local variable or method `bark' for Cow:Class
#        from (irb):11:in `<class:Cow>'
#        from (irb):10
#        from C:/Ruby193/bin/irb:12:in `<main>' 
```

从该代码中，我确认没有相应类的对象实例就无法执行实例方法。

但后来我尝试了下面的代码：

```
def talk
  p "hi"
end
#=> nil

Object.public_instance_method(:talk)
#=> #<UnboundMethod: Object#talk>

class Foo
  talk
end
# prints: hi
#=> "hi" 
```

这里的输出让我对我的第一个测试代码输出感到困惑。

谁能帮我理解以上这些背后的事实？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:17:31.317

您定义的方法`talk`属于`Object`所有对象的根。因此`talk`方法适用于 ruby​​ 中的所有对象。

```
def talk
  p "hi"
end

Object.respond_to? :talk  #=> true 
```

现在，您定义了类`Foo`，它也是一个 ruby​​ 对象。

```
Foo.is_a? Object  #=> true
Foo.respond_to? :talk  #=> ture 
```

所以`talk`可以`Foo`上课。

现在你`Animal`用方法定义一个类`bark`

```
class Animal
  def bark
    p "hukkhh"
  end
end 
```

`bark`您定义的方法现在属于`Animal`类，因为`instance level`方法不是类级别。这意味着您需要创建类的实例`Animal`来调用`bark`.

```
 Animal.respond_to? :bark  #=> false
 Object.respond_to? :bark  #=> false

 Animal.new.respond_to? :bark  #=> true
 Animal.respond_to? :talk   #=> true   #talk is available to Animal also because Animal is also object of Class
 Animal.new.respond_to? :talk  #=> true 
```

现在您创建了一个名为`Cow`继承自的类`Animal`。所以`bark`是可用的，`Cow`除非它是`overridden`。

```
 class Cow < Animal
 end

 Cow.respond_to? :bark  #=> false
 Cow.new.respond_to? :bark  #=> true
 Cow.respond_to? :talk  #=> true
 Cow.new.respond_to? :talk  #=> true

 Cow.new.bark #=> "hukkhh" 
```

所以要调用`bark`你需要创建类的实例。

如果您想调用在子使用中被覆盖的父方法`super`

```
class Cow < Animal
  def bark
    super
    #do your stuff
  end
end

Cow.new.bark  #=> "hukkhh" 
```

# php - 占位符更改数据

> ID：15177170
> 
> 赞同：0
> 
> 时间：2013-03-02T17:13:14.450
> 
> 标签：php, contentplaceholder

我有一个表格可以获取用户的电话并将其存储在数据库中。然后我从数据库中获取数据并将其放在这样的占位符上。

```
Telephone<input name="telephone" type="text" size="25" placeholder="<?php echo $user_data_profile['telephone']; ?>"/> 
```

一切安好。我想让占位符的数据显示为可编辑的文本，以便用户可以轻松更改他的电话号码。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:20:43.880

我会建议：

```
Telephone
<input name="telephone" type="text" size="25"
       placeholder="xxx-xxx-xxxx" value="<?=$user_data_profile['telephone']?>"/> 
```

使用与您所在地区相关的任何电话号码格式。

# c++ - 模板参数：指向成员的指针 - 我应该如何处理它？

> ID：15177174
> 
> 赞同：1
> 
> 时间：2013-03-02T17:13:37.650
> 
> 标签：c++, templates

C++ 草案说

> 非类型模板参数应具有以下类型之一（可选 cv 限定）： — 整数或枚举类型， — 指向对象的指针或指向函数的指针， — 对对象的左值引用或对函数的左值引用， —**指向成员**，——std::nullptr_t。

在下面的代码中，我有一个指向成员的指针作为参数传递给模板

```
using namespace std;

class MyClass
{
public:

    int membervar;
};

template< int (MyClass::*var) > struct A 
{
   // What am I supposed to do with *var? There isn't an object instance to use it!
};

int main(int argc, char *argv[])
{

   struct A <&MyClass::membervar> object;

} 
```

上面的代码编译（MSVC2012）没有错误

问题是：我看不出我应该用这样的指针做什么，没有对象实例可以使用它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:26:58.920

您将其用作常规**[的指向成员](http://msdn.microsoft.com/en-us/library/k8336763.aspx)**的指针：

```
template< int (MyClass::*var) > struct A 
{
   void foo()
   {
      MyClass Blah;
      Blah.*var = 3;
   }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:27:17.823

我能想到回答这个问题的唯一方法是构建一个例子：

```
template< int (MyClass::*var) > struct A 
{
    A() {
        MyClass myclass;
        myclass.*var = 42;
        cout << myclass.*var << "\n";
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T19:54:57.367

没有什么能阻止`A`将方法`MyClass`作为参数：

```
template <int (MyClass::*var)>
struct A {
    int get(MyClass const& mc) const { return mc.*var; }
    void set(MyClass& mc, int i) { mc.*var = i; }
};

int main() {
    MyClass mc;

    A<&MyClass::membervar> a;

    a.set(mc, 3);
    std::cout << a.get(mc) << "\n"; // prints 3
} 
```

# session - 登录前管理数据库和会话操作

> ID：15177177
> 
> 赞同：1
> 
> 时间：2013-03-02T17:13:54.460
> 
> 标签：session, login, sqlalchemy, cherrypy

当用户访问我们的 webset/webapp 时，我们希望用户能够浏览网站并正常做事（目前该网站几乎完全由 CRUD 操作组成）。这样，用户可以在登录之前通过 DOING 看到网站提供的内容。

我们希望将所有这些操作存储在会话中或临时存储在 SQLAlchemy 操作中，但不提交到数据库。

然后，我们希望当用户创建帐户或登录时，所有这些操作都在该帐户名下完成。

有什么好方法可以做到这一点？目前，我们所有的服务器端功能都会在数据库操作成功后自动执行 SQLAlchemy 提交。所以我不确定删除它并手动进行提交是否是一个好主意。

另一方面，将数据库操作保存在会话/cookie 中似乎也很糟糕。然后我们需要在cookies中伪造数据库，这很丑陋，而且工作量很大。

请注意，我们使用的是 postgreSQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T11:58:31.187

我认为最好的方法是为访问该站点的每个用户分配一个临时用户名，并将该信息与他们在那里所做的所有其他事情一起存储在 SESSION cookie 中。然后，当他们注册时，您可以将所有这些 SESSION var 移动到他们新用户名下的数据库中。

顺便说一句，在 SESSION cookie 中保存任何内容都没有错，只要您使用的是 HTTPS（听起来您应该将其用于您拥有的网站）。每当您通过 HTTP 进行登录时，将任何内容存储在 cookie 中*永远都不*安全。

# c++ - Visual C++：无法从另一个类调用方法

> ID：15177179
> 
> 赞同：3
> 
> 时间：2013-03-02T17:13:59.417
> 
> 标签：c++, winforms, visual-studio-2010, user-interface, c++-cli

请看下面的代码

**表格1.h**

```
#pragma once
#include "Clicker.h"

namespace TestWindowProject {

    using namespace System;
    using namespace System::ComponentModel;
    using namespace System::Collections;
    using namespace System::Windows::Forms;
    using namespace System::Data;
    using namespace System::Drawing;

    /// <summary>
    /// Summary for Form1
    /// </summary>
    public ref class Form1 : public System::Windows::Forms::Form
    {
    public:
        Form1(void)
        {
            InitializeComponent();
            //
            //TODO: Add the constructor code here
            //
        }

    protected:
        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        ~Form1()
        {
            if (components)
            {
                delete components;
            }
        }
    private: System::Windows::Forms::Button^  button1;
    protected: 

    private:
        /// <summary>
        /// Required designer variable.
        /// </summary>
        System::ComponentModel::Container ^components;

#pragma region Windows Form Designer generated code
        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        void InitializeComponent(void)
        {
            this->button1 = (gcnew System::Windows::Forms::Button());
            this->SuspendLayout();
            // 
            // button1
            // 
            this->button1->Location = System::Drawing::Point(115, 91);
            this->button1->Name = L"button1";
            this->button1->Size = System::Drawing::Size(75, 23);
            this->button1->TabIndex = 0;
            this->button1->Text = L"button1";
            this->button1->UseVisualStyleBackColor = true;
            this->button1->Click += gcnew System::EventHandler(this, &Form1::button1_Click);
            // 
            // Form1
            // 
            this->AutoScaleDimensions = System::Drawing::SizeF(6, 13);
            this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
            this->ClientSize = System::Drawing::Size(284, 262);
            this->Controls->Add(this->button1);
            this->Name = L"Form1";
            this->Text = L"Form1";
            this->ResumeLayout(false);

        }
#pragma endregion
    private: System::Void button1_Click(System::Object^  sender, System::EventArgs^  e) {

                 Clicker c;
                 c.click();
             }
    };
} 
```

**Clicker.h**

```
#pragma once
ref class Clicker
{
public:
    Clicker(void);
    void click();
}; 
```

Clicker.cpp

```
#include "StdAfx.h"
#include "Clicker.h"
#include <iostream>

using namespace std;

Clicker::Clicker(void)
{
}

void Clicker::click()
{
    cout << "Clicked" << endl;
} 
```

这是我在 C++ 中的第一个 GUI 应用程序。当我单击按钮时，什么都没有发生！我在输出中看不到任何东西！这是为什么？难道我做错了什么？请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:20:50.460

您的程序似乎是一个 WinForms C++/CLI GUI 应用程序。所以，如果你想显示一些输出，而不是使用`cout`（这对 C++ 控制台应用程序很好，而不是基于 GUI 的 WinForms 应用程序），你可以使用类似的东西[`MessageBox::Show()`](http://msdn.microsoft.com/en-us/library/519bytz3.aspx)：

```
//
// Instead of : 
//
//    cout << "Clicked" << endl;
//
MessageBox::Show( L"Clicked" ); 
```

# php - 把小物件装进一个大盒子里

> ID：15177183
> 
> 赞同：1
> 
> 时间：2013-03-02T17:14:26.997
> 
> 标签：php, algorithm

我正在寻找一种解决方案来计算包装购物车产品所需的盒子数量。每个产品都有它的高度、宽度、长度。大盒子尺寸固定

```
//big box size
$max_height = 20;
$max_width = 30;
$max_length = 40;

foreach ($products as $product) {
    $height = $product->height;
    $width = $product->width;
    $length = $product->length;
} 
```

我知道这是一个`3d`装箱问题，但有没有其他更简单的方法可以大致计算箱子的数量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:58:04.703

Ingo 在原始问题的评论中的解决方案是一个很好的解决方案，这是它的一个实现。

```
//big box size
$max_height = 20;
$max_width = 30;
$max_length = 40;
$max_volume = $max_height * $max_width * $max_length;

$tot_height = 0;
$tot_width = 0;
$tot_length = 0;

foreach ($products as $product) {
    $tot_height += $product->height;
    $tot_width += $product->width;
    $tot_length += $product->length;
}

$tot_volume = $tot_height * $tot_width * $tot_length;

$boxes_needed = ceil($tot_volume / $max_volume); 
```

如果您实际上要在现实世界中使用它，那么可能会添加一个额外的盒子，因为除非您是俄罗斯方块的大师，否则所有东西都不太可能完美地组合在一起以填充盒子的体积:)

# css - 在 4 个角的 css3 中扭曲图像

> ID：15177185
> 
> 赞同：0
> 
> 时间：2013-03-02T17:14:44.803
> 
> 标签：css, image, distortion

我看 1 项学习，有趣。我希望在 CSS3 中具有与在 Flash 中相同的效果。[http://www.rubenswieringa.com/code/as3/flex/DistortImage/](http://www.rubenswieringa.com/code/as3/flex/DistortImage/)

当我查看互联网示例时，我发现只有倾斜或旋转。我想要选项扭曲角落图像的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:57:36.653

这样做并非易事——不过至少有 3 个选项。我不会用如何做来支持他们，因为这很难，而且比这里适合的时间长得多。（加上会花费数小时而不会绊倒图书馆来做到这一点）

1.  使用`canvas`. 将图像分割成小块并将它们绘制在正确的位置。您可以使用 2D 或 3D (WebGL) 上下文，具体取决于您在做什么。

2.  使用 CSS 3D 变换。制作大量 div，将图像设置为带有偏移量的背景图像，使其看起来像一张图像。使用 3D 变换定位它们以获得所需的效果。

3.  使用自定义着色器（仅在超级新浏览器中）。[http://html.adobe.com/webstandards/csscustomfilters/cssfilterlab/](http://html.adobe.com/webstandards/csscustomfilters/cssfilterlab/)有一些类似的例子。

简而言之，根本没有简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-01T10:46:32.863

其实有***一个***比较简单的方法。

[扭曲.js](https://github.com/isuttell/distort)

# c# - 应该怎么做才能使窗口对键盘和鼠标完全透明？

> ID：15177192
> 
> 赞同：1
> 
> 时间：2013-03-02T17:15:26.317
> 
> 标签：c#, wpf, keyboard, window, transparency

我创建了一个工具提示。

我设置了所有标志（我所知道的）以赋予工具提示焦点，依此类推。组合键`Alt`+`F4`关闭第一个我的工具提示，然后在第二次按下`Alt`+后关闭主窗口`F4`。应该如何处理工具提示以使其对键盘和鼠标“不可见”？

```
tiphost=new Window();
tiphost.Owner=Window.GetWindow(this);
tiphost.AllowsTransparency=true;
tiphost.WindowStyle=WindowStyle.None;
tiphost.Width = 128;
tiphost.Height = 128;
tiphost.ShowInTaskbar=false;
tiphost.Background = new SolidColorBrush(Color.FromRgb(255, 0, 0));
tiphost.Foreground=null;
tiphost.IsEnabled=false;
tiphost.Focusable=false;
tiphost.IsHitTestVisible = false;
tiphost.ResizeMode = ResizeMode.NoResize;
tiphost.Left=300;
tiphost.Top=300;
tiphost.Show(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:54:50.523

我找到了缺少的标志**ShowActivated**！（仅适用于键盘焦点）如果即使使用标志**focusable = false**也没有设置此标志，则窗口具有焦点...

```
tiphost.ShowActivated = false; 
```

# python - 关于 cvxopt 中的不等式约束的错误（使用 GLPK）

> ID：15177194
> 
> 赞同：0
> 
> 时间：2013-03-02T17:15:34.843
> 
> 标签：python

我正在使用 cvxopt 计算以下两人零和游戏的纳什均衡。

```
[-5, 3, 1, 8]
[ 5, 5, 4, 6]
[-4, 6, 0, 5] 
```

这是我正在使用的代码（带有 doctest）。

```
from cvxopt import matrix, solvers
from cvxopt.modeling import op, dot, variable
import numpy as np

def solve_lp(a, b, c):
    """
    >>> a = matrix([[-5., 3., 1., 8., 1.],
    ...             [ 5., 5., 4., 6., 1.],
    ...             [-4., 6., 0., 5., 1.],
    ...             [-1.,-1.,-1.,-1., 0.],
    ...             [ 1., 1., 1., 1., 0.],
    ...             [-1., 0., 0., 0., 0.],
    ...             [ 0.,-1., 0., 0., 0.],
    ...             [ 0., 0.,-1., 0., 0.],
    ...             [ 0., 0., 0.,-1., 0.]])
    >>> b = matrix([0.,0.,0.,0.,1.])
    >>> c = matrix([0.,0.,0., 1.,-1.,0.,0.,0.,0.])
    >>> solve_lp(a, b, c)

    """
    variables = c.size[0]
    x = variable(variables, 'x')
    eq     =   (a*x == b)
    ineq   =   (x >= 0)
    lp = op(dot(c, x), [eq, ineq])
    lp.solve(solver='glpk')
    return (lp.objective.value(), x.value) 
```

运行它会产生以下错误：

```
Traceback (most recent call last):
...
TypeError: 'G' must be a dense or sparse 'd' matrix with 9 columns 
```

似乎 cvxopt 抛出了一个关于`ineq`约束的异常，即使我似乎遵循了建模示例中的约束语法。

**到目前为止我尝试过的**

通过乘以`x`1 的向量来更改代码：

```
def solve_lp(a, b, c):    
    variables = c.size[0]
    x = variable(variables, 'x')
    e = matrix(1.0, (1, variables))
    eq     =   (a*x == b)
    ineq   =   (e*x >= 0)
    lp = op(dot(c, x), [eq, ineq])
    lp.solve(solver='glpk')
    return (lp.objective.value(), x.value) 
```

至少它会到达 GLPK，这反过来会产生这个错误：

```
Scaling...
 A: min|aij| =  1.000e+00  max|aij| =  8.000e+00  ratio =  8.000e+00
Problem data seem to be well scaled
Constructing initial basis...
Size of triangular part = 6
*     0: obj =   0.000000000e+00  infeas =  0.000e+00 (0)
PROBLEM HAS UNBOUNDED SOLUTION
glp_simplex: unable to recover undefined or non-optimal solution 
```

**我该如何解决？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-19T10:58:55.520

我认为您应该遵循此网页中 glpk 求解器的用法： [https ://github.com/benmoran/L1-Sudoku/blob/master/sudoku.py](https://github.com/benmoran/L1-Sudoku/blob/master/sudoku.py)

**完全按照此操作，您将正确修复并使用此 glpk 求解器...**

def solve_plain_l1（A，b，求解器='glpk'）：

```
'''Find x with min l1 such that Ax=b,
using plain L1 minimization'''

n = A.size[1]

c0 = ones_v(2*n)

G1 = concathoriz(A,-A) # concatenate horizontally
G2 = concathoriz(-A,A)
G3 = -eye(2*n)
G = reduce(concatvert, [G1,G2,G3]) # concatenate vertically
hh = reduce(concatvert, [b, -b, zeros_v(2*n)])

u = cvxopt.solvers.lp(c0, G, hh, solver=solver)

v = u['x'][:n]

return v 
```

# opencv - emguCV 获得最大的 blob

> ID：15177195
> 
> 赞同：0
> 
> 时间：2013-03-02T17:15:36.520
> 
> 标签：opencv, blob, tracking, emgucv, threshold

我正在研究颜色跟踪.. 我正在专门跟踪一个橙色球，也许是一个篮球球，以及用于身体的 kinect，我正在制作一个罚球投篮指南。这是我的情况

我已经对我的图像进行了阈值处理，对其进行了侵蚀以消除噪声和其他无关紧要的物体（非球），然后放大了几次以强调球......所以我得到了最终的二进制图像 - 我已经成功隔离球..还有其他斑点..（不是球的较小斑点）..我如何获得最大的斑点（球）并放置边界框？

顺便说一句，我试过霍夫圈，但这很慢，，..谢谢！一些代码会很有用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T16:02:44.923

这是我用来获取图像中最大 blob 的代码：

```
public static Blob FindLargestObject(Image<Gray, byte> block, Rectangle rectangle)
    {
        Image<Gray, byte> mask = block.CopyBlank();

        Contour<Point> largestContour = null;
        double largestarea = 0;

        for (var contours = block.FindContours(CHAIN_APPROX_METHOD.CV_CHAIN_APPROX_SIMPLE,
            RETR_TYPE.CV_RETR_EXTERNAL); contours != null; contours = contours.HNext)
        {
            if (contours.Area > largestarea)
            {
                largestarea = contours.Area;
                largestContour = contours;
            }
        }

        // fill the largest contour
        mask.Draw(largestContour, new Gray(255), -1);

        return new Blob(mask, largestContour, rectangle);
    } 
```

对于 Blob：

```
public class Blob 
{
    Image<Gray,byte> Mask{ get; set; }
    Contour<Point> Contour { get; set; }
    Rectangle Rectangle { get; set; }
} 
```

该 blob 将包含您想要获取的所有信息。

# java - webapp在tomcat6上启动失败

> ID：15177198
> 
> 赞同：1
> 
> 时间：2013-03-02T17:15:53.337
> 
> 标签：java, mysql, tomcat, jdbc, centos

我正在尝试在 tomcat6/CentOS5 上部署 webapp

我做了配置，但是当我尝试启动 webapp 时它失败了，所以这里的人说在渴望系统中做了一些修改，这是新的日志。

的最后几行`/usr/local/tomcat/logs/catalina.out`是：

```
------------- org.apache.catalina.core.ApplicationContext log
INFO: HTMLManager: start: Starting web application at '/'
------------- org.apache.catalina.core.StandardContext listenerStart
SEVERE: Error configuring application listener of class org.ambraproject.configuration.WebAppListener
java.lang.NoClassDefFoundError: org/apache/commons/logging/LogFactory
        at org.ambraproject.configuration.WebAppListener.<clinit>(WebAppListener.java:40)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at java.lang.Class.newInstance0(Class.java:355)
        at java.lang.Class.newInstance(Class.java:308)
        at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4150)
        at org.apache.catalina.core.StandardContext.start(StandardContext.java:4705)
        at org.apache.catalina.manager.ManagerServlet.start(ManagerServlet.java:1276)
        at org.apache.catalina.manager.HTMLManagerServlet.start(HTMLManagerServlet.java:625)
        at org.apache.catalina.manager.HTMLManagerServlet.doGet(HTMLManagerServlet.java:136)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.filters.CsrfPreventionFilter.doFilter(CsrfPreventionFilter.java:194)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:563)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:861)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:606)
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
        at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.ClassNotFoundException: org.apache.commons.logging.LogFactory
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1680)
        at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1526)
            ... 30 more
------------- org.apache.catalina.core.StandardContext listenerStart
    SEVERE: Skipped installing application listeners due to previous error(s)
    Mar 2, 2013 5:46:07 PM org.apache.catalina.core.ApplicationContext log
    INFO: HTMLManager: list: Listing contexts for virtual host 'localhost' 
```

* * *

我来自 /usr/local/tomcat/webapps/ROOT/WEB-INF 的 webxml 文件是：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee">

  <display-name>Ambra</display-name>

  <context-param>
    <param-name>webAppRootKey</param-name>
    <param-value>/WEB-INF/propertyConfigurer.xml /WEB-INF/countryList.xml /WEB-INF/profaneWords.xml /WEB-INF/applicationContext.xml</param-value>
  </context-param>

  <context-param>
    <param-name>log4jConfigLocation</param-name>
    <param-value>log4j.properties</param-value>
  </context-param>

  <resource-ref>
    <description>Main Ambra Database</description>
    <res-ref-name>jdbc/AmbraDS</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
  </resource-ref>

  <resource-env-ref>
    <description>File Store for Ambra</description>
    <resource-env-ref-name>ambra/FileStore</resource-env-ref-name>
    <resource-env-ref-type>org.ambraproject.filestore.FileStoreService</resource-env-ref-type>
  </resource-env-ref>

  <filter>
    <description>Filter out any request that matches regexp</description>
    <filter-name>SinkHoleFilter</filter-name>
    <filter-class>org.ambraproject.web.GatekeeperFilter</filter-class>
    <init-param>
      <param-name>regexp</param-name>
      <param-value>.*\.ftl$</param-value>
    </init-param>
  </filter>

  <filter>
    <filter-name>UrlRewriteFilter</filter-name>
    <filter-class>org.tuckey.web.filters.urlrewrite.UrlRewriteFilter</filter-class>
  </filter>

  <filter>
    <filter-name>MultipleRequestFilter</filter-name>
    <filter-class>org.ambraproject.web.MultipleRequestFilter</filter-class>
    <init-param>
      <param-name>includePattern_fetchArticle</param-name>
      <param-value>.*\/article\/info.*</param-value>
    </init-param>
    <init-param>
      <param-name>includePattern_browseIssue</param-name>
      <param-value>.*browseIssue\.action.*</param-value>
    </init-param>
    <init-param>
      <param-name>includePattern_browseVolume</param-name>
      <param-value>.*browseVolume\.action.*</param-value>
    </init-param>
  </filter>

  <filter>
    <description>Sets the virtual journal context.
Should be 1st in the chain as other Filters, e.g. caching, may rely on the journal context.</description>
    <filter-name>VirtualJournalContextFilter</filter-name>
    <filter-class>org.ambraproject.web.VirtualJournalContextFilter</filter-class>
  </filter>

  <filter>
    <description>Should immediately follow VirtualJournalContext in Filter chain.
If a virtual journal context is set, check to see if requested resource has a virtual journal override.
If so, wrap request with virtual journal override values in FilterChain.</description>
    <filter-name>VirtualJournalMappingFilter</filter-name>
    <filter-class>org.ambraproject.web.VirtualJournalMappingFilter</filter-class>
  </filter>

  <filter>
    <filter-name>DummySSOFilter</filter-name>
    <filter-class>org.ambraproject.web.DummySSOFilter</filter-class>
    <!-- uncomment these if you want to be logged in by default when you start the server
    <init-param>
      <param-name>auth.id</param-name>
      <param-value>foo</param-value>
    </init-param>
    <init-param>
      <param-name>email</param-name>
      <param-value>foobar@b.com</param-value>
    </init-param>
    -->
    <init-param>
      <param-name>casUrl</param-name>
      <param-value>https://localhost:7443/cas/</param-value>
    </init-param>
    <init-param>
      <param-name>wrapRequest</param-name>
      <param-value>false</param-value>
    </init-param>
  </filter>

  <filter>
    <filter-name>CAS Filter</filter-name>
    <filter-class>org.ambraproject.service.cas.client.filter.CASFilterWrapper</filter-class>
    <init-param>
      <param-name>edu.yale.its.tp.cas.client.filter.loginUrl</param-name>
      <param-value>https://localhost:7443/cas/login</param-value>
    </init-param>
    <init-param>
      <param-name>edu.yale.its.tp.cas.client.filter.validateUrl</param-name>
      <param-value>https://localhost:7443/cas/proxyValidate</param-value>
    </init-param>
    <init-param>
      <param-name>edu.yale.its.tp.cas.client.filter.serverName</param-name>
      <param-value>localhost:8080</param-value>
    </init-param>
    <init-param>
      <param-name>edu.yale.its.tp.cas.client.filter.wrapRequest</param-name>
      <param-value>false</param-value>
    </init-param>
  </filter>

  <filter>
    <filter-name>gzip</filter-name>
    <filter-class>org.mortbay.servlet.GzipFilter</filter-class>
    <init-param>
      <param-name>minGzipSize</param-name>
      <param-value>100</param-value>
    </init-param>
    <init-param>
      <param-name>mimeTypes</param-name>
      <param-value>text/html,text/plain,text/css,text/javascript,application/xml,application/atom+xml</param-value>
    </init-param>
  </filter>

  <filter>
    <filter-name>journalStaticResources</filter-name>
    <filter-class>org.ambraproject.web.JournalStaticResourceFilter</filter-class>
  </filter>

  <filter>
    <filter-name>struts2</filter-name>
    <!--
    <filter-class>org.apache.struts2.dispatcher.FilterDispatcher</filter-class>
    -->
    <filter-class>org.ambraproject.struts2.AmbraStruts2Dispatcher</filter-class>
    <init-param>
      <param-name>packages</param-name>
      <param-value>struts</param-value>
    </init-param>
  </filter>

  <!--
  <filter>
    <filter-name>DebuggingFilter</filter-name>
    <filter-class>org.ambraproject.web.DebuggingFilter</filter-class>
  </filter>
  -->

  <filter-mapping>
    <filter-name>SinkHoleFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>MultipleRequestFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>UrlRewriteFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>VirtualJournalContextFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>ERROR</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>VirtualJournalMappingFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>DummySSOFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>CAS Filter</filter-name>
    <url-pattern>/annotation/secure/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>CAS Filter</filter-name>
    <url-pattern>/user/secure/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>CAS Filter</filter-name>
    <url-pattern>/rate/secure/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>CAS Filter</filter-name>
    <url-pattern>/admin/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>gzip</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>journalStaticResources</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>ERROR</dispatcher>
  </filter-mapping>

  <filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
    <dispatcher>ERROR</dispatcher>
  </filter-mapping>

  <!--
  <filter-mapping >
    <filter-name>DebuggingFilter</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
  </filter-mapping>
-->

    <listener>
    <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
    </listener>

  <!-- The configuration WebAppListener to pull in the configuration stuff automatically. -->
  <listener>
    <listener-class>org.ambraproject.configuration.WebAppListener</listener-class>
  </listener>
  <!-- to hook in the spring container -->
  <listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
  </listener>
  <!-- to hook in the scope management system that provides scopes like session, request for Servlet 2.4 and Spring 2.0 above  -->
  <listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
  </listener>

  <!-- Count the number of active sessions and make it available.   -->
  <listener>
    <listener-class>org.ambraproject.web.SessionCounter</listener-class>
  </listener>

  <welcome-file-list>
    <welcome-file>index.jsp</welcome-file>
  </welcome-file-list>

  <error-page>
    <error-code>404</error-code>
    <location>/static/pageNotFound.action</location>
  </error-page>

  <session-config>
    <session-timeout>1440</session-timeout>
  </session-config>
</web-app> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:22:03.990

在war文件中创建`WEB-INF/classes/logging.properties`，内容如下：

```
org.apache.catalina.core.ContainerBase.[Catalina].level = INFO
org.apache.catalina.core.ContainerBase.[Catalina].handlers = java.util.logging.ConsoleHandler 
```

这将帮助您找到`Error listnerStart`线路的真正问题。我以前用过这个，发现`ClassNotFound`错误和其他原因。

更多信息[在这里](http://mythinkpond.wordpress.com/2011/07/01/tomcat-6-infamous-severe-error-listenerstart-message-how-to-debug-this-error/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:31:54.327

你的类路径中有 Apache commons-logging jar 文件吗？它似乎是您缺少的公共日志记录的一部分。

# matplotlib - 如何解释 pyplot 直方图箱？

> ID：15177203
> 
> 赞同：9
> 
> 时间：2013-03-02T17:16:18.193
> 
> 标签：matplotlib, histogram

我对 matplotlib hist 函数感到困惑。

该文档解释说：

> 如果是一系列值，则要使用的 bin 的下限的值。

但是当我有两个序列值，即 [0,1] 时，我只得到 1 个 bin。当我有三个这样的时候：

```
plt.hist(votes, bins=[0,1,2], normed=True) 
```

我只得到两个垃圾箱。我的猜测是最后一个值只是最后一个 bin 的上限。

**有没有办法在最后一个 bin 中拥有“其余”的值，而不是在那里有一个非常大的值？（或者换句话说，没有使那个垃圾箱比其他垃圾箱大得多）**

似乎最后一个 bin 值包含在最后一个 bin 中

```
votes = [0,0,1,2]
plt.hist(votes, bins=[0,1]) 
```

这给了我一个高度为 3 的箱子。即 0,0,1。尽管：

```
votes = [0,0,1,2]
plt.hist(votes, bins=[0,1,2]) 
```

给我两个箱子，每个箱子里有两个。我发现这个反直觉，添加一个新的 bin 会改变其他 bin 的宽度限制。

```
votes = [0,0,1]
plit.hist[votes, bins=2) 
```

产生两个大小为 2 和 1 的箱。由于 x 轴从 0 变为 1，因此这些箱似乎已在 0,5 上拆分。

**bins 数组应该如何解释？数据如何拆分？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-02T18:06:23.617

```
votes = [0, 0, 1, 2]
plt.hist(votes, bins=[0,1]) 
```

这为您提供了一个高度为 3 的 bin，因为它将数据拆分为一个间隔为：[0, 1] 的 bin。它将以下值放入该 bin 中：0、0 和 1。

```
votes = [0, 0, 1, 2]
plt.hist(votes, bins=[0, 1, 2]) 
```

这会给你一个带有间隔的柱状图的直方图：[0, 1[ 和 [1, 2]; 所以你在第一个箱子（0 和 0）中有 2 个项目，在第二个箱子（1 和 2）中有 2 个项目。

如果您尝试绘制：

```
plt.hist(votes, bins=[0, 1, 2, 3]) 
```

将数据拆分为 bin 背后的想法是相同的：您将获得三个区间：[0, 1[; [1, 2[; [2, 3]，你会注意到值 2 改变了它的 bin，进入间隔为 [2, 3] 的 bin（而不是像前面的例子那样停留在 bin [1, 2] 中）。

总之，如果您在 bins 参数中有一个有序数组，例如： [i_0, i_1, i_2, i_3, i_4, ..., i_n] 将创建 bin：
[i_0, i_1[
[i_1, i_2[
[i_2 ,
i_3[ [i_3, i_4[
...
[i_(n-1), i_n]

根据括号打开或关闭每个边界。

# javascript - 无法制作一个像 div 这样顶部有三角形的 facebook

> ID：15177204
> 
> 赞同：1
> 
> 时间：2013-03-02T17:16:28.073
> 
> 标签：javascript, html, css, facebook, styles

在 facebook 上，如果您将鼠标悬停在有很多喜欢的内容上，则会弹出一个 div，显示所有喜欢该帖子的人。我想知道是否有人可以模仿css中的div并解释我是如何做到的。下面有一张图片显示了我的意思。我知道你必须在 css 中使用 :after 但我不知道如何定位三角形等等。

![黑色 Div 与 Trinagle](../Images/68a0a84d9470313c62f36b08d92d4509.png)

这是我在其他地方找到的一些代码：

```
#pointed {
position: relative;
margin: 0 auto;
width: 200px;
height: 200px;
background-color: white;
}

#pointed:after,
#pointed::after {
position: absolute;
top: 100%;
left: 50%;
margin-left: -50%;
content: '';
width: 0;
height: 0;
border-top: solid 150px red;
border-left: solid 100px transparent;
border-right: solid 100px transparent;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:25:46.400

你粘贴在那里的代码有它的要点。你可以[在这里看到一个工作的 JSFiddle](http://jsfiddle.net/kNvTT/)，它使它更像你想要的。

我认为这个问题有两个部分。第一部分是**制作三角形**。第二部分是**定位三角形**。

# 制作三角形

伪元素上的边框负责我们看到的那个三角形。如果您不确定这是如何发生的，请看一下[这个很好的答案](https://stackoverflow.com/questions/7073484/how-does-this-css-triangle-shape-work)，我认为它可以很好地解释它。

# 定位三角形

定位的关键在于让孩子出现在父母之外。我们可以通过`absolute`在孩子上设置定位来做到这一点。但是，如果我们在完全不改变父级的情况下这样做，则`absolute`定位将相对于窗口进行设置。

我们在这里想要的是相对于父级定位子级。我们可以通过将父元素的位置设置为除`static`默认值之外的任何值来做到这一点。在您粘贴的代码中，您可以看到他们将其设置为`relative`. 关于定位的更多信息，我认为[工作文档](http://www.w3.org/TR/css3-positioning/)非常具有解释性。另一个很棒的资源可以在[CSS Tricks](http://css-tricks.com/absolute-relative-fixed-positioining-how-do-they-differ/)上找到。

无论如何，我们希望我们的孩子在父母*之外*。因此，如果我们有一个 5px 高的三角形，用于定位的子元素 CSS 应该如下所示：

```
position: absolute;
top: -5px; 
```

正如您在上面的 JSFiddle 中看到的那样，这将使它看起来像是附加在顶部。

在按照您想要的方式垂直放置它之后，设置它的`left`位置以使其沿着水平方向到达您想要的位置。

当然，您必须问自己是否值得重新发明轮子[——Bootstrap Jquery](http://twitter.github.com/bootstrap/javascript.html#tooltips)附带工具提示。

# visual-studio - 是否可以在 Visual Studio 中为 TypeScript 方法/类生成注释？

> ID：15177206
> 
> 赞同：2
> 
> 时间：2013-03-02T17:16:48.337
> 
> 标签：visual-studio, typescript

有没有办法在 Visual Studio 中生成 JSDoc 注释，如 C# 中的 XML 注释？通过输入///？有一个 JavaScript 插件。TypeScript 有什么类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:32:26.720

不，TypeScript 还没有任何东西。

您可以从 TypeScript Visual Studio 扩展、Web Essentials 或编写 Visual Studio 扩展并将其粘贴到库中，将其作为功能请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-13T13:56:44.383

我已经更新了我的扩展，以支持 Visual Studio 2012+ 的 JavaScript 和 TypeScript 中的 JSDoc 和 VSDoc。

[https://visualstudiogallery.msdn.microsoft.com/0cb7304b-ad78-4283-ba2b-42804657fcdd?SRC=VSIDE](https://visualstudiogallery.msdn.microsoft.com/0cb7304b-ad78-4283-ba2b-42804657fcdd?SRC=VSIDE)

> DocStubsJs [以前称为 JavaScript vsdoc Generator]
> 
> 此扩展的目标是提供一种简单的方法来向 JavaScript 和 TypeScript 添加文档，方法是在打开新文档注释后添加注释存根。

为了让它看起来不像是一个无耻的插件，Atomineer 也支持这个，虽然它是一个付费扩展（虽然它不仅仅是一个简单的存根）

[https://visualstudiogallery.msdn.microsoft.com/7912CCF4-60B8-4132-BACE-5ACACEB7233B](https://visualstudiogallery.msdn.microsoft.com/7912CCF4-60B8-4132-BACE-5ACACEB7233B)

# mysql - 如何在 Django View 中访问 MySQL 表中的所有条目？

> ID：15177212
> 
> 赞同：0
> 
> 时间：2013-03-02T17:17:33.087
> 
> 标签：mysql, django

我正在使用 Django 框架设计一个 Web 应用程序。我已经编写了`model`代码，`urls.py`并且`view`可以在[这里](https://stackoverflow.com/questions/15172903/how-to-configure-html-form-to-work-with-django-models)看到代码。

我在数据库中添加了一些数据`table`。但是当我尝试使用下面的代码访问该对象时，它只显示了`bookInfo objects`五次。我认为我在从数据库中提取数据方面不够成功。请帮忙。

**看法**

```
def showbooks(request):
    booklist = bookInfo.objects.order_by('Name')[:10]
    output = ','.join([str(id) for id in booklist])
    return HttpResponse(output) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:21:35.307

我认为你成功地提取了数据。它只是`booklist`包含对象，而不是数字 ID。`__unicode__`您可以向您的类添加方法，`BookInfo`该方法应该返回对象的字符串表示形式（在这种情况下可能是书名）。应用时将调用此方法`str()`。`__unicode__` [您可以在此处](https://docs.djangoproject.com/en/dev/intro/tutorial01/)找到更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:25:56.913

您正在遍历对象列表，您只需要引用所需的列/属性：

```
output = ','.join([obj.id for obj in booklist]) 
```

或者，您可以更精细地制作原始数据库调用，然后您使用的可迭代将起作用。在这种情况下，我们将提取 'id' 属性的列表。

```
booklist = bookInfo.objects.order_by('Name').values_list('id', flat=True)[:10]
output = ','.join([id for id in booklist]) 
```

# matlab - 如何将m文件转换为c文件

> ID：15177214
> 
> 赞同：1
> 
> 时间：2013-03-02T17:17:44.537
> 
> 标签：matlab

我有 .m 文件，我真的需要将它转换为 c 语言。有没有可用的编译器这样做？我真的很感谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:30:23.823

我知道的唯一方法是使用[Matlab Coder](http://www.mathworks.com/products/matlab-coder/)，这是相当昂贵的。

如果您不想花这笔钱，我担心您最好的选择是用 C 重新编码 m 文件。它真的必须是 C 还是 C++ 就足够了。使用[eigen](http://eigen.tuxfamily.org/)库，Matlab 代码可以巧妙地转换为 C++，没有太多麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:27:24.607

There is the [Simulink Coder](http://www.mathworks.co.uk/products/simulink-coder/index.html), from Mathworks, but you must purchase it. You can get a trial version for free, though.

See [this similar SO question](https://stackoverflow.com/questions/7731671/converting-matlab-to-c) for more details.

# ssh - 必须与任意服务器通信的程序需要多少 SSH v1 支持？

> ID：15177216
> 
> 赞同：0
> 
> 时间：2013-03-02T17:17:53.827
> 
> 标签：ssh, libssh2, libssh

我正在开始一个新项目，这是一个跨平台的 C++ 程序，需要使用程序中内置的 SSH 代码连接到用户选择的服务器。我试图在[`libssh`](http://www.libssh.org/)和之间做出决定[`libssh2`](http://www.libssh2.org/)。（许可不是问题；`libssh`的 LGPL 很好。）

`libssh2`[从这个页面](http://www.libssh2.org/libssh2-vs-libssh.html)来看，似乎是要走的路——除了一个可能的例外。它不支持 SSH v1。我不知道现在有多少服务器可能只支持 SSH v1。有没有人在这方面有经验，或者可以指出我可以回答的问题？

或者，任何人都可以指出另一个支持 SSH v1 和 v2 的具有 SCP 功能的 SSH 库吗？最好是线程安全的并且还可以支持非阻塞操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:51:59.083

仍然存在一些仅提供 SSH1 的硬件设备，但在软件方面，锁定到 SSH1 是危险的，因为 SSH1 存在安全漏洞。因此，如果您不打算连接到硬件，完全省略 SSH1 是个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:30:44.180

早在 2004 年我熟悉 Linux 的时候，SSHv1 就已经过时了。所以我认为现在很多服务器不会支持 SSHv1。

如果服务器仅支持 v1，则将其视为处于非常糟糕的状态，IMO。

# java - 比较两个文件或为什么 Java 中的这段代码比 C++ 快？

> ID：15177218
> 
> 赞同：1
> 
> 时间：2013-03-02T17:17:59.980
> 
> 标签：java, c++, file, ifstream

为什么 Java 中的这段代码比 C++ 快？我需要逐字节比较 2 个文件。例如，比较两个大小为 650mb 的文件时，C++ 需要 40 秒，Java 需要 10 秒。

C++ 代码：

```
//bufferSize = 8mb
std::ifstream lFile(lFilePath.c_str(), std::ios::in | std::ios::binary);
std::ifstream rFile(rFilePath.c_str(), std::ios::in | std::ios::binary);

std::streamsize lReadBytesCount = 0;
std::streamsize rReadBytesCount = 0;

do {
    lFile.read(p_lBuffer, *bufferSize);
    rFile.read(p_rBuffer, *bufferSize);
    lReadBytesCount = lFile.gcount();
    rReadBytesCount = rFile.gcount();

    if (lReadBytesCount != rReadBytesCount ||
        std::memcmp(p_lBuffer, p_rBuffer, lReadBytesCount) != 0)
    {
        return false;
    }
} while (lFile.good() || rFile.good());

return true; 
```

和Java代码：

```
InputStream is1 = new BufferedInputStream(new FileInputStream(f1)); 
InputStream is2 = new BufferedInputStream(new FileInputStream(f2)); 

byte[] buffer1 = new byte[64];
byte[] buffer2 = new byte[64];

int readBytesCount1 = 0, readBytesCount2 = 0;

while (
    (readBytesCount1 = is1.read(buffer1)) != -1 &&
    (readBytesCount2 = is2.read(buffer2)) != -1
) {             
    if (Arrays.equals(buffer1, buffer2) && readBytesCount1 == readBytesCount2)
        countItr++;
    else {
        result = false
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-02T17:23:38.550

一个可能的答案是 C++ 代码使用 8 Mb 的缓冲区，而 Java 版本使用 64 字节。如果差异在前几个字节内会发生什么？那么Java版本只需要读取64个字节，就可以找到差异，而C++版本需要读取800万字节。如果您想比较它们，您应该使用相同的缓冲区大小。

此外，如果文件相同，则可能有其他原因造成差异。考虑分配 8 mb 数据所需的时间（这甚至可以跨越多个页面），与仅分配 64 字节所需的时间。由于您是按顺序阅读的，因此开销确实在内存方面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:45:40.273

我刚刚拿了你的 Java 程序并编写了一个等效的 C++ 程序，并且两者几乎相同来比较两个相同的文件，给或花一秒钟。

一种可能的、简单的解释是，您首先运行 C++ 程序，然后运行 ​​Java 程序。如果这是您唯一的测试，那么执行时间的差异可以通过缓存来解释，尽管在今天的硬件上读取 650 MB 需要 40 秒的时间。

数据块在系统文件缓存中，第二次没有磁盘访问来检索文件。为了获得可比较的结果，请使用 C++ 和 Java 程序多次运行测试。

在您的代码中，您有

```
lFile.read(p_lBuffer, *bufferSize); 
```

这与您一开始的评论相矛盾

```
//bufferSize = 8mb 
```

所以除非你展示真正*完整*的代码，否则任何人的猜测都是有效的。

吃我自己的狗粮

```
#include <iostream>
#include <fstream>
#include <cstring>

const size_t N = 8 * 1024 * 1024;
char buf1[N], buf2[N];

int main(int argc, char **argv)
{
    std::iostream::sync_with_stdio(false);
    std::ifstream f1(argv[1]);
    std::ifstream f2(argv[2]);
    while (f1.read(buf1, sizeof(buf1)) && f2.read(buf2, sizeof(buf2))) {
        size_t n1 = f1.gcount(), n2 = f2.gcount();
        if (n1 != n2 || memcmp(buf1, buf2, n1) != 0)
            return 1;
    }

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T17:30:19.850

虽然缓冲区大小的答案非常好，而且可能非常重要，但问题的另一个可能来源是使用`iostream`库。我通常不会将该库用于此类工作。例如，这可能导致的一个问题是额外的复制，因为`iostream`它为您提供了缓冲。我会使用原始`read`和`write`调用。

例如，在 Linux C++11 平台上，我会这样做：

```
#include <array>
#include <algorithm>
#include <string>
#include <stdexcept>

// Needed for open and close on a Linux platform
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>

using ::std::string;

bool same_contents(const string &fname1, const string &fname2)
{
   int fd1 = ::open(fname1.c_str(), O_RDONLY);
   if (fd1 < 0) {
      throw ::std::runtime_error("Open of " + fname1 + " failed.");
   }
   int fd2 = ::open(fname2.c_str(), O_RDONLY);
   if (fd2 < 0) {
      ::close(fd1);
      fd1 = -1;
      throw ::std::runtime_error("Open of " + fname2 + " failed.");
   }

   bool same = true;
   try {
      ::std::array<char, 4096> buf1;
      ::std::array<char, 4096> buf2;
      bool done = false;

      while (!done) {
         int read1 = ::read(fd1, buf1.data(), buf1.size());
         if (read1 < 0) {
            throw ::std::runtime_error("Error reading " + fname1);
         }
         int read2 = ::read(fd2, buf2.data(), buf2.size());
         if (read2 < 0) {
            throw ::std::runtime_error("Error reading " + fname2);
         }
         if (read1 != read2) {
            same = false;
            done = true;
         }
         if (same && read1 > 0) {
            const auto compare_result = ::std::mismatch(buf1.begin(),
                                                        buf1.begin() + read1,
                                                        buf2.begin());
            if (compare_result.first != (buf1.begin() + read1)) {
               same = false;
            }
         }
         if (!same || (buf1.size() > read1)) {
            done = true;
         }
      }
   } catch (...) {
      if (fd1 >= 0) ::close(fd1);
      if (fd2 >= 0) ::close(fd2);
      throw;
   }
   if (fd1 >= 0) ::close(fd1);
   if (fd2 >= 0) ::close(fd2);
   return same;
} 
```

# python - 组 Gtk.RadioToolButtons？

> ID：15177222
> 
> 赞同：1
> 
> 时间：2013-03-02T17:18:44.417
> 
> 标签：python, python-3.x, gtk, gtk3, pygobject

几天来，我一直在尝试找到一种`RadioToolButtons`在 pygobject 中分组的方法，但没有成功。没有`*.RadioToolButton.join_group(*)`像`RadioButton`s 这样的方法。

**这是我一直在尝试的：**

```
## Toolbar
self.mainWindow.mainBox.mainToolbar = Gtk.Toolbar()
self.mainWindow.mainBox.mainToolbar.get_style_context().add_class(Gtk.STYLE_CLASS_PRIMARY_TOOLBAR)
self.mainWindow.mainBox.mainToolbar.set_style(Gtk.ToolbarStyle.BOTH)
self.mainWindow.mainBox.mainToolbar.radioGroup = list() # *.radioGroup = [] Does not work either.

## Left toolbar separator
self.mainWindow.mainBox.mainToolbar.leftSeparator = Gtk.SeparatorToolItem(draw = False)
self.mainWindow.mainBox.mainToolbar.leftSeparator.set_expand(True)

## Overview toggle button
self.mainWindow.mainBox.mainToolbar.overviewRadio = Gtk.RadioToolButton(Gtk.STOCK_HOME)
self.mainWindow.mainBox.mainToolbar.overviewRadio.set_group(self.mainWindow.mainBox.mainToolbar.radioGroup)
self.mainWindow.mainBox.mainToolbar.overviewRadio.set_is_important(True)
self.mainWindow.mainBox.mainToolbar.overviewRadio.set_label("Overview")
self.mainWindow.mainBox.mainToolbar.overviewRadio.connect("clicked", self.on_overviewRadio_clicked)
self.mainWindow.mainBox.mainToolbar.overviewRadio.set_border_width(4)

## Basic settings toggle button
self.mainWindow.mainBox.mainToolbar.basicRadio = RadioToolButton(Gtk.STOCK_PROPERTIES)
self.mainWindow.mainBox.mainToolbar.basicRadio.set_group(self.mainWindow.mainBox.mainToolbar.radioGroup)
self.mainWindow.mainBox.mainToolbar.basicRadio.set_is_important(True)
self.mainWindow.mainBox.mainToolbar.basicRadio.set_label("Basic")
self.mainWindow.mainBox.mainToolbar.basicRadio.connect("clicked", self.on_basicRadio_clicked)
self.mainWindow.mainBox.mainToolbar.basicRadio.set_border_width(4)

## Right toolbar separator
self.mainWindow.mainBox.mainToolbar.rightSeparator = Gtk.SeparatorToolItem(
    draw = False)
self.mainWindow.mainBox.mainToolbar.rightSeparator.set_expand(True) 
```

（不是我的所有代码 -`*.show_all()`不是问题）

**这是我得到的：**

![我得到了什么](../Images/2a93e0ea4805117922853f4770893d4a.png)

我究竟做错了什么？如何将这两个按钮分组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:09:01.550

创建第二个单选按钮，使其位于第一个单选按钮的组中，使用：

```
Gtk.RadioToolButton.new_with_stock_from_widget(first_button, Gtk.STOCK_PROPERTIES) 
```

PS。看起来您尝试完成的 UI 任务最好使用`Notebook`?

# java - java 使用未经检查或不安全的操作重新编译时出现 xlint 错误？

> ID：15177227
> 
> 赞同：1
> 
> 时间：2013-03-02T17:19:14.053
> 
> 标签：java

当我尝试编译这个二进制搜索程序时，我收到一条消息说我有未经检查和不安全的操作。我查看了 stackoverflow 上的其他帖子，但我不知道如何修复我的代码。谢谢！

```
public binarySearch()
{
    ArrayList<Integer> list = new ArrayList<Integer>();
    for (int i=0;i<10;i++)
    {
        int rand = (int)(Math.random()*10);
        list.add(rand);
        System.out.print(list.get(i)+"\t");
        if ((i+1)%10==0) System.out.println();
    }   
    System.out.println("\n"+search(sort(list),0));
}

public ArrayList sort(ArrayList<Integer> listNum)
{
    for (int i=0;i<listNum.size()-1;i++)
    {
        int min=10000;
        int index=0;
        for (int j=i;j<listNum.size();j++)
            if (listNum.get(j)<min) 
            {
                min=listNum.get(j);
                index=j;
            }
        int temp = listNum.get(i);
        listNum.set(i,listNum.get(index));
        listNum.set(index,temp);
    }
    return listNum;
}   

public boolean search(ArrayList<Integer> listNum, int num)
{
    //need to sort list
    int low = 0;
    int high = listNum.size()-1;
    while (low<=high)
    {
        int mid = (low+high)/2;
        int midValue = listNum.get(mid);
        if (num<midValue)
            high = mid-1;
        if (num>midValue)
            low = mid+1;
        if (num==midValue)
            return true;
    }
    return false;
}

public static void main (String args[])
{
    binarySearch app = new binarySearch();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:25:32.827

方法返回应该是 `public ArrayList<Integer> sort(ArrayList<Integer> listNum)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:26:02.627

您的 sort 方法返回**Raw 类型**，因此是编译器警告。使您的排序方法返回参数化类型的 ArrayList。

```
public ArrayList<Integer> sort(ArrayList<Integer> listNum) 
```

**有用的帖子：**

*   [**什么是 Raw 类型，为什么不应该使用它？**](https://stackoverflow.com/questions/2770321/what-is-a-raw-type-and-why-shouldnt-we-use-it)

# php - 谁能在这个 php/mysql UPDATE 代码中发现一个错误 - mysql_affected_rows() 返回是错误的

> ID：15177228
> 
> 赞同：0
> 
> 时间：2013-03-02T17:19:34.360
> 
> 标签：php, mysql

我有这个 PHP 代码：

第一次查找 query-1 工作正常。但第二个 query2 工作正常，但 mysql_affected_rows() 没有告诉我记录是否已更新，为什么？

谢谢。

* * *

```
$uemail  = 'driggg2@gmail.com';
$authkey = '2f4071bffda44aa30064364055687d13';

require_once ('./domainsiteconnect.php'); // Connect to the database.

if ( $uemail && $authkey)
{

echo "<br>--uemail: [$uemail] -- && -- [$authkey] --- ";

$query1 = "SELECT * FROM member WHERE email='$uemail' AND actkey='$authkey' AND status='pending' ";

    $result1 = mysql_query ($query1);
    $num1 = mysql_num_rows ($result1);

    if ( $num1 == 1 )  // Exactly 1 rec found - Update member to verified.
    {
       echo '<br>+++ query1: successful +++>br>';

        $status = 'verified';

$query2 = " UPDATE member SET status='$status' WHERE email='$uemail'   ";    //AND actkey='$authkey'  ";
    //- $query2 = " UPDATE member SET status='$status' WHERE email='$uemail' AND actkey='$authkey'  ";

    $result2 = mysql_query($query2);
    $num2 = mysql_affected_rows($result2);

        if ( $num2  )  //  updated? - inform user
        {

            echo "<br>--$uemail updated to verified --";
        }
        else
            echo "<br>--$uemail  verfication [update] failed --";

            $val1=mysql_errno();
        $val2=mysql_error();

        //-- 
echo '<br>['.$query2.']--<br>--['.$result2.']<br>val-1:'.$val1.'<br> val-2'.$val2;

            }

    }   //-- eof. if auth/email flags ok --- 
```

=========================

结果输出是：

```
 --uemail: [driggg2@gmail.com] -- && -- [2f4071bffda44aa30064364055687d13] ---

 +++ query1: successful +++>br>

 Warning: mysql_affected_rows() expects parameter 1 to be resource, boolean given in /home/arif/public_html/amy/public/domainsite/verifyfirst.php on line 125

 --driggg2@gmail.com verfication [update] failed --
[ UPDATE member SET status='verified' WHERE email='driggg2@gmail.com'; ]--
--[1]
val-1:0
val-2 
```

* * *

我认为，警告是因为 query2 没有返回 mysql_affected_rows() 所需的资源 ID。

*   db 和 table 都在 utf8 中。我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:28:28.957

Basically what is states is that [mysql_affected_rows()](http://php.net/manual/en/function.mysql-affected-rows.php) does not take any parameters. Within the context of the update is will output the affected rows. Thus, you need not pass the $result2.

Instead of

> $num2 = mysql_affected_rows($result2);

use

> $num2 = mysql_affected_rows();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:27:54.903

Indeed, put the result of mysql_connect in mysql_affected_rows to eliminate the error message and get the actual affected number of rows.

# node.js - 向未响应的服务器发出 http.request 时出现 node.js 错误

> ID：15177238
> 
> 赞同：2
> 
> 时间：2013-03-02T17:20:37.717
> 
> 标签：node.js, asynchronous, express

我正在编写一个 node.js 服务器，它充当客户端和 java 服务器之间的 API，它是 node.js API 的下游一步。API 接受来自客户端的传入 HTML 请求，重新格式化它们，然后将它们发送到 java 服务器，后者将其答案返回给 node.js API，后者将其返回给客户端。这一切都很好，除了服务器关闭时。我需要捕捉该事件，就像我可以捕捉 502 或 302 一样......这是我的代码：

```
async.waterfall(
    [           
        function(callback){
            var options = { host: 'localhost', port: '8080',
            path: '/javaServerWork/' + req.query.foo + '?toDo=' + req.query.bar,
            method: 'GET',
            headers: { accept: 'application/json' }
            };

            http.request(options, function(response){
                response.on('error', function(exception) { Console.log("error here"); }
                if(response.statusCode == '200'){ callback(null, response); }
                else if (response.statusCode == '502') { res.send('502'); }
                else { res.send('not 200 and not 502'); }
            }).end();
        },

        function(response){
            var javaResponse = '';
            response.on('error', function(exception){ Console.log("error here");});
            response.on('data', function (chunk){ javaResponse += chunk; });
            response.on('end', function(){                  
                res.send(javaResponse);
            })
        }
    ]
); 
```

当我启动此节点服务器并向 node.js 服务器发出请求，然后尝试访问 java 服务器时，node.js 崩溃并且我在控制台中收到以下错误：

> events.js:69 抛出参数[1]；// 未处理的“错误”事件 ^ 错误：在 Object.afterConnect [as oncomplete] (net.js:837:19) 的 errnoException (net.js:846:11) 处连接 ECONNREFUSED

我需要做的就是在 java 服务器关闭时捕获“无响应”，这样我就可以执行另一个函数或简单地将这个事实返回给客户端，当然，不会导致节点崩溃！这可能很简单，但我没有发现任何可行的方法。我已经尝试过 process.on('uncaughtException')，我已经尝试过（如代码中所示）response.on('error')。

我是节点新手，看不到问题出在哪里......非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T19:13:41.227

你试过了吗

```
http.request(options, function(response){
            response.on('error', function(exception) { Console.log("error here"); }
            if(response.statusCode == '200'){ callback(null, response); }
            else if (response.statusCode == '502') { res.send('502'); }
            else { res.send('not 200 and not 502'); }
}).on('error', function(e) {
    console.log("handle error here");
}).end(); 
```

听起来错误是在 http.request 返回的请求对象上引发的，而不是在响应对象上

([http://nodejs.org/api/http.html#http_http_request_options_callback](http://nodejs.org/api/http.html#http_http_request_options_callback))

# windows - 如何检索 IShellItem 的创建日期？

> ID：15177239
> 
> 赞同：2
> 
> 时间：2013-03-02T17:20:41.943
> 
> 标签：windows, winapi, windows-shell

我有一个文件夹的pidl（可能存在或已被删除）。

我可以`IShellItem`使用以下代码获得一个，但我需要的是获得该文件夹的**创建日期**。我想我可以得到它`PKEY_DateCreated`，但我不知道如何。

```
SHCreateShellItem(nil, nil, pidl, ShellItem); 
```

我该怎么做呢 ？

我用德尔福。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:31:49.560

纯 Winapi 示例：

```
IShellItem2* pItem2 = NULL;
hr = pItem->QueryInterface(&pItem2);
if (SUCCEEDED(hr))
{
   FILETIME ft = {0};
   pItem2->GetFileTime(PKEY_DateCreated, &ft);
   SYSTEMTIME st = {0};
   ::FileTimeToSystemTime(&ft, &st);
   wprintf(
       L"Date Created: %04d-%02d-%02d %02d:%02d:%02d\n", 
       st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);
   pItem2->Release();
} 
```

正如 David Heffernan 指出的那样，您确定**所有**外壳项目都有创建日期吗？

翻译成德尔福，看起来像这样：

```
var
  Item: IShellItem;
  Item2: IShellItem2;
  ft: TFileTime;
  st: TSystemTime;
....
Item2 := Item as IShellItem2;
OleCheck(Item2.GetFileTime(PKEY_DateCreated, ft));
Win32Check(FileTimeToSystemTime(ft, st)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T10:58:43.213

如果你有 PIDL，你可以使用**[SHGetDataFromIDList](https://docs.microsoft.com/en-us/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetdatafromidlistw)**来获取对象的基本属性；你根本不需要`IShellItem`（或`IShellItem2`）。您可以为*nFormat*参数指定**SHGDFIL_FINDDATA （请参阅**[**SHGetDataFromIDList**](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762174(v=vs.85).aspx)*[](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762174(v=vs.85).aspx) **详情）。***

 ***这样做的好处是，对于标准文件系统对象，元数据被编码在 PIDL 本身中，因此即使对象不再存在，该函数也会返回有用的数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-11T02:26:51.620

## 获取创建日期

**使用 IShellItem2**

`IShellItem2``IShellItem`通过添加一些辅助方法来从属性系统中检索类型化属性来扩展。

```
var
   ft: FILETIME;
   createdDate: TDateTime;

// IShellItem2 provides many handy helper methods to IShellItem
(shellItem as IShellItem2).GetFileTime(PKEY_DateCreated, {out}ft);

createdDate := FileTimeToDateTime(ft); 
```

**使用 IShellItem**

~~Windows Vista~~ Windows XP ^([1](https://archive.fo/gprsT))添加了将+`IShellItem`包装成单个对象的功能。Windows Vista 增加了丰富的属性系统，an是一组键值对属性（包括）：`[IShellFolder]``[ITEMID_CHILD]``IPropertyStore``PKEY_DateCreated`

```
var
   ps: IPropertyStore;
   pv: TPropVariant;
   ft: FILETIME;
   createdDate: TDateTime;

//Get the IPropertyStore yourself, in order to read the property you want
shellItem.BindToHandler(nil, BHID_PropertyStore, IPropertyStore, {out}ps);
ps.GetValue(PKEY_DateCreated, {out}pv);  
PropVariantToFileTime(pv, PSTF_UTC, {out}ft);

createdDate := FileTimeToDateTime(ft); 
```

**使用 IShellFolder**

`IShellFolder`是原来的Windows 95界面。它仅代表一个文件夹，您必须询问`ITEMID_CHILD`该文件夹中的项目（ ）。在 Vista 之前是没有的，因为在 Vista*之前*`PKEY_DateCreated`财产系统才存在。但是文件和文件夹仍然有**CreationTime**

 ***```
var
   folder: IShellFolder;
   parent: PIDLIST_ABSOLUTE;
   child: PITEMID_CHILD;
   findData: WIN32_FIND_DATA;

// We have an IShellItem that represents IShellFolder+ChildItemID. 
// Ask the IShellItem to cough up its IShellFolder and child pidl
(shellItem as IParentAndItem).GetParentAndItem(parent, folder, child);

// Get the WIN32_FIND_DATA information associated with the child file/folder
SHGetDataFromIDList(folder, child, SHGDFIL_FINDDATA, findData, sizeof(findData));

createdDate := FileTimeToDateTime(findData.ftCreationTime); 
```******

# r - 将两个数据帧相乘

> ID：15177242
> 
> 赞同：1
> 
> 时间：2013-03-02T17:21:07.023
> 
> 标签：r, dataframe

在 R 中，我有 2 个数据帧“df1”和“df2”。df1 和 df2 如下。

```
>df1
  date      value
1 1990-10-10  3
2 1990-10-11  2.3
3 1990-10-12  2.5

>df2
  date      value
1 1990-10-10  3
2 1990-10-11  2
3 1990-10-12  2 
```

我需要第三个数据框“df3”，它包含与 df1 和 df2 相同的列名。但是 value 字段应该是 df1 和 df2 中的值的乘积。我期待以下输出

```
>df3
  date      value
1 1990-10-10  9
2 1990-10-11  4.6
3 1990-10-12  4 
```

在R中可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T17:45:20.993

与 长距离“合并” `rbind`，并用于`aggregate`生产产品：

```
aggregate(value ~ date, data=rbind(df1,df2), FUN=prod)
##         date value
## 1 1990-10-10   9.0
## 2 1990-10-11   4.6
## 3 1990-10-12   5.0 
```

如果您有数据框列的模式`factor`，则`value`必须转换为`character`then`numeric`以提取值：

```
df1$value <- as.factor(df1$value)
df2$value <- as.factor(df2$value)

aggregate(as.numeric(as.character(value)) ~ date, data=rbind(df1,df2), FUN=prod)
##         date as.numeric(as.character(value))
## 1 1990-10-10                             9.0
## 2 1990-10-11                             4.6
## 3 1990-10-12                             5.0 
```

您也可以使用`as.numeric(levels(value))[value]`. 详情请参阅`?factor`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-02T17:22:56.720

如果所有日期都相同，那么您可以简单地使用：

```
df3 <- df1
df3$value <- as.numeric(as.character(df3$value))
df3$value <- df3$value * as.numeric(as.character(df2$value)) 
```

如果两者的日期*不*相同`data.frames`，请使用`@MatthewLundberg`下面的答案

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T17:26:03.207

也许你可以先`merge`两个`data.frame`然后继续`transform`：

```
> temp <- merge(df1, df2, by = "date")
> temp
        date value.x value.y
1 1990-10-10     3.0       3
2 1990-10-11     2.3       2
3 1990-10-12     2.5       2
> transform(temp, Prod = value.x * value.y)
        date value.x value.y Prod
1 1990-10-10     3.0       3  9.0
2 1990-10-11     2.3       2  4.6
3 1990-10-12     2.5       2  5.0 
```

在这里，由于两个`data.frame`s 具有相同的列名，我已经指定我们只想通过 "date" 变量进行合并，以便两个 "value" 变量都出现在 "temp"`data.frame`中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-02T18:23:59.027

在您解决了 df1 和 df2 具有类型因子的“值”的问题之后，这确实是您在尝试此操作之前应该做的事情，您可以这样做：

```
df3 <- data.frame( data=df1$date, value=df1[ ,"value"]*df2[ ,"value"]) 
```

[R-FAQ： FAQ 7.10](http://cran.r-project.org/doc/FAQ/R-FAQ.html#How-do-I-convert-factors-to-numeric_003f)中介绍了应该为数字的因子的转换

# javascript - 如何更改下一个和上一个按钮的标题和描述？

> ID：15177247
> 
> 赞同：0
> 
> 时间：2013-03-02T17:21:36.500
> 
> 标签：javascript, jquery, json

*编辑：这个问题显然与[jQuery Carousel Evolution](http://codecanyon.net/item/jquery-carousel-evolution/490018)插件的 UI 有关。*

如何更改下一个和上一个按钮的标题和描述？

此外，当我加载页面并且轮播将显示该时间时，默认情况下应显示第一个标题和描述。请解决我的问题。我也分享了链接，请看下面

```
$(document).ready(function () {});

var playListURL = 'http://gdata.youtube.com/feeds/api/playlists/0155DF7A9B0DF819?v=2&alt=json&callback=?';
var videoURL = 'http://www.youtube.com/watch?v=';
$.getJSON(playListURL, function (data) {
    var list_data = "";
    $.each(data.feed.entry, function (i, item) {
        var feedTitle = item.title.$t;
        var feedescription = item.media$group.media$description.$t;
        var feedURL = item.link[1].href;
        var fragments = feedURL.split("/");
        var videoID = fragments[fragments.length - 2];
        var url = videoURL + videoID;
        var thumb = "http://img.youtube.com/vi/" + videoID + "/hqdefault.jpg";
        list_data += '<div><a href= "#" ><img src="' + thumb + '" width="213px" height="141px"/></a></div>';
    });
    $(list_data).appendTo(".slides");
    $('.carousel').carousel({
        carouselWidth: 930,
        carouselHeight: 330,
        directionNav: true,
        shadow: true,
        buttonNav: 'bullets'
    });

    var cnt = 0;
    $(".nextButton").click(function () {
        var len = $(this).siblings(".slides").children(".slideItem").length;
        var a = cnt++;
    });

    $(".prevButton").click(function () {
        var len = $(this).siblings(".slides").children(".slideItem").length;
        var a = cnt++;
    });
}); 
```

演示链接：- [http://jsfiddle.net/4HSpH/4](http://jsfiddle.net/4HSpH/4)

提前感谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:57:58.690

对于问题1，您可以在轮播初始化后使用jQuery添加您的标题属性。您选择的插件似乎没有针对此类事情的非常强大的 API。

[http://jsfiddle.net/4HSpH/6](http://jsfiddle.net/4HSpH/6)

```
$('.prevButton').attr('title', 'My previous button');
$('.nextButton').attr('title', 'My next button'); 
```

要让您的标题在加载时填充，请在上面的代码之后尝试以下操作：

```
$("#title").text($items.filter(function () {
    return $(this).css("top") == "0px";
}).find("a").attr("title")); 
```

# javascript - 从网络在 Facebook 的新闻提要中发布图像

> ID：15177249
> 
> 赞同：0
> 
> 时间：2013-03-02T17:21:46.383
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我想从我的网站在 FB 中发布带有一些文字的图像。但据我在开发人员 api 中看到的，我可以看到图像可以上传到相册（或 FB 为应用程序创建相册）或带有链接的缩略图，但不是用户墙上的常规图像.

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:28:01.703

您可以尝试将其设为序列化链接：

```
<a href="
https://www.facebook.com/dialog/feed?app_id=12345567&link=http://yoursite.com?&picture=http://yoursite/assets/yourimage.jpg&name=This is my cool post&description=This is the content of the post&redirect_uri=http:/yoursite.html?"> </a> 
```

但请确保通过编码器运行它以考虑空间：

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-12T13:43:55.253

最后，我找到了一种方法。这可以按如下方式完成：

1.  上传用户相册中的图片。这可以通过图形 api 中的 'photo' 函数来实现，其中 'url' 字段设置为图像的 URL 或将图像作为 post 字段传递。

2.  然后创建一个带有“链接”字段的提要，指向用户相册中的图像->链接将类似于

> `http://www.facebook.com/photo.php?fbid=<id_of_the_image_gotten_from_previous_operation>`

现在，您可以看到一个大图像已在新闻源中共享。想要了解graph api的照片功能和feed功能，请查看[https://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

# jakarta-ee - 为什么使用“使用工作空间内的资源运行服务器”将 webapp 部署到 WebSphere 会引发异常？

> ID：15177255
> 
> 赞同：1
> 
> 时间：2013-03-02T17:22:10.573
> 
> 标签：jakarta-ee, websphere, rad

我有一个依赖于其他项目的 web 项目。当我使用“使用服务器资源运行服务器，它可以工作”部署我的项目时。当我切换到“使用工作区中的资源运行服务器”时，它会部署，并且当我的启动例程执行时，它会抛出 ClassNotFoundException：

java.lang.ClassNotFoundException: com.somepackage.SomeClass

它抱怨的类可以在我的 web 项目所依赖的项目（一个简单的 java 项目）中找到。该项目已作为完整的 Eclipse 项目（不仅仅是 jar）添加到 Web 项目的类路径中，也已添加到 Web 项目的部署程序集中。

为什么它不起作用？

# php - 使用 PHP MySQL Blowfish 进行站点登录

> ID：15177257
> 
> 赞同：1
> 
> 时间：2013-03-02T17:22:35.223
> 
> 标签：php, mysql, login, blowfish, crypt

我在登录我的网站时尝试验证我的密码时遇到了一个严重问题。我正在使用 php 使用下面的代码创建一个带盐的河豚加密密码。

```
<?php
function cryptPass($p, $rounds = 9) {
$salt = "";
$saltChars = array_merge(range('A','Z'),range('a','z'),range('0','9'));
for($i = 0; $i < 22; $i++){
    $salt .= $saltChars[array_rand($saltChars)];    
}
return crypt($p, sprintf('$2y$%02d$', $rounds) . $salt);
}
?> 
```

这工作正常，加密密码被放入我的 mysql 数据库。问题在于登录时它不会验证。这是登录脚本。

```
if(isset($_POST["u"])){
 // CONNECT TO THE DATABASE
 include_once("php_includes/db_connect.php");
 // GATHER THE POSTED DATA INTO LOCAL VARIABLES AND SANITIZE
 $u = mysqli_real_escape_string($db_connect, $_POST['u']);
 include_once("php_includes/hasher.php");
 $p = (cryptPass($_POST['p']));
 // GET USER IP ADDRESS
$ip = preg_replace('#[^0-9.]#', '', getenv('REMOTE_ADDR'));
 // FORM DATA ERROR HANDLING
 if($u == "" || $p == ""){
     echo "login_failed";
    exit();
 } else {
 // END FORM DATA ERROR HANDLING
     $sql = "SELECT id, username, password FROM users WHERE username='$u' AND activated='1' LIMIT 1";
    $query = mysqli_query($db_connect, $sql);
    $row = mysqli_fetch_row($query);
     $db_id = $row[0];
     $db_username = $row[1];
    $db_pass_str = $row[2];
     if($p != $db_pass_str){
         echo "login_failed";
        exit();
     } else {
//goto the users account 
```

我不应该对传入的用户数据运行 cryptPass 函数吗？

另外值得注意的是mysql数据库密码列设置为VARCHAR（255），因此它有足够的空间。此时密码正确，我无法将其与数据库中的密码进行正确比较。这是我第一次真正尝试将所有教程拼凑在一起的河豚，我想按照 php.net 的建议摆脱 md5。任何帮助将不胜感激。提前感谢您阅读本文。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:52:52.773

`crypt()`下面是 PHP手册页上的更深入的演示：

```
// Only for demonstration, see mcrypt_create_iv() for a better salt:
//   http://php.net/manual/en/function.mcrypt-create-iv.php
$salt = substr(sha1(date('r')), rand(0, 17), 22);
$cost = 10;
$hash = '$2y$' . $cost . '$' . $salt;
$pass = 'mypass';
$notpass = 'notmypass';

$hashed = crypt($pass, "$hash");

echo "
Hash:
$hash

Hashed:
$hashed

Verified: 
" . crypt($pass, $hashed) . "

Not Verified: 
" . crypt($notpass, $hashed); 
```

[https://ignite.io/code/51323c3aec221e7b73000000](https://ignite.io/code/51323c3aec221e7b73000000)

这给出了（至少这次）：

```
Hash:
$2y$10$a80ded6289240c2e41a5e4

Hashed:
$2y$10$a80ded6289240c2e41a5euUFPvmt.sb6lBwOE.JTAdxQsDWmmM.Me

Verified: 
$2y$10$a80ded6289240c2e41a5euUFPvmt.sb6lBwOE.JTAdxQsDWmmM.Me

Not Verified: 
$2y$10$a80ded6289240c2e41a5euj06Emi8HigWM6BpqVFZ.ZtpA9wK5c8G 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:54:06.717

要验证密码，您需要用于创建第一个密码哈希的 salt。这个盐包含在`crypt()`函数的输出字符串中，crypt 可以从密码哈希中提取这个盐。

当您查看 PHP 5.5 中的新哈希函数时，您可以很好地了解它是如何工作`password_hash()`的`password_verify()`......

```
$hashToStoreInDb = password_hash($password, PASSWORD_BCRYPT);
$isPasswordCorrect = password_verify($password, $existingHashFromDb); 
```

...验证登录密码的功能，需要第一个密码的哈希值。然后它可以从这个字符串中提取盐和成本因子，以使用相同的参数对登录密码进行哈希处理。

我可以推荐这个新功能，早期版本有一个[兼容包](https://github.com/ircmaxell/password_compat/blob/master/lib/password.php)。

# ios - 两个 UITabBarController 共享一个 ViewController（作为标签内容）？

> ID：15177260
> 
> 赞同：8
> 
> 时间：2013-03-02T17:22:55.180
> 
> 标签：ios, uitabbarcontroller

情况：两个 UITabBarController，每个都有自己的选项卡，但*两者*中的最后一个选项卡是相同的，所以希望*一个*UIViewController 显示内容。

**运行时问题：共享项目在显示时仅出现在*其中一个*选项卡集中。**

问题：有人知道使这项工作的方法吗？

链接到故事板设置的外部图形：（对不起，没有足够的声誉在这里发布图像！） [故事板图形](http://www.7thcodex.com/stackoverflow/storyboard.png)

带有该情节提要的 Xcode 项目： [XCode Project](http://www.7thcodex.com/stackoverflow/tabcontroller_proj.zip)

每个选项卡内容项都有自己的 UIViewController 类。除了使后退按钮起作用的行之外，它们不包含任何代码。

（是的，我知道这很奇怪。实际情况是一个 iPad 应用程序，其中选项卡控制器显示在弹出窗口中；弹出窗口是“属性编辑器”，其中不同的对象具有不同的属性，但都共享一组共同的属性......因此一个选项卡对于“唯一”道具，所有对象都有的“通用”道具的一个共享选项卡内容。）

我找到了几种解决方法来获得我想要的效果，但如果这个故事板有效，那将是一个更容易的解决方案。

-- 其他信息，与问题有些无关 --

我正在使用的替代解决方案：TabBarControllers 仅链接到一个 VC 作为选项卡内容。当该选项卡 VC 加载时，我使用代码 (a) 通过标识符从情节提要中实例化共享 VC，(b) 通过 [tabController setViewControllers:list animated:NO] 将该新 VC 对象添加到 TabBarController。

（另一种我更不喜欢的可能解决方案：不使用 TabBarController，并在内容 VC 中显示我自己的“选项卡”图形，每个都显示“我自己”被选中。Yuk。）

所以我有一个可行的解决方案，我只是好奇为什么这不起作用（只是 iOS API 中的一个已知事物，或者一些可能使其正常工作的神奇属性设置？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:27:34.767

You can't put the same view controller instance into two tab controllers. The problem is that a view (`UIView`) instance can only have one parent view (`superview`). When you try to add the view controller to the 2nd tab, the view controller's view gets removed from its first parent (the first tab) and then added to the 2nd tab.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-18T14:22:38.273

我在今天遇到同样的问题时偶然发现了你的线程......解决方案是在故事板中制作视图控制器的副本并将副本附加到另一个选项卡栏控制器。我只是做了它并且它有效......我认为'rdelmar'是正确的......复制它并设置它..!!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-02T21:44:48.877

我今天遇到了同样的问题。我设法想出了一个似乎可以解决问题的解决方法。关键是在标签栏和你想要重用的控制器之间添加一层分隔。从每个选项卡栏，我创建了与具有容器视图的不同 UIViewController 的关系。然后，您可以从容器到您实际想要作为选项卡视图重用的控制器进行“嵌入”segue。它不像直接连接那样干净（不确定为什么不支持），因为您必须为每个重用案例创建一个控制器类。它仍然是一个比每次使用都必须复制实际选项卡视图（以及连接到它的任何其他视图）的噩梦更好的解决方案。

希望这可以帮助。如果有人需要更多详细信息，请告诉我。

# android - 在 Android 中运行视频的问题

> ID：15177262
> 
> 赞同：1
> 
> 时间：2013-03-02T17:22:58.043
> 
> 标签：android, youtube-api, android-videoview, mediacontroller

我目前正在使用我的 Android 应用程序。到目前为止，我已经到了需要我的应用程序的地步。最初我想为用户观看一些视频，我想将我的视频存储在我的服务器中（目前是本地的，但以后可能会移动它）然后我没有找到方法如何做到这一点，所以我选择从我的 YouTube 频道加载它出于这个目的“我认为它看起来更色情。” 反正！！！

到目前为止，我运行我的应用程序。在我的手机中，因为我读到模拟器无法运行视频。它在我的手机中运行，但有一些问题。

1-我必须暂停视频 ASA 视频布局弹出并等待视频缓冲或类似的东西，否则我收到错误消息“无法播放此视频”

2-稍后当它加载时它会自行启动，即使我没有按下启动按钮。3-视频占据了屏幕的上半部分，而底部则有一个空白区域，两半之间有间隙。

4- 视频不清楚，因为我可以在笔记本电脑或 YouTube 应用中查看。

这是我的 .java 代码

```
public class video extends Activity {

String SrcPath = "rtsp://v8.cache3.c.youtube.com/CjYLENy73wIaLQltaP8vg4qMsBMYDSANFEIJbXYtZ29vZ2xlSARSBXdhdGNoYOL6qv2DoMPrUAw=/0/0/0/video.3gp";

/** Called when the activity is first created. */

public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.video1);
VideoView myVideoView = (VideoView)findViewById(R.id.vview);
myVideoView.setVideoURI(Uri.parse(SrcPath));
myVideoView.setMediaController(new MediaController(this));
myVideoView.requestFocus();
myVideoView.start();
}} 
```

我真的很想从你那里得到一些帮助。

任何帮助表示赞赏伙计们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:59:10.947

好吧，如果您只想在按下按钮时播放视频。有两种方法

1）从`myVideoView.start();`代码中删除，我认为它会在加载时停止播放视频

2）下一个方法是不要`MediaController`为视频视图设置默认值

您可以创建自定义播放按钮来播放视频并`myVideoView.start();`在其中提供 onclick

```
Button play = (Button) findViewById(R.id.btnPlay);
play .setOnClickListener(this);
Button pause = (Button) findViewById(R.id.btnPause);
pause .setOnClickListener(this);
Button stop = (Button) findViewById(R.id.btnStop);
stop .setOnClickListener(this);
public void onClick(View v) {
switch(v.getId()){
case R.id.btnPlay:
     myVideoView.start();
    /*  the instruccions of the button */
    break;
case R.id.btnPause:
    /*  the instruccions of the button */
    break;
case R.id.btnStop:
      myVideoView.stop();
    /*  the instruccions of the button */
    break;
  }
} 
```

还有关于您正在播放的视频清晰度的`rtsp`链接，您可以在链接中看到低质量视频前夕，您可以在链接中看到`.3gp`低质量的扩展

如果你想提高质量。关注这个 [**YouTube api**](https://developers.google.com/youtube/android/player/downloads/)

[参考](https://stackoverflow.com/a/14477447/1450401)

# java - 部署 mybatis-truts 应用程序时出错

> ID：15177263
> 
> 赞同：0
> 
> 时间：2013-03-02T17:22:58.530
> 
> 标签：java, tomcat, tomcat6, mybatis

我们有一个 Java 应用程序，我们在 tomcat 服务器上使用 .war 文件部署该应用程序。战争被复制到 webapp 目录（tomcat 停止），然后我们启动服务器。我们有几个脚本可以自动化这个过程，直到两天前我们已经部署在开发备份和生产服务器上没有问题......然后我们能够在开发机器上部署，但是在备份和生产（ovh机器）中，我们收到了一个异常启动tomcat：

```
### Error building SqlSession.
### Cause: org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: java.io.IOException: Stream closed
org.apache.ibatis.exceptions.PersistenceException: 
### Error building SqlSession.
### Cause: org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: java.io.IOException: Stream closed
    at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:23)
    at org.apache.ibatis.session.SqlSessionFactoryBuilder.build(SqlSessionFactoryBuilder.java:51)
    at org.apache.ibatis.session.SqlSessionFactoryBuilder.build(SqlSessionFactoryBuilder.java:39) 
```

重新部署旧的 .war 可以正常工作，但新的 .war 始终会产生此异常。我们花了很多时间试图找出问题所在，但是如果我们使用另一个名称来部署战争（只是重命名 .war war 文件）应用程序工作。但我们需要应用程序使用这个特定的上下文名称工作。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:48:13.527

终于解决了...

主要原因是在此版本中使用数据库的 haproxy 的检查 url，因此，当上下文正在部署 haproxy 时，尝试加载此 url 并导致 mybatis 上的几次初始化......

更改 url haproxy 查询可以解决问题，但我不确定避免负载下初始化问题的好方法。

# android - Android Activity 更改导致异常

> ID：15177264
> 
> 赞同：0
> 
> 时间：2013-03-02T17:23:08.083
> 
> 标签：android, android-activity

我正在使用此代码切换到我的类 Main_menu.java：

```
Intent myIntent = new Intent(view.getContext(), Main_menu.class); /** Class name here */
    startActivityForResult(myIntent, 0); 
```

当我运行这个时，我崩溃了这个异常

```
 03-02 10:13:05.933: E/AndroidRuntime(5963): FATAL EXCEPTION: main
03-02 10:13:05.933: E/AndroidRuntime(5963): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.CarbonDev.codecabana/com.CarbonDev.codecabana.Main_menu}: java.lang.ClassCastException: com.CarbonDev.codecabana.Main_menu
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1680)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1784)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.ActivityThread.access$1500(ActivityThread.java:123)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:939)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.os.Looper.loop(Looper.java:130)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.ActivityThread.main(ActivityThread.java:3835)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at java.lang.reflect.Method.invokeNative(Native Method)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at java.lang.reflect.Method.invoke(Method.java:507)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at dalvik.system.NativeStart.main(Native Method)
03-02 10:13:05.933: E/AndroidRuntime(5963): Caused by: java.lang.ClassCastException: com.CarbonDev.codecabana.Main_menu
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
03-02 10:13:05.933: E/AndroidRuntime(5963):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1672)
03-02 10:13:05.933: E/AndroidRuntime(5963):     ... 11 more 
```

这是我的 Main_menu 类代码：

```
package com.CarbonDev.codecabana;

import android.app.Activity;
import android.os.Bundle;

public class Main_menu {
    public class settings extends Activity {

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.menu_activity);
        }

    }
} 
```

这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.CarbonDev.codecabana"
    android:versionCode="1"
    android:versionName="1.0" >
<uses-permission android:name="android.permission.INTERNET" />
    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.CarbonDev.codecabana.CodeEditor"
            android:label="@string/app_name"
            android:windowSoftInputMode="adjustResize"
             >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    <activity android:name="com.CarbonDev.codecabana.Main_menu"></activity>

    </application>

</manifest> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:27:52.843

```
package com.CarbonDev.codecabana;

import android.app.Activity;
import android.os.Bundle;

 public class Main_menu extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.menu_activity);
    }

} 
```

}

这应该可以解决它，请查看[这里](http://developer.android.com/training/basics/firstapp/index.html)以获得一个好的起点。

# java - 无条件更改 JTable 单元格的背景颜色

> ID：15177265
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:23:08.393
> 
> 标签：java, swing, jtable, jxtable

我有`JTable`一个框架，它经常由不同的线程更新。我正在寻找改变单元格背景颜色的方法，`JTable`无论其内容如何，​​例如

```
 JTable.setColorAt(Color.YELLOW, 0, 0) 
```

有这样的东西存在吗？如果没有，有没有办法为像我这样的初学者写这样的东西？

请帮忙.............

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T17:32:00.327

定义你自己的单元格渲染器类，像这样为单元格设置背景颜色

```
public class MyCellRenderer extends javax.swing.table.DefaultTableCellRenderer {
    public java.awt.Component getTableCellRendererComponent(javax.swing.JTable table, java.lang.Object value, boolean isSelected, boolean hasFocus, int row, int column) {
        java.awt.Component cellComponent = super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
        cellComponent.setBackground(java.awt.Color.YELLOW);
        return cellComponent;
    }
} 
```

并将其附加到您的桌子上

```
MyCellRenderer mcr = new MyCellRenderer();
for (int columnIndex = 0; columnIndex < myTable.getColumnCount(); columnIndex ++) {
            myTable.getColumnModel().getColumn(columnIndex).setCellRenderer(mcr);
        } 
```

# ios - 在限制范围内在舞台上添加敌人

> ID：15177267
> 
> 赞同：1
> 
> 时间：2013-03-02T17:23:18.410
> 
> 标签：ios, xcode, cocos2d-iphone

我正在制作一个仅用于测试一些代码的应用程序。有一艘正在射击敌人的船。这些敌人从屏幕顶部下来并被添加了这个代码（它的4个不同的敌人的原因是他们都有不同的行为）

```
-(void) addEnemy {   

int randomX = arc4random() % screenWidth; 

Enemy* anEnemy;

int diceRoll = arc4random() % 4; 

if (diceRoll == 0) {
    anEnemy = [Enemy createEnemy:@"enemy1" framesToAnimate:24];

} else if (diceRoll == 1) {
    anEnemy = [Enemy createEnemy:@"enemy2" framesToAnimate:17];

} else if (diceRoll == 2) {
    anEnemy = [Enemy createEnemy:@"enemy3" framesToAnimate:14];

} else if (diceRoll == 3) {

    anEnemy = [Enemy createEnemy:@"enemy4" framesToAnimate:24];
}

[self addChild:anEnemy z:depthLevelBelowBullet];
anEnemy.position = ccp ( randomX , screenHeight + 200);

numberOfEnemiesOnstage ++; 
} 
```

敌人被添加了一个随机的 x 值，这意味着敌人有时在屏幕之外的一半。像这样：

![](../Images/5bfb46e4283d857b0ca5acbfa2541b7a.png)

如何限制屏幕两侧的 x 值，以免发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:27:34.423

You're not considering the image width when you're calculating the random x position. You have to move the randomX declaration and initialization after you've created the enemy objects so the `textureRect` property will be properly set.

```
int offset = (int)[Enemy textureRect].size.width / 2;
int randomX = (arc4random() % (screenWidth - (2 * offset))) + offset; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:58:33.387

上面的答案是正确的，但如果你使用的是 CCSprite，它会有点不同。试试下面的代码：

```
-(void) addEnemy {   

int randomX = arc4random() % screenWidth; 

Enemy* anEnemy;

int diceRoll = arc4random() % 4; 
int halfWidth;

if (diceRoll == 0) {
    anEnemy = [Enemy createEnemy:@"enemy1" framesToAnimate:24];
    halfWidth = anEnemy.contentSize.width/2;

} else if (diceRoll == 1) {
    anEnemy = [Enemy createEnemy:@"enemy2" framesToAnimate:17];
    halfWidth = anEnemy.contentSize.width/2;

} else if (diceRoll == 2) {
    anEnemy = [Enemy createEnemy:@"enemy3" framesToAnimate:14];
    halfWidth = anEnemy.contentSize.width/2;

} else if (diceRoll == 3) {

    anEnemy = [Enemy createEnemy:@"enemy4" framesToAnimate:24];
    halfWidth = anEnemy.contentSize.width/2;
}

if(randomX < halfWidth) {
    randomX = halfWidth;
} else {
    randomX = randomX-halfWidth;
}

[self addChild:anEnemy z:depthLevelBelowBullet];
anEnemy.position = ccp ( randomX , screenHeight + 200);

numberOfEnemiesOnstage ++; 
} 
```

# jquery - Morris.js 和 datepicker 动态图表

> ID：15177270
> 
> 赞同：3
> 
> 时间：2013-03-02T17:23:36.610
> 
> 标签：jquery, datepicker, morris.js

我希望你能帮助我一点，因为我不是 jquerymaster。我正在尝试显示一个图表，该图表根据 datepicker 传递的值进行更新。

我的 datepicker 函数如下所示：

```
var now3 = new Date();
now3.addDays(-4);
var now4 = new Date()
$('#widgetCalendar').DatePicker({
    flat: true,
    format: 'd-m-Y',
    date: [new Date(now3), new Date(now4)],
    calendars: 3,
    mode: 'range',
    starts: 1,
    onChange: function(formated) {
        $('#widgetField span').get(0).innerHTML = formated.join(' &divide; ');
        $('#test').get(0).innerHTML = 'http://localhost:8888/indkrydsning/app/house/stats_json/' + formated.join('/');
    }
});
var state = false;
$('#widgetField>a').bind('click', function(){
    $('#widgetCalendar').stop().animate({height: state ? 0 : $('#widgetCalendar div.datepicker').get(0).offsetHeight}, 500);
    state = !state;
    return false;
});
$('#widgetCalendar div.datepicker').css(); 
```

我的图表如下所示：

```
var json = (function () {
            var json = null;
            $.ajax({
                'async': false,
                'global': false,
                'url': 'http://localhost:8888/indkrydsning/app/house/stats_json/',
                'dataType': "json",
                'success': function (data) {
                    json = data;
                }
            });
            return json;
        })();

        new Morris.Line({
            // ID of the element in which to draw the chart.
            element: 'myfirstchart',

            // Chart data records -- each entry in this array corresponds to a point on
            // the chart.
            data: json,
            // The name of the data record attribute that contains x-values.
            xkey: 'date',
            // A list of names of data record attributes that contain y-values.
            ykeys: ['value'],
            // Labels for the ykeys -- will be displayed when you hover over the
            // chart.
            labels: ['Antal']
        }); 
```

我知道我可以根据 datepicker 函数中的 onChange 函数加载一个新的 json 文件，但我想替换旧图表，因此不能附加新图表。

我希望我的问题清晰易懂。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-23T12:04:26.160

正如我用莫里斯图所做的那样，函数

```
var _chart = new Morris.Line({
    element: 'myfirstchart',
    data: json,
    xkey: 'date',
    ykeys: ['value'],
    labels: ['Antal']
}); 
```

并且`_chart.setData(_data);`仍然在 Chrome 中测试附加图表。`html('')`我建议使用函数清除您的 HTML 标记。例子：

```
<div id="morris-chart-area" style="width: 300px"></div> 
```

用这个功能清除

```
$('#morris-chart-area').html(''); 
```

关于 onChange 函数。例子

```
$('dropdownid').on('change',function(){
$('#morris-chart-area').html('');
     //TO DO YOUR MORRIS GENERATED FUNCTION ...
}); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-16T05:23:39.883

您可以将 Morris Chart 对象存储到一个全局变量中，然后再访问它的方法。

```
var _chart = new Morris.Line({
        element: 'myfirstchart',
        data: json,
        xkey: 'date',
        ykeys: ['value'],
        labels: ['Antal']
    }) 
```

然后

`_chart.setData(_data);`

请注意，您不必在此处传递完整的选项，只需要数据。

# php - 删除自动添加 来自没有文字内容的页面（使用简码）

> ID：15177274
> 
> 赞同：7
> 
> 时间：2013-03-02T17:23:47.100
> 
> 标签：php, wordpress

我有一个 WordPress 驱动的网站，在主页上使用一个静态页面，除了短代码之外什么都没有来生成内容。

该页面通过将首页设置为静态页面并使用 the_content(); 来获取这些简码。在 page.php 上。页面内容没有空格，只有简码，所以看起来像这样：

```
[content-shortcode blah blah][more content-shortcode blah blah] 
```

一切正常，除了 WordPress`<p></p>`在简码代码之前添加一个空，在所有简码代码的末尾添加另一个 P /P（简码之间没有任何内容）。

我怎样才能删除它们？我不想禁用全局 wpautop 删除功能，因为它对某些用户很有用，我只想删除出现在主页上的第一个和最后一个 P。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-15T14:54:11.627

您可以尝试几件事。

您可以推迟，`wp_autop`因为它在短代码输出之前处理：

```
remove_filter( 'the_content', 'wpautop' );
add_filter( 'the_content', 'wpautop' , 12); 
```

或者使用[`cleanup_shortcode_fix()`](http://pastebin.com/USBetJAj)可以帮助您解决问题的功能：

```
function cleanup_shortcode_fix($content) {
    $array = array('<p>[' => '[', ']</p>' => ']', ']<br />' => ']', ']<br>' => ']');
    $content = strtr($content, $array);
    return $content;
}

add_filter('the_content', 'cleanup_shortcode_fix');
$string = preg_replace_('/<p>s*</p>/', '', $string);
add_filter('the_content', 'cleanup_shortcode_fix', 1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T13:49:50.997

试试这个（将此代码粘贴到某处`functions.php`）：

```
function shortcode_empty_paragraph_fix($content){   
    $array = array (
        '<p>[' => '[', 
        ']</p>' => ']', 
        ']<br />' => ']'
    );

    $content = strtr($content, $array);
    return $content;
}

add_filter('the_content', 'shortcode_empty_paragraph_fix'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T09:14:32.827

[除了过滤帖子内容](http://codex.wordpress.org/How_WordPress_Processes_Post_Content)`wpautop()`之外，还有各种功能，例如，旨在平衡通过编辑器进入的不良 HTML。`force_balance_tags()`

它们主要在[formatting.php](http://core.trac.wordpress.org/browser/trunk/wp-includes/formatting.php)中定义，您可以在其中查看源代码中的各种代码。

正如您所指出的，删除这些过滤器可以像一行一样简单：

`remove_filter('the_content', 'wpautop');`

更多信息：[http ://codex.wordpress.org/Function_Reference/wpautop](http://codex.wordpress.org/Function_Reference/wpautop)

查看下面的链接，这将对您有所帮助。

1.  [删除 WordPress 帖子中的 <p> 和 <br/> 标签](https://stackoverflow.com/questions/6625458/removing-p-and-br-tags-in-wordpress-posts/6627460#6627460)
2.  [wordpress-wrapping-shortcodes-with-p-tags](http://core.trac.wordpress.org/browser/trunk/wp-includes/formatting.php)
3.  [禁用 wpautop 插件](http://urbangiraffe.com/plugins/disable-wpautop/)

这可以帮助你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T23:02:04.467

由于您只想删除`<p>`主页上的标签，请将以下代码添加到您的`functions.php`文件中：

```
add_action('pre_get_posts', 'remove_autop_from_home');
function remove_autop_from_home() {
    // check to see if we are on the home page
    if(is_home()) {
        remove_filter('the_content', 'wpautop');
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-01T09:02:54.497

```
jQuery('p:empty').remove(); 
```

你也可以使用JS。上面的代码将帮助您从页面中删除所有空的 p 标签

# mysql - 如果有任何注册，mysql加入多个表

> ID：15177275
> 
> 赞同：0
> 
> 时间：2013-03-02T17:23:54.360
> 
> 标签：mysql

我有 3 张桌子，每张桌子只有 2 行。T1（身份证，姓名），T2（身份证，电子邮件），T3（身份证，电话）。T1 在 id1 和 id2 上都有注册，T2 仅在 id1 上注册，在 id2 上没有在电子邮件中注册（空）。T3 在 id1 和 id2 上都有 regitrations。我想在某些条件下加入 T1、T2 和 T3（名称如 '% etc %'）。结果应该是一个带有 (name, email, phone) 的表，但是如果其中一个连接表中的注册为 NULL（例如 T2 id2(email) 为 NULL），我希望结果是一个只有 (name ，电话）（T1 + T3，因为T2在id2有一个空注册）......如果列的注册不为NULL，则在多个内部连接上存在某种形式。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:25:32.283

我认为您需要考虑使用`LEFT JOINs`：

```
SELECT T1.Name, T2.Email, T3.Phone 
FROM T1
    LEFT JOIN T2 ON T1.id=T2.id
    LEFT JOIN T3 ON T1.id=T3.id 
```

这将返回表 T1 中的所有记录，并且仅返回与 T2 和 T3 匹配的记录。其他字段将为 NULL。

但是，如果您只想要符合条件的那些，那么请改用 INNER JOIN：

```
SELECT T1.Name, T2.Email, T3.Phone 
FROM T1
    INNER JOIN T2 ON T1.id=T2.id
    INNER JOIN T3 ON T1.id=T3.id 
```

这只会返回匹配的记录。

如果一条记录为 NULL，您关于仅返回 2 列的评论 - 我认为这不是您想要采用的方法。返回您的所有列并在您的演示方面处理此问题。如果您真的想要动态列，那么您需要考虑使用动态 SQL。

- 编辑 -

动态 SQL 方法：

```
SET @id = 2;
SET @sql = NULL;

SELECT
    CONCAT(
      CASE WHEN EMail IS NOT NULL THEN 'Email' ELSE '' END,
      CASE WHEN EMail IS NOT NULL AND Phone IS NOT NULL THEN ',' ELSE '' END,
      CASE WHEN Phone IS NOT NULL THEN 'Phone' ELSE '' END)
    INTO @sql
FROM T1
    LEFT JOIN T2 ON T1.id=T2.id
    LEFT JOIN T3 ON T1.id=T3.id
WHERE T1.Id = @id;

SET @sql = CONCAT('SELECT Name, ', @sql, ' 
                   FROM T1
                      LEFT JOIN T2 ON T1.id=T2.id
                      LEFT JOIN T3 ON T1.id=T3.id
                  WHERE T1.Id = ',@id);

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/0187e/12)

# c# - 如何使用 MVVM 在 WPF 中实现 NetworkAvailabilityChanged？

> ID：15177277
> 
> 赞同：1
> 
> 时间：2013-03-02T17:24:18.757
> 
> 标签：c#, wpf, mvvm, network-programming, network-interface

我有一个 WPF 应用程序，它需要使用 NetworkAvailablityChanged 来确定用户何时从网络断开连接。但是，我正在使用 MVVM 模式开发我的应用程序。所以我不太确定如何使用它来在应用程序启动后立即开始监控。关于实现此功能的最佳方法或监视所有计算机网络接口的更好方法的任何建议？

更新：根据我对 MVVM 的理解，模型与数据交互。在这种情况下，数据将是与活动网络接口的连接发生变化时返回的数据。但是，如果我把它放在模型中，我不知道如何让它在应用程序启动时开始监控。简单地说，我需要创建一个方法来监控网络接口并返回当前活动接口是以太网接口、802.11 无线接口还是根本没有连接。然后基于此，我将在我的模型中调用正确的属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:50:50.960

有时，建筑的纯粹性会干扰设计的简单性。这听起来像是其中一种情况。

继续使用 MVVM 来构建应用程序的工作和数据流。然而，时间指标（如网络可用性）和错误条件（如磁盘空间不足）并不完全适合这些模型，最好独立处理。

# class - 使用彼此对象的类（位于不同的标题中）

> ID：15177283
> 
> 赞同：1
> 
> 时间：2013-03-02T17:24:53.827
> 
> 标签：class, header

名为*Universes的类使用**States*类型的数据成员，而*States*使用*Universes*类型的对象。我正在使用 Visual C++ 2010 Express（如果这有什么不同的话）。

状态.h：

```
class Universes;

extern Universes universe;

class States
{
public:

    int relations;

    States();
};

States::States()
{
    relations = universe.state_no;
} 
```

宇宙.h

```
#include "States.h"

class Universes
{
public:
    States state;
    int state_no;
}; 
```

测试.cpp

```
#include "stdafx.h"
#include <iostream>
#include <conio.h>

#include "Universes.h"

using namespace System;

int main(array<System::String ^> ^args)
{
    Universes universe;
    _getch();
    return 0;
} 
```

我不断收到以下错误：

```
States.h(16): error C2027: use of undefined type 'Universes'
States.h(1) : see declaration of 'Universes'
States.h(16): error C2228: left of '.state_no' must have class/struct/union 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:26:15.473

在您尝试访问`universe.state_no`时，`Universes`该类是不完整的（它是前向声明的）。

解决此问题的一种干净方法是将定义`States::States`移至`States.cpp`，并确保`States.cpp`#includes `Universes.h`。

# plone - 如何将 is_folderish 属性添加到 Dexterity 对象？

> ID：15177286
> 
> 赞同：1
> 
> 时间：2013-03-02T17:25:07.990
> 
> 标签：plone, dexterity

该`.is_folderish`属性在许多地方使用。例如，[将对象设置为默认视图](https://stackoverflow.com/questions/15176176/how-can-i-add-a-dexterity-content-type-as-the-default-view)或[激活对象讨论时](https://stackoverflow.com/questions/10402918/can-not-activate-discussions-on-plone-dexterity-types-folderish)。

我的第一个问题是如何检查对象是否具有该属性集。我尝试使用`bin/instance debug`类似这样的东西：

```
>>> app.site.news.is_folderish
...
AttributeError: is_folderish 
```

我想我无法以这种方式访问​​属性，因为`app.site.news`它是具有该属性的对象的包装器。

我的第二个问题是如何将该属性添加到新的 Dexterity 对象。我想我可以使用下面的代码来做到这一点（但在我的第一个问题得到解决之前我无法测试它）。

```
from zope import schema
from plone.dexterity.content import Item

class IHorse(form.Schema):
    ...

class Horse(Item):
    def __init__(self):
        super(Horse, self).__init__(id)
        is_folderish = False 
```

但我不确定如何将这两个类联系起来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:47:57.067

您不需要添加`is_folderish`到您的类型；它是目录中的一个索引，并且敏捷类型已经具有该索引的适当属性，`isPrincipiaFolderish`.

如果您*确实*需要为内容类型添加属性，您可以使用事件订阅者或创建自定义子类`plone.dexterity.content.Item`：

*   [订阅者](http://plone.org/products/dexterity/documentation/manual/five.grok/core-components/events)可以监听`IObjectCreatedEvent`事件：

    ```
    from zope.app.container.interfaces import IObjectAddedEvent

    @grok.subscribe(IYourDexterityType, IObjectCreatedEvent)
    def add_foo_attribute(obj, event):            
        obj.foo = 'baz' 
    ```

*   [自定义内容类](http://plone.org/products/dexterity/documentation/manual/developer-manual/advanced/classes)需要在您的 XML 类型中注册：

    ```
    from plone.dexterity.content import Item

    class MyItem(Item):
        """A custom content class"""
        ... 
    ```

    然后在您的 Dexterity FTI XML 文件中，添加一个`klass`属性：

    ```
    <property name="klass">my.package.myitem.MyItem</property> 
    ```

# bash - egrep AND 运算符

> ID：15177287
> 
> 赞同：7
> 
> 时间：2013-03-02T17:25:07.977
> 
> 标签：bash, grep

我知道 egrep 有一种非常有用的方法，可以通过以下方式将两个表达式组合在一起：

```
egrep "pattern1.*pattern2"|egrep "pattern2.*pattern1" filename.txt|wc -l 
```

但是，在搜索三个表达式时，是否有一种简单的方法可以使用 egrep 的 AND 运算符，因为当您添加额外的表达式时，排列会呈指数增长。

我知道使用它的另一种方法，`sort|uniq -d` 但是我正在寻找一个更简单的解决方案。

编辑：

我目前的搜索方式将产生五个总结果：

```
#!/bin/bash
pid=$$
grep -i "angio" rtrans.txt|sort|uniq|egrep -o "^[0-9]+ [0-9]+ " > /tmp/$pid.1.tmp
grep -i "cardio" rtrans.txt|sort|uniq|egrep -o "^[0-9]+ [0-9]+ " > /tmp/$pid.2.tmp
grep -i "pulmonary" rtrans.txt|sort|uniq|egrep -o "^[0-9]+ [0-9]+ " > /tmp/$pid.3.tmp
cat /tmp/$pid.1.tmp /tmp/$pid.2.tmp|sort|uniq -d > /tmp/$pid.4.tmp
cat /tmp/$pid.4.tmp /tmp/$pid.3.tmp|sort|uniq -d > /tmp/$pid.5.tmp
egrep -o "^[0-9]+ [0-9]+ " /tmp/$pid.5.tmp|getDoc.mps > /tmp/$pid.6.tmp
head -10 /tmp/$pid.6.tmp

mumps@debianMumpsISR:~/Medline2012$ AngioAndCardioAndPulmonary.script 
1514 Structural composition of central pulmonary arteries. Growth potential after surgical shunts.
1517 Patterns of pulmonary arterial anatomy and blood supply in complex congenital heart disease
with pulmonary atresia
3034 Controlled reperfusion following regional ischemia.
3481 Anaesthetic management for oophorectomy in pulmonary lymphangiomyomatosis.
3547 A comparison of methods for limiting myocardial infarct expansion during acute reperfusion--
primary role of unload 
```

尽管：

```
mumps@debianMumpsISR:~/Medline2012$ grep "angio" rtrans.txt|grep "cardio" rtrans.txt|grep "pulmonary" rtrans.txt|wc -l
185 
```

产生 185 行文本，因为它只采用肺部搜索的值，而不是所有三个搜索。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-02T17:28:36.420

how about

```
grep "pattern1" file|grep "pattern2"|grep "pattern3" 
```

this will give those lines that contain p1, p2 and p3\. but with arbitrary order.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-16T12:37:07.247

肯特的方法与

```
grep "pattern1" file|grep "pattern2"|grep "pattern3" 
```

是正确的，它应该更快，只是为了记录我想发布一个替代方案，它`egrep`可以在不冒泡的情况下做同样的事情：

```
egrep "pattern1.*pattern2|pattern2.*pattern1" 
```

寻找`p1 followed by p2`or `p2 followed by p1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-28T19:05:35.217

最初的问题是关于为什么他的 egrep 命令不起作用。

```
egrep "pattern1.*pattern2"|egrep "pattern2.*pattern1" filename.txt|wc -l 
```

Kent 和 Stanislav 通过将 filename.txt 放在前面来指出语法错误是正确的。但这并不能解决最初的问题。

Bob 的“当前方式”（4 年前）是一种多命令方法，可以在不同的行上 grep 出不同的关键字。换句话说，他的脚本正在寻找一组包含他的***任何***搜索词的行。其他提议的解决方案只会导致包含他***所有***搜索词的行，这似乎不是他的意图。

相反，他可以使用一行 egrep 来查找***任何***术语，如下所示：

```
egrep -e 'pattern1|pattern2' filename.txt 
```

# xml - 使用 XSLT 将 XML 转换为 XML - 转换相似的父节点

> ID：15177288
> 
> 赞同：1
> 
> 时间：2013-03-02T17:25:09.600
> 
> 标签：xml, xslt

我有以下 XML：

```
<EMPLOYEE_LIST>
    <EMPLOYEES_01>
        <PERMANENT>
            <EMPID>650000</EMPID>
            <FIRST_NAME>KEITH</FIRST_NAME>
            <MIDDLE_NAME>H</MIDDLE_NAME>
            <LAST_NAME>ROGERS</LAST_NAME>
        </PERMANENT>
        <CONTRACTUAL>
            <EMPID>650001</EMPID>
            <FIRST_NAME>DARRYL</FIRST_NAME>
            <MIDDLE_NAME>Y</MIDDLE_NAME>
            <LAST_NAME>HANNAH</LAST_NAME>
        </CONTRACTUAL>
    </EMPLOYEES_01>
    <EMPLOYEES_02>
        <PERMANENT>
            <EMPID>650002</EMPID>
            <FIRST_NAME>KEITH</FIRST_NAME>
            <MIDDLE_NAME>ROGERS</MIDDLE_NAME>
            <LAST_NAME>H</LAST_NAME>
        </PERMANENT>
        <CONTRACTUAL>
            <EMPID>650003</EMPID>
            <FIRST_NAME>DARRYL</FIRST_NAME>
            <MIDDLE_NAME>HANNAH</MIDDLE_NAME>
            <LAST_NAME>Y</LAST_NAME>
        </CONTRACTUAL>
    </EMPLOYEES_02>
</EMPLOYEE_LIST> 
```

我正在使用以下 XML 对其进行转换：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
    <xsl:output method="xml" encoding="UTF-8" indent="yes"/>
    <xsl:strip-space elements="*"/>
    <xsl:template match="/EMPLOYEE_LIST">
        <employees>
            <xsl:apply-templates select="EMPLOYEES/node()"/>
        </employees>        
    </xsl:template>    
    <xsl:template match="PERMANENT">
        <permanent>
            <xsl:apply-templates select="*"/>
        </permanent>
    </xsl:template>    
    <xsl:template match="EMPID">
        <emp_id>
            <xsl:value-of select="."/>
        </emp_id>
    </xsl:template>    
    <xsl:template match="FIRST_NAME">
        <f_name>
            <xsl:value-of select="."/>
        </f_name>
    </xsl:template>    
    <xsl:template match="MIDDLE_NAME">
        <m_name>
            <xsl:value-of select="."/>
        </m_name>
    </xsl:template>    
    <xsl:template match="LAST_NAME">
        <l_name>
            <xsl:value-of select="."/>
        </l_name>
    </xsl:template>

    <xsl:template match="CONTRACTUAL">
        <permanent>
            <xsl:apply-templates select="*"/>
        </permanent>
    </xsl:template>    
    <xsl:template match="EMPID">
        <emp_id>
            <xsl:value-of select="."/>
        </emp_id>
    </xsl:template>    
    <xsl:template match="FIRST_NAME">
        <f_name>
            <xsl:value-of select="."/>
        </f_name>
    </xsl:template>    
    <xsl:template match="MIDDLE_NAME">
        <m_name>
            <xsl:value-of select="."/>
        </m_name>
    </xsl:template>    
    <xsl:template match="LAST_NAME">
        <l_name>
            <xsl:value-of select="."/>
        </l_name>
    </xsl:template>
</xsl:stylesheet> 
```

期望转换后的 XML 具有以下输出：

```
<?xml version="1.0" encoding="UTF-8"?>
<employees>
    <employee>
        <emp_id>650000</emp_id>
        <f_name>KEITH</f_name>
        <m_name>H</m_name>
        <l_name>ROGERS</l_name>
        <type>permanent</type>
        <emp_id>650001</emp_id>
        <f_name>DARRYL</f_name>
        <m_name>Y</m_name>
        <l_name>HANNAH</l_name>
        <type>contractual</type>
        <emp_id>650002</emp_id>
        <f_name>KEITH</f_name>
        <m_name>ROGERS</m_name>
        <l_name>H</l_name>
        <type>permanent</type>
        <emp_id>650003</emp_id>
        <f_name>DARRYL</f_name>
        <m_name>HANNAH</m_name>
        <l_name>Y</l_name>
        <type>contractual</type>
    </employee>
</employees> 
```

到目前为止，我还没有成功，因为我是新手，任何帮助将不胜感激

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:44:28.267

我将在这里使用 Dimitre 对您之前的问题的回答作为基础，因为它比我的更简洁：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my" exclude-result-prefixes="my">
  <xsl:output omit-xml-declaration="yes" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <my:Renames>
    <n old="EMPLOYEES" new="employees"/>
    <n old="EMPID" new="emp_id"/>
    <n old="FIRST_NAME" new="f_name"/>
    <n old="MIDDLE_NAME" new="m_name"/>
    <n old="LAST_NAME" new="l_name"/>
    <n old="PERMANENT" new="permanent"/>
    <n old="CONTRACTUAL" new="contractual"/>
  </my:Renames>

  <xsl:variable name="vRenames" select="document('')/*/my:Renames/*"/>

  <xsl:template match="EMPLOYEE_LIST">
    <employees>
      <employee>
        <xsl:apply-templates select="*/*" />
      </employee>
    </employees>
  </xsl:template>

  <xsl:template match="*/*" priority="-1">
    <xsl:element name="{$vRenames[@old = name(current())]/@new}">
      <xsl:apply-templates/>
    </xsl:element>
  </xsl:template>

  <xsl:template match="PERMANENT|CONTRACTUAL">
    <xsl:apply-templates/>
    <type>
      <xsl:value-of select="$vRenames[@old = name(current())]/@new"/>
    </type>
  </xsl:template>
</xsl:stylesheet> 
```

新的部分是这样的：

```
 <xsl:template match="EMPLOYEE_LIST">
    <employees>
      <employee>
        <xsl:apply-templates select="*/*" />
      </employee>
    </employees>
  </xsl:template> 
```

当从上面的示例输入上运行时，这会产生：

```
<employees>
  <employee>
    <emp_id>650000</emp_id>
    <f_name>KEITH</f_name>
    <m_name>H</m_name>
    <l_name>ROGERS</l_name>
    <type>permanent</type>
    <emp_id>650001</emp_id>
    <f_name>DARRYL</f_name>
    <m_name>Y</m_name>
    <l_name>HANNAH</l_name>
    <type>contractual</type>
    <emp_id>650002</emp_id>
    <f_name>KEITH</f_name>
    <m_name>ROGERS</m_name>
    <l_name>H</l_name>
    <type>permanent</type>
    <emp_id>650003</emp_id>
    <f_name>DARRYL</f_name>
    <m_name>HANNAH</m_name>
    <l_name>Y</l_name>
    <type>contractual</type>
  </employee>
</employees> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:35:50.837

**一个更短、更“推式”的解决方案：稍微调整一下我对上一个问题的回答：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my" exclude-result-prefixes="my">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <my:Renames>
  <n old="EMPID" new="emp_id"/>
  <n old="FIRST_NAME" new="f_name"/>
  <n old="MIDDLE_NAME" new="m_name"/>
  <n old="LAST_NAME" new="l_name"/>
  <n old="PERMANENT" new="permanent"/>
  <n old="CONTRACTUAL" new="contractual"/>
 </my:Renames>

 <xsl:variable name="vRenames" select="document('')/*/my:Renames/*"/>

 <xsl:template match="EMPLOYEE_LIST">
  <employees><employee><xsl:apply-templates/></employee></employees>
 </xsl:template>

 <xsl:template match="*/*/*" priority="-1">
     <xsl:element name="{$vRenames[@old = name(current())]/@new}">
       <xsl:apply-templates/>
     </xsl:element>
 </xsl:template>

 <xsl:template match="PERMANENT|CONTRACTUAL">
  <xsl:apply-templates/>
  <type><xsl:value-of select="$vRenames[@old = name(current())]/@new"/></type>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<EMPLOYEE_LIST>
    <EMPLOYEES_01>
        <PERMANENT>
            <EMPID>650000</EMPID>
            <FIRST_NAME>KEITH</FIRST_NAME>
            <MIDDLE_NAME>H</MIDDLE_NAME>
            <LAST_NAME>ROGERS</LAST_NAME>
        </PERMANENT>
        <CONTRACTUAL>
            <EMPID>650001</EMPID>
            <FIRST_NAME>DARRYL</FIRST_NAME>
            <MIDDLE_NAME>Y</MIDDLE_NAME>
            <LAST_NAME>HANNAH</LAST_NAME>
        </CONTRACTUAL>
    </EMPLOYEES_01>
    <EMPLOYEES_02>
        <PERMANENT>
            <EMPID>650002</EMPID>
            <FIRST_NAME>KEITH</FIRST_NAME>
            <MIDDLE_NAME>ROGERS</MIDDLE_NAME>
            <LAST_NAME>H</LAST_NAME>
        </PERMANENT>
        <CONTRACTUAL>
            <EMPID>650003</EMPID>
            <FIRST_NAME>DARRYL</FIRST_NAME>
            <MIDDLE_NAME>HANNAH</MIDDLE_NAME>
            <LAST_NAME>Y</LAST_NAME>
        </CONTRACTUAL>
    </EMPLOYEES_02>
</EMPLOYEE_LIST> 
```

**产生了想要的正确结果：**

```
<employees>
   <employee>
      <emp_id>650000</emp_id>
      <f_name>KEITH</f_name>
      <m_name>H</m_name>
      <l_name>ROGERS</l_name>
      <type>permanent</type>
      <emp_id>650001</emp_id>
      <f_name>DARRYL</f_name>
      <m_name>Y</m_name>
      <l_name>HANNAH</l_name>
      <type>contractual</type>
      <emp_id>650002</emp_id>
      <f_name>KEITH</f_name>
      <m_name>ROGERS</m_name>
      <l_name>H</l_name>
      <type>permanent</type>
      <emp_id>650003</emp_id>
      <f_name>DARRYL</f_name>
      <m_name>HANNAH</m_name>
      <l_name>Y</l_name>
      <type>contractual</type>
   </employee>
</employees> 
```

# ios - 如何对基于视图的表格视图进行排序

> ID：15177289
> 
> 赞同：0
> 
> 时间：2013-03-02T17:25:18.590
> 
> 标签：ios, sorting, core-data, nstableview, nsarraycontroller

我无法对基于视图的表格视图进行排序。我使用一个控制核心数据实体的arrayController。

我尝试选择一列，在属性检查器中，我使用相对于该列的属性名称作为排序键并比较：作为选择器...当我构建和运行时，我单击标题，现在显示更改的箭头每次点击，但行没有任何反应。没有排序。

我该如何解决？
我想我错过了一些简单的东西，但我无法克服它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T21:21:04.013

您可能需要考虑使用`NSFetchedResultsController`. 从 Apple 文档中`NSFetchedResultsController`，

> 您使用获取的结果控制器来有效地管理从核心数据获取请求返回的结果，以便为 UITableView 对象提供数据。

代码如下所示，其中提供排序描述符的行以`NSSortDescriptor`.

```
- (NSFetchedResultsController *)fetchedResultsController
{
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"YourEntityName"
                                              inManagedObjectContext:yourManagedObjectContext];
    [fetchRequest setEntity:entity];

    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"YourSortKey"
                                                                   ascending:YES];

    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];
    [fetchRequest setSortDescriptors:sortDescriptors];

    NSError *error = nil;
    NSArray *fetchedObjects = [yourManagedObjectContext executeFetchRequest:fetchRequest 
                                                                      error:&error];
    if (fetchedObjects == nil) {
        // Handle the error
    }

    yourFetchedResultsController = [[NSFetchedResultsController alloc] 
            initWithFetchRequest:fetchRequest 
            managedObjectContext:self.managedObjectContext
              sectionNameKeyPath:nil
                       cacheName:nil];

    return yourFetchedResultsController;
} 
```

# java - int 除以 int 得到 BigDecimal

> ID：15177290
> 
> 赞同：1
> 
> 时间：2013-03-02T17:25:27.307
> 
> 标签：java, bigdecimal, integer-division

是否可以将两个整数相除以生成 BigDecimal？我正在尝试优化我的代码。如果我可以减少我声明新 BigDecimal 的次数，它应该会显着加快我的流程。到目前为止，我最了解的如何减少计算是：

```
BigDecimal tester = new BigDecimal("103993")
       .divide(new BigDecimal("33102"), 2000, BigDecimal.ROUND_DOWN); 
```

我想知道是否可以做这样的事情：

```
int example1 = 103993;
int example2 = 33102;

BigDecimal example3 = example1/example2; 
```

或类似的规定。我唯一的目标是加快执行时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T17:29:27.140

There is a slight improvement that you can do that uses the [`BigDecimal`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html)'s internal cache by using its [`valueOf`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html#valueOf%28long%29) method:

```
BigDecimal.valueOf(example1).divide(
    BigDecimal.valueOf(example2), 2000, BigDecimal.ROUND_DOWN); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T17:29:33.647

In a word, no. By the time you've divided one `int` by the other, you've already lost information.

# android - Libvirt + Android 模拟器

> ID：15177294
> 
> 赞同：3
> 
> 时间：2013-03-02T17:25:42.380
> 
> 标签：android, android-emulator, libvirt

是否可以使用 libvirt 管理 Android 模拟器？如果可能的话，怎么做？

谢谢，亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-07T11:32:33.103

目前没有针对 Android 模拟器的 libvirt 驱动程序。

# python - 我无法将我的 pygame 游戏链接到我的 tkinter GUI

> ID：15177295
> 
> 赞同：2
> 
> 时间：2013-03-02T17:25:42.083
> 
> 标签：python, user-interface, tkinter, pygame

基本上我已经为我的游戏创建了一个 pygame 菜单，当我点击它们时它会加载所有其他 pygame 窗口，但是对于添加用户等某些方面，我是在 Tkinter GUI 中创建的。当我单击将它们加载到我的 pygame 上时，它不会加载 Tkinter GUI，有谁知道我该如何解决这个问题，或者是否需要添加一些东西才能使其工作。

它好像要加载一些东西但没有加载，第一个名为“mathsvaders”的加载很好，因为它是一个 pygame 程序，但高分在 tkinter 中并且不加载：

```
pos = 1
while True:
# events
for e in pygame.event.get():
    if e.type == pygame.QUIT:
        pygame.quit()
        sys.exit()
    elif e.type == pygame.KEYDOWN:
        if e.key == pygame.K_DOWN:
            pos += 1
            if pos > 5:
                pos = 1
        elif e.key == pygame.K_UP:
            pos -= 1
            if pos < 1:
                pos = 5
        elif e.key == pygame.K_RETURN:
            if pos == 1:
                import MathsvadersReal
            elif e.key == pygame.K_RETURN:
             if pos == 2:
                import Highscore
            elif pos == 5:
             pygame.quit()
             sys.exit() 
```

表单代码如下：

```
import Tkinter import Databaseconnector

 class simpleapp_tk(Tkinter.Tk):
    def __init__(self,parent):
        Tkinter.Tk.__init__(self,parent) 
        self.parent = parent
        self.initialize()

    def initialize(self):
      def create_widgets(self):
        # create welcome label
        label1 = Tkinter.Label(self, text = "Hello world")
        label1.grid(row = 0, column = 2, columnspan = 4, sticky = 'E')

if __name__ == "__main__":
    app = simpleapp_tk(None)
    app.title('my application')
    app.geometry("250x200")
    app.mainloop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-18T16:25:04.473

`Highscore`当您要加载高分时，您的主代码会导入模块，这有两个问题：

1.  在`Highscore`模块中，`__name__`不等于`"__main__"`。它等于`"Highscore"`。因此，`simpleapp_tk`永远不会创建应用程序，也永远`mainloop`不会调用它的方法。这可能是您遇到的问题，但这不是此代码的唯一问题。

2.  该`import`语句将其结果缓存在 中`sys.modules`，因此此代码只能工作一次。要重新加载模块，您必须通过调用`reload(Highscore)`或`del sys.modules["Highscore"]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-08T07:11:27.407

您在这里使用了两个窗口系统，它们都需要定期处理事件。您已将 pygame 设置为主事件处理循环 ( `while True:...`)，但它永远不会让 Tk 处理它的事件循环。当您调用它时，`app.mainloop`它永远不会处理事件。当 pygame 没有要处理的事件时，它会在`while True`循环结束时旋转，这是调用 Tk`update()`方法以允许 Tk 处理事件的好地方。如果您的游戏循环阻塞等待事件，您也可以使用计时器。

简短的回答是处理两个系统的事件。在 pygame 中，调用 pygame 事件方法之一并定期调用 Tk 更新方法。例如：

```
import tkinter as tk
root = tk.Tk()
... other stuff ...
running = True
while running:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
    ... game code ...
    root.update() 
```

# django - Django 的中间件框架什么时候挂钩请求？

> ID：15177298
> 
> 赞同：0
> 
> 时间：2013-03-02T17:25:46.547
> 
> 标签：django, django-middleware

框架是否在`Middleware`将请求对象发送到`urlconf`?
另外，这个钩子在它通过之后会发生`WSGIHandler`吗？
那么，就这三个“层”而言，是不是按顺序`request`处理呢？
**WSGIHandler --> 中间件 --> urlconf**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T00:11:50.257

WSGI 处理程序负责协调对 Python Web 应用程序的所有请求；从技术上讲，您的 WSGI 处理程序是调用 Django 请求/响应过程的其余部分的代码。所以一切都“通过”你的 WSGI 处理程序，如果你正在使用一个。

当有请求进来时，Django 会构造一个请求对象，依次传递给每个注册的中间件。然后将此请求对象传递给视图，该视图应返回一个响应对象，该响应对象可能被序列化为有效的 HTTP 响应。由于 url conf 只是简单地将模式映射到视图函数，因此何时匹配并不重要；最终在中间件之后调用相应的视图。因此，您可以在视图代码中假设任何已注册的中间件已被执行。

谷歌搜索产生了[这个过程的高级视图](http://agiliq.com/blog/2009/06/django-request-response-processing/)。

# php - 模型规则模式

> ID：15177299
> 
> 赞同：0
> 
> 时间：2013-03-02T17:25:47.587
> 
> 标签：php, yii

我希望我的模式允许：az（可以有重音）、AZ（可以有重音）、破折号、空格和点。这个模式应该用哪种方式编写？

实际模式：

```
array('name','match', 'not' => true, 'pattern' => '/[^a-zA-Z0-9-\s]/') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:33:30.873

试试下面的正则表达式，我认为这就是你要找的：

```
$str = 'hjkáÁdfgçÇhj.-hj'; // Matches your criteria
if(preg_match('/^[a-zA-ZÁ-ý\-\. ]+$/', $str))
    echo 'match';
else
    echo 'no match'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T21:05:28.277

can you try this

```
 array('name','match', 'not' => true, 'pattern' => ''^([a-zA-ZÁ-ý\-\. ]+)^'') 

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T17:28:27.840

The meaning of `^` inside `[]` is ***not*** so what you need is almost the same :-)

`/[a-zA-ZÁ-ý0-9-\s]/u`

to further elaborate what you might need is `/^[a-zA-ZÁ-ý0-9-\s]+$/` which allows the whole string to be only of what's inside the `[]` and as many as you want (the `+` is for as many characters as there are)

# python - Python/Xpath 转换查询

> ID：15177311
> 
> 赞同：1
> 
> 时间：2013-03-02T17:26:28.263
> 
> 标签：python, xpath, scrapy

我正在尝试 Scrapy。我有以下内容：

```
hxs.select('//span[contains(@itemprop, "price")]').extract() 
```

输出：

```
[u'<span itemprop="price" class="offer_price">\n<span class="currency">\u20ac</span>\n16<span class="offer_price_fraction">,95</span>\n</span>'] 
```

如何检索此输出：

```
16.95 
```

换句话说，用小数价格跨度添加价格 + 用 替换 , 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:58:43.423

**使用这个单一的 XPath 表达式：**

```
 translate(
             concat(//span[@itemprop = 'price']/text()[normalize-space()],
                    //span[@itemprop = 'price']/span[@class='offer_price_fraction']
                    ),
             ',',
             '.'
             ) 
```

**基于 XSLT 的验证：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:copy-of select=
  "translate(
          concat(//span[@itemprop = 'price']/text()[normalize-space()],
                  //span[@itemprop = 'price']/span[@class='offer_price_fraction']
                 ),
           ',',
           '.'
            )"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于此 XML 文档时：**

```
<span itemprop="price" class="offer_price">
  <span class="currency">\u20ac</span>
16<span class="offer_price_fraction">,95</span>
</span> 
```

**对 XPath 表达式求值，并将该求值的结果复制到输出中：**

```
16.95 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:22:07.960

这是我设置 XPath 选择器的方式：

```
>>> hxs.extract()
u'<html><body><span itemprop="price" class="offer_price">\n<span class="currency">\u20ac</span>\n16<span class="offer_price_fraction">,95</span>\n</span></body></html>' 
```

以下是如何达到预期结果：

```
>>> price = 'descendant::span[@itemprop="price"]'
>>> whole = 'text()'
>>> fract = 'descendant::span[@class="offer_price_fraction"]/text()'
>>> s = hxs.select(price).select('%s | %s' % (whole, fract)).extract()
>>> s
[u'\n', u'\n16', u',95', u'\n']
>>> ''.join(s).strip().replace(',', '.')
u'16.95' 
```

# python - 从 pyside / opencv 访问网络摄像头

> ID：15177313
> 
> 赞同：1
> 
> 时间：2013-03-02T17:26:45.473
> 
> 标签：python, qt, webcam, pyside

我在访问 pyside / opencv 项目中的网络摄像头时遇到问题。

这是一个精简的例子，它产生了我面临的问题：

```
from PySide import QtCore, QtGui
import cv, cv2, time, ImageQt

app = QtGui.QApplication([])

while True:
    camcapture = cv.CaptureFromCAM(0)
    cv.SetCaptureProperty(camcapture,cv.CV_CAP_PROP_FRAME_WIDTH, 1280)
    cv.SetCaptureProperty(camcapture,cv.CV_CAP_PROP_FRAME_HEIGHT, 720);

    frame = cv.QueryFrame(camcapture)
    image = QtGui.QImage(frame.tostring(), frame.width, frame.height, QtGui.QImage.Format_RGB888).rgbSwapped()
    pixmap = QtGui.QPixmap.fromImage(image)

app.exec_() 
```

我在这里看到两个问题。第一：aparently我看到使用v4l2访问网络摄像头的问题，否则它可以从python正常工作（使用其他应用程序）：

```
python ./test.py 
VIDIOC_QUERYMENU: Invalid argument
[... and countless more entries which don#t worry me ...]
VIDIOC_QUERYMENU: Invalid argument
libv4l2: error setting pixformat: Device or resource busy
HIGHGUI ERROR: libv4l unable to ioctl S_FMT
libv4l2: error setting pixformat: Device or resource busy
libv4l1: error setting pixformat: Device or resource busy
HIGHGUI ERROR: libv4l unable to ioctl VIDIOCSPICT 
```

然后是一个不清楚的关机问题，但不是我现在的主要问题：

```
*** glibc detected *** python: double free or corruption (fasttop): 0x00000000029368f0 ***
======= Backtrace: =========
/lib64/libc.so.6(+0x78b66)[0x7f3539f06b66]
/usr/lib64/tls/libnvidia-tls.so.304.64(+0x1cc1)[0x7f352e448cc1]
======= Memory map: ========
00400000-00401000 r-xp 00000000 08:02 3937950                            /usr/bin/python2.7
00600000-00601000 r--p 00000000 08:02 3937950                            /usr/bin/python2.7
00601000-00602000 rw-p 00001000 08:02 3937950                            /usr/bin/python2.7
01631000-03cd3000 rw-p 00000000 00:00 0                                  [heap]
7f351b6dc000-7f351b6dd000 rw-p 00000000 00:00 0 
7f351b6dd000-7f351b773000 rw-s 001c2000 00:05 5759                       /dev/video0
7f351b773000-7f351b809000 rw-s 0012c000 00:05 5759                       /dev/video0
[... and so on ... and so on ... ] 
```

我的问题？我无法从输出中理解。我尝试了许多代码变体，但通常会遇到相同的问题。所以我想这不是特定的代码细节，而是我的设置或方法的一些一般问题。这是环境： - x86-64 平台 (MacBook Pro) 上的 Linux OS (openSUSE-12.2) - opencv 2.4.3 - libqt4 4.8.4 - python 2.7.3

这里有什么问题？我的代码就像所有变体中的所有示例一样。我想念什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:09:17.620

首先，您不应该`cv.CaptureFromCAM(0)`在 while 循环内，因为这是导致“资源繁忙”冲突和内存转储的原因。

您可能需要减慢您的 while 循环。您可以实施`cv2.waitKey()`或使用`time.sleep()`.

之后，您将需要完成 Qt 实现。（这似乎是一个单独的问题。）

这是对您的示例的基本重写：

```
import cv, cv2, time, sys

camcapture = cv.CaptureFromCAM(0)
cv.SetCaptureProperty(camcapture,cv.CV_CAP_PROP_FRAME_WIDTH, 1280)
cv.SetCaptureProperty(camcapture,cv.CV_CAP_PROP_FRAME_HEIGHT, 720)

while True:
    frame = cv.QueryFrame(camcapture)
    ... GUI stuff ...
    time.sleep(.05) 
```

使用 cv2 代替：

```
camcapture = cv2.VideoCapture(0)
while True:
    _, frame = camcapture.read()
    ... GUI stuff ...
    time.sleep(.05) 
```

# javascript - Save/output dynamically generated html source using jquery

> ID：15177318
> 
> 赞同：0
> 
> 时间：2013-03-02T17:27:08.257
> 
> 标签：javascript, jquery

I have a search form that can be built dynamically by the user using code such as:

`$('tr.form_row:last').clone(true).insertAfter('tr.form_row:last');`

All of this is working fine, however, I would like to save the dynamically generated form html when the form is submitted. I have tried using `$(#my_form').html()` but this doesn't appear to have the dynamic content, instead, it's just the default html before customisation that is gathered.

Is there a way of getting the generated source using javascript/jquery? It would need to include the value within the input fields that the user has typed etc.

**EDIT** - I've included my coding so far:

This is the coding I have tried - it uses jquery form plugin and I populate a hidden form field called 'search_html':

```
var search_form = {
    beforeSubmit: function() {
        var search_html = '<table>';
        $('.form_row').each(function() {
            search_html += $(this).html();
        });
        search_html += '</table>';
        $("#search_html").val(search_html);
    },
    success: function(html) { 
        $('#search_output').html(html);
    } 
};  
$('#search_form').ajaxForm(search_form); 
```

When I submit the form, HTML is passed within the hidden 'search_html' field, but it is only the first table row and doesn't have the values of the input fields populated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:10:32.267

由于这似乎不可能以我希望/想到的方式进行，我改为用 PHP 编写代码来收集生成的表单详细信息并将其存储在数据库中。然后当用户返回表单时，我检查他们的 user_id 是否在搜索历史表中，如果是，则使用 PHP 将表单构建回原来的样子。

提交表单时的代码：

```
foreach($_POST["where_field"] as $key => $val){
    $stmt = $pdo->prepare('INSERT INTO dynamic_form (user_id, where_field, where_value, where_criteria) VALUES (:var1, :var2, :var3, :var4)');
    $stmt->bindParam(':var1', $user_id, PDO::PARAM_INT);
    $stmt->bindParam(':var2', $_POST["where_field"][$key], PDO::PARAM_STR);
    $stmt->bindParam(':var3', $_POST["where_value"][$key], PDO::PARAM_STR);
    $stmt->bindParam(':var4', $_POST["where_criteria"][$key], PDO::PARAM_STR);
    $stmt->execute();
} 
```

然后在实际的表单页面上，查询数据库`$user_id`并循环遍历结果以构建他们拥有的表单。

# clojure - 如何通过忽略时间和秒来将日期解析为 clj-time

> ID：15177324
> 
> 赞同：0
> 
> 时间：2013-03-02T17:27:32.437
> 
> 标签：clojure

给定以下字符串，我想得到一个只有日期的日期时间 -

String `"2013-02-20T17:24:33Z"`，我想在忽略时间和秒的情况下获取日期。

以下将起作用 - `(parse (formatters :date-time-no-ms) "2013-02-2T17:24:33Z")`。但是，生成的日期时间对象也包含秒，我如何将其缩减为 year-month-day ？

一种方法是执行正则表达式并提取所需的详细信息，然后将其解析为日期 - `(clojure.core/re-find #"\d{4}-\d{2}-\d{1,2}" "2013-02-20T17:24:33Z")` `(parse (formatters :date) "2013-02-20")`

但是，仅使用 clj-time 应该有更好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:16:12.343

`clj-time`只是 Joda Time 的一个包装器，所以你可以`DateTime`直接在对象上调用方法，幸运的是有一个方法`DateTime#toDateMidnight()`：

```
user=> (parse (formatters :date-time-no-ms) "2013-02-2T17:24:33Z")
#<DateTime 2013-02-02T17:24:33.000Z>
user=> (.toDateMidnight (parse (formatters :date-time-no-ms) "2013-02-2T17:24:33Z"))
#<DateMidnight 2013-02-02T00:00:00.000Z> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T06:06:18.610

```
(defn floor [dt f] 
  (apply date-time 
    (map #(%1 dt) 
      (take-while (partial not= f) [year month day hour minute sec milli]))))

(floor (parse (formatters :date-time-no-ms) "2013-02-2T17:24:33Z") hour) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-24T20:21:17.517

使用`DateTime`方法`.withTimeAtStartOfDay`：

```
(let [^DateTime dt (parse (formatters :date-time-no-ms) "2013-02-2T17:24:33Z")]
  (.withTimeAtStartOfDay dt)) 
```

请注意，[类型提示](https://clojure.org/reference/java_interop#typehints) `^DateTime`会显着提高性能。

# javascript - 如何显示 HTTP 401 基本身份验证对话框

> ID：15177325
> 
> 赞同：3
> 
> 时间：2013-03-02T17:27:34.603
> 
> 标签：javascript, httpwebrequest, httpwebresponse, http-status-code-401, httpserver

我是网络开发的新手。我有使用 HTTPServer 托管一些网页的 Android 应用程序。我正在使用 Netty 对请求/响应进行解码/编码。现在，我想在有人导航到我的网页时显示基本身份验证对话框。像这样的东西：![在此处输入图像描述](../Images/cd4e29acc01c0c8840222a78c467cd2e.png)

我可以得到一些指示吗？它是 HTTP 内置功能，任何 RFC 吗？我需要写一些java脚本吗？任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-02T17:35:47.803

当客户端请求您想要对其进行身份验证的资源时，您只需要发送适当的标头即可。

```
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Basic realm="Restricted Area" 
```

然后，客户端可以在发送格式为 base64 编码的标头时重试请求`username:password`。

```
Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ== 
```

另见： [http ://en.wikipedia.org/wiki/Basic_access_authentication](http://en.wikipedia.org/wiki/Basic_access_authentication)

# perl - 对数组的 perl 数组进行排序

> ID：15177330
> 
> 赞同：0
> 
> 时间：2013-03-02T17:27:45.860
> 
> 标签：perl, multidimensional-array, sorting

我在数组中有一个表，我正在尝试使用以下方法对其进行排序：

```
@table_array = sort { $a->[0] <=> $b->[0] } @table_array; 
```

但我得到这个错误：

```
Can't use string ("5") as an ARRAY ref while "strict refs" in use at 
```

My`$table_array[x][0]`是一个数值。我通过读取两个文件并将它们合并到一个公共字段（`$table_array[x][1]`确切地说）来创建此表。

我无法理解我在哪里要求使用字符串引用访问元素。

谢谢，卡西克 S。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:38:25.057

> My`$table_array[x][0]`是一个数值。

不，那不是真的。对于其中一个元素，`$table_array[x]`是`5`而不是参考。

```
>perl -e"use strict; $a=5; $a->[0]"
Can't use string ("5") as an ARRAY ref while "strict refs" in use at -e line 1. 
```

也许你做到了

```
$table_array[$x] = @rec; 
```

代替

```
$table_array[$x] = \@rec; 
```

# ruby-on-rails - gem cleanup unable to remove bundler

> ID：15177331
> 
> 赞同：0
> 
> 时间：2013-03-02T17:27:51.163
> 
> 标签：ruby-on-rails, gem

Should I just ignore this error, while performing a gem cleanup?

```
gem cleanup
Cleaning up installed gems...
Attempting to uninstall bundler-1.2.3
Unable to uninstall bundler-1.2.3:
    Gem::InstallError: gem "bundler" is not installed
Clean Up Complete 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T21:01:03.120

正如[mpapis](https://stackoverflow.com/users/497756/mpapis)在这个[线程](https://stackoverflow.com/questions/9810108/rvm-cannot-uninstall-bundler-1-1-0)中建议的那样。尝试...

`rvm @global do gem uninstall bundler`

# matlab - writing output data into excel file in matlab

> ID：15177335
> 
> 赞同：0
> 
> 时间：2013-03-02T17:28:01.617
> 
> 标签：matlab

I have 50 images, I want to write data into text file in matlab for each image column wise but when I run the programe it will write data only one image value.

```
srcFiles = dir('E:\practice \\*.jpg');
for i = 1 : length(srcFiles)
  filename = strcat('E:\practice\',srcFiles(i).name);
  I = imread(filename);
  B=bwlabel(I);
  D=regionprops(B,'MajorAxisLength','MinorAxisLength','Extent');
  j=D.MajorAxisLength;
  k=D.MinorAxisLength;
  Axialratio=j/k
  ex=[D.Extent]
  fid=fopen('mu.txt ','wt+');
  fprintf(fid,'extent  Axialratio\n');
  fprintf(fid,'%6f     %6f \n',[ex,Axialratio]);
  fclose(fid);
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:34:40.080

您正在`fopen`使用`wt+`选项。首先，没有这样的选择。也许你的意思是`w+`。文档说：

```
Open or create new file for reading and writing. Discard existing contents, if any. 
```

因此，每次进入`for`每个图像的循环时，您都会丢弃内容。请执行下列操作：

```
srcFiles = dir('E:\practice \\*.jpg');
fid=fopen('mu.txt ','w+');
for i = 1 : length(srcFiles)
  filename = strcat('E:\practice\',srcFiles(i).name);
  I = imread(filename);
  B=bwlabel(I);
  D=regionprops(B,'MajorAxisLength','MinorAxisLength','Extent');
  j=D.MajorAxisLength;
  k=D.MinorAxisLength;
  Axialratio=j/k
  ex=[D.Extent]

  fprintf(fid,'extent  Axialratio\n');
  fprintf(fid,'%6f     %6f \n',ex,Axialratio); //Also don't create a matrix, you could have written it as two separate quantities as I have done now.
 end 
fclose(fid); 
```

这应该有效。

# android - Download Video file from a FTP server in Android

> ID：15177341
> 
> 赞同：0
> 
> 时间：2013-03-02T17:28:33.683
> 
> 标签：android, video, ftp, download, client

I'm developing an Android app to connect to a FTP server and download video files hosted on the FTP server and save to a folder inside the SD card. For that I'm using "org.apache.commons.net.ftp.FTPClient" library. I can connect to the server and get the list of file names on the server from my app, but after I download video files, they get copied to the folder I gave and there size is indicated as 10 bytes and they can't be played(Looks like corrupted). Can some one suggest me a way to over come this issue. The code I used is attached here with.

** Connect to the FTP server**

```
public FTPClient mFTPClient = null;

public boolean ftpConnect(String host, String username,String password, int port)
{
    try {
        mFTPClient = new FTPClient();
        mFTPClient.connect(host,port);

        // now check the reply code, if positive mean connection success
        if (FTPReply.isPositiveCompletion(mFTPClient.getReplyCode())) 
        {
            // login using username & password
            boolean status = mFTPClient.login(username, password);

            mFTPClient.setFileType(FTP.BINARY_FILE_TYPE);
            mFTPClient.enterLocalPassiveMode();

            return status;
        }
    } 
    catch(Exception e) 
    {
        System.out.println("Error: could not connect to host " + host);
        e.printStackTrace();
    }

    return false;
} 
```

**Download files**

```
public boolean ftpDownload(String srcFilePath, String desFilePath)
{
    boolean status = false;
    try {
        FileOutputStream desFileStream = new FileOutputStream(desFilePath);

        status = mFTPClient.retrieveFile(srcFilePath, desFileStream);

        desFileStream.close();

        return status;
    } catch (Exception e) {
        System.out.println( "download failed");
        e.printStackTrace();
    }

    return status;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T19:54:41.680

retrieveFile 也给我带来了问题。尝试使用retrieveFileStream。

# javascript - 如何修复计算两位小数的总和错误

> ID：15177343
> 
> 赞同：1
> 
> 时间：2013-03-02T17:28:39.113
> 
> 标签：javascript, calculator, calculated-columns

这个函数是通过动态表计算借方总数，问题是，它计算了`2.6 + 2.1 = 4.00`，我希望答案是`4.70`，但它没有计算到小数点后两位。

```
function debitvalues() {
    var debittotal = 0;
    var obj = document.getElementsByTagName("input");
    for (var i = 0; i < obj.length; i++) {
        if (obj[i].name == "debit[]") {
            if (obj[i].value > 0) {
                debittotal += parseInt(obj[i].value * 1);
            } else {
                obj[i].value = 0;
                debittotal += parseInt(obj[i].value * 1);
            }
        }
    }
    document.getElementById("debittotal").value = (debittotal * 1).toFixed(2);
    debittotal = 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T17:31:02.823

`int`当您需要解析到时，您解析到`float`：

```
parseInt(obj[i].value*1) 
```

`parseInt`=>`parseFloat`

`parseInt`给你一个自然数 - **N**同时`parseFloat`给你一个实数 - **R**。

顺便说一句，当您将一个数字乘以一个**x**时，您会得到相同的 x 数字，所以我认为您的计算器可以跳过它...

```
parseInt(obj[i].value*1) => parseFloat(obj[i].value) 
```

# javascript - Alternative for oncontextmenu - javascript

> ID：15177344
> 
> 赞同：1
> 
> 时间：2013-03-02T17:28:42.897
> 
> 标签：javascript, xhtml, contextmenu

I'm looking for a JavaScript alternative to `onContextMenu` in an xHTML page. I want to hide the menu which pops-up (The context menu) When I click the right mouse button on a website.

I have a problem using the `onContextMenu` attribute because it doesn't pass the validator for xHTML Strict.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:56:58.083

`oncontextmenu`如果您附加到外部脚本中，它将起作用：

```
<script type="text/javascript" src="script.js"></script> 
```

（确保您包含该`type`属性，以便它验证。）

**`script.js`：**

```
document.body.oncontextmenu = function handleContextMenu(e) {
  e.preventDefault();
  e.stopPropagation();
}; 
```

# php - 在 xml 文件末尾附加的标签

> ID：15177347
> 
> 赞同：0
> 
> 时间：2013-03-02T17:28:51.547
> 
> 标签：php, simplexml

我有一个具有以下格式的 xml 文件-

```
<?xml version="1.0"?>
<db>
<count></count>
<uid></uid>
<score></score>
</db> 
```

我正在向我的 xml 文件中添加数千个项目。

我在 php 中使用 simplexml 来解析我的 xml。我正在打开这样的 xml 文件-

```
$result= new SimpleXMLElement($file, null, true); 
```

并像这样关闭它-

```
file_put_contents($file, $data->asXML()); 
```

虽然当我在我的本地服务器上运行它时一切正常，但是当我在我的服务器上在线上传它时，它可以正常工作一段时间，一段时间后，它会附加在我的 xml 文件的末尾

```
<?xml version="1.0"?>
<db>
<count></count>
<uid></uid>
<score></score>
</db>
/score></db> 
```

我得到一个解析错误-

> 在 xml 文件末尾附加不需要的数据

我很困惑出了什么问题，因为它在我的本地服务器上运行良好。是我的代码的错还是服务器的错？

**编辑：** 计数、uid 和分数是预先填充的。我只是更新分数。这是更新分数部分的代码-

```
$data= new SimpleXMLElement($file, null, true);
$winner=intval($data->score[$winid]);
$loser=intval($data->score[$loseid]);
$exp_winner=expected($loser,$winner);
$new_win=win($winner,$exp_winner);
$exp_loser=expected($winner,$loser);
$new_lose=loss($loser,$exp_loser);
$data->score[$winid]=$new_win;
$data->score[$loseid]==$new_lose;
file_put_contents($file, $data->asXML()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:40:53.337

[尽管在手册页](http://php.net/file_put_contents)上没有明确说明，但似乎默认行为`file_put_contents`是*不*锁定正在写入的文件。这可能意味着两个 PHP 进程都试图同时覆盖文件，这可能是您损坏的原因。

为了消除这种可能性，您可以将`LOCK_EX`标志作为第三个参数传递，即`file_put_contents($file, $data->asXML(), LOCK_EX);`

（我不确定如何检验这个假设，因为这似乎是您遇到的一种罕见的竞争条件......）

# c++ - C++ Unresolved External Symbols Embedded Lua

> ID：15177348
> 
> 赞同：1
> 
> 时间：2013-03-02T17:28:59.440
> 
> 标签：c++, linker, lua

I am trying to make a game with Visual C++ 2010 with an embedded Lua engine, but I keep running into persistent unresolved external symbol errors. I put copies of all the files in the 'include' folder in the project headers folder, and I tried setting the linker library path to the Lua lib folder, as well as setting the include path to the Lua include folder, but I still am getting errors stating that the usage of a couple of Lua core functions are unresolved. I already tried quite a few solutions posted around the internet and each of which resulted in the same errors.

Output:

```
1>Main.obj : error LNK2019: unresolved external symbol _lua_pcall referenced in function _main
1>Main.obj : error LNK2019: unresolved external symbol _luaL_loadfile referenced in function _main
1>Main.obj : error LNK2019: unresolved external symbol _luaL_newstate referenced in function _main 
```

Main.cpp:

```
#include "stdafx.h"
#include "Bubble Wars.h"

extern "C" {
#include "lua.h"
#include "lualib.h"
#include "lauxlib.h"
#include "luaconf.h"
#include "lua.hpp"
}

int main()
{
    lua_State * L = lua_open();
    luaL_dofile(L,"C:/Users/Trevor/Documents/Visual Studio 2010/Projects/Bubble Wars/Bubble Wars/Main.lua");
    return 0;
} 
```

Main.cpp is the only source file that contains any Lua references. Any reasons for the function references to be unresolved?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:31:07.847

在设置链接器目录之后，您还需要提供实际的库以链接到您的链接器。

# python - Enforcing the number of decimal places when printing results

> ID：15177354
> 
> 赞同：2
> 
> 时间：2013-03-02T17:30:06.723
> 
> 标签：python, printing, decimal, evaluation

A different exercise. This one asked to evaluate the value of x for x-2=ln(x). There are two approaches (A and B) - one makes use of the given equation and yields the smaller solution (x1). The other approach uses e**(x-2)=x and yields the other solution (x2).

Program plots the graphical solution and then queries for initial value input. Then it evaluates x using appropriate approaches. Approach A requires initial condition lesser than x2, approach B requires initial condition greater than x1\. Both approaches work for initial conditions that lay somewhere between x1 and x2.

The last part of the code manipulates the output to print only unique solutions.

```
# imports necessary modules

import matplotlib.pyplot as plt
import numpy as np

# plots the equation to provide insight into possible solutions

p = []
x = np.arange(0,5,0.01)
f = x - 2
g = np.log(x)

plt.plot(x,f)
plt.plot(x,g)

plt.show()

# x - 2 = ln(x)

print
lista = map(float, raw_input("Provide the starting conditions to establish the approximate value of the solutions to x-2=ln(x) (separate with spacebar): ").split(" "))
print
sigdig = int(raw_input("Define the number of significant digits (up to 15): "))
print

results1 = []
results2 = []
results3 = []
results4 = []

results = []
resu = []

for i in lista:

    if i > 0.1586:
        y = i

        left = y - 2
        right = np.log(y)
        expo = "%d" % sigdig
        epsi = 10**(-int(expo)-1)
        step = 0

        while abs(left - right) > epsi:
            y = right + 2
            right = np.log(y)
            left = y - 2
            step += 1
            results1.append(y)
        results2.append(results1[-1])

    if i < 3.1462:
        z = i

        left = np.e ** (z - 2)
        right = z
        expo = "%d" % sigdig
        epsi = 10**(-int(expo)-1)
        step = 0

        while abs(left - right) > epsi:
            z = np.e ** (right - 2)
            left = np.e ** (z - 2)
            right = z
            step += 1           
            results3.append(z)
        results4.append(results3[-1])

# combines and evaluates the results

results = results2 + results4

for i in range(len(results)):
    if round(results[i], sigdig) not in resu:
        resu.append(round(results[i], sigdig))
    else:
        pass

print "For given starting conditions following solutions were found:"
print

for i in range(len(resu)):
    printer = '"x_%d = %.' + str(sigdig) + 'f" % (i+1, resu[i])'
    print eval(printer) 
```

My questions are: is it possible to feed the approximate values of x1 and x2 (lines 36 and 53) from the graphical solution instead of hard coding them? Is possible to enforce the number of decimals without the eval work-around present in the code? Printing resu[i] normally yields results that end before nearest decimal "0" (near the end of code). Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:44:35.177

您可以`*`以与 C/C++ 类似的方式在 python 格式字符串中使用。当`%`运算符在格式字符串中遇到 a`*`时，它会在列表中查找整数并将其用作格式字符串中的常量。

以下应该适用于您正在尝试做的事情：

```
print "x_%d = %.*f" % (sigdig,sigdig,resu[i]) 
```

如果`result`is`1.23456`和`sigdig`is `3`，这将输出：

```
x_3 = 1.234 
```

请注意，python 浮点数是[IEEE794 双精度值](http://en.wikipedia.org/wiki/Double-precision_floating-point_format)，这意​​味着它们有大约 15 个有效数字。例如：

```
>>> print "x_%d = %.*f" % (30,30,1.0/3.0)
x_30 = 0.333333333333333314829616256247 
```

请注意，小数点后 17 位以外的所有内容本质上都是随机垃圾。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T02:19:11.417

我认为您的问题[https://stackoverflow.com/questions/15709496](https://stackoverflow.com/questions/15709496)（现已关闭）非常有趣。很遗憾看到它关闭了，所以我将继续作为练习，并将其发布在以下博客上：http: [//nickburns2013.wordpress.com/2013/04/01/3d-water-model /](http://nickburns2013.wordpress.com/2013/04/01/3d-water-model/)。随意评论/添加点点滴滴。

这与这里的这个问题完全无关。向任何关注此线程的人道歉。

# c# - 使用带有 c# 的 HtmlAgilityPack 来查找嵌套的重复类名部分

> ID：15177355
> 
> 赞同：0
> 
> 时间：2013-03-02T17:30:11.007
> 
> 标签：c#, html-parsing, html-agility-pack

我无法弄清楚查询（XPath？）是什么来获取嵌套元素，如下所示。我想让“200”超出范围。我确定的事情是 out 类是“top2 bigone”是一个 div，我希望跨度在类“top2 bigone”中。我把我的 C# 放在下面那当然是行不通的。

谢谢

```
<html>
<body>
    <div class='top1 bigone'>
        <span class='counts numbers'>100</span>
    </div>

    <div class='top2 bigone'>
        <span class='counts numbers'>200</span>
    </div>
</body>
</html> 
```

我的破代码：

```
var input4 =
            (from inputx in htmlDoc.DocumentNode.Descendants("top2 bigone")
             where inputx.Attributes.Count > 0 && inputx.Attributes["class"].Value == "counts numbers"
             select inputx).FirstOrDefault(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:16:56.290

试试这个，测试和工作：

```
HtmlNode node = doc.DocumentNode.SelectSingleNode("//div[@class = 'top2 bigone']//span[@class = 'counts numbers']");

if (node != null)
{
    string number = node.InnerText; // 200
}
else
{
     MessageBox.Show("node = null");
} 
```

# ruby-on-rails - 在 Rails 中处理日期表单的正确方法

> ID：15177356
> 
> 赞同：1
> 
> 时间：2013-03-02T17:30:14.443
> 
> 标签：ruby-on-rails, ruby-on-rails-3, date, datepicker, mongoid

我想知道在 Rails 中处理日期表单和日期字段的正确方法是什么。我的模型中有一个验证器：

```
validates_format_of :birthdate, :with => /\d{2}\/\d{2}\/\d{4}/ 
```

但是当日期无效时，我的控制器中仍然出现此错误：

```
argument out of range 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:31:46.913

你不会匹配单个数字。尝试：

```
/\d{1,2}\/\d{1,2}\/\d{4}/ 
```

# ruby-on-rails - 为什么 active_support 需要 sinatra

> ID：15177362
> 
> 赞同：0
> 
> 时间：2013-03-02T17:30:41.557
> 
> 标签：ruby-on-rails, sinatra

我没有在我的应用程序的任何地方使用 sinatra，不清楚为什么 activesupport 要求需要 sinatra。我应该如何避免这个问题

```
/home/user/.rvm/gems/ruby-1.9.3-p286@app/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require': cannot load such file -- sinatra/base (LoadError) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T17:36:18.333

主动支持不需要 sinatra。但是，由于主动支持是处理丢失常量（以及补丁`require`）的一部分，因此当 require 失败时，它将显示在堆栈跟踪中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T12:54:41.403

它很可能是另一个 gem 的依赖项。例如，resque 使用 Sinatra 来显示监控。您可以使用`gem dependency`这些来查找。

# java - 带有网格的JPanel，滚动时导致高CPU使用率

> ID：15177367
> 
> 赞同：5
> 
> 时间：2013-03-02T17:30:53.807
> 
> 标签：java, swing, jpanel, jscrollpane

我有一个带有 JPanel 的 JSrollPane 作为 ViewPort 组件。在这个 JPanel 上，我使用 paintComponent 绘制一个 64x64px 正方形的网格。JPanel 相当大，28'672 像素 x 14'336 像素，网格仍然是立即绘制的，一切看起来都很好。问题是垂直或水平滚动会导致 CPU 使用率上升相当高，我滚动得越快它就越高。滚动时 CPU 使用率高达 35-50%。滚动相同大小的 JPanel 而不在其上绘制网格，占用的 CPU 很少，因此网格肯定是问题的原因。这个网格是我计划在滚动窗格中做的最基本的部分，如果它现在表现不佳，我担心添加更多“内容”后它将无法使用。

我的问题为什么它使用这么多 CPU 来滚动这个网格，每次滚动条的位置发生变化时，网格都会重新绘制吗？有没有更好或更有效的方法来绘制可滚动网格？

我有一个想法，只绘制可见区域的网格（通过坐标），然后在移动滚动条时重绘该可见区域，但这会大量调用重绘。如果可能的话，我想在启动时绘制整个网格，然后只在命令上重新绘制。

这是我的 JPanel 网格的准系统工作示例。

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.ScrollPaneConstants;
import javax.swing.border.EmptyBorder;

public class GridTest extends JFrame
{
    static JScrollPane scrollPane;
    static JPanel contentPane,gridPane;

    public static void main(String[] args) {
        GridTest frame = new GridTest();
        frame.setVisible(true);
    }

    public GridTest(){
        setTitle("Grid Test");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setResizable(false);
        setBounds(300, 100, 531, 483);

        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        setContentPane(contentPane);
        contentPane.setLayout(null);

        scrollPane = new JScrollPane();
        scrollPane.setBounds(0, 0, 526, 452);
        scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
        scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        contentPane.add(scrollPane);
        gridPane = new JPanel() {
        public void paintComponent( Graphics g ){
            super.paintComponent(g);
            drawGrid(g);
            g.dispose();
         }};
        Dimension gridPaneSize = new Dimension(28672,14336);
        //Dimension gridPaneSize = new Dimension(4096,4096);
    gridPane.setBackground(Color.BLACK);
    gridPane.setPreferredSize(gridPaneSize);
    scrollPane.setViewportView(gridPane);
    }
    public static void drawGrid(Graphics g)
    {
        int width = gridPane.getWidth();
        int height = gridPane.getHeight();

        g.setColor(Color.gray);
        // draw horizontal long lines
        for(int h = 0; h < height; h+=64){
            g.drawLine(0, h, width, h);
        }
        // draw even grid vert lines
        for(int w = 0; w < width; w+=64){
            for(int h = 0; h < height; h+=128){
                g.drawLine(w, h, w, h+64);
            }
        }
        // draw odd grid vert lines
        for(int w = 32; w < width; w+=64){
            for(int h = 64; h < height; h+=128){
                g.drawLine(w, h, w, h+64);
            }
        }
    }
} 
```

编辑：在我对问题的回答中，此代码的更新/固定版本如下。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:40:10.157

*   绘制到在 JViewport 中可见的对象

*   在所有情况下，您都可以确定[`if(Rectangle(viewport.getViewRect()).intersects(Re ctangleFromDesiredObject))`](https://stackoverflow.com/a/8488543/714968)退货`true`，如果是，则`Objects`在`JViewport`

例如

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Random;
import javax.swing.*;

public class TilePainter extends JPanel implements Scrollable {

    private static final long serialVersionUID = 1L;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame frame = new JFrame("Tiles");
                frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                frame.getContentPane().add(new JScrollPane(new TilePainter()));
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
    private final int TILE_SIZE = 50;
    private final int TILE_COUNT = 100;
    private final int visibleTiles = 10;
    private final boolean[][] loaded;
    private final boolean[][] loading;
    private final Random random;

    public TilePainter() {
        setPreferredSize(new Dimension(TILE_SIZE * TILE_COUNT, TILE_SIZE * TILE_COUNT));
        loaded = new boolean[TILE_COUNT][TILE_COUNT];
        loading = new boolean[TILE_COUNT][TILE_COUNT];
        random = new Random();
    }

    public boolean getTile(final int x, final int y) {
        boolean canPaint = loaded[x][y];
        if (!canPaint && !loading[x][y]) {
            loading[x][y] = true;
            Timer timer = new Timer(random.nextInt(500),
                    new ActionListener() {

                        @Override
                        public void actionPerformed(ActionEvent e) {
                            loaded[x][y] = true;
                            repaint(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);
                        }
                    });
            timer.setRepeats(false);
            timer.start();
        }
        return canPaint;
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Rectangle clip = g.getClipBounds();
        int startX = clip.x - (clip.x % TILE_SIZE);
        int startY = clip.y - (clip.y % TILE_SIZE);
        for (int x = startX; x < clip.x + clip.width; x += TILE_SIZE) {
            for (int y = startY; y < clip.y + clip.height; y += TILE_SIZE) {
                if (getTile(x / TILE_SIZE, y / TILE_SIZE)) {
                    g.setColor(Color.GREEN);
                } else {
                    g.setColor(Color.RED);
                }
                g.fillRect(x, y, TILE_SIZE - 1, TILE_SIZE - 1);
            }
        }
    }

    @Override
    public Dimension getPreferredScrollableViewportSize() {
        return new Dimension(visibleTiles * TILE_SIZE, visibleTiles * TILE_SIZE);
    }

    @Override
    public int getScrollableBlockIncrement(Rectangle visibleRect, int orientation, int direction) {
        return TILE_SIZE * Math.max(1, visibleTiles - 1);
    }

    @Override
    public boolean getScrollableTracksViewportHeight() {
        return false;
    }

    @Override
    public boolean getScrollableTracksViewportWidth() {
        return false;
    }

    @Override
    public int getScrollableUnitIncrement(Rectangle visibleRect, int orientation, int direction) {
        return TILE_SIZE;
    }
} 
```

编辑

关于`Rectagle.intersects(Rectagle)`by（`HFOE`here）的好例子`Encephalopathic`来自`old.sun.forum57`

```
import java.awt.BasicStroke;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JViewport;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class IsRectVisible {

    private static void createAndShowUI() {
        JFrame frame = new JFrame("IsRectVisible");
        frame.getContentPane().add(new IsRectVisibleGui());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                createAndShowUI();
            }
        });
    }
}

class IsRectVisibleGui extends JPanel {

    public static final Rectangle RECT = new Rectangle(250, 200, 100, 100);
    public static final Dimension INNER_PANEL_SIZE = new Dimension(600, 800);
    private static final Dimension SCROLLPANE_SIZE = new Dimension(250, 300);
    private static final String NOT_VISIBLE = "Not Visible";
    private static final String VISIBLE = "Visible";
    private static final long serialVersionUID = 1L;
    private InnerPanel innerPanel = new InnerPanel();
    private JViewport viewport = new JViewport();
    private JLabel statusLabel = new JLabel(NOT_VISIBLE);

    IsRectVisibleGui() {
        JScrollPane scrollpane = new JScrollPane();
        scrollpane.setViewport(viewport);
        viewport.add(innerPanel);
        scrollpane.setPreferredSize(SCROLLPANE_SIZE);
        viewport.addChangeListener(new ChangeListener() {
            @Override
            public void stateChanged(ChangeEvent e) {
                Rectangle viewRect = viewport.getViewRect();
                if (viewRect.intersects(RECT)) {
                    statusLabel.setText(VISIBLE);
                } else {
                    statusLabel.setText(NOT_VISIBLE);
                }
            }
        });
        setLayout(new BorderLayout());
        add(scrollpane, BorderLayout.CENTER);
        add(statusLabel, BorderLayout.SOUTH);
    }

    class InnerPanel extends JPanel {

        private static final long serialVersionUID = 1L;

        InnerPanel() {
            setPreferredSize(INNER_PANEL_SIZE);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2 = (Graphics2D) g;
            g2.setColor(Color.red);
            g2.setStroke(new BasicStroke(4));
            g2.draw(RECT);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T18:20:17.380

感谢上面 mKorbel 的回答，我能够使用 getViewRect() 修复代码。

对于将来可能想做类似事情的任何人，我得到一个视口的矩形，然后使用 for 循环来检查 viewrect 的 x/y（顶角）是否在一个 tile (1024x1024) 增量内。如果是，那么我从 x/y 增量瓦片开始绘制网格方块，直到视口 +1 瓦片 (1024) 的宽度/高度。一次快速滑动从上到下滚动只使用大约 5% 的 CPU，这是可以接受的。

这是 JPanel 可滚动网格的更新代码：

```
import java.awt.*;
import javax.swing.*;

public class GridTest extends JFrame
{
    private static final long serialVersionUID = 6632092242560855625L;
    static JPanel gridPane;
    static JViewport view;

    public static void main(String[] args) {
        GridTest frame = new GridTest();
        frame.setVisible(true);
    }

    public GridTest(){
        setTitle("Grid Test");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setSize(600,600);
        setLocationRelativeTo(null);
        setLayout(new BorderLayout());

        JScrollPane scrollPane = new JScrollPane();
        setContentPane(scrollPane);
        view = scrollPane.getViewport();
        gridPane = new JPanel() {
            private static final long serialVersionUID = 2900962087641689502L;
            public void paintComponent( Graphics g ){
            super.paintComponent(g);
            drawGrid(g, view.getViewRect());
         }};
        Dimension paneSize = new Dimension(28672,14336);
        gridPane.setPreferredSize(paneSize);
        gridPane.setBackground(Color.gray);
        scrollPane.setViewportView(gridPane);
    }

    static void drawGrid(Graphics g, Rectangle view){
        int wMax = gridPane.getWidth();
        int hMax = gridPane.getHeight();

        g.setColor(Color.black);
        Rectangle tile = view;
        // set corner tile x/y to the tile increment.
        for(int w = 0; w < wMax; w+= 1024)
        {
            if(tile.x >= w && tile.x < w+1024) { tile.x = (w); }
            for(int h = 0; h < hMax; h+= 1024)
            {
                if(tile.y >= h && tile.y < h+1024) { tile.y = (h); }
            }
        }
        int xTop = tile.x;
        int yTop = tile.y;
        int width = (int) tile.getWidth();
        int height = (int) tile.getHeight();
        width = xTop + width;
        height = yTop + height;
        // Draw even grid squares within visible tiles, starting at top corner tile.
        for(int w = xTop; w < width+1024; w+=64)
        {
            for(int h = yTop; h < height+1024; h+=128)
            {
                g.fillRect(w+1, h+1, 63, 63);
            }
        }
        // Draw odd grid squares within visible tiles, starting at top corner tile.
        for(int w = xTop-32; w < width+1024; w+=64)
        {
            for(int h = yTop+64; h < height+1024; h+=128)
            {
                g.fillRect(w+1, h+1, 63, 63);
            }
        }
    }
} 
```

# c# - Visibility.Collapse 不会在 Win8 上完全折叠项目

> ID：15177370
> 
> 赞同：3
> 
> 时间：2013-03-02T17:31:06.937
> 
> 标签：c#, wpf, xaml, listview, windows-8

我正在对列表视图控件中的项目进行过滤。当项目应该被过滤掉时，我将该项目的可见性更改为 Visibility.Collapsed。

在 Windows 7 中它运行良好：[http ://www.imagebam.com/image/4c8cab240432140](http://www.imagebam.com/image/4c8cab240432140)
[![Win7](../Images/003a3aba93ddc83420b6143654cad85b.png)](https://i.stack.imgur.com/6CvHD.png)

在 Windows 8 上折叠的项目没有完全折叠，并留下大约 4 像素的空白空间：[http ://www.imagebam.com/image/6ab32b240431990](http://www.imagebam.com/image/6ab32b240431990)
[![Win7](../Images/f1b71f53d5efdabbbe343a8828f5d1fa.png)](https://i.stack.imgur.com/3wCPo.png)

XAML 项目模板：

```
<ListView.ItemTemplate>
    <DataTemplate DataType="ItemOfInterest">
        <DockPanel Visibility="{Binding Visible}">
            <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                <TextBlock FontSize="15" Padding="1,0,0,0" TextWrapping="NoWrap" Text="{Binding Path=Title}" Foreground="{Binding Color}"></TextBlock>
                <TextBlock FontSize="11" Padding="10,0,0,0" VerticalAlignment="Bottom" TextWrapping="Wrap" Foreground="Gray" Text="{Binding Path=Owner}"></TextBlock>
                <TextBlock FontSize="12" Padding="10,0,0,0" VerticalAlignment="Bottom" TextWrapping="Wrap" Foreground="White" Text="{Binding Path=StashName}"></TextBlock>
                <TextBlock FontSize="11" Padding="10,0,0,0" VerticalAlignment="Bottom" TextWrapping="Wrap" Foreground="Gray" Text="{Binding Path=StashPos}"></TextBlock>
            </StackPanel>
            <TextBlock DockPanel.Dock="Bottom" FontSize="11" Padding="10,0,0,0" Visibility="{Binding DisplayExtraLine}" TextWrapping="Wrap" Foreground="Gray" Text="{Binding Path=ExtraLine}"></TextBlock>
        </DockPanel>
    </DataTemplate>
</ListView.ItemTemplate> 
```

任何想法是什么原因造成的？或者绕过这个的唯一方法是在过滤掉项目时从列表中删除它们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T20:13:25.530

如果您使用[Snoop](http://snoopwpf.codeplex.com/releases/view/87261)，您将能够看到每个`ListViewItem`都在`Border`高度为 4 的内部。因此，当您折叠时`DockPanel`，`Border`仍然的高度为 4。

解决方案是创建一个`ItemContainerStyle`并隐藏`Border`以及或代替 child `DockPanel`。

这是我的解决方案。我的 Visible 属性是一个布尔值，这就是我需要转换器的原因。

```
<Grid.Resources>
    <Style x:Key="ItemContainerStyle" TargetType="{x:Type ListViewItem}">
        <Setter Property="Visibility" 
                Value="{Binding Visible, 
                        Converter={StaticResource BoolToVisibility}}"/>
    </Style>
</Grid.Resources>

<Grid.ColumnDefinitions>
    <ColumnDefinition/>
    <ColumnDefinition/>
</Grid.ColumnDefinitions>

<ListView ItemsSource="{Binding Items}" 
          ItemContainerStyle="{StaticResource ItemContainerStyle}">
    <ListView.ItemTemplate>
        <DataTemplate DataType="wpfSampleExplorer:ItemOfInterest">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                    <TextBlock FontSize="15" Text="{Binding Path=Title}"/>>
                </StackPanel>
            </DockPanel>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView> 
```

# c# - 实体框架修改分离对象

> ID：15177372
> 
> 赞同：0
> 
> 时间：2013-03-02T17:31:15.023
> 
> 标签：c#, entity-framework

我有一些困惑，源于这个[http://msdn.microsoft.com/en-us/library/vstudio/bb896248(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/vstudio/bb896248(v=vs.100).aspx)关于修改分离的对象。

这似乎表明如果我修改处于分离状态的对象，当我重新附加时，我应该使用 ApplyOriginalValues 而不是 ApplyCurrentValues。但是，当我这样做时，它似乎永远不会像示例中那样更新对象，除非我在重新附加对象后修改它。但是，如果我在附加后进行修改，那么我使用哪一个（applyoriginal 或 applycurrent）似乎并不重要。

这是我的代码：

```
//this never works
            private void UpdateWithOriginal(Category cat, string name)
            {
                using (TestContext ctx = new TestContext())
                {
                    cat.Name = name;
                    ctx.Categories.Attach(cat);
                    ctx.ApplyOriginalValues("Categories", cat);
                    var state = ctx.ObjectStateManager.GetObjectStateEntry(cat).State;  //never modified state here
                    ctx.SaveChanges();
                }
            }

            //this always works
            private void UpdateWithCurrent(Category cat, string name)
            {
                using (TestContext ctx = new TestContext())
                {
                    ctx.Categories.Attach(cat);
                    cat.Name = name;
                    ctx.ApplyCurrentValues("Categories", cat);
                    var state = ctx.ObjectStateManager.GetObjectStateEntry(cat).State;
                    ctx.SaveChanges();
                }
            } 
```

有谁知道为什么 MSDN 链接似乎表明 //this 从不工作，位应该工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:37:24.897

这最终变得如此容易。我不知道为什么我不明白。这是解决方案：

```
private void UpdateWithOriginal(Category cat, string name)
        {
            Category updatedObject = new Category()
            {
                CategoryID = cat.CategoryID,
                Name = cat.Name,
                Topics = cat.Topics
            };
            updatedObject.Name = name;
            using (TestContext ctx = new TestContext())
            {
                ctx.Categories.Attach(updatedObject);
                ctx.ApplyOriginalValues("Categories", cat);
                var state = ctx.ObjectStateManager.GetObjectStateEntry(updatedObject).State;  //never modified state here
                ctx.SaveChanges();
            }
        } 
```

我缺少的是这个。您有两个对象，一个原始对象和一个更新对象。您分离，将其发送到 WCF 服务，进行更改，将对象发回，最后您将对象重新创建为更新的对象。现在为了更新您的上下文，您需要两个对象，因为使用给定的代码，如果您将更新的对象附加到您的上下文，您的实体的状态是这样的：

*   原始值 - 姓名 = Bob
*   当前值 - 姓名 = Bob

没有什么不同，所以 .SAveChanges() 不会做任何事情。由于您附加了更新的对象，因此您必须使用 ApplyOriginalVALues("Categories",OriginalCategory) 来导致：

*   原始值：名称 = Steve
*   当前值：姓名 = Bob

现在您有一个修改过的对象，当您调用 .SaveChanges() 时，更改将生效。如果附加原始对象，则反之亦然（您不需要修改原始值，而是当前值，因此您使用 ApplyCurrentVALues()）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:42:13.647

我认为您只是误读了 MSDN 文章..

来自[ApplyOriginalValues](http://msdn.microsoft.com/en-us/library/dd487216.aspx)的 MSDN 定义：

*`Copies the scalar values from the supplied object into set of original values for the object in the ObjectContext that has the same key.`*

从[ApplyCurrentValues](http://msdn.microsoft.com/en-us/library/dd487246.aspx)的 MSDN 定义：

*`Copies the scalar values from the supplied object into the object in the ObjectContext that has the same key.`*

这正是您所看到的行为。 `ApplyOriginalValues`返回数据库并更新值。`ApplyCurrentValues`使用您拥有的对象中的值，因此您可以更新更改。

# c# - 如何确定 switch 语句中的当前大小写？

> ID：15177374
> 
> 赞同：3
> 
> 时间：2013-03-02T17:31:46.230
> 
> 标签：c#, switch-statement

是否可以确定当前正在评估哪个案例？像这样的示例代码：

```
const int one = 1;
const int two = 2;

int current_num = 1;

switch (current_num){
       case one:
       case two:
           WriteLine(current_case) //outputs 'one'
           break;
} 
```

我相信我可能会变得棘手并使用字典或其他东西来查找`current_num`一旦我开始`WriteLine`，但可能有一种内置方法来获取当前正在评估的当前案例的名称。

*编辑*：简短的回答，这是不可能的。查看 JonSkeet 的答案，寻找一个合理的替代方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T17:35:16.643

目前还不清楚您要做什么，但我*怀疑*您最好使用枚举：

```
enum Foo {
    One = 1,
    Two = 2,
    Three = 3
}

...

int someValue = 2;
Foo foo = (Foo) someValue;
Console.WriteLine(foo); // Two 
```

您仍然可以在 case 语句中使用它：

```
switch (foo) {
    case Foo.One:
    case Foo.Two:
        Console.WriteLine(foo); // One or Two, depending on foo
        break;
    default:
        Console.WriteLine("Not One or Two");
} 
```

# actionscript-3 - 从 SharedObject 加载 ColorTransform

> ID：15177376
> 
> 赞同：0
> 
> 时间：2013-03-02T17:31:54.037
> 
> 标签：actionscript-3, air, shared-objects, colortransform, local-shared-object

我正在使用本地共享对象 (SharedObject) 为我的 Flash 游戏存储一些数据。
我要保存的数据位之一是 ColorTransform 对象。我将 colorTransform 保存到 sharedObject 没有问题，但是当我尝试加载它时，游戏崩溃了。我在 colorTransform 的同时保存和加载其他类型的变量，它们保存/加载很好......还有其他人经历过吗？那里有解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T05:49:06.397

尝试像这样使用[registerClassAlias()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/package.html#registerClassAlias%28%29)：

```
registerClassAlias('flash.geom.ColorTransform',flash.geom.ColorTransform); 
```

在从 SharedObject 中加载 ColorTransform 或将其保存在其中之前。然后你的加载应该是这样的：

```
var myCT:ColorTransform=so.data.storedCT; 
```

# c - C中的递归目录复制

> ID：15177378
> 
> 赞同：0
> 
> 时间：2013-03-02T17:31:55.163
> 
> 标签：c, recursion, tree, directory, copy

我对 C 编程非常陌生，在任何地方都没有关于如何递归复制 C 中目录内容的有用信息（不是 C++、C#、Objective-C、Java、shell、Python 或其他任何东西——这个必须在 C) 中完成。是的，这是家庭作业，明天晚上就要交了，我已经被困了将近两个星期，试图完成这项工作。

我正在尝试搜索给定目录的任何备份版本（例如，带有备份目录“/dir.bak”的目录“dir”）。如果没有，则创建该“/dir.bak”目录，或者如果有，则创建一个名为“/dir.bak.MM-DD-YY-HH-MM-SS”的备份目录。然后将源目录中的所有内容复制到目标目录中。

当我尝试运行此代码时：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <dirent.h>
#include <fcntl.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <sys/time.h>
#include <time.h>

#define BUFSIZE 256

int main (int argc, char* argv[])
{
    DIR *dir;
    struct dirent *dentry;
    struct stat statbuff;
    char buffer[BUFSIZE];//holds time and date suffix
    ssize_t count;
    int fdin, fdout;    
    mode_t  perms =  740;//perms for file I/O ops
    char *cwdNamePntr;
    long maxpath;
    if ( argc != 3 ) //if incorrect number of args passed in...
    {
        printf( "Usage: %s Directory-Path-Name Destination-Folder\n ", argv[0] );
        exit(1);
    }
    char  buffer2[BUFSIZE];//buffer for file I/O ops
    char* datetime;
    int retval;
    time_t  clocktime;
    struct tm  *timeinfo;
    time (&clocktime);
    timeinfo = localtime( &clocktime );
    strftime(buffer, BUFSIZE, "%b-%d-%Y-%H-%M-%S", timeinfo);//store time and date suffix in case we need it
    chdir(argv[1]);
    char *path = argv[2];//source path for I/O ops
    char *newpath = malloc(strlen(path) + 26);//destination paths for I/O ops
    strcpy(newpath,path);
    strcat(newpath,".bak");//test name for backup directory
    if(chdir(newpath)==0)
    {//if our test name is already a directory
        chdir("..");
        strcat(newpath,".");
        strcat(newpath,buffer);//add time and date suffix onto the name of new backup directory
    }
    if ( (mkdir(newpath, perms)) == 0 )//if we successfully made a new backup directory
    {
        chdir(path);
        dir = opendir(".");//move into source directory
        if ( dir ==  0 )
        {//if open directory fails
                fprintf (stderr, "Error in opening directory:  %s\n", path );
            perror( "Could not open directory");
                exit(2);
        }
        dentry = readdir (dir);//load directory

        while (dentry != 0)//while we are reading a directory
        {
            char *filename = dentry->d_name;//get name of file to be copied
            if( (strcmp(filename,".")!=0) && (strcmp(filename,"..")!=0) )
            {
                if  ( (fdin = open ( filename,  O_RDONLY))  == -1)
                {//if cannot open input file
                        perror ( "Error in opening the input file:");
                        exit (2);
                }
                chdir("..");//go back to parent directory
                chdir(newpath);//move to destination directory
                opendir(".");
                if  ( (fdout = open (filename, (O_WRONLY | O_CREAT), perms)) == -1 )
                {//if cannot create output file...
                        perror ( "Error in creating the output file:");
                        exit (3);
                }
                while ( (count=read(fdin, buffer2, BUFSIZE)) > 0 )
                {
                        if ( write (fdout, buffer2, count) != count )
                    {//if cannot write   
                                perror ("Error in writing" );
                                exit(3);
                        }
                } 

                    if ( count == -1 )
                    {//if cannot read
                        perror ( "Error while reading the input file: ");
                        exit(4);
                }

                close(fdin);
                close(fdout);
            }
            chdir("..");//back to parent directory again
            dir = opendir(".");
            if ( dir ==  0 )//if open directory fails
            {
                    fprintf (stderr, "Error in opening directory:  %s\n", path );
                perror( "Could not open directory");
                    exit(666);
            }
            dentry = readdir (dir);//reload directory
        }
    }
    else
    {
        perror("Error in directory creation");
        exit(2);
    }
    return 0;  
} 
```

我得到这个错误：

```
[my-desktop]@ubuntu:~/Desktop$ ./helpmehelpyou.out ~/Desktop new
Error in creating the output file:: Permission denied 
```

一堆代码取自我们的讲师说我们可以使用的示例文件。我不明白为什么这不起作用？完成的函数必须是递归的，并且是选项 4 的四选择程序的一部分。C 对我来说很难掌握或理解，就像我说的，关于 C 的这些东西的信息很少，但是对于 C#、C++、Objective C 和所有其他语言来说，它的数量过多。就像我也说过的，我们不能使用 shell 命令或其他任何东西来完成这项任务。

有人可以帮帮我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:53:09.523

这不会解决您的问题，但我发现您的代码中可能存在错误。我没有看到递归发生。

你看，如果你只有一个子文件夹，这段代码可能工作得很好。但是，如果该子文件夹中有子文件夹，您会怎么做？

您需要递归目录搜索功能。这可能看起来像这样：

```
void SearchDirectory(const char *name) {
    DIR *dir = opendir(name);                //Assuming absolute pathname here.
    if(dir) {
        char Path[256], *EndPtr = Path;
        struct dirent *e;
        strcpy(Path, name);                  //Copies the current path to the 'Path' variable.
        EndPtr += strlen(name);              //Moves the EndPtr to the ending position.
        while((e = readdir(dir)) != NULL) {  //Iterates through the entire directory.
            struct stat info;                //Helps us know about stuff
            strcpy(EndPtr, e->d_name);       //Copies the current filename to the end of the path, overwriting it with each loop.
            if(!stat(Path, &info)) {         //stat returns zero on success.
                if(S_ISDIR(info.st_mode)) {  //Are we dealing with a directory?
                    //Make corresponding directory in the target folder here.
                    SearchDirectory(Path);   //Calls this function AGAIN, this time with the sub-name.
                } else if(S_ISREG(info.st_mode) { //Or did we find a regular file?
                    //Run Copy routine
                }
            }
        }
    }
} 
```

此代码将调用该函数`SearchDirectory`的次数与当前文件夹中的子目录一样多。如果架构运行得太深，您可能会耗尽内存并且程序可能会崩溃，所以请注意。

一旦在文件夹中找不到更多目录（它已到达“叶”文件夹），它将遍历剩余的文件，然后结束函数，从堆栈中弹出最后一个函数调用，允许上一次`SearchDirectory`调用继续搜索。

毕竟，你将拥有一个完整的递归副本。

PS：抱歉剧透，我是在打字后才看到你的评论。

# c++ - 给定： ifstream infile("test.txt") 使用 if(!infile)... 与 if(infile.good())... 相比有优势吗？

> ID：15177379
> 
> 赞同：0
> 
> 时间：2013-03-02T17:32:00.387
> 
> 标签：c++, ifstream

我在阅读中遇到了这段代码：

```
void assure(std::ifstream& infile ) {  
  if(!infile) { /* stuff */}
} 
```

我使用函数参数类型`ifstream&`和测试了好奇心`ifstream`，它似乎有效。我很好奇条件表达式是如何工作的。这是 NULL 对象还是空对象的情况？我认为 C++ 对象不能为 NULL？

既然`!infile`有效，那么失败的`ifstream`对象是如何表示的？

感谢随后的启蒙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:36:24.560

它使用[否定运算符](http://www.cplusplus.com/reference/ios/ios/operator_not/)，并且简单地与`fail()`检查挂钩。

它并不完全相反`good()`，因为它还检查 EOF ( `eofbit`)。

（是的，引用总是指向一个对象，这个问题没有意义，只有一个指针可以为NULL）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:45:32.720

不会有太大的不同，不。两者都会导致非常相似的代码相同的行为。不同之处在于 的行为`eof`，`good`它将返回`false`， where`operator!`将其视为`true`. 但是，在大多数情况下，这几乎没有什么区别，因为如果尝试读取文件末尾，`failbit`则会将其设置为`fstream`状态 - 在某些情况下不会发生这种情况，但大多数情况下，它是一样。

# php - 使用 curl 将图像从目录上传到外部站点

> ID：15177383
> 
> 赞同：1
> 
> 时间：2013-03-02T17:32:38.037
> 
> 标签：php, curl

好的，我想知道是否可以使用 curl 并从我的站点目录上传图像，而不是从我的机器上，我需要做的是使用表单中的文件选择从我的图像目录上传图像，如果有人知道我需要在我的代码中编辑什么我将不胜感激，我浏览了整个网络，但在我的搜索中一无所获，我在想我需要文件获取内容 base64 编码然后发布我的想法是否正确？

```
$upload_url = 'http://example.com/settings/upload-img';
$file_path = 'directory/image.png';
$fields = array(
   "MAX_FILE_SIZE" => "",
   "fileselect[]" => $file_path
);

foreach ($fields as $key => $val) {
   $post_data .= $key . '=' . $val . '&';
}

$chr = curl_init();
curl_setopt($chr, CURLOPT_URL, $upload_url);
curl_setopt($chr,CURLOPT_POST, count($fields));
curl_setopt($chr,CURLOPT_POSTFIELDS, rtrim($post_data, '&'));
curl_setopt($chr, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($chr);
curl_close($chr); 
```

我对 base64_encode() 的图像的想法如下，我不确定我是否正确地认为这可能有效。

```
$raw_img = base64_encode(file_get_contents('directory/image.png')); 
```

然后使用 "fileselect[]" => $raw_img

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:50:21.747

```
<?php
$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible;)");
curl_setopt($ch, CURLOPT_URL, _VIRUS_SCAN_URL);
curl_setopt($ch, CURLOPT_POST, true);
// same as <input type="file" name="file_box">
$post = array(
    "file_box"=>"@/path/to/myfile.jpg",
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post); 
$response = curl_exec($ch);
?> 
```

似乎很多人想知道什么是_VIRUS_SCAN_URL？

# _VIRUS_SCAN_URL

它是针对开发人员的新主机病毒扫描。在内部将所有文件发送到病毒扫描模块以检查是否有病毒对服务器造成损坏。

服务由[http://virusade.com](http://virusade.com)开发，但仍处于 beta 模式和 _VIRUS_SCAN_URL 和@那里的 api PROTOCAL。

他们只需从服务器获取文档并对其进行扫描，如果没有病毒，则将其发送到上传服务器。

# git - Git 分叉/合并冲突？

> ID：15177389
> 
> 赞同：3
> 
> 时间：2013-03-02T17:33:19.120
> 
> 标签：git, github, git-merge, git-fork

我对版本控制和整个 Github 还是很陌生。有些事情让我很困惑，我似乎无法理解它。想象一个场景，我们两个人在同一个 Rails 应用程序项目上工作。Guy A 拥有主仓库，Guy B 是 fork 仓库的人。现在 Guy B 创建了一个应用程序中不存在的新功能。这样做时，他必须编辑一些文件，在某些情况下还要四处走动，才能得到想要的结果。

与此同时，Guy A 正在开发一个非常相似的功能，并且还必须编辑和移动非常相似的文件，但源代码却非常不同。或者，也许他正在开发一个不同的功能，让他编辑这些相同的文件，但使用不同的源代码。现在 Guy B 提交了一个 pull request，而 Guy A 还必须将他创建的功能合并到 master 分支中。github 如何协调这些由两个不同的人以不同方式更改的相同文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:43:39.537

Github 将合并用于拉取请求。有时，需要在 Guy B 的 repo 上进行手动合并，以解决拉取请求合并无法处理的冲突。有时变基可能会更好一些，但你的里程可能会有所不同。

就我个人而言，我的方法是最后添加他/她的代码的人是负责合并/变基的人，然后再通过拉取请求或手动集成推回权威仓库或分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:50:38.053

当我在一个多用户项目中工作时，工作流程是这样的：

*   Guy A 在本地 repo 中进行更改 -> 将更改推送到远程 repo

*   Guy B 在本地 repo 中进行更改 -> 将更改推送到远程 repo（这里会失败）

*   Guy B 执行 a `git fetch`follow by`git merge`或 a`git rebase`以便他的更改与来自远程的更改合并。Guy B 应该立即将这些更改推送到遥控器

*   Guy A 在他的本地 repo 中进行了更多更改 -> 推送更改（它会再次失败）。在合并或变基方面，他遵循与 Guy B 类似的一组步骤。

用 Github 术语来说，将更改推送到远程 repo 的概念`pull request`在 github 中处理。当有人向某个 repo 中的某个分支发送拉取请求时，请求者有责任针对该目标对他的更改进行合并/变基，然后发送`pull request`.

如果收到拉取请求的用户看到很多冲突，要么是因为请求者没有付出足够的努力来进行合并，要么是因为之前有他必须处理的拉取请求，现在导致冲突，那么所有者可以问请求者`pull request`在最新更改之上发送更新。

换句话说，接收拉取请求的人通常会很乐意接受`fast-forward merges`，但也有少数例外。

# java - 如何在不使用 lang 类的情况下编写将二进制数转换为十进制数的程序？

> ID：15177392
> 
> 赞同：0
> 
> 时间：2013-03-02T17:33:34.153
> 
> 标签：java, class, binary, decimal

这是我的代码，我使用 lang 类。但我想写一个不包含 lang 类的类似程序。请帮我。

```
import java.lang.*;
import java.io.*;
public class DecimalToBinary {
public static void main(String[] args) throws IOException{
    BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
    System.out.print("Enter a Binary number");
    String str=br.readLine();
    long num=Long.parseLong(str);
    long rem;
    while(num>0){
        rem=num%10;
        num=num/10;
        if(rem!=0&&rem!=1){
            System.out.println("This is not a binary number,Please enter again");

        }
    }
    int i=Integer.parseInt(str,2);
    System.out.println("Decimal:"+i);

} 
```

}

如何在不使用 lang 类的情况下进行相同的转换？请帮我！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:50:19.190

考虑这一点的一种方法是将问题分成两部分。

1.  测试输入的字符串是否代表二进制数。这很简单，对吧？考虑一下如何测试字符串中的字符。
2.  转换为十进制。这有点难。但是，一旦您确定 String 是合法的二进制文件，代码就会变得更短、更简单、更容易编写和理解。

ps您添加到问题中的“类”标签是指Java/C#“类”，而不是学校作业。我认为“作业”是正确的标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T13:43:46.737

我建议您从索引 N - 1 到 0 遍历输入的字符，并检查当前字符是否有效，如果不是，则通过抛出异常停止。如果它是有效的，您计算类似“2 pow（二进制数字的当前位置，例如（N - 1 - i））”并将其添加到您的结果中。由于这可能是一个家庭作业，我只能给你这些不完整的提示。您应该考虑一下，其余的解决方案取决于您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T17:41:19.767

您不需要导入 java.lang.*
这是编辑后的代码：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class DecimalToBinary {

public static void main(String[] args) throws IOException {
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    System.out.print("Enter a Binary number");
    String str = br.readLine();
    long num = Long.parseLong(str);
    long rem;
    while (num > 0) {
        rem = num % 10;
        num = num / 10;
        if (rem != 0 && rem != 1) {
            System.out.println("This is not a binary number,Please enter again");

        }
    }
    int i = Integer.parseInt(str, 2);
    System.out.println("Decimal:" + i);

} 
```

}

# java - 我如何知道 Document.insertString() 方法插入的字符数？

> ID：15177393
> 
> 赞同：1
> 
> 时间：2013-03-02T17:33:41.323
> 
> 标签：java, swing, defaultstyleddocument

我正在自定义实现 DefaultStyledDocument。有时，我需要知道 Document.insertString() 方法将（或已经）插入多少个字符。

但我没有找到如何计算它。（方法 insertString() 本身无法帮助我，因为它返回 void）。

那么可以计算这个值吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:58:06.337

你可以使用 length() 方法吗？IE：

```
String s = "Example";     
int len = s.length(); 
```

# parallel-processing - LSF 中的混合 MPI/OpenMP

> ID：15177395
> 
> 赞同：4
> 
> 时间：2013-03-02T17:33:51.000
> 
> 标签：parallel-processing, mpi, openmp

我正在将一个由 OpenMP 并行化的程序移动到集群。该集群使用 Lava 1.0 作为调度程序，每个节点有 8 个核心。我在作业脚本中使用了 MPI 包装器来进行多主机并行。

这是作业脚本：

```
#BSUB -q queue_name
#BSUB -x

#BSUB -R "span[ptile=1]"
#BSUB -n 1

#BSUB -J n1p1o8
##BSUB -o outfile.email
#BSUB -e err

export OMP_NUM_THREADS=8

date
/home/apps/bin/lava.openmpi.wrapper -bynode -x OMP_NUM_THREADS \
    ~/my_program ~/input.dat ~/output.out 
date 
```

我专门在 ONE 主机上做了一些实验。但是，我不知道如何解释一些结果。

1.
`-n``OMP_NUM_THREADS``time`
`1      ``4      ``21:12      `
`2      ``4      ``20:12      `

这是否意味着 MPI 在这里不做任何并行？我认为在第二种情况下，每个 MPI 进程都会有 4 个 OMP 线程，因此它应该使用 800% 的 CPU 使用率，这应该比第一个更快。

另一个证明它的结果是
`-n``OMP_NUM_THREADS``time`
`2      ``2      ``31:42      `
`4      ``2      ``30:47      `

它们的运行时间也非常接近。

2.
在这种情况下，如果我想通过简单的方式在这个集群中以合理的优化速度并行这个程序，在每个主机中放置1个MPI进程（告诉LFG我使用一个核心）是否合理，设置OMP_NUM_THREADS = 8，然后专门运行它？因此 MPI 仅适用于跨节点作业，而 OpenMP 适用于内部节点作业。（-n = 主机数；ptile = 1；OMP_NUM_THREADS = 每个主机的最大内核数）

**更新：** 该程序由 gfortran -fopenmp 编译，没有 mpicc。MPI 仅用于分发可执行文件。

**更新 3 月 3 日：** 程序内存使用情况监视器

*本地环境：Mac 10.8 / 2.9 Ghz i7 /8GB 内存*

没有 OpenMP

*   实际内存大小：8.4 MB
*   虚拟内存大小：2.37 GB
*   共享内存大小：212 KB
*   私有内存大小：7.8 Mb
*   虚拟专用内存：63.2 MB

使用 OpenMP（4 线程）

*   实际内存大小：31.5 MB
*   虚拟内存大小：2.52 GB
*   共享内存大小：212 KB
*   私有内存大小：27.1 Mb
*   虚拟专用内存：210.2 MB

*集群硬件简要信息*

每台主机都包含双四核芯片，即每个节点 8 个内核和 8GB 内存。此集群中的主机通过 infiniband 连接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-03T20:02:19.943

考虑到您在评论中指定的信息，您最好的选择是：

*   请求独占节点访问权限`-x`（您已经这样做了）；
*   为每个节点请求一个插槽`-n 1`（您已经这样做了）；
*   设置`OMP_NUM_THREADS`为每个节点的核心数（您已经这样做了）；
*   启用 OpenMP 线程的绑定；
*   直接启动可执行文件。

您的作业脚本应如下所示：

```
#BSUB -q queue_name
#BSUB -x
#BSUB -n 1

#BSUB -J n1p1o8
##BSUB -o outfile.email
#BSUB -e err

export OMP_NUM_THREADS=8
export OMP_PROC_BIND=true

date
~/my_program ~/input.dat ~/output.out
date 
```

`OMP_PROC_BIND`是 OpenMP 3.1 规范的一部分。如果使用符合旧版本标准的编译器，您应该使用特定于供应商的设置，例如`GOMP_CPU_AFFINITY`用于 GCC 和`KMP_AFFINITY`英特尔编译器。将线程绑定到内核可防止操作系统在不同处理器内核之间移动线程，从而加快执行速度，尤其是在数据局部性非常重要的 NUMA 系统（例如，具有多个 CPU 插槽和每个插槽中的单独内存控制器的机器）上.

如果您想在不同的输入文件上运行程序的多个副本，请提交数组作业。使用 LSF（我猜也使用 Lava）这是通过更改作业脚本来完成的：

```
#BSUB -q queue_name
#BSUB -x
#BSUB -n 1

#BSUB -J n1p1o8[1-20]
##BSUB -o outfile.email
#BSUB -e err_%I

export OMP_NUM_THREADS=8
export OMP_PROC_BIND=true

date
~/my_program ~/input_${LSF_JOBINDEX}.dat ~/output_${LSF_JOBINDEX}.out
date 
```

`-J n1p1o8[1-20]`这将提交一个包含 20 个子作业 ( )的数组作业。`%I`in`-e`被作业编号替换，因此您`err`将从每个作业中获得一个单独的文件。环境变量设置为当前`LSF_JOBINDEX`作业索引，即它将`1`在第一个作业中，`2`在第二个作业中，依此类推。

* * *

我关于程序内存使用的问题不在于它消耗了多少内存。这是关于在单个 OpenMP 循环中处理的典型数据集有多大。如果数据集不够小，无法放入 CPU 的最后一级缓存，则需要考虑内存带宽。如果您的代码对每个数据项进行繁重的本地处理，那么它可能会随着线程数的增加而扩展。如果另一方面它进行简单而轻量的处理，那么即使是单个线程，内存总线也可能会饱和，尤其是在代码被正确矢量化的情况下。通常这是通过以 FLOPS/字节为单位的所谓操作强度来衡量的。它给出了在从内存中获取下一个数据元素之前发生的数据处理量。高操作强度意味着 CPU 中发生了大量的数字运算，并且数据很少传输到内存或从内存传输。无论内存带宽是多少，此类程序几乎与线程数成线性关系。另一方面，操作强度非常低的代码受内存限制，导致 CPU 未得到充分利用。

严重受内存限制的程序不会随线程数而扩展，而是随可用内存带宽扩展。例如，在较新的 Intel 或 AMD 系统上，每个 CPU 插槽都有自己的内存控制器和内存数据路径。在这样的系统上，内存带宽是单个插槽的带宽的倍数，例如，具有两个插槽的系统提供的内存带宽是单插槽系统的两倍。在这种情况下，无论何时使用两个套接字，您都可能会看到代码运行时间的改进，例如，如果您设置`OMP_NUM_THREADS`为等于内核总数，或者如果您设置`OMP_NUM_THREADS`为等于`2`并告诉运行时将两个线程放在不同的套接字上（当线程正在执行向量化代码并且单个线程能够使本地内存总线饱和时，这是一个合理的场景）。

# java - 从 Callable 返回的本地类的序列化

> ID：15177399
> 
> 赞同：4
> 
> 时间：2013-03-02T17:34:05.013
> 
> 标签：java, exception, serialization, anonymous-class, callable

这是一个脑筋急转弯。

我知道这个实际的代码在很多层面上都是可怕的。我的问题不是*如何*做到这一点（我知道静态初始化块），而是*为什么*这不起作用，以利于我对 Java 序列化的理解。

为什么这行得通

```
import java.io.*;
import java.util.*;

class Main {

    static Comparator<String> COMPARE_STRING_LENGTH;
    static {
        class CompareStringReverse implements Comparator<String>, Serializable {
            public int compare(String o1, String o2) {
                return o1.length() - o2.length();
            }
        };
        COMPARE_STRING_LENGTH = new CompareStringReverse();    
    }

    public static void main(String[] args) throws IOException {
        ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream("test.ser"));
        out.writeObject(new TreeSet<String>(COMPARE_STRING_LENGTH));
        out.close();
    }

} 
```

而这

```
import java.io.*;
import java.util.*;
import java.util.concurrent.Callable;

class Main {

    static Comparator<String> COMPARE_STRING_LENGTH = new Callable<Comparator<String>>() {
        public Comparator<String> call() {
            class CompareStringReverse implements Comparator<String>, Serializable {
                public int compare(String o1, String o2) {
                    return o1.length() - o2.length();
                }
            };
            return new CompareStringReverse();
        }
    }.call();

    public static void main(String[] args) throws IOException {
        ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream("test.ser"));
        out.writeObject(new TreeSet<String>(COMPARE_STRING_LENGTH));
        out.close();
    }

} 
```

产量

```
Exception in thread "main" java.io.NotSerializableException: Main$1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T17:39:38.510

好吧，“为什么”有点微妙。即使您的*命名*类 ( `CompareStringReverse`) 实现`Serializable`了，它也嵌套在一个没有实现的*匿名*类中。因此它是一个内部类，并且隐式引用了封闭匿名类的实例。例如，如果您运行：

```
javap -c Main$1$1CompareStringReverse 
```

您将看到该字段：

```
final Main$1 this$0; 
```

这就是无法序列化的原因。不过，您仍然可以轻松修复它：

```
interface SerializableCallable<T> extends Serializable, Callable<T> {}

...

static Comparator<String> COMPARE_STRING_LENGTH = 
    new SerializableCallable<Comparator<String>>() {
       ...
}; 
```

唯一显着的区别是匿名类现在`Serializable`实现`Callable<T>`. 我*认为*没有任何方法可以为要实现的匿名类指定多个接口（即，您必须创建额外的接口来组合两者），但我可能是错的。

所以现在命名的内部类实现`Serializable`了，它的唯一字段的类型也是如此，所以一切正常。

# ios - 使用 IBAction 按钮缩放 MapView

> ID：15177400
> 
> 赞同：7
> 
> 时间：2013-03-02T17:34:06.717
> 
> 标签：ios, ios6, mkmapview, zooming, ibaction

我有一个问题。我的当前位置在地图视图中显示并居中，但地图区域不会放大。我尝试通过从 didUpdateToLocation 方法中取出 span 和 region 来采纳 Rob 的建议，但我一定没有正确实施它。我认为它没有识别我在 viewDidLoad 中对 setRegion 的调用，并且我的按钮没有被识别。请检查我下面的代码并指出错误。我的目标是能够使用 IBAction 按钮放大和缩小我的位置。

。H

```
- (IBAction)zoomIn:(id)sender;

- (IBAction)zoomOut:(id)sender; 
```

.m 在 vi​​ewDidLoad

```
double miles = 0.5;

MKCoordinateSpan span;
span.latitudeDelta = miles/69.0;
span.longitudeDelta = miles/69.0;

MKCoordinateRegion region;
region.span = span;

[self.mapView setRegion:region animated:YES];

[self.mapView setUserTrackingMode:MKUserTrackingModeFollow animated:YES];

_mapView.mapType = MKMapTypeSatellite; 
```

.m 在我的 didUpdateToLocation 方法中。

```
[self.mapView setCenterCoordinate:newLocation.coordinate animated:YES]; 
```

。放大：

```
- (IBAction)zoomIn:(id)sender 
{
    MKCoordinateSpan span;
    span.latitudeDelta = _mapView.region.span.latitudeDelta * 2;
    span.longitudeDelta = _mapView.region.span.latitudeDelta * 2;
    MKCoordinateRegion region;
    region.span = span;
    region.center = _mapView.region.center;

    [self.mapView setRegion:region animated:YES];
} 
```

。缩小 ：

```
- (IBAction)zoomOut:(id)sender
{
     MKCoordinateSpan span;
     span.latitudeDelta = _mapView.region.span.latitudeDelta / 2;
     span.longitudeDelta = _mapView.region.span.latitudeDelta / 2;
     MKCoordinateRegion region;
     region.span = span;
     region.center = _mapView.region.center;

     [self.mapView setRegion:region animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-02T19:28:51.960

您可以根据需要获取当前值`region`、乘以或除以`span`2（放大时除，缩小时乘以），然后设置`region`：

```
- (IBAction)zoomIn:(id)sender {
    MKCoordinateRegion region = self.mapView.region;
    region.span.latitudeDelta /= 2.0;
    region.span.longitudeDelta /= 2.0;
    [self.mapView setRegion:region animated:YES];
}

- (IBAction)zoomOut:(id)sender {
    MKCoordinateRegion region = self.mapView.region;
    region.span.latitudeDelta  = MIN(region.span.latitudeDelta  * 2.0, 180.0);
    region.span.longitudeDelta = MIN(region.span.longitudeDelta * 2.0, 180.0);
    [self.mapView setRegion:region animated:YES];
} 
```

* * *

如果您想让地图自动缩放到您的位置，您可以使用：

```
self.mapView.userTrackingMode = MKUserTrackingModeFollow; 
```

如果您想手动执行此操作，您可以执行以下操作。首先，为您是否已经放大定义一个类属性：

```
@property (nonatomic) BOOL alreadySetZoomScale; 
```

然后改变你的`didUpdateLocations`（或`didUpdateToLocation`）来检查这个并设置一次缩放比例：

```
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations
{
    CLLocation* newLocation = [locations lastObject]; // if less than zero, then valid lat and long not found

    if (newLocation.horizontalAccuracy < 0)
        return;

    if (!self.alreadySetZoomScale)
    {
        MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(newLocation.coordinate, 1609, 1609); // 1 mile = 1609.34 meters
        self.mapView.region = region;
        [self.mapView setRegion:region animated:YES];
        self.alreadySetZoomScale = YES;
    }
    else
    {
        [self.mapView setCenterCoordinate:newLocation.coordinate animated:YES];
    }
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    // if prior to iOS 6, use this old `MKMapViewDelegate` method, but call our
    // other routine.

    if (SYSTEM_VERSION_LESS_THAN(@"6.0"))
        [self locationManager:manager didUpdateLocations:@[newLocation]];
} 
```

这基本上是说，“如果我还没有放大，请根据`newLocation`该位置周围的米数和一定数量的米设置区域，但如果我已经这样做了，只需根据我当前的位置设置中心坐标，但不要更改缩放比例（以防我已经放大或缩小）。这也会执行一些条件 iOS 版本号逻辑（使用[此处显示的宏](https://stackoverflow.com/a/5337804/1271826)），确保最终用户是否运行 6.0 之前的 iOS，它将调用我们更新的方法。

顺便说一句，如果您在地图上显示用户位置（例如`self.mapView.showsUserLocation = YES;`），您可能希望在移动地图中心之前`didUpdateLocations`也删除与 关联的叠加层`MKUserLocation`，否则它可能会留下旧的叠加层：

```
[self.mapView removeOverlays:self.mapView.overlays]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:13:51.360

试试这个。但我还没有测试。

```
- (IBAction)zoomIn:(id)sender {
      MKCoordinateSpan span;
      span.latitudeDelta = _mapView.region.span.latitudeDelta * 2;
      span.longitudeDelta = _mapView.region.span.latitudeDelta * 2;
      MKCoordinateRegion region;
      region.span = span;
      region.center = _mapView.region.center;

     [self.mapView setRegion:region animated:YES];
 }

 - (IBAction)zoomOut:(id)sender {
      MKCoordinateSpan span;
      span.latitudeDelta = _mapView.region.span.latitudeDelta / 2;
      span.longitudeDelta = _mapView.region.span.latitudeDelta / 2;
      MKCoordinateRegion region;
      region.span = span;
      region.center = _mapView.region.center;

     [self.mapView setRegion:region animated:YES];

 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T00:51:51.053

好的，这就是我最终用来让我的 2 个 IBAction 按钮（zoomIn 和 zoomOut）与我的 mapView 一起工作的方法。当您打开应用程序时，会显示用户位置，并且地图会放大并以它为中心。然后，您可以使用按钮放大或缩小 2 倍。*非常感谢 Rob 为我指明了方向。

。H

```
- (IBAction)zoomIn:(id)sender;

- (IBAction)zoomOut:(id)sender; 
```

.m

```
@interface LocationViewController ()

@property (nonatomic) BOOL alreadySetZoomScale;

@end

-(void)locationManager:(CLLocationManager *)manager
didUpdateToLocation:(CLLocation *)newLocation
      fromLocation:(CLLocation *)oldLocation {

if (!_alreadySetZoomScale)
{
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(newLocation.coordinate,    1609, 1609); // 1 mile = 1609.34 meters

self.mapView.region = region;
[self.mapView setRegion:region animated:YES];
_alreadySetZoomScale = YES;

}

else

{
[self.mapView setCenterCoordinate:newLocation.coordinate animated:YES];
}

- (IBAction)zoomIn:(id)sender {

MKCoordinateRegion region = self.mapView.region;
region.span.latitudeDelta /= 2.0;
region.span.longitudeDelta /= 2.0;
self.mapView.region = region;

}

- (IBAction)zoomOut:(id)sender {;

MKCoordinateRegion region = self.mapView.region;
region.span.latitudeDelta *= 2.0;
region.span.longitudeDelta *= 2.0;
self.mapView.region = region;

} 
```

我还有其他几个对 MKMapView 的调用，例如 self.mapView.showsUserLocation = YES; 在 viewDidLoad 中，但仅此而已。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-29T11:03:23.903

**斯威夫特 2.0：**

使用扩展：

```
extension MKMapView{

 func zoomInPinAnnotationLocation(targetMapViewName : MKMapView?, delta: Double)
 {
  var region: MKCoordinateRegion = targetMapViewName!.region
  region.span.latitudeDelta /= delta
  region.span.longitudeDelta /= delta
  targetMapViewName!.region = region

 }
 func zoomOutPinAnnotationLocation(targetMapViewName : MKMapView?,delta: Double)
 {
  var region: MKCoordinateRegion = targetMapViewName!.region
  region.span.latitudeDelta *= delta
  region.span.longitudeDelta *= delta
  targetMapViewName!.region = region
 }

} 
```

用法：

```
var mapViewZoomStepperValue: Double = -1.0
@IBOutlet weak var mapViewZoomStepper: UIStepper!

@IBAction func mapViewZoomStepperValueChanged(sender: AnyObject) {

  if (mapViewZoomStepper.value  > mapViewZoomStepperValue)
  {
   mapViewZoomStepperValue = mapViewZoomStepperValue + 1.0

//Zoom In
   detailMapView.zoomInPinAnnotationLocation(detailMapView, delta: 3.0)
  }
  else
  {
   mapViewZoomStepperValue = mapViewZoomStepper.value - 1.0

//Zoom Out
   detailMapView.zoomOutPinAnnotationLocation(detailMapView, delta: 3.0)
  }

 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-04T05:55:58.640

您可以在 3 行代码中实现最基本的

```
var region: MKCoordinateRegion = self.mapView.region
region = MKCoordinateRegionMake(self.mapView.centerCoordinate, MKCoordinateSpanMake(0.005, 0.005));
self.mapView.setRegion(region, animated: true) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-19T07:42:25.333

斯威夫特 3：

```
import GoogleMaps
import GooglePlaces
import CoreLocation
import UIKit

class LocationMapView: UIViewController, GMSMapViewDelegate, CLLocationManagerDelegate {

     @IBOutlet weak var mapView: GMSMapView!

     var mapViewZoomStepperValue: Float = 0.0
     @IBOutlet weak var mapViewZoomStepper: UIStepper!

     override func viewDidLoad() {
            super.viewDidLoad()

            mapViewZoomStepper.minimumValue = -100

        }

        @IBAction func mapViewZoomStepperValueChanged(_ sender: Any) {

            if (Float(mapViewZoomStepper.value) > mapViewZoomStepperValue){

                mapViewZoomStepperValue = Float(mapViewZoomStepper.value)
                zoomIn()

            }else{

                mapViewZoomStepperValue = Float(mapViewZoomStepper.value)
                zoomOut()

            }

        }

        func zoomIn() {

            print("Zoom in!!")
            if mapView.camera.zoom == mapView.maxZoom {
                return
            }

            let currentZoom = mapView.camera.zoom + 1
            mapViewZoomController(currentZoom)

        }

        func zoomOut() {

            print("Zoom out!!")
            if mapView.camera.zoom == mapView.minZoom {
                return
            }

            let currentZoom = mapView.camera.zoom - 1
            mapViewZoomController(currentZoom)

        }

        func mapViewZoomController(_ level: Float) {

            let point: CGPoint = mapView.center
            let coor: CLLocationCoordinate2D = mapView.projection.coordinate(for: point)
            let camera = GMSCameraPosition.camera(withLatitude: coor.latitude, longitude: coor.longitude, zoom: Float(level))
            mapView.animate(to: camera)

        }

} 
```

# java - SQL 查询模式和相对性能

> ID：15177402
> 
> 赞同：1
> 
> 时间：2013-03-02T17:34:28.063
> 
> 标签：java, sql, oracle, spring-batch, spring-jdbc

考虑一个主键作为列“id”的表

必须查询 id 范围为 [ 1, 2, 3, 4 ...]

有 2 个选项 -

1)

```
Select * from Table where id = 1;
Select * from Table where id = 2;
Select * from Table where id = 3;
Select * from Table where id = 4; 
```

2)

```
Select * from Table where id in ( 1, 2, 3, 4 ); 
```

两者中哪一个在 Oracle 作为数据库和使用 Spring JDBC 模板进行持久性方面的性能更好。假设数据集 1、2、3、4 将在 Java 数据结构的限制范围内，则从应用程序的角度抛开内存限制。

它使用数据库连接池。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T17:35:46.050

我宁愿使用第二个查询，因为它只查询数据库**一次**。除此之外，您也只能在数据库上连接**一次**。

请记住，数据库连接成本很高（*消耗大量资源*）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-03T09:06:19.330

为了备份 JW 和 a_horse_with_no_name 的语句，这里是一个测试，都使用相同的连接，因此这里忽略连接（池）问题。

首先使用主键创建表并为优化器收集统计信息：

```
SQL> create table mytable
  2  as
  3   select level id
  4        , lpad('*',1000,'*') filler
  5     from dual
  6  connect by level <= 10000
  7  /

Table created.

SQL> alter table mytable add constraint my_pk primary key (id)
  2  /

Table altered.

SQL> exec dbms_stats.gather_table_stats(user,'mytable')

PL/SQL procedure successfully completed. 
```

接下来，将所有语句放在共享池中，作为热身，切断大部分查询的输出：

```
SQL> select * from mytable where id = 1
  2  /

        ID
----------
FILLER
---------------------------------------------------------------------------------------------------------------------------------------
         1
***************************************************************************************************************************************
***************************************************************************************************************************************
***************************************************************************************************************************************
***************************************************************************************************************************************
***************************************************************************************************************************************
***************************************************************************************************************************************
***************************************************************************************************************************************
*******************************************************

1 row selected.

SQL> select * from mytable where id = 2
  2  /

1 row selected.

SQL> select * from mytable where id = 3
  2  /

1 row selected.

SQL> select * from mytable where id = 4
  2  /

1 row selected.

SQL> select * from mytable where id in (1,2,3,4)
  2  /    

4 rows selected. 
```

接下来，检查自动跟踪输出，以查看数据库必须执行的工作：

```
SQL> set autotrace traceonly
SQL> select * from mytable where id = 1
  2  /

1 row selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 3280897506

---------------------------------------------------------------------------------------
| Id  | Operation                   | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |         |     1 |  1005 |     2   (0)| 00:00:01 |
|   1 |  TABLE ACCESS BY INDEX ROWID| MYTABLE |     1 |  1005 |     2   (0)| 00:00:01 |
|*  2 |   INDEX UNIQUE SCAN         | MY_PK   |     1 |       |     1   (0)| 00:00:01 |
---------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("ID"=1)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
          3  consistent gets
          0  physical reads
          0  redo size
       1387  bytes sent via SQL*Net to client
        448  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          1  rows processed

SQL> select * from mytable where id = 2
  2  /

1 row selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 3280897506

---------------------------------------------------------------------------------------
| Id  | Operation                   | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |         |     1 |  1005 |     2   (0)| 00:00:01 |
|   1 |  TABLE ACCESS BY INDEX ROWID| MYTABLE |     1 |  1005 |     2   (0)| 00:00:01 |
|*  2 |   INDEX UNIQUE SCAN         | MY_PK   |     1 |       |     1   (0)| 00:00:01 |
---------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("ID"=2)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
          3  consistent gets
          0  physical reads
          0  redo size
       1387  bytes sent via SQL*Net to client
        448  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          1  rows processed

SQL> select * from mytable where id = 3
  2  /

1 row selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 3280897506

---------------------------------------------------------------------------------------
| Id  | Operation                   | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |         |     1 |  1005 |     2   (0)| 00:00:01 |
|   1 |  TABLE ACCESS BY INDEX ROWID| MYTABLE |     1 |  1005 |     2   (0)| 00:00:01 |
|*  2 |   INDEX UNIQUE SCAN         | MY_PK   |     1 |       |     1   (0)| 00:00:01 |
---------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("ID"=3)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
          3  consistent gets
          0  physical reads
          0  redo size
       1387  bytes sent via SQL*Net to client
        448  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          1  rows processed

SQL> select * from mytable where id = 4
  2  /

1 row selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 3280897506

---------------------------------------------------------------------------------------
| Id  | Operation                   | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT            |         |     1 |  1005 |     2   (0)| 00:00:01 |
|   1 |  TABLE ACCESS BY INDEX ROWID| MYTABLE |     1 |  1005 |     2   (0)| 00:00:01 |
|*  2 |   INDEX UNIQUE SCAN         | MY_PK   |     1 |       |     1   (0)| 00:00:01 |
---------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   2 - access("ID"=4)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
          3  consistent gets
          0  physical reads
          0  redo size
       1387  bytes sent via SQL*Net to client
        448  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          1  rows processed

SQL> select * from mytable where id in (1,2,3,4)
  2  /

4 rows selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 1637292604

----------------------------------------------------------------------------------------
| Id  | Operation                    | Name    | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT             |         |     4 |  4020 |     4   (0)| 00:00:01 |
|   1 |  INLIST ITERATOR             |         |       |       |            |          |
|   2 |   TABLE ACCESS BY INDEX ROWID| MYTABLE |     4 |  4020 |     4   (0)| 00:00:01 |
|*  3 |    INDEX UNIQUE SCAN         | MY_PK   |     4 |       |     3   (0)| 00:00:01 |
----------------------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   3 - access("ID"=1 OR "ID"=2 OR "ID"=3 OR "ID"=4)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
          8  consistent gets
          0  physical reads
          0  redo size
       2435  bytes sent via SQL*Net to client
        448  bytes received via SQL*Net from client
          2  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
          4  rows processed

SQL> set autotrace off 
```

四次 3 一致得到对 8 一致得到。最后，让我们通过执行所有语句 10,000 次来为这两种变体计时：

```
SQL> set timing on
SQL> declare
  2    v_id     number;
  3    v_filler varchar2(1000);
  4  begin
  5    for i in 1 .. 10000
  6    loop
  7      select *
  8        into v_id, v_filler
  9        from mytable
 10       where id = 1
 11      ;
 12      select *
 13        into v_id, v_filler
 14        from mytable
 15       where id = 2
 16      ;
 17      select *
 18        into v_id, v_filler
 19        from mytable
 20       where id = 3
 21      ;
 22      select *
 23        into v_id, v_filler
 24        from mytable
 25       where id = 4
 26      ;
 27    end loop;
 28  end;
 29  /

PL/SQL procedure successfully completed.

Elapsed: 00:00:01.03
SQL> /

PL/SQL procedure successfully completed.

Elapsed: 00:00:01.00
SQL> /

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.99
SQL> declare
  2    v_id     number;
  3    v_filler varchar2(1000);
  4  begin
  5    for i in 1 .. 10000
  6    loop
  7      for r in (select * from mytable where id in (1,2,3,4))
  8      loop
  9        v_id := r.id;
 10        v_filler := r.filler;
 11      end loop;
 12    end loop;
 13  end;
 14  /

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.41
SQL> /

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.39
SQL> /

PL/SQL procedure successfully completed.

Elapsed: 00:00:00.39
SQL> set timing off 
```

在这里，您可以看到向数据库发送四倍多的语句的开销最多。根据索引深度和聚类因子，这里和那里可能存在一些变化，但一个查询与四个查询仍然是最大的区别。

所以，希望这个线程的读者不会再说“已知 IN 子句很昂贵”:-)

问候，
罗布。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T22:44:59.423

我认为这个问题是过早优化的一个很好的例子，为什么应该避免它。

您正在尝试从表中获取多个 ID 的行。要使用的明显查询应该是以最简单的方式满足要求的查询。除非有很好的理由，否则我总是会考虑使用：

```
Select * from Table where id in ( 1, 2, 3, 4 ); 
```

这使后来的开发人员清楚地知道发生了什么以及为什么。它还将优化任务留给数据库来处理，这就是它的用途。

如果在编写此代码后您发现存在性能问题*，那么*是时候考虑优化了。

对于任何类型的代码问题，最简单的解决方案通常是最好的。

我确实意识到我在这里有点离题并且没有很多知识 JDBC 但确实有很多 Oracle 知识

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-02T18:04:26.187

我将假设您正在使用 PreparedStatment

```
select * from TABLE where ID=?; 
```

在 Oracle 中，使用 PreparedStatement 将允许 Oracle 缓存 SQL 的执行计划生成。因此传递 1 或 2 或 1000 的 ID 将使用相同的缓存 Oracle 计划。

甲骨文将对待

```
select * from TABLE where ID in (1, 2, 3); 
```

和

```
select * from TABLE where ID in (4, 8, 15, 16, 23, 42); 
```

作为两个不同的查询并为两者生成不同的执行计划。因此，从 Oracle 的角度来看，类型 1 更可取。

实际上，如果您在 ID 上放置索引，您将不会注意到两种样式之间的实质性差异。

与性能调优一样，“不要猜测，做测试”。使用 YourKit 甚至 System.currentTimeMillis() 来查看真实世界的数字。也不要为了微不足道的性能提升而牺牲代码清晰度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-03T09:52:59.617

您可能有一个选项3...

我的问题是您是如何获得这些 ID 值的？

我发现必须使用一组唯一标识符查询表的模式，这是一种奇怪的模式。

您更有可能在其他列上有 (a) 谓词，这些列标识您要检索的完全相同的行集。

# ruby-on-rails-3 - 急切加载多个关联

> ID：15177403
> 
> 赞同：0
> 
> 时间：2013-03-02T17:34:31.833
> 
> 标签：ruby-on-rails-3, activerecord, ruby-on-rails-3.2

我有三个相关的对象：

```
class Site < ActiveRecord::Base
    belongs_to :program
end

class Program < ActiveRecord::Base
    belongs_to :user
    has_many :sites
end

class User < ActiveRecord::Base
    has_many :programs
end 
```

在我`Sites index`看来，当循环浏览我的所有网站时，我想显示`Edit`和`Destroy`按钮，但前提是`current_user`拥有该网站：

```
- if current_user == site.program.user || current_user.try(:admin?)
  = icon_link_to "edit", 'Edit', edit_program_site_path(site.program, site), :class => "btn btn-primary"
  = icon_link_to "trash", "Delete", site, confirm: 'Are you sure?', method: :delete, class: 'btn btn-danger' 
```

此代码失败，因为程序和用户对象为零。

我知道在我的控制器中我需要以下内容：

```
@sites = Site.includes(:programs).all 
```

`site.program`这将解决访问`user`.

如果当前模式被认为不正确，则模型更改是可以接受的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T14:01:20.397

利用，

```
Site.joins(:program).where('programs.user_id=?', current_user.id).includes(:programs).all 
```

# python - 同时定义三个相关变量

> ID：15177404
> 
> 赞同：0
> 
> 时间：2013-03-02T17:34:39.263
> 
> 标签：python, variables

本质上，我需要从面积和深度（显然）中得出一个体积。我是初学者，所以不知道在这里做什么。

所以我的问题是：

```
depth = volume / area

volume = area * depth

area = volume / depth 
```

我怎样才能同时定义每一个，这样我就不会收到“未定义”的消息？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T17:37:03.377

> 我需要从面积和深度推导出体积

面积和深度是*输入，*所以不要根据其他两个变量来定义它们。

```
def calculate_volume(area, depth):
    return area*depth 
```

# jquery - ajaxForm formData 摆脱 Textarea 中的换行符

> ID：15177405
> 
> 赞同：1
> 
> 时间：2013-03-02T17:34:52.403
> 
> 标签：jquery, ajaxform

我正在使用 ajaxForm 发送我的表单。我想清除我想要使用的（换行符）的数据 .replace();

1-如何对 (beforeSubmit:) 的所有 formData 运行替换？2-什么 replace() 选项对“获得 Textarea 的换行符”有好处？

# python - 用于保存时间值的 OpenERP 字段，例如 `08:04`

> ID：15177406
> 
> 赞同：1
> 
> 时间：2013-03-02T17:35:01.320
> 
> 标签：python, datetime, field, openerp

我正在使用一个模块 openerRP

我正在寻找一种解决方案来声明一个字段，我可以在其中添加这样的时间：`08:04`。

我找到了这种类型`datetime`，但这不是我需要的。

```
fields.datetime 
```

它不起作用

因为我不需要日期，我只需要时间。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T09:54:42.057

## 使用`float_time`小部件

我不确定您是否真的需要存储*time*或*duration*。如果要存储持续时间，最简单的方法可能是将 a`fields.float`与`float_time`小部件结合使用。这是 OpenERP 默认使用的存储任务持续时间的方法。

这将以小时为单位的值作为浮点数存储在数据库中，但允许用户使用熟悉的 HH:MM 格式查看和输入值。所以如果用户输入`8:30`的值将存储在数据库中`8.5`。具有持续时间的浮点值可以很容易地计算跨许多记录的总和或平均持续时间。

例如，您的 OpenERP 模型可能具有以下内容：

```
_columns: {
    'duration': fields.float('Duration (in hours)'),
} 
```

相应的视图将包含：

```
<field name="duration" widget="float_time"/> 
```

[您可以在模型](http://bazaar.launchpad.net/~openerp/openobject-addons/7.0/view/8790/project/project.py#L759)和[视图](http://bazaar.launchpad.net/~openerp/openobject-addons/7.0/view/8790/project/project_view.xml#L141)级别的官方`project`模块中看到类似的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T05:49:55.037

你可以试试 `fields.time`。我不知道 openerp 仍然有这个领域。

# c++ - 我想存储从文件中获取的数字及其计数

> ID：15177410
> 
> 赞同：2
> 
> 时间：2013-03-02T17:35:10.287
> 
> 标签：c++, file, stl

我的文件内容是：

```
1,2,5
2,4
2,3
1,2,4
1,3
2,3 
1,3 
1,2,3,5
1,2,3 
```

我的代码是：

```
#include<iostream>
#include<set>
#include<vector>
#include<fstream>
#include<sstream>
#include<set>
#include<cstdlib>
#include<algorithm>
using namespace std;
struct store {
    string a;
    int count;
};
int main() {
    store ap[100];
    vector<string> v;
    set<string> input;
    int mycount;
    ifstream fin("trans.txt");
    string line, s, str1, token;
    while(!fin.eof()) {
        fin >> line;
        //  cout<<"i cant understand but correct"<<line<<endl;
        istringstream str1(line);
        while(getline(str1, token, ',')) {
            //cout<<"the token are\t"<<token<<endl;
            v.push_back(token);
            input.insert(token);
        }
        //v.push_back(token);
        //input.insert(token);
        int i = 0;
        for(set<string>::iterator it = input.begin(); it != input.end(); it++) {
            mycount = count(v.begin(), v.end(), *it);
            s = *it;
            ap[i].a = s;
            ap[i].count = mycount;
            cout << ap[i].a << "\t" << "mycount" << ap[i].a << endl;
            i++;
        }
    }
} 
```

我正在实现 Apriori 算法，每行代表事务，即存储在文件中的项目我的文件由这样的数字组成，如何存储每个数字的出现及其计数

我的输出应该是这样的：

```
 1 6
 2 7
 3 7
 4 2
 5 2 
```

但是我无法单独存储我的意思是 1 及其所有出现 2 及其所有出现等等等。

谁能告诉我如何像上面的例子一样存储

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:17:39.010

如果您正在阅读的数字在一个很小的范围内（例如 0-10，甚至 0-200 等），而不是使用 [ `std::map`( [http://en.cppreference.com/w/cpp/container/map](http://en.cppreference.com/w/cpp/container/map) ) ，你可以使用一个**简单的数组**。Map 的键是数组索引，map 的值（即出现次数）是该索引的数组值。例如，数字 3 的出现存储在索引 3 处的整数数组中。

有关详细信息，请参阅以下注释代码。

我用 VS2010 SP1 (VC10) 编译了该代码并执行了它，它似乎工作正常（至少对于您的输入文件示例数据）。

```
#include <cstdlib>
#include <exception>
#include <fstream>
#include <iostream>
#include <sstream>
#include <stdexcept>
#include <string>

using namespace std;

int main() 
{
    static const int kExitOk = 0;
    static const int kExitError = 1;

    try
    {
        // Open text file for reading
        ifstream inFile("data.txt");

        // Occurrence table
        static const int kMaxNum = 10;
        int occurrences[kMaxNum + 1] = {0}; // init to 0s

        // Line read from file       
        string line;

        // For each line in file
        while (getline(inFile, line))
        {
            // Process each line content using string streams
            istringstream iss(line);

            // Read numbers (separated by comma) from current line
            string token;
            while (getline(iss, token, ','))
            {
                // Convert from string to integer
                const int num = atoi(token.c_str());

                // Just do a bounds checking for safety...
                if (num < 0 || num > kMaxNum)
                    throw runtime_error("Bad input number found in file.");

                // Update occurrence of given number    
                occurrences[num]++;
            }
        }

        // Print occurrences
        for (int i = 0; i <= kMaxNum; i++)
        {
            if ( occurrences[i] != 0 )
            {
                cout << i << ' ' << occurrences[i] << '\n';
            }
        }

        return kExitOk;
    }
    catch(const exception& e)
    {
        cerr << "\n*** ERROR: " << e.what() << endl;
        return kExitError;
    }        
} 
```

如果要使用 a `std::map`，只需添加`#include <map>`，并将数组定义替换为：

```
// Occurrence table
map<int, int> occurrences; 
```

您可以使用如下代码打印地图内容：

```
// Print occurrences
for (auto it = occurrences.begin(); it != occurrences.end(); ++it)
{
    cout << it->first << ' ' << it->second << '\n';
} 
```

请注意，使用`std::map`出现更新代码在形式上与数组案例相同：

```
// Update occurrence of given number    
occurrences[num]++; // works also for std::map 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T18:30:22.350

我将从一个 ctype_facet 开始，它将除数字（和可选`-`）之外的所有内容分类为“空白”，因此在您读取数据时将完全跳过它：

```
struct number_only: std::ctype<char> { 
    number_only() : std::ctype<char>(get_table()) {} 

    static mask const *get_table() { 
        static std::vector<mask> rc(table_size, space);

        std::fill_n(&rc['0'], 10, digit);
        rc['-'] = punct;
        return &rc[0]; 
    } 
}; 
```

这样，读取数据就变得更加直接——我们不需要做任何事情来忽略逗号，因为从流中提取一个 int 会自动为我们做这件事。一旦我们读取它们，我们只需在地图中增加它们的计数，然后打印出地图：

```
typedef std::pair<int, int> count;

std::ostream &operator<<(std::ostream &os, count const &p) {
    return os << p.first << "\t" << p.second;
}

int main() { 
    std::map<int, int> numbers;

    int temp;

    std::cin.imbue(locale(local(), new number_only);

    while (std::cin >> temp)
       ++numbers[temp];

    std::copy(numbers.begin(), numbers.end(), 
              std::ostream_iterator<count>(std::cout, "\n"));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T17:50:08.497

您应该考虑使用映射，其中键是数字，值是计数。

[http://www.cplusplus.com/reference/map/map/](http://www.cplusplus.com/reference/map/map/)

它基本上可以让你做类似的事情。我知道这不是有效的 C++ :) 但它应该让您了解我的意思。

```
std::map<int, int> numbers;

for (read number from file) {
    numbers[number from file] = numbers[number from file] + 1;
} 
```

# c - sizeof(&array) 返回什么？

> ID：15177420
> 
> 赞同：33
> 
> 时间：2013-03-02T17:36:34.607
> 
> 标签：c, string, pointers, sizeof

跟随问题：[为什么数组的地址等于它在 C 中的值？](https://stackoverflow.com/questions/2528318/how-come-an-arrays-address-is-equal-to-its-value-in-c)

```
#include <stdio.h>
#define N 10    
char str2[N]={"Hello"};
int main(){
    printf("sizeof(str2): %d bytes\n", sizeof(str2));
    printf("sizeof(&str2): %d bytes\n", sizeof(&str2));
    return 0;
} 
```

输出：

```
sizeof(str2): 10 bytes
sizeof(&str2): 4 bytes 
```

我知道`str2`仅是数组中第一个元素的地址`str2`。而 when`str2`是它的一个参数，`sizeof`它返回整个数组 str2 的大小。

此外，`&str2`也是 arr 中第一个元素的地址，`str2`但类型不同（`char (*)[N]`== 指向数组的指针）。但是`&str2`当它是 的参数时表现如何`sizeof`？

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2013-03-02T17:45:56.630

## `&str`和之间的区别`str`，何时`str`声明为`char str[10]`？

读取 [`sizeof`](http://c0x.coding-guidelines.com/6.5.3.4.html)运算符：

> **6.5.3.4 sizeof 运算符，1125：**
> 将`sizeof`运算符应用于数组类型时，结果是数组中的总字节数。

因此，根据您的声明，`sizeof(str2)`给出的完整数组大小为 10 个字节（因为 N 定义为 10，而 char 大小为 1 个字节）。
而在表达式`sizeof(&str2)`中，`&str2`是一个数组的地址，并且该地址的大小在您的系统上是 4 个字节。（在某些系统中，地址大小可能为 8 个字节，例如 64 位）。

> 另外，`&str2`也是 arr 中第一个元素的地址`str2`吗？

**不**，在价值方面两者 `&str2`和`str`是相同的，但在**语义上两者是不同的**。一个是 10 个字符的数组的地址，而另一个是一个字符的地址。

**您在自己的示例中看到它们之间的一个**区别是（@ouah 在答案中对此进行了解释）。

*   类型`str`是`char[10]`
*   类型`&str`是`char(*)[10]`

**第二：** 按照图表将帮助您观察其他差异。

```
for declaration: 
#define N 10
char str2[N] = {"Hello"};

str2 Array in memory is something like:
----------------------------------------

str
+----+----+----+----+----+----+----+----+----+----++----+
|'H' |'e' |'l' |'l' |'o' |'\0'|'\0'|'\0'|'\0'|'\0'|| '@'|
+----+----+----+----+----+----+----+----+----+----++----+
 201   202  203 204  205   206  207  208  209  210   211
▲ ▲     ▲                                             ▲
| |     |                                             |
|(str2) (str2 + 1)                                    | 
|                                                     |
|-----------------------------------------------------|
|201                                                  | 
|                                                     |
|                                                     |
(&str2) = 201                           (&str2 + 1) = 211

* assuming str address start from 201
* str[N] is 10 char long 201-210, partially initialized
* at uninitialized position, str2[i] = '\0'
* location 211 is unallocated, having garbage value,
  access to this location is illegal-Undefined Behavior 
```

对于上图，您可以编写如下代码：

```
#include <stdio.h>
#define N 10    
int main(){
   char str2[N]={"Hello"};

   printf("\n %p, %p\n",str2, str2+1);
   printf("\n %p, %p\n",(&str2), (&str2+1));
} 
```

输出：

```
 0xbf67e142, 0xbf67e143

 0xbf67e142, 0xbf67e14c 
```

[键盘链接](http://codepad.org/CoA38yfG)：

请注意，在第一行，输出地址相差一个字节，但在第二行，相差 10 个字节，因为它是*数组的*指针（如上图所示）。

根据指针算术规则，当你给一个指针变量加 1 时，它就开始指向它自己类型的下一个元素。这就是 10 字节差异的原因，因为`&str2`是指向数组的地址。

**第三个**区别：

通过这样做`*str2`，您可以访问第一个元素。而不`*(&str2)`会给你第一个元素，相反，它会给出第一个元素的地址。

一个例子在这里会有所帮助：

```
#include <stdio.h>
#define N 10    
int main(){
   char str2[N]={"Hello"};
   printf("\n%p %c, %p %c\n",str2, *(str2), *(&str2), **(&str2));
} 
```

输出：

```
0xbf587046 H, 0xbf587046 H 
```

[键盘链接](http://codepad.org/NVkigDFh)

在输出

```
str2 gives  0xbf587046 
*(str2)     H 
*(&str2)    0xbf587046 
**(&str2)   H 
```

这意味着`*(&str2) == str2`和价值是地址。因此`*(str2) = **(&str2)`值为`H`。

**编辑：**上面我显示了 type 数组之间的 区别`&str`和`str`where 。`str``char[10]`

## `char *str`两者之间以及`char str[]`如何存储在内存中的区别

假设我们有两个如下声明：

```
char *str1 = "hello";   
char str2[] = "hello"; 
```

在上面的声明`str1`中是一个指向 的指针`char`，它指向一个常量字符串文字（通过保存字符串中第一个字符`h`的地址`"hello"`）。

C 中的字符串属于`char[N]`(array) 类型，这就是为什么`sizeof("hello")`给出 6 的原因，因为`"hello"`字符串是 6 个字符长的数组（包括`\0`nul、字符串终止、hello 的类型`char[6]`）。

在内存中，您的`"hello"`字符串存储如下：

```
 str1         23   24   25   26   27   28
+----+      +----+----+----+----+----+----+
| 23 |      | h  | e  |  l | l  | o  | \0 |    
+----+      +----+----+----+----+----+----+
   +-----------▲

here the address of the hello string is the first address = 23\.  
str1: is a pointer capable of storing an address. 
"hello" consists of 6 chars 
```

`char* str1 = "hello";`基本上将字符串 hello 的地址存储到指针变量`str1`中，如上图所示。

注意：如果需要，您可以更改`str1`为指向其他字符串。但是你不能修改`hello`字符串。例如以下代码是有效的：

```
 char* str1 = "hello";  // str1 points to hello  str1-->"hello"
 str1 = "world";  //Now, str1 points to world  str1-->"world" 
```

现在`str1`指向其他常量字符串世界。

```
 str1         93   94   95   96   97   98 
+----+      +----+----+----+----+----+----+
| 93 |      | w  | o  |  r | l  | d  | \0 |    
+----+      +----+----+----+----+----+----+
   +-----------▲

here address of world string is first address = 93\.  
str1: value change to point string world. 
```

需要注意的重要一点：`str1`指向常量字符串，因此您不能通过访问/索引内存位置来修改字符串`str1[i] = 'A'`；将是非法的，因为您正在*只读内存上写入，*并且此行为在运行时未定义（尽管没有编译错误，因为在语法上它是正确的）。

同样，因为`str1`is 一个指针`sizeof(str1)`将在同一台机器上给出 4。

我的以下代码及其运行：

```
#include <stdio.h>
int main(){
   char* str1="Hello";
   printf("\nstr1: %s, address: %p, sizeof(str1): %u", str1, str1, sizeof(str1));
   str1 = "world";
   printf("\nstr1: %s, address: %p, sizeof(str1): %u", str1, str1, sizeof(str1));
   return 1;
} 
```

输出：

```
str1: Hello, address: 0x80485e8, sizeof(str1): 4
str1: world, address: 0x8048619, sizeof(str1): 4 
```

[键盘链接](http://codepad.org/8vYnoiAu)

因此，要分配一个新字符串，我只需分配一个新字符串的地址。但我不能称`strcpy()`它会尝试在只读内存位置上写入，这是非法的。

在第二个声明`char str2[] = "hello";`中，`str2[]`是一个`\0`终止的字符（或字符串）数组，但不是指针。注意，因为在这个声明中 size 没有给出*默认大小*，我们看到常量字符串“hello”的大小是 6。类型`str2`是`char[6]`。

当我们`char str2[] = "hello";`创建一个 char 数组时，hello 字符串将被复制到该数组中。所以`str2`不仅仅是一个指针，而是一个存储完整字符串的数组。

从概念上讲，它就像

```
 str2:
       103  104  105  106  107  108
      +----+----+----+----+----+----+
      | h  | e  |  l | l  | o  | \0 |    
      +----+----+----+----+----+----+ 
```

在这种情况下，最近在您的代码中您**不允许**这样做`str2[] = "world";`or `str2 = "world"`，这将是编译时错误。

示例代码：

```
#include<stdio.h>
int main(){
 char str2[] = "hello";
 str2[] = "world";
 str2 = "world"; 
 return 1; 
} 
```

编译错误：

```
In function 'main':
Line 4: error: expected expression before ']' token
Line 5: error: incompatible types in assignment 
```

[Codescape 链接](http://codepad.org/xbB11CmK)

如果这个数组`str2`不是一个常数，我们可以修改它的内容，例如做`str2[2] = 'A'`是完全有效的。我们也可以调用strcpy来改变内容（地址空间不会改变）

```
 strcpy(str2, "world");

       str2:
       103  104  105  106  107  108
      +----+----+----+----+----+----+
      | w  | o  |  r | l  | d  | \0 |    
      +----+----+----+----+----+----+

      Note that when "world" is copied into a same memory space, the addresses of both "world" and "hello"
      string are the same. 
```

代码示例：

```
#include<stdio.h>
int main(){
 char str2[] = "hello";
 printf("\nstr2: %s, address: %p, sizeof(str2): %u", str2, str2, sizeof(str2));
 str2[2] = 'A';
 printf("\nstr2: %s, address: %p, sizeof(str2): %u", str2, str2, sizeof(str2));
 strcpy(str2, "world");
 printf("\nstr2: %s, address: %p, sizeof(str2): %u", str2, str2, sizeof(str2));
 return 1; 
} 
```

**输出：**

```
str2: hello, address: 0xbf58d056, sizeof(str2): 6
str2: heAlo, address: 0xbf58d056, sizeof(str2): 6
str2: world, address: 0xbf58d056, sizeof(str2): 6 
```

[键盘链接](http://codepad.org/6ZI9NB1Q)

注意：相同地址空间上的字符串值不同。`sizeof(str2)`= 6 从较早的答案中可以完全理解，即数组的大小（以字节为单位）。

要阅读关于二维数组的类似描述，请阅读：[两者在内存中存储的](https://stackoverflow.com/questions/17564608/what-does-the-variable-name-mean-in-case-of-array-of-char-pointers/17661444#17661444)[区别`char* str[]`和方式？`char str[][]`](https://stackoverflow.com/questions/17564608/what-does-the-variable-name-mean-in-case-of-array-of-char-pointers/17661444#17661444)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-03-02T17:38:10.497

`&str2`是一个指针。所以你只是在你的平台上看到一个指针的大小。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-02T17:38:34.277

`str2`是类型`char [10]`（即，数组`10 of`char`）

`&str2`是类型`char (*)[10]`（即，指向 的数组`10`的指针`char`）。

所以`sizeof (&str2)` 产生指针类型的对象的大小`char (*)[10]`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-05-01T18:45:23.500

当您使用`arr`to do`+`时，它会衰减为指向第一个元素`-`的 const 指针。`char (* const) arr`虽然一些操作：`sizeof(arr)`和`&arr`，使用所有类型信息`char arr[10]`，包括大小，`10`。

# ruby-on-rails - 在rails中使用'build'命令时，在保存之前，我的zombie.weapons数组中有2个武器，但是zombie.weapons.count = 0

> ID：15177421
> 
> 赞同：2
> 
> 时间：2013-03-02T17:36:51.237
> 
> 标签：ruby-on-rails, ruby, arrays, rspec, model-associations

在 RSpec Testing for Zombies 中，我试图让这个测试通过

```
describe Zombie do
  it "starts off with two weapons" do
    z = Zombie.new(:name => "Ash")
    z.weapons.count.should == 2
  end
end 
```

为此，我使用了 after_initialize 模型回调来创建（“构建”）武器

```
class Zombie < ActiveRecord::Base
  after_initialize :grant_two_weapons

  def grant_two_weapons
     self.weapons.build(:name => "axe")
     self.weapons.build(:name => "stick")
  end
end 
```

现在测试没有通过，但还有一个问题，即标题中的问题。所以在 Rails 控制台中……</p>

```
z = Zombie.new
z.weapons
#=> [#<Weapon id: nil, name: "axe", zombie_id: nil, created_at: nil, updated_at: nil>, #<Weapon id: nil, name: "stick", zombie_id: nil, created_at: nil, updated_at: nil>] 
```

看起来我们得到了测试中描述的我们想要的东西，但是当我这样做时：

```
z.weapons.count
#=> 0 
```

因此测试失败。这个包含 2 个实体的数组如何计数为 0？这是一个围绕“构建”等的轨道问题，但它也是一个红宝石问题。该数组中有两个实体，但 ruby​​ 似乎在“撒谎”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:58:10.460

这就是工作方式`count`，它在数据库中执行 SQL 计数，但您的记录尚未保存，因此它为零。

`z.weapons.size`或者`z.weapons.length`会给你你所期望的。

例如：[http ://rhnh.net/2007/09/26/counting-activerecord-associations-count-size-or-length](http://rhnh.net/2007/09/26/counting-activerecord-associations-count-size-or-length)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:06:00.183

根据[这篇文章](https://stackoverflow.com/questions/4906704/how-to-use-after-initialize-in-rails-3)，有一些文档说明如果按照您的定义定义 after_initialize 将被忽略。

但是，发布者似乎观察到与该文档冲突的行为，因此 YMMV。（这可能取决于您使用的 Rails 版本，但这是推测。）

我希望我能给出一个更明确的答案，但希望这可以成为更熟悉 after_initialize 行为的人的跳板。

# eclipse - Eclipse 调试器停止在旧项目的等效位置，而不是新项目的实际断点位置

> ID：15177423
> 
> 赞同：1
> 
> 时间：2013-03-02T17:37:25.947
> 
> 标签：eclipse, debugging, jboss, jboss7.x, breakpoints

我在同一个工作区中有两个 Web 项目 A 和 B，它们的大多数包和类都是相似的。

（我将我的战争文件部署到 Jboss）。

我在项目 B 的某个类设置了一个断点。但是，当调试器（eclipse）在该断点处停止时，它会在项目 A 的等效类的相同位置（至少关于行号）执行它。

为什么会发生这种情况，我该如何避免这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:39:52.100

如果您在两个项目中具有相同的类名，JBoss 将加载并仅使用遇到的第一个

# types - 铸造类型和转换

> ID：15177425
> 
> 赞同：0
> 
> 时间：2013-03-02T17:37:56.593
> 
> 标签：types, casting, type-conversion

这两种方法有什么区别？它们都返回相同的类型，即`float`，但一个使用强制转换，另一个不使用。

```
public class Para1
{
    public float method1(int z)
    {
        return z;
    }

    public float method2(int z)
    {
        return (float) z;  
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:39:22.700

一种使用从`int`to`float`的隐式转换，另一种使用显式转换。在这种情况下，它相当于同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:41:36.173

第一个函数将*int*类型隐式转换为*float类型。*第二个明确地做到了。有时需要显式强制转换，并且 Visual Studio 无法隐式转换复杂的类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T17:47:28.877

第一个函数执行从to的*隐式*类型转换。第二个是*明确*的。`int``float`

 *隐式类型转换由编译器完成，显式类型转换由程序员完成。

详见：[类型转换](http://en.wikipedia.org/wiki/Type_conversion)*

# objective-c - 在视图之间传递数据不起作用

> ID：15177433
> 
> 赞同：1
> 
> 时间：2013-03-02T17:38:43.320
> 
> 标签：objective-c, xcode, segue

我知道这个问题被问了大约 100 次，但我就是不知道我做错了什么。

这是我的第二个 iOS 应用。我想通过按下 ViewControllerA 中的按钮来修改 ViewControllerB 中的标签。

1.  我在 Storyboard 中从我的 Button ( `ViewControllerA`) 到 my制作了一个 Segue，`ViewControllerB`并将其命名为“TestSegue”。
2.  写`#import "ViewControllerB.h`在我的`ViewControllerA.h`
3.  我在 ViewControllerA.m 中编写了这段代码：

`-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{`

 ````
if([segue.identifier isEqualToString:@"TestSegue"]){

ViewControllerB *controller = (ViewControllerB *)segue.destinationViewController;
controller.TestLabel.text = @"TEST!";}} 
```

In my ViewControllerB nothing happens with the TestLabel...

Can anybody see what I did wrong?

Thanks in advance

Edit: Works now thanks to rpledge.

New Code:` 

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

if([segue.identifier isEqualToString:@"TestSegue"]){

ViewControllerB *controller = (ViewControllerB *)segue.destinationViewController;
controller.TestString = @"TEST!";}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:46:05.417

这可能是因为在运行 viewDidLoad 之前不会创建 TextLabel UI 元素，这将在 prepareForSegue 之后发生：

无论如何，我不喜欢公开公开视图的 UI 元素，我建议您将 NSString* 的 @property 添加到目标视图控制器，然后在 viewDidLoad 中设置 UILabel.text：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:48:36.570

不要将它分配给控件，而是分配给实例变量。

```
@property (nonatomic) NSString *var; 
```

然后在 viewDidLoad 中将其分配给控件。

# asp.net - 用户单击或输入文本框时显示范围并在 asp.net 中验证

> ID：15177434
> 
> 赞同：1
> 
> 时间：2013-03-02T17:38:50.580
> 
> 标签：asp.net, ajax, web-applications

当用户进入文本框或单击它并在用户在 asp.net 中输入非范围值时如何验证它时，如何显示带有文本框范围的弹出窗口？目前我正在使用 js 和 css 使用 z-index 显示面板，但没有验证。有没有更好的办法？

我尝试了 Ajax Validator 控件，但似乎它们仅在用户离开文本框时才会弹出。而且，文本框是动态创建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:46:22.853

如果文本框的范围是固定的，则只能使用 javascript。如果您需要验证动态内容，则必须使用 ajax 调用 Web 方法或 Web 服务。标记将是这样的

```
<asp:ScriptManager ID="ScriptManager1" runat="server" 
  EnablePageMethods="true" />
<script language="javascript">
 function UpdateTime() {
   PageMethods.GetCurrentDate(OnSucceeded, OnFailed); 
 }

 function OnSucceeded(result, userContext, methodName) {
   $get('Label1').innerHTML = result; 
 }

 function OnFailed(error, userContext, methodName) {
   $get('Label1').innerHTML = "An error occured.";
 }
</script>
<asp:Label runat="server" ID="Label1" Text="Update Me!" /><br />
<input type="button" id="Button2" value="Web Method Update" 
  onclick="UpdateTime();" /> 
```

您必须启用脚本管理器的页面方法，并将页面中编写的方法调用为 PageMethods.YourMethodName(JavascriptMethodIfCallingSuccess,JavascriptMethodOnError); 您可以在 c# 中编写页面返回代码，如下所示

```
[WebMethod]
public static string GetCurrentDate()
{
  return DateTime.Now.ToLongDateString();
} 
```

现在您将在您的 javascript 中从服务器获取返回值。如果您的验证始终是固定的并且不需要服务器端验证，请不要使用此方法。它可能会导致您的页面和服务器出现不必要的负载。

# css - IE 不呈现某些 div

> ID：15177437
> 
> 赞同：0
> 
> 时间：2013-03-02T17:39:08.153
> 
> 标签：css, internet-explorer, html

另一个原因 IE，像往常一样，它是唯一无法正确显示我的网站的浏览器。我有一个 div 网格，每个都有背景图像，因此它们会缩放以适应 div 的大小。但是在 IE 中，这些 div 根本没有显示出来，我看不到代码中可能导致这种情况的任何问题，任何建议将不胜感激：

HTML

```
<div id="main-grid">

<div class="grid-block" style="background-image: url(IMAGE-URL-HERE)"></div>
<div class="grid-block" style="background-image: url(IMAGE-URL-HERE)"></div>
<div class="grid-block" style="background-image: url(IMAGE-URL-HERE)"></div>
<div class="grid-block" style="background-image: url(IMAGE-URL-HERE)"></div>

</div> 
```

CSS

```
#main-grid {
    width: auto;
    position: relative;
    margin: 0 auto;
    margin-top: 50px;
    text-align: center;
}

.grid-block {
    display: table;
    vertical-align: middle;
    width: 315px;
    height: 220px;
    margin-left: 3px;
    margin-right: 3px;
    margin-bottom: 9px;
    background: no-repeat 50% 50%;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
} 
```

我错过了一些完全明显的东西，但我似乎无法弄清楚为什么这些 div 没有出现在 IE 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:55:44.537

空`DIV`不在标准 HTML 中呈现。那可能是你的问题。我用你的案例测试了它，但`DIV`标签中有一些内容，一切都很好。

我的样本：

```
<!doctype html>
<html>
<head>
  <style>
    #main-grid {
        width: auto;
        position: relative;
        margin: 0 auto;
        margin-top: 50px;
        text-align: center;
    }

    .grid-block {
        display: table;
        vertical-align: middle;
        width: 315px;
        height: 220px;
        margin-left: 3px;
        margin-right: 3px;
        margin-bottom: 9px;
        background: no-repeat 50% 50%;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
    }
  </style>
</head>
<body>
  <div id="main-grid">

    <div class="grid-block" style="background-image: url(http://www.heise.de/icons/ho/heise_online_logo_top.gif)">a</div>
    <div class="grid-block" style="background-image: url(http://www.heise.de/icons/ho/heise_online_logo_top.gif)">b</div>
    <div class="grid-block" style="background-image: url(http://www.heise.de/icons/ho/heise_online_logo_top.gif)">c</div>
    <div class="grid-block" style="background-image: url(http://www.heise.de/icons/ho/heise_online_logo_top.gif)">d</div>

  </div>
<body>
</html> 
```

div 内的任何内容，例如空跨度都可以。

# javascript - 使用事件在视图设计模式之间进行通信

> ID：15177441
> 
> 赞同：5
> 
> 时间：2013-03-02T17:39:21.823
> 
> 标签：javascript, design-patterns, backbone.js, eventaggregator, event-driven-design

当您有一个引用另一个视图并侦听其事件的视图时，事件处理程序很好，这非常适合解耦和可重用性。

但问题是有时我有未引用的视图，所以我使用事件聚合器，它是一个全局通知来了解是否发生了某些事情......但是当我只想听我无法引用的孩子的观点时，这似乎不对，比如DOM 层次结构中的冒泡事件。

但让我说我有一个视图层次结构，如：

*   **父视图**
    *   子视图
        *   子视图
            *   **模态视图**

我想知道当 ModalView 触发事件时在**ParentView**中...我不能使用事件冒泡，因为**ModalView****不在**同一个 DOM 层次结构中，所以在这种情况下我应该使用 Event Agregator 还是其他什么？我真的希望那个事件泡沫适合我的情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T01:20:23.983

如果您不能使用 DOM 的层次结构并且不想使用事件聚合器，我的第一直觉是您需要在视图中构建自己的层次结构。

您可以查看[backbone.courier](http://github.com/rotundasoftware/backbone.courier)，了解如何实现自己的事件冒泡系统。

[Backbone.courier 使用 DOM 来检测父视图](http://github.com/rotundasoftware/backbone.courier#view_getparentview)，但您可以实现自己的方法来检测父视图。

所以它在没有事件聚合或 DOM 的情况下是可行的，但我认为你最终会创建和管理自己的层次结构。**因为我们已经有了 DOM，所以这很臭。**这肯定会让我产生疑问：“我*真的*需要冒泡这个事件吗？”。

对于您的示例，最简单的解决方案可能是为您的ModalView 提供对**ParentView**的引用，并在您的偶数在 ModalView 上触发时**简单****地**调用。你真的需要它在孩子们中间冒泡吗？这真的需要解耦吗？当您假设您没有参考其他观点时，您可能过于严格。`parentView.listener()`

 **无论如何，这些都是我会问自己的问题。虽然看起来很明显，但它可能是最好的解决方案：

```
modalView.container = parentView;

modalView.myEventHandler = function(e) {
    this.container.myEventHandler(e);
} 
```**

# c# - 解析单语句布尔表达式树

> ID：15177443
> 
> 赞同：0
> 
> 时间：2013-03-02T17:39:31.750
> 
> 标签：c#, .net, linq, tsql, linq-expressions

MSDN 文档有一个很好[的解析表达式树的例子](http://msdn.microsoft.com/en-us/library/bb397951.aspx)：

```
// Create an expression tree.
Expression<Func<int, bool>> exprTree = num => num < 5;

// Decompose the expression tree.
ParameterExpression param = (ParameterExpression)exprTree.Parameters[0];
BinaryExpression operation = (BinaryExpression)exprTree.Body;
ParameterExpression left = (ParameterExpression)operation.Left;
ConstantExpression right = (ConstantExpression)operation.Right;

Console.WriteLine("Decomposed expression: {0} => {1} {2} {3}",
              param.Name, left.Name, operation.NodeType, right.Value); 
```

但我还没有看到如何解析这样的例子：

```
MyDomainObject foo;
Expression<Func<bool>> exprTree = () => ((foo.Scale < 5 || foo.Scale > 20) && foo.Scale <> -100) || foo.IsExempt; 
```

我的目标是找到或构建一个实用程序，它可以 (1) 处理任何级别的括号嵌套，并且 (2) 生成一个包含等效 SQL“where”子句的字符串作为解析表达式树的产物。任何人都有可能帮助或知道解决此问题的 nuget 包的代码片段？

对于我上面的嵌套表达式，假设一个名为“MyDomainObject”的数据库表，正确的 SQL where 子句字符串输出将是：

```
(( Scale < 5 or Scale > 20) and Scale != -100) or IsExempt = true 
```

显然，我想象中的解析器假设在没有二元运算符的情况下简单地断言“真”，如“IsExempt = true”的情况

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:55:30.887

这是一个至少可以将您的输入转换为有效 SQL 表达式的实现。您需要自己实现更多表达式类型，但它可以让您了解它是如何工作的。

这个答案恰好与 Kazetsukai 的答案非常相似，但它用于`Expression.NodeType`查找运算符，因为`MethodInfos`表达式树中没有。

另请注意，这会产生比实际需要更多的括号。为了减少括号的数量，需要进一步分析表达式，考虑 SQL 中的运算符优先级。

```
public static string GetSqlExpression(Expression expression)
{
    if (expression is BinaryExpression)
    {
        return string.Format("({0} {1} {2})",
            GetSqlExpression(((BinaryExpression)expression).Left),
            GetBinaryOperator((BinaryExpression)expression),
            GetSqlExpression(((BinaryExpression)expression).Right));
    }

    if (expression is MemberExpression)
    {
        MemberExpression member = (MemberExpression)expression;

        // it is somewhat naive to make a bool member into "Member = TRUE"
        // since the expression "Member == true" will turn into "(Member = TRUE) = TRUE"
        if (member.Type == typeof(bool))
        {
            return string.Format("([{0}] = TRUE)", member.Member.Name);
        }

        return string.Format("[{0}]", member.Member.Name);
    }

    if (expression is ConstantExpression)
    {
        ConstantExpression constant = (ConstantExpression)expression;

        // create a proper SQL representation for each type
        if (constant.Type == typeof(int) ||
            constant.Type == typeof(string))
        {
            return constant.Value.ToString();
        }

        if (constant.Type == typeof(bool))
        {
            return (bool)constant.Value ? "TRUE" : "FALSE";
        }

        throw new ArgumentException();
    }

    throw new ArgumentException();
}

public static string GetBinaryOperator(BinaryExpression expression)
{
    switch (expression.NodeType)
    {
        case ExpressionType.Equal:
            return "=";
        case ExpressionType.NotEqual:
            return "<>";
        case ExpressionType.OrElse:
            return "OR";
        case ExpressionType.AndAlso:
            return "AND";
        case ExpressionType.LessThan:
            return "<";
        case ExpressionType.GreaterThan:
            return ">";
        default:
            throw new ArgumentException();
    }
} 
```

结果是：

```
(((([Scale] < 5) OR ([Scale] > 20)) AND ([Scale] <> -100)) OR ([IsExempt] = TRUE)) 
```

像这样调用方法：

```
string sqlExpression = GetSqlExpression(exprTree.Body); 
```

我建议以更实用的方式构建表达式树。`Func<bool>`而不是使用混凝土来构建 a ，而`foo`应该使用`Func<Foo, bool>`. 但是，无论如何它都会起作用。只是看起来不太对。

```
Expression<Func<Foo, bool>> exprTree =
    (foo) => ((foo.Scale < 5 || foo.Scale > 20) && foo.Scale != -100) || foo.IsExempt == true; 
```

显然，当您可以使用 LINQ to Entities 时，通常不需要自己构建 SQL 文本。LINQ to 实体和表达式树都需要 .NET 3.5，您实际上可以[将 LINQ 转换为 sql 语句](https://stackoverflow.com/questions/550826/translate-linq-to-sql-statement)。

我不确定类似的表达式`IsExempt = TRUE`是否适用于 SQL Server。我认为应该是`IsExempt = 1`因为数据类型是[`bit`](http://msdn.microsoft.com/library/ms177603.aspx). 由于您不能在 SQL 表达式中使用or ，因此类似`Value == null`or的表达式也`Value != null`需要单独处理。它必须是或。`Value = NULL``Value <> NULL``Value IS NULL``Value IS NOT NULL`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T19:28:56.623

所以听起来你的问题不是“解析”（因为表达式已经被解析为 C# 表达式），你想要的是遍历表达式树并输出 SQL 表达式。

如果可以避免的话，我不建议为它滚动你自己的代码。对于大多数人来说，LINQ to Entities 可能是更好的选择[，因为它基本上为您完成了这项工作](http://msdn.microsoft.com/en-us/library/bb738636.aspx)，同时完全隐藏了 SQL。

如果您有其他要求（例如较低的 .NET 版本，或者您必须拥有 SQL 字符串），并且愿意自己编写代码，您可以使用递归函数来完成。该函数可以接受一个表达式并将 SQL 子句作为字符串返回。

类似于（尚未对此进行测试，将其视为伪代码）：

```
public string WriteClause(Expression exp)
{
    if (exp is ParameterExpression)
    {
        return (exp as ParameterExpression).Name;
    }
    else if (exp is BinaryExpression)
    {
        var binaryExpression = exp as BinaryExpression;

        return "(" +
               WriteClause(binaryExpression.Left) + " "
               GetSqlOperator(binaryExpression.Method) + " "
               WriteClause(binaryExpression.Right) +
               ")";
    }
    else if...

    ...etc...

}

public string GetSqlOperator(MethodInfo method)
{
    switch (method.Name)
    {
        case "Add":
            return "+";
        case "Or":
            return "or";

        ...etc...
    }
} 
```

递归意味着这种方法应该处理任何级别的括号深度。这有点天真，所以它会放入比你需要的更多的括号。

# python - 从 Python 代码到工作可执行文件（缩小网格文件程序）

> ID：15177445
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:39:43.527
> 
> 标签：python, syntax

我之前发布了一个关于语法错误的问题，这里[是我从 Internet 复制的 Python 代码中的无效语法错误](https://stackoverflow.com/questions/15177040/invalid-syntax-error-in-python-code-i-copied-from-the-internet)。幸运的是，多亏了你，我的问题很快得到了解决。但是，既然没有语法错误，我发现自己很无助，因为我不知道现在该怎么处理这段代码。正如我所说，我在 3 年前完成了一些基本的 Python 培训，但人脑似乎忘记了事情的速度如此之快。

所以简而言之，我需要将一些文件的网格分辨率降低到一半，并且我一直在寻找一种方法来做到这一点。幸运的是，我发现了一些似乎完全符合我要求的 python 代码。代码是这样的：

```
#!/bin/env python
# -----------------------------------------------------------------------------
# Reduce grid data to a smaller size by averaging over cells of specified
# size and write the output as a netcdf file.  xyz_origin and xyz_step
# attributes are adjusted.
#
# Syntax: downsize.py <x-cell-size> <y-cell-size> <z-cell-size>
#                       <in-file> <netcdf-out-file>
#
import sys

import Numeric

from VolumeData import Grid_Data, Grid_Component

# -----------------------------------------------------------------------------
#
def downsize(mode, cell_size, inpath, outpath):

  from VolumeData import fileformats
  try:
    grid_data = fileformats.open_file(inpath)
  except fileformats.Uknown_File_Type as e:
    sys.stderr.write(str(e))
    sys.exit(1)

  reduced = Reduced_Grid(grid_data, mode, cell_size)

  from VolumeData.netcdf.netcdf_grid import write_grid_as_netcdf
  write_grid_as_netcdf(reduced, outpath)

# -----------------------------------------------------------------------------
# Average over cells to produce reduced size grid object.
#
# If the grid data sizes are not multiples of the cell size then the
# final data values along the dimension are not included in the reduced
# data (ie ragged blocks are not averaged).
#
class Reduced_Grid(Grid_Data):

  def __init__(self, grid_data, mode, cell_size):

    size = map(lambda s, cs: s / cs, grid_data.size, cell_size)
    xyz_origin = grid_data.xyz_origin
    xyz_step = map(lambda step, cs: step*cs, grid_data.xyz_step, cell_size)
    component_name = grid_data.component_name
    components = []
    for component in grid_data.components:
      components.append(Reduced_Component(component, mode, cell_size))

    Grid_Data.__init__(self, '', '', size, xyz_origin, xyz_step,
                       component_name, components)

# -----------------------------------------------------------------------------
# Average over cells to produce reduced size grid object.
#
class Reduced_Component(Grid_Component):

  def __init__(self, component, mode, cell_size):

    self.component = component
    self.mode = mode
    self.cell_size = cell_size
    Grid_Component.__init__(self, component.name, component.rgba)

  # ---------------------------------------------------------------------------
  #
  def submatrix(self, ijk_origin, ijk_size):

    ijk_full_origin = map(lambda i, cs: i * cs, ijk_origin, self.cell_size)
    ijk_full_size = map(lambda s, cs: s*cs, ijk_size, self.cell_size)
    values = self.component.submatrix(ijk_full_origin, ijk_full_size)

    if mode == 'ave':
      m = average_down(values, self.cell_size) 
```

我将其保存为 .py 文件，当我双击它时，命令提示符会出现一毫秒然后消失。我设法截取了该命令提示符的屏幕截图，上面写着“无法使用'bin/env python“C:\Users............py”创建进程。

我想要做的是能够使用代码告诉我使用的语法来缩小规模：

```
# Syntax: downsize.py <x-cell-size> <y-cell-size> <z-cell-size>
    #                       <in-file> <netcdf-out-file> 
```

你能帮助我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:42:54.367

不要通过双击来运行该文件。通过打开一个新的 shell 来运行该文件，然后输入`.py`文件的路径（或只是`cd`到父目录），然后输入您要传​​递的参数。例如：

```
python downsize.py 1 2 3 foo bar 
```

# c# - 如何在 WPF 功能区中隐藏除应用程序菜单按钮之外的所有内容？

> ID：15177447
> 
> 赞同：0
> 
> 时间：2013-03-02T17:39:55.010
> 
> 标签：c#, wpf, ribbon

当我在 WPF 中添加功能区时，我得到了一个完整的功能区控件。如何隐藏除应用程序菜单按钮之外的所有内容？我可以做一些变通方法，但有什么标准方法可以隐藏其他面板吗？

![在此处输入图像描述](../Images/245e78a640ae8b218e3dc08f2b617d58.png)

我懒得为此设计自己的控件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:55:43.210

`Loaded`您可以在事件中清除项目并将功能区高度属性设置为 45 。

```
 <ribbon:Ribbon x:Name="Ribbon" Loaded="Ribbon_Loaded">
        <ribbon:Ribbon.ApplicationMenu>
            <ribbon:RibbonApplicationMenu SmallImageSource="Images\SmallIcon.png">
                <ribbon:RibbonApplicationMenuItem Header="Hello _Ribbon"
                                                  x:Name="MenuItem1"
                                                  ImageSource="Images\LargeIcon.png"/>
            </ribbon:RibbonApplicationMenu>
        </ribbon:Ribbon.ApplicationMenu>
        <ribbon:RibbonTab x:Name="HomeTab" 
                          Header="Home">
            <ribbon:RibbonGroup x:Name="Group1" 
                                Header="Group1">
                <ribbon:RibbonButton x:Name="Button1"
                                     LargeImageSource="Images\LargeIcon.png"
                                     Label="Button1" />

                <ribbon:RibbonButton x:Name="Button2"
                                     SmallImageSource="Images\SmallIcon.png"
                                     Label="Button2" />
                <ribbon:RibbonButton x:Name="Button3"
                                     SmallImageSource="Images\SmallIcon.png"
                                     Label="Button3" />
                <ribbon:RibbonButton x:Name="Button4"
                                     SmallImageSource="Images\SmallIcon.png"
                                     Label="Button4" />                    
            </ribbon:RibbonGroup>                
        </ribbon:RibbonTab>
    </ribbon:Ribbon> 
```

代码隐藏：

```
private void Ribbon_Loaded(object sender, RoutedEventArgs e)
{
    Ribbon menu = sender as Ribbon;
    menu.Height = 45;
    menu.Items.Clear();
} 
```

您可以使用它单独的外部功能区控件，但在这种情况下，您将在下拉菜单中失去样式：

```
<Grid x:Name="LayoutRoot">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <ribbon:RibbonApplicationMenu SmallImageSource="Images\SmallIcon.png" HorizontalAlignment="Left">
        <ribbon:RibbonApplicationMenuItem Header="Hello _Ribbon"
                                                  x:Name="MenuItem9"
                                                  ImageSource="Images\LargeIcon.png"                                              
                                          />
    </ribbon:RibbonApplicationMenu>

</Grid>                                     
                                          />
    </ribbon:RibbonApplicationMenu> 
```

# android - 不断检查互联网连接，如果连接，运行代码（Android）

> ID：15177452
> 
> 赞同：0
> 
> 时间：2013-03-02T17:40:52.997
> 
> 标签：android, webview, looper

我想不断检查互联网连接并更改`TextView`连接是否出现或消失。但是在`TextView`我刷新应用程序之前不会改变。这是我当前的代码：

```
 TextView offline;
    public void run() {
  try {
    Looper.prepare();

    new Handler();
        if(isInternetOn()) {
            swebview.reload();
            offline.setText(null);
            }else{
                swebview.reload();
                offline.setText("No Internet Connection!");
            }
    Looper.loop();
  } catch (Throwable t) {
    Log.d(TAG, "halted due to an error", t);
  }
} 
```

和`isInternetOn()`代码：

```
public final boolean isInternetOn() {
    ConnectivityManager connec =  (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
    // ARE WE CONNECTED TO THE NET
    if ( connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTED ||
    connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTING ||
    connec.getNetworkInfo(1).getState() == NetworkInfo.State.CONNECTING ||
    connec.getNetworkInfo(1).getState() == NetworkInfo.State.CONNECTED ) {
    // MESSAGE TO SCREEN FOR TESTING (IF REQ)
    //Toast.makeText(this, connectionType + ” connected”, Toast.LENGTH_SHORT).show();
    return true;
    } else if ( connec.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED ||  connec.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED  ) {
    //System.out.println(“Not Connected”);
    return false;
    }
    return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:11:32.550

嗨，试试下面的代码来不断检查互联网并更新你的文本视图

```
 TextView tvstatus;
 tvstatus=(TextView)findViewById(R.id.txtviewstatus);

   public static boolean hasConnection() {
ConnectivityManager cm = (ConnectivityManager) MbridgeApp.getContext().getSystemService(
    Context.CONNECTIVITY_SERVICE);

NetworkInfo wifiNetwork = cm.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
if (wifiNetwork != null && wifiNetwork.isConnected()) {
     Toast.makeText(this, "Network Available", Toast.LENGTH_LONG).show();
        tvstatus.setText("WifiNetwork kAvailable");

     return true;
}

NetworkInfo mobileNetwork = cm.getNetworkInfo(ConnectivityManager.TYPE_MOBILE);
if (mobileNetwork != null && mobileNetwork.isConnected()) {

  Toast.makeText(this, "Network Available", Toast.LENGTH_LONG).show();
        tvstatus.setText("MobileNetworkAvailable");

  return true;
}

NetworkInfo activeNetwork = cm.getActiveNetworkInfo();
if (activeNetwork != null && activeNetwork.isConnected()) {

    Toast.makeText(this, "Network Available", Toast.LENGTH_LONG).show();
        tvstatus.setText("Network Available");

  return true;
}

return false;
 } 
```

# actionscript-3 - 在 AS3.0 中链表是如何实现的

> ID：15177453
> 
> 赞同：0
> 
> 时间：2013-03-02T17:41:01.173
> 
> 标签：actionscript-3

我偶然发现了这个页面：[在 AS3 中创建链接列表](https://stackoverflow.com/questions/11874805/create-linked-list-in-as3)

由于 AS3.0 是一种脚本语言。我想知道如何在 AS3.0 中实现链表？指针（一种访问内存位置的方法）不是创建链表的强制要求。这最终使数据数组的性能更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:05:43.087

在 AS3 中你有对象引用，你没有指针，但是你可以以非常相似的方式使用引用来实现一个链表。链接列表（通常）的优点在于列表中的插入和删除（您不必像使用数组那样移动所有元素）。您仍然可以使用对象引用获得此好处。

注意：AS3 中的对象是通过引用传递的，原语是通过值传递的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T10:12:23.130

实际上，所有脚本语言都可以使用指针。

他们只是决定以不同的方式称呼它们（大多数时候他们称它们为“引用”）并隐藏管理内存分配和释放的复杂性（甚至可能性）。

话虽如此，在 ActionScript（或 JavaScript）中创建链表的最简单方法是

```
var node1 = {value: 1};
var node2 = {value: "foo"};
var node3 = {value: "bar"};

//of course this code should be localices within a separate class
//with some nice API
((node1.next = node2).next = node3).next = null;

//and then use like that e.g.
var n = node1;
while (n) {
    trace(n.value);
    n = n.next;
} 
```

# java - 从线程中读取数据（在 Servlet 中）

> ID：15177456
> 
> 赞同：3
> 
> 时间：2013-03-02T17:41:34.863
> 
> 标签：java, concurrency

我正在使用 ServletContextListener 创建一个新线程。

```
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;
import java.util.concurrent.*;

    public class Port implements ServletContextListener {
        private ExecutorService executor;

        public void contextDestroyed(ServletContextEvent event) {
            executor.shutdown();

        }

        public void contextInitialized(ServletContextEvent event) { 
            // start task
            executor = Executors.newSingleThreadExecutor();
            executor.submit(new Task()); //task should implement Runnable!

        }
    } 
```

在这个线程中，我正在从串行端口（SerialPortEventListener）读取数据。task.class 应该在服务器处于活动状态的整个期间从串行端口读取信息。我把它扔到了一个线程中，因为只能有一个从串行端口读取的实例；然后应将数据共享给所有客户端。

现在我想访问这个线程从串口读取的数据。

这可以做到吗？如果是，那怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:47:19.100

例如，您可以将读取的数据存储在 servlet 上下文属性中。然后，从其他类中，您将从 servlet 上下文中获取属性：

```
public void contextInitialized(final ServletContextEvent event) { 
        // start task
        executor = Executors.newSingleThreadExecutor();
        executor.submit(new Runnable() {
            @Override
            public void run() {
                String data = readFromPort();
                event.getServletContext().setAttribute("serialPortData", data); 
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T17:48:44.670

是的，它可以做到，而且你有几个选择：

1-在线程内部使用共享的`concurrent.BlockingQueue`where添加新数据，`SerialPort`并在您的servlet中从该队列读取

2- 在您的 servlet 中有一个事件侦听器对象并将其传递给您的`task`构造函数。侦听器对象应该有一个回调函数，在`SerialEvent`发生时调用。

一般来说，这是一个典型的*生产者/消费者*模式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T17:48:13.993

您需要在要创建的新 Runnable 中共享数据。您可以向它添加一个[并发集合](http://docs.oracle.com/javase/tutorial/essential/concurrency/collections.html)。

# python - Python for 循环没有预期的结果

> ID：15177457
> 
> 赞同：0
> 
> 时间：2013-03-02T17:41:35.327
> 
> 标签：python

我有点卡住了 for 循环 - 我可以看到它正在做的事情看起来是正确的，但并不是我想要用它完成的事情。我来自 C 背景，但这里的任何建议都是有益的。

```
def deal(player_num, cards):
    a = 0
    z = 0
    i = 0
    b = 0
    c = player_num
    hand = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]    
    for a in range(player_num):
        hand[a] = cards[i] + cards[i+b+c]
        b == b+1
        i == i+1
        z == z+1
    return hand 
```

所以 ,`for a in range(player_num)`似乎正在工作（追加`a++`）但是`hand[0]`,`hand[1]`等得到了同样的帮助。我猜它循环 a 但不是其他变量，所以我需要使用超过 1 个嵌套循环来获取`i++`,`b++`和`c++`?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T17:43:48.230

`b == b+1`是一个逻辑表达式（`False`每次都返回），而不是一个赋值。我猜你想要类似的东西： `b += 1`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-02T17:43:55.803

`==`是 Python 中的等式运算符。`=`是赋值运算符。

`==`检查其左操作数和右操作数是否相等并相应地返回 True 或 False。`b`并且`b+1`永远不会彼此相等，无论哪种方式，执行没有副作用的操作（例如比较两个值是否相等）然后对其结果不做任何事情都是没有意义的。

如果要更改变量的值，请使用赋值运算符`=`而不是`==`.

# ruby-on-rails - 简明的导轨指南？

> ID：15177460
> 
> 赞同：-2
> 
> 时间：2013-03-02T17:41:41.240
> 
> 标签：ruby-on-rails

我正在寻找使用导轨的非常简洁的指南。我已经使用其他类似的框架（如 Django）做了很多工作，所以我只需要一个非常简短的教程。有这样的东西存在吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:48:13.413

对于刚接触 Rails 的人来说，这是最好的指南。

[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:52:47.027

如果您愿意忍受一些快速的视频教程，EnvyLabs ( [railsforzombies.org](http://railsforzombies.org) ) 的 Rails for Zombies 对框架进行了很好的概述。

如果您决定查看它，请了解这一点：在撰写本文时，教程中有一个错误。他们向您展示的用于编写基本重定向的代码在 URI 上缺少前置斜杠。（至少，根据他们用于随附练习的解释器，这是不正确的。）

除了那个小小的抱怨之外，在我看来，在深入了解细节之前，这是一个让您和同事加入 Rails 的好方法。

# python - python中的字典：对搜索键返回的值求和

> ID：15177462
> 
> 赞同：1
> 
> 时间：2013-03-02T17:41:45.973
> 
> 标签：python, dictionary, sum

我只是在学习 Python，所以这可能很简单。我试图找到与字典中的键匹配的值并将它们相加。我已经编写了找到值的代码并且可以打印它（在 Online Python Tutor 中对此进行了测试以查看会发生什么）但我无法弄清楚如何将其作为返回正确分数的总分（6 ）。我知道目前这不是一个功能。

```
 SCRABBLE_LETTER_VALUES = {
        'a': 1, 'b': 3, 'c': 3, 'd': 2, 'e': 1, 'f': 4, 'g': 2, 'h': 4, 'i': 1, 'j': 8, 'k': 5, 'l': 1, 'm': 3, 'n': 1, 'o': 1, 'p': 3, 'q': 10, 'r': 1, 's': 1, 't': 1, 'u': 1, 'v': 4, 'w': 4, 'x': 8, 'y': 4, 'z': 10
    }
word ='tact'
score =0

for i in range(len(word)):
    for letter,score in SCRABBLE_LETTER_VALUES.items():
        if letter == word[i]:
            print score 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:10:54.343

```
>>> sum(SCRABBLE_LETTER_VALUES[l] for l in word)
6 
```

这里：

1.  `for l in word`遍历`word`;的字母
2.  `SCRABBLE_LETTER_VALUES[l]`获取`SCRABBLE_LETTER_VALUES`;的对应条目
3.  `sum(...)`把它们加起来。

内部的构造`sum()`称为[生成器表达式](http://www.python.org/dev/peps/pep-0289/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:11:07.737

如果我是你，我会使用这段代码：

```
score = 0
word = 'tact'
for letter in word:
    score += SCRABBLE_LETTER_VALUES[letter]
print score 
```

还有更有效的方法，例如 NPE 提到的方法，但如果您只是初学者，我更愿意使用（并理解）这种方法。

* * *

**上面代码的作用，逐行：**

1）首先，我们使用`for`-loop 来遍历你的每个字母`word`：

```
for letter in word: 
```

2）对于每个字母，我们`score`将变量增加您定义的相应数量，`SCRABBLE_LETTER_VALUES`如下所示：

```
score = score + SCRABBLE_LETTER_VALUES[letter] 
```

这可以通过以下方式更轻松地编写`+=`：

```
score += SCRABBLE_LETTER_VALUES[letter] 
```

3）最后我们打印分数：

```
print score 
```

# java - 用值初始化数组 - 我是否应该显式地实例化该类？

> ID：15177463
> 
> 赞同：18
> 
> 时间：2013-03-02T17:41:54.170
> 
> 标签：java

我经常看到数组被这样初始化：

```
String[] array = new String[] { "foo", "bar", "baz" }; 
```

但是阅读[Language Basics - Arrays](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)表明短语法不需要显式实例化构造函数：

> 或者，您可以使用快捷语法来创建和初始化数组：
> 
> ```
>  int[] anArray = { 
>      100, 200, 300,
>      400, 500, 600, 
>      700, 800, 900, 1000
>  }; 
> ```

* * *

所以，假设这两种初始化方法：

```
String[] array = new String[] { "foo", "bar", "baz" };
String[] array2 = { "foo", "bar", "baz" }; 
```

这些有什么区别吗？两者似乎都起作用，在这种情况下，我应该假设第二个隐式调用 the`new String[]`并且第一个只是一种更冗长的方式，还是在幕后还有更多？

从 Java 开始，如果这是一个太愚蠢的问题，我很抱歉，但我在网上找不到任何关于此的内容。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-02T17:43:58.080

这两种方法是等价的。但是请注意，简洁的语法只能用于变量声明。外部变量声明必须使用详细语法：

```
 String[] array;
    array = new String[] { "foo", "bar", "baz" }; // OK

    String[] array2;
    array2 = { "foo", "bar", "baz" };             // ERROR 
```

如需进一步讨论，请参阅[此答案](https://stackoverflow.com/a/10520659/367273)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-02T17:44:08.217

> 这些有什么区别吗？

最终结果没有区别。但是，根据[JLS § 10.6，您不能在每个上下文中都使用数组初始值设定项语法。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.6)

> 数组初始值设定项可以在声明中指定（[§8.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3)、[§9.3](http://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.3)、[§14.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.4)），或作为数组创建表达式的一部分（[§15.10](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.10)）来创建数组并提供一些初始值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T17:51:19.563

由于数组*旨在*是可变的，因此每个数组都是一个新实例是有道理的

```
String[] array1 = { "foo", "bar", "baz" };
String[] array2 = { "foo", "bar", "baz" }; 
```

即修改`array1`不会影响`array2`.

# haskell - 推断 if ... then ... else 奇怪的行为

> ID：15177470
> 
> 赞同：4
> 
> 时间：2013-03-02T17:42:58.237
> 
> 标签：haskell, if-statement, type-inference

考虑以下错误代码：

```
fun x = 
    if (null x) then 0
    else (take 50 x) : (fun (drop 50 x)) 
```

我注意到，我可以毫无问题地将它加载到 ghci 中，这就是问题所在。
当我尝试评估此功能时，该程序只会检索我一个错误。

关于 if ... then ... else 表达式的默认推理规则，由于两个分支显式检索不同的类型，为什么可以加载（即编译）此代码？我的意思是，为什么编译器无法确定这段代码格式错误？

注意：当然，如果我为此函数添加了正确的类型注释，正如预期的那样，它将被拒绝，但据我所知，如果没有类型注释，它也应该被拒绝。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-02T17:47:29.653

重载的[数字文字](http://www.haskell.org/tutorial/numbers.html)。Haskell 数字文字是基于类型上下文定义的任何 Num 类的实例。

推断类型解释它：

```
Prelude> let f x = if null x then 0 else take 50 x : f (drop 50 x)

Prelude> :t f
f :: Num [[a]] => [a] -> [[a]] 
```

这读作“如果你有一个用于 的列表的 Num 类的实例`a`，那么此函数将 a 的列表带到 a 的列表的列表中。

所以它依赖于一个神话般的 Num 实例来获取列表列表。如果您尝试编译使用它的代码，而不提供列表列表的数字实例，那将是编译错误。

这个例子也说明了为什么先写下类型签名是个好主意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T17:47:19.357

让我们检查一下。

```
Prelude> let fun x = if (null x) then 0 else (take 50 x) : (fun (drop 50 x)) 
Prelude> :t fun
fun :: Num [[a]] => [a] -> [[a]] 
```

如您所见，编译器`Num`为您的结果类型推断出一个类。

# iphone - ASIHTTPRequest 停止

> ID：15177473
> 
> 赞同：0
> 
> 时间：2013-03-02T17:43:28.383
> 
> 标签：iphone, ios, objective-c, asihttprequest

我正在使用 ASIHTTPRequest 异步获取数据。最初一切正常，但在随机数量的请求后，请求停止加载。我已经实现了所有委托方法并记录了每个方法，结果表明请求正在创建但没有启动，即

```
- (void)requestStarted:(ASIHTTPRequest *)request 
```

委托方法永远不会被解雇。我试图通过添加超时计时器来解决它。我在创建请求时初始化了这个计时器，并在它开始时取消它。计时器工作正常并重试发出请求，但请求永远不会开始加载。有任何想法吗？

# xml - groovy中的树排序

> ID：15177485
> 
> 赞同：0
> 
> 时间：2013-03-02T17:44:36.977
> 
> 标签：xml, groovy

给出一个 LinkedHashMap，我正在尝试在 groovy 中构建一个完整的 xml 树。

1）地图：

```
def trees = [:]
trees.put(1,[id:'1',path:'ROOT/folder1',name:'folder1',isFolder:'true'])
trees.put(2,[id:'2',path:'ROOT/folder1/folder1.1',name:'folder1.1',isFolder:'true'])
trees.put(3,[id:'3',path:'ROOT/folder1/folder1.1/folder1.1.1',name:'folder1.1.1',isFolder:'true'])
trees.put(4,[id:'4',path:'ROOT/folder2',name:'folder2',isFolder:'true'])
trees.put(5,[id:'5',path:'ROOT/folder3',name:'folder3',isFolder:'true'])
trees.put(6,[id:'6',path:'ROOT/folder3/folder3.1',name:'folder3.1',isFolder:'true']) 
```

2）排序树闭包：

```
//def rslt = { [:].withDefault{ owner.call() } }
def a = []
def rslt = { [:].withDefault{ owner.call() } }().with { t ->
  trees.each { k, v ->
    v.path.tokenize( '/' ).inject( t ) { tr, i -> tr[ i ] }
  }
  return t
} 
```

3) 如何构建一个 Xml 文档，例如使用 xml slurper，

一个模型是这样的：

```
<ROOT>
<folder1 name="folder1" id="1" parent="ROOT" depth="1" path="ROOT/folder1">
      <folder1.1 name="folder1.1" id="2" parent="folder1" depth="2" path="ROOT/folder1/folder1.1">
           <folder1.1.1 name="folder1.1.1" id="3" parent="folder1.1" depth="3" path="ROOT/folder1.1/folder1.1.1"/>
       </folder1.1>
</folder1>
...
</ROOT> 
```

使用 groovy.xml.MarkupBuilder(sw).with { 之类的东西寻找闭包

有什么想法或建议吗？

BR。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T14:04:50.070

`groovy.xml.StreamingMarkupBuilder`您可以通过递归遍历节点映射来构建您的 XML 。您在第二步中创建的地图会丢失其中定义的所有属性`trees`。要保留它们，您必须先更改该部分：

```
// An empty map. Default value for nonexistent elements is an empty map.
def struc = {[:].withDefault{owner.call()}}()

trees.each { key, val ->
    // iterate through the tokenized path and create missing elements along the way
    def substruc = struc
    val.path.tokenize('/').each {
        // if substruc.nodes does not exist it will be created as an empty map
        // if substruc.nodes[it] does not exist it will be created as an empty map
        substruc = substruc.nodes[it]
    }
    // assign the attributes to the map in .attr
    val.each{ attrKey, attrVal ->
        substruc.attr[attrKey] = attrVal
    }
} 
```

这将产生这样的地图：

```
[nodes: [ROOT: [nodes: [folder1: [attr: [id:1, ...], nodes: [...]]]]] 
```

将在 中使用的`StreamingMarkupBuilder`闭包将使用另一个闭包以递归方式遍历节点，`struc`同时分配`.attr`为节点的属性和`.nodes`节点的子节点。

```
// we will use this builder to create our XML
def builder = new groovy.xml.StreamingMarkupBuilder()
builder.encoding = "UTF-8"

// closure for our xml structure
def xml = {
    // closure to be recursively called for each element in the nodes maps
    def xmlEach
    xmlEach = {
        key, val ->
            out << {
                "${key}"(val.attr) {
                    val.nodes.each(xmlEach)
                }
            }
    }
    struc.nodes.each(xmlEachClosure)
}

println builder.bind(xml) 
```

作为输出，您将获得类似于以下内容的 XML：

```
<ROOT>
    <folder1 id='1' path='ROOT/folder1' name='folder1' isFolder='true'>
        <folder1.1 id='2' path='ROOT/folder1/folder1.1' name='folder1.1' isFolder='true'>
            <folder1.1.1 id='3' path='ROOT/folder1/folder1.1/folder1.1.1' name='folder1.1.1' isFolder='true'></folder1.1.1>
        </folder1.1>
    </folder1>
...
</ROOT> 
```

# c# - Winform ElementHost 中的 MouseEnter 事件

> ID：15177486
> 
> 赞同：0
> 
> 时间：2013-03-02T17:44:39.123
> 
> 标签：c#, wpf, winforms, user-controls, elementhost

我有一个带有 elementHost 的 Winform 以包含 WPF UserControl。我需要的是当鼠标进入elementHost而不是child时做一些事情。我试图在 elementHost 中使用 MouseEnter 事件，但它不存在。我有机会做到这一点吗？还是只是不可能？很好奇没有鼠标事件。

这是我所有的事件：

![在此处输入图像描述](../Images/7e42a5513d0ddaab00ac2a4489a0d80d.png)

如果我想以编程方式进行，我只是没有任何 MouseEvent：

![在此处输入图像描述](../Images/d93c7bcc05c75376fb9ecea841139aff.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T18:30:33.653

`MouseEnter`位于`HostContainer`elementHost 的事件，用于检测鼠标何时进入尝试以下代码：

```
public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            elementHost1.HostContainer.MouseEnter += new System.Windows.Input.MouseEventHandler(HostContainer_MouseEnter);
        }
        void HostContainer_MouseEnter(object sender, System.Windows.Input.MouseEventArgs e)
        {
            MessageBox.Show("Mouse entered");
        }

    } 
```

# wix - 引导程序应用程序回滚

> ID：15177489
> 
> 赞同：2
> 
> 时间：2013-03-02T17:45:02.663
> 
> 标签：wix, rollback, bootstrapper, burn, cancel-button

我正在尝试创建一个安装我的 msi 的 Wix 刻录引导程序。引导程序 exe 工作正常，但唯一的问题是，每当我尝试中途取消安装时，添加到 msi 中的自定义操作都不会停止。任何人都可以在单击取消按钮时告诉如何停止和回滚安装。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T21:40:56.627

自定义操作必须发送`::MsiProcessMessage()`调用以提供接收取消和处理来自该 API 的返回代码的可能性（通常是`ERROR_INSTALL_USEREXIT`或`IDCANCEL`）。然后自定义操作必须退出。

如果您查看一些 WiX 标准自定义操作，您会看到很多调用`WcaProcessMessage()`等等。我们保存这些返回代码，WcaFinalize() 在退出时返回正确的东西。查看`src\ca\wcautil\wcautil.cpp`示例`src\ca\wcautil\wcawrap.cpp`代码。

# python - python中支持向量机分类器的替代方案？

> ID：15177490
> 
> 赞同：1
> 
> 时间：2013-03-02T17:45:15.417
> 
> 标签：python, opencv, machine-learning, scikit-learn, classification

我必须在 155 个图像特征向量之间进行比较。每个特征向量都有 5 个特征。我的图像分为 10 类。不幸的是，我需要至少 100 张图像才能使用支持向量机，还有其他选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T19:17:34.453

对于任何机器学习模型来说，每类 15 个样本都非常低。与其浪费时间尝试许多模型类和参数，不如手动收集和标记新示例。它会更有成果。如果你有一堆未标记的图片，你可以使用[https://www.mturk.com/](https://www.mturk.com/)等服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:23:07.383

查看 pybrain。[http://pybrain.org](http://pybrain.org)。并且可能使用神经网络，因为我听说它们需要的训练数据比 svm 少，但准确度较低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-03T01:08:28.107

如果属于同一类的图像是对某个起始图像进行转换的结果，则可以通过对标记示例进行转换来增加训练规模。

例如，如果您正在进行字符识别，则可以使用精细或弹性转换。P.Simard 在应用于视觉文档分析的卷积神经网络最佳实践中对其进行了更详细的描述。在论文中，他使用了神经网络，但同样适用于 SVM。

# c - a* 算法伪代码

> ID：15177491
> 
> 赞同：1
> 
> 时间：2013-03-02T17:45:16.427
> 
> 标签：c, algorithm, graph-algorithm, a-star

我正在尝试在 c 中实现 wikipedia 给出的 a* 算法的伪代码，但我真的坚持理解什么是reconstruct_path 函数，有人可以向我解释这个函数中的变量是什么（p，p+current_node，set）代表？

```
function A*(start,goal)
 closedset := the empty set    // The set of nodes already evaluated.
 openset := {start}    // The set of tentative nodes to be evaluated, initially containing the start node
 came_from := the empty map    // The map of navigated nodes.

 g_score[start] := 0    // Cost from start along best known path.
 // Estimated total cost from start to goal through y.
 f_score[start] := g_score[start] + heuristic_cost_estimate(start, goal)

 while openset is not empty
     current := the node in openset having the lowest f_score[] value
     if current = goal
         return reconstruct_path(came_from, goal)

     remove current from openset
     add current to closedset
     for each neighbor in neighbor_nodes(current)
         tentative_g_score := g_score[current] + dist_between(current,neighbor)
         if neighbor in closedset
             if tentative_g_score >= g_score[neighbor]
                 continue

         if neighbor not in openset or tentative_g_score < g_score[neighbor] 
             came_from[neighbor] := current
             g_score[neighbor] := tentative_g_score
             f_score[neighbor] := g_score[neighbor] + heuristic_cost_estimate(neighbor, goal)
             if neighbor not in openset
                 add neighbor to openset

 return failure

function reconstruct_path(came_from, current_node)
 if came_from[current_node] in set
     p := reconstruct_path(came_from, came_from[current_node])
     return (p + current_node)
 else
     return current_node 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:06:28.943

`came_from`就像评论说的那样，是导航节点的地图。它可以通过多种方式实现，但经典地图应该可以用于此目的（即使是列表也可以）。

如果您不熟悉地图，请[查看 std::map](http://www.cplusplus.com/reference/map/map/)。

的目标`A*`是找到一个移动列表，这将解决给定的问题（表示为图表）。解决方案是通过图形的路径。

在提议的伪代码中，`came_from`存储您实际评估的解决方案的“历史”（因此可能是通过图表的路径）。

当您探索一个节点（新节点或已访问列表中成本较低的节点）时：

```
if neighbor not in openset or tentative_g_score < g_score[neighbor] 
    came_from[neighbor] := current 
```

您正在`came_from`地图中保存您来自的节点。（将其视为移动的有序列表更简单，直到到达解决方案节点。使用地图而不是列表来解决性能问题）。

上面的行基本上意味着：

> "Now I'll visit **neighbor** node. Remember that I reached neighbor node coming from **current** node".

When `goal` node is reached, `A*` needs to return the list of moves from `start` node to `goal`. You have the reference to the `goal` node, so you can now recontruct the list(`reconstruct_path`) of moves to reach it coming from `start` node, because you stored the list of moves in `came_from` map.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:04:13.907

您有一组节点，路径中的每个节点都可以“指向”其前身（您来自该节点的节点） - 这就是 come_from 地图存储的内容。

您希望您的 a* 函数返回路径中的节点列表*。

现在，回到`return (p + current_node)`- 这段代码基本上意味着返回一个列表，其中包含来自 p 的所有元素，最后是 current_node 。所以它的`p`末尾添加了 1 个元素`p`。

你可以看到，因为这个函数是递归的，所以一开始它将包含一个元素——首先在你的路径中，这将是一个开始。然后，您将向其中添加新元素，最后以`goal`元素结尾。

你也可以这样看：你的算法允许你找到一条从`goal`到的路径`start`（你只需要跟随`came_from`你的节点）。这个函数允许你遍历你的路径`start`，`goal`谢谢你的递归，所以你应该最终得到一个列表，其中包含正确顺序的路径。

*我所说的列表是指一些表示元素序列而不是集合的结构。

# php - $_GET['value'] 不起作用？

> ID：15177497
> 
> 赞同：-2
> 
> 时间：2013-03-02T17:45:48.113
> 
> 标签：php, function, get

我正在尝试制作一个小型浏览器游戏，但我无法从 URL 中的 $_GET[] 值中获取值。谁能确认我在做正确的事情，或者只是在横冲直撞 PHP 的东西？

```
 // General settings
    $site = "http://localhost/index.php";
    $buildfood0 = "dSDF3HJKhbv432dsfs";
    // Food forms
    $form_food0 = "<img src='./images/game/b7_.png' /><a class='button' href='$site?code=$buildfood0'>Build</a>";

    if($lvl_food == 0){
        if($_GET['code']) {
            $codefood = $_GET['code'];
                if($codefood0 == $buildfood0){
                    require("./connect.php");   
                    mysql_query("UPDATE users SET lvl_farm='1' WHERE username='$username'");                            
                    mysql_close();
                }
                else
                    null;       
            }           
        }       
    else if($lvl_food == 1){
        echo "<img src='./images/game/b7.png' />";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:49:07.853

改变：

```
if($lvl_food == 0){
    if($_GET['code']) {
        $codefood = $_GET['code'];
            if($codefood0 == $buildfood0){
------------------------^ // Wrong. Remove the 0 
```

使它成为：

```
if($lvl_food == 0){
    if($_GET['code']) {
        $codefood = $_GET['code'];
            if($codefood == $buildfood0){ 
```

# java - 继承：对象创建

> ID：15177501
> 
> 赞同：10
> 
> 时间：2013-03-02T17:46:00.180
> 
> 标签：java, inheritance, instantiation, instance-variables

假设我有这段代码：

```
class Animal {
    int legs = 4;
    int head = 1;
}

public class Dog extends Animal {
    public static void main (String []args) {
        Dog dog = new Dog();
    }
} 
```

我知道`super()`隐式放置在无参数构造函数的第一行，所以我知道`Animal`构造函数将被执行，因此`Animal`将设置 's 实例变量。

为此，我想了解，一旦这些变量已由超级构造函数 ( `Animal`) 初始化，这些实例变量是否将保留在 Animal 对象中或复制到子类 ( `Dog`)。

在第一种情况下，对象`Animal`将被隐式实例化，`super();`并且每当实例`Dog`需要访问其中一个变量时，它将访问保存在实例中的变量`Animal`（在后台创建）。或者第二种情况，如果对象 Animal 将是临时创建的，则将所有实例变量 (in `Animal`) 复制到`Dog`实例中，然后删除`Animal`临时创建的实例。

我个人认为，例如，一个`Dog`对象将直接链接到一个`Animal`直接连接到一个对象的对象。

是这样吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-02T17:48:11.827

只有*一个 object*，它立即（从一开始）就是一个`Dog`实例。它具有 的所有字段`Dog`（不是您在这里有任何字段）*和*.的所有字段`Animal`。

最初，所有变量都将设置为其默认值（0、null 等）。然后当你到达每个类的构造函数体时（在调用超类构造函数之后），实例变量初始化器被执行，然后该类的构造函数体被执行。

不需要复制，因为只有一个对象。例如，如果您要编写这样的`Animal`构造函数：

```
public Animal() {
    System.out.println(this.getClass());
} 
```

...它会打印出来`Dog`，因为对象已经是 a `Dog`，即使它的`Dog`构造函数还没有被执行。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-02T17:54:52.403

您的`Dog`extends`Animal`和`head`,`legs`变量不是私有的，因此您将从`Dog`实例中访问它们。

在实践中，会发生以下情况：

*   您创建一个`Dog`实例，它也是一个`Animal`
*   所有对象属性都被创建和初始化（包括`head`, 和属性之后`Animal`）
*   的隐式构造函数`Dog`被调用（它调用`super()`）
*   的隐式构造函数`Animal`被调用

结果是一个对象，它是一个`Dog`，但隐含的也是一个`Animal`。

* * *

对象的外观（为了示例，`Dog`让我们忘记类）。`Object`让我们假设`Dog`也有一个`public String name;`属性。

这是 Dog 实例的内存映射：

```
Addr  Type     Name      Defined in:
------------------------
| 0 | int    | legs    | Animal
| 1 | int    | head    | Animal
| 2 | String | name    | Dog
------------------------ 
```

*   如果你有一个`Animal`，你可以在**地址 1**`head`作为一个变量访问，
***   如果您有 a `Dog`，您可以在**地址 2**`name`处作为变量访问，***   如果你有一个`Dog`，你可以在**地址 1**`head`作为一个变量访问****

 ******在类主体中运行的代码`Animal`只能看到地址`0-1`。在类中运行的代码`Dog`可以访问地址`0-2`。如果一个属性`private`属于超类，那么子类将禁止该地址。

这种内存映射可以很容易地向下转换对象：使用相同的内存映射，只是处理（代码和可见性）不同。

我希望它澄清一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-02T17:49:21.293

> 一旦这些变量已被超级构造函数（Animal）初始化，这些实例变量将保留在 Animal 对象中或复制到子类（Dog）中。

首先，实例变量**不会**在`sub-class`. 它们只是**可见**的。它们不会在 Dog 的实例中被复制。如果它们被标记为 public、protected 或 no-modifier，您可以使用 Dog 的实例从 Dog 类访问它们

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-02T17:54:51.683

没有 Animal 对象，只会创建一个 Dog 对象。Dog 对象有变量legs,head 继承自Animal 对象。他们将表现得好像它是 Dog 对象的成员。由于您在 Dog 中扩展 Animal 类，因此将调用 Animal 类构造函数。并且由于 Animal 隐式扩展 Object ，因此将从 Animal 调用 Object 类构造函数。

Java 如何处理这些调用是 Java 内部的，并且可能会因版本而异，但您应该期望保持相同的行为。******

# media-queries - 冒泡不起作用，Sass 在尝试使用 @mixin 和 @content 时将类注入嵌套元素内部而不是围绕它们

> ID：15177504
> 
> 赞同：0
> 
> 时间：2013-03-02T17:46:33.777
> 
> 标签：media-queries, sass

我`@content`在 mixins 中使用来简化媒体查询。如果我在嵌套类中使用第一个 mixin，输出会冒泡并嵌套类。第二个示例根本不起作用（没有错误），嵌套似乎无法正常工作。

**这工作正常**

```
// Everything larger than a landscape tablet but less than or equal to the desktop

@mixin desktop-only {

    @media only screen and (min-width : $mq-tablet-landscape + 1) and (max-width : $mq-desktop) {
        @content;
    }

    .lt-ie9
    {
        @content;
    }
} 
```

**这不起作用**

```
@mixin ie8 {

    .lt-ie9
    {
        @content;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:30:37.297

您的 mixin 看起来对我有用：

```
.foo {
    @include ie8 {
        color: red;
    }
} 
```

输出与我期望的完全一样：

```
.foo .lt-ie9 {
  color: red;
} 
```

由于您的问题没有提供任何有用的信息来说明为什么 mixin 是错误的，所以我假设您*想要*的是以相反的顺序排列这些类。在这种情况下，你的 mixin 需要这样写：

```
@mixin ie8 {
    .lt-ie9 & {
        @content;
    }
} 
```

输出：

```
.lt-ie9 .foo {
  color: red;
} 
```

# wordpress - 在 Wordpress 中居中 NextGen 画廊

> ID：15177507
> 
> 赞同：1
> 
> 时间：2013-03-02T17:46:45.400
> 
> 标签：wordpress, nextgen-gallery

我在我的 Wordpress 网站上使用 NextGen 画廊，但画廊框不尊重页面其余部分的左边距（也就是说，所有其他图像、文本等都有某种缩进或填充，但是NextGen Gallery 一直漂浮到左侧）。我想防止它覆盖这个填充，或者至少浮动到中心。我已经尝试在几个地方编辑 css，但我可能正在编辑错误的类，或者其他什么。画廊的一个例子在页面底部附近[http://www.montereyhighdrama.com/multimedia/the-marriage-of-figaro-2010/](http://www.montereyhighdrama.com/multimedia/the-marriage-of-figaro-2010/)谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-01T18:56:18.207

不知道如何让它尊重左填充，但这确实可以使整个缩略图集浮动到中心。

```
.ngg-galleryoverview {
text-align:center;
}

.ngg-gallery-thumbnail-box {
float:none !important;
display:inline-block;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-01T17:17:33.223

将这些行添加到您的中`style.css`，您应该已准备就绪：

```
.ngg-galleryoverview { text-align: center; }
.ngg-gallery-list { display: inline-block; margin: 0; }
.ngg-gallery-list li { float: none; display: inline-block; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T16:03:44.897

我有同样的问题，但需要一个动态地适用于所有下一代画廊的解决方案，所以我使用了媒体查询。顺便说一句，我找不到任何其他解决方案，也不知道如何使用上面的代码。

我正在使用 Catalyst/Dynamik 主题，因此我可以设置精确的页面宽度和 #container-wrap 初始填充，但这对缩略图居中或改善移动设备外观没有任何作用。

这些是我的媒体查询，您必须根据缩略图大小进行调整，我使用了 220 像素宽。

最终结果：[http](http://site01.profoliolive.com/fixed-grid/) : //site01.profoliolive.com/fixed-grid/ 在 iPad、iPhone 和 Android 手机上测试。

```
@media (max-width: 1209px) {
  .ngg-galleryoverview { padding-left: 115px; }
}

@media (max-width: 1170px) {
  .ngg-galleryoverview { padding-left: 90px; }
}

@media (max-width: 1140px) {
  .ngg-galleryoverview { padding-left: 80px; }
}

@media (max-width: 1120px) {
  .ngg-galleryoverview { padding-left: 70px; }
}

@media (max-width: 1090px) {
  .ngg-galleryoverview { padding-left: 60px; }
}

@media (max-width: 1070px) {
  .ngg-galleryoverview { padding-left: 50px; }
}

@media (max-width: 1050px) {
  .ngg-galleryoverview { padding-left: 40px; }
}

@media (max-width: 1030px) {
  .ngg-galleryoverview { padding-left: 25px; }
}

@media (max-width: 1010px) {
  .ngg-galleryoverview { padding-left: 20px; }
}

@media (max-width: 990px) {
  .ngg-galleryoverview { padding-left: 10px; }
}

@media (max-width: 975px) {
  .ngg-galleryoverview { padding-left: 120px; }
}

@media (max-width: 900px) {
  .ngg-galleryoverview { padding-left: 80px; }
}

@media (max-width: 860px) {
  .ngg-galleryoverview { padding-left: 60px; }
}

@media (max-width: 830px) {
  .ngg-galleryoverview { padding-left: 40px; }
}

@media (max-width: 800px) {
  .ngg-galleryoverview { padding-left: 15px; }
}

@media (max-width: 760px) {
  .ngg-galleryoverview { padding-left: 0px; }
}

@media (max-width: 741px) {
  .ngg-galleryoverview { padding-left: 110px; }
}

@media (max-width: 660px) {
  .ngg-galleryoverview { padding-left: 80px; }
}

@media (max-width: 620px) {
  .ngg-galleryoverview { padding-left: 25px; }
}

@media (max-width: 507px) {
  .ngg-galleryoverview { padding-left: 20px; }
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-29T18:52:45.640

简单的方法是使用：

`<center>[nggallery id=1]</center>`或者`<div align="center";>[nggallery id=1]</div>`

# apache - 雅虎 BOSS API 问题

> ID：15177508
> 
> 赞同：1
> 
> 时间：2013-03-02T17:47:01.383
> 
> 标签：apache, yahoo-boss-api

我有一个使用 OAuth 的 Yahoo BOSS API 项目，但不在我的新 Apache2 服务器上工作。我知道这与文件无关，因为我从仍然有效的旧服务器复制并粘贴了它们。phpinfo() 确认已安装 OAuth，但每当我进行查询时，都会返回空白页面而不是搜索结果。我错过了什么/做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-13T17:16:36.180

您的 BOSS PHP 页面是否包含到您的 oauth.php 页面？您的结果是否设置为从 BOSS 返回的 JSON 或 XML？

# javascript - 用css中的变量控制精灵图像坐标

> ID：15177509
> 
> 赞同：0
> 
> 时间：2013-03-02T17:47:17.320
> 
> 标签：javascript, html, css, sprite, css-sprites

我想使用变量控制 css 中的精灵图像坐标。

```
background: url('sprite.png') no-repeat -123px -321px; width: 23px; height: 22px; 
```

我想要的是能够使用变量使用上面的代码行，

```
background: url('sprite.png') no-repeat -X -Y; width: 23px; height: 22px; 
```

这样我就可以即时设置我的 X 和 Y。

PS：我正在尝试根据我的平均星级评分来设置精灵的点亮星星的长度，这是一个浮点数（如 3.1）。我不想使用 LESS 或 Sass。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:02:06.760

使用 Javascript：

```
var yourelement = document.getElementById('yourelementsid');

yourelement.style.backgroundPosition = x + 'px ' + y + 'px'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:21:29.450

您还可以使用具有内联样式的服务器端脚本返回值：

```
<div style="background-position: <?php echo x . 'px ' . y . 'px'; ?>;"></div> 
```

# java - 在从 servlet 过滤器生成的单独线程中运行耗时进程

> ID：15177512
> 
> 赞同：0
> 
> 时间：2013-03-02T17:47:22.687
> 
> 标签：java, servlet-filters

我的应用程序中有一个 servlet 过滤器，我需要从中调用一个 Web 服务，该服务需要一些时间来返回响应，然后将响应存储在会话中以供以后使用。我希望在这个耗时的过程发生时，我的过滤器应该继续进行，并且应该继续调用其他过滤器，这样性能就不会受到影响。

所以这就是我想在 doFilter() 中做的事情。为此目的创建一个不同的线程。

```
log.debug("start filter");
CustomThread ct=new CustomThread();
ct.start(); //invoke web service in run()
log.debug("continuing with filter"); 
```

考虑到将有超过 1000 个用户访问该应用程序这一事实，这种方法能否正常工作。这种情况在某些情况下会失败吗？请建议我是否需要采取不同的路线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T17:50:55.317

主要问题是您每次都启动一个新线程。这很耗时，如果您收到许多并发请求，它可能会使服务器瘫痪，因为您对生成的线程数没有任何限制。

我会改用 ThreadPoolExecutor 来解决这两个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:49:47.743

您应该使用[`Executor`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executor.html)某种类型的而不是自己担心线程管理。该类提供了多种创建执行器实例的简单方法[`Executors`。](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executors.html)

# c# - 将 Json 中的“&”发送到 AppEngine 时出现格式错误的字符串异常

> ID：15177515
> 
> 赞同：0
> 
> 时间：2013-03-02T17:47:42.217
> 
> 标签：c#, google-app-engine, post, encoding, windows-phone-8

我正在尝试将 Facebook 图形链接发送到 AppEngine 服务器。我收到“格式错误的字符串异常”。这是我将json发送到服务器的方法：

```
public async Task<string> SendJSONData(string urlToCall, string JSONData)
    {
        // server to POST to
        string url = urlToCall;

        // HTTP web request
        var httpWebRequest = (HttpWebRequest)WebRequest.Create(url);
        httpWebRequest.ContentType = "application/x-www-form-urlencoded";
        httpWebRequest.Method = "POST";

        // Write the request Asynchronously 
        using (var stream = await Task.Factory.FromAsync<Stream>(httpWebRequest.BeginGetRequestStream,
                                                                 httpWebRequest.EndGetRequestStream, null))
        {
            //create some json string
            string json = "action=" + JSONData;

            // convert json to byte array
            byte[] jsonAsBytes = Encoding.UTF8.GetBytes(json);

            // Write the bytes to the stream
            await stream.WriteAsync(jsonAsBytes, 0, jsonAsBytes.Length);
        }

        WebResponse response = await httpWebRequest.GetResponseAsync();
        StreamReader requestReader = new StreamReader(response.GetResponseStream());
        String webResponse = requestReader.ReadToEnd();
        return webResponse; } 
```

这是我使用 Fiddler 嗅探的内容：

```
POST http://x.appspot.com/register HTTP/1.1
Accept: */*
Content-Length: 376
Accept-Encoding: identity
Content-Type: application/x-www-form-urlencoded
User-Agent: NativeHost
Host: x.appspot.com
Connection: Keep-Alive
Pragma: no-cache

action={
  "mailFb": "mail@gmail.com",
  "userName": "Michael",
  "userSurname": "w00t",
  "nickname": "Michael w00t",
  "userSex": "male",
  "userAvatar": "https://graph.facebook.com/myperfectid/picture?type=large&access_token=BlahblahblahblahToken"
} 
```

所以一切看起来都很好，但问题是我在 AppEngine 日志中收到以下错误：

```
2013-03-02 17:52:10.431 /register 500 56ms 0kb NativeHost
W 2013-03-02 17:52:10.427 /register com.google.gson.JsonSyntaxException: com.google.gson.stream.MalformedJsonException: Unterminated string at line 7 column 79 at com.google.g
C 2013-03-02 17:52:10.429 Uncaught exception from servlet com.google.gson.JsonSyntaxException: com.google.gson.stream.MalformedJsonException: Unterminated string at line 7 colu 
```

我设法将问题缩小到其根源，即“&”字符。所以我的问题是，如何修复代码，以便它与 AppEngine 一起使用。哦，这是我在服务器上读取接收到的数据的方式：

```
gson.fromJson(reader, User.class); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T11:46:51.930

您声称您正在发送“ `Content-Type: application/x-www-form-urlencoded`”这一事实突出了问题，但事实
并非如此。因此错误。

的正确编码`&`是`&amp;`.

# c++ - 转换运算符在派生类中“仍然有效”是什么意思

> ID：15177522
> 
> 赞同：1
> 
> 时间：2013-03-02T17:48:18.963
> 
> 标签：c++, inheritance, conversion-operator

```
class Game {
  class Other {}; // Nested class
  // Automatic type conversion:
  operator Other() const {
    cout << "Game::operator Other()\n";
    return Other();
  }
};    
class Chess : public Game {};
void f(Game::Other) {}
int main()
{
    Chess d;
    f(d);
} 
```

我正在阅读“thinking in c++”第 14 章——不会自动继承的函数。上面的代码片段是 Eckel 给出的一个例子。埃克尔说：

> “由于所有这些关于重写处理对象创建的函数的规则，自动类型转换运算符是继承的，乍一看似乎有点奇怪。但也不是太不合理——如果 Game 中有足够的碎片来制作一个 Other 对象，这些片段仍然存在于从 Game 派生的任何东西中，并且类型转换运算符仍然有效（即使您实际上可能想要重新定义它）。”

我不明白 Eckel 想说什么。谁能更详细地解释一下？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T17:52:31.020

他是说，与其他类似的事情不同，类型转换运算符*是*由派生类自动继承的。

他关于为什么这种行为是合理的论点是，如果你可以`Other`从 a 构造一个`Game`，你也可以`Other`从任何“是 a”的东西`Game`（即派生类）构造一个。

# css - 选项卡式导航任何滑块

> ID：15177527
> 
> 赞同：0
> 
> 时间：2013-03-02T17:48:59.407
> 
> 标签：css

我在我的网站上安装了任何滑块，我试图让导航像这样被标记：http: [//www.echappee-laine.fr/](http://www.echappee-laine.fr/)

我更新了 CSS 以制作标签，但我正在努力理解出了什么问题，因为 1）链接没有覆盖整个框，2）现在我已经完成了导航不是反应灵敏。( [http://beta.harvest-express.com](http://beta.harvest-express.com) )

有什么想法吗？

```
/* Navigation buttons, default state */
.anythingSlider .anythingControls ul a.cur, div.anythingSlider .anythingControls ul a {
    background: #777;
    color: #000;
}

/* Navigation buttons, active state */
.anythingSlider.activeSlider .anythingControls ul a.cur, 
div.anythingSlider.activeSlider .anythingControls ul a {
    background-color: #7C9127;
}

/* Navigation Links */
.anythingSlider .anythingControls { 
    position:absolute; 
    top:0; 
    left:0px; 
    list-style:none; 
    padding:0; 
    margin:0; 
    width:235px; 
    z-index: 20; 
}

.anythingSlider .anythingControls ul {
    margin: 0; 
    padding: 0; 
    float: left; 
}

.anythingSlider .anythingControls ul li { 
    display: block; 
    height: 75px; 
    width: 235px; 
    border:1px solid #ccc; 
    background-image: url(.../transparant.png);
}

.anythingSlider .anythingControls ul a {
    font: 11px/18px Georgia, Serif;
    display: inline-block;
    padding: 2px 8px;
    text-decoration: none;
    line-height: 75px;
    background-image: url(../images/default.png);
    background-position: center -288px ;
    background-repeat: repeat-x;
    text-align: center;
    outline: 0; 
}

.anythingSlider .anythingControls ul a:hover {
    background-image: none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:40:02.030

> 1）链接不覆盖整个盒子

您已`display: inline-block`设置`a`标签；除非您有特定原因需要这样做，否则我会将其更改为`display: block`允许链接扩展以填充包含的`li`. 或者，您可以在`width: 100%`该规则中添加一个。

> 2）现在我已经完成了导航没有响应

`anythingControls`您在div上设置了 235px 的显式宽度。

# mongodb - 从 ReferenceMany 字段中查找对象数组中的特定对象

> ID：15177528
> 
> 赞同：1
> 
> 时间：2013-03-02T17:49:00.437
> 
> 标签：mongodb, symfony, doctrine-orm, doctrine

我在教义手册中找不到如何进行非常简单的查询。我不知道如何使用 MongoDb 管理相当于 SQL“JOIN ...”的内容。

```
abstract class Topic
{
    /**
     * @MongoDB\Id
     */
    protected $id;
}

abstract class Message
{
    /**
     * @MongoDB\Id
     */
    protected $id;

    /**
     * @MongoDB\Date
     */
    protected $date;

    /**
     * @MongoDB\ReferenceOne(targetDocument="Topic")
     */
    protected $topic;
}

abstract class User
{
    /**
     * @MongoDB\Id
     */
    protected $id;

    /**
     * @MongoDB\ReferenceMany(targetDocument="Message")
     */
    protected $messages;
} 
```

我有一个用户 ID 和一个主题 ID。我想要：
1) 查找来自用户的最新消息
2) 查找来自用户的关于该主题的最新消息

$dm->find('User', $id)->getMessages() 给了我一个“PersistentCollection”
$dm->find('User', $id)->getMessages()->getValues() 给了我消息数组，但是我必须使用 PHP 循环，我确信有一种方法可以创建一个查询来做到这一点......

我应该使用 map 还是 reduce ？

有人能帮我吗 ？谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T07:06:37.673

首先，您必须修复您的数据库架构：

一条消息可以属于多个用户？

通常消息只能有一个作者，所以我将更改消息文档以存储作者`User id`：

```
class Message
{
    /**
     * @MongoDB\ReferenceOne(targetDocument="User")
     */
     protected $author;

     //Othe methods...
} 
```

* * *

**然后查找来自用户的最新消息：**

```
class User {

     /**
     * @ReferenceOne(
     *      targetDocument="Message",
     *      mappedBy="author",
     *      sort={"date"="desc"}
     * )
     */
     protected $lastMessage;

     //Other methods...
} 
```

* * *

**并查找有关某个主题的最新消息：**

```
class User {

     /**
     * @ReferenceOne(
     *      targetDocument="Message",
     *      mappedBy="author",
     *      criteria={"topic" : "sport"}
     *      sort={"date"="desc"}
     * )
     */
     protected $lastMessageAboutSport

     //Other methods...
} 
```

更多信息：[Doctrine ODM Complex References Guide](http://docs.doctrine-project.org/projects/doctrine-mongodb-odm/en/latest/reference/complex-references.html)

# python - 在 Python 中使用正则表达式处理类似字符以打印不同内容时遇到问题

> ID：15177532
> 
> 赞同：0
> 
> 时间：2013-03-02T17:49:22.880
> 
> 标签：python, regex, string

我有单个字母 b、c、d.... 我使用字典和正则表达式库中的 re.sub 和 multiple_replace 函数替换了随机单词。所以，b = 书，c= 厨师，d= dook，等等。

但是，如果重复出现 bb、cc 或 dd ......我希望能够让这些字母打印出其他内容，而不是所有双字母都相当于单个单词，例如 bb= blah、cc = blah , dd= blah 后跟他们的字母。所以 bb=blahb，cc=blahc，dd=blahd。

我怎样才能做到这一点？

我试过了：

```
print multiple_replace(dict, re.sub(r'([bcdfghjklmnpqrstvwxyz])\1', r'science\1', text,   flags = re.I)) 
```

其中 dict 是包含单词 b= book、c= cook、d=dook 等的字典。

并且 re.sub 函数包括除元音之外的所有双字母，将替换为单词 science 加上它们的字母。文本表示我想要转换为字典中的字符串替换的输入字符串。

所以，我希望输出为 bb =scienceb, cc=sciencec 但我目前遇到的问题是，而不是打印我想要的字符串“science”。它打印出字典中找到的单词 science 的字符串替换。因此，例如“s”：“sook”，“c”：“cook”，“i”：“i”，“n”：“nook”，

所以它会打印出任何双字母单词，它将在我的文本字符串中用sookcookiecooknooke 替换它。这是为什么？我该如何解决？

如果我感到困惑，请告诉我。非常感谢！

编辑：

这是我正在使用的代码：

```
import re 

def multiple_replace(dict, text): 
    # Create a regular expression  from the dictionary keys
    regex = re.compile("(%s)" % "|".join(map(re.escape, dict.keys())))
    # For each match, look-up corresponding value in dictionary
    return regex.sub(lambda mo: dict[mo.string[mo.start():mo.end()]], text) 

if __name__ == "__main__": 

    text = "This is my first regex python example yahooa yahoouuee bbbiirdd"

    dict = {
        "a" : "a", 
        "b" : "book",
        "c" : "cook",
        "d" : "dook",
        "e" : "e", 
        "f" : "fook",
        "g" : "gook",
        "h" : "hook",
        "i" : "i",
        "j" : "jook", 
        "k" : "kook",
        "l" : "look",
        "m" : "mook",
        "n" : "nook",
        "o" : "o",
        "p" : "pook",
        "q" : "qook",
        "r" : "rook",
        "s" : "sook",
        "t" : "took",
        "u" : "u",
        "v" : "vook",
        "w" : "wook",
        "x" : "xook",
        "y" : "yook",
        "z" : "zook",
    } 

    print multiple_replace(dict, re.sub(r'([bcdfghjklmnpqrstvwxyz])\1', r'science\1', text, flags = re.I)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T21:18:44.777

您的代码将其中的双字母替换为`text`和`"science"`字母，然后将字符串传递给该字符串`multiple_replace`，然后将每个单个字母（包括其中的字母）`"science"`替换为其对应的字典值。

进行替换的更好方法是将回调传递给`sub`并使用匹配双字母或单字母的正则表达式。回调将确定匹配的内容并返回相应的替换。

如果您想坚持使用已有的代码，防止字母`"science"`被替换的一种快速方法是将正则表达式更改`multiple_replace`为

```
regex = re.compile("science|(?<!science)(%s)" % "|".join(map(re.escape, dict.keys()))) 
```

并添加`"science" : "science",`到`dict`.

这将意味着`"science"`替换为`"science"`，而否定的后视`(?<!science)`将防止其后面的字母被替换。

以上虽然不是解决您问题的好方法。如果你幸运的话，比我更熟悉 python 的人会提供一个更好的。

*进一步评论，并调整 eyquem 的解决方案*

```
import re

def multiple_replace(dict, text):

    def repl(match):
        single, double = match.groups()
        if double:
            return 'science' + single
        else:
            return dict[single] if single in dict else single

    return re.sub(r'([bcdfghj-np-tv-z])(\1)?', repl, text, flags=re.I)    

if __name__ == "__main__":     
    text = "This is my d's first try at cing, yahooa yahoouuee bbbiirdd"   
    dict = { "b" : "blah", "c" : "cook", "d" : "dog" }   

    print multiple_replace(dict, text)
    # This is my dog's first try at cooking, yahooa yahoouuee sciencebblahiirscienced 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:49:59.070

的输出`"This is my first ...`不能
`Thookisook isook mookyook fookirooksooktook`...`像你写的那样，
但是`Tookhookisook isook mookyook fookirooksooktook ...`

以下代码根据您的解释完成这项工作。
不需要字典。

```
import re 

if __name__ == "__main__":

    def repl(ma):
        g1,g2 = ma.groups()
        if g2:
            return 'science' + g2
        else:
            return g1 + 'ook'

    print '------------ 1 ----------------------'
    text = "This is my first regex python example yahooa yahoouuee bbbiirdd"
    print text,'\n'
    wanted = ('Tookhookisook isook mookyook fookirooksooktook '
              'rookegookexook pookyooktookhookonook exookamookpooklooke '
              'yookahookooa '
              'yookahookoouuee '
              'sciencebbookiirookscienced')
    print 'wanted == %s' % wanted

    res = re.sub(r'([bcdfghj-np-tv-z])(\1?)',
                 repl,
                 text,
                 flags = re.I)
    print '\nres == %s' % res
    print 'res==wanted  : ',res==wanted

    print '------------ 2 ----------------------'
    print 'bbbiirdd'
    wanted = 'sciencebbookiirookscienced'
    print 'wanted == %s' % wanted
    res = re.sub(r'([bcdfghj-np-tv-z])(\1?)',
                                  repl,
                                  'bbbiirdd',
                                  flags = re.I)
    print '\nres == %s' % res
    print 'res==wanted  : ',res==wanted 
```

# c# - 文本块中与索引无关的字符比较

> ID：15177533
> 
> 赞同：0
> 
> 时间：2013-03-02T17:49:38.143
> 
> 标签：c#, string, algorithm

我有以下任务：开发一个程序，其中有一块应该由用户输入的示例文本。用户在测试期间所做的任何拼写错误都会被注册。基本上我可以将每个输入的字符与基于插入符号索引的示例字符进行比较输入的位置。但是在这种“幼稚”的方法中有一个重要的流程——如果用户错误地输入了比整个字符串更多的字母，或者在字符串之间插入了比应有的更多的空格，在这种情况下，有其余的比较将是错误的，因为额外的错误插入添加了索引偏移量。我考虑过设计某种解析器，其中每个字符串（甚至是 char ）都被标记化并且比较是“按字符”而不是“索引明智”。但在我看来，对于这样的任务来说，这似乎是一种矫枉过正。我想获得对可能有助于解决此类问题的现有算法的参考。

另外，我不确定这个问题是否更符合“程序员”网站的精神，所以我也把它贴在那里。

**更新**

我忘记提及的另一个重要细节是，必须对每个输入进行评估，而不是在任务结束时进行评估，因为它包括打字时间记录等......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:21:46.233

如果用户正在重新键入现有文本，那么它应该像对简单文本（一个字符代表一个字母/数字等）进行基于索引的比较一样简单，或者您可以使用 StringInfo.GetTextElementEnumerator 作为下面的示例。

如果您要让用户先输入文本，然后检查犯了多少错误，您可以使用 Levenshtein 距离（请参阅此处的实现和解释： http: [//www.dotnetperls.com/levenshtein](http://www.dotnetperls.com/levenshtein)）。Levenshtein 距离本质上是使一个字符串看起来像另一个字符串所需的编辑量。

请注意，如果您的任务是支持 unicode 与组合字符和代理对（其中需要 2 个或更多字符来表示一个字母），那么实现在技术上将是不完整的。在后一种情况下，您可以修改该实现以使用 StringInfo.GetTextElementEnumerator 来生成和比较文本元素，如下所示：

```
using System;
using System.Collections.Generic;
using System.Globalization;

/// <summary>
///     Contains approximate string matching
/// </summary>
internal static class LevenshteinDistance
{
    /// <summary>
    ///     Compute the distance between two strings using text elements.
    /// </summary>
    public static int ComputeByTextElements(string s, string t) {
        string[] strA = GetTextElements(s),
                 strB = GetTextElements(t);

        int n = strA.Length;
        int m = strB.Length;
        var d = new int[n + 1,m + 1];

        // Step 1
        if (n == 0) {
            return m;
        }

        if (m == 0) {
            return n;
        }

        // Step 2
        for (int i = 0; i <= n; d[i, 0] = i++) {}

        for (int j = 0; j <= m; d[0, j] = j++) {}

        // Step 3
        for (int i = 1; i <= n; i++) {
            //Step 4
            for (int j = 1; j <= m; j++) {
                // Step 5
                int cost = (strB[j - 1] == strA[i - 1]) ? 0 : 1;

                // Step 6
                d[i, j] = Math.Min(
                    Math.Min(d[i - 1, j] + 1, d[i, j - 1] + 1),
                    d[i - 1, j - 1] + cost);
            }
        }
        // Step 7
        return d[n, m];
    }

    private static string[] GetTextElements(string str) {
        if (string.IsNullOrEmpty(str)) {
            return new string[] {};
        }

        var result = new List<string>();

        var enumerator = StringInfo.GetTextElementEnumerator(str);

        while (enumerator.MoveNext()) {
            result.Add(enumerator.Current.ToString());
        }

        return result.ToArray();
    }
} 
```

另请注意，上述解决方案区分大小写，因此如果您需要不区分大小写的 Levenshtein 距离计算，您可能希望将输入全部设为大写或小写。

* * *

**关于您的编辑**

我不会满足于基于（字符）索引的比较，因为它没有考虑组合字符和代理对。我将建立一个文本元素数组，表示要输入的文本，然后每次击键创建一个数组（或子集，通过一些缓存实现进行比较以优化速度）并比较它们。

# android - 我的项目总是强制关闭

> ID：15177538
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:50:12.013
> 
> 标签：android

这是代码...

这是给出主要问题的第一堂课.. package com.turtle;

```
import com.turtle.R;

import android.app.Activity;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.text.InputType;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.ToggleButton;

public class Question extends Activity{

    protected static final String Level1 = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.question);

        Button chkButton = (Button) findViewById(R.id.bresult);
        final EditText input = (EditText) findViewById(R.id.etext);
        final TextView tvresult = (TextView) findViewById(R.id.tvresult2);

        chkButton.setOnClickListener(new View.OnClickListener() {

            @Override
            // TODO Auto-generated method stub
            public void onClick(View v) {
                String answer = "Marianas Trench";
                String answer2 = "marianas trench";
                String answer3 = "MARIANAS TRENCH";

                Bundle b = new Bundle();
                b.putString("ANSWER", answer);

                String check = input.getText().toString();
                if (check.contentEquals(answer)){

                      b.putString("ANSWER", answer);

                      Intent intObj = new Intent(Question.this, Level1.class);
                      intObj.putExtras(b);
                      startActivity(intObj);

                    }else if (check.contentEquals(answer2)){

                      b.putString("ANSWER", answer);

                      Intent intObj = new Intent(Question.this, Level1.class);
                      intObj.putExtras(b);

                      startActivity(intObj);

                    }else if (check.contentEquals(answer3)){

                      b.putString("ANSWER", answer);

                      Intent intObj = new Intent(Question.this, Level1.class);
                      intObj.putExtras(b);

                    startActivity(intObj);

                    }else{

                    }

    }
        });
    }
} 
```

这是包含图像按钮的第二类，如果单击，它将进入问题页面....

```
package com.turtle;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;

public class Level1 extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
this.setContentView(R.layout.level1);   

ImageButton btl1 = (ImageButton) findViewById(R.id.l1);
btl1.setOnClickListener (new View.OnClickListener()
{
    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        Intent myIntent= new Intent("com.turtleexploration.QUESTION");
        startActivity(myIntent);

    }
});
ImageButton btl2 = (ImageButton) findViewById(R.id.l2);
btl2.setOnClickListener (new View.OnClickListener()
{
    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        Intent myIntent= new Intent("com.turtleexploration.QUESTION2");
        startActivity(myIntent);

    }
});
ImageButton btBacklvl1 = (ImageButton) findViewById(R.id.backlvl1);
btBacklvl1.setOnClickListener (new View.OnClickListener()
{
    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        Intent myIntent= new Intent("com.turtleexploration.NEWGAME");
        startActivity(myIntent);

    }
});

    }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:25:39.010

我假设你的第一个活动开始了，然后当你点击你的按钮时你就有了一个 FC。

您可能还有其他问题，但您已将 Level1 声明为 String 对象。如果您不使用它，请将其删除或重命名。在 Intent 构造函数中 Level1.class 应该引用您的第二个活动的类。

```
 Intent intObj = new Intent(Question.this, Level1.class); 
```

最后确保您已在清单中声明了 Level1 活动。

# haskell - 无法在 Windows 上安装 cairo haskell 绑定

> ID：15177540
> 
> 赞同：4
> 
> 时间：2013-03-02T17:50:17.923
> 
> 标签：haskell, cabal, cairo

我正在尝试在 Windows 7 上安装 cairo-0.12.4 Haskell 包。我首先下载并解压缩 Gtk+2 并将其 bin 子目录添加到 PATH。然后我尝试使用额外的库运行 cabal，包括：

```
cabal --extra-lib-dirs="d:\Program Files (x86)\Gtk+\lib" 
      --extra-include-dirs="d:\Program Files (x86)\Gtk+\include" install 
```

但我收到以下错误

```
 Reading available packages...
 Choosing modular solver.
 Resolving dependencies...
 Ready to install cairo-0.12.4
 Waiting for install task to finish...
 Extracting
 C:\Users\abailly\AppData\Roaming\cabal\packages\hackage.haskell.org\cairo\0.12.4\cairo-0.12.4.tar.gz
 to C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368...
 Updating cairo.cabal with the latest revision from the index.
 creating
 C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup
 creating
 C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist
 creating
 C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup
 d:\Program Files (x86)\Haskell Platform\2012.2.0.0\bin\ghc.exe --make C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-
 0.12.4\Setup.hs -o C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup\setup.exe -odir C:\Users\abailly\
 AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup -hidir C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.
 12.4\dist\setup -i -iC:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4 -package Cabal-1.14.0
 [1 of 2] Compiling SetupWrapper     ( C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\SetupWrapper.hs, C:\Users
 \abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup\SetupWrapper.o )
 [2 of 2] Compiling Main             ( C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\Setup.hs, C:\Users\abaill
 y\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup\Main.o )
 Linking C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup\setup.exe ...
 C:\Users\abailly\AppData\Local\Temp\cairo-0.12.4-2368\cairo-0.12.4\dist\setup\setup.exe
 configure --verbose=2 --ghc --prefix=C:\Users\abailly\AppData\Roaming\cabal
 --user --flags=cairo_svg --flags=cairo_ps --flags=cairo_pdf
 --extra-include-dirs=D:\Program Files (x86)\Gtk+\include
 --extra-lib-dirs=D:\Program Files (x86)\Gtk+\lib --constraint=mtl ==2.1.2
 --constraint=bytestring ==0.9.2.1 --constraint=base ==4.5.0.0
 --constraint=array ==0.4.0.0 --disable-tests --disable-benchmarks
 [1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist\setup-wrapper\Gtk2HsSetup.o )
 [2 of 2] Compiling Main             ( SetupMain.hs, dist\setup-wrapper\Main.o )
 Linking dist/setup-wrapper\setup.exe ...
 Configuring cairo-0.12.4...
 Flags chosen: cairo_svg=True, cairo_ps=True, cairo_pdf=True
 Dependency array ==0.4.0.0: using array-0.4.0.0
 Dependency base ==4.5.0.0: using base-4.5.0.0
 Dependency bytestring ==0.9.2.1: using bytestring-0.9.2.1
 Dependency mtl ==2.1.2: using mtl-2.1.2
 Dependency cairo-pdf -any: using version 1.10.2
 Dependency cairo-ps -any: using version 1.10.2
 Dependency cairo-svg -any: using version 1.10.2
 Dependency cairo >=1.2.0: using version 1.10.2
 Using Cabal-1.14.0 compiled by ghc-7.4
 Using compiler: ghc-7.4.1
 Using install prefix: C:\Users\abailly\AppData\Roaming\cabal
 Binaries installed in: C:\Users\abailly\AppData\Roaming\cabal\bin
 Libraries installed in:
 C:\Users\abailly\AppData\Roaming\cabal\cairo-0.12.4\ghc-7.4.1
 Private binaries installed in:
 C:\Users\abailly\AppData\Roaming\cabal\cairo-0.12.4
 Data files installed in: C:\Users\abailly\AppData\Roaming\cabal\cairo-0.12.4
 Documentation installed in:
 C:\Users\abailly\AppData\Roaming\cabal\doc\cairo-0.12.4
 Using alex version 3.0.1 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\lib\extralibs\bin\alex.exe
 Using ar found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\mingw\bin\ar.exe
 No c2hs found
 Using cpphs version 1.16 found on system at:
 c:\Users\abailly\AppData\Roaming\cabal\bin\cpphs.exe
 No ffihugs found
 Using gcc version 4.5.2 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\mingw\bin\gcc.exe
 Using ghc version 7.4.1 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\bin\ghc.exe
 Using ghc-pkg version 7.4.1 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\bin\ghc-pkg.exe
 No greencard found
 Using gtk2hsC2hs version 0.13.6 found on system at:
 c:\Users\abailly\AppData\Roaming\cabal\bin\gtk2hsC2hs.exe
 Using gtk2hsHookGenerator found on system at:
 c:\Users\abailly\AppData\Roaming\cabal\bin\gtk2hsHookGenerator.exe
 Using gtk2hsTypeGen found on system at:
 c:\Users\abailly\AppData\Roaming\cabal\bin\gtk2hsTypeGen.exe
 Using haddock version 2.10.0 found on system at: d:\Program Files
 (x86)\Haskell Platform\2012.2.0.0\bin\haddock.exe
 Using happy version 1.18.9 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\lib\extralibs\bin\happy.exe
 No hmake found
 Using hpc version 0.6 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\bin\hpc.exe
 Using hsc2hs version 0.67 found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\bin\hsc2hs.exe
 Using hscolour version 1.20 found on system at:
 c:\Users\abailly\AppData\Roaming\cabal\bin\HsColour.exe
 No hugs found
 No jhc found
 Using ld found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\mingw\bin\ld.exe
 No lhc found
 No lhc-pkg found
 No nhc98 found
 Using pkg-config version 0.26 found on system at: d:\Program Files
 (x86)\Gtk+\bin\pkg-config.exe
 Using ranlib found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\mingw\bin\ranlib.exe
 Using strip found on system at: d:\Program Files (x86)\Haskell
 Platform\2012.2.0.0\mingw\bin\strip.exe
 Using tar found on system at: D:\Program Files (x86)\Git\bin\tar.exe
 No uhc found
 d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo-pdf
 d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo-ps
 d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo-svg
 d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo
 setup.exe: Missing dependencies on foreign libraries:
 * Missing C libraries: z, cairo
 This problem can usually be solved by installing the system packages that
 provide these libraries (you may need the "-dev" versions). If the libraries
 are already installed but in a non-standard location then you can use the
 flags --extra-include-dirs= and --extra-lib-dirs= to specify where they are.
 Failed to install cairo-0.12.4
 cabal.exe: Error: some packages failed to install:
 Chart-0.16 depends on cairo-0.12.4 which failed to install.
 cairo-0.12.4 failed during the configure step. The exception was:
 ExitFailure 1
 splot-0.3.8 depends on cairo-0.12.4 which failed to install. 
```

当我尝试直接安装 cairo 时，我得到以下信息：

```
d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo-pdf
d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo-ps
d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo-svg
d:\Program Files (x86)\Gtk+\bin\pkg-config.exe --modversion cairo
setup.exe: Missing dependencies on foreign libraries:
* Missing C libraries: z, cairo
This problem can usually be solved by installing the system packages that
provide these libraries (you may need the "-dev" versions). If the libraries
are already installed but in a non-standard location then you can use the
flags --extra-include-dirs= and --extra-lib-dirs= to specify where they are.
Failed to install cairo-0.12.4
World file is already up to date.
cabal.exe: Error: some packages failed to install:
cairo-0.12.4 failed during the configure step. The exception was:
ExitFailure 1 
```

我一无所知...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:16:58.490

如果您阅读错误消息：

```
* Missing C libraries: z, cairo 
```

它是说您需要为库 libz 和 cairo 安装库（和头文件）。在 *nix 系统上，这通常意味着只需`-dev`使用包管理器安装这些包的版本。在 Windows 上，我假设您会下载库的源版本并安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-22T16:40:29.483

我遇到了这个问题。就我而言，这是 64 位 ghc 和 32 位 cairo dll 之间的不匹配

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-03T07:35:48.920

我把 Gtk+ 库移到了`D:\soft\gtk+\`，一切运行良好。Gtk+ 的路径包含似乎没有被 cabal/ghc 正确解释的空间，尽管我双引号引用了它：

```
--extra-lib-dirs="d:\Program Files (x86)\Gtk+\lib" 
```

*解决方案*：将 gtk+ 放在一个没有空间的位置。

**更新**：现在，它无法安装 Chart-0.16 并出现更神秘的错误：

```
Loading package Win32-2.2.2.0 ... linking ... done.
Loading package array-0.4.0.0 ... linking ... done.
Loading package deepseq-1.3.0.0 ... linking ... done.
Loading package old-locale-1.0.0.4 ... linking ... done.
Loading package time-1.4 ... linking ... done.
Loading package containers-0.4.2.1 ... linking ... done.
Loading package transformers-0.3.0.0 ... linking ... done.
Loading package data-accessor-0.2.2.3 ... linking ... done.
Loading package pretty-1.1.1.0 ... linking ... done.
Loading package template-haskell ... linking ... done.
Loading package utility-ht-0.0.8 ... linking ... done.
Loading package data-accessor-template-0.2.1.10 ... linking ... done.
Loading package colour-2.3.3 ... linking ... done.
Loading package mtl-2.1.2 ... linking ... done.
*** gcc:
"D:\Program Files (x86)\Haskell Platform\2012.2.0.0\lib/../mingw/bin/gcc.exe" "-fno-stack-protector" "-Wl,--hash-size=31" "-Wl,--r
educe-memory-overheads" "-LC:\Users\abailly\AppData\Roaming\cabal\cairo-0.12.4\ghc-7.4.1" "-Ld:/soft/Gtk+/lib" "--print-file-name"
 "libz.dll"
*** gcc:
"D:\Program Files (x86)\Haskell Platform\2012.2.0.0\lib/../mingw/bin/gcc.exe" "-fno-stack-protector" "-Wl,--hash-size=31" "-Wl,--r
educe-memory-overheads" "-LC:\Users\abailly\AppData\Roaming\cabal\cairo-0.12.4\ghc-7.4.1" "-Ld:/soft/Gtk+/lib" "--print-file-name"
 "libcairo-2.dll"
Loading package cairo-0.12.4 ... d:\Program Files (x86)\Haskell Platform\2012.2.0.0\bin\ghc.exe returned
ExitFailure 1
Failed to install Chart-0.16
cabal.exe: Error: some packages failed to install:
Chart-0.16 failed during the building phase. The exception was:
ExitFailure 1
splot-0.3.8 depends on Chart-0.16 which failed to install. 
```

我怀疑这是由于链接错误，因为当我执行以下命令时编译运行良好，这是 cabal 在调试模式下输出的内容：

```
 "D:\\Program Files (x86)\\Haskell Platform\\2012.2.0.0\\bin\\ghc.exe"
 "--make" "-v" "-fbuilding-cabal-package" "-O" "-odir" "dist\\build"
 "-hidir" "dist\\build" "-stubdir" "dist\\build" "-i" "-idist\\build"
 "-i." "-idist\\build\\autogen" "-Idist\\build\\autogen"
 "-Idist\\build" "-optP-include"
 "-optPdist\\build\\autogen\\cabal_macros.h" "-package-name"
 "Chart-0.16" "-hide-all-packages" "-package-conf"
 "dist\\package.conf.inplace" "-package-id"
 "array-0.4.0.0-3cf1bc3f5cd0078adea24752c18081b9" "-package-id"
 "base-4.5.0.0-597748f6f53a7442bcae283373264bb6" "-package-id"
 "cairo-0.12.4-f04021ea456c901e8d05395a31f7a861" "-package-id"
 "colour-2.3.3-4eaa610bb6d825a7334e1b3de448f6c0" "-package-id"
 "data-accessor-0.2.2.3-5477c48e3478339fdff299c536a033c6" "-package-id"
 "data-accessor-template-0.2.1.10-28ee96821fd908880f3a49417c4da548"
 "-package-id" "mtl-2.1.2-7ec8bbada2af74b49c6e4aeea2889fdc"
 "-package-id" "old-locale-1.0.0.4-29bd50ed2bb4a20928338f52e4ab1b71"
 "-package-id" "time-1.4-01d7bf22d87e70510fe9ee4c4434b3ab"
 "-XHaskell98" "Graphics.Rendering.Chart"
 "Graphics.Rendering.Chart.Types" "Graphics.Rendering.Chart.Renderable"
 "Graphics.Rendering.Chart.Axis"
 "Graphics.Rendering.Chart.Axis.Floating"
 "Graphics.Rendering.Chart.Axis.Indexed"
 "Graphics.Rendering.Chart.Axis.Int"
 "Graphics.Rendering.Chart.Axis.LocalTime"
 "Graphics.Rendering.Chart.Axis.Types"
 "Graphics.Rendering.Chart.Axis.Unit" "Graphics.Rendering.Chart.Layout"
 "Graphics.Rendering.Chart.Legend" "Graphics.Rendering.Chart.Simple"
 "Graphics.Rendering.Chart.Simple.Internal"
 "Graphics.Rendering.Chart.Grid" "Graphics.Rendering.Chart.Plot"
 "Graphics.Rendering.Chart.Plot.Types"
 "Graphics.Rendering.Chart.Plot.Annotation"
 "Graphics.Rendering.Chart.Plot.AreaSpots"
 "Graphics.Rendering.Chart.Plot.Bars"
 "Graphics.Rendering.Chart.Plot.Candle"
 "Graphics.Rendering.Chart.Plot.ErrBars"
 "Graphics.Rendering.Chart.Plot.FillBetween"
 "Graphics.Rendering.Chart.Plot.Hidden"
 "Graphics.Rendering.Chart.Plot.Lines"
 "Graphics.Rendering.Chart.Plot.Pie"
 "Graphics.Rendering.Chart.Plot.Points"
 "Graphics.Rendering.Chart.SparkLine" "-hide-package" "monads-tf" 
```

我更纳闷了……

**更新（2）**：当我运行`cabal install > out 2>&1`它成功！

# android - Android：一个应用程序创建了多少个活动？

> ID：15177545
> 
> 赞同：0
> 
> 时间：2013-03-02T17:50:44.323
> 
> 标签：android, eclipse, android-activity, emulation

您好，感谢您的帮助，

我有第三方应用程序的代码，我相信，它创建的不仅仅是一个 Activity，而且可能不仅仅是同一个 Activity 的一个实例。

请在使用 Eclipse 的模拟器上，我如何了解/监控在应用程序执行期间在应用程序中创建了哪些活动？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:09:59.930

您可以使用命令行：

```
adb shell dumpsys activity 
```

此命令将打印每个任务中的活动历史记录。这样您就可以看到创建了哪些活动。[检查这个问题。](https://stackoverflow.com/questions/2442713/view-the-tasks-activity-stack)

PS如果你真的有源代码，你为什么不仔细查看并找到所有开始新活动的地方？您可以在每个活动的 onCreate 处添加日志输出...问题不清楚）

# php - 搜索php中的查询为空

> ID：15177546
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:50:45.073
> 
> 标签：php, mysql

我尝试使用选择选项进行此搜索，以选择哪个站点或所有站点。当我单击所有站点时，它可以工作。当我单击“4shared”时，它可以工作。但是当我点击“putlocker”时，我明白了。查询为空。

我真的不知道我做错了什么

```
<?php 
include"inc/connect.php"; 
include"inc/functions.php";
error_reporting(0);
if(isset($_GET['s']) && $_GET['s'] != ""){
    $s = $_GET['s'];
    $w = $_GET['w'];

    if($w == 'all'){
        $sql = "SELECT * FROM result WHERE (`name` LIKE '%".$s."%') OR (`keywords` LIKE '%".$s."%')";
    }else if($w == 'Sockshare'){
        $sql = "SELECT * FROM result WHERE website='Sockshare' AND (`name` LIKE '%".$s."%') OR (`keywords` LIKE '%".$s."%')";
    }else if($w == 'Putlocker'){
        $sql == "SELECT * FROM result WHERE website='Putlocker' AND (`name` LIKE '%".$s."%') OR (`keywords` LIKE '%".$s."%')";
    }else if($w == '4shared'){
        $sql = "SELECT * FROM result WHERE website='4shared' AND (`name` LIKE '%".$s."%') OR (`keywords` LIKE '%".$s."%')";
    }else if($w == 'Rapidshare'){
        $sql = "SELECT * FROM result WHERE website='Rapidshare' AND (`name` LIKE '%".$s."%') OR (`keywords` LIKE '%".$s."%')";
    }

    $query = mysql_query($sql) or die(mysql_error());

    $count = mysql_num_rows($query);

    if($count > 1){
        while($row = mysql_fetch_array($query)){
            $name = $row["name"];
            $details = $row["details"];
            $url = $row["url"];

            $results .= '
            <div id="stitle">' .$name. '</div>
            <div id="details">' .$details. '</div>
            <div id="url"><a target="_blank" href="' .$url. '">' .$url. '</a></div>';
        }
        } else {
            $results = 'Nothing found!';
        }
}
?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Findrfile.com - Putlocker Search | Sockshare search | Mediafire Search</title>
<link href='http://fonts.googleapis.com/css?family=Orienta' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="main.css" />
</head>

<body>
<script type="text/javascript" src="js/jquery-1.7.2.js"></script>
<script type="text/javascript" src="js/main.js"></script>
<?php include"header.php"; ?>
<div id="spacer"></div>
<?php include"litsearch.php"; ?>
<div id="nuresults"><span class="blue"><?php echo $count; ?> Results found</span></div>
<div id="spacerx"></div>
<div id="wrapper">
<div id="spacerx"></div>
<div id="content">
<?php echo $results; ?>
<div class="clear"></div>

</div>
<div id="spacerx"></div>
<div id="spacer"></div>
</div>
<?php include"footer.php"; ?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:04:52.703

您已经`$sql == "SELECT * FROM result WHERE website='Putlocker' AND (name LIKE '%".$s."%') OR (keyword LIKE '%".$s."%')";`注意到`==`，这是一个比较运算符，因此它不会设置值，`$sql` 我认为这可能是您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:57:21.627

改变

```
while($row = mysql_fetch_array($query)){ 
```

至

```
while($row = mysql_fetch_assoc($query)){ 
```

因为您使用关联数组。

```
 $name = $row["name"];
        $details = $row["details"];
        $url = $row["url"]; 
```

如果你想使用

```
while($row = mysql_fetch_array($query)){ 
```

喜欢：

```
 $name = $row[0];
    $details = $row[1];
    $url = $row[2]; 
```

我错了吗？

还：

您检查是否设置了 $_GET["s"] 但不检查 $_GET["w"]

# java - 在 Java 中最接近 C# 内部修改的东西是什么？

> ID：15177554
> 
> 赞同：2
> 
> 时间：2013-03-02T17:51:19.687
> 
> 标签：java, .net, jar, obfuscation, access-modifiers

.NET 有一个包内部作用域，它使模块（.dll 文件）可以看到一个类型，Java 中最接近的等价物是什么？默认可见性仅与包名称有关，并不关心类是如何捆绑的。

我知道 Java 语言本身没有什么比这更好的了，但是有没有工具可以模拟这个与构建系统和 IDE:s 配合得很好？例如，是否有一个混淆工具可以隐藏使用特定注释注释的所有类，以及常见 Java IDE 支持的工具：s 以确保此类类不被其模块之外的任何东西使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:54:21.687

Java 还没有类似的东西。

您可以将这些类放在名为“internal”的包中，并将其从 javadoc 中排除。

# c# - 自定义 SimpleMembership

> ID：15177556
> 
> 赞同：4
> 
> 时间：2013-03-02T17:51:23.850
> 
> 标签：c#, asp.net-mvc-4, entity-framework-5, simplemembership

在阅读了这篇关于向 UserProfile 表添加自定义数据的好[BLOG](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/)之后，我想将其更改为 UserProfile 表应该存储默认数据的方式 + 另一个存储所有附加信息的类。

使用 Internet 应用程序模板创建新项目后，我创建了两个类：

学生.cs

```
[Table("Student")]
public class Student
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public virtual int StudentId { get; set; }
    public virtual string Name { get; set; }
    public virtual string Surname { get; set; }
    public virtual int UserId { get; set; }
} 
```

用户配置文件.cs

```
[Table("UserProfile")]
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public virtual int StudentId { get; set; }
    public virtual Student Student { get; set; }
} 
```

另外，我已经从 AccountModel.cs 中删除了 UserProfile 定义。我的数据库上下文类如下所示：

MvcLoginDb.cs

```
public class MvcLoginDb : DbContext
{
    public MvcLoginDb()
        : base("DefaultConnection")
    {
    }

    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<Student> Students { get; set; }
} 
```

再次，我从 AccountModel.cs 中删除了 db 上下文定义。

在 Package-Manager-Console 里面我写过：

```
Enable-Migrations 
```

我的 Configuration.cs 看起来像这样：

```
internal sealed class Configuration : DbMigrationsConfiguration<MvcLogin.Models.MvcLoginDb>
{
    public Configuration()
    {
        AutomaticMigrationsEnabled = true;
    }

    protected override void Seed(MvcLogin.Models.MvcLoginDb context)
    {
        WebSecurity.InitializeDatabaseConnection("DefaultConnection", "UserProfile", "UserId", "UserName", autoCreateTables: true);

        if (!WebSecurity.UserExists("banana"))
            WebSecurity.CreateUserAndAccount(
                "banana",
                "password",
                new
                {
                   Student = new Student { Name = "Asdf", Surname = "Ggjk" }
                });

    }
} 
```

这是将学生数据添加为创建新班级的**想法**，但这种方法不起作用，因为在运行*Update-Database -Verbose*后我收到错误： **从对象类型 MvcLogin.Models.Student 到已知托管的不存在映射提供者本机类型。**

任何人都可以解释为什么我会收到这个错误，我应该使用不同的方法在不同的表中存储额外的数据吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T21:35:07.743

我在同样的问题上挣扎了很多。关键是让 UserProfile 类和您的 Student 类之间的关系正确。它必须是一对一的关系才能正常工作。

这是我的解决方案：

个人.cs

```
public class Person
{
    [Key]
    public int Id { get; set; }
    public string Name { get; set; }
    /* and more fields here */

    public virtual UserProfile UserProfile { get; set; }
} 
```

用户配置文件.cs

```
public class UserProfile
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int UserId { get; set; }
    public string UserName { get; set; }

    public virtual Person Person { get; set; }
} 
```

MyDbContext.cs

```
public class MyDbContext : DbContext
{
    public DbSet<Person> Person { get; set; }
    public DbSet<UserProfile> UserProfile { get; set; }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
     modelBuilder.Entity<UserProfile>()
                    .HasRequired(u => u.Person)
                    .WithOptional(p => p.UserProfile)
                    .Map(m => m.MapKey("PersonId"));
    }
} 
```

但是，我也很难使用 WebSecurity.CreateUserAndAccount 方法创建用户。所以我最终使用 Entity Framework 创建了我的 Person 对象，然后使用成员资格提供程序方法创建了用户帐户：

AccountRepository.cs

```
 public Person CreatePerson(string name, string username) {

     Person person = new Person { Name = name };
     _dbContext.Person.add(person);
     _dbContext.SaveChanges();

     var membership = (SimpleMembershipProvider)Membership.Provider;
     membership.CreateUserAndAccount(
         model.UserName, 
         createRandomPassword(), 
         new Dictionary<string, object>{ {"PersonId" , person.Id}}
     );

 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-19T20:41:04.987

HenningJ，我正在寻找同样问题的答案。不幸的是（我相信你知道）你这样做的问题是没有 SQL 事务。您的 SaveChanges() 或 CreateUserAndAccount() 可能会失败，从而使您的用户数据库处于无效状态。如果失败，您需要回滚。

我仍在寻找最终答案，但我会发布我最终使用的任何解决方案。希望避免编写自定义会员提供程序（再次！），但开始认为它会更快。

# ruby - 这是在 Ruby 中保持连接池的首选方式吗

> ID：15177561
> 
> 赞同：3
> 
> 时间：2013-03-02T17:51:39.623
> 
> 标签：ruby, mongodb, module

我在 ruby​​ 方面不是很有经验（每天都用 java 编码），我正在尝试找到“Ruby 方式”来保留连接池之类的东西。我有一个带有多个线程的独立 Ruby 应用程序，我想出了类似下面的东西。

请注意，`MongoClient`为 Mongo 提供的原生 ruby​​ 驱动程序在内部维护连接池，所以我所需要的只是能够保留一个`MongoClient`周围的实例

```
require 'mongo'

module MongoPool

  # module instance var to ensures only one exists
  @mongo = nil

  def self.lazy_create
    @mongo ||= Mongo::MongoClient.new('localhost', 27017, :pool_size => 5, :timeout => 5)
  end

  # when getting connection lazily create pool by assigning to @mongo only if nil
  def connection
    MongoPool.lazy_create
  end

end

class PeopleRepository

  include MongoPool

  def random_person
    coll = connection['test']['people']
    coll.find_one
  end

end

# usage
PeopleRepository.new.find_one 
```

我知道这是可行的（检查了在多次调用`object_id`中`@mongo`保持不变），但这是保留事物的首选方式吗？

可能有多个存储库，因此每个存储库都可以包含`MongoPool`和使用其连接。上述解决方案有什么缺点吗？还有其他我应该注意的方法吗？

**注意：问题更多是关于如何以 Ruby 方式做事，而不是关于如何做一般的事情（因为我得到了它的工作）。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T23:41:56.260

您实际上并不需要另一个 gem 来执行此操作，实际上 Mongoid 的驱动程序 (Moped) 还不支持连接池。

与在 rails 中使用应用程序级常量的建议类似，您只需在无头应用程序中使用类变量，以便您的 MongoClient 实例在应用程序基类的所有调用中都是相同的单个对象/池实例。

例如，您可以执行以下操作：

```
require 'mongo'

class MyApplication
  include Mongo

  # creates a single class instance, sets pool size but won't connect until used (lazy)
  @@client = MongoClient.new('localhost', 27017, :pool_size => 5, :connect => false)

  def do_something
    @@client['my_db']['my_collection].insert({ "foo" => "bar"})
  end
end 
```

简单而且非常直接。您在上面使用的模块方法不是必需的。

您提到了 Torquebox，所以我假设您正在使用 JRuby 并让 Torquebox 为您管理应用程序的线程池。

确保您正在运行 1.8.3 或更高版本的 mongo ruby​​ 驱动程序，其中包括一些主要修复和改进，以便在这种繁重的设置下运行。我们解决了一些线程安全问题并大大提高了连接池中的并发性。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T10:04:38.077

假设您使用的是 Rails，我会这样做：

```
# config/initializers/mongo.rb
MONGODB = Mongo::MongoClient.new('localhost', 27017, :pool_size => 5, :timeout => 5) 
```

当您使用诸如 mongomapper 之类的库时，可能有一些方法可以配置池并透明地使用它。

看看这里的 mongo 库：[http ://railscasts.com/episodes/194-mongodb-and-mongomapper](http://railscasts.com/episodes/194-mongodb-and-mongomapper)

# python - Pygame - 表面淡入/淡出

> ID：15177568
> 
> 赞同：4
> 
> 时间：2013-03-02T17:52:48.830
> 
> 标签：python, sdl, pygame

我正在编写一个应用程序，显示 PyGame 窗口上出现的消息列表；为了让事情更漂亮，我决定为文本添加一个很好的淡入/淡出效果。

问题是：SDL 只允许每个像素或每个表面的 alpha，而不是两者。所以我写了一个函数，它根据想要的“层”不透明度重新计算像素 alpha，但它当然非常、非常、非常慢（即使在核心 i7 @2.7GHz 上，它也会下降到 ~10FPS）：

```
def apply_alpha(surface, alpha):
    for x in xrange(surface.get_width()):
        for y in xrange(surface.get_height()):
            color = surface.get_at((x, y))
            color.a = int(color.a * alpha)
            surface.set_at((x, y), color)
    return surface 
```

完整示例：[https](https://gist.github.com/rshk/5072173) ://gist.github.com/rshk/5072173 （不是真正的应用程序，只是一个相关示例）

有什么办法可以加快速度吗？我看到可以直接访问底层缓冲区，这避免了`Color`对象的实例化，但是以这种方式更新 alpha 似乎更慢，调用`BufferProxy.write()`方法..

也许使用硬件加速的东西会有所帮助？我认为这里的理想是在将表面粘贴到背景上的同时应用 alpha，但我在这类事情上不是很专家..

**注意：**更改文本颜色不是机会，因为背景可能并不总是黑色..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T18:26:15.347

由于这可能作为某人未来的参考，我按照@Xymotech 的建议做了：创建另一个与渲染文本大小相同的表面，并在该表面上应用 alpha，使用`.set_alpha()`.

此处更新版本：[https ://gist.github.com/rshk/5072375](https://gist.github.com/rshk/5072375)

# ruby-on-rails - 在视图中嵌入实时 Rails 控制台

> ID：15177572
> 
> 赞同：10
> 
> 时间：2013-03-02T17:53:29.837
> 
> 标签：ruby-on-rails

最近，我一直在使用 better_errors gem，我发现 live shell 功能（基本上是嵌入在您的视图中的 Rails 控制台）非常有用。我希望能够访问这种可用于调试/诊断目的的实时 shell，即使我没有错误。这将是很好的嵌入到我的应用程序控制器中并限制管理员访问的东西，这样我就可以在登台或生产服务器环境中使用它。

是否有任何其他类似的工具，或者可能有一种方法可以从 better_errors 中去除实时 shell 并将其嵌入到我的视图中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T21:58:55.603

你看过[pry](https://rubygems.org/gems/pry)吗？从技术上讲，它不像 better_errors 那样在浏览器中打开控制台，但它的功能相同。基本上，您只需`binding.pry`在代码中的任何位置添加，甚至在您的视图中，以在代码中创建一个断点，让您在该时间点运行您想要的任何东西。

还有一个关于如何使用它的 railscast [http://railscasts.com/episodes/280-pry-with-rails](http://railscasts.com/episodes/280-pry-with-rails)

作为替代方案，您应该能够在代码中的任何地方抛出错误，这将在代码中的该点显示 better_errors 页面。

除了打开控制台之外，我不确定在暂存/生产中执行此操作的任何方法。无论如何，您可能永远都不想在生产环境中授予对代码的这种级别的访问权限。此时，任何可以访问该页面的人都可以完全访问数据库。即使它仅限于开发人员，它似乎也存在潜在的安全风险。

# jquery - 将我的 jQuery Mobile 网站转换为原生应用程序

> ID：15177573
> 
> 赞同：2
> 
> 时间：2013-03-02T17:53:34.670
> 
> 标签：jquery, mobile, native

我已经使用 jQuery Mobile 开发了一个移动网站，我想将其转换为原生应用程序（Android 但如果 iOS 也可以的话，那就更好了）。我的移动网站有 HTML、JavaScript 和 PHP 来连接数据库并使用 MySQL 查询。

我的可能性是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:01:53.570

PhoneGap 是一个免费的开源框架，允许您使用标准化的 Web API 为您关心的平台创建移动应用程序。下载**[Phonegap](http://phonegap.com/download/)**。

请点击此**[链接](https://build.phonegap.com/)**了解更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T18:01:22.530

好吧，有很多选择......我已经根据受欢迎程度对它们进行了排序，尽管大多数人都不知道 PhoneGap 的任何其他选项。

## 1 -[电话间隙](http://phonegap.com/)：

> PhoneGap 是一个免费的开源框架，允许您使用标准化的 Web API 为您关心的平台创建移动应用程序。

## 2 -[电晕](http://coronalabs.com)：

> Corona SDK 为 iOS、Android、Kindle 和 Nook 构建了丰富的移动应用程序。在很短的时间内构建高质量的移动应用程序。

## 3 -[加速器](http://www.appcelerator.com/)：

> Appcelerator 是唯一让企业能够创建、交付和分析其移动应用程序的移动优先平台。

# java - 为什么调用失败（）在使用 JUnit 的 Java 类中编译

> ID：15177575
> 
> 赞同：4
> 
> 时间：2013-03-02T17:53:57.437
> 
> 标签：java, unit-testing, netbeans, junit

这似乎不应该编译和运行，因为`Object`没有`fail()`方法。在编译时发生了一些奇怪的事情吗？（我正在使用 NetBeans）：

```
import static org.junit.Assert.*;
import org.junit.Test;

public class Test {

    @Test
    public void hello() {
        fail();

    }
} 
```

问候，

圭多

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-02T17:55:21.867

您的`import static`行将类的所有静态成员`Assert`导入编译单元的静态命名空间。`fail()`调用指的是`Assert.fail()`。

您所遇到的关于 where 定义的困惑`fail()`正是我通常不建议使用`import static`. 在我自己的代码中，我通常导入类并使用它来调用静态方法：

```
import org.junit.Assert;
import org.junit.Test;

public class Test {

    @Test
    public void hello() {
        Assert.fail();
    }
} 
```

更具可读性。

然而，正如[JB Nizet 指出的那样](https://stackoverflow.com/questions/15177575/why-does-a-call-to-fail-compile-in-a-java-class-using-junit#comment21379023_15177591)`import static`，使用JUnit 的断言是相当普遍的做法。当您编写和阅读足够多的 JUnit 测试时，知道断言方法的来源将成为第二天性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-02T17:57:55.120

这是完全正确的，它将运行和编译——我已经使用 eclipse 进行了检查。原因是静态导入：

```
import static org.junit.Assert.*; 
```

从 org.junit.Assert 类中添加所有静态字段或方法 - 因此包括**fail()**方法。

然而，可能出现的问题是您的测试类的名称与注释的名称相同

```
@Test 
```

因此它会产生一个错误：

> 导入 org.junit.Test 与同一文件中定义的类型冲突

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-18T09:17:20.450

出现此错误是因为您的类名和注释名称相同（Test）。将您的类名更改为“Test1”或Test以外的其他名称。

# background - 在固定背景上重复图像，Cocos2D？

> ID：15177576
> 
> 赞同：0
> 
> 时间：2013-03-02T17:54:03.723
> 
> 标签：background, cocos2d-iphone

我是 Cocos2d 的新手，有谁知道如何创建一个固定屏幕（无滚动）的背景，并在整个屏幕大小上重复一个小图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T17:23:20.837

您最好的选择（更少的内存和时间密集型）是根据您所说的小图像创建更大的背景图像。它在photoshop中相当容易做到。请遵循以下说明：

1.  在 Photoshop 中打开基础图像。
2.  选择图像周围的区域。
3.  单击编辑->定义图案并保存新图案
4.  创建新图像（320x480 纵向 iPhone、640x960 纵向视网膜）
5.  单击编辑->填充并选择图案，然后选择您创建的图案。
6.  保存图像并将其添加为游戏中的背景。

# html - HTML中的快速完成？

> ID：15177579
> 
> 赞同：1
> 
> 时间：2013-03-02T17:54:07.683
> 
> 标签：html

我一直在 CSSDeck.com 上观看一些“codecast”，我经常看到人们输入这样的内容：`ul>li*7>a`快速创建大量 HTML。该代码将生成：

```
<ul>
  <li><a href=""></a></li>
  <li><a href=""></a></li>
  <li><a href=""></a></li>
  <li><a href=""></a></li>
  <li><a href=""></a></li>
  <li><a href=""></a></li>
  <li><a href=""></a></li>
</ul> 
```

如上所示：[http ://cssdeck.com/labs/creating-sweet-3d-pagination](http://cssdeck.com/labs/creating-sweet-3d-pagination)

这是什么插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:59:27.370

它曾经被称为 Zen Coding，但现在被称为[Emmet](http://docs.emmet.io/)。

大多数编辑器都有插件，包括 Sublime Text 2（如果你还没有排序的话，我会推荐它！）

对于 Sublime Text，如果您使用的是[Package Control](http://wbond.net/sublime_packages/package_control)，这很简单`package install emmet`。

# android - Android MediaControler 不适用于来自 url 的视频

> ID：15177580
> 
> 赞同：2
> 
> 时间：2013-03-02T17:54:17.293
> 
> 标签：android, seekbar, mediacontroller

我有视频播放器，视频来自网址。它有效 - 我可以开始和停止播放视频。我希望有可能在 MediaController 中移动进度。我已经设置了 MediaController，但它不起作用。当我使用文件中的视频时，我可以寻找/移动视频进度，但是使用来自 url 的视频它不起作用。有我的代码：

```
videoFrame = (FrameLayout) findViewById(R.id.videoField);
mediaController = new MediaController(VideoPage.this);
videoPlayer = new VideoView(context);
videoFrame.addView(videoPlayer);
videoPlayer.setVideoURI(Uri.parse(url));
mediaController.setMediaPlayer(videoPlayer);
videoPlayer.setMediaController(mediaController);
videoPlayer.requestFocus();
videoPlayer.start(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T12:25:32.820

您必须检查是否可以向前搜索：

```
if(videoPlayer.canSeekForward()){
   ...
} 
```

当您获得视频流的持续时间时，这是可能的，但某些流没有持续时间，例如，如果您流式传输电视内容或直播流。

```
int duration = videoPlayer.getDuration() 
```

# file-upload - 从本地主机上传服务器上的 umbraco 站点

> ID：15177582
> 
> 赞同：0
> 
> 时间：2013-03-02T17:54:29.397
> 
> 标签：file-upload, content-management-system, hosting, localhost, umbraco

我已经使用 Umbraco 成功创建了站点，现在是时候将其上传到托管服务器了。我已经搜索并获得了一个相同的付费产品。我不想使用它。

有没有人尝试在本地开发 Umbraco 网站，然后将其上传到服务器上？

如果是，那么请帮助我这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:26:22.200

首先，我从本地 IIS 网站运行 umbraco 安装。然后我为那个网站（和我的源控制）设置了我的视觉工作室解决方案。然后我工作，直到我达到测试版，然后我通过这个过程进行部署：

1.  Ftp 到删除网站并复制整个网站（我实际上使用 Beyond compare）。
2.  使用管理工作室连接到我的本地数据库并创建一个 .bak 文件。
3.  将 .bak 文件上传到数据库服务器。
4.  恢复那个数据库
5.  查看 web.config 中的连接字符串

然后我就差不多完成了。

一旦我“活着”并拥有不想丢失的内容，当我想在网站上工作时，我会通过 .bak 文件恢复实时数据库，然后进行更改。它们通常包括数据库更改，因为模式基本上在数据库中。我记下了我所做的所有操作。一旦我的更改准备就绪，我在更新文件时手动复制实时站点上的更改。

这非常痛苦，但我尝试了像快递和其他类似的解决方案，但它们对于我发现的生产来说不够可靠。手动是我目前看到的唯一无风险的方式。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T20:02:13.877

是的，这种情况一直都在发生。使用 FTP 将您的本地安装复制到您的网络服务器，修改 web.config 以指向正确的数据库，您的网站应该可以正常运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-03T20:53:19.563

我确信有更优雅的解决方案，点击次数更少，但这是我在 azure 网站上使用 sql 的方法，不确定您使用的是什么托管/数据库：
1）在 azure 上创建一个空数据库，登录名和用户相同我的本地数据库。
2）在连接到我的数据库的 azure 上创建一个空站点。
3) 下载发布配置文件。[4) 使用Sql Azure Migration Wizard](http://sqlazuremw.codeplex.com/)
首次上传数据库。 5) 将发布配置文件导入并使用[WebMatrix](http://www.microsoft.com/web/webmatrix/)上传站点。 6) 此后，我使用 WebMatrix 部署站点和数据库。

WebMatrix 使用 WebDeploy 或 FTP，如果您愿意，可以通过 IIS 和 FTP 使用 WebDeploy。

# matlab - 如何计算针对 SNR 的 4-D 单元图？

> ID：15177584
> 
> 赞同：0
> 
> 时间：2013-03-02T17:54:36.227
> 
> 标签：matlab

我有一个大小为 C 的单元格数组`(10 21 1000 21)`。我可以使用`cell2mat`或`Cmeans`将单元格 C 转换为双精度值或数值。鉴于我有一个 SNR 的大小`(1 21)`，我如何绘制 SNR 与 C 的关系图。Matlab 一直给我错误，说`"data may not have more than 2 dimensions"`我什么时候做`plot(SNR,C)`，但给出了一条直线`plot(SNR,Cmeans(9,:,1000,21))`。

# python - 使用 pyPdf 合并非标准 PDF

> ID：15177587
> 
> 赞同：2
> 
> 时间：2013-03-02T17:54:44.930
> 
> 标签：python, pdf, python-2.6, pypdf

我想将几个 PDF 文件合并到一个 PDF 文档中。事实证明，输入文件并不完全符合标准。EOF 标记后跟一些附加信息：

```
>>
startxref
1994481
%%EOF

%%PPIRoute: 4 
```

显然，这导致 pyPdf[给了我一个例外](https://github.com/mfenniak/pyPdf/blob/trunk/pyPdf/pdf.py#L707 "pyPdf 错误的起源")：

```
pyPdf.utils.PdfReadError: EOF marker not found 
```

现在的问题是：我该怎么办？我可能会打开每个文件，去掉最后两行并将其保存，然后再将它们放入 pyPdf。但是，我不太喜欢这个主意。也许那里有更好的选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T19:52:53.440

我建议在 pdf.py 脚本中更改类`read()`方法的开头：`PdfFileReader`

```
 def read(self, stream):
        # start at the end:
        stream.seek(-1, 2)
        line = ''
        while not line:
            line = self.readNextEndLine(stream)
        if line[:5] != "%%EOF":
            raise utils.PdfReadError, "EOF marker not found"

    ... etc 
```

至：

```
 def read(self, stream):
        # start at the end:
        stream.seek(-1, 2)
        line = ''
        # read stream backwards while watching for end-of-file marker
        while line[:5] != "%%EOF":
            line = self.readNextEndLine(stream)

    ... etc 
```

在我看来，原始代码并没有真正执行 Adob​​e 的[PDF 1.3 参考](http://partners.adobe.com/public/developer/en/pdf/PDFReference13.pdf)文档中第 3.4.4 节“文件预告片”（第 628 页）所暗示的内容（斜体是我的）：

> Acrobat 查看器*只*要求%%EOF 标记出现在文件最后 1024 字节的某个位置。

换句话说，在`"%%EOF"`标记之后文件的物理结尾之前有其他东西是可以的。我建议的更改试图适应这一点，并使其忽略标记之后可能附加到文件末尾的任何其他内容，而不是引发异常（但是它不需要`"%%EOF"`在最后 1K 字节中作为规范说，尽管可以添加检查）。这也意味着您尝试合并的文件实际上可能符合规范。

**更新：**

这是一个还要求`"%%EOF"`标记位于最后 1024 个字节内的版本：

```
def read(self, stream):
    # start at the end
    stream.seek(-1, os.SEEK_END)
    last1K = stream.tell() - 1024 + 1 # offset of last 1024 bytes of stream

    # read stream backwards while watching for end-of-file marker
    line = ''
    while line[:5] != "%%EOF":
        line = self.readNextEndLine(stream)
        if stream.tell() < last1K:
            raise utils.PdfReadError, "EOF marker not found"

    ... etc 
```

# matlab - 在matlab中绘制一个带有双y轴的堆积条形图

> ID：15177597
> 
> 赞同：0
> 
> 时间：2013-03-02T17:56:12.427
> 
> 标签：matlab, charts, plot

嗨，我正在尝试在 matlab 中绘制一个带有双 y 轴的堆积条形图。我可以自己绘制堆叠或双 y，但不能一起绘制！

到目前为止我所拥有的是

```
Industry = [436.8 508 388 351 273]';
Domestic = [778.05 762 777 632 517]';
Road_Transport = [1092 921 1061 1041 702]';

  figure;
 bar(1:5,[Industry Domestic Road_Transport],0.5,'stack'); 
```

现在我想在上面的每一个中添加第 6 列，称为“Total”

```
 Total = [1958 3466 4808]'; 
```

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:37:54.947

MATLAB 不允许您绘制只有 1 列数据的条形图。所以你通过用 0 填充它来欺骗它。

我的代码

```
fun = @(x,y) bar(x, y, 0.5, 'stack')
plotyy(1:5,[Industry Domestic Road_Transport],5:6,[zeros(3,1) Total]', fun) 
```

第一个条形图从 1 到 5，第二个从 5 到 6，但您看不到`Total`图中的第 5 列。

# ruby-on-rails - Rails：如果模型文件更改，后卫不使用宙斯

> ID：15177599
> 
> 赞同：1
> 
> 时间：2013-03-02T17:56:20.363
> 
> 标签：ruby-on-rails, testing, guard, zeus

尝试将 guard-rspec 与 zeus 一起使用：

```
# Gemfile (the meaning part)
group :development, :test do
  gem 'rspec-rails'
  gem 'guard-rspec'
  gem 'guard-cucumber'
end

group :test do
  gem 'cucumber-rails', require: false
  gem 'capybara'
  gem 'shoulda'
end

# Guardfile
guard 'rspec', zeus: true, bundler: false do
  # watch...
end 
```

所有宝石都有最新版本。宙斯和守卫顺利开始，没有任何问题。

当开始保护所有以宙斯速度运行的规格时。但是当更改 rails 模型文件保护运行相应规范时，与没有 zeus 相同。奇怪和令人困惑的事情：在更改模型规范时，助手规范甚至助手本身的守卫再次快速运行相应的规范。无论文件启动器如何，Cucumber 功能总是快速运行。

任何意见将是有益的

# json - JPA区别Windows/Unix系统？

> ID：15177601
> 
> 赞同：0
> 
> 时间：2013-03-02T17:56:26.533
> 
> 标签：json, rest, jpa

出于开发目的，我使用的是 Windows 环境（Eclipse / Jboss） 我有一个 userDAO，它提供了通过名字和姓氏检索 UserEntity 的方法。此查询在开发环境中运行良好。但是在 Unix 环境中，我得到一个`javax.persistence.NoResultException: No entity found for query`异常。

详细情况：正在调用一个 REST 服务，其中包含许多数据以及名字和姓氏。需要使用此参数来获取实际的 userEntity。（对于 Unix 上的任何用户，它都失败了。）

所以，其余的服务正在这样做：

```
@Consumes("application/json")
@Produces("application/json")
public String create(String plaindata) { 
```

JSONObject 数据 = 新 JSONObject(plaindata);

```
String ownerFirstname = data.getString("userFirstname"); //Yes userX, not ownerX

String ownerLastname = data.getString("userLastname");

UserEntity owner = null;
    try {
        owner = userDataService.getUserDetailsByName(ownerFirstname, ownerLastname);
    } catch (Exception e) {
        throw new Exception("Found zero possible users for the given name '" + ownerFirstname + " " + ownerLastname
                + "'. Cannot invoke process.", e);
    }
...
} 
```

userDataService 看起来（剥离）如下：

```
private static String GET_USER_BY_FIRSTNAME_LASTNAME_QUERY = "SELECT * FROM " + DBConstants.USER_TABLE_NAME 
        + " user WHERE user.FIRST_NAME = :firstnameValue AND user.LAST_NAME = :lastnameValue";

public UserEntity getUserDetailsByName(String firstname, String lastname) {
    Query query = em.createNativeQuery(GET_USER_BY_FIRSTNAME_LASTNAME_QUERY, UserEntity.class);

    query.setParameter("firstnameValue", firstname);
    query.setParameter("lastnameValue", lastname);

    UserEntity u =  (UserEntity) query.getSingleResult();
    return u;
} 
```

DBConstants 包含表名，如：

```
public static final String DATATABLE_PREFIX = "pre_";
public static final String USER_TABLE_NAME = DATATABLE_PREFIX+"user_entity"; 
```

mySQL 中的列名是大写的，所以一切*看起来*都是正确的。

这适用于 Windows 环境，但不适用于 Unix 环境:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:21:45.397

```
String ownerFirstname = data.getString("userFirstname").trim(); 
String ownerLastname = data.getString("userLastname").trim(); 
```

它有效......奇怪的事情 - windows 和 unix 在这个问题上可能有什么区别？（异常记录绝对没有空格）

# php - 通过代码模拟用户浏览

> ID：15177604
> 
> 赞同：0
> 
> 时间：2013-03-02T17:57:14.480
> 
> 标签：php, python, linux, selenium

我需要像 selenium 一样模拟用户浏览网页，包括加载 iframe、发出 ajax 请求等。它需要在无 GUI 的机器（linux）上运行的唯一问题。有没有一种简单的方法可以用 python 或 php 做到这一点？请不要告诉我使用 xvfb，我已经阅读过它，这是我最后的手段。我很确定应该有更简单的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T17:59:05.917

你可以在 Python 中使用[Ghost.py](http://jeanphix.me/Ghost.py/)：

```
from ghost import Ghost
ghost = Ghost()
page, extra_resources = ghost.open("http://jeanphi.fr")
assert page.http_status==200 and 'jeanphix' in ghost.content 
```

这会运行一个可以从 Python 控制的无头 Webkit 浏览器。

# c# - 无法使用正则表达式验证器验证关键字

> ID：15177614
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:58:24.033
> 
> 标签：c#, asp.net

所有..我想以 H1,H,H1TUT 格式解析来自用户的文本，
但无法使用以下表达式 [AZ][0-9][T][U][T]|[AZ]|[AZ ][0-9]|[AZ] 可能是什么故障？它允许所有期望长度为 0f 2 的字符串，如.. 它允许 H1TUT，H 但不允许 H1............

```
<asp:RegularExpressionValidator ID="RegularExpressionValidator0"  ForeColor="#6600FF" 
                        runat="server" ErrorMessage="Batch Name Should be like H,H1,H1TUT" 
                            Display="Dynamic" ControlToValidate="tbbatchname" ValidationGroup="form"
                            ValidationExpression="[A-Z][0-9][T][U][T]|[A-Z]|[A-Z][0-9]|[A-Z]">*</asp:RegularExpressionValidator> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:38:38.453

使用这个正则表达式模式：

```
([A-Z]{1}[0-9]{1}[T][U][T])|([A-Z]{1}[0-9]{1})|([A-Z]{1}) 
```

也许您可以避免使用我刚刚添加的 {1} 部分以确保安全。

编辑：这里的重点是你从寻找最长的模式开始，你可以看到我添加了`|`字符来表示`Or`逻辑。

问候，

# c# - 获取错误 Directory.Move() c#

> ID：15177617
> 
> 赞同：-1
> 
> 时间：2013-03-02T17:58:36.500
> 
> 标签：c#, directory, rename

我试图运行这段代码：

```
Directory.Move("C:\\ABC", "C:\\abc"); 
```

但我收到此错误：

> “源路径和目标路径必须不同。”

我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:00:41.880

该`Directory.Move`操作不区分大小写。

最简单的解决方案是将其移动两次，一次到临时文件夹，然后一次到正确的文件夹。

如果操作失败，最好提供一些回滚功能。

```
Directory.Move("C:\\ABC", "C:\\ABCTEMP");
try {
    Directory.Move("C:\\ABCTEMP", "C:\\abc");
} catch (IOException) {
    Directory.Move("C:\\ABCTEMP", "C:\\ABC");
} catch (UnauthorizedAccesException) {
    Directory.Move("C:\\ABCTEMP", "C:\\ABC");
} 
```

# jquery - 如何在 ajax 提交中执行 Html.ValidationSummary？

> ID：15177631
> 
> 赞同：1
> 
> 时间：2013-03-02T17:59:36.060
> 
> 标签：jquery, asp.net, asp.net-mvc, asp.net-mvc-4, jquery-validate

我不知道为什么`ValidationSummary`在我执行`Html.BeginForm`using时不工作`AJAX.submit`。

```
@model Contoso.MvcApplication.Models.Questions.MultipleChoiceQuestionTemplate

@using (Html.BeginForm("EditQuestion", "Question", FormMethod.Post, new { id = "editQuestionForm" }))
{
    @Html.ValidationSummary(true)
    @Html.EditorForModel("Questions/_MultipleChoiceQuestion")

    <p>
        <input type="submit" value="Save" />
    </p>
}

    public class MultipleChoiceQuestionTemplate : QuestionTemplate, IValidatableObject
    {
        public MultipleChoiceQuestionTemplate() { ... }

        [DisplayName("Question")]
        public string QuestionText { get; set; }
        public List<string> Choices { get; set; }

        [DisplayName("Correct Choice")]
        public int CorrectChoice { get; set; }

        public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
        {
            if (String.IsNullOrEmpty(Choices5[CorrectChoice]))
            {
                yield return new ValidationResult("ERROR");
            }
        }
    } 
```

这是我的jQuery提交功能：

```
 $("#editQuestionForm").submit(function () {
                if ($(this).valid()) {
                    $.ajax({
                        url: this.action,
                        type: this.method,
                        data: $(this).serialize(),
                        success: function (result) {
                            $('#result').html(result);
                        }
                    });
                }

                return false;
            }); 
```

但我有点东西，因为正如你在上面看到的，我已经实现`ValidatableObject`了界面，当我点击提交按钮时，当我的验证模型有错误时执行一个帖子，并且应该在`ValidationSummary`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:06:41.093

您无需担心`submit`处理程序，因为 jQuery Validate 插件已经内置了**提交事件处理程序回调函数，而这正是您*应该*放置 ajax 的地方。**

[根据 Validate plugin 的文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)，`submitHandler`回调函数是：

> “表单有效时处理实际提交的回调。获取表单作为唯一参数。替换默认提交。验证后**通过 Ajax 提交表单的正确位置**。”

试试这个代码：

```
$(document).ready(function () {

    $("#yourform").validate({
        // rules & options,
        submitHandler: function (form) {
            $.ajax({
                    url: form.action,
                    type: form.method,
                    data: $(form).serialize(),
                    success: function (result) {
                        $('#result').html(result);
                    }
            });
            return false; // blocks redirect after submission via ajax
        }
    });

}); 
```

**演示：http: [//jsfiddle.net/sx26b/](http://jsfiddle.net/sx26b/)**

# angularjs - ng-repeat 问题，它重复 n*n 次

> ID：15177632
> 
> 赞同：1
> 
> 时间：2013-03-02T17:59:36.513
> 
> 标签：angularjs

> JSON对象{“count”：4，“entities”：[{“model”：“project”，“data”：{“project”：“test1”，“startDate”：2013/03/15，“endDate”： “2013/03/31”}，“id”：1}，{“model”：“project”，“data”：{“project”：“test2”，“startDate”：2013/01/15，“endDate ": "2013/01/31"}, "id": 2}, {"model": "project", "data": {"project": "test3", "startDate": 2013/02/15, “endDate”：“2013/02/31”}，“id”：2}]，“模型”：“项目”，“方法”：“get_entities”}

我有一个表格来显示项目列表及其持续时间。在表格的左侧，我`ng-repeat`用来列出项目的名称，即`{{item.data.project}}`. 它工作正常。

在右侧，每个项目都有相应的持续时间（从开始日期到结束日期）。所以我用另一个`ng-repeat`来获取每个实体并`timeline(starDate,endDate)`用来绘制一个块。右边，每一行（每个项目）都有一个时间块，如果我有 n 个项目，它将显示 n 行，每一行都有一个时间块。但是，现在每行显示 n 个块；在一行中，它显示了所有项目的所有时间块。

```
<div class="content">
   <figure class="gantt">
      <figcaption>All Projects</figcaption>
       <aside>
        <ul class="gantt-labels" style="margin-top: 71px">
         <li class="gantt-label" ng-repeat="item in items.entities"><strong style="line-height:  35px; height: 35px">{{item.data.project}}</strong></li>
        </ul>
       </aside>
    <section class="gantt-data">
    <header>
      <ul class="gantt-months" style="width: 9150px">            
      </ul>
      <ul class="gantt-days" style="width: 9150px">            
      </ul>
    </header>

    <ul>
      <li ng-repeat="item in items.entities">
        <ul class="gantt-items" style="width: 9150px; height: 35px" >
          <li class="gantt-item" >            
            <ul class="gantt-days">
            </ul>       
          </li>          
        </ul>
      {{timeline(item.data.sDate,item.data.eDate)}}
      </li>
    </ul>

  </section>
</figure> 
```

在 JavaScript 中，我用`$(".gantt-item ul.gantt-days").append`365 个方框来表示 365 天。时间线的方法是绘制蓝色块，即项目持续时间。

```
angular.module('myApp', ['ngResource']);
 function MainCtrl($scope,$resource){
  $(document).ready(function(){
     ...
     $scope.$watch('items.entities', function(){
      for(var i = 1; i < 366; i++){
        $("header ul.gantt-days").append('<li class="gantt-day" style="width: 25px"><strong style="line-height: 35px; height: 35px">' + d.getDate() + '</strong></li>');
        d = new Date(d.getTime() + (24 * 60 * 60 * 1000));
      }
      for(var i = 1; i < 366; i++){
        $(".gantt-item ul.gantt-days").append('<li class="gantt-day" style="width: 25px"><span style="line-height: 35px; height: 35px">' + year + "-" + d.getMonth() + "-" + d.getDate() + '</span></li>');
        d = new Date(d.getTime() + (24 * 60 * 60 * 1000));
      }
    });
     ...});
$scope.timeline = function GetLength(startDate, endDate)
      {
        var firstDay = new Date(new Date().getFullYear(), 0, 1);

        var st1 = startDate.split("/");
        var dt1 = new Date(st1[2], st1[1] - 1, st1[0]);

        var st2 = endDate.split("/");
        var dt2 = new Date(st2[2], st2[1] - 1, st2[0]);

        var startPoint = ((dt1.getTime() - firstDay.getTime())/1000/60/60/24)*25;
        var length = (1+(dt2.getTime() - dt1.getTime())/1000/60/60/24)*25;
        $(".gantt-item ul.gantt-days").append('<span class="gantt-block" style="left:' + startPoint + 'px; width: ' + length + 'px; height: 27px"><strong class="gantt-block-label">Duration</strong></span>');
      }; 
```

# c - 如何制作字符数组？

> ID：15177635
> 
> 赞同：1
> 
> 时间：2013-03-02T18:00:02.657
> 
> 标签：c

我正在尝试制作一个字符数组，但我不能正确执行此操作，我不断收到警告消息：

警告：赋值从没有强制转换的指针生成整数

我想创建一个 8 列乘 4 行的数组，但是当我单步执行该数组时，编译器只给了我一个 8 个字符串的数组，这是我的代码：

```
// Array of 8 columns by 4 rows  
char GameBoardDisplay[8][4];
// 4x4 matrix that is zero filled for the moment
int GameBoardTrack [4][4];

           //Steps through the matrix one by one and places characters in array
           for ( rowtrack = 0, rowtrack2 = 0 ; rowtrack != 4 ; rowtrack++, rowtrack2++){
            for (coltrack = 0, coltrack2= 0 ; coltrack !=4 ; ++coltrack){
               if(!GameBoardTrack[rowtrack][coltrack]){

                       GameBoardDisplay[rowtrack2][coltrack2] = '_';
                       ++coltrack2;

                   if (coltrack == 3){
                       GameBoardDisplay[rowtrack2][coltrack2] = '\n';
                   }
                   else
                       {
                       GameBoardDisplay[rowtrack2][coltrack2] = ' ';
                      ++coltrack2
               }
           }
       } 
```

我是否以错误的方式思考 char GameBoardDisplay[8][4]？我认为它有 32 个位置来放置一个我可以返回并重写的字符，但由于某种原因，它只生成了一个由 8 个字符串组成的数组。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:00:54.650

`"_"`是一个字符串，由字符`'_'`和组成`'\0'`。你想要一个角色：

```
GameBoardDisplay[rowtrack2][coltrack2] = '_'; 
```

这同样适用于：

```
GameBoardDisplay[rowtrack2][coltrack2] = '\n'; 
```

和：

```
GameBoardDisplay[rowtrack2][coltrack2] = ' '; 
```

以下是*字符常量*和*字符串 litteral*的语法。

> ### C11 (n1570)，第 6.4.4.4 节字符常量
> 
> ```
> character-constant: ' c-char-sequence ' 
> ```
> 
> ### C11 (n1570)，第 6.4.5 节字符串文字
> 
> ```
> string-literal: encoding-prefixopt " s-char-sequenceopt " 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:01:53.957

`"_"`,`"\n"`用双引号括起来的所有内容都是 C 字符串文字，它的类型是`const char[]`. 要输入单个*字符*，请使用单引号/撇号，如下所示：

```
GameBoardDisplay[rowtrack2][coltrack2] = '_'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T18:12:39.283

除了这里所有关于“a”是一个字符串和“a”是一个字符和所有的答案（你也应该改变）之外，另一个问题（这可能是“警告：赋值从指针中生成整数而没有a cast") 是您在**将变量 GameBoardDisplay**声明为 2D 字符数组之后立即将其重新声明为 2D 整数数组。

你可以试试，

```
char GameBoardDisplay[8][4];
// 4x4 matrix that is zero filled for the moment
//int GameBoardDisplay [4][4];

           //Steps through the matrix one by one and places characters in array
           for ( rowtrack = 0, rowtrack2 = 0 ; rowtrack != 4 ; rowtrack++, rowtrack2++){
            for (coltrack = 0, coltrack2= 0 ; coltrack !=4 ; ++coltrack){
               if(!GameBoardTrack[rowtrack][coltrack]){

                       GameBoardDisplay[rowtrack2][coltrack2] = '_';
                       ++coltrack2;

                   if (coltrack == 3){
                       GameBoardDisplay[rowtrack2][coltrack2] = '\n';
                   }
                   else
                       {
                       GameBoardDisplay[rowtrack2][coltrack2] = ' ';
                      ++coltrack2
               }
           }
       } 
```

# perl - 从任何文件夹在 WAMP 上执行 CGI 程序

> ID：15177637
> 
> 赞同：2
> 
> 时间：2013-03-02T18:00:08.310
> 
> 标签：perl, cgi, wamp

我正在开发一个 PHP 网站，但我正在使用 Perl CGI 进行文件上传。

我已经在 WAMP 下安装了 ActivePerl。

当我正在开发站点以在 Unix 服务器上运行时，我想在本地镜像该环境，所以我想在 WAMP cgi-bin 之外执行 CGI 文件。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-01-24T11:41:27.940

我最近为 Localhost 上的 Movable Type 研究 Perl 和 CGI​​，所以我在使用 Wamp Server 设置 Perl 和 CGI​​ 方面做了几个步骤。我希望这可能有用。

**第一步：** 首先你需要从 www.wampserver.com 下载 Wamp Server 并在你的机器上安装 Wamp Server。默认安装目录是“C:\wamp”，这里我使用默认选项进行安装。要完成安装，您必须设置邮件服务器的主机名和电子邮件地址，在这里您可以再次保留默认选项。那不会有任何害处。

当前的 Wamp Server 将安装 Apache 2.2.11、PHP 5.2.9-2 + PECL、MySQL 5.1.33、SQLitemanager 和 PhpMyadmin。

**第二步：** 现在你必须从[http://www.activestate.com/activeperl/downloads](http://www.activestate.com/activeperl/downloads)下载 ActivePerl（目前是 5.10.0）并安装它。默认安装目录是“C:\Perl”，但为了简单和易用，我使用不同的目录。我在“C:\wamp\bin”中创建了一个名为“perl”的新文件夹。所以我将 Active Perl 安装在“C:\wamp\bin\perl”目录中。您需要做的下一件事是配置 Apache Web 服务器以执行 Perl 和 CGI​​ 脚本。

**Step3：** 这是这里最重要的部分。您需要编辑 Apache 配置文件。现在转到“C:\wamp\bin\apache\Apache2.2.11\conf”目录并打开“httpd.conf”文件。编辑 httpd.conf 文件，如下所示。

**1.**在 httpd.conf 中，寻找写有“”的行，在它下面几行你会发现写着“Options Indexes FollowSymLinks”的行。在与 FollowSymLinks 相同的行中添加“Includes ExecCGI”，因此它将变为：

*   选项索引 FollowSymLinks

现在变成：

*   选项索引 FollowSymLinks 包括 ExecCGI

这将在您的 www 文件夹中启用 CGI 脚本。

**2.**现在寻找“AddHandler cgi-script .cgi”这一行，这一行被注释掉了。您需要通过取消注释此行来启用此功能，以删除此行开头的 # 字符。这将为扩展名为 .cgi 的文件添加处理程序。如果您想在服务器中使用 .pl 文件扩展名，请在上述行下方添加“AddHandler cgi-script .pl”。现在您将能够执行扩展名为 .cgi 和 .pl 的 CGI 和 Perl 脚本。

**要添加的行**

1.  AddHandler cgi脚本.cgi
2.  AddHandler cgi脚本.pl

AddHandler cgi-script .cgi AddHandler cgi-script .pl

**3.**添加目录索引文件，查找“DirectoryIndex index.php index.php3 index.html index.htm”行。在这一行添加 index.cgi 和 index.pl。

**要添加的行**

**1.** DirectoryIndex index.php index.php3 index.html index.htm index.cgi index.pl

DirectoryIndex index.php index.php3 index.html index.htm index.cgi index.pl

替代方案：如果您不想浪费时间执行上述 3 个步骤，可以在此处下载编辑后的配置文件 httpd.conf。用这个替换你的apache目录中的那个。

**第 4 步：** 您的服务器现在已配置好并准备好运行 perl 和 cgi 脚本。您可能需要做的下一件事是将 perl 配置为使用 mysql 数据库。您需要下载并安装 mysql 驱动程序以通过 perl 脚本启用数据库连接。您必须从 ActivePerl 软件包存储库中获取驱动程序。但是，默认的 ActivePerl 包存储库中没有 mysql 驱动程序模块。因此，您需要添加额外的存储库并从该存储库安装。请按照以下步骤操作：

转到 DOS 命令提示符并键入“<strong>PPM”。现在键入“<strong>安装 DBI”> ENTER。安装完成后，输入“<strong>Install DBD-mysql” > ENTER。你现在应该完成了。

我们将不得不修改我们所有 cgi 文件的一些设置，我们必须修改所有你得到的 cgi 文件，因为它们通常会指向 perl，比如“<strong>#!/usr/bin/perl”，但我们没有Windows 中的约定。更改只是在 CGI 文件的第一行，所以应该很容易。将 cgi 文件中对 perl 的任何引用更改为当前位置。请记住，如果您在 perl 安装期间没有启用环境变量路径，则必须提供完整路径，例如“<strong>c:\perl\bin\perl.exe”，但如果您在环境变量中提供了路径，您可以简单地执行“<strong>perl.exe”，因此我们的大多数 cgi 文件的第一行都是“<strong>#!perl.exe -w”，但没有引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T20:04:36.910

根据您的网络服务器，在 W(in) 上它通常是 IIS。

您可以让任何虚拟文件夹指向您的 perl-script 文件夹。然后您需要将 c:\Perl\bin\perl.exe "%s" %s 设置为该文件夹的 *.pl 处理程序。有关详细信息，请参见例如[http://community.activestate.com/forum-topic/configuring-perl-iis-7-0](http://community.activestate.com/forum-topic/configuring-perl-iis-7-0)。（在第 7 项下，我认为按是是正确的做法）。要创建虚拟文件夹，请打开 Internet 信息服务 (IIS) 管理器，然后向下浏览到默认网站，然后右键单击并添加虚拟目录。您可能还需要为 iis 安装一些模块（在 windows 控制面板 -> 应用程序和功能 -> 打开功能 -> iis-> www -> Appl-> CGI 等下）

如果 Apache 添加 *.cgi 或 *.pl 作为处理程序，如[http://www.thesitewizard.com/archive/addcgitoapache.shtml中所述](http://www.thesitewizard.com/archive/addcgitoapache.shtml)

最好的祝愿！

# bigdata - 在 GATE 中使用 TermRaider 插件

> ID：15177648
> 
> 赞同：0
> 
> 时间：2013-03-02T18:01:14.503
> 
> 标签：bigdata, data-extraction, gate

我想将 TermRaider 功能与 GATE 一起使用。有人可以发布一些示例代码以在 java 类中加载和使用此资源。我尝试了以下但失败了。

```
 Gate.getCreoleRegister().registerDirectories(new URL("file:///D:/misc_workspace/gate-7.1-build4485-SRC/plugins/TermRaider"));

    ProcessingResource termRaider = (ProcessingResource) Factory.
    createResource("gate.termraider.TermRaiderEnglish",Factory.newFeatureMap());

Exception:
gate.termraider.TermRaiderEnglish cannot be cast to gate.ProcessingResource 
```

谁能建议我应该如何进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T21:35:05.503

TermRaider 系统不是一个单一的 PR，它是一个完整的应用程序（实际上是一个 Groovy `ScriptableController`）。资源只是使该`TermraiderEnglish`应用程序出现在 GATE Developer GUI 的“现成应用程序”菜单中的一个挂钩。

在嵌入式代码中，您可以使用`PersistenceManager`

```
File termRaiderPlugin = new File(Gate.getPluginsHome(), "TermRaider");
File gappFile = new File(new File(termRaiderPlugin, "applications"),
            "termraider-eng.gapp");
CorpusController trApp = (CorpusController)PersistenceManager.loadObjectFromFile(
    gappFile); 
```

当您在语料库上运行应用程序时，它会创建三个“术语库”LR 的新实例，其中包含有关新发现的术语的信息。vanilla 应用程序实际上是为 GUI 而不是嵌入式使用而设计的，因此它不会在任何有用的地方存储对这些新 LR 的引用——您必须查询`CreoleRegister`它们才能找到它们。您可能更喜欢制作自己的应用程序副本并调整控制脚本以将术语库实例存储为（比如说）上的功能`Corpus`，方法是添加类似

```
corpus.features.tfidfTermbank = termbank0
corpus.features.annotationTermbank = termbank1
corpus.features.hyponymyTermbank = termbank2 
```

到控制脚本的末尾。然后，您可以通过`corpus.getFeatures().get("tfidfTermbank")`etc在您的 Java 代码中访问它们。

由于这些 Termbank 类本身就是`TermRaider`插件的一部分，因此您可能希望将其添加`gate-termraider.jar`到您的主应用程序类路径中，而不是通过`GateClassLoader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-05T04:26:48.513

```
import gate.Corpus;
import gate.CorpusController;
import gate.Document;
import gate.Factory;
import gate.FeatureMap;
import gate.Gate;
import gate.termraider.bank.AbstractTermbank;
import gate.termraider.output.CsvGenerator;
import gate.util.GateException;
import gate.util.Out;
import gate.util.persistence.PersistenceManager;

import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.net.URLDecoder;

public class termraider {
    public static void main(String[] args) throws IOException, GateException {

        // initialise the GATE library
        Out.prln("Initialising GATE...");
        Gate.init();

        // Initialize GATE
        File gateHome = Gate.getGateHome();
        Out.prln("...GATE initialised");

        //Load TermRaider plugin
        File termRaiderPlugin = new File(Gate.getPluginsHome(), "TermRaider");
        File gappFile = new File(new File(termRaiderPlugin, "applications"),
                   "termraider-eng.gapp");
        CorpusController trApp = (CorpusController)PersistenceManager.loadObjectFromFile(gappFile);
        System.out.println("TermRaider loaded successfully!!!");

    //Loading txt files from a folder path
        Corpus corpus = (Corpus) Factory.createResource("gate.corpora.CorpusImpl");
        //String dirname = "Desktop/Gate_corpus/About Us/New Folder";
        String dirname = "Desktop/GermanHPFCompetition/termRaider";
        File f1 = new File(dirname);
        String s[] = f1.list();
        for (int i=0; i < s.length; i++) {
            String path = dirname + "/" + s[i];
            path = URLDecoder.decode(path, "utf-8");
            path = new File(path).getPath();
            URL u=new URL("file:\\\\\\"+path);

          FeatureMap params = Factory.newFeatureMap();
          params.put("sourceUrl", u);
          params.put("preserveOriginalContent", new Boolean(true));
          params.put("collectRepositioningInfo", new Boolean(true));
          //Out.prln("Creating doc for " + u);
          Document doc = (Document)
          Factory.createResource("gate.corpora.DocumentImpl", params);
          corpus.add(doc);
        } // for each file in the folder

        //running TermRaider plugin with the corpus
        trApp.init();
        trApp.setCorpus(corpus);
        trApp.execute();
        Corpus output_corpus = (Corpus) Factory.createResource("gate.corpora.CorpusImpl");
        output_corpus=trApp.getCorpus();
        System.out.println("TermRaider executed successfully!!!");

        //Creating csv files as output
        AbstractTermbank tb1 = (AbstractTermbank) output_corpus.getFeatures().get("tfidfTermbank");
        AbstractTermbank tb2 = (AbstractTermbank) output_corpus.getFeatures().get("hyponymyTermbank");
        AbstractTermbank tb3 = (AbstractTermbank) output_corpus.getFeatures().get("annotationTermbank");

        System.out.println(tb1);
        System.out.println(tb2);
        System.out.println(tb3);

        CsvGenerator generator = new CsvGenerator();
        File outputFile1 = new File("Desktop/GermanHPFCompetition/termRaider/tfidfTermbank.csv");
        File outputFile2 = new File("Desktop/GermanHPFCompetition/termRaider/hyponymyTermbank.csv");
        File outputFile3 = new File("Desktop/GermanHPFCompeti`enter code here`tion/termRaider/annotationTermbank.csv");
        double threshold1 = 0;
        double threshold2 = 0;
        double threshold3 = 0;
        generator.generateAndSaveCsv(tb1, threshold1, outputFile1);
        generator.generateAndSaveCsv(tb2, threshold2, outputFile2);
        generator.generateAndSaveCsv(tb3, threshold3, outputFile3);
        System.out.println("CSV files created!!!");

    }//end of main

}//end of class 
```

# javascript - jQuery 切换 - 从选择输入更改为文本输入

> ID：15177650
> 
> 赞同：0
> 
> 时间：2013-03-02T18:01:23.360
> 
> 标签：javascript, jquery, select, text, toggle

我对使用 jQuery 和 JavaScript 很陌生，但是这里有。我正在尝试为我的网站创建一个切换功能。有一个用于选择事件名称的输入，该名称默认显示为数据库中所有事件的下拉列表 - 但我希望有一个选项可以将其更改为手动输入并键入事件名称作为什么你想要的。

我可以让它正常工作！但是，我无法获得将输入 BACK 更改为选择框的链接才能正常工作。

请参阅下面的代码：

/// jQuery代码 ///

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
<script type="text/javascript">
    function toggleEventInput() {
       $("#EventNameDropDown")
.replaceWith('<input type="text" size="35" name="boxEvent" class="FieldInput" />');
        $("#EventNameChange")
.replaceWith('<a href="javascript:toggleEventInputBack();"> (Drop Down Input)</a>');
    }

    function toggleEventInputBack() {
       $("#EventNameDropDown")
.replaceWith('TEST');
        $("#EventNameChange")
.replaceWith('<a href="javascript:toggleEventInput();"> (Manual Input)</a>');
    }   
</script> 
```

/// HTML 代码 ///

```
<table>
       <tr>
        <td class="label">Event:</td>
            <td>
                <span id="EventNameDropDown">
                <select name="boxEvent" class="FieldInput" style="width:254px;" />
                <?= $EventNameDropDownList ?>
                </select>
                </span>
                <span id="EventNameChange">
                <a href="javascript:toggleEventInput();"> (Manual Input)</a>
                </span>
            </td>
        </tr>
        <tr>
            <td class="label">Company:</td>
            <td><input type="text" size="35" name="boxEvent" class="FieldInput" /></td>
        </tr>
</table> 
```

如前所述，当您单击指向“（手动输入）”的原始链接时，它可以正常工作并将其更改为文本框。但是，当您单击“（下拉输入）”链接时，它什么也不做。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:19:25.033

最好将下拉列表添加到 div/span 中，并在单击切换按钮时，将 div/span 中的数据存储到变量中，然后用输入框替换内容。在下一次切换时，用变量中的数据替换 div/span。状态变量 0/1 将有助于切换数据..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:07:03.037

您需要使用`.html()`而不是`.replaceWith()`. 前者替换元素的内容。后者替换元素本身。通过使用`.replaceWith()`，您也正在替换`<span>`包含 the 的`<select>`。

Krishna 建议不要只替换 html 的 html `<select>`，而是先将其存储在一个变量中，以便稍后将其放回去。

您可以将其作为数据存储在元素上，如下所示：

```
function toggleEventInput() {
    // Store the html for the <select>.
    $('#EventNameDropDown').data('selectHtml', $('#EventNameDropDown').html());

    $("#EventNameDropDown").html('<input type="text" size="35" name="boxEvent" class="FieldInput" />');
    $("#EventNameChange").html('<a href="javascript:toggleEventInputBack();"> (Drop Down Input)</a>');
}

function toggleEventInputBack() {
    $("#EventNameDropDown").html($('#EventNameDropDown').data('selectHtml'));
    $("#EventNameChange").html('<a href="javascript:toggleEventInput();"> (Manual Input)</a>');

    // Clear the html for the <select>. We will get it again later if we need it.
    $('#EventNameDropDown').data('selectHtml', '');
} 
```

# jquery - Jquery 高度函数未正确报告内容 div 的高度

> ID：15177651
> 
> 赞同：0
> 
> 时间：2013-03-02T18:01:25.037
> 
> 标签：jquery, wordpress, dom, for-loop

我有一个 wordpress 网站宽度的侧边栏，客户想要一遍又一遍地重复一组广告以填充空白。

所以我有第一组广告硬编码，然后有一个函数来获取#content DIV 的高度并循环遍历广告数组并根据需要将它们附加到侧边栏。

它在网站的大多数页面上都可以正常工作，[例如此处（链接）](http://happeninginthehills.com/goings-on/)。

但是由于某种原因，基于一个模板的页面没有报告正确的高度（我在页面上放了一个跟踪语句，它报告了 ~2500 而不是 ~6000）。你可以在这样的[页面上看到（链接）](http://happeninginthehills.com/onourradar/recycled-reworked-and-reinvented/)。

为了使它更难调试，它会间歇性地在这些页面上工作。但通常重新加载然后它再次失败。循环工作，只是没有足够的时间，因为高度被错误地报告给脚本。我不明白。

脚本在这里：

```
<script type="text/javascript">
$(function() {
    var contentHeight = $('#content').height();
    var adList = [
        '<a href="http://www.toveromarks.com"><img class="ad" src="http://happeninginthehills.com/wp-content/uploads/ads/ToveroHappeningHills.jpg" /></a>',
        '<img class="ad" src="http://happeninginthehills.com/wp-content/uploads/2012/12/vi-owens-ad.png" />', 
        '<a href="http://www.hadunne.com"><img class="ad" src="http://happeninginthehills.com/wp-content/uploads/2012/12/susie-ad1.png" /></a>', 
        '<a href="http://www.deborahchabrian.com"><img class="ad" src="http://happeninginthehills.com/wp-content/uploads/ads/chabrian-ad.jpg" /></a>',
        '<a href="http://www.tclaw.biz"><img class="ad" src="http://happeninginthehills.com/wp-content/uploads/2012/12/jeffs-ad.png" /></a>',
        '<a href="http://www.edmartinezart.com"><img class="ad" src="http://happeninginthehills.com/wp-content/uploads/ads/martinez-ad.jpg" /></a>',
        '<img class="ad" src="http://happeninginthehills.com/wp-content/uploads/2012/12/scott-phillips-ad.jpg" />'
        ];
    var adHeight = 285;
    var numRequiredAds = adList.length;
    var heightDiff = contentHeight - (numRequiredAds * adHeight);
    var numAds = Math.floor(heightDiff/adHeight);
    if (heightDiff > adHeight){
        for (var i = 0; i < numAds ; i++) {
            $('#primary').append(adList[i % adList.length]);
            //$('#primary').append('<p>ad num '+i+'</p>');
        };
            //$('#primary').append('<p>height is'+contentHeight+'</p>');
        }
   });
  </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:25:53.833

```
window.onload = function() {
   // your code
} 
```

# php - PDO MySQL 检查数据库是否存在

> ID：15177652
> 
> 赞同：0
> 
> 时间：2013-03-02T18:01:28.577
> 
> 标签：php, mysql, database, pdo, schema

询问`SCHEMA`MySQL 数据库中是否存在的正确方法是什么？

我在 PDO 中编程，基本上我的脚本应该是这样的：

```
if (databaseExists($db)) {
    // Do something
} 
```

对于功能：

```
function databaseExists($db) {
     SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME = $db;
     if so - return true;
     else - return false;
} 
```

我的问题实际上是，如何执行该`SELECT SCHEMA_NAME FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME = $db`声明。我是否必须使用`$conn`没有定义数据库的？我将如何返回结果？我必须获取数据，还是只能进行计数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:25:46.423

只需直接创建与信息架构的连接并运行您的查询。

```
$pdo = new PDO(
               'mysql:host=hostname;dbname=INFORMATION_SCHEMA',
               'username',
               'password'
); 
```

从那里开始，您的功能应该一旦构建就可以工作。

# javascript - 从 dom 和内存中删除 SVG

> ID：15177654
> 
> 赞同：1
> 
> 时间：2013-03-02T18:01:45.437
> 
> 标签：javascript, html, canvas, memory-leaks, svg

我正在做一些音乐可视化实验，它根据所选的可视化从 canvas 或 svg 上的 dancer.js 中提取数据。我有 4 个选项：在画布上清除 js，在两个 svg 上使用 raphaeljs，在最后一个中使用三个.js。

为了保留声音元素并防止重新加载 dancer.js，我以以下方式加载不同的脚本：

```
 $('body > a').click(function(){
                $('canvas').remove();
                $('svg').empty();
                $('svg').remove();
                var id = $(this).attr('id');
                audioElement = $('#audio')[0];
                $.ajax({
                    type: "GET",
                    url: "js/"+id+"-ajax.js",
                    dataType: "script"
                });
            }); 
```

如果有任何不同的可视化被 ajax 捕获，它应该只删除画布和 svg

```
 init = function() {
    ...
  }
  init(); 
```

它们共享相同的功能，例如`onKick`在 init 中分别更改为加载的脚本。（onKick 是为了让 dancer.js 在正在播放的歌曲中“踢”时触发它）。

在您开始在它们之间切换之前，它的效果非常好。在画布和画布之间切换几乎没有区别，但是当我从画布更改为 svg 时，而不是回到画布，帧率急剧下降。

可能是因为 svg 被保存在内存中或其他一些建议？

# android - ADB 作为 Visual Studio 2010 中的构建后事件使其冻结

> ID：15177655
> 
> 赞同：1
> 
> 时间：2013-03-02T18:01:47.213
> 
> 标签：android, visual-studio-2010, adb, post-build-event

我`adb`在 Visual Studio 2010 中调用构建后事件。有时，它使 Visual Studio 停止响应（例如，当设备未连接时）。

但是，当我从命令行调用时`adb`，它会输出`error: device not found`并返回。您是否遇到同样的问题？如何方便地修复或避免它？

# maven - maven - 传递依赖

> ID：15177661
> 
> 赞同：5
> 
> 时间：2013-03-02T18:02:13.940
> 
> 标签：maven, transitive-dependency

在 pom.xml 中定义数据时，我试图遵循最佳实践，所以我开始研究 Spring 源代码，我看到了：

```
 <project xmlns="http://maven.apache.org/POM/4.0.0"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.springframework</groupId>
  <artifactId>spring-aop</artifactId>
  <packaging>jar</packaging>
  <version>3.1.1.RELEASE</version>
.....

<dependency>
      <groupId>org.springframework</groupId>
      <artifactId>spring-beans</artifactId>
      <version>${project.version}</version>
      <scope>compile</scope>
</dependency>

---

<dependency>
      <groupId>log4j</groupId>
      <artifactId>log4j</artifactId>
      <scope>test</scope>
</dependency>
----- 
```

但是，spring-beans 也依赖于 log4j。

你能告诉我，对于最佳实践方法，你应该在多大程度上依赖传递依赖？

我问这个是因为我的第一个想法是不要重新声明 log4j 依赖项，因为 spring-beans 已经声明了它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-02T18:05:19.867

声明您明确依赖的依赖项，无论是提供您直接导入和使用的类，还是提供您直接使用的服务，例如 Log4J。传递依赖项应该只提供运行时需要但您自己不使用的依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:50:36.617

这有两个部分：

log4j 是为“*测试*”范围声明的，它不会成为最终输出（jar/war ...）的一部分。因此，当 spring-beans 依赖 log4j 进行测试（范围）时，这并不意味着在提供或运行时（范围）使用 spring-beans 的项目存在*传递依赖*。

> 依赖范围 - 这允许您仅包含适用于当前构建阶段的依赖项。... test：此范围表示该依赖项对于应用程序的正常使用不是必需的，仅适用于测试编译和执行阶段。（阿帕奇）

第二部分：

当没有指定依赖的版本时，它依赖于“其他”pom 来管理依赖。所以依赖是传递的并由其他管理。“依赖管理”

> 依赖管理——这允许项目作者在传递依赖或未指定版本的依赖中遇到工件时直接指定要使用的工件的版本。（阿帕奇）

[Maven Apache 传递依赖](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Transitive_Dependencies)

# css - 多年来的 CSS3 浏览器兼容性

> ID：15177664
> 
> 赞同：1
> 
> 时间：2013-03-02T18:02:37.123
> 
> 标签：css, browser, cross-browser, statistics

我正在尝试找到一项研究或图表，以显示不同浏览器和版本中对 CSS3 的支持百分比。我找了 2 个小时，但我发现的唯一一件事是支持 CSS3 个别部分，而不是整个 CSS3。

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T20:06:24.610

我认为这个网站会有所帮助，也发现它很有用 [http://css3test.com/](http://css3test.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:26:45.893

我发现[这个网站](http://html5readiness.com)似乎有你要找的东西。

# html - IE7 中短 DIV 元素问题 + DOCTYPE 中的长 DIV 元素

> ID：15177668
> 
> 赞同：0
> 
> 时间：2013-03-02T18:03:22.970
> 
> 标签：html, internet-explorer-7

需要你的帮助。第一次面对这个问题，需要你的专业知识。

代码是

```
<div style="overflow:hidden;cursor:pointer;width:100%">
    <div id="ScrBar" style="position:relative;width:16000px">
        This is the text alksdjflask d;alskdj fl;aksjd f;laksdjf l;kasjdf ... -----> long line

    </div>
</div> 
```

这是IE7相关的！无法在其他版本的 IE 上测试。在 Chrome 和 FF 中工作正常。

如果我*不*将 DOCTYPE 放在 html 文件的开头，则第一个 DIV 在屏幕的右端结束，此时内部 DIV 被“剪切”。没有水平滚动条。

如果我放置 DOCTYPE（无论是过渡的还是严格的），那么外部 DIV 将获得内部 DIV 的全宽。窗口有长长的水平滚动条。

好吧，在研究如何解决它之前，我无法理解问题是什么（就技术术语而言，而不是我在屏幕上看到的）。

谢谢！

编辑：进一步的测试表明，使用 IE8 和文件的*本地*副本，它按预期显示，但是使用 IE8 和文件上传到服务器（apache），它没有按预期显示长水平滚动条！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:06:26.190

省略 a`DOCTYPE`会导致浏览器进入[quirks 模式](http://en.wikipedia.org/wiki/Quirks_mode)。[http://webdesign.about.com/cs/doctype/a/aaquirksmode.htm](http://webdesign.about.com/cs/doctype/a/aaquirksmode.htm)

您应该*始终*至少[包含 HTML5 文档类型](https://stackoverflow.com/q/5629/139010)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T03:54:06.607

请参阅[Neils](https://stackoverflow.com/users/318572/niels)的这个答案。就像 Matt 和其他人提到的那样，您应该始终使用 doctype。

*“这是 IE6 和 IE7 中的一个众所周知的错误。要解决它，您需要添加 position:relative 到容器。由于在您的情况下 body 是容器，我建议您直接在 body 下方添加一个 div 并给它位置：相对的。它应该可以解决你的问题。*

[IE6 + IE7 CSS 溢出问题：隐藏；- 位置：相对；组合](https://stackoverflow.com/questions/2403011/ie6-ie7-css-problem-with-overflow-hidden-position-relative-combo)

# css - Em/Rem 与 Px 困境

> ID：15177669
> 
> 赞同：2
> 
> 时间：2013-03-02T18:03:32.397
> 
> 标签：css, pixel, font-size, em

我一直在我工作了很长时间的所有网站的所有维度上使用像素（+ 几个百分比在这里和那里）。

时不时地，我不断地看到关于 em 和 rem 的东西，并且一直在犹豫是否在像素上使用它们。

根据我的阅读，使用它们的最佳方法是将`<html>`元素的字体大小设置为 62.5%，以使 1em 等于 10 像素，然后指定与此相关的字体大小。

一些想法，我希望这里的人可以为我回答：

*   如果您使用 em/rem 并且您正在构建您的网站并且您认为，此文本需要为 20px 并且您将其转换为 2em 那么为什么不首先使用像素呢？

*   如果您将 em 用于尺寸并且想要添加图像背景尺寸并且它具有一组像素尺寸，那么您将其设置为 em 并且用户缩放，这不会破坏布局吗？

我已经读过，使用 em 可以让你在一个地方改变整个应用程序的相对字体大小（这是一个好主意，可能非常有用）但是如果你改变 html 标签上的 62.5%，1em 肯定不会更长等于 10px，因此您之前设置的简易性完全不在窗口中。

假设您有一个`<div>`并且您将它的背景图像设置为您之前在特定尺寸处创建的图像，并且它需要左侧的特定填充，您可以使用所有适当的尺寸和填充设置它的样式并在 em 和然后有人缩放肯定会破坏，因为您的盒子尺寸和精心制作的左侧填充物都完全脱离了窗户。

我也看过这个 sass mixin：

```
// font-size must be set to 62.5% on html
=font-size($size: 1.6, $line-height: $size * 1.25)
  font-size: ($size * 10) + px
  line-height: ($line-height * 10) + px
  font-size: $size + rem
  line-height: $line-height + rem 
```

当然，如果有人在使用像素版本的浏览器中进行放大，并且您将其与使用 rem 版本的人进行比较，结果将会有所不同。？？？

我希望你们能澄清一些事情。在发布到这里之前，我已经阅读了很多关于这一切的内容，所以我想你会发布很多链接，说明去阅读这个。如上所述，我已经阅读了它们，并且在这篇文章之后仍然有上述问题。

# css - 我可以使用 CSS 命令保留文本行吗？

> ID：15177671
> 
> 赞同：4
> 
> 时间：2013-03-02T18:03:51.847
> 
> 标签：css, button, text, position, alignment

我有这个问题：

![**http://img687.imageshack.us/img687/4668/problempu.jpg**](../Images/012b930d9523c90e75e4c356245e27fe.png)

我想在标题中保留 4-5 行文本，以便价格和“添加到购物车”按钮对齐。

我能做些什么？现在我有这个：

```
.product-grid {
margin-bottom:15px;
margin-left:auto;
margin-right:auto;
width:auto;
text-align:center;
}

.product-grid .item-box {
float:left;
text-align:center;
vertical-align:text-top;
padding:5px;
}

.product-grid .item-box:hover {
background:#F9F9F9;
}

.product-grid .product-item {
text-align:center;
width:177px;
height:350px;
margin:0;
padding:0;
}

*.product-grid .product-item .product-title** {
font-weight:700;
font-size:12px;
font-family:Ubuntu, Helvetica, Arial, sans-serif;
padding:0;
}

.product-grid .product-item .product-title a {
display:block;
height:auto;
line-height:1.3em;
overflow:hidden;
font-family:Ubuntu,Helvetica, Arial, sans-serif;
padding:4px 10px 8px 0;
}

.product-grid .product-item .picture {
text-align:center;
height:177px;
}

.product-grid .product-item .picture img {
position:relative;
vertical-align:middle;
border-radius:5px;
border:1px solid #eee;
}

.product-grid .product-item .description {
display:none;
text-align:center;
border-top:solid 1px #e3e3e3;
color:#555;
height:50px;
font-size:120%;
margin:5px 5px 0;
padding:10px 5px;
}

.product-grid .product-item .add-info {
vertical-align:bottom;
text-align:right;
width:auto;
height:auto;
position:relative;
}

.product-grid .product-item .prices {
text-align:center;
vertical-align:middle;
position:static;
bottom:15px;
right:10px;
font-weight:700;
font-size:170%;
}

.product-grid .product-item .prices .product-price,.product-grid .product-item .prices .old-product-price {
margin:0;
}

.product-grid .product-item .prices .product-price .price {
color:#ef2525;
font-family:Ubuntu, Helvetica, Arial, sans-serif;
text-shadow:0 0 1px #333;
font-size:140%;
font-weight:700;
}

.product-grid .product-item .prices .old-product-price .price {
font-height:bold;
color:#333;
text-decoration:line-through;
font-size:70%;
font-family:Ubuntu, Helvetica, Arial, sans-serif;
}

*.product-grid .product-item .buttons** {
vertical-align:bottom;
position:relative;
margin-top:15px;
text-align:center;
}

.product-box-add-to-cart-button {
cursor:pointer;
background:#427a93;
color:#fff;
text-shadow:none;
font-size:130%;
font-weight:700;
font-family:Ubuntu, Helvetica, Arial, sans-serif;
border:solid 1px #335e70;
-webkit-transition-duration:.2s;
-moz-transition-duration:.2s;
transition-duration:.2s;
border-color:#999;
padding:7px;
}

.product-box-add-to-cart-button:hover {
background:#335e70;
color:#fff;
text-shadow:0 1px 2px #000;
border:solid 1px #335e70;
-webkit-transition-duration:.2s;
-moz-transition-duration:.2s;
transition-duration:.2s;
} 
```

我需要做哪些改变？

我已经尝试了所有我能找到的对齐和位置，但没有任何效果。我认为，如果我可以在标题中保留 4-5 行文本，我可以使它工作并对齐。

任何帮助，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T18:19:58.707

`<p>`用段落标签或`<div>`其他[块级元素](http://www.htmlhelp.com/reference/html40/block.html)包装每个产品标题，并对每个产品标题应用相同的类名，例如“productTitle”，例如：

```
<div class="productTitle">ASUS X501A</div> 
```

然后使用以下样式设置类：

```
.productTitle{height:4em;} // adjust to desired height. 
```

# xml - 可变元素类型的 XML 模式

> ID：15177678
> 
> 赞同：0
> 
> 时间：2013-03-02T18:04:32.530
> 
> 标签：xml, xsd

我有一个用于用户界面工具的 XML 元素，如下所示：

```
<Layout Type="{type}"...> 
```

如果 Type 为“Stack”，则元素如下所示：

```
<Layout Type="Stack" Orientation="Horizontal"/> 
```

但如果它是“边距”，那么元素是

```
<Layout Type="Margin" North="1" Center="3"/> 
```

我正在努力编写一个应对此问题的 XML 模式。一些帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:08:22.717

一种简单的方法是将元素 Layout 声明为具有名为 Type（必需）、Orientation、North 和 Center（都是可选的）的属性，并指定如果 @Type = "Stack" 那么 Orientation 是有意义的，而 North 和 Center 不是，而如果@Type = 'Margin' 那么North 和Center 表示这个或那个，而Orientation 没有任何意义。

这样做的好处是您几乎可以用任何模式语言来完成它，并且它使事情变得相对简单。它的缺点是验证共现约束的责任从验证者转移到了消费软件。

使用 XSD 1.1 的第二种方法是使用条件类型分配：声明具有适当属性的两种类型，然后指定使用每种类型的条件。

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:tns="http://www.example.com/nss/layout"
  targetNamespace="http://www.example.com/nss/layout"
  elementFormDefault="qualified"> 

  <!--* Strictly speaking, this type is not essential,
      * but it gives an overview of the kinds of layout
      * we expect and allows a reviewer to have more
      * confidence that the conditional type assignment
      * covers all the necessary bases. *-->
  <xs:simpleType name="layout-types">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="Stack" />
      <xs:enumeration value="Margin" />      
    </xs:restriction>
  </xs:simpleType>

  <!--* Two different types for the two different
      * kinds of layout. *-->
  <xs:complexType name="StackLayout">
    <xs:attribute name="Type" 
                  type="tns:layout-types" 
                  use="required"/>
    <xs:attribute name="Orientation" 
                  type="xs:string" 
                  use="required"/>
  </xs:complexType>
  <xs:complexType name="MarginLayout">
    <xs:attribute name="Type" 
                  type="tns:layout-types" 
                  use="required"/>
    <xs:attribute name="North" 
                  type="xs:int" 
                  use="required"/>
    <xs:attribute name="Center" 
                  type="xs:int" 
                  use="required"/>
  </xs:complexType>

  <!--* The Layout element is bound to type tns:StackLayout
      * if its Type attribute has the value 'Layout'.
      * Otherwise, it's bound to tns:MarginLayout, if its
      * Type attribute = 'Margin'.  Otherwise, the Layout
      * element instance is invalid.
      * If there's a default type you can use, you don't
      * have to use xs:error.
      *-->
  <xs:element name="Layout">
    <xs:alternative test="@Type='Layout'" 
                    type="tns:StackLayout"/>
    <xs:alternative test="@Type='Margin'" 
                    type="tns:MarginLayout"/>
    <xs:alternative type="xs:error"/>
  </xs:element>

</xs:schema> 
```

如果您无权访问 XSD 1.1 验证器，则可以使用 Schematron 检查共现约束，或者您可以编写一个验证约束的 Relax NG 模式。

# ios - APNS 令牌冲突，存储在 Postgres 中

> ID：15177686
> 
> 赞同：6
> 
> 时间：2013-03-02T18:05:51.860
> 
> 标签：ios, objective-c, postgresql, push-notification, apple-push-notifications

我使用推送通知并存储设备令牌，就像我假设其他人一样。首先，我将它们转换为我的应用程序的字符串：

```
NSString *deviceTokenString = [[[token description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"<>"]]
                               stringByReplacingOccurrencesOfString:@" " withString:@""]; 
```

然后我把它们放到我的服务器上，ActiveRecord 将它们存储在一个`character varying(255)`列中：

```
Device.where(:token => device_token, :username => username).first_or_create!(:model => model) 
```

我有一个验证可以确保没有两个令牌是相同的，**我理解应该总是这样：**

```
class Device < ActiveRecord::Base
  belongs_to :user
  validates_uniqueness_of :token
end 
```

但是，我已经开始看到令牌唯一性的验证错误：

`ActiveRecord::RecordInvalid: Validation failed: Token has already been taken`

psql 中的手动查询确认设备正在尝试使用已在不同用户下的表中的令牌进行注册。这不应该是不可能的吗？我转换令牌的方式是否会截断它们？我检查了问题第一次出现时我能找到的每个代码示例，每个人似乎都使用我在第一个代码示例中列出的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T11:22:21.923

如果有人注销然后使用其他帐户登录，则设备可能会尝试使用其他用户下的表中已有的令牌进行注册。

我会在服务器上为用户`user`和令牌字符串执行以下操作`token`（假设一次只能在一台设备上登录一个用户）：

1.  检查是否有`Device`for `token_string`。
2.  如果没有设备，则为`token_string`和创建一个`user`。
3.  如果存在设备而其用户不存在`user`，则将其用户更新为`user`.

这样，将为最后登录设备的用户发送推送通知。

关于`NSData`在设备上将 转换为十六进制字符串的方式，您不应依赖`-[NSData description]`. 最好以编程方式进行（输入，未测试）：

```
- (NSString *)hexStringForData:(NSData *)data
{
    NSUInteger length = data.length;
    const char *bytes = data.bytes;
    NSMutableString *result = [NSMutableString stringWithCapacity:length * 2];
    for (int i = 0; i < length; i++) {
        [result appendFormat:@"%02x", bytes[i] & 0xff];
    }
    return [result copy];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T13:08:41.623

我会赌这个猜测，但把它当作它的用途，猜测。

当 iOS 设备从备份中恢复时，或者当它们被“恢复”到新设备上时，例如，有人从 iPhone 4 升级到 iPhone 5，或者当有人将他们的 iPhone 给他们的妻子或在 eBay 上出售时，你会被复制/冗余/混淆设备数据。我确实看到了这种情况，但不是专门针对 APNS 令牌。

以下是[APNS 文档](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW1)对此的看法：

> 通过在每次启动应用程序时请求设备令牌并将其传递给提供者，您可以帮助确保提供者拥有设备的当前令牌。如果用户将备份恢复到为其创建备份的设备或计算机之外的设备或计算机（例如，用户将数据迁移到新设备或计算机），他或她必须至少启动一次应用程序以使其恢复再次收到通知。如果用户将备份数据恢复到新设备或计算机，或重新安装操作系统，则设备令牌会更改。此外，永远不要缓存设备令牌并将其提供给您的提供商；始终在需要时从系统获取令牌。如果您的应用程序之前已注册，请调用 registerForRemoteNotificationTypes：

因此，我没有查看您的代码，但您的“重复”令牌似乎与不每次都注册、某种缓存和设备恢复的某种组合有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T09:50:11.593

了解设备注册时会发生什么很重要。它会向您的服务器发送关于以下内容的 POST：

```
/passkit/v1/devices/<deviceID>/registrations/<typeID>/<serial#> 
```

在 JSON 有效负载中是`push_token`. 重要的是`deviceID`和`push_token`。就 Apple 而言，您通过 Apple 的系统与设备进行通信，仅此`push_token`而已。

至于`deviceID`，它是实际使用的物理设备。设备可能想要多次注册的事实无关紧要，您的代码应该`push_token`根据最新的注册尝试简单地更新数据库中的内容。就是这样。

# javascript - Chrome 控制台 - 点击功能：错误（多次点击链接）

> ID：15177687
> 
> 赞同：0
> 
> 时间：2013-03-02T18:05:56.087
> 
> 标签：javascript, google-chrome, console

**正文内容：**

`<a href"http://example.com/open.php" id="open" target="_blank">`

**控制台语法：**

`for (var c = 0; c < 200; c++) { document.getElementById("open").click(); }`

***错误：*** **`undefined`**

此外， `document.getElementById("open").click();`给出相同的错误。

请解释我遇到此错误的原因。

`open`我需要多次单击带有 id 的链接。

这是我需要测试的项目。谢谢你的帮助。

# spring - 如何为 Maven 或 Spring 资源配置文件路径

> ID：15177694
> 
> 赞同：0
> 
> 时间：2013-03-02T18:06:31.177
> 
> 标签：spring, file, maven, resources, download

我一直不知道文件路径。:(

我在 Maven-Spring 应用程序中有以下设置

```
src/main/java
    com.mycompany.controller
        MyController.java
src/main/resources/downloads
    MyDocument.docx 
```

我正在尝试访问控制器中的文档。

```
String filepath = "";
File file = new File(filepath); 
```

我尝试了许多路径，但似乎无法让它通过`FileNotFound`错误。我认为路径应该是`/src/resources/downloads/MyDocument.docx`，但这不起作用。我试过绝对和相对路径，但似乎无法让它工作。

我不确定是否需要修复路径或移动文档所在的位置。有人知道吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:16:44.760

试试这个`MyController`：

```
InputStream resource = this.getClass().getResourceAsStream("/downloads/MyDocument.docx"); 
```

如果资源放在`downloads`包中，这应该可以工作。

# c# - 如何使用 C# 实现单向延迟测量？

> ID：15177697
> 
> 赞同：2
> 
> 时间：2013-03-02T18:06:49.570
> 
> 标签：c#, networking, latency, ntp

我需要测量通过 LAN 通信的两个应用程序之间的单向延迟测量，并将结果报告给数据收集服务器。

客户端应用程序使用多播发送数据，然后通过两个服务器，最后一个服务器是此测试的终点，如下所示：

`Agent -> multicast cloud -> server 1 -> server 2`

我考虑过使用 NTP（或 LAN 的 PTP）来同步“代理”和“服务器 2”，但我想知道实现这一点的正确算法是什么，它的精度是多少。

如何执行此测量（使用 C#）？它的精度是多少？

**更新：**请注意，代理和服务器 2 之间正在处理数据，因此测量不是纯粹的网络方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:30:57.157

根本问题是在两台或多台机器之间同步时钟。

[两台远程计算机之间的（时钟）同步](https://stackoverflow.com/questions/389417/synchronization-of-clocks-between-two-remote-computers)

一旦你有了这个，你只需在创建/发送时添加一个“构造时间”到数据包本身。从开始到结束的单向延迟是“到达时间”减去“构建时间”

如果您不能信任中间节点，那么您必须让代理向服务器注册，它希望在特定时间发送数据包。那么从开始到结束的单向延迟是“到达时间”减去“预期到达时间”

# asp.net-mvc-3 - MVC4 中的 ASP.NET 资源处理程序机制

> ID：15177698
> 
> 赞同：0
> 
> 时间：2013-03-02T18:06:53.017
> 
> 标签：asp.net-mvc-3, asp.net-mvc-4, localization, cultureinfo, currentuiculture

简单的。我想本地化我的应用程序。我已经用谷歌搜索了几天，并尝试了一百万种不同的方法来获取我的资源。我成功的唯一方法是使用标准的 asp.net 文件夹“App_LocalResource”，将资源文件公开并给它们一个`Custom Tool Name`. 然后我可以在视图中导入`Custom Tool Name`with `@using`。

我的问题是当我改变文化时语言/资源项没有改变。

这是我在 global.asax 中更改它的方法：

```
 protected void Application_AcquireRequestState(object sender, EventArgs e)
    {
        if (HttpContext.Current.Session != null)
        {
            CultureInfo ci = (CultureInfo)this.Session["Culture"];
            if (ci == null)
            {
                string langName = "en";
                string autoLang = "";
                if (HttpContext.Current.Request.UserLanguages != null && HttpContext.Current.Request.UserLanguages.Length != 0)
                {
                    autoLang = HttpContext.Current.Request.UserLanguages[0].Substring(0, 2);
                }
                if (autoLang == "da")
                    langName = autoLang;
                ci = new CultureInfo(langName);
                this.Session["Culture"] = ci;
            }

            Thread.CurrentThread.CurrentUICulture = ci;
            Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(ci.Name);
        }
    } 
```

所以文化要么是`da`要么`en`。但我注意到资源文件的名称必须具有特定的语法。必须有一个没有国家/文化代码的默认值（在本例中为英语），并且其他默认值已命名为 reFile.da-DK.resx。它必须同时具有语言和文化代码。

我担心资源处理程序可以识别我的文件，因为文化设置为“da”而不是“da-DK”。如果我将我的`da`资源文件命名为 resFile.da.resx 我无法导入`Custom Tool Name`我的资源文件。

我该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T18:06:55.280

使用完整的文化信息字符串，例如：

```
var info = new CultureInfo("en-US")
```

此外，为了获得最佳实践，将代码移出 Application_BeginRequest 方法，这是您将看到此类代码的标准位置。

# c# - 让继承的类正常工作时遇到问题

> ID：15177701
> 
> 赞同：0
> 
> 时间：2013-03-02T18:07:37.030
> 
> 标签：c#, inheritance

这是我的基类：

```
 class Pet
    {
        //class internal variables
        string petName;
        bool gender;  //true = female; false = male
        DateTime dob;
        int goodDogs = 0;
        int goodCats = 0;
        int goodKids = 0;

        //constructors
        public Pet(string pn, bool g, DateTime birth, int d, int c, int k)
        {
            petName = pn;
            gender = g;
            dob = birth;
            goodDogs = d;
            goodCats = c;
            goodKids = k;
        }

        public Pet(string pn, string g, DateTime birth, int d, int c, int k)
        {
            petName = pn;
            if (g.ToLower() == "female")
            {
                gender = true;
            }
            else
            {
                gender = false;
            }
            dob = birth;
            goodDogs = d;
            goodCats = c;
            goodKids = k;
        }

        //Properties
        public string PetName
        {
            get
            {
                return petName;
            }
            set
            {
                petName = value;
            }
        }

        public string Gender
        {
            get
            {
                if (gender == true)
                {
                    return "Female";
                }
                else
                {
                    return "Male";
                }
            }
            set
            {
                if (value.ToLower() == "female")
                {
                    gender = true; 
                }
                else
                {
                   gender = false;
                }
            }
        }

        public DateTime DOB
        {
            get
            {
                return dob;
            }
            set
            {
                dob = value;
            }
        }

        public string GoodWithDogs
        {
            get
            {
                switch (goodDogs)
                {
                    case 1:
                        return "Yes";
                        //break;
                    case 2:
                        return "No";
                        //break;
                    default:
                        return "Unknown";
                        //break;
                }

            }
            set
            {
                goodDogs = int.Parse(value);
            }
        }

        public string GoodWithCats
        {
            get
            {
                switch (goodCats)
                {
                    case 1:
                        return "Yes";
                    //break;
                    case 2:
                        return "No";
                    //break;
                    default:
                        return "Unknown";
                    //break;
                }

            }
            set
            {
                goodCats = int.Parse(value);
            }
        }

        public string GoodWithKids
        {
            get
            {
                switch (goodKids)
                {
                    case 1:
                        return "Yes";
                    //break;
                    case 2:
                        return "No";
                    //break;
                    default:
                        return "Unknown";
                    //break;
                }

            }
            set
            {
                goodKids = int.Parse(value);
            }
        }

       // Methods
        public string GetAge()
        {
            DateTime currentDate = System.DateTime.Now;
            TimeSpan daysPassed = currentDate - dob;
            int ageInDays = daysPassed.Days;
            if (ageInDays < 350)
            {
                return (Math.Round(ageInDays / 30.0)).ToString() + " months";
            }
            else
            {
                return (ageInDays / 365).ToString("N1") + " years" ; 
            }
        }
    }

Here is what I have for my class that is trying to inherit:

public class Cat : Pet
{
    private string breed;
    private bool litterBoxTrained;
    private bool declawed;

    public Cat(string pn, string g, DateTime birth, int d, int c, int k,string b, bool lbt, bool dc) 
    : base ( pn, g, birth, d, c, k)
    {
        breed = b;
        litterBoxTrained = lbt;
        declawed = dc;
    }

    public string Breed
    {
        get
        {
            return breed;
        }
        set
        {
            breed = value;
        }
    }

    public string HouseBroke
    {
        get
        {
            if (litterBoxTrained == true)
            {
                return "Yes";
            }
            else
            {
                return "No";
            }
        }
        set
        {
            if (value.ToLower() == "yes")
            {
                litterBoxTrained = true;
            }
            else
            {
                litterBoxTrained = false;
            }
        }
    }

    public string BasicCommand
    {
        get
        {
            if (declawed == true)
            {
                return "Yes";
            }
            else
            {
                return "No";
            }
        }
        set
        {
            if (value.ToLower() == "yes")
            {
                declawed = true;
            }
            else
            {
                declawed = false;
            }
        }
    }
    public string InfoListing()
    {

        return string.Format("{0,-6}{1:-15}{2,-9}{3,-24}{4:-12}", "CAT", petName, gender, breed, base.GetAge());
    }
} 
```

我在保护方面遇到问题。我收到不一致的类保护错误和两个尝试访问继承的变量 petName 和继承的方法 GetAge() 的错误。需要注意的一点是我不能更改基础（宠物）类代码。

任何建议都会很棒。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:11:44.537

> 我收到不一致的类保护错误

那是因为`Pet`is 隐含`internal`（假设它是一个顶级类）：

```
class Pet 
```

而是：`Cat`_`public`

```
public class Cat : Pet 
```

您不能将`internal`类用作类的基`public`类。要么`Pet`公开，要么`Cat`内部。

> 以及尝试访问继承的变量 petName 的两个错误

尽管上面有误导性的评论，这个变量：

```
 string petName; 
```

是私有的，因为这是类中成员的默认设置。因此编译器绝对有权禁止您在外部使用它`Pet`，即使在派生类中也是如此。您应该改用该`PetName`属性。

> 并继承方法 GetAge()

唔。据我所知，这应该没问题。也许我错过了一些东西 - 会看看。

编辑：不，编译了你的代码，我没有看到任何问题`GetAge`。但是您*确实*在尝试访问时遇到了问题`gender`-也许这就是您的想法？这编译得很好：

```
return string.Format("{0,-6}{1:-15}{2,-9}{3,-24}{4:-12}",
                     "CAT", PetName, Gender, breed, base.GetAge()); 
```

（不是说你需要有资格`GetAge`，`base`因为它没有被覆盖`Cat`。就`GetAge()`可以了。）

# java - java函数被不停地调用

> ID：15177702
> 
> 赞同：-1
> 
> 时间：2013-03-02T18:07:40.633
> 
> 标签：java, javascript, jquery, jsf, jsf-2

我在 Home.xhtml 上使用延迟滚动。问题是，每当我向下滚动到页面底部时，Javascript`getMoreStatusList`都会不停地调用 getMoreStatusList.xhtml 页面上的函数，直到编译器抛出索引越界异常。我怎样才能解决这个问题？

1)主页.xhtml

```
 <h:head>

        <script type="text/javascript" src="jquery-1.4.2.min.js"></script>

    <script type="text/javascript">
    /* <![CDATA[ */
    $(document).ready(function() {

        function lastAddedLiveFunc() {
            $('div#lastPostsLoader').html('<img src="bigLoader.gif">');

            $.get("getMoreStatusList.xhtml", function(data) {
                if (data != "") {
                    //console.log('add data..');
                    $(".items").append(data);
                }
                $('div#lastPostsLoader').empty();
            });
        };

      //lastAddedLiveFunc();
      $(window).scroll(function(){

          var wintop = $(window).scrollTop(), docheight = $(document).height(), winheight = $(window).height();
          var  scrolltrigger = 0.95;

          if  ((wintop/(docheight-winheight)) > scrolltrigger) {
             //console.log('scroll bottom');
             lastAddedLiveFunc();
          }
      });
    });
    /* ]]> */
    </script>
    </h:head>

    <h:body class="thrColElsHdr">        

                <!--  -->
                <div class="items">
                    <div id="scroll_items">
                        <c:forEach var="p" items="#{statusBean.statusList}">
                            <h:form>
                                <div class="status">
                                    <c:if test="${p.statusmsg!=null}">
                                        <!--  for text status msg check-->
                                        <h:commandLink
                                            action="#{friendBean.gotoFriendProfile(p.email)}"
                                            styleClass="link">
                                            <img src="../images/profilePicture/thumb/#{p.picture}"
                                                style="height: 39px; width: 39px;" />&nbsp; <h:outputText
                                                value="#{p.statusBy}:" />
                                        </h:commandLink>

                                        <br />

                                    </c:if>

                        </c:forEach>

                    </div>
                </div>

    </h:body>
    </html> 
```

2) 状态 Bean（包含 getMoreStatusList 函数）

```
 public class StatusBean {

                public List<Status> getStatusList() {
            FacesContext context = FacesContext.getCurrentInstance();
            HttpSession session = (HttpSession) context.getExternalContext()
                    .getSession(true);
            User user = (User) session.getAttribute("userdet");
            Query query = em.createQuery("SELECT s FROM Status s WHERE s.email='"
                    + user.getEmail() + "' ORDER BY s.timeMillis desc",
                    Status.class);
            List<Status> results = query.getResultList();

            Collections.sort(results);
            results = results.subList(0, 5);

            session.setAttribute("statusindex", 5);
            return results;

        }

        public List<Status> getMoreStatusList() {

            System.out.println("Inside getMoreStatusList");
            FacesContext context = FacesContext.getCurrentInstance();
            HttpSession session = (HttpSession) context.getExternalContext()
                    .getSession(false);
            User user = (User) session.getAttribute("userdet");
            Query query = em.createQuery("SELECT s FROM Status s WHERE s.email='"
                    + user.getEmail() + "' ORDER BY s.timeMillis desc",
                    Status.class);
            List<Status> results = query.getResultList();

            Collections.sort(results);
            int index = (int) session.getAttribute("statusindex");
            System.out.println(index);
            results = results.subList(index,index+5);
            session.setAttribute("statusindex", index + 5);
            return results;

        }

    } 
```

3) 获取更多状态列表.xhtml

```
<h:head></h:head>
<h:body>

            <c:forEach var="p" items="#{statusBean.moreStatusList}">
                <h:form>
                    <div class="status">
                        <c:if test="${p.statusmsg!=null}">
                            <!--  for text status msg check-->
                            <h:commandLink action="#{friendBean.gotoFriendProfile(p.email)}"
                                styleClass="link">
                                <img src="../images/profilePicture/thumb/#{p.picture}"
                                    style="height: 39px; width: 39px;" />&nbsp; <h:outputText
                                    value="#{p.statusBy}:" />
                            </h:commandLink>
                            <h:outputText value="#{p.statusmsg}" styleClass="textstyle1" />
                            <h:outputText value="#{p.timeMillis}"
                                style="font-size:xx-small;float:right;color:#bbbbbb;font-style: italic;">
                                <f:converter converterId="timeConverter" />

                                </div>
                            </c:forEach>
                            <br />
                            <div class="comment">
                                <p:inputText value="#{statusBean.comment.comment}"
                                    styleClass="box" />
                                <p:commandLink value="Views"
                                    action="#{statusBean.update(p.statusId)}" ajax="false"
                                    styleClass="link" />
                            </div>
                            <br />

                        </c:if>

            </c:forEach>

</h:body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:36:31.153

在我看来，当您在底部向下滚动时，滚动会被多次调用，因为当您向下滚动时，您的表达式`wintop/(docheight-winheight)) > scrolltrigger`对于像素范围将是正确的。您可以通过在 lastAddedLiveFunc() 上保持警报来验证它。如果确实是这样的话，

保留一个像“gettingNextScrollData”这样的变量来验证ajax调用是否已经在进行中。

```
 <script type="text/javascript">
    /* <![CDATA[ */
var gettingNextScrollData = false;
    $(document).ready(function() {

        function lastAddedLiveFunc() {
            $('div#lastPostsLoader').html('<img src="bigLoader.gif">');
            gettingNextScrollData = true;
            $.get("getMoreStatusList.xhtml", function(data) {
                if (data != "") {
                    //console.log('add data..');
                    $(".items").append(data);
                }
                $('div#lastPostsLoader').empty();
             gettingNextScrollData = false; 
            });
        };

      //lastAddedLiveFunc();
      $(window).scroll(function(){
          if(gettingNextScrollData == false) {
          var wintop = $(window).scrollTop(), docheight = $(document).height(), winheight = $(window).height();
          var  scrolltrigger = 0.95;

          if  ((wintop/(docheight-winheight)) > scrolltrigger) {             
               lastAddedLiveFunc();
          }
       }
      });
    });
    /* ]]> */
    </script> 
```

# java - 如何将 Eclipse 上基于文本的游戏移植到 android

> ID：15177703
> 
> 赞同：-4
> 
> 时间：2013-03-02T18:08:29.157
> 
> 标签：java, android, porting, text-based

我正在eclipse上用java编写一个基于文本的游戏。如果你曾经玩过它，它类似于 zork。我想知道是否有任何方法可以轻松地将我的程序变成一个 android 应用程序，或者我是否需要为 android 编写一个全新的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:13:50.600

我猜你的大部分java代码都可以重用，因为Android使用了java语言的大部分。您需要更改的是程序的 UI 表示。并使其与 android UI 小部件一起使用。

我认为对于一个基于文本的 UI 游戏来说，这不会是一件很难完成的事情。尽管您仍然需要了解 android 开发流程是如何工作的。

我不知道是否有一种简单的方法可以实现您的要求。

# javascript - JavaScript 原生方法静默失败而不是抛出错误

> ID：15177704
> 
> 赞同：1
> 
> 时间：2013-03-02T18:08:42.370
> 
> 标签：javascript, exception-handling

为了练习，我正在编写一个 JavaScript 库，并且我正在对现有对象（例如 Array）上的代码进行建模。

我注意到像`array.pop`（当数组为空时）这样的方法`array.splice(-1, -1)`会默默地失败，而不是抛出错误。为什么会这样？出于调试目的抛出错误不是更好吗？还是有一些我不知道的 JavaScript 最佳实践？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:27:08.390

空数组上的array.pop 将返回类型：未定义。如果您尝试使用结果，它将引发错误。

array.splice 将始终返回一个数组。如果没有删除任何内容，它将返回一个空数组。

为了确保这样的方法返回预期值，您应该编写单元测试。

一个简单的例子：

```
if( !myarray.pop() ){
    console.log( 'Error' );
} 
```

对于更详细的单元测试，我会使用 js 单元测试库。我用过的一个是 QUnit.js [http://qunitjs.com/](http://qunitjs.com/)

# python - 我可以以编程方式将 matplotlib 图插入 Excel 吗？

> ID：15177705
> 
> 赞同：16
> 
> 时间：2013-03-02T18:08:44.033
> 
> 标签：python, excel, matplotlib

我将 matplotlib 文件保存为 .tiff 图像。我希望能够打开一个 excel 文件并将图像粘贴到那里。

openpyxl 似乎不支持图像嵌入。xlwt 可以，但只有 bmp。

或者，如果我可以以编程方式将 tiff 转换为 bmp，那也可能会有所帮助。

欢迎提出任何想法。

如同

[以编程方式将多个 jpeg 图像嵌入到 EXCEL 中？](https://stackoverflow.com/questions/15106844/embed-multiple-jpeg-images-into-excel-programmatically)

但是，从 tiff 转换为 bmp 是可以接受的，因为我的图表量很小（每个文件大约 10 个）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-02T18:39:27.297

这是我从网络上的两个不同链接中找到的，对我来说非常有用。Matplotlib 允许保存我在这里使用的 png 文件：

```
from PIL import Image

file_in = "image.png"
img = Image.open(file_in)
file_out = 'test1.bmp'
print len(img.split()) # test
if len(img.split()) == 4:
    # prevent IOError: cannot write mode RGBA as BMP
    r, g, b, a = img.split()
    img = Image.merge("RGB", (r, g, b))
    img.save(file_out)
else:
    img.save(file_out)

from xlwt import Workbook
w = Workbook()
ws = w.add_sheet('Image')
ws.insert_bitmap(file_out, 0, 0)
w.save('images.xls') 
```

代码的图像部分来自 Ene Urans 的响应[http://www.daniweb.com/software-development/python/threads/253957/converting-an-image-file-png-to-a-bitmap-file](http://www.daniweb.com/software-development/python/threads/253957/converting-an-image-file-png-to-a-bitmap-file)。

xlwt 只是我在[http://www.simplistix.co.uk/presentations/python-excel.pdf](http://www.simplistix.co.uk/presentations/python-excel.pdf)找到的 xlwt 的文档。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-07-07T16:16:48.423

Openpyxl 实际上确实支持图像嵌入，并且可能更适合那些使用 .png 或现有 .xlsx 文件的人！下面的代码将图像附加到 input.xlsx 的单元格 A1 并将文件保存为 output.xlsx。

```
import matplotlib.pyplot as plt
import openpyxl

# Your plot generation code here...
plt.savefig("myplot.png", dpi = 150)

wb = openpyxl.load_workbook('input.xlsx')
ws = wb.active

img = openpyxl.drawing.Image('myplot.png')
img.anchor(ws.cell('A1'))

ws.add_image(img)
wb.save('output.xlsx') 
```

编辑 2020 年 6 月：我被告知 openpyxl 自撰写本文以来发生了变化。第 7 行应该是：

`img = openpyxl.drawing.image.Image('myplot.png')`

现在那里有一个额外的 .image 。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-08T17:11:33.843

这对我有用：

```
import openpyxl

wb = openpyxl.load_workbook('input.xlsx')
ws = wb.active

img = openpyxl.drawing.image.Image('myplot.png')
ws.add_image(ws.cell('A1'))

ws.save('output.xlsx') 
```

# javascript - 如何在jquery可拖动中固定位置？

> ID：15177707
> 
> 赞同：0
> 
> 时间：2013-03-02T18:09:55.417
> 
> 标签：javascript, jquery, jquery-ui-draggable

我正在从 mysql 数据中检索图像并将它们放在 ul li 中。现在我正在制作一个 div，其中包含可通过 jquery 拖动的项目。我想要的是当用户改变位置时，它应该自动保存。因为它不应该像第一次那样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:27:07.550

首先，您需要为要保存在数据库中的每个用户保存保存位置。为了改变位置，你需要这样的东西：

```
$('#draggable').position().top = yourSavedPosition; 
```

每次拖动后，您必须向保存每个对象位置的服务器发送一个 Ajax 请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:24:36.757

使用 CSS：

```
#draggable{
    position:fixed !important;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T18:41:26.070

你必须这样做：
`wherever user is dragging image`,

-> 找到坐标
-> 然后`enter`这些坐标在`top`和`left`位置

```
$( ".selector" ).draggable({
   stop: function(event, ui) {

  var x = ui.instance.element.position();
  $("#image1").css({"position":"fixed","left":x.left,"top":x.top});
 }
}); 
```

# asp.net - 网格视图排序

> ID：15177708
> 
> 赞同：0
> 
> 时间：2013-03-02T18:09:58.900
> 
> 标签：asp.net, gridview

我正在使用此代码在网格视图中进行排序，但这不起作用。请帮忙

```
 <asp:TemplateField SortExpression="FirstName">
                <HeaderTemplate>
                    Name
                </HeaderTemplate>
                <ItemTemplate>
                    <%# Eval("Name")%>
                </ItemTemplate>
            </asp:TemplateField> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:45:11.653

您提到您在表格标题中看不到链接。

或许能帮到你

确保您设置`AllowSorting="true"`并创建了一个事件来处理它`OnSorting="gvActivities_Sorting"`

```
 <asp:GridView runat="server" ID="gvActivities" AllowSorting="true" 
 OnSorting="gvActivities_Sorting"> 
```

如果你这样做了，你应该在标题中获得一个链接。

如果不发布所有gridview decleration

# php - php，验证表单中的未定义索引

> ID：15177710
> 
> 赞同：-3
> 
> 时间：2013-03-02T18:10:03.397
> 
> 标签：php, validation

有人可以帮我理解为什么我会收到此通知。我尝试按照此处的教程[创建表单验证](https://www.youtube.com/watch?v=tRHma2JTiL4)，但我得到了

**“注意：未定义的索引：第 53 行 ...\workspace\Registration\registerValidation.php 中的 last_name”**

```
 <?php

$errors = array();

if($_SERVER['REQUEST_METHOD'] == 'POST'){
    //validation

    $testlName = $_POST['last_name'];       

    if(preg_match("([^A-Za-z0-9])", $testlName)){
        $errors['last_name'] = "Please enter a valid last name";
    }       

//more validation code

} 

function form_row_class($name){
        global $errors;
    return $errors[$name] ? "form_error_row" : "";
}

function error_for($name){
    global $errors;
    if($errors[$name]){  //this is line 53
        return "<div class='form_error'>".$errors[$name]. "</div>";
    }
}    

?>
<form  name="form1" method="post" action="registerValidation.php" >
<table class="form">
   <tr class="<?php echo form_row_class("last_name") ?>">
    <th><label for="last_name">Last Name</label></th>
    <td>
        <input name="last_name" id="last_name" type="text" size="15" maxlength="20" value="<?php if(isset($testlName)){echo htmlspecialchars($_POST['last_name']);}?>" />
        <?php if(isset($testlName)){echo error_for('last_name');}?>
    </td>
</tr>
           </table>

<p><input type="submit" name="submit" value="register"></p> 
```

任何想法为什么我会收到通知？我是 php 新手，所以解释会很受欢迎，谢谢！

～喵喵

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:16:25.530

应该是：

`if(isset($errors[$name])) {`

当前，您正在测试`$errors[$name]`是否等于 true，如果未设置该值，则会生成通知。

可能教程开发人员没有意识到，因为很多人关闭了通知。虽然很常见，但不建议这样做 - 您应该将通知视为错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:23:02.920

尝试：

```
if(!isset($last_name)) { echo "$last_name = ""; } 
```

或者;

if(empty($last_name)) { echo "$last_name = ""; }

现在被定义。

# google-maps-markers - 如何自定义google map iOS SDK的InfoWindow？

> ID：15177712
> 
> 赞同：3
> 
> 时间：2013-03-02T18:10:11.037
> 
> 标签：google-maps-markers, google-maps-mobile, google-maps-sdk-ios

我想更改 google map iOS SDK 的 InfoWindow 的宽度。有什么办法吗？

我想要这样做的原因是在 InfoWindow 中显示完整的地址。除了自定义 InfoWindow 之外，还有其他方法吗？

另外，我可以更改 InfoWindow 中的文本大小吗？

至少，我想实现这样的地图效果： [http](http://www.google.com/about/company/facts/locations/) ://www.google.com/about/company/facts/locations/ 也可以应用超链接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-03T23:24:09.520

将地图设置`delegate`为视图控制器，然后实现谷歌地图委托方法

```
-(UIView *)mapView:(GMSMapView *) aMapView markerInfoWindow:(GMSMarker*) marker
{
    UIView *view = [[UIView alloc]init];
    //customize the UIView, for example, in your case, add a UILabel as the subview of the view
    return view;
} 
```

# c - #定义带参数的整个函数调用？

> ID：15177717
> 
> 赞同：2
> 
> 时间：2013-03-02T18:10:31.523
> 
> 标签：c, function, call, c-preprocessor

我有一个程序在两个不同的编译器上运行，每个编译器都有一个不同的文件处理库。例如在图书馆需要：

```
fwrite(buffer,size,elements,file) 
```

而另一个是：

```
f_write(file,buffer,size,elements) 
```

无论如何我可以`#define`在我的主头文件中使用一个全局的`#ifdef`语句来允许我在编译器之间无缝转换？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T18:15:50.103

当然：

```
#ifdef STUPID_COMPILER
# define fwrite(ptr, size, nitems, stream) f_write(stream, ptr, size, nitems)
#endif 
```

然后只需`fwrite()`在您的代码中使用——不需要包装函数。`f_write()`如果您使用需要的编译器/库，预处理器会将其转换为调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T18:12:43.333

您可以创建一个新功能：

```
size_t my_fwrite(...)
{
#ifdef REAL_FWRITE
    return fwrite(buffer,size,elements,file);
#elif  F_WRITE
    return f_write(file,buffer,size,elements);
#else
    #error "No fwrite"      
#endif
} 
```

* * *

什么样的实现没有提供`fwrite`但有`f_write`？

# objective-c - UICollectionView 非常慢的自定义布局

> ID：15177718
> 
> 赞同：7
> 
> 时间：2013-03-02T18:10:44.780
> 
> 标签：objective-c, cocoa-touch, uicollectionview, uicollectionviewlayout

我正在使用具有自定义布局的 UICollectionView，该布局以网格格式布置单元格。可以有超过 50 行和 50 列。滚动发生在垂直和水平。目前，我正在执行所有布局设置`prepareLayout`并将其存储在数组中：

```
- (void)prepareLayout {

     NSMutableArray *newLayoutInfo = [[NSMutableArray alloc] init];
     NSMutableArray *newLinearLayoutInfor = [[NSMutableArray alloc] init];

     NSInteger sectionCount = [self.collectionView numberOfSections];
     NSIndexPath *indexPath = [NSIndexPath indexPathForItem:0 inSection:0];

     self.heightForRows = [delegate collectionViewHeightForAllRows];

     self.totalWidthsForRows = [[NSMutableArray alloc] init];

     for (int i = 0; i < sectionCount; i++) {
       [self.totalWidthsForRows addObject:[NSNumber numberWithInt:0]];
     }
     for (NSInteger section = 0; section < sectionCount; section++) {
       NSMutableArray *cellLayoutInfo = [[NSMutableArray alloc] init];

       NSInteger itemCount = [self.collectionView numberOfItemsInSection:section];

     for (NSInteger item = 0; item < itemCount; item++) {
        indexPath = [NSIndexPath indexPathForItem:item inSection:section];

        UICollectionViewLayoutAttributes *itemAttributes = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:indexPath];
        itemAttributes.frame = [self frameForCellAtIndexPath:indexPath];

        [cellLayoutInfo addObject:itemAttributes];
        [newLinearLayoutInfor addObject:itemAttributes];
    }
    [newLayoutInfo addObject:cellLayoutInfo];
}
self.layoutInfo = newLayoutInfo;
self.linearLayoutInfo = newLinearLayoutInfor;
} 
```

然后在`layoutAttributesForElementsInRect`我有：

```
- (NSArray*)layoutAttributesForElementsInRect:(CGRect)rect {
NSArray *rows = [self.linearLayoutInfo filteredArrayUsingPredicate:[NSPredicate    predicateWithBlock:^BOOL(UICollectionViewLayoutAttributes *evaluatedObject, NSDictionary *bindings) {
    return CGRectIntersectsRect(rect, [evaluatedObject frame]);
}]]; 
```

这行得通，但是当我有超过 50 列和 50 行时，它会变得迟钝和跳跃。我现在遇到的问题是我必须设置

```
-(BOOL)shouldInvalidateLayoutForBoundsChange {
       return YES;
} 
```

这使得它在每次边界变化时都准备好整个布局，不用说，这对性能有很大的影响，你几乎不能滚动。单元格仅包含具有不透明背景的文本，因此没有问题。

我确信我做的不对，一定有更好的方法。我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-04-12T00:11:23.140

在自定义流程布局中，我这样做了，它似乎有帮助：

```
- (BOOL)shouldInvalidateLayoutForBoundsChange:(CGRect)newBounds {
    return !(CGSizeEqualToSize(newBounds.size, self.collectionView.frame.size));
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-24T04:05:08.833

```
-(BOOL)shouldInvalidateLayoutForBoundsChange {
       return YES;
} 
```

导致布局在`prepareLayout()`每次滚动时都进行，这意味着准备中的任何繁重计算都会导致实践滞后，因此解决此问题的一个可能方向是检查真正花费大量时间的内容。一种可能性是里面有什么

```
for (NSInteger section = 0; section < sectionCount; section++)
{
   // generate attributes ...
} 
```

为了生成布局的属性。每次滚动，每次这个泛化都重新运行，所以它对滚动的影响显得跳跃和笨拙。所以为了解决这个问题，或者至少理清这不是真正的麻烦，我建议在这个布局算法中设置一个标志，比如*isScrolling*，代表布局需要准备的情况。每次 `prepareLayout()`检查标志时，如果它是**YES**，那么我们就会知道没有必要执行*for 循环* 来重新生成所有属性，这些属性自第一次初始化布局以来就已经存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T21:42:55.920

好的我现在明白了。以下是我的建议：创建 3 个集合视图……一个用于列标题（每个单元格是列标题），一个用于行前导（每个单元格 = 1 个行前导），一个用于单元格的集合视图。然后当用户更改任何集合视图的滚动位置时，根据需要更新其他 2 个集合视图的滚动位置。

![在此处输入图像描述](../Images/a7c302d8467e3f16a527ed93ee85f530.png)

# jquery - 在 Twitter Bootstrap 页面上滚动时调整标题徽标的大小

> ID：15177721
> 
> 赞同：2
> 
> 时间：2013-03-02T18:11:06.497
> 
> 标签：jquery, twitter-bootstrap, navbar

我第一次尝试使用 Twitter Bootstrap 设计一个网站，并且可以在页面向下滚动时使用一些建议来调整我的徽标大小。在这里查看一个工作示例 - [http://opheliadesign.com/index_dev.php](http://opheliadesign.com/index_dev.php)

首先，这是徽标所在导航栏的 HTML：

```
<div class="navbar navbar-inverse navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a href="/index_dev.php" class="brand"></a><img src="img/logo-dark-small.png"  alt="Ophelia Design" style="float:left; margin: 5px;"/>
                    <ul class="nav" style="float: right;">
                        <li class="active"><a href="#">Home</a></li>
                        <li><a href="#">About</a></li>
                        <li><a href="#">Services</a></li>
                        <li><a href="#">Portfolio</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
            </div>
        </div> 
```

和CSS...

```
body {
          padding-top: 120px;
          padding-bottom: 40px;
        }
        div.navbar-inner {
            background: #282828 !important;
        }
        #header {
            overflow: auto;
            background: #a99472;
            padding: 4px;
            border-radius:4px;
            -webkit-border-radius: 4px;
            -moz-border-radius: 4px;
        }
        #header small {
            color: #334B2A;
        } 
```

最后，我用来调整徽标大小的 jQuery -

```
$(window).scroll(function() {
    var scrolled = $(window).scrollTop();
    if (scrolled > 48) {
        $("#logo").css({'height': '68px'});
    } else {
        $("#logo").css({'height' : '108px'});
    }
}) 
```

我的问题 - 有没有更好的方法来实现这个？尤其是更适合我的响应式 Bootstrap 设计的？此外，关于使用 css 调整大小与通过更改其`src`属性来加载另一个 img 的想法将不胜感激。

# ember.js - 使用 ember-data 删除关联模型

> ID：15177723
> 
> 赞同：11
> 
> 时间：2013-03-02T18:11:11.027
> 
> 标签：ember.js, ember-data

我有两个模型：

```
App.User = DS.Model.create({
  comments: DS.hasMany('App.Comment')
});

App.Comment = DS.Model.create({
  user: DS.belongsTo('App.User')
}); 
```

当一个用户被删除时，它也会删除它在后端的所有评论，所以我应该从客户端身份映射中删除它们。

我从另一个地方列出了系统上的所有评论，所以在删除用户后它只会崩溃。

有没有办法指定这种对关联的依赖？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-03T03:10:11.840

当我想实现这种行为时，我会使用 mixin。我的模型定义如下：

```
App.Post = DS.Model.extend(App.DeletesDependentRelationships, {
    dependentRelationships: ['comments'],

    comments: DS.hasMany('App.Comment'),
    author: DS.belongsTo('App.User')
});

App.User = DS.Model.extend();

App.Comment = DS.Model.extend({
    post: DS.belongsTo('App.Post')
}); 
```

mixin 本身：

```
App.DeletesDependentRelationships = Ember.Mixin.create({

    // an array of relationship names to delete
    dependentRelationships: null,

    // set to 'delete' or 'unload' depending on whether or not you want
    // to actually send the deletions to the server
    deleteMethod: 'unload', 

    deleteRecord: function() {
        var transaction = this.get('store').transaction();
        transaction.add(this);
        this.deleteDependentRelationships(transaction);
        this._super();
    },

    deleteDependentRelationships: function(transaction) {
        var self = this;
        var klass = Ember.get(this.constructor.toString());
        var fields = Ember.get(klass, 'fields');

        this.get('dependentRelationships').forEach(function(name) {
            var relationshipType = fields.get(name);
            switch(relationshipType) {
                case 'belongsTo': return self.deleteBelongsToRelationship(name, transaction);
                case 'hasMany': return self.deleteHasManyRelationship(name, transaction);
            }
        });
    },

    deleteBelongsToRelationship: function(name, transaction) {
        var record = this.get(name);
        if (record) this.deleteOrUnloadRecord(record, transaction);
    },

    deleteHasManyRelationship: function(key, transaction) {
        var self = this;

        // deleting from a RecordArray doesn't play well with forEach, 
        // so convert to a normal array first
        this.get(key).toArray().forEach(function(record) {
            self.deleteOrUnloadRecord(record, transaction);
        });
    },

    deleteOrUnloadRecord: function(record, transaction) {
        var deleteMethod = this.get('deleteMethod');
        if (deleteMethod === 'delete') {
            transaction.add(record);
            record.deleteRecord();
        }
        else if (deleteMethod === 'unload') {
            var store = this.get('store');
            store.unloadRecord(record);
        }
    }
}); 
```

请注意，您可以指定`deleteMethod`是否要将`DELETE`请求发送到您的 API。如果您的后端配置为自动删除相关记录，那么您将需要使用默认值。

这是一个[jsfiddle](http://jsfiddle.net/sAmJ8/)，它显示了它的作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-29T21:39:30.910

一种快速而肮脏的方法是将以下内容添加到您的用户模型中

```
destroyRecord: ->
  @get('comments').invoke('unloadRecord')
  @_super() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-04T08:32:30.277

我调整了@ahmacleod 的答案以使用`ember-cli 2.13.1`and `ember-data 2.13.0`。我遇到了嵌套关系的问题，并且在从数据库中删除一个实体后，它的 id 被重用了。这会导致与 ember-data 模型中的残余冲突。

```
import Ember from 'ember';

export default Ember.Mixin.create({
    dependentRelationships: null,

    destroyRecord: function() {
        this.deleteDependentRelationships();

        return this._super()
        .then(function (model) {
            model.unloadRecord();

            return model;
        });
    },

    unloadRecord: function() {
        this.deleteDependentRelationships();

        this._super();
    },

    deleteDependentRelationships: function() {
        var self = this;
        var fields = Ember.get(this.constructor, 'fields');

        this.get('dependentRelationships').forEach(function(name) {
            self.deleteRelationship(name);
        });
    },

    deleteRelationship (name) {
        var self = this;
        self.get(name).then(function (records) {
            if (!records) {
                return;
            }

            var reset = [];
            if (!Ember.isArray(records)) {
                records = [records];
                reset = null;
            }

            records.forEach(function(record) {
                if (record) {
                    record.unloadRecord();
                }
            });

            self.set(name, reset);
        });
    },
}); 
```

最终，我不得不将关系设置为`[]`(hasMany) 或`null`(belongsTo)。否则我会遇到以下错误消息：

`Assertion Failed: You cannot update the id index of an InternalModel once set. Attempted to update <id>.`

也许这对其他人有帮助。

# android - 在android中获取联系人并与列表进行比较

> ID：15177725
> 
> 赞同：0
> 
> 时间：2013-03-02T18:11:21.953
> 
> 标签：android, listview, arraylist, android-contacts

如何获取列表中的联系人并将每个数组与另一个列表中的数组进行比较？

就像whatsapp，viber正在工作。我正在从服务器加载联系人，然后将它们与用户的通讯录进行比较。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T07:19:10.753

有关在 Android 上访问联系人的详细说明，请参见[此处](http://developer.android.com/reference/android/provider/Contacts.html)。它还可以帮助您创建一个应用程序，`ContactsContract`尽可能使用**但**仍可在较旧的 Android 版本上运行。

# c++ - 在多线程 C++ 程序中性能不佳

> ID：15177726
> 
> 赞同：5
> 
> 时间：2013-03-02T18:11:25.253
> 
> 标签：c++, multithreading

我有一个在 Linux 上运行的 C++ 程序，其中创建了一个新线程来执行一些独立于主线程的计算成本高的工作（计算工作通过将结果写入文件来完成，这些文件最终非常大）。但是，我的表现相对较差。

如果我直接实现该程序（不引入其他线程），它会在大约 2 小时内完成任务。使用多线程程序大约需要 12 个小时来完成相同的任务（这是在仅产生一个线程的情况下测试的）。

我尝试了几件事，包括[pthread_setaffinity_np](https://www.kernel.org/doc/man-pages/online/pages/man3/pthread_setaffinity_np.3.html)将线程设置为单个 CPU（在我正在使用的服务器上可用的 24 个 CPU 中），以及[pthread_setschedparam](https://www.kernel.org/doc/man-pages/online/pages/man3/pthread_setschedparam.3.html)设置调度策略（我只尝试了 SCHED_BATCH ）。但到目前为止，这些影响可以忽略不计。

这种问题有什么一般原因吗？

编辑：我添加了一些我正在使用的示例代码，希望这是最相关的部分。函数 process_job() 是实际执行计算工作的，但在这里包含太多。基本上，它读取两个数据文件，并使用这些数据对内存中的图形数据库执行查询，其中结果在几个小时内被写入两个大文件。

编辑第 2 部分：澄清一下，问题不在于我想使用线程来提高我所拥有的算法的性能。但相反，我想同时运行我的算法的许多实例。因此，我希望算法在放入线程时以与我根本不使用多线程时相似的速度运行。

编辑第 3 部分：感谢所有建议。正如一些人建议的那样，我目前正在做一些单元测试（查看哪些部分正在减慢）。由于该程序需要一段时间来加载和执行，因此需要时间来查看测试的任何结果，因此对于迟到的回复我深表歉意。我认为我想澄清的要点是线程可能导致程序运行缓慢的可能原因。从我从评论中收集到的信息来看，根本不应该。当我找到合理的解决方案时，我会发布，再次感谢。

（最终）编辑第 4 部分：事实证明，问题毕竟与线程无关。在这一点上描述它会太麻烦（包括使用编译器优化级别），但这里发布的想法非常有用和赞赏。

```
struct sched_param sched_param = {
    sched_get_priority_min(SCHED_BATCH)
};

int set_thread_to_core(const long tid, const int &core_id) {
   cpu_set_t mask;
   CPU_ZERO(&mask);
   CPU_SET(core_id, &mask);
   return pthread_setaffinity_np(tid, sizeof(mask), &mask);
}

void *worker_thread(void *arg) {
   job_data *temp = (job_data *)arg;  // get the information for the task passed in
   ...
   long tid = pthread_self();
   int set_thread = set_thread_to_core(tid, slot_id);  // assume slot_id is 1 (it is in the test case I run)
   sched_get_priority_min(SCHED_BATCH);
   pthread_setschedparam(tid, SCHED_BATCH, &sched_param);
   int success = process_job(...);  // this is where all the work actually happens
   pthread_exit(NULL);
}

int main(int argc, char* argv[]) {
   ...
   pthread_t temp;
   pthread_create(&temp, NULL, worker_thread, (void *) &jobs[i]);  // jobs is a vector of a class type containing information for the task
   ...
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-02T18:49:42.940

如果你有足够多的 CPU 内核，并且有大量工作要做，那么在多线程模式下运行应该不会比单线程模式花费更长的时间——实际的 CPU 时间可能会长一点，但“挂钟时间”应该是更短。我很确定您的代码存在某种瓶颈，其中一个线程阻塞了另一个线程。

这是因为其中一个或多个原因 - 我将首先列出它们，然后在下面详细介绍：

1.  线程中的某些锁定阻止了第二个线程运行。
2.  线程之间的数据共享（真或“假”共享）
3.  缓存抖动。
4.  对某些外部资源的竞争导致抖动和/或阻塞。
5.  一般情况下设计糟糕的代码......

## 线程中的某些锁定阻止了第二个线程运行。

如果有一个线程需要一个锁，而另一个线程想要使用被这个线程锁定的资源，它就必须等待。这显然意味着线程没有做任何有用的事情。锁定应该保持在最低限度，只需要锁定一小段时间。使用一些代码来识别锁是否持有您的代码，例如：

```
while (!tryLock(some_some_lock))
{
    tried_locking_failed[lock_id][thread_id]++;
}
total_locks[some_lock]++; 
```

打印一些锁的统计信息将有助于确定锁在哪里有争议 - 或者你可以尝试“在调试器中按下 break 并查看你在哪里”的旧技巧 - 如果一个线程一直在等待某个锁，那么就是这样阻止进步...

## 线程之间的数据共享（真或“假”共享）

如果两个线程使用[并经常更新它的值]同一个变量，那么这两个线程将不得不交换“我已经更新了这个”消息，并且 CPU 必须从另一个 CPU 获取数据才能继续使用变量。由于“数据”在“每个缓存行”级别上共享，并且缓存行通常是 32 字节，例如：

```
int var[NUM_THREADS]; 
...
var[thread_id]++; 
```

会被归类为“虚假共享”——更新的实际数据对于每个 CPU 都是唯一的，但由于数据位于相同的 32 字节区域内，因此内核仍将更新相同的内存。

## 缓存抖动。

如果两个线程进行大量的内存读写，CPU 的缓存可能会不断地丢弃好的数据来填充另一个线程的数据。有一些技术可以确保两个线程不会在 CPU 使用的缓存部分“锁步”中运行。如果数据是 2^n（2 的幂）并且相当大（缓存大小的倍数），则为每个线程“添加偏移量”是个好主意 - 例如 1KB 或 2KB。这样，当第二个线程将相同的距离读入数据区域时，它不会完全覆盖第一个线程当前正在使用的缓存区域。

## 对某些外部资源的竞争导致抖动和/或阻塞。

如果两个线程正在读取或写入硬盘、网卡或其他一些共享资源，这可能导致一个线程阻塞另一个线程，这反过来意味着性能下降。代码也可能检测到不同的线程并进行一些额外的刷新，以确保在开始与另一个线程工作之前以正确的顺序或类似的顺序写入数据。

也可能在处理资源（用户模式库或内核模式驱动程序）的代码中存在内部锁，当多个线程使用同一资源时会阻塞。

## 一般糟糕的设计

这是“许多其他可能出错的事情”的“总括”。如果需要一个线程中的一个计算结果来处理另一个，显然，在那个线程中不能完成很多工作。

工作单元太小，所以所有时间都花在启动和停止线程上，并且没有完成足够的工作。例如，假设您向每个线程分配少量数字以“计算这是否是质数”，一次一个数字，将数字提供给线程可能比计算“这是实际上是一个素数” - 解决方案是为每个线程提供一组数字（可能是 10、20、32、64 等），然后一次性报告整个批次的结果。

还有很多其他“糟糕的设计”。如果不了解您的代码，很难确定。

您的问题完全有可能不是我在这里提到的问题，但很可能是其中之一。希望这个答案有助于确定原因。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-02T18:29:10.513

阅读[CPU Caches 和Why You Care](http://www.aristeia.com/TalkNotes/ACCU2011_CPUCaches.pdf)了解为什么从一个线程到多个线程的算法的幼稚移植往往会导致性能大大降低和负面可扩展性。*专门为并行性*设计的算法负责处理过度活跃的互锁操作、错误共享和其他导致缓存污染的原因。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-06T02:17:52.107

以下是您可能想要研究的几件事。

1°）您是否在工作线程和主线程之间输入任何关键部分（锁、信号量等）？（如果您的查询修改了图表，则应该是这种情况）。如果是这样，那可能是多线程开销的来源之一：竞争锁的线程通常会降低性能。

2°）您使用的是 24 核机器，我假设它是 NUMA（非统一内存访问）。由于您在测试期间设置了线程关联性，因此您应该密切注意硬件的内存拓扑。查看 /sys/devices/system/cpu/cpuX/ 中的文件可以帮助您解决这个问题（注意 cpu0 和 cpu1 不一定靠得很近，因此不一定共享内存）。大量使用内存的线程应该使用本地内存（分配在与它们正在执行的核心相同的 NUMA 节点中）。

3°）您大量使用磁盘 I/O。那是哪种 I/O？如果每个线程每次都执行一些同步 I/O，您可能需要考虑异步系统调用，以便操作系统负责将这些请求调度到磁盘。

4°）其他答案中已经提到了一些缓存问题。从经验来看，虚假分享可能会像您观察到的那样严重损害表演。我的最后一个建议（这应该是我的第一个）是使用分析器工具，例如 Linux Perf 或 OProfile。由于您正在经历这种性能下降，原因肯定会非常清楚地出现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-07T23:19:33.283

其他答案都解决了可能导致您出现症状的一般准则。我会给出我自己的，希望不是过度冗余的版本。然后我将谈谈如何在考虑到所有讨论的情况下找到问题的根源。

一般来说，您希望多线程性能更好有几个原因：

*   一项工作依赖于某些资源（磁盘、内存、缓存等），而其他工作可以独立于这些资源或所述工作负载进行。
*   您有多个 CPU 内核可以并行处理您的工作负载。

上面列举的主要原因是，您希望多个线程执行得不太好，这都是基于资源争用：

*   磁盘争用：已经详细解释过，可能是一个问题，尤其是当您一次写入小缓冲区而不是批处理时
*   如果线程被安排在同一个核心上，则 CPU 时间争用：如果您设置亲和力，可能不是您的问题。但是，您仍然应该仔细检查
*   缓存抖动：如果您有亲和力，同样可能不是您的问题，但如果这是您的问题，这可能会非常昂贵。
*   共享内存：再次详细讨论，似乎不是您的问题，但审核代码以检查它不会有什么坏处。
*   NUMA：再次谈到。如果您的工作线程被固定到不同的核心，您将需要检查它需要访问的工作是否在主核心本地。

好的，到目前为止没有多少新东西。它可以是上述任何一种，也可以不是。问题是，对于您的情况，您如何检测额外时间的来源。有几个策略：

*   审核代码并寻找明显的区域。不要花太多时间来做这件事，因为如果你一开始就编写程序，这通常是徒劳的。
*   重构单线程代码和多线程代码以隔离一个 process() 函数，然后在关键检查点进行分析以尝试解释差异。然后缩小范围。
*   将资源访问重构为批次，然后在控制和实验上对每个批次进行分析以说明差异。这不仅会告诉您需要将精力集中在哪些领域（磁盘访问、内存访问和花费时间），而且进行此重构甚至可能会提高您的整体运行时间。例子：
    *   首先将图结构复制到线程本地内存（在单线程情况下执行直升复制）
    *   然后执行查询
    *   然后设置异步写入磁盘
*   尝试找到具有相同症状的最小可重现工作负载。这意味着改变你的算法来做它已经做的事情的一个子集。
*   确保系统中没有其他可能导致差异的噪音（如果其他用户在工作核心上运行类似的系统）。

我对您的情况的直觉：

*   您的图形结构对您的工作核心不是 NUMA 友好的。
*   内核实际上可以将您的工作线程调度到亲和核心之外。如果您没有为要固定的核心打开 isolcpu，则可能会发生这种情况。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-09T05:09:57.457

我不能告诉你你的程序出了什么问题，因为你没有分享足够的内容来进行详细的分析。

我可以告诉你的是，如果这是我的问题，我会尝试的第一件事是在我的应用程序上运行两个分析器会话，一个在单线程版本上，另一个在双线程配置上。探查器报告应该让您很好地了解额外时间的去向。请注意，您可能不需要分析整个应用程序运行，根据问题，在您分析几秒钟或几分钟后，时间差异可能会变得明显。

至于 Linux 的分析器选择，您可能需要考虑[oprofile](http://oprofile.sourceforge.net/news/)或作为第二选择[gprof](http://www.cs.utah.edu/dept/old/texinfo/as/gprof_toc.html)。

如果您发现需要帮助解释分析器输出，请随时将其添加到您的问题中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-09T07:42:25.970

追查线程未按计划工作的原因可能是一个正确的痛苦。可以分析地这样做，或者可以使用工具来显示正在发生的事情。我在 ftrace 上取得了很好的成绩，Linux 的 Solaris dtrace 的克隆（它又基于 VxWorks、Greenhill 的 Integrity OS 和 Mercury Computer Systems Inc 长期以来一直在做的事情。）

特别是我发现这个页面非常有用：[http](http://www.omappedia.com/wiki/Installing_and_Using_Ftrace) ://www.omappedia.com/wiki/Installing_and_Using_Ftrace ，尤其是[这个](http://www.omappedia.com/wiki/Installing_and_Using_Ftrace#Sched_switch_Tracer)和[这个](http://www.omappedia.com/wiki/Installing_and_Using_Ftrace#Sched_switch_viewer)部分。不要担心它是一个面向 OMAP 的网站；我已经在 X86 Linux 上很好地使用了它（尽管您可能必须构建一个内核来包含它）。另请记住，GTKWave 查看器主要用于查看来自 VHDL 开发的日志跟踪，这就是它看起来“奇怪”的原因。只是有人意识到它也是 sched_switch 数据的可用查看器，这让他们免于编写一个。

使用 sched_switch 跟踪器，您可以查看线程何时（但不一定是为什么）运行，这可能足以为您提供线索。“为什么”可以通过仔细检查其他一些示踪剂来揭示。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-11T17:06:54.183

我怀疑您正在一台带有一个单核处理器的机器上运行。这个问题在那种系统上是不可并行的。您的代码一直在使用处理器，它有固定数量的周期提供给它。它实际上运行得更慢，因为额外的线程为问题增加了昂贵的上下文切换。

唯一能在单处理器机器上很好地并行化的问题是那些允许一个执行路径运行而另一个被阻塞等待 I/O 的问题，以及允许一个线程获取的情况（例如保持响应式 GUI）一些处理器时间比尽快执行代码更重要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-11T19:35:03.880

如果您只想运行算法的许多独立实例，您可以将多个作业（具有不同参数，可以由单个脚本处理）提交到您的集群吗？这将消除分析和调试多线程程序的需要。我在多线程编程方面没有太多经验，但是如果您使用 MPI 或 OpenMP，那么您也必须为簿记编写更少的代码。例如，如果需要一些通用的初始化例程并且进程可以在之后独立运行，您可以通过在一个线程中初始化并进行广播来做到这一点。无需维护锁等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-10T17:03:52.070

如果您因使用 1 个线程而变慢，则可能是由于使用线程安全库函数或线程设置的开销。为每个作业创建一个线程会导致显着的开销，但可能没有您所指的那么多。换句话说，它可能是一些线程安全库函数的一些开销。

最好的办法是分析您的代码以找出时间花在哪里。如果它在库调用中，请尝试找到替换库或自己实现它。如果瓶颈是线程创建/销毁尝试重用线程，例如在 C++11 中使用 OpenMP 任务或 std::async。

有些库真的很讨厌线程安全开销。例如，许多 rand() 实现使用全局锁，而不是使用线程本地 prgn。这种锁定开销比生成数字要大得多，并且如果没有分析器就很难跟踪。

减速也可能源于您所做的小更改，例如声明变量 volatile，这通常不是必需的。

# android - 检查是否可以在 Android 中设置滚动壁纸

> ID：15177732
> 
> 赞同：3
> 
> 时间：2013-03-02T18:12:19.450
> 
> 标签：android, scroll

现在我在wallapapers 应用程序工作，并且有一个问题。在带有设置壁纸的屏幕上，我有 3 个按钮：所有图片 | 没有卷轴的图片| 高分辨率照片| CLIPARTO 图片滚动！在 1 和 2 情况下都很好，但在 3 中我不知道如何从系统中获取此选项。现在在我的代码中，我检查 android 版本 < 2.3.6 或 getDesiredMinimumWidth() <= 0 然后启用滚动的按钮：

```
if (wpm.getDesiredMinimumWidth() <= 0 || 
        Build.VERSION.SDK_INT < Build.VERSION_CODES.GINGERBREAD) {  
            float tmp_width = opt_display_width*2 / metrics.density;

            opt_display_width_tmp_scroll = (int)tmp_width;

            scrollable_available = true;
        } else {
            opt_display_width_tmp_original = opt_display_width;

            scrollable_available = false;
        } 
```

但它仅适用于 android 2.3.6 版本，以及我如何使用 android 版本 4 获取其他参数 | 3

# matplotlib - 基于“标签掩码”的轮廓

> ID：15177733
> 
> 赞同：0
> 
> 时间：2013-03-02T18:12:31.627
> 
> 标签：matplotlib

我有使用轮廓算法提取特征的图像（我正在进行天体物理源提取）。这种方法产生了一个“特征图”，每个像素都用一个整数“标记”（通常每张图有约 1000 个独特的特征）。

我想将每个单独的特征显示为它自己的轮廓。

我可以做到这一点的一种方法是：

```
for ii in range(labelmask.max()):
    contour(labelmask,levels=[ii-0.5]) 
```

但是，这非常慢，尤其是对于大图像。有没有更好（更快）的方法？

PS 一个小测试表明[skimage 的 find-contours](http://scikit-image.org/docs/dev/api/skimage.measure.html#skimage.measure.find_contours)并不快。

根据@tcaswell 的评论，我需要解释为什么`contour(labels, levels=np.unique(levels)+0.5))`或类似的东西不起作用：

```
1\. Matplotlib spaces each subsequent contour "inward" by a linewidth to avoid overlapping contour lines.  This is not the behavior desired for a labelmask.
2\. The lowest-level contours encompass the highest-level contours
3\. As a result of the above, the highest-level contours will be surrounded by a miniature version of whatever colormap you're using and will have extra-thick contours compared to the lowest-level contours. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:12:28.410

很抱歉回答我自己的问题......不耐烦（和好运）让我变得更好。

关键是使用 matplotlib 的低级 C 例程：

```
I = imshow(data)
E = I.get_extent()
x,y = np.meshgrid(np.linspace(E[0],E[1],labels.shape[1]), np.linspace(E[2],E[3],labels.shape[0]))

for ii in np.unique(labels):
    if ii == 0: continue
    tracer = matplotlib._cntr.Cntr(x,y,labels*(labels==ii))
    T = tracer.trace(0.5)
    contour_xcoords,contour_ycoords = T[0].T
    # to plot them:
    plot(contour_xcoords, contour_ycoords) 
```

请注意，这`labels*(labels==ii)`会将每个标签的轮廓放在稍微不同的位置；`labels==ii`如果您想要在相邻标签之间重叠轮廓，请将其更改为。

# java - AsynchronousFileChannel.read(...) 中的异常管理

> ID：15177734
> 
> 赞同：2
> 
> 时间：2013-03-02T18:12:32.290
> 
> 标签：java, file-io, asynchronous, exception-handling

`java.nio.channels.AsynchronousFileChannel`提供两种从文件中读取数据的方法：

1.  `read(dst, position, attachment, handler)`完成后将调用提供的处理程序
2.  `read(dst, position)`返回一个`Future`允许我`get()`得到操作结果的

`CompletionHandler`接口指定了一个方法`failed(Throwable exc, A attachment)`，而没有`Future`。它只能选择`ExecutionException`从其`get()`方法中抛出一个。

***假设我从片状磁盘上读取文件，并且磁盘抛出 IO-Error，在这两种情况下将如何处理？***

具体来说，我有以下 3 个问题：

1.  会调用`failed()`上的方法吗？`CompletionHandler`或者它会将操作指示为`completed`的结果`-1`？
2.  该`get()`方法会`Future`抛出异常，还是会简单地`-1`作为读取结果返回？
3.  如果`-1`在任何一种情况下都返回，我如何区分 IO-Error 和简单的 EOF 条件（最好没有像操作计时这样的黑客攻击）？

出于某种原因，我找不到任何关于此的文档...

# php - 如何解决“无法通过套接字连接到本地 MySQL 服务器”

> ID：15177742
> 
> 赞同：4
> 
> 时间：2013-03-02T18:14:07.050
> 
> 标签：php, mysql, connection

这是我的配置文件：

```
$mysql_hostname = "localhost";
$mysql_user = "xyz";
$mysql_password = "abc";
$mysql_database = "mno";

$IT = mysql_connect($mysql_hostname, $mysql_user, $mysql_password) or die("Opps some thing went wrong");
mysql_select_db($mysql_database, $IT) or die("Opps some thing went wrong"); 
```

这是我从中得到的警告：

> 警告：mysql_connect() [function.mysql-connect]: 无法通过 /home/content/03/10531303/html/ 中的套接字 '/var/lib/mysql/mysql.sock' (2) 连接到本地 MySQL 服务器iqamah.org/config.php 第 13 行

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:32:28.340

请指定您正在运行的系统。如果凭据正常，这可能是 mysql 服务器的问题。如果您使用的是 linux，请检查此行是否在控制台上返回某些内容。如果没有，您的服务器没有运行：

```
# netstat -apn | grep mysql 
```

您也可以在这里尝试连接到 mysql，以便检查您的凭据是否正常：

```
# mysql -h localhost -u user database 
```

如果您在 Windows 上，只需检查服务是否正在运行：

1.  视窗键 + R
2.  类型`services.msc`
3.  检查`msyql`服务是否正在运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-15T21:45:09.237

我有完全相同的问题

1.  我验证了 mysql.sock 存在
2.  在 database.php 配置文件中将 localhost 更新为 127.0.0.1。 *（user166390 评论）*
3.  我还在 admin/expressionengine/ 文件夹中为日志创建了一个文件夹
4.  在 config.php 文件中配置错误日志级别
5.  以及同一个 config.php 文件中日志文件夹的路径

希望对遇到同样问题的人有所帮助。特别是当日志文件夹不存在以进行故障排除时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T18:16:05.197

仅当连接参数错误时才会出现错误，请确保以下凭据正确

```
$mysql_hostname = "localhost";
$mysql_user = "xyz";
$mysql_password = "abc"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T18:21:45.317

如果无法连接数据库，则意味着执行过程中的某个地方有问题。修改您的主机名、用户、密码和数据库名称。然后确保数据库是否真的在您的服务器上，并且您已将用户数据写入代码 - 使用终端或类似的东西登录......

但是`on line 13`意味着，你必须在第 13 行搜索问题。检查这一行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-02T18:33:55.277

首先检查你的数据库是否真的在监听；通过调用来做到这一点

```
netstat -a 
```

你应该看到这样的东西

```
TCP    0.0.0.0:3306           MyComputer:0               LISTEN 
```

如果您没有在端口 3306 上看到侦听进程，则您的数据库未（正确）启动或使用另一个端口。仔细检查您的环境。如果它是 WAMP/LAMP 系统，您可以检查您的管理页面的`phpinfo()`部分（*mysqli*部分）

如果您的端口与标准端口不同，请尝试添加适当的端口，例如

```
$link = mysql_connect('example.com:3331', 'mysql_user', 'mysql_password'); 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2016-10-14T23:49:36.130

<警告：mysql_connect()：无法通过套接字'/var/lib/mysql/mysql.sock'连接到本地MySQL服务器

从这里阅读了一些好的建议后。我的对我有用。我尝试删除“本地主机”并添加 127.0.0.1，它就像魔术一样工作，每个人都在这里贡献了

# ios - 苹果官方Demo tableview插入行问题

> ID：15177743
> 
> 赞同：2
> 
> 时间：2013-03-02T18:14:16.210
> 
> 标签：ios, animation, tableview

我在学习官方演示 iPhoneCoreDataRecipes 时发现了一个问题。

场景是这样的：

有一个表格视图显示一些数据行。单击编辑按钮时，会出现一个附加行，其中包含一些文本，例如：添加一个新的 xxx。单击该行时，您可以在 tableview 中创建新的数据行。

当再次单击编辑按钮时，该行消失并且表格视图处于显示模式。

`UITableViewCellEditingStyleInsert`除了添加新行之外，每一行在编辑时也有一个样式。

问题是在编辑和显示模式之间切换时，附加的“添加”行出现和消失，并且它的动画影响了它上面的行（最后一行）的动画。

有没有人遇到过这个问题，有人知道如何解决吗？

![在此处输入图像描述](../Images/e2945da0965cf662a73f789d580e275c.png)

在编辑和显示模式之间切换时，添加成分行会出现和消失。它上方的线（糖线）的动画受到影响，并且与它上方的线不同。

![在此处输入图像描述](../Images/dad1cccb740cf049e880728a11862b9f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T13:47:10.463

如果在`setEditing:animated:`in 中`RecipeDetailViewController.m`移动此行，则会得到改进：

```
[super setEditing:editing animated:animated]; 
```

在括号内调用

```
[self.tableView beginUpdates]; 
```

和

```
[self.tableView endUpdates]; 
```

# javascript - 需要 Mootools AMD 模块

> ID：15177744
> 
> 赞同：0
> 
> 时间：2013-03-02T18:14:16.897
> 
> 标签：javascript, mootools, requirejs, amd

我刚刚下载[了 arian/Mootool](https://github.com/arian/mootools-core/tree/1.5amd)并查看了 1.5amd 分支。我已经建立了一个简单的项目并需要 Element 模块。出于某种原因，它出现在 dom 中，但在源中未定义。

```
define(function(require) {

    domReady = require('require/domReady');
    Element = require('mootools/Element/Element');

    domReady(function() {
        console.log Element // undefined
    });

}); 
```

任何想法如何或为什么会发生？

知道我正在使用 RequireJS 2.1.4 可能会有所帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:26:54.760

首先，我认为 Arian 的`mootools-amd`实验有点被遗弃，实际上不应该使用。mootools 2（又名 Prime）是用 CommonJS 编写的，可以使用`wrapup`.

其次，您需要在外部函数运行之前需要一些东西，否则 - 不能保证 Element 在您引用它时会被解析。

所以：

```
define([
    'require/domReady', 
    'mootools/Element/Element
'], function(domReady, Element){
    Element; 
}); 
```

# ios - 如何使用 RestKit 指定关系？

> ID：15177747
> 
> 赞同：1
> 
> 时间：2013-03-02T18:14:38.463
> 
> 标签：ios, objective-c, cocoa-touch, rest, restkit

我正在尝试使用 RestKit 将一些 JSON 映射到我的核心数据实体。

我有一个`Case`实体，该实体具有一个`caseId`属性，并且与一个`Binder`名为`binders`. 该实体与被调用的`Binder`对象具有反向的一对一关系，这不是可选的。`Case``case`

我可以成功映射`Case`实体，但在映射实体时遇到问题`Binder`。

我的映射设置如下：

```
RKEntityMapping *caseEntityMapping = [RKEntityMapping mappingForEntityForName:@"Case" inManagedObjectStore:managedObjectStore];
[caseEntityMapping addAttributeMappingsFromArray:[@"caseId"]];

RKEntityMapping *binderEntityMapping = [RKEntityMapping mappingForEntityForName:@"Binder" inManagedObjectStore:managedObjectStore];

NSString *pathPattern = @"rest/case/list";

[router.routeSet addRoute:[RKRoute routeWithName:@"getCases" pathPattern:pathPattern method:RKRequestMethodGET]];

RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:caseEntityMapping pathPattern:pathPattern keyPath:@"data" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[_objectManager addResponseDescriptor:responseDescriptor];

pathPattern = @"rest/binder/list/:caseId";

[router.routeSet addRoute:[RKRoute routeWithRelationshipName:@"binders" objectClass:[PFCase class] pathPattern:pathPattern method:RKRequestMethodGET]];

RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:binderEntityMapping pathPattern:pathPattern keyPath:@"data" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[_objectManager addResponseDescriptor:responseDescriptor]; 
```

我通过使用获取案例`[_objectManager getObjectsAtPathForRouteNamed:@"getCases" object:nil parameters:nil success:… failure:…]`，然后在成功块内，通过执行使用创建的请求操作获取每个案例的活页夹`[_objectManager requestWithPathForRelationship:@"binders" ofObject:mappedCase method:RKRequestMethodGET parameters:nil]`。

但是没有活页夹的映射结果。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T17:54:31.883

我必须将外键 RKConnectionDescription 添加到活页夹实体映射中，这需要我为`Binder`名为`caseId`.

有什么方法可以做到这一点而不必创建新属性？另外，什么时候需要/什么时候需要的关键路径 RKConnectionDescription？

# vba - Excel 2010 VBA 突出显示不同颜色的单元格，跨多列具有不同的重复值

> ID：15177752
> 
> 赞同：3
> 
> 时间：2013-03-02T18:15:31.223
> 
> 标签：vba, excel

如何使用不同颜色突出显示 Excel 2010 中跨多个列的重复单元格？

我找到了这段代码，但它适用于一列。

```
 Sub Highlight_Duplicate_Entry()
        Dim cel As Variant
        Dim myrng As Range
        Dim clr As Long

        Set myrng = Range("A2:A" & Range("A65536").End(xlUp).Row)
        myrng.Interior.ColorIndex = xlNone
        clr = 3

        For Each cel In myrng
           If Application.WorksheetFunction.CountIf(myrng, cel) > 1 Then
              If WorksheetFunction.CountIf(Range("A2:A" & cel.Row), cel) = 1 Then
                 cel.Interior.ColorIndex = clr
                 clr = clr + 1
              Else
                 cel.Interior.ColorIndex = myrng.Cells(WorksheetFunction.Match(cel.Value, myrng, False), 1).Interior.ColorIndex
              End If
          End If
       Next
    End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T22:18:57.670

您需要更改范围以覆盖多列，这将导致您的`Match`功能失败。将其替换为`Find`。下面的子程序将找到指定范围内的任何重复项，并用不同的颜色突出显示它们。

将您的代码替换为以下内容：

```
Sub Highlight_Duplicate_Entry()
    Dim ws As Worksheet
    Dim cell As Range
    Dim myrng As Range
    Dim clr As Long
    Dim lastCell As Range

    Set ws = ThisWorkbook.Sheets("Sheet1")
    Set myrng = ws.Range("A2:d" & Range("A" & ws.Rows.Count).End(xlUp).Row)
    With myrng
        Set lastCell = .Cells(.Cells.Count)
    End With
    myrng.Interior.ColorIndex = xlNone
    clr = 3

    For Each cell In myrng
        If Application.WorksheetFunction.CountIf(myrng, cell) > 1 Then
            ' addresses will match for first instance of value in range
            If myrng.Find(what:=cell, lookat:=xlWhole, MatchCase:=False, after:=lastCell).Address = cell.Address Then
                ' set the color for this value (will be used throughout the range)
                cell.Interior.ColorIndex = clr
                clr = clr + 1
            Else
                ' if not the first instance, set color to match the first instance
                cell.Interior.ColorIndex = myrng.Find(what:=cell, lookat:=xlWhole, MatchCase:=False, after:=lastCell).Interior.ColorIndex
            End If
        End If
    Next
End Sub 
```

根据下面的评论添加结果的屏幕截图，以帮助阐明其工作原理。每组重复项都以单独的颜色突出显示。不重复的值没有颜色： ![在此处输入图像描述](../Images/c62a3aa0d0bb1c14b594dd42be5bc6f1.png)

# c# - 将 VLC 编解码器添加到用 C# windows 8 商店应用程序编写的媒体播放器

> ID：15177758
> 
> 赞同：0
> 
> 时间：2013-03-02T18:16:14.917
> 
> 标签：c#, media-player, windows-store-apps, video-codecs

我会尽量直接

如何从 VLC 媒体播放器源代码中获取编解码器并将它们集成到我用 C# 编写的媒体播放器 windows 8 应用程序中

PS：我想在商店中发布这个应用程序，这样任何人下载它都不需要安装编解码器和东西

我希望这次我的问题很简单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T00:29:01.133

为了在 Windows 8 环境中重用代码，您可能必须解决 3 个不同的问题。

1.VLC / VideoLan 源的许可类型是什么？

从这个链接[http://www.videolan.org/legal.html](http://www.videolan.org/legal.html)可以清楚地看出，`VideoLan`项目下的源代码包含在**GPL**之下。使用此处捕获的 GPL 软件有一些限制/建议[http://www.gnu.org/licenses/gpl-2.0.html#SEC3](http://www.gnu.org/licenses/gpl-2.0.html#SEC3)。假设您能够满足所有要求，我们将进入下一个问题。

2.GPL软件是否兼容Windows 8环境？

这是一个非常重要的问题。我不知道 Windows 8 许可条款和条件，但我觉得这对您来说绝对是一个重要的问题。

除了交叉许可问题，我觉得对您来说**最关键的问题**是

3.谁支付不同编解码器的版税或专利费或法律费用？

每个编解码器都有自己独特的条款和条件以及许可模型集合。作为应用程序开发人员，您是否收取任何费用并反过来设法支付所有标准化机构，或者您是否有设备制造商/最终用户支付版税的模式？

# r - 将元素类型从字符切换为数字？

> ID：15177760
> 
> 赞同：0
> 
> 时间：2013-03-02T18:16:32.487
> 
> 标签：r, character, numeric

我有带有数字的 3D 矩阵，但 R 以某种方式将数字数据视为字符。我加载的文件是数字向量。但是一旦我将它们放入 3D 向量中，所有数据编号都会显示为“字符”，如下所示：

```
 [,1]   [,2]   [,3]   [,4]   [,5]   [,6]  
  [1,] "3.79" "3.79" "2.33" "2.33" "2.79" "2.79"
  [2,] "3.79" "3.79" "2.33" "2.33" "2.79" "2.79"
  [3,] "3.02" "3.02" "4.94" "4.94" "4.33" "4.33"
  [4,] "3.02" "3.02" "4.94" "4.94" "4.33" "4.33"
  [5,] "4.25" "4.25" "4.06" "4.06" "4.98" "4.98"
  [6,] "4.25" "4.25" "4.06" "4.06" "4.98" "4.98"
  [7,] "4.25" "4.25" "4.06" "4.06" "4.98" "4.98"
  [8,] "2.07" "2.07" "2.09" "2.09" "2.92" "2.92" 
```

但在我放入 3D 矩阵之前，数据显示如下：

```
[39965] 3.68230769 3.68230769 3.68230769 2.96454545
[39969] 2.96454545 3.93600000 3.93600000 3.93600000
[39973] 3.67769231 3.67769231 3.67769231 5.12750000
[39977] 5.12750000 5.12750000 3.05083333 3.05083333
[39981] 3.05083333 1.94166667 1.94166667 1.69000000
[39985] 1.69000000 1.69000000 2.01769231 2.01769231
[39989] 2.01769231 3.05692308 3.05692308 3.05692308
[39993] 3.72916667 3.72916667 3.72916667 2.65454545
[39997] 2.65454545 2.45583333 2.45583333 2.45583333 
```

这是我的代码：

```
for (i in 1: length(precipitation)) {
    precip <- read.csv(precipitation[i])
    precip[is.na(precip)] <- 0

    precip2<- precip[,-1]
    precip3<-as.vector(unlist(precip2))
    prep_data[,,i]<-matrix(precip3,ncol=200,nrow=200)
} 
```

是否可以添加一些编码来解决这个问题，所以我所有的 3D 矩阵元素都是数字，而不是“数字”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:29:36.320

用于`as.numeric`将某些内容转换为数字。通常，`as.class`转换为该类（数字、字符、因子、日期、data.frame、矩阵等等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:04:50.210

您可以使用 colClasses 参数将输入数据强制到特定类。下面的代码可能会在您的代码中替代 read.csv 调用，如果遇到非数字条目，它将生成警告，但将确保好的数据是数字的：

```
precip <- read.csv(precipitation[i], colClasses="numeric" ) 
```

# sql - 如何自动生成日期（周末）和 0 值

> ID：15177763
> 
> 赞同：0
> 
> 时间：2013-03-02T18:16:52.450
> 
> 标签：sql, sqlite

我目前有一个图表，显示基于以下 SQL 的每个日期的总工作小时数。

```
select sum(hours)/40 from resource where project IN ('Admin', 'Absence','Enhancements') group by date; 
```

桌子看起来像这样。

![桌子](../Images/8fa7ebc5a52704806f4eb3a69215acc4.png)

只要每个日期的每个值都有一个条目，这一切都可以正常工作并显示图表。否则，它会错过日期并且数据显示不同步。

我在想一个解决方案是有一些 SQL 每周为所有字段的临时人员（AdminUser）生成 0 值，这会阻止这种情况，但我不确定这是否是最好的解决方案，因为我的 SQL 相当基本的。或者我应该为每个字段添加一列而不是下面？

这里最好的解决方案是什么？而sql来执行呢？

DN：SQLITE

结构：

![结构](../Images/9f35da03961cbaeb3cd22a7f2ff8728a.png)

唯一索引 - 当日期、名称和项目匹配时更新值而不是添加新值

![唯一索引](../Images/da108a45fb1e660869d76890f55a75b0.png)

注意：以下 SQL 用于生成图表的 X 轴 - 日期：

```
select distinct(date) from resource; 
```

如果有帮助，这就是图表的样子。

![图形](../Images/f65ee659b50da545e937e9cfd1db7ebf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:32:33.750

根据我对您的要求的理解，我将使用 CASE 声明，如下所示：

```
 select 
case when sum(hours) > 0 Then
    CAST(CAST(SUM(hours) as DECIMAL(5,2))/40 AS Decimal(5,2))
else 0 end as [hours],
[DATE]
from resource group by date 
```

这就是说，如果小时数大于零，则使用您的公式，否则返回 0。值得首先检查您的 ANSI NULLS 设置。Resource.Hours 必须是整数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T20:35:46.507

我认为日历表会对您有很大帮助。

```
pragma foreign_keys = on;

create table calendar (
  calendar_date date primary key
);

insert into calendar values ('2013-02-01');
insert into calendar values ('2013-02-02');
insert into calendar values ('2013-02-03');
insert into calendar values ('2013-02-04');
insert into calendar values ('2013-02-05');
insert into calendar values ('2013-02-06');
insert into calendar values ('2013-02-07');
insert into calendar values ('2013-02-08');
insert into calendar values ('2013-02-09');
insert into calendar values ('2013-02-10');
insert into calendar values ('2013-02-11');
insert into calendar values ('2013-02-12');
insert into calendar values ('2013-02-13'); 
```

还有一个项目表。

```
create table projects (
  project_name varchar(16) primary key
);

insert into projects values ('Admin');
insert into projects values ('Absence');
insert into projects values ('Enhancements'); 
```

因为 SQLite 在外连接的实现上很吝啬，所以使用视图来使这更容易。

```
create view project_dates as 
select c.calendar_date, p.project_name 
from calendar c, projects p; 
```

现在您可以从该视图中进行选择，并在从表“资源”中引入数据时使用左连接来保留这些行。我插入了一些列，这样你就可以看到发生了什么。

```
select p.calendar_date, p.project_name, 
       ifnull(sum(r.hours), 0) total_hrs, 
       ifnull(sum(r.hours)/40, 0) divided_hrs
from project_dates p
left join resource r
       on r.date = p.calendar_date
      and r.project = p.project_name
where p.calendar_date between '2013-02-03' and '2013-02-10'
group by p.calendar_date, p.project_name
order by p.calendar_date, p.project_name;

calendar_date    project_name    total_hrs divided_hrs
--
2013-02-03       Absence         0         0          
2013-02-03       Admin           80        2          
2013-02-03       Enhancements    40        1          
2013-02-04       Absence         0         0          
2013-02-04       Admin           0         0          
2013-02-04       Enhancements    0         0          
2013-02-05       Absence         0         0          
2013-02-05       Admin           0         0          
2013-02-05       Enhancements    0         0          
2013-02-06       Absence         0         0          
2013-02-06       Admin           0         0          
2013-02-06       Enhancements    0         0          
2013-02-07       Absence         0         0          
2013-02-07       Admin           0         0          
2013-02-07       Enhancements    0         0          
2013-02-08       Absence         0         0          
2013-02-08       Admin           0         0          
2013-02-08       Enhancements    0         0          
2013-02-09       Absence         0         0          
2013-02-09       Admin           0         0          
2013-02-09       Enhancements    0         0          
2013-02-10       Absence         0         0          
2013-02-10       Admin           0         0          
2013-02-10       Enhancements    30        0 
```

# java - Java Ant 错误：ClassNotFoundException

> ID：15177767
> 
> 赞同：1
> 
> 时间：2013-03-02T18:17:01.037
> 
> 标签：java, ant, junit

我是 Ant 的初学者，但在尝试使用 JUnit 时遇到问题：

```
<target name="test" depends="compile" description="JUnit Tests">
    <junit printsummary="yes" failureproperty="junit.failure" fork="yes">
        <classpath refid="junit.classpath"/>
        <classpath path="${myAntTestBin.dir}"/>
        <formatter type="plain" usefile="false"/>
        <test name="fr.isima.myAntTest.ProjectTest"/>
    </junit>
</target> 
```

但是现在，我有这些错误：

```
test:
    [junit] Running fr.isima.myAntTest.ProjectTest
    [junit] Testsuite: fr.isima.myAntTest.ProjectTest
    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec
    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec
    [junit]
    [junit]     Caused an ERROR
    [junit] fr.isima.myAntTest.ProjectTest
    [junit] java.lang.ClassNotFoundException: fr.isima.myAntTest.ProjectTest
    [junit]     at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    [junit]     at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    [junit]     at java.security.AccessController.doPrivileged(Native Method)
    [junit]     at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    [junit]     at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    [junit]     at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)

    [junit]     at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    [junit]     at java.lang.Class.forName0(Native Method)
    [junit]     at java.lang.Class.forName(Class.java:186)
    [junit]
    [junit] Test fr.isima.myAntTest.ProjectTest FAILED 
```

问题是什么 ？先感谢您 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:18:58.757

我怀疑这是问题所在：

```
<test name="${myAntTestBin}/ProjectTest.class"/> 
```

它正在寻找类的名称，而不是位置：

```
<test name="ProjectTest"/> 
```

...如果合适的话，用一个包名来限定它（当然，你真的应该有）。例如：

```
<test name="foo.bar.ProjectTest" /> 
```

而且，正如 JB Nizet*所*提到的，这：

```
<classpath path="${myAntTestBin}"/> 
```

应该：

```
<classpath path="${myAntTestBin.dir}"/> 
```

与您的声明相匹配：

```
<property name="myAntTestBin.dir" value="../myAntTest/bin/fr/isima/myAntTest"/> 
```

编辑：现在您已经（完全）编辑了问题，看起来您的类路径错误，实际上应该是：

```
<property name="myAntTestBin.dir" value="../myAntTest/bin"/> 
```

类路径应该是包含您的类的目录结构的*基础*。这就像在普通 Java 中运行时一样：

```
java -cp bin foo.bar.Baz 
```

如果您的目录结构`bin/foo/bar`包含`Baz.class`.

# visual-studio - 在 IDE 中加载框架/库（openGL）的引用

> ID：15177769
> 
> 赞同：1
> 
> 时间：2013-03-02T18:17:08.710
> 
> 标签：visual-studio, opengl

我正在使用 Visual Studio 2012 创建使用 OpenGL 3.2 及更高版本的图形项目。每当我编写代码时，我总是有两个窗口处于活动状态：IDE 和 Firefox，Firefox 在 OpenGL 的参考页面上打开。

我想知道是否有一种方法可以获取 OpenGL 的参考文件并将其加载到 Visual Studio 中，这样当我输入方法/类/常量名称时，它会给我一个简短的上下文，说明这个方法/类/常量名称是什么关于。

当我使用库时，在 Eclipse 中就是这种情况，它会显示描述，这是一个非常有用的特性。

# qt - 替代 QButtonGroup 不允许选择？

> ID：15177771
> 
> 赞同：5
> 
> 时间：2013-03-02T18:17:23.237
> 
> 标签：qt, radio-button

我正在编写一个`qt`基于 - 的 c++ 应用程序。我有许多按钮，我希望它们是互斥的——一次只能切换一个。我通常为此使用[QButtonGroup](http://qt-project.org/doc/qt-4.8/qbuttongroup.html) - 它提供了一种很好的逻辑方式来管理按钮集。当一个被按下时，之前按下的那个被释放，这正是我想要的行为。

然而，这一次，我想允许该组完全不受检查。不幸的是，这似乎是不允许的`QButtonGroup`：

> 独占：布尔
> 
> 该属性保存按钮组是否独占。
> 
> 如果此属性为真，则在任何给定时间只能检查组中的一个按钮。用户可以单击任何按钮进行检查，该按钮将替换现有的按钮作为组中的已检查按钮。
> 
> 在独占组中，**用户不能通过点击取消选中当前选中的按钮；**相反，必须单击组中的另一个按钮才能为该组设置新的选中按钮。

当然，有很多方法可以解决这个问题。我想知道是否有允许这种行为的预制替代方案`QButtonGroup`，因此 1）我不会重新发明轮子，2）我可以保持惯用语`qt`，以便将来更轻松地进行项目管理。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-28T21:21:14.930

在 Qt5 中，我使用了与 Laurent Michel 类似的解决方案，但使用的是发布事件而不是新闻事件：

```
// Allow to uncheck button in exclusive group
void CustomButton::mouseReleaseEvent(QMouseEvent* a_Event) {
    if(group()->checkedId()==group()->id(this)) {
        if(isDown()) group()->setExclusive(false);
    }
    QToolButton::mouseReleaseEvent(a_Event);
    group()->setExclusive(true);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-10T13:08:01.307

为了完整起见，我想在这里发布一个可能的问题解决方案，因为我只是在我的案例中解决了它。请注意，以下代码对 Qt3 有效。它也适用于 Qt4 和 Qt5，因为它不使用很多东西。

所以，我假设我在某处有一个包含按钮（CustomButton 类型）的小部件 CustomWidget，并且只有一个按钮可以打开。如果单击小部件中的另一个按钮，则当前打开的按钮将关闭，而新单击的按钮将打开。

CustomWidget 中包含的 CustomButtons 都包含在 QButtonGroup 中，方式如下：

```
QButtonGroup* m_ButtonGroup = new QButtonGroup(this);
m_ButtonGroup->hide();
m_ButtonGroup->insert(Btn1);
m_ButtonGroup->insert(Btn2);
m_ButtonGroup->insert(Btn3);
m_ButtonGroup->setExclusive(true); 
```

这里，Btn1、Btn2 和 Btn3 是 CustomButton 类型

```
class CustomButton : public QToolButton
{
    Q_OBJECT

  public:
    CustomButton (QWidget* apo_parent = 0, const char* as_name = 0);
    virtual ~CustomButton ();

  protected:
    virtual void mousePressEvent(QMouseEvent* a_Event);
}; 
```

您要专门实现的方法是 mousePressEvent。如果它的主体是通过以下方式实现的：

```
void CustomButton ::mousePressEvent(QMouseEvent* a_Event)
{
  if(group() && isToggleButton())
  {
    CustomButton* selectedButton(dynamic_cast<CustomButton*>(group()->selected()));
    if(selectedButton)
    {
      if(selectedButton->name() == name())
      {
        group()->setExclusive(false);
        toggle();
        group()->setExclusive(true);
        return;
      }
    }
  }
  QToolButton::mousePressEvent(a_Event);
} 
```

然后小部件的行为如你所愿。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-09T09:30:58.610

另一个与先前答案类似的解决方案，但使用`nextCheckState()`它似乎是我更自然的扩展点：

```
void MyButton::setSemiExclusive(bool value)
{
  mSemiExclusive = value;
}

void MyButton::nextCheckState()
{
  if (mSemiExclusive)
  {
    if (auto g = group())
    {
      auto old = g->exclusive();
      if (g->checkedButton() != this)
        g->setExclusive(true);

      QAbstractButton::nextCheckState();
      g->setExclusive(old);
      return;
    }
  }

  QAbstractButton::nextCheckState();
} 
```

这取决于关联`QButtonGroup`的设置`exclusive`为 false。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-01-10T23:05:29.020

如果您不想扩展按钮类，您也可以通过使用信号（Qt5，Python）来完成此操作：

```
from PySide import QtGui

class View(QtGui.QWidget):
    def __init__(self):
        self.buttonGroup = QtGui.QButtonGroup(self)
        for button in buttons:
            self.buttonGroup.addButton(button)
            button.pressed.connect(buttonPressed)
            button.released.connect(buttonReleased)

    def buttonPressed(self):
        button = self.sender()
        checkedButton = self.buttonGroup.checkedButton()
        if checkedButton != None and checkedButton.objectName() == button.objectName():
            self.buttonGroup.setExclusive(False)

    def buttonReleased(self):
        button = self.sender()
        if self.buttonGroup.exclusive() == False:
            button.setChecked(False)
            self.buttonGroup.setExclusive(True)

    def manualDeselection:
        self.buttonGroup.setExclusive(False)
        self.buttonGroup.checkedButton().setChecked(False)
        self.buttonGroup.setExclusive(True) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-01-25T14:49:27.080

我的解决方案是派生QButtonGroup，将其设置为非独占内部并自己管理状态

```
class myQButtonGroup : public QButtonGroup
{
    Q_OBJECT

public:
    explicit myQButtonGroup(QObject *parent = Q_NULLPTR) : QButtonGroup(parent) {
        _bExclusive = true;
        QButtonGroup::setExclusive(false);
        connect(this, SIGNAL(buttonClicked(QAbstractButton *)), SLOT(buttonClicked(QAbstractButton *)));
    }

    void setExclusive(bool bExclusive) { _bExclusive = bExclusive; }
    bool exclusive() const { return _bExclusive; }

protected slots:
    void buttonClicked(QAbstractButton *button) {
        if (_bExclusive) {
            // just uncheck all other buttons regardless of the state of the clicked button
            QList<QAbstractButton *> buttonlist = buttons();
            for (auto iBtn = buttonlist.begin(); iBtn != buttonlist.end(); ++iBtn) {
                QAbstractButton *pBtn = *iBtn;
                if (pBtn && pBtn != button && pBtn->isCheckable()) pBtn->setChecked(false);
            }
        }
    }

protected:
    bool _bExclusive;
}; 
```

# javascript - 应该在哪里存储特定于一个视图或一组视图的脚本？

> ID：15177777
> 
> 赞同：0
> 
> 时间：2013-03-02T18:18:26.687
> 
> 标签：javascript, asp.net-mvc, typescript

将所有 JavaScript 文件放在 `~/Scripts' 文件夹中似乎与良好做法背道而驰。我看到视图中包含大量特定于视图的脚本，但现在随着 TypeScript 的出现，以及其编译的 JS 文件，开发人员应该决定这些脚本应该放在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:30:02.633

您可以按照与视图文件夹相同的方式划分脚本文件夹......但我建议您更多地考虑......

对于较小的脚本集 - 捆绑、缩小、提供单个脚本。减少请求和脚本缓存几乎肯定会胜过尝试为大量小脚本提供服务。如果您认为自己有与常规不同的地方，欢迎您进行衡量和调整。

对于较大的脚本集，将脚本视为一个程序并以这种方式组织它们，而不是将它们与您的视图绑定在一起。因此，寻求创建执行特定工作的模块，而不是服务于特定页面。

# c# - 如何检查音效是否正在播放（循环播放 BG 歌曲）

> ID：15177780
> 
> 赞同：0
> 
> 时间：2013-03-02T18:19:00.647
> 
> 标签：c#, windows-phone-7, xna-4.0, soundeffect

这是我目前正在滚动的设置。鉴于此，我如何判断 _BGMusic SoundEfect 何时结束？我正在运行一个每秒循环几次的游戏循环，我最终想循环这首歌。

```
using Microsoft.Xna.Framework;
using Microsoft.Xna.Framework.Audio;

    SoundEffect _BGMUSIC;

    public Page1() {
     ...

     LoadSound("sfx/piano.wav", out _BGMUSIC);
     ...
    }

    private void LoadSound(String SoundFilePath, out SoundEffect Sound) {
        // For error checking, assume we'll fail to load the file.
        Sound = null;
        try {
            // Holds informations about a file stream.
            StreamResourceInfo SoundFileInfo =
                    App.GetResourceStream(new Uri(SoundFilePath, UriKind.Relative));
            // Create the SoundEffect from the Stream
            Sound = SoundEffect.FromStream(SoundFileInfo.Stream);
            FrameworkDispatcher.Update();
        } catch (NullReferenceException) {
            // Display an error message
            MessageBox.Show("Couldn't load sound " + SoundFilePath);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T20:29:38.490

好吧，所以这个问题的答案实际上非常简单，并且在 Microsoft 的 MSDN 页面中很好地概述了（一次）。

要使用我上面的内容来实现它，您需要执行以下操作。

**创建一个全局 SoundEffectInstance**

```
 SoundEffectInstance _BGMUSICINSTANCE; 
```

**在我的示例中，我在 main 方法中初始化 SoundEffect，因此在它下面我想初始化 SoundEffectInstance。**

```
_BGMUSICINSTANCE = _BGMUSIC.CreateInstance(); 
```

**现在实例已加载并准备就绪，我们可以将其循环属性设置为 true。您也可以在主要方法中或任何您想要的地方执行此操作。这是一个全球性的**

```
 _BGMUSICINSTANCE.IsLooped = true; 
```

**终于播放歌曲了**

```
 _BGMUSICINSTANCE.Play(); 
```

参考页 [http://msdn.microsoft.com/en-us/library/dd940203(v=xnagamestudio.31).aspx](http://msdn.microsoft.com/en-us/library/dd940203(v=xnagamestudio.31).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:29:55.810

从这段代码看来，您刚刚将声音存储在其中，`Sound`但没有显示您实现该`Sound.Play()`方法的位置。虽然没有`Sound.IsPlaying`可能解决您的问题的布尔值，但`Sound.Duration`您可以使用一个属性来解决您的问题，特别是如果您将其与 a `Timer`( 可以串联使用以触发标志以显示是否或不是声音在播放。

我从未使用过但[刚刚找到](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.audio.soundeffect.isdisposed%28v=xnagamestudio.35%29.aspx)的东西是该`Sound.IsDisposed`物业。我肯定也会对此进行调查，因为它可能正是您正在寻找的。

# java - 在android中并行下载位图

> ID：15177786
> 
> 赞同：1
> 
> 时间：2013-03-02T18:19:55.113
> 
> 标签：java, android, multithreading

我有两个数组列表。每个都包含几个 url。我想从这些网址下载位图。我的代码现在看起来像这样：

```
private class downloading extends AsyncTask<ArrayList<String>, Void, ArrayList<Bitmap>>    {

  @Override
  protected ArrayList<Bitmap> doInBackground(ArrayList<String>... params) {
        downloadBitmaps(params[0]);
        downloadBitmaps(params[1])
  } 
```

这工作正常。但是我想创建一个新线程来下载第二个数组列表的位图。但是如果这样做，我必须在 downloadBitmaps 方法中使用 to synchronized 关键字以避免 ConcurrentModificationException。但如果我这样做，下载过程不会更快。谁能建议我一种安全快捷的方式来下载位图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:23:00.257

使用/启动第二个 AsyncTask 用于 downloadBitmaps(params[1])

# c# - Windows 8 C# - Parse.ParseClient 抛出异常“TypeInitializationException”

> ID：15177790
> 
> 赞同：1
> 
> 时间：2013-03-02T18:20:08.133
> 
> 标签：c#, windows-8

我正在使用正确安装的数据库系统 Parse (www.parse.com)。

出于某种原因：

```
 public App()
  {
    this.InitializeComponent();
    this.Suspending += OnSuspending;

    ParseClient.Initialize("appkey", "windowskey");  //this line throws the exception
                                                //keys are actually my keys 
  } 
```

正在引发异常“TypeInitializationException”。

我已使用“Install-Package Parse”将 Parse 安装到项目中，并且包含“使用 Parse”。

我不确定为什么会抛出异常，因为它只会在某些项目上抛出。例如，我有一个项目，其代码与我复制/粘贴到新项目中的代码完全相同，该项目在旧项目中有效，但在新项目中无效。

回顾一下，异常是在一个项目中引发的，而不是在另一个项目中引发的。有谁知道为什么会抛出这个异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T23:54:13.540

显然，在 ParseClient.Initialize 函数调用中存在与 Newtonsoft.Json 的依赖关系。我通过捕捉异常发现了这一点，并看到关于 Newtonsoft.Json 的一些说法，所以我在包管理器控制台中安装了带有“Install-Package Newtonsoft.Json”的包，它解决了问题。

所以显然解析需要Newtonsoft.Json？无论如何，它奏效了。

# php - 网站加载非常慢

> ID：15177792
> 
> 赞同：-2
> 
> 时间：2013-03-02T18:20:13.037
> 
> 标签：php, mysql, sql, performance

我制作了一个 PHP 脚本，它从 MySQL 表中请求信息。如果它是正确的，它会做一些事情，但是这个脚本很慢，因为有很多行不正确。这是脚本：

```
$everypost = mysql_query("SELECT MAX(asd) FROM asd;");
$everypost = mysql_fetch_array($everypost);
$id = $everypost[0];
while ($id > 0 && $i < $var2) {
    $id = $id - 1;
    $tulajid = $context['user']['id'];
    $posts = mysql_query("SELECT * FROM asd WHERE asd='$id' AND owner='$var' GROUP BY(asd);");
    $prow = mysql_fetch_array($posts);
    if(isset($prow['asd'])) {//If it's correct, so the user is the owner
        $i++;
    }
} 
```

我的问题是它检查每个帖子，而不仅仅是用户的帖子。有没有办法让它更快？如果我`AND owner ='$var'`从 $posts 查询中删除，它会非常快。

```
CREATE TABLE `asd` ( 
  `asd` int(10) unsigned NOT NULL, 
  `id_member` mediumint(8) unsigned NOT NULL, 
  `score` smallint(2) NOT NULL, 
  `owner` mediumint(8) unsigned NOT NULL, 
  `log_time` int(10) unsigned NOT NULL, 
  PRIMARY KEY (`id_msg`,`id_member`), 
  KEY id_member (`id_member`), 
  KEY owner (`owner`), 
  KEY owner_2 (`owner`) 
) ENGINE=MyISAM DEFAULT CHARSET=latin1 
```

已解决

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:21:03.213

这意味着您需要审查您的数据库设计。您可能没有，因此需要在您的`owner`列上编制索引。

仅供参考，[您不应该`mysql_*`在新代码中使用函数](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[红框](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T14:24:39.313

它仍然很慢。id_msg = asd 和 id_poster = 所有者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T18:25:42.640

我认为这里的主要问题不一定是数据库设计，而是您查询信息的方式。您在一个查询中提取最新的内容，然后您向下循环并为循环的每次迭代发出一个查询。这位先生，疯了。您可以通过使用正确的条件以更少的查询来执行此操作。

如果没有来自您的架构的更多信息，我会假设您可以执行以下操作：

`SELECT a.* FROM asd a WHERE a.owner = ? ORDER BY a.asd DESC`

`asd`这将为您提供一个元组的所有实例，其中`owner`是某个值（您可以将 替换为`?`您的值），按`asd`，从最高到最低排序。我不确定这是否是你想要的，如果你可以在 PHP 中发布有关表格和变量的更多信息，我可能会给你一个更好的答案，但不管你试图获得的数据是什么，我都很确定有很多比你现在做的更有效的方法。

# mysql - mysql查询计算给定日期范围内条目之间的平均时间

> ID：15177795
> 
> 赞同：-1
> 
> 时间：2013-03-02T18:20:22.540
> 
> 标签：mysql

我有一个 MYSQL 表，其中包含以下列：entryDate、entryTime、entryAmt

一些典型的行看起来像：

```
2013-01-02, 11:15:15, 30
2013-01-02, 11:52:10, 15
2013-01-02, 14:48:16, 15
2013-01-01, 10:10:11, 30
2013-01-01, 11:00:00, 15 
```

ETC...

现在我的问题是是否可以使用 MYSQL 查询在 entryTime 列中找到一天活动的平均时间差？也就是说，例如，我想知道一天中每个 entryTime 之间的平均时间长度是多少（在 2013 年 1 月 2 日，entryTimes 是 11:15:15、11:52:10 和 14： 48:16\. 我想知道列出的每个时间之间经过的平均时间量）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:35:08.900

试试这个

```
SELECT `entryDate`, 
       SEC_TO_TIME(
         CASE WHEN COUNT(`entryTime`) = 1 THEN 0 
           ELSE TIME_TO_SEC(TIMEDIFF(MAX(`entryTime`), MIN(`entryTime`))) / (COUNT(`entryTime`) - 1) 
         END) average
  FROM entries
 GROUP BY `entryDate` 
```

输出

```
+------------+----------+
| date       | average  |
+------------+----------+
| 2013-01-01 | 00:49:49 |
| 2013-01-02 | 01:46:31 |
+------------+----------+ 
```

# jquery - css 转换比例和 jquery 错误

> ID：15177799
> 
> 赞同：0
> 
> 时间：2013-03-02T18:21:01.703
> 
> 标签：jquery, css, transform

我正在使用 css 来缩放此页面上的元素，并且出于某种奇怪的原因，它正在移动和拉伸 Chrome 中元素内的图像。在 Safari 中运行良好。

HTML

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset=utf-8 />  
        <title>title</title>
        <script type='text/javascript' src='http://code.jquery.com/jquery-1.6.2.js'></script>
        <script type='text/javascript' src='http://cherne.net/brian/resources/jquery.hoverIntent.js'></script>  
    </head>
<body>
    <div id="posts_container">
        <div class="post">
        <div class="post_content">
            <img src="http://25.media.tumblr.com/tumblr_m5e4ioVQsj1qbzzgco1_1280.gif" alt="" />
            <div class="post_tools">
                <a href="#" class="tag">Source: noirlac</a>
                <a href="#" class="tag">#gif</a>
            </div>
        </div>
        <div class="post_info">
            <div class="portrait"></div>
                <div class="from">
                    <a href="#">robotoperator</a>
                    <div class="reblogged"></div>
                    <a href="#">ary</a>
                </div>
                <div class="scale">
                    <a href="#" class="likes"></a>
                    <a href="#" class="reblog"></a>
                    <a href="#" class="note_count">1,747</a>    
                </div>
        </div>
        <img class="point" src="point.png" alt="" />
    </div>

    <div class="post">
        <div class="post_content">
            <h2>Where's my sandwich?</h2>
            <p>Seriously, where is it?</p>
            <div class="post_tools">
                <a href="#" class="tag">#where are you sandwich?</a>
            </div>
        </div>
        <img class="point" src="point.png" alt="" />
        <div class="post_info">
            <div class="portrait"></div>
                <div class="from">
                    <a href="#">robotoperator</a>   
                </div>
                <div class="scale">
                    <a href="#" class="likes"></a>
                    <a href="#" class="reblog"></a>
                    <a href="#" class="note_count">5</a>    
                </div>
        </div>
    </div>  

    <div class="post">
        <div class="post_content">
            <iframe src="https://embed.spotify.com/?uri=spotify:track:2dam1YcpllKLaeIunQvIrV" width="640" height="720" frameborder="0" allowtransparency="true"></iframe>
            <div class="post_tools">
                <a href="#" class="tag">Source: Spotify</a>
                <a href="#" class="tag">#music</a>
            </div>
        </div>
        <div class="post_info">
            <div class="portrait"></div>
                <div class="from">
                    <a href="#">robotoperator</a>
                    <div class="reblogged"></div>
                    <a href="#">anamanaguchi</a>
                </div>
                <div class="scale">
                    <a href="#" class="likes"></a>
                    <a href="#" class="reblog"></a>
                    <a href="#" class="note_count">12</a>   
                </div>  
        </div>
        <img class="point" src="point.png" alt="" />
        </div>  

    </div>
</body>
</html> 
```

CSS

```
body {
    margin: 0px;
    padding: 0px;
    background: #2c4762;
}

#posts_container {
    position: absolute;
    width: 664px;
    margin: 120px 0px 0px -332px;
    padding: 0px 0px 120px 0px;
    left: 50%;
    top: 0px;
    overflow: hidden;
}

.post {
    width: 662px;
    margin-bottom: -50px;
    z-index: 2;
    position: relative;
    font-family: helvetica neue, sans-serif;
}

    .post_content {
        -webkit-box-shadow: 0 1px 5px rgba(0,0,0,.46);
        -moz-box-shadow: 0 1px 5px rgba(0,0,0,.46);
        box-shadow: 0 1px 5px rgba(0,0,0,.46);
        -webkit-border-radius: 8px;
        -moz-border-radius: 8px;
        border-radius: 8px;
        background: #fff;
        padding: 5px 15px 15px 15px;
    }

        .post_content iframe {
            margin: 6px 0px -10px -4px;
        }

        .post_content img {
            margin: 1px 0px -10px -4px;
            padding: 6px 0px 0px 0px;
            width: 639px;
        }

        .post_content h2 {
            color: #444;
            margin: 15px 0px 0px 0px;
        }

        .post_content p {
            margin: 10px 0px 0px 0px;
            font-size: 14px;
            line-height: 19px;
        }

            .post_content p a {
                color: #111;
            }

        .post_content blockquote {
            font-size: 14px;
            border-left: #ddd 3px solid;
            margin: 10px 0px 0px 20px;
            padding: 0px 0px 0px 20px;
        }

.post_tools {
    border-top: #d7d7d7 1px solid;
    margin: 20px 0px -15px -15px;
    padding: 10px 0px 0px 0px;
    height: 30px;
    width: 662px;
    background: #eee;
    -webkit-border-bottom-right-radius: 8px;
    -webkit-border-bottom-left-radius: 8px;
    -moz-border-radius-bottomright: 8px;
    -moz-border-radius-bottomleft: 8px;
    border-bottom-right-radius: 8px;
    border-bottom-left-radius: 8px;
}

    .post_tools .tag {
        font-family: 'Lucida Grande', Verdana, sans-serif;
        display: inline;
        padding: 0px 0px 0px 12px;
        font-size: 12px;
        color: #898989;
        text-decoration: none;
    }

        .post_tools .tag:hover {
            text-decoration: underline;
        }

.post_info {
    -webkit-transform-style: preserve-3d;
    position: relative;
    z-index: -1;
    opacity: 0;
    margin: -64px 0px 0px 0px;
    padding: 30px;
}

    .post_info a {
        color: #b2bbc4;
        text-decoration: none;
    }   

    .note_count, .reblog, .likes {
        -webkit-border-radius: 3px;
        -moz-border-radius: 3px;
        border-radius: 3px;
        display: inline;
        float: right;
        margin: 0px 0px 0px 20px;
    }   

    .post_info .note_count {
        padding: 3px 4px 3px 4px;
        font-size: 16px;
        font-weight: bold;
        background: #405971;
    }

    .post_info .reblog {
        display: block;
        width: 31px;
        height: 26px;
        background: #405971 url('tool_sprite.png') no-repeat -53px 2px;
    }

    .post_info .likes {
        display: block;
        width: 28px;
        height: 26px;
        background: #405971 url('tool_sprite.png') no-repeat -86px 4px;
    }

    .post_info .portrait {
        background: url('avatar.png');
        -webkit-border-radius: 6px;
        -moz-border-radius: 6px;
        border-radius: 6px;
        width: 64px;
        height: 64px;
        -webkit-box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.2);
        -moz-box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.2);
        box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.2);
    }

.point { 
    position: absolute;
    bottom: 104px;
    left: 50px;
    opacity: 0;
}

.from {
    position: absolute;
    top: 52px;
    left: 110px;
    height: 21px;
    width: 300px;
}

.reblogged {
    width: 25px;
    height: 21px;
    background: url('tool_sprite.png') no-repeat -56px 0px;
    margin: 0px 10px 0px 10px;
}

.from a, .reblogged {
    display: inline;
    float: left;
    font-weight: bold;
}

.scale {
    position: absolute;
    top: 50px;
    right: 10px;
    width: 300px;
    height: 26px;
    -webkit-transform: scale(0.8,0.8);
    -webkit-transform-style: preserve-3d;
} 
```

JAVASCRIPT

```
$(document).ready(function() {
    $('.post').hoverIntent( function() {
        $('.post_info', this).delay(500).animate({ 'opacity': '1', 'margin-top': '-10px' }, 300);
        $(this).delay(500).animate({ 'margin-bottom': '-10px' }, 300);
        $('.point', this).delay(720).animate({'opacity': '1'}, 100);
    }, function () {
        $('.post_info', this).delay(500).animate({'opacity': '0', 'margin-top': '-50px' }, 300);
        $(this).delay(500).animate({ 'margin-bottom': '-64px' }, 300);
        $('.point', this).delay(500).animate({'opacity': '0'}, 100);
    });     
}); 
```

正在缩放的​​东西是悬停时每个帖子底部右侧的三个帖子控件。

我该如何解决这个问题？

（请注意，添加了 jsfiddle 的编辑不会显示错误 - 您需要查看链接页面才能看到它的实际效果）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:34:38.993

只需将您的`.scale`css 规则更改为以下。

HTML：

```
<a href="#" class="likes">
    <span></span>
</a> 
```

CSS：

```
.scale {
    position: absolute;
    top: 50px;
    right: 10px;
    width: 300px;
    height: 26px;
 }
 .post_info .likes {
     display: block;
     /* remove all other rules from here and assign to span */
 }
 .scale a span {
     display: block;
     width: 28px;
     height: 26px;
     background: #405971 url('http://ra.gs/tumblr/tool_sprite.png') no-repeat -86px 4px;
    -webkit-transform: scale(0.8);
 } 
```

# django - 是否可以使用 django_compressor/S3/gzip？

> ID：15177801
> 
> 赞同：11
> 
> 时间：2013-03-02T18:21:25.423
> 
> 标签：django, django-compressor

如何使用 django_compressor 将压缩文件发送到 Amazon S3？

我尝试了几种方法，但没有奏效。这是我最后的 settings.py 配置：

```
COMPRESS_ENABLED = True
COMPRESS_OFFLINE = True

COMPRESS_ROOT = STATIC_ROOT
COMPRESS_URL = "http://xxx.cloudfront.net/"
STATIC_URL = COMPRESS_URL
COMPRESS_OUTPUT_DIR = 'CACHE'

#COMPRESS_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
COMPRESS_STORAGE = 'core.storage.CachedS3BotoStorage'

STATICFILES_STORAGE = 'compressor.storage.GzipCompressorFileStorage'
COMPRESS_YUI_BINARY = 'java -jar contrib/yuicompressor-2.4.7/build/yuicompressor-2.4.7.jar'
COMPRESS_YUI_JS_ARGUMENTS = ''
COMPRESS_CSS_FILTERS = ['compressor.filters.yui.YUICSSFilter']
COMPRESS_JS_FILTERS = ['compressor.filters.yui.YUIJSFilter']
COMPRESS_CSS_HASHING_METHOD = 'hash' 
```

和我的**storage.py**

```
from django.core.files.storage import get_storage_class
from storages.backends.s3boto import S3BotoStorage

class CachedS3BotoStorage(S3BotoStorage):
    """
    S3 storage backend that saves the files locally, too.
    """
    def __init__(self, *args, **kwargs):
        super(CachedS3BotoStorage, self).__init__(*args, **kwargs)
        self.local_storage = get_storage_class(
            "compressor.storage.CompressorFileStorage")()

    def save(self, name, content):
        name = super(CachedS3BotoStorage, self).save(name, content)
        self.local_storage._save(name, content)
        return name 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-04T11:46:20.803

[django-storages](https://bitbucket.org/david/django-storages) S3 存储后端[支持 gzip](https://bitbucket.org/david/django-storages/src/e27c8b61ab57e5afaf21cccfee005c980d89480f/storages/backends/s3boto.py?at=default#cl-234)。添加到settings.py：

```
AWS_IS_GZIPPED = True 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-05-06T17:32:52.613

经过几天的努力和研究，我终于能够做到这一点。

基本上你需要做几件事：

1.  利用`AWS_IS_GZIPPED = True`
2.  如果您的 S3 在美国境外。您需要创建一个自定义`S3Connection`类，在其中将`DefaultHost`变量覆盖到您的 S3 url。例子`s3-eu-west-1.amazonaws.com`
3.  如果您使用虚线存储桶名称，例如`subdomain.domain.tld`. 你需要设置`AWS_S3_CALLING_FORMAT = 'boto.s3.connection.OrdinaryCallingFormat'`
4.  你必须`non_gzipped_file_content = content.file`在你的`CachedS3BotoStorage`

这是`CachedS3BotoStorage`您需要的课程：

```
class CachedS3BotoStorage(S3BotoStorage):
    """
    S3 storage backend that saves the files locally, too.

    """
    connection_class = EUConnection
    location = settings.STATICFILES_LOCATION

    def __init__(self, *args, **kwargs):
        super(CachedS3BotoStorage, self).__init__(*args, **kwargs)
        self.local_storage = get_storage_class(
            "compressor.storage.CompressorFileStorage")()

    def save(self, name, content):
        non_gzipped_file_content = content.file
        name = super(CachedS3BotoStorage, self).save(name, content)
        content.file = non_gzipped_file_content
        self.local_storage._save(name, content)
        return name 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-09T11:33:22.703

2019 年更新：[官方文档中有描述](https://django-compressor.readthedocs.io/en/stable/remote-storages/#using-staticfiles)

```
#mysite.py
from django.core.files.storage import get_storage_class
from storages.backends.s3boto import S3BotoStorage

class CachedS3BotoStorage(S3BotoStorage):
    """
    S3 storage backend that saves the files locally, too.
    """
    def __init__(self, *args, **kwargs):
        super(CachedS3BotoStorage, self).__init__(*args, **kwargs)
        self.local_storage = get_storage_class(
            "compressor.storage.CompressorFileStorage")()

    def save(self, name, content):
        self.local_storage._save(name, content)
        super(CachedS3BotoStorage, self).save(name, self.local_storage._open(name))
        return name 
```

和你的设置：

```
#settings.py
INSTALLED_APPS += ['compressor']

AWS_IS_GZIPPED = True

STATIC_ROOT = '/path/to/staticfiles' #if not set, set this to an empty folder
COMPRESS_ROOT = STATIC_ROOT
STATICFILES_STORAGE = 'mysite.storage.CachedS3BotoStorage'
COMPRESS_STORAGE = STATICFILES_STORAGE
STATIC_URL = 'https://compressor-test.s3.amazonaws.com/'
COMPRESS_URL = STATIC_URL 
```

你可以简单地运行：

```
python manage.py collectstatic 
```

# algorithm - Bogo-sort 平均运行时解释

> ID：15177802
> 
> 赞同：2
> 
> 时间：2013-03-02T18:21:29.263
> 
> 标签：algorithm, sorting, runtime, average

有人可以详细解释一下 bogosort 的平均案例运行时间是多少吗？

算法的伪代码：

```
while not isInOrder(deck):
    shuffle(deck) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:24:35.650

有`n!`排列，只有一个是正确的（假设不同的元素）。因此，从挥手的意义上说，您会期望在大约`O(n!)`迭代之后选择正确的答案。^* 但是每个 shuffle/check 操作都是它本身`O(n)`。因此`O(n.n!)`总体而言。

* * *

[* 准确地说，您可以建模为参数*p = 1/n的*[*几何分布随机变量！*](http://en.wikipedia.org/wiki/Geometric_distribution). 这样一个变量的期望值是*1/p = n！*.]

* * *

 **## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:29:45.863

执行操作的平均尝试次数与每次尝试成功的概率成反比。

有一些`n!`方法可以改变`n`元素。如果所有元素都是不同的，则只有一种方式产生排序输出。因此，排序 shuffle 的概率为`1/n!`，平均尝试次数为`n!`。

每次洗牌都需要`O(n)`时间（假设 Fisher-Yates 洗牌或任何同样合理的事情）。

因此，时间复杂度为`O(n!*n)`。**

# css - 在导航菜单中设置下拉菜单的大小

> ID：15177804
> 
> 赞同：0
> 
> 时间：2013-03-02T18:21:42.227
> 
> 标签：css, drop-down-menu, width, html-lists

我有一个菜单。它有一个下拉菜单。我也希望下拉菜单的父级大小相同。

**我的 HTML**

```
<ul>
   <li class="noChild"><a href="#" class="" >MY ACCOUNTS</a></li>
    <li class="noChild "><a  href="#" >LIBRARY</a></li>
    <li class=""><a href="#">OUR DEPOSIT OFFERS </a>
    <ul>
        <li  class="dropdownSizeDn"><a  href="#">OFFERS 1 </a></li>
        <li class="dropdownSizeDn"><a  href="#">OFFERS 2</a></li>
        <li class="dropdownSizeDn"><a  href="#">OFFERS 3</a></li>
    </ul>
    <li class="noChild"><a href="#">LOGOUT</a></li>
</ul> 
```

**jQuery**

```
jQuery("#menu1 li").hover(function(){
    jQuery(this).find('ul:first')
       .css({
           visibility: "visible",
           display: "none",
           marginLeft:"0px",
           paddingLeft:"0px"})
       .show(200);
},function(){
    jQuery(this).find('ul:first').css({visibility: "hidden"});
}); 
```

从上面的代码中，我需要为其所有子节点（“OFFERS 1”，“OFFERS 2”，“OFFERS 3”）设置相同的“OUR DEPOSIT OFFERS”宽度。在这里，我可以使用 Jquery 来完成。喜欢

```
jQuery('.dropdownSizeDn').css('width',widthLi + "px"); 
```

悬停在相应的父级上。但我想通过 CSS 自己设置它。有什么办法吗？我不喜欢任何css3修复。它必须与旧版浏览器兼容。

**编辑** 我不能硬编码每个孩子的宽度。这是我的 css [jsfiddle](http://jsfiddle.net/arjuncc/M5EWW/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:26:16.907

您可以将下拉菜单中每个子项的宽度设置为与父项相同的固定宽度，即宽度：120px。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:43:14.680

由于我不知道您的 CSS，因此涵盖了所有基础：

```
ul li ul, ul li ul li, ul li ul li a {
    width: 100%;
} 
```

# facebook - 是否可以使用 no_story 批量上传 Facebook 请求照片？

> ID：15177816
> 
> 赞同：0
> 
> 时间：2013-03-02T18:22:47.530
> 
> 标签：facebook, upload, request, photo, batch-processing

是吗？

上传就像一个魅力，但我不希望它出现在时间线或提要上。我尝试将 no_story 添加到每个请求，并添加到在以下代码中注释掉的 $params ：

```
 foreach ($data['Ad']['Media'] as $medium) {
            $file = $medium['tmp_name'];
            $req = array(
                'method' => 'POST',
                'relative_url' => '/me/photos',
                'message' => $data['Ad']['title'],
                'attached_files' => 'file' . $count,
                'no_story' => 1 //Also tried 'true'                     
            );

            //add this request to batch
            $batch[] = json_encode($req);
            $params['file' . $count] = '@' . realpath($file);
            $count++;
        }//foreach
        $params['batch'] = '[' . implode(',', $batch) . ']';
        //$params['no_story'] = true; 
```

## 编辑 ＃＃

请参阅下面的评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-18T14:16:39.787

我知道你可能不再需要答案了，但我遇到了同样的问题，经过多次尝试和错误我想通了，所以我会发布答案可能有人再次面临这个问题

```
$req = array(
            'method' => 'POST',
            'relative_url' => '/me/photos',
            'attached_files' => 'file' . $count,
            'body' => 'no_story=1'                      
        ); 
```

# objective-c - 使用 arc4random() 生成的范围不正确

> ID：15177821
> 
> 赞同：-1
> 
> 时间：2013-03-02T18:23:16.183
> 
> 标签：objective-c, random

这是我的代码：

```
secretPointX = (arc4random() % 600) + 400;
secretPointY = (arc4random() % 350) + 250; 
```

我将它们用作坐标，并使用毕达哥拉斯定理将它们用作圆的半径。我的问题是它不会在 400-600 和 250-350 之间生成随机数。它生成指定范围之外的数字。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:28:54.770

模除法为您提供剩余的操作。简单地说，当你像这样使用它时，它会给你一个从 0 到比右手操作数小一的数字。您将获得最多 599 的数字，然后将它们添加到 400。

你应该这样做：

```
u_int32_t max = 600;
u_int32_t min = 400;
u_int32_t result = (arc4random % (max - min) + 1) + min; 
```

或更好，

```
arc4random_uniform(max - min + 1) + min; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T18:26:04.247

您正在生成一个介于零（包括）和 600（不包括）之间的随机数，然后添加 400。这自然会产生一个介于 400 和 999 之间的数字。请改用以下内容：

```
secretPointX = (arc4random() % 201) + 400; 
```

您还可以使用`arc4random_uniform(201)`获取 0 到 200 之间的随机数，而无需进行模运算。

# jquery - 鼠标悬停时滑块不暂停 - jQuery

> ID：15177825
> 
> 赞同：0
> 
> 时间：2013-03-02T18:24:18.523
> 
> 标签：jquery, slider, onmouseover

我有一个滑块，当您将鼠标悬停在它上面时需要暂停。当您将鼠标悬停在其上**并**继续移动鼠标时，它会起作用。当鼠标悬停在它上面并且静止时，滑块会再次启动。即使鼠标静止，我也希望它保持暂停。这是代码：

```
$('slider').observe('mouseover', function(e) {
    my_glider.stop();
});
function startGlider1() {
    my_glider.start();
}
$('slider').observe('mouseout', function(e) {
    if (typeof(timeout) != "undefined") {
        clearTimeout(timeout);                              
    }
    timeout = setTimeout(startGlider1, 4000);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:33:37.977

好的，我将“mouseover”更改为“mouseenter”，将“mouseout”更改为“mouseleave”，现在它可以 100% 工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:50:40.167

试试jquery的hover()函数。

```
function startGlider1() {
    my_glider.start();
}
$('slider').hover(function() {
    my_glider.stop();
}, function() {
    if (typeof(timeout) != "undefined") {
        clearTimeout(timeout);                              
    }
    timeout = setTimeout(startGlider1, 4000);
}); 
```

# .net - .NET 框架中 CLS 的用途是什么？

> ID：15177826
> 
> 赞同：4
> 
> 时间：2013-03-02T18:24:26.287
> 
> 标签：.net, specifications, cls

我对 .NET Framework 中[CLS （公共语言规范）的用途感到困惑。](http://msdn.microsoft.com/en-us/library/12a7a7h3%28v=vs.71%29.aspx)

我的理解是，使用 .NET，我们可以用一种语言编写库并以另一种语言使用它，并且 CLR 支持此功能。我确实知道 CLS 的目的是与其他对象完全交互，而不管它们是用什么语言实现的。

CLS 到底是什么？它的目的是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:32:39.260

这`CLS`是针对组件开发人员以及编译器编写者的指南。它指定了什么是允许的，什么是不允许的，以便生成组件，并构建对语言的支持，以便它们是可移植的 - 并且完全兼容可以从所有`CLS`兼容的语言中使用/交互，这些语言可以在`CLR`.

虽然`CLR`具有由实现公开和强制执行的规范。这`CLS`只是一个指导方针。您仍然可以编写破坏 . 的组件`CLS`，但在`CLR`. 但在这种情况下，它们可能无法与某些语言互操作。

显然，这`CLS`对于编译器编写者和语言设计者来说非常重要。但是，即使作为组件开发人员，`CLS`如果您正在努力实现完全的互操作性，那么保持在界限内也很重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:08:48.810

> *我认为使用.Net，我们可以用一种语言编写一个库并用另一种语言使用它，为此有CLR，CLS到底是什么，它的目的是什么？*

虽然这种语言集成非常棒，但事实是编程语言非常不同，所以为了帮助您或`CLR`实现这一点 -

> Microsoft 已经定义了*公共语言规范*( `CLS`)，它为编译器供应商详细说明了他们的编译器必须支持的最小功能集，如果这些编译器要生成与由其他 CLS 兼容语言在 CLR 之上编写的其他组件兼容的类型。

# c# - 如何使用 TweetSharp 对 Twitter 进行身份验证

> ID：15177827
> 
> 赞同：2
> 
> 时间：2013-03-02T18:24:27.257
> 
> 标签：c#, tweetsharp

我创建了一个新应用程序，并在 Twitter 上注册了它，以获取使用者密钥、使用者密钥秘密、令牌和令牌秘密。然后我添加了对 TweetSharp 的引用。接下来，我使用了来自[https://github.com/danielcrenna/tweetsharp](https://github.com/danielcrenna/tweetsharp)的代码，上面写着“验证客户端应用程序（即桌面）”。

它总是打开的页面在标题栏中没有键。我注意到步骤 1 中的 oAuthRequestToken 有两个用于令牌/令牌机密的属性，但都没有设置。所以我手动添加了行来设置这两个。我又试了一次。这次在浏览器中打开的 Url 看起来是完整的。

我所看到的只是“哇！这个页面的请求令牌无效。它可能已经被使用过，或者因为它太旧而过期。请返回将您发送到这里的站点或应用程序，然后重试；它可能只是一个错误。”

我已经尝试重新创建令牌，并发送密钥和令牌以防我不理解它。我完全迷路了。刚开始不可能这么难！

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-06T08:29:11.367

我不确定您的问题出在哪里，但我会尽力提供帮助。这是我测试并为我工作的样本。我是从社区那里得到的。不要忘记将密钥放在 app.config 文件中。

```
 TwitterClientInfo twitterClientInfo = new TwitterClientInfo();
        twitterClientInfo.ConsumerKey = ConsumerKey; //Read ConsumerKey out of the app.config
        twitterClientInfo.ConsumerSecret = ConsumerSecret; //Read the ConsumerSecret out the app.config

        TwitterService twitterService = new TwitterService(twitterClientInfo);

        //Now we need the Token and TokenSecret

        //Firstly we need the RequestToken and the AuthorisationUrl
        OAuthRequestToken requestToken = twitterService.GetRequestToken();
        string authUrl = twitterService.GetAuthorizationUri(requestToken).ToString();

        //authUrl is just a URL we can open IE and paste it in if we want
       Process.Start(authUrl); //Launches a browser that'll go to the AuthUrl.

       //Allow the App
       //ask for the pin
       //string pin = ...

       OAuthAccessToken accessToken = twitterService.GetAccessToken(requestToken, pin);

       string token = accessToken.Token; //Attach the Debugger and put a break point here
       string tokenSecret = accessToken.TokenSecret; //And another Breakpoint here

        twitterService.AuthenticateWith(AccessToken, AccessTokenSecret); 
```

希望能帮助到你。祝你好运。

# matlab - 从Matlab中的矩阵中提取具有条件的数据

> ID：15177832
> 
> 赞同：0
> 
> 时间：2013-03-02T18:24:49.627
> 
> 标签：matlab, optimization

我在 Matlab 中有一个矩阵，其中每一行看起来像这样：

```
1 3 0.112 5.31275 4.61924 -6.50652 
```

我想根据第一列中显示的值提取到不同的矩阵。我知道如何使用 for 循环来做到这一点，但我有太多的点要让它运行，无论它需要什么时间来分析一切。有没有更简单的方法来做到这一点？

这是我的 for 循环代码：

```
accelerometer = 1;
gyroscope = 0;
a = 1;
g = 1;

for i = 1:size(raw,1)
    if raw(i,1) == accelerometer
        accelData(a,:) = raw(i,2:6);
        a = a+1;
    else
        if raw(i,1) == gyroscope
            gyroData(g,:) = raw(i,2:6);
            g = g+1;
        end
    end
end 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:31:45.383

我相信可以使用类似下面的代码：

```
%# Create dummy matrix
raw = [rand(10,1)>=0.5 rand(10,5)];

accelerometer = 1;
gyroscope = 0;

accelData = raw(raw(:,1)==accelerometer,:)
gyroData = raw(raw(:,1)==gyroscope,:) 
```

示例输出：

加速数据 =

```
1.0000    0.3517    0.0759    0.1622    0.4505    0.1067
1.0000    0.5853    0.5308    0.3112    0.2290    0.0046
1.0000    0.9172    0.9340    0.1656    0.1524    0.8173
1.0000    0.3804    0.0119    0.6892    0.0782    0.2599 
```

陀螺数据 =

```
 0    0.8308    0.0540    0.7943    0.0838    0.9619
     0    0.5497    0.7792    0.5285    0.9133    0.7749
     0    0.2858    0.1299    0.6020    0.8258    0.8687
     0    0.7572    0.5688    0.2630    0.5383    0.0844
     0    0.7537    0.4694    0.6541    0.9961    0.3998
     0    0.5678    0.3371    0.7482    0.4427    0.8001 
```

# java - JTextPane 为所有内容而不是几个字符着色

> ID：15177833
> 
> 赞同：2
> 
> 时间：2013-03-02T18:25:17.343
> 
> 标签：java, swing, jtextpane

所以我尝试编写简单的编辑器。我想将所有字符之间的所有字符都涂成灰色。字符之间的片段是：

```
class MainPanel extends JPanel {

private int WIDTH = 800;
private int HEIGHT = 500;
private JTextPane codePane = new JTextPane(); //Pole, w które wpisywany jest kod
private JLabel codeLabel = new JLabel("JNotepad");
private StyledDocument doc = codePane.getStyledDocument();
private final String[] keywords; //Słowa kluczowe
private final Map<String, String> shortcuts = new HashMap<>(); //syso -> System.out.println() itp.

MainPanel() {
    setPreferredSize(new Dimension(WIDTH, HEIGHT));
    setLayout(new BorderLayout());
    //Dodanie głównego pola w polu przewijanym
    JScrollPane scroll = new JScrollPane(codePane);
    add(scroll, BorderLayout.CENTER);
    add(codeLabel, BorderLayout.SOUTH);
    codePane.addKeyListener(new KeyHandler());
    codePane.setFont(new Font("Monospaced", Font.PLAIN, 15));
    //Załadowanie słów kluczowych
    Scanner in = new Scanner(getClass().getResourceAsStream("res/keywords.txt"));
    List<String> words = new LinkedList<>();
    while (in.hasNext()) {
        words.add(in.nextLine());
    }
    keywords = words.toArray(new String[words.size()]);
    in.close();
}

private class KeyHandler extends KeyAdapter {

    @Override
    public void keyReleased(KeyEvent ev) {
        highlight();
    }

    private void highlight() {
        String code = codePane.getText();
        //Zmiana koloru słów kluczowych
        String[] words = code.replaceAll("\\(|\\)|\\{|\\}|\\[|\\]", " ").split("\\s");
        int lastIndex = 0;
        for (int a = 0; a < words.length; a++) {
            SimpleAttributeSet set = new SimpleAttributeSet();
            if (Arrays.asList(keywords).contains(words[a])) {
                StyleConstants.setForeground(set, Color.BLUE);
            }
            doc.setCharacterAttributes(lastIndex, lastIndex + words[a].length(), set, true);
            //Zwiekszenie ostatniego indexu
            lastIndex += words[a].length() + 1; //+1 bo jeszcze spacja
        }
    }
} 
```

}

当 " 出现时，它会将字符涂成灰色，但它会在第一个 " 符号之后绘制所有字符。这段代码有什么问题？**编辑：给你，这是完整的代码。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:41:38.200

setCharacterAttributes() 方法中的第二个参数是长度，而不是结束索引。这是你的问题。

```
 boolean isString = false;
        char[] text = code.toCharArray();
        for (int i = 0; i < text.length; i++) {
            if (text[i] == '\"') {
                isString = !isString;
                if(!isString) {
                    document.setCharacterAttributes(i, 1, attributes, true);
                }
            }
            if (isString) {
                document.setCharacterAttributes(i, 1, attributes, true);
            }
        } 
```

最初的问题很短，只有几行代码，但 mKorbel 是对的：

> ...在这种情况下（它是 DocumentFilter 的一项）工作，永远不要将 KeyListener 用于 JTextComponent。

你应该检查一下，它可能会有所帮助：[How to Write a Document Listener](http://docs.oracle.com/javase/tutorial/uiswing/events/documentlistener.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:33:03.787

因为条件为真。`if (string)`将是真的。`String`一旦它就会被赋予真`equals("\""))`。所以它继续为下一个字符串。

在`if (string){.....}`块中，最后使`string=false`

# css - 没有为 Rails 资产编译 CSS 样式

> ID：15177834
> 
> 赞同：4
> 
> 时间：2013-03-02T18:25:28.237
> 
> 标签：css, ruby-on-rails-3

我在 Rails 3.2 应用程序中对样式表进行了以下设置。我有一个*application.css*文件，其中定义了许多样式，还有几个其他文件用于更具体的样式，就像与页脚有关的所有内容都在*footer.css*中。

在开发中，一切正常，但在生产中，所需文件中的任何移动样式都没有被编译，即`@media only screen and (min-width: 768px)`每个样式表的行以上的所有内容。

主 application.css 文件定义了大约 700 行样式，之后它还有一个`@media only screen and (min-width: 768px)`媒体查询。在媒体查询内部，还有另外 700 行覆盖了之前的 700 行样式，用于桌面。但是，这些样式已成功编译。我不明白为什么所需的文件不能以相同的方式工作。

**应用程序.css**

```
*= require_self
*= require base.css
*= require footer.css

.benefit {
  display: block;
  font-size: 0.8em;
  margin: 1em;
}

@media only screen and (min-width: 768px) {
  .benefit {
    font-size: 1em;
    margin: 3em;
  }
}

# All above styles compile 
```

**Base.css**

```
header, section, footer,
aside, nav, article, figure {
    display: block;
}

html, body {
    height: 100%;
    background: #DEDEDE;
}

# Above styles don't compile

@media only screen and (min-width: 768px) {

# Below style does compile

    body {
        text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.2);
    }

} 
```

**页脚.css**

```
footer {
    background: #ffffff;
    width: 100%;
}

# Above style doesn't compile

@media only screen and (min-width: 768px) {

# Below style does compile

    footer {
        background: none repeat scroll 0 0 #000;
        color: #818A8A;
        padding: 0;
    }
} 
```

**编辑：我尝试按照**[this answer](https://stackoverflow.com/questions/14766595/bootstrap-ignores-certain-media-queries)和下面的代码更新中的建议在他们自己的媒体查询中明确添加所需的css文件的移动样式，但它不起作用。

**页脚.css**

```
@media only screen { 
  footer {
    background: #ffffff;
    width: 100%;
  }
}

# Above style STILL doesn't compile

@media only screen and (min-width: 768px) {

# Below style does compile

    footer {
        background: none repeat scroll 0 0 #000;
        color: #818A8A;
        padding: 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T15:04:17.213

使用超过 1000 行样式，您一定会在该行的某处省略分号或花括号。正如**d_ethier**在评论中所建议的那样，一种测试方法是使用`--trace`标志进行编译，但如果资产是纯 CSS 文件，您的编译将静默失败。

您要做的是包含`sass-rails`在您的 Gemfile 中并将您的样式表重命名为 scss 文件，这样如果有任何错误，它们将导致编译失败并突出显示您的问题。暂时将您的样式从您的`application.css`文件移动到另一个文件（比如说 all.css.scss）：

**应用程序.css**：

```
*= require_self
*= require all.css.scss
*= require base.css.scss
*= require footer.css.scss 
```

# c++ - 将本地结构从被调用者移动到调用者，而不在字段中重新分配

> ID：15177838
> 
> 赞同：1
> 
> 时间：2013-03-02T18:25:44.307
> 
> 标签：c++, memory-management, g++, move-semantics

我有分配器`eallocator`，它管理具有执行权限的内存。在**C++11** `std::vector`中有`std::vector::data()`成员函数，它返回指向底层元素数组的指针。我将一些数据放入数组中，如果我用正文调用运算符，则将其视为可执行代码：

```
static_assert(std::is_floating_point< F >::value, "F is not floating-point value type");
F result_;
__asm("call *%1"
        : "=&t"(result_)
        :   "r"(code_.data())
        : "memory", "%ax", "%st(1)", "%st(2)", "%st(3)", "%st(4)", "%st(5)", "%st(6)", "%st(7)"
        );
return result_; 
```

我得到代码执行的结果（总是单个浮点值）。

但是，当我尝试返回`T`包含`std::vector< std::uint8_t, eallocator< std::uint8_t > > code_`某个函数的字段的类型的结构并将其放置在`T const`局部变量中时，我会得到不希望`code_`的底层内存重新分配（违反了**相对于 rip 寻址的代码中的所有偏移量）。**

我应该怎么做才能避免这种情况？如何将局部结构变量从被调用者移动到调用者的局部结构变量而不在成员字段中重新分配？

# android - SAXParser 和 XMLReader android - 无法读取以 /> 结尾的某些标签，而不是

> ID：15177844
> 
> 赞同：0
> 
> 时间：2013-03-02T18:26:15.257
> 
> 标签：android, xml-parsing, tags, saxparser

**背景：**

处理从网站检索信息的应用程序。这是我几个月前工作的一个应用程序，当时一切都很好，但我回来进行维护并继续该项目。

**我在检索什么：**

查看源代码：[http ://services.runescape.com/m=news/latest_news.rss](http://services.runescape.com/m=news/latest_news.rss)

请查看源代码以查看 XML。请注意，每个项目都有类别、链接、pubDate、标题、描述和 guid。只有少数物品有外壳。

**问题：**

每个标签都以 < tag > 开头并以 </ tag > 结尾，除了以 / > 结尾的附件，这是使阅读过程混乱的原因，但我不知道如何解释它，或者它是否格式正确XML。

**问题：**

有没有办法处理不以传统的</tag>方式结束的标签？

*以下是我到目前为止的所有代码*- 如果有人有任何问题，请随时提问。感谢stackoverflow-ers的任何帮助或评论，非常感谢。

**我如何处理它：**

我使用 SAXParserFactory 和 XML Reader：

```
 try 
            {
                /** Handling XML */
                SAXParserFactory spf = SAXParserFactory.newInstance();
                SAXParser sp = spf.newSAXParser();
                XMLReader xr = sp.getXMLReader();

                /** Send URL to parse XML Tags */
                URL sourceUrl = new URL("http://services.runescape.com/m=news/latest_news.rss");
                /**
                 * Create handler to handle XML Tags ( extends
                 * DefaultHandler )
                 */
                //MyXMLHandler myXMLHandler = new MyXMLHandler();
                xr.setContentHandler(new MyXMLHandler());
                xr.parse(new InputSource(sourceUrl.openStream()));
            } 
            catch (Exception e) 
            {
                e.printStackTrace();
                //Log.i("EXCEPTION:","HomeActivity.java, line 121 - xml not parsed");
            }
            /** Get result from MyXMLHandler XMLlist Object */
            newsList = MyXMLHandler.xMLList; 
```

**全局变量：**

```
private XMLList newsList; 
```

**XMLList 类：**

我通过从 XMLList 类的所有 get 方法中检索列表来显示新闻“项目”。

因此，如果有 15 个项目，则应该有 15 个日期、类别、链接等。但是对于附件问题，它会启动附件，但不会结束它们。

所以我得到了 15 个标题，但只有 12 个日期、12 个类别、12 个链接等。如果你在上面的 rss 的源中搜索“enclosure”这个词（查看源：[http ://services.runescape.com/m=news /latest_news.rss](http://services.runescape.com/m=news/latest_news.rss)），您将看到只有 3 个项目有附件。

```
public class XMLList
{

/** Variables */
private ArrayList<String> title = new ArrayList<String>();
private ArrayList<String>  detail = new ArrayList<String>();
private ArrayList<String> description = new ArrayList<String>();
private ArrayList<String> link = new ArrayList<String>();
private ArrayList<String> date = new ArrayList<String>();
private ArrayList<String> category = new ArrayList<String>();
/**
 * In Setter method default it will return arraylist change that to add
 */

public XMLList()
{
    title.clear();
    detail.clear();
    description.clear();
    link.clear();
    date.clear();
    category.clear();
}
public ArrayList<String> getTitle()
{
    return title;
}
public void setTitle(String name)
{
    this.title.add(name);
}
public ArrayList<String> getDetail()
{
    return detail;
}
public void setDetail(String detail)
{
    this.detail.add(detail);
}
public ArrayList<String> getDescription()
{
    return description;
}
public void setDescription(String description)
{
    this.description.add(description);
}
public void setLink(String link)
{
    this.link.add(link);
}
public ArrayList<String> getLink()
{
    return link;
}
public void setDate(String date)
{
    this.date.add(date);
}
public ArrayList<String> getDate()
{
    return date;
}
public void setCategory(String cat)
{
    this.category.add(cat);
}
public ArrayList<String> getCategory()
{
    return category;
}
} 
```

**MyXMLHandler 类：**

```
public class MyXMLHandler extends DefaultHandler
{
public static XMLList xMLList;
Boolean currentElement = false;
String currentValue = null;

Boolean inTitle = false;
Boolean inDescription = false;
Boolean inItem = false;
Boolean inDate = false;
Boolean inLink = false;
Boolean inCategory = false;

StringBuilder buff = null;

public MyXMLHandler()
{
    xMLList = new XMLList();
}
// All methods auto called in this order - start, characters, end
/*
 * Called when an xml tag starts
 * imgView.setImageResource(R.drawable.newImage);
 */
@Override
public void startElement(String uri, String localName, String qName, Attributes attributes)
{
    if(xMLList == null)
    {
        xMLList = new XMLList();
    }
    if(localName.equals("item"))
    {
        inItem = true;
    }
    if (inItem) 
    {
        Log.d("START " + localName,"");
        if (localName.equals("title")) 
        {
            inTitle = true;
            buff = new StringBuilder();
        }
        if (localName.equals("description")) 
        {
            inDescription = true;
            buff = new StringBuilder();
        }
        if (localName.equals("link")) 
        {
            inLink = true;
            buff = new StringBuilder();
        }
        if (localName.equals("pubDate")) 
        {
            inDate = true;
            buff = new StringBuilder();
        }
        if (localName.equals("category")) 
        {
            inCategory = true;
            buff = new StringBuilder();
        }
    }
}
/*
 * Called when an xml tag ends
 */
@Override
public void endElement(String uri, String localName, String qName)throws SAXException
{
    if (inItem && !inTitle && !inDescription && !inLink && !inDate && !inCategory) 
    {
        Log.d("END ITEM", "");
        inItem = false;
    } 
    else if (inTitle) 
    {
        String check = buff.toString().trim();
        Log.d("TITLE:", check);
        Log.d("END " + localName,"");
        xMLList.setTitle(check);
        inTitle = false;
        buff = null;
    }
    else if (inDescription) 
    {
        String check  = buff.toString().trim();
        Log.d("DESC:", check);
        Log.d("END " + localName,"");
        xMLList.setDescription(check);
        inDescription = false;
        buff = null;
    }
    else if (inLink) 
    {
        String check  = buff.toString().trim();
        Log.d("LINK:", check);
        Log.d("END " + localName,"");
        xMLList.setLink(check);
        inLink = false;
        buff = null;
    }
    else if (inDate) 
    {
        String check  = buff.toString().trim();
        Log.d("DATE:", check);
        Log.d("END " + localName,"");
        check = check.substring(0,16);
        xMLList.setDate(check);
        inDate = false;
        buff = null;
    }
    else if(inCategory)
    {
        String check  = buff.toString().trim();
        Log.d("CATEGORY:", check);
        Log.d("END " + localName,"");
        xMLList.setCategory(check);
        inCategory = false;
        buff = null;
    }
}

/*
 * Called to get tag characters
 */
@Override
public void characters(char[] ch, int start, int length)throws SAXException
{
    if (buff != null) 
    {
        for (int i = start; i < start + length; i++) 
        {
            buff.append(ch[i]);
        }
    }

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:18:04.573

在您的`endElement`方法中，您有：

```
 if (inItem && !inTitle && !inDescription && !inLink && !inDate && !inCategory)
    {
        Log.d("END ITEM", "");
        inItem = false;
    } 
```

当解析器命中标签时，此设置`inItem`为 false 。`<enclosure />`

`inItem`仅当您实际遇到结束标签时才应设置为 false `</item>`，该标签将通过点击“项目”来`endElement`检测`localname`。

您在 XMLList 类中使用多个列表也很脆弱。您最好使用与您正在阅读的标签匹配的字段创建类并构建该类的对象的单个列表。

# pygame - pygame - 观察者模式错误

> ID：15177846
> 
> 赞同：0
> 
> 时间：2013-03-02T18:26:34.533
> 
> 标签：pygame, observer-pattern

我正在制作的游戏中使用观察者模式进行测试。但是我遇到了一些问题。我的代码和错误如下，有人可以帮忙吗？

**错误：**

```
File "C:\Users\Administrator\PycharmProjects\untitled\Level.py", line 112, in update
    w.update()
  File "C:\Users\Administrator\PycharmProjects\untitled\Entity.py", line 13, in update
    self.notifyObservers()
  File "C:\Users\Administrator\PycharmProjects\untitled\Observable.py", line 15, in notifyObservers
    observer.update(self)
TypeError: unbound method update() must be called with Player instance as first argument (got WorldController instance instead) 
```

**级别文件：**

```
self.world = [WorldController()]
for w in self.world:
            w.update() 
```

**实体文件：**

```
class WorldController(Observable):
    def __init__(self):
        super(Observable, self).__init__()
        self._observers = []

    def update(self):
        self.addObserver(Player)
        self.notifyObservers()

class Entity(Observer, pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)

class Player(Entity, Observer):
    def __init__(self, x, y):
        super(Observer, self).__init__()
        Entity.__init__(self)
    def update(self, observable):
        print "works!" 
```

**可观察文件：**

```
class Observable(object):
    def __init__(self, **kwds):
        super(Observable, self).__init__(**kwds)
        self._observers = []
    def addObserver(self, observer):
        if not observer in self._observers:
            self._observers.append(observer)
    def removeObserver(self, observer):
        try:
            self._observers.remove(observer)
        except ValueError:
            pass
    def notifyObservers(self):
        for observer in self._observers:
            observer.update(self)

class Observer(object):
    def __init__(self, **kwds):
        super(Observer, self).__init__(**kwds)
    def update(self, observable):
        pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:33:00.633

```
class WorldController(Observable):
    def __init__(self):
        super(Observable, self).__init__()
        self._observers = []

    def update(self):
        self.addObserver(Player)
        self.notifyObservers() 
```

应该：

```
class WorldController(Observable):
    def __init__(self):
        super(Observable, self).__init__()
        self._observers = []

    def update(self):
        self.addObserver(Player())
        self.notifyObservers() 
```

否则，当您调用 Player.update(self) 时，您调用的是静态方法而不是 Player 类的实例方法

# python - Python 代码通过 cmd 运行，但不在 IDLE 中运行。为什么？

> ID：15177850
> 
> 赞同：-1
> 
> 时间：2013-03-02T18:26:53.460
> 
> 标签：python, cmd, python-idle, command-line-interface

好的，所以我刚拿到我的跳跃运动设备，我正在尝试运行脚本。当我按 f5 时，脚本会加载但它不执行功能..（它初始化，加载所有内容）。

但是当我通过双击（通过cmd）打开它时，它应该如何正确地工作..

知道为什么吗？

这是一个示例代码：

[http://pastebin.com/6Pu2DQ4n](http://pastebin.com/6Pu2DQ4n)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T20:18:28.850

`if __name__ == '__main__'`由于预期的工作方式，IDLE 没有执行代码。

更改最后两行，使`if`语句不存在，并且`main()`调用不缩进：

```
# if __name__ == "__main__":
main() 
```

注意，这意味着*每次在任何地方导入此函数时**都会*`main()`执行，但它应该在 IDLE 中运行。（IDLE 之前没有运行，因为它不会触发）*`main``if`*

 *PS 获得 LEAP 干得好！五、吃醋>:)*

# java - 如何逐行读取文本文件并用信息填充对象数组？

> ID：15177856
> 
> 赞同：-3
> 
> 时间：2013-03-02T18:27:11.317
> 
> 标签：java

想通了......我不敢相信我花了这么长时间才得到这个：

```
 int id = inputFile.nextInt();
        String title = inputFile.next();
        String isbn = inputFile.next();
        String author = inputFile.next();
        String category = inputFile.next();
        char catagories = category.charAt(0); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:38:12.977

输入是

```
96385 This_Book 0998706482 Smith Non-Fiction 
```

但你正在阅读它使用

```
 new Book(inputFile.nextInt(), inputFile.nextLine(), inputFile.nextLine(), inputFile.nextLine(), inputFile.nextLine()) 
```

因此，您正在阅读一个 int，然后是整行，然后是整行，然后是整行，然后是整行。

使用`next()`而不是`nextLine()`，因为您想要下一个标记，而不是下一行。

# php - codeigniter 使用 set() 和 insert_string()

> ID：15177858
> 
> 赞同：0
> 
> 时间：2013-03-02T18:27:22.043
> 
> 标签：php, mysql, codeigniter

使用 CI，我需要使用子查询进行插入忽略。尝试执行此操作时出现代码点火器错误：

```
$data = array(
            "user_id" => $user_id,
            "workload_id" => $wid
    );
    $this->db->set($data);
    $this->db->set("order", "(SELECT ifnull(max(`order`)+1, 0) FROM (SELECT * FROM default_workloads_users A ) B WHERE user_id=".$user_id.")", FALSE);
    //$this->db->insert("default_workloads_users");
    $ins = $this->db->insert_string("default_workloads_users");
    $ins = str_replace("INSERT", "INSERT IGNORE", $ins);
    $this->db->query($ins); 
```

它告诉我我缺少 insert_string 的第二个参数。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:30:22.430

想出了一个破解的方法。首先使用 insert_string，然后将子查询 str_replace 放入语句中。新代码：

```
$data = array(
            "user_id" => $user_id,
            "workload_id" => $wid,
            "order" => "@order"
    );
$ins = $this->db->insert_string("default_workloads_users", $data);
$ins = str_replace("INSERT", "INSERT IGNORE", $ins);
$ins = str_replace("@order","(SELECT ifnull(max(`order`)+1, 0) FROM (SELECT * FROM default_workloads_users A ) B WHERE user_id=".$user_id.")",$ins );
$this->db->query($ins); 
```

# ios - RestKit：原始关系的映射

> ID：15177859
> 
> 赞同：1
> 
> 时间：2013-03-02T18:27:27.840
> 
> 标签：ios, objective-c, core-data, mapping, restkit

希望标题描述正确。

我得到以下 JSON： `{"regions":[{"name":"Region 1", "zipcodes":["80432", "80433"]}, ...]}`

我有两个实体`Region`和`ZipCode`：

```
@interface Region : NSManagedObject
  @property (nonatomic, retain) NSString * name;
  @property (nonatomic, retain) NSSet *zipCodes;
@end

@interface ZipCode : NSManagedObject
  @property (nonatomic, retain) NSString * zipCode;
  @property (nonatomic, retain) Region *region;
@end 
```

我尝试使用以下代码填充两者：

```
RKEntityMapping *regionMapping = [RKEntityMapping mappingForEntityForName:@"Region" inManagedObjectStore:managedObjectStore];

//[regionMapping addConnectionForRelationship:@"zipCodes" connectedBy:@{@"zipCode" : @"zipcodes"}];

[regionMapping addAttributeMappingsFromDictionary:@{@"name":@"name"}];

RKResponseDescriptor *regionDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:regionMapping pathPattern:@"/regions" keyPath:@"regions" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptor:regionDescriptor]; 
```

如您所见，我也尝试使用`addConnectionForRelationship: connectedBy:`我在[这个答案](https://stackoverflow.com/questions/14398309/core-data-relationships-not-mapped-with-restkit)中看到的，但没有成功。我想我必须创建一个单独`RKEntityMapping`的 for`ZipCode`但我不知道如何将它与我现有的代码粘合在一起，而不会重载`RKResponseDescriptor`.

你们中有人处理过类似的情况吗？你是怎么解决的？上面链接中的示例非常相似，但不幸的是，发布的解决方案非常不完整。

注 1：现有代码写入`name`我的数据库，但不会与我的数据库建立任何关系，`ZipCode`也不会将任何邮政编码写入我的数据库

注意 2：我使用的是最新的 RestKit 版本（0.20pre）

注3：你可以在这里救我的命；）

提前谢谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T14:01:55.183

我做过类似的事情，发现`addRelationshipMappingWithSourceKeyPath:mapping:`效果最好。据我了解，对嵌套关系（相同请求）使用关系映射，对跨多个请求创建关系使用连接。

为此，您可能需要像这样重新格式化 JSON：

```
{"regions":[
    {"name":"Region 1", "zipcodes":[
        {"zipcode": "80432"},
        {"zipcode": "80433"}]},
    ...]} 
```

...并将您的映射更改为以下内容：

```
RKEntityMapping *regionMapping = [RKEntityMapping mappingForEntityForName:@"Region" inManagedObjectStore:managedObjectStore];
[regionMapping addAttributeMappingsFromArray:@[@"name"]];

RKEntityMapping *zipCodeMapping = [RKEntityMapping mappingForEntityForName:@"ZipCode" inManagedObjectStore:managedObjectStore];
[zipCodeMapping addAttributeMappingsFromArray:@[@"name"]];

[regionMapping addRelationshipMappingWithSourceKeyPath:@"zipcodes" mapping:zipCodeMapping];

RKResponseDescriptor *regionDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:regionMapping pathPattern:@"/regions" keyPath:@"regions" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptor:regionDescriptor]; 
```

我没有尝试使用您正在使用的 JSON 格式（字符串数组而不是字典元素数组）映射关系，但您可以通过使用 zipCode 属性映射来做到这一点。

# python - 如何使用 python sax 解析器获取 XML 标记之间的文本并将其存储为字符串？

> ID：15177863
> 
> 赞同：1
> 
> 时间：2013-03-02T18:27:55.877
> 
> 标签：python, xml, xml-parsing, sax

我有一个看起来像这样的 XML 文件：

```
<TAG1>
   <TAG2 attribute1 = "attribute_i_need" attribute2 = "attribute_i_dont_need" >
      Text I want to use
   </TAG2>
   <TAG3>
      Text I'm not interested in
   </TAG3>
   <TAG4>
      More text I want to use
   </TAG4> 
```

我需要以某种方式获得“我想使用的文本”和“我想使用的更多文本”，而不是“我不感兴趣的文本”以字符串的形式，以后可以由某个任意函数使用. 我还需要以字符串的形式获取“attribute_i_need”。我以前没有真正使用过 sax 解析器，我完全被卡住了。我能够使用以下命令打印文档中的所有文本：

```
import xml.sax

class myHandler(xml.sax.ContentHandler):

    def characters(self, content):
        print (content)

parser = xml.sax.make_parser()
parser.setContentHandler(myHandler())
parser.parse(open("sample.xml", "r")) 
```

这基本上会给我输出：

```
Text I want to use
Text I'm not interested in
More text I want to use 
```

但问题是双重的。首先，这包括我不感兴趣的文本。其次，它所做的只是打印文本。我不知道如何只打印特定的文本，或者编写将文本作为字符串返回的代码，我可以将其分配给变量并稍后使用。而且我什至不知道如何开始提取我感兴趣的属性。

有谁知道如何解决这个问题？而且我更喜欢涉及 sax 解析器的解决方案，因为我至少对它的工作原理有一个模糊的了解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:37:02.013

这个想法是在遇到 TAG2 或 TAG4 后开始保存所有字符，并在元素结束时停止。打开元素也是检查和保存有趣属性的机会。

```
import xml.sax

class myHandler(xml.sax.ContentHandler):
    def __init__(self):
        self.text = []
        self.keeping_text = False
        self.attributes = []

    def startElement(self, name, attrs):
        if name.lower() in ('tag2', 'tag4'):
            self.keeping_text = True

        try:
            # must attribute1 be on a tag2 or anywhere?
            attr = attrs.getValue('attribute1')
            self.attributes.append(attr)
        except KeyError:
            pass

    def endElement(self, name):
        self.keeping_text = False

    def characters(self, content):
        if self.keeping_text:
            self.text.append(content)

parser = xml.sax.make_parser()
handler = myHandler()
parser.setContentHandler(handler)
parser.parse(open("sample.xml", "r"))

print handler.text
print handler.attributes

# [u'\n', u'      Text I want to use', u'\n', u'   ',
#  u'\n', u'      More text I want to use', u'\n', u'   ']
# [u'attribute_i_need'] 
```

我认为[`BeautifulSoup`](http://www.crummy.com/software/BeautifulSoup/)甚至裸露[`lxml`](http://lxml.de/)会更容易。

# c - 循环或多线程执行时间长？

> ID：15177866
> 
> 赞同：-3
> 
> 时间：2013-03-02T18:28:17.000
> 
> 标签：c, multithreading, for-loop, pthreads

如果循环和多线程都在执行相同的操作，哪一个将花费最长的时间？

在我的程序中，多线程的执行时间在 C 语言中是最长的

这是我的程序，一个用于线程，另一个用于 for 循环

```
 #include <pthread.h>
    #include <stdio.h>
    #include <stdlib.h>
    #include <time.h>

int ** A;
int ** B;
int ** C;
int ** D;

int k;
int r ;

clock_t begin_1, end_1, begin_2, end_2;
double time_spent_1, time_spent_2;

struct arguments{
int i;
int j;
   int n;
};

void initialize(){

A = (int **)malloc(2*sizeof(int *));
int i;
for(i = 0; i<2; i++)
    A[i] = (int*) malloc(2*sizeof(int));

B = (int **)malloc(2*sizeof(int *));
for(i = 0; i<2; i++)
    B[i] = (int*)malloc(2*sizeof(int));

    C = (int **)malloc(2*sizeof(int *));
for(i = 0; i<2; i++)
    C[i] = (int*)malloc(2*sizeof(int));

    D = (int **)malloc(2*sizeof(int *));
for(i = 0; i<2; i++)
    D[i] = (int*)malloc(2*sizeof(int));

   }

 void generate(){

 int i,j;

 for (i=0; i<2; i++)
    for (j=0; j<2; j++){
        r = rand()%100;
        A[i][j]=r;
    }

for (i=0; i<2; i++)
    for (j=0; j<2; j++){
        r = rand()%100;
        B[i][j]=r;
    }
   }

 void mutip_1()
 {
  int i,j,temp,k;

begin_1 = clock();

for (i=0; i<2; i++){
    for (j=0; j<2; j++){
        temp = A[i][j];
        for(k=0;k<2;k++){
            C[i][k]+=temp*B[j][k];
        }
    }
  }

  end_1 = clock();

}

void* mul_mat(void* args)
{
struct arguments * temp = (struct arguments*) args;
int i = temp->i;
int j = temp->j;
int n = temp->n;

pthread_detach(pthread_self());

free(temp);

int k;

for(k=0;k<2;k++){
   D[i][k]+=n*B[j][k];
}

pthread_exit(NULL);
}

int main(){

initialize();
generate();
mutip_1();

pthread_t* tid = (pthread_t*)malloc((2*2)*sizeof(pthread_t)); malloc((2*2)*sizeof(pthread_t));

int i, j,k=0;
int n;

begin_2 = clock();

for(i=0; i<2; i++){
    for(j=0; j<2; j++){
        n=A[i][j];
        struct arguments *args=(struct arguments*)malloc((2*2)*sizeof(struct arguments));
        args->i = i;
        args->j = j;
        args->n=n;
        if (pthread_create(&tid[k++], NULL, (void*)mul_mat, (void*)args)){
            perror("Thread Problem");
            exit(1);
        }
    }
}
end_2 = clock();

time_spent_1 = (double)(end_1 - begin_1) / CLOCKS_PER_SEC;
time_spent_2 = (double)(end_2 - begin_2) / CLOCKS_PER_SEC;

printf("Matrix A: \n");
 for (i=0; i<2; i++){
 for (j=0; j<2; j++)
 printf("%d ", A[i][j]);
 printf("\n");
 }

 printf("Matrix B: \n");
 for (i=0; i<2; i++){
 for (j=0; j<2; j++)
 printf("%d ", B[i][j]);
 printf("\n");
 }

 printf("multiplication using loop: \n");
 for (i=0; i<2; i++){
 for (j=0; j<2; j++)
 printf("%d ", C[i][j]);
 printf("\n");
 }
printf("multiplication using thread: \n");
for (i=0; i<2; i++){
    for (j=0; j<2; j++)
        printf("%d ", D[i][j]);
    printf("\n");
}

printf("First time using loop %f \n", time_spent_1);
printf("second time using thread %f \n", time_spent_2);

return 0;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:38:58.403

我之间

```
for i=1 to 50 
   do something
next i 
```

和二

```
for i=1 to 50 
   create thread that does the same something
next i 
```

假设 II 计算可以并行运行，则理论结果为

*   如果线程可以在多个 CPU/内核（免费）上运行，那么 II 应该更快
*   如果线程在同一个 CPU（核心）上运行，由于线程管理开销，我应该稍微快一点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T22:36:42.833

由于系统调用和线程间通信，线程创建和/或向线程池发出任务具有相当大的开销，因此，在多核 CPU 上：

矩阵的维度 = 2，在一个线程中循环更快。

矩阵的维度 = 2000000，在多个线程中循环更快。

摘要：不要线程化琐碎的 CPU 密集型操作。

# matlab - Matlab：如何删除矩阵中的所有列，如果它包含超过某个特定数量的 NaN 值

> ID：15177868
> 
> 赞同：0
> 
> 时间：2013-03-02T18:28:29.120
> 
> 标签：matlab, matrix

我想删除所有超过特定数量的 NaN 的列（比如说 5 个 NaN）。有没有没有循环的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:38:18.560

不需要循环：

```
matFixed = MAT( :, sum( isnan( MAT ) ) <= 5); 
```

一步步：

```
nanMat = isnan(MAT); % convert MAT to logical with 1 indicating value is a NAN
nNanInCol = sum(nanMat); %compute the number of NANs in each col
colIdx = nNanInCol <= 5; % determine which columns are "valid"
matFixed = MAT(:, colIdx); % create new matrix using only the good columns of MAT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:38:08.873

这很容易：

```
%# define a matrix with NaNs
A = rand(10); %# 10x10 array
A(A<0.5) = NaN; %# each column contains on average 5 NaNs

%# count NaNs
nanCt = sum(isnan(A),1);

%# remove columns with too many NaNs
A(:,nanCt > 5) = []; 
```

# mongodb - 多个字段的 MongoDB 索引

> ID：15177873
> 
> 赞同：3
> 
> 时间：2013-03-02T18:29:21.557
> 
> 标签：mongodb, indexing, mongodb-indexes

我已经阅读了 MongoDB in action book 中关于索引的章节，并且想知道是否有人可以扩展它所讨论的关于索引的内容。

如果我有一个涵盖的索引`a,b,c,d,e`并且我使用该索引进行查询`a,b,c`。如果我查询会发生什么`a,c,e`？索引是仅用于查询`a`还是在查询其他字段时使用？

在这种情况下，将索引也放在`a,c,e`. 我问是因为我有一个前端部分链接到这些字段，用户可以在其中创建自由形式的查询（`a,b,c,f`可能是一个）。我是否需要所有可能出现的选项的索引？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:31:48.437

MongoDB 中的复合索引通过前缀方法工作。

因此，对于 and 的索引，`a,b,c,d,e` `a`将`a,b`被视为前缀（[http://docs.mongodb.org/manual/core/indexes/#id5](http://docs.mongodb.org/manual/core/indexes/#id5)），因此对两者进行查询`a,b,c`并且`a,c,e`应该产生索引使用；至于是否高效地`a,c,e`使用索引完全是另一个问题。

> 我问是因为我有一个前端部分链接到这些字段，用户可以在其中创建自由形式的查询（a、b、c、f 可能是一个）。我是否需要所有可能出现的选项的索引？

嗯，如果`a`总是定义第一个字段，那么可能不会（`explain`在您的数据集上当然会更好），否则您可能需要一些组合，是的。

# xml - 如何在已经使用 Text.XmlHtml 的应用程序中使用 Text.RSS 模块而不导入 Text.XML.HaXml？

> ID：15177875
> 
> 赞同：2
> 
> 时间：2013-03-02T18:29:25.393
> 
> 标签：xml, haskell, heist

我有一个非常典型的网络日志应用程序，我一直在练习它。我的应用程序的顶层是一个使用非常标准路由的 Happstack 层。我已经到了想在代码中添加 XML 提要的地步。

这是困扰我的部分。由于我使用 Heist 进行模板化，因此我已经引入了 Text.XmlHtml 模块作为使用 Heist 的一部分。使用 Text.RSS 需要我也引入 Text.XML.HaXml。对我来说，需要在同一个应用程序中使用两个不同的 XML 模块似乎太过分了。

因此，除了编写自己的 RSS 提要（并且可能做错/违反规范/投入大量时间），有没有办法在我的应用程序中只使用一个 XML 库？此外，存在两个不同的 XML 模块是否有任何严重的缺陷或代码膨胀？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T06:18:35.270

如果你想使用 Text.RSS，那就不行。XmlHtml 是专门编写的，因为 Heist 对其底层 xml 库有一些独特的要求，而现有的没有一个是足够的。如果您不想使用 Text.RSS，那么您总是可以编写自己的 XmlHtml 支持的版本，或者尝试将 Text.RSS 移植到它。

# ios - 在 iOS iPhone 应用程序中以 60 fps 下采样实时视频

> ID：15177876
> 
> 赞同：1
> 
> 时间：2013-03-02T18:29:28.250
> 
> 标签：ios, real-time, avfoundation, video-processing

我正在尝试在一个条件下对 iOS 设备上的实时视频（例如每秒像素）进行下采样：以 60 fps 的速度进行。

分辨率可能会降低，视频屏幕的视图只能是一个小矩形（大约 200x200px）。然后应该在屏幕上预览结果。

我一直使用出色的 2012 WWDC RosyWriter 示例作为起点。但是经过数小时的搜索，我什至找不到一个教程，也找不到一个已经做过同样事情并且可以解释如何做到这一点的人的 github 项目。我一遍又一遍地筛选了 StackOverflow 中的所有相关问题，但没有任何成功。我正在寻找有关此主题的代码示例、好的答案或快速参考教程。

相关但仍未得到解答的问题：

*   [iOS AVFoundation - 以 60 fps 将视频转换为图像](https://stackoverflow.com/questions/10946534/ios-avfoundation-converting-video-into-images-at-60-fps)
*   [在 Quartz Composer 中实时重新排列视频上的像素](https://stackoverflow.com/questions/6297501/rearranging-pixels-on-a-video-in-realtime-in-quartz-composer)
*   [在 iOS 上处理视频时跳过帧](https://stackoverflow.com/questions/9242707/skip-over-frames-while-processing-video-on-ios?rq=1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T01:14:12.143

查看[GPUImage中的](https://github.com/BradLarson/GPUImage)[SimpleVideoFilter](https://github.com/BradLarson/GPUImage/tree/master/examples/SimpleVideoFilter)示例。

然后用类似这样的方式消除棕褐色过滤器，以获得预览：

```
videoCamera = [[GPUImageVideoCamera alloc] initWithSessionPreset:AVCaptureSessionPreset640x480 cameraPosition:AVCaptureDevicePositionBack];
GPUImageView *filterView = (GPUImageView *)self.view;
[videoCamera addTarget:filterView];
[videoCamera startCameraCapture]; 
```

这是布拉德在评论中建议的开始：

```
videoCamera = [[GPUImageVideoCamera alloc] initWithSessionPreset:AVCaptureSessionPreset640x480 cameraPosition:AVCaptureDevicePositionBack];
GPUImageLanczosResamplingFilter* filter = [[GPUImageLanczosResamplingFilter alloc] init];
GPUImageView *filterView = (GPUImageView *)self.view;
[videoCamera addTarget:filter];
[filter forceProcessingAtSize:self.view.frame.size];
[filter addTarget:filterView];    
[videoCamera startCameraCapture]; 
```

过滤器的输出也将被发送到 GPUImageMovieWriter。SimpleVideoFilter 示例涵盖了它。

# javascript - 为什么这个 Pair 类不能按我的预期工作

> ID：15177877
> 
> 赞同：0
> 
> 时间：2013-03-02T18:29:34.773
> 
> 标签：javascript

我的背景是 C++，在其中处理对象似乎与 Javascript 非常不同。C++ 有一个 Pair 对象，例如我正在尝试重新创建的下面的 Pair。但是这个类并没有按我的预期工作。也许这对 Javascript 来说是完全错误的方法。我的最终目标是解析一串 key1=val1;key2=val2;key3=val3; 成一个关联数组。因此，任何有关这方面的提示都会有所帮助。但我的第一个问题是下面的 Pair 类。任何帮助将非常感激。

```
<html>
<head>
<title>my title</title>
<script type="text/javascript">
//Pair class - doesnt seem to work
function Pair(key, value) {
    this.key = key;
    this.value = value;
}

Pair.prototype.Key = function() { return this.key; }
Pair.prototype.Value = function() { return this.value; }

function getValueAndKey(text, splitter) {
   //Pair pair = {};
   if(text) {
     var delim = typeof splitter !== 'undefined' ? splitter : '='; 
     var delimpos = text.indexOf(delim);
     if(delimpos != -1) {
          var strkey = text.substr(0, delimpos);
          var strvalue = text.substr(delimpos+1);
          return Pair(strkey, strvalue);      
     }      
   }
   return null;
}

function doIt() {

   function Options(sourceString) {
      this.source = sourceString;

      //populate key/value pairs from source string
      var vars_array = sourceString.split(";");
      for(var i = 0; i < vars_array.length; ++i) {
         //alert("adding vars_array[" + i + "] = " + vars_array[i]);
         var pair = getValueAndKey(vars_array[i]);
         if(pair)  //pair is ALWAYS undefined :(
            alert("key=" + pair.Key() + " value=" + pair.Value());       
      }
   }

   //exercise class
   var sourceString = "cat=Cookie;legs=4;favouritefood=lamb;type=Siamese;";
   var opts = new Options(sourceString);
}
</script>
</head>

<body onload="doIt();">
some test program
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:34:54.737

你根本不需要那些原型函数，并且在 getValueAndKey 函数中你必须返回 new Pair(strkey, strvalue) 而不仅仅是 Pair。也许这可以解决您的问题：

```
<html>
<head>
<title>my title</title>
<script type="text/javascript">
//Pair class - doesnt seem to work
function Pair(key, value) {
    this.key = key;
    this.value = value;
}

function getValueAndKey(text, splitter) {
   //Pair pair = {};
   if(text) {
     var delim = typeof splitter !== 'undefined' ? splitter : '='; 
     var delimpos = text.indexOf(delim);
     if(delimpos != -1) {
          var strkey = text.substr(0, delimpos);
          var strvalue = text.substr(delimpos+1);
          return new Pair(strkey, strvalue);      
     }      
   }
   return null;
}

function doIt() {

   function Options(sourceString) {
      this.source = sourceString;

      //populate key/value pairs from source string
      var vars_array = sourceString.split(";");
      for(var i = 0; i < vars_array.length; ++i) {
         //alert("adding vars_array[" + i + "] = " + vars_array[i]);
         var pair = getValueAndKey(vars_array[i]);
         if(pair)  //pair is ALWAYS undefined :(
            alert("key=" + pair.key + " value=" + pair.value);       
      }
   }

   //exercise class
   var sourceString = "cat=Cookie;legs=4;favouritefood=lamb;type=Siamese;";
   var opts = new Options(sourceString);
}
</script>
</head>

<body onload="doIt();">
some test program
</body>
</html> 
```

# c#-4.0 - 如何仅在 DateTime 对象中删除 C# 中 DateTime 的时间部分？

> ID：15177890
> 
> 赞同：1
> 
> 时间：2013-03-02T18:30:47.983
> 
> 标签：c#-4.0

这里 em 从用户那里获取输入，然后在输出屏幕上打印时转换为 DateTime，它同时显示日期和时间，但我只想显示日期而不是时间，我该怎么做？

```
 //INPUT
 Console.Write("Pleas Enter Date of Birth: mm-dd-yy: ");
 Date_Of_Birth = Console.ReadLine();
 //Converstion
 Date_Only = Convert.ToDateTime(Date_Of_Birth);
 //Printing no ouput Screen.
 Console.Write(Date_Only);" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:33:31.523

您可以使用以下方法控制打印时 DateTime 的格式`.ToString("Format")`：

```
Console.Write(dateOnly.ToString("MM-dd-yy")); 
```

or 使用`.ToShortDateString()`or `.ToLongDateString()`which 将使用当前的文化/语言设置格式化日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:40:40.343

`Console.Write`内置了自己的格式化程序：

```
 Console.Write("{0:MM-dd-yy}", Date_Only); 
```

您也可以考虑使用`Console.WriteLine`而不是`Console.Write`如果您希望它在打印后放置换行符：

```
 Console.WriteLine("{0:MM-dd-yy}", Date_Only); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-19T10:13:17.670

您可以轻松地将 datetime 对象转换为日期或时间

只需将 DateTime.Now 替换为您的日期对象即可。

仅用于日期

```
Console.Write(DateTime.Now.ToShortDateString()); 
```

仅用于时间

```
Console.Write(DateTime.Now.ToShortDateString()); 
```

# c# - ASP.NET 中带有 URL 参数的触发按钮

> ID：15177892
> 
> 赞同：1
> 
> 时间：2013-03-02T18:30:49.293
> 
> 标签：c#, asp.net

正如标题所说，我需要使用 URL 参数触发 ASP.net Web 表单上的某个按钮。我想出了如何用参数填充文本框，但似乎找不到触发按钮的解决方案。任何帮助表示赞赏。

按钮示例：

```
<asp:Button ID="Button2" runat="server" Text="Calculate" 
        onclick="Button2_Click" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:33:16.447

这很简单……您所要做的就是调用“Button2_Click”方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:08:44.473

您可以为此目的使用 javascript。

```
 function triggerClick()
{
var btnSubmitTags = document.getElementById("YourButtonIdHere");
btnSubmitTags.click();
} 
```

您可以像这样在 body 标签的 onLoad 处调用此函数

```
<body onload="triggerClick()"> 
```

或者像这样

```
window.onload = function()
                {
                   triggerClick();
                }; 
```

您还可以使用 queryStrings 中的值填充文本框

但我不知道为什么需要使用查询字符串触发按钮。如果你不是这个意思，请说清楚。

# php - Mysql 条件案例查询 - 找出每个条件返回多少行

> ID：15177896
> 
> 赞同：1
> 
> 时间：2013-03-02T18:31:10.893
> 
> 标签：php, mysql

请看一下这个条件 mysql 查询：

```
SELECT attr1,attr2,attr3 FROM table 
WHERE 
( attr1 LIKE '%cond1%' OR attr1 LIKE '%cond2%' ) 
OR 
( attr2 BETWEEN '30' AND '45' ) 
OR 
( attr3 IN ('cond3') AND attr3 = 'cond4' AND attr3 BETWEEN '18' AND '30' ) 
ORDER BY CASE 
WHEN ( attr1 LIKE '%cond1%' OR attr1 LIKE '%cond2%' ) THEN 1 
WHEN ( attr2 BETWEEN '30' AND '45' ) THEN 2 
ELSE 3 
END 
```

有没有办法用 mysql 和 php 获得每个条件返回的行数？还是处于租赁条件 3？

例如，我需要一种方法来知道条件 3 返回了 200 行并将此值存储到 php 变量中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:40:55.600

您可以使用`CASE WHEN ... THEN ... ELSE ... END`with `SUM`（或`COUNT`使用`NULL`作为`ELSE`结果）作为`SELECT`. 使用上面给出的示例，您将执行以下操作：

```
SELECT
    SUM(CASE WHEN attr1 LIKE '%cond1%' OR attr1 LIKE '%cond2%' THEN 1 ELSE 0 END) AS condition1count,
    SUM(CASE WHEN attr2 BETWEEN '30' AND '45' THEN 1 ELSE 0 END) AS condition2count,
    SUM(CASE WHEN attr3 IN ('cond3') AND attr3 = 'cond4' AND attr3 BETWEEN '18' AND '30' THEN 1 ELSE 0 END) AS condition3count
FROM
    table
... 
```

但是请记住，根据数据的内容，某些行可能匹配 3 个条件中的多个条件，因此 3 个计数的总和可能大于返回的行数。

# vim - 如何用clang自动完成？

> ID：15177901
> 
> 赞同：1
> 
> 时间：2013-03-02T18:31:31.580
> 
> 标签：vim, clang, omnicomplete

我在我的 vim 中使用了 clang [https://github.com/Rip-Rip/clang_complete](https://github.com/Rip-Rip/clang_complete)，并尝试让它在omnicompletion 上工作。键入时可以调出菜单。或 ::，但是，我不知道如何从菜单中的项目中进行选择。制表符或空格或输入键根本不起作用。那么如何从菜单中选择呢？如何让它完成它的猜测？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T19:04:57.423

AFAIK，这个插件只是使用与 Vim 的默认插入模式完成相同的菜单。如果我是对的，您应该使用箭头在列表中上下移动并`<enter>`实际完成。

见`:h ins-completion-menu`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T02:21:02.280

向下选择：Ctrl + N
向上选择：Ctrl + P

# vb.net - 尝试在用户桌面上创建文件时权限被拒绝

> ID：15177902
> 
> 赞同：1
> 
> 时间：2013-03-02T18:31:43.203
> 
> 标签：vb.net, file, creation

我有一个需要创建日志文件的小型 VB 应用程序，理想情况下，我希望在用户桌面上使用它，因为它很容易看到。

但是，当我尝试创建文件（*.txt 文件）时，出现以下错误 -

> 在 mscorlib.dll 中发生了“System.UnauthorizedAccessException”类型的第一次机会异常

现在，似乎很明显这是一个权限问题，但我不知道如何解决它，所以我想知道是否有人可以帮助我？谢谢。

创建文件的完整代码（取自 MSDN，稍作修改） -

```
Imports System
Imports System.IO
Imports System.Text

Module write_text

    Public Class Log_File

        '*'
        ' Createa a log file on the users desktop and adds the 'output' text to it
        '
        ' @param required string output The text to output to the log
        '*'
        Public Shared Sub write_to_file(ByVal output As String)

            Dim path As String      ' The path to where the file to create and write should be saved
            Dim file_name As String ' The name of the log file that is to be created

            Debug.Print(vbCrLf & "    write_to_file(){" & vbCrLf)

            ' Set the error handler
            On Error GoTo ExitError

            path = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory)
            file_name = "MusicRenaming - " & Date.Today & ".txt"
            Debug.Print("        Log file: " & path & "\" & file_name)

            ' Check if the file exists
            If File.Exists(path) = False Then

                ' Create a file to write too. 
                Dim sw As StreamWriter = File.CreateText(path)
                sw.WriteLine("Hello")
                sw.WriteLine("And")
                sw.WriteLine("Welcome")
                sw.Flush()
                sw.Close()
                Debug.Print("        File had to be created")

            End If

            ' Open the file to write too
            Dim sr As StreamReader = File.OpenText(path)
            Do While sr.Peek() >= 0
                Console.WriteLine(sr.ReadLine())
                Debug.Print("        Output to file complete")
            Loop

            ' Close the file
            sr.Close()

            Debug.Print(vbCrLf & "    }")

ExitError:
            If Err.Number <> 0 Then functions.error_handler()

        End Sub

    End Class

End Module 
```

**请不要**- 我意识到这个功能现在不是特别可操作，我只是想先创建文件，然后我会处理它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T21:16:08.757

感谢@RubensFarias[在此线程中](https://stackoverflow.com/questions/1613666/creating-and-appending-text-to-txt-file-in-vb-net)发布的答案，我能够解决此问题。

我还在`try...catch`对我的原始问题的评论中纳入了@minitech 建议的方法，所以希望他对我解决他的担忧感到满意:)

```
Imports System.IO

Module write_text

    Public Class Log_File

        '*'
        ' Createa a log file on the users desktop and adds the 'output' text to it
        '
        ' @param required string output The text to output to the log
        '*'
        Public Shared Sub write_to_file(ByVal output As String)

            Dim file_name As String     ' The name of the log file that is to be created
            Dim file_path As String     ' The full path to where the file to create and write should be saved
            Dim file_exists As Boolean  ' Whether or not the file already exists

            Try

                file_name = "MusicRenaming - " & DateTime.Today.ToString("dd-mm-yyyy") & ".txt"
                file_path = Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory) & "\" & file_name
                file_exists = File.Exists(file_path)

                Using sw As New StreamWriter(File.Open(file_path, FileMode.OpenOrCreate))
                    sw.WriteLine(output)
                End Using

            Catch oError As Exception
                functions.error_handler(oError)
            End Try

        End Sub

    End Class

End Module 
```

# c++ - Win32 子类化窗口消息

> ID：15177904
> 
> 赞同：0
> 
> 时间：2013-03-02T18:31:47.483
> 
> 标签：c++, winapi, subclassing

我在 Win32 应用程序中有一个带有按钮窗口的静态窗口，我对按钮进行了子类化，因此我可以用我的单个“MessageProc”来处理它的消息。

```
void MyProgram::Initialize(WNDPROC messageProc)
{
    //Here I create a bunch of windows
    _resourceWindow = CreateWindow("STATIC", "Resources", WS_CHILD | WS_VISIBLE | WS_SIZEBOX, 5, 5, 200, 600, 0, 0, _mainInstance, NULL);
    //The child button
    _resourceAddButton = CreateWindow("BUTTON", "Add", WS_CHILD | WS_VISIBLE, 5, 20, 50, 20, _resourceWindow, 0, _mainInstance, NULL);

    _resourceAddButtonWndProc = (WNDPROC)SetWindowLongPtr(_resourceAddButton, GWLP_WNDPROC, (WNDPROC)messageProc);
    //Messages from this button are sent to messageProc now
}

void MyProgram::SubclassesProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    switch(uMsg)
    {
        case WM_PAINT:
        {
            if(hWnd == _resourceAddButton) //I have more than one child button so I'll have to do this one by one right?
            {
                CallWindowProc(_resourceAddButtonWndProc, hWnd, uMsg, wParam, lParam);
            }
        }
    }
} 
```

这个“SubclassesProc”在我的“messageProc”函数的默认部分被调用。

现在的方式是，我的 Button 根本没有得到“点击”，我点击但没有任何反应（它不会在视觉上发生变化，也不会调用 WM_COMMAND）。我猜这是因为现在来自该 Button 的所有消息都由 messageProc 函数处理，这导致了一些消息阻塞......例如，Button 控件中的 WM_LBUTTONDOWN 永远不会被调用，因为我已经有一个：

```
switch(uMsg)
{
    case WM_LBUTTONDOWN:
    {
        //I'm doing something else
        break;
    }
    //bunch of other commands
    default:
    {
        myProgram.SubclassesProc(hWnd, uMsg, wParam, lParam);
        break;
    }
} 
```

因此，永远不会调用带有 WM_LBUTTONDOWN 的 SubclassesProc，并且无法单击 Button，因此不会触发 WM_COMMAND。

处理这个问题的正确方法是什么？

现在我正在考虑重写 messageProc 函数，但我必须考虑几乎每个用户输入消息中的每个子类窗口......或者只是忘记子类化。

# c++ - 无法通过 DLL 传递 std::wstring

> ID：15177907
> 
> 赞同：6
> 
> 时间：2013-03-02T18:31:49.340
> 
> 标签：c++, visual-studio-2010, visual-c++, dll

我已经在 Visual Studio 2010 中建立了一个项目来针对现有的 MFC DLL 编写单元测试。我正在使用单头单元测试框架，并从单元测试项目链接到 MFC DLL 的 lib 包装器。我正在尝试构建一个`std::wstring`在其构造函数中包含 a 的类。这是我的测试的样子：

```
TEST_CASE("MyProject/MyTest", "Do the test.")
{
    MockDbService mockDbService;
    Foobar foo(L"{F00DFACE-FEED-DEAD-BEEF-C0FFEEDECADE}", mockDbService);

    foo.loadObject();

    REQUIRE(mockDbService.getMethodInvokeCount("query()") >= 1);
} 
```

`Foobar`从被测 MFC DLL 导出的类在哪里。但是，测试框架报告了一个意外的异常。将字符串复制到 ' 的构造函数时，我将其跟踪到`std::wstring`' 的复制构造`Foobar`函数。MSVC 调试器将源字符串报告为`<Bad Ptr>`.

我创建了一个虚拟构造函数，`Foobar::Foobar(long num, IDbService& db)`所有值（包括`IDbService&`）都很好。

MFC DLL 和我的单元测试 EXE 都共享一个属性表，它应该保持编译器标志相同。我正在调试模式下构建和运行测试。任何想法为什么`std::wstring`不能跨 DLL 复制？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-02T18:42:19.703

您应该检查 EXE 和 DLL 是否与同*一个调试 CRT*（编译器选项）*动态链接。*确保EXE 和 DLL 的其他设置也相同。*`/MDd``_HAS_ITERATOR_DEBUGGING`*

 *（一个快捷方式可能是只使用`const wchar_t*`而不是`std::wstring`在类接口处，并且只是`std::wstring`从构造函数体内的原始指针构建一个）。

**编辑**：您确认 CRT 不匹配（即用 构建的 EXE 与用 构建的`/MD`DLL `/MDd`）是问题所在。事实上，相同的类名`std::wstring`在调试版本 ( `/MDd`) 和发布版本 ( `/MD`) 中意味着两个不同的类。事实上，在调试版本中，类实现中可以有额外的机制来帮助调试；这种机制可能会导致效率低下，因此在发布版本中已将其删除。因此，调试构建的内部结构`std::wstring`与发布构建的不同`std::wstring`（例如，如果您尝试打印实例的原始数据`sizeof`，`std::wstring`您可以在发布构建和调试构建中找到不同的数字）。因此，使用构建的 EXE`/MD`期望发布构建的`std::wstring`; 而是使用构建的 DLL`/MDd`期待 debug-build's `std::wstring`：这两个期望之间存在不匹配（一个模块期待 class`X`但另一个模块正在提供 class `Y`），所以你有一个崩溃。*

# hadoop - EC2 上的 Hadoop 与 Elastic Map Reduce

> ID：15177908
> 
> 赞同：17
> 
> 时间：2013-03-02T18:31:55.507
> 
> 标签：hadoop, amazon-web-services

我正在尝试评估这两个选项之间的差异。以下是我能想到的一些优点和缺点：

Elastic Map Reduce => 来自 Amazon 的更好支持，无需管理集群，更昂贵（？） EC2 + Hadoop => 更多地控制您的 hadoop 配置，更便宜（？）

我想知道是否有人对 EC2 + Hadoop 相对于 EMR 的性能进行了基准测试？大型集群部署的成本是否存在显着差异？还存在哪些其他差异？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T23:28:42.943

我们在我的工作中使用这两种方法（EMR 和 EC2）。

Amar 提到的 EMR 的优点或多或少是真实的：因此，如果您想要简单，它可能是要走的路。

但还有其他考虑：

*   EMR 的版本远远落后于 apache head。它大约是 0.20.205，而 head 是 2.X，这基本上是 3 个版本（1.0、1.1、2.0..）

hadoop@domU-12-31-39-07-B9-97:~$ ll hadoop*.jar lrwxrwxrwx 1 hadoop hadoop 73 Feb 5 12:00 hadoop-examples-0.20.205.jar -> /home/hadoop/。版本/0.20.205/share/hadoop/hadoop-examples-0.20.205.jar lrwxrwxrwx 1 hadoop hadoop 69 Feb 5 12:00 hadoop-test-0.20.205.jar -> /home/hadoop/.versions/0.20。 205/share/hadoop/hadoop-test-0.20.205.jar lrwxrwxrwx 1 hadoop hadoop 69 Feb 5 12:00 hadoop-core-0.20.205.jar -> /home/hadoop/.versions/0.20.205/share/ hadoop/hadoop-core-0.20.205.jar lrwxrwxrwx 1 hadoop hadoop 70 Feb 5 12:00 hadoop-tools-0.20.205.jar -> /home/hadoop/.versions/0.20.205/share/hadoop/hadoop- tools-0.20.205.jar lrwxrwxrwx 1 hadoop hadoop 68 Feb 5 12:00 hadoop-ant-0.20.205.jar -> /home/hadoop/.versions/0.20.205/share/hadoop/hadoop-ant-0.20。 205.jar

*   由于在 EMR 上运行的旧版本中缺少 contrib 模块，因此我不得不重新编码/重组我的 Map/reduce 程序

*   您没有机会使用非 Map/Reduce 算法，就好像您使用的是 M/R 的更新版本一样。

*   混合和匹配 hadoop 生态系统版本的灵活性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-02T20:10:38.307

好吧，管理/监控/维护集群本身并不是一项小任务。使用 EMR，您可以立即使用自定义引导代码配置、启动和运行机器。除了做所有这些事情之外，EMR 还提供了许多其他工具/选项/设施。

在这里，您不必担心在作业完成后终止集群，您当然可以在 EC2+Hadoop 设置中为自己实现一种方法，但 EMR 以一种简洁的方式为您做到这一点。

即使您的作业正在运行，您也可以[调整集群大小！](http://docs.aws.amazon.com/ElasticMapReduce/latest/DeveloperGuide/ResizeJobFlow.html)

EMR 提供的 Pig 和 Hive 还包含补丁，可以更轻松地在 S3 中处理文件。

即使在[此](http://www.quora.com/What-are-the-advantages-of-Amazon-EMR-vs-your-own-EC2-instances-vs-running-Hadoop-locally)答案中，您也可能会发现 EMR 已占上风。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-22T17:44:15.517

我回答了另一个问题，因此在这里添加它以及它们是相关的可能会有所帮助。

有人在评论中提到（人们实际上有印象）EMR 在 ec2 节点（这是 spark 的底层主/计算节点）之上增加了一些成本，并且只提供集群，但事实并非如此。

但是 elastic map reduce 关注的是`elastic`和`scalability`部分，这意味着为您的作业提供可伸缩性，其中可伸缩性不仅仅是集群中的节点数量，而是不同的参数，例如

1.  使用正在运行的作业动态调整集群大小

2.  减少和优化旋转时间，提供高效的重新提交步骤和选项，如步骤完成时自动终止

3.  配置、管理和更新时间。就像一个小的你有一些东西，比如自动处理 spark/hadoop/其他应用程序版本的[发布版本](https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-release-5x.html#emr-5310-release)，为你提供了轻松更新你必须使用 ec2 手动执行的版本的方法。

4.  生态系统的可用性。EMR 生态系统正在增长，它不会反映您何时开始，但例如当您的需求增长时，例如当您开始将其他系统流处理与 flink 集成时）然后在启动时选择更`flink`容易`pig`，，`hive`和如果您将来需要使用其他东西，请再等等。

5.  已经有使用 AWS SDK 实现的库，例如 python 中的 boto3，可帮助您提交步骤、轮询完成等，这在您需要扩展时非常有用。此外，您还可以将 emr 与诸如气流之类的编排框架集成，其中可以感知状态、重新提交、一个命令在管道中旋转集群。

6.  扩展上一点，例如[EMR 笔记本](https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-jupyter-emr-managed-notebooks.html)为您提供了从 Jupiter 笔记本提交 Spark 作业并查看结果的快速交互方式，并立即查看作业进度，这可以提高您的工作效率。

7.  根据我的经验，这一点是最重要的，有时，扩展具有更多节点的作业比使用少量节点的长时间运行作业可以节省更多的钱。因为添加节点的成本有时会低于您在 ec2 或小型 emr 集群上花费的标准化小时数。只是为了分享我的经验，我们有一个过去运行 3 天的工作，我们用更大的 EMR 集群来运行它，将它减少到 6-8 小时，它仍然是相同的成本，实际上少了一点。

# qt - 控制滚动条上滑块的大小

> ID：15177909
> 
> 赞同：1
> 
> 时间：2013-03-02T18:32:01.627
> 
> 标签：qt, user-interface

我正在编写一个可以使用水平滚动条平移的 UI，但也可以独立平移和缩放（如非线性编辑器的剪辑窗口）。这是一个基于 Qt 的 UI，我不需要考虑高度，只需考虑长度。

平移本身，我想我可以处理，但不能处理缩放。问题是如何控制滚动条上滑块/手柄小部件的大小。当放大到 UI 时，它应该缩小，缩小时相反。滑块的大小应该反映缩放比例（即，如果我放大到 10% 的视图，滑块应该是滚动条大小的 10% 左右，或者尽可能接近）。

问题是Qt似乎并没有让我直接控制滑块的大小，我只能通过最小/最大值和大步数的组合来间接控制它，这就是我所在的地方（尴尬）卡住。我似乎无法缩放这些因素并保留我的滚动条。以前有没有其他人做过这种事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T17:00:46.437

对不起，

自己没用过maya。。

如果您想知道滑块（拇指）的大小，正如您所说，使用 setMaximum()、setMinimum() 函数进行控制。

如果我正确地满足您的要求，您希望拇指大小与缩放级别相对应

*   1000% 缩放，缩放系数 = 10 -> 拇指大小为滚动条的 10%
*   100% 缩放，没有滚动条。

我假设您可以计算缩放因子（例如 K），这将是您的缩放比例，并且您可以通过 Maya 控制滚动条的 Min/Max/Current 值

在这种情况下，滚动条最小值始终为 0。

*   当缩放因子为 1(k- current):1(original) 时，将滚动条的最大值设置为您显示的内容的宽度。保存此最大值以备将来使用，例如 (Z)

^^ 如果您的内容完全填充了可用宽度，这将不会在缩放因子 1 处为您提供滚动条。

*   接下来，当您的缩放系数更改为 K = 2（200% 比例）时。
    1.  `Y`通过计算获得旧的缩放因子（ ） `scrollbar->maximum() / Z`。
    2.  将新[滚动条最大值](http://qt-project.org/doc/qt-4.8/qabstractslider.html#maximum-prop)设置为`K * Z`。
    3.  将新[滚动条值](http://qt-project.org/doc/qt-4.8/qabstractslider.html#value-prop)设置为`scrollbar->value() * K / Y`。

^^ 现在这将反过来将滚动条拇指的大小设置为您要查找的大小（缩放因子）

请注意，这假设您的缩放因子为 1 的内容不需要滚动条并且完全适合可用宽度。

如果不是这种情况，并且显示内容的控件的宽度是可调整大小的，则上述逻辑的结果将意味着缩放系数为 10 意味着当缩放系数为 1 时，拇指将处于其大小的 10%。因此，拇指的大小将不是滚动条的 10%，而是 100% 缩放时自身的 10%

# mysql - MySql：如何使用单个查询选择两个表之间的所有连接行以及首先满足条件的所有行？

> ID：15177912
> 
> 赞同：4
> 
> 时间：2013-03-02T18:32:33.857
> 
> 标签：mysql, sql, join, left-join, inner-join

我有两张桌子。

假设表 p 和表 q。这是我所做的：

```
select p.*, q.* 
from p inner join q on p.field = q.field 
where q.col = 'someValue'; 
```

假设结果集是这样的：

```
p.field q.field ....
   5 5 ...
   6 6 ...
   12 12 ..
   55 55 ....
   3 3 ...

```

现在我想选择这些行并使用单个查询：

```
select p.*  
from p where p.sat = 'value' 
```

结果集：

```
p.字段 ....
   44 ...
   93 ...
   13 ..
   8 ....
   55 ...

```

我不想使用`union`或子查询。

但是，我想在以下（示例）结果集中合并/合并这些行：

```
p.field q.field ....
   5 5 ...
   6 6 ...
   12 12 ..
   55 55 ....
   44 空...
   93 空...
   13 空..
   8 无效 ....

```

我必须将两个结果集加入到第三个表中，并按第三个表中的字段排序（如果确实重要的话）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:39:06.113

你可以这样做：

```
SELECT
  p1.*, 
  q.* ,
  p2.* -- Note that you might need to change the columns' names 
       -- with different aliases than those selected from p1.*
FROM p       AS p1
INNER JOIN q        ON p.field = q.field 
INNER JOIN p AS p2  ON p.field = p2.field 
                   AND p2.sat = 'value'
WHERE q.col = 'someValue'
-- ORDER BY ...; 
```

* * *

我认为您必须`UNION`像这样使用它：

```
SELECT
  p.field field1,
  q.field field2
FROM p
INNER JOIN q  ON p.field = q.field
UNION ALL
SELECT p.field, NULL
FROM p
WHERE sat = 'value'; 
```

这会给你：

```
| FIELD1 | FIELD2 |
-------------------
|      5 |      5 |
|      6 |      6 |
|     12 |     12 |
|     55 |     55 |
|      3 |      3 |
|     55 |     55 |
|     44 | (null) |
|     93 | (null) |
|     13 | (null) |
|      8 | (null) |
|     55 | (null) | 
```

## [SQL 小提琴演示](http://sqlfiddle.com/#!2/0b154/5)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T18:53:08.660

如果我理解正确，您需要所有行`p.sat = 'value'`以及满足 q 上的连接和条件的行。这最容易表示为`left outer join`：

```
select p.*, q.* 
from p left outer join
     q
     on p.field = q.field 
where p.sat = 'value' or q.col = 'someValue' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T18:41:39.573

我不确定这是否可行，但试试这个。

`SELECT p.*, q.* FROM p, q WHERE (p.field = q.field AND q.col = 'someValue') OR (q.sat = 'value')`

# mysql - MySQL - 每小时运行数据集之间差异的平均值

> ID：15177916
> 
> 赞同：0
> 
> 时间：2013-03-02T18:32:43.643
> 
> 标签：mysql, average

**我在下面** 有一个名为投票的表格。我有一个每分钟运行一次并收集 20 个项目的数据的脚本。该脚本保存项目的 ID、项目的总运行投票计数以及添加条目的日期时间。

**我想要做的问题** 是计算每月迄今为止的平均票数。请记住，投票字段包含该项目的运行总票数，因此例如每小时的投票数将通过将 2013-03-01 00:01:01 的条目减去 2013-03- 的条目的差来计算01 00:00:01。我需要计算每小时的增量，然后对 20 个项目中的每一个项目取这些结果的平均值。结果集为 20 个值，即从 3 月 1 日到当前日期的 20 项中的每一项的每小时平均票数。

我有一些在代码循环中工作的东西，但我想把它放到一个 MySQL 语句中。到目前为止，我所有的尝试都没有产生接近所需结果集的任何东西。

**表（前两个脚本迭代）**

> |// **id** //|int(11)
> |item_id|int(11)
> |votes|int(11)
> |date_added|datetime
> 
> |id|item_id|votes|date_added|
> 
> |1|1|1|2013-03-01 00:00:01
> |2|2|1|2013-03-01 00:00:01
> |3|3|0|2013-03-01 00:00: 01
> |4|4|0|2013-03-01 00:00:01
> |5|5|0|2013-03-01 00:00:01
> |6|6|0|2013-03-01 00:00 :01
> |7|7|0|2013-03-01 00:00:01
> |8|8|0|2013-03-01 00:00:01
> |9|9|0|2013-03-01 00: 00:01
> |10|10|0|2013-03-01 00:00:01
> |11|11|0|2013-03-01 00:00:01
> |12|12|0|2013-03-01 00 :00:01
> |13|13|0|2013-03-01 00:00:01
> |14|14|0|2013-03-01 00:00:01
> |15|15|0|2013-03-01 00:00:01
> |16|16|0|2013-03-01 00:00:01
> |17|17|0|2013-03-01 00:00:01
> |18|18|0|2013-03-01 00:00: 01
> |19|19|0|2013-03-01 00:00:01
> |20|20|0|2013-03-01 00:00:01
> --
> |21|1|10|2013-03-01 00 :01:01
> |22|2|13|2013-03-01 00:01:01
> |23|3|5|2013-03-01 00:01:01
> |24|4|6|2013-03-01 00:01:01
> |25|5|1|2013-03-01 00:01:01
> |26|6|8|2013-03-01 00:01:01
> |27|7|9|2013-03- 01 00:01:01
> |28|8|3|2013-03-01 00:01:01
> |29|9|10|2013-03-01 00:01:01
> |30|10|2| 2013-03 -01 00:01:01
> |31|11|2|013-03-01 00:01:01
> |32|12|9|2013-03-01 00:01:01
> |33|13|3|2013- 03-01 00:01:01
> |34|14|5|2013-03-01 00:01:01
> |35|15|9|2013-03-01 00:01:01
> |36|16|1|2013-03-01 00:01:01
> |37|17|2|2013-03-01 00:01: 01
> |38|18|1|2013-03-01 00:01:01
> |39|19|6|2013-03-01 00:01:01
> |40|20|3|2013-03-01 00:01 :01

# shell - 捆绑到调用 Ruby 的命令时的 Bundler::RubyVersionMismatch

> ID：15177917
> 
> 赞同：1
> 
> 时间：2013-03-02T18:32:49.093
> 
> 标签：shell, rake, bundler, runtime-error, heroku-toolbelt

一个 Bundler::RubyVersionMismatch 错误被发出（来自 Bundler 管理的代码）当一个命令本身使用另一个版本的 Ruby 时。

当在 Gemfile 中为某些 shell 命令指定 Ruby 版本时，会发生这种情况。

一类示例是向 Heroku 工具带命令发送的 Rake 任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T18:37:48.797

在代码中，环绕`Bundler.with_clean_env{}`命令shelled-out to。

有关这方面的更多信息，请参阅 Bundler[问题](https://github.com/carlhuda/bundler/issues/2355)。

# fadein - 加载图像后的同位素显示库

> ID：15177919
> 
> 赞同：4
> 
> 时间：2013-03-02T18:32:50.703
> 
> 标签：fadein, document-ready

我试图搜索并查看此下方是否列出了任何内容，但我什么也没看到。我有一个使用 Isotope 布置的画廊，它工作正常，但是当页面加载时，画廊中的图像显示在页面中间，然后一旦加载它们就会跳转到各自的位置。

我试图找出一种方法来将容器设置为隐藏，直到图像出现在它们的位置，然后用 $container.fadeIn(1000); 淡入它们。

我只是不知道如何在加载后触发该功能。我已经尝试在几个地方使用 Document.ready，但似乎无法让它做出正确的反应。

```
<script>
$(function(){

  var $container = $('#container');

  $container.imagesLoaded( function(){
    $container.isotope({
        layoutMode : 'fitRows',
        itemSelector : '.photo'
    }); 

  });

$container.fadeIn(1000);

}); 
```

这种工作，但它并没有真正监听到完全加载的图像。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-26T07:38:56.710

该插件的作者[在 GitHub 上对其进行了解释](https://github.com/desandro/isotope/issues/282)。其实很简单。`fadeIn`只需在启动同位素库之前添加右侧。

```
var $container = $('#container');

$container.imagesLoaded( function(){
  $container.fadeIn(1000).isotope({
    layoutMode : 'fitRows',
    itemSelector : '.photo'
  });
}); 
```

# visual-studio-2010 - 如何实现基于目录的自定义项目类型

> ID：15177920
> 
> 赞同：2
> 
> 时间：2013-03-02T18:32:57.413
> 
> 标签：visual-studio-2010, visual-studio, vsx

我需要实现一个完全不依赖项目文件来保存其数据的自定义项目类型，而是以与标准“网站”项目的工作方式几乎相同的方式“绑定”到目录.

我注意到“网站”项目在 .sln 文件中保留了目录的路径以及网站 URL。自定义项目类型是否可以做同样的事情，如果可以，如何做？

现在，由于不会有这样的项目文件，看起来我将无法使用标准方法来制作项目模板。此外，我需要启动外部代码来生成默认项目内容。我正在考虑实现一个自定义向导，但我完全不确定是否可以制作一个仅调用向导来创建项目并且不包含任何基于文件的内容的模板？

最后，我如何提供基于目录而不是文件打开项目的能力？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-11T01:02:55.803

I think Python Tools for Visual Studio uses this approach (at least it used to be). It's open source so just take a look how it's done - [http://pytools.codeplex.com/](http://pytools.codeplex.com/)

# c++ - C++ find_if 函数：

> ID：15177928
> 
> 赞同：1
> 
> 时间：2013-03-02T18:33:22.383
> 
> 标签：c++

我正在尝试了解 find_if 函数的工作原理，并且我正在遵循此参考中的示例：

[http://www.cplusplus.com/reference/algorithm/find_if/](http://www.cplusplus.com/reference/algorithm/find_if/)

当我遵循上述参考中给出的示例时，这意味着当我使用 main() 时，一切正常。但是当我尝试将该示例包含在一个类中时（如下所示），我在编译时收到此错误：

```
error: argument of type ‘bool (A::)(int)’ does not match ‘bool (A::*)(int)’ 
```

在我的课堂上：

```
 bool A::IsOdd (int i) {
  return ((i%2)==1);
}

void A::function(){
   std::vector<int> myvector;

   myvector.push_back(10);
   myvector.push_back(25);
   myvector.push_back(40);
   myvector.push_back(55);

   std::vector<int>::iterator it = std::find_if (myvector.begin(), myvector.end(), IsOdd);
   std::cout << "The first odd value is " << *it << '\n';
  } 
```

谁能帮我理解为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:35:26.133

`A::isOdd`需要一种`static`方法。否则只能与特定的`A`. 由于`isOdd`根本不依赖于成员字段，因此可以将其更改为`static`方法。更重要的是，由于它根本不依赖于类，您可以创建一个全局`isOdd`：

```
bool isOdd(int i){
    return i % 2;
} 
```

**编辑**：正如克里斯所建议的，您还可以使用简单的 lambda (C++11)：

```
auto it = std::find_if (
     myvector.begin(), 
     myvector.end(),
     [](int i) -> bool{ return i % 2; }
); 
```

# python - 使用 Dropbox python api 下载媒体文件

> ID：15177930
> 
> 赞同：0
> 
> 时间：2013-03-02T18:33:29.987
> 
> 标签：python, api, python-2.7, dropbox, dropbox-api

我正在尝试使用 python api 从 Dropbox 下载文件。[我所做的与他们在“入门”页面https://www.dropbox.com/developers/core/files#python](https://www.dropbox.com/developers/core/files#python)上所说的完全相同。 它适用于简单的文本文件，但在用于媒体时会下载损坏的文件文件（如 .mp3 或 .jpg）。是否有我遗漏的东西，或者下载文件的不同方法？谢谢，Guyzyl

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T22:51:42.907

Dropbox 页面上的示例未针对 MP3 或 JPG 等二进制文件进行优化。您应该替换`out = open('magnum-opus.txt', 'w')`为`out = open('magnum-opus.txt', 'wb')`.

请参阅[open built-in 上的 Python 文档](http://docs.python.org/2/library/functions.html#open)：

> 默认是使用文本模式，它可以在写入和读取时将 '\n' 字符转换为特定于平台的表示。因此，在打开二进制文件时，应在模式值后附加“b”以二进制模式打开文件，这将提高可移植性。（即使在不区分二进制文件和文本文件的系统上，附加 'b' 也很有用，它用作文档。）

# php - $i = $i + $x; 的最短 PHP 代码

> ID：15177932
> 
> 赞同：0
> 
> 时间：2013-03-02T18:33:32.767
> 
> 标签：php

我试图学习一些更短的在 php 中做事的方法

是否有一种更短的方法可以将数字添加到变量中

在这种情况下，我想缩短的代码是：`$num = $num + rand(1000, 100);`

例如：

```
$num = 0;
        $count = 10;
        $i = 0;

        while ($i < $count) {
            $num = $num + rand(1000, 100);
            echo"$num<br/>";
            $i++;
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-02T18:34:34.780

您可以使用`+=`

```
$num += rand(1000, 100); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-02T18:51:13.123

您说您想学习“在 php 中做事的一些更短的方法”。好吧，有一种更快的方法可以将一个添加到变量中。

```
// You can use $i+1
$i = 1;
$i = $i + 1

// Or $x++
$x = 1;
$x++;

// Now, if we echo this out we will get the same result from using $i+1 or $x++
echo $i;
echo $x; 
```

# javascript - element.addEventListener('load', func) 和 element.onload=func 之间有什么区别吗？

> ID：15177935
> 
> 赞同：-1
> 
> 时间：2013-03-02T18:33:39.680
> 
> 标签：javascript, html

`element.addEventListener('load', func)`和有什么区别`element.onload=func`吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-02T18:35:48.087

DOM "load" 事件的作用仍然非常有限。这意味着它只会为`window`对象、图像和`<script>`元素触发。直接`onload`分配也是如此。这两者之间没有技术差异。可能`.onload =`具有更好的跨浏览器可用性。

但是，您不能将加载事件分配给`<div>`or`<span>`元素或诸如此类的东西。

# php - 使用动态生成的 imagejpeg - FORM POST 的替代方案

> ID：15177940
> 
> 赞同：0
> 
> 时间：2013-03-02T18:33:57.663
> 
> 标签：php, variables, gd

我正在尝试制作一个包含一些媒体内容的网站，我想以各种方式保护这些内容。我知道你永远不可能 100%，但我喜欢能够通过 imagejpeg 提供图像，所以我不向查看者提供媒体地址的实际地址，也不能复制地址并以这种方式查看图像。

主要是隐藏实际的媒体链接地址。

我像这样 NEW_SIZE_IMAGE.PHP / NEW_SIZE_IMAGE_THUMB.PHP 输出图像：

```
 // Content type
    header('Content-Type: image/jpeg');

    // Output
    imagejpeg($thumb); 
```

由于标题的性质，我只能在 iframe 内执行此操作。使用 iframe，我遇到了将动态变量传递给页面的问题，因为这不是 POST。图像在页面上的单独 iframe 中加载。

这就是我的拇指图片的问题，然后我对高分辨率图片也有类似的问题，我通过小盒子运行。

我像这样 MAIN_SITE.PHP 运行图像导航：

```
 <a onclick="TINY.box.show({url:'../image_holder_pop.php',width:800,height:600})">
    <iframe width="300" height="200" src="../new_size_image_thumb.php"></iframe>
    <br />
    <h2><br />HIGH RES LINK</h2></a> 
```

IMAGE_HOLDER_POP.PHP

```
 <iframe width="800" height="600" src="../new_size_image.php"></iframe> 
```

我需要将一个变量传递给 new_size_img.php / new_size_img_thumb.php 文件才能使其工作。

编辑：问题图片： ![我的问题图片 - tinybox 中的 php 图像](../Images/2124bcc381da61593876642c736d3751.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T08:14:09.670

您可以使用在哈希和图像 ID 之间建立关系的数据库来混淆您的 ID。

而不是 put `new_img.php?id=123`，你会做`new_img.php?hash=0guww7g4ow`，例如在 Youtube 上。

您需要在`hash`当前图像表中添加一列（如果您使用 id，我假设您已经拥有一列），并且您需要为每个现有图像创建哈希。

要生成以 36 为基数的 10 个字符的哈希（10^36 组合，我认为这已经足够了），我习惯于：

```
$hash = substr(str_shuffle(base_convert(str_shuffle(sha1(str_shuffle(md5(rand() . microtime())))), 16, 36)), 0, 10); 
```

然后，创建一个`reader.php`以哈希作为 GET 参数，并使其做哈希和图像之间的关系。最后，使用`imagejpeg`（甚至更简单，`readfile`）显示它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T21:31:23.663

尚不清楚您希望传递给 PHP 的这个变量到底做什么。我假设您只是想指出您想要的图像，或者某种用户标识符等......

如果你想将这样的变量传递给 PHP，你可以使用`querystring`请求的 。（适用于`GET`请求）

例如，您可以`<img>`使用以下内容创建一个元素`src`：[http ://example.com/new_size_image.php?image=imagename&otherparam=1&otherparam2=2](http://example.com/new_size_image.php?image=imagename&otherparam=1&otherparam2=2)

其中 imagename 是图像的标识符，而 otherparam1 和 2 是可选参数。您可以像这样在 PHP 中访问这些变量：

```
$imagename = $_GET['image'];
$otherparam = $_GET['otherparam'];
$otherparam2 = $_GET['otherparam2']; 
```

然后您可以使用它来确定要为客户提供哪个图像。

接下来，我对您为什么认为需要 iframe 感到困惑。他们不会混淆任何内容或阻止用户复制链接。只使用图像要好得多——您只需要设置正确的标题。例如，试试这个函数，它以`$filename`你想要加载的图像的路径作为参数。

```
function outputImage( $filename ) {
    header('Content-Description: File Transfer');
    header("Content-type: image/jpeg");
    header('Content-Disposition: attachment; filename='.basename($filename ));
    header('Content-Transfer-Encoding: binary');
    header('Expires: 0');
    header('Cache-Control: must-revalidate');
    header('Pragma: public');
    header('Content-Length: ' . filesize($filename ));
    ob_clean();
    flush();
    readfile($filename );
    exit;
} 
```

（这是来自一个相关问题：[URL to a random image](https://stackoverflow.com/questions/15151051/url-to-a-random-image/15151292#15151292)）

**关于安全性的说明：**如果您使用查询字符串将您想要的图像传递给脚本（也就是`?image=`从第一个块开始），请确保您**没有**传递文件在磁盘上的位置，否则足够精明的用户可以制定一个请求，使您的脚本发送他们选择的任何文件。相反，我建议使用某种标识符，例如`?image=123456`.

这将允许您将此脚本的 url 用作`<img>`元素，如下所示：

```
<img src="http://example.com/new_size_image.php?image=imagename&otherparam=1&otherparam2=2" width="300" height="200" /> 
```

**编辑**

如果你真的不想使用 GET，你可能会使用 jQuery 和 AJAX 来加载图像。然后，您可以向服务器创建一个 POST 请求，该请求将返回一个 base64 编码的图像，然后将其插入页面中。这意味着`<img>`标签实际上不会包含图像 URL，而是包含原始 base64 编码数据。不是超级干净，但有些模糊。

要使用 jQuery 和 AJAX 加载图像，请查看此响应：[https ://stackoverflow.com/a/12714338/747811](https://stackoverflow.com/a/12714338/747811)

如果您采用这种方法，我建议将图像存储为 base64 编码文件，而不是在每次提供图像时计算它们的编码。要对图像进行编码，您可以使用以下内容：[http ://www.freeformatter.com/base64-encoder.html](http://www.freeformatter.com/base64-encoder.html)

要在 PHP 中对它们进行编码，请使用`base64_encode()`： http: [//php.net/manual/en/function.base64-encode.php](http://php.net/manual/en/function.base64-encode.php)

# php - 想制作下载之类的链接吗？id=**

> ID：15177942
> 
> 赞同：-3
> 
> 时间：2013-03-02T18:34:11.667
> 
> 标签：php

我想在php中制作下载链接。

例如，如果我的目录中有 2 个文件，那么如何制作下载链接，例如 download.php?id=1 或 2 或其他任何东西。

那么 download.php 文件中的代码是什么。

请有人告诉我代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:39:02.850

利用`$_GET`

例子：

```
<a href="download?id=1">link</a>

<?php

$id=$_GET['id'];

if(is_numeric($id)){
$filename = 'file.pdf'; // of course find the exact filename....        
header( 'Pragma: public' ); // required
header( 'Expires: 0' );
header( 'Cache-Control: must-revalidate, post-check=0, pre-check=0' );
header( 'Cache-Control: private', false ); // required for certain browsers 
header( 'Content-Type: application/octet-stream' );

header( 'Content-Disposition: attachment; filename="'. basename($filename) . '";' );
header( 'Content-Transfer-Encoding: binary' );
header( 'Content-Length: ' . filesize( $filename ) );

readfile( $filename );

exit;

}

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:39:28.180

我用过这样的东西：

```
$fileId = $_GET['id'];

// do something with that id and return the file path / name

$path = ""; //server path / file name    
header("Content-Type: application/octet-stream");    //    
header("Content-Length: " . filesize($path));        
header('Content-Disposition: attachment; filename='.$path);    
readfile($path); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T18:40:14.183

### 数据库 ID

为了能够使用 链接下载`?id=xx`，您需要将数据库 ID 和文件名关联起来的数据库表。

### 解决 $_GET

在 php 中，您可以通过以下方式获取用户发送的 ID：

```
$id = (int)$_GET["id"];
/*ADD YOUR GET FILE NAME CODE HERE*/
header("Content-Disposition: attachment; filename=$filename");
header("Content-Size: ".filesize($filename));
readfile($filename);   //Send file to user 
```

# android - Android 颜色格式（RGB565、ARGB8888）

> ID：15177943
> 
> 赞同：6
> 
> 时间：2013-03-02T18:34:19.717
> 
> 标签：android, bitmap, rgb, bitmapfactory, argb

```
 getHolder().setFormat(PixelFormat.RGBA_888);        

    Options options = new BitmapFactory.Options();       
    options.inDither=true;                               
    options.inScaled = true; 
    options.inPreferredConfig = Bitmap.Config.ARGB_8888; 
    options.inPurgeable=true; 
```

（使用上述选项创建的位图）

使用上面的代码时，我得到以下结果.........

*   我的平板电脑上没有色带
*   测试手机上出现明显的色带（三星 Galaxy Ace）

    ```
    getHolder().setFormat(PixelFormat.RGBA_888);        

    Options options = new BitmapFactory.Options();       
    options.inDither=true;                               
    options.inScaled = true; 
    options.inPreferredConfig = Bitmap.Config.ARGB_565; 
    options.inPurgeable=true; 
    ```

*   我的平板电脑上没有色带

*   Galaxy Ace 上有明显的色带
*   结果与上述相同

    ```
    getHolder().setFormat(PixelFormat.RGB_565);     

    Options options = new BitmapFactory.Options();       
    options.inDither=true;                               
    options.inScaled = true; 
    options.inPreferredConfig = Bitmap.Config.RGB_565; 
    options.inPurgeable=true; 
    ```

*   我的平板电脑上的色带

*   SG Ace 上的色带

    ```
    getHolder().setFormat(PixelFormat.RGB_565);     

    Options options = new BitmapFactory.Options();       
    options.inDither=true;                               
    options.inScaled = true; 
    options.inPreferredConfig = Bitmap.Config.ARGB_8888; 
    options.inPurgeable=true; 
    ```

*   我的平板电脑上的色带

*   SG Ace 上的色带

所以，总而言之，只有 PixelFormat.xxxx 部分似乎有任何区别。我的理解是，这是设置支架颜色格式。这将影响绘制的所有内容。（即，一切都将采用这种格式）。

有人可以解释下一行的目的是什么吗？

options.inPreferredConfig = Bitmap.Config.xxxxxxx

这似乎对已绘制的位图没有任何影响。

性能是最重要的，所以我可能必须更改我的原始 png 文件，使它们没有渐变，（即，将它们绘制为 RGB565 - 这是可取的还是我应该坚持使用 8888？）还是应该抖动解决？（因为如您所见，我启用了它，但似乎没有帮助）。

知道为什么 Ace 上总是有条带吗？会不会是硬件限制？

谢谢这一切都非常令人困惑。

（PS 我已经阅读了官方指南，在向 SO 发布问题以及查看其他相关的 SO 问题之前，我总是会查看该指南，但是官方指南（通常是这种情况）并没有明确这一点我和我无法通过其他问题找到答案，所以如果它已经在这里道歉）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T18:45:36.893

565 格式是默认的，因为它可以更快地绘制并且需要更少的处理能力。至于你的 SG Ace，我相信不久前只有某些版本的 Android 支持 8888 色。

为了让我的应用程序背景之一不带，我必须执行以下操作：

1 - 将背景添加到可绘制文件夹

2 - 使用以下内容创建 background_dithered.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<bitmap xmlns:android="http://schemas.android.com/apk/res/android"
    android:antialias="true"
    android:dither="true"
    android:src="@drawable/background" /> 
```

3 - 在活动代码中：

```
@Override
public void onAttachedToWindow() {
        super.onAttachedToWindow();

        getWindow().setFormat(PixelFormat.RGBA_8888);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T18:45:50.653

> 有人可以解释下一行的目的是什么吗？
> 
> > `options.inPreferredConfig = Bitmap.Config.xxxxxxx`
> 
> 这似乎对已绘制的位图没有任何影响。

不同`Bitmap`的配置会有不同的内存占用。`RGB_565`是 16 位颜色格式。`ARGB_8888`是 32 位格式。

无论`getHolder().setFormat();`您选择了哪种配置，或者它是如何绘制的，位图（在内存中）在格式上`ARGB_8888`都会比位图大得多。`RGB_565`

# powershell - Powershell - Powershell 中的 DHCP 范围

> ID：15177949
> 
> 赞同：1
> 
> 时间：2013-03-02T18:34:49.363
> 
> 标签：powershell, powershell-3.0

编写脚本以完全自动化将新的 2012 盒子部署为 DC - 配置 Windows 更新、安装 AD、创建林、配置 DNS 区域、激活 DHCP 范围等。

我目前正在研究 DHCP 部分，并且有以下内容：

```
Add-WindowsFeature  -IncludeManagementTools dhcp
netsh dhcp add securitygroups
Restart-service dhcpserver
Add-DhcpServerInDC  $Env:COMPUTERNAME  $ip

Add-DhcpServerv4Scope -Name "Client LAN" -StartRange $ipRangeStart -EndRange $ipRangeEnd -      SubnetMask $subnet 
```

这很好，但我还想配置 DNS 服务器和路由器（默认网关），但我找不到太多关于如何做到这一点的信息！

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:15:31.087

检查 set-dhcpserverv4optiondefinition 和 set-dhcpserverv4optionvalue cmdlet。

[http://technet.microsoft.com/en-us/library/jj590710.aspx](http://technet.microsoft.com/en-us/library/jj590710.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T01:11:19.060

这是我的小型测试实验室的设置方式：

```
Install-WindowsFeature DHCP -IncludeManagementTools
Import-Module DHCPServer -Verbose:$False
Add-DhcpServerV4Scope -Name "ReskitNet0" `
                      -StartRange 10.0.0.100 `
                      -EndRange 10.0.0.219 `
                      -SubnetMask 255.255.255.0
Set-DhcpServerV4OptionValue -DnsDomain Reskit.Org `
                            -DnsServer 10.0.0.10                     
Add-DhcpServerInDC -DnsName Dc1.reskit.org 
```

# facebook - 是否有用于将图像发布到 Facebook 页面的 Wordpress 插件？

> ID：15177959
> 
> 赞同：0
> 
> 时间：2013-03-02T18:36:09.073
> 
> 标签：facebook, wordpress

我正在寻找一个 Wordpress 插件来将我的 wordpress 帖子中的图像上传到 Facebook 页面。注意：我只想上传图片。不是帖子和摘录等。

有一个软件 PostPlanner 可以手动完成。 [http://www.youtube.com/watch?feature=player_embedded&v=DcNdppDW_ew](http://www.youtube.com/watch?feature=player_embedded&v=DcNdppDW_ew)

但我想从 Wordpress 插件自动完成。我不是 PHP 专家。我只需要插件的名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T23:48:45.373

[Facebook Page Publish](http://wordpress.org/support/view/plugin-reviews/facebook-page-publish)的作者声称这是可能的。但我不确定这个插件是否会像那样开箱即用。如果没有，他提供[了有关如何修改他的插件以完成此操作的具体说明](http://wordpress.org/support/topic/pictures-from-excerpt-in-fb-page-post?replies=11)，并且看起来相对简单。

该插件没有得到好评，但这对于那些不知道如何配置的人来说是正常的——而且 WordPress 有很多这样的人。祝你好运。

# c# - 如何进行超过 3 个类的更新

> ID：15177961
> 
> 赞同：0
> 
> 时间：2013-03-02T18:36:29.603
> 
> 标签：c#, events, delegates

通常我们通过使用事件或委托`ClassB`来更新一些数据（所以超过 2 个类）。`ClassA`

我需要做的是`ClassA`从`ClassC`（`ClassC`通过`ClassA`和打开`ClassB`）更新。所以不能直接访问`ClassC`to `ClassA`。

这怎么可能，这样我就不需要做任何额外的代码`ClassB`？

例子：

```
class ClassA
{
    private void OpenClassB() 
    {
        ClassB b = new ClassB();
        b.WorkOnB();
    }

    public void UpdatingFromClassC()
    {
        // I have to call this method from ClassC (from method WorkOnC)
    }
}

class ClassB
{
    public void WorkOnB()
    {
        //...
        //and:
        OpenClassC();
    }

    private void OpenClassC()
    {
        ClassC c  = new ClassC();
        c.WorkOnC();
    }
}

class ClassC
{
    public void WorkOnC()
    {
        //call UpdatingFromClassC() method on form1 from here!
    }
} 
```

我不喜欢传递 Form1 的引用。我必须使用事件或委托——最好的选择。

## ---

让我更清楚。我做窗体。这是一个带有 2 个类的示例：

```
 public partial class Form1 : Form
 {
    Class1 c1;
    public Form1()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        if (c1 == null)
        {
            c1 = new Class1();
            c1.OnDoWork += new Action(From_Class1_OnDoWork);
            c1.DoSomeWork();
        }
    }

    private void From_Class1_OnDoWork()
    {
        //put your code into here for refreshing
        MessageBox.Show("Form1 is being refreshed!");
    }
}

class Class1
{
    public event Action OnDoWork;
    public Class1()
    {
        //constructor 
    }

    public void DoSomeWork()
    {
        System.Windows.Forms.MessageBox.Show("Do some work in Class 1");
        if (OnDoWork != null)
        {
            OnDoWork();
        }
    }
} 
```

现在我想创建另一个表单 (Form2)，它将从 Class1 打开。我必须从 Form2 唤醒 Form1 上的方法（或将数据传递给它）。

我希望你明白了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:46:45.550

如果不向 引入代码，这是不可能的，因为根据您的设计，和`ClassB`的实例之间没有直接通信。既然是中介，它就必须传达一些他们可以交流的机制。`ClassA``ClassC``ClassB`

最简单的解决方案就是将对相关`ClassA`实例的引用传递给`ClassC`via `ClassB`。如果这在您看来太像不必要的耦合，那么是的，您应该使用指定要采取的操作的委托（并附上对 的引用`ClassA`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:52:41.130

感觉 C 和 B 的构造函数都应该接收**Action**委托参数，在这种情况下是**UpdatingFromClassC()**的委托。确切的机制不一定是这样，但从给出的描述来看，似乎很可能适合这种情况。

# android - 如何检查sqlite db中字段的数据类型是否更改

> ID：15177967
> 
> 赞同：2
> 
> 时间：2013-03-02T18:37:24.273
> 
> 标签：android, android-sqlite

首先，我创建了一个数据库表，`Android SQLite DB`如下所示：

```
private static final String CONTENT_DB_CREATE = "CREATE TABLE "
        + CONTENT_DB_NAME + "( " + CONTENT_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + 
        CONTENT_TITLE   + " TEXT, " +
        CONTENT_FULLTEXT    + " TEXT , " +
        CONTENT_STATE   + " TEXT , " +
        CONTENT_NEW + " TEXT, " +
        CONTENT_HEADER  + " TEXT , " +
        CONTENT_COLOR   + " TEXT , " +
        CONTENT_NEXT    + " TEXT , " +
        CONTENT_PREVIOUS + " TEXT );"; 
```

然后我改为：

```
private static final String CONTENT_DB_CREATE = "CREATE TABLE "
        + CONTENT_DB_NAME + "( " + CONTENT_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, " + 
        CONTENT_TITLE   + " TEXT, " +
        CONTENT_FULLTEXT    + " TEXT , " +
        CONTENT_STATE   + " INTEGER , " +
        CONTENT_NEW + " INTEGER, " +
        CONTENT_HEADER  + " TEXT , " +
        CONTENT_COLOR   + " INTEGER , " +
        CONTENT_NEXT    + " TEXT , " +
        CONTENT_PREVIOUS + " TEXT );"; 
```

现在如何确定数据类型已更改！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T18:45:28.517

您可以使用此查询来获取定义表的当前 SQL 语句：

```
"SELECT sql FROM sqlite_master " +
    " WHERE type = 'table' AND tbl_name = '" + CONTENT_DB_NAME + "'" 
```

`sqlite_master`是一个隐藏的表，包含整个数据库的模式。

了解列类型可能无关紧要，因为 SQLite 使用["type affinity"](https://www.sqlite.org/datatype3.html#affinity)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:46:16.410

有一些实用程序可以查看您的数据库。您可以使用文件资源管理器获取
数据库特定应用程序的数据库位于 /data/data/[packagename]/databases

包名是您在清单中定义的包，例如 /data/data/org.vimtips.supacount/databases/counts.db。

您可以使用 adb shell 查看它并输入 sqlite3 /data/data/org.vimtips.supacount/databases/counts.db

或者你可以从设备中提取它以使用第三方实用程序查看它，使用 adb pull /data/data/org.vimtips.supacount/databases/counts.db 之类的命令

# ios - UITableView 不显示

> ID：15177968
> 
> 赞同：1
> 
> 时间：2013-03-02T18:37:25.037
> 
> 标签：ios, objective-c

有人可以告诉我在代码中缺少什么，因为它没有在表格视图中显示任何内容。此外，我已经在代码中设置了委托和数据源，以及 UITableView 视图出口。

。H

```
@interface FoodViewController :  UIViewController<UITableViewDataSource,UITableViewDelegate>
{
NSMutableArray *objects;
}
@property (strong, nonatomic) IBOutlet UITableView *tablewviewFood;
@property (strong, nonatomic)  NSMutableArray *objects;
@end 
```

.m

```
- (void)viewDidLoad
{
[super viewDidLoad];
objects =[[NSMutableArray alloc] initWithObjects:@"Employee Services",@"Human           Resources",@"Organization",@"Policies",@"Reference",nil];
 _tablewviewFood.dataSource = self;
  _tablewviewFood.delegate = self;

}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
return 1;
 }

 - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
return [_objects count];

}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath    *)indexPath {

static NSString *CellIdentifier = @"Celler";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

}

// Configure the cell...
cell.textLabel.text = [_objects objectAtIndex:indexPath.row];

return cell; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:48:28.457

主要问题是`viewDidLoad`设置`objects`但`numberOfRowsInSection`处理`_objects`.

如果没有看到您的 .h 文件以及所有属性和 ivars，我不得不猜测您声明了一个名为的属性`objects`以及一个名为 的 ivar `objects`。但是您使用的是隐式或显式`@synthesize objects = _objects`.

这导致有两个 ivars`objects`和`_objects`.

声明属性，但同时删除 ivar 和`@synthesize`. 然后在代码中总是使用`self.objects`.

**更新**：是的，根据新发布的代码，我是正确的。

# javascript - 使用 jQuery 1.8.3 时 Ajax 响应未调用成功：function()

> ID：15177972
> 
> 赞同：0
> 
> 时间：2013-03-02T18:37:45.593
> 
> 标签：javascript, jquery, ajax

使用 jQuery 1.8.3 时未调用 Ajax 响应`success:function()`，但代码与 jQuery 1.4.2 完美配合。

这里的代码：

```
<script type="text/javascript">
$(document).ready(function(){
    $("#usn").on('keyup',function() {
        var dat=$("#usn").val();
        if($.trim(dat).length<10){
            $("#result").html("");
            $("#info").show();
        } else if($.trim(dat).length==10) {    
            txt=$("#usn").val();
            txt=txt.toUpperCase();
            var exp = /^[1-9][a-zA-Z][a-zA-Z][0-9][0-9][a-zA-Z][a-zA-Z][0-9][0-9][0-9]$/;
            if(exp.test(txt)){
                var resultType =$("input[name='resultType']:checked").val();
                $("#result").html("<img src=\"./result/loader.gif\"/><br/>Loading...");     
                $.ajax({
                    type: "GET",
                    url: "result/result_html.php?usn="+txt+"&resultType="+resultType,
                    dataType:"JSON",
                    success:function(result){
                        $("#info").hide();
                        $("#result").html(result);              
                        $("#usn").attr("placeholder", "USN"); 
                    }
                });
            } else {
                $("#result").html("Please enter a valid USN.");    
            }
        }
    });
});
</script> 
```

控制台没有显示任何错误。我可以在控制台中看到 Ajax 请求已成功完成。我可以在我的脚本控制台中看到预期的 Ajax 响应。

可能是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T19:05:52.957

在您的`$.ajax()`通话中，`dataType`是 JSON。您在评论中说响应是 HTML。只需将其更改`dataType`为“html”即可解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:03:00.763

作为您发送的响应`html`......数据类型应该是`html`在你的情况下是`json`......更正应该有效

```
 $.ajax({
            type: "GET",
            url: "result/result_html.php?usn="+txt+"&resultType="+resultType,
            dataType:"html",  //<-- here
            success:function(result){
                    $("#info").hide();
                    $("#result").html(result);              
                    $("#usn").attr("placeholder", "USN"); 
                }
        })..... 
```

# php - php preg_replace 多行重复字符串

> ID：15177974
> 
> 赞同：0
> 
> 时间：2013-03-02T18:37:53.353
> 
> 标签：php, preg-replace, duplicate-removal

我有以下文件示例：

苹果，
樱桃，，
（去除）
梨，，
（去除）
葡萄，
西瓜

我使用了以下表达式

```
preg_replace('/,+/', ',', $n); 
```

从[这个](https://stackoverflow.com/a/10342441/1880254)答案。

这工作正常，但仅当文件位于一行时：

```
apple, cherry,, pear,,... 
```

如何扩展表达式以删除多行上的多余重复项，以便文件读取：

苹果、
樱桃、
梨、
葡萄、
西瓜

这是代码：

`foreach ($lines as $line_num => $line) {
if ($line[0] === '.') { $compare_line = $line; $compare_line = preg_replace('/,+/', ',', $compare_line); echo $compare_line; } }`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:42:47.387

我的猜测是您正在做一些事情来拆分行，然后仅将正则表达式应用于第一行。尝试这样做：

```
file_put_contents("newfile.txt",preg_replace("/,+/", ",", file_get_contents("oldfile.txt"))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T19:04:57.490

`/s`您可以通过在表达式末尾添加标志来使 preg_replace 将所有行作为一行处理。

```
preg_replace('/,+/s', ',', $n); 
```

# excel - excel复制公式与几个不同的工作表

> ID：15177975
> 
> 赞同：1
> 
> 时间：2013-03-02T18:38:05.023
> 
> 标签：excel, copy, formula

我有不同的床单。名为一月。5、6、7、8 等等。

*1 月 5 日 SHEET1*：

```
 A1            B1      C1          D1
beginning balance + debit - credit = ending balance 
```

*在 1 月 6 日 SHEET2*：我想要 1 月 5 日的期末余额的期初余额。

*在 1 月 7 日 SHEET3*：我想要 1 月 6 日的期末余额的期初余额。

等等。

当我复制上一张表时，我该怎么做才能让我的单元格复制上一张表的期末余额金额一起复制公式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:13:43.640

将此公式放入A1。

```
=INDIRECT("'"&TEXT(DATEVALUE(RIGHT(CELL("filename",A1),LEN(CELL("filename",A1))-FIND("]",CELL("filename",A1),1)))-1,"MMMM d")&"'!D1") 
```

显然，您必须输入第一张纸/日期的 A1，因为我们没有可参考的内容。

“文件名”不适用于从未保存过的新工作簿。

```
CELL("filename",A1) 
```

尽管有名称，但它会返回工作簿和工作表名称。围绕它的功能是隔离到工作表名称。

```
DATEVALUE 
```

尝试将您的工作表名称（一个日期）转换为 Excel 的内部日期表示。

```
TEXT 
```

在确定前一天后，将日期转换回与您的工作表名称一致的日期格式`-1`。

```
INDIRECT 
```

将我们刚刚形成的文本评估为 Excel 公式。

只需询问您是否需要更多详细信息。您可以尝试“评估公式”按钮逐步浏览公式。

# c# - 如何在串口上获取 tcpclient 的输出

> ID：15177980
> 
> 赞同：0
> 
> 时间：2013-03-02T18:38:37.327
> 
> 标签：c#, tcpclient

我正在尝试从无法更改的 tcpclient 应用程序中获取输出。我知道它正在运行，因为另一个应用程序可以连接到它，但它是用 VB6 编写的，我没有代码。

这是我到目前为止所拥有的：

```
 public static void Main()
  {    
    try
    {
      // Set the TcpListener on port 13000.
      Int32 port = 5107;
      IPAddress localAddr = IPAddress.Parse("127.0.0.1");

      // TcpListener server = new TcpListener(port);
      TcpListener server = new TcpListener(localAddr, port);

      // Start listening for client requests.
      server.Start();

      // Buffer for reading data
      Byte[] bytes = new Byte[256];
      String data = null;

      // Enter the listening loop.
      while(true) 
      {
        Log("Waiting for a connection... ");

        // Perform a blocking call to accept requests.
        // You could also user server.AcceptSocket() here.
        TcpClient client = server.AcceptTcpClient();            
        Log("Connected!");

        data = null;

        // Get a stream object for reading and writing
        NetworkStream stream = client.GetStream();

        int i;

        // Loop to receive all the data sent by the client.
        while((i = stream.Read(bytes, 0, bytes.Length))!=0) 
        {   
          // Translate data bytes to a ASCII string.
          data = System.Text.Encoding.ASCII.GetString(bytes, 0, i);
          Log(String.Format("Received: {0}", data));

          // Process the data sent by the client.
          data = data.ToUpper();

          byte[] msg = System.Text.Encoding.ASCII.GetBytes(data);

          // Send back a response.
          stream.Write(msg, 0, msg.Length);
          Log(String.Format("Sent: {0}", data));            
        }

        // Shutdown and end connection
        client.Close();
      }

    }
    catch(SocketException e)
    {
      Log("SocketException: " + e.Message);
    }

  } 
```

**UPDATE HAD WRONG LINE HERE** 问题是，它停在`TcpClient client = server.AcceptTcpClient();`那里，从那里什么也不做。

另一个应用程序正在运行，但它没有连接（？）我猜。我以前没有像这样使用过 tcp，所以我不确定我在做什么。

我很肯定端口也是正确的。

如果没有连接，我如何从客户端获取输出？

**======= 编辑 =======**

这是我试图从中获取信息的应用程序的代码：

```
 Private Sub SendToPPS(ByVal GPS_Message As String)
    If mbDebug_PPSGS Then
      LogToFile("Starting Sub SendToPPS")
    End If
    Dim CloseSocket As Boolean
    LogToFile("Starting SendToPPS")

    If PPSIsRunning() Then
      LogToFile("PPSIsRunning")
      CloseSocket = False
      If mbDebug_PPSGS Then
        LogToFile("SendToPPS() PPS is Running.  Sending: " & GPS_Message)
      End If
      ' Don't try to send to PPS if PPS is not running

      Try
        ' Create a TcpClient.
        ' Note, for this client to work you need to have a TcpServer 
        ' connected to the same address as specified by the server, port
        ' combination.
        If SocketClient Is Nothing Then
          ' The socket is not open yet.  Open it now. 
          Dim port As Int32 = 5106
          SocketClient = New TcpClient("localhost", port)
        End If

        If SocketClient2 Is Nothing Then
          ' The socket is not open yet.  Open it now. 
          Dim port As Int32 = 5107
          SocketClient2 = New TcpClient("localhost", port)
        End If

        ' Translate the passed message into ASCII and store it as a Byte array.
        Dim data As [Byte]() = System.Text.Encoding.ASCII.GetBytes(GPS_Message)

        ' Get a client stream for reading and writing.
        Dim stream As NetworkStream = SocketClient.GetStream()
        Dim stream2 As NetworkStream = SocketClient2.GetStream()

        ' Send the message to the connected TcpServer. 
        stream.Write(data, 0, data.Length)
        stream2.Write(data, 0, data.Length)

      Catch err As ArgumentNullException
        LogToFile("SendToPPS() ArgumentNullException: " & err.ToString)
        CloseSocket = True
      Catch err As SocketException
        LogToFile("SendToPPS() SocketException: " & err.ToString)
        CloseSocket = True
      End Try
    Else
      CloseSocket = True
      LogToFile("SendToPPS() PPS is Not Running.")
      ' PPS is not running
      ' Make sure Socket is closed
    End If

    If CloseSocket Then
      If Not SocketClient Is Nothing Then
        Try
          SocketClient.Close()
        Catch ex As Exception
          LogToFile("SendToPPS() Closing Socket Exception: " & ex.ToString)
        End Try

        SocketClient = Nothing
      End If

    End If

    If mbDebug_PPSGS Then
      LogToFile("SendToPPS() Ending Sub SendToPPS")
    End If

  End Sub 
```

**======= 编辑#2 =======**

这两个应用程序都在同一台计算机上运行，​​这就是我使用 127.0.0.1 的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:46:39.203

感谢您的澄清，这很有帮助。

在高层次上，您的代码看起来不错。您可能陷入了代码的“while(true)”部分，而不是“server.Start();” 这与客户端未连接是一致的。

我建议将调试器附加到连接的两侧。既然你有源代码，我会假设你有符号并且可以获得调试版本。[将其与NetMon](http://www.microsoft.com/en-us/download/details.aspx?id=4865)之类的网络监视器结合使用，您应该能够找出哪里出了问题。

# android - 返回主要活动

> ID：15177985
> 
> 赞同：0
> 
> 时间：2013-03-02T18:38:57.753
> 
> 标签：android, android-activity, return

我的应用程序有三个活动。主要*活动*、*玩游戏*活动和*游戏结束*活动。按下按钮后，主活动开始玩游戏活动：

```
Intent myIntent = new Intent(view.getContext(), PlayGameActivity.class);
startActivity(myIntent); 
```

在 play game 活动中，当游戏结束时，我以同样的方式开始游戏结束活动：

```
Intent myIntent = new Intent(view.getContext(), GameOver.class);
startActivity(myIntent); 
```

当用户单击硬件*后退*按钮时，在*游戏结束*活动中，我希望它返回到主要活动（而不是当前正在发生的玩游戏活动）。

 *我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:46:57.923

在您的清单上添加

```
android:noHistory="true" 
```

到您的 PlayGameActivity

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T18:43:18.513

```
 @Override
public void onBackPressed() {
    Intent intent = new Intent(GameActivity.this,MainActivity.class);
             startActivity(intent);
           // finish(); // un-comment <--- this to close the previous activity if you don't want to use it anymore.
} 
```

这将处理后退按钮。只需将其添加到您的游戏活动类中即可。如果它是您所寻求的，请务必接受答案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-02T18:53:22.407

正如@Hoan Nguyen 所说。您可以`android:noHistory="true"`在**AndroidManifest.xml**文件中添加游戏活动。

**或者您可以在启动GameOver** Activity后完成您的游戏活动。并且代码应该是这样的：

```
///on Game Over
Intent intent = new Intent(GameActivity.this, GameOverActivity.class);
startActivity(intent);
finish(); 
```

这些方法可以让您回到**MainAcitivty**的原始实例，而不是使用新实例。*

# java - 字符串连接真的那么慢吗？

> ID：15177987
> 
> 赞同：20
> 
> 时间：2013-03-02T18:38:58.827
> 
> 标签：java, performance-testing, string-concatenation

我目前正在研究 String concat 选项以及它们对整体性能的影响。我的测试用例产生的结果让我大吃一惊，我不确定我是否忽略了某些东西。

这是交易：`"something"+"somethingElse"`在java中执行将（在编译时）`StringBuilder`每次完成时都会创建一个新的。

对于我的测试用例，我正在从我的 HDD 加载一个包含**1661 行示例数据**的文件（经典的“Lorem Ipsum”）。这个问题**不是关于 I/O 性能**，而是关于不同字符串 concat 方法的性能。

```
public class InefficientStringConcat {

    public static void main(String[] agrs) throws Exception{
        // Get a file with example data:

        System.out.println("Starting benchmark");
        // Read an measure:
        for (int i = 0; i < 10; i++){
            BufferedReader in = new BufferedReader(
                    new InputStreamReader(new FileInputStream(new File("data.txt")))
            );

            long start = System.currentTimeMillis();
            // Un-comment method to test:
            //inefficientRead(in);
            //betterRead(in);
            long end = System.currentTimeMillis();
            System.out.println("Took "+(end-start)+"ms");

            in.close();
        }

    }

    public static String betterRead(BufferedReader in) throws IOException{
        StringBuilder b = new StringBuilder();
        String line;
        while ((line = in.readLine()) != null){
            b.append(line);
        }
        return b.toString();
    }

    public static String inefficientRead(BufferedReader in) throws IOException {
        String everything = "", line;
        while ((line = in.readLine()) != null){
            everything += line;
        }
        return everything;
    }
} 
```

如您所见，两个测试的设置相同。结果如下：

使用**`inefficientRead()`- 方法**：

```
Starting benchmark
#1 Took 658ms
#2 Took 590ms
#3 Took 569ms
#4 Took 567ms
#5 Took 562ms
#6 Took 570ms
#7 Took 563ms
#8 Took 568ms
#9 Took 560ms
#10 Took 568ms 
```

使用**`betterRead()`-方法**

```
Starting benchmark
#1 Took 42ms
#2 Took 10ms
#3 Took 5ms
#4 Took 7ms
#5 Took 16ms
#6 Took 3ms
#7 Took 4ms
#8 Took 5ms
#9 Took 5ms
#10 Took 13ms 
```

我正在运行**没有额外参数**的测试 -`java`命令。我正在运行[2009 年初的 MacMini3,1](http://en.wikipedia.org/wiki/Mac_Mini#Specifications_2)和 Sun JDK 7：

```
[luke@BlackBox ~]$ java -version
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) Client VM (build 23.5-b02, mixed mode) 
```

这让我觉得有很大的不同。我在衡量这个时做错了什么，或者这应该发生吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-02T18:42:19.660

> 我在衡量这个时做错了什么，或者这应该发生吗？

它应该发生。使用重复的字符串连接构造一个长字符串是一种已知的性能反模式：*每个*连接都必须创建一个新字符串，其中包含原始字符串的*副本*以及附加字符串的*副本。*你最终会得到 O(N ² ) 的性能。当您使用 时`StringBuilder`，大多数时候您*只是*将附加字符串复制到缓冲区中。有时缓冲区需要用完空间并需要扩展（通过将现有数据复制到新缓冲区中），但这并不经常发生（由于缓冲区扩展策略）。

有关详细信息，请参阅我[关于字符串连接](http://www.yoda.arachsys.com/java/strings.html)的文章 - 这是一篇非常古老的文章，所以早于`StringBuilder`，但基本原理没有改变。（基本上`StringBuilder`就像`StringBuffer`，但没有同步。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-02T18:42:05.220

这正是应该发生的事情。 `betterRead`需要线性时间；`inefficientRead`需要二次时间。

# php - 多个选择 POST 问题

> ID：15177993
> 
> 赞同：1
> 
> 时间：2013-03-02T18:39:30.933
> 
> 标签：php, post

# 概述

我目前在使用 POST 数据的 PHP 中遇到问题。我有两个多选框（一个在屏幕左侧，另一个在右侧）。

然后，我使用数据库中的元素填充左侧的选项元素，并使用数据库中的数据填充右侧的选项。但是，当我打印 POST 数据时，我放入右侧多选框中的元素没有发布（如预期的那样）。

## 编码

```
 <form method="post" action="http://">
        <div class="left">
          <label for="left">Attributes to select:</label>
          <select size="5" name="allAtts" id="toSelect" multiple=""> 
            <option value="jay">jay</option>
            <option value="bill">bill</option>
          </select>
          <p><a href="#" class="btn add">Add</a></p>
        </div>
        <div class="right">
          <label for="right">Attributes to store:</label>
          <select size="5" id="selectedAtts" name="selectedAtts[]" multiple="">
            <option value="bob">bob</option>
            <option value="jim">jim</option>
            <option value="frank">frank</option>
          </select>
          <p><a href="#" class="btn remove">Remove</a></p>
        </div>
        <input type="submit" name="submit" value="Visualise!">
      </form> 
```

## 我的问题

我希望将右侧多选框中的所有元素都 POSTED 以便我可以将它们存储到数据库中，这包括*默认*选项元素（那些由数据库放入的元素）。

### 进一步更新

注意：当我从左侧选择一个项目（使用我的按钮和 javascript）并将其移动到右侧时，会发布该特定数据（提交表单时）。我想要那个数据，还有右边多选的默认选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:29:25.897

如果您希望`selectedAtts`下拉列表中的每个选项都传递给`$_POST`数组，您需要实际选择它们。因此，将`selected`属性添加到每个选项。

```
 <select size="5" id="selectedAtts" name="selectedAtts[]" multiple="">
        <option selected value="bob">bob</option>
        <option selected value="jim">jim</option>
        <option selected value="frank">frank</option>
      </select> 
```

当然，没有什么（就目前的代码而言）可以阻止用户取消选择任何或所有选项......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T18:50:09.130

您可能希望将它们打印为隐藏输入，然后将其用于您的工作，而不是在发布的数据中使用正确的多选框。但请记住，如果您按照我建议的方式实施，高级用户可能会更改您的数据。

# c - 使用 strchr 和 strtol 在一行上读取可变数量的长整数

> ID：15177994
> 
> 赞同：1
> 
> 时间：2013-03-02T18:39:38.907
> 
> 标签：c, strtol, strchr

我的功能还没有完成，但我要做的是：

*   读入以空格分隔的一串数字。
*   从该字符串中提取数字。
*   将它们转换为长整数。
*   返回读入的数字个数。

    ```
    int input( int a, int b, long int *result_array )
    {
        int ele = 0;
        char buffer[200];
        char *start, *end;

        scanf("%[^\n]%*c", buffer );

        start = buffer;

        while( ( end = ( strchr( start, ' ' ) ) != NULL ) )
        {
            result_array = strtol( start, &end, 10 );
            ele += 1;
            start = end + 1;

        }

        return ele;
    } 
    ```

它似乎无法正常工作，我认为我使用 strchr 错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:06:33.393

`strtol()`返回：

> 成功时，该函数将转换后的整数作为 long int 值返回。如果无法执行有效转换，则返回零值 (0L)。

您应该将代码重新编写为：

```
end = buffer;
base = 10;
long int = li;
ele = 0;
while(li=strtol (end,&end, base)){
     ele += 1;
}
return ele; 
```

您不需要显式使用`strstr()`来定位下一个整数。`strtol()`足够聪明，每次转换后它都会将端点定位到下一个 int。

我写了一个运行代码可能对你有帮助：

```
#include <stdio.h>      /* printf */
#include <stdlib.h>     /* strtol */
int main (){
  char buffer[] = "2001 11 223   444   566";
  char * end;
  long int li;
  end =buffer;
  int base =10;
  int ele = 0;
  while(li=strtol (end, &end, base)){
     printf("%ld \n", li);
     ele += 1;
  }
  printf("\nNo of elements: %d", ele);
  return 0;
} 
```

它的输出：

```
2001 
11 
223 
444 
566 

No of elements: 5 
```

[链接到键盘](http://codepad.org/1LjLRSMn)

# linux - 用于查找文件的 Bash 脚本

> ID：15177996
> 
> 赞同：2
> 
> 时间：2013-03-02T18:39:57.733
> 
> 标签：linux, bash, filesystems

美好的一天，我找到了一种简单的方法来查找具有特定内容的文件，但我想创建一个 bash 脚本来更快地完成它，

脚本是：

```
#!/bin/bash
DIRECTORY=$(cd `dirname .` && pwd)
ARGUMENTS="'$@'"

echo find: $ARGUMENTS on $DIRECTORY
find $DIRECTORY -iname '*' | xargs grep $ARGUMENTS -sl 
```

所以如果我写：

```
$ script.sh text 
```

它应该在该目录中找到包含“文本”的文件

但是当我执行这个脚本时它总是失败，但是 echo 命令准确地显示了我所需要的，这个脚本有什么问题？

谢谢！

路易斯

参考资料：[http ://www.liamdelahunty.com/tips/linux_find_string_files.php](http://www.liamdelahunty.com/tips/linux_find_string_files.php)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T18:45:53.313

如果当前目录或搜索模式包含空格，则引用会在此脚本中中断。以下更简单，并解决了这两个问题：

```
find . -maxdepth 1 -type f -exec grep "$@" {} + 
```

通过正确引用`$@`，您甚至可以将选项传递给 grep，例如`-i`.

```
./script -i "some text" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T18:53:06.217

试试这个版本，有以下改动：

1.除非您打算运行多个 find/grep 来搜索多个模式，否则使用`$1`代替。`$@`

2.使用`find $DIR -type f`查找所有文件而不是`find $DIR -iname '*'`

`-exec`3.通过使用命令行选项避免管道`find`。

4.不要将命令行参数单引号到您的脚本中，这是您拥有的版本的主要问题。您的 grep 字符串已转义单引号`\'search_string\'`

```
#!/bin/bash
DIRECTORY=$(cd `dirname .` && pwd)
ARGUMENTS="$1"

echo find: $ARGUMENTS on $DIRECTORY
find $DIRECTORY . -type f -exec grep -sl "$ARGUMENTS"  {} \; 
```

提取所有命令行参数并将其传递给`grep`. 如果要搜索带空格的字符串，请在命令行中将字符串放在单引号内，如下所示：

```
/home/user/bin/test-find.sh 'i need to search this' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-02T18:49:18.200

为什么不只运行以下命令？：

```
grep -R text . 
```