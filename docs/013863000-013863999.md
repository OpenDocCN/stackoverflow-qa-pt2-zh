# StackOverflow 问答 13863000-13863999

# c# - 在 WPF/C# 下编译大图像源文件（可能的 Site of Origin 解决方案？）

> ID：13863011
> 
> 赞同：1
> 
> 时间：2012-12-13T15:24:38.053
> 
> 标签：c#, wpf, visual-studio-2010, resources, compilation

我正在使用 Visual Studio 2010 Express 下的 WPF 在 C# 中开发 Kinect 应用程序。该应用程序需要一个图像控件来在大约 700 个不同的源图像之间切换，总共大约 260 MB。我不认为它会太多，但是当我制作那 700 个图像资源文件时，当我尝试发布（或只是运行）应用程序时，构建失败，显然是由于内存不足（我有 8 GB 的 RAM ）。内容文件也是如此。不过，只要我从代码启动它并从指定文件夹读取图像，该应用程序就可以正常工作。

所以我一直在考虑Site of Origin 文件。我已将所有图像文件的构建操作设置为无并将复制到输出目录以始终复制并重建项目。但是，图像文件不会出现在已发布的应用程序中的任何位置。我尝试将输出路径设置为不同的文件夹，但似乎没有任何效果。

所以我的问题是，Site of Origin 文件是正确的方法吗？如果是，我做错了什么？此外，一旦我设法将它们与应用程序的其余部分一起发布，我将如何从代码中访问它们？（是的，我知道这是在颠倒实际过程——我只是原则上的意思。我在这方面找不到太多东西——基本上只是[这个](http://dotnet.learningtree.com/2011/12/28/dynamically-accessing-large-resource-files-in-xaml-at-runtime/)，但它适用于 Visual Basic。我想从 C# 访问它们，不是 XAML。）

或者，还有其他方法可以做到这一点吗？最初尝试使用资源文件时我做错了什么吗？

提前致谢！

# sql-server - 列溢出到另一个列-sql 服务器和 CSV 文件

> ID：13863015
> 
> 赞同：0
> 
> 时间：2012-12-13T15:24:42.453
> 
> 标签：sql-server, csv

我正在将 CSV 文件批量插入 SQL 服务器，但在检查结果后，我意识到 CSV 文件存在问题。CSV 文件中名字列的内容以逗号分隔，因此被移至下一列，从而导致多米诺骨牌效应。（例如，假设列名是名字、编号和地址。第一个 Name 列有一个名称叫詹姆斯，邦德。由于逗号，它被移动到数字逗号，因此数字列的假定数据也被移动到地址列。有没有人对我如何在 SQL 服务器中纠正这个问题有任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T05:48:52.503

嗨，在记事本中打开原始数据后，我和我的同事发现它有文本标识符，因此我基本上只是使用格式文件进行批量插入。谢谢大家的建议。

# c++ - 如何使用 Visual Studio 轻松缩进标题声明

> ID：13863019
> 
> 赞同：1
> 
> 时间：2012-12-13T15:24:51.597
> 
> 标签：c++, visual-studio-2010, indentation

我喜欢我的 c++ 成员变量和方法声明都缩进相同的数量，以便它们像这样排列：

```
class SnipformationScheduler : public ParagraphformationFinishedResponder
{
    int                                         mCurrentSnipIndex; 
    vector<ParagraphFormationAnimation>         mParagraphAnimations;
public:
    vector<string>                              mSnippetIDs;
    MovementController*                         mMovementController;

    SnipformationScheduler();
    virtual ~SnipformationScheduler(void);
    void                                        tick();
    void                                        paragraphAnimationFinished();
}; 
```

目前，我通过按 Tab 键来执行此操作，直到获得正确数量的缩进。当然有更简单的方法。有人知道它是什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T15:33:31.913

我不相信有更简单的方法。但是，请使用空格进行对齐。制表符，如果您完全使用它们（有些人将他们的编辑器设置为在按下制表符键时输入几个空格），应该仅用于缩进。

这背后的基本原理是，不同的人将标签设置为显示为不同数量的空格。如果我用...

*   所有空间，每个人总是在他们的编辑器中看到相同的东西。然而，他们无法控制缩进的宽度（这让我很恼火）。

*   所有选项卡，人们都可以设置缩进的宽度，但如果其他人使用的选项卡宽度与您不同，事情可能不会对齐。

*   用于缩进的制表符和用于对齐的空格，每个人都很高兴。一切总是排成一行，人们可以设置压痕的宽度。

# ios - 渐变的 CoreGraphics 性能

> ID：13863020
> 
> 赞同：0
> 
> 时间：2012-12-13T15:24:54.653
> 
> 标签：ios, ipad, core-animation, core-graphics

我在屏幕上有多个正在移动的形状。
每个形状都可以根据其位置而变化，并使用 CoreGraphics 填充渐变。

其性能非常糟糕 - iPad3 上约为 9fps。

有什么加快速度的技巧吗？有一个预渲染的位图并改变它的形状会有所帮助吗？

我正在重新计算形状（三角形）并重新绘制每个动作：

```
- (void) drawGradientShapeInRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGFloat start_x = self.frame.size.width / 2.0;
    CGFloat start_y = self.frame.size.height;

    CGFloat end_x = radius_ * cos(angleInRad_) + start_x;
    CGFloat end_y = MAX(radius_ * sin(angleInRad_) + start_y, self.bounds.size.height - constrainedHeight_);

    // Create Lines
    CGPoint startPt = CGPointMake(start_x, start_y);

    CGContextMoveToPoint(context, self.center.x, self.center.y);
    CGPoint addLines[] =
    {
        startPt,
        CGPointMake(end_x, end_y),
        CGPointMake(end_x, start_y),
        startPt
    };

    CGContextAddLines(context, addLines, sizeof(addLines)/sizeof(addLines[0]));

    // Setup Gradient
    CGColorSpaceRef rgb = CGColorSpaceCreateDeviceRGB();
    NSArray *colors = nil;
    if(start_x > end_x)
    {
        colors = [NSArray arrayWithObjects:
                  (id)[UIColor colorWithRed:0 green:0 blue:0 alpha:0].CGColor,
                  (id)[UIColor colorWithRed:0 green:0 blue:0 alpha:0.3f].CGColor,
                  nil];
    }
    else
    {
        colors = [NSArray arrayWithObjects:
                  (id)[UIColor colorWithRed:0 green:0 blue:0 alpha:0.3f].CGColor,
                  (id)[UIColor colorWithRed:0 green:0 blue:0 alpha:0].CGColor,
                  nil];
    }

    CGColorSpaceRef space = CGColorSpaceCreateDeviceRGB();
    CGGradientRef gradient = CGGradientCreateWithColors(space, (__bridge CFArrayRef)colors, NULL);
    CGColorSpaceRelease(space);
    CGColorSpaceRelease(rgb);

    CGPoint startGradientPt = CGPointMake((start_x < end_x) ? start_x : end_x, 0);
    CGPoint endGradientPt   = CGPointMake((start_x > end_x) ? start_x : end_x, 0);

    CGContextSaveGState(context);
    CGContextClip(context);
    CGContextDrawLinearGradient(context,
                                gradient,
                                startGradientPt,
                                endGradientPt,
                                0);
    CGGradientRelease(gradient);
    CGContextRestoreGState(context);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T05:56:04.340

最终创建了可以缩小和成形的 PNG。
帧速率立即跃升至 40fps - 问题解决了。

# java - Primefaces p：对话框中的谷歌图表

> ID：13863032
> 
> 赞同：0
> 
> 时间：2012-12-13T15:25:05.717
> 
> 标签：java, jsf, primefaces, google-visualization

基于此[博客条目](http://kevindoran1.blogspot.be/2012/02/using-google-charts-with-jsf.html)，我试图在 Primefaces 对话框中显示 Google 图表。

我的 xhtml 文件：

```
<html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://java.sun.com/jsf/html"  
      xmlns:f="http://java.sun.com/jsf/core"  
      xmlns:p="http://primefaces.org/ui" 
      xmlns:c="http://java.sun.com/jsp/jstl/core" 
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:gc="http://mycompany.com/custom">
    <h:head>
        <title>Test Web</title>
    </h:head>
    <h:body>
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <p:commandButton value="Load" actionListener="#{mainController.buildHistory}" update="@form :history" oncomplete="historyWidget.show();"/>
                </h:panelGrid>
                <gc:googleChart id="googleChart" divID="chart_div" model="#{mainController.chartModel}"/>
            </h:form>
            <p:dialog id="history" widgetVar="historyWidget">
                <div id="chart_div" style="width: 900px; height: 500px; border:2px solid black;" />
            </p:dialog>
        </h:body> 
```

我的支持豆：

```
@ManagedBean
@RequestScoped
public class MainController {

    private GoogleChartModel chartModel;

    public MainController() {

    }

    @PostConstruct
    public void postConstruct() {
        chartModel = new DefaultGoogleChartModel();
    }

    public void buildHistory() {
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        Date date = null;
        try {
            date = formatter.parse("2010-01-01 00:00:00");
            Row row = new Row(date, "10");
            chartModel.addRow(row);
            date = formatter.parse("2010-02-01 00:00:00");
            row = new Row(date, "20");
            chartModel.addRow(row);
            date = formatter.parse("2010-03-01 00:00:00");
            row = new Row(date, "30");
            chartModel.addRow(row);
            date = formatter.parse("2011-04-01 00:00:00");
            row = new Row(date, "40");
            chartModel.addRow(row);
            date = formatter.parse("2011-05-01 00:00:00");
            row = new Row(date, "50");
            chartModel.addRow(row);
        } catch (ParseException ex) {
            Logger.getLogger(MainController.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    public GoogleChartModel getChartModel() {
        return chartModel;
    }

} 
```

我的图表渲染器：

```
@FacesRenderer(componentFamily = "com.testweb.display",
rendererType = "googleChartRenderer")
public class ChartRenderer extends Renderer {

    @Override
    public void decode(FacesContext context, UIComponent component) {
        System.out.println("decode");
        super.decode(context, component);
    }

    protected FacesContext getFacesContext() {
        return FacesContext.getCurrentInstance();
    }

    @Override
    public void encodeBegin(FacesContext context, UIComponent component) throws IOException {
        super.encodeBegin(context, component);
    }

    @Override
    public void encodeEnd(FacesContext context, UIComponent component) throws IOException {
        UIGoogleChart chart = (UIGoogleChart) component;
        GoogleChartModel chartModel = (GoogleChartModel) chart.getAttributes().get("model");
        String divId = (String) chart.getAttributes().get("divID");
        ResponseWriter writer = context.getResponseWriter();
        StringBuilder sb = new StringBuilder();
        sb.append("<script type='text/javascript' src='http://www.google.com/jsapi'></script>");
        sb.append("<script type='text/javascript'>");
        sb.append("google.load('visualization', '1', {packages:['corechart']});");
        sb.append("</script>");
        sb.append("<script type='text/javascript'>");
        sb.append("function drawChart() {");
        sb.append("var data = new google.visualization.DataTable();");
        sb.append("data.addColumn('date', 'Date');");
        sb.append("data.addColumn('number', '');");
        if (chartModel.getRows() != null && !chartModel.getRows().isEmpty()) {
            sb.append("data.addRows([");
            for (Row row : chartModel.getRows()) {
                sb.append("[");
                sb.append(row.getDate());
                sb.append(",");
                sb.append(row.getValue());
                sb.append("],");
            }
            sb.append("]);");
        }
        sb.append("var chart = new google.visualization.LineChart(document.getElementById('");
        sb.append(divId);
        sb.append("')).draw(data, null);");
        sb.append("}");
        sb.append("google.setOnLoadCallback(drawChart);");
        sb.append("</script>");
//      System.out.println(sb.toString());
        writer.write(sb.toString());
    }
} 
```

使用上面的代码，当我按下按钮时，对话框出现但为空。该方法`buildHistory`在渲染器之前调用，但我的 chartModel 是空的，即如果我查看源代码，我的图表中没有添加任何行。但在这种特殊情况下，无论如何都应该显示一个空图表。

如果我添加`ajax="false"`到我的按钮，则对话框根本不会显示，但我的 chartModel 已填充，即在源代码中我看到我的图表代码，如果我将图表的代码复制粘贴到 HTML 文件中它可以工作...

另请注意，如果我不将图表放在对话框中，我会得到预期的结果：

```
<h:body>
        <h:form>
            <h:panelGrid columns="2" cellpadding="5">
                <p:commandButton value="Load" actionListener="#{mainController.buildHistory}" ajax="false" update="@form :history" oncomplete="historyWidget.show();"/>
            </h:panelGrid>
            <gc:googleChart id="googleChart" divID="chart_div" model="#{mainController.chartModel}"/>
            <div id="chart_div" style="width: 900px; height: 500px; border:2px solid black;" />
        </h:form>
    </h:body> 
```

我错过了什么吗？有人可以给我一个提示吗？

我正在运行 Glassfish 3.1.1、JSF 2.1、Primefaces 3.4、Mojarra 2.1.6

谢谢你的帮助 ！

# c++ - gSoap + HTTP 错误：400 错误请求：原因？

> ID：13863036
> 
> 赞同：3
> 
> 时间：2012-12-13T15:25:25.593
> 
> 标签：c++, web-services, gsoap, error-code

当我拨打soap_call__ *ns2* _HelloWorld(&soap,NULL,NULL,&req,&resp)之类的电话时出现错误

错误 400 错误：SOAP-ENV:Client [无子代码]“HTTP 错误：400 错误请求”详细信息：[无详细信息]

WSDL 在本地网络上的 Windows Server 2008 R2、IIS 上发布，我可以通过 192.168.xx/app/blabla.asmx?wsdl 导航它。

我想知道这个错误的原因，因为我认为 gSoap 应该可以很好地构建 xml，但这是我第一次使用它，我不知道。

问候，哈维。

# c# - 从 C# 应用程序获取连接到 Web 服务的 EndpointNotFoundException 和 WebException

> ID：13863039
> 
> 赞同：0
> 
> 时间：2012-12-13T15:25:42.683
> 
> 标签：c#, wcf, web-services

我正在尝试连接到我们的 Intranet 中托管的服务。但是，这样做时我收到了这个错误：

```
System.ServiceModel.EndpointNotFoundException: There was no endpoint listening at http://10.XXX.X.XXX:XXXX/servicename/services/SomeSearch.SomeSearchHttpSoap12Endpoint/ that could accept the message. This is often caused by an incorrect address or SOAP action. 
```

内部异常说：

```
 System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond http://10.XXX.X.XXX:XXXX 
```

这是我的配置文件：

```
<?xml version="1.0"?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="SomeSearchSoap11Binding" closeTimeout="00:01:00" openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384"/>
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None" realm=""/>
                        <message clientCredentialType="UserName" algorithmSuite="Default"/>
                    </security>
                </binding>
            </basicHttpBinding>
            <customBinding>
                <binding name="SomeSearchSoap12Binding" receiveTimeout="01:10:00">
                    <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16" messageVersion="Soap12" writeEncoding="utf-8" >
                        <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384" maxBytesPerRead="4096" maxNameTableCharCount="16384"/>
                    </textMessageEncoding>
                    <httpTransport manualAddressing="false" maxBufferPoolSize="524288" maxReceivedMessageSize="65536" allowCookies="false" authenticationScheme="Anonymous" bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard" keepAliveEnabled="true" maxBufferSize="65536" proxyAuthenticationScheme="Anonymous" realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false" useDefaultWebProxy="true"/>
                </binding>
            </customBinding>
        </bindings>
        <client>
            <endpoint address="http://10.XXX.X.XXX:XXXX/servicename/services/SomeSearch.SomeSearchHttpSoap11Endpoint/" binding="basicHttpBinding" bindingConfiguration="SomeSearchSoap11Binding" contract="SomeService.SomeSearchPortType" name="SomeSearchHttpSoap11Endpoint"/>
            <endpoint address="http://10.XXX.X.XXX:XXXX/servicename/services/SomeSearch.SomeSearchHttpSoap12Endpoint/" binding="customBinding" bindingConfiguration="SomeSearchSoap12Binding" contract="SomeService.SomeSearchPortType" name="SomeSearchHttpSoap12Endpoint"/>
        </client>
    </system.serviceModel>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup></configuration> 
```

这些是我遵循的步骤：

*   我通过提供 wsdl 路径添加了服务引用。

*   实例化 SomeSearchPortTypeClient

*   在客户端调用方法如下：

    var someService= new SomeSearchPortTypeClient("SomeSearchHttpSoap12Endpoint"); var 文档 = someService.getSomething("123");

当我这样做时，我得到了上述异常。

我还尝试了 ping 到 10.XXX.XXX.XXXX，但超时。这可能是防火墙问题吗？如果是，我的下一步应该是什么？我应该追求哪些其他角度来实现这个工作？

需要注意的一点是，代理客户端是在没有任何异常的情况下实例化的，只有在进行服务调用时它才会让我返回这个错误。

# android - 如果服务正在运行，请检查接收器

> ID：13863042
> 
> 赞同：2
> 
> 时间：2012-12-13T15:25:50.677
> 
> 标签：android, service, broadcastreceiver

我制作了一个使用 Android Cloud to Device Messaging 的应用程序，因为我使用这个应用程序从正确的图标启动它，所以它工作正常。我发现的问题是在设备本身启动之后。启动后，接收器正确启动并正确启动我想要使用的服务，检查它是否正在运行以执行某些任务并最终启动另一个服务。

为了实现它，我这样做了：

在清单上：

```
 <receiver android:name=".C2DMReceiver" android:permission="com.google.android.c2dm.permission.SEND">             
          <!-- Receive the actual message -->
          <intent-filter>
              <action android:name="com.google.android.c2dm.intent.RECEIVE" />
              <category android:name="com.myapp.app" />
          </intent-filter>
          <!-- Receive the registration id -->
          <intent-filter>
              <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
              <category android:name="com.myapp.app" />
          </intent-filter>
                 <intent-filter>
                <action   android:name="android.intent.action.BOOT_COMPLETED"/>
                <category android:name="com.myapp.app" />
            </intent-filter> 
     </receiver> 
```

在我的接收器中：

```
 if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {

        Intent NewIntent = new Intent(context, MyService.class);
        context.startService(NewIntent);
        Log.i("C2DMReceiver", "MyService started");
    } 
```

然后 onMessage 接收接收者必须检查 MyService 是否正在运行。为此，我在 MyService 中编写：

```
 // Use activity in C2DMReceiver class
public static Service getCurrentService() {
    return curService;
} 
```

所以要检查接收器，我这样做：

```
if (MyService.getCurrentService != null){
        //DO ELSE
    } 
```

问题是这个布尔条件总是错误的，即使服务真的在运行。

为什么？

# ruby-on-rails - Rails 评估传递给辅助方法的变量

> ID：13863061
> 
> 赞同：1
> 
> 时间：2012-12-13T15:26:34.077
> 
> 标签：ruby-on-rails, ruby, erb

是否可以在将变量的值传递给 Rails 中的辅助方法之前传递它。

例如，我有一个 base64_encode 辅助方法 @base_url 只是在字符串文字中传递而不是被评估。

```
<%= base64_encode(#{@base_url} + '/helloworld.html') %> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T15:33:08.947

`"#{ variable }"`是红宝石字符串中的变量插值。所以你至少有两个选项来构建你的字符串。

```
<%= base64_encode("#{ @base_url }/helloworld.html") %>
# or
<%= base64_encode(@base_url + "/helloworld.html") %> 
```

请注意，您需要使用`""`Ruby 字符串插值而不是`''`.
Kansas City on Rails 有一篇[简短的博客文章](http://kconrails.com/2010/12/08/ruby-string-interpolation/)，一目了然地了解字符串插值的外观。

# android - 如何保存 EditText 的输入

> ID：13863062
> 
> 赞同：0
> 
> 时间：2012-12-13T15:26:40.407
> 
> 标签：android, android-layout

我想存储输入`EditText`并在另一个对话框中显示它。我怎样才能做到这一点？

因此，我在其中一个中编写并保存了 2 个活动，在另一个中我加载它。

```
public class SaveDialog extends Dialog implements View.OnClickListener{

private MapEditorView mapEditorView;
private Context context;
private Button ok;
private EditText editTextMap;
private boolean exist;

public SaveDialog(Context context, MapEditorView mapEditorView) {
    super(context);
    requestWindowFeature(Window.FEATURE_NO_TITLE);

    this.context = context;
    this.mapEditorView = mapEditorView;

    setContentView(R.layout.dialog_mapeditor_save);

    ok = (Button) findViewById(R.id.Button_save_map);
    ok.setOnClickListener(this);

    exist = true;
}

public void onClick(View v) {
    if (v.getId() == ok.getId()) {

        if(exist){
            AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                    context);
            // set title
            alertDialogBuilder.setTitle("Are You sure?");
            // set dialog message
            alertDialogBuilder
            .setMessage("Current map Name will be overwritten!")
            .setCancelable(false)
            .setPositiveButton("Yes",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog,
                                int id) {

                            mapEditorView.getEditMapRenderer().reNameMap(
                                    String.valueOf(editTextMap.getText().toString()));

                            dismiss();
                        }
                    })
            .setNegativeButton("No",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog,
                                int id) {
                            dialog.cancel();
                        }
                    });
            AlertDialog alertDialog = alertDialogBuilder.create();
            // show it
            alertDialog.show();
        }
        else{
            mapEditorView.getEditMapRenderer().reNameMap(String.valueOf(editTextMap.getText().toString()));
            this.dismiss();
        }
    }
}

public void setExist(boolean exist) {
    this.exist = exist;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T08:50:10.893

使用共享首选项：

第一个活动

```
sh_pref = this.getSharedPreferences("sh_pref",
                MODE_WORLD_READABLE);
SharedPreferences.Editor sh_pref_editor = sh_pref.edit();
sh_pref_editor.putString("Value", valueEdt.getText().toString());
sh_pref_editor.commit();
startActivity(new Intent(this, OtherActivity.class)); 
```

其他活动.java

```
SharedPreferences sh_pref = PreferenceManager.getDefaultSharedPreferences(this);
String value =  sh_pref.getString("Value","nothing");
txtView.setText(value); 
```

# c - 有没有其他半/便携的方式来动态分配内存？

> ID：13863063
> 
> 赞同：2
> 
> 时间：2012-12-13T15:26:44.920
> 
> 标签：c, memory, malloc, dynamic-memory-allocation

这：

```
char *buf = NULL;
scanf("%ms", &buf); 
```

将获得一个动态分配的字符缓冲区。我知道这仅限于使用 Gcc 编译的代码（特别是 glibc 的 2.7 版）。

我也知道“正确”和可移植的方式是只使用`malloc()`（和朋友）来获取内存。

但是，我很好奇，是否还有其他便携式或半便携式^*实现来获取动态分配的内存？我发现 C 中内存分配的技巧和技巧对“Google”来说是一个很难的话题。

**注意：**这对任何事情都不是“必需的”，因此对答案没有限制。

[* 半便携的意思是“如果你编译的方式和我一样，这将工作”]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:29:07.683

POSIX 有

```
ssize_t getline(char **lineptr, size_t *n, FILE *stream); 
```

和

```
ssize_t getdelim(char **lineptr, size_t *n, int delim, FILE *stream); 
```

这应该是半便携式的。

# c# - EF5 Fluent API 映射

> ID：13863065
> 
> 赞同：0
> 
> 时间：2012-12-13T15:26:48.847
> 
> 标签：c#, entity-framework, asp.net-mvc-4, linq-to-entities, entity-relationship

我正在尝试映射这些实体：

```
 [Table("AAN_DigitalLib_Asset")]
    public class Asset
    {
    [Column("ID")]
    public int ID { get; set; }

    [Column("format_id")]
    public int FormatID { get; set; }

    [Column("person_id")]
    public int? PersonID { get; set; }

    [Column("publicationYear")]
    public int? PublicationYear { get; set; }

    public Person People { get; set; }

    //public virtual AssetKeyword AssetKeywords { get; set; }

    public virtual ICollection<AssetKeyword> AssetKeywords { get; set; }
} 
```

使用这些实体：

```
[Table("AAN_DigitalLib_AssetKeyword")]
    public class AssetKeyword
    {
        [Column("ID")]
        public int ID { get; set; }

        [Column("asset_id")]
        public int AssetID { get; set; }

        [Column("keyword")]
        public string Keyword { get; set; }
    } 
```

一个`Asset`可以有很多的地方`AssetKeywords`。数据库中没有指定关系，那么如何使用 Fluent API 创建一个关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:30:21.743

是否添加

```
[ForeignKey("AssetID")]
public virtual Asset Asset { get; set; } 
```

对你的 AssetKeyword 类进行修复吗？

如果那不这样做，那么在你的 onModelCreating()

```
modelBuilder.Entity<AssetKeyword>()
                    .HasRequired(p => p.Asset)
                    .WithMany()
                    .HasForeignKey(p => p.AssetID); 
```

# ios - UILocal 通知

> ID：13863066
> 
> 赞同：0
> 
> 时间：2012-12-13T15:26:50.400
> 
> 标签：ios, uilocalnotification

在我的应用程序中，我每 10 秒安排一次通知和重复，并且在通知确实接收方法中，我正在使用以下代码打印通知总数：

```
NSArray *scheduledNotifications = [[UIApplication sharedApplication] scheduledLocalNotifications];
NSLog(@"%d",scheduledNotifications.count); 
```

打印后，我将删除该通知。当应用程序处于活动状态时，我得到了正确的计数，但是在进入后台 30 秒后，我收到 3 个通知，单击任何通知后，在通知中确实接收方法计数仅打印为“一个”，而不是三...？

任何解决方案请...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:30:58.110

当用户单击/滑动通知时启动应用程序时，您不会在应用程序中收到所有通知。iOS 只会告诉您的应用程序使用了哪个通知来打开您的应用程序。其他本地通知将不会呈现给应用程序。

您可以做的是查看所有本地通知并检查是否已过火日期。这意味着通知可能已经呈现给用户。然后删除该通知。

# silverlight - 如何在 silverlight bing 地图控件上检索 UIElement 的位置？

> ID：13863073
> 
> 赞同：1
> 
> 时间：2012-12-13T15:27:01.737
> 
> 标签：silverlight, location, bing-maps, uielement

我将图像放在 silverlight bing 地图控件上，如下所示：

```
MapLayer mapLayer = new MapLayer();
this.myMap.Children.Add(mapLayer);

Image image = new Image();
BitmapImage btm = new System.Windows.Media.Imaging.BitmapImage(new Uri("/myAssembly;component/Images/myImage.png", UriKind.Relative));
image.Source = btm;
LocationRect rect = new LocationRect(new Location(10, 12), new Location(55, 55));

mapLayer.AddChild(image, rect); 
```

这工作正常。但我找不到如何在我的代码中的其他地方检索位置。我尝试：

```
var loc = MapLayer.GetPosition(image) --> Always returning null !!! 
```

maplayer 对象没有任何方法来获取子位置，我无法计算位置，`mapLayer.ParentMap.TryViewportPointToLocation`因为图像`Width`和`Height`属性始终为 0（为什么？？）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T15:16:39.177

如果在添加之前将其保存在某处，则可以检索该位置。将它们保存在某个变量中。

```
new Location(10, 12), new Location(55, 55) 
```

# zend-framework - Google YouTube Zend - 获取经过身份验证的用户

> ID：13863075
> 
> 赞同：1
> 
> 时间：2012-12-13T15:27:08.383
> 
> 标签：zend-framework, youtube

好的，我已成功通过 Google 进行身份验证，这很好。

$yt = new Zend_Gdata_YouTube($httpClient, $applicationId, $clientId, $developerKey);

问题是 - 我如何获得经过身份验证的用户视频？下面的函数是根据用户名获取的，但是如何获取刚刚认证的用户呢？

$videoFeed = $yt->getUserUploads('kornflake2007');

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:44:44.753

你有没有尝试过：

```
$userProfileEntry = $yt->getUserProfile('default');
$userName = $userProfileEntry->getUsername();

$videoFeed = $yt->getUserUploads($userName); 
```

默认为当前用户。

查看代码，我不确定接下来的事情是否会起作用。但我想它值得一试。

```
$videoFeed = $yt->getUserUploads(); 
```

如果没有名称，它应该使用当前用户。

# java - 如何创建 Android ICS 拖放阴影效果？

> ID：13863080
> 
> 赞同：1
> 
> 时间：2012-12-13T15:27:23.360
> 
> 标签：java, android, drag-and-drop, shadow, outline

我想在我的应用程序中创建图标阴影/轮廓效果，如[Google 的设计指南页面](http://developer.android.com/design/get-started/principles.html)所示。我想达到的效果：

![例子](../Images/7af6f3fb5d53b4924acbbd0a4c396523.png)

有没有人注意到动态创建掩码的代码部分，然后创建像上面这样的轮廓？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:57:44.797

我想我已经找到了解决办法。以前搜索引擎没有返回任何令人满意的结果（因为我输入了“影子”，而不是“大纲”），我复制了[这个问题](https://stackoverflow.com/questions/12237453/getting-shadows-outlines-shapes-of-icons)。

# javascript - 在 Windows 8 Store App 中调整 HTML5 输入控件的大小

> ID：13863081
> 
> 赞同：2
> 
> 时间：2012-12-13T15:27:25.650
> 
> 标签：javascript, css, html, windows-8

我正在使用 JavaScript、HTML5 和 CSS 编写 Windows 8 应用商店应用程序。在应用程序的一个屏幕上，我有几个 HTML5 输入控件来从用户那里收集数据，这些数据在我的 HTML 文件中定义，如下所示：

```
<input id="priceInput" type="number" /> 
```

输入文本框按应有的方式呈现和运行，但是其中一些文本框对于它们捕获的数据来说太长了。有没有办法在 HTML 或 CSS 中设置输入文本框的长度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:31:40.170

您可以使用 CSS 设置宽度：

```
#priceInput {
    width: 100px
} 
```

# javascript - Wordpress 自定义小部件图片上传

> ID：13863087
> 
> 赞同：15
> 
> 时间：2012-12-13T15:27:57.810
> 
> 标签：javascript, html, wordpress

我正忙于构建自己的 Wordpress 小部件。除了 Wordpress 媒体上传器之外，一切正常。我创建了八个按钮和八个输入文本字段，其中应包含已上传图像的 url。

click 事件没有被触发，可能是因为 Wordpress 输出 HTML 两次（一次在可用小部件的栏中，一次在当前活动小部件的栏中）。

有人看到我做错了吗？

您可以在下面找到我的代码。

在此先感谢您的帮助！

```
<?php
/*
Plugin Name: Home_Rollover_Widget
Plugin URI: 
Description: Home Rollover Widget
Version: 1.0
Author: 
Author URI: 
*/

// Initialize widget
add_action('widgets_init', array('Home_Rollover_Widget', 'register'));

/**
 * Home_Rollover_Widget
 * 
 * @package 
 * @author 
 * @copyright 2012
 * @version $Id$
 * @access public
 */
class Home_Rollover_Widget extends WP_Widget
{   
    /**
     * __construct()
     * 
     * @return void
     */
    public function __construct()
    {
        parent::__construct('home-rollover-widget');
    }
    /**
     * control()
     * 
     * @return void
     */
    public function control()
    {    
        // Load upload an thickbox script
        wp_enqueue_script('media-upload');
        wp_enqueue_script('thickbox');

        // Load thickbox CSS
        wp_enqueue_style('thickbox');

        // Load all widget options
        $data = get_option('Home_Rollover_Widget');
        ?>

        <!-- Widget title -->
        <p><label>Titel<input name="home_rollover_widget_title" type="text" value="<?php echo $data['home_rollover_widget_title']; ?>" /></label></p>

        <?php
        // If there's a title provided, update it.
        if (isset($_POST['home_rollover_widget_title'])){
            $data['home_rollover_widget_title'] = attribute_escape($_POST['home_rollover_widget_title']);
        }

        // Show 8 input groups for image URL and text
        for ($i = 1; $i <= 8; ++$i)
        {
            ?>

            <p><a href="#" id="upload-button-<?php echo $i; ?>">UPLOAD IMAGE</a></p>
            <p><label>IMAGE <?php echo $i; ?><input id="home_rollover_widget_image_url_<?php echo $i; ?>" name="home_rollover_widget_image_url_<?php echo $i; ?>" type="text" value="<?php echo $data['home_rollover_widget_image_url_'.$i]; ?>" /></label></p>
            <p><label>TEXT <?php echo $i; ?><input name="home_rollover_widget_text_<?php echo $i; ?>" type="text" value="<?php echo $data['home_rollover_widget_text_'.$i]; ?>" /></label></p>
            <?php
            // If there's an URL provided, update it.
            if (isset($_POST['home_rollover_widget_image_url_'.$i])){
                $data['home_rollover_widget_image_url_1'] = attribute_escape($_POST['home_rollover_widget_image_url_'.$i]);
            }

            // if there's a text provided, update it.
            if (isset($_POST['home_rollover_widget_text_'.$i])) {
                $data['home_rollover_widget_text_1'] = attribute_escape($_POST['home_rollover_widget_text_'.$i]);
            }

            ?>

            <script type="text/javascript">            
                var formField = '';
                var imgUrl ='';

                jQuery(document).ready(function() {
                    jQuery('#upload-button-<?php echo $i; ?>').click(function() {
                        alert('Clicked on upload button');
                        formField = jQuery('#upload-button-<?php echo $i; ?>').attr('name');
                        tb_show('', 'media-upload.php?type=image&amp&TB_iframe=1');
                        return false;
                    });

                    // send url back to plugin editor
                    window.send_to_editor = function(html) {
                        imgUrl = jQuery('img',html).attr('src');
                        alert('Sending image url'+imgUrl+' to text field');
                        jQuery('#home_rollover_widget_image_url_<?php echo $i; ?>').val(imgUrl);
                        tb_remove();
                    }            
                });
            </script>

            <hr />

            <?php    
        }

        // Update widget data
        update_option('Home_Rollover_Widget', $data);
    }

    /**
     * widget()
     * 
     * @param mixed $args
     * @return void
     */
    function widget($args)
    {           
        // Load all widget options
        $data = get_option('Home_Rollover_Widget');        
        ?>

        <h4><?php echo $data['home_rollover_widget_title']; ?></h4>

        <div id="all">
            <?php
            // Loop though the widget elements
            for ($i = 1; $i <= 8; ++$i) 
            {
                // Find image URL
                $imageUrl = $data['home_rollover_widget_image_url_'.$i];

                // Check for first slash, if not present, add it.
                if (substr($imageUrl, 0, 1) != '/') {
                    $imageUrl = '/'.$imageUrl;
                }
                ?>
                <ul>
                    <li><a href="#"><img src="<?php echo get_template_directory_uri(); ?><?php echo $imageUrl; ?>" /><h4><?php echo $data['home_rollover_widget_text_'.$i]; ?></h4></a></li>      
                </ul>
                <?php
            }
            ?>
        </div>
        <?php
    }

    /**
     * register()
     * 
     * @return void
     */
    function register()
    {
        // Register for sidebar
        register_sidebar_widget('Home Rollover Widget', array('Home_Rollover_Widget', 'widget'));

        // Register for control panel
        register_widget_control('Home Rollover Widget', array('Home_Rollover_Widget', 'control'));
    }
} 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-18T10:37:11.577

对于这个例子，我稍微简化了小部件，删除了 for 循环，因为我认为你可以创建小部件的新实例。这也允许对项目进行排序的额外好处。我将 js 移至另一个文件，因为无需重复代码。

小部件类

```
class Home_Rollover_Widget extends WP_Widget
{

  public function __construct()
  {
    parent::__construct(
      'home-rollover-widget',
      'Home Rollover Widget',
      array(
        'description' => 'Home rollover widget'
      )
    );
  }

  public function widget( $args, $instance )
  {
    // basic output just for this example
    echo '<a href="#">
      <img src="'.esc_url($instance['image_uri']).'" />
      <h4>'.esc_html($instance['image_uri']).'</h4>
    </a>';
  }

  public function form( $instance )
  {
    // removed the for loop, you can create new instances of the widget instead
    ?>
    <p>
      <label for="<?php echo $this->get_field_id('text'); ?>">Text</label><br />
      <input type="text" name="<?php echo $this->get_field_name('text'); ?>" id="<?php echo $this->get_field_id('text'); ?>" value="<?php echo $instance['text']; ?>" class="widefat" />
    </p>
    <p>
      <label for="<?php echo $this->get_field_id('image_uri'); ?>">Image</label><br />
      <input type="text" class="img" name="<?php echo $this->get_field_name('image_uri'); ?>" id="<?php echo $this->get_field_id('image_uri'); ?>" value="<?php echo $instance['image_uri']; ?>" />
      <input type="button" class="select-img" value="Select Image" />
    </p>
    <?php
  }

} 
// end class

// init the widget
add_action( 'widgets_init', create_function('', 'return register_widget("Home_Rollover_Widget");') );

// queue up the necessary js
function hrw_enqueue()
{
  wp_enqueue_style('thickbox');
  wp_enqueue_script('media-upload');
  wp_enqueue_script('thickbox');
  // moved the js to an external file, you may want to change the path
  wp_enqueue_script('hrw', '/wp-content/plugins/home-rollover-widget/script.js', null, null, true);
}
add_action('admin_enqueue_scripts', 'hrw_enqueue'); 
```

新建 js 文件：使用`.on()`方法而不是`.click()`附加事件处理程序。

```
var image_field;
jQuery(function($){
  $(document).on('click', 'input.select-img', function(evt){
    image_field = $(this).siblings('.img');
    tb_show('', 'media-upload.php?type=image&amp;TB_iframe=true');
    return false;
  });
  window.send_to_editor = function(html) {
    imgurl = $('img', html).attr('src');
    image_field.val(imgurl);
    tb_remove();
  }
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-11-22T00:19:06.043

这个脚本对我帮助很大。但后来，我发现它在我的帖子中与媒体上传混淆了，可能是因为它两次调用媒体上传脚本。我通过添加解决了它

```
if( $hook != 'widgets.php' ) 
    return; 
```

像这样：

```
// queue up the necessary js
function hrw_enqueue($hook) {

if( $hook != 'widgets.php' ) 
    return;

  wp_enqueue_style('thickbox');
  wp_enqueue_script('media-upload');
  wp_enqueue_script('thickbox');
  // I also changed the path, since I was using it directly from my theme and not as a plugin
  wp_enqueue_script('hrw', get_template_directory_uri() . '/js/script.js', null, null, true);
}
add_action('admin_enqueue_scripts', 'hrw_enqueue'); 
```

这样，小部件仅在小部件页面中调用上传脚本，而不是在整个管理员中。

# java - 移动精灵和引擎的尾巴

> ID：13863090
> 
> 赞同：2
> 
> 时间：2012-12-13T15:28:15.287
> 
> 标签：java, android, sprite, andengine

我想给一个移动的精灵添加一条尾巴，我在互联网上读到我应该使用粒子，但他们没有像我的例子那样给出平滑的线条。有没有人建议如何做到这一点？

![在此处输入图像描述](../Images/c7856ada6d8a513096a9a8043f2c3b4a.png)

这是一个带有粒子的示例，这不是我想要的！

![在此处输入图像描述](../Images/3242301ca61d38be185c969a32a859d5.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:41:21.013

您可以通过提供 preX、PreY 和 nextX 和 nextY 点来绘制连续的连接线，这里是绘制[线](http://www.andengine.org/forums/tutorials/drawing-lines-scribble-with-touch-t3072-10.html)的代码， 您也可以绘制多点路径。这是示例[代码](http://www.andengine.org/forums/gles2/drawing-a-line-made-up-from-multiple-points-t7536.html)

# c# - 单击 ComboBox 时刷新 TreeView

> ID：13863091
> 
> 赞同：1
> 
> 时间：2012-12-13T15:28:15.433
> 
> 标签：c#, events, combobox, treeview

因为我不知道究竟是什么导致了问题，请允许我先介绍一下我正在做的项目。

这是一个基于 Windows 窗体的应用程序。两个主要控件是 TreeView 和 TabPage。每个 TabPage 关联一个 TreeNode，所以当点击 TreeNode 时，会出现对应的 TabPage。这是通过使用事件“AfterSelect”来完成的，一旦我点击了TreeNode，它就会触发事件来显示相应的TabPage。每个 TabPage 上还有其他控件，例如 TextBox、ComboBox 等。我在 TreeView 上做的另一件事是，即使在 SelectedNode 失去焦点后，我也让 SelectedNode 保持突出显示。我使用了“Enter”和“Leave”事件，所以当进入对应的TabPage时，我将SelectedNode的背景色改为“MenuHighlight”，离开TabPage后将背景色改为正常。（添加此“突出显示”后，我开始看到问题

好的，这是一个略长的介绍。感谢您的阅读，感谢您的宝贵时间。

它基本上按我的意愿工作。但是有一个小故障。每次选择 TabPage 时，如果单击该 TabPage 上的 ComboBox，TreeView 将刷新。但仅对于第一次单击，TreeView 不会刷新。而且它只发生在 CombBox 上，我不能在 TextBox、CheckBox 或 RadioButton 上重复这个问题。

以前有人见过这个问题吗？任何线索可能导致问题？再次感谢您的宝贵时间！

# css - 将td的宽度设置为auto？

> ID：13863094
> 
> 赞同：1
> 
> 时间：2012-12-13T15:28:30.510
> 
> 标签：css

我有`td`一个内联样式的 aa，将其设置`width`为百分比。我可以修改css，但不能修改html。

如何使`td`唯一占用其内容所需的宽度？

以下 CSS 不起作用：

```
td#my 
{
    width: auto !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:34:19.357

您需要遵守 CSS 特定性规则。（这样做可以避免使用！important）

[http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

内联样式的权重为 1000，其中 ID 为 100，元素为 1。因此，为了确保正确使用您的 CSS 规则，您需要密切注意这一点。上面链接的文章在解释特异性方面做得比我希望达到的要好得多。读它，研究它，爱它。

这并不能直接回答您的问题：这是一篇内容丰富的文章，实际上可以通过允许您采取不同的路线来解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:47:31.307

默认情况下，表格单元格是自动宽度的，但它们占用了其列中最宽单元格的最小宽度。所以以这个为例

```
td1|td2|td3|

1  |2  |3  | 
```

基于第一行，这些单元格的宽度都将相同。我没有办法强迫它这样做：

```
td1|td2|td3|

1|2|3| 
```

这听起来像是您正在尝试做的事情，而不是在不更改 HTML 的情况下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:42:54.297

您可能还必须对表格其他单元格的 css 进行一些更改。深入研究以下内容，了解如何计算单元格宽度

来自： [w3.org/TR/CSS21/tables.html#width-layout](http://w3.org/TR/CSS21/tables.html#width-layout)

> 列宽确定如下：
> 
> 1.  计算每个单元格的最小内容宽度（MCW）：格式化的内容可以跨越任意数量的行，但不能溢出单元格框。如果单元格的指定“宽度”(W) 大于 MCW，则 W 是最小单元格宽度。'auto' 值意味着 MCW 是最小单元格宽度。块引用
>     
>     
>     
>     此外，计算每个单元格的“最大”单元格宽度：格式化内容而不换行，除非出现明确的换行符。
>     
>     
> 2.  对于每一列，从仅跨越该列的单元格中确定最大和最小列宽。最小值是具有最大最小单元格宽度（或列“宽度”，以较大者为准）的单元格所需的最小值。最大值是具有最大单元格宽度（或列“宽度”，以较大者为准）的单元格所需的最大值。
>     
>     
> 3.  对于跨越多于一列的每个单元格，增加它跨越的列的最小宽度，以便它们加在一起至少与单元格一样宽。对最大宽度执行相同操作。如果可能，将所有跨越的列加宽大致相同的量。
>     
>     
> 4.  对于具有除“auto”之外的“width”的每个列组元素，增加它跨越的列的最小宽度，以便它们加在一起至少与列组的“width”一样宽。
>     
>     
> 
> 这给出了每列的最大和最小宽度。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-13T15:33:25.040

尝试：

`td#my {width:inherit !important;}`

或者

`td#my {width:0% !important;}`

# javascript - 如何使用 Ember Handlebars 助手？

> ID：13863095
> 
> 赞同：0
> 
> 时间：2012-12-13T15:28:31.600
> 
> 标签：javascript, html, ember.js, handlebars.js

> **可能重复：**
> [handlebars.js {{#if}} 条件中的逻辑运算符](https://stackoverflow.com/questions/8853396/logical-operator-in-a-handlebars-js-if-conditional)

这是我的代码

```
{{#each dataArray}}
     <li>{{#isTrue idVal1 idVal2}}
    show some text1
 {{else}}
    show some text2
 {{/isTrue}}
    </li>
{{/each}}

Em.Handlebars.registerHelper('isTrue', function(x, y) {
    console.log(x);// shows idVal1
    console.log(y);// shows idVal2 not the exact value, I have passed
    return x==y;
 }); 
```

预期结果：- 它应该返回真/假

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:47:37.737

编写绑定助手是不可能的，问题[#1274](https://github.com/emberjs/ember.js/pull/1274)。

我想知道为什么这个有用的拉取请求仍然悬而未决。有一个[解决方法](http://techblog.fundinggates.com/blog/2012/08/ember-handlebars-helpers-bound-and-unbound/)。

# image - 让-SRC 退出 (xsl - RSS 查看器 WP)

> ID：13863097
> 
> 赞同：0
> 
> 时间：2012-12-13T15:28:37.403
> 
> 标签：image, xslt, rss, cdata

我需要从此代码中获取图像源：

```
<content:encoded>
    <![CDATA[
        <span><img width="200" src="..."></span><br /> [some Text] ]]>
</content:encoded> 
```

这是我尝试过的：

```
 <xsl:variable name="ImageURL" select="substring-before(substring-after(content, 'src=&quot;'), '&quot;&gt;')" />
 <img alt="" src="{$ImageURL}" width="75" height="49" /> 
```

不幸的是，我的解决方案失败了。我还尝试了一些其他语法，但主要部分是相同的。有人可以帮我吗？

感谢所有的努力！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T12:51:42.543

假设 Sharepoint WebPart 使用 XslCompiledTransform 并允许您将 XSLT 与嵌入式 C# 或 VB.NET 代码一起使用来实现扩展功能，以下应该会有所帮助：

```
<xsl:stylesheet 
    version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt"
    xmlns:content="http://purl.org/rss/1.0/modules/content/"
    exclude-result-prefixes="msxsl mf content"
    xmlns:mf="http://example.com/mf"
>
  <msxsl:script implements-prefix="mf" language="C#">
    <msxsl:using namespace="System.IO"/>
  public XPathNavigator ParseFragment(string markupFragment)
  {
    using (StringReader sr = new StringReader(markupFragment))
    {
      using (XmlReader xr = XmlReader.Create(sr, 
        new XmlReaderSettings() { ConformanceLevel = ConformanceLevel.Fragment }))
      {
        XPathDocument doc = new XPathDocument(xr);
        return doc.CreateNavigator();
      }
    }
  }
  </msxsl:script>

  <xsl:output method="html"/>

  <xsl:template match="content:encoded">
    <xsl:apply-templates select="mf:ParseFragment(.)/span/img"/>
  </xsl:template>

  <xsl:template match="img">
    <img alt="" src="{@src}" width="75" height="49" />
  </xsl:template>
</xsl:stylesheet> 
```

但是请注意，在 CDATA 部分中的标记上应用 XML 解析器需要它符合 XML 语法规则，因此解析 X(HT)ML 之类的东西

```
 <content:encoded>
    <![CDATA[
        <span><img width="200" src="foo.png"/></span><br /> [some Text] ]]>
  </content:encoded> 
```

将工作，但解析 HTML 的东西，如

```
 <content:encoded>
    <![CDATA[
        <span><img width="200" src="foo.png"></span><br> [some Text] ]]>
  </content:encoded> 
```

不管用。不幸的是，.NET 框架类库没有附带 HTML 解析 API，因此如果`content:encoded`元素的内容是 HTML，您将需要寻找第三方 HTML 解析器，如 HTMLAgilityPack 来执行 XPathDocument 在我的示例中所做的工作，或者您真的XPath 1.0 对字符串解析的支持很差：

```
<xsl:stylesheet 
    version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:content="http://purl.org/rss/1.0/modules/content/"
    xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl content"
>

  <xsl:template match="content:encoded">
    <img alt="" src="{substring-before(substring-after(., 'src=&quot;'), '&quot;')}" width="75" height="49"/>
  </xsl:template>
</xsl:stylesheet> 
```

# c# - 我可以以某种方式告诉 Resharper ViewModel 的类型吗？

> ID：13863099
> 
> 赞同：11
> 
> 时间：2012-12-13T15:28:46.680
> 
> 标签：c#, mvvm, resharper

我们在不同的程序集中有视图和视图模型。Views 的程序集具有对 VM 的引用。（有时我们需要后面的代码）。

ViewModel 的 DataContext 是在代码中设置的，而不是在 XAML 中。因此，无论是 VS，Resharper 都不能像智能感知那样提供帮助，并且 Resharper 也给出了很多警告。

我们可以在 XAML 注释中为 Resharper 设置任何指令来说明我们打算将 View 与特定类型的 VM 一起使用吗？

更新：

不错的[博](http://karlshifflett.wordpress.com/2009/10/28/ddesigninstance-ddesigndata-in-visual-studio-2010-beta2/)文作为已接受答案的补充。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-30T10:51:16.740

我遇到了同样的问题，并通过使用 XAML 中的设计时支持在 XAML 编辑器中获得智能感知支持来解决它，这也满足 Resharper 绑定验证。

请注意下面代码片段中使用的 d: 命名空间。这将在运行时被忽略。您还可以使用 ViewModelLocator，它将设计时（假）存储库添加到 IoC 容器，从而消除来自外部源（如 Web 服务或其他数据源）的任何依赖项。

XAML 设计时支持：

```
<local:ViewBase
    ...
    mc:Ignorable="d" 
    d:DataContext="{Binding Source={d:DesignInstance Type=viewModel:MainViewModel, IsDesignTimeCreatable=True}}"> 
```

XAML 视图模型定位器：

```
<local:ViewBase
    ...
    mc:Ignorable="d" 
    viewModel:ViewModelLocator.ViewModel="MainViewModel" > 
```

视图模型定位器：

```
 static ViewModelLocator()
    {
        if (DesignMode.DesignModeEnabled)
        {
            Container.RegisterType<IYourRepository, YourDesignTimeRepository>();
        }
        else
        {
            Container.RegisterType<IYourRepository, YourRuntimeRepository>();
        }

        Container.RegisterType<YourViewModel>();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:20:50.267

如果您将 ViewModel 设置为 XAML 中 UIElement 的 .DataContext 属性作为占位符，则当您在运行时通过构造函数注入的 ViewModel 设置它时，它将被替换。

所以你可以有

```
<UserControl.DataContext>
    <Pages:WelcomeLoadingViewModel />
</UserControl.DataContext> 
```

然后在 UserControls 构造函数中有

```
public WelcomeLoading(WelcomeLoadingViewModel viewModel)
{
   this.DataContext = viewModel;
} 
```

或者

```
public HomePage()
{
   this.InitializeComponent();

   this.DataContext = ViewModelResolver.Resolve<HomePageViewModel>(); 
```

这意味着您将获得 Binding 和 Resharper 支持，因为它们可以反映来自 XAML Datacontext 的 ViewModel。但也享受依赖注入视图模型的好处，因为虚拟机将在运行时从您的 DI 容器中替换。

# android - 当 repo 同步时，它停止在 Fetching projects: 100% (293/293), done

> ID：13863100
> 
> 赞同：4
> 
> 时间：2012-12-13T15:28:50.387
> 
> 标签：android, repository

我为 Android 操作系统源创建了一个新的 repo。我想下载 Android4.1.1

我用了：

repo init -u [https://android.googlesource.com/platform/manifest](https://android.googlesource.com/platform/manifest) -b android-4.2_r1

回购同步

下班后，终止显示：

yeling@yeling-ThinkPad-E420:~/code/Android4.1$ repo sync

获取项目：100% (293/293)，完成。

它停在这里，我进入目录 ~/code/Android4.1/ ，没有文件，只有一个目录 .repo

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T05:59:29.550

利用

$回购同步-l

它只更新工作树并且不获取。

查看 $repo sync -h，了解 repo 同步的其他选项。

玩得开心！拉克什维尔马

# php - php mysql中的程序

> ID：13863101
> 
> 赞同：1
> 
> 时间：2012-12-13T15:28:53.260
> 
> 标签：php, mysql, sql, procedure

这是我的 php 代码。程序有效。

这应该是调用程序工作的东西：

*   这面文字墙底部的代码 -

它什么也不做。空白的。

过程如下：

```
CREATE PROCEDURE dodaj_osobe
         (do_pesel     decimal(11),
 do_imie   VARCHAR(45),
 do_nazwisko    VARCHAR(45),
 do_telefon     decimal(9),
 do_adres     VARCHAR(45),
 do_nr_konta     decimal(20),
 do_zarobek    decimal(8,2))
MODIFIES SQL DATA
BEGIN
INSERT INTO baza_osob
(pesel,imie,nazwisko,telefon,adres,nr_konta,zarobek)
VALUES
(do_pesel,do_imie,do_nazwisko,do_telefon,do_adres,do_nr_konta,do_zarobek); 
```

有人可以在这里找到我的错误吗？这可能是小东西..但我看不到它。

@编辑 <<<<<<<<<<<<<<,

现在看起来像这样，仍然没有任何变化。

```
<?php
error_reporting(E_ALL|E_NOTICE);

$nazwabazydanych = "projekt";
if (!$pesel || !$imie || !$nazwisko || !$telefon || !$adres || !$nr_konta || !$zarobek)

 {
        print "Nie zostały wypełnione wszystkie pola";
        exit;
 }

$pesel = mysql_real_escape_string($pesel);
$imie = mysql_real_escape_string($imie);  
$nazwisko = mysql_real_escape_string($nazwisko);
$telefon = mysql_real_escape_string($telefon);
$adres = mysql_real_escape_string($adres);
$nr_konta = mysql_real_escape_string($nr_konta);
$zarobek = mysql_real_escape_string($zarobek);

$db = mysql_pconnect("localhost", "root", "");
if (!$db)  
        {  
        print "Nie można nawiązać połączenia z bazą danych";
        exit;
        }

mysql_select_db("$nazwabazydanych");

$query = mysql_query("CALL dodaj_osobe ('$pesel','$imie','$nazwisko','$telefon','$adres','$nr_konta','$zarobek')"); 

?> 
```

和错误：

```
Notice: Undefined variable: pesel in C:\xampp\htdocs\proj\lool.php on line 5
Nie zostały wypełnione wszystkie pola 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:40:17.823

```
 @$db = mysql_pconnect("localho5st", "root", ""); 
```

是**localhost**或**localho5st**

就是想...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:36:20.213

我的猜测是你需要写 localhost 而不是 localho5st

# qt - 将现有样式表元素的值用作另一个样式表元素的值

> ID：13863103
> 
> 赞同：0
> 
> 时间：2012-12-13T15:29:07.297
> 
> 标签：qt, styling

我试图在我的样式表上设置样式表`QTreeView`，以使所选项目具有相同的颜色，而不管视图是否具有焦点。我正在使用

```
QTreeView::item:selected:!active { 
    background: myColour; 
} 
```

我不想将硬编码的值传递到我的样式表中，而是使用 的值`QTreeView::item:selected:active`，让我始终正确设置颜色。我对此进行了快速了解

```
QTreeView::item:selected:!active { 
    background: QTreeView::item:selected:active; 
} 
```

只是想看看发生了什么，这没什么。如何提取 的值`QTreeView::item:selected:active`并在我的样式表中使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:16:15.483

我会从调色板中读取活动颜色组的背景颜色并将其应用于小部件的调色板。

[`QWidget::palette()`](http://qt-project.org/doc/qt-4.8/qwidget.html#palette-prop)

[`QPalette`](http://qt-project.org/doc/qt-4.8/QPalette.html)

[`QPalette::color()`](http://qt-project.org/doc/qt-4.8/qpalette.html#color)

[`QPalette::ColorRole`](http://qt-project.org/doc/qt-4.8/qpalette.html#ColorRole-enum)

[`QPalette::ColorGroup`](http://qt-project.org/doc/qt-4.8/qpalette.html#ColorGroup-enum)

所以这就是你为你的`QTreeViewItem`.

```
QPalette modifiedPalette(this->palette());
QColor activeBgColor(this->palette().color(QPalette::Active, QPalette::Window));
modifiedPalette.setColor(QPalette::Window, activeBgColor);

this->setPalette(modifiedPalette); 
```

希望有帮助。

* * *

您还可以探索的其他两个选项包括：

使用动态属性，或者基本上将您控制的某些属性与样式绑定。我最近发了一篇较长的帖子向某人解释：

[QList：内存不足](https://stackoverflow.com/questions/13564823/qlist-out-of-memory/13568733#13568733)

或者，您可以使用某种正则表达式解析`QString`返回的信息并将其存储在某处，但如果该小部件的样式表没有它，并且它正在引用父样式表，这可能会出现问题。`stylesheet()`你也可以考虑使用 QWidget 的 style 属性。

[`QWidget::styleSheet()`](http://qt-project.org/doc/qt-4.8/qwidget.html#styleSheet-prop)

# jquery - 可视化 jQuery 插件在 IE8、FF 和 Safari 中不起作用

> ID：13863104
> 
> 赞同：0
> 
> 时间：2012-12-13T15:29:16.790
> 
> 标签：jquery, jsp, firefox, internet-explorer-8, safari

我正在尝试使用 jQuery 可视化插件来从 jsp 中的表生成图形。我将图表附加到 div 标签。这在 IE9 和 IE7 中运行良好（在 IE7 中位失真）。在 IE8、firefox 和 Safari 中，只有框出现，但其中没有图表。

你能帮我解决这个问题吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T13:12:52.303

首先创建图形，然后使用类选择器将其附加到其容器元素：

```
$("table").visualize()
        .appendTo("body")
        .trigger('visualizeRefresh');
$("div").append($(".visualize")); 
```

我希望这行得通。

# c - 我应该什么时候调用 CoUninitialize？

> ID：13863106
> 
> 赞同：0
> 
> 时间：2012-12-13T15:29:23.447
> 
> 标签：c, com, mta

我在 DLL 中实现了一个函数，封装了对 Out-OF-Proc COM 服务器的异步调用。它看起来像这样：

```
 HRESULT hr = S_OK;
    bool bCoInitialized = false;
    IXXXXInterface* pServer = NULL;
    ISynchronize* pISynchronize = NULL;
    AsyncIXXXXInterface* pAsyncServer = NULL;
    ICancelMethodCalls* pICancel = NULL;

    hr = CoInitializeEx(NULL,COINIT_MULTITHREADED);
    if (hr == S_OK || hr == S_FALSE) {
        bCoInitialized = true;
    }
    else if(hr == RPC_E_CHANGED_MODE) {
        bCoInitialized = false;
    }
    else{
        bCoInitialized = false;
        goto cleanup
    }
    hr = CoCreateInstance(CLSID_XXXXInterface, NULL,
        CLSCTX_ALL|CLSCTX_ACTIVATE_64_BIT_SERVER, IID_IXXXXInterface, (void**)&pServer);
    if (FAILED (hr)) {
        goto cleanup
    }

    ICallFactory* pCallFactory;
    hr = pServer->QueryInterface (IID_ICallFactory, (void**) &pCallFactory);
    if (FAILED (hr)) {
        goto cleanup
    }

    hr = pCallFactory->CreateCall (IID_AsyncIXXXXInterface, NULL, IID_AsyncIXXXXInterface,
        (IUnknown**) &pAsyncServer);
    pCallFactory->Release();
    if (FAILED (hr)) {
        goto cleanup
    }

    hr = pAsyncServer->QueryInterface(IID_ISynchronize,  (void**) &pISynchronize);
    if (FAILED (hr)) {
        goto cleanup
    }

    hr = pAsyncServer->QueryInterface(IID_ICancelMethodCalls, (void**) &pICancel);
    if (FAILED (hr)) {
        goto cleanup
    }

    // Do something use the async interface.
cleanup:    
    if(pICancel)
        pICancel->Release();
    if(pISynchronize)
        pISynchronize->Release();
    if(pAsyncServer)
        pAsyncServer->Release();
    if(pServer)
        pServer->Release();
    if(bCoInitialized)     // If I comment out these 
        CoUninitialize();  // 2 lines, it will be OK. 
```

问题是当我在多线程中调用该函数时，有时它会在 COM 的工作线程中使用调用堆栈在 combase.dll 中抛出异常。如果我只是注释掉最后两行，就可以了。看起来 CoUnitialize() 将释放所有资源，而 COM 线程池中的工作线程在某些情况下仍在使用它们。我不确定我的想法是否正确，或者其他地方有问题。如果我是对的，如何通过使用哪个 API 等待工作线程释放所有资源来避免这个问题？

# sorting - 以编程方式设置网格排序

> ID：13863111
> 
> 赞同：15
> 
> 时间：2012-12-13T15:30:07.330
> 
> 标签：sorting, datasource, kendo-ui

是否可以在读取数据之前以编程方式设置 KendoUI 数据源的排序参数并避免第二次服务器读取？范围是在特定用户交互上设置默认排序。如何？

这是我正在尝试做的一个例子，因为答案没有得到重点（或者我可能不了解事情是如何运作的）。

我用初始排序定义了一个 Kendo DataSource：

```
var datasource = new kendo.data.DataSource({
    parameterMap: function (inputParams, operation) {
        return JSON.stringify(inputParams)
    },
    // default sort
    sort: [
        {field: "field_1", dir: "asc"},
        {field: "field_2", dir: "asc"}
    ]
}); 
```

此 DataSource 绑定到 Kendo 网格：

```
var grid = $("element").kendoGrid({
    dataSource: datasource   
}); 
```

然后我有一个按钮，它在 DataSource 上调用“读取”并用第一页数据填充网格：

```
$("#btn").bind("click", function(e) {
    datasource.page(1);
}); 
```

这样，在单击按钮后，用户会获取按“field_1”和“field_2”排序的数据，并且网格会在列标题上显示这种排序。然后，用户可以通过单击列标题以任何方式重新排序数据。

我想做的是将默认排序重置为初始排序，如 DataSource 声明中定义的那样，在列标题上再次显示它，而无需再次创建新的 DataSource。

就像是：

```
$("#btn").bind("click", function(e) {
    datasource.sort = [
        {field: "field_1", dir: "asc"},
        {field: "field_2", dir: "asc"}
    ]; 
    datasource.page(1);
}); 
```

提供的解决方案似乎没有达到目的（我仍然不明白为什么我会因为一个似乎不是那么微不足道的合法问题而失去声誉点，应该由框架解决）。

请告诉我我错了（我不担心失去声誉 - 我只想了解如何解决问题）。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-07-12T20:50:44.267

```
var kendoGrid = $("#grid").data('kendoGrid');
var dsSort = [];
dsSort.push({ field: "fieldName1", dir: "asc" });
dsSort.push({ field: "fieldName2", dir: "desc" });
kendoGrid.dataSource.sort(dsSort); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-16T03:06:36.453

这是一个 jsfiddle 正是您要问的：http: [//jsfiddle.net/MechStar/c2S5d/](http://jsfiddle.net/MechStar/c2S5d/)

简而言之，您首先需要将 dataSource 设置为 null，然后在您从用户那里获得所需的输入时注入 dataSource：

myKendoGrid.data("kendoGrid").setDataSource(getKendoDataSource("ShipName", "asc"));

```
var getKendoDataSource = function (sidx, sord) {
  return new kendo.data.DataSource({
    type: "odata",
    transport: {
      read: "http://demos.kendoui.com/service/Northwind.svc/Orders"
    },
    pageSize: 10,
    serverPaging: true,
    serverSorting: true,
    sort: {
      field: sidx ? sidx : "",
      dir: sord ? sord : ""
    }
  });
};
var myKendoGrid = $("#grid").kendoGrid({
  columns: [
    { field: "OrderID" },
    { field: "ShipName" },
    { field: "ShipCity" }
  ],
  dataSource: null,
  pageable: {
    pageSizes: [10, 20, 50, 100, 200]
  },
  resizable: true,
  scrollable: false,
  sortable: {
    allowUnsort: false
  }
});
$("#link").click(function () {
  myKendoGrid.data("kendoGrid")
    .setDataSource(getKendoDataSource("ShipName", "asc"));
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:34:51.913

是的。可以通过[排序](http://docs.kendoui.com/api/framework/datasource#sort-array--objectdefault)设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T18:38:43.177

所以你想在它第一次读取数据之前设置排序？只需确保您的 ui 控件上有 autobind: false ，然后在数据源上设置排序属性，然后在准备好获取排序数据时调用 datasource.read() 。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-29T11:09:16.530

我知道你正在努力实现什么。我必须这样做，因为我们正在保存用户排序和过滤（在我的情况下是客户端），并且由于其他原因我们不能使用网格函数*getOptions/setOptions*。即使你设置**了 autobind:false**这也不会像你期望的那样工作，如果你看到 autobind 的定义：

[http://docs.telerik.com/kendo-ui/api/javascript/ui/grid#configuration-autoBind](http://docs.telerik.com/kendo-ui/api/javascript/ui/grid#configuration-autoBind)

*如果设置为 false，则小部件在初始化期间不会绑定到数据源。在这种情况下，数据绑定将在触发数据源的更改事件时发生。默认情况下，小部件将绑定到配置中指定的数据源。*

当您执行**dataSource.sort()**时，这会触发一个**更改**事件，然后隐式地在 dataSource 中完成**读取**（这就是您有第二个服务器读取的原因）。

因此，您需要做的是创建一个具有所需排序选项的新数据源，然后显式调用**dataSource.read()**。

例如（您可以扩展默认选项以不重复配置）：

```
var options = $.extend({}, dataSourceOptions);
options.sort = [
        {field: "field_1", dir: "asc"},
        {field: "field_2", dir: "asc"}
    ];
var dataSource = new kendo.data.DataSource(options);
grid.setDataSource(dataSource);
grid.dataSource.read(); 
```

希望这有帮助。问候！

# java - 当另一个人的行被调整大小时，调整 JTextPane 的行的大小

> ID：13863113
> 
> 赞同：1
> 
> 时间：2012-12-13T15:30:14.830
> 
> 标签：java, swing, resize, line, jtextpane

我有一个`JTextPane`(1) 和另一个在它旁边 (2)。我已经同步了它们，如果在（2）中输入了一行，则在（1）中输入了一行，但是当我插入图像（24px）时，（2）会自动调整行长但（1）不会当然调整大小。

如何制作“当（2）调整大小时，调整（1）”的方法？

我试过在（2）中插入图像时，在（1）中插入黑色图像（1px，24px），但问题是如果在（2）中插入了很多图像，它们会转到新行，其中 (1) 只是将它们添加到一行， (1) 获得一个水平滚动条。对不起，我不能让它更短...

```
public class SSCCE extends JFrame {

    private JPanel contentPane;
    int wrapme=0;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    SSCCE frame = new SSCCE();
                    frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public SSCCE() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 450, 338);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        setContentPane(contentPane);
        contentPane.setLayout(null);

        JScrollPane scrollName = new JScrollPane();
        scrollName.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_NEVER);
        scrollName.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        scrollName.setBounds(10, 11, 99, 207);
        contentPane.add(scrollName);

        final JTextPane name = new JTextPane();

        name.setEditable(false);
        scrollName.setViewportView(name);

        JScrollPane scrollChat = new JScrollPane();
        scrollChat.setBounds(114, 11, 310, 207);
        contentPane.add(scrollChat);

        final JTextPane chat = new JTextPane();
        chat.setText("Enter something!");
        chat.setEditable(false);
        scrollChat.setViewportView(chat);
        scrollChat.getVerticalScrollBar().setModel(scrollName.getVerticalScrollBar().getModel());

        final JTextArea chatEnter = new JTextArea();
        chatEnter.setBounds(10, 229, 414, 60);
        contentPane.add(chatEnter);

        final StyledDocument nameDoc = name.getStyledDocument();
        final StyledDocument chatDoc = chat.getStyledDocument();
        final SimpleAttributeSet right = new SimpleAttributeSet();
        StyleConstants.setForeground(right, Color.GRAY);
        StyleConstants.setAlignment(right, StyleConstants.ALIGN_RIGHT);
        nameDoc.setParagraphAttributes(0, nameDoc.getLength(), right, false);

        final String TEXT_SUBMIT = "text-submit";
        KeyStroke enter = KeyStroke.getKeyStroke("ENTER");
        InputMap input = chatEnter.getInputMap();
        ActionMap actions = chatEnter.getActionMap();
        input.put(enter, TEXT_SUBMIT);
        actions.put(TEXT_SUBMIT, new AbstractAction() {
             @Override
             public void actionPerformed(ActionEvent e) {
                 try {
                    String s = chatEnter.getText();
                    s=s.replaceAll(":\\)", ":\\) ");
                    s=s.replaceAll("  ", " ");
                    //new line in name
                    String text = chatDoc.getText(0, chatDoc.getLength());
                    int count = 1;
                    int i = text.indexOf("\n");
                    while(i>=0){
                        count++;
                        i=text.indexOf("\n", i + 2);
                    }
                    int totalCharacters = chat.getText().length(); 
                    int lineCount = (totalCharacters == 0) ? 1 : 0;

                    try {
                       int offset = totalCharacters; // arbitrary non-zero number
                       while (offset > 0) {
                        offset = Utilities.getRowStart(chat, offset) - 1;
                        lineCount++;
                       }
                    } catch (BadLocationException ex) {
                        ex.printStackTrace();
                    }
                    lineCount-=wrapme;
                    while(count!=lineCount) {
                        nameDoc.insertString(nameDoc.getLength(), "\n", right);
                        count++;
                        wrapme++;
                    }
                    //new line in name End
                    nameDoc.insertString(nameDoc.getLength(), "Martin\n", right);
                    chatDoc.insertString(chatDoc.getLength(), s + "\n", null);
                    chat.select(chatDoc.getLength(), chatDoc.getLength());
                    name.select(nameDoc.getLength(), nameDoc.getLength());
                } catch (BadLocationException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
             }
        });

        ((AbstractDocument) chat.getDocument()).addDocumentListener(new DocumentListener() {
            @Override
            public void insertUpdate(final DocumentEvent de) {
                SwingUtilities.invokeLater(new Runnable() {
                    public void run() {
                        try {
                            StyledDocument doc = (StyledDocument) de.getDocument();
                            int start = Utilities.getRowStart(chat, Math.max(0, de.getOffset() - 1));
                            int end = Utilities.getWordStart(chat, de.getOffset() + de.getLength());

                            String text = doc.getText(start, (end - start)+1);

                                int i = text.indexOf(":)");
                                while (i >= 0) {
                                    final SimpleAttributeSet attrs = new SimpleAttributeSet(doc.getCharacterElement(start + i).getAttributes());
                                    if (StyleConstants.getIcon(attrs) == null) {
                                                StyleConstants.setIcon(attrs, new new ImageIcon(ChatFrame.class.getResource("/smile.png")));

                                        doc.remove(start + i, 2);
                                        doc.insertString(start + i, ":)", attrs);

                                        StyleConstants.setIcon(attrs, new ImageIcon(ChatFrame.class.getResource("/spacer.png")));
                                        nameDoc.insertString(nameDoc.getLength()-6," ", attrs); //6 is "Martin" length

                                    }
                                    i = text.indexOf(":)", i + 2);
                                }
                        } catch (BadLocationException ex) {
                            ex.printStackTrace();
                        }
                    }
                    });
                }
            @Override
            public void removeUpdate(DocumentEvent e) {
            }

            @Override
            public void changedUpdate(DocumentEvent e) {
            }
        });
    }
} 
```

微笑.png [http://postimage.org/image/vm7e4gvp1/](http://postimage.org/image/vm7e4gvp1/) spacer.png [http://postimage.org/image/k0q09iq6l/](http://postimage.org/image/k0q09iq6l/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T07:18:45.117

对于发送的每条消息，最好使用一个主要`JTextPane`（聊天）和多个单独`JTextPanes`的（甚至标签）。然后，您可以控制单个消息标签（或文本窗格），将它们设置为所需的高度。

可以通过将消息开始和结束偏移量传递给`modelToView()`方法并计算差异来计算高度。

# c# - 显示项目在列表中的位置

> ID：13863114
> 
> 赞同：0
> 
> 时间：2012-12-13T15:30:16.580
> 
> 标签：c#

我正在使用链接列表。`BtnAddTree`我的构造函数采用其中包含项目的数组或通过单击将一个项目（一次一个）附加到列表中。出于实验原因，我试图找出一种从列表中检索项目位置的方法。我已经设置了三个希望显示的按钮：`first`, `next`, `last`item 和 display through a `label`。我创建了两个函数来满足我的需要`Retrieve`，`Current_Tree()`但在这里我走到了死胡同。我知道要显示`next`我可能需要使用循环但不确定如何进行的项目。如何显示在列表中找到的项目的位置？

```
 public class ListForTrees
        {

        //Retrieve Position of item
            public void Retrieve(int Position)
            {
                int new_position = Position;
                fruit_trees current = first_tree;

                for (int i = 0; i < Position && current != null; i++)
                {
                    current = current.next_tree;
                }
                return current;
            }

        //Show Current Tree
            public void Current_Tree()
            {
                try
                {
                    current = fruit_trees.first_tree;
                    labelSpecificTree.Text = current.Type.ToString();
                }
                catch { };

            }         

        }

        ListForTrees mainlist = new ListForTrees();     

        private void BtnGo_Click(object sender, EventArgs e)
        {
            fruit_trees[] ax = {   new fruit_trees("cherry", 48, 12.95, 3),
                                             new fruit_trees("pine", 36, 9.95, 8),
                                             new fruit_trees("oak", 60, 14.95, 2),
                                             new fruit_trees("peach", 54, 19.95, 3),
                                             new fruit_trees("pear", 36, 11.85, 2),
                                             new fruit_trees("apple", 62, 13.45, 5)
                                         };   
            mainlist = new ListForTrees(ax);
            fruit_trees current = mainlist.first_tree;   

            while (current != null)
            {
                TxtOutput.AppendText(current.ToString() + Environment.NewLine);
                current = current.next_tree;
            }
        }

        private void ShowNextItem_Click(object sender, EventArgs e)
        {
        //Show Next Item
        }

        private void ShowLastItem_Click(object sender, EventArgs e)
        {
        //Show Last Item
        }

        private void ShowFirstItem_Click_1(object sender, EventArgs e)
        {
        // Show First Item
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:00:25.497

开发一种正确比较对象的方法。树类型是唯一的吗？也许你需要一个完全无与伦比的？

然后在 listoftrees 类中创建一个方法

```
public int getPosition(fruit_trees tree)
{
 fruit_trees ft = first_tree;
 if(ft.tree_type == tree.tree_type)
 {
      return 0; //or return 1 depending on how you want to index stuff
 }
 int i = 1;//possibly set to 2 if returning 1 above
 while(ft.next_tree != null)
 {
     ft = ft.next_tree;
     if(ft.tree_type == tree.tree_type)
     {
        return i; 
     }
     i++;
 }

 return -1; //or something else here to show that its not in the list

} 
```

也作为旁注..不要在方法 Current_Tree() 的类中设置标签值。那应该返回一个 fruit_trees 对象，并且 btn click 方法应该设置标签值。

您实际上应该完全摆脱该方法（除非在上面的代码之外有某种原因。

# solr - Solr 高亮是否还可以指示返回的片段在原始字段中的位置或偏移量？

> ID：13863118
> 
> 赞同：6
> 
> 时间：2012-12-13T15:30:31.257
> 
> 标签：solr, highlighting

**背景**

使用 Solr 4.0.0。我已经索引了一组示例文档的文本并启用了术语向量，因此我可以使用快速向量突出显示

```
<field name="raw_text" type="text_en" indexed="true" stored="true" termVectors="true" termPositions="true" termOffsets="true" /> 
```

为了突出显示，我使用了带有 SENTENCE 边界的 Break Iterator Boundary Scanner。

```
<boundaryScanner name="breakIterator" class="solr.highlight.BreakIteratorBoundaryScanner">
    <lst name="defaults">
      <!-- type should be one of CHARACTER, WORD(default), LINE and SENTENCE -->
      <str name="hl.bs.type">SENTENCE</str>
    </lst>
  </boundaryScanner> 
```

我做一个简单的查询

```
http://localhost:8983/solr/documents/select?q=raw_text%3AArtibonite&wt=xml&hl=true&hl.fl=raw_text&hl.useFastVectorHighlighter=true&hl.snippets=100&hl.boundaryScanner=breakIterator 
```

突出显示效果很好

```
<response>
...
<result name="response" numFound="5" start="0">
<doc>
  <str name="id">-1071691270</str>
  <str name="raw_text">
     Final Report of the Independent Panel of Experts on the Cholera
     Outbreak in Haiti Dr. Alejando Cravioto (Chair) International
     Center for Diarrhoeal Disease Research, Dhaka, Bangladesh Dr.
     Claudio F. Lanata Instituto de Investigación Nutricional, and
     The US Navy Medical Research Unit 6, Lima, Peru Engr. Daniele
     S. Lantagne Harvard University... ~SNIP~
  </str>
<doc>
<lst name="highlighting">
  <lst name="-1071691270">
    <arr name="raw_text">
      ...
      <str>
        The timeline suggests that the outbreak spread along
        the <em>Artibonite</em> River. After establishing that
        the cases began in the upper reaches of the Artibonite
        River, potential sources of contamination that could have
        initiated the outbreak were investigated.
      </str>
      ...
    </arr>
  </lst>
</lst> 
```

**问题**

我希望能够发送生成的句子以进行进一步处理（实体提取等），但我想跟踪原始（长）文本字段中突出显示的句子的开始/结束偏移量。*有没有直接的方法来做到这一点？*

将 hl.fragsize 设置为返回整个字段然后以这种方式处理/提取感兴趣的句子会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T12:58:21.560

除了进行某种自定义之外，没有办法返回带有突出显示结果的片段的偏移信息。

你似乎有几个选择：

1) 您可以通过创建将偏移信息编码到字符串中的自定义格式化程序来扩展 Solr 荧光笔。`TokenGroup`为每个术语传递给 Formatter 的将具有存储在其中的偏移量和位置信息。如果您的格式化程序返回 a`<span data-offset=X>text</span>`或类似的东西，那将是一种方法。这似乎不是*最直接*的。

2）正如你所说，使用返回整个字段`hl.fragsize=0`。

3)在附加请求中使用[TermVectorsComponent并将从它返回的偏移/位置信息与突出显示的片段映射。](http://wiki.apache.org/solr/TermVectorComponent)

如果您无论如何都在进行自己的分片，那么对您来说最好的解决方案可能是在 Solr 中进行 0 分片并自己处理。或者，您可以`BoundaryScanner`在 Java 中实现您自己的实现，以使用您自己在实体提取方面的特殊知识来分解片段。

# javascript - jQuery.on() 不工作

> ID：13863121
> 
> 赞同：0
> 
> 时间：2012-12-13T15:30:41.387
> 
> 标签：javascript, jquery

当点击事件触发时，我正在尝试更改我的 wordpress 灯箱插件中的一些内容。灯箱本身是在页面加载后注入的，所以我必须使用`on()`.

标头中的 Javascript：

```
jQuery(document).ready(function(){
    jQuery("body").on("click", "#lightbox img", function() { 
        alert("t");
    });
}); 
```

我从来没有见过`alert`. 我尝试将`#lightbox img`选择器更改为`div`，但仍然没有。

编辑：我在 chrome 控制台上没有收到任何错误，并修复了语法错误，这是由于删除了对问题无用的函数引起的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:32:34.567

### 语法错误

```
jQuery(document).ready((function){
----------------------^---------^
jQuery("body").on("click","#lightbox img",(function(){alert("t");});
------------------------------------------^ 
```

1.  在第二个大括号之后移动第一个大括号！
2.  为什么有一个开括号？去掉它！

### 让我发布正确的代码：

```
jQuery(document).ready(function() {
    jQuery("body").on("click", "#lightbox img", function() {
        alert("t");
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:32:56.767

更正你的语法。您有 2 个不必存在的牙套

```
jQuery(document).ready((function){
 ----------------------^
"#lightbox img", (function() { 
 ----------------^ 
```

它应该是

```
jQuery(document).ready(function() {
    jQuery("body").on("click", "#lightbox img", function() {
        alert("t");
    });
}); 
```

# android - 通过使用 DownloadManager，我如何从我的设备上查看所有活动/正在运行的下载？

> ID：13863124
> 
> 赞同：3
> 
> 时间：2012-12-13T15:30:47.797
> 
> 标签：android

通过使用 DownloadManager，我如何从我的设备上查看所有活动/正在运行的下载？

我的代码：

```
 DownloadManager.Query query = null;
        Cursor c = null;
        DownloadManager downloadManager = null;
        downloadManager = (DownloadManager)m_context.getSystemService(Context.DOWNLOAD_SERVICE);
        query = new DownloadManager.Query();
         if(query!=null) 
         {
                    query.setFilterByStatus(DownloadManager.STATUS_FAILED|DownloadManager.STATUS_PAUSED|DownloadManager.STATUS_SUCCESSFUL|
                            DownloadManager.STATUS_RUNNING|DownloadManager.STATUS_PENDING);
         } 
        c = downloadManager.query(query);
        if(c.moveToFirst()) 
        { 
            int status = c.getInt(c.getColumnIndex(DownloadManager.COLUMN_STATUS)); 
            switch(status) 
            { 
            case DownloadManager.STATUS_PAUSED: 
            break; 
            case DownloadManager.STATUS_PENDING: 
            break; 
            case DownloadManager.STATUS_RUNNING: 
            break; 
            case DownloadManager.STATUS_SUCCESSFUL: 
            break; 
            case DownloadManager.STATUS_FAILED: 
            break; 
            }
        } 
```

它在 c.moveToFirst() 函数上失败（返回 false）；

DownloadManager 是否要求一些特殊的权限？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T16:25:37.863

[下载管理器](http://developer.android.com/reference/android/app/DownloadManager.html)文档说：

> 请注意，应用程序必须具有 INTERNET 权限才能使用此类。

我的测试应用程序只有**android.permission.INTERNET**并且很好地添加了下载请求。

```
 // FILL request object
            Uri uri =  Uri.parse( "http://mysite.com/myfile");
            DownloadManager.Request request=new DownloadManager.Request(uri);
            request.setAllowedNetworkTypes(DownloadManager.Request.NETWORK_WIFI | DownloadManager.Request.NETWORK_MOBILE)
                    .setAllowedOverRoaming(false)
                    .setTitle("my title")
                    .setDescription("my description")
                    ;

            // ADD request to download manager
            DownloadManager dm=(DownloadManager)getSystemService(Context.DOWNLOAD_SERVICE);
            long id = dm.enqueue(request);

            // CHECK request by id
            Cursor c = dm.query( new DownloadManager.Query().setFilterById(id) );
            if( c.moveToFirst() ){
                int status = c.getInt(c.getColumnIndex(DownloadManager.COLUMN_STATUS)); 
                switch(status) 
                { 
                case DownloadManager.STATUS_PAUSED:
                break; 
                case DownloadManager.STATUS_PENDING:
                break; 
                case DownloadManager.STATUS_RUNNING:
                break; 
                case DownloadManager.STATUS_SUCCESSFUL:
                break; 
                case DownloadManager.STATUS_FAILED:
                break; 
                }
            } 
```

为了成功下载，还应该有互联网连接、设备存储空间等。无论如何，下载管理器应该尝试遵守下载请求并向用户解释其结果。

# gwt - GWT 问题从服务器获取文件

> ID：13863128
> 
> 赞同：1
> 
> 时间：2012-12-13T15:30:58.033
> 
> 标签：gwt

我在使用我在 weblogic 域的文件夹中创建的 csv 文件时遇到问题。我能够创建文件，但是单击一个按钮，我需要获取该文件并将其显示给用户

有人可以帮助mw吗pleaseeeee。在读取我在 weblogic 域目录中创建的 CSV 文件时遇到问题，但最终出现异常错误 404--未从 RFC 2068 超文本传输​​协议--HTTP/1.1：10.4.5 404 未找到

/testDomain/CSV

在代码片段下方

```
fileName = "CSV"+detailsMap.get("fileName").toString();
MessageBox.show(new MessageBoxConfig() {
                 {
setTitle("Alert");//Result

 // InputStream in = this.getClass().getClassLoader().getResourceAsStream(fileName); 
   //  final String file =in.toString();
    setMsg("Upload of Distribution Lists partially successful. Please acknowledge to find the failed entries");
   setButtons(MessageBox.OK);
   setWidth(250);
                                 setCallback(new MessageBox.PromptCallback() {
                             public void execute(String btnID, String text) {
                                 System.out.println("inside execute methoddd");
                                 Window.open(fileName, "_self",null);
                                 //Window.
            }
                         });
                }});` 
```

# javascript - 如何在 jQuery 中将滚动条放入手风琴菜单

> ID：13863130
> 
> 赞同：0
> 
> 时间：2012-12-13T15:31:07.130
> 
> 标签：javascript, jquery, css, jquery-ui

我正在建立一个手风琴菜单：

```
$(document).ready(function(){

  /* Cambiare l'effetto da utilizzare */
  $.easing.def = "easeOutBounce";

  /* Associare una funzione all'evento click sul link */
  $('li.title a').click(function(e){

    /* Finding the drop down list that corresponds to the current section: */
    var subMenu = $(this).parent().next();

    /* Trovare il sotto menu che corrisponde alla voce cliccata */
    $('.sub-menu').not(subMenu).slideUp('slow');
    subMenu.stop(false,true).slideToggle('slow');

    /* Prevenire l'evento predefinito (che sarebbe di seguire il collegamento) */
    e.preventDefault();
  })

}); 
```

有人知道如何将滚动条放入手风琴菜单吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:55:31.287

[这里](http://jsfiddle.net/L29r8/1/)的工作示例。

编码：

您只需要一个普通的手风琴并在此示例中设置溢出属性和高度：

```
p{
    height:80px;
    overflow-y:scroll;
} 
```

​</p>

# c# - 我真的应该在退出我的方法范围之前处理我的对象吗？

> ID：13863137
> 
> 赞同：2
> 
> 时间：2012-12-13T15:31:45.617
> 
> 标签：c#, .net

我的代码分析中出现**CA2000**错误，要求我在退出范围之前处置我的对象

> 在失去范围之前处置对象在方法“MyMethod(Guid?)”中，在对对象“person”的所有引用超出范围之前调用 System.IDisposable.Dispose。

我对这条规则感到惊讶，因为我认为 dispose 在退出范围时会自动运行。注意： 已经提出[了类似的问题，并确认我的意见是不要强制执行处置程序。](https://stackoverflow.com/q/2313196/196526)

如果我不处置我的对象并且我不在 using 指令中使用它会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:35:51.600

Dispose 永远不会被自动调用。你必须显式调用它，或者使用'using'关键字至少，如果你不处理你的对象，它可能由垃圾收集器完成，但前提是你实现了正确的模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:36:44.363

如果您已将对象包装在`using`语句中，则可以，因为它将被翻译成。

```
try{
    var myObject = new MyObject();
}finally{
    myObject.Dispose();
} 
```

*更新*

如果您不处置您的对象，它*“可能永远留在内存中”*保留附加的资源。但可能不会。当它试图清除它时，它取决于垃圾收集器。但要注意 GC**只能清除托管资源**。

在这里寻找类似的问题：[如果我不在笔对象上调用 Dispose 会发生什么？](https://stackoverflow.com/questions/4267729/what-happens-if-i-dont-call-dispose-on-the-pen-object)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T15:38:52.187

> 我认为 dispose 在退出范围时会自动运行。

没有*任何*作用域，只有`using`块作用域。退出方法与退出`using`块不同。

如果一个对象实现了`IDisposable`，那么你应该总是手动或通过一个`using`块来处理它。何时执行此操作取决于您的代码结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T15:36:16.440

当对象超出范围时不调用 Dispose。在许多情况下，当垃圾收集对象时会调用它（当实现 Finalizer 并在其中调用 Dispose 时）。

# android - 在 libgdx 中使 Image 可触摸的最简单方法是什么？

> ID：13863138
> 
> 赞同：8
> 
> 时间：2012-12-13T15:31:47.100
> 
> 标签：android, libgdx

这是我的代码：

```
@Override
public void resize(int width, int height) {
super.resize(width, height);

stage.clear();

// background image
Image backImage = new Image(backTexture);
backImage.setX(0);
backImage.setY(0);
backImage.setWidth(800);
backImage.setHeight(480);

// start game image
Image startImage = new Image(startTexture);
startImage.setX(415);
startImage.setY(180);
startImage.setWidth(323);
startImage.setHeight(69);

stage.addActor(backImage);
stage.addActor(startImage);
} 
```

我正在创建简单的游戏，这就是我创建主菜单的方式。我想让我的 startImage 可触摸（可点击），因为 Image 类没有可用的侦听器。我该怎么做？还是使用 ImageButton 更好？这样我就必须创建图像图集，这对我来说似乎有点复杂..

编辑：我试过以下：

```
startImage.addListener(new ClickListener() {
    public boolean touchDown(InputEvent event, float x, float y, int pointer, int button)
    {
        game.setScreen(new SplashScreen(game));
        return true;
    }
}); 
```

但是还是不行。。

编辑：

```
Gdx.input.setInputProcessor(stage); 
```

需要调用。解决了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-13T19:08:43.513

解决方案是调用以下内容：

```
Gdx.input.setInputProcessor(stage); 
```

# c# - REST Web 服务的 WCF 客户端 - 几次请求后失败

> ID：13863140
> 
> 赞同：1
> 
> 时间：2012-12-13T15:31:53.790
> 
> 标签：c#, wcf, rest, iis

我创建了一个 wcf 服务并将其托管在 IIS 中，到目前为止它运行良好。

现在我有记录列表，我循环遍历所有记录并使用我的 WCF 休息服务将它们发送到我的 bll。它很好地满足了两个请求，但是在第三个请求中它抛出 Time Out Exception 并将责任归咎于我在 BLL 中的一个方法。

如果方法有任何缺陷，那么它也不应该处理前两条记录。

我不知道 IIS 或 WCF 服务中是否有任何设置阻止了如此频繁的请求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:52:56.073

在配置文件中有一个选项，您可以在其中指定客户端等待服务响应的时间。如果服务在该时间之前没有响应，则会发生 TimeOut 异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:50:38.777

完成通话后，请确保关闭与服务的连接。您可以通过 HTTP 从您的机器到服务的默认连接数是 2。如果您在完成后不关闭连接，您的第三个连接将等待轮到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T18:33:01.490

试试这个...

在您的配置文件中，添加

```
<serviceHostingEnvironment minFreeMemoryPercentageToActivateService="0"/> 
```

在下面

钱达纳

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T06:49:27.160

我们必须增加我们可以建立的并行连接的数量。

配置文件中的设置将是这些

```
 <system.net>
    <connectionManagement>
      <add maxconnection="65535" address="*"/>
    </connectionManagement>    
  </system.net> 
```

# c++ - 派生QPainterPath，QPainter性能下降很快

> ID：13863142
> 
> 赞同：0
> 
> 时间：2012-12-13T15:32:07.227
> 
> 标签：c++, qt, qpainter

我目前正在尝试将我的 QPainter 对象封装到可重用的类中，可能是相互派生的。这使他们能够以任何他们喜欢的方式改变画家，有自己的孩子来画画等：

我`DrawArc`来源于`QPainterPath`

```
DrawArc::DrawArc() : QPainterPath()
{}

void DrawArc::paint(QPainter* painter)
{
    painter->save();
    //...
    arcTo(/*...*/);
    lineTo(/*...*/);
    painter->translate(QPoint(100,100));
    painter->drawPath(*dynamic_cast<QPainterPath*>(this));
    painter->restore();
} 
```

并`DrawBeam`衍生自`DrawArc`

```
DrawBeam::DrawBeam() : DrawArc()
{}

void DrawBeam::paint(QPainter* painter)
{
    painter->save();
    //...
    painter->setPen(QPen(color, 4));
    painter->setBrush(brush);
    DrawArc::paint(painter);
    painter->restore();
} 
```

在实际的小部件中，我正在执行以下操作

```
BeamWidget::BeamWidget(QWidget* parent) : QWidget(parent)
{
    DrawBeam* mybeam = new DrawBeam();
}

void BeamWidget::paintEvent(QPaintEvent * /* event */)
{
    QPainter painter(this);
    painter.setRenderHint(QPainter::Antialiasing, true);

    mybeam->paint(&painter);
} 
```

但是，我在`painter->drawPath(*dynamic_cast<QPainterPath*>(this));`几秒钟（或几百次重绘）后看到了巨大的性能损失。其余过程中的其他所有内容似乎都运行良好，但是当我启用该行时，性能会迅速下降。

此外，所有源自`DrawArc`绘画的元素似乎有时会失去其 QBrush 样式并保持可见，即使`setAutoFillBackground(true);`已设置...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T09:38:40.327

我发现这与我只创建一次对象有关，然后`arcTo`在**每次运行`paint()`**. 由于我无法刷新 QPainterPath，因此路径变得越来越长，越来越长。

这解释了为什么旧线没有被刷新以及为什么刷子是交替的（每次我重新绘制相同的东西时，我都会与路径本身形成一个新的交叉点，设计上没有被填充）。

我这样修复它：

```
void DrawArc::paint(QPainter* painter)
{
    painter->save();
    //...

    QPainterPath path = QPainterPath(*this);
    path.arcTo(/*...*/);
    path.lineTo(/*...*/);

    painter->translate(QPoint(100,100));
    painter->drawPath(path);
    painter->restore();
} 
```

因此，在每个绘图操作中，我都会创建当前路径的副本，添加我需要的所有线条并绘制那个。退出后`paint`，该绘制的路径将被丢弃。

# c# - 将不需要的字符发送到数组末尾

> ID：13863144
> 
> 赞同：0
> 
> 时间：2012-12-13T15:32:13.547
> 
> 标签：c#, arrays, regex, char

假设我们有一个字符串

```
String data = "<span> 0397]);}}:;)]</span>"; 
```

然后我们将它发送到一个 char 数组中

```
Char[] charData = data.ToCharArray(); 
```

我如何处理这些数据并将所有不需要的数据替换到数组的末尾，但将所有数据从当前已移动的字符中移出一个，以便在末尾为不需要的数据腾出空间。

```
Char[] sendToEnd = { ';', ')', '}', ']' }; 
```

我尝试了一个循环，但是当它遍历已经交换的数据时会导致无限循环。

最后字符串数据应该是

```
"<span> 0397</span>]);}}:;)]" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:39:59.453

```
var str = new String(data.Where(c => !sendToEnd.Contains(c))
                         .Concat(data.Where(c => sendToEnd.Contains(c)))
                         .ToArray()); 
```

也声明`sendToEnd`为

```
var sendToEnd = new HashSet<char>(new char[] { ';', ')', '}', ']' }); 
```

可以提供更好的表现

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:36:34.053

不是最初将字符移动到末尾，而是将它们移动到另一个数组并连接数组以形成最终字符串。

# parallel-processing - 在矩阵 MPI 中查找最小值和最大值

> ID：13863145
> 
> 赞同：0
> 
> 时间：2012-12-13T15:32:17.160
> 
> 标签：parallel-processing, mpi

我对 MPI 的东西真的很陌生。我只需要完成我的大学任务。有人可以帮助我吗？

任务是在 N*M 矩阵中找到最小值和最大值。进程计数必须等于 N。我尝试使用最小值和最大值来查找，`MPI_Reduce`但我得到错误结果。这是我的代码。

```
#include  <mpi.h>
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

const int n = 5;
const int m = 4;

void fill_matrix_randomly(int matrix[n][m], int max_value);
void write_matrix(int matrix[n][m]);
int find_max(int* vector, int vector_size);
int find_min(int* vector, int vector_size);
void write_vector(int* vector, int vector_size);

int main(int argc, char* argv[])
{
    int my_rank = 0;
    int comm_size = 0;

    int a[n][m];
    int receive_buffer[m];
    int partial_max[m];
    int partial_min[m];

    MPI_Init(&argc, &argv);

    MPI_Comm_rank(MPI_COMM_WORLD, &my_rank);
    MPI_Comm_size(MPI_COMM_WORLD, &comm_size);

    if (comm_size != n)
    {
        printf("Please set process count = %d and run again.", n);
        MPI_Finalize();
        return 0;
    }

    if (my_rank == 0)
    {
        fill_matrix_randomly(a, 10);
        write_matrix(a);    
    }
    /* MPI Scatter(address of send buffer, number of elements sent to each process, data type of send buffer, address of receive buffer, number of elements in receive buffer, data type of receive buffer, rank of sending process, communicators space) */
    MPI_Scatter(a, n, MPI_INT, receive_buffer, n, MPI_INT, 0, MPI_COMM_WORLD);
    /* MPI_Reduce(address of send buffer, address of receive buffer, number of elements in send buffer, data type of elements in send buffer, reduce operation, rank of root process, communicators space) */
    MPI_Reduce(receive_buffer, partial_max, n, MPI_INT, MPI_MAX, 0, MPI_COMM_WORLD);
    MPI_Reduce(receive_buffer, partial_min, n, MPI_INT, MPI_MIN, 0, MPI_COMM_WORLD);
    if (my_rank == 0)
    {
        printf("Vector of partial max values.\n");
        write_vector(partial_max, n);
        printf("Vector of partial min values.\n");
        write_vector(partial_min, n);

        int max = find_max(partial_max, n);
        int min = find_min(partial_min, n);
        printf("Matrix boundaries = [%d..%d]\n", min, max);
    }
    MPI_Barrier(MPI_COMM_WORLD);
    MPI_Finalize();

    return 0;
}

int find_max(int* vector, int vector_size)
{
    int max = vector[0];
    int i = 0;  
    for (i = 0; i < vector_size; i++)
    {
        if (vector[i] > max)
        {
            max = vector[i];
        }       
    }
    return max;
}

int find_min(int* vector, int vector_size)
{
    int min = vector[0];
    int i = 0;
    for (i = 0; i < vector_size; i++)
    {
        if (vector[i] < min)
        {
            min = vector[i];
        }
    }
    return min;
}

void fill_matrix_randomly(int matrix[n][m], int max_value)
{
    int i = 0;
    int j = 0; 
    srand(time(NULL));
    for (i = 0; i < n; i++)
    {
        for (j = 0; j < m; j++)
        {
            matrix[i][j] = rand() % max_value;
        }
    }   
}

void write_matrix(int matrix[n][m])
{
    int i = 0;
    int j = 0;
    for (i = 0; i < n; i++)
    {
        for (j = 0; j < m; j++)
        {
            printf("%4d", matrix[i][j]);            
        }
        printf("\n");
    }
}

void write_vector(int* vector, int vector_size)
{
    int i = 0;
    for (i = 0; i < vector_size; i++)
    {
        printf("vector[%d] = %d\n", i, vector[i]);
    }
} 
```

这是输出。

```
$ mpiexec -n 5 ./main
   8   1   3   9
   1   0   3   1
   4   9   5   5
   1   7   4   9
   8   5   7   4
Vector of partial max values.
vector[0] = 9
vector[1] = 8
vector[2] = 5
vector[3] = 9
vector[4] = 16
Vector of partial min values.
vector[0] = -1
vector[1] = -1
vector[2] = -1
vector[3] = -1
vector[4] = 1
Matrix boundaries = [-1..16] 
```

我哪里错了？我应该改变什么？我整天都在寻找解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:54:13.483

您的矩阵是`n`逐`m`列的。当您将此矩阵分配给`n`进程时，每个进程都必须处理`m`元素，但您`n`在所有向量调用中使用计数。你应该传递一个长度`m`：

*   `MPI_Scatter`通话；
*   两个`MPI_Reduce`电话；
*   两个`write_vector`电话；
*   和`find_max`调用`find_min`。

请注意，您已正确地将,`receive_buffer`声明为元素。`partial_max``partial_min``m`

# c++ - 无法保存结构内容

> ID：13863146
> 
> 赞同：1
> 
> 时间：2012-12-13T15:32:18.570
> 
> 标签：c++, vector, struct

我有下一个问题：我创建了结构：

```
struct Series : vector<Candle>
{ 
 Security Sec;
 int LookFor;
 int TF;
 int Corrector;
 string ID;
 int line;
 Series(){};
 Series (int _lookfor);
 void Update();  
}; 
```

构造函数：

```
Series::Series (int _lookfor)
{
 LookFor=_lookfor;
 for (int i = 1; i<=LookFor; i++)
  {
    Candle cantype = Candle(i);
    push_back(cantype);
  }
} 
```

因此，我们称这个构造函数为它用蜡烛值填充对象。LookFor - 是向量系列中的许多蜡烛。初始化后我想更新这个系列（如果有更多新蜡烛，我想删除最后一个并在矢量系列的开头插入新的）

```
void Series::Update()
{
if (size()==LookFor)
{
        if (newer(cantype,c1))
        {
          Candle cantype = Candle(1);
          Candle c1 = at(0);
          pop_back();
          emplace(begin(),cantype);
        }
} 
```

我需要初始化这些系列的向量：

向量向量；vec.push_back(系列(3));

构造函数完成了它的工作，一切都很好。但后来我更新了它们：

```
for (size_t x =0; x<=size()-1;x++) vec[x].Update(); 
```

我有一个问题：它无法保存向量中的更改。在 Update 方法中一切都很好，它在自身中插入所需的蜡烛，但随后方法结束 - 向量的状态（vec 的每个元素）没有变化。在方法中我们看到了变化，但是在它的向量变成了类似构造函数之后，状态还是一样的。请告诉我，我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:18:10.983

*   正如其他人已经提到的，不要从这些容器中派生（可能会导致令人讨厌的错误，例如缺少 dtor 调用和内存泄漏，这些容器中不存在虚拟析构函数）。相反，如果您进行私有继承，请将向量添加为成员或保持原样。

*   您可以对此类容器使用迭代器接口：

`for(std::vector<Series>::iterator sIt = vec.begin();sIt != vec.end();++sIt) sIt->Update();`

*   对于您的任务，请考虑使用双端队列或列表作为循环缓冲区，而不是蜡烛的向量。它在插入时会表现得更好，因此允许您使用`push_front()`而不是`emplace()`or `insert()`。或者，您可以在最后一个元素（应该是第一个元素）之后保存向量元素的索引，然后分配新的蜡烛，等等，您就有了一个密集的循环缓冲区。有这种循环缓冲区的实现，例如 boost 之一：http: [//www.boost.org/doc/libs/1_52_0/libs/circular_buffer/doc/circular_buffer.html](http://www.boost.org/doc/libs/1_52_0/libs/circular_buffer/doc/circular_buffer.html)

尽管存在逻辑问题，这可能会阻止在某些状态下进行修改，但我看不出为什么您的代码根本不起作用，至少在我浏览您发布的片段时没有。

# security - Breeze.js - 保护 IQueryable 调用

> ID：13863148
> 
> 赞同：6
> 
> 时间：2012-12-13T15:32:25.970
> 
> 标签：security, iqueryable, breeze

我对此很陌生，但我已经开始了解使用 Breeze 公开 IQueryable<> 的安全风险。有人可以向我建议一些最佳实践（或仅仅是一些建议）来保护在 JavaScript 中公开的 IQueryable 集合吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T19:38:25.553

我不会通过 IQueryable 公开任何应该通过随机查询发送给客户端的数据。因此，可以暴露投影或 DTO。

我不确定这是否能回答您的问题……您担心什么“安全风险”？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T17:43:12.617

我也支持这个问题。但是要在 Ward 提出的问题中添加一些细节：

在保护可查询服务时，会想到两个传统问题：

1) 垂直安全性：当前登录的用户（基于用户身份或角色）不允许在 UI 中看到哪些项目。那些需要从可查询列表中删除。IMO，这可以通过在返回的 IQueryable 上链接一些排除逻辑来作为可查询 ActionFilter 魔术的一部分来完成。2) 横向安全性：某些模型包含不适合登录用户查看（和/或编辑）的字段。这更难处理，因为这不仅仅是从返回的 IQueryable 中删除实例的问题。返回的类具有不同的形状，因此可以通过 json 格式化程序处理基于安全性（AFAIK 搞砸了微风元数据）的字段，或者在这种情况下返回 DTO，因为元数据中不存在 DTO它' s 不是一个完整的生命周期（可更新）类？（我问这个不是说明它）

我希望看到内置支持或易于实施的 2 号食谱）。也许一些示例代码可以修改客户端元数据，以使 DTO 与模型对象完美结合。newset VS 2012 SPA 模板（在 TodoList 应用程序中）似乎在可查询和插入/更新端推送模型对象的 DTO 变体。这类似于传统的 MVC 模型视图......

最后 - 我会添加一个请求以自动处理插入和更新的过度发布安全问题。这是 2) 的倒数。某些用户不应该能够编辑某些字段。

# wpf - MVVMCross 和 Prism 组合

> ID：13863152
> 
> 赞同：5
> 
> 时间：2012-12-13T15:32:34.353
> 
> 标签：wpf, prism, mvvmcross

我一直在考虑在开发我们的下一代软件时采用 MvvmCross，主要是为了为其开发平板电脑 UI。我知道 MvvmCross 目前不支持 WPF，但我可以看到我们自己正在开发并回馈它。

但是，我也注意到 MvvmCross 似乎很轻，因为对[Prism 指南](http://compositewpf.codeplex.com)中描述的复合 UI 的支持很少。不幸的是，我们确实需要允许更复杂的复合 UI 场景。

鉴于[https://stackoverflow.com/questions/10224376/mvvmcross-experiences-hindsight-limitations](https://stackoverflow.com/questions/10224376/mvvmcross-experiences-hindsight-limitations)中关于使用 MvvmCross 作为参考分叉或滚动自己的内容，并且鉴于我们确实需要比 MvvmCross 更复杂的 UI 场景提供，最好的行动方案是什么，分叉并重新实现我们需要的 prism 部分，尝试让 MvvmCross 与 Prism 一起工作，或者从 MvvmCross 和 MonoCross 的灵感中开发我们自己的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T16:50:02.827

更新：请参阅下面的第二个答案...

* * *

明天我可能需要写一个更长的答案...

作为初步答案：

*   有人已经将 MvvmCross 移植到 Silverlight，开发人员建议这可能会提供给更广泛的社区
*   MvvmCross 的 PCL 版本应该非常直接地移植到 WPF - 尽管如果需要较旧的 .Net 运行时版本可能不是
*   作为迄今为止 MvvmCross 的首席开发人员，我个人对支持 WPF 很感兴趣——尤其是现在我的项目[http://github.com/slodge/BallControl](http://github.com/slodge/BallControl)需要在桌面上运行（Windows 应用商店已瘫痪——呸！ )
*   MvvmCross 支持复合 UI - 例如选项卡、枢轴、全景图、拆分、模态子级等 - 但在 Prism 中常见的完整复合 UI 上还没有做太多工作。
*   我见过人们将 MvvmCross 与其他 IoC 框架结合起来，但是（据我所知，没有工作）迄今为止已经完成了将 MvvmCross 与 MEF（通常与 Prism 一起使用？）

如果我正在解决这个问题领域，那么我会这样做：

1.  确保我们首先尝试制作一个可以工作的应用程序——应用程序比框架更重要。
2.  对于框架，我会尝试首先移植基本的 IoC 设置和一些简单的导航
3.  对于自定义导航（用于在区域中显示 UI），我会查看演示者在 MvvmCross 中的角色 - 这是我在 Tab 示例、iPad 拆分视图示例等中使用的，以提供复杂的 UI 功能。
4.  如果这个自定义导航还不够，我会看看它是如何更改/替换/扩展的 - 我的*猜测*是 WPF/Prism 的真正要求实际上与更大的 iPad、Surface 和 Nexus 的真正要求非常相似平板电脑应用程序。
5.  我会尽量保持一切模块化和可选性，这样小型手机应用程序就不必引入大型应用程序可能需要的大型导航过程。这样做的缺点可能是很多项目和 DLL！
6.  我也愿意将这种拆分成单独的项目——现代软件世界的大部分是由小型目标应用程序而不是更大的、庞大的框架统治的。
7.  因为我是 Mvx 的兼职，而这是你的全职工作，我绝对建议你不要让 Mvx 阻碍你！

我最初的反应是“是的，我**真的**很想从事这个工作”——缺点（如上）是我只有空闲时间在 mvx 上......

* * *

这是第二个答案...

*   我以 MvvmCross 的 WinRT 版本为基础（但也使用了 Console、WP7、Touch 和 Droid 的元素）
*   我制作了 MvvmCross 的简单 WPF 版本 - [https://github.com/slodge/MvvmCross/tree/vnext/Cirrious/Cirrious.MvvmCross.Wpf](https://github.com/slodge/MvvmCross/tree/vnext/Cirrious/Cirrious.MvvmCross.Wpf)
*   这个版本的主要特点是它不包含太多的导航方式
    *   例如，不要尝试回拨！
    *   例如，主要`presenter`是留给应用程序 UI 实现的抽象 - 参见[https://github.com/slodge/MvvmCross/blob/vnext/Cirrious/Cirrious.MvvmCross.Wpf/Views/MvxWpfViewPresenter.cs](https://github.com/slodge/MvvmCross/blob/vnext/Cirrious/Cirrious.MvvmCross.Wpf/Views/MvxWpfViewPresenter.cs)

*   然后我使用了 TwitterSearch 演示应用程序 - [https://github.com/slodge/MvvmCross/tree/vnext/Sample%20-%20TwitterSearch/TwitterSearch.UI.Wpf](https://github.com/slodge/MvvmCross/tree/vnext/Sample%20-%20TwitterSearch/TwitterSearch.UI.Wpf)
    *   创建了一些简单的视图（使用 WP7 版本的 Xaml 的剪切和粘贴）
    *   创建了一个简单的基于区域的演示者 - 查看如何`RegionAttribute`在[https://github.com/slodge/MvvmCross/blob/vnext/Sample%20-%20TwitterSearch/TwitterSearch.UI.Wpf/MultiRegionPresenter.cs](https://github.com/slodge/MvvmCross/blob/vnext/Sample%20-%20TwitterSearch/TwitterSearch.UI.Wpf/MultiRegionPresenter.cs)和[https://中使用github.com/slodge/MvvmCross/blob/vnext/Sample%20-%20TwitterSearch/TwitterSearch.UI.Wpf/MainWindow.xaml.cs](https://github.com/slodge/MvvmCross/blob/vnext/Sample%20-%20TwitterSearch/TwitterSearch.UI.Wpf/MainWindow.xaml.cs)
    *   就是这样......给或花几个小时的调试

有一个关于这个的视频 - 有一些解释：http: [//youtu.be/pYkLxqpu_5E](http://youtu.be/pYkLxqpu_5E)

* * *

这显然只是 Wpf 支持的第一步，但我怀疑它已经满足了相当多的用例......请随时 fork 源代码树并扩展或替换第一次尝试。此外，如果它对您不起作用，请随意放弃它并尝试其他方法。

我会尝试在这方面做更多工作——但不能把它放在有偿工作之上……但我也愿意接受有偿在 mvvmcross 上工作:)

# java - 有效地从 java 字符串中提取数字（已经尝试过番石榴和正则表达式）

> ID：13863153
> 
> 赞同：4
> 
> 时间：2012-12-13T15:32:34.053
> 
> 标签：java, regex, string, guava, tokenize

试图有效地从字符串中提取一些数字并尝试过

*   java.util.regex.Matcher
*   com.google.common.base.Splitter

结果是：

*   通过正则表达式：24417 毫秒
*   通过谷歌拆分器：17730 毫秒

您可以推荐另一种更快的方法吗？

我知道之前问过类似的问题，例如[如何从 Java 中的字符串中提取多个整数？](https://stackoverflow.com/questions/12721261/how-to-extract-multiple-integers-from-a-string-in-java)但我的重点是让它快速（但可维护/简单），因为它经常发生。

* * *

**编辑：这是我的最终结果，与下面 Andrea Ligios 的结果一致：**

*   正则表达式（不带括号）：18857
*   Google Splitter（没有多余的 trimResults() 方法）：15329
*   Martijn Courteaux 回答如下：4073

* * *

```
import org.junit.Test;

import com.google.common.base.CharMatcher;
import com.google.common.base.Splitter;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Sample {

    final static int COUNT = 50000000;
    public static final String INPUT = "FOO-1-9-BAR1"; // I want 1, 9, 1

    @Test
    public void extractNumbers() {
        long startTime = System.currentTimeMillis();
        for (int i = 0; i < COUNT; i++) {
            // Output is list of 1, 9, 1
            Demo.extractNumbersViaGoogleSplitter(INPUT);
        }
        System.out.println("Total execution time (ms) via Google Splitter: " + (System.currentTimeMillis() - startTime));

        startTime = System.currentTimeMillis();
        for (int i = 0; i < COUNT; i++) {
            // Output is list of 1, 9, 1
            Demo.extractNumbersViaRegEx(INPUT);
        }
        System.out.println("Total execution time (ms) Regular Expression: " + (System.currentTimeMillis() - startTime));

    }
}

class Demo {

    static List<Integer> extractNumbersViaGoogleSplitter(final String text) {

        Iterator<String> iter = Splitter.on(CharMatcher.JAVA_DIGIT.negate()).trimResults().omitEmptyStrings().split(text).iterator();
        final List<Integer> result = new ArrayList<Integer>();
        while (iter.hasNext()) {
            result.add(Integer.parseInt(iter.next()));

        }
        return result;
    }
    /**
     * Matches all the numbers in a string, as individual groups. e.g.
     * FOO-1-BAR1-1-12 matches 1,1,1,12.
     */
    private static final Pattern NUMBERS = Pattern.compile("(\\d+)");

    static List<Integer> extractNumbersViaRegEx(final String source) {
        final Matcher matcher = NUMBERS.matcher(source);
        final List<Integer> result = new ArrayList<Integer>();

        if (matcher.find()) {
            do {
                result.add(Integer.parseInt(matcher.group(0)));
            } while (matcher.find());
            return result;
        }
        return result;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T15:44:41.287

这是一个非常快速的算法：

```
public List<Integer> extractIntegers(String input)
{
    List<Integer> result = new ArrayList<Integer>();
    int index = 0;
    int v = 0;
    int l = 0;
    while (index < input.length())
    {
        char c = input.charAt(index);
        if (Character.isDigit(c))
        {
            v *= 10;
            v += c - '0';
            l++;
        } else if (l > 0)
        {
            result.add(v);
            l = 0;
            v = 0;
        }
        index++;
    }
    if (l > 0)
    {
        result.add(v);
    }
    return result;
} 
```

这段代码在我的机器上运行了 3672 毫秒，用于“FOO-1-9-BAR1”和 50000000 次运行。我在 2.3 GHz 内核上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:50:01.907

编辑：为了知识，我在同一台（旧）机器上运行了不同的解决方案，迭代了 5000000 次（从 OP 问题中删除了一个零），结果如下：

> 通过 Martijn Courteaux 算法的总执行时间（毫秒）：2562
> 
> 通过 Char 比较的总执行时间（毫秒）：6891
> 
> 总执行时间（毫秒）正则表达式（带括号）：12937
> 
> 总执行时间（毫秒）正则表达式（不带括号）：12297

* * *

这比正则表达式快大约两倍：

```
 startTime = System.currentTimeMillis();
   for (int i = 0; i < COUNT; i++) {
       // Output is list of 1, 9, 1
       Demo.extractNumbersViaCharComparison(INPUT);
   }
   System.out.println("Total execution time (ms) via Char comparison: " + 
                              (System.currentTimeMillis() - startTime)); 
```

[...]

```
 static List<Integer> extractNumbersViaCharComparison(final String text) {

        final List<Integer> result = new ArrayList<Integer>();
        char[] chars = text.toCharArray();

        StringBuilder sB = new StringBuilder();
        boolean previousWasDigit = false;
        for (int i = 0; i < chars.length; i++) {
            if (Character.isDigit(chars[i])){
                previousWasDigit = true;
                sB.append(chars[i]);
            } else {
                if (previousWasDigit){
                    result.add(Integer.valueOf(sB.toString()));                 
                    previousWasDigit = false;
                    sB = new StringBuilder();
                }                   
            }
        }
        if (previousWasDigit)
            result.add(Integer.valueOf(sB.toString()));

        return result;
    } 
```

顺便说一句，其他解决方案要优雅得多，+1

# c# - 使用 LINQ 检索数据子集

> ID：13863154
> 
> 赞同：2
> 
> 时间：2012-12-13T15:32:37.770
> 
> 标签：c#, linq

我正在尝试从 a 中检索数据以`List<T>`进行分页。如何在 LINQ 中做到这一点：

```
private List<MyData> GetPagingData(int pageNumber)
{
    if (pageNumber == 1)
        return myData.Take(8);

    // What to do here?
} 
```

这适用于第一页。它返回前 8 条记录。我如何使这项工作适用于第 2 页等...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:34:29.197

您需要使用`.Skip`和`.Take`：

```
private List<MyData> GetPagingData(int pageNumber)
{
    int itemsPerPage = 8;
    return myData.Skip(itemsPerPage * (pageNumber - 1)).Take(itemsPerPage).ToList();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:35:30.177

如果您希望页码从 0 开始：

```
private IEnumerable<MyData> GetPagingData(int pageNumber, int perPage)
{
     return myData.Skip(pageNumber * perPage).Take(perPage);
} 
```

如果您希望页码从 1 开始：

```
private IEnumerable<MyData> GetPagingData(int pageNumber, int perPage)
{
     return myData.Skip((pageNumber-1) * perPage).Take(perPage);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:35:04.550

```
myData.Skip(pageSize * (pageNumber - 1)).Take(pageSize) //if first pageNumber = 1 
```

基本上你必须玩skip和take函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T15:36:37.187

```
myData.Skip((pageNumber - 1) * 8).Take(8); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T15:36:38.517

```
private List<MyData> GetPagingData(int pageNumber, int itemsPerPage)
{
    //Don't subtract 1 if you are using 0-based pageNumbers.
    int skip = (pageNumber - 1) * itemsPerPage;

    return myData.Skip(skip).Take(itemsPerPage);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T15:37:46.473

`pageNumber starts from 1:`还在不破坏代码的情况下添加另一个参数。

```
private List<MyData> GetPagingData(int pageNumber, int? itemsPerPage)
{
    itemsPerPage = itemsPerPage ?? 8;
    return myData.Skip(itemsPerPage * (pageNumber-1)).Take(itemsPerPage);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-13T15:38:17.620

在 EF 和 L2S 中，您必须对列表进行排序，然后是`Skip`方法

```
private List<MyData> GetPagingData(int pageNumber, int itemsPerPage)
{
    return myData.OrderBy(i => i.Something).Skip(pageNumber * itemsPerPage).Take(itemsPerPage);
} 
```

使用此代码，您的第一页将为 0

# google-apps-script - 如何使用 CalendarApp 调试间歇性错误？

> ID：13863155
> 
> 赞同：1
> 
> 时间：2012-12-13T15:32:45.393
> 
> 标签：google-apps-script, google-calendar-api

我有一个 Google Apps 脚本，它使用 JSON Web API 从网站（使用 UrlFetchApp）获取 StarCraft2 锦标赛的列表，并在各种日历中创建相应的 Google 日历事件（每个地区/联盟组合一个日历）。

我有一个触发器设置为每 5 分钟一次，它会立即通过电子邮件向我发送错误消息，如果脚本正常完成并添加了任何事件或遇到了我捕获的任何错误，它也会通过电子邮件发送给我。

大多数时候，不需要进行任何更改（我使用 ScriptDb 缓存 JSON 信息以避免调用 CalendarApp，除非我需要）并且脚本是静默的。然而，一夜之间我收到了几封电子邮件，其中包含以下信息：

```
The resource you requested could not be located. (line 154)

Service error: CalendarApp: Error body {font-family: arial,sans-serif}
G o o g l e     Error   Cannot access the calendar you requested (line 155)

TypeError: Cannot call method "getEvents" of null. (line 155) 
```

第 154、155 和 156 行是：

```
var calendar = CalendarApp.getCalendarById(calendars[region][league]);
var events = calendar.getEvents(new Date(1900, 1, 1), new Date());
events.forEach(function (event) { event.deleteEvent(); }); 
```

在脚本的这一点上，我已经尝试添加任何新事件，并且我将查询我的每个日历以删除过去发生的任何事件。

这些错误似乎与 CalendarApp 的可用性有关，但[仪表板](https://script.google.com/dashboard)并未表明该服务有任何问题。

我的项目关键是：`MWhWmFSrL1dK3RJui6Aphb12cA4KNgw7R`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:25:16.250

我有许多使用 CalendarApp 的脚本，它们在执行时偶尔会出现错误，无论是手动模式还是时间触发，似乎（*但我知道这是一种经验性的感觉*）当流量太大时，该服务会出现错误高或互联网连接太慢（几个月前，我的办公室的互联网连接非常差，脚本曾经产生*很多*错误 - 而在家执行时没有 - 现在情况更好了相同的脚本到处都能顺利运行）。

无论如何，无论真正的原因是什么（只有谷歌工程师可以回答），我使用的解决方案是将日历调用放在一个 try-catch 循环中，尝试连接几次，从那时起我就没有错误通知了.

在另一个我还没有更改的脚本上，我不时收到错误，但由于它不涉及关键信息，我并不介意......请注意，我现在刚刚检查过，我还没有收到任何通知5天！（一定是日历的好季节；-）

# ios - UITableView 中的 UIButton，选择器应用于多个按钮

> ID：13863158
> 
> 赞同：-1
> 
> 时间：2012-12-13T15:32:50.353
> 
> 标签：ios, uiimageview, uibutton, selector

我目前正在工作`UITableView`，每个单元格都包含一个具有特定`UIImage`背景的按钮。我想在单元格中单击按钮时更改此图像。

我有这段代码，运行良好，但是当我点击一个按钮时，有几个按钮被修改 - 每 5 个按钮，不知道为什么。这是代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    [myCell.favorite addTarget:self action:@selector(pressed_fav:) forControlEvents:UIControlEventTouchUpInside];

    return myCell;
}

- (void)pressed_fav:(id)sender
{
    UIButton *myButton = sender;

    [myButton setBackgroundImage:[UIImage imageNamed:@"star.png"] forState:UIControlStateNormal];
} 
```

`myCell`是自定义单元格的一个实例，包含一个`IBOutlet`指向`UIButton`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:53:02.963

这是因为`UITableView`重复使用细胞。您必须在 cellForRowAtIndexPath 方法中有一些逻辑来识别按钮的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:58:42.713

非常感谢你！

实际上，当我删除该行时：

```
myCell = [tableView dequeueReusableCellWithIdentifier:@"cinemaCell"]; 
```

它不显示单元格（它被很好地分配和初始化）。

# c# - 'System.Windows.Forms.Timer' 无法解析

> ID：13863159
> 
> 赞同：4
> 
> 时间：2012-12-13T15:32:52.340
> 
> 标签：c#, .net, wpf, winforms

> `Error 1 The base class or interface 'System.ComponentModel.Component' in assembly 'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' referenced by type 'System.Windows.Forms.Timer' could not be resolved`
> 
> `k:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Windows.Forms.dll App2`

`system.windows.forms`添加参考后，我收到此错误消息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:10:03.393

由于您使用的是 Wpf，因此我制作了快速工作示例。确保您的项目引用看起来像这样。

![在此处输入图像描述](../Images/67647ac986870133eae62381edf5c029.png)

**主窗口**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Windows.Forms;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        Timer tmr = new Timer();
        public MainWindow()
        {
            InitializeComponent();
            tmr.Interval = 2000;
            tmr.Tick += new EventHandler(tmr_Tick);
            tmr.Start();
        }

        void tmr_Tick(object sender, EventArgs e)
        {
            tmr.Stop();
            throw new NotImplementedException();
        }
    }
} 
```

* * *

正如 roken 所说，如果你可以使用 Wpf Dispatcher Timer 会更容易。在查看示例链接时，没有迫切需要使用 Windows 窗体计时器，由于这是一个 WPF 程序，因此调度程序计时器在这种情况下可以正常工作。

**编辑根据您的链接修改**

```
public partial class MainWindow : Window
{
    System.Windows.Threading.DispatcherTimer tmrStart = new System.Windows.Threading.DispatcherTimer();
    System.Windows.Threading.DispatcherTimer tmrStop = new System.Windows.Threading.DispatcherTimer();
    public MainWindow()
    {
        InitializeComponent();
        tmrStart.Interval = TimeSpan.FromSeconds(2); //Delay before shown
        tmrStop.Interval = TimeSpan.FromSeconds(3);  //Delay after shown
        tmrStart.Tick += new EventHandler(tmr_Tick);
        tmrStop.Tick += new EventHandler(tmrStop_Tick);

    }

    void tmrStop_Tick(object sender, EventArgs e)
    {
        tmrStop.Stop();
        label1.Content = "";
    }

    void tmr_Tick(object sender, EventArgs e)
    {
        tmrStart.Stop();
        label1.Content = "Success";
        tmrStop.Start();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        tmrStart.Start();
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:20:49.070

如果您专门使用 WPF，则没有理由引用 System.Windows.Forms (WinForms)。这是两种不同的技术，除非必要，否则我不建议将它们混合使用。

如果您使用的是 WinForms 计时器，请考虑改用 WPF 的[DispatcherTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:57:30.287

尝试`System`手动添加引用。

1）右键单击您的项目。点击`Unload Project`。

2）右键单击卸载的项目。点击`Edit <YourProjectName>.csproj`

3) 找到`ItemGroup`包含所有`<Reference Include="AssemblyName">`s 的那个并添加`<Reference Include="System" />`一个新行。

4）保存文件并右键单击您的项目并单击`Reload Project`

# python - 如何确定连接何时断开？

> ID：13863162
> 
> 赞同：0
> 
> 时间：2012-12-13T15:33:15.410
> 
> 标签：python, exception, exception-handling, tcp

我正在使用以下 TCP 通信代码（服务器端）来处理超时等...如果我终止客户端软件，则会发生异常（socket.error），但是当我从客户端 PC 上拔下以太网电缆时socket.timeout 异常发生，那么我怎么知道连接断开了？`socket.error`几分钟后我可能会得到一个例外吗？我尝试了 3 分钟，但没有收到 socket.error 异常。

```
self.request.settimeout( 1 )
while 1:
        try:
            response = self.request.recv( buffSize )            
            if(response)
                ...response handler....       
            else:               
                ...disconnect handler....
        except socket.timeout :                  
            ...timeout handler...
        except socket.error:
            ...disconnect handler... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:55:27.660

这取决于您希望以多快的速度检测到断开的连接。如果你愿意等几分钟，你可以开启 TCP Keepalive ( [https://www.rfc-editor.org/rfc/rfc1122#page-101](https://www.rfc-editor.org/rfc/rfc1122#page-101) )：

```
import socket
self.request.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1) 
```

请注意，TCP 使用的实际时间间隔取决于操作系统。

如果您需要比 TCP Keepalive 提供的更快的东西，您可能需要在您的协议中引入“ping”功能。这意味着您的客户端和服务器会定期交换一个空操作消息。它只是测试连接是否存在。

# php - Yii 离开加入 CDbCriteria

> ID：13863167
> 
> 赞同：1
> 
> 时间：2012-12-13T15:33:29.323
> 
> 标签：php, join, yii, left-join

有两张桌子：

**内容**

```
 id |  text
------------
 1  | text1
 2  | text2
 3  | text3
 4  | text4 
```

**相片**

```
 id |  content_id |  src
-----------------------------
 1  |      1      |  img1.png
 2  |      1      |  img2.png
 3  |      2      |  img3.png
 4  |      3      |  img1.png 
```

尝试从第三个控制器获取包含左连接照片的内容。

我的代码：

```
$oDBC = new CDbCriteria();
$oDBC->select = 't.*,p.*'; 
$oDBC->join = 'LEFT JOIN photos p ON t.id = p.content_id'; 
$oDBC->condition = 't.step_id = "'.$model->id.'"';

$content = Content::model()->find($oDBC); 
```

在 ContentController 中添加功能：

```
public function relations()
{
    return array('photos' => array(self::HAS_MANY, 'Photos', 'content_id');
} 
```

但`print_r($content)`只返回内容数据，没有照片数据。

就像在[这个](https://stackoverflow.com/a/4995486/739897)答案中我试过：

```
print_r($content->photos); 
```

但得到了`Property "Content.photos" is not defined.`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:45:25.730

您在错误的位置添加了关系功能。它应该添加到`Content`模型中，而不是`ContentController`：

```
class Content extends CActiveRecord {

    // ... other functions ...

    public function relations() {
        return array('photos' => array(self::HAS_MANY, 'Photos', 'content_id');
    }

} 
```

如果您使用 Gii 生成了模型，那么关系函数应该已经存在。

# image - 使用firebird从delphi中的blob字段加载和保存图像

> ID：13863169
> 
> 赞同：6
> 
> 时间：2012-12-13T15:33:32.690
> 
> 标签：image, delphi, bitmap, blob, firebird

在我的 Firebird 数据库中，我有一个包含位图的 Blob 字段。我必须加载并显示在我的表单上的 TImage 中。随后，我必须将 OpenDialog 选择的图像保存在同一字段中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-13T15:52:43.010

```
Procedure LoadBitmapFromBlob(Bitmap: TBitmap; Blob: TBlobField);
var
  ms, ms2: TMemoryStream;
begin
  ms := TMemoryStream.Create;
  try
    Blob.SaveToStream(ms);
    ms.Position := 0;
    Bitmap.LoadFromStream(ms);
  finally
    ms.Free;
  end;
end; 
```

示例用法

```
procedure TForm4.Button1Click(Sender: TObject);
var
  bmp: TBitmap;
begin
  bmp := TBitmap.Create;
  try
    LoadBitmapFromBlob(bmp, TBlobField(Dataset.FieldByName('Image')));
    Image1.Picture.Assign(bmp);
    bmp.SaveToFile(OpenDialog.FileName);
  finally
    bmp.Free;
  end;

end; 
```

# qt - QTextEdit::adjustSize() 不工作？

> ID：13863173
> 
> 赞同：5
> 
> 时间：2012-12-13T15:33:37.747
> 
> 标签：qt, qtextedit

设置文本`QTextEdit`：

```
te->setPlainText(“Something”) ;
te->adjustSize(); 
```

应该只环绕“Something”，而不是`QTextEdit`扩展到其最大宽度-高度，无法修复它。当我在运行时选择“Something”时，只有“Something”被突出显示，没有添加额外的空格。

**期望**：当文本小到足以容纳一行时，文本编辑不应该在高度上扩展，当文本需要换行时，应该只添加额外的线宽而不是最大宽度。

如果`adjustSize();`没有被调用，文本将在 Creator 中的 .ui 中设置的宽度上换行，不会水平或垂直动态扩展..

一些信息：

> 水平策略：扩展
> 垂直策略：MinimumExpanding
> minimumSize：
> 最大 2×22 Size：300×100
> lineWrapMode：WidgetWidth

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:34:43.313

是的，看起来没有简单的方法来计算`QTextEdit`.
`adjustSize()`是为 设计的`QWidget`，不是为 重新实现的`QTextEdit`，它基于`sizeHint()`.
您可以使用自己的方法来计算行数，fe

1.  您可以`QFontMetrics`用来计算文本中每个单词的宽度
2.  您可以将高度设置为 22 并增加它，直到最大高度被击中或垂直滚动​​条消失。
3.  您可以从自身的来源获取一些信息`QTextEdit`并将其子类化，在那里重新实现某些东西（`adjustSize()`？）。

# exception-handling - Doctrine2 例外列表

> ID：13863177
> 
> 赞同：6
> 
> 时间：2012-12-13T15:34:11.430
> 
> 标签：exception-handling, doctrine-orm

我无法在 Doctrine 手册中找到所有 Doctrine2 异常的列表。有人有这样的清单吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-13T15:34:11.430

我找到了这个：

```
Doctrine\Common\DataFixtures\Exception\CircularReferenceException
Doctrine\Common\Annotations\AnnotationException
Doctrine\Common\CommonException
Doctrine\Common\Persistence\Mapping\MappingException
Doctrine\ORM\TransactionRequiredException
Doctrine\ORM\Query\QueryException
Doctrine\ORM\Query\AST\ASTException
Doctrine\ORM\Mapping\MappingException
Doctrine\ORM\UnexpectedResultException
Doctrine\ORM\PessimisticLockException
Doctrine\ORM\OptimisticLockException
Doctrine\ORM\Internal\Hydration\HydrationException
Doctrine\ORM\ORMException
Doctrine\ORM\NonUniqueResultException
Doctrine\ORM\EntityNotFoundException
Doctrine\ORM\Tools\ToolsException
Doctrine\ORM\Tools\Export\ExportException
Doctrine\ORM\Proxy\ProxyException
Doctrine\ORM\NoResultException
Doctrine\ORM\ORMInvalidArgumentException
Doctrine\DBAL\Query\QueryException
Doctrine\DBAL\Types\ConversionException
Doctrine\DBAL\Schema\SchemaException
Doctrine\DBAL\Sharding\ShardingException
Doctrine\DBAL\ConnectionException
Doctrine\DBAL\Cache\CacheException
Doctrine\DBAL\Driver\OCI8\OCI8Exception
Doctrine\DBAL\Driver\SQLSrv\SQLSrvException
Doctrine\DBAL\Driver\Mysqli\MysqliException
Doctrine\DBAL\Driver\IBMDB2\DB2Exception
Doctrine\DBAL\DBALException 
```

# php - 当从浏览器运行 php 脚本时 imagecreate() 工作正常，但从 shell 运行时却不行

> ID：13863178
> 
> 赞同：1
> 
> 时间：2012-12-13T15:34:12.197
> 
> 标签：php, shell

我有图像创建 php 脚本。当我从浏览器访问它时它工作正常。但是当从 shell 脚本调用它时，它会显示以下错误。

PHP 致命错误：调用未定义的函数 imagecreate()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:23:14.713

您可以检查gd是否已加载并尝试动态加载

```
<?php
if (!extension_loaded('gd')) {
    if (!dl('gd.so')) {
        echo "GD cannot be loaded";
        exit;
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:24:52.687

PHP CLI 可能不使用与浏览器相同的配置文件。所以它不会加载 GD 库。

您可以强制他使用相同的 .ini 文件：

```
php -c /directory/php.ini phpscript.php 
```

或者在您的 PHP CLI 配置文件中添加以下行：

```
; Enable gd extension module
extension=gd.so 
```

# .net - .Net Web 服务客户端在 VS 2010 和 VS2008 中生成不同的代理代码

> ID：13863188
> 
> 赞同：2
> 
> 时间：2012-12-13T15:34:39.243
> 
> 标签：.net, wcf, ssis, webservice-client, workday-api

我正在为[Workday Web Service API](https://community.workday.com/custom/developer/API/index.html)开发 Soap 客户端。**Workday 社区网站上有 .Net 3.5**的代码示例。我得到了在 Visual Studio 2010 中工作的 3.5 代码，目标是 .Net **3.5**。生成的*reference.cs*包含示例代码所需的所有内容。

但是，我需要将 Web 服务客户端放入 SQL Server 2008 的 SSIS 脚本任务中，这意味着脚本项目是为 VS 2008 生成的。那里可用的最新 .Net 框架目标版本也是**3.5**。在同样安装了 Visual Studio 2010 并使用相同 WSDL 的同一开发框上，生成的代理代码非常不同，并且不适用于我的客户端代码。具体来说，这部分 WSDL

```
<wsdl:portType name="Benefits_AdministrationPort">
 <wsdl:operation name="Put_Benefit_Annual_Rate">
  <wsdl:input name="Put_Benefit_Annual_RateInput" 
      message="wd-wsdl:Put_Benefit_Annual_Rate_RequestInputMsg" />
  <wsdl:output name="Put_Benefit_Annual_RateOutput" 
      message="wd-wsdl:Put_Benefit_Annual_Rate_ResponseOutputMsg" />
  <wsdl:fault name="Validation_Fault" 
      message="wd-wsdl:Validation_FaultMsg" />
  <wsdl:fault name="Processing_Fault" 
      message="wd-wsdl:Processing_FaultMsg" />
 </wsdl:operation>
</wsdl:portType> 
```

导致在 VS2010 中生成这些代理元素：

```
public interface Benefits_AdministrationPort : ....

public partial class Benefits_AdministrationPortClient :     
   System.ServiceModel.ClientBase<WorkDayWWSTestClient.WorkdayBenefits.
   Benefits_AdministrationPort>, WorkDayWWSTestClient.WorkdayBenefits.
   Benefits_AdministrationPort {
   .... 
```

*在我的 VS2008 项目中， reference.cs*中缺少这些内容。两个项目都引用相同版本的*System.ServiceModel*程序集 (3.0.0.0)。客户端代码实例化了Benefits_AdministrationPortClient 类，因此显然没有该类是一个问题。

我可以将在我的 VS 2010 项目中生成的代理代码放入 VS 2008 SSIS 脚本任务项目中，一切正常，我的客户可以成功更新 Workday。所以我有一个解决方法，但是当 Web 服务更新时，代码会被覆盖，所以这不是一个好的解决方案。

我不明白这里有哪些内容 - 服务模型、.Net 版本或 Visual Studio，以及如何让 VS 2008 生成正确的代码。有任何想法吗？

# javascript - 使用 didInsertElement 时与 emberjs 和 jquery 不一致

> ID：13863195
> 
> 赞同：0
> 
> 时间：2012-12-13T15:35:11.307
> 
> 标签：javascript, jquery, ember.js

我目前正在使用 emberjs 构建一个应用程序，我接近完成，但我有一些与应用程序中的视图相关的 didInsertElement 方法相关的不一致。这是代码：

```
 didInsertElement : function(){           
        Ember.run.next(this,function(){
            var sub = this.$(document).find('.sub_t');
            $(sub).not('button').siblings('.inside').toggle();
            $(sub).each(function(i){
                $(this).attr('id','s_t' + i + '');
                var s_t = $(this).nextUntil(".sub_t");
                $(s_t).not('button').wrapAll("<div class='s_t" + i + "'></div>");
            });
         });
    }, 
```

问题是，即使我没有使用 Ember.run.next，应用程序视图的反应也不一致。我只是想修改我认为的内容。有时 jquery 工作，有时它不是，并且不清楚如何重现这个错误。

它与加载文件的大小有关吗？还是误用了 Ember 运行循环或插入元素方法？

有人对此有提示吗？或提示正在发生的事情以及我可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T12:26:42.930

当`didInsertElement`被调用时，您可以保证视图的元素已添加到 DOM。如果您还想保证视图的子视图也已添加，您可以在`afterRender`队列上安排一个操作，该操作已添加[到此处](https://github.com/emberjs/ember.js/commit/512327c0128f53d4a0d6828ab38f27c6ccf686ec)。IE

```
Ember.run.scheduleOnce('afterRender', this, function(){
    // do something when my view hierarchy has been rendered
}); 
```

这将替换，这在处理程序`Ember.run.next`中很少是一个好主意。`didInsertElement`

此外，在`didInsertElement`处理程序中，您应该几乎总是使用作用域的 jQuery 选择器`this.$()`，而不是全局的`$`.

在这两个提示之间，您应该能够使事情始终如一地工作。如果你不能，你可以创建一个 JSFiddle 来显示你想要完成的事情的简化版本，我很乐意看看它。

# c - C中的逗号和赋值运算符

> ID：13863196
> 
> 赞同：5
> 
> 时间：2012-12-13T15:35:14.627
> 
> 标签：c, c99, comma-operator

我有以下内容：

```
int a = 1, b = 2, c = 3, d = 4;
a = b, c = d;
printf("%d, %d, %d, %d", a, b, c, d); 
```

输出是：

```
2, 2, 4, 4 
```

逗号运算符如何与赋值运算符一起使用？据我所知，如果我们有，它将评估并返回第二个表达式，

```
(exp1, exp2) 
```

那么，它为什么要评估`a = b`呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T15:38:18.090

评估第一个操作数并丢弃结果。然后计算第二个操作数，并将结果作为表达式的整体结果返回。

标准说：

> 逗号运算符的左操作数被评估为 void 表达式；在它的求值和右操作数的求值之间有一个序列点。然后对右操作数求值；结果有它的类型和值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T15:38:03.540

逗号运算符的优先级低于赋值。逗号运算符中的所有表达式都被计算，但只有最后一个被用作结果值。所以这两个任务都被执行了。在您的情况下，逗号运算符的结果将是`c = d`. 不使用此结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:38:23.813

逗号运算符计算它的两个操作数（首先是左边的）并返回右边的值。这并不特定于作为赋值的操作数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T15:38:42.800

它的工作方式与将它们编写为单个语句一样：

```
int a = 1;
int b = 2;
int c = 3;
int d = 4;

a = b;
c = d; 
```

有关更多详细信息，另请参阅[逗号运算符](http://en.wikipedia.org/wiki/Comma_operator)

来自维基百科：

```
int a=1, b=2, c=3, i;   // comma acts as separator in this line, not as an operator
i = (a, b);             // stores b into i                                                              ... a=1, b=2, c=3, i=2
i = a, b;               // stores a into i. Equivalent to (i = a), b;                                   ... a=1, b=2, c=3, i=1
i = (a += 2, a + b);    // increases a by 2, then stores a+b = 3+2 into i                               ... a=3, b=2, c=3, i=5
i = a += 2, a + b;      // increases a by 2, then stores a into i. Equivalent to  (i = a += 2), a + b;  ... a=3, b=2, c=3, i=3
i = a, b, c;            // stores a into i                                                              ... a=5, b=2, c=3, i=5
i = (a, b, c);          // stores c into i 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T15:46:27.417

`From what I have known it would evaluate and return the second expression`

这不是一个完全正确的说法。是的，第二个被评估并返回，但你暗示第一个被忽略。

逗号运算符的工作方式是计算所有表达式并返回**最后一个**。例如：

```
int a, b, c, d = 0;
if(a = 1, b = 2, c = 3, d == 1)
    printf("No it isn't!\n")
else
    printf("a: %d, b: %d, c: %d, d: %d\n", a, b, c, d); 
```

给你：

```
a = 1, b = 2, c = 3, d = 0 
```

因为所有的表达式都被求值了，但只`d==1`被返回来为条件做出决定。

...此运算符的更好用途可能是在`for`循环中：

```
for(int i = 0; i < x; counter--, i++) // we can keep track of two different counters
                                      // this way going in different directions. 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-10T10:45:40.577

这段代码等价于：

```
int a = 1;
int b = 2;
int c = 3;
int d = 4;
a = b;
c = d; 
```

对逗号左侧的第一个表达式求值，然后是其右侧的表达式。最右边表达式的结果存储在 = 符号左侧的变量中。

# excel - 从 Excel 复制/粘贴到 WebApp

> ID：13863197
> 
> 赞同：1
> 
> 时间：2012-12-13T15:35:26.903
> 
> 标签：excel, web, copy, paste

我必须创建一个 Web 应用程序，它可以允许从 excel 复制并粘贴到 Web 上并获得完全相同的东西，反之亦然。我对 Web 开发知之甚少，但我找到了一些解决方案，例如：

-sharepoint 和办公网络应用程序

-asp.net + ajax

- 在 excel 中制作一个加载项以在服务器上发送 elem（但该项目将仅在 excel 上使用此解决方案）

-HTML + PHP 与 PHPExcel。

是否有其他解决方案或其中哪一个是最好的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:56:31.803

客户端解决方案看看handsontable jquery 插件。 如果您想在服务器端执行此操作，您可以使用来自 excel [http://handsontable.com/的复制/粘贴，只需两个用于语句解析。](http://handsontable.com/)很多类可用于解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T08:27:33.023

我在我的 .net 参考中使用了电子表格核心，并使用了以下许多功能：

[http://www.spreadsheetgear.com/](http://www.spreadsheetgear.com/)

看起来很完美！

# php - 未知列，但在 PHPMyAdmin 中有效

> ID：13863199
> 
> 赞同：-3
> 
> 时间：2012-12-13T15:35:29.473
> 
> 标签：php, mysql

我想执行查询。如果第一个失败，则执行第二个，但它说：

> MySQL 错误：“字段列表”中的未知列“状态”

```
mysql_query("UPDATE `rolerota` SET `status`='$_GET[status]' WHERE `uid`='$_GET[id]'")  or die("MySQL ERROR: ".mysql_error()); 

mysql_query("UPDATE `showrota` SET `status`='$_GET[status]' WHERE `uid`='$_GET[id]'")  or die("MySQL ERROR: ".mysql_error()); 
```

它们在 PHPMyAdmin 中运行良好，所以我知道该列确实存在。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:54:20.423

我不会像已经建议的那样评论使用 mysqli，请确保尽可能升级。

如果它确实在 phpmyadmin 上工作，那么我会假设这些列确实存在，问题不在于那个。因此，请检查以下事项：

1）也许您在 phpmyadmin 和您的代码上使用不同的数据库服务器。检查您的 mysql_connect() 以确保。

2）也许您在 phpmyadmin 和您的代码上使用了不同的数据库。检查您的 mysql_select_db() 以确保

3）一旦完成，试试这个：

```
mysql_query("UPDATE rolerota SET status='".mysql_real_escape_string($_GET['status'])."' WHERE uid='".mysql_real_escape_string($_GET['id'])."'")  or die("MySQL ERROR 1: ".mysql_error()); 

mysql_query("UPDATE showrota SET status='".mysql_real_escape_string($_GET['status'])."' WHERE uid='".mysql_real_escape_string($_GET['id'])."'")  or die("MySQL ERROR 2: ".mysql_error()); 
```

您将根据消息了解哪个查询失败，您还将更好地保护您的数据库免受 sql 注入。

如果这不起作用，请尝试发布新的错误消息和您的数据库结构。

# c# - 怎么写几个使用说明？

> ID：13863200
> 
> 赞同：23
> 
> 时间：2012-12-13T15:35:29.770
> 
> 标签：c#, .net, idisposable, using

> **可能重复：**
> [使用带有多个变量的语句](https://stackoverflow.com/questions/9396064/using-statement-with-multiple-variables)

我有几个一次性对象要管理。CA2000 规则要求我在退出范围之前处置我的所有对象。`.Dispose()`如果我可以使用 using 子句，我不喜欢使用该方法。在我的具体方法中，我应该使用以下方法编写许多使用：

```
using (Person person = new Person()) {
    using (Adress address = new Address()) { 
        // my code
    }
} 
```

是否可以用另一种方式写这个，比如：

```
using (Person person = new Person(); Adress address = new Address()) 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-13T15:41:04.037

您可以在一个语句中声明两个或多个对象`using`（以逗号分隔）。缺点是它们必须是同一类型。

**合法的：**

```
using (Person joe = new Person(), bob = new Person()) 
```

**非法的：**

```
using (Person joe = new Person(), Address home = new Address()) 
```

您能做的最好的事情就是嵌套 using 语句。

```
using (Person joe = new Person())
using (Address home = new Address())
{
  // snip
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-13T15:37:31.710

你能做的最好的事情是：

```
using (Person person = new Person())
using (Address address = new Address())
{ 
    // my code
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-13T15:44:35.860

你*可以*做

```
using (IDisposable iPerson = new Person(), iAddress = new Address())
{
    Person person = (Person)iPerson;
    Address address = (Address)iAddress;
    //  your code
} 
```

但这几乎没有改善。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-13T15:39:55.417

如果它们属于同一类型，则只能在单个 using 语句中使用多个对象。您仍然可以嵌套 using 不带括号的语句。

```
using (Person person = new Person())
using (Address address = new Address())
{

} 
```

这是一个多对象的示例，相同类型的 using 语句：

```
using (Person p1 = new Person(), p2 = new Person())
{

} 
```

# .net - .net Web 应用程序可以将未捕获的异常消息以纯文本形式传递给浏览器吗？

> ID：13863201
> 
> 赞同：2
> 
> 时间：2012-12-13T15:35:34.077
> 
> 标签：.net, json, debugging, exception

我在调试。在 ASP.net MVC 4 Web 应用程序上。

应用程序中有许多 JsonResult 控制器操作。如果发生错误，系统会返回错误文本和带有 HTML 标记的堆栈跟踪。当错误发生在 ViewResult Controller Action 上时，这很方便，但是很难阅读 JsonResult Controller Actions 的错误消息，因为我通常会在调试器中看到错误消息的文本，如果有的话。

有没有一种实用的方法可以让 JsonResult 控制器操作以纯文本形式将其错误消息返回给浏览器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:27:35.310

有几种处理方法，但我怀疑最容易开始工作的是捕获异常并在您的操作上下文中处理它们：

```
public ActionResult Index()
{
    try
    {
        // Your code which may throw an exception.
    }
    catch(Exception ex)
    {
        return ex.ToJsonResult();
    }
} 
```

您可以轻松地创建一个扩展方法，以您喜欢的任何方式执行异常转换。

```
internal static ExceptionHelper
{
    public static JsonResult ToJsonResult(this Exception ex)
    {
        // TODO: build and return the JsonResult from the exception informtation.
    }
} 
```

虽然以全局方式处理这个问题会很好，但是如果不以某种可以通过反射达到的方式更改其签名，就很难知道您的操作的结果应该是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T10:15:43.437

一个有点复杂的解决方案是创建一个自定义[`HandleErrorsAttribute`](http://msdn.microsoft.com/en-us/library/system.web.mvc.handleerrorattribute%28v=vs.108%29.aspx)实现，然后您可以将其添加到单个操作、整个控制器或注册到您的全局过滤器集合中，以这种方式处理所有请求。这是 MVC 中用于自定义异常处理的扩展点。

您的实现可能非常简单，如下所示：

```
public class HandleErrorsAsJsonAttribute : HandleErrorsAttribute
{
    public HandleErrorsAsJsonAttribute()
    {
    }

    public override void OnException(ExceptionContext filterContext)
    {
        if (filterContext.ExceptionHandled)
        {
            return;
        }

        var ex = filterContext.Exception

        // TODO: build the JsonResult from the exception information.
        filterContext.Result = new JsonResult();

        // Indicate the exception is handled 
        // to prevent it being passed to other filters.
        filterContext.ExceptionHandled = true;
    }
} 
```

在这种情况下，您可以将其仅应用于您希望将信息作为 JSON 对象返回的操作或控制器。如果您的所有控制器都返回 JSON，那么您只需将属性添加到全局集合并完成它即可。

# git - 查看 Git 子模块

> ID：13863202
> 
> 赞同：1
> 
> 时间：2012-12-13T15:35:46.750
> 
> 标签：git, version-control, github

我想对包含子模块的 Git 存储库进行部分签出。这是我检查目录的方法：

```
git clone --no-checkout git@github.com:MyOrganization/MyRepo.git --depth 1 --recurse-submodules 
```

然后：

```
cd MyRepo
git checkout HEAD MyDirectory/puppet/ 
```

此检查**MyDirectory/puppet**但不检索包含在**MyDirectory/puppet/modules**目录中的子模块...

知道如何检查子模块吗？如果我不必在每个子模块目录上运行相同的命令就可以做到这一点，那就太好了，因为模块列表会经常更改。

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:47:56.597

尝试： `git submodule update --recursive`

# wpf - DataGrid 行详细信息可见性

> ID：13863205
> 
> 赞同：1
> 
> 时间：2012-12-13T15:36:01.423
> 
> 标签：wpf, xaml, mvvm, mvvm-light

我正在使用定义了 RowDetailsTemplate 属性的 DataGrid 控件。显然，单击一行将显示该行的行详细信息。但是，一旦显示行详细信息，在 DataGrid 中向下滚动时就会出现问题。一旦其详细信息可见的行向上移动并移出视图，行详细信息就会立即消失，从而导致后面的行“跳”起来并填满空间。再次向上滚动会导致行详细信息立即出现，从而导致以下行“跳”回以提供空间。

这似乎不是虚拟化问题，因为无论 EnableRowVirtualization 的值如何，都会发生相同的行为。另外，我知道从可视化树的角度来看，这是有道理的，因为行详细信息容器位于行容器内。然而，这种行为在实践中看起来很愚蠢。

无论如何，即使实际行不可见，直到取消选择该行，是否仍保持行详细信息始终可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T12:46:44.533

将`ScrollViewer.CanContentScroll`DataGrid 上的附加属性设置为`"False"`. 这将允许 DataGrid 项及其 RowDetails 平滑滚动。但这会影响性能，因为不会使用 DataGrid 的虚拟化功能。

# java - 滑动时出现空指针异常

> ID：13863209
> 
> 赞同：0
> 
> 时间：2012-12-13T15:36:14.327
> 
> 标签：java, android, nullpointerexception, swipe-gesture

我开始`NullPointerException`刷卡了。有什么问题以及如何纠正？异常在method `onTouchEvent`by statement中触发`return gestureDetector.onTouchEvent(event);`

该活动（List8）被称为 Tabs3 类中的 TabActivity，它也是为了完整而提供的。

```
package myapp.tabnavui;

import myapp.tabnavui.R;

import android.app.ListActivity;
import android.content.Context;
import android.os.Bundle;
import android.view.GestureDetector;
import android.view.MotionEvent;
import android.view.View;
import android.view.ViewGroup;
import android.view.GestureDetector.SimpleOnGestureListener;
import android.view.ViewGroup.LayoutParams;
import android.widget.BaseAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.AbsListView;
import android.widget.Toast;

import java.util.ArrayList;

/**
 * A list view that demonstrates the use of setEmptyView. This example alos uses
 * a custom layout file that adds some extra buttons to the screen.
 */
public class List8 extends ListActivity {

    private GestureDetector gestureDetector;
    PhotoAdapter mAdapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Use a custom layout file
        setContentView(R.layout.list_8);

        // Tell the list view which view to display when the list is empty
        getListView().setEmptyView(findViewById(R.id.empty));

        // Set up our adapter
        mAdapter = new PhotoAdapter(this);
        setListAdapter(mAdapter);

        // Wire up the clear button to remove all photos
        Button clear = (Button) findViewById(R.id.clear);
        clear.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                mAdapter.clearPhotos();
            } });

        // Wire up the add button to add a new photo
        Button add = (Button) findViewById(R.id.add);
        add.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                mAdapter.addPhotos();
            } });
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        return gestureDetector.onTouchEvent(event);
    }

    /**
     * A simple adapter which maintains an ArrayList of photo resource Ids. 
     * Each photo is displayed as an image. This adapter supports clearing the
     * list of photos and adding a new photo.
     *
     */
    public class PhotoAdapter extends BaseAdapter {

        private Integer[] mPhotoPool = {
                R.drawable.sample_thumb_0, R.drawable.sample_thumb_1, R.drawable.sample_thumb_2,
                R.drawable.sample_thumb_3, R.drawable.sample_thumb_4, R.drawable.sample_thumb_5,
                R.drawable.sample_thumb_6, R.drawable.sample_thumb_7};

        private ArrayList<Integer> mPhotos = new ArrayList<Integer>();

        public PhotoAdapter(Context c) {
            mContext = c;
        }

        public int getCount() {
            return mPhotos.size();
        }

        public Object getItem(int position) {
            return position;
        }

        public long getItemId(int position) {
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            // Make an ImageView to show a photo
            ImageView i = new ImageView(mContext);

            i.setImageResource(mPhotos.get(position));
            i.setAdjustViewBounds(true);
            i.setLayoutParams(new AbsListView.LayoutParams(LayoutParams.WRAP_CONTENT,
                    LayoutParams.WRAP_CONTENT));
            // Give it a nice background
            i.setBackgroundResource(R.drawable.picture_frame);
            return i;
        }

        private Context mContext;

        public void clearPhotos() {
            mPhotos.clear();
            notifyDataSetChanged();
        }

        public void addPhotos() {
            int whichPhoto = (int)Math.round(Math.random() * (mPhotoPool.length - 1));
            int newPhoto = mPhotoPool[whichPhoto];
            mPhotos.add(newPhoto);
            notifyDataSetChanged();
        }

    }

    class MyGestureDetector extends SimpleOnGestureListener {
          private static final int SWIPE_MAX_OFF_PATH = 200;
          private static final int SWIPE_MIN_DISTANCE = 50;
          private static final int SWIPE_THRESHOLD_VELOCITY = 200;

        @Override
        public boolean onDown (MotionEvent e) {
            return true;
        }

          @Override
          public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) {
               if (Math.abs(e1.getY() - e2.getY()) > SWIPE_MAX_OFF_PATH)
                   return false;
               // left to right swipe and right to left swipe
               if (e1.getX() - e2.getX() > SWIPE_MIN_DISTANCE
                 && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                    // left swipe
                    Toast t = Toast.makeText(List8.this, "Left swipe", Toast.LENGTH_LONG);
                    t.show();
                    startActivity(Tabs3.tab1);
                    return true;
               } else if (e2.getX() - e1.getX() > SWIPE_MIN_DISTANCE
                 && Math.abs(velocityX) > SWIPE_THRESHOLD_VELOCITY) {
                    // right swipe
                    Toast t = Toast.makeText(List8.this, "Right swipe", Toast.LENGTH_LONG);
                    t.show();
                    startActivity(Tabs3.tab3);
                    return true;
               }
               return false;
          }    
    }    
} 
```

这是Tabs3：

```
package myapp.tabnavui;

import android.os.Bundle;
import android.util.Log;
import android.view.GestureDetector;
import android.view.GestureDetector.SimpleOnGestureListener;
import android.view.MotionEvent;
import android.view.View;
import android.widget.TabHost;
import android.widget.Toast;
import android.app.TabActivity;
import android.content.Intent;

/**
 * An example of tab content that launches an activity via {@link android.widget.TabHost.TabSpec#setContent(android.content.Intent)}
 */
public class Tabs3 extends TabActivity {

    private GestureDetector gestureDetector;
    // View.OnTouchListener gestureListener;
    // Intent go;
    public static Intent tab1, tab2, tab3; 

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        final TabHost tabHost = getTabHost();

        tab1 = new Intent(this, List1.class);
        tabHost.addTab(tabHost.newTabSpec("tab1")
                .setIndicator("list")
                .setContent(tab1));

        tab2 = new Intent(this, List8.class);
        tabHost.addTab(tabHost.newTabSpec("tab2")
                .setIndicator("photo list")
                .setContent(tab2));

        // This tab sets the intent flag so that it is recreated each time
        // the tab is clicked.
        tab3 = new Intent(this, Controls2.class);
        tabHost.addTab(tabHost.newTabSpec("tab3")
                .setIndicator("destroy")
                .setContent(tab3
                        .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:40:10.907

## 原因

`Tabs3.gestureDetector`并且`List8.gestureDetector`从不设置，所以它们是`null`.

这就是为什么你`NullPointerException`在尝试使用它时得到的原因`gestureDetector.onTouchEvent(event);`

## 解决方案

基于[这个问题](https://stackoverflow.com/questions/4817770/android-listview-with-onitemclicklistener-and-gesturedetector)，您需要在创建时使用[GestureDetector](http://developer.android.com/reference/android/view/GestureDetector.html#GestureDetector(android.view.GestureDetector.OnGestureListener))进行设置：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    // code
    gestureDetector = new GestureDetector(new MyGestureDetector());
    // code
} 
```

# c++ - 来自另一个非静态的非静态成员初始化器

> ID：13863219
> 
> 赞同：7
> 
> 时间：2012-12-13T15:36:50.867
> 
> 标签：c++, gcc, c++11, clang, icc

很简单的问题。这是有效的 C++11 吗？

```
struct Foo {
    int bar = 1;
    int baz = bar;
}; 
```

GCC (4.7.2) 和 Clang (3.1) 都接受它的迂腐设置：

```
-std=c++11 -Wall -W -pedantic
```

英特尔 C++ (13.0.1.117) 没有。它咆哮`int baz = bar;`着：

```
错误：非静态成员引用必须相对于特定对象
```

谁是对的？

如果您想知道，我将它用于这样的代码，它使初始化代码更紧密地结合在一起，而不是将最后一行移到构造函数中：

```
uint8_t colorR = -1;
uint8_t colorG = -1;
uint8_t colorB = -1;
uint8_t colorA = -1;
GLubyte RGBAVec[4] = {colorR, colorG, colorB, colorA}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T16:44:07.283

> **5.1p12**表示类**的非静态数据成员**或非静态成员函数的*id-expression*只能用于：
> 
>  ***   作为类成员访问 (5.2.5) 的一部分，其中对象表达式引用成员的类或从该类派生的类，或
> *   形成指向成员（5.3.1）的指针，或
> *   在该类或从该类（12.6.2）派生的类的构造函数的*mem初始化程序中，或*
> *   **在***该类或从该类 (12.6.2) 派生的类**的非静态数据成员的*****大括号或等式初始化程序中，或****
> **   如果该 id-expression 表示非静态数据成员并且它出现在未计算的操作数中。***

 ***所以是的，这个：

```
struct Foo {
  int bar = 1;
  int baz = bar;
}; 
```

是有效的 C++11。

但要小心订单，因为：

> **12.6.2p10**在非委托构造函数中，初始化按以下顺序进行：
> 
> *   首先，并且仅对于最派生类（1.8）的构造函数，虚拟基类按照它们出现在基类的有向无环图的深度优先从左到右遍历的顺序进行初始化，其中“左- to-right”是派生类base-specifier-list中基类的出现顺序。
> *   然后，直接基类按照它们出现在 base-specifier-list 中的声明顺序进行初始化（无论 mem-initializers 的顺序如何）。
> *   然后，**非静态数据成员按照它们在类定义中声明的顺序进行初始化** （同样不管 mem-initializers 的顺序）。
> *   最后，执行构造函数体的复合语句

因此，如[非静态数据成员初始值设定项提案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2756.htm)（问题 3）中所述：

> 第三个问题是类范围查找可能会将编译时错误变成运行时错误：
> 
> ```
> struct S {
>     int i = j; // ill-formed without forward lookup, undefined behavior with
>     int j = 3;
> }; 
> ```
> 
> （除非被编译器捕获，否则 i 可能会使用未定义的 j 值进行初始化。）***

# php - htaccess 顺序重定向

> ID：13863220
> 
> 赞同：2
> 
> 时间：2012-12-13T15:36:52.347
> 
> 标签：php, regex, .htaccess, redirect

我是 htaccess 重定向的新手，我在它的工作原理上遇到了一些麻烦，我认为这是因为我需要一些不同的东西。

我要这个

```
http://localhost/webroot/type_enduro-cross-trial/brand_yamaha/ 
```

被重定向到

```
http://localhost/webroot/search.php?type=enduro-cross&trial=brand_yamaha 
```

我将这些值用作产品的过滤器；但原始 URL 是分两步生成的。

例子：

用户转到主页 ( `http://localhost/webroot`)，并希望按类型进行过滤，因此当他单击时，应用过滤器并且 URL 更改为`http://localhost/webroot/type_enduro-cross-trial`并且可以正常工作！

但我希望用户能够添加更多过滤器，所以现在他想按某个品牌进行过滤，当他点击 URL 时会变为`http://localhost/webroot/type_enduro-cross-trial/brand_yamaha/`. 等等更多的过滤器。

此重写规则用于获取第一个参数的值：

`RewriteRule ^([^_/]+)_([^_/]+)/([^_/]*) search.php?$1=$2 [L]`

但是当我添加更多过滤器时，它显然会忽略它们，我不知道重写规则应该如何。

谢谢，对不起我的英语！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:46:47.683

您想要实现的目标与`.htaccess`. 而不是解决这个复杂的问题，`.htaccess`只需在文件中留下一条规则并在`search.php`脚本中完成工作。这使您具有更大的灵活性。

只需将所有内容作为单个参数传递给 php 脚本，例如：

```
RewriteRule /pages/(.+) /page.php?page=$1 [QSA] 
```

在您的 php 脚本中，您对`$_GET['page']`（以上面的示例 RewriteRule 为例）进行一些字符串处理，例如使用[`explode`](http://php.net/explode).

`.htaccess`在 PHP 中，您可以更好地使用数组，而在文件中您根本无法做到这一点。

> *示例取自原始* [Apache HTTP Mod_Rewrite 文档](http://httpd.apache.org/docs/current/rewrite/flags.html#flag_qsa)。

# android - 不能在 Dialog 类中使用 getAsset()

> ID：13863224
> 
> 赞同：1
> 
> 时间：2012-12-13T15:37:13.213
> 
> 标签：android

```
public class Class_UniversityDialog extends Dialog {

public Class_UniversityDialog(Context context) {
    super(context);
}

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.layout_university_info);

    Typeface face = Typeface.createFromAsset(getAssets(), "tahoma.ttf");
    //To Layout Topic persian
    TextView txt_Title = (TextView) findViewById(R.id.lbl_LayoutTopic);
    txt_Title.setTypeface(face);
    String newText = (String) txt_Title.getText().toString();
    txt_Title.setText(PersianReshape.reshape(newText));
} 
```

}

在我的代码中，eclipse 说 getAssets() ：“方法 getAssets() 对于 Class_UniversityDialog 类型未定义”

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:42:53.377

利用

```
getContext().getAssets() 
```

[http://developer.android.com/reference/android/app/Dialog.html#getContext](http://developer.android.com/reference/android/app/Dialog.html#getContext) ()

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T15:42:18.157

尝试使用 context.getAssets()。在使用它之前定义上下文并初始化它。

```
public class Class_UniversityDialog extends Dialog {
Context context;

public Class_UniversityDialog(Context context) {
super(context);
this.context = context;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:55:15.983

```
Typeface tf = Typeface.createFromAsset(getAssets(),"fonts/verdana.ttf");
textfield.setTypeface(tf,Typeface.BOLD); 
```

> 你可以这样使用这个解决了你的问题

# php - 如何删除循环中的行或任何其他方法以获取显示，如下所示

> ID：13863231
> 
> 赞同：1
> 
> 时间：2012-12-13T15:37:33.920
> 
> 标签：php, mysql

需要显示 ![在此处输入图像描述](../Images/932c9869c39bcd6bc05bbcbdd3870254.png)

这是我的代码和显示

```
<table width="100%" cellspacing="0" cellpadding="0" summary="" id="box-table-a">
        <thead>
          <tr>
            <th width="" scope="col"><strong>Item Description</strong></th>
            <th scope="col" style="text-align:center;"><strong>Quantity</strong></th>
            <th width="350" scope="col"><strong>Supplier Name</strong></th>
            <th scope="col" style="text-align:center;"><strong>Unit Price Rs.</strong></th>
            <th scope="col" style="text-align:center;"><strong>VAT Price Rs.</strong></th>
            <th width="100" scope="col"><strong>Total Price Rs.</strong></th>
          </tr>
        </thead>
        <tbody>

          <?php 

          $get_data =mysql_query("SELECT supplier_add_quotaion_form.quotaion_request_id,supplier_add_quotaion_form.supplier_id,supplier_add_quotaion_form.supplier_add_quotaion_id,supplier_add_quotaion_request_item.* FROM supplier_add_quotaion_request_item,supplier_add_quotaion_form 
WHERE supplier_add_quotaion_form.supplier_add_quotaion_id=supplier_add_quotaion_request_item.supplier_add_quotaion_id AND supplier_add_quotaion_form.quotaion_request_id='$id' ORDER BY quotation_item_id");

            while($row = mysql_fetch_array($get_data)){ 
                $quotaion_request_id = $row['quotaion_request_id'];
                $supplier_add_quotaion_id = $row['supplier_add_quotaion_id'];
                $supplier_id = $row['supplier_id'];
                $net_item_value = $row['net_item_value'];
                $vat_item_value = $row['vat_item_value'];
                $total_value = $row['total_value'];
                $quotation_item_id = $row['quotation_item_id'];

                 $get_count = mysql_query("SELECT quotation_item_id FROM supplier_add_quotaion_request_item WHERE quotation_item_id='$quotation_item_id'"); 

                $count = mysql_num_rows($get_count);

                $get_quantity = mysql_query("SELECT quantity_required,item_description FROM clerk_add_quotaion_request_item WHERE quotation_item_id='$quotation_item_id'"); 

                    while($rowB = mysql_fetch_array($get_quantity)){ 
                        $quantity_required = $rowB['quantity_required'];
                        $item_description = $rowB['item_description'];
                    }

            ?>

          <tr>
            <td><?php echo $item_description; ?></td>
            <td align="center"><?php echo $quantity_required; ?></td>
            <td><?php echo $supplier_id; ?></td>
            <td align="center"><?php echo $net_item_value; ?></td>
            <td align="center"><?php echo $vat_item_value; ?></td>
            <td align="center"><?php echo $total_value; ?></td>
          </tr>

          <?php
            }
        ?>
        </tbody> 
```

![在此处输入图像描述](../Images/083ff37cf7588fe69649f5d391a6f25e.png)

*   当重复的描述需要对它们进行行跨度或任何方法需要将显示显示为第一张图像时..我尝试获取计数，然后根据它进行行跨度。但无法获得需要显示，不知道如何删除额外的单元格 ![](../Images/853ee9db63e7d738232cedb1d3a320c4.png)
*   重复行数不固定，仅示例显示第一张图片，一个描述的范围可以是 1-7 个重复（对于一个项目，7 个供应商可以投标）

Supplier_add_quotaion_form 表结构

![供应商_add_quotaion_request_item](../Images/b729bb7898a7965b72b5ea5e3326cc32.png)

Supplier_add_quotaion_request_item 表结构

![Supplier_add_quotaion_form 表结构](../Images/942873a6dbabc627c820a086ea12314e.png)

clerk_add_quotaion_request_item 结构

![在此处输入图像描述](../Images/f5f8a40a920e3816433d11a459845ef6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:46:26.140

将查询结果放入结构化数组中可能会更容易，然后您可以从中轻松检索必要的计数来执行行跨度：

```
$data = array();
while ($row = mysql_fetch_assoc($result)) {
   $data[$row['item_description']][] = $row;
}

echo "start your table here";
foreach($data as $description => $items) {
    echo "<tr><td rowspan=" . count($items) . ">";
    foreach($items as $item) {
        output item data here
    }
} 
```

这不会按原样工作，但应该让您了解如何去做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:55:11.130

你可以一次完成，试试这个

```
<?php 
          $get_data =mysql_query("...");

          $last_quotaion_request_id = -1;
            while($row = mysql_fetch_array($get_data)){ 
                $quotaion_request_id = $row['quotaion_request_id'];
                $supplier_add_quotaion_id = $row['supplier_add_quotaion_id'];
                $supplier_id = $row['supplier_id'];
                $net_item_value = $row['net_item_value'];
                $vat_item_value = $row['vat_item_value'];
                $total_value = $row['total_value'];
                $quotation_item_id = $row['quotation_item_id'];

                 $get_count = mysql_query("SELECT quotation_item_id FROM supplier_add_quotaion_request_item WHERE quotation_item_id='$quotation_item_id'"); 

                $count = mysql_num_rows($get_count);

                $get_quantity = mysql_query("SELECT quantity_required,item_description FROM clerk_add_quotaion_request_item WHERE quotation_item_id='$quotation_item_id'"); 

                    while($rowB = mysql_fetch_array($get_quantity)){ 
                        $quantity_required = $rowB['quantity_required'];
                        $item_description = $rowB['item_description'];
                    }

            ?>

          <tr>
            <?php if($last_quotaion_request_id != $quotaion_request_id){ ?>
            <td rowspan="<?php echo $count; ?>"><?php echo $item_description; ?></td>
            <td rowspan="<?php echo $count; ?>" align="center"><?php echo $quantity_required; ?></td>
            <?php } ?>
            <td><?php echo $supplier_id; ?></td>
            <td align="center"><?php echo $net_item_value; ?></td>
            <td align="center"><?php echo $vat_item_value; ?></td>
            <td align="center"><?php echo $total_value; ?></td>
          </tr>

          <?php
            $last_quotaion_request_id = $quotaion_request_id;
            }
        ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:59:18.647

您需要更改正在使用的表的结构。根据我的猜测，我给出了一个建议。将项目描述保存在一个表格中，将报价详情保存在另一个表格中。在获取数据时，您可以使用 group by sql 命令获取数据。

您的项目表可能是这样的：

```
 1\. id
 2\. desc
 3\. clicks 
```

和报价表可能是这样的

```
 1\. id
 2\. item_id
 3\. supplier
 4\. quantity
 5\. vat
 6\. price 
```

等等

# android - 应用程序已安装但未在我的模拟器上启动

> ID：13863233
> 
> 赞同：0
> 
> 时间：2012-12-13T15:37:36.497
> 
> 标签：android

> 在我的模拟器应用程序安装成功但应用程序没有启动，我在这里粘贴控制台详细信息，我也在添加清单文件，我也添加了意图过滤器。我希望这些信息就足够了，但 stackoverflow 需要更多信息。

```
 [2012-12-13 20:29:52 - PongUr2] Android Launch!
    [2012-12-13 20:29:52 - PongUr2] adb is running normally.
    [2012-12-13 20:29:52 - PongUr2] No Launcher activity found!
    [2012-12-13 20:29:52 - PongUr2] The launch will only sync the application package on the device!
    [2012-12-13 20:29:52 - PongUr2] Performing sync
    [2012-12-13 20:29:52 - PongUr2] Automatic Target Mode: using existing emulator 'emulator-5554' running compatible AVD 'AVD_4.0'
    [2012-12-13 20:29:52 - PongUr2] Uploading PongUr2.apk onto device 'emulator-5554'
    [2012-12-13 20:29:53 - PongUr2] Installing PongUr2.apk...
    [2012-12-13 20:30:00 - PongUr2] Success!
    [2012-12-13 20:30:01 - PongUr2] \PongUr2\bin\PongUr2.apk installed on device
    [2012-12-13 20:30:01 - PongUr2] Done! 
```

这里是 xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.sabrebutt.pongur"
    android:versionCode="49"
    android:versionName="0.8.8.2" >

    <application
        android:icon="@drawable/icon"
        android:label="@string/app_name" >
        <service
            android:name="PongUr"
            android:enabled="true"
            android:icon="@drawable/icon"
            android:label="@string/app_name"
            android:permission="android.permission.BIND_WALLPAPER" >
            <intent-filter android:priority="1" >
                <action android:name="android.service.wallpaper.WallpaperService" />

                <intent-filter>
                    <action android:name="android.intent.action.MAIN" />

                    <category android:name="android.intent.category.LAUNCHER" />
                </intent-filter>
            </intent-filter>

            <meta-data
                android:name="android.service.wallpaper"
                android:resource="@xml/pongur" />
        </service>

        <activity
            android:name="PongUrSettings"
            android:exported="true"
            android:label="@string/pongur_settings"
            android:theme="@android:style/Theme.Black" >
        </activity>
    </application>

    <uses-sdk android:minSdkVersion="7" />
     />

</manifest> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T15:53:59.673

您的所有活动都没有启动器意图过滤器，将以下行添加到您要在清单中启动的活动

```
 <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter> 
```

编辑：您不能在intentFilter 中有一个intentfilter，并且启动器intent 过滤器不能在服务上工作，只能启动Activity 并且可以有UI

```
 <activity
        android:name="PongUrSettings"
        android:exported="true"
        android:label="@string/pongur_settings"
        android:theme="@android:style/Theme.Black" >
    <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
    </intent-filter>
    </activity> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:44:31.723

尝试`Setting -> Application(apps) --> uninstall your app`再次运行您的应用程序。可能它应该可以工作。有时以前的安装会产生这种类型的问题。否则可能是您的清单文件有问题。

# delphi - ICS HTTPCLI 免费异常

> ID：13863235
> 
> 赞同：1
> 
> 时间：2012-12-13T15:37:49.020
> 
> 标签：delphi, delphi-xe2

使用这样的循环制作组件后，如何正确释放组件？如果我像现在这样释放它，我会得到一些 GETMEM.INC 异常。我来自印地，所以我不太了解 ICS。

谢谢

```
 const
    URLs : array[0..3] of string =
    (
      'http://www.example.com',
      'http://www.example.com',
      'http://www.example.com',
      'http://www.example.com'
    ) ;

    var
      Output: array of TStringList;
      S: array of TMemoryStream;
      Async: array of TSslHttpCli;
    implementation

    procedure RequestDone(Sender: TObject; RqType: THttpRequest;
      ErrCode: Word);
    begin
        with Sender as TSSLHTTPCLI do  begin
          S[Tag].Position:=0;
          Output[Tag].LoadFromStream(S[Tag]);
        end;
      end;

    procedure TForm1.Button1Click(Sender: TObject);
    var
    i:integer;
    begin
        for i := 0 to High(URLS) do begin
           S[i]:=TMemoryStream.Create;
           Output[i]:=TStringList.Create;
           Async[i]:=TSslHttpCli.Create(nil);
           Async[i].Tag:=i;
           Async[i].FollowRelocation:=true;
           Async[i].NoCache:=true;

           Async[i].SocketFamily:=sfAny;
           Async[i].OnRequestDone:=RequestDone;
           Async[i].RcvdStream:=S[i];
           Async[i].URL:= URLs[i];
           Async[i].MultiThreaded:=true;
           Async[i].GetASync;
        end;
    end;

    procedure TForm1.Button4Click(Sender: TObject);
    var
    i:integer;
    begin
        for i := 0 to High(URLS) do begin
           Output[i].Free;
           Async[i].RcvdStream.Free;
           Async[i].Free; // << -- EXCEPTION
           //  S[i].Free;
        end;
    end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:52:07.693

`Result`您永远不会为、`Asynch`或分配任何内存`S`。您需要先`SetLength`对它们中的每一个进行操作，然后才能将任何东西放入其中（或将任何东西取出）。

```
procedure TForm1.Button1Click(Sender: TObject);
var
i:integer;
begin
  SetLength(Result, Length(URLS));
  SetLength(S, Length(URLS));
  SetLength(Asynch, Length(URLS));

  for i := 0 to High(URLS) do begin
    S[i]:=TMemoryStream.Create;
    Result[i]:=TStringList.Create;
    Async[i]:=TSslHttpCli.Create(nil);

    // etc.

  end;
end; 
```

顺便说一句，`Result`对于变量来说，这是一个糟糕的名称，尤其是一个全局范围的变量。它是编译器自动生成的函数的返回值，并且在函数中以外的任何地方使用都会使您的代码难以阅读。看这个，例如：

```
var
  Result: string = '';

procedure AddToReslt(CharToAdd: Char);
begin
  // Many many lines of code
  // go in here. Maybe a few loops
  // of if statements.
  Result := Result + CharToAdd;
end;

function DoSomeMath: Integer;
begin
  // Some really complex numeric code, maybe
  // calculating the value of `pi` to the 900th
  // digit 
  Result := 2 * 2;
end; 
```

现在很快 - 记住它们每个都包含大量代码 - 哪个是函数，哪个是过程？

# spring - Quartz org.springframework.beans.factory.BeanCreationException 启动时出错

> ID：13863237
> 
> 赞同：1
> 
> 时间：2012-12-13T15:37:57.713
> 
> 标签：spring, quartz-scheduler

我需要从 UI 调用的方法中访问 SchedulerFactoryBean（使用 1.8 石英）来暂停调度程序并对数据库进行批量更新。

但我无法让 bean 注入工作，给我一个错误：

org.springframework.beans.factory.BeanCurrentlyInCreationException：创建名为“runProcessBranchFolders”的bean时出错：当前正在创建的FactoryBean从getObject返回null

这是来自 applicationContext.xml 的相关代码（我希望）

```
<bean id="cleanHistoricFolder" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean">
    <property name="targetObject" ref="catalogFacadeTarget"/>
    <property name="targetMethod" value="cleanHistoricFolder"/>
    <property name="concurrent" value="false"/>
</bean>

<bean id="simpleTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerBean">
    <!-- see the example of method invoking job above -->
    <property name="jobDetail" ref="runProcessBranchFolders"/>
    <!-- 10 seconds -->
    <property name="startDelay" value="10000"/>
    <!-- repeat every 10 seconds -->
    <property name="repeatInterval" value="180000"/>
</bean>

<bean id="cleanHistoricFolderTrigger"   class="org.springframework.scheduling.quartz.SimpleTriggerBean">
    <property name="jobDetail" ref="cleanHistoricFolder"/>
    <!-- 1 minute -->
    <property name="startDelay" value="60000"/>
    <!-- repeat 24 hours -->
    <property name="repeatInterval" value="86400000"/>
</bean>

<bean id="schedulerFactoryBeanTarget" class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="triggers">
        <list>

            <ref bean="simpleTrigger"/>
             <ref bean="cleanHistoricFolderTrigger"/>
        </list>
    </property>
</bean>

<!-- ========================= BUSINESS OBJECT DEFINITIONS ======================== -->

<bean  id="catalogFacadeTarget" class="com.bamboo.catW3.business.impl.CatalogFacadeImpl">
    <property name="categoryDAO">
        <ref local="categoryDAOTarget"/>

   .
   .
   .
    <property name="schedulerFactoryBean" >
        <ref local="schedulerFactoryBeanTarget" />  
    </property>
</bean> 
```

非常感谢您！

# c++ - 如何判断点云所在的单位？

> ID：13863238
> 
> 赞同：2
> 
> 时间：2012-12-13T15:37:59.087
> 
> 标签：c++, computer-vision, point-clouds, point-cloud-library

我正在使用从 Kinect 图像创建的点云文件数据集。有没有办法知道轴的单位是什么，即一个点`(0.003, 0.004, 0.04)`是米、厘米等？

我正在尝试使用`setRadiusSearch`pcl 中的方法从局部补丁估计表面法线，但这允许我们以米为单位指定半径，所以我需要知道点云的单位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T21:32:49.257

查看器中的轴是您想要的任何单位。你必须知道或从你的来源推断出实际的单位。例如，MS 驱动程序以 mm 为单位返回值。由于您正在处理 Kinect 点云，因此无论驱动程序如何，您都可以轻松找出您的值代表什么：Kinect 的范围为[0.4 到 8 m](http://msdn.microsoft.com/en-us/library/hh973078.aspx)。这意味着 - 例如 - 如果值类似于 (500.0, 600.0, 3000.0)，这意味着它们以 mm 为单位，如果它们是 (0.5, 0.6, 2.0)，则它们以 m 为单位，依此类推。

# c - C中的Posix Pthread

> ID：13863239
> 
> 赞同：1
> 
> 时间：2012-12-13T15:38:02.247
> 
> 标签：c, pthreads, posix

我有以下关于 posix 的 pthread 的问题。

*   当我们接收到`pthread_join()`由线程执行的函数返回的数据时，`(void **)`即使变量是单个指针，我们也会对变量进行类型转换。

    ```
    int *x;

    pthread_join(tid,(void**)&x);

    printf("%d",*x); 
    ```

*   我应该取消对类型转换参数的引用（如果是结构）？为什么我不能喜欢 `struct Data *obj= & (struct Data*)arg;`？

    ```
    int main()
    {
     ...
     pthread_create(tid,NULL,Foo,&obj);
     ...
    }
    void *Foo(void *arg)
    {
        struct Data *obj=* (struct Data*)arg;
    } 
    ```

*   内部如何`pthread_join()`接收返回的变量。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:57:43.333

首先，您永远不应该这样做`(void**)&x`，因为不同类型的指针不必具有相同的大小。

现在，一些场景（一些有效，一些有效但无效，一些刚刚损坏）：

Foo() 返回指向 an 的指针`int (valid)`：

```
void* Foo(void *arg)
{
    int *ret = malloc(sizeof(int));
    *ret = 42;
    return ret;
}

void *ptr;
int *x;
pthread_join(thread, &ptr);
x = ptr;
printf("%d", *x);
free(x); 
```

Foo() 返回一个 int（无效但通常有效）：
int 大于指针的平台将不起作用。

```
void* Foo(void *arg)
{
   return 42;
}

void *ptr;
int x;
pthread_join(thread, &ptr);
printf("%d", (int)ptr); 
```

Foo() 返回指向静态 int 的指针（无效且永远不会工作）： Foo() 中的所有静态内存在 Foo() 返回时被释放，然后`pthread_join()`才能复制该值。

```
void* Foo(void *arg)
{
   int ret = 42;
   return &ret;
}

void *ptr;
int *x;
pthread_join(thread, &ptr);
x = ptr;
printf("%d", *x); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:53:45.847

您不应该这样做：在您对 C 转换的理解水平上，应该简单地禁止。如果您在课程中学到了这一点，那么这并不是真正的高质量。

首先，`&x`是一个指针的地址，所以结果是`int**`，那么好两个间接。

但是将其`int`丢弃是危险的，指向`int`并且`void`在不同平台上不一定具有相同的宽度。所以请做

```
void*x;
pthread_join(tid, &x);

printf("%d",*(int*)x); 
```

# php - 正则表达式：在数字/字符串上拆分字符串？

> ID：13863241
> 
> 赞同：5
> 
> 时间：2012-12-13T15:38:05.123
> 
> 标签：php, regex, string, split, numbers

考虑以下：

```
700italic
regular
300bold
300bold900 
```

所有这些都是不同的示例，每次只会执行其中一行。

预期结果：

```
// 700italic
array(
    0 => 700
    1 => itailc
)

// regular
array(
    0 => regular
)

// 300bold
array(
    0 => 300
    1 => bold
)

// 300bold900
array(
    0 => 300
    1 => bold
    2 => 900
) 
```

我做了以下：

```
(\d*)(\w*) 
```

但这还不够。当我只有两个“部分”（数字|字符串或字符串|数字）时，它有点工作，但如果我向它添加第三个“段”，我将无法工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T15:43:53.857

你可以[`preg_split`](http://php.net/manual/en/function.preg-split.php)改用。然后，您可以使用与单词和字母之间的位置匹配的[环视](http://www.regular-expressions.info/lookaround.html)：

```
$result = preg_split('/(?<=\d)(?=[a-z])|(?<=[a-z])(?=\d)/i', $input); 
```

请注意，`\w`除了字母之外，它还匹配数字（和下划线）。

另一种方法（使用匹配函数）是在每次匹配时`preg_match_all`只使用和匹配数字**或字母：**

```
preg_match_all('/\d+|[a-z]+/i', $input, $result); 
```

现在，您将获得结果数组中每个所需元素的单个匹配，而不是捕获。但是你最后只想要数组，所以你并不关心它们来自哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:49:19.193

可以使用[`PREG_SPLIT_DELIM_CAPTURE`](http://php.net/manual/en/function.preg-split.php)国旗。

例子：

```
<?php

$key= "group123425";
$pattern = "/(\d+)/";

$array = preg_split($pattern, $key, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
print_r($array);

?> 
```

也检查[这个](https://stackoverflow.com/questions/7908327/how-to-explode-a-string-by-any-integer-regex)帖子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:56:15.887

您正在寻找[`preg_split`](http://php.net/preg_split)：

```
preg_split(
    '((\d+|\D+))', $subject, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY
) 
```

[演示](http://eval.in/4550)

或者[`preg_match_all`](http://php.net/preg_match_all)：

```
preg_match_all('(\d+|\D+)', $test, $matches) && $matches = $matches[0]; 
```

[演示](http://eval.in/4559)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T15:51:36.523

也许是这样的：

```
(\d*)(bold|italic|regular)(\d*) 
```

或者

```
(\d*)([a-zA-Z]*)(\d*) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T15:44:04.797

你应该匹配它而不是拆分它..

您仍然可以使用拆分它

```
(?<=\d)(?=[a-zA-Z])|(?<=[a-zA-Z])(?=\d) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T15:47:31.367

您可以使用这样的模式：

```
(\d*)([a-zA-Z]*)(\d*) 
```

或者你可以使用`preg_match_all`这样的模式：

```
'/(?:[a-zA-Z]+|\d+)/' 
```

然后，您可以匹配任意数量的段，每个段仅由字母或数字组成。

# python - 比较两个字典以制作用于库存管理的 CSV

> ID：13863244
> 
> 赞同：0
> 
> 时间：2012-12-13T15:38:14.620
> 
> 标签：python, csv

## 更新：解决方案

我设法让以下代码工作

```
import collections
from lxml import etree
## Up here is code for getting an .xml input file from the user, opening that file, etc. ##
## This part is in a for loop that goes over each order in the xml file ##
## This all would have an extra indent because it is under this: for order in root.xpath('//order'): ##
itemlist = []
    ## This part looks through the .xml file for the order it is currently iterating and puts the items into a list ##
    for element in order.iter('items'):
        itemlist.append ("%s" % str.upper((element.get('type'))))
    ## This part 'sanitizes' the order name from the .xml file for use as a key ##
    for element in order.iter('order'):
        ordername = element.get('name')
        strippedordername = re.sub('[/\()!@#$%^&*()]', '', ordername)
        allordernames.append (strippedordername)
        print strippedordername
        #print itemlist
        ## This bit compiles a shopping list of items in a special dict subclass called a Counter. ##
        ordercounter.update(itemlist)
        ## This part makes a dict with order names for its keys and their corresponding Counter of items as its values ##
        ordersdictsdict[strippedordername] = collections.Counter(itemlist)
zeros = dict((k,0) for k in ordercounter.keys())
for cntr in ordersdictsdict.values():
    cntr.update(zeros)

#print ordercounter
#print ordersdictsdict
key_order = list(ordercounter.keys())
print key_order
with open(out_file,'w') as fout:
    fout.write('Order,'+','.join(key_order)+'\n')
    fout.write('Totals,'+','.join(str(ordercounter[k]) for k in key_order)+'\n') 
    for ordername,dct in ordersdictsdict.items():
        fout.write(ordername+','+','.join(str(dct[k]) for k in key_order)+'\n')
fout.closed 
```

输出最终看起来像这样：

```
Order,Spam,Eggs,Baked Beans,Sausage
Totals,13,1,1,1
Order for Joe,2,1,0,1
Order for Jill,11,0,1,0 
```

## 我有的

我的脚本接受输入的 xml 文件并对其进行解析，查找订单名称，然后查找订单内容。一个xml文件中可以有多个订单。然后我有一个[柜台](http://docs.python.org/2/library/collections.html#collections.Counter)，可以统计所有订单中的所有物品，并给我一个总的购物清单。

鉴于这两个样本订单：

```
Order for Joe: Spam, Egg, Sausage, Spam
Order for Jill: Spam, Spam, Spam, Spam, Spam, Spam, Spam, Beaked Beans, Spam, Spam, Spam, Spam 
```

计数器看起来像这样： `Counter({'Spam': 13,'Baked Beans' 1, 'Egg': 1, 'Sausage': 1})`

然后我将其写入 csv 文件，使其看起来像这样：

```
Item,Count
Spam,13
Baked Bean,1
Egg,1
Sausage,1 
```

## 我想要的是

虽然总购物清单很好，但我想扩展我的输出 csv 文件，以包括每个订单名称的购物清单。我不在乎订单名称是行还是列。我也并不真正关心不在该顺序中的项目的单元格是 a`0`还是空，但我将`0`在我的示例中使用。

订单名称为行的示例所需输出

```
Order Name,Spam,Baked Beans,Egg,Sausage
Totals,13,1,1,1
Order for Joe,2,0,1,1
Order for Jill,11,1,0,0 
```

以订单名称作为列的示例所需输出

```
Item,Totals,Order for Joe,Order for Jill
Spam,13,2,11
Baked Beans,1,0,1
Egg,1,1,0
Sausage,1,1,0 
```

## 笔记

我希望这个脚本适用于任何输入文件——当然，如果输入只包含一个订单，那么`Totals`将匹配该订单名称。我必须首先制作一个总计计数器（以便我拥有相关订单的所有可能项目），然后在 csv 中填写每个订单的计数。换句话说，我无法通过将项目写入硬编码来启动我的 csv 文件，因为下一个输入文件可能在订单中有不同的项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:50:52.140

为什么不能`Counter`对输入文件的每一行都使用 a？

```
from collections import Counter
d = {}  
#*1* Alternatively, could use : d = defaultdict(Counter)
with open(inputfile) as input_file:
    for line in input_file:
        for_who, items = line[:-1].split(':',1)
        d[for_who] = Counter(items.split(','))  
        #Alternatively, if using defaultdict at *1*, d.update(items.split(','))
        #This allows "joe" to register multiple shopping lists which get summed into 1

#get totals by `sum`ming your Counters values:
totals = sum(d.values())

#Now add a 0-dict to each of the dictionaries just to make sure they have all the keys
zeros = dict((k,0) for k in totals)
for cntr in d.values():
    cntr.update(zeros)

key_order = list(totals.keys())  #list for py2k
with open(output_file,'w') as fout:
    fout.write('Order '+','.join(key_order)+'\n')
    fout.write('Totals,'+','.join(str(totals[k]) for k in key_order)+'\n') 
    for person,dct in d.items():
        fout.write(person+','+','.join(str(dct[k]) for k in key_order)+'\n') 
```

如果您的项目的名称中可以包含逗号，您可能需要更加棘手地处理引用（Think `csv`module for that stuff），但这应该为您提供一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:51:31.337

您可以使用 csv.DictWriter 来管理您的输出。

您将为每个单独的订单组装一长串计数器，加上一个包含总数的计数器。

当您阅读输入时，请按如下方式处理输入：

1.  使用 .update 将顺序中的每个项目添加到“总计”字典中
2.  通过创建新的将订单中的每个项目添加到“订单”字典
3.  为每个柜台添加一个“订单名称”键，带有订单名称
4.  创建您的 DictWriter 实例，字段名称为 totals.keys()

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:52:09.923

我建议使用嵌套[`collections.defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)集在 0 处初始化。

假设您的输入文件如下所示：

```
Order for Joe: Spam, Egg, Sausage, Spam
Order for Jill: Spam, Spam, Spam, Spam, Spam, Spam, Spam, Beaked Beans, Spam, Spam, Spam, Spam 
```

然后，您可以获得总计和单个订单计数，如下所示：

```
answer = collections.defaultdict(collections.defaultdict(int))
with open('path/to/input') as infile:
    for line in infile:
        name, _, orders = line.partition(":")
        name = name.rpartition(' ')[-1]
        orders = orders.strip().split(',')
        for order in orders:
            answer['total'][order] += 1
            answer[name][order] += 1
with open('path/to/output') as outfile:
    keys = sorted(answer['total'])
    outfile.write("Order Name,%s" %(','.join(keys)))
    outfile.write('total,%s' %(','.join(answer['total'][k] for k in keys)))
    for name, orders in answer.iteritems():
        if name != 'total':
            outfile.write('%s,%s' %(name, ','.join(answer[name][k] for k in keys))) 
```

# c# - 使用 C# 代码在 HTML 中设置表格行的可见性？

> ID：13863245
> 
> 赞同：2
> 
> 时间：2012-12-13T15:38:14.873
> 
> 标签：c#, html

我想在 html 代码中使用 DateTime.Now.Month 显示/隐藏表格行，但我不记得正确的语法。我的意思是上面，但不是以这种方式工作。什么是正确的语法？提前致谢

```
<tr style='<%# DateTime.Now.Month==11? "display:none": "display:inline"%>' ></tr> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:40:27.347

DateTime.Now.Year 应该是 DateTime.Now.Month

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:39:42.347

您正在使用`javascript`in `style tag`which 未执行。您可以在 body onload 事件或 jquery document.ready 事件上使用 javascript 来执行您的脚本。

您正在使用`2 digit year`并且您将获得`4 digit year`，您需要将 11 更改为 2011。

使用 Javascript

```
<body onload="CallTrShowHIde();">
    <table>    
      <tr id="tr1"  onload='alert("ac")' ><td>hello123</td></tr>
    </table>
</body>

function CallTrShowHIde()
{
      var year = '<%= DateTime.Now.Year %>';
      if (year == 2012)
            document.getElementById('tr1').style.display="none";
        else
            document.getElementById('tr1').style.display = "inline";  
 } 
```

使用 jQuery。

```
<tr id="tr1">
     <td>Show or hide </td>
</tr>

 $(function () {
        var year = '<%= DateTime.Now.Year %>';
        if (year == 2012)
            $('#tr1').hide();
        else
            $('#tr1').hide();
 }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T15:56:52.543

Asp 标签有多种口味。您编写的代码是正确的，但是因为您使用了错误的 asp 标签，所以没有显示任何内容。

这是您要使用的标签： `<%= %>`对于显示单条信息最有用

这是您当前使用的标签： `<%# %>`数据绑定表达式语法 这不起作用，因为您没有使用数据绑定，您只是在回显一个字符串。

更多信息在这里：[http](http://forums.asp.net/p/1139381/1828702.aspx) ://forums.asp.net/p/1139381/1828702.aspx 和这里[http://msdn.microsoft.com/en-us/library/6dwsdcf5.aspx](http://msdn.microsoft.com/en-us/library/6dwsdcf5.aspx)

# ios - coreplot：在散点图中加入缺失的线点

> ID：13863250
> 
> 赞同：1
> 
> 时间：2012-12-13T15:38:25.573
> 
> 标签：ios, xcode, charts, core-plot, scatter-plot

我有一个在同一绘图区域中有多个散点图的图表......就像图像一样。对于“FC”系列，我没有 11:00 和 12:00 的值（如您所见）......但我需要逐行连接这些点（点 A 和 B）。

这是图像： [!image](https://lh5.googleusercontent.com/-FKuZ3G6ytgc/UMn0gLgrMYI/AAAAAAAAACY/K7etqjSVVz4/s1600/graph.png)

我该怎么做？

谢谢！阿尔米尔！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T01:24:04.590

根本不提供缺失部分的数据点。在您的示例中，红色图只有四个点，分别位于 0900、1000、1300 和 1400。

# c# - 使用 C# 和 Excel 互操作

> ID：13863258
> 
> 赞同：1
> 
> 时间：2012-12-13T15:38:48.200
> 
> 标签：winforms, c#, winforms

我有这个代码：

```
Microsoft.Office.Interop.Excel.Application xla = new Microsoft.Office.Interop.Excel.Application();
xla.Visible = false;
Workbook wb = xla.Workbooks.Add(XlSheetType.xlWorksheet);
Worksheet ws = (Worksheet)xla.ActiveSheet;
ws.Name = "Serial";
int i = 1;
foreach (DataRow comp in dsView.Tables[0].Rows)
{
    ws.Cells[i, 1] = "'" + comp[0].ToString();
    ws.Cells[i, 2] = "'" + comp[1].ToString();
    ws.Cells[i, 3] = "'" + comp[2].ToString();
    i++;
}
if (File.Exists(@"d:\DDD.xlsx"))
    File.Delete(@"d:\DDD.xlsx");
xla.Save(@"d:\DDD.xlsx");    ---->>>>  on this line i get the error 
```

错误：

> HRESULT 异常：0x800A03EC

我正在使用 Office 2012处理 C# [winforms](/questions/tagged/winforms "显示标记为“winforms”的问题")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:12:58.363

您的问题是变量 xla 是您的 excel 应用程序，而不是工作簿。您要保存工作簿。

所以

```
xla.Save(@"d:\DDD.xlsx");    ---->>>>  on this line i get the error 
```

应该

```
wb.SaveAs(@"d:\DDD.xlsx", System.Reflection.Missing.Value,System.Reflection.Missing.Value,System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,System.Reflection.Missing.Value,Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlNoChange,System.Reflection.Missing.Value,
                System.Reflection.Missing.Value,System.Reflection.Missing.Value,System.Reflection.Missing.Value,System.Reflection.Missing.Value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T18:14:45.850

当我`Excel.Application.Save()`使用面向 .NET 4 的 Visual Studio 2010 和 Excel 2010 互操作 (Office 14) 运行时，它会显示一个对话框来选择保存文件的位置。在该对话框上单击“取消”会导致 COM 异常。但是单击保存有奇怪的结果：当我提供一个有效的文件路径和名称作为参数`Excel.Application.Save(@"C:\blah.xlsx")`时，我最终保存了两个文件。第一个名为 Sheet1.xlsx 并包含我所期望的，即使我没有在对话框中选择该名称。另一个名为 blah.xlsx（根据我的文件名参数），不会在 Excel 中正确打开。如果我`Excel.Application.Save()`在没有文件名作为参数的情况下调用，则会使用我在对话框中选择的名称和路径保存一个有效文件，但我也会得到一个“RESUME.XLW”文件。所以看起来`Application.Save`方法可能不是一个好的选择。相反，你可以做这样的事情，就像你期望的那样：

```
using System;
using Excel = Microsoft.Office.Interop.Excel;
namespace WindowsFormsApplication2
{
    static class Program
    {
        static void Main()
        {
            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook book = xlApp.Workbooks.Add(Excel.XlSheetType.xlWorksheet);
            Excel.Worksheet sheet = book.ActiveSheet;
            sheet.Name = "Booya";
            Excel.Range range = sheet.Cells[1, 1];
            range.Value = "This is some text";
            book.SaveAs(@"C:\blah.xlsx");
        }
    }
} 
```

# android - Android AsyncTask PostExecute

> ID：13863260
> 
> 赞同：-3
> 
> 时间：2012-12-13T15:38:53.987
> 
> 标签：android

我在函数中使用 AsyncTask 如何在异步完成执行时返回一个值，因为我不能在这里使用 PostExecute 方法

```
AsyncTask.execute(new Runnable() {
            public void run() {}} 
```

继承人的代码。我需要从 SpinnerList 中检索值以在主线程上使用 em。但是通常每当我要求数据时我都会得到空值，因为它还没有返回值。

```
AsyncTask.execute(new Runnable() {
            public void run() {
                try{
                    String fql = "SELECT uid, name FROM user WHERE is_app_user  AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me())";
                    Bundle parameters = new Bundle();

                    parameters.putString("query", fql);
                    parameters.putString("method", "fql.query");
                    parameters.putString("access_token",  fb.getAccessToken());
                    String Response = fb.request(parameters);
                    JSONArray json = new JSONArray(Response);
                    list = new ArrayList<String[][]>();
                    String[][] friendsToList = new String[1][2];
                    SpinnerList = new ArrayList<String>();
                    String TempToSpinnerList=new String();
                    for(int i = 0; i < json.length(); ++i){
                        friendsToList[0][0] = json.getJSONObject(i).getString("uid");
                        friendsToList[0][1] = json.getJSONObject(i).getString("name");
                        TempToSpinnerList= friendsToList[0][1];
                            list.add(friendsToList);
                            SpinnerList.add(TempToSpinnerList);
                            Log.e("Test"," "+friendsToList[0][1]+" "+friendsToList[0][0]);
                        }

                        //dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
                        //spinner.setAdapter(dataAdapter);

    /*  jsonUser = fb.request(parameters);
        friendObj = Util.parseJson(jsonUser);

        friendArray = friendObj.getJSONArray("data");

        //
        friendlist = new ArrayList<String[][]>();
        String[][] friendsToList = new String[1][2];
        int friendCount = 0;
        String fId, fNm;
        JSONObject friend;
        for (int i = 0;i<friendArray.length();i++){
            //Get a JSONObject from the JSONArray
            friend = friendArray.getJSONObject(i);
            //Extract the strings from the JSONObject
           friendsToList[0][0] = friend.getString("id");
            friendsToList[0][1] = friend.getString("name");
            friendlist.add(friendsToList);
            //Set the values to our arrays
         Log.e("Tester",""+ friendsToList[0][0]+" "+ friendsToList[0][1]);
            friendCount ++;}*/
            }
                catch (MalformedURLException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (FacebookError e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }   
            }}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T15:46:58.747

如果您想在 Asynctask 完成后执行某些功能，您可以在调用活动中设置回调函数。在 AsyncTask 类中创建一个构造函数并将调用活动传递给它。然后在您的任务完成时使用此引用调用回调函数。

您还可以从 onPostExecute 中更新 UI，如果它适合您，这会更简单。

```
public class MyTask extends AsyncTask<String, Void, String>
{
    private MainActivity activity;

    public MyTask(MainActivity activity) {
        this.activity = activity;
    }
    @Override
    protected Void doInBackground(String... params) {
        //Do background stuff
    }

    protected void onPostExecute() {
        //dismiss progress dialog if needed
        //Callback function in MainActivity to indicate task is done
        activity.taskDone("some string");
    }
} 
```

MainActivity.java

```
//Pass your params array and the current activity to the AsyncTask
new MyTask(MainActivity.this).execute(params);

//Callback for AsyncTask to call when its completed
public void taskDone(String returnVal) {
    //Do stuff once data has been loaded
    returnText = returnVal;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:40:59.750

您不会从 AsyncTasks 返回值。您需要将要更改的任何内容传递给 AsyncTask 并在 onPostExecute() 中更改值。请发布更多代码并更好地解释您的方案以获得完整答案。

编辑：正如 Jamis0n 所述，AsyncTask 计算的值也可以使用 get() 方法“获取”。

# winforms - 需要有关在 PowerShell 中创建动态表单的帮助

> ID：13863263
> 
> 赞同：1
> 
> 时间：2012-12-13T15:39:07.973
> 
> 标签：winforms, user-interface, powershell

嗨，我正在尝试在 pwoershell 中创建一个动态表单，这是一个有 5 个按钮（颜色名称）的表单，每个按钮打开一个不同的文本文件（例如，如果单击红色按钮，它应该打开 red.txt；这里是完整代码；

# 脚本开始

```
$var = "Red","Blue","Yellow","Black","White"

$testForm = New-Object System.Windows.Forms.Form
$testForm.Text = "Color List"
$testForm.AutoSize = $True
$testForm.AutoSizeMode = "GrowAndShrink"     

$Font = New-Object System.Drawing.Font("Times New Roman",24, [System.Drawing.FontStyle]::Bold)   
$testForm.Font = $Font

$Label = New-Object System.Windows.Forms.Label
$Label.Text = "Select the Color"
$Label.AutoSize = $True
$testForm.Controls.Add($Label)

$x=100
$y=50
foreach($color in $var)
{
    $run = New-Object System.Windows.Forms.Button
    $run.Location = New-Object System.Drawing.Size($x,$y)
    $run.Size = New-Object System.Drawing.Size(100,50)
    $run.Text = "$Color"
    $run.Add_Click({ Invoke-Expression "notepad C:\Users\User\$color.txt" })
    $testForm.Controls.Add($run)
    $Font = New-Object System.Drawing.Font("Times New Roman",14,[System.Drawing.FontStyle]::Regular)
    $run.font = $Font
    $run.AutoSize = $True
    $y+=50

}
$testForm.ShowDialog() 
```

# 结束脚本

一切都很好，直到当表单打开按钮时，点击所有按钮时，打开文件“White.txt”，因为它是数组中的最后一个元素；有什么方法可以更改脚本以使每个按钮只打开它们各自的文件而不是最后一个颜色文件？

如果需要任何进一步的问题或澄清，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:00:55.510

看起来问题出在 Add_Click 行。脚本块包含一个指向变量 $color 的链接，而不是立即评估它以为 Invoke-Expression 创建一个新的“记事本...”字符串并链接到它。单击按钮时将创建 Invoke-Expression 的字符串。这时候 $color 是 White '因为循环已经结束，所以所有的按钮最终都会使用 White 创建一个字符串。

您可以通过调用 GetNewClosure() 来修复它，这将导致在循环期间创建 Invoke-Expression 的字符串，而不是稍后单击按钮时。因此，将行更改为：

```
$run.Add_Click({ Invoke-Expression "notepad C:\Users\User\$color.txt" }.GetNewClosure()) 
```

它应该按预期工作。

# c# - 字节[] 到浮点[] 到字节[]

> ID：13863264
> 
> 赞同：0
> 
> 时间：2012-12-13T15:39:10.017
> 
> 标签：c#, type-conversion

对于某些计算，我需要使用浮点数，但我有一个 byte[] 可供我使用，所以我首先这样做：

```
Array.Copy(byteArray, floatArray, byteArray.Length); 
```

效果很好，我对浮点数进行了一些计算。但现在我需要将其转换回 byteArray。我不能使用下面的代码，它崩溃了，没有给出具体的错误信息。

```
float[] DiffernetfloatArray= new float[ byteArray];  
Array.Copy(DiffernetfloatArray, byteArray, DiffernetfloatArray.Length); 
```

首先我认为这是不正确的大小，但是我使用的浮点数组，我将大小增加了 500 只是为了测试，仍然给了我同样的错误

有谁知道我该如何解决这个问题？最好用 C# 回答

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:43:49.350

使用 linq 更容易：

```
var byteArray = floatArray.Select(f => Convert.ToByte(f)).ToArray();
var floatArray = byteArray.Select(b => (float)Convert.ToDouble(b)).ToArray(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:44:23.127

有一个更简单的方法：

```
System.BitConverter.GetBytes(float) 
```

[MSDN](http://msdn.microsoft.com/en-us/library/system.bitconverter.getbytes.aspx)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-13T15:41:52.660

一个字节可以转换为一个浮点数，因为它适合该类型，但是通过隐式转换不能完成另一种方式 - 一个浮点数可能太大而无法放入一个字节，因此`Array.Copy`在这种情况下永远不会工作.

# parsing - 打印导致解析错误的令牌和行

> ID：13863267
> 
> 赞同：0
> 
> 时间：2012-12-13T15:39:24.487
> 
> 标签：parsing, bison

有没有办法知道解析器中的错误发生在哪里，这意味着哪个**令牌**出现了错误以及哪一**行**，我不知道如何使用可以在 lex 文件中轻松使用的 yylineno ？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T11:34:46.907

您应该在 flex（`%option debug`并设置`yy_flex_debug`为 1）和解析器（`%debug`并设置`yydebug`为 1）中启用调试跟踪。查看他们的文档。

# jasper-reports - Jasper iReport - 仅在最后一页上的属性文本

> ID：13863269
> 
> 赞同：0
> 
> 时间：2012-12-13T15:39:27.057
> 
> 标签：jasper-reports, ireport

我有一份报告，其中包含来自数据库字段的组详细信息，并且我有 3 种语言的报告。

现在，我想显示某些文本 ex:`$R{endtext}`仅来自我`.properties`最后一页的文件。

我已经尝试过但没有奏效的是：

*   最后一页页脚
*   概括
*   试图在整个报告中添加一个组..在 xml

# linux-security-module - Linux 模块：收到关于任务创建和销毁的通知

> ID：13863270
> 
> 赞同：3
> 
> 时间：2012-12-13T15:39:31.610
> 
> 标签：linux-security-module

对于 Linux 上的 Mach 内核 API 仿真，我需要在刚刚创建或终止任务时调用我的内核模块。

在我的内核模块中，这可以通过 Linux 安全模块很好地完成，但几年前，它们通过取消导出所需的符号来阻止外部模块充当 LSM。

我能找到的唯一其他方法是让我的模块像一个 rootkit。找到系统调用表并将其挂在那里。

修补内核是不可能的。我需要轻松安装我的应用程序。还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T02:18:18.647

您可以使用[Kprobes](http://www.kernel.org/doc/Documentation/kprobes.txt)，它使您能够动态地挂接到内核中的代码。您将需要在涉及创建和销毁为您提供所需信息的流程的功能中找到正确的功能。例如，对于创建的任务，fork.c 中的 do_fork() 将是一个很好的起点。对于销毁的任务，do_exit。您可能想要编写一个 retprobe，它是一种 kprobe，它还可以在函数执行结束时，在它返回之前让您控制它。您希望在函数返回之前进行控制的原因是通过检查返回值来检查它是否成功创建进程。如果出现错误，则函数将返回负值，或者在某些情况下可能返回 0。

你可以通过创建一个 kretprobe 结构来做到这一点：

```
static struct kretprobe do_fork_probe = {
    .entry_handler = (kprobe_opcode_t *) my_do_fork_entry,
    .handler = (kprobe_opcode_t *) my_do_fork_ret,
    .maxactive = 20,
    .data_size = sizeof(struct do_fork_ctx)
}; 
```

当控制进入挂钩函数时，my_do_fork_entry 被执行，而 my_do_fork_ret 在它返回之前被执行。您可以按如下方式连接它：

```
do_fork_probe.kp.addr =
    (kprobe_opcode_t *) kallsyms_lookup_name("do_fork");

if ((ret = register_kretprobe(&do_fork_probe)) <0) {
    // handle error
} 
```

在你的钩子的实现中，获取参数和返回值有点笨拙。您可以通过保存的寄存器 pt_regs 数据结构获得这些信息。让我们看一下返回钩子，在 x86 上，您可以通过 regs->ax 获得返回值。

```
static int my_do_fork_ret(struct kretprobe_instance *ri, struct pt_regs *regs)
{
    struct do_fork_ctx *ctx = (struct do_fork_ctx *) ri->data;
    int ret = regs->ax; // This is on x86
    if (ret > 0) {
        // It's not an error, probably a valid process
    }
} 
```

在入口点，您可以通过寄存器访问参数。例如，在 x86 上，regs->di 是第一个参数，regs->si 是第二个参数，等等。您可以通过 google 获取完整列表。请注意，您不应依赖这些寄存器作为返回挂钩中的参数，因为这些寄存器可能已被其他计算覆盖。

你肯定要跳很多圈才能让它工作，但希望这篇笔记能让你朝着正确的方向前进。

# javascript - 单击时切换图像

> ID：13863271
> 
> 赞同：0
> 
> 时间：2012-12-13T15:39:32.763
> 
> 标签：javascript, jquery

我正在尝试在 Click 上切换图像。它部分有效，但部分无效**：'（**
**演示：http:** [//jsfiddle.net/Tqwdh/4/](http://jsfiddle.net/Tqwdh/4/)。

当我单击大图像时，较小的图像会发生变化（从 50x50 变为 151x151） -*哇！*

但是当我单击“阅读更多”文本时，小图像仍然是相同的图像。**当我单击“阅读更多”文本时，需要更改小的嵌套图像。**

谁能告诉我如何解决这个问题？

我附上了我的**jQuery**：

```
$(function(){
        // The height of the content block when it's not expanded
        var adjustheight = 130;
        // The "more" link text
        var moreText = "Click to read more...";
        // The "less" link text
        var lessText = "Click to read less...";
        // Sets the .more-block div to the specified height and hides any content that overflows
        $(".more-less .more-block").css('height', adjustheight).css('overflow', 'hidden');
        // The section added to the bottom of the "more-less" div
        $(".more-less").append('<p style="display:block;margin-top:8px"><a href="#" class="adjust"></a></p>');
        $("a.adjust").text(moreText);
        $(".adjust").toggle(function() {
                $(this).parents("div:first").find(".more-block").css('height', 'auto').css('overflow', 'visible');
                // Hide the [...] when expanded
                $(this).parents("div:first").find("p.continued").css('display', 'none');
                $(this).text(lessText);
            }, function() {
                $(this).parents("div:first").find(".more-block").css('height', adjustheight).css('overflow', 'hidden');
                $(this).parents("div:first").find("p.continued").css('display', 'block');
                $(this).text(moreText);
        });
        });

        $(function(){
            $('img').click(function(){
                $(this).closest('article').find('.adjust').click();
            });
        });

        $(function(){ 
           $("article").click(function(){ 
           $("img.small").attr('src',  
                        ($("img.small").attr('src') == 'http://placehold.it/50x50'  
                    ? 'http://placehold.it/151x151'  
                    : 'http://placehold.it/50x50' 
                             ) 
                        )  
            }); 
        }); 
```

和我的**HTML**：

```
<article id="post-5" >

            <div class="more-less">    
                <div class="more-block">
                    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed diam purus, lacinia eget placerat sit amet, bibendum nec nisl. Curabitur a mattis ipsum. Praesent quis nisi in purus malesuada rhoncus. Pellentesque ut quam eget libero congue lobortis. Nunc sed quam ac erat lobortis eleifend. Donec elementum sodales cursus. Aliquam porttitor massa nisi, in laoreet turpis. Sed consequat condimentum lorem ut dignissim. Sed hendrerit mauris ut massa fermentum laoreet. Pellentesque a leo vitae enim dictum lobortis. Praesent commodo feugiat velit iaculis malesuada.</p>
                    <p>Praesent sem lectus, ullamcorper eget ullamcorper a, congue vel nisl. Nullam volutpat leo vel dui venenatis dapibus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus ac scelerisque lorem. Ut blandit magna eu turpis posuere gravida. Fusce egestas risus in libero ullamcorper sagittis. Vestibulum molestie metus vitae quam dignissim consequat. Vivamus id tellus id lorem consectetur iaculis sit amet interdum ante. Quisque lacinia tellus id mi tincidunt fermentum dignissim velit laoreet. Quisque scelerisque nunc iaculis nisi varius ultrices.</p>
                    <p>Phasellus id elit ac lacus faucibus ullamcorper. Etiam ullamcorper pretium tellus, ut pharetra ante pulvinar vel. Sed neque diam, semper vel rhoncus non, congue ut sapien. Integer a mi eget libero elementum lobortis. Donec hendrerit egestas ligula sit amet eleifend. Curabitur pharetra venenatis tempor. Quisque pulvinar malesuada justo, ut euismod arcu pharetra vitae. Cras lobortis, ligula id euismod euismod, ipsum risus varius urna, faucibus gravida lectus mi nec nulla. Fusce eleifend fringilla nibh ut vulputate. Vivamus sagittis leo metus. Etiam facilisis convallis lacus adipiscing hendrerit. Duis ultricies euismod libero, nec blandit est semper a. Phasellus sit amet justo sed quam elementum lobortis. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
                </div>
            </div>

            <p>
                <img src="http://placehold.it/50x50" class="small" style="position:absolute;margin-left: 240px;margin-top: 127px;" />
                <a href="#" title="News Item 1"><img src="http://placehold.it/300x187" alt="News Item 1" width="300" height="187" /></a>
            </p>            

        </article> 
```

**非常感谢您的任何指点。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:54:06.587

所以，如果我对你的理解正确，你所要做的就是，

改变这个

```
$("article").click(function() {
        //your code here
    }); 
```

到，

```
$("article, .adjust").click(function() {
        //your code here
    }); 
```

[在这里](http://jsfiddle.net/Tqwdh/5/)检查小提琴

**编辑：**

更改了一些内容以匹配您的需要，

1）改变这个，

```
$(this).parents('article').find('.adjust').click(); 
```

到，

```
$(this).parents('article').find('.adjust').trigger('click'); 
```

因为后者是触发事件的正确方法。

2）图像交换功能的改变，

```
$("article, .adjust").click(function() {
    /*Save references in variables*/
    var imgToSwap = $(this).parents("article").find("img.small");
    var img_small = 'http://placehold.it/50x50';
    var img_large = 'http://placehold.it/151x151';

    imgToSwap.attr('src', (imgToSwap.attr('src') ==  img_small ? img_large : img_small));
}); 
```

使用`$(this)`将帮助您在正确的上下文中获取图像。

在这里检查[小提琴测试](http://jsfiddle.net/Tqwdh/8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:58:13.780

看起来你在这里遇到了一些问题。我没有看到您已将`adjust`该类应用于 HTML 中的任何元素。我还看到 CSS 直接应用于 JavaScript。（为什么不使用 .css 文件？）

这部分代码看起来很不错：

```
$("img.small").attr('src',  
    ($("img.small").attr('src') == 'http://placehold.it/50x50'  
    ? 'http://placehold.it/151x151'  
    : 'http://placehold.it/50x50' )) 
```

这很好地使用了三元运算符。

我建议您将此代码用作 上的单击处理程序`a.adjust`，假设扩展图像的链接应该用`adjust`类装饰？

```
var changeImage = function() {
    $("img.small").attr('src',  
    ($("img.small").attr('src') == 'http://placehold.it/50x50'  
    ? 'http://placehold.it/151x151'  
    : 'http://placehold.it/50x50' ))
});
$('a.adjust').click(changeImage);
$('article').click(changeImage); 
```

我希望这有帮助。如果问题写得更准确，它可能会有所帮助。

# android - 发生 5 触摸手势时如何启动应用程序

> ID：13863273
> 
> 赞同：-1
> 
> 时间：2012-12-13T15:39:36.810
> 
> 标签：android, homescreen, lockscreen

当设备在主屏幕或锁定屏幕上感应到 5 触摸手势时，是否有人对如何启动应用程序有任何建议？我正在构建一个应用程序，该应用程序将在一次触摸主屏幕或锁定屏幕时感应到 5 次触摸，并将 5 个点的确切坐标发送到应用程序。对此的任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:43:53.813

这是不可能的，除非您是相关主屏幕的作者。

# jquery - 所有阅读更多/阅读更少同时打开

> ID：13863279
> 
> 赞同：0
> 
> 时间：2012-12-13T15:39:56.747
> 
> 标签：jquery

使用并修改了下面的代码。完全按照我需要的方式工作，但是当我在同一页面上多次使用它时，它会同时打开我的所有摘录。有谁知道为什么，我需要做什么才能停止并仅在已单击的项目上打开？

HTML：

```
<article class="excerpt">
   <h2>Title</h2>
   <p>This is a sentence...</p>
   <div class="full-story">
      <p>This is the rest of the first sentence...</p>
   </div>
   <a class="excerpt-trigger" href="#">Read More</a>
</article> 
```

jQuery：

```
$('.full-story').hide();

$('.excerpt-trigger').toggle(function() {
  $('.full-story').fadeIn('slow');
  $(".excerpt-trigger").removeClass("is-more");
  $(".excerpt-trigger").addClass("is-less");
  $(this).text("Less info");
}, function() {
  $('.full-story').hide('fast');
  $(".excerpt-trigger").addClass("is-more");
  $(".excerpt-trigger").removeClass("is-less");
  $(this).text("More info");
}); 
```

抱歉，省略了摘录触发类。更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:43:39.163

选择器如`$('.full-story')`将选择***所有***具有 class 的元素`full-story`。您想要的是引用当前正在单击的元素 using `$(this)`，然后选择下一个`full-story`using `.next('.full-story')`。您可以使用 选择其子元素，`.children()`使用 选择前一个元素`.prev()`。

在你的情况下，它应该是这样的：

```
$('.excerpt-trigger').toggle(function() {
    var ref = $(this); // Caching is good.
    ref.prev('.full-story').fadeIn('slow');
   ref.removeClass("is-more").addClass("is-less").text("Less info");
}, function() {
    var ref = $(this);
    ref.prev('.full-story').hide('fast');
    ref.addClass("is-more").removeClass("is-less").text("More info");
}); 
```

这是关于[`.next()`](http://api.jquery.com/next/)和[`.children()`](http://api.jquery.com/children/)的文档[`.prev()`](http://api.jquery.com/prev/)。

此外，您可能希望在单击 时防止事件冒泡`<a>`，以便`href="#"`不会继续执行指令。查看[event.preventDefault()](http://api.jquery.com/event.preventDefault/)；

# gwt - GWT 中的非小部件元素是否有等效于 EnsureDebugId() 的方法？

> ID：13863282
> 
> 赞同：0
> 
> 时间：2012-12-13T15:40:06.510
> 
> 标签：gwt, selenium, automation

我目前正在使用 Selenium 和 Java 为 GWT 应用程序编写自动化测试。对于 Widget 的页面元素，这相对简单，因为可以使用 ensureDebugIds() 方法设置唯一 ID。

但是，我使用的页面上的某些类型不是小部件，而是其他类型，可能是容器类型（例如作为基本 HTML 表格的单元格或网格行）。是否有类似的方法来确保DebugIds()？或者有没有办法为这些元素创建自定义 ID，其行为方式与 ensureDebugId()*兼容？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:37:48.200

您需要与您的开发团队密切合作，为 GWT 在其 ensureDebugId 中未处理的任何元素设置 Id。因为所有 UIObjects 都有 setId api，所以它的 id 很简单。如果要注入任何 HTML 代码，则需要通过简单的约定来确定 id，并为 Selenese 测试用例编写设置更容易。

# coldfusion - ColdFusion10的进口证书

> ID：13863292
> 
> 赞同：2
> 
> 时间：2012-12-13T15:40:31.620
> 
> 标签：coldfusion, ssl-certificate, coldfusion-10

尝试将证书导入到 ColdFusion10 中的 cacerts 故事中。我能够运行这些命令并使用这些命令获取要导入的 .cer 文件。

> 手动导入证书
> 转到相关 SSL 服务器上的页面。
> 
> 1.  双击锁定图标。单击详细信息选项卡。单击复制到文件。选择 base64 选项并保存文件。将 CER 文件复制到 C:\ColdFusion9\runtime\jre\lib\security（或使用的任何 JRE ColdFusion）。在同一目录下运行以下命令
> 
> `keytool -import -keystore cacerts -alias giveUniqueName -file filename.cer`

但是当我尝试进行 cfhttp 调用时，它失败了。我怀疑我以错误的格式保存证书。

我使用的是推荐格式 X.509 .der。这是同一个base64吗？有人知道 CF10 上的相关文档吗？我在 CF9 上成功地做到了这一点，但它似乎不适用于 CF10。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:20:33.067

您确定导入有效吗？每当我过去导入证书（使用 CF9）时，我都需要提供 cacerts 密钥库的密码。我在您发布的示例中没有看到这一点。导入的命令应该是这样的：

```
keytool -import -v -alias giveUniqueName -file filename.cer -keystore cacerts -storepass thePassword 
```

这是验证导入证书的命令行：

```
keytool -list -v -keystore cacerts -alias giveUniqueName -storepass thePassword 
```

*我没有在这里包含密码，但我很确定你可以谷歌它。如果没有，给我发消息，我可以给你。*

是的，我也总是以 DER 格式导出证书。那应该行得通。此外，您可能需要提供路径信息，具体取决于您从哪里运行 keytool 命令以及证书文件所在的位置。

另请注意，请确保您正在更新 ColdFusion 正在使用的正确 cacerts 文件。如果您在该服务器上安装了多个 JRE。您可以在“系统信息”下从管理员那里验证 JRE ColdFusion 是否正在使用。寻找`Java Home`线。

哦 - 你必须在导入后重新启动 ColdFusion。

***CF10 更新***

我发现一个论坛讨论（[这里](http://forums.adobe.com/message/4246821)）谈论在 CF10 上安装证书。这些`keytool`命令在它们的示例中似乎略有不同。如果它与 CF9 有点不同，他们是这样说的：

```
keytool -importcert -alias giveUniqueName -trustcacerts -file filename.cer -keystore cacerts -storepass thePassword
Trust this certificate? [no]:  y 
```

看起来验证命令行没有改变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:38:51.660

我建议使用 riaforge 的 Certman 以确保正确导入所有内容

[http://certman.riaforge.org/](http://certman.riaforge.org/)

# python - 未声明的对象何时获得 id？

> ID：13863293
> 
> 赞同：1
> 
> 时间：2012-12-13T15:40:33.947
> 
> 标签：python, theory

理论题

每个 Python shell 都有无需声明或创建即可使用的对象，例如 True、False、""、[]、{}，以及整数和浮点数的任意组合。

这意味着在任何时候，您都可以获得他们的 ID。

```
id(1)
id(42)
id('') 
```

等等

当然，如果您尝试获取未声明对象的 id，您会得到：

```
id(myobject1)

Traceback (most recent call last):
  File "<pyshell#29>", line 1, in <module>
    id(myobject1)
NameError: name 'myobject1' is not defined 
```

由于 myobject1 没有指向任何内容，因此它没有被定义，也没有 id。

然而，有无限数量的对象可以在没有声明的情况下使用，因为数字系统是无限的。因此，在程序中以某种身份使用之前，所有未声明的对象都不可能拥有 id。

这些对象何时获得分配的 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:45:14.703

您误解了分配的概念。

在分配中，您将对象绑定到名称。所有分配给的名称都可以以任何想要的方式使用，未分配的名称不存在，因此不能指向任何东西（包括“无处”）。

与`id(spam)`您询问`spam`指向的对象，然后询问其ID。

不存在的名称`spam`没有分配给其 ID 可以查询的对象。

OTOH，每个对象都有一个 ID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:08:14.277

我将尝试一一反驳这些误解。这可能有用也可能没用。

> 每个 Python shell 都有无需声明即可使用的对象

Python 中没有“声明”对象的概念。因此，对象既没有被声明也没有被声明。

> 或创建

您不能使用未创建的对象。所有存在的对象都有 id。

> 真假

`True`并且`False`是存在的对象。他们有身份证。

> ""、[]、{} 以及整数和浮点数的任意组合。

执行代码时，文字变成对象。字的组合，`{}`本质上是一种说法的捷径`dict()`。创建的对象有 id。

> 当然，如果您尝试获取未声明对象的 id，则会得到 NameError。

否。 NameError 是当您尝试使用尚未定义的名称时。

> 由于 myobject1 没有指向任何内容

错了，它并没有“指向任何东西”。它没有被定义。它不能指向任何东西，它不存在。

> 并且没有身份证。

名称没有 ID。对象有 id。当你说

```
>>> foo = 5
>>> id(foo)
137396064 
```

您不是在询问 name 的 id `foo`。您正在询问名称 foo 分配给的对象的 id。如果你现在重新分配 foo，你会得到另一个 id：

```
>>> bar = foo
>>> foo = "string"
>>> id(foo)
3075254336
>>> id(bar)
137396064 
```

对象的 id 保持不变，名称已重新分配。

> 然而，有无数的对象可以在没有声明的情况下使用

不，他们不是。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:10:02.717

对于您关于何时`42`成为分配的 id 的问题：您可以考虑`42`be `int(42)`。它为值为 42 的整数分配内存。构造整数后，将其传递给`id()`函数。之后，整数的引用计数递减，因此被释放。

从技术上讲，对象的 id 只不过是它在内存中的地址。

# c# - C#代码看不懂

> ID：13863295
> 
> 赞同：-3
> 
> 时间：2012-12-13T15:40:42.563
> 
> 标签：c#

我有一个问题，因为我是 C++ 的编码员，现在我需要阅读一些 C# 代码。这是命名空间中的一个类，我不明白的是最后一个成员；

```
public string FilePath
{
            get { return this.filePath; }
            set { this.filePath = value; }
} 
```

我不知道它是成员变量还是成员函数。

如果将其视为成员函数，它应该喜欢

```
public string FilePath(***)
{
****;
} 
```

但是这里它没有（）类似的参数，它是什么类型的函数？

```
 class INIFileOperation
    {
    private string filePath;

    [DllImport("kernel32")]
    private static extern long WritePrivateProfileString(string section,
    string key,
    string val,
    string filePath);

    [DllImport("kernel32")]
    private static extern int GetPrivateProfileString(string section,
    string key,
    string def,
    StringBuilder retVal,
    int size,
    string filePath);

    public string ReadAppPath()
    {
        string appPath = Path.GetDirectoryName(Application.ExecutablePath);

        return appPath + "\\Setting.ini";
    }

    public INIFileOperation()
    {
        this.filePath = ReadAppPath();
    }

    public void Write(string section, string key, string value)
    {
        WritePrivateProfileString(section, key, value.ToUpper(), this.filePath);
    }
    public string Read(string section, string key)
    {
        StringBuilder SB = new StringBuilder(255);
        int i = GetPrivateProfileString(section, key, "", SB, 255, this.filePath);
        return SB.ToString();
    }
    public string FilePath
    {
        get { return this.filePath; }
        set { this.filePath = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T15:42:17.400

这不是方法，但这是 c# 允许定义类属性的方式。

**MSDN** *属性是一个成员，它提供了一种灵活的机制来读取、写入或计算私有字段的值。属性可以像公共数据成员一样使用，但它们实际上是称为访问器的特殊方法。这使得数据可以轻松访问，并且仍然有助于提高方法的安全性和灵活性。*

*   属性使类能够公开获取和设置值的公共方式，同时隐藏实现或验证代码。
*   get 属性访问器用于返回属性值，而 set 访问器用于分配新值。这些访问器可以具有不同的访问级别。
*   value 关键字用于定义由 set 访问器分配的值。
*   未实现 set 访问器的属性是只读的。
*   对于不需要自定义访问器代码的简单属性，请考虑使用自动实现属性的选项

    ```
    public string FilePath
    {
         get 
         { 
             return this.filePath; 
         }
         set 
         { 
             this.filePath = value; 
         }
    } 
    ```

*[你可以在这里](http://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx)或[这里](http://msdn.microsoft.com/en-us/library/aa288470%28v=vs.71%29.aspx)阅读更多*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:46:02.223

FilePath 是一个公共字符串变量，属于它所在的类。get 和 set 定义了在访问变量时获取和设置变量的方式。

[http://www.csharp-station.com/Tutorial/CSharp/lesson10](http://www.csharp-station.com/Tutorial/CSharp/lesson10)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:45:05.903

您可以查看

```
public string FilePath
        {
            get { return this.filePath; }
            set { this.filePath = value; }
        } 
```

作为一种写作

```
public string GetFilePath() { return this.filePath; }
public string SetFilePath(string value_) { this.filePath = value_; } 
```

但它为您提供了所谓的`property`FilePath，可用作`obj.FilePath="abc"`或`string abc = obj.FilePath`.

# firebase - Firebase - 什么是 API 密钥

> ID：13863297
> 
> 赞同：40
> 
> 时间：2012-12-13T15:40:53.190
> 
> 标签：firebase, api-key

在 Firebase 中，当我们注册时，它会为我们提供每个 firebase Url 的 API 密钥。但是它在消费应用程序中的什么地方使用呢？fireBase API 不提供任何方法来提供 API 密钥。

**安全性**：是什么阻止任何人继续将任何对象写入给定的 firebase Url？授权如何管理？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-06-23T14:57:34.923

[您可以在https://console.developers.google.com/apis/credentials?project=[YOUR-PROJECT]](https://console.developers.google.com/apis/credentials?project=[YOUR-PROJECT])生成您的 api 密钥

将 [YOUR-PROJECT] 替换为您的项目 ID。

[在https://support.google.com/cloud/answer/6158862](https://support.google.com/cloud/answer/6158862)找到更多信息

问候。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-22T21:30:27.490

*更新了指向新 Firebase 网站的链接*

您的问题非常及时，因为 Firebase 几天前刚刚宣布了其完整的安全套件。

这里有一个很好的介绍性截屏视频和文档：[https ://firebase.google.com/docs/database/security/](https://firebase.google.com/docs/database/security/)

“API 密钥”是 Firebase Secret 的旧名称。这用于生成身份验证令牌以向 Firebase 证明用户是谁。您可以在此处查看有关身份验证的文档： [https ://firebase.google.com/docs/auth/](https://firebase.google.com/docs/auth/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-15T07:02:17.307

按着这些次序：

1.  登录[Firebase 控制台](https://console.firebase.google.com/)
2.  选择您的项目
3.  在左上角，您会找到设置图标，单击**项目设置**

[![设置](../Images/f70578924e64ecb4f0d468e73c4817e7.png)](https://i.stack.imgur.com/5TeWb.png)

4.  对于**Web API 密钥**，您可以在常规选项卡中找到 [![网络 API 密钥](../Images/092a3da55f9bff913c66b337300c91a8.png)](https://i.stack.imgur.com/4Vjuk.png)

5.  对于**Server Key**，您可以在 Cloud Messaging 选项卡下找到 [![服务器密钥](../Images/f515ad88be7086448ad99cc6c1ab9fe8.png)](https://i.stack.imgur.com/Ee67i.png)

# java - Checkstyle，匿名内部类后缺少空格

> ID：13863301
> 
> 赞同：3
> 
> 时间：2012-12-13T15:41:02.240
> 
> 标签：java, whitespace, checkstyle, curly-braces

给定以下代码片段：

```
public void doSomething() {
    new Executor() {
        @Override
        public void doStuff() {
            // ...
        }
    }.execute();
} 
```

...Checkstyle 抱怨匿名内部类的右大括号后没有空格。

请注意，以下代码段不会触发警告：

```
public void doSomething() {
    Executor exec = new Executor() {
        @Override
        public void doStuff() {
            // ...
        }
    };
    exec.execute()
} 
```

我尝试如下配置检查器，但无济于事：

```
<module name="WhitespaceAround">
    <property name="allowEmptyConstructors" value="true"/>
</module> 
```

如何配置 Checkstyle 以便它忽略第一个片段中的情况？

# forms - ZF2 布局表单集输入过滤器和验证

> ID：13863305
> 
> 赞同：0
> 
> 时间：2012-12-13T15:41:11.083
> 
> 标签：forms, layout, get, zend-framework2

对于 Zend Framework 2 中的应用程序，我在 layout.phtml 中创建了一个“搜索表单”。我在我的应用程序模块中通过将搜索表单添加为变量来完成此操作。

（表单位置Application/src/Application/Form/SearchForm.php）

应用程序/模块.php：

```
public function setFormToView($e)
    {
        $searchForm = new SearchForm();
        $viewModel = $e->getViewModel();
        $viewModel->setVariables(array(
            'searchForm' => $searchForm,
        ));
   } 
```

表单指向另一个模块中的操作，在这里我想处理如何处理传入的查询。

MyModule/src/MyModule/Controller/MyModuleController.php

```
public function dataAction()
    {
        $form   = new SearchForm();
        $form->get('submit')->setValue('Add');

        $website = $this->params()->fromQuery('search');

        return array('searchForm', $form);
    } 
```

获取查询“搜索”没问题，效果很好。不，我想使用我在“Application/src/Application/Model/Search.php”下创建的 inputFilter。

我尝试将其添加到我的“dataAction()”中但没有结果，但我什至无法更改提交值，就像我在上面的示例中尝试的那样。

在这种情况下如何以正确的方式设置它？否则，在 layout.phtml 中处理搜索表单的正确情况是什么。

在此先感谢，尼克

# java - 如何在 Java 中为 ServerSocketChannelImpl 重建 JDK JNI C 代码？

> ID：13863306
> 
> 赞同：2
> 
> 时间：2012-12-13T15:41:15.717
> 
> 标签：java, c, java-native-interface, real-time, nio

我下载了 JDK 源代码，并尝试在`ServerSocketChannelImpl`. [ServerSocketChannelImpl.java](http://hg.openjdk.java.net/jdk6/jdk6/jdk/raw-file/ffa98eed5766/src/share/classes/sun/nio/ch/ServerSocketChannelImpl.java)对该方法使用本机代码`accept0`。此方法的本机代码位于[ServerSocketChannelImpl.c](http://svn.netlabs.org/repos/java/trunk/openjdk/jdk/src/solaris/native/sun/nio/ch/ServerSocketChannelImpl.c)中。我需要在那里做一个小改动并重建`.so`库，以便我可以将它与我的 JVM 一起使用。

当我构建自己的通用 JNI 库时，我使用`gcc`如下命令行：

```
gcc -I/usr/lib/jvm/java-6-oracle/include/ -I/usr/lib/jvm/java-6-oracle/include/linux/ -fPIC -o libHello.so -shared org_tsutils_Hello.c 
```

但是对于 JVM C 源代码，我不确定如何进行。有人有想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-13T20:58:48.040

如果您正在实现本机方法，您应该在您的代码上运行 javah，它将生成 h 文件，这些文件将填充您现在拥有的 c++ 代码，您将包含头文件的编译产品添加到您的类路径中。

# shell - 如何在文本文件 shell 脚本中查找最大和最小数字

> ID：13863307
> 
> 赞同：2
> 
> 时间：2012-12-13T15:41:15.670
> 
> 标签：shell

我有以下文件：

T$57 abc 字符串 (50.00,110.00) T$97 xyz 字符串 (30.00,-1100.00)

我需要将 (50.00,110.00) , (30.00,-1100.00) 放入新文件中，最后保存变量中 x 坐标的最大数和 y 坐标的最小数。在另一个变量中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:03:44.833

`awk`如下图所示使用。坐标被保存到另一个名为的文件`file2`中，包含 max 和 min 的变量分别是`maxX`和`minY`。

```
$ cat file
T$57  abc string  (50.00,110.00)
T$97  xyz string  (30.00,-1100.00)

$ read maxX minY < <(awk -F"[ (,)]+" 'NR==1 { maxX=$4;minY=$5 } {if($4>maxX){maxX=$4} if($5<miny){miny=$5}print "("$4","$5")" > "file2"}END{print maxX" "miny}' file)

$ echo $maxX
50.00

$ echo $minY
-1100.00

$ cat file2
(50.00,110.00)
(30.00,-1100.00) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:28:49.957

这是一个小shell脚本：

```
#!/bin/bash

maxx=0
miny=0
#For everithing between brackets in you file do
for i in `grep -oE '\(([^\(\)]*)\)' file` ; do

 echo $i >> newFile

 #Getting the differnts values
 j=`echo $i | tr -d '[\(][\)]'`
 x=`echo $j | cut -d, -f1`
 y=`echo $j | cut -d, -f2`

 #Putting the max in maxx
 if [ $maxx \< $x ] ; then
  maxx=$x
 fi

 #Putting the min in miny
 if [ $miny \> $y ] ; then
  miny=$y
 fi

done

echo $maxx
echo $miny 
```

# android - LogCat 发疯了（Eclipse）

> ID：13863308
> 
> 赞同：0
> 
> 时间：2012-12-13T15:41:18.077
> 
> 标签：android, eclipse, logcat

当我将任何 android 设备插入计算机时，我注意到一个奇怪的行为。一旦我插入它，它就会开始在 Eclipse 中的 LogCat 中显示一些消息。我的 HTC 和华硕平板电脑也是如此。

这种情况以前从未发生过，我不记得昨天开发我的应用程序时做过任何不寻常的事情。

Any1 知道如何阻止这种情况？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:42:46.243

您可以向 logcat 添加过滤器，以便仅显示相关信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:44:13.080

这无法停止，因为 eclipse 中的 log cat 将检索正在执行某种记录的任何内容，无论它是应用程序还是 android 本身。

您可以过滤它，我认为在日志猫窗口的顶部有一个文本字段，仅显示包含特定字符串的日志消息，如果我没记错的话，右侧还有按钮仅显示错误消息或警告或两者等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:51:25.777

根据我的经验，一旦您插入设备，logcat 就会开始显示消息是完全正常的。至少这意味着它正在工作！;)

但是，一旦您开始构建和运行您的应用程序并发现错误，您的应用程序的特定过滤器将开始显示，它只会显示与您的应用程序相关的日志。

它默认设置为在显示错误后切换到您的应用程序，但您可以通过转到 Preferences > Android > LogCat 并将“Show logcat view...”从“Error”更改为“Verbose”或其他任何工作来更改该默认设置。这样，它将切换到更快地显示您的应用程序的日志。除此之外，您还可以做更多特定的过滤器。

希望对你有帮助XD

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-04T04:32:34.570

我的 Nexus 5 也有同样的问题。Eclipse 无法识别该设备，所以我稍微弄乱了设备窗口，然后日志猫开始发疯。

几次重启后，我在手机的开发者设置中取消勾选USB调试选项并重新勾选。

问题解决了。

我认为执行此操作时设备窗口中的某些内容发生了变化，但我不确定。

# javascript - 处理表单提交中的网络错误

> ID：13863315
> 
> 赞同：1
> 
> 时间：2012-12-13T15:41:40.500
> 
> 标签：javascript, html

如何优雅地处理 HTML 表单提交期间发生的网络错误？我不希望浏览器以任何方式缓存表单或数据，但如果在提交表单时出现网络错误（例如路由器崩溃），我不希望用户丢失他们的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:48:14.640

如果您可以将表单提交转换为 AJAX，则可以处理错误并更新用户，而不会丢失表单数据。如果没有，您可以在提交表单之前提出 AJAX 头请求。可能有一个小窗口，路由器可能会在您的 AJAX 请求和表单提交之间崩溃。

# visual-studio-2010 - 为什么 Visual Studio 2010 不能在本地机器上部署和启动 IIS express？

> ID：13863317
> 
> 赞同：1
> 
> 时间：2012-12-13T15:41:52.960
> 
> 标签：visual-studio-2010, ssl, .net-4.0, https, iis-express

我们的 ASP.NET C# web 应用程序用于以下环境

*   .NET 框架 4

*   银光4

*   IIS 7

*   视窗 2008

*   视觉工作室 2010

.NET IDE

*   C＃

*   HTTPS ( SSL )

为了使开发与我们的生产环境和质量保证环境保持紧密一致。

我在本地开发桌面上安装了 IIS express。

Scott Hanselman 记录了一个很好的分步指南，说明我们应该如何在我的本地开发桌面上为 IIS express 设置一个假的无签名证书，以便开发人员可以在 HTTPS ( SSL ) 开发环境中部署开发代码。

[http://www.hanselman.com/blog/WorkingWithSSLAtDevelopmentTimeIsEasierWithIISExpress.aspx](http://www.hanselman.com/blog/WorkingWithSSLAtDevelopmentTimeIsEasierWithIISExpress.aspx)

我在本地开发桌面上为 IIS express 创建了一个假的未签名证书，以便我可以在 HTTPS ( SSL ) 开发环境中部署开发代码。

我尝试通过在“属性”选项卡页面中选择“使用本地 IIS Web 服务器”单选按钮来配置 Visual Studio 2010。我指定了“https://localhost/”的项目 url（注意：我在上面提到的项目 url 中使用了 httpS，就像在 SSL 中一样）

我点击了“创建虚拟目录”。

我导航到 C:\Users{YOU}\Documents\IISExpress\config\applicationhost.config 文件。

我在管理员模式记事本中打开了 C:\Users{YOU}\Documents\IISExpress\config\applicationhost.config，但它没有显示我的网站的任何条目。

我在 applicationhost.config 文件中手动输入了站点配置：

```
<site name="PivotServer(12)" id="14">
    <application path="/" applicationPool="Clr4IntegratedAppPool">
        <virtualDirectory path="/" physicalPath="C:\Program Files\IIS Express\WebSite1\Pivot_JIT_Sample2\PivotJitServer\PivotServer" />
        </application>
            <bindings>
                <binding protocol="http" bindingInformation="*:45621:localhost" />
                <binding protocol="https" bindingInformation="*:443:localhost" />
            </bindings>
        </site>

I need to figure out a way to debug using IIS express working in combination with  Visual Studio 2010. 
```

我尝试通过按“F5”从 Visual Studio 2010 运行该应用程序，但我得到一个弹出窗口错误框，其中指出：

“无法直接启动输出类型为类库的项目。为了调试此项目，请在此解决方案中添加一个引用库项目的可执行项目。将可执行项目设置为启动项目。”

有人可以提出建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T04:20:28.337

正如[其他 SO post](https://stackoverflow.com/questions/11152272/a-project-with-an-output-type-of-class-library-cannot-be-started-directly)中所述，您需要确保已正确设置 Startup 项目。

然后，当您启动项目时，请确保显示正确的端口，如：`https://localhost:443/`.

# c# - 如何在计算器中覆盖？

> ID：13863318
> 
> 赞同：0
> 
> 时间：2012-12-13T15:41:57.403
> 
> 标签：c#, calculator

这是我用 SharpDevelop 编写的计算器代码。我需要知道如何覆盖一个数字。

在我的代码中，当我给第一个号码发短信并且按下添加按钮后，文本框被清除。

```
public partial class MainForm : Form
{
  public MainForm()
  {
    InitializeComponent();
  }

  double total1 = 0;
  double total2 = 0;

  void BtnOneClick(Object sender, EventArgs e)
  {
    txtDisplay.Text = txtDisplay.Text + btnOne.Text;
  }

  void BtnTwoClick(object sender, EventArgs e)
  {
    txtDisplay.Text = txtDisplay.Text + btnTwo.Text;
  }

  ...

  void BtnZeroClick(object sender, EventArgs e)
  {
    txtDisplay.Text = txtDisplay.Text + btnZero.Text;           
  }

  void BtnClearClick(object sender, EventArgs e)
  {
    txtDisplay.Clear();
  }

  void BtnPlusClick(object sender, EventArgs e)
  {
    total1 += double.Parse(txtDisplay.Text);
    txtDisplay.Clear();

    plusButtonClicked = true;
    minusButtonClicked = false;
    multiplyButtonClicked = false;
    divideButtonClicked = false;
  }

  ...

  bool plusButtonClicked = false;
  bool minusButtonClicked = false;
  bool multiplyButtonClicked = false;
  bool divideButtonClicked = false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:46:00.227

我想你想要

```
void BtnPlusClick(object sender, EventArgs e)
{
total1 += double.Parse(txtDisplay.Text);
txtDisplay.Text = total1.toString(); 
```

**编辑：** `.Clear`将从文本框中删除文本..我认为如果您想要发生其他事情，那么您需要重新考虑您正在尝试做的事情

**Edit2**如果这不是你想要的我不知道是什么

```
 int total = 0;
    bool newNum = true;
    //1
    private void button1_Click(object sender, EventArgs e)
    {

        textBox1.Text = newNum ? "1" : textBox1.Text + "1";
        newNum = false;
    }
    //Add
    private void button2_Click(object sender, EventArgs e)
    {
        newNum = true;
        total += int.Parse(textBox1.Text);
        textBox1.Clear();
    }
    //Equals
    private void button3_Click(object sender, EventArgs e)
    {
        textBox1.Text = total.ToString();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:46:12.923

这是因为这一行：txtDisplay.Clear(); 在你的方法 BtnPlusClick();

如果您只想在开始提供下一个数字时清除它 - 只需检查您的布尔标志（plusButtonClicked 等） - 如果其中一个设置为 true - 然后制作 txtDisplay.Clear();

# solr - 将 Solr 与 Mediawiki 集成

> ID：13863329
> 
> 赞同：2
> 
> 时间：2012-12-13T15:42:20.740
> 
> 标签：solr, integration, mediawiki

我们正在我们的组织中运行一个媒体维基。与 Mediawiki 集成的标准搜索引擎只能提供平庸的搜索结果，我们正在努力改善这种情况。我想使用 solr，但目前我正在努力将 solr 搜索结果集成到 Mediawiki 中。是否有允许将 solr 搜索结果集成到 mediawiki 的标准工具或库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:08:33.063

可能不是真的，但你可以尝试从这个扩展中学习一两件事：

[http://www.mediawiki.org/wiki/Extension:SolrStore](http://www.mediawiki.org/wiki/Extension:SolrStore)

# javascript - 类的jQuery ajax回调成员？

> ID：13863333
> 
> 赞同：2
> 
> 时间：2012-12-13T15:42:40.900
> 
> 标签：javascript, jquery

> **可能重复：**
> [有没有办法让 JQuery ajax 成功函数访问它包含的对象？](https://stackoverflow.com/questions/5378622/is-there-a-way-for-a-jquery-ajax-success-function-to-access-the-object-its-cont)

我有一些这样的代码

```
myClass.prototype.doStuff = function(){

  $.ajax({
        type: 'POST',
        url: $('#form').attr('action'),
        data: $('#form').serialize(),
        success: this.callback
  });
};

myClass.prototype.callback = function(data){
   if(this.someFlag){
     //do some stuff  
   }

}; 
```

在这种情况下，我应该`this`是 myClass 的实例，但实际上并非如此。这是为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T15:44:38.917

[`context: this`](http://api.jquery.com/jQuery.ajax/)作为 ajax 选项传递。

> 该对象将成为所有与 Ajax 相关的回调的上下文。默认情况下，上下文是一个对象，表示调用中使用的 ajax 设置（`$.ajaxSettings`与传递给的设置合并`$.ajax`）。

```
$.ajax({
    type: 'POST',
    url: $('#form').attr('action'),
    data: $('#form').serialize(),
    context: this,
    success: this.callback
}); 
```

# scala - 如何在 Sorm 中为具有多个孩子的实体建模？

> ID：13863337
> 
> 赞同：3
> 
> 时间：2012-12-13T15:42:47.953
> 
> 标签：scala, sorm

我有一个`Workspace`和`Document`实体，认为工作区可以包含零个、一个或多个文档。我的第一个建模方法是：

```
case class Workspace(name: String, documents: Seq[Document]) 
```

但这不会很好地扩展，因为我的工作区可能包含*许多*文档。幸运的是，我的业务需求允许我分别处理工作区和文档（从某种意义上说，当我有一个工作区时，没有理由或不变量迫使我考虑其中包含的所有文档）。

**问题：**我想知道：我将如何在[Sorm](http://sorm-framework.org/Documentation.html#data_types)`Workspace`中建模，以便在两者之间建立链接，但不必加载工作区的所有文档？我想有一个[存储库](http://en.wikipedia.org/wiki/Domain-driven_design#Building_blocks_of_DDD)，它可以让我访问工作区的文档，并支持分页。）`Document`

```
case class Workspace(name: String)
case class Document(name: String, /* ... */)

trait WorkspaceRepository {
  def children(ws: Workspace, offset: Long, limit: Long)
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T16:31:35.380

十分简单！您将它们定义为不相关的：

```
case class Workspace ( name : String )
case class Document ( ... ) 
```

然后，您选择一种您希望它们链接的方式。我看到两个。

## 变体 #1

```
case class WorkspaceDocuments 
  ( workspace : Workspace, documents : Seq[Document] ) 
```

并像这样获取工作区的所有文档：

```
Db.query[WorkspaceDocuments]
  .whereEqual("workspace", theWorkspace)
  .fetchOne()
  .map(_.documents)
  .getOrElse(Seq()) 
```

`workspace`在这种情况下，在实例声明中将属性指定为唯一是有意义的：

```
... Instance (
  entities = Set() +
             Entity[WorkspaceDocuments]( unique = Set() + Seq("workspace") )
  ...
) 
```

## 变体 #2

```
case class WorkspaceToDocument
  ( workspace : Workspace, document : Document ) 
```

并像这样获取工作区的文档：

```
Db.query[WorkspaceToDocument]
  .whereEqual("workspace", theWorkspace)
  .whereEqual("document.name", "...") // ability to filter docs
  .fetch()
  .map(_.document) 
```

第一个变体不允许您在查询中过滤文档（至少在 SORM v0.3.* 中），但由于能够在工作区上设置唯一约束，它应该在基于工作区的查询上表现更好。第二个变体更灵活，允许您应用各种过滤器。

# android - Android - 使用 setFixedSize() 后获取触摸事件位置

> ID：13863343
> 
> 赞同：1
> 
> 时间：2012-12-13T15:43:02.337
> 
> 标签：android

我有一个 OpenGL 应用程序，它需要以设定的屏幕尺寸（在本例中为 800x480）运行。我使用命令：

```
 this.getHolder().setFixedSize(800, 480) 
```

在我的 GLSurfaceView 构造函数中执行此操作。这意味着在屏幕更大的设备上，我的应用程序仍然占据了整个屏幕。

我的结果是，在 onTouchEvent() 视图中，getX() 和 getY() 方法不再返回从 (0,0) 缩放到 (800,480) 的值。

我尝试将基于真实屏幕尺寸的比例因子应用于 getX() 值，但无法准确确定它应该是什么。

我将如何扩展 getX() 和 getY()？首先，我应该使用其他方法将屏幕缩放到我想要的分辨率吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T14:55:29.700

好的，我想我已经在这里回答了我自己的问题。经过更多调查，通过以下方式获取窗口大小：

```
Display display = ((WindowManager) context.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
int w = display.getWidth();
int h = display.getHeight(); 
```

并使用它来缩放 getX()、getY() 输出确实有效；我只需要忽略 display.getWidth() 返回的明显不正确的值。

# cordova - 使用 Phonegap 登录 Vtiger 客户门户

> ID：13863344
> 
> 赞同：0
> 
> 时间：2012-12-13T15:43:08.827
> 
> 标签：cordova, login, portal, vtiger

我最初是一名网络开发人员（和一个新的 vtiger 用户），正在开发一个具有多种功能的 phonegap 应用程序，例如客户可以通过客户门户登录，这样他们就可以访问他们的故障单。我的问题是我不知道如何在不使用 PHP 的情况下执行此操作，而且我不能使用 PHP，因为 Phonegap 不支持它。

我知道如何用这样的 phonegap 制作一个简单的登录[表单](http://www.raymondcamden.com/index.cfm/2011/11/10/Example-of-serverbased-login-with-PhoneGap)。但我不知道如何使用 vtiger 客户门户做类似的事情。

我的问题是：是否可以使用 phonegap 应用程序登录客户门户，以及如何登录？

提前致谢！

（PS。对不起我的英语不好。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:55:16.700

PhoneGap 应用程序可以向另一个 Web 应用程序提供登录功能，方法是调用向某个 URL 发出 HTTP 请求，以验证传递的用户凭据。主要区别在于，在 PhoneGap 中，此请求通常以 AJAX 样式完成，而不是像 Web 浏览器常见的全页提交。

在这两种情况下，目标都是与您的应用程序服务器建立会话，以便对应用程序服务器的后续请求可以确定谁在发出请求，以及该用户是否有权执行请求所要求的操作。

# lua - Lua 一次性结果

> ID：13863346
> 
> 赞同：2
> 
> 时间：2012-12-13T15:43:13.953
> 
> 标签：lua

我有一种情况，我对表执行一些操作，将它们称为 T 和 V。我已经正确设置了元表并且一切都按预期工作。问题是我通常不需要计算的结果。所以不要写

```
for i=1,5 do
    _=T+V
end 
```

有没有办法让

```
for i=1,5 do
    T+V
end 
```

?

我没有使用 Lua 命令行，所以我不能只写 =T+V。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-14T00:52:17.543

创建一个什么都不做的函数并将其传递给它：

```
function NOP() end

for i=1,5 do
    NOP(T+V)
end 
```

这还可以记录您的意图，而副作用就是您所追求的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:00:08.130

查看[扩展 BNF 中 Lua 的语法，](http://www.lua.org/manual/5.1/manual.html#8)我看不到没有等号或其他东西的构造表达式（exp）的方法。

只有 4 种情况可以使用表达式 (exp)：

*   分配一个值，例如`p = exp`

*   作为条件，例如`while exp then`

*   在函数调用中，即`f(exp)`

*   用于索引即`t[exp]`

# asp.net-mvc - 在 MVC 3 中使用自定义数据库进行用户登录/注册

> ID：13863348
> 
> 赞同：0
> 
> 时间：2012-12-13T15:43:14.270
> 
> 标签：asp.net-mvc, asp.net-mvc-3, authentication

好的，所以我有一个`MVC project`自动生成一个`AccountController AcountModel`和相关的视图。
我使用模型优先方法创建了一个包含 3 个表的数据库，并`controllers/views`为所有`CRUD`操作生成了所有数据。

该数据库包含一个用户表，其中包含一个`id`用户`email`和`password`。

如何将此用户表与自动生成`AccountController`的用户登录和注册一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:02:50.530

我将仅向您展示注册过程，参考您可以使用自定义数据库构建登录/注册的过程。

**模型：** 您将自定义模型添加到 中`AccountModels.cs`，因此它将具有以下详细信息：

```
 public class ChangePasswordModel
    {
        [Required]
        [DataType(DataType.Password)]
        [Display(Name = "Current password")]
        public string OldPassword { get; set; }

        [Required]
        [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
        [DataType(DataType.Password)]
        [Display(Name = "New password")]
        public string NewPassword { get; set; }

        [DataType(DataType.Password)]
        [Display(Name = "Confirm new password")]
        [System.Web.Mvc.Compare("NewPassword", ErrorMessage = "The new password and confirmation password do not match.")]
        public string ConfirmPassword { get; set; }
    }

    public class LogOnModel
    {

        [Required]
        [Display(Name = "User name")]
        public string UserName { get; set; }

        [Required]
        [DataType(DataType.Password)]
        [Display(Name = "Password")]
        public string Password { get; set; }

        [Display(Name = "Remember me?")]
        public bool RememberMe { get; set; }
    }

    public class RegisterModel
    {
        [Required]
        [Display(Name = "User name")]
        public string UserName { get; set; }

        [Required]
        [DataType(DataType.EmailAddress)]
        [Display(Name = "Email address")]
        public string Email { get; set; }

        [Required]
        [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
        [DataType(DataType.Password)]
        [Display(Name = "Password")]
        public string Password { get; set; }

        [DataType(DataType.Password)]
        [Display(Name = "Confirm password")]
        [System.Web.Mvc.Compare("Password", ErrorMessage = "The password and confirmation password do not match.")]
        public string ConfirmPassword { get; set; }
    }

    public class userDetailModel
    {
        [Key]
        public Guid UserId { get; set; }
        public string UserName { get; set; }
        public string Password { get; set; }
        public string Email { get; set; }
        public string city { get; set; }
        public string ConfirmPassword { get; set; }
        public string comapny { get; set; }
        public int zip { get; set; }
    } 
```

**上下文：** 您将向`Models`以下内容添加自定义上下文：

```
public class userDetailsDBContext: DbContext
    {
        public DbSet<userDetailModel> details { get; set; }

    } 
```

**控制器：** 现在我们将修改我们`AccountController`的注册如下：

```
public class AccountController : Controller
    {
        private userDetailsDBContext db = new userDetailsDBContext();
        // POST: /Account/Register

        [HttpPost]
        public ActionResult Register(userDetailModel model)
        {
            if (ModelState.IsValid)
            {
                // Attempt to register the user
                MembershipCreateStatus createStatus;
                Membership.CreateUser(model.UserName, model.Password, model.Email, null, null, true, null, out createStatus);

                if (createStatus == MembershipCreateStatus.Success)
                {
                    FormsAuthentication.SetAuthCookie(model.UserName, false /* createPersistentCookie */);
                    var newuser = Membership.GetUser(model.UserName);
                    model.UserId =(Guid)newuser.ProviderUserKey;
                    db.details.Add(model);
                    db.SaveChanges();
                    return RedirectToAction("Index", "Home");
                }
                else
                {
                    ModelState.AddModelError("", ErrorCodeToString(createStatus));
                }
            }

            // If we got this far, something failed, redisplay form
            return View(model);

        } 
} 
```

**编辑 web.config：** 最后，您必须将新上下文添加到连接字符串，如下所示：

```
<connectionStrings>
    <add name="DefaultConnection" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-MembershipSample-20121105163515;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-MembershipSample-20121105163515.mdf" />
    <add name="userDetailsDBContext" providerName="System.Data.SqlClient" connectionString="Data Source=(LocalDb)\v11.0;Initial Catalog=aspnet-MembershipSample-20121105163515;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnet-MembershipSample-20121105163515.mdf" />
  </connectionStrings> 
```

您可以将数据库名称更改为您想要的任何名称，并将其放置为您的方便，但将路径正确放置在此处。

希望你现在有这个想法...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:05:19.187

我认为您需要创建自定义会员提供程序。[这篇](http://www.codeproject.com/Articles/165159/Custom-Membership-Providers)代码项目文章将为您提供一个起点。

# html - 在鼠标悬停时为表格条目显示替代文本

> ID：13863358
> 
> 赞同：39
> 
> 时间：2012-12-13T15:43:54.270
> 
> 标签：html

我有一张表，其中一列显示员工的员工 ID。当鼠标移到上面时，我需要在那里显示名称。任何人都可以帮我吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-12-13T15:45:24.253

`alt`是一个属性，不是标签，它不是鼠标悬停，它在图像未加载时显示，尝试`title`使用

所以试试这个

```
<table>
  <tr>
    <td title="Employee Name">1</td>
    <td title="Another Employee Name">2</td>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-17T12:45:52.407

用于`title`这个问题。这是比较容易的解决方案

```
<table>
    <tr>
        <td title="Employee Name."> Employee ID</td>
    </tr>
</table> 
```

# c# - 如何使用 C# 模拟功能键组合？

> ID：13863370
> 
> 赞同：4
> 
> 时间：2012-12-13T15:44:22.897
> 
> 标签：c#, function, keypress

我希望有人可以帮助我在 C# 中模拟功能键组合，在本例中为`FN`+ `F4`。

这就是我想要做的... 我有一个较旧的触摸屏上网本，我最近安装了 Windows 8。它有一个旋转屏幕，因此您可以将其折叠起来并像平板电脑一样使用它。Windows 8 在它上面运行得非常好。我遇到了一些小问题，其中大部分我都能解决，但仍有一个问题存在。

上网本第一次开机或从睡眠中唤醒时，屏幕亮度为 30%，Windows 认为这是最大设置，因此通过正常方法提高屏幕亮度不起作用。在我的上网本上，按`FN`+`F4`将屏幕恢复为全亮度。不过，这是一个小麻烦，因为我必须来回旋转屏幕以使用物理键盘来固定亮度，而我只想将其留在平板电脑位置并最大限度地减少磨损。

我想做的是编写一个在启动时运行的小应用程序，并模拟功能键组合，从而自动恢复亮度。任何建议将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:03:39.283

`Fn`密钥不是从键盘发送到计算机的密钥。它实际上是用来改变键盘上按键的含义（这样键盘在按住按键时会发送不同的扫描码`Fn`）。

您应该能够轻松编写一个简单的 Windows 窗体程序，该程序可以监听按键并显示收到的内容。报名参加`KeyDown`活动。您的处理程序接收的[KeyEventArgs](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.aspx)具有各种属性，您可以检查这些属性以查看正在接收的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:59:19.030

该`FN`键不是像其他修饰符（`shift`, `alt`, `ctrl`）那样的真正的键盘键，也不是像`F1`-那样的功能键`F12`。该`FN`键是仅硬件键，它只是告诉硬件在按下键时发送不同的击键`FN`。

因此，您将不得不手动调整亮度，如评论中所述的“我的”或通过其他一些机制。

参考[链接。](https://stackoverflow.com/questions/10052194/registerhotkey-fn-modifier)

# arrays - 通过删除最小数量的元素，将给定的整数数组转换为已排序的数组

> ID：13863373
> 
> 赞同：4
> 
> 时间：2012-12-13T15:44:35.293
> 
> 标签：arrays, algorithm, sorting

我正在解决以下问题：

我必须通过删除最小数量的元素将给定的整数数组转换为排序数组。

例如：[3,5,2,10,11] 将通过删除 '2' 进行排序：[3,5,10,11]。或 [3,6,2,4,5,7,7] 将通过删除 '3','6' 进行排序： [2,4,5,7,7] 或通过删除 '6','2' : [3,4,5,7,7] （两种方式我都删除了 2 个元素，这就是为什么它们都是正确的）。

我的想法是为每个元素保留一个计数器，看看它与其他元素有多少冲突。我所说的冲突是什么意思：在第一个示例中，数字“3”和“5”各有 1 个冲突（数字“2”），数字“2”有 2 个冲突（数字“3”和“5”） . 因此，在计算冲突数组之后，我从原始数组中删除具有最大冲突数的元素，并对剩余的数组重复，直到所有元素都有 0 个冲突。

虽然这不是一种有效的方法（在某些情况下，我认为它也可能会产生错误的结果），所以我想知道是否有人能想到更好的解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T17:14:45.123

我相信这只是**[最长递增子序列问题](http://en.wikipedia.org/wiki/Longest_increasing_subsequence)的巧妙伪装。**如果您删除最小数量的元素以获得排序序列，则剩下的是原始数组的最长递增子序列。因此，您可以执行以下操作：

1.  找到最长的递增子序列（为此存在 O(n log n) 算法），然后
2.  删除不在该子序列中的所有内容。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:44:38.390

您可以基于数组中的元素构建 DAG：

*   每个元素 a[n] 是一个顶点。
*   对于任何一对元素 (m,n)，其中 (m < n) 和 (a[m] <= a[n]) 添加有向边。

    优化：您可以为已排序的子数组构建简单的链。例如，如果 a[m]<=a[m+1)<=a[m+2]<=a[m+3]>a[m+4]，则可以跳过添加边 (m,m +2) 和 (m,m+3) 用于顶点 m。

现在的目标是找到图中的[最长路径，该路径](http://en.wikipedia.org/wiki/Longest_path_problem)对于有向无环图具有线性时间解。

上述 Wikipedia 页面和[此处](http://moodle.bracu.ac.bd/pluginfile.php/4784/mod_resource/content/1/longest-path-in-dag.pdf)描述了一种算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T17:09:54.223

我会用递归编程来做到这一点。这是我的伪代码：

```
/**
 *  sortedArray : an array already sorted.
 *  leftToSort : an unsorted array that need to be sorted/merged with sortedArray.
 *  first call to this function must be sortArrayByRemoval([], arrayToSort);
**/
public Integer[] sortArrayByRemoval(Integer[] sortedArray, Integer[] leftToSort){
    if(leftToSort.size==0){ 
        return sortedArray; //end of recursion
    }
    Integer candidate = leftToSort[0]; 
    if(candidate>=sortedArray[last]){ //append candidate to the sorted array
        return sortArrayByRemoval(sortedArray.append(candidate) , leftToSort.removeFirst());
    }else{
        //either we skip it
        Integer[] result1 = sortArrayByRemoval(sortedArray,leftToSort.removeFirst());
        //either we do back tracking
        Integer[] result2 = sortArrayByRemoval(sortedArray.removeLast(),leftToSort);
        //and finally we return the best choice (i.e. the longest array)
        return biggestArray(result1, result2);
    }
} 
```

也许不是最有效的，但我认为它给了你正确的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T17:17:47.060

如果您不坚持从原始数组中逐字删除内容的想法，那么您想要的是原始数字序列的最长递增子序列。这是一个众所周知的经典问题，您可以在文献或教科书中找到许多示例。

（如果你一直在删除，那么……找到 LCS 并删除所有不在 LCS 中的内容。）

# python - 为什么 Python 函数返回 NoneType？

> ID：13863379
> 
> 赞同：0
> 
> 时间：2012-12-13T15:44:47.480
> 
> 标签：python, nonetype

我在 python 中编写了两个递归函数。

第一个接受参数，修改它们，然后返回一个值。

```
def Similarity(string, sstring1, index):
    if condition1:
        return index
    if condition2:
        #do something
    Similarity(string, string1, index) 
```

第二个接受参数并对全局变量执行操作。

```
def getData(i, value):
    global dataList
    if condition:
        return list(suffixList)
    #do something
    getData(i, value) 
```

这些函数完美地工作并执行我需要的精确计算，但总是返回一个 NoneType。

我一直无法弄清楚为什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-13T15:46:14.390

你没有返回*任何东西*。*始终*使用`return`语句从函数返回值。Python 不*使用*函数中的最后一条语句作为返回值。

```
def getData(i, value):
    global dataList
    if condition:
        return list(suffixList)
    #do something
    return getData(i, value) 
```

一个没有显式退出的函数`return`，而是返回`None`。

# mapreduce - 将 MapReduce 输出数据加载到 HBase

> ID：13863382
> 
> 赞同：1
> 
> 时间：2012-12-13T15:45:11.740
> 
> 标签：mapreduce, hbase, guava, classnotfoundexception, bulk-load

最近几天我一直在试验 Hadoop。我在 Ubuntu 12.10 上以伪分布式模式运行 Hadoop，并成功执行了一些标准 MapReduce 作业。

接下来我想开始试验 HBase。我已经安装了 HBase，在 shell 中玩了一下。一切都很好，所以我想通过一个简单的 Java 程序来试验 HBase。我想导入以前的 MapReduce 作业之一的输出并将其加载到 HBase 表中。我写了一个映射器，它应该生成`HFileOutputFormat`应该很容易读入 HBase 表的文件。

现在，每当我运行程序（使用：hadoop jar [compiled jar]）时，我都会得到一个`ClassNotFoundException`. 该程序似乎无法解决`com.google.commons.primitives.Long`。当然，我认为这只是缺少一个依赖项，但 JAR（Google 的 Guava）就在那里。

我尝试了很多不同的方法，但似乎找不到解决方案。

我附上了发生的异常和最重要的类。如果有人可以帮助我或给我一些关于在哪里看的建议，我将不胜感激。

亲切的问候，彼得扬

**错误**

```
12/12/13 09:02:54 WARN snappy.LoadSnappy: Snappy native library not loaded
12/12/13 09:03:00 INFO mapred.JobClient: Running job: job_201212130304_0020
12/12/13 09:03:01 INFO mapred.JobClient:  map 0% reduce 0%
12/12/13 09:04:07 INFO mapred.JobClient:  map 100% reduce 0%
12/12/13 09:04:51 INFO mapred.JobClient: Task Id : attempt_201212130304_0020_r_000000_0,Status : FAILED
Error: java.lang.ClassNotFoundException: com.google.common.primitives.Longs
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at org.apache.hadoop.hbase.KeyValue$KVComparator.compare(KeyValue.java:1554)
    at org.apache.hadoop.hbase.KeyValue$KVComparator.compare(KeyValue.java:1536)
    at java.util.TreeMap.compare(TreeMap.java:1188)
    at java.util.TreeMap.put(TreeMap.java:531)
    at java.util.TreeSet.add(TreeSet.java:255)
    at org.apache.hadoop.hbase.mapreduce.PutSortReducer.reduce(PutSortReducer.java:63)
    at org.apache.hadoop.hbase.mapreduce.PutSortReducer.reduce(PutSortReducer.java:40)
    at org.apache.hadoop.mapreduce.Reducer.run(Reducer.java:176)
    at org.apache.hadoop.mapred.ReduceTask.runNewReducer(ReduceTask.java:650)
    at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:418)
    at org.apache.hadoop.mapred.Child$4.run(Child.java:255)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:415)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1136)
    at org.apache.hadoop.mapred.Child.main(Child.java:249) 
```

**JAVA**
**映射器：**

```
public class TestHBaseMapper extends Mapper<LongWritable, Text, ImmutableBytesWritable, Put> {

@Override
public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
    //Tab delimiter \t, white space delimiter: \\s+
    String[] s = value.toString().split("\t"); 
    Put put = new Put(s[0].getBytes());
    put.add("amount".getBytes(), "value".getBytes(), value.getBytes());      
    context.write(new ImmutableBytesWritable(Bytes.toBytes(s[0])), put);
} 
```

**工作：**

```
public class TestHBaseRun extends Configured implements Tool {

@Override
public int run(String[] args) throws Exception {
    try {
        Configuration configuration = getConf();

        Job hbasejob = new Job(configuration);
        hbasejob.setJobName("TestHBaseJob");
        hbasejob.setJarByClass(TestHBaseRun.class);

        //Specifies the InputFormat and the path.
        hbasejob.setInputFormatClass(TextInputFormat.class);
        TextInputFormat.setInputPaths(hbasejob, new Path("/hadoopdir/user/data/output/test/"));

        //Set Mapper, MapperOutputKey and MapperOutputValue classes.
        hbasejob.setMapperClass(TestHBaseMapper.class);
        hbasejob.setMapOutputKeyClass(ImmutableBytesWritable.class);
        hbasejob.setMapOutputValueClass(Put.class);

        //Specifies the OutputFormat and the path. If The path exists it's reinitialized.
        //In this case HFiles, that can be imported into HBase, are produced.
        hbasejob.setOutputFormatClass(HFileOutputFormat.class);
        FileSystem fs = FileSystem.get(configuration);
        Path outputpath = new Path("/hadoopdir/user/data/hbase/table/");
        fs.delete(outputpath, true);
        HFileOutputFormat.setOutputPath(hbasejob, outputpath);

        //Check if table exists in HBase and creates it if necessary.
        HBaseUtil util = new HBaseUtil(configuration);
        if (!util.exists("test")) {
            util.createTable("test", new String[]{"amount"});
        }

        //Reads the existing (or thus newly created) table.
        Configuration hbaseconfiguration = HBaseConfiguration.create(configuration);
        HTable table = new HTable(hbaseconfiguration, "test");

        //Write HFiles to disk. Autoconfigures partitioner and reducer.
        HFileOutputFormat.configureIncrementalLoad(hbasejob, table);

        boolean success = hbasejob.waitForCompletion(true);

        //Load generated files into table.
        LoadIncrementalHFiles loader;
        loader = new LoadIncrementalHFiles(hbaseconfiguration);
        loader.doBulkLoad(outputpath, table);

        return success ? 0 : 1;
    } catch (Exception ex) {
        System.out.println("Error: " + ex.getMessage());
    }
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:40:19.833

*ClassNotFoundException*，表示找不到所需的包含 com.google.common.primitives.Longs 的 .jar。

有几种方法可以解决这个问题：

*   If you're just playing with Hadoop, the simplest way to solve this issue is to copy the required .jar into */usr/share/hadoop/lib*.
*   Add the path to the required .jar to `HADOOP_CLASSPATH`. To do so open */etc/hbase/hbase-env.sh* and add:

    export HADOOP_CLASSPATH="<jar_files>:$HADOOP_CLASSPATH"

*   Create a folder */lib* in your root project folder. Copy your .jar into that folder. Create a package (.jar) for your project. The result will be a fat jar contained all the jars included in */lib*.

# php - 这段代码有什么错误？..它总是在其他地方

> ID：13863386
> 
> 赞同：1
> 
> 时间：2012-12-13T15:45:26.450
> 
> 标签：php, mysql, database, session, login-script

为什么这段代码不起作用？

它总是进入 else 并设置 $_SESSION['wronglogin']=1; 它是一个登录脚本，它接受电子邮件 ID 和密码的输入，然后检查是否存在任何此类内容，那么它应该启动 $_SESSION['loggedin']，否则启动 $_SESSION['wronglogin']。我已经尝试了很多，但我就是不明白

```
$_SESSION['login-id']=$loginid;
$_SESSION['loginpassword']=$loginpassword;

$loginid = stripslashes($loginid);
$loginpassword = stripslashes($loginpassword);
$loginid = mysql_real_escape_string($loginid);
$loginpassword = mysql_real_escape_string($loginpassword);

$con = mysql_connect("localhost", "moodabsz_naman", "database") or die(mysql_error());
mysql_select_db("moodabsz_database",$con) or die(mysql_error());

$sql="SELECT * 
FROM  user 
WHERE  `email_id` =  '$loginid'
AND  `password` =  '$loginpassword'";
$result=mysql_query($sql);

$count=mysql_num_rows($result);
if($count==1){
    $_SESSION['loggedin']=1;

    mysql_close($con);

    header('location: index.php');

}
else {

    $_SESSION['wronglogin']=1;
    echo "Wrong Username or Password";

    mysql_close($con);

    header('Location: index.php');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:14:35.707

上面的代码不起作用，因为缺少应该放在 PHP 代码第一行的[session_start()函数。](http://php.net/manual/en/function.session-start.php)

```
<?php
session_start();
/*

The rest of your code

*/
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:31:42.323

你能复制这个的输出吗？

```
<?php
$_SESSION['login-id']=$loginid;
$_SESSION['loginpassword']=$loginpassword;

$loginid = stripslashes($loginid);
$loginpassword = stripslashes($loginpassword);
$loginid = mysql_real_escape_string($loginid);
$loginpassword = mysql_real_escape_string($loginpassword);

$con = mysql_connect("localhost", "moodabsz_naman", "database") or die(mysql_error());
mysql_select_db("moodabsz_database",$con) or die(mysql_error());

$sql="SELECT * 
FROM  `user` 
WHERE  `email_id` =  '$loginid'
AND  `password` =  '$loginpassword'";

$result=mysql_query($sql) or die(mysql_error());

$count=mysql_num_rows($result);

echo 'Debug::Count-'.$count;

if($count==1){
    $_SESSION['loggedin']=1;

    mysql_close($con);

   // header('location: index.php');

}
else {

    $_SESSION['wronglogin']=1;
    echo "Wrong Username or Password";

    mysql_close($con);

    //header('Location: index.php');
} 
```

# google-analytics - 谷歌分析：站内链接与出站链接

> ID：13863391
> 
> 赞同：1
> 
> 时间：2012-12-13T15:45:48.433
> 
> 标签：google-analytics, hyperlink, redirect, outbound

首先，我想为这个蹩脚的问题道歉。我正在使用 Google Analytics 跟踪自定义事件，我想知道重定向到同一网站中的另一个页面是否应该像出站链接一样超时，或者没有延迟是可以的。

# sql - 有没有更快的方法来进行组 sql 查询？

> ID：13863392
> 
> 赞同：0
> 
> 时间：2012-12-13T15:45:49.040
> 
> 标签：sql, group-by

此查询从两个单独的表中提取。video_thumb_chosen 有一个拇指列，需要在哪里选择模式值。

```
$query = "SELECT DISTINCT videos.VIDEOID, 
                          videos.title,
                          (
                           select video_thumb_chosen.thumb
                           from video_thumb_chosen
                           where video_thumb_chosen.videoid = videos.VIDEOID 
                           group by video_thumb_chosen.thumb
                           order by count(video_thumb_chosen.thumb) desc limit 1 
                          ) as thumb, 
                          videos.rating, 
                          videos.runtime, 
                          videos.viewcount, 
                          videos.public, 
                          videos.time_added, 
                          videos.HD 
          FROM videos,video_thumb_chosen 
          WHERE videos.active='1' 
             && videos.tube=0  
             && videos.categories <> 7 
          ORDER BY videos.last_viewed desc limit $config[max_viewing_now]"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:49:54.697

删除子句中的交叉连接`from`将有助于：

```
FROM videos 
```

您没有在外部查询中使用 video_thumb_chosen，因此没有理由包含它。

可能还有其他优化。

鉴于您在 MySQL 中所做的事情，这可能会解决问题。这是查询：

```
SELECT videos.VIDEOID, videos.title,
      (select video_thumb_chosen.thumb
       from video_thumb_chosen
       where video_thumb_chosen.videoid = videos.VIDEOID
       group by video_thumb_chosen.thumb
       order by count(video_thumb_chosen.thumb) desc limit 1
      ) as thumb,
      videos.rating, videos.runtime, videos.viewcount, videos.public, videos.time_added, videos.HD
FROM videos
where  videos.active='1' && videos.tube=0  && videos.categories <> 7
ORDER BY videos.last_viewed
desc limit $config[max_viewing_now]"; 
```

# asp.net - 在 ASP/VB 中比较时间

> ID：13863393
> 
> 赞同：1
> 
> 时间：2012-12-13T15:45:50.987
> 
> 标签：asp.net, vb.net, time, compare

我有 2 列，一列用于开始时间，另一列用于结束时间。它们都是那种类型`nvarchar`，所以我可以比较它们。

我有一个文本框，它将接收用户的时间并自动回发以检查时间是否有效。

```
Dim compared_time_1 As DateTime
    Dim compared_time_2 As DateTime

    Dim select_time As SqlCommand
    select_time = New SqlCommand("select Start_Time , End_Time from Clinic_Schedule where Schedule_no = @sch_no", appt_DB_1)
    select_time.Parameters.AddWithValue("@sch_no", Sch_no)

    Dim time_rdr As SqlDataReader
    time_rdr = select_time.ExecuteReader()

    While time_rdr.Read
        compared_time_1 = DateTime.Parse(start_time_1)
        compared_time_2 = DateTime.Parse(end_time_1)
        start_time_1 = time_rdr(0).ToString
        end_time_1 = time_rdr(1).ToString

        If appt_time_txt0.Text >= start_time_1 And appt_time_txt0.Text <= end_time_1 Then
            date_valid_lbl0.Visible = True
            date_valid_lbl0.Text = "*Valid Time"

        Else
            time_valid_lbl0.Visible = True
            time_valid_lbl0.Text = "*Not Valid Time"
        End If

    End While
    time_rdr.Close() 
```

我不知道我的逻辑是否有问题 XD。这些列中填写的数据采用以下格式：`00:00AM or 00:00PM.` 感谢您的帮助..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:13:50.887

看起来您正在从阅读器加载数据之前进行解析。

```
compared_time_1 = DateTime.Parse(start_time_1)
compared_time_2 = DateTime.Parse(end_time_1)
start_time_1 = time_rdr(0).ToString
end_time_1 = time_rdr(1).ToString 
```

应该

```
start_time_1 = time_rdr(0).ToString
end_time_1 = time_rdr(1).ToString
compared_time_1 = DateTime.Parse(start_time_1)
compared_time_2 = DateTime.Parse(end_time_1) 
```

但我什至会做不同的事情。如果您想判断时间是否有效，可以使用 datetime TryParse 方法。也许一些重构也可能对您有所帮助。最后，请注意，如果计划项目有可能在午夜之前开始并在第二天午夜之后结束，那么比较时间可能会出现问题。

```
Sub ReadingData()

   'initializing reader stuff here...

    Dim dtStart As DateTime, dtEnd As DateTime
    If DateTime.TryParse(time_rdr(0).ToString, dtStart) = False Then
        HandleInvalidTime()
    End If

    If DateTime.TryParse(time_rdr(1).ToString, dtEnd) = False Then
        HandleInvalidTime()
    End If

   'Closing out reader stuff here...

    HandleValidTime(dtStart, dtEnd)

End Sub

Sub HandleValidTime(TheStartTime As DateTime, TheEndTime As DateTime)
    'Do Stuff
End Sub

Sub HandleInvalidTime()
    'Do Stuff
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:19:57.537

好像您正在将字符串与日期数据类型进行比较。

确保将两者都转换为日期数据类型，如下所示。注意秒和“AM”之间的空格。

```
time1=CDate("3:19:40 AM")
time2=CDate("3:10:40 AM") 
```

然后进行如下比较：

```
if time1>time2 then
   'logic 
end if 
```

# actionscript-3 - 错误：#1009：类型错误（第 114 行）

> ID：13863402
> 
> 赞同：1
> 
> 时间：2012-12-13T15:46:20.630
> 
> 标签：actionscript-3

我有点闪现，但我现在正在编写游戏，我试图让我的角色移动，但我收到错误 #1009 这是我在“GameState”中的代码。基本上它在任何按键上都会出错，我的角色名为播放器（库中的播放器），并且其中有另一个名为 WalkDown 的电影剪辑（我在时间轴上给它一个实例名称 walkDown）我不太确定发生了什么上。具体来说，它在调用框架名称的行上出错。任何帮助，将不胜感激！包裹 {

```
import flash.display.Stage;
import flash.display.MovieClip;
import flash.events.Event;
import flash.events.MouseEvent;
import flash.events.KeyboardEvent;
import flash.ui.Keyboard;
import flash.geom.Point;

public class GameState extends MovieClip {

    private var player:MovieClip;
    private var walking:Boolean = false;

        // is the character shooting
        //private var shooting:Boolean = false;

        // wlaking speed
        private var walkingSpeed:Number = 5;
        private var xVal:Number = 0;
        private var yVal:Number = 0;

    public function GameState() {

        // constructor code
        player = new Player();
        addChild(player);
        player.x = 300;
        player.y = 300;
        player.gotoAndStop("stance");

    this.addEventListener(Event.ADDED_TO_STAGE, initialise);

    }
    private function initialise(e:Event){
        // add a mouse down listener to the stage
        //addEventListener(MouseEvent.MOUSE_DOWN, startFire);

        // add a mouse up listener to the stage
        //addEventListener(MouseEvent.MOUSE_UP, stopFire);
        player.addEventListener(Event.ENTER_FRAME,motion);
        stage.addEventListener(KeyboardEvent.KEY_UP,onKey); 
        // add a keyboard down listener
        stage.addEventListener(KeyboardEvent.KEY_DOWN, offKey);
        stage.focus = stage;

        // Add keyboard events

    }
    private function motion(e:Event):void{
        // if we are currently holding the mouse down
        //if (shooting){
            //FIRE
            //fire();

        //}
       player.x +=  xVal;
       player.y +=  yVal;

        }

    //private function startFire(m:MouseEvent){
        //shooting = true;
    //}
    //private function stopFire(m:MouseEvent){
        //shooting = false;
    //}
    private function onKey(evt:KeyboardEvent):void
    {
        trace("key code: "+evt.keyCode);
        switch (evt.keyCode)
        {
            case Keyboard.W :
               yVal =  walkingSpeed;

                if (! walking)
                {
                    trace("walking up");
                    player.walkDown.gotoAndPlay("walking");
                    walking = true;
                }
                break;
            case Keyboard.S :
                yVal = - walkingSpeed;
                if (! walking)
                {
                    player.walkDown.gotoAndPlay("walking");
                    walking = true;
                }
                break;
            case Keyboard.A :
            xVal = walkingSpeed;
                if (! walking)
                {
                     player.walkDown.gotoAndPlay("walking");
                    walking = true;
                }
                break;
            case Keyboard.D :
               xVal = walkingSpeed;
                if (! walking)
                {
                    player.walkDown.gotoAndPlay("walking");
                    walking = true;
                }
             break;
        }
    }
    private function offKey(evt:KeyboardEvent):void
    {
        switch (evt.keyCode)
        {
            case Keyboard.W :
                //for now just reset velocity to zero
                yVal = 0;
            //also stop walk cycle etc.
               player.gotoAndStop("stance");
                //don't forget to update your Boolean
                walking = false;
                break;
                 case Keyboard.S :
                //for now just reset velocity to zero
                yVal = 0;
            //also stop walk cycle etc.
               player.gotoAndStop("stance");
                //don't forget to update your Boolean
                walking = false;
                break;
                 case Keyboard.A :
                //for now just reset velocity to zero
                xVal = 0;
            //also stop walk cycle etc.
               player.gotoAndStop("stance");
                //don't forget to update your Boolean
                walking = false;
                break;
                     case Keyboard.D :
                //for now just reset velocity to zero
                xVal = 0;
                //also stop walk cycle etc.
               player.gotoAndStop("stance");
                //don't forget to update your Boolean
                walking = false;
                break;
        }
    }
    // Players Motion

    private function fire():void{
        var b= new Bullet();
        // set the position and rotation of the bullet
        b.rotation = rotation;
        b.x = x;
        b.y = y;
        // add bullets to list of bullets
        MovieClip(player).bullets.push(b);

        // add bullet to parent object
        player.addChild(b);
        // play firing animation        
        player.shooting.gotoAndPlay("fire");
    }

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T10:16:19.343

您说的是错误 #1009（无法访问空对象引用的属性或方法），当您这样做时

```
player.walkDown.gotoAndPlay("walking"); 
```

如果是这样，那是因为您必须先转到 WalkDown 影片剪辑所在的帧，然后才能访问它。

如果说您的“姿势”帧在第 1 帧，而您的 WalkDown MovieClip 在第 2 帧。您在 onKey 函数中的代码应如下所示：

```
case Keyboard.W :
    yVal =  walkingSpeed;

    if (! walking)
    {
        trace("walking up");
        player.gotoAndStop(2); // player.walkDown is now accessible //
        player.walkDown.gotoAndPlay("walking");
        walking = true;
    }
    break; 
```

# reporting-services - 报表设计器 - 将 IIF 嵌套在具有多个数据集的 Sum 中

> ID：13863405
> 
> 赞同：2
> 
> 时间：2012-12-13T15:46:27.807
> 
> 标签：reporting-services

虽然这个问题的各个部分有很多代码示例，但作为报表设计器的新手，我无法获得正确的语法。

我有一个文本字段，我想显示三个数据集中之一的“保留时间”的总和，这由同一数据集中的另一个字段确定，其值为“H”。

因此，将其分解，这可以将 ReportDataset 中的所有时间相加。

```
=Sum((Fields!RegHrs.Value + Fields!OvtHrs.Value),"ReportDataset") 
```

现在，我需要以某种方式将其嵌套在 IIF 中。当 BillStatus =“H”时，我需要 SUM 表达式成为 IIF 的“真”返回值。

```
IIF(Fields!BillStatus.Value = "H",true,false) 
```

我似乎无法弄清楚如何组合 IIF 和 SUM，以便它们从“ReportDataset”中提取并且在语法上是正确的。

我一直在尝试这个的各种排列：

```
=Sum(IIF(Fields!BillStatus.Value = "H",((Fields!RegHrs.Value + Fields!OvtHrs.Value),"ReportDataset"),0)) 
```

任何指针？

* * *

新信息：

以下报告在语法上是正确的，但给我 0 作为返回值。

```
=Sum(IIF(Fields!BillStatus.Value = "H", (Fields!RegHrs.Value + Fields!OvtHrs.Value),0),"ReportDataset") 
```

应该有数百小时返回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T01:25:53.450

尝试嵌套总和：

```
=Sum(IIF(Fields!BillStatus.Value = "H", Sum(Fields!RegHrs.Value + Fields!OvtHrs.Value,"ReportDataset"),0),"ReportDataset") 
```

或者：

```
=IIF(Fields!BillStatus.Value = "H", Sum(Fields!RegHrs.Value + Fields!OvtHrs.Value,"ReportDataset"),0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T22:27:03.173

你能用 SQL 在你的数据集中做吗？如果是这样，只需使用以下内容：

```
SELECT CASE WHEN BillStatus = 'H' THEN RegHrs + OvtHrs END AS HeldHours
FROM MyTable 
```

然后你需要做的就是对这个字段求和：

```
=Sum(Fields!HeldHours.Value, "ReportDataSet") 
```

# c# - 如何使用 RelativeSource Binding 创建 DataGrid 绑定到 Model 和 ViewModel？

> ID：13863408
> 
> 赞同：3
> 
> 时间：2012-12-13T15:46:43.657
> 
> 标签：c#, binding, datagrid, relative-path, itemssource

我有一个 DataGrid，它有一个使用 DataGrid 的 ItemsSource 绑定的 DataGridTemplateColumn，但是在 DataGridTemplateColumn 的 ComboBox 中，我希望能够绑定到 View 而不是 ItemsSource 的 ViewModel。

```
 <DataGrid ItemsSource="{Binding ModelValues, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" >
      <DataGridTemplateColumn Header="myHeader" Width="200">
           <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                     <ComboBox DisplayMemberPath="Value" SelectedValuePath="Key" IsEnabled="False"
                          SelectedValue="{Binding myID, Mode=TwoWay}"
                          ItemsSource="{Binding Path=myList, 
                          RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ViewModel}}}" />
                </DataTemplate>
           </DataGridTemplateColumn.CellTemplate>
           <DataGridTemplateColumn.CellEditingTemplate>
                <DataTemplate>
                     <ComboBox DisplayMemberPath="Value" SelectedValuePath="Key" IsEnabled="False"
                          SelectedValue="{Binding myID, Mode=TwoWay}"
                          ItemsSource="{Binding Path=myList, 
                          RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ViewModel}}}" />
                </DataTemplate>
           </DataGridTemplateColumn.CellEditingTemplate>
      </DataGridTemplateColumn>
 </DataGrid> 
```

ViewModel 具有`ModelValues`属性和`myList`属性。`ModelValues`用于 的，`ItemsSource`我`DataGrid`想`myList`用于`ComboBox` `ItemsSource`。

我将如何更改我的`RelativeSource`命令以使其正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T15:49:00.970

绑定到网格的数据上下文：

```
<DataGrid ItemsSource="{Binding ModelValues, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" >
      <DataGridTemplateColumn Header="myHeader" Width="200">
           <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                     <ComboBox DisplayMemberPath="Value" SelectedValuePath="Key" IsEnabled="False"
                          SelectedValue="{Binding myID, Mode=TwoWay}"
                          ItemsSource="{Binding Path=DataContext.myList, 
                          RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGrid}}}" />
                </DataTemplate>
           </DataGridTemplateColumn.CellTemplate>
           <DataGridTemplateColumn.CellEditingTemplate>
                <DataTemplate>
                     <ComboBox DisplayMemberPath="Value" SelectedValuePath="Key" IsEnabled="False"
                          SelectedValue="{Binding myID, Mode=TwoWay}"
                          ItemsSource="{Binding Path=DataContext.myList, 
                          RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGrid}}}" />
                </DataTemplate>
           </DataGridTemplateColumn.CellEditingTemplate>
      </DataGridTemplateColumn>
 </DataGrid> 
```

# .net - “AddRemoveClearMap”类型的 .NET CSD 配置集合：为什么孩子需要关键属性？

> ID：13863411
> 
> 赞同：2
> 
> 时间：2012-12-13T15:46:47.603
> 
> 标签：.net, app-config, config-designer-csd

我正在使用[配置部分设计器 (CSD)](http://csd.codeplex.com/)来管理我的 .NET app.config 文件结构，到目前为止我很喜欢它。

问题是，我需要一组不适合拥有钥匙的物品。这是具有类型 (User|Group} 和名称的权限列表。可以有多个相同类型的项目和多个相同名称的项目。

不能使用 type 的集合来做到这一点是有道理的`BasicMap`；但是`AddRemoveClearMap`收藏呢？（好的，“地图”`AddRemoveClearMap`没有帮助，我需要列表语义）。

当我尝试像这样配置它时，这就是 CSD 所说的：

> 此集合的项目类型没有键属性。

![在此处输入图像描述](../Images/62d0584f9854c0a6a344566d78293e29.png)

欢迎任何指点。

PS。[这个答案](https://stackoverflow.com/a/1471051/11545)建议我向集合中的对象添加一个虚假（唯一）GUID 属性并将其用作键。我会尝试看看我是否可以弯曲 CSD 以允许这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T09:18:44.893

我与 CSD 开发人员交谈，显然这个功能目前正在实施，显然是使用我在问题中提到的 SO 帖子中的想法。

此处正在讨论状态：http: [//csd.codeplex.com/discussions/406983](http://csd.codeplex.com/discussions/406983)

# php - 发布后的302状态码

> ID：13863415
> 
> 赞同：0
> 
> 时间：2012-12-13T15:47:08.180
> 
> 标签：php, post, http-status-code-302

我试图弄清楚为什么我会得到这个代码。我可以在我的开发人员工具上看到我的 POST 方法，但它上面有一个 302 代码。它也没有将我的数据发布到我的桌子上。302 代码会导致我的数据无法发布吗？

我可以看到我的数据，但它不会去我想要去的地方。

我有一个 switch case 语句，它在视图的 $_GET 键上发生了变化。

这就是我从开发人员工具中得到的回报

```
Request URL:http://www.myurl.com/roi/?view=ticket_submit
Request Method:POST
Status Code:302 Found 
```

我有一个 switch case 语句来在视图键中查找不同类型的值。

即使我的工具告诉我它在那里，它也永远不会涉及到 ticket_view 的情况。所以问题是，我是没有正确发布我的数据，还是 302 把它扔掉了，或者两者兼而有之？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:53:59.487

处理程序`/roi/?view=ticket_submit`正在抛出 HTTP 302 状态。您还应该获得处理程序也尝试重定向网络浏览器的位置..

我猜重定向在服务器端没有正确处理。

# java - Java 默认构造函数问题 - 什么实际上构成了“默认构造函数”？

> ID：13863416
> 
> 赞同：0
> 
> 时间：2012-12-13T15:47:10.427
> 
> 标签：java, constructor, default-constructor

> **可能重复：**
> [Java 默认构造函数](https://stackoverflow.com/questions/4488716/java-default-constructor)

我正在研究 Java 练习题并遇到了这个问题：

鉴于：

```
class X {}

class Y {Y () {}}

class Z {z(int i ) {} } 
```

哪个类有默认构造函数？

**A.**仅限 X

**仅限**B.Y****

 ****仅限**C.Z****

 ****D.** X 和 Y

**E.** Y 和 Z

**F.** X 和 Z

**G.** X、Y 和 Z

我想说正确的答案是 A，因为类 X 是唯一没有任何明确定义的构造函数的类。我的同行说它将是 G，因为构成默认构造函数的是当您实际更改构造函数主体中的值时。

我们已经做了一些研究，当谈到默认构造函数实际上是什么时（在这个级别），答案似乎有所不同。

谁能在这里提供答案和合乎逻辑的解释？非常感谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T15:50:43.357

> 我的同行说它将是 G，因为构成默认构造函数的是当您实际更改构造函数主体中的值时。

我想说你的同行在语言层面上是错误的。*仅限*[JLS 的第 8.8.9 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.8.9) *使用术语“默认构造函数”来表示“如果没有显式指定构造函数，编译器提供的构造函数”。*

 *我希望更明确地说明这一点 - 我也希望 C# 使用相同的术语:(*****

# ios - 来自应用程序的 Facebook 消息未完全显示在时间线中

> ID：13863421
> 
> 赞同：1
> 
> 时间：2012-12-13T15:47:33.367
> 
> 标签：ios, facebook, facebook-graph-api, facebook-timeline

我有一个关于将消息从 iOS 应用程序发布到 Facebook 时间线的问题。当我在我的时间轴上看到我的消息全文之前发布了一条消息 - [http://qblx.co/WIHuaN](http://qblx.co/WIHuaN)。但不是我只能看到它的前两行 - [http://qblx.co/TWIQjY](http://qblx.co/TWIQjY)。有谁知道是什么问题？

任何信息将不胜感激。

# java - 线程转储显示不正确的线程状态

> ID：13863426
> 
> 赞同：1
> 
> 时间：2012-12-13T15:48:02.490
> 
> 标签：java, multithreading, concurrency

我正在尝试诊断生产问题。我在 Mac OS Lion 上设置了一个小测试程序，它启动 10 个线程（在同步块中使用 Executors.newCachedThreadPool()，它们都调用 MUTEX.wait()）

然后我执行 kill -3 以获取线程转储，我看到我的所有线程都显示为 BLOCKED。这些不应该都在等待吗？

代码是这样的，（为简洁起见，请原谅引入的代码气味）

```
ExecutorService executor = Executors.newCachedThreadPool();
final Object MUTEX = new Object();
for(int i = 0; i < 10; i++) {
   executor.execute(new Runnable() {
      public void run() {
        synchronized(MUTEX) {
         MUTEX.wait();
}  }   }} 
```

此时所有线程都应该处于 WAITING 状态，但实际上线程转储显示所有线程都已阻塞

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:50:55.307

因为您的线程正在等待监视器锁进入同步块/方法，所以它们的状态是`BLOCKED`.

一个被阻塞等待监视器锁的线程处于该`BLOCKED`状态，而一个无限期地等待另一个线程执行特定操作的线程处于该`WAITING`状态。

`BLOCKED`有关和之间区别的更多详细信息，请参见下文`WAITING`：

来自[BLOCKED](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.State.html#BLOCKED)的JavaDoc ：

> 线程阻塞等待监视器锁的线程状态。处于阻塞状态的线程正在等待监视器锁进入同步块/方法或调用后重新进入同步块/方法`Object.wait`。

来自[WAITING](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.State.html#WAITING)的 JavaDoc ：

> 处于等待状态的线程正在等待另一个线程执行特定操作。例如，调用 `Object.wait()`了一个对象的线程正在等待另一个线程调用 该`Object.notify()`对象`Object.notifyAll()`。已调用的线程`Thread.join()`正在等待指定线程终止。

# ruby - ruby rexml：干净地解析xml文件

> ID：13863431
> 
> 赞同：0
> 
> 时间：2012-12-13T15:48:17.383
> 
> 标签：ruby, xml-parsing, rexml

我有以下 XML 文件：

```
<Response Version="X">
  <Status StatusCode = "OK">
  <Internal>
    <SP>
      <URL>SP_url_1</URL>
    </SP>
    <SP>
      <URL>SP_url_2</URL>
    </SP>
  </Internal>
<Response> 
```

我想在一个数组中获取所有 URL 元素的文本。

我实现了以下内容：

...执行 HTTP GET 请求...

```
response_xml = REXML::Document.new(response.body).root
if response_xml.nil? or response_xml.name != 'Response'
  raise ParseError, "Invalid service discovery response!"
end    
status_code  = response_xml.elements['Status'].attribute('StatusCode').value
if status_code == 'OK'
  urls = response_xml.elements.each('//URL') { |u| u }
end
urls 
```

关于这一行`response_xml.elements.each('//URL') { |u| u }`，您能否推荐一种更简洁的方法来获取数组中的所有 URL 元素？也许有一种更明智的方法可以通过 REXML 方法进行，但现在看不到。

欢迎任何其他 REXML 或一般代码建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:28:50.397

要使用 XPath 获取文本节点，您可以使用`text()`：

```
urls = response_xml.elements.each('//URL/text()') { |u| u } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T17:08:27.750

我非常喜欢在我的 XML 解析器中使用[Nokogiri ：](http://nokogiri.org)

```
require 'nokogiri'
doc = Nokogiri::XML(<<EOT)
<Response Version="X">
  <Status StatusCode = "OK">
  <Internal>
    <SP>
      <URL>SP_url_1</URL>
    </SP>
    <SP>
      <URL>SP_url_2</URL>
    </SP>
  </Internal>
<Response>
EOT

if (doc.at('Status')['StatusCode'] == 'OK')
  urls = doc.search('URL').map(&:text)
  # => ["SP_url_1", "SP_url_2"]
end 
```

或者：

```
urls = doc.search('URL').map(&:text) if (doc.at('Status')['StatusCode'] == 'OK') 
```

# database - noSql 相对于 newSql 的优势

> ID：13863432
> 
> 赞同：2
> 
> 时间：2012-12-13T15:48:28.193
> 
> 标签：database, nosql

现在看来，Google 押注于大数据存储的 NewSql 解决方案。

我想知道 NoSql 解决方案与 newSql 解决方案相比是否还有一些优势？（比如内存管理或其他东西）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-17T15:31:35.767

如果您愿意尝试利用传统关系数据库管理系统 (RDBMS) 的长期优势并使其与 NoSql 数据存储的亮点竞争的话，NewSql 数据库是一种新的数据库“系列”。它们不是对 RDBMS 的更新或改进，而是更常见的重写，包括抽象数据库“分片”实践的中间件或像 NoSql 那样在计算机网格上分发数据库的能力。

RDBMS 的强大主要来自通过结构化查询语言 (SQL) 的可查询性、它们的事务性和对 ACID 原则（原子性、一致性、隔离性、持久性）的遵守以及随着时间的推移开发的用于管理它们的强大工具。一个较小的好处来自关系模型消除了在多个地方重复存储相同信息的事实。

NoSql 的好处是速度快、能够横向扩展计算网格以及无需维护模式。这使得它们即使针对庞大的数据存储也具有非常高的性能。但是它们缺乏您从传统 RDBMS 中获得的好处，因为用于操作数据的查询语言并不真正存在（还没有），它们不能跨计算网格进行事务处理，并且它们缺乏对抗它们的工具，例如MS Sql 服务器管理工​​作室。

NewSql 正在尝试两全其美，我认为它最终会。[这是一个很好](http://www.bananagunprogramming.com/?p=71)的关于 RDBMS Vs NoSql Vs NewSql onbananagunprogramming.com 的**文章**。

# sql-server-2008 - sql server 2008 安全 什么是所有者

> ID：13863434
> 
> 赞同：2
> 
> 时间：2012-12-13T15:49:03.327
> 
> 标签：sql-server-2008

多年来我一直在使用 SQL SERVER，而没有想到 dbo 是什么，真可惜。最近一直在研究SQL Server 2008的安全性，被很多概念搞得不知所措。所以请先澄清我这些概念（如果我错了，请纠正我）。我不需要对所有事情进行彻底的解释，只需要知道什么是什么以及它们之间的关系。

LOGIN：服务器级别（sql server登录或windows登录）。

USER：数据库级别。（用户映射到登录）。

ROLE：USERS属于一个ROLE。可以是附加权限的服务器级别或数据库级别。

SCHEMA：数据库对象属于一个 SCHEMA（或默认为 dbo）

权限：用于数据库对象或模式。USER 或 ROLE 具有对象或 SCHEMA 的权限。

OWNER：对象或 SCHEMA 的所有者？它有什么作用？这个怎么运作？我在哪里可以看到 SSMS 中对象的所有者？我只看到 SCHEMA.object。

谢谢，年

# c# - UltraGrid 表过滤：我可以将过滤器设置存储和调用到数据库吗？

> ID：13863439
> 
> 赞同：1
> 
> 时间：2012-12-13T15:49:31.617
> 
> 标签：c#, filter, save, ultrawingrid

我有一个超网格数据表，其中包含两列或三列，这些列将根据查看报告的人员而经常更改。我想知道是否可以存储过滤器，以便如果一个人想要状态 -> 已付款，日期 -> 今日，状态 -> 未发送作为过滤器，它可能是预先确定的单击而不是设置每个字段？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T20:31:36.497

您可以通过保存 UltraGrid 布局来完成此操作。下面的示例将布局保存到文件中，但您也可以使用该文件将其保存在数据库记录中。

尝试使用 PropertyCategories，但注意不要将数据保存在网格上。

```
 private void btnSaveLayout_Click ( object sender, EventArgs e ) {
        // show dialog to choose file
        if ( saveFileDialog1.ShowDialog ( this ) == DialogResult.OK ) {
            // open file stream
            System.IO.FileStream fileLayout = new System.IO.FileStream ( saveFileDialog1.FileName, System.IO.FileMode.OpenOrCreate );
            // reset position
            fileLayout.Seek ( 0, System.IO.SeekOrigin.Begin );
            // write layout
            this.ultraGrid.DisplayLayout.Save ( fileLayout,
                Infragistics.Win.UltraWinGrid.PropertyCategories.AppearanceCollection
                | Infragistics.Win.UltraWinGrid.PropertyCategories.ColumnFilters
                | Infragistics.Win.UltraWinGrid.PropertyCategories.Groups
                | Infragistics.Win.UltraWinGrid.PropertyCategories.SortedColumns
                | Infragistics.Win.UltraWinGrid.PropertyCategories.Summaries
                | Infragistics.Win.UltraWinGrid.PropertyCategories.ColScrollRegions
            );
            // close stream
            fileLayout.Close ();
        }
    }

    private void btnLoadLayout_Click ( object sender, EventArgs e ) {
        // show dialog to choose file
        if ( openFileDialog1.ShowDialog ( this ) == DialogResult.OK ) {
            // open file stream
            System.IO.FileStream fileLayout = new System.IO.FileStream ( openFileDialog1.FileName, System.IO.FileMode.Open );
            // reset position
            fileLayout.Seek ( 0, System.IO.SeekOrigin.Begin );
            // load layout
            this.ultraGrid.DisplayLayout.Load ( fileLayout,
                Infragistics.Win.UltraWinGrid.PropertyCategories.AppearanceCollection
                | Infragistics.Win.UltraWinGrid.PropertyCategories.ColumnFilters
                | Infragistics.Win.UltraWinGrid.PropertyCategories.Groups
                | Infragistics.Win.UltraWinGrid.PropertyCategories.SortedColumns
                | Infragistics.Win.UltraWinGrid.PropertyCategories.Summaries
                | Infragistics.Win.UltraWinGrid.PropertyCategories.ColScrollRegions
            );
            // close stream
            fileLayout.Close ();
        }
    } 
```

在提交布局保存之前，您还可以考虑检查 SaveLayout 方法，以确保网格内实际上有任何数据。

# javascript - jQuery 单击在 Safari 中不起作用

> ID：13863448
> 
> 赞同：0
> 
> 时间：2012-12-13T15:50:07.500
> 
> 标签：javascript, jquery, safari

出于某种原因，此脚本在 Safari 中不起作用（在 Windows 上测试，但认为它也发生在 Mac 上）：

```
$("#searchTerms").focus(function() {
    $(document).keypress(function(e) {
        if(e.which == 13) {
            $("#searchBtn img").click();
        }
    });
}); 
```

jsFiddle：http: [//jsfiddle.net/ux86V/](http://jsfiddle.net/ux86V/)

当用户在专注于搜索框时按下回车键时，该脚本应该单击图像（它必须以这种方式设置，它与一些奇怪的第三方服务相关联）。

编辑：它似乎在 jsFiddle 中根本不起作用，但确实如此，所以不要只是假设整个脚本都是坏的。我认为 jSFiddle 只是防止重定向，我将其设置为重定向到 google.com 以作为示例。

编辑2：这似乎是一个问题`.click()`。有没有我可以使用的替代方法，或者是`.click()`注册元素点击的唯一方法？

编辑 3：经过更多测试，jQuery click 事件似乎无法正常工作。这可能与提交表单的方式有关，我不确定。现场演示链接：[http ://www.weblinxinc.com/beta/blue-sky-marketing/demo/](http://www.weblinxinc.com/beta/blue-sky-marketing/demo/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:42:05.557

尝试使用`trigger();`

```
$("#searchTerms").focus(function() {
    $(document).keyup(function(e) {
        if(e.which == 13) { 
            $("#searchBtn img").trigger("click");
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:51:43.200

13是回车键的代码，是一个特殊的键，你只能抓住`keyup`它

# javascript - 在 Chrome 中创建具有大背景图像且性能不佳的部分

> ID：13863451
> 
> 赞同：2
> 
> 时间：2012-12-13T15:50:32.013
> 
> 标签：javascript, css, google-chrome, scroll, parallax

我有一个单页网站，并且添加了一些带有大背景图像的部分。我希望它们具有“固定”效果，因此当用户滚动时它们不会移动。所以我用`background-size: cover;`和`background-attachment: fixed`。这可以完成工作。然而，问题是它在 Chrome 中非常滞后，我认为 chrome 不会缓存图像或其他东西。你可以在这里测试它：

[http://jsfiddle.net/sallar/rwyfZ/1/](http://jsfiddle.net/sallar/rwyfZ/1/)

它不像其他浏览器那样流畅。所以我尝试使用图像（在本例中使用 $.backstretch）。使用这种方法滚动滞后是固定的并且滚动非常流畅，但它没有我想要的“固定”效果。所以我想我应该使用视差效果。但是我尝试过的所有视差插件或方法都没有在“图像”方面做得很好，它们都针对背景图像进行了优化，由于 Chrome 中的这个问题我无法使用。

这是 Backstretch 示例的演示：

[http://jsfiddle.net/sallar/FX4Cn/1/](http://jsfiddle.net/sallar/FX4Cn/1/)

那么，我应该怎么做才能使它们具有固定的样式并像第二个示例一样使页面滚动流畅？
提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:30:58.093

除了第二个肯定没有固定外，我看不出有什么大的区别。

我认为您的“问题”是 Chrome 会逐步滚动，而 Firefox 和 Opera 则不会（我不太了解其他自动取款机）。下次您可能会尝试在 Google 上搜索“平滑滚动 chrome”之类的内容，以查看针对此“问题”的数百个问题和解决方案之一。

理论上可以使用 Javascript 来做到这一点，但我找不到任何有用/有效的示例 atm。

# java - 使用 SJXP 将属性值 AND 节点值解析为同一个用户对象

> ID：13863456
> 
> 赞同：0
> 
> 时间：2012-12-13T15:50:51.603
> 
> 标签：java, xml, xml-parsing, sjxp

我正在尝试使用[简单 Java XML 解析器 (SJXP)](http://www.thebuzzmedia.com/software/simple-java-xml-parser-sjxp/)，但遇到了我需要解析为数据类的 XML 问题。

## 数据.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE SYSTEM "local-1.2.2.dtd" >
<data>
    <article>
        <field name="name" type="text">HOTELS</field>
        <field name="name_de" type="text">HOTELS</field>
        <field name="name_zh" type="text">酒店</field>
        <field name="color" type="text">6,68,109,0.85</field>
        <field name="textcolor" type="text">255,255,255,1</field>
    </article>
 <!-- 20000 more articles ... -->
</data> 
```

我试图这样做：

## xml处理程序.java

```
private Map<String, Category> categoryMap;

private XMLParser<Category> categoryParser = new XMLParser<Category>(
        new DefaultRule<Category>(IRule.Type.CHARACTER, "/data/article") {
            @Override
            public void handleParsedCharacters(XMLParser<Category> parser, String text, Category category) {

                Log.d("XmlHandler", "Hello");
                if (category != null) {
                    categoryMap.put(category.getName(Category.LANG.EN), category);
                    Log.d("XmlHandler", "Saved category to map. New count="+categoryMap.values().size());
                    category.reset();
                } else {
                    category = new Category();
                    Log.d("XmlHandler", "Creating a new category");
                }
            }
        },
        new CategoryNameRule()
);

private class CategoryNameRule extends DefaultRule<Category> {

    private String nameKey = "";

    public CategoryNameRule() {
        super(Type.ATTRIBUTE, "/data/article/field", "name");
    }

    @Override
    public void handleParsedAttribute(XMLParser parser, int index,
                                      String value, Category category) {
        nameKey = value;
    }

    @Override
    public void handleParsedCharacters(XMLParser parser, String text, Category category) {

        Log.d("XmlHandler", "Handling nameKey="+nameKey);

        if(nameKey == null || nameKey.length() == 0){
            return;
        }else if( "name".equals(nameKey)){
           category.setName(Category.LANG.EN, text);
        }else if( "name_de".equals(nameKey)){
           category.setName(Category.LANG.DE, text);
        }else if( "name_zh".equals(nameKey)){
           category.setName(Category.LANG.ZH, text);
        }else if( "color".equals(nameKey)){
           category.colorBackground = getConvertedColor(text);
        }else if( "textcolor".equals(nameKey)){
           category.colorForeground = getConvertedColor(text);
        }

    }
} 
```

问题是我的哈希图在整个文档被解析后变成空的，我不知道为什么。我的猜测是我会结合 IRule.Type.CHARACTER 和 IRule.Type.ATTRIBUTE 但我不知道如何实现。

有什么想法/经验吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T21:28:08.287

Stefan，我很抱歉错过了这个问题（我在搜索其他内容时偶然通过谷歌找到了这个问题）。

这里有几点令人困惑，所以让我澄清一下，然后概述我建议如何解决这个问题（假设你没有找到方法，但我意识到这是 3 个月前）

首先，你是对的，你需要一个 CHARACTER 规则和 ATTRIBUTE 规则的组合。CHARACTER 规则将为您提供标签*之间*的内容，例如：

```
<tag>this is CHARACTER data</tag> 
```

其次，您的规则应该针对包含您需要的数据的标签，在上面的示例中，在您到达 /data/article/field 级别之前，您似乎没有得到任何区分数据（各个字段同时包含 ATTRIBUTES 和 CHARACTERS你要）

*看起来*您关闭（打开标签）以告知您何时输入了新文章，因此您知道您正在为特定的、独特的文章收集字段信息。在这种情况下，您实际上可以在点击开始标签时使用 TAG 规则来归档，因此您可以执行一些逻辑，例如在 HashMap 中为即将解析的新文章创建新记录。

最后，您传递给处理程序的*Category参数是一个**传递*用户变量。

这意味着您可以调用 Parse 方法：

```
XMLParser<List<Article>> p = new XMLParser<List<Article>>(... stuff ...);
List<Article> articleList = new ArrayList<Article>();

p.parse(input, articleList); 
```

这允许您的所有处理程序直接访问您的 articleList，以便他们可以直接在其中解析/存储信息，因此当对 parse(...) 的调用返回时，您知道您的列表是最新的并已更新。

如果您没有向 userObject 字段中的 parse 方法传递任何内容，则处理程序都将收到一个*空*参数。

*您对Category*的使用检查让我感到困惑，并让我认为您期望在调用处理程序时在那里获得变化的值，但事实并非如此。我只是想澄清一下。

**概括**

我认为您完美的解析器设计将包括 3 条规则：

*   /data/article TAG 规则——在遇到 START 文章标签时执行某些操作（并且可选地在遇到 CLOSE 文章标签时）。
*   /data/article/field CHARACTER 规则——存储字段的解析字符数据。
*   /data/article/field ATTRIBUTE 规则——存储字段的解析属性数据。

我希望这会有所帮助！

# f# - F# 调试和代码维护：是否有适用于 F# 的分解、分解工具？

> ID：13863459
> 
> 赞同：1
> 
> 时间：2012-12-13T15:50:55.320
> 
> 标签：f#, functional-programming

在处理一长串分解的 F# 代码时，有时我必须出于各种原因取消分解代码，以便我可以修改代码以修复错误或添加更改，然后再次分解代码。

由于分解和分解在很大程度上是应该能够自动化的符号转换，（我知道这在现实中并不容易）；有人做过这样的工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:56:38.870

我不知道有任何类似的工具，我假设您正在询问有关打断管道的问题，以便您可以在某处放置一个断点并检查结果。我同意这是在 F# 中使用代码最难的部分，一旦你编写了它，几乎不可能通过所有惰性求值和组合来逐步完成它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T10:33:36.187

在这种情况下，覆盖前向管道运算符可能很有用，它允许您在其上放置断点。不一定能解决惰性/组合问题，但无论如何都是一个有用的技巧。

详情在这里：

[http://www.kiteason.com/blogengine/post/2012/09/13/Tapping-into-the-pipe.aspx](http://www.kiteason.com/blogengine/post/2012/09/13/Tapping-into-the-pipe.aspx)

# c# - 如何在网页上使用 WIA 从客户端计算机获取图像

> ID：13863461
> 
> 赞同：0
> 
> 时间：2012-12-13T15:51:07.077
> 
> 标签：c#, asp.net, wia

我试图弄清楚如何在 ASP.NET/C# 网页上使用 WIA 从客户端计算机上的相机捕获图像。用户将使用 Microsoft LifeCam 相机，从我的网页中，我希望他们能够拍摄照片并将其存储在数据库中。我想我需要为此使用 DirectX，这是一个可以接受的解决方案，但任何解决方案都会很棒。

我的大问题是我似乎找不到任何关于如何在网页上执行此操作的示例/文档。我所发现的只是说可以完成但没有解释如何完成的东西。任何人都可以提供的任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:02:17.373

看来您必须使用 tlibimp（来自 wiascr.tlb）为接口生成一个 dll，您可以将其添加为 c# 中的参考，然后您可以按照教程（http://msdn.microsoft.com/en-us/库/ms629859(v=vs.85).aspx)。

# selenium - 测试自动化框架的技巧

> ID：13863462
> 
> 赞同：-1
> 
> 时间：2012-12-13T15:51:13.170
> 
> 标签：selenium, automation, webdriver

我计划使用 Webdriver 为我的应用程序构建一个自动化框架。任何人都可以帮助我提供任何可以帮助我的想法/提示/材料吗？因为我对设计框架没有太多想法。把我当作首发，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:24:35.293

这是一个非常普遍的问题，我建议您阅读一些关于[Selenium Web 测试自动化框架最佳实践](https://stackoverflow.com/questions/5359150/question-selenium-web-test-automation-framework-best-practices)的内容，这也可以帮助您更好地定义您的想法[http://selftechy.com/2011/06/19/designing-test -自动化框架与硒](http://selftechy.com/2011/06/19/designing-test-automation-framework-with-selenium)

# javascript - Ext JS 3.4 延迟渲染手风琴 - 面板的强制渲染

> ID：13863463
> 
> 赞同：0
> 
> 时间：2012-12-13T15:51:17.297
> 
> 标签：javascript, extjs, extjs3

我将一个大型应用程序从 v2 升级到 v3.4

我有一个带有 n > 1 面板的手风琴。默认情况下，第一个是展开的，而所有其他的都不是。与现在使用 Ext 3.4 的 Ext JS 2 不同，面板在首先展开之前不会呈现。这会导致多个问题，因为某些代码路径要求元素已经在 DOM 中。

`deferredRender`对手风琴没有任何影响，它只是用于标签。

我尝试了什么：遍历所有项目并调用`setActiveItem`or`setActive`但这只会导致最后一个面板被实际呈现，所有其他面板仍然不在 DOM 内（我想激活一个元素是异步的，即使`animate`是`false`）。

我怎么能告诉手风琴渲染所有面板，即使它们一开始是折叠的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T11:05:15.227

AFAIK 面板中带有`accordion`布局的所有组件都会立即呈现。示例：http: [//jsfiddle.net/P5Gen/3/](http://jsfiddle.net/P5Gen/3/)

请注意，子组件是`afterrender`在容器上触发事件后呈现的。子元素的实际渲染是通过布局进行的，因此在`afterlayout`事件触发后标记可用。

要强制布局（也强制子级渲染），您可以调用`container.doLayout(false, true)`.

如果您需要`doLayout`使用手风琴布局在每个容器上调用，您可以使用它`ComponentMgr`来执行此操作。例子：

```
Ext.ComponentMgr.all.on('add', function(index, component){
    if (!(component instanceof Ext.Container)) {
        return;
    }
    if (component.layout !== 'accordion' && !(component.layout instanceof Ext.layout.AccordionLayout)) {
        return;
    }

    component.on('afterrender', function(sender) {
        // do layout or something else
        sender.doLayout(false, true);
    });
}); 
```

# sql - SQL - 将计算值（基于子表）存储在列中或在数据模型中计算？

> ID：13863469
> 
> 赞同：0
> 
> 时间：2012-12-13T15:51:35.847
> 
> 标签：sql, entity-framework, database-design, database-optimization

我遇到了一个小难题，我希望 SO 社区可以帮助我解决这个问题。

我目前处于一种情况，我们正在为订单折扣编写自定义逻辑，这些逻辑基于可配置的规则。以下是最简单的表格：

**命令**

```
OrderID int 
```

**订单折扣**

```
OrderID int
DiscountID int 
```

**折扣**

```
DiscountID int 
```

我们正在使用实体框架（但这个问题可能适用于任何数据模型）。我觉得我的选择很简单，但都有各自的缺点：

1.  *在我的 SQL订单*中添加一列“折扣”*表中缺点：每次更新订单时，我们都需要记住重新计算折扣并更新此列。这可能会导致数据不一致，但性能会更好。还将允许覆盖折扣金额。*
**   将“折扣”属性添加到我的*订单*数据模型代码中。缺点：任何时候访问此属性都需要计算，但总是准确的。*

 *我应该走哪条路线，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T16:00:14.167

您忽略了两个关键的会计要求

1.  每个订单的折扣以及如何计算每个折扣的详细信息必须存储在每个相应的订单中；因为一旦订单过帐到 GL，就不得更改。已发布的订单可以取消或撤销，但不能更改。
2.  然而，虽然订单正在构建，但尚未发布到 GL，但规则不同 - 必须实时重新计算折扣，通过不将其存储在记录中最容易执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T15:40:06.333

通常，数据库中的故事计算字段不被认为是最佳实践，除非计算所消耗的时间很长，我选择在构造函数中实现计算，而不是在每次更改折扣值时存储一个新值。查看此链接以获取有关该主题的扩展视图。 [这里](http://database-programmer.blogspot.com/2008/01/database-skills-third-normal-form-and.html)*

# objective-c - 将 NSManagedObjectContext 与后台线程更改合并的问题

> ID：13863470
> 
> 赞同：0
> 
> 时间：2012-12-13T15:51:37.407
> 
> 标签：objective-c, ios, multithreading, core-data, nsmanagedobjectcontext

我有应该从后台更改的数据。有一种方法可以在后台运行并初始化 new `NSManagedObjectContext`，进行更改并调用 save。然后我`NSManagedObjectContextDidSaveNotification`在通知对象中得到了正确的数据。接下来我打电话

```
[mainManagedObjectContext performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:)
                                           withObject:notification 
                                        waitUntilDone:YES]; 
```

但在我`UITableViewController`没有任何改变，我没有进入

```
- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller 
```

或者

```
- (void)controller:(NSFetchedResultsController *)controller 
   didChangeObject:(id)anObject 
       atIndexPath:(NSIndexPath *)indexPath 
     forChangeType:(NSFetchedResultsChangeType)type 
      newIndexPath:(NSIndexPath *)newIndexPath 
```

当我在主线程中对主上下文进行相同的更改时，一切正常。我之前有一些从后台线程合并的成功经验，但这种情况让我发疯，所以我正在寻求帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T18:20:08.583

如果您在合并后保存主上下文，IIRC 获取的结果控制器只会收到更新通知。

# hash - 如何适当地保护登录？

> ID：13863471
> 
> 赞同：1
> 
> 时间：2012-12-13T15:51:37.217
> 
> 标签：hash, login, passwords, security

作为一个更广泛的问题，我想问一下当前保护网站登录的最佳策略是什么。我知道所有的基础知识，比如加盐密码、散列密码以及使用 SSL 加密传输，但我觉得这可能并不总是足够的。那里最好的“防黑客”方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T08:15:19.230

你的点已经是最重要的了，另外你可以这样做：

1.  使用像 BCrypt 这样的**慢速密钥派生函数来散列密码。**
2.  将**X-Frame-Options**添加到登录页面的 HTTP 标头中，这样页面就不会显示在 iframe 中。这有助于防止点击劫持。在 PHP 中，这看起来像这样：`header('X-Frame-Options: DENY');`.
3.  将**Content-Security-Policy**添加到登录页面的 HTTP 标头中。如果浏览器支持 CSP，这可以有效地防止跨站点脚本。在 PHP 中，它看起来像这样：`header("X-Content-Security-Policy: allow 'self'");`.
4.  在登录页面重新生成会话 id，使会话固定更加困难。
5.  整个站点使用HTTPS，这样可以避免很多问题。如果您需要在 HTTPS 和 HTTP 之间切换，则使用单独的 cookie 进行身份验证，请查看此[示例](http://www.martinstoeckli.ch/php/php.html#ssl_nomim_cookie)。
6.  如果您的站点仅是 HTTPS，那么您可以添加**HTTP 严格传输安全**标头。HSTS 可以防止用户（已经访问过您的网站一次）调用不安全的 HTTP 页面。这可以帮助对抗 SSL-strip。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:57:23.867

根本不存储密码，而是使用 SRP

[http://en.wikipedia.org/wiki/Secure_Remote_Password_protocol](http://en.wikipedia.org/wiki/Secure_Remote_Password_protocol)

# actionscript - Flashbuilder 4.6 PopupManager.removePopUp

> ID：13863472
> 
> 赞同：2
> 
> 时间：2012-12-13T15:51:39.797
> 
> 标签：actionscript, flash-builder

使用 modal 选项时，PopupManager.removePopUp 将模糊层留在屏幕上。我尝试了任何方法，但找不到解决此问题的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:42:17.997

I was having the same problem.

For me, what worked was to call the PopUpManager.removePopUp() method **after** finishing calling all the commands in the close handler callback function.

Previously, I called the PopUpManager.removePopUp(this) method within the custom window that I had previously added to the PopUpManager, but in the following line, I was calling another method (that wasn't even in the same customWindow class, but in another one). So I removed the PopUpManager.removePopUp(this) line from the customWindow, and put it at the very end of the last method in the other class.

This eliminated the problem

# css - 具有固定水平条和滚动内容的 2 列固定流体布局

> ID：13863475
> 
> 赞同：1
> 
> 时间：2012-12-13T15:51:48.327
> 
> 标签：css, fixed, vertical-scrolling, liquid-layout

浏览此站点和其他站点，我还没有找到针对此特定问题的解决方案。在查看以下示例（也放在下面）之后，可以最好地描述我想要实现的目标：http: [//jsfiddle.net/yev8/HRQB5/](http://jsfiddle.net/yev8/HRQB5/)

当前情况：在这个例子中，我有一个左列（固定宽度）和一个右列（液体宽度）。在右栏中有四个条。与顶部对齐的两个条在每一页上都是相同的。与底部对齐的两个条在每一页上都是不同的，两者的每种组合都是可能的。现在在中间我有一个 div，“内容”，它填满了可用空间，如果需要，还有一个垂直滚动条。

我想要实现的目标：我希望将 div 的滚动条替换为垂直覆盖整个页面的滚动条，就像默认滚动条一样。滚动时，左侧菜单和所有栏不应该改变它们的位置。唯一滚动应该是中间的内容 div。

我不知道这是否可能，但在理想情况下，我只想用 css 解决这个问题。如果这是不可能的，javascript（有或没有 jQuery）都可以工作。

谁能给我任何建议或指出正确的方向？我似乎无法让它按我想要的方式工作。

我当前的html：

```
<!doctype html>
<html lang="nl">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <title></title>
        <link href="css/stylesheet.css" rel="stylesheet" media="screen">
    </head>
    <body>
        <div id="wrapper">
            <div id="left">
                <ul>
                    <li><a href="#" title="">Menu item</a></li>
                    <li><a href="#" title="">Menu item</a></li>
                    <li><a href="#" title="">Menu item</a></li>
                </ul>
            </div>
            <div id="right">
                <div id="bar-1">bar-1</div>
                <div id="bar-2">bar-2</div>
                <div id="content">
                    <div style="height:400px;background-color:#ff0;"></div>
                    <div style="height:400px;background-color:#f0f;"></div>
                    <div style="height:400px;background-color:#0f0;"></div>
                    <div style="height:400px;background-color:#00f;"></div>
                </div>
                <div id="bar-3">bar-3</div>
                <div id="bar-4">bar-4</div>
            </div>
        </div>
    </body>
</html> 
```

我当前的CSS：

```
html, body {
    height: 100%;
    background-color: #fff;
    color: #2f2f2f;
    overflow: hidden;
    padding: 0;
    margin: 0;
    border: 0;
    outline: 0;
}

div#wrapper {
    height: 100%;
    margin: auto;
    position: relative;
}

div#left {
    height: 100%;
    float: left;
    width: 256px;
    overflow-y: auto;
    background-color: #fcfcfc;
}

div#right {
    height: 100%;
    position: relative;
    margin-left: 256px;
}

    div#right div#bar-1 {
        overflow: hidden;
        position: absolute;
        left: 0;
        right: 0;
        height: 64px;
        top: 0;
        background-color: #eaeaea;
    }

    div#right div#bar-2 {
        overflow: hidden;
        position: absolute;
        left: 0;
        right: 0;
        top: 64px;
        height: 32px;
        background-color: #979797;
    }

    div#right div#content {
        position: absolute;
        left: 0;
        right: 0;
        top: 96px;
        bottom: 224px;
        overflow-y: scroll;
    }

    div#right div#bar-3 {
        overflow: hidden;
        position: absolute;
        left: 0;
        right: 0;
        bottom: 128px;
        height: 96px;
        background-color: #eaeaea;
    }

    div#right div#bar-4 {
        overflow: hidden;
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        height: 128px;
        background-color: #d5d5d5;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:05:53.833

你的意思是这样的：http: [//jsfiddle.net/Y2spp/2/](http://jsfiddle.net/Y2spp/2/)

我根据其他条在内容顶部和底部添加了填充。确保内容的高度为 100%，并且条形图位于内容的顶部。

只有 CSS 更改：

```
div#right div#bar-1 {
    overflow: hidden;
    position: absolute;
    left: 0;
    right: 17px;
    height: 64px;
    z-index:4;
    top: 0;
    background-color: #eaeaea;
}

div#right div#bar-2 {
    overflow: hidden;
    position: absolute;
    left: 0;
    right: 17px;
    top: 64px;
    z-index:4;
    height: 32px;
    background-color: #979797;
}

div#right div#content {
    position: absolute;
    left: 0;
    right: 0;
    top: 0px;
    bottom: 0px;
    padding-top:96px;
    padding-bottom:224px;
    overflow-y: scroll;
    z-index:2;
}

div#right div#bar-3 {
    overflow: hidden;
    position: absolute;
    left: 0;
    right: 17px;
z-index:4;
    bottom: 128px;
    height: 96px;
    background-color: #eaeaea;
}

div#right div#bar-4 {
    overflow: hidden;
    position: absolute;
    left: 0;
    right: 17px;
    z-index:4;
    bottom: 0;
    height: 128px;
    background-color: #d5d5d5;
}​ 
```

# facebook - 删除 Facebook 喜欢

> ID：13863477
> 
> 赞同：0
> 
> 时间：2012-12-13T15:51:59.863
> 
> 标签：facebook

我有一个允许用户上传内容的页面。然后，他们可以共享指向该页面的链接，用户可以在其中“喜欢它”。我们使用 og 元标记来创建一个“链接”，例如可以预览输入的文本。

如果内容被认为具有冒犯性或违反我们的服务条款，我正在努力从我们的网站上删除该内容。

我猜答案是否定的，但是有没有一种已知的方法可以从 facebook 中删除该内容？或者，至少告诉 facebook 更新“like”链接文本的内容，以显示我们新的“此内容违反了我们的 TOS？”

我意识到我不能改变别人的墙，但我只是想知道是否还有什么我可以主动解决这样的问题。

我们是否应该直接联系 facebook 并让他们知道内容已被删除？

抱歉，如果此信息已在其他地方覆盖，我们对整个“facebook”集成内容是陌生的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:10:01.200

无法追溯更改用户喜欢的内容

```
Should we contact facebook directly and let them know the content was removed? 
```

不可行。最好的选择是在内容向公众开放之前积极主动地处理内容。

# asp.net-mvc-3 - DotNetOpenAuth.Asp 无法在 MVC4 应用程序单元测试中加载程序集或其依赖项之一

> ID：13863478
> 
> 赞同：11
> 
> 时间：2012-12-13T15:52:00.750
> 
> 标签：asp.net-mvc-3, visual-studio-2010, asp.net-mvc-4, visual-studio-2012, dotnetopenauth

我的项目中遇到了非常奇怪的错误。我安装了 DotnetOpenAuth.Aspnet 和 Microsoft.AspNet.WebPages.OAuth 库 nuget 包。当我运行项目时没有问题。但是当我为控制器编写测试时，它会抛出如下异常。

测试方法 MvcApplication2.Tests.ControllerTest.should_return_not_empty_content 抛出异常：

```
 System.IO.FileLoadException: Could not load file or assembly 'DotNetOpenAuth.AspNet, Version=4.0.0.0, Culture=neutral, PublicKeyToken=2780ccd10d57b246' 
or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

另一个奇怪的点是如果我在 VS 2010 中设置一个项目作为 MVC3 应用程序并且测试正在通过。没有失败。但是当我在 VS2012 中进行完全相同的设置时，它会触发与上述相同的错误。当我在 stackoverflow 上搜索时，我看到了这个[解决方案](https://stackoverflow.com/questions/13374277/how-do-i-pull-dotnetopenauth-assembly-references-into-unit-test-project-for-asp/13860815#13860815) ，但它也没有工作。

您可以在以下几行中找到所有项目和示例测试。它只是一个应用程序一个测试项目。非常容易阅读。

我还在这里添加了一个示例代码，用于控制器和失败的测试。

代码预览的 pastebin 链接是[http://pastebin.com/1PCpq3hW](http://pastebin.com/1PCpq3hW)

任何帮助，将不胜感激。

Vs2010 和 2012 失败和成功的[项目](https://dl.dropbox.com/u/51234464/New%20folder.rar)

详细的日志结果如下

```
    *** 装配活页夹日志条目 (13.12.2012 @ 22:27:31) ***

    操作失败。
    绑定结果：hr = 0x80131040。没有可用的描述。

    从以下位置加载的程序集管理器：C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll
    在可执行文件 C:\Program Files (x86)\JetBrains\ReSharper\v7.0\Bin\JetBrains.ReSharper.TaskRunner.CLR4.exe 下运行
    --- 详细的错误日志如下。

    === 绑定状态信息 ===
    日志：用户 = DEVELOPER-PC\DEVELOPER
    日志：DisplayName = DotNetOpenAuth.AspNet，版本 = 4.0.0.0，文化 = 中性，PublicKeyToken = 2780ccd10d57b246
     （完全指定）
    日志：Appbase = file:///D:/Development/Coachius/CoachiusWeb.Tests/bin/Debug
    日志：初始 PrivatePath = NULL
    日志：动态基础 = NULL
    日志：缓存基础 = NULL
    日志：AppName = NULL
    调用程序集：CoachiusWeb，Version=1.0.0.0，Culture=neutral，PublicKeyToken=null。
    ===
    LOG：此绑定在默认加载上下文中开始。
    LOG：使用应用程序配置文件：D:\Development\Coachius\CoachiusWeb.Tests\bin\Debug\CoachiusWeb.Tests.dll.config
    LOG：使用主机配置文件：
    LOG：使用 C:\Windows\Microsoft.NET\Framework\v4.0.30319\config\machine.config 中的机器配置文件。
    日志：政策后参考：DotNetOpenAuth.AspNet，版本=4.0.0.0，文化=中性，PublicKeyToken=2780ccd10d57b246
    日志：GAC 查找不成功。
    日志：正在尝试下载新的 URL 文件：///D:/Development/Coachius/CoachiusWeb.Tests/bin/Debug/DotNetOpenAuth.AspNet.DLL。
    LOG：程序集下载成功。尝试设置文件：D:\Development\Coachius\CoachiusWeb.Tests\bin\Debug\DotNetOpenAuth.AspNet.dll
    LOG：进入从源代码运行设置阶段。
    日志：程序集名称为：DotNetOpenAuth.AspNet，版本=4.1.0.0，文化=中性，PublicKeyToken=2780ccd10d57b246
    警告：比较程序集名称导致不匹配：次要版本
    ERR：程序集引用与找到的程序集定义不匹配。
    ERR：从源代码运行设置阶段失败，hr = 0x80131040。
    ERR：无法完成程序集的设置（hr = 0x80131040）。探测终止。

```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-09-24T07:19:36.420

我已经解决了

```
 <configuration>
      <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
          <dependentAssembly>
            <assemblyIdentity name="DotNetOpenAuth.AspNet" publicKeyToken="2780ccd10d57b246" culture="neutral" />
            <bindingRedirect oldVersion="0.0.0.0-4.3.0.0" newVersion="4.3.0.0" />
          </dependentAssembly>
          <dependentAssembly>
            <assemblyIdentity name="DotNetOpenAuth.Core" publicKeyToken="2780ccd10d57b246" culture="neutral" />
            <bindingRedirect oldVersion="0.0.0.0-4.3.0.0" newVersion="4.3.0.0" />
          </dependentAssembly>
          <dependentAssembly>
            <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" culture="neutral" />
            <bindingRedirect oldVersion="0.0.0.0-1.5.2.14234" newVersion="1.5.2.14234" />
          </dependentAssembly>
        </assemblyBinding>
      </runtime>
    </configuration> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-08T14:14:13.613

我想我可能已经找到了一个可能的解决方案。

看到这个[链接](http://www.swiftsoftwaregroup.com/aps-net-mvc-4-could-not-load-file-or-assembly-dotnetopenauth-core-version-4-0-0-0/)

这里的关键信息在第 3 行和第 7 行。基本上，Microsoft.Web.WebPages.OAuth 需要 DotNetOpenAuth.Core 4.0.0.0，但我拥有的 DotNetOpenAuth.Core 是 4.3.0.0 版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T07:37:17.923

这是由于 VS 2012 中的一个非常讨厌的错误。在测试项目中的 VS 2012 中，app.config 文件中的程序集重定向不起作用。

这解释了为什么它在 VS 2010 中有效，而在 VS 2012 中无效。

这很烦人。

一种解决方法是添加一个 .testsettings 文件并将其从测试菜单关联到项目。您必须为此转到解决方案文件夹，否则您将不会在菜单中看到它。

当心，互联网上的很多资源都说强制旧版本工作的运行设置可以解决问题，但不会。它会使您的 VS / 测试过程崩溃。您需要一个 testsettings 文件。

你正在做的是使用没有这个错误的VS2010 runner。另一方面，它更慢。

我希望微软能尽快解决这个问题，问题不仅在于 OpenAuth，而且实际上每个 DLL 都使用与另一个 DLL 不同的版本。

欢迎来到 DLL Hell 版本 2012 年。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:00:09.290

在您的 web.config 文件中查找 bindingRedirects 并确保它们也存在于您的单元测试的 app.config 文件中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T19:09:13.797

您是否将程序集添加到您的测试项目？编译时它们应该显示在文件夹中。由于您的测试项目是主机，因此它需要相同的程序集进行测试（取决于设置，但作为一般规则）

如果是这样，那么您可以进一步了解实际的绑定细节。

请参阅我在此处发布的有关启用融合日志记录的帖子。 [如何在 .NET 中启用程序集绑定失败日志记录 (Fusion)](https://stackoverflow.com/questions/255669/how-to-enable-assembly-bind-failure-logging-fusion-in-net)

启用它，检查文件夹并查找绑定失败 - 你会看到哪个程序集试图加载它（通常）。如果您不这样做 - 启用成功和失败，然后查看所有程序集版本。有时您会看到加载的多个版本有助于追踪问题，或者是意外版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-17T14:43:07.503

我将版本更改为 4.1.0.0，它对我有用

```
 <dependentAssembly>
    <assemblyIdentity name="DotNetOpenAuth.Core" publicKeyToken="2780CCD10D57B246" culture="neutral" />
    <bindingRedirect oldVersion="1.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
  </dependentAssembly>
  <dependentAssembly>
    <assemblyIdentity name="DotNetOpenAuth.AspNet" publicKeyToken="2780CCD10D57B246" culture="neutral" />
    <bindingRedirect oldVersion="1.0.0.0-4.1.0.0" newVersion="4.1.0.0" />
  </dependentAssembly> 
```

# c# - C#如何选择字符串中的某个部分

> ID：13863482
> 
> 赞同：0
> 
> 时间：2012-12-13T15:52:11.407
> 
> 标签：c#, string, methods

我在蒙面的 TextBox 中有一个字符串，如下所示：

```
123.456.789.abc.def.ghi

"---.---.---.---.---.---"  (masked TextBox format when empty, cannot use underscore X(  ) 
```

请忽略字符的值（它们可以重复，并且不像上面那样唯一）。我怎样才能挑选出部分字符串，比如“789”？`String.Remove()`不起作用，因为它会删除索引之后的所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:55:06.230

你的意思是你想获得那部分字符串？如果是这样，你可以使用`string.Split`

```
string s = "123.456.789.abc.def.ghi";
var splitString = s.Split('.');
// splitString[2] will return "789" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:55:22.703

您可以简单地使用`String.Split`（如果字符串实际上是您所显示的）

```
string str = "123.456.789.abc.def.ghi";
string[] parts = str.Split('.');
string third = parts.ElementAtOrDefault(2); // zero based index
if(third != null)
    Console.Write(third); 
```

我刚刚使用[`Enumerable.ElementAtOrDefault`](http://msdn.microsoft.com/en-us/library/bb494386.aspx)它是因为如果集合中没有这样的索引（它回退到`parts[2]`），它会返回 null 而不是异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T15:55:43.683

如果始终包含在您的字符串中，您可以使用`Split`它来分隔您的值。`.`

```
string input = "123.456.789.abc.def";

string[] mySplitString = input.Split('.');

for (int i = 0; i < mySplitString.Length; i++)
{
    // Do you search part here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T15:54:43.607

尝试使用`Replace`.

```
String.Replace("789", "") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T15:56:56.470

查找字符串：

```
string str="123.456.789.abc.def.ghi";
int i = str.IndexOf("789");
string subStr = str.Substring(i,3); 
```

替换子字符串：

```
 str = str.Replace("789","").Replace("..","."); 
```

正则表达式：

```
 str = Regex.Replace(str,"789",""); 
```

正则表达式可以给你很大的灵活性，用最少的代码找到东西，缺点是可能很难写

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T15:59:20.927

如果您知道子字符串开始位置的索引及其长度，则可以使用[String.Substring()](http://msdn.microsoft.com/en-us/library/aka44szs.aspx)。这将为您提供子字符串：

```
String myString = "123.456.789";
// looking for "789", which starts at index 8 and is length 3
String smallString = myString.Substring(8, 3); 
```

如果您尝试删除字符串的特定部分，请使用[String.Replace()](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)：

```
String myString = "123.456.789";
String smallString = myString.Replace("789", ""); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-13T15:59:51.343

var newstr = new String(str.where(c => "789")).tostring();..我想这会起作用，或者你可以像这样使用 sumthng

# ios - iOS 5.1：处理关闭模式对话框

> ID：13863485
> 
> 赞同：0
> 
> 时间：2012-12-13T15:52:35.130
> 
> 标签：ios, ios5.1

我有一个`UIViewController`A 打开一个模态弹出对话框 B 通过`performSegueWithIdentifier`.

当模态窗口 B 关闭（或按下按钮）时，我想在第一个视图控制器 A 上调用一个函数。

我可以使用哪个自定义点来处理模态窗口 B 的关闭？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:40:36.873

就我个人而言，我经常将 NSNotifications 用于此类事情。

[http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/)

# javascript - 从数组中淡化背景图像

> ID：13863486
> 
> 赞同：0
> 
> 时间：2012-12-13T15:52:35.227
> 
> 标签：javascript, jquery, arrays, image, fade

```
$('.pictures a').click(function () {
    var path = "place/of/images";
    var pics = ['pic1.JPG',
                'pic2.JPG',
                'pic3.JPG',
                'pic4.JPG'];
    var i = 0;
    var numberOfPics = pics.length - 1;
    var vaheta = setInterval(function () {
        $('body').css({ backgroundImage: 'url(' + path + pics[i] + ')' });
        if (i == numberOfPics) {
            i = 0;
        } else {
            i++;
        }
    }, 3000);
    return false;
}); 
```

这是目前正在为我更改背景图像的代码。现在我在这里找到了一个主题，它说你必须加载图片等，并且有这个小提琴，[http://jsfiddle.net/RnqQL/1/](http://jsfiddle.net/RnqQL/1/)，这正是我想要做的，但我不太清楚如何将这两者结合起来（我的代码和小提琴）。

这些图像实际上稍后会从服务器加载 JSON，具体取决于人们单击以获取此幻灯片的链接的 ID，这对我来说太压倒了......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:17:32.700

[我在http://jsfiddle.net/xMrp3/1/](http://jsfiddle.net/xMrp3/1/)创建了小提琴

您可以修改和使用。我试图解释我对评论所做的事情。

```
$('.pictures a').click(function () {
    var path = "http://elegantthemes.com/preview/InStyle/wp-content/uploads/2008/11/";

    $("#wrap").empty(); // clear wrap div content
    $.getJSON('/echo/json/', function (pics) { // get json data
        var pics = ['s-1.jpg', 's-5.jpg', 's-3.jpg']; // i override json response for demo

        $.each(pics, function(i, pic) { // loop through pics array
            $('<img/>').attr('src', path + pic).appendTo($("#wrap")); // append all images to #wrap div
        });

        if (animTimeout == null) // if we didnt started anim yet
            anim(); // start animation
    });
    return false;
});

var animTimeout = null;
function anim() {
    $("#wrap img").first().appendTo('#wrap').fadeOut(500);
    $("#wrap img").first().fadeIn(500);    
    animTimeout = setTimeout(anim, 700);
} 
```

​</p>

# c++ - C++比较表达式错误

> ID：13863487
> 
> 赞同：1
> 
> 时间：2012-12-13T15:52:39.377
> 
> 标签：c++

这段代码有问题，但我找不到导致它的原因。

```
bool Parser::validateName(std::string name) {
    int pos = name.find(INVALID_CHARS);               //pos is -1, 
    bool result = ((name.find(INVALID_CHARS)) < 0);   //result is false
    //That was weird, does that imply that -1 >= 0?, let's see
    result = (pos < 0)                                //result is true
    result = ((name.find(INVALID_CHARS)) == -1)       //result is true
    result = (-1 < 0)                                 //result is true
    ...
} 
```

为什么第二行的结果为假。有什么我没看到的吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T15:54:27.087

`std::string::find`返回`std::string::npos`其类型`std::string::size_type`被定义为实现定义的无符号整数。无符号整数永远不会小于`0`。

您应该始终比较`std::string::npos`以检查是否`std::string::find`找到了某些东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:04:11.947

`std::string::find``std::string::npos`当它没有找到请求的项目时返回。根据标准（§ 21.4/5）：

```
static const size_type npos = -1; 
```

但`string::size_type`通常情况下是这样`unsigned int`；这意味着将`-1`转换为其无符号等效项。通常为 0xFFFF，这是`unsigned int`.

在你的第二行：

```
bool result = ((name.find(INVALID_CHARS)) < 0); 
```

您正在比较两个`unsigned int`值（0xFFFF 和 0），因此返回`false`. 另一方面，在你的第四行：

```
result = ((name.find(INVALID_CHARS)) == -1) 
```

你有一个`unsigned int`和一个`int`，所以促销规则适用并且`unsigned int`转换成一个`int`; 正如我们之前看到的，有符号的等值`npos`总是-1，所以返回`true`。

# android-emulator - Android 4.1.2 不幸已停止

> ID：13863490
> 
> 赞同：0
> 
> 时间：2012-12-13T15:52:41.493
> 
> 标签：android-emulator

我想从互联网上下载并解析一个 XML 代码，我对 2.3.3 版本没有任何问题。一切运行完美！

但是当我启动版本 4.1.2 (AVD) 时，出现以下错误：

不幸的是，myProject 已停止。

在这一行：

```
HttpResponse httpResponse = httpClient.execute(httpPost) 
```

4.1.2版本有什么问题？我在网上搜索了几个小时，但仍然没有结果。

# jquery - 在父页面上显示/隐藏子元素

> ID：13863494
> 
> 赞同：0
> 
> 时间：2012-12-13T15:52:53.277
> 
> 标签：jquery, css, wordpress

我正在使用 Wordpress 和该`wp_nav_menu`功能。我在 Wordpress 后端构建了一个示例菜单，如下所示：

*   菜单项 1
*   菜单项 2
    *   子菜单项
*   菜单项 3

我希望子菜单仅在父母或父母的孩子的页面上显示。

我不确定该怎么做。我认为 CSS/jquery 会做，但我会采取任何解决方案。

[这是我目前正在处理的页面](http://squash-market.com/domain/)。

* * *

编辑：很抱歉造成混淆 - 我不想要翻转菜单，我希望它是静态的。当我在父页面上时，我希望显示子菜单（子菜单）。当我不在父页面上时，我不希望显示子链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T15:56:41.197

尝试这个：

```
$(function(){
   $('.sub-menu').hide();
   $('.menu-item').click(function(){
       $('.sub-menu').hide();
       $(this).find('.sub-menu').show();
   });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T15:59:34.577

在javascript中试试这个：

```
$(function(){
    $("#menu-main a[href='" + window.location.pathname + "']").next().addClass('opened');
}); 
```

在 CSS 中：

```
ul.opened {
    display:block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:05:45.610

这可以通过仅使用 CSS 来实现，如果可能，CSS 比使用 Javascript 更可取。

HTML：

```
<ul class="top">
    <li>first</li>
    <li>second
      <ul class="sub">
         <li>sub-first</li>
         <li>sub-second</li>
      </ul>
    </li>
    <li>third</li>
 </ul> 
```

CSS：

```
ul ul.sub {
  display: none;
}

ul.top > li:hover > ul {
  color:red;
  display:block;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:24:45.660

干得好。保持简单（和）愚蠢。这完全符合您的要求 - 隐藏子菜单，除非在父页面上。

```
$(function(){
   $('.sub-menu').hide(); //Hide sub menu by default
   $('.current-menu-item').children('.sub-menu')​.show();​ //Show sub menu if parent selected
}); 
```

# php - 在 Yii 中使用 CArrayDataProvider 过滤 CGridView：如何？

> ID：13863498
> 
> 赞同：5
> 
> 时间：2012-12-13T15:53:08.207
> 
> 标签：php, yii

我在 Yii 中创建了一个 CGridView，它的行是从 XML 文件中读取的。我没有使用任何模型：只有一个控制器（我在其中读取文件）和一个视图（我在其中显示网格）。我无法在网格的第一行创建一个过滤器（每列一个输入字段），以便仅可视化某些行。我该怎么做？

这是我到目前为止所拥有的：

**控制器：**

```
<?php
class TestingController extends Controller {
    public function actionIndex() {
        $pathToTmpFiles = 'public/tmp';
        $xmlResultsFile = simplexml_load_file($pathToTmpFiles.'/test.xml');
        $resultData = array();
            foreach ($xmlResultsFile->result as $entry) {
                $chromosome = $entry->chromosome;
                $start = $entry->start;
                $end = $entry->end;
                $strand = $entry->strand;
                $crosslinkScore = $entry->crosslinkScore;
                $rank = $entry->rank;
                $classification = $entry->classification;
                $mutation = $entry->mutation;
                $copies = $entry->copies;
                array_push($resultData, array('Chromosome'=>$chromosome, \
                    'Start'=>$start,  'End'=>$end, Strand'=>$strand, \
                    'Crosslink_Score'=>$crosslinkScore,'Rank'=>$rank, \
                    'Classification'=>$classification, 'Mutation'=>$mutation, \
                    'Copies'=>$copies));
        }
        $this->render('index', array('resultData' => $resultData));
    }
}
?> 
```

**看法：**

```
<?php
$dataProvider = new CArrayDataProvider($resultData, \
    array('pagination'=>array('pageSize'=>10,),));

$this->widget('zii.widgets.grid.CGridView', array( 'id' => 'mutationResultsGrid',
    'dataProvider' => $dataProvider, 'columns' => array(
        array(
           'name' => 'Chromosome',
           'type' => 'raw',
       ),
       array(
           'name' => 'Start',
           'type' => 'raw',
       ),
       array(
           'name' => 'End',
           'type' => 'raw',
       ),
       array(
           'name' => 'Strand',
           'type' => 'raw',
       ),
       array(
           'name' => 'Crosslink_Score',
           'type' => 'raw',
       ),
       array(
           'name' => 'Rank',
           'type' => 'raw',
       ),
       array(
           'name' => 'Classification',
           'type' => 'raw',
       ),
       array(
           'name' => 'Mutation',
           'type' => 'raw',
       ),
       array(
           'name' => 'Copies',
           'type' => 'raw',
       ),
    ),
));
?> 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T17:06:58.783

文件：（`FiltersForm.php`我把它放在组件文件夹中）

```
/**
 * Filterform to use filters in combination with CArrayDataProvider and CGridView
 */
class FiltersForm extends CFormModel
{
    public $filters = array();

    /**
     * Override magic getter for filters
     */
    public function __get($name)
    {
        if(!array_key_exists($name, $this->filters))
            $this->filters[$name] = null;
        return $this->filters[$name];
    }

    /**
     * Filter input array by key value pairs
     * @param array $data rawData
     * @return array filtered data array
     */
    public function filter(array $data)
    {
        foreach($data AS $rowIndex => $row) {
            foreach($this->filters AS $key => $value) {
                // unset if filter is set, but doesn't match
                if(array_key_exists($key, $row) AND !empty($value)) {
                    if(stripos($row[$key], $value) === false)
                        unset($data[$rowIndex]);
                }
            }
        }
        return $data;
    }
} 
```

在您的**控制器**中：

```
...
$filtersForm = new FiltersForm;
if (isset($_GET['FiltersForm'])) {
    $filtersForm->filters = $_GET['FiltersForm'];
}
$resultData = $filtersForm->filter($resultData);

$this->render('index', array(
    'resultData' => $resultData,
    'filtersForm' => $filtersForm
)}//end action 
```

最后需要什么 - 将过滤器添加到`CGridView`配置数组：

```
...
'dataProvider' => $dataProvider,
'enableSorting' => true,
'filter' => $filtersForm,
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T09:06:06.540

为什么不将 xml 中的信息存储到数据库并使用 YII ActiveRecord？

在您的情况下，您需要一种实时机制来过滤每个过滤器查询的结果集。与 search() 方法一样，当您使用 YII ActiveRecord 模型时。

因此，您可以在每次过滤器调用时在数组上使用类似 array_filter() 的回调。（编辑：或者这里使用的机制与 stripos 返回匹配的“行”：[Yii Wiki](http://www.yiiframework.com/wiki/232/using-filters-with-cgridview-and-carraydataprovider/)）

或者，第二种选择，您可以使 xml 解析器依赖于您的过滤器输入，这对我来说感觉不好:)。解析器将不得不解析每个过滤器输入，这可能是大 xml 文件的问题。

或者，如前所述，将信息保存到数据库并使用标准 YII 机制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:23:15.140

假设您可以使用在 foreach 循环中的对象中获得的数据作为该特定列的过滤器，那么您可以将这些值传递给视图，例如：

```
<?php
class TestingController extends Controller {
    public function actionIndex() {
        $pathToTmpFiles = 'public/tmp';
        $xmlResultsFile = simplexml_load_file($pathToTmpFiles.'/test.xml');
        $resultData = array();
        foreach ($xmlResultsFile->result as $entry) {
            ...
            $chromosomeFilter[] = $entry->chromosome;
            ...
        }
        $this->render('index', array(
            'resultData'       => $resultData,
            'chromosomeFilter' => $chromosomeFilter,
            ...
        );
    }
}
?> 
```

然后在该列的过滤器中使用该值；

```
...
array(
    'name'   => 'Chromosome',
    'type'   => 'raw',
    'filter' => $chromosomeFilter,
),
... 
```

我没有测试过，它很大程度上取决于你的 xml 和 的结构`$entry->chromosome`，但这可能有助于你走上正确的道路吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-08T09:28:52.797

我遇到了同样的问题，我所做的是实现[http://www.datatables.net/](http://www.datatables.net/) 并远程提取数据。我将排序和分页传递给 javascript 。

# android - 未配置 Google 日历 API 访问权限

> ID：13863500
> 
> 赞同：3
> 
> 时间：2012-12-13T15:53:11.577
> 
> 标签：android, api, calendar

我从这里下载了一个示例项目： [http ://code.google.com/p/google-api-java-client/source/browse/calendar-android-sample/?repo=samples](http://code.google.com/p/google-api-java-client/source/browse/calendar-android-sample/?repo=samples)

除了使用 Eclipse 的 Keytool 插件检索 SHA1 密钥之外，我执行了所描述的所有步骤。但是，当我在手机上运行该应用程序时，它会显示访问未配置错误消息以下来自 LogCat：

```
com.google.api.client.googleapis.json.GoogleJsonResponseException: 403 Forbidden
{
 "code": 403,
   "errors": [
     {
       "domain": "usageLimits",
       "message": "Access Not Configured",
       "reason": "accessNotConfigured"
     }
  ],
   "message": "Access Not Configured"
 } 
```

我在 google 控制台中创建了一个项目，启用了日历 API，创建了 OAuth2 客户端 ID，使用了 Eclipse 中的 SHA1 密钥并且没有看到任何错误消息。不过，我在控制台中看不到客户端密码。你知道缺少什么吗？

如果您想知道，这些是来自 Android Manifest 的权限。

```
enter code here

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.GET_ACCOUNTS" />
<uses-permission android:name="android.permission.USE_CREDENTIALS" />
<uses-permission android:name="android.permission.MANAGE_ACCOUNTS" /> 
```

我是使用日历 API 的新手，希望在创建自己的应用程序之前看到这个应用程序的工作。另外，我怀疑这也可能成为未来的一个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:39:23.963

访问配置需要使用客户端 API 执行。请参阅左栏中的链接。

由于在请求用户授权时必须指定范围，因此这项工作似乎是多余的。但还是必要的。 [http://www.tqis.com/eloquency/googlecalendar.htm](http://www.tqis.com/eloquency/googlecalendar.htm)

# 2d - 渲染一个不可见的遮挡物

> ID：13863501
> 
> 赞同：1
> 
> 时间：2012-12-13T15:53:12.153
> 
> 标签：2d, directx-10

我目前正在从 DirectDraw 系统（是的，我知道，它很旧）升级到 DirectX10。这是一个 2D 系统，但模拟现实世界，因为每个对象都有一个以米为单位的范围/深度。有一个背景图像被渲染并保持在最远的 z 顺序上。所有其他对象都绘制在它上面，并根据它们的范围/深度进行缩放。但是，我拥有某种类型的对象，它被定义为多边形并呈现出一些不同。它充当隐形的遮挡物。例如，遮挡物的范围/深度为 40（我的单位是米），并由视口中间的 5 个顶点（一个五边形）定义。在同一视口位置有一个精灵对象，但范围/深度为 50。所需的输出是不渲染精灵对象，但应该通过他们两个看到背景。所以本质上这些是不可见的遮挡物，除了它们不遮挡背景。

需要注意的是，遮挡物和精灵都派生自相同的基础对象类型，并在深度排序的容器中混合在一起。

我的想法是重写 occluders Render 方法，以便它们绘制到写入范围/深度值的渲染目标。然后我会正常渲染精灵，但在顶点或像素着色器中会将精灵的范围值与渲染目标中的范围值进行比较。但是，在我看来，在调用 Present 之前，我可能必须在同一通道中从渲染目标读取/写入，这是未定义的。如果我要渲染遮挡物，取消绑定渲染目标并将纹理传入以供其他对象查找，我将不得不将精灵位置转换为可能不重要的纹理空间。这些方法中的任何一种都可能吗？

又想了想，又想到了另外一个想法。我可以使用遮挡物并参考背景纹理设置它们的纹理坐标。通过这种方式，他们将绘制与背景相同的颜色值，并且由于在精灵后面的排序，用户仍然会看到“背景”，但实际上它是看起来像它的遮挡物。

抱歉，如果这不是一个问题，而是更多地大声思考，但我想就解决此问题的最佳方式获得印象和想法。在我看来，我有选择，但不确定哪个最有效，哪个最简单。提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T18:17:08.053

正如我在评论中所述，我参考背景图像设置纹理坐标，然后确保对简单多边形的遮挡物进行三角测量以使用这些纹理坐标。

# gcc - Mac OS X 10.8 的 Mercury 编译错误

> ID：13863505
> 
> 赞同：1
> 
> 时间：2012-12-13T15:53:32.700
> 
> 标签：gcc, mercury

我在 Mac 上编译 Mercury 时遇到问题。我正在运行 Mac OS X 10.8，安装了 Xcode 4.5 以及命令行工具。

到目前为止我做了什么：

我下载了 tar.gz 文件，将其解压缩，`./configure`在该文件夹中运行，然后使用`make PARALLEL=-j2 install`命令（如其后所述`./configure`）。

在该步骤中，我在命令行中得到以下信息：

```
MMAKE_DIR=`pwd`/scripts scripts/mmake  MMAKEFLAGS=-j2 DESTDIR= install
cd scripts && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2
make[2]: Nothing to be done for `default_target'.
cd util && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2 mfiltercc
make[2]: `mfiltercc' is up to date.
gc_grade=`scripts/ml --grade none.gc --print-gc-grade`; \
    cd boehm_gc && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2 GC_GRADE=$gc_grade
MAKEFLAGS=""; export MAKEFLAGS; \
    PATH=../util:$PATH make -j2 -j1 \
        GRADE=none.gc GC_GRADE=gc \
        AR=ar RANLIB=ranlib \
        libgc.a libgc.dylib \
        FINAL_INSTALL_MERC_GC_LIB_DIR=/usr/local/mercury-11.07.2/lib/mercury/lib \
        dylib
make[3]: `libgc.a' is up to date.
make[3]: `libgc.dylib' is up to date.
make[3]: Nothing to be done for `dylib'.
cd runtime && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2
make[2]: Nothing to be done for `default_target'.
cd util && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2
make[2]: Nothing to be done for `default_target'.
cd robdd && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2
make[2]: Nothing to be done for `default_target'.
cd library && PATH=../scripts:../util:$PATH MMAKE_VPATH=. MMAKE_DIR=../scripts DESTDIR= ../scripts/mmake -j2
../scripts/mgnuc --grade none.gc        --       -c tree234.c -o tree234.o
../scripts/mgnuc --grade none.gc        --       -c array.c -o array.o
tree234.c:619: error: initializer element is not constant
tree234.c:619: error: (near initialization for ‘mercury_common_1[0].f2’)
tree234.c:623: error: initializer element is not constant
tree234.c:623: error: (near initialization for ‘mercury_common_1[1].f2’)
tree234.c:631: error: initializer element is not constant
tree234.c:631: error: (near initialization for ‘mercury_common_1[3].f2’)
tree234.c:640: error: initializer element is not constant
tree234.c:640: error: (near initialization for ‘mercury_common_2[0].f1[1]’)
tree234.c:646: error: initializer element is not constant
tree234.c:646: error: (near initialization for ‘mercury_common_2[1].f1[1]’)
tree234.c:652: error: initializer element is not constant
tree234.c:652: error: (near initialization for ‘mercury_common_2[2].f1[1]’)
tree234.c:658: error: initializer element is not constant
tree234.c:658: error: (near initialization for ‘mercury_common_2[3].f1[1]’)
array.c:681: error: initializer element is not constant
array.c:681: error: (near initialization for ‘mercury_common_1[0].f1[1]’)
array.c:699: error: initializer element is not constant
array.c:699: error: (near initialization for ‘mercury_common_1[3].f1[1]’)
array.c:715: error: initializer element is not constant
array.c:715: error: (near initialization for ‘mercury_common_1[6].f1[0]’)
array.c:717: error: initializer element is not constant
array.c:717: error: (near initialization for ‘mercury_common_1[6].f1[1]’)
array.c:729: error: initializer element is not constant
array.c:729: error: (near initialization for ‘mercury_common_1[8].f1[1]’)
array.c:754: error: initializer element is not constant
array.c:754: error: (near initialization for ‘mercury_common_2[1].f2’)
array.c:758: error: initializer element is not constant
array.c:758: error: (near initialization for ‘mercury_common_2[2].f2’)
array.c:762: error: initializer element is not constant
array.c:762: error: (near initialization for ‘mercury_common_2[3].f2’)
make[2]: *** [array.o] Error 1
make[2]: *** Waiting for unfinished jobs....
make[2]: *** [tree234.o] Error 1
make[1]: *** [library] Error 2
make: *** [install] Error 2 
```

然后我通读了自述文件，它说我应该使用其他版本的`GCC`. 所以我安装了这些`Command Line Tools`（因为我发现它们确实包含 GCC）并再次尝试。没有运气，仍然是同样的问题。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T13:50:53.590

我是 Mercury 的 OS X 端口的主要维护者。在 XCode 4.* 中，名为 gcc 的可执行文件并不是真正的 gcc，它实际上是 llvm-gcc 的符号链接。llvm-gcc 有问题，无法编译 Mercury 编译器生成的 C 代码——我们检查过，有问题的 C 代码是有效的 C 并且（真正的）gcc 和 clang 都没有问题。

如果您使用的是 Mac OS X 10.7 或 10.8，我**强烈**建议您使用 clang 作为 Mercury 的 C 编译器。（有关详细信息，请参阅发行版中的 README.clang 文件。）或者，您可以安装一个真实版本的 gcc（例如，来自 macports）并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T21:38:51.873

嗨我有完全相同的问题。

我会及时通知你的，我想我只是想通了。虽然很有趣，因为我做了和你一样的步骤。我打算安装新的 gcc 并选择那个进行编译。

可能也是 KULeuven 的学生 :) ？

- 编辑：

看起来我刚刚修复了它，我下载了 gcc 4.3，安装了它。将此添加到 ~/.profile：

> 导出 PATH=/usr/local/bin:$PATH

运行`source ~/.profile`并再次尝试make，它仍在安装。它现在已经运行了 4 分钟，所以我猜我已经走出困境了，上次我花了 5 秒才遇到错误。

# java - 为什么 java.util.HashSet 没有 get(Object o) 方法？

> ID：13863506
> 
> 赞同：63
> 
> 时间：2012-12-13T15:53:35.980
> 
> 标签：java, hashset

我已经看到其他关于`Set`基于索引值从 ' 获取对象的问题，我理解为什么这是不可能的。但是我无法找到一个很好的解释来解释为什么不允许按对象获取，所以我想我会问。

`HashSet`由 a 支持，`HashMap`因此从中获取对象应该非常简单。就像现在一样，看来我必须遍历中的每个项目`HashSet`并测试似乎没有必要的相等性。

我可以只使用 a`Map`但我不需要 key:value 对，我只需要一个`Set`.

例如说我有`Foo.java`：

```
package example;

import java.io.Serializable;

public class Foo implements Serializable {

    String _id;
    String _description;

    public Foo(String id){
        this._id = id
    }

    public void setDescription(String description){
        this._description = description;
    }

    public String getDescription(){
        return this._description;
    }

    public boolean equals(Object obj) {
        //equals code, checks if id's are equal
    }

    public int hashCode() {
        //hash code calculation
    }

} 
```

和`Example.java`：

```
package example;

import java.util.HashSet;

public class Example {

    public static void main(String[] args){
        HashSet<Foo> set = new HashSet<Foo>();

        Foo foo1 = new Foo("1");
        foo1.setDescription("Number 1");

        set.add(foo1);
        set.add(new Foo("2"));

        //I want to get the object stored in the Set, so I construct a object that is 'equal' to the one I want.
        Foo theFoo = set.get(new Foo("1")); //Is there a reason this is not allowed?
        System.out.println(theFoo.getDescription); //Should print Number 1
    }

} 
```

是否因为 equals 方法旨在测试“绝对”相等而不是“逻辑”相等（在这种情况下`contains(Object o)`就足够了）？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2014-08-21T12:24:25.840

***Java Map/Collection 备忘单***

它是否只包含键/值对或值？

> 1）如果它包含*对*，选择是一个地图。顺序重要吗？
> 
> . 1-1）如果*是*，请按照插入顺序或按键排序？

. . 1-1-1) 如果有序，**LinkedHashMap**

. . 1-1-2) 如果已排序，**TreeMap**

. 1-2）如果顺序*不重要*，**HashMap**

> 2）如果它只存储*values*，则选择是一个集合。它会包含重复项吗？

. 2-1) 如果*是*，**ArrayList**

> . 2-2) 如果它*不*包含重复项，主要任务是搜索元素（包含/删除）吗？

. . 2-2-1) 如果*没有*，**ArrayList**

> . . 2-2-2) 如果*是*，顺序重要吗？

. . . 2-2-2-1) 如果顺序*不重要*，**HashSet**

> . . . 2-2-2-2) 如果*是*，请按照插入顺序或按值排序？

. . . . 2-2-2-2-1) 如果是*有序*的，**LinkedHashSet**

. . . . 2-2-2-2-2) 如果已*排序*，则**TreeSet**

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-12-13T15:56:31.977

A`Set`是一个被视为重复`Collection`的对象`a.equals(b) == true`，因此尝试获取您已经拥有的相同对象是没有意义的。

如果您尝试`get(Object)`从集合中提取，a`Map`可能更合适。

你应该写的是

```
Map<String, String> map = new LinkedHashMap<>();

map.put("1", "Number 1");
map.put("2", null);
String description = map.get("1"); 
```

> 如果一个对象不在集合中（基于equals），添加它，如果它在集合中（基于equals）给我该对象的集合实例

万一您需要这个，您可以使用`Map`.

```
Map<Bar, Bar> map = // LinkedHashMap or ConcurrentHashMap

Bar bar1 = new Bar(1);
map.put(bar1, bar1);

Bar bar1a = map.get(new Bar(1)); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-13T15:58:09.437

你的最后一句话就是答案。

`get(Object o)`将通过`HashSet`寻找另一个对象等于`o`（使用`equals(o)`方法）。所以它确实与 相同`contains(o)`，只是不返回相同的结果。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-13T15:59:34.647

如果您想知道该`new Foo("1");`对象已经存在，`set`那么您需要使用`contains`方法：

```
boolean present =  set.contains(new Foo("1")); 
```

不支持 ie的`get`那种方法`set.get(new Foo("1"));`，因为它没有意义。您已经拥有该对象，即`new Foo("1")`您将通过`get`方法查看哪些额外信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-19T16:41:31.330

HashSet 比 HashMap 简单一点。如果你不需要 HashMap 的特性，为什么要使用它？如果像 getObject(ObjectType o) 这样的方法是由 Java 实现的，我们不需要在调用 contains() 方法后遍历集合...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-05T20:15:36.607

没有get的原因很简单：

如果您需要从集合中获取对象 X 是因为您需要 X 中的某些东西而您没有该对象。

如果您没有该对象，那么您需要一些方法（键）来定位它。..它的名字，一个数字什么的。那就是地图是正确的。

map.get("key") -> X！

集合没有键，你需要遍历它们来获取对象。

那么，为什么不添加一个方便的 get( X ) -> X

这没有任何意义，因为你已经有了 X，纯粹主义者会说。

但是现在将其视为非纯粹主义者，看看您是否真的想要这个：

假设我制作了对象 Y，它与 X 的等号匹配，因此 set.get(Y)->X。Volia，然后我可以访问我没有的X的数据。例如，X 有一个名为 get flag() 的方法，我想要它的结果。

现在看看这段代码。

是

X = map.get(Y);

所以 Y.equals(x) 为真！

但..

Y.flag() == X.flag() = 假。（他们不是平等的吗？）

所以，你看，如果 set 允许你得到这样的对象，那肯定是打破了 equals 的基本语义。稍后你将与 X 的小克隆一起生活，他们都声称它们是相同的，而实际上它们不是。

您需要一张地图来存储东西并使用密钥来检索它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-13T06:40:59.630

如果你只想知道 Hashset 中有什么，你可以使用`.toString();`方法显示所有 Hashset 内容，用逗号分隔。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-11-07T15:44:08.330

我遇到了与线程作者相同的问题，并且我有一个 Set 应该具有 get 方法的真正原因：我覆盖了例如 X 的等于，集合 Set 的内容，因此包含的对象不一定是与检查的相同。在我的场景中，我将删除另一个集合中的语义双精度，并使用“双精度”的一些关系来丰富“原始”，因此我需要“原始”才能删除双精度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-03T09:39:24.417

**当我们将一个信息链接到其他信息时，get(Object o) 很有用，就像在 HashMap 中找到的键值对一样。因此，对一个信息使用 get() 方法，我们可以获得第二个信息，反之亦然。**

现在，如果 HashSet 提供 get(Object o) 方法，您需要传递一个对象。因此，如果您将对象传递给 get(Object o) 方法，这意味着您已经拥有该对象，那么 get(Object o) 方法需要什么。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-01-02T09:48:09.223

正如大家之前提到的，没有这样的方法并且有充分的理由。话虽如此，如果您希望使用单线（几乎）从 java 8 中的 HashSet 获取某个对象，只需使用流。在你的情况下，它会是这样的：

```
Foo existing = set.stream().filter(o -> o.equals(new Foo("1"))).collect(Collectors.toList()).iterator().next(); 
```

请注意，如果元素不存在，则会引发异常，因此它在技术上不是单行的，但如果过滤器被正确实现，它应该比对集合元素的传统迭代更快。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-10-12T21:08:19.297

`get`方法 on的一个常见用例`Set`可能是实现一个实习生集。如果这是您想要实现的目标，请考虑使用 Google Guava 的[`Interner`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Interner.html)界面和[`Interners`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Interners.html)工厂。

# c++ - 在 Linux 上编译 boost asio 时出现链接错误

> ID：13863508
> 
> 赞同：8
> 
> 时间：2012-12-13T15:53:42.617
> 
> 标签：c++, ubuntu, boost-asio

我一直在浏览一些关于 boost 及其库的教程。

我浏览了 boost 的基本教程：

```
http://www.boost.org/doc/libs/1_52_0/more/getting_started/unix-variants.html 
```

它工作得很好。我在使用 asio 教程时遇到问题：

```
http://www.boost.org/doc/libs/1_50_0/doc/html/boost_asio/tutorial/tutdaytime1/src.html 
```

它看起来像链接错误，但我包含与以前相同的路径：

```
g++ -I /usr/local/boost_1_52_0 test.cpp -o example 
```

错误：

```
/tmp/cce4EZME.o: In function `__static_initialization_and_destruction_0(int, int)':
test.cpp:(.text+0x57b): undefined reference to `boost::system::generic_category()'
test.cpp:(.text+0x587): undefined reference to `boost::system::generic_category()'
test.cpp:(.text+0x593): undefined reference to `boost::system::system_category()'
/tmp/cce4EZME.o: In function `boost::system::error_code::error_code()':
test.cpp:(.text._ZN5boost6system10error_codeC2Ev[_ZN5boost6system10error_codeC5Ev]+0x17): undefined reference to `boost::system::system_category()'
/tmp/cce4EZME.o: In function `boost::asio::error::get_system_category()':
test.cpp:(.text._ZN5boost4asio5error19get_system_categoryEv[_ZN5boost4asio5error19get_system_categoryEv]+0x5): undefined reference to `boost::system::system_category()'
/tmp/cce4EZME.o: In function `boost::asio::detail::posix_thread::~posix_thread()':
test.cpp:(.text._ZN5boost4asio6detail12posix_threadD2Ev[_ZN5boost4asio6detail12posix_threadD5Ev]+0x26): undefined reference to `pthread_detach'
/tmp/cce4EZME.o: In function `boost::asio::detail::posix_thread::join()':
test.cpp:(.text._ZN5boost4asio6detail12posix_thread4joinEv[_ZN5boost4asio6detail12posix_thread4joinEv]+0x2b): undefined reference to `pthread_join'
/tmp/cce4EZME.o: In function `boost::asio::detail::posix_thread::start_thread(boost::asio::detail::posix_thread::func_base*)':
test.cpp:(.text._ZN5boost4asio6detail12posix_thread12start_threadEPNS2_9func_baseE[_ZN5boost4asio6detail12posix_thread12start_threadEPNS2_9func_baseE]+0x29): undefined reference to `pthread_create'
collect2: error: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-13T21:21:52.003

假设你已经在你的目录中安装了你的 boost 库`/usr/lib`和 boost 头文件，`/usr/include/boost`并且你已经将你的代码保存在一个名为的文件中`daytime1.cpp`，你必须使用以下命令来编译你链接到的源代码：

```
$ g++ daytime1.cpp -o daytime -L /usr/lib/ -lboost_system -lboost_thread -lpthread 
```

# java - Java Callable thread swing gui

> ID：13863509
> 
> 赞同：0
> 
> 时间：2012-12-13T15:53:43.917
> 
> 标签：java, multithreading, swing, user-interface, event-dispatching

我错过了一些东西，我创建了一个基于可调用的类，并在我的 gui 中创建了一个实例并在执行操作时调用它。唯一的问题是 GUI 没有响应，因为进程在同一个线程上运行，并且必须等待它完成才能访问 GUI。以下是部分代码：

```
public class MYProject {
public static class CreateProject implements Callable<Boolean>{
    private String m_url;
    private String m_project;
    private String m_options;
    public CreateProject(String url, String project, String options){
        m_url = url;
        m_project = project;
        m_options = options;
    }
    public Boolean call(){
        Boolean result = true;
        try {
            if (os.toLowerCase().contains("windows")){
                command = windowsCMD + command;
            }
            String line;
            Process p = Runtime.getRuntime().exec(command);
            InputStreamReader isr = new InputStreamReader(p.getInputStream());
            BufferedReader bri = new BufferedReader(isr);
            try {
                while ((line = bri.readLine()) != null) {
                    if(line.startsWith("ERROR")){
                        System.out.println(line);
                        result = false;
                        break;
                    }
                }
                p.waitFor();
            }
            finally {
                bri.close();
            }
        }
        catch (Exception err) {
            System.err.println("Unable to create project: " + err.getMessage() 
                                + "\n");
            result = false;
        }
        return result;
    }
}
} 
```

并在 GUI 中：

```
private void jButtonRefreshActionPerformed(java.awt.event.ActionEvent evt) {
    jTextAreaConsole.append("Creating project.\n");
    MYProject.CreateProject blah = new MYProject.CreateProject("url", "project", "options");
    String result = blah.call();
    jTextAreaConsole.append("Project creation successful: " + result);
} 
```

结果是 Process p 仍然在与 gui 相同的线程上运行，并且没有任何内容是可点击的，并且 jTextAreaConsole 直到进程完成后才会更新。任何人都可以就我应该如何实施这一点提供一些建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:16:42.667

实现一个`SwingWorker`长期运行的任务。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:10:37.950

> 结果是 Process p 仍在与 gui 相同的线程上运行，并且没有任何内容是可点击的，并且 jTextAreaConsole

是的，它正在做的正是 p.waitFor(); 在你的代码中

```
waitFor() 
```

如有必要，使当前线程等待，直到此 Process 对象表示的进程终止。

从

[进程类](http://docs.oracle.com/javase/7/docs/api/java/lang/Process.html)

您可能想使用像 @Andrew Thompson 发布的 SwingWorker 或者您可以实现 Runnable 的 run 方法并在新线程中启动它，或者甚至使用像 @hoaz 发布的 Executor 类

要使可调用对象在单独的线程中运行，您需要使用 Executors

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T15:59:12.370

`Executor`您应该使用`Callable`单独的`Thread`.

```
Executor executor = Executors.newSingleThreadExecutor();
executor.submit(blah);
...
executor.shutdown(); // free resources 
```

请注意，您应该创建一次执行程序并在程序退出时将其销毁。否则你可能会泄漏资源。

# c# - 铸造通用接口

> ID：13863511
> 
> 赞同：1
> 
> 时间：2012-12-13T15:53:49.423
> 
> 标签：c#, generics, interface, dependency-injection

我有以下。

```
public interface IMyService<T>
   where T: BaseModelType
{
    Process(T input);
}        

public class BaseModelType
{
  ...some property
}

public class SomeClass : BaseModelType
{
   ...some properties
}

public ServiceImpl : IMyService<SomeClass>
{
    ...the properties
} 
```

然后我有一个统一容器，我在其中注册了通用接口的所有实现。我希望能够使用 unitycontainer 的 resolve 方法来获取接口，然后对其进行一些工作。当我想使用 Resolve 方法时，我在运行时有类型

```
 new UnityContainer.Resolve(myTypeVar) 
```

我能以某种方式把它变成

```
 IMyService<BaseModelType> value = new UnityContainer.Resolve(myTypeVar) //want to cast it here from object. 
```

这样我就可以调用接口定义的 Process 方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:58:38.617

不，因为`IMyService<SomeClass>`没有实现`IMyService<BaseModelType>`. 如果你看一下 Process 方法的实现：

```
public void Process(SomeClass input){...} 
```

这显然假设你给它一个`SomeClass`. 它应该能够安全地访问`SomeClass`. 但是如果你用 a`BaseModelType`作为参数调用这个方法，那是行不通的，不是吗？

假设您在运行时知道您的*参数*`input`将是给定通用`IMyService<T>`接口的正确类型，您有两个选择：

1.  通过反射调用通用方法签名。有点慢，但很有效。
2.  为 添加一个非通用父接口`IMyService`，它需要一个`BaseModelType`. 在您的服务实现中，您可以通过将输入转换为该实现的预期类型来实现此方法。这需要更多代码。但是您可以通过拥有一个实现此方法的通用抽象基类来缓解这种情况，这样其他实现就不必这样做了。

    ```
    void Main()
    {
        var s = (IMyService)new ServiceImpl();
        s.Process(new SomeClass());
    }

    public interface IMyService
    {
        void Process(BaseModelType input);
    }

    public interface IMyService<in T> : IMyService
       where T: BaseModelType
    {
        void Process(T input);
    }

    public class BaseModelType{}

    public class SomeClass : BaseModelType{}

    public abstract class ServiceBase<T> : IMyService<T>
        where T: BaseModelType
    {
         void IMyService.Process(BaseModelType input)
         {
             Process((T)input);
         }

         public abstract void Process(T input);
    }

    public class ServiceImpl : ServiceBase<SomeClass>{
        public override void Process(SomeClass input){}
    } 
    ```

# api - Google Apps 联系人同步

> ID：13863512
> 
> 赞同：2
> 
> 时间：2012-12-13T15:53:58.100
> 
> 标签：api, rest, synchronization, google-apps, google-contacts-api

我们正在开发一个应用程序，我们希望设置与 Google 通讯录的双向同步。

过程：他们设置他们的谷歌账户，应用程序在他们的谷歌账户和我们的数据库之间进行同步。

第一种方法是创建一个 CRON 来获取对 API 的修改，但这不是很有效，因为我们需要经常运行 CRON。

您知道 Google 是否可以通过任何方式“通知我们”修改？

也许来自我们直接在他们的服务器上执行的脚本？（如 Google Scripts）然后我们将能够调用我们的应用程序进行新的提取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:09:15.143

没有任何方法可以将更改“推送”到您的应用程序。但是，在轮询更改时，您可以使用 updated-min 参数来最小化流量，如下所述：

[https://developers.google.com/google-apps/contacts/v3/reference#Parameters](https://developers.google.com/google-apps/contacts/v3/reference#Parameters)

和：

[https://developers.google.com/google-apps/contacts/v3/#retrieving_contacts_using_query_parameters](https://developers.google.com/google-apps/contacts/v3/#retrieving_contacts_using_query_parameters)

# jquery - 使用 jquery .each() 捕获 li 内容

> ID：13863518
> 
> 赞同：0
> 
> 时间：2012-12-13T15:54:08.787
> 
> 标签：jquery, html, ajax, post

使用 jQuery 和 AJAX 提交表单，我的 PHP 文件执行所有验证并返回两个响应之一。

如果成功：

```
<div id='formres'>1</div>
<div id='formresposta'>
    <h2>SUCESSO</h2>
</div> 
```

或者这个（未提交，发现错误）：

```
<div id='formres'>0</div>
<ul>
    <li>errnome</li>
    <li>errmail</li>
    <li>errmsg</li>
</ul> 
```

到目前为止，我编写的 jQuery 设法做我想做的事，除了在发现错误时采取行动......这里是：

```
 $("#formcontacto").submit(function () {
        var dados = $(this).attr("action");
        $.post(dados,{
            nome:$(".nome").val(),
            email:$(".email").val(),
            telefone:$(".telefone").val(),
            mensagem:$(".mensagem").val()
        },
        function (dados) {
                resultado = $(dados).filter(function(){ return $(this).attr("id") == "formres"}).text();
                alert(resultado);
                if(resultado == 1){
                    $("#formcontacto").fadeOut("slow");
                    $("#formcontainer").html(dados).fadeIn(3000);
                }else{
                    alert(dados);
                    var erros = $(dados).filter(function(){ return $(this).is("li") }).text();
                    alert(erros);
                    erros.each(function() {
                    if ($(this).text() == 'errnome'){ $('.nome').css({'border':'1px solid #a00','background-color':'#ffbaba','color':'#222'}); }
                    if ($(this).html() == 'errmsg'){ $('.mensagem').css({'border':'1px solid #a00','background-color':'#ffbaba','color':'#222'}); }
                    if ($(this).html() == 'errmail'){ $('.email').css({'border':'1px solid #a00','background-color':'#ffbaba','color':'#222'}); }
                    })
                }
            });
        return false;

    }) 
```

我不知道为什么 .is("li") 不起作用，而且我也觉得我过于复杂了......任何线索？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:19:21.250

这看起来像是 json 的工作，我完全会考虑这样的事情。

您可以根据自己的意愿创建一个 PHP 数组并将其转换为：

```
 json_encode($array) 
```

然后您可以轻松地请求文件，类似于您的 .post 功能：

```
$.getJSON('your.php', { your: options }, function(data) {
  if(data.formres == 1){
     // Everything is ok
  } else {
     // Something went wrong, so print the problems
     $.each(data.errors, function(key, val) {
       $("#result").append('<li id="' + key + '">' + val + '</li>');
     });
}); 
```

JSON 如下所示：

```
{
  "formres": "1",
  "errors": {
    "1": "wrong name",
    "2": "wrong email",
    "3": "wrong whatever"
  } 
} 
```

*请注意，PHP 中的 JSON 在 PHP 5.2.0 中可用。代码也未经测试*

# python - 在 Python 中使用正则表达式更改日期格式

> ID：13863519
> 
> 赞同：0
> 
> 时间：2012-12-13T15:54:10.977
> 
> 标签：python, regex

我正在尝试将格式为`YYYYMMDD`to的日期转换`MM/DD/YYYY`为从数据库中读取并写入 Excel 文件的日期。使用 Perl 我将执行以下操作：

```
var=~s/([0-9])([0-9])([0-9])([0-9])([0-9])([0-9])([0-9])([0-9])/$5$6\/$7$8\/$1$2$3$4/; 
```

请记住，这一切都发生在读取数据库信息的“for row in rows”循环结构中。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:00:58.163

而不是使用正则表达式，您可以使用 pythons[`datetime`](http://docs.python.org/2/library/datetime.html)模块。

或者您可以将两者结合起来，但这是您想要的，但这将是修改日期格式的更清晰的方法。python 是一门清晰易读与效率同等重要的语言。查看下面的代码可以看到我正在修改日期戳，而使用正则表达式有时很不清楚。

读取 datetime 元素，然后根据需要编写它：

```
>>> from datetime import datetime
>>> datestring = '20121212' # 2012 / 12 /12 
>>> datetime.strptime(datestring, '%Y%m%d').strftime('%m/%d/%Y')
'12/12/2012' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:01:54.750

我会选择简单的字符串操作——当然同样清楚......

```
>>> s = '20121213'
>>> '/'.join( (s[4:6], s[6:], s[:4]) )
'12/13/2012' 
```

相对于：

```
>>> re.sub(r'(\d{4})(\d{2})(\d{2})', r'\2/\3/\1', s)
'12/13/2012' 
```

如果您要坚持使用像您在下面发布的那样

> dateFormatted = row["TRADE_DATE"] dateFormatted = re.sub(r'(\d)(\d)(\d)(\d)(\d)(\d)(\d)(\d)', r'\5\6/\7\8/\1\2\3\4', dateFormatted) – user1901341 5 分钟前

然后你可以（ab）使用字符串格式

```
>>> '{4}{5}/{6}{7}/{0}{1}{2}{3}'.format(*s)
'12/13/2012' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T16:05:10.633

你不需要使用正则表达式——Python 不像 Perl 那样鼓励它们——但你当然可以使用一个：

```
import re 
re.sub(r'(\d{4})(\d{2})(\d{2})', r'\2/\3/\1', datestring) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:01:39.507

我想你可以在这里简单地得到它，没有正则表达式：

```
>>> s = '20121225'
>>> conv = '/'.join((s[6:8], s[4:6], s[0:4]))
>>> conv
'25/12/2012' 
```

# python - 是否可以创建一个包含复整数的 numpy.ndarray？

> ID：13863523
> 
> 赞同：17
> 
> 时间：2012-12-13T15:54:29.910
> 
> 标签：python, numpy

我想创建`numpy.ndarray`包含复杂整数值的对象。NumPy 确实具有内置的复杂支持，但仅适用于浮点格式（`float`和`double`）；例如，我可以创建一个`ndarray`with `dtype='cfloat'`，但没有类似`dtype='cint16'`的 . 我希望能够创建包含使用 8 位或 16 位整数表示的复杂值的数组。

我发现[了 2007 年的这个邮件列表帖子](http://mail.scipy.org/pipermail/numpy-discussion/2007-October/029447.html)，有人询问了这种支持。他们推荐的唯一解决方法是定义一个`dtype`包含整数对的新方法。这似乎将每个数组元素表示为 2 个值的元组，但尚不清楚需要完成哪些其他工作才能使生成的数据类型与算术函数无缝协作。

我还考虑了另一种基于使用 NumPy[注册用户定义类型的方法。](http://docs.scipy.org/doc/numpy-dev/user/c-info.beyond-basics.html#user-defined-data-types)如果它运行良好，我没有问题去 C API 进行设置。但是，[类型描述符结构的文档](http://docs.scipy.org/doc/numpy-dev/reference/c-api.types-and-structures.html#PyArray_Descr.kind)似乎表明该类型的`kind`字段仅支持有符号/无符号整数、浮点和复数浮点数字类型。目前尚不清楚我能否在任何地方尝试定义复杂的整数类型。

关于可能有效的方法的任何建议？

**编辑：**还有一件事；我选择的任何方案都必须能够在不执行复制的情况下包装现有的复杂整数缓冲区。也就是说，我希望能够使用`PyArray_SimpleNewFromData()`将缓冲区公开给 Python，而不必先复制缓冲区。缓冲区已经是交错的实数/虚数格式，并且可以是`int8_t`或的数组`int16_t`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-09-30T23:37:46.637

我还处理大量复杂的整数数据，通常是基带数据。我用

```
dtype = np.dtype([('re', np.int16), ('im', np.int16)]) 
```

它并不完美，但它充分描述了数据。我用它来加载到内存中而不会使数据的大小加倍。它还具有能够使用 HDF5 透明地加载和存储的优势。

```
DATATYPE  H5T_COMPOUND {
    H5T_STD_I16LE "re";
    H5T_STD_I16LE "im";
} 
```

使用它很简单，只是不同。

```
x = np.zeros((3,3),dtype)
x[0,0]['re'] = 1
x[0,0]['im'] = 2
x
>> array([[(1, 2), (0, 0), (0, 0)],
>>        [(0, 0), (0, 0), (0, 0)],
>>        [(0, 0), (0, 0), (0, 0)]], 
>>  dtype=[('re', '<i2'), ('im', '<i2')]) 
```

为了用它做数学，我转换为原生的复杂浮点类型。显而易见的方法不起作用，但也没有那么难。

```
y = x.astype(np.complex64) # doesn't work, only gets the real part
y = x['re'] + 1.j*x['im']  # works, but slow and big
y = x.view(np.int16).astype(np.float32).view(np.complex64)
y
>> array([[ 1.+2.j,  0.+0.j,  0.+0.j],
>>        [ 0.+0.j,  0.+0.j,  0.+0.j],
>>        [ 0.+0.j,  0.+0.j,  0.+0.j]], dtype=complex64) 
```

最后一种转换方法的灵感来自[https://stackoverflow.com/a/5658446/1784179](https://stackoverflow.com/a/5658446/1784179)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-10-22T16:24:35.467

您是否考虑过使用 [[a,-b],[b,a]] 形式的矩阵来代替复数？矩阵的普通乘法和加法对应于加法和复数的乘法（这个 2x2 矩阵集合的子环与复数同构）。我认为python可以处理整数矩阵代数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-07T13:49:27.470

Python 和 Numpy 确实支持复数，如果你想要复数，只需使用 np.round 或忽略小数部分。

例如

```
import numpy as np
#Create 100 complex numbers in a 1D array
a=100*np.random.sample(100)+(100*np.random.sample(100)*1j)
#Reshape to a 2D array
np.round(a)
a.reshape(10,10)

#Get the real and imag parts of a couple x/y points as integers
print int(a[1:2].real)
print int(a[3:4].imag) 
```

# twitter - 通过 Akamai Edge 的 Twitter OAuth 错误

> ID：13863524
> 
> 赞同：1
> 
> 时间：2012-12-13T15:54:31.097
> 
> 标签：twitter, oauth, akamai

在我将我的域置于 Akamai Edge 下后，我之前工作的 Twitter Connect 流停止工作，并且用户收到登录错误。调试时，我发现我对[这个 url](https://api.twitter.com/1/account/verify_credentials.xml)的 OAuth 调用回答了“错误的身份验证数据”。

我试图在网上寻找解决方案，但似乎我是唯一一个遇到这个问题的人，在此先感谢所有愿意帮助我的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:01:37.470

如果 Twitter 客户端之前运行平稳，只需撤消您最近所做的更改。你一定在什么地方搞砸了！

# linux - 在linux中使用排序，我怎样才能在2之后得到12？

> ID：13863530
> 
> 赞同：1
> 
> 时间：2012-12-13T15:54:41.663
> 
> 标签：linux, sorting

我有一个文件，以数字开头：

```
$ cat file
1
3
13
2
4
12 
```

当我使用`cat file | sort`时，它显示如下：

```
$ cat file | sort

1
12
13
2
3
4 
```

我怎样才能得到这样的答案：

```
1
2
3
4
12
13 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:06:30.273

使用该`-n`选项启用数字排序：

```
$ cat file | sort -n 
```

`-g`这比GNU 的专有扩展更快、更便携`sort`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T15:56:54.883

使用`-g`选项`sort`进行一般的数字排序（对于大型输入可能会很慢）：

```
$ sort -g file 
```

或者：

```
$ sort -n file 
```

可以在[相关问题](https://stackoverflow.com/questions/1255782/whats-the-difference-between-general-numeric-sort-and-numeric-sort-options)中找到差异。

**UPD：**修复了`cat`评论中所述的无用处。

# c - C程序不断崩溃

> ID：13863533
> 
> 赞同：0
> 
> 时间：2012-12-13T15:54:50.313
> 
> 标签：c, crash

我的程序不断崩溃。这些代码似乎合法且正确。想知道有什么问题。

```
#include <stdio.h>

void queue(int length,int turns){
    int permutations,totalTurns;
    turns++;
    if (length>0){
        queue(length-1,turns);
        if (length>1){
            queue(length-2,turns);
        }
    } 
    else{
        permutations++;
        totalTurns+=turns;
    }
}

int main() 
{
    while(true){
        int length;
        float average;
        int permutations=0;
        int totalTurns=0;

        printf("Queue length: ");
        scanf("%d", &length);
        queue(length,-1);
        average=totalTurns/permutations;
        printf("The average turns are %f", average);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T15:56:43.210

```
 int permutations=0;

    average=totalTurns/permutations; 
```

你除以零。

请注意，`permutations`您在 中声明的变量与在 中的变量`main()`不同`queue()`。

您可能应该`permutations`从 中返回值`queue()`，如下所示：

```
int queue(int length,int turns){
    int permutations = 0;
    ...
    return permutations;
}

int main(void) {
    ...
    int permutations = queue(length,-1);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T15:59:36.847

您应该将排列声明为全局变量，即在 main 函数和 totalTurns 之外，因为正如其他人提到的那样，它始终为 0，因为即使您在函数队列中声明它，它也会被遗忘在它之外。

```
#include <stdio.h>

static int permutations=0;
static int totalTurns=0;

void queue(int length,int turns){
    turns++;
    if (length>0){
        queue(length-1,turns);
        if (length>1){
            queue(length-2,turns);
        }
    } 
    else{
        permutations++;
        totalTurns+=turns;
    }
}

int main() 
{
    while(true){
        int length;
        float average;
        int totalTurns=0;

        printf("Queue length: ");
        scanf("%d", &length);
        queue(length,-1);
        average=totalTurns/permutations;
        printf("The average turns are %f", average);
    }
} 
```

# typescript - Typescript - 为外部 AMD 模块定义类型

> ID：13863534
> 
> 赞同：2
> 
> 时间：2012-12-13T15:54:59.207
> 
> 标签：typescript

我正在使用 require 在 typescript 模块中加载一个非 typescript amd 模块（用 javascript 编写，而不是从 ts 编译）：

```
var worker = require('worker'); 
```

worker 模块导出了几个构造函数。

现在我想做一些类型定义（例如作为主干.d.ts）

```
module WorkerModule {
    interface IResult {
        amount(): number;
    }
    interface IWorker {
        work();
        getResult(): IResult;
    }
    interface OtherWorker extends IWorker {
        workMore();
    }
} 
```

我如何告诉 TSC 工人是 WorkerModule。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:20:48.263

您可以键入您的工作变量：

```
var worker: IWorker = require('worker'); 
```

这将提供对`worker`变量的类型检查。

# c# - 当我的方法完成运行时，垃圾收集器会释放这个列表吗

> ID：13863538
> 
> 赞同：6
> 
> 时间：2012-12-13T15:55:11.737
> 
> 标签：c#, memory-management, memory-leaks, garbage-collection

可以说我有类似的东西：

```
public class Item
{
    public string Code;
    public List<string> Codes = new List<string>();
}

private void SomeMethod()
{
    List<Item> Items = new List<Item>();
    for (int i = 0; i < 10; i++)
    {
        Item NewItem = new Item();
        NewItem.Code = "Something " + i.ToString();
        NewItem.Codes.Add("Something " + i.ToString());
        Items.Add(Item);
    }

    //Do something with Items
} 
```

我正在实例化 Item 而不是释放它，因为稍后我需要在列表中访问它（粗略示例）。

我想知道的是何时`SomeMethod()`完成执行，是否会取消引用项目（及其内容 - 包括 List<>）并允许垃圾收集器在运行时清理内存？基本上，这部分代码会导致任何内存泄漏，还是应该在`SomeMethod()`完成处理后取消引用所有内容。

我的理解是，当没有任何东西包含对对象的引用时，它将被垃圾收集，所以在我看来，这段代码应该没问题，但我只是想确保我理解正确。

编辑：

如果我要将其中一个对象添加`Items`到另一个仍在范围内的列表中（例如全局列表）。会发生什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-13T15:56:47.230

一旦你的变量`Items`超出范围，垃圾收集器确实会在闲暇时处理它（以及它的内容，因为你的代码是编写的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T15:59:40.470

垃圾收集器将收集代码不再可以访问的任何内容。由于您将无法再访问您的项目列表或列表中包含的任何项目，因此垃圾收集器将在某个时候收集它们。您对垃圾收集器的理解是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:03:32.773

行，

```
List<Item> Items 
```

在方法的范围内声明。因此，当方法结束时，它超出了范围，并且列表被取消引用。

之后，当垃圾收集器认为合适时，内存将被释放。

* * *

顺便说一句，因为`Items`在“本地”范围内声明，我更愿意称它为`items`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T16:27:45.703

为了让事情保持理智并保持其工作，GC 必须承诺两件事：

1.  **垃圾会被收集。** 这似乎很明显，但是如果 GC 不承诺在您不必告诉它的情况下清理托管对象，那它就毫无用处。

2.  ***只会*****收集垃圾。** 您不必担心 GC 会清理仍在使用的对象。

因此，一旦`Items`超出范围（即一旦函数返回），运行代码就无法再访问它，因此它可以被收集而无需您做任何事情。由于列表中的项目也不再可访问（它们的唯一链接在列表中），因此它们也符合条件。但是，如果您返回了对列表中某个条目的引用，则该对象仍在播放中并且还不能被收集。GC 会做正确的事。

事实上，GC*几乎总是*做正确的事。实际上，您只需要担心三种主要情况：

*   **如果您正在构建一个容器**（例如，如果您正在制作自己的`List`类似作品）。就用户而言，容器中不再“存在”的任何对象通常应设置为 null，以便 GC 不会将它们视为可通过您的集合访问并错误地使它们保持活动状态。例如，如果您从集合中删除一个项目，则将引用清空或用另一个覆盖它。
*   **使用大 (>~85KB?) 对象**。它们通常会停留在内存中，直到它们挤出其他所有内容，此时会运行完整的 GC 循环。（通常，在一个循环中只检查某些可能被丢弃的对象。完整的集合检查几乎*所有内容*，这需要更长的时间，但可能会释放更多的内存。）
*   **如果您使用的是 IDisposable 对象或本机/非托管资源。**一些不称职的人不知道如何正确实现 IDisposable。如果你正在处理一个由这样一个无能者创建的库，那么你需要确保你的`Dispose`东西，或者只在一个`using`块内使用它，否则事情会变得非常奇怪。（如果你只使用 .net API，你是很安全的。但处置仍然是一种礼貌。）

对于几乎所有其他场合，GC 都可以正常工作。相信它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-13T16:41:16.090

1.  方法中的所有变量都在一个堆栈帧中，所有这些变量将在方法执行后与堆栈帧一起被销毁。也就是说在 SomeMethod() 执行后，变量 Items 将不再存在，因此 new List() 将被标记为“可以收集”。

2.  第二个问题是，有一个全局列表变量持有变量Items中的一个对象的引用，然后在SomeMethod()执行后，SomeMethod中的List将被标记为“可以收集”，并且全局列表变量引用的项目旁边的所有其他对象也将被标记为“可以收集”，原因是，列表实际上保存了指向堆中确切对象的引用所以共享对象不能由于被 globleList 引用的原因而被收集

# c# - WPF嵌套ListViews - 父ListView的selectedValue

> ID：13863541
> 
> 赞同：0
> 
> 时间：2012-12-13T15:55:17.993
> 
> 标签：c#, wpf, xaml, listview

我有两个列表视图，一个包含子列表视图及其项目模板的父视图。

```
<ListView Name="TopView">
    <ListView.ItemTemplate>
        <DataTemplate>
             <ListView ItemsSource="{Binding SubList}"Focusable="False">
                  <ListView.Background>
                        <SolidColorBrush Color="Transparent"/>                                                  
                  </ListView.Background>
                  <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid HorizontalAlignment="Stretch">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition Width="50" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="{Binding Path=Number}" Grid.Column="0" />
                                <TextBlock Text="{Binding Path=Type}" Grid.Column="1" />
                                <TextBlock Text="{Binding Path=Code}" Grid.Column="2"  />
                            </Grid>
                        </DataTemplate>
                  </ListView.ItemTemplate>
             </ListView>
        </DataTemplate>
    </ListView.ItemTemplate>
</ListView> 
```

每当尝试使用 TopView.SelectedValue 时，返回的值始终为空。

如何使父 ListView 成为唯一接受选择事件而不是子 ListView 的 ListView？我想我需要对事件路由做一些事情，但我不确定是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:04:40.617

好的，没想到您将数据绑定与手动填充混合在一起。我假设您的内部 Listview 使用选择事件。您必须在树中冒泡，直到您点击 TopView。在处理后将内部 Listview 处理程序中的 e.handled 属性设置为 false，它应该为下一个列表视图 iirc 引发事件。

```
private void handleInner(object o, RoutedEventArgs e)
{
    InnerControl innerControl = e.OriginalSource as InnerControl;
    if (innerControl  != null)
    {
        //do whatever
    }
    e.Handled = false;
} 
```

# javascript - Javascript 替换和 $ 登录 newSubStr

> ID：13863542
> 
> 赞同：2
> 
> 时间：2012-12-13T15:55:17.743
> 
> 标签：javascript, string, replace, escaping

我有一个简单的 javascript 代码：

```
'test1 {0} test2 test3'.replace('{0}', "test$'") 
```

我预计结果是`test1 test$' test2 test3`。但结果是`test1 test test2 test3 test2 test3`

这是绝对正常的。根据 mozilla 文档：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)

在这种情况下，`$'`序列具有意义。

但我想准确地`{0}`替换。`test$'`我不希望`$'`序列被其他东西取代。我尝试了很多方法：

```
'test1 {0} test2 test3'.replace('{0}', "test\$\'")
'test1 {0} test2 test3'.replace('{0}', "test\\$\\'")
'test1 {0} test2 test3'.replace('{0}', "test\u0024\u0027")
'test1 {0} test2 test3'.replace('{0}', "test\$'") 
```

但没有任何效果。

如何转义`$'`序列以避免 Firefox 使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T15:59:21.997

从您引用的页面：

> $$ 插入一个“$”。

所以：

```
'test1 {0} test2 test3'.replace('{0}', "test$$'") 
```

这[在 JSFiddle.net 上对我有用](http://jsfiddle.net/ndBQY/)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T16:05:00.323

一种选择是使用正则表达式作为您的第一个参数：

```
'test1 {0} test2 test3'.replace(/\{0\}/, 'test$') 
```

作品：http: [//jsfiddle.net/Znwj2/](http://jsfiddle.net/Znwj2/)

# sql - SQL Server - 为 where 子句条件提供优先级

> ID：13863550
> 
> 赞同：1
> 
> 时间：2012-12-13T15:55:34.557
> 
> 标签：sql, sql-server-2008

请考虑以下 SQL。

```
declare @t1 table(site int, id int, name varchar(2))
declare @t2 table(site int, id int, mark int)

insert into @t1
select 1,1,'A'
union select 1,2,'B'
union select 1,3,'C'
union select 2,2,'D'
union select 2,3,'C'

insert into @t2
select 1,1,10
union select 1,2,20
union select 0,3,30
union select 1,3,40
union select 2,3,40
union select 2,3,40

select distinct a.site, a.id,a.name,b.mark
from @t1 a 
inner join @t2 b
on (a.site =b.site or b.site = 0) and a.id = b.id
where a.site=1 
```

它产生以下结果

```
站点 ID 名称 标记
----------------------------
1 1 10
1 2 乙 20
1 3 C 30
1 3 C 40

```

这是正确的。

但我只想要一个人的数据一次。SQL 应首先检查特定站点的@t2 中是否存在人员条目。如果找到条目，则使用它。如果不是，则该人的标记将是站点 0 中具有相同名称的人的标记。

在这种情况下，我想要的结果如下。

```
站点 ID 名称 标记
----------------------------
1 1 10
1 2 乙 20
1 3 C 40

```

但是如果 (1,3,40) 不在@t2 中，结果应该如下。

```
站点 ID 名称 标记
----------------------------
1 1 10
1 2 乙 20
1 3 C 30

```

我怎样才能做到这一点？我可以使用公用表表达式来做到这一点。所以请给我一个更快的方法。我将在大约 1 亿行上运行它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:22:26.317

两次外连接到 t2 表，并使用子查询确保仅包含匹配或为零的记录。

```
 Select distinct a.site, a.id, a.name, 
       coalesce(sm.mark, zs.mark) mark
  from @t1 a 
      Left Join @t2 sm -- for site match
          on sm.id = a.id
              And sm.site = a.site
      Left Join @t2 zs -- for zero site
          on zs.id = a.id
              And zs.site = 0
  Where Exists (Select * From @t2
                Where id = a.id 
                  And Site In (a.Site, 0))
     And a.site=1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:49:38.973

您可以将所有条件滚动到`on`子句中：

```
declare @target_site as Int = 1
select distinct a.site, a.id, a.name, b.mark
  from @t1 as a inner join
    @t2 as b on a.site = @target_site and a.id = b.id and
      ( a.site = b.site or ( b.site = 0 and not exists ( select 42 from @t2 where site = @target_site and id = a.id ) ) ) 
```

# string - 从文本中删除重复的单词

> ID：13863551
> 
> 赞同：0
> 
> 时间：2012-12-13T15:55:35.527
> 
> 标签：string, duplicate-removal

我有以下字符串的文本：

```
{whatever}:::duplicateString:::{whatever}
{whatever}:::duplicateString:::{whatever}
....
{whatever}:::duplicateString:::{whatever}
{whatever}:::duplicateString:::{whatever} 
```

如何从文本中删除**重复**字符串：主要思想是从行中删除第二个单词，如果它出现超过一次。

第一个想法是逐行读取它们并用“ **:::** ”分割，以便创建数组并通过向 TreeSet 添加条目来迭代数组。好的。但是如何再次粘合线呢？

我不记得有任何机制来解决这样的任务。语言无关紧要，只是近似解决方案？

示例文本：

```
Appliances:::Main
Appliances:::Main:::Appliance Warranties
Appliances:::Main:::Beer Keg Refrigerators
Appliances:::Main:::Beverage Refrigerators
Appliances:::Main:::Ceiling Fans & Accessories
Appliances:::Main:::Ceiling Fans & Accessories:::Accessories
Appliances:::Main:::Ceiling Fans & Accessories:::Accessories:::Downrod Couplers
Appliances:::Main:::Ceiling Fans & Accessories:::Accessories:::Downrods
Appliances:::Main:::Ceiling Fans & Accessories:::Accessories:::Fan Replacement Blades 
```

理想情况下，它必须像：

```
Appliances:::Main
Appliances:::Appliance Warranties
Appliances:::Beer Keg Refrigerators
Appliances:::Beverage Refrigerators
Appliances:::Ceiling Fans & Accessories
Appliances:::Ceiling Fans & Accessories:::Accessories
Appliances:::Ceiling Fans & Accessories:::Accessories:::Downrod Couplers
Appliances:::Ceiling Fans & Accessories:::Accessories:::Downrods
Appliances:::Ceiling Fans & Accessories:::Accessories:::Fan Replacement Blades 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:00:11.790

如果 duplicateString 可能仅作为第二个单词出现，您可以（在 Python 中）：

```
lastWord = None
for line in open('file.txt'):
  w = line.split(':::')
  thisWord = w[1]
  if lastWord==w[1]:
    del w[1]
  lastWord = thisWord
  print ':::'.join(w) 
```

# sublimetext2 - 增加红色拼写检查线 sublime text

> ID：13863554
> 
> 赞同：3
> 
> 时间：2012-12-13T15:55:44.003
> 
> 标签：sublimetext2

我想增加拼写错误时显示的拼写检查行的宽度/高度/粗体。

我也愿意编辑几乎任何属性，例如颜色，因为它在我的主题（钴）中不容易看到。

也张贴[在这里](http://sublimetext.userecho.com/topic/141709-/)。

# json - 如何在 Play Framework 模板中对列表进行排序？

> ID：13863556
> 
> 赞同：2
> 
> 时间：2012-12-13T15:55:51.640
> 
> 标签：json, groovy, playframework, playframework-1.x

我有这个模板呈现 JSON 内容：

```
[
#{list data}
{
    "title": ${_.title},
     "id": ${_.id}
} 
#{if !_isLast},#{/if}#{/list}
] 
```

有没有办法`data`在打印数据成员之前在模板内部进行排序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T00:21:53.427

Doing logic such as sorting is what controllers are for, you shouldn't be sorting in your template, templates are for rendering.

Write a Comparator that sorts your json objects following your desired criteria and call Collections.sort(data, yourComparator) before passing data to the template.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T21:31:34.207

有可能的：

```
//src
%{
    exampleList = ["z", "y", "a", "b"]
}%

<ul>
#{list items:exampleList.sort(), as:'product'}
    <li>${product}</li>
#{/list}
</ul>
//rendered
<ul>
    <li>a</li>
    <li>b</li>
    <li>y</li>
    <li>z</li>
</ul> 
```

另外你可以给 sort() 一个 lambda 表达式如何排序，一些例子在这里： http: [//groovy.codehaus.org/JN1015-Collections](http://groovy.codehaus.org/JN1015-Collections)

但最好不要使用模板引擎来渲染 JSON。您可以使用控制器中的 Jackson [http://wiki.fasterxml.com/JacksonInFiveMinutes](http://wiki.fasterxml.com/JacksonInFiveMinutes)或使用控制器类中的 renderJson：[http://www.playframework.org/documentation/api/1.2.5/play/mvc/Controller。 .html](http://www.playframework.org/documentation/api/1.2.5/play/mvc/Controller.html) _ Palako 已经提示您在控制器中进行排序。

# iphone - 部分的 UITableView 调整标题不会根据其大小拉伸

> ID：13863558
> 
> 赞同：0
> 
> 时间：2012-12-13T15:55:52.380
> 
> 标签：iphone, xcode, uitableview, iphone-developer-program, sectionheader

我有一个表格视图，其中有表格视图的标题和部分的另一个标题。部分的标题顶部有一个按钮，当按下按钮时，我需要更改此标题的大小。

我确实更改了标题大小，但其中的内容没有相应改变。

我什至用这个修复了它-

```
_isHeaderExtended = !_isHeaderExtended;
[self.testTable beginUpdates];
CGPoint point = testTable.contentOffset;
point.y = (_isHeaderExtended)? point.y - 1: point.y + 1;

[testTable setContentOffset:point animated:NO];
[self.testTable endUpdates]; 
```

我的整个代码如下

```
-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section 
{

    return 30;
}

-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

    return testView;
}
-(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {

    [self.testTable beginUpdates];
    CGFloat fl = (_isHeaderExtended)?200:100;
    [self.testTable endUpdates];

    return fl;
}

-(IBAction)buttonPushed:(id)sender {
    _isHeaderExtended = !_isHeaderExtended;

    [self.testTable beginUpdates];
    CGPoint point = testTable.contentOffset;
    point.y = (_isHeaderExtended)? point.y - 1: point.y + 1;

    [testTable setContentOffset:point animated:NO];
    [self.testTable endUpdates];

} 
```

基本上我需要根据我使用的调整大小来拉伸标题的内容，有什么想法吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:28:13.957

做这个：

*   消除对`beginUpdate`和`endUpdate`in的调用`heightForHeaderInSection`。他们与`datasource`协议无关。

*   确保您在标题视图中返回的视图已按预期进行初始化和配置。大概你在`viewDidLoad`.

*   为了让标题的内容伸展，您可以将此视图设置`autoresizingMask`为所需的值。或者，您可以使用 IB 配置视图以使用容器视图调整大小。您必须在`viewForHeaderInSection`.

推荐的设计模式将完全不同：将大小的所有逻辑放入您的数据源方法（`heightForHeaderInSection`和`viewForHeaderInSection`）中，即您可以检查您的`_isHeaderExpanded`变量。然后，在切换方法中，只需重新加载该部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:30:36.843

我觉得应该改成：

```
-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
    if( _isHeaderExtended ){
        return bigTestView;
    } else {
        return smallTestView;
    }
}

-(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
    return _isHeaderExtended?200:100;
}

-(IBAction)buttonPushed:(id)sender {
    _isHeaderExtended = !_isHeaderExtended;
    [self.testTable reloadData];
} 
```

然后你需要为 header 创建一个 bigTestView 和一个 smallTestView。

# ios - 鉴于存折通行证得到保证，APNS 现在是否保证交付

> ID：13863560
> 
> 赞同：0
> 
> 时间：2012-12-13T15:55:58.573
> 
> 标签：ios

我只是在浏览一些关于存折的材料，并读到它已经保证交付。由于它基于 APN，这是否意味着使用与存折无关的 APN 的应用程序现在也可以获得保证交付？如果不是，为什么不呢，如果它可以用于存折 APNs？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:21:59.787

假设：“Apple 的推送通知服务（本次送达有保障）”。这是模糊的，并且来自没有进一步详细说明的第 3 方。有时间限制的通行证是根据时间显示的，而不是由于推送通知。

通行证更新确实是通知，出现的通行证不是。基本上保证交付很可能是不可能的，而且充其量会有很多警告，以至于无法保证。

# android - Android BitmapDrawable 从 url 加载

> ID：13863562
> 
> 赞同：0
> 
> 时间：2012-12-13T15:56:06.540
> 
> 标签：android, drawable, bitmapimage, bitmapfactory

如果我有 URL 字符串，例如`str_URL = "http://........ABC.png";`

如何将其添加到替换 R.drawable.jth 的下方？

```
BitmapDrawable frame1 = (BitmapDrawable)getResources().getDrawable(R.drawable.jth);
BitmapDrawable frame2 = (BitmapDrawable)getResources().getDrawable(R.drawable.jthj); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:00:05.630

Android 不允许直接将 URL 设置为 drawable 的源，您需要编写代码来下载文件，然后使用 bitmapfactory 创建您的 drawable。

如果您不想编写代码来执行此操作，则可以使用一些开源库，例如 Koush 的[URLImageViewer](https://github.com/koush/UrlImageViewHelper)，如果您想要在 ImageView 上显示您的可绘制对象

# python - 无法使用 python 在 v4l2loopback 设备上生成稳定的视频流

> ID：13863564
> 
> 赞同：2
> 
> 时间：2012-12-13T15:56:14.440
> 
> 标签：python, video-capture, v4l2

我正在为我的视频映射集开发流生成器，但我无法稳定图像。[我用python-v4l2](http://pypi.python.org/pypi/v4l2)打开一个 v4l2loopback 设备并通过它基于 png 生成一个视频流，因此可以在我的 vj 集中生成实时视频并静态视频映射它们并应用效果。

测试用例：1）加载v4l2loopback模块

2）运行蟒蛇：

```
import fcntl, numpy
from v4l2 import *
from PIL import Image
height = 600
width = 634
device = open('/dev/video4', 'wr')
print(device)
capability = v4l2_capability()
print(fcntl.ioctl(device, VIDIOC_QUERYCAP, capability))
print("v4l2 driver: " + capability.driver)
format = v4l2_format()
format.type = V4L2_BUF_TYPE_VIDEO_OUTPUT
format.fmt.pix.pixelformat = V4L2_PIX_FMT_RGB32
format.fmt.pix.width = width
format.fmt.pix.height = height
format.fmt.pix.field = V4L2_FIELD_NONE
format.fmt.pix.bytesperline = format.fmt.pix.width * 4
format.fmt.pix.sizeimage = format.fmt.pix.width * format.fmt.pix.height * 4
format.fmt.pix.colorspace = V4L2_COLORSPACE_SRGB
print(fcntl.ioctl(device, VIDIOC_S_FMT, format))
img = Image.open('img/0.png')
img = img.convert('RGBA')
while True:
    device.write(numpy.array(img)) 
```

3) 运行 Cheese 或其他 v4l2 流查看器。

结果是一个适当颜色和大小的图像，但它从左到右跳动每一帧，并且总是向左多一点，所以你得到一个滑动和跳跃的视频结果。我究竟做错了什么？

此致，

哈里博

ps：如果您想查看结果检查：[链接](http://www.facebook.com/vjharriebo)到目前为止，LiVES、puredate、gem 视频映射设置与 v4l2 流一起工作得很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T21:42:25.560

所以我得到了它的一种工作，但不确定它是否是正确的方法。我需要为稳定的视频流做些什么：

1）不要使用自定义分辨率，它们会变得混乱。

2）每帧发送两次。我认为这与隔行扫描/顶部/底部框架有关。

3）对于 640x480，将阵列中的所有像素向左移动 260 个空格，否则图像不是直的，而不是 1024x768 的...不知道为什么会这样。

4) 播放的帧速率略低，因为程序可以生成。

毕竟，它每 10 秒稳定 99%。大约有一个越野车框架。我认为程序生成的帧速率不是 100% 稳定的。

关于为什么或如何更好地做到这一点的建议仍然受到欢迎。

有关更新，请参阅：[https ://github.com/umlaeute/v4l2loopback/issues/32](https://github.com/umlaeute/v4l2loopback/issues/32)

# javascript - highcharts.js 自定义图表实现

> ID：13863567
> 
> 赞同：-1
> 
> 时间：2012-12-13T15:56:26.037
> 
> 标签：javascript, highcharts

我需要使用 JS [http://i.stack.imgur.com/6gusX.png](http://i.stack.imgur.com/6gusX.png)实现这样简单的图表 我查看了 highcharts.js lib，但我找不到现成的解决方案或类似图表。如果有人知道可以帮助实现它的工具，请提供帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:23:10.660

可以使用 Highcharts 来完成。

要**格式化标记**，请使用以下代码。

```
plotOptions: {
    // means all series types, you can change it according to the serie type
    series: {
        marker: {
            radius: 8,
            fillColor: '#FFFFFF',
            lineWidth: 2,
            lineColor: null
        }
    }
} 
```

[**演示**](http://jsfiddle.net/VnVAR/) [参考](http://api.highcharts.com/highstock#plotOptions.series.marker.lineColor)

然后**在标记内添加点值**。
我将使用前面的代码作为示例。
默认情况下，`dataLabels`被禁用，所以你必须`enable`然后设置它的`y`位置。

```
plotOptions: {
    // means all series types, you can change it according to the serie type
    series: {
        marker: {
            radius: 12,
            fillColor: '#FFFFFF',
            lineWidth: 2,
            lineColor: null
        },
        dataLabels: {
            enabled: true,
            y: 13,
            // default formatter
            formatter: function() {
                return this.y;
            }
        }
    }
} 
```

我更改了半径值，因为它太小而不能在里面放一个数字，你可以用`formatter`它来格式化它的数字。
[**演示**](http://jsfiddle.net/VnVAR/1/)

然后你必须设置**xAxys 标签的样式**。

```
xAxis: {
    labels: {
        style: {
            color: 'orange',
            fontWeight: 'bold',
            'font-size': '20px'
        }
    }
} 
```

这是结果[**。**](http://jsfiddle.net/VnVAR/2/)
当然，它并不完美。但它可能是，我只是想向你展示**使用 Highcharts 是可能的**，你有**很多选择**和一个很好的[**参考**](http://api.highcharts.com/highstock#plotOptions.series.dataLabels.formatter)可以帮助你。

# r - 从省略上三角部分的文件中读取对称矩阵

> ID：13863569
> 
> 赞同：2
> 
> 时间：2012-12-13T15:56:29.087
> 
> 标签：r, matrix, triangular

使用 R，从省略上三角部分的文件中读取对称矩阵的最佳方法是什么。例如，

```
1.000
.505  1.000
.569  .422  1.000
.602  .467  .926  1.000
.621  .482  .877  .874  1.000
.603  .450  .878  .894  .937  1.000 
```

我试过`read.table`了，但没有成功。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-13T17:22:51.927

这是一个 read.table 和 loopless 和 *apply-less 的解决方案：

```
txt <- "1.000
.505  1.000
.569  .422  1.000
.602  .467  .926  1.000
.621  .482  .877  .874  1.000
.603  .450  .878  .894  .937  1.000"
 # Could use clipboard or read this from a file as well.
mat <- data.matrix( read.table(text=txt, fill=TRUE, col.names=paste("V", 1:6))  )
mat[upper.tri(mat)] <- t(mat)[upper.tri(mat)]
> mat
        V1    V2    V3    V4    V5    V6 
[1,] 1.000 0.505 0.569 0.602 0.621 0.603
[2,] 0.505 1.000 0.422 0.467 0.482 0.450
[3,] 0.569 0.422 1.000 0.926 0.877 0.878
[4,] 0.602 0.467 0.926 1.000 0.874 0.894
[5,] 0.621 0.482 0.877 0.874 1.000 0.937
[6,] 0.603 0.450 0.878 0.894 0.937 1.000 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:02:01.667

我复制了你的文字，然后用来`tt <- file('clipboard','rt')`导入它。对于标准文件：

```
tt <- file("yourfile.txt",'rt')
a <- readLines(tt)
b <- strsplit(a,"  ") #insert delimiter here; can use regex
b <- lapply(b,function(x) {
  x <- as.numeric(x)
  length(x) <- max(unlist(lapply(b,length))); 
  return(x)
})
b <- do.call(rbind,b)
b[is.na(b)] <- 0
#kinda kludgy way to get the symmetric matrix
b <- b + t(b) - diag(b[1,1],nrow=dim(b)[1],ncol=dim(b)[2] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:20:39.980

我正在发帖，但我更喜欢 Blue Magister 的方法。但也许这里面有些东西是有用的。

```
mat <- readLines(n=6)
1.000
.505  1.000
.569  .422  1.000
.602  .467  .926  1.000
.621  .482  .877  .874  1.000
.603  .450  .878  .894  .937  1.000

nmat <- lapply(mat, function(x) unlist(strsplit(x, "\\s+")))
lens <- sapply(nmat, length)
dlen <- max(lens) -lens
bmat <- lapply(seq_along(nmat), function(i) {
    as.numeric(c(nmat[[i]], rep(NA, dlen[i])))
})
mat <- do.call(rbind, bmat)
mat[upper.tri(mat)] <- t(mat)[upper.tri(mat)]
mat 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-13T18:30:26.233

如果矩阵的维度未知，这是一种方法。

```
# read file as a vector
mat <- scan("file.txt", what = numeric())

# calculate the number of columns (and rows)
ncol <- (sqrt(8 * length(mat) + 1) - 1) / 2

# index of the diagonal values
diag_idx <- cumsum(seq.int(ncol))

# generate split index
split_idx <- cummax(sequence(seq.int(ncol)))
split_idx[diag_idx] <- split_idx[diag_idx] - 1

# split vector into list of rows
splitted_rows <- split(mat, f = split_idx)

# generate matrix
mat_full <- suppressWarnings(do.call(rbind, splitted_rows))
mat_full[upper.tri(mat_full)] <- t(mat_full)[upper.tri(mat_full)]

   [,1]  [,2]  [,3]  [,4]  [,5]  [,6]
0 1.000 0.505 0.569 0.602 0.621 0.603
1 0.505 1.000 0.422 0.467 0.482 0.450
2 0.569 0.422 1.000 0.926 0.877 0.878
3 0.602 0.467 0.926 1.000 0.874 0.894
4 0.621 0.482 0.877 0.874 1.000 0.937
5 0.603 0.450 0.878 0.894 0.937 1.000 
```

# javascript - 模块的RequireJS回调依赖

> ID：13863571
> 
> 赞同：1
> 
> 时间：2012-12-13T15:56:36.297
> 
> 标签：javascript, requirejs

我们正在构建使用 RequireJS 进行模块化开发/依赖管理的 Web 应用程序。
我们使用以下方法来解决问题：

```
<script data-main="js/main" src="js/libs/require/require.js"></script> 
```

Web 应用程序还使用与大型机系统通信所需的第三方小程序。小程序有一个回调函数，一旦与它通信的 api 初始化后执行，api 对象作为参数传入。例如

```
/*
 * This function is invoked automatically after the Reflection session has 
 * completed its initialization. A reference to the JavaScript API is passed
 * in as a parameter.
 */
 function jsapiInitialized( api ) {

    return api;

 } 
```

基本上，以上内容需要成为应用程序中许多模块的依赖项。

**如何使上述函数成为模块依赖项，以便那些需要它的模块可以使用 api 对象？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T18:19:45.993

您似乎想`define`为您的 API 使用类似异步的方法。要使用 require.js，您需要[创建](http://requirejs.org/docs/plugins.html)一个小插件。结果，您将拥有以下文件：

**1）myapi.js**（API模拟文件）

```
// this is actually simulation of your third party code
setTimeout(function() {
    if(typeof jsapiInitialized === 'function') jsapiInitialized('hello!');
}, 1000); 
```

**2) myplugin.js** (处理你的 API 回调的插件)

```
define(function(){
    return {
        load : function(name, req, onLoad, config){
            window.jsapiInitialized = function(api) {
                onLoad(api);
            };
            require([name]);
        }
    };
}); 
```

**3) main.js** (测试你的插件)

```
require(['myplugin!myapi'], function(api){
    alert(api);
}); 
```

（其中*“myapi”*可以是您真正的 API 脚本的路径）

# robots.txt - robots.txt 中的通用规则

> ID：13863586
> 
> 赞同：1
> 
> 时间：2012-12-13T15:57:09.787
> 
> 标签：robots.txt

我怎样才能禁止像`1.html, 2.html, ..., [0-9]+.html`（就正则表达式而言）这样的 URL `robots.txt`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T14:31:53.500

原始 robots.txt 规范不支持正则表达式/通配符。但是，您可以阻止以下 URL：

*   example.com/1.html
*   example.com/2367123.html
*   example.com/3
*   example.com/4/foo
*   example.com/5/1
*   example.com/6/
*   example.com/7.txt
*   example.com/883
*   example.com/9to5
*   …</li>

和：

```
User-agent: *
Disallow: /0
Disallow: /1
Disallow: /2
Disallow: /3
Disallow: /4
Disallow: /5
Disallow: /6
Disallow: /7
Disallow: /8
Disallow: /9 
```

如果您只想阻止以单个数字开头的 URL，后跟`.html`，只需附加`.html`，例如：

```
User-agent: *
Disallow: /0.html
Disallow: /1.html
… 
```

但是，这*不会*阻止，例如，`example.com/12.html`

# php - 验证链接在 gmail 中不起作用

> ID：13863587
> 
> 赞同：0
> 
> 时间：2012-12-13T15:57:09.350
> 
> 标签：php, validation, cookies, gmail, hyperlink

我向用户发送了一个点击链接，以验证他的帐户。

一切都很顺利，直到我有了从`Gmail`地址测试它的想法。当用户从网站发送他的请求时，他已经有义务选择一种存储在 cookie 中的语言。

我有`Firefox`作为默认浏览器。它适用于所有其他电子邮件客户端，例如`Yahoo`，但不适用于.`Hotmail``Windows Mail``Gmail`

**错误是，当点击链接时，会打开一个新页面（和以往一样），但会显示 cookie 选择页面并要求一次又一次地选择语言。**

此代码段用于设置语言 cookie：

```
setcookie("language",$_GET["language"],time()+730*24*3600,NULL, NULL, NULL,TRUE); 
```

其他 cookie 在 index 上使用以下规则设置：

`session_set_cookie_params(0, NULL, NULL, NULL, TRUE);`

以下格式的链接用于验证用户（已修改）：

[http://www.example.com/index.php?%09%09page=validate&code=7c222fb2927d828af22f592134e8932480637c0d&user=some.random.user%40gmail.com&confirm=e34054aca67d77bb76fe62019ef331c7e2a0a4b9](http://www.example.com/index.php?%09%09page=validate&code=7c222fb2927d828af22f592134e8932480637c0d&user=some.random.user%40gmail.com&confirm=e34054aca67d77bb76fe62019ef331c7e2a0a4b9)

这意味着用户`Gmail`将无法进行身份验证。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T09:40:56.193

我终于找到了原因：

我的代码是这样缩进的：

[http://www.example.com/index.php?%09%09page=](http://www.example.com/index.php?%09%09page=) validate&code=7c222fb2927d828af22f592134e8932480637c0d&user=some.random.user%40gmail.com& confirm=e34054aca67d77bb76fe62019ef331c7e2a0a4b9

**这不会导致我测试过的任何电子邮件提供商出现错误，除了`Gmail`!**

**`%09%09`**它在 the 之后插入 a ，`equal`因此验证失败，因为它没有到达它的目标页面。

希望这能有所帮助。

# xml - C#搜索列表函数

> ID：13863591
> 
> 赞同：0
> 
> 时间：2012-12-13T15:57:23.203
> 
> 标签：xml, list, search

我有一个包含配料和收据的 XML 文件。我现在想创建一个搜索功能，例如，如果用户搜索“千层面”，它将找到千层面的食谱并显示它。关于如何开始的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:01:33.003

最简单的方法是使用[LINQ to XML](http://msdn.microsoft.com/en-us/library/bb308960.aspx)。

# multithreading - 具有自定义 ORM 的多租户 NServiceBus 工作单元

> ID：13863596
> 
> 赞同：0
> 
> 时间：2012-12-13T15:57:41.627
> 
> 标签：multithreading, orm, nservicebus, multi-tenant, unit-of-work

这是我的参数：

*   使用默认构建器的简单 NServiceBus Saga 实现
*   基于 SQL Server 的内部 ORM
*   多租户 - 我有两个 ASP.NET MVC 4 域在同一个网站上运行，每个域都有自己的数据库

我们使用静态方法配置我们的 ORM，如下所示：

```
public class EndpointConfig: IConfigureThisEndpoint, IWantCustomInitialization {
  public void Init() {
    var bus = Configure.With()
      .AutofacBuilder()
      .UnicastBus().LoadMessageHandlers().DoNotAutoSubscribe()
      .XmlSerializer()
      .MsmqTransport().IsTransactional(true).PurgeOnStartup(false)
      .MsmqSubscriptionStorage()
      .Sagas().RavenSagaPersister().InstallRavenIfNeeded()
      .UseInMemoryTimeoutPersister()
      .CreateBus()
      .Start();

     SlenderConfiguration.Init(bus);
  }
}

public class SlenderCofnigruation {
  private static ORMScope scope { get; set; }

  public static void Init(IBus bus)
  {
    ORMConfig.GetScope = () =>
    {
       var environment = "dev";
       if (bus.CurrentMessageContext.Headers.ContainsKey("Environment"))
         environment = bus.CurrentMessageContext.Headers["Environment"];

       if (scope == null)
         scope = new SlenderScope(ConfigurationManager.ConnectionStrings[environment].ConnectionString);
      return scope;
    };
  }
} 
```

这在我们的单租户 Beta 环境中运行良好 - 可以重新使用该静态范围，因为环境标头对于给定的部署总是相同的。

据我了解，这*不适*用于上述多租户情况，因为 NServiceBus 将跨消息重用线程。然后将使用相同的范围，如果消息用于不同的环境，则会导致问题。

我想我想要的是每条消息有一个范围，但我真的不确定如何到达那里。

我已经看过[RavenDB](http://nservicebus.com/UnitOfWorkImplementationForRavenDB.aspx)的工作单元实现，以及全双工示例中的工作单元实现，但我不确定这是正确的路径。

我也看到了 DependencyLifecycle 枚举，但我不确定如何使用它来解析范围，因为我必须设置 GetScope 函数。

显然我不知道这里发生了什么。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T13:56:45.877

如果您需要在每条消息的基础上执行某些操作，请考虑使用消息修改器 (IMutateIncomingMessages) 以及具有某些线程静态状态的工作单元管理。

# string - 在字符串的特定位置插入字符

> ID：13863599
> 
> 赞同：68
> 
> 时间：2012-12-13T15:57:44.987
> 
> 标签：string, r

我想在字符串的特定位置插入一个额外的字符（或新字符串）。例如，我想`d`在第四个位置插入`abcefg`以获取`abcdefg`.

现在我正在使用：

```
old <- "abcefg"
n <- 4
paste(substr(old, 1, n-1), "d", substr(old, n, nchar(old)), sep = "") 
```

我可以为这个任务写一个简单的函数，但我只是好奇是否有一个现有的函数。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-12-13T16:05:42.227

您可以使用正则表达式和`gsub`.

```
gsub('^([a-z]{3})([a-z]+)$', '\\1d\\2', old)
# [1] "abcdefg" 
```

如果要动态执行此操作，可以使用以下命令创建表达式`paste`：

```
letter <- 'd'
lhs <- paste0('^([a-z]{', n-1, '})([a-z]+)$')
rhs <- paste0('\\1', letter, '\\2')
gsub(lhs, rhs, old)
# [1] "abcdefg" 
```

* * *

根据 DWin 的评论，您可能希望这更笼统。

```
gsub('^(.{3})(.*)$', '\\1d\\2', old) 
```

这样，任何三个字符都将匹配，而不仅仅是小写。DWin 还建议使用`sub`而不是`gsub`. 这样你就不必担心`^`因为`sub`只会匹配第一个实例。但我喜欢在正则表达式中明确表达，并且只在我理解它们并发现需要更多通用性时才转向更一般的表达式。

* * *

正如 Greg Snow 所指出的，您可以使用另一种形式的正则表达式来查找匹配项：

```
sub( '(?<=.{3})', 'd', old, perl=TRUE ) 
```

`gsub`并且还可以使用`sprintf`而不是在上面构建我的动态`paste0`：

```
lhs <- sprintf('^([a-z]{%d})([a-z]+)$', n-1) 
```

或者他的`sub`正则表达式：

```
lhs <- sprintf('(?<=.{%d})',n-1) 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2017-08-17T14:44:25.263

`stringi`再次为救援包！提供的解决方案中最简单和优雅的解决方案。

`stri_sub`函数允许您提取部分字符串并替换它的部分，如下所示：

```
x <- "abcde"
stri_sub(x, 1, 3) # from first to third character
# [1] "abc"
stri_sub(x, 1, 3) <- 1 # substitute from first to third character
x
# [1] "1de" 
```

但如果你这样做：

```
x <- "abcde"
stri_sub(x, 3, 2) # from 3 to 2 so... zero ?
# [1] ""
stri_sub(x, 3, 2) <- 1 # substitute from 3 to 2 ... hmm
x
# [1] "ab1cde" 
```

然后不会删除任何字符，但会插入新字符。这不是很酷吗？:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-13T16:18:49.243

@Justin 的答案是我实际处理这个问题的方式，因为它具有灵活性，但这[也](http://onertipaday.blogspot.in/2007/06/string-manipulation-insert-delim.html)可能是一种有趣的方法。

您可以将字符串视为“固定宽度格式”并指定要插入字符的位置：

```
paste(read.fwf(textConnection(old), 
               c(4, nchar(old)), as.is = TRUE), 
      collapse = "d") 
```

使用 时的输出特别好`sapply`，因为您可以将原始字符串视为“名称”。

```
newold <- c("some", "random", "words", "strung", "together")
sapply(newold, function(x) paste(read.fwf(textConnection(x), 
                                          c(4, nchar(x)), as.is = TRUE), 
                                 collapse = "-WEE-"))
#            some          random           words          strung        together 
#   "some-WEE-NA"   "rand-WEE-om"    "word-WEE-s"   "stru-WEE-ng" "toge-WEE-ther" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-21T00:00:10.187

您这样做的原始方式（即在索引处拆分字符串并粘贴到插入的文本中）可以做成一个通用函数，如下所示：

```
split_str_by_index <- function(target, index) {
  index <- sort(index)
  substr(rep(target, length(index) + 1),
         start = c(1, index),
         stop = c(index -1, nchar(target)))
}

#Taken from https://stat.ethz.ch/pipermail/r-help/2006-March/101023.html
interleave <- function(v1,v2)
{
  ord1 <- 2*(1:length(v1))-1
  ord2 <- 2*(1:length(v2))
  c(v1,v2)[order(c(ord1,ord2))]
}

insert_str <- function(target, insert, index) {
  insert <- insert[order(index)]
  index <- sort(index)
  paste(interleave(split_str_by_index(target, index), insert), collapse="")
} 
```

示例用法：

```
> insert_str("1234567890", c("a", "b", "c"), c(5, 9, 3))
[1] "12c34a5678b90" 
```

这允许您在索引向量给定的位置插入字符向量。和函数本身也很有用`split_str_by_index`。`interleave`

**编辑：**

我修改了代码以允许任何顺序的索引。以前，索引需要按升序排列。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-11-15T22:19:05.203

我制作了一个自定义函数`substr1`来处理在字符串中提取、替换和插入字符。在每个会话开始时运行这些代码。随意尝试一下，如果需要改进，请告诉我。

```
# extraction
substr1 <- function(x,y) {
  z <- sapply(strsplit(as.character(x),''),function(w) paste(na.omit(w[y]),collapse=''))
  dim(z) <- dim(x)
  return(z) }

# substitution + insertion
`substr1<-` <- function(x,y,value) {
  names(y) <- c(value,rep('',length(y)-length(value)))
  z <- sapply(strsplit(as.character(x),''),function(w) {
    v <- seq(w)
    names(v) <- w
    paste(names(sort(c(y,v[setdiff(v,y)]))),collapse='') })
  dim(z) <- dim(x)
  return(z) }

# demonstration
abc <- 'abc'
substr1(abc,1)
# "a"
substr1(abc,c(1,3))
# "ac"
substr1(abc,-1)
# "bc"
substr1(abc,1) <- 'A'
# "Abc"
substr1(abc,1.5) <- 'A'
# "aAbc"
substr1(abc,c(0.5,2,3)) <- c('A','B')
# "AaB" 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-01-12T21:31:27.450

我花了一些时间来理解正则表达式，之后我找到了我的数字

最终结果是

```
old <- "89580000"
gsub('^([0-9]{5})([0-9]+)$', '\\1-\\2', old) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-01T06:10:17.980

和你的一样！

首先确保加载 tidyverse 包，然后同时使用 paste0 和 gsub。

这是确切的代码：

```
paste0(substr(old, 1,3), "d", substr(old,4,6)) 
```

# actionscript-3 - 单击按钮操作脚本时如何显示文本

> ID：13863601
> 
> 赞同：0
> 
> 时间：2012-12-13T15:57:49.627
> 
> 标签：actionscript-3, flash

单击动作脚本中的按钮时如何显示文本？使用动作脚本单击按钮时如何消失文本？

请让我知道如何使用操作脚本执行此操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:05:54.113

```
var TextBoxExample:TextField = new TextField();
stage.addChild(TextBoxExample);
TextBoxExample.text = "Example Text!";
TextBoxExample.visible=true;

ExampleButton.addEventListener(MouseEvent.CLICK, function(event:MouseEvent):void{
if(TextBoxExample.visible==true){
TextBoxExample.visible=false;
}else{
TextBoxExample.visible=true;
}
}); 
```

# jasper-reports - 在 MacOS 上的 iReport 中找不到字体文件夹

> ID：13863604
> 
> 赞同：1
> 
> 时间：2012-12-13T15:57:57.580
> 
> 标签：jasper-reports, ireport

我在 MacOS 上使用 iReport 3.7.4 版进行开发。其中一个模板是使用自定义字体，我已经安装了它。现在，当我尝试切换到预览时，会抛出以下异常：

net.sf.jasperreports.engine.JRException：java.io.FileNotFoundException：/Applications/iReport.app/Contents/Resources/ireport/ireport/fonts（没有这样的文件或目录）

我能够在我的 Finder 中导航到该文件夹​​，它存在。我不知道为什么 iReport 抱怨这条路。

请指教。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T14:48:46.067

在我的情况下（在 Linux 上）我有一个图像 url 参数，并且必须像这样将属性**isForPropmting**显式设置为 false：

```
<parameter name="LOGO_URL" class="java.lang.String" isForPrompting="false">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
</parameter> 
```

# java - 从java中的排列列表创建char数组的算法

> ID：13863607
> 
> 赞同：0
> 
> 时间：2012-12-13T15:58:05.340
> 
> 标签：java, algorithm

我很抱歉标题有点混乱，我不确定如何表达它。

我需要创建一个 char 数组，以允许字符集的所有可能排列。

如果我给你：

```
char[] charSet = {"a", "b", "c"};
BigInteger value = n; //where n is a number >= 0
char[] charArray = createCharArray(value, charSet); 
```

如何从 value 和 charSet 创建 charArray ，这样如果我运行：

```
createCharArray(new BigInteger("6"), {"a", "b", "c"}); 
```

它会返回 {"a", "c"} 因为

*   a=1
*   b=2
*   c=3
*   aa=4
*   ab=5
*   ac=6

这是我到目前为止所拥有的：

```
private char[] createCharArray(BigInteger value, char[] charSet){
    List<Character> charArray = new ArrayList<Character>();

    if (value.compareTo(this.max) == 0)
        System.out.println("");

    BigInteger csSize = new BigInteger(String.valueOf(charSet.length));

    if(this.powers.isEmpty())
        this.powers.add(0, csSize.pow(0));
    if(this.sumPowers.isEmpty())
        this.sumPowers.add(0, csSize.pow(0));

    BigInteger curPow;
    int i = 1;

    while((curPow = csSize.pow(i)).compareTo(value) <= -1){
        if(this.powers.size() <= i)
            this.powers.add(i, curPow);

        if(this.sumPowers.size() <= i)
            this.sumPowers.add(i, this.sumPowers.get(i-1).add(curPow)); 

        i += 1;
    }

    i -= 1;

    while (i >= 0 && value.compareTo(BigInteger.ZERO) >= 0){
        if (i <= 1){
            int charNum = value.divide(this.sumPowers.get(0)).intValue() - 1;
            charArray.add(charSet[charNum]);
        }
        else{
            int charNum = value.divide(this.sumPowers.get(i-1).subtract(BigInteger.ONE)).intValue() - 1;
            charArray.add(charSet[charNum]);
        }
        value = value.subtract(this.powers.get(i));
        i -= 1;
    }

    char[] returnArray = new char[charArray.size()];

    int j = 0;

    while(j<charArray.size()){
        returnArray[j] = charArray.get(j);
        j += 1;
    }

    return returnArray;
} 
```

它当然可以使用一些帮助，因为值 0 失败，值 1 和 2 成功，3-8 失败，9、10 成功，等等。

编辑：要清楚，值参数必须能够是任何数字 n > 0。这就是我选择 BigInteger 的原因

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:46:13.437

创建一个有两个字段的类：

```
private char letter;
private int value;
public <classname>(char letter){
this.letter = letter;
value = 0;
}
//Setters and getters 
```

然后在初始化数组时（通过for循环）将值设置为i + 1（摆脱0）

```
for(int i = 0; i < <yourarray>.length; i ++){
    //Assuming you initialized your objects before
    <yourarray>[i].<setterforvalue>(i + 1);
} 
```

然后一起计算它们：

```
for(int i = 0; i < <yourarray>.length; i ++){
    for(int j = 0; j < <yourarray>.length; j ++){
     if(<yourarray>[i] + <yourarray>[j] == <needednumber>){
       //Do what you need to do with the value
     }
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T04:23:56.667

好的，经过深思熟虑，最终将其分解为使用数字 0-9 而不是字符。以下是细分：想想常规的以 10 为基数的数字是如何创建的。

数字 194 由个列中的 4、十位中的 9 和百位中的 1 组成。个、十和百之间的差异是乘/除以 10，这是基数。

所以我想我可以通过基数（10）修改 194 以获得 4 个。然后除以 10 以删除那些列。再次 mod 得到 9，然后除以 10，再次 mod 得到 1，除以 10。一旦除法创建一个正好为 0 的数字，我们就完成了。这是因为我们无法创建数字 000194。

对于我的函数，我的基数是字符集的长度，在上面的例子中这个值是 194。

```
private static void createCharArray(BigInteger value, char[] charSet){
    List<Character> charArray = new ArrayList<Character>();

    BigInteger csSize = BigInteger.valueOf(charSet.length);

    if (value.compareTo(BigInteger.ZERO) == 0)
        charArray.add(0, charSet [0]);
    else{
        BigInteger modded = value.mod(csSize);
        BigInteger digit  = value.divide(csSize);

        while (modded.compareTo(BigInteger.ZERO) != 0 || digit.compareTo(BigInteger.ZERO) != 0){
            if(modded.compareTo(BigInteger.ZERO) == 0){
                charArray.add(0, charSet[csSize.subtract(BigInteger.ONE).intValue()]);
                value = value.subtract(BigInteger.ONE);
            }
            else
                charArray.add(0, charSet[modded.subtract(BigInteger.ONE).intValue()]);
            value = value.divide(csSize);

            modded = value.mod(csSize);
            digit  = value.divide(csSize);
        }
    }

    for(char c : charArray)
        System.out.print(c);
    System.out.println();

}

public static void main(String[] args) {
    long start = System.nanoTime();
    String characters = "";
    characters += "0123456789";
    characters += "abcdefghijklmnopqrstuvwxyz";
    characters += "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    characters += " !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";

    char[] cs = characters.toCharArray();
    Arrays.sort(cs);

    createCharArray(new BigInteger("1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890"), cs);
    long total = System.nanoTime() - start;
    System.out.println("Completed in: " + total + " billionths of a second");
    System.out.println("Completed in: " + total/1000000 + " thousandth(s) of a second");
} 
```

如果您运行它，请注意 BigInteger 底部的 4 行是 100 个字符长。在我的机器上，它只需要 1/1000 秒（1 毫秒）。

# php - 使用android和php进行Socket编程

> ID：13863610
> 
> 赞同：4
> 
> 时间：2012-12-13T15:58:10.310
> 
> 标签：php, android, sockets

我正在尝试创建一个使用套接字连接到 php 服务器的 Android 应用程序。下面是我用于实现套接字服务器的 php 代码。

```
<?php
    set_time_limit (0);
    $address = '127.0.0.1';
    $port = 8111;
    $sock = socket_create(AF_INET, SOCK_STREAM, 0);
    socket_bind($sock, $address, $port) or die('Could not bind to address');
    socket_listen($sock);
    $client = socket_accept($sock);
    $input = socket_read($client, 1024);
    $output = $input;
    socket_write($client, $output);
    socket_close($client);
    socket_close($sock);
?> 
```

Android客户端代码：

```
package com.example.simpleclient;

import com.example.simpleclient.util.SystemUiHider;

import java.io.BufferedWriter;
import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.view.View;

/**
 * An example full-screen activity that shows and hides the system UI (i.e.
 * status bar and navigation/system bar) with user interaction.
 * 
 * @see SystemUiHider
 */
public class FullscreenActivity extends Activity {
    private Button bt;
       private TextView tv;
       private Socket socket;
       private String serverIpAddress = "192.168.2.11";
       // AND THAT'S MY DEV'T MACHINE WHERE PACKETS TO
       // PORT 5000 GET REDIRECTED TO THE SERVER EMULATOR'S
       // PORT 6000
       private static final int REDIRECTED_SERVERPORT = 8111;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_fullscreen);
          bt = (Button) findViewById(R.id.myButton);
          tv = (TextView) findViewById(R.id.myTextView);
          try {
             InetAddress serverAddr = InetAddress.getByName(serverIpAddress);
             socket = new Socket(serverAddr, REDIRECTED_SERVERPORT);
          } catch (UnknownHostException e1) {
             e1.printStackTrace();
          } catch (IOException e1) {
             e1.printStackTrace();
          }
          bt.setOnClickListener(new OnClickListener() {
             public void onClick(View v) {
                try {
                   EditText et = (EditText) findViewById(R.id.EditText01);
                   String str = et.getText().toString();
                   PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream())),true);
                   out.println(str);
                   Log.d("Client", "Client sent message");
                } catch (UnknownHostException e) {
                   tv.setText("Error1");
                   e.printStackTrace();
                } catch (IOException e) {
                   tv.setText("Error2");
                   e.printStackTrace();
                } catch (Exception e) {
                   tv.setText("Error3");
                   e.printStackTrace();
                }
             }
          });
    }

} 
```

192.168.2.11 是我托管服务器的系统的 ip。我附上了我的 android 代码中断的调试器屏幕截图。请看一看。

我无法将 android 应用程序连接到 php 服务器

![错误图像](../Images/81de85cdaa5f57596b1df29f573f94d3.png)

# javascript - IE8 中的 Javascript 弹出文本限制

> ID：13863614
> 
> 赞同：0
> 
> 时间：2012-12-13T15:58:16.963
> 
> 标签：javascript

通过 javascript/jquery 中的弹出窗口可以调用的文本数量是否有任何限制？

我有一个在 IE9、FF 等中运行良好但在 IE8 中无法运行的弹出窗口

字数是2667，IE8有什么限制，可以通过代码修复吗？

更新：当我编辑文本时，弹出窗口有效。仍然好奇为什么 IE8 无法加载

谢谢

RG

# serialization - Guava - 可以序列化 Multimap 吗？

> ID：13863616
> 
> 赞同：6
> 
> 时间：2012-12-13T15:58:25.223
> 
> 标签：serialization, guava, multimap

我正在查看[`ArrayListMultiMap`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/ArrayListMultimap.html)实现该`Serializable`接口的 API。这是否意味着我可以序列化这个对象？是否所有 Multimap 对象都已序列化？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T16:19:22.513

的含义`Serializable`始终相同：如果对象不可序列化，则无法序列化。如果是，它可能工作或不工作......特别是在集合（包括地图和多地图）的情况下，这取决于它们的内容。

例如，您当然可以`ArrayList<String>`按可序列化的`ArrayList.class`方式进行序列化，列表中的每个成员也是如此。OTOH 尝试序列化`ArrayList<Object>`可能会或可能不会起作用：如果所有包含的对象都是字符串，它会起作用。如果任何成员不可序列化，您将收到异常。

> 这是否意味着我可以序列化这个对象？

如果所有键和值都是可序列化的，则可以。

> 所有 multiMap 对象都是可序列化的吗？

不，接口`Multimap`不扩展`Serializable`，因此可能存在不可序列化的实现。事实上，您可以通过 eg 获得这样的实例`Multimaps.filterEntries`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-03T16:21:10.140

`ArrayListMultimap`并且`HashMultimap`是`Serializable`但是`Collection`视图（`asMap()`例如）不是。

这个问题[在这里](https://stackoverflow.com/questions/8488394/guava-setmultimap-not-serializable-due-to-not-serializable-wrappedset)得到解答：

要使用返回的地图`asMap()`，您可以重新创建一个新地图并将 Multimap`Collection`视图包装到其他集合（例如 a `Set`）中，这将创建新地图`Serializable`：

```
Multimap<MyClass, MyOtherClass> myMultiMap = HashMultimap.create();
// ... build your multimap
Map<MyClass, Set<MyOtherClass>> map = myMultiMap.asMap().entrySet()
    .stream()
    .collect(Collectors.toMap( 
        Map.Entry::getKey, 
        (entry) -> ImmutableSet.copyOf(entry.getValue()) 
    )); 
```

或符合 java 7 的代码：

```
Multimap<MyClass, MyOtherClass> myMultiMap = HashMultimap.create();
// ... build your multimap
Map<MyClass, Set<MyOtherClass>> map = Maps.newHashMap();
for (Map.Entry<MyClass, Collection<MyOtherClass>> entry : 
myMultiMap.asMap().entrySet()) {
    map.put(entry.getKey(), ImmutableSet.copyOf(entry.getValue()));
} 
```

# android - 在 Android 复合可绘制对象上绘图

> ID：13863617
> 
> 赞同：0
> 
> 时间：2012-12-13T15:58:26.937
> 
> 标签：android, button, drawable, android-canvas

我正在尝试在常规旧 Android 按钮的 Compound Drawable 上画一条线。我一开始只是尝试使用按钮的可绘制对象，`Button.getCompoundDrawables()[1]`但线条永远不会出现。因此，我继续在我的 XML 布局中为按钮上的复合可绘制对象放置了一个实际图像。这可以正常工作（图片中的橙色方块）但是当手机旋转时，橙色方块不会调整大小，与按钮成比例，所以它最终太大了。我是否需要要求`getBounds()`轮换或其他什么？

必须对drawable进行一些调整，因为如果您注意到，红线会在水平方向上到达角落，而不是在垂直方向上；它关闭或什么的。橙色方块在 drawable-[lhm]dpi/ 目录中以不同的尺寸存在，但我没有水平和垂直两种单独的布局。

画线代码：

```
 @Override
            public View getView (int position, View convertView, ViewGroup parent)
            {           
                View row = convertView;
                if (row == null)
                {
                    LayoutInflater inflater = (LayoutInflater) _context.getSystemService (Context.LAYOUT_INFLATER_SERVICE);
                    row = inflater.inflate (R.layout.monthview, parent, false);

                }

                btn_cell = (Button) row.findViewById (R.id.bcell);
...
                    BitmapDrawable btn_draw = (BitmapDrawable) btn_cell.getCompoundDrawables ()[1];

                    if (btn_draw != null)
                    {
                        Log.d (TAG, "+++++++++++++ drawing line");
                        Bitmap btn_bmp = btn_draw.getBitmap ();
                        Bitmap offscreen_bmp = Bitmap.createBitmap(btn_bmp.getWidth(), btn_bmp.getHeight(), btn_bmp.getConfig());
                        BitmapDrawable offscreen_draw = new BitmapDrawable (offscreen_bmp);
                        offscreen_draw.setBounds (btn_draw.getBounds ());

                        Canvas c = new Canvas(offscreen_bmp);

                        // draw line
                        Paint p = new Paint();
                        p.setAntiAlias(true);
                        p.setStrokeWidth(1);
                        p.setStyle(Style.FILL_AND_STROKE);
                        p.setColor(Color.RED);

                        c.drawBitmap (btn_bmp, 0, 0, p);
                        c.drawLine (0, 0, offscreen_bmp.getWidth (), offscreen_bmp.getHeight (), p);

                        (R.drawable.cal_left_arrow_off), null, null);
                        btn_cell.setCompoundDrawables(null, offscreen_draw, null, null);
                    } 
```

![在此处输入图像描述](../Images/4289b4fb3da3acbda21af57e21eebba7.png) ![在此处输入图像描述](../Images/e26537239f1e16335628600ba5310b4b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:38:03.297

万一它对其他人有帮助，我最终取消了按钮，而是使用了 ImageView。我遇到了一个（显然）典型的问题，即如何在 ImageView 上画一条线。我知道在方法中对 ImageView 进行子类化和画线`onDraw()`，但是我不知道您可以在 Eclipse 的 XML 布局 GUI 中引用那个“自定义”子类。我需要做的就是创建一个 myImageView 类，然后在 XML 源代码中引用它。而不是指定`<ImageView>`我需要使用`<com.example.myImageView>`并且一切正常。

我在自定义 BaseAdapter 中使用 myImageView ，因此在方法中将行放在 myImageView 上`getView()`只是一个问题：

```
 myImageView iv = (myImageView) row.findViewById (R.id.iv_draw);
        iv.setBarLength (15);
        iv.setOnClickListener (ocl); 
```

com.example.test.myImageView.java：

```
public class myImageView extends android.widget.ImageView
{
    private final String TAG = this.getClass ().getName ();
    private int mBarLen = 5;

    /**
     * @param context
     * @param attrs
     */
    public myImageView (Context context, AttributeSet attrs)
    {
        super (context, attrs);
    }

    public void setBarLength (int length)
    {
        mBarLen = length;
    }

    @Override
    protected void onDraw (Canvas canvas)
    {
        super.onDraw (canvas);

        // draw 1px border
        Paint p = new Paint ();

        int x = 1;
        int y = 1;
        Rect bounds = canvas.getClipBounds ();

        int x2 = bounds.right - 1;
        int y2 = bounds.bottom - 1;

        canvas.drawLine (x, y, x2, y, p);
        canvas.drawLine (x2, y, x2, y2, p);
        canvas.drawLine (x2, y2, x, y2, p);
        canvas.drawLine (x, y2, x, y, p);

        p.setColor (Color.RED);
        p.setStrokeWidth (2);
        int bx = x + 5;
        int by = y + 5;
        canvas.drawLine (bx, by, bx+mBarLen, by, p);
        canvas.drawLine (bx, by, bx+mBarLen, by, p);

    }

} 
```

xml文件：

```
<com.example.test.myImageView
    android:id="@+id/iv_draw"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:adjustViewBounds="true"
    android:minHeight="48dp"
    android:minWidth="24dp"
    android:scaleType="fitXY" /> 
```

# c# - 正则表达式匹配该行的最后一个单词

> ID：13863624
> 
> 赞同：1
> 
> 时间：2012-12-13T15:58:46.480
> 
> 标签：c#, .net, regex, match

我有这个 HTML

```
<br />
<strong>Name:</strong> Josef
<br /> 
```

在这种情况下，我想匹配名称“Josef”。我有一些问题，因为如果您不将 m 与正则表达式一起使用，Josef 是该字符串的最后一个单词。我的方法

```
^<strong>Name:</strong> (.*?)$ 
```

似乎不起作用，这是如何正确完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:13:59.677

如果您的 HTML 字符串像看起来那样有两个文字换行符，您需要将您的正则表达式设置为多[行模式](http://msdn.microsoft.com/en-us/library/yd1hzczs.aspx#Multiline)，以便`$`匹配.`end-of-line``end-of-string`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:01:35.810

你应该使用`html parser`而不是`regex`

* * *

但如果你还需要它

你可以做

```
<strong>Name:</strong>\s*(\w+) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T20:47:28.340

亲爱的马蒂亚斯·瓦尔德基歇尔，

两种解决方案：

1）使用你的表达：

```
"(?:^|\n)<strong>Name:</strong> (.*?)(?:$|\r)" 
```

2) 用其他表达方式：

```
"</strong>\s(.*?)(?:\r|$)" 
```

在这两种解决方案中，您想要的匹配都将是匹配对象 match.Groups[1].Value 的这个道具中的一个。

使用的元字符：

```
(?:) // unamed/unumered group;
\n // new line;
\r // carriage return;
^ // beginning of the input;
| // or
() // numered group,
$ // end of the input. 
```

我希望你是最好的，

真挚地，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T22:03:29.637

您可以使用此正则表达式模式来查找前缀后面的位置：

```
(?<=prefix)find 
```

在你的情况下

```
(?<=^<strong>Name:</strong> ).*$ 
```

它会准确找到“Josef”，您不需要使用组。但请考虑使用[Html Agility Pack](http://htmlagilitypack.codeplex.com/)进行 html 搜索。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T22:07:23.297

如果您只想要*Joseph*，为什么不使用 RightToLeft 正则表达式选项给解析器提示开始和结束，并从头开始工作。该模式仍然是从左到右的，它转换为：

```
string data =@"
<br />
<strong>Name:</strong> Josef
<br />
";

string pattern = @"\</strong\>\s+([^\r\n]+)";

// Put in | | to show no whitespace leakage.
Console.WriteLine ("|{0}|", Regex.Match(data, pattern, RegexOptions.RightToLeft).Groups[1].Value);

// Outputs
// |Josef| 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T22:47:27.260

我不会使用多行模式来使锚点正常工作，而是放弃锚点：

```
<strong>Name:</strong>\s*([^\r\n<]+) 
```

HTML 不是基于行的格式，因此在其中使用行锚没有任何意义。这段文字今天可能在自己的行中，但明天可能会被编辑并删除换行符；它仍然是有效的 HTML，并且仍将呈现完全相同的内容。

另一个潜在问题是换行符可能是`\r\n`(carriage-return + linefeed) 而不仅仅是`\n`. .NET 正则表达式风格不识别`\r`为（部分）行分隔符，因此`$`将匹配 the`\r`和 the之间的位置`\n`，并且`\r`将与名称（ ie ）一起捕获`"Josef\r"`。

# drupal - 在 Drupal 中过滤视图 - 从分类中选择带有子节点的节点

> ID：13863627
> 
> 赞同：0
> 
> 时间：2012-12-13T15:58:50.417
> 
> 标签：drupal, drupal-views

我正在使用带有视图 3 的 drupal 7。我在页面中添加了一些过滤器，其中一个过滤器是分类法。该分类具有树结构。过滤器已暴露，因此用户可以更改它。一切正常，但有一个主要错误。示例结构：

*   家长 1
    *   孩子 1
    *   孩子 2
        *   子 1
*   家长 2
*   ...

例如，当我选择子 1 时，我可以看到子 1 的所有节点 - 没关系。但是例如，当我选择子 2 时，我看不到子 1 中的节点。如果我选​​择父 1，情况相同 - 我只看到父 1 中的节点 - 不显示子 1,2 和子 1。

是否可以向所有有父母的孩子展示观点？或者也许我应该做一些事情，比如从代码中手动提取所有孩子，而不是改变查询并使 WHERE IN 条件？

所有帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T11:14:50.840

使用过滤器“有分类术语（有深度）”

# asp.net - vb.net：在访问数据库中保存的文件路径中显示图像控件中的图像？

> ID：13863631
> 
> 赞同：0
> 
> 时间：2012-12-13T15:58:56.020
> 
> 标签：asp.net, vb.net, image

我已经访问了数据库中的数据并在文本框中显示了一些信息，但是如何从文件路径中显示图像？

aspx：

```
<asp:Image ID="PlaceEventImage" runat="server" Height="120px" Width="217px" /> 
```

aspx.vb：

```
 Dim placeName As String = CType(Session.Item("Place"), String)
            Dim address1 As String = CType(Session.Item("Address1"), String)
            Dim countyID As Integer = CType(Session.Item("CountyID"), Integer)

            Dim aConnection4 As New OleDbConnection
            Dim aDataAdapter5 As OleDbDataAdapter
            Dim ds1 As New DataSet
            Dim aCommand5 As OleDbCommand
            Dim Sql5 As String
            aConnection4.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath("App_Data/MyLocalWebsite.mdb")
            Sql5 = "SELECT PlaceName, Address1, Address2, PlaceData.CountyID, PlaceCategoryID, Image, CountyData.CountyID, County FROM PlaceData INNER JOIN CountyData ON (CountyData.CountyID = PlaceData.CountyID) WHERE PlaceName = '" & placeName & "' AND Address1 = '" & address1 & "' ORDER BY PlaceName"
            aCommand5 = New OleDbCommand(Sql5, aConnection4)

            aConnection4.Open()

            aDataAdapter5 = New OleDbDataAdapter(Sql5, aConnection4)
            aDataAdapter5.Fill(ds1, "PlaceInfo")

            aConnection4.Close()

            Dim imageUrl As String = ds1.Tables("PlaceInfo").Rows(0).Item(5)

            PlaceEventName.Text = ds1.Tables("PlaceInfo").Rows(0).Item(0)
            Address1Label.Text = ds1.Tables("PlaceInfo").Rows(0).Item(1)
            Address2Label.Text = ds1.Tables("PlaceInfo").Rows(0).Item(2)
            CountyLabel.Text = ds1.Tables("PlaceInfo").Rows(0).Item(7) 
```

最终让它工作，下面是有效的解决方案。图像作为完整文件路径保存到数据库，但图像已上传到服务器，因此需要更改服务器的路径：

```
Dim imageUrl As String = ds1.Tables("PlaceInfo").Rows(0).Item(5)
Dim found As Integer = imageUrl.LastIndexOf("\")
Dim filename As String = imageUrl.Substring(found)
Dim newFilename As String = filename.Replace("\", "/")
PlaceEventImage.ImageUrl = "~/Uploads" + newFilename 
```

# objective-c - Chipmunk 中的自顶向下物理介绍

> ID：13863632
> 
> 赞同：0
> 
> 时间：2012-12-13T15:59:00.123
> 
> 标签：objective-c, ios, physics, chipmunk

我正在尝试在 iOS 上使用 Chipmunk 创建我认为是一段非常简单的物理代码，这将有效地让八个 UIButtons 自动围绕 UIView 移动，从边缘反弹，并相互关闭，以随机速度等

作为一个相对较新的编码员，我很难做到这一点。我已经从花栗鼠网站上提取了示例代码（甚至是一些专门使用 UIKit 元素的代码），但恐怕我只是不知道需要采取什么行动，如何设置它们等等。我意识到这是一个广泛的问题，但我发现的所有关于 Chipmunk 的教程内容似乎都假设一个人已经是一个熟练的程序员，或者一个熟练的物理学家和数学家。我是一名业余编码员，无法为任何专业的 Chipmunk 软件包付费，而且由于免费版本是用 C 语言编写的，而不是 Objective-C 语言，即使将它集成起来对我来说似乎也需要几天的工作。

花栗鼠似乎没有很好的记录。例如，在文档中搜索“摩擦”会找到该词的单个（无用）实例。如果没有刻度，我怎么知道输入什么值？我意识到我很沮丧，这比我做的要容易，但似乎每次我试图捡起这些东西时，门都被砰的一声关上了。

我发现的许多教程也使用了旧版本的 Chipmunk，其中大量的东西已经发生了变化，这使得它们真的非常难以遵循。

**我真的可以使用**不会自动假设我已经可以做到的简单介绍。一个可能存在于任何地方吗？有关如何处理此问题的任何其他提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:57:49.773

不确定您是否是我刚刚在 Chipmunk 论坛上回答的同一个人，但这里有一个新示例，其中包含一个（常规的，非专业的）Chipmunk/UIKit 示例。评论的很透彻。 [https://github.com/slembcke/ChipmunkColorMatch](https://github.com/slembcke/ChipmunkColorMatch)

为了公平起见，您必须意识到有完整的教科书是关于 Chipmunk 所涵盖的那种物理学的。虽然我确实觉得这些文档充分涵盖了 API，但你是对的，它假设你知道这些术语和理论。我无法将所有这些都放入文档中，而且我没有时间编写该级别的物理入门。有些事情你只需要知道什么是质量，什么是摩擦系数（以及为什么它们没有单位或比例），以及力是如何工作的。花栗鼠文档不应该是学习这类东西的好去处。

如果您有具体问题，可以随时在 Chipmunk 论坛上提问。

# c# - 拆分字符串并放入DataTable，找到第二个索引号

> ID：13863636
> 
> 赞同：0
> 
> 时间：2012-12-13T15:59:07.470
> 
> 标签：c#, string, indexing, split

我有一个关于拆分字符串的问题并将其放在 DataTable 中。我怎么知道第二个数组是字符串还是数字？

我有一个包含许多这样的字符串的文本：

```
 text : ...
        abc 123 def 1 \"ok lo\" ;
        abc def 1 \"ok lo\" ;
        ... 
```

数组2：

```
 tmpList[0] = abc
 tmpList[1] = 123
 tmpList[2] = def
 tmpList[3] = 1 \"ok lo\" 
```

数组1：

```
 tmpList[0] = abc
 tmpList[1] = def
 tmpList[2] = 1 \"ok lo\ 
```

为了找到所有以 abc 开头的字符串，我做了：

```
 StreamReader fin = new StreamReader(userSelectedFilePath1);
        string tmp = "";
        while ((tmp = fin.ReadLine()) != null)
        {
        if (tmp.StartsWith("abc "))
            {
              var tmpList1 = tmp.Split(new[] { '"' }).SelectMany((s, i) =>
                {
                    if (i % 2 == 1) return new[] { s };
                    return s.Split(new[] { ' ', ';', ',' }, StringSplitOptions.RemoveEmptyEntries);
                }).ToList();

                 table.Rows.Add(new object[] { tmpList1[0], tmpList1[1], tmpList1[2], tmpList1[3]}); 

            }

        } 
```

使用此代码，我可以找到以 abc 开头的字符串，拆分并放入 DataTable。我怎么知道第二个索引是字符串还是整数？因为我所做的我对第二个索引有一个错误，它分裂不正确。我考虑`if(tmp.StartsWith(abc NUMBER?))` `else`做上面的代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:17:34.170

当您执行 String.Split() 时，数组中的所有值也将是字符串，因此在您的 ABC 示例中：

```
tmpList[1] = 123 // this is incorrect as the value is an int 
```

这应该是：

```
tmpList[1] = "123" // value is a string 
```

然后你可以做的是尝试将值转换为一个 int，如果它失败了，你知道它不是一个 int：

```
int number;
bool result = Int32.TryParse(tmpList[1], out number);
if (result) {
    // your code for if the value is a number        
}
else {
    // your code for if the value is not a number
} 
```

[从这里](http://msdn.microsoft.com/en-us/library/vstudio/f02979c7(v=vs.100).aspx)复制的代码示例。

# sql - linq中的这个sql是什么？

> ID：13863637
> 
> 赞同：-1
> 
> 时间：2012-12-13T15:59:08.097
> 
> 标签：sql, linq, entity-framework, tsql, linq-to-sql

我不知道如何将其转换为 Linq。任何帮助表示赞赏！

```
SELECT distinct top 5 searchterm, created
FROM
(   SELECT searchterm, created ,ROW_NUMBER() 
    over(partition by searchterm order by created) Ordresults, createdby
    FROM searchhistory 
) A
WHERE A.Ordresults = 1 and A.CreatedBy = 'USERNAME'
ORDER BY A.Created DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:12:09.073

像这样的东西应该工作：

**查询语法：**
`Take`不支持，所以必须作为扩展方法调用：

```
var query = (from term in EM.SearchHistory
            group term by term.searchterm into g
            let item = new 
            { 
                searchterm = g.Key, 
                first = g.OrderBy(t => t.created).First(),
            }
            where item.first.createdby == "USERNAME"
            orderby item.first.created
            select new
            {
                item.searchterm,
                item.first.created,
            })
            .Take(5)
; 
```

**方法语法：**

```
var query = EM.SearchHistory
    .GroupBy(term => term.searchterm)
    .Select(g => new 
    {
        searchterm = g.Key, 
        first = g.OrderBy(t => t.created).First(),
    })
    .Where(item => item.first.createdby == "USERNAME")
    .OrderBy(item => item.first.created)
    .Select(item => new
    {
        item.searchterm,
        item.first.created,
    })
    .Take(5)
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T09:13:10.213

最后一点代码，如果它可以帮助其他人......

```
 var query = (from term in EM.SearchHistories
                     group term by term.SearchTerm into g
                     let item = new
                     {
                         searchterm = g.Key,
                         first = g.OrderBy(t => t.Created).FirstOrDefault(),
                     }
                     where item.first.CreatedBy == "USERNAME"
                     orderby item.first.Created
                     select new
                     {
                         item.searchterm,
                         item.first.Created,
                     })
        .Take(5); 
```

# validation - Rails 3 自定义验证器“踩踏”现有验证

> ID：13863644
> 
> 赞同：0
> 
> 时间：2012-12-13T15:59:24.120
> 
> 标签：validation, ruby-on-rails-3.2

我有一个简单的 CRUD 应用程序，其中包含对商品模型的一些基本验证。这些测试通过。好的，现在我需要测试它的名称是否没有空格或多个单词。我在控制台中测试了以下内容，它似乎可以正常工作，因此阅读了有关验证的 rails 指南，我在下面编写了一个自定义验证。不幸的是，运行我的测试，现在都失败了，因为它无法创建商品，因为我编写的自定义验证失败了。我已经尝试了许多不同的组合，将验证器从 Railscasts #211 开始，通过将其组合到 validates 调用中。这可能很简单，但如果我取消对验证器的调用，那么其他基本测试就会通过。错误是：验证失败：名称必须是一个单词（ActiveRecord::RecordInvalid）

```
 require_relative 'commodity_name_validator'
 class Commodity < ActiveRecord::Base
   attr_accessible :description, :name
   has_many :prices
   before_save { |commodity| commodity.name.capitalize! }
   validates :name, presence: true, length: { minimum: 4 }
   validate :commodity_name_validations
 end

 class CommodityNameValidator < ActiveModel::Validator
   def validate(record)
     if record.name.split(" ").length <= 1
       record.errors[:base] << "Name must be a single word"
     end
   end
 end 
```

谢谢，山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T22:27:18.717

在这种情况下，当它遇到基本错误时，似乎这个“stomp”是由于早期的黄瓜抛出错误。感谢@jorendorff 指出，将我的 <= 1 替换为 != 1 使这个测试通过并且之前的测试也通过了。我不知道这是 ruby​​ 的反射还是导致之前通过的测试出错的原因，我说的是无知。我只知道黄瓜至少会抛出误导真正原因的错误。

# xml - 如何使用 xpath 获取节点并选择子节点

> ID：13863648
> 
> 赞同：0
> 
> 时间：2012-12-13T15:59:33.663
> 
> 标签：xml, xpath

我有类似于下面的xml：

```
<?xml version='1.0' encoding='utf-8'?>
<Document>
    <name>SMTH</name>
    <Group>
        <GroupHeader>Some Description</GroupHeader>
        <Port>
            <ID>13553</PortID>
            <Name>Some name</PortName>
            <Number>PO1005</WorldPortNumber>
            <Section>
                <SectionHeader ID="63">General overview</SectionHeader>
                <PAR ID="59341" updatedate="19/05/2010 08:35:51">Important data</PAR>
            </Section>
            <Section>
                <SectionHeader ID="66">Max size</SectionHeader>
                <PAR ID="59344" updatedate="19/05/2010 08:35:51">Important data</PAR>
            </Section>
        </Port>
    </Group>
</Document> 
```

我想选择所有端口节点，**仅**包括ID、名称、编号和 PAR 子节点（应忽略其余子节点）。结果应该只是端口节点的集合，包括我上面列出的 4 个子节点。这是应该的样子：

```
Port:
    ID=234234
    Name=blabla
    Number=324234
    PAR=sdfsdfs
    PAR=fgfgfg
Port:
    ID=5555
    Name=blabla
    Number=ghfh
    PAR=sdfsdfs
    PAR=fgfgfg
... 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:11:08.017

像：

```
<xsl:for-each select="//Port">
  <xsl:copy-of select="*[name()='ID' or name()='Name' or name()='Number']"></xsl:copy-of>
  <xsl:copy-of select="Section/*[name()='PAR']"></xsl:copy-of>
</xsl:for-each> 
```

希望有帮助。:)

问候，哈里

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:17:30.253

您的要求是不可能用单个 XPath 表达式实现的。

XPath 表达式选择*文档中存在*的节点或节点集。如果您使用 XPath 选择一个`Port`元素，那么该元素将不加修改地返回给您，包括其所有现有文档上下文，包括其父级和子级。

`Port`您可以使用 union独立选择每个后代元素`|`，或者您可以选择每个`Port`元素，然后将每个元素`Port`作为上下文，仅选择您想要使用的后代元素（或删除/忽略那些您不使用的后代元素）不想要）。

您如何执行此操作将取决于您在检索节点后打算如何处理这些节点。如果您希望从输入生成示例输出，那么 XSLT 可能是一个不错的选择。

# matlab - Uitable、cellSelectionCallback 和修改数据集

> ID：13863652
> 
> 赞同：2
> 
> 时间：2012-12-13T15:59:40.590
> 
> 标签：matlab, matlab-uitable

我的代码真的太长了，不能在这里发布，即使是一小部分。所以我只要求一两件事：在我看来，在修改 uitable 'ht' 的 'Data' 属性时：

```
set(ht, 'Data', something); 
```

触发“cellSelectionCallback”例程（因为选择很可能确实发生了变化），但不是在修改数据集后立即触发。

1.  这是真的 ？
2.  有没有办法防止这种行为？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T18:58:14.813

我有使用 uitable 的代码，例如：

```
tbl = uitable('Parent', fh, 'CellSelectionCallback',{@cell_select_callback fh}); 
```

我做了一个快速的实验，**只有**当导致所选单元格发生变化时`set(tbl,'Data',my_data)`才会触发使用回调，并且这会立即发生（据我所知 - 我没有看到明显的延迟）。**`set`**

 **要阻止这种情况发生，您只需取消设置`CellSelectionCallback`属性，更改数据，然后重置 `CellSelectionCallback`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T20:33:51.950

我遇到过同样的问题。收到`index out of bounds`警告。为了摆脱那些我在我的`CallSelectionCallback`：

```
if ~isempty(eventdata.Indices)
 // all the code
end 
```

当 set 命令触发时`CallSelectionCallback`为`eventdata.Indices`空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-01T18:59:05.653

与塞巴斯蒂安的回答类似的可能性是将其放入您的 cellselectioncallback 函数中：

```
function output = mycellselection(source,event)

if isempty(event.Indixes)
    output = [];
    return
end
% rest of your code for cell selection

end 
```

如果您不需要任何输出，则可以将其删除。我只是把它放在那里提醒您必须为任何输出分配一个值。**

# ruby-on-rails - 正则表达式中未确定的数字长度

> ID：13863654
> 
> 赞同：0
> 
> 时间：2012-12-13T15:59:56.240
> 
> 标签：ruby-on-rails, ruby, regex

我有这个带有正则表达式的行：

```
user.image.gsub(%r{(http://graph.facebook.com/\d{15}/picture\?type=)\w+}, '\1large') 
```

个人资料图片 URL 可以是：

```
http://graph.facebook.com/12/picture?type=square
http://graph.facebook.com/123/picture?type=square
http://graph.facebook.com/1234/picture?type=square
http://graph.facebook.com/12345679/picture?type=square 
```

URL内部`length number`，未确定。

我如何使用这个正则表达式来匹配这个 URL 中的任何长度数字？

我试过：

```
user.image.gsub(%r{(http://graph.facebook.com/\d/picture\?type=)\w+}, '\1large') 
```

但它不工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:01:09.157

```
user.image.gsub(%r{(http://graph.facebook.com/\d+/picture\?type=)\w+}, '\1large')
                                 add a + here __^ 
```

# variables - 如何将变量的值用作变量本身？

> ID：13863660
> 
> 赞同：1
> 
> 时间：2012-12-13T16:00:23.527
> 
> 标签：variables, powershell, nested

我正在尝试在需要的powershell中进行编码，我将变量的值用作变量本身；有正确的语法吗？

这是示例；

```
$color = "red"
$red = 1

how can i obtain the value of 1? $($color) $"$color" etc give out the errors. 
```

如果需要，我可以解释更多关于我正在处理的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:03:28.983

语法不是很简洁，但您可以使用[`Get-Variable`cmdlet](http://technet.microsoft.com/library/hh849899.aspx)：

```
Get-Variable -Name $color -ValueOnly 
```

……或者干脆……

```
gv $color -ValueOnly 
```

# c# - 实体框架跟踪更改

> ID：13863662
> 
> 赞同：2
> 
> 时间：2012-12-13T16:00:25.950
> 
> 标签：c#, asp.net-mvc, entity-framework

我是 MVC 和实体框架的新手，正在尝试跟踪更改。这是我的代码片段：

```
string historyText = "<ul>";
ICollection<LookUp> oldPositions = fromDB.LookUps;

fromDB.LookUps.Clear();
IEnumerable<LookUp> allPositionTypes = lookUpRepository.GetByLookupTypeId(24);
foreach (var interest in chkPositionType)
{
    fromDB.LookUps.Add(allPositionTypes.Where(x => x.LookUpID == Convert.ToInt32(interest)).Single());
    if (!oldPositions.Contains(allPositionTypes.Where(x => x.LookUpID == Convert.ToInt32(interest)).Single()))
         historyText += "<li>" + "Position Type : <span class='history-old'> </span><span class='history-separator'>|</span><span class='history-new'>" + lkupRepo.GetByID(Convert.ToInt32(interest)).Name + "</span></li>";
}
historyText += "</ul>"; 
```

出于某种原因，一旦我清除 Lookups，它也会将 oldPositions 设置为 null。我也想知道我添加的新的和那些被删除但没有再次添加的。所以基本上需要跟踪变化。

有没有替代方法？如果它更好，我也可以采用它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:13:20.817

1.  更改 oldPosition 以枚举 LookUp，如下所示
    var oldPositions = fromDB.LookUps.ToList();

2.  从 DB.LookUps.Clear() 中删除它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:39:16.997

我相信 oldPositions 在调用 Clear() 方法时会失去对 fromDB.Lookups 的引用。

ICollection oldPositions = fromDB.LookUps;

fromDB.LookUps.Clear();

oldPositions 有一个指向 fromDB.LookUps 集合的引用指针。fromDB.LookUps 对来自元素的其他对象的集合引用被释放，因此 oldPositions 将为空。

# c++ - 如何迭代 QAbstractListModel？

> ID：13863663
> 
> 赞同：2
> 
> 时间：2012-12-13T16:00:31.547
> 
> 标签：c++, qt, qml, qt-quick

我有一个要求，我有不断更新的 QAbstractListModel。QAbstractListModel 的数据类型是整数类型。

我想以特定间隔将整个数据复制到向量中，以便向量不断更新，我可以进一步使用它。

知道如何通过索引迭代 QAbstractListModel 并将其复制到向量中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T18:02:23.357

快速而肮脏的做法：

```
QAbstractListModel m;
QVector<int> v;

const int nbRow = m.rowCount();
v.reserve(nbRow);

for (int i = 0; i < nbRow; ++i)
{
    int myInt = m.index(i, 0).data().toInt();
    v.append(myInt);
} 
```

# google-apps-script - Google Apps 脚本错误：找不到您请求的资源

> ID：13863665
> 
> 赞同：2
> 
> 时间：2012-12-13T16:00:42.930
> 
> 标签：google-apps-script, google-calendar-api

有一个每五分钟运行一次的脚本，通常会成功。间歇性地（每天 1 到 4 次）它会抛出一个错误。关于它有时成功或失败的原因似乎没有任何押韵或理由。

错误是“找不到您请求的资源。（第 48 行）”

```
44\. var eventStart = event.getStartTime();
45\. var eventRangeEndDate = eventStart;
46\. var eventRangeStartDate = new Date(eventStart.getTime() - 600000); // removes 10 minutes
47\. var calendar = CalendarApp.getDefaultCalendar();
48\. var events = calendar.getEvents(eventRangeStartDate, eventRangeEndDate); 
```

执行记录中没有任何可疑之处。这个错误对我来说意义不大，奇怪的是它不一致（通常脚本工作得很好）。

有什么想法吗？

# javascript - bonejs 初学者问题 - 获取和显示 json 数据

> ID：13863666
> 
> 赞同：1
> 
> 时间：2012-12-13T16:00:45.850
> 
> 标签：javascript, backbone.js, underscore.js

我是 Backbone 的新手（不要恨我），但我正在努力做一件非常简单的事情。

我正在加载一个 json 文件（正如我在 firebug 中看到的那样正确加载），我只想从中提取一些信息纯粹用于测试（作为我的第一个主干代码）

但是，我无法让这个工作，并最终得到一个空白的 li 标签（下面的代码）

```
<ul id="phones"></ul>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.2/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/0.9.2/backbone-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.rc.1/handlebars.min.js"></script>

<script id="foo" type="text/template">
        <li><%= name %></li>
    </script>

<script>

    var Phones = Backbone.Collection.extend({
        url:'http://backbone.local/phones/phones.json'
    })
    var PhonesView = Backbone.View.extend({
        el:'#phones',
        initialize:function(){
            this.collection = new Phones();
            this.collection.fetch();
            this.render();
        },
        template:_.template($('#foo').html()),
        render:function(){
                    var foo = this.collection.toJSON();
            $(this.el).html(this.template(foo));
            return this;
        }
    })
    var phonesView = new PhonesView();
</script> 
```

任何指针都非常感谢。

干杯，

**更新 1**

我认为这可能是由于 fetch 是异步的，所以我在 fetch 的成功回调中调用了 render，如下所示。console.log 可以正常触发，但在呈现的 html 中仍然没有 json 数据（我也改为使用车把）

```
 <script>
        var Phones = Backbone.Collection.extend({
            url:'http://backbone.local/phones/phones.json'
        })
        var PhonesView = Backbone.View.extend({
            el:'#phones',
            initialize:function(){
                var self = this;
                this.collection = new Phones();
                this.collection.fetch({
                    success:function(){
                        console.log('json loaded');
                        self.render();
                    }
                });
            },
            template: Handlebars.compile('<li>sdsadsadsadsad {{name}} dsfcdfd</li>'),
            render:function(){
                var foo = this.collection.toJSON();
                $(this.el).html(this.template(foo));
                return this;
            }
        })
        var phonesView = new PhonesView();
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:21:43.153

使用 Handlebars，集合模板如下所示：

```
{{#items}} <li>  {{name}} </li> {{/items}} 
```

您还需要将集合 JSON 包装在一个`items`对象中，以便 Handlebars 模板可以像上面那样引用它：

```
var foo = { items: this.collection.toJSON() }; 
```

**编辑**

实际上还有一个问题......`collection.toJSON()`不会将每个模型都转换为 JSON。所以你需要写：

```
this.collection.models.map(function(x) { return x.toJSON(); }); 
```

[小提琴演示](http://jsfiddle.net/WEQdC/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:28:44.610

在你看来：

```
'initialize': function() {
    this.template = _.template('<p><% model.text $></p>');
    this.collection.fetch({error: function() { console.log(arguments); }, 'success': _.bind(this.onFetch,this) });
    return this;
},
'onFetch': function(collection) {
    this.collection.on("add", this.onAdd, this);          
    this.collection.each( _.bind(this.onAdd, this) );
    return this;
},
'onAdd': function(model){    
    //do something like:
    this.$el.find('.items').append(this.template({model: model}) ) 
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:54:39.277

回答你为什么只得到一个空的 li 的明确问题。您必须向模板发送一些名称数据。例如：

```
render:function(){
    var firstModel = this.collection.at(0);
    var firstName = firstModel.get("name");
    $(this.el).html(this.template({name: firstName}));
    return this;
} 
```

当然，上面的代码只是为了了解缺少什么，而不是应该如何实现骨干应用程序。我真的建议您查看从 Backbone 网站链接的带注释的 TODO 示例，并了解那里实现的基本模式。

**根据您的评论更新：**
解决此问题的不同方法。真的推荐阅读：[http ://backbonejs.org/docs/todos.html](http://backbonejs.org/docs/todos.html)

要继续解决这个问题的“hacky path”，你可以看到一些东西：

```
addOne: function(phone) {
    this.$el.append(this.template(phone.toJSON()));
    return this;
},

render: function() {
    this.$el.html(); //clear everything in the view
    this.collection.forEach(_.bind(this.addOne,this)); //Will call addOne for every model in the collection.
    return this;
} 
```

# c++ - 在 C++ 中处理字节顺序

> ID：13863667
> 
> 赞同：3
> 
> 时间：2012-12-13T16:00:52.767
> 
> 标签：c++, python, endianness

我正在将系统从 python 转换为 c++。我需要能够在 c++ 中执行通常使用 Python 执行的操作`struct.unpack`（将二进制字符串解释为数值）。对于整数值，我可以使用以下数据类型来实现（某种）工作`stdint.h`：

```
struct.unpack("i", str) ==> *(int32_t*) str; //str is a char* containing the data 
```

这适用于 little-endian 二进制字符串，但在 big-endian 二进制字符串上失败。基本上，我需要一个等效于`>`在 struct.unpack 中使用标签的功能：

```
struct.unpack(">i", str) ==> ??? 
```

请注意，如果有更好的方法可以做到这一点，我会全力以赴。但是，我不能使用 c++11，也不能使用 Boost 以外的任何第三方库。我还需要能够解释浮点数和双精度数，例如`struct.unpack(">f", str)`and `struct.unpack(">d", str)`，但是当我解决这个问题时我会解决这个问题。

**注意**我应该指出我的机器的字节顺序在这种情况下是无关紧要的。我知道我在代码中收到的比特流总是大端的，这就是为什么我需要一个始终涵盖大端情况的解决方案。BoBTFish 在评论中指出的文章似乎提供了一个解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T16:31:04.833

**对于 32 位和 16 位值：**

这正是大端网络数据的问题。您可以使用[ntohl](http://linux.die.net/man/3/htonl)将 32 位转换为主机顺序，在您的情况下为 little-endian。

> ntohl() 函数将无符号整数 netlong 从网络字节顺序转换为主机字节顺序。

```
int res = ntohl(*((int32_t) str))); 
```

这也将处理您的主机是大端并且不会做任何事情的情况。

**对于 64 位值**

在 linux/BSD 上非标准，您可以看看[C++ 中的 64 位 ntohl()？](https://stackoverflow.com/questions/809902/64-bit-ntohl-in-c)，它指向[htobe64](http://www.unix.com/man-page/Linux/3/htobe64/)

> 这些函数将整数值的字节编码从当前 CPU（“主机”）使用的字节顺序转换为 little-endian 和 big-endian 字节顺序。

对于 Windows 尝试：[如何在 C++ 中的大端和小端值之间进行转换？](https://stackoverflow.com/questions/105252/how-do-i-convert-between-big-endian-and-little-endian-values-in-c)

它指向[_byteswap_uint64](http://msdn.microsoft.com/en-us/library/a3140177%28v=vs.80%29.aspx)以及 16 位和 32 位解决方案以及特定于 gcc 的 __builtin_bswap(32/64) 调用。

**其他尺寸**

大多数系统没有非 16/32/64 位长的值。那时我可能会尝试将其存储为 64 位值，将其移位并进行翻译。我会写一些很好的测试。我怀疑这是一种不常见的情况，更多细节会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T16:20:03.043

一次一个字节地解压字符串。

```
unsigned char *str;
unsigned int result;

result =  *str++ << 24;
result |= *str++ << 16;
result |= *str++ << 8;
result |= *str++; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T16:24:38.973

首先，你正在做的演员：

```
char *str = ...;
int32_t i = *(int32_t*)str; 
```

由于严格的别名规则导致未定义的行为（除非`str`用类似的东西初始化`int32_t x; char *str = (char*)&x;`）。实际上，强制转换可能会导致未对齐的读取，这会导致某些平台上的总线错误（崩溃）和其他平台上的性能下降。

相反，您应该执行以下操作：

```
int32_t i;
std::memcpy(&i, c, sizeof(i)); 
```

* * *

有许多函数可以在主机的本机字节顺序和主机独立的顺序之间交换字节：`ntoh*()`, `hton*()`, where `*`is nothing, `l`, 或`s`支持的不同类型。由于不同的主机可能具有不同的字节顺序，因此如果您正在读取的数据在所有平台上使用一致的序列化形式，这可能就是您想要使用的。

```
ntoh(i); 
```

`str`您还可以在将字节复制到整数之前手动移动字节。

```
std::swap(str[0],str[3]);
std::swap(str[1],str[2]);
std::memcpy(&i,str,sizeof(i)); 
```

或者您可以使用移位和按位运算符手动操作整数的值。

```
std::memcpy(&i,str,sizeof(i));
i = (i&0xFFFF0000)>>16 | (i&0x0000FFFF)<<16;
i = (i&0xFF00FF00)>>8  | (i&0x00FF00FF)<<8; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:21:50.030

这属于比特旋转的领域。

```
for (i=0;i<sizeof(struct foo);i++) dst[i] = src[i ^ mask]; 
```

其中 mask == (sizeof type -1) 如果存储的字节序和本机字节序不同。

使用这种技术，可以将结构转换为位掩码：

```
 struct foo {
    byte a,b;       //  mask = 0,0
    short e;        //  mask = 1,1
    int g;          //  mask = 3,3,3,3,
    double i;       //  mask = 7,7,7,7,7,7,7,7
 } s; // notice that all units must be aligned according their native size 
```

同样，这些掩码可以用每个符号两位进行编码：`(1<<n)-1`，这意味着在 64 位机器中，可以将 32 字节大小的结构的必要掩码编码为单个常量（具有 1、2、4 和 8 字节对齐）。

```
unsigned int mask = 0xffffaa50;  // or zero if the endianness matches
for (i=0;i<16;i++) { 
     dst[i]=src[i ^ ((1<<(mask & 3))-1]; mask>>=2;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-13T16:28:10.260

如果您收到的值是真正的字符串（char* 或 std::string），并且您知道它们的格式信息，sscanf() 和 atoi()，那么，真正的 atoi() 将是您的朋友。它们采用格式良好的字符串并根据传入的格式（一种反向 printf）转换它们。

# ios - 在 ios 6.0.1 上隐藏点击突出显示颜色

> ID：13863668
> 
> 赞同：1
> 
> 时间：2012-12-13T16:00:52.660
> 
> 标签：ios, mobile, hide, tap

在 ios 6.0.1 上隐藏点击突出显示颜色

div {-webkit-tap-highlight-color: rgba (0,0,0,0);} 不再起作用**升级** 到 iOS 6.0.1 后，我在 Canvas 2d 多人游戏中出现了一些错误。另外，JS 控制台已经出来了，非常糟糕！根本不相信模拟器。

# c++ - 如何编写 Live555 FramedSource 以允许我直播 H.264

> ID：13863673
> 
> 赞同：10
> 
> 时间：2012-12-13T16:01:02.297
> 
> 标签：c++, ffmpeg, h.264, x264, live555

我一直在尝试编写一个从 Live555 中的 FramedSource 派生的类，它允许我将实时数据从我的 D3D9 应用程序流式传输到 MP4 或类似设备。

我每帧所做的是将后台缓冲区作为纹理抓取到系统内存中，然后将其从 RGB -> YUV420P 转换，然后使用 x264 对其进行编码，然后理想地将 NAL 数据包传递给 Live555。我创建了一个名为 H264FramedSource 的类，它基本上是通过复制 DeviceSource 文件从 FramedSource 派生的。而不是输入是一个输入文件，我把它做成了一个 NAL 数据包，我更新每一帧。

我对编解码器和流媒体很陌生，所以我可能做的一切都完全错误。在每个 doGetNextFrame() 中，我是否应该抓取 NAL 数据包并执行类似的操作

```
memcpy(fTo, nal->p_payload, nal->i_payload) 
```

我假设有效负载是我的帧数据（以字节为单位）？如果有人有一个他们从 FramedSource 派生的类的示例，它可能至少接近我正在尝试做的事情，我很想看到它，这对我来说是全新的，并且有点难以弄清楚发生了什么。Live555 的文档几乎就是代码本身，这并不能让我很容易理解。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-02T11:23:19.587

好的，我终于有时间花在这上面并让它工作了！我敢肯定还有其他人会乞求知道如何做到这一点，所以就在这里。

您将需要自己的 FramedSource 来获取每一帧、编码并为流式传输做好准备，我将很快提供一些源代码。

基本上将您的 FramedSource 放入 H264VideoStreamDiscreteFramer，然后将其放入 H264RTPSink。像这样的东西

```
scheduler = BasicTaskScheduler::createNew();
env = BasicUsageEnvironment::createNew(*scheduler);   

framedSource = H264FramedSource::createNew(*env, 0,0);

h264VideoStreamDiscreteFramer 
= H264VideoStreamDiscreteFramer::createNew(*env, framedSource);

// initialise the RTP Sink stuff here, look at 
// testH264VideoStreamer.cpp to find out how

videoSink->startPlaying(*h264VideoStreamDiscreteFramer, NULL, videoSink);

env->taskScheduler().doEventLoop(); 
```

现在在您的主渲染循环中，将您保存到系统内存的后备缓冲区扔到您的 FramedSource 中，以便对其进行编码等。有关如何设置编码内容的更多信息，请查看此答案[How do do one encode a series of使用 x264 C API 将图像转换为 H264？](https://stackoverflow.com/questions/2940671/how-does-one-encode-a-series-of-images-into-h264-using-the-x264-c-api)

我的实现非常处于 hacky 状态，并且根本没有优化，由于编码，我的 d3d 应用程序以大约 15fps 的速度运行，哎呀，所以我必须研究一下。但是出于所有意图和目的，这个 StackOverflow 问题得到了回答，因为我主要是在关注如何流式传输它。我希望这对其他人有所帮助。

至于我的 FramedSource，它看起来有点像这样

```
concurrent_queue<x264_nal_t> m_queue;
SwsContext* convertCtx;
x264_param_t param;
x264_t* encoder;
x264_picture_t pic_in, pic_out;

EventTriggerId H264FramedSource::eventTriggerId = 0;
unsigned H264FramedSource::FrameSize = 0;
unsigned H264FramedSource::referenceCount = 0;

int W = 720;
int H = 960;

H264FramedSource* H264FramedSource::createNew(UsageEnvironment& env,
                                              unsigned preferredFrameSize, 
                                              unsigned playTimePerFrame) 
{
        return new H264FramedSource(env, preferredFrameSize, playTimePerFrame);
}

H264FramedSource::H264FramedSource(UsageEnvironment& env,
                                   unsigned preferredFrameSize, 
                                   unsigned playTimePerFrame)
    : FramedSource(env),
    fPreferredFrameSize(fMaxSize),
    fPlayTimePerFrame(playTimePerFrame),
    fLastPlayTime(0),
    fCurIndex(0)
{
        if (referenceCount == 0) 
        {

        }
        ++referenceCount;

        x264_param_default_preset(&param, "veryfast", "zerolatency");
        param.i_threads = 1;
        param.i_width = 720;
        param.i_height = 960;
        param.i_fps_num = 60;
        param.i_fps_den = 1;
        // Intra refres:
        param.i_keyint_max = 60;
        param.b_intra_refresh = 1;
        //Rate control:
        param.rc.i_rc_method = X264_RC_CRF;
        param.rc.f_rf_constant = 25;
        param.rc.f_rf_constant_max = 35;
        param.i_sps_id = 7;
        //For streaming:
        param.b_repeat_headers = 1;
        param.b_annexb = 1;
        x264_param_apply_profile(&param, "baseline");

        encoder = x264_encoder_open(&param);
        pic_in.i_type            = X264_TYPE_AUTO;   
        pic_in.i_qpplus1         = 0;
        pic_in.img.i_csp         = X264_CSP_I420;   
        pic_in.img.i_plane       = 3;

        x264_picture_alloc(&pic_in, X264_CSP_I420, 720, 920);

        convertCtx = sws_getContext(720, 960, PIX_FMT_RGB24, 720, 760, PIX_FMT_YUV420P, SWS_FAST_BILINEAR, NULL, NULL, NULL);

        if (eventTriggerId == 0) 
        {
            eventTriggerId = envir().taskScheduler().createEventTrigger(deliverFrame0);
        }
}

H264FramedSource::~H264FramedSource() 
{
    --referenceCount;
    if (referenceCount == 0) 
    {
        // Reclaim our 'event trigger'
        envir().taskScheduler().deleteEventTrigger(eventTriggerId);
        eventTriggerId = 0;
    }
}

void H264FramedSource::AddToBuffer(uint8_t* buf, int surfaceSizeInBytes)
{
    uint8_t* surfaceData = (new uint8_t[surfaceSizeInBytes]);

    memcpy(surfaceData, buf, surfaceSizeInBytes);

    int srcstride = W*3;
    sws_scale(convertCtx, &surfaceData, &srcstride,0, H, pic_in.img.plane, pic_in.img.i_stride);
    x264_nal_t* nals = NULL;
    int i_nals = 0;
    int frame_size = -1;

    frame_size = x264_encoder_encode(encoder, &nals, &i_nals, &pic_in, &pic_out);

    static bool finished = false;

    if (frame_size >= 0)
    {
        static bool alreadydone = false;
        if(!alreadydone)
        {

            x264_encoder_headers(encoder, &nals, &i_nals);
            alreadydone = true;
        }
        for(int i = 0; i < i_nals; ++i)
        {
            m_queue.push(nals[i]);
        }   
    }
    delete [] surfaceData;
    surfaceData = NULL;

    envir().taskScheduler().triggerEvent(eventTriggerId, this);
}

void H264FramedSource::doGetNextFrame() 
{
    deliverFrame();
}

void H264FramedSource::deliverFrame0(void* clientData) 
{
    ((H264FramedSource*)clientData)->deliverFrame();
}

void H264FramedSource::deliverFrame() 
{
    x264_nal_t nalToDeliver;

    if (fPlayTimePerFrame > 0 && fPreferredFrameSize > 0) {
        if (fPresentationTime.tv_sec == 0 && fPresentationTime.tv_usec == 0) {
            // This is the first frame, so use the current time:
            gettimeofday(&fPresentationTime, NULL);
        } else {
            // Increment by the play time of the previous data:
            unsigned uSeconds   = fPresentationTime.tv_usec + fLastPlayTime;
            fPresentationTime.tv_sec += uSeconds/1000000;
            fPresentationTime.tv_usec = uSeconds%1000000;
        }

        // Remember the play time of this data:
        fLastPlayTime = (fPlayTimePerFrame*fFrameSize)/fPreferredFrameSize;
        fDurationInMicroseconds = fLastPlayTime;
    } else {
        // We don't know a specific play time duration for this data,
        // so just record the current time as being the 'presentation time':
        gettimeofday(&fPresentationTime, NULL);
    }

    if(!m_queue.empty())
    {
        m_queue.wait_and_pop(nalToDeliver);

        uint8_t* newFrameDataStart = (uint8_t*)0xD15EA5E;

        newFrameDataStart = (uint8_t*)(nalToDeliver.p_payload);
        unsigned newFrameSize = nalToDeliver.i_payload;

        // Deliver the data here:
        if (newFrameSize > fMaxSize) {
            fFrameSize = fMaxSize;
            fNumTruncatedBytes = newFrameSize - fMaxSize;
        }
        else {
            fFrameSize = newFrameSize;
        }

        memcpy(fTo, nalToDeliver.p_payload, nalToDeliver.i_payload);

        FramedSource::afterGetting(this);
    }
} 
```

哦，对于那些想知道我的并发队列是什么的人，就在这里，它工作得很好[http://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-变量.html](http://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-variables.html)

享受和好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-18T16:57:15.047

DeliverFrame方法在开始**时**缺少以下检查：

```
if (!isCurrentlyAwaitingData()) return; 
```

在 LIVE 中查看 DeviceSource.cpp

# node.js - node-mongodb-native：如何通过我的应用程序共享连接回调的 db api 对象

> ID：13863675
> 
> 赞同：2
> 
> 时间：2012-12-13T16:01:10.433
> 
> 标签：node.js, mongodb, express, node-mongodb-native

我目前正在从 mongoose 回滚到 node-mongodb-native。

所以我对这个话题很陌生。但是我目前的问题是想要在服务器启动时创建一个数据库集合，然后我可以通过应用程序使用它。不幸的是，我只在存储库中找到示例，您只能在连接函数的回调中直接执行数据库操作。

文档：

```
var mongodb = require("mongodb"),
    mongoServer = new mongodb.Server('localhost', 27017),
    dbConnector = new mongodb.Db('example', mongoServer);

db_connector.open(function(err, db) {
    if (err) throw new Error(err);

    // here I can do my queries etc.
}); 
```

但是，当我在某些路由回调中时，如何访问回调中的 db 对象？目前我唯一的想法是将应用程序包装到回调中：

```
var mongodb = require("mongodb"),
    express = require("express"),
    mongoServer = new mongodb.Server('localhost', 27017),
    dbConnector = new mongodb.Db('example', mongoServer);

var app = new express();

db_connector.open(function(err, db) {
    if (err) throw new Error(err);

    app.get('/products', function(req, res, next) {
        db.collection('products', function(err, collection) {
            if (err) next(new Error(err));
            collection.find({}, function(err, products) {
                res.send(products);
            });
        });
    });

}); 
```

但我认为这不应该是这样吗？

有没有办法创建一个同步数据库连接调用，然后我可以轻松地在整个应用程序中使用它是如何被猫鼬使用的？

问候博多

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:48:21.970

Db.open 打开与 mongodb 的连接并返回对自身的引用。看到这里的源代码：[https ://github.com/mongodb/node-mongodb-native/blob/master/lib/mongodb/db.js#L245](https://github.com/mongodb/node-mongodb-native/blob/master/lib/mongodb/db.js#L245)

您所要做的就是推迟启动您的 express 应用程序在其端口上侦听并接收请求，直到您与 mongodb 建立连接。

所以你可以做的是：

```
var mongodb = require("mongodb"),
    express = require("express"),
    mongoServer = new mongodb.Server('localhost', 27017),
    dbConnector = new mongodb.Db('example', mongoServer),
    db;

var app = new express();

app.get('/products', function(req, res, next) {
  db.collection('products', function(err, collection) {
    if (err) next(new Error(err));
    collection.find({}, function(err, products) {
      res.send(products);
    });
  });
});

db_connector.open(function(err, opendb) {
  if (err) throw new Error(err);
  db = opendb;
  app.listen(3000);
}); 
```

不过，我不确定这是否是个好主意。如果连接中断或您重新启动了 mongodb 进程，此解决方案不允许您重新创建连接。因此，尽管上述方法可能有效，但创建一个方法来包装与 mongodb 的连接的创建可能是一个更好的主意。

# java - 在 JAX-RS 中指定 @Produces 通配符处理

> ID：13863679
> 
> 赞同：3
> 
> 时间：2012-12-13T16:01:25.313
> 
> 标签：java, servlets, jax-rs

假设一个类：

```
public class MyResource {

    @Path("/thing")
    public String getThing() {
        // returns HTML
    }

    @Path("/thing")
    @Produces(MediaType.APPLICATION_JSON)
    public String getThingJSON() {
        // returns JSON
    }
} 
```

我怎样才能有一个标题为`Accept: */*`be 处理的请求`getThing()`？目前拥有通配符接受标头会导致`getThingJSON()`被调用。如果我有一个接受标头`Accept: text/html`then`getThing()`被调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-11-22T13:47:19.890

我遇到了同样的问题，我必须使用带有特定`@Produces()`注释的方法。这个技巧有效：

```
@Path("/thing")
public String getThing() {}

@Path("/thing")
@Produces({MediaType.APPLICATION_JSON, "*/*;q=0"})
public String getThingJSON() {} 
```

使用 MIME 类型时，可以添加 q 属性，表示优先级（0 到 1）。没有 q 属性意味着 1，但显然 q=0 欺骗 Jersey 使用另一个函数。

这是一种 hack，所以我不知道它是否会继续工作，但帮助了我。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-13T16:05:34.893

尝试添加`a @Produces({MediaType.WILDCARD})`

获取事物（）

# javascript - 创建一组“假”网络服务的简单方法

> ID：13863680
> 
> 赞同：1
> 
> 时间：2012-12-13T16:01:28.610
> 
> 标签：javascript, html, web-services

我想在制作客户端 html/javascript 应用程序方面做得更好。JSbin.com 是一个很好的网站。但我想让我的测试站点也调用 Web 服务来获取数据。数据可能完全是假的，我只需要与之交互的东西。

有没有一种好方法可以使用您自己的虚假数据制作一组公开可用的 Web 服务？可以是暂时的，没关系。但它不能只在我的本地机器上运行，因为我希望能够测试它并使用它，例如，远离我的办公桌在我的 ipad 上工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:02:44.610

jsFiddle 有一个`echo`功能可以让你模拟 XHR 请求。它支持 JSON、XML、jsonP 等。

从他们的[文档](http://doc.jsfiddle.net/use/echo.html)

```
new Request.JSON({
    url: '/echo/json/',
    data: {
        json: JSON.encode({
            text: 'some text',
            array: [1, 2, 'three'],
            object: {
                par1: 'another text',
                par2: [3, 2, 'one'],
                par3: {}
            }
        }),
        delay: 3
    },
    onSuccess: function(response) {
        show_response(response, $('post'));
    }
}).send();

show_response = function(obj, result) {
    $H(obj).each(function(v, k) {
        new Element('li', {
            text: k + ': ' + v
        }).inject(result);
    });
    result.highlight();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:06:39.153

丹尼尔，只是在这里集思广益，因为我不完全确定我是否遵循你想要做的事情。您可以在家中或办公室设置自己的 Web 服务器并在那里公开您的 Web 服务吗？您可能必须通过调制解调器/路由器的 IP 地址调用它，并打开端口转发才能访问托管您的 Web 服务的机器，但理论上您应该能够做到这一点。

我错过了你想做的事吗？

# mysql - Mysql比较单个表中同一行中两列的值

> ID：13863689
> 
> 赞同：2
> 
> 时间：2012-12-13T16:01:37.797
> 
> 标签：mysql, sql

我一直在寻找一个查询来比较同一张表中单行中的值。

示例表：

```
SKU        Description   SKU   Category  
173406926  Widgets       1734  
137406927  Widgets-Blue  1734 
```

我需要找到 SKU 编号不以 SKU 类别编号开头的行（如上面的第二行）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:04:40.230

```
SELECT  *
FROM    tableName
WHERE   NOT (SKU LIKE CONCAT(`SKU Category`, '%')) 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/a9f93/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:06:54.243

你可以试试这个-

> SELECT * from tblName where SKU number REGEXP '^SKU Category'

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:07:58.627

```
select sku from tablename t where not (sku like concat(`sku category`, '%')) 
```

试试那个...

# view - CouchDB 按值分组，日期范围

> ID：13863696
> 
> 赞同：0
> 
> 时间：2012-12-13T16:02:13.547
> 
> 标签：view, couchdb

我在 CouchDB 实例中有一堆文档，其中包含以下数据：

```
{
    "_id": "[string based ID generated by CouchDB]",
    "action": "view",
    "group": [Integer representing a group number],
    "date": [Javascript timestamp]
} 
```

我可以使用以下内容按组和操作对数据进行分组，并获取每组的操作总数：

```
function(doc) {
  emit([doc.group, doc.action], [1, 1]);
} 
```

（简单地减少`_sum`）。

问题是，这会从*所有*组中获取数据，而我只想要来自单个组的数据（例如来自第 1 组）。

另外，我知道我可以做这样的事情来按日期过滤，但是我如何将它与上面结合起来按日期和组 ID 过滤？

```
function(doc) {
    var then = new Date(Date.parse(doc['Event Date']));
    var fatalities = 0;
    if (doc['Total Fatal Injuries']!="") {
        fatalities = parseInt(doc['Total Fatal Injuries']);
    }
    emit([then.getFullYear(), then.getMonth()], [1, fatalities]);
} 
```

（来自[https://cloudant.com/blog/mapreduce-from-the-basics-to-the-actually-useful/](https://cloudant.com/blog/mapreduce-from-the-basics-to-the-actually-useful/)）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:05:44.107

我认为你的 map() 和 reduce() 函数已经正确，你只需要传递`reduce=true&group_level=1&startkey=[<group id>]&endkey=[<group id>.toString() + "a"]`给视图。

至于按日期过滤，您可以使用相同的策略。使用组级别，您可以查看每年和每月的总和。

# python - wxPython - wx.TextCtrl - 强制样式

> ID：13863698
> 
> 赞同：2
> 
> 时间：2012-12-13T16:02:17.277
> 
> 标签：python, styles, wxpython, textctrl, wx.textctrl

只是一个关于 wx.TextCtrl 元素的简单问题。我在应用程序上有这个文本字段，用户可以在其中添加一个字符串。我想要一个带有红色文本的文本字段。所以我生成了这段代码：

```
self.hRepositoryTextfield = wx.TextCtrl(self.hPanel)
self.hRepositoryTextfield.SetDefaultStyle(wx.TextAttr(wx.RED)) 
```

如果用户在此文本字段上复制一些带有应用字体的字符串（例如黑色字符串或具有特定字体的字符串），则红色，无论如何默认样式都不会受到尊重。我希望我为我的 wx.TextCtrl 决定的样式总是根据我的设置强制执行。我能怎么做？

先感谢您

轴

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:55:35.907

SetForegroundColor 可能在一个操作系统上工作，而不是在另一个操作系统上工作。这取决于本机小部件。我会将 TextCtrl 的样式标志设置为 wx.TE_RICH。查看 wxPython 演示以获取示例。您甚至可以使用 HTMLCtrl 的 StyledTextCtrl 或 FancyText。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:45:15.387

```
self.hRepositoryTextfield.SetForegroundColor(wx.RED) 
```

那应该工作....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T23:56:52.357

我以这种方式解决了这个问题：

在代码的第一部分中，它定义了我的文本字段样式...

```
self.hRepositoryTextfield.SetStyle(0, len(self.hRepositoryTextfield.GetValue()), wx.TextAttr(wx.RED))
self.hRepositoryTextfield.SetFont(self.hFontLabel)
self.hRepositoryTextfield.Bind(wx.EVT_TEXT, self.forceDefaultStyle) 
```

...然后我将每个文本更改绑定到我的强制样式函数：

```
def forceDefaultStyle(self, event):
    hEventObject = event.GetEventObject()
    hEventObject.SetStyle(0, len(self.hRepositoryTextfield.GetValue()), wx.TextAttr(wx.RED))
    hEventObject.SetFont(self.hFontLabel) 
```

它有效！

# c - 线程不能立即部署信号吗？

> ID：13863700
> 
> 赞同：0
> 
> 时间：2012-12-13T16:02:29.030
> 
> 标签：c, multithreading, pthreads, multiprocessing, threadpool

想象一下，许多线程向`pthread_kill`一个线程发送信号（可能由创建）。但是线程不能立即部署它们。这些信号会丢失吗？如何解决从其他线程分发的这些信号？有什么参考或经验吗？tks 供您考虑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:12:25.380

是的，他们“迷路了”。信号没有排队[1]，它们只是一个被设置和清除的标志。因此，在第一个信号之后但在处理信号之前到达的几个信号无效。

解决方案是避免使用 unix 信号进行消息传递（实际上，对于大多数事情），而是使用其他东西，例如在互斥锁和条件变量的帮助下通过内存进行通信。

[1] 有实时信号，可以排队，至少在一定限度内，它们有自己的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:09:01.540

如果信号被发送到特定线程并且它们当前被阻塞，它们将在线程中保持挂起。当它们被解除阻塞（例如通过`pthread_sigmask`）时，将执行适当的信号动作。

PS。除非它们是排队信号（参见`sigqueue`），否则是否只是多个信号之一的信息将丢失。

# android - 无法以编程方式为 Android 4.1 添加日历事件

> ID：13863701
> 
> 赞同：3
> 
> 时间：2012-12-13T16:02:31.963
> 
> 标签：android, android-intent, calendar, android-4.2-jelly-bean

我正在尝试在 android 应用程序中创建一个按钮，该按钮能够在不启动意图的情况下将事件添加到日历中。

我找到了这个官方的 android 资源，它解释了如何实现这一点。

```
long calID = 3;
long startMillis = 0; 
long endMillis = 0;     
Calendar beginTime = Calendar.getInstance();
beginTime.set(2012, 9, 14, 7, 30);
startMillis = beginTime.getTimeInMillis();
Calendar endTime = Calendar.getInstance();
endTime.set(2012, 9, 14, 8, 45);
endMillis = endTime.getTimeInMillis();
...

ContentResolver cr = getContentResolver();
ContentValues values = new ContentValues();
values.put(Events.DTSTART, startMillis);
values.put(Events.DTEND, endMillis);
values.put(Events.TITLE, "Jazzercise");
values.put(Events.DESCRIPTION, "Group workout");
values.put(Events.CALENDAR_ID, calID);
values.put(Events.EVENT_TIMEZONE, "America/Los_Angeles");
Uri uri = cr.insert(Events.CONTENT_URI, values); 
```

我已经在包括 2.3、4.0、4.1 和 4.2 在内的许多设备上测试了此代码。

这似乎无法在 4.1 设备上运行。我尝试使用此代码添加日历事件，但无济于事。其他人可以在 4.1 上确认此错误吗？或者是否有将日历事件添加到 4.1 的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-15T16:54:46.583

我有同样的问题。

在文档中，您可以阅读：

> > 实际上，插入和更新应该在异步线程中完成，以将操作移动到后台线程中。

删除代码的最后一行并使用它：

```
AsyncQueryHandler handler = new MyHandler(getContentResolver());
handler.startInsert(0, null, Events.CONTENT_URI, values); 
```

哪里`MyHandler`是一个扩展的类`AsyncQueryHandler`（即抽象的）：

```
public class MyHandler extends AsyncQueryHandler {
    public MyHandler(ContentResolver cr) {
        super(cr);
    }
} 
```

这对我有用。

另外两个可能引起误解的细节：

*   在`Calendar`课堂上，月份值是从 0 开始的
*   要编写没有意图的日历，您必须将特定权限放入 Manifest 文件中：`<uses-permission android:name="android.permission.WRITE_CALENDAR" />`

# sql - 在忽略单个列的同时使用更改跟踪

> ID：13863706
> 
> 赞同：1
> 
> 时间：2012-12-13T16:02:45.833
> 
> 标签：sql, sql-server-2008, tsql, change-tracking

目前，我正在使用 SQL Server 2008 Change Tracking 跟踪对所有表的更改。开箱即用，一切正常。但是，另一个复杂性是读取这些更改的应用程序需要对正在跟踪的每个表上的日期列进行更改。我的应用程序中的更改就像触发器告诉我需要发送额外的数据。如果不加以管理，这可能会导致无限循环。

*每次读取更改后都会填写一个**发送日期。***

是否可以在数据库/表级别***配置***以忽略表上的单个列，以便在修改该列时不跟踪版本/更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T04:07:03.420

使用变更跟踪有两种方法，但都只涉及过滤结果；没有办法按列限制更改跟踪。

1) 按上下文过滤

以下链接显示了如何更改应用程序更改数据时的上下文。如果您更改特定于进行更改的上下文，则可以在查询时通过该上下文对其进行过滤。[http://msdn.microsoft.com/en-us/library/cc280462(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/cc280462%28v=sql.105%29.aspx)

2) 使用列更新掩码过滤

此外，我不得不承认我仍然推出了自己的变更跟踪。我有执行脚本来自动生成代码触发器。可以自定义它们以防止不更改的更新（即不更改您感兴趣的字段的行更新），而且它们允许我完全控制事物。我可以跟踪我想要的字段，另外我可以将我的所有跟踪/默认字段（例如 suser_sname()）移动到跟踪表中，这样日常业务表就会保持苗条。如果您对此选项感兴趣，请直接回复，我将发布代码以自动生成给定表名的触发器和跟踪表。

# asp.net-mvc - ASP.NET MVC 作为桌面厚客户端应用程序。是否可以？

> ID：13863708
> 
> 赞同：1
> 
> 时间：2012-12-13T16:02:51.980
> 
> 标签：asp.net-mvc, desktop-application

我只是好奇这种可能性是否存在。

这就是我的意思：

假设我有一个 ASP.NET MVC 站点。还有一些经典的 .exe 应用程序，将这个站点存储为资源。
当用户启动此应用程序时，服务器在进程的上下文中运行（没有任何外部暴露）并处理来自同一进程的请求。同时，客户端在类似浏览器的窗口中看到生成的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:04:42.437

你需要

1.  **IIS Hostable Web Core**托管网站 [http://blogs.msdn.com/b/carlosag/archive/2008/04/14/hostyourownwebserverusingiis7.aspx](http://blogs.msdn.com/b/carlosag/archive/2008/04/14/hostyourownwebserverusingiis7.aspx)

2.  **WebBrowser 控件**可从您的 Windows 应用程序访问站点
    [http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx) [http://msdn.microsoft.com/en-us/library/ aa752041(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/aa752041(v=vs.85).aspx)

# joomla - 从另一个表中获取数据到 Joomla 的形式

> ID：13863709
> 
> 赞同：0
> 
> 时间：2012-12-13T16:02:51.493
> 
> 标签：joomla, joomla2.5

我正在为 Joomla 创建一个组件！2.5，我有以下 MySQL 表结构。

```
CREATE TABLE `#__table_a` ( 
    id                   INT NOT NULL AUTO_INCREMENT,
    actividad            VARCHAR( 255 ),
    publish_up           DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    publish_down         DATETIME NOT NULL
 );

CREATE TABLE `#__table_b` ( 
    id                   INT NOT NULL AUTO_INCREMENT,
    table_a_id            INT NOT NULL,  /*foreign key to table '#__table_a' field 'id'*/
    hora                 TIME NOT NULL,
    created              DATETIME NOT NULL,
    publish_up           DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    publish_down         DATETIME NOT NULL
 ); 
```

我想要的是，以我管理来自“ `# __table_a`”的数据的形式，我需要能够管理表“ `#__table_b`”中列出的数据。

我该怎么做？，

即我在哪里对这些数据进行“查询”并在表格中显示它们？在“table_a”模型或控制器中？

# xaml - 是否可以从 Metro 应用程序（Windows 8）禁用分屏视图？

> ID：13863710
> 
> 赞同：1
> 
> 时间：2012-12-13T16:03:03.243
> 
> 标签：xaml, windows-8, microsoft-metro

我有一个 Metro 应用程序，当用户使用“分屏”Windows 8 功能时，它的行为会很有趣（如下图所示：http: [//pureinfotech.com/wp-content/uploads/2012/03/metro-app-desktop -split-screen-windows-8.png](http://pureinfotech.com/wp-content/uploads/2012/03/metro-app-desktop-split-screen-windows-8.png)）。

有没有办法从您的应用程序内部以编程方式禁用？到目前为止我还没有找到任何东西，但我发布这个以防万一有人知道更好。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T19:09:08.543

这在技术上是可行的，但可能不会通过应用程序认证。

您可以尝试在页面的 SizeChanged 事件的事件处理程序中使用 ApplicationView.TryUnsnap()：

在 ctor 中：

```
Window.Current.SizeChanged += OnSizeChanged; 
```

并实现处理程序方法：

```
public void OnSizeChanged(object sender, Windows.UI.Core.WindowSizeChangedEventArgs args)
    {
        switch (Windows.UI.ViewManagement.ApplicationView.Value)
        {
            case Windows.UI.ViewManagement.ApplicationViewState.Filled:
                VisualStateManager.GoToState(this, "Fill", false);
                break;
            case Windows.UI.ViewManagement.ApplicationViewState.FullScreenLandscape:
                VisualStateManager.GoToState(this, "Full", false);
                break;
            case Windows.UI.ViewManagement.ApplicationViewState.Snapped:
                VisualStateManager.GoToState(this, "Snapped", false);
                break;
            case Windows.UI.ViewManagement.ApplicationViewState.FullScreenPortrait:
                VisualStateManager.GoToState(this, "Portrait", false);
                break;
            default:
                break;
        }

        this.ShowCurrentViewState();
    }

void ShowCurrentViewState()
    {
        ApplicationViewState currentState = Windows.UI.ViewManagement.ApplicationView.Value;
        if (currentState == ApplicationViewState.Snapped)
        {
            ApplicationView.TryUnsnap() ;
        }

   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:07:23.127

你不能。

我建议只导航到启动画面之类的东西。

看看当您捕捉 Windows 应用商店时会发生什么。

# java - 哪个线程启动 JOptionPane？

> ID：13863713
> 
> 赞同：2
> 
> 时间：2012-12-13T16:03:11.743
> 
> 标签：java, swing

我们有一个带有套接字通信和其他线程的 Swing 应用程序。我们知道我们需要使用`SwingUtilities.invokeLater()`其他线程来更新 Swing 显示。但是怎么样`JOptionPane`？我们是否需要使用`SwingUtilities.invokeLater()`其他线程来启动`JOptionPane`？

如果答案是肯定的，如何使用 JOptionPane 来阻止程序？

如果答案是否定的，JOptionPane 不属于 GUI 显示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:11:10.270

是的，您需要使用`SwingUtilities.invokeLater()`来启动 JOptionPane - 否则 JOptionPane 可能没有响应。由于它是一个模态容器，默认情况下它应该阻止对主容器的输入。有关详细信息，请参阅[http://docs.oracle.com/javase/6/docs/api/javax/swing/JOptionPane.html 。](http://docs.oracle.com/javase/6/docs/api/javax/swing/JOptionPane.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:12:52.587

答案是肯定的，你只需要从 EventQueue 中调用 swing 组件。看看[JOptionPane.showMessageDialog 线程是否安全？](https://stackoverflow.com/questions/1595744/is-joptionpane-showmessagedialog-thread-safe)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-13T20:04:56.223

> 如果答案是肯定的，如何使用 JOptionPane 来阻止程序

答案确实是肯定的。您应该访问/修改/... Event Dispatch Thread 上的所有 Swing 组件。所以你的后台线程需要使用某种机制`JOptionPane`在 EDT 上调用。使用`SwingUtilities#invokeLater`是一种选择，但不是阻塞的选择。

用于`SwingUtilities#invokeAndWait`阻塞行为。此方法将等到可运行对象完成后再返回。

# iphone - UITableViewController 推送时没有导航栏

> ID：13863716
> 
> 赞同：0
> 
> 时间：2012-12-13T16:03:26.097
> 
> 标签：iphone, ios, ipad, uinavigationcontroller, uitableview

我正在使用此代码

```
-(void)gotoInformationViewController:(id)sender
{
    MoreViewController *moreViewController = [[MoreViewController alloc] init];
    [self.navigationController pushViewController:moreViewController animated:YES];
    [moreViewController release];
} 
```

推`MoreViewController`（即`UITableViewController`），但推时没有`UINavigationBar`，只是`UITableView`在整个屏幕上。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:07:26.530

在你的视图控制器中试试这个

```
- (void) viewWillAppear:(BOOL)animated
{
   [self.navigationController setNavigationBarHidden:NO animated:animated];
    [super viewWillAppear:animated];
} 
```

并确保在界面生成器中您的视图控制器的顶部栏未设置为无

# .htaccess - 重写对旧 url 友好并将旧 url 重定向到友好

> ID：13863721
> 
> 赞同：0
> 
> 时间：2012-12-13T16:03:37.313
> 
> 标签：.htaccess, redirect, rewrite, friendly-url

我正在重写这个

`http://myweb.com/post/5/title-of-the-post`（新网址）

到

`http://myweb.com/post.php?id=5`（旧网址）

我通过以下方式实现了这一目标：

```
RewriteEngine On
#Options +FollowSymLinks
RewriteRule ^post/(.+)/(.+) post.php?id=$2 
```

但是，如果我尝试输入旧网址，它仍然是可能的，那么我怎样才能**重定向到新**网址而不是陷入循环呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:00:27.257

首先，添加这条规则：

```
RewriteCond %{QUERY_STRING} id=([0-9]+)
RewriteRule ^post\.php$ post/%1/article [R=301,L] 
```

这将强制立即重定向，并且不会处理任何进一步的规则。发布/什么/曾经的请求将不符合此规则并跳过。请注意，您必须创建一个通用的文章标题，因为 .htaccess 无法知道要使用的标题。

接下来，添加此规则：

```
RewriteRule ^post/([0-9]+)/(.*)$ post.php?id=$1 [L] 
```

对 post.php 的请求已经在上面被捕获，所以它们不会到达这一行。这将按预期进行重定向，并且您不应该有无限循环。

# android - Android 媒体播放器：下载到文件并从文件流式传输

> ID：13863724
> 
> 赞同：22
> 
> 时间：2012-12-13T16:03:40.637
> 
> 标签：android, audio, download, streaming, media-player

我正在使用 Android`MediaPlayer`播放 MP3 文件，这些文件使用`DownloadManager`. 我知道`MediaPlayer`'s 直接流式传输的能力，但我不想使用它：

通过下载文件并同时从文件流式传输，您获得的明显优势是，通过这种方式，文件被存储并且之后可以在本地使用。

*   这在原则上是有效的 -`MediaPlayer`即使文件没有完全下载，它也会开始播放。（顺便说一句，我的问题不是我不能`MediaPlayer`玩。）
*   问题是当`MediaPlayer`到达下载状态刚开始播放时的位置时，它会停止并调用`onCompletion`. *（澄清：假设我开始播放时文件下载了 12%。当播放器到达 12% 的位置时，它会停止。）*
*   快速旁注：`OnBufferingUpdateListener.onBufferingUpdate(...)`当某些内容通过`DownloadManager`.

所以问题是：**如何同时将音频文件下载到文件系统并播放？（Android 4+ 就足够了，如果有区别的话。）**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-13T19:04:41.440

我假设您将 MediaPlayer 指向该文件。在那种情况下，我认为它不支持流式传输，并且它可能会提前检查文件的大小等，因此随着更多文件的进入，它不会自行更新。

您必须将其指向一个可以与流一起使用的内容源，例如 HTTP。我刚刚检查了“ES 文件资源管理器”是如何做到的（使用 LogCat） - 当您单击远程文件共享中的视频文件时，它会打开一个本地 HTTP 服务器，并向 MediaPlayer 发送一个 HTTP Uri 到其本地服务器，这也包括远程路径。

当它通过 HTTP 获得请求时，本地服务器开始从远程位置读取文件，并通过 HTTP 在本地将其提供给 MediaPlayer。您可能也可以这样做，除了通过 HTTP 提供它之外，还可以将它保存到磁盘。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-16T10:41:41.830

它帮助了我，我希望能帮助别人。

播放器下载和播放音乐。

```
mMediaPlayer.setDataSource(DOWNLOAD_URL);

   File root = Environment.getExternalStorageDirectory();
   File dir = new File(root + "/Folder");
   if (!dir.exists()) {
        dir.mkdirs();

DownloadManager downloadManager = (DownloadManager) getSystemService(Context.DOWNLOAD_SERVICE);
            Uri downloadUri = Uri.parse(DOWNLOAD_URL);
            DownloadManager.Request request = new DownloadManager.Request(downloadUri);
            request.setAllowedNetworkTypes(DownloadManager.Request.NETWORK_MOBILE | DownloadManager.Request.NETWORK_WIFI);
            request.setAllowedOverRoaming(false);
            request.setTitle(TITLE);
            request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
            request.setDestinationInExternalPublicDir(Environment.DIRECTORY_MUSIC, TITLE);
            request.allowScanningByMediaScanner(); 
```

下载文件后：

```
mMediaPlayer.setDataSource(Environment.getExternalStorageDirectory() + "/Folder/" + TITLE + ".mp3"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-21T08:06:05.220

我也有同样的问题。当然，当我同时使用`setDataSource(video_uri)`和`aCustomDownload(video_uri)`时，它可以保存和播放，但它**浪费了带宽。**

我试图用其他方式制作一个伪造的阻塞**FileDescriptor** (FileInputStream, LocalSocket) `setDataSource`，但都失败了。

所以我找到了这个解决方案[VideoCache](https://github.com/danikula/AndroidVideoCache)。

*   它通过 http 代理服务器，与 @Oren 的答案相同。它构建一个套接字本地 http 服务器，然后侦听一个有效的 url，如`http://127.0.0.1:xxxx/url_encode('your video url')`.

*   当它获得一个有效的 url 时，它会创建一个套接字请求客户端来下载该 url，并将流发送到`127.0.0.1`. 这样你就可以`setDataSource('http://127.0.0.1:xxxx/your video's encode url')`

*   使用一次下载，保存和播放。并且它可以创建**一个单例服务器**，再启动一个 Activity(lifecycle)，所以我可以使用它`android.intent.action.SEND`或其他`LAUNCHER`.

这是一个完美的解决方案。

> **注意：**您必须关闭缓存限制。否则 VideoCache 将在缓存大小为 512MB（默认）时清除所有数据。

# excel - 列值查找，然后使用 VBScript 记下搜索值的列号

> ID：13863728
> 
> 赞同：0
> 
> 时间：2012-12-13T16:03:49.623
> 
> 标签：excel, vbscript, vba

我有一个 excel 表，我可以在其中包含 200 到 260 范围之间的列，这意味着它是动态的。但是有两列固定，它们总是可以连续的方式——它们是***层次结构***，***父业务流程 ID***。我的目标是找到它在第一行的哪一列。它总是在第一行——这很当然。但它的列号不固定。无论如何，每当我的脚本运行时，是否可以直接找出它出现在第一行的哪一列。我正在使用基本的循环技术来找出它 - 这正在提高我的代码的整体性能 - 所以我想最小化它。

***代码***

```
 columncount=1

 Do untill ob6.Cells(1,columncount).Value = "Parent Business Process ID" 

   columncount=columncount+1

 Loop 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:09:29.577

假设`ob6`是您的工作表对象：

`columncount = Application.WorksheetFunction.Match("Parent Business Process ID", ob6.Rows(1), 0)`

将设置`columncount`为与您的搜索条件匹配的第一列的编号。

请注意，如果您的第一行不包含搜索词，则会发生错误。

# jakarta-ee - 带有 JBoss 7.1 的 SEAM2 应用程序 - ClassNotFoundException

> ID：13863729
> 
> 赞同：4
> 
> 时间：2012-12-13T16:03:53.383
> 
> 标签：jakarta-ee, jboss, migration, seam, seam2

我有一个“大”的 SEAM2 项目，应该从 JBOss 5.1 迁移到 7.1。

现在我有很大的问题。其中之一是 ClassNotFoundException：

```
Caused by: java.lang.ClassNotFoundException: org.jboss.seam.persistence.HibernateSessionProxy from [Module "deployment.app-ear-2.4.23-SNAPSHOT.ear.jboss-seam-2.1.2.jar:main" from Service Module Loader]
    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
    ... 53 more 
```

问题是，HibernateSessionProxy 存在于 Jboss-seam-2.1.2.jar 中，它位于 ear-File 的根路径中。那么为什么找不到这个类呢？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-28T01:23:18.133

JBoss 7 使用不同版本的 Hibernate，除非您特别排除它，否则将使用该版本。有关更多信息，请参阅[此](https://community.jboss.org/blogs/marek-novotny/2011/07/15/seam-2-jpa-example-on-jboss-as7)和[此](https://community.jboss.org/blogs/marek-novotny/2011/07/29/seam-2-booking-example-on-jboss-as-7) 。

# javascript - 为什么 DOM 操作需要这么长时间？

> ID：13863730
> 
> 赞同：0
> 
> 时间：2012-12-13T16:03:54.977
> 
> 标签：javascript, dom

我过去曾读到，操作 DOM 是您在 javascript 中可以做的最昂贵的事情之一。我还在[perfs](http://jsperf.com/for-vs-foreach-with-anonymous-functions)中看到了它的演示。为什么需要这么长时间？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:15:24.273

这种缓慢是由于文档重排而发生的。来自 Google Developers[加速 JavaScript：使用 DOM 指南](https://developers.google.com/speed/articles/javascript-dom)

> 使用 DOM 会导致浏览器重排，这是浏览器确定事物应该如何显示的过程。直接操作 DOM、更改元素的 CSS 样式以及调整浏览器窗口的大小都可以**触发 reflow**。访问元素的布局属性，例如 offsetHeight 和 offsetWidth 也可以触发重排。因为**每次回流都需要时间**，我们越能最小化浏览器回流，我们的应用程序就会越快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:06:37.207

每次更新 DOM 时，都会重新渲染文档。布局非常复杂。

# python - Django 1.4 CSRF 是如何工作的？

> ID：13863733
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:04:04.177
> 
> 标签：python, django, csrf, django-csrf

我有那个***urls.py***：

```
from django.conf.urls import patterns, url

urlpatterns = patterns('',
    url(
        r'^login/$', 
        'django.contrib.auth.views.login', 
        {'template_name': 'loyalty/login.html'}, 
        name='login'
    ),
    url(
        r'^logout/$', 
        'django.contrib.auth.views.logout', 
        {'next_page': '/', },
        name='logout'),
) 
```

并有模板**login.html***：

```
{% extends "loyalty/auth.html" %}
  {% load i18n %}  

  {% block auth_form %}
  {% if messages %}
  <ul>
    {% for message in messages %}
    <li>{{ message }}</li>
    {% endfor %}
  </ul>
  {% endif %}

  <form action="" method="post" id="login-form">{% csrf_token %}
    {% if form.username.errors %}{{ form.username.errors }}{% endif %}
    {{ form.username }}
    {% if form.password.errors %}{{ form.password.errors }}{% endif %}
    {{ form.password }}
    <input type="hidden" name="this_is_the_login_form" value="1" />
    <input type="hidden" name="next" value="{{ next }}" />
    <button type="submit" name="submit">{% trans 'Log in' %}</button>
  </form>
  {% endblock %} 
```

我在***settings.py 中***有：

```
MIDDLEWARE_CLASSES = (
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.locale.LocaleMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    # Uncomment the next line for simple clickjacking protection:
    # 'django.middleware.clickjacking.XFrameOptionsMiddleware',
) 
```

但这给了我这个错误：

> 禁止 (403)
> CSRF 验证失败。请求中止。
> 帮助
> 失败原因：
> 未设置 CSRF cookie。

在管理界面中，我有同样的问题。

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:27:36.123

您可能没有从您的视图中传递请求上下文。

例子：

```
def show_form(request):
    form = MyForm()
    if request.method == 'POST':
         form = MyForm(request.POST)
         if form.is_valid():

    return render_to_response("template_to_display.html", {'form':form}, context_instance = template.RequestContext(request)) 
```

更新：我建议重新安排你的中间件。尝试删除本地中间件或最后放置它。django 默认是[这个](https://docs.djangoproject.com/en/dev/ref/settings/#std%3asetting-MIDDLEWARE_CLASSES)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T04:53:04.453

我解决了这个问题。浏览器出现问题。尝试了其他浏览器，一切正常。不明白为什么我会遇到这个问题，因为我尝试过清理缓存和 cookie。

# mysql - SQL如何使用日期字段按财政季度和年份分组

> ID：13863734
> 
> 赞同：2
> 
> 时间：2012-12-13T16:04:10.183
> 
> 标签：mysql, sql-server-2008

我正在运行 SQL 2008，我的任务是创建一个将“供应商名称”和某些信息组合在一起的报告，此外还按会计年度及其季度对其进行分组。

除了我们的财政开始不是在 1 月而是在 11 月之外，它逐年上升。我有一个名为 'Expected Arrival Date' 的日期字段，格式为 'yyyy-mm-dd hh:mm;ss.mmm' 我不确定如何将其分组为关联：

**A.**从​​前一年 11 月开始的财政年度到 10 月结束的剩余财政年度（例如 2012 财政年度 = 2011 年 11 月开始 - 2012 年 10 月结束

**B.**财政季度 Nov1- Jan31 , Feb1 - Apr30, May1-July31, Aug1-Oct31

这是我已经拥有的代码

```
SELECT 
    YEAR([Expected Arrival Date])as 'Year',
    MONTH([Expected Arrival Date]) as 'Month',
    [Vendor Name], 
    (SUM(CASE WHEN ([Days Past Due] = 0) THEN [Qty Received] ELSE 0 END) / SUM([Qty Received])) * 100  AS 'On-Time %',
    (SUM(CASE WHEN ([Days Past Due] < 0) THEN [Qty Received] ELSE 0 END) / SUM([Qty Received])) * 100  AS 'Early %',
    (SUM(CASE WHEN ([Days Past Due] > 0) THEN [Qty Received] ELSE 0 END) / SUM([Qty Received])) * 100  AS 'Late %',
    SUM([Qty Received]) aS 'TOTAL'

FROM data_view 
GROUP BY YEAR([Expected Arrival Date]),MONTH([Expected Arrival Date]),[Vendor Name]
ORDER by YEAR([Expected Arrival Date]),MONTH([Expected Arrival Date]) 
```

如果您有任何有用的指针来创建一个很好的查询，我们也将不胜感激。

编辑** data_view的结构如下

```
 SELECT        [Receipt #], [Vendor Code], [Vendor Name], [PO Applied], [PO Line #], [Item Code], [Item Description], [Expected Arrival Date], [Receiving Date], [Receiving Date Filter], 
                         [Qty Received], [Qty Ordered], [% Received], [PO Date], [Receipt User], DATEDIFF(dd, CAST(CAST([Expected Arrival Date] AS CHAR) AS DATETIME), 
                         CAST(CAST([Receiving Date] AS CHAR) AS DATETIME)) AS [Days Past Due]
FROM            (SELECT        T1.RCPNUMBER AS [Receipt #], T1.VDCODE AS [Vendor Code], T1.VDNAME AS [Vendor Name], T4.PONUMBER AS [PO Applied], 
                                                    T3.DETAILNUM AS [PO Line #], T2.ITEMNO AS [Item Code], T2.ITEMDESC AS [Item Description], 
                                                    CASE WHEN T3.EXPARRIVAL = 0 THEN CASE WHEN T4.EXPARRIVAL = 0 THEN CAST(CAST(T4.DATE AS CHAR) AS DATETIME) 
                                                    ELSE CAST(CAST(T4.EXPARRIVAL AS CHAR) AS DATETIME) END ELSE CAST(CAST(T3.EXPARRIVAL AS CHAR) AS DATETIME) 
                                                    END AS [Expected Arrival Date], CAST(CAST(T1.DATE AS CHAR) AS DATETIME) AS [Receiving Date], CAST(CAST(T1.DATE AS CHAR) AS DATETIME) 
                                                    AS [Receiving Date Filter], T2.RQRECEIVED AS [Qty Received], T3.OQORDERED AS [Qty Ordered], 
                                                    ROUND(CASE WHEN T2.OQORDERED <> 0 THEN (T2.RQRECEIVED / T2.OQORDERED) * 100 ELSE 100 END, 2) AS [% Received], 
                                                    CAST(CAST(T4.DATE AS CHAR) AS DATETIME) AS [PO Date], T5.ENTEREDBY AS [Receipt User]
                          FROM            canada.dbo.PORCPH1 AS T1 INNER JOIN
                                                    canada.dbo.PORCPH2 AS T5 ON T1.RCPHSEQ = T5.RCPHSEQ INNER JOIN
                                                    canada.dbo.PORCPL AS T2 ON T2.RCPHSEQ = T1.RCPHSEQ INNER JOIN
                                                    canada.dbo.POPORL AS T3 ON T3.PORHSEQ = T2.PORHSEQ AND T3.PORLSEQ = T2.PORLSEQ INNER JOIN
                                                    canada.dbo.POPORH1 AS T4 ON T4.PORHSEQ = T3.PORHSEQ) AS tblReceips 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:53:13.087

像这样的东西应该工作：

```
SELECT 
    YEAR([Expected Arrival Date]) + CASE
        WHEN MONTH([Expected Arrival Date]) IN (11, 12) THEN 1
        ELSE 0
    END As FiscalYear,
    CASE
        WHEN MONTH([Expected Arrival Date]) IN (11, 12, 1) THEN 1
        WHEN MONTH([Expected Arrival Date]) IN (2, 3, 4) THEN 2
        WHEN MONTH([Expected Arrival Date]) IN (5, 6, 7) THEN 3
        ELSE 4
    END As FiscalQuarter,
    ...
GROUP BY
    YEAR([Expected Arrival Date]) + CASE
        WHEN MONTH([Expected Arrival Date]) IN (11, 12) THEN 1
        ELSE 0
    END,
    CASE
        WHEN MONTH([Expected Arrival Date]) IN (11, 12, 1) THEN 1
        WHEN MONTH([Expected Arrival Date]) IN (2, 3, 4) THEN 2
        WHEN MONTH([Expected Arrival Date]) IN (5, 6, 7) THEN 3
        ELSE 4
    END,
    [Vendor Name]
ORDER BY
    FiscalYear,
    FiscalQuarter
; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-17T17:38:27.523

Richard Deeming 的 SQL 在 MySQL 中完美运行，但我对查询的大小不满意，所以我使用基本概念创建一个更小的查询，使用内置的 MySQL IF() 函数：

```
SELECT
    YEAR(date),
    MONTH(date),
    YEAR(date) + IF(MONTH(date)>10, 1, 0) as 'FiscalYear',
    IF(MONTH(date)>10, 1, CEIL((MONTH(date)+2)/3)) as 'FiscalQuarter'
FROM dates 
```

[见 SqlFiddle](http://sqlfiddle.com/#!2/33fed/12)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-30T03:46:52.073

对于那些有兴趣查询 FY 的人从 7 月开始

```
SELECT
    YEAR(date),
    MONTH(date),
    YEAR(date) + IF(MONTH(date)>6, 1, 0) as FiscalYear,
    IF(MONTH(date)>6, FLOOR((MONTH(date)-4)/3), CEIL((MONTH(date)+6)/3)) as FiscalQuarter
FROM dates 
```

# java - 0-1 背包 - 其他输入值在程序中不起作用

> ID：13863736
> 
> 赞同：0
> 
> 时间：2012-12-13T16:04:12.243
> 
> 标签：java, output, knapsack-problem

我需要做的是实现0-1背包问题。有一个名为“In0302.txt”的输入文件和一个名为“Out0302.txt”的输出文件。程序从 INPUT 文件中获取值并将结果保存到 OUTPUT 文件中。我从我的“博士”那里得到了我在纸上的输入值。在 OUTPUT 文件中将它们放入文件似乎没问题。但是......在“博士”类上试图将其他值放入 INPUT 文件中，但程序不起作用。更何况连错误都没有，但是程序还在编译编译……我也不知道问题出在哪里。是否有人会尝试更改此代码中的某些内容或告诉我出了什么问题？

```
INPUT:
4 6
2 1
3 2
3 4
4 5

OUTPUT:
1 4
2 3 
```

JAVA代码：

```
public class Knapsack {
  public static int max(int a, int b){
    if (a > b){
      return a;
    }
    else{
      return b;
    }  
  }
  /**
   * @param args the command line arguments
   */

  public static void main(String[] args){
    int n = 0, W = 0, p[] = null, w[] = null, S[][] = null, S_object[][] = null;
    //s[][] = arrays with values

    try {
      FileReader fr = new FileReader("In0302.txt");
      BufferedReader in = new BufferedReader(fr);
      String line = in.readLine();
      String[] cols = line.split(" ");

      n = Integer.parseInt(cols[0]); W = Integer.parseInt(cols[1]); 

      p = new int[n+1]; w = new int[n+1];

      int k = 1;

      while ((line = in.readLine()) != null) {
        cols = line.split(" ");
        p[k] = Integer.parseInt(cols[0]);
        w[k] = Integer.parseInt(cols[1]);
        k++;
      }

      S = new int[W+1][n+1];
      S_object = new int[W+1][n+1];

      for(int weight = 0; weight <= W; weight++){
        for(int i = 0; i <= n; i++){
          if (i == 0){
            S[weight][i] = 0;
            S_object[weight][i] = 0;
          }
          else if (weight < w[i]){
            S[weight][i] = S[weight][i-1];
            S_object[weight][i] = S_object[weight][i-1];
          }
          else if (weight >= w[i-1]){
            S[weight][i]=max(S[weight][i-1],S[weight-w[i]][i-1]+p[i]);

            if ((max(S[weight][i-1], S[weight-w[i]][i-1] + p[i]) == (S[weight-w[i]][i-1] + p[i])))       {
              S_object[weight][i]=i;
            } //added new element to bag
            else {
              S_object[weight][i]=S_object[weight][i-1];
            } //nothing has been added
          }  
        }
      }
      in.close();
      fr.close(); 
    }

    catch (IOException e){
      System.out.println("Error: " + e.toString());
    }   

    File outputFile;
    FileWriter out;

    try{
      outputFile = new File("Out0302.txt");
      out = new FileWriter(outputFile);
      String line = "";

      int max_value = S[W][n];
      for (int m = n; m > 0; m--){
        if (S[W][m] == max_value){
          line = " " + S_object[W][m] + "";
          int temp = W;

          while ((temp-w[S_object[temp][m]]) > 0){
            temp = temp - w[S_object[temp][m]];
            line += " " + S_object[temp][m];
          }
          out.write(line + "\n");
          out.write("\n\t");
        }
      } 

      out.close();
    } 
    catch (IOException e) {
      System.out.println("Error: " + e.toString());
    }

    System.out.println("Arrar of values:");
    for(int weight = 0; weight <= W; weight++){
      for(int i = 0; i <= n; i++){
        System.out.print(S[weight][i] + " ");
      }
      System.out.println(""); 
    }

    System.out.println("Array of objects:");
    for(int weight = 0; weight <= W; weight++){
      for(int i = 0; i <= n; i++){
        System.out.print(S_object[weight][i] + " ");
      }
      System.out.println("");
    }
  }  
} 
```

# python - 为什么我会收到属性错误？

> ID：13863737
> 
> 赞同：0
> 
> 时间：2012-12-13T16:04:20.183
> 
> 标签：python, dictionary, pickle

方法返回的数据`self.prepSetFile()`是字典类型

```
 dataTodump=self.prepSetFile()
    try:
        settingFile=os.path.join(self.settingsDir,"setting.txt")
        output_phil=open(settingFile,'w')
        pickle.dump(dataTodump,settingFile,0)
    except: raise 
```

我不知道为什么我收到属性错误

> AttributeError：
> “str”对象没有属性“write”

我什至测试了 dataTodump 的数据类型，这显然是 dict

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:06:16.237

您需要将*打开*的文件传递给`pickle.dump`; 您只传入一个文件名：

```
output_phil=open(settingFile,'wb')
pickle.dump(dataTodump, output_phil, 0) 
```

请注意，该文件以*二进制*模式打开，以防止`\n`在非 UNIX 平台上转换字节。

# typo3 - TYPO3：如何在节索引中包含其他列？

> ID：13863738
> 
> 赞同：0
> 
> 时间：2012-12-13T16:04:28.163
> 
> 标签：typo3, typoscript

我有一个包含两列的网站（colPos = 0 和 colPos = 2）。我怎样才能将第 2 列的标题包含到部分索引中？默认行为是仅包含第 0 列的标题。

更具体地说，这是我用来生成菜单的 TypoScript：

```
lib.menupage = HMENU
lib.menupage {
  1 = TMENU
  1 {
    wrap = <ul> | </ul>
    NO.wrapItemAndSub = <li> | </li>
    sectionIndex = 1
  }
} 
```

我正在使用 TYPO3 6.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T18:18:45.970

我猜你正在寻找

```
lib.menupage.1.sectionIndex.useColPos = -1 
```

（[但这似乎只在 TYPO3 6.0 中可用](http://docs.typo3.org/typo3cms/TyposcriptReference/MenuObjects/Sectionindex/Index.html#menuobj-sectionindex)）

作为一种解决方法，应该可以自己完成。呈现一个普通菜单，但使用 CONTENT 对象覆盖（allWrap.cObject 应该完成这项工作）链接，该对象从该页面的 tt_content 检索所有标题。这是一些伪代码，有助于解释我将如何尝试解决该问题。这段代码行不通，只是说明原理：

```
lib.menupage = HMENU
lib.menupage {
  1 = TMENU
  1 {
    wrap = <ul> | </ul>
    NO.wrapItemAndSub = <li> | </li>
    # pgampe suggested to use: stdWrap2.append instead of allWrap.cObject. My intention
    # was to override the original link at all. But you should be able to play with
    # the different stdWrap functions to get the best solution
    # as far as i remember, allWrap will be wrapped by "wrapItemAndSub"
    NO.allWrap.cObject = CONTENT
    NO.allWrap.cObject {
       table = tt_content
       select {
         # the uid is the id of the page where we need the content from
         pidInList.field = uid
         orderBy = colPos, sorting
       }
       # inside the renderobj we get the elements which are retrieved by CONTENT
       renderObj = TEXT
       renderObj {
         field = header
         typolink.parameter.field = pid
         typolink.section.field = uid
         required = 1
         wrap = <span class="inside-li">|</span>
       }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:16:03.637

您很可能正在寻找`section index`.`menu content object`

渲染定义在`tt_content.menu.20.3.stdWrap.prepend.20 = CONTENT`. 您可以使用`TSOB (TypoScript Object Browser)`来调查相关`typoscript`设置。

您可以像`CONTENT`TYPO3 中的任何对象一样根据需要对其进行调整。但是它应该已经选择了任何列（至少在 6.0 中）。

# lucene - 在 RavenDB 中如何通过新近来增加文档？

> ID：13863739
> 
> 赞同：5
> 
> 时间：2012-12-13T16:04:33.357
> 
> 标签：lucene, ravendb

是否可以在 RavenDB 查询中提升最近的文档？

[这个问题正是我想要做的，](https://stackoverflow.com/q/4724451/1741868)但指的是原生 Lucene，而不是 RavenDB。

例如，如果我有这样的文档

```
public class Document
{
    public string Title { get; set; }
    public DateTime DateCreated  { get; set; }
} 
```

如何提升日期更接近给定日期的文档，例如`DateTime.UtcNow`？

我不想`OrderByDecending(x => x.DateCreated)`因为有其他搜索参数需要影响结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-13T18:21:24.713

您可以在索引期间进行提升，它在 RavenDB 中已经存在很长时间了，但它根本不在文档中。[但是，这里](https://github.com/ayende/ravendb/blob/master/Raven.Tests/Indexes/BoostingDuringIndexing.cs)有一些单元测试可以说明。

这些测试显示了一个提升值，但它可以很容易地从其他文档值中计算出来。您可以使用完整的文档，因为这是在编写索引条目时完成的。您应该能够将其与您引用的帖子中描述的技术结合起来。

```
Map = docs => from doc in docs
              select new
              {
                  Title = doc.Title.Boost(doc.DateCreated.Ticks / 1000000f)
              }; 
```

您还可以提升整个文档而不仅仅是标题字段，如果您的搜索算法中有其他字段，这可能会很有用：

```
Map = docs => from doc in docs
              select new
              {
                  doc.Title
              }.Boost(doc.DateCreated.Ticks / 1000000f); 
```

您可能需要尝试使用正确的值来用于提升量。一毫秒内有 10,000 个滴答声，所以这就是我除以这么大的数字的原因。

另外，请注意`DateTime`您正在使用的 UTC 时间，或者如果您无法控制它的来源，请使用 a`DateTimeOffset`代替。为什么？因为您使用的是从某个参考点计算的持续时间，并且您不希望结果对于不同的时区或夏令时更改前后不明确。

# objective-c - iPad capturing 16:9 photos

> ID：13863743
> 
> 赞同：1
> 
> 时间：2012-12-13T16:04:41.600
> 
> 标签：objective-c, ios, ipad, cocoa-touch

I am building a prototype app on iOS, and I’m cannibalizing some Apple sample code to do it (thin ice, I know—this code uses goto statements :\ ). I am using the AVCam project from Session 520 - What's New in Camera Capture. I don’t need video capture capability, just still photos.

The device inputs and outputs are set up thusly:

```
 // Init the device inputs
    AVCaptureDeviceInput *newVideoInput = [[AVCaptureDeviceInput alloc] initWithDevice:[self backFacingCamera] error:nil];
    AVCaptureDeviceInput *newAudioInput = [[AVCaptureDeviceInput alloc] initWithDevice:[self audioDevice] error:nil];

    // Setup the still image file output
    AVCaptureStillImageOutput *newStillImageOutput = [[AVCaptureStillImageOutput alloc] init];
    NSDictionary *outputSettings = @{AVVideoCodecKey: AVVideoCodecJPEG};
    [newStillImageOutput setOutputSettings:outputSettings];

    // Create session (use default AVCaptureSessionPresetHigh)
    AVCaptureSession *newCaptureSession = [[AVCaptureSession alloc] init];

    // Add inputs and output to the capture session
    if ([newCaptureSession canAddInput:newVideoInput]) {
        [newCaptureSession addInput:newVideoInput];
    }
    if ([newCaptureSession canAddInput:newAudioInput]) {
        [newCaptureSession addInput:newAudioInput];
    }
    if ([newCaptureSession canAddOutput:newStillImageOutput]) {
        [newCaptureSession addOutput:newStillImageOutput];
    }

    [self setStillImageOutput:newStillImageOutput];
    [self setVideoInput:newVideoInput];
    [self setAudioInput:newAudioInput];
    [self setSession:newCaptureSession]; 
```

And here is the method that’s called when I tap the shutter button:

```
- (void) captureStillImage
{
    AVCaptureConnection *stillImageConnection = [[self stillImageOutput] connectionWithMediaType:AVMediaTypeVideo];
    if ([stillImageConnection isVideoOrientationSupported])
        [stillImageConnection setVideoOrientation:orientation];

    [[self stillImageOutput]
        captureStillImageAsynchronouslyFromConnection:stillImageConnection
             completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, NSError *error) {

                 ALAssetsLibraryWriteImageCompletionBlock completionBlock = ^(NSURL *assetURL, NSError *error) {
                     if (error)
                     {
                         if ([[self delegate] respondsToSelector:@selector(captureManager:didFailWithError:)])
                         {
                             [[self delegate] captureManager:self didFailWithError:error];
                         }
                     }
                 };

                 if (imageDataSampleBuffer != NULL)
                 {
                     NSData *imageData = [AVCaptureStillImageOutput jpegStillImageNSDataRepresentation:imageDataSampleBuffer];
                     ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

                     UIImage *image = [[UIImage alloc] initWithData:imageData];

                     if ([self.delegate respondsToSelector:@selector(captureManagerCapturedImage:)])
                     {
                         dispatch_async(dispatch_get_main_queue(), ^{
                             [self.delegate captureManagerCapturedImage:image];
                         });
                     }

                     [library writeImageToSavedPhotosAlbum:[image CGImage]
                                               orientation:(ALAssetOrientation)[image imageOrientation]
                                           completionBlock:completionBlock];

                 }
                 else
                 {
                     completionBlock(nil, error);
                 }

                 if ([[self delegate] respondsToSelector:@selector(captureManagerStillImageCaptured:)])
                 {
                     [[self delegate] captureManagerStillImageCaptured:self];
                 }
             }];
} 
```

This code successfully captures an image and saves it to the library. However, at some point while I was working on it, it changed from capturing 5-megapixel 4:3 images to capturing 1920x1080 16:9 images. I can’t find anywhere that the aspect ratio is specified, and I didn’t change any of the code relating to the configuration of the camera, capture sessions, or capture connection. Why did my camera start taking 16:9 photos?

**Update:** I just re-ran Apple’s original sample code, and it appears that it is also saving 16:9 images captured directly from the video. It is quite possible that I was insane before, or I took a test shot with Camera.app and was looking at that. So my real question is, how do I show a live feed from the camera on the screen while I’m shooting, and take a full-resolution photo. I can’t use `UIImagePickerController`, because I need to be able to overlay things on top of the live camera feed.

**Update 2:** I was able to solve this by throwing out the AVCapture code I was using. It turns out that UIImagePickerController does what I needed. I didn’t realize you could overlay custom controls - I thought it took over the whole screen until you were done taking a picture.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:25:56.013

If you're capturing frames from a video source, you'll end up with a resolution of 16:9\. Capturing frames from a video source and taking photos are different things.

# mongodb - 在 mongodb 中连接两个查询

> ID：13863746
> 
> 赞同：0
> 
> 时间：2012-12-13T16:04:51.057
> 
> 标签：mongodb

例如，我想在 mongodb 中拆分我的长查询，而不是在以下代码中使用 db.users.find(q)，我想使用像这样的连接版本 db.users.find(q0+q1) 或任何其他方式我可以将 q 拆分为两个查询

```
q= {},{name:1,"education.school.name":1,"education.type":1} 
db.users.find(q)  
q0={}
q1={name:1,"education.school.name":1,"education.type":1}   
q=q0+","+q1 
db.users.find(q) 
```

我该怎么做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:09:33.060

您的子句在那里有些模棱两可（您的`q`和`q0`都是空对象），但您可能需要[$or](http://docs.mongodb.org/manual/reference/operator/or/)运算符

```
db.users.find(
  $or: [
    {name:1,"education.school.name":1,"education.type":1},
    {age:1,"education.school.name":2,"education.type":2} 
  ]
) 
```

这将返回这两个查询的集合并集。也就是说，根据您实际想要做的事情`$in`，如果您只想搜索多个值，则可以使用一组值来搜索每个字段。

# mysql - 为什么 INNER JOIN 不等于（！=）永远挂起

> ID：13863751
> 
> 赞同：19
> 
> 时间：2012-12-13T16:05:13.770
> 
> 标签：mysql, database

当我执行以下查询时：

```
SELECT * FROM `table1` 
 INNER JOIN table2 ON table2.number = table1.number 
```

我在 2 秒内得到结果。大约有 600 万条记录`table2`和 100 万条记录`table1`

`table2.number`并被`table1.number`索引。

现在我想得到一个不存在的数字列表。像这样：

```
SELECT * FROM `table1` 
 INNER JOIN table2 ON table2.number != table1.number 
```

它需要永远并且仍然挂起..如何解决？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-12-13T16:10:21.447

假设您的第一个`INNER JOIN`返回 75% 的 1,000,000 行`table1`。第二个查询不会像您想象的那样返回 250,000 行。相反，它会尝试创建笛卡尔积并删除 750,000 个匹配行。因此它试图返回 6,000,000×1,000,000-750,000 行。这是一个膨胀的 6×10 ^(12)行结果集。

你可能想要这个：

```
SELECT * FROM table1
LEFT JOIN table2 ON table2.number = table1.number
WHERE table2.number IS NULL 
```

这将返回中`table1`不存在的行`table2`。

您可能还对以下内容感兴趣`FULL OUTER JOIN`：

```
SELECT * FROM table1
FULL OUTER JOIN table2 ON table2.number = table1.number
WHERE table1.number IS NULL AND table2.number IS NULL 
```

这将返回两个表中在另一个表上没有匹配项的行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-13T16:07:54.970

这不起作用的原因是您基本上将 table1 的每一行与表 2 的每一行连接起来。您需要一些东西来加入它。最好的方法是进行左连接（意味着无论如何它都会连接 table1，但不会连接 table2），然后检查以确保 table2 没有为 null 的条目。然后，您需要对 table2 执行相同的操作。

```
SELECT * FROM `table1` 
LEFT JOIN table2 ON table2.number = table1.number 
WHERE table2.number is NULL

UNION

SELECT * FROM `table2` 
LEFT JOIN table1 ON table2.number = table1.number 
WHERE table1.number is NULL 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-05-08T05:22:40.527

而不是这个，你可以使用这个方法：

```
SELECT * FROM `table1` 
     LEFT JOIN table2 ON table2.number = table1.number 
WHERE 
     table2.number is NULL OR table1.number is NULL 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-18T15:32:25.987

@Álvaro González 当我们想要返回不匹配的记录时，完整的外连接查询不应该使用 OR 而不是 AND：AND 永远不会返回任何记录。

SELECT * FROM table1 FULL OUTER JOIN table2 ON table2.number = table1.number WHERE table1.number IS NULL OR table2.number IS NULL

# php - Magento 中以编程方式添加的捆绑产品无法在前端正确显示

> ID：13863754
> 
> 赞同：1
> 
> 时间：2012-12-13T16:05:17.860
> 
> 标签：php, magento, magento-1.7, bundle

首先：我使用的是 Magento 1.7.0.2。我编写了一个函数，它可以即时创建捆绑产品并将其添加到购物车中。该产品在后端正确显示，但在前端我缺少选项，当我想从购物车中编辑这个项目时。

我还遇到了一个问题，我无法正确地将生成的商品添加到购物车中。它向我显示一个错误：

```
Some of the products below do not have all the required options. Please edit them and configure all the required options. 
```

如果我在后端打开生成的产品并将其保存在那里，它会正确显示前端的每个选项，但仍然出现另一个错误。

到目前为止，这是我的代码：

```
 $storeID = 1;
        $websiteIDs = array(1);
        $cats = array( $this->categoryPresent );
        $productCounter = 0;

        $presentParams['additional'] = 171;  //Product ID
        $presentParams['box'] = 167;  //Product ID
        $presentParams['count'] = 3; //amount of ordered presents

        //Create base bundle with all required attributes
        $product = Mage::getModel('catalog/product');
        $p = array(
          'sku_type' => 0,
          'sku' => 'present - ' . strtotime('now'),
          'name' => "Present",
          'description' => 'Present',
          'short_description' => 'Present',
          'type_id' => 'bundle',
          'attribute_set_id' => 9,
          'weight_type' => 0,
          'visibility' => 4,
          'price_type' => 0,
          'price_view' => 0,
          'status' => 1,
          'created_at' => strtotime('now'),
          'category_ids' => $cats,
          'store_id' => $storeID,
          'website_ids' => $websiteIDs,
          'base_price_amount' => '',
          'base_price_base_amount' => 1,
          'base_price_base_unit' => 'St',
          'options_container' => 'container1'
        );
        $product->setData($p);
        $product->setStockData(array(
            'is_in_stock' => 1,
            'qty' => 99999
        ));

        $optionRawData = array();
        $selectionRawData = array();

        //Insert Box
        $productCounter++;
        $optionRawData[] = array(
              'required' => 1,
              'option_id' => '',
              'position' => $productCounter,
              'type' => 'select',
              'title' => 'Box',
              'default_title' => 'Box',
              'delete' => '',
            );
        $selectionRawData[$productCounter-1] = array();
        $selectionRawData[$productCounter-1][] = array(
              'product_id' => $presentParams['box'],
              'selection_qty' => 1,
              'selection_can_change_qty' => 0,
              'position' => $productCounter,
              'is_default' => 1,
              'selection_id' => '',
              'selection_price_type' => 0,
              'selection_price_value' => 0.0,
              'option_id' => '',
              'delete' => ''
        );

        //Insert Additional
        $productCounter++;
        $optionRawData[] = array(
              'required' => 1,
              'option_id' => '',
              'position' => $productCounter,
              'type' => 'select',
              'title' => 'Zubehör',
              'default_title' => 'Zubehör',
              'delete' => '',
            );
        $selectionRawData[$productCounter-1] = array();
        $selectionRawData[$productCounter-1][] = array(
              'product_id' => $presentParams['additional'],
              'selection_qty' => 1,
              'selection_can_change_qty' => 0,
              'position' => $productCounter,
              'is_default' => 1,
              'selection_id' => '',
              'selection_price_type' => 0,
              'selection_price_value' => 0.0,
              'option_id' => '',
              'delete' => ''
        );

        // Set the Bundle Options & Selection Data ; Save the present
        Mage::register('product', $product);
        Mage::register('current_product', $product);
        $product->setCanSaveConfigurableAttributes(false);
        $product->setCanSaveCustomOptions(true);
        $product->setCanSaveBundleSelections(true);
        $product->setAffectBundleProductSelections(true);
        $product->setBundleOptionsData($optionRawData);
        $product->setBundleSelectionsData($selectionRawData);
        $product->save();

        //Add Product to cart
        $cart = Mage::getSingleton('checkout/cart');

//Try an other way of setting the bundled_option            
/*$option_ids = $product->getTypeInstance(true)->getOptionsIds($product);
        $selectionCollection = $product->getTypeInstance(true)->getSelectionsCollection($option_ids, $product);
        $bundled_items = array();
        foreach($selectionCollection as $key => $option){
            //$bundled_items[$key] = $option->product_id;
            $bundled_items[$key] = 1;
        }

        $params = array(
            'product' => $product->getId(),
            'related_product' => null,
            'bundle_option' => $bundled_items,
            'qty' => $presentParams['count'],
        );*/

        $cart->addProduct( $product, $presentParams['count']);
        $cart->save();
        Mage::getSingleton('checkout/session')->setCartWasUpdated(true); 
```

我认为，只有一小段代码丢失了。我希望，有人可以帮助解决这个问题。

**更新**

捆绑产品在前端生成。所以我发现要做的一件事就是为新产品编制索引。这是附加代码：

```
//Index new item
        $stockItem = Mage::getModel('cataloginventory/stock_item')->loadByProduct($product->getId());
        $stockItem->setForceReindexRequired(true);
        Mage::getSingleton('index/indexer')->processEntityAction(
            $stockItem,
            Mage_CatalogInventory_Model_Stock_Item::ENTITY,
            Mage_Index_Model_Event::TYPE_SAVE
        );

        $product->setForceReindexRequired(true)->setIsChangedCategories(true);
        Mage::getSingleton('index/indexer')->processEntityAction($product, Mage_Catalog_Model_Product::ENTITY, Mage_Index_Model_Event::TYPE_SAVE); 
```

这样，生成的产品就会正确地列在响应类别的列表视图中。但是捆绑包的内容仍然缺失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:08:34.737

我只是想和你分享我用来创建产品的代码。
让我们将其与您的进行比较并搜索错误。

```
 $product = Mage::getModel('catalog/product');

                $product->setSku($sku);
                $product->setName($product_data['name']);
                $product->setDescription($product_data['description']);
                $product->setShortDescription($product_data['name']);
                $product->setPrice($product_data['price'] * $price_multiplier);
                $product->setTypeId('simple');
                $product->setAttributeSetId(9); // need to look this up
                $product->setCategoryIds(implode(',', $local_categories)); // need to look these up
                $product->setWeight(1.0);
                $product->setTaxClassId(0); // taxable goods
                $product->setVisibility(4); // catalog, search
                $product->setStatus(1); // enabled

                // assign product to the default website
                $product->setWebsiteIds(array(1));

                $product->setMediaGallery(array('images' => array(), 'values'=>array()));

                $first = true;
                foreach ($local_images as $local_image_fname) {
                    $ma = array();
                    if ($first) {
                        $first = false;
                        $ma    = array('image', 'small_image', 'thumbnail');
                    }
                    $product->addImageToMediaGallery($local_image_fname, $ma, false, false);
                }

                $stockData        = $product->getStockData();
                $stockData['qty'] = 1;
                $stockData['is_in_stock'] = 1;
                $stockData['manage_stock'] = 1;
                $stockData['use_config_manage_stock'] = 0;
                $product->setStockData($stockData); 

                $product->save();
                $product_id = $product->getId(); 
```

我明白了，你至少不要设置 TaxClassId。和重量。

**编辑**

还有一个建议。您正在将捆绑产品添加到购物车。为什么不设置捆绑选项？你只设置计数。请参阅如何以编程方式将捆绑产品添加到购物车的好示例：

[http://inhoo.net/ecommerce/magento/programatically-add-bundle-product-to-cart-n-magento/](http://inchoo.net/ecommerce/magento/programatically-add-bundle-product-to-cart-n-magento/)

```
$params = array(
    'product' => 164,
    'related_product' => null,
    'bundle_option' => array(
        21 => 58,
        20 => 55,
        11 => 28,
        12 => array(
            0 => 31,
        ),
        13 => array(
            0 => 32,
            1 => 35,
        ),
    ),
    'options' => array(
        3 => 'olaaaaaaaa',
    ),
    'qty' => 2,
);
$cart = Mage::getSingleton('checkout/cart');
$product = new Mage_Catalog_Model_Product();
$product->load(164);
$cart->addProduct($product, $params);
$cart->save();
Mage::getSingleton('checkout/session')->setCartWasUpdated(true);
$message = $this->__('Custom message: %s was successfully added to your shopping cart.', $product->getName());
Mage::getSingleton('checkout/session')->addSuccess($message); 
```

# java - 无法让 ZooKeeper 集群工作，选举永远不会发生

> ID：13863756
> 
> 赞同：2
> 
> 时间：2012-12-13T16:05:26.527
> 
> 标签：java, linux, configuration, hadoop, apache-zookeeper

这是我第一次尝试 ZooKeeper，虽然我可以轻松地将它设置为在单台机器上运行，但让它在两台机器的集群中运行根本不起作用。我认为这可能是我的配置有问题，但看起来我找不到它。

[这是服务器 1 的日志](https://gist.github.com/4277429#file-server_1-log)

[这是服务器 2 的日志](https://gist.github.com/4277429#file-server_2-log)

我对两台服务器的配置如下：

```
# The number of milliseconds of each tick
tickTime=2000
# The number of ticks that the initial
# synchronization phase can take
initLimit=10
# The number of ticks that can pass between
# sending a request and getting an acknowledgement
syncLimit=5
# the directory where the snapshot is stored.
dataDir=/var/lib/zookeeper
# the port at which the clients will connect
clientPort=2181
server.1=redis1:2888:3888
server.2=redis2:2888:3888 
```

关于问题可能是什么的任何想法？

我在运行 OpenJDK 7 的 Ubuntu Linux 机器上运行 ZooKeeper 3.4.5。尝试在 OpenJDK 6 上运行，但仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:04:50.727

问题是我有**偶数**个节点，你需要**奇数**个节点才能进行选举（显然）。应该更新文档以涵盖这一点，因为基本示例显示正好配置了 2 个服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T01:44:49.517

您的配置无效，特别是

```
server.1=redis1:2888:3888
server.2=redis1:2888:3888 
```

如果您在同一主机上运行两个实例，则每个实例都需要不同的端口号，最好是类似

```
server.1=localhost:3181:4181
server.2=localhost:3182:4182 
```

请注意，您应该有相同的 server.# config 用于两个服务器的配置文件。

另一种选择是使用 zkconf 之类的东西为您生成所有这些：http: [//bit.ly/aQP9Yi](http://bit.ly/aQP9Yi)

# c# - 为什么我的查询字符串值在页面加载一定时间后丢失？

> ID：13863757
> 
> 赞同：2
> 
> 时间：2012-12-13T16:05:25.690
> 
> 标签：c#, query-string, session-variables, webmatrix, asp.net-webpages

快速方案为您服务。

我在我的页面中尝试使用查询字符串将值恢复到会话变量，以防它被清除，如下所示：

```
if(Session["species"] == null || Session["species"] == "")
{
    Session["species"] = Request["species"];
} 
```

再往下，我根据这个会话变量的值设置其他两个会话变量之一的值，如下所示：

```
if((string)Session["species"]=="Canine")
{
    Session["dBreed"] = Request.Form["breed"].Trim();
}
else if((string)Session["species"]=="Feline")
{
    Session["cBreed"] = Request.Form["breed"].Trim();
} 
```

但是，似乎一旦会话超时（我相信 20 分钟后），我仍然会收到此错误：

```
Object reference not set to an instance of an object.

Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error: 

Line 134:            errorMessage = "The data received from the \"Age\" field was invalid.";
Line 135:        }
Line 136:        if(((string)Session["dBreed"]).Length > 50)
Line 137:        {
Line 138:            errorMessage = "The data received from the \"Breed\" field was invalid.";

Source File: c:\Users\cradebaugh\Documents\My Web Sites\Vaccinations\InputEntry.cshtml    

(ERRORS ON):  Line: 136 
```

显然，我了解发生了什么（从未分配过 Session["dBreed"] 的值，这可能意味着只有 Session["species"] 变量在被清除后从未被重新分配。

我的问题是：尝试在一定时间后仅在页面上请求查询字符串（使用 Request[“species”]）还是完全发生其他事情？

我可以在我的 URL 中实际看到查询字符串，但似乎我请求的值在会话超时时不再存在。

我已经计划简单地使用隐藏的输入字段来尝试实现与上述相同的目标，但是，我认为最好在将来再次使用查询字符串之前了解以这种方式使用查询字符串的性质。

感谢您的宝贵时间，以及您可能提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:20:48.243

> ... Session["dBreed"] 的值从未被分配，这可能意味着 Session["species"] 变量从未被重新分配...

或者`Session["species"]`设置为`"Feline"`. 查看您的第二个代码块：

```
else if((string)Session["species"]=="Feline")
{
    Session["cBreed"] = Request.Form["breed"].Trim();
} 
```

如果物种是`"Feline"`，你分配`Session["cBreed"]`，不是`Session["dBreed"]`。

# http - 面向服务的架构 - 传输层（http 与消息传递）

> ID：13863761
> 
> 赞同：5
> 
> 时间：2012-12-13T16:05:38.673
> 
> 标签：http, redis, rabbitmq, soa, messaging

我们正在考虑使用面向服务的架构 (SOA) 来拆分我们的架构（并添加新组件）。第三方将使用许多外部 API，我们将使用 REST HTTP 接口进行制作，但是我想知道在内部使用什么是最好的，因为所有组件都在我们的控制范围内并且将在相同的网络，但可能有不同的技术（主要是 .net 和 ruby​​ on rails）。

使用消息系统（redis、rabbitmq、EMS、我没听说过的其他值得注意的例外......）而不是 HTTP（REST、SOAP 等）会不会有很大的性能/功能增益。

我一直在努力寻找关于这个主题的好信息，而且（你可能会说）我对这个领域相当陌生，所以任何建议或好的资源都将不胜感激！

纳克斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-13T16:11:54.347

消息传递倾向于为您提供更松散耦合的架构。它也可能更健壮，因为单个组件可能会在不杀死整个基础架构的情况下发生故障。

缺点是复杂性、向异步模型的范式转变以及可能的性能（特别是如果您在每个地方都持久化消息）。

您还需要确保您的消息传递系统特别健壮。您的逻辑的一个方面可以在不影响所有内容的情况下关闭并重新启动，但是如果您丢失了核心消息库，那么您的所有逻辑都将关闭，等待消息备份。

幸运的是，消息总线可以长时间运行而无需人为摆弄和触摸，这是任何系统中最大的错误和不稳定来源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-16T00:16:58.590

除了@Will Hartung 提到的内容之外，我还要说这取决于您要对系统执行的操作。如果您主要拥有客户端-服务器类型的应用程序，而您的服务器/服务很少并且它们往往是完全独立的，那么通过 HTTP 上的 REST 实现服务合同可能会更容易。

另一方面，如果您的整个系统正在进行双向通信，或者如果有许多进程间调用（特别是如果系统中的每个参与者在某个时候既是客户端又是服务器），那么消息传递是你最好的选择。在消息传递选项中，我发现 AMQP/RabbitMQ 是所有这些选项中功能最丰富且易于使用的。它为您提供了一个真正的异步平台来编写代码。

使用消息传递的主要好处是您可以为每种类型的消息设置队列，因此当您的系统扩展和更改时，队列/消息可以相同，但处理它们的服务可以在下面发生变化。它促进层的分离。

最后，在我看来，这是一件大事，正确使用消息传递可以促进小的、独立的代码片段。这些都更具可测试性和可维护性，并且通常可以简化您的企业架构。如果您尝试处理来自 HTTP 端点的太多服务，您最终（在一两年的过程中）最终会遇到（1）太多端点无法跟踪或（2）无法维护的意大利面条代码.

我的公司开始使用基于消息的框架，它对我们来说效果很好。RabbitMQ 服务器很容易成为最可靠的组件。如果您对消息传递或 SOA 有任何其他问题，请随时询问。

# c# - String.Empty 不是常量值吗？

> ID：13863763
> 
> 赞同：0
> 
> 时间：2012-12-13T16:05:45.173
> 
> 标签：c#, string

> **可能重复：**
> [为什么 String.Empty 不是常量？](https://stackoverflow.com/questions/507923/why-isnt-string-empty-a-constant)

为了使我的代码更具可读性，我尝试分配`String.Empty`一个常量值：

```
const string PLATYPUS_ADDED_AND_ACCEPTED = string.Empty;
if (false) { }
else
{
    toolTip = PLATYPUS_ADDED_AND_ACCEPTED;
} 
```

但我明白了`"the expression being added must be constant"`

不`String.Empty`总是一样的吗？这对我来说似乎很稳定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:08:10.080

`string.Empty`是[只读字段](http://msdn.microsoft.com/library/system.string.empty.aspx)，而不是常量。

编译器无法知道这将始终是相同的值。

# ruby-on-rails - 使用嵌套的参数散列搜索 url

> ID：13863769
> 
> 赞同：0
> 
> 时间：2012-12-13T16:05:56.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我曾经有一个链接可以引导搜索操作并带有某些参数。这是链接（例如）：

```
<%= link_to "search", discover_search_url(:category_id => 3) %> 
```

我的一个朋友重构了该站点，并且做得非常出色，但现在它`category_id`位于一个名为`pieces_search`. 所以`params[:category_id]`我现在不使用，而是使用`params[:pieces_search][:category_id]`.

我的问题是，我现在如何修改我的链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:12:03.000

```
<%= link_to "search", discover_search_url(:pieces_search => {:category_id => 3}) %> 
```

# python - 平台无关的 Python 流/音频模块

> ID：13863773
> 
> 赞同：1
> 
> 时间：2012-12-13T16:06:04.473
> 
> 标签：python, audio, stream, multiplatform, webradio

目前，我正在开发一个流式传输（即播放）Webradio-Audio-Streams 的 Python 程序。因为我是用 gstreamer 实现的，所以它不是独立于平台的。

不幸的是，我似乎无法找到这样一个独立于平台**且未弃用**的模块或框架。

你能给我一些提示吗？

问候。

# apache - xampp 1.8.1。服务器已启动，但别名不起作用

> ID：13863775
> 
> 赞同：0
> 
> 时间：2012-12-13T16:06:09.917
> 
> 标签：apache, xampp, alias

我已经成功升级到 xampp 1.8.1。Apache 和 MySQL 服务器启动良好。

但是，我只是无法让我的别名在 httpd.conf 中工作。IE无法显示页面

我有：

```
Alias /tnl "H:northern_light"
<Directory "H:northern_light">
     DirectoryIndex index.php    
     Options All
     AllowOverride All
     Require all granted
</Directory> 
```

我尝试了很多选择。另外，我尝试在 Apache 上更改端口。

已尝试 127.0.0.1/tnl、localhost/tnl 等

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T21:55:03.147

将您的目录选项替换为：

```
 Alias /tnl "H:/northern_light"
    <Directory "H:/northern_light">
        AllowOverride None
        Options None
        Require all granted
    </Directory> 
```

我个人在选项上使用：“Indexes MultiViews”而不是“none”来允许目录索引。像这样：

```
 Alias /tnl "H:/northern_light"
    <Directory "H:/northern_light">
        AllowOverride None
        Options Indexes MultiViews
        Require all granted
    </Directory> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-08T21:51:42.527

Acordin to ApacheFriends - XAMPP 的创建者

```
# Alias: Maps web paths into filesystem paths and is used to
# access content that does not live under the DocumentRoot.
# Example:
# Alias /webpath /full/filesystem/path
#
# If you include a trailing / on /webpath then the server will
# require it to be present in the URL.  You will also likely
# need to provide a <Directory> section to allow access to
# the filesystem path. 
```

这意味着：

# implementation - 实现撤消操作

> ID：13863776
> 
> 赞同：0
> 
> 时间：2012-12-13T16:06:15.050
> 
> 标签：implementation, undo

假设我们选择了整个文件并删除了其内容。我们如何以节省空间的方式实现此场景的撤消操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:17:20.657

您的问题有点含糊，但命令设计模式可能会对您有所帮助。通过这种方式，您可以封装命令的执行，但也可以选择调用 undo() 并将主题恢复到执行命令之前的状态。它通常用于应用程序中的撤消/重做操作堆栈。

例如，您可以：

```
public interface Command{

  public void exec();
  public void undo();
} 
```

然后对于您可能拥有的每个命令：

```
public class DeleteContents implements Command{

 SomeType previousState;
 SomeType subject;

 public DeleteContents(SomeType subject){
  this.subject = subject; // store the subject of this command, eg. File?
 }

 public void exec(){
   previousState = subject; // save the state before invoking command

   // some functionality that alters the state of the subject
   subject.deleteFileContents();
 }

  public void undo(){

    subject.setFileContents(previousState.getFileContents()); // operation effectively undone
  }

} 
```

您可以将命令存储在数据结构（例如控制器）中，并且可以自由地调用它们的执行和撤消。这对你的情况有帮助吗？

这是一个链接： [http ://en.wikipedia.org/wiki/Command_pattern](http://en.wikipedia.org/wiki/Command_pattern)

# json - Spring json 未使用所需的根名称

> ID：13863785
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:06:40.130
> 
> 标签：json, rest, spring-3

我有以下配置：

```
 <property name="defaultViews">
            <list>
                <!-- JSON View -->
                <bean    class="org.springframework.web.servlet.view.json.MappingJacksonJsonView" />
                <!-- XML View -->
                <bean class="org.springframework.web.servlet.view.xml.MarshallingView">
                    <constructor-arg>
                        <bean class="org.springframework.oxm.xstream.XStreamMarshaller">
                            <property name="autodetectAnnotations" value="true" />
                        </bean>
                    </constructor-arg>
                </bean>
            </list>
        </property> 
```

它创建了一个 json，但根名称不是我想要的

```
@XStreamAlias("house")
@JsonAutoDetect
@JsonRootName(value = "house")  
public class TableHouse {

    private Long value;

.....
} 
```

对于 xml，它工作正常，但是对于 json，它不会选择 @JsonRootName.. 并以类名作为 root 输出 json...

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T16:48:25.147

您必须启用根级包装。请参阅[如何使用 Java Jackson 重命名 JSON 的根键？](https://stackoverflow.com/questions/8034933/how-do-i-rename-the-root-key-of-a-json-with-java-jackson)了解如何正确使用 JsonRootName。

# html - 在 IE8 中使用 CSS3 PIE 实现渐变效果

> ID：13863788
> 
> 赞同：1
> 
> 时间：2012-12-13T16:07:02.930
> 
> 标签：html, css, css3pie

我正在使用[CSS3PIE](http://www.css3pie.com/)为 div 生成渐变背景。

```
-pie-background: linear-gradient(#BFBBBB, #FFFFFF); 
```

上面的代码呈现了想要的效果。但这会用渐变填充 div 的完整高度。

我需要将渐变限制为从 div 顶部开始的几个像素（或百分比）。

Chrome 的 CSS3 等效项是

> 背景：-webkit-渐变（线性，左上，左下，颜色停止（0％，#BFBBBB），颜色停止（30％，#FFFFFF））；

这里的关键是`color-stop(30%, #FFFFFF)`。如果您之前使用过 CSS3 PIE，请建议如何`color-stop`使用 CSS3-PIE 获取属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T15:57:39.993

```
linear-gradient(#BFBBBB, #FFFFFF 30%); 
```

PIE 使用标准梯度语法（除了在规范中更改但尚未在 PIE 中更新的方向参数。）

说到这一点，您还应该为其他浏览器使用标准语法（必要时加前缀）。旧的 -webkit-gradient 语法不再是当前的首选语法。

# c# - 带有枚举的 MVC3 RadioButtonFor

> ID：13863790
> 
> 赞同：6
> 
> 时间：2012-12-13T16:07:09.437
> 
> 标签：c#, asp.net, .net, asp.net-mvc, asp.net-mvc-3

我的模型中的 HtmlHelper、RadioButtonFor 和枚举存在问题。我有一个强类型视图，我希望复选框来切换我的枚举属性。

```
Enum.cs

public enum Values{
    Value1,
    Value2
} 
```

* * *

```
Model.cs

public class Model{
    public Values MyProp{ get; set; }
; 
```

* * *

```
View.cshtml

@Html.RadioButtonFor(model => model.MyPropi, Values.Values1) 
```

* * *

```
Controller.cs
public ActionResult WizardFirstStep()
{
    var model = new Model();
    return View(model);
} 
```

如果我在控制器中设置 MyProperty 值，则会按预期检查 RadioButton。但是在发布到下一个向导步骤（将模型作为参数）之后，该属性未设置。

如果它可以帮助您理解我的意思：如果是 C# 和 WPF，我会使用 IValueConverter。

顺便说一句：我使用 HtmlHelper.ActionLink 将模型获取到控制器。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:11:19.977

试试这个，它应该像我以前做过同样的事情一样工作：

```
@Html.RadioButtonFor(model => model.MyProp, (int)Values.Values1, model.MyProp == Values.Values1) 
```

注意转换为`int`，它确保 html 使用正确的值。

**编辑**：对不起，我认为您还需要第三个参数来确保在加载视图时设置了正确的单选按钮。

我还假设`MyPropi`是一个错字并将其更改为`MyProp`，请确保在您的末尾正确匹配

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:26:55.907

任何不便敬请谅解。在这里发布后，我很快找到了解决方案。我的 ActionLink 没有提交 @Html.BeginForm 表单。所以我将我的单选按钮更改为：

```
@Html.RadioButtonFor(model => model.MyPropi, Values.Values1, new{ onClick = "this.form.submit();" }) 
```

它将正确的值提交给我的控制器。目前这没关系。也许 ActionLink 可以回发表单数据。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-09-09T06:40:59.833

对于 Aspx 页面：<%:Html.RadioButtonFor(m => m.YourProp, 选择的枚举值，例如：demo1.enum1.value2)

# java - 用几个曲线球在 Swing JTextArea 上强制执行最大字符

> ID：13863795
> 
> 赞同：1
> 
> 时间：2012-12-13T16:07:34.407
> 
> 标签：java, swing, jtextarea

我正在尝试向 Swing JLabel 和 JTextArea 添加功能，以便：

*   用户只能在 textarea 中输入 500 个字符（最大）
*   标签包含一个字符串消息，告诉用户他们还剩下多少个字符（在每次击键或退格之后）
*   当组件初始化时，标签显示“最多 500 个字符！”
*   对于键入的前 500 个字符，对于键入的每个键击（a - z、A - Z、0 - 9 和标点符号），标签显示“剩余 x 个字符”，其中`x`是它们在到达前剩余的字符数最多 500
*   键入第 500 个字符时，标签显示“剩余 0 个字符”，文本区域不能再键入更多字符
*   如果用户键入退格按钮 ( `KeyEvent.VK_BACK_SPACE`)，他们会“释放”一个字符，并且计数会增加。因此，如果他们还剩 400 个字符，并且他们键入退格键，则标签现在显示为“剩余 401 个字符”
*   如果用户突出显示一组字符并对它们执行批量命令（例如退格，或用单个字符替换突出显示的文本），则正确计算剩余字符数并更新标签。因此，如果他们剩余 50 个字符，并且他们突出显示 5 个字母并按退格键，他们现在有“剩余 55 个字符”

我有 90% 的这个功能可以工作，但是有一些错误，并且不知道如何实现上面的最后一项（突出显示文本上的批量命令）。这是我所拥有的：

```
boolean ignoreInput = false;
int charMax = 500;
JLabel charCntLabel = getLabel();
JTextArea myTextArea = getTextArea();

myTextArea.addKeyListener(new KeyListener() {
    @Override
    public void keyTyped(KeyEvent e) {
        return;
    }

    @Override
    public void keyReleased(KeyEvent e) {
        // If we should be ignoring input then set make sure we
        // enforce max character count and remove the newly typed key.
        if(ignoreInput)
            myTextArea.setText(myTextArea.getText().substring(0,
                myTextArea.getText().length()));
    }

    @Override
    public void keyPressed(KeyEvent e) {
        String charsRemaining = " characters remaining";
        int newLen = 0;

        // The key has just been pressed so Swing hasn't updated
        // the text area with the new KeyEvent.
        int currLen = myTextArea.getText().length();

        // Adjust newLen depending on whether the user just pressed
        // the backspace key or not.
        if(e.getKeyCode() == KeyEvent.VK_BACK_SPACE) {
            newLen = currLen - 1;
            ignoreInput = false;
        }
        else
            newLen = currLen + 1;

        if(newLen < 0)
            newLen = 0;

        if(newLen == 0)
            charCntLabel.setText(charMax + " characters maximum!");
        else if(newLen >= 0 && newLen < charMax)
            charCntLabel.setText((charMax - newLen) + charsRemaining);
        else if(newLen >= charMax) {
            ignoreInput = true;
            charCntLabel.setText("0 " + charsRemaining);
        }
    }
}); 
```

上面的代码运行良好，但有一些错误：

*   它不会阻止用户输入超过 500 个字符。当用户输入第 500 个字符时，标签显示“剩余 0 个字符”。但之后您可以继续输入字符，标签保持不变。
*   如果 textarea 中有 > 500 个字符，并且开始退格，您会看到每个字符都从 textarea（底层模型）中删除，但标签保持不变。**但是**，一旦您退格到第 500 个字符，并且您退格，标签将开始正确更改，告诉您“剩余 1 个字符”、“剩余 2 个字符”等。所以...
*   此代码似乎有效，但仅停止工作 > 500 个字符。一旦你回到最大 500 个字符的范围内，它就会再次开始工作。

### 问题

1.  有没有更简单的方法来实现这个所需的功能（以及 Swing JTextArea）？我觉得我在这里重新发明了轮子，并且可能有一种“更清洁”的方式来强制执行字符最大值并更新它们各自的标签。
2.  如果没有，有人能发现我 > 500 字符的错误吗？我整个早上都在看它，正在拔头发。
3.  **最重要**的是，我如何实现处理批量命令以突出显示文本的要求？如何在 textarea 中处理文本选择，监听突出显示文本的更改（例如，使用退格按钮删除多个突出显示的字符等），并正确计算剩余字符的新值？

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-13T16:18:47.597

您可以使用[DocumentFilter](http://docs.oracle.com/javase/1.7.0/docs/api/javax/swing/text/DocumentFilter.html)来限制最大大小，查看此[文档部分](http://docs.oracle.com/javase/tutorial/uiswing/components/generaltext.html#filter)，它有一个您需要的[工作示例。](http://docs.oracle.com/javase/tutorial/uiswing/examples/components/TextComponentDemoProject/src/components/DocumentSizeFilter.java)

以此为例，我使用了上面示例文件中的组件：

```
import java.awt.BorderLayout;

import javax.swing.*;
import javax.swing.event.*;
import javax.swing.text.*;

import components.DocumentSizeFilter;

public class Test {

    public static void main(String[] args) {
        new TestFrame().setVisible(true);
    }

    private static class TestFrame extends JFrame{
        private JTextField textField;
        private DefaultStyledDocument doc;
        private JLabel remaningLabel = new JLabel();

        public TestFrame() {
            setLayout(new BorderLayout());

            textField = new JTextField();
            doc = new DefaultStyledDocument();
            doc.setDocumentFilter(new DocumentSizeFilter(500));
            doc.addDocumentListener(new DocumentListener(){
                @Override
                public void changedUpdate(DocumentEvent e) { updateCount();}
                @Override
                public void insertUpdate(DocumentEvent e) { updateCount();}
                @Override
                public void removeUpdate(DocumentEvent e) { updateCount();}
            });
            textField.setDocument(doc);

            updateCount();

            add(textField, BorderLayout.CENTER);
            add(remaningLabel, BorderLayout.SOUTH);

            setLocationRelativeTo(null);
            pack();
        }

        private void updateCount()
        {
            remaningLabel.setText((500 -doc.getLength()) + " characters remaining");
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-02T10:31:54.267

evt.consume(); 在这种情况下会有很大帮助..你不需要使用 DocumentFilter。这是将用户限制在一定长度的一种更简单的方法

```
private void jTextArea1KeyTyped(java.awt.event.KeyEvent evt) {                                    
    String s=jTextArea1.getText();
   int l=s.length();
   jTextField1.setText(String.valueOf(l));
   int i=10-l;
   jTextField2.setText(String.valueOf(i));
   try{
   if(l>=10){evt.consume();
   }
   }
   catch(Exception w){}

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-04T17:06:02.650

补充 Ray S. Kan 所说的话：

有一种更简单的方法来限制 JTextArea 的字符，而不必使用 Ray S. Kan 所示的 DocumentFilter，但他的答案的问题是它不会阻止某人粘贴长文本。以下将阻止用户粘贴内容以绕过限制：

```
@Override
public void keyTyped(KeyEvent e) {
    int max = 25;
    if(text.getText().length() > max+1) {
        e.consume();
        String shortened = text.getText().substring(0, max);
        text.setText(shortened);
    }else if(text.getText().length() > max) {
        e.consume();
    }
} 
```

如果长度不超过最大值，这将阻止按键被按下，但如果超过最大值，它将简单地将文本区域中的字符串替换为较短的字符串。该`text`变量是 JTextArea 摆动对象。

# android - 原始的 Android mp4 视频在 Widevine 签名后不起作用

> ID：13863797
> 
> 赞同：2
> 
> 时间：2012-12-13T16:07:35.500
> 
> 标签：android, mp4

我的问题是，在与 Widevine 签约之前，视频会按原样显示。

该视频位于资源/原始

我得到的错误是：

```
I/MediaPlayer(23023): path is null
D/MediaPlayer(23023): Couldn't open file on client side, trying server side 
```

有没有人知道这个错误的根源甚至是解决方法？

我试图将视频放在资产中，但没有区别

在此先感谢，我希望有人可以帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T23:45:19.517

假设widewine是drm，你需要先解密才能玩。Widewine 会给你一个播放器或一个解密库，你必须使用它来解密内容，然后才能播放它。

# asp.net-mvc - 序列化类型对象时检测到循环引用？

> ID：13863798
> 
> 赞同：1
> 
> 时间：2012-12-13T16:07:36.220
> 
> 标签：asp.net-mvc, json, jquery-easyui

**DB MetersTree 表**

```
id       text   parentId    state

 0       root          0     open
 1    level 1          1     open
 2    level 1          1     open
 ... 
```

**控制器**

```
public ActionResult GetDemoTree()
{
    OsosPlus2DbEntities entity = new OsosPlus2DbEntities();
    MetersTree meterTree = entity.MetersTree.FirstOrDefault();

    return Json(meterTree, JsonRequestBehavior.AllowGet);
} 
```

**应该是（例如）的**数据格式****

 **```
[{  
    "id": 1,  
    "text": "Node 1",  
    "state": "closed",  
    "children": [{  
        "id": 11,  
        "text": "Node 11"  
    },{  
        "id": 12,  
        "text": "Node 12"  
    }]  
},{  
    "id": 2,  
    "text": "Node 2",  
    "state": "closed"  
}] 
```

如何创建树 Json 数据？如果我用它的关系编写 MetersTree，我会得到标题中定义的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:13:34.133

您需要打破由于 EF 类中的导航属性而被拾取的循环引用。

您可以将结果映射到这样的匿名类型，尽管这是未经测试的：

```
public ActionResult GetDemoTree()
{
    OsosPlus2DbEntities entity = new OsosPlus2DbEntities();
    MetersTree meterTree = entity.MetersTree.FirstOrDefault();

    var result = from x in meterTree
           select new 
            {
            x.id,
            x.text,
            x.state,
            children = x.children.Select({
                c => new {
                    c.id,
                    c.text
                })
         };

    return Json(result, JsonRequestBehavior.AllowGet);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T12:46:12.240

我是这样解决的：

**查看模型**

```
public class MetersTreeViewModel
{
    public int id { get; set; }
    public string text { get; set; }
    public string state { get; set; }
    public bool @checked { get; set; }
    public string attributes { get; set; }
    public List<MetersTreeViewModel> children { get; set; }
} 
```

**控制器**

```
public ActionResult GetMetersTree()
{
    MetersTree meterTreeFromDb = entity.MetersTree.SingleOrDefault(x => x.sno == 5); //in my db this is the root.
    List<MetersTreeViewModel> metersTreeToView = buildTree(meterTreeFromDb.Children).ToList();

    return Json(metersTreeToView, JsonRequestBehavior.AllowGet);
} 
```

**构建树方法**

```
private List<MetersTreeViewModel> BuildTree(IEnumerable<MetersTree> treeFromDb)
{
    List<MetersTreeViewModel> metersTreeNodes = new List<MetersTreeViewModel>();
    foreach (var node in treeFromDb)
    {
        if (node.Children.Any())
        {
            metersTreeNodes.Add(new MetersTreeViewModel
            {
                id = node.sno,
                text = node.Text,
                state = node.Text,
                children = BuildTree(node.Children)
            });
        }
        else {
            metersTreeNodes.Add(new MetersTreeViewModel
            {
                id = node.sno,
                text = node.Text,
                state = node.Text
            });
        }
    }

    return metersTreeNodes;
} 
```

感谢所有对...感兴趣的人**

# java - 如何在复合材料中查找标签

> ID：13863808
> 
> 赞同：2
> 
> 时间：2012-12-13T16:07:55.190
> 
> 标签：java, swt, composite

我正在尝试刷新复合材料中的 clabel。然而，clabel 并不总是存在。我需要一种方法来检查复合材料中是否存在。我已经尝试了`getChildren`复合材料上的类，并且我已经能够使用它来找到`CLabel`复合材料上的所有 '，但我无法解析它们。

这是我到目前为止所拥有的

```
Control[] childs = comp.getChildren();

for (int i = 0; i < childs.length; i++) {
    if(childs[i].getClass().getSimpleName().equalsIgnoreCase("CLabel")){

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:10:49.770

为什么不使用[`instanceof`](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op2.html)然后施放呢？

```
Control[] children = comp.getChildren();

for (int i = 0; i < children.length; i++)
{
    if(children[i] instanceof CLabel)
    {
        CLabel label = (CLabel) children[i];

        /* Do something with the label */
    }
} 
```

# objective-c - 对于 iOS 6，如何在后台线程上加载数据然后更新 UI？

> ID：13863812
> 
> 赞同：3
> 
> 时间：2012-12-13T16:08:10.870
> 
> 标签：objective-c, ios, xcode, ipad

有很多方法可以做到这一点，但是 IOS 6 应用程序当前、现代、正确的方法是什么？

这就是我现在正在做的事情：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    __weak MyViewController *weakSelf = self;

    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,
                                         (unsigned long)NULL), ^(void) {
        // Do work that will take a long time
        // Store data in member variables, etc.

        // Update the UI 
        dispatch_async(dispatch_get_main_queue(), ^{
            [weakSelf.myTableView reloadData];
        });
    }
} 
```

对于 ARC，我不认为 __weak 引用是必要的，但我不能 100% 确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:53:47.370

你正在做的是完全正确的方法！使用块时需要弱引用，并且完全是 ARC。在 ARC 之前，“弱”还不存在。

# c++ - 如何禁用特定的 IBM XL C++ 编译器警告？

> ID：13863815
> 
> 赞同：1
> 
> 时间：2012-12-13T16:08:18.840
> 
> 标签：c++, pragma, suppress-warnings, xlc

给定 tmp.cpp：

```
#include <stdio.h>

#pragma report(disable, CCN8826)

int main(int argc, const char *argv[])
{
    const char * hi = "hi\n";
    printf(hi);

    return 0;
} 
```

尽管我使用`#pragma report`它应该抑制警告，但我仍然得到：

```
bash-3.1$ xlC -qformat=all tmp.cpp
"tmp.cpp", line 8.12: 1540-2826 (W) The format string is not a string literal 
and format arguments are not given. 
```

如何摆脱该警告？

错误消息编号在[此处](http://publib.boulder.ibm.com/infocenter/zos/v1r11/index.jsp?topic=/com.ibm.zos.r11.cbcdg01/cbcdg17003.htm)，#pragma 报告说明在[此处](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/pragma.htm)。我的编译器是 IBM XL C/C++ Advanced Edition for Blue Gene/P, V9.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T04:12:49.613

如消息所示，其消息标识符为 1540-2826，因此将 #pragma 报告更改为：

#pragma 报告（禁用，“1540-2826”）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:11:41.900

我知道它不能直接回答您的问题，但您可以通过将代码更改为来避免警告

```
printf("%s", hi); 
```

如果您有：

```
void f(char * s) { printf(s); } 
```

您可以将其修改为：

```
void f(char * s) { printf("%s", s); } 
```

摆脱警告。

编辑：处理您的新问题的一种简单、有限、可能令人讨厌的方式是

```
char buf[1024];
snprintf(buf, sizeof(buf), "%s %s", "bloody", "warning");
fprintf(stderr, "%s", buf); 
```

可以将其概括为以下内容（未经测试！）

```
my_printf(const char* fmt, ...)
{
    va_list ap;
    char buf[1024];
    vsnprintf(buf, sizeof(buf), fmt, ap);
    fprintf(stderr, "%s", buf);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-18T11:53:40.113

IBM XL C++ 生成的错误消息标识取决于操作系统。在 z/OS 上，消息 ID 看起来像 CCN8826，但在其他地方它们看起来像 1540-2826。

在 z/OS UNIX 系统服务上，使用编译代码`xlc++ tmp.cpp`不会产生警告或错误。在任何情况下，添加

```
-qsuppress=CCN8826 
```

如果确实出现该错误，则到 xlc++ 命令行应该可以解决问题。根据 Josh Milthorpe 的回答，

```
-qsuppress=1540-2826 
```

应该在使用该消息 ID 格式的操作系统上工作。

请注意，**并非所有消息都可以被禁止**，因此如果您收到有关您试图禁止的消息的投诉，那可能是因为该特定消息无法被禁止，即使您使用正确的格式来指定要禁止的消息.

z/OS V2R2 [XL C/C++ 消息](https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.2.0/com.ibm.zos.v2r2.cbcux01/suppress.htm)文档建议只能抑制消息编号 3000 到 4399（对于 C）、5001 到 6999 和 7500 到 8999（对于 C++）。如果我`-qsuppress=CCN1142`在 z/OS UNIX 系统服务上为产生消息 CCN1142 的源文件指定，那么我会收到关于“使用选项“SUPPRESS”指定的无法识别的值“CCN1142”的投诉。继续上报消息CCN1142。 `-qsuppress=CCN8826`不产生任何抱怨。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-27T15:03:15.777

您可以通过传递 flag 告诉编译器不要生成此警告（对于任何代码，而不仅仅是相关行）`-qsuppress=1540-2826`。

要抑制多个警告，请使用分号分隔代码，例如`-qsuppress=1540-2826:1540-0809`.

# machine-learning - 物体识别和尺寸测量

> ID：13863816
> 
> 赞同：5
> 
> 时间：2012-12-13T16:08:20.593
> 
> 标签：machine-learning, computer-vision, image-segmentation, object-recognition

我想创建一个用于工厂的系统来测量从装配线上下来的物体的大小。这些物体是石板，近似矩形，我想要宽度和高度。每块石头都是用闪光灯在同一位置拍摄的，所以条件控制得很好。棘手的部分是石头有时在其表面上有图案（通常是带有波纹和条纹的大理石），有时它们几乎是黑色的，与阴影融为一体。

我尝试简单地从背景的参考图像中减去每个图像，但是照明和滚轮的位置以及小机器的位置有足够小的变化，以至于输出真的很嘈杂。

我计划接下来尝试的方法是使用 Canny 的边缘检测算法，然后使用某种数值优化（可能是 Nelder-Mead）将 4 边多边形与边缘匹配。但是，在我自制一些东西之前，是否有一种在这种情况下效果很好的现有方法？

*如果有帮助，则可以使用已知在平板内的图像补丁（它们总是在角落里排列）来“播种”算法，以帮助识别其表面图案和颜色。如有必要，我还可以生成一组带注释图像的训练集。*

背景的一些示例图像和一些石板：

![背景](../Images/f4702e9893203231a45587bc35225a51.png) ![简易案例](../Images/644e4e347e15219867844f21a7fad954.png) ![疑难病例1](../Images/26b4fc3b256d7f9502fa6756b57a9edd.png) ![疑难病例2](../Images/0e65c454baab305fd22440fc9084de1a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T20:52:49.297

您是否尝试过现有的图像分割算法？

我将从 Vladimir Kolmogorov 的图像分割的 maxflow 算法开始：http://pub.ist.ac.at/~vnk/software.html[在](http://pub.ist.ac.at/~vnk/software.html) 论文中，他们将图像的区域固定为属于特定段，其中会帮助您解决问题，但如何在软件中执行此操作可能并不明显。

Richard Socher 用于解析场景的深度学习算法也可能有所帮助： http: [//www.socher.org/](http://www.socher.org/)

Eric Sudderth 在这里至少有一种有趣的视觉场景理解方法：[http ://www.cs.brown.edu/~sudderth/software.html](http://www.cs.brown.edu/~sudderth/software.html)

我实际上也没有使用过任何这个软件，如果不是全部的话，它主要是用于研究，而不是特别用户友好。

# css - 如何克服现有的 css 并将按钮样式更改为默认的 windows 样式按钮？

> ID：13863819
> 
> 赞同：1
> 
> 时间：2012-12-13T16:08:39.783
> 
> 标签：css

**问题：** 一个现有的资源依赖项*（我不允许更改或从构建中删除）*，其中包含指示不需要的按钮样式的样式表。我想以某种方式克服此样式表对我页面中按钮样式的影响。

**问题：** 使用我自己的本地样式表，我怎样才能恢复到默认的 Windows css 按钮样式（背景、形状、文本）？-我不知道 css 属性应该是什么，等等（我假设我必须使用“！important”短语等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:11:34.117

每个浏览器都有自己的一组默认 CSS 规则。没有“Windows”CSS，除非您明确提到 IE，它尽最大努力匹配所述样式。您需要找到首选浏览器的默认设置，并将它们附加到新 CSS 之后，以将它们否决回默认主题。

一些常见的浏览器默认样式：

*   [火狐](http://mxr.mozilla.org/mozilla-central/source/layout/style/html.css)
*   [铬合金](http://trac.webkit.org/browser/trunk/Source/WebCore/css/html.css)
*   [IE](http://www.iecss.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:13:06.770

不要使用`!important`

而是以更高的特异性定义您的按钮样式，并为您的按钮提供所需的外观。所以如果在原始样式表中你有

```
button { ... } 
```

然后在你的样式表中做

```
#parent button { ...  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:28:56.860

您不会也不应该使用 !important。您只需要按照 CSS 特异性和继承的原则正确覆盖即可。

[CSS继承的解释](http://coding.smashingmagazine.com/2010/04/07/css-specificity-and-inheritance/)

例如——假设你的“不需要的”按钮样式是这样的：

```
<input type="button" class="unwanted" /> 
```

而且您的（不可编辑的）样式表中有 CSS：

```
.unwanted {
fooRule: whatever;
barRule: whatever;
} 
```

使用继承，您只需要编写自己的外部样式表。要记住的事情：

(1) 你应该把它放在包含“不需要的”样式表引用的现有下面。继承按顺序处理外部样式表。这遵循“最接近规则获胜”的原则。(2) 你编写 CSS 规则的方式必须比当前应用不需要的样式的规则更具体。同样，上面的链接确实有助于解释这一点。

回到我们之前的例子，不需要的样式只是被一个“不需要的”类所应用。您的规则可以在不编辑 HTML 的情况下覆盖。或者，您可以编辑 HTML——这取决于您。它还取决于您希望在多大程度上影响按钮样式。

如果你想全局影响所有具有“不需要”类的按钮，你会这样做：

```
input[type='button'] .unwanted {
fooRule:override;
} 
```

如果您只想更改一些具有不需要样式的按钮，您可以这样做：

```
.unwanted.newRule {
fooRule:override;
} 
```

然后你会将你的 HTML 修改为：

```
<input type="button" class="unwanted newRule"> 
```

请注意，.unwanted.newRule 意味着它只会影响具有不需要和 newRule 类的“元素”。如果不需要的样式是这样设置的，它不会改变任何东西：

```
<form class="unwanted">
    <input type="button" class="newRule" />
</form> 
```

.unwanted.newRule 的原因意味着“两个类都在同一个元素上”。您可以将其更改为：

```
.unwanted .newRule {foo} 
```

所以——我的观点是，有很多语义上正确的方法可以正确地利用 CSS 特异性和继承性，并做你想做的事，而不必使用 !important。

附带说明一下，您必须使用 !important 的唯一原因是，按钮的 CSS 样式是否实际上是使用将“样式”属性写入 HTML 元素的 javascript 应用的。如果是这种情况，（1）不要使用那个 JS，因为这是使用 JS 进行样式设置的可怕方法，（2）你将不得不使用 !important 来覆盖 JS 应用的内联样式。同样，这是因为级联的工作原理——在这种情况下，CSS 由 (1) 浏览器（用户代理）、(2) 外部 css、(3) 内部“head” css、(4) 内部内联 css 应用， (5) author !important 声明，(6) user !important 声明。

# php - 使用 AJAX/jQuery 填充 #containers 的 Joomla 组件

> ID：13863821
> 
> 赞同：0
> 
> 时间：2012-12-13T16:08:44.363
> 
> 标签：php, jquery, mysql, ajax, joomla

我一直在广泛阅读有关将 AJAX 合并到我的 Joomla 组件中的内容，但我觉得我错过了一步。这是我到目前为止的结构：

**AJAX 调用**

```
var url = "index.php?option=com_mls&task=ListData&format=raw";

$(document).ready(function() {
    $('#submit').click(function() {         

        $.ajax({
            url: url,
            type: "POST",
            dataType: 'json',
            success: function() {
                $('#content').load('data.php');
            }
        });
    });
}); 
```

**数据.php**

```
$array = [! I need a way to get the results from controller.php !]

foreach($array as $key => $value){
    echo "<div>" . $value['2']; "</div>
} 
```

**控制器.php**

```
function ListData()
{
    $query = [! A bunch of "JRequest::getVar" that builds the query !];
    $db->setQuery($query);
    $array = $db->loadRowList();

    echo (json_encode($array));

} 
```

我缺少的步骤是从控制器任务中获取数据并进入`#content`节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:18:25.333

你可以试试这个：

```
$(document).ready(function() {
   $('#submit').click(function() { 
     var url = "index.php?option=com_mls&task=ListData&format=raw";
     $.ajax({
        url: url,
        type: "POST",
        dataType: 'json',
        success: function(data) {
            $('#content').html(data);
        }
    });
  });
}); 
```

# asp.net - 使用服务器端分隔符时如何转义字符

> ID：13863822
> 
> 赞同：5
> 
> 时间：2012-12-13T16:08:49.497
> 
> 标签：asp.net, escaping, server-side-scripting

所以，目前，在 asp gridview 中，我有以下内容

```
<span id="btnEdit" runat="server" onclick="ShowEditCriteriaFilterDialog('<%#Eval("intSMCID")%>', '<%#Eval("strDescription")%>')" class="linkText">Edit</span> 
```

我本质上正在寻找的是引号/双引号的语法来真正正确地完成这个，因为我上面的内容不能正常工作。

首先，如果我用单引号封装整个 onclick，而不是在里面放任何其他引号，它可以用于渲染目的，但是当我在运行时实际单击链接时，什么也没有发生。

如果我用双引号封装整个 onclick，就像 ASPX 元素的大多数属性一样，它不会正确呈现，并且第一个 <%#Eval %> 语句之后的逗号之后的所有内容都会显示为实际文本屏幕。这使我相信需要进行一些转义，以防止它认为单击处理程序在该 <%#Eval %> 语句的中间某处结束。

请注意，如果我删除 runat="server" 并将其封装在双引号中，这似乎效果更好......但我需要跨度成为页面中许多其他功能的服务器端控件我需要通过 FindControl 访问控件的代码后面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:37:58.210

该`Eval`函数需要双引号，因此您必须将属性值用单引号括起来。

您不能将静态内容和`<%# ... %>`块混合在带有 的控件的单个属性值中`runat="server"`，因此您需要在单个`<%# ... %>`块中构建整个字符串。

~~在`<%# ... %>`块中的字符串中，您可以使用`&apos;`插入单引号：~~
**EDIT**仅适用于 .NET 4.0；在 2.0 中，它`&amp;apos;`会生成 ，这是行不通的。改用双引号：

```
onclick='<%# string.Format(
   "ShowEditCriteriaFilterDialog(\"{0}\", \"{1}\")", 
   Eval("intSMCID"), Eval("strDescription")) %>' 
```

根据您的数据，您可能还需要对 JavaScript 的字符串值进行编码：

```
onclick='<%# string.Format(
   "ShowEditCriteriaFilterDialog(\"{0}\", \"{1}\")", 
   Eval("intSMCID"), 
   HttpUtility.JavaScriptStringEncode(Eval("strDescription", "{0}"))) %>' 
```

*（为了可读性而包装的代码 - 它需要在一行上。）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:34:21.910

我认为解决方案是

```
onclick='<%# "ShowEditCriteriaFilterDialog(" +Eval("intSMCID") + ","+ Eval("strDescription") +" );" %>' 
```

# xml - 使用 XSLT 将 XML 片段添加到现有 XML

> ID：13863824
> 
> 赞同：0
> 
> 时间：2012-12-13T16:08:53.233
> 
> 标签：xml, xslt, add, transformation, mule

我正在尝试使用 XSLT 将一段 XML 添加到输入 XML。但是输出并没有像预期的那样出现。请帮忙。

我的输入 XML ：

```
 <input  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:noNamespaceSchemaLocation="nbA2.8.90.xsd">
        <nodeA id="test">
            <inodeAA> Sample </inodeAA>
            <inodeAB> Samples </inodeAB>
        </nodeA>
        <nodeB id="test">
            <inodeBA> Sample </inodeBA>
            <inodeBB> Samples </inodeBB>
        </nodeB>
    </input> 
```

下面是另一个 XML 片段，我将其作为参数传递给我 XSLT。这段将被添加到输入 XML 中：

```
 <ns3:output xmlns:ns3="http://mysample.org">
        <ns3:reply id="rep">
            <ns3:zip>55555</ns3:zip>
            <ns3:place>SampleLoc</ns3:place>
        </ns3:reply>
    </ns3:output> 
```

以下是我的预期输出：

```
 <input xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:noNamespaceSchemaLocation="nbA2.8.90.xsd">
        <nodeA id="test">
            <inodeAA> Sample </inodeAA>
            <inodeAB> Samples </inodeAB>
        </nodeA>
        <nodeB id="test">
            <inodeBA> Sample </inodeBA>
            <inodeBB> Samples </inodeBB>
        </nodeB>

        <ns3:output xmlns:ns3="http://mysample.org">
            <ns3:reply id="rep">
                <ns3:zip>55555</ns3:zip>
                <ns3:place>SampleLoc</ns3:place>
            </ns3:reply>
        </ns3:output>

    </input> 
```

以下是我用于此任务的 XSL：

在下面的 XSLT 中，参数“outParam”包含我试图添加到我输入的 xml 片段。

```
 <xsl:stylesheet version="2.0"
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
        xmlns:ns3="http://mysample.org"
        exclude-result-prefixes="soap xsl">
        <xsl:output omit-xml-declaration="yes" indent="yes" />

        <xsl:param name="outParam"></xsl:param>

        <xsl:template match="input">
            <input>
                <xsl:copy-of copy-namespaces="no" select="./@*" />
                <xsl:copy-of copy-namespaces="no" select="node() | @*" />
            </input>
            <xsl:copy >
                <xsl:value-of select="$outParam" disable-output-escaping="yes" ></xsl:value-of>
            </xsl:copy>
        </xsl:template> 
    </xsl:stylesheet> 
```

下面是我得到的输出。这与我的预期输出不符。

```
 <input xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ns3="http://mysample.org"  
        xsi:noNamespaceSchemaLocation="nbA2.8.90.xsd" >
        <nodeA id="test">
            <inodeAA> Sample </inodeAA>
            <inodeAB> Samples </inodeAB>
        </nodeA>
        <nodeB id="test">
            <inodeBA> Sample </inodeBA>
            <inodeBB> Samples </inodeBB>
        </nodeB>
    </input>
    <input xmlns:xsd="http://www.w3.org/2001/XMLSchema"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">   
        <ns3:output xmlns:ns3="http://mysample.org">
            <ns3:reply id="rep">
                <ns3:zip>55555</ns3:zip>
                <ns3:place>SampleLoc</ns3:place>
            </ns3:reply>
        </ns3:output>
    </input> 
```

请帮忙。我尝试了很多组合，但没有运气。:(

注意：我正在使用 Mule XSLT 转换器执行此转换，该转换器基于提供的 XSLT 转换有效负载 XML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:13:29.560

如果参数是一个节点或节点序列，您只需要

```
<xsl:template match="input">
  <xsl:copy>
     <xsl:copy-of select="@* , node(), $outParam"/>
  </xsl:copy>
</xsl:template> 
```

如果传入的参数是带有 XML 标记的字符串，那么您需要

```
<xsl:template match="input">
  <xsl:copy>
    <xsl:copy-of select="@*, node()"/>
    <xsl:value-of select="$outParam" disable-output-escaping="yes"/>
  </xsl:copy>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:11:37.450

如果 EXSLT 是一个选项，添加`xmlns:exsl="http://exslt.org/common"`并尝试

```
 <xsl:template match="input">
        <input>
            <xsl:copy-of copy-namespaces="no" select="./@*" />
            <xsl:copy-of copy-namespaces="no" select="node() | @*" />
            <xsl:copy-of select="exsl:node-set($outParam)/*" />
        </input>
    </xsl:template> 
```

# sql - 使用 oracle 检查是否存在 xml 标签

> ID：13863828
> 
> 赞同：0
> 
> 时间：2012-12-13T16:09:03.937
> 
> 标签：sql, xml, oracle, oracle-sqldeveloper, clob

```
 <wbi:appData>
     <wbi:content wbi:name="1st_status">
         <wbi:value xsi:type="xsd:string">Success</wbi:value>
     </wbi:content>
</wbi:appData> 
```

此 xml 位于一个表中，该表具有 CLOB 类型的列。

我想找出这个 xml 中是否存在“wbi:value”标签？

我尝试使用existnode，但在sql developer中声明existnode时出错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:30:51.790

是的，使用存在节点：

```
SQL> with yourdata as (select to_clob('<wbi:event xmlns:wbi="http://foo" xmlns:xsi="http://x" xmlns:xsd="http://d">
  2  <wbi:appData>
  3      <wbi:content wbi:name="1st_status">
  4          <wbi:value xsi:type="xsd:string">Success</wbi:value>
  5          </wbi:content>
  6      <wbi:content wbi:name="2nd_status">
  7          <wbi:value xsi:type="xsd:string">Failure</wbi:value>
  8          </wbi:content>
  9      </wbi:appData>
 10  </wbi:event>') c from dual)
 11  select existsnode(xmltype(c), '/wbi:event/wbi:appData/wbi:content','xmlns:wbi="http://foo"')  is_exist
 12    from yourdata t
 13  /

  IS_EXIST
----------
         1 
```

IE

```
existsnode(xmltype(c), '/wbi:event/wbi:appData/wbi:content','xmlns:wbi="http://foo"') 
```

1 = 存在 0 = 不存在。

请注意，在我的示例中，我有两个匹配的节点（因为我没有过滤 wbi:name）。你当然可以过滤xpath。例如：

```
/wbi:event/wbi:appData/wbi:content[@wbi:name="1st_status"] 
```

将匹配限制为“1st_status”之一

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:14:58.557

```
select count(*) 
 from clobtab
where existsNode(xmltype.createxml(clobcol),'/wbi:appData/wbi:content/wbi:value') = 1; 
```

如果它的重复次数超过 0，则它存在，否则不存在。

所以你的触发器是-

```
CREATE TRIGGER Tab_a 
BEFORE INSERT 
FOR EACH ROW 
declare 
   xml_a xmltype; 
begin 
   xml_a:=xmltype(:new.value); 
   if existsNode(xml_a,'/wbi:appData/wbi:content/wbi:value','xmlns:wbi="http://pat.namespace.com"') = 1
   then 
     ----insert .... 
   end if;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:39:15.450

实际上你可以使用 oracle 的 instr 函数，它很快。

喜欢：

```
where instr(field, 'wbi:value') > 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T12:19:40.413

您可以使用[XMLEXISTS](http://docs.oracle.com/cd/B28359_01/server.111/b28286/functions231.htm#SQLRF20013)：

```
SELECT DESCRIPTOR_XML FROM TABLE_WITH_AN_XMLTYPE_COLUMN
WHERE
  XMLEXISTS('//functions[function/arg[@name="class.name" and not(starts-with(., "com.example.apps.YouShantSeeMeClass"))]]'
  PASSING BY VALUE DESCRIPTOR_XML); 
```

# c++ - 派生类的部分特化（加上奇怪的循环模式）

> ID：13863832
> 
> 赞同：1
> 
> 时间：2012-12-13T16:09:25.067
> 
> 标签：c++, templates

我想使用奇怪的循环模式从模板基类派生：

```
template<typename A, typename B>
struct base
{
    typedef A type;
};

template<typename B>
struct derived : public base<derived, B>
{
   // Own attributes.
}; 
```

但是编译器（g++ 4.7.2）告诉我参数（派生/A）不匹配。

我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T16:15:04.623

您收到错误是因为 d `derived`is a *class template*，并且您遗漏了它的模板参数。您需要指定模板参数`derived`：

```
template<typename B>
struct derived : public base<derived<B>, B>
{
   // Own attributes.
}; 
```

# javascript - 无法访问 Javascript 文件

> ID：13863834
> 
> 赞同：2
> 
> 时间：2012-12-13T16:09:29.920
> 
> 标签：javascript, asp.net, webforms

我正在使用 webform asp.net 和 C#。我将母版页与这样的 javascript 文件链接

```
 <script type="text/javascript" src="javascript/main.js"></script> 
```

但是当我要进入文件夹内的内页时..我无法访问 JavaScript 文件..（404 错误）。我尝试使用 ResolveClientUrl 解决问题，但它不起作用！有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:11:12.197

> 但是当我要进入文件夹内的内页时..我无法访问 JavaScript 文件

由于您正在访问的页面与母版页处于不同级别，因此您希望使脚本路径相对于应用程序的根目录

```
<script type="text/javascript" src="/javascript/main.js"></script> 
```

* * *

**编辑**如果这不起作用，那么我会保留上面的脚本标记，在 Chrome 中运行它并打开开发人员工具/网络选项卡，然后查看显示失败请求的确切地址。然后仔细查看您的应用程序，看看有什么不同/错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:24:32.987

你可以做：

```
<script type="text/javascript" src="<%=Page.ResolveClientUrl("~/javascript/main.js") %>" /> 
```

允许您使用 ASP.NET `~`。如果这不起作用，则该文件不存在于该目录中。

# android - 如何解决将库添加到另一个项目以制作我的 Android 应用程序的 Lite 版本时出现的 Dalvik 错误？

> ID：13863836
> 
> 赞同：0
> 
> 时间：2012-12-13T16:09:30.220
> 
> 标签：android, shared-libraries

在我的应用程序中，我必须有两个版本：完整版和精简版。

我正在关注这些教程：

*   [http://bitowl.wordpress.com/2011/07/06/tutorial-how-to-make-full-and-lite-versions/](http://bitowl.wordpress.com/2011/07/06/tutorial-how-to-make-full-and-lite-versions/)

*   [http://blog.donnfelker.com/2010/08/05/howto-android-full-and-lite-versions/](http://blog.donnfelker.com/2010/08/05/howto-android-full-and-lite-versions/)

所以，我构建了我的完整版本，并把它变成了一个库。这个完整版使用了某些组件所需的其他一些库。

然后，我创建了一个新项目并添加了创建的库。问题是当我尝试运行我的 lite 版本时，eclipse 给出了这个错误：

```
[2012-12-13 13:58:13 - <app> Lite] Dx 
UNEXPECTED TOP-LEVEL EXCEPTION:
java.lang.IllegalArgumentException: already added: Lnet/simonvt/timepicker/R$attr;

Conversion to Dalvik format failed with error 1 
```

simonvt/timepicker 是我在完整版中使用的库之一。

我怎样才能解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:55:13.647

请执行下列操作：

1.  右键单击您的项目并选择 Build Path -> Configure Build Path，

2.  然后去订购和出口部分

3.  如果 simonvt/timepicker 有一个复选标记，则取消选择它。

我认为问题在于库项目已经添加，您可能正在尝试再次添加它。

# c# - 当字符串正常出现时从 DataTable DataRow 获取一个 int

> ID：13863840
> 
> 赞同：1
> 
> 时间：2012-12-13T16:09:41.680
> 
> 标签：c#, excel, oledb

我在这里和其他地方广泛寻找答案，但收效甚微。

我正在使用 OLEDB 连接到电子表格并提取数据以移植到数据库，除了一个小细节之外，一切都进行得相当顺利。

有一个名为 Skills 的列，我收到的条目通常是一个字符串，但是该值有时可以是一个像 334423 这样的 int，当我尝试将此值添加到新数据库时，该条目只是空白。

常用的提取方法：

```
 foreach(DataRow dr in dt.Rows)
    {
      /* dealing with other columns */

      sTemp.skill = dr[3].ToString();

      /* more stuff */

    } 
```

但是当这一行中的列是一个int，只是一个空白字符串时，我绝对没有得到任何响应。它甚至不会抛出任何异常，这至少会给我一些方向。

我还尝试将其转换为 int：

```
sTemp.skill = (int)dr[3].ToString(); 
```

（没用）

仅供参考：“sTemp”是一个带有与之关联的字符串的对象，技能是一个字符串。这个问题神秘的安静本质也让我很难知道我应该问什么。那里有任何OLEDB大师，请帮忙！谢谢

**编辑：**经过更多调查，问题似乎不在于将字符串转换/强制转换为整数，而是首先获取数据。

在具有数字的字段的实例中，它将完全忽略它（出于我想不出的原因），因此没有什么可解析的。确实是神秘的行为。

除非有人知道使用 OleDbDataAdapter 从 excel 获取整数的已知问题，否则请随时回答...抱歉浪费了您的时间，多么尴尬。

**编辑#2：**这是一个更新的代码视图：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Data.OleDb;

namespace SQEPSkillsImporter
{
    public partial class MainWindow : Form
    {
        string skillsFileName = "";
        List<SkillTemplate> TemplateList = new List<SkillTemplate>();
        public MainWindow()
        {
            InitializeComponent();
        }

        private void skillsFilePathBtn_Click(object sender, EventArgs e)
        {
            this.skillsFileDialog.Filter = "Excel Worksheets|*.xls;*xlsx";
            DialogResult result = skillsFileDialog.ShowDialog();
            if (result == DialogResult.OK)
            {
                this.skillsFileName = skillsFileDialog.FileName;
                skillsFilePathTxBx.Text = skillsFileName;
            }
        }

        private void readSkillsBtn_Click(object sender, EventArgs e)
        {
            DataTable skillsTable = new DataTable("SkillsResults");

            string connectionString = "Provider=Microsoft.Jet.OleDb.4.0;" +
                " Data Source=" + this.skillsFileName +
                ";Extended Properties=Excel 8.0;";

            using(OleDbConnection Connection = new OleDbConnection(connectionString))
            {
                Connection.Open();

                using(OleDbCommand Command = new OleDbCommand())
                {
                    Command.Connection = Connection;
                    /* The columns I want are in A through D */
                    Command.CommandText = "SELECT * FROM [Skills$A:D]";

                    using (OleDbDataAdapter Adapter = new OleDbDataAdapter())
                    {
                        Adapter.SelectCommand = Command;
                        Adapter.Fill(skillsTable);
                    }
                }
                Connection.Close();
                Connection.Dispose();
            }
            SkillTemplate sTemp = new SkillTemplate();
            foreach (DataRow dr in skillsTable.Rows)
            {
                /* most sGroup, group and heading columns are blank, so remain the same unless changed, meaning the name wont be null */
                if(dr[0].ToString() != "")
                    sTemp.SuperGroup = dr[0].ToString();
                if (dr[1].ToString() != "")
                    sTemp.Group = dr[1].ToString();
                if (dr[2].ToString() != "")
                    sTemp.Heading = dr[2].ToString();
                if (dr[3].ToString() != "")
                    sTemp.Skill = dr[3].ToString();

                /* VERY rough test textbox to verify that my output is correct before sending to DB */
                this.skillsDumpTxBx.Text += sTemp.SuperGroup + " /// " + sTemp.Group + " /// " + sTemp.Heading + " /// " + sTemp.Skill + System.Environment.NewLine;
            }
        }
    }

    public class SkillTemplate
    {
        public string SuperGroup { get; set; }
        public string Group { get; set; }
        public string Heading { get; set; }
        public string Skill { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:12:34.503

```
sTemp.skill = Convert.ToInt32(dr[3].ToString()); 
```

或使用此方法转换为任何类型：

```
/// <summary>
/// Safe converting to any type
/// </summary>
/// <typeparam name="T"></typeparam>
/// <param name="value">Value to convert</param>
/// <param name="defaultValue">Default value, sets type of return value</param>
/// <returns>Converted value or defaul when error</returns>
public static T safeConvert<T>(object value, T defaultValue)
{
    try
    {
        return value == null ? default(T) : 
            (T)Convert.ChangeType( value, Nullable.GetUnderlyingType(typeof(T)) ?? typeof(T) );
    }
    catch
    {
        return defaultValue;
    }
} 
```

用法：

```
sTemp.skill = safeConvert(dr[3],0);
// or
String s = safeConvert(obj, string.Empty); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:27:16.000

如果 dr[3].ToString() 返回空白，那么它可能包含 DBNull 或空白字符串。您是否检查了查询以确保您的第 4 列（基于零的索引 3）返回有效值

# delphi - 如何调整表单的大小超出/超出其父级范围？

> ID：13863842
> 
> 赞同：1
> 
> 时间：2012-12-13T16:09:50.470
> 
> 标签：delphi, delphi-xe

**这个问题适用于两种情况。**

**(1)**

第一个是有一个 MDI 窗体和 MDI 子窗体，在运行时，如果我尝试水平或垂直调整窗体的大小，我无法越过主 MDI 窗体的边缘，某处必须有一个 SetBounds 或类似的东西来防止这种类型的行为，因为鼠标刚刚捕捉到边缘。

我想要的是能够调整 MDI 表单边界 rect 的过去/之外的大小 - 然后会在主 MDI 表单上显示滚动条（就像您移动子表单时一样）。

**(2)**

第二个是我发现 MDI 布局应用程序中的滚动有点烦人，而且使用起来不太舒服，所以我认为我可以通过在 TScrollBox 中设置一个表单来模拟它，而不是使用 MDI，这样做我希望能提供更好的流畅性滚动。但与第一个场景一样，将表单放置在 ScrollBox 内仍然不允许在客户端外部调整大小 - 并且当您在 ScrollBox 周围移动表单时，执行此方法甚至不会显示滚动条。

* * *

您可以通过创建一个新的 MDI 应用程序来快速尝试此操作。尝试使用右下角调整大小并尽可能向右侧/底部拖动，鼠标停在主 MDI 客户端上，防止外部调整大小。

那么，如何在运行时允许在父边界之外调整窗体的大小，无论它是 MDI 子窗体还是 TScrollBox 的父窗体？

我是否需要设置一个我可能忽略的简单属性，或者是否需要做更多工作，例如覆盖表单的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:34:33.693

MDI 子级不受其父级大小的限制，但它们在其父级边界之外不可见，因此无法在这些边界之外调整大小。

但是，您可以将它们移到边界之外，因此如果您将子表单移到左侧，只留下表单的一部分可见，您可以将该可见部分的大小调整到父表单的边界。所以实际上并没有大小限制，但这只是一个功能限制，当它的大小句柄/边框将被隐藏时，您无法进一步调整表单的大小。

我认为，与其将 MDI 子项放在滚动框上或调整 MDI 子项的大小，不如将子项的*内容*放在滚动框上，并让子窗体本身保持原样。

或者，当然，您可以修改设计，使您根本不需要滚动，但在不了解您的表单的情况下不可能给出适当的建议。

# jsf - JSF 2 - 必需复选框

> ID：13863848
> 
> 赞同：1
> 
> 时间：2012-12-13T16:10:08.567
> 
> 标签：jsf, jsf-2

我正在尝试为用户必须接受的条款和条件编写一个必需的复选框。我实际上不需要任何支持 bean，我只需要确保用户选中该框。

我尝试了以下方法，但似乎不起作用：

JSF：

```
<p:selectBooleanCheckbox required="true"> <f:validator validatorId="RequiredCheckboxValidator" /></p:selectBooleanCheckbox> 
```

Java代码：

```
@FacesValidator("RequiredCheckboxValidator")
public class RequiredCheckboxValidator implements Validator {

    public void validate(FacesContext context, UIComponent component, Object value)
        throws ValidatorException
    {
        if (value.equals(Boolean.FALSE)) {
            String requiredMessage = ((UIInput) component).getRequiredMessage();

            if (requiredMessage == null) {
                Object label = component.getAttributes().get("label");
                if (label == null || (label instanceof String && ((String) label).length() == 0)) {
                    label = component.getValueExpression("label");
                }
                if (label == null) {
                    label = component.getClientId(context);
                }
                requiredMessage = MessageFormat.format(UIInput.REQUIRED_MESSAGE_ID, label);
            }

            throw new ValidatorException(
                new FacesMessage(FacesMessage.SEVERITY_ERROR, requiredMessage, requiredMessage));
        }
    }

} 
```

# objective-c - 选择器没有已知的类方法

> ID：13863849
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:10:09.550
> 
> 标签：objective-c, ios, xcode, delegates, method-call

.h 文件：

```
@interface WibraryViewController : UIViewController <UIAlertViewDelegate> {    
    IBOutlet UIActivityIndicatorView *activityIndicatorView;
}
+ (void) notifyServerOfFileOpening:(NSString *) docName; 
```

.m 方法：

```
+ (void) notifyServerOfFileOpening:(NSString *) docName
{
    NSLog(@"doc opened name = %@", docName);
} 
```

另一个类中生成“选择器的无已知类方法”错误的行：

```
[WibraryViewController notifyServerOfFileOpening]; 
```

我猜这可能与正在使用 UIAlertViewDelegate 委托的事实有关，但我还没有真正掌握委托的工作方式。当然，它也可能是完全不同的东西。

我希望有人能指出问题吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:13:27.660

您忘记传递“docName”参数。你在打电话

```
[WibraryViewController notifyServerOfFileOpening]; 
```

代替

```
[WibraryViewController notifyServerOfFileOpening:@"YourDocName"]; 
```

希望有帮助；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:13:42.687

你应该添加一个参数 docName：

```
[WibraryViewController notifyServerOfFileOpening:yourDocName]; 
```

您当前使用的选择器是`notifyServerOfFileOpening`，但您必须使用的选择器是`notifyServerOfFileOpening:`。

# jquery - Accordion 不能在 IE9 的选项卡中工作（在其他任何地方都可以正常工作）

> ID：13863856
> 
> 赞同：1
> 
> 时间：2012-12-13T16:10:39.320
> 
> 标签：jquery, internet-explorer-8, tabs, accordion

我在第二个选项卡中使用 jquery 垂直选项卡和 jquery 手风琴。它在 Firefox 17.0.1、Chrome 23.0.1271.95、Safari 5.1.7、SeaMonkey 2.0.11、我的 iPhone4、我妻子的 Android 中运行良好（Mac）——但手风琴在 IE 9 中不起作用。（没有尝试过任何其他版本的 IE)

有人可以帮我找出问题所在吗？

[http://www.geneseo.com/yes](http://www.geneseo.com/yes)

选项卡应默认为包含手风琴的第二个选项卡。

我很感激这方面的任何帮助。

谢谢 - 罗恩

更新：此外，在 IE9 中，最后一个选项卡 (ColoHub) 上的链接不起作用，但它们在其他浏览器中是否有效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:50:32.940

`console.log`我相信您的应用程序中一定有一个流浪者。与优秀的浏览器不同，IE 仅在开发人员工具打开时才提供控制台对象。因此`console.log`，在打开开发人员工具的情况下使用可能会导致您的 javascript 崩溃和烧毁。这是一个方便的片段，可以阻止 IE 在控制台的处理上成为一个混蛋。

```
 if(!window.console){
     window.console = { log : $.noop }
 } 
```

这样，如果找不到控制台对象，则`console.log`变为 noop 而不是 null 并且不会使 IE 崩溃。

# jquery-plugins - 从数据库创建事件ID？

> ID：13863858
> 
> 赞同：2
> 
> 时间：2012-12-13T16:10:45.067
> 
> 标签：jquery-plugins, fullcalendar

我正在使用 json 提要填充日历。

```
$return_arr = array();
$fetch = mysql_query("SELECT * FROM events"); 

while ($row = mysql_fetch_array($fetch, MYSQL_ASSOC)) {
 $row_array['rowid'] = $row['id'];
     $row_array['title'] = $row['title'];
     $row_array['start'] = $row['start'];
     $row_array['end'] = $row['end'];

array_push($return_arr,$row_array);
      }

echo json_encode($return_arr); 
```

并渲染事件：

```
calendar.fullCalendar('renderEvent',{
title: 'title',
start: start,
end: end,
allDay: allDay,
id: rowid
},
true // make the event "stick"          
); 
```

当我使用 eventClick 获取 id 时，我得到 _fc1、_fc2 等。无论如何我可以获取我的数据库生成的 id 吗？所以我可以参考每个单独的事件进行更新？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T16:30:49.963

您可以简单地向您的*事件*添加一个自定义字段，然后在您的点击事件中引用它。

从[文档](http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)

> 非标准字段
> 
> 除了上述字段之外，您还可以在每个事件对象中包含您自己的非标准字段。FullCalendar 不会修改或删除这些字段。例如，开发人员通常包含一个描述字段，用于在 eventRender 等回调中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T19:51:32.690

[您可以使用与事件](http://arshaw.com/fullcalendar/docs/event_data/Event_Object/)id相同的 DBid `$row_array['id'] = $row['id'];`：。

在`eventClick(event,...)`你会得到它`event.id`。

# c++ - (Intel core i5-760) MOVQ QWORD PTR DS:[地址],XMM0

> ID：13863861
> 
> 赞同：2
> 
> 时间：2012-12-13T16:10:57.953
> 
> 标签：c++, assembly

最近我的程序（在另一台计算机上）出现问题，它在启动时崩溃，所以我设法在远程计算机和我的计算机上调试它。我发现了一件有趣的事情，在我的计算机上执行以下代码：

```
010F131D    660FD605 681110 MOVQ QWORD PTR DS:[1101168],XMM0
010F1325    660FD605 701110 MOVQ QWORD PTR DS:[1101170],XMM0 
```

不在远程计算机上表示：

```
0012131C     50             PUSH EAX
0012131D     66             DB 66
0012131E     0F             DB 0F
0012131F     D6             DB D6
00121320     05             DB 05
00121321     68111300       DD 1101168
00121325     66             DB 66
00121326     0F             DB 0F
00121327     D6             SALC
00121328     05 70111300    ADD EAX,1101170
010F131C     50             PUSH EAX 
```

步入“DB 66”程序崩溃..

两台计算机都有 64x 版本的 windows（我的：win8_64x；远程：win7_64x） 处理器：（我的：intel core i7-2600；远程：intel core i5-760） C++ 程序在我的计算机上编译（而我有 win7_64x） VC++2012 使用工具包 v110_xp 和 /O2 /Ot 标志..

我的问题是：问题的根源是什么，如何解决？（我应该发布更多信息吗？）

# actionscript-3 - 一个人应该通过事件传递多少信息？

> ID：13863863
> 
> 赞同：1
> 
> 时间：2012-12-13T16:11:02.783
> 
> 标签：actionscript-3, events

说，我有一个带有复选框的数据网格，每次标记复选框时，我都会将对象存储在 flex ResultEvent 的 data 属性中

```
public class MyItemRenderer extends ItemRenderer{

   public static var CLICK:String = "CheckBoxClick";      

   protected function itemRendererClickListener(data:Object):void{

    dispatchEvent(new ResultEvent(MyItemRenderer.CLICK, data))
    }

} 
```

我在这里处理结果。

```
protected function checkbox_clicked(event:ResultEvent):void{
    //Here I do everything I want with the data.
    Alert.show(event.result.toString());
} 
```

这是我几个月来一直在使用的方法，但我从不怀疑这是否是一种不好的做法。

或者更不用说糟糕的做法了，这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:51:53.470

这并不是真的“坏”。但它确实会创建一个对对象的附加引用，这可能会使该对象在内存中保留更长时间（如果管理不善，则可能会无限期地保留）。

一般来说，您应该只在事件实例中存储与事件本身相关的数据。您可以使用`event.target`和`event.currentTarget`属性来引用回调度事件的对象并以这种方式获取数据。

在您的情况下，您的事件是复选框状态更改。除了正在检查的项目（您可以使用“目标”或“当前目标”获得）之外，事件本身（被检查）不需要任何与之关联的数据。因此，我认为执行以下操作会更合适：

```
Alert.show(MyItemRenderer(event.currentTarget).data.toString()); 
```

这使您的事件更具可重用性

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T22:03:15.513

带有数据的事件的最佳实践是使用自定义事件（请参阅[http://cookbooks.adobe.com/post_AS3__Creating_and_dispatching_Custom_Events-17609.html](http://cookbooks.adobe.com/post_AS3__Creating_and_dispatching_Custom_Events-17609.html)）进行解释

顺便说一句，另一个“最佳实践”是避免在代码中使用通用 Object 类 - 相反，创建一个值对象类

# windows - 为什么交互式服务可以创建比非交互式服务更多的窗口句柄？

> ID：13863869
> 
> 赞同：0
> 
> 时间：2012-12-13T16:11:16.640
> 
> 标签：windows, delphi

我正在对应用程序可以使用的窗口句柄数量进行一些研究。我正在使用 Delphi XE2 并使用 AllocateHWnd 例程，该例程通过使用 CreateWindowsEx 创建一个不可见的窗口句柄来接收和处理 Windows 消息。

我发现了一些有趣的东西，我想从专家那里知道为什么会有这种行为。

在创建服务应用程序时，我在 Windows 7 机器上最多可以达到 2220 个句柄，如果我在服务配置中激活“允许服务与桌面交互”选项，我可以达到大约 9823 个句柄！

Windows 2008 运行方式相同，我可以在非交互式服务上创建 ~2220 个句柄，在交互式服务上创建超过 9000 个

我已经在 Windows 2012 服务器上进行了测试，即使打开了交互式服务标志，我也无法创建超过 2050 个句柄......为什么会有这样的限制以及如何增加它？

我知道使用这么多句柄的软件设计得很糟糕，但我们正在测试一个具有密集 TCP/IP 连接处理的软件，它需要许多句柄来处理入站和输出 TCP/IP 连接

如果我的应用程序是常规桌面应用程序，那么即使在 Windows 2012 上我也可以创建超过 9000 个句柄，那么，为什么对服务应用程序有这种限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T17:45:46.020

听起来您面临“桌面堆耗尽”综合症。可以在 Ntdebugging 的博客上找到一个很好的解释：

*   [桌面堆概述](http://blogs.msdn.com/b/ntdebugging/archive/2007/01/04/desktop-heap-overview.aspx)
*   [桌面堆，第 2 部分](http://blogs.msdn.com/b/ntdebugging/archive/2007/07/05/desktop-heap-part-2.aspx)
*   [对讲视频：桌面堆](http://blogs.msdn.com/b/ntdebugging/archive/2007/09/13/talkback-video-desktop-heap.aspx)
*   [在 32 位 Vista SP1 上增加了默认的交互式桌面堆大小](http://blogs.msdn.com/b/ntdebugging/archive/2008/03/20/the-default-interactive-desktop-heap-size-has-been-increased-on-32-bit-vista-sp1.aspx)

无论如何，正如@DavidHeffernan 所说，最好重新设计您的应用程序:)

# c# - 如何在 EntityFramework 5 中使用事务？

> ID：13863871
> 
> 赞同：10
> 
> 时间：2012-12-13T16:11:20.820
> 
> 标签：c#, mysql, entity-framework, visual-studio-2012, entity-framework-5

我想同时转写一些表。如果一个不成功，必须全部回滚。

像这样的东西：

```
ctx.Database.ExecuteSqlCommand("truncate table tb_expensesall");
ctx.Database.ExecuteSqlCommand("truncate table tb_wholesale");
ctx.Database.ExecuteSqlCommand("truncate table tb_singlesale");
ctx.Database.ExecuteSqlCommand("truncate table tb_purchase"); 
```

但问题是，我不知道如何使用事务。

我尝试这个：

```
using (gasstationEntities ctx = new gasstationEntities(Resources.CONS))
{
    ctx.Database.Connection.Open();
    DbTransaction tr = ctx.Database.Connection.BeginTransaction();

    try
    {
        ctx.Database.ExecuteSqlCommand("truncate table tb_expensesall");
        ctx.Database.ExecuteSqlCommand("truncate table tb_wholesale");
        ctx.Database.ExecuteSqlCommand("truncate table tb_singlesale");
        ctx.Database.ExecuteSqlCommand("truncate table tb_purchase");
        //commit the transaction
        tr.Commit();
        new MessageWindow(this, Resources.GetString("Warn"), Resources.GetString("DeleteSuccess"));
    }
    catch (Exception ex)
    {
        //return
        tr.Rollback();
    }
    //close
    ctx.Database.Connection.Close();
} 
```

这里的问题： `tr.Commit();` 异常告诉我：

```
{System.InvalidOperationException: Connection must be valid and open to rollback transaction 
```

并`tr.Rollback();`抛出异常。例外是：

```
{System.InvalidOperationException: Connection must be valid and open to rollback transaction 
```

真正有趣的是，表格截断是成功的。什么？提交是抛出异常。它可以成功吗？我无法理解。

请告诉我发生了什么事。如果你给我一个解决方案，那就更好了。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-13T16:16:29.860

添加引用`System.Transactions`，导入`using System.Transactions;`，然后尝试封装您的代码

```
using (gasstationEntities ctx = new gasstationEntities(Resources.CONS))
{
   using (var scope = new TransactionScope())
   {
      [... your code...]

      scope.Complete();
   }
} 
```

如果发生异常，则不会调用 scope.Complete() 并且回滚是自动的。

**编辑：**我刚刚看到你的 MySql 标签。如果这不起作用，请看[这里](http://forums.asp.net/t/1239791.aspx/1)！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:17:05.573

试试这个，从技术上讲，使用应该在没有异常的情况下提交事务，但如果出现异常，使用会自动回滚它。

```
using (var txn = new TransactionScope())
{
    ctx.Database.ExecuteSqlCommand("truncate table tb_expensesall");
    ctx.Database.ExecuteSqlCommand("truncate table tb_wholesale");
    ctx.Database.ExecuteSqlCommand("truncate table tb_singlesale");
    ctx.Database.ExecuteSqlCommand("truncate table tb_purchase");
    txn.Complete();
}
new MessageWindow(this, Resources.GetString("Warn"), Resources.GetString("DeleteSuccess")); 
```

# vb.net - 在 vb.net 中比较时间

> ID：13863873
> 
> 赞同：1
> 
> 时间：2012-12-13T16:11:28.727
> 
> 标签：vb.net, time

我有四个不同的 DateTime 框。两个框只显示日期，另外两个只显示时间

如果当前时间在午夜和早上六点之间，我希望日期框中的日期是前一天。

我拥有一切，我只是错过了比较两者的部分。

```
Dim currentTime As DateTime = Now
        'default date
        If deMaxDate.Value = Nothing Then
            deMaxDate.Value = Now
        End If
        If deMinDate.Value = Nothing Then
            If currentTime.Hour < TimeOfDay.Hour Then
            'THIS IF STATMENT IS WRONG - HOW CAN I CHECK IF ITS BETWEEN 12AM AND 6 HERE
                deMinDate.Value = (Now - TimeSpan.FromDays(1))
            Else
                deMinDate.Value = Now
            End If
        End If
            'default time
            If teMaxTime.Value = Nothing Then
                teMaxTime.Value = Now
            End If
            If teMinTime.Value = Nothing Then
                teMinTime.Value = (Now - TimeSpan.FromHours(6))
            End If 
```

如果陈述是我坚持的地方，我对第三个的评论。DateTime 是双数据类型吗？类似 if currentTime.Hour < TimeOfDay.Hour.Equals(6) ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:19:31.323

只需使用

```
If currentTime.Hour <= 6 Then
     deMinDate.Value = Now.AddDays(-1)
Else
     deMinDate.Value = Now
End If 
```

或者确实……

```
If currentTime.Hour <= 6 Then
     deMinDate.Value = Now.Date.AddDays(-1)
Else
     deMinDate.Value = Now.Date
End If 
```

如果您不想要时间位，因为`.Now`包含时间元素和日期元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:21:55.370

如果我理解这一点，您的规则是您要查看当前时间。如果当前时间在 12AM(0000) 和 6AM(0600) 之间，那么您想使用昨天作为活动日期。

```
Dim current as DateTime = now()
Dim activeDate as DateTime = current
if current.Hour < 6 then
    activeDate = current.AddDays(-1)
end if 
```

虽然，如果您对日期的小时数部分（除了此业务规则）并不真正感兴趣，您总是可以只做`date.AddHours(-6)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:22:34.983

我在类似的情况下执行此操作，我想检查当前时间是否在凌晨 4 点之前。

```
If (DateTime.Now.Hour < 4) Then
   'do something
End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:15:58.737

看看[http://msdn.microsoft.com/en-us/library/5ata5aya.aspx](http://msdn.microsoft.com/en-us/library/5ata5aya.aspx)。它可能适用于您的情况

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-13T16:20:10.173

currentTime.Hour < TimeOfDay.Hour.Equals(6)

最终成为答案

# php - php 和 mysql，代码没有插入到我的表中

> ID：13863874
> 
> 赞同：1
> 
> 时间：2012-12-13T16:11:30.460
> 
> 标签：php, mysql, sql, syntax, procedure

大编辑：

新脚本：

```
<?php
error_reporting(E_ALL|E_NOTICE);
$nazwabazydanych = "projekt";

$pesel = mysql_real_escape_string($_POST['pesel']);
$imie = mysql_real_escape_string($_POST['imie']);  
$nazwisko = mysql_real_escape_string($_POST['nazwisko']);
$telefon = mysql_real_escape_string($_POST['telefon']);
$adres = mysql_real_escape_string($_POST['adres']);
$nr_konta = mysql_real_escape_string($_POST['nr_konta']);
$zarobek = mysql_real_escape_string($_POST['zarobek']);

if (!$pesel || !$imie || !$nazwisko || !$telefon || !$adres || !$nr_konta || !$zarobek)

 {
        print "Nie zostały wypełnione wszystkie pola";
        exit;
 }

$db = mysql_pconnect("localhost", "root", "");
if (!$db)  
        {  
        print "Nie można nawiązać połączenia z bazą danych";
        exit;
        }

mysql_select_db("$nazwabazydanych");

$query = mysql_query("CALL dodaj_osobe ('$pesel','$imie','$nazwisko','$telefon','$adres','$nr_konta','$zarobek')"); 

?> 
```

行动：

```
<form action="lool.php" method="post">

PESEL: <input type="text" name="pesel" maxlength=11 size=12><br><br> 
Imię: <input type="text" name="imie" maxlength=45 size=46><br><br>
Nazwisko: <input type="text" name="nazwisko" maxlength=45 size=46><br><br>
Telefon: <input type="text" name="telefon" maxlength=9 size=10><br><br>
Adres: <input type="text" name="adres" maxlength=45 size=46><br><br>
Numer konta: <input type="text" name="nr_konta" maxlength=20 size=21><br><br>
Zarobek: <input type="text" name="zarobek" maxlength=8 size=9><br><br>
<input type="submit" value="Dodaj klienta">
</form> 
```

和更新的错误：

没有任何！

谢谢大家，但我有一个问题：如果例如“nr_konta”或“pesel”或“telefon”的数字太低，我该如何发送错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:13:51.137

你需要使用 $_POST 数组来获取 POST 变量，除非你有`register_globals`。

```
$pesel = mysql_real_escape_string($_POST['pesel']);
$imie = mysql_real_escape_string($_POST['imie']);  
$nazwisko = mysql_real_escape_string($_POST['nazwisko']);
$telefon = mysql_real_escape_string($_POST['telefon']);
$adres = mysql_real_escape_string($_POST['adres']);
$nr_konta = mysql_real_escape_string($_POST['nr_konta']);
$zarobek = mysql_real_escape_string($_POST['zarobek']);

// Put this after so you don't have to restate the $_POST vars
if (!$pesel || !$imie || !$nazwisko || !$telefon || !$adres || !$nr_konta || !$zarobek)

 {
        print "Nie zostały wypełnione wszystkie pola";
        exit;
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-13T16:31:41.277

使用 `print_r($_POST)`你应该看看你是否得到了价值。在您的代码中，问题似乎是您没有使用正确的索引。注意 Pesel 没有通知，但 imie 有。

您的两者的代码：

```
$pesel = mysql_real_escape_string($_POST['pesel']);
$imie = mysql_real_escape_string($_POST['$imie']); 
```

注意你有`'$imie'`作为索引。我在这里猜测复制和粘贴错误。从 html 看来，该元素被命名为 imie。试试这个：

```
$imie = mysql_real_escape_string($_POST['imie']); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T16:15:58.497

您实际上并没有获得 $_POST 值。

应该

```
$pesel = mysql_real_escape_string($_POST['pesel']);
$imie = mysql_real_escape_string($_POST['imie']);  
$nazwisko = mysql_real_escape_string($_POST['nazwisko']);
$telefon = mysql_real_escape_string($_POST['telefon']);
$adres = mysql_real_escape_string($_POST['adres']);
$nr_konta = mysql_real_escape_string($_POST['nr_konta']);
$zarobek = mysql_real_escape_string($_POST['zarobek']); 
```

那些应该在你之前

`if (!$pesel || !$imie || !$nazwisko || !$telefon || !$adres || !$nr_konta || !$zarobek)`

此外，您需要`$`从`$_POST`值中删除 。

`$_POST['$imie']`

应该：

`$_POST['imie']`

# android - 将联系人图像加载到位图中

> ID：13863879
> 
> 赞同：14
> 
> 时间：2012-12-13T16:11:44.273
> 
> 标签：android, image, bitmap, contact

我用来从电话号码中获取联系人图像缩略图的 Uri 的功能。：

```
public static Uri getPhotoURIFromAddress(Context activity, String address) {
    String contactId = getContactIdFromAddress(activity, address);

    ContentResolver contentResolver = activity.getContentResolver();
    try {
        Cursor cursor = contentResolver
                .query(ContactsContract.Data.CONTENT_URI,
                        null,
                        ContactsContract.Data.CONTACT_ID
                                + "="
                                + contactId
                                + " AND "

                                + ContactsContract.Data.MIMETYPE
                                + "='"
                                + ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE
                                + "'", null, null);

        if (cursor != null) {
            if (!cursor.moveToFirst()) {
                return null; // no photo
            }
        } else {
            return null; // error in cursor process
        }
        cursor.close();

    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }

    Uri person = ContentUris.withAppendedId(
            ContactsContract.Contacts.CONTENT_URI, Long.valueOf(contactId));
    return Uri.withAppendedPath(person,
            ContactsContract.Contacts.Photo.CONTENT_DIRECTORY);
} 
```

它将以以下形式返回 Uri：

```
content://com.android.contacts/contacts/799/photo 
```

现在，如果我在带有 setImageUri(Uri) 函数的 ImageView 中使用这个 Uri，它就可以工作。

但是加载位图是一个问题。我正在使用的功能是：

```
public static Bitmap getContactBitmapFromURI(Context context, Uri uri) {
        InputStream input = ContactsContract.Contacts
                .openContactPhotoInputStream(context.getContentResolver(), uri);
        if (input == null) {
            return null;
        }
        return BitmapFactory.decodeStream(input);
    } 
```

总是崩溃。LogCat 是：

```
12-13 21:40:26.016: E/AndroidRuntime(9076): FATAL EXCEPTION: main
12-13 21:40:26.016: E/AndroidRuntime(9076): java.lang.RuntimeException: Unable to start receiver com.daksh.fss.SMSReceiver: java.lang.IllegalArgumentException: URI: content://com.android.contacts/contacts/799/photo/photo, calling user: com.daksh.fss, calling package:com.daksh.fss
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.app.ActivityThread.handleReceiver(ActivityThread.java:2362)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.app.ActivityThread.access$1500(ActivityThread.java:142)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1284)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.os.Looper.loop(Looper.java:137)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.app.ActivityThread.main(ActivityThread.java:4931)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at java.lang.reflect.Method.invokeNative(Native Method)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at java.lang.reflect.Method.invoke(Method.java:511)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at dalvik.system.NativeStart.main(Native Method)
12-13 21:40:26.016: E/AndroidRuntime(9076): Caused by: java.lang.IllegalArgumentException: URI: content://com.android.contacts/contacts/799/photo/photo, calling user: com.daksh.fss, calling package:com.daksh.fss
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:170)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:140)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.content.ContentProviderProxy.query(ContentProviderNative.java:366)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.content.ContentResolver.query(ContentResolver.java:370)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.content.ContentResolver.query(ContentResolver.java:313)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.provider.ContactsContract$Contacts.openContactPhotoInputStream(ContactsContract.java:1973)
12-13 21:40:26.016: E/AndroidRuntime(9076):     at android.provider.ContactsContract$Contacts.openContactPhotoInputStream(ContactsContract.java:2004) 
```

请帮忙！

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-13T16:38:30.767

我认为您不应该将照片的 uri 传递给 openContactphotoinputstream。您只需要传递联系人本身的 uri 即可获取位图。

```
 Uri uri = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, id);
  InputStream stream = ContactsContract.Contacts.openContactPhotoInputStream(
            mContext.getContentResolver(), uri); 
```

或者，如果您要传递联系人照片 uri，那么您可以使用

```
public static Bitmap getContactBitmapFromURI(Context context, Uri uri) {
        InputStream input = context.getContentResolver().openInputStream(uri)
        if (input == null) {
            return null;
        }
        return BitmapFactory.decodeStream(input);
    } 
```

# c# - 在远程服务器上使用工作簿时出错

> ID：13863881
> 
> 赞同：0
> 
> 时间：2012-12-13T16:11:54.023
> 
> 标签：c#, excel

我正在使用 Koogra Excel BIFF/XLSX 阅读器库来操作一些 excel 信息。当我在本地运行它时一切正常，但是当我把它放在我的远程服务器上时，我得到了错误。

这是以下代码，在本地运行良好，但在服务器上中断。

```
if (month.ToString() == "1" ||
    month.ToString() == "2" ||
    month.ToString() == "3" ||
    month.ToString() == "4" ||
    month.ToString() == "5" ||
    month.ToString() == "6" ||
    month.ToString() == "7" ||
    month.ToString() == "8" ||
    month.ToString() == "9")
{
    string monthc = "0" + month;
    file = "\\\\atlanta2-0\\HOME\\Accounting\\FLOOD INVOICES\\" + 
        monthc.ToString() + year.ToString().Substring(2, 2) + ".xlsx";
}
else
{
    file = "\\\\atlanta2-0\\HOME\\Accounting\\FLOOD INVOICES\\" + 
        month.ToString() + year.ToString().Substring(2, 2) + ".xlsx";
}

try
{
    Workbook wb = new Workbook(file);
} 
```

最后一行给了我一个异常，指出文件不包含通常在文件不存在时发生的工作簿。但是，我可以验证该文件是否存在，并且在本地可以正常工作。有任何想法吗？好像不能访问文件？？？

我也试过做这样的事情

```
FileInfo fi = new FileInfo(file); 
```

当我`try`捕捉`fi.Fullname`到我的异常时，它给了我正确的完整路径。

# c# - WP7 联合供稿

> ID：13863885
> 
> 赞同：0
> 
> 时间：2012-12-13T16:12:19.873
> 
> 标签：c#, visual-studio-2010, windows-phone-7, expression-blend

我正在创建一个小型 RSS 阅读器应用程序。

我用来获取 xml 的代码如下：

```
 void PhonePage1_Loaded(object sender, RoutedEventArgs e)
    {
        WebClient wc = new WebClient();
        wc.OpenReadCompleted += new OpenReadCompletedEventHandler(wc_OpenReadCompleted);
        wc.OpenReadAsync(new Uri("http://www.benchmark.pl/rss/aktualnosci-pliki.xml"));
    }

    void wc_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
    {
        SyndicationFeed feed;
        using (XmlReader reader = XmlReader.Create(e.Result))
        {
            feed = SyndicationFeed.Load(reader);
            NewsFeed.ItemsSource = feed.Items;
        }
    } 
```

问题是 SyndicationFeed 项目模板不适合 xml 文件中的模板。我不知何故需要编辑模板，以便正确插入文本。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:47:54.737

通过使用，`SyndicationFeed`您将不得不使用它定义的对象。但是，很容易将其转换为更能反映您的 XML 的内容。

假设您有这样的课程：

```
class MyFeedItem
{
    public string Title { get; set; }
    public Uri Link { get; set; }
    public string Description { get; set; }
    public DateTimeOffset PubDate { get; set; }
} 
```

您可以将 SyndicationFeed 项目转换为它，例如：

```
private void wc_OpenReadCompleted(object sender, OpenReadCompletedEventArgs e)
{
    SyndicationFeed feed;
    using (XmlReader reader = XmlReader.Create(e.Result))
    {
        feed = SyndicationFeed.Load(reader);
        NewsFeed.ItemsSource = ParseFeed(feed);
    }
}

private static IEnumerable<MyFeedItem> ParseFeed(SyndicationFeed feed)
{
    return feed.Items.Select(item => new MyFeedItem
                                            {
                                                Title = item.Title.Text,
                                                Link = item.Links.First().Uri,
                                                Description = item.Summary.Text,
                                                PubDate = item.PublishDate
                                            });
} 
```

# javascript - 使 javascript 函数继承原型

> ID：13863891
> 
> 赞同：1
> 
> 时间：2012-12-13T16:12:36.237
> 
> 标签：javascript, inheritance, prototype

> **可能重复：**
> [如何使用任意原型制作可调用的 JS 对象？](https://stackoverflow.com/questions/548487/how-do-i-make-a-callable-js-object-with-an-arbitrary-prototype)

假设我们有多个单独的函数，我们可以在它们自己的上下文中单独调用它们；但它们也继承了一些其他对象的原型。像这样：

```
//Here is the parent object:
var Human = function(){
    this.isAlive = true;
};
Human.prototype.say = function(what){
    alert(what + '!');
};

//These will inherit from it:
var ninja = function() {
    alert("I'm a ninja!");
}
var samurai = function(){
    alert("I'm a samurai!");
}

//Now, how can I make ninja and samurai behave like this:
ninja(); //I'm a ninja!
samurai(); //I'm a samurai!
ninja.say('Hello'); //Hello!

//And they should keep their inheritance. Like:
Human.prototype.die = function(){
    this.isAlive = false;
}

ninja.die();
ninja.isAlive == false;

samurai.isAlive == true; 
```

换句话说，有没有办法让两个对象继承另一个对象的原型，但仍然可以作为函数调用？

**注意**：我将在 Adob​​e ExtendScript（又名 Crippled Javascript）中使用它，它对现代 javascript 了解不多。就像， Object.defineProperty 在其中不起作用。那么，有没有一种正常的、标准的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T17:19:40.797

使用 apsillers 的链接问题，我能够通过一项调整使其工作：`Human`的属性和方法被定义为一个对象：

试试看：http: [//jsfiddle.net/lbstr/JZP2S/](http://jsfiddle.net/lbstr/JZP2S/)

关键是`HumanMaker`功能。在基本层面上，它接受一个函数并将`Human`原型添加到其中。这允许您调用您的函数，从中获取所有属性`Human`并吃掉它。这里是：

```
function HumanMaker(f) {
    var h = Human;
    h.__proto__ = f.__proto__;
    f.__proto__ = h;
    return f;
} 
```

你会像这样调用它：

```
var ninja = HumanMaker(function() {
    alert("I'm a ninja!");
}); 
```

这是整个事情：

```
var Human = {
    isAlive: true,
    say: function(what){
        alert(what + '!');
    },
    die: function(){
        this.isAlive = false;
    }
};

function HumanMaker(f) {
    var h = Human;
    h.__proto__ = f.__proto__;
    f.__proto__ = h;
    return f;
}

//These will inherit from it:
var ninja = HumanMaker(function() {
    alert("I'm a ninja!");
});
var samurai = HumanMaker(function(){
    alert("I'm a samurai!");
});

//Now, how can I make ninja and samurai behave like this:
ninja(); //I'm a ninja!
samurai(); //I'm a samurai!
ninja.say('Hello'); //Hello!

ninja.die();
ninja.isAlive == false;

samurai.isAlive == true;​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:34:42.673

我一直发现功能继承模式更容易理解：

```
var human = function(){
    var me = {};
    var _isAlive = true;
    Object.defineProperty(me, "isAlive", {
        get: function() { return _isAlive}
    });

    me.say=function(what){
        if(_isAlive)
          alert(what+'!');  
        else
           throw new Error('I am dead!');                
    }
    me.die=function(){
      _isAlive = false;                
    }
    return me;
};

var person = function(){
    var me = human();
    return me;
};        

var ninja = function(){
    var me = human();
    me.say = function(what){
        if(me.isAlive)
          alert(what+', I am a ninja!');  
        else
           throw new Error('I am dead!');          
    };
    return me;
};

var myPerson = person();
myPerson.say('hi');

var myNinja = ninja();
myNinja.say('hello'); 
```

我在这里留下了一个演示：http: [//jsfiddle.net/vtortola/nbpPt/](http://jsfiddle.net/vtortola/nbpPt/)

干杯。

# windows - Apache (WAMP) 问题：“AH00404: Child: Unable to read socket data from parent”

> ID：13863892
> 
> 赞同：2
> 
> 时间：2012-12-13T16:12:47.407
> 
> 标签：windows, apache, xampp, wamp, wampserver

前端开发人员拼命尝试在 Windows 7（家庭高级版，64 位，SP1）上运行 WAMP。我试过 WAMPSERVER 和 XAMPP。两者启动 Apache 服务均失败，在其 error.log 文件中返回完全相同的严重错误：

> [Thu Dec 13 14:38:56.905257 2012] [mpm_winnt:crit] [pid 4868:tid 280] (OS 109)管道已经结束。: AH00404: Child: 无法从父级读取套接字数据
> 
> [2012 年 12 月 13 日星期四 14:38:57.028264] [mpm_winnt:crit] [pid 5100:tid 408] AH00427：父进程：子进程以状态 3 退出——正在中止。

我已经为这个问题搜索了 2 个多小时，并尝试了几件事。检查/释放端口 80，使用不同的端口，关闭 MSSE 的实时保护，禁用 LMHOSTS 查找，数十次重新安装......一切都无济于事。

请帮忙 ：（

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T20:32:37.007

转到控制面板-> 管理工具-> 服务。找到“Web Deployment Agent Service”右键停止。启动 Apache 看看它是否卡住。如果是这样，请再次右键单击 Web 部署代理并转到属性并将启动类型设置为手动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-20T08:51:42.403

就我而言，错误日志是这样的：

```
[crit] (OS 109)The pipe has been ended.  : setup_inherited_listeners: Unable to read socket data from parent 
```

解决方案是 Apache 设置为侦听 IPv6 接口，但没有启用 IPv6 接口。

# google-sheets - 让 countif 从 continue 中忽略“- -”

> ID：13863895
> 
> 赞同：0
> 
> 时间：2012-12-13T16:12:50.947
> 
> 标签：google-sheets

我在使用 countif 来计算范围内的条目数时遇到问题。问题是该范围是用数组公式填充的，当数据更改单元格时，数组公式添加`=CONTINUE(...)`到现在显示`--`（减号）

```
=COUNTIF(C6:C, "<>") 
```

有没有办法可以编写 countif 来忽略带有 的单元格`--`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:38:40.407

The -- is a way that Google Sheets displays the #VALUE! error. So you can use the [IFERROR](https://support.google.com/drive/bin/static.py?hl=en&topic=25273&page=table.cs&tab=1240291) function to "mask" any of these errors:

`=ArrayFormula(COUNTIF(IFERROR(C6:C);"<>"))`

or more simply:

`=ArrayFormula(COUNTA(IFERROR(C6:C)))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:23:09.107

更新：

为什么不过滤掉所有非文本或类似于 -- 的单元格？然后对 countif 使用过滤范围。

`=COUNTIF((ROWS(C6:C)-COUNTIF(C6:C"<>*")) , "ur criteria")`

有没有一种方法可以让您的公式数组转换除 -- 以外的字符串？

检查这篇[文章](http://www.contextures.com/xlFunctions04.html)

您正在执行的搜索具有正则表达式。在手机上写这个。所以请尝试并原谅奇怪的格式。

# jpa - JPA：从实体中，查询其他实体之间没有关系映射

> ID：13863898
> 
> 赞同：2
> 
> 时间：2012-12-13T16:12:51.687
> 
> 标签：jpa

我的问题可能很简单，以至于我找不到答案。

我想做这样的事情：

```
@Entity  
public class EntityA {

    @Transient
    @SomeQueryAnnotation(query="select b from EntityB where b.id=1")
    private EntityB entityB;
} 
```

EntityB 是一种静态资源。不应将其保存回数据库。实体之间也没有映射。

**[编辑]**

当我这样做时，你认为这没问题：

```
@Entity  
public class EntityA {

    private EntityB getEntityB() {
       ServiceRemote service = (ServiceRemote)context.lookup("ejb:ServiceRemote"); 
       return service.getEntityB();
    }
} 
```

应该仍然可以使用远程处理，因为可以在每个客户端的 jndi.properties 文件中配置连接。当您需要从实体访问数据库时，您首选的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T06:00:49.457

最佳推荐 - 除非这些对象具有数据库内关系，否则不应存在实体关系。

第二好的 - 我建议您创建一个数据传输对象来获取您的对象。

```
@Entity  
public class EntityA {

  @Transient
  private EntityB entityB;
}

@Stateless
public class EntityADTO {
   EntityManager em;

   public EntityA findA(Object pkey) {
      EntityA a = em.find(okey, EntityA.class);
      a.entityB = em.find(1, EntityB.class);

      return a;
   }
} 
```

# ssl - 使用 SSL 的 Azure 云服务的自定义域

> ID：13863909
> 
> 赞同：1
> 
> 时间：2012-12-13T16:13:27.790
> 
> 标签：ssl, service, azure

我正在尝试使用带有自定义域的 https 公开 Azure 云服务，但出现错误：“请求的服务，'https://mydomain.net/myservice.svc' 无法激活。请参阅服务器的诊断跟踪日志以获取更多信息。”

关于自定义域：我已按照[https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/#header-1](https://www.windowsazure.com/en-us/develop/net/common-tasks/custom-dns/#header-1)中的步骤获取第二个选项“一条记录” “：在 Godaddy 的区域文件管理器中，我为“指向”myservice 的“公共虚拟 IP 地址”的“@”主机配置了一条 A 记录（如在 Azure 门户中找到）。在我看来，我得到“无法激活服务”的事实意味着 A 记录正在工作，但我不确定。

关于 https：我已经按照[http://www.31a2ba2a-b718-11dc-8314-0800200c9a66.com/2011/06/how-to-get-and-install-ssl-certificate.html](http://www.31a2ba2a-b718-11dc-8314-0800200c9a66.com/2011/06/how-to-get-and-install-ssl-certificate.html)的步骤进行操作。简而言之：我使用我的开发机器上的 CSR 为 mydomain.net 从 godaddy 购买了一个证书，使用友好名称 mydomain.net 在我的开发机器上完成了 CSR，使用该文件将其导出到 mydomain.net.pfx，上传将证书添加到 Azure 中的云服务，并使用证书在 VS 中配置我的 WebRole，并将 Web 角色项目发布到 Azure。

在客户端（WP7）：

```
<bindings>
  <basicHttpBinding>
    <binding name="BasicHttpsBinding_IMyInterface" 
      maxBufferSize="2147483647"
      maxReceivedMessageSize="2147483647">
      <security mode="Transport" />
    </binding>
  </basicHttpBinding>
</bindings>
<client>
  <endpoint name="BasicHttpsBinding_IMyInterface"
    address="https://mydomain.net/myservice.svc" 
    contract="MyService.IMyInterface"       
    binding="basicHttpBinding"
    bindingConfiguration="BasicHttpsBinding_IMyInterface" />
</client> 
```

注意：我没有使用 CName，因为我的证书不适用于子域，也不是通配符。

从我的搜索中，我得到的印象是这对其他人有用，我无法弄清楚我在做什么不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:41:11.933

是的 - 您需要在服务器配置中指定一个匹配的端点。以下是使用 HTTP 传输安全性的 WCF 服务的 web.config 文件的完整示例（来自[http://msdn.microsoft.com/en-us/library/hh556232.aspx](http://msdn.microsoft.com/en-us/library/hh556232.aspx)）：

```
<?xml version="1.0"?>
<configuration>

  <system.web>
    <compilation debug="true" targetFramework="4.0" />
  </system.web>
  <system.serviceModel>
    <services>
      <service name="MySecureWCFService.Service1">
        <endpoint address=""
                  binding="basicHttpBinding"
                  bindingConfiguration="secureHttpBinding"
                  contract="MySecureWCFService.IService1"/>

        <endpoint address="mex"
                  binding="mexHttpsBinding"
                  contract="IMetadataExchange" />
      </service>
    </services>
    <bindings>
      <basicHttpBinding>
        <binding name="secureHttpBinding">
          <security mode="Transport">
            <transport clientCredentialType="None"/>
          </security>
        </binding>
      </basicHttpBinding>
    </bindings>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the value below to false and remove the metadata endpoint above before deployment -->
          <serviceMetadata httpsGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>

</configuration> 
```

# math - 画一个给定曲率的圆

> ID：13863911
> 
> 赞同：1
> 
> 时间：2012-12-13T16:13:29.990
> 
> 标签：math, drawing

我想画一个给定曲率k的圆。
我只需要知道给定 x 坐标的 y 坐标。所以即 z = 1/k + sqrt(1/k^2 - x^2) 是我通常使用的。问题是我的 k 被允许变为零。这意味着我的圈子变成了一条线。对于数学家来说，这没问题。但对我的电脑来说是。例如，当 k 是最小双精度值时，y 将是无穷大，对于 k == 0，我收到 nan for y。
有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:16:01.297

鉴于这种边界情况，我将只测试输入参数以查看其中一个是否适用，并使用单独的逻辑在适用边界情况时根据需要绘制一条水平线或垂直线。

这是一种相当普遍的方法，并且在计算上非常有效。

在测试边界情况时，测试*k*以确保： - *k^2*不会溢出正在使用的数据类型 - *k*不会小到*1/k^2*会溢出正在使用的数据类型

在任何一种情况下，使用适当的边界案例逻辑。感谢@Godeke 指出这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T18:39:53.037

你给了公式

```
y1 = 1/k + sqrt(1/k^2 - x^2)    // (1) 
```

它用半径和中心描述了圆的*上半*部分。现在对于小的这些值变得非常大，最终将超出您的绘图范围。`1/k``(0, 1/k)``k`

圆的*下半部分*由下式给出

```
y2 = 1/k - sqrt(1/k^2 - x^2)    // (2) 
```

对于接近零的 k，这些值“接近”线`y = 0`。但对于 的小值`k`，(2) 计算两个大数的差。这会导致精度损失和可能的溢出。

但是可以将公式（2）改写成等价形式

```
y2 = k * x^2 / (1 + sqrt(1 - k^2 * x^2))    // (2a) 
```

现在，您可以计算小圆的下半部分，`k`甚至`k = 0`没有任何溢出或精度损失。

对于上半部分，你总是有`y1 >= 1/k`。因此，如果`1/k`大于绘图区域的边界，则可以忽略上限值。否则你可以`y1`通过计算

```
y1 = 2/k - y2 
```

# html - 在 CSS 样式标签中使用表达式语言

> ID：13863913
> 
> 赞同：1
> 
> 时间：2012-12-13T16:13:31.067
> 
> 标签：html, css, jsp, el

我正在尝试使用 HTML+CSS 创建一个百分比条。我有以下代码：

```
<div id="fundingBar">
    <div id="fundingPercentage" style="width:45%"><p class="percentage">45%</p></div>
</div> 
```

现在我希望百分比是一个动态值，所以我有一个名为“百分比”的会话属性。我想在 JSP 页面中使用这个值，我知道的唯一方法是使用 EL，所以它应该是这样的：

```
<div id="fundingBar">
    <div id="fundingPercentage" style="width:${percentage}%"><p class="percentage">${percentage}%</p></div>
</div> 
```

但这不起作用，所以有什么办法可以做到这一点，或者我应该使用 javascript 或类似的东西？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:43:47.280

[模板文本中的EL](https://stackoverflow.com/tags/el/info)（阅读：任何 JSP 标记外的纯 HTML 中的 EL）仅在`web.xml`声明符合 Servlet 2.4 或更高版本并且您的 webapp 部署到支持 Servlet 2.4 或更高版本的容器（自 2003 年 11 月以来已经发布）时才有效) 并且您的 web 应用程序中不包含旧版本的特定于 servletcontainer 的库，`/WEB-INF/lib`这只会与容器自己的库发生冲突。

否则，如果它确实是一个遗留系统，而不仅仅是配置错误`web.xml`的版本或类路径中的版本冲突，那么你唯一且丑陋的手段就是使用[JSTL](https://stackoverflow.com/tags/jstl/info) `<c:out>`。

```
<div id="fundingPercentage" style="width:<c:out value="${percentage}"/>%"> 
```

### 也可以看看：

*   [JSP EL、JSF EL 和 Unified EL 的区别](https://stackoverflow.com/questions/4812755/difference-between-jsp-el-jsf-el-and-unified-el/4812883#4812883)

* * *

当然，我假设您*确实*事先设置了会话属性，如下所示：

```
request.getSession().setAttribute("percentage", 45); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:37:36.313

`#fundingBar`元素有多宽？使用百分比时，将根据父元素计算元素。所以如果`#fundingBar`是 0px 宽，那么 0px 的 45% 也是 0px。

# javascript - jQuery 插件将使用默认选项而不是用户定义的选项

> ID：13863916
> 
> 赞同：0
> 
> 时间：2012-12-13T16:13:39.030
> 
> 标签：javascript, jquery

所以我有一个带有更新方法的插件，如果用户将新内容广告到 div（占位符），则在开始时一切正常，插件将使用插件的用户定义选项，但一旦用户运行update 方法它将使用默认选项而不是定义的选项。

插件包装...

```
;(function($, window, document, undefined){

    //"use strict"; // jshint ;_;

    var pluginName = 'myPlugin';

    function Plugin(element, options){

        this.elm     = $(element);
        this.options = $.extend({}, $.fn[pluginName].defaults, options);

        this.init();
    };

    Plugin.prototype = {

        init: function(){

            // we run this at start...

        },

        update: function(){

            // code that we need when we need to update...

        },

    };

    $.fn[pluginName] = function(option) {
        var options = typeof option == "object" && option;

        return this.each(function() {
            var $this = $(this);
            var data  = new Plugin($this, options);

            if(!$.data($this, pluginName)){         
                $.data($this, pluginName, data);
            }

            if(typeof option == 'string'){
                data[option]();
            }

        });
    };

    $.fn[pluginName].defaults = {
        name: 'Hank',
        ...
        ...
    };

})(jQuery, window, document); 
```

//内联js

```
 $('#container').myPlugin({name: 'NOT Hank...'});

    $('#updatelink').click(function(e){
       $('#container').myPlugin('update');
    }): 
```

# ajax - Wicket 6.3.0 AjaxLink：IAjaxCallListener 行为

> ID：13863927
> 
> 赞同：3
> 
> 时间：2012-12-13T16:14:17.430
> 
> 标签：ajax, wicket

在 Wicket 6 之前，IAjaxCallDecorator.decorateScipt 返回的 javascript 代码在单击后立即执行。我根据[迁移指南](https://cwiki.apache.org/confluence/display/WICKET/Wicket+Ajax)迁移了 IAjaxCallDecorator 。通过在 5 秒内点击链接 3 次，预期的结果是：

*   获取前提条件
*   获取前提条件
*   获取前提条件
*   获取成功处理程序
*   获取成功处理程序
*   获取成功处理程序

但结果是：

*   获取前提条件
*   获取成功处理程序
*   获取前提条件
*   获取成功处理程序
*   获取前提条件
*   获取成功处理程序

用例：阻塞直到 Ajax 请求完成，请参阅[http://my.safaribooksonline.com/book/-/9781849511605/deeper-into-ajax/ch07lvl1sec04](http://my.safaribooksonline.com/book/-/9781849511605/deeper-into-ajax/ch07lvl1sec04)（第 162 页）

还有其他方法可以将 IAjaxCallDecorator 迁移到 Wicket 6 吗？

```
public class HomePage extends WebPage {

 public HomePage(final PageParameters parameters) {
  add(new Label("version", getApplication().getFrameworkSettings().getVersion()));

  AjaxLink<Void> blockingLink = new AjaxLink<Void>("blockingLink") {
    @Override
    public void onClick(AjaxRequestTarget target) {
      try {
        Thread.sleep(5000);
      } catch (InterruptedException e) {
        e.printStackTrace();
      }
    }
    @Override
    protected void updateAjaxAttributes(AjaxRequestAttributes attributes) {
      super.updateAjaxAttributes(attributes);

      IAjaxCallListener blockingListener = new AjaxCallListener() {
        @Override
        public CharSequence getPrecondition(Component component) {
          return "console.log('getPrecondition');";
        }
        @Override
        public CharSequence getSuccessHandler(Component component) {
          return "console.log('getSuccessHandler');";
        }
      };
      attributes.getAjaxCallListeners().add(blockingListener);
    }
  };
  add(blockingLink);
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T09:19:50.763

用例：阻塞直到 Ajax 请求完成，请参阅[http://my.safaribooksonline.com/book/-/9781849511605/deeper-into-ajax/ch07lvl1sec04](http://my.safaribooksonline.com/book/-/9781849511605/deeper-into-ajax/ch07lvl1sec04) （第 162 页）

```
@Override
protected void updateAjaxAttributes(AjaxRequestAttributes attributes) {
  super.updateAjaxAttributes(attributes);
  attributes.setChannel(new AjaxChannel("myChannel", AjaxChannel.Type.ACTIVE));
} 
```

做了这项工作。见[检票口论坛](http://apache-wicket.1842946.n4.nabble.com/Wicket-6-3-0-AjaxLink-IAjaxCallListener-behaviour-td4654785.html#a4654804)

# wcf - 针对 CN 的自定义 X509CertificateValidator 检查请求者

> ID：13863929
> 
> 赞同：0
> 
> 时间：2012-12-13T16:14:22.790
> 
> 标签：wcf, wcf-security, x509certificate

我有一个自定义的 X509CertificateValidator，它当前针对为 WCF SOAP 消息提供的证书验证一系列规则。

需要根据提供证书的域检查证书上的 CN 名称，但我不知道我可以从 X509CertificateValidator 中访问请求。

有什么方法可以检查证书是否与请求域匹配？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T15:15:32.313

我还没有从 X509CertificateValidator 中找到任何方法来执行此操作，但在服务中是可能的。

这是我的第一个剪辑 - 我将对其进行改进以使其更优雅，但这很有效。

```
 private static void ValidateRequestIsFromCertificateDomain()
    {
        RemoteEndpointMessageProperty endpointProperty = OperationContext.Current.IncomingMessageProperties[RemoteEndpointMessageProperty.Name] as RemoteEndpointMessageProperty;
        var claimSet = OperationContext.Current.ServiceSecurityContext.AuthorizationContext.ClaimSets[0] as X509CertificateClaimSet;

        string domain = claimSet.X509Certificate.GetNameInfo(X509NameType.DnsName, false);
        var resolvedAddress = System.Net.Dns.GetHostAddresses(domain);

        if (resolvedAddress.Count() == 0 || endpointProperty.Address != resolvedAddress[0].ToString())
        {
            throw new SecurityException("Client address mismatch");
        }
    } 
```

这并不是真正需要的，因为客户端使用其私钥加密数据，而该私钥只能使用其公钥解密 - 因此您知道证书是由真实客户端提供的。

但是，如果您像我一样将其作为集成要求，这可能对您有用。

# sql - 多行输出重复错误数据

> ID：13863930
> 
> 赞同：0
> 
> 时间：2012-12-13T16:14:22.673
> 
> 标签：sql, oracle, operators

我正在尝试使用运算符在 Oracle 中执行 Select 语句，`LIKE %`并且由于某种原因，输出行采用了不同人的邮政编码。这是我的代码：

```
Select Distinct a.empno,a.ename,a.sal,a.job,b.empadr,b.empstate,b.empzip
From EMP a, EMPADDRESS b
Where a.empno = b.empno
And b.empzip Like '1%'
Or b.empzip Like '8%' 
```

我尝试在 and 周围添加括号`AND`，`OR`但这似乎不起作用。我假设这与我在第一行中编写列的方式有关，但我不确定。如果是这种情况，有人可以解释为什么会发生这种情况，我不想再遇到这个问题。提前感谢所有这些答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:23:40.963

如果我理解正确，目标是根据以“1”或“8”开头的邮政编码返回员工详细信息？当你提到应用括号时，是不是像下面这样，哪个应该起作用？

```
SELECT Distinct a.empno,a.ename,a.sal,a.job,b.empadr,b.empstate,b.empzip
FROM EMP a, EMPADDRESS b
WHERE a.empno = b.empno
AND (b.empzip Like '1%' OR b.empzip Like '8%'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:24:50.800

我认为您遇到麻烦的原因是 OR 的原因。它真正在做的是 a.empno = b.empno And b.empzip Like '1%' 或者 b.empzip Like '8%' 是真的，但你真的想要。a.empno = b.empno and (b.empzip Like '1%' Or b.empzip Like '8%') 所以你只检查邮政编码，如果 empno 匹配。另一种方式是将随机员工连接在一起，然后检查他们的邮政编码是否匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:44:10.883

我不建议在 where 子句中使用“OR”，因此查询可能会很慢。在您的情况下，您可以使用以下内容：

```
Where a.empno = b.empno
And substr(b.empzip, 1, 1) in ('1', '8') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-13T16:21:52.023

括号不见了：

```
Select Distinct a.empno,a.ename,a.sal,a.job,b.empadr,b.empstate,b.empzip 
  From EMP a, EMPADDRESS b
 Where a.empno = b.empno
   And (b.empzip Like '1%' Or b.empzip Like '8%'); 
```

或者你可以使用 JOIN 语法

```
SELECT Distinct empno,a.ename,a.sal,a.job,b.empadr,b.empstate,b.empzip 
  FROM emp a JOIN empaddress b USING (empno)
 WHERE b.empzip Like '1%' Or b.empzip Like '8%'; 
```

# android - 尝试启动 Google 地图会使我的应用崩溃

> ID：13863931
> 
> 赞同：2
> 
> 时间：2012-12-13T16:14:24.477
> 
> 标签：android, android-intent, maps

在我的 android 应用程序上，我只想在用户单击按钮时将位置显示在地图上。但是，当我单击按钮时，android 模拟器会崩溃。

下面是按钮的代码：

```
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button btn = (Button) findViewById(R.id.btn_map);
    btn.setOnClickListener(new View.OnClickListener() 
    {
        public void onClick(View v)
        {
            startActivity(new Intent("com337.assignment.whereami.DisplayMap"));
        }
    });

    Log.d(tag, "In the OnCreate() event");
} 
```

地图启动时的代码是：

```
public class DisplayMap extends MapActivity 
{
MapView mapView;
MapController mc;
GeoPoint p;

private LocationManager lm;
private LocationListener locationListener;

protected class MapOverlay extends com.google.android.maps.Overlay
{
    @Override
    public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when)
    {
        super.draw(canvas, mapView, shadow);

        //Convert the GeoPoint to screen Pixels
        Point screenPts = new Point();
        mapView.getProjection().toPixels(p, screenPts);

        //add the marker
        Bitmap bmp = BitmapFactory.decodeResource(getResources(), R.drawable.pushpin5);
        canvas.drawBitmap(bmp, screenPts.x, screenPts.y-50, null);
        return true;

    }

}

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mapView = (MapView) findViewById(R.id.mapView);
    mapView.setBuiltInZoomControls(true);
    //mapView.setStreetView(true);
    //mapView.setSatellite(true);

    //navigate to a point - Belfast 
    mc = mapView.getController();
    String coordinates[] = {"54.6000", "5.9167"};
    double lat = Double.parseDouble(coordinates[0]);
    double lng = Double.parseDouble(coordinates[1]);

    p = new GeoPoint((int) (lat*1E6), (int) (lng*1E6));
    mc.animateTo(p);
    mc.setZoom(13);

    //add a location marker
    MapOverlay mapOverlay = new MapOverlay();
    List<Overlay> listOfOverlays = mapView.getOverlays();
    listOfOverlays.clear();
    listOfOverlays.add(mapOverlay);

    lm = (LocationManager)getSystemService(Context.LOCATION_SERVICE);
    locationListener = new MyLocationListener();

    lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListener);
    //mapView.invalidate();
}

private class MyLocationListener implements LocationListener
{
    public void onLocationChanged(Location loc)
    {
        p = new GeoPoint((int)(loc.getLatitude() * 1E6), (int)(loc.getLongitude() * 1E6));

        Geocoder geoCoder = new Geocoder(getBaseContext(), Locale.getDefault());
        try
        {
            List<Address> addresses = geoCoder.getFromLocation(p.getLatitudeE6() / 1E6, p.getLongitudeE6() / 1E6, 1);

            String geo = "";
            if (addresses.size() > 0)
            {
                for (int i=0; i<addresses.get(0).getMaxAddressLineIndex();i++)
                    geo += addresses.get(0).getAddressLine(i) + "\n";
            }
            Toast.makeText(getBaseContext(), geo, Toast.LENGTH_SHORT).show();
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }

        mc.animateTo(p);
        mc.setZoom(18);
    }

    public void onProviderDisabled(String provider)
    {

    }

    public void onProviderEnabled(String provider)
    {

    }

    public void onStatusChanged(String provider, int status, Bundle excess)
    {

    }
}

//create a method so that when the user presses the volume up/down key the map zooms in/out
public boolean onKeyDown(int keyCode, KeyEvent event)
{
    MapController mc = mapView.getController();
    switch(keyCode)
    {
    case KeyEvent.KEYCODE_VOLUME_UP:mc.zoomIn();
        break;
    case KeyEvent.KEYCODE_VOLUME_DOWN:mc.zoomOut();
        break;
    }
    return super.onKeyDown(keyCode, event);
}

@Override
public boolean isRouteDisplayed() 
{

    return false;
}

} 
```

崩溃的更新 logcat 信息是：

```
12-13 16:40:49.231: W/dalvikvm(699): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
12-13 16:40:49.331: E/AndroidRuntime(699): FATAL EXCEPTION: main
12-13 16:40:49.331: E/AndroidRuntime(699): java.lang.RuntimeException: Unable to start activity ComponentInfo{com337.assignment.whereami/com337.assignment.whereami.DisplayMap}: java.lang.NullPointerException
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.os.Looper.loop(Looper.java:137)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.ActivityThread.main(ActivityThread.java:4745)
12-13 16:40:49.331: E/AndroidRuntime(699):  at java.lang.reflect.Method.invokeNative(Native Method)
12-13 16:40:49.331: E/AndroidRuntime(699):  at java.lang.reflect.Method.invoke(Method.java:511)
12-13 16:40:49.331: E/AndroidRuntime(699):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-13 16:40:49.331: E/AndroidRuntime(699):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-13 16:40:49.331: E/AndroidRuntime(699):  at dalvik.system.NativeStart.main(Native Method)
12-13 16:40:49.331: E/AndroidRuntime(699): Caused by: java.lang.NullPointerException
12-13 16:40:49.331: E/AndroidRuntime(699):  at com337.assignment.whereami.DisplayMap.onCreate(DisplayMap.java:66)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.Activity.performCreate(Activity.java:5008)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-13 16:40:49.331: E/AndroidRuntime(699):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-13 16:40:49.331: E/AndroidRuntime(699):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:22:10.483

你在打电话

```
startActivity(new Intent("com337.assignment.whereami.DisplayMap")); 
```

使用`new Intent("com337.assignment.whereami.DisplayMap");`意味着您要使用“com337.assignment.whereami.DisplayMap”的 ACTION 创建一个意图。由于这是您传入的类名而不是操作，因此不会找到任何活动。你没有赶上，`ActivityNotFoundException`所以你会崩溃

由于您显然是在尝试启动此类，因此您不应该这样做..如果这是您项目的一部分，您应该使用

```
 startActivity(new Intent(YourActivityName.this, com337.assignment.whereami.DisplayMap.class)); 
```

或者

```
startActivity(new Intent(getApplicationContext(), com337.assignment.whereami.DisplayMap.class)); 
```

[您可以在此处](http://developer.android.com/reference/android/content/Intent.html)阅读有关使用意图的信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:23:16.723

使用此构造函数：

```
Intent(Context packageContext, Class<?> cls) 
```

而不是您正在使用的那个

```
Intent(String action) 
```

# asp.net-mvc-3 - 奇怪的 Razor 嵌套 foreach (...) { @Html.... }

> ID：13863936
> 
> 赞同：1
> 
> 时间：2012-12-13T16:14:54.843
> 
> 标签：asp.net-mvc-3, razor, nested

我想在我的 Razor 视图中执行此操作：

```
@foreach (Customer cust in Model.Customers)
{
    <tr data-custid="@customer.GetIdAsText()">
        @Html.RenderPartial("CustomerListTableRow", cust)
    </tr>
} 
```

据我了解，这应该有效。foreach 块包含一个 <tr>...</tr>。在里面，它处于标记模式，所以我需要 @ 来切换到 C# 模式。问题是显然变量 cust 丢失了它的类型信息（和值？），所以它抱怨它不能将 void 转换为 RenderPartial 期望的对象。

我让它像这样工作：

```
@foreach (Customer cust in Model.Customers)
{
    @:<tr data-custid="@customer.GetIdAsText()">
        Html.RenderPartial("CustomerListTableRow", cust);
    @:</tr>
} 
```

但是除了看起来很丑之外，如果我让 VS 美化代码，它会像这样搞砸：

```
@foreach (Customer cust in Model.Customers)
{
    @:<tr data-custid="@customer.GetIdAsText()">
Html.RenderPartial("CustomerListTableRow", cust); @:</tr>                 } 
```

不错吧？:-)

那么，为什么第一个解决方案不起作用？我*应该*怎么写？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:27:43.990

[`Html.RenderPartial()`](http://msdn.microsoft.com/en-us/library/dd492962%28v=vs.108%29.aspx)是一个 void 方法，因此它必须用`{ }`块括起来：

```
@{Html.RenderPartial("CustomerListTableRow", cust);} 
```

你肯定要找的是[`Html.Partial()`](http://msdn.microsoft.com/en-us/library/ee402926%28v=vs.108%29.aspx)，它返回一个[`MvcHtmlString`](http://msdn.microsoft.com/en-us/library/system.web.mvc.mvchtmlstring%28v=vs.108%29.aspx)，它可以像这样使用：

```
@Html.Partial("CustomerListTableRow", cust) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:20:54.373

我认为这应该工作，

```
@foreach (Customer cust in Model.Customers)
{
    <tr data-custid="@customer.GetIdAsText()">
        @Html.RenderPartial("CustomerListTableRow", cust);
    </tr>
} 
```

取决于您正在运行的 MVC 版本。

您能否提供有关该错误的更多详细信息？

# objective-c - UITextView 不刷新

> ID：13863940
> 
> 赞同：1
> 
> 时间：2012-12-13T16:15:07.947
> 
> 标签：objective-c, ios, uitextview, appdelegate

我正在尝试集成“打开方式...”功能。

在我的`AppDelegate.m`我有

```
-(BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{
...
_fileContent = [NSString stringWithContentsOfURL:url
                                                encoding:NSUTF8StringEncoding
                                                   error:&error];
...
ViewController *vc = (ViewController*)self.window.rootViewController;
        [vc refreshUI:nil];
} 
```

我正在使用 ARC，所以我只在 my 中调用以下内容，`ViewController.h`然后`@synthesize`在`.m`

```
@property (nonatomic, retain) IBOutlet UITextView *textView; 
```

在我的`ViewController.m`我有以下

```
-(void)refreshUI:(id)sender
{
    AppDelegate *appDelegate = (AppDelegate*)[[UIApplication sharedApplication] delegate];

    if ([appDelegate openedFromURL])
    {
        NSLog(@"[refreshUI] appDelegate openFromURL (Length: %d)", [appDelegate.fileContent length]);
        NSLog(@"Contents before: %@", [_textView text]);
        [_textView setText:appDelegate.fileContent];
        NSLog(@"Contents after: %@", [_textView text]);
    }
...
} 
```

当我从另一个应用程序（Dropbox）打开我的文件时，第一个 NSLog 为我提供了正确的文件长度。第二个 NSLog 为我提供了 UITextView 的正确“旧”内容，第三个 NSLog 为我提供了正确的“新”内容（从我通过 Dropbox 应用程序“打开...”的文件的内容开始）。所以数据确实进入了我的应用程序。

问题是 UITextView 没有得到更新。如果我按下 UIViewController 中的任何其他按钮（这会导致我切换到不同的 UIViewController），然后返回“ViewController”，则 UITextView 会使用正确的数据进行更新。即使我添加一个 UIButton 并将其操作设置为仅调用`[self refreshUI]`UITextView 更新。

它只是不会从 AppDelegate 调用的方法中自行刷新。

我究竟做错了什么？我什至尝试手动重绘 UITextView `setNeedsDisplay`。但这没有任何效果。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T19:50:03.553

现在可以从您的评论中推断出来。似乎您的故事板 segues 正在实例化您的“ViewController”类的新实例，而不是让您回到原来的状态。然而，原来的仍然是应用程序委托的`rootViewController`. 这会导致您向视图控制器的一个实例发送消息，该实例不是当前呈现的。本质上，您正在更改您看不到的标签。有几种方法可以解决这个问题。

*   改变你的segues，让他们带你回到`rootViewController`：

这可能是最简单的，并且可能会提高您的效率。在导致返回的方法中，使用带有`pop...`or之类的词的方法`dismiss`。

*   使用委托：

将 a 添加`urlLaunchDelegate`到您的应用程序委托中，并在适当的时间（`viewDidLoad`或`viewWillAppear:`）让您的视图控制器将自己设置为`urlLaunchDelegate`.

*   使用`NSNotificationCenter`

有一个`MyApplication_LaunchURLNotification`你的视图控制器观察到的通知。您可以添加`NSURL`作为对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:22:08.677

```
@property (nonatomic, retain) IBOutlet UITextView 
```

需要声明一个名字

```
@property (nonatomic, retain) IBOutlet UITextView *textView 
```

您还需要在 IBOutlet 中链接 textView。

# java - 将 OSGI 包作为经典 jar 运行时出现 NoClassDefFoundError

> ID：13863943
> 
> 赞同：5
> 
> 时间：2012-12-13T16:15:20.037
> 
> 标签：java, eclipse, maven, dependency-management, tycho

我在 Java 应用程序和 RCP 应用程序之间有通用代码。所以我创建了一个 OSGI 包，其中包含：

*   将其用作经典 jar 的主类
*   在我的 RCP 应用程序中使用它的 OSGi 清单

我首先使用 Tycho Manifest 构建了所有内容，并且它运行良好，直到我需要在我的公共代码中使用外部 jar。

我需要使用 jsch，所以我在 MANIFEST.MF 中添加了 jsch：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Main-Class: mygroupid.Main
Bundle-Name: Common tools
Bundle-SymbolicName: common-tools
Bundle-Version: 1.0.1.qualifier
Export-Package: mygroupid,
      mygroupid.tools
Bundle-RequiredExecutionEnvironment: JavaSE-1.6
Import-Package: org.osgi.framework;version="1.3.0"
Require-Bundle: com.jcraft.jsch;bundle-version="0.1.46" 
```

我用 Tycho 构建了我的 RCP 应用程序，它可以工作。但是当我将捆绑包作为纯 JAR 运行时`java -jar myjar.jar`，我收到以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/jcraft/jsch/JSchException 
```

如果我用 Eclipse 导出我的包，它可以工作。所以我的第谷配置有错误...

如何解决这个问题呢 ？Tycho 有依赖关系的 jar 吗？似乎不是这样 我错过了什么？

（我的配置：Eclipse Juno 与 m2e，Tycho 0.16.0，p2：Juno，Tycho：包装>eclipse-plugin，目标平台配置：resolver=p2 和 pomDependencies=consider。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T12:01:31.717

只需将[maven-assembly-plugin](http://maven.apache.org/plugins/maven-assembly-plugin/single-mojo.html)添加到您的构建中，并让它构建一个包含所有依赖项的 jar：

```
<plugin>
   <artifactId>maven-assembly-plugin</artifactId>
   <version>2.4</version>
   <configuration>
      <descriptorRefs>
         <descriptorRef>jar-with-dependencies</descriptorRef>
      </descriptorRefs>
   </configuration>
</plugin> 
```

或者，您也可以创建一个程序集，将罐子[单独包装](http://maven.apache.org/plugins/maven-assembly-plugin/examples/single/including-and-excluding-artifacts.html)。您需要为此编写自己的[程序集描述符](http://maven.apache.org/plugins/maven-assembly-plugin/assembly.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:56:57.140

如果你在 Linux/Unix 平台上工作，你可以试试 java -classpath :myjar.jar com.yourpackage.mainclass

如果你在 windows 平台上工作，你可以试试 java -classpath ;myjar.jar com.yourpackage.mainclass

# java - Java 7 使用 Web Start 破坏 OS X 上的 SWT 应用程序

> ID：13863945
> 
> 赞同：9
> 
> 时间：2012-12-13T16:15:24.447
> 
> 标签：java, macos, swt, java-7, java-web-start

我们有一个通过使用 SWT 库的 webstart 启动的应用程序。

众所周知，osx 需要 swt 库在主线程中运行，所以我们的 jnlp 中有这个：

```
<resources os="Mac"> 
    <j2se version="1.6+" java-vm-args="-XstartOnFirstThread"/>
    <jar href="swt-mac64.jar"/>
</resources> 
```

由于我们已经升级到 Java 7 (1.7.0_10)，webstart 似乎没有将“-XstartOnFirstThread”传递给它启动的 java 进程。

我可以从“ps”中看到 java 进程没有获得“-XstartOnFirstThread”选项。

有谁知道如何让 webstart 恢复到以前的行为？

问候，戈德。

这是 webstart 日志显示的内容：

```
Java Web Start 10.10.2.18
Using JRE version 1.7.0_10-b18 Java HotSpot(TM) 64-Bit Server VM
User home directory = /Users/shier
----------------------------------------------------
c:   clear console window
f:   finalize objects on finalization queue
g:   garbage collect
h:   display this help message
m:   print memory usage
o:   trigger logging
p:   reload proxy configuration
q:   hide console
r:   reload policy configuration
s:   dump system and deployment properties
t:   dump thread list
v:   dump thread stack
0-5: set trace level to <n>
----------------------------------------------------
    Match: beginTraversal
Match: digest selected JREDesc: JREDesc[version 1.6+, heap=-1--1, args=-XstartOnFirstThread, href=null, sel=false, null, null], JREInfo: JREInfo for index 0:
    platform is: 1.7
    product is: 1.7.0_10
    location is: http://java.sun.com/products/autodl/j2se
    path is: /Library/Internet Plug-ins/JavaAppletPlugin.plugin/Contents/Home/bin/java
    args is: null
    native platform is: Mac OS X, x86_64 [ x86_64, 64bit ]
    JavaFX runtime is: JavaFX 2.2.4 found at /Library/Internet Plug-ins/JavaAppletPlugin.plugin/Contents/Home/
    enabled is: true
    registered is: true
    system is: true

    Match: ignoring maxHeap: -1
    Match: ignoring InitHeap: -1
    Match: digesting vmargs: -XstartOnFirstThread
    Match: digested vmargs: [JVMParameters: isSecure: false, args: -XstartOnFirstThread]
    Match: JVM args after accumulation: [JVMParameters: isSecure: false, args: -XstartOnFirstThread]
    Match: digest LaunchDesc: http://htxuat.example.com/broker/broker-XX.jnlp
    Match: digest properties: []
    Match: JVM args: [JVMParameters: isSecure: false, args: -XstartOnFirstThread]
    Match: endTraversal ..
    Match: JVM args final: -XstartOnFirstThread
    Match: Running JREInfo Version    match: 1.7.0.10 == 1.7.0.10
     Match: Running JVM args match the secure subset: have:<"-Djnlp.application.href=\"http://htxuat.example.com/broker/broker-XX.jnlp \"">  satisfy want:<-XstartOnFirstThread>
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Available host [tcp:htxuat.example.com:49200]
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Available host [ssl:htxuat.example.com:49301]
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Will try the first address [tcp:htxuat.example.com:49200]
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Using host [tcp:htxuat.example.com:49200]
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Don't forget to change back the logging, this is only temporary
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Using library /Users/shier/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
Dec 13, 2012 10:19:49 AM com.example.log.JavaUtilLogger infoImpl
INFO: Registering  [com.example.client.ClientController]
JNLPClassLoader: Finding library libswt-cocoa-3738.dylib
JNLPClassLoader: Finding library libswt-cocoa.dylib
JNLPClassLoader: Finding library libswt-pi-cocoa-3738.dylib
JNLPClassLoader: Finding library libswt-pi-cocoa.dylib
***WARNING: Display must be created on main thread due to Cocoa restrictions.
Dec 13, 2012 10:19:50 AM com.example.log.JavaUtilLogger errorImpl
SEVERE: Problem
org.eclipse.swt.SWTException: Invalid thread access
    at org.eclipse.swt.SWT.error(SWT.java:4282)
    at org.eclipse.swt.SWT.error(SWT.java:4197)
    at org.eclipse.swt.SWT.error(SWT.java:4168)
    at org.eclipse.swt.widgets.Display.error(Display.java:1065)
    at org.eclipse.swt.widgets.Display.createDisplay(Display.java:822)
    at org.eclipse.swt.widgets.Display.create(Display.java:805)
    at org.eclipse.swt.graphics.Device.<init>(Device.java:130)
    at org.eclipse.swt.widgets.Display.<init>(Display.java:696)
    at org.eclipse.swt.widgets.Display.<init>(Display.java:687)
    at org.eclipse.swt.widgets.Display.getDefault(Display.java:1383)
    at org.eclipse.swt.widgets.Shell.<init>(Shell.java:270)
    at org.eclipse.swt.widgets.Shell.<init>(Shell.java:263)
    at com.example.swt.ShellViewParent.attach(ShellViewParent.java:124)
    at com.example.swt.MultipleParents.init(MultipleParents.java:55)
    at com.example.client.mvc.ViewController.setViewParents(ViewController.java:320)
    at com.example.client.mvc.ViewController.setViewParents(ViewController.java:287)
    at com.example.client.mvc.ViewController.setViewParents(ViewController.java:278)
    at com.example.client.gui.prefs.PreferencesViewController.<init>(PreferencesViewController.java:53)
    at com.example.client.ClientController.init(ClientController.java:353)
    at com.example.mvc.Controller.register(Controller.java:51)
    at com.example.client.Application.loadComponents(Application.java:153)
    at com.example.client.Application.start(Application.java:139)
    at com.example.client.Application.main(Application.java:166)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.javaws.Launcher.executeApplication(Unknown Source)
    at com.sun.javaws.Launcher.executeMainClass(Unknown Source)
    at com.sun.javaws.Launcher.doLaunchApp(Unknown Source)
    at com.sun.javaws.Launcher.run(Unknown Source)
    at java.lang.Thread.run(Thread.java:722)

org.eclipse.swt.SWTException: Invalid thread access
    at org.eclipse.swt.SWT.error(SWT.java:4282)
    at org.eclipse.swt.SWT.error(SWT.java:4197)
    at org.eclipse.swt.SWT.error(SWT.java:4168)
    at org.eclipse.swt.widgets.Display.error(Display.java:1065)
    at org.eclipse.swt.widgets.Display.createDisplay(Display.java:822)
    at org.eclipse.swt.widgets.Display.create(Display.java:805)
    at org.eclipse.swt.graphics.Device.<init>(Device.java:130)
    at org.eclipse.swt.widgets.Display.<init>(Display.java:696)
    at org.eclipse.swt.widgets.Display.<init>(Display.java:687)
    at org.eclipse.swt.widgets.Display.getDefault(Display.java:1383)
    at org.eclipse.swt.widgets.Shell.<init>(Shell.java:270)
    at org.eclipse.swt.widgets.Shell.<init>(Shell.java:263)
    at com.example.swt.ShellViewParent.attach(ShellViewParent.java:124)
    at com.example.swt.MultipleParents.init(MultipleParents.java:55)
    at com.example.client.mvc.ViewController.setViewParents(ViewController.java:320)
    at com.example.client.mvc.ViewController.setViewParents(ViewController.java:287)
    at com.example.client.mvc.ViewController.setViewParents(ViewController.java:278)
    at com.example.client.gui.prefs.PreferencesViewController.<init>(PreferencesViewController.java:53)
    at com.example.client.ClientController.init(ClientController.java:353)
    at com.example.mvc.Controller.register(Controller.java:51)
    at com.example.client.Application.loadComponents(Application.java:153)
    at com.example.client.Application.start(Application.java:139)
    at com.example.client.Application.main(Application.java:166)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.javaws.Launcher.executeApplication(Unknown Source)
    at com.sun.javaws.Launcher.executeMainClass(Unknown Source)
    at com.sun.javaws.Launcher.doLaunchApp(Unknown Source)
    at com.sun.javaws.Launcher.run(Unknown Source)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T05:16:58.153

我在 Java 7 中也看到了这一点，并且想知道这是否是基于另一个人的这篇文章的 Java 7 错误（我继续提交了一份错误报告，因为我在搜索 Java 错误数据库时没有看到任何内容） ：[http ://www.java.net/forum/topic/jdk/java-se/webstart-os-x-xstartonfirstthread](http://www.java.net/forum/topic/jdk/java-se/webstart-os-x-xstartonfirstthread)

我发现的解决方法只是使用 Apple 提供的 Java 6 中的 javaws，尽管我必须从命令行启动它： `/System/Library/Java/Support/Deploy.bundle/Contents/MacOS/javaws myjnlp.jnlp`

# blackberry - 是否可以使浏览器字段适合设备屏幕的实际大小？

> ID：13863946
> 
> 赞同：0
> 
> 时间：2012-12-13T16:15:27.743
> 
> 标签：blackberry, browserfield

我正在使用浏览器 field2 在应用程序中加载 URL 的内容。数据加载成功。

但我的要求是缩小数据并以这样一种方式显示，即无需任何滚动，整个内容都应该在设备屏幕上可见。

当我用谷歌搜索时，请阅读 config.setProperty(BrowserFieldConfig.INITIAL_SCALE, new Float(0.1)); 应该这样做。但这对我不起作用。

我想以一种与 BB 设备无关的方式执行此操作，URL 的内容应该适合设备屏幕。

任何帮助将非常感激。提前致谢..！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T13:24:34.967

在网页的 HTML 中添加最小比例设置为 0 的元标记

从客户端，我们可以使用初始缩放方法缩小网页。

config.setProperty(BrowserFieldConfig.INITIAL_SCALE, new Float(value));

就我而言，此元标记不存在，因此初始比例选项在一定限制后不起作用。通过在 html 中进行设置，我们可以将其缩放到定义的最小/最大比例之间的任何值。

有了这个，我的问题就解决了。

但是，如果你想让它适合设备屏幕，则必须计算比例值以使其设置为所有设备的屏幕尺寸，而不管分辨率如何。

# ios - 水平视图不滚动并破坏页面元素的间距

> ID：13863955
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:16:04.403
> 
> 标签：ios, ios5

当模拟器处于水平视图时，按钮并不完全适合屏幕，我认为用户需要滚动。

但是由于某种原因，无法滚动并且底部按钮被向上推，使屏幕看起来很破碎。

看起来是这样的：

![在此处输入图像描述](../Images/075c6dc536841d51f1feee7f85d9266a.png)

这是典型的吗？这通常是什么解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T17:02:21.877

只需使用 tableviewcontroller 而不是常规视图控制器。转到您的故事板，将 Tableview 控制器拖到您的故事板屏幕并将其连接到看起来像这样的任何东西

![在此处输入图像描述](../Images/6034dac576abf097b67363f091d74476.png)

然后，如果您不需要它，只需删除 Table View Cell

![在此处输入图像描述](../Images/70530c956b790b920d0d5586fe6deafa.png)

然后从对象中拖放一个视图，它应该看起来像这样

![在此处输入图像描述](../Images/0309f78002008bbe15bf23377f52087d.png)

然后根据需要调整视图的高度。并添加任何你想要的

![在此处输入图像描述](../Images/091a688ac1598b008c05b32c97d1bbc4.png)

**一件重要的事情是，当您选择 viewcontroller 的类时，您需要选择 UITableviewcontroller 类**

**所以只需添加一个新的objective -c 文件（从tableviewcontroller 继承）**

# ms-access - 访问表单按钮以生成和过滤现有报告

> ID：13863958
> 
> 赞同：1
> 
> 时间：2012-12-13T16:16:13.833
> 
> 标签：ms-access

我有一个表格，可以为我的用户提供休假时间的摘要（Associate Summary）。我还有一份报告，它以报告格式生成摘要信息，用于电子邮件和打印（摘要）。两者都可以独立工作，摘要基于 ComboBox 选择单个用户，并且报告会拉取所有用户。我正在寻找一种在表单（关联摘要）上放置命令按钮以打开报表（摘要）并将其过滤为当前显示在表单（关联摘要）上的用户名的方法。我用命令按钮修改了我的表单并添加了此代码。

```
Private Sub Command22_Click()
   DoCmd.OpenReport "Summary", acViewPreview, , "Name = " & Me.Combo8     
End Sub 
```

除了要求我输入报告的名称外，这有效。然后它就像我想要的那样生成。假设与组合框关联的多个值是问题所在，我尝试调整到不是组合框的字段。

```
Private Sub Command22_Click()
   DoCmd.OpenReport "Summary", acViewPreview, , "Name = " & Me.Text12     
End Sub 
```

Text12 是用逗号连接两个字段的表达式。

```
=[Last] & ", " & [First]
result... Doe, John 
```

当我现在使用命令按钮时，我收到一个带有以下错误的调试。

```
Run-Time error '3075':
Syntax error (comma) in query expression '(Name = Doe, John)'. 
```

想法...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:21:27.487

使用`OpenReport`方法的`WhereCondition`参数过滤报表的记录源。

因此，假设表单有一个名为的文本框`txtUserName`并且报告的记录源包含一个名为 的字段`user_name`，请在命令按钮的单击事件过程中使用类似这样的内容：

```
DoCmd.OpenReport "YourReportName", _
    WhereCondition:="user_name='" & Me.txtUserName & "'" 
```

实际上，您可以通过使用字符串变量来保存*WhereCondition*来简化故障排除。

```
Dim strWhere AS String
strWhere = "user_name='" & Me.txtUserName & "'"
Debug.Print strWhere ' <-- use Ctrl+g to open Immediate window and view this
DoCmd.OpenReport "YourReportName", WhereCondition:=strWhere 
```

# mysql - 不喜欢不与列进行比较

> ID：13863959
> 
> 赞同：1
> 
> 时间：2012-12-13T16:16:15.530
> 
> 标签：mysql

数据相当大，每次运行都需要几分钟，所以调试这个问题需要很多时间。当我`like concat('%',T.item,'%')`在较小的数据上运行时，它似乎可以正确识别项目。但是，当我在主数据库（显示的代码）上运行它时，它仍然显示许多（甚至可能是全部）异常。

编辑：似乎当我添加 NOT 它停止识别项目

```
select distinct T.comment
from (select comment, source, item from data, non_informative where ticker != "O" and source != 7 and source != 6) as T
where T.comment not like concat('%',T.item,'%')
order by T.comment; 
```

`commen`t 和`source`在`data`,`item`在`non_informative`

一些项目来自`T.item`：

> “股票分析 -”、“#InsideTrades”、“IIROC 贸易”

应删除的示例注释

> '#InsideTrades #4 | MACNAB CRAIG（董事、高级职员、首席执行官）：为 $NNN 提交表格 4（NATIONAL RETA'

似乎无法弄清楚为什么显示所有项目

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:33:02.090

（旧查询已删除）

试试这个查询 -

```
SELECT comment FROM data, non_informative
WHERE ticker != 'O' AND source != 7 AND source != 6
  GROUP BY comment
HAVING COUNT(IF(comment LIKE CONCAT('%', item, '%'), 1, NULL)) = 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:52:44.857

你在`non_informative`和`data`表之间有一个笛卡尔积。（根本不清楚该列`ticker`来自哪个表。

了解要返回的“评论”，所需要的（满足查询中的谓词）就是找到`non_informative`与评论不“匹配”的一行。non_informative 中可能有匹配的行，但您的查询并不关心这些。您的查询只是寻找不匹配的行的存在。该查询实际上是说，只有当它与非信息性中的每一行匹配时，才会排除“评论”。

* * *

如果您要返回的是 non_informative 中没有匹配行的“comment”值，则需要不同的查询。（我将假设该`ticker`列来自`data`表格。）

我还将排除空字符串值的极端情况`item`，因为这将基本上“匹配”每个非空值以进行注释。

* * *

# [SQL小提琴在这里](http://sqlfiddle.com/#!2/cb679/1)

-- 使用 NOT EXISTS 谓词：

```
 SELECT d.comment
   FROM `data` d
  WHERE d.ticker != 'O'
    AND d.source != 7
    AND d.source != 6
    AND NOT EXISTS
        ( SELECT 1
            FROM `non_informative` n
           WHERE n.item <> ''
             AND d.comment LIKE CONCAT('%',n.item,'%')
        )
  GROUP BY d.comment
  ORDER BY d.comment 
```

-- 或者，使用反连接：

```
 SELECT d.comment
   FROM `data` d
   LEFT
   JOIN ( SELECT n.item
            FROM `non_informative` n
           WHERE n.item <> ''
           GROUP BY n.item
        ) m
     ON d.comment LIKE CONCAT('%',m.item,'%')
  WHERE d.ticker != 'O'
    AND d.source != 7
    AND d.source != 6
    AND m.item IS NULL
  GROUP BY d.comment
  ORDER BY d.comment 
```

这两个语句应该返回一个等效的结果集（但与原始查询的结果集不同）。它们也可能表现出不同的性能特征（取决于 MySQL 的版本，以及 MySQL 引擎是否可以将 NOT EXISTS 谓词转换为反连接操作......性能实际上取决于可用的索引和生成的索引执行计划。）

如果我们不关心空字符串的极端情况，我们可以稍微简化第二个语句......

```
 SELECT d.comment
   FROM `data` d
   LEFT
   JOIN `non_informative` n
     ON d.comment LIKE CONCAT('%',n.item,'%')
  WHERE d.ticker != 'O'
    AND d.source != 7
    AND d.source != 6
    AND n.item IS NULL
  GROUP BY d.comment
  ORDER BY d.comment 
```

基本上，对于表中的每一行`data`，我们都在检查表中的“匹配” `non_informative`。对于我们找到“匹配”的任何行，该行将被“n.item IS NULL”谓词排除。对于`data`在 中找不到匹配行的任何行`non_informative`，LEFT JOIN 操作将为“item”列生成 NULL 值，因此该行将包含在结果集中。

* * *

**表现：**

您的原始查询包括一个内联视图（别名为`t`）。MySQL 将在外部查询运行之前将其实现为中间 MyISAM 表。这种想法可能是大型表的真正性能杀手。

但在我们“调整”该语句之前，我们确实需要一个返回正确结果集的语句。（如果它没有返回所需的结果集，那么重写该语句是没有意义的，除非作为练习。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:57:12.907

我没有明确的答案，但我可以建议一些可能的步骤来调查此案。

1.  你没有显示什么是错误？有很多类似的错误吗？

2.  您是否检查过类似操作导致错误？

3.  德瓦特的想法似乎是可能的。不同编码的混合可能是奇怪错误的来源。它只能对某些值失败。什么是项目的字段类型？您可以使用转换（[mysql帮助](http://dev.mysql.com/doc/refman/5.0/en/charset-convert.html)）。

4.  可能您可以用定位或 instr 函数的调用替换 like。

# wcf - 从 microsoft project server 2010 读取项目列表

> ID：13863960
> 
> 赞同：0
> 
> 时间：2012-12-13T16:16:20.037
> 
> 标签：wcf, web-services, sharepoint

我想阅读.net 中使用 PSI Web 服务的项目列表。不知道怎么回事，请求web方法的时候总是报“Unhandled Communication Fault occurred”异常。

有人可以帮我修复它吗？

我正在使用 VS 2010

1.  使用网络引用添加并使用以下代码，（给出实际用户名和密码）网络参考网址：servername/ProjectServerName/_vti_bin/PSI/project.asmx?wsdl

    svcProject.Project prj2 = 新 svcProject.Project(); prj2.Credentials = new NetworkCredential("testuser", "testpassword"); svcProject.ProjectDataSet lst2 = prj2.ReadProjectList();

2.  我也用下面的代码尝试了 WCF 参考

    ProjectSoapClient.ProjectSoapClient prj = new ProjectSoapClient.ProjectSoapClient(); prj.ClientCredentials.Windows.ClientCredential = new NetworkCredential("testuser", "testpassword", "SDP"); prj.ClientCredentials.Windows.AllowedImpersonationLevel = TokenImpersonationLevel.Impersonation; ProjectDataSet lst = prj.ReadProjectList();

我总是收到“**发生未处理的通信故障**”错误，

一些曾经可以帮助在 Project Server 2010 中对用户权限或身份验证进行更改

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T16:39:17.233

您是否正在尝试捕获soapexception？

```
 catch (SoapException ex)
    {

        PSLib.PSClientError error = new PSLib.PSClientError(ex);
        PSLib.PSErrorInfo[] errors = error.GetAllErrors();
        PSLib.PSErrorInfo thisError;
        for (int i = 0; i < errors.Length; i++)
        {
            thisError = errors[i];
        }
        string StrException = ex.ToString() + " \r\nInner Exception: " + ex.InnerException.ToString();

    } 
```

您是否尝试过 login.asmx 服务进行身份验证而不是进行模拟

```
 //Creating a new service client object
   ProjectDerived projectSvc = new ProjectDerived();
   projectSvc.Url = projectServerUrl + "Project.asmx";
   projectSvc.Credentials = CredentialCache.DefaultCredentials;
   projectSvc.CookieContainer = GetLogonCookie();
   projectSvc.EnforceWindowsAuth = isWindowsUser;

// Get a CookieContainer property from the derived LoginWindows object.
private static CookieContainer GetLogonCookie()
{
    // Create an instance of the loginWindows object.
    LoginWindowsDerived loginWindows = new LoginWindowsDerived();
    loginWindows.EnforceWindowsAuth = true;
    loginWindows.Url = projectServerUrl + "LoginWindows.asmx";
    loginWindows.Credentials = CredentialCache.DefaultCredentials;

    loginWindows.CookieContainer = new CookieContainer();

    if (!loginWindows.Login())
    {
        // Login failed; throw an exception.
        throw new UnauthorizedAccessException("Login failed.");
    }
    return loginWindows.CookieContainer;
} 
```

# java - 向 WebServices 客户端隐藏数据对象结构和字段

> ID：13863961
> 
> 赞同：1
> 
> 时间：2012-12-13T16:16:21.407
> 
> 标签：java, web-services, api, design-patterns

我们有一个在控制器/服务/DAO 架构上用 Java 开发的经典订单管理应用程序。数据对象是表示数据库中数据的 POJO。基本上我们有 1 个类映射数据库中的 1 个表，但我们不使用任何 ORM 或实体机制这些数据对象在所有层之间传递，以通过 Web GUI 创建/修改/获取订单。该应用程序还有一个 WebService 层，允许外部系统通过 SOAP 管理这些订单。WebService 层依赖于 Service 层来确保 WebService 和 GUI 之间使用相同的逻辑。

我们尝试使 WebServices API 尽可能稳定，但是由于我们目前使用数据对象作为 WebService 方法的参数，因此该 API 可能会经常更改（至少每次我们拥有或修改数据库中的任何字段时） . 此外，我们希望向 WebService 客户端隐藏一些复杂的数据库结构。例如，数据库包含多个我们希望对客户隐藏的字段。

具体问题：

*   通过客户端 API 隐藏数据库结构和字段常用什么样的设计模式？

*   是否有任何好的做法来处理公共方法参数和内部数据对象之间的“映射”？

*   数据传输对象是我问题的答案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:34:43.213

您不应该跨进程边界传递数据对象。它使您的应用程序变得脆弱，并保证每次进行架构更改时都会进行大量返工。我的建议是这样的：

- 数据访问层应该就是：处理创建、读取、更新和删除数据库对象。DAL 的用户必须知道数据库的工作原理才能使用它。

ex（在伪代码中）：

```
Person = {
PERSON_ID:'1234567jksjgkhsduw0909wueioksgt',
FIRST_NAME:'CHRIS',
LAST_NAME:'MCCALL',
TITLE:'',
GENDER:'M',
LAST_NAME_SUFFIX:null,
Addresses = [{ADDRESS_ID:1234,...}]
} 
```

等 - 服务层转换数据库模式以隐藏复杂性，并对尝试使用这些数据制作应用程序的开发人员真正有用的内容发表意见

前任：

```
Person = {
name:'Chris McCall',
primary_address:'123 Main St',
secondary_address:null
} 
```

您可以决定是否包含 ID。您可能决定更改字段名称的大小写，并且您可能会将数据投影到对应用程序开发人员更有意义并且比您的数据库架构更稳定的表单中。也许你留下了一堆东西，所以通过网络传输的数据更少。类似的东西。

您的 DBA 的任务是创建一个性能良好的数据库，并通过规范化最大化存储。这是与服务层不同的目标，服务层不期望其调用的结果被持久化。

不同的架构对视图模型有不同的名称（这就是我所说的）。DTO 是另一个名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:44:55.157

> 我们尝试使 WebServices API 尽可能稳定，但是由于我们的数据对象被用作 WebService 方法的参数，因此该 API 可能会经常更改

你已经走错路了。Web 服务是以与平台无关的方式实现互操作性和集成。
传递给 Web 服务的所有对象都应该是“数据持有者”，并且应该与您的业务逻辑无关。您应该有转换器将这些“数据持有者”映射到您的应用程序所需的实际类

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-14T15:24:21.473

回答我自己的问题：

我们显然面临着将结构化数据暴露给公共 API 的问题。这些数据来自内部管理的域模型（数据对象），但域模型不得直接通过公共 API 公开。

相反，必须创建和维护另一组类，通常称为数据传输对象 (DTO) 或视图模型，以用作公共 API 的输入/输出参数。使用这样的 DTO，域模型可以在不修改公共 API 的情况下进行更改，并且公共 API 可以以非常可控的方式进行更改。

某些映射（也称为绑定）必须在应用程序中维护在域模型和 DTO 之间。经常是双向的。可以在[此处找到大量 Java 映射器/绑定器库](https://stackoverflow.com/a/1432956/946487)

# git - 将 git 本地存储库（克隆自）提升为与 git-tf 一起使用的源的最佳方法

> ID：13863962
> 
> 赞同：3
> 
> 时间：2012-12-13T16:16:25.103
> 
> 标签：git, tfs, repository, move, git-tf

我正在使用Git-tf（显然）跳过TFS并能够离线工作并避免只读和所有调整......现在..我开始将tfs项目克隆到让我们说驱动器D：然后我再次克隆从驱动器c：（我想我在那里过度偏执）

我当前的工作流程是将更改（在 repo c:) 提交到 repo D: 然后将签入推送到 TFS

它工作正常，但它变得混乱，我认为我过度复杂化了工作流程

什么是最好的？

我可以将 repo c: 配置为直接指向 TFS ...并删除本机 git origin (repo d:) 将 repo d: 复制到 c: 并继续（我试过了，它在本地工作正常，但我没有提交对 TFS 的任何更改）我可以将 repo c: 提升为 ORIGIN（如 D:），然后继续从那里将更改推送到 TFS（在 git-tf 配置之后）？...不确定这个促销活动...

另外：考虑到项目（如在 C# vs2012 中）它是一个大项目，不是那么直接的重新配置和构建）甚至没有提到等待复制过程:)。还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:38:54.803

您不能将 repo 配置`C:`为直接指向 TFS。Repository`D:`包含有关 git 提交到 TFS 变更集映射的数据，这些映射是在您获取/克隆存储库时创建的。如果没有此数据，`git-tf`则无法在您获取的最后一个变更集和当前提交之间构建增量以创建 TFS 变更集。

复制`D:`到`C:`应该没问题，因为它将复制`git-tf`存储在 git 存储库中的元数据。

我不知道您所说的“推广`C:`到`D:`”是什么意思。如果您`C:`从克隆`D:`，您可以进行更改并将它们推回`D:`然后`git-tf checkin`它们。新的 git 提交来自哪里并不重要，如果您`HEAD`指向的提交是从最新的 TFS 变更集创建的提交的子或孙子提交，则`git-tf`可以构建差异的新变更集。

# jquery - 单击事件处理程序在就绪时触发，但在单击时不触发

> ID：13863965
> 
> 赞同：0
> 
> 时间：2012-12-13T16:16:32.340
> 
> 标签：jquery, onclick

我有一个由 jquery/ajax 添加的按钮，我想在单击时从中获取它的值（数字）。问题是它永远不会触发。如果我即使在 .ready 中也有点击，它会在加载时触发，如果在外面它什么也没发生。

```
$('.page').on("click", function(event){
    alert("clicked");
}

<button class="page">1</button> 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:18:17.947

请尝试：

```
$('body').on("click", ".page", function(event){
    alert("clicked");
} 
```

由于您的元素是动态添加的，因此您需要根据页面加载时存在的元素绑定点击事件。理想情况下，您想要一个在 DOM 中比正文更接近的元素，但在最坏的情况下您可以使用它。

从[文档](http://api.jquery.com/on/)：

> 事件处理程序仅绑定到当前选定的元素；当您的代码调用 .on() 时，它们必须存在于页面上。为确保元素存在并且可以被选择，请在页面 HTML 标记中的元素的文档就绪处理程序内执行事件绑定。如果将新 HTML 注入页面，请在将新 HTML 放入页面后选择元素并附加事件处理程序。

# file - 可运行 JAR：本地路径问题

> ID：13863968
> 
> 赞同：0
> 
> 时间：2012-12-13T16:16:50.297
> 
> 标签：file, jar, path, local, runnable

我想将我的项目导出到可运行的 JAR（在 Eclipse 中）。但是我有一个带有本地路径的代码部分！如何避免本地路径问题？

非常感谢你帮助我。

```
static {
    URL url = null;
    WebServiceException e = null;
    try {
        url = new URL("file:/C:/myWorkspace/myProject/folder/data.wsdl");
    } catch (MalformedURLException ex) {
        e = new WebServiceException(ex);
    }
    APISERVICE_WSDL_LOCATION = url;
    APISERVICE_EXCEPTION = e;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T22:01:09.873

非常简单。使用相对路径 URL。将文件保存在 src/main/resources 目录下并通过以下方式访问始终是一种更好的做法`this.getClass().getResourceAsStream()`

# javascript - 根据触摸事件旋转元素

> ID：13863974
> 
> 赞同：4
> 
> 时间：2012-12-13T16:17:13.740
> 
> 标签：javascript, html, canvas, rotation

我正在寻找一些指导和/或示例来创建一种触摸对象并旋转它的方法。假设我们有一个圆圈的图像，我希望能够触摸一个点，围绕该圆圈拖动并在我的手指移动时操纵它旋转。

我找到了很多关于旋转的教程：

*   [http://www.williammalone.com/briefs/how-to-rotate-html5-canvas-around-center/](http://www.williammalone.com/briefs/how-to-rotate-html5-canvas-around-center/)
*   [http://www.switchonthecode.com/tutorials/html-5-canvas-tutorial-rotation](http://www.switchonthecode.com/tutorials/html-5-canvas-tutorial-rotation)

我只需要合并触摸部分。

任何人以前做过这个或可以阐明一些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-04T12:11:17.380

您可以简单地将触摸的旋转映射到元素的`transform: rotate(Ndeg)`CSS。

并非所有支持触摸的浏览器都提供对象的`rotate`属性`event`，因此您可以通过数学计算得出值。

```
document
.getElementById("some-element")
.addEventListener("touchmove", function(event) {
    var rotation = event.rotation;

    // This isn't a fun browser!
    if ( ! rotation) {
         rotation = Math.arctan2(event.touches[0].pageY - event.touches[1].pageY,
               event.touches[0].pageX - event.touches[1].pageX) * 180 / Math.PI;
    }

    // Take into account vendor prefixes, which I haven't done.
    this.style.transform = "rotate(" + rotation + "deg)":
}); 
```

如果您希望用户能够多次旋转它，您还需要存储先前的旋转值并根据它调整这个值。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-07-12T21:51:52.367

## 在鼠标/触摸拖动时旋转元素

这是一个关于如何*拖动旋转*元素的完整示例：

**存储起始角度**，即坐标处的相对角度减去当前角度。以 mousemove XY 坐标角度从中心减去起始角度
**的差值 (delta) 旋转。**

```
const rotate = (EL) => {

  let ang = 0; // All angles are expressed in radians
  let angStart = 0;
  let isStart = false;

  const angXY = (ev) => {
    const bcr = EL.getBoundingClientRect();
    const radius = bcr.width / 2;
    const { clientX, clientY } = ev.touches ? ev.touches[0] : ev;
    const y = clientY - bcr.top - radius;  // y from center
    const x = clientX - bcr.left - radius; // x from center
    return Math.atan2(y, x);
  };

  const mousedown = (ev) => {
    isStart = true;
    angStart = angXY(ev) - ang;
  };

  const mousemove = (ev) => {
    if (!isStart) return;
    ev.preventDefault();
    ang = angXY(ev) - angStart;
    EL.style.transform = `rotateZ(${ang}rad)`;
  };

  const mouseup = () => {
    isStart = false; 
  };

  EL.addEventListener("mousedown", mousedown);
  document.addEventListener("mousemove", mousemove);
  document.addEventListener("mouseup", mouseup);
};

document.querySelectorAll(".rotate").forEach(rotate);
```

```
.rotate {
  border-radius: 50%;
  width: 180px;
  cursor: ns-resize;
}
```

```
<img class="rotate" src="https://www.gravatar.com/avatar/1771ce957b38fbb7f9bb01f58b89fd3f?s=328&d=identicon&r=PG" alt="Wheel image">
<img class="rotate" src="https://i.stack.imgur.com/qCWYU.jpg?s=328&g=1" alt="Wheel image">
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:36:38.433

您将希望查看在您的 上实现`MouseDown`、`MouseUp`和`MouseMove`事件侦听`canvas`器，因为与触摸屏的“触摸”交互只不过是一种花哨的鼠标移动。

`MouseDown`并且`MouseUp`对于查找用户是否正在拖动非常有用`canvas`。`MouseMove`是您需要放置旋转处理逻辑的地方。剩下的就是实现了：

```
/* Borrowed from http://www.marceloduende.com/blog/?p=25 */
function addCrossBrowseEventListener(myElement, myEvent, myFunction) {  
    if(myElement.addEventListener){  
        myElement.addEventListener(myEvent, myFunction, false);  
        return true;  
    } else {  
        myElement.attachEvent('on'+myEvent, myFunction);  
        return true;  
}

```

`myElement`画布的 DOM 元素在哪里，`myEvent`要为其添加侦听器的事件的名称，以及`myFunction`负责处理事件逻辑的函数的名称。

或者，您可以使用 jQuery 来完成大部分工作，因为它有许多更简洁的事件处理方法。

# c# - C# 强类型数据集 - 将不同的数据表传递给同一个方法（接口？）

> ID：13863975
> 
> 赞同：1
> 
> 时间：2012-12-13T16:17:13.397
> 
> 标签：c#, strongly-typed-dataset, code-duplication

我正在尝试将单独的类型化数据集数据表传递给相同的方法。数据表相似，但不同。该方法对数据表执行相同的功能。有没有一种方法可以按照为数据表创建自定义接口的方式来做一些事情，而不是基本上复制方法并根据数据表类型更改参数类型，这样我就可以拥有一个带有接口参数的方法类型？

我目前拥有的：

```
private PassdownDataset.SalesOrdersForManagerDataTable datatable1;
private PassdownDataset.SalesOrdersDataTable datatable2;

public SomePublicMethod()
{
PopulateDepartmentName(datatable1);
PopulateDepartmentName(datatable2);
}

private void PopulateDepartmentName(PassdownDataset.SalesOrdersForManagerDataTable dt)
{
//(operations performed on datatable)
}

private void PopulateDepartmentName(PassdownDataset.SalesOrdersDataTable dt)
{
//(operations performed on datatable)
} 
```

我想拥有什么：

```
private PassdownDataset.SalesOrdersForManagerDataTable datatable1;
private PassdownDataset.SalesOrdersDataTable datatable2;

public SomePublicMethod()
{
PopulateDepartmentName(datatable1);
PopulateDepartmentName(datatable2);
}

private void PopulateDepartmentName(
               PassdownDataset.CommonInterfaceForBothDataTables dt)
{
//(operations performed on datatable)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T17:27:11.310

我敢肯定，您可以使用继承来解决这个问题。但这可能会变得尴尬和被迫。

我发现 C# 4 中添加的动态特性非常适合此类事情。主要缺点是您失去了静态类型和重构友好性。如果您对动态的使用非常本地化（例如包含在单个辅助方法中），我认为这是可以的。

例如，假设所有数据库实体都有一个`CreateDateTime`字段，并且您想要初始化它的辅助方法。这是一个很好的动态用例。另一种方法是让所有实体都继承一个接口。

# twitter-bootstrap - 防止用户在使用 Bootstrap-datepicker 时选择以前的日期

> ID：13863976
> 
> 赞同：0
> 
> 时间：2012-12-13T16:17:15.430
> 
> 标签：twitter-bootstrap, datepicker

我想阻止用户选择以前的日期，从而在我的日期选择器中禁用以前的日期。我正在使用来自[http://www.eyecon.ro/bootstrap-datepicker](http://www.eyecon.ro/bootstrap-datepicker)的 bootstrap-datepicker 。

我像这样调用了javascript

```
<script>
$(function() {
    $( ".mydatepicker" ).datepicker({
       format:'yyyy/mm/dd'
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T12:56:07.420

不支持日期验证（截至目前），但插件提供了您可以收听的事件：在这种情况下，`changeDate`事件。

```
var minDate = new Date(); // Our minimum

$('.someSelector').datepicker()
.on('changeDate', function(ev){
    if (ev.date.valueOf() < minDate.valueOf()){

        /* Handle previous date */
        alert('Nope');
        // and eventually reset the date

        /* And this for later versions (just in case) */
        ev.preventDefault();
        return false;
    }
}); 
```

这是一个带有工作示例的[演示（jsfiddle） 。](http://jsfiddle.net/Sherbrow/ymp5D/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T04:57:31.493

[我的 Stefan 代码分支](https://github.com/eternicode/bootstrap-datepicker/)支持[startDate](https://github.com/eternicode/bootstrap-datepicker/#startdate)就是为了这样的目的。

# jquery - JQuery将类添加到父对象

> ID：13863979
> 
> 赞同：3
> 
> 时间：2012-12-13T16:17:26.557
> 
> 标签：jquery, addclass

如果其中一个子项具有“活动”类，我正在尝试将“活动”类添加到父列表项。

当前的html：

```
<ul class="top">
  <li class="parent"><a href="#">Link1</a>
    <ul class="drop">
      <li class="active"><a href="#">Link1-1</a></li>
      <li><a href="#">Link1-2</a></li>
      <li><a href="#">Link1-3</a></li>
    </ul>
  </li>
  <li><a href="#">Link2</a></li>
  <li class="parent"><a href="#">Link3</a></li>
</ul> 
```

当前的jQuery：

```
if($('ul.top li ul.drop li').hasClass('active')) {
            $('ul.top li.parent').addClass('active');
    } 
```

​</p>

​</p>

请参阅[http://jsfiddle.net/FmT52/](http://jsfiddle.net/FmT52/)以查看我已经走了多远。

我已经成功完成了一半，但只是使用 Jquery 将“活动”类添加到所有顶级列表项。

与以往一样，我们将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:28:24.313

您可以遍历所有`li's`并将类添加到`closest parent ul`

```
$('ul.top li').each(function(){
    var $this = $(this);
    if($this.hasClass('active')){
        $this.closest('li.parent').addClass('active');
    }        
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/FmT52/9/)** </p>

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T16:32:22.623

试试这个：

```
$('li.active').parent().closest('li.parent').addClass('active'); 
```

签出小提琴：http: **[//jsfiddle.net/FmT52/8/](http://jsfiddle.net/FmT52/8/)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:19:21.510

你可以做更简单的：

```
 $('ul.top li.parent:has(.active)').addClass('active'); 
```

# asp.net - asp经典Math.abs问题

> ID：13863983
> 
> 赞同：-1
> 
> 时间：2012-12-13T16:17:41.890
> 
> 标签：asp.net, math

我在应用程序中有一个“周”变量：

Math.abs(var_weeks / ONE_WEEK);

它返回“37.3857142857143 周”

我怎样才能将此值减少到“37.3 周”？

我只需要在逗号后留下一个数字。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T09:27:39.753

要在逗号后留下一个数字，我做了下一个：

```
 var weeks
   // it returns 5.123123 for example

    var weeksnum = weeks * 10;
   // it returns 51.23123

   var weeksfinal = Math.round(weeksnum)/10;
   // it returns 512/10 - 51.2 
```

# maven - 在Maven中本地引用依赖jar

> ID：13863984
> 
> 赞同：3
> 
> 时间：2012-12-13T16:17:55.030
> 
> 标签：maven, jar

在我的项目中，我使用的是公司的 Maven 存储库中不存在的外部 jar。所以我收到以下错误

```
Could not resolve dependencies for project.Could not find artifact in http://company-name/maven2 
```

有没有什么方法可以在本地引用这个 jar 作为解决方法，直到公司将该 jar 添加到其存储库中。就像我创建 lib 文件夹并将 jar 放在该文件夹中一样。我可以要求 Maven 从该 lib 文件夹中获取 jar，而不是从 Maven 存储库中下载吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T15:10:51.997

最好的方法是重复使用 Google Code 上提供的实用程序[AddJars Maven Plugin 。](https://code.google.com/p/addjars-maven-plugin)从此以后，包含 jar 的最简单方法是将其存储在一个子文件夹中，例如`lib`，位于 Maven 项目中。

然后在你的 pom.xml 中简单地添加：

```
<plugin>
    <groupId>com.googlecode.addjars-maven-plugin</groupId>
    <artifactId>addjars-maven-plugin</artifactId>
    <version>1.0.5</version>
    <executions>
        <execution>
            <goals>
                <goal>add-jars</goal>
            </goals>
            <configuration>
                <resources>
                    <resource>
                        <directory>${project.basedir}/lib</directory>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

这里有更多关于插件配置[的信息](https://code.google.com/p/addjars-maven-plugin/wiki/UsagePage)。特别是在 NetBeans 下需要一些额外的步骤来启用自动完成功能。

不幸的是，这**需要 Maven 版本 3.0.3 或更高版本**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T16:21:08.163

您需要[install:install-file](http://maven.apache.org/plugins/maven-install-plugin/usage.html)，它将 JAR 的副本安装到您​​的本地`.m2/repository`，然后您的 POM 可以依赖该副本。

# wpf - WPF/MVVM：在同一个 DockPanel 中打开不同的用户控件

> ID：13863986
> 
> 赞同：1
> 
> 时间：2012-12-13T16:18:00.890
> 
> 标签：wpf, mvvm, dockpanel

我正在`DockPanel`为我的布局创建一个应用程序。在“左侧”中，`DockPanel`我设置了一些链接（标签），我想`UserControls`在单击链接时使用它们打开不同的链接。我希望在`UserControls`单击相应链接时始终在“右”DockPanel 中打开。

我将使用 WPF（使用 MVVM）中的什么机制来完成此任务？有没有我可以查看的示例？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-13T16:49:29.287

要遵循的一般模式是这样的：

1.  将 a 添加`ContentPresenter`到用户界面中将托管可切换内容的位置（`DockPanel`在您的情况下为右侧面板）。
2.  每个可切换视图的视觉表示将由用户控件表示。
3.  每个可切换视图的数据将由 viewModel 表示。
4.  `Content`将 的属性绑定`ContentPresenter`到视图模型中的属性，该属性是表示视图 EG 的 viewModel 类型`BoundContent`。
5.  单击链接时，您的 viewModel 应通过更改绑定属性并引发`PropertyChanged`事件以通知您的视图来对此做出反应。
6.  对于每个可以切换的“视图”，您需要一个`DataTemplate`将每个用户控件映射到每个视图模型的。

[Rachel Lims](https://stackoverflow.com/users/302677/rachel)博客包含几个示例，这些示例演示了上述内容：

*   [在 WPF/MVVM 中切换视图](http://rachel53461.wordpress.com/2011/05/28/switching-between-viewsusercontrols-using-mvvm/)
*   [使用 MVVM 导航](http://rachel53461.wordpress.com/2011/12/18/navigation-with-mvvm-2/)

# php - 代码点火器图像调整大小

> ID：13863987
> 
> 赞同：4
> 
> 时间：2012-12-13T16:18:07.067
> 
> 标签：php, codeigniter

我在使用 codeigniter 图像调整大小时遇到​​问题。我将文件作为 zip 文件上传，然后解压缩，解压缩后我扫描目录以查找 .jpg。如果它是 .jpg 扩展名，则需要调整大小。它在 zip 文件只有一个 .jpg 图像时工作，但当 zip 文件有 2 个 .jpg 图像文件时它不起作用。

它确实扫描了所有 jpg 文件，问题是它没有调整大小。

我想在上传 zip 文件时调整所有 jpg 文件的大小。

这是我的代码：

```
$images = scandir('uploads/new');
//print_r($images);
foreach($images as $image){
    $last = substr($image, -3);
    if($last == 'jpg'){
        $image_path = './uploads/new/'.$image;

        //$config['image_library'] = 'gd2';
        $config['source_image'] = $image_path;
        $config['maintain_ratio'] = TRUE;
        $config['width'] = 100;
        $config['height'] = 100;

        $this->load->library('image_lib', $config);

        $this->image_lib->resize(); 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T16:32:30.117

你应该使用**$this->image_lib->clear();**

clear 函数重置处理图像时使用的所有值。如果您正在循环处理图像，您将需要调用它。

$this->image_lib->clear();

来自：[http ://ellislab.com/codeigniter/user-guide/libraries/image_lib.html](http://ellislab.com/codeigniter/user-guide/libraries/image_lib.html)

还有一个提示：

无需使用字符串函数来获取文件扩展名。您可以使用实际为您想要的东西设计的东西：**pathinfo()：**

```
$ext = pathinfo($image, PATHINFO_EXTENSION); 
```

在你的情况下：

```
if(pathinfo($image, PATHINFO_EXTENSION) == 'jpg'){ 
```

这样，如果您要添加超过 3 个字母的扩展名，它将起作用；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:29:46.780

尝试在 foreach 循环中清除您的配置

```
$images = scandir('uploads/new');
//print_r($images);
foreach($images as $image){
    $this->image_lib->clear(); // clear previous config
    $last = substr($image, -3);
    if($last == 'jpg'){
        $image_path = './uploads/new/'.$image;

        //$config['image_library'] = 'gd2';
        $config['source_image'] = $image_path;
        $config['maintain_ratio'] = TRUE;
        $config['width'] = 100;
        $config['height'] = 100;

        $this->load->library('image_lib', $config);

        $this->image_lib->resize(); 
    }
} 
```

# mysql - 即使在修改 php.ini 之后，upload_max_filesize 也不会改变

> ID：13863988
> 
> 赞同：1
> 
> 时间：2012-12-13T16:18:07.397
> 
> 标签：mysql, file-upload, upload, phpmyadmin

也许这个问题是由于我使用的版本引起的： **PHP Version 5.3.3-1ubuntu9.10**

我只是想通过 PHPMyAdmin 上传更大的文件。在我的 PHPINFO 页面中，它显示`upload_max_filesize = 2M`. 我已更改`/etc/php5/apache2/php.ini`为`upload_max_filesize = 100M`，但即使在服务器重新启动后，仍然看不到 PHPINFO 页面中的更改。

有没有我可以运行的 MYSQL 查询来更新它？我没有寻找它的 .htaccess 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T16:20:40.550

该行应为：

```
upload_max_filesize = 200M 
```

不是

```
upload_max_filesize: 200M 
```

另外，你需要设置`post_max_size`一个合适的级别——大于`upload_max_filesize`

# linq - 使用 Collections Linq 从属性中过滤集合

> ID：13863991
> 
> 赞同：0
> 
> 时间：2012-12-13T16:18:14.607
> 
> 标签：linq

我有一个名为 MyConnection 的对象，其属性为 List 类型的 Sources 我无法编写 linq 代码来查找 List 中连接的 Source 为“”的所有 MyConnections。

我试过这个，但它似乎没有运行..

```
MyConnection initialActivity = currentActivities.ToList().Where(x => x.Sources.Contains(String.Empty)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T16:26:02.340

`Where`返回一个`IEnumerable<MyConnection>`not a `MyConnection`。因此，您可以在 a 中枚举所有内容`foreach`或将 fe 与`First`.

```
IEnumerable<MyConnection> allWithEmptySource = currentActivities
    .Where(con => con.Sources.Any(s => string.IsNullOrEmpty(s)));
if(allWithEmptySource.Any())
{
    MyConnection first = allWithEmptySource.First();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-13T16:20:41.893

`.Where()`返回匹配元素的*序列*。

您不能将其分配给 type 的变量`MyConnection`。

相反，您可以调用方法`.Last()`来获取单个元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-13T16:23:02.410

如果您只是想获得*一个*具有“”来源的活动，而不是*所有*活动，请使用

```
MyConnection initialActivity = currentActivities.ToList()
    .FirstOrDefault(x => x.Sources.Contains(String.Empty)); 
```

如果没有这样的活动，它会给你`null`，如果有一个或多个，那就是第一个。

或者[`FirstOrDefault`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.firstordefault.aspx)，使用：

*   [`First`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.first.aspx)给你第一个但如果没有则抛出异常
*   [`Single`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.single.aspx)给你一个匹配并抛出一个异常，有 0 或 >1 个匹配
*   [`SingleOrDefault`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.singleordefault.aspx)给你一个匹配或不匹配，如果有>1个匹配，则抛出异常。

如果你想要*所有*这些，你的返回类型将是一个`IEnumerable<MyConnection>`，而不是一个：

```
IEnumerable<MyConnection> initialActivities = = currentActivities.ToList()
    .Where(x => x.Sources.Contains(String.Empty)); 
```

然后，您可以`foreach`在此之上，或调用`ToList`或`ToArray`在其上获取列表或数组。

NB 你可能*不需要*`.ToList()`在你的线路*中间*打电话。

# c++ - X 请求失败错误：GLXBadFBConfig

> ID：13863996
> 
> 赞同：16
> 
> 时间：2012-12-13T16:18:27.320
> 
> 标签：c++, opengl, glut

我正在尝试按照*“交互式计算机图形使用基于着色器的 OPENGL® 的自上而下的方法”*第 6 版中的说明进行 Sierpinski 垫圈。

我有这个代码

谢尔宾斯基.cpp

```
#include <GL/glew.h>
#include <GL/glut.h>
#include <glm/glm.hpp>
#include "Angel.h"
#include <iostream>
#include <vector>
#include <cmath>
#define NUM_PUNTOS 4
#define DIVISIONES 5

namespace Global
{
    GLint Ndivisions = DIVISIONES;
    GLint Nvertices = (GLint) std::pow(3,Ndivisions + 1);
    std::vector<glm::vec2> points;

};

void display(void);
void init();
//void idle(void);
void triangle(glm::vec2,glm::vec2,glm::vec2,std::vector<glm::vec2> &);
void divide_triangle(glm::vec2,glm::vec2,glm::vec2,GLint,std::vector<glm::vec2> &);
inline glm::vec2 dividir(glm::vec2,double);
glm::vec2 dividir(glm::vec2,double);   

int main(int argc, char **argv)
{
    glutInit(&argc,argv);
    glutInitDisplayMode(GLUT_RGBA);
    glutInitWindowSize(800,600);
    glutInitContextVersion(3,2);
    glutInitContextProfile(GLUT_CORE_PROFILE);
    //IMPORTANTE: CREAR ANTES QUE LOS CALLBACKS
    glutCreateWindow("Sierpinski gasket");    //Init
    glewInit();//IMPORTANTÍSIMO
    init();    
    glutDisplayFunc(display);
    #ifdef LIBGL_DEBUG
    std::cout<<LIBGL_DEBUG<<'\n';
    #endif

    //Despues de todo es que se crea la ventana
    glutMainLoop();    

}
void display(void)
{
    glClear(GL_COLOR_BUFFER_BIT);
    glDrawArrays(GL_POINTS, 0, Global::Nvertices);
    glFlush();
}
void init()
{
    //Inicializamos array global
    divide_triangle(glm::vec2(0.0,0.0),glm::vec2(1.0,0.0),glm::vec2(0.5,1.0),Global::Ndivisions,Global::points);
    glm::vec2 *points = &Global::points[0];
    GLuint vao,program;
    program = Angel::InitShader("shaders/Sierpinski.vertex.glsl",
            "shaders/Sierpinski.fragment.glsl");
    glUseProgram(program);

    for(int x = 0; x<Global::points.size();x++)
        std::cout<<"X: "<<points[x].x<<" Y: "<<points[x].y<<"\n";

    glGenVertexArrays(1, &vao);
    glBindVertexArray(vao);
    //Buffers
    GLuint buffer;
    glGenBuffers(1, &buffer);
    std::cout<<"Primer test\n";
    glBindBuffer(GL_ARRAY_BUFFER, buffer);
    glBufferData(GL_ARRAY_BUFFER,sizeof(points),
            points,GL_STATIC_DRAW);
    //glGenVertexArrays(1, &buffer);
    //glBindVertexArray(buffer);
    std::cout<<buffer<<'\n';
    // Initialize the vertex position attribute from the vertex shader
    GLuint loc = glGetAttribLocation( program, "vPosition" );
    glEnableVertexAttribArray( loc );
    glVertexAttribPointer( loc, 2, GL_FLOAT, GL_FALSE, 0,
            BUFFER_OFFSET(0) );

}
void triangle(glm::vec2 a,glm::vec2 b,glm::vec2 c,std::vector<glm::vec2> &points)
{
    size_t old_size = points.size();
    points.resize(old_size + 3);
    points[old_size] = a;
    points[old_size + 1] = b;
    points[old_size + 2] = c;
    //std::cout<<"Finalizado\n";
}

void divide_triangle(glm::vec2 a,glm::vec2 b,glm::vec2 c,GLint k,std::vector<glm::vec2> &points)
{
    if(k>0)
    {
        glm::vec2 ab = dividir(a + b,2.0);
        glm::vec2 ac = dividir(a + c,2.0);
        glm::vec2 bc = dividir(b + c,2.0);

        //Dividimos triángulo
        int new_k = k - 1;
        divide_triangle(a,ab,ac,new_k,points);
        divide_triangle(c,ac,bc,new_k,points);
        divide_triangle(b,bc,ab,new_k,points);
    }
    else
    {
        triangle(a,b,c,points);
    }
}

glm::vec2 dividir(glm::vec2 vectorcito,double escalar)
{
    return glm::vec2(vectorcito.x/escalar,vectorcito.y/escalar);
}
//void idle(void){} 
```

天使.h

```
//////////////////////////////////////////////////////////////////////////////
//
//  --- Angel.h ---
//
//   The main header file for all examples from Angel 6th Edition
//
//////////////////////////////////////////////////////////////////////////////

#ifndef __ANGEL_H__
#define __ANGEL_H__

//----------------------------------------------------------------------------
// 
// --- Include system headers ---
//

#include <cmath>
#include <iostream>

//  Define M_PI in the case it's not defined in the math header file
#ifndef M_PI
#  define M_PI  3.14159265358979323846
#endif

//----------------------------------------------------------------------------
//
// --- Include OpenGL header files and helpers ---
//
//   The location of these files vary by operating system.  We've included
//     copies of open-soruce project headers in the "GL" directory local
//     this this "include" directory.
//

#ifdef __APPLE__  // include Mac OS X verions of headers
#  include <OpenGL/OpenGL.h>
#  include <GLUT/glut.h>
#else // non-Mac OS X operating systems
#  include <GL/glew.h>
#  include <GL/freeglut.h>
#  include <GL/freeglut_ext.h>
#endif  // __APPLE__

// Define a helpful macro for handling offsets into buffer objects
#define BUFFER_OFFSET( offset )   ((GLvoid*) (offset))

//----------------------------------------------------------------------------
//
//  --- Include our class libraries and constants ---
//

namespace Angel {

//  Helper function to load vertex and fragment shader files
GLuint InitShader( const char* vertexShaderFile,
           const char* fragmentShaderFile );

//  Defined constant for when numbers are too small to be used in the
//    denominator of a division operation.  This is only used if the
//    DEBUG macro is defined.
const GLfloat  DivideByZeroTolerance = GLfloat(1.0e-07);

//  Degrees-to-radians constant 
const GLfloat  DegreesToRadians = M_PI / 180.0;

}  // namespace Angel

/*#include "vec.h"
#include "mat.h"
#include "CheckError.h"*/

#define Print(x)  do { std::cerr << #x " = " << (x) << std::endl; } while(0)

//  Globally use our namespace in our example programs.
//using namespace Angel;

namespace Angel {

// Create a NULL-terminated string by reading the provided file
static char*
readShaderSource(const char* shaderFile)
{
    FILE* fp = fopen(shaderFile, "r");

    if ( fp == NULL ) { return NULL; }

    fseek(fp, 0L, SEEK_END);
    long size = ftell(fp);

    fseek(fp, 0L, SEEK_SET);
    char* buf = new char[size + 1];
    fread(buf, 1, size, fp);

    buf[size] = '\0';
    fclose(fp);

    return buf;
}

// Create a GLSL program object from vertex and fragment shader files
GLuint
InitShader(const char* vShaderFile, const char* fShaderFile)
{
    struct Shader {
    const char*  filename;
    GLenum       type;
    GLchar*      source;
    }  shaders[2] = {
    { vShaderFile, GL_VERTEX_SHADER, NULL },
    { fShaderFile, GL_FRAGMENT_SHADER, NULL }
    };

    GLuint program = glCreateProgram();

    for ( int i = 0; i < 2; ++i ) {
    Shader& s = shaders[i];
    s.source = readShaderSource( s.filename );
    if ( shaders[i].source == NULL ) {
        std::cerr << "Failed to read " << s.filename << std::endl;
        exit( EXIT_FAILURE );
    }

    GLuint shader = glCreateShader( s.type );
    glShaderSource( shader, 1, (const GLchar**) &s.source, NULL );
    glCompileShader( shader );

    GLint  compiled;
    glGetShaderiv( shader, GL_COMPILE_STATUS, &compiled );
    if ( !compiled ) {
        std::cerr << s.filename << " failed to compile:" << std::endl;
        GLint  logSize;
        glGetShaderiv( shader, GL_INFO_LOG_LENGTH, &logSize );
        char* logMsg = new char[logSize];
        glGetShaderInfoLog( shader, logSize, NULL, logMsg );
        std::cerr << logMsg << std::endl;
        delete [] logMsg;

        exit( EXIT_FAILURE );
    }

    delete [] s.source;

    glAttachShader( program, shader );
    }

    /* link  and error check */
    glLinkProgram(program);

    GLint  linked;
    glGetProgramiv( program, GL_LINK_STATUS, &linked );
    if ( !linked ) {
    std::cerr << "Shader program failed to link" << std::endl;
    GLint  logSize;
    glGetProgramiv( program, GL_INFO_LOG_LENGTH, &logSize);
    char* logMsg = new char[logSize];
    glGetProgramInfoLog( program, logSize, NULL, logMsg );
    std::cerr << logMsg << std::endl;
    delete [] logMsg;

    exit( EXIT_FAILURE );
    }

    /* use program object */
    glUseProgram(program);

    return program;
}

}  // Close namespace Angel block

#endif // __ANGEL_H__ 
```

我使用以下命令编译它

```
g++ Sierpinski.cpp -I. -lGL -lglut -lGLU -lGLEW -g -o Sierpinski.out 
```

当我运行它时，会出现以下内容：

```
[asdrubal@localhost tests]$ ./Sierpinski.out 
libGL error: failed to load driver: i965
libGL error: Try again with LIBGL_DEBUG=verbose for more details.
libGL error: failed to load driver: swrast
libGL error: Try again with LIBGL_DEBUG=verbose for more details.
X Error of failed request:  GLXBadFBConfig
  Major opcode of failed request:  154 (GLX)
  Minor opcode of failed request:  34 ()
  Serial number of failed request:  39
  Current serial number in output stream:  38 
```

有什么建议么？

PS：我现在正在使用

```
3.6.9-1-ARCH (Arch Linux) 
```

**编辑1：**

**着色器**

谢尔宾斯基片段变种glsl

```
void main()
{
    gl_FragColor = vec4(0.0,1.0,0.0,1.0);
} 
```

谢尔宾斯基变种glsl

```
#version 120
attribute vec4 vPosition; /*Si se quieren setear variables*/
void main()
{

  gl_Position = vPosition;

} 
```

使用 LIBGL_DEBUG=verbose 输出

```
[asdrubal@localhost tests]$ ./Sierpinski.out 
libGL: OpenDriver: trying /usr/lib32/dri/tls/i965_dri.so
libGL: OpenDriver: trying /usr/lib32/dri/i965_dri.so
libGL error: dlopen /usr/lib32/dri/i965_dri.so failed (/usr/lib32/dri/i965_dri.so: cannot open shared object file: No such file or directory)
libGL error: unable to load driver: i965_dri.so
libGL error: driver pointer missing
libGL error: failed to load driver: i965
libGL: OpenDriver: trying /usr/lib32/dri/tls/swrast_dri.so
libGL: OpenDriver: trying /usr/lib32/dri/swrast_dri.so
libGL error: dlopen /usr/lib32/dri/swrast_dri.so failed (/usr/lib32/dri/swrast_dri.so: cannot open shared object file: No such file or directory)
libGL error: unable to load driver: swrast_dri.so
libGL error: failed to load driver: swrast
X Error of failed request:  GLXBadFBConfig
  Major opcode of failed request:  154 (GLX)
  Minor opcode of failed request:  34 ()
  Serial number of failed request:  39
  Current serial number in output stream:  38 
```

编辑2：

命令：

```
lspci | grep VGA 
```

退货

```
00:02.0 VGA compatible controller: Intel Corporation Mobile GM965/GL960 Integrated Graphics Controller (primary) (rev 03) 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-13T16:29:37.213

```
Intel Corporation Mobile GM965/GL960 
```

您正在运行第四代英特尔芯片，因此：

```
glutInitContextVersion(3,2); 
```

是相当...[乐观](http://en.wikipedia.org/wiki/Comparison_of_Intel_graphics_processing_units#Fourth_generation)。

除非你*想要*软件渲染，在这种情况下你必须等待一段时间让 Mesa 升级到[OpenGL 3.2](http://cgit.freedesktop.org/mesa/mesa/tree/docs/GL3.txt)。

**编辑：**试试这个：

```
#include <GL/glew.h>
#include <GL/glut.h>
#include <glm/glm.hpp>
#include <iostream>
#include <vector>
#include <cmath>
#include <stdexcept>

using namespace std;

// vertex shader
const GLchar* vert =
"#version 120\n"
"attribute vec2 position;"
"void main()"
"{"
"   gl_Position = vec4( position, 0.0, 1.0 );"
"}"
;

// fragment shader
const GLchar* frag = 
"#version 120\n"
"void main()"
"{"
"    gl_FragColor = vec4( 0.0, 1.0, 0.0, 1.0 );"
"}"
;

const unsigned int NUM_PUNTOS = 4;
const unsigned int DIVISIONES = 5;

namespace Global
{
    GLint Ndivisions = DIVISIONES;
    GLint Nvertices = (GLint) std::pow(3.0,Ndivisions + 1);
    std::vector<glm::vec2> points;
};

void triangle( glm::vec2 a, glm::vec2 b, glm::vec2 c, std::vector<glm::vec2> &points )
{
    size_t old_size = points.size();
    points.resize(old_size + 3);
    points[old_size] = a;
    points[old_size + 1] = b;
    points[old_size + 2] = c;
}

glm::vec2 dividir( glm::vec2 vectorcito, double escalar )
{
    return glm::vec2(vectorcito.x/escalar,vectorcito.y/escalar);
}

void divide_triangle( glm::vec2 a, glm::vec2 b, glm::vec2 c, GLint k, std::vector<glm::vec2> &points )
{
    if(k>0)
    {
        glm::vec2 ab = dividir(a + b,2.0);
        glm::vec2 ac = dividir(a + c,2.0);
        glm::vec2 bc = dividir(b + c,2.0);

        //Dividimos triángulo
        int new_k = k - 1;
        divide_triangle(a,ab,ac,new_k,points);
        divide_triangle(c,ac,bc,new_k,points);
        divide_triangle(b,bc,ab,new_k,points);
    }
    else
    {
        triangle(a,b,c,points);
    }
}

void CheckStatus( const GLenum id )
{
    GLint status = GL_FALSE, loglen = 10;
    if( glIsShader(id) )    glGetShaderiv( id, GL_COMPILE_STATUS, &status ); 
    if( glIsProgram(id) )   glGetProgramiv( id, GL_LINK_STATUS, &status );
    if( GL_TRUE == status ) return;
    if( glIsShader(id) )    glGetShaderiv( id, GL_INFO_LOG_LENGTH , &loglen);
    if( glIsProgram(id) )   glGetProgramiv( id, GL_INFO_LOG_LENGTH , &loglen);
    vector< char > log( loglen, 'E' );
    if( glIsShader(id) )    glGetShaderInfoLog( id, loglen, NULL, &log[0] );
    if( glIsProgram(id) )   glGetProgramInfoLog( id, loglen, NULL, &log[0] );
    throw logic_error( string( log.begin(), log.end() ) ); 
}

GLuint CreateShader( const GLenum aType, const string& aSource )
{
    GLuint shader = glCreateShader( aType );
    const GLchar* shaderString = aSource.c_str();
    glShaderSource( shader, 1, &shaderString, NULL );
    glCompileShader( shader );
    CheckStatus( shader );
    return shader;
}

GLuint CreateProgram( const string& aVertexShader, const string& aFragmentShader )
{
    GLuint vert = CreateShader( GL_VERTEX_SHADER, aVertexShader );
    GLuint frag = CreateShader( GL_FRAGMENT_SHADER, aFragmentShader );
    GLuint program = glCreateProgram();
    glAttachShader( program, vert );
    glAttachShader( program, frag );
    glLinkProgram( program );
    glDeleteShader( vert );
    glDeleteShader( frag );
    CheckStatus( program );
    return program;
}

GLuint prog = 0;
GLuint vbo = 0;
void init()
{
    GLenum glewError = glewInit();
    if( GLEW_OK != glewError )
        throw runtime_error( (char*)glewGetErrorString(glewError) );

    cout << "GL_VERSION   : " << glGetString(GL_VERSION) << endl;
    cout << "GL_VENDOR    : " << glGetString(GL_VENDOR) << endl;
    cout << "GL_RENDERER  : " << glGetString(GL_RENDERER) << endl;    
    cout << "GLEW_VERSION : " << glewGetString(GLEW_VERSION) << endl;
    cout << "GLSL VERSION : " << glGetString(GL_SHADING_LANGUAGE_VERSION) << endl;

    if( !GLEW_VERSION_2_1 )
        throw runtime_error( "OpenGL 2.1 or better required for GLSL support." ); 

    // load shaders
    prog = CreateProgram( vert, frag );

    //Inicializamos array global
    divide_triangle
        (
        glm::vec2(0.0,0.0),
        glm::vec2(1.0,0.0),
        glm::vec2(0.5,1.0),
        Global::Ndivisions,
        Global::points
        );

    // create/fill VBO
    glGenBuffers( 1, &vbo );
    glBindBuffer( GL_ARRAY_BUFFER, vbo );
    unsigned int numBytes = sizeof( glm::vec2 ) * Global::points.size();
    glBufferData( GL_ARRAY_BUFFER, numBytes, &Global::points[0].x, GL_STATIC_DRAW );
}

void display(void)
{
    glClear( GL_COLOR_BUFFER_BIT );

    glUseProgram( prog );

    GLint position_loc = glGetAttribLocation( prog, "position" );
    glBindBuffer( GL_ARRAY_BUFFER, vbo );
    glVertexAttribPointer( position_loc, 2, GL_FLOAT, GL_FALSE, sizeof( glm::vec2 ), 0 );
    glEnableVertexAttribArray( position_loc );

    glDrawArrays( GL_POINTS, 0, Global::points.size() );

    glDisableVertexAttribArray( position_loc );

    glutSwapBuffers();
}

int main(int argc, char **argv)
{
    glutInit( &argc, argv );
    glutInitWindowSize( 800,600 );
    glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );
    glutCreateWindow( "Sierpinski gasket" );
    init();
    glutDisplayFunc( display );
    glutMainLoop();
    return 0;
} 
```

[![截屏](../Images/ad45fbe73b18098ba659dc5f2804df3a.png)](https://i.stack.imgur.com/XsHj3.png)

# hinstance - 使用 HINSTANCE 将 Win32 应用程序重写为 Win32 控制台应用程序

> ID：13863999
> 
> 赞同：2
> 
> 时间：2012-12-13T16:18:37.843
> 
> 标签：hinstance

我有一个使用 HINSTANCE 的 win32 应用程序。这是main.cpp：

```
#include "stdafx.h"
#include "testlib.c"

int APIENTRY WinMain(HINSTANCE hInstance,
                 HINSTANCE hPrevInstance,
                 LPSTR     lpCmdLine,
                 int       nCmdShow)
{   
LoadTestLibrary(); 
    // etc....
} 
```

testlib.c 看起来像这样：

```
HINSTANCE TESTLIB=NULL;

long LoadTestLibrary()
{
    TESTLIB=LoadLibrary("TESTLIB.DLL");
    if(TESTLIB == NULL)
{
MessageBox(NULL, "Unable to load TESTLIB.DLL", "ERROR", MB_OK);
    return(-1);
}
else
{
    // do some stuff...
} 
```

我想要的是在 win32 控制台应用程序中重写代码。所有输出都将被回显而不是消息框。我想要一个控制台应用程序的原因是因为我需要用 mono 编译它并在 linux 服务器上使用它。