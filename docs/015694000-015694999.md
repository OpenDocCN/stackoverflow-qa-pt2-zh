# StackOverflow 问答 15694000-15694999

# java - java.net.BindException：绑定失败：EADDRINUSE

> ID：15694002
> 
> 赞同：4
> 
> 时间：2013-03-28T23:34:37.463
> 
> 标签：java, android, sockets, serversocket

我是 android 新手，我正在尝试创建一个服务器套接字。代码如下。

我不断收到警告。可以修吗？我可以忽略它吗？

```
03-28 15:47:34.460: W/System.err(3185): java.net.BindException: bind failed: EADDRINUSE (Address already in use)

03-28 15:47:34.460: W/System.err(3185):     at libcore.io.IoBridge.bind(IoBridge.java:89)

03-28 15:47:34.460: W/System.err(3185):     at java.net.PlainSocketImpl.bind(PlainSocketImpl.java:150)

03-28 15:47:34.460: W/System.err(3185):     at java.net.ServerSocket.<init>(ServerSocket.java:100)

03-28 15:47:34.470: W/System.err(3185):     at java.net.ServerSocket.<init>(ServerSocket.java:69)

03-28 15:47:34.470: W/System.err(3185):     at <path>$server.run(<filename>.java:302)

03-28 15:47:34.470: W/System.err(3185):     at java.lang.Thread.run(Thread.java:856)
03-28 15:47:34.470: W/System.err(3185): Caused by: libcore.io.ErrnoException: bind failed: EADDRINUSE (Address already in use)

03-28 15:47:34.470: W/System.err(3185):     at libcore.io.Posix.bind(Native Method)
03-28 15:47:34.470: W/System.err(3185):     at ibcore.io.ForwardingOs.bind(ForwardingOs.java:39)
03-28 15:47:34.470: W/System.err(3185):     at libcore.io.IoBridge.bind(IoBridge.java:87)
03-28 15:47:34.470: W/System.err(3185):     ... 5 more

03-28 15:47:34.470: W/System.err(3185): java.lang.NullPointerException
03-28 15:47:34.490: W/System.err(3185):     at <path>Provider$server.run(<filename>.java:315)

03-28 15:47:34.490: W/System.err(3185):     at java.lang.Thread.run(Thread.java:856) 
```

代码：

```
class server implements Runnable {

        public void run() {

        ServerSocket serverSocket = null;
            try {
                serverSocket = new ServerSocket(10000);
            } catch (IOException e2) {
                // TODO Auto-generated catch block
                e2.printStackTrace();
            }
            //  Log.d("Recieving ", "Server Socket Created");

            try {
                while(true) {
                    // Blocks until a connection occurs:
                    try {

                Socket client = serverSocket.accept();
                        //Log.d("Recieving ", "Client request accepted");
                        str_proc tk = new str_proc(client);
                        tk.start();

                    } catch (IOException e1) {

                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                        Log.d("Recieving ", "Problem creating socket for listening");

                    }
                }//while true loop ends

            }catch (Exception e){
                e.printStackTrace();
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:47:42.403

您的异常处理非常出色。

创建之后的 catch`ServerSocket`根本不应该存在：它应该在使用 的代码之后`ServerSocket`，在这种情况下，它可以与现有的第二个 catch 结合使用。依赖于前一个`try`块中代码成功的代码应该在该`try`块内。

但是，连续出现该错误的唯一方法是连续启动线程，这无论如何都没有意义，因为在任何给定的 TCP 端口上只能有一个侦听器。

所以调查你为什么一遍又一遍地启动线程，然后停止它，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-25T17:29:23.953

你可以从另一个线程调用[close() ，accept() 调用会抛出一个 SocketException。](http://docs.oracle.com/javase/7/docs/api/java/net/ServerSocket.html#close%28%29)这样，在下一次调用 ServerSocket 构造函数时，您将不会得到“ [java.net.BindException](http://docs.oracle.com/javase/7/docs/api/java/net/BindException.html) : bind failed: EADDRINUSE”。

**activity_main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"`enter code here`
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context="project.vasile.emanuel.gresanu.test_server_socket.MainActivity">

<Button
    android:id="@+id/btn"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Click"/>
</RelativeLayout> 
```

**主要活动**

```
public class MainActivity extends AppCompatActivity {

    private static final String TAG=MainActivity.class.getSimpleName();
    private static boolean isClick;
    private My_Server My_Server;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button btn=(Button) findViewById(R.id.btn);
        isClick=false;
        btn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                 if(!isClick)
                 {
                     Log.i(TAG,"Initilize and Running My_Server");
                     My_Server =new My_Server();
                     if(Build.VERSION.SDK_INT>= Build.VERSION_CODES.HONEYCOMB)
                     {
                         My_Server.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR,(Void[])null);
                     }
                     else
                     {
                         My_Server.execute((Void[])null);
                     }
                     isClick=true;
                 }
                else
                 {
                    if(null!= My_Server)
                    {
                        My_Server.cancelAccept();
                        isClick=false;
                    }
                 }
            }
        });
    }
} 
```

**我的服务器**

```
public class My_Server extends AsyncTask<Void, Void, Void> {

    private static final String TAG = My_Server.class.getSimpleName();
    private static final int PORT = 8091;
    private static boolean isExiting;
    private ServerSocket serverSocket;

    @Override
    protected Void doInBackground(Void... params) {
        isExiting = false;
        try {
            serverSocket = new ServerSocket(PORT);
        } catch (IOException e) {
            e.printStackTrace();
        }
        Socket clientSocket=null;
        if(null!=serverSocket)
        while (!isExiting) {
            try {
                Log.i(TAG, "Waiting for a new connection");
                clientSocket=serverSocket.accept();
                Log.i(TAG, "Connction accepted");
                //Do something with the new client
            } catch (Exception e) {
                e.printStackTrace();
                Log.e(TAG, e.getMessage());
                if(null!=this.serverSocket&& !serverSocket.isClosed()) {
                    try {
                        Log.i(TAG,"Closing Server connection");
                        this.serverSocket.close();
                    } catch (IOException e2) {
                        e2.printStackTrace();
                    }
                }
            }
        }
        try {
            Log.i(TAG,"Closing the connection");
            if(null!=serverSocket && !serverSocket.isClosed()) {
                serverSocket.close();
            }
        } catch (IOException e) {
            e.printStackTrace();
            Log.e(TAG,e.getMessage());
        }
        return null;
    }

    public void cancelAccept() {
        Log.i(TAG, "cancelAccept()");
        isExiting = true;
        if(null!=this.serverSocket&& !serverSocket.isClosed())
        {
            try {
                Log.i(TAG,"Closing Server connection in onCancelled");
                this.serverSocket.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
        System.gc();
    }
} 
```

# insert - 列表为空时插入子节点（XForms）

> ID：15694009
> 
> 赞同：0
> 
> 时间：2013-03-28T23:35:15.197
> 
> 标签：insert, xforms

我的问题如下：

我通常有这些数据：

```
<structures>
    <structure id="10">
      <code>XXX</code>
    </structure>
</structures> 
```

所以我显示的表格（单列：代码）没问题。

但在某些情况下，数据是没有内容的查询结果，所以数据是：

```
 <structures/> 
```

导致我的表格不显示 + 错误。

我试图在空实例的情况下插入单个节点，以便数据看起来像：

```
<structures>
    <structure id="0"/>
</structures> 
```

我正在尝试这样的事情：

```
<xforms:action ev:event="xforms-submit-done">
    <xforms:insert if="0 = count(instance('{./instance-name}')/root/node())" context="instance('{./instance-name}')/root/node()" origin="xforms:element('structure', '')" /> 
</xforms:action> 
```

但是当我在页面的检查器中查看数据时没有插入节点。

有什么明显的我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T17:57:08.340

`if`您的 XPath和`context`表达式中似乎存在错误：

```
if="0 = count(instance('{./instance-name}')/root/node())"
context="instance('{./instance-name}')/root/node()" 
```

您是使用大括号`{`和`}`，我假设具有属性值模板 (AVT) 的行为。但是`if`and`context`表达式已经是 XPath 表达式，因此您不能在其中使用 AVT。请尝试：

```
if="0 = count(instance(instance-name)/root/node())"
context="instance(instance-name)/root/node()" 
```

此外，`instance-name`路径相对于在读取或写入表达式时可能不清楚的内容。例如，我建议使用绝对路径`instance('foo')/instance-name`来使事情更清晰。

您没有提供其他实例的结构，所以我可以肯定地说，但是您会在上面的表达式中假设它们具有以下形式：

```
<xf:instance id="foo">
    <some-root-element>
        <root>
            <structure/>
        </root>
    <some-root-element>
</xf:instance> 
```

我不知道这是否是你的意图。

最后，您可以将`count(something) = 0`,替换为`empty(something)`。

# breeze - 使用 EF 5 和调用存储过程的微风错误

> ID：15694013
> 
> 赞同：0
> 
> 时间：2013-03-28T23:35:23.767
> 
> 标签：breeze

在尝试提取某些数据时，使用微风获取错误客户端：“无法调用未定义的方法 'map'”。此操作与有效操作之间的区别在于，此操作调用存储过程并返回`ObjectResult<T>`而不是`DbSet<T>`.

这可能是我收到错误的原因吗？使用 Chrome 开发人员工具，我确实看到微风控制器正在返回 json 数据。

我在 edmx 中创建了一个复杂的模型类型，用于映射从存储过程返回的行。

微风控制器中的动作有一个返回类型`IEnumerable<T>`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-16T21:09:14.883

我在使用 EF 复杂类型时遇到了同样的错误。一种解决方法是在我的数据库中创建一个视图而不是使用复杂类型，将存储过程设置为返回具有主键的新视图的类型，然后它就可以工作了。似乎微风要求实体定义一个主键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:15:40.717

嗯...不太确定发生了什么，所以只是在这里猜测，但尝试将 AsQueryable() 添加到返回的结果中，并将结果类型更改为 IQueryable。

我们还没有任何微风的存储过程测试，但这促使我添加一些:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T18:48:47.977

我遇到了同样的问题，但感谢上帝，我找到了解决方案。您应该使用视图而不是使用存储过程，因为 Breeze 将视图识别为`DbSet<T>`，就像表一样。假设您有一个 SQL Server 表，其中包含两个表 Customers 和 Orders。

```
Customers (**CustomerId**, FirstName, LastName)
Orders (OrderId, #CustomerId, OrderDate, OrderTotal) 
```

现在，假设您想要一个按 CustomerId 返回订单的查询。通常，您会在存储过程中执行此操作，但正如我所说，您需要使用视图来代替。因此查询在视图中将如下所示。

```
Select o.OrderId, c.CustomerId, o.OrderDate, o.OrderTotal
from dbo.Orders o inner join dbo.Customers c on c.CustomerId = o.CustomerId 
```

请注意，没有过滤（其中...）。所以：

一世。创建一个包含过滤键的 [general] 视图并将其命名，例如`OrdersByCustomers`

ii. 将 OrdersByCustomers 视图添加到 VS 项目中的实体模型中

iii. 将实体添加到 Breeze 控制器，如下所示：

```
public IQueryable<OrdersByCustomers> OrdersByCustomerId(int id)  
{
    return _contextProvider.Context.OrdersByCustomers
                                   .Where(r => r.CustomerId == id);
} 
```

注意**.Where(r => r.CustomerId == id)**过滤器。我们可以在数据服务文件中这样做，但是因为我们希望用户只看到他的个人数据，我们需要从服务器过滤，所以它只返回他的数据。

iv. 现在，实体已在控制器中设置，您可以在数据服务文件中调用它，如下所示：

```
var getOrdersByCustomerId = function(orderObservable, id)
{
    var query = breeze.EntityQuery.from('OrdersByCustomerId')
                                  .WithParameters({ CustomerId: id });

    return manager.executeQuery(query)
                  .then(function(data) {
                      if (orderObservable) orderObservable(data.results);
                  }
                  .fail(function(e) {
                      logError('Retrieve Data Failed');
                  }
} 
```

v. 从这里你可能知道下一步该做什么。

希望能帮助到你。

# c++ - C ++：函数包装器是否与内联一起使用？

> ID：15694018
> 
> 赞同：7
> 
> 时间：2013-03-28T23:35:57.203
> 
> 标签：c++, performance, inline, wrapper

如果您在编译器中启用了完全优化并且有这样的类设置：

```
class A
{
    void Do_A_Stuff();
};
class B
{
    A a;
    void Do_B_Stuff() { a.Do_A_Stuff(); }
};
class C
{
    B b;
    void Do_C_Stuff() { b.Do_B_Stuff(); }
};
class D
{
    C c;
    void Do_D_Stuff() { c.Do_C_Stuff(); }
}; 
```

是否存在调用`Do_D_Stuff()`比直接调用慢的情况`Do_A_Stuff()`？此外，这是否需要`inline`每个包装器“链”上的关键字，或者，因为这只是一个建议，编译器是否可以决定在没有关键字的情况下对其进行优化？

我意识到有很多关于内联的信息可用，但我找不到任何关于将许多包装器链接在一起的信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T23:39:29.860

> 此外，这是否需要每个包装器“链”上的 inline 关键字，或者，因为这只是一个建议，编译器是否可以决定在没有关键字的情况下对其进行优化？

是的，编译器可以决定优化它，即使你指定了关键字，它也可以决定*不*`inline`优化它（如果设置了适当的编译器选项，可能会产生警告） - 请注意，在类定义中定义的成员函数被隐式标记为`inline`。

一般来说，如果内联是可能的，编译器会根据被调用的函数体来决定是否内联。但是，如果函数是虚函数，或者函数的定义对编译器不可见，则内联可能根本不可能。

如果满足内联的条件并且编译器认为它合适，那么在函数调用链上内联不存在技术问题。

作为一个小评论，请注意您的类中的函数应该是`public`，否则您的包装器将无法访问它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:38:56.637

这些函数是在类定义中定义的，因此`inline`在这种情况下关键字是隐含的。

# c# - 如何在没有 JSON.NET 库的情况下将对象转换为 JSON？

> ID：15694020
> 
> 赞同：7
> 
> 时间：2013-03-28T23:36:14.157
> 
> 标签：c#, json, serialization

我想保存这个对象：

```
Student s = new Student(); 
```

到 Json 文件。但是 Visual Studio 2012 找不到这些命名空间：

```
System.Web.Script;
System.Json;
System.Runtime.Serialization.Json; 
```

任何的想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T23:41:01.357

第 1 步：谷歌“System.Runtime.Serialization.Json 命名空间”并找到此页面：

[System.Runtime.Serialization.Json 命名空间](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.aspx)

第 2 步：单击您感兴趣的类（比如说[JsonReaderWriterFactory 类](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.jsonreaderwriterfactory.aspx)）

第 3 步：阅读说明该类所在的程序集的部分：

> 程序集：System.Runtime.Serialization（在 System.Runtime.Serialization.dll 中）

第 4 步：将该 DLL 添加为对项目的引用。请参阅：[如何：使用“添加引用”对话框添加或删除引用](http://msdn.microsoft.com/en-us/library/vstudio/wkze6zky.aspx)

第 5 步：根据需要重复第 1 - 4 步。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-28T23:51:14.630

如果你想将类序列化为 Json，你也可以试试这个：

如果您还没有安装 JSON.NET。

确保包括`using Newtonsoft.Json;`

你可以试试这个代码：

```
Student s = new Student();
string json = JsonConvert.SerializeObject(s); 
```

对不起，我的英语不好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-28T23:38:49.427

确保将适当的引用添加到您的项目中。例如，要使用[`datacontractjsonserializer`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.json.datacontractjsonserializer.aspx)该类，您需要添加对`System.Runtime.Serialization`项目的引用。

如果您使用的是 Visual Studio，请阅读[如何：在 Visual Studio 中添加或删除引用](http://msdn.microsoft.com/en-us/library/wkze6zky%28v=vs.80%29.aspx)。

然后，您可以将其用于：

```
DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(Student));
ser.WriteObject(outputStream, student); 
```

当然还有很多其他的方法可以做到这一点，我不会详细介绍每一种（我相信你已经找到了一些例子，因为你列出了这些命名空间）。

*提示：*如果您想使用 .NET 类并且不确定需要向项目添加什么参考才能使用它，请打开该类的 MSDN 页面并查找如下文本：

> **程序集：** System.Runtime.Serialization（在 System.Runtime.Serialization.dll 中）

这是您需要添加到项目中的程序集引用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-28T23:42:43.857

其他答案是正确的，说您需要添加对适当程序集的引用。作为管理个人项目引用的一种简单方法，我推荐[NuGet](http://nuget.org/)，它是 Visual Studio 的包管理器。值得庆幸的是，NuGet 附带 Visual Studio 2012，因此您只需右键单击项目，单击“管理 NuGet 包”，然后搜索 Json.NET。我发现的第一篇关于在 Visual Studio 2012 中使用 NuGet 的博客文章在[这里](http://weblogs.asp.net/sreejukg/archive/2012/10/25/nuget-package-manager-in-visual-studio-2012.aspx)，它似乎提供了一组很好的说明，并附有屏幕截图。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T23:39:56.097

您可能需要添加对项目的引用：

*   System.Runtime.Serialization.Json 在 System.Runtime.Serialization
*   System.Web.Script 在 System.Web.Extensions 中
*   System.Json 仅适用于 Silverlight

# jquery - CSS3（或jQuery）淡入图像

> ID：15694023
> 
> 赞同：0
> 
> 时间：2013-03-28T23:36:20.960
> 
> 标签：jquery, css, background-image

所以，我有一点代码，我想修改它做的是有一个特定的背景图像，然后在悬停时淡入不同的背景图像。我只是想知道，CSS3 还是 jQuery。如果你想推荐一个，一个关于如何实现这一目标的好地方也很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:44:01.727

见样本：

[http://jsfiddle.net/GaYKF/56/](http://jsfiddle.net/GaYKF/56/)

使用jQuery：

```
 $("#myDiv").hover(
function(){
  $(this).fadeTo('slow', 0.3, function()
    {
        $(this).css('background-image', 'url("http://1.bp.blogspot.com/-tOHKWImzMJQ/TlHqjy1C_II/AAAAAAAAAWw/T5WGegi1sVc/s320/blue+%25288%2529.jpg")');
    }).fadeTo('slow', 1);
}, 
function(){
   $(this).fadeTo('slow', 0.3, function()
    {
        $(this).css('background-image', 'url("http://1.bp.blogspot.com/-nI97Eqlkfh0/TlHp2CS0_XI/AAAAAAAAAWU/kRGbOd6YNZg/s320/blue+%25281%2529.jpg")');
    }).fadeTo('slow', 1);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:51:51.913

要完成 Mennan 的解决方案，如果您使用 jQuery，请这样做以更改悬停在元素上的背景图像（`<div>`在本例中）。

```
$('#mydiv').mouseenter( function() {
  $(this).css('background-image','url(/images/second.png)');
}).mouseleave(function() {
  $(this).css('background-image','url(/images/original.png)');
}); 
```

# javascript - Ajax 不会让我返回 true 或 false

> ID：15694025
> 
> 赞同：0
> 
> 时间：2013-03-28T23:36:24.800
> 
> 标签：javascript, jquery, ajax

如果以下 ajax 脚本未返回 1，我将尝试为整个 validator.registercallback 函数返回 true。但是，它不起作用，我认为它可能是我缺少的一些基本内容，但我不能想办法。

```
validator.registerCallback('unique_username', function(value) {

        //use ajax to run the check  
        var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
      if(xmlhttp.responseText != 1) {
          alert('Username Exists');
          return false;
      } else {
          alert('Username Available!');
          return true;
      }
    }
  }
xmlhttp.open("GET","uniqueuser.php?username="+value,true);
xmlhttp.send();

}) 
```

奇怪的是，以下工作，它只是不工作基于 ajax 脚本的值：

```
validator.registerCallback('unique_username', function(value) {

        //use ajax to run the check  
        var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
      if(xmlhttp.responseText != 1) {
          alert('Username Exists');
          return false;
      } else {
          alert('Username Available!');
          return true;
      }
    }
  }
xmlhttp.open("GET","uniqueuser.php?username="+value,true);
xmlhttp.send();

return true;

}) 
```

所以基本上，我可以告诉它在主函数中返回 true，但是当我试图让它返回 true 时，只有当 ajax 脚本中的值不返回 1 时，它才会起作用。顺便说一句，警报确实有效。所以它得到了正确的值，但它不会返回真或假。

任何帮助表示赞赏！

*更新*

```
validator.registerCallback('unique_username', function(value) {

        //use ajax to run the check  
function ajax_result() {
  var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    }
  }
xmlhttp.open("GET","uniqueuser.php?username="+value,true);
xmlhttp.send();
}

if(ajax_result() != 1) { 

alert('Username Exists');
return false;

} else {

alert('Username Available!');
return true;

}

}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:05:14.393

您缺少的是 ajax 调用是**异步**的。当你的函数结束时，ajax 调用还没有完成，值（true 或 false）只会在稍后返回。

要解决这个问题，您需要使 ajax 调用同步或修改链接逻辑，例如反转它并在 ajax 调用中运行 validator.registerCallback()。您还可以考虑一些更复杂的技术，例如[promises](http://api.jquery.com/jQuery.ajax/)。

[更新]这是使请求同步的方式：

```
xmlhttp.open("GET","uniqueuser.php?username="+value,false); 
```

您还需要更改其余代码，例如，请参阅[此 MDN 文章](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/Synchronous_and_Asynchronous_Requests)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:53:58.037

您已将 jQuery 添加到此问题的关键字列表中，因此我使用 jQuery 回答：

```
var username = "foo";
$.get('uniqueuser.php', {username: username}, function(webpage)
{
  if (webpage == 1)
    alert("user exists");
  else
    alert("Username available!");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:11:54.773

再试一次：

```
is_user_existing('foo', function(result)
{
  if (result)
    alert("user is existing");
  else
    alert("user is not existing");
});

function is_user_existing(username, continuation)
{
    $.get('uniqueuser.php', {username: username}, function(webpage)
    {
      continuation (webpage == 1);
    });
} 
```

# ruby-on-rails - 使我的 Rails 资产管道 HTTPS 友好

> ID：15694026
> 
> 赞同：1
> 
> 时间：2013-03-28T23:36:26.900
> 
> 标签：ruby-on-rails, ruby-on-rails-3, https, asset-pipeline

我的 Rails 网站使用 SSL，但 Internet Explorer 显示此错误消息时遇到问题 ![在此处输入图像描述](../Images/f0101f188188c4f9a2f2cdd0b4f82b05.png)

我注意到我的 CSS 文件可能是罪魁祸首。我的 CSS 文件位于资产管道 (/app/assets/stylesheets) 中。我只在我的网站上使用 HTTPS，所以我想让它们对 HTTPS 友好。我将这条线纳入`config/asset.rb`以及纳入`config/environment/production.rb`为良好的衡量标准

```
config.asset_path = "https://www.myapp.com/assets/" 
```

为了使资产管道 HTTPS 友好，还需要做些什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:51:34.473

如果您使用相对路径，则不必担心这一点..

您是否使用助手来加载您的资产？

```
<%= stylesheet_link_tag "application" %> 
```

生成：

```
<link href="/application.css" media="all" rel="stylesheet" type="text/css" /> 
```

这不应该给您带来 HTTPS 的任何问题......不需要其他配置，我想不到。

# asp.net-mvc-4 - ASP.NET MVC 4：模型内部列表的表

> ID：15694029
> 
> 赞同：0
> 
> 时间：2013-03-28T23:36:49.690
> 
> 标签：asp.net-mvc-4

我有一个 ViewModel 扩展了一个众所周知的基类，以允许共享视图读取公共属性。这是设计使然。

我还有一些页面显示模型中包含的实体列表的详细信息。以下代码提供了一个示例：

```
public abstract class AbstractViewModel {
      public Exception lastError; //If not null triggers a big warning
}

public class Cat{
      [Display(...)]
      public string Name;
}

public class CatListViewModel: AbstractViewModel {
      public IEnumerable<Cat> cats;
} 
```

现在我的局部视图需要使用常见的 MVC 方式显示猫的列表

```
@model Org.Zighinetto.CatListViewModel

<table>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Cats.Name) //Doesn't work!!
        </th>
    </tr>
    @foreach (var item in Model.Cats)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
        </tr>
    }
</table> 
```

不幸的是，我不能使用`DisplayNameFor`集合作为参数

## 问题是

`IEnumerable<Cat>`鉴于上述数据模型，并且鉴于设计原因我不想将模型性质更改为...

当表达式涉及集合时，尤其是当该集合为空时，如何将作为`Cat`类的属性的显示名称绑定到方法或任何等效项？`DisplayNameFor`否则问，如何修复上述编译错误？`DisplayNameFor`在这种情况下，正确的语法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:36:49.690

自己运气好发现的。

基本上`Html.DisplayNameFor(Model => Model.Cats.FirstOrDefault().Name)`可以工作，因为即使没有猫，运行时也会`Cat`正确反映类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T05:20:01.400

您需要在代码中注意几件事以防止出现空异常。

**首先**，您需要初始化您`Cats`的集合，以便当您的代码没有这样做时，出于正当的原因并且它在现实中发生，您可以避免出现空异常。所以你可以这样写你的模型：

```
public class CatListViewModel: AbstractViewModel {
    public CatListViewModel() {
        Cats = new List<Cat>();
    }
    public IEnumerable<Cat> Cats;
} 
```

因此，在您看来，如果您这样做，`Model.Cats.FirstOrDefault()`您将不会得到空异常，因为`Cats`它是空的。

**其次**，既然您“可以”拥有一个空集合（**非**空），因为您在`CatListViewModel`创建实例时正在对其进行初始化，所以您仍然可能遇到空异常。`NULL`那是因为您告诉编译器在列表中没有项目时给您- `Model.Cats.FirstOrDefault()`。所以你需要做的是：

```
<th>
    @if (Model.Cats.Any()) {
        @Html.DisplayNameFor(model => model.Cats.First().Name)
    }
</th> 
```

# javascript - 如何使用jQuery获取一个元素在另一个元素中的位置？

> ID：15694033
> 
> 赞同：-1
> 
> 时间：2013-03-28T23:37:05.067
> 
> 标签：javascript, jquery

如果我单击第一个 div，我想获得 0 或 1，如果第二个 div 为 2，依此类推...

我的任何尝试都没有奏效：

[http://jsfiddle.net/DZh8k/](http://jsfiddle.net/DZh8k/)

```
$('div').click(function() {

    //alert( $('#something').index($(this)) );
    //alert( $(this).index( $('#something') ) );
    console.log( $('#something').find($(this)).eq() );

});

<span id="something">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
</span> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:38:51.793

只是`$(this).index()`会工作。

[http://jsfiddle.net/DZh8k/2/](http://jsfiddle.net/DZh8k/2/)

# git - 为什么我的 .git 文件很大？

> ID：15694034
> 
> 赞同：6
> 
> 时间：2013-03-28T23:37:20.810
> 
> 标签：git, git-rewrite-history

我不小心在 git 目录中添加并提交了一些非常大 (100MB+) 的 PSD 文件。当它们在目录中时，我对这些文件进行了一堆编辑，但后来意识到它们不应该在那里并将它们从目录中删除。

然后我跑了：

```
git add --all && git commit -m "Removed large psds" 
```

我目录中的文件现在加起来不到十几个 MB，但 .git 文件本身除外，它是 700MB+。

这里发生了什么？它是否保留已删除 .PSD 文件的旧版本？这是否意味着 git 永远不会清除从删除文件中获得的空间？我如何让它完全忘记这些文件，以便我可以降低 .git 文件的大小？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-29T02:49:01.713

您的 .git 文件夹非常大，因为 PSD 文件仍然存在于存储库中。要删除它们，您需要使用 修改历史记录`git filter-branch`。[这里](https://www.kernel.org/pub/software/scm/git/docs/git-filter-branch.html)解释如何使用这个命令。之后，您将需要清理存储库。

我创建了一个脚本来帮助这项工作。如果你想使用它，你可以从[github](https://github.com/williammizuta/git-delete)下载它。欢迎任何意见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-31T22:07:16.797

您想使用[BFG Repo-Cleaner](http://rtyley.github.com/bfg-repo-cleaner/)，这是一种更快、更简单的替代方案，`git-filter-branch`旨在从 Git 存储库中删除**大文件。**

下载[BFG jar](http://rtyley.github.com/bfg-repo-cleaner/#download)（需要 Java 6 或更高版本）并运行以下命令：

```
$ java -jar bfg.jar  --strip-blobs-bigger-than 10MB  my-repo.git 
```

任何超过 10MB 的文件（不在您的*最新*提交中）都将从您的 Git 存储库的历史记录中删除。然后，您可以使用`git gc`清除死数据：

```
$ git gc --prune=now --aggressive 
```

BFG 通常比运行快 10-50 倍，`git-filter-branch`并且这些选项是围绕以下两个常见用例量身定制的：

*   删除**疯狂的大文件**
*   删除**密码、凭证**和其他**私人数据**

*全面披露：我是 BFG Repo-Cleaner 的作者。*

# yii - Yii 控制器参数

> ID：15694037
> 
> 赞同：0
> 
> 时间：2013-03-28T23:37:41.553
> 
> 标签：yii

当我创建这个方法

```
actionTest($parameter){
    print($parameter);
} 
```

在 yii 控制器内部并尝试在浏览器中访问它我收到错误 400。

如何设置 yii 以便如果我输入：/controller/test/text 它只会在屏幕上打印字符串 'text' 而不是返回无效请求错误？

我已经验证了 URL 是正确的。如果我写

```
actionTest(){
  print('text'); 
} 
```

然后去 /controller/test/text 然后它工作得很好。

如何设置 yii 以便控制器操作可以接受 URL 中的参数值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:15:54.243

您必须编辑您的`urlManager`重写规则数组`config.php`以包含

```
'urlManager'=>array(
    ....
    'rules'=>array(
        'controller/test/<parameter:\w+>' => 'controller/test',
        ...
    ),
), 
```

您的控制器功能为

```
actionTest($parameter){
   print($parameter);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-21T19:14:23.953

> @curtis：谢谢。这有帮助！！！`<controller:\w+>/<action:\w+>/<id:\w+>'=>'<controller>/<action>` – Curtis Colly 2013 年 3 月 31 日在 3:27

规则`<controller:\w+>/<action:\w+>/<id:\w+>'=>'<controller>/<action>`行会将最后一个参数发送到控制器，就`$id`好像您想使用 $parameter 一样，您应该将 id 更改为参数。

```
<controller:\w+>/<action:\w+>/<parameter:\w+>'=>'<controller>/<action> 
```

在控制器中，您还可以键入

```
actionTest(){
    print($_GET['parameter']); //or $_REQUEST
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T18:01:45.543

试试 url: `/controller/test/parameter/text`，它应该可以工作。@topher 建议的 url 规则也是正确的。

# jquery - Jquery Ajax 调用 - 回调函数出错

> ID：15694040
> 
> 赞同：0
> 
> 时间：2013-03-28T23:37:54.703
> 
> 标签：jquery, ruby-on-rails, ajax

所以我试图用jquery（coffeescript）来做这个ajax请求，但是我遇到了回调函数的问题，它告诉我“数据”是未定义的，但有时，当我重新编写代码时，它没有t 给我一个控制台错误，而是什么都不做。我知道请求通过了，因为 rails 可以很好地处理请求，但是发送回信息可能会出现问题，所以我也会包含我的控制器代码。非常感谢您的帮助。

```
submit_yes = ->
par = $(this).parent().parent()
event_id = par.find('#event_id').val()
time_module_id = par.find('#time_module_id').val()
$.ajax
  type: "PUT",
  url: '/events/'+event_id+'/add_yes_rsvp?' + par.find('#time_module_id').serialize(),
  data: JSON.stringify({ _method:'put' })
  success: (data) ->
    alert data
    update_score(par.parent())
return true

def add_yes_rsvp
  @event = Event.find(params[:id])
  TimeModule.find(params[:time_module_id]).add_yes_rsvp(current_user)
  respond_to do |format|
    format.json {render json: { error: false }}
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:29:28.157

请求的可用格式和内容类型不匹配。你基本上有三个选择：

1.  使用 $.ajax 的“accepts”设置将请求标头内容类型设置为“json”
2.  将 .json 添加到您请求的网址的末尾
3.  将 format.json 更改为 format.js

# php - Google 翻译 API 访问错误：(403) 未配置访问

> ID：15694042
> 
> 赞同：0
> 
> 时间：2013-03-28T23:38:04.140
> 
> 标签：php, google-api, google-translate

这是我第一次尝试使用 Google API，所以我可能遗漏了一些非常简单的东西。

我的 API 访问已经打开，我已经启用了我可以找到的所有基于 Web 的设置，为 Web 应用程序设置了简单 API 访问和客户端 ID，等等。

我在这里使用谷歌提供的 PHP 库：[http ://code.google.com/p/google-api-php-client/](http://code.google.com/p/google-api-php-client/)

由于我的代码无法正常工作，我默认使用他们的示例代码，因为正常工作通常可以解决我的问题。我在下面复制了他们的代码：

```
require_once '../../src/Google_Client.php';
require_once '../../src/contrib/Google_TranslateService.php';

$client = new Google_Client();
$client->setApplicationName('Translation tool');

// Visit https://code.google.com/apis/console?api=translate to generate your
// client id, client secret, and to register your redirect uri.
$client->setDeveloperKey('XXXXXXXXXXXXXXXX');
$service = new Google_TranslateService($client);

$langs = $service->languages->listLanguages();
print "<h1>Languages</h1><pre>" . print_r($langs, true) . "</pre>";

$translations = $service->translations->listTranslations('Hello', 'hi');
print "<h1>Translations</h1><pre>" . print_r($translations, true) . "</pre>"; 
```

我有：

*   检查了开发者密钥，也就是 API 密钥
*   检查允许的推荐人
*   将引荐来源网址设置为包括*.DOMAIN.com/*
*   设置引用者以包含 IP 地址
*   尝试包括 OAuth2 客户端 ID、密码等

这些都没有奏效。我得到的完整错误如下：

```
Fatal error: Uncaught exception 'Google_ServiceException' with message 'Error calling GET https://www.googleapis.com/language/translate/v2/languages?key=XXXXXXXXXXXXXXXX: (403) Access Not Configured' in /home/google-api-php-client/src/io/Google_REST.php:66 Stack trace: #0 /home/google-api-php-client/src/io/Google_REST.php(36): Google_REST::decodeHttpResponse(Object(Google_HttpRequest)) #1 /home/google-api-php-client/src/service/Google_ServiceResource.php(186): Google_REST::execute(Object(Google_HttpRequest)) #2 /home/google-api-php-client/src/contrib/Google_TranslateService.php(39): Google_ServiceResource->__call('list', Array) #3 /home/google-api-php-client/examples/translate/simple.php(13): Google_LanguagesServiceResource->listLanguages() #4 {main} thrown in /home/google-api-php-client/src/io/Google_REST.php on line 66 
```

我失去了用应该更直接的东西编码的意愿。关于可能是什么问题的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T21:56:41.900

该 403 错误几乎肯定与 Simple API Key 有关。例如，如果这是一个使用限制，则消息会这样说......

仔细检查并确保您使用列出的用于服务器访问的简单 API 密钥并将其设置为任何 IP。特定的 IP 应该可以工作，但这可能取决于您的服务器的设置方式。

您甚至可能想要生成一个新密钥，以确保您拥有的密钥有效。从长远来看，特定的 IP 是最好的。

刚刚使用自定义搜索 API 做了同样的事情，输入了浏览器密钥，当我把头撞到墙上时，它在墙上造成了一个很大的凹痕。. 您不需要任何 OAuth 设置来使基础工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T17:02:16.147

我有同样的问题，但使用分析 api。在我的情况下，我在允许的 IP 地址中列出了服务器的 IP。
因此，当我从 google api 的控制台中删除所有允许 ip 地址的 IP 地址时，它就开始工作了。

# postgresql - SQL查询选择公网IP地址

> ID：15694047
> 
> 赞同：2
> 
> 时间：2013-03-28T23:38:25.807
> 
> 标签：postgresql, ip, postgresql-8.3

我在 postgresql 8.3 数据库上。我试图找出错误在下面的查询中。我正在尝试设计一个查询以仅选择作为私有地址的 source_ips 和 destination_ips。

出于某种原因，在下面的查询中获取的地址之一是地址 208.117.252.39，它不是私有地址。

> 下面的查询中的逻辑是否有问题会使其也选择公共 IP 地址？

```
 select source_ip, destination_ip
from ip_table
where
    (
    inet '10/8' >> source_ip
    or inet '192.168/16' >> source_ip
    or source_ip >= inet '172.16/16' and source_ip < inet '172.32/16'
     )
    and  inet '10/8' >> destination_ip
    or  inet '192.168/16' >> destination_ip 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:17:28.423

由于该`and`操作优先于`or`您，因此缺少括号。您的查询相当于：

```
select source_ip, destination_ip
from ip_table
where
    (
        (
        inet '10/8' >> source_ip
        or inet '192.168/16' >> source_ip
        or source_ip >= inet '172.16/16' and source_ip < inet '172.32/16'
        )
        and  inet '10/8' >> destination_ip
    )
    or  inet '192.168/16' >> destination_ip 
```

正确的版本：

```
select source_ip, destination_ip
from ip_table
where
    (
        inet '10/8' >> source_ip
        or inet '192.168/16' >> source_ip
        or source_ip >= inet '172.16/16' and source_ip < inet '172.32/16'
    )
    and
    (
        inet '10/8' >> destination_ip
        or  inet '192.168/16' >> destination_ip
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:16:59.940

您需要适当地对最终条件进行分组。现在，最后一个“或”忽略所有`source_ip`条件。

像这样构造查询：

```
select source_ip, destination_ip
from ip_table
where
(
  inet '10/8' >> source_ip
    or inet '192.168/16' >> source_ip
    or inet '172.16/12' >> source_ip
 )
and  (
  inet '10/8' >> destination_ip
    or  inet '192.168/16' >> destination_ip
    or inet '172.16/12' >> destination_ip
); 
```

请注意，目标子句组合在一起。

# c# - 向服务总线 1.0 队列发送消息的套接字错误

> ID：15694048
> 
> 赞同：2
> 
> 时间：2013-03-28T23:38:32.870
> 
> 标签：c#, azure, servicebus

我正在学习[本教程](http://msdn.microsoft.com/en-us/library/windowsazure/jj542433%28v=azure.10%29.aspx)，但我不断收到异常调用`QueueClient.Send()`。

首先，这是我在 App.Config 中的连接字符串设置（将 {computername} 替换为实际机器名称）：

```
<add key="Microsoft.ServiceBus.ConnectionString" value="Endpoint=sb://{computername}/ServiceBusDefaultNamespace;StsEndpoint=https://{computername}:9355/ServiceBusDefaultNamespace;RuntimePort=9354;ManagementPort=9355" /> 
```

这是我正在运行的代码：

```
NamespaceManager namespaceManager = NamespaceManager.Create();

TokenProvider nameSpaceManagerTokenProvider = TokenProvider.CreateWindowsTokenProvider(
    new List<Uri>() { namespaceManager.Address }, new NetworkCredential(user, password));

TokenProvider messagingToken = TokenProvider.CreateWindowsTokenProvider(
    new List<Uri>() { namespaceManager.Address }, new NetworkCredential(user, password));

namespaceManager.Settings.TokenProvider = nameSpaceManagerTokenProvider;

MessagingFactorySettings messageFactorySettings = new MessagingFactorySettings {TokenProvider = messagingToken};

MessagingFactory messagingFactory = MessagingFactory.Create(namespaceManager.Address, messageFactorySettings);

if (namespaceManager.QueueExists(QueueName))
{
    namespaceManager.DeleteQueue(QueueName);
}

QueueDescription qd = new QueueDescription(QueueName);

namespaceManager.CreateQueue(qd);

QueueClient myQueueClient = messagingFactory.CreateQueueClient(QueueName);

BrokeredMessage sendMessage = new BrokeredMessage("Hello, World!");

myQueueClient.Send(sendMessage); // <---- This is where I'm getting the exception 
```

队列被删除/创建没有问题。调用该`.Send()`方法会给我以下错误：

Microsoft.ServiceBus.Messaging.MessagingCommunicationException

“套接字连接已中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或底层网络资源问题造成的。本地套接字超时为 '00:00:59.9579976'。”

内部异常只是“现有连接被远程主机强行关闭”

这是堆栈跟踪：

```
 at Microsoft.ServiceBus.Messaging.Sbmp.SbmpMessageSender.EndSendCommand(IAsyncResult result)
   at Microsoft.ServiceBus.Messaging.Sbmp.SbmpMessageSender.OnEndSend(IAsyncResult result)
   at Microsoft.ServiceBus.Messaging.Sbmp.SbmpMessageSender.OnSend(TrackingContext trackingContext, IEnumerable`1 messages, TimeSpan timeout)
   at Microsoft.ServiceBus.Messaging.MessageSender.Send(TrackingContext trackingContext, IEnumerable`1 messages, TimeSpan timeout)
   at Microsoft.ServiceBus.Messaging.MessageSender.Send(BrokeredMessage message)
   at Microsoft.ServiceBus.Messaging.QueueClient.Send(BrokeredMessage message)
   at SBDemo.Program.Main(String[] args) in c:\Users\hartez\Documents\bitbucket\SBDemo\SBDemo\Program.cs:line 51
   at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart() 
```

我目前在 Windows 7 64 位开发盒上运行客户端代码和服务总线。我最初在 2012 Server 机器上运行 Service Bus 并且遇到了同样的问题。

`WindowsTokenProvider`和都会出现问题`OauthTokenProvider`。用户帐户是管理员（希望这只是权限问题）；这似乎没有帮助。我也尝试过禁用 Windows 防火墙，但这也无济于事。

我在事件查看器中启用了分析和调试日志，但我没有在这些日志中看到任何提示问题可能的内容。

如果有人对可能出现的问题或其他调试方法有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T15:55:38.363

很高兴你知道了这一点。

> > MessagingFactory messingFactory = MessagingFactory.Create(namespaceManager.Address, messageFactorySettings);

您在原始代码中遇到的问题是它使用 MessagingFactory 的 NamespaceManager 地址。MessagingFactory 使用与 NamespaceManager 不同的端口。

NamespaceManager 用于管理（CRUD）操作，SB 有一个管理端点。

MessagingFactory 用于运行时操作（Send/Receive/..），SB 有一个运行时 endoiunt。

QueueClient.Create(QueueName) 在内部创建一个消息传递工厂，并使用默认地址和端口进行运行时操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T19:00:04.117

终于想通了，把它放在这里，这样同一条船上的其他人就可以避免与这个问题搏斗：

显然，问题出在示例中使用 MessagingFactory 的某个地方。我不确定它的用途是什么（也许处理诸如 AMQP 之类的东西，Service Bus 还没有真正支持？），但你不需要它。您可以使用 QueueClient.Create() 创建客户端。我修改了代码看起来像这样，现在它工作得很好：

```
NamespaceManager namespaceManager = NamespaceManager.Create();

TokenProvider nameSpaceManagerTokenProvider = TokenProvider.CreateWindowsTokenProvider(
    new List<Uri>() { namespaceManager.Address }, new NetworkCredential(user, password));

namespaceManager.Settings.TokenProvider = nameSpaceManagerTokenProvider;

if (namespaceManager.QueueExists(QueueName))
{
    namespaceManager.DeleteQueue(QueueName);
}

QueueDescription qd = new QueueDescription(QueueName);

namespaceManager.CreateQueue(qd);

QueueClient myQueueClient = QueueClient.Create(QueueName);

BrokeredMessage sendMessage = new BrokeredMessage("Hello, World!");

myQueueClient.Send(sendMessage); 
```

# javascript - 如何构建一套都有自己的 qunit 固定装置的 Qunit 测试？

> ID：15694060
> 
> 赞同：6
> 
> 时间：2013-03-28T23:39:32.803
> 
> 标签：javascript, qunit

我有两个 XXXTest.html 文件，每个都类似于：

```
<html>
    <head>
        <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-1.11.0.css" />
        <script src="../../../public/scripts/common/SomeUtils.js"></script>
    </head>
    <body>
        <div id="qunit"></div>
        <div id="qunit-fixture">
             <div id="findme">Something specific for the code under test</div>
        </div>
        <script src="http://code.jquery.com/qunit/qunit-1.11.0.js"></script>
        <script src="SomeUtilsTest.js"></script>
    </body>
</html> 
```

每个都有自己的 qunit-fixture，因此 html 文件相当于一个 JUnit 测试类。我意识到 qunit 认为模块与测试类大致相同，但这是非常有限的。

拥有将在其他 html 文件中执行测试的主 html 文件的最佳方法是什么？或者在 qunit 世界中分离出需要自己的固定装置的测试的“正确方法”是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T23:56:10.570

我通常有一个主 runner.html，`#qunit-fixture`留空并从我的模块的设置方法中填充夹具。

但是，如果您想共享 html，则很容易：

1.  将 html 存储在模板中（即 some-test-fixture.html）
2.  使用 ajax (或[requirejs !text](http://requirejs.org/docs/api.html#text) )加载模板

然后您可以根据需要填充#qunit-fixture

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-13T10:25:43.660

有一个很好的插件叫做[qunit-composite](https://github.com/jquery/qunit-composite)。

“Composite 是一个 QUnit 插件，当收到一组文件时，它会在 iframe 中打开每个文件，运行测试，并将结果显示为一组 QUnit 测试。”

# c++ - 如何将完美转发与大括号括起来的初始化程序结合起来

> ID：15694061
> 
> 赞同：2
> 
> 时间：2013-03-28T23:39:35.000
> 
> 标签：c++, templates, c++11, perfect-forwarding, list-initialization

此代码编译：

```
pair <pair<int,int>,unique_ptr<int>> t({0,0}, unique_ptr<int>()); 
```

以及该：

```
tuple<pair<int,int>,unique_ptr<int>> t(make_pair(0,0), unique_ptr<int>()); 
```

但是这个没有：

```
tuple<pair<int,int>,unique_ptr<int>> t({0,0}, unique_ptr<int>()); 
```

原因是第三个调用`tuple(const Types&...)`，但这似乎是一个任意限制。

C++11 是否无法用可变参数模板表达这一点，还是有可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:39:35.000

这是可能的，但并非微不足道。为了使这个工作，一个包含`N`参数的元组必须支持`2^N`构造函数，所有的组合`T&&`和`T const&`for each `T`。

我们要做的是混合这些`2^N`构造函数，这些构造函数可以使用继承来完成。由于基类的构造函数只能`using`显式使用，因此我们只能添加固定数量的基类的构造函数，因此我们必须使用递归。

一种方法是从`0`to计数，`2^N`如果第 i 位为 1，则使第 i 个参数为 const-ref，否则为右值。总共使用基类执行此操作，`2^N`其中每个基类都向其直接基类添加一个构造函数。

```
namespace detail {
  // A bitlist holds N powers of two: 1, 2, 4, 8, 16, ...
  template <std::size_t... i> struct bitlist { using type = bitlist; };
  template <std::size_t N, typename=bitlist<>>
  struct make_bitlist;  
  template <std::size_t N, std::size_t... i>
  struct make_bitlist<N, bitlist<i...>>
    : make_bitlist<N-1, bitlist<0,1+i...>> {};
  template <std::size_t... i> struct make_bitlist<0, bitlist<i...>>
    : bitlist<(1<<i)...> {};

  struct forward_tag {}; // internal struct that nobody else should use

  // if T is a reference, some constructors may be defined twice, so use a non-accessible type.
  template <bool B, typename T>
  using const_if_set = typename std::conditional<B,
    typename std::conditional<std::is_reference<T>::value, forward_tag, T const&>::type, T&&>::type;

  // Our helper class.  Each tuple_constructor is derived from N-1 others
  // each providing one constructor.  N shall equal (1<<sizeof...(T))-1
  template <std::size_t N, typename L, typename... T> struct tuple_constructor;

  template <std::size_t N, std::size_t... I, typename... T>
  struct tuple_constructor<N, bitlist<I...>, T...>
    :  tuple_constructor<N-1, bitlist<I...>, T...>
  { // inherit base constructors
    using tuple_constructor<N-1, bitlist<I...>, T...>::tuple_constructor;
    tuple_constructor(const_if_set<(N & I), T>... t)
      : tuple_constructor<N-1, bitlist<I...>, T...>
          (forward_tag{}, std::forward<const_if_set<(N & I), T>>(t)...) {}
  };

  // base case: N=0, we finally derive from std::tuple<T...>
  template <std::size_t... I, typename... T>
  struct tuple_constructor<0, bitlist<I...>, T...> : std::tuple<T...> {
    tuple_constructor(T&&... t)
      : tuple_constructor(forward_tag{}, std::forward<T&&>(t)...) {}

    // All constructor calls are forwarded to this one
    template <typename... T2>
    tuple_constructor(forward_tag, T2&&... t2)
      : std::tuple<T...>(std::forward<T2>(t2)...) {}
  };

  // Convenience using for N=2^n, bitlist=1,2,4,...,2^n where n = sizeof...(T)
  template <typename... T>
  using better_tuple_base = tuple_constructor
    < (1<<sizeof...(T)) - 1, typename make_bitlist<sizeof...(T)>::type,  T... >;
}

template <typename... T> struct better_tuple : detail::better_tuple_base<T...> {
  using typename detail::better_tuple_base<T...>::tuple_constructor;
}; 
```

[住在 LWS](http://liveworkspace.org/code/1Kvsye%240)

但请注意，这不能很好地扩展到大型元组并显着增加编译时间。在我看来，这是语言的限制。

# php - 显示来自特定类别的最后 5 个帖子 (Wordpress)

> ID：15694064
> 
> 赞同：1
> 
> 时间：2013-03-28T23:39:45.930
> 
> 标签：php, wordpress, function

我正在尝试显示来自特定类别的最后 5 个帖子，这些帖子将链接到一个函数，以便我可以在 Wordpress 页面中插入简码。我拥有的代码如下，它可以满足我的一切需求（尽管我也想添加特色图片），但它不显示来自特定类别的帖子。

我尝试了很多东西，但找不到有效的修复方法。

```
function Last5posts()
{
    $args = array( "showposts" => 5, "category" => 3 ); 
    $content = "";   

    query_posts($args);

    if ( have_posts() ) : 

        while ( have_posts() ) :
            the_post();

            $link = get_permalink();
            $title = get_the_title();
            $date = get_the_date();                              

            $content .= "<div class='latest-posts'>";
            $content .= "<h3><a href='$link' target='_top'>$title / $date</a </h3>\n";
            $content .= "<p class='excerpt'>" . get_the_excerpt() . "</p>";
            $content .= "</div>";

        endwhile;

        wp_reset_query(); 

     endif;

     return $content;
}

add_shortcode('Last5Posts', 'Last5posts' ); 
```

我尝试用下面的代码替换第 3 行和第 4 行，但它会引发错误“语法错误，第 31 行意外'}'”。

```
$catquery = new WP_Query( 'cat=3&posts_per_page=10' );
while($catquery->have_posts()) : $catquery->the_post(); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T05:57:11.260

您可以使用如下代码

```
query_posts( 'cat=3&posts_per_page=5' ); 
```

默认情况下使用此 wordpress 将使用此代码之后的最后 5 个帖子...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-11T11:52:45.613

使用此
$catnames[1] 表示您要使用与该帖子相关的类别。

```
<?php $catnames = get_the_category();  
$postcatid=$catnames[1]->term_id;

$catquery = new WP_Query( 'cat='.$postcatid.'&posts_per_page=4' );
while($catquery->have_posts()) : $catquery->the_post();
?>
<ul>
<li><h3><a href="<?php the_permalink() ;?>" rel="bookmark"><?php the_title(); ?></a>    </h3>
</li>
</ul>
 <?php endwhile; 
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T05:29:48.320

看看这个：[查询帖子参数](http://codex.wordpress.org/Template_Tags/query_posts#Category_Parameters)；您绝对应该使用“猫”而不是类别。另外，您是否以“endwhile”结束您的“while”？你的完整代码现在是什么样子的？

# c# - C# 数据集和水晶报表

> ID：15694065
> 
> 赞同：2
> 
> 时间：2013-03-28T23:39:49.013
> 
> 标签：c#, asp.net, visual-studio-2012, .net-3.5, crystal-reports

我正在尝试在我一直从事的项目中使用 Crystal Reports。我对 Crystal Reports 没有太多经验，但从我在网上搜索的内容来看，到目前为止，我已经完成了这段代码：

标记：

```
 <CR:CrystalReportViewer ID="crViewerReports" Visible="true"  runat="server" 
            AutoDataBind="true" ReportSourceID="crs" />
       <CR:CrystalReportSource ID="crs" runat="server" >
           <Report FileName="MyReport.rpt">
           </Report>
       </CR:CrystalReportSource> 
```

代码：

```
 DataSet ds = new DataSet();
            ds = util.getReportDataSet(DateTime.Now.AddYears(-5), DateTime.Now, 100,4, null); 
```

Crystal Reports 文件来自其他应用程序并且工作正常我只需要获取数据集。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:49:46.397

下一步是将报表[的数据源分配给](http://msdn.microsoft.com/en-us/library/aa691464%28v=vs.71%29.aspx)刚刚加载的数据集：

```
crs.ReportDocument.SetDataSource(ds); 
```

如果你有参数，你还需要[设置它们](http://msdn.microsoft.com/en-us/library/aa691465%28v=vs.71%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T05:29:56.740

这是 aspx ：

```
 <updatepanel id="up" updatemode="alwayz"> 
<ContentTemplate>
    <CR:CrystalReportViewer ID="crvReportParameter" runat="server" Visible="false" EnableParameterPrompt="false"
                ReuseParameterValuesOnRefresh="true" ToolPanelView="None" AutoDataBind="true"
                HasCrystalLogo="False" HasToggleParameterPanelButton="false" />
</ContentTemplate>
</updatepanel> 
```

这是 CS 文件：

```
ds = util.getReportDataSet(DateTime.Now.AddYears(-5), DateTime.Now, 100,4, null);
                            rptDoc.Load(Server.MapPath(""MyReport.rpt""));

        rptDoc.SetDataSource(dsData.Tables[0]);
     crvReportParameter.ReportSource = rptDoc;
                crvReportParameter.DataBind(); 
```

# python - 默认字典中的Python散列算法

> ID：15694073
> 
> 赞同：0
> 
> 时间：2013-03-28T23:40:28.150
> 
> 标签：python, algorithm

简单的问题。

python的默认dict中使用了什么散列算法？

```
>>> g = { 'a' : 1, 'b' : 2, 'c' : 3 }
>>> g
{'a': 1, 'c': 3, 'b': 2}
>>> g.keys()
['a', 'c', 'b']
>>> 
```

我期待 线性探头（猜不是）`['a','b','c']`？`g.keys()`双哈希？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:42:52.770

不能保证 Python 会使用任何特定的方法——不同的实现可以使用任何他们想要的方法。`dict`s 是无序的，因此它的实现方式并不重要（前提是它履行了某些义务）。

[至于CPython是](https://stackoverflow.com/a/9022835/722121)如何做到的......

# javascript - 通过在 javascript 中传递时区来取消日期时间

> ID：15694077
> 
> 赞同：0
> 
> 时间：2013-03-28T23:40:45.177
> 
> 标签：javascript

我的要求是通过使用 javascript 传递时区来获取日期和时间。

是否有任何javascript函数可以实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:52:28.000

它可能会变得相当复杂，但有一个很好的 js 库可以使用 [https://bitbucket.org/pellepim/jstimezonedetect/wiki/Home](https://bitbucket.org/pellepim/jstimezonedetect/wiki/Home)

# django - django 管理界面中的详细名称应用程序

> ID：15694078
> 
> 赞同：9
> 
> 时间：2013-03-28T23:41:00.947
> 
> 标签：django, admin, verbose

在 Django 管理界面中，我们将模型按应用分组。好吧，我知道如何自定义模型名称：

```
class MyModel (models.Model):
  class Meta:
    verbose_name = 'My Model'
    verbose_name_plural = 'My Models' 
```

但我无法自定义应用名称。应用程序是否有任何详细名称？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-02-27T14:05:52.937

由于 django 1.7 app_label 不起作用。您必须遵循[https://docs.djangoproject.com/en/1.7/ref/applications/#for-application-authors](https://docs.djangoproject.com/en/1.7/ref/applications/#for-application-authors)说明。那是：

1.  `apps.py`在您的应用程序目录中创建
2.  写详细的名字：

    ```
    # myapp/apps.py

    from django.apps import AppConfig

    class MyAppConfig(AppConfig):
        name = 'myapp'
        verbose_name = "Rock ’n’ roll" 
    ```

3.  在项目的设置更改中`INSTALLED_APPS`：

    ```
    INSTALLED_APPS = [
        'myapp.apps.MyAppConfig',
        # ...
    ] 
    ```

    **或者**，您可以保留`myapp.apps`并`INSTALLED_APPS`让您的应用程序默认加载此 AppConfig 子类，如下所示：

    ```
    # myapp/__init__.py

    default_app_config = 'myapp.apps.MyAppConfig' 
    ```

所有的 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-08T21:21:31.137

在模型中使用 Meta 类并在那里定义 app_label 是可行的，但很可能您必须为模块中的每个模型都这样做。

另一种方法是实际使用`i18n`. 在你的 po 文件中，如果你用你的**app_label定义一个****msgid**你应该很好。

 **在您的应用中，添加/编辑 po 文件 *app_label > locale > ru > django.po*

```
#set app label string 
msgid <app_label>
msgstr "Ваше приложение этикетке" 
```

[你可以在这里](https://docs.djangoproject.com/en/dev/topics/i18n/#term-translation-string)阅读更多关于国际化和翻译的[信息](https://docs.djangoproject.com/en/dev/topics/i18n/translation/)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-29T00:08:55.533

将`app_label`attr 添加到您的`MyModel`内部`META`类

```
class MyModel (models.Model):
  class Meta:
    verbose_name = 'My Model'
    verbose_name_plural = 'My Models'
    app_label = 'wow_app_name' 
```**

# php - 未设置mysql限制最小值

> ID：15694080
> 
> 赞同：0
> 
> 时间：2013-03-28T23:41:11.607
> 
> 标签：php, mysql, limit

好吧，这对某人来说应该很容易——

我正在尝试选择数据库中的特定行

```
SELECT * FROM customers LIMIT 10,20 
```

但它总是返回 20 行

发生了什么，为什么最小值没有任何价值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T23:42:28.420

```
LIMIT X, Y 
```

意味着你`Y`从 number 开始得到结果`X+1`。

所以如果你想要从 11 到 20 的值，你需要使用：

```
LIMIT 10, 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T23:44:11.480

你想要做`limit 10`或`lmit 0, 10`10 个结果

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T23:44:28.557

子句的第二个数字`LIMIT`是要返回的行数，而不是最后一个索引。如果您只想要 10 行，请在查询限制子句中替换`20`为。`10`

```
SELECT * 
FROM customers
LIMIT 10, 10 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T23:47:06.393

`Limit`有两个参数`(x,y)`意味着你从`x+1 to y`. 来自 MySQL 手册：

> LIMIT 子句可用于限制 SELECT 语句返回的行数。LIMIT 接受一个或两个数字参数，它们都必须是非负整数常量（使用准备好的语句时除外）。
> 
> 有两个参数，**第一个参数指定要返回的第一行的偏移量，第二个参数指定要返回的最大行数。初始行的偏移量为 0（不是 1）**：

`SELECT * FROM tbl LIMIT 5,10;`

> 检索行 6-15 要检索从某个偏移量到结果集末尾的所有行，您可以为第二个参数使用一些较大的数字。
> 
> 此语句检索从第 96 行到最后一行的所有行：

`SELECT * FROM tbl LIMIT 95,18446744073709551615;`

> 使用一个参数，该值指定从结果集开头返回的行数：

`SELECT * FROM tbl LIMIT 5;`

> 检索前 5 行 换句话说，LIMIT row_count 等价于 LIMIT 0, row_count。

# oracle - 在行中创建日期表

> ID：15694082
> 
> 赞同：0
> 
> 时间：2013-03-28T23:41:22.390
> 
> 标签：oracle, plsql, date-arithmetic

我有一个 Oracle 数据库；我想创建一个包含两列的表，一列包含 id，另一列包含行中递增的日期。我想在我的 PL/SQL 代码中指定限制日期，并且代码将生成两个限制日期（从和到）之间的行。

这是一个示例输出结果：

```
+-----+--------------------+
|  id |dates               |
+-----+--------------------+
|  1  |01/02/2011 04:00:00 |
+-----+--------------------+
|  2  |01/02/2011 05:00:00 |
+-----+--------------------+
|  3  |01/02/2011 06:00:00 |
+-----+--------------------+
|  4  |01/02/2011 07:00:00 |
+-----+--------------------+
|  5  |01/02/2011 08:00:00 |
....
...
..
| 334 |05/03/2011 023:00:00|
+-----+--------------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:57:36.427

你并没有完全用细节淹没我们，但这是你想要的那种构造：

```
select level as id
       , &&start_date + ((level-1) * (1/24) as dates
from dual
connect by level <= ((&&end_date - &&start_date)*24)
/ 
```

这假设您的输入值是整天，如果您的开始或结束日期包含时间组件，您将需要调整数学。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:58:03.270

您需要从日期基线开始：

```
vBaselineDate := TRUNC(SYSDATE); 
```

或者

```
vBaselineDate := TO_DATE('28-03-2013 12:00:00', 'DD-MM-YYYY HH:MI:SS'); 
```

然后通过添加一天的分数来增加基线，具体取决于您想要的范围有多大，例如：1 分钟、1 小时等。

```
FOR i IN 1..334 LOOP
  INSERT INTO mytable
    (id, dates)
    VALUES
      (i, (vBaselineDate + i/24));
END LOOP;
COMMIT; 
```

1/24 = 1 小时。1/1440 = 1 分钟；

希望这可以帮助。

# google-apps-script - 是否可以为我在驱动器中使用的每个电子表格创建一个 Apps 脚本？

> ID：15694083
> 
> 赞同：0
> 
> 时间：2013-03-28T23:41:25.030
> 
> 标签：google-apps-script

我在一个电子表格中创建了一个脚本。如何使其可用于我的所有 Google 电子表格？我不想将它提交给画廊，因为它是供内部使用的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T04:29:11.350

做一个图书馆。手动将其包含在每个 ss 中。

# c++ - libcurl：判断一个URL是否在同一个局域网

> ID：15694084
> 
> 赞同：1
> 
> 时间：2013-03-28T23:41:35.797
> 
> 标签：c++, c, libcurl

我想知道是否有可能确定一个特定的 URL 是否属于发出请求的机器所在的同一个 LAN。

我主要想在执行 HTTP 请求的软件级别出于安全目的这样做，即我想禁止它甚至试图离开网络。我知道这样的事情通常是在网络管理级别上完成的，但问题是如何在软件级别上做到这一点。

我认为有可能采用 IP 地址方式 - 例如，解析 DNS，确定 IP 地址，然后查看它是否在本地网络类之一中（10.0.0\. *、192.168* ..* 等）

有没有人有任何想法/猜测如何在 C++ 中优雅地做到这一点并可能使用 libcurl？

谢谢。

# java - 类 Hut 数组中的 NullPointerException

> ID：15694092
> 
> 赞同：-3
> 
> 时间：2013-03-28T23:42:19.023
> 
> 标签：java, arrays, error-handling, syntax-error, game-engine

我正在尝试为学校设计一个非常简单的模拟文明游戏。现在我正在努力做到这一点，所以当你点击控制栏上的这个按钮时，你会创建一个新的小屋实例。我将在下面放置错误报告和发生错误的代码。

错误报告：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at controls.Sidebar.clickBuildHut(Sidebar.java:102)
at screen_window.Game_Window.mouseClicked(Game_Window.java:248)
at java.awt.Component.processMouseEvent(Unknown Source)
at java.awt.Component.processEvent(Unknown Source)
at java.awt.Container.processEvent(Unknown Source)
at java.awt.Window.processEvent(Unknown Source)
at java.awt.Component.dispatchEventImpl(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Window.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue$4.run(Unknown Source)
at java.awt.EventQueue$4.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

发生错误的代码：

```
public void newHut() {
        numOfHuts++;
        hut[numOfHuts] = new Hut(mouseX, mouseY, 0, numOfHuts);
} 
```

类顶部的小屋声明：

```
Hut[] hut = new Hut[9999];
int numOfHuts; 
```

Sidebar.clickBuildHut 方法：

```
public boolean clickBuildHut(int mouseX, int mouseY){
    if (viewConstruction){
        int topLeftX = x + 2;
        int topLeftY = y + 50 - 14;
        int selectionWidth = width - 10;
        int selectionHeight = 17;
        for (int i = 0; i <= width; i++) {
            for (int h = 0; h <= height; h++) {
                if (mouseX == topLeftX + i && mouseY == topLeftY + h) {
                    first_map.setEditMode(true);
                    game_window.newHut();
                    return true;
                }
            }
        }
    }
    return false;
} 
```

first_map.setEditMode：

```
public void setEditMode(boolean editMode) {
    this.editMode = editMode;
} 
```

尽管我认为这不是问题，因为当它切换为 true 时，我看到图片正确更改。如果你想让我给你更多关于这方面的信息，我可以但是，我认为它没有任何用处，因为它不是问题所在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:45:55.483

我没有看到您初始化`hut`阵列的任何地方。你已经声明了它，但你还没有初始化它，所以 Java 将它默认为`null`.

在某个地方，您需要使用以下内容对其进行初始化：

```
hut = new Hut[size]; 
```

也许在构造函数中。

**编辑**

根据现在显示该`clickBuildHut`方法的问题编辑，取决于哪一行实际上是第 102 行，要么`first_map`要么`game_window`是`null`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T02:44:18.473

找到 Sidebar.java 的第 102 行。基于作为 NPE 位置的堆栈跟踪。根据您的代码发布，我猜第 102 行是：

```
first_map.setEditMode(true); 
```

或者

```
game_window.newHut(); 
```

我这么说是因为这些是`clickBuildHut`方法中唯一的对象引用。因此，要么`first_map`为空，要么为`game_window`空。

# yui - 在 Windows 中压缩 Javascript

> ID：15694098
> 
> 赞同：5
> 
> 时间：2013-03-28T23:42:54.960
> 
> 标签：yui, yui-compressor

有谁知道有关如何在 Windows 中使用 YUI Compressor 缩小/压缩 javascript 文件的任何好的链接？我试图弄清楚如何安装它，然后使用 msdos 命令行压缩 javascript。

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-31T10:48:08.803

1.  为 Windows安装[Nodejs](http://nodejs.org/download/)
2.  [npm（节点包管理器）附带您刚刚抓取并安装的 MSI](https://npmjs.org/doc/README.html#Super-Easy-Install)
3.  跑`npm install yuicompressor`
4.  阅读[文档](https://npmjs.org/package/yuicompressor)并压缩文件

我会推荐[uglify-js](https://npmjs.org/package/uglify-js)而不是 YUI Compressor，因为[它处于弃用过程中](http://www.yuiblog.com/blog/2012/10/16/state-of-yui-compressor/)。和上面一样安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:39:04.517

您还可以将 gruntjs 与[grunt-contrib-](https://github.com/gruntjs/grunt-contrib-uglify) uglify 一起使用。

# ios - 使用 resizableImageWithCapInsets 计算可拉伸图像

> ID：15694101
> 
> 赞同：0
> 
> 时间：2013-03-28T23:43:34.427
> 
> 标签：ios, ios5, uiimage, image-resizing

我正在努力计算 resizableImageWithCapInsets 的参数。

我创建了一个如下所示的按钮图像，我将用于 Facebook 登录。我希望 Facebook 'f' 是静态的，其余部分（右侧）可以伸展，我相信你可以想象。

![在此处输入图像描述](../Images/7f6bbe863d3462f54ac97d85f31e4527.png)

这是我输出最接近的代码：

```
UIImage *facebookButton = [[UIImage imageNamed:@"FacebookLogin"]
                           resizableImageWithCapInsets:UIEdgeInsetsMake(18, 36, 18, 18)]; 
```

结果如下：

![在此处输入图像描述](../Images/9199b4c8f86fd2ab680888805e8ac18f.png)

我试图在网上遵循[这个解释](http://radleymarx.com/blog/simple-guide-to-9-patch/)，但我发现它很难理解。如果有人知道正确的调整大小以及任何有用的教程/指南，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:52:22.277

在您发布的链接中，他只使用没有图像的按钮 - 整个按钮仍在拉伸，如果他在这些按钮上有图像，结果将是您遇到的。

您需要将图像拆分为“图标”和“文本”部分，如下所示： ![在此处输入图像描述](../Images/1c9127bf6e0e33c430f15eae29d02222.png)

我是 Obj-C 的新手，但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:55:41.417

看起来您将按钮的框架设置为比图像高。这不起作用，因为“f”看起来不太好拉伸。最好的解决方案是将按钮的框架设置为与图像相同的高度（36 像素）。但是，如果需要，请像这样设置插图：

```
UIEdgeInsetsMake(4, 36, 31, 35) 
```

这将在“f”上方和圆角下方拉伸蓝线，将徽标留在左下方。（插入顺序为上、右、下、左。）

# ios - iOS UIWebView 禁止拉出边界

> ID：15694106
> 
> 赞同：1
> 
> 时间：2013-03-28T23:44:06.343
> 
> 标签：ios, uiwebview

当我通过 WebView 应用程序打开或关闭移动版网站时，我可以在页面内容之外看到默认的灰色背景。如何禁止此操作以使用户无法将页面拖出页面内容边框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:40:26.410

您无法删除灰色区域，您可以禁用滚动，这似乎是最好的方法。

我们目前在 UIWebView 上设置了透明背景

```
webview.opaque = NO;
webview.backgroundColor = [UIColor clearColor]; 
```

在 HTML 中

```
<body topmargin=0 leftmargin=0 rightmargin=0 bottommargin=0style="background-color:transparent"> 
```

# java - 如何在 jFrame 上布局多个面板？（爪哇）

> ID：15694107
> 
> 赞同：18
> 
> 时间：2013-03-28T23:44:10.513
> 
> 标签：java, swing, layout, jframe, jpanel

![想要布局](../Images/31b0eab5aab3a8d7c486bf03d7f0712f.png)

我正在制作自己的 java socket 游戏。我的游戏在全屏上画得很好（它说“在这里画图形”，但我现在画到整个jframe）。我想添加一个带有滚动条的文本框，**仅**显示文本，不接受任何输入，另一个文本框从用户那里获取文本输入，然后添加一个按钮来发送文本，用于聊天目的。但是关于我的问题，我什至如何开始布局呢？我知道我需要一个布局，但是有人可以帮助我吗？这是我现在的代码（这段代码目前只设置了对整个屏幕的绘画，现在需要像上图那样划分屏幕）：

```
public class Setup extends JFrame implements Runnable{
     JPanel panel;
     JFrame window;
     public Setup(Starter start, JFrame window){
         window.setSize(600,500);
         window.setLocationRelativeTo(null);
         window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
         window.setResizable(false);
         panel = new Display(start);
         this.window = window;
     }
     public void run(){
         window.getContentPane().add(panel);
         window.setBackground(Color.BLACK);
         window.setVisible(true);
     }
} 
```

“新显示（开始）” - 这扩展了 jpanel，它基本上是我绘制所有图形的地方。

此外，我看到人们添加了不同的面板，但我不能让它们的大小相同。就像图片中一样，“在此处绘制图形”面板是最大的面板，以此类推。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-29T00:13:01.387

`JPanel`实际上只是一个容器，您可以在其中放置不同的元素（甚至是其他元素）`JPanels`。因此，在您的情况下，我建议您将一个大`JPanel`的作为您窗口的某种*主要容器*。您分配的那个*主面板*`Layout`适合您的需要（[这里是对布局的介绍](http://docs.oracle.com/javase/tutorial/uiswing/layout/index.html)）。

将布局设置到*主面板*后，您可以添加*绘图面板*和您想要的其他 JPanel（如其中包含文本的那些..）。

```
 JPanel mainPanel = new JPanel();
  mainPanel.setLayout(new BoxLayout(mainPanel, BoxLayout.Y_AXIS));

  JPanel paintPanel = new JPanel();
  JPanel textPanel = new JPanel();

  mainPanel.add(paintPanel);
  mainPanel.add(textPanel); 
```

这只是垂直（Y 轴）对所有*子面板进行排序的示例。*因此，如果您想要在 mainPanel 底部的一些其他东西（可能是一些图标或按钮）应该与另一个布局（如水平布局）一起组织，只需*再次*创建一个新的 JPanel 作为所有其他东西的容器并设置`setLayout(new BoxLayout(mainPanel, BoxLayout.X_AXIS)`.

您会发现，布局非常严格，可能很难为您的面板找到最佳布局。所以不要放弃，阅读介绍（上面的链接）并查看图片 - 这就是我的做法:)

或者您可以只使用 NetBeans 来编写您的程序。你有一个非常简单的可视化编辑器（拖放）来创建各种窗口和框架。（之后才理解代码......有时很棘手。）

# 编辑

由于有很多人对这个问题感兴趣，我想提供一个完整的示例来说明如何布局 JFrame 以使其看起来像 OP 想要的那样。

该类称为**MyFrame**并扩展了 swings **JFrame**

```
public class MyFrame extends javax.swing.JFrame{

    // these are the components we need.
    private final JSplitPane splitPane;  // split the window in top and bottom
    private final JPanel topPanel;       // container panel for the top
    private final JPanel bottomPanel;    // container panel for the bottom
    private final JScrollPane scrollPane; // makes the text scrollable
    private final JTextArea textArea;     // the text
    private final JPanel inputPanel;      // under the text a container for all the input elements
    private final JTextField textField;   // a textField for the text the user inputs
    private final JButton button;         // and a "send" button

    public MyFrame(){

        // first, lets create the containers:
        // the splitPane devides the window in two components (here: top and bottom)
        // users can then move the devider and decide how much of the top component
        // and how much of the bottom component they want to see.
        splitPane = new JSplitPane();

        topPanel = new JPanel();         // our top component
        bottomPanel = new JPanel();      // our bottom component

        // in our bottom panel we want the text area and the input components
        scrollPane = new JScrollPane();  // this scrollPane is used to make the text area scrollable
        textArea = new JTextArea();      // this text area will be put inside the scrollPane

        // the input components will be put in a separate panel
        inputPanel = new JPanel();
        textField = new JTextField();    // first the input field where the user can type his text
        button = new JButton("send");    // and a button at the right, to send the text

        // now lets define the default size of our window and its layout:
        setPreferredSize(new Dimension(400, 400));     // let's open the window with a default size of 400x400 pixels
        // the contentPane is the container that holds all our components
        getContentPane().setLayout(new GridLayout());  // the default GridLayout is like a grid with 1 column and 1 row,
        // we only add one element to the window itself
        getContentPane().add(splitPane);               // due to the GridLayout, our splitPane will now fill the whole window

        // let's configure our splitPane:
        splitPane.setOrientation(JSplitPane.VERTICAL_SPLIT);  // we want it to split the window verticaly
        splitPane.setDividerLocation(200);                    // the initial position of the divider is 200 (our window is 400 pixels high)
        splitPane.setTopComponent(topPanel);                  // at the top we want our "topPanel"
        splitPane.setBottomComponent(bottomPanel);            // and at the bottom we want our "bottomPanel"

        // our topPanel doesn't need anymore for this example. Whatever you want it to contain, you can add it here
        bottomPanel.setLayout(new BoxLayout(bottomPanel, BoxLayout.Y_AXIS)); // BoxLayout.Y_AXIS will arrange the content vertically

        bottomPanel.add(scrollPane);                // first we add the scrollPane to the bottomPanel, so it is at the top
        scrollPane.setViewportView(textArea);       // the scrollPane should make the textArea scrollable, so we define the viewport
        bottomPanel.add(inputPanel);                // then we add the inputPanel to the bottomPanel, so it under the scrollPane / textArea

        // let's set the maximum size of the inputPanel, so it doesn't get too big when the user resizes the window
        inputPanel.setMaximumSize(new Dimension(Integer.MAX_VALUE, 75));     // we set the max height to 75 and the max width to (almost) unlimited
        inputPanel.setLayout(new BoxLayout(inputPanel, BoxLayout.X_AXIS));   // X_Axis will arrange the content horizontally

        inputPanel.add(textField);        // left will be the textField
        inputPanel.add(button);           // and right the "send" button

        pack();   // calling pack() at the end, will ensure that every layout and size we just defined gets applied before the stuff becomes visible
    }

    public static void main(String args[]){
        EventQueue.invokeLater(new Runnable(){
            @Override
            public void run(){
                new MyFrame().setVisible(true);
            }
        });
    }
} 
```

请注意，这只是一个示例，并且有多种方法可以布置窗口。这完全取决于您的需求以及您是否希望内容可调整大小/响应。另一个非常好的方法是[GridBagLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)，它可以处理相当复杂的布局，但学习起来也相当复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:25:13.977

您将需要使用许多布局管理器来帮助您实现所需的基本结果。

查看[A Visual Guide to Layout Managers](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)进行比较。

您可以使用 a`GridBagLayout`但它是 JDK 中可用的最复杂（也是最强大）的布局​​管理器之一。

您可以改用一系列复合布局管理器。

我会使用 , 将图形组件和文本区域放在一个`JPanel`, 中`BorderLayout`，图形组件在 中`CENTER`，文本区域在`SOUTH`位置。

`JPanel`我会使用 a将文本字段和按钮单独放置`GridBagLayout`（因为这是我能想到的最简单的实现你想要的结果的方法）

我会将这两个面板放在第三个主面板上，使用 a `BorderLayout`，第一个面板位于该位置`CENTER`，第二个面板位于该`SOUTH`位置。

但这就是我

# asp.net - Crystal Report ASP.net 应用程序中的内存泄漏

> ID：15694109
> 
> 赞同：1
> 
> 时间：2013-03-28T23:44:11.553
> 
> 标签：asp.net, memory-leaks, crystal-reports-2008

我有一个在带有 iis7 的 Windows 2008 R2 SP1 上运行的简单应用程序。应用程序加载一个水晶报表，然后使用 printtoprinter 方法将报表打印到打印机。一切正常，但 w3wp.exe 失控。在我不得不手动回收之前，它达到了 2GB。大约有 8 人使用该站点向打印机打印至少 2K 的报告。

打印报告后，我正在使用 ReportDocument 对象的 .Close 和 .Dispose 。使用 ASP.net 3.5

```
Using rptDoc As New ReportDocument

        rptDoc.Load(FilePackList)
        rptDoc.SetDataSource(data)
        rptDoc.PrintOptions.PrinterName = DropDownPackList.Text
        rptDoc.PrintToPrinter(nCopies, False, 0, 0)
        rptDoc.Close()
        rptDoc.Dispose()
    End Using 
```

关于为什么它会扼杀我的记忆的任何帮助？

# mysql - Django ManyToManyField 无法创建“通过”表

> ID：15694111
> 
> 赞同：2
> 
> 时间：2013-03-28T23:44:21.857
> 
> 标签：mysql, django, manytomanyfield, syncdb

我的电子商务网站有一个 models.py 定义了 3 个模型。最初，它只定义了两个`Product`和`Category`，但我意识到我需要能够用某些关键字标记我的产品，所以我添加了那个模型。当我尝试创建`syncdb`新`tag`表但不是`products_tags`“通过”表时出现了问题。

```
class Category(models.Model):
    **a bunch of variables**

    class Meta:
        db_table = 'categories'
        ordering = ['name']
        verbose_name_plural = 'Categories'

    def __unicode__(self):
        return self.name

    @models.permalink
    def get_absolute_url(self):
        return ('catalog_category', (), { 'category_slug': self.slug })

class Tag(models.Model):
    **a bunch of variables**

    class Meta:
        db_table = 'tags'
        ordering = ['name']
        verbose_name_plural = 'Tags'

    def __unicode__(self):
        return self.name

class Product(models.Model):
    **a bunch of variables**
    categories = models.ManyToManyField(Category, related_name='cat+')
    tags = models.ManyToManyField(Tag, related_name='tag+')

    class Meta:
        db_table = 'products'
        ordering = ['-created_at']

    def __unicode__(self):
        return self.name 
```

这一切都得到了很好的验证，当我运行时，`python manage.py syncdb`所有表都是使用适当的行和类型以及您期望的所有其他内容创建的。除了，由于类中建立了 ManyToMany 关系，它不会创建`products_tags`您期望它创建的表`Product`。为什么它成功地创建了`products_categories`“通过”表而不是那个`products_tags`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T19:17:53.833

正如 Aamir 在评论中所说，syncdb 没有迁移功能，这就是为什么没有创建新的直通表的原因。我安装了 django south，现在更新表格完全符合预期。

# python - 为什么 HTTP POST 请求正文需要在 Python 中进行 JSON 编码？

> ID：15694120
> 
> 赞同：33
> 
> 时间：2013-03-28T23:45:29.670
> 
> 标签：python, http, python-requests

我在使用外部 API 时遇到了这个问题。我将我的身体数据作为字典直接发送到请求中，并收到 400 个错误：

```
data = {
  "someParamRange": {
    "to": 1000, 
    "from": 100
  }, 
  "anotherParamRange": {
    "to": True, 
    "from": False
  }
} 
```

当我添加一个 json.dumps 包装时，它可以工作：

```
data = json.dumps({
  "someParamRange": {
    "to": 1000, 
    "from": 100
  }, 
  "anotherParamRange": {
    "to": True, 
    "from": False
  }
}) 
```

我不完全理解为什么这是必要的，因为字典和 JSON 对象在语法上是相同的。有人可以帮助我了解这里的幕后情况吗？

为了完整起见，这是我的标题：

```
headers = {'API-KEY': 'blerg', 'Accept-Encoding': 'UTF-8', 'Content-Type': 'application/json', 'Accept': '*/*', 'username': 'user', 'password': 'pwd'} 
```

编辑：

我之前没有提到这一点，但现在我觉得它可能是相关的。我正在使用 Python Requests 库，另一篇文章似乎建议您永远不必将参数编码为请求对象：[https ://stackoverflow.com/a/14804320/1012040](https://stackoverflow.com/a/14804320/1012040)

“无论是 GET/POST，您都不必再次对参数进行编码，它只需要一个字典作为参数就可以了。”

似乎不需要序列化？

我的请求对象：

```
response = requests.post(url, data=data, headers=headers) 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-29T03:06:18.560

显然，您的 API 需要 JSON 编码而不是表单编码的数据。当您将 a`dict`作为`data`参数传入时，数据是表单编码的。当您传递一个字符串（如 的结果`json.dumps`）时，数据不是形式编码的。

考虑请求文档中的这句话：

> > 通常，您希望发送一些表单编码的数据——很像 HTML 表单。为此，只需将字典传递给 data 参数。发出请求时，您的数据字典将自动进行表单编码。
> > 
> > 很多时候，您希望发送未进行表单编码的数据。如果您传入一个字符串而不是一个字典，则该数据将直接发布。
> > 
> > 例如，GitHub API v3 接受 JSON 编码的 POST/PATCH 数据：

```
>>> import json
>>> url = 'https://api.github.com/some/endpoint'
>>> payload = {'some': 'data'}

>>> r = requests.post(url, data=json.dumps(payload)) 
```

参考：

*   [http://www.w3.org/TR/html401/interact/forms.html#h-17.13.3.4](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.3.4)
*   [http://docs.python-requests.org/en/latest/user/quickstart/#more-complicated-post-requests](http://docs.python-requests.org/en/latest/user/quickstart/#more-complicated-post-requests)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T23:51:19.037

虽然它们在语法上看起来是有区别的：JSON 是序列化对象的字符串表示；在这种情况下 Python 字典。在此示例中，您需要以字符串形式发送序列化数据，因此需要 json.dumps 来执行序列化。

**编辑**

正如对该问题的评论中所建议的那样，它与使用的 API 相关，但是序列化必须在沿途某处进行，以通过线路发送对象。

# gruntjs - Grunt concat 失败并显示“无法找到本地 grunt”

> ID：15694121
> 
> 赞同：1
> 
> 时间：2013-03-28T23:45:30.810
> 
> 标签：gruntjs

我已经成功安装了 Grunt `npm install -g grunt-cli。

我还成功地安装了 grunt-contrib-concat 库，如下所示：`npm install grunt-contrib-concat --save-dev`

我创建了一个`package.json`：

```
{
  "name": "my-project-name",
  "version": "0.1.0",
  "devDependencies": {
    "grunt": "~0.4.1",
    "grunt-contrib-jshint": "~0.1.1",
    "grunt-contrib-nodeunit": "~0.1.2"
  }
} 
```

和一个`Gruntfile.js`：

```
module.exports = function(grunt) {

grunt.initConfig({
  pkg: grunt.file.readJSON('package.json'),
  concat: {
    options: {
      separator: ';'
    },
    dist: {
      src: ['src/init.js', 'src/Game.js', 'ui/Ui.js', 'ui/AddBTS.js', 'ui/Toolbar.js'],
      dest: 'built.js'
    }
  }
});

grunt.loadNpmTasks('grunt-contrib-concat');

}; 
```

现在，当我运行时`grunt concat`，出现以下错误：

*致命错误：无法找到本地咕噜声。如果您看到此消息，则说明未找到 Gruntfile 或未将 grunt 安装到您的项目本地。有关安装和配置 grunt 的更多信息，请参阅入门指南：*

这是我第一次使用 Grunt，我已经尝试解决这个问题超过 2 小时。请有人可以帮助我并告知我没有正确设置的内容。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T06:21:43.470

很可能 Grunt 没有本地安装在您的项目文件夹中（这与 grunt-cli 不同）。你有它在你的 package.json 所以尝试做`npm install`或 交替`npm install grunt`。

有关更多信息，请参阅[入门](http://gruntjs.com/getting-started)页面：

> 请注意，安装`grunt-cli`不会安装 grunt 任务运行器！grunt CLI 的工作很简单：运行已安装在`Gruntfile`. 这允许在同一台机器上同时安装多个版本的 grunt。

# c - 在 K&R 1.9 最长线示例中，getchar() 是做什么的？

> ID：15694122
> 
> 赞同：3
> 
> 时间：2013-03-28T23:45:39.213
> 
> 标签：c, kernighan-and-ritchie

我现在似乎理解了这个程序，除了这个`getline`函数不是很直观，因为它似乎将所有内容复制`getchar()`到一个字符数组`s[]`中，而这个字符数组从未真正用于任何重要的事情。

```
int getline(char s[], int lim)
{
    int c, i;
    for(i=0; i < lim - 1 && (c = getchar()) != EOF && c != '\n'; ++i)
        s[i] = c;
    if(c == '\n')
    {
        s[i] = c;
        ++i;
    }
    s[i] = '\0';
    return i;
} 
```

该函数可以很容易地忽略该行`s[i] = c;`，因为该函数实际上所做的只是计算字符数，直到它到达`EOF`或`'\n'`返回`getchar()`

我真正不明白的是为什么程序向前推进，因为主循环如下：

```
main()
{
    int len; /* current line length */
    int max; /* maximum length seen so far */
    char line[MAXLINE]; /* current input line */
    char longest[MAXLINE]; /* longest line saved here */

    max = 0;
    while ((len = getline(line, MAXLINE)) > 0)
        if (len > max)
        {
            max = len;
            copy(longest, line);
        }
    if (max > 0) /* there was a line */
        printf("%s", longest);
    return 0;
} 
```

唯一的解释是，`getchar()`在用户输入整行文本并`enter`按下键后，该功能会发挥作用。所以它似乎在运行时工作是我的猜测。

这是程序的进展方式吗？程序是不是先进入while循环，然后等待用户输入一行文本，一旦用户敲回车，`getline`就迭代函数的for循环？我觉得情况就是这样，因为用户可以在输入`backspace`期间输入。

我的问题是，该计划到底是如何推进的？都是因为`getchar()`功能吗？

当我在终端中点击`ctrl`-`D`时，会发生其他一些令人困惑的事情。如果我在换行符的开头点击`ctrl`- ，程序将终止。`D`如果我在填充了一些文本的行的末尾点击`ctrl`- `D`，它不会终止，并且它的行为方式与点击`enter`. 如果我在一行文本中点击`ctrl`-`D`几次，程序最终将结束。

这只是我的终端处理会话的方式，还是如果我只想学习 C 语言，这些都是我不应该担心的？

我问的原因是我喜欢跟踪程序以更好地理解它，但是`getchar()`函数使这很棘手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:57:14.730

`getchar`从标准输入中读取一个字符。所以如果你坐在终端上，它会阻塞程序，直到它收到你输入的字符，然后它就完成了。但是标准输入在交互时是行缓冲的，因此在您按 Enter 之前，程序不会处理您键入的内容。这意味着`getchar`它将能够继续读取您键入的所有字符，因为它们是从缓冲区中读取的。

您对功能有误。数组被传递给函数*，它将读取的每个字符`getchar`（EOF 或换行符除外）存储在连续的元素中。这就是重点——不是计算字符，而是将它们存储在数组中。

（*实际上传递了一个指针，但是这里的函数仍然可以将其视为一个数组。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T00:03:59.220

In a parameter declaration (and *only* in that context), `char s[]` really means `char *s`. The way the C standard describes this is that:

> A declaration of a parameter as "array of *type*" shall be adjusted to "qualified pointer to *type*".

So `s` really is a pointer, of type `char*`, and when the function modifies `s[i]` it's modifying the `i`th element of `line`.

On the call:

```
getline(line, MAXLINE) 
```

`line` is an array, but in most contexts an array expression is implicitly converted to a pointer to the array's first element.

这两条规则似乎是为了让数组和指针在 C 语言中*看起来*真的是一回事。它们绝对不是。指针对象包含某个对象的地址（或不指向任何对象的空指针）；数组对象包含有序的元素序列。但是在 C 中对数组的大多数操作都是通过指向数组元素的指针来完成的，指针算法用于从一个元素前进到下一个元素。

推荐阅读（我说了很多）：[comp.lang.c FAQ](http://www.c-faq.com/)的第 6 部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T23:53:48.063

该数组*用于*重要的事情：它由调用者提供并使用新内容修改返回。从合理的角度来看，填充数组是调用函数的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T23:50:26.580

该数组（数组引用）实际上是一个指针，char s[] 与 char *s 相同。所以它在那个数组中构建它的结果，这就是它稍后在 main 中复制的原因。K&R 中很少有任何“魔法”。

# c++ - 将字符拆分为字符指针数组

> ID：15694124
> 
> 赞同：0
> 
> 时间：2013-03-28T23:45:48.817
> 
> 标签：c++, arrays, pointers, char

我正在尝试将一行 80 个字符的输入拆分为一个数组，其中每个元素都指向一个字符字符串。本质上，将 char a[80] 转为“Hello world！” 进入 char* b[64] 其中 b[0] 指向“Hello”，b[1] 指向“world！”

基本上， strsep() 将允许我使用以下代码：

```
while((cmd->argv[argc++] = strsep(clPtr, WHITESPACE)) != NULL); 
```

我想知道如何修改此代码：

```
int parse(char* comm, char** commarray) {
  int count = 0;
  char word[80] = "";
  char ch[2] = {' ', '\0'};

  if(strlen(comm) == 0) {
    commarray[0] = "NULL";
    return 0;
  }

  for(size_t i = 0; i < strlen(comm); i++) {
    int c = int(comm[i]);
    if(!isspace(c)) {
      ch[0] = comm[i];
      strcat(word, ch);
      if(i == (strlen(comm) - 1)) {
        commarray[count] = word;
        cout << commarray[count] << endl;
        count++;
      }
    }
    else if(isspace(c) && word != "") {
      commarray[count] = word;
      cout << commarray[count] << endl;
      word[0] = '\0';
      count++;
    }
  }

 return 1;
}

//main
int main() {
  char command[80];
  char* args[64];

  while(true) {
    cout << "order>";
    cin.getline(command, 80);

    if(strcmp(command, "quit") == 0 || strcmp(command, "exit") == 0) {
      break;
    }

    parse(command, args);

    cout << args[0] << endl;

    if(strcmp(args[0], "quit") == 0 || strcmp(args[0], "exit") == 0) {
      break;
    }

    /*for(int i = 0; i < 3; i++) {
        cout << args[i] << endl;
    }*/
  }
  return 0;
} 
```

main() 中的变量 args 不显示变量 commarray 在 parse() 中的作用。相反，我会胡言乱语。为什么是这样？我认为传递数组默认是通过引用传递？对于 commarray，我得到了适当的指向字符串的指针数组（我认为）。对于 args，我没有得到任何可用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T23:59:06.363

指针地狱就是你所在的地方。我可以看到代码至少有两个基本问题，但可能还有更多。

1）您将所有作业重用为 commarray。因此，您最终会得到 commarray 中的所有指针都指向同一个字数组。显然那是行不通的。

2）当您退出解析函数时，单词数组不再在范围内，因此它成为无效内存。因此，您的所有 args 数组指针都指向同一块无效（因此是垃圾）内存。

我的建议是，停止使用指针，开始使用 C++，即 std::string 类，它的行为比任何指针都更具逻辑性和直观性。

# ruby - 从超类型对象创建 ruby 对象

> ID：15694132
> 
> 赞同：1
> 
> 时间：2013-03-28T23:46:30.880
> 
> 标签：ruby, factory, subtype

我在 Ruby 中使用 Selenium Webdriver 库。一段典型的代码如下所示：

```
require 'rubygems'
require 'selenium-webdriver'
driver = Selenium::WebDriver.for :firefox 
# driver is an instance of Selenium::WebDriver::Driver

url = 'http://www.google.com/'
wait = Selenium::WebDriver::Wait.new(:timeout => 10)
driver.get(url)
wait.until { driver.title.start_with? "Google" } 
```

我想创建一个`Selenium::WebDriver::Driver`被调用的子类`Selenium::WebDriver::Driver::MyClass`，它将包含一些新方法和实例变量。

如上面的代码所示，`Selenium::WebDriver::Driver`创建实例的方式是使用`Selenium::WebDriver.for`.

如果不批量复制代码，我如何创建一个`Selenium::WebDriver.for`与?`Selenium::WebDriver.for``Selenium::WebDriver::Driver::MyClass`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T05:50:10.440

检查[源代码](http://code.google.com/p/selenium/source/browse/rb/lib/selenium/webdriver/common/driver.rb#26)。`Selenium::WebDriver.for`只需将方法调用委托给`Selenium::WebDriver::Driver.for`.

如果您没有附加侦听器，您可以简单地创建自己的网桥`MyClass::Bridge.new`，然后将其传递给`Selenium::WebDriver::Driver.new`.

如果您坚持重写该`for`方法，这里有一些代码片段可能会有所帮助。

```
module Selenium
  module WebDriver
    class Driver
      class << self
        alias_method :old_for, :for
        def for(browser, opts = {})
          if browser == :myclass
            # create your MyClass::Bridge instance and pass that to new()
          else
            old_for(browser, opts)
          end
        end
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T02:59:24.537

为什么不直接覆盖`Selenium::WebDriver.for`? 让我告诉你我的一个例子

```
# selenium code
module Selenium
  class WebDriver
    def self.for
      puts "creating oldclass"
    end
  end
end

# your code
class Selenium::WebDriver
  def self.for
    puts "creating myclass"
  end
end

Selenium::WebDriver.for 
```

输出：

```
creating myclass 
```

安全的替代方法是派生类`Selenium::WebDriver`并在您的代码中使用它，或者极端情况下您可以打开 Driver 类并将您的行为添加到其中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-05T18:00:49.310

如果您只想在驱动程序上定义一些额外的方法，则无需覆盖 WebDriver.for。

以下对我来说效果很好：

首先，在文件 customdriver.rb 中

```
require 'selenium-webdriver'
class CustomDriver < Selenium::WebDriver::Driver 
  #a custom method..
  def click_on (_id)
    element = find_element :id => _id
    element.click
  end 
  #add other custom methods here
  #....
end 
```

然后，在文件 main.rb

```
require-relative 'customdriver'
driver = CustomDriver.for :chrome
driver.click_on("buttonID") 
```

问候，

# amazon-s3 - 来自 s3cmd 的 POST 或 PUSH 操作在某个 Internet 连接上失败

> ID：15694134
> 
> 赞同：5
> 
> 时间：2013-03-28T23:46:43.580
> 
> 标签：amazon-s3, s3cmd

我目前正在自动化构建脚本以将资源推送到 Amazon s3 并使用[http://s3tools.org/s3cmd](http://s3tools.org/s3cmd)（和[https://github.com/s3tools/s3cmd](https://github.com/s3tools/s3cmd)），我理解这是正常/主命令行使用的工具。没什么太复杂的，而且我在办公室外完成了大部分测试，但是一旦我进入那里，整个事情就开始分崩离析，我很困惑为什么。

一个简单的命令，例如（'mybucket' 存在于 s3 上，'file.ext' 存在于我运行命令的目录中），

```
s3cmd put file.ext s3://mybucket/ 
```

都失败了

```
[Errno 104] Connection reset by peer 
```

或者

```
[Errno 32] Broken pipe 
```

我知道 s3 存在超过 5GB 大小的文件的问题，但这些文件远不及这个，它们小于 1MB，更不用说超过 1GB。真正奇怪的是，另一个程序[http://www.bucketexplorer.com/](http://www.bucketexplorer.com/)运行良好，在同一个网络上执行完全相同的操作。

*更*奇怪的是测试所有内容，我将笔记本电脑连接到手机的 3G 连接，立即一切正常，当我回到家，再次测试命令时，它再次完美运行。

关于使用 s3cmd 而不是 Bucket Explorer 在我们的工作网络上可能导致此错误的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-10T09:01:39.537

此错误可能有很多原因，例如[TCP 窗口缩放](https://bugs.launchpad.net/ubuntu/+source/linux-source-2.6.17/+bug/59331/comments/11)（或[这个](http://scie.nti.st/2008/3/14/amazon-s3-and-connection-reset-by-peer/)）和 [DNS 传播](https://www.jacobtomlinson.co.uk/2014/07/31/amazon-s3-s3cmd-put-errno-32-broken-pipe/)。我能够通过使用 5MB 的小多部分块大小来解决这个问题：

```
s3cmd put --multipart-chunk-size=5 file.ext s3://mybucket/ 
```

# objective-c - 在 Objective-C 中模拟指向指针的指针

> ID：15694136
> 
> 赞同：4
> 
> 时间：2013-03-28T23:46:52.850
> 
> 标签：objective-c, mocking, ocmock

我正在尝试模拟对 NSURLConnection 的调用。我用我自己的调用我的模拟对象的类方法调用来调和类方法调用。我正在尝试像这样实现模拟：

```
[[[[urlConnectionMock expect] andDo:^(NSInvocation *invocation) {
    NSURLResponse * __autoreleasing *responsePointer;
    [invocation getArgument:&responsePointer atIndex:3];
    id response = [OCMockObject niceMockForClass:NSHTTPURLResponse.class];
    [[[response stub] andReturnValue:OCMOCK_VALUE((NSInteger){ 200 })] statusCode];
    *responsePointer = response;
}] andReturn:encryptedResponse] sendSynchronousRequest:OCMOCK_ANY returningResponse:OCMOCK_ANY error:OCMOCK_ANY]; 
```

问题是 OCMOCK_ANY 是一个 Objective-C 指针，而不是指向指针的指针（编译器正确地抱怨）。在我更深入地研究 OCMock 源之前，也许有人可以建议如何解决这个问题？如果您完全有更好的方法，则给予全额奖励。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T17:26:43.643

弄清楚了。引用已经内置在 OCMock 中。

```
id fakeResponse = [OCMockObject niceMockForClass:NSHTTPURLResponse.class];
[[[fakeResponse stub] andReturnValue:OCMOCK_VALUE((NSInteger){ 200 })] statusCode];
[[[urlConnectionMock expect] andReturn:encryptedResponse] sendSynchronousRequest:OCMOCK_ANY returningResponse:[OCMArg setTo:fakeResponse] error:[OCMArg setTo:nil]]; 
```

这看起来也更快乐！

# image - 更快地转换为 WebP

> ID：15694137
> 
> 赞同：1
> 
> 时间：2013-03-28T23:47:00.627
> 
> 标签：image, converter, webp

我尝试使用[WebP 转换器](https://developers.google.com/speed/webp/)将图像转换为 WebP 格式，但转换一张图像大约需要 1-2 秒。我有大约 70 张图像，我想在一分钟内转换它们。有没有更快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T09:36:43.270

'cwebp -lossless -q 0 -m 1' 在[https://developers.google.com/speed/webp/docs/webp_lossless_alpha_study](https://developers.google.com/speed/webp/docs/webp_lossless_alpha_study)中用于快速无损压缩。对于 1000 个随机采样的 PNG 图像的网络语料库，平均每张图像需要 19 毫秒。

这些图像有多大？你用什么电脑来转换？图像中有 alpha 通道吗？你转换成无损还是有损？您使用的是哪个版本的 cwebp？

# ruby-on-rails-3 - 使用 RSpec 测试多个自定义验证器

> ID：15694141
> 
> 赞同：0
> 
> 时间：2013-03-28T23:47:09.423
> 
> 标签：ruby-on-rails-3, validation, rspec

我正在尝试为两个自定义验证器运行规范：

```
spec/validators/email_validator_spec.rb
spec/validators/phone_validator_spec.rb 
```

当我运行规范失败`bundle exec rspec spec/validators/`时：`phone_validator_spec.rb`

```
1) PhoneValidator with a valid phone number should be valid
     Failure/Error: subject.should be_valid
       expected valid? to return true, got false
     # ./spec/validators/phone_validator_spec.rb:20:in `block (4 levels) in <top (required)>'
     # ./spec/validators/phone_validator_spec.rb:18:in `each'
     # ./spec/validators/phone_validator_spec.rb:18:in `block (3 levels) in <top (required)>' 
```

但是，当我使用 command 单独运行该规范时`bundle exec rspec spec/validators/phone_validator_spec.rb`，它通过了。

当我使用命令删除`email_validator_spec.rb`then`phone_validator_spec.rb`通行证时`bundle exec rspec spec/validators/`。

我希望这两个规格在我运行时都能通过`bundle exec rspec spec/validators/`。谁能向我解释发生了什么？

**更新：** 使用 zetetic 的提示打印出错误哈希：

```
1) PhoneValidator with a valid phone number should be valid
     Failure/Error: subject.errors.should == {}
       expected: {}
            got: #<ActiveModel::Errors:0x37b2460 @base=#<Validatable:0x37b2700 @validation_context=nil, @errors=#<ActiveModel::Errors:0x37b2460 ...>, @phone_number="1112223333">, @messages={:email=>["is invalid"]}> (using ==)
       Diff:
       @@ -1 +1,8 @@
       +#<ActiveModel::Errors:0x37b2460
       + @base=
       +  #<Validatable:0x37b2700
       +   @errors=#<ActiveModel::Errors:0x37b2460 ...>,
       +   @phone_number="1112223333",
       +   @validation_context=nil>,
       + @messages={:email=>["is invalid"]}>
     # ./spec/validators/phone_validator_spec.rb:21:in `block (4 levels) in <top (required)>'
     # ./spec/validators/phone_validator_spec.rb:18:in `each'
     # ./spec/validators/phone_validator_spec.rb:18:in `block (3 levels) in <top (required)>' 
```

`Validatable`当两个规范都运行时，类定义似乎被合并了。这种行为是预期的吗？如果我使用不同的类名，两个规范都会通过。

**规范/验证器/phone_validator_spec.rb**

```
require 'active_model'
require 'rspec/rails/extensions'
require File.expand_path('app/validators/phone_validator')

class Validatable
  include ActiveModel::Validations
  attr_accessor :phone_number
  validates :phone_number, phone: true
end

describe PhoneValidator do

  subject { Validatable.new }

  describe "with a valid phone number" do
    it "should be valid" do
      phone_numbers = ["1112223333", "123222ABCD"]
      phone_numbers.each do |phone_number|
        subject.phone_number = phone_number
        subject.should be_valid
      end
    end 
  end
end 
```

**应用程序/验证器/phone_validator.rb**

```
class PhoneValidator < ActiveModel::EachValidator
  def validate_each(object, attribute, value)
    return if value.blank?
    unless value =~ /^[A-Za-z0-9]{10}$/
      object.errors[attribute] << (options[:message] || "is not formatted properly")
    end
  end
end 
```

**规范/验证器/email_validator_spec.rb**

```
require 'active_model'
require 'rspec/rails/extensions'
require File.expand_path('app/validators/email_validator')

class Validatable
  include ActiveModel::Validations
  attr_accessor :email
  validates :email, email: true
end

describe EmailValidator do

  subject { Validatable.new }

  describe "with a valid email address" do
    it "should be valid" do
      addresses = %w[user@foo.COM A_US-ER@f.b.org frst.lst@foo.jp a+b@baz.cn]
      addresses.each do |valid_address|
        subject.email = valid_address
        subject.should be_valid
      end
    end
  end

  describe "with an invalid phone number" do
    it "should be invalid" do
      addresses = %w[user@foo,com user_at_foo.org example.user@foo]
      addresses.each do |invalid_address|
        subject.email = invalid_address
        subject.should be_invalid
      end
    end
  end
end 
```

**应用程序/验证器/email_validator.rb**

```
require 'mail'

class EmailValidator < ActiveModel::EachValidator
  def validate_each(object, attribute, value)
    begin
      m = Mail::Address.new(value)
      # We must check that value contains a domain and that value is an email address
      r = m.domain && m.address == value
      t = m.__send__(:tree)
      # We need to dig into treetop
      # A valid domain must have dot_atom_text elements size > 1
      # user@localhost is excluded
      # treetop must respond to domain
      # We exclude valid email values like <user@localhost.com>
      # Hence we use m.__send__(tree).domain
      r &&= (t.domain.dot_atom_text.elements.size > 1)
    rescue => e   
      r = false
    end
    object.errors[attribute] << (options[:message] || "is invalid") unless r
  end
end 
```

使用 rails 3.2.11、rspec-rails 2.11.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:49:30.053

您的模型实例无效，但您不知道原因。尝试改变

```
subject.should be_valid 
```

到

```
subject.valid?
subject.errors.should == {} 
```

现在失败消息将打印出错误哈希。

另一个提示：[不要拯救 Exception](http://www.mikeperham.com/2012/03/03/the-perils-of-rescue-exception/)。

编辑

*当两个规范都运行时，似乎 Validatable 类定义被合并。这种行为是预期的吗？*

是的，这对于 Ruby 类来说是正常的。当两个规范文件都需要时，每个`Validatable`类主体都会被执行，所以你最终会得到一个包含两个验证的类。

您需要通过使主题通过未测试的验证来隔离验证，例如：

```
subject { Validatable.new(:email => "some value") } 
```

或测试来自被测验证的特定错误消息：

```
subject.valid?
subject.errors(:email).should include("is invalid") 
```

PS。说真的——不要拯救异常。不会有什么好事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-03T16:03:46.713

我自己遇到了这个问题，是的，您可以重命名该类，但我使用的解决方案是在您的规范中创建和拆除 Validatable 类。

这是一个代码片段：

```
describe "HttpUriValidator",
  "Custom validator to ensure URL is a valid URI." do

  # Create the dummy class once when the test is run.
  before(:all) do
    class Validatable
      include ActiveModel::Validations
      attr_accessor  :url
      validates :url, http_uri: true
    end
  end
  # Must tearing down the class or it will taint other tests using its
  # name.
  after(:all) { Object.send(:remove_const, :Validatable) }

  subject { Validatable.new } 
```

编辑：：

当您声明一个包装您的测试类的模块（以避免在测试中对其他类进行命名空间）时，请注意。

```
module Foo::Bar
  describe Something do
    after(:all) { Foo::Bar.send(:remove_const, :Testable) }
  end
end 
```

您将不得不从该命名空间中删除常量，而不是 Object。

# java - Java：CoreAnimation：911 x 34488 图像对于软件渲染器来说太大，忽略

> ID：15694143
> 
> 赞同：1
> 
> 时间：2013-03-28T23:47:21.790
> 
> 标签：java, user-interface, resize, rsa

当我尝试通过鼠标调整窗口大小时，为什么 Java 会冻结并抛出“ **CoreAnimation: 911 by 34488 image is too large for software renderer, ignoring ”错误？**

这是一个原始的 RSA 加密解密类，具有更原始的 UI。

```
import java.io.*;
import java.math.*;
import java.util.*;
import java.util.List;
import java.security.*;

import javax.swing.*;
import java.awt.*;

public class rsa {
    private final static SecureRandom random = new SecureRandom();

    private static BigInteger privateKey;
    private static BigInteger publicKey;
    private static BigInteger modulus;

    rsa(int N) {
        BigInteger p = BigInteger.probablePrime(N / 2, random);
        BigInteger q = BigInteger.probablePrime(N / 2, random);
        BigInteger phi = (p.subtract(new BigInteger("1"))).multiply(q.subtract(new BigInteger("1")));

        modulus = p.multiply(q);
        publicKey = new BigInteger("65537");
        privateKey = publicKey.modInverse(phi);
    }

    BigInteger encrypt(BigInteger message) {
        return message.modPow(publicKey, modulus);
    }

    BigInteger decrypt(BigInteger encrypted) {
        return encrypted.modPow(privateKey, modulus);
    }

    public static void main(String[] args) throws IOException {
        int N = Integer.parseInt("2048");
        rsa key = new rsa(N);

        String tocode = "Even though I walk through the valley of the shadow of death, I will fear no evil, for you are with me; your rod and your staff, they comfort me.";

        BigInteger intcode = new BigInteger(tocode.getBytes());
        BigInteger encrypt = key.encrypt(intcode);
        BigInteger decrypt = key.decrypt(encrypt);

        Iterator<String> parcelIt = parcel(intcode, 10).iterator();

        gui(tocode, intcode, encrypt, decrypt, N, parcelIt);
    }

    public static List<String> parcel(BigInteger inputInteger, int size) {
        String inputString = inputInteger.toString();
        List<String> parcelled = new ArrayList<String>();
        parcelled.add(Arrays.toString(inputString.split("(?<=\\G.{" + size + "})")));
        return parcelled;
    }

    public static void gui(String tocode, BigInteger intcode, BigInteger encrypt, BigInteger decrypt, int N, Iterator<String> parcelIt) {
        JTextArea textarea = new JTextArea(0, 0);
        textarea.setLineWrap(true);
        textarea.setWrapStyleWord(true);
        Font font = new Font("Helvetica", Font.PLAIN, 9);
        textarea.setFont(font);
        textarea.setForeground(new Color(0x88, 0x88, 0xff));
        textarea.setBackground(new Color(0x30, 0x30, 0x30));

        textarea.append("Modulus:\n" + modulus + "\n\n");
        textarea.append("Public key:\n" + publicKey + "\n\n");
        textarea.append("Private key:\n" + privateKey + "\n\n");
        textarea.append("Message in String:\n" + tocode + "\n\n");
        textarea.append("Message in BigInteger:\n" + intcode + "\n\n");

        textarea.append("Parcels: (for test only)\n");
        while (parcelIt.hasNext()) {
            String value = (String) parcelIt.next();
            textarea.append(value + ", ");
        }

        textarea.append("\n\nEncrpyted message:\n" + encrypt + "\n\n\n\n");
        textarea.append("Decrypted in BigInteger:\n" + decrypt + "\n\n");
        textarea.append("Decrypted in String:\n" + new String(decrypt.toByteArray()) + "\n\n");

        JFrame frame = new JFrame("RSA-" + N);
        frame.add(textarea);
        frame.setSize(900, 500);
        Dimension windowSize = frame.getSize();
        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        int windowX = Math.max(0, (screenSize.width  - windowSize.width ) / 2);
        int windowY = Math.max(0, (screenSize.height - windowSize.height) / 2);
        frame.setLocation(windowX, windowY);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
} 
```

**编辑：**

**堆栈跟踪：**

```
2013-03-29 00:59:42.707 java[38707:707] java.lang.OutOfMemoryError: can't create offscreen surface
    at sun.java2d.opengl.OGLSurfaceData.initSurfaceNow(OGLSurfaceData.java:298)
    at sun.java2d.opengl.OGLSurfaceData.access$000(OGLSurfaceData.java:98)
    at sun.java2d.opengl.OGLSurfaceData$1.run(OGLSurfaceData.java:324)
    at sun.java2d.opengl.OGLRenderQueue$QueueFlusher.run(OGLRenderQueue.java:234)
2013-03-29 00:59:42.709 java[38707:707] (
    0   CoreFoundation                      0x00007fff8cdd7b06 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8c81b3f0 objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff8ce6bf49 -[NSException raise] + 9
    3   JavaNativeFoundation                0x0000000124065539 JNFCallVoidMethod + 209
    4   liblwawt.dylib                      0x0000000124ef4f77 -[AWTWindow _deliverMoveResizeEvent] + 310
    5   CoreFoundation                      0x00007fff8cd89eda _CFXNotificationPost + 2554
    6   Foundation                          0x00007fff91d48e26 -[NSNotificationCenter postNotificationName:object:userInfo:] + 64
    7   AppKit                              0x00007fff8eb0a4ce -[NSWindow _setFrameCommon:display:stashSize:] + 2322
    8   AppKit                              0x00007fff8f253a69 -[NSWindow(NSWindowResizing) _resizeWithEvent:] + 1587
    9   AppKit                              0x00007fff8f059de9 -[NSTitledFrame mouseDown:] + 189
    10  AppKit                              0x00007fff8f0577fe -[NSThemeFrame mouseDown:] + 281
    11  AppKit                              0x00007fff8ebc053e -[NSWindow sendEvent:] + 6853
    12  liblwawt.dylib                      0x0000000124ef2e33 -[AWTWindow_Normal sendEvent:] + 86
    13  AppKit                              0x00007fff8ebbc674 -[NSApplication sendEvent:] + 5761
    14  libosxapp.dylib                     0x000000012481cad1 -[NSApplicationAWT sendEvent:] + 179
    15  AppKit                              0x00007fff8ead224a -[NSApplication run] + 636
    16  libosxapp.dylib                     0x000000012481c9b9 +[NSApplicationAWT runAWTLoopWithApp:] + 156
    17  liblwawt.dylib                      0x0000000124ee4a5a -[AWTStarter starter:] + 1591
    18  Foundation                          0x00007fff91d92d3a __NSThreadPerformPerform + 225
    19  CoreFoundation                      0x00007fff8cd56b31 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 17
    20  CoreFoundation                      0x00007fff8cd56455 __CFRunLoopDoSources0 + 245
    21  CoreFoundation                      0x00007fff8cd797f5 __CFRunLoopRun + 789
    22  CoreFoundation                      0x00007fff8cd790e2 CFRunLoopRunSpecific + 290
    23  java                                0x000000010b5264bc CreateExecutionEnvironment + 871
    24  java                                0x000000010b520cac JLI_Launch + 1952
    25  java                                0x000000010b526819 main + 101
    26  java                                0x000000010b520504 start + 52
    27  ???                                 0x0000000000000005 0x0 + 5
) 
```

# java - 设置 mappedEndpoints 时未命中 Spring 解析器

> ID：15694146
> 
> 赞同：0
> 
> 时间：2013-03-28T23:47:29.030
> 
> 标签：java, spring, spring-ws

当我在下面设置映射端点时，解析器`customizeFault`方法没有被命中。如果我删除它，它会被击中。有什么帮助吗？在我的解析器类中引发了异常。

**MembershipManagementEndpoint.java**

```
package com.openclass.adapter.ws;

@Endpoint
public class MembershipManagementEndpoint { 
```

**弹簧配置**

```
<bean id="membershipExceptionResolver" class="com.openclass.adapter.ws.resolvers.LisMembershipResolverInterceptor">
        <property name="order" value="1"></property>
        <property name="mappedEndpoints">
            <set>
                <value>com.openclass.adapter.ws.MembershipManagementEndpoint</value>
            </set>
        </property>
    </bean> 
```

**LisSoapFaultTranslatorExceptionResolver.java**

```
 package com.openclass.adapter.ws.resolvers;
    public class LisMembershipResolverInterceptor extends LisSoapFaultTranslatorExceptionResolver {

@Override
    public boolean handleRequest(MessageContext messageContext, Object endpoint)
            throws Exception {

            throw new LisMembershipException();

        return true;
    } 
```

**LisSoapFaultTranslatorExceptionResolver.java**

```
public abstract class LisSoapFaultTranslatorExceptionResolver extends
        SimpleSoapExceptionResolver implements SoapEndpointInterceptor { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T20:54:13.363

我添加为每个端点构建单独的拦截器/解析器，然后在拦截器/解析器中进行测试并测试正确的端点。

**SoapFaultExceptionResolver**

```
 @Override
    protected final boolean resolveExceptionInternal(MessageContext messageContext, Object endpoint, Exception ex) {

        MethodEndpoint methodEndpoint = (MethodEndpoint)endpoint;

        if(methodEndpoint != null && methodEndpoint.getBean().getClass().getSimpleName().equalsIgnoreCase(getEndpointClass().getSimpleName()))
            {
            Assert.isInstanceOf(SoapMessage.class, messageContext.getResponse(),
                    "SimpleSoapExceptionResolver requires a SoapMessage");
            SoapMessage response = (SoapMessage) messageContext.getResponse();
            String faultString = StringUtils.hasLength(ex.getMessage()) ? ex.getMessage() : ex.toString();
            SoapBody body = response.getSoapBody();
            SoapFault fault = body.addServerOrReceiverFault(faultString, getLocale());
            customizeFault(messageContext, endpoint, ex, fault);
            return true;
        }

        return false;
    } 
```

**配置**

```
<bean id="courseSectionExceptionResolver" class="com.test.adapter.ws.resolvers.LisCourseSectionResolverInterceptor">
        <property name="order" value="1"></property>
    </bean>  

    <bean id="personExceptionResolver" class="com.test.adapter.ws.resolvers.LisPersonResolverInterceptor">
        <property name="order" value="2"></property>
    </bean> 

    <bean id="membershipExceptionResolver" class="com.test.adapter.ws.resolvers.LisMembershipResolverInterceptor">
        <property name="order" value="3"></property>
    </bean> 

    <bean id="bdemsExceptionResolver" class="com.test.adapter.ws.resolvers.LisBdemsResolverInterceptor">
        <property name="order" value="4"></property>
    </bean>  

    <bean id="outcomeExceptionResolver" class="com.test.adapter.ws.resolvers.LisOutcomeResolverInterceptor">
        <property name="order" value="5"></property>
    </bean>  

    <sws:interceptors>
        <sws:payloadRoot namespaceUri="http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p0">
            <bean class="com.test.adapter.ws.resolvers.LisCourseSectionResolverInterceptor"/>
        </sws:payloadRoot>
        <sws:payloadRoot namespaceUri="http://www.imsglobal.org/services/lis/pms2p0/wsdl11/sync/imspms_v2p0">
            <bean class="com.test.adapter.ws.resolvers.LisPersonResolverInterceptor"/>
        </sws:payloadRoot>
        <sws:payloadRoot namespaceUri="http://www.imsglobal.org/services/lis/mms2p0/wsdl11/sync/imsmms_v2p0">
            <bean class="com.test.adapter.ws.resolvers.LisMembershipResolverInterceptor"/>
        </sws:payloadRoot>
        <sws:payloadRoot namespaceUri="http://www.imsglobal.org/services/lis/bdems1p0/wsdl11/sync/imsbdems_v1p0">
            <bean class="com.test.adapter.ws.resolvers.LisBdemsResolverInterceptor"/>
        </sws:payloadRoot>
        <sws:payloadRoot namespaceUri="http://www.imsglobal.org/services/lis/oms1p0/wsdl11/sync/imsoms_v1p0">
            <bean class="com.test.adapter.ws.resolvers.LisOutcomeResolverInterceptor"/>
        </sws:payloadRoot>
        <bean class="org.springframework.ws.server.endpoint.interceptor.PayloadLoggingInterceptor">
            <property name="logRequest" value="true"/>
            <property name="logResponse" value="true"/>
        </bean>
    </sws:interceptors> 
```

# objective-c - 通过数据库更新移动到情节提要中的视图

> ID：15694147
> 
> 赞同：0
> 
> 时间：2013-03-28T23:47:36.150
> 
> 标签：objective-c

我存储数据的方法位于 AppDelegate 中。每当数据保存到数据库中时，我都想检查 SecondView 是否可见。
如果是，则从数据库重新加载屏幕上的值。如果没有，我将在屏幕上显示具有最新值的视图。

我正在尝试这样的事情：

委托人.m

```
 //  I want to update view
  UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
  SecondViewController *SecondVC = (SecondViewController *)[storyboard instantiateViewControllerWithIdentifier:@"SecondVC"];
  if (SecondVC.isVisible)
  {
    NSLog(@"SecondVC is visible");
    [SecondVC updateDisplayValue];

  }
  else
  {
    self.window.rootViewController = SecondVC;
    NSLog(@"SecondVC not visible");
  } 
```

第二视图控制器.m

```
 - (BOOL)isVisible {
    return [self isViewLoaded] && self.view.window;
  }

- (void)updateDisplayValue
{
  [self LatestMeasurementFromSQLite];
  [self.date setText:self.measurementTime];
} 
```

它不能正常工作， isVisible never return 是可见的，并且 updateDisplayValue 不会更新已经显示的视图。

我认为问题在于我重新启动了一个名为 SecondVC 的新视图，它不是屏幕上显示的视图。但是 AppDelegate 如何获取当前的显示视图呢？

请帮忙！非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:46:14.340

在您检查 SecondVC.isVisible 时，它​​是不可见的，因为您刚刚创建了它，并且它的视图尚未加载。我不确定如何纠正它——这取决于你的控制器结构。是应用程序委托中的第一段代码吗？

# wpf - 从 DataContext 创建静态资源？

> ID：15694149
> 
> 赞同：0
> 
> 时间：2013-03-28T23:47:50.640
> 
> 标签：wpf, mvvm, datacontext, staticresource

全部，

是否可以从 DataContext 中的对象创建一个 StaticResource（不添加代码隐藏）？以 UserControl 的 DependencyProperty 为例：

```
public static DependencyProperty ViewModelProperty = DependencyProperty.Register("ViewModel", typeof(IVMHeaderGeneric), typeof(UIHeader), new FrameworkPropertyMetadata(null, FrameworkPropertyMetadataOptions.AffectsRender));
public IVMHeaderGeneric ViewModel
{
    get
    {
        return (IVMHeaderGeneric)this.GetValue(ViewModelProperty);
    }
    set
    {
        this.SetValue(ViewModelProperty, value);
    }
} 
```

`IVMHeaderGeneric`是一个由该用户控件的使用者实例化为类的接口。

我需要做的是，以某种方式（最好没有代码隐藏）将其添加到 UserControl 的资源中，从而允许我对不继承 DataContext 的 UIElements 执行数据绑定（即想到 DataGridColumn）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T04:35:01.927

我认为您无法在**xaml资源中创建****接口**实例，因为正如您所说，实现超出了**UserControl**范围。

 ****您可以使用**Binding**来引用**UserControl** DataContext 属性，而不是创建**StaticResource 。**例如，如果您给出根元素的名称，您可以编写以下内容：****`Root`****

 ****```
<DataGridColumn SomeDependencyProperty="{Binding ElementName=Root, Path=ViewModel.Property}" /> 
```********

# ruby - 如何根据 Ruby 中的键值对之一按降序对散列的行进行排序？

> ID：15694155
> 
> 赞同：-1
> 
> 时间：2013-03-28T23:48:32.280
> 
> 标签：ruby, sorting, hash

我有以下哈希：

```
lines[0] = {"a" => dog, "b" => 32, "c" =>555, "d" => 100}
lines[1] = {"a" => cat, "b" => 34, "c" =>554, "d" => 4542}
lines[2] = {"a" => bird, "b" => 31, "c" =>532435, "d" => 23} 
```

我想按“b”按降序对哈希进行排序，以便最终得到：

```
lines[0] = {"a" => cat, "b" => 34, "c" =>554, "d" => 4542}
lines[1] = {"a" => dog, "b" => 32, "c" =>555, "d" => 100}
lines[2] = {"a" => bird, "b" => 31, "c" =>532435, "d" => 23} 
```

实现这一目标的最佳方法是什么？Ruby 中有没有一种方法可以为您做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:00:58.143

```
lines.sort_by! {|hash| -hash["b"]} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T02:54:37.203

您似乎有一种**特殊**情况，其中行不是数组而是哈希，因此您希望根据值的顺序为每个键重新分配值，首先从哈希中创建数组，对其进行排序，然后根据新索引，例如

```
lines = {}
lines[0] = {"a" => :dog, "b" => 32, "c" =>555, "d" => 100}
lines[1] = {"a" => :cat, "b" => 34, "c" =>554, "d" => 4542}
lines[2] = {"a" => :bird, "b" => 31, "c" =>532435, "d" => 23}

require 'pp'
pp Hash[lines.map.sort_by {|k,v| -v["b"]}.map.with_index {|v, index| [index, v[1]]}] 
```

输出是：

```
{0=>{"a"=>:cat, "b"=>34, "c"=>554, "d"=>4542},
 1=>{"a"=>:dog, "b"=>32, "c"=>555, "d"=>100},
 2=>{"a"=>:bird, "b"=>31, "c"=>532435, "d"=>23}} 
```

也就是说，为什么行是哈希？它可以更好地用一个数组来表示

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T23:57:24.793

你可以做

```
lines.sort! { |a, b| b["b"] <=> a["b"] } 
```

# actionscript-3 - 使用 ActionScript 3 访问 Google AppEngine Cloud Endpoints？

> ID：15694156
> 
> 赞同：2
> 
> 时间：2013-03-28T23:48:33.090
> 
> 标签：actionscript-3, google-app-engine, google-cloud-endpoints

有没有人知道使用 ActionScript 3 访问 Google AppEngine Cloud Enpoints 而无需通过 JavaScript 层的方法？我一直在 docs 和 Google 上查找任何教程或示例，但没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:56:16.973

我们没有 AS3 客户端库，目前据我所知没有任何计划，因此您必须依靠 HTTP 来进行 REST 调用。

# TLDR；使用 API 资源管理器

如果您访问

```
https://your-app-id.appspot.com/_ah/api/explorer 
```

（替换`your-app-id`为您的实际应用程序 ID），然后您将被重定向到您自己的自定义版本的 Google APIs Explorer。

在其中，您可以单击各个 API 并查看所有可用方法的列表。在每种方法的页面中，您可以尝试形成请求，资源管理器将建议使用正确的值。

单击“执行”后，完整的 HTTP 请求（标头和所有）和响应将打印在您的页面上，其中将显示要使用的命令。

# 说明如何使用发现文档

API 的发现文档将包含构建请求所需的所有信息。

要查找调用 API 的根目录，请查看`baseUrl`密钥。它应该是这样的：

```
https://your-app-id.appspot.com/_ah/api/tictactoe/v1/ 
```

为了弄清楚如何调用特定方法，每个方法都有描述，作为资源嵌套在 Discovery Document 中。例如，对于井字游戏[Python 示例](https://github.com/GoogleCloudPlatform/appengine-endpoints-tictactoe-python)，该`board_get_move`方法在装饰器中有一个`name`of 。这意味着该方法归资源所有。`board.getmove``@endpoints.api``getmove``board`

如果您查看`resources.board.methods`发现文档中的密钥，您可以看到该`getmove`方法：

```
"getmove": {
 "id": "tictactoe.board.getmove",
 "path": "board",
 "httpMethod": "POST",
 "description": "Exposes...",
 "request": {
  "$ref": "TictactoeApiMessagesBoardMessage"
 },
 "response": {
  "$ref": "TictactoeApiMessagesBoardMessage"
 }
} 
```

结合我们知道的`path`请求`baseUrl`将需要发送到

```
https://your-app-id.appspot.com/_ah/api/tictactoe/v1/board 
```

从`httpMethod`我们知道请求将使用 HTTP 方法`POST`。

最后，为了指定请求，我们看到了对模式的引用：

```
"$ref": "TictactoeApiMessagesBoardMessage" 
```

查看发现文档中的`schemas.TictactoeApiMessagesBoardMessage`密钥，我们看到：

```
"TictactoeApiMessagesBoardMessage": {
 "id": "TictactoeApiMessagesBoardMessage",
 "type": "object",
 "description": "ProtoRPC message definition to represent a board.",
 "properties": {
  "state": {
   "type": "string"
  }
 }
} 
```

所以我们知道有效负载必须包含一个名为的字段`state`，并且该字段必须是一个字符串。

# ruby-on-rails - Soundcloud oEmbed 仅适用于 http，不适用于 https；所有网址都是 https

> ID：15694157
> 
> 赞同：1
> 
> 时间：2013-03-28T23:48:36.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, soundcloud, discourse

**更新**

此问题已由 Discourse 团队修复，不再是问题。无需阅读，享受与朋友或家人在一起的乐趣。

* * *

我正在处理一些我想嵌入到话语留言板中的 soundcloud 文件。url 是 https，但是当您使用 https 访问 soundcloud enpoint 时，会导致 500。例如，url [https://soundcloud.com/smitty1138/the-ink-spots-maybe](https://soundcloud.com/smitty1138/the-ink-spots-maybe)

在此处查看更多信息：http: [//meta.discourse.org/t/curious-about-onebox-and-soundcloud-support/5365](http://meta.discourse.org/t/curious-about-onebox-and-soundcloud-support/5365)

**编辑 1**

所以你可以在这里看到一个例子：http: [//foodiespot.com/t/category-definition-for-favorite-restaurants/4](http://foodiespot.com/t/category-definition-for-favorite-restaurants/4)

和：

![在此处输入图像描述](../Images/a43d379e9bba7c4d8bcefc91898aeb10.png)

正如您在 chrome 中看到的那样，Discourse 正在使用发送 https 请求的 onebox。他们如何发出 https 请求可能存在问题。

很可能是 url 如何编码的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T10:53:43.320

此问题已由 Discourse 团队修复，不再是问题

# java - ListCellRendererComponent() 方法更新 JList 的所有对象（元素），类似于上次添加的元素

> ID：15694159
> 
> 赞同：0
> 
> 时间：2013-03-28T23:48:45.907
> 
> 标签：java, swing, jlabel, jlist, listcellrenderer

嗨，我实现了一个`JList`包含`JLabel`s 作为元素的。我的目标是为服务器/客户端聊天应用程序实现联系人列表。因此，当客户端连接到服务器时，JList 将构建以显示他/她的联系人列表。我选择使用 JLabels 因为它们也可以有图标和文本。但是，我在覆盖 cellrenderer 方法时遇到了一些麻烦。每当客户端联机/脱机时，JList 都会更新其状态并将所有项目设置为类似于最后添加的项目。是这样的，

这是第一次将离线状态客户端添加到一个人的朋友列表中；

![在此处输入图像描述](../Images/54d2fd4721c100cd7797344d151b3315.png)

之后，这是第二次添加不同的客户端

![在此处输入图像描述](../Images/95ad841b1586ae8504a3f5355dd0e65e.png)

最后第三次...

![在此处输入图像描述](../Images/99119ecdb2d00d86b4ac77ffcfa1257b.png)

此外，我记得在教程中提到 JList 覆盖痛苦方法并在列表发生更改时一次又一次地绘制整个元素。好吧，实际上我是这个渲染主题的新手，这件事变得非常烦人。在这里你可以看到我的渲染器类； [渲染器示例](http://codepaste.net/79fg2y)

并在我的主类中以这种方式将元素添加到模型中

```
labelSetText = tempon.getNickName();
onlineStatus = tempon.isIsOnline();
model.addElement(createPanel()); 
```

并且还`createPanel()`返回一个类似的 JLabel；

```
public static JLabel createPanel() {
    JLabel panel = new JLabel();
    return panel;
} 
```

我希望我已经清楚我的问题。我必须实现这一点，当联系人更改他/她的状态或添加联系人时，此操作不应影响其他元素。我将非常感谢您的每一个答案（如果您可以添加简短的解释说明您所做的事情和原因，我将不胜感激。）无论如何，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:12:34.993

您不应该将诸如`JLabel`into之类的组件放入`JList`. 相反，使用模型来保存数据并添加渲染器来自定义呈现。有关一些示例，请参见[如何使用列表](http://docs.oracle.com/javase/tutorial/uiswing/components/list.html)。

这是添加图标的渲染器的一个非常基本的示例：

```
import java.awt.BorderLayout;
import java.awt.Component;
import javax.swing.*;

public class TestUserList {
    public static class UserRenderer extends DefaultListCellRenderer {
        @Override
        public Component getListCellRendererComponent(JList list, Object value,
                int index, boolean isSelected, boolean hasFocus) {
            if (value instanceof UserEntry) {
                UserEntry user = (UserEntry) value;
                JLabel label = (JLabel) super.getListCellRendererComponent(
                        list, user.getName(), index, isSelected, hasFocus);
                if (user.isOnline())
                    label.setIcon(UIManager
                            .getIcon("OptionPane.informationIcon"));
                else
                    label.setIcon(UIManager.getIcon("OptionPane.errorIcon"));
                return label;
            }
            return super.getListCellRendererComponent(list, value, index,
                    isSelected, hasFocus);
        }
    }

    public TestUserList() {
        JFrame frame = new JFrame("User List");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final JList list = new JList();

        JScrollPane scrollPane = new JScrollPane(list);
        JPanel content = new JPanel(new BorderLayout());
        content.add(scrollPane, BorderLayout.CENTER);
        final DefaultListModel model = new DefaultListModel();
        model.addElement(new UserEntry("John", true));
        model.addElement(new UserEntry("Jesse", false));
        list.setModel(model);

        list.setCellRenderer(new UserRenderer());

        frame.add(content);
        frame.setLocationByPlatform(true);
        frame.pack();
        frame.setVisible(true);
    }

    public class UserEntry {
        private String name;
        private boolean online;

        public UserEntry(String name, boolean online) {
            super();
            this.name = name;
            this.online = online;
        }

        public String getName() {
            return name;
        }

        public Boolean isOnline() {
            return online;
        }
    }

    public static void main(String args[]) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TestUserList();
            }
        });
    }
} 
```

# java - 无法实例化类型迭代器 >

> ID：15694161
> 
> 赞同：1
> 
> 时间：2013-03-28T23:49:17.033
> 
> 标签：java, arraylist, iterator, instantiation

```
ArrayList<ArrayList<Integer>> wordIndex = new ArrayList<ArrayList<Integer>>(Collections.<ArrayList<Integer>>nCopies(initWord.length(), null)); 

// Populate it.

Iterator<ArrayList<Integer>> iterWordIndex = new Iterator<ArrayList<Integer>>(); 
```

为什么我不能这样做？

```
 Cannot instantiate the type Iterator<ArrayList<Integer>> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:50:33.057

因为`Iterator`是接口。您不能创建它的实例。您需要创建实现该接口的具体类的实例（但大多数情况下，您只是从现有集合中获取引用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T23:50:41.470

你不能实例化一个，`Iterator`因为`Iterator`它是一个接口。您只能实例化具体类。在这种情况下，让`ArrayList`生成器为您生成一个：

```
Iterator<ArrayList<Integer>> iterWordIndex = wordIndex.iterator(); 
```

# ios - 如何使 CABasicAnimation 在 superLayer 边界之外不可见？

> ID：15694163
> 
> 赞同：0
> 
> 时间：2013-03-28T23:49:31.830
> 
> 标签：ios, uiview, uibezierpath, cabasicanimation

我正在尝试将一个三角形从 UIView 边界之外移动到 UIView 区域。

我正在使用 UIBezierPath。

虽然三角形在该区域之外，但我希望它是不可见的。我只希望 UIView 内部的三角形部分可见。

不幸的是，它在整个动画中都是可见的（在边界之外和内部）。

这是我的代码：

```
UIBezierPath *triangle = [UIBezierPath bezierPath];
[triangle moveToPoint:CGPointMake(X, Y)];
[triangle addLineToPoint:CGPointMake(X - (width*0.5), Y)];
[triangle addLineToPoint:CGPointMake(X, Y + (width*0.5))];
[triangle closePath];
CAShapeLayer *triLayer = [CAShapeLayer layer];
triLayer.frame = testView.bounds;
triLayer.path = triangle.CGPath;
triLayer.strokeColor = [[UIColor redColor] CGColor];
triLayer.fillColor = [[UIColor yellowColor] CGColor];

[testView.layer addSublayer:triLayer];

CABasicAnimation *triangleAnimation = [CABasicAnimation animationWithKeyPath:@"transform.translation.x"];
triangleAnimation.duration=0.5;
triangleAnimation.repeatCount=1;
triangleAnimation.autoreverses=NO;

triangleAnimation.fromValue=[NSNumber numberWithFloat:(width*0.5)];
triangleAnimation.toValue=[NSNumber numberWithFloat:0];
triangleAnimation.removedOnCompletion = NO;
triangleAnimation.fillMode = kCAFillModeForwards;

[triLayer addAnimation:triangleAnimation forKey:@"animateLayer"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T23:51:08.583

如果您有对 superview 本身的引用，则可以将其`clipsToBounds`上的属性设置为`YES`. 否则，您可以使用`CALayer`'`masksToBounds`属性来做同样的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T23:51:22.337

采用

```
testView.layer.masksToBounds = YES; 
```

# mongodb-php - PHP Mongodb 驱动程序在使用身份验证在 Mongo 2.4.0 上运行 MongoDB->execute() 时出现“未经授权”错误

> ID：15694165
> 
> 赞同：1
> 
> 时间：2013-03-28T23:49:34.043
> 
> 标签：mongodb-php

我在使用以下代码时遇到问题：

```
$m = new MongoClient('mongodb://sf:xxxxxx@localhost/sf');
$collections = $m->selectDB("sf")->getCollectionNames();
var_dump($collections); // prints collection names as expected

$collections = $m->selectDB("sf")->execute('function (){ return db.getCollectionNames(); }');
var_dump($collections); // gives error "unauthorized" 
```

这已被转载于：

Mongo 2.4.0，MongoDB PHP 驱动程序 1.3.6，PHP 版本 5.3.8，Windows 7 32 位

Mongo 2.4.0，MongoDB PHP 驱动程序 1.3.5，PHP 版本 5.3.2，Ubuntu 10.04.4

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:54:02.250

PHP 的执行只是调用 eval 的包装器，需要管理员访问权限才能使用。

从文档中：

```
With authentication enabled, eval will fail during the operation
if you do not have the permission to perform a specified task.
Changed in version 2.4: You must have full admin access to run. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-23T00:50:09.533

检查 MongoDB 的连接字符串。如果它包含数据库，请尝试将其删除。例如：

mongodb://sf:[pass]@localhost/sf

到

mongodb://sf:[pass]@localhost/

完成此操作后，在使用身份验证实例化客户端后选择数据库。我相信这应该允许您使用该功能。我相信它会导致对 admin 集合而不是指定的集合进行身份验证，可能会提供对此功能的访问。

# mysql - 错误：表 xxx 的表空间存在。请在 IMPORT 之前丢弃表空间

> ID：15694168
> 
> 赞同：155
> 
> 时间：2013-03-28T23:49:53.377
> 
> 标签：mysql, macos, navicat, tablespace

我对 MySQL 还很陌生，遇到了一个非常有趣的错误，我无法通过 google 和 stackoverflow 搜索找到任何帮助。

我在 MacOS 10.8.3 上运行 MySQL 5.6.10 的本地服务器，并通过 Navicat Essentials for MySQL 管理我的数据库。

我得到的错误是，在运行和管理我的数据库几天/几周后，某些东西会触发（它看起来不完整）删除我使用 Navicat 中的查询创建的一些表。

当我尝试使用这些表运行查询时，Navicat 会警告我该特定表不存在。到目前为止一切顺利 - 这是好的部分：

当我尝试创建以前存在的表（例如名为“temp”）时，我收到以下错误消息：

```
Error : Tablespace for table '`database`.`temp`' exists. Please DISCARD the tablespace before IMPORT. 
```

但是，如果我尝试删除表，或者尝试丢弃该表的表空间，请使用

```
DROP TABLE temp;
ALTER TABLE temp DISCARD TABLESPACE; 
```

我收到以下错误消息：

```
Error : Unknown table 'database.temp'
Error : Table 'database.temp' doesn't exist 
```

所以这意味着我被建议丢弃表空间，但是当我尝试这样做时，表不存在。是否有可能在 DISCARD 查询未检查的不同位置存在该表的某种类型的残余？有没有人知道什么会触发所有这些 - 看起来完全随机？

正如我所说，我是这个主题的新手，而且几乎一无所知。我怀疑重新启动我的笔记本电脑，即重置我的本地 MySQL 服务器，或者用户权限可能与它有关，但我只是在这里假设。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2014-02-11T02:47:48.957

这里有点晚了，但通常我已经看到当您在“innodb_file_per_table”模式下运行时出现“表空间已满”错误时会出现此问题。无需赘述（更多细节[在这里](http://dev.mysql.com/doc/refman/5.5/en/innodb-parameters.html#sysvar_innodb_data_file_path)），数据库服务器的表空间由 innodb_data_file_path 设置定义，默认情况下相当小。即使做得更大，“表空间已满”仍然可能发生在更大的查询等情况下（大量非表“东西”存储在那里，撤消日志，缓存等......）。

无论如何，我发现如果你查看存储每个表文件的操作系统目录，在 OSX 上默认为 /var/lib/mysql，使用 homebrew iirc 的 /usr/local/var/mysql，你会发现孤立的 tablename.ibd 文件，没有正常的伴随 tablename.frm 文件。如果您将该 .ibd 文件移动到一个安全的临时位置（为了安全起见），应该可以解决问题。

```
$ ls /var/lib/mysql

table1.frm
table1.idb
table2.frm
table2.idb
table3.idb <- problem table, no table3.frm
table4.frm
table4.idb

$ mkdir /tmp/mysql_orphans
$ mv /var/lib/mysql/table3.ibd /tmp/mysql_orphans/ 
```

不过需要注意的是，请确保最初导致问题的原因，例如长时间运行的查询、锁定的表等......已被清除。否则，当您第二次尝试时，您只会得到另一个孤立的 .ibd 文件。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2014-06-08T15:59:22.820

**Xampp 和 Mamp 用户**

通过 MySQL 导入数据库（清空数据库后）时出现同样的错误。我发现我`tablename.ibd`留下了一个文件，而所有其他文件都被删除了。我手动删除了它`mysql/data/database_name`，错误消失了。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2016-09-23T02:30:37.557

**如果`.idb`删除后再次重新创建，请阅读此答案。**

这就是我的工作方式。我有`.idb`没有对应文件`.frm`的文件，每当我删除`.idb`文件时，数据库都会重新创建它。[我在 MySQL文档](http://dev.mysql.com/doc/refman/5.6/en/innodb-troubleshooting-datadict.html)的一行中找到了解决方案（**表空间不存在**部分）

> > 1- 在其他一些数据库目录中创建一个匹配的 .frm 文件，并将其复制到孤立表所在的数据库目录中。
> > 
> > 2- 为原始表发出 DROP TABLE。这应该会成功删除表，并且 InnoDB 应该在错误日志中打印 .ibd 文件丢失的警告。

我复制了另一个表`.frm`文件并将其命名为我丢失的表，然后进行正常的删除表查询，瞧，它工作正常，表被正常删除！

*我的系统是 Windows MariaDB v 10.1.8 上的 XAMPP*

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2015-10-13T04:51:23.663

**对于 WAMP [Windows 7 Ultimate x64-bit] 用户：**

我同意 DangerDave 所说的，因此我正在为**WAMP Users**提供答案。

> **注意：**首先，您必须转到**..\WAMP\Bin\MySQL\MySQL[Your MySQL Version]\Data**文件夹。

现在，您将看到所有数据库的文件夹

*   双击包含有问题表的数据库文件夹将其打开
*   不应该有文件`[Your offending MySQL table name].frm`，应该有文件`[Your offending MySQL table name].ibd`
*   删除`[Your offending MySQL table name].ibd`
*   然后，也将其从回收站中删除
*   然后在数据库上运行你的 MySQL 查询，你就完成了

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2019-09-12T21:05:09.743

就我而言：

首先`tableName.ibd`从 Mysql 中删除您的数据库目录并第二次运行：

```
ALTER TABLE tableName DISCARD TABLESPACE;
DROP TABLE tableName; 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-07-11T15:18:14.963

这正是我在 fedora 上的 mariadb 10.2.16 中所做的，当时我有一个表在日志文件中显示完全相同的错误，我想......

```
2018-07-11  9:43:58 140323764213504 [Note] InnoDB: The file './database_name/innodb_table.ibd' already exists though the corresponding table did not exist in the InnoDB data dictionary. You can resolve the problem by removing the file.
2018-07-11  9:44:29 140323764213504 [Warning] InnoDB: Tablespace 'database_name/innodb_table' exists in the cache with id 2836 != 2918 
```

您的里程和错误可能会有所不同，但我认为主要的是

```
...already exists though the corresponding table did not exist in the InnoDB data dictionary... 
```

删除表无法正常工作以及更改表...

```
MariaDB [database_name]> drop table innodb_table;
ERROR 1051 (42S02): Unknown table 'database_name.innodb_table'

MariaDB [database_name]> alter table innodb_table discard tablespace;
ERROR 1146 (42S02): Table 'database_name.innodb_table' doesn't exist 
```

创建表也像这样失败：

```
MariaDB [database_name]> create table  innodb_table(`id` int(10) unsigned NOT NULL);
ERROR 1813 (HY000): Tablespace for table '`database_name`.`innodb_table`' exists. Please DISCARD the tablespace before IMPORT 
```

为了解决这个问题，我首先要做的是

```
create table  innodb_table2(`id` int(10) unsigned NOT NULL);
Query OK, 0 rows affected (0.07 sec) 
```

然后在 /var/lib/mysql/database_name 目录中，我以 root 身份执行以下操作，确认覆盖 innodb_table.ibd 导致我们出现问题

```
cp -a innodb_table2.frm innodb_table.frm
cp -a innodb_table2.ibd innodb_table.ibd
systemctl restart mariadb 
```

然后回到 mysql 控制台，我在两个表上都发出了成功的 drop 命令

```
MariaDB [database_name]> drop table innodb_table;
ERROR 2006 (HY000): MySQL server has gone away
No connection. Trying to reconnect...
Connection id:    8
Current database: database_name

Query OK, 0 rows affected (0.08 sec)

MariaDB [database_name]> drop table innodb_table2;
Query OK, 0 rows affected (0.25 sec) 
```

现在一切都是方形的，我可以重新创建一张桌子......

```
MariaDB [database_name]> create table  innodb_table (`id` int(10) unsigned NOT NULL);
Query OK, 0 rows affected (0.08 sec) 
```

> 编辑：我要添加一个
> 
> ```
> restorecon -Rv /var/lib/mysql/database_name 
> ```
> 
> 复制数据库后的命令以按照应有的方式获取所有 selinux 上下文，即使我们几乎立即从数据库中删除它们，但在替代方案中，您可以将 --archive 或 -a 选项添加到两个 cp命令，所以是的，实际上存档选项缩短了这个：
> 
> ```
> cp innodb_table2.frm innodb_table.frm
> cp innodb_table2.ibd innodb_table.ibd
> chown mysql:mysql innodb_table.frm innodb_table.ibd
> chmod 660 innodb_table.frm innodb_table.ibd
> restorecon -Rv /var/lib/mysql/database_name
> systemctl restart mariadb 
> ```
> 
> 到我认为更好的以下内容，它保留为已制作的表设置的 selinux 上下文。
> 
> ```
> cp -a innodb_table2.frm innodb_table.frm
> cp -a innodb_table2.ibd innodb_table.ibd
> systemctl restart mariadb 
> ```
> 
> 我已将上述较长的命令列表替换为较短的列表，该列表仍可以用 * 来缩短

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-03-12T14:58:49.017

就我而言，唯一的工作解决方案是：

1.  创建表`bad_table`引擎 = MyISAM ...
2.  rm bad_table.ibd
3.  删除表`bad_table`

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-10-17T09:56:49.713

删除/移动 tablename.ibd 确实对我不起作用。

***我是如何解决的***

由于我要删除损坏且不存在的表，因此我通过转到 phpmyadmin->database->export->selected 表备份->export（as .sql）来备份其他表。

之后，我选择了数据库名称旁边的数据库图标，然后将其删除。创建了一个新的数据库。选择您的新数据库->导入->选择您之前下载的文件->单击导入。现在我有我的旧工作表并删除了损坏的表。现在我只创建抛出错误的表。

可能我有损坏表的早期备份。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-15T06:27:40.493

***解决方案***

但是，更简单的选择是：重新启动 MySQL，然后执行以下相同的四个步骤：

```
1) created a dummy table in the database;
2) discarded its tablespace;
3) moved the .ibd file into the database folder on the system;
4) attached the tablespace back to the table 
```

这样，数据字典上的表空间id就和文件匹配了；从而导入表空间成功。

这可以让您更有信心在恢复过程甚至文件传输期间处理一些 InnoDB“问题”。

[参考](http://mysqlhints.blogspot.in/2008/10/fixing-innodb-import-tablespace-error.html)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-04-23T21:04:19.353

在尝试创建用户表时，我在 wampserver 上运行它时遇到了同样的错误。我找到了一个 users.ibd 文件，删除该文件后，我再次运行了 migrate 命令并且它工作了。我的 windows 机器上的文件位于 wamp/bin/mysql/mysql5.6.12/data/myproject 中。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-09-12T16:42:24.347

多次遇到这个问题。如果您有一个大型数据库并且想尝试避免备份/恢复（添加了丢失的表），请来回尝试几次：

删除表 my_table;

ALTER TABLE my_table 丢弃表空间；

-和-

位于 /var/lib/mysql/my_db/ 目录中的 rm my_table.ibd（无对应 my_table.frm 的孤儿）

-接着-

如果不存在则创建表`my_table`(...)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2015-11-17T17:31:44.543

**以下是解决步骤：**

1.  备份您的数据库（带有删除选项和数据的结构）
2.  停止mysql引擎服务
3.  从 mysql/data 中手动删除数据库目录
4.  启动mysql引擎
5.  使用与损坏的数据库不同的名称创建新数据库
6.  使用新数据库中损坏的表的名称创建单个表（这是秘密）。并且最好创建具有​​完全相同结构的表。
7.  将数据库重命名为旧的损坏数据库
8.  恢复您的备份，您的表将正常工作。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2022-01-13T10:15:21.787

我遇到过同样的问题。我重命名了数据库名称并导入它。然后它工作。

**让它简单：** 只需**重命名数据库名称**。而已。

问题是现有数据库名称在您的文件夹中有一些条目。那就是问题所在。要么您需要删除所有这些相关条目，要么只是让重命名数据库变得简单

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-01-21T05:05:00.840

当您暂停某些功能时会发生此错误。就像使用不正确的外键运行下面的查询一样。

```
set foreign_key_checks=0 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-08-23T13:41:40.107

有完全相同的问题；我会添加`mysql@5.6`（之前有 5.5 之后）。

5.6 的 brew 默认值是，`innodb_file_per_table=1`而在 5.5 中它们是`innodb_file_per_table=0`.

您现有的`ibdata1`文件（组合的 innodb 数据）仍将引用您尝试创建/删除的表。要么改`innodb_file_per_table`回 0，要么删除 ibdata1 数据文件（**这会丢失你所有的数据，所以请确保你首先使用 mysqldump 或者已经有一个 .sql 转储**）。

另一个让我感到困扰的 brew`mysql@5.6`默认设置是缺少端口，因此网络默认使用 unix 套接字，并且 mysql 客户端不断报告：

```
ERROR 2013 (HY000): Lost connection to MySQL server at 'sending authentication information', system error: 32 
```

我添加`<string>--port=3306</string>`到`.plist`数组中，但您也可以`port=3306`在您的`my.cnf`

然后运行`brew services stop mysql@5.6`进行更改`brew services start mysql@5.6`

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-04-11T14:29:22.447

如果您有另一台具有相同表的良好版本的服务器，您可以制作一个副本（table_copy），将 table_copy 传输到问题服务器。然后删除问题表并将table_copy重命名为table。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-06-18T04:43:33.730

尝试删除表空间可能会给您带来其他错误。对我来说，我收到以下错误：

```
DROP TABLESPACE `tablename`

Error Code: 1478\. Table storage engine 'InnoDB' does not support the create option 'TABLESPACE or LOGFILE GROUP' 
```

我的解决方案是删除数据库。这将删除与其相关的所有表空间，并允许您再次创建表。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-12-04T11:32:57.087

对我来说，只需转到**/var/lib/mysql/{db_name}** (linux) 下的 MYSQL DATA 目录并删除与文件夹名称相同的**{table_name}.ibd文件即可。**

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2016-09-03T07:54:00.137

我只直接从 wamp 删除位于我的本地主机中的旧数据库，停止所有服务，转到 wamp/bin/mysql/mysql[version]/data 我发现有问题的数据库，我删除它并重新启动 wamp 所有服务，再次创建您的数据库并完成，现在您可以导入您的表，

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2019-08-04T10:53:34.623

它对我有用的唯一方法是：

1.  创建一个类似的表
2.  将新的相似表的 .frm 和 .idb 文件复制到损坏表的名称。
3.  修复权限
4.  重启 MariaDB
5.  删除损坏的表

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2018-04-25T17:44:04.710

我发现“解决”这个问题的方法相当烦人，但是有一个脚本可以处理它。

本质上，您需要`ibdata1`和`ib_logfile*`文件消失（它们包含外键的映射等）。唯一*安全*的方法是导出所有数据库，停止 mysql，删除文件，启动 mysql，然后导入文件。

帮助解决这个问题的脚本是[https://github.com/uberhacker/shrink-ibdata1](https://github.com/uberhacker/shrink-ibdata1)，即使这个脚本的目的不同，它*确实*解决了这个问题。

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-01-30T03:50:39.133

您可以以 mysql root 用户身份运行以下查询

```
drop tablespace `tableName` 
```

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2020-12-05T11:40:16.540

谢谢#DangerDave 这解决了我在 Magento 2 上的问题，我就是这样做的

我在vps

```
root@myvps [~]# cd /var/lib/mysql/mydatabasename/

root@myvps [~]# ls 
```

检查没有.frm fie（只有.idb）的表并删除它们，

```
rm customer_grid_flat.ibd 
```

系统将在运行 index:reindex 命令后重新生成表

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2021-02-11T21:17:36.580

如果是 Homebrew，数据文件的目录是 /usr/local/var/mysql

查看这里使用的是哪个 my.cnf 文件是从我的环境中搜索的位置 /etc/my.cnf /etc/mysql/my.cnf /usr/local/etc/my.cnf ~/.my.cnf

所以为了清理这个错误我做了以下

```
mysqladmin -u root shutdown
rm /usr/local/var/mysql/<dbname>/problemtablename.ibd 
```

注意：在我的情况下，我并不关心数据，因为它是开发设置，可能是因为我用时间机器恢复了我的笔记本电脑

* * *

## 回答 #25

> 赞同：-2
> 
> 时间：2018-06-15T06:14:29.203

**请在 IMPORT 之前丢弃表空间**

我有同样的问题解决方案如下

1.  首先，您必须删除您的数据库名称。如果您的数据库没有删除，那么您已经流向了我。对于 Windows 系统，您的目录将是 C:/xampp/mysql/data/yourdabasefolder remove "yourdabasefolder"

2.  同样，您必须创建新数据库并导入旧的 sql 文件。这将是工作

谢谢

* * *

## 回答 #26

> 赞同：-2
> 
> 时间：2018-11-13T04:03:09.177

我必须找到我的 MySQL 数据目录：

显示变量 WHERE Variable_Name LIKE "%dir"

然后强制删除该数据库：

须藤 rm -rf

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2016-10-06T05:46:17.897

如果您遇到此问题并且没有其他选项，请将引擎更改为任何其他引擎，例如“myisam”，然后尝试创建表。

**免责声明：** 这不是有效的答案，因为您可能有其他存储引擎不支持的外键约束。每个存储引擎都有自己的专长来存储和访问数据，这些点也需要考虑。

# php - 这是什么班级信息？

> ID：15694169
> 
> 赞同：0
> 
> 时间：2013-03-28T23:49:54.203
> 
> 标签：php, css, ajax, wordpress

我正在尝试对 wordpress 布局进行解码/逆向工程。我正在翻阅 CSS 文件，但无法弄清楚这么长的菜单 mumbo-jumbo 是什么！

我不是要求任何人通过代码，而是让我知道我在看什么。这些似乎不是普通的 CSS 样式元素。

```
<li id="menu-item-200" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-198 current_page_item menu-item-200">
<a href="http://themewich.com/aware/">Home Shuffle</a>
</li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:51:37.633

一个元素可以有多个类，并且类名应该用空格分隔。这是有效的课堂作业。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T23:51:42.117

它是一个应用了多个类的列表项。

# c# - 如何在 C# 中读取随机单元格并将它们打印在文本框中？

> ID：15694170
> 
> 赞同：-4
> 
> 时间：2013-03-28T23:50:00.503
> 
> 标签：c#, excel, xls, xlsx

很快就尝试了 12 小时，但我无法让它工作。我已经阅读了我能找到的所有主题，但没有任何帮助。我也尝试过使用 Excel Wrapper，但它不起作用。**我是 C# 新手，我正在尝试做一个废话生成器。**我要做的是在.xlsx 文件中从A1-A5、B1-B5 和C1-C5 中读取一堆单词，然后在单击按钮时将它们放在一个文本框中（我使用的是Visual Studio）。

如果有人读到这篇文章并能给我一个提示，那将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:06:19.507

首先，您应该将 xls 文档中的信息提取到一个集合（数组、列表等）中，此代码应该很容易在网上找到。

您还需要一个随机数生成器：

```
Random rnd = new Random(); 
```

然后，您将让按钮单击事件从您的集合（在本例中为二维数组）中选择 2 个随机数，一个用于行，一个用于列：

```
int row_max = stuff[][].GetLength(0); 
int col_max = stuff[][].GetLength(1); 
int row = rnd.Next(0, row_max-1)
int col = rnd.Next(0, col_max-1); //between 0 and the number of columns
textbox1.text = textbox1.text + stuff[row][col].ToString(); 
```

这只是指示性的，但所有部分都可以很容易地用谷歌搜索。

# android - 在 Android 中使用扩展 BroadcastReceiver 类中的方法

> ID：15694172
> 
> 赞同：0
> 
> 时间：2013-03-28T23:50:05.507
> 
> 标签：android, get, broadcastreceiver

我创建了一个类-扩展`BroadcastReceiver`，每当“事件”发生时，该类“标记”类中私人成员的当地时间，我想得到这个发生时间，
因为事件被引发，我无法得到这个标记返回值我考虑过使用类成员并为每个成员创建 get() 方法，问题是我似乎无法调用我创建的任何 getter。

# c# - 重置/重新加载当前表格

> ID：15694176
> 
> 赞同：1
> 
> 时间：2013-03-28T23:50:14.893
> 
> 标签：c#, forms, reload, reset

我一直在尝试通过关闭它并打开一个新表单来将当前表单重置为原始状态。我希望重置表单对象，重新声明变量，清除类对象等空白数据。

这是我的代码：

```
if (btnRandom.Text == "Reset")
{

    SetupScreen form = new SetupScreen();
    form.Show();
    this.Dispose();

    //Create new class for form / or launch load events as normal 
    form.Mybattleship = new battleship()
    form.SetupScreen_Load(this, null);
} 
```

我在互联网上尝试了很多方法，但都没有奏效..即使是过于复杂的..

哦，我忘了提到我需要新表单才能像正常加载一样，所以加载事件等触发

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:20:02.130

您最好创建一个可以调用的方法，该方法将为您在打开表单和重置时可以使用的项目设置默认值......

```
public SetupScreen()
{
InitializeComponent();
SetDefaultValues();
}
private void SetDefaultValues()
{
//start  values..
}
public void ResetBtn_Click(object sender, EventArgs e)
{
SetDefaultValues();
} 
```

# git - 更新文件夹中的所有存储库？

> ID：15694179
> 
> 赞同：18
> 
> 时间：2013-03-28T23:50:35.557
> 
> 标签：git, github, bitbucket

我有一个文件夹 - 'Repos' - 其中包含我感兴趣的 repos。这些是从 bitbucket 克隆的，但我猜 github 也可能是一个来源。

```
Repos
    - music-app
    - elephant-site
    - node-demo 
```

是否有一个 git 命令，我可以使用哪些步骤遍历 Repos 中的每个文件夹并查看服务器上是否有新的提交，并下载新的东西？如果本地有新的提交，则上传这些。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-28T23:53:50.093

试试这个：

```
cd repos
find . -maxdepth 1 -type d -exec sh -c '(cd {} && git pull)' ';' 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-05-09T15:19:10.350

对于 Windows，这应该通过命令提示符为您完成：

```
cd c:\repos
for /d %a in (*.*) do cd c:\repos\%a && git pull 
```

返回 GitHub 客户端后，您应该会看到更新。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-06-25T04:50:08.097

对于 Windows，我在 .cmd 文件中使用下面的内容。它可以很容易地扩展到做更多的事情或其他事情：

```
for /d %%i in (*) do (
  pushd "%%i"
  git pull
  popd
) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-13T07:01:26.377

gitfox 是一个在所有 subrepo 上执行命令的工具

npm 安装 gitfox -g

g 拉

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-05-12T07:53:49.733

使用 powershell，您可以这样做：

```
Get-ChildItem -Recurse -Depth 2 -Force | 
Where-Object { $_.Mode -match "h" -and $_.FullName -like "*\.git" } |
ForEach-Object {
  cd $_.FullName
  cd ../
  git pull
  cd ../
} 
```

这将进入每个目录并查找一个`.git`文件夹，然后`git pull`在每个文件夹中运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-28T23:56:57.393

要维护多个 repos，您可以使用 git submodule。

用于`git submodule add`将存储库添加为子模块并用于`git submodule foreach git pull`更新存储库。

这种方法就像你有一个超级项目，里面有几个 git 项目。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-30T03:05:42.120

我所拥有的是一个 scriptlet，它执行以下操作：

```
for d in *
cd $d
git pull
cd .. 
```

（是的，它有一些额外的花里胡哨，因为我有一些`hg`repos，还有一些我在 git 中从 SVN 上游管理的。）

# css - 仅使用 CSS 以网格格式对 div 进行排序

> ID：15694183
> 
> 赞同：0
> 
> 时间：2013-03-28T23:50:59.973
> 
> 标签：css, html

我在对 div 进行排序时遇到问题，我有两种类型`a, b`

```
a - should always be at the front (all a types)
b - should be following all a types. 
```

HTML：

```
<div class="" style="">
    <div class="a">a</div>
    <div class="a">a</div>
    <div class="b">b</div>
    <div class="a">a</div>
</div> 
```

CSS：

```
.a, .b {
  display:inline-block;
  width:50px;
  height:50px;
  padding:15px;
  margin:5px;
}

.a {
  float:left;
  background-color: blue;
}

.b { background-color: red; } 
```

这似乎在一行中工作正常：

![像线一样工作](../Images/e7ff5adf807832d5487acee5f8c4eb77.png)

但是像网格一样中断：

![问题](../Images/1519f122ade4812d50772835fa0b8007.png)

期望的结果（框数无关）：

![结果](../Images/d4da0736e5633b986ecee28e558e01ca.png)

JsFiddle：http: [//jsfiddle.net/kQkn9/](http://jsfiddle.net/kQkn9/)

我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T00:10:53.143

如果您正在寻找纯 CSS 解决方案，您唯一的选择是使用 Flexbox。

[http://jsfiddle.net/kQkn9/2/](http://jsfiddle.net/kQkn9/2/)

```
.container { /* parent element */
  display: -webkit-flexbox;
  display: -ms-flexbox;
  display: -webkit-flex;
  -webkit-flex-wrap: wrap;
  -ms-flex-wrap: wrap;
  flex-wrap: wrap;
}
@supports (flex-wrap: wrap) {
  .container {
    display: flex;
  }
}

.a, .b {
  display: inline-block;
  width: 50px;
  height: 50px;
  padding: 15px;
  margin: 5px;
}

.a {
  background-color: blue;
}

.b {
  -webkit-flex-order: 1;
  -ms-flex-order: 1;
  -webkit-order: 1;
  order: 1;
  background-color: red;
} 
```

浏览器支持：Chrome、Opera、IE10。 [http://caniuse.com/#feat=flexbox](http://caniuse.com/#feat=flexbox)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:07:01.657

不要相信仅靠 CSS 和 HTML 就可以做到这一点。我的建议是对 a 和 b 进行排序，而不用改变你的 css，然后以新的排序顺序将它们重新插入到 DOM 中。

有这种效果的东西：（在JQ中）

```
var listOfAs = $('.a').clone(); 
var listOfBs = $('.b').clone(); 
var parent = $('.a').first().parent('div'); 
$('.a, .b').remove(); 
parent.append(listOfAs); 
parent.append(listOfBs); 
```

我知道这有点麻烦，而且不是超级“响应式”，但正如我所说，不要认为单独使用 CSS 是可能的……这只是一个快速而肮脏的实现，让你开始。

PS：更新了你的小提琴[http://jsfiddle.net/kQkn9/6/](http://jsfiddle.net/kQkn9/6/)

编辑：显然这在较新的浏览器中是可能的（感谢@cimmonon）。如果您需要支持较旧的浏览器，您将不得不做这样的事情（这绝对不那么酷）

# css - .loading css 不适用于外部样式表

> ID：15694190
> 
> 赞同：0
> 
> 时间：2013-03-28T23:51:41.293
> 
> 标签：css

我`.loading`定义了一个 css 类，如果我将它作为内部 css 添加到页面中，它似乎才起作用。`style.css`当我将它移动到我的外部文件时，它无法生成加载圈。

**以下是我所知道的：**

1.  `style.css`正在加载，因为页面已设置样式，并且我还通过 firebug 进行了双重检查。

2.  我尝试添加`.loading`到`.css`它自己的文件并加载它，但它仍然失败。

3.  我的文件中没有`.loading`定义另一个类`style.css`
4.  我已经尝试重命名`.loading`为`.loadingCircle`没有更改（这样做是否与 JQuery 冲突）

**我的头文件：**

```
<link href="css/style.css" rel="stylesheet" type="text/css">
<script type='text/javascript' src='includes/js/jquery.js'></script>
<link href="css/jquery-ui-1.8.21.custom.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="includes/js/jquery-ui-1.8.21.custom.min.js"></script>
<script type='text/javascript' src='includes/js/createDialog.js'></script>
<script type="text/javascript" src="includes/js/jquery.tablesorter.js"></script>
<script type="text/javascript" src="includes/js/jquery.tablesorter.pager.js"></script>
<script type='text/javascript' src='includes/js/script.js'></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:38:06.720

在 jqueryui css 导入之后移动你的 css 文件。如果他们具有相同的特异性，最后一个获胜......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:28:00.347

谢谢大家。在再次查看我的 css 时，我发现这是加载图像的路径问题。我想如果我添加了它，有人会为我发现它

我的文件夹结构是这样的：

```
 /css
 /images
 searchForm.php
 index.php
 edit.php 
```

我的 .loading css 里面`searchForm.php`有：

```
.loading {
       background:url('images/ajax-loader_thick.gif') no-repeat center center; 
```

当我将它添加到`style.css`文件夹内的文件时，我错过了这样做`css`：

```
.loading {
       background:url('../images/ajax-loader_thick.gif') no-repeat center center; 
```

# python - Python 同步 urllib2 结果

> ID：15694192
> 
> 赞同：1
> 
> 时间：2013-03-28T23:51:44.413
> 
> 标签：python, networking, request, urllib

在我的软件的某个部分，我想简单地获取 URL 的源代码，然后我想解析那个字符串（源）并做一些事情。问题是，当我实际运行程序时，我无法弄清楚如何获得所说的源，即使它在 IDLE 中工作。

```
import urllib2

user_agent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)'
req = urllib2.Request('http://www.google.com')
response = urllib2.urlopen(req)
page_source = response.read()

page_source 
```

例如，如果我这样做，“page_source”将不会打印任何内容，它只会保持沉默并完成执行。我相信这是因为它不是同步的，但是我不知道如何解决它。我什至尝试过（作为绝望的尝试）：

```
import urllib2
import time

user_agent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)'
req = urllib2.Request('http://www.google.com')
response = urllib2.urlopen(req)
page_source = response.read()

time.sleep(4)

page_source 
```

这也行不通。

我已经考虑过获取`response.code`并制作一个while循环，类似于以下内容：

```
while (response.code !== 200):
    time.sleep(4) 
```

但话又说回来，它失败了，因为“response.code”根本没有返回任何东西。

我不担心用户连接等问题，因为其余的代码已经处理好了，我真的只需要弄清楚如何获取页面源并解析它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T23:58:55.540

请求确实是同步的。问题只是评估一个表达式并没有实际打印它。如果您想查看必须明确使用的值`print`：

```
import urllib2

user_agent = 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)'
req = urllib2.Request('http://www.google.com')
response = urllib2.urlopen(req)
page_source = response.read()

print page_source 
```

您可能注意到`print`在 Python shell 中输入代码时不需要。这是因为 Python shell 解析和执行代码的方式与它作为模块出现时的方式略有不同，检测输入是否解析为独立表达式，如果是则自动打印。执行源文件时，此速记不适用。

如果您对 Python 将字符串解析为源代码的不同方式的详细信息感兴趣，请参阅[内置`compile`函数](http://docs.python.org/2/library/functions.html#compile)；请注意，它有一个`mode`参数可以在三种不同的可能解析模式之间进行选择。Python shell 使用 模式`single`，而普通的源文件被编译为`exec`. 最后一种模式，`eval`，由[Python 的内置`eval`函数](http://docs.python.org/2/library/functions.html#eval)使用。

# c++ - 不正确的乘法

> ID：15694197
> 
> 赞同：-3
> 
> 时间：2013-03-28T23:52:03.820
> 
> 标签：c++

所以我有一个程序可以用不同的基数表示小数，并且由于它的性质，它有可能显示无限个小数位。但是，当我尝试以 2 为基数并输入 .258 时，它会给出 01000010000011000100100110111010010111100011010101 但即使我确定它是一个重复的小数，它也会停在那里。**重要的是要注意，该程序不会存储数字，而是在获得单个数字后立即显示它们，然后立即忘记它们。**这是代码：

```
#include <iostream>
#include <math.h>
using namespace std;
int main(int argc, const char * argv[])
{
    double a;
    double b;
    cout << "input base then input the decimal\n";
    cin >> a >> b;
    while (b) {
        b*=a;
        cout << int(b);
        b-=floor(b);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:56:37.483

您的变量`b`是双精度浮点变量。您存储在其中的值是最接近 0.258 的可表示值。与所有二进制浮点值一样，该值具有终止的二进制扩展。毕竟，您将它存储在一个 64 位宽的变量中。

你的期望是不正确的。虽然存储的数字`b`可能具有重复的*十进制*表示，但*二进制*表示必须终止。

# jquery - jQuery.each() 构建一组 jQuery 对象，附加在之后

> ID：15694202
> 
> 赞同：0
> 
> 时间：2013-03-28T23:52:28.530
> 
> 标签：jquery, append, each

为了效率，我想`.append()`在我之后运行一首单曲。`.each()`我试图构建我的对象集，但它不会运行。它类似于这个问题，除了我正在构建一个 jQuery 对象而不是字符串。

[JQuery追加以选择数组](https://stackoverflow.com/questions/4969754/jquery-append-to-select-with-an-array)

# HTML

`<select></select>`

# jQuery

```
var items = ['apple','pear','taco','orange'],
    options = '';

jQuery.each(items, function(i, fruit){
    options += jQuery('<option/>', {
        value: fruit,
        text: fruit
    });
}); //added missing ');'

jQuery('select').append(options); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T23:57:04.823

它必须是一个对象吗？为什么不直接附加到一个字符串，然后再附加该字符串？

```
$.each(items, function(i,fruit){
    options += "<option value='"+fruit+"'>"+fruit+"</option>";
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:55:19.253

您不应该连接对象，您的代码会导致`[object Object][object Object]..`. 您也缺少`)`关闭`each`方法。

```
$.each(items, function (i, fruit) {
    options += '<option value=' + fruit + '>' + fruit + '</option>';
});

$('select').append(options); 
```

[http://jsfiddle.net/NxB6Z/](http://jsfiddle.net/NxB6Z/)

更新：

```
var items = ['apple', 'pear', 'taco', 'orange'],
    options = [];

jQuery.each(items, function (i, fruit) {
    options.push($('<option/>', {
        value: fruit,
        text: fruit
    }));
});

jQuery('select').append(options); 
```

[http://jsfiddle.net/HyzWG/](http://jsfiddle.net/HyzWG/)

# math - “加扰器”功能？像随机数生成器

> ID：15694204
> 
> 赞同：0
> 
> 时间：2013-03-28T23:52:32.590
> 
> 标签：math, random, numbers

我对修改随机数生成器的通常想法很感兴趣。也就是说，典型的生成器会从该空间生成一长串合理独立、均匀分布的数字。这旨在与一粒种子重复使用。

但是，出于我的目的，我想要一种以“独立”的方式从另一个数字（实际上是从整数网格）生成“随机数”的方法，因为知道附近点的输出并不帮助您预测当前的价值。

在实践中，使用传统的随机数生成器工作得相当好，但我会对为此目的实际完成的任何工作感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T11:14:32.153

听起来您正在寻找[加密哈希函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)。

> 理想的密码散列函数有四个主要属性：
> 
> 1.  很容易计算任何给定消息的哈希值
> 2.  生成具有给定哈希的消息是不可行的
> 3.  在不更改哈希的情况下修改消息是不可行的
> 4.  找到具有相同哈希的两条不同消息是不可行的

一些常用的散列函数是[SHA-1](http://en.wikipedia.org/wiki/SHA-1)和[SHA-512](http://en.wikipedia.org/wiki/SHA-512)。一种称为[MD5](http://en.wikipedia.org/wiki/MD5)的方法仍在使用，尽管它已被证明是不安全的。

# javascript - CSS 不适用于 innerHtml 中的元素

> ID：15694208
> 
> 赞同：0
> 
> 时间：2013-03-28T23:52:46.940
> 
> 标签：javascript, jquery, css, browser

我正在使用 jQuery 的移动 css 和 js，我提供的代码如下

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:02:52.117

**根据文档：** [jquery mobile Enhancing new markup](http://jquerymobile.com/demos/1.2.1/docs/pages/page-scripting.html)

要将 jquery-mobile 的样式应用于动态添加的内容，您可以在更新后运行以下命令： `$(result_holder).trigger('create');`

请参阅下面的示例

```
// PRINT THE RESULT, THIS STUFF WONT STYLE
result_holder.innerHTML = results+' < /ul>';
$(result_holder).trigger('create'); 
```

这将告诉 jquery 自动初始化新标记中包含的所有插件

# c# - 如何计算事件提供者的下一次运行时间？

> ID：15694210
> 
> 赞同：0
> 
> 时间：2013-03-28T23:52:57.247
> 
> 标签：c#, events, datetime, scheduled-tasks, timespan

我正在尝试计算事件提供者的开始时间。

我有 3 个变量：

```
DateTime eventStartTime
DateTime currentTime
TimeSpan timeBetweenEvents 
```

`eventStartTime`是任何给定日期的所需开始时间，例如“6:00AM” `currentTime`是当前时间 `timeBetweenEvents`是事件执行之间的时间跨度

这是我的代码：

```
public static TimeSpan GetTimeToStart(DateTime eventStartTime, DateTime currentTime, TimeSpan timeBetweenEvents)
{
    TimeSpan timeToStart;
    // e.g. if it is before 6:00AM today
    if(DateTime.Now < merchantEventStartTime)
      timeToStart = merchantEventStartTime - DateTime.Now;
    // otherwise process at timeToStart + ISO8601 specified merchantEventProviderSchedule
    else
      timeToStart = merchantEventStartTime - DateTime.Now + merchantEventProviderSchedule;
    return timeToStart;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:52:57.247

使用简单的 while 循环通过增加 eventStartTime 直到它在当前时间之后来解决这个问题。这很容易受到某些数据问题的影响，但可以满足我的需要。

```
public static TimeSpan GetTimeToStart(DateTime eventStartTime, DateTime currentTime, TimeSpan timeBetweenEvents)
{
    while(eventStartTime < currentTime)
        eventStartTime = eventStartTime.Add(timeBetweenEvents);

    return eventStartTime - currentTime;
} 
```

验证我的结果的单元测试：

```
public void TestGetTimeToStart()
{
    //5AM currentTime
    DateTime now = DateTime.Now;
    var timeToStartBefore6am = AlertingService.GetTimeToStart(
        new DateTime(now.Year, now.Month, now.Day, 6, 0, 0),
        new DateTime(now.Year, now.Month, now.Day, 5, 0, 0),
        XmlConvert.ToTimeSpan("PT12H"));
    Assert.IsNotNull(timeToStartBefore6am);
    Assert.AreEqual(timeToStartBefore6am, new TimeSpan(1, 0, 0));

    //5PM currentTime
    var timeToStartBefore6pm = AlertingService.GetTimeToStart(
        new DateTime(now.Year, now.Month, now.Day, 6, 0, 0),
        new DateTime(now.Year, now.Month, now.Day, 17, 0, 0),
        XmlConvert.ToTimeSpan("PT12H"));
    Assert.IsNotNull(timeToStartBefore6pm);
    Assert.AreEqual(timeToStartBefore6pm, new TimeSpan(1, 0, 0));

    //7PM currentTime
    var timeToStartAfter6pm = AlertingService.GetTimeToStart(
        new DateTime(now.Year, now.Month, now.Day, 6, 0, 0),
        new DateTime(now.Year, now.Month, now.Day, 19, 0, 0),
        XmlConvert.ToTimeSpan("PT12H"));
    Assert.IsNotNull(timeToStartAfter6pm);
    Assert.AreEqual(timeToStartAfter6pm, new TimeSpan(11, 0, 0));
} 
```

# python - 独立的 SQLAlchemy 模型

> ID：15694212
> 
> 赞同：2
> 
> 时间：2013-03-28T23:53:04.747
> 
> 标签：python, sql, sqlalchemy

在 SQLAlchemy 中声明模型时，您会创建一个`declarative_base`从中继承的类。当我想在多个地方声明模型并在另一个应用程序（有关系）中使用它们时，我发现这有点问题。

我是从 Django 背景来解决这个问题的，在这个背景下，将单独的应用程序组合到一个网站中是很常见的。每个应用程序都通过继承来声明自己的模型，`django.db.models.Model`您可以通过简单地导入其模型并在应用程序中使用它来创建与另一个模型的关系。

在不同的地方声明模型通常很有用。`MetaData`但是由于 SQLAlchemy 的显式或`Base`声明，这变得有点问题。我不确定处理这个问题的最佳方法是什么。我的问题是：**独立声明 SQLAlchemy 模型以便以后组合使用它们的最佳方法是什么？**

我想让每个`models.py`声明都有自己`declarative_base`的想法是个坏主意（SQLAlchemy 文档说所有声明性模型都应该从同一个基础继承）。模拟 Django 的行为将是集中声明`declarative_base`并简单地将其导入到任何地方。但是这种方式使得每个单独的应用程序都与这个中心点相关联（当您想要创建完全独立的应用程序并且您不是 Django 时，这是有问题的）。

我宁愿有一个中心点拉入模型并配置它们，这样当一个项目想要使用例如我的应用程序的用户模型时，它会导入它并使其使用项目的 Base 或 MetaData 或任何需要的东西。这可能涉及使用“[经典映射](http://docs.sqlalchemy.org/en/rel_0_8/orm/mapper_config.html#classical-mapping)`MetaData`”（但是无论如何您都必须传递相同的内容）。

**编辑：**嗯，我刚刚看到了一个相关的问题（[跨项目重用 SQLAlchemy 模型](https://stackoverflow.com/questions/5807694/reusing-sqlalchemy-models-across-projects?rq=1)），它属于同一个领域。我不确定接受的答案是最好的解决方案（或者即使是一个）。

## 指定时使用显式列而不是字符串`ForeignKey`

这是一个似乎有效的尝试：

app1.models：

```
Base = declarative_base()

class User(Base):
  id = Column(Integer, primary_key=True)
  name = Column(Text) 
```

app2.models：

```
from app1.models import User

Base = declarative_base()

class Address(Base):
  user_id = Column(Integer, ForeignKey(User.id), primary_key=True)
  user = relationship(User, backref=backref('addresses'))
  street1 = Column(Text)
  ... 
```

唔...

# php - 提交表单时无法实例化抽象类

> ID：15694213
> 
> 赞同：0
> 
> 时间：2013-03-28T23:53:18.333
> 
> 标签：php, symfony, twig

我有一个 .twig 文件，其格式如下：

```
{% block section_contents %}

    <section id="main" class="aux manage signup clearfix">

            <div class="container welcome-back arvo-regular clearfix">
                Join the Mysite Community
            </div>

            <div class="container form-bg clearfix">
                <form class="content-form wrap" 
                action="{{ path('MysiteMainBundle_signup_additional_info') }}" 
                method="post" {{ form_enctype(additionalInfoForm) }} novalidate>>
                {% if formValid is defined %}
                        </br></br>
                        <div class="alert alert-block alert-error fade in">
                            <h4> Errors </h4>
                            {{ form_errors(settingsForm.firstName) }}
                            {{ form_errors(settingsForm.lastName) }}
                            {{ form_errors(settingsForm.address.addressOne) }}
                            {{ form_errors(settingsForm.email) }}
                            {{ form_errors(settingsForm.shop.name) }}
                            {{ form_errors(settingsForm) }}
                        </div>
                {% endif %}
                 <div class="personal-details">
                    <div class="text-line clearfix">
                        <div class="sub-header">
                            First Name
                        </div>

                       {{ form_widget(additionalInfoForm.firstName, { 'attr': {'class': 'validate[required] arvo-regular' } }) }}

                    </div>
                    <div class="text-line clearfix">
                        <div class="sub-header">
                            Last Name
                        </div>

                        {{ form_widget(additionalInfoForm.lastName, { 'attr': {'class': 'validate[required] arvo-regular' } }) }}

                    </div>

                    <input type="submit" value="Sign Up" class="arvo-regular button green signup-button" />

                 </div> <!-- end login details -->   
                </form>
            </div>

        </section>

{% endblock section_contents %} 
```

但是，当我提交此表格时，我得到：

```
 Fatal error: Cannot instantiate abstract class Mysite\MainBundle\Entity\Document in /Mysite/vendor/symfony/symfony/src/Symfony/Component/Form/Extension/Core/Type/FormType.php on line 172 Call Stack: 0.0011 659400 1\. {main}() /Mysite/web/app_dev.php:0 0.0284 7412872 2\. Symfony\Component\HttpKernel\Kernel->handle() /Mysite/web/app_dev.php:29 0.1012 13005672 3\. Symfony\Bundle\FrameworkBundle\HttpKernel->handle() /Mysite/app/bootstrap.php.cache:619 0.1013 13007328 4\. Symfony\Component\HttpKernel\HttpKernel->handle() /Mysite/app/bootstrap.php.cache:1568 0.1013 13007328 5\. Symfony\Component\HttpKernel\HttpKernel->handleRaw() /Mysite/app/bootstrap.php.cache:1392 0.2212 28737544 6\. call_user_func_array() /Mysite/app/bootstrap.php.cache:1428 0.2212 28738032 7\. Mysite\MainBundle\Controller\SignupController->indexAction() /Mysite/app/bootstrap.php.cache:1428 0.2960 35454528 8\. Symfony\Component\Form\Form->bind() /Mysite/src/Mysite/MainBundle/Controller/SignupController.php:49 0.2968 35509648 9\. Symfony\Component\Form\Form->bind() /Mysite/vendor/symfony/symfony/src/Symfony/Component/Form/Form.php:539 0.2971 35517024 10\. Symfony\Component\Form\Extension\Core\Type\{closure}() /Mysite/vendor/symfony/symfony/src/Symfony/Component/Form/Form.php:559 
```

我不完全确定为什么。它肯定与文档类有关。

编辑：

添加了一些表单代码：

```
class UserType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        switch ($options['mode']) {
            case 'login':
                $builder
                    ->add('email')
                    ->add('password')
                ;
                break;
            case 'shop_create':
                $builder
                    ->add('firstName', 'text')
                    ->add('lastName', 'text')
                    ->add('phone', 'text')
                    ->add('email', 'text')
                    ->add('address', new AddressType())
                    ->add('city', 'text')
                    ->add('state', 'text')
                    ->add('dni', 'text')
                    ->add('zipcode', 'text')
                    ->add('shop', new ShopType())
                ;
                break;
            case 'account_settings':
                $builder
                    ->add('profilePicture', new ProfilePictureFormType())
                    ->add('firstName', 'text')
                    ->add('lastName', 'text')
                    ->add('birthday', 'date', array('widget'=>'single_text'))
                    ->add('website', 'text')
                    ->add('biography', 'textarea')
                    ->add('email', 'text')
                    ->add('address', new AddressType())
                    ->add('shop', new ShopType())
                ;
                break;
            case 'additional_signup_info':
                $builder
                    ->add('profilePicture', new ProfilePictureFormType())
                    ->add('firstName', 'text')
                    ->add('lastName', 'text')
                    ->add('email', 'text')
                    ->add('address', new AddressType())
                    ->add('city', 'text')
                    ->add('state', 'text')
                    ->add('zipcode', 'text')
                    ->add('password')
                ;
                break;
            default:
                throw new \Exception('You need to select which type of user form type you want to use.');
                break;
        }
    } 
```

这是控制器中的表单代码：

```
public function indexAction(Request $request)
    {    
        if ($request->hasSession()){
            $session = $request->getSession();
            $username = $session->get('username');
            $session->invalidate();
        } 

        $em = $this->getDoctrine()->getEntityManager();
        $userRepository = $em->getRepository('MysiteUserBundle:User');
        $user = $userRepository->findOneBy(array('username' => $username));

        $additionalInfoForm = $this->createForm(new UserType(), $user, array(
            'mode' => 'additional_signup_info'
        ));

        if ($request->isMethod('POST')) {
            $additionalInfoForm->bind($request);

            if ($additionalInfoForm->isValid()) {
                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($user);
                $em->flush();
               return $this->redirect($this->generateUrl('MysiteMainBundle_marketplace'));

            }else{
                return array(
                        'formValid' => false,
                        'additionalInfoForm' => $additionalInfoForm->createView()
                    );
            }
        }

        return array('user' => $user, 'additionalInfoForm' => $additionalInfoForm->createView());
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:01:09.967

问题在于 php 文件。确保您没有实例化抽象类，和/或实现接口的每个类都定义了接口中声明的所有方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:05:29.760

问题出在`UserType`课堂上。正如@ArgumentNullException 提到的@adit 忘记检查抽象类的实例化。

# ios - 整数属性的 removeObserver 崩溃？

> ID：15694226
> 
> 赞同：4
> 
> 时间：2013-03-28T23:54:47.393
> 
> 标签：ios, objective-c, key-value-observing

我使用 XIB 创建一个 CustomView:UIView，为 NSInteger 属性加载和 addObserver，如下所示：

//自定义视图.h

```
@interface CustomView : UIView
    @property (nonatomic) NSInteger inputStateControl;
@end 
```

//自定义视图.m

```
static void *kInputStateControlObservingContext = &kInputStateControlObservingContext;
@implementation CustomView
- (id)init
{
    self = [super init];
    if (self) {
        // Initialization code
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"CustomView" owner:self options:nil];
        self = [nib objectAtIndex:0];
        //
        [self commonInit];
    }
    return self;
}

-(void)commonInit{
[self addObserver:self forKeyPath:@"inputStateControl" options:NSKeyValueObservingOptionOld context:kInputStateControlObservingContext];
}

#pragma mark Observer
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {

    if ( context == kInputStateControlObservingContext ) {
        NSInteger oldState = [[change objectForKey:NSKeyValueChangeOldKey] integerValue];
        if ( oldState != self.inputStateControl ) {
            NSLog(@"CONTEXT change %i to %i",oldState,self.inputStateControl);
        }
    }
    else {
        [super observeValueForKeyPath:keyPath ofObject:object change:change context:context];
    }
}

-(void)dealloc{
    [self removeObserver:self forKeyPath:@"inputStateControl"];
//    [self removeObserver:self forKeyPath:@"inputStateControl" context:kInputStateControlObservingContext];
}

@end 
```

如果我在 dealloc 中注释掉 removeObserver，一切正常，这是日志：

```
CONTEXT change 0 to 2 
```

但是当removeObserver，App崩溃：

```
*** Terminating app due to uncaught exception 'NSRangeException', reason: 'Cannot remove an observer <Keyboard 0x6a8bcc0> for the key path "inputStateControl" from <Keyboard 0x6a8bcc0> because it is not registered as an observer.' 
```

评论加载 CustomView.xib 时不会崩溃，但与 XIB 无关。我的代码有什么问题？

## 如何使用自定义 Xib 在 CustomView 中为 NSInteger 属性添加和删除Observer？

提前致谢！

*编辑：我添加我的代码以明确我的问题。请帮忙！

[https://github.com/lequysang/github_zip/blob/master/CustomViewKVO.zip](https://github.com/lequysang/github_zip/blob/master/CustomViewKVO.zip)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T02:25:19.123

这就是正在发生的事情 - 在您的 viewDidLoad 方法中，您调用`[[CustomView alloc] init]`. 这将创建一个新的 CustomView 实例，并调用`init`它。但是，在 中`init`，您从 nib 加载一个新实例并用 nib`self`中的那个替换。这会导致您创建`alloc`并设置的实例`self = [super init];`被释放，因为不再有对它的强引用。由于此实例在调用之前被释放`commonInit`，因此它从不观察自己的属性，因此将自己作为观察者移除会导致异常。

解决此问题的一种方法是直接从视图控制器中的 nib 加载视图，或在 CustomView 上创建一个类方法

```
NSArray *topLevelObjects = [[NSBundle mainBundle] loadNibNamed:@"CustomView" owner:nil options:nil];
CustomView *customView = topLevelObjects[0]; 
```

如果您确实采用了这种方法，请丢弃您`init`的实现并将其替换为执行以下操作的`initWithCoder:`：

```
- (id)initWithCoder:(NSCoder *)aDecoder
{
    self = [super initWithCoder:aDecoder];
    if (self) {
        _inputStateControl = 0;
        [self commonInit];
    }

    return self;
} 
```

实现的原因`initWithCoder:`是当你从 nib 加载视图时会自动调用它。您只需要实现它，您就可以进行已经在`init`. 还要确保你的 dealloc 是这样实现的：

```
-(void)dealloc{
    [self removeObserver:self forKeyPath:@"inputStateControl" context:kInputStateControlObservingContext];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:08:11.070

我不知道*为什么*你正在做的事情不起作用，但是让一个物体像这样观察自己是一个坏主意。您应该只显式地实现您的 inputStateControl 的 setter ( `setInputStateControl`) 并在该 setter 方法中执行您的日志记录以及您想要的任何其他副作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:43:29.510

虽然无论如何都不是一个理想的解决方案，但使用 try-catch 块围绕删除将解决您的问题。如果实际上观察者没有注册，那么在移除它的过程中忽略异常是安全的。主要风险是您的应用程序依赖于它已注册的任何假设。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T02:14:38.667

不知道你为什么会遇到这个问题。我做的最快捷的方法是在 dealloc 中将自定义观察者设置为“nil”；），但在你的情况下，使用这种快捷方式还需要添加观察者其他方式。

好吧，至少我可以告诉你的是，在你的交易中，

```
-(void)dealloc{
    [[NSNotificationCenter default center] removeObserver: self];
    [self removeObserver:self forKeyPath:@"inputStateControl"];
    //OR
    //If you had create a observer called "temp",then easy way to remove the observer is temp=nil;

} 
```

如果您仍然坚持，请将@try @catch 块用于临时解决方案，请注意它不会删除观察者；）...

不是您正在寻找的完美答案，但它正是我认为的方式......快乐编码:-)

# f# - F# 字符串格式化 - 两次使用相同的值

> ID：15694228
> 
> 赞同：8
> 
> 时间：2013-03-28T23:55:02.970
> 
> 标签：f#, c#-to-f#

我正在尝试找到以下 C# 片段的 F# 等效项

```
string.Format("A: {0} B: {1} A again: {0} C: {2}", a, b, c); 
```

我可以这样做：

```
sprintf "A: %s B: %s A again: %s C: %s" a b a c 
```

但是，我想知道是否有任何方法可以像 C# 示例中那样两次引用 a 属性。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T02:30:26.853

幸运的是`String.Format`仍然可以在 F# 中使用。

```
> open System;;
> String.Format("Hello {0} {0}", "world");;
val it : string = "Hello world world" 
```

# ios - 我如何将值从一个 ViewController 传递到另一个，这是用户输入和“计算”

> ID：15694230
> 
> 赞同：0
> 
> 时间：2013-03-28T23:55:05.517
> 
> 标签：ios, xcode, global-variables, extern

我想在另一个名为“AdultPayNowViewController”的 ViewContoller 上执行“TotalLabel”计算。我还想执行“x”值，这是用户在“AdultPayNowViewController”上输入数量的 UITextField

//成人票计算器.h

```
@interface StudentTicketCalculatorViewController : UIViewController {

    IBOutlet UITextField *Quantity;
    IBOutlet UILabel *Pricelabel;
    IBOutlet UILabel *TotalLabel;
    IBOutlet UIButton *CheckoutButton;

}

-(IBAction)calculate;
-(IBAction)clear;

@end

\\AdultTicketCalculator.m

-(IBAction)calculate {

    float x = ([Quantity.text floatValue]);
    float c = x*15;

    TotalLabel.text = [[NSString alloc] initWithFormat:@"$%.2f", c];

}

-(IBAction)clear {

    Quantity.text =@"";
    Pricelabel.text =@"$15.00";
    TotalLabel.text =@""; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T02:18:55.063

首先，这些值可能甚至不应该存在于控制器中。如果它们真的是值，它们应该是模型的一部分，以通常的 MVC 方式由控制器共享或在控制器之间传递。

但是继续前进，实际上只有几种方法可以在控制器（或任何对象，就此而言）之间传递值。最直接的是，您在`AdultPayNowViewController`调用中创建了一个自定义初始化程序，`-initWithTotalLabel:andXValue:`并在其中创建了该控制器，`StudentTicketCalculatorViewController`如下所示：

```
[[AdultPayNowViewController alloc] initWithTotalLabel:totalLabel andXValue:x]; 
```

或来自一些共享的父母，例如：

```
[[AdultPayNowViewController alloc] initWithTotalLabel:[studentController totalLabel] andXValue:[studientController x]]; 
```

同样，如果成人控制器的初始化不需要这些值，则始终可以将它们设置为属性并直接设置它们：

```
adultController = [[AdultPayNowViewController alloc] init];
[adultController setTotalLabel:[childController TotalLabel]];
[adiltController setXValue:[childController x]]; 
```

另一种可能性是让学生控制器成为成人控制器的代表，并让成人控制器向其代表询问其值`totalLabel`以及`x`何时需要它们。

最后，您可以将学生控制器作为参数或用户数据传递给负责创建成人控制器的方法或通知，然后使用其属性设置或初始化成人控制器所需的值。我相信，这或多或少是被认可的“故事板”做事方式，一切都在`-prepareForSegue:sender:`.

# php - A* 搜索 - 跳数最少？

> ID：15694231
> 
> 赞同：2
> 
> 时间：2013-03-28T23:55:12.347
> 
> 标签：php, python, path-finding, a-star

我正在尝试创建一个 A* 寻路算法，但是我在开始使用它时遇到了一些麻烦。一点背景：

我绝不精通寻路算法，但几年前我确实接触过这个主题（我已经忘记了我学到的一切）。我玩 EVE Online，这是一个关于互联网宇宙飞船的在线游戏。开发人员发布静态信息（游戏中的项目、太阳系位置等）的数据转储。我试图找到从太阳系 A 到太阳系 B 的最短路线。

看看这张地图：[http](http://evemaps.dotlan.net/map/UUA-F4) ://evemaps.dotlan.net/map/UUA-F4这是游戏中的一个区域，每个节点都是一个系统。我想计算任何两个系统之间的最短距离。

我的问题：我在网上读到的关于 A* 的所有内容都在谈论合并两个节点之间的距离（例如，两个城市之间的距离）以帮助计算最短路径。这对我的情况没有帮助，因为我对跃点数（节点 1 > 节点 2 > 节点 3）而不是这些跃点之间的距离更感兴趣。我不知道如何修改 A* 算法来合并它。

我在数据库中的信息：所有系统及其邻居的列表（因此，systemX 与 systemA 和 systemB 链接）3D 网格中所有系统的 x、y 和 z 坐标

如果有人能指出我正确的方向，那就太好了。我希望在 PHP 中使用它，但是我也开始在 Python 中工作一点，所以它也可以工作。

如果需要，可以根据要求提供示例数据。

## 编辑

正如一些人所指出的，与每次跳跃相关的“成本”只是 1。但是，对于 A*，您还需要一个启发式方法来估计从当前节点到目标节点的距离。我不确定如何确定这个值，因为我不确定剩余的跃点。如前所述，我确实有每个节点的 3D 坐标 (x,y,z)，但我不确定这是否可以提供任何见解，因为每个节点之间的物理距离无关紧要。我知道没有路径跨越超过 99 个跃点。

## 编辑 2

示例区域的 MySQL 数据。

`to -> from`数据： http: [//pastebin.com/gTuwdr7h](http://pastebin.com/gTuwdr7h)

系统信息（x、y、z 坐标，如果需要）： http: [//pastebin.com/Vz3FD3Kz](http://pastebin.com/Vz3FD3Kz)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T23:59:09.307

如果“跳数”对您来说很重要，那么将其视为您的距离，这意味着如果两个位置通过单跳连接，则距离为一。

对于 A*，您需要两件事：

1.  从一个位置到每个邻居的成本，在您的情况下，这似乎是恒定的（跳跃）。

2.  一种启发式方法，它估计从您当前的“节点”或位置到目标的成本。如何估计这在很大程度上取决于您的问题。重要的是，您的启发式方法不会*高*估计真实成本，否则 A* 将无法保证最佳结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:16:42.087

[取链接图](http://evemaps.dotlan.net/map/UUA-F4)的上半部分：

![在此处输入图像描述](../Images/39effea69b70df25384b2de68c2eab9d.png)

假设线代表 2 路（即，您可以往返任何链接节点），黑线是 1 的“成本”，红线是 2 的“成本”。

该结构可以由以下 Python 数据结构表示：

```
graph = {'Q-KCK3': {'3C-261':1, 'L-SDU7':1},
         'L-SDU7': {'Q-KCK3':1, '3C-261':1,'4-IPWK':1},
         '3C-261': {'4-IPWK':1,'9K-VDI':1,'L-SDU7':1,'U8MM-3':1},
         'U8MM-3': {'9K-VDI':1,'3C-261':1, '9K-VDI':1, 'Q8T-MC':2},
         'Q8T-MC': {'U8MM-3':2, 'H55-2R':1, 'VM-QFU':2},
         'H55-2R': {'Q8T-MC':1, '9XI-OX':1, 'A3-PAT':1, 'P6-DBM':1},
         'P6-DBM': {'A3-PAT':1, 'H55-2R':1},
         'A3-PAT': {'P6-DBM':1, 'H55-2R':1, '9XI-OX':1,'YRZ-E4':1},
         'YRZ-E4': {'A3-PAT':1}, 
         'VM-QFU': {'IEZW-V':1, 'PU-128':2},
         'IEZW-V': {'VM-QFU':1, 'PU-128':1, 'B-DX09':1},
         'PU-128': {'VM-QFU':1, 'B-DX09':1, 'IEZW-V':1},
         'B-DX09': {'IEZW-V':1, 'PU-128':1, '1TS-WIN':1},
         '1TS-WIN': {'B-DX09':1, '16-31U':1},
         '16-31U': {'1TS-WIN':1}
        } 
```

现在您可以定义一个递归函数来导航该数据：

```
def find_all_paths(graph, start, end, path=[]):
        path = path + [start]
        if start == end:
            return [path]
        if start not in graph:
            return []
        paths = []
        for node in graph[start]:
            if node not in path:
                newpaths = find_all_paths(graph, node, end, path)
                for newpath in newpaths:
                    paths.append(newpath)
        return paths       

def min_path(graph, start, end):
    paths=find_all_paths(graph,start,end)
    mt=10**99
    mpath=[]
    print '\tAll paths:',paths
    for path in paths:
        t=sum(graph[i][j] for i,j in zip(path,path[1::]))
        print '\t\tevaluating:',path, t
        if t<mt: 
            mt=t
            mpath=path

    e1='\n'.join('{}->{}:{}'.format(i,j,graph[i][j]) for i,j in zip(mpath,mpath[1::]))
    e2=str(sum(graph[i][j] for i,j in zip(mpath,mpath[1::])))
    print 'Best path: '+e1+'   Total: '+e2+'\n' 
```

现在演示：

```
min_path(graph,'Q-KCK3','A3-PAT')
min_path(graph,'Q-KCK3','16-31U') 
```

印刷：

```
 All paths: [['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'P6-DBM', 'A3-PAT'], ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'A3-PAT'], ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'P6-DBM', 'A3-PAT'], ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'A3-PAT']]
        evaluating: ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'P6-DBM', 'A3-PAT'] 7
        evaluating: ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'A3-PAT'] 6
        evaluating: ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'P6-DBM', 'A3-PAT'] 8
        evaluating: ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'H55-2R', 'A3-PAT'] 7
Best path: Q-KCK3->3C-261:1
3C-261->U8MM-3:1
U8MM-3->Q8T-MC:2
Q8T-MC->H55-2R:1
H55-2R->A3-PAT:1   Total: 6

    All paths: [['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'], ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U']]
        evaluating: ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'] 10
        evaluating: ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'] 11
        evaluating: ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'] 11
        evaluating: ['Q-KCK3', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'] 12
        evaluating: ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'] 11
        evaluating: ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'IEZW-V', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'] 12
        evaluating: ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'B-DX09', '1TS-WIN', '16-31U'] 12
        evaluating: ['Q-KCK3', 'L-SDU7', '3C-261', 'U8MM-3', 'Q8T-MC', 'VM-QFU', 'PU-128', 'IEZW-V', 'B-DX09', '1TS-WIN', '16-31U'] 13
Best path: Q-KCK3->3C-261:1
3C-261->U8MM-3:1
U8MM-3->Q8T-MC:2
Q8T-MC->VM-QFU:2
VM-QFU->IEZW-V:1
IEZW-V->B-DX09:1
B-DX09->1TS-WIN:1
1TS-WIN->16-31U:1   Total: 10 
```

如果您想要最小的跳数，只需修改`min_path`以返回最短的列表长度而不是跳数的最小总成本。或者，计算每一跳的成本`1`。

看看[我之前关于火车的回答](https://stackoverflow.com/questions/15534438/dictionary-best-data-structure-for-train-routes/15534662#15534662)。

# opengl - opengl 显示形状和绘制文本

> ID：15694233
> 
> 赞同：1
> 
> 时间：2013-03-28T23:55:23.067
> 
> 标签：opengl, text, glut

基本上我有一个基本的形状，它由要操作的键盘控制。而且我还有想要在屏幕上呈现的文本，上面写着“Hello world”。但是，每当我运行它时，我都会得到一个空白屏幕。

这是我的代码，有什么想法吗？

 ````
#include <iostream>
#include <stdio.h>
#include <Windows.h>
#include <string.h>
#include <GL/glut.h>
#include <math.h>

GLfloat g_xeye;
GLfloat g_yeye;

bool rollOn;

GLfloat g_light_position[] = {0.0, 10.0, 10.0, 0.0};

void roll(void)
{
    if (rollOn){
        Sleep(1);
        g_xeye = g_xeye + 00000.1;
        glutPostRedisplay();
        g_yeye = g_yeye + 00000.1;
        glutPostRedisplay();
    }
}

void drawBitmapText(char *string, float x, float y, float z)
{
    char *c;
    glRasterPos3f(x, y, z);

    for (c=string; *c != '\0'; c++)
    {
        glutBitmapCharacter(GLUT_BITMAP_TIMES_ROMAN_10, *c);
    }
}

void drawStrokeText(char*string, int x, int y, int z)
{
    char *c;
    glPushMatrix();
    glTranslatef(x, y+8, z);

    for (c=string; *c != '\0'; c++)
    {
        glutStrokeCharacter(GLUT_STROKE_ROMAN, *c);
    }
    glPopMatrix();
}

void display(void)
{
    GLfloat redDiffuseMaterial[] = {0.50, 0.0, 0.50, 0.0};

    glClear (GL_COLOR_BUFFER_BIT| GL_DEPTH_BUFFER_BIT);

    glLoadIdentity();
    gluLookAt(0,0, 6 , 0.0, 0.0, 0.0, 0.0, 1.0, 0.0);
    glMaterialfv(GL_FRONT, GL_DIFFUSE, redDiffuseMaterial);
    //glPushMatrix();
    glRotatef(g_xeye, 1, 0, 0);
    glRotatef(g_yeye, 0, 1, 0);
    glutSolidCube(2.0);
    //glPopMatrix();

    //glColor3f(0.250, 0.0, 0.200);

    glClear(GL_COLOR_BUFFER_BIT); 
    glLoadIdentity();

    glColor3f(0,1,0);

    drawBitmapText("Hello world",200,200,0);

    glutSwapBuffers ();
}

void keyboard(unsigned char key, int x, int y)
{
    if (key==27)
        exit(0);
    if (key == ',')
    {

        g_light_position[0] = g_light_position[0] - 1;
        glLightfv(GL_LIGHT0, GL_POSITION, g_light_position);

    }
    if (key == '.')
    {
        g_light_position[0] = g_light_position[0] + 1;
        glLightfv(GL_LIGHT0, GL_POSITION, g_light_position);
        glutPostRedisplay();
    }
    if (key==32)
    {
    if(rollOn==false)
        rollOn=true;
    else
        rollOn=false;
    }
}

void special(int key, int x, int y)
{
    if (key==27)
        exit(0);
    if (key == GLUT_KEY_UP)
    {
        g_xeye = g_xeye + 2;
        glutPostRedisplay();
    }
    if (key == GLUT_KEY_DOWN)
    {
        g_xeye = g_xeye - 2;
        glutPostRedisplay();
    }
    if (key == GLUT_KEY_RIGHT)
    {
        g_yeye = g_yeye + 2;
        glutPostRedisplay();
    }
    if (key == GLUT_KEY_LEFT)
    {
        g_yeye = g_yeye - 2;
        glutPostRedisplay();
    }
}

void init(void)
{
    glEnable(GL_DEPTH_TEST);

    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);

    glLightfv(GL_LIGHT0, GL_POSITION, g_light_position);

    rollOn = false;  

    g_xeye = 0;
    g_yeye = 0;
}

void reshape (int width, int height)
{
    /* Called when window is created, moved or resized */
    GLfloat aspectRatio;

    /* Set the viewport to be the whole window */
    glViewport(0, 0, (GLsizei) width, (GLsizei) height);

    /* Prepare to set up the Projection matrix */
    glMatrixMode(GL_PROJECTION);

    glLoadIdentity();
    //glColor3f(0.250, 0.0, 0.200);

    gluOrtho2D(0, width, height, 0);

    /* Set a prespective projection */
    aspectRatio = (GLfloat)width / (GLfloat) height;
    gluPerspective(60, aspectRatio, 1.0, 100.0);

    /* Prepare to set up the Model view matrix */
    glMatrixMode(GL_MODELVIEW);
    glClearColor (0.0, 0.0, 0.0, 0.0);

    glLoadIdentity();
}

/*void render(void)
{
    glClear(GL_COLOR_BUFFER_BIT);
    glLoadIdentity();

    glColor3f(0,1,0);

    drawBitmapText("Hello world",200,200,0);
    glutSwapBuffers();
}*/

int main(int argc, char** argv)
{
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(100, 100);
    glutCreateWindow ("Project");
    init();

    glutKeyboardFunc(keyboard);
    glutSpecialFunc(special);

    glutReshapeFunc(reshape);
    glutDisplayFunc(display);

    glutIdleFunc(roll);

    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T03:21:49.777

试试这个：

```
#include <GL/glut.h>

GLfloat g_xeye;
GLfloat g_yeye;

bool rollOn;

GLfloat g_light_position[] = {0.0, 10.0, 10.0, 0.0};

void timer( int extra )
{
    if (rollOn){
        g_xeye = g_xeye + 00000.1;
        g_yeye = g_yeye + 00000.1;
    }
    glutTimerFunc( 16, timer, 0 );
    glutPostRedisplay();
}

void drawBitmapText(char *string, float x, float y, float z)
{
    char *c;
    glRasterPos3f(x, y, z);

    for (c=string; *c != '\0'; c++)
    {
        glutBitmapCharacter(GLUT_BITMAP_TIMES_ROMAN_10, *c);
    }
}

void display(void)
{
    glClearColor (0.0, 0.0, 0.0, 0.0);
    glClear (GL_COLOR_BUFFER_BIT| GL_DEPTH_BUFFER_BIT);

    // draw cube in 3D
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    double w = glutGet( GLUT_WINDOW_WIDTH );
    double h = glutGet( GLUT_WINDOW_HEIGHT );
    gluPerspective(60, w / h, 1.0, 100.0);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    gluLookAt(0, 0, 6, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0);

    glPushMatrix();
    glRotatef(g_xeye, 1, 0, 0);
    glRotatef(g_yeye, 0, 1, 0);
    GLfloat redDiffuseMaterial[] = {0.50, 0.0, 0.50, 0.0};
    glMaterialfv(GL_FRONT, GL_DIFFUSE, redDiffuseMaterial);
    glutSolidCube(2.0);
    glPopMatrix();

    // switch to 2D for text overlay
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho( 0, w, 0, h, -1, 1 );

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glDisable( GL_LIGHTING );
    glColor3ub(255,255,255);
    drawBitmapText("Hello world",200,200,0);
    glEnable( GL_LIGHTING );

    glutSwapBuffers ();
}

void keyboard(unsigned char key, int x, int y)
{
    if (key==27)
        exit(0);
    if (key == ',')
    {
        g_light_position[0] = g_light_position[0] - 1;
    }
    if (key == '.')
    {
        g_light_position[0] = g_light_position[0] + 1;
        glLightfv(GL_LIGHT0, GL_POSITION, g_light_position);
    }
    if (key==32)
    {
        rollOn = !rollOn;
    }
}

void special(int key, int x, int y)
{
    if (key==27)
        exit(0);
    if (key == GLUT_KEY_UP)
    {
        g_xeye = g_xeye + 2;
    }
    if (key == GLUT_KEY_DOWN)
    {
        g_xeye = g_xeye - 2;
    }
    if (key == GLUT_KEY_RIGHT)
    {
        g_yeye = g_yeye + 2;
    }
    if (key == GLUT_KEY_LEFT)
    {
        g_yeye = g_yeye - 2;
    }
}

void init(void)
{
    glEnable(GL_DEPTH_TEST);

    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);

    glLightfv(GL_LIGHT0, GL_POSITION, g_light_position);

    rollOn = false;  

    g_xeye = 0;
    g_yeye = 0;
}

int main(int argc, char** argv)
{
    glutInit( &argc, argv );
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(100, 100);
    glutCreateWindow ("Project");
    init();

    glutKeyboardFunc(keyboard);
    glutSpecialFunc(special);
    glutDisplayFunc(display);
    glutTimerFunc( 0, timer, 0 );
    glutMainLoop();
    return 0;
} 
```

如果您愿意使用[`glWindowPos()`](http://www.opengl.org/sdk/docs/man2/xhtml/glWindowPos.xml)OpenGL [1.4](http://glew.sourceforge.net/)而不是`glRasterPos()`.`

# jquery - 使用 jquery 悬停时弹出窗口

> ID：15694235
> 
> 赞同：0
> 
> 时间：2013-03-28T23:55:39.833
> 
> 标签：jquery, popup

好的，在这里变得非常沮丧。我知道我想做的并不复杂，但我找不到一个很好的简单答案。

当我将鼠标悬停在图像上时，我想要一个弹出窗口。弹出窗口应该在图像的右侧。
就是这样。

如果他们还不知道，这用于显示在哪里可以找到信用卡的 CVV# 的图像。

我一直在寻找所有这些样本，这些样本同时将我正在寻找的东西与其他 18 种东西结合在一起，这使得初学者无法使用 jquery 对其进行排序。

我不想把它组合成一个菜单系统，我不想把这段代码应用到某个标签的每一个副本上，我也不想让它唱歌跳舞。

我确实相信弹出窗口必须在它自己的 DIV 中，因为触发悬停的图像位于我不想更改的表格内。

我离说 fu-it 并让它在新的浏览器窗口中弹出大约 2 英寸（对于我的海外朋友来说是 5 厘米）。我这样做的原因是因为我认为它是一种更好的风格，并且因为我想学习jquery。

如果有人可以用非常简单的术语向我解释一下，我将非常感激。如果您想添加一些您认为会有所帮助的其他功能，例如圆角，那没关系，只要我能轻松分辨出哪些代码与哪些内容搭配即可。

非常感谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-29T00:06:31.480

可能是这样的：

```
$('.popover').on({
    mousemove: function(e) {
        $(this).next('img').css({
            top: e.pageY - 260,
            left: e.pageX + 10
        });
    },
    mouseenter: function() {
        var big = $('<img />', {'class': 'big_img', src: this.src});
        $(this).after(big);
    },
    mouseleave: function() {
        $('.big_img').remove();
    }
}); 
```

[**示范**](http://jsfiddle.net/9B28P/)

或者没有 javascript，只有 CSS：[**FIDDLE**](http://jsfiddle.net/9B28P/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:02:10.117

哇，冷静的人。

这是我建议使用的一种技术。

将 a 附加到作为弹出窗口的容器`<div>`的末尾。[http://jqapi.com/#p=append](http://jqapi.com/#p=append)`<body>`

接下来，您需要知道要设置它的位置，相对于文档。您可以使用 jQuery 的偏移量[http://jqapi.com/#p=offset获取悬停元素的偏移量](http://jqapi.com/#p=offset)

然后您将计算悬停元素的宽度，然后使用 CSS 将弹出窗口设置在其旁边，`position: absolute`. 要设置定位上下文，最好也设置`position:relative`为父元素，在本例中为`<body>`. 你需要为你的弹出容器设置 CSS`top`属性`left`。

悬停机制的建议[http://jqapi.com/#p=hover](http://jqapi.com/#p=hover)

您需要以函数的形式创建悬停处理程序。一个用于“悬停”的功能和一个用于“悬停”的可选功能

有一个弹出窗口的引导实现[http://twitter.github.com/bootstrap/javascript.html#popovers](http://twitter.github.com/bootstrap/javascript.html#popovers) 也许查看源代码可能会启发你。

希望有帮助。

# php - PHP - 查询在本地工作，但不在服务器上

> ID：15694241
> 
> 赞同：0
> 
> 时间：2013-03-28T23:56:47.210
> 
> 标签：php, sql, subquery

我正在使用以下查询来获取有关学生的信息，他们设定的目标，它与什么标准相关，以及他们当前的该标准成绩是多少。

每个标准可以有多个等级，我想要最近的一个，所以我添加了一个子查询来获取最近的日期。

当我在 XAMPP 中对其进行测试时，该代码运行良好，但没有加载到我的服务器上。数据库是相同的，我不确定还有什么问题。

```
SELECT users.firstName, goals.goalgrade, 
standards.standard, goals.why, grades.grade                                 
FROM users
    LEFT JOIN goals ON goals.userid = users.id
    LEFT JOIN standards ON standards.id = goals.mid
    LEFT JOIN grades ON grades.testId = standards.standard
        AND grades.userId = users.id
        AND grades.date = (SELECT date FROM grades ORDER BY date DESC LIMIT 1)
WHERE users.teacherId = :teacherId
AND users.block = :block
ORDER BY $sortall 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:53:43.380

我解决了这个问题，想我会分享。XAMPP 的子查询可以单独使用日期，但服务器需要我添加我更改的表名：

```
 grades.date = (SELECT date FROM grades ORDER BY date DESC LIMIT 1) 
```

至：

```
AND grades.date = (SELECT grades.date FROM grades ORDER BY grades.date DESC LIMIT 1) 
```

我的服务器说它正在运行 MySQL 5.0，而 XAMPP 正在运行 MySQL 5.1.44。不确定这是否会有所作为，但它确实有效。干杯

# graphite - 在 Graphite 中组织度量存储？

> ID：15694242
> 
> 赞同：4
> 
> 时间：2013-03-28T23:56:55.807
> 
> 标签：graphite

如何让我的指标保存在根级别。目前已保存在统计信息层次结构下（见[石墨](http://i.stack.imgur.com/Qe1wJ.png)）想要保存在顶层（石墨）下

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-06T04:10:36.357

将这些设置添加到您的 statsd 配置文件（可能类似于`/etc/statsd.js`）

```
{
  ...(unrelated options)...
, graphite: {
    legacyNamespace: false
  , globalPrefix:  ""
  , prefixCounter: ""
  , prefixTimer:   ""
  , prefixGauge:   ""
  , prefixSet:     ""
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-06T03:41:52.947

看起来您将 statsd 与石墨.js 后端一起使用。

在代码中设置为使用**统计信息为指标添加前缀。**如果在 init() 期间没有提供全局前缀

[https://github.com/etsy/statsd/blob/master/backends/graphite.js](https://github.com/etsy/statsd/blob/master/backends/graphite.js)

```
line 180: globalPrefix  = globalPrefix !== undefined ? globalPrefix : "stats"; 
```

您将需要更改调用 init() 的方式以为其提供空白 gobalPrefix。

**或者**

您需要更改后端才能停止在所有 statsd 指标前加上**stats。**

# php - PHP MYSQL查询删除所有不在循环中的值

> ID：15694246
> 
> 赞同：1
> 
> 时间：2013-03-28T23:57:05.807
> 
> 标签：php, mysql

我试图想出一个可以做我想要的查询，但是它让我很难过，所以我想我会选择一些大脑的想法。

我有一个 excel 文件，它被读取并转换为每一行和每一列的循环。

excel文件上有大约5000个值，所以发生了很多循环，我希望它在第二个循环内查询数据库的列代码，如果我的数据库中有一个不是任何值它正在循环的代码将删除它。并且在循环中但不在数据库中的任何代码都将在页面上回显。

我的脚本工作正常，但它只是构建我感到困惑的查询。

任何建议都非常感谢，西蒙

我的代码：

```
fileName    = '2_1_2013_UPC_customer.xlsx';
$objPHPExcel = PHPExcel_IOFactory::load("2_1_2013_UPC_customer.xlsx");
include_once dirname(__FILE__) . ('/PHPExcel/Writer/Excel2007.php');
require_once dirname(__FILE__) . '/PHPExcel/IOFactory.php';
$objPHPExcel = PHPExcel_IOFactory::load("2_1_2013_UPC_customer.xlsx");
foreach ($objPHPExcel->getWorksheetIterator() as $worksheet) {
    $worksheetTitle     = $worksheet->getTitle();
    $highestRow         = $worksheet->getHighestRow(); // e.g. 10
    $highestColumn      = $worksheet->getHighestColumn(); // e.g 'F'
    $highestColumnIndex = PHPExcel_Cell::columnIndexFromString($highestColumn);
    $nrColumns          = ord($highestColumn) - 64;
    for ($row = 2; $row <= $highestRow; ++$row) {
        for ($col = 0; $col < $highestColumnIndex; ++$col) {
            $cell     = $worksheet->getCellByColumnAndRow($col, $row);
            $val      = $cell->getValue();
            $dataType = PHPExcel_Cell_DataType::dataTypeForValue($val);

            if ($val == null) {
            } else {

                if ($col == 0) {
                $name = $val;
                }
                if ($col == 2) {
                $description = $val;
            }
            if ($col == 3) {
                $reference = $val;
            }
            if ($col == 4) {
                $weight = $val;
            }
        }
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:01:53.047

在循环遍历 Excel 文件时构建一个包含所有代码的数组。在 Excel 文件中获得所有代码后，查询数据库并获取其中所有代码的数组。然后，您可以轻松地比较它们。一旦您不必担心所有 php_excel 代码，它应该会更容易做到。将两个数组分开后，您可以使用 php array_search 函数检查代码是否存在于两个数组中，然后处理它。

# magento - Magento CE 1.7.0.2 - 在 ADMIN 销售订单视图产品中添加 Next Previous

> ID：15694247
> 
> 赞同：0
> 
> 时间：2013-03-28T23:57:09.863
> 
> 标签：magento, magento-1.7

我看到了将下一个先前导航添加到产品页面前端的扩展和解决方案，但这不是我们需要的。

我们需要以下内容：

1.  Magento CE 1.7.0.2 - 管理面板->销售->订单

2.  打开订单，以便您查看

3.  在顶部有一个下一个和上一个按钮/链接以及其他按钮来管理订单。单击下一步将带您进入下一个连续订单。

此致，

乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:11:58.713

尝试创建一个重写的自定义模块`Mage_Adminhtml_Block_Sales_Order_View`

**配置.xml：**

```
<global>
    <blocks>
         <adminhtml>
            <rewrite>
                <sales_order_view>MageIgniter_NextBackButton_Block_Adminhtml_Sales_Order_View</sales_order_view>
            </rewrite>
        </adminhtml>
    </blocks>
 </global> 
```

**MageIgniter/NextPreviousButton/Block/Adminhtml/Sales/Order/View.php：**

```
class MageIgniter_NextBackButton_Block_Adminhtml_Sales_Order_View extends Mage_Adminhtml_Block_Sales_Order_View {

  public function  __construct() {
     if($url = $this->getPreviousUrl()){
       $this->_addButton('previous_button', array(
           'label'     => Mage::helper('sales')->__('Previous'),
           'onclick'   => 'setLocation(\'' . $url . '\')',
           'class'     => 'go'
       ));
     }

     if($url = $this->getNextUrl()){
       $this->_addButton('next_button', array(
           'label'     => Mage::helper('sales')->__('Next'),
           'onclick'   => 'setLocation(\'' . $url . '\')',
           'class'     => 'go'
       ));
     }

     parent::__construct();
  }

  // to convert to magento orm
  //http://www.magentocommerce.com/answers/discussion/3752/Filter-Order-Collection-by-attribute1-OR-attribute2/p1
  public function  getNextUrl() {
       $current_order_id = $this->getOrder()->getId();
       // get $id from db
       SELECT * FROM foo WHERE id > $current_order_id ORDER BY id LIMIT 1;
       // if found return 
       $this->getUrl('*/sales_order/view', array('order_id'=>$id))
      //else return false - at last record
  }

  public function  getPreviousUrl() {
       $current_order_id = $this->getOrder()->getId();
       // get $id from db
       SELECT * FROM foo WHERE id < $current_order_id ORDER BY id LIMIT 1;

       // if found return 
       $this->getUrl('*/sales_order/view', array('order_id'=>$id))
      //else return false - at last record
  }

} 
```

见/app/code/core/Mage/Adminhtml/Block/Sales/Order/View.php

阅读更多@[如何在 Magento 管理面板中添加新按钮到订单视图？](https://stackoverflow.com/questions/6642599/how-to-add-new-button-to-order-view-in-magento-admin-panel)

# unicode - 兼容性范式中的字符串是否已经处于相应的规范范式中？

> ID：15694257
> 
> 赞同：7
> 
> 时间：2013-03-28T23:58:22.130
> 
> 标签：unicode, normalization, unicode-normalization

我的测试告诉我，从 Unicode 6.2 开始，完全兼容性分解中的所有字符都具有 NFD_Quick_Check=Yes 属性。

这让我相信 isNFKD(x) 意味着 isNFD(x)，而 isNFKC(x) 意味着 isNFC(x)。

我的结论正确吗？那么稳定性呢？这些含义是否保证适用于 Unicode 标准的未来版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-29T22:42:06.620

你的结论是正确的。Unicode 标准附件#15 的部分[设计目标指出：](http://unicode.org/reports/tr15/#Design_Goals)

```
toNFKC(x) = toNFC(toNFKC(x))
toNFKD(x) = toNFD(toNFKD(x)) 
```

关于稳定性，如果规范化字符串不包含任何未分配的代码点，这将适用于 Unicode 的未来版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:20:41.883

我在[这里](http://unicode.org/reports/tr15/)找到了以下内容：

> 换句话说，**NFC 和 NFKC 的组成阶段是相同的**——只是它们的**分解阶段不同**，NFKC 应用了兼容性分解。

然后还有这个：

> 有两种形式的规范化可以转换为复合字符：规范化形式 C 和规范化形式 KC。*这些之间的区别取决于生成的文本是与原始非规范化文本的规范等效，还是与原始非规范化文本等效的兼容性。*（在 NFKC 和 NFKD 中，K 用于代表兼容性，以避免与代表组合的 C 混淆。）这两种类型的归一化在不同情况下都有用。
> 
> 在前三个图中，*NFKD 形式始终与 NFD 形式相同*，*NFKC 形式始终与 NFC 形式相同*，因此为简单起见，省略了这些列。

这就是我可以从文本中挑选出来的内容，它至少可以对您的部分问题有所启发。希望能帮助到你

[维基百科文章](http://en.wikipedia.org/wiki/Unicode_equivalence)中也有这张表：

NFD Normalization Form Canonical Decomposition：*通过规范等价对字符进行分解，多个组合字符按特定顺序排列。*

NFC Normalization Form Canonical Composition： *对字符进行分解，然后通过规范等价进行重构。*

NFKD规范化形式兼容性分解：*字符通过兼容性分解，多个组合字符按特定顺序排列。*

NFKC 规范化形式兼容性组合： *字符通过兼容性分解，然后通过规范等价重新组合。*

看看这些东西是什么的解释，我认为你不能得出结论，一个暗示另一个。NFD 通过规范等价分解，而 NFKD 通过兼容性分解。

在同一篇文章中，它还指出：

> 等价标准可以是规范 (NF) 或兼容性 (NFK)。

对我来说，这意味着它要么是规范的，要么是兼容的。NFD 和 NFKD 做不同的事情。

* * *

在此[实施说明](http://www.unicode.org/reports/tr15/#Implementation_Notes)文章中，它指出：

> 对于所有版本，甚至在 Unicode 4.1 之前，都遵循以下策略：
> 
> *规范化的字符串保证是稳定的；也就是说，一旦规范化，字符串就会根据所有未来的 Unicode 版本进行规范化。*

# tomcat - Amazon S3 中的 Tomcat/Apache Solr？那可能吗？

> ID：15694266
> 
> 赞同：1
> 
> 时间：2013-03-28T23:59:18.730
> 
> 标签：tomcat, solr, amazon-web-services

如何在 Amazon S3 服务上安装（如果可以的话）带有 Tomcat 的 Apache Solr？那可能吗？

我有一个 Drupal 站点，并且想在我的站点中使用 Apache solr，而不会超载（并且无需支付像 Acquia 这样的服务，遗憾的是，这对我的预算来说太贵了）。

如果不是 S3，哪个亚马逊服务可以完成这项工作？

有没有办法做到这一点？感谢您的洞察力。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:08:40.967

您将无法在 S3 上使用 Tomcat 运行 Solr，您必须创建一个 Amazon EC2 实例才能做到这一点。您可以从 AWS 控制台启动一个 ubuntu 实例，然后寻找一个不错的教程，例如：[https ://github.com/sunspot/sunspot/wiki/Configure-Solr-on-Ubuntu,-the-quickest-way](https://github.com/sunspot/sunspot/wiki/Configure-Solr-on-Ubuntu,-the-quickest-way)

# javascript - 如何为文档化的 JavaScript 函数轻松创建 Github 友好的降价？

> ID：15694267
> 
> 赞同：66
> 
> 时间：2013-03-28T23:59:43.930
> 
> 标签：javascript, github, markdown, jsdoc

我希望能够在 JavaScript 源代码中的*任何地方*使用这样的 JSDoc 注释（甚至嵌套在多个函数层、模块甚至匿名函数中）：

```
/**
 *  Used to do some important thing that needs doing that works like xyz.
 *  @param {String} whatever - some string that has some purpose
 *  @param {Function} callback - a function that needs to be run
 *  @returns {Boolean} whether or not something happened
 */
 function something(whatever, callback) {
     ... 
```

并有一些简单的方法来产生漂亮的降价：

```
##`root.something(whatever,callback)`
Used to do some important thing that needs doing that works like xyz.

*Parameters*
  `whatever {String}` some string that has some purpose
  `callback {Function}` a function that needs to be run

*Returns*
   `{Boolean}` whether or not something happened 
```

其中“root”是可以访问该函数的命名空间。或者，如果它是匿名函数或私有函数（出于某种原因应该在公共文档中，这是否有意义？？），使用其他约定来表示。也许

```
##_private_function_ `something(whatever,callback)`

  and

##_anonymous_function_`(whatever,callback)` 
```

它不必完全是那种格式，只要在 Github 上看起来不错并且有意义即可。理想的工具应该足够聪明，能够接受像[Mustache.js](https://github.com/janl/mustache.js/blob/master/mustache.js)这样的代码并产生良好的输出。如果它可以处理大量源文件并生成一个文档作为输出，或者根据配置生成一组链接的文档，那就更好了。

如果这样做的方式可以完全轻松地包含在 git repo 中，那将是最好的，这样人们就不需要设置一个高度特定的工具链来更新 doco。或者至少需要一个最小的工具链。

哦，还有一匹小马。

* * *

# 现有选项

## [JSDoc](http://usejsdoc.org/)，加上某种 HTML -> markdown 转换

JSDoc 很不错。但我似乎无法让它与模块一起工作。或者更确切地说，这比恕我直言更麻烦。我不需要添加额外的标签来命名函数。我已经尝试了@export 和@name，但仍然无法让它以我想要的方式出现在最终文档中。如果有人可以指向一个 JSDoc 注释源，其中包含模块并且做得很好，那可能会有所帮助。 **更新：** JSDoc v3 实际上似乎比 v2 模块好得多，所以这可能更合适。

即使我可以得到我想要的 JSDoc 输出，我也需要从 HTML 转换为 markdown。我似乎无法找到一个好的工具，是否存在？

## [文档](https://github.com/jdalton/docdown)

我在 Docdown 上玩了一点，但事实上它是 PHP 对我来说是一种行不通的...

## [YUIDoc](http://yui.github.com/yuidoc/)，加上转换

我实际上没有玩过 YUIDoc，但它看起来还不错。不过，我需要一个转换器。它是否容易处理模块并避免显式提供函数名称和导出名称？

## [Dox](https://github.com/visionmedia/dox)和 markdown 模板

Dox 会生成 JSON 作为其输出，因此您需要将其与一些好的降价模板结合起来，并包含一个模板引擎来生成文档。有没有人以有用的方式整理了一组这样的模板？

## [jGrouse](http://jgrouse.com/) , 加转换

与 ANT 一起运行。下一个...

## 脚本文档...

这还存在吗？似乎是 Aptana 工作室的一部分，所以这将是一个初学者...... Aptana 似乎没有任何关于它的信息。但是 ScriptDoc.org 有一些关于破解的有趣信息，如果这有帮助的话......

## [博士后](http://pdoc.org/)

Pdoc 是基于 Ruby 的，但该工具链并不少见，所以这不是一个大问题。您可以提供自己的模板，所以也许已经有一些很好的降价模板。我没玩过……值得吗？那里有好的降价模板吗？

## 还有什么？

还有什么？

## 做你自己的！

在把 JSDoc 弄乱了几个小时试图让它按我想要的方式工作之后，我放弃了，并用 Java为[CharFunk](https://github.com/joelarson4/CharFunk)[编写了我自己的快速而肮脏的解决方案](https://github.com/joelarson4/CharFunk/blob/master/src/java/GenDoco.java)，这是我一直在研究的一个 unicode JavaScript 库。尽管它还没有接近通用目的，但它足以满足我的需要。

* * *

# 所以.....

这是一个未满足的需求还是只是我？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2014-03-03T21:07:30.427

我使用[jsdoc-to-markdown](https://github.com/75lb/jsdoc-to-markdown) ..

编写文档化代码：

```
/**
a quite wonderful function
@param {object} - privacy gown
@param {object} - security
@returns {survival}
*/
function protection(cloak, dagger){} 
```

获取降价文档：

```
$ jsdoc2md example/function.js

#protection(cloak, dagger)
a quite wonderful function

**Params**

- cloak `object` - privacy gown
- dagger `object` - security

**Returns**: `survival` 
```

这些项目的自述文件由`jsdoc2md`：

*   [手刹-js](https://github.com/75lb/handbrake-js)
*   [数组工具](https://github.com/75lb/array-tools)
*   [命令行参数](https://github.com/75lb/command-line-args/blob/master/doc/API.md)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-09T16:06:27.573

[markdox](https://github.com/cbou/markdox)可以从 javascript 代码生成 markdown 文档。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-21T16:20:13.533

jsDox。[https://github.com/sutoiku/jsdox](https://github.com/sutoiku/jsdox) 使用 UglifyJS 完全解析

莫克斯。[https://github.com/tjchaplin/mox](https://github.com/tjchaplin/mox) 几个准备运行的示例/模板。

两者都处理 JSDoc/Dox 格式。两者都有积极的发展。对我来说，Mox 因示例套件而获胜。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-29T00:45:28.947

好的。在与自己深思熟虑之后，我会选择 DOX + Underscore/Whatever JS 模板引擎而不是 Node。

应该很简单。您甚至可以插入 Grunt 或类似软件，并让它在监视任务下运行。

据我所知，Dox 是相对轻量级的，并且有一个 npm 包（IIRC）。

更新：我认为，经过一些经验，我想改变对 YUIDoc 的回答。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-18T14:28:44.603

我需要从 JSDoc 中创建一个 API 文档，它应该易于使用并且还支持现代前端堆栈。一些提到的库在将 JS 代码转译为 babeljs 时存在问题，因此您必须临时转译带有注释的代码，以生成您的降价文档。

对于这样的用例，我发现[http://documentation.js.org/](http://documentation.js.org/)非常有用，因为它们集成了对 BabelJs 配置的支持，因此它负责从您的 JSDocs 生成 Markdown（JSON、HTML）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-07T15:07:22.290

尝试使用[动词](https://github.com/jonschlinkert)。在最简单的用例中，Verb 将使用 package.json 中的数据从模板构建自述文件。

但是如果你需要生成多页目录，或者创建自定义助手等，动词也有高级功能。

关于 API 文档，请[参阅](https://github.com/jonschlinkert/data-store#api)使用`index.js`. 单击标题，它们也是自动生成的。使用[此内置帮助](https://github.com/jonschlinkert/option-cache/blob/master/.verb.md#api)程序从指定的任何文件路径生成 API 文档。您还可以使用 glob 模式从多个文件中提取文档。

动词将在`.verb.md`没有任何配置的情况下构建。但是如果你需要更多，你可以使用[verbfile.js](https://gist.github.com/jonschlinkert/822c64d8f6d5ff4a4783)

# python - 如何强制 zlib 解压超过 X 字节？

> ID：15694270
> 
> 赞同：1
> 
> 时间：2013-03-29T00:00:49.153
> 
> 标签：python, zlib

我有一个由压缩内容和 32 字节标头组成的文件。标头包含时间戳、压缩大小和未压缩大小等信息。

该文件本身约为 490mb，标题表明未压缩大小接近 2.7gb（显然不正确，因为它还认为压缩大小为 752mb）。

我已经剥离了标头并生成了压缩的有效负载，并且可以使用 zlib 解压缩它。

问题是它只解压缩了 19kb，比 490mb 小得多（应该是最低限度，但我预计未压缩大约 700mb）。

我的代码如下：

```
import zlib

def consume (inputFile):
    content = inputFile.read()
    print "Attempting to process " + str(len(content)) + " bytes..."
    outfile = open('output.xml', 'w')
    inputFile = zlib.decompress(content)
    print "Attempting to write " + str(len(inputFile)) + " bytes..."
    outfile.write(inputFile)
    outfile.close()

infile = open('payload', 'rb') 

consume(infile)

infile.close() 
```

运行时，程序输出：

> > > 正在尝试处理 489987232 字节...正在尝试写入 18602 字节...

我尝试使用`zlib.decompressionobj()`，尽管这会产生不正确的标题警告。`zlib.decompress()`工作正常并生成我期望的解压缩 XML ......只是它太少了。

非常感谢任何指针或建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:12:00.960

您显然有一个损坏的文件。

您将无法强制 zlib 忽略损坏——而且，如果您这样做了，您很可能会得到 700MB 的垃圾，或者一些随机数量的垃圾，或者……嗯，这取决于损坏是什么，并且在哪里。但是你能得到任何有用的东西的机会非常渺茫。

`zlib`的块不是随机可访问的，也不是分隔的，甚至是字节对齐的；除非您能够处理前一个块，否则很难判断您何时到达下一个块。

另外，树从一个块到另一个块生长，所以即使你可以跳到下一个块，你的树也会出错，你会解压垃圾，除非你非常非常幸运并且不需要破碎的部分那个树。更糟糕的是，任何块都可以重新启动树（甚至切换压缩器）；如果你错过*了*，即使你很幸运，你也在解压*垃圾*。而且这不仅仅是“跳过这个字符串，因为我不认识它”的问题，如果你不认识，你甚至不知道这个字符串有多少位，所以你不能跳过它。这让我们回到了第一点——你甚至不能跳过一个字符串，更不用说一个完整的块了。

要更好地理解这一点，请参阅[RFC 1951](http://www.ietf.org/rfc/rfc1951.txt)，它描述了`zlib`. 尝试手动处理一些简单的示例（第一个块中只有几个字符串，第二个块中只有几个新字符串），看看以难以撤消的方式破坏它们是多么容易（除非你确切知道它们是如何已损坏）。这并非*不可能*（毕竟，破解加密消息并非不可能），但我不相信它可以完全自动化，而且这不是你可能会为了好玩而做的事情。

如果您有关键数据（不能只是重新下载、回滚到以前的版本、从备份恢复等），一些数据恢复服务声称能够恢复损坏的 zlib/gz/zip 文件. 我猜这需要花费一条胳膊和一条腿，但这可能是正确数据的正确答案。

当然，我认为这不是自动化的可能是错误的。那里有一堆 zip 恢复工具。据我所知，他们对损坏的 zlib 流所能做的就是跳过该文件并恢复其他文件……但也许其中一些技巧在某些情况下对损坏的流有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:53:20.117

您需要检查`zlib.error`它为什么停止。为什么停止了？

# c++ - Kosmos 文件系统 (KFS) 如何处理反射？

> ID：15694272
> 
> 赞同：0
> 
> 时间：2013-03-29T00:00:54.433
> 
> 标签：c++, distributed-filesystem

复活节快乐！

我正在用 C++ 编写分布式文件系统。而且，为了完全控制它，我编写了自己的 RPC。这个 RPC 框架的最后一个悬而未决的问题是反射，因为 C++ 没有提供它。

我知道 KFS 是用 c++ 编写的 DFS，但我不知道它的实现，所以我求助于各位善良和知识渊博的人。

我想它可能有一些方法来处理它的 RPC，不是吗？它是否以某种方式使用反射？如果它不使用反射，是否有任何其他基于 c++ 的分布式应用程序使用它。他们如何使用它？

请随时提出建议，我喜欢想法。

干杯，埃尔顿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T01:20:19.097

我不知道 KFS/QFS。但是在 C++ 中进入反射的方法是考虑 LLVM。

# javascript - 控制台日志不从函数打印变量

> ID：15694273
> 
> 赞同：2
> 
> 时间：2013-03-29T00:00:57.247
> 
> 标签：javascript, arrays, function, return-value, console.log

试图将变量“randomWord”打印到 console.log，但 chrome 说它没有定义。它看起来像是对我定义的。为什么它不会打印到 console.log？

```
function strt(){

//get random word from words[] array
var randomWord = words[Math.floor(Math.random()* words.length)];

var wordLength = randomWord.length;

//create a blank boxes or div elements for holding each letter of 
// selected random word
for(i = 0 ; i< wordLength; i++){

var divTag = document.createElement("div");
divTag.id = "div" + i;
divTag.className = 'wordy';
//divTag.innerHTML = randomWord[i];
hangManDiv.appendChild(divTag);

};// end for loop

//disable start button
document.getElementsByName("startB")[0].disabled = true;

return randomWord;

}//end strt()

console.log(randomWord); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T00:03:08.933

变量`randomWord`超出范围。您在函数内部定义变量，然后在函数*外部*调用它。

您应该在函数之外定义变量或在函数内部调用它：

```
function strt(){
   var randomWord;
   ...
   console.log(randomWord);
   return randomWord;
}//end strt() 
```

或者

```
var randomWord;
function strt(){
   ...
   return randomWord;
}//end strt()
strt(); // Call the function
console.log(randomWord); 
```

对于后者，考虑到`randomWord`JS 执行控制台日志功能时不会发生变化；因此，它将为空。换句话说，您必须在记录之前调用该函数。

# php - 如何从多维数组中删除重复值

> ID：15694280
> 
> 赞同：2
> 
> 时间：2013-03-29T00:01:26.730
> 
> 标签：php, arrays

我有一个这样的数组数组：

```
Array
(
    [userId] => 35
    [fieldId] => Array
        (
            [0] => 1
            [1] => 2
            [2] => 3
            [3] => 1
            [4] => 2
            [5] => 2
            [6] => 1
            [7] => 4
        )

    [educationTitle] => Array
        (
            [0] => School1
            [1] => School2
            [2] => 3
            [3] => School1
            [4] => School2
            [5] => School2
            [6] => School1
            [7] => 
        )
) 
```

我想删除每个数组的所有重复项。所以，我希望最终的数组看起来像这样：

```
Array
(
    [userId] => 35
    [fieldId] => Array
        (
            [0] => 1
            [1] => 2
            [2] => 3
            [7] => 4
        )

    [educationTitle] => Array
        (
            [0] => School1
            [1] => School2
            [2] => 3
            [7] => 
        )
) 
```

我已经尝试过了（如此答案[https://stackoverflow.com/a/307701/1009116](https://stackoverflow.com/a/307701/1009116)中所建议的那样）：

```
 function multi_unique($updates) {
    foreach ($updates as $k=>$na)
        $new[$k] = serialize($na);
    $uniq = array_unique($new);
    foreach($uniq as $k=>$ser)
        $new1[$k] = unserialize($ser);
    return ($new1);
} 
```

而且没有效果

我也试过这个（这里推荐 - [https://stackoverflow.com/a/946300/1009116](https://stackoverflow.com/a/946300/1009116)）

```
$input = array_map("unserialize", array_unique(array_map("serialize", $input))); 
```

这只是返回最后一个数组（但是，它应该被过滤）

我究竟做错了什么？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:06:26.120

您可以`array_combine()`在这种情况下使用；稍后您将数据拆分到各自的容器中。

```
$combined = array_combine($arr['fieldId'], $arr['educationTitle']);

$arr['fieldId'] = array_keys($combined);
$arr['educationTitle'] = array_values($combined); 
```

请注意，在此操作之后，原始索引会重新编号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T00:07:07.830

您可以使用 ：

```
$data = array(
        'userId' => 35,
        'fieldId' => array(
                0 => 1,
                1 => 2,
                2 => 3,
                3 => 1,
                4 => 2,
                5 => 2,
                6 => 1,
                7 => 4
        ),
        'educationTitle' => array(
                0 => 'School1',
                1 => 'School2',
                2 => 3,
                3 => 'School1',
                4 => 'School2',
                5 => 'School2',
                6 => 'School1',
                7 => NULL
        )
);

print_r(arrayUnique($data)); 
```

输出

```
Array
(
    [userId] => 35
    [fieldId] => Array
        (
            [0] => 1
            [1] => 2
            [2] => 3
            [7] => 4
        )

    [educationTitle] => Array
        (
            [0] => School1
            [1] => School2
            [2] => 3
            [7] => 
        )

) 
```

使用的功能

```
function arrayUnique($array) {
    $input = array_map("unserialize", array_unique(array_map("serialize", $array)));
    foreach ( $input as $key => $value ) {
        is_array($value) and $input[$key] = arrayUnique($value);
    }
    return $input;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:58:14.407

使用 array_flip() 的另一种方法；

```
<?php
    $myArray = array( "userID"=>'35',
    "fieldID" => array(
    "0" => '1',"1" => '2',
    "2" => '3',"3" => '1',
    "4" => '2',"5" => '2',
    "6" => '1',"7" => '4'),
    "educationTitle"=>array(
    "0"=>'School1',"1"=>'School2',
    "2"=>'3',"3"=>'School1',
    "4"=>'School2',"5"=>'School2',
    "6"=>'School1',"7"=>'',),);

    print_r($myArray);

    $myArray['fieldID'] = array_flip($myArray['fieldID']);
    $myArray['fieldID'] = array_flip($myArray['fieldID']);
    $myArray['educationTitle'] = array_flip($myArray['educationTitle']);
    $myArray['educationTitle'] = array_flip($myArray['educationTitle']);

    print_r($myArray);
?> 
```

最终输出

```
Array
(
    [userID] => 35
    [fieldID] => Array
        (
            [6] => 1
            [5] => 2
            [2] => 3
            [7] => 4
        )

    [educationTitle] => Array
        (
            [6] => School1
            [5] => School2
            [2] => 3
            [7] => 
        )

) 
```

# php - utf8 在回显文本中未正确显示连字符

> ID：15694283
> 
> 赞同：2
> 
> 时间：2013-03-29T00:01:32.507
> 
> 标签：php, mysql, utf-8, character-encoding

我的 MySQL 数据库设置为 utf8_unicode_ci 并且我将 $pdo->exec('SET NAMES "utf8"') 作为以下 php 代码的一部分，但是当我从查询中回显文本时使用连字符 - 看起来像这样 –。我在做什么错，为什么连字符显示不正确？

```
<?php    
    try {
        $pdo = new PDO('mysql:host=localhost;dbname=danville_tpf', 'danville_dan', 'password');
        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
        $pdo->exec('SET NAMES "utf8"');
    } catch (PDOException $e) {
        $output = 'Unable to connect to the database server.';
        include 'output.html.php';
        exit();
    }

    $output = 'Theme Park Database initialized';
    //include 'output.html.php';//

    try {
        $park_id = $_GET['park_id'];
        $query = "SELECT * FROM tpf_parks WHERE park_id = $park_id";
        $result = $pdo->query($query);
    } catch (PDOException $e) {
        $output = 'Unable to connect to the database server.';
        //include 'output.html.php';//
    }

    $output = 'Sucessfully pulled park';
    //include 'output.html.php';//

    foreach ($result as $row) {
        $parkdetails[] = array(
            'name' => $row['name'],
            'blurb' => $row['blurb'],
            'website' => $row['website'],
            'address' => $row['address'],
            'logo' => $row['logo']
        );    
    }
?> 
```

请帮忙。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-29T00:33:29.097

# c++ - 嵌入式 typedef 。巨大的链接器错误

> ID：15694286
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:01:51.167
> 
> 标签：c++, typedef

我的班级目前看起来像这样

```
 class Hist
    {
    private:
    typedef boost::tuple<double,double,double> tuple;
    typedef boost::shared_ptr<tuple> shared_tuple;
    typedef std::vector<shared_tuple> tuple_vector;
    typedef boost::shared_ptr<tuple_vector> shared_tuple_vector;

    typedef std::map<int,shared_tuple_vector> inner_map;
    typedef boost::shared_ptr<inner_map> shared_inner_map;

    static std::map<std::string, shared_inner_map> stat_History_base;
    static bool CheckStatus(std::string symb );
    }; 
```

然后我有这个方法，它导致了一个非常非常大的链接器错误。

```
 bool Hist::CheckStatus(std::string symb )
{

    std::map<std::string,Hist::shared_inner_map>::iterator found =  stat_History_base.find(symb);
    if(found != stat_History_base.end())
    {
        //Symbol does exist
        return true;
    }
    else
    {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:09:51.110

似乎问题在于您没有为您的静态成员变量提供*定义*`stat_History_base`。

您应该将其添加到全局命名空间：

```
std::map<std::string, BaseHistory::shared_inner_map_def> 
BaseHistory::stat_History_base; 
```

请注意，您必须`shared_inner_map_def`公开才能从外部代码访问它（在您的代码中它当前被声明为`private`）。

还：

> 最初它工作正常，直到我用向量替换了 std::list

很难相信情况确实如此，因为您的代码的问题在于它缺少静态数据成员的定义。

# javascript - 将动态测验中的响应与 jquery 进行比较

> ID：15694288
> 
> 赞同：0
> 
> 时间：2013-03-29T00:01:53.620
> 
> 标签：javascript, jquery, html, json

嗨，我在 jquery 上完全是菜鸟，我正试图精简，所以我决定做一个动态测验，以提高我的技能，我一直在一步一步做，然后尝试把它全部包装起来。我陷入了如何检查我的复选框中的一个是否被选中以比较其是否正确答案然后更新问题和答案的方式。这是我的html：

```
<!DOCTYPE html>
<html lang='es'>
<head>
<meta charset='UTF-8'>
<title>Dynamic Quiz</title>
<link rel="stylesheet" type="text/css" href="css/normalize.css">
<link rel="stylesheet" type="text/css" href="css/estilos.css">
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/prefixfree.js"></script>
<script type="text/javascript" src="js/codigo.js"></script>
</head>
<body>
<header>
    <hgroup>
        <h1>This is my Dynamic Quiz</h1>
        <h2>Using html5 / css / javascript</h2>
    </hgruop>
</header>

<section id='description'>
    <p>This quiz is compossed by 10 questions, you have to answer at least 7
       from 10 to pass the exam.</p>
    <h2>Lets start!</h2>
</section>

<div id='questions-number'>
    <p>Question <span id='current-question'>1</span> of <span>10</span> </p>
</div>

<section id='questions'>
    <p id='question'></p>

    <ul>
        <li><input type='checkbox' id='checkAnswer0'/><label id='answer0'>answer0</label></li>
        <li><input type='checkbox' id='checkAnswer1'/><label id='answer1'>answer1</label></li>
        <li><input type='checkbox' id='checkAnswer2'/><label id='answer2'>answer2</label></li>
        <li><input type='checkbox' id='checkAnswer3'/><label id='answer3'>answer3</label></li>
    </ul>
</section>

<div id='next'>
    next
</div>
</body>
</html> 
```

这就是我到目前为止在 jquery 中得到的:)

```
$(document).on('ready', ready);
function ready(){
var allQuestions =
[
    {
        question1: "Whats my real name?",
        choices1: ["Jhonnatan", "Alberto", "Tatan","Jaime"],
        answer1: 0
    },

    {
        question2: "Who is Colombia's president?",
        choices2: ["Alvaro Uribe", "Andres Pastrana", "Juan Manuel Santos","Tatan"],
        answer2: 2
    },

    {
        question3: "My favorite super heroe?",
        choices3: ["Batman", "Flash", "Tatan","Javascript"],
        answer3: 3
    },

    {
        question4: "Wich sports do i practice?",
        choices4: ["Climbing", "Swimming", "Programming","Running"],
        answer4: 0
    },

    {
        question5: "Whats my dad's name?",
        choices5: ["Alberto", "Jorge", "Javier","Jose"],
        answer5: 1
    },

    {
        question6: "Whats my favorite color?",
        choices6: ["Red", "Purple", "Blue","All"],
        answer6: 2
    },

    {
        question7: "My favorite alcoholic drink",
        choices7: ["Vodka", "Aguardiente", "Rum","Tekila"],
        answer7: 3
    },

    {
        question8: "Whats my favorite kind of music?",
        choices8: ["Hardcore", "Reggaeton", "Salsa","Programming"],
        answer8: 0
    },

    {
        question9: "How many qestions has this quiz??",
        choices9: ["20", "8", "10","12"],
        answer9: 2
    },

    {
        question10: "My favorite programming lenguage?",
        choices10: ["Ruby", "Arduino", "Python","Javascript"],
        answer10: 3
    }
];
var question = $('#question');
var choice1 = $('#answer0');
var choice2 = $('#answer1');
var choice3 = $('#answer2');
var choice4 = $('#answer3');

question.text(allQuestions[0].question1);
choice1.text(allQuestions[0].choices1[0]);
choice2.text(allQuestions[0].choices1[1]);
choice3.text(allQuestions[0].choices1[2]);
choice4.text(allQuestions[0].choices1[3]);
console.log('funcionando!');

var next = $('#next');
next.on('click', changeQuestion);   
function changeQuestion(){
    var checked = $('#checkAnswer0');
    if($checked.prop('checked')){
        console.log('correcto')else{
            console.log('no es correctp'); 
        }
    }
}
} 
```

如果您能帮我解决这个问题，我将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:38:38.967

很高兴你正在努力学习。您可以在之后练习很多清理和效率方面的事情，但是您可以通过多种方式找到选中的元素，例如`$(elem).is(':checked')`或`$(':checked')`查找全部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:44:01.403

[这个例子](http://jsfiddle.net/AYU5Y/)似乎做了你想要完成的事情。我试图尽可能少地修改你的代码，所以希望这是有道理的！

例如，当键一致时，遍历对象/数组要容易得多。

```
{
    question: "Whats my real name?",
    choices: ["Jhonnatan", "Alberto", "Tatan","Jaime"],
    answer: 0
},

... instead of ...

{
    question1: "Whats my real name?",
    choices1: ["Jhonnatan", "Alberto", "Tatan","Jaime"],
    answer1: 0
}, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T02:10:57.100

这就是我做到的：）我很高兴我做到了，我刚刚看到了@cmallard 的例子，似乎我还需要改进一些东西，而且我似乎以正确的方式......如果你们有任何建议我想见他们！:)

```
$(document).on('ready', ready);
function ready(){
var allQuestions =
[
    {
        question: "Whats my real name?",
        choices: ["Jhonnatan", "Alberto", "Tatan","Jaime"],
        answer: 0
    },

    {
        question: "Who is Colombia's president?",
        choices: ["Alvaro Uribe", "Andres Pastrana", "Juan Manuel Santos","Tatan"],
        answer: 2
    },

    {
        question: "My favorite super heroe?",
        choices: ["Batman", "Flash", "Tatan","Javascript"],
        answer: 3
    },

    {
        question: "Wich sports do i practice?",
        choices: ["Climbing", "Swimming", "Programming","Running"],
        answer: 0
    },

    {
        question: "Whats my dad's name?",
        choices: ["Alberto", "Jorge", "Javier","Jose"],
        answer: 1
    },

    {
        question: "Whats my favorite color?",
        choices: ["Red", "Purple", "Blue","All"],
        answer: 2
    },

    {
        question: "My favorite alcoholic drink",
        choices: ["Vodka", "Aguardiente", "Rum","Tekila"],
        answer: 3
    },

    {
        question: "Whats my favorite kind of music?",
        choices: ["Hardcore", "Reggaeton", "Salsa","Programming"],
        answer: 0
    },

    {
        question: "How many qestions has this quiz??",
        choices: ["20", "8", "10","12"],
        answer: 2
    },

    {
        question: "My favorite programming lenguage?",
        choices: ["Ruby", "Arduino", "Python","Javascript"],
        answer: 3
    }
];

var number=0;
var question = $('#question');
var choice1 = $('#answer0');
var choice2 = $('#answer1');
var choice3 = $('#answer2');
var choice4 = $('#answer3');
var next = $('#next');
var currentQuestion = $('#current-question');

next.on('click', changeQuestion);
addQuestionAndAnswers();    

function addQuestionAndAnswers() {
    currentQuestion.text(number + 1);
    question.text(allQuestions[number].question);
    choice1.text(allQuestions[number].choices[0]);
    choice2.text(allQuestions[number].choices[1]);
    choice3.text(allQuestions[number].choices[2]);
    choice4.text(allQuestions[number].choices[3]);
    console.log('funcionando!');
}

function changeQuestion(){
    if(number!=9){
        if($("#myForm input[type='radio']:checked").val() ==
 allQuestions[number].answer){
            number = number +1;
            addQuestionAndAnswers();
        } else{
            console.log('respuesta errada');
        }
    } else {
        displayResult();
    }

    function displayResult(){
        currentQuestion.text('10');
        $('#myForm').css('display', 'none');
        $('#question').css('display', 'none');
        $('#next').css('display', 'none');
        $('#score').css('display', 'inline-block')
        $('#score').text('Your score is: ' + (number + 1) + 'pts');

    }
}
} 
```

# c# - 目标无法识别的转义序列错误

> ID：15694302
> 
> 赞同：0
> 
> 时间：2013-03-29T00:03:37.807
> 
> 标签：c#, escaping, antlr

我之前使用过 AntlrWorks 1.4 为 C# 目标生成解析器和词法分析器。现在我开始一个新项目，我尝试使用 antlrworks1.5。但是生成的词法分析器在 C# 代码中有很多转义序列错误。我尝试了 1.4 版本，它工作正常。

基本上，错误是，在 1.5 生成的代码中，它具有像“\1\2\3”这样的无效转义，而在 1.4 生成的代码中它们是“\x01\x02\x03”。

有没有办法在 1.5 版本上解决这个问题？或者我必须坚持使用 1.4 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T02:58:10.553

ANTLR 3 的 C# 端口未经测试可与 ANTLRWorks 一起使用或在使用 Java 版本的工具生成代码时。它仅针对使用 MSBuild 集成和/或 Antlr3.exe 生成代码进行测试。任何暗示 ANTLRWorks 和/或 ANTLR 工具的 Java 版本可用于为 CSharp3 或 CSharp2 目标生成代码的行为纯属巧合。

您可以在以下站点下载 C# 端口以及用于配置 C# 项目以自动构建语法的文档：

[http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases](http://www.antlr.org/wiki/display/ANTLR3/Antlr3CSharpReleases)

# ruby-on-rails - 安装 ruby 2 的 RVM 问题

> ID：15694303
> 
> 赞同：5
> 
> 时间：2013-03-29T00:03:53.580
> 
> 标签：ruby-on-rails, ruby, rvm

我做了`rvm get stable`

然后我尝试安装 ruby​​ 2.0.0

```
$ **rvm install 2.0.0** 
Searching for binary rubies, this might take some time.
No binary rubies available for: osx/10.8/x86_64/ruby-2.0.0-p0.
Continuing with compilation. Please read 'rvm mount' to get more information on binary rubies.
Installing requirements for smf, might require sudo password.
Installing SM Framework.
Error running 'requirements_smf_install_sm',
please read /usr/local/rvm/log/ruby-2.0.0-p0/smf_install.log

$ **cat /usr/local/rvm/log/ruby-2.0.0-p0/smf_install.log**
[2013-03-28 20:58:11] requirements_smf_install_sm
SMF Framework support is only intended for RailsInstaller, please use Homebrew integration instead. 
```

错误日志不是很有帮助。我在 Mac OS X Mountain Lion 上。有什么帮助吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-07T14:31:05.477

这是因为 RVM 被设置为使用不同的库系统：SMF。您需要将 RVM 设置为使用 brew 。这是 rvm autolibs 上的页面 [https://rvm.io/rvm/autolibs/](https://rvm.io/rvm/autolibs/)

用于`rvm autolibs show`查看您当前的设置是什么，如果您使用的是 brew，您可以使用 `rvm autolibs brew`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-29T01:09:22.943

尝试运行

```
brew update 
```

如果您没有安装 brew ，这里有一个很好的指南来完成整个安装过程，您可以忽略 1.9.3 的东西并将其替换为 2.0.0

[http://www.moncefbelyamani.com/how-to-install-xcode-homebrew-git-rvm-ruby-on-mac/](http://www.moncefbelyamani.com/how-to-install-xcode-homebrew-git-rvm-ruby-on-mac/)

# database - PHP 脚本返回：SQLSTATE[HY093]: Invalid parameter number: parameter was not defined

> ID：15694309
> 
> 赞同：1
> 
> 时间：2013-03-29T00:04:13.737
> 
> 标签：database, pdo

我查看了与我的问题本质上相似的其他一些问题，但我没有在此 PDO 数据库编写器脚本中使用数组或循环。对其他一些解决方案感到困惑，我仍然发现自己陷入了这个问题。

我的脚本是这样写的：

```
<?php
class DatabaseWriter
{
    public function writeUserToDatabase($email , $name , $age , $gender , $country , $category)
    {   
        $host = '***********';
        $dbname = 'emailcollection';
        $user = '**********';
        $pass = '**********';
        $jointime = '2013-01-07 11:19:08';

        try {
            $connection = new PDO("mysql:host=" . $host . ";dbname=" . $dbname, $user, $pass);
            $connection -> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
            $statement = $connection -> prepare("INSERT INTO emailcollection (emailaddress, name, age, gender, country, category, jointime) VALUES (:emailaddress, :name, :age, :gender, :country, :category, :jointime)");
            $statement -> bindValue(':email', $email);
            $statement -> bindValue(':name', $name);
            $statement -> bindValue(':age', $age);
            $statement -> bindValue(':gender', $gender);
            $statement -> bindValue(':country', $country);
            $statement -> bindValue(':category', $category);
            $statement -> bindValue(':jointime', $jointime);
            $statement -> execute();

            $connection = NULL;
        }catch (PDOException $e){
            echo $e -> getMessage();
        }
    }
} 
```

?>

输出：

> SQLSTATE[HY093]：参数号无效：参数未定义

您可能想知道 $jointime 是什么。那是表中的最后一列，因为我收到“无效参数编号”的内容，我认为我应该完全匹配列数（我试图在写入用户时添加时间戳，在 PHP 或 SQL 中）。

**提前感谢您的反馈。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T02:47:16.207

解决方案是查询使用列名 :emailaddress，而 bindValue() 引用的是 :email。

# c# - 在 Page_Init 期间强制 HTTPS 的最简单方法

> ID：15694312
> 
> 赞同：4
> 
> 时间：2013-03-29T00:04:46.660
> 
> 标签：c#, asp.net, https, security, httpcontext

在我网站的极少数页面上，我想确保它们只能通过 HTTPS 连接访问。实现这一目标的最佳方法是什么。我看到的所有示例似乎都在尝试为整个站点执行此操作。

我希望能在`Page_Init`or上找到一种方法来实现这一点`Page_Preload`。

并重定向到 Https 版本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T00:09:40.883

您可以访问[`IsSecureConnection`](http://msdn.microsoft.com/en-us/library/system.web.httprequest.issecureconnection.aspx)请求的属性并重定向：

```
if (!Request.IsSecureConnection) {
    Response.Redirect(...);
} 
```

您可能有对要重定向到的页面的引用，或者您可以从这些`Request.Url`部分构造一个 https Uri，依此类推，但您可以在上面进行检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T19:27:23.207

我建议您使用 HTTP 严格传输安全性。

有关更多详细信息，请查看此处：

[https://www.owasp.org/index.php/HTTP_Strict_Transport_Security](https://www.owasp.org/index.php/HTTP_Strict_Transport_Security)

有任何问题，请告诉我。

谢谢法比奥@fcerullo

# java - 在 JasperReports 中动态添加 textField

> ID：15694313
> 
> 赞同：0
> 
> 时间：2013-03-29T00:04:55.720
> 
> 标签：java, jasper-reports

有没有办法在 Jasper 报告中将 textFields 动态添加到 columnFooter。

我有可能不得不使用的情况：

```
 <columnFooter>
      <band height="21" splitType="Stretch">
        <textField isStretchWithOverflow="true">
            <reportElement x="0" y="0" width="50" height="21"/>
            <textElement textAlignment="Center" verticalAlignment="Middle"/>
            <textFieldExpression><![CDATA["Example text...."]]></textFieldExpression>
        </textField>
      </band> 
```

或者

```
 <columnFooter>
      <band height="42" splitType="Stretch">
        <textField isStretchWithOverflow="true">
            <reportElement x="0" y="0" width="50" height="21"/>
            <textElement textAlignment="Center" verticalAlignment="Middle"/>
            <textFieldExpression><![CDATA["Example text...."]]></textFieldExpression>
        </textField>            <textField isStretchWithOverflow="true">
            <reportElement x="0" y="0" width="50" height="21"/>
            <textElement textAlignment="Center" verticalAlignment="Middle"/>
            <textFieldExpression><![CDATA["More example text...."]]></textFieldExpression>
        </textField>
      </band> 
```

（或添加任意数量的文本字段。由于我不知道将添加多少，我需要以某种方式动态调整乐队的大小）我正在寻找一种在 Java 中动态执行此操作而不必在 jrxml 中对其进行硬编码的方法文件。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T07:54:39.867

使用第二种方法在 textFields 上设置 PrintWhenExpression 并在此 textFields 的属性上设置“空白时删除行”复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T11:25:39.067

如果您的报告是作为 JRDesign 动态创建的，您可以使用以下内容：

```
JRDesignBand band = (JRDesignBand) jasperDesign.getColumnFooter();
        JRDesignTextField textField = new JRDesignTextField();
        textField.setX(0);
        textField.setY(0);
        band.addElement(textField); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-16T16:37:11.677

很抱歉，在使用 JR Java API 多年之后，我感觉它是为在文档的固定布局上打印而设计的。对您的情况有什么帮助：如果您知道可能出现的最大字段数，只需将它们全部添加到乐队中，并将“空白时删除行”标志设置为 true。它将折叠未使用的字段。

# c++ - IDXGIFactory::CreateSwapChain() 返回 E_NOINTERFACE？

> ID：15694315
> 
> 赞同：0
> 
> 时间：2013-03-29T00:05:13.347
> 
> 标签：c++, com, directx-11, hresult

在我在 DirectX11 中设计的渲染器中，我需要能够随时创建交换链，但是我使用的方法在 CreateSwapChain() 调用时崩溃：

```
 IDXGIDevice * device;
    HR(d3ddevice->QueryInterface(__uuidof(IDXGIDevice), (void**)&device));

    IDXGIAdapter * adapter;
    HR(device->GetParent(__uuidof(IDXGIAdapter), (void**)&adapter));

    IDXGIFactory * factory;
    HR(adapter->GetParent(__uuidof(IDXGIAdapter), (void**)&factory));

    IDXGISwapChain* swapChain = 0;
    HR(factory->CreateSwapChain(_device->GetContent(), &description, &swapChain)); 
```

d3ddevice 是一个指向 ID3D11Device 的指针，完全初始化了所有内容，我对其进行了测试。description是一个DXGI_SWAP_CHAIN_DESC结构，每个字段都填写。但是函数返回E_NOINTERFACE。我的系统支持shader model 5/directx 11

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:10:05.470

您正在使用`IDXGIAdapter`查询时的 UUID `IDXGIFactory`：

```
IDXGIFactory * factory;
HR(adapter->GetParent(__uuidof(IDXGIAdapter), (void**)&factory)); 
```

尝试将其更改为`_uuidof(IDXGIFactory)`.

# javascript - 谷歌浏览器的点击错误元素 HTML： <select id="page"><option value="none">--</option> <option id="about" value="about">关于</option></select> JS：文档.getElementById('about').onclick = function(){ alert('normal onclick'); } $("#abo

> ID：15694321
> 
> 赞同：0
> 
> 时间：2013-03-29T00:06:04.107
> 
> 标签：javascript, html, google-chrome, webkit, click

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:25:38.277

在元素上放置一个事件处理程序`select`而不是`option`，它将在所有浏览器中工作。使用`change`和`keyup`事件：

```
$('#page').on( 'change keyup', function() {
    var selected = this.value;
    if( selected == 'about' )
        alert( 'About!' );
}); 
```

[更新的小提琴](http://jsfiddle.net/geary/S9ZK3/3/)

为什么`change`和`keyup`事件？该`change`事件处理鼠标交互，`keyup`当您使用箭头键或其他键在选择器中上下导航时，使选择器响应。

或者，您可以省略`keyup`并仅收听该`change`事件。然后，如果您打开选择器并使用光标键上下导航，则在您按下 Enter 之前不会发生任何事情。这将触发一个`change`事件。

在许多情况下，在使用键盘上下浏览列表时向用户提供即时反馈会更有帮助，并且聆听会这样做`change keyup`。

为什么`change`而不是`click`？您可以使用其中任何一种，但该`click`事件会在任何点击时触发，即使该值实际上并未更改。OTOH，即使用户只是单击已选择的选项，您也可能*希望*`click`事件触发，因此在这种情况下，事件会更好。

实际上，在对其进行了更多测试之后，`click`vs `change`. 问题还有更多内容。与选择列表的正常鼠标交互允许使用两种略有不同的方式：

1.  在选择器上按住鼠标，按住它，将其滚动到一个选项上，最后释放它。

2.  在选择器上按下鼠标*并释放它*。选择器打开以显示选项。将鼠标滚动到选项上（此时按钮未按下），最后单击选项上的按钮。

如果您侦听`click`事件而不是`change`，则在 #2 的情况下，事件会触发两次，分别是在初始单击和最终单击时选择一个选项。因此，您可以使用`click`or`change`取决于您是否想要两次点击或只是最终的选项选择。

我必须补充一点，我在`click`这里没有彻底测试过，但我已经测试过`change`并且`change keyup`非常彻底，所以我更信任那些。

# java - jdbc mysql查询我不确定选择了多少列

> ID：15694322
> 
> 赞同：0
> 
> 时间：2013-03-29T00:06:05.093
> 
> 标签：java, mysql, jdbc

完全披露：这是家庭作业。

我有一个用 java 编写的 GUI，它与一个数据库交互，有 4 个按钮来添加、删除、查询和修改。GUI 有 6 个文本字段（MemberNumber、LastName、FirstName、Address、TotalRentals 和 Account Balance）。

考虑到我事先不知道哪些文本字段可能输入了值，我将如何编写基于字段检索帐户信息的查询 sql 命令？如果只是 MemberNumber，那就是主键，很简单。但是如果是 LastName 和 TotalRentals，或者 LastName、TotalRentals 和 Address 呢？

我想我的问题是，我怎样才能使这个查询灵活？

# ruby-on-rails-3 - Rails/ActiveRecord 悲观锁定 - 获得锁定后是否需要重新加载？

> ID：15694326
> 
> 赞同：10
> 
> 时间：2013-03-29T00:06:57.253
> 
> 标签：ruby-on-rails-3, activerecord, concurrency, locking, delayed-job

我在 Rails 中有一个交易模型，表示将通过信用卡收取的金融交易。

创建事务时，其状态为`:new`。当我尝试结算费用时（将在 DelayedJob 中发生），我将状态更新为`:pending`。`charge`如果 status 不是，则任何后续调用都将被忽略`:new`。

## 朴素版本（不关心并发）：

```
# Trigger a card to be charged
def charge_transaction
  return unless status == :new

  self.transaction do
    self.delay.settle_credit_card
    self.update_attribute(:status, :pending)
  end
end

# Actually do the charging (in a delayed worker)
def settle_credit_card
   # ... Interact with our payment gateway
end 
```

由于这是一个 load_balanced Web 应用程序，我想确保我们考虑了并发性并且不会产生重复费用（由于并发请求）。我了解乐观锁定的好处，但在这种情况下，我不介意拥有这个关键区域，因为同时尝试收费（或以任何方式更新事务）应该是一个例外情况。

这是使用悲观行级锁定的尝试

## 并发版本（选项 1）

```
# Trigger a card to be charged
def charge_transaction

  # Obtain row-lock
  self.with_lock do
    self.reload # Reload once lock is obtained - necessary?

    # Check status after lock/reload
    return unless status == :new

    self.delay.settle_credit_card
    self.update_attribute(:status, :pending)
  end
end 
```

## 并发版本（选项 2）

```
# Trigger a card to be charged
def charge_transaction

  # Begin transaction without lock
  self.transaction do
    self.reload(lock: true) # Reload and obtain lock

    # Check status after lock/reload
    return unless status == :new

    self.delay.settle_credit_card
    self.update_attribute(:status, :pending)
  end
end 
```

这些方法中的任何一种（或两种）都有效吗？获得锁后是否需要显式重新加载（以确保事务对象是当前的）或者 Rails 会在获得锁时自动执行此操作？如果两种方法都有效，那么哪种方法更可取？

非常感谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-02-13T12:57:01.793

这两种方法都是有效的，并且会奏效。然而，在版本 1`reload`中不是必需的 - 锁定会自动重新加载记录，因此您可以将其删除。

然后，如果您检查 and 的源[代码](https://github.com/rails/rails/blob/db82e1d0bb21c2a13354b97733c09737719e946b/activerecord/lib/active_record/locking/pessimistic.rb)，您会发现您的两个版本是 100% 等效的：`with_lock``lock!`

```
def lock!(lock = true)
  reload(:lock => lock) if persisted?
  self
end

def with_lock(lock = true)
  transaction do
    lock!(lock)
    yield
  end
end 
```

使用`with_lock`将是最简单和首选的：

```
# Obtain row-lock
with_lock do
  # Check status after lock/reload
  return unless status == :new

  delay.settle_credit_card
  update_attribute(:status, :pending)
end 
```

（注意：您可以安全地退出`self`方法调用）

# html - 使用 CSS 使导航栏居中

> ID：15694330
> 
> 赞同：0
> 
> 时间：2013-03-29T00:07:27.280
> 
> 标签：html, css

我正在开发我的第一个网站，我对如何将导航栏居中感到有些困惑。我已经尝试定义一个宽度，确保它是一个块元素并将 margin-left 和 margin-right 设置为 auto 但它仍然没有居中。这是我的 css 和 html 文件。

HTML：

```
<html>
<head>
    <title>Test Site</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>
    <div class="nav">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Forums</a></li>
            <li><a href="#">Misc</a>
                <ul>
                    <li><a href="#">1</a></li>
                    <li><a href="#">2</a></li>
                    <li><a href="#">3</a></li>
                    <li><a href="#">4</a></li>
                </ul>
            </li>
            <li><a href="#">Donate</a></li>
        </ul>
    </div>
</body>
</html> 
```

CSS：

```
.nav > ul {
    width: 960px;
    display: block;
    margin-left: auto;
    margin-right: auto;
}

.nav ul {
    list-style: none;
    background: #444444;
    margin: 0px;
    padding: 0px;
}

.nav li {
    float: left;
    width: 150px;
    position: relative;
    background: #444444;
    text-align: center;
    border: 1px solid white;
    height: 30px;
    line-height: 30px;
}

.nav li ul li {
    float: none;
    width: 140px;
    text-align: left;
    padding: 5px;
    border-top: 1px solid white;
    line-height: 30px;
}

.nav li ul {
    position: absolute;
    top: 30px;
    left: 0px;
    visibility: hidden;
}

.nav li:hover {
    background-color: maroon;
}

.nav li:hover ul {
    visibility: visible;

}

.nav a {
    text-decoration: none;
    color: white;
}

.nav li ul {
    float: none;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:11:15.063

您正在*覆盖*使其居中的定义...

改变：

```
.nav > ul {
    width: 960px;
    display: block;
    margin-left: auto;
    margin-right: auto;
}

.nav ul {
    list-style: none;
    background: #444444;
    margin: 0px; /* overrides previously defined margin */
    padding: 0px; /* overrides previously defined margin */
} 
```

至：

```
.nav > ul {
    width: 960px;
    display: block;
    margin-left: auto;
    margin-right: auto;
}

.nav ul {
    list-style: none;
    background: #444444;
    /* margin: 0; */
    padding: 0px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T10:37:48.443

另一种（也是更好的）方法是

1.  交换`.nav > ul`和`.nav ul`规则的位置，即在（比较通用的）*之后*`.nav > ul`指定（更具体的）规则*`.nav ul`*
**   **并**设置`width: 608px;`_`.nav > ul`*

 *这是它的工作原理：

a)`.nav ul`将 设置`margin: 0; padding: 0`为所有`<ul>`元素。`<ul>`它删除了所有元素 的默认填充/边距。

b) 现在（假设对于`.nav > ul`，您没有将左右边距设置为and `auto`）您有一个左对齐的主导航，它水平地覆盖其容器。因此，要使其水平居中，您可以将其宽度设置为最小宽度，而无需将导航项目移动到新行，即，并将边距设置为以便在其容器中水平居中。`width``960px``608px``auto`

这是CSS

```
.nav ul{
   list-style: none;
   background: #444444;
   margin: 0px;
   padding: 0px;
}

.nav > ul{
   width: 608px;
   display: block;
   margin-left: auto;
   margin-right: auto;
} 
```

我希望它有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:16:34.687

将 .nav > ul ul 更改为 .nav > ul li 和

```
.nav li ul {
    position: relative;
    top: 0px;
    padding-left:0;
    visibility: hidden;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T00:20:24.463

的宽度`.nav>ul`设置为大于其中所有导航项的总宽度。它应该是`width: 608px;`并且您需要添加`margin: 0 auto;`到`.nav ul`规则声明

**最终规则`.nav > ul`和`.nav ul`**

```
.nav > ul{
  width: 608px;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.nav ul{
  list-style: none;
  background: #444;
  margin: 0 auto;
  padding: 0;
} 
```*

# haskell - 如何提升功能以应用单值容器？

> ID：15694331
> 
> 赞同：3
> 
> 时间：2013-03-29T00:07:47.530
> 
> 标签：haskell

我是Haskell的新手。我正在学习单子。

```
data Container a = Container a deriving Show

x = Container 1 :: Container Int

plusOne :: Container Int -> Container Int
plusOne (Container x) = Container (x+1) 
```

有什么办法可以解除`plusOne`申请`Container (IO Int)`吗？

或者我应该定义一个新函数，例如：

```
plusOne' :: Container (IO Int) -> Container (IO Int)  
plusOne' (Container x) = Container (liftM (+1) x) 
```

* * *

谢谢大家:-) 然后有什么办法可以避免重新定义 plusOne 吗？

因为当我构建程序时，首先我用非单子类型的容器（正常值，如：Container Int ..etc）构建程序，然后用指定值（Container 10..）测试函数。

之后，我尝试将这些程序应用于随机或生成的值。这是我用其他语言（例如 Lisp、Python ..）编程的基本方法

因此，当我想尝试将这些函数应用于 monadic-value 容器时，我不想重新定义函数。

这种方法不适用于 Haskell 编程？我应该改变我的思维模型吗？还是我对 Haskell 有误解？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T00:43:06.500

看起来`Container`应该是[Functor](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Functor)的一个实例：

```
instance Functor Container where
    fmap f (Container a) = Container (f a) 
```

然后

```
plusOne = fmap (+1) 
```

和

```
plusOne' = fmap $ liftM (+1) 
```

但是，现在我突然想到我可能误解了这个问题......

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-29T01:23:08.330

First things first, it looks like you've actually redefined [the `Identity` monad](http://hackage.haskell.org/packages/archive/mtl/1.1.0.2/doc/html/Control-Monad-Identity.html).

When you have functors containing other functors as you do here, you don't want to have to do all the bookkeeping yourself to make sure you've got the right number of `fmap`s and so on. That's where [monad transformers](http://www.haskell.org/haskellwiki/Monad_Transformers) come in.

[The MTL library](http://www.haskell.org/haskellwiki/Monad_Transformer_Library) (which should come with the Haskell Platform) has done all the hard work for you, you just need to do a bit (OK, quite a lot) of plumbing to make your own type work with all the existing monad transformers. Once you've done that, your `Container` should be a good citizen as a member of any monad stack.

Of course, the usual caveats apply: monad transformers are powerful and hard to understand. Half the times you think you need them, you don't really - so make sure you're using the right approach to solve your problem first.

# java - 如何从绝对路径名创建文件对象？

> ID：15694332
> 
> 赞同：5
> 
> 时间：2013-03-29T00:08:00.413
> 
> 标签：java, file, pathname

我认为我的问题需要对背景进行一些解释。我的任务是创建一个基本服务器，它将在我的系统上发送客户请求的 HTML 文件。我被告知只需输入`localhost:8080/index.html`我的 Firefox 浏览器作为测试客户端来测试我的服务器。输入该行输入可以正常工作并打印出`index.html`. 为了安全起见，我应该测试以确保请求的文件直接在我当前的工作范围内，如果不是，我应该拒绝该请求。我已经设置了这样一个捕获，我想检查它。我想`index.html`再次使用我的文件，但是使用整个路径名， `C:\Users\Gabrielle\Documents\NetBeansProjects\CS2 Assignment 5\src\index.html`所以我在浏览器中输入

`localhost:8080/C:\Users\Gabrielle\Documents\NetBeansProjects\CS2 Assignment 5\src\index.html`

我收到一个错误，说该文件不存在。然后我检查了它试图制作文件的内容以及它试图制作文件的内容，我得到了

`C:%5CUsers%5C%5CGabreille%5C%5CDocuments%5C%5CNetBeansProjects%5C%5CCS2%20Assignment%205%5Cindex.html`

这显然不是文件的名称。我只是错误地发送了文件名吗？如果它有任何区别，我正在从 Windows 命令提示符运行程序。下面是我的多线程客户端的代码和我的可运行对象的代码。如果您有任何问题或想要澄清，我会密切关注这个线程。

```
import java.io.*;
import java.net.*;

public class WebServer {

    public static void main(String[] args)
    {
        try{
            ServerSocket ss = new ServerSocket(8080);
            while(true){
                Thread conn = new Thread(new ClientConnection(ss.accept()));
                conn.start();
            }
        }
        catch(IOException e)
        {
            e.printStackTrace();
        }
    }
} 
```

以下是实际内容

```
import java.io.*;
import java.net.*;

public class ClientConnection  implements Runnable{

private Socket socket;
File requestedFileName;
String entireInput ="";
String editedInput="";
String fileContent="";
String fileLine="";
PrintWriter out;
File defaultFile = new File("index.html");
File toBeRead;

public ClientConnection(Socket socket)
{
    this.socket=socket;
}

public void run()
{
    try{
        System.out.println("Client Connected");
        String workingDirectory = System.getProperty("user.dir");
        BufferedReader in =
                new BufferedReader(new InputStreamReader(socket.getInputStream()));
         out = new PrintWriter(socket.getOutputStream());
        String line;
            entireInput = in.readLine();

        editedInput= entireInput.substring(entireInput.indexOf("GET")+3,
                entireInput.indexOf("HTTP/1.1"));
        System.out.println("File name:" + editedInput);
        requestedFileName = new File(editedInput);
        System.out.println("What about here?");
        if(editedInput.equals(" / ") || editedInput.equals("  "))
        {
            toBeRead = defaultFile;
            System.out.println("Parent file "+toBeRead.getParent());
            String absolutePath = toBeRead.getAbsolutePath();
            System.out.println("absolute path "+ absolutePath);
            String filePath = absolutePath.substring(0,absolutePath.lastIndexOf(File.separator));
            if(filePath.equals(workingDirectory))
            {
                System.out.println("is in directory");
            }
            else{
                System.out.println("not in directory");
            }
        }
        else
        {   

            String hope = editedInput.substring(2);
            toBeRead = new File(hope);
        }

             //toBeRead = new File("index.html");
            if(toBeRead.exists())
            {
                System.out.println("File exists");
            }
            else
            {
                System.out.println("file doesn't exist");
            }
           BufferedReader fileIn = new BufferedReader(new FileReader(toBeRead));

           while((fileLine = fileIn.readLine()) != null)
             {
               //System.out.println("can i get in while loop?");
               fileContent = fileContent + fileLine;
                //System.out.println("File content: \n" + fileContent);
             }

           out.print("HTTP/1.1 200 OK\r\n");
           out.print("content-type: text/html\r\n\r\n");
           out.print(fileContent);
           out.flush();
           out.close();

        }
        catch(FileNotFoundException f)
        {
            System.out.println("File not found");
            out.print("HTTP/1.1 404 Not Found\r\n\r\n");
            out.flush();
            out.close();
        }
        catch(Exception e)
        {
            out.print("HTTP/1.1 500 Internal Server Error\r\n\r\n");
            out.flush();
            out.close();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T00:12:22.490

你给文件一个相对路径，并期望它神奇地找到文件。相对路径是相对于 JVM 的启动位置解析的。如果您想要一个绝对路径，您需要执行以下操作：

```
new File("C:\\Users\\Gabrielle\\Documents\\NetBeansProjects\\CS2 Assignment 5\\src\\index.html"); 
```

您没有从对应用程序的请求中获得该信息，因为该请求是 URLEncoded。

当然，更好的解决方案是将文件放在相对于您的应用程序的合理位置并相对引用它。

# javascript - 基于本地 HTML 文件的 IndexedDB

> ID：15694334
> 
> 赞同：2
> 
> 时间：2013-03-29T00:08:08.100
> 
> 标签：javascript, html, indexeddb

我想开发一个使用浏览器与用户交互的应用程序。该应用程序将可脱机使用，并可通过 zip 分发。

我想执行的功能将由 HTML、CSS、JS 处理，我想利用 IndexedDB 功能。

我遇到了 IndexedDB (Chrome) 的问题，因为相同的代码可以在在线空间中工作，但不能来自本地硬盘驱动器位置 (file://)。

参考例子：http: [//jsfiddle.net/FwuUD/](http://jsfiddle.net/FwuUD/)

```
(function() {

    var db;
    var dbreq = indexedDB.open("TestApp", 2);

    dbreq.onsuccess = function(e) {
        alert("Database created");
        db = e.target.result;

        var employeeStore = db.createObjectStore (
            "employees",
            {keyPath: "id"}
        );

    };

    dbreq.onerror = function(e) {
        alert("Database Error: " + e.target.errorCode);
    };

    dbreq.onupgradeneeded = function(e) {
        alert("Database upgrade needed");
    };

})(); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T06:10:27.217

indexedDB API 仅适用于网络服务器。当您使用文件系统导航到它时，它将不起作用。indexedDB API 需要一个域上下文才能工作，而文件系统不提供。简而言之，您需要一个 url 才能使用 api。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T02:05:15.753

出于安全考虑，从 file:/// 运行时禁用 IndexedDB。目前尚不清楚您是否控制浏览器参数。如果你这样做了，你可以传递 --allow-file-access-from-files 这将允许 IndexedDB 从 file:/// 原点工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-09-11T01:36:30.830

如果有人正在寻找这个 6 年前的问题的更新答案，Chrome 和 Safari 现在都允许本地 HTML 文件访问 IndexedDB API，而无需本地服务器。[IE 似乎继续坚持](https://stackoverflow.com/a/50996302/401329)这一点。不确定 Edge 或 Firefox。

# powershell - 如何获取自定义 Powershell 函数的列表？

> ID：15694338
> 
> 赞同：23
> 
> 时间：2013-03-29T00:08:44.177
> 
> 标签：powershell

我使用自定义的 powershell 函数让我的生活更轻松。

例子：

```
# custom function
> function build {cmd /c build.ps1}

# invoke the function
> build 
```

这非常适合让我快速运行我的构建脚本。
不幸的是，很容易忘记我创建的所有自定义函数。

是否有我可以运行的 cmdlet 来转储我的自定义函数列表？随后，一旦我知道这些功能是什么，是否可以运行 cmdlet 来删除不再需要的功能？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-29T00:13:00.247

获取可用功能的列表

```
> Get-ChildItem function:\ 
```

删除 powershell 函数

```
# removes `someFunction`
> Remove-Item function:\someFunction 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-29T00:19:38.707

将此添加到您的个人资料中：

```
$sysfunctions = gci function:
function myfunctions {gci function: | where {$sysfunctions -notcontains $_} } 
```

myfunctions 将仅列出自会话开始以来创建的函数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-29T04:09:43.883

一种解决方案是将所有函数放在一个 psm1 文件中并创建一个模块。这样您就可以导入模块并将所有命令放在一个不错的[模块](http://msdn.microsoft.com/en-us/library/windows/desktop/dd878324%28v=vs.85%29.aspx)中。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-08-04T00:57:52.520

我不喜欢给出的答案，因为出于某种原因，当我打电话时，我没有从我的个人资料中看到我的自定义函数，`Get-ChildItem function:`所以这就是我所做的：

```
Function Get-MyCommands {
    Get-Content -Path $profile | Select-String -Pattern "^function.+" | ForEach-Object {
        # Find function names that contains letters, numbers and dashes
        [Regex]::Matches($_, "^function ([a-z0-9.-]+)","IgnoreCase").Groups[1].Value
    } | Where-Object { $_ -ine "prompt" } | Sort-Object
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-24T10:58:34.393

也可以使用

```
dir function: 
```

或者清除它

```
dir function: | where {$_.source -ne [string]::Empty} | sort source 
```

# python - 模板到表格

> ID：15694341
> 
> 赞同：2
> 
> 时间：2013-03-29T00:09:38.077
> 
> 标签：python, forms, parsing, templates, jinja2

我想以某种方式与模板的用途相反：我想编写模板并以编程方式派生模板中存在的不同标签和占位符的表示，最终生成一个表单。

换句话说，当您通常拥有数据并用它填充模板时，我想要拥有模板并询问用户正确的数据来填充它。

示例（使用伪语法）：`Hello {{ name_of_entity only-in ['World', 'Universe', 'Stackoverflow'] }}!`
**有了它，我可以以编程方式得出我应该生成一个带有`select`名为“name_of_entity”的标签并具有 3 `options`（“World”、“Universe”、“Stackoverflow”）的表单。**

我研究了 Jinja2，似乎我可以使用它并扩展它来达到我的目标（即使它是以另一种方式做事）。但我仍然不确定在某些情况下我应该怎么做，例如：

*   如果我想表示`{{ weekday }}`只有在`['Mo', 'Tu', ...]`
*   如果我想在模板中表示该`{{ amount }}`变量只接受整数......

Jinja 是实现这些目标的良好基础吗？如果是，你会如何建议这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:52:42.583

我认为 Jinja 对构建它很有意义，特别是因为它包含一个完整的词法分析器和解析器。您可以利用这些来派生您自己的版本来满足您的需要。

# c++ - C++ For 循环项目

> ID：15694346
> 
> 赞同：0
> 
> 时间：2013-03-29T00:10:11.453
> 
> 标签：c++, visual-studio-2010, for-loop, visual-c++

我正在尝试创建嵌套的 for 循环以输出下面的网格以供作业。这是我的进度和说明（这真的应该很简单......）：

“创建一个 8x8 网格，如下图所示。按 Tab 键开始每一行。每个单元格高一排，宽三个空格。破折号 (-) 字符 (33) 用于构建水平线。”

![在此处输入图像描述](../Images/414dfd3360a61ac8babbd1a4d5f8dc5c.png)

代码：

```
#include <iostream>

using namespace std;

int main()
{

for(int i=0;i<8;i++)
{

    for(int j=0; j<8; j++)
    {
        cout<<"I\t";
    }

    for(int k=0;k<33;k++)
    {
        cout<<"-";
    }

    cout<<"\n";
}

cin.get();
cin.get();

return 0;
} 
```

我的输出：

![在此处输入图像描述](../Images/70aa27f5f98f7e90711f0ff268217525.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:20:37.757

它必须是这样的：

```
#include <iostream>

using namespace std;

int main()
{

    for(int i=0;i<8;i++)
    {
        cout << "\t";
        for(int k=0;k<33;k++)
        {
            cout<<"-";
        }

        cout << endl;
        cout << "\t";
        for(int j=0; j<9; j++)
        {
            cout<<"I   ";
        }
        cout << endl;
    }
    cout << "\t";
    for(int k=0;k<33;k++)
    {
        cout<<"-";
    }
    cin.get();
    return 0;
} 
```

输出是：

![这](../Images/ad9c990379ee2cff3f6eafd8547c1262.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:23:52.637

怎么样

```
#include <iostream>

using namespace std;

int main()
{

for(int i=0;i<8;i++)
{

    for(int j=0; j<8; j++)
    {
        cout<<"I\t";
    }

    cout << endl;

    for(int k=0;k<57;k++)
    {
        cout<<"-";
    }

    cout<<"\n";
}

cin.get();
cin.get();

return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T00:20:54.823

```
 for(int i=0;i<8;i++)      
   {                
       for(int j=0; j<8; j++)
         {
                cout<<"I\t";

            for(int k=0;k<33;k++)
            {
                cout<<"-";
            }

            cout<<"\n";
        }

    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-29T00:23:20.297

```
#include <iostream>

using namespace std;

int main()
{
cout<<"\t";
for(int k=0;k<33;k++)
    {
        cout<<"-";
    }
    cout << endl;

    for(int i=0;i<8;i++)
    {
    cout<<"\t";
    for(int j=0; j<9; j++)
    {
        cout<<"I   ";
    }

    cout << endl;
    cout<<"\t";
    for(int k=0;k<33;k++)
    {
        cout<<"-";
    }

    cout << endl;
    }

cin.get();

return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T00:20:15.720

这里是：

```
#include <iostream>

using namespace std;

int main()
{

for(int i=0;i<8;i++)
{

    for(int j=0; j<8; j++)
    {
        cout<<"I   ";
    }
    cout<<"\n";
    for(int k=0;k<33;k++)
    {
        cout<<"-";
    }
    cout<<"\n";
}

cin.get();
cin.get();

return 0;
} 
```

![在此处输入图像描述](../Images/ea4bd9ebdb8786b074c7e932fef36e5a.png)

# c - 使用 CMake 安装附加文件

> ID：15694347
> 
> 赞同：20
> 
> 时间：2013-03-29T00:10:35.980
> 
> 标签：c, cmake, opencl

我正在尝试提供一些带有一些可执行文件的“源”文件。我想知道是否有办法将这些源文件复制到构建目录（从源目录），然后使用 CMake 复制到安装目录。

我更具体的目标是包含我在他们自己的 *.cl 文件中编写的 OpenCL 内核。

例子：

```
mkdir build
cd build
cmake ..
make 
```

现在我的目录应该有一个可执行文件（标准 CMake）并且`some_opencl_kernel.cl`我在我的可执行文件中打开它。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-29T01:40:20.883

[`add_custom_command`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:add_custom_command "CMake v2.8.10 命令文档")您可以通过添加以下内容将文件复制到构建树：

```
add_custom_command(TARGET MyExe POST_BUILD
                   COMMAND ${CMAKE_COMMAND} -E copy_if_different
                       ${CMAKE_CURRENT_SOURCE_DIR}/src/some_opencl_kernel.cl
                       $<TARGET_FILE_DIR:MyExe>
                   ) 
```

这会将构建后事件添加到您的目标（我称之为它`MyExe`），它将文件复制`src/some_opencl_kernel.cl`到构建树中与可执行文件相同的目录中。

将文件复制到构建树中有多种其他方法，但我喜欢这种方法，因为它使用“生成器表达式”`$<TARGET_FILE_DIR:MyExe>`来标识可执行文件目录在构建树中的位置。这可能因构建类型或平台而异，因此生成器表达式是我认为指定此位置的最可靠、跨平台的方式。

至于安装，你可以使用[`install(FILES ...)`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:install "CMake v2.8.10 文档")命令。假设您的可执行文件具有以下内容：

```
install(TARGETS MyExe RUNTIME DESTINATION bin) 
```

你可以添加：

```
install(FILES src/some_opencl_kernel.cl DESTINATION bin) 
```

这会将其安装到`${CMAKE_INSTALL_PREFIX}/bin/some_opencl_kernel.cl`可执行文件旁边。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-10-23T07:39:46.370

如果要复制包含某种类型文件的文件夹树：

```
 # Copy all assets to resources file
  INSTALL(DIRECTORY ${CMAKE_CURRENT_LIST_DIR}/assets/ DESTINATION ${INSTALL_PATH}/assets
          FILES_MATCHING PATTERN "*.dae"  PATTERN "*.jpg") 
```

如果要复制文件夹中的所有文件，只需删除 FILES_MATCHING 模式。

# javascript - 从选择下拉列表中调用外部 javascript 文件

> ID：15694351
> 
> 赞同：0
> 
> 时间：2013-03-29T00:11:02.270
> 
> 标签：javascript

我有一个选择下拉菜单：

```
<select lang="en" >
<option label=" Select a keyboard language" selected="selected" />
<option value="af" label="Afrikaans / Afrikaans" />
<option value="sq" label="Albanian / shqipe" />
<option value="ar" label="Arabic / العربية" />
<option value="hy" label="Armenian / Հայերեն" />
    ........
</select> 
```

我有外部 JavaScript 文件 (C:[PATH]\js_files)：af.js、sq.js、ar.js、hy.js 等。

**当用户选择语言时，如何调用*和*加载相关的外部 JavaScript 文件？**

我的js技能还没有解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T01:19:50.437

所以本质上你只是在寻找这个？：

头中的javascript：

```
function loadJS(v){
    var d=document, h=d.getElementsByTagName('head')[0], newScript;
    try {h.removeChild(d.getElementById('lib_lang'));} catch (e){}
    newScript      = d.createElement('script');
    newScript.id   = 'lib_lang';
    newScript.type = 'text/javascript';
    newScript.src  = '[PATH]/'+v+'.js';   // change your path here
    h.appendChild(newScript);
} 
```

正文中的html：

```
<select lang="en" onchange="loadJS(this.value)">
    <option selected="selected" disabled="true"> Select a keyboard language</option>
    <option value="af">Afrikaans / Afrikaans</option>
    <option value="sq">Albanian / shqipe</option>
    <option value="ar">Arabic / العربية</option>
    <option value="hy">Armenian / Հայերեն</option>
</select> 
```

[演示 JSFiddle 在这里](http://jsfiddle.net/3R6uj/)。

希望对你有帮助，祝你好运！

# r - 使用过多内存从 {raster} 包中提取

> ID：15694355
> 
> 赞同：3
> 
> 时间：2013-03-29T00:11:22.923
> 
> 标签：r, memory, extract, raster

我一直在使用包中的`extract`函数来`raster`使用 shapefile 定义的区域从光栅文件中提取数据。但是，我遇到了这个过程现在需要的内存量问题。我确实有大量的 shapefile（~1000）。光栅文件很大（~1.6gb）

我的流程是：

```
shp <- mclapply(list.files(pattern="*.shp",full.names=TRUE), readShapePoly,mc.cores=6)
ndvi <- raster("NDVI.dat")
mc<- function(y) {
temp <- gUnionCascaded(y)
extract <- extract(ndvi,temp)
mean <- range(extract, na.rm=T )[1:2]
leng <- length(output)
}
output <- lapply(shp, mc) 
```

我可以进行任何更改以减少内存负载吗？我尝试加载更少的 shapefile，这些文件在内存再次飙升之前工作了大约 5 分钟。它是一台 2.4GHz 的四核计算机，带有 8GB 内存

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T07:29:09.357

我会这样做（未经测试）：

```
## Clearly we need these packages, and their dependencies
library(raster)
library(rgeos)
shpfiles <- list.files(pattern="*.shp",full.names=TRUE)
ndvi <- raster("NDVI.dat")
## initialize an object to store the results for each shpfile
res <- vector("list", length(shpfiles))
names(res) <- shpfiles
## loop over files
for (i in seq_along(shpfiles)) {
  ## do the union
  temp <- gUnionCascaded(shpfiles[i])
  ## extract for this shape data (and don't call it "extract")
  extracted <- extract(ndvi,temp)
  ## further processing, save result
  mean <- range(extracted, na.rm = TRUE )[1:2]
  res[[i]] <- mean  ## plus whatever else you need
} 
```

完全不清楚上面 mc() 的返回值是什么意思，所以我忽略它。这将比您最初尝试的内存效率和速度要快得多。我怀疑这里是否值得使用并行的东西。

# mysql - Mysql查询返回结果即使表为空

> ID：15694356
> 
> 赞同：0
> 
> 时间：2013-03-29T00:11:24.223
> 
> 标签：mysql, select

我正在使用此查询来获取按大多数 content_id 排序的结果，问题是即使请求表为空，它仍会从内容表中返回 1 个元素：

```
select `c`.`id`, `c`.`title`, `c`.`slug`, `c`.`year`, `c`.`category`, `r`.*
, count(*) from requests as r
RIGHT JOIN `content` as c ON `r`.`content_id` = `c`.`id`
group by content_id order by count(*) desc
LIMIT 10 
```

如果请求表中有 5 条记录之类的记录，它会返回 6 条记录。第一条记录不在请求表中。有人能帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:40:44.600

尝试使用`INNER JOIN`而不是`RIGHT JOIN`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:12:16.507

当您使用聚合函数时，`COUNT()`您总是会返回一行，因此数据库可以报告该函数的结果，即使它为零。

# codeblocks - 代码块工作区仅构建活动项目？

> ID：15694362
> 
> 赞同：0
> 
> 时间：2013-03-29T00:12:12.670
> 
> 标签：codeblocks, workspace

我在代码块中有休闲设置：

![CodeBlocks 工作区，其中有 2 个项目，3 个文件，2 个用于](../Images/ea30783bf6e9a62f2ed853b954ebeb70.png)

我选择了“程序”（突出显示的项目）依赖于“程序库”

1.  右键单击“程序”并选择“属性...”
2.  在“项目设置”下选择“项目的依赖项...”
3.  在出现的框中选中“ProjectLibrary”。

我已经保存了工作区。我可以通过双击它来打开它，它会在两个项目都打开的情况下出现。它只会编译活动项目。但是，我可以通过这两个项目并为我想要的目标单独编译每个项目。

根据[CodeBlocks.org](http://wiki.codeblocks.org/index.php?title=The_build_process_of_Code::Blocks)的文档，它应该编译工作区中包含的所有项目。

> 使用菜单“Build->Build workspace”来构建一个工作区（即其中包含的所有项目）。

我正在使用“Build-> Build workspace”编译工作区（如前所述），并且还尝试通过右键单击资源管理器进行编译，没有区别。

当前目录树是

```
\Project.workspace
\ProgramLibrary\
    \ProgramLibrary.cbp
    \ProgramLibrary.depend
    \ProgramLibrary.layout
    \ProgramLibrary.h
    \ProgramLibrary.cpp
\Program\
    \Program.cbp
    \Program.depend
    \Program.layout
    \Program.cpp
\dist\
    \ProgramLibrary.dll.a
    \ProgramLibrary.dll
    \Program.exe 
```

而且，为了验证两个项目都在工作区中，这里是工作区文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<CodeBlocks_workspace_file>
    <Workspace title="Program">
        <Project filename="ProgramLibrary/ProgramLibrary.cbp" />
        <Project filename="Program/Program.cbp" active="1">
            <Depends filename="ProgramLibrary/ProgramLibrary.cbp" />
        </Project>
    </Workspace>
</CodeBlocks_workspace_file> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T17:54:16.747

答：升级到 CodeBlocks 12.11

# android - 为什么它说未使用 PendingIntent.getBroadcast() 中的 requestCode？

> ID：15694364
> 
> 赞同：3
> 
> 时间：2013-03-29T00:12:20.633
> 
> 标签：android

的[文档`PendingIntent`](http://developer.android.com/reference/android/app/PendingIntent.html)指出，在 中`PendingIntent.getBroadcast()`，`requestCode`参数“当前未使用”。但是，我做了一些非常详尽的测试，并且设置不同`requestCode`的 s 很明显地改变了程序的行为（并且设置不同`requestCode`的 s 似乎是区分警报意图的一种普遍接受的方法）。

很`requestCode`明显地使用了一个有被“修复”风险的错误吗？或者我可以继续使用它来区分我的 PendingIntents 吗？

一些背景：

`onCreate`我在主 Activity 中使用以下代码设置了一个测试应用程序：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    AlarmManager alarmMgr = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    Intent intent = new Intent(this, MyAlarmReceiver.class);
    intent.putExtra("text", "text one");
    PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);
    Calendar time = Calendar.getInstance();
    time.setTimeInMillis(System.currentTimeMillis());
    time.add(Calendar.SECOND, 1);
    alarmMgr.set(AlarmManager.RTC_WAKEUP, time.getTimeInMillis(), pendingIntent);

    intent = new Intent(this, MyAlarmReceiver.class);
    intent.putExtra("text", "text two");
    pendingIntent = PendingIntent.getBroadcast(this, 1, intent, PendingIntent.FLAG_UPDATE_CURRENT);
    time.setTimeInMillis(System.currentTimeMillis());
    time.add(Calendar.SECOND, 10);
    alarmMgr.set(AlarmManager.RTC_WAKEUP, time.getTimeInMillis(), pendingIntent);

} 
```

以及一个非常简单的AlarmReceiver：

```
public class MyAlarmReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        Toast.makeText(context, intent.getStringExtra("text"), Toast.LENGTH_SHORT).show();
    }

} 
```

然后我尝试为 PendingIntents 设置不同的标志和 requestCodes。这些是结果：

[https://docs.google.com/spreadsheet/ccc?key=0AnqelXkzmAL0dDNYeVEyekJyRkV1VDZNVVIyQTJkdmc#gid=0](https://docs.google.com/spreadsheet/ccc?key=0AnqelXkzmAL0dDNYeVEyekJyRkV1VDZNVVIyQTJkdmc#gid=0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T08:14:02.273

`requestCode`是最肯定使用的，并且已经使用了相当长的一段时间。Android 文档已经过时并且已经存在了很长一段时间。检查 AOSP 源以确认是否需要。

# php - 未知列，错误

> ID：15694371
> 
> 赞同：4
> 
> 时间：2013-03-29T00:12:40.857
> 
> 标签：php, mysql

有人可以帮我解决我遇到的这个错误，我找不到问题。我知道我的代码很垃圾，我应该使用 PDO。

我正在尝试为我的游戏制作交易脚本，这是用户接受或拒绝交易的页面，我还没有尝试添加拒绝功能。截至目前，我收到此错误。

> “字段列表”中的未知列“昵称”

```
<?php

    if ($_POST['A'] == '1' ) {
$token= mysql_real_escape_string($_POST['token']);
$tokenn = strip_tags($token);

$sql234 = "SELECT * FROM trade WHERE trade_to='".$_SESSION['username']."'";
$result2 = mysql_query("SELECT * FROM trade WHERE trade_to='".$_SESSION['username']."'");
while($row2 = mysql_fetch_array($result2)){

$sql23 = "SELECT * FROM users WHERE username='".$_SESSION['username']."')";
$result = mysql_query("SELECT * FROM users WHERE username='".$_SESSION['username']."'");
while($row = mysql_fetch_array($result)){

if (isset($_POST['slot1'])) {

        echo "<p>You have accepted the trade.</p>" ;
        mysql_query("UPDATE user_pokemon SET belongsto=".$row2['trade_to']." WHERE id='".$row2['trade_pokeid']."'") 
            or die(mysql_error());

        mysql_query("UPDATE user_pokemon SET belongsto=".$row2['trade_from']." WHERE id='".$row2['trade_mypokeid']."'")
            or die(mysql_error());

            mysql_query("DELETE FROM trade WHERE trade_id=".$row2['trade_id']."")
            or die(mysql_error());

    } else {

}
}
}

}

?>

<?php
$result = mysql_query("SELECT * FROM trade WHERE trade_to='".$_SESSION['username']."'");
while($row = mysql_fetch_array($result))
{   

$idd= mysql_real_escape_string($row['trade_id']);
$iddd = strip_tags($idd);

?>
</span>
<form name="slot1" action="" method="post">
  <div align="center">
    <p>
      <span>
        <select name="A" id="" >
          <option value="1">Buy</option>
        </select>
        <input type="hidden" name="token" id="token" value="<?php  echo $iddd ;  ?>" />
        <br />
        <input type="submit" class="submit" value="Accept" name="slot1">
        </span></p>

    </div>
</form>
<span>
<?php
echo $row ['trade_id'];
}
?>

</span>

</p>
</div>
</center>

</td>

<?php include 'includes/bottom.php'; ?> 
```

任何问题将不胜感激:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:20:51.547

在这一行：

```
 mysql_query("UPDATE user_pokemon SET belongsto=".$row2['trade_from']." WHERE id='".$row2['trade_mypokeid']."'") 
```

你忘了引用第一个参数：

```
 mysql_query("UPDATE user_pokemon SET belongsto='".$row2['trade_from']."' WHERE id='".$row2['trade_mypokeid']."'") 
```

代码中接下来的两条`mysql_query`指令也会出现同样的错误。

你知道，但我还是要说：*请*使用`PDO`or `mysqli`。至少，`mysql_real_escape_string`像您在代码开头所做的那样，使用 清理所有数据。

```
 mysql_query("UPDATE user_pokemon SET belongsto='".mysql_real_escape_string($row2['trade_from'])."' WHERE id='".mysql_real_escape_string($row2['trade_mypokeid'])."'") 
```

[我之所以这么说是因为从长远来看它会对你有所帮助，仅此而已]

# jsp - 如何根据从数据库中检索的值检查单选按钮？

> ID：15694372
> 
> 赞同：3
> 
> 时间：2013-03-29T00:12:50.463
> 
> 标签：jsp, struts2, radio-button, el, struts-tags

我有一个 JSP 页面，我在其中将所选单选按钮的表单和值保存在数据库中。现在，我需要更新该页面，所有内容都在显示，但未选中单选按钮。我不知道如何在我的 jsp 上显示以前选择的单选按钮。我正在使用 Struts2，Java。

JSP代码：

```
 <div id="patientCondition">
            <input type="radio" id="new" value="n" name="pSB.radioInnerSubjective" /><label for="new">New</label>
            <input type="radio" id="noChange" value="nC" name="pSB.radioInnerSubjective" /><label for="noChange">No Change</label> 
            <input type="radio" id="progressing" value="p" name="pSB.radioInnerSubjective" /><label for="progressing">Progressing</label>
            <input type="radio" id="notProgressing" value="nP" name="pSB.radioInnerSubjective" /><label for="notProgressing">Not Progressing</label>
    </div> 
```

假设我从数据库中获取单选按钮的值为“nC”，现在如何自动选择第二个单选按钮。

我试过：

```
<input type="radio" id="new" value="n" <s:if test="${patientSoapBean.radioInnerSubjective == 'n'}">CHECKED</s:if> name="patientSoapBean.radioInnerSubjective"/><label for="new">New</label> 
```

但我收到错误：

```
Mar 28, 2013 6:07:54 PM org.apache.catalina.core.ApplicationDispatcher invoke
SEVERE: Servlet.service() for servlet jsp threw exception
org.apache.jasper.JasperException: /WEB-INF/views/patient_soap.jsp (line: 703, column: 44) According to TLD or attribute directive in tag file, attribute test does not accept any expressions 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T15:11:46.323

您不能`${...}`在 Struts2 内部使用标签，您需要交换`'`和`"`in`test`属性才能正确地与一个字符串进行比较。

```
<input type="radio" id="new" value="n" <s:if test='patientSoapBean.radioInnerSubjective == "n"'>checked</s:if> name="patientSoapBean.radioInnerSubjective"/>
<label for="new">New</label> 
```

当然，您需要用于`patientSoapBean`and的 getter/setter `radioInnerSubjective`。

顺便说一句，Struts2 有`<s:radio>`标签，它将检查选定的单选按钮。

# mysql - 为什么这个 IN（内部查询）查询不返回任何结果？

> ID：15694376
> 
> 赞同：0
> 
> 时间：2013-03-29T00:13:11.383
> 
> 标签：mysql

以下查询返回一堆重复的解决方案：

```
SELECT *
FROM solutions s1, solutions s2
WHERE s2.ID <> s1.ID
AND s2.solution = s1.solution 
```

我只是在寻找重复解决方案的数量，所以这不起作用*（例如，如果有`n`重复，它会返回`n!`行）*。

以下查询*应该*只返回那些重复的解决方案，但**它返回 0 个结果**：

```
SELECT *
FROM solutions s1
WHERE s1.ID IN
(
   SELECT s2.ID
   FROM solutions s2
   WHERE s2.ID <> s1.ID
   AND s2.solution = s1.solution
) 
```

我无法为我的生活找出原因。MySQL 中的内部查询是否存在我不知道的限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:15:23.650

您的内部查询不会返回任何行，因为无法找到`s1.ID IN()`从不匹配`s1.ID`s 的 ID 中选择的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:19:20.683

你可以用`COUNT()`它来很容易地确定这一点

```
SELECT solution, COUNT(id) AS `count`
FROM solutions
GROUP BY solution
HAVING `count` > 1 
```

回答你的问题。您不能`s1`在内部查询中引用外部表。

# knockout.js - 在 KnockoutJs 中，如何订阅最初为 null 的值？

> ID：15694377
> 
> 赞同：0
> 
> 时间：2013-03-29T00:13:12.123
> 
> 标签：knockout.js

```
<select data-bind="options: SelectedCountry() ? SelectedCountry().Cities : '',
optionsText: 'Name', value: SelectedCity, optionsCaption: '-- Select a City --'"></select> 
```

我想订阅 SelectedCity

```
$(function ()
{
  vm.SelectedCity.subscribe(function ... 
```

淘汰赛引发错误“无法获取未定义或空引用的属性'订阅'”

当然，当页面加载时，SelectedCity 仍然为空，那么我该如何订阅呢？

我正在使用淘汰赛映射，

```
var vm = ko.viewmodel.fromModel(JSON.parse(vmJs));
ko.applyBindings(vm); 
```

vmJs 是在服务器上生成的，我可以在 vmJs 中看到 ..."SelectedCity":null,...。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:51:26.433

我没有意识到我犯了一个错误。我写

```
vm.SelectedCity().subscribe 
```

代替

```
vm.SelectedCity.subscribe 
```

在我的代码中。所以没有问题，即使初始值为 null，也可以订阅 observable。

# delphi - 有没有办法在启用控件时禁用控件时保持对 TDataset.Edit 的调用？

> ID：15694378
> 
> 赞同：4
> 
> 时间：2013-03-29T00:13:29.670
> 
> 标签：delphi

这有点涉及，所以请耐心等待。

`TDataset.Edit`调用`SetState(dsEdit);`，调用`DataEvent(deUpdateState, 0);`

`TDataSet.DataEvent`，当使用参数调用时`deUpdateState`，如果您禁用了数据集上的控件，它会设置一个标志，`deLayoutChange`当控件重新启用时将发送一个事件，根据文档，这有点模糊地表示“数据的布局数据感知控件发生了变化。”

当重新启用的控件是数据绑定网格时，这可能会导致一些非常昂贵的重置，从而迫使整个网格重新布局。在具有大量行和列的大型数据集上，这可能需要几秒钟，即使您在禁用影响网格布局的控件时没有执行任何操作。

有什么办法可以防止这种情况发生吗？ `SetState`不是虚拟的。 `DataEvent`是虚拟的，但`FEnableEvent`它用来设置它的字段不能从派生类访问。如果没有严重的黑客行为，似乎没有任何方法可以解决这个问题。（RTTI 手术、叠加课程等）有人知道更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T19:04:32.727

根据您的数据集已连接到 DevExpress 网格的评论，我将开始查看那里。使用 cxgrid.BeginUpdate 和 cxgrid.EndUpdate 以及 try/finally 块包装进行编辑的代码。

```
MycxGrid.BeginUpdate;
try
   {Do some data editing}
finally
  MycxGrid.EndUpdate;
end; 
```

仅此一项就可以解决您的问题。如果没有，请查看 DevExpress 帮助文件 TcxDBDataModeController.SmartRefresh 和 TcxDBDataModeController.SyncMode。

没有看到你的代码，我只是在猜测。但是在我发现 BeginUpdate/EndUpdate 组合之前，我遇到了与您非常相似的性能问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T21:33:29.110

我不知道 TcxGrid，但也许你可以尝试在控件端解决这个问题，并覆盖`TcxGrid`'s`DataLink.LayoutChanged`或网格本身的其他方法。

类比`TDBGrid`：

*   `TCustomDBGrid.CreateDataLink`是动态的并且可以被覆盖，这样你就可以在后代上注入你自己的`TGridDataLink`衍生物。`TDBGrid`
*   `TGridDataLink.LayoutChanged`是虚拟的并且可以被覆盖，这是选项 1。
*   `TGridDataLink.LayoutChanged`来电`FGrid.LayoutChanged`。
*   `TCustomDBGrid.LayoutChanged`也是虚拟的，使其成为选项 2。

# html - 我的页脚背景图片未显示

> ID：15694379
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:13:32.060
> 
> 标签：html, css

我的CSS代码

`.footer-container{ background: url(../images/footer.jpg);}`

html代码

`<div id="footer-container">`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:15:05.673

要定位一个 id，你必须使用哈希：

```
 #footer-container{ background: url(../images/footer.jpg);} 
```

或者把 id 改成类属性：

```
 <div class="footer-container"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:16:40.853

你的 css 有一个 footer-container 类，而 HTML 有一个 footer-container 的 ID，所以你可能想检查一下。它应该是：

```
#footer-container{ background: url(../images/footer.jpg);} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T00:17:12.610

**ids**使用`#`

*例子* `#footer-container {...}`

**类**使用`.`

*例子* `.footer-container {...}`

# c# - 带有 FileSystemWatcher 的计时器来控制文件创建

> ID：15694382
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:13:43.530
> 
> 标签：c#, winforms, timer, filesystemwatcher, creation

我需要检查一个文件夹中是否有某些类型的文件，然后将它们添加到一个数组中，然后一个一个打印和删除它们。如果在此过程中添加了新文件，它只会被添加到打印队列中。我正在尝试监视是否每 1 秒创建一个文件。为此，我使用了带计时器的 FileSystemWatcher。我正在尝试将 2 个事件函数绑定在一起，但尝试时出现奇怪的错误。我在表单应用程序中执行此操作，今天我第一次看到这两个名称空间，我对多线程、后台线程或 System.Threading.Timer 和 System.Windows.Forms.Timer 之间的区别一无所知最适合这种特殊情况，所以如果问题在这些主题上过于具体，我可能也需要对此进行一些快速澄清。

基本上代码就是这个（它是一个更大程序的一部分，所以我会尝试只粘贴与问题相关的代码，另外，不要介意作为整个项目一部分的额外 using 命名空间。最后我不知道如何在此处的代码块中突出显示 C# 语法，使用 ctrl+K 的格式化工具构成了您在下一个代码块中阅读的内容。我尝试将其缩进一点以便更好地阅读。）：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.Collections;
using System.IO.Ports;
using System.Diagnostics;

private Timer timer1; //Windows.Form Timer

private void button1_Click(object sender, EventArgs e) {
  try {
    InitTimer();
    FileSystemWatcher SysWatch = new FileSystemWatcher(FilesPath, "*.*");
    SysWatch.Created += new FileSystemEventHandler(SysWatch_Created);
    SysWatch.EnableRaisingEvents = true;
  }
  catch (Exception exc) {
    MessageBox.Show(exc.Message); 
  }
}

private void InitTimer() {
  timer1 = new Timer();
  timer1.Tick+=new EventHandler(timer1_Tick);
  timer1.Interval = 2000;
  timer1.Start();
}

private void timer1_tick (object sender, EventArgs xz) {
  void SysWatch_Created(object Sender, FileSystemEventArgs w) {
    MessageBox.Show("File " + w.FullPath + "Creato");
  }
} 
```

我试图做的是尝试将文件创建事件控制器嵌套在计时器内，以便它检查文件创建，但我这样做的方式可能有问题。

我得到了这种东西（就在我尝试将 SysWatch_Created 嵌套到 timer1_Tick 中时，直到那时一切都很完美）。

[在此处输入链接描述](http://img607.imageshack.us/img607/9310/cbd6318deab04481b92a976.png)

我认为这与我试图用 Event Args 或其他东西嵌套 2 个方法的事实有关......不知道

欢迎任何关于如何做得更好的例子。

谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:29:51.980

您不能将方法放在这样的方法中，或者将事件处理程序放在事件处理程序中，例如它；您将需要在计时器处理程序*旁边定义 FileSystemWatcher 处理程序。*但是你的观察者会为你做滴答式的监控，并根据它在发生事件*时引发事件，而不是你的计时器。*

稍微解释一下，这样说是有道理的，并且您不再有那个特定的错误（或一组错误）：

```
private void timer1_tick (object sender, EventArgs xz) {

}

void SysWatch_Created(object Sender, FileSystemEventArgs w) {
  MessageBox.Show("File " + w.FullPath + "Creato");
} 
```

但是，那么你仍然需要在间隔调用它，并且手动调用处理程序方法在这里没有多大意义。考虑以下：

```
private void timer1_tick (object sender, EventArgs xz) {
  SysWatch_Created(this, null);
} 
```

发件人可能应该是 FileSystemWatcher，但不一定是最不关心的：否则，您希望通过我`null`在此实例中放置的位置传递什么？只有观察者在此上下文中具有此信息。

回到正题。您不需要计时器，FileSystemWatcher 将在内部进行轮询并通知您，因为您*告诉*它 ( `Created += new FileSystemEventHandler(SysWatch_Created);`)。不过，你不能专门设置这个东西的轮询间隔。

# symfony - symfony2 多重左连接，内连接

> ID：15694383
> 
> 赞同：2
> 
> 时间：2013-03-29T00:13:49.117
> 
> 标签：symfony, join, doctrine-orm, left-join, inner-join

使用 symfony2 但它更多只是 mysql 问题......

我认为我有很好的表模式（只是重要的字段）（代码是不言自明的）：

用户 (id) 状态 (id) 喜欢 (id,user_id,status_id) 评论 (id,user_id,status_id)

我正在做大选择。

正在尝试这个：

```
 $qb=$this->createQueryBuilder('s')
             ->addSelect('u')
             ->addSelect('u2')
             ->addSelect('u3')
             ->addSelect('l')
             ->addSelect('c')
             ->addSelect('s2')
             ->where('s.user = :user')
             ->setParameter('user', $user)
             ->innerJoin('s.user', 'u')
             ->leftJoin('s.likes', 'l')
             ->leftJoin('l.user', 'u2')
             ->leftJoin('s.comments', 'c')
             ->leftJoin('c.user', 'u3')
             ->leftJoin('c.status', 's2')
             ->orderBy('s.time', 'DESC')
             ->setMaxResults(15); 
```

但结果是 15 个相同的状态......错误。

当我只选择状态时效果很好......喜欢状态..和用户（喜欢和状态的作者）

像那样：

```
SELECT * FROM statuses s0_ 
INNER JOIN users t1_ ON s0_.user_id = t1_.id 
LEFT JOIN status_likes s2_ ON s0_.id = s2_.status_id
INNER JOIN users t3_ ON s2_.user_id = t3_.id  

WHERE s0_.user_id = 25 ORDER BY s0_.time DESC LIMIT 15 
```

效果很好，但是我如何实现其他评论和（用户->评论作者）选择那里？...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:27:46.050

您无法以您尝试的方式在连接查询上设置最大结果。

您需要使用此处描述的分页器：http: [//docs.doctrine-project.org/en/latest/tutorials/pagination.html](http://docs.doctrine-project.org/en/latest/tutorials/pagination.html)

如果它在您的 Doctrine 版本中不可用（您是 2.2 之前的版本），那么您可以在此处使用分页器： [https ://github.com/beberlei/DoctrineExtensions](https://github.com/beberlei/DoctrineExtensions)

另一种选择是不在查询中执行连接——而只是允许自动获取连接的数据。因此，遍历用户并遍历对象图以获取您需要的信息。这显然会发出更多的查询：

```
$users = $userRepository->findById($user);
$i = 0;
for ($users as $user){
    $likes = $user->getLikes(); 
    $comments = $user->getComments();
    $i++;
    if ($i == 15) { break; }
} 
```

编辑：将“继续”更改为“休息”；无论如何，这都是蹩脚的代码——不要使用它，我只是在说明一个替代方案。

最后，您可以使用本机查询来执行此操作：

[http://docs.doctrine-project.org/en/2.1/reference/native-sql.html](http://docs.doctrine-project.org/en/2.1/reference/native-sql.html)

编辑：类似的问题：[使用 fetch-joined 集合限制学说查询？](https://stackoverflow.com/questions/5620771/limiting-a-doctrine-query-with-a-fetch-joined-collection)

# php - PHP/GD 使用 imagecreatetruecolor() 而不是 imagecreate() 渲染黑色图像

> ID：15694384
> 
> 赞同：3
> 
> 时间：2013-03-29T00:14:38.350
> 
> 标签：php, gd

使用这个“有点”丑陋的类，我正在使用 .ttf 字体文件将文本渲染到图像中。使用 ImageFlip() 函数时，我得到一个黑色的全黑图像（尽管尺寸合适）。当我用 imagecreate() 替换所有出现的imagecreatetruecolor **(** **)**时，一切都按预期工作。

 **渲染为JPEG而不是PNG没有区别。我没有收到任何 PHP 错误。

```
<?php

define ( 'IMAGE_FLIP_HORIZONTAL', 1 );
define ( 'IMAGE_FLIP_VERTICAL', 2 );
define ( 'IMAGE_FLIP_BOTH', 3 );

/**
 * Renders text to an image using a TrueType font
 *
 * @author peterrus
 */
class ImageTTFRenderer {

    //defaults
    private $size = 60;
    private $rot = 0; // rotation in degrees. 
    private $pad = 10; // padding. 
    private $transparent = 0; // gives a black image in combination with flipping
    private $red = 0; // white text... 
    private $grn = 0;
    private $blu = 0;
    private $bg_red = 255; // on black background. 
    private $bg_grn = 255;
    private $bg_blu = 255;
    private $flipped = true;
    private $fontFile;

    function __construct($options) {
        if (isset($options['fontfile'])) {
            $this->fontFile = $options['fontfile'];
        } else {
            throw new Exception("No font selected");
            die();
        }
        if (isset($options['size'])) {
            $this->size = $options['size'];
        }
        if (isset($options['red'])) {
            $this->size = $options['red'];
        }
        if (isset($options['grn'])) {
            $this->size = $options['grn'];
        }
        if (isset($options['blu'])) {
            $this->size = $options['blu'];
        }
        if (isset($options['bg_red'])) {
            $this->size = $options['bg_red'];
        }
        if (isset($options['bg_grn'])) {
            $this->size = $options['bg_grn'];
        }
        if (isset($options['bg_blu'])) {
            $this->size = $options['bg_blu'];
        }
    }

function ImageFlip($imgsrc, $type)
{
    $width = imagesx($imgsrc);
    $height = imagesy($imgsrc);

    $imgdest = imagecreatetruecolor($width, $height);

    switch( $type )
        {
        case IMAGE_FLIP_HORIZONTAL:
            for( $y=0 ; $y<$height ; $y++ )
                imagecopy($imgdest, $imgsrc, 0, $height-$y-1, 0, $y, $width, 1);
            break;

        case IMAGE_FLIP_VERTICAL:
            for( $x=0 ; $x<$width ; $x++ )
                imagecopy($imgdest, $imgsrc, $width-$x-1, 0, $x, 0, 1, $height);
            break;

        case IMAGE_FLIP_BOTH:
            for( $x=0 ; $x<$width ; $x++ )
                imagecopy($imgdest, $imgsrc, $width-$x-1, 0, $x, 0, 1, $height);

            $rowBuffer = imagecreatetruecolor($width, 1);
            for( $y=0 ; $y<($height/2) ; $y++ )
                {
                imagecopy($rowBuffer, $imgdest  , 0, 0, 0, $height-$y-1, $width, 1);
                imagecopy($imgdest  , $imgdest  , 0, $height-$y-1, 0, $y, $width, 1);
                imagecopy($imgdest  , $rowBuffer, 0, $y, 0, 0, $width, 1);
                }

            imagedestroy( $rowBuffer );
            break;
        }

    return( $imgdest );
}

public function draw($message) {

// Set the enviroment variable for GD
putenv('GDFONTPATH=' . realpath('.'));

$width = 0;
$height = 0;
$offset_x = 0;
$offset_y = 0;
$bounds = array();
$image = "";

// determine font height. 
$bounds = ImageTTFBBox($this->size, $this->rot, $this->fontFile, "W");
if ($bounds == false) {
    throw new Exception("imagettfbbox() returned false");
    die();
}
if ($this->rot < 0) {
    $font_height = abs($bounds[7] - $bounds[1]);
} else if ($this->rot > 0) {
    $font_height = abs($bounds[1] - $bounds[7]);
} else {
    $font_height = abs($bounds[7] - $bounds[1]);
}

// determine bounding box. 
$bounds = ImageTTFBBox($this->size, $this->rot, $this->fontFile, $message);
if ($bounds == false) {
    throw new Exception("imagettfbbox() returned false");
    die();
}
if ($this->rot < 0) {
    $width = abs($bounds[4] - $bounds[0]);
    $height = abs($bounds[3] - $bounds[7]);
    $offset_y = $font_height;
    $offset_x = 0;
} else if ($this->rot > 0) {
    $width = abs($bounds[2] - $bounds[6]);
    $height = abs($bounds[1] - $bounds[5]);
    $offset_y = abs($bounds[7] - $bounds[5]) + $font_height;
    $offset_x = abs($bounds[0] - $bounds[6]);
} else {
    $width = abs($bounds[4] - $bounds[6]);
    $height = abs($bounds[7] - $bounds[1]);
    $offset_y = $font_height;
    $offset_x = 0;
}

$image = imagecreatetruecolor($width + ($this->pad * 2) + 1, $height + ($this->pad * 2) + 1);
if ($image == false) {
    throw new Exception("imagecreatetruecolor() returned false");
    die();
}

$background = imagecolorallocate($image, $this->bg_red, $this->bg_grn, $this->bg_blu);
$foreground = imagecolorallocate($image, $this->red, $this->grn, $this->blu);
if ($background === false || $foreground === false) {
    throw new Exception("imagecolorallocate() returned false");
    die();
}

if ($this->transparent)
    imagecolortransparent($image, $background);
imageinterlace($image, false);

// render it. 
imageTTFText($image, $this->size, $this->rot, $offset_x + $this->pad, $offset_y + $this->pad, $foreground, $this->fontFile, $message);

if($this->flipped) { $image = $this->ImageFlip($image, IMAGE_FLIP_VERTICAL); }

// output PNG object. 
imagePNG($image);
}

}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-02-20T17:28:03.853

如果你想要一个完全透明的背景，你可以在 imagecreatetruecolor 之后使用以下内容。

```
imagesavealpha($image, true);
$trans_colour = imagecolorallocatealpha($image, 0, 0, 0, 127);
imagefill($image, 0, 0, $trans_colour); 
```

您要做的是创建一个真彩色图像，确保 alpha 保存状态处于打开状态，然后使用已将其 alpha 级别设置为完全透明 (127) 的颜色填充图像。

另外，请注意，第一次调用 imagecolorallocate 会用该颜色填充背景。只是觉得你也应该注意这一点。**

# java - 获取视图时的Android Fragment空指针

> ID：15694385
> 
> 赞同：0
> 
> 时间：2013-03-29T00:14:54.347
> 
> 标签：java, android, view, fragment

当适配器更改片段内的列表视图时，我一直在用片段撞墙并触发视图刷新。现在我有：

*   持有 FragmentManager 的主要活动
*   Activity 通过 FragmentPagerAdapter.getItem 方法根据位置创建片段
*   随后的活动或按钮按下会导致其中一个片段背后的数据发生变化
*   Activity调用自定义Fragment类的refresh方法触发数据刷新
*   refresh 方法获取片段中的 ListView 对象
    *   这是发生 Null 异常的地方

刷新方法如下：

```
public void refresh() {
  groups = new Select()
    .from(Group.class)
    .execute();

  listView = (ListView)getActivity().findViewById(R.id.overview_container);
  // Never get here
  groupAdapter.clear();
  groupAdapter.setItems(groups);
  listView.invalidateViews();   
} 
```

设置是

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
  view = inflater.inflate(R.layout.fragment_overview, container, false);

  groups = new Select()
    .from(Group.class)
    .execute();

  listView = (ListView)view.findViewById(R.id.overview_container);
  listView.setAdapter(new GroupAdapter(view.getContext(), R.layout.time_view, groups));     
  return view;
} 
```

我在这里缺少一些基本的东西吗？这里有像听众这样更简单的模式可以解决这个问题吗？我似乎无法让视图返回除 null 之外的任何内容——即使我存储它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T02:14:30.503

我正在通过 FragmentManager 获取 Fragment 并转换为原始接口以运行接口方法 - 这似乎返回了一个意外的版本，它不一定是活动的 Fragment，从而导致了我遇到的问题。

相反，我自己保留了对生成的片段的引用，因此我可以随意引用它们。

# android - 在android中找不到SupportMapFragment类错误

> ID：15694388
> 
> 赞同：1
> 
> 时间：2013-03-29T00:15:11.070
> 
> 标签：android

嗨，我正在尝试使用支持地图片段来显示谷歌地图片段，尽管我的项目同时具有 android-support-v4 jar 和 google-play-service_lib jar，但到目前为止没有任何乐趣

这是我的布局

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <fragment
        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

</RelativeLayout> 
```

我的地图活动

```
package com.jr.haliotest;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.util.Log;

import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.model.CameraPosition;
import com.google.android.gms.maps.model.LatLng;
import com.jr.haliotest.utils.IntentFilters;
import com.jr.haliotest.utils.Position;

/**
 * @author RichardsJ
 * 
 */
public class MapActivity extends FragmentActivity  implements IntentFilters {

    private GoogleMap googleMap;

    private Position mPosition;

    private CameraPosition mCameraPosition;

    /*
     * (non-Javadoc)
     * 
     * @see android.app.Activity#onCreate(android.os.Bundle)
     */
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map_view_layout); //fails here
        mPosition = getIntent().getParcelableExtra(INTENT_EXTRA_POSITION);
        mCameraPosition = new CameraPosition(new LatLng(
                mPosition.getLattitude(), mPosition.getLongetude()), 0, 0, 0);
        initialiseView();
    }

    private void initialiseView() {

        googleMap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map)).getMap();

        if (googleMap == null) {
            Log.d("", "Map wasnt loaded properly");
        } else {
            Log.d("", "Map loaded fine");
            googleMap.setMapType(GoogleMap.MAP_TYPE_HYBRID);
        }

        googleMap.moveCamera(CameraUpdateFactory
                .newCameraPosition(mCameraPosition));

    }
} 
```

完整的堆栈跟踪

```
 03-29 00:20:17.501: E/AndroidRuntime(2211): FATAL EXCEPTION: main
03-29 00:20:17.501: E/AndroidRuntime(2211): java.lang.NoClassDefFoundError: com.google.android.gms.R$styleable
03-29 00:20:17.501: E/AndroidRuntime(2211):     at com.google.android.gms.maps.GoogleMapOptions.createFromAttributes(Unknown Source)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at com.google.android.gms.maps.SupportMapFragment.onInflate(Unknown Source)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:279)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:676)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:365)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.Activity.setContentView(Activity.java:1912)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at com.jr.haliotest.MapActivity.onCreate(MapActivity.java:36)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.Activity.performCreate(Activity.java:5066)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1101)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2307)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2387)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.ActivityThread.access$600(ActivityThread.java:151)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1331)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.os.Looper.loop(Looper.java:155)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at android.app.ActivityThread.main(ActivityThread.java:5485)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at java.lang.reflect.Method.invokeNative(Native Method)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at java.lang.reflect.Method.invoke(Method.java:511)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1028)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:795)
03-29 00:20:17.501: E/AndroidRuntime(2211):     at dalvik.system.NativeStart.main(Native Method) 
```

如果我使用 MapFragment 对象而不是支持的对象，它工作正常。

有任何想法吗？我错过了什么？尝试清洁，关闭日食，重新安装应用程序，没有乐趣

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T11:41:14.783

我设法让它工作。

以下是有关如何将支持的库与 google map v2 一起使用的具体步骤。

1.  将 google play 服务库复制到您的 lib 文件夹中
2.  在您的 lib 文件夹中复制 android 支持的 v4 lib
3.  将 1 和 2 添加到构建路径
4.  将 google play 服务项目导入您的工作区
5.  选择你的项目并点击>属性>android>添加项目库（谷歌播放服务），不要勾选“是库”
6.  选择google play服务项目并右键单击并转到属性>android>勾选“is lib”
7.  使用 FragmentActivity 并使用 Support 来使用支持的库。
8.  清理并重建，退出 Eclipse，之前在您的设备上卸载应用程序，加载 Eclipse 并进行另一次清理和重建。现在应该一切正常

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:33:31.123

您需要获取 Google Play SDK：

[http://developer.android.com/google/play-services/index.html](http://developer.android.com/google/play-services/index.html)

基本上，您的 extras 目录中可能有代码，因此您将其导入您的工作区，然后编译它，将其作为库添加到您的项目中，您应该已设置好。

# c - 使用 C 在文件中搜索记录

> ID：15694389
> 
> 赞同：0
> 
> 时间：2013-03-29T00:15:19.993
> 
> 标签：c, file-management

我正在使用 C 和文件管理进行锻炼，我可以打开文件，在文件上写入记录，关闭文件，但是我无法找到已经写入的记录。这是我的练习：（案例 2 中的搜索）

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

main(){
    struct info{
        char name[40];
        char sur[40];
    };
    struct info rec;
    FILE *f1, *f2;
    int sel, ser, res;
    char cmp[40];
    int cont=0;

    f1=fopen("lis.txt","a+");

    do{
        do{
            printf("1> Add account\n");
            printf("2> Search account\n");
            printf("3> Modify account\n");
            printf("4> Exit\n");
            printf("Type your choice -> ");
            scanf("%d", &sel);
            if(sel<1 || sel>4){
                printf("ERROR: The choice isn't allowed\n");
            }
        }while(sel<1 || sel>4);

        getchar();
        switch(sel){
            case 1:
                printf("Insert new account\n");
                printf("Write name: ");
                fgets(rec.name, sizeof(rec.name), stdin);
                printf("Write surname: ");
                fgets(rec.sur, sizeof(rec.sur), stdin);

                fputs(rec.name,f1);
                fputs(rec.sur,f1);
                fprintf(f1,"\n");

                printf("Account added!\n");
                break;
            case 2:
                printf("Search account\n");
                printf("Write surname to search: ");
                fgets(cmp, sizeof(cmp), stdin);
                while(!feof(f1)){
                    if(strcmp(cmp,rec.sur)==0){
                        printf("ENT\n");
                    }
                }
                break;
    //      case 3:
    //          printf("Modify account\n");
    //          //funzione ricerca qua
    //          printf("Account modificato correttamente!\n");
    //          break;
            case 4:
                printf("Closing...\n");
                break;
            default:
                printf("ERROR!\n");
                break;
        }
    }while(sel!=4);
} 
```

程序还没有完成，所以有很多未使用的东西，我稍后会修复。它在 OpenVMS 上进行了测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T06:08:56.140

feof()的使用总是有问题，所以请避免使用它...

为什么不使用 feof() 作为循环退出条件。请[这里](https://stackoverflow.com/questions/4299296/how-to-use-feoffile-f)是链接。

[这](http://www.codingunit.com/c-tutorial-searching-for-strings-in-a-text-file)是一个很好的教程的链接，我已经将它与你的代码结合起来，它就像魅力一样......请查看它。

下面是修改后的代码，

```
struct info
{
    char name[40];
    char sur[40];
};

int Search_in_File(char *fname, char *str) {
    FILE *fp;
    int line_num = 1;
    int find_result = 0;
    char temp[40];

    if((fp = fopen(fname, "r")) == NULL) {
        return(-1);
    }

    while(fgets(temp, 40, fp) != NULL) {
        if((strstr(temp, str)) != NULL) {
            printf("A match found on line: %d\n", line_num);
            printf("\n%s\n", temp);
            find_result++;
        }
        line_num++;
    }

    if(find_result == 0) {
        printf("\nSorry, couldn't find a match.\n");
    }

    //Close the file if still open.
    if(fp) {
        fclose(fp);
    }
    return(0);
}

int main()
{

    struct info rec;
    FILE *f1; //*f2;
    int sel;// ser, res;
    char cmp[40];
    char fname[10] = "lis.txt";
    int err = -1;
//    int cont=0;

    do{
        do{
            printf("1> Add account\n");
            printf("2> Search account\n");
            printf("3> Modify account\n");
            printf("4> Exit\n");
            printf("Type your choice -> ");
            scanf("%d", &sel);
            if(sel<1 || sel>4){
                printf("ERROR: The choice isn't allowed\n");
            }
        }while(sel<1 || sel>4);

        getchar();
        switch(sel){
            case 1:
                f1=fopen(fname ,"a+");
                if (!f1) 
                {
                    printf("lis.txt, no such file exits\n");
                    return -1;
                }            
                printf("Insert new account\n");
                printf("Write name: ");
                fgets(rec.name, sizeof(rec.name), stdin);
                printf("Write surname: ");
                fgets(rec.sur, sizeof(rec.sur), stdin);

                fprintf(f1,"%s",rec.name);
                fprintf(f1,"%s\n",rec.sur);

                fflush(f1);
                printf("Account added!\n");
                fclose(f1);
                break;
            case 2:
                printf("Search account\n");
                printf("Write surname to search: ");
                fgets(cmp, 40, stdin);
                err = Search_in_File(fname, cmp);
                if(err < 0)
                {
                    return err;
                }
                break;
          case 3:
              printf("Modify account\n");
              break;
            case 4:
                printf("Closing...\n");
                break;
            default:
                printf("ERROR!\n");
                break;
        }
    }while(sel!=4);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T12:28:06.320

有很多事情要照顾。
**1.文件没有正确关闭。**

您已经在程序的开头打开了该文件。并且从未关闭。您写入文件的任何内容都不会立即实际写入，它们会被缓冲。您需要刷新它或关闭文件。因此，在对文件执行任何其他操作之前，请确保它已被刷新。

**2\. 不从文件中读回记录。**

您尚未从文件中读回记录。您总是在搜索结构的当前值`rec`。在比较之前，您需要将每条记录读取到结构中。此外，如果您不读取文件，则文件指针永远不会前进，并且控件将永远停留在循环中。

**3、新行不处理。**

每条记录后都有额外的新行。您需要在从文件中读回记录时处理这些问题。`gets`在行尾消耗一个换行符。所以你需要手动处理额外的`\n`.

*此外，如果您找到记录，则需要中断 while 循环。除非您期望重复，否则留在那里是没有意义的。*

以下对您的代码进行了一些修改。这对我有用。你可以试试这个：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

main(){
    struct info{
        char name[40];
        char sur[40];
    };
    struct info rec;
    FILE *f1, *f2;
    int sel, ser, res;
    char cmp[40];
    char dummy;
    int cont=0;

    do{
        do{
            printf("1> Add account\n");
            printf("2> Search account\n");
            printf("3> Modify account\n");
            printf("4> Exit\n");
            printf("Type your choice -> ");
            scanf("%d", &sel);
            if(sel<1 || sel>4){
                printf("ERROR: The choice isn't allowed\n");
            }
        }while(sel<1 || sel>4);

        getchar();
        switch(sel){
            case 1:
                printf("Insert new account\n");
                printf("Write name: ");
                fgets(rec.name, sizeof(rec.name), stdin);
                printf("Write surname: ");
                fgets(rec.sur, sizeof(rec.sur), stdin);
                f1=fopen("lis.txt","a+"); //<- open file for writing
                fputs(rec.name,f1);
                fputs(rec.sur,f1);
                fprintf(f1,"\n");
                fclose(f1); // close the file. this will flush the buffer.
                printf("Account added!\n");
                break;
            case 2:
                printf("Search account\n");
                printf("Write surname to search: ");
                fgets(cmp, sizeof(cmp), stdin);
                f1=fopen("lis.txt","r"); //<- open the file for reading
                while(!feof(f1)){
                      fgets(rec.name,sizeof(rec.name),f1); //<- read both the data. this will update the file pointer.
                      fgets(rec.sur,sizeof(rec.sur),f1);
                      fscanf(f1,"%c",&dummy); //<- this handles the additional newline
                    if(strcmp(cmp,rec.sur)==0){
                        printf("RECORD FOUND::\nName:%sSurname:%s\n\n",rec.name,rec.sur);
                        break; //<- break if record is found
                    }
                }
                fclose(f1); //<- close the file after you are done.
                break;
    //      case 3:
    //          printf("Modify account\n");
    //          //funzione ricerca qua
    //          printf("Account modificato correttamente!\n");
    //          break;
            case 4:
                printf("Closing...\n");
                break;
            default:
                printf("ERROR!\n");
                break;
        }
    }while(sel!=4);
} 
```

**注意：**当我们`feof()`用来退出循环时，我们必须读取`EOF`来满足退出条件。`EOF`因此，在这段代码中，循环在从文件中读取的最后一条记录之后再继续一次。除非您尝试打印所有记录，否则这不是问题。在这种情况下，请使用不同的退出条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T17:41:21.613

让我先理解你的问题，

你的意思是你找不到以前输入的记录。

可以说这部分的代码：

```
 printf("Search account\n");
 printf("Write surname to search: ");

 fgets(cmp, sizeof(cmp), stdin);
      while(!feof(f1)){
          if(strcmp(cmp,rec.sur)==0){
              printf("ENT\n");
          }
      }
      break; 
```

是否读取文件，然后....

如果你这样写代码：

以读取模式打开文件，因为如果您尝试读取文件，a+ 将不起作用

```
f1 = fopen("lis.txt", "r");

if (!f1) {
    printf("lis.txt, no such file exits\n");
    return -1;
}

while (feof(f1)) {
    fgets(str, len, f1);
    if (strcmp(str, sur) == 0) {
        /// Do what ever you want, printing the record e.t.c..
    }
} 
```

希望这可以帮助， ：）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T19:55:09.640

问题始于您写入文件的格式。您可以`struct info`为每条记录编写整体，也可以将每个字段写在一行上。在第一种情况下，文件将被称为“二进制”；第二种情况“文本”。您似乎更喜欢文本文件格式。

要在一行上写入一个字段，请更改`fputs(rec.name,f1)`为`fprintf(f1,"%s\n",rec.name)`，与其他字段类似。现在，一条记录由特定序列中固定数量的行组成——具体来说，一行 for`name`和一行 for `sur`。然后，您可以通过两次调用来读取记录`fgets`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-01T22:51:06.267

如果我正确阅读了代码，那么您将尝试在将记录写入文件后搜索记录而不关闭文件。如果你想这样做，你需要调用 rewind 或 fseek 去开始。

请记住，您要么需要在执行此操作（ftell）之前存储文件位置，要么在添加更多记录之前关闭并打开更多记录。

正如约翰在上面指出的那样，在 +a 模式下阅读也可能根本不起作用。最好在每个案例之后关闭文件并以正确的模式打开它。

# ruby - Ruby 数字上的括号表示法

> ID：15694391
> 
> 赞同：7
> 
> 时间：2013-03-29T00:15:28.600
> 
> 标签：ruby, numbers, square-bracket

我发现`100`在 Ruby 中对数字使用括号表示法时，我得到了这个：

```
irb(main):001:0> 100[0]
=> 0
irb(main):002:0> 100[1]
=> 0
irb(main):003:0> 100[2]
=> 1 
```

所以我假设它正在获取数字，索引如下：

```
NUMBER: 1|0|0
        -----
INDEX:  2|1|0 
```

我在号码上尝试了这个，`789`结果出乎意料。

```
irb(main):004:0> 789[0]
=> 1
irb(main):005:0> 789[1]
=> 0
irb(main):006:0> 789[2]
=> 1 
```

我希望它返回`9`, then `8`, then`7`如果它正在获取数字。从这个结果来看，这显然没有发生，那么在数字上使用括号表示法到底有什么作用呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-29T00:18:34.847

这些是您要提取的二进制位。另一种查看方式是使用`to_s`指示所需基数的参数。

```
>> 789.to_s(2)
=> "1100010101" 
```

字符串索引是从左到右的，因此您无法`[]`在字符串上进行比较，但请注意（从右到左）数字是 1、0、1 的方式。

如果您有兴趣，这里是文档：[http ://ruby-doc.org/core-1.9.3/Fixnum.html#method-i-5B-5D](http://ruby-doc.org/core-1.9.3/Fixnum.html#method-i-5B-5D)

# jquery - 显示/隐藏图库

> ID：15694392
> 
> 赞同：0
> 
> 时间：2013-03-29T00:15:33.033
> 
> 标签：jquery

当您单击下拉菜单中显示的缩略图时，我有一个画廊正在显示和隐藏。[http://bvh.delineamultimedia.com/?page_id=2](http://bvh.delineamultimedia.com/?page_id=2)如果您单击第一张图片，它会下拉并显示图库。如果您关闭它并再次打开它，画廊将不再存在。无论我点击缩略图多少次，有没有办法让它停留在那里。

如果该代码以较大的格式显示缩略图，则假定此代码将显示画廊。

```
if (sliderData.length > 0) { // show the slider if there is one
    superbox.append(sliderData); // clone the element so we don't loose it for the next time the user clicks
} else { // if there is no slider proceed as before
    if (imgData.img) {
        superboximg.attr('src', imgData.img);
    }
} 
```

# php - 尝试将数据插入 mysql 时出现 T_ENCAPSED_AND_WHITESPACE 错误

> ID：15694394
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:15:33.397
> 
> 标签：php, mysql, parsing, insert

我一直在尝试使用 php 将数据插入 mysql 但收到此错误 Parse error: syntax error, unexpected T_ENCAPSED_AND_WHITESPACE ...

这是我的插入文件

```
<?php
    include_once 'include.php';
    include_once 'header.php';

    //$dbhandle = mysql_connect($hostname, $DBUser, $DBPasswd) 
    // or die("Unable to connect to MySQL");
    //echo "Connected to MySQL<br>";

    $DBsubmit="INSERT INTO User (fname, lname, email, password, institution, expertise)   
               VALUES('$_POST['fname']', '$_POST['lname']', '$_POST['email']', '$_POST['password']', '$_POST['institution']', '$_POST['expertise']')";
    $result=mysql_query($DBsubmit)

    //echo "1 record added";

    // close connection 
    mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:18:04.693

字符串内部的数组访问语法与外部不同。更改为：

```
{$_POST['fname']} 
```

或者

```
$_POST[fname] 
```

您还缺少`query`一行上的分号。

您的代码也***尽可能容易受到攻击***。您应该对 PDO 或 mysqli 使用正确的参数化查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:23:56.897

您的查询在 SQL 注入中非常容易受到攻击。我建议`mysql_real_escape_string`改用。

```
$DBsubmit=sprintf("INSERT INTO User (fname, lname, email, `password`, institution, expertise)
VALUES('%s','%s','%s','%s','%s','%s')",
mysql_real_escape_string($_POST['fname']),
mysql_real_escape_string($_POST['lname']),
mysql_real_escape_string($_POST['email']),
mysql_real_escape_string($_POST['password']),
mysql_real_escape_string($_POST['institution']),
mysql_real_escape_string($_POST['expertise'])); 
```

# validation - 验证中的css文件交互

> ID：15694401
> 
> 赞同：0
> 
> 时间：2013-03-29T00:16:02.060
> 
> 标签：validation, w3c, css, css-validator

我正在使用 w3c 的 css 验证器。验证器将获取一个 html 页面并检查它的所有内联、嵌入和链接 CSS。

我的问题是 - 单独验证我的所有 css 是否安全（验证内联/嵌入式 css 而链接 css 不可用等）？

换一种方式问这个问题 - 当页面的所有 css 元素一起验证时，验证器是否可以更好地检查错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:38:04.360

我不认为验证器可以同时对所有文件说得更好，除非您的 html 中的某些类或 Id 在您的 CSS 中没有样式，但无论如何这都是完全有效的。在旁注中，您为什么如此担心您的页面完全有效？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:38:24.530

W3C 验证器仅检查标记的语法，因此可以单独检查 CSS 规则。

# c++ - 删除二维数组占用内存？

> ID：15694402
> 
> 赞同：2
> 
> 时间：2013-03-29T00:16:03.727
> 
> 标签：c++, pointers, vector, multidimensional-array

我已经在这个程序上工作了很长一段时间。这只是提取的两个导致我似乎无法调试的内存泄漏的函数。任何帮助都会很棒！

```
 vector<int**> garbage; 
```

删除已用内存的代码

```
 void clearMemory()
   {
         for(int i = 0; i < garbage.size(); i++)
         {
               int ** dynamicArray = garbage[i];

               for( int j = 0 ; j < 100 ; j++ )
               {
                   delete [] dynamicArray[j];
               }
         delete [] dynamicArray;
         }
         garbage.clear();
   } 
```

声明动态数组的代码

```
 void main()
   {
        int ** dynamicArray1 = 0;
        int ** dynamicArray2 = 0;

        dynamicArray1 = new int *[100] ;
        dynamicArray2 = new int *[100] ;

        for( int i = 0 ; i < 100 ; i++ )
        {
            dynamicArray1[i] = new int[100];
            dynamicArray2[i] = new int[100];
        }

        for( int i = 0; i < 100; i++)
        {
            for(int j = 0; j < 100; j++)
            {
                dynamicArray1[i][j] = random();
            }
        }

        //BEGIN MULTIPLICATION WITH SELF AND ASSIGN TO SECOND ARRAY
        dynamicArray2 = multi(dynamicArray1); //matrix multiplication
        //END MULTIPLICATION AND ASSIGNMENT

        garbage.push_back(dynamicArray1);
        garbage.push_back(dynamicArray2);
        clearMemory();
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:28:26.010

我盯着代码看了一段时间，似乎找不到任何泄漏。在我看来`delete`，每个 都有一个`new`，因为它应该是。

尽管如此，我真的想说，声明一个`std::vector<int**>`几乎违背了使用`std::vector`它本身的意义。

在 C++ 中，您必须使用指针的情况很少，这不是其中之一。我承认声明和使用 an 会很痛苦，`std::vector<std::vector<std::vector<int>>>`但这将确保您的代码中没有泄漏。

因此，我建议您根据自动管理内存分配的对象重新考虑您的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-03T22:59:06.520

Point 1：如果你有内存泄漏，用`valgrind`它来定位它。就像蓝色一样，我似乎无法在您的代码中找到内存泄漏，但`valgrind`会肯定地告诉您您的内存出了什么问题。

第 2 点：您正在有效地创建一个 2x100x100 3D 数组。C++ 不是这种事情的正确语言。当然，您可以使用`std::vector<std::vector<std::vector<int>>>`具有明显缺点的 an。或者您可以退回到 C：

```
int depth = 2, width = 100, height = 100;

//Allocation:
int (*threeDArray)[height][width] = malloc(depth*sizeof(*threeDArray));

//Use of the last element in the 3D array:
threeDArray[depth-1][height-1][width-1] = 42;

//Deallocation:
free(threeDArray); 
```

请注意，这是有效的 C，但不是有效的 C++：后一种语言不允许数组类型的运行时大小，而前者自 C99 起就支持这一点。在这方面，C 比 C++ 更强大。

# facebook - Facebook没有更新喜欢的描述

> ID：15694403
> 
> 赞同：1
> 
> 时间：2013-03-29T00:16:21.507
> 
> 标签：facebook, facebook-sharer

我在本地机器上开发的一个项目中实施 Like Description 时遇到问题。我的问题是我只能让 Title 和 Url 出现在 Like Description 中，并且它缺少图像和文本。我创建了一个只有一个赞按钮的空白页面并将其上传到公共服务器上，并注意到我无法更新赞描述中的内容。

例如，如果您转到下面的我的测试页面并单击 Facebook Like 按钮，您将看到 Like Description 描述为“页面描述，预期输出”。但是，如果您查看页面源代码，您会看到我已将带有 Meta OG 标记的描述设置为`<meta property="og:description" content="This is a new page description"/>`. 当前的描述标签是我创建此页面时第一次使用的标签。

所以我的问题是为什么我不能更新赞描述？Facebook 是否将其缓存在其服务器上的某个位置？如果是这样，你知道它被缓存了多长时间吗？另外，如果我在本地进行测试，这会起作用吗？

[http://www.sfu.ca/~jca41/stuph/test.html](http://www.sfu.ca/~jca41/stuph/test.html)

```
<head>
    <meta property="og:url" content="http://www.sfu.ca/~jca41/stuph/test.html"/>
    <meta property="og:image" content="http://www.placehold.it/320x200/">
    <meta property="og:description" content="This is a new page description"/>  
    <meta property="og:title" content="Site title"/>
    <meta property="og:type" content="game"/>    
    <meta property="og:site_name" content="Site name"/> 
    <meta property="fb:admins" content="690014395"/>
</head>

<body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>

    <div class="fb-like" data-href="http://www.sfu.ca/~jca41/stuph/test.html" data-send="true" data-width="450" data-show-faces="false"></div>

</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:50:02.060

Facebook 有一个名为 Debugger 的工具，该工具获取最新内容，并使用最新内容更新缓存：[https ://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)

这应该会有所帮助。

# html - 如何创建带有预览的选择字体下拉列表？

> ID：15694406
> 
> 赞同：6
> 
> 时间：2013-03-29T00:16:41.423
> 
> 标签：html, css

我想创建一个选择下拉列表来选择字体。在此列表中，我希望每个字体选项都以该样式显示为字体的预览。

```
<select>
    <option class="Times-New-Roman" value="Times-New-Roman">Times New Roman</option>
    <option class="Verdana" value="Verdana">Verdana</option>
    <option value="Comic-Sans-MS">Comic Sans MS</option>
    <option value="WildWest">WildWest</option>
    <option value="Bedrock">Bedrock</option>
</select> 
```

上面是一个基本的下拉框，其中每种字体类型都有自己的类名，但似乎无法弄清楚如何制作它，以便每个类名都有自己的字体，该字体将显示在下拉列表中。

感谢您花时间帮助寻找解决方案。

最好的问候，蒂姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T09:04:34.297

尝试如下格式。

```
<select>
    <option style="font-family:'Times New Roman';" class="Times-New-Roman" value="Times-New-Roman">Times New Roman</option>
    <option style="font-family:Verdana, Geneva, sans-serif;" class="Verdana" value="Verdana">Verdana</option> 
```

# jquery - 如何使用 jquery 将部分 ul 元素保存到文件中

> ID：15694410
> 
> 赞同：0
> 
> 时间：2013-03-29T00:17:03.073
> 
> 标签：jquery

我将如何将部分 ul 保存到文件中。下面我标记了我想保存到文件的这个 html 代码的开始和结束：

我试过这个： $(ul li:first > *).clone(); 但是警报显示 [object Object] 我如何通过警报查看我正在保存的内容，以验证我正在保存 ul 元素的正确部分？

```
 <ul id="ul_first">
              <li>a</li>
              <li>b</li>  <---- start saving at this point
              <li>c</li>
              <li>d</li>
              <li>c
                   <ul id="ul_second">
                       <li>a2</li>  
                       <li>b2</li>
                       <li>c2</li>
                       <li>d2</li>
              </ul>                 <---- end saving at this point
 </li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:41:32.537

我认为您不想使用 $.clone 来执行此操作。

我尝试了几种方法来做到这一点，我认为这是最酷的：

如果您使用的是 Chrome，则以下内容将起作用（也可能是 Safari）：

> 打开浏览器的 Web 控制台并输入。

```
 copy($('#ul_first li:gt(0)').map(function(){
        return this.outerHTML;
        }).get().join('\r\n')) //Or if you are using Linux or a Mac, just ('\n') 
```

如果您不使用 Chrome，则可以在任何浏览器的 Web 控制台中通过以下方式完成相同的操作：

```
 var li=$('#ul_first li:gt(0)').map(function(){
                return this.outerHTML;
              }).get().join('\r\n') 
```

您帖子的标题表明您可能正在尝试以编程方式复制此内容。如果您尝试创建将上述元素写入外部文件的脚本，使用纯 jQuery 执行此操作的唯一方法是使用[HTML5 File API](http://www.html5rocks.com/en/tutorials/file/filesystem/ "HTML5 文件接口")（尽管此示例不使用 jQuery，仅使用 Javascript）。没有它，您将需要服务器端技术来写入外部文件（PHP、ASP 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:20:24.563

使用 console.log() 代替 alert()；

```
var selected = $('ul li:first > *').clone();
console.log(selected); 
```

然后，您可以打开[Web 控制台](https://developer.mozilla.org/en-US/docs/DOM/console.log)来查看 javascript 对象。

# css - 如何在 div 上有一个不透明的背景图像？

> ID：15694412
> 
> 赞同：0
> 
> 时间：2013-03-29T00:17:05.517
> 
> 标签：css, background-image, opacity

我有一个`<div>`包含一堆`<p>`s 并希望在文本后面有一个不透明的背景图像，缩放以填充整个`<div>`. 即无论我添加或删除多少文本，图像都应该扩大或缩小以覆盖`<div>`.

并且只有图像应该具有不透明度。div 中的文本应为纯黑色。

请问我该怎么做？（我是否必须担心不支持 CSS3 的浏览器？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:25:15.207

[答案] 来自 op

我退后一步，以另一种方式查看问题，并找到了一个跨浏览器且不需要 CSS3 的答案。

我启动了[The Gimp](http://www.gimp.org/)并在图像本身中添加了 opactiy！正是我想要做的，不需要花哨的 CSS3 ;​​-)

非常感谢您的帮助，@JSW189。我希望您不介意我在您的答案中发布，但这是我选择的解决方案。

* * *

您想使用该[`background-image`](https://developer.mozilla.org/en-US/docs/CSS/background-image)属性添加图像，然后`background-size:100%`让背景图像填充整个 div。

```
div {
    background-image:url('image_url_goes_here.jpg');
    background-size: 100%;
} 
```

[JS 小提琴示例](http://jsfiddle.net/YJZRE/6/)。

此外，如果您想切换不透明度，您可以使用该[`opacity`](https://developer.mozilla.org/en-US/docs/CSS/opacity)属性。它默认设置为(opaque)，但您可以通过在和`opacity:1`之间切换不透明度来更改它。因此，例如，如果您想要 50% 的不透明度，您可以使用.`1``0``opacity:.5`

[不透明度 JS 小提琴示例](http://jsfiddle.net/YJZRE/7/)。

请注意，这[`background-size`](https://developer.mozilla.org/en-US/docs/CSS/background-size)是一个 CSS3 属性。您可以[在此处查看浏览器兼容性图表](http://caniuse.com/#feat=background-img-opts)。但是，这个问题可以通过诸如[modernizr](http://modernizr.com/)之类的库来解决。

# python - Django 数据库 1054 错误

> ID：15694418
> 
> 赞同：0
> 
> 时间：2013-03-29T00:17:48.093
> 
> 标签：python, django

目前在 Django 上工作。我有以下型号：

```
from django.db import models

class cliente(models.Model):
    nombre      = models.CharField(max_length=200)
    apellidos   = models.CharField(max_length=200)
    status      = models.BooleanField(default=True)

    def __unicode__(self):
        nombreCompleto = "%s %s"%(self.nombre,self.apellidos)
        return nombreCompleto

class producto(models.Model):

    def url(self, filename):
        ruta = "MultimediaData/Producto/%s/%s"%(self.nombre, str(filename))
        return ruta

    nombre      = models.CharField(max_length = 100)
    descripcion = models.TextField(max_length = 300)
    status      = models.BooleanField(default = True)
    imagen      = models.ImageField(upload_to = url)
    precio      = models.DecimalField(max_digits = 6, decimal_places = 2) 
    stock       = models.IntegerField()

    def __unicode__(self): 
        return self.nombre 
```

当我尝试在管理员下访问时`cliente`，`producto`我得到了 `(1054, "Unknown column 'ventas_cliente.apellidos' in 'field list'")`错误。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:24:30.290

您可能`apellidos`在完成第一个之后添加了该列`syncdb`。当您第一次使用 syncdb 时，会在数据库中创建表。之后，对模型的任何更改都不会应用于您的数据库。您必须自己使用`ALTER TABLE`SQL 命令或通过删除表（如果您不需要其中的数据）并`syncdb`再次运行来进行更改。

我建议您检查[South](http://south.readthedocs.org/en/latest/about.html)：

> South 可以查看您的 models.py 文件中的更改并自动编写与您的更改相匹配的迁移。

# jquery-ui - 连接淘汰赛和 jQueryUI 自动完成

> ID：15694425
> 
> 赞同：5
> 
> 时间：2013-03-29T00:19:16.663
> 
> 标签：jquery-ui, knockout.js

我有一个 jQueryUI 自动完成功能，它从客户列表中提取并基于选择器 [input data-role="customer-search"] 附加。选择客户后，我会进行 AJAX 调用以获取完整的客户详细信息。这部分我工作得很好。问题是我无法找到将淘汰赛纳​​入其中的方法。我的理想情况是像“onSelect：customerSelected”这样的自定义绑定，它将接收选定的客户JSON并将其集成到整个模型中，然后会导致页面上的一堆字段更新为模型。客户.地址、模型.客户.类型。

我要反对的地方是在我从 AJAX 调用中取回客户 JSON 后的连接点，如何将其发送到视图模型上的“customerSelected”方法，该方法与我附加了 jQuery 自动完成的相同输入相关联。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-30T01:13:41.387

这是我的团队为处理自动完成而编写的绑定处理程序的简化版本。当一个项目被选中时，该项目被插入到视图模型中的一个可观察数组中。它以下列方式绑定：

```
<input type="text" data-bind="autoComplete:myObservableArray, source:'myUrl'" /> 
```

*您可以自定义在“选择：* ”区域 中选择项目时发生的情况。

```
ko.bindingHandlers.autoComplete = {
    init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
        var postUrl = allBindingsAccessor().source; // url to post to is read here
        var selectedObservableArrayInViewModel = valueAccessor();

        $(element).autocomplete({
            minLength: 2,
            autoFocus: true,
            source: function (request, response) {
                 $.ajax({
                    url: postUrl,
                    data: { term: request.term },
                    dataType: "json",
                    type: "POST",
                    success: function (data) {
                        response(data);
                    }
                });
            },
            select: function (event, ui) {
                var selectedItem = ui.item;

                if (!_.any(selectedObservableArrayInViewModel(), function (item) { return item.id == selectedItem.id; })) { //ensure items with the same id cannot be added twice.
                    selectedObservableArrayInViewModel.push(selectedItem);
                }
            }
        });
    }
}; 
```

希望您正在寻找类似的东西。如果您需要澄清一些事情，请告诉我。

**注意**除了 jquery 和 knockout，此示例还使用 underscore.js（*_.any() 函数*）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-01T11:10:26.747

## 值更新：模糊

`data-bind="value: textbox, valueUpdate: blur"`绑定为我解决了这个问题：

```
$(function() {
    $(".autocomplete").autocomplete({
        source: [
           "ActionScript",
           "AppleScript",
           "Asp",
           "BASIC",
           "C",
           "C++",
           "Clojure",
           "COBOL",
           "ColdFusion",
           "Scheme"]
    });
 });

var viewModel = {
    textbox: ko.observable()
};

ko.applyBindings(viewModel);
```

```
<script src="//cdnjs.cloudflare.com/ajax/libs/knockout/3.2.0/knockout-min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//code.jquery.com/ui/1.11.3/jquery-ui.min.js"></script>

<input type="text" class="autocomplete" data-bind="value: textbox, valueUpdate: blur"/>
```

# ios - 有没有一种通过 iCloud 集成备份 Core Data 数据库的好方法？

> ID：15694426
> 
> 赞同：1
> 
> 时间：2013-03-29T00:19:19.897
> 
> 标签：ios, core-data, icloud

如果CoreData sqlite + iCloud损坏，有没有一种好方法可以从iCloud备份我的sqlite信息？将 .sqlite 复制到另一个位置？当 iCloud 损坏时，从 .sqlite 中读取数据以创建新的 iCloud sqlite？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-15T20:09:07.887

使用 migratePersistentStore API 在设备 /Documents 目录中创建存储文件的副本，它将被备份。有关更完整的说明和示例应用程序，请参见此处。

[http://ossh.com.au/design-and-technology/software-development/sample-library-style-ios-core-data-app-with-icloud-integration/](http://ossh.com.au/design-and-technology/software-development/sample-library-style-ios-core-data-app-with-icloud-integration/)

# oracle - 如何在一个表中查找不在另一个表中的记录

> ID：15694432
> 
> 赞同：0
> 
> 时间：2013-03-29T00:19:47.967
> 
> 标签：oracle

我对 oracle sql 和编程非常陌生，我需要一些帮助来完成我的第一个项目。我正在使用这个表模式：

```
Column  Data Type   Length  Precision   Scale   Nullable
EMPLOYEE_ID NUMBER    22      6           0        No
START_DATE  DATE      7        -          -        No
END_DATE    DATE      7        -          -        No
JOB_ID     VARCHAR2   10       -          -        No
DEPARTMENT_ID   NUMBER  22     4          0        Yes 
```

我想显示所有从未换过工作的员工，甚至一次都没有（上表中未列出的员工） 此表标记为 job_history。我该怎么做呢？我不确定如何开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:24:39.167

```
select * from employees
where employee_id not in ( select employee_id from job_history)
/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:27:36.160

您可以使用左连接并检查 job_history 表上的 null employee_id。

```
select * from employees 
left join job_history 
on job_history.employee_id = employees.employee_id 
where job_history.employee_id is NULL 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-29T06:43:00.267

执行计划通常更适合

```
select * from employees e where not exists 
  (select 1 from job_history jh.employee_id = e.employee_id) 
```

比“不在（）中”。如果表格具有相同的结构，最好的结果将是

```
select * from employees 
minus
select * from job_history 
```

# jakarta-ee - 为什么我的代码中会出现 ExceptionInInitializerError？

> ID：15694433
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:19:50.730
> 
> 标签：jakarta-ee, glassfish, jetty, httpclient, cometd

我想知道为什么我会收到 ExceptionInInitializerError？

平台：

*   视窗;
*   玻璃鱼 3.1.2.2；
*   记事本++；
*   Cometd java库；
*   码头图书馆；
*   Javac 命令行；

我正在逐步建立一个cometd Web 应用程序。经过一些调试后，我意识到码头：HttpClient 类导致 ExceptionInInitializerError，有人可以告诉我这是为什么吗？

我所做的是我去评论代码行，直到我发现问题发生在哪里。

这是发生错误的 CometD_Client 类：

```
import java.util.*;
import java.net.URL;
import org.cometd.bayeux.*;
import org.cometd.bayeux.client.*;
import org.cometd.server.*;
import org.cometd.client.*;
import org.cometd.common.*;
import org.cometd.client.transport.*;
import org.eclipse.jetty.client.*;

import javax.swing.*;

public class CometD_Client
{
    private String CurrentDate;

    private String BayeuxServerURL$;

    private HttpClient JettyHttpClient;

    private Map<String, Object> TransportOptions;

    private ClientTransport C_Transport;

    private BayeuxClient C_Session;

    private boolean HandIsShaken£ = false;

    DayTimePanel Panel;

    public CometD_Client(String BayeuxServerURL$, DayTimePanel Panel)
    {
        this.BayeuxServerURL$ = BayeuxServerURL$;
        this.Panel = Panel;

        // Create (and eventually set up) Jetty's HttpClient;
        JettyHttpClient = new HttpClient();

        /*
        try
        {
            JettyHttpClient.start();
        }
        catch(Exception E) {}
        /*
        */

        // Prepare the transport;
        //TransportOptions = new HashMap<String, Object>();

        //ClientTransport C_Transport = 
        //  LongPollingTransport.create(TransportOptions, 
        //                              JettyHttpClient  );

        //C_Session = new BayeuxClient(BayeuxServerURL$, C_Transport);

        //C_Session.handshake();

        //HandIsShaken£ = 
        //  C_Session.waitFor(1000, BayeuxClient.State.CONNECTED);

        if(HandIsShaken£)
        {
            // TO DO: Output that the handshake had succeed;
        }
        else
        {
            // TO DO: Output that the handshake had failed;
        }

        /*
        C_Session.getChannel(Channel.META_HANDSHAKE).addListener
        (
         new ClientSessionChannel.MessageListener()
         {
            @Override
            public void onMessage(ClientSessionChannel ThisMetaChanel,
                                  Message msg)
            {
                // TO DO: Output msg to check it out;

                C_Session.getChannel("/my/channel").subscribe
                (
                 new ClientSessionChannel.MessageListener()
                 {
                    @Override
                    public void onMessage(ClientSessionChannel ThisChanel,
                                          Message msg)
                    {
                        CurrentDate = msg.getJSON();

                        OutputCurrentDate();
                    }
                 }
                );
            }
         }
        );
        /*
        */
    }

    public boolean GetIfHandIsShaken£()
    {
        return HandIsShaken£;
    }

    public String GetCurrentDate()
    {
        return CurrentDate;
    }

    /*
    private void OutputCurrentDate()
    {
        Panel.GetJTF().setText(CurrentDate);
    }
    /*
    */
} 
```

编辑：应用`asadmin generate-jvm-report --type=thread`这是我得到的日志：

```
<?xml version='1.0' encoding='UTF-8'?>
<hotspot_log version='160 1' process='4732' time_ms='1364843903652'>
<vm_version>
<name>
Java HotSpot(TM) Client VM
</name>
<release>
23.1-b03
</release>
<info>
Java HotSpot(TM) Client VM (23.1-b03) for windows-x86 JRE (1.7.0_05-b06), built on Jun 27 2012 00:51:27 by &quot;java_re&quot; with unknown MS VC++:1600
</info>
</vm_version>
<vm_arguments>
<args>
-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=9009 -XX:+UnlockDiagnosticVMOptions -XX:PermSize=64m -XX:MaxPermSize=192m -XX:NewRatio=2 -XX:+LogVMOutput -XX:LogFile=C:\glassfish3\glassfish\domains\domain1/logs/jvm.log -Xmx512m -javaagent:C:/glassfish3/glassfish/lib/monitor/flashlight-agent.jar -Dosgi.shell.telnet.maxconn=1 -Dfelix.fileinstall.disableConfigSave=false -Djdbc.drivers=org.apache.derby.jdbc.ClientDriver -Dfelix.fileinstall.dir=C:\glassfish3\glassfish/modules/autostart/ -Djavax.net.ssl.keyStore=C:\glassfish3\glassfish\domains\domain1/config/keystore.jks -Dosgi.shell.telnet.port=6666 -Djava.security.policy=C:\glassfish3\glassfish\domains\domain1/config/server.policy -Djava.awt.headless=true -Dfelix.fileinstall.log.level=2 -Dfelix.fileinstall.poll=5000 -Dcom.sun.aas.instanceRoot=C:\glassfish3\glassfish\domains\domain1 -Dosgi.shell.telnet.ip=127.0.0.1 -Dcom.sun.enterprise.config.config_environment_factory_class=com.sun.enterprise.config.serverbeans.AppserverConfigEnvironmentFactory -Djava.endorsed.dirs=C:\glassfish3\glassfish/modules/endorsed;C:\glassfish3\glassfish/lib/endorsed -Dcom.sun.aas.installRoot=C:\glassfish3\glassfish -Dfelix.fileinstall.bundles.startTransient=true -Djava.ext.dirs=C:\Program Files\Java\jdk1.7.0_05/lib/ext;C:\Program Files\Java\jdk1.7.0_05/jre/lib/ext;C:\glassfish3\glassfish\domains\domain1/lib/ext -Dfelix.fileinstall.bundles.new.start=true -Djavax.net.ssl.trustStore=C:\glassfish3\glassfish\domains\domain1/config/cacerts.jks -Dcom.sun.enterprise.security.httpsOutboundKeyAlias=s1as -Djava.security.auth.login.config=C:\glassfish3\glassfish\domains\domain1/config/login.conf -DANTLR_USE_DIRECT_CLASS_LOADING=true -Dgosh.args=--nointeractive -Djava.library.path=C:/glassfish3/glassfish/lib;C:/Program Files/Java/jdk1.7.0_05/bin;C:/WINDOWS/Sun/Java/bin;C:/WINDOWS/system32;C:/WINDOWS;C:/WINDOWS/system32/wbem;C:/Sun/AppServer/bin;C:/glassfish3/bin;C:/glassfish3;C:/glassfish3/ant/bin;C:/glassfish3/glassfish/bin;C:/Sun/AppServer/jdk/bin;C:/Program Files/Ant/bin;C:/Sun/AppServer/lib;C:/Program Files/Flex_SDK/bin;C:/CometD/samples/client_server_API/web 
</args>
<command>
com.sun.enterprise.glassfish.bootstrap.ASMain -domainname domain1 -asadmin-args --host,,,localhost,,,--port,,,4848,,,--secure=false,,,--terse=false,,,--echo=false,,,--interactive=true,,,start-domain,,,--verbose=false,,,--debug=false,,,--domaindir,,,C:\glassfish3\glassfish\domains,,,domain1 -instancename server -verbose false -debug false -asadmin-classpath C:/glassfish3/glassfish/modules/admin-cli.jar -asadmin-classname com.sun.enterprise.admin.cli.AsadminMain -upgrade false -type DAS -domaindir C:/glassfish3/glassfish/domains/domain1 -read-stdin true
</command>
<launcher>
SUN_STANDARD
</launcher>
<properties>
java.vm.specification.name=Java Virtual Machine Specification
java.vm.version=23.1-b03
java.vm.name=Java HotSpot(TM) Client VM
java.vm.info=mixed mode, sharing
java.ext.dirs=C:\Program Files\Java\jdk1.7.0_05/lib/ext;C:\Program Files\Java\jdk1.7.0_05/jre/lib/ext;C:\glassfish3\glassfish\domains\domain1/lib/ext
java.endorsed.dirs=C:\glassfish3\glassfish/modules/endorsed;C:\glassfish3\glassfish/lib/endorsed
sun.boot.library.path=C:\Program Files\Java\jdk1.7.0_05\jre\bin
java.library.path=C:/glassfish3/glassfish/lib;C:/Program Files/Java/jdk1.7.0_05/bin;C:/WINDOWS/Sun/Java/bin;C:/WINDOWS/system32;C:/WINDOWS;C:/WINDOWS/system32/wbem;C:/Sun/AppServer/bin;C:/glassfish3/bin;C:/glassfish3;C:/glassfish3/ant/bin;C:/glassfish3/glassfish/bin;C:/Sun/AppServer/jdk/bin;C:/Program Files/Ant/bin;C:/Sun/AppServer/lib;C:/Program Files/Flex_SDK/bin;C:/CometD/samples/client_server_API/web
java.home=C:\Program Files\Java\jdk1.7.0_05\jre
java.class.path=C:/glassfish3/glassfish/modules/glassfish.jar
sun.boot.class.path=C:\glassfish3\glassfish/modules/endorsed\javax.annotation.jar;C:\glassfish3\glassfish/modules/endorsed\jaxb-api-osgi.jar;C:\glassfish3\glassfish/modules/endorsed\webservices-api-osgi.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\resources.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\rt.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\sunrsasign.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\jce.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.7.0_05\jre\lib\jfr.jar;C:\Program Files\Java\jdk1.7.0_05\jre\classes
java.vm.specification.vendor=Oracle Corporation
java.vm.specification.version=1.7
java.vm.vendor=Oracle Corporation
osgi.shell.telnet.maxconn=1
felix.fileinstall.disableConfigSave=false
jdbc.drivers=org.apache.derby.jdbc.ClientDriver
felix.fileinstall.dir=C:\glassfish3\glassfish/modules/autostart/
javax.net.ssl.keyStore=C:\glassfish3\glassfish\domains\domain1/config/keystore.jks
osgi.shell.telnet.port=6666
java.security.policy=C:\glassfish3\glassfish\domains\domain1/config/server.policy
java.awt.headless=true
felix.fileinstall.log.level=2
felix.fileinstall.poll=5000
com.sun.aas.instanceRoot=C:\glassfish3\glassfish\domains\domain1
osgi.shell.telnet.ip=127.0.0.1
com.sun.enterprise.config.config_environment_factory_class=com.sun.enterprise.config.serverbeans.AppserverConfigEnvironmentFactory
com.sun.aas.installRoot=C:\glassfish3\glassfish
felix.fileinstall.bundles.startTransient=true
felix.fileinstall.bundles.new.start=true
javax.net.ssl.trustStore=C:\glassfish3\glassfish\domains\domain1/config/cacerts.jks
com.sun.enterprise.security.httpsOutboundKeyAlias=s1as
java.security.auth.login.config=C:\glassfish3\glassfish\domains\domain1/config/login.conf
ANTLR_USE_DIRECT_CLASS_LOADING=true
gosh.args=--nointeractive
sun.java.command=com.sun.enterprise.glassfish.bootstrap.ASMain -domainname domain1 -asadmin-args --host,,,localhost,,,--port,,,4848,,,--secure=false,,,--terse=false,,,--echo=false,,,--interactive=true,,,start-domain,,,--verbose=false,,,--debug=false,,,--domaindir,,,C:\glassfish3\glassfish\domains,,,domain1 -instancename server -verbose false -debug false -asadmin-classpath C:/glassfish3/glassfish/modules/admin-cli.jar -asadmin-classname com.sun.enterprise.admin.cli.AsadminMain -upgrade false -type DAS -domaindir C:/glassfish3/glassfish/domains/domain1 -read-stdin true
sun.java.launcher=SUN_STANDARD
</properties>
</vm_arguments>
<tty>
<writer thread='2068'/>
<dependency_failed type='leaf_type' ctxk='java/io/BufferedReader' witness='java/io/LineNumberReader' stamp='0.997'/>
<dependency_failed type='leaf_type' ctxk='java/util/jar/JarFile' witness='sun/net/www/protocol/jar/URLJarFile' stamp='1.229'/>
<writer thread='4180'/>
<dependency_failed type='unique_concrete_method' ctxk='java/util/Properties' x='java/util/Hashtable put (Ljava/lang/Object;Ljava/lang/Object;)Ljava/lang/Object;' witness='java/security/Provider' stamp='1.733'/>
<writer thread='3972'/>
<dependency_failed type='leaf_type' ctxk='org/apache/felix/framework/wiring/BundleRequirementImpl' witness='org/apache/felix/framework/resolver/HostedRequirement' stamp='16.176'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<dependency_failed type='leaf_type' ctxk='java/io/ObjectInputStream' witness='com/sun/hk2/component/AbstractInhabitantImpl$1' stamp='17.178'/>
<writer thread='2068'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='org/jvnet/hk2/component/MultiMap' witness='org/glassfish/api/admin/ParameterMap' stamp='20.496'/>
<dependency_failed type='leaf_type' ctxk='java/util/WeakHashMap' witness='com/sun/jmx/mbeanserver/MBeanIntrospector$PerInterfaceMap' stamp='21.229'/>
<dependency_failed type='leaf_type' ctxk='java/util/WeakHashMap' witness='com/sun/jmx/mbeanserver/MBeanIntrospector$PerInterfaceMap' stamp='21.230'/>
<dependency_failed type='unique_concrete_method' ctxk='java/io/IOException' x='java/lang/Throwable getMessage ()Ljava/lang/String;' witness='java/rmi/RemoteException' stamp='21.605'/>
<dependency_failed type='leaf_type' ctxk='java/io/ByteArrayOutputStream' witness='com/sun/common/util/logging/LoggingOutputStream' stamp='22.522'/>
<dependency_failed type='leaf_type' ctxk='java/io/ByteArrayOutputStream' witness='com/sun/common/util/logging/LoggingOutputStream' stamp='22.523'/>
<dependency_failed type='leaf_type' ctxk='java/io/ByteArrayOutputStream' witness='com/sun/common/util/logging/LoggingOutputStream' stamp='22.523'/>
<dependency_failed type='leaf_type' ctxk='java/io/ByteArrayOutputStream' witness='com/sun/common/util/logging/LoggingOutputStream' stamp='22.523'/>
<dependency_failed type='leaf_type' ctxk='java/io/ByteArrayOutputStream' witness='com/sun/common/util/logging/LoggingOutputStream' stamp='22.523'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.477'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.478'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.478'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.478'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList' witness='com/sun/enterprise/config/serverbeans/Applications$Duck$1' stamp='25.478'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList$Itr' witness='java/util/ArrayList$ListItr' stamp='26.987'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList$Itr' witness='java/util/ArrayList$ListItr' stamp='26.987'/>
<dependency_failed type='leaf_type' ctxk='java/util/ArrayList$Itr' witness='java/util/ArrayList$ListItr' stamp='26.987'/>
<dependency_failed type='unique_concrete_method' x='java/lang/SecurityManager checkPropertyAccess (Ljava/lang/String;)V' witness='com/sun/enterprise/security/J2EESecurityManager' stamp='27.822'/>
<dependency_failed type='unique_concrete_method' x='java/lang/SecurityManager checkPackageAccess (Ljava/lang/String;)V' witness='com/sun/enterprise/security/J2EESecurityManager' stamp='27.822'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='unique_concrete_method' x='java/lang/ThreadLocal get ()Ljava/lang/Object;' witness='org/glassfish/web/admin/monitor/HttpServiceStatsProvider$1' stamp='30.803'/>
<dependency_failed type='leaf_type' ctxk='java/util/logging/Level' witness='com/sun/enterprise/util/logging/IASLevel' stamp='30.959'/>
<dependency_failed type='unique_concrete_method' x='java/util/ArrayList add (Ljava/lang/Object;)Z' witness='javax/management/AttributeList' stamp='33.034'/>
<dependency_failed type='unique_concrete_method' x='java/util/ArrayList add (Ljava/lang/Object;)Z' witness='javax/management/AttributeList' stamp='33.035'/>
<dependency_failed type='unique_concrete_method' ctxk='org/w3c/dom/Node' x='com/sun/org/apache/xerces/internal/dom/NodeImpl appendChild (Lorg/w3c/dom/Node;)Lorg/w3c/dom/Node;' witness='org/w3c/dom/Node' stamp='34.497'/>
<dependency_failed type='leaf_type' ctxk='com/sun/org/apache/xerces/internal/util/NamespaceSupport' witness='com/sun/org/apache/xerces/internal/impl/xs/SchemaNamespaceSupport' stamp='34.567'/>
<dependency_failed type='unique_concrete_method' ctxk='org/w3c/dom/NamedNodeMap' x='com/sun/org/apache/xerces/internal/dom/NamedNodeMapImpl getLength ()I' witness='org/w3c/dom/NamedNodeMap' stamp='34.568'/>
<dependency_failed type='leaf_type' ctxk='com/sun/org/apache/xerces/internal/xni/QName' witness='com/sun/org/apache/xerces/internal/impl/dv/xs/QNameDV$XQName' stamp='34.836'/>
<dependency_failed type='leaf_type' ctxk='com/sun/org/apache/xerces/internal/xni/QName' witness='com/sun/org/apache/xerces/internal/impl/dv/xs/QNameDV$XQName' stamp='34.836'/>
<dependency_failed type='leaf_type' ctxk='com/sun/org/apache/xerces/internal/xni/QName' witness='com/sun/org/apache/xerces/internal/impl/dv/xs/QNameDV$XQName' stamp='34.836'/>
<dependency_failed type='leaf_typ 
```

如果有帮助，这是我的部署描述符，web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         version="3.0">

    <servlet>
        <servlet-name>cometd</servlet-name>
        <servlet-class>org.cometd.server.CometdServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
        <async-supported>true</async-supported>
        <init-param>
            <param-name>timeout</param-name>
            <param-value>60000</param-value>
        </init-param>
        <init-param>
            <param-name>logLevel</param-name>
            <param-value>3</param-value>
        </init-param>
    </servlet>
    <servlet-mapping>
        <servlet-name>cometd</servlet-name>
        <url-pattern>/cometd/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>configuration</servlet-name>
        <servlet-class>CometDServletInitializer</servlet-class>
        <async-supported>true</async-supported>
    </servlet>

</web-app> 
```

很抱歉寻求帮助来调试我的代码，但我已经尝试了好几天，但 ExceptionInInitializerError 仍然让我感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T12:56:02.333

jetty-client api 在 jetty-8 和 jetty-9 之间发生了巨大变化，因此如果您将 cometd-2 与 jetty-9 客户端 api 一起使用，那么这可能是您的问题。Cometd-3 将支持新的 jetty-9 jetty-client api。我怀疑您应该能够在您的 web 应用程序中使用 jetty-8 jetty-client 依赖项，并根据需要部署到 jetty-9 作为容器。您只需要注意不要将 jetty-client 类暴露给 webapp 类加载器，因为 webapp 中已经有 jetty-8 类。我会注意到这是 webapp 类加载器隔离的目的之一，所以你可以在你的 webapp 和你的 servlet 容器中拥有不同版本的东西。在这种情况下，jetty-client 就像拥有两个不同版本的 slf4j，你不希望你的容器强迫你使用一个特定的版本哦一个依赖。我想，cometd 项目很快就会推出 3.0 版的 RC，或者如果你想在 Cometd 的前沿工作，你可以使用它的 SNAPSHOT。我可能会建议只使用 jetty-8 jetty-client 和 cometd 2.5（或至少它的最新版本）。

# search - score_mode：弹性搜索中的总计

> ID：15694439
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:20:35.873
> 
> 标签：search, elasticsearch

我在使用`custom_filters_score`. 个人分数`0.81491333`，加起来等于……< `0.125`/ p> `0.08695652``0.1727262`

**编辑**：我再次查看它，看起来 custom_filters_score 的总数正乘以“正常”查询。

有没有办法将普通查询 ( `custom_score`) 合并到`custom_filter_score`或者强制弹性搜索将两者相加（而不是相乘）？

数据、查询和映射的要点位于[https://gist.github.com/sqwk/3d7b25192a236fba82b4](https://gist.github.com/sqwk/3d7b25192a236fba82b4)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:49:39.200

好的 - 我终于弄清楚发生了什么。首先，在您的要点中，您的查询与您的任何文档都不匹配，因为纬度/经度。我随机选择了一份文档（323）并使用了那里的纬度/经度值。

这是我得到的解释：

```
 - custom score, score mode [total]                                    |    0.8795
   - Score based on score mode Max and child doc range from 10 to 16   |    1.0000
     - Child[16]                                                       |    1.0000
   - custom score, product of:                                         |    0.2000
     - match filter: cache(object_max_rooms:[4 TO *])                  |    1.0000
     - scriptFactor                                                    |    0.2000
     - queryBoost                                                      |    1.0000
   - custom score, product of:                                         |    0.5714
     - match filter: cache(object_min_living_area:[* TO 125])          |    1.0000
     - scriptFactor                                                    |    0.5714
     - queryBoost                                                      |    1.0000
   - custom score, product of:                                         |    0.1081
     - match filter: cache(object_max_living_area:[125 TO *])          |    1.0000
     - scriptFactor                                                    |    0.1081
     - queryBoost                                                      |    1.0000 
```

如您所见，纬度/经度完全匹配，因此得分为 1，并且`custom_filters_score`查询的得分得到了很好的总计。

然后我将`lat`值从 50.0852386 更改为 50.0882386，然后重新运行。现在分数看起来像这样：

```
 - custom score, score mode [total]                                    |    0.7081
   - Score based on score mode Max and child doc range from 10 to 16   |    0.8050
     - Child[16]                                                       |    0.8050
   - custom score, product of:                                         |    0.2000
     - match filter: cache(object_max_rooms:[4 TO *])                  |    1.0000
     - scriptFactor                                                    |    0.2000
     - queryBoost                                                      |    1.0000
   - custom score, product of:                                         |    0.5714
     - match filter: cache(object_min_living_area:[* TO 125])          |    1.0000
     - scriptFactor                                                    |    0.5714
     - queryBoost                                                      |    1.0000
   - custom score, product of:                                         |    0.1081
     - match filter: cache(object_max_living_area:[125 TO *])          |    1.0000
     - scriptFactor                                                    |    0.1081
     - queryBoost                                                      |    1.0000 
```

因此，过滤器的分数与查询的分数相结合，然后进行归一化。这是可以预料的。仅适用于过滤器，不适用于过滤器和查询的`score_mode`组合。

如果要精确组合它们，则需要将距离计算从查询移到过滤器下的`custom_filters_score`过滤器中。问题在于`script`for 评分将无法访问嵌套`places`文档，因此您将无法做到这一点。

为什么确切的总数如此重要？永远不应将其`_score`视为绝对值。它只是反映了每个文档的相对重要性。您只需要调整每个条款的影响，直到您获得满足您要求的“正确”顺序。

# c++ - 在 Windows 中使用 ReadFile() 函数读取二进制数据

> ID：15694445
> 
> 赞同：0
> 
> 时间：2013-03-29T00:21:12.257
> 
> 标签：c++, binary-data, readfile

我有两个程序：程序 A（在 FORTRAN 中）和程序 B（在 C++ 中）。它们通过管道相互连接。程序 B 应该直接从程序 A 的控制台读取二进制数据，但由于某种原因我不能这样做：

以下是程序B的阅读部分：

```
BOOL bSuccess = FALSE;
LPBYTE File_Data;
DWORD dwFileSize;
wFileSize = GetFileSize(V_hChildStd_OUT_Rd, NULL);
File_Data = new BYTE[dwFileSize+1];
bSuccess = ReadFile( V_hChildStd_OUT_Rd, File_Data, dwFileSize, &dwRead, NULL);
delete [] File_Data; 
```

注意：V_hChildStd_OUT_Rd 是程序 A 输出的句柄。

如果我传递一位、两位或三位整数（比如 1 或 10 或 100），则程序可以工作，我可以在 File_Data 数组中获得数字。但对于较大的整数和所有双数，File_Data 给出的意义较小。请注意，对于所有数字，我的 bSuccess 都是 TRUE！这意味着它可以读取文件。你能帮我解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:27:48.847

您不能`GetFileSize()`与管道一起使用，只能与文件一起使用。要确定有多少数据可用于从管道读取，请[`PeekNamedPipe()`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365779.aspx)改用。并注意`dwRead`输出值，它告诉您实际读取了多少字节，这可能小于您请求的字节数。

# forms - 使用随机变量确定 Google 表单中的路径

> ID：15694447
> 
> 赞同：2
> 
> 时间：2013-03-29T00:21:32.333
> 
> 标签：forms

我发现 Google 表单对快速调查很有用。但是，我不知道如何创建随机变量来控制调查流程。我知道我可以继续创建自定义应用程序，但我希望通过 Google 表单有一种更简单的方法。例如，我想测试问题版本 A 的 1/2 人和问题版本 B 的 1/2 人。所以我想调用一个随机变量，然后转到页面 A 流或页面 B 流。有谁知道如何使用 Google 表单执行此操作？

# jquery - 时间间隔 ExitSplash 弹出窗口

> ID：15694448
> 
> 赞同：0
> 
> 时间：2013-03-29T00:21:42.930
> 
> 标签：jquery, timer

我喜欢在前 5 分钟显示一个 javascript ExitSplash 弹出窗口“A”，并在 5 分钟后显示 ExitSplash 弹出窗口“B”。不确定如何为 B 使用“setTimeout()”。

```
<script language="javascript">
var exitsplashalertmessage = '*****';
var exitsplashmessage = '******';
var exitsplashpage = 'http://www.domain.com/';
</script>
<script language="javascript" src="http://www.domain.com/exitsplash.php"></script> 
```

谢谢你的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T04:21:19.637

为 setTimeout()设置**延迟：**

```
var timeoutDur = 300000;
setTimeout(function(){
  ...
}, timeoutDur); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T05:22:05.440

您可以尝试这样做，以便在弹出窗口**`B`**处于活动状态五分钟后弹出窗口变为活动**`A`**状态。

```
var duration = 5*60*1000;
setTimeout( function() {

   //POPUP A STUFF HERE

   setTimeout( function(){

       //POPUP B STUFF HERE

   }, duration);

}, duration); 
```

# ruby - BigDecimal 上的 rspec 错误是否有任何覆盖？

> ID：15694449
> 
> 赞同：3
> 
> 时间：2013-03-29T00:21:44.663
> 
> 标签：ruby, rspec, rspec2, bigdecimal

Big Decimal`to_s`打印为科学记数法。

rspec 使用`to_`s 表示错误消息。

如何对 rspec 进行猴子修补，以便使用更传统的格式为 BigDecimal 打印错误？

这与这个问题有关：[Override BigDecimal to_s default in Ruby](https://stackoverflow.com/questions/2335034/override-bigdecimal-to-s-default-in-ruby)

但我不想全局覆盖`BigDecimal.to_s`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-15T18:51:02.650

这行得通。在 rspec/support/big_decimal_inspect.rb 中创建文件

```
# Monkey patch BigDecimal#inspect
# Otherwises test errors print like:
# expected: #<BigDecimal:108482700,'0.11E3',9(27)>
#     got: #<BigDecimal:108468080,'0.12E3',9(27)>
# After get:
# expected: 110.0
#      got: 120.0
class BigDecimal
  def inspect
    to_s
  end
end 
```

# javascript - Javascript OOP / 类

> ID：15694454
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:22:01.670
> 
> 标签：javascript

我确定这个问题之前已经被问过，但我似乎无法找到正确和/或最佳的格式。基本上，我正在尝试开发一些自定义 Javascript 类以在我的站点中使用。我希望能够按如下方式调用它们：

```
MasterClass.SubClass.function(params); 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:24:11.647

最简单的方法是使用对象字面量形成这个结构：

```
MasterClass = {
    SubClass: {
        fn: function(params) {
        }
    }
} 
```

当您想将其分布在多个源文件中时，您可以这样做：

```
MasterClass = {} 
```

然后，在每个附加的源文件中：

```
(function(ns) {
    ns.SubClass = {
        fn: function(param) { }
    }
}(MasterClass)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:24:46.610

根据您的单行伪代码，这符合要求：

```
var MasterClass = {
    SubClass: {
        myFunction: function(params) {
            // snip
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:51:31.763

只是为了做不同的事情，您也可以使用原型，而不必每次都输入 MasterClass

```
 function MasterClass () {
     this.prop = "test"
 }

 function SubClass () {
    this.func = function () {
    return this.prop
   }
}

 SubClass.prototype = new MasterClass()

 var subclass = new SubClass()
 subclass.func() //return "test" 
```

# javascript - 引导弹出箭头位置

> ID：15694455
> 
> 赞同：2
> 
> 时间：2013-03-29T00:22:10.180
> 
> 标签：javascript, twitter-bootstrap

当弹出框内容拉伸其大小时，引导弹出框箭头有时会丢失其位置（弹出框连接到的 div 的中心）。我发现它正在使用 tooltip.js 脚本中的 replaceArrow 方法修复。问题是箭头选择器没有捕捉到只有 .arrow 类（不是 .tooltip-arrow）的箭头

尽管我可以使用弹出框的自定义标记来修复该行为，但我想问一下这是引导程序中的错误还是我忽略了某些东西？

我想避免弹出框的自定义标记和自定义引导脚本，因为将来很难维护。

```
arrow: function(){
   return this.$arrow = this.$arrow || this.tip().find(".tooltip-arrow")
   } 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-06-13T23:44:11.220

你可以试试这个。我有类似的情况，我从工具提示中删除了箭头。

```
$(document).ready(function () {
    $(".yourCssClassHere").tooltip().on("mouseenter", function () {
        var $this = $(this),
        tooltip = $this.next(".tooltip");

        tooltip.find(".tooltip-arrow").css({
            display: "none"
        });
    });
}); 
```

# html - CSS：跨度和 li 的高度不匹配

> ID：15694457
> 
> 赞同：0
> 
> 时间：2013-03-29T00:22:27.803
> 
> 标签：html, css, styles, padding

[http://goldencraft.co/stackoverflow-test/](http://goldencraft.co/stackoverflow-test/)

HTML：

```
<ul class="list">
<li><a href="#">item 1</a></li>
<li>item 2
<ul class="list">
<li>item 2 -> sub item 1 <a href="#" class="button orange"><span>Stack Overflow</span></a></li>
<li>item 2 -> sub item 2
<ul class="list">
<li>sub item 2 -> sub-sub item 1</li>
<li>sub item 2 -> sub-sub item 2</li>
</ul></li>
<li>item 2 -> sub item 3
</ul></li>
<li>item 3</li>
</ul> 
```

CSS：

```
ul.list li {
    padding-left: 12px;
    line-height: 2em;
    background: url('../images/list_arrow.png') no-repeat 0px 8px;
}
ol ol,
ol ul,
ul ol,
ul ul {
    padding-left: 40px;
} 
```

我无法弄清楚以下内容：

1.  使`line-height`和/或`padding`与按钮 css 样式匹配（[单击此处查看](http://goldencraft.co/wp-content/themes/minecraft/assets/styles/button.css "按钮.css")[查看`.button span`]）
2.  将 (background-image) 箭头与文本行对齐（如果 1 得到固定，这很容易用 simple 完成`background-position`）

我希望这里有人有解决方案，因为我很想完成这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:58:59.363

如果我正确理解了这个问题，您可能正在寻找类似以下内容：

```
a.button, a.button:hover
{
    text-decoration: none;

    margin-top:-0.1em;
    height:1.4em;
    top:0.5em;
}

button span
{
    position: relative;
    color: #fff;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.25);
    /*border-top: rgba(255, 255, 255, .2) 1px solid;*/
    line-height: 1em;
    text-decoration: none;
    text-align: center;
    white-space: nowrap;
    margin: 0px !important;

    padding: 0 0.75em;
    top:-0.3em;
} 
```

# json - Playframework Scala Specs2 JSON 匹配器

> ID：15694461
> 
> 赞同：4
> 
> 时间：2013-03-29T00:23:37.887
> 
> 标签：json, scala, playframework-2.0, specs2

我正在使用游戏！框架并尝试在 Specs2 测试中使用 JSON 响应消息但没有成功。

我想要做的是在 JsValue 中断言键-> 值对，如下例所示......但我无法让匹配器正确通过。

```
import org.specs2.mutable._
import play.api.libs.json.{Json, JsValue}

class JsonSpec extends Specification {

  "Json Matcher" should {

    "Correctly match Name->Value pairs" in {
      val resultJson:JsValue = Json.parse("""{"name":"Yardies"}""")
      resultJson must  /("name" -> "Yardies")
    }

    "Correctly match Name->Value pairs with numbers as doubles" in {
      val resultJson:JsValue = Json.parse("""{"id":1}""")
      resultJson must  /("id" -> 1.0)
    }
  }
} 
```

我得到的错误是

```
{name : Yardies} doesn't contain '(name,Yardies)' 
```

和

```
{id : 1.0} doesn't contain '(id,1.0)' 
```

不是很有帮助，我想这是我缺少的一些简单的东西（Scala和Play都是新的）

史蒂夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T00:48:26.050

在`JsonMatchers`specs2 中应该稍微收紧一点。它们是`Matcher[Any]`，`Any`应该有一个`toString`可以被 Scala 的 json 解析器（而不是 Play 的解析器）解析的方法。

以下规范按预期工作：

```
class JsonSpec extends Specification {

  "Json Matcher" should {

    "Correctly match Name->Value pairs" in {
      val resultJson = """{"name":"Yardies"}"""
      resultJson must  /("name" -> "Yardies")
    }

    "Correctly match Name->Value pairs with numbers as doubles" in {
      val resultJson = """{"id":1}"""
      resultJson must  /("id" -> 1.0)
    }
  }
} 
```

在您的情况下，我怀疑解析`toString`Play 的 Json 值的表示会返回与匹配器所期望的略有不同的东西。这将在下一个 specs2 版本中修复。

# javascript - Javascript 等待（）函数

> ID：15694470
> 
> 赞同：29
> 
> 时间：2013-03-29T00:24:44.547
> 
> 标签：javascript, function, wait

我想创建一个 JavaScript`wait()`函数。

我应该编辑什么？

```
function wait(waitsecs) {
    setTimeout(donothing(), 'waitsecs');
}

function donothing() {
    //
} 
```

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-03-29T00:31:53.027

Javascript 没有线程化，因此“等待”会冻结整个页面（并可能导致浏览器完全停止运行脚本）。

`donothing`要专门解决您的问题，您应该在`setTimeout`通话后删除括号，并制作`waitsecs`一个数字而不是字符串：

```
console.log('before');
setTimeout(donothing,500); // run donothing after 0.5 seconds
console.log('after'); 
```

但这不会停止执行；“之后”将在您的函数运行之前记录。

要正确等待，您可以使用匿名函数：

```
console.log('before');
setTimeout(function(){
    console.log('after');
},500); 
```

您的所有变量仍将在“之后”部分中。你不应该把这些链接起来——如果你发现自己需要，你需要看看你是如何构建程序的。如果需要循环，您也可能想使用`setInterval`/ 。`clearInterval`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-29T00:26:19.983

你不应该编辑它，你应该完全废弃它。

任何使执行停止一段时间的尝试都会锁定浏览器并将其切换到无响应状态。你唯一能做的就是`setTimeout`正确使用。

# php - 为服务器正确使用 Amazon Web Services S3 - 端脚本

> ID：15694474
> 
> 赞同：1
> 
> 时间：2013-03-29T00:25:06.893
> 
> 标签：php, amazon-web-services

我知道在亚马逊的文档中它说 S3 并不是真正为服务器端脚本而设计的，而是使用 EC2 代替。我不需要也不会使用 EC2 提供的操作系统来处理我的服务器调用，它看起来很贵而且似乎有点过头了。基本上，我有几个 php 文件来处理将数据写入 RDS 数据库并将视频上传到 S3。将我的 php 文件放在 S3 中并允许静态 Web 托管以便我的 iphone api 可以调用 php 脚本对我来说是错误的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:30:44.483

*静态网络托管*意味着...没有服务器端脚本执行。

您不能在 S3 上运行 PHP 脚本。

> 您可以在 Amazon S3 上托管**静态网站。**在静态网站上，单个网页包含静态内容。它们还可能包含客户端脚本。**相比之下**，动态网站依赖于服务器端处理，包括服务器端脚本，例如 PHP、JSP 或 ASP.NET。Amazon S3 不支持服务器端脚本。

[http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html](http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html)

查看 EC2[免费套餐](http://aws.amazon.com/ec2/pricing/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:30:08.247

S3 无法实际执行您的 PHP 文件。只是文件存储恰好也能够提供文件以响应基本的 HTTP 请求。但它只能以这种方式提供静态内容。

但是，没有任何内容表明您需要将 EC2 用于您的 Web 应用程序。您可以使用任何您想要的东西，尽管您可能会看到 S3 周围的带宽成本损失，您可以避免使用 EC2。

# php - PHP & ImageMagick - 将图像代码转换成图像？

> ID：15694475
> 
> 赞同：1
> 
> 时间：2013-03-29T00:25:11.987
> 
> 标签：php, image, imagemagick

我希望能够生成图像缩略图而不将它们保存到服务器。到目前为止，我已经想出了这段代码，但我不确定如何处理`$code`.

`$code = system("convert galleries/13_0.jpg -resize 400x270 /dev/stdout");`

我将如何插入`$code`PHP/HTML 以将原始图像代码显示为 jpg？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:38:39.583

我建议您不要像您所描述的那样从系统中执行此操作。

PHP 有做这类事情的库。

[http://www.php.net/manual/en/ref.image.php](http://www.php.net/manual/en/ref.image.php)。 [http://php.net/manual/en/book.imagick.php](http://php.net/manual/en/book.imagick.php)。

还有一些库包装了这些用于操作图像的本机函数。[https://imagine.readthedocs.org/en/latest/](https://imagine.readthedocs.org/en/latest/)

这样，您的所有代码都在 PHP 中，并且您不依赖系统执行任何操作（前提是 PHP 已使用所描述的库编译。它们是大多数 PHP 构建中可用的标准库，如果不包含它们，您可以启用它们）。

编辑：我提倡你。

*   打开源图像。
*   转换源图像
*   返回源图像

想象一下，您会这样做：

```
$imagine = new Imagine\Gd\Imagine();
$size    = new Imagine\Image\Box(400, 270);

$imagine->open('/path/to/large_image.jpg')
->resize($size)
->show('jpg'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:37:50.470

如果 $code 是原始数据，您是否可以有另一个文件 getimage.php 将数据写出但将标题内容类型设置为 image/JPEG？所以你的 img src 会是 getimage.php?image=13_0.jpg 例如？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T05:27:59.203

我会把它保存到内存中，然后读取它，然后删除它。`/dev/shm`是大多数 Linux 系统上的 ramdrive。

```
$tmp = '/dev/shm/'.uniqid('',true).'.jpg';
system("convert galleries/13_0.jpg -resize 400x270 $tmp");
header("Content-Type: image/jpeg");
header('Content-Length: '.filesize($tmp));
readfile($tmp);
unlink($tmp); 
```

# ios - 没有属性dict对象的IOS XML解析键？

> ID：15694480
> 
> 赞同：1
> 
> 时间：2013-03-29T00:25:37.783
> 
> 标签：ios, xml

我有一个看起来像这样的 XML 文件

```
<data>

<value>33</value>

</data> 
```

我试图解析它，但我不确定如何解析，因为到目前为止我在网上看到的每一个教程都告诉你如何使用如下所示的 XML 元素来完成它：

```
<value id="somestupididhere"></value> 
```

我想在没有“id =”位的情况下做到这一点。如何在不添加 id 的情况下分配标签的值？

# c# - 将参数从一种形式传递到另一种形式

> ID：15694485
> 
> 赞同：1
> 
> 时间：2013-03-29T00:26:10.140
> 
> 标签：c#, winforms

我有一个主窗体和一个子窗体。子表单由主表单中的 4 个不同的表单事件激活，并根据触发它的事件重新设计。但不是使用全局布尔值来确定触发了哪个事件，有没有办法将参数直接传递给子表单？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:41:16.837

您可以将公共成员添加到子表单。方法或属性。例如

```
public void ProcessEvent(int eventNumber)
{
    switch (eventNumber) {
        case 1:
            // Process event #1
            break;
        case 2:
            // Process event #2
            break;
        case 3:
            // Process event #3
            break;
        case 4:
            // Process event #4
            break;
    }
} 
```

在主窗体中，您可以这样称呼它：

```
mySubform.ProcessEvent(1); 
```

*（注意：在 WinForms 中，您不会使用子表单，而是使用`UserControl`.）*

* * *

或者在子表单中使用属性：

```
public int EventNumber { get; set; } 
```

在主窗体中，您可以这样设置：

```
mySubform.EventNumber = 1; 
```

在子表单中，您可以像这样简单地访问它

```
if (EventNumber == 1) { ... } 
```

* * *

注意：表单、子表单和控件只是类，你可以用它们做所有你可以用“普通”类做的事情。

* * *

**更新**

根据您的评论之一，您使用的不是子表单而是对话框表单。*我会将放置在（不在上面）另一个表单上的表单（UserControl 或 MDI 表单）称为子表单。*你可以这样称呼它：

```
var fldg = new MyDialogForm{ EventNumber = 1 };  // Using the property described above.
fdlg.ShowDialog(this); 
```

另一种选择是将参数传递给子表单的构造函数

```
private int _eventNumber;

public MyDialogForm(int eventNumber) // Constructor
{
    _eventNumber = eventNumber;
} 
```

你会这样称呼它：

```
var fldg = new MyDialogForm(1);  // Pass the argument to the constructor.
fdlg.ShowDialog(this); 
```

# c - C - 矩阵作为值传递？

> ID：15694495
> 
> 赞同：2
> 
> 时间：2013-03-29T00:27:13.247
> 
> 标签：c, optimization, matrix, pass-by-value, return-by-value

我正在为 C 项目设计矩阵处理函数。我正在考虑按值或按引用传递矩阵。我创建了一个按值和按引用传递矩阵的基准测试，两者在 gcc 中使用优化标志 -O0 和 -O2 的性能似乎相同。鉴于我的基准测试可能给出不正确的结果，我想知道仅使用 C 将矩阵传入和传出函数调用的最有效方法是什么。

```
#include <stdio.h>
#include <time.h>

// Compiled on OSX 10.6.8 using: cc -o matrix matrix.c -std=c99 -O2

typedef struct {
    float m0;
    float m1;
    float m2;
    float m3;
    float m4;
    float m5;
    float m6;
    float m7;
    float m8;
    float m9;
    float m10;
    float m11;
    float m12;
    float m13;
    float m14;
    float m15;
} Matrix;

// ================================================
//                 Pass By Value
// ------------------------------------------------

Matrix PassByValue (Matrix a, Matrix b) {
    Matrix matrix;

    matrix.m0  = a.m0 * b.m0  + a.m4 * b.m1  + a.m8  * b.m2  + a.m12 * b.m3;
    matrix.m1  = a.m1 * b.m0  + a.m5 * b.m1  + a.m9  * b.m2  + a.m13 * b.m3;
    matrix.m2  = a.m2 * b.m0  + a.m6 * b.m1  + a.m10 * b.m2  + a.m14 * b.m3;
    matrix.m3  = a.m3 * b.m0  + a.m7 * b.m1  + a.m11 * b.m2  + a.m15 * b.m3;

    matrix.m4  = a.m0 * b.m4  + a.m4 * b.m5  + a.m8  * b.m6  + a.m12 * b.m7;
    matrix.m5  = a.m1 * b.m4  + a.m5 * b.m5  + a.m9  * b.m6  + a.m13 * b.m7;
    matrix.m6  = a.m2 * b.m4  + a.m6 * b.m5  + a.m10 * b.m6  + a.m14 * b.m7;
    matrix.m7  = a.m3 * b.m4  + a.m7 * b.m5  + a.m11 * b.m6  + a.m15 * b.m7;

    matrix.m8  = a.m0 * b.m8  + a.m4 * b.m9  + a.m8  * b.m10 + a.m12 * b.m11;
    matrix.m9  = a.m1 * b.m8  + a.m5 * b.m9  + a.m9  * b.m10 + a.m13 * b.m11;
    matrix.m10 = a.m2 * b.m8  + a.m6 * b.m9  + a.m10 * b.m10 + a.m14 * b.m11;
    matrix.m11 = a.m3 * b.m8  + a.m7 * b.m9  + a.m11 * b.m10 + a.m15 * b.m11;

    matrix.m12 = a.m0 * b.m12 + a.m4 * b.m13 + a.m8  * b.m14 + a.m12 * b.m15;
    matrix.m13 = a.m1 * b.m12 + a.m5 * b.m13 + a.m9  * b.m14 + a.m13 * b.m15;
    matrix.m14 = a.m2 * b.m12 + a.m6 * b.m13 + a.m10 * b.m14 + a.m14 * b.m15;
    matrix.m15 = a.m3 * b.m12 + a.m7 * b.m13 + a.m11 * b.m14 + a.m15 * b.m15;

    return matrix;
}

// ================================================
//               Pass By Reference
// ------------------------------------------------

void PassByReference (Matrix* matrix, Matrix* a, Matrix* b) {
    if (!matrix) return;
    if (!a) return;
    if (!b) return;

    matrix->m0  = a->m0 * b->m0  + a->m4 * b->m1  + a->m8  * b->m2  + a->m12 * b->m3;
    matrix->m1  = a->m1 * b->m0  + a->m5 * b->m1  + a->m9  * b->m2  + a->m13 * b->m3;
    matrix->m2  = a->m2 * b->m0  + a->m6 * b->m1  + a->m10 * b->m2  + a->m14 * b->m3;
    matrix->m3  = a->m3 * b->m0  + a->m7 * b->m1  + a->m11 * b->m2  + a->m15 * b->m3;

    matrix->m4  = a->m0 * b->m4  + a->m4 * b->m5  + a->m8  * b->m6  + a->m12 * b->m7;
    matrix->m5  = a->m1 * b->m4  + a->m5 * b->m5  + a->m9  * b->m6  + a->m13 * b->m7;
    matrix->m6  = a->m2 * b->m4  + a->m6 * b->m5  + a->m10 * b->m6  + a->m14 * b->m7;
    matrix->m7  = a->m3 * b->m4  + a->m7 * b->m5  + a->m11 * b->m6  + a->m15 * b->m7;

    matrix->m8  = a->m0 * b->m8  + a->m4 * b->m9  + a->m8  * b->m10 + a->m12 * b->m11;
    matrix->m9  = a->m1 * b->m8  + a->m5 * b->m9  + a->m9  * b->m10 + a->m13 * b->m11;
    matrix->m10 = a->m2 * b->m8  + a->m6 * b->m9  + a->m10 * b->m10 + a->m14 * b->m11;
    matrix->m11 = a->m3 * b->m8  + a->m7 * b->m9  + a->m11 * b->m10 + a->m15 * b->m11;

    matrix->m12 = a->m0 * b->m12 + a->m4 * b->m13 + a->m8  * b->m14 + a->m12 * b->m15;
    matrix->m13 = a->m1 * b->m12 + a->m5 * b->m13 + a->m9  * b->m14 + a->m13 * b->m15;
    matrix->m14 = a->m2 * b->m12 + a->m6 * b->m13 + a->m10 * b->m14 + a->m14 * b->m15;
    matrix->m15 = a->m3 * b->m12 + a->m7 * b->m13 + a->m11 * b->m14 + a->m15 * b->m15;
}

// ================================================
//                  Benchmark
// ------------------------------------------------

#define LOOPS 100000

int main () {
    Matrix result;
    Matrix a;
    Matrix b;
    clock_t begin;
    clock_t end;
    int index;

    // ------------------------------------------
    //          Pass By Reference
    // ------------------------------------------
    begin = clock();
    for (index = 0; index < LOOPS; index++) {

        PassByReference(&result,&a,&b);
        a.m0 += index;
        b.m0 += index;

    }
    end = clock();
    printf("Pass By Ref: %f\n",(double)(end - begin) / CLOCKS_PER_SEC);

    // ------------------------------------------
    //            Pass By Value
    // ------------------------------------------
    begin = clock();
    for (index = 0; index < LOOPS; index++) {

        result = PassByValue(a,b);
        a.m0 += index;
        b.m0 += index;

    }
    end = clock();
    printf("Pass By Val: %f\n",(double)(end - begin) / CLOCKS_PER_SEC);

    // The following line along with the above
    // additions in the loops hopefully prevent
    // the matrices from being optimized into
    // nothing.
    printf("%0.1f\n",result.m0);

    return 0;
} 
```

**结果：**

```
Pass By Ref: 0.489226
Pass By Val: 0.488882 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:16:20.923

来自有效的 C++：

> 更喜欢 pass-by-reference-to-const 而不是 pass-by-value，它通常更有效，并且避免了切片问题。该规则不适用于内置类型和 STL 迭代器和函数对象类型。对于他们来说，按值传递通常是合适的。

我了解您使用 C 而不是 C++ 进行编程，但我认为这条规则仍然适用。您的这两个示例执行非常接近的原因可能是该结构仅包含浮点数并且复制成本低廉，因为它是按值传递的。

但是，就像 Effective C++ 的作者所说

> 一些编译器拒绝将只包含双精度的对象放入寄存器，即使他们很乐意定期将裸双精度放在那里。当这种事情发生时，您最好通过引用传递此类对象，因为编译器肯定会将指针放入寄存器中”。Unsubscribe-lgm-thur

在您的情况下，也许机器不介意将结构放入寄存器中，但是当您在其他机器上运行程序时很难判断。由于他们的表现非常接近，我会投票支持通过引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:45:36.800

您在这里有 2 个相互竞争的利益：

1.  按值传递结构，这将被键入为数据存储类并通过 x86 调用约定推送到堆栈上，这比会卡在寄存器中的 by ref 调用慢一点。

2.  这几乎完全由一堆指针取消引用来平衡......

分开并分别剖析每个部分

如果您试图使这种代码更快，您可以在某种 SIMD 代码、AltiVec、SSE 或 OpenCL 中编写更快的实现，具体取决于

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T01:49:15.720

无论如何，32 个浮点值都不适合寄存器。编译器将被迫将数据从内存推入堆栈，堆栈只是内存的另一部分。根据数据访问的数量，复制数据而不是取消引用指针可能会更慢。

我建议对任何非标量数据使用带有 const 修饰符的传递引用。编译器的工作是针对特定平台优化您的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T03:44:04.533

从技术上讲，我们在 C 中只有“按值传递”。您应该将矩阵指针（按值）传递给函数。它将减少“复制”到函数中的数据，从而提高效率。

# jquery - 重置单击时减少的变量的正确方法是什么？

> ID：15694500
> 
> 赞同：0
> 
> 时间：2013-03-29T00:28:03.523
> 
> 标签：jquery

这可行，但我假设有一种更有效的方法可以实现同样的效果。我的意图是重置最后一张幻灯片上的功能，使其循环播放。

[http://jsfiddle.net/andrewtamala/JVgAC/3/](http://jsfiddle.net/andrewtamala/JVgAC/3/)

```
$(document).ready(function(){

    var i = $(".slide").length;

    $('.button').click(function() {  
        i--;

        $('.slide').eq(i).animate({"top" : "500"}, 200)
        .animate({"opacity" : "0", "top" : "000"}, 1)
        .animate({"opacity" : "1"});

            if (i === -1) {
                i++;
                i++;
                i++;
                i++;               
            }

    })    
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:31:14.863

您可以创建另一个变量来保存原始长度：

```
var n = $(".slide").length,
i = n; 
```

在您的功能结束时：

```
if (i <= 0) {
    i = n;
} 
```

# scrapy - Scrapy：项目和字段的默认值。最好的实现是什么？

> ID：15694501
> 
> 赞同：6
> 
> 时间：2013-03-29T00:28:19.240
> 
> 标签：scrapy

据我从文档和网络上的各种讨论中了解到，将默认值添加到 scrapy 项目中的字段的功能已被删除。

**这不起作用**

```
category = Field(default='null') 
```

所以我的问题是：用默认值初始化字段的好方法是什么？

我已经尝试按照此处的建议将其实现为项目管道，但没有任何成功。 [https://groups.google.com/forum/?fromgroups=#!topic/scrapy-users/-v1p5W41VDQ](https://groups.google.com/forum/?fromgroups=#!topic/scrapy-users/-v1p5W41VDQ)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T09:38:47.077

找出问题所在。管道正在工作（代码如下供其他人参考）。我的问题是，我将值附加到一个字段。我希望默认方法在这些列表值之一上工作......选择了一种不同的方式并且它可以工作。我现在使用自定义的 setDefault 处理器方法来实现它。

```
class DefaultItemPipeline(object):

def process_item(self, item, spider):
    item.setdefault('amz_VendorsShippingDurationFrom', 'default')
    item.setdefault('amz_VendorsShippingDurationTo', 'default')
    # ...
    return item 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-21T10:37:06.860

通常，构造函数用于初始化字段。

```
class SomeItem(scrapy.Item):

    id = scrapy.Field()
    json = scrapy.Field()
    done = scrapy.Field()

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        self['done'] = 1  # set default value 
```

这可能不是一个干净的解决方案，但它避免了不必要的管道。

# quickbooks - 使用 QBFC 添加销售税项目

> ID：15694503
> 
> 赞同：2
> 
> 时间：2013-03-29T00:28:27.700
> 
> 标签：quickbooks, intuit-partner-platform, qbfc

有没有办法使用 QBFC 添加销售税项目？

示例：销售税 A 4%

营业税 B 10%

我可以从 Quickbooks 轻松添加它，但我需要一种使用 QBFC 从外部应用程序添加的方法。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T05:12:44.397

[您可以在屏幕参考](https://member.developer.intuit.com/qbSDK-current/Common/newOSR/index.html)中找到一个很好的示例。

在屏幕顶部，从“选择消息”下拉列表中选择 ItemSalesTaxAdd。从那里单击 C# 选项卡，您将看到以下示例代码：

```
//The following sample code is generated as an illustration of
//Creating requests and parsing responses ONLY
//This code is NOT intended to show best practices or ideal code
//Use at your most careful discretion

using System;
using System.Net;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.IO;
using Interop.QBFC10;

namespace com.intuit.idn.samples
{
    public class Sample
    {
        public void DoItemSalesTaxAdd()
        {
            bool sessionBegun = false;
            bool connectionOpen = false;
            QBSessionManager sessionManager = null;

            try
            {
                //Create the session Manager object
                sessionManager = new QBSessionManager();

                //Create the message set request object to hold our request
                IMsgSetRequest requestMsgSet = sessionManager.CreateMsgSetRequest("US",1,.0);
                requestMsgSet.Attributes.OnError = ENRqOnError.roeContinue;

                BuildItemSalesTaxAddRq(requestMsgSet);

                //Connect to QuickBooks and begin a session
                sessionManager.OpenConnection("","Sample Code from OSR");
                connectionOpen = true;
                sessionManager.BeginSession("", ENOpenMode.omDontCare);
                sessionBegun = true;

                //Send the request and get the response from QuickBooks
                IMsgSetResponse responseMsgSet = sessionManager.DoRequests(requestMsgSet);

                //End the session and close the connection to QuickBooks
                sessionManager.EndSession();
                sessionBegun = false;
                sessionManager.CloseConnection();
                connectionOpen = false;

                WalkItemSalesTaxAddRs(responseMsgSet);

            }
            catch (Exception e)
            {
                MessageBox.Show(e.Message, "Error");
                if (sessionBegun)
                {
                    sessionManager.EndSession();
                }
                if (connectionOpen)
                {
                    sessionManager.CloseConnection();
                }
            }
        }

        void BuildItemSalesTaxAddRq(IMsgSetRequest requestMsgSet)
        {
            IItemSalesTaxAdd ItemSalesTaxAddRq= requestMsgSet.AppendItemSalesTaxAddRq();
            //Set field value for Name
            ItemSalesTaxAddRq.Name.SetValue("ab");
            //Set field value for BarCodeValue
            ItemSalesTaxAddRq.BarCode.BarCodeValue.SetValue("ab");
            //Set field value for AssignEvenIfUsed
            ItemSalesTaxAddRq.BarCode.AssignEvenIfUsed.SetValue(true);
            //Set field value for AllowOverride
            ItemSalesTaxAddRq.BarCode.AllowOverride.SetValue(true);
            //Set field value for IsActive
            ItemSalesTaxAddRq.IsActive.SetValue(true);
            //Set field value for ListID
            ItemSalesTaxAddRq.ClassRef.ListID.SetValue("200000-1011023419");
            //Set field value for FullName
            ItemSalesTaxAddRq.ClassRef.FullName.SetValue("ab");
            //Set field value for ItemDesc
            ItemSalesTaxAddRq.ItemDesc.SetValue("ab");
            //Set field value for TaxRate
            ItemSalesTaxAddRq.TaxRate.SetValue(20.00);
            //Set field value for ListID
            ItemSalesTaxAddRq.TaxVendorRef.ListID.SetValue("200000-1011023419");
            //Set field value for FullName
            ItemSalesTaxAddRq.TaxVendorRef.FullName.SetValue("ab");
            //Set field value for ExternalGUID
            ItemSalesTaxAddRq.ExternalGUID.SetValue(Guid.NewGuid().ToString());
            //Set field value for IncludeRetElementList
            //May create more than one of these if needed
            ItemSalesTaxAddRq.IncludeRetElementList.Add("ab");
        }

        void WalkItemSalesTaxAddRs(IMsgSetResponse responseMsgSet)
        {
            if (responseMsgSet == null) return;

            IResponseList responseList = responseMsgSet.ResponseList;
            if (responseList == null) return;

            //if we sent only one request, there is only one response, we'll walk the list for this sample
            for (int i=0; i<responseList.Count; i++)
            {
                IResponse response = responseList.GetAt(i);
                //check the status code of the response, 0=ok, >0 is warning
                if (response.StatusCode >= 0)
                {
                    //the request-specific response is in the details, make sure we have some
                    if (response.Detail != null)
                    {
                        //make sure the response is the type we're expecting
                        ENResponseType responseType = (ENResponseType)response.Type.GetValue();
                        if (responseType == ENResponseType.rtItemSalesTaxAddRs)
                        {
                            //upcast to more specific type here, this is safe because we checked with response.Type check above
                            IItemSalesTaxRet ItemSalesTaxRet = (IItemSalesTaxRet)response.Detail;
                            WalkItemSalesTaxRet(ItemSalesTaxRet);
                        }
                    }
                }
            }
        }

        void WalkItemSalesTaxRet(IItemSalesTaxRet ItemSalesTaxRet)
        {
            if (ItemSalesTaxRet == null) return;

            //Go through all the elements of IItemSalesTaxRet
            //Get value of ListID
            string ListID1 = (string)ItemSalesTaxRet.ListID.GetValue();
            //Get value of TimeCreated
            DateTime TimeCreated2 = (DateTime)ItemSalesTaxRet.TimeCreated.GetValue();
            //Get value of TimeModified
            DateTime TimeModified3 = (DateTime)ItemSalesTaxRet.TimeModified.GetValue();
            //Get value of EditSequence
            string EditSequence4 = (string)ItemSalesTaxRet.EditSequence.GetValue();
            //Get value of Name
            string Name5 = (string)ItemSalesTaxRet.Name.GetValue();
            //Get value of BarCodeValue
            if (ItemSalesTaxRet.BarCodeValue != null)
            {
                string BarCodeValue6 = (string)ItemSalesTaxRet.BarCodeValue.GetValue();
            }
            //Get value of IsActive
            if (ItemSalesTaxRet.IsActive != null)
            {
                bool IsActive7 = (bool)ItemSalesTaxRet.IsActive.GetValue();
            }
            if (ItemSalesTaxRet.ClassRef != null)
            {
                //Get value of ListID
                if (ItemSalesTaxRet.ClassRef.ListID != null)
                {
                    string ListID8 = (string)ItemSalesTaxRet.ClassRef.ListID.GetValue();
                }
                //Get value of FullName
                if (ItemSalesTaxRet.ClassRef.FullName != null)
                {
                    string FullName9 = (string)ItemSalesTaxRet.ClassRef.FullName.GetValue();
                }
            }
            //Get value of ItemDesc
            if (ItemSalesTaxRet.ItemDesc != null)
            {
                string ItemDesc10 = (string)ItemSalesTaxRet.ItemDesc.GetValue();
            }
            //Get value of TaxRate
            if (ItemSalesTaxRet.TaxRate != null)
            {
                double TaxRate11 = (double)ItemSalesTaxRet.TaxRate.GetValue();
            }
            if (ItemSalesTaxRet.TaxVendorRef != null)
            {
                //Get value of ListID
                if (ItemSalesTaxRet.TaxVendorRef.ListID != null)
                {
                    string ListID12 = (string)ItemSalesTaxRet.TaxVendorRef.ListID.GetValue();
                }
                //Get value of FullName
                if (ItemSalesTaxRet.TaxVendorRef.FullName != null)
                {
                    string FullName13 = (string)ItemSalesTaxRet.TaxVendorRef.FullName.GetValue();
                }
            }
            //Get value of ExternalGUID
            if (ItemSalesTaxRet.ExternalGUID != null)
            {
                string ExternalGUID14 = (string)ItemSalesTaxRet.ExternalGUID.GetValue();
            }
            if (ItemSalesTaxRet.DataExtRetList != null)
            {
                for (int i15 = 0; i15 < ItemSalesTaxRet.DataExtRetList.Count; i15++)
                {
                    IDataExtRet DataExtRet = ItemSalesTaxRet.DataExtRetList.GetAt(i15);
                    //Get value of OwnerID
                    if (DataExtRet.OwnerID != null)
                    {
                        string OwnerID16 = (string)DataExtRet.OwnerID.GetValue();
                    }
                    //Get value of DataExtName
                    string DataExtName17 = (string)DataExtRet.DataExtName.GetValue();
                    //Get value of DataExtType
                    ENDataExtType DataExtType18 = (ENDataExtType)DataExtRet.DataExtType.GetValue();
                    //Get value of DataExtValue
                    string DataExtValue19 = (string)DataExtRet.DataExtValue.GetValue();
                }
            }
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T12:43:22.510

您可以将每个税项添加为行项目。确保将发票设置为 0 税，因此税不会在税的基础上计算。

您将有一个行项目销售税 A 和另一个行项目销售税 B。

# java - Web 服务 API - 请求用户授权 - 第一个计时器

> ID：15694504
> 
> 赞同：2
> 
> 时间：2013-03-29T00:28:50.887
> 
> 标签：java, api, url, authentication, last.fm

[last.fm API 认证](http://www.last.fm/api/desktopauth#3)

我需要连接到一个 URL，让用户进行身份验证，然后继续。我怎么做？我有打开 URL 的部分，但不知道如何等待。

```
 // 3\. Request authorization from the user
            String authURL = "http://www.last.fm/api/auth/?api_key=" + key + "&token=" + token;
            java.awt.Desktop browser = java.awt.Desktop.getDesktop();
            java.net.URI uri = new java.net.URI(authURL);
            browser.browse(uri); 
```

这是我第一次使用 Web API。我尝试在 Google 和 SO 上查找，但没有完全找到我要找的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:40:22.960

很抱歉您选择此作为您对 API 的介绍。文档中的 5 秒显示您遇到的问题是他们的代码中的设计缺陷，来自文档：

> 如果用户没有登录 Last.fm，他们将被重定向到登录页面，然后被要求授予您的应用程序使用其帐户的权限。在此页面上，他们将看到您的应用程序的名称，以及第 1 节中提供的应用程序描述和徽标。一旦用户授予您的应用程序使用其帐户的权限，基于浏览器的过程就结束了，并询问用户关闭他们的浏览器并返回您的应用程序。

这是正确的。用户完成身份验证后，他们不会 ping 您。他们只是指示用户关闭浏览器。由于显而易见的原因，这很蹩脚：我们如何知道用户是否完成了它？我们没有。

您将构建您的应用程序，以便在用户返回后代码继续运行，可能会给用户一个按钮来按下“我完成了”。稍后，您将不得不处理用户从未在调用 API 的其他代码中进行身份验证的可能性。

是的，它坏了。例如，在用户完成基于浏览器的身份验证步骤后，oAuth 至少会使用令牌给您回电。在桌面应用程序中使用 oAuth 时，您只需启动本地网络服务器并在那里接收回调（显然需要正确配置 LAN）

# android - 如何分别显示两个表条目（我的是在一个表中显示所有条目）

> ID：15694505
> 
> 赞同：0
> 
> 时间：2013-03-29T00:28:51.337
> 
> 标签：android, android-sqlite

我的数据库中有两个表。表 2 的条目与其自己的条目一起显示在一个表 1 中

例如，如果表 1`DATABASE_TABLE`和表 2`DATBASE_TABLE2`各有 5 个条目，当我进入并查看数据库时，表 1 带有 10 个条目，而表显示为空。

我的 DatabaseManager.java 处理数据库的所有操作

```
package com.example.draft;

import java.sql.SQLException;

import android.content.ContentValues;
import android.content.Context;

import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

// Class handling all database operations

public class DatabaseManager 
{
//setting variables to use later on in tables and database

public static final String KEY_EXERCISENAME = "exercisename";
public static final String KEY_DURATION = "duration";

private static final String DATABASE_NAME = "MyDatabase";
private static final String DATABASE_TABLE = "weekOne";
private static final String DATABASE_TABLE2 = "weektwo";

private static final int DATABASE_VERSION = 3;

//setting variables to reference DbHelper, its Context, and SQLiteDatabase

private DbHelper ourHelper;
private final Context ourContext;
private SQLiteDatabase ourDatabase;

//sub class which creates the database

private static class DbHelper extends SQLiteOpenHelper
{

    public DbHelper(Context context)
    {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);

        // TODO Auto-generated constructor stub
    }

    //method to create the database and table

    @Override
    public void onCreate(SQLiteDatabase db) 
    {
        // TODO Auto-generated method stub
        db.execSQL
        ("CREATE TABLE " + DATABASE_TABLE + " (" +
            KEY_EXERCISENAME + " TEXT NOT NULL, " +
            KEY_DURATION + " TEXT NOT NULL);"
        );

        db.execSQL
        ("CREATE TABLE " + DATABASE_TABLE2 + " (" +
            KEY_EXERCISENAME + " TEXT NOT NULL, " +
            KEY_DURATION + " TEXT NOT NULL);"
        );

    }

    //method to show the table if it exists

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion)
    {
        // TODO Auto-generated method stub

        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE2);

        onCreate(db);
    }

}

public DatabaseManager(Context c)
{
    ourContext = c; 
}

public DatabaseManager open() 
{
    ourHelper = new DbHelper(ourContext);
    ourDatabase = ourHelper.getWritableDatabase();
    return this;    
}

//creating entry in table for treadmill in table week 1 with the help of ContentValues

public long createEntry(String treadmillTimings) 
{
    // TODO Auto-generated method stub

    ContentValues cv = new ContentValues();

    //enterting each exercise name corresponding to their respective edit Texts

    cv.put(KEY_EXERCISENAME, "Treadmill");
    cv.put(KEY_DURATION, treadmillTimings);

    return ourDatabase.insert(DATABASE_TABLE, null,cv);

}

//creating entry in table for stepperTimings in table week 1 with the help of ContentValues

public long week1createEntry1 (String stepperTimings)
{
    ContentValues cv1 = new ContentValues();
    cv1.put(KEY_EXERCISENAME, "Stepper");
    cv1.put(KEY_DURATION, stepperTimings);
    return ourDatabase.insert(DATABASE_TABLE, null,cv1);

}

//creating entry in table for Stationary Rowing in table week 1 with the help of ContentValues

public long week1createEntry2 (String stationaryRowingTimings)
{
    ContentValues cv2 = new ContentValues();
    cv2.put(KEY_EXERCISENAME, "Stationary Rowing");
    cv2.put(KEY_DURATION, stationaryRowingTimings);

    return ourDatabase.insert(DATABASE_TABLE, null,cv2);

}

//creating entry in table for exercise bike in table week 1 with the help of ContentValues

public long week1createEntry3 (String exerciseBikeTimings)
{
    ContentValues cv3 = new ContentValues();
    cv3.put(KEY_EXERCISENAME, "Exercise Bike");
    cv3.put(KEY_DURATION, exerciseBikeTimings);
    return ourDatabase.insert(DATABASE_TABLE, null,cv3);

}

//creating entry in table for elliptical trainer in table week 1 with the help of ContentValues

public long week1createEntry4 (String ellipticalTrainerTimings)
{
    ContentValues cv4 = new ContentValues();
    cv4.put(KEY_EXERCISENAME, "Stationary Rowing");
    cv4.put(KEY_DURATION, ellipticalTrainerTimings);
    return ourDatabase.insert(DATABASE_TABLE, null,cv4);

}

//displaying/reading data in the table using cursor

public String week1getData() 
{
    // TODO Auto-generated method stub
    String[] columns = new String[]{KEY_EXERCISENAME, KEY_DURATION};
    Cursor cur = ourDatabase.query(DATABASE_TABLE, columns, null, null, null, null, null);

    //creating a result(string type variable) to store the text and display it.

    String result = "";

    int iExerciseName = cur.getColumnIndex(KEY_EXERCISENAME);
    int iDuration = cur.getColumnIndex(KEY_DURATION);

    // cursor start from the first position, keeps moving to the next as long as the position in not after that last.

    for(cur.moveToFirst(); !cur.isAfterLast(); cur.moveToNext())
    {
        /*getting the rows, exercise name and duration in the tables of database and setting it to result. 
          .The next time it loops, it will still have the previous result*/

        result = result + cur.getString(iExerciseName) + "                            " + cur.getString(iDuration) + "\n";
    }

    return result;

}

public long week2createEntry(String treadmillTimingsweek2) 
{
    // TODO Auto-generated method stub

    ContentValues cv = new ContentValues();

    //Entering each exercise name corresponding to their respective edit Texts

    cv.put(KEY_EXERCISENAME, "Treadmill");
    cv.put(KEY_DURATION, treadmillTimingsweek2);

    return ourDatabase.insert(DATABASE_TABLE2, null,cv);

}

//creating entry in table for stepperTimings in table week 1 with the help of ContentValues

public long week2createEntry1 (String stepperTimingsweek2)
{
    ContentValues cv1 = new ContentValues();
    cv1.put(KEY_EXERCISENAME, "Stepper");
    cv1.put(KEY_DURATION, stepperTimingsweek2);
    return ourDatabase.insert(DATABASE_TABLE2, null,cv1);

}

//creating entry in table for Stationary Rowing in table week 1 with the help of ContentValues

public long week2createEntry2 (String stationaryRowingTimingsweek2)
{
    ContentValues cv2 = new ContentValues();
    cv2.put(KEY_EXERCISENAME, "Stationary Rowing");
    cv2.put(KEY_DURATION, stationaryRowingTimingsweek2);

    return ourDatabase.insert(DATABASE_TABLE2, null,cv2);

}

//creating entry in table for exercise bike in table week 1 with the help of ContentValues

public long week2createEntry3 (String exerciseBikeTimingsweek2)
{
    ContentValues cv3 = new ContentValues();
    cv3.put(KEY_EXERCISENAME, "Exercise Bike");
    cv3.put(KEY_DURATION, exerciseBikeTimingsweek2);
    return ourDatabase.insert(DATABASE_TABLE2, null,cv3);

}

//creating entry in table for elliptical trainer in table week 1 with the help of ContentValues

public long week2createEntry4 (String ellipticalTrainerTimingsweek2)
{
    ContentValues cv4 = new ContentValues();
    cv4.put(KEY_EXERCISENAME, "Stationary Rowing");
    cv4.put(KEY_DURATION, ellipticalTrainerTimingsweek2);
    return ourDatabase.insert(DATABASE_TABLE2, null,cv4);

}

public String week2getData() 
{
    // TODO Auto-generated method stub
    String[] columns = new String[]{KEY_EXERCISENAME, KEY_DURATION};
    Cursor cur = ourDatabase.query(DATABASE_TABLE2, columns, null, null, null, null, null);

    //creating a result(string type variable) to store the text and display it.

    String result = "";

    int iExerciseName = cur.getColumnIndex(KEY_EXERCISENAME);
    int iDuration = cur.getColumnIndex(KEY_DURATION);

    // cursor start from the first position, keeps moving to the next as long as the position in not after that last.

    for(cur.moveToFirst(); !cur.isAfterLast(); cur.moveToNext())
    {
        /*getting the rows, exercise name and duration in the tables of database and setting it to result. 
          .The next time it loops, it will still have the previous result*/

        result = result + cur.getString(iExerciseName) + "                            " + cur.getString(iDuration) + "\n";
    }

    return result;

} 
```

我正在显示`DATABASE_TABLE`条目的 textView 是`android:id = @+id/dbinfo`和`DATABASE_TABLE2`条目`android:id = "@+id/week2dbinfo`

我想要的是`DATABASE_TABLE`显示 5 个条目`android:id = @+id/dbinfo`并`DATABASE TABLE2`显示 5 个条目 `android:id = "@+id/week2dbinfo`

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T03:47:03.640

我正在使用 week1 的方法调用第 2 周的显示条目的方法`week1getData()`，因此将其更改为`week2getData`

# javascript - 在 Javascript 中动态添加 SVG

> ID：15694507
> 
> 赞同：2
> 
> 时间：2013-03-29T00:29:03.927
> 
> 标签：javascript, xml, dynamic, svg

我在 InkScape 之类的程序中创建了一个 SVG 文件。我想在 Javascript 中加载它并将其与其他 SVG 元素一起放入 SVG 对象中。

我想要一个可以传递 URL 的函数，它将获取该 SVG，然后返回一个“g”对象，该对象对我加载的 SVG 文件中的所有内容进行分组。

```
SVG.LoadXML = function (url, continuation) {
    var http = new XMLHttpRequest();
    http.open("GET", url, false);
    http.send();
    textBody = http.responseText;

    var g = document.createElementNS(SVG.ns, "g");

    g.innerHTML = textBody;

    return g;
} 
```

正在加载的文件正文如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE svg PUBLIC [...] >
<svg version="1.1" [...] >

<g>
  <defs>
    <path id="SVG1ID_1_" [...]
etc. 
```

所以，我想我想要做的是以 XML 格式打开文件，然后跳过前两个节点，输入第二个节点，然后将其中的所有节点复制到文档中的 SVG 中。

这似乎是一种应该非常简单的事情，并且已经被几千人以几种不同的方式实现了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T01:06:29.077

在处理 SVG 时，不要陷入期望它与 HTML 完全一样工作的陷阱。这里需要做一些不同的事情：

SVG 元素不是 HTML，您不能设置`.innerHTML`. 改为使用`.appendChild()`。您显然只能附加一个 DOM 元素，而不是纯文本，因此请使用`.responseXML`而不是`.responseText`.

为了导航加载的 SVG，只选择某些节点，使用标准的 DOM 方法，如`.getElementById()`, `.getElementsByTagName()`, `.childNodes`,`firstChild`等`.lastChild`。

要将检索到的 SVG 中的节点附加到主 SVG，您必须先导入它。请参阅描述此内容的另[一篇文章。](https://stackoverflow.com/questions/804180/can-i-append-an-ajax-requestxml-object-to-my-document-tree-all-in-one-go/821731#821731)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T23:48:43.517

我没有意识到 appendChild 也会从父级中删除该子级，因此我的实现只获得了大约一半的 SVG 项目。这是工作代码：

```
SVG.LoadXML = function (url) {
    var http = new XMLHttpRequest();
    http.open("GET", url, false);
    http.send();
    xmlBody = http.responseXML;

    var g = document.createElementNS(SVG.ns, "g");
    var svg = xmlBody.getElementsByTagName("svg")[0];
    do {
        var child = svg.firstChild;
        g.appendChild(child);
    } while (svg.firstChild);
    return g;
} 
```

# php - Apache/Linux Webserver 动态阻止传入的 POST 请求

> ID：15694508
> 
> 赞同：1
> 
> 时间：2013-03-29T00:29:06.873
> 
> 标签：php, linux, apache, webserver, centos

**背景故事**：最近有人以某种方式破坏了连接到我的服务器的 Xenforo 安装并注入了一个无限循环的 php mail() 脚本。它从域内向外界发送了数千封电子邮件，最终在我注意到它发生之前就将我的域从所有主要的电子邮件 ISP 中列入黑名单。我找到了该文件，该文件以某种方式注入到论坛的缓存和 skin_cache 目录中，然后将其删除并设置了永久重定向（使用 php 标头重定向）到反垃圾邮件收集站点。

**当前问题**：我现在看到对上述垃圾邮件脚本的 POST 请求稳定且永无止境。IP 每次都不同，而且似乎永远不会停止。这种情况已经持续了两个多星期。以至于我的 apache 最大化其 MaxClients 设置并遇到内存问题，并开始关闭其他进程以进行补偿。

**这是日志中显示的内容**：

```
190.40.7.126 - - [28/Mar/2013:18:58:30 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
190.104.19.189 - - [28/Mar/2013:18:58:39 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
78.251.159.173 - - [28/Mar/2013:18:58:57 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
219.78.213.10 - - [28/Mar/2013:18:59:09 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
69.123.20.137 - - [28/Mar/2013:18:59:09 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
2.234.181.7 - - [28/Mar/2013:18:59:37 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
187.207.223.67 - - [28/Mar/2013:18:59:44 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
24.242.122.42 - - [28/Mar/2013:19:01:56 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
213.49.254.102 - - [28/Mar/2013:19:02:32 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
82.247.48.152 - - [28/Mar/2013:19:02:38 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
41.135.146.136 - - [28/Mar/2013:19:02:43 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
91.187.93.36 - - [28/Mar/2013:19:03:04 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0"
194.90.37.132 - - [28/Mar/2013:19:03:40 -0500] "POST /forum/cache/sslFDoB.php HTTP/1.1" 200 3889 "-" "Mozilla/5.0" 
```

我需要有关处理此问题的最佳方法的建议。简单地重定向或 404 处理它们不会停止服务器上的资源使用。还有如此多的不同 IP 以如此恒定的速率存在，以至于很难看出是否有任何重复的 IP。它们似乎都在随机范围内并且来源不同。老实说，我不确定这些是虚假请求，还是真正受到攻击的客户成为垃圾邮件 xss 或某种病毒的受害者。

想出一种方法来禁止任何动态请求该文件的 IP 以使他们无法重试是否合理？我需要建议和帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T02:30:53.343

恶意脚本的 URL 很可能已分发到僵尸网络，该僵尸网络试图将您的网络服务器用作海滩头。请求最终会消退，因为僵尸网络继续请求不起作用的脚本是无利可图的。

快速简单的解决方法：`<Location>`在您的 Apache 配置中添加一个块或一个重写规则，它将忽略这些请求。

厚颜无耻、随意的方法：使用基于 iptables 的速率限制。`iptables -A INPUT -p tcp --dport 80 -m limit --limit 60/min -j ACCEPT`使用以下拒绝规则可能会有所帮助，但它也可能会阻止合法流量，包括搜索引擎索引器和合法机器人。

更好的解决方案：实现一个 Web 应用防火墙，如 Apache 的`mod_security`. 您可以添加附加规则以匹配传入请求并将它们列入黑名单，或任何其他合适的副作用。

无论您采用哪种选项，我都非常怀疑 404 错误是否会损害您服务器上的资源使用。您需要考虑其他因素：

*   您的 PHP 脚本可能会导致一些重大的性能/效率问题。
*   您的 Apache 配置可能未经过优化以处理大量流量。
*   您的服务器受到威胁，您现在有更大的问题需要处理。

您可能还想考虑将 Apache 作为反向代理后端放在 Nginx 后面。根据原因，在 Apache 服务器（如 Varnish）前使用 HTTP 缓存可以将服务器上的负载减少到一个相对恒定的因素，而不是一个变化的因素。

**TL; DR**：这取决于。您的服务器可能配置错误或受到威胁。

# objective-c - 以编程方式创建可可应用程序的初始窗口（OS X）

> ID：15694510
> 
> 赞同：29
> 
> 时间：2013-03-29T00:29:09.087
> 
> 标签：objective-c, macos, cocoa

通常我正在制作 iOS 应用程序，但现在我正在尝试制作一个 OS X 应用程序，而我一开始就迷路了。假设我制作 iOS 应用程序的风格是完全程序化的，没有 xib 文件或任何东西，因为我通过打字比拖动有更多的控制权。然而在 OS X 编程中，它以一些带有菜单项和默认窗口的 xib 文件开始。菜单项中有很多项目，所以这可能不是我想要搞砸的东西，但我想自己以编程方式创建我的第一个窗口。

所以我这样做了：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{    
    NSUInteger windowStyleMask = NSTitledWindowMask|NSResizableWindowMask|NSClosableWindowMask|NSMiniaturizableWindowMask;
    NSWindow* appWindow = [[NSWindow alloc] initWithContentRect:NSMakeRect(200, 200, 1280, 720) styleMask:windowStyleMask backing:NSBackingStoreBuffered defer:NO];
    appWindow.backgroundColor = [NSColor lightGrayColor];
    appWindow.minSize = NSMakeSize(1280, 720);
    appWindow.title = @"Sample Window";
    [appWindow makeKeyAndOrderFront:self];
    _appWindowController = [[AppWindowController alloc] initWithWindow:appWindow];
    [_appWindowController showWindow:self];
} 
```

所以在这里，我先创建了一个窗口，并使用那个 windowController 来初始化这个窗口。窗口确实以这种方式显示，但我只能在此处指定内部元素，如按钮和标签，而不能在 windowController 中指定。这让我感觉很糟糕，所以我尝试了另一种方法。

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    _appWindowController = [[AppWindowController alloc] init];
    [_appWindowController showWindow:self];
} 
```

在此之后，我想`loadWindow:`在 windowController 中设置函数中的其他元素，如下所示：

```
- (void)loadWindow
{
    [self.window setFrame:NSMakeRect(200, 200, 1280, 720) display:YES];
    self.window.title = @"Sample window";
    self.window.backgroundColor = [NSColor lightGrayColor];

    NSButton* sampleButton = [[NSButton alloc] initWithFrame:NSRectFromCGRect(CGRectMake(100, 100, 200, 23))];
    sampleButton.title = @"Sample Button!";
    [sampleButton setButtonType:NSMomentaryLightButton];
    [sampleButton setBezelStyle:NSRoundedBezelStyle];
    [self.window.contentView addSubview:sampleButton];
    NSLog(@"Loaded window!");
    [self.window makeKeyAndOrderFront:nil];
} 
```

不幸的是，这永远不会奏效。永远不会被`loadWindow:`调用，也不会`windowDidLoad:`。他们去哪儿了？

请不要问我为什么不使用笔尖。我希望在内部制作一些高度定制的视图，可能是 OpenGL，所以我认为 nib 无法处理它。如果有人可以提供帮助，我将不胜感激。谢谢。

而且，谁知道如何以编程方式从头开始菜单项？

我正在使用最新的 Xcode。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2014-02-24T12:36:38.873

我自己花了整个星期天的时间来研究这个问题。就像问这个问题的人一样，我更喜欢在没有 nib 文件（大多数情况下）或 Interface Builder 的情况下编写 iOS 和 OSX，并使用裸机。我确实使用 NSConstraints。如果您正在做更简单的 UI，那么避免 IB 可能不值得，但是当您进入更复杂的 UI 时，它会变得更加困难。

事实证明这很简单，为了“社区”的利益，我想我会在这里发布一个简洁的最新答案。那里有一些较旧的博客文章，我发现最有用的是来自[Lap Cat Software](http://lapcatsoftware.com/blog/category/cocoa/)的文章。'提示 O The Hat' 先生！

这假设 ARC。修改你的 main() 看起来像这样：

```
#import <Cocoa/Cocoa.h>
#import "AppDelegate.h"

int main(int argc, const char *argv[])
{
    NSArray *tl;
    NSApplication *application = [NSApplication sharedApplication];
    [[NSBundle mainBundle] loadNibNamed:@"MainMenu" owner:application topLevelObjects:&tl];

    AppDelegate *applicationDelegate = [[AppDelegate alloc] init];      // Instantiate App  delegate
    [application setDelegate:applicationDelegate];                      // Assign delegate to the NSApplication
    [application run];                                                  // Call the Apps Run method

    return 0;       // App Never gets here.
} 
```

你会注意到那里仍然有一个 Nib (xib)。这仅适用于主菜单。事实证明，即使在今天（2014 年），显然也无法轻松设置位置 0 菜单项。那就是标题=您的应用程序名称的那个。您可以使用`[NSApplication setMainMenu]`但不能将所有内容设置在它的右侧。所以我选择在新项目中保留 Xcode 创建的 MainMenu Nib，并将其剥离到位置 0 项。我认为这是一个公平的妥协，我可以接受。**UI Sanity 的一个简短插件...当您创建菜单时，请遵循与其他 Mac OSX 应用程序相同的基本模式**。

接下来将 AppDelegate 修改为如下所示：

```
-(id)init
{
    if(self = [super init]) {
        NSRect contentSize = NSMakeRect(500.0, 500.0, 1000.0, 1000.0);
        NSUInteger windowStyleMask = NSTitledWindowMask | NSResizableWindowMask | NSClosableWindowMask | NSMiniaturizableWindowMask;
        window = [[NSWindow alloc] initWithContentRect:contentSize styleMask:windowStyleMask backing:NSBackingStoreBuffered defer:YES];
        window.backgroundColor = [NSColor whiteColor];
        window.title = @"MyBareMetalApp";

        // Setup Preference Menu Action/Target on MainMenu
        NSMenu *mm = [NSApp mainMenu];
        NSMenuItem *myBareMetalAppItem = [mm itemAtIndex:0];
        NSMenu *subMenu = [myBareMetalAppItem submenu];
        NSMenuItem *prefMenu = [subMenu itemWithTag:100];
        prefMenu.target = self;
        prefMenu.action = @selector(showPreferencesMenu:);

        // Create a view
        view = [[NSTabView alloc] initWithFrame:CGRectMake(0, 0, 700, 700)];
    }
    return self;
 }

 -(IBAction)showPreferencesMenu:(id)sender
 {
    [NSApp runModalForWindow:[[PreferencesWindow alloc] initWithAppFrame:window.frame]];
 }

-(void)applicationWillFinishLaunching:(NSNotification *)notification
{
    [window setContentView:view];           // Hook the view up to the window
}

-(void)applicationDidFinishLaunching:(NSNotification *)notification
{
    [window makeKeyAndOrderFront:self];     // Show the window
} 
```

和宾果游戏......你很高兴去！您可以像您熟悉的那样在 AppDelegate 中开始工作。希望有帮助！

**更新**：我不再在代码中创建菜单，如上所示。我发现您可以在 Xcode 6.1中编辑**MainMenu.xib源代码。**效果很好，非常灵活，只需进行一些实验即可了解其工作原理。比乱写代码更快，并且易于本地化！查看图片以了解我在说什么：

![编辑 MainMenu.xib](../Images/b7647acac33ae87f4480ff2c960c5bf8.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-27T22:00:21.420

见[https://github.com/sindresorhus/touch-bar-simulator/blob/master/Touch%20Bar%20Simulator/main.swift](https://github.com/sindresorhus/touch-bar-simulator/blob/master/Touch%20Bar%20Simulator/main.swift)

在 main.swift

```
let app = NSApplication.shared()
let delegate = AppDelegate()
app.delegate = delegate
app.run() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-30T15:04:04.953

斯威夫特 4：

```
// File main.swift
autoreleasepool {
   // Even if we loading application manually we need to setup `Info.plist` key:
   // <key>NSPrincipalClass</key>
   // <string>NSApplication</string>
   // Otherwise Application will be loaded in `low resolution` mode.
   let app = Application.shared
   app.setActivationPolicy(.regular)
   app.run()
}

// File Application.swift
public class Application: NSApplication {

   private lazy var mainWindowController = MainWindowController()
   private lazy var mainAppMenu = MainMenu()

   override init() {
      super.init()
      delegate = self
      mainMenu = mainAppMenu
   }

   public required init?(coder: NSCoder) {
      super.init(coder: coder) // This will newer called.
   }

}

extension Application: NSApplicationDelegate {

   public func applicationDidFinishLaunching(_ aNotification: Notification) {
      mainWindowController.showWindow(nil)
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T01:02:29.373

覆盖类中的`-init`方法`AppWindowController`以创建窗口，然后使用该窗口调用`super`' 的`-initWithWindow:`方法（这是`NSWindowController`' 的指定初始化程序）。

但我普遍同意没有理由避免使用 NIB 的评论。

# c# - 想要在 UI 中持续运行 Progess-Bar 直到我们收到服务响应

> ID：15694511
> 
> 赞同：0
> 
> 时间：2013-03-29T00:29:09.177
> 
> 标签：c#, .net, xaml, wpf-controls, wpf-4.0

我想为 WPF 应用程序中的连续进度条分配一个新线程，以便在单击 UI 按钮后它将连续运行，直到我收到服务响应。

我做了如下代码，但进度条（MclarenServerCecksProgressBar）似乎根本不起作用

```
MclarenServerCecksProgressBar.Visibility = Visibility.Visible;
var uiThread = new Thread(() =>
{
progressBarDisptacher = MclarenServerCecksProgressBar.Dispatcher;

// allowing the main UI thread to proceed 
System.Windows.Threading.Dispatcher.Run();    
});
uiThread.SetApartmentState(ApartmentState.STA);
uiThread.IsBackground = true;
uiThread.Start();      
string[] servicesss = getServices(servername,server);
DataTable dtd = esd.getListOfServices(servername, usrid.Text.ToString(),   
userpass.Password.ToString(), servicesss);
MclarenServerCecksProgressBar.Visibility = Visibility.Hidden; 
```

请安排建议我实现这一目标，任何其他指针都会有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T05:08:05.430

WPF UI 只有一个可用于通信的 UI 线程 - 调度程序线程。只要与 UI 对象交互的调用是通过 UI 调度程序完成的，您的所有后台任务都可以在您喜欢的任何线程上完成。通过此调度程序发送调用是一项常见任务，因此每个 WPF 对象都提供了 Dispatcher 属性。

我会这样处理问题：

```
 private void button2_Click(object sender, RoutedEventArgs e)
    {
        // Currently running on the WPF thread so the WPF property can be set directly
        this.progressBar1.Visibility = System.Windows.Visibility.Visible;

        // Create a new thread to do the long running task
        Thread worker = new Thread(() =>
        {
            WebService.DoSomethingThatTakesAges();

            // When the above call has completed, update the UI on its dispatcher thread
            this.progressBar1.Dispatcher.BeginInvoke(new Action(() =>
                {
                    this.progressBar1.Visibility = System.Windows.Visibility.Hidden;
                }));
        });

        worker.Start();
    } 
```

使用 System.Threading.Tasks 命名空间使用 TaskScheduler 创建 Task 可能比直接创建线程更好，但原理是一样的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T23:19:32.887

最后，我通过一些技巧实现了这一点。我已经使用委托与 DependencyProperty 和 Dispatacher 来更新进度条，经过很长时间的各种尝试后，这对我有用的任何方式，请参阅下面我所做的代码

```
private delegate void UpdateProgressBarDelegate(
    System.Windows.DependencyProperty dp, Object value);

private void startProgessBar(string controlname)
{
    MclarenServerCecksProgressBar.Visibility = Visibility.Visible;

    //Stores the value of the ProgressBar

    //Create a new instance of our ProgressBar Delegate that points
    // to the ProgressBar's SetValue method.
    UpdateProgressBarDelegate updatePbDelegate =
        new UpdateProgressBarDelegate(MclarenServerCecksProgressBar.SetValue);
    bool _status = true;
    int flag = 0;
    double value = 0;

    do
    {

        /*Update the Value of the ProgressBar: */

        Dispatcher.Invoke(updatePbDelegate,
            System.Windows.Threading.DispatcherPriority.Background,
            new object[] { System.Windows.Controls.ProgressBar.ValueProperty, value });

                if (flag == 0)
                {
                    flag == 1
                    _status = processesServices(controlname);
                }
                if (_status == false)
                {
                    MclarenServerCecksProgressBar.Visibility = Visibility.Hidden;
                }
    }
    while (_status);
} 
```

**无论如何，修复它可能很脏，我一直在寻找运行 progessbar，直到我收到一个函数的响应，任何其他改进这种方式的建议都会非常受欢迎。欢迎提供任何建议和帮助来改进这一点。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T07:37:13.093

我不明白你的代码进度条值集如何。另外，我不太明白您为什么要对线程使用这种黑客攻击。如果我理解你的问题，我举了一个例子，我是如何用进度条做到这一点的。

```
<Window x:Class="WpfApplication5.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow"
    Height="350"
    Width="525">
<Grid>
    <ProgressBar Height="10"
             HorizontalAlignment="Left"
             Margin="12,12,0,0"
             Name="progressBar1"
             VerticalAlignment="Top"
             Width="100"
             Visibility="Hidden" />
    <Button Content="Button"
        Height="23"
        HorizontalAlignment="Left"
        Margin="30,54,0,0"
        Name="button1"
        VerticalAlignment="Top"
        Width="75"
        Click="button1_Click" />
</Grid>
</Window>

using System;
using System.Threading;
using System.Windows;

namespace WpfApplication5 {
    public partial class MainWindow : Window {
        public MainWindow() {
            InitializeComponent();
        }

        void button1_Click(object sender, RoutedEventArgs e) {
            progressBar1.Visibility = Visibility.Visible;
            Action method = () => {
                Action<int> method2 = (val) => {
                    progressBar1.Value = val;
                };
                for (int i = 0 ; i < 10 ; i++) {
                    Thread.Sleep(500);
                    Dispatcher.BeginInvoke(method2, i * 10);
                }
                Action method3 = () => {
                    progressBar1.Visibility = Visibility.Hidden;
                };
                Dispatcher.BeginInvoke(method3);
            };
            method.BeginInvoke(null, null);
        }
    }
} 
```

# php - 如何包含/需要文件槽函数 PHP？

> ID：15694516
> 
> 赞同：1
> 
> 时间：2013-03-29T00:29:57.207
> 
> 标签：php, oop, class, function

我有 2 个文件，`class.inc.php`并且`index.php`.

`class.inc.php`包含 Myclass 和几个函数，`index.php`文件从`class.inc.php`.

现在我需要创建一个包含/需要文件的函数，并且该函数实际上应该在 index.php 中而不是在 class.inc.php 中需要该文件。

是的，我知道我可以将我的文件放在一个函数中并以这种方式调用它，但由于未来的一些 MVC 覆盖，我们必须将它保存在文件中。如果可能的话，我也不想直接在 index.php 中包含一个文件。那么有没有办法做到这一点？

在我的 index.php 中，我应该能够做到这一点：

```
Myclass::include(PARAMS); 
```

这应该包括一个位于其他地方的文件名 params.php。

我在 class.inc.php 中试过这个

```
abstract class Myclass {
    static function load($filename){
        require_once $filename;
    }
} 
```

这在

索引.php

```
Myclass::include(PARAMS); 
```

但是我在 params.php 中的所有变量在 index.php 中都不可见，因为它们似乎在 class.inc.php 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:41:43.777

`include`,`require`和朋友基本上表现得好像您已将文件的内容复制并粘贴到该位置。因此，如果您在函数中运行它们，则任何“裸”变量（如果您自己运行文件将是全局的）将成为该函数的本地变量。

一般来说，现代 PHP 代码中的答案就是不使用任何全局变量——文件应该只包含函数，或者更好的是，只包含命名空间和类，所有变量都包含在其中。

但是，如果您确实需要全局变量，则可以`global`在包含函数中或包含文件的顶部使用关键字。

因此，例如，如果您包含的文件定义了一个`$config`需要在其他地方访问的变量，那么您可以在文件的顶部编写`global $config;`以将其推出您`include`/`require`它时所在的任何范围。

# jsp - JSP 将参数保存为字符串

> ID：15694521
> 
> 赞同：0
> 
> 时间：2013-03-29T00:30:26.750
> 
> 标签：jsp

我正在尝试将参数保存到 JSP 中的字符串变量中，但不知道该怎么做。

该请求正在正常工作，并且正在检索数据。

```
<%= request.getParameter("page") %> 
```

但是如何将其保存为字符串？

```
<% String temp = '<%= request.getParameter("page") %>'; %> 
```

上面的代码不起作用。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:33:10.073

`<% String temp = request.getParameter("page"); %>`足以存储价值...

# silverlight - 在 XAML 中从 Windows Phone 工具包定义 CustomMessageBox

> ID：15694526
> 
> 赞同：0
> 
> 时间：2013-03-29T00:30:52.063
> 
> 标签：silverlight, windows-phone-7, xaml, windows-phone

我可以在 XAML 中定义 CustomMessageBox 吗？我有代码：

```
<phone:phone:PhoneApplicationPage.Resources>
        <toolkit:CustomMessageBox x:Key="CustomMessageBox" Title="Blabla" IsLeftButtonEnabled="True" LeftButtonContent="OK" Content="blabla" />
</phone:PhoneApplicationPage.Resources> 
```

当我尝试运行它时：

```
(this.Resources["CustomMessageBox"] as CustomMessageBox).Show(); 
```

我得到 InvalidOperationException -“元素已经是另一个元素的子元素。”。

是否可以这样做，或者我必须从代​​码隐藏中定义它？有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T08:49:18.120

由于[这](http://www.geekchamp.com/marketplace/components/windows-phone-toolkit-in-depth-3rd-edition)本书（不是广告，只是显示来源），你可以这样做：

1 创建新的 UserControl，将其命名为 CustomUserControl.xaml

2 向 UC 添加自定义 UI 元素

```
<StackPanel x:Name="LayoutRoot" Background="{StaticResource PhoneChromeBrush}" Margin="0,0,0,10">
 <TextBlock Text="Custom content inside the UserControl XAML" TextWrapping="Wrap"
 HorizontalAlignment="Left"/>
 <MediaElement Source="http://mschannel9.vo.msecnd.net/o9/mix/09/wmv/key01.wmv"/>
 </StackPanel> 
```

3 从主页的代码隐藏运行

```
var messageBox = new CustomMessageBox
{
Content = new CustomUserControl(),
LeftButtonContent = "OK",
RightButtonContent = "Cancel",
};
messageBox.Show(); 
```

现在看来您可以在消息框中播放视频了:)

PS：也在[这里找到了一些信息](http://shawnoster.com/2012/10/welcome-custommessagebox-to-the-windows-phone-toolkit/)

# php - 在php中删除行

> ID：15694532
> 
> 赞同：0
> 
> 时间：2013-03-29T00:31:36.593
> 
> 标签：php

我正在尝试使用表单从我的数据库中删除记录。无法让这个工作。有任何想法吗？

```
include 'newsconnect.php';
$Id = $_POST['Id'];
if (empty($Id) === true {
    echo 'please input an Post ID.';
} else {
    if(!$_POST['Submit']) {
        header('Location: http://www.hidensecrets.yourwebsolution.net/forum.php');
    } else {
        mysql_query("DELETE * FROM forum WHERE id = '$Id'") or die(mysql_error());
        header('Location: http://www.hidensecrets.yourwebsolution.net/forum.php') ;
        echo "Deleted!";        
    }
} 
```

我似乎登陆了这个没有显示错误的页面。
非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:33:10.290

缺少右括号：

```
include 'newsconnect.php';
$Id = $_POST['Id'];
if (empty($Id)) {
           //-^    
    echo 'please input an Post ID.';
} else {
    if (!$_POST['Submit']) {
        header('Location: http://www.hidensecrets.yourwebsolution.net/forum.php');
    } else {
        mysql_query("DELETE FROM forum WHERE id = '$Id'") or die(mysql_error());
        header('Location: http://www.hidensecrets.yourwebsolution.net/forum.php');
        echo "Deleted!";
    }
} 
```

不确定您使用的是哪个 IDE，但其中大多数会显示此错误。您也可以接受 sql 注入。[了解](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:36:09.367

你面临什么样的问题？您缺少右括号`if (empty($Id) === true`，以防您遇到语法错误

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:40:17.693

我认为您必须在删除查询中省略星号！试试看，告诉我结果：）

您的代码必须使用此查询：

```
mysql_query("DELETE FROM forum WHERE id = '$Id'") or die(mysql_error()); 
```

而不是这个：

```
mysql_query("DELETE * FROM forum WHERE id = '$Id'") or die(mysql_error()); 
```

希望这将是解决方案:)

# php - 从 DQL 调用或 Twig 中的正确访问中删除额外的数组层

> ID：15694533
> 
> 赞同：1
> 
> 时间：2013-03-29T00:31:45.980
> 
> 标签：php, arrays, symfony, twig, dql

我进行了以下 DQL 调用：

```
"SELECT SUBSTRING(e.sDateStart, 1, 4) as year
 FROM contrastBundle:Exhibition e
 WHERE e.sDateStart < :dateStart
 GROUP BY year
 ORDER BY year DESC" 
```

它基本上返回我需要的东西，但形式如下：

```
array(3) {
  [0]=>
  array(1) {
    ["year"]=>
    string(4) "2007"
  }
  [1]=>
  array(1) {
    ["year"]=>
    string(4) "2006"
  }
  [2]=>
  array(1) {
    ["year"]=>
    string(4) "2005"
  }
} 
```

这使得使用它非常烦人。

**编辑** ：

```
{% for eachyear in years %}
    <a {% if year == eachyear.year %}class="active"{% endif %} href="{{path('exhibitions', {'year' : eachyear.year })}}">{{ eachyear.year }}</a>
{% endfor %} 
```

我可以使用 eachyear.year 访问字符串，但这是一个丑陋的解决方案。

我想知道哪个是最好的解决方案，我特别想处理我从调用中获得的数组，这样它基本上是一个多年的数组。pop_array() 和类似的似乎没有帮助。我还尝试对调用的输出进行水合，getArrayResult() 和 getScalarResult() 都将返回相同的输出。

# winapi - 为什么 FindFirstFileW 总是返回 -1？

> ID：15694538
> 
> 赞同：0
> 
> 时间：2013-03-29T00:32:39.023
> 
> 标签：winapi, unicode, syntax, vb6

`FindFirstFileA`(ANSI) 可以正常工作，而`FindFirstFileW`(Unicode) 则不能。Wide 版本总是返回 -1 (INVALID_HANDLE_VALUE)，但为什么呢？

```
'Declarations:
Option Explicit

Private Const MAX_PATH  As Long = 260
Private Const ALTERNATE As Long = 14
Private Const INVALID_HANDLE_VALUE As Long = -1

Private Type FILETIME
    dwLowDateTime  As Long
    dwHighDateTime As Long
End Type

Private Type WIN32_FIND_DATA
        dwFileAttributes As Long
        ftCreationTime As FILETIME
        ftLastAccessTime As FILETIME
        ftLastWriteTime As FILETIME
        nFileSizeHigh As Long
        nFileSizeLow As Long
        dwReserved0 As Long
        dwReserved1 As Long
        cFileName As String * MAX_PATH
        cAlternate As String * ALTERNATE
End Type

Private Declare Function FindFirstFileW Lib "kernel32" _
    (ByVal lpFileName As String, _
    ByRef lpFindFileData As WIN32_FIND_DATA) As Long

Private Declare Function FindFirstFileA Lib "kernel32" _
    (ByVal lpFileName As String, _
    ByRef lpFindFileData As WIN32_FIND_DATA) As Long

Private Declare Function FindClose Lib "kernel32" _
    (ByVal hFindFile As Long) As Long

Public Declare Function GetLastError Lib "kernel32" () As Integer

'Test Functions:
Public Function TestA(ByVal sf As String) As Long
    If Len(sf) < 3 Then Exit Function
    Dim wfd As WIN32_FIND_DATA
    TestA = FindFirstFileA(sf, wfd)
    'Debug.Print "AE:" & GetLastError()
    If TestA <> INVALID_HANDLE_VALUE Then FindClose TestA
End Function

Public Function TestW(ByVal sf As String) As Long
    If Len(sf) < 3 Then Exit Function
    Dim wfd As WIN32_FIND_DATA
    TestW = FindFirstFileW(sf, wfd)
    'Debug.Print "WE:" & GetLastError()
    If TestW <> INVALID_HANDLE_VALUE Then FindClose TestW
End Function

'Example test
Private Sub Command1_Click()
    Dim sDir As String
    sDir = "C:\new"
    MsgBox "A: " & TestA(sDir) & vbCrLf _
         & "W: " & TestW(sDir)
End Sub 
```

**PS**感谢 Carey Gregory，但我仍然需要一些帮助来翻译 Wide 版本。`WCHAR`VB6中的 C/C++ 等价物是什么？

```
//WinBase.h
typedef struct _WIN32_FIND_DATAA {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    CHAR   cFileName[ MAX_PATH ];
    CHAR   cAlternateFileName[ 14 ];
#ifdef _MAC
    DWORD dwFileType;
    DWORD dwCreatorType;
    WORD  wFinderFlags;
#endif
} WIN32_FIND_DATAA, *PWIN32_FIND_DATAA, *LPWIN32_FIND_DATAA;
typedef struct _WIN32_FIND_DATAW {
    DWORD dwFileAttributes;
    FILETIME ftCreationTime;
    FILETIME ftLastAccessTime;
    FILETIME ftLastWriteTime;
    DWORD nFileSizeHigh;
    DWORD nFileSizeLow;
    DWORD dwReserved0;
    DWORD dwReserved1;
    WCHAR  cFileName[ MAX_PATH ];    //WCHAR in VB6?
    WCHAR  cAlternateFileName[ 14 ]; //WCHAR in VB6?
#ifdef _MAC
    DWORD dwFileType;
    DWORD dwCreatorType;
    WORD  wFinderFlags;
#endif
} WIN32_FIND_DATAW, *PWIN32_FIND_DATAW, *LPWIN32_FIND_DATAW; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:43:57.970

WIN32_FIND_DATA 有两个版本，就像使用它们的函数一样：ANSI 版本和 Unicode 版本。您需要定义 WIN32_FIND_DATAA 和 WIN32_FIND_DATAW 并将它们与“A”和“W”函数一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T04:16:15.437

好吧，在重新阅读[这篇文章](http://support.microsoft.com/kb/205277)后，我发现了我的错误。这不是关于单独的 WIN32_FIND_DATAW 类型，而是需要将`FindFirstFileW`参数声明为`Long`and `ByVal`。

```
Private Declare Function FindFirstFileW Lib "kernel32" _
    (ByVal lpFileName As Long, _
    ByVal lpFindFileData As Long) As Long 
```

并且还需要用`StrPtr`and来调用它们`VarPtr`。

```
TestW = FindFirstFileW(StrPtr(sf), VarPtr(wfd)) 
```

# c++ - 将线程逻辑与业务逻辑解耦？

> ID：15694541
> 
> 赞同：2
> 
> 时间：2013-03-29T00:33:11.073
> 
> 标签：c++, multithreading, unit-testing, tdd

将线程逻辑与业务逻辑耦合是常见的做法吗？我问的是测试驱动开发，想知道测试与线程逻辑相关的商业智能是否有好处/缺点。考虑以下，

```
class Thread { ... }
class FooThread : public Thread {
  /* business intelligence coupled to threading */
} 
```

或者，

```
class Thread { ... }
class Foo {
  ...
  /* once again coupled */
  Thread th;
} 
```

这些方法似乎有点反对在测试类时尝试抽象依赖关系。是否可以/可以接受设计一个可以与线程完全分离的实例化类，也许可能使用模板？

```
template<class SomeFooClass>
class Thread { ... }

class Foo { 
  /* this class can be tested separately */
}

typedef Thread<Foo> FooThread; 
```

这有什么好处/缺点吗？是否可以使用相同的方法将业务逻辑与其他常见设计模式分离？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:53:43.700

线程和其他计算效果往往会让单元测试作者头疼。如果可以的话，请保持封装的线程管理远离您正在测试的业务逻辑。

如果您正在寻找有关如何做到这一点的想法，请考虑创建一个表示线程可能执行的工作的类型（这种类型可以是 Functor、成熟的类或者可能只是一个函数指针。）

将您的“纯”业务逻辑放在这种“可运行”类型的实例中，并在此接口上对其进行测试。然后，您可以实现一个可重用的线程池，该线程池（例如）接受队列中的这些可运行对象并执行每个。这种模式的许多变化是可能的；我建议查看 boost 库以找到现有的实现。

这种分离通常*不会*让您摆脱同步的负担，这通常是一个横切关注点。锁有一种滑入其他干净的业务逻辑的方法。您可以尝试通过模拟它们来处理它们，或者尝试通过序列化访问来完全消除锁定（根据具体情况），例如使用专用的“代理”线程和可运行的队列。

# ruby-on-rails - 孩子的 ActiveRecord 查询，按祖父母排序

> ID：15694552
> 
> 赞同：2
> 
> 时间：2013-03-29T00:34:24.327
> 
> 标签：ruby-on-rails, activerecord

我看到大量使用父元素上的属性进行排序的示例，但对于祖父母却没有。如果那里有另一篇详细说明这一点的帖子，我找不到它，也许是因为我不知道这个词。所以，这是我的理论模型：

```
class GrandParent < ActiveRecord::Base
    has_many :parents
    has_many :children, through: :parents
end

class Parent < ActiveRecord::Base
    belongs_to :grand_parent
    has_many   :children
end

class Child < ActiveRecord::Base
    belongs_to :parent
end 
```

所以，我试图提供一个孩子的名单，但我希望它按祖父母排序。

我正在尝试无用的事情，例如`Child.joins(:grandparent).order('grandparent.name').all`

但这不是为我做的。我已经尝试了一百种其他变体，但我不能说它们背后有多少逻辑……有人对这个有什么好的想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T17:25:29.940

你可以试试

```
Child.joins(:parent => :grand_parent).order('grand_parents.name') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:37:45.440

如果您不关心速度，则可以使用更明确的方式对这些对象进行排序，这种方式易于理解。尤其，

```
children.sort_by{|child| child.grand_parent.name} 
```

它没有使用完整的 SQL，如果你有很多 SQL 也不会很好`children`，但有时为了便于实施，值得优化。

# javascript - 使用 Rails 和 jQuery 动态渲染部分视图

> ID：15694554
> 
> 赞同：7
> 
> 时间：2013-03-29T00:34:35.500
> 
> 标签：javascript, jquery, ruby-on-rails

在我的应用程序中，我有一个用户个人资料页面，其中包含三个选项卡和一个空白 div。有一个默认选项卡为白色，另外两个选项卡较暗且“未选中”。

我想这样做，以便下面 div 中的内容根据选择的选项卡呈现部分内容。

我已经让它工作到了 jQuery 允许我单击不同的选项卡并在不刷新页面的情况下更改选项卡的颜色的地步。

但是，我坚持如何让部分正确渲染。对此有什么想法吗？我被困在如何根据在 jQuery 中选择的选项卡动态调用部分，实际上我不确定我是否需要另一个文件与之交互以使其工作。我在 Rails 应用程序中对 jQuery 比较陌生，所以我不确定我是否已经完成了我需要做的一切。

用户个人资料页面：app > views > show.html.erb

```
 <ul class="profile-tabs">    

        <%= link_to "<li class=\"tab selected\">Tab 1</li>".html_safe, userprofile_users_path, remote: true %>
        <%= link_to "<li class=\"tab\">Tab 2</li>".html_safe, userprofile_users_path, remote: true %>
        <%= link_to "<li class=\"tab\">Tab 3</li>".html_safe, userprofile_users_path, remote: true %>

    </ul>

<div id="profile-content">

<!--content goes here -->

</div> 
```

jQuery：应用程序 > 资产 > javascripts > userprofile.js

```
$(function() {
        $("li.tab").click(function(e) {
          e.preventDefault();
          $("li.tab").removeClass("selected");
          $(this).addClass("selected");
          $("#profile-content").html("<%= escape_javascript(render partial: 
"How can I make this partial name be generated based on the value of the selected li?")%>");
        });
    }); 
```

用户控制器：app > controllers > users_controller.rb

```
class UsersController < ApplicationController

def show
    @user = User.find(params[:id])
end

def userprofile
    respond_to do |format|
        format.js
    end
end
end 
```

三个选项卡对应三个部分，我需要 jQuery 以某种方式动态更改基于所选选项卡调用的部分。

我真的很感激这方面的一些帮助，或者如果有其他资源可以回答我的问题。我无法找到任何直接回答我正在尝试做的事情的东西。

更新 - - -

我使用了提供的解决方案 rails_has_elegance 但我所针对的 div 中没有出现任何内容。但是，我在 rails 服务器输出中看到了这一点，这似乎正在做我想做的事情：

```
Started GET "/users/currentoffers" for 127.0.0.1 at 2013-03-28 21:20:01 -0500
Processing by UsersController#currentoffers as JS
   Rendered users/_offers.html.erb (0.1ms)
   Rendered users/currentoffers.js.erb (0.8ms)
Completed 200 OK in 4ms (Views: 3.7ms | ActiveRecord: 0.0ms)
[2013-03-28 21:20:01] WARN  Could not determine content-length of response body. Set      content-length of the response or set Response#chunked = true 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T00:44:19.083

如果您想避免大量参数，只需在控制器中进行 3 个不同的操作，每个选项卡一个，每个选项卡都响应 js。然后为视图中的每个操作创建一个 [action].js.erb，如下所示：

```
$("#tab_content").html("<%= escape_javascript(render('tab1')) %>"); 
```

您实际上需要通过 ajax 请求与服务器通信，而您的 onclick 函数将预加载该部分，并且您不再有任何远程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T05:43:46.783

在具有 3 个不同选项卡的三个条件的控制器中编写一个操作。通过单击任何选项卡调用 ajax，传递身份参数说“tab1”或“tab2”或“tab3”，如果需要，还需要参数。在控制器中，获取参数并调用包含实际业务逻辑的模型函数。

在控制器中获取结果，并使用 js.erb 在所有 3 个选项卡下方的 div 中呈现部分内容

# java - 从结构数组中提取字段的 GenericUDF 函数

> ID：15694555
> 
> 赞同：1
> 
> 时间：2013-03-29T00:34:46.673
> 
> 标签：java, hadoop, hive, user-defined-functions, udf

我正在尝试编写一个 GenericUDF 函数来收集每个记录的数组中的所有特定结构字段，并将它们也返回到数组中。

我写了 GenericUDF（如下），它似乎可以工作，但是：

1）当我在外部表上执行此操作时它不起作用，它在托管表上工作正常，知道吗？

2）我很难为此编写测试。我已经附上了到目前为止的测试，但它不起作用，总是得到'java.util.ArrayList cannot be cast to org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector' or cannot cast String to LazyString'，我的问题是如何为 evalue 方法提供结构列表？

任何帮助将不胜感激。

桌子：

```
CREATE EXTERNAL TABLE FOO (  
  TS string,  
  customerId string,  
  products array< struct<productCategory:string> >  
)  
PARTITIONED BY (ds string)  
ROW FORMAT SERDE 'some.serde'  
WITH SERDEPROPERTIES ('error.ignore'='true')  
LOCATION 'some_locations'  
; 
```

一行记录保持：
`1340321132000, 'some_company', [{"productCategory":"footwear"},{"productCategory":"eyewear"}]`

这是我的代码：

```
import org.apache.hadoop.hive.ql.exec.Description;
import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
import org.apache.hadoop.hive.ql.exec.UDFArgumentLengthException;
import org.apache.hadoop.hive.ql.exec.UDFArgumentTypeException;
import org.apache.hadoop.hive.ql.metadata.HiveException;
import org.apache.hadoop.hive.ql.udf.generic.GenericUDF;
import org.apache.hadoop.hive.serde2.lazy.LazyString;
import org.apache.hadoop.hive.serde2.objectinspector.ListObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector.Category;
import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;
import org.apache.hadoop.hive.serde2.objectinspector.PrimitiveObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.StructField;
import org.apache.hadoop.hive.serde2.objectinspector.StructObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;
import org.apache.hadoop.hive.serde2.objectinspector.primitive.StringObjectInspector;
import org.apache.hadoop.io.Text;

import java.util.ArrayList;

@Description(name = "extract_product_category",
    value = "_FUNC_( array< struct<productcategory:string> > ) - Collect all product category field values inside an array of struct(s), and return the results in an array<string>",
    extended = "Example:\n SELECT _FUNC_(array_of_structs_with_product_category_field)")
public class GenericUDFExtractProductCategory
        extends GenericUDF
{
    private ArrayList ret;

    private ListObjectInspector listOI;
    private StructObjectInspector structOI;
    private ObjectInspector prodCatOI;

    @Override
    public ObjectInspector initialize(ObjectInspector[] args)
            throws UDFArgumentException
    {
        if (args.length != 1) {
            throw new UDFArgumentLengthException("The function extract_product_category() requires exactly one argument.");
        }

        if (args[0].getCategory() != Category.LIST) {
            throw new UDFArgumentTypeException(0, "Type array<struct> is expected to be the argument for extract_product_category but " + args[0].getTypeName() + " is found instead");
        }

        listOI = ((ListObjectInspector) args[0]);
        structOI = ((StructObjectInspector) listOI.getListElementObjectInspector());

        if (structOI.getAllStructFieldRefs().size() != 1) {
            throw new UDFArgumentTypeException(0, "Incorrect number of fields in the struct, should be one");
        }

        StructField productCategoryField = structOI.getStructFieldRef("productCategory");
        //If not, throw exception
        if (productCategoryField == null) {
            throw new UDFArgumentTypeException(0, "NO \"productCategory\" field in input structure");
        }

        //Are they of the correct types?
        //We store these object inspectors for use in the evaluate() method
        prodCatOI = productCategoryField.getFieldObjectInspector();

        //First are they primitives
        if (prodCatOI.getCategory() != Category.PRIMITIVE) {
            throw new UDFArgumentTypeException(0, "productCategory field must be of string type");
        }

        //Are they of the correct primitives?
        if (((PrimitiveObjectInspector)prodCatOI).getPrimitiveCategory() != PrimitiveObjectInspector.PrimitiveCategory.STRING) {
            throw new UDFArgumentTypeException(0, "productCategory field must be of string type");
        }

        ret = new ArrayList();

        return ObjectInspectorFactory.getStandardListObjectInspector(PrimitiveObjectInspectorFactory.writableStringObjectInspector);
    }

    @Override
    public ArrayList evaluate(DeferredObject[] arguments)
            throws HiveException
    {
        ret.clear();

        if (arguments.length != 1) {
            return null;
        }

        if (arguments[0].get() == null) {
        return null;
        }

        int numElements = listOI.getListLength(arguments[0].get());

        for (int i = 0; i < numElements; i++) {
            LazyString prodCatDataObject = (LazyString) (structOI.getStructFieldData(listOI.getListElement(arguments[0].get(), i), structOI.getStructFieldRef("productCategory")));
            Text productCategoryValue = ((StringObjectInspector) prodCatOI).getPrimitiveWritableObject(prodCatDataObject);
            ret.add(productCategoryValue);
        }
        return ret;
    }

    @Override
    public String getDisplayString(String[] strings)
    {
        assert (strings.length > 0);
        StringBuilder sb = new StringBuilder();
        sb.append("extract_product_category(");
        sb.append(strings[0]);
        sb.append(")");
        return sb.toString();
    }
} 
```

我的测试：

```
import org.apache.hadoop.hive.ql.metadata.HiveException;
import org.apache.hadoop.hive.ql.udf.generic.GenericUDF;
import org.apache.hadoop.hive.ql.udf.generic.GenericUDF.DeferredObject;
import org.apache.hadoop.hive.serde2.objectinspector.ListObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;
import org.apache.hadoop.hive.serde2.objectinspector.StructObjectInspector;
import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;
import org.testng.annotations.Test;

import java.util.ArrayList;
import java.util.List;

public class TestGenericUDFExtractShas
{
    ArrayList<String> fieldNames = new ArrayList<String>();
    ArrayList<ObjectInspector> fieldObjectInspectors = new ArrayList<ObjectInspector>();

    @Test
    public void simpleTest()
        throws Exception
    {
        ListObjectInspector firstInspector = new MyListObjectInspector();

        ArrayList test = new ArrayList();
        test.add("test");

        ArrayList test2 = new ArrayList();
        test2.add(test);

        StructObjectInspector soi = ObjectInspectorFactory.getStandardStructObjectInspector(test, test2);

        fieldNames.add("productCategory");
           fieldObjectInspectors.add(PrimitiveObjectInspectorFactory.writableStringObjectInspector);

        GenericUDF.DeferredObject firstDeferredObject = new MyDeferredObject(test2);

        GenericUDF extract_product_category = new GenericUDFExtractProductCategory();

        extract_product_category.initialize(new ObjectInspector[]{firstInspector});

        extract_product_category.evaluate(new DeferredObject[]{firstDeferredObject});
    }

    public class MyDeferredObject implements DeferredObject
    {
        private Object value;

        public MyDeferredObject(Object value) {
            this.value = value;
        }

        @Override
        public Object get() throws HiveException
        {
            return value;
        }
    }

    private class MyListObjectInspector implements ListObjectInspector
    {
        @Override
        public ObjectInspector getListElementObjectInspector()
        {
            return ObjectInspectorFactory.getStandardStructObjectInspector(fieldNames, fieldObjectInspectors);
        }

        @Override
        public Object getListElement(Object data, int index)
        {
            List myList = (List) data;
            if (myList == null || index > myList.size()) {
                return null;
            }
            return myList.get(index);
        }

        @Override
        public int getListLength(Object data)
        {
            if (data == null) {
                return -1;
            }
            return ((List) data).size();
        }

        @Override
        public List<?> getList(Object data)
        {
            return (List) data;
        }

        @Override
        public String getTypeName()
        {
            return null;  //To change body of implemented methods use File | Settings | File Templates.
        }

        @Override
        public Category getCategory()
        {
            return Category.LIST;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-29T00:44:09.380

我不能谈论测试，但是下面讨论了一个警告，我认为我有一个解决外部表问题的方法。

在使您的代码适应我的需要时，我在评估方法中将字符串更改为 long：

你的代码：

```
LazyString prodCatDataObject = (LazyString) (structOI.getStructFieldData(listOI.getListElement(arguments[0].get(), i), structOI.getStructFieldRef("productCategory")));
Text productCategoryValue = ((StringObjectInspector) prodCatOI).getPrimitiveWritableObject(prodCatDataObject); 
```

我的旧代码：

```
LazyLong indDataObject = (LazyLong) (structOI.getStructFieldData(listOI.getListElement(arguments[0].get(), i), structOI.getStructFieldRef(indexName)));
LongWritable indValue = ((LazyLongObjectInspector) indOI).getPrimitiveWritableObject(indDataObject); 
```

您可以看到它们是具有不同数据类型等的相同逻辑。

这对我来说适用于非外部表。不适用于外部表。

我可以通过用以下代码替换我的旧代码来解决这个问题：

```
long indValue = (Long) (structOI.getStructFieldData(listOI.getListElement(arguments[0].get(), i), structOI.getStructFieldRef(indexName))); 
```

在另一个版本中，我正在返回文本

您可能可以做类似的事情，即在第一步中转换为文本/字符串。

您可能还需要更改`public Text evaluate(DeferredObject[] arguments)`为`public Object evaluate(DeferredObject[] arguments)`.

[此处](https://github.com/chorbl/HiveUDFs/tree/master/src/main/java)提供了一些处理数组的工作 UDF 的源代码。

现在需要注意的是：这似乎不适用于存储为 ORC 的表。（请注意，原始代码也没有）。我可能会就此提出一个问题。我不确定问题是什么。

# php - ActionScript - 联系表单不起作用

> ID：15694556
> 
> 赞同：0
> 
> 时间：2013-03-29T00:34:52.233
> 
> 标签：php, flash, actionscript

我正在尝试调试在 Flash 中构建的联系表单，但我不确定如何进行调试。从 ActionScript 中，我可以看出它应该将结果发布到 /assets/files/functions.php。问题是，当我填写字段并单击“发送”（应该会触发此操作）时，什么也没有发生，我无法判断这是 PHP 问题还是 Flash 问题。

关于如何调试这个有什么想法吗？

可[在此处找到](http://nordicacondos.com/)该网站，点击“连接”，然后点击“发送查询”即可查看表格。

代码如下：

```
lvOut = new LoadVars();               //create lv object  
lvIn = new LoadVars();                //create lv object
lvIn.onLoad = function (success) {
if(success){
    gotoAndPlay("success");
}else{
    gotoAndPlay("failure");
}
}

function submit() {
if ( (inputName.text != "") && (inputAddress.text != "") && (inputCity.text != "") && (inputState.text != "") 
      && (inputCountry.text != "") && (inputTelephone.text != "") && (inputEmail.text != "") ) {
        lvOut.input_name = inputName.text;
        lvOut.input_address = inputAddress.text;
        lvOut.input_city = inputCity.text;
        lvOut.input_state = inputState.text;
        lvOut.input_zip = inputZip.text;
        lvOut.input_country = inputCountry.text;
        lvOut.input_telephone = inputTelephone.text;
        lvOut.input_email = inputEmail.text;
        lvOut.input_bedrooms = inputBedrooms.text;
        lvOut.input_realtor = inputRealtor.text;
        lvOut.input_comments = inputComments.text;

        if (realtorYes) {
            lvOut.input_hasRealtor = "yes";
        } else if (realtorNo) {
            lvOut.input_hasRealtor = "no";
        } else {
            lvOut.input_hasRealtor = "no answer";
        }       

        //send vars to functions page and load in result 
        lvOut.sendAndLoad("assets/files/functions.php", lvIn, "POST"); 
}
}

btnSend.addEventListener("click", submit); 
```

请尽可能帮助我！:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T11:28:26.960

您的 Flash 应用程序有问题：它什么也没发送。我刚刚使用 Chrome 进入了您所说的网页，并在“开发者工具”菜单中打开了“网络”选项卡。它在“发送”按钮单击时捕获了 0 个请求。我不知道 AS2（saveAndLoad 是 AS2 方法），所以我不能说出了什么问题，但这 是 AS3 中 POST 请求[的](http://www.hardcode.nl/archives_9/article_442-post-request-data-in-as3.htm) 一个工作示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T11:41:28.523

`URLLoader`尝试通过使用类来采取不同的方法。我假设您的functions.php 文件在线某个地方。

```
const SITE_DOMAIN:String = "PUT_YOUR_SITE_DOMAIN_HERE_UP_TO_ASSETS_FOLDER";
var loader = new URLLoader();
loader.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityErrorHandler);
loader.addEventListener(Event.COMPLETE, loadCompleteHandler);

request = new URLRequest();
request.url = SITE_DOMAIN + "assets/files/functions.php";
request.method = URLRequestMethod.POST;
loader.load(request);

function loadCompleteHandler(event:Event):void
{
    // handle load complete
}

function securityErrorHandler(event:SecurityErrorEvent):void
{
    // handle security error
}

function ioErrorHandler(event:IOErrorEvent):void
{
    // handle io error
} 
```

希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T11:41:03.280

您的 PHP 脚本中有一个错误：http: [//nordicacondos.com/assets/files/functions.php](http://nordicacondos.com/assets/files/functions.php) 修复它，然后在您的 AS 代码中尝试一些跟踪以查看发送到 PHP 的内容。

1.  通过在内部添加跟踪来检查您对非空值的测试是否有效（我认为您的问题在这里，因为即使所有字段都已填充，您的 swf 也不会发送任何内容）
2.  发送前检查 lvOut 对象的内容，在 AS2 中可以这样浏览内容

> ```
> for (var name in lvOut) {
>   trace(name +'->' + lvOut[name]);
> } 
> ```

将完整路径添加到 PHP 脚本，以便您可以从 Flash IDE 进行测试。

1.  在 lvIn onLoad 处理程序中添加一个跟踪以检查它是否被触发

您还可以通过记录原始请求来检查 PHP 端，如下所示：

```
$handle = fopen('log.txt', 'ab+');
fwrite($handle, print_r($_REQUEST, true) );
fwrite($handle, PHP_EOL);
fclose($handle); 
```

确保您对 functions.php 目录具有写入权限。

当然使用 AS3 会提供更好的控制... :)

# actionscript-3 - 永远无法通过加载程序访问嵌入的 SWF 内容

> ID：15694557
> 
> 赞同：0
> 
> 时间：2013-03-29T00:35:07.147
> 
> 标签：actionscript-3, air

我正在嵌入一个 SWF，它只是使用 InDesign 创建的转换后的 PDF。SWF 为 15 页，每帧 1 页。它*确实*包含 TLF 文本，除非文档完全在 Flash 中重新创建，否则无法解决。问题是当我将 SWF 加载到我的应用程序中时，我永远无法访问根 MovieClip。

```
this.loader = new Loader();
this.loader.contentLoaderInfo.addEventListener( Event.INIT, this.loaderInitHandler );
this.loader.contentLoaderInfo.addEventListener( Event.COMPLETE, this.loaderInitHandler );
this.loader.load( new URLRequest( "assets/doc.swf" ) ); 
```

当我在 INIT 和 COMPLETE 事件之后以及稍后通过在调试模式下停止应用程序来查看加载程序时，我没有看到 MovieClip。相反，`loader.content`is 的类型`doc_fla.MainTimeline__Preloader__`包含两个孩子，一个是空的`Shape`，另一个是`Loader`。该加载程序在检查 INIT 和 COMPLETE 事件时会导致完全相同的情况，并且它似乎是一个永无止境的加载程序行，其内容是“预加载程序”。

任何人都可以阐明是什么原因造成的，或者我可以如何解决它？我已经花了 2 个小时来解决这个问题，但我并不比开始时更接近解决方案。

*   ActionScript 移动项目
*   使用 AIR 3.6 编译
*   在模拟器以及 iPad 和 Nexus 7 上进行测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T19:32:50.123

我重新编译了 SWF 并在其中嵌入了 TLF 库（在 ActionScript 设置下，只需设置已经嵌入的 TLF swc），这似乎已经解决了这个问题。我发誓我之前尝试过没有成功，但这次成功了。

# c++ - C++ 项目和库的正确结构

> ID：15694561
> 
> 赞同：1
> 
> 时间：2013-03-29T00:35:35.693
> 
> 标签：c++, oop, compilation, g++

我开始编写我的数据处理库，并且对构建项目和库的正确结构感到非常困惑。

说，我想在 myfunclib 库中存储一组函数。我当前的设置（取自多个在线建议）如下所示：

myproj/include/myfunclib.h - 类声明 myproj/include/myfunclib.cpp - 类功能 myproj/src/functest.cpp - 用于检查功能的测试文件

首先，感觉这是一个正确的设置，以防我将 myfunc 仅用于 myproj 项目，但说我想重用它 - 然后我需要在每个使用它的 cpp 文件中指定它的路径或存储多个副本它。

其次，在这种情况下编译有点笨重：

```
g++ -I include include/myfunclib.cpp src/functest.cpp 
```

每次都输入所有这些东西是正常的做法吗？如果我需要很多自定义库怎么办？有没有办法单独存储它们，只需包含为“myfunclib.h”而不用担心重新编译等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T02:39:37.117

一些原本咬我的东西，

请记住，模板类只应包含在内，通常源实现不应像普通类实现那样构建到目标文件中，所以通常我将整个模板实现放在包含目录中

我将包含和源文件分开，源文件是指需要编译为目标文件以进行链接的代码（定义），包括所有声明、内联函数等，这对我来说似乎更有意义

有时我会有一个头文件，其中包含特定模块的所有相关头文件，反过来可能还有一个更高的头文件，其中包含我正在使用的模块的所有主要头文件

也如评论中所说，您需要向自己介绍一些构建工具，并熟悉它们，这些将帮助您跟踪项目中的依赖关系，并且在大多数情况下，当只有一部分依赖关系发生更改时，避免重新构建整个项目（这在开始时可能会很痛苦，但值得学习，如果您使用 make 和 g++，则有一种方法可以使用 g++ -MM 来实现这一点......不确定它在所有情况下的效果如何），我知道我组织项目的方式发生了巨大变化，我对构建过程的了解越多，我的项目变得越复杂（我必须修复的缺陷也越多）

这就是我通常在开始时保持项目目录结构的方式

```
build - where all the built files will be stored
app - these are the main apps (can also be split into include/src)
include - includes files
src - src files (compiled into objects and then linked with main compiled app)
lib - any libs (usually 3rdparty libs , if any my src is compiled into a library it usually ends up in build/lib/target/... ) 
```

希望有些帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T03:50:54.643

使用 makefile 来处理所有依赖项并构建代码。谷歌语法很简单。然后你可以在命令行上说“make”，它会为你构建一切。

这是一个很好的教程 [http://mrbook.org/tutorials/make/](http://mrbook.org/tutorials/make/)

# ios - cocos2d中如何在不同的CCSpriteBatchNode之间切换精灵

> ID：15694562
> 
> 赞同：1
> 
> 时间：2013-03-29T00:35:42.927
> 
> 标签：ios, cocos2d-iphone, sprite

我在 cocos2d 中制作游戏，我有一个使用 CCSprite 的鸡作为角色。这只鸡有多个图像做不同的动作。

有太多的动作图像，我不得不为精灵使用多个 plist 文件。

我的问题是我可以在不同的精灵之间切换

```
 [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:
     @"chicken-1to3.plist"];

    [[CCSpriteFrameCache sharedSpriteFrameCache] addSpriteFramesWithFile:
     @"chicken-4to5.plist"];

    spriteSheet1to3 = [CCSpriteBatchNode
                                      batchNodeWithFile:@"chicken-1to3.png"];
    spriteSheet4to5 = [CCSpriteBatchNode
                                      batchNodeWithFile:@"chicken-4to5.png"];
    [self addChild:spriteSheet1to3 z:1];
    [self addChild:spriteSheet4to5 z:2];

    NSMutableArray *chickenManAni1Imgs = [NSMutableArray array];
    NSMutableArray *chickenManAni2Imgs = [NSMutableArray array];
    NSMutableArray *chickenManAni3Imgs = [NSMutableArray array];
    NSMutableArray *chickenManAni4Imgs = [NSMutableArray array];
    NSMutableArray *chickenManAni5Imgs = [NSMutableArray array];

    for(int i = 1; i <= 9; ++i) {
        [chickenManAni1Imgs addObject:
         [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
          [NSString stringWithFormat:@"chicken-1-%d.png", i]]];
    }
    for(int i = 1; i <= 19; ++i) {
        [chickenManAni2Imgs addObject:
         [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
          [NSString stringWithFormat:@"chicken-2-%d.png", i]]];
    }
    for(int i = 1; i <= 21; ++i) {
        [chickenManAni3Imgs addObject:
         [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
          [NSString stringWithFormat:@"chicken-3-%d.png", i]]];
    }
    for(int i = 1; i <= 16; ++i) {
        [chickenManAni4Imgs addObject:
         [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
          [NSString stringWithFormat:@"chicken-4-%d.png", i]]];
    }
    for(int i = 1; i <= 36; ++i) {
        [chickenManAni5Imgs addObject:
         [[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:
          [NSString stringWithFormat:@"chicken-5-%d.png", i]]];
    }

    chickenManAni1 = [CCAnimation
                   animationWithSpriteFrames:chickenManAni1Imgs delay:0.04f];
    chickenManAni2 = [CCAnimation
                      animationWithSpriteFrames:chickenManAni2Imgs delay:0.04f];
    chickenManAni3 = [CCAnimation
                      animationWithSpriteFrames:chickenManAni3Imgs delay:0.04f];
    chickenManAni4 = [CCAnimation
                      animationWithSpriteFrames:chickenManAni4Imgs delay:0.04f];
    chickenManAni5 = [CCAnimation
                      animationWithSpriteFrames:chickenManAni5Imgs delay:0.04f];

    chickenMan = [CCSprite spriteWithSpriteFrameName:@"chicken-5-1.png"];
    chickenMan.position = ccp(winSize.width/2, winSize.height/2);

    [spriteSheet4to5 addChild:chickenMan];

    [chickenMan runAction:[CCRepeatForever actionWithAction:
                          [CCAnimate actionWithAnimation:chickenManAni5 restoreOriginalFrame:NO]]];
    chickenManAniRunning = 1; 
```

这是我尝试更改精灵时的代码

```
 [chickenMan stopAllActions];
        [spriteSheet4to5 removeChild:chickenMan cleanup:YES];
        [spriteSheet1to3 addChild:chickenMan];

        [chickenMan runAction:[CCRepeatForever actionWithAction:
                               [CCAnimate actionWithAnimation:chickenManAni2 restoreOriginalFrame:NO]]]; 
```

之后我收到此错误： **'CCSprite 未使用相同的纹理 ID'**

**更新**：我正在使用两个不同的精灵：

```
 chickenMan1to3 = [CCSprite spriteWithSpriteFrameName:@"chicken-1-1.png"];
    chickenMan1to3.position = ccp(winSize.width/2, winSize.height/2);
    [chickenMan1to3 setVisible:YES];

    chickenMan4to5 = [CCSprite spriteWithSpriteFrameName:@"chicken-5-1.png"];
    chickenMan4to5.position = ccp(winSize.width/2, winSize.height/2);
    [chickenMan4to5 setVisible:NO]; 
```

我这样切换它们：

```
 [chickenMan1to3 stopAllActions];
        [chickenMan1to3 setVisible:NO];
        [chickenMan4to5 setVisible:YES];
        [chickenMan4to5 runAction:[CCRepeatForever actionWithAction:
                                   [CCAnimate actionWithAnimation:chickenManAni4 restoreOriginalFrame:NO]]]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T09:02:50.557

使用两个精灵，每个批处理节点一个。从另一个批处理节点切换到动画时，将动画精灵设置为可见并隐藏另一个。为了让它们同步动画，将两个精灵添加到一个 ccnode，然后就位置、动作和其他逻辑而言，它将代表你的鸡角色。

如果鸡是批处理节点中唯一的精灵子节点，您可以简单地删除批处理节点，因为批处理仅在您拥有相同精灵和纹理的多个实例时才有帮助。

# django - 使用类似于 Rails JST 的 Django 管道分配主干模板？

> ID：15694564
> 
> 赞同：3
> 
> 时间：2013-03-29T00:35:56.603
> 
> 标签：django, backbone.js, marionette, django-pipeline

我正在 Django 之上构建一个大型 Backbone Marionette 应用程序，利用 Django 资产管道来编译所有资产。

现在，我将 Handlebars 模板保存为 app 对象中的 JS 字符串，如下所示：

```
App.Templates.Header = '
<div id="header">
  ... header stuff ...
</div>
'

class App.Views.Header extends Backbone.Marionette.ItemView
  template: App.Templates.Header 
```

我不确定将模板保存到 JS 字符串中是否真的是最好的方法。使用 Rails，您可以保存模板文件并使用 JST 在文件结构中直接引用它们：

```
template: JST['apps/base/templates/header'] 
```

我的理解是这是一个融入 Rails 的特性。Django可以做到这样的事情吗？或者，是否有另一种更有效的方式来处理我的模板？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T18:57:44.050

这个特性实际上是作为[JavaScript Templates内置在](https://django-pipeline.readthedocs.org/en/latest/templates.html)[Django Pipeline](https://django-pipeline.readthedocs.org/en/latest/index.html)中的。

基本上，您定义用于处理模板（Mustache、Handlebars、Prototype 或 JST）的函数，然后定义存储这些模板的全局命名空间以及编译器用来确定要添加到该模板对象的文件的扩展名。

# vba - 列表和动态更新

> ID：15694565
> 
> 赞同：-2
> 
> 时间：2013-03-29T00:36:02.770
> 
> 标签：vba, excel, excel-2010

有没有办法让我列出清单。我正在尝试制作一个评论日志，其中包括名称---日期---评论。我将有3本工作簿。两个工作簿将有两个不同的名称、日期和评论列表，然后我希望第三个工作簿根据日期将这些列表收集到一个主列表中。我将如何为此编写宏？我了解 VBA 记录器。我的问题是列表的大小未确定。例如，一本书可能有 5 条评论，而第二本书可能有 3 条评论。我希望主列表根据输入的日期按顺序排列 8 个评论日志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T07:29:15.827

哎呀，反正我觉得无聊。我在您发布最新评论之前写了这篇文章，但是如果您有动态范围，您可以在我使用 CurrentRegion 属性作为源的任何地方替换这些范围的名称。看看你能不能遵循这个；它至少应该为您指明正确的方向。

```
Sub CombineLists2()

    Dim rng_Source As Excel.Range
    Dim rng_Target As Excel.Range

    Dim wbk_1 As Excel.Workbook
    Dim wbk_2 As Excel.Workbook
    Dim wbk_3 As Excel.Workbook

    On Error GoTo ErrorHandler

    'I'd recommend doing a test here to ensure that
    'all three workbooks are open, which is one reason
    'that we're using object variables.
    'If one of the workbooks isn't open then it'll throw an error.
    'Obviously change the names to your own files.
    Set wbk_1 = Application.Workbooks("ATeam.xlsx")
    Set wbk_2 = Application.Workbooks("BTeam.xlsx")
    Set wbk_3 = Application.Workbooks("CTeam.xlsm")

    'You may want to delete any contents that are in the combined book first.
    wbk_3.Worksheets(1).Range("A1").CurrentRegion.Clear

    'We'll now get a reference to the range containing the list.
    'You'll obviously have to change the references to suit where
    'your list is.
    'In this case we'll take the headings as well.
    'Note that CurrentRegion range will only work if there
    'is nothing directly adjacent to the list.
    wbk_1.Worksheets(1).Range("A1").CurrentRegion.Copy _
     Destination:=wbk_3.Worksheets(1).Range("A1")

    'That's the first workbook done.
    'The second one we may need to tweak a little because we
    'don't want the headings this time.
    'I'm going to use a range reference for this so that
    'it'll be a little more transparent than doing it in one go.

    'First we grab the whole list range including headings, just
    'as we did for the first list.
    Set rng_Source = wbk_2.Worksheets(1).Range("A1").CurrentRegion

    'Next, we offset that by 1 row and shrink the size of it by
    '1 row to get rid of the headings.
    Set rng_Source = rng_Source.Offset(1, 0) _
     .Resize(rng_Source.Rows.Count - 1, rng_Source.Columns.Count)

    'I'll use another range to get the location of the existing list
    'in the combined workbook.
    Set rng_Target = wbk_3.Worksheets(1).Range("A1").CurrentRegion

    'Now we copy the second list and paste it to one cell below that range
    rng_Source.Copy Destination:=rng_Target.Offset(rng_Target.Rows.Count, 0)

ExitPoint:

On Error Resume Next

Set wbk_3 = Nothing
Set wbk_2 = Nothing
Set wbk_1 = Nothing
Set rng_Source = Nothing
Set rng_Target = Nothing

On Error GoTo 0

Exit Sub

ErrorHandler:

MsgBox "Error " & Err.Number & vbCrLf & Err.Description

Resume ExitPoint

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:13:18.023

本着鼓励尝试问题的 StackOverflow 精神，我提出以下建议。

你熟悉宏记录器吗？（它位于“开发人员”选项卡上（您可能需要在 Excel 功能区选项中显示该选项卡）。）

如果您手动记录执行此操作的操作，宏记录器将生成您需要的 90% 的代码。

其余的将涉及您简单地用动态引用（例如 CurrentRegion）替换硬编码的范围引用以获取列表的内容。如果您坚持这样做，请务必再次发布。

我建议您将宏记录在第三个（目标）工作簿中，以便它可以简单地从源工作簿中吸取内容。

# javascript - Javascript检测关闭弹出窗口加载另一个域

> ID：15694567
> 
> 赞同：23
> 
> 时间：2013-03-29T00:36:14.007
> 
> 标签：javascript, popup, onbeforeunload

我正在打开一个弹出窗口并将 onbeforeunload 事件附加到它，如下所示：

```
win = window.open("http://www.google.com", "", "width=300px,height=300px");
win.onbeforeunload = function() {
    //do your stuff here
    alert("Closed");
}; 
```

如果我将 URL 留空，新的弹出窗口将以“about:blank”作为地址打开，但是当我关闭它时，我会看到警报。

如果我按照您看到的方式打开（使用外部 URL），一旦关闭，我就再也看不到警报了。知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-07-19T10:47:09.907

如前所述，同源策略会阻止 Javascript 检测此类事件。但是有一个非常简单的解决方案可以让您检测到此类窗口的关闭。

这是JS代码：

```
var openDialog = function(uri, name, options, closeCallback) {
    var win = window.open(uri, name, options);
    var interval = window.setInterval(function() {
        try {
            if (win == null || win.closed) {
                window.clearInterval(interval);
                closeCallback(win);
            }
        }
        catch (e) {
        }
    }, 1000);
    return win;
}; 
```

它的作用：它使用提供的参数创建新窗口，然后以 1s 的间隔设置检查器功能。然后该函数检查窗口对象是否存在并将其关闭属性设置为 false。如果其中任何一个不正确，这意味着窗口（可能）已关闭，我们应该触发“closeCallback 函数”回调。

此功能应适用于所有现代浏览器。前段时间 Opera 在从其他域的窗口检查属性时导致错误 - 因此 try..catch 块。但是我现在已经对其进行了测试，它似乎工作得很好。

我们使用这种技术为那些不通过 SDK 支持的网站创建了“facebook 风格”的登录弹出窗口（ehem...Twitter...ehem）。这需要一些额外的工作——我们无法从 Twitter 本身获得任何消息，但 Oauth 将我们重定向回我们的域，然后我们能够将一些数据放入可从打开器访问的弹出窗口对象中。然后在关闭回调函数中，我们解析这些数据并呈现实际结果。

此方法的一个缺点是在窗口关闭后调用回调。好吧，这是我能够通过跨域策略实现的最佳效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-02T15:46:53.530

您可以收听打开窗口的“焦点”事件，该事件在用户关闭弹出窗口时触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T04:18:26.573

不幸的是，您正在尝试跨域进行通信，这被 JavaScript 的[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)所禁止。您必须使用服务器端代理或其他一些丑陋的黑客来绕过它。

您可以尝试在您的网站上创建一个页面，在 iframe 中加载外部网站。然后，您可以打开该页面并听它卸载。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-30T01:42:46.410

我将[@ThomasZ 的](https://stackoverflow.com/users/223668/tomasz-struczy%C5%84ski)答案与[这个](https://stackoverflow.com/questions/2956966/javascript-telling-setinterval-to-only-fire-x-amount-of-times)答案结合起来设置了一个间隔限制（不想使用 setTimeout）。

示例（在 Typescript 中，匿名声明以免丢失对“this”的引用）：

```
 private _callMethodWithInterval = (url: string, callback: function, delay: number, repetitions: number) => {      
    const newWindow = window.open(url, "WIndowName", null, true);

    let x = 0;
    let intervalID = window.setInterval(() => {
      //stops interval if newWindow closed or doesn't exist
      try {
        if (newWindow == null || newWindow.closed) {
          console.info("window closed - interval cleared")
          callback();
          window.clearInterval(intervalID);
        }
      }
      catch (e) {
        console.error(`newWindow never closed or null - ${e}`)
      }
      //stops interval after number of intervals
      if (++x === repetitions) {
        console.info("max intervals reached - interval cleared")        
        window.clearInterval(intervalID);
      }
    }, delay)
  }//end _callMethodWithInterval 
```

# c# - 程序集版本“.001”变为“.1”

> ID：15694568
> 
> 赞同：7
> 
> 时间：2013-03-29T00:36:17.650
> 
> 标签：c#, .net, assemblyversionattribute

在 WinForms 我有一个 AssemblVersion

```
[assembly: AssemblyVersion("01.01.01.002")] 
```

但是，当启动画面出现时，它会完全忽略显示的零：

```
1.1.1.2 
```

作为非常不方便的版本，因为以后我实际上想要一个汇编版本

```
 [assembly: AssemblyVersion("01.01.01.200")] 
```

有没有办法避免这种情况，或者我必须在版本的最后一部分的开头添加一些数字，如下所示：

```
[assembly: AssemblyVersion("01.01.01.102")] 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-29T00:38:21.660

该`AssemblyVersion`属性将其信息存储为[`Version`](http://msdn.microsoft.com/en-us/library/system.version.aspx)对象。结构的组件`Version`是整数，并被视为整数。所以`1.2.3.4 == 1.02.003.004`但是`1.2.3.4 != 1.2.3.400`

您可以使用[`AssemblyInformationalVersionAttribute`](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyinformationalversionattribute.aspx)来提供有关您的产品的其他任意格式的信息，因为它的信息存储为`string`. 而不是`Version`. 所以你可以这样做：

```
[assembly: AssemblyVersion("1.1.1.102")]
[assembly: AssemblyInformationalVersion("v.01 alpha")] 
```

或者任何你喜欢的

# numpy - 如何在 scikit-learn 中加载分类属性？

> ID：15694571
> 
> 赞同：1
> 
> 时间：2013-03-29T00:37:04.577
> 
> 标签：numpy, scipy, scikit-learn

我想在 scikit-learn 中创建一个贝叶斯模型来预测电影的票房开局。

我从 scikit learn 开始，我发现了许多关于如何加载 CSV 和其他表数据的示例，但我还没有找到关于如何加载具有值集合的属性的示例，例如：

```
Movie 1: Actors: [Actor 1, Actor 2, Actor 3...], etc. 
```

谁能给我一个提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T15:19:12.637

[`DictVectorizer`](http://scikit-learn.org/stable/modules/feature_extraction.html#loading-features-from-dicts)是处理尚未编码为 Numpy 数组的分类数据的首选方式。对于每个样本，您可以构建一堆看起来像

```
[{'Tom Hanks': True, 'Halle Berry': True},
 {'Tom Hanks': True, 'Kevin Bacon': True}] 
```

等。键必须是字符串；这些值可以是字符串（使用 one-of-k 编码扩展）、布尔值或数字。`DictVectorizer`然后将这些 dicts 转换为可以馈送到学习算法的矩阵。该矩阵将在整个输入集中每个演员（或其他电影特征）有一列。字典/样本中没有出现的特征的隐含值为零。

# c - 如何将本地端口号分配给套接字？

> ID：15694574
> 
> 赞同：1
> 
> 时间：2013-03-29T00:37:11.280
> 
> 标签：c, sockets, network-programming

我在 localhost 的 1234 端口创建了一个服务器。在客户端代码中，我启动了一个`struct sockaddr_in server_addr`并填写了服务器的 IP 地址和端口号。当我尝试将客户端连接到服务器时，我得到“地址已在使用中”：

> 绑定（client_sockfd，server_addr，sizeof server_addr）

所以操作系统认为我试图创建另一个具有相同地址和端口号的服务器套接字。在这种情况下，我如何告诉操作系统 server_addr 是我要连接的另一个端点并且它为客户端的套接字找到另一个端口号？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:41:51.643

您`bind()`只需要用于服务器和在客户端使用

`int connect(int socket, const struct sockaddr *address, socklen_t address_len);`.

有关 Linux 中套接字的信息，请参阅本教程：

[http://www.linuxhowtos.org/C_C++/socket.htm](http://www.linuxhowtos.org/C_C++/socket.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T00:42:30.453

您使用 connect(client_sockfd, server_addr, sizeof(..)) 告诉操作系统我的客户端套接字应该连接到该服务器地址。

如果是 UDP 套接字，你也可以使用 sendto(client_sockfd, ... server_addr) 调用来指定数据包应该去这个服务器地址。

# jquery - jquery .on() 双击传数据

> ID：15694576
> 
> 赞同：1
> 
> 时间：2013-03-29T00:37:24.460
> 
> 标签：jquery, javascript-events, event-handling

使用时

```
$(document).on('dblclick', '#selector_id', {form_key:10}, my_function)

my_function = function(){
    console.log(event)
} 
```

[根据文档](http://api.jquery.com/on)，我希望能够从中`form_key`检索`event.data`

但是，在这种情况下，我得到一个`MouseEvent`, 而不是`Event`，并且它没有`data`属性。

我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-29T00:39:27.330

添加您尝试使用的参数，它可能有效：

```
$(document).on('dblclick', '#selector_id', {form_key:10}, my_function)

function my_function(event){ // <- event
    console.log(event)
} 
```

请记住，传递的数据在 event.data 中可用，例如：

```
event.data.form_key 
```

[**小提琴**](http://jsfiddle.net/wnvs8/)

# objective-c - 如何在 Cocoa 中使表格视图不可编辑

> ID：15694578
> 
> 赞同：0
> 
> 时间：2013-03-29T00:37:30.327
> 
> 标签：objective-c, xcode, cocoa

我从库中拖了一个表视图，并链接了数据源和委托，它工作。但是当应用程序运行时，我可以双击表格中的行，并在其中实际输入一些单词。我只是希望它是不可编辑的。我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:15:38.207

实现以下将返回 NO 的委托方法

```
- (BOOL)tableView:(NSTableView *)aTableView shouldEditTableColumn:(NSTableColumn *)aTableColumn row:(NSInteger)rowIndex
{
    return NO;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T09:47:38.860

您可以取消选中 xib 文件中表列属性中的可编辑按钮。 ![在此处输入图像描述](../Images/2af4f4a0106bda98a54ed7ce72687081.png)

# java - 可以在一个应用程序中创建两人客户端-服务器游戏吗？

> ID：15694579
> 
> 赞同：0
> 
> 时间：2013-03-29T00:37:45.017
> 
> 标签：java, android, networking, client

我正在为安卓创建一个战舰类型的游戏。我没有合适的设备，所以我使用了 2 个模拟器实例，但只有一个项目。我有基本的机制工作，但是什么是用于网络的好结构，以便在每个模拟器上显示不同的东西？

例如，如果玩家 1 在方格 D2 上击中玩家 2，它只会在一个屏幕上被明显摧毁。我需要多项活动吗？我将如何区分模拟器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:42:09.283

好吧，首先，您将需要某种服务器来处理玩家之间的连接。然后该服务器可以指定游戏中的哪个玩家。我不确定您正在寻找什么答案——正确的答案必须包括多人游戏的整个架构。

# asp.net - 可以让 iisnode 下的 NodeJS 应用程序使用 ASP.NET FormsAuthentication 进行身份验证吗？

> ID：15694581
> 
> 赞同：11
> 
> 时间：2013-03-29T00:37:46.107
> 
> 标签：asp.net, forms-authentication, restful-authentication, formsauthentication, iisnode

1) 我们有一个需要在 IIS 7.5/Win2k8 R2 下托管的 NodeJS 应用程序。
2) 我们有其他应用程序已经使用 ASP.NET FormsAuthentication。3) 将使用 NodeJS 应用程序的用户与现有应用程序的用户是相同的用户。

因此，我们将 FormsAuthentication 配置设置放在 web.config 中，IIS 正在读取它：

**[ IIS > 站点 > {iisnode-site} > 身份验证]** - 还不能发布图片！

但是，它完全忽略了配置 - 所以我认为可能在 FormsAuthentication 模块之前调用了 iisnode 模块，但是当我查看模块列表（有序视图）时，它在该站点的底部列出了 iisnode，而 FormsAuthentication 模块在上面列出iis节点。

这甚至可能吗？我在另一篇文章[@Intercept requests for iisnode with HttpModule](https://stackoverflow.com/questions/13165404/intercept-requests-for-iisnode-with-httpmodule)上看到，这可能是解决方法，但这种方法意味着我们需要滚动一个 XHR 标头代理（各种）——我们可以这样做，但作为最后的手段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-03T11:25:18.077

在 IIS 管理器中，转到模块，找到 FormsAuthentication 模块并取消选中“仅对 ASP.NET 应用程序或托管处理程序的请求调用”。

来自：[IIS7 - 使表单身份验证适用于所有请求](http://blogs.msdn.com/b/rakkimk/archive/2007/11/28/iis7-making-forms-authentication-to-work-for-all-the-requests.aspx)

# javascript - 从特定数据属性中获取值

> ID：15694583
> 
> 赞同：0
> 
> 时间：2013-03-29T00:37:52.637
> 
> 标签：javascript, jquery, onclick

我正在尝试建立一个使用数据值来保存事件类型的跟踪系统。我的 HTML 如下所示：

```
<a href="#articles" class="track" data-track="article_search_results">Articles</a>
<a href="#books" class="track" data-track="books_search_results">Books</a>
<a href="#notes" class="track" data-track="notes_search_results">Notes</a> 
```

JQuery 看起来像这样：

```
$(document).delegate('.track', 'click', function(e) {   
    console.log($(this));
    console.log($(this).data("track")); 
}); 
```

使用具有类 .track 的每个元素，我试图从中获取数据跟踪值，但它总是返回未定义的。我究竟做错了什么？

**更新**

我的代码中有导致问题的图标：

```
<a href="#articles" class="track" data-track="article_search_results"><i class="icon-pencil"></i></a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:39:42.460

尝试这个

```
 $(document).delegate('.track', 'click', function(e) {   
                console.log($(this).attr("data-track")); 
           }); 
```

JsFiddle：http: [//jsfiddle.net/FZEKC/](http://jsfiddle.net/FZEKC/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:39:51.163

使用`attr`，您可以`data-track`从元素返回值，例如：

**代码：**

```
$(document).on('click', '.track', function(e) {   
    var dataTrack = $(this).attr("data-track");
}); 
```

*根据 jQuery 文档，`delegate`已被 取代`on`，以上是使用的示例`on`*

或者，在您的情况下，您可能只使用该`click`功能，我觉得它更整洁，但取决于您：

```
$(".track").click(function(e) {   
    var dataTrack = $(this).attr("data-track");
}); 
```

**小提琴：**

使用`on`：http:
[//jsfiddle.net/jUSUK/1/](http://jsfiddle.net/jUSUK/1/)

使用`click`：http:
[//jsfiddle.net/jUSUK/2/](http://jsfiddle.net/jUSUK/2/)

**更多信息`attr`：**

[http://api.jquery.com/attr/](http://api.jquery.com/attr/)

# java - 查找项目中某个类的所有调用方法

> ID：15694585
> 
> 赞同：1
> 
> 时间：2013-03-29T00:38:04.013
> 
> 标签：java, eclipse, code-analysis

在重构 Java 项目的大部分过程中，我试图了解我的项目使用了多少特定库类的方法。`Ctrl`在 Eclipse 中，我可以使用++`Shift`打开方法的调用层次结构`H`，这正是我想要的，但只针对单个方法。另一方面，我可以使用 ++（或在项目中通过右键单击上下文菜单）在我的工作区中找到对给定类的所有引用`Ctrl`，`Shift`但`G`没有任何关于如何使用类或对象的信息。

换句话说，我似乎正在尝试找到一个将两者结合起来的功能 - 查找对一个类的所有引用，然后在该引用范围内对该类或对象调用哪些方法（如果有）。Eclipse（或任何其他（免费）IDE）中是否存在这样的功能？

编辑：我意识到这个问题可能有点神秘，所以这里是基本思想的伪代码描述：

```
findMethodCalls(Class c)
1\.   result = empty list of method names
2\.   for each method m in c
3\.     if "Open Call Hierarchy" for m is non-empty
4\.       result.add(m);
5\.   return result; 
```

# css - 相对内的绝对定位

> ID：15694589
> 
> 赞同：4
> 
> 时间：2013-03-29T00:38:24.330
> 
> 标签：css

我正在使用 100% 宽度的相对定位，但需要一个绝对定位的子 div 或 span 来容纳 jquery 图像滑块。

布局

------ 宽度 100%------

| 图片1 | 滑块 | 图片2 |

目前，滑块跨度没有像其他对象一样内联定位并且重叠

到目前为止我所拥有的：

**[小提琴](http://jsfiddle.net/44MFH/)**

**HTML**

```
<div class="pic_container">
    <img src="http://www.image-and-text.com/pictures/whiskey_with_ice.jpg">  
    <span class="viewer"> 
       <img src="http://images.printsplace.co.uk/Content/Images/Products/46576/43569/Image_of_M101_1.jpg" alt="" class="active" />
        <img src="http://i.bosity.com/clothes_cache/261/12002348/3480000011312473207_12002348_1_image.jpg" alt="" />
        <img src="http://lokeshdhakar.com/projects/lightbox2/images/examples/image-6.jpg" alt="" />
    </span>
    <img src="http://www.image-and-text.com/pictures/whiskey_with_ice.jpg">
</div>

</div> 
```

**CSS**

```
/*slideshow*/

.viewer {
    font-size:0;
  display:inline;
}

.viewer IMG {
    position:absolute;

    z-index:8;
    width:50%;
  vertical-align:top;
}

.viewer IMG.active {
    z-index:10;
}

.viewer IMG.last-active {
    z-index:9;
}

/*pics*/

.pic_container{
    font-size:0;
    display:inline;

    }

 .pic_container img {

    width:25%;
  vertical-align:top;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T03:09:32.647

我已经为查看器添加了一个包装器，并使用 html 注释标签删除了外部图像和幻灯片查看器之间的额外间距（这比设置 font-size:0 更好）。我已经调整了 JS，以便过渡工作。我还清理并减少了所需的 CSS 数量。

**HTML**

```
<div class="picture-container">
    <img src="http://www.image-and-text.com/pictures/whiskey_with_ice.jpg" /><!--
        --><div class="viewer">
        <img src="http://images.printsplace.co.uk/Content/Images/Products/46576/43569/Image_of_M101_1.jpg" class="active" />
        <img src="http://i.bosity.com/clothes_cache/261/12002348/3480000011312473207_12002348_1_image.jpg" />
        <img src="http://lokeshdhakar.com/projects/lightbox2/images/examples/image-6.jpg" /> 
        </div><!--
    --><img src="http://www.image-and-text.com/pictures/whiskey_with_ice.jpg" />
</div> 
```

**CSS：**

```
* {margin:0;padding:0}
.picture-container > img {display:inline-block;width:25%;}
.viewer {display:inline-block;position:relative;width:50%;vertical-align:top;}
.viewer img {position:absolute;width:100%;} 
```

**JS**

```
function slideSwitch() {
  var transitionDuration = 1000;
    var active = $('.viewer img.active');
    var next = $('.viewer img:first').insertAfter(active);
    active.removeClass('active').fadeOut(transitionDuration);
    next.addClass('active').hide().fadeIn(transitionDuration);
}
$(document).ready(function(){
    $('.viewer img.active').insertAfter('.viewer img:last');
    setInterval("slideSwitch()", 4000);
}); 
```

你可以在这里看到它：http: [//jsfiddle.net/Ry7Su/1/](http://jsfiddle.net/Ry7Su/1/)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T02:35:17.770

以下更改将解决您的问题。

这是基于您的代码。您可以调整它以使其更短。

HTML部分：

```
<div class="pic_container">
     <div class="leftDiv">
        <img src="http://www.image-and-text.com/pictures/whiskey_with_ice.jpg">  
     </div><!--
  --><div class="viewerWrapper"><div class="viewer">
        <img src="http://images.printsplace.co.uk/Content/Images/Products/46576/43569/Image_of_M101_1.jpg" alt="" class="active" />
        <img src="http://i.bosity.com/clothes_cache/261/12002348/3480000011312473207_12002348_1_image.jpg" alt="" />
        <img src="http://lokeshdhakar.com/projects/lightbox2/images/examples/image-6.jpg" alt="" />
     </div></div><!--
  --><div class="rightDiv">
        <img src="http://www.image-and-text.com/pictures/whiskey_with_ice.jpg">
     </div>
</div> 
```

CSS部分：

```
.pic_container {
    display: block;
    width: 100%;
    position:relative;
    }
.leftDiv {
    display:inline-block;
    width: 25%;
    position:relative;
}
.rightDiv {
    display:inline-block;
    width: 25%;
    position:relative;
}
.viewerWrapper {
    display:inline-block;
    width: 50%;
    position:relative;
    vertical-align: top;
}
.viewer {
    width:100%;
}
.leftDiv IMG, .rightDiv IMG, .viewer IMG {
    max-width: 100%;
}
.viewer IMG {
    z-index:8;
    position: absolute;
}
.viewer IMG.active {
    z-index:10;
}
.viewer IMG.last-active {
    z-index:9;
} 
```

在这里看到它：http: [//jsfiddle.net/FTean/](http://jsfiddle.net/FTEan/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T04:18:20.053

尝试给予`pic_container` `position: relative;`并尝试给予`viewer` `display: inline-block;`这可能会奏效。`pic_container`也可能是`display: inline-block;`

# breeze - BreezeJS 是否应该在使用 Durandal 的单页面应用程序中跨页面共享实体管理器？

> ID：15694591
> 
> 赞同：2
> 
> 时间：2013-03-29T00:38:27.283
> 
> 标签：breeze, single-page-application, durandal

使用 Durandal 为单页应用程序创建 BreezeJS EntityManager 实例的最佳实践是什么？

是否应该有一个跨所有页面共享的实体管理器实例，或者每个页面应该有一个实例？

任何有关实施的细节都值得赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T01:28:23.847

这取决于你想要完成什么。如果您共享了 1 个 EntityManager (EM)，则所有数据都共享在一个地方。任何更改都会在视图和视图模型之间共享。当您按保存时，您保存所有屏幕。通常在这种情况下，您希望防止在用户保存或取消之前离开屏幕。

如果您希望能够打开不同的屏幕并相互独立地保存数据，您可以创建多个 EM。然后，您可以根据需要取消一个或保存另一个。

或者，您可以为应用程序的某些区域设置 EM（可能更常见）。真的取决于你想做什么。如果您没有要求将交易分开，那么 1 个 EM 就足够了。

# symfony - 构造函数参数上的登录重定向服务句柄错误

> ID：15694593
> 
> 赞同：1
> 
> 时间：2013-03-29T00:38:35.843
> 
> 标签：symfony, service, symfony-2.2

我按照本教程设置了登录后到最后一页的重定向：[http ://www.reecefowell.com/2011/10/26/redirecting-on-loginlogout-in-symfony2-using-loginhandlers/](http://www.reecefowell.com/2011/10/26/redirecting-on-loginlogout-in-symfony2-using-loginhandlers/)

我的服务.yml

```
parameters:
    assinatura_user_security.component.login_success_handler.class: Assinatura\UserBundle\Component\LoginSuccessHandler

services:
     assinatura_user_security.component.login_success_handler:
        class:  %assinatura_user_security.component.login_success_handler.class%
        arguments:  [@service_container, @router, @security.context]
        tags:
            - { name: 'monolog.logger', channel: 'security' } 
```

安全.yml

```
form_login:
                login_path: usuario_login
                check_path: usuario_login_check
                success_handler: assinatura_user_security.component.login_success_handler 
```

我的课：

```
<?php

namespace Assinatura\UserBundle\Component;

use Symfony\Component\Security\Http\Authentication\AuthenticationSuccessHandlerInterface;
use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\Security\Core\SecurityContext;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\RedirectResponse;
use Symfony\Component\Routing\Router;

class LoginSuccessHandler implements AuthenticationSuccessHandlerInterface
{

    protected $router;
    protected $security;

    public function __construct(Router $router, SecurityContext $security)
    {
        $this->router = $router;
        $this->security = $security;
    }

    public function onAuthenticationSuccess(Request $request, TokenInterface $token)
    {

        $referer_url = $request->headers->get('referer');

        $response = new RedirectResponse($referer_url);

        return $response;
    }

} 
```

和错误：

> 可捕获的致命错误：传递给 Assinatura\UserBundle\Component\LoginSuccessHandler::__construct() 的参数 1 必须是 Symfony\Component\Routing\Router 的实例，给定 appDevDebugProjectContainer 的实例，在 /var/www/assinatura/app/cache 中调用/dev/appDevDebugProjectContainer.php 在第 131 行并在 /var/www/assinatura/src/Assinatura/UserBundle/Component/LoginSuccessHandler.php 第 18 行中定义

我的 symfony 版本是 2.2

我想在未登录时重定向到同一页面

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T08:23:50.367

尝试将其更改为`services.yml`, 从`arguments: [@service_container, @router, @security.context]`到`arguments: [@router, @security.context]`。

```
services:
     assinatura_user_security.component.login_success_handler:
        class:  %assinatura_user_security.component.login_success_handler.class%
        arguments:  [@router, @security.context]
        tags:
            - { name: 'monolog.logger', channel: 'security' } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T04:19:04.233

我找到了这个解决方案（2.1中的新）

```
frontend:
            pattern:        ^/*
            provider:       usuarios
            anonymous:      ~
            form_login:
                login_path: usuario_login
                check_path: usuario_login_check
                use_referer:        true
            logout:
                path:       usuario_logout
            remember_me:
                key:        userassinatura2013
                lifetime:   604800 
```

登录后用于重定向的“use_referer”设置

# javascript - 你如何包含自定义 javascript

> ID：15694597
> 
> 赞同：0
> 
> 时间：2013-03-29T00:38:42.673
> 
> 标签：javascript, email, module, sugarcrm

我希望能够在 Sugarcrm 中包含电子邮件模块的自定义 javascript，以便我可以在电子邮件撰写页面上运行一些 javascript。然而，该模块似乎没有加载 *viewdefs.php 文件。有谁知道如何做到这一点？有没有我可以在自定义目录中添加的文件，而不是直接修改核心电子邮件模块代码，以便升级安全。提前致谢

我可以通过将自定义 javascript 文件添加到 custom/modules//metadata/editviewdefs.php 或 detailviewdefs.php 等中 $vardefs 中的 include 数组元素来在其他模块中包含自定义 javascript 文件，但这似乎不适用于电子邮件模块。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:41:26.637

请参阅： [SugarCRM-点击保存按钮时如何弹出窗口？](https://stackoverflow.com/questions/15254673/sugarcrm-how-to-get-popup-when-click-on-save-button/15259436#15259436)

我的全部答案都是关于让自定义 JavaScript 以升级安全的方式加载到 SugarCRM 中的任意模块中。

# opencv - 使用 OpenCV 检测特定形状

> ID：15694601
> 
> 赞同：0
> 
> 时间：2013-03-29T00:39:45.840
> 
> 标签：opencv

我有一个小项目，我想用它来玩计算机视觉。我扫描了一份文档，其中有一些单词被圈出，或者更具体地说，被 2 条平行水平线包围，每一端由曲线连接。类似于小学生使用的单词搜索工作表，但线条更简洁且只有水平。

![单词搜索工作表](../Images/5cce2f8d3a3e36b1fc7570350d407dbc.png)

目标是提取带圆圈的位，然后仅将这些部分传递给 OCR 过程以获取带圆圈的文本。

我之前使用一些打包的 haar 级联来使用 opencv 进行面部识别。类似的方法是否适用于简单的形状，或者 OpenCV 中是否有较低级别的方法可以很好地工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T02:29:35.210

如果线条始终采用相同（或相似）颜色，您可以使用[inRange](http://opencv.willowgarage.com/documentation/cpp/operations_on_arrays.html#cv-inrange)函数仅获取线条。然后使用[findContours](http://docs.opencv.org/doc/tutorials/imgproc/shapedescriptors/find_contours/find_contours.html)函数找到所有圆圈区域的轮廓，然后用白色像素填充它们，然后对该图像和原始图像进行[按位和运算。](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#bitwise-and)结果，您将只获得带圆圈的区域（包括线条 - 如果您想避免这种情况，请尝试使用用户侵蚀和扩张功能）。

> 我之前使用一些打包的 haar 级联来使用 opencv 进行面部识别。类似的方法是否适用于简单的形状，或者 OpenCV 中是否有较低级别的方法可以很好地工作？

我认为可以创建 Haar cascade 来找到圆圈区域，但是：

*   你会得到矩形，所以如果文本不是完全水平或完全垂直，你会得到很多额外的（和无用的）像素/字母
*   我的和 Gavinb 的解决方案都可能更快、更简单、更精确

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T01:43:10.573

用于检测图像中线条的一种很好、简单的方法是霍夫变换。它基本上充当线路参数的累积缓冲区。这应该能够相当容易地检测到您的长平行线，并通过阈值区分它们和字母。然后您可以遍历这些线条并从平行对中提取一个区域来分割字母。

*   [OpenCV 霍​​夫变换教程](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/hough_lines/hough_lines.html)

# javascript - 使用 Ember 的 bindAttr 时的 SafeStrings？

> ID：15694611
> 
> 赞同：4
> 
> 时间：2013-03-29T00:40:39.963
> 
> 标签：javascript, model-view-controller, ember.js, handlebars.js, javascript-framework

这是高度简化的，但我有以下内容：

```
<img src="www.example.com/image.jpg" {{bindAttr alt="view.altText"}} /> 
```

`altText`绑定来自视图中的计算属性，该属性返回一个 HTML字符`&#x54;`，`&amp;#x54;`如T" 而不是正确的 HTML 字符。

在计算属性中，我尝试`return new Handlebars.SafeString( '&#x54;' )`了，但这只是引发了一个关于期望字符串而不是对象的错误。

那么我该如何预防呢？

**更新：** [这是关于此事的 github 问题](https://github.com/emberjs/ember.js/issues/2398)。目前没有其他信息，但它可能会在此线程之前更新。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T19:32:36.793

Handlebars 在 {{ }} 之间转义值，使用 {{{ }}} 显示输出未转义的字符串。

来源：[http ://handlebarsjs.com/](http://handlebarsjs.com/)

# ios - 在 UIView 子类中执行计算会破坏 MVC 的设计模式？

> ID：15694614
> 
> 赞同：1
> 
> 时间：2013-03-29T00:41:17.483
> 
> 标签：ios, objective-c, model-view-controller, uiview, multi-touch

我有一个 UIView 子类，我在其中覆盖了多点触控处理方法。我的问题是，如果我在该视图上使用给定的触摸执行计算，它会破坏模型视图控制器设计模式吗？计算后，我必须隐藏视图、打印结果并更新我的核心数据模型。我对此感到困惑。

**编辑：**

一些代码。

```
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    // getting all the touches in the given gesture sequence
    NSSet *allTouches = [event allTouches];

    // checking taps count
    if ([allTouches count] == 3)
    {
        // here I print the results and do the calculations
        [self validateGestureSequenceWithTouches:allTouches];
    }

    // cleaning the view
    NSArray *subviews = [self subviews];
    for (UIView *view in subviews) {
       if (![view isKindOfClass:[UINavigationBar class]])
           [view removeFromSuperview];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:57:40.373

为了遵守 MVC 准则，您的业务级计算需要在模型层中进行。但是，并非所有计算都符合“业务计算”的条件：通常您必须执行计算才能决定 UI 事务，例如

*   单个 UI 元素的可见性
*   单个 ui 元素的大小，
*   触摸的位置和方向，

等等。如果您的计算属于商业类型，那么您应该将其移至模型中。否则，最好将其保留在视图或控制器中。

# mysql - mysql错误：无法创建新线程（errno 11）

> ID：15694616
> 
> 赞同：7
> 
> 时间：2013-03-29T00:41:34.847
> 
> 标签：mysql, linux, ubuntu-12.04, percona

我有一个运行 Percona Xtradb 服务器的数据库服务器和 5 个从服务器。我总是得到错误

> mysql错误：无法创建新线程（errno 11）；如果您没有用完可用内存，则可以查阅手册以了解可能与操作系统相关的错误

虽然我设置了 ulimited

```
root@master:~# ulimit -a
core file size (blocks, -c) 0
data seg size (kbytes, -d) unlimited
scheduling priority (-e) 0
file size (blocks, -f) unlimited
pending signals (-i) 2062915
max locked memory (kbytes, -l) 64
max memory size (kbytes, -m) unlimited
open files (-n) 1000000
pipe size (512 bytes, -p) 8
POSIX message queues (bytes, -q) 819200
real-time priority (-r) 0
stack size (kbytes, -s) 8192
cpu time (seconds, -t) unlimited
max user processes (-u) 1000000
virtual memory (kbytes, -v) unlimited
file locks (-x) unlimited

root@master:~# cat /proc/`pidof mysqld`/limits | egrep "(processes|files)"Max processes 1000000 1000000 processes
Max open files 1000000 1000000 files 
```

我真的不知道这是怎么回事？请帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-02T23:38:26.700

在 /etc/security/limits.conf 中添加这样的一行

```
mysql  soft  nproc  4096 
```

然后重启mysql

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T09:32:36.260

您的系统似乎达到了每个进程的最大线程数，请验证您的系统关于线程的状态：

```
$ cat /proc/sys/kernel/threads-max

$ echo 'SHOW STATUS;' | mysql | grep -i threads 
```

您还应该查看有关 thread_cache_size 的当前设置，此链接可能会有所帮助： [https ://serverfault.com/questions/408845/what-value-of-thread-cache-size-should-i-use](https://serverfault.com/questions/408845/what-value-of-thread-cache-size-should-i-use)

PS：此主题应发布在 serverfault.com

# mysql - 如何使用 MySQL 从 max(datetime) 中获取相应的值？

> ID：15694618
> 
> 赞同：0
> 
> 时间：2013-03-29T00:41:44.110
> 
> 标签：mysql, database, pivot-table

MySQL软件表：

```
.------------------------------------------------------------.
| id | hostname   | software | version | install_date        |
|------------------------------------------------------------|
| 1  | computer-a | vim      | 1.00    | 2012-01-04 00:00:00 | 
|------------------------------------------------------------|
| 1  | computer-a | vim      | 2.00    | 2012-01-05 00:00:00 | 
|------------------------------------------------------------|
| 1  | computer-b | emacs    | 2.00    | 2012-01-04 00:00:00 | 
|------------------------------------------------------------|
| 1  | computer-b | emacs    | 1.00    | 2012-01-05 00:00:00 | 
|------------------------------------------------------------|
| 1  | computer-c | emacs    | 2.00    | 2012-01-05 00:00:00 | 
|------------------------------------------------------------|
| 1  | computer-c | vim      | 3.00    | 2012-01-05 00:00:00 | 
'------------------------------------------------------------' 
```

MySQL查询：

```
SELECT 
  hostname,
  MAX(IF(software = 'vim', version, NULL)) AS VIM,
  MAX(IF(software = 'emacs', version, NULL)) AS EMACS
FROM
  software
GROUP BY
  hostname; 
```

结果：

```
+-------------+---------+----------+
| hostname    | VIM     | EMACS    |
+-------------+---------+----------+
| computer-a  | 2.0     | NULL     |
+-------------+---------+----------+
| computer-b  | NULL    | 2.0      |
+-------------+---------+----------+
| computer-c  | 3.0     | 2.0      |
+-------------+---------+----------+ 
```

[http://www.sqlfiddle.com/#!8/6247d/3](http://www.sqlfiddle.com/#!8/6247d/3)

问题是我想显示`install_date`每个`software`. Computer-b 应该为 EMACS 显示 1.0。如何更改查询以完成此操作？

我可以将查询更改为：

```
SELECT 
  hostname,
  MAX(IF(software = 'vim', install_date, NULL)) AS VIM,
  MAX(IF(software = 'emacs', install_date, NULL)) AS EMACS
FROM
  software
GROUP BY
  hostname; 
```

这会拉出正确的 install_date 但我怎样才能显示相应的`version`？

[http://www.sqlfiddle.com/#!8/6247d/4](http://www.sqlfiddle.com/#!8/6247d/4)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:46:26.670

您可以使用子查询来获取`max(install_date)`每个`hostname`，然后将其连接回您的表：

```
select s1.hostname,
  MAX(IF(software = 'vim', version, NULL)) AS VIM,
  MAX(IF(software = 'emacs', version, NULL)) AS EMACS
from software s1
inner join
(
  select max(install_date) i_date,
    hostname
  from software
  group by hostname
) s2
  on s1.install_date = s2.i_date
  and s1.hostname = s2.hostname
group by s1.hostname 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!8/6247d/10)。结果是：

```
|   HOSTNAME |    VIM |  EMACS |
--------------------------------
| computer-a |   2.00 | (null) |
| computer-b | (null) |   1.00 |
| computer-c |   3.00 |   2.00 | 
```

如果可能有不同的，您可能需要在子查询中`group by`使用`hostname`和：`software``software``install_date`

```
select s1.hostname,
  MAX(IF(s1.software = 'vim', version, NULL)) AS VIM,
  MAX(IF(s1.software = 'emacs', version, NULL)) AS EMACS
from software s1
inner join
(
  select max(install_date) i_date,
    hostname, software
  from software
  group by hostname, software
) s2
  on s1.install_date = s2.i_date
  and s1.hostname = s2.hostname
group by s1.hostname 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!8/4db01/6)

# php - 使用 PHP 循环将多个项目添加到单个 MySql 表

> ID：15694625
> 
> 赞同：0
> 
> 时间：2013-03-29T00:42:40.223
> 
> 标签：php, mysql, spotify

我正在一个网站上工作，用户可以搜索 Spotify 图书馆并点击结果，然后将自己添加到“播放列表”中。然后将通过 PHP 将此播放列表添加到 MySql 数据库中。添加的所有这些都是 Spotify href，但显然用户想要在他们的播放列表中添加不止一首歌曲。

感谢布拉德在下面的回答，我现在有了一个改进的数据库结构，但我仍然不确定如何循环播放已添加到播放列表中的每首歌曲，发布所有这些歌曲并将它们作为单独的行添加到我的“歌曲”中桌子。

已更新 'spotify.js' 中的这段代码将点击的歌曲添加到播放列表 div，然后添加要提交的隐藏输入。每次单击新歌曲时，它都会创建一个新输入，但每个输入的值都会发生变化。

```
$('.spotify-result').click(function() {
     $(this).clone().appendTo($('.selected-list'));
     $('.submit-spotify').before('<input type="hidden" id="track_href" class="track" value="" name="track_href" />');
     $('.track').val($('.track-href', this).text());
}); 
```

这是来自“spotify.php”的硬编码形式...

```
<form action="submit_spotify.php" method="post">
    <input type="hidden" id="track_href" value="" name="track_href" />
    <input type="submit" value="Submit Journix" />
</form> 
```

这是“submit-spotify.php”的一个片段，目前可以使用，但当然只会将第一首歌曲添加到数据库中。

```
if($db_server) {
    mysql_select_db($db_database) or die ("<p>Couldn't find database.</p>");
    $playlist_query = "INSERT INTO playlists (user_id, route_id) VALUES ('$route_id', '$user_id')";
    if (mysql_query($playlist_query)) {
        $song_query = "INSERT INTO songs (href) VALUES ('$href')";
        if (mysql_query($song_query)) {
            $message = "<p>Congratulations, your playlist has been added.</p>";
        } else {
            $message = ("Insert failed. " . mysql_error() . "<br/>" . $song_query);
        }   
    } else {
        $message = ("Insert failed. " . mysql_error() . "<br/>" . $playlist_query);
    }
} else {
    $message = "Error: could not connect to the database.";
}
mysql_close($db_server); 
```

我猜我需要一个循环来遍历每个'.spotify-result'并获取每个'.val（）'，为每个表单添加一个新的？我根本不知道从那里去哪里将每个输入到一个新行中，或者这甚至是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:52:38.087

从它的声音来看，您现在使用的方法将只允许一个用户拥有一个播放列表。更好的方法可能是将其提取到 3 个不同的表中

```
Users [ id | username ]
Playlists [ id | user_id | playlist_name ]
Songs [ id | playlist_id | href ] 
```

这可以描述为：

```
 "Users can have many playlists" <=> "Playlists will have one user"
 "Playlists have many songs" <=> "Songs have many playlists" 
```

另外，我不确定它是如何工作的，但我假设在 Spotify URL 中您将有一个歌曲 ID ( [http://www.spotify.com?id=V92Ksj2](http://www.spotify.com?id=V92Ksj2) )。与其存储整个 url，不如只存储歌曲 ID。

# php - PHP类文件的静态或相对路径？

> ID：15694626
> 
> 赞同：2
> 
> 时间：2013-03-29T00:43:00.723
> 
> 标签：php

我通常像这样包含我的 PHP 类文件：

```
$root = realpath($_SERVER["DOCUMENT_ROOT"]);

include_once("$root/classes/my.class.php"); 
```

这是推荐的还是我应该只使用相对路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:44:28.550

您应该使用这样的自动加载器加载类：

[http://phpmaster.com/autoloading-and-the-psr-0-standard/](http://phpmaster.com/autoloading-and-the-psr-0-standard/)

编辑：总结。你不应该手动加载你的类，而应该配置你的应用程序来自动加载它们。

请参阅此以获得简单的实现（简单很好 - 遵循此代码）

[https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:47:14.683

使用`realpath()`会产生一些开销，因为它会计算规范路径，检查指向源文件的文件夹结构的每个部分。

另一种方法是使用`__DIR__`：

```
include __DIR__ . '/classes/my.class.php'; 
```

对于每个文件只包含一个类的类加载，您应该考虑[自动加载](http://php.net/autoload)它们。

# java - 多个 ServerSockets、多个设备并发送到多个套接字

> ID：15694630
> 
> 赞同：0
> 
> 时间：2013-03-29T00:43:28.853
> 
> 标签：java, android, sockets

我的公司为我们的系统创建了他们自己的定制安卓硬件。

我们目前有 2 个 android 设备需要一起通信并同步它们内部的 sqlite 数据库。

我开始编写自定义套接字协议来解决这个问题。这是基于服务器客户端模型。然而，随着我进行更多的开发，我发现每个设备都需要运行一个服务器套接字，并且可以与系统中的 3 个或更多设备进行通信，并且服务器也有可能死机、重启或崩溃。

所以我的想法是让每个设备搜索我存储在数组中的一组端口，并绑定到设备检查时当前可用的端口，并围绕它创建我的 ServerSocket。

这意味着可能 device1 具有 ServerSocket(1111) 而 device2 具有 ServerSocket(1112) 等。

然后每个设备通过多个端口发送消息。例如：device1 遍历数组并打开一个客户端套接字并为每个端口发送一条消息： Socket socket = new Socket(IP,1112); 发送消息... Socket socket = new Socket(IP,1113); 发送消息...等

当然，我已经制作了这个多线程（由 android 服务运行），因此不会阻塞 android 设备中的 UI 线程。

我的问题是，我这样做对吗？或者Java中有更好的方法来做到这一点？

编辑：

我决定添加一些代码来解释我的问题。

我有多个通过 TCP/IP 连接在一起的 android 设备，我在每个设备上创建一个 ServerSocket，如下所示：

```
ServerSocket serverSocket = new ServerSocket(4000); 
```

现在，当第二个设备尝试此操作时，它在 Java 中给了我一个错误，因为套接字正在被另一个设备使用。他们的 IP 地址类似于 172.23.3.128 和 172.23.3.127。

因此，即使有不同的 IP 地址，我也会收到来自 Java 的错误，说我已经绑定到该端口/IP，这是真的。这是我不明白的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T02:49:53.737

这没有意义。每个设备都必须有自己的 IP 地址：它们也不需要不同的端口号。它们都可以使用相同的端口号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T02:54:59.730

您还可以：

*   让客户端监听特定的 UDP 端口
*   让客户端也向该端口[广播，宣布他们的存在](https://stackoverflow.com/questions/2950715/udp-broadcast-in-java)
*   一旦客户端接收到广播，它们就可以通过 TCP 或 UDP 启动从临时端口到预定辅助端口的直接连接。

至少通常是这样做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T02:40:53.713

基本上服务器需要正常运行，你的想法是服务器中断。否则，您可以使用单个服务器，该服务器在一个端口中接受来自多个客户端的连接，例如：5000,5001,5002 等。

修复每个客户端的套接字端口。服务器在您尝试时打开一个数组。

通过多个端口发送消息是什么意思？为每个客户端使用一个端口，否则您无法识别哪个客户端正在发送消息。

# ruby - 红宝石重做方法

> ID：15694634
> 
> 赞同：2
> 
> 时间：2013-03-29T00:43:55.550
> 
> 标签：ruby

我正在学习 RUBY，但我对重做方法有疑问。我正在玩循环和迭代器，试图掌握它们的窍门。我有以下代码：

```
def question (quest , ans )
  puts quest
  a = gets.chomp
  if a == ans
    puts "good job"
  else
    puts "Try Again!"
    a = gets.chomp
    redo
  end
end 
```

只要方法中有重做，一切都可以正常工作。我希望该块重新运行，直到用户输入正确的答案。有人可以告诉这个块有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:49:52.837

`redo`, like`retry`将在循环内使用。

您可以将代码更改为

```
def question(quest, ans)
  puts quest

  puts "Try Again!" while gets.chomp != ans

  puts "good job"
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-29T02:39:13.340

`redo`应该在循环中使用并且它重复当前迭代，所以在你的代码中如果你想使用`redo`把它放在某个循环中，例如

```
def question (quest , ans )
  1.times do
    puts quest
    a = gets.chomp
    if a == ans
      puts "good job"
    else
      puts "Try Again!"
      redo
    end
  end
end 
```

这将开始工作，虽然它非常违反直觉，你正在循环一次但你不是:)

对于这种情况，更好的方法是循环直到你得到答案。

# wordpress - Wordpress - 以自定义形式插入图像

> ID：15694636
> 
> 赞同：0
> 
> 时间：2013-03-29T00:43:58.540
> 
> 标签：wordpress, image, input

我在插件设置页面的管理面板中的 wordpress 中制作了一个自定义表单。我有一个输入字段，我不会保存将通过 Wordpress 图像管理器选择的图像的 URL。

我真的不知道该怎么做。有没有办法调用图像管理器并将返回值连接到我的自定义输入字段？我不需要上传任何图片（我假设如果用户想要在加载图片管理器后就可以了？），我只需要弹出图片管理器，选择一张图片，然后返回要放入的 URL输入框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T02:34:17.223

听起来你做了你的“主题选项”？如果是这样，您可以使用类似的方法调用该选项。

您可以在页面顶部调用此变量`<?php //get theme options $options = get_option( 'theme_settings' ); ?>`

和呼应`<?php echo ($options['image_url']); ?>`

我现在使用一个名为 SMOF 的选项框架，这非常方便，并添加了一个很棒的主题选项页面。[https://github.com/sy4mil/Options-Framework](https://github.com/sy4mil/Options-Framework)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T01:45:45.977

好的，我找到了 wordpress 3.5 及更高版本的解决方案：

首先，您需要在加载脚本时调用插件中的函数 wp_enqueue_media() 函数。

然后您可以按照此处的说明进行操作：http: [//mikejolley.com/2012/12/using-the-new-wordpress-3-5-media-uploader-in-plugins/](http://mikejolley.com/2012/12/using-the-new-wordpress-3-5-media-uploader-in-plugins/)

这对我来说效果很好！

# php - PHP中的动态上一页链接

> ID：15694641
> 
> 赞同：0
> 
> 时间：2013-03-29T00:44:20.107
> 
> 标签：php, mysql, dynamic-linking

我想在 PHP 中创建一个“以前的条目”链接。这不是一个简单的条目列表，您可以在其中从 MySQL 数据库中获取固定数量的行。这里的问题是：每次调用链接时，行条目可能会有所不同。

实际上发生的事情是我正在寻找日期。我在首页显示最新日期的条目。可能有多行具有相同的日期。我必须在同一页面上显示所有条目。当用户单击上一个条目链接时，它将获取下一个最近的日期并获取具有该日期的条目并将其显示在页面上，当用户再次单击上一个条目链接时，它应该显示第三个最近日期的条目。以这种方式它应该继续。我也想为新条目做同样的事情。

我不知道如何继续它。任何帮助将不胜感激。

我的语言是 PHP，数据库是：MySQL

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T00:50:17.013

不要使用日期作为区分行的方法，而是使用自动 ID（IDENTITY 列）。这样一来，ID就没有重复了，然后你可以减1或加1来获得上一个/下一个条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:58:13.473

为清晰/可能的语言障碍而编辑。

如果当前选择的日期是，`2013-03-28`那么您需要找到最接近的上一个日期。有很多方法可以做到这一点（按效率排序）：

*   使用mysql的`DATE_DIFF`方法并按差异排序，您将找到日期最接近的记录，或者可以只查询日期本身并对该日期的所有记录进行第二次查询。
*   使用php遍历当前日期之前的日期，查询mysql当天的任何记录（效率低下）
*   查询数据库中的所有唯一日期并将其缓存在某处，然后查找下一个日期。

一旦您知道记录的上一个日期是`2012-11-01`，您就可以轻松地查询具有此类日期/时间戳的所有记录。

# java - 如何添加新的换行弹簧 对于从 java 代码传递的错误

> ID：15694645
> 
> 赞同：0
> 
> 时间：2013-03-29T00:44:56.327
> 
> 标签：java, spring

我正在尝试使用来自服务器代码的错误消息传递换行符以显示在 UI 中。我正在用 spring 显示这些错误消息`<form:error>`

**服务器代码**：

```
error= "xyz"+" \n"+"abc" 
```

**我在UI**中想要这样的东西：

```
xyz 
```

`abc`（在新行中）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T15:01:36.490

将“\n”替换为“
”是快速解决方案。但是，我会谨慎使用这种简单的方法，因为如果在非 Web 环境中使用您的错误消息会看起来很奇怪。例如，如果您将错误消息记录到文件中，它将显示
而不是换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-06T03:06:44.630

参考[这个](https://stackoverflow.com/questions/1908365/how-to-put-new-line-in-jsps-expression-language)答案，如果您正在使用一些 jsp 技术，请查找`escape`or `htmlEscape`kinda 属性。并将它们设置为`false`.

对我来说，我试图用 验证表单`org.springframework.validation.Validator`，并且在电子邮件无效时努力在 html 代码中呈现换行符。

```
if (!emailId.matches("^.+@.+\\..+$")) {    
    errors.rejectValue("emailId", "error.emailId", "Email ID cannot be blank<br>Should be proper email ID format");
} 
```

设置后`htmlEscape="false"`，成功了！

```
<td>
    Email ID
</td>
<td>
    <form:input type="email" path="emailId" id="emailId" />
</td>
<td>
    <form:errors path="emailId" />
</td> 
```

我知道这个答案可能不适合我试图提供解决方案的问题。但是，由于我找不到我所面临的问题的确切解决方案，我认为可以将其发送到这里。

# android - google maps api version 2 android中的距离和旅行时间

> ID：15694647
> 
> 赞同：2
> 
> 时间：2013-03-29T00:45:09.883
> 
> 标签：android, google-maps, time, distance

我想制作一个应用程序来显示旅行时间和距离以及用户位置到目的地位置的路径。

这是我的 TampilkanMap 课程：

```
public class TampilkanMap extends FragmentActivity {
    GoogleMap googleMap;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);

        SupportMapFragment fm = (SupportMapFragment) getSupportFragmentManager()
                .findFragmentById(R.id.map);

        googleMap = fm.getMap();

        // Enabling MyLocation Layer of Google Map
        googleMap.setMyLocationEnabled(true);
        // lokasi wisata
        Marker GunungButtuKabombong = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-3.568419, 119.777141)).title("Enrekang")
                .snippet("Gunung Buttu kabobong"));
        Marker HutanMalino = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-5.296776, 119.740562)).title("Gowa")
                .snippet("Hutan Malino"));
        Marker SombaOpu = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-5.191144, 119.407899)).title("Makassar")
                .snippet("Benteng Somba Opu"));
        Marker Londa = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-2.968156, 119.900479)).title("Rantepao")
                .snippet("Londa"));
        Marker Jompie = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-4.005563, 119.634331)).title("Parepare")
                .snippet("Hutan Jompie"));
        Marker Lumpue = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-4.057233, 119.622411)).title("Parepare")
                .snippet("Pantai Lumpue"));
        Marker Bira = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-5.550204, 120.206166)).title("Bulukumba")
                .snippet("Pantai Tanjung Bira"));
        Marker Losari = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-5.133219, 119.41662)).title("Makassar")
                .snippet("Pantai Losari"));
        Marker Bantimurung = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-5.006130, 119.650970)).title("Maros")
                .snippet("Air Terjun Bantimurung"));
        Marker Kelelawar = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-4.349835, 119.927759)).title("Soppeng")
                .snippet("Kelelawar"));
        Marker DanauTempe = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-4.110587, 119.953579)).title("Wajo")
                .snippet("Danau Tempe"));
        Marker FortRotterdam = googleMap.addMarker(new MarkerOptions()
                .position(new LatLng(-5.134148, 119.405276)).title("Makassar")
                .snippet("Benteng Fort Rotterdam"));
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.opt_menu, menu);
        return true;
    }

    public boolean onOptionsItemSelected(MenuItem item) {

        switch (item.getItemId()) {
        case R.id.satelit:
            googleMap.setMapType(GoogleMap.MAP_TYPE_SATELLITE);
            return true;

        case R.id.street:
            googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
            return true;

        default:
            return super.onOptionsItemSelected(item);
        }
    }
} 
```

如果用户从我的位置触摸标记，我想制作一条路径，我该如何制作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:21:00.013

我就是这样做的：我听说它只在美国有效，这正是我所听到的：步行、开车和骑自行车，在那里也可以分享到 facebook 和堆叠地图的方法，欢迎使用它，我认为有些进口是不必要的，但我还没有时间删除它们，而且我知道你的新产品如果你不表现出研究努力并使你的问题不那么模糊，它们会把你踢出去

```
import java.io.File;
import java.util.ArrayList;
import java.util.List;

import android.app.AlertDialog;
import android.content.ComponentName;
import android.content.Context;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.content.pm.PackageManager;
import android.content.pm.ResolveInfo;
import android.graphics.drawable.Drawable;
import android.net.Uri;
import android.util.Log;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.ItemizedOverlay;
import com.google.android.maps.OverlayItem;

public class OverlayPoints extends ItemizedOverlay<OverlayItem>
{

private ArrayList<Drawable> mImage = new ArrayList<Drawable>();
 private ArrayList<OverlayItem> mOverlays = new ArrayList<OverlayItem>();
 private ArrayList<File> filepic = new ArrayList<File>();

 private Context mContext;
 private boolean active;
 private boolean touch = false;

public OverlayPoints(Drawable defaultMarker, Context context) 
{
    super(boundCenterBottom(defaultMarker));
     mContext = context;
     active = false;

    // TODO Auto-generated constructor stub
}

 public void addOverlay(OverlayItem overlay, Drawable image,File pic)
 {
     active = true;

     filepic.add(pic);
 mOverlays.add(overlay);
 mImage.add(image);
 populate();

 }

@Override
protected OverlayItem createItem(int arg0) 
{
    return mOverlays.get(arg0);
    // TODO Auto-generated method stub

}
public void delete()
{

    mImage = new ArrayList<Drawable>();
    mOverlays = new ArrayList<OverlayItem>();
}

@Override
public int size() {
    // TODO Auto-generated method stub
     return mOverlays.size();
}
 protected boolean onTap(int index)
 {
 final OverlayItem item = mOverlays.get(index);
 final File file = filepic.get(index);
 AlertDialog.Builder dialog = new AlertDialog.Builder(mContext);
 dialog.setIcon(mImage.get(index));
 dialog.setTitle(item.getTitle());
 dialog.setMessage(item.getSnippet());
 dialog.setNegativeButton("Dismiss", new OnClickListener(){

    @Override
    public void onClick(DialogInterface arg0, int arg1) {
        // TODO Auto-generated method stub

    }

 });
 dialog.setNeutralButton("Set Course", new OnClickListener(){

    @Override
    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub
        GeoPoint point = item.getPoint();
        final double lat = (double)point.getLatitudeE6()/ 1E6;
        final double lon = (double)point.getLongitudeE6()/ 1E6;

        AlertDialog.Builder course = new AlertDialog.Builder(mContext);
        course.setNegativeButton("On Foot", new OnClickListener(){

            @Override
            public void onClick(DialogInterface arg0, int arg1) {
                // TODO Auto-generated method stub
                Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(String.format("google.navigation:ll=%s,%s%s", lat, lon, "&mode=w")));
                mContext.startActivity(i);
            } 

        });

        course.setNeutralButton("By Car", new OnClickListener(){

            @Override
            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
                Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(String.format("google.navigation:ll=%s,%s%s", lat, lon, "&mode=d")));
                mContext.startActivity(i);
            }

        });
        course.setPositiveButton("On Bike", new OnClickListener(){

            @Override
            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
                Intent i = new Intent(Intent.ACTION_VIEW, Uri.parse(String.format("google.navigation:ll=%s,%s%s", lat, lon, "&mode=b")));
                mContext.startActivity(i);
            }

        });
    course.show();  
    }

 });
 dialog.setPositiveButton("Share", new OnClickListener(){

    @Override
    public void onClick(DialogInterface dialog, int which) {
        // TODO Auto-generated method stub
        Uri uri = Uri.fromFile(file);
        Intent shareIntent = new Intent(android.content.Intent.ACTION_SEND);

        shareIntent.setType("image/png");
        shareIntent.putExtra(android.content.Intent.EXTRA_STREAM,
                        uri); //Share the image on Facebook
        PackageManager pm = mContext.getApplicationContext().getPackageManager();
        List<ResolveInfo> activityList = pm.queryIntentActivities(
                            shareIntent, 0);
        for (final ResolveInfo app : activityList) {
            if ((app.activityInfo.name).contains("facebook")) {
                final ActivityInfo activity = app.activityInfo;
                final ComponentName name = new ComponentName(
                            activity.applicationInfo.packageName,
                            activity.name);
                shareIntent.addCategory(Intent.CATEGORY_LAUNCHER);
                shareIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK
                    | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
                shareIntent.setComponent(name);
                mContext.startActivity(shareIntent);
                break;
                    }
                }
    }

 });
 if(touch)
     dialog.show();
 return true;
 }
 public boolean isused()
 {
     return active;
 }
 public void showlogfalse(){
     touch = false;
 }
 public void showlogtrue(){
     touch = true;
 } 
```

}

# c# - 少量项目的哈希表内存使用C#

> ID：15694648
> 
> 赞同：4
> 
> 时间：2013-03-29T00:45:13.540
> 
> 标签：c#, memory, dictionary, hashtable

我想知道是否有很多小字典会因为涉及的开销而浪费内存。字典被实现为一个哈希表，所以如果我有数千个对象，每个对象都包含这些小字典，我最终不会浪费很多空间，而不是仅仅拥有一个我搜索的列表/二进制搜索树，特别是如果每个小字典只包含 4-5 个键值对？

我现在正在查看的代码是这样实现的，并且由于存在内存问题，我想知道将哈希表用于少量项目是多么浪费。除了列表/二叉搜索树之外，我还有哪些其他选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:52:22.490

当然，基准测试是查看性能与内存问题的最佳方法，但如果每个字典都那么小，请考虑[ListDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.listdictionary.aspx)或[HybridDictionary](http://msdn.microsoft.com/en-us/library/system.collections.specialized.hybriddictionary.aspx)类。对于小型词典，您肯定会看到性能优势，我怀疑您也会看到大小优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:54:33.760

如果您需要散列功能，您可以使用 hastable 而不是字典，如果不是，一些轻量级集合就可以了。您可以查看此链接[Dictionary vs Hashtable memory usage](https://stackoverflow.com/questions/6740205/dictionary-vs-hashtable-memory-usage)

# cassandra - 如何在 Cassandra 中设置计数器列族的一致性级别

> ID：15694654
> 
> 赞同：2
> 
> 时间：2013-03-29T00:45:55.273
> 
> 标签：cassandra, hector

我已经定义了一个键空间。我可以将计数器列族（读取和写入）的一致性级别设置为 ALL 而不影响其余键空间吗？我无法从cli中的帮助中弄清楚如何做到这一点，但我想应该是可能的。类似于以下内容：

```
update column family COUNTERS with ________ 
```

我正在使用 Java Hector API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T07:27:25.643

不确定 CQL3，但您可以在读/写时执行此操作。节俭客户端示例：

```
client.add('key1', ColumnParent(column_family='Counter1'), CounterColumn('c1', 100), ConsistencyLevel.ONE)
client.add('key1', ColumnParent(column_family='Counter1'), CounterColumn('c1', -50), ConsistencyLevel.ONE) 
```

# iphone - 编译器无法识别类的存在，即使在导入标头之后

> ID：15694658
> 
> 赞同：0
> 
> 时间：2013-03-29T00:46:25.173
> 
> 标签：iphone, ios, objective-c, xcode

因此，当我输入类的名称时`cue`，它会在 XCode 中显示为关于编写内容的建议，当我导入标头时也会发生同样的事情（XCode 建议我在输入时导入标头）所以文件地址肯定是对的。然而它给了我一个错误，我输入的类型不存在，或者在方法中它告诉我我需要一个类型名称。

类接口：

```
#import <Foundation/Foundation.h>
#import "CueTableCell.h"
#import "CueList.h"

typedef enum {
    none,
    immediate,
    after,
    afterWait,
} CueType;

@interface Cue : NSObject

@property CueType cueType;
@property NSString* title;
@property float wait;
@property (strong, nonatomic) Cue* nextCue;
@property CueTableCell* cell;
@property CueList* list;

-(id) initWithTitle: (NSString*) title cueType: (CueType) type list: (CueList*) list cell: (CueTableCell*) cell wait: (float) wait thenCall: (Cue*) nextCue ;

-(void) fire; //Should not be async.
-(void) reset; //Pauses and resets everything
-(void) callNext;
-(void) selected;
-(void) select;

@end 
```

无法识别 Cue.h 文件的 CueTableCell 文件：

```
 #import "Cue.h"
    @interface CueTableCell : UITableViewCell

    -(void) updateBarAt: (float) playHead;
    -(void) updateBarIncrease: (float) by;

    - (void)setTitle:(NSString *)title wait: (float) wait fadeOut: (float) fadeOut fadeIn: (float) fadeIn playFor: (float) playFor;

    @property (nonatomic, weak) IBOutlet UILabel* titleLabel;
    @property (nonatomic, weak) IBOutlet UILabel* waitLabel;
    @property (nonatomic, weak) IBOutlet UILabel* fadeInLabel;
    @property (nonatomic, weak) IBOutlet UILabel* fadeOutLabel;
    @property (nonatomic, weak) IBOutlet UILabel* playForLabel;

    @property (nonatomic, strong) NSString* title;
    @property (nonatomic) float wait;
    @property (nonatomic) float fadeIn;
    @property (nonatomic) float fadeOut;
    @property (nonatomic) float playFor;

    @property (nonatomic, weak) Cue* cue; # <---- Get an error that Cue is not a type

    @end

For some reason, the compiler recognizes Cue importing CueTableCell, but not the other way around. Cue is at the top of a class hierarchy, so other files clearly are able to import it. I've tried changing the group and file location of CueTableCell, and nothing helps. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:59:16.393

`#import`只是进行文本替换。因此，在编译器尝试编译`CueTableCell`时，`Cue`尚未定义。

如果你只是`#import "Cue.h"`，它会在任何地方`#import "CueTableCell.h"`定义之前执行`Cue`。如果您直接`#import "CueTableCell.h"`自己，`Cue`则未*在任何地方*定义。无论哪种方式，您都无法使用它；编译器不知道它应该是 ObjC 类型的名称。（它可以很容易地是各种各样的东西——甚至是一个全局变量 int。）

`#import`如果你在 顶部去掉它`Cue.h`，而是做 a `#import "Cue.h"`in `CueTableCell.h`，那将解决这个问题......但立即创建一个新的，等效的，因为一旦编译器到达`@property CueTableCell* cell;`它就会抱怨它`CueTableCell`不是一个类型。

这就是[前向声明](http://en.wikipedia.org/wiki/Forward_declaration)的用途。只需添加一个`@class Cue;`to `CueTableCell.h`，编译器就会知道这`Cue`是一个 ObjC 类（这是它现在需要知道的全部内容）。

您也可以只添加`@class CueTableCell;`到`Cue.h`，然后删除`#import "CueTableCell.h"`那里，也可能相同`CueList`。当然 .m 文件可能需要包含所有标题，但这很好；它们不必相互导入，因此没有循环的危险。

您真正需要将 a`#import "Foo.h"`放入头文件的唯一原因`Bar.h`是，如果任何想要使用的`Bar`人也需要使用`Foo`，并且不能期望知道这一点并将 a 添加`#import "Foo.h"`到他的 .m 文件中。

# c++ - 可以执行“#ifdef DEBUG( ... ) __VA_ARGS__”吗？

> ID：15694662
> 
> 赞同：0
> 
> 时间：2013-03-29T00:46:37.533
> 
> 标签：c++, macros

全球.h

```
#ifndef GLOBAL_H
#   define GLOBAL_H

#define DEBUG

#ifdef DEBUG
#   define IF_DEBUG( ... )   __VA_ARGS__
#else
#   define IF_DEBUG( ... )
#endif /* DEBUG */

#endif /* GLOBAL_H */ 
```

主文件

```
#include <string>
#include <iostream>
#include "Global.h"

int main() {
    int A = 1;
    int B = 2;
    int C = 0;

    IF_DEBUG(
        std::cout << "\nStep 1> Calculating...\n";
    )

    C = A + B;

    // DO WHATEVER

    IF_DEBUG(
        std::cout << "\nStep n> ...\n";
    )

    // ...

    std::cout << C << std::endl;

    // Note: I could also do some operations within the IF_DEBUG macro.
    IF_DEBUG(
        int X = 10;
        int Y = 5;
        int Z = X / Y;
        std::cout << Z << std::endl;
    )

    IF_DEBUG(
        std::cout << "\nDebugged! This program has been paused. Enter any key to continue!\n";
        ::getchar();
    )
    return 0;
} 
```

你看到我是如何`IF_DEBUG`在全局头文件 (Global.h) 中定义的，以及我是如何在主源文件 (Main.cpp) 中经常使用它来进行调试的吗？这样做可以安全吗？

我问这个问题是因为我不确定这样做是否可以。当我向我的朋友展示这个时，他说这样做“不好”。因此，我不确定。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:53:45.327

这是一个非常常见和有用的技巧。但最好不要`#define DEBUG`在源代码中包含 。您可以改为在编译命令行中定义它。`g++ -DDEBUG -c file.cpp`将像`DEBUG`定义一样编译代码。

如果您使用的是 a `Makefile`，则可以将其添加到`CPPFLAGS`(C Preprocessor Flags) 变量中：`CPPFLAGS=-DDEBUG`.

如果您使用的是 IDE，请尝试在项目设置中找到 C 预处理器标志。

# cuda - cudaMallocHost() ， cudaCreateEvent() 是否与执行内核异步？

> ID：15694665
> 
> 赞同：2
> 
> 时间：2013-03-29T00:46:54.290
> 
> 标签：cuda

我正在使用 Cuda Runtime API 解决一个非常奇怪的问题。`cudaMallocHost()`对,`cudaEventCreate()`等函数的调用`cudaFree()`似乎仅在内核在 GPU 上完成执行时才执行。这些内核都在使用`cudaStreamNonBlocking`标志创建的流上启动。问题是什么？我必须在某处放置其他标志吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T12:39:18.763

它们*可以*是异步的，但如果它们不是异步的也就不足为奇了。

关于`cudaMallocHost()`，这需要为 GPU 映射主机内存：如果无法从预分配的池中满足分配，则必须编辑 GPU 的页表。如果驱动程序有一个限制，它不能编辑正在执行的内核的页表，我一点也不会感到惊讶。（特别是因为页表编辑必须由内核模式驱动程序代码完成。）

关于`cudaEventCreate()`，这确实应该是异步的，因为这些分配通常可以从预分配的池中得到满足。主要的障碍是改变行为会破坏依赖其当前同步行为的现有应用程序。

异步释放对象要求驱动程序跟踪提交给 GPU 的命令缓冲区中引用了哪些对象，并将实际的释放操作推迟到 GPU 完成处理它们之后。这是可行的，但我不确定 NVIDIA 是否完成了这项工作。

对于`cudaFree()`，不可能像 CUDA 事件那样跟踪引用（因为可以存储指针以供正在运行的内核读取和跟踪）。因此，对于应该解除分配和取消映射的大型虚拟地址范围，必须推迟释放，直到*所有*挂起的 GPU 操作都已执行。同样，可行，但我不确定 NVIDIA 是否完成了这项工作。

我认为 NVIDIA 通常希望开发人员能够解决这些入口点缺乏异步性的问题。

# php - 选择对结果进行排序后，如何让 php“记住”进行的搜索？

> ID：15694668
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:47:18.793
> 
> 标签：php, mysqli

我有以下代码：

```
<?php
include "include.php";
session_start();
// Defining variables from home.php if set
if(isset($_POST['title'])){
$title = mysql_real_escape_string($_POST['title']);
}
if(isset($_POST['author'])){
$author = mysql_real_escape_string($_POST['author']);
}
if(isset($_POST['isbn'])){
$isbn = mysql_real_escape_string($_POST['isbn']);
}
if(isset($_POST['keyword'])){
$keyword = mysql_real_escape_string($_POST['keyword']);
}
if(isset($_POST['sort'])){
$sort=@$_POST['sort'];}
// Determine the WHEREs to use
$where = array();
if ( ! empty($title))
$where[] = "booktitle LIKE '%" . $title . "%'";
if ( ! empty($author))
$where[] = "author LIKE '%" . $author . "%'";
if ( ! empty($isbn))
$where[] = "isbn LIKE '%" . $isbn . "%'";
if ( ! empty($keyword))
$where[] = "description LIKE '%" . $keyword . "%'";

//Determine the ORDERs to use
$order = array();
if ((isset($sort)) && ($sort=='lowhigh'))
$order[] = "price ASC";
if ((isset($sort)) && ($sort=='highlow'))
$order[] = "price DESC";
// Build the query
$query = 'SELECT * FROM book';
if ( ! empty($where))
$query .= ' WHERE ' . implode(' AND ', $where);
if(! empty($sort))
$query .= ' ORDER BY ' . implode($order);
//Display results
$result = mysqli_query($con, $query) or die("Error in query $query: " . mysqli_error());
while ($row = mysqli_fetch_array($result)) {
  ?><a id="1" href="book.php" border="0"><img src="<?php echo $row[12]; ?>" width="112px" height="150px" /></a>
<a href="book.php?booktitle='<?php echo $_SESSION['booktitle']=$row[1];?>'"><b><?php echo  $row[1] . ", (" . $row[5] . ")";?></b></a><br><?php
echo $row[2];
echo "<br><div style='text-align:right'> <b>&pound;" . $row[9] . "</b></div>";
echo "<b>Book description:</b> " . substr($row[3],0,300) . "...<br /><hr>";
}
mysqli_close($con);             //closes the connection
?> 
```

它传递来自前端页面上四个文本字段的输入并显示结果。这一切都很好。这是我对显示的结果进行排序的时候。例如，如果我选择价格：从低到高，它会排列我数据库中的所有结果并显示所有内容，而不仅仅是执行搜索的结果。有人现在如何让它记住原始搜索？

这是我的表格：

```
<form id="rform" name="formsort" action=""  method="post">
<select name="sort" id="sort" onChange="document.forms['formsort'].submit()">
<option value="default">Sort Results</option>
<option value="lowhigh">Price: Low to High</option>
<option value="highlow">Price: High to Low</option>
</select>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T07:28:51.870

> 如何让 php “记住”进行的搜索

它实际上不是 PHP，而是 HTTP 协议的一般概念。因此，要解决您的问题，您必须遵循以下标准：

> GET 方法应该用于搜索而不是 POST。这是由 HTTP 标准定义的，并且是 GET 方法的目的。虽然 POST 不应该用于搜索。

因此，只要您使用 GET 方法，您的数据就会自动保存。

唯一的问题可能是分页链接。要向它们添加当前查询字符串，`http_build_query()`必须使用函数。

您实际上可以减少页面上的条件数量。而不是使用 2 个单独的

```
if(isset($_GET['title'])){
    $title = mysql_real_escape_string($_POST['title']);
}
if ( ! empty($title))
$where[] = "booktitle LIKE '%" . $title . "%'"; 
```

必须使用一个

```
if(isset($_GET['title'])){
    $title = mysql_real_escape_string($_POST['title']);
    $where[] = "booktitle LIKE '%" . $title . "%'";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:53:24.520

对不起，我再次检查了您的代码，发现它很清楚，解决方案也很清楚:)

将 3 个隐藏元素以依次对 (title,book,author) 命名的每个元素进行排序的形式，并存储从搜索操作发布的值，因此当您对结果进行排序时，您还将应用这些约束，因为再次发布:)

我的意思是您必须在您使用的排序表单内部添加以下代码：

```
<?php
    if(isset($_POST['title']))
        {
            echo '<input type="hidden" name="title" value="'.$_POST['title'].'" />';
        }
    if(isset($_POST['author']))
        {
            echo '<input type="hidden" name="author" value="'.$_POST['author'].'" />';
        }
    if(isset($_POST['isbn']))
        {
            echo '<input type="hidden" name="isbn" value="'.$_POST['isbn'].'" />';
        }
    if(isset($_POST['keyword']))
        {
            echo '<input type="hidden" name="keyword" value="'.$_POST['keyword'].'" />';
        }
    if(isset($_POST['sort']))
    {
        echo '<input type="hidden" name="sort" value="'.$_POST['sort'].'" />';
    }

?> 
```

希望这会对您有所帮助:) 如果需要任何其他帮助，请告诉我 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T01:06:17.837

在我看来，你为什么要进行如此激烈的排序？您可以简单地通过 php 在表格中显示结果，用于 `jquery`以任何方式对表格进行排序

[http://tablesorter.com/docs/](http://tablesorter.com/docs/)
[http://joequery.github.com/Stupid-Table-Plugin/](http://joequery.github.com/Stupid-Table-Plugin/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-29T00:58:23.580

当您使用“ORDER BY”时，您正在对结果集进行排序，而不是对数据库本身进行排序。如果您想获取结果的新副本，只需在没有 ORDER BY 的情况下进行。

此外，PHP 的三元 if 结构更适合这里。代替 ：

```
if(isset($_POST['title'])){
   $title = mysql_real_escape_string($_POST['title']);
} 
```

你可以说：

```
$title = (isset($_POST['title']) ? mysql_real_escape_string($_POST['title']) : ""); 
```

# html - 如何格式化 Opera 浏览器的输入占位符文本？

> ID：15694669
> 
> 赞同：5
> 
> 时间：2013-03-29T00:47:29.693
> 
> 标签：html, css, input, opera, placeholder

我使用下面的伪元素和伪类为占位符文本设置样式。这可以在除 Opera 之外的所有主要浏览器上完成工作。我的理解是 Opera 不支持样式占位符文本。有谁知道样式化 Opera 输入占位符文本的方法？

**CSS**

```
::-webkit-input-placeholder {
    color: red;
    font-size: 10px;
}
::-moz-placeholder {
    color: red;
    font-size: 10px;
}
:-moz-placeholder {
  color: red;
  font-size: 10px;
}
:-ms-input-placeholder {
  color: red;
  font-size: 10px;
}
input:-moz-placeholder {
    color: red;
    font-size: 10px;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-29T00:51:06.927

Firefox 和 WebKit 中现有的样式占位符的两种方式都是供应商前缀和非标准的，不应在生产中使用。为了面向未来，请使用 JavaScript 删除`placeholder`属性并使用`value`（与绑定占位符样式的类一起使用`placeholder`）表单字段或附加文本元素来模拟占位符功能。这将在包括 Opera 在内的浏览器（当前和未来的浏览器）中始终如一地工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-09T13:48:40.657

Opera 从版本 22.0.1471.70（2014 年 6 月 17 日）开始支持占位符文本样式，因此上述 CSS 现在可以使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-11T21:32:05.413

您可以像这样设置占位符的样式：

```
::-webkit-input-placeholder { /* Chrome/Opera/Safari */
  color: pink;
}
::-moz-placeholder { /* Firefox 19+ */
  color: pink;
}
:-ms-input-placeholder { /* IE 10+ */
  color: pink;
}
:-moz-placeholder { /* Firefox 18- */
  color: pink;
} 
```

我建议检查此链接以检查浏览器兼容性：[https ://caniuse.com/#search=input-placeholder](https://caniuse.com/#search=input-placeholder)

# java - 如何将字符串存储到哈希图/哈希表中？

> ID：15694676
> 
> 赞同：0
> 
> 时间：2013-03-29T00:49:04.570
> 
> 标签：java, hash, hashmap, hashtable

我的CS基础正在滑落......

如何将大量字符串存储到hashmap/hashtable中，这样就可以得到O(1)的那个字符串的查找时间？...

没有hashmap/hashtable的java库吗？...它似乎将一个值存储到hashmap，你必须存储'key'&'value'。我假设 'value' 是我要存储的字符串，那么我必须为'key'做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:51:37.253

Java具有内置支持；请看[`HashMap`](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)课。

如果您只想存储值，那么[`HashSet`](http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html)当键是值时，a 可能是更好的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T00:56:17.363

> 没有hashmap/hashtable的java库吗？

就在这里。事实上，Java SE 库中有 3 个类大致符合您的要求。（提示：HashSet、HashMap、Hashtable。）

您可以通过在线搜索 Javadocs 轻松找到它们。从这里开始 - [http://docs.oracle.com/javase/7/docs/api/index.html](http://docs.oracle.com/javase/7/docs/api/index.html)

如果其中一个不符合您的要求，则可以使用专业的 3rd 方库……您可以使用 Google 找到它们。

* * *

如果你想成为一名成功的 Java 程序员，你需要学习一些“搜索赋”，这样你就可以自己找到这些类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:58:05.180

如果您需要按键查找，则使用 HashMap；如果您不这样做并且对索引访问感到满意，请使用 ArrayList。

有关 Big-O 的讨论，请参见以下内容：

*   [http://www.coderfriendly.com/wp-content/uploads/2009/05/java_collections_v2.pdf](http://www.coderfriendly.com/wp-content/uploads/2009/05/java_collections_v2.pdf)
*   [Java Collections Framework 实现的 Big-O 总结？](https://stackoverflow.com/questions/559839/big-o-summary-for-java-collections-framework-implementations)

# python - 泡菜和扭曲不兼容吗？

> ID：15694680
> 
> 赞同：0
> 
> 时间：2013-03-29T00:49:36.867
> 
> 标签：python, twisted, pickle

我做了 2 个应用程序：客户端从 sql 服务器（10k 行）中提取数据，并通过套接字将腌制的每一行发送到“收集器”服务器。服务器使用twisted（这是强制性的）并接收每一行，将其解压并将数据存储在另一个sql服务器中。

每次我开始从客户端向服务器发送数据时，在前 200 行（每次不同的行）**中，服务器**都会抛出异常：有时它类似于：

```
Traceback (most recent call last):
  File "collector2.py", line 81, in dataReceived
    self.count,account  = pickle.loads(data)
  File "/usr/lib/python2.6/pickle.py", line 1374, in loads
    return Unpickler(file).load()
  File "/usr/lib/python2.6/pickle.py", line 858, in load
    dispatch[key](self)
  File "/usr/lib/python2.6/pickle.py", line 1138, in load_pop
    del self.stack[-1]
IndexError: list assignment index out of range 
```

但并非每次都一样。打印我的异常我红色：异常：从空列表中弹出异常：列表索引超出范围异常：“'”异常：列表分配索引超出范围

另一个奇怪的错误是：文件“/usr/lib/python2.6/pickle.py”，第 1124 行，在 find_class **导入**（模块）异常中。ImportError: No module named ond'

```
for i in listaSAI:
    crm={}
    try:
        crm['uid']=i[0]
    except:
        crm['uid']=None
    try:
        crm['type_cond']=i[01]
    except:
        crm['type_cond']=None
    try:
        crm['population_id']=i[2]
    except:
        crm['population_id']=None
    try:
        crm['product_id']=i[3]
    except:
        crm['product_id']=None
    try:
        crm['a_id']=i[4]
    except:
        crm['a_id']=None
    try:
        crm['status']=i[5]
    except:
        crm['status']=None
    #time.sleep(0.001)
    serialized = pickle.dumps((count,crm))
    #print "sent num", count, crm
    s.sendall(serialized)
    count += 1 
```

还有我的服务器：

```
def dataReceived(self, data):
    try:
        self.count,account  = pickle.loads(data)        
    except Exception as e:
        print "Eccezione:", e
        print self.count+1
        print "DISAGIO", data
        print traceback.print_exc() 
```

在我的客户端打印数据告诉我一切正常。 *如果我尝试在客户端使用 time.sleep(0.01) 减慢发送过程，一切都很好，并且不会引发异常。*

我可以做些什么来调试我的代码？

ps 我怀疑 exceptions.ImportError: No module named ond' 指的是 crm 中的“type_cond”键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T05:47:09.650

由于在写入之间添加延迟时没有问题，很明显问题与pickle无关，而是与数据的传输有关。

一种选择是客户端将数据写入套接字的速度比服务器处理它的速度更快，从而导致缓冲区溢出和数据包丢失。

或者，您是否有多个线程可能同时写入套接字？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T12:14:54.817

您的协议没有框架，并且您尝试使用 SOCK_STREAM（TCP 连接），就好像它是面向数据报的（即，作为 SOCK_DGRAM，如 UDP）。

因此，您发送一些构成完整腌制数据集的字节，但服务器不知道特定腌制数据集的开始或结束位置。相反，接收代码会尝试解开碰巧传送给它的任何随机字节块。

正如您所发现的，这有时会起作用。但是，不能保证您传递给的字节`sock.sendall`将作为单个组传递给`dataReceived`. 您必须添加框架，以便接收者可以发现消息边界。有几种方法可以解决这个问题。一种方法是添加长度前缀。然后接收者知道要等待多少字节，并在收到正确的数字时将它们解开。

当然，您永远不应该解开通过网络接收到的数据。[看到http://docs.python.org/2/library/pickle.html](http://docs.python.org/2/library/pickle.html)上的大红框了吗？它之所以存在，是因为如果您编写一个像您在这里展示的那样的服务器，那么您已经编写了一个带有远程任意代码漏洞的服务器，该漏洞大到足以驱动半程。

由于您的数据看起来相当简单且结构化，因此我建议您改用[AMP 。](http://amp-protocol.net/)

# c# - 运行 Azure 模拟器时出现 AUTHENTICATION 错误（请解决此问题）

> ID：15694683
> 
> 赞同：1
> 
> 时间：2013-03-29T00:50:06.797
> 
> 标签：c#, azure

我在使用 Azure 模拟器时遇到了一些丑陋的问题，主要是它一直在尝试连接到我的本地地址，但没有找到它的代理，并且模拟器无法初始化我的 Web 角色（显然）

错误 ：

```
WinHttpGetProxyForUrl(http://127.0.0.1) failed ERROR_WINHTTP_AUTODETECTION_FAILED 
```

我知道有这样的问题，但是每个人都回答“它不应该连接到您的本地地址，更改它”......我知道，现在，谁能告诉我如何更改它？

# java - 如果我向浏览器发送以下响应，我应该得到任何反馈吗？

> ID：15694686
> 
> 赞同：-1
> 
> 时间：2013-03-29T00:50:21.343
> 
> 标签：java, html, io, stream

对于一项任务，我编写了一个服务于 HTML 文件的服务器，并且我应该使用我的 Web 浏览器作为测试客户端。我还被告知，如果有一个不存在的文件的请求，我应该发送以下内容 `HTTP/1.1 404 Not Found\r\n\r\n`，如果还有其他问题

`HTTP/1.1 500 Internal Server Error\r\n\r\n"`

我已经运行了应该导致发送的测试，但是我的浏览器窗口中没有任何反应？我应该从发送此类请求中获得任何视觉反馈吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:53:58.500

在 HTML 响应中，每一行之后应该只有一个 CRLF（回车和换行）。所以你可以先去掉多余的`\r\n`.

同样在第二行，您可以将 HTML 响应发送回客户端，说明如果您想显示错误是什么错误。这通常是典型的 Web 服务器所做的，如果没有定义，它有默认的错误页面。如果您不发送任何 HTTP 标头，那么您可以插入要发送回的 HTML 正文，例如`<h1> No page found</h1>`第二行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:05:27.133

在 http 响应中包含“实体”

```
HTTP/1.1 404 Not Found
Content-Type: text/html
Content-Length: 10

01234576789 
```

每行以 CRLF 结束。请务必正确计算 Content-Length。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T02:08:26.800

我看到这是一个学习练习，并且了解您*可能*已被*告知*以这种方式实现服务器。但记住这一点......

* * *

这是实现 Web 服务器/服务的错误方法。正确的方法是找到现有的实现并在此基础上构建您的服务。

*   您可以使用 Java EE Web 容器；即实现 Servlets 规范的东西。
*   您可以使用非 servlet 框架（如 Grizzly）。
*   您可以构建在服务器端 HTTP 协议栈之上；例如使用 Apache 的 HttpComponent 库。

如果您要正确地从头开始构建 Web 服务器，则需要做很多工作。以及您无法正确执行此操作的机会；即，您不会根据 HTTP 规范所说的服务器应该如何运行来实现您的服务。你会遗漏一些事情，以错误的方式做事，等等。

请不要这样做。那里已经有太多损坏的（即不合规的）Web 服务器。我们不需要更多。

如果您决定从头开始实施 HTTP，那么您（您）需要彻底阅读和*理解*HTTP 规范。而且您（您）需要对浏览器如何实现规范的客户端进行自己的基础研究......以及因此您需要在服务器端做什么才能使浏览器“正常”运行。

# vb.net - 如何查看 WebBrowser 中的任何链接是否包含字符串？VB.NET

> ID：15694689
> 
> 赞同：0
> 
> 时间：2013-03-29T00:50:40.277
> 
> 标签：vb.net, string, process, browser

我正在构建一个网络浏览器，如果单击一个链接，如果该链接包含某个字符串，那么我希望打开一个不同的程序：

```
Private Sub WebBrowser1_Navigated(ByVal sender As Object, ByVal e As System.Windows.Forms.WebBrowserNavigatedEventArgs) Handles WebBrowser1.Navigated
If WebBrowser1.Document.Links.Contains("STRING") Then
        Process.Start("PROGRAM I WANT TO OPEN")
End If
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:16:44.493

Try using

```
If InStr(e.Url.ToString, "String") Then
   Process.Start("Program I want to open")
End if 
```

# scala - 自动化路由的 REST API 文档

> ID：15694690
> 
> 赞同：10
> 
> 时间：2013-03-29T00:50:43.213
> 
> 标签：scala, spray

是否可以在 Spray 应用程序中自动记录路线？

例如，是否有一个 SBT 插件可以生成降价描述它对喷射路线的了解？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-11T15:01:42.193

我在研究同样的东西时偶然发现了[spray-swagger](https://github.com/gettyimages/spray-swagger)，但我不知道它到底做了什么以及项目处于哪个阶段。

# python - 客户端-服务器模型的 Python 套接字支持/线程

> ID：15694695
> 
> 赞同：1
> 
> 时间：2013-03-29T00:51:29.063
> 
> 标签：python, multithreading, sockets

因此，我正在尝试编写一个非常简单的客户端-服务器系统，该系统对 UDP 进行一些拥塞控制。简单地说，服务器发送数据包并从客户端接收反馈包。我对此很陌生，不确定：

(1) 同一个socket可以连接多少个用户？

(2) 多个用户可以同时使用一个套接字（也就是并行读/写）？

（3）我需要使用线程，以便对于每个用户，我可以向他们发送数据包并并行接收来自他们的反馈包。我在另一篇文章中读到，不应该为每个用户打开线程（我为每个用户打开两个线程）。我这样做有错吗？我有一个固有的误解吗？有人对如何处理这个有建议吗？

对不起，我对此很陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T01:01:12.697

(1) 连接到套接字的数量受操作系统限制，但可以达到 100k 或更多检查[C10K](http://www.kegel.com/c10k.html)问题

(2) 一个socket可以被多个线程甚至多个进程使用pre-fork方式

(3) 您可以为每个连接使用一个新线程，但最好的方法是使用线程池，或者您可以使用异步方法并避免使用线程

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T01:38:43.730

根据以下文件[`socket.listen()`](http://docs.python.org/2/library/socket.html#socket.socket.listen)：

> 监听到套接字的连接。backlog 参数指定排队连接的最大数量，应至少为 0；最大值取决于系统（通常为 5），最小值强制为 0。

所以从技术上讲，请求不是并行处理而是排队处理，直到通常最多 5 个。我不知道你提到的帖子的作者必须声明你不应该为每个用户启动一个线程的原因，但我已经读到大多数服务器每个请求使用一个线程。线程池也是一种常见的模式，它可以很容易地使用同步对象来实现`Queue`（如果你想看到一个小的实现，[这个例子](http://code.activestate.com/recipes/577187-python-thread-pool/)可能很有用）。

# c# - 折叠后取消选择 TreeView 项

> ID：15694705
> 
> 赞同：0
> 
> 时间：2013-03-29T00:52:58.337
> 
> 标签：c#, wpf, treeview

我有一个看起来像这样的 TreeView：

```
Section1
  item1
  item2
Section2
  item1
  item2 
```

在我的项目中，永远不能选择“部分”元素，因此在我的 xaml 中，我已将其禁用，如下所示：

```
<TreeView.ItemContainerStyle>
     <Style TargetType="{x:Type TreeViewItem}">
     <Setter Property="Focusable" Value="{Binding HasDetails}"/>
     </Style>
</TreeView.ItemContainerStyle> 
```

这很好用，我可以选择“项目”元素，但不能选择“部分”元素。我的问题是当我选择了一个“项目”然后折叠“部分”时，“部分”元素被选中。我该如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T02:08:51.453

您可以在 TreeViewItem 上使用 Selected 事件（参考：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.selected.aspx ）。](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.selected.aspx)

当 Section1 或 Section2 触发此事件时，您可以将 TreeViewItem 上的 IsSelected 属性（参考：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.isselected.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.isselected.aspx)）设置为错误的。

您还可以在 TreeView 本身上使用 SelectedItemChanged 事件（参考：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.treeview.selecteditemchanged.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeview.selecteditemchanged.aspx)）取消选择特定项目.

确保在设置 IsSelect 属性之前取消订阅，否则事件可能会触发多次。并且不要忘记在设置 IsSelect 属性后重新订阅该事件。

编辑：或者更好的是，使用 TreeViewItem 上的 Collapsed 事件（参考：http: [//msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.collapsed.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.treeviewitem.collapsed.aspx)）。

# c - 理解 wait() 和 signal()

> ID：15694712
> 
> 赞同：0
> 
> 时间：2013-03-29T00:53:43.773
> 
> 标签：c, signals, deadlock, wait

我有 2 个进程 P1 和 P2 共享 3 个信号量（s1、s2、s3），每个信号量的初始值为 1，还有 3 个变量（x、y、z）

```
P1:                  P2:
wait(s1);            wait(s2);  
x = x + 1;           y = y * 2;
wait(s2);            wait(s3);
y = y - x;           z = z - y;
wait(s3);            signal(s2);
z = x + 2 * y - z;   wait(s1);
signal(s3);          x = x + 2;
signal(s2);          signal(s1);
signal(s1);          signal(s3); 
```

如果我要在具有单个 CPU 的计算机上同时运行它们，P1 和 P2 是否有可能陷入死锁？

我的看法是，一旦它们开始运行，它们都会等待（），这会导致它们坐下来，直到有信号（）它们。既然没有其他东西在运行，那么它们不是都陷入僵局了吗？我觉得我错过了一些非常简单的知识，这些知识阻碍了我的理解。任何见解表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:02:19.333

当 P2 等待（s1）时，s1 必须在 P1 的手中，所以 P2 不能继续发信号（S3），然后 P1 永远等待（s3）。这就是僵局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:08:48.160

您示例中的三个信号量初始化为 1，因此不会在每个进程的第一行阻塞。

现在考虑这个示例运行：

*   P2 一直运行到 wait(s1)，就在该语句执行之前。此时，信号量 s2 和 s1 的计数为 1，s3 的计数为 0。
*   现在 P1 执行直到它无法获取的 wait(s3)，因为它的值是 0，但是为了到达那里它已经获得了 s1 和 s2 的所有权
*   现在 P2 恢复执行，但在等待 s1 时立即被阻塞

此时，两个进程都处于死锁状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T01:15:02.153

## 两种死锁

**1）信号（消耗资源）**

– 每个任务都在等待另一个任务的信号 – 无法退出

**2) 单元（可重用资源）**

*   每个任务都在等待另一个任务释放资源单元。可以通过中止任务来退出，直到有足够的资源可用以释放其他任务。

**信号死锁**

![图：信号死锁](../Images/29df7297ca098b7c85bf5f720f306565.png)

最初，信号量 a 和 b 都是 1。 死锁

```
 if P1 and P2 complete their
first wait’s simultaneously before
attempting their second wait’s 
```

.

**可能不容易测试信号死锁：**

![不容易测试](../Images/0f500f0ec0a5b33a2c2b801c721d626c.png)

可能导致死锁

```
 if P1 calls T(a,b) and
P2 calls T(b,a) at the same time. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-29T01:00:13.067

不，因为它们是不同的过程。我认为您在谈论互斥锁对吗？

# javascript - Java Script 将悬停状态应用于 div 的问题

> ID：15694714
> 
> 赞同：0
> 
> 时间：2013-03-29T00:53:45.887
> 
> 标签：javascript, html, hover, children, nav

我的同事今天帮助我编写了这个脚本，它在我的测试示例中运行良好，但是当我尝试将它合并到我的网站设计中时它不起作用。对象是使用 div(boxEnd) 来倾斜和圆化菜单栏末端的角，并应用最后一个菜单项 (menlast) 的悬停状态。在我的示例中，我只有一个“a”元素，但是当我添加第二个元素时，悬停状态被两个“a”元素应用于 div。所以我需要修复当前代码以利用脚本，并弄清楚如何仅在最后一个菜单项悬停时调用脚本。

```
<script>
$(document).ready(function() {
    $('nav').hover(function() {
        $(this).children('a').children('#boxEnd').css('background-color','#ffffff');
    }, function() {
        $(this).children('a').children('#boxEnd').css('background-color','#ff2d0a');
    });
});
</script>

</head>

<body>

<!-- TOP NAV -->

<div id="NAVcontainer">
<div align="center" id="topnav">
  <div align="left" id="logo"><img src="images/mml-3-24-264x102.png"/></div>
  <div align="left" id="menu">
    <nav> 
    <a href="#home">Home</a>
    <a href="#about">About</a>
    <a href="#portfolio">Portfolio</a>
    <a id="menlast" href="#contact">Contact
    <div id="boxEnd">&emsp;</div></a>
    </nav>
  </div>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:03:37.670

当你菊花链 $().children 它不会抓住所有孩子的所有孩子。它只会得到第一个孩子的孩子。如果这是您的实际 HTML，那么您想要

```
$('nav').hover(function() { $('#boxEnd').css(...); }); 
```

不需要考虑nav 和#boxEnd 之间的关系。$('#boxEnd') 总是会找到正确的 div。

这假设您发布的代码是您尝试解决问题，而不是您添加第二个“a”后最初的代码。如果那是错误的，我将使用更多详细信息进行编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:20:41.933

只需在.children('a')后面加上.end() [http://api.jquery.com/end/](http://api.jquery.com/end/) .end() 说明：结束当前链中最近的过滤操作，返回匹配的元素集合到它以前的状态。

所以本质上是 $(this).children('a').end().children('#boxEnd').css('background-color','#ffffff');

见小提琴 [http://jsfiddle.net/v3szF/5/](http://jsfiddle.net/v3szF/5/)

```
 $('nav').hover(function() {
    $(this).children('a').end().children('#boxEnd').css('background-color','#ffffff');
}, function() {
    $(this).children('a').end().children('#boxEnd').css('background-color','#ff2d0a');
}); 
```

# c# - 异常后 SerialPort 不存在

> ID：15694717
> 
> 赞同：2
> 
> 时间：2013-03-29T00:53:57.333
> 
> 标签：c#, serial-port, usbserial

我正在使用 C# 的 SerialPort 类通过 USB COM 端口进行通信。SerialPort 可以正常打开并正常工作，直到发生异常。当我尝试通过我的应用程序使用端口时出现异常后，我得到另一个异常：“端口'COM6'不存在。” 关闭应用程序、重新启动 Visual Studio 等后，我不断收到异常。恢复端口的唯一方法是重新启动计算机。

有没有人看到这个问题并知道解决方法？我需要这个更耐用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-08T08:40:30.097

通常，由于您的 USB 转串行驱动程序未正确编写以处理异常，因此会发生此类问题。

与其重新启动机器，不如尝试拔下并重新插入（几秒钟后）。通过这样做，以前的实例可能会卸载，并且在插入它时，它将再次加载相关的驱动程序。

这将在设备管理器中枚举一个 com 编号（在您的情况下为 Com6）。

有一种方法可以使用以下链接中给出的“devcon.exe”重新启动 USB 连接。

[http://digital.ni.com/public.nsf/allkb/1D120A90884C25AF862573A700602459](http://digital.ni.com/public.nsf/allkb/1D120A90884C25AF862573A700602459)

您可以将其集成到控制台应用程序并重新连接您的 USBTOSerial 而无需重新启动您的机器

# python - 使用 Python 将定时函数编码到基于文本的游戏中

> ID：15694721
> 
> 赞同：3
> 
> 时间：2013-03-29T00:54:26.333
> 
> 标签：python

我正在用 Python 编写一个简单的基于文本的冒险游戏。无论用户做什么，我都希望某些进程定期发生，大约每 2 分钟一次。例如：让NPC在房间里走动，让人们饥渴难耐，让人们治愈，在战斗中，让战斗继续进行。现在，我正在使用“raw_input”从用户那里获取命令，但这实际上会暂停代码。即使用户只是坐在那里并且没有输入任何内容，我怎样才能让游戏继续进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:04:09.183

我认为通常在这种情况下，您不会有后台进程或线程进行计算。相反，当用户输入一些响应时，会执行时间增量，并根据输入之间的经过时间计算玩家将治愈多少以及战斗事件会发生什么等。也就是说，如果您不想要控制台更新而游戏正在等待用户响应。

编辑：或尝试这样的事情：

```
import time
import sys

win32 = True
try:
    from msvcrt import kbhit, getch
    print "[+] Running on windows, using msvcrt."
except ImportError:
    print "[+] Not running on windows, attempting unix-like."
    win32 = False

    import termios, fcntl, sys, os
    import select
    fd = sys.stdin.fileno()

    oldterm = termios.tcgetattr(fd)
    newattr = termios.tcgetattr(fd)
    newattr[3] = newattr[3] & ~termios.ICANON & ~termios.ECHO
    termios.tcsetattr(fd, termios.TCSANOW, newattr)

    oldflags = fcntl.fcntl(fd, fcntl.F_GETFL)
    fcntl.fcntl(fd, fcntl.F_SETFL, oldflags | os.O_NONBLOCK)

POLLTIME = 5
done = False
command = ""
while not done:

    sys.stdout.write("\r")
    print("Something happened (polling)%s" % (" " * command.__len__() ))
    sys.stdout.write("Enter command: %s" % command)
    sys.stdout.flush()

    t = time.time()
    if win32:
        while time.time() - t < POLLTIME:
            if kbhit():
                c = getch()
                if ord(c) < 127 and ord(c) > 31:
                    command += c
                    message = "\rEnter command: " + command
                    sys.stdout.write("\r%s" % message)
                if "\r" == c:
                    if "quit\r" == command:
                        done = True
                        break
                    sys.stdout.write("\rThe command was: %s\n" % command)
                    command = ""
                    sys.stdout.write("\rEnter command: %s \b" %command)
                elif "\b" == c:
                    command = command[:-1]
                    sys.stdout.write("\rEnter command: %s \b" %command)
                sys.stdout.flush()
    else:
        while time.time() - t < POLLTIME:
            try:
                c = '\0'                
                if sys.stdin in select.select([sys.stdin], [], [], 0)[0]:
                    c = sys.stdin.readline(1)
                    if ord(c) < 127 and ord(c) > 31:
                        command += c
                        message = "\rEnter command: " + command
                        sys.stdout.write("\r%s" % message)
                if c == "\n":
                    if "quit" == command:
                        done = True
                        break
                    print("\rThe command was: %s" % command)
                    command = ""
                    message = "\rEnter command: " + command
                    sys.stdout.write("\r%s" % message)
                if 127 == ord(c):
                    command = command[:-1]
                    sys.stdout.write("\rEnter command: %s \b" % command)
                sys.stdout.flush()

            except IOError:
                    pass 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:14:50.573

There are ways to read user input without pausing the code. It's called "asynchronous I/O" or "non-blocking I/O". One way to do it is to create a separate thread to listen to the user's requests and queue them to process inside your game loop.

This question and its answers explain how to do non-blocking I/O in Python: [Non-blocking read on a subprocess.PIPE in python](https://stackoverflow.com/questions/375427/non-blocking-read-on-a-subprocess-pipe-in-python)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T11:21:26.493

我不确定如何在不使用单独线程的情况下做到这一点（并且很容易使用单独的线程）。

但我的观点是：看起来您的基于文本的函数是基于事件/命令的应用程序？即如果用户没有进一步的命令/事件，客户端状态不会改变？不确定您尝试使用定时功能监控什么，但如果您的应用程序尚未基于事件，即从用户执行/发送的事件集中聚合状态，那么您可能希望使您的应用程序成为事件-based，然后您可以摆脱定时功能。希望有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T01:00:06.877

答案是——不要为控制台写实时！如果你想做这个基于文本的，你可能希望切换到 Tkinter。这将允许您单独执行这些操作 - 并在这些周期性事件期间显示文本，*并*使用简单的 .after() 调用来执行它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-29T01:03:19.400

1.  对每次输入后的时间进行采样（取决于您是仅对成功的命令执行此操作，还是可选地包括无效的命令）。

2.  将此时间与之前的样本进行比较，然后除以某个世界刻度间隔。

3.  遍历每个刻度发生的活动列表（`for npc in npcs: npc.move_to_adjacent_posn()`例如）。

# elasticsearch - Elasticsearch 中的分片和副本

> ID：15694724
> 
> 赞同：407
> 
> 时间：2013-03-29T00:55:01.357
> 
> 标签：elasticsearch, full-text-search

我试图了解 Elasticsearch 中的分片和副本是什么，但我没能理解它。如果我下载 Elasticsearch 并运行脚本，那么据我所知，我已经启动了一个具有单个节点的集群。现在这个节点（我的 PC）有 5 个分片（？）和一些副本（？）。

它们是什么，我有 5 个重复的索引吗？如果是，为什么？我可能需要一些解释。

* * *

## 回答 #1

> 赞同：1298
> 
> 时间：2013-03-29T15:11:40.830

我将尝试用一个真实的例子来解释，因为你得到的答案和回复似乎对你没有帮助。

当您下载 elasticsearch 并启动它时，您会创建一个 elasticsearch 节点，该节点会尝试加入现有集群（如果可用）或创建一个新集群。假设您使用单个节点创建了自己的新集群，即您刚刚启动的那个。我们没有数据，因此我们需要创建一个索引。

创建索引时（索引第一个文档时也会自动创建索引），您可以定义它将由多少个分片组成。如果您不指定数字，它将具有默认的分片数：5 个主分片。这是什么意思？

这意味着 elasticsearch 将创建 5 个包含您的数据的主分片：

```
 ____    ____    ____    ____    ____
| 1  |  | 2  |  | 3  |  | 4  |  | 5  |
|____|  |____|  |____|  |____|  |____| 
```

每次为文档编制索引时，elasticsearch 都会决定哪个主分片应该保存该文档并将其编入索引。主分片不是数据的副本，它们是数据！拥有多个分片确实有助于利用单台机器上的并行处理，但重点是，如果我们在同一个集群上启动另一个弹性搜索实例，分片将以均匀的方式分布在集群上。

例如，节点 1 将仅保存三个分片：

```
 ____    ____    ____ 
| 1  |  | 2  |  | 3  |
|____|  |____|  |____| 
```

由于剩余的两个分片已经移动到新启动的节点：

```
 ____    ____
| 4  |  | 5  |
|____|  |____| 
```

为什么会这样？因为elasticsearch是一个分布式搜索引擎，这样你就可以利用多个节点/机器来管理大量数据。

每个弹性搜索索引都由至少一个主分片组成，因为这是存储数据的地方。但是，每个分片都是有代价的，因此，如果您只有一个节点并且没有可预见的增长，请坚持使用单个主分片。

另一种类型的分片是副本。默认值为 1，这意味着每个主分片将被复制到另一个包含相同数据的分片。副本用于提高搜索性能和故障转移。副本分片永远不会分配在相关主节点所在的同一节点上（这几乎就像将备份放在与原始数据相同的磁盘上）。

回到我们的示例，对于 1 个副本，我们将在每个节点上拥有整个索引，因为将在第一个节点上分配 2 个副本分片，它们将包含与第二个节点上的主分片完全相同的数据：

```
 ____    ____    ____    ____    ____
| 1  |  | 2  |  | 3  |  | 4R |  | 5R |
|____|  |____|  |____|  |____|  |____| 
```

第二个节点也是如此，它将包含第一个节点上的主分片的副本：

```
 ____    ____    ____    ____    ____
| 1R |  | 2R |  | 3R |  | 4  |  | 5  |
|____|  |____|  |____|  |____|  |____| 
```

通过这样的设置，如果一个节点出现故障，您仍然拥有整个索引。副本分片将自动成为主分片，尽管节点发生故障，集群仍将正常工作，如下所示：

```
 ____    ____    ____    ____    ____
| 1  |  | 2  |  | 3  |  | 4  |  | 5  |
|____|  |____|  |____|  |____|  |____| 
```

由于您拥有`"number_of_replicas":1`，因此无法再分配副本，因为它们永远不会分配在其主节点所在的同一节点上。这就是为什么您将拥有 5 个未分配的分片、副本和集群状态，`YELLOW`而不是`GREEN`. 没有数据丢失，但它可能会更好，因为无法分配一些分片。

备份离开的节点后，它将再次加入集群并重新分配副本。可以加载第二个节点上的现有分片，但它们需要与其他分片同步，因为写入操作很可能发生在节点关闭时。此操作结束时，集群状态将变为`GREEN`。

希望这可以为您澄清事情。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-03-29T05:34:40.057

索引被分解成碎片以便分布和扩展。

副本是分片的副本，并在节点丢失时提供可靠性。这个数字经常会混淆，因为这`replica count == 1`意味着集群必须具有可用的主副本和副本副本才能处于绿色状态。

为了创建副本，您的集群中必须至少有 2 个节点。

您可能会发现这里的定义更容易理解： [http ://www.elasticsearch.org/guide/reference/glossary/](http://www.elasticsearch.org/guide/reference/glossary/)

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2018-04-18T06:25:19.347

**分片：**

1.  作为分布式搜索服务器，`ElasticSearch`使用称为 `Shard`跨所有节点分布索引文档的概念。
2.  一个`index`可能存储大量可能超出硬件限制的数据`single node`
3.  例如，占用 1TB 磁盘空间的十亿个文档的单个索引可能不适合单个节点的磁盘，或者可能太慢而无法单独处理来自单个节点的搜索请求。
4.  为了解决这个问题，`Elasticsearch`提供了将索引细分为多个称为`shards`.
5.  创建索引时，您可以简单地定义所需的数量`shards` 。
6.  `Documents`存储在 中`shards`，并且分片被分配到`nodes`您的`cluster`
7.  随着您的`cluster`增长或缩小，`Elasticsearch`将自动在分片之间迁移`nodes`，以`cluster`保持平衡。
8.  分片可以是 a`primary shard`或 a `replica shard`。
9.  索引中的每个文档都属于一个`single primary shard`，因此您拥有的主分片的数量决定了您的索引可以容纳的最大数据量
10.  A`replica shard`只是主分片的副本。

**复制品：**

1.  `Replica shard`是 的副本`primary Shard`，以防止硬件故障时数据丢失。
2.  `Elasticsearch`允许您将索引分片的一个或多个副本制作成所谓的副本分片或`replicas`简称。
3.  An`index`也可以被复制零次（意味着没有副本）或多次。
4.  `number of shards`和副本可以在创建索引时为每个索引定义。
5.  创建索引后，您可以随时动态更改副本的数量，但`cannot change the number of shards` 事后。
6.  默认情况下，每个索引`Elasticsearch`分配 5 个主分片，`1 replica`这意味着如果您的集群中至少有两个节点，您的索引将有 5 个主分片和另外 5 个副本分片（1 个完整副本），每个分片总共 10 个分片指数。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-01-14T01:18:13.017

如果你真的不喜欢看到它是黄色的。您可以将副本数设置为零：

```
curl -XPUT 'localhost:9200/_settings' -d '
{
    "index" : {
        "number_of_replicas" : 0
    }
}
' 
```

请注意，您应该只在本地开发盒上执行此操作。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-04-01T06:07:43.387

索引被分解成碎片以便分布和扩展。

副本是分片的副本。

节点是属于集群的弹性搜索的运行实例。

一个集群由一个或多个共享相同集群名称的节点组成。每个集群都有一个由集群自动选择的主节点，如果当前主节点发生故障，可以替换该主节点。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2020-04-18T21:28:36.187

用最简单的术语来说，`shard`它只不过是存储在磁盘上单独文件夹中的索引的一部分：

[![Elasticsearch 分片](../Images/298f51c579200a9de14a104811064570.png)](https://i.stack.imgur.com/OeylD.png)

此屏幕截图显示了整个 Elasticsearch 目录。

如您所见，所有数据都进入`data`目录。

通过检查索引`C-mAfLltQzuas72iMiIXNw`，我们看到它有五个分片（文件夹`0`到`4`）。

另一方面，`JH_A8PgCRj-GK0GeQ0limw`索引只有一个分片（`0`文件夹）。

[![Elasticsearch 分片](../Images/e6ef958a1899c83855ea0f5a5a7ff479.png)](https://i.stack.imgur.com/d2bFU.png)

显示`pri`分片的总数。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2018-06-01T10:55:43.903

我将使用真实的场景来解释这一点。想象一下，您是一个正在运行的电子商务网站。随着您变得越来越受欢迎，更多的卖家和产品会添加到您的网站。您将意识到您可能需要索引的产品数量已经增加，并且它太大而无法容纳在一个节点的一个硬盘中。即使它适合硬盘，在一台机器中对所有文档执行线性搜索也非常慢。一个节点上的一个索引不会利用 elasticsearch 工作的分布式集群配置。

所以 elasticsearch 将索引中的文档拆分到集群中的多个节点上。文档的每个拆分都称为一个分片。每个携带文档分片的节点将只有文档的一个子集。假设您有 100 个产品和 5 个分片，每个分片将有 20 个产品。这种数据分片使弹性搜索中的低延迟搜索成为可能。搜索在多个节点上并行进行。结果被汇总并返回。然而，分片不提供容错。这意味着如果包含分片的任何节点关闭，集群运行状况将变为黄色。这意味着某些数据不可用。

为了提高容错性，副本出现在图片中。默认情况下，弹性搜索会为每个分片创建一个副本。这些副本总是在主分片不驻留的其他节点上创建。因此，为了使系统具有容错性，您可能必须增加集群中的节点数量，这还取决于索引的分片数量。根据副本和分片计算所需节点数的通用公式是“节点数=分片数*（副本数+1）”。标准做法是至少有一个副本以进行容错。

**设置分片数量是一个静态操作，这意味着您必须在创建索引时指定它。之后的任何更改都需要完全重新索引数据，并且需要时间。但是，设置副本数量是一个动态操作，也可以在创建索引后的任何时间完成。**

您可以使用以下命令为您的索引设置分片和副本的数量。

```
curl -XPUT 'localhost:9200/sampleindex?pretty' -H 'Content-Type: application/json' -d '
{
  "settings":{
    "number_of_shards":2,
    "number_of_replicas":1
  }
}' 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-07-29T08:58:53.043

不是答案，而是ElasticSearch[核心概念](https://www.elastic.co/guide/en/elasticsearch/reference/6.2/_basic_concepts.html#_basic_concepts)的另一个参考，我认为它们很明显是对@javanna 答案的补充。

### 碎片

> 索引可能会存储大量数据，这些数据可能超出单个节点的硬件限制。例如，占用 1TB 磁盘空间的十亿个文档的单个索引可能不适合单个节点的磁盘，或者可能太慢而无法单独处理来自单个节点的搜索请求。
> 
> 为了解决这个问题，Elasticsearch 提供了将您的索引细分为多个称为分片的片段的能力。创建索引时，您可以简单地定义所需的分片数量。每个分片本身就是一个功能齐全且独立的“索引”，可以托管在集群中的任何节点上。
> 
> 分片之所以重要，主要有两个原因：
> 
> *   它允许您**水平拆分/缩放**您的内容量。
> *   它允许您跨分片（可能在多个节点上）分布和并行化操作，从而**提高性能/吞吐量**。

### 复制品

> 在随时可能出现故障的网络/云环境中，非常有用且强烈建议使用故障转移机制，以防分片/节点因某种原因脱机或消失。为此，Elasticsearch 允许您将索引分片的一个或多个副本制作成所谓的副本分片或简称副本。
> 
> 复制之所以重要，主要有两个原因：
> 
> *   它在分片/节点失败的情况下提供**高可用性**。出于这个原因，重要的是要注意，副本分片永远不会与从中复制它的原始/主分片分配在*同一节点上。*
> *   它允许您**扩展搜索**量/吞吐量，因为搜索可以在所有副本上并行执行。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-03-23T16:03:15.433

[Elasticsearch](https://fullstackgeek.blogspot.com/2019/03/introduction-to-elasticsearch-and-elk-stack.html)具有极好的可扩展性，所有功劳都归功于其分布式架构。由于分片，这成为可能。现在，在进一步讨论之前，让我们考虑一个简单且非常常见的用例。让我们假设，您有一个包含大量文档的索引，为了简单起见，考虑该索引的大小为 1 TB（即，该索引中每个文档的大小总和为 1 TB ）。此外，假设您有两个节点，每个节点都有 512 GB 的空间可用于存储数据。可以清楚地看到，我们的整个索引不能存储在可用的两个节点中的任何一个中，因此我们需要在这些节点之间分配索引。

在这种情况下，索引的大小超过了单个节点的硬件限制，[Sharding](https://fullstackgeek.blogspot.com/2019/03/introduction-to-elasticsearch-and-elk-stack.html)就派上用场了。分片通过将索引分成更小的部分来解决这个问题，这些部分被称为碎片。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-26T06:51:52.320

在 ElasticSearch 中，我们在顶层将文档索引到索引中。每个索引都有多个分片，内部分布数据，分片内部存在 Lucene 段，它是数据的核心存储。因此，如果索引有 5 个分片，则意味着数据已分布在各个分片中，并且分片中不存在相同的数据。

注意解释 ES 核心的视频 [https://www.youtube.com/watch?v=PpX7J-G2PEo](https://www.youtube.com/watch?v=PpX7J-G2PEo)

关于多个索引或多个分片的文章 [弹性搜索，多个索引与一个索引和不同数据集的类型？](https://stackoverflow.com/questions/14465668/elastic-search-multiple-indexes-vs-one-index-and-types-for-different-data-sets)

# jquery - 这个modernizr/jQuery 图像旋转器是如何工作的？

> ID：15694725
> 
> 赞同：0
> 
> 时间：2013-03-29T00:55:06.807
> 
> 标签：jquery, html, modernizr

由于我的问题，我可能会得到负面的分数，但它就是这样。我对[www.bungie.net](http://www.bungie.net)上的这种现代设计非常感兴趣。半全屏滑块太棒了，我想知道它是如何工作的。我知道它使用modernizr 并且不太确定jquery，但谁能告诉我如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:14:51.190

您可以在此处仅使用 css3 复制此 [http://tympanus.net/codrops/2012/01/02/fullscreen-background-image-slideshow-with-css3/](http://tympanus.net/codrops/2012/01/02/fullscreen-background-image-slideshow-with-css3/)

[http://buildinternet.com/project/supersized/](http://buildinternet.com/project/supersized/) 这里也是一个超大的 jquery 插件

如果您使用现代化工具，您可以使用 css 一个并为所有其他浏览器回退到另一个，它将仅基于 html 标签是否具有某个类

# ruby - 使用 Gem 时尾随 UTF-8 八位字节无效

> ID：15694732
> 
> 赞同：2
> 
> 时间：2013-03-29T00:56:31.533
> 
> 标签：ruby, utf-8, gem

每次我尝试在终端中运行 Ruby 命令时都会收到此错误。此时，我什至无法重新安装 RVM。错误如下所示：

```
/Users/ /.rvm/rubies/ruby-2.0.0-p0/lib/ruby/2.0.0/psych.rb:205:in `parse': (<unknown>): invalid trailing UTF-8 octet at line 1 column 1 (Psych::SyntaxError)
from /Users/ /.rvm/rubies/ruby-2.0.0-p0/lib/ruby/2.0.0/psych.rb:205:in `parse_stream' 
```

当我安装 RVM 时也会发生这种情况。如果我尝试运行任何命令，如 bundle update 或任何以 gem 开头的命令，我会得到同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T17:34:01.100

刚刚从另一个来源得到反馈，发现这实际上是 ruby​​gems 的问题，而不是 bundler 的问题。我的 ~/.gemrc 文件中有一些无效字节。我刚刚进入我的 .gemrc 文件并清除它并解决了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:45:40.643

看来是捆绑器的问题，请尝试手动更新

[https://github.com/rails/rails/issues/8136](https://github.com/rails/rails/issues/8136)

# google-app-engine - 我通过 AppEngine 将视频上传到 Google Cloud Storage。最有效的服务方式是什么？

> ID：15694735
> 
> 赞同：1
> 
> 时间：2013-03-29T00:57:23.157
> 
> 标签：google-app-engine, google-cloud-storage

与图像不同，没有像 images.get_serving_url() 这样的 API 来提供图像 blob。对于图像以外的东西，我们是否应该像处理 BlobStorage 中的对象一样设置下载处理程序并使用 send_blob()？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T09:13:39.263

您可以[ACL](https://developers.google.com/storage/docs/accesscontrol)将您的对象公开读取，然后直接从[GCS](https://developers.google.com/storage/docs/reference-uris)提供它。

例如，您可以查看我编写的一个快速应用程序，用于测试从 GCS 和 blobstore -> [audio-test.appspot.com](http://audio-test.appspot.com)提供音频和视频服务。[此](http://audio-test.appspot.com/render_ogg)链接使用 BlobstoreDownloadHandler 提供文件，而[此](http://commondatastorage.googleapis.com/sjl-test/song.ogg)链接直接从 Google Cloud Storage 提供相同的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:31:22.920

AFAIR，您无法为 中的常用 blob 创建服务 url `BlobStore`，因此这`BlobstoreDownloadHandler`将是您的情况的合适解决方案。可能是唯一可行的解​​决方案。

# gcc - shrl vs sarl .. x86 汇编 gnu

> ID：15694738
> 
> 赞同：4
> 
> 时间：2013-03-29T00:57:53.517
> 
> 标签：gcc, assembly, x86, gnu, bit-shift

我正在用 gcc 编译我的代码并查看程序集，这段代码到底在做什么？

```
shrl $20, %edx
leal (%edx,%eax), %eax
sarl 1, %eax 
```

假设变量 X 在 edx 寄存器中，Y 在 eax 中，两者都是（32 位整数）。这里发生了什么？？

我知道 'shrl $20, %edx' 将 %eax 向右移动 20 位，因此与：eax/(2^20) 相同，然后 sarl 相同，因此 'sarl 1, %eax' = eax/(2^1 ）。是这样吗？如果是这样，leal 有什么作用？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-29T01:30:25.153

假设这`sarl 1, %eax`确实应该是`sarl $1, %eax`，那么整个事情等同于：

```
x = ((unsigned int) x) >> 20;
y = (x + y) >> 1 
```

该`leal`指令的意思是：`eax = eax + edx`。这个[链接](http://en.wikibooks.org/wiki/X86_Assembly/GAS_Syntax#Address_operand_syntax)可能对你有用，还有[这个](http://en.wikibooks.org/wiki/X86_Assembly/Shift_and_Rotate)。

# java - 从另一个 JFrameForm 启动一个 JFrameForm

> ID：15694741
> 
> 赞同：0
> 
> 时间：2013-03-29T00:58:12.843
> 
> 标签：java, methods, applet, launch

我创建了一个 java JFrameForm，它用作登录表单。一旦它验证了一个人的登录，我希望它重定向到另一个 JFrameForm 并关闭自己。本质上，我已经阅读了一些信息，所有信息都说您使用现有的 JFrameForm 作为存根来启动新的小程序表单，但我不想要这个？

有人可以给我一些示例代码，以便从我现有的 JFrameForm 中启动我的 JFrameForm（名为 PostAccess.java）吗？如果可能的话，我还希望关闭原始的 JFrameForm 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-14T11:35:18.570

尝试这个

新的 PostAccess().setVisible(true); 处置（）；

# java - 带有 libGDX 的 Robotium 查找 imageButton 索引

> ID：15694744
> 
> 赞同：2
> 
> 时间：2013-03-29T00:58:19.247
> 
> 标签：java, android, libgdx, robotium

我一直试图让 Robotium 测试仪在 libGDX 中为 Android 项目工作，但遇到了一些问题。首先，我想测试我的游戏按钮（即 imageButtons），但为此我需要 Android 中的 imageButton 索引。

**我怎么能得到那个？**

我的按钮在主项目中：

```
 ImageButtonStyle style = new ImageButtonStyle();
  style.imageUp = buttonsImagesUp;
  style.imageDown = buttonsImagesDown;
  ImageButton newgameButton = new ImageButton(style);
  newgameButton.setPosition(425,330); 
```

这是我想在 JUnit 中测试的按钮。

我的 JUnit 代码：

```
public class ButtonTest extends ActivityInstrumentationTestCase2<MainActivity> {

   private Solo solo;

   @SuppressWarnings("deprecation")
   public ButtonTest() {
      super("com.me.myGame", MainActivity.class);
   }

   protected void setUp() throws Exception {
      super.setUp();
      solo = new Solo(getInstrumentation(), getActivity());
   }

   public void testMenu(){
      solo.assertCurrentActivity("First menu selected",  MainActivity.class);
      solo.clickOnImageButton(index); //need index
   }
} 
```

我的游戏是这样设置的：首先是处理资源并将第一个屏幕设置为主菜单的主游戏类：

```
 @Override
   public void create() {
      playSound = userPref.getBoolean("playSounds");
       setScreen(mainMenuScreen);              
   } 
```

在此之后，它转到 MainMenuScreen.js，这就是我想用 JUnit 测试的按钮

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T06:41:03.603

Robotium 的 an 概念与`ImageButton`Libgdx 非常非常不同。Robotium 需要一个图像按钮，该按钮被定义为标准 Android UI 基础架构的一部分（请参阅[Android`ImageButton`](http://developer.android.com/reference/android/widget/ImageButton.html)）。Libgdx`ImageButton`是一个带有 OpenGL 纹理引用的 Java 对象（请参阅[Libgdx`ImageButton`](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/ui/ImageButton.html)）。从 Android UI 基础架构的角度来看，Libgdx 应用程序只是一个全屏 OpenGL 视图，只有很少的元数据可供 Robotium 使用。

您也许可以使用原始的“clickOnScreen”基础架构，但您必须手动计算和跟踪屏幕上按钮的位置。此外，如果 Robotium 不包含 Libgdx 应用程序中不存在的对 Android UI 基础架构的其他依赖项，我会感到惊讶。

# mysql - MySQL - 两张表，比较两行

> ID：15694747
> 
> 赞同：2
> 
> 时间：2013-03-29T00:58:35.720
> 
> 标签：mysql, sql, database

我有两个内容相同的表，其中一个是第一个表的旧副本。所以直播表可能会有价格变化。我正在尝试构建一个查询来查找旧记录中的价格变化。

`Products`

`ID`

`Title`

`Price`

旧表

`Old_Products`

`ID`

`Title`

`Price`

到目前为止，我正在使用这个查询，但没有做我想做的事。

```
SELECT products.id
FROM products
LEFT JOIN products_old ON products.id = products_old.id
WHERE products.price IS NULL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:59:55.790

制作您的 where 子句以确定旧表和新表之间的价格不相等的位置。

```
SELECT products.id, products.title, products.price, products_old.price
FROM products
JOIN products_old ON products.id = products_old.id
WHERE products.price <> products_old.price 
```

如果这个简单的查询在您的数据库上表现不佳，我建议检查您在两个表上应用的索引。此外，正如 ypercube 所提到的，使用简单的内连接将比使用外连接更有效。

# c++ - 哪个库需要满足#include

> ID：15694753
> 
> 赞同：3
> 
> 时间：2013-03-29T00:59:19.070
> 
> 标签：c++, linux, raspbian

我正在尝试在运行 Raspbian Wheezy 的 Raspberry Pi 上编译 uvccapture。我需要安装什么包以便 gcc/make 可以满足这个包括？

```
#include <linux/videodev.h> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-29T01:00:53.873

> sudo apt-get install libv4l-dev

也许您还需要：

> cd /usr/include/linux
> sudo ln -s ../libv4l1-videodev.h videodev.h

# google-apps-script - 事件来宾列表，其中用户组按来宾获取状态

> ID：15694754
> 
> 赞同：2
> 
> 时间：2013-03-29T00:59:19.830
> 
> 标签：google-apps-script, google-calendar-api

我正在尝试提取日历活动的客人列表并找出每个客人的状态（是、否、可能），但遇到了用户组的问题。它只是给了我组名和 INVITED 状态，但我需要用户组中的每个客人及其邀请状态。这可能吗？

```
var calendarName="calendar name";
var calDate=new Date("04/02/2013");

function testCalendarEvents(){
var calendars = CalendarApp.getCalendarsByName(calendarName);  
var events = calendars[0].getEventsForDay(calDate); 

for(var c=0; c<events.length; c++){
Logger.log("Event "+c+": "+events[c].getTitle());

var guestList=events[c].getGuestList();    
for(var d=0; guestList!=null && d<guestList.length; d++){
  Logger.log("Guest "+d+": "+guestList[d].getEmail()+", Status: "+guestList[d].getGuestStatus());      
}        
}  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T20:34:22.877

目前这对于 DomainGroups 是不可能的，因为没有应用程序脚本 API 支持来深入了解组成员的状态。根据文档，假设您具有查看组成员的适当权限，您应该能够通过日历 UI 查看这些用户及其状态。

从[企业日历常见问题解答](http://www.google.com/support/enterprise/static/gapps/docs/users/en/learning_center/faqs_calendar.html)：

> **我可以邀请我们公司目录中的邮件列表参加会议吗？**
> 
> 是的，您可以邀请我们公司目录中的任何邮件列表（组）参加会议。小组的每个成员都会收到一封电子邮件邀请。但是请注意，电子邮件邀请不会显示该组的所有成员。此外，仅当您有权查看组的成员列表时，组成员才会出现在每个与会者日历的邀请中。

如果您是域管理员，您可以使用[GroupsManager](https://developers.google.com/apps-script/reference/domain/groups-manager)服务来检索组的成员列表。不幸的是，在日历事件的上下文中，这是您可以做的唯一有用的事情。您无法获取单个用户的邀请状态。我已修改您的脚本以检索成员列表：

```
function testCalendarEvents(){
  var calendarName="david_bingham@mitel.com";
  var calDate=new Date("04/01/2013");
  var calendars = CalendarApp.getCalendarsByName(calendarName);  
  var events = calendars[0].getEventsForDay(calDate); 

  try {
    var domainAdmin = false;          // assume we aren't an admin in a domain
    GroupsManager.getGroup("test");
    domainAdmin = true;               // we passed the test, so we ARE
  }
  catch (error) {
    // We didn't pass the test... why not?
    // Get "Service error: : Invalid request URI" if outside of an enterprise account
    // Get "You do not have permission to perform that action." if not admin.
    Logger.log("Not Domain Admin: "+error.message);
  }

  for(var c=0; c<events.length; c++){
    Logger.log("Event "+c+": "+events[c].getTitle());

    var guestList=events[c].getGuestList();    
    for(var d=0; guestList!=null && d<guestList.length; d++){
      if (!domainAdmin) {
        Logger.log("Guest "+d+": "+guestList[d].getEmail()+", Status: "+guestList[d].getGuestStatus());
      }
      else {
        // Check if this guest is a group
        var group = GroupsManager.getGroup(guestList[d].getEmail());
        if (group) {
          // getAllMembers() returns an array of email addresses
          var groupMembers = group.getAllMembers();
          for (var e in groupMembers) {
            Logger.log("Guest "+d+"/"+e+": "+groupMembers[e]+
                       ", Status: "+"UNKNOWN(group "+guestList[d].getEmail()+")");
          }
        }
        else {
          Logger.log("Guest "+d+": "+guestList[d].getEmail()+", Status: "+guestList[d].getGuestStatus());
        }
      }
    }        
  }  
} 
```

# clojure - 使用 Clojure 向量对 7 张扑克手建模

> ID：15694755
> 
> 赞同：3
> 
> 时间：2013-03-29T00:59:24.253
> 
> 标签：clojure

我有一个代表 7 张牌扑克手的向量，我想使用以下方法找到下一手牌：

*   值从 0 到 12 并已排序（例如`[0 0 7 11 11 12 12]`）
*   一个有效的向量最多有 4 个一个值
*   第一个有效向量是`[0 0 0 0 1 1 1]`
*   如果`index`和的值`index + 1`不同，则增加 at 的值`index` *并将*所有值从`0`到`index - 1`设置为零
*   重复最后一步，直到向量有效

例如，`(next-hand [0 0 0 0 1 1 1])`将`[0 0 0 1 1 1 1]`直接返回。然而，`(next-hand [0 0 0 1 1 1 1])`会循环通过，

```
[0 0 1 1 1 1 1] (invalid)
[0 1 1 1 1 1 1] (invalid)
[1 1 1 1 1 1 1] (invalid)
[0 0 0 0 0 0 2] (invalid)
[0 0 0 0 0 1 2] (invalid) 
```

并返回这个有效的手：

```
[0 0 0 0 1 1 2] 
```

这是我拥有的 sudo 代码，但需要将其转换为 clojure。请注意我如何在手牌末尾添加一个非常大的整数以使最后的比较始终为真。因此，在第一个循环的情况下，将以`[1 1 1 1 1 1 1 99]`结束。`i=6``1 < 99 == true`

```
let hand = [hand 99]
while hand is invalid
  for i in range(0,6)
    if hand[i] < hand[i+1]
      increment hand[i]
      break
  for j in range(0,i-1)
    hand[j] = 0 
```

**2013 年 3 月 29 日星期五编辑：** 为了使选择解决方案与扑克手模型一起使用，我添加了如下`is-valid`函数：

```
(defn is-valid [v]
  (let [distinct-ranks (partition-by identity v)
        count-distinct (map count distinct-ranks)
        max-count (apply max count-distinct)]
    (<= max-count 4))) 
```

并更新为`(filter #(is-valid %)`in `next-hand`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T05:09:50.470

一种可能的解决方案：

```
(defn next [v]
  (let [i (->> (map <  v (rest v))
               (map-indexed vector)
               (filter #(% 1))
               first)
        index (if i (i 0) 6)]
    (for [[i x] (map-indexed vector v)]
      (cond (= i index) (inc x)
            (< i index) 0
            :else x))))

(defn next-hand [v]
  (->> (iterate next (next v))
       (filter #(= 4 (apply + %)))
       first
       vec))

(next-hand [0 0 0 1 1 1 1]) 
```

# processing - 处理中触发函数对帧速率的影响

> ID：15694756
> 
> 赞同：0
> 
> 时间：2013-03-29T00:59:33.667
> 
> 标签：processing

我正在研究一个乒乓球模拟程序，在该程序中，我必须根据球拍的角度和传入的球轨迹来计算偏转角。我开发了一个计算偏转的方程组。不幸的是，它涉及一个至少有 30 个三角函数的系统，这些函数无法真正简化，并且必须在每个绘图函数期间运行一次。我的问题是：这会减慢我的程序多少？如果没有实现这些功能，该程序在我的新 iMac 上运行良好，但在任何旧计算机上，由于 OPENGL 和我的效率可能有些低，它已经有很大的延迟。运行这么多三角函数会显着影响我的帧率吗？如果是这样，从理论上讲，用泰勒多项式替换三角函数然后简化会更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T19:48:05.113

在进行了一些实验之后，我发现，正如我应该很明显的那样，运行这么多函数会严重影响帧率。我尝试使用泰勒多项式进行简化，但发现如果没有大量错误，我无法真正简化我的方程。我选择的解决方案是我的设置循环中的一个 3 维数组，它预先计算出适合我目的的一系列值。感谢所有回复的帮助，我希望我没有浪费你太多的时间。

# excel - 通过公式更改单元格内容时如何运行VBA代码

> ID：15694757
> 
> 赞同：0
> 
> 时间：2013-03-29T00:59:35.117
> 
> 标签：excel, vba

当我手动更新第 I 列时，下面的代码可以正常工作。我需要知道当我通过公式更新列时是否有办法让此代码仍然有效。

```
Private Sub Worksheet_Change(ByVal Target As Excel.Range)
    With Target
        If .Count > 1 Then Exit Sub

        If Not Intersect(Range("I3:I30"), .Cells) Is Nothing Then
            Application.EnableEvents = False
            If IsEmpty(.Value) Then
                .Offset(0, -1).ClearContents
            Else
                With .Offset(0, -1)
                    .NumberFormat = "m/d/yy h:mm"
                    .Value = Now
                End With
            End If

            Application.EnableEvents = True
        End If
    End With
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T02:00:31.533

`Worksheet_Change`不会响应公式更新而触发*。*

请参阅 Excel 帮助`Worksheet_Change`

```
Occurs when cells on the worksheet are changed by the user or by an external link. 
```

你也许可以通过活动实现你想要的`Worksheet_Calculate`。

假设您想在这些 val 值更改时在单元格旁边放置一个时间戳，请尝试此操作（除了您的`Change`事件）。

请注意使用`Static`变量来跟踪以前的值，因为`Calculate`event 不提供`Target`像这样的参数`Change`。这种方法可能不够健壮，因为`Static`如果您中断 vba 执行（例如，在未处理的错误上）， ' 将被重置。如果您希望它更健壮，请考虑将以前的值保存在另一个（隐藏的）工作表上。

```
Private Sub Worksheet_Calculate()
    Dim rng As Range, cl As Range
    Static OldData As Variant

    Application.EnableEvents = False
    Set rng = Me.Range("I3:I30")

    If IsEmpty(OldData) Then
        OldData = rng.Value
    End If

    For Each cl In rng.Cells
        If Len(cl) = 0 Then
            cl.Offset(0, -1).ClearContents
        Else
            If cl.Value <> OldData(cl.Row - rng.Row + 1, 1) Then
                With cl.Offset(0, -1)
                    .NumberFormat = "m/d/yy h:mm:ss"
                    .Value = Now
                End With
            End If
        End If
    Next
    OldData = rng.Value
    Application.EnableEvents = True
End Sub 
```

* * *

**更新**

样品表上的测试例程，所有工作都按预期进行

示例文件包含在 25 张纸上重复的相同代码，时间戳的范围为 10000 行。

为避免重复代码，请使用`Workbook_`事件。为了最大限度地减少运行时间，请为循环使用变体数组。

```
Private Sub Workbook_SheetCalculate(ByVal Sh As Object)
    Dim rng As Range
    Dim NewData As Variant

    Dim i As Long
    Static OldData As Variant

    Application.EnableEvents = False
    Set rng = Sh.Range("B2:C10000")  ' <-- notice range includes date column
    NewData = rng

    If IsEmpty(OldData) Then
        OldData = rng.Value
    End If

    For i = LBound(NewData, 1) To UBound(NewData, 1)
        If Len(NewData(i, 1)) = 0 And Len(NewData(i, 2)) > 0 Then
             rng.Cells(i, 2).ClearContents
        Else
            If NewData(i, 1) <> OldData(i, 1) Then
                With rng.Cells(i, 2)
                    .NumberFormat = "m/d/yy -- h:mm:ss"
                    .Value = Now
                End With
            End If
        End If
    Next
    OldData = rng.Value
    Application.EnableEvents = True
End Sub

Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
    'Activate date population on cell change
    With Target
        If .Count > 1 Then Exit Sub
        If Not Intersect(Sh.Range("B2:B10000"), .Cells) Is Nothing Then
            Application.EnableEvents = False
            If IsEmpty(.Value) Then
                .Offset(0, 1).ClearContents
            Else
                 'Populate date and time in column c
                With .Offset(0, 1)
                    .NumberFormat = "mm/dd/yyyy -- hh:mm:ss"
                    .Value = Now
                End With
            End If
            Application.EnableEvents = True
        End If
    End With

End Sub 
```

# javascript - 为什么这段 JavaScript 代码在 IE 中不起作用？

> ID：15694759
> 
> 赞同：-4
> 
> 时间：2013-03-29T00:59:48.790
> 
> 标签：javascript, html, css

为什么这在 IE10 中不起作用？它适用于 Chrome、Firefox、Opera 和 Safari。

HTML：

```
<form action="#">
    <label for="NoOfRooms">Select number of rooms required</label>
    <select id="NoOfRooms" onchange="showHide()">
        <option value="1" selected="selected">1 room</option>
        <option value="2">2 rooms</option>
        <option value="3">3 rooms</option>
    </select>
    <br />
    <label id="Room1TypeLabel" for="Room1Type" class="inline">Room 1:</label>
    <select id="Room1Type">
        <option value="1" selected="selected">Single</option>
        <option value="2">Double</option>
        <option value="3">Triple</option>
    </select>
    <br />
    <label id="Room2TypeLabel" for="Room2Type" class="hidden">Room 2:</label>
    <select id="Room2Type" class="hidden">
        <option value="1">Single</option>
        <option value="2" selected="selected">Double</option>
        <option value="3">Triple</option>
    </select>
    <br />
    <label id="Room3TypeLabel" for="Room1Type" class="hidden">Room 3:</label>
    <select id="Room3Type" class="hidden">
        <option value="1">Single</option>
        <option value="2">Double</option>
        <option value="3" selected="selected">Triple</option>
    </select>
</form> 
```

JavaScript：

```
function showHide() {
    "use strict";
    var NoOfRooms = document.getElementById("NoOfRooms");
    var NoOfRoomsValue = NoOfRooms.options[NoOfRooms.selectedIndex].value;
    if (NoOfRoomsValue == 2) {
        Room2Type.style.display = "inline";
        Room3Type.style.display = "none";
        Room2TypeLabel.style.display = "inline";
        Room3TypeLabel.style.display = "none";
    } else if (NoOfRoomsValue == 3) {
        Room2Type.style.display = "inline";
        Room3Type.style.display = "inline";
        Room2TypeLabel.style.display = "inline";
        Room3TypeLabel.style.display = "inline";
    } else if (NoOfRoomsValue == 1) {
        Room2Type.style.display = "none";
        Room3Type.style.display = "none";
        Room2TypeLabel.style.display = "none";
        Room3TypeLabel.style.display = "none";
    } else alert("Error. Please try again.");
} 
```

CSS：

```
.hidden {
            display: none;
        } 
```

[小提琴](http://jsfiddle.net/uQVMF/1/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:17:53.353

我不知道你是否包含了完整的脚本，但它在 Firefox 上不起作用，无论如何对我来说。

我建议将字段包装在 div 中，这样您就不需要切换每个标签/输入。您可以通过直接分配事件将 onchange= 属性保留在 html 之外，使用库有助于跨浏览器兼容。

我把它扔进了一些 jquery 中（如果你只做这一点 js，这可能有点过头了，但我怀疑你是），它运行良好：

它需要一些清理，但我把它放在一起：

```
$(function(){

    $('#NoOfRooms').change(function(){
        if( $(this).val() == 1){
            $('#room1').show();
            $('#room2, #room3').hide();
        }
        else if( $(this).val() == 2){
            $('#room1,#room2').show();
            $('#room3').hide();
        }
        else if( $(this).val() == 3){
            $('div').show();
        }
    }).trigger('change');
}); 
```

[http://jsfiddle.net/uQVMF/4/](http://jsfiddle.net/uQVMF/4/)

使用循环或更动态的方式显示正确的字段是最好的，特别是如果您使用三个以上的房间字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T01:29:38.190

好吧，这里有几个问题：

首先，小提琴不起作用，因为 JSFiddle 会自动将您的代码包装在 jquery onLoad 函数中。将 JSFiddle 左侧边栏上的“onLoad”切换为“No Wrap”可解决此问题，并使代码在 Chrome 和 Firefox 中运行。

第二个 IE 要求 onchange 是 onChange。

最后，您需要定义 Room2Type、Room3Type、Room2TypeLabel 等变量，方法与选择时相同：

```
document.getElementById("Room2Type").style 
```

但是以上所有内容实际上只是为了让您了解为什么您的代码无法正常工作。你真的应该使用@BotskoNet 未来所写的内容。

# c# - 如何以编程方式确定时间间隔状态

> ID：15694766
> 
> 赞同：-2
> 
> 时间：2013-03-29T01:00:41.507
> 
> 标签：c#, c++, .net

我有一个问题，我需要在一定时间间隔内做某事。例如超过 5 分钟，我想在状态 1 和状态 2 之间重复（每个都有自己指定的时间量）然后重复直到整整 5 分钟过去。

例如超过 5 分钟，我希望状态 1 为 40 秒，状态 2 为 20 秒。

我很欣赏用于确定当前状态的伪代码、C#、VB、C++ 或 C 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:22:39.490

伪代码：

```
state1Time = 40;
state2Time = 20;
duration = 300;

while (duration > 0 && duration > state1Time)
{
    if (duration >= state1Time)
    {
        changeState(1);
        sleep(state1Time);
    }
    duration -= state1Time;
    if (duration >= state2Time)
    {
        changeState(2);
        sleep(state2Time);
    }
    duration -= state2Time;
}

changeState(none); 
```

# ruby-on-rails - 如何在rails的表中设置默认数据？

> ID：15694774
> 
> 赞同：3
> 
> 时间：2013-03-29T01:01:17.417
> 
> 标签：ruby-on-rails, seed

我有一张表，我将在其中存储测量单位和相应的类别。例如，“杯子，体积”和“盎司，质量”。我只有大约 12 个我关心的测量值，并且我希望它们在数据库中而不需要手动输入它们，因为无论何时我想部署它或将代码移动到某个地方，我都希望重新创建它。

所以，我认为最好的方法是用它们创建一个 csv 文件，然后使用 rake db:seed。但是我以前从来没有这样做过，所以有人可以指导我如何创建这个 csv，以及如何编写 seed.rb 文件来生成它吗？这是正确的方法吗？

* * *

**解决方案：**

```
#db/seeds.rb
require 'open-uri'

#Supply all the units of measurement to be used
Unit.delete_all
open("db/seeds/measurements.csv") do |measurements|
  measurements.read.each_line do |measurement|
    unit, uof = measurement.chomp.split(",")
    Unit.create!(:name => unit, :unit_of => uof)
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:02:50.937

只需编写用于手动生成它们的代码并将其放入种子.rb 中。您可以在该文件中使用普通的 ruby​​；所以要么只写普通`create`的，要么加载你存储的 csv，例如`db/seeds/measurements.csv`. 要获取该文件的路径，请使用`Rails.root.join("db/seeds/measurements.csv")`.

例子：

```
File.open(Rails.root.join("db/seeds/measurements.csv")) do |f|
  # use f here
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T06:35:51.453

`seeds.rb`目录中有一个文件`db`。

您可以在其中添加默认数据，当您执行时`rake db:seed`，该数据将填充到您的数据库中。

这是一个如何向其中添加种子的示例。

```
product_types = ProductType.create([
                                   {:name => 'clock',:organisation_id => 1}
]) 
```

# java - Java 找不到 .property 文件 Ubuntu

> ID：15694776
> 
> 赞同：1
> 
> 时间：2013-03-29T01:01:55.463
> 
> 标签：java, ubuntu, properties, io, filenotfoundexception

我有一个加载 .properties 文件的游戏。文件的名称是`properties.properties`. 当我在 Windows 中运行游戏时，它可以工作，但是当我在 Linux（Ubuntu）中加载它时，它会抛出 fileNotFoundException。正在运行的 .jar 和属性文件在同一个文件夹中，我正在使用以下方法调用属性文件：

```
currentProp = new Properties();
    try {
        currentProp
                .load(new FileInputStream(
                        "../bin/properties.properties"));
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

甚至尝试过：

```
currentProp = new Properties();
    try {
        currentProp
                .load(new FileInputStream(
                        "properties.properties"));
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

随着

```
currentProp = new Properties();
    try {
        currentProp
                .load(new FileInputStream(
                        "../properties.properties"));
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

我不完全确定它为什么不起作用，但是当我 `java -jar ~/Desktop/Files/bin/NPS.jar`在 Linux 终端中运行它时，我得到了错误：

```
java.io.FileNotFoundException: ../bin/properties.properties (No such file or directory)
at java.io.FileInputStream.open(Native Method)
at java.io.FileInputStream.<init>(FileInputStream.java:138)
at java.io.FileInputStream.<init>(FileInputStream.java:97)
at main.Start.loadProperties(Start.java:56)
at main.Start.main(Start.java:34)
    Exception in thread "main" java.lang.NullPointerException
at main.Start.main(Start.java:36) 
```

我不知道为什么！这有点令人沮丧....因为它在 Windows 中工作得很好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T01:06:25.527

而不是`java -jar ~/Desktop/Files/bin/NPS.jar`尝试`cd ~/Desktop/Files/bin/ && java -jar NPS.jar`

# ruby - 使用 Sketchup Ruby API 在圆柱体上打孔

> ID：15694777
> 
> 赞同：2
> 
> 时间：2013-03-29T01:01:56.223
> 
> 标签：ruby, sketchup

我正在编写一个脚本来在 SketchUp（免费版，Mac）中制作一个简单的长笛。我想制作一个管子，然后是穿过管子的圆柱体，画出管子和圆柱体之间的相交线，然后擦除圆柱体，留下圆圈从管子上切下来。

如果我用鼠标来做这件事，这很有效，但我发现用鼠标很难精确地放置和测量。不过，到目前为止，我还不能让它与脚本一起工作。目前我被困在管子上画不完整的圆圈，所以我找不到脸并擦掉它。您应该能够在 ruby​​ 控制台中运行以下脚本并明白我的意思。我究竟做错了什么？

```
entities = Sketchup.active_model.entities

# make tube
tube = entities.add_group
tube_inner = tube.entities.add_circle Geom::Point3d.new(0,0,0), Geom::Vector3d.new(0,0,1), 5, 360
tube_outer = tube.entities.add_circle Geom::Point3d.new(0,0,0), Geom::Vector3d.new(0,0,1), 6, 360
cross_section_face = tube.entities.add_face tube_outer
inner_face = tube.entities.add_face tube_inner
tube.entities.erase_entities inner_face
cross_section_face.pushpull -10, false

# make a cylinder that punches through the wall
hole_punch = entities.add_group
hole_outer = hole_punch.entities.add_circle Geom::Point3d.new(0,0, 5), Geom::Vector3d.new(0,1,0), 3, 360
face = hole_punch.entities.add_face hole_outer
face.pushpull 10, false

# draw the intersection lines and erase the hole punch
entities.intersect_with true, hole_punch.transformation, tube, tube.transformation, true, hole_punch
hole_punch.erase! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T22:57:05.723

确定相交后要擦除的正确面可能非常棘手。

但由于您使用的是圆柱体形状（即实体），我建议您使用 SketchUp 8 Pro 中引入的实体布尔运算。例如，您可以使用`Group.subtract`。[http://www.sketchup.com/intl/en/developer/docs/ourdoc/group#subtract](http://www.sketchup.com/intl/en/developer/docs/ourdoc/group#subtract)

但是，如果您没有使用 SketchUp 8 Pro 或更新版本，那么您将无法使用这些方法。

* * *

替代解决方案 - 避免 Pro 版本的 Solid Tools 方法：

```
entities = Sketchup.active_model.entities

# (!) You created a circle with so many edges that at the scale
#     you drew it they where pushing the boundary of how small
#     units SketchUp can handle. (1/1000th inch).
#     If you has Edge Outline style enabled you could see that
#     not all edges where fully merged.
#     I reduced the curve segments from 360 to 180.
#     (Do you really need such a high mesh density anyway?)

# make tube
tube = entities.add_group
tube_inner = tube.entities.add_circle Geom::Point3d.new(0,0,0), Geom::Vector3d.new(0,0,1), 5, 180
tube_outer = tube.entities.add_circle Geom::Point3d.new(0,0,0), Geom::Vector3d.new(0,0,1), 6, 180
cross_section_face = tube.entities.add_face tube_outer
inner_face = tube.entities.add_face tube_inner
tube.entities.erase_entities inner_face
cross_section_face.pushpull -10, false

# make a cylinder that punches through the wall
hole_punch = entities.add_group
hole_outer = hole_punch.entities.add_circle Geom::Point3d.new(0,0, 5), Geom::Vector3d.new(0,1,0), 3, 180
face = hole_punch.entities.add_face hole_outer
face.pushpull 10, false

# draw the intersection lines and erase the hole punch
entities.intersect_with true, hole_punch.transformation, tube, tube.transformation, true, hole_punch
hole_punch.erase!

# Find all the edges that belong to the Circle elements drawn
# earlier (including the ones push-pulled).
# (Could also collect these earlier before intersecting by
#  collecting all non-smooth edges.)
circles = tube.entities.grep(Sketchup::Edge).select { |e| e.curve }.uniq
# Then we pick out all the faces that isn't connected to these edges and erase them.
new_faces = tube.entities.grep(Sketchup::Face).select { |f| (f.edges & circles).empty? }
entities.erase_entities( new_faces ) 
```

如果您真的想要 360 度圈，您可以放大组的内容 - 同时缩小组实例。这样，组定义的规模就更大了。（参见这篇关于 SketchUp 中的实例和定义的文章：[http](http://www.thomthom.net/thoughts/2012/02/definitions-and-instances-in-sketchup/) ://www.thomthom.net/thoughts/2012/02/definitions-and-instances-in-sketchup/ ）

此外，如果您希望面填充内外蒙皮之间的孔，您还需要与该部分相交。

* * *

请注意`Entities.intersect_with`描述 - 当前文档并不能很好地解释所有论点。有两种`entities`说法。

第一个应该是`Sketchup::Entities`相交对象应该出现的对象。（我有点惊讶它通过给它喂一个`Sketchup::Group`物体来起作用。）

第二个**不**应该`Sketchup::Entities`- 那将失败。它必须是对象`Sketchup:Entity`或对象数组`Sketchup:Entity`。

# c# - MySqlCommand Prepare() 从不将 IsPrepared 设置为 true

> ID：15694783
> 
> 赞同：2
> 
> 时间：2013-03-29T01:03:03.007
> 
> 标签：c#, mysql

这就是问题所在：无论我似乎在做什么，我都无法让 MySqlCommand 真正准备好。我已经尝试从[http://dev.mysql.com/doc/refman/5.6/en/connector-net-programming-prepared.html](http://dev.mysql.com/doc/refman/5.6/en/connector-net-programming-prepared.html)复制/粘贴示例代码并进行了非常小的修改，但这实际上也不起作用.

我搜索谷歌试图找到一个解决方案，但最接近的是：[MySql 语句准备“不粘”](https://stackoverflow.com/questions/7866905/mysql-statement-prepare-not-sticking)，它实际上并没有回答这个问题。

这是我用于此测试的表格设置：

```
CREATE  TABLE `test`.`test_prepared_query` (
  `id` INT NOT NULL ,
  `value` INT NOT NULL ,
  PRIMARY KEY (`id`) ); 
```

C#中的测试代码

```
public void TestPrepareQuery()
{
    connString = new MySqlConnectionStringBuilder();
    connString.Server = "localhost";
    connString.Database = "test";
    connString.UserID = "someuserid";
    connString.Password = "somepassword";

    bool isprepared;

    using (MySqlConnection conn = new MySqlConnection(connString.ToString()))
    {
        MySqlCommand cmd = new MySqlCommand(
            "INSERT INTO test_prepared_query VALUES (@id, @value)", conn);
        cmd.Connection.Open();

        cmd.Prepare();
        isprepared = cmd.IsPrepared; // isprepared is false here

        cmd.Parameters.AddWithValue("@id", 0);
        cmd.Parameters.AddWithValue("@value", 0);

        cmd.Prepare();
        isprepared = cmd.IsPrepared; // isprepared is still false

        // this is 1 -- the query succeeds
        int rowsAffected = cmd.ExecuteNonQuery();

        for (int i = 1; i < 10; i++)
        {
            cmd.Parameters["@id"].Value = i;
            cmd.Parameters["@value"].Value = i;

            // this is 1 -- the query succeeds
            rowsAffected = cmd.ExecuteNonQuery();
        }
    }
} 
```

当我运行代码时，它确实成功地将行放入表中，但单步执行程序会检查 cmd.IsPrepared 的状态始终为 false。有谁知道为什么会发生这种情况？此源代码与示例代码基本相同，只是对表名和实际连接字符串进行了修改。

编辑：我尝试过使用 ?name 格式的变量，但这也不起作用。我还尝试在测试中一次只调用一个 cmd.Prepare() 方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-31T23:38:45.573

我最终提取了 MySql Connector / .NET 的源代码，发现如果 MySqlCommand.Connection.Settings.IgnorePrepare = true （这是默认值！），那么调用 Prepare 是没有操作的。

解决此问题的方法是在连接字符串中将 IgnorePrepare 显式设置为 false。这可以使用以下代码片段通过 MySqlConnectionStringBuilder 轻松完成：

```
MySqlConnectionStringBuilder connBuilder = new MySqlConnectionStringBuilder();
// .. set up the rest of your connection
connBuilder.IgnorePrepare = false;

MySqlConnection conn = new MySqlConnection(connBuilder.ToString()); 
```

# haskell - 升级 cabal-install 的麻烦

> ID：15694786
> 
> 赞同：0
> 
> 时间：2013-03-29T01:03:19.497
> 
> 标签：haskell, ghc, cabal

我无法将 cabal 升级到 1.17.0 版。我当前的 cabal 版本是：

```
edechter@helmholtz cabal-install (master) $ cabal --version
cabal-install version 1.16.0.2
using version 1.16.0.3 of the Cabal library 
```

这是我的尝试：

```
edechter@helmholtz cabal-install (master) $ cabal install cabal-install-1.17.0
Resolving dependencies...
cabal: Could not resolve dependencies:
rejecting: cabal-install-1.16.0.2, 1.16.0.1, 1.16.0, 0.14.0, 0.10.2, 0.10.0,
0.8.2, 0.8.0, 0.6.4, 0.6.2, 0.6.0, 0.5.2, 0.5.1, 0.5.0, 0.4.0 (global
constraint requires ==1.17.0) 
```

我按照这里的说明进行操作：[http](http://www.haskell.org/cabal/FAQ.html#dependencies-conflict) ://www.haskell.org/cabal/FAQ.html#dependencies-conflict 但我没有看到任何冲突。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T02:16:57.170

1.16.0.2[是目前在 Hackage 上可用的最新版本](http://hackage.haskell.org/package/cabal-install)。如果您想尝试预发布版本，我建议使用[`cabal-dev`](http://hackage.haskell.org/package/cabal-dev)：

```
$ git clone git://github.com/haskell/cabal.git
$ cd cabal/cabal-install
$ cabal-dev add-source ../Cabal
$ cabal-dev install 
```

可执行文件将`cabal`安装在`cabal-dev/bin`.

# php - Rgraph什么都不显示

> ID：15694787
> 
> 赞同：0
> 
> 时间：2013-03-29T01:03:19.963
> 
> 标签：php, rgraph

认为我终于以正确的形式获得了我想要的数据。我只是没有得到图表。因为我需要时间（每小时），所以我正在使用散点图。我从 mysql 中提取，但我以正确的格式将它交给 rgraph。我没有收到任何错误，也没有图表。

```
<script>
    chart = new RGraph.Scatter('cvs', [[2013-03-28 00:05, 0.00, 'red'], [2013-03-28    01:05, -2.00, 'red'], [2013-03-28 02:05, -2.58, 'red'], [2013-03-28 03:05, -3.90, 'red'], [2013-03-28 04:05, -5.53, 'red'], [2013-03-28 05:05, -7.58, 'red'], [2013-03-28 06:05, -6.26, 'red'], [2013-03-28 07:05, -3.63, 'red'], [2013-03-28 08:05, -4.78, 'red'], [2013-03-28 09:05, -4.29, 'red'], [2013-03-28 10:05, -3.69, 'red'], [2013-03-28 11:05, -3.27, 'red'], [2013-03-28 12:05, -4.23, 'red'], [2013-03-28 13:05, -5.02, 'red'], [2013-03-28 14:05, -4.50, 'red'], [2013-03-28 15:05, -5.43, 'red'], [2013-03-28 16:05, -5.12, 'red'], [2013-03-28 17:05, -5.42, 'red'], [2013-03-28 18:05, -5.16, 'red'], [2013-03-28 19:05, -5.11, 'red']]);
    chart.Set('chart.background.barcolor1', 'white');
    chart.Set('chart.grid.color', 'rgba(238,238,238,1)');
    chart.Set('chart.gutter.left', 30);
    chart.Set('chart.labels', ['12', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11']);        
    chart.Set('chart.xmax', 12);
chart.Set('chart.line', true);
chart.Draw();
</script> 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T13:36:27.053

我同意理查德的观点。您需要引用您在 Javascript 中输入的数据。但不要试图自己逃避它，你会头疼的。

由于您使用的是 PHP，因此只需显示您想要的数据

```
echo json_encode($var);
```

如果它是一个数组、一个字符串等，它将很好地处理它。

如果它是一个数字数组，我建议你使用

```
echo json_encode($var,JSON_NUMERIC_CHECK);
```

当您将 RGraph 与 PHP 一起使用时，这非常方便。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T22:10:09.360

您的格式不正确 - 您的日期周围应该有引号，并且日期本身的格式不正确。从记忆中应该是这样的：

['2013/03/28 00:05:00', 0.00, '红色']

即日期周围的引号（它是一个字符串）和日期本身的格式是 Date.parse() 可以理解的

# c# - SQL Server - 如何替换“奇怪”的字符？如何将 UTF-8 HTML 响应编码为 ASCII？

> ID：15694789
> 
> 赞同：0
> 
> 时间：2013-03-29T01:03:29.323
> 
> 标签：c#, sql, character

我正在使用一些 C# 将一些文本插入到 SQL Server 数据库中。我正在使用 System.Web.HttpUtility.HtmlEncode() 尝试替换与我的数据库的字符集不兼容的字符（设置为默认排序规则 = SQL_Latin1_General_CP1_CI_AS），但它并没有帮助我处理一些“奇怪”的字符.

例如，这个破折号：― 不同于标准破折号。(-)

HtmlEncode() 不会用实体替换第一个破折号（我认为它是“—”），它最终会变成一个“？” 在我的数据库中。

在插入 SQL Server 之前清理/清理文本字段的最佳方法是什么？

我宁愿不更改我的数据库配置/排序规则。

# php - 更新 PHP 变量时自动刷新 div

> ID：15694792
> 
> 赞同：0
> 
> 时间：2013-03-29T01:03:58.800
> 
> 标签：php, ajax, jquery, variables, html

我有一个调用变量的 div。当该变量发生变化时，用户需要刷新页面才能看到新值。该变量是从一个单独的 PHP 文件中提取的。

我想知道是否有一种方法可以使用 ajax 自动更新 div，而无需用户在看到 PHP 变量已更新时刷新浏览器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T01:12:05.600

您可以使用 ajax 定期检查变量是否有任何更改，如果是这种情况，您可以更新 div。

```
var previousValue = null;

function checkForChange() {
    $.ajax({
        url: 'http://example.com/getVariableValue.php',
        ...
        success: function(data) {
            if (data != previousValue) { // Something have changed!
                //Call function to update div
                previousValue = data;
            }
        }
    });
}

setInterval("checkForChange();", 1000); 
```

我还没有测试过代码，但它应该是这样的。将从[http://example.com/getVariableValue.php](http://example.com/getVariableValue.php)获取数据，您必须填写有关 AJAX 请求的一些信息。我假设您知道如何为您的特定数据格式修改代码，无论是 XML、JSON 还是文本。

# php - 从 ID 显示数据库中的数据

> ID：15694796
> 
> 赞同：-1
> 
> 时间：2013-03-29T01:04:13.550
> 
> 标签：php

我设置了一个数据库，例如我使用“user_id”来显示姓名、年龄、地址等。我想在 php 中仅显示 id 的所有信息。然后这会在另一页中回显。目前我必须这样做：

```
$row=mysql_fetch_array($result);
        $_SESSION['Name'] = $row['Name'];
        $_SESSION['Address'] = $row['Address']; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:13:32.317

仅存储用户登录时设置的用户 ID 和令牌：

```
if (isset($_SESSION['user_id']) && $_SESSION['logged_in']) {
    $user_id = $_SESSION['user_id'];

    $user = // Query your database to get the user with that ID.
} else {
    // Not logged in.
} 
```

或者，您可以使用安全会话并将用户的配置文件对象序列化为字符串，但您需要保持更新，以防用户更改其信息。