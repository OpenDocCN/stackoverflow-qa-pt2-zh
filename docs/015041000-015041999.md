# StackOverflow 问答 15041000-15041999

# java - 在 JNI 层填充一个字符串数组

> ID：15041002
> 
> 赞同：4
> 
> 时间：2013-02-23T13:22:59.663
> 
> 标签：java, java-native-interface

我是 Java 编程新手，有一个基本问题。我想将一个字符串数组传递给 JNI 层。在JNI函数内部可以用字符串填充数组吗？所有帖子要么讨论如何从 JNI 层返回字符串数组，要么讨论如何在 JNI 层解析字符串数组。可能吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T13:32:05.547

对的，这是可能的。这里有一个[示例](http://www.coderanch.com/t/326467/java/java/Returning-String-array-program-Java)可以完全满足您的要求。`new String(char[])`您将需要在 java 中从 JNI 端（类似于 invoking ）创建数组和字符串。Unicode 和 UTF-8 都受支持（每个都有一个 JNI 函数集）。

```
#include <jni.h>
#include "ArrayHandler.h"

JNIEXPORT jobjectArray JNICALL Java_ArrayHandler_returnArray
  (JNIEnv *env, jobject jobj)
{
    jobjectArray ret;
    int i;

    char *message[5]= {"first",
                       "second",
                       "third",
                       "fourth",
                       "fifth"};

    ret= (jobjectArray)env->NewObjectArray(5,
                                           env->FindClass("java/lang/String"),
                                           env->NewStringUTF(""));

    for(i=0;i<5;i++) {
        env->SetObjectArrayElement(
                    ret,i,env->NewStringUTF(message[i]));
    }

    return(ret);
} 
```

# c# - 什么是 .NET 字符串结构以及 .NET 如何存储和检索它的字符串结构？

> ID：15041008
> 
> 赞同：0
> 
> 时间：2013-02-23T13:23:24.663
> 
> 标签：c#, .net, vb.net

让我们面对以下代码：

```
string a = "This is not a long string!";
string b = "Another string";
b = "This is" + " not a long " + "string" + "!";
Console.WriteLine(object.ReferenceEquals(a, b)); //True !
string c = "This is" + " not a long " + "string" + '!';
Console.WriteLine(object.ReferenceEquals(a, c)); //False 
```

我看到的唯一原因是 .NET 优化了变量以占用更少的空间。

.NET 是否存储具有零终止 [null] 或字符串长度的字符串？
我的意思是当我编写以下代码时，如果 .NET 针对字符串运行优化，是否有可能丢失空字符之后的部分？

```
string Waaaa = "This is not \0a long string!"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T13:25:59.977

.NET 中的字符串本质上是字符数组 - `char[]`（其中`char`是 UTF-16 字符的表示形式）。它们不是 C 字符串 - 它们不是以 null 结尾的。

您看到的是[字符串实习](http://en.wikipedia.org/wiki/String_interning)的结果- 任何字符串文字都将被实习（并且编译器足够聪明，知道将连接的字符串转换为单个文字）。

您的`Waaaa`变量将与您发布的完全相同 - 中间有一个空字符。

# java - java，如何将Unicode字符更改为普通字符？

> ID：15041012
> 
> 赞同：0
> 
> 时间：2013-02-23T13:24:42.120
> 
> 标签：java, android, unicode

我有一个基于 WordPress 的博客。我已经安装了[JSON API](http://wordpress.org/extend/plugins/json-api/)插件，以便获得 JSON 格式的响应。我正在为 Android 开发应用程序，我想在我的 Android 应用程序中显示我的博客内容。我正在使用以下库来解析 JSON

```
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject; 
```

我正在向服务器发送请求以获取我的博客页面的内容。但是，我不知道为什么我的服务器以 Unicode 格式发送页面内容。我的日志显示此输出：

> 02-23 21:16:21.148: D/ContentDownloader(3536): 尝试打开: [http://www.kamalan.com/?feed=json&paged=1](http://www.kamalan.com/?feed=json&paged=1)
> 
> \u0633\u0631\u0648\u0631 \u0639\u0645\u0644\u06cc\u0627\u062a \u0644\u0627\u0632\u0645 \u0631\u0627 \u0627\u0646\u062c\u0627\u0627\u0627\u0627\u0627\u0645\u u062f\u0631\u062f\u06cc\u062a\u0627\u0628\u06cc\u0633\u06a9\u0648\u0626\u0631\u06cc\u0628\u0632\u0646\u062f\u060c\u0631\8\u0619\u0660 u0631\u0627 \u0627\u0636\u0627\u0641\u0647\u060c \u0622\u067e\u062f\u06cc\u062a \u06cc\u0627 \u067e\u0627\u06a9 \u06a9\u0664\u0664\u066466460u0u666666664 \u062c\u0647\u0631\u0627\u0628\u0631\u06af\u0631\u062f\u0627\u0646\u062f。\u0628\u062f\u06cc\u0646 \u062a\u0631\u062a\u06cc\u0628 \u0627\u0628\u0633\u062a\u0631\u06a9\u0634\u0646 \u0647\u0645\u0628\u0628\ucc \u0628\u0628\ucc \u068\u0628\u066 \u0646\u062c\u0627\u0645 \u0645\u06cc\u0634\u0648\u062f.</p>

当我在浏览器中打开上面的 URL 时，我也会看到这种格式的结果。如何将 Unicode 格式更改为普通格式？我的 WordPress 设置有问题吗？（我不熟悉 PHP，但我找到了[String Repertoire](http://dev.mysql.com/doc/refman/5.0/en/charset-repertoire.html)。它与我的问题有关吗？）

# magento - Magento：企业全页缓存 - 禁用 Cookies / $_COOKIE

> ID：15041014
> 
> 赞同：1
> 
> 时间：2013-02-23T13:24:51.423
> 
> 标签：magento, caching, cookies

我们有一个定制的过程，它依赖于 cookie 来呈现一些关键的显示选项。这是所有网站访客都需要的唯一真正解决方案。

进程在禁用 FPC 的情况下工作得很好，但启用它后，PHP 全局 $_COOKIE 会为整个浏览器会话缓存。

本质上——我们需要对 FPC 应用补丁以使其忽略 cookie（全部或按名称——现在都可以）。

欣赏是否有人在实现类似目标或合适的起点方面取得了任何成功。

注意：在 AWS nginx 构建上运行 EE1.12。

干杯，t8

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T10:05:57.427

In FPC with no Dynamic Block Magento application initialization is not done. So as you want some part of your page to vary depending on Cookies you need to use Dynamic Block.

For this you will have to create a container class and set lifetime as Null as in snippet below

1.Try adding this to your container class: protected function _saveCache($data, $id, $tags = array(), $lifetime = null) { return false; } That should prevent it from getting cached.

Also this link on Stackoverflow : [How do I include a dynamic block in the product page with full page caching turned on?](https://stackoverflow.com/questions/9120413/how-do-i-include-a-dynamic-block-in-the-product-page-with-full-page-caching-turn)

details out on Dynamic Blocks and FPC.

# winapi - 重叠的 IO 或文件映射？

> ID：15041016
> 
> 赞同：3
> 
> 时间：2013-02-23T13:24:58.640
> 
> 标签：winapi, file-io, overlapped-io, file-mapping

在 Windows 应用程序中，我有一个包含文件名和缓冲区的类。您使用文件名构造它，您可以查询对象以查看缓冲区是否已填充，如果没有则返回 nullptr，如果是则返回缓冲区地址。当对象超出范围时，释放缓冲区：

```
class file_buffer
{
public:
    file_buffer(const std::string& file_name);
    ~file_buffer();
    void* buffer();

private:
    ...
} 
```

我想将数据异步放入内存，据我所知，我有两个选择：要么创建缓冲区并通过 ReadFileEx 使用重叠 IO，要么使用 MapViewOfFile 并在另一个线程上触摸地址。

目前我正在使用 ReadFileEx 这会出现一些问题，因为大于约 16MB 的请求很容易失败：我可以尝试拆分请求，但随后会出现同步问题，并且如果对象在 IO 之前超出范围完成我有缓冲区清理问题。此外，如果类的多个实例被快速连续创建，事情会变得非常复杂。

在另一个线程上映射和触摸数据似乎要容易得多，因为我不会遇到上限问题：如果客户端现在绝对必须拥有数据，他们可以简单地取消引用地址，让操作系统担心页面错误并接受阻塞命中。

这个应用程序需要支持单核机器，所以我的问题是：另一个软件线程上的页面错误会比当前线程上的重叠 IO 更昂贵吗？他们会拖延这个过程吗？重叠的 IO 是否会以相同的方式停止进程，还是有一些我不明白的操作系统魔法？是否仍然使用重叠 IO 执行页面错误？

我已经很好地阅读了这些主题： http: [//msdn.microsoft.com/en-us/library/aa365199](http://msdn.microsoft.com/en-us/library/aa365199(v=vs.85).aspx) (v=vs.85).aspx（文件管理中的 IO 概念） [http://msdn。 microsoft.com/en-us/library/windows/desktop/aa366556(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366556(v=vs.85).aspx)（文件映射），但我似乎无法推断如何进行性能权衡。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-04T12:03:44.667

您肯定会想要使用内存映射文件。Overlapped IO (with `FILE_FLAG_NO_BUFFERING`) 多年来一直被一些人提倡为“将数据放入 RAM 的最快方式”，但这仅在非常人为的情况下和非常具体的条件下才是正确的。在正常情况下，关闭缓冲区缓存是一种严重的反优化。

现在，*没有* `FILE_FLAG_NO_BUFFERING`重叠 IO 的重叠 IO具有重叠 IO 的所有怪癖，并且速度慢了大约 50%（出于我仍然无法理解的原因）。

[一年前](https://stackoverflow.com/q/5909345/572743)我做了一些相当广泛的基准测试。底线是：内存映射文件更快、更好、更少令人惊讶。

重叠 IO 使用更多 CPU，使用缓冲区缓存时速度要慢得多，在一些有据可查和一些无证条件下（例如加密、压缩和......纯机会？请求大小？请求数？），异步恢复为同步，在不可预测的时间停止您的应用程序。
提交请求有时会花费“有趣”的时间，`CancelIO`有时不会取消任何内容，而是等待完成。具有未完成请求的进程是无法杀死的。管理具有突出重叠写入的缓冲区是非常重要的额外工作。

文件映射只是工作。句号。而且效果很好。没有惊喜，没有有趣的东西。接触每一页的开销非常小，并且交付速度与磁盘能够交付的速度一样快，并且它利用了缓冲区缓存。您对单核 CPU 的关注没有问题。如果触摸线程发生故障，它会阻塞，并且与往常一样，当一个线程阻塞时，另一个线程会获得 CPU 时间。

我什至现在使用文件映射进行*写入*，只要我有多个字节要写入。这有点不重要（必须手动增长/预分配文件和映射，并在关闭时截断为实际长度），但对于一些辅助类，它是完全可行的。写入 500 MiB 的数据，它需要“零时间”（你基本上是在后台执行`memcpy`，实际的写入发生在后台，以后的任何时间，甚至在你的程序完成之后）。即使您知道这是操作系统自然而然会做的事情，它的效果也令人惊叹。
当然，在操作系统写出所有页面之前最好不要出现电源故障，但对于任何类型的写入都是如此。不在磁盘上的东西不在*磁盘上*——除此之外，真的没有什么好说的了。如果您必须确定这一点，则必须等待磁盘同步完成，即使这样，您也不能确定*等待同步时*灯不会熄灭。这就是生活。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T10:01:10.407

我并没有声称比您更了解这一点，因为您似乎做了一些发明。并且完全确定您需要进行实验。但这是我对这些问题的理解，顺序相反：

1.  Windows 中的文件映射和重叠 IO 是不同的实现方式，它们都不依赖于其他*的*。但两者都使用异步块设备层。正如我想象的那样，在内核中，每个 IO 实际上都是异步的，但是一些用户操作会等待它完成，因此它们会产生同步的错觉。
2.  从第 1 点开始，如果一个线程进行 IO，来自同一进程的其他线程将*不会*停顿。除非系统资源稀缺或这些其他线程自己做 IO 并面临某种争用。无论第一个线程执行哪种 IO，这都是正确的：阻塞、非阻塞、重叠、内存映射。
3.  在内存映射文件中，一次至少读取一页数据，可能更多是因为预读，但您不能确定这一点。所以探测线程必须在每一页上至少接触一个映射内存。这将类似于probe/block-probe-probe-probe-probe/block-probe ...这可能比几MB的大重叠读取效率低一些。或者也许内核程序员很聪明，而且效率更高。您将不得不进行一些分析...嘿，您甚至可以不使用探测线程，看看会发生什么。
4.  取消重叠操作是一个 PITA，所以我的建议是使用内存映射文件。这样设置起来更容易，并且您可以获得额外的功能：
    1.  内存甚至在它完全在内存中之前就可以使用
    2.  内存可以/将由进程的多个实例共享
    3.  如果内存在缓存中，它将立即准备好，而不是很快。
    4.  如果数据是只读的，您可以保护内存不被写入，捕捉错误。

# php - 为什么我无法获得访问令牌？

> ID：15041017
> 
> 赞同：0
> 
> 时间：2013-02-23T13:25:00.343
> 
> 标签：php, curl, google-api, access-token

我正在尝试`access token`使用此代码但没有取得任何成功。我检查了每一个 curl 操作，一切都很好。但仍然无法获得令牌。

[这是来自 Google 的 OAuth2 指南](https://developers.google.com/accounts/docs/OAuth2WebServer)

```
$data_string = "code=" . $_REQUEST['code'] . "&client_id=" . $client_id . "&client_secret=" . $client_secret . "&redirect_uri=" . $redirect . "&grant_type=authorization_code";
$ch = curl_init();
curl_setopt($ch,CURLOPT_URL,'https://accounts.google.com/o/oauth2/token');
curl_setopt($ch,CURLOPT_POST,TRUE);
curl_setopt($ch,CURLOPT_RETURNTRANSFER,TRUE);
curl_setopt($ch,CURLOPT_HTTPHEADER,array('Content-type: application/x-www-form-urlencoded'));
curl_setopt($ch,CURLOPT_POSTFIELDS,$data_string);
$response = curl_exec($ch);
curl_close($ch);
//$data = json_decode($response);
print_r($response); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:59:39.390

请记住，如果您在 URL 中使用 HTTPS，则必须在代码中添加：

```
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:28:11.070

```
$data_string = "code=" . $_REQUEST['code'] . "&client_id=" . $client_id . "&client_secret=" . $client_secret . "&redirect_uri=" . $redirect . "&grant_type=authorization_code";
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,'https://accounts.google.com/o/oauth2/token');
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);
curl_setopt($ch, CURLOPT_AUTOREFERER, TRUE);
curl_setopt($ch, CURLOPT_POST,TRUE);
curl_setopt($ch, CURLOPT_POSTFIELDS,$data_string);
curl_setopt($ch, CURLOPT_VERBOSE, TRUE);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_RETURNTRANSFER,TRUE);
curl_setopt($ch, CURLOPT_HTTPHEADER,array('Content-type: application/x-www-form-urlencoded'));
$response = curl_exec($ch);
curl_close($ch); 
```

# c# - 是否有一种机制可以根据变量自动重新排序代码语句？

> ID：15041019
> 
> 赞同：-3
> 
> 时间：2013-02-23T13:25:22.957
> 
> 标签：c#

如果您有一个变量 X 和 Y 并将此代码应用于它们：

```
int x = 10;
int y = 0;
x++;
y = x;
out(y); 
```

那么代码的顺序对输出至关重要。

**我的问题**：是否有一个关键字可以让计算机根据变量以特定顺序运行代码？

**selOrder**是**我**为了这个例子而编造的一个关键字。它获取一个布尔值，并用它确定首先执行哪一行。

```
example:
{
      int x = 10;
      int y = 0;
      bool order = true;
      selOrder(order)
      {
          x++;
      }
      {
          y = x;
      }
      out(y);
} 
```

出：11

这个例子很可笑，它让这个问题看起来很可悲，但我是认真的，即使在这个例子中这个关键词是无用的。我偶然发现了许多可能非常漂亮的代码场景。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T13:33:57.307

在 C# 中没有 this 的关键字。以下是一些选项：

```
if (order)
{
    x++;
    y = x;
}
else
{
    y = x;
    x++;
} 
```

或者：（这让您只需键入每个部分一次，但阅读和运行更复杂）

```
Action firstAction = () => x++;
Action secondAction = () => y = x;
if (order)
{
    firstAction();
    secondAction();
}
else
{
    secondAction();
    firstAction();
} 
```

# java-me - PIM NoClassDefFoundError 但 jar 在类路径中

> ID：15041021
> 
> 赞同：1
> 
> 时间：2013-02-23T13:25:25.317
> 
> 标签：java-me, classpath, jsr75

当我在 KEmulator 或设备（索尼爱立信 k800i）上运行 PIM API 时，我正在我的 J2ME 应用程序中实现 PIM API 我收到此异常

```
java.lang.NoClassDefFoundError: javax/microedition/pim/PIMException 
```

尽管 jar 文件在 javax/microedition/pim 包中有 PIMException.class 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T07:58:44.207

那么问题就解决了，我需要做的就是添加 JSR api 作为参考库。

# javascript - 日期格式的javascript正则表达式异常

> ID：15041022
> 
> 赞同：0
> 
> 时间：2013-02-23T13:25:41.863
> 
> 标签：javascript, html

加载页面时出现异常，这是正则表达式。请帮我找出问题所在。如果我删除正则表达式，那么它可以工作。

```
 function show()
  {
    vat patt =/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d$/;
    var temp="08/02/1988";
    if(isNaN(temp.match(patt)))
       alert("success");
    else
       alert("not success");

  } 
```

**异常：** 错误：缺少；before 语句源文件：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:31:45.243

你的正则表达式应该是

```
var patt =/^(0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.](19|20)\d\d$/; 
```

问题：
1\. 拼写错误`vat`- 应该是`var`
2.`/`表达式中的所有内容都应该用`\/`

# objectify - 如何确保像“删除”这样的异步对象化 API 调用成功完成？

> ID：15041024
> 
> 赞同：0
> 
> 时间：2013-02-23T13:26:04.647
> 
> 标签：objectify

如何确保像“删除”这样的异步对象化 API 调用成功完成？

那么，“ofy().delete”如果没有成功完成会抛出一些异常吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T17:48:10.657

现在打电话（）。

```
ofy().delete().key(thing).now() 
```

这将执行同步删除操作。否则异步操作将在请求结束时完成（确保安装`ObjectifyFilter`），然后您将收到异常（例如超时）。

# c++ - concurrent_vector 在 parallel_for ( PPL ) 中不起作用

> ID：15041027
> 
> 赞同：0
> 
> 时间：2013-02-23T13:26:14.043
> 
> 标签：c++, concurrency, parallel-processing, ppl, parallel-for

下面有一个示例工作代码（parallel_for 使用并行模式库（ ppl ））。这里的主要问题是**sqr** < concurrent_vector > 存储的值在每次执行中都会发生变化，但它不应该如此！

我使用 < concurrent_vector > 进行随机访问，为什么它不起作用？

```
#include <iostream>
#include <ppl.h>
#include <concurrent_vector.h>

using namespace std;
using namespace concurrency;

const int a = 10, b = 30;

critical_section cs;

int main() {

    concurrent_vector< int > labels( a * b );

    concurrent_vector< int > sqr( 5 );

    // filling label vector
    for ( int y = 0; y < b; y++ ) {
        for ( int x = 0; x < a; x++ ) {

            if( x<2 && y>3 )
                labels[ a * y + x ] = 1;
            else if( x<30 && y<5 )
                labels[ a * y + x ] = 2;
            else if( x>5 && y>10 )
                labels[ a * y + x ] = 3;
            else if( x>2 && y>20 )
                labels[ a * y + x ] = 4;
        }
    }

    // printing
    for ( int y = 0; y < b; y++ ) {
        for ( int x = 0; x < a; x++ ) {

            cout << labels[ a * y + x ] << ", ";
        }
        cout << endl;
    }

    parallel_for ( 0, b, [ & ]( int y ) {
        for ( int x = 0; x < a; x++ ) {

            //cs.lock();  // when i used it's working but slow
            int i = labels[ a * y + x ];
            //cs.unlock();

            if ( i < 0 ) continue;

            sqr[ i ] ++;
        }
    } );

    for( int i=0; i<5; i++ )
        cout << sqr[i] << ", ";
    cout << "" << endl;

    system ("pause");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-12T07:45:45.657

您没有使用与并发相关的并发向量的任何功能。实际上，您可以将其替换为标准向量，没有区别...显然， i 的值在内核的每次执行中都会重叠。绝对不能保证对向量的同一元素的并发写入是同步的。因此，您会得到随机结果——这只是非原子写入数据竞争的结果。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-23T15:11:43.340

使用`task_group::wait`方法应该更快（因为您不必每次都锁定/解锁）并且它可能会按您的预期工作。

> 此方法会阻止当前任务，直到另一个任务组的任务完成它们的工作。

请参阅 MSDN：[并行任务](http://msdn.microsoft.com/en-us/library/gg663529.aspx#sec3)。

**更新：**我已经运行了一些计时测试，似乎这不是一个解决方案（除了我的双核上的大数据输入都失败了）。这可能是 Intel 的 TBB 中“concurrent_vector 中的设计”的错误 - [tbb::concurrent_vector 返回错误的大小](https://stackoverflow.com/questions/5396598/tbbconcurrent-vector-returns-wrong-size)

# php - 修复用于登录的 PHP MySQL 注入

> ID：15041031
> 
> 赞同：1
> 
> 时间：2013-02-23T13:26:32.990
> 
> 标签：php, mysql

我有一个 PHP 脚本，可以在用户输入正确的登录凭据时将其登录到我的网站。但是，我注意到通过输入`anything' OR 'x'='x`密码框很容易注入此登录信息。

我怎样才能阻止这种情况发生？

```
$query = "SELECT * FROM sm_editors WHERE email = '".$_POST['email']."' AND password = '".$_POST['password']."' AND user_type != 'reader-for-approval'"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T13:31:34.317

您首先需要清理输入以防止这种情况发生。

该函数`mysql_real_escape_string`将删除所有转义字符。

看看[用 PHP 清理用户输入的最佳方法是什么？](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)问题以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:30:59.480

您可以对传递给查询的数据使用 mysql_real_escape_string 函数，或者使用准备好的语句和存储过程而不是旧语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T13:33:16.757

```
$query = "SELECT * FROM sm_editors WHERE email = '".mysql_real_escape_string($_POST['email'])."' AND password = '".mysql_real_escape_string($_POST['password'])."' AND user_type != 'reader-for-approval'"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T13:37:28.247

首先你可以使用 mysql_real_escape_string 来转义字符串。

但更好的方法是在执行之前准备好 SQL 字符串。看看 PHP PDO MySQL 连接器。你有一些方法来准备你的字符串。

```
$s = $pdo->prepare('SELECT * FROM table WHERE field1 = :value');
$s->execute(array(':value' => $value)); 
```

看看[http://www.php.net/manual/de/pdo.prepared-statements.php](http://www.php.net/manual/de/pdo.prepared-statements.php)

# javascript - 避免在 HTML5 中刷新表单

> ID：15041035
> 
> 赞同：-1
> 
> 时间：2013-02-23T13:26:54.183
> 
> 标签：javascript, html

我陷入了这里提出的同样问题：

[在提交时停止 HTML5 表单发布、刷新或打开新窗口](https://stackoverflow.com/questions/8756584/stop-a-html5-form-posting-refreshing-or-opening-a-new-window-onsubmit)

我目前使用

```
event.preventDefault();
// to avoid refreshing of form 
```

我正在尝试的示例代码如下：

我的 html 页面包含以下代码片段：

```
<form id="sampForm">
  First name: <input type="text" name="fname" required><br>
  Age: <input type="number"  required><br>
  <input type="submit" onclick="OnSub(event)">
</form> 
```

我的js代码如下：

```
OnSub= function (_event) {
    try {
        _event.preventDefault();
   //do my process logic below or run any code here

    } catch (e) {

    }

}; 
```

> 但这会导致表单验证停止工作。

在此先感谢您的任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:57:03.710

表单有一个“onsubmit”事件。将你的函数绑定到那个。

```
<form id="sampForm" onsubmit="OnSub(event)">
  First name: <input type="text" name="fname" required><br>
  Age: <input type="number"  required><br>
  <input type="submit">
</form> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-23T13:34:16.400

我觉得你在表单提交上使用了一种方法来验证元素所以在你的方法的最后添加

```
return false; 
```

这将停止表单提交。

# ios - ^ 在目标 c ios 中是什么意思？

> ID：15041036
> 
> 赞同：6
> 
> 时间：2013-02-23T13:27:04.430
> 
> 标签：ios, objective-c, ios6

很抱歉问了这么简单的问题，但这些东西对谷歌来说很难。

我在 iOS 中有代码，它连接到在摄氏和华氏之间切换的切换，我不知道 ^ 1 是什么意思。self.celsius 是布尔值

谢谢

```
self.celsius = self.celsius ^ 1; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T13:29:14.910

这是一个 C 语言运算符，意思是“按位异或”。

[维基百科](http://en.wikipedia.org/wiki/Bitwise_operation#XOR)给出了很好的解释：

**异或**

> 按位异或采用两个长度相等的位模式，并对每对相应位执行逻辑异或运算。如果只有第一位为 1 或只有第二位为 1，则每个位置的结果为 1，但如果均为 0 或均为 1，则为 0。在此我们执行两个位的比较，如果两个位为 1位不同，如果相同则为 0。例如：

```
 0101 (decimal 5)
XOR 0011 (decimal 3)
  = 0110 (decimal 6) 
```

> 按位异或可用于反转寄存器中的选定位（也称为切换或翻转）。任何位都可以通过与 1 进行异或来切换。例如，给定位模式 0010（十进制 2），第二和第四位可以通过位模式在第二和第四位包含 1 的位模式进行按位异或来切换：

```
 0010 (decimal 2)
XOR 1010 (decimal 10)
  = 1000 (decimal 8) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T13:29:43.093

这是按位 XOR 运算符（请参阅[http://www.techotopia.com/index.php/Objective-C_Operators_and_Expressions#Bitwise_XOR](http://www.techotopia.com/index.php/Objective-C_Operators_and_Expressions#Bitwise_XOR)）。

在这种情况下它正在做的是来回切换，因为`0 ^ 1`是 1 和`1 ^ 1`0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T13:29:23.233

这是一个异或运算。

# ruby - 如何在 ruby 中访问这些内部变量？

> ID：15041039
> 
> 赞同：0
> 
> 时间：2013-02-23T13:27:52.193
> 
> 标签：ruby, metaprogramming

我正在尝试学习一些基本的 ruby​​ 元编程，并获得了这样的课程：

```
class A
  def initialize
    @a = 11
    @@a = 22 
    a = 33
  end

  @a = 1
  @@a = 2
  a = 3
end 
```

我需要像这样输出这些变量而不修改类：

```
1
2
3
11
22
33 
```

到目前为止，这是我的代码：

```
p A.instance_variable_get(:@a) #=> 1
p A.class_variable_get(:@@a) #=> 2

A.new.instance_eval do
    puts @a #=> 11
end 
```

现在如何访问剩余的变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T13:31:10.603

```
class A
  def initialize
    @a = 11
    @@a = 22 
    a = 33
  end

  @a = 1
  @@a = 2
  a = 3
end

p A.instance_variable_get(:@a) # >> 1
p A.class_variable_get(:@@a) # >> 2

p A.new.instance_variable_get(:@a) >> 11

p A.class_variable_get(:@@a) # >> 22 
```

请注意，获取 var 22 的行与获取 var 2 的行相同，因为它是同一个变量，并且在调用`A.new`.

至于普通`a`变量，您无法获取它们，因为它们是本地变量并且不再存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T16:32:31.533

好的，对于那些感兴趣的人来说，最终的解决方案是：

```
catcher = class A
  def initialize
    @a = 11
    @@a = 22
    a = 33
  end

  @a = 1
  @@a = 2
  a = 3
end 
```

有点作弊，但这有效

```
puts A.class_eval { @a } #=> 1
puts A.class_variable_get :@@a #=> 2

puts A.new.instance_eval { @a } #=> 11

puts catcher #=> 3

puts A.new.send :initialize #=> 33 
```

# sql - postgres 中的 SQL 将重复事件的日期时间转换为未来的日期时间

> ID：15041041
> 
> 赞同：3
> 
> 时间：2013-02-23T13:28:02.753
> 
> 标签：sql, ruby-on-rails, ruby-on-rails-3, postgresql, datetime

我只使用 DATETIME 来跟踪表中重复的每周事件。我只关心时间和它所在的星期几。

我需要能够将设置的 DATETIME 转换为当前或即将到来的未来。

IE 如何将存储为`2013-02-22 12:00:00`使用当前日期的日期转换为下一次出现的日期？即下周五 12:00:00`2013-03-01 12:00:00`左右，以便我可以按日期订购活动？

或者我可以将 TIME 和星期几分别存储为数字 0-6。

更新：

从欧文我得到了类似的东西：

```
Event.order("date_trunc('week', now()::timestamp) + (start_at - date_trunc('week', start_at))") 
```

除了我得到的第一个日期是星期一跳过我知道星期天存在的事件之外，这似乎对它们排序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:07:20.260

您最好的选择是存储 a`timestamp`或`timestamptz`( `timestamop with time zone`)。如果您已经或曾经必须处理多个时区，请确定`timestamptz`并定义您是要使用当地时间还是 UTC 或其他时间进行操作。此相关答案中的更多详细信息：
[在 Rails 和 PostgreSQL 中完全忽略时区](https://stackoverflow.com/questions/9571392/ignoring-timezones-altogether-in-rails-and-postgresql/9576170#9576170)

演示如何有效地将时间戳转换为当前周（一周中的同一天和时间）。假设`timestamp`这里：

```
SELECT date_trunc('week', now()::timestamp) + (t - date_trunc('week', t))
FROM (SELECT '2013-02-15 12:00:00'::timestamp AS t) x; 
```

诀窍是计算`interval`相应周的开始与给定周之间的时间，`timestamp`并借助 .将其添加到当前周的开始[`date_trunc()`](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC)。

ISO 周从星期一开始，最后是星期日。

或者，只为给定的时间增加一周`timestamp`：

```
SELECT t + interval '1 week'; 
```

如果你只想`ORDER BY`，你只需要间隔：

```
ORDER BY (t - date_trunc('week', t)) 
```

如果您想将星期日放在首位（换班日）：

```
ORDER BY ((t + interval '1d') - date_trunc('week', (t + interval '1d')) 
```

或更简单：

```
ORDER BY EXTRACT(dow FROM t), t::time 
```

引用[有关 EXTRACT() 的手册](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT)：

> `dow`
> 星期天（0）到星期六（6）
> 
> `isodow`
> 星期一（1）到星期日（7）是星期几

### 在评论中回答问题

> 我只对相对于当前日期订购它们感兴趣。即如果是星期二，我想先是星期二，最后是星期一。

在“今天”的午夜包装：

```
ORDER BY (EXTRACT(dow FROM t)::int + 7 - EXTRACT(dow FROM now())::int) % 7
         ,t::time 
```

使用[模运算符`%`](http://www.postgresql.org/docs/current/interactive/functions-math.html)根据“今天”移动日期。
使用`dow`而不是`isodow`，因为从开始`0`变得`%`更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T13:36:28.127

继续使用日期时间。它很简单，并为您提供了灵活性。您可以使用提取功能来获取一天中的时间和一周中的一天的结果。此页面将为您提供帮助。 [http://www.postgresql.org/docs/9.3/static/functions-datetime.html](http://www.postgresql.org/docs/9.3/static/functions-datetime.html)

# php - PHP 转发 JSON 对象

> ID：15041044
> 
> 赞同：1
> 
> 时间：2013-02-23T13:28:25.080
> 
> 标签：php, json

出于安全原因，我必须将 JSON 对象从 Jquery 脚本转发到 PHP 脚本。这是我所做的：

```
<?php
header('Access-Control-Allow-Origin: *');

$input = @file_get_contents('php://input');
$content = json_encode( $input );

$url = $_GET["trakt_url"]."KEY";

$ch = curl_init($url);                                                                 
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");                                                                     
curl_setopt($ch, CURLOPT_POSTFIELDS, $content);                                                                  
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);                                                                      
curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
    'Content-Type: application/json')                                                                       
);                                                                                                                   

$result = curl_exec($ch);
echo $result;
?> 
```

如果我记录 $content 我得到 JSON 对象，但我发布到的页面（$url）得到一个空对象。有人知道我做错了什么吗？

**已解决**（有人回答正确但答案被删除？！）

**curl_setopt($ch, CURLOPT_POSTFIELDS, "json=$content");**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:32:51.313

尝试在请求标头中设置内容长度：

```
curl_setopt($ch, CURLOPT_HTTPHEADER, array(                                                                          
    'Content-Type: application/json',                                                                                
    'Content-Length: ' . strlen($content))                                                                       
); 
```

您还需要确保将 POSTFIELDS 定义为 urlencoded 字符串，因为将其设置为数组会将内容类型覆盖为`multipart/form-data`. 这将起作用：

```
curl_setopt($ch, CURLOPT_POSTFIELDS, "json=$content"); 
```

# lucene - 如何从 Lucene 索引中抽取随机项？

> ID：15041048
> 
> 赞同：0
> 
> 时间：2013-02-23T13:29:07.843
> 
> 标签：lucene, statistics, nlp

我想随机绘制术语，按照原文中的方式分布。换句话说，如果“大象”这个词在所有索引文档中出现的频率是“河马”这个词的两倍，那么在我的随机抽取中它应该出现两倍的频率。这应该以有效的方式进行。

在我看来，索引可能不是一个理想的数据结构，但它很诱人：它包含所有术语及其频率。

# vb.net - 最快的子目录列表

> ID：15041053
> 
> 赞同：1
> 
> 时间：2013-02-23T13:29:25.813
> 
> 标签：vb.net, directory

我有一个应用程序，我想从给定路径获取所有子目录（第一级）。我使用这段代码：

```
 Dim di As New IO.DirectoryInfo(Application.StartupPath & "\Folderlist")
 For Each d In di.EnumerateDirectories()
    Console.WriteLine(d.ToString)
 Next 
```

如您所见，我只需要文件夹的名称，而不是包含所有信息的对象。有什么办法可以加快速度吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T13:33:28.183

```
Dim dirs() = Directory.GetDirectories(Application.StartupPath & "\Folderlist")
For Each dir In dirs
    Dim parent = Path.GetFileName(dir)
    Console.WriteLine(parent)
Next 
```

*   MSDN - [Directory.GetDirectories](http://msdn.microsoft.com/en-us/library/c1sez4sc.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)

> 获取指定目录中子目录的名称（包括它们的路径）。

[Path.GetFileName](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename%28v=vs.100%29.aspx)

# algorithm - 这个算法的时间复杂度是多少？

> ID：15041054
> 
> 赞同：0
> 
> 时间：2013-02-23T13:29:42.377
> 
> 标签：algorithm, complexity-theory, big-o, time-complexity

假设我们有一个`w`包含`n`整数的数组。请通过以下定义和以下伪代码告诉我算法 wrt 的时间复杂度是多少`n`：

```
idx[i] = max(j) : 1 <= j < i and w[j] < w[i]

alg:
Data: w : array of integers - idx: a pointer to maximum index with the less value.
Date: w is 1based

idx[1] = -1
for i=: 2 to n do
  j=i-1
  while w[j] > w[i] and j <> -1
  {
    j = idx[j]
  }
  idx[i] =j
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:43:34.063

你这里有 2 个循环 -

1.  第一个循环`for loop`运行 n 次。因此它的 O(n)。
2.  第二个循环`while loop`每次从 运行`(i-1) + (i-2) + (i-3) + .... + (i-n)`。它运行（n-1）次。很快）。

结合`O(n^2)`算法。其他操作要么是常数时间，要么是 O(n) 时间，因此被忽略。

# jquery - 大量项目的 Select2 性能

> ID：15041058
> 
> 赞同：53
> 
> 时间：2013-02-23T13:29:49.183
> 
> 标签：jquery, jquery-select2

我正在使用带有 twitter 引导程序的 select2 jquery 插件。它适用于较少数量的项目。但是当列表很大（超过 1500 项）时，它真的会变慢。它在 IE 中最慢。

Normal Dropdownlist 可以非常快速地处理超过 1500 个项目。这种情况有什么解决方法吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-08-23T21:15:49.680

即使在 IE8 中，您也可以通过对建议进行分页来使这项工作变得更好，

代码：

```
// Function to shuffle the demo data
function shuffle(str) {
  return str
    .split('')
    .sort(function() {
      return 0.5 - Math.random();
  })
.join('');
}

// For demonstration purposes we first make
// a huge array of demo data (20 000 items)
// HEADS UP; for the _.map function i use underscore (actually lo-dash) here
function mockData() {
  return _.map(_.range(1, 20000), function(i) {
    return {
      id: i,
      text: shuffle('te ststr ing to shuffle') + ' ' + i,
    };
  });
}
(function() {
  // init select 2
  $('#test').select2({
    data: mockData(),
    placeholder: 'search',
    multiple: true,
    // query with pagination
    query: function(q) {
      var pageSize,
        results,
        that = this;
      pageSize = 20; // or whatever pagesize
      results = [];
      if (q.term && q.term !== '') {
        // HEADS UP; for the _.filter function i use underscore (actually lo-dash) here
        results = _.filter(that.data, function(e) {
          return e.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0;
        });
      } else if (q.term === '') {
        results = that.data;
      }
      q.callback({
        results: results.slice((q.page - 1) * pageSize, q.page * pageSize),
        more: results.length >= q.page * pageSize,
      });
    },
  });
})(); 
```

这里有 20000 个项目的工作示例：http: [//embed.plnkr.co/db8SXs/preview](http://embed.plnkr.co/db8SXs/preview)

plnkr embed 不支持 IE8，因此请使用以下链接在 IE8 上试用： [http ://run.plnkr.co/plunks/db8SXs/](http://run.plnkr.co/plunks/db8SXs/)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2014-07-16T20:51:05.830

我知道这是一个老问题，但我想分享对我有用的东西。如果您**必须**预先加载大列表（取决于您是从头开始还是在其他人的代码上构建，这可能更容易），请`minimumInputLength`按照文档中的[说明](http://ivaynberg.github.io/select2/#minimum)使用。在用户输入几个字符之前，不会显示巨大的选项列表。当实际选择 Select2 下拉菜单时，这大大降低了渲染它们时的性能损失。希望有帮助！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-01-29T14:02:09.343

**这是 Select2 v4 的工作版本**

根据[此处](https://stackoverflow.com/a/33174942/5601169)的答案：并对其进行修改以使搜索与 lo-dash

```
$(function () {
    items = []
    for (var i = 0; i < 1000; i++) {
        items.push({ id: i, text : "item " + i})
    }

    pageSize = 50

    jQuery.fn.select2.amd.require(["select2/data/array", "select2/utils"],

    function (ArrayData, Utils) {
        function CustomData($element, options) {
            CustomData.__super__.constructor.call(this, $element, options);
        }
        Utils.Extend(CustomData, ArrayData);

        CustomData.prototype.query = function (params, callback) {

            var results = [];
            if (params.term && params.term !== '') {
              results = _.filter(items, function(e) {
                return e.text.toUpperCase().indexOf(params.term.toUpperCase()) >= 0;
              });
            } else {
              results = items;
            }

            if (!("page" in params)) {
                params.page = 1;
            }
            var data = {};
            data.results = results.slice((params.page - 1) * pageSize, params.page * pageSize);
            data.pagination = {};
            data.pagination.more = params.page * pageSize < results.length;
            callback(data);
        };

        $(document).ready(function () {
            $("select").select2({
                ajax: {},
                dataAdapter: CustomData
            });
        });
    })
}); 
```

**JsFiddle**：http: [//jsfiddle.net/nea053tw/](http://jsfiddle.net/nea053tw/)

**编辑：**小提琴改变了。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-07-29T02:30:05.473

所以请记住，您正在以`<option>`s 的形式将超过 1500 个实际元素加载到页面上，这最终也会损害页面性能。正如评论中的用户建议的那样，您可以通过对将返回您的值的后端服务进行 AJAX 调用来解决性能问题。

[Select2 Ajax 操作方法](http://ivaynberg.github.io/select2/#ajax)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-03-28T06:22:51.873

对我来说最简单和最短的作品是：

```
$(".client_id").select2({
   minimumInputLength: 2
 }); 
```

您可以根据需要更改 minimumInputLength 的值。

这样，select2 将不必显示整个列表，而是仅在输入固定数量的字符后才会显示结果。尽管您仍然在前端代码中拥有大量列表。

此外，如果您使用的是 allowClear，那么您必须像这样声明占位符：

```
$(".client_id").select2({
    minimumInputLength: 2,
    allowClear: true,
    placeholder: '--Select Client--'
 }); 
```

在此处查看文档[http://select2.github.io/select2](http://select2.github.io/select2)

如果您的数据仍然太大并且仍然存在性能问题，请使用 Ajax 方法。最好不要在select中加载太大的数据，而是使用Ajax for Select2 [https://select2.org/data-sources/ajax](https://select2.org/data-sources/ajax)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-08-25T12:32:10.627

这是一个非常古老的问题和答案，甚至我们有更新版本的 select2。但如果有人也试图在 optgroup 中搜索。可以试试这个解决方案。

[http://jsfiddle.net/na1zLkz3/4/](http://jsfiddle.net/na1zLkz3/4/)

```
 // Function to shuffle the demo data 
var shuffle = function (str) {
    return str.split('').sort(function () {
      return 0.5 - Math.random();
    }).join('');
  };

// For demonstration purposes we first make
// a huge array of demo data (20 000 items)
// HEADS UP; for the _.map function i use underscore (actually lo-dash) here
var mockData = function () {
    var array = _.map(_.range(1, 10), function (i) {
        return {
          id  : i,
          text: shuffle('te ststr ing to shuffle') + ' ' + i
        };
      });
    return array;
  };
  var mockData1 = function () {
    var array = _.map(_.range(10, 15), function (i) {
        return {
          id  : i,
          text: shuffle('te ststr ing to shuffle') + ' ' + i
        };
      });
    return array;
  };
  var mockData2 = function () {
    var array = _.map(_.range(15, 20), function (i) {
        return {
          id  : i,
          text: shuffle('te ststr ing to shuffle') + ' ' + i
        };
      });
    return array;
  };
  // create demo data
  var dummyData = mockData();
  var dummyData1 = mockData1();
  var dummyData2 = mockData2();
  dummyData.push({
  text: 'canada',
  children: dummyData1
  });
  dummyData.push({
  text: 'USA',
  children: dummyData2
  });

  // init select 2
  $('#ddlCar').select2({
    data             : dummyData,
    // init selected from elements value
    initSelection    : function (element, callback) {
      var initialData = [];
      $(element.val().split(",")).each(function () {
        initialData.push({
          id  : this,
          text: this
        });
      });
      callback(initialData);
    },

    // NOT NEEDED: These are just css for the demo data
    dropdownCssClass : 'capitalize',
    containerCssClass: 'capitalize',

    // NOT NEEDED: text for loading more results
    formatLoadMore   : function() {return 'Loading more...'},

    // query with pagination
    query            : function (q) {
      var pageSize,
        results;
      pageSize = 20; // or whatever pagesize
      var results  = [];
      if (q.term && q.term !== "") {
        // HEADS UP; for the _.filter function i use underscore (actually lo-dash) here
        var results = this.data;
        var results = _.filter(results, function (e) {
            if(typeof e.children != 'undefined')
          {
            subresults = _.filter(e.children, function (f) {
                return (f.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0);
            });
            if(subresults.length > 0)
                return true;
            return false;
          }
          return (e.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0);
        });
        newresults = [];
        for (var i = 0, len = results.length; i < len; i++) {
        newresults[i] = {};
        if(typeof results[i].text != 'undefined')
            newresults[i].text = results[i].text;
        if(typeof results[i].id != 'undefined')
            newresults[i].id = results[i].id;
        if(typeof results[i].children != 'undefined')
        {
            newresults[i].children = results[i].children;
            newresults[i].children = _.filter(newresults[i].children, function (f)                          {
                return (f.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0);
            });
        }
      }
      results = newresults;
      } else if (q.term === "") {
        results = this.data;

      }

      q.callback({
        results: results.slice((q.page - 1) * pageSize, q.page * pageSize),
        more   : results.length >= q.page * pageSize
      });
    }
  }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-04T13:23:49.887

作为另一个更新，我想分享对我有用的东西，因为为这么旧的东西寻找支持变得越来越困难。我已经使用 npm 安装了 select 2，发现包含两个版本。默认版本`require('select2')`不支持查询参数。需要完整版本`require('select2/dist/js/select2.full')`，然后使用此处显示的代码对我使用 select 2 v4，data() 返回 16k 城市的列表

```
 $(".select_2_cities").select2({
            theme: "bootstrap",
            data: data(),
            multiple: true,
            query            : function (q) {
              var pageSize,
                results;
              pageSize = 20; // or whatever pagesize
              var results  = [];
              if (q.term && q.term !== "") {
                // HEADS UP; for the _.filter function i use underscore (actually lo-dash) here
                var results = this.data;
                var results = _.filter(results, function (e) {
                    if(typeof e.children != 'undefined')
                  {
                    subresults = _.filter(e.children, function (f) {
                        return (f.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0);
                    });
                    if(subresults.length > 0)
                        return true;
                    return false;
                  }
                  return (e.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0);
                });
                newresults = [];
                for (var i = 0, len = results.length; i < len; i++) {
                newresults[i] = {};
                if(typeof results[i].text != 'undefined')
                    newresults[i].text = results[i].text;
                if(typeof results[i].id != 'undefined')
                    newresults[i].id = results[i].id;
                if(typeof results[i].children != 'undefined')
                {
                    newresults[i].children = results[i].children;
                    newresults[i].children = _.filter(newresults[i].children, function (f)                          {
                        return (f.text.toUpperCase().indexOf(q.term.toUpperCase()) >= 0);
                    });
                }
              }
              results = newresults;
              } else if (q.term === "") {
                results = this.data;
              }
              q.callback({
                results: results.slice((q.page - 1) * pageSize, q.page * pageSize),
                more   : results.length >= q.page * pageSize
              });
            }
        });
```

# java - 更改数组中的数据与创建新数组 Java

> ID：15041061
> 
> 赞同：0
> 
> 时间：2013-02-23T13:30:16.013
> 
> 标签：java, arrays

我正在做一个需要绘制一些数据的项目。目前我将所有数据保存在一个对象中，然后将指向该对象的指针指向图形。但是可以动态更改数据，而我需要更改图表获取的数据。所以这是我的问题：

我应该在每次编辑数据时创建一个新数组还是然后更改图表中的指针，或者我应该只更改原始数组中的数据并重新绘制图表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:32:51.127

保留一个模型是首选方法，尤其是从内存性能的角度来看。但是，这可能取决于。如果您在其他地方使用相同的模型，那么您必须多考虑一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T13:36:12.220

使用不可变数据会产生更清晰、更可预测的 API。如果您改变图形 API 当前使用的数组，讨厌的交互就潜伏在拐角处。这可能会导致图形 API 在内部防御性地复制数组；到那时你就输了：如果你一开始就采用不可变的方法，你得到的复制比你需要的要多。

# android - 更新小部件 TextView 的清晰方法

> ID：15041066
> 
> 赞同：0
> 
> 时间：2013-02-23T13:31:03.543
> 
> 标签：android, android-widget, textview, broadcastreceiver, alarmmanager

`Timer`我试图让,`BroadcastReceiver`等方法工作所花费的时间`AlarmManager`。我所需要的只是一种每秒更新小部件或文本视图的**清晰方法。**

```
java.util.Date noteTS = Calendar.getInstance().getTime();

String time = "kk:mm";
String date = "dd MMMMM yyyy";

views.setTextViewText(R.id.tvTime, DateFormat.format(time, noteTS));
views.setTextViewText(R.id.tvDate, DateFormat.format(date, noteTS)); 
```

我基本上需要这个来设置文本，无论是时间变化还是每秒更新一次。我试过的每一种方法都失败了。有人可以给我最好的方法吗？怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:46:00.500

您可以使用处理程序和线程：

```
private Handler mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        // update your textview here.
    }
};

class TickThread extends Thread {
    private boolean mRun; 

    @Override
    public void run() {
        mRun = true;

        while(mRun) {
            try {
                sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        mHandler.sendEmptyMessage(0);
    }
} 
```

# ember.js - Ember-Data 中的部分更新？

> ID：15041072
> 
> 赞同：7
> 
> 时间：2013-02-23T13:31:49.743
> 
> 标签：ember.js, ember-data

想象一个错误跟踪器。

每张票都包含大量数据。现在，一长串工单中的一些工单的状态已更新。

```
App.Ticket = DS.Model.extend({
    id: DS.attr('number'),
    status: DS.attr('string'),
    ...
}); 
```

目前，当调用`save`ember-data 时，这会将完整的模型发送到服务器。

**我能做些什么来只发送部分更新，比如`[{"id": 1, "status": "closed"}, {...}]`？**

*PS：我知道现在这是不可能的，所以我想知道是否有解决方法/修改可以实现这一点？（不需要通用解决方案）。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T08:45:30.037

我当前的解决方法是指定一个`readOnly`选项，排除我不想在 POST 中发送的属性。

详细信息可以在这里找到：[https ://github.com/emberjs/data/pull/303#issuecomment-13993905](https://github.com/emberjs/data/pull/303#issuecomment-13993905)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-10T12:38:13.757

我也在研究这个问题，如果你希望它适用于*所有*保存，那么今天你可以使用如下序列化程序修复它`serializers/ticket.js`：

```
import DS from 'ember-data';

export default DS.RESTSerializer.extend({
  attrs: {
    status: {serialize: false}
  }
}); 
```

这将剥离`status`。

# html - Html 5 vs Web 浏览器存储

> ID：15041073
> 
> 赞同：1
> 
> 时间：2013-02-23T13:31:56.263
> 
> 标签：html

我对 html5 与 Web 浏览器存储的存储有些混淆

让我感到困惑的是，当我们说 html5 存储时，它是什么意思，当我们说网络浏览器存储时，它们是什么意思，它们是不同的事物还是具有不同 Terminalogies 的相同事物，请纠正我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T13:45:22.697

HTML 5 添加了额外的存储选项，允许您存储更多数据。他们是`localStorage`并且`sessionStorage`

过去，您唯一的选择是“cookies”，超过 100K 左右就不可靠。充其量这些只会保存一个会话指针，大部分数据实际上存储在服务器上。与 cookie 不同，localStorage 不受到期日期的约束。

“Web 浏览器存储”是一个通用术语，并不一定意味着 cookie。您的两个基本选项是服务器存储（数据库、平面文件等）或 Web 浏览器存储（cookie、HTML5 localStorage、sessionStorage、页面变量等）。

# mysql - 替换路径中未知数字的Mysql查询

> ID：15041074
> 
> 赞同：0
> 
> 时间：2013-02-23T13:31:56.920
> 
> 标签：mysql, sql

假设您在表中存储了以下内容：

{2:22}{4:5}{34:4}

我要从这个字符串中删除 {4:5} 的内容，但系统不知道“：”后面的数字是第一个数字。查询看起来像这样：

UPDATE `tbl`SET `this`= REPLACE( `this`,'{4:??}','') WHERE `id`= 1;

我需要放什么？？返回以下结果的地方？

{2:22}{34:4}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:38:19.360

这是使用`LEFT`,`SUBSTRING`和`LOCATE`的一种方法`REPLACE`：

```
update yourtable 
set yourcolumn = 
    replace(yourcolumn,
        Left(
            Substring(yourcolumn, 
                 Locate('{4:',yourcolumn),
                 Length(yourcolumn)),
        Locate('}',Substring(yourcolumn, 
                 Locate('{4:',yourcolumn),
                 Length(yourcolumn)))), 
        '') 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/651aa/1)

# c# - 使用c#代码动态更新salesforce wsdl

> ID：15041077
> 
> 赞同：6
> 
> 时间：2013-02-23T13:32:21.330
> 
> 标签：c#, .net, salesforce

我有 .net 应用程序，它动态创建 salesforce 自定义对象，但是当我在我的应用程序中使用该对象时，它不会访问它。我想做的是，我想在创建自定义对象后立即更新 wsdl。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T23:15:56.487

您可能正在使用 Enterprise WSDL，它包含所有对象的存根。如果您希望对象发生变化（就像您在此处所做的那样），那么您应该改用 Partner WSDL。Partner WSDL 不包含对象的存根；相反，合作伙伴 WSDL 文件定义了一个表示所有对象的单个通用对象 (sObject)。

有关更多信息，请查看Salesforce.com API 文档中名为“[使用合作伙伴 WSDL ”的部分。](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#CSHID=sforce_api_partner.htm%7CStartTopic=Content/sforce_api_partner.htm%7CSkinName=webhelp)

# javascript - 单击时更改 div 的 id

> ID：15041079
> 
> 赞同：0
> 
> 时间：2013-02-23T13:32:31.677
> 
> 标签：javascript, css

如何将 onClick 侦听器添加到 div。如果之前不活动，我想将 div 的名称更改为 divclass active，然后如果用户再次单击列表，则删除“活动”一词。我不知道该怎么做。这是我迄今为止尝试过的

```
<script>

$function tog(){
$(this).toggleClass('active');
return false;
}

$(function() {

var dd = new DropDown( $('#dd') );

$(document).click(function() {
    // all dropdowns
    $('.wrapper-dropdown-4').removeClass('active');
});

});
</script> 
```

我要更改其类名的 div 定义如下

```
<div id="dd" onclick="tog()" class="wrapper-dropdown-4">
  <!--something-->
  </div> 
```

这个我试过了。。

```
<html>
<head>
<script>
$('#dd').on('click', function(){
$(this).toggleClass('active')
});
</script>

<style>
.active {
color: red;
}
</style>
</head>
<body>

<div id="dd" class="wrapper-dropdown-4">
ddddd
</div>

</body>
</html> 
```

现在这有什么问题？

我正在通过 chrome 开发人员的工具检查元素 ID，并且我没有看到使用此代码的任何更改。那么，有人可以帮忙吗？谢谢。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T13:36:13.087

您需要的唯一脚本是

```
$(function(){
    $('#dd').on('click', function(){
        $(this).toggleClass('active')
    });
}); 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/7vH5k/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:36:12.530

你必须传递对象 $(this) is not recognizable ，使用 tog(this)

```
 <script>
     function tog(obj)
     {
        $(obj).toggleClass('active');
        return false;
     }

 $(function() {

 var dd = new DropDown( $('#dd') );

 $(document).click(function() {
 // all dropdowns
 $('.wrapper-dropdown-4').removeClass('active');
 });

 });
 </script>

 <div id="dd" onclick="tog(this)" class="wrapper-dropdown-4">
   <!--something-->
 </div> 
```

不是最好的方法，您可以通过在事件中注册点击来绑定事件。

# android - NoClassDefFoundError android 弹性扩展

> ID：15041085
> 
> 赞同：0
> 
> 时间：2013-02-23T13:33:09.783
> 
> 标签：android, actionscript-3, apache-flex, air-native-extension

我为 flex 应用程序创建了一个原生扩展，但我遇到了问题。我的问题是我从本机 java 代码中得到一个 NoClassDefFoundError 。未找到的类在第三方 jar 中。我在eclipse中将第三方jar添加为lib文件，也在项目构建pats上设置，也设置为导出资源。我认为问题出在我为扩展打包最终的 .jar 文件时。我解压了 .jar 文件，第三方 jar 就在那里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T02:34:19.623

使用 Java ANE 打包第三方库时必须小心。您经常需要解压缩第三方 jar 文件并将类文件与您自己的文件一起包含在内。

```
jar xf 3rd_party_lib.jar 
```

然后重新打包你的 ANE 库 jar

```
jar uf your_native_ane_libary.jar [directory of all your class files] 
```

您必须在使用 adt 打包 ANE 之前执行此操作。

# php - mysql-通过id从一个表中选择一个产品，然后从另一个表中选择它的关联图像

> ID：15041086
> 
> 赞同：1
> 
> 时间：2013-02-23T13:33:14.983
> 
> 标签：php, mysql

我有一张产品表和一张图片。每个产品都有多个图像。我想根据其 id 检索产品并获取其所有相关图像。到目前为止我有这个查询，但它没有返回任何东西......希望能得到一些帮助。

```
$result = mysqli_query(
    $link, sprintf("
        SELECT * FROM products product 
        JOIN images image 
        ON product.id = image.product_id 
        WHERE product.id='%s'", 
        mysqli_escape_string($link, $id)
    )
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:40:05.490

SELECT * FROM products JOIN images ON products.id = images.product_id WHERE products.id='%s'

# javascript - $("#id").click(function(){calculation()});

> ID：15041088
> 
> 赞同：0
> 
> 时间：2013-02-23T13:33:24.140
> 
> 标签：javascript, jquery, onclick

标题中的行有什么问题？

下面的示例应该创建一个按钮，每次单击该按钮时都会增加一个计数器。但是，我强制在按钮单击之间延迟 2000 毫秒。但是，如果我使用注释掉的行而不是

```
document.getElementById("rollButton").onclick=function(){calculation()}; 
```

（都在函数 afterWaiting() 中）

我得到了各种奇怪的结果，例如计数器开始增加超过 1，等待时间消失了？

```
<!DOCTYPE html>
<html>
    <head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>

        function afterWaiting()
        {
            $("#rollButton").css("color","black");
            //$("#rollButton").click(function(){calculation()});
            document.getElementById("rollButton").onclick=function(){calculation()};

        }

        var counter=0;
        function calculation()
        {

            ////Enforcing wait:
            document.getElementById("rollButton").style.color="red";
            document.getElementById("rollButton").onclick="";
            window.setTimeout("afterWaiting()",2000);

            counter=counter+1;
            document.getElementById("test").innerHTML=counter;

            }

    </script>

    </head>
<body>

  <button type="button" onclick="calculation()" id="rollButton"> Roll! </button>

<p id="test"> </p>

</body>
</html> 
```

我误解了什么？

提前致谢 ：）

JSFiddle：http: [//jsfiddle.net/Bwxb9/](http://jsfiddle.net/Bwxb9/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T13:41:19.503

不同之处在于，当您像在原始版本中那样应用事件处理程序时`onclick`，您只能将一个处理程序绑定到元素。并使用`onclick=""`一种清除它。

使用 jQuery`.click(handler)`时，每次调用它时都会绑定一个新的处理程序（并且您可以使用`unbind('click')`(*而不是使用`onclick=""`*) 取消绑定它。因此，在对您的元素进行几次调用后，`afterWaiting`您已在元素上应用了多次单击处理程序，并且每次单击时，`calculation`函数都会运行多次..

因此，纠正它的一种方法是替换

```
document.getElementById("rollButton").onclick=""; 
```

和

```
$('#rollButton').unbind('click'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T13:40:38.447

这通常是一种奇怪且令人困惑的方法。这是我的做法，无需过多地混合 jquery 和纯 js（onclick）：

[http://jsfiddle.net/LGvKS/](http://jsfiddle.net/LGvKS/)

```
var wait = false;
counter = 0;
$('button').click(function(){
    if(!wait){
        $('span').text(++counter);
        wait=true;
        setTimeout(function(){
            wait=false;
        },2000);
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T13:42:03.050

唯一需要的代码是

```
<button type="button" id="rollButton"> Roll! </button>
<p id="test"> </p>

var counter = 0;
var $test = $('#test');
var $rollButton = $('#rollButton');
function increment(){
    $test.html(counter++);
    $rollButton.off('click', increment);
    setTimeout(function(){
        $rollButton.on('click', increment);
    }, 2000);
}
$rollButton.on('click', increment); 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/76y9Z/)

更新：按照安迪的建议，但我会推荐安迪的答案，因为它不涉及额外的事件操作

```
var counter = 0;
var $test = $('#test');
var $rollButton = $('#rollButton');
function increment(){
    $test.html(counter++);
    setTimeout(function(){
        $rollButton.one('click', increment);
    }, 2000);
}
$rollButton.one('click', increment); 
```

演示：[小提琴](http://jsfiddle.net/76y9Z/1/)

# magento - Magento：生成图像缓存

> ID：15041089
> 
> 赞同：1
> 
> 时间：2013-02-23T13:33:27.527
> 
> 标签：magento, caching

当我清空“图像缓存”时

我运行这个脚本：

```
<?php
apc_clear_cache();
require '../app/Mage.php';
function getImages($store){
    Mage::app()->setCurrentStore($store);
    $products = Mage::getModel('catalog/product')->getCollection();
    $products->addAttributeToSelect('name');
    foreach($products as $product) {
        echo 'product: '.$product->name.' IMAGE: '.$product->getImageUrl().'<br>';
    }

}

foreach (Mage::app()->getWebsites() as $website) {
    echo $website;
    foreach ($website->getGroups() as $group) {
        $stores = $group->getStores();
        foreach ($stores as $store) {
            getImages($store);
        }
    }
}

echo 'done'; 
```

我想要的是缓存中的所有图像都会刷新，但它们不会（仅当我在浏览器中加载 url 时）

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:02:09.543

要创建图像，您需要使用`Mage::helper('catalog/image')`.

问题是，只有模板文件知道需要图像的尺寸，因此您必须从模板（以及您拥有产品图像的所有其他地方）复制代码并通过创建不同尺寸的图像帮手。

一个提示：创建在`__toString()`方法中。

# java - Spring JDBC 的事务处理不适用于 Google Guice

> ID：15041091
> 
> 赞同：4
> 
> 时间：2013-02-23T13:33:34.983
> 
> 标签：java, transactions, guice, spring-jdbc, jooq

我在我的项目中使用 Google Guice 和[jOOQ 。](http://www.jooq.org)目前我决定使用 Spring JDBC 引入事务处理。

所以我做了以下。

我在 Guice 模块中设置了一个数据源和一个事务管理器。

```
@Provides
@Singleton
DataSource provideDataSource(IExternalSettings settings) {
    Jdbc3PoolingDataSource dataSource = new Jdbc3PoolingDataSource();
    // configuring DataSource
    return dataSource;
}

@Provides
@Singleton
DataSourceTransactionManager provideDataSourceTransactionManager(DataSource dataSource) {
    return new DataSourceTransactionManager(new TransactionAwareDataSourceProxy(dataSource));
} 
```

然后我将我的事务管理器注入持久性外观

```
@Inject
public PersistenceFacade(final DataSourceTransactionManager transactionManager) {
    this.dataSource = transactionManager.getDataSource();
    this.transactionManager = transactionManager;
} 
```

后来，我使用这个数据源创建了 jOOQ 工厂：`new Factory(dataSource, ...)`.

最后我运行我的数据库访问代码：

```
DefaultTransactionDefinition transactionDefinition = new DefaultTransactionDefinition();
TransactionStatus transaction = transactionManager.getTransaction(transactionDefinition);
try {
    // db code in transaction
    transactionManager.commit(transaction);
    return result;
} catch (Exception e) {
    transactionManager.rollback(transaction);
    throw e;
} 
```

到现在为止还挺好。它**按预期工作**。

所以，我的下一步是`@Transactional`使用 Guice AOP 引入注解。我创建了一个拦截器

```
class TransactionalMethodInterceptor implements MethodInterceptor {

    @Inject
    private DataSourceTransactionManager transactionManager;

    @Override
    public Object invoke(final MethodInvocation invocation) throws Throwable {
        DefaultTransactionDefinition transactionDefinition = new DefaultTransactionDefinition();
        TransactionStatus transaction = transactionManager.getTransaction(transactionDefinition);
        try {
            Object result = invocation.proceed();
            transactionManager.commit(transaction);
            return result;
        } catch (Exception e) {
            transactionManager.rollback(transaction);
            throw e;
        }
    }
} 
```

`configure()`并在Guice 模块的方法中配置它：

```
TransactionalMethodInterceptor transactionalMethodInterceptor = new TransactionalMethodInterceptor();
requestInjection(transactionalMethodInterceptor);
bindInterceptor(Matchers.any(), Matchers.annotatedWith(Transactional.class), transactionalMethodInterceptor); 
```

现在**问题开始了**。我可以看到，使用调试器，控制流到达拦截器。特别是，它到达`transactionManager.rollback(...)`调用。但事务**实际上并没有回滚**。

我不知道是什么原因。有任何想法吗？我会很感激的。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:02:16.630

我终于设法回到这个，我想我找到了解决方案。

首先，我需要提一下我引入了一个误解，当我说没有 AOP 一切都可以工作时。今天我无法重现它，我注意到回滚的连接与 jOOQ 使用的连接不同。所以 Alan Vrecko（见上面的评论）是对的！

然后我找到[了这个答案](https://stackoverflow.com/questions/4474365/jooq-and-spring/12326885#12326885)和[这个片段](https://gist.github.com/agentgt/3669307)。我决定试一试，它奏效了！但是，之前的所有步骤似乎都是有效的，并且仍然需要存在（包括 Google Guice 的拦截器）。

我必须引入的唯一更改是`DataSourceUtils.releaseConnection(con, dataSource);`从`SpringExceptionTranslationExecuteListener. exception(ExecuteContext ctx)`. 所以最后这个方法看起来像

```
@Override
public void exception(ExecuteContext ctx) {
    SQLException ex = ctx.sqlException();
    Statement stmt = ctx.statement();
    Connection con = ctx.getConnection();
    DataSource dataSource = ctx.getDataSource();
    JdbcUtils.closeStatement(stmt);
    ctx.exception(getExceptionTranslator(dataSource).translate("jOOQ", ctx.sql(), ex));
} 
```

然后一切似乎都正常工作。谢谢大家的意见。当然，我仍然愿意接受新的/更好的解决方案。

# java - 将字符串从类传递到主要活动

> ID：15041097
> 
> 赞同：0
> 
> 时间：2013-02-23T13:34:19.863
> 
> 标签：java, android

我正在尝试将某个类中的某些内容传递给我的 MainActivity，但它似乎不起作用，我不明白为什么。为了重用它，我在另一个类（不是 MainActivity）上有我的 GPS 跟踪器。当位置改变时，我希望我的其他类从 MainActivity 中调用一个方法来更新我的 UI。

我这样总结了我的代码：

```
 My MAIN ACTIVITY :

public class MainActivity extends Activity implements OnClickListener {

TextView tv;
EditText et;
Button btun;
int arg0;
int stuff;

 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    tv = (TextView) findViewById(R.id.tv);
    et = (EditText) findViewById(R.id.et);
    btun = (Button) findViewById(R.id.btun);
    btun.setOnClickListener(this);
}

private void setter(int stuff) {
    tv.setText(stuff);
}

public void setText(int _stuff) {
    _stuff = stuff;
    setter(_stuff);
}

@Override
public void onClick(View v) {
    Getter get = new Getter();
    get.getInfo(Integer.parseInt(et.getText().toString()));
} 
```

另一类：

```
public class Getter {

int _getString;
MainActivity main = new MainActivity();

public void getInfo(int getString) {
    _getString = getString * 8;
    main.setText(_getString);
    }
} 
```

我最终在我的 LogCat 中有一个 NullPointerException：

```
- tv.setText(stuff);
- setter(_stuff);
- main.setText(_getString);
- get.getInfo(Integer.parseInt(et.getText().toString())); 
```

我真的不知道为什么，最重要的是，如何解决它。

我将不胜感激任何帮助！

（PS：我的 GPS 跟踪器工作正常，只是调用我的 setter() 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T13:38:30.813

这可能是因为尚未调用 MainActivity 的 onCreate() 方法。因此电视仍然是 null 导致 NullPointerException

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:42:47.097

实例化 Object`MainActivity`不会自动调用`onCreate`方法，但是当您使用`Intent`;启动活动时会调用此方法 并且使用相同的意图，您可以传递额外的值。例如：

```
Intent intent = new Intent(context, MainActivity.class);
intent.putExtra("key", value);
context.startActivity(intent); 
```

然后在您的主要活动`onCreate`方法中：

```
String value = getIntent.getStringExtra("key"); 
```

**编辑：** 在你的情况下，你为什么不改变你`void getInfo(int getString)`的返回`String`值，即

```
public class Getter {
...
...

    public String getInfo(int getString) {
        _getString = getString * 8;
        return Integer.toString(_getString);
    }
} 
```

然后在`onClick`绑定`MainActivity`这个返回的文本到`TextView`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:02:15.683

这里有一个问题。main是一个Activity，但应该是调用这个对象的MainActivity。

```
public class Getter {

int _getString;
MainActivity main = new MainActivity();

public void getInfo(int getString) {
    _getString = getString * 8;
    main.setText(_getString);
    }
} 
```

我无法真正弄清楚您在 Getter 类中要实现的目标，但是：

1：将Activity实例传递给对象

```
public class Getter {
        int _getString;
        MainActivity _main = null;

        public Getter(MainActivity main) {
            _main = main;
        }

        public void getInfo(int getString) {
            _getString = getString * 8;
            _main.setText(_getString);
        }
    }

@Override
public void onClick(View v) {
    Getter get = new Getter(this);
    get.getInfo(Integer.parseInt(et.getText().toString()));
} 
```

或者

2：在Activity中设置文本，只从Getter中获取值（我的选择）

```
public class Getter {
    int _getString;
    MainActivity main = new MainActivity();

    public void getInfo(int getString) {
        return getString * 8;
    }
}

@Override
public void onClick(View v) {
    Getter get = new Getter();
    int info = get.getInfo(Integer.parseInt(et.getText().toString()));  
    setText(Integer.toString(info));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T14:11:38.867

使用应用程序类或创建一个单独的类并在其中声明一个静态变量。使用 getter 和 setter 方法获取值。要从其他类更新 mainacivity 中的 Textview，请从主活动传递 texview 引用变量，如果 textview 不为空，则将空检查条件放在其他类中，然后更新值。

# google-apps-script - 如何在谷歌应用脚 本表中设置百分比格式

> ID：15041102
> 
> 赞同：2
> 
> 时间：2013-02-23T13:34:51.453
> 
> 标签：google-apps-script

作为 Google App 脚本仪表板的一部分，我有下表：

```
var tableChart = Charts.newTableChart()
.setDataViewDefinition(Charts.newDataViewDefinition().setColumns([1,10,15]))
.build(); 
```

第 10 列标记为“总百分比”，在我的谷歌电子表格中，格式为“0.00%”。但是 tableChart 不考虑格式并将值显示为“0.0000”

如何将 tableChart 中特定列的格式设置为“0.00%”？

问候詹恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T18:00:21.433

已将功能请求添加到问题跟踪器[Issue 3063](http://code.google.com/p/google-apps-script-issues/issues/detail?id=3063)中。访问并加注星标以接收更新。

# python - 获取python中特定目录中视频的总长度

> ID：15041103
> 
> 赞同：5
> 
> 时间：2013-02-23T13:35:14.123
> 
> 标签：python, windows, video

我从 coursera.org 下载了一堆视频，并将它们存储在一个特定的文件夹中。特定文件夹中有许多单独的视频（Coursera 将一个讲座分成多个短视频）。我想要一个 python 脚本，它给出特定目录中所有视频的总长度。视频文件为 .mp4 格式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-15T07:05:49.370

首先，安装[`ffprobe`](https://ffmpeg.org/ffprobe.html)命令（它是[FFmpeg](https://www.ffmpeg.org/)的一部分）

```
sudo apt install ffmpeg 
```

然后使用[`subprocess.run()`](https://docs.python.org/library/subprocess.html)运行这个 bash 命令：

```
ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 -- <filename> 
```

（我从[http://trac.ffmpeg.org/wiki/FFprobeTips#Formatcontainerduration](http://trac.ffmpeg.org/wiki/FFprobeTips#Formatcontainerduration)得到），像这样：

```
from pathlib import Path
import subprocess

def video_length_seconds(filename):
    result = subprocess.run(
        [
            "ffprobe",
            "-v",
            "error",
            "-show_entries",
            "format=duration",
            "-of",
            "default=noprint_wrappers=1:nokey=1",
            "--",
            filename,
        ],
        capture_output=True,
        text=True,
    )
    try:
        return float(result.stdout)
    except ValueError:
        raise ValueError(result.stderr.rstrip("\n"))

# a single video
video_length_seconds('your_video.webm')

# all mp4 files in the current directory (seconds)
print(sum(video_length_seconds(f) for f in Path(".").glob("*.mp4")))

# all mp4 files in the current directory and all its subdirectories
# `rglob` instead of `glob`
print(sum(video_length_seconds(f) for f in Path(".").rglob("*.mp4")))

# all files in the current directory
print(sum(video_length_seconds(f) for f in Path(".").iterdir() if f.is_file())) 
```

此代码需要**Python 3.7+**`text=`，因为那`capture_output=`是添加到`subprocess.run`. 如果您使用的是较旧的 Python 版本，请检查此答案的[编辑历史记录。](https://stackoverflow.com/posts/25842494/revisions)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T17:38:31.697

1.  下载[MediaInfo](http://mediainfo.sourceforge.net)并安装（不要安装捆绑的广告软件）
2.  转到[MediaInfo 源下载](http://mediainfo.sourceforge.net/en/Download/Source)并在“源代码，全部包含”行中，选择“libmediainfo”旁边的链接
3.  `MediaInfoDLL3.py`在下载的存档中查找并将其解压缩到任何地方。示例位置：`libmediainfo_0.7.62_AllInclusive.7z\MediaInfoLib\Source\MediaInfoDLL\MediaInfoDLL3.py`
4.  现在在同一目录中制作一个用于测试的脚本（以下来源）。
5.  执行脚本。

MediaInfo 也适用于 POSIX。唯一的区别是`so`加载的是 an 而不是 DLL。

## 测试脚本（Python 3！）

```
import os

os.chdir(os.environ["PROGRAMFILES"] + "\\mediainfo")
from MediaInfoDLL3 import MediaInfo, Stream

MI = MediaInfo()

def get_lengths_in_milliseconds_of_directory(prefix):
  for f in os.listdir(prefix):
    MI.Open(prefix + f)
    duration_string = MI.Get(Stream.Video, 0, "Duration")

    try:
      duration = int(duration_string)
      yield duration
      print("{} is {} milliseconds long".format(f, duration))
    except ValueError:
      print("{} ain't no media file!".format(f))

    MI.Close()

print(sum(get_lengths_in_milliseconds_of_directory(os.environ["windir"] + "\\Performance\\WinSAT\\"
)), "milliseconds of content in total") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-07T22:40:56.633

除了上面Janus Troelsen的回答，我想指出我在实施他的回答时遇到的一个小问题。我一一按照他的指示，但在 windows (7) 和 linux (ubuntu) 上得到了不同的结果。他的指令在 linux 下运行良好，但我必须做一个小技巧才能让它在 Windows 上运行。我在 Windows 上使用 32 位 python 2.7.2 解释器，所以我使用了 MediaInfoDLL.py。但这还不足以让它为我工作，我在这个过程中收到了这个错误：

“WindowsError：[错误 193] %1 不是有效的 Win32 应用程序”。

这意味着我以某种方式使用了不是 32 位的资源，它必须是正在加载的 DLL MediaInfoDLL.py。如果查看 MediaInfo 安装目录，您将看到 3 个 dll MediaInfo.dll 是 64 位的，而 MediaInfo_i386.dll 是 32 位的。由于我的 python 设置，MediaInfo_i386.dll 是我必须使用的。我去了 MediaInfoDLL.py（我已经包含在我的项目中）并更改了这一行：

```
MediaInfoDLL_Handler = windll.MediaInfo 
```

至

```
MediaInfoDLL_Handler = WinDLL("C:\Program Files (x86)\MediaInfo\MediaInfo_i386.dll") 
```

我不需要改变任何东西就可以在 linux 中工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-01-06T21:52:56.457

如今[pymediainfo](https://pymediainfo.readthedocs.io/en/stable/)可用，因此可以简化 Janus Troelsen 的答案。
您需要安装[MediaInfo](https://mediaarea.net/en/MediaInfo)和`pip install pymediainfo`. 然后以下代码将打印所有视频文件的总长度：

```
import os
from pymediainfo import MediaInfo

def get_track_len(file_path):
    media_info = MediaInfo.parse(file_path)
    for track in media_info.tracks:
        if track.track_type == "Video":
            return int(track.duration)
    return 0

print(sum(get_track_len(f) for f in os.listdir('directory with video files'))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T13:59:29.460

此链接显示如何获取视频文件的长度[https://stackoverflow.com/a/3844467/735204](https://stackoverflow.com/a/3844467/735204)

```
import subprocess

def getLength(filename):
  result = subprocess.Popen(["ffprobe", filename],
    stdout = subprocess.PIPE, stderr = subprocess.STDOUT)
  return [x for x in result.stdout.readlines() if "Duration" in x] 
```

如果您正在使用该功能，则可以使用类似的东西将其包装起来

```
import os

for f in os.listdir('.'):
    print "%s: %s" % (f, getLength(f)) 
```

# javascript - 将 Javascript var 传递给 django 模板过滤器

> ID：15041104
> 
> 赞同：-1
> 
> 时间：2013-02-23T13:35:18.487
> 
> 标签：javascript, jquery, django, django-templates

我正在尝试将 Javascript 变量传递给 django-filter，但无法使其工作。和值已设置 - 我已经使用简单的Javascript 命令对其`height`进行了测试。`width``alert(height);`

这是代码：

```
<script>
  var height = $(window).height() / 4;
  var width = $(window).width();
  document.write('<img src="{{ obj.customer.headline_image|thumbnail:'+ height +'x'+ width +' }}">');
</script> 
```

有人知道如何传递这些变量，或者知道如何在运行时生成正确的缩略图吗？:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T13:53:58.060

由于 Django 在服务器上运行，而 Javascript 在客户端上运行，这并不那么简单。如果您必须使用 Django 过滤器，那么最好使用`ajax`尺寸并将其作为 HTTP 变量发送到 Django 脚本，然后它可以响应图像的源。

# java - api 级别 8 HttpURLConnection

> ID：15041109
> 
> 赞同：0
> 
> 时间：2013-02-23T13:35:49.503
> 
> 标签：java, android

这是我的第一篇文章 - 所以我希望在代码格式方面做的一切都是正确的。

也许您可以帮助我解决以下问题：

使用 API 级别 10 及更高版本，我所有的 HttpURLConnections 都可以正常工作，但是使用 API 级别 8 时，我尝试下载文件（txt、html……）的内容的一些（或有时大部分）失败。

只要服务器返回响应代码“-1”，我就通过重复下载来解决这个问题。这不是很令人满意，但它有效（或多或少）——但我想它只是因为我收到的内容很短（最多 100 个字符）——有时我认为最后省略了一些字符，也。

但是现在我尝试实现一个更新例程（下载并安装一个 apk 文件），但大多数情况下都失败了，因为 apk 文件是碎片化的（我猜），所以在尝试安装文件时出现“解析错误” .

我究竟做错了什么？

感谢您的任何帮助（如果您比我好，请保持友好*）*！

这是我的更新例程的代码（如您所见，它没有如上所述的重复机制）：

```
 String download_url  = "http://url/";
    String download_file = "name.apk";

    //Local
    String update_file = download_file;
    File update_file_stream = context.getFileStreamPath(update_file);

    //Connect
    URL url = new URL(download_url + download_file);
    HttpURLConnection c = (HttpURLConnection) url.openConnection();
    c.setRequestMethod("GET");
    c.setDoOutput(true);
    c.connect();

    //Delete local File?
    if(update_file_stream.exists()){

        update_file_stream.delete();
    }

    //Download File
    FileOutputStream fos = context.openFileOutput(update_file, Context.MODE_WORLD_READABLE);
    InputStream is = c.getInputStream();
    byte[] buffer = new byte[4096];
    int len1 = 0;
    while ((len1 = is.read(buffer)) != -1) {
        fos.write(buffer, 0, len1);
    }
    fos.close();
    is.close();

    //Install
    Intent intent = new Intent(Intent.ACTION_VIEW);
    intent.setDataAndType(Uri.fromFile(update_file_stream), "application/vnd.android.package-archive");
    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    context.startActivity(intent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T11:18:21.353

看起来像主线程问题上的网络。

在以前的 android sdk 版本（可能是 8）中，您可以在主线程上做一些网络

但是在 ICS 或 Honeycomb 之后，你不能在主线程上做任何网络工作。

# php - 如果禁用 javascript，jquery ajax 表单提交将如何工作

> ID：15041110
> 
> 赞同：4
> 
> 时间：2013-02-23T13:35:54.430
> 
> 标签：php, jquery, ajax, codeigniter, form-submit

我正在尝试在不加载另一个 php 页面的情况下提交表单。我正在使用代码点火器。但是大部分教程在表单标签中都没有动作。

如果在浏览器中禁用了 javascript，这将如何工作。有解决办法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T13:45:07.110

它不会工作.. 虽然 Ajax 不会发生任何事情.. 但表单将提交给它的操作。

虽然这不是一个可以想象的好场景，但如果您希望使用您的网站的用户没有启用 javascript .. 那么请阅读有关渐进增强的更多信息 ..

简而言之，渐进增强意味着（在您的情况下）：构建一个无需 javascript 即可运行的网站……但如果启用了 javascript，则使用它……

在您的表单示例中，我建议您对表单执行操作...并使用 jquery`preventDefault()`禁用表单默认操作并通过 ajax 执行您想要的操作。

通过这样做，如果用户没有启用 javascript，那么表单将提交到请求的 url，并且仍然可以双向工作..

但无论如何，恕我直言......假设您使用启用了javascript..除非您过于依赖javascript

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:42:53.783

你可以有一个后备。您可以做的是检查客户端的 javascript 是否已启用，如果已启用，则使用 ajax 其他明智的使用 Php。或者您可以简单地向用户显示错误消息以启用 javascript。

# java - 用双反斜杠替换反斜杠

> ID：15041111
> 
> 赞同：11
> 
> 时间：2013-02-23T13:36:05.077
> 
> 标签：java, string

我想将字符串中的反斜杠更改为双反斜杠。

我有

```
String path = "C:\Program Files\Text.txt"; 
```

我想把它改成

```
"C:\\Program Files\\Text.txt" 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-23T13:37:53.700

`replaceAll`正在使用正则表达式，并且由于您不需要在这里使用正则表达式，只需使用

```
path = path.replace("\\", "\\\\"); 
```

`\`在字符串文字中是特殊的。例如，它可以用于

*   创建特殊字符，如制表符`\t`、行分隔符`\n` `\r`、
*   或使用符号`\uXXXX`（其中`X`是十六进制值并`XXXX`表示字符在 Unicode 表中的位置）来编写字符。

要转义它（并创建`\`角色），我们需要`\`在它之前添加另一个。
所以表示`\`字符的字符串文字看起来像`"\\"`. 代表两个`\`字符的字符串看起来像`"\\\\"`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-23T13:38:42.073

使用[**字符串#replace()**](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29)

```
String s= "C:\\Program Files\\Text.text";
System.out.println(s.replace("\\", "\\\\")); 
```

# coffeescript - Angular 应用程序无法加载（JSFiddle）

> ID：15041116
> 
> 赞同：1
> 
> 时间：2013-02-23T13:36:18.147
> 
> 标签：coffeescript, angularjs

我在这里有一个简单的角度应用程序

```
<div ng-app="WhereToMeet" ng-controller="MapCtrl">
  <leaflet shape="shape"></leaflet>
  <button ng-click="clicked()">Clicked</button>
</div>

app = angular.module("WhereToMeet", [])

app.directive "leaflet",  ->
  restrict: "E"
  replace: true
  transclude: true
  template: "<div id=\"map\"></div>"
  scope:
    shape: "=shape"
  link: (scope, element, attrs, ctrl) ->
    scope.$watch attrs.shape,( (newValue, oldValue) ->
      watched newValue
    ), true

  watched = (newValue) ->
    alert newValue

@MapCtrl = ($scope)  ->
  clicked = (clicked) ->
    $scope.shape = "Clicked"
    alert "clicked" 
```

我在 JSFiddle [http://jsfiddle.net/charliedavi/bezFB/22/](http://jsfiddle.net/charliedavi/bezFB/22/)中有它，但它不会运行。真的很奇怪。我认为我的咖啡脚本有错误，但我看不到

错误：

```
Uncaught SyntaxError: Unexpected string fiddle.jshell.net:22
Uncaught Error: No module: WhereToMeet 
```

在纯 JS

```
var app;

app = angular.module("WhereToMeet", []);

app.directive("leaflet", function() {

      var watched;
      ({
        restrict: "E",
        replace: true,
        transclude: true,
        template: "<div id=\"map\"></div>",
        scope: {
          shape: "=shape"
        },
        link: function(scope, element, attrs, ctrl) {
          return scope.$watch(attrs.shape, (function(newValue, oldValue) {
            return watched(newValue);
          }), true);
        }
      });
      return watched = function(newValue) {
        return alert(newValue);
      };
    });

    this.MapCtrl = function($scope) {
      var clicked;
      return clicked = function(clicked) {
        $scope.shape = "Clicked";
        return alert("clicked");
      };
    }; 
```

[http://jsfiddle.net/charliedavi/gsPx3/2/](http://jsfiddle.net/charliedavi/gsPx3/2/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T16:29:14.757

我不知道咖啡脚本，但有角度。我只是试图解决它。;-)

*   选择无包裹体，在选择框架下
*   选择无库（纯js）
*   添加 Angular js 作为资源
*   使用此角度引导程序手动初始化角度

    `angular.bootstrap document, ['WhereToMeet']`

*   生成的 javascript 代码在另一个范围内。您必须通过将`-b`参数添加到咖啡脚本编译器或通过显式导出函数来解决此问题

    ```
    root = exports ? this
    root.clicked = ->
          alert "clicked"
          $scope.shape = "Clicked" 
    ```

    它现在正在工作[Fiddle Here](http://jsfiddle.net/prashusuri/bezFB/33/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:50:58.537

昨天我对 jsfiddle 和 angular 有类似的问题。我必须做几件事才能使它工作：

*   Jsfiddle 正在为 html 和 body 添加标签，所以只需编写应该在 body 标签内结束的标记。
*   添加一个带有 ng-app="myApp" 的包装 div，而不是尝试指定另一个 html-tag
*   选择无包裹体，在选择框架下

我不知道你的“传单”在做什么，但我已经更新了你的小提琴，这样点击就会触发警报

我必须更改控制器的实例化方式才能使 onclick 正常工作。

[http://jsfiddle.net/t9nsY/2/](http://jsfiddle.net/t9nsY/2/)

```
app.controller("MapCtrl", function ($scope) {
    $scope.clicked = function (clicked) {
        console.log("clicked");
        $scope.shape = "Clicked";
        return alert("clicked");
    };
}); 
```

# visual-c++ - 在新视频卡上的 nvoglv32.dll 中绘制调用崩溃

> ID：15041120
> 
> 赞同：3
> 
> 时间：2013-02-23T13:36:42.030
> 
> 标签：visual-c++, opengl, crash, deferred-rendering

几天前，由于某些硬件更改，我设置了计算机并安装了 Windows 8 的新副本。其中，我将显卡从 Radeon HD 7870 更改为 Nvidia GTX 660。

再次设置 Visual Studio 11 后，我从 Github 下载了我的最后一个 OpenGL 项目并重建了整个项目。我从 Visual Studio 中运行了应用程序，但由于`nvoglv32.dll`.

> Application.exe 中 0x5D9F74E3 (nvoglv32.dll) 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000000。

在旧环境中，应用程序按预期工作。我没有更改项目或源代码的任何内容。唯一的区别是 Visual Studio 安装的语言，现在是英语，以前是德语。因此我创建了一个新项目并采用了所有设置，但错误仍然存​​在。

为了定位崩溃，我注意到所有初始化（窗口，着色器，...）都成功了，错误出现在绘制调用`glDrawElements()`上，它引用了我的延迟渲染器的几何传递。

经过一番研究，我发现它`nvoglv32.dll`来自 Nvidia，是关于一个名为`Compatible OpenGL ICD`. 这是否意味着我的应用程序以兼容模式运行？这听起来像是一种支持旧应用程序的模式，我希望我的应用程序以常规模式运行！顺便说一句，我为我的显卡安装了最新的稳定驱动程序。

老实说，我不知道如何解决这个崩溃问题。什么可能导致它以及如何解决它？

更新：我[在 Geforce 论坛上](https://forums.geforce.com/default/topic/481890/?comment=3456330)找到了一篇关于我的问题的帖子。虽然没有回复，但作者可以通过更改两个 OpenGL 调用的顺序来解决问题。

> 大家好，
> 
> 在浏览了我的应用程序源代码几个小时后，我发现调用这些函数......
> 
> ```
> glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, #)
> glBindVertexArray(#) 
> ```
> 
> ...按此顺序会导致 nvoglv64.dll 崩溃。将这些调用的顺序颠倒到...
> 
> ```
> glBindVertexArray(#)
> glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, #) 
> ```
> 
> ...防止崩溃并且表现良好。
> 
> 干杯，罗伯特格拉夫

由于我不使用顶点数组，因此无法简单地进行此修复，但可能存在类似问题。我会报告我的进展。

更新：我完全不知道如何解决我的问题。我尝试了不同的视频驱动程序版本，但没有区别。我使用最少的着色器和简单的前向渲染完全重写了渲染器。但是崩溃发生在第一次绘制调用时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:00:52.210

> 为了定位崩溃，我注意到所有初始化（窗口、着色器……）都成功了，错误出现在绘制调用 glDrawElements() 处。

很可能您的代码一直存在越界访问，但 AMD Radeon Catalyst 驱动程序确实保留了更多地址空间，或者提前捕获了它们。现在您的 NVidia GeForce 驱动程序没有。

您传递的 glDrawElements 数量太大而`count`无法绘制元素，或者您的索引缓冲区包含索引超出顶点数组范围的值。如果是后者，那么您可能正在使用客户端顶点数组，因为 VBO 通常会捕获越界访问；那些也不会使您的客户端程序崩溃，而只会渲染垃圾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T14:21:49.053

最后我想出了一个解决方案来修复崩溃。

我用来创建窗口等的 SFML 框架提供了一个函数来重置上下文的 OpenGL 状态。我在创建窗口后立即调用它。

即使我无法解释原因，删除该函数调用也解决了崩溃问题。也许是因为 GLEW 或其他东西在那一刻还没有初始化。

```
sf::RenderWindow window;
window.create(VideoMode(1024, 768), "Window Title");
window.resetGLStates(); // removing this line fixed the crash
window.setVerticalSyncEnabled(true); 
```

# c# - 删除 Windows Phone 中的枢轴项目

> ID：15041125
> 
> 赞同：1
> 
> 时间：2013-02-23T13:37:34.447
> 
> 标签：c#, windows, windows-phone-7, pivot

我有大约 30 张图像，我想将它们作为枢轴控件中的项目保留。但如果我做了所有这些，我会遇到 OutOfMemoryException。所以我正在动态添加枢轴。现在，如果我超过某个限制，我想删除枢轴项目，但如果我在枢轴选择更改时删除，我会收到 InvalidException。在片段中，pivotshow 是枢轴控件。

```
 void PivotShow_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        AddItems();
    }

    private void AddItems()
    {
        PivotItem toadd = PivotGen(images[i]);
        i = (i + 1) % (images.Length);
        PivotShow.Items.Add(toadd);
        try
        {
            if (PivotShow.Items.Count > 3)
                PivotShow.Items.RemoveAt(0);
        }
        catch (InvalidOperationException)
        {
            MessageBox.Show("Operation not allowed");
        }
    }

    private PivotItem PivotGen(string urlimage)
    {
        PivotItem p = new PivotItem();
        p.Margin = new Thickness(0, -90, 0, 0);

        Image img = new Image();
        BitmapImage bmp = new BitmapImage(new Uri(urlimage, UriKind.Relative));
        img.Stretch = Stretch.Fill;
        img.Source = bmp;
        p.Content = img;

        return p;
        //PivotShow.Items.Add(p);
    } 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T08:17:04.260

这很可能是因为您试图更改当前正在修改的集合。您可以按如下方式推迟您的代码：

```
 EventHandler handler = null;
        handler = (s, e) =>
        {
            element.LayoutUpdated -= handler;

            AddItems();
        };
        element.LayoutUpdated += handler; 
```

`AddItems`上面的代码将在下一个布局过程中调用。试试这个，看看它是否有帮助！

# c++ - 如何减少 C++ map/unordered_map 容器中查找的分配？

> ID：15041126
> 
> 赞同：3
> 
> 时间：2013-02-23T13:37:35.317
> 
> 标签：c++, boost, unordered-map

假设我`std::unordered_map<std::string, Foo>`在我的代码中使用。这很好也很方便，但不幸的是，每次我想`find()`在这张地图中进行查找（）时，我都必须想出一个`std::string`.

例如，假设我正在对其他字符串进行标记，并希望调用`find()`每个标记。`std::string`这迫使我在查找之前围绕每个令牌构建一个，这需要一个分配器 ( `std::allocator`，相当于一个 CRT `malloc()`)。这很容易比实际查找本身慢。它还与其他线程竞争，因为堆管理需要某种形式的同步。

几年前，我发现了*Boost.intrusive*库；那时它只是一个测试版。有趣的是它有一个名为的容器`boost::intrusive::iunordered_set`，它允许代码使用任何用户提供的类型执行查找。

我将解释我希望它如何工作：

```
struct immutable_string
{
    const char *pf, *pl;
    struct equals
    {
        bool operator()(const string& left, immutable_string& right) const
        {
            if (left.length() != right.pl - right.pf)
                return false;

            return std::equals(right.pf, right.pl, left.begin());
        }
    };

    struct hasher
    {
        size_t operator()(const immutable_string& s) const
        {
            return boost::hash_range(s.pf, s.pl);
        }
    };

};

struct string_hasher
{
    size_t operator()(const std::string& s) const
    {
        return boost::hash_range(s.begin(), s.end());
    }
};

std::unordered_map<std::string, Foo, string_hasher> m;
m["abc"] = Foo(123); 

immutable_string token; // token refers to a substring inside some other string

auto it = m.find(token, immutable_string::equals(), immutable_string::hasher()); 
```

另一件事是加快“如果没有找到就查找并插入”用例——这个技巧`lower_bound()`只适用于有序容器。侵入式容器具有称为`insert_check()`and的方法`insert_commit()`，但我猜这是一个单独的主题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:51:14.700

说到词法分析，我个人使用两个简单的技巧：

1.  我使用`StringRef`（类似于 LLVM），它只包装 a`char const*`和 a`size_t`并提供类似字符串的操作（显然只有 const 操作）
2.  我使用凹凸分配器汇集遇到的字符串（使用 4K 块）

两者结合起来非常有效，但需要了解`StringRef`的是，一旦池被破坏，所有进入池的点显然都会失效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-11T11:02:00.907

结果`boost::unordered_map`（从 1.42 开始）有一个`find`重载，它需要`CompatibleKey`, `CompatibleHash`,`CompatiblePredicate`类型，所以它可以完全按照我在这里的要求。

# meteor - 流星 0.5.7：如何处理/使用 Meteor.Collection.ObjectID？

> ID：15041128
> 
> 赞同：5
> 
> 时间：2013-02-23T13:37:55.840
> 
> 标签：meteor, objectid

我昨天更新了我的流星并尝试使用新的`Meteor.Collection.ObjectID`. 但自从没有成功。首先，我以这种方式更新了我的收藏：

`myCollection = new Meteor.Collection('mycollection', {idGeneration: 'MONGO'}` 现在，普通的新插入有一个`_id`喜欢`Wi2RmR6CSapkmmdfn`...（？）

然后我有一个包含数组的集合。我喜欢这个数组中的每个对象都有一个唯一的 id。所以我`$push`有一个像`id: new Meteor.Collection.ObjectID()`我的数组一样的字段的对象。数据库中的结果是这样的：`ObjectId("5b5fc278305d406cc6c33756")`. （这似乎很正常。）

但是稍后我想更新我的推送对象，如果`id`等于一个 id，我之前将其作为数据属性存储在 html 标记中。

`var equals = EJSON.equals(dbId, htmlId);`（这每次都会导致`false`。所以我将值记录`dbId`到`htmlId`控制台中`console.log(typeof dbId, dbId);`）

这两个变量的值如下：

`object { _str: 'a86ce44f9a46b99bca1be7a9' }`(dbId)

`string ObjectID("a86ce44f9a46b99bca1be7a9")`（htmlId；这似乎是正确的，但为什么自定义类型是字符串？）

**如何`Meteor.Collection.ObjectID`正确使用？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T16:56:43.607

将您的 html 放入您`htmlId`的 html 时，您需要将其作为字符串而不是对象放入，记住`_id`现在是一个对象，车把正在猜测并使用`toString()`& 这就是为什么它显示为`ObjectID("...")`.

因此，如果您`{{_id}}`在 html 中使用，您现在需要使用`{{_id.toHexString}}`它来正确提取其中的字符串部分

当您使用 javascript 提取此 html 值时，您需要将其重新转换为 objectid：

js：

```
var valuefromhtml = "a86ce44f9a46b99bca1be7a9"; //Get with Jquery,DOM,etc

htmlId = new Meteor.Collection.ObjectID(valuefromhtml); //see: http://docs.meteor.com/#collection_object_id

EJSON.equals(htmlId, dbId); //Should be true this time 
```

# css - BackOffice 模块配置 CSS

> ID：15041131
> 
> 赞同：0
> 
> 时间：2013-02-23T13:38:21.860
> 
> 标签：css, module, prestashop

我想在 BackOffice 模块配置页面中使用自己的 css 样式，但我无法解决这个问题，我想使用此代码插入 CSS。

```
$this->context->controller->addCSS(($this->_path).'/css/styles.css', 'all'); 
```

谢谢你的帮助，对不起我的英语:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-18T14:34:48.257

要首先在后台添加 css 或 js，您应该在 install() 函数中安装 backOfficeHeader 和 displayBackOfficeHeader：

```
 public function install() {
          return parent::install() && 
         $this->registerHook('backOfficeHeader')
            && $this->registerHook('displayBackOfficeHeader')
    ;
} 
```

然后你可以使用它们来添加 css ：

```
 public function hookBackOfficeHeader($params) {       
      $this->context->controller->addCSS($this->_path.'mycss.css');
  }

 public function hookDisplayBackOfficeHeader($params){
      $this->hookBackOfficeHeader($params);    
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T12:37:33.140

您可以使用这种方式，但语法是：

```
$this->context->controller->addCSS($this->getPathUri().'views/css/styles.css', 'all'); 
```

您的 css 文件在 $WEBSITE/modules/yourmodule/views/css/styles.css 中

# eclipse - FindBugs 仅显示第一次出现的错误

> ID：15041132
> 
> 赞同：1
> 
> 时间：2013-02-23T13:38:26.790
> 
> 标签：eclipse, static-analysis, findbugs

FindBugs 似乎只显示每种方法中特定错误的第一次出现。这发生在 Eclipse 以及 FindBugs 独立客户端中。
如何配置 FindBugs 以显示*所有*事件？

例子：

```
import javax.annotation.Nonnull;

public class Bar
{
    public void meth(@Nonnull final String pArg) {
        System.out.println(pArg);
    }

    public void foo() {
        String s = null;
        meth(s);      // <<== bug marker here (NP_NONNULL_PARAM_VIOLATION)
        meth(null);   // no bug marker here
        meth(s);      // and none here either  :-(
    }
} 
```

我正在使用最新的 FindBugs 2.0.2 Eclipse 插件（带有 Eclipse 3.6）。

该问题似乎取决于错误模式。例如，我看到每个方法不止一次命中`DLS_DEAD_LOCAL_STORE`，但没有`NP_NONNULL_PARAM_VIOLATION`。后者如上图所示。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T05:43:53.953

Findbugs 似乎只检查这些代码行是否存在此特定错误，根据控制流分析实际上可以达到这些错误。使用您的 3 个方法调用，第一个会导致 NPE，因此永远不会达到第二个和第三个。

以前的版本也有类似的错误报告：http: [//sourceforge.net/p/findbugs/bugs/980/](http://sourceforge.net/p/findbugs/bugs/980/)

# android - YYYYMMDDTHHMMSS 中的 T 是什么？

> ID：15041136
> 
> 赞同：5
> 
> 时间：2013-02-23T13:38:40.613
> 
> 标签：android, time

Android [Time#toString()](http://developer.android.com/reference/android/text/format/Time.html#toString%28%29)返回 YYYYMMDDTHHMMSS，这里的“T”代表什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-23T13:39:47.267

它代表字母`T`，代表日期和...时间之间的分隔符。

用于生成符合[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)的日期/时间字符串。

# ios - iOS，同时对两个具有不同计数的数组进行排序

> ID：15041143
> 
> 赞同：0
> 
> 时间：2013-02-23T13:39:37.757
> 
> 标签：ios, xcode, cocoa-touch, nsarray, enumeration

如果 arrayTwo 的计数不等于或大于 arrayOne，则在另一个数组枚举 (arrayOne) 中测试数组的内容 (arrayTwo) 时出现 NSRangeException 错误。最有效的方法是什么？基本上我想从arrayTwo中获取对象（如果存在），否则如果那里没有对象，则忽略该操作。

```
int i = 0;
for (Class *arrayOneObject in arrayOne) {
    if (arrayTwo[i]!= NULL) {
        NSLog(@"array two object found");
    }
    i++;
} 
```

编辑：根据 Hot Lick 的建议，我做了以下工作，效果很好。

```
int i = 0;
for (Class *arrayOneObject in arrayOne) {
    if (arrayTwo.count > i) {
        NSLog(@"array two object found");
    }
    i++;
} 
```

# perl - 为什么不能从 Perl 中的信号处理程序中终止循环？

> ID：15041150
> 
> 赞同：1
> 
> 时间：2013-02-23T13:40:19.590
> 
> 标签：perl, loops, signals

有人可以解释为什么下一个脚本不起作用吗？错误的原因是什么`Label not found for "last SOME_BLOCK"`？

```
#!/usr/bin/perl
use v5.14;
SOME_BLOCK: {
    alarm 1;
    $SIG{ALRM} = sub {
        last SOME_BLOCK;
    };
    my $count = 0;
    while (1) {
        $count += 1;
        say $count;
    }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T13:45:35.020

根据[perldoc](http://perldoc.perl.org/functions/last.html)`last`禁止通过or退出子例程（通常会触发警告）。这是因为它非常混乱 - Perl 需要动态搜索范围以找到您要跳过的块，并从各种函数调用 return（但应该使用什么返回值？）。一般比较安全。`next``return`

在信号处理上下文中，它更加混乱，因为 Perl 实际上必须暂停脚本的执行才能执行信号处理程序。所以它现在运行两个独立的执行上下文，信号处理程序上下文不能直接影响主上下文的控制流，这就是你得到那个错误的原因。

你可以做两件事：

*   抛出异常（使用`die`）并在外部块中捕获它。这是不可取的，因为它几乎可以中断任何事情。
*   设置一个在信号处理程序外部定义的全局标志，例如 ( `$caught_signal = 1`) 并在内部代码中方便的时候检查它。

# magento - Magento - 如何更改左侧边栏的大小？

> ID：15041161
> 
> 赞同：0
> 
> 时间：2013-02-23T13:42:15.643
> 
> 标签：magento, size, sidebar

我在尝试弄清楚如何减小左侧边栏的大小并增加主边栏的大小时遇到​​了一些麻烦。我只希望这发生在主页上。

我的页面在这里，所以你可以看看[http://www.theshirt.org](http://www.theshirt.org)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:12:50.090

完整的动作名称——系统中每个路由的唯一标识符——作为类名添加到`<body>`标签中。基于此和您正在使用的模板，以下内容将使左列变窄 33px，主列变宽 33px：

```
.cms-index-index .col-left {
    width: 200px;
}

.cms-index-index .col-main {
    width: 761px;
} 
```

# php - 使用 php 中的 javascript 脚本连接

> ID：15041165
> 
> 赞同：0
> 
> 时间：2013-02-23T13:42:47.683
> 
> 标签：php, javascript, concatenation

我想将一个 php 数组连接到 javascript 数组中。并使用所有这些来创建 jquery 函数。帮我...

循环中的指令是 => descriptif[i] = .$description[i].;

```
 <?php echo '<script> var descriptif = new Array (); 
                for(i=0 ; i<16 ; i++)
                {
                    descriptif[i] = "'.$description["'"+ i +"'"].'";
                }   
                </script>';
    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T13:49:09.313

我猜你在想：

```
<script> var descriptif = new Array (); 
<?php for(i=0 ; i<16 ; i++) {
    echo "descriptif[$i] = '$description[$i]';"
} ?>
</script> 
```

它将打印：

```
<script> var descriptif = new Array (); 
    descriptif[0] = value1;
    descriptif[1] = value2;
    descriptif[2] = value3;
    ...
</script> 
```

PS如果你想用脚本语言（php、jsp）动态化一些东西（javascript、css等），只在不同的部分（循环部分）使用、<%%>。其余部分是相同的，因此不必重复 - 它使您的代码不太清晰。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:50:27.597

您无法使用客户端 Javascript 访问 PHP 数组。

*   PHP 是一种***服务器****端语言*。一切都发生在服务器上。
*   Javascript 是一种***客户端****语言*。一切都发生在浏览器中。

# mysql - 连接必须有效且打开

> ID：15041168
> 
> 赞同：-1
> 
> 时间：2013-02-23T13:43:19.977
> 
> 标签：mysql, connection

连接必须有效且打开。哪里有问题 ？.net Frmework 2.0 版连接必须有效且打开。哪里有问题 ？.net Frmework 2.0 版连接必须有效且打开。哪里有问题 ？.net 框架 2.0 版

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Security.Cryptography;
using MySql.Data.MySqlClient;
    namespace Student_Portal_Password
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        public static string GetMd5Hash(string input)
        {
            MD5 md5Hash = MD5.Create();
            // Convert the input string to a byte array and compute the hash.
            byte[] data = md5Hash.ComputeHash(Encoding.UTF8.GetBytes(input));

            // Create a new Stringbuilder to collect the bytes
            // and create a string.
            StringBuilder sBuilder = new StringBuilder();

            // Loop through each byte of the hashed data 
            // and format each one as a hexadecimal string.
            for (int i = 0; i < data.Length; i++)
            {
                sBuilder.Append(data[i].ToString("x2"));
            }

            // Return the hexadecimal string.
            return sBuilder.ToString();
        }
        public  void check()
        {
            if (txtid.Text == "")
            {
                MessageBox.Show("Please enter Student ID ", MessageBoxIcon.Warning.ToString(), MessageBoxButtons.OK);
            }
            else if (txtpassword.Text == "")
            {
                MessageBox.Show("Please enter new password", MessageBoxIcon.Warning.ToString(), MessageBoxButtons.OK);
            }
        }
        private void button1_Click(object sender, EventArgs e)
        {
            try
            {

 //check();
            txtpassword.Text.Trim();
            string hash = GetMd5Hash(txtpassword.Text);

            string db = "server=localhost;uid=root;password=usbw;database=dum;";
            MySqlConnection dbcon = new MySqlConnection(db);
            MySqlCommand cmd = new MySqlCommand(db);

            dbcon.Open();
            cmd.CommandText = "SELECT * FROM members;";
            cmd.ExecuteNonQuery();
                          MessageBox.Show("Success!");
                          dbcon.Close();
            }
            catch (MySqlException ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void txtid_KeyPress(object sender, KeyPressEventArgs e)
        {
            const char Delete = (char)8;
            e.Handled = !Char.IsDigit(e.KeyChar) && e.KeyChar != Delete;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:00:24.877

几件事；

您正在使用`ExecuteNonQuery`查询。尝试例如`ExecuteReader`。

您没有为 DbCommand 设置连接，因此执行它不会找到数据库。
试试这个；

```
MySqlConnection dbcon = new MySqlConnection(db);
string sql = "SELECT * FROM members";
MySqlCommand cmd = new MySqlCommand(sql, dbcon); //<-- pass connection to command 
```

您当前的代码；

```
MySqlCommand cmd = new MySqlCommand(db); 
```

...将连接字符串作为要执行的 SQL 传递，并且不将命令与任何数据库连接相关联。这将给出您要询问的错误。

# java - 如何通过程序代码将 EditTextBox 设置为编辑模式？

> ID：15041171
> 
> 赞同：0
> 
> 时间：2013-02-23T13:43:37.170
> 
> 标签：java, gwt

我正在使用`GWT`a `EditTextCell`，它在点击时进入编辑模式。有人知道通过程序代码强制框进入编辑模式的方法吗？

我必须以某种方式`ClickEvent`向那个盒子开火吗？或者如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:20:38.317

您可以将以下方法添加到您的 CellTable 或 DataGrid：

```
public void focus(final int row, final int column) {
    Scheduler.get().scheduleDeferred(new ScheduledCommand() {

        @Override
        public void execute() {
            getRowElement(row).getCells().getItem(column).getFirstChildElement().getFirstChildElement().focus();
        }
    });
} 
```

`.focus(row, column)`然后，当您需要将焦点设置在给定单元格上时，您可以简单地调用。

或者您可以`.getRowElement()...`直接调用，但我建议将其包装在 ScheduledCommand 中，这样它就不会过早触发 - 在单元格准备好接受焦点之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T18:14:58.907

事实证明，我可以在我的单元格上触发原生点击事件，如下所示：

```
NativeEvent nativeevent = Document.get().createClickEvent(1, 0, 0, 0, 0, false, false, false, false);
cell.getElement().dispatchEvent(nativeevent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T05:22:07.390

您还可以编写`render`事件或添加`clickHandler`用于设置`contentEditable=true`或`false`。

```
private class CustomEditCell extends EditTextCell {

        public void render(com.google.gwt.cell.client.Cell.Context context, String value, SafeHtmlBuilder sb) {

            sb.appendHtmlConstant("<div contentEditable='true' unselectable='true' >"+value+"</div>");  

         }
    } 
```

# php - 如何获取我用 PHP 提取的 MySQL 数据并在另一个页面中使用它而不创建数百万个页面

> ID：15041173
> 
> 赞同：2
> 
> 时间：2013-02-23T13:43:57.213
> 
> 标签：php, html, mysql, database

因此，我正在制作一个练习场，目前显示了数百个练习。我从 MySQL 数据库中提取数据没有问题。我的问题是能够在单独的页面上查看每个练习。目前，所有练习都使用此功能进行：

```
//Category 1 is biceps 
$cat = 1;
//$category is used for the case statement, to allow the form to submit and refresh         to the case statement that it is on, for each instance of the function. 
$category = 'biceps';
show_exercise($cat, $category); 
```

这是函数本身：

```
//Show exercises based on exercise category 
function show_exercise($cat, $category)
{
    $dbc = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
    $query = "SELECT * FROM exercises WHERE cat_id='$cat' ";
    $result = mysqli_query($dbc, $query);
    while($row = mysqli_fetch_array($result))
    {
        $output[] = '<div class="item"> 
        <h2>'. $row['name'] .'</h2> 
        <img src="'. $row['image'] .'" alt="'. $row['name'] .'" /> 
        <input class="button" type="submit" name="add" value="add" /> 
        <a href="index.php?p=view"><input class="button" type="submit" name="view" value="view"/></a> 
        </div>';
    }
    echo join('', $output);
} 
```

现在这只是将我所有不同的练习作为一个数组拉到一个页面上。我希望能够选择和查看每个单独的练习，但我不知道如何操作。一种方法是为每个练习创建一个页面，但我有数百个。上面代码中的按钮没有被使用，但想法是当有人单击“查看”按钮时，他们会被带到练习的单独页面，在那里他们可以阅读更多详细信息。数据库中上述代码中使用的所有数据都可以在各个练习页面上使用。

我的页面是用 switch 语句管理的，我想我会提到这一点，因为它可能会改变答案。这是我正在使用的 switch 语句：

```
// Validate what page to show: 

if(isset($_GET['p']))
{
    $p = $_GET['p'];
}
elseif(isset($_POST['p']))
{
// Forms 
    $p = $_POST['p'];
}
else 
{
    $p = NULL;
}
// Determine what page to display: 

switch ($p)
{
    case  'contact' : 
        $page = 'contact.php';
        $page_title = 'Contact Us';
    break;

    case  'exercises' : 
        $page = 'exercises.php';
        $page_title = 'Exercises';
    break;

    case  'routines' : 
        $page = 'routines.php';
        $page_title = 'Your Routines';
    break;

    case  'arms' : 
        $page = 'arms.php';
        $page_title = 'arms routine';
    break;
} 
```

此声明继续进行更多页面。我不知道我是否让这听起来比现在更难。如果有任何问题，我将准备发表评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:15:56.410

> 我希望能够选择和查看每个单独的练习，但我不知道如何操作。一种方法是为每个练习创建一个页面，但我有数百个。

“页面”是什么意思？

无论如何，您实际上不需要多个 PHP 脚本，因为它可以将查询字符串参数传递给自身。但是，如果将其分布在多个页面上，通常会更容易维护。看起来你已经在这样做了。好的。

例如，您可以添加一个名为“itemid”的参数，该参数仅在您访问“查看”页面时使用。

如果视图页面是在您的母脚本中包含的另一个脚本（我称之为“页面脚本”）中实现的，我建议您的所有“页面脚本”都实现相同的函数，即`generate_page($query_string)`调用来自母脚本的查询字符串。如果您使用 OOP，每个页面都可以是实现相同接口的类。但我试图提出一些类似于你已经在做的事情。

所以你的母页是这样的：

```
<?php
$pagename = $_GET["page"];
$allowed_pages = ["view", "contact"];
if (!in_array($pagename,$allowed_pages)) exit("Invalid page!");
require($page . ".php");
generate_page($_GET);
?> 
```

视图.php

```
<?php
function generate_page($arguments) {
   if (!isset($arguments["item"])) exit("Item needs to be specified!");
   // Do SQL query and view THIS item. (remember to guard against SQL injection!)
   // you can do this by using a different WHERE clause
}
?> 
```

现在视图可以显示它想要的。如果其他页面不想使用，`$arguments`则不必使用该参数。

您可以将链接更改为类似`<a href="index.php?p=view&item={$row['itemid']}">`.

# vb.net - 我应该在哪里存储值以实现快速廉价的访问性能

> ID：15041174
> 
> 赞同：0
> 
> 时间：2013-02-23T13:44:06.070
> 
> 标签：vb.net, sql-server-2008

我的网站是多语言的。来自美国、欧洲、澳大利亚和英国的企业可以创建企业列表并提供费用。现在，一家来自美国的企业将以美元为他提供费用，一家欧洲公司以欧元提供费用，一家英国公司以英镑提供费用。

例如：一家企业提供的费率为 3000 美元。

但是访问者从欧洲查看页面并希望看到以欧元为单位的价格，因此我需要将 3000 美元转换为欧元。我想要的是每周通过轮询这样的网络服务来存储汇率：[http://www.webservicex.net/WS/WSDetails.aspx?WSID=10&CATID=2](http://www.webservicex.net/WS/WSDetails.aspx?WSID=10&CATID=2)。并将其存储在某处（例如我的数据库），然后在呈现页面时即时进行转换。

现在由于数据库查询非常昂贵，我想知道存储这些汇率的最佳位置是什么？

在数据库中？文件系统？我也在考虑 web.config，但我确实想自动更新汇率而不是手动更新。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:46:57.617

这种价值 - 获得昂贵，但不经常改变（我专门谈论汇率）可以被缓存。

您的 Web 服务器很可能支持某种缓存机制 - 将它们添加到 Web 服务器缓存以进行查找。

在 IIS 中，使用 ASP.NET，您可以使用[`Cache`](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)类和[`Application`](http://msdn.microsoft.com/en-gb/library/94xkskdf%28v=vs.100%29.aspx)变量。`Cache`更可取，因为您可以将其设置为过期。

# android - 谷歌播放下载统计

> ID：15041176
> 
> 赞同：0
> 
> 时间：2013-02-23T13:44:42.180
> 
> 标签：android, google-play

当您在浏览器中浏览 Google Play 时，您会在页面右侧看到带有图表的安装统计信息。安装是什么意思？它是该应用程序的终身总安装吗？或者是安装该应用程序的最后 30 天？

此外，Google Play 还对热门免费、热门付费、热门收入、热门新付费和热门新免费进行了分类。它基于什么持续时间？到上周顶部？还是过去 30 天最高？

有没有一种方法可以让我们对所有时间最流行的应用程序进行排序和查看？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:37:56.800

> 它是该应用程序的终身总安装吗？或者是安装该应用程序的最后 30 天？

该图表是最近 30 天的，但数字范围（例如 10,000 - 50,000）是针对应用程序的生命周期的。

没有人真正确定顶级类别是如何决定的，但我猜测它是下载量和评级的组合（在特定时间段内，如果是新类别，可能是一周或一个月）。

# max - 最大搜索算法

> ID：15041178
> 
> 赞同：0
> 
> 时间：2013-02-23T13:45:01.130
> 
> 标签：max, summarization, post-conditions

尊敬的专家和爱好者，

我想解决以下问题：我有一个自然数数组。我想找到他们的最大值。

但我必须用结构图展示我的解决方案，比如 [http://www.testech-elect.com/pls/images/casetool2.jpg](http://www.testech-elect.com/pls/images/casetool2.jpg)

我必须通过 midifieing 求和算法来做到这一点，这意味着我必须修改[http://cfhay.inf.elte.hu/~hurrycane/programozas/programming_theorems.pdf的结构图和后置条件](http://cfhay.inf.elte.hu/~hurrycane/programozas/programming_theorems.pdf)

必须保留主要水平线，但您可以修改其他所有内容。你能告诉我没有递归的修改后的条件吗？就够了。如果我得到它，我可以制作结构图。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:45:24.537

考虑`C++`您的算法的代码：

```
max = a[0]; ind = 0;
for (int i = 1; i < n; i++)
{
    if (a[i] > max)
    {
        max = a[i];
        ind = i;
    }
} 
```

对于上述算法，我们将有：

1.  *状态空间*= ( *a* : N*, *n* : N, *ind* : N, *max* : N)
2.  *前置条件*= ( *a* = *a'* /\ *n* = *length(a)* )
3.  *后置条件*= (*前置条件*/\ ( *max* , *ind* ) = *MAX(i = 0, n) a[ i ]* )

# php - pjax 提交表单 URL 重定向

> ID：15041180
> 
> 赞同：5
> 
> 时间：2013-02-23T13:45:22.327
> 
> 标签：php, javascript, codeigniter, pushstate, pjax

[PJAX](https://github.com/defunkt/jquery-pjax)的文档指出 Github 用于`$.pjax.submit()`提交[Gist 表单](https://gist.github.com/gists)。Github 很好地实现了 ajax 表单提交的一个期望特性是 URL 从表单重定向`action`到新创建的 URL（在这种情况下，一个包含新创建的服务器端 gist ID）。

例如，从此：

```
https://gist.github.com/gists //  form action 
```

对此：

```
https://gist.github.com/tim-peterson/5019589 //assume this ID is generated server side 
```

我已经让这个在我的网站上以类似方式工作（即，页面本身重定向到相当于[https://gist.github.com/tim-peterson/5019589](https://gist.github.com/tim-peterson/5019589)）但我无法重定向 URL（它仍然像[https://gist.github.com/gists](https://gist.github.com/gists)）。

这完全是服务器端问题（设置标题？）还是我在 pjax 中遗漏了什么？我使用的是我今天下载的 pjax 版本，所以不可能是我使用的是错误版本的 pjax。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-27T09:54:20.257

您找到解决方案了吗？我有类似的问题。

基本上你需要在响应头中设置 X-PJAX-URL 属性。它的值应该与请求 URL 相同。

在 Laravel 中，我是这样做的......

```
App::after(function($request, $response)
{
  $response->headers->set('X-PJAX-URL', $request->getRequestUri());
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-24T15:25:34.210

使用 $.pjax.submit() 可能有一种更优雅/更合适的方法，但这是我一直在使用的解决方案，没有任何问题。我在提交之前序列化表单输入，然后将它们发布到我的服务器。然后检查来自服务器的回复，以确保在调用我的 PJAX 继续之前我不需要阻止用户继续前进。

```
$("#save").click(function(e) {

  e.preventDefault();
  dataString = $("#form").serialize();

  $.ajax({
    type: "POST",
    url: $("#form").attr("action"),
    data: dataString,
    dataType: "json",
    success: function(data)
    {
      // Handle the server response (display errors if necessary)

      $.pjax({
        timeout: 2000,
        url: data.url,
        container: '#main-content'
      });

    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-16T16:29:31.200

如果响应 HTML 不包含初始 PJAX 容器，则会发生这种情况

# c++ - 高效的字符串字典

> ID：15041186
> 
> 赞同：0
> 
> 时间：2013-02-23T13:46:19.340
> 
> 标签：c++, sorting, search, stl, containers

我有一个数据结构问题。我有一个字符串集合，这些字符串在进程的整个生命周期中都会增长。我希望能够在程序中以不同的持续时间传递对这些字符串的引用。我不想将重复项添加到集合中，因此当我传入一个时，我希望返回对现有条目的引用，因此：

```
const std::string& add_new_entry(const std::string&)
{
    // Check if string exists
    // Return reference if it does
    // Otherwise add to collection
    // Return reference to it
} 
```

最天真的实现是一个字符串列表和`std::find`每次调用，但我不禁觉得这是非常次优的，特别是因为我正在处理超过 50,000 个字符串。我创建了一个扩展数组容器，因此我可以任意添加元素而无需强制调整大小和移动，并且我使用取消引用比较谓词按字母顺序对它们进行索引`std::set`：`std::string*`谁能做得更好？15 个字符串比较似乎很多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:24:03.850

为了摆脱 的`O(log n)`性能`set`，您可以使用[`unordered_set`](http://www.cplusplus.com/reference/unordered_set/unordered_set/)which 使用散列（和 is `O(1)`）（或者`hash_set`本质上相同，但仅受某些编译器支持）。

鉴于您正在进行（最多）15 个字符串比较，您不会一直达到这个最大值，而且其中许多只能比较一个或两个字符，很可能生成哈希`unordered_set`（并处理哈希冲突） ) 会比在`set`.

另外，为什么不摆脱数组而直接使用`std::set<std::string>`呢？你仍然可以返回一个引用：

```
const string& add_new_entry(const string& str)
{
    set<string>::iterator iter = yourSet.find(str);
    if (iter == yourSet.end())
      return *yourSet.insert(str).first;
    return *iter;
} 
```

[测试](http://ideone.com/cndjRN)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:08:24.673

优化总是可能的，有时也非常值得，但对于 50,000 个条目，我猜它可能没有必要。假设它实际上是必要的，你可以尝试一些事情。

首先，如果某些词条比其他词条更常用，您可以将它们存储在单独的流行词词典中，您首先搜索该词典。要查看这是否值得，请针对每个字典条目存储一个计数器，每次访问条目时将其递增，并在长时间的测试期间查看这些计数器。

另一件值得拥有的是一个固定大小的字典数组，比如 26^3 = 17576，其中条目的前三个字母用于选择要搜索的字典。对于三个或更少字母的单词，这会将您降低到 o(1)，并大大减少您对剩余条目的搜索时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T13:50:21.710

我可能只是使用`std::set`，可能将它的迭代器包装在一个检查失效的小类中，这样你就可以保留迭代器而不是指针。

不要过早优化。您是否分析了该代码？您是否 100% 确定*这*是瓶颈？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T13:50:24.870

使用地图。您不必搜索您的数组/列表。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-23T13:52:43.207

std::hash_set 我想是要走的路

# javascript - for 循环或 for-in 循环

> ID：15041187
> 
> 赞同：0
> 
> 时间：2013-02-23T13:46:20.953
> 
> 标签：javascript

这是 Modernizr.js 中的一个函数。 [http://modernizr.github.com/Modernizr/annotatedsource.html#section-21](http://modernizr.github.com/Modernizr/annotatedsource.html#section-21)

函数 test_props 接受作为数组的 props，然后使用 for-in 循环对其进行迭代。我的问题是：由于 props 是一个数组，它有一个长度属性。并且正常的 for 循环比 for-in 循环快。为什么使用 for-in 循环？

```
function test_props( props, callback ) {
        for ( var i in props ) {
            if ( m_style[ props[i] ] !== undefined && ( !callback || callback( props[i], modElem ) ) ) {
                return true;
            }
        }
    } 
```

# c# - .NET ComboBox 有问题吗？

> ID：15041189
> 
> 赞同：0
> 
> 时间：2013-02-23T13:46:30.947
> 
> 标签：c#, .net, vb.net

我正在使用此代码来保护列表中显示的最后一部分。
这很好用，但每当我得到`SelectedText`of`ComboBox`返回一个空字符串。
实际上它应该返回“First”还是我错了？

```
comboBox1.Items.Add("First \0 Last");
comboBox1.SelectedIndex = 0;
if (comboBox1.SelectedText == "") MessageBox.Show("Empty string");
//Message box shown 
```

**注意：我不是在寻找解决此问题的解决方案**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T13:49:32.797

这不是错误。如果您在按钮 Click 事件处理程序中检索 SelectedText 值，则该值将是一个空字符串。这是因为当输入焦点从组合框移动到按钮时，选择会自动清除。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedtext.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selectedtext.aspx)

你可以使用`comboBox1.SelectedItem.ToString();`

[http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selecteditem.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selecteditem.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:48:35.187

总是最好使用`SelectedIndex`来挑选文本，例如，`comboBox1.Items[comboBox1.SelectedIndex]`

# multithreading - QtConcurrent::run with functor

> ID：15041192
> 
> 赞同：2
> 
> 时间：2013-02-23T13:46:44.643
> 
> 标签：multithreading, qt, functor, qtconcurrent

如何将 QtConcurrent::run 与函数对象一起使用？你能告诉我一个如何做到这一点的例子吗？

# ruby - 如何模拟系统用户在 ruby 中测试文件系统交互？

> ID：15041195
> 
> 赞同：3
> 
> 时间：2013-02-23T13:46:49.163
> 
> 标签：ruby, rspec, tdd

我很高兴发现[FakeFS](https://github.com/defunkt/fakefs)能够伪造一个文件系统沙箱，我的测试可以在其中搞乱。现在我希望能够测试测试 FileUtils.chown 和 chmod 操作，因此希望在测试上下文中与假用户一起工作，而不是将我的东西绑定到操作系统用户数据库以进行完全可移植和离散的测试。

我用 rspec 进行测试。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:41:51.540

有一个非常简单的方法可以做到这一点：`FileUtils::DryRun`. 它是一个类似于 的模块`FileUtils`，但实际上并没有针对这些场景对文件系统做任何事情。

如果你需要它来替换`FileUtils`，只需运行`FileUtils = FileUtils::DryRun`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:19:00.093

我不确定我是否得到了这个问题，但我假设您想测试 FileUtils 调用的“真实”结果，即更改文件的权限和所有权，这就是您需要某种用户的原因。我不会那样做，因为“SELECT 没有损坏”： http: [//pragmatictips.com/26](http://pragmatictips.com/26)

相反，假设如下：如果您使用正确的参数调用 FileUtils.chown 和朋友，他们将做正确的事情。要确保您的应用程序将正确的参数传递给 FileUtils，请使用模拟。这是一个例子：[https ://gist.github.com/phillipoertel/5020102](https://gist.github.com/phillipoertel/5020102)

如果您不想将您的测试与实现如此紧密地结合起来（模拟知道您的班级内部发生了什么），您可以通过预期它的效果来测试更改的权限。例如：如果之前不允许@user 访问@file，则调用更改权限的方法，然后调用需要更改权限的方法之一并断言有效。但是这种方法将访问文件系统，这是您一开始不想要的。

# wordpress - Wordpress Gallery 简码：仅显示一个类别 ID

> ID：15041196
> 
> 赞同：0
> 
> 时间：2013-02-23T13:46:53.073
> 
> 标签：wordpress, shortcode

再会。我在我的 wordpress 网站中使用图库短代码来显示图像。问题是我不是画廊只显示某个类别的图像，例如类别 id 35。我如何在短代码中指定它？

短代码：

```
 [custom_gallery style="1" source="**cat=%cat_id%**" link="image" description="0" size="200x200" limit="10"] 
```

现在我尝试了以下方法，但不起作用 -

```
cat=%35%
cat=%cat_id=35% 
```

简码（因为它是自定义简码）：

```
/**
 * Gallery posts shortcode
 */

function gallery_posts_func($atts, $content = null) {
    extract(shortcode_atts(array(
        "limit" => '5',
        "cat" => '',
        "thumb_width" => '',
        "thumb_height" => '',
    ), $atts));
    global $wp_query,$paged,$post;
    $temp = $wp_query;
    $wp_query= null;
    $wp_query = new WP_Query();

    $query .= '&posts_per_page='.$limit;
    $query .= '&post_type=gallery';
    $query .= '&taxonomy=gallery_cat';
    $query .= '&gallery_cat='.$cat;

    $wp_query->query($query);
    ob_start();
    ?>
    <?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
        <div class="gallery-holder fourthcol shortcode">
<?php

                $gogo_gallery_video_url = get_post_meta($post->ID, 'gogo_gallery_video_url', true);
                $gogo_gallery_links_to = get_post_meta($post->ID, 'gogo_gallery_links_to', true);
                $gogo_gallery_title_links_to = get_post_meta($post->ID, 'gogo_gallery_title_links_to', true);
                $gogo_gallery_custom_link = get_post_meta($post->ID, 'gogo_gallery_custom_link', true);

                if ($gogo_gallery_title && $gogo_gallery_video_url && $gogo_gallery_title_links_to=="gallery_title_links_image") {
                echo '<h5>';    
                echo '<a href="'.$gogo_gallery_video_url.'" rel="prettyPhoto[mixed]">';
                echo ''.get_the_title().'';
                echo '</a>';
                echo '</h5>';

                } elseif ($gogo_gallery_title && $gogo_gallery_title_links_to=="gallery_title_links_image") {
                echo '<h5>';    
                echo '<a href="'.$thumbnail[0].'" rel="prettyPhoto[mixed]">';
                echo ''.get_the_title().'';
                echo '</a>';
                echo '</h5>';

                } elseif ($gogo_gallery_title && $gogo_gallery_title_links_to=="gallery_title_links_content") {
                echo '<h5>';    
                echo '<a href="'.get_permalink().'">';
                echo ''.get_the_title().'';
                echo '</a>';
                echo '</h5>';

                } elseif ($gogo_gallery_title && $gogo_gallery_title_links_to=="gallery_title_links_link") {
                echo '<h5>';    
                echo '<a href="'.$gogo_gallery_custom_link.'">';
                echo ''.get_the_title().'';
                echo '</a>';
                echo '</h5>';

                } elseif ($gogo_gallery_title) {
                echo '<h5>';    
                echo ''.get_the_title().'';
                echo '</h5>';

                } else {
                echo '';
                }
        ?>  
<div class="gallery-box">
    <div class="gallery-image prettygallery">
        <?php if (has_post_thumbnail()) { ?>
            <?php
                $thumbnail = wp_get_attachment_image_src(get_post_thumbnail_id(), 'large');

                if ($gogo_gallery_video_url && $gogo_gallery_links_to=="gallery_links_image") { 
                echo '<a href="'.$gogo_gallery_video_url.'" rel="prettyPhoto[mixed]">';
                echo '<img src="'.get_template_directory_uri().'/timthumb.php?src='.$thumbnail[0].'&amp;w='.$thumb_width.'&amp;h='.$thumb_height.'&amp;zc=1&amp;q=100&amp;s=1" alt="'.get_the_title().'" />';
                echo '</a>';

                } elseif ($gogo_gallery_links_to=="gallery_links_image") {
                echo '<a href="'.$thumbnail[0].'" rel="prettyPhoto[mixed]">';
                echo '<img   src="'.get_template_directory_uri().'/timthumb.php?src='.$thumbnail[0].'&amp;w='.$thumb_width.'&amp;h='.$thumb_height.'&amp;zc=1&amp;q=100&amp;s=1" alt="'.get_the_title().'" />';
                echo '</a>';

                } elseif ($gogo_gallery_links_to=="gallery_links_content") {
                echo '<a href="'.get_permalink().'">';
                echo '<img src="'.get_template_directory_uri().'/timthumb.php?src='.$thumbnail[0].'&amp;w='.$thumb_width.'&amp;h='.$thumb_height.'&amp;zc=1&amp;q=100&amp;s=1" alt="'.get_the_title().'" />';
                echo '</a>';

                } elseif ($gogo_gallery_links_to=="gallery_links_link") {
                echo '<a href="'.$gogo_gallery_custom_link.'">';
                echo '<img src="'.get_template_directory_uri().'/timthumb.php?src='.$thumbnail[0].'&amp;w='.$thumb_width.'&amp;h='.$thumb_height.'&amp;zc=1&amp;q=100&amp;s=1" alt="'.get_the_title().'" />';
                echo '</a>';

                } else {
                echo '<img src="'.get_template_directory_uri().'/timthumb.php?src='.$thumbnail[0].'&amp;w='.$thumb_width.'&amp;h='.$thumb_height.'&amp;zc=1&amp;q=100&amp;s=1" alt="'.get_the_title().'" />';
                }
            ?>
        <?php } ?>
    </div>
<?php if ($gogo_gallery_short_desc) { ?><em><?php echo $gogo_gallery_short_desc; ?></em><?php } ?>
</div>
</div>
    <?php endwhile; ?>

    <?php $wp_query = null; $wp_query = $temp;
    $content = ob_get_contents();
    ob_end_clean();
    return $content;
}
add_shortcode("gallery_posts", "gallery_posts_func"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:48:35.640

您正在寻找的可能是：

```
cat="35" 
```

# shell - 在 Unix 中打印两行之间的文本（来自文件中的行号列表）

> ID：15041199
> 
> 赞同：-3
> 
> 时间：2013-02-23T13:47:12.403
> 
> 标签：shell, unix, sed, awk

我有一个包含数千行的示例文件。我想在该文件中的两个行号之间打印文本。我不想手动输入行号，而是我有一个文件，其中包含必须在其间打印文本的行号列表。

例子 ：`linenumbers.txt`

```
345|789
999|1056
1522|1366
3523|3562 
```

我需要一个 shell 脚本，它将从此文件中读取行号并将每个行范围之间的文本打印到一个单独的（新）文件中。

也就是说，它应该将 345 到 789 行之间的行打印到一个新文件中，比如`File1.txt`，并将第 999 到 1056 行之间的文本打印到一个新文件中，比如`File2.txt`，等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T13:58:20.730

考虑到您的目标文件只有数千行。这是一个快速而肮脏的解决方案。

```
awk -F'|' '{system("sed -n \""$1","$2"p\" targetFile > file"NR)}' linenumbers.txt 
```

*   这`targetFile`是包含数千行的文件。
*   oneliner**不需要**您`linenumbers.txt`进行分类。
*   oneliner 允许行范围在您的`linenumbers.txt`

运行上述命令后，您将拥有 n 个`filex`文件。`n`是的行数`linenumbers.txt` `x`是从`1-n`您可以根据需要更改文件名模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T14:26:10.820

这是使用`GNU awk`. 像这样运行：

```
awk -f script.awk numbers.txt file.txt 
```

内容`script.awk`：

```
BEGIN {
    # set the field separator
    FS="|"
}

# for the first file in the arguments list
FNR==NR {

    # add the row number and field one as keys to a multidimensional array with
    # a value of field two
    a[NR][$1]=$2

    # skip processing the rest of the code
    next
}

# for the second file in the arguments list
{
    # for every element in the array's first dimension
    for (i in a) {

        # for every element in the second dimension
        for (j in a[i]) {

            # ensure that the first field is treated numerically
            j+=0

            # if the line number is greater than the first field
            # and smaller than the second field
            if (FNR>=j && FNR<=a[i][j]) {

                # print the line to a file with the suffix of the first file's 
                # line number (the first dimension)
                print > "File" i
            }
        }
    }
} 
```

或者，这是单线：

```
awk -F "|" 'FNR==NR { a[NR][$1]=$2; next } { for (i in a) for (j in a[i]) { j+=0; if (FNR>=j && FNR<=a[i][j]) print > "File" i } }' numbers.txt file.txt 
```

* * *

* * *

* * *

如果你有一个 'old' `awk`，这里是兼容的版本。像这样运行：

```
awk -f script.awk numbers.txt file.txt 
```

内容`script.awk`：

```
BEGIN {
    # set the field separator
    FS="|"
}

# for the first file in the arguments list
FNR==NR {

    # add the row number and field one as a key to a pseudo-multidimensional
    # array with a value of field two
    a[NR,$1]=$2

    # skip processing the rest of the code
    next
}

# for the second file in the arguments list
{
    # for every element in the array
    for (i in a) {

        # split the element in to another array
        # b[1] is the row number and b[2] is the first field 
        split(i,b,SUBSEP)

        # if the line number is greater than the first field
        # and smaller than the second field
        if (FNR>=b[2] && FNR<=a[i]) {

            # print the line to a file with the suffix of the first file's
            # line number (the first pseudo-dimension)
            print > "File" b[1]
        }
    }
} 
```

或者，这是单线：

```
awk -F "|" 'FNR==NR { a[NR,$1]=$2; next } { for (i in a) { split(i,b,SUBSEP); if (FNR>=b[2] && FNR<=a[i]) print > "File" b[1] } }' numbers.txt file.txt 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T14:08:27.260

您可以执行以下操作

```
# myscript.sh
linenumbers="linenumber.txt"
somefile="afile"
while IFS=\| read start  end ; do
    echo "sed -n '$start,${end}p;${end}q;' $somefile  > $somefile-$start-$end"
done < $linenumbers 
```

像这样运行它`sh myscript.sh`

```
sed -n '345,789p;789q;' afile  > afile-345-789
sed -n '999,1056p;1056q;' afile  > afile-999-1056
sed -n '1522,1366p;1366q;' afile  > afile-1522-1366
sed -n '3523,3562p;3562q;' afile  > afile-3523-3562 
```

然后当你快乐的时候`sh myscript.sh | sh`

**编辑**添加了威廉在风格和正确性方面的优秀观点。

**编辑**说明

基本思想是获取一个脚本来生成一系列shell命令，这些命令可以在被“| sh”执行之前首先检查正确性。

`sed -n '345,789p;789q;` 表示使用`sed`且不回显每一行 (-n) ；有两个命令从第 345 行到第 789 行 p(rint) 行，第二个命令在第 789 行 q(uit) - 通过在最后一行退出，您保存已`sed`读取所有输入文件。

循环使用`while`read 从 $linenumbers 文件中读取，`read`如果给定多个变量名，则每个变量名都填充一个来自输入的字段，一个字段`space`通常`read`由变量的名称。

您可以在 shell 提示符下输入以下内容以了解该行为。

```
ls -l | while read first rest ; do
   echo $first XXXX $rest
done 
```

尝试在上面添加另一个变量`second`，看看会发生什么，这应该很明显。

问题是您的数据由`|`s 分隔，这就是使用 William 的工作建议的地方，`IFS=\|`因为现在从输入中读取[IFS](http://en.wikipedia.org/wiki/Internal_field_separator)已更改，输入现在由`|`s 分隔，我们得到了所需的结果。

**其他人可以随意编辑、更正和扩展。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T14:22:12.190

我会用它`sed`来处理示例数据文件，因为它简单快捷。这需要一种将行号文件转换为适当`sed`脚本的机制。有很多方法可以做到这一点。

一种方法用于`sed`将一组行号转换为`sed`脚本。如果一切都是标准输出，这将是微不足道的。由于输出需要转到不同的文件，我们需要行号文件中每一行的行号。给出行号的一种方法是[`nl`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/nl.html)命令。另一种可能性是使用[`pr -n -l1`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/pr.html). 相同的`sed`命令行适用于两者：

```
nl linenumbers.txt |
sed 's/ *\([0-9]*\)[^0-9]*\([0-9]*\)|\([0-9]*\)/\2,\3w file\1.txt/' 
```

对于给定的数据文件，生成：

```
345,789w > file1.txt
999,1056w > file2.txt
1522,1366w > file3.txt
3523,3562w > file4.txt 
```

另一种选择是`awk`生成`sed`脚本：

```
awk -F'|' '{ printf "%d,%dw > file%d.txt\n", $1, $2, NR }' linenumbers.txt 
```

如果您的版本`sed`允许您使用`-f -`（GNU允许`sed`；BSD`sed`不允许）从标准输入读取其脚本，那么您可以将行号文件动态转换为`sed`脚本，并使用它来解析示例数据：

```
awk -F'|' '{ printf "%d,%dw > file%d.txt\n", $1, $2, NR }' linenumbers.txt |
sed -n -f - sample.data 
```

如果您的系统支持`/dev/stdin`，您可以使用以下之一：

```
awk -F'|' '{ printf "%d,%dw > file%d.txt\n", $1, $2, NR }' linenumbers.txt |
sed -n -f /dev/stdin sample.data

awk -F'|' '{ printf "%d,%dw > file%d.txt\n", $1, $2, NR }' linenumbers.txt |
sed -n -f /dev/fd/0 sample.data 
```

如果做不到这一点，请使用显式脚本文件：

```
awk -F'|' '{ printf "%d,%dw > file%d.txt\n", $1, $2, NR }' linenumbers.txt > sed.script
sed -n -f sed.script sample.data
rm -f sed.script 
```

严格来说，您应该确保临时文件名是唯一的 ( `mktemp`) 并且即使脚本被中断 ( `trap`) 也会被删除：

```
tmp=$(mktemp sed.script.XXXXXX)
trap "rm -f $tmp; exit 1" 0 1 2 3 13 15

awk -F'|' '{ printf "%d,%dw > file%d.txt\n", $1, $2, NR }' linenumbers.txt > $tmp
sed -n -f $tmp sample.data
rm -f $tmp
trap 0 
```

final`trap 0`允许你的脚本成功退出；省略它，您的脚本将始终以状态 1 退出。

我忽略了 Perl 和 Python；任何一个都可以在单个命令中用于此目的。文件管理非常繁琐，使用起来`sed`似乎更简单。您也可以使用 just `awk`，或者使用第一个`awk`脚本编写`awk`脚本来完成繁重的工作（上面的微不足道的扩展），或者让单个`awk`进程读取两个文件并产生所需的输出（更难，但远非不可能）。

如果不出意外，这表明有许多可能的方法来完成这项工作。如果这是一次性练习，那么您选择哪一种并不重要。如果您将重复执行此操作，请选择您喜欢的机制。如果您担心性能，请测量。将行号转换为命令脚本的成本可能可以忽略不计；使用命令脚本处理样本数据是花费时间的地方。我希望`sed`在那一点上表现出色；我没有测量以确认它确实如此。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-23T13:56:02.293

要从`345|789`您那里提取第一个字段，例如可以使用 awk

```
awk -F'|' '{print $1}' 
```

将其与从您的其他问题中收到的答案结合起来，您将获得解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-23T20:09:54.923

这可能对您有用（GNU sed）：

```
sed -r 's/(.*)\|(.*)/\1,\2w file-\1-\2.txt/' | sed -nf - file 
```

# android - 谷歌地图 api 密钥不起作用 v2

> ID：15041200
> 
> 赞同：4
> 
> 时间：2013-02-23T13:47:16.037
> 
> 标签：android, eclipse, google-maps

我有一个使用谷歌地图的安卓应用程序。我已按照说明使用调试键使应用程序在调试模式下工作。我已从此处找到的 debug.keystore 检索到我的 SHA-1 密钥。

> c:\Users\myself\.android\debug.keystore

使用

> c:\Program Files\Java\jdk1.7.0_03\bin>keytool -list -v -keystore c:\debug.keystore

每当我通过在我的测试手机（运行 android 2.3.6）上运行 eclipse 中的应用程序使用系留调试时，地图显示良好。

但是，完成应用程序后，在已发布的应用程序中，地图没有显示。看得见的只有灰色的瓷砖。

我知道这是 API 密钥的问题。

所以我创建了一个新密钥，（以及一个带有它的 apk）用它从谷歌的控制台生成一个新的 API 密钥。我删除了使用密钥生成的 apk，因为它有旧的 ApiKey，并在此处粘贴了新的 api 密钥。

```
<com.google.android.maps.MapView
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:clickable="true"
android:id="@+id/mymap"
android:apiKey="my_api_key" 
```

然后我重新导出了我的项目，但这次使用了与我之前创建的步骤相同的密钥，因为它们包含相同的 SHA-1。

但是，地图仍然没有显示，只出现灰色瓷砖。我通过以下方式在 api 控制台中输入了我的 SHA-1 密钥。

> 18:3E:1D:8C:xx:xx:xx:xx:xx:xx:xx:xx:xx:x:xx:1D:E1:08:32:8E;com.mycompany.mapapp

我试图恢复到我的调试密钥，但是这次调试应用程序（从 Eclipse 运行）也没有显示任何映射。

我的问题如下。

1.  这仍然是正确的使用方法吗？因为在 -- [https://developers.google.com/maps/documentation/android/start#obtaining_an_api_key](https://developers.google.com/maps/documentation/android/start#obtaining_an_api_key) -- 谷歌使用了不同的片段方法。

2.  我错过了什么？

3.  这种方法是否已弃用或应该有效？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T14:16:36.130

You're generating an ApiKey for the Google Maps V2, but you are using the v1 MapView `com.google.android.maps.MapView`. On the Android Maps V2 API, the key is placed on the manifest, and you use `com.google.android.gms.maps.MapView` to show the map, using the Google Play Services Library.

I suggest reading the overview section [here](https://developers.google.com/maps/documentation/android/start) to learn how to setup your Project with the Google Play Services Library, and looking at the new API Reference [here](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/package-summary).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T13:54:44.613

如果你正在开发谷歌地图 api。您需要有两组地图 api 密钥。使用调试密钥库中的 SHA1 指纹生成的一个映射 api 密钥，当您在 eclipse 中调试应用程序并从那里运行它时，将使用此映射 api 密钥。另一个地图 api 密钥是使用来自官方或生产密钥库的 SHA1 指纹生成的，此地图 api 密钥在您签署或发布应用程序时使用。

我认为您在那里遇到了密钥不匹配的问题，因为清单上的 map api 密钥来自调试密钥库，并且您已经使用官方密钥库签署了您的应用程序。

另外我认为您正在开发 MapView。现在建议现在使用 MapFragments。我这里有可能对你有帮助的链接。

快速入门指南： [https ://docs.google.com/document/d/1dFzZT0C782BxLkDIUEb711rmsbMmYPURFV_2Cdb36so/edit?usp=sharing](https://docs.google.com/document/d/1dFzZT0C782BxLkDIUEb711rmsbMmYPURFV_2Cdb36so/edit?usp=sharing)

如果您遇到 MapFragment 或 Google Play 服务库问题的故障排除线程： [无法实例化 android.gms.maps.MapFragment](https://stackoverflow.com/questions/13719263/unable-instantiate-android-gms-maps-mapfragment)

此外，我在此[How to/Error in declaring google-play-services-component](https://stackoverflow.com/questions/14991967/how-to-error-in-declaring-google-play-services-component/14992298#14992298)中也有答案，可能会对您有所帮助。

# android - Android 图片上传出现错误

> ID：15041202
> 
> 赞同：0
> 
> 时间：2013-02-23T13:47:35.913
> 
> 标签：android

当我从图库中选择图像并将图像上传到服务器时..我收到这样的错误但它没有强制关闭..

实际上，问题不是在我上传图片时出现的。它是在我从图库中选择时出现的。

错误

> Activity com.android.internal.app.ChooserActivity 泄露了最初在这里注册的 IntentReceiver com.android.internal.app.ResolverActivity$1@41032458。您是否错过了对 unregisterReceiver() 的调用？
> 
> android.app.IntentReceiverLeaked: Activity com.android.internal.app.ChooserActivity 泄露了最初在这里注册的 IntentReceiver com.android.internal.app.ResolverActivity$1@41032458。您是否错过了对 unregisterReceiver() 的调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T13:51:20.897

ChooserActivity 有一个未注销的广播接收器，在上传和 onDestroy 之前注销广播接收器

# php - php Composer：什么是 BootStrap 进程？

> ID：15041203
> 
> 赞同：3
> 
> 时间：2013-02-23T13:47:45.753
> 
> 标签：php, composer-php, bootstrapping

详细信息为链接： http: [//getcomposer.org/doc/00-intro.md#autoloading](http://getcomposer.org/doc/00-intro.md#autoloading)

> 除了下载库之外，Composer 还准备了一个自动加载文件，该文件能够自动加载它下载的任何库中的所有类。要使用它，只需将以下行添加到代码的引导过程中： require 'vendor/autoload.php';

我不知道“**你的代码的引导过程**”是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T13:50:47.153

这是一个常用术语，表示*“你的代码必须做的事情才能准备好运行”*。

> **开机**|bo͞ot|
> 
> 动词 [ 带 obj。]
> 
> ...
> 
> *3*启动（计算机）并使其进入准备运行状态：*启动计算机后菜单将准备就绪*| [没有对象。] ：*系统不会从原始驱动器启动。*
> 
> [来自**引导程序。**]

# javascript - 用Javascript求和

> ID：15041205
> 
> 赞同：-1
> 
> 时间：2013-02-23T13:48:15.243
> 
> 标签：javascript

我有一个问题希望有人可以帮助我。

我的页面上有 3 个不同的范围输入：

```
<input type="range" name="test1" min="0" max="50" value="0" step="5" onchange="showValue(this.value) 
<input type="range" name="test2" min="0" max="50" value="0" step="5" onchange="showValue(this.value)
<input type="range" name="test3" min="0" max="50" value="0" step="5" onchange="showValue(this.value) 
```

我希望 JS 计算用户选择的输入值的总和，例如 (test1 + test2 + test3)，然后显示结果。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:35:16.770

## 解决方案

```
<script>
var update = function() {
    var sum = 
      Array.prototype.slice.call(
        document.getElementsByClassName("rangefield")
      ).reduce(
        function (a, b) {
          return a + Number(b.value);
        },
        0
      );
    document.getElementById("sumresult").innerHTML = sum;
};
</script>

<input type="range" class="rangefield" onchange="update()" onkeyup="update()">
<input type="range" class="rangefield" onchange="update()" onkeyup="update()">
<input type="range" class="rangefield" onchange="update()" onkeyup="update()">
<div id="sumresult"></div> 
```

**JSFiddle**：http: [//jsfiddle.net/ysangkok/nVNjk/1/](http://jsfiddle.net/ysangkok/nVNjk/1/)

## 这个怎么运作

1.  当一个字段被更新时，该`update()`函数被调用
2.  更新函数由两个语句组成。我将按照执行的顺序向您介绍他们的执行过程。
3.  `document.getElementsByClassName`被调用并返回一个`HTMLCollection`. 此集合不是数组。
4.  因为我想要一个数组，所以我`HTMLCollection`使用`Array.prototype.slice.call`.
5.  现在我有了一个`Array`，我称它为[reduce 成员](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/Reduce)，它允许我遍历元素并将状态从调用传递到它所需要的函数的调用。
6.  我提供的 reduce 参数是：为每个值调用的函数和初始值 (0)。
7.  该函数将被调用三次，首先是第一个范围输入 as`a`和 0 as `b`。然后它将返回范围输入的值与 0 之和，即查看 1 个元素后的中间和。以下对匿名函数的调用会将中间和与其他两个输入字段的值相加。
8.  现在已经分配了变量，我们通过分配ID 为（使用检索）的元素的属性`sum`将其放入元素中以进行显示。`sumresult``innerHTML``sumresult``document.getElementById`

# asp.net-mvc - 将 asp.net mvc 3 项目部署到 Windows Azure 网站时出错

> ID：15041206
> 
> 赞同：0
> 
> 时间：2013-02-23T13:48:15.903
> 
> 标签：asp.net-mvc, azure

我有一个`asp.net mvc 3`项目和一个单独的`BusinessLayer`项目包含在解决方案中。当我尝试通过本地 git 存储库将我的站点部署到 Azure 时，我收到以下错误：`'<remote_path>\BusinessLayer\BusinessLayer.csproj' is not a deployable project.`. 日志中没有提供其他信息。站点完美地部署在我的本地服务器上。因此，我想至少知道发生此错误的一些可能原因。提前致谢。

如有必要，这是我的 .csproj 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{31F2F6FE-10D8-4510-AC61-CBE1962D3940}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>BusinessLayer</RootNamespace>
    <AssemblyName>BusinessLayer</AssemblyName>
    <TargetFrameworkVersion>v4.0</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="MongoDB.Bson">
      <HintPath>..\..\Libs\MongoDB.Bson.dll</HintPath>
    </Reference>
    <Reference Include="MongoDB.Driver">
      <HintPath>..\..\Libs\MongoDB.Driver.dll</HintPath>
    </Reference>
    <Reference Include="System" />
    <Reference Include="System.Core" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Xml" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="Battle.cs" />
    <Compile Include="BattleManager.cs" />
    <Compile Include="BattlePlace.cs" />
    <Compile Include="Helpers\ConvertHelper.cs" />
    <Compile Include="Helpers\ImageHelper.cs" />
    <Compile Include="Message.cs" />
    <Compile Include="Picture.cs" />
    <Compile Include="Place.cs" />
    <Compile Include="PlaceManager.cs" />
    <Compile Include="Subject.cs" />
    <Compile Include="User.cs" />
    <Compile Include="Helpers\DBHelper.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.Common.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
</Project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T22:20:51.987

您可能需要确切地告诉 Azure 它应该部署哪个项目，您可以使用项目根目录中的 .deployment 文件来执行此操作。例如

```
[config]
project = WebProject/WebProject.csproj 
```

请参阅[此页面](https://github.com/projectkudu/kudu/wiki/Customizing-deployments)以获取有关此内容的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T16:50:19.640

听起来您正在尝试部署 BusinessLayer 项目而不是 Website 项目。只要你的 MVC 站点项目有对 BusinessLayer 的引用，部署网站即可。BusinessLayer 将作为参考包含在内。您不能单独部署 BusinessLayer，因为它是一个库而不是应用程序。

# javascript - 如何从MongoDB中的数组中查找数据

> ID：15041207
> 
> 赞同：0
> 
> 时间：2013-02-23T13:48:19.720
> 
> 标签：javascript, node.js, mongodb

我有这样的收藏：

```
{
    "name":"silver",
    mywants:[
    {"_id":objid(545454ddfdf5),mark:{"english":100,"math":100,"science":100}},
    {"_id":objid(5878784dfd5d),mark:{"english":100,"math":100,"science":100}},
    {"_id":objid(5454dfd44545),mark:{"english":100,"math":100,"science":100}},
    {"_id":objid(541dfee88245),mark:{"english":100,"math":100,"science":100}},
    ]
} 
```

我想找到给定的 objid 是否存在于 mywants 数组中。然后，如果存在那个 objid 我想要那个存在的对象 id 文档到我的回调函数，所以我尝试过这样

```
collection.find("{"name":"silver"},{"mywants._id":objid}).toArray(function(err,res)
{
    console.log(JSON.stringify(res));
})

But, I got output like 

[{"Mywant":[{"_id":"5128b9bc046802720b000003"},
    {"_id":"5128c190046802720b000004"},
    {"_id":"5128c359175e1aa80b000001"}],"_id":"5128b71455e4e0540b000002"}
] 
```

但我想要这样

```
{"_id":objid(545454ddfdf5),mark:{"english":100,"math":100,"science":100}}`, 
```

怎么找？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:46:49.873

你必须打电话

```
collection.find({"name":"silver", "mywants._id":objid}).toArray(…) 
```

代替

```
collection.find({"name":"silver"},{"mywants._id":objid}).toArray(…) 
```

. 前一个表示具有两个表达式（“name”：“silver” AND “mywants._id”：objid）的查询，而后一个是一个表达式（“name”：“silver”）和一个投影（“mywants._id” ":objid) [控制要返回的字段]。更多信息请访问[http://docs.mongodb.org/manual/reference/method/db.collection.find/](http://docs.mongodb.org/manual/reference/method/db.collection.find/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:31:44.123

您的代码中有错字，不清楚您想要什么。根据您想要的拼写错误和输出示例（再​​次输入拼写错误），我认为这就是您的意思：

-您正在查找 name:"silver" 并希望使用该语法返回 mywants._id 字段（有错字）。

相反，我假设您打算找到：

名称：“silver”和“mywants._id”：someSpecificId

并输出相应的 mywants 条目：

```
db.collection.find({"name":"silver","mywants._id":objid}, {"mywants.$":1, _id:0}).pretty() 
```

# magento - 如何在不保存产品数据的情况下从观察者重定向到产品编辑选项卡

> ID：15041208
> 
> 赞同：0
> 
> 时间：2013-02-23T13:48:28.947
> 
> 标签：magento, magento-1.5

即使产品包含错误消息，观察者也无法重定向到产品编辑页面。我的代码如下，请查看代码并给我建议问题出在哪里。我在我的观察者中调用 catalog_product_save_before 事件。

```
$data['aproductid']   = $this->_getRequest()->getParam('id');
if(in_array($check,$resultarray))
            {
                 Mage::getSingleton('core/session')->addError('You have entered duplicate licence no');
                 Mage::app()->getResponse()->setRedirect(Mage::getUrl('*/*/edit', array(
            'id'    => $data['aproductid'],
            '_current'=>true)));
                 return;

            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T13:59:51.160

问题可能是，响应在观察者结束时发生了改变。

你可以试试这个：

```
$e = new Mage_Core_Controller_Varien_Exception();
$e->prepareForward('edit');
throw $e; 
```

# design-patterns - 享元模式与静态字段

> ID：15041217
> 
> 赞同：7
> 
> 时间：2013-02-23T13:49:26.420
> 
> 标签：design-patterns, flyweight-pattern

据我了解，享元模式的目的是通过共享通用的外部状态来减少内存占用并提高性能。为什么有人更愿意实现模式而不是将共享状态存储在静态字段中？

考虑以下示例：[http ://www.oodesign.com/flyweight-pattern-wargame-example-java-sourcecode.html](http://www.oodesign.com/flyweight-pattern-wargame-example-java-sourcecode.html)

![在此处输入图像描述](../Images/96953cd78dba0520c6fcbe79292af0b9.png)

如果我是对的，那么此示例中的重点是通过持有对单个 SoldierImp 对象的引用，在 SoldierClient 类的所有实例之间共享公共状态（soldierGraphicalRepresentation 对象）。

为什么我会为实现这个设计而烦恼？我很想按如下方式声明 SoldierClient 类：

```
public class SoldierClient implements Soldier 
{
    protected static Object soldierGraphicalRepresentation;
    private int currentLocationX;
    private int currentLocationY;

    static SoldierImp()
    {
        soldierGraphicalRepresentation = LoadGraphicalRepresentation();
    }

    public void moveSoldier(int previousLocationX, int previousLocationY, int newLocationX, int newLocationY) {
        // do stuff with the graphical representation

    }
} 
```

通过这种方式，SoilderClient 的所有实例共享对同一个 solderGraphicalRepresentation 对象的引用，从而实现了相同的目标。我错了吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-23T14:42:33.997

该模式的要点是，您可以让 200 个“大红”士兵共享相同的“大红”图形表示，300 个“小蓝”士兵共享相同的“小蓝”图形表示，等等。如果您制作图形表示静态的，所有的士兵都是一样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-12T10:00:23.957

无论您有多少红色/绿色/蓝色图形表示，静态字段都有效。静态字段的唯一问题是它们违反了*单一职责原则*。如您所见，您的`SoldierClient`班级有两个工作：

1.  管理图形表示池
2.  一个典型的工作`SoldierClient`

使用这种设计，很难在另一个上下文中重用这两个作业中的一个。例如，池不能被`Monster`同样需要共享图形表示的对象重用；典型的`SoldierClient`不能用于与池无关的另一个上下文中。

# javascript - 在类中调用父对象外的函数

> ID：15041223
> 
> 赞同：0
> 
> 时间：2013-02-23T13:49:53.777
> 
> 标签：javascript, class, coffeescript

```
class Test
    f1: -> console.log 'f1'
    f2: -> console.log 'f2'

    f:
        f3: -> f1()

test = new Test
test.f.f3() 
```

当我在 NodeJS 中运行它时，我得到了这个：

```
ReferenceError: f1 is not defined 
```

* * *

我想`f1`从`f.f3`. 我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:06:42.273

我的第一个答案不正确，但这有效（稍作修改）：

```
class Test
  f1: -> console.log 'f1'
  f2: -> console.log 'f2'
  f: =>
    f3: => @f1()

test = new Test
test.f().f3() 
```

# java - 我有一个打开 GUI 的按钮，如何设置 GUI 在屏幕上的显示位置？

> ID：15041225
> 
> 赞同：0
> 
> 时间：2013-02-23T13:50:09.027
> 
> 标签：java, swing, user-interface, window, location

我知道`setLocationRelativeTo(null)`使 GUI 居中的操作，但我希望它偏离中心，因为我的两个 GUI 大小相同，我希望用户知道他们已经打开了一个新窗口，在此先感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T13:53:47.823

考虑使用[`setLocationByPlatform(boolean locationByPlatform)`](http://docs.oracle.com/javase/6/docs/api/java/awt/Window.html#setLocationByPlatform(boolean)).

有关演示，请参阅[如何以最佳方式定位 Swing GUI 。](https://stackoverflow.com/q/7143287/597657)

![setLocationByPlatform()](../Images/2df12300d0a17e7b750c5283eff2a786.png)

# xcode - GIT_DISCOVERY_ACROSS_FILESYSTEM 错误

> ID：15041234
> 
> 赞同：1
> 
> 时间：2013-02-23T13:50:51.640
> 
> 标签：xcode, git, xcode4.6

最近，每次我提交到本地 Xcode git 时，我都开始收到此错误。

致命：不是 git 存储库（或挂载点 /Volumes/xxx 之前的任何父级）在文件系统边界处停止（未设置 GIT_DISCOVERY_ACROSS_FILESYSTEM）。

我已将我的 HDD 分区为 2 个驱动器，我的源代码位于其中一个驱动器上。我所有的源代码都是本地的，我只是将内置的 Git 与 Xcode 一起使用。任何线索为什么我会收到此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-01-16T10:02:38.177

[检查这个。](https://stackoverflow.com/questions/16853624/git-discovery-across-filesystem-not-set)您一定缺少 git init。这是第一个开始的命令。此命令创建一个空的 Git 存储库 - 基本上是一个`.git`目录

# c++ - 将此实例作为回调参数发送

> ID：15041238
> 
> 赞同：0
> 
> 时间：2013-02-23T13:51:29.033
> 
> 标签：c++, callback, this-pointer

我有简单的 UI 类，我需要将 UI 元素实例发送到每个元素的回调，所以我可以（很像在 javascript 中）操作调用回调的元素。
这需要将实例发送`this`到注册为回调的函数。我怎么做？
当前状态：

```
class Opencv_Button {
private:
    bool (*callback)(void*);                 //Callback WITHOUT the current button isntance
    //bool(*callback)(Opencv_Button, void*); //this is CALLBACK I WANT instead
    void* callback_param;                    //parameter set by user
    bool state;
    bool mouse(int, int, int);
public:
    Opencv_Button(int, int, int, int);
    void setCallback(bool(*)(void*), void*);
    //void setCallback(bool(*)(Opencv_Button, void*), void*);  //This is what I WANT TO USE
    void draw(Mat*, bool);
    void val(const char*);
    char value[30];
}; 
```

现在，有调用回调的函数：

```
bool Opencv_Button::mouse(int mx, int my, int button) 
{
    if(/*click conditions satisfied*/) 
        {
             /*CLICK!!!*/
                  if(callback!=0)
                     callback(callback_param);
                     /*Instead I WANT:*/
                     //callback(*this/*some THIS instance*/, callback_param);
                 return true;
        }
    return false;
} 
```

所以，我可以在回调中做这样的事情：

```
bool buttonCallback(Opencv_Button*but, void*param) {
     but->val("I was clicked!!!");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T13:56:12.297

你很接近。快速解决方法是确保您的回调接受一个指针并且您通过`this`：

```
bool (*callback)(Opencv_Button*, void*);
void setCallback(bool(*)(Opencv_Button*, void*), void*); 
```

并致电：

```
callback(this, callback_param); 
```

但是，您可能会更好地使用参考。您可以让您的函数参考`Opencv_Button`：

```
bool (*callback)(Opencv_Button&, void*);
void setCallback(bool(*)(Opencv_Button&, void*), void*); 
```

然后调用它：

```
callback(*this, callback_param); 
```

你的`buttonCallback`遗嘱是这样的：

```
bool buttonCallback(Opencv_Button& but, void* param) {
  but.val("I was clicked!!!");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T13:56:21.797

将回调定义为

```
bool (*callback)(Opencv_Button*, void*); 
```

一切顺利。

# c# - 等待进程结束异步，然后在主窗体中调用函数

> ID：15041241
> 
> 赞同：0
> 
> 时间：2013-02-23T13:51:57.760
> 
> 标签：c#, asynchronous, process, invoke, exit

我正在用 C# 编写一个游戏的编辑器。我的程序通过启动 notepad.exe 进程打开为 .txt 文件。如果该进程退出，我想在主窗体中调用一个函数（以更新文本框）。到目前为止，这是我正在做的事情：

```
 void OpenTextEditor(TreeNode node) 
    {
        Process editor = new Process();
        editor.StartInfo.WorkingDirectory = "%WINDIR%";
        editor.StartInfo.FileName = "notepad.exe";
        var txtfilelocation = GetRealPathByNode(node);
        var txtfile = File.ReadAllText(txtfilelocation,Encoding.Default);
        txtfile = txtfile.Replace("\n", "\r\n");
        File.WriteAllText(txtfilelocation,txtfile,Encoding.Default);
        editor.StartInfo.Arguments = txtfilelocation;
        editor.EnableRaisingEvents = true;
        editor.Exited += delegate {
            NotePadHasEnded(node);
        };
        editor.Start(); //starten  
    }

    public Delegate NotePadHasEnded(TreeNode node)
    {
        var txtfilelocation = GetRealPathByNode(node);
        var newfileloc = txtfilelocation;
        var newfile = File.ReadAllText(newfileloc, Encoding.Default);
        newfile = newfile.Replace("\r\n", "\n");
        File.WriteAllText(txtfilelocation, newfile, Encoding.Default);

        if (treeView1.SelectedNode == node) DisplayText(node);

        return null;
    } 
```

GetRealPathByNode() 函数返回 TreeView 节点指向的文件的完整路径字符串。DisplayText() 从节点指向的文件中读取文本并将其显示在富文本框中。

执行后，我的主窗体仍然可以按我的意愿使用，但是当进程终止（记事本关闭）时，它会抛出一个错误，指出函数 NotePadHasEnded 无法访问 treeView1 对象，因为它正在另一个进程中执行。

如何创建一个在我的主窗体中异步退出时调用函数的进程？我知道当我使用 WaitForExit() 函数时它可以工作，但是我的表单会冻结并等到记事本关闭。我希望用户能够使用编辑器打开其他 txt 文件，并且当关闭一个编辑器时，我的 GUI 中的富文本框文本正在更新。

/*编辑*/ 现已解决。感谢伍德曼的回答，我更换了

```
 editor.Exited += delegate {
            NotePadHasEnded(node);
            }; 
```

和

```
 editor.Exited += delegate
        {
            this.Invoke((MethodInvoker)delegate()
            {
                NotePadHasEnded(node);
            });
        }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:15:53.337

您应该使用`Dispatcher.Invoke`or `Dispatcher.BeginInvoke`inside`NotePadHasEnded()`方法切换到 UI 线程，因为您只允许从 UI 线程访问 UI 对象。

查看[此帖子](https://stackoverflow.com/questions/4428817/accessing-ui-control-from-backgroundworker-thread-c-sharp)以获取更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:16:36.063

谷歌[同步上下文](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)。发生错误是因为您的 UI 线程未与运行的第二个线程同步，然后编辑器被关闭。我找到了一些描述如何实现同步的示例：[这都是关于 SynchronizationContext](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)和[ExecutionContext 与 SynchronizationContext](http://blogs.msdn.com/b/pfxteam/archive/2012/06/15/executioncontext-vs-synchronizationcontext.aspx)的。希望这可以帮助你;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:30:17.603

该`Exited`事件发生在另一个线程中，您只能在自己的线程（称为UI线程）中访问UI控件。由于您使用的是 Windows 窗体，因此您应该使用以下[`Control.Invoke`](http://msdn.microsoft.com/en-us/library/30s4t80c.aspx)方法：

```
editor.Exited += delegate
{
    node.TreeView.Invoke(new Action<TreeNode>(NotePadHasEnded), node);
}; 
```

还将返回类型更改`NotePadHasEnded`为`void`。

`node.TreeView`用于访问`Invoke`方法。您可以使用任何 UI 控件。如果代码驻留在表单中，则可以`this`改用。

# string - 如何将字符串转换为 R 中的变量名

> ID：15041247
> 
> 赞同：3
> 
> 时间：2013-02-23T13:52:37.137
> 
> 标签：string, r, variables

我正在处理一堆货币数据 .csv 文件。这些 .csv 没有标题，我正在尝试使用 colnames 函数添加标题。

```
colnames(variable_name) <- c('Date', 'Time', 'Open', 'Close', 'Volume') 
```

数据导入和列标题的分配应该使用 for 循环自动完成。数据框的名称是文件名的一部分。

```
file_names <- list.files()

for (i in 1:length(file_names)){
    assign(substr(file_names,1,6)[i], read.csv(file_names[i], header=F))
    colnames(variable_name) <- c('Date', 'Time', 'Open', 'Close', 'Volume')
} 
```

如何设法将 variable_name 输入 colnames 函数。我尝试使用：

```
colnames(substr(file_names,1,6)[i]) 
```

但这会给我输入“AUDUSD”，我需要输入不带引号的 AUDUSD。

那么我怎样才能将字符串转换为我可以在这里使用的变量名呢？或者我的方法在这里完全错误？

非常感谢！

克里斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T14:04:33.960

您正在寻找`get`. 您的代码如下所示：

```
file_names  <- list.files()
short_names <- substr(file_names, 1, 6)

for (i in seq_along(file_names)) {
    assign(short_names[i], read.csv(file_names[i], header = FALSE))
    colnames(get(short_names[i])) <- c('Date', 'Time', 'Open', 'Close', 'Volume')
} 
```

但似乎更容易使用函数中的`col.names`选项`read.*`，请尝试：

```
assign(short_names[i], read.csv(file_names[i], header = FALSE,
                                col.names = c('Date', 'Time', 'Open',
                                              'Close', 'Volume')) 
```

如果你不熟悉 *apply 系列函数，你的整个循环可以替换为：

```
mapply(assign, short_names, lapply(file_names, read.csv, header = FALSE,
                                   col.names = c('Date', 'Time', 'Open',
                                                 'Close', 'Volume')) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T14:18:09.577

我建议您使用列表。这样，事情就会变得干净整洁：

```
file_names <- list.files()

data <- lapply (file_names, read.csv, header = FALSE)
names (data) <- substr(file_names, 1, 6)  # now you can access data$AUDUSD

## colnames for all data.frames
data <- lapply (data, `colnames<-`, c('Date', 'Time', 'Open', 'Close', 'Volume')) 
```

更容易：

```
data <- lapply (file_names, read.csv, header = FALSE, 
                col.names = c ('Date', 'Time', 'Open', 'Close', 'Volume'))
names (data) <- substr (file_names, 1, 6)  # now you can access data$AUDUSD 
```

（就我个人而言，我会将所有这些 data.frames 放在一个中，并在其中添加一个额外的列`$conversion`）

但是，您当然可以将每个 data.frame 放在自己的变量中。在这种情况下，`get`需要一点小心：

```
> colnames (get (variable_name)) <- c('Date', 'Time', 'Open', 'Close', 'Volume')
error: "target of assignment expands to non-language object") 
```

（错误消息是反向翻译的）

但是，这有效：

```
 tmp <- get (variable_name) # in your case, rather do: tmp <- read.csv (...)
    colnames (tmp) <- letters [1:2]
    assign (variable_name, tmp) 
```

（无论如何，我会`colnames<-`在第一个分配之前放置）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:00:40.857

我不认为你得到了你认为你得到的东西。这是我的测试用例：

```
Rgames> foo[1:6]
[1] "aggfrac.R"     "AJtranslate.c" "AJtranslate.R" "anaclock.R"   
[5] "apollo.R"      "askrm.R"      
Rgames> bar<-matrix(nr=2,nc=5)
Rgames> colnames(bar)<-substr(foo,1,6)[1:5]
Rgames> bar
     aggfra AJtran AJtran anaclo apollo
[1,]     NA     NA     NA     NA     NA
[2,]     NA     NA     NA     NA     NA 
```

您可以看到列名“恰到好处”。

# sql - 从本地主机上传 Drupal 站点到实时托管后，它报告错误

> ID：15041249
> 
> 赞同：0
> 
> 时间：2013-02-23T13:52:55.757
> 
> 标签：sql, drupal, content-management-system

导入数据库后，更改“settings.php”文件并将所有开发文件上传到直播主机，加载网站报如下错误：

```
PDOException: SQLSTATE[28000] [1045] Access denied for user 'u379065817_gk'@'localhost'       
(using password: YES) in lock_may_be_available() (line 167     
of /home/u379065817/public_html/includes/lock.inc). 
```

我在本地开发网站时使用了 Acquia Dev Desktop。试图在 Drupal 社区站点上找到解决方案，但几乎每一个都不同。尝试了其中的大多数，但都没有奏效。:( 提前感谢所有的努力。

# php - 从外部脚本引导 C5

> ID：15041252
> 
> 赞同：1
> 
> 时间：2013-02-23T13:53:27.447
> 
> 标签：php, concrete5

我正在编写一个导入脚本来将一些外部内容添加到 C5 安装中。

我不确定我需要包含哪些文件才能使 C5 API 可用（无需像加载页面这样的任何操作）？

`/concrete/dispatcher.php`做了一大堆初始化，但我不确定哪些是必需的。仅包括`dispatcher.php`会导致脚本导航到安装对话框。

是否有在外部工具中初始化 C5 的规范方法？[我在开发人员文档](http://www.concrete5.org/documentation/developers/)中找不到任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T19:04:08.823

您可以定义一个`C5_ENVIRONMENT_ONLY`常量，之后您可以包含“index.php”文件来获取 c5 系统，而无需让它服务于特定页面或主题。

```
<?php
define('C5_ENVIRONMENT_ONLY', true);
include("index.php");

//C5 should be loaded now, so you can interact with the API... 
```

我刚刚在最新版本（5.6.1）上对此进行了测试，它工作得很好——我能够通过 Loader::db() 查询数据库，并且能够与登录的用户对象（全局 $u ）。所以我假设如果这两件事有效，那么任何事情都会有效。

不久前我确实找到了这两个论坛主题：

*   [http://www.concrete5.org/developers/bugs/5-4-2-1/c5_integration-with-upgraded-version-of-core/](http://www.concrete5.org/developers/bugs/5-4-2-1/c5_integration-with-upgraded-version-of-core/)
*   [http://www.concrete5.org/community/forums/customizing_c5/setting-up-cron-job-script-include-just-the-and039functions-anda/](http://www.concrete5.org/community/forums/customizing_c5/setting-up-cron-job-script-include-just-the-and039functions-anda/)

...which indicate you also need to declare the `DIR_BASE` constant... but this may be an old requirement because I got my tests to run just fine without it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T21:18:53.977

要编写导入脚本，我建议向仪表板添加一个页面，如此处[所述](http://www.concrete5.org/documentation/introduction/dashboard)。这真的很简单，将为您处理引导。

# jsf - 如何在 p:datatable 的最后一行呈现 p:commandButton？

> ID：15041257
> 
> 赞同：1
> 
> 时间：2013-02-23T13:54:19.153
> 
> 标签：jsf, primefaces, datatable, commandbutton

我需要渲染唯一`<p:commandButton>`的最后一个条目`<p:datatable>`。考虑是否`p:datatable`有 n no.of 行意味着我只渲染了`p:commandButton`第 n 行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T10:31:38.907

我认为你最好使用`<f:facet name="footer">`

```
 <f:facet name="footer">  
        <p:commandButton/> 
    </f:facet> 
```

但如果你真的坚持最后一排...

试试`rowIndexVar`，像这样：

```
<p:dataTable value="#{myBean.myList}" rowIndexVar="rowIndex" var="item">
    <p:column>
        <p:commandButton rendered="#{(rowIndex+1) eq myBean.myList.size()}"/> 
    </p:column>
</p:dataTable> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:10:11.633

我不知道我的功能要求是否正确，但据我了解，您想在表格底部添加一个命令按钮，因为您可以在数据表标签内使用以下内容：

```
 <f:facet name="footer">
        <p:commandButton/>
 </f:facet> 
```

# ruby - 如何在 Ruby 中拦截类定义？

> ID：15041258
> 
> 赞同：0
> 
> 时间：2013-02-23T13:54:20.977
> 
> 标签：ruby, interception

是否可以编写一些可以告诉我何时定义 Ruby 类的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:34:17.593

是的！

```
class Object  
  def self.inherited(base)
    puts "#{base} inherited from object"
  end
end

class Animal
end

class Cat < Animal
end 
```

运行上面的代码会打印以下内容：

```
Animal inherited from object
Cat inherited from object 
```

基本上，`self.inherited`只要定义了继承自定义它的类的类，就会触发回调。穿上它`Object`，这就是*任何*课程！（虽然可能有一些我现在想不到的特殊情况例外）。

我可能应该添加免责声明，虽然可以做到这一点（因为 Ruby 作为一门语言有多棒），但是否建议这样做，尤其是在用于生产的代码中，我不太确定. 嗯，事实上，我很确定。这将是一个坏主意。

# salesforce - 在顶点控制器中维护 CheckBox 状态

> ID：15041259
> 
> 赞同：1
> 
> 时间：2013-02-23T13:54:23.330
> 
> 标签：salesforce, apex-code, visualforce

我正在编写一个visualforce页面，用户必须在其中选择机会列表当用户单击上一个按钮时我实现了分页然后它将再次呈现列表面板并且我在调用中更改了列表的值我的visualforce页面段是

```
<apex:pageBlockTable value="{!numbers}" var="n" align="center">
    <apex:column >
        <apex:inputCheckbox value="{!n.checked}"/>
    </apex:column> 
    <apex:column value="{!n.cat.Id}" />
    <apex:column value="{!n.cat.Name}" />
    <apex:facet name="footer">Showing Page # {!pageNumber} of {!totalPages}</apex:facet>
</apex:pageBlockTable> 
```

我有一个 OpportunityWrapper 类来维护 checkItem：

```
public class OpportunityWrapper {
    public Boolean checked { get; set; }
    public Opportunity cat { get; set; }

    public OpportunityWrapper(){
        cat = new Opportunity();
        checked = false;
    }

    public OpportunityWrapper(Opportunity c){
        cat = c;
        checked = false;
    }

    public OpportunityWrapper(Opportunity c, Boolean checked){
        cat = c;
        this.checked = checked ;
    }
} 
```

在自定义控制器中获取 OpportunityWrapper 列表的代码段是

```
public List<OpportunityWrapper> getNumbers() {
    opp = new List<OpportunityWrapper>();
    if ( selectedPage != '0' )
        counter = list_size*integer.valueOf(selectedPage)-list_size;

    //we have to catch query exceptions in case the list is greater than 2000 rows
    try {
        for ( Opportunity o : [SELECT Id,Name from Opportunity order by name 
               limit :list_size offset :counter] ) {
            if ( !oppId.contains(o.Id) ) 
                opp.add(new OpportunityWrapper(o));
            else
                opp.add(new OpportunityWrapper(o,true));               
        } 
    } catch ( QueryException e ) {
        ApexPages.addMessages(e);                   
        return null;
    }    
    return opp;
} 
```

并且当按下前一个按钮时，调用以下方法

```
public PageReference Previous() {
    //user clicked previous button
    for ( OpportunityWrapper o : opp ) { 
        if ( o.checked &&  oppId.contains(o.cat.Id) )
            oppId.add(o.cat.Id); 
    }
    selectedPage = '0';
    counter -= list_size;
    return null ;
} 
```

以下是自定义类的公共成员

```
private integer counter = 0;  //keeps track of the offset
private integer list_size = 5;
public integer total_size; 
List<OpportunityWrapper> opp ;
public List<OpportunityWrapper> oppwrapper = new List<OpportunityWrapper>(); //list of Opportunity wrapper shown in the page
public  Set<String> oppId = new Set<String>(); //set for maintaining which Id's are checked 
```

我的目标是当我检查任何机会包装器并转到下一个或上一个列表时，当返回该项目时应该检查但我得到的设置值始终为空但我将选择值列表存储在 Previous() 方法的集合中为什么它的显示设置总是空的？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T18:14:09.930

您可以在以下主题中找到 2 种解决方案（一种使用 JS 实现，另一种使用 apex 控制器实现）：

[如何找出在 VisualForce 的下一页上选择了哪些复选框？](https://stackoverflow.com/questions/14823107/how-to-find-out-which-checkboxes-have-been-selected-on-the-next-page-in-visualfo/14825189#14825189)

# ruby-on-rails-3 - QUEUE=* 在工头上未找到错误

> ID：15041262
> 
> 赞同：3
> 
> 时间：2013-02-23T13:54:55.130
> 
> 标签：ruby-on-rails-3, worker, foreman

我正在尝试使用工头在本地运行我的应用程序，使用在 Heroku 上部署我的应用程序时使用的相同 Procfile，它可以完美运行。但是，`foreman start`在我的终端上运行时，工头给出了一个错误消息：

```
line 41: exec: QUEUE=*: not found 
```

我从中收集到的是工头不承认`QUEUE=*`命令。那么为什么它可以在 Heroku 上运行呢？我该怎么做才能完全按照在生产模式下运行的命令运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-05T17:07:10.437

我遇到了同样的问题。你想把队列参数放在最后。

例如：worker: bundle exec rake jobs:work QUEUE=hi

# django - 南迁移错误：未定义名称“UUID”

> ID：15041265
> 
> 赞同：15
> 
> 时间：2013-02-23T13:55:02.303
> 
> 标签：django, django-south

我有一个带有默认值为 uuid4 的 CharField 字段的模型：

```
f = models.CharField(default=uuid4, max_length=36, unique=True, blank=True) 
```

这导致以下错误：

> 无法为模型“m”成功创建字段“f”：未定义名称“UUID”。

运行迁移命令！我可以解决这个问题吗？到目前为止，我尝试过：

*   在模块中为 uuid 定义一个“包装函数”（即：def getUUID()）
*   通过覆盖模型构造函数来设置“f”的默认值

...但问题仍然存在:(

附言。我知道我可以向南指导自定义字段，但我认为我没有使用自定义字段：P

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-23T15:02:58.627

我解决了在模型模块中定义以下辅助函数的问题：

```
from uuid import uuid4

def generateUUID():
    return str(uuid4()) 
```

然后：

```
f = models.CharField(default=generateUUID, max_length=36, unique=True, editable=False) 
```

south 将生成一个带有生成的 UUID 的迁移文件 (migrations.0001_initial)，例如：

```
default='5c88ff72-def3-4842-8d48-a75bb3240bb5' 
```

这很不高兴...因为该字符串是“静态的”，而是必须使用辅助函数动态创建...无论如何，在 django 的世界中，al 似乎按预期工作...我在数据库中添加了一些记录和一个为每个生成新的 UUID。然后，我通过向我的模型添加几个字段来尝试我的第一个模式迁移，并且它们已按预期添加到数据库表中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-01-19T18:50:08.243

您还可以在迁移中导入 UUID：

```
from uuid import UUID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-18T08:58:57.517

我只是从“node_modules”目录中删除了一个 uuid 目录。

然后我重新安装了 uuid 并且它起作用了。

希望对你们有帮助 <3

# algorithm - big-o 符号的指数增长

> ID：15041273
> 
> 赞同：2
> 
> 时间：2013-02-23T13:55:56.113
> 
> 标签：algorithm, big-o

我对理解以下问题有疑问。它说：

> 证明指数函数对于不同的基值具有不同的增长阶数。

例如，在我看来，考虑一个^n。如果a=3，它的增长率会比a=2时大。看起来很明显。这真的是问题想要的吗？我怎样才能为此做一个正式的证明？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:42:50.073

f(n) ∈ O(g(n)) 表示存在正常数 c 和 k，因此对于所有 n ≥ k，0 ≤ f(n) ≤ cg(n)。对于函数 f，c 和 k 的值必须是固定的，并且不能依赖于 n。

不失一般性，令 1>a>b，并假设 b^n ∈ O(a^n)。这意味着存在正常数 c 和 k 使得 0 ≤ b^n ≤ ca^n 对于所有 n ≥ k，这是不可能的：对于所有 n ≥ k 的
b^n ≤ ca^n 意味着 (b/a)^对于所有 n ≥ k，n ≤ c，
这与 lim (b/a)^n = +inf 矛盾，因为 b/a>1。

如果 1>a>b 则 b^n ∉ O(a^n)，但 a^n ∈ O(b^n) 所以 O(a^n)⊊O(b^n)

# sql - Postgresql 和 OSX

> ID：15041282
> 
> 赞同：-1
> 
> 时间：2013-02-23T13:56:37.160
> 
> 标签：sql, database, xcode, macos, postgresql

我有一个处于设计阶段的项目，考虑到我的选择，由于许可和功能，我决定将 Postgresql 用于应用程序后端。我四处搜索，但找不到任何关于在 Xcode 甚至 OSX 应用程序中使用 Postgresql 的可靠信息。有人能指出我正确的方向吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:28:00.457

您没有提供很多上下文。

在应用程序方面，有很多在 OS X 下运行的与 PostgreSQL 接口的软件，例如标准的 GUI pgAdmin。

但我相信您更关心开发人员的观点。可能最常见的方法是使用PostgreSQL 附带的[libpq库。](http://www.postgresql.org/docs/current/interactive/libpq.html)它有据可查，而且相当稳定。集成到您的软件项目中应该很简单。

如果你正在寻找一个 Objective-C 框架，你可以试试[BaseTen](http://cocoaheads.byu.edu/resources/baseten-framework)。不过没用过那个。

如果您需要更具体的帮助，您必须提出更具体的问题。

# android - Windows 7 上的 PhoneGap Android 模拟器黑屏

> ID：15041284
> 
> 赞同：3
> 
> 时间：2013-02-23T13:56:57.210
> 
> 标签：android, cordova, android-emulator

我正在关注 Phonegap Android 入门指南：[http ://docs.phonegap.com/en/2.4.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android](http://docs.phonegap.com/en/2.4.0/guide_getting-started_android_index.md.html#Getting%20Started%20with%20Android)

经过大量的摆弄，我已经使用以下版本运行了所有东西：Phonegap 2.4 Android SDK 工具 21.1 Android SDK 平台工具 16.0.1 Android SDK 平台 4.2

当我在模拟器中（通过 Eclipse）运行应用程序时，它会启动但会显示闪烁的 Android 徽标。如果我右键单击项目并再次运行，控制台会显示应用程序正在安装和启动。但是，android 标志仍然存在。

控制台日志：

```
[2013-02-21 02:27:16 - testapp] Waiting for HOME ('android.process.acore') to be launched...
[2013-02-21 02:28:04 - testapp] ------------------------------
[2013-02-21 02:28:04 - testapp] Android Launch!
[2013-02-21 02:28:04 - testapp] adb is running normally.
[2013-02-21 02:28:04 - testapp] Performing com.rb.testapp.testapp activity launch
[2013-02-21 02:28:05 - testapp] Automatic Target Mode: using existing emulator 'emulator-5554' running compatible AVD 'test'
[2013-02-21 02:28:05 - testapp] Uploading testapp.apk onto device 'emulator-5554'
[2013-02-21 02:28:45 - testapp] Installing testapp.apk...
[2013-02-21 02:29:04 - testapp] Success!
[2013-02-21 02:29:05 - testapp] Starting activity com.rb.testapp.testapp on device emulator-5554 
```

如果我从命令行 /cordova/run.bat 运行应用程序。模拟器以空白屏幕启动。控制台报告应用程序已安装并正在启动。

我猜我正在运行的模拟器版本有问题。我的 CPU 不支持虚拟化。有没有办法让它运行？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T10:26:43.687

好吧，我自己通过安装 Android SDK 4.0 平台并将其用于我的模拟器来解决这个问题。Aparrently 有一个解决方法（虽然我没有尝试过）：[PhoneGap not fire deviceready on Android 4.2](https://stackoverflow.com/questions/13433656/phonegap-not-firing-deviceready-on-android-4-2)

我在这里记录了我的设置过程：http: [//cookieflow.wordpress.com/2013/02/24/installing-android-4-2-sdk-and-phonegap-2-4-0-on-windows-7/](http://cookieflow.wordpress.com/2013/02/24/installing-android-4-2-sdk-and-phonegap-2-4-0-on-windows-7/)

# php - 需要在我的网页上显示语法突出显示的源代码

> ID：15041285
> 
> 赞同：2
> 
> 时间：2013-02-23T13:56:58.490
> 
> 标签：php, javascript, css

目前我正在一个网站上工作，用户可以在该网站上发布可以包含源代码示例的文本。

有点像stackoverflow上的。我可以在其中输入 javascript 和 php 以及 jquery 和 css 以及许多其他语言，它们将在页面上突出显示语法！:)

像这样：

```
<?php echo "Hello friends";?> 
```

我该如何以最好的方式做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:19:03.673

我相信您正在寻找[Highlight.js](http://softwaremaniacs.org/soft/highlight/en/)；试一试，[设置和使用](http://softwaremaniacs.org/soft/highlight/en/description/)相当简单：

> **基本用法**
> 
> 从您的页面链接库和样式表并将突出显示挂钩到页面加载事件：
> 
> `<link rel="stylesheet" href="styles/default.css">`
> 
> `<script src="highlight.pack.js"></script>` `<script>hljs.initHighlightingOnLoad();</script>`
> 
> 这将突出显示页面上标记为 的所有代码`<pre><code> .. </code></pre>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:09:15.563

看看这个项目：[https ://github.com/igorpan/PHPygmentizator](https://github.com/igorpan/PHPygmentizator)

它是一个 PHP 库，使用[Pygments](http://pygments.org/)突出显示多种语言并支持许多不同的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:16:30.293

使用 php 的 htmlsafe

[http://php.net/manual/en/function.htmlspecialchars.php](http://php.net/manual/en/function.htmlspecialchars.php)

```
<?php
$new = htmlspecialchars("<a href='test'>Test</a>", ENT_QUOTES);
echo $new; // &lt;a          href=&#039;test&#039;&gt;Test&lt;/a&gt;
?> 
```

（我不记得是什么标志了，但是有一个标志可以输出在浏览器中正确呈现的安全 ASCII 版本）然后使用引导代码类 [http://twitter.github.com/bootstrap/base-css .html#代码](http://twitter.github.com/bootstrap/base-css.html#code)

# java - 沙丁鱼 android webdav

> ID：15041287
> 
> 赞同：1
> 
> 时间：2013-02-23T13:57:25.190
> 
> 标签：java, android, webdav, sardine

我对 Android 上的沙丁鱼有一个大问题。我已经下载了适用于 Android 的 Sardine 库并在我的项目中使用它。PUT 和 GET 方法有效，但 LIST 方法无效，我不知道为什么。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
    try {
        Sardine sardine = SardineFactory.begin("username", "password");
        List<DavResource> resources = sardine.list("https://myserver.com/");

        for (DavResource res : resources)
        {
            Log.i("Resources", res.getName());
        }

    } catch (ExceptionInInitializerError e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } catch (NullPointerException e) {
        e.printStackTrace();
    }

} 
```

这是我的程序的 LogCat 控制台：

```
02-23 13:39:50.741: I/Sardine(1797): init
02-23 13:39:50.741: I/Sardine(1797): list
02-23 13:39:51.691: D/dalvikvm(1797): GC_CONCURRENT freed 244K, 13% free 2474K/2844K, paused 14ms+20ms, total 53ms
02-23 13:39:51.902: I/dalvikvm(1797): Could not find method javax.xml.stream.XMLInputFactory.newInstance, referenced from method org.simpleframework.xml.stream.StreamProvider.<init>
02-23 13:39:51.902: W/dalvikvm(1797): VFY: unable to resolve static method 4066: Ljavax/xml/stream/XMLInputFactory;.newInstance ()Ljavax/xml/stream/XMLInputFactory;
02-23 13:39:51.902: D/dalvikvm(1797): VFY: replacing opcode 0x71 at 0x0003
02-23 13:39:51.914: W/dalvikvm(1797): VFY: unable to find class referenced in signature (Ljavax/xml/stream/XMLEventReader;)
02-23 13:39:51.922: W/dalvikvm(1797): VFY: unable to find class referenced in signature (Ljavax/xml/stream/XMLEventReader;)
02-23 13:39:51.934: I/dalvikvm(1797): Could not find method javax.xml.stream.XMLInputFactory.createXMLEventReader, referenced from method org.simpleframework.xml.stream.StreamProvider.provide
02-23 13:39:51.934: W/dalvikvm(1797): VFY: unable to resolve virtual method 4064: Ljavax/xml/stream/XMLInputFactory;.createXMLEventReader (Ljava/io/InputStream;)Ljavax/xml/stream/XMLEventReader;
02-23 13:39:51.934: D/dalvikvm(1797): VFY: replacing opcode 0x6e at 0x0002
02-23 13:39:51.934: I/dalvikvm(1797): Could not find method javax.xml.stream.XMLInputFactory.createXMLEventReader, referenced from method org.simpleframework.xml.stream.StreamProvider.provide
02-23 13:39:51.934: W/dalvikvm(1797): VFY: unable to resolve virtual method 4065: Ljavax/xml/stream/XMLInputFactory;.createXMLEventReader (Ljava/io/Reader;)Ljavax/xml/stream/XMLEventReader;
02-23 13:39:51.934: D/dalvikvm(1797): VFY: replacing opcode 0x6e at 0x0002
02-23 13:39:52.122: D/dalvikvm(1797): GC_CONCURRENT freed 313K, 15% free 2607K/3044K, paused 20ms+8ms, total 69ms
02-23 13:39:52.122: W/System.err(1797): org.simpleframework.xml.core.PersistenceException: Element 'propstat' is already used with @org.simpleframework.xml.Element(data=false, name=, required=true, type=void) on field 'propstat' protected de.aflx.sardine.model.Propstat de.aflx.sardine.model.Response.propstat at line 1
02-23 13:39:52.132: W/System.err(1797):     at org.simpleframework.xml.core.Variable$Adapter.read(Variable.java:484)
02-23 13:39:52.132: W/System.err(1797):     at org.simpleframework.xml.core.Variable$Adapter.read(Variable.java:462)
02-23 13:39:52.132: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readVariable(Composite.java:623)
02-23 13:39:52.132: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readInstance(Composite.java:573)
02-23 13:39:52.132: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readUnion(Composite.java:549)
02-23 13:39:52.132: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readElement(Composite.java:532)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readElements(Composite.java:445)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.access$400(Composite.java:59)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite$Builder.read(Composite.java:1383)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.read(Composite.java:201)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.read(Composite.java:148)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Traverser.read(Traverser.java:92)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.CompositeInlineList.read(CompositeInlineList.java:190)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.CompositeInlineList.read(CompositeInlineList.java:167)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.CompositeInlineList.read(CompositeInlineList.java:124)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readVariable(Composite.java:623)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readInstance(Composite.java:573)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readUnion(Composite.java:549)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readElement(Composite.java:532)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.readElements(Composite.java:445)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.access$400(Composite.java:59)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite$Builder.read(Composite.java:1383)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.read(Composite.java:201)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Composite.read(Composite.java:148)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Traverser.read(Traverser.java:92)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Persister.read(Persister.java:625)
02-23 13:39:52.142: W/System.err(1797):     at org.simpleframework.xml.core.Persister.read(Persister.java:606)
02-23 13:39:52.152: W/System.err(1797):     at org.simpleframework.xml.core.Persister.read(Persister.java:584)
02-23 13:39:52.152: W/System.err(1797):     at org.simpleframework.xml.core.Persister.read(Persister.java:543)
02-23 13:39:52.152: W/System.err(1797):     at de.aflx.sardine.impl.handler.MultiStatusResponseHandler.getMultistatus(MultiStatusResponseHandler.java:69)
02-23 13:39:52.152: W/System.err(1797):     at de.aflx.sardine.impl.handler.MultiStatusResponseHandler.handleResponse(MultiStatusResponseHandler.java:51)
02-23 13:39:52.152: W/System.err(1797):     at de.aflx.sardine.impl.handler.MultiStatusResponseHandler.handleResponse(MultiStatusResponseHandler.java:1)
02-23 13:39:52.152: W/System.err(1797):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:657)
02-23 13:39:52.152: W/System.err(1797):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:627)
02-23 13:39:52.152: W/System.err(1797):     at de.aflx.sardine.impl.SardineImpl.execute(SardineImpl.java:772)
02-23 13:39:52.152: W/System.err(1797):     at de.aflx.sardine.impl.SardineImpl.list(SardineImpl.java:401)
02-23 13:39:52.152: W/System.err(1797):     at de.aflx.sardine.impl.SardineImpl.list(SardineImpl.java:385)
02-23 13:39:52.152: W/System.err(1797):     at com.example.webdav.MainActivity.onCreate(MainActivity.java:32)
02-23 13:39:52.162: W/System.err(1797):     at android.app.Activity.performCreate(Activity.java:5104)
02-23 13:39:52.162: W/System.err(1797):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
02-23 13:39:52.162: W/System.err(1797):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
02-23 13:39:52.162: W/System.err(1797):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-23 13:39:52.162: W/System.err(1797):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
02-23 13:39:52.162: W/System.err(1797):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
02-23 13:39:52.162: W/System.err(1797):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-23 13:39:52.162: W/System.err(1797):     at android.os.Looper.loop(Looper.java:137)
02-23 13:39:52.162: W/System.err(1797):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-23 13:39:52.162: W/System.err(1797):     at java.lang.reflect.Method.invokeNative(Native Method)
02-23 13:39:52.162: W/System.err(1797):     at java.lang.reflect.Method.invoke(Method.java:511)
02-23 13:39:52.162: W/System.err(1797):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-23 13:39:52.162: W/System.err(1797):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-23 13:39:52.162: W/System.err(1797):     at dalvik.system.NativeStart.main(Native Method)
02-23 13:39:52.162: W/System.err(1797): java.lang.NullPointerException
02-23 13:39:52.174: W/System.err(1797):     at de.aflx.sardine.impl.SardineImpl.list(SardineImpl.java:403)
02-23 13:39:52.174: W/System.err(1797):     at de.aflx.sardine.impl.SardineImpl.list(SardineImpl.java:385)
02-23 13:39:52.174: W/System.err(1797):     at com.example.webdav.MainActivity.onCreate(MainActivity.java:32)
02-23 13:39:52.174: W/System.err(1797):     at android.app.Activity.performCreate(Activity.java:5104)
02-23 13:39:52.174: W/System.err(1797):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
02-23 13:39:52.174: W/System.err(1797):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
02-23 13:39:52.174: W/System.err(1797):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-23 13:39:52.174: W/System.err(1797):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
02-23 13:39:52.174: W/System.err(1797):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
02-23 13:39:52.174: W/System.err(1797):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-23 13:39:52.182: W/System.err(1797):     at android.os.Looper.loop(Looper.java:137)
02-23 13:39:52.182: W/System.err(1797):     at android.app.ActivityThread.main(ActivityThread.java:5039)
02-23 13:39:52.182: W/System.err(1797):     at java.lang.reflect.Method.invokeNative(Native Method)
02-23 13:39:52.182: W/System.err(1797):     at java.lang.reflect.Method.invoke(Method.java:511)
02-23 13:39:52.182: W/System.err(1797):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-23 13:39:52.182: W/System.err(1797):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-23 13:39:52.182: W/System.err(1797):     at dalvik.system.NativeStart.main(Native Method) 
```

需要的帮助。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T03:38:50.510

我遇到了类似的错误，我不得不在某些元素上添加 Prop.java 类“(required = false)”。

例子：

```
@Element (required = false)
private Resourcetype resourcetype;
@Element (required = false)
private String creationdate;
@Element (required = false)
private String getlastmodified;
@Element (required = false)
private String getetag;
@Element (required = false)
private String getcontenttype; 
```

在您的情况下，您似乎在 Response.java 和 Propstat.java 中都定义了 propstat。也许将其中一个重命名为“prop”。

# ruby-on-rails - 在 Rails 中删除空的资产文件

> ID：15041288
> 
> 赞同：1
> 
> 时间：2013-02-23T13:57:38.833
> 
> 标签：ruby-on-rails, asset-pipeline

在 Rails 中使用脚手架时，您最终会在**assets**目录下使用占位符 .css/.scss 和 .js/.coffee 文件。除非我在其中添加一些东西，否则它们将保持空白。

我会假设资产管道在编译时会忽略空文件，但是有什么理由我不会全部删除它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:10:49.960

`rails generate scaffold`只是一个帮手。它只是生成了**所有**可能对你有用的东西。

当然，您可以删除所有不需要的文件。如果您不再需要它，您也可以在创建模型或控制器后删除它。

# installation - 我们需要安装什么？

> ID：15041290
> 
> 赞同：0
> 
> 时间：2013-02-23T13:57:50.060
> 
> 标签：installation, concept

这是一个概念性问题，我希望它适合 Stackoverflow 的问答风格。我想知道安装应用程序的概念有什么好处。在我对操作系统的幼稚理解中，我们不需要注册表，要使用应用程序，只需将可执行文件和文件复制到驱动器并启动它就足够了。

我是 Windows 用户，但也使用过一些 Linux，并注意到有包管理器而不是安装程序。但我猜，即使是那些也不仅仅是复制指令。

我不认为所有安装程序的存在只是因为普通用户期望它们出于稳定的习惯。那么，与开发旨在用完单个文件夹并将其复制过来的应用程序相比，安装程序的优势是什么？

我真的很想有人能解释这个概念。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:08:36.797

安装应用程序是将它们嵌入操作系统的一种方式。这是一种标准，您提供安装和卸载等程序，这些程序应该对所有应用程序具有相同的功能（甚至在 Windows 下“更改”）。无数次我“安装”了带有单个 shell 脚本的应用程序，然后在删除这些程序时遇到了麻烦，不得不寻找单个文件。如果程序员使用操作系统的标准来制作可以安装的可执行文件，那将不会发生。您还可以随时轻松查看已安装程序的列表。此外，在 Linux 下，如果我们谈论的是包管理器，用户只需输入其名称即可方便地下载和安装程序。

最后但同样重要的是，某些应用程序需要安装并被操作系统识别（例如 Windows 中的服务）。

# macos - 如何监控进程的任何输入和输出

> ID：15041294
> 
> 赞同：3
> 
> 时间：2013-02-23T13:58:43.320
> 
> 标签：macos, profiling, nfs, dtrace

有以下进程： NetAuthSysAgent 重复调用/创建一个不存在的 NFS 共享的进程 mount_nfs。我有一种预感，这些调用是由另一个给出指令的进程触发的。

因此，我想分析 NetAuthSysAgent，可能使用 dtrace，并查看该进程的所有输入（如 IPC，包括信号、队列、文件、套接字等），并在调用 mount_nfs 之前验证所有读取文件或内存区域过程。

我怎样才能做到这一点？dtrace 是否合适，如果合适，如何？

欢迎任何帮助。即使它只能在 FreeBSD 或 Solaris 上应用/工作，我也可以尝试自己将其适应 OS X。

**更新：**
我一直在使用以下命令，但我只介绍了文件部分：

```
dtrace -q -n syscall::open:entry'{ printf("%-16s %-16s\n",execname,copyinstr(arg0)); }' 
```

上面的命令给了我进程和打开的文件。

```
opensnoop -va -n NetAuthSysAgent 
```

上面的命令是一个调用 DTrace 的脚本，它与前面的命令大致相同，但它被进程 NetAuthSysAgent 过滤并提供了更多信息（例如 UID、PID、FD 等）

# php - 共享锁、排他锁和数据损坏

> ID：15041296
> 
> 赞同：2
> 
> 时间：2013-02-23T13:58:45.403
> 
> 标签：php, locking, corrupt

我的问题是：即使写操作使用排他锁，**在**读取*期间***不能使用**共享锁会导致*写入错误吗？*

 ****假设我想创建一个基于文件的计数器，如下所示：

```
//increment counter by 1
$fp = fopen($path, 'r+b');
if (flock($fp, LOCK_EX)) {

    //read
    fseek($fp, 0, SEEK_END);
    $size = ftell($fp);
    fseek($fp, 0, SEEK_SET);
    if ($size == 0) {
        $counter = 0;
    } else {
        $data = fread($fp, $size);
        $counter = intval($data);
    }

    //do something with data we just read
    $counter ++;

    //write
    fseek($fp, 0, SEEK_SET);
    ftruncate($fp, 0);
    fwrite($fp, $counter);
    fflush($fp);
    flock($fp, LOCK_UN);
    fclose($fp);
} else {
    fclose($fp);
    throw new Exception("Lock failed");
} 
```

现在我想在其他地方展示它：

```
echo intval(file_get_contents($path)); 
```

注意`file_get_contents` **不**使用共享锁。

该代码已被证明在页面负载过重的情况下会损坏数据，即计数器被重置几次回到 0。

我更改了要使用的代码，`fopen`现在`LOCK_SH`看起来还可以，但我无法确认这确实是问题的根源，因为我无法控制负载。使用多个 CLI PHP 实例本地执行上述代码表明代码甚至可以使用`file_get_contents`...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:43:10.133

[ftell](http://php.net/manual/en/function.ftell.php)手册中的注释讨论了以附加模式打开的文件的不可预测行为。也许您可以尝试以只读方式打开文件以进行读取，或者只是读取文件，我不明白为什么您在代码中有一行可以明确地将计数器设置为 0。

```
echo intval(false); //0 
```

EOF 处的 fread 返回 false，因此：

```
$fp = fopen($path, 'r+b');
if (flock($fp, LOCK_EX)) {

    //read
    $data = fread($fp, $size);
    $counter = intval($data);

    //do something with data we just read
    $counter ++;

    //write
    fseek($fp, 0, SEEK_SET);
    ftruncate($fp, 0);
    fwrite($fp, $counter);
    fflush($fp);
    flock($fp, LOCK_UN);
    fclose($fp);
} else {
    fclose($fp);
    throw new Exception("Lock failed");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:39:55.277

...终于，找到了罪魁祸首。我们的生产服务器已`flock`关闭功能，不幸的是我们无法更改它。我想我必须实现自定义锁定机制。

这是由于生产服务器具有 NFS 文件系统和 NFS 上的锁定文件在大多数情况下根本不起作用。****

# jquery - 将选定的 li 元素单击事件绑定到原型函数

> ID：15041297
> 
> 赞同：0
> 
> 时间：2013-02-23T13:59:06.413
> 
> 标签：jquery

# 更新代码修改

我正在尝试扩展 jQuery 插件以添加自定义功能，元素有 ul 并且它有几个 li 元素（li 将由这个插件本身添加），我正在尝试点击 li element html

```
var Fileupload = function (element, options) {
    this.$element = $(element)
    this.$list = this.$element.find("ul li")
}

  Fileupload.prototype = {

    listen: function () {
        $(this.$list).on('click',$.proxy(this.click,this)) // i guess error could be here
  }
    click: function(e){
     this.$img = e.target;
        var test = this.$img;
        if($(test).attr("src"))
        {
            $(test).closest("li").append("<button class='btn btn-mini'>Remove</button>")
        }
  }
} 
```

注意：我正在使用引导文件上传插件，我想维护代码的结构，我不喜欢

```
.find("ul li").click(//my code here} 
```

# asp.net-mvc - 如何在 MVC 中渲染代码

> ID：15041299
> 
> 赞同：0
> 
> 时间：2013-02-23T13:59:14.900
> 
> 标签：asp.net-mvc, razor

我是 ASP.NET 的新手，我不知道如何解决它，我一直在从事主要使用 Webforms 的项目，并且我对如何使用各种东西有一定的了解。

但我坚持这一点：

```
<%= Corina.Corina.Render<ContentPage>(x => x.Description) %> 
```

如何在 MVC 中渲染它？

我试过这个：

```
@{
    Corina.Corina.Render<ContentPage>(x => x.Description);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:08:12.753

如果我了解您的问题，您需要将代码更改为剃刀。你能行的。您在 aspx 引擎中的代码：

```
<%= Corina.Corina.Render<ContentPage>(x => x.Description) %> 
```

剃须刀等效：

```
@(Corina.Corina.Render<ContentPage>(x => x.Description)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:07:41.820

试试这个：

对于 .aspx 视图

```
<%= Model.Description %> 
```

对于愤怒的看法

```
@Html.Raw(Model.Description) 
```

希望这会有所帮助！

# java - 如何将一行从二维数组复制到另一个

> ID：15041300
> 
> 赞同：1
> 
> 时间：2013-02-23T13:59:17.343
> 
> 标签：java, arrays, multidimensional-array

嗨，我有一个大型二维数组 ( `sample[1000][10]`)。我想知道，如何将最后一行（1000）复制到临时二维数组（`temp[1][10]`）中？

编辑：我尝试了以下方法，但我想知道是否有更快的代码：

```
for (int i = 0; i < 10; i++){
temp[0][i] = sample[sample.length - 1][i];
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T14:03:37.580

使用`System.arraycopy`：

```
System.arraycopy(sample[999], 0, temp[0], 0, 10); 
```

# grails - grails loginfilter 块 css

> ID：15041307
> 
> 赞同：0
> 
> 时间：2013-02-23T14:00:07.747
> 
> 标签：grails, grails-filters

我在 grails 中的登录过滤器遇到了一些问题。如果没有会话，它会将我重定向到登录页面，但它会阻止 css。

```
class LoginFilters {
def filters = {
    loginCheck(controller: '*', action: '*') {
        before = {
            println("USER: "+session.user)
            println("ActionName: "+actionName)
            println("Controller: "+controllerName)

            if (session.user == null) {             
                println("Redirecting to Loginpage")
                render(view: '/index');
                return true

            }else{
                return true
            }
        }
    }
} 
```

}

我的问题在哪里？

# php - 如何在php中调用用户注册表单

> ID：15041309
> 
> 赞同：1
> 
> 时间：2013-02-23T14:00:30.737
> 
> 标签：php, forms, joomla, registration

我正在尝试通过带有链接的自定义模块调用默认的 joomla 用户注册表单。我创建了一个弹出框，我想在该弹出框中显示用户登录和用户注册。我只需要表格的电话。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T22:10:31.680

如果您希望能够访问自定义模块，则应将其发布到组件。您可以使用 com_content 和 {loadposition } 代码实现此目的。

将模块放入组件后，您需要找出指向它的链接，它可能是：

[http://example.com/index.php?option=com_content&view=article&id=115](http://example.com/index.php?option=com_content&view=article&id=115)

如果您定义菜单项，则为 sef-url。

要仅调用组件（因此是模块的）输出，请添加

&tmpl=组件

到 url，这将告诉 Joomla 只呈现组件而不是完整的模板

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:31:08.173

您可以使用 JForm 的 getInstance() 方法，其中第一个参数是名称表单（任意），第二个参数是包含表单的 xml 的绝对路径（在 joomla 中，表单是使用 xml 文件创建的）。

```
<?php
    /* @var $form JForm */
    $form = JForm::getInstance('formName', JPATH_BASE . '/components/com_users/models/forms/registration.xml');
    foreach ($form->getFieldset() as $field) {
        echo JText::_($field->label);
        echo $field->input;
    }
?> 
```

希望这可以帮助 ：）

斯托扬

# c++ - Libusb 以及如何在 Ubuntu 中使用它的包

> ID：15041310
> 
> 赞同：5
> 
> 时间：2013-02-23T14:00:39.527
> 
> 标签：c++, c, ubuntu, installation, libusb

我已经使用以下命令安装了 libusb。我不确定它是否正确，命令是

```
sudo apt-get install libusb-dev 
```

安装后（我不确定它是否已安装，因为我是 Ubuntu 的新手用户），我想知道如何使用该库，因为我编写了一些使用 <libusb.h> 的示例代码，但是当我使用编译该 C++ 文件时

```
g++ test_libusb.cpp 
```

引发以下错误，

> test_libusb.cpp:2:20：致命错误：libusb.h：没有此类文件或目录编译终止。

我不知道该怎么办。我在互联网上找不到任何资源来了解这一点......

我想在这里知道两件事：

1.  如何在 C/C++ 中添加 libusb 库以便可以使用 <libusb.h>？
2.  一些示例代码是什么？只需几行即可查看 libusb 是否正常工作...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-10T22:54:00.210

尝试像这样包含它：

```
#include <libusb-1.0/libusb.h> 
```

然后像这样编译它：

```
g++ main.cpp -o main -lusb-1.0 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-23T14:04:16.397

看看[http://packages.debian.org/wheezy/i386/libusb-dev/filelist](http://packages.debian.org/wheezy/i386/libusb-dev/filelist)：您要包含的文件是`usb.h`. 此外，您必须告诉编译器在哪里可以找到已编译的库函数：添加`-lusb`到编译器命令行以使其加载`libusb.so`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-03T21:26:35.087

实际上至少在 Debian 7.4 (wheezy) 中，也可能在 Ubuntu 中，有两个不同的 libusb 包：`libusb-dev`(0.1.12-20+nmu1) 和`libusb-1.0-0-dev`(1.0.11-1)。令人困惑的是，它们可以同时安装并在不同位置提供头文件：

```
$ dpkg -L libusb-dev|grep /usr/include
/usr/include
/usr/include/usb.h
$ dpkg -L libusb-1.0-0-dev|grep /usr/include
/usr/include
/usr/include/libusb-1.0
/usr/include/libusb-1.0/libusb.h 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-02-23T14:04:05.927

试试`#include <usb.h>`。“lib”是Linux命名约定的一部分，即库“foo”有头文件，在Debian包结构中`foo.h`被调用，链接为，编译的库文件被称为和。`libfoo-dev``-lfoo``libfoo.a``libfoo.so`

# android - 哪种方法可以处理 Fragment UI 的外观变化？

> ID：15041312
> 
> 赞同：0
> 
> 时间：2013-02-23T14:00:42.280
> 
> 标签：android, user-interface, android-fragments

基本上，我有一个详细片段列表，每个片段都代表该手机的对等列表。当点击其中一个 DeviceDetails 时，会出现一系列按钮和文本。这些按钮和文本中的哪一个取决于手机的状态；它要么连接到正在使用的电话，要么可以连接。

我目前使用片段的 onCreateView 来显示 3 个按钮。这些按钮中的 1 个应每次出现，另外 2 个根据连接/可用状态交替出现。

我试图找出哪个被覆盖的片段方法应该处理不断变化的 UI。它应该只是 if 语句（或者可能是 switch 语句？）的一种情况，但我不确定将这些放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:45:17.953

好吧，假设您有一个 Activity 并且它托管所有这些 Fragment。

我假设有一些事件触发了这种状态的发生，也许在那个 Activity 中

```
public void onSomeEventThatICareAbout(EventDetails deets) {
    Fragment fragment = getFragmentManager().findFragmentById(R.id.my_fragment_with_buttons);
    if (fragment != null) {
         ((MyButtonsFragment)).disableButtons(deets);
    }
} 
```

基本上只是像对待任何其他组件一样对待片段，并根据正常事件调用它的方法，无论是 onClick()、AsyncTask 回调还是其他什么。只需在片段上调用该函数即可。

定义你自己的方式让你的片段做你想做的事，

```
public void disableButtons(EventDetails deets) {
    View view = getView();
    view.findViewById(R.id.button1).setEnabled(false);
    view.findViewById(R.id.button2).setEnabled(false);
} 
```

# java - 当我使用 JButtons 将静态添加到 arraylist 时，CardLayout 不显示 JButtons

> ID：15041313
> 
> 赞同：1
> 
> 时间：2013-02-23T14:00:44.347
> 
> 标签：java, swing, static, jbutton, cardlayout

我不知道出了什么问题，但这很有趣。我用`CardLayout`和面板编写了代码。在面板上`CardLayout`我放了`JButton`s from`ArrayList`并且它正在工作......

它看起来像这样： ![在此处输入图像描述](../Images/e130a19b18050c3e6fdbcde821bc6a2a.png)

面板`CardLayout`底部带有粉红色`JButton`的s.....我的部分代码是

```
public class Controller extends JPanel {

ArrayList<JButton> tnp=new ArrayList<JButton>();
ArrayList<JButton> sokp=new ArrayList<JButton>();
ArrayList<JButton> alkp=new ArrayList<JButton>();

CardLayout cardlayout=new CardLayout();
JPanel cardpanel = new JPanel(cardlayout); 
```

但是，当我像这样添加静态时`ArrayList`：

```
static ArrayList<JButton> tnp=new ArrayList<JButton>();
static ArrayList<JButton> sokp=new ArrayList<JButton>();
static ArrayList<JButton> alkp=new ArrayList<JButton>(); 
```

我的应用程序看起来像这样：

![在此处输入图像描述](../Images/32e28d223174b9a1e89849484c0782eb.png)

如您所见，程序仍然显示带有 CardLayout 的面板，（边框带有`red`）但 JButtons 来自

```
static ArrayList<JButton> tnp=new ArrayList<JButton>();
static ArrayList<JButton> sokp=new ArrayList<JButton>();
static ArrayList<JButton> alkp=new ArrayList<JButton>(); 
```

丢失！为什么？

我不明白。一个 ArrayList 用于一个带有卡片布局的面板，该面板用于所有 JTabbedPane，并且我想从另一个类访问该列表（这就是我想要静态的原因），以向该面板添加或删除按钮。但我不能，没有任何东西可以添加到该 arraylist 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:30:01.270

静态字段是属于声明它的类的字段。而实例（非静态）字段属于声明它的类的实例。

因此，如果您有以下情况：

```
public class Controller {
    public static List<JButton> staticList = new ArrayList<JButton>();
    public List<JButton> instanceList = new ArrayList<JButton>();

    ...
} 
```

和以下用户代码：

```
Controller c1 = new Controller();
Controller c2 = new Controller(); 
```

每个控制器都有自己的实例列表，但它们都共享一个唯一的静态列表。

您希望每个控制器都有自己的按钮，因此您绝对不想要静态列表。

如果您想从另一个对象访问控制器，您只需将控制器传递给这个其他类实例：

```
Controller c1 = new Controller();
OtherClass other = new OtherClass(c1); 
```

在里面`OtherClass`，你可以用控制器做任何你想做的事情：

```
private Controller theController;

public OtherClass(Controller controller) {
    this.theController = theController;
}

public void foo() {
    // call any method you want from theController
} 
```

# sql - sql查询where条件与日期

> ID：15041316
> 
> 赞同：0
> 
> 时间：2013-02-23T14:01:01.583
> 
> 标签：sql

所以，我在这里有这个查询：

```
$strSQL = "SELECT formas.*, SMS_SERVISI.IDTICKET, SMS_SERVISI.MBYLLUR,SMS_SERVISI.time_added,servis_furnitor.id_servis,servis_furnitor.furnitori,servis_furnitor.kohezgjatja
FROM formas  
LEFT JOIN servis_furnitor ON formas.furnitori = servis_furnitor.id_servis 
LEFT JOIN SMS_SERVISI ON formas.ID = SMS_SERVISI.IDTICKET 
ORDER BY formas.id DESC 
WHERE $today-formas.data_fillim > servis_furnitor.kohezgjatja"; 
```

我知道最后一行是错误的，我的意思是我到那里还好.. 我有这个订单，他们有一个开始日期， `formas.data_fillim`我有今天的日期：

```
$today = date("Ymd"); 
```

所以两者之间的差异 `$today-formas.data_fillim`不应该大于`servis_furnitor.kohezgjatja`整数本身，它显示天数

```
formas.data_fillim 
```

是一个日期类型..

我需要提取与今天日期和开始日期的差异不大于“kohezgjatja”中预定义的天数的所有数据

请任何帮助..谢谢

更新

```
$today = date("Y-m-d H:i:s", time());  

echo $strSQL = "SELECT  formas.*,
        SMS_SERVISI.IDTICKET,
        SMS_SERVISI.MBYLLUR,
        SMS_SERVISI.time_added,
        servis_furnitor.id_servis,
        servis_furnitor.furnitori,
        servis_furnitor.kohezgjatja
FROM formas
LEFT JOIN servis_furnitor
        ON formas.furnitori = servis_furnitor.id_servis
LEFT JOIN SMS_SERVISI
        ON formas.ID = SMS_SERVISI.IDTICKET
WHERE DATEDIFF ( day , '$today' , formas.data_fillim ) > servis_furnitor.kohezgjatja
ORDER BY formas.id DESC" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:05:37.500

声明的正确格式`SELECT`是

```
SELECT ....
FROM...
WHERE ...
GROUP ....
ORDER BY... 
```

所以在你的情况下，

```
SELECT  formas.*,
        SMS_SERVISI.IDTICKET,
        SMS_SERVISI.MBYLLUR,
        SMS_SERVISI.time_added,
        servis_furnitor.id_servis,
        servis_furnitor.furnitori,
        servis_furnitor.kohezgjatja
FROM formas
LEFT JOIN servis_furnitor
        ON formas.furnitori = servis_furnitor.id_servis
LEFT JOIN SMS_SERVISI
        ON formas.ID = SMS_SERVISI.IDTICKET
WHERE DATEDIFF ( day , $TODAY , formas.data_fillim )  > servis_furnitor.kohezgjatja
ORDER BY formas.id DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:14:35.863

像这样的东西应该工作：

```
where formas.data_fillim <= DateAdd(day, servis_furnitor.kohezgjatja, getdate()) 
```

您可能需要在 servis_furnitor.kohezgjatja 前面加上一个减号，具体取决于您在那里存储的内容。

# android - Android 从 Textview 中的 JSONArray 解析 url 并使其可点击

> ID：15041319
> 
> 赞同：0
> 
> 时间：2013-02-23T14:01:55.533
> 
> 标签：android, json, hyperlink, clickable

我目前正在我的 android 应用程序中解析 JSON（请注意，我对这些东西很陌生；android 和 JSON）。现在我得到了一个 JSONObject，在这个对象内部有一个带有链接（字符串）的 JSONArray。我想将这些链接放在 Textview 内的数组中，并使它们也可点击。

使用 Log.wi 可以检索以下输出：

```
<a href="http://xxxx.xx/xxxx/test.xlsx">test.xlsx</a> 
```

该 URL 似乎有效，但我试图使它们成为链接的一切似乎都失败了。这是我用来检索链接的代码：

```
ArrayList<String> map; //note it's already filled and contains strings like the example
sb = new StringBuilder("Items in map:\n\n");
    for(int i=0;i<map.size();i++){
        sb.append(Html.fromHtml("&#8226; " + map.get(i) + "<br/>"));
    } 
```

现在我将字符串生成器“清空”到我的 TextView 中：

```
 TextView overView= (TextView)findViewById(R.id.textOverView);
    overView.setText(sb.toString());
    //make links clickable?
    overView.setMovementMethod(LinkMovementMethod.getInstance()); 
```

我也尝试过使用 Linkify、android:clickable 属性、url 编码器等等，但不幸的是似乎没有任何效果。如果我删除 setMoveMent 方法，链接甚至都不是蓝色的（更不用说可点击了），所有其他方法也是如此。

欢迎任何想法！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:56:27.917

`MovementMethod`使链接可点击和可选择。但是您需要`ClickableSpan`先将实例附加到您的文本中，这样`MovementMethod`才能工作。这是通过`Linkify`并且`MovementMethod`只是为了可以在大量文本中选择它。我想你要的是这个，

```
android:autoLink="all"
android:linksClickable="true" 
```

这只是让 textview 链接它识别的所有链接与`ClickableSpan`实例并设置正确的`MovementMethod`.

# php - EAN Expedia 酒店信息 URL 服务未找到

> ID：15041320
> 
> 赞同：0
> 
> 时间：2013-02-23T14:01:57.737
> 
> 标签：php, xml, api

我一直在这里和谷歌寻找答案，但似乎没有一个明确的答案，这是我在 StackOverflow 上的第一篇文章，但多年来一直是常客，我从这个网站学到了很多东西，所以谢谢！

我的问题是 Expedia 关于酒店信息的 API：http: [//developer.ean.com/docs/read/hotel_info/examples/XML_Default_Content](http://developer.ean.com/docs/read/hotel_info/examples/XML_Default_Content)

我有问题的网址是：
[http](http://api.ean.com/ean) : //api.ean.com/ean ‑services/rs/hotel/v3/info?cid=55505&minorRev=1&apiKey=9kxdnz8ngbf7gmwkzm4qkgjw&customerSessionId=0ABAA850-419E-A913-D072-4A24A390607C&customerUserAgent=Mozilla/5.0（Macintosh ; Intel Mac OS X 10.8; rv:19.0) Gecko/20100101 Firefox/19.0&customerIpAddress=2.50.181.154&locale=en_UScurrencyCode=USD&xml=1175480

我收到“596 未找到服务”错误。

如果以前有人问过这个问题，我深表歉意，非常感谢您的帮助！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T18:23:05.450

EAN 开发人员中心中用于发出[酒店信息请求](http://developer.ean.com/docs/hotel_info/examples/XML_Default_Content)的示例已得到修复。

问题：

```
http://api.ean.com/ean&#8209;services/rs/hotel/v3/info? 
```

解决方案：

```
http://api.ean.com/ean&#45;services/rs/hotel/v3/info? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T18:25:06.213

You also didn't enter the xml parameter correctly. It should have been like this:

```
http://api.ean.com/ean-services/rs/hotel/v3/info?cid=55505&minorRev=1&apiKey=9kxdnz8ngbf7gmwkzm4qkgjw&customerUserAgent=Mozilla/5.0 (Macintosh; Intel Mac 0OS X 10.8; rv:19.0) Gecko/20100101 Firefox/19.0&customerIpAddress=2.50.181.154&locale=en_US&currencyCode=USD&xml=<HotelInformationRequest>
  <hotelId>122212</hotelId>
  <options>0</options>
</HotelInformationRequest> 
```

You could just forget about using xml and use the REST format:

```
http://api.ean.com/ean-services/rs/hotel/v3/info?cid=55505&minorRev=1&apiKey=9kxdnz8ngbf7gmwkzm4qkgjw&customerUserAgent=Mozilla/5.0 (Macintosh; Intel Mac 0OS X 10.8; rv:19.0) Gecko/20100101 Firefox/19.0&customerIpAddress=2.50.181.154&locale=en_US&currencyCode=USD&hotelId=122212&options=0 
```

By the way, I just found a SDK for Android from Expedia Affiliate Network. [https://github.com/ExpediaInc/ean-android](https://github.com/ExpediaInc/ean-android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-03T07:45:57.603

你可以试试这个它工作得很好。

```
http://api.ean.com/ean-services/rs/hotel/v3/info?cid=55505&minorRev=1&apiKey=9kxdnz8ngbf7gmwkzm4qkgjw&customerSessionId=&customerUserAgent=Mozilla/5.0%20%28Macintosh;%20Intel%20Mac%20OS%20X%2010.8;%20rv:19.0%29%20Gecko/20100101%20Firefox/19.0&customerIpAddress=&locale=en_UScurrencyCode=USD 
```

您可以将此 xml 添加到您的代码中

**`&xml=<HotelInfo><hotelId>407696</hotelId><city></city><options>DEFAULT</options></HotelInfo>`**

# python - 如何通过线程将队列引用传递给另一个文件中的函数

> ID：15041321
> 
> 赞同：1
> 
> 时间：2013-02-23T14:01:59.250
> 
> 标签：python, multithreading, import, queue

在 importreftest.py

```
import importreftest2
import Queue
import threading

q= Queue.Queue(maxsize=0)

q.put(1)
q.put(2)
q.put("hello")

print "here"

t = threading.Thread(target = importreftest2.trythis, args = q)
t.start() 
```

在 importreftest2.py

```
def trythis(q):
    print "trythis"
    while True:
        if not q.empty():
            print q.get() 
```

运行 importreftest.py 时不会打印“trythis”，队列中也没有任何内容

# c - 如何处理 VFP 中的双指针以调用基于 c 的 DLL

> ID：15041322
> 
> 赞同：1
> 
> 时间：2013-02-23T14:02:00.880
> 
> 标签：c, pointers, dll, visual-foxpro

如何处理 VFP 中的双指针以调用基于 c 的 DLL

我有 ac 语言 DLL，它具有如下所示的双指针参数

```
int fun_foo(char *str1,char **str2)  //str2 has some info. when returns from function 
```

在 FoxPro 中，我试图从它的 DLL 中调用这个函数。我怎么能这样称呼它；我试过：

```
DECLARE INT fun_foo IN sample.dll STRING,STRING @ 
```

我发现 char* 可以与字符串参数一起传递，但我在双指针 string@ 不起作用时遇到了困难。谁能给出线索如何在 Visual foxpro 中为 c 函数（DLL）中的双指针参数传递参数

我从这个双指针中的函数获得的数据对我来说很重要

我正在使用 Visual FoxPro 9.0 SP1，DLL 是在 Visual c++ 2005 上制作的 32 位

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:41:19.843

**简短的回答：**

使用 vfp2c32.fll

[http://vfpx.codeplex.com/releases/view/71594](http://vfpx.codeplex.com/releases/view/71594)

从帮助文件：

ReadPointer 从指定地址检索指针。

**长答案：**

如果您只想使用 VFP，请检查 SYS(2600)、BINTOC、CTOBIN 和 strncpy（最后一个位于 c 运行时中，无论如何您都需要它来运行 VFP 可执行文件。）

```
DECLARE INTEGER fun_foo IN sample.dll ;
STRING str1,;
INTEGER @pointer

m.str1 = "sometext"
m.pointer = 0

m.result = fun_foo(m.str2, @m.pointer) 
```

现在那个指针是什么？你不说。NUL 终止的字符串？使用 strncpy。一个 INT 或一些固定长度的字符串？使用系统（2600）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:09:11.783

我不知道它可以从 Foxpro 本身完成，但也许你可以（如果你精通 C）在 C 中创建一个中间 ActiveX 对象等，它取消引用你的双指针，并将其返回给 VFP？

# silverlight - 正确处置 RX 订阅

> ID：15041327
> 
> 赞同：1
> 
> 时间：2013-02-23T14:02:33.033
> 
> 标签：silverlight, system.reactive

我是 Reactive Extensions 的新手，这就是我想出的做弹出烤面包机通知的方法。当鼠标经过烤面包机时，不透明度恢复到 100%。否则，它会逐渐淡出。

该代码有效，但我并不完全确信我没有泄漏资源，尤其是在 mouseOut 订阅中。此外，我不确定这是否是实现此功能的最佳方式。

任何批评，提示将不胜感激。

```
 private void rxPop()
    {
        Rectangle toaster = (Rectangle)this.FindName("toaster1");
        Thickness newToasterPosition = new Thickness(
             toaster.Margin.Left, toaster.Margin.Top,
             toaster.Margin.Right, toaster.Margin.Bottom + toaster.Height);

        /* Animations */
        Storyboard slideInAnimation = slide(toaster,
            newToasterPosition,
            TimeSpan.FromMilliseconds(450));

        Storyboard fadeInAnimation = animateOpacity(toaster, 1.0, TimeSpan.FromMilliseconds(150));

        Storyboard fadeOutAnimation = animateOpacity(toaster, 0.0, TimeSpan.FromSeconds(3));

        /* Events */
        var mouseEnter = Observable.FromEventPattern<MouseEventHandler, MouseEventArgs>
            (h => toaster.MouseEnter += h,
             h => toaster.MouseEnter -= h);

        var mouseOut = Observable.FromEventPattern<MouseEventHandler, MouseEventArgs>
            (h => toaster.MouseLeave += h,
             h => toaster.MouseLeave -= h);

        var slideInCompleted = Observable.FromEventPattern<EventHandler, EventArgs>(
            h => slideInAnimation.Completed += h,
            h => slideInAnimation.Completed -= h);

        var fadeOutCompleted = Observable.FromEventPattern<EventHandler, EventArgs>(
            h => fadeOutAnimation.Completed += h,
            h => fadeOutAnimation.Completed -= h);

        // slideIn then fadeOut 
        slideInCompleted.Subscribe(e => fadeOutAnimation.Begin());

        var mouseEnterSubscription = mouseEnter
            .ObserveOnDispatcher()
            .Do(a =>
                {
                    fadeOutAnimation.Pause();
                    fadeInAnimation.Begin();
                    slideInAnimation.Pause();
                    mouseOut.Do(
                        b =>
                        {
                            fadeOutAnimation.Begin();
                            fadeInAnimation.Stop();
                            slideInAnimation.Resume();
                        }).Subscribe();
                })
            .Subscribe();

        fadeOutCompleted.Subscribe((e) => mouseEnterSubscription.Dispose());

        slideInAnimation.Begin();
    } 
```

理想情况下，我希望以下列方式表达这些事件：

```
 slideIn then fadeOut
   unless mouseEnter 
        then fadeIn , slideIn.Pause
        until mouseLeave 
           then fadeOut.Begin and slideIn.Resume 
```

在 RX 中最接近的方法是什么？

**更新 #1** **更新 #2* *（清理订阅（））

这是一个有点干净的尝试。

```
protected CompositeDisposable _disposables = new CompositeDisposable();

private void rxPop()
{

IDisposable mouseEnterSubscription = null;

/* Business logic: slideIn then fadeOut then remove from visual tree */
_disposables.Add(
  slideInAnimation
    .BeginUntilDone()
    .Select(slideInCompletedEvent =>
        fadeOutAnimation.BeginUntilDone())
    .Switch()
    .Subscribe(fadeOutAnimationCompletedEvent =>
    {
        mouseEnterSubscription.Dispose();

        // remove from visual tree
        (toaster.Parent as Panel).Children.Remove(toaster);
    }));

/* Business logic: mouseEnter/mouseLeave should pause/restart animations */
mouseEnterSubscription = mouseEnter
    .ObserveOnDispatcher()
    .Do(mouseEnterEventArgs =>
    {
        fadeOutAnimation.Pause();
        fadeInAnimation.Begin();
        slideInAnimation.Pause();
    })
    .Select(e => mouseOut)
    .Switch()
    .Do(mouseLeaveEventArgs =>
    {
        fadeOutAnimation.Begin();
        fadeInAnimation.Stop();
        slideInAnimation.Resume();
    })
    .Subscribe();

}

public static class RxExtensions
{
    public static IObservable<EventPattern<EventArgs>> BeginUntilDone(this Storyboard sb)
    {
        var tmp = Observable.FromEventPattern(
            h => sb.Completed += h,
            h => sb.Completed -= h);
        sb.Begin();
        return tmp;
    }
} 
```

我的问题是：

1.  ObserveOnDispatcher() 是否正确完成？

2.  Switch() 是否为我处理了以前的 IObservable？

3.  我很难将以上内容翻译成 LINQ 查询语法

    ```
     /* Business Logic */
        var showToast =
            // Start by sliding in
            from slideInComplete in slideIn.BeginObservable()
            where slideInComplete
            // Then in parallel, fadeOut as well as wait for mouseEnter
            from fadeOutComplete in fadeOut.BeginObservable()
            from enter in mouseEnter
            // ... I'm lost here.
            // ... how do I express 
            // ..... mouseEnter should pause fadeOut?
            select new Unit(); 
    ```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-26T06:30:21.570

好吧，首先，您`IDisposables`到处都在泄漏-这些`Subscribe`调用中的每一个都返回一个`IDisposable`，它只是超出了范围，没有被正确处理。然而，这部分很容易修复，使用`IDisposable`Rx 库中的一些容器：

（我在您的示例代码周围拼凑的测试工具的片段）

```
// new fields

// A serial disposable lets you wrap one disposable
// such that changing the wrapped disposable autocalls
// Dispose on the previous disposable
protected SerialDisposable _resubscriber;

// A composite disposable lets you track/dispose a whole
// bunch of disposables at once
protected CompositeDisposable _disposables;

// no real need to do this here, but might as well
protected void InitializeComponent()
{
    _disposables = new CompositeDisposable();
    _resubscriber = new SerialDisposable();
    // misc
    this.Unloaded += (o,e) => 
    {
        if(_disposables != null) _disposables.Dispose();
        if(_resubscriber != null) _resubscriber.Dispose();
    }; 
```

然后稍后在您的查询中，将所有`Subscribe`调用（除了一个，见下文）包装成如下所示：

```
 // slideIn then fadeOut 
    _disposables.Add(slideInCompleted.Subscribe(e => fadeOutAnimation.Begin())); 
```

一个例外是`MouseOut`“取消者”：

```
 .Do(a =>
            {
                fadeOutAnimation.Pause();
                fadeInAnimation.Begin();
                slideInAnimation.Pause();
                _resubscriber.Disposable = mouseOut.Do(
                    b =>
                    {
                        fadeOutAnimation.Begin();
                        fadeInAnimation.Stop();
                        slideInAnimation.Resume();
                    }).Subscribe();
            }) 
```

现在......至于这个：

```
slideIn then fadeOut
unless mouseEnter 
    then fadeIn , slideIn.Pause
    until mouseLeave 
        then fadeOut.Begin and slideIn.Resume 
```

我必须考虑一下...我认为还有更多... *rx*的方法，但我必须考虑一下。一定要进行`IDisposable`清理，寿！

（如果我能想出第二点的话，我会编辑这个）

编辑：哦，我想我有一些有希望的东西......

首先，让我们想办法将`Storyboard`start/completes 转换为`IObservable`：

```
public static class Ext
{
    public static IObservable<bool> BeginObservable(this Storyboard animation)
    {
        var sub = new BehaviorSubject<bool>(false);
        var onComplete = Observable.FromEventPattern<EventHandler, EventArgs>(
            h => animation.Completed += h,
            h => animation.Completed -= h);

        IDisposable subscription = null;
        subscription = onComplete.Subscribe(e => 
        {
            Console.WriteLine("Animation {0} complete!", animation.Name);
            sub.OnNext(true);
            if(subscription != null)
                subscription.Dispose();
        });

        Console.WriteLine("Starting animation {0}...", animation.Name);
        animation.Begin();
        return sub;
    }
} 
```

基本上，这设置了一个“开始动画，并`true`在它完成时向我们发出信号”序列......到了好的部分！

因此，假设您已经`Storyboards`定义了以下内容：

*   `fadeIn`: 动画`Opacity`到 1.0
*   `fadeOut`: 动画`Opacity`到 1.0
*   `slideIn`: 动画`Margin`到“in”值
*   `slideOut`: 动画`Margin`到“out”值

还有这些 observables（代码中的轻微名称调整）：

*   `mouseEnter`: =>`MouseEnter`事件
*   `mouseOut`: =>`MouseLeave`事件

因此，您可以设置一个`IObservable`携带实际序列的：

```
var showToast = 
    // Start this mess on a "mouse enter" event
    from enter in mouseEnter
    // Start (in parallel) and wait until the fadeIn/slideIn complete
    from fadeInComplete in fadeIn.BeginObservable()
    from slideInComplete in slideIn.BeginObservable()
    where fadeInComplete && slideInComplete
    // Until you see a "mouse out" event
    from exit in mouseOut
    // Then start (in parallel) and wait until the fadeOut/slideOut complete
    from fadeOutComplete in fadeOut.BeginObservable()
    from slideOutComplete in slideOut.BeginObservable()
    where fadeOutComplete && slideOutComplete
    // And finally signal that this sequence is done
    // (we gotta select something, but we don't care what, 
    // so we'll select the equivalent of "nothing" in Rx speak)
    select new Unit(); 
```

编辑编辑：这是我使用的完整测试台，也许你可以移植到你的需要：

```
void Main()
{
    var window = new Window();
    var control = new MyControl();
    window.Content = control;
    window.Show();
}

public class MyControl : UserControl
{
    protected DockPanel _root;
    protected Rectangle _toaster;
    protected CompositeDisposable _disposables;
    protected Thickness _defaultToasterPosition = new Thickness(10, -60, 10, 10);

    public MyControl()
    {
        this.InitializeComponent();
    }

    protected void InitializeComponent()
    {
        _disposables = new CompositeDisposable();
        _root = new DockPanel();
        _toaster = new Rectangle();
        _toaster.SetValue(Rectangle.NameProperty, "toaster1");
        _toaster.Fill = Brushes.Red;
        _toaster.Stroke = Brushes.Black;
        _toaster.StrokeThickness = 3;
        _toaster.Width = 50;
        _toaster.Height = 50;
        _toaster.Opacity = 0.1;
        DockPanel.SetDock(_toaster, Dock.Bottom);
        _toaster.Margin = _defaultToasterPosition;
        rxPop();

        _root.Children.Add(_toaster);        
        this.Content = _root;

        this.Unloaded += (o,e) => 
        {
            if(_disposables != null) _disposables.Dispose();
        };
    }

    private void rxPop()
    {
        var toaster = (Rectangle)this.FindName("toaster1") ?? _toaster;
        var defaultToasterPosition = toaster.Margin;
        var newToasterPosition = new Thickness(
             defaultToasterPosition.Left, defaultToasterPosition.Top,
             defaultToasterPosition.Right, defaultToasterPosition.Bottom + toaster.Height);

        /* Animations */
        var slideIn = slide(toaster, newToasterPosition, TimeSpan.FromMilliseconds(450));
        var slideOut = slide(toaster, defaultToasterPosition, TimeSpan.FromMilliseconds(450));

        var fadeIn = animateOpacity(toaster, 1.0, TimeSpan.FromMilliseconds(150));
        var fadeOut = animateOpacity(toaster, 0.1, TimeSpan.FromSeconds(3));

        /* Events */
        var mouseEnter = Observable.FromEventPattern<MouseEventHandler, MouseEventArgs>
            (h => toaster.MouseEnter += h,
             h => toaster.MouseEnter -= h);

        var mouseOut = Observable.FromEventPattern<MouseEventHandler, MouseEventArgs>
            (h => toaster.MouseLeave += h,
             h => toaster.MouseLeave -= h);

        var showToast = 
            // Start this mess on a "mouse enter" event
            from enter in mouseEnter
            // Start (in parallel) and wait until the fadeIn/slideIn complete
            from fadeInComplete in fadeIn.BeginObservable()
            from slideInComplete in slideIn.BeginObservable()
            where fadeInComplete && slideInComplete
            // Until you see a "mouse out" event
            from exit in mouseOut
            // Then start (in parallel) and wait until the fadeOut/slideOut complete
            from fadeOutComplete in fadeOut.BeginObservable()
            from slideOutComplete in slideOut.BeginObservable()
            where fadeOutComplete && slideOutComplete
            // And finally signal that this sequence is done
            // (we gotta select something, but we don't care what, 
            // so we'll select the equivalent of "nothing" in Rx speak)
            select new Unit();

        _disposables.Add(showToast.Subscribe());
    }

    private Storyboard slide(Rectangle rect, Thickness newPosition, TimeSpan inTime)
    {
        var sb = new Storyboard();
        sb.Duration = inTime;
        Storyboard.SetTarget(sb, rect);        
        Storyboard.SetTargetProperty(sb, new PropertyPath(Rectangle.MarginProperty));
        var path = new ThicknessAnimation(newPosition, inTime);
        sb.Children.Add(path);
        return sb;
    }

    private Storyboard animateOpacity(Rectangle rect, double newOpacity, TimeSpan inTime)
    {
        var sb = new Storyboard();
        sb.Duration = inTime;
        Storyboard.SetTarget(sb, rect);        
        Storyboard.SetTargetProperty(sb, new PropertyPath(Rectangle.OpacityProperty));
        var path = new DoubleAnimation(newOpacity, inTime);
        sb.Children.Add(path);
        return sb;
    }
}

public static class Ext
{
    public static IObservable<bool> BeginObservable(this Storyboard animation)
    {
        var sub = new BehaviorSubject<bool>(false);
        var onComplete = Observable.FromEventPattern<EventHandler, EventArgs>(
            h => animation.Completed += h,
            h => animation.Completed -= h);

        IDisposable subscription = null;
        subscription = onComplete.Subscribe(e => 
        {
            Console.WriteLine("Animation {0} complete!", animation.Name);
            sub.OnNext(true);
            if(subscription != null)
                subscription.Dispose();
        });

        Console.WriteLine("Starting animation {0}...", animation.Name);
        animation.Begin();
        return sub;
    }
} 
```

# ruby - 如何使用 Ruby 将阿拉伯/波斯数字翻译成英文？

> ID：15041329
> 
> 赞同：1
> 
> 时间：2013-02-23T14:02:54.160
> 
> 标签：ruby, encoding, localization, type-conversion, arabic

如何将一些具有阿拉伯/波斯数字的字符串转换为英文？

就像我有：

```
str1 = "١۲١۲"
str2 = "12١۲"
str3 = "some string that contains persian digits like ١۲" 
```

是否有任何函数可以将其编码为英文，如果字符串包含这样的数字以将其转换为最终结果将是：

```
str1 = "1212"
str2 = "1212"
str3 = "some string that contains persian digits like 12" 
```

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T20:02:55.227

对于这些一对一的转换，[tr](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-tr)方法非常方便快捷。它有一个变异的对应物`tr!`

```
#encoding: utf-8

str1 = "١۲١۲"
str2 = "12١۲"
str3 = "some string that contains persian digits like ١۲"

[str1, str2, str3].each{|str| str.tr!('۰١۲۳۴۵۶۷۸۹','0123456789')}

p str1, str2, str3
#"1212"
#"1212"
#"some string that contains persian digits like 12" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T14:49:34.480

由于这不是编码而是翻译，并且假设您的问题仅限于那些数字（0-9），您可以编写一个简单的从阿拉伯语到英语的一对一映射，如下所示：

```
 arabic_to_english = {
  '٩' => 9,
  '٨' => 8,
  '٧' => 7,
  '٦' => 6,
  '٥' => 5,
  '٤' => 4,
  '٣' => 3,
  '٢' => 2,
  '١' => 1,
  '٠' => 0
} 
```

您只需在需要时调用哈希：

```
 arabic_to_english['٧'] 
```

当然，如果您将其提取到函数中会更好。

# security - 安全地将用户身份验证为第三方

> ID：15041331
> 
> 赞同：1
> 
> 时间：2013-02-23T14:03:04.893
> 
> 标签：security, authentication

假设我正在编写一个程序或应用程序，要求我代表他们对用户进行身份验证，即要求用户提供他们的凭据以登录网站或检索和处理数据。

我怎样才能以保证用户安全的方式做这样的事情，最好是这样我什至根本看不到他们提供的凭据。如果这是不可能的，如何确保用户的隐私和安全不会以任何方式受到损害。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:13:01.110

最简单但可能对您没有用的答案是：

您不能保证隐私和安全不受影响！作为服务器上的管理员，如果您接收并存储用户凭据，您就可以访问它们。

[不可变的安全法则#6：只有管理员值得信赖，计算机才是安全的](https://security.meta.stackexchange.com/a/988/485)

所以考虑一下你会接受什么样的安全级别。

您可以使用 OpenID 之类的东西，就像 StackExchange 使用的一样 - 它从他们的职责中删除了身份验证部分。只有 OpenID 提供者接收凭据 - SE 只是从他们那里获取令牌。

# position - JavaFX SplitPane 分隔符位置不一致的行为

> ID：15041332
> 
> 赞同：2
> 
> 时间：2013-02-23T14:03:09.560
> 
> 标签：position, javafx, divider, splitpane

我有两个 StackPane (pane1 & pane2) 显示在 SplitPane (splitPane) 中。SplitPane 的分隔线位置在构建器中设置为 .3。第二个 StackPane (pane2) 包含一个 Button，它还将 SplitPane 的分隔符位置设置为 0.3。

在其他条件不变的情况下，预期的行为将是两种操作（在构建器中设置分隔线位置并通过操作设置分隔线位置）要么工作要么不工作。

然而，只有后者真正有效。

SplitPane 的构造和 Button 的 onAction 之间有什么变化。是什么阻碍了分隔线在构建器中的放置？

```
 StackPane pane1 = new StackPane();
    StackPane pane2 = new StackPane();

    final SplitPane splitPane = SplitPaneBuilder.create()
            .items(pane1, pane2)
            // Environment A
            .dividerPositions(new double[] {.3}) // splitPane.setDividerPosition(s)(...), etc. yield same result 
            .orientation(Orientation.HORIZONTAL)
            .build();

    // The following line influences environment A outcome, though it does not fix the issue
    SplitPane.setResizableWithParent(pane1, false);

    pane2.getChildren().add(ButtonBuilder.create()
            .text("Divider Position")
            .onAction(new EventHandler<ActionEvent>() {
                @Override
                public void handle(ActionEvent event) {
                    // Environment B
                    splitPane.setDividerPositions(.3);
                }
            })
            .build());

    Scene primaryScene = SceneBuilder.create()
            .root(splitPane)
            .build();

    primaryStage.setScene(primaryScene);
    primaryStage.setTitle("Name");
    primaryStage.setWidth(500);
    primaryStage.setHeight(500);
    primaryStage.show(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T14:51:30.800

我对拆分窗格的位置有疑问，它似乎与您的相似。这里是：我有一个选项卡，每当我添加一个新选项卡时，我都会从一个 fxml 加载选项卡的内容，其中存在一个拆分窗格，分隔线位置固定为 0.8。

加载第一个选项卡时，就可以了，分隔线位于 0.8 处。当我通过 fxml 添加第二个选项卡时，与第一个选项卡完全相同，第二个选项卡中拆分窗格的位置为 0.5，即默认值。

在加载选项卡的内容后，我尝试使用`setDividerPositions`方法以编程方式设置分隔线位置，但它不起作用。然后就像你的情况一样，如果我将`setDividerPositions`调用放在 onAction 方法中，它会成功设置分隔符位置。

正如我所说，我的问题与您的问题不完全相同，但似乎相似。所以我不确定，但希望我的工作能帮助你：在我的情况下，`setDividerPositions`拨打电话`Platform.runLater`就可以了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-01T11:29:03.803

因此，感谢 Oracle 支持论坛中的 James D，这是完整的答案：

“问题似乎是场景的大小小于其窗口的大小。这会在第一次显示窗口时导致额外的布局传递；第二次布局传递算作“窗口调整大小”，因此拆分的分隔符位置窗格在此通行证中不受尊重。” （[https://forums.oracle.com/forums/thread.jspa?threadID=2503701](https://forums.oracle.com/forums/thread.jspa?threadID=2503701)）

**解决方法 1**

设置`Scene`' 大小而不是`Stage`' 大小：

```
Scene primaryScene = SceneBuilder.create()
        .root(splitPane)
        .width(500)
        .height(500)
        .build();

primaryStage.setScene(primaryScene);
primaryStage.setTitle("Name");
primaryStage.show(); 
```

**解决方法 2**

正如斋月正确指出的那样，另一种解决方案是将分隔线位置设置为`Platform.runLater(...)`.

**跟进**

我在 jira ( [http://javafx-jira.kenai.com/browse/RT-28607](http://javafx-jira.kenai.com/browse/RT-28607) ) 提交了一个错误，参考了原始错误报告 ( [http://javafx-jira.kenai.com/browse/RT-17229](http://javafx-jira.kenai.com/browse/RT-17229) ) 已被标记为“无法解决”。我想最终的解决方案是提供分隔线绝对定位的方法。

# dynamics-crm-2011 - 用于编辑 MS CRM 自定义 xml 的用户友好工具

> ID：15041333
> 
> 赞同：1
> 
> 时间：2013-02-23T14:03:10.073
> 
> 标签：dynamics-crm-2011, dynamics-crm

我需要在 MS CRM 定制中进行大量修改。其中一些自定义可以在 Web 界面中进行，其中一些需要在普通自定义 XML 文件中被破解。

更重要的是，我不是做出更改的人：所以我需要将这些更改合并，这些更改由一个人在 Web 界面中完成，另一个人在平面 XML 中完成。但是 MS CRM 会自动生成相当大且可读性很强的自定义文件，其中无法理解哪些更改属于什么。

有什么工具可以让这个编辑变得更容易一些吗？也许有人已经面临这样的问题并有自己的解决方案？也许转换为 YAML 或 JSON，编辑然后转换回来？

有什么最佳实践吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T08:50:50.903

其实，是有答案的。来自微软本身：

[使用 SolutionPackager 工具压缩和提取解决方案文件](http://msdn.microsoft.com/en-us/library/jj602987.aspx)

该工具作为标准[MS Dynamics CRM SDK](http://www.microsoft.com/en-us/download/details.aspx?id=24004)的一部分提供，使开发人员能够将自定义文件拆分为多个部分，然后再将其组合回来。

但是，坦率地说，在 MS Dynamics CRM 2011 Rollup 10 SDK 上它被破坏了：在某些情况下，它无法拆分解决方案，并且**在所有情况下都无法将它们组合回来**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T19:19:29.533

那么每个人都不会将他们的定制加载到 CRM 中来测试它们吗？在这种情况下，您可以让 CRM 合并更改，然后进行导出。

如果他们在不同的环境中工作，则使用 CRM 解决方案将定制导入单个环境。

# couchdb - Couchdb 身份验证/授权

> ID：15041335
> 
> 赞同：1
> 
> 时间：2013-02-23T14:03:22.200
> 
> 标签：couchdb

在 couchdb 中，如果数据库是安全的，它会根据“authentication_redirect”配置设置重定向到“/_utils/session.html”。

如果我有几个数据库，如 db1、db2 等，我想要的是 couchdb 重定向到 /db1/logon.html 用于 db1 和 /db2/logon.html 用于 db2 等。

是否可以根据正在访问的数据库将 couchdb 重定向到特定的登录文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T17:52:25.467

您可以传递一个 ?fail= 参数。告诉 couchdb 将身份验证失败的用户发送到哪里。蒲团是这样用的；

认证成功；

```
curl -sv 'localhost:5984/_session?next=/foo&fail=/bar' -d 'name=foo&password=bar'

< HTTP/1.1 302 Moved Temporarily
< Location: http://localhost:5984/foo
{"ok":true,"name":null,"roles":["_admin"]} 
```

认证失败；

```
curl -Haccept:text/html -sv 'localhost:5984/_session?next=/foo&fail=/bar' -d 'name=foo&password=baz'
< HTTP/1.1 302 Moved Temporarily
< Location: http://localhost:5984/bar
{"error":"unauthorized","reason":"Name or password is incorrect."} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T17:02:22.937

我能想到的唯一方法是使用如下重写：

```
{from: '/db1/*', to: '../../../db1/*'},
{from: '/db2/*', to: '../../../db2/*'} 
```

在您的主数据库上，将其称为主要从 localhost:5984 提供服务。

需要的配置在蒲团中如下

```
httpd secure_rewrites false
vhosts localhost:5984 /main/_design/edit/_rewrite 
```

唯一的问题是您必须关闭secure_rewrites，这可能会破坏您的安全性。

这是未经测试的，但应该非常接近。

# java - Ruby 调用 Maui 或 Bash

> ID：15041340
> 
> 赞同：1
> 
> 时间：2013-02-23T14:03:55.240
> 
> 标签：java, ruby-on-rails, ruby

我正在尝试通过一系列系统命令从 Ruby 运行 java 命令行操作。第一个命令工作正常，第二个（maui java 命令）我从来没有收到任何成功。有什么我做错了吗？

```
Dir.chdir('/var/lib/maui') do

    system 'cat %s/*.txt > %s/topics.txt' % [text_path, identifier_path]
    system 'java maui.main.MauiTopicExtractor -l %s -m go_model' % [identifier_path]

end 
```

我还尝试调用处理 java 命令的 bash 脚本：

```
output = %x[/var/lib/maui/process.sh #{identifier_path}] 
```

然而，同样的结果发生了——文件被连接起来，但从未到达毛伊岛。

当我从 maui 命令捕获 stdoutput 时，我得到以下信息（即使我根据需要设置了所有环境变量，并且在我在 ruby​​ 之外运行命令时工作）：

```
Exception in thread "main" java.lang.NoClassDefFoundError: maui/main/MauiTopicExtractor
Caused by: java.lang.ClassNotFoundException: maui.main.MauiTopicExtractor
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: maui.main.MauiTopicExtractor. Program will exit 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:06:26.353

根据您对找不到类的评论，我认为您需要像这样调用：

```
system 'java -cp /path/to/maui.jar maui.main.MauiTopicExtractor -l %s -m go_model' % [identifier_path] 
```

如果它可以从命令行简单地工作：

```
java maui.main.MauiTopicExtractor -l /path/to/file -m go_model 
```

那么你可以发布（来自shell）的输出：

```
echo $CLASSPATH 
```

并来自红宝石：

```
system "echo $CLASSPATH" 
```

# android - 在单独的视图中显示所有待处理的通知

> ID：15041343
> 
> 赞同：0
> 
> 时间：2013-02-23T14:04:06.737
> 
> 标签：android, notifications, android-notifications

可能这是一个幼稚的问题，但我是初学者，**请不要认为是错误的问题。**，我搜索了很多，我也在关注这个
[http://developer.android.com/guide/topics/ui/notifiers/notifications.html](http://developer.android.com/guide/topics/ui/notifiers/notifications.html)教程。还有谷歌来解决我的问题，但我找不到。

这是我的任务。

我在主活动中有一个 EditText 和一个按钮，当我单击按钮时会生成一个通知，当我打开该通知时，另一个活动已打开，显示 Editext 数据，我已通过 EditText 在主活动中输入这些数据。

我的问题是......

1.  我想在单个通知窗口中显示待处理通知的计数，如[http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Updating](http://developer.android.com/guide/topics/ui/notifiers/notifications.html#Updating) 但我无法理解这一点 -->**开始处理数据然后通知用户的循环......** 我怎样才能做到这一点。我如何处理数据以获取待处理计数。请记住，当没有通知时，此计数会减少？？？

2.  单击通知时，我希望在单独的活动中获取所有通知，就像收件箱中的消息一样。

3.  例如，在我的主要活动中，我点击了 10 次按钮，所以实际上在一个 count=10 的通知窗口中会生成 10 个通知，但它显示 count = 1？当我打开通知时，它只会在另一个活动中显示最新的通知内容，我如何在单个活动中显示剩余的 9 个？

下面在我的主要活动中......

```
Button btn;
EditText edtText;
NotificationCompat.Builder builder;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    btn = (Button) findViewById(R.id.button);
    edtText = (EditText) findViewById(R.id.editText);

    btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            CreteNotification(Calendar.getInstance().getTimeInMillis(), edtText.getText().toString());
        }
    });

}

protected void CreteNotification(long when, String data) {

    String notificationContent ="Notification Content Click Here to go more details";
    String notificationTitle ="This is Notification";
    int number = 1;
    Bitmap largeIcon = BitmapFactory.decodeResource(getResources(),R.drawable.ic_launcher);
    int smalIcon =R.drawable.ic_launcher;
    String notificationData = data;

    Intent intent = new Intent(getApplicationContext(), MyNotificationClass.class);
    intent.putExtra("Message", notificationData);
    intent.putExtra("Time", Integer.toString((int) when) );
    intent.setData(Uri.parse("content://"+when));
    PendingIntent pendingIntent = PendingIntent.getActivity(getApplicationContext(), 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);

    NotificationManager notificationManager =(NotificationManager) getApplicationContext().getSystemService(NOTIFICATION_SERVICE); 

    NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(getApplicationContext())
            .setWhen(when)
            .setContentText(notificationContent)
            .setContentTitle(notificationTitle)
            .setSmallIcon(smalIcon)
            .setAutoCancel(true)
            .setTicker(notificationTitle)
            .setLargeIcon(largeIcon)
            .setDefaults(Notification.DEFAULT_LIGHTS| Notification.DEFAULT_VIBRATE| Notification.DEFAULT_SOUND)
            .setContentIntent(pendingIntent);

    // Start of a loop that processes data and then notifies the user
    // how to loop??????????????????

    notificationBuilder.setNumber(++number);

    Notification notification = notificationBuilder.getNotification();
    notificationManager.notify(1, notification);

} 
```

我想显示所有通知的代码？？？？？？

```
 HashMap<String, String> inboxMsg;
TextView notiTextView;
Button btn;
int Id;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_my_notification_class);

    inboxMsg =  new HashMap<String, String>();
    Id = 0;
    notiTextView = (TextView) findViewById(R.id.textView1);
    btn = (Button) findViewById(R.id.button1);

    btn.setOnClickListener(new OnClickListener() {  
        @SuppressWarnings("rawtypes")
        @Override
        public void onClick(View v) {

            Set<String> keys = inboxMsg.keySet();
            Iterator keyItra = keys.iterator();
            while (keyItra.hasNext()) {
                String k = (String) keyItra.next();
                String Message = inboxMsg.get(k);
                notiTextView.setText(Message);
            }
        }
    });

    if(savedInstanceState == null)
    {
        String Mesage  = getIntent().getExtras().getString("Message");
        String Time = getIntent().getExtras().getString("Time");
        inboxMsg.put(Integer.toString(++Id), "Message is " + Mesage + " Time " + Time + "\n");
    }
} 
```

问题出在哪里，请将我重定向到正确的路径，也请指导我如何实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:26:40.727

您没有获得实际通知计数的原因是，每当`CreteNotification(long when, String data)`调用方法时，number 变量都设置为 1。可以通过在方法中将 number 设置为类成员变量而不是声明它来解决此问题。

```
Button btn;
EditText edtText;
NotificationCompat.Builder builder;
int number = 1;

.....

protected void CreteNotification(long when, String data) {
    .....
    notificationBuilder.setNumber(++number);
    ....
} 
```

关于为每个通知启动不同的活动，您需要在调用方法时为每个通知传递不同的“ID” `notificationManager.notify(ID, notification);`，但请记住，如果您分配不同的 ID，触发新通知不会更新计数，而是添加新通知。所以点击生成通知的按钮实际上会生成10个不同的通知。

# c++ - 为什么我对双精度的比较失败了 C++

> ID：15041344
> 
> 赞同：0
> 
> 时间：2013-02-23T14:04:07.660
> 
> 标签：c++, comparison, double

我正在做一个项目并完成它我需要与 double、float 进行一些比较...问题是当我比较两个 double 时，它​​们分别是 double 的最大值和 double + 1 的最大值，比较失败......我愿意

```
if (std::max(d_max + 1.1, (d_max)) == d_max)
  std::cout << "bad" << std::endl; 
```

函数 max 的答案是 d_max 并且显示“bad”......有没有人有想法或解决方案来通过我的比较获得良好的精度？我在谷歌上查了一下，但我发现了比我的问题真正解决方案更多的解释......非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T14:11:23.080

C++ 中的所有对象都有一个类型。的类型`d_max`是`double`。的类型`d_max + 1.1`仍然是double。如果`d_max`是 a 的最大值`double`，则`d_max + 1.1`不可表示，并且将使用最接近的可表示值，即`d_max`（但是，如果添加明显更大的值，则最接近的可表示值被认为是正无穷大）。所以你的`std::max`电话相当于：

```
std::max(d_max, d_max) 
```

展示：

```
double d_max = std::numeric_limits<double>::max();
bool b = (d_max == (d_max + 1.1));
std::cout << std::boolalpha << b << std::endl; 
```

这`true`作为输出给出。

* * *

为了回应您的评论，我假设您正在做这样的事情：

```
double d_max = std::numeric_limits<double>::max();
long double ld = d_max + 1;
std::cout << (d_max == ld) << std::endl; 
```

`d_max`奇怪的是，你发现这显然`ld`是平等的。为什么？嗯`d_max`是一个`double`。当你这样做时`d_max + 1`，操作的结果也是 a `double`- 的值`d_max + 1`不能用 a 表示`double`，如前所述，因此选择最接近的可表示值 ( `d_max`)。然后将该值分配给`ld`。

`long double`请注意，仅通过确保运算符产生 a （可能带有）来解决此问题是不可能的`d_max + 1.0L`。对于如此庞大的数字（大约`10^308`使用 IEEE 754 表示），加 1 不会将您移动到 ​​a 中的下一个可表示值`long double`。在我的实现中，我必须添加 10 ^(289)（即 1 后跟 289 个零）才能实际导致值发生变化：

```
double d_max = std::numeric_limits<double>::max();
long double ld = d_max + 1E289L;
std::cout << (d_max == ld) << std::endl; 
```

此外，不能保证`long double`比 具有更高的精度`double`。唯一的保证是它的精度不会*降低。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:17:37.240

让我们假设双精度数表示为十进制浮点数，科学记数法。然后，`d_max`会是这样的

```
9.999999999999999999 ⋅ 10⁹⁹ 
```

现在让我们补充`1.1`一下：

```
9.999999999999999999 ⋅ 10⁹⁹ + 1.1
= 999999999999999999900000000...000 + 1.1
= 999999999999999999900000000...001.1 
```

将其四舍五入到 20 位，甚至 40 位有效数字（你必须这样做，因为那些类型，即使是 long double，也只有有限的信息容量），你得到......？好吧，`d_max`再次。

* * *

请注意，这同样适用于减法，所以

```
int main() {
  long double d_max = std::numeric_limits<double>::max();
  if(d_max == d_max - 1.1)
    std::cout << "   d_max       = " << d_max
            << "\n== d_max - 1.1 = " << d_max + 1.1 << std::endl;
  return 0;
} 
```

输出

```
 d_max       = 1.79769e+308
== d_max - 1.1 = 1.79769e+308 
```

也就是说，这实际上与成为可用的最大价值没有任何关系`d_max`，但它比您添加的价值要大得多。

# c# - Xaml c# 数据表绑定文本框

> ID：15041346
> 
> 赞同：0
> 
> 时间：2013-02-23T14:04:08.407
> 
> 标签：c#, xaml, data-binding

我正在尝试将数据表的数据绑定到文本框。它工作正常，但它只显示数据表的最后一行。是否可以显示数据表的所有行？

XAML：

```
<Window x:Class="messenger.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525" Loaded="Window_Loaded">
<Grid>
    <TextBox Height="203" HorizontalAlignment="Left" Name="conversationInput" VerticalAlignment="Top" Width="491" Margin="12,3,0,0" IsReadOnly="True">
        <TextBox.Text>
            <MultiBinding StringFormat="{0} : {1}">
                <Binding Path="date" />
                <Binding Path="message" />
            </MultiBinding>
        </TextBox.Text>
    </TextBox>
</Grid> 
```

后面的代码：

```
 public DataTable loadConversation()
    {
        DataTable conversation = new DataTable();
        string loadMessages = "select message, date from Messages where userID=1";
        ad = new MySqlDataAdapter(loadMessages, connection);
        ad.Fill(conversation);
        return conversation;
    }

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        conversationInput.DataContext = loadConversation().DefaultView;
    } 
```

提前致谢， Fluxxi

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:07:07.153

这`TextBox`是如何设计的。您应该改用`ListBox`（或类似的）控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:07:18.707

是的，但您将需要使用某种中继器控件 - 例如[DataGrid](http://wpftutorial.net/DataGrid.html)或[ListView](http://tech.pro/tutorial/742/wpf-tutorial-using-the-listview-part-1)。

# symfony - 如何在 JavaScript 函数中创建带参数的动态路由？

> ID：15041354
> 
> 赞同：1
> 
> 时间：2013-02-23T14:04:54.550
> 
> 标签：symfony, routing, twig

我的一条路线是这样定义的：

```
society_mybundle_searchpage:
    pattern:  /search/cp/{cp}
    defaults: { _controller: SocietyMyBundle:Search:searchByCP } 
```

所以它需要一个参数：`{cp}`.

现在我想创建一个带有输入小部件的表单。所以我的代码是这样的：

```
 <form onsubmit="return search();" action="#">
    {{ form_rest(form) }}
  </form> 
```

（没什么特别的，我让 symfony 为我做所有的工作）。请注意，此表单调用 JS 函数：`search()`. 所以这是我在树枝中的代码：

```
<script type="text/javascript">
<!--
function verif_formulaire(){
    /* some code to get the value of the cp */
    ...
    /* then: */
    ss="{{ path('society_mybundle_searchpage', {'cp': '+cp+'}) }}";
    return true;
}
-->
</script> 
```

输出是：

```
function verif_formulaire(){
    ss="/symfony/web/app_dev.php/pizzas/search/cp/+tt+";
    return true;
} 
```

这不是我需要的输出。我希望输出完全像这样：

```
function verif_formulaire(){
    ss="/symfony/web/app_dev.php/pizzas/search/cp/"+tt+"/";
    return true;
} 
```

我该如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T22:55:07.297

我的解决方案是：`url_decode`在 twig 中实现一个自定义函数（非常简单）。

然后使用该`format()`功能。

结果如下：

```
window.location ="{{ path('my_path', {'cp': "%s" }) | url_decode | format('"+monCP+"') | raw }}"; 
```

说明：`path('my_path', {'cp': "AAAA" })`将生成一个类似“ `/mypath/cp/AAAA/`”的 URL，因此`path('my_path', {'cp': "%s" })`将生成一个类似“ `/mypath/cp/%s/`”的 URL

但是 ' `%s`' 将被转义。所以我通过' `| url_decode`'解码它：

```
path('my_path', {'cp': "%s" }) | url_decode 
```

将生成正确的字符串' `/mypath/cp/%s/`'。

然后我使用该`format()`函数传递一个字符串。

示例：' `"/mypath/cp/%s/" | format('OLIVIER')`' 将给出 ' `"/mypath/cp/OLIVIER/"`'

所以，在这里，我传递了一个特定的字符串：（`'"+monCP+"'`仔细观察引号和双引号）。

所以：' `"/mypath/cp/%s/" | format('"+monCP+"')`'会给' `/mypath/cp/"+monCP+"/`'

最后一个问题：这整个字符串**再次被**转义。这一次，一部经典的《`| raw`》就够了。

因此，总而言之，这是：

```
var xx ="{{ path('my_path', {'cp': "%s" }) | url_decode | format('"+monCP+"') | raw }}"; 
```

将产生完整的正常 JavaScript 代码：

```
var xx ="/my-symfony-url/cp/"+monCP+"/"; 
```

这可能看起来很复杂，但是哇。无需外部 JavaScript 文件。这就是我想要的。只是纯粹的快速 Symfony 2 php 生成的缓存。我大概可以把它做成 Twig 宏之类的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:24:18.847

如我所见，您需要在 JS 中生成路由。所以也许你需要一个[FOSJsRoutingBundle](https://github.com/FriendsOfSymfony/FOSJsRoutingBundle/blob/master/Resources/doc/README.markdown)？

# php - CodeIgniter 表单助手

> ID：15041355
> 
> 赞同：0
> 
> 时间：2013-02-23T14:05:08.077
> 
> 标签：php, forms, codeigniter, html-table

![图片](../Images/e74dc7c9e57e671f74d56d5e13ac6b90.png)

我有一个表，其中包含来自数据库的行，对于该表，我像您通常那样做一个 foreach 来获取行。图片在上面。

好吧，我的项目需要为表格上的行设置操作按钮，所以我创建了复选框（一切顺利）。现在我的问题是，当我的表单由于某种原因被完全填写时，当我点击提交按钮时，该按钮什么也不做。我在项目的其他页面中使用了表单助手，没有问题。现在我遇到了第一个问题。

这是我对表格的看法：

```
<table id='waiting' class='display'>
    <thead>
        <tr>
            <th>ID</th>                       
            <th>A Number</th>
            <th>First Name</th>
            <th>Last Name</th>
            <th>Reason for visit</th>
            <th>Comments</th>
            <th>Aid Year</th>
            <th>Staff Comments</th>
            <th>Staff Member</th>
            <th>Options</th>
        </tr>
    </thead>
    <tbody>
        <?php foreach ($waiting as $row) { ?>                 
        <tr>
            <td><?php echo htmlspecialchars($row['id'], ENT_QUOTES, 'UTF-8'); ?></td>               
            <td><?php echo htmlspecialchars($this->encrypt->decode($row['anum']), ENT_QUOTES, 'UTF-8'); ?></td>
            <td><?php echo htmlspecialchars($row['first'], ENT_QUOTES, 'UTF-8'); ?></td>
            <td><?php echo htmlspecialchars($row['last'], ENT_QUOTES, 'UTF-8'); ?></td>
            <td><?php echo htmlspecialchars($row['reason'], ENT_QUOTES, 'UTF-8'); ?></td>
            <td><?php echo htmlspecialchars($row['studentcomments'], ENT_QUOTES, 'UTF-8'); ?></td>
            <td><?php echo htmlspecialchars($row['aidyear'], ENT_QUOTES, 'UTF-8'); ?></td>
            <td><?php echo htmlspecialchars($row['counselorcomments'], ENT_QUOTES, 'UTF-8'); ?></td>
            <td>
                <?php echo form_open('studentqueue_controller/counselorscreen'); ?>
                <?php echo form_dropdown('namedrop', $names) ?></td>
            <td>
                <input type="checkbox" name="options" value="start" <?php echo form_checkbox('options','start') ?>Start</input>
                <input type="checkbox" name="options" value="stop" <?php echo form_checkbox('options','stop') ?>Incactive</input>
            </td>
        </tr>
        <?php } ; ?>
        <?php echo form_submit('submit', 'Start Action'); ?>
        <?php echo form_close(); ?> 
```

我在循环中打开表单，因为我需要表中的所有行对它们执行操作（启动和终止）

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:06:01.600

您打开表单两次，因此第二次之前的所有内容都将被忽略。删除这一行：

```
 <?php echo form_open('studentqueue_controller/counselorscreen'); ?> 
```

从 namedrop 之前开始，应该没问题。看看你的 pastebin，第 51 行和第 83 行都打开了同一个表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T17:03:41.070

```
 <h3>Students Waiting</h3>
                <table id='waiting' class='display'>
                    <thead>
                        <tr>
                            <th>ID</th>                       
                            <th>A Number</th>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Reason for visit</th>
                            <th>Comments</th>
                            <th>Aid Year</th>
                            <th>Staff Comments</th>
                            <th>Staff Member</th>
                            <th>Options</th>
                        </tr>
                    </thead>
                    <tbody>

                        <?php
                        foreach ($waiting as $row) 
                        { 
                            ?>                
                        <tr>
                            <td><?php echo htmlspecialchars($row['id'], ENT_QUOTES, 'UTF-8'); ?></td>               
                            <td><?php echo anchor('studentqueue_controller/history/'.urlencode($row['anum']). '', $row['anum'], 'target="_blank"'); ?></td>
                            <td><?php echo htmlspecialchars($row['first'], ENT_QUOTES, 'UTF-8'); ?></td>
                            <td><?php echo htmlspecialchars($row['last'], ENT_QUOTES, 'UTF-8'); ?></td>
                            <td><?php echo htmlspecialchars($row['reason'], ENT_QUOTES, 'UTF-8'); ?></td>
                            <td><?php echo htmlspecialchars($row['studentcomments'], ENT_QUOTES, 'UTF-8'); ?></td>
                            <td><?php echo htmlspecialchars($row['aidyear'], ENT_QUOTES, 'UTF-8'); ?></td>
                            <td><?php echo htmlspecialchars($row['counselorcomments'], ENT_QUOTES, 'UTF-8'); ?></td>
                            <td>
                                <?php echo form_open('studentqueue_controller/counselorscreen'); ?>
                                <?php echo form_dropdown('namedrop', $names) ?></td>
                            <td>
                                <input type="checkbox" name="options" value="start" <?php echo form_checkbox('options','start') ?>Start</input>
                                <br />
                                <input type="checkbox" name="options" value="stop" <?php echo form_checkbox('options','stop') ?>Delete</input>
                                <?php echo form_submit('submit', 'Start Action'); ?>                        
                                <?php echo form_close(); ?>
                            </td>
                        </tr>

                        <?php
                         } ?>
                    </tbody>    
                </table> 
```

我将 form_open 和 form close 都放在了 foreach 中，这样就成功了。

# mongodb - 检查 Mongodb MapReduce 支持

> ID：15041356
> 
> 赞同：0
> 
> 时间：2013-02-23T14:05:08.973
> 
> 标签：mongodb, mapreduce

我是 MognoDB 的新手。如何检查我的机器是否支持 Map-reduce？map-reduce 的代码在另一台机器上工作，但不在我的机器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T12:54:25.893

Map-reduce 只是一个过程，而不是任何特定的服务或库。如果您正在对 mongoDB 进行基本查询，例如...

```
> db.collectionname.find() 
```

比你可以轻松地将 map-reduce 代码实现到同一个 shell 中......

让我解释一下 MongoDB 食谱中的基本示例。

假设您的数据文档（在 sql 行中）如下所示。

```
> db.pageviews.find()

{
"url" : "http://example.com/photos",
"user_id" : ObjectID('4be1c916e031933119d78b30'),
"date": "Wed May 05 2010 15:37:58 GMT-0400 (EDT)"
} 
```

这是任何网站的综合浏览量文档。

该解决方案需要按天对浏览量进行分组，然后计算用户访问的总数以及当天的唯一访问次数。

```
> map = function() {
  day = Date.UTC(this.date.getFullYear(), this.date.getMonth(), this.date.getDate());

  emit({day: day, user_id: this.user_id}, {count: 1});
 } 
```

您的地图将在控制台上像这样运行..

```
> reduce = function(key, values) {
  var count = 0;

  values.forEach(function(v) {
    count += v['count'];
  });

  return {count: count};
} 
```

你的 reduce 会像这样运行......

接着

```
db.pageviews.mapReduce(map, reduce, {out: pageview_results}); 
```

这是你的基本地图减少......

现在，当您查询集合 pageview_results 时，您将减少映射文档的数量。

```
> db.pageview_results.find() 
```

# javascript - 在 javascript 中获取 keydown 上的字母数字字符

> ID：15041357
> 
> 赞同：1
> 
> 时间：2013-02-23T14:05:18.770
> 
> 标签：javascript, jquery, key

使用该`keydown`事件，我知道我们可以使用`e.which`or获取密钥代码`e.keycode`，但我正在寻找一种方法来查看字母本身，而不仅仅是代码。例如，如果有人点击字母“s”，我想返回“s”，而不是它的代码。有没有跨浏览器的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:11:27.480

您可以使用 将 ASCII 字符代码转换为字符串`String.fromCharCode(code)`。

例子：

```
$(document).keydown(function(e) {
    var code = e.which;

    $('body').append('key: ' + String.fromCharCode(code) + '<br/>');
}); 
```

[jsFiddle 示例](http://jsfiddle.net/FgeFk/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T14:10:50.717

干得好：

```
String.fromCharCode(e.which) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T14:23:24.890

这是简单的方法；

```
 $(document).keydown(function(e) {
        var code = e.keycode;
        alert(code);
    }); 
```

# c# - Sql连接安全

> ID：15041361
> 
> 赞同：1
> 
> 时间：2013-02-23T14:05:27.833
> 
> 标签：c#, .net, sql, sql-server, winforms

我使用下面的代码连接到我网站上的数据库：

```
 string tempstr = "Data Source=" + "72.55.---.---" + ";Initial Catalog=-------;Integrated Security=False;Persist Security Info=True;User ID=" + "MYUSER" + ";Password=" + "MYPASS";

 SqlConnection con = new SqlConnection(tempstr);
 con.Open(); 
```

是否足够安全？或者不是专业黑客的人可以捕获从他/她的计算机发送到我的数据库的用户名和密码！？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:10:31.717

像上面这样的字符串将以纯文本形式存储在可执行文件中。

如果“攻击者”有权访问 DLL，则转储其中包含的所有字符串（包括连接字符串）是一件简单的事情。

如果要保护连接字符串，通常的做法是将其存储在应用程序文件的`connectionStrings`部分中并[对其进行加密](http://msdn.microsoft.com/en-us/library/zhhddkxy.aspx)。`.config`

# javascript - 为什么我的 Tampermonkey 脚本会抛出“Selenium is not defined”？

> ID：15041365
> 
> 赞同：2
> 
> 时间：2013-02-23T14:05:36.600
> 
> 标签：javascript, jquery, google-chrome, selenium, tampermonkey

我试图让它每次访问 nike.com 运动鞋页面时，它都会自动选择我的鞋码，将其添加到购物车，然后为我结账。每次我尝试运行脚本时，我都会收到此错误

> 错误：脚本“My Fancy New Userscript”的执行失败！硒未定义

这是我的脚本：

```
// ==UserScript==
// @name       My Fancy New Userscript
// @namespace  http://*/*
// @version    0.1
// @description  enter something useful
// @match      http://*/*
// @copyright  2012+, You
// ==/UserScript==

selenium.select("class=selectBox-label", "10"); // this selects size 10 
selenium.click("class=add-to-cart nike-button nike-button-orange");
selenium.waitForElement("class=checkout-button nike-button nike-button-orange"); 
selenium.click("class=checkout-button nike-button nike-button-orange"); 
```

非常感谢您的帮助，谢谢！

编辑：

我刚刚通过 JSLint 运行它，并得到了这个错误：

> `'selenium' was used before it was defined. (Line 1 Character 1) ----> selenium.select("class=selectBox-label", "10"); // this selects size 10`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T00:50:35.223

您从哪里获得`selenium.select...`您正在尝试的 Selenium 代码（等）？网页本身是否使用 Selenium？（疑）。

Tampermonkey 不支持 Selenium 语法。为此，您需要`@require`某种库，而我不知道有这样的库（但我不是 Selenium 专家）。

您需要使用 javascript 或您的库`@require`或目标页面上的函数来开发 Tampermonkey 脚本。

以下是您的脚本*可能*使用[jQuery](http://jquery.com/)和[waitForKeyElements](https://gist.github.com/2625891)库/实用程序的内容：

```
// ==UserScript==
// @name     _Nike auto-buy(!!!) script
// @include  http://YOUR_SERVER.COM/YOUR_PATH/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @require  https://gist.github.com/raw/2625891/waitForKeyElements.js
// @grant    GM_addStyle
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

var okayToClickAddtoCart = false;

//-- Assumes that size is a standard <option> tag or similar...
waitForKeyElements (".selectBox-label[value='10']", selectShoeSize);

function selectShoeSize (jNode) {
    jNode.prop ('selected', true);

    okayToClickAddtoCart = true;
}

waitForKeyElements (".add-to-cart.nike-button", clickAddToCart);

function clickAddToCart (jNode) {
    if ( ! okayToClickAddtoCart) {
        return true;    //-- Don't click yet.
    }

    var clickEvent  = document.createEvent ('MouseEvents');
    clickEvent.initEvent ('click', true, true);
    jNode[0].dispatchEvent (clickEvent);
}

waitForKeyElements (".checkout-button", clickCheckoutButton);

function clickCheckoutButton (jNode) {
    var clickEvent  = document.createEvent ('MouseEvents');
    clickEvent.initEvent ('click', true, true);
    jNode[0].dispatchEvent (clickEvent);
} 
```

您必须使用实际页面中的 HTML 来调整选择器（尤其是第一个），**您应该将其包含在问题中**。

# php - 如何在 PDO 包装类中同时使用 fetch() 和 fetchAll()？

> ID：15041368
> 
> 赞同：2
> 
> 时间：2013-02-23T14:05:47.100
> 
> 标签：php, pdo, fetch, fetchall

如何更改我的 PDO 包装类，以便如果我期望查询的单行结果它使用 fetch()，如果它期望多个结果它使用 fetchAll()。

现在，如果我只有一个结果，我仍然必须遍历结果数组，这对我来说似乎很不切实际。

在模型中查询：

```
public function doccEdit() {

    $id = mysql_real_escape_string($_GET['id']);

    $this->result = $GLOBALS['db']->select("creditcards", "id = ?", $id);

    print_r($this->result);

} 
```

在包装类中：

```
public function run($sql, $bind="") {
    $this->sql = trim($sql);
    $this->bind = $this->cleanup($bind);
    $this->error = "";

    try {
        $pdostmt = $this->prepare($this->sql);
        if($pdostmt->execute($this->bind) !== false) {
            if(preg_match("/^(" . implode("|", array("select", "describe", "pragma")) . ") /i", $this->sql))
                return $pdostmt->fetchall(PDO::FETCH_OBJ);
            elseif(preg_match("/^(" . implode("|", array("delete", "insert", "update")) . ") /i", $this->sql))
                return $pdostmt->rowCount();
        }   
    } catch (PDOException $e) {
        $this->error = $e->getMessage();    
        $this->debug();
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:21:50.813

**不要试图自动化一切**

代码中的魔力越少，支持就越容易，麻烦就越少。
不要试图把所有的逻辑都塞进一个单一的方法中。这是一堂课！您可以根据需要创建任意数量的方法。

当您需要时`rowCount()`- 明确选择它！这并不难。
但是当你在几个月后偶然发现这段代码时，你就会知道这个值是什么意思。

当您需要单行时 - 使用一种方法来获取单行。当您需要很多行时 - 使用一种方法来获取很多行。
这很简单，而且非常明确！

当你在 2 个月后回到你的代码时，你会**完全不知道**，你*期望*什么。所以 -**总是明确地写出来。**

[这是我的mysqli 包装类](https://github.com/colshrapnel/safemysql/blob/master/safemysql.class.php)的摘录，可以给你一个想法：

```
public function query()
{   
    return $this->rawQuery($this->prepareQuery(func_get_args()));
}
/**
 * Helper function to get scalar value right out of query and optional arguments
 * 
 * Examples:
 * $name = $db->getOne("SELECT name FROM table WHERE id=1");
 * $name = $db->getOne("SELECT name FROM table WHERE id=?i", $id);
 *
 * @param string $query - an SQL query with placeholders
 * @param mixed  $arg,... unlimited number of arguments to match placeholders in the query
 * @return string|FALSE either first column of the first row of resultset or FALSE if none found
 */
public function getOne()
{
    $query = $this->prepareQuery(func_get_args());
    if ($res = $this->rawQuery($query))
    {
        $row = $this->fetch($res);
        if (is_array($row)) {
            return reset($row);
        }
        $this->free($res);
    }
    return FALSE;
}

/**
 * Helper function to get single row right out of query and optional arguments
 * 
 * Examples:
 * $data = $db->getRow("SELECT * FROM table WHERE id=1");
 * $data = $db->getOne("SELECT * FROM table WHERE id=?i", $id);
 *
 * @param string $query - an SQL query with placeholders
 * @param mixed  $arg,... unlimited number of arguments to match placeholders in the query
 * @return array|FALSE either associative array contains first row of resultset or FALSE if none found
 */
public function getRow()
{
    $query = $this->prepareQuery(func_get_args());
    if ($res = $this->rawQuery($query)) {
        $ret = $this->fetch($res);
        $this->free($res);
        return $ret;
    }
    return FALSE;
}

/**
 * Helper function to get single column right out of query and optional arguments
 * 
 * Examples:
 * $ids = $db->getCol("SELECT id FROM table WHERE cat=1");
 * $ids = $db->getCol("SELECT id FROM tags WHERE tagname = ?s", $tag);
 *
 * @param string $query - an SQL query with placeholders
 * @param mixed  $arg,... unlimited number of arguments to match placeholders in the query
 * @return array|FALSE either enumerated array of first fields of all rows of resultset or FALSE if none found
 */
public function getCol()
{
    $ret   = array();
    $query = $this->prepareQuery(func_get_args());
    if ( $res = $this->rawQuery($query) )
    {
        while($row = $this->fetch($res))
        {
            $ret[] = reset($row);
        }
        $this->free($res);
    }
    return $ret;
}

/**
 * Helper function to get all the rows of resultset right out of query and optional arguments
 * 
 * Examples:
 * $data = $db->getAll("SELECT * FROM table");
 * $data = $db->getAll("SELECT * FROM table LIMIT ?i,?i", $start, $rows);
 *
 * @param string $query - an SQL query with placeholders
 * @param mixed  $arg,... unlimited number of arguments to match placeholders in the query
 * @return array enumerated 2d array contains the resultset. Empty if no rows found. 
 */
public function getAll()
{
    $ret   = array();
    $query = $this->prepareQuery(func_get_args());
    if ( $res = $this->rawQuery($query) )
    {
        while($row = $this->fetch($res))
        {
            $ret[] = $row;
        }
        $this->free($res);
    }
    return $ret;
} 
```

看 - 从函数名称中您总能判断出预期的结果：

```
$name = $db->getOne('SELECT name FROM table WHERE id = ?i',$_GET['id']);
$data = $db->getAll("SELECT * FROM ?n WHERE mod=?s LIMIT ?i",$table,$mod,$limit); 
```

不要被返回行数这样的陷阱所迷惑。
您打算填充的结果集中可能有一行`fetchAll`。因此，它将返回一维数组而不是多维数组，并且您的页面上将有大量的视频效果

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-09-06T17:26:47.783

由于您没有将答案标记为已接受。我以为我会回答你的问题。我在自己寻找答案时发现了这一点。我同意“你的常识”，因为它们应该是两个独立的功能。但是，直接回答您的问题，这就是我所拥有的（PDO 示例而不是 mysqli）：

```
function select($sql,$params=NULL,$fetchType=NULL){
    try{
        $qry = $this->db->prepare($sql);
        $qry->execute($params);
        if($qry->rowCount() > 1){
            if($fetchType == 'OBJ'){//returns object
                $results = $qry->fetchAll(PDO::FETCH_OBJ);
            }elseif($fetchType == 'NUM'){//-numerical array
                $results = $qry->fetchAll(PDO::FETCH_NUM);
            }else{//default - associative array
                $results = $qry->fetchAll(PDO::FETCH_ASSOC);
            }
        }
        else{
            if($fetchType == 'OBJ'){//returns object
                $results = $qry->fetch(PDO::FETCH_OBJ);
            }elseif($fetchType == 'NUM'){//-numerical array
                $results = $qry->fetch(PDO::FETCH_NUM);
            }else{//default - associative array
                $results = $qry->fetch(PDO::FETCH_ASSOC);
            }
        }

        if($results){
            return $results;
        }else{
            return NULL;
        }
    }
    catch(PDOException $err){
        $this->logError($err);
    }
} 
```

但是我发现，如果我查询表中的所有行但表中只有一行，它将返回一维数组而不是二维数组。我处理结果的代码不适用于两种类型的数组。我每次都可以处理，但我发现如上所述将它们分成不同的函数更容易，所以如果我知道只有一个答案，我可以调用适当的函数。这就是我现在所拥有的：

```
function select($sql,$params=NULL,$fetchType=NULL){
    try{
        $qry = $this->db->prepare($sql);
        $qry->execute($params);

        if($fetchType == 'OBJ'){//returns object
            $results = $qry->fetch(PDO::FETCH_OBJ);
        }elseif($fetchType == 'NUM'){//-numerical array
            $results = $qry->fetch(PDO::FETCH_NUM);
        }else{//default - associative array
            $results = $qry->fetch(PDO::FETCH_ASSOC);
        }

        if($results){
            return $results;
        }else{
            return NULL;
        }
    }
    catch(PDOException $err){
        $this->logError($err);
    }
}

function selectAll($sql,$params=NULL,$fetchType=NULL){
    try{
        $qry = $this->db->prepare($sql);
        $qry->execute($params);

        if($fetchType == 'OBJ'){//returns object
            $results = $qry->fetchAll(PDO::FETCH_OBJ);
        }elseif($fetchType == 'NUM'){//-numerical array
            $results = $qry->fetchAll(PDO::FETCH_NUM);
        }else{//default - associative array
            $results = $qry->fetchAll(PDO::FETCH_ASSOC);
        }

        if($results){
            return $results;
        }else{
            return NULL;
        }
    }
    catch(PDOException $err){
        $this->logError($err);
    }
} 
```

# java - 是否可以在正则表达式 java 中定义前瞻范围？

> ID：15041369
> 
> 赞同：3
> 
> 时间：2013-02-23T14:05:48.737
> 
> 标签：java, regex, negative-lookahead

我想在 java 中使用负前瞻，但我不能仅将它应用于文本的某些部分。它从光标处一直使用到结尾。有可能以某种方式做到吗？

一个例子：我有一个不定的'ab'围绕它的字符串：ababJJJababab

我希望只对没有“ab”的中心部分进行分组（即 JJJ）。所以这是我的正则表达式：

```
^(?:ab)*((?!.*ab.*).*)(?:ab)*$ 
```

问题是负前瞻超出了它的容器组并试图避免'ab'直到文本结束（这将导致根本找不到任何匹配项）。请注意，我的实际问题要复杂得多，我并不是在寻找解决这个特定示例的方法。有没有办法分配某种边界来定义正则表达式中的前瞻范围，避免将其应用于文本的其余部分？

提前致谢 ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:06:15.077

在这种特定情况下，最小匹配应该有效。但是，在一般情况下，您需要这样的东西：

```
(?sx)
(?:abc) ( (?: (?!abc) .)* ) (?:abc) 
```

我也不相信你在第一部分和最后一部分的所有明星。您意识到您的模式与空字符串匹配，不是吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:27:21.343

在这种特殊情况下，您根本不需要负前瞻。您只需要使中间量词不贪婪，这样它就不会消耗尾随的“ab”：

```
^(?:ab)*(.*?)(?:ab)*$ 
```

# sql - 按照 DTA 的建议添加非聚集索引会提高性能吗？

> ID：15041374
> 
> 赞同：3
> 
> 时间：2013-02-23T14:06:54.077
> 
> 标签：sql, sql-server, performance, sql-server-2008, indexing

我在数据库中定义了以下表

**商店表**

*   店铺编号
*   店铺名称
*   所有者
*   横幅
*   标题
*   城市编号
*   ShopImageId
*   积极的

**城市表**

*   城市编号
*   城市名称
*   国家 ID
*   区域 ID

**国家表**

*   国家 ID
*   国家的名字
*   区域 ID

**地区**

*   区域 ID
*   区域名称

**商店图片**

*   ID
*   图片
*   店铺编号

这是我的选择查询

```
SELECT ShopName, Owner, CityName, CountryName,RegionName
FROM Shop S 
INNER JOIN City CT ON CT.CityId=S.CityId
INNER JOIN Country CO ON CO.CountryId=CT.CountryId
INNER JOIN Region R ON CT.RegionId=R.RegionId
LEFT OUTER JOIN ShopImages SI ON S.ShopImageId=SI.Id

WHERE S.Banner like '%restaurant%' OR S.Description like '%restaurant%'
AND S.CityId=10 AND S.Active=1 
```

> 截至目前，城市表有大约 3,000,000 条记录，而 Shop 有 40,000,000 多条记录。

***获取记录需要时间。所有聚集索引（主键）都已定义。***

> 我正在尝试在 DTA（Database Tuning Advisor）的帮助下进行优化。它建议我添加以下索引

```
CREATE NONCLUSTERED INDEX 
  [_dta_index_CITY_9_2098106515__K9_K20_K1_K2] ON [dbo].[CITY] 
(
    [COUNTRYID] ASC,
    [REGIONID] ASC,
    [CITYID] ASC,
    [CITYNAME] ASC
)WITH (SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF) 
  ON [PRIMARY] 
```

是否值得添加此索引？我可以接受 DTA 的所有建议吗？它还建议添加一些统计信息。

如何更好地改进我的上述查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:34:16.710

在分析索引时很难说 DTA 是*错误*的，因为我不知道数据分布而且确实如此，但我要添加的第一个索引超出主键是和上的（可能是复合的）`SHOP.CityID`索引`SHOP.Active`。

我不能在没有测试的情况下给你任何绝对的东西，但这就是推理。

由于您基本上是在`SHOP`对任何其他表进行过滤并且没有过滤器，因此查询的繁重工作很可能是在过滤`SHOP`.

如果数据库从任何其他表开始加入，未过滤的连接将导致 3M 行反对`CITY`，并且从过滤开始`SHOP`很可能会导致少得多。编译器喜欢“更少”是有充分理由的。

这是过滤器`SHOP`；

```
WHERE S.Banner like '%restaurant%' OR S.Description like '%restaurant%'
  AND S.CityId=10 AND S.Active=1 
```

由于`LIKE`以`%`. *_* _ `S.CityId=10 AND S.Active=1`_ 如果您对它们进行索引，则其他两个条件不需要扫描超过使用索引找到的几行而不是扫描 - 可能 - 50M 行。

我可以看到建议的索引影响不大的唯一原因是，如果`CITY`表具有大量字段，并且索引将允许数据库从磁盘读取更少的数据以获取字段。不是说是这样，但只有尝试才能确定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:06:21.673

在某些情况下，您可能需要重新考虑在主键列上设置聚集索引。

例如，如果您通常搜索给定城市中的商店（如果示例查询是“典型查询”就是这种情况），将 Shop 聚集在 CityId 上可能非常有益（这样给定城市中的所有商店被组合在一起）

# .net - 使用 C# 从源文件编译 WPF 应用程序？

> ID：15041380
> 
> 赞同：0
> 
> 时间：2013-02-23T14:07:20.523
> 
> 标签：.net, wpf, winforms

我最近在 WPF 中创建了一个应用程序。

我希望能够更改应用程序徽标、表单标题并从将 WPF 应用程序从源文件编译为可执行文件的生成器（winforms 应用程序）进行其他自定义

有人可以展示一个关于如何使用 C# 编译 WPF 应用程序**的代码示例吗？**我知道如何使用编译`.cs`源文件，`CSharpCodeProvider`但是否可以使用 CodeProvider 从源文件编译 WPF？

Anyhelp将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:17:22.087

你需要看看[MSBuild](http://msdn.microsoft.com/en-us/library/ms171452%28v=vs.90%29.aspx)

```
using (System.Diagnostics.Process process = new System.Diagnostics.Process())
{
    string workingDirectoryPath = "PathToYourSolutionFile"
    string resultsFileMarker = workingDirectoryPath + @"\DotNetBuildResult.txt";

    process.StartInfo.FileName = @"C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe";
    process.StartInfo.Arguments = @"YourSolutionName.sln /nologo /fileLogger /fileloggerparameters:errorsonly;LogFile=""" + resultsFileMarker + @""" /noconsolelogger /t:clean;rebuild /verbosity:normal /p:Configuration=Release;Platform=x86";
    process.StartInfo.WorkingDirectory = workingDirectoryPath;
    process.StartInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
    process.Start();
    process.WaitForExit();
    process.Close();
    process.Dispose();

    using (StreamReader resultsStreamReader = new FileInfo(resultsFileMarker).OpenText())
    {
        results = resultsStreamReader.ReadToEnd();
    }

    if (results.Trim().Length != 0)
    {
        System.Diagnostics.Process.Start(resultsFileMarker);
        errorEncountered = true;
        throw new Exception("Error were errors rebuilding the .Net WPF app - please check the log file that has just opened.");
    }
} 
```

# .net - 如何使一元否定和数学函数适用于继承的类型？

> ID：15041381
> 
> 赞同：3
> 
> 时间：2013-02-23T14:07:28.717
> 
> 标签：.net, f#

考虑以下代码：

```
type Base(x : float) =
    member this.x = x
    static member (~-) (a : #Base) = Base(-a.x)
    static member Cos (a : #Base) = Base(cos a.x)

type Inherited(x : float) = 
    inherit Base(x)

let aBase = Base(5.0)
let aInherited = Inherited(5.0)

-aBase                // OK, returns Base(-5.0)
-(aInherited :> Base) // OK, returns Base(-5.0)
-aInherited           // not OK 
```

最后一行产生错误：

```
error FS0001: This expression was expected to have type
    Inherited    
but here has type
    Base 
```

与`cos aInherited`: 相同，它给出了相同的错误，但`-(aInherited :> Base)`确实`cos (aInherited :> Base)`有效。

错误消息表明这些函数希望`-`或的返回类型`cos`与参数类型相同。这似乎是一个过于苛刻的要求。

*   对于从定义运算符的基类型继承的类，除非您重新定义每个运算符，否则这是不可能的。
*   如果这些类驻留在您无法控制的外部库中，那么您的选择就会更加有限。

有没有解决的办法？在 F# 源代码中，`cos`函数定义在`prim-types.fs`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T18:12:46.007

我认为没有干净的方法可以做到这一点。

问题是这些运算符的原始全局定义的签名返回与输入相同的类型，因此如果不重新定义全局定义，您将无法添加不尊重此签名的静态成员。

如果您创建一个具有较少限制签名的新全局定义，则必须处理所有情况，否则我能想象的唯一可以重用全局定义的方法是通过中间类型并对抗类型推断：

```
type Base(x : float) =
    member this.x = x

type Inherited(x : float) = 
    inherit Base(x)

type UnaryNeg = UnaryNeg with
    static member inline ($) (UnaryNeg, a       ) = fun (_         ) -> -a
    static member        ($) (UnaryNeg, a: #Base) = fun (_:UnaryNeg) -> Base(-a.x)
let inline (~-) a = (UnaryNeg $ a) UnaryNeg

type Cos = Cos with
    static member inline ($) (Cos, a       ) = fun (_    ) -> cos a
    static member        ($) (Cos, a: #Base) = fun (_:Cos) -> Base(cos a.x)    
let inline cos a = (Cos $ a) Cos 
```

这适用于所有情况和任何派生类型的 Base：

```
> cos 0.5  ;;
val it : float = 0.8775825619
> cos (Base 0.5)  ;;
val it : Base = FSI_0002+Base {x = 0.8775825619;}
> cos (Inherited 0.5)  ;;
val it : Base = FSI_0002+Base {x = 0.8775825619;}
> type Inherited2(x : float) =     inherit Base(x) ;;
> cos (Inherited2 0.5)  ;;
val it : Base = FSI_0002+Base {x = 0.8775825619;} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T14:57:11.603

它变得更加有趣。我认为您可以使用快速、hacky 的解决方案，即重新定义继承类型上的运算符并使用它们调用基类运算符，但即使在继承类型上定义了运算符之后，您仍然会收到错误消息最后一种情况（这真的很奇怪）。

```
type Inherited(x : float) = 
    inherit Base(x)

    static member (~-) (a : Inherited) =
        -(a :> Base)

    static member Cos (a : Inherited) =
        cos (a :> Base) 
```

如果你使用这个定义而不是你原来的定义，它至少*应该*允许你使用操作符——但是它给出了关于期望一个“Base”实例的相同错误消息（这很奇怪）。

我的猜测是你发现了一个编译器错误，或者至少是语言规范中的一个边缘情况。您应该将其通过电子邮件发送至`fsbugs`at，`microsoft.com`以便他们可以在下一个版本中解决此问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T14:59:07.400

您可以将运算符放在一个模块中：

```
module BaseOps =
  let (~-) (a: #Base) = Base(-a.x)
  let cos (a: #Base) = Base(cos a.x) 
```

`open`隐藏内置运算符的模块。然后，您不再受限于预期的签名（它还回避了任何潜在的错误）。这与 Core lib 用于[检查运算符](https://stackoverflow.com/q/2271198/162396)的技术相同。

```
open BaseOps

let aInherited = Inherited(5.0)
cos aInherited // OK
-aInherited    // OK 
```

# c# - 以编程方式从另一个窗体打开窗口窗体

> ID：15041382
> 
> 赞同：24
> 
> 时间：2013-02-23T14:07:34.253
> 
> 标签：c#, winforms

我正在制作一个 Windows 窗体应用程序。我有一个表格。我想在运行时通过单击按钮从原始表单打开一个**新表单。**然后以编程方式关闭这个**新表单**（2,3 秒后），但从 gui 主线程以外的线程关闭。

1.  有人可以指导我怎么做吗？
2.  新形式是否会影响或阻碍原主形式中发生的事情？（如果是，那么如何阻止它？）

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-23T14:43:34.003

要使用按钮单击打开，请在按钮事件处理程序中添加以下代码

```
var m = new Form1();
m.Show(); 
```

这里 Form1 是您要打开的表单的名称。

另外要关闭当前表单，您可以使用

```
this.close(); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-23T14:56:27.547

我会这样做：

```
var form2 = new Form2();
form2.Show(); 
```

并关闭我会使用的当前表格

`this.Hide();`代替

```
this.close(); 
```

查看此[Youtube 频道](http://www.youtube.com/user/breakPointed)链接以获取简单的启动教程，如果您是初学者，您可能会发现它很有帮助

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-08-29T17:29:45.370

这是一个老问题，但回答是为了收集知识。我们有一个带有按钮的原始表单来显示新表单。

[![在此处输入图像描述](../Images/23a6207abe63f24f17583ddcc6962ce6.png)](https://i.stack.imgur.com/y4h4t.png)

按钮单击的代码如下

```
private void button1_Click(object sender, EventArgs e)
{
    New_Form new_Form = new New_Form();
    new_Form.Show();
} 
```

现在单击时，会显示新表单。因为，您想在 2 秒后隐藏我们正在向新表单设计器添加一个 onload 事件

```
this.Load += new System.EventHandler(this.OnPageLoad); 
```

此**OnPageLoad**函数在加载该表单时运行

在**NewForm.cs**中，

```
public partial class New_Form : Form
{
    private Timer formClosingTimer;

    private void OnPageLoad(object sender, EventArgs e)
    {
        formClosingTimer = new Timer();  // Creating a new timer 
        formClosingTimer.Tick += new EventHandler(CloseForm); // Defining tick event to invoke after a time period
        formClosingTimer.Interval = 2000; // Time Interval in miliseconds
        formClosingTimer.Start(); // Starting a timer
    }
    private void CloseForm(object sender, EventArgs e)
    {
        formClosingTimer.Stop(); // Stoping timer. If we dont stop, function will be triggered in regular intervals
        this.Close(); // Closing the current form
    }
} 
```

在这个新表单中，计时器用于调用关闭该表单的方法。

这是2秒后自动关闭的新表单，我们将能够对这两个表单进行操作，这两个表单之间没有干扰。

[![在此处输入图像描述](../Images/fbe9b91cce79c01d7d0aeb72558edcb8.png)](https://i.stack.imgur.com/utkSu.png)

为了你的知识，

`form.close()`将释放内存，我们再也无法与该表单交互 `form.hide()`将只是隐藏表单，代码部分仍然可以运行

有关计时器的更多详细信息，请参阅此链接，[https://docs.microsoft.com/en-us/dotnet/api/system.timers.timer?view=netframework-4.7.2](https://docs.microsoft.com/en-us/dotnet/api/system.timers.timer?view=netframework-4.7.2)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T14:22:00.020

您只需要使用 Dispatcher 从 UI 线程以外的线程执行图形操作。我认为这不会影响主窗体的行为。这可能会对您有所帮助： [从 BackgroundWorker 线程访问 UI 控件](https://stackoverflow.com/questions/4428817/accessing-ui-control-from-backgroundworker-thread-c-sharp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-06-17T13:56:23.443

这也可能有帮助：

```
void ButtQuitClick(object sender, EventArgs e)
{
    QuitWin form = new QuitWin();
    form.Show();
} 
```

**将ButtQuit**更改为您的按钮名称，并将**QuitWin**更改为您创建的表单的名称。

**单击按钮时，它将打开另一个窗口，您需要在主窗体上创建另一个窗体和一个按钮才能使其工作。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-21T04:46:28.790

```
private void btnchangerate_Click(object sender, EventArgs e)
    {
        this.Hide();  //current form will hide
        Form1 fm = new Form1(); //another form will open
        fm.Show();

    } 
```

点击 btn 当前表单将隐藏并打开新表单

# java - Android KeyPairGenerator + php openssl_public_encrypt

> ID：15041389
> 
> 赞同：1
> 
> 时间：2013-02-23T14:08:05.153
> 
> 标签：java, php, android, openssl, rsa

我有一个生成公钥+私钥对的客户端（android 设备）。它将公钥发送到服务器，服务器应该使用公钥加密一些数据并将其返回，以便客户端稍后可以使用私钥对其进行解密。我的 php 代码记录了一条警告，指出我提供的公钥无效。

在设备端，我生成密钥对如下 -

```
KeyPairGenerator kpg = KeyPairGenerator.getInstance("RSA");
kpg.initialize(256);
KeyPair kp = kpg.generateKeyPair();
PublicKey publicKey = kp.getPublic(); 
```

然后我base64编码并发布它 -

```
String urlParameters = "productID=" + productID + "&publicKey="
                + URLEncoder.encode(Base64.encodeToString(publicKey.getEncoded(),
                        Base64.DEFAULT)); // without the URLEncoder, the + signs
                                          // are turned into spaces 
```

在服务器端，我从 POST 参数中提取 publicKey 并尝试使用它来编码一些数据 -

```
$publicKey = $_POST['publicKey'];
$encryptedData = '';
$productData = 'test test test';
openssl_public_encrypt($productData, $encryptedData, $publicKey); 
```

这最终会在日志中出现以下错误 -

```
PHP Warning:  openssl_public_encrypt(): key parameter is not a valid public key 
```

我还尝试在将公钥用于加密之前为其添加前缀和后缀，但这也无济于事 -

```
$publicKey = "-----BEGIN PUBLIC KEY-----\r\n" . $publicKey . "\r\n-----END PUBLIC KEY-----"; 
```

有一段时间我对此感到头疼，我在网上遇到的任何建议似乎都没有帮助。任何想法都会很有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:22:29.800

最终通过进行 2 项更改来解决问题 -

1.  不得不使用`Base64.NO_WRAP`标志而不是`Base64.DEFAULT`在 Java 端。
2.  分块后在 php 中添加前缀/后缀 - `$publicKey = "-----BEGIN PUBLIC KEY-----\r\n" . chunk_split($publicKey) . "-----END PUBLIC KEY-----";`

# drupal-7 - Drupal 形式的随机隐藏值

> ID：15041391
> 
> 赞同：0
> 
> 时间：2013-02-23T14:08:19.603
> 
> 标签：drupal-7

我正在为我的一个客户开发简单的留言簿模块，为了防止垃圾邮件，我决定使用一系列简单的问题。为此，我必须从数组中选择随机问题并在表单中设置此问题的 ID（数组元素 ID），以便我可以在提交处理程序中检查答案。问题是在评估提交处理程序之前重新生成表单，因此随机值会发生变化。

很快：我`$form_state['values']['queston_id']`在提交处理程序函数中得到了其他值，它是形式的。为什么会这样，我该如何改变？

非常感谢！

这是我的模块：

```
function gb_menu() {
  $items = array();

  $items['gb'] = array(
    'title' => t('Guestbook'),
    'description' => t('Guestbook page'),
    'page callback' => 'gb_guestbook',
    //'page arguments' => array('gb_guestbook'),
    'access arguments' => array('view guestbook'),
  );

  return $items;
}

function gb_guestbook() {
  dpm('generating page');
  $page = NULL;

  $page .= drupal_render(drupal_get_form('gb_guestbook_form'));

  $page .= 'list of guestbook messages here';
  return $page;
}

function gb_guestbook_form($form, &$form_state) {

  $form['name'] = array(
    '#type' => 'textfield',
    '#title' => t('Name'),
    '#description' => t('Please, enter your name.'),
  );

  $form['message'] = array(
    '#type' => 'textarea',
    '#cols' => 5,
    '#title' => t('Message'),
    '#description' => t('Please, enter your message.'),
  );

  $questions = gb_get_question();
  $question_id = rand(0, count($questions)-1);
  $question = $questions[$question_id];

  $form['question_id'] = array(
    '#type' => 'hidden',
    '#value' => $question_id,
  );

  $form['spam'] = array(
    '#title' => $question['question'],
    '#description' => t('Please, answer the simple question so we know that you are a human.'),
    '#type' => 'textfield',
  );

  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Submit'),
  );

  return $form;
}

function gb_guestbook_form_submit($form, &$form_state) {
  // spam check
  $values = $form_state['values'];

  $questions = gb_get_question();
  $answers = $questions[$values['question_id']]['answers'];
  if (!in_array(strtolower($values['spam']), $answers)) {
    drupal_set_message(t('You did not reply the answer correctly. Are you sure it was not typo?'), 'error');
  }
  else {
    drupal_set_message(t('Thanks for the contribution!'), 'status'); 
    // processing input
  }
}

function gb_get_question() {
return array(
  array (
    'question' => t('What is the capital of Slovakia?'),
    'answers' => array('bratislava'),
  ),
  array (
    'question' => t('What is the name of this band?'),
    'answers'=> array('divozel'),
  ),
  array (
    'question' => t('What is the biggest town in east part of Slovakia?'),
    'answers' => array('košice','kosice'),
  ),
);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T10:01:38.597

您应该改为在 gb_guestbook_form_VALIDATE 中执行此检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T21:30:41.183

我会在验证挂钩中执行此操作。函数 gb_guestbook_form_submit 中的另一个问题

你得到了问题，但没有得到答案数组，然后你试图比较它们。这也可能是您的问题的根源，您捕获了问题而不是答案，然后与空的答案数组进行比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-12T09:43:28.807

您的问题（和我的）在这里描述： [http ://www.sparklepod.com/myblog/drupal-form-same-form-for-build-and-validation/](http://www.sparklepod.com/myblog/drupal-form-same-form-for-build-and-validation/)

简而言之。提交时，表单在运行验证代码之前重建。对我来说，博客中的解决方案不适用于我的 Drupal 7 站点。

我所做的是将以下行添加到论坛构建中：

```
$form_state['cache'] = true; 
```

这将缓存表单，并且在 _submit 上我会将其设置为 false。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-26T15:49:11.840

不知道为什么我的其他答案对您不起作用，但这是另一种方法。想法是将问题 id 存储在 $form_state['storage'] 中。

首先，更正您的表单声明，使其传入 $form_state 作为参考。

`function gb_guestbook_form($form, &$form_state) {`

现在检查 $form_state['storage'] 数组中的问题 id，如果尚未设置，请在设置表单值 question_id 之前设置它。

```
$questions = gb_get_question();
if (!isset($form_state['storage']['question_id'])) {
  $form_state['storage']['question_id'] = array_rand($questions);
}

$form['question_id'] = array(
  '#type' => 'hidden',
  '#value' => $form_state['storage']['question_id'],
); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-26T01:41:17.437

将您的随机问题生成器包装在条件语句中，以检查您的问题是否已在表单中定义。

```
$question_id = NULL;
$questions = gb_get_question();
if (!isset($form['question_id'])) {
  $question_id = rand(0, count($questions)-1);
}
else {
    $question_id = $form['question_id']['#value'];
}
$question = $questions[$question_id]; 
```

# iis - IIS 和带身份验证的反向代理

> ID：15041393
> 
> 赞同：4
> 
> 时间：2013-02-23T14:08:23.517
> 
> 标签：iis, iis-7, reverse-proxy

我使用带有 URLRewrite 和应用程序请求路由 (ARR) 的 IIS7 作为反向代理。所以我可以将所有请求`http://localhost/external`指向`http://external/external`

这在我的开发设置中一切正常。但是在客户端站点上，他们在 Web 服务器和 Internet 之间有一个代理（我将其称为中间代理）。

我已经为 ARR 设置了代理详细信息，但是中间代理需要身份验证，因此任何请求都会遇到：

```
'http error', 407, 'Proxy Authentication Required' 
```

我想我需要在中间代理上授予应用程序池用户（使用 URLRewrite/ARR 的站点的）访问互联网的权限？这是最好的方法吗？如果是，应该使用哪个帐户？似乎没有任何 ARR 选项可以添加用户名/密码。

*请注意，这是 2 年前在 ServerFault 上发布的，但没有回应，我现在删除了位于 -* [https://serverfault.com/questions/289083/iis-and-reverse-proxy-with-authentification的原件](https://serverfault.com/questions/289083/iis-and-reverse-proxy-with-authentification)

# php - HowTo：使用不同的文件从 PHP 连接到 MySQL

> ID：15041404
> 
> 赞同：0
> 
> 时间：2013-02-23T14:09:13.923
> 
> 标签：php, session, dynamic, mysql-connect, mysql-select-db

好的，所以我进行了搜索，看看是否有其他帖子可以完全解释这一点......

好吧，我现在在这里：）

* * *

**设想：**

1.  我想通过 html 连接到你的 mysql 数据库。
2.  每次我希望执行查询时，我都不想明确设置**参数**
3.  我有多个用户，并且（当然）您希望他们的登录详细信息在整个应用程序中可用

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-12-14T14:17:57.267

1.  您需要 PHP 在 connection.php 文件中建立连接

    ```
    <?php

    $conn= mysqli_connect("localhost","ID","Password","Database_name"); 
    ```

    然后在您放置的每个文件`require('connection.php');`中，没有办法连接到 MySQL 数据库。

2.  将查询设置为函数，并将您要搜索的内容作为变量发送。

3.  用户输入他的电子邮件/密码后，使用 $_Session 或 $_Cookie。

# angularjs - Angular.js - 防止直接访问部分视图

> ID：15041408
> 
> 赞同：14
> 
> 时间：2013-02-23T14:09:52.527
> 
> 标签：angularjs

我希望用户在浏览器中访问他们的 url 时不能直接查看部分内容。例如，如果我的部分视图位于：

```
/partials/myPartial.html 
```

我仍然可以直接访问它并查看奇怪的标记。有没有办法阻止它并使部分视图只能通过角度获得？谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-05-23T19:05:10.627

我`<script>`在每个视图部分的顶部放置了一个检查包含主应用程序模块的变量是否存在，如果不重定向到`index.html`

如果在`app.js`appModule中是这样定义的：

```
var appModule = angular.module('myApp',["ngRoute","ngResource"]);` 
```

在部分插入的顶部：

```
<script type="text/javascript">
  if(typeof appModule === 'undefined'){
    document.location.href="index.html";
  }
</script> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-23T14:19:11.603

嗯，不是真的。

在一天结束时，浏览器需要能够访问部分内容才能下载它。如果浏览器可以做到这一点，您的用户也将能够做到这一点。您最终可能会让他们更难直接命中部分内容（例如，通过配置您的服务器，使其仅响应具有特定标头的请求并配置`$http`为在每个 XHR 请求上发送此标头）。

[另一种可能性是按照此处](https://stackoverflow.com/q/12346690/1418796)所述预先加载部分内容，并且根本不通过 HTTP 公开它们（实际上这对于生产部署来说是一个很好的做法）。

否则，如果不知道您要解决的确切问题（从功能上讲）是什么，就很难提出有意义的解决方案。

# c# - c# microchip mcp2200 cpu占用率高

> ID：15041410
> 
> 赞同：0
> 
> 时间：2013-02-23T14:10:03.910
> 
> 标签：c#, microchip

我有微芯片[mcp2200](http://ww1.microchip.com/downloads/en/DeviceDoc/22228B.pdf)设备。设备上附加了树形按钮（作为数字输入）。我用它作为反馈机。![机器示意图](../Images/4ebe79deab135469e984bef5fbbffdf7.png)
我将它附加到 Windows Server 2003 x64。然后我在我的 C# 应用程序中使用了 microchips mcp2200 驱动程序和托管 SimpleIO DLL。
在 C# 中，我使用频率为 500 毫秒的时间来检查按钮是否被按下。一两个小时后，服务器的 CPU 使用率一直很高。如果我杀死 C# 程序，一切都好。我怎样才能爱cpu使用？还是我的代码有问题？
一些代码：

```
void timer1_Tick(object sender, EventArgs e)
{
    if (DateTime.Now.ToString("HH") == _turnOffApp) Environment.Exit(0); //after working hours, turn off app. Task scheduler will start it at 8 AM
    if (btn_down == 99)
    { //if button is UP
        bool connStatus = SimpleIOClass.IsConnected();
        if (connStatus)
        {
            lblConnStatus.Text = "Connected";
            unsafe
            {
                uint rez1 = 2;
                uint* rez = &rez1;

                for (uint i = 0; i < 8; i++)
                {
                    if (i == 5 || i == 7) continue; //unused pins
                    rez1 = 2;
                    if (SimpleIOClass.ReadPin(i, rez))
                    {
                        string rez11 = rez1.ToString();
                        this.Controls["label" + i.ToString()].Text = rez1.ToString();
                        if (rez1.ToString() == "0") // 0 = button down, 1 = button up
                        {
                            RegisterButton(i);
                            i = 8;
                            continue;
                        }
                    }
                    else
                    {
                        try { this.Controls["label" + i.ToString()].Text = "ReadPinErr"; }
                        catch { }
                    }
                }
            }
        }
        else
        {
            lblConnStatus.Text = "NOT Connected";
        }
    }//end btn_down == 99
}

void RegisterButton(uint poga)
{
    btn_down = poga;
    device = Device(poga);
    CheckUserInput();
}

void SendBtnToServer(string btn)
{
    try
    {
        string uri = @"http://web-server.lan/pogas.php?device="+ device+ "&p=" + btn;
        WebClient clietn = new WebClient();
        clietn.Headers.Add("Cache-Control", "no-cache");
        clietn.CachePolicy = new System.Net.Cache.RequestCachePolicy(System.Net.Cache.RequestCacheLevel.NoCacheNoStore);
        clietn.DownloadString(uri);
        clietn.Dispose();
    }
    catch (Exception ex) { try { File.AppendAllText(logFails, DateTime.Now.ToString() + " " +  ex.ToString() + "\n\r"); } catch { } }
}

void CheckUserInput()
{
    Thread.Sleep(2000); //wait 2 sec until user releases button
    bool connStatus = SimpleIOClass.IsConnected();

    if (connStatus)
    {
        lblConnStatus.Text = "Connected";
        unsafe
        {
            uint rez1 = 2;
            uint* rez = &rez1;
            string ctrName = "label" + btn_down.ToString();
            if (SimpleIOClass.ReadPin(btn_down, rez))
            {
                if (rez1.ToString() == "1") // poga atlaista
                {
                    // register button press
                    if (btn_down == Pogas["smaids"]) { OSD(":)"); new Thread(() => SendBtnToServer("1")).Start(); }
                    if (btn_down == Pogas["neitrals"]) { OSD(":|"); new Thread(() => SendBtnToServer("2")).Start(); }
                    if (btn_down == Pogas["bedigs"]) { OSD(":("); new Thread(() => SendBtnToServer("3")).Start(); }

                    if (btn_down == Pogas["smaids2"]) { OSD(":)"); new Thread(() => SendBtnToServer("1")).Start(); }
                    if (btn_down == Pogas["neitrals2"]) { OSD(":|"); new Thread(() => SendBtnToServer("2")).Start(); }
                    if (btn_down == Pogas["bedigs2"]) { OSD(":("); new Thread(() => SendBtnToServer("3")).Start(); }
                }
            }
            else this.Controls[ctrName].Invoke(new Action(() => this.Controls[ctrName].Text = "Read pin ERROR (Release)"));
        }
    }
    else
    {
        lblConnStatus.Text = "NOT Connected";
    }
    btn_down = 99;
}// CheckUserInput 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-19T08:54:49.780

答案是：C# 应用程序通过计划作业每小时重新启动一次。没有更高的 CPU 使用率。

# javascript - Javascript添加2个视频源

> ID：15041416
> 
> 赞同：0
> 
> 时间：2013-02-23T14:10:38.997
> 
> 标签：javascript, html, video, mp4, webm

嗨，我对 javascript 很陌生。我有一个 .webm 和 .mp4 视频源，但是如何在 javascript 中添加另一个源，我只设法放入 1 (webm)，我需要添加另一个源的代码是什么？

先感谢您。

嗨，我需要放入 JS 的原因是因为 divx 插件正在替换 html5 视频元素，就像在这个线程上[防止 divx web 插件从替换 html5 视频元素？](https://stackoverflow.com/questions/4745626/prevent-divx-web-plugin-fron-replacing-html5-video-element)

这是我的代码

```
<script type="text/javascript">
function changevid() {
    document.getElementById('vid').innerHTML = '<source src="http://avalonplay.com/video/loginvideo.webm" type="video/webm" />';
   document.getElementById('vid').load();
}
</script>

<body onload="changevid()">

   <video id="vid" width="800" height="450" loop="loop" preload="auto" autoplay style="width: 100%; height: auto; margin:0; right: 0;">    
   </video>

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:36:13.487

你可以使用`.appendChild()`而不是`.innerHTML`

但更好的解决方案是测试浏览器支持，然后只添加支持的视频类型：

```
window.onload = function(){

    var vid = document.getElementById('vid');
    var source = document.createElement('source');
    var supported = supportedVidType();

    source.src = 'http://avalonplay.com/video/loginvideo'+supported.src
    source.type = supported.type

    vid.appendChild( source );

}

var supportedVidType = function(){
    var vidTest = document.createElement( "video" )

    var types = {}

    if ( vidTest.canPlayType ) {
        // Check for MPEG-4 support
        types.mp4 = "" !== vidTest.canPlayType( 'video/mp4; codecs="mp4v.20.8"' )

        // Check for Webm support
        types.webm = "" !== vidTest.canPlayType( 'video/webm; codecs="vp8, vorbis"' );

        // Check for Ogg support
        types.ogg = "" !== vidTest.canPlayType( 'video/ogg; codecs="theora"' );
    }

    for( type in types ){
        if(types[type]) {
            return {
                type: 'video/'+type,
                src: '.'+type
            }
        } 
    }
} 
```

这是一个jsfiddle：http: [//jsfiddle.net/2gd3m/2/](http://jsfiddle.net/2gd3m/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:47:15.353

我建议你只添加你需要的那个。

例如：

```
function changevid() {
   var vid = document.getElementById('vid');

   if (vid.canPlayType('video/mp4') != '') {
      vid.src = 'http://avalonplay.com/video/loginvideo.mp4';
   }
   else if (vid.canPlayType('video/webm') != '') {
      vid.src = 'http://avalonplay.com/video/loginvideo.webm';
   }
   vid.load();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:38:51.163

video 标签支持多种来源：

```
<video width="320" height="240" controls>
  <source src="movie.mp4" type="video/mp4">
  <source src="movie.ogg" type="video/ogg">
  Your browser does not support the video tag.
</video> 
```

来自：[http ://www.w3schools.com/tags/tag_video.asp](http://www.w3schools.com/tags/tag_video.asp)

# sql - 使用 ROW_NUMBER 的初级 SQL 查询

> ID：15041417
> 
> 赞同：0
> 
> 时间：2013-02-23T14:10:42.087
> 
> 标签：sql, sql-server

我是 SQL 的初学者。

现在我正在尝试创建一个有点复杂的选择，但我遇到了一些错误，我知道这是一个初学者的错误。

任何帮助表示赞赏。

```
SELECT ROW_NUMBER() OVER (ORDER BY score) AS rank, userID, facebookID, name, score FROM (
    SELECT * FROM Friends  AS FR WHERE userID = ? 
    JOIN 
    Users WHERE Users.facebookID = FR.facebookFriendID
) 
UNION (
    SELECT * FROM User WHERE userID = ?
) 
```

2在哪里？将替换为我的用户 ID。

表 User 包含我数据库中的每个用户，而 Friends 表包含用户的所有 facebookFriends。

```
USER TABLE
userID | facebookID | name | score

FRIENDS TABLE 
userID | facebookFriendID 
```

样本数据

用户

```
A | facebookID1 | Alex | 100
B | facebookID2 | Mike | 200 
```

朋友们

```
A | facebookID2 
A | facebookID3
B | facebookID1 
```

我想要这个结果，因为 Alex 和 Mike 是朋友：

```
rank | userID | facebookID  | name
1    | B      | facebookID2 | Mike
2    | A      | facebookID1 | Alex 
```

我希望这是非常清楚的解释。

我目前收到此错误：

> 执行查询时出错：关键字“AS”附近的语法不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:32:49.363

您的查询有几个问题。 `JOINS`出现在`WHERE`从句之前。当使用 a 时`JOIN`，您需要指定您的`ON`子句。此外，在使用 UNION 时，您需要确保在两个查询中返回相同数量的字段。

试试这个：

```
SELECT ROW_NUMBER() OVER (ORDER BY score) AS rank, userID, facebookID, name, score 
FROM ( 
    SELECT * 
    FROM Users
    WHERE UserId = 'A'
    UNION 
    SELECT U.userId, u.facebookId, u.name, u.score 
    FROM Friends FR 
        JOIN Users U ON U.facebookID = FR.facebookFriendID 
    WHERE FR.userID = 'A' ) t 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/092f8/1)

此外，顺便说一句`ROW_NUMBER`，它实际上是一个 Row Number 与一个`RANK`. 如果您想要排名（有潜在联系），请替换`ROW_NUMBER`为`RANK`.

# c# - C# XNA 如何让精灵消失？

> ID：15041419
> 
> 赞同：1
> 
> 时间：2013-02-23T14:10:46.060
> 
> 标签：c#, xna, 2d, sprite

标题说明了一切。我只是想让一个精灵在游戏的某个时刻消失。出于某种原因，我在任何地方都找不到听起来那么简单的答案。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:13:07.767

只需停止在`Draw`方法中渲染它。

也许`if`在代码周围添加一个用于绘制精灵的块，您可以选择何时绘制它以及何时不绘制它。

# c# - 如何使用编码数据集在 C# 中从 ReportViewer 创建

> ID：15041420
> 
> 赞同：0
> 
> 时间：2013-02-23T14:10:47.760
> 
> 标签：c#, report, reportviewer

我想在 C# ReportViewer 上创建一个类似于报表的发票。但我不知道如何通过代码格式化报告。我的代码出现错误。这是我使用的：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        try
        {
            conn = new SqlConnection();
            conn.ConnectionString = @"Data Source=.\SQLEXPRESS;Initial Catalog=PrototypeV9;Integrated Security=True";
            conn.Open();

            if (conn.State == ConnectionState.Open)
            {

                MessageBox.Show("HEY");
            }

            this.reportViewer1.Reset();
            this.reportViewer1.LocalReport.ReportPath = @"C:\Users\Lenon\Documents\Euge's Folder\SampReport\SampReport\bin\Report2.rdlc";
            ReportDataSource rds = new ReportDataSource("dsNewDataSet_Table", getData());
            this.reportViewer1.LocalReport.DataSources.Clear();
            this.reportViewer1.LocalReport.DataSources.Add(rds);
            //this.reportViewer1.DataBind();
            this.reportViewer1.LocalReport.Refresh();

            this.reportViewer1.RefreshReport();
        }
        catch (Exception ex) {

            MessageBox.Show("no");
        }
    }

    private void rptGetDataset()
    {
        string path = @"C:\Program Files";
        DataSet ds = new DataSet();
        ds.DataSetName = "dsNewDataSet";
        string sql = "";
        sql = "select * from Sample3 where ProductID = 'ITM42512'";
        SqlDataAdapter da = new SqlDataAdapter(sql, conn);
        ds.GetXmlSchema();
        da.Fill(ds);
        ds.WriteXmlSchema(path + @"\App_Code\Ds.xsd");
        ds.WriteXml(path + @"\App_Code\Ds.xml");
    }

     private DataTable getData()
{
    DataSet dss = new DataSet();
    string sql = "";
    sql = "select * from Sample3 where ProductID = 'ITM42512'";
    SqlDataAdapter da = new SqlDataAdapter(sql, conn);
    da.Fill(dss);
    DataTable dt = dss.Tables[0];
    return dt;
} 
```

我该如何解决我的问题？或者还有其他方法可以使用 ReportViewer 创建发票。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-20T18:42:19.560

作为一个老问题，您可能已经有了答案，但我一直在研究类似的事情并经历了似乎相同的情况（这就是我在这里的原因）。

由于缺少 RDLC 文件，因此触发了该错误。您可以静态或动态创建 RDLC 定义。

对于静态版本，您可以轻松找到许多关于如何使用 Visual Studio 向导进行操作的教程。如果您想动态地执行此操作，[此答案](https://stackoverflow.com/questions/4521959/generate-rdlc-through-c-sharp-code)将导致代码项目中的教程为 .Net 2.0 中的 SSRS 2005 设计。它非常好和详细。

一个不同的解决方案（这是我使用的）是在[得到reportviewer？](http://www.gotreportviewer.com/)，查找“动态生成 RDLC - 表”。示例代码将帮助您创建自己的版本；它不需要很多更改即可使其在您的项目中运行。

如果您要处理大量报告，动态版本特别有用。

希望这会有所帮助，干杯！

# ios - 无效和创建 NSTimer

> ID：15041424
> 
> 赞同：2
> 
> 时间：2013-02-23T14:11:06.533
> 
> 标签：ios, nstimer, intervals

每次我完成我的 NSTimer 时，我都想让它失效并创建一个新的间隔，但它会保留旧的间隔和新的间隔。单击 offButton 后，我想使 NSTimes 无效。计时器停止打印“工作”，但是当我以不同的间隔调用我的方法时，它会为两个间隔打印“工作”。

我的代码是这样的：

```
-(void) fireTimer{
    NSString *textValue = [sliderLabel text];
    float value = [textValue floatValue];

    [NSTimer scheduledTimerWithTimeInterval:value target:self selector:@selector(vibrate:) userInfo:nil repeats:YES];

}

- (void) vibrate:(NSTimer*)timer {
    if(_offButton.selected){
        [timer invalidate];
        timer=nil;
    }

    NSLog(@"Working");

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:16:33.773

1.  通过直接从`UITextField`. 这些值应该存储在模型对象中，并使用 MVC 模式将任何新值从文本字段获取到模型中。您当前的实现非常微妙，将在微风中打破。它还要求这段代码能够访问 UI 元素，这是非常不灵活的；最好让它只访问模型对象。

2.  将 存储`NSTimer *`为实例变量，并注意，如果您使用 ARC，则`NSTimer` **保留目标**(!!)，因此请使用此实例变量`__weak`来中断保留循环。

3.  如果您希望计时器重复，则根本无需重置它；仅当用户更改时间时才需要这样做（参见第 1 点！）。

4.  将`if (button_selected) do_vibrate;`代码移动到*计时器触发*方法中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:13:34.047

您自己使用的失效代码是正确的。但是，将计时器的引用保留为 ivar 或属性会更容易。

在这种情况下，您肯定会避免创建多个计时器实例。

# php - 使用 Asterisk 通过网络服务器使电话响铃

> ID：15041425
> 
> 赞同：3
> 
> 时间：2013-02-23T14:11:09.123
> 
> 标签：php, asterisk

最简单的方法是什么？以及如何实施？

我想到了类似的东西：

1.  我向网络服务器请求一个页面
2.  php 向星号发送一个要拨打的号码（php 和星号在同一台机器上运行）
3.  Asterisk 拨打电话

或者

1.  一个 php sip 客户端注册到远程星号服务器
2.  Php sip 客户端将要拨打的号码发送给 asterik
3.  电话铃声

我不在乎我能不能听到什么，只要它响起就足够了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:53:22.257

**调用文件**

最简单的方法是生成调用文件。Asterisk 具有通过假脱机目录发起呼叫的功能。

[https://wiki.asterisk.org/wiki/display/AST/Asterisk+Call+Files](https://wiki.asterisk.org/wiki/display/AST/Asterisk+Call+Files)

提示和注意事项：

*   您必须在单独的目录中创建调用文件并将其移动（不要使用复制，因为星号会立即解析文件，但移动是安全的）到假脱机目录。

*   调用文件必须由用户拥有，星号运行为

*   星号（文件上的 utime() ）检查修改时间戳，如果修改的时间戳在未来，则安排调用它

**AMI - Asterisk 管理器界面**

也可以[通过脚本 (AMI) 发起呼叫](http://etel.wiki.oreilly.com/wiki/index.php/Initiating_a_call_from_a_script_%28AMI%29)。您必须在 manager.conf 中设置登录名（即用户名、密码）。在端口 5038 的星号服务器 ip 上使用 Telnet 测试 AMI：

```
Action: Login
Username: username
Secret: password

Action: Originate
Channel: SIP/123
Context: default
Exten: 012345678
Priority: 1
Callerid: AMICall

Action: Logoff 
```

您也可以使用 PHP-AMI（附带[PHP-AGI](http://phpagi.sourceforge.net/)）拨出。

[manager.conf](http://doxygen.asterisk.org/trunk/Config_ami.html)的安全说明：

```
 ---------------------------- SECURITY NOTE -------------------------------
; Note that you should not enable the AMI on a public IP address. If needed,
; block this TCP port with iptables (or another FW software) and reach it
; with IPsec, SSH, or SSL vpn tunnel.  You can also make the manager
; interface available over http/https if Asterisk's http server is enabled in
; http.conf and if both "enabled" and "webenabled" are set to yes in
; this file.  Both default to no.  httptimeout provides the maximum
; timeout in seconds before a web based session is discarded.  The
; default is 60 seconds.
; 
```

**AJAM - 异步 Javascript Asterisk Manager**

AJAM 是一个 Web 服务器，您可以启用并使用它通过 http 与 Asterisk Manager Interface (AMI) 进行通信。

# java - HtmlUnit xpath getElement

> ID：15041426
> 
> 赞同：0
> 
> 时间：2013-02-23T14:11:17.340
> 
> 标签：java, html, xpath, htmlunit

我正在尝试为特定网站创建网络内容爬虫

> [http://v1000.vn/bang-xep-hang?ref=bang-xep-hang-1000-doanh-nghiep-dong-thue-thu-nhap-nhieu-nhat-2012](http://v1000.vn/bang-xep-hang?ref=bang-xep-hang-1000-doanh-nghiep-dong-thue-thu-nhap-nhieu-nhat-2012)

不久，我的 XPath 找到更改页面的链接（使用 javascript）不起作用，导致 NullPointExecetion。我尝试以各种方式修改 XPath，但没有任何效果。

另外，脚本运行后是否需要运行任何方法来获取新页面？

```
> package gimasys.webService;

import java.io.IOException;
import java.net.MalformedURLException;
import com.gargoylesoftware.htmlunit.BrowserVersion;
import com.gargoylesoftware.htmlunit.FailingHttpStatusCodeException;
import com.gargoylesoftware.htmlunit.ThreadedRefreshHandler;
import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlAnchor;
import com.gargoylesoftware.htmlunit.html.HtmlButton;
import com.gargoylesoftware.htmlunit.html.HtmlLink;
import com.gargoylesoftware.htmlunit.html.HtmlPage;

public class Crawlv1000 {

    /**
     * @param args
     */
    public static void main(String[] args) {
        // TODO Auto-generated method stub

        final WebCrawler wc = new WebCrawler();
        final PageCrawler pc = new PageCrawler();

        final WebClient webClient = new WebClient(BrowserVersion.CHROME_16);
        webClient.setRefreshHandler(new ThreadedRefreshHandler()); // This is to allow handling the page operation using threads else an exception will pop up
        try {
            HtmlPage page = webClient.getPage("http://v1000.vn/bang-xep-hang?ref=bang-xep-hang-1000-doanh-nghiep-dong-thue-thu-nhap-nhieu-nhat-2012");
            HtmlAnchor link = page.getFirstByXPath("//a[@href='javascript:loadRankingTable(3)']");
                        link.click();
                        System.out.println(page.getTextContent());

        } catch (FailingHttpStatusCodeException | IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        /*
        wc.crawl("http://v1000.vn/bang-xep-hang?ref=bang-xep-hang-1000-doanh-nghiep-dong-thue-thu-nhap-nhieu-nhat-2012");

        for (String url:wc.urlList)
        {
            pc.crawl(url);
        }
        */
    }
} 
```

谢谢， Minh Nguyen

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T11:13:51.473

亲爱的，你犯的非常小的错误，分号错误

```
HtmlAnchor link = page.getFirstByXPath("//a[@href='javascript:loadRankingTable(3);']");
link.click(); 
```

# github - 是否有带有 Assembla/GitHub 集成的云 IDE？

> ID：15041431
> 
> 赞同：3
> 
> 时间：2013-02-23T14:11:39.717
> 
> 标签：github, ide, cloud, assembla, chromebook

随着新 Chromebook 的推出，我一直在想，是否有一个云 IDE 可以从 Chrome 中使用，并且具有用于托管项目的 Assembla 和/或 GitHub 集成？

我正在考虑 Rails 开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-27T18:24:02.350

当然可以与[assembla](http://www.assembla.com/plans?affiliate=acroitor)集成。有几个步骤可以做到这一点：

1.  有一个汇编帐户（付费或免费）和带有 git 存储库的空间。不幸的是，Could9 不支持 svn 存储库。所以在汇编方面，你会有类似的东西：[https://www.assembla.com/code/<your-space>/git/nodes](https://www.assembla.com/code/<your-space>/git/nodes)。如果它是私有存储库，您的 git url 将是 git@git.assembla.com:<your-space>.git 或者如果它是公共存储库，您将拥有 git://git.assembla.com/<your-space> .git
2.  拥有 Cloud9 帐户
3.  转到你 can9 仪表板
4.  在右侧的“帐户设置”面板下查找“显示您的 SSH 密钥”
5.  复制 ssh 密钥并将其添加到您在 assembla 上的帐户中：[https ://www.assembla.com/user/edit/edit_git_settings](https://www.assembla.com/user/edit/edit_git_settings)
6.  现在使用步骤 2 中的 assembla git url 使用“从 url 克隆”创建您的 Cloud9 工作区。
7.  你完成了。
8.  做你通常做的其他普通事情，克隆、提交、推送等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T14:27:41.793

[Cloud9](https://c9.io/)（不是完全免费的，过去有一个私人工作区）[集成了 GitHub 和 BitBucket](https://docs.c9.io/setting_up_github_workspace.html)，并且都是关于协作的。

它确实支持[运行 Rails 应用程序](https://docs.c9.io/running_a_rails_app.html)的能力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-24T21:23:54.223

[Nitrous](https://pro.nitrous.io)内置了一流的 github 集成。将 Nitrous ssh 密钥添加到 Github 并无缝工作非常容易。

[https://community.nitrous.io/docs/connect-to-github](https://community.nitrous.io/docs/connect-to-github)

还有一个默认的 Ruby on Rails 入门模板，其中包含一个示例项目。第一个项目的注册是 100% 免费的：

[https://pro.nitrous.io/stacks/ruby-on-rails/](https://pro.nitrous.io/stacks/ruby-on-rails/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-27T06:38:21.333

[Koding](https://koding.com/?c=ideh)有一个用于简单 GitHub 使用的应用程序，以及一个具有完全系统 root 访问权限的浏览器终端，因此您可以将它用于 Assembla/Github/anything。基本上，如果你可以在 Ubuntu 机器上完成，你可以在 Koding 上完成，所以你的 Assembla/Github 问题很容易 :)

# regex - 在字符串中寻找不完美和完美的模式

> ID：15041435
> 
> 赞同：1
> 
> 时间：2013-02-23T14:12:04.443
> 
> 标签：regex, perl, bioinformatics

我正在编写一个 Perl 脚本来在一串核苷酸中搜索模式。到目前为止，我已经能够使用以下正则表达式

```
 my $regex1 = qr/( ([ACGT]{2}) \2{9,} )/x;
    my $regex2 = qr/( ([ACGT]{3}) \2{6,} )/x;
    my $regex3 = qr/( ([ACGT]{4}) \2{6,} )/x;
for my $regex ($regex1, $regex2, $regex3) {
    next unless $seq1 =~ $regex;
    printf "Matched %s exactly %d times\n", $2, length($1)/length($2);
    printf "Length of sequence: $number \n";
} 
```

我将如何进行以下操作？

- 找到完美（不间断地重复）和不完美（重复但可以有被核苷酸破坏的重复串），至少需要 10 个重复。

-打印整个找到的序列

样本输入 - GTCGTGTGTGTGTAGTGTGTGTGTGTGAACTGA

完整的当前脚本

```
print "Di-, Tri-, Tetra-nucleotide Tandem Repeat Finder v1.0 \n\n";
print "Please specify the file location (DO NOT DRAG/DROP files!) then press ENTER:\n";
$seq = <STDIN>;

#Remove the newline from the filename
chomp $seq;

#open the file or exit
open (SEQFILE, $seq) or die "Can't open '$seq': $!";

#read the dna sequence from the file and store it into the array variable @seq1
@seq1 = <SEQFILE>;

#Close the file
close SEQFILE;

#Put the sequence into a single string as it is easier to search for the motif
$seq1 = join( '', @seq1);

#Remove whitespace
$seq1 =~s/\s//g;

#Count of number of nucleotides
#Initialize the variable
$number = 0;
$number = length $seq1;
#Use regex to say "Find 3 nucelotides and match at least 6 times
# qr(quotes and compiles)/( ([nucs]{number of nucs in pattern}) \2{number of repeats,}/x(permit within pattern)

my $regex1 = qr/( ([ACGT]{2}) \2{9,} )/x;
my $regex2 = qr/( ([ACGT]{3}) \2{6,} )/x;
my $regex3 = qr/( ([ACGT]{4}) \2{6,} )/x;

#Tell program to use $regex on variable that holds the file
for my $regex ($regex1, $regex2, $regex3) {
    next unless $seq1 =~ $regex;
    printf "Matched %s exactly %d times\n", $2, length($1)/length($2);
    printf "Length of sequence: $number \n";
}

exit; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:34:37.320

不知道我完全理解你需要什么，但也许这会给你一个想法：

```
use strict;    # You should be using this,
use warnings;  # and this.

my $input = 'GTCGTGTGTGTGTAGTGTGTGTGTGTGAACTGA';

my $patt      = '[ACGT]{2}';   # Some pattern of interest.
my $intervene = '[ACGT]*';     # Some intervening pattern.
my $m         = 7 - 2;         # Minimum N of times to find pattern, less 2.

my $rgx = qr/( 
    ($patt) $intervene
    (\2     $intervene ){$m,}
    \2
)/x;

print $1, "\n" if $input =~ $rgx; 
```

另外，请参阅此问题以了解将整个文件读入字符串的更好方法：[在 Perl 中将文件转换为字符串的最佳方法是什么？](https://stackoverflow.com/questions/206661).

# php - mysqli_stmt_num_rows() 返回 0 行

> ID：15041437
> 
> 赞同：0
> 
> 时间：2013-02-23T14:12:23.280
> 
> 标签：php

我尝试使用准备好的语句计算查询的返回行数。

像这样的东西：

```
$q = "SELECT name, address, contact FROM members"; 

    $stmt = mysqli_prepare ($dbc, $q);

    mysqli_stmt_store_result($stmt);
    // Get the number of rows returned: 
    $rows = mysqli_stmt_num_rows($stmt);

    echo $rows; 
```

但是在执行这个查询时我总是得到 0 行。我使用 mysql 客户端 ant 对其进行了测试，然后我得到了 6 个返回的行。

谁能告诉我这有什么问题？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:14:55.633

[**`mysqli_stmt_execute`**](http://php.net/manual/en/mysqli-stmt.execute.php)在尝试存储结果之前，您需要调用以实际获取结果集。

```
$stmt = mysqli_prepare ($dbc, $q); 
mysqli_stmt_execute($stmt); // <--------- currently missing!!!
mysqli_stmt_store_result($stmt); 
$rows = mysqli_stmt_num_rows($stmt); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T14:16:44.680

您必须执行查询

```
 $q = "SELECT name, address, contact FROM members"; 

if ($stmt = mysqli_prepare ($dbc, $q)) {

 mysqli_stmt_execute($stmt);

 mysqli_stmt_store_result($stmt);
 // Get the number of rows returned: 
 $rows = mysqli_stmt_num_rows($stmt);

 echo $rows;  

 mysqli_stmt_free_result($stmt);

 mysqli_stmt_close($stmt);
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T14:16:48.343

您需要在语句句柄上调用 execute()，现在您只准备查询。

```
$q = "SELECT name, address, contact FROM members"; 

    $stmt = mysqli_prepare ($dbc, $q);

    mysqli_stmt_execute($stmt);

    mysqli_stmt_store_result($stmt);
    // Get the number of rows returned: 
    $rows = mysqli_stmt_num_rows($stmt);

    echo $rows; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-17T17:38:24.020

我担心您的表 Members 中是否确实有记录。无论如何尝试

```
$rows = mysqli_num_rows($stmt);

//or

$rows = mysql_num_rows($stmt); 
```

这对我来说已经解决了，并且返回了 5，因为我的表中只有 5 条记录。

# google-app-engine - 如何在 GAE 中使用 reportlab SimpleDocTemplate

> ID：15041440
> 
> 赞同：0
> 
> 时间：2013-02-23T14:12:47.320
> 
> 标签：google-app-engine, pdf, io, reportlab

我无法使用以下示例代码输出 PDF

```
from reportlab.pdfgen import canvas
from reportlab.lib.pagesizes import letter
from reportlab.lib import colors
from reportlab.platypus import SimpleDocTemplate, Table, TableStyle

def get_table(self, response):
    buffer = StringIO()
    doc = SimpleDocTemplate(buffer, pagesize=letter)
    elements = []
    data= [['00', '01', '02', '03', '04'],
           ['10', '11', '12', '13', '14'],
           ['20', '21', '22', '23', '24'],
           ['30', '31', '32', '33', '34']]
    t=Table(data)
    t.setStyle(TableStyle([('BACKGROUND',(1,1),(-2,-2),colors.green),
                   ('TEXTCOLOR',(0,0),(1,-1),colors.red)]))       
    elements.append(t)
    doc.build(elements)
    response.out.write(buffer.getvalue())
    buffer.close()
    return response 
```

我正在使用 webapp2.RequestHandler 并设置了响应标头，如下所示：

`self.response.headers['Content-Type'] = 'application/pdf' self.response.headers['Content-Disposition'] = 'filename=my.pdf'`

我得到的结果是一个空白的 pdf 页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T02:22:59.333

弄清楚了！问题是我也在打电话

```
c = canvas.Canvas(self.response.out, pagesize=letter)
....
c.showPage()
c.save() 
```

在请求处理程序中。我不知道你不能同时拥有

```
SimpleDocTemplate 
```

以及

```
canvas.Canvas 
```

无论如何，它现在有效。

# mysql - 选择在一个日期出现但在另一个日期不出现的记录？

> ID：15041442
> 
> 赞同：2
> 
> 时间：2013-02-23T14:13:04.023
> 
> 标签：mysql, sql, join

如果我有一个表 t1 看起来这个，其中记录在项目、大小和日期的组合上是唯一的；

```
item    size    date
1234    S   2013-02-11
1234    M   2013-02-11
1234    L   2013-02-11
9999    S   2013-02-11
9999    M   2013-02-11
9999    L   2013-02-11
1234    S   2013-02-13
1234    M   2013-02-13
1234    L   2013-02-13
9999    S   2013-02-13
9999    M   2013-02-13 
```

与 2013 年 2 月 11 日相比，我如何检索 2013 年 2 月 13 日缺少的商品和尺寸？

我正在寻找的回报是，

```
item    size
9999    L 
```

我努力了;

```
SELECT ta.item, 
         ta.size
FROM t1 ta 
    LEFT JOIN t1 tb 
        ON ta.item = tb.item
            AND ta.size = tb.size
WHERE ta.date = '2013-02-11'
   AND tb.date = '2013-02-13'
   AND tb.size IS NULL 
```

和

```
SELECT item, size 
FROM t1
WHERE t1.date = '2013-02-11'
   AND NOT EXISTS (
                    SELECT item, size 
                    FROM t1
                    WHERE t1.date = '2013-02-13'
                  ) 
```

两者都返回空集。

我设法让它工作的唯一方法是使用临时表；

```
CREATE temporary table temp1
SELECT * FROM t1 WHERE date = '2013-02-11';

CREATE temporary table temp2
SELECT * FROM t1 WHERE date = '2013-02-13';

SELECT temp1.item, temp1.size FROM temp1
   LEFT JOIN temp2 
        ON temp1.item = temp2.item AND temp1.size = temp2.size
WHERE temp2.size IS NULL 
```

临时表是不可能的。在不使用临时表的情况下如何实现这一点？

非常感谢，

（请温柔，我才刚刚开始！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:16:59.487

```
SELECT  a.*
FROM
        (
            SELECT  item, size
            FROM    tableName
            WHERE   date = '2013-02-11'
        ) a
        LEFT JOIN
        (
            SELECT  item, size
            FROM    tableName
            WHERE   date = '2013-02-13'
        ) b ON  a.item = b.item AND
                a.size = b.size
WHERE b.size IS NULL 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/3d726/9)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:57:53.840

使用聚合查询：

```
select item, size
from t1
group by item, size
having sum(case when date = '2013-02-11' then 1 else 0 end) = 1 and
       sum(case when date = '2013-02-13' then 1 else 0 end) = 0 
```

这是“组内组”查询的示例。通过更改`having`子句，您可以在想要满足的条件方面拥有很大的灵活性。例如：

```
having sum(case when date = '2013-02-11' then 1 else 0 end) = 0 or
       sum(case when date = '2013-02-13' then 1 else 0 end) = 0 
```

将返回数据中存在但在任何一天都缺失的组合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:31:13.757

你也可以试试这个简单的查询

```
SELECT item, size FROM dbo.Table_1 WHERE date = '2013-02-11'
EXCEPT
SELECT item, size FROM dbo.Table_1 WHERE date = '2013-02-13' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:39:20.467

其他人已经为你提供了有效的解决方案，这篇文章只是解决了你失败的尝试，解释了缺失的内容以及如何修复它。

这个查询

```
SELECT ta.item, 
         ta.size
FROM t1 ta 
    LEFT JOIN t1 tb 
        ON ta.item = tb.item
            AND ta.size = tb.size
WHERE ta.date = '2013-02-11'
   AND tb.date = '2013-02-13'
   AND tb.size IS NULL 
```

失败是因为 WHERE 子句中存在矛盾。该查询试图查找`tb.size`为 NULL 的行，这意味着该`tb`实例与该实例不匹配`ta`，*并且* `tb.date`是一个特定值。现在，如果 中没有匹配项，则它的`tb`所有列都将返回为 NULL，其中包括`tb.date`，这意味着它不能等于一个值并且同时为空。

显然，你的意图不同。您想将一个表的一个子集左连接到另一个子集（同一个表的，就像它发生的那样）。在这种情况下，应将定义您要加入的子集的条件放入 ON 子句中。也就是说，您不是在两个实例的两个`item`和`size`列都匹配的唯一条件下加入，而是在这些列匹配*并且*另一个实例`date`是特定值的组合条件下加入。所以，这是你应该拥有的：

```
SELECT ta.item, 
         ta.size
FROM t1 ta 
    LEFT JOIN t1 tb 
        ON ta.item = tb.item
            AND ta.size = tb.size
            **AND tb.date = '2013-02-13'**
WHERE ta.date = '2013-02-11'
   ~~AND tb.date = '2013-02-13'~~
   AND tb.size IS NULL 
```

另一个查询

```
SELECT item, size 
FROM t1
WHERE t1.date = '2013-02-11'
   AND NOT EXISTS (
                    SELECT item, size 
                    FROM t1
                    WHERE t1.date = '2013-02-13'
                  ) 
```

似乎是混淆的`EXISTS`结果`IN`。

首先，EXISTS 是如何工作的。它`true`在其子查询返回非空行集时返回。哪些列无关紧要，只有行的存在才重要。如果没有返回，则结果为`false`。这样，您的查询如下所示：

> 返回`date`为`'2013-02-11'`AND 没有*任何*行的每一行`date = '2013-02-11'`。

虽然您可能打算通过该查询说如下内容：

> 返回其`date`为`'2013-02-11'`AND 的每一行，其中没有与和*相同*的*对应*行。 *`item``size``date``'2013-02-11'`*

 *也就是说，您需要将 EXISTS 子查询与主查询相关联，这意味着将当前行的*和*`size`包含`item`到 EXISTS 测试中。所以，这就是修复的样子：

```
SELECT item, size 
FROM t1 ta
WHERE ta.date = '2013-02-11'
   AND NOT EXISTS (
                    SELECT item, size 
                    FROM t1 tb
                    WHERE tb.date = '2013-02-13'
                      **AND ta.item = tb.item
                      AND ta.size = tb.size**
                  ) 
```

另一方面，您可以重写相同的查询以使用`NOT IN`而不是`NOT EXISTS`. 这里：

```
SELECT item, size 
FROM t1
WHERE date = '2013-02-11'
   AND **(item, size) NOT IN** (
                            SELECT item, size 
                            FROM t1
                            WHERE date = '2013-02-13'
                           ) 
```

基本上说：

> 返回其`(item, size)`对 for`date = '2013-02-11'`不在 for 的`(item, size)`对集合中的每一行`date = '2013-02-11'`。

`IN`/`NOT IN`查询通常看起来比`EXISTS`/`NOT EXISTS`对应的更清晰。两者是否会导致相同的查询计划是另一回事，您可能应该在决定使用哪种方法之前进行测试（`LEFT JOIN + WHERE IS NULL`当然，这也适用于该方法）。*

# image - 如何在matlab中填充突出显示的边界

> ID：15041451
> 
> 赞同：1
> 
> 时间：2013-02-23T14:13:53.693
> 
> 标签：image, matlab

我有一个图像，其中某些区域以红色突出显示，如图所示：![在此处输入图像描述](../Images/6e646bba9e5f69b36433df7b68c84c22.png)

我想用黑色填充它。我用来突出显示该区域的代码是：

```
image= read('image.jpg');
figure,imshow(image);
cropped=image(200:240,100:480,:);
thresh=200;
lw=im2bw(cropped,thresh/255);
lw=bwareaopen(lw,100);
[B,L]=bwboundaries(lw,'noholes');
numRegions=max(L(:));
stats=regionprops(L,'all');
shapes=[stats.Eccentricity];
g=[stats.MinorAxisLength]
q=[stats.MajorAxisLength]
u=[stats.Orientation]
keepers=find(abs(u)<12);
imshow(cropped)
for index=1:length(keepers)
    outline=B{keepers(index)};
    line(outline(:,2),outline(:,1),'color','r','LineWidth',2);
end 
```

我如何使用 imfill 命令来填充它，因为我只有突出显示区域的轮廓。

# android - 如何检测片段变化和改变方向

> ID：15041455
> 
> 赞同：0
> 
> 时间：2013-02-23T14:14:28.773
> 
> 标签：android, android-fragments, android-fragmentactivity, mapfragment

我有这个 Activity 容器，它将在应用程序的使用过程中相应地更改片段。

```
public class MyTravelogueActivity extends SherlockFragmentActivity {
    //codes here
} 
```

请问是否可以检查当前 Fragment 是否属于 MapFragment 类，我只想将方向更改为**LANDSCAPE**？当我点击后退按钮或导航到其他地方时，方向应该回到纵向。目前所有片段都以纵向模式显示...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:40:50.710

是的，这是可能的。我相信用户应该可以选择所需的方向，但如果你想这样做，你可以使用[`setRequestedOrientation`](http://developer.android.com/reference/android/app/Activity.html#setRequestedOrientation%28int%29)活动类中的方法。没有测试，但这样的东西应该可以工作：在你的`onResume`方法上`MapFragment`，你可以使用

```
getActivity().setRequestedOrientation(<Landscape Orientation>) 
```

在你的`onPause`方法上`MapFragment`，你可以使用

```
getActivity().setRequestedOrientation(<Portrait Orientation>) 
```

[从此处](http://developer.android.com/reference/android/content/pm/ActivityInfo.html)替换`<Landscape Orientation>`和`<Portrait Orientation>`所需的选项。

# oracle - DevArt 的通用 Oracle 提供程序出错，但 Microsoft 的 Syste.Data.OracleCleint 没有

> ID：15041456
> 
> 赞同：1
> 
> 时间：2013-02-23T14:14:34.400
> 
> 标签：oracle, ado.net, devart

我正在使用 DevArt 的 dotConnect Universal 连接到 Oracle 数据库。

它在测试环境和我的本地机器上运行良好，但是当我将它部署到生产环境时，它会间歇性地给出错误。**这些错误类似于 ORA 12571: TNS Packet Failure 和 ORA -03114 :not connected to Oracle。**您可以在以下位置看到这些错误：[http](http://screencast.com/t/1XreLL0fq) ://screencast.com/t/1XreLL0fq和[http://screencast.com/t/mpbTkf3t4](http://screencast.com/t/mpbTkf3t4)。

但是，当我将提供程序从 Devart dotConnect Universal 更改为**Microsoft 的 System.Data.OracleClient 时，一切正常，没有任何错误。**使用 DevArt 或 Micrsoft 的 Oracle 提供程序时，我的代码完全相同，因为我在 ADO.Net 中使用 DBProvider 编码风格。

为什么 DevArt 的提供者在生产中有时会成功有时会失败（在测试环境中非常完美）？可能其他人也有类似的经历。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T12:01:33.460

我们认为这两个错误（[ora-12571](http://ora-12571.ora-code.com/)和[ora-03114](http://ora-03114.ora-code.com/)）都是由 Oracle 服务器引起的。System.Data.OracleClient 在类似情况下也会产生同样的错误。开始使用 System.Data.OracleClient 后问题会消失吗？

在使用 dotConnect Universal 时尝试切换到 Direct 模式：http: [//www.devart.com/dotconnect/oracle/docs/?](http://www.devart.com/dotconnect/oracle/docs/?directmode.html) directmode.html （添加“Provider=Oracle;”连接字符串参数以获得有效的连接字符串dotConnect 通用）。

# sql - 查询优化：在 JOIN 之前应用 SELECT、PROJECT

> ID：15041457
> 
> 赞同：-1
> 
> 时间：2013-02-23T14:14:35.363
> 
> 标签：sql, query-optimization, relational-algebra

我正在学习查询优化。一般来说，在 JOIN 之前应用 PROJECT 和 SELECT 会给你更好的性能。我的问题是：

在应用JOIN操作之前应用SELECT操作或应用JOIN操作之前应用PROJECT操作是否会更好？

感谢您的任何回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:57:30.163

“下推选择”是可以减少需要完成的 I/O 数量的基本优化策略之一。

例如，一个包含 sargable 谓词的选择，如果推到 join 下，将通过减少外部关系中的元组数量来有效减少 I/O 的数量（嵌套循环连接需要 `|R|+|R|*|Q|` I/O）。

下推选择的主要缺点是无法使用原始关系上的现有索引的情况。是否推送的决定与连接方法的选择一起完成。

同样，如果投影保留了连接所需的属性，您可以“下推”投影。

# linux - 蓝牙错误：本机库 bluecove_arm 不可用

> ID：15041460
> 
> 赞同：3
> 
> 时间：2013-02-23T14:14:50.517
> 
> 标签：linux, raspberry-pi, bluecove, lejos-nxj

我在 Raspberry Pi 上运行 leJOS pc 程序时遇到了一些困难。它适用于我的电脑。

我收到一条错误消息：“本机库 bluecove_arm 不可用”

蓝牙工作正常，否则使用：“hcitool scan”

我找不到用于 ARMv6 / Raspberry Pi 的 Bluecove 编译版本。

我已经在我的 PC 上安装了 Maven 并安装了 Maven Eclipse 插件，以尝试从源文件编译 Bluecove：虽然我看不到如何选择我想要定位的平台（ARM11）。

我注意到另一个用户提出了一个非常相似的问题，但没有提供任何有用的信息：[我在运行 debian wheezy 的树莓派上的 Java 蓝牙服务器需要 bluecove 本机库 - 我在哪里可以找到它？](https://stackoverflow.com/questions/12597986/my-java-bluetooth-server-on-raspberry-pi-running-debian-wheezy-needs-bluecove-na)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T13:52:35.940

你想要：

*   将 Apache Ant 安装到您的 Raspi -`sudo apt-get install ant`
*   下载“bluecove-gpl-src.zip”并使用命令“解压缩”将其解压缩到 Pi 上的目录中
*   导航到“bluecove-gpl-src.zip”中的文件夹，它应该类似于“bluecove-gpl-2.1.0”
*   在这个文件夹里面应该有一个“build.xml”文件，运行命令`ant all`
*   让魔法发生和中提琴。在它构建项目之后，您现在应该在某处生成一个“bluecove-gpl.jar”（或类似名称）文件，它应该从构建脚本的输出中告诉您在哪里可以找到它。
*   然后，这个“bluecove-gpl.jar”与“bluecove-2.1.1.jar”（或类似名称）文件一起包含在您的 Java 应用程序的类路径中。

**额外步骤**

在这一切之前我做的一个额外步骤是在我的 pi 上安装“Maven” `sudo apt-get install maven`：：然后从包含“build.xml”文件的目录中运行命令`mvn eclipse:clean eclipse:eclipse -DdownloadSources=true`

*   我还安装了包“bluez”、“bluez-util”和“blueman”：使用“sudo apt-get install”。

*   在名为“developer-read-me.txt”的文件夹“bluecove-gpl-src/bluecove-gpl-2.1.0/”中有一个 .txt 文件，其中包含一些有用的信息。

*   “build.xml”文件希望您将 bluecove.jar 放在相对于它自己的文件夹位置：“../bluecove/target/”

**结束额外的步骤**

我现在不在我的 Pi，所以我不能准确地告诉你我对那个文件做了什么：我确定我将它包含在我的项目的类路径中：但我认为它实际上并不重要。

如果您对上述步骤有任何疑问：请告诉我，我会尽力帮助和澄清！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-06T15:49:04.187

解决方案：这是为 Raspberry 编译库“BlueCove”的快速指南。 [https://www.raspberrypi.org/forums/viewtopic.php?f=29&t=89031](https://www.raspberrypi.org/forums/viewtopic.php?f=29&t=89031)

如果您想要更简单的东西，只需使用存储库

```
<dependencies>
            <dependency>
                <groupId>br.com.criativasoft.opendevice.ext</groupId>
                <artifactId>bluecove-gpl-arm</artifactId>
                <version>2.1.1-SNAPSHOT</version>
            </dependency>
            <dependency>
                <groupId>br.com.criativasoft.opendevice.ext</groupId>
                <artifactId>bluecove-gpl</artifactId>
                <version>2.1.1-SNAPSHOT</version>
            </dependency>
        </dependencies> 
```

和存储库：

```
<repositories>
        <repository>
            <id>oss.sonatype.org</id>
            <url>http://oss.sonatype.org/content/repositories/releases</url>
        </repository>
        <repository>
            <id>oss.sonatype.org-snapshot</id>
            <url>http://oss.sonatype.org/content/repositories/snapshots</url>
        </repository>
    </repositories> 
```

# google-play - 如何在 Android 中恢复证书？

> ID：15041462
> 
> 赞同：2
> 
> 时间：2013-02-23T14:15:15.533
> 
> 标签：google-play

我在 Google Play 上上传了一个应用程序，很遗憾我丢失了上传应用程序的证书，但我有该应用程序的密码。现在我想上传新版本的应用程序但我没有证书，有没有办法恢复应用程序的证书并上传新版本的应用程序。请在这方面帮助我，您的帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-05-27T14:31:07.427

1）生成新证书：

keytool -genkey -v -keystore my-release-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias my-alias

2) 转换为 .pem：

keytool -export -rfc -alias my-alias -file upload_certificate.pem -keystore my-release-key.jks

3) 将 .pem 发送到联系表：

[一般问题 - Play 管理中心帮助](https://support.google.com/googleplay/android-developer/contact/otherbugs)

回答需要 2 个工作日，但如果您不想重新发布您的应用程序，这就是方法；）

然后你可以像以前一样签署你的apk

（为了我）

zipalign -v 4 android-release-unsigned.apk HelloWorld.apk

阅读更多

[管理您的应用签名密钥](https://support.google.com/googleplay/android-developer/answer/7384423)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-02T18:31:27.617

现在有可能`Google Play App Signing`

简短说明

当您之前使用自定义签名上传到 google play 时，用户正在使用自己的 google 签名安装 apk

如果您没有启用此功能，现在可以在谷歌支持团队的帮助下使用它

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T14:27:04.313

如果您丢失了证书，您将无法恢复它。

这就是证书的重点，它就像现实生活中的（私钥）一样。如果您丢失了钥匙及其副本，则必须更换锁。

# php - 通过 URI 传递时浏览器未转换 & (&)

> ID：15041464
> 
> 赞同：0
> 
> 时间：2013-02-23T14:15:40.137
> 
> 标签：php, xml, rss, uri, ampersand

我有一个 RSS 2.0 项目元素，它需要一个 RSS 链接才能验证。我想在链接元素中插入一个 URI 以链接到我网站上的页面。在这个 URI 中，我使用`&amp;`而不是`&`分隔通过 URI 传递的不同参数。当我这样做时，可以验证 RSS，但是当我将链接元素中的 URI 复制并粘贴到浏览器中时，浏览器不会将其转换`&`为表示 URI 参数的分隔符。

我使用的 XML 编码是 UTF-8。

我使用的 URI 是：

```
http://www.stacks.co.uk/rapmusic/albums.php?echonest_id=ARD5VN51187B9B8D29&amp;deezer_id=3505&amp;artist_name=Jamie+Foxx&amp;artist_image=http%3A%2F%2Fuserserve-ak.last.fm%2Fserve%2F_%2F95148.jpg 
```

我也尝试使用`%26`而不是，`&amp;`但即使这样也不允许我转到我的 URI。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:30:44.960

为了不破坏 RSS XML，您将始终需要使用`&amp;`而不是`&`在 URL 中使用参数。当为提要呈现 RSS 时，它会自动将 ASCII 符号转换为可用的 URL 等价物；即：

```
http://example.com/script.php?param1=foo&amp;param2=bar 
```

会变成：

```
http://example.com/script.php?param1=foo&param2=bar 
```

但是，如果您查看实际的 XML，它仍然会显示解码后的值 - 所以不要让它欺骗您。大约一个月前我遇到了同样的问题。

# sql - 在 SQL Server 中选择数据库名称和扩展属性

> ID：15041465
> 
> 赞同：3
> 
> 时间：2013-02-23T14:15:43.130
> 
> 标签：sql, sql-server, extended-properties

我有三个数据库，从我在 SQL Server 2012 中添加的“MD_”开始。每个数据库都有一个扩展属性 NAME =“DESCRIPTION”

我喜欢返回的是数据库名称和“DESCRIPTION”值的结果集。

选择数据库名称很容易，但我可以使用一些帮助来加入扩展属性。

```
BEGIN
    SELECT A.NAME
    FROM sys.databases A
    Where LEFT(A.NAME, 3) = 'MD_'
END 
```

结果：

```
NAME   DESCRIPTION
MD_1   Initial
MD_2   Secondary
MD_3   Final 
```

任何帮助将不胜感激！亲切的问候

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T15:28:43.667

评论中的链接帮助我到达这里，但 sys.extended_properties 是每个数据库的视图。所以每个数据库的属性都包含在数据库中。这虽然有效。

```
CREATE TABLE #EP (DatabaseName varchar(255), PropertyName varchar(max), 
            PropertyValue varchar(max))

EXEC sp_msforeachdb 'INSERT INTO #EP SELECT ''?'' AS DatabaseName, 
            CAST(name AS varchar), CAST(Value AS varchar) 
        FROM [?].sys.extended_properties WHERE class=0' 
```

如果您想要所有数据库以及它们存在的属性。

```
SELECT db.Name, #EP.PropertyName, #EP.PropertyValue
FROM sys.databases db
LEFT OUTER JOIN #EP
    ON db.name = #EP.DatabaseName 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-02T15:22:35.337

这是另一种选择，不使用临时表但返回多个结果...

```
EXEC sp_msforeachdb N'SELECT name, value 
FROM [?].sys.fn_listextendedproperty(default, default, default, default, default, default, default)' 
```

# php - 如何使用构造函数主题修复 Wordpress 中的浮动侧边栏？

> ID：15041470
> 
> 赞同：1
> 
> 时间：2013-02-23T14:16:15.660
> 
> 标签：php, css, wordpress, constructor

请帮我修复或解决有关侧边栏定位的问题。我在右侧边栏布局中有一个带有构造函数主题的 Wordpress。该网页可以在以下链接中看到。（一个有一个高头菜单，另一个有一个短菜单。侧面菜单的高度也各不相同。）

[http://salvavita.hu/web_2012/](http://salvavita.hu/web_2012/)

[http://salvavita.hu/web_2012/?page_id=119](http://salvavita.hu/web_2012/?page_id=119)

html结构如下：

```
<div class="wrapper" id="wrapcontent">
    <div class="box shadow opacity layout-right" id="content">
        <div id="container">
            content stuff
        </div><!-- id='container' -->

        <aside id="sidebar">
            sidebar stuff
        </aside>
    </div><!-- id='content' -->
</div><!-- id='wrapcontent' --> 
```

出于某种原因，侧边菜单被换成了新行，并在容器外向左按下。您可以在页脚顶部看到它。**如何强制侧边栏与内容在同一行呈现？**（所以它会粘在网站顶部红色部分的底部。）

纯CSS将是首选。此时，如果溢出到右边的内容就可以了。（位置固定不好，因为有两种类型的标题高度，它也必须与恢复的向下窗口一起使用。）

理论上，布局是： 宽度：968px 侧边栏宽度：220px 额外侧边栏宽度：120px（未使用） 标题高度：518px（有自定义编码短变体）

感谢您的帮助，

西罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:41:38.757

Alan Jenkins 是对的，如果您将#sidebar 的宽度从 216px 更改为 208px，那么侧边栏可以正常工作。您对主容器上的大右侧边距和侧边栏上的负左手边距所做的事情对我来说似乎有点奇怪。如果是我，我可能会做更多类似的事情；

```
.layout-right #container {
    /* (Line 197 remove the following rule) */
    margin-right: 220px
}

.layout-right #sidebar { 
    /* (Line 202 remove the following rule) */
    margin-left: -220px;
}

#sidebar {
   /* (Line 208 reduce the width slightly and change the float from left to right) */
   width: 208px;
   float: right;
} 
```

# bash - 获取目录中的最新文件

> ID：15041473
> 
> 赞同：19
> 
> 时间：2013-02-23T14:16:29.750
> 
> 标签：bash, shell, unix

我需要在以 nlb 开头的文件夹中获取最新的目录名称。

```
#!/bin/sh

cd /home/ashot/checkout
dirname=`ls -t nlb* | head -1`
echo $dirname 
```

当文件夹包含许多名称以 nlb 开头的文件夹时，此脚本可以正常工作，但当只有一个名称以 nlb 开头的文件夹时，此脚本会打印该文件夹内的最新文件名。如何更改它以获取最新的目录名称？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T14:17:40.900

将`-d`参数添加到 ls。这样，它总是会打印它所告诉的内容，而不是查看目录内部。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-23T14:29:08.170

```
#!/bin/sh

cd /home/ashot/checkout
dirname=$(ls -dt nlb*/ | head -1)
echo $dirname 
```

正如另一个答案指出的那样，您需要`-d`不查看目录内部。

此处的另一个提示是将 a 添加`/`到模式中。在您指定的问题中获取最新**目录**。有了这个尾随`/`的目录将被匹配，否则如果存在一个最新的文件并且匹配`nlb*`会破坏你的脚本的模式。

我还把现代推荐的写作风格改成了``...``现代`$(...)`推荐的写作风格。

# php - POST 变量未正确保存

> ID：15041474
> 
> 赞同：0
> 
> 时间：2013-02-23T14:16:31.493
> 
> 标签：php, forms

我使用 post 方法发送多个输入文本表单，我从数据库中提取信息，然后重新插入输入文本中的信息：

```
echo "<CENTER><TABLE BORDER='0'>";
echo "<FORM METHOD='POST'>";
$sele_players = "SELECT nombre FROM JUGADORES WHERE NOM_EQUIPO='Aston villa'";
        $sele_players = mysql_query( $sele_players , $link );

        while( $row = @mysql_fetch_assoc( $sele_players ) )
        {
            $row['nombre'] = addslashes( $row['nombre'] );
            echo "<TR><TD ALIGN='CENTER'>".$row['nombre']."</TD>";
            echo "<TD><INPUT TYPE='TEXT' NAME='{$row['nombre']}'></TD></TR>";
        }

        echo "<TR><TD COLSPAN='2' ALIGN='CENTER'><INPUT TYPE='submit' NAME='send2' VALUE='INSERTAR' style='width:200px; height:60px' ></TD></CENTER></TR>"; 
```

好的，我从数据库中获取玩家的名字，然后我使用它们在输入文本中插入他的名字，然后用数组 $_POST 选择：

```
 if( !empty( $_POST['send2'] ) )
    {

        foreach($_POST as $jugador => $points)
        {
            $jugador = str_replace( "__" ,". ", $jugador );
            $jugador = str_replace( "_" ," ", $jugador );

            if( $points == "" )
            {
                $points = "NULL";
            }

            $inser_jornada = "INSERT INTO JORNADA VALUES( '{$_GET['jornada']}','{$_GET['equipo']}', '$jugador', '$points', now() );"; 
```

因此，大多数名称都没有问题，不包括在 $_POST 数组中显示为“N”的 N'Zogbia 名称或撇号名称，我尝试在发送之前添加斜杠但不起作用，所以我不知道如何在 post 数组中获取完整名称，这是主要问题。

谢谢转发！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T03:26:54.257

这里有很多事情要指出。但取而代之的是，我会尽力提供帮助。

添加您的数据库条目，`mysql_real_escape_string($variableName)`用于将内容输入数据库。它会自动转义这些引号并使其成为一点 SQL 注入证明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T03:33:11.920

如前所述，您的代码“尖叫”帮助。有很多事情要指出，但回到你的答案：我认为你的问题出在以下几行：

```
 $inser_jornada = "INSERT INTO JORNADA VALUES( '{$_GET['jornada']}','{$_GET['equipo']}', '$jugador', '$points', now() );"; 
```

试试这个：

```
$inser_jornada = 'INSERT INTO JORNADA VALUES( "' . $_GET['jornada'] . '", "' . $_GET['equipo'] . '", "' . $jugador . '", "' . $points . '", now() );'; 
```

我真的非常建议您对所有输入运行 mysqli_real_escape_string()。

祝你好运！

# c# - 将相同的方法值传递给多个表单

> ID：15041479
> 
> 赞同：2
> 
> 时间：2013-02-23T14:16:40.733
> 
> 标签：c#, winforms

在我的窗口应用程序中，我有 orderNumber 需要传递给另一个表单。这个订单号是由我将在下面放置的代码生成的。我试图仅将 1 个相同的订单号传递到两个位置，但不幸的是，两个不同的订单号传递到了两个位置。我怎样才能使只有一个订单号传递到两个位置。

**生成订单号的代码：**

```
public string orderNumber()
        {
           string ord = "ORD" + get_next_id() + DateTime.Now.Year;
           return ord;

       }

 public int get_next_id()
        {
            OleDbConnection objConnection = null;
            OleDbCommand objCmd = null;
            String sql;
            int res;

            // Create and open the connection object
            objConnection = new OleDbConnection(connString);

            objConnection.Open();
            sql = "SELECT IIF(MAX(Customer.NumGenerate) IS NULL,100,MAX(Customer.NumGenerate)) as v_max FROM Customer;";
            objCmd = new OleDbCommand(sql, objConnection);
            res = (int)objCmd.ExecuteScalar();
            ++res;
            objConnection.Close();
            return res;
        } 
```

在第一种形式中，以下插入方法使用订单号：

```
private void SaveAllListItems()
        {
            string listItems = string.Empty;
            foreach (var listBoxItem in listBox1.Items)
            {

                listItems += listBoxItem.ToString();

                if (listBox1.Items.IndexOf(listBoxItem) < listBox1.Items.Count - 1)
                {
                    listItems += ", ";
                }
            }

            InsertUser(maskedTextBox1.Text, comboBox1.Text, maskedTextBox2.Text, maskedTextBox3.Text, maskedTextBox4.Text, maskedTextBox5.Text,
                       maskedTextBox6.Text, maskedTextBox7.Text, maskedTextBox8.Text, maskedTextBox9.Text, listItems, DateTime.Now, maskedTextBox10.Text, orderNumber(), get_next_id());

;
        } 
```

在第二种形式中，我想使用用于插入用户的相同订单号。现在我有以下代码不起作用，因为 form1 有不同的订单号，而 form 2 有不同。

```
 private void FindOrder()
        {

            Form1 m = new Form1();
            string number = m.orderNumber();
          //  string number = "ORD1012013";

            string InvSql = "SELECT  (Customer.[Title] + SPACE(2)  + Customer.[Customer's Name]) as CustomerName, Customer.[Customer's Ebayname], Customer.[Email Address], Customer.[Phone Number], (Customer.[Address 1] + SPACE(2)  +Customer.[Address 2] + SPACE(2)  + Customer.[City] + SPACE(2)  + Customer.[Post Code]+  SPACE(2)  + Customer.[Country]) as Address, Customer.[Item Purchased], Customer.[Purchased Date], Customer.[Total Price], Customer.[OrderNumber] FROM Customer WHERE Customer.[OrderNumber]= '" + number + "'";

            OleDbConnection cnn = new OleDbConnection(connString);
            OleDbCommand cmdOrder = new OleDbCommand(InvSql, cnn);
            cnn.Open();

            OleDbDataReader rdrOrder = cmdOrder.ExecuteReader();

            rdrOrder.Read();
            custName.Text = rdrOrder["CustomerName"].ToString();
            ebayName.Text = rdrOrder["Customer's Ebayname"].ToString();
            email.Text = rdrOrder["Email Address"].ToString();
            phone.Text = rdrOrder["Phone Number"].ToString();
            address.Text = rdrOrder["Address"].ToString();
            item.Text = rdrOrder["Item Purchased"].ToString();
            date.Text = Convert.ToString(Convert.ToDateTime(rdrOrder["Purchased Date"]));
            price.Text = rdrOrder["Total Price"].ToString();
            order.Text = rdrOrder["OrderNumber"].ToString();

            rdrOrder.Close();
            cnn.Close();
        } 
```

如何将相同的订单号传递到两个位置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T08:31:21.883

创建一个`class`具有`static`相同属性的容器`namespace`：

```
class clsDummy
 {
  internal static string ptyValue { get; set; }
 } 
```

您可以在获取订单 ID 的位置分配此属性：

```
public string orderNumber()
 {
   string ord = "ORD" + get_next_id() + DateTime.Now.Year;
   clsDummy.ptyValue =ord ;
   return ord;
 } 
```

之后你想访问的地方只是检查里面的值：`clsDummy.ptyValue`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:15:35.517

数据可以以不同的方式在表单之间传递。

这是一个关于如何做到这一点的好[教程。构造函数和属性方法更容易实现。](http://www.codeproject.com/Articles/14122/Passing-Data-Between-Forms)

您似乎没有在 form1 类上保存 orderid

为 Form1 类上的 OrderID 声明一个变量

```
string OrderId; 
```

修改您现有的方法

```
public string orderNumber()
{
  OrderId = "ORD" + OrderId + DateTime.Now.Year;      
} 
```

然后按照构造方法将值传递给 PrintForm

再次在 PrintForm 类中为 orderID 声明一个变量

```
string OrderId; 
```

将您的 PrintForm 构造函数更改为此

```
public PrintForm(string value)
{
  InitializeComponent(); 
  OrderId=value;
} 
```

关于 Form1 按钮单击事件

```
private void button1_Click(object sender, System.EventArgs e)
{
    PrintForm frm=new PrintForm(OrderId);
    PrintForm.Show();
} 
```

# json - 访问数组的内容 iOS 6

> ID：15041483
> 
> 赞同：0
> 
> 时间：2013-02-23T14:17:03.637
> 
> 标签：json, api, ios6, nsarray, nsdictionary

我是编码新手，想知道是否有人可以帮助我。我是第一次使用网络服务。我在访问任何数组时都遇到了麻烦。我什么都弄不出来。

现在我可以成功地从 Web 服务获取信息并将其存储在 NSArray 中。我 NSLog 它并看到内容出现在我的控制台中。我检查了数组的计数，它是 5。

但我无法访问任何内容。错误状态：CustomTableView[4083:11303] -[__NSCFDictionary objectAtIndex:]: unrecognized selector sent to instance 0xff231b0

我真的很想知道如何访问数组中的各种值。在此先感谢您的帮助！:)

```
@property (strong, nonatomic) NSArray *searchedYummlyRecipeList;

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    self.searchedYummlyRecipeList = [NSJSONSerialization JSONObjectWithData:self.yummlyRecipesData options:nil error:nil];
    //test logging
    NSLog(@"Recipe List: %@ ", self.searchedYummlyRecipeList);//prints fine
    NSLog(@"Count of test array: %lu", (unsigned long)[self.searchedYummlyRecipeList count]);//prints fine 
    NSArray *testArray = [[self.searchedYummlyRecipeList objectAtIndex:1]objectForKey:@"criteria"];//breakpoint is here
    NSLog(@"test Array: %@", testArray);//doesn't get here
    NSLog(@"test Array count: %lu", (unsigned long)[testArray count]);//doesn't get here

} 
```

nslog 输出的提取：

```
 Recipe List: {
attribution =     {
    html = "<a href='http://www.yummly.com/recipes/onion-soup'>onion soup recipes</a> search powered by <img src='http://static.yummly.com/api-logo.png'/>";
    logo = "http://static.yummly.com/api-logo.png";
    text = "onion soup recipes: search powered by Yummly";
    url = "http://www.yummly.com/recipes/onion-soup";
};
criteria =     {
    allowedIngredients =         (
    );
    excludedIngredients =         (
    );
    facetFields =         (
    );
    maxResults = 6;
    requirePictures = 0;
    resultsToSkip = 0;
    terms =         (
        onion,
        soup
    );
};
facetCounts =     {
};
matches =     (
            {
        attributes =             {
            course =                 (
                Soups,
                Appetizers
            );
            cuisine =                 (
                French
            );
            holiday =                 (
                Thanksgiving
            );
        };
        flavors =             {
            bitter = "0.1666666666666667";
            meaty = "0.1666666666666667";
            piquant = 0;
            salty = "0.1666666666666667";
            sour = "0.1666666666666667";
            sweet = "0.1666666666666667";
        };
        id = "French-Onion-Soup-The-Pioneer-Woman-Cooks-_-Ree-Drummond-41364";
        ingredients =             (
            "beef broth",
            "minced garlic",
            "stick butter",
            "yellow onion",
            "french bread",
            "worcestershire sauce",
            "gruyere cheese",
            "low sodium chicken broth",
            "dry white wine"
        );
        rating = 0;
        recipeName = "French Onion Soup";
        smallImageUrls =             (
            "http://i.yummly.com/French-Onion-Soup-The-Pioneer-Woman-Cooks-_-Ree-Drummond-41364-1512.s.jpg",
            "http://i.yummly.com/French-Onion-Soup-The-Pioneer-Woman-Cooks-_-Ree-Drummond-41364-1199.s.jpg",
            "http://i.yummly.com/French-Onion-Soup-The-Pioneer-Woman-Cooks-_-Ree-Drummond-41364-220.s.jpg"
        );
        sourceDisplayName = "The Pioneer Woman";
        totalTimeInSeconds = 0;
    },
            {
        attributes =             {
            course =                 (
                "Main Dishes"
            );
        };
        flavors =             {
            bitter = 1;
            meaty = "0.1666666666666667";
            piquant = 0;
            salty = 1;
            sour = "0.1666666666666667";
            sweet = "0.3333333333333333";
        };
        id = "Awesome-Slow-Cooker-Pot-Roast-Allrecipes";
        ingredients =             (
            "onion soup mix",
            "condensed cream of mushroom soup",
            "pot roast",
            water
        );
        rating = "4.69";
        recipeName = "Awesome Slow Cooker Pot Roast";
        smallImageUrls =             (
            "http://i2.yummly.com/Awesome-Slow-Cooker-Pot-Roast-Allrecipes-2.s.png",
            "http://i.yummly.com/Awesome-Slow-Cooker-Pot-Roast-Allrecipes-58919.s.png"
        );
        sourceDisplayName = AllRecipes;
        totalTimeInSeconds = 29400;
    },
            {
        attributes =             {
            course =                 (
                Soups
            );
        };
        flavors =             {
            bitter = "0.1666666666666667";
            meaty = "0.1666666666666667";
            piquant = "0.6666666666666666";
            salty = "0.1666666666666667";
            sour = "0.1666666666666667";
            sweet = "0.1666666666666667";
        };
        id = "Chicken-Soup-for-Knaidelach-The-Shiksa-Blog-48854";
        ingredients =             (
            "sea salt",
            "bay leave",
            onions,
            giblets,
            "fresh dill",
            "curly-leaf parsley",
            "whole cloves",
            "chopped leaves",
            "black peppercorns",
            carrot
        );
        rating = 0;
        recipeName = "Chicken Soup for Knaidelach";
        smallImageUrls =             (
            "http://i.yummly.com/Chicken-Soup-for-Knaidelach-The-Shiksa-Blog-48854-10792.s.png",
            "http://i.yummly.com/Chicken-Soup-for-Knaidelach-The-Shiksa-Blog-48854-10711.s.png",
            "http://i.yummly.com/Chicken-Soup-for-Knaidelach-The-Shiksa-Blog-48854-10617.s.png"
        );
        sourceDisplayName = "The Shiksa in the Kitchen";
        totalTimeInSeconds = 10800;
    },
            {
        attributes =             {
            course =                 (
                Soups
            );
            cuisine =                 (
                American
            );
        };
        flavors = "<null>";
        id = "Chicken-Soup-The-Pioneer-Woman-200156";
        ingredients =             (
            ribs,
            carrots,
            chicken,
            "bay leaf",
            salt,
            parsnips,
            "black pepper",
            onion,
            "chicken broth"
        );
        rating = 0;
        recipeName = "Chicken Soup";
        smallImageUrls =             (
            "http://i.yummly.com/Chicken-Soup-The-Pioneer-Woman-200156-39944.s.png"
        );
        sourceDisplayName = "The Pioneer Woman";
        totalTimeInSeconds = 0;
    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:28:30.810

“[__NSCFDictionary objectAtIndex:]: unrecognized selector”告诉您“objectAtIndex”选择器（方法）被“发送”到（调用）一个 NSDictionary 对象。但是 objectAtIndex 不是 NSDictionary 的方法，因此会出错。

目前尚不清楚您试图访问什么“数组”，但它不是一个数组，它是一个“字典”——一个键->值映射对象。您将使用“objectForKey”来访问它。

请注意，在 Objective-C 中很容易将错误的类型放入变量中。仅仅因为变量的类型是“NSArray*”并不意味着它真的是一个NSArray——例如，您可以从JSON 解析器中得到一个字典而不是一个数组（因为这就是JSON“所说的”）。

在您上面的清单中，“searchedYummlyRecipeList”绝对是一个 NSDictionary—— `{}`NSLog 中的字符表明了这一点。（一个数组将被包围`()`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:25:08.177

看起来你的食谱列表是一个字典，而不是一个数组。'criteria' 键的值也是一个字典（恰好包含一些数组值的字典）。

要获取标准字典，您可以执行以下操作：

```
NSDictionary *criteria = self.searchedYummlyRecipeList[@"criteria"]; 
```

您当然还应该修复您的 @property 声明：

`@property (strong, nonatomic) NSDictionary *searchedYummlyRecipeList;`

## 编辑

因此，为了进一步从标准字典中获取值，您可能会这样做：

`NSNumber *maxResults = criteria[@"maxResults"];`

或者，您可以使用键路径来获取特定值：

`NSString *url = [self.searchedYummlyRecipeList valueForKeyPath:@"attribution.url"];`

另一方面，匹配项是一个数组。如果要查看第一个匹配项，例如：

```
NSArray *matches = self.searchedYummlyRecipeList[@"matches"];
NSDictionary *firstMatch = matches[0];
NSString *firstMatchID = firstMatch[@"id"]; 
```

# asp.net - 如何在 ajax 组合框中输入文本

> ID：15041485
> 
> 赞同：0
> 
> 时间：2013-02-23T14:17:10.667
> 
> 标签：asp.net

我在我的页面中添加了 ajax 组合框，但我有 2 个问题。

1-我无法输入。

2-当我输入那个时，它会自动找到匹配的单词。例如，当我输入“j”时，它会找到“jack”。

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs"  Inherits="_Default" %>

<%@ Register assembly="AjaxControlToolkit" namespace="AjaxControlToolkit" tagprefix="asp" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Untitled Page</title>
    </head>
   <body>
<form id="form1" runat="server">
<div>

    <asp:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server"></asp:ToolkitScriptManager>
    <asp:UpdatePanel ID="UpdatePanel1" runat="server">
    <ContentTemplate>

    <asp:ComboBox ID="ComboBox1" runat="server" AutoCompleteMode="SuggestAppend" 
            DropDownStyle="DropDownList" 

              style="display: inline;">
        <asp:ListItem>masoud</asp:ListItem>
        <asp:ListItem>jack</asp:ListItem>
    </asp:ComboBox>

    </ContentTemplate>
</asp:UpdatePanel>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-29T16:59:31.963

你的浏览器是火狐吗？如果是这样，您可能必须将 ComboBox 控件的 MaxLength 属性更改为默认值 0 以外的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-04T07:21:03.807

正如@CallumHolden 所说..如果您将 dropdownstyle 属性设置为 dropdown 而不是 dropdownlist 它将起作用。这也解决了我的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:26:00.253

此链接将向您展示如何使用所有 ajax 控件，请查看组合框之一。然后你可以看到你需要哪一个。

[http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/ComboBox/ComboBox.aspx](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/ComboBox/ComboBox.aspx)

这是所有带有示例的 ajax 控件的链接。

# jsf-2 - 使用 JSF 2 从客户端 (js) 进行 PGP 加密

> ID：15041487
> 
> 赞同：0
> 
> 时间：2013-02-23T14:17:16.223
> 
> 标签：jsf-2, pgp

当客户端选择带有上传组件的文件时，我需要使用 JSF 2（创建面孔组件）或 primefaces 2.2（我在上传组件中从客户端看不到任何内容）从客户端实现 PGP 加密，因为文件包含机密信息，来自服务器的加密没有帮助，你能给我一些帮助或任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:37:11.860

JSF/PrimeFaces 不会对您有太大帮助 - 如果您必须在发送之前加密文件，则必须在 JavaScript 中在客户端完成。所以你必须在 JS 中读取文件，在 JS 中加密，然后你可以使用 Base64 之类的东西对加密的内容进行编码，将该值分配给 inputText，然后提交给服务器。

请参阅[JavaScript 读取文件内容](https://stackoverflow.com/questions/9265091/javascript-read-file-contents) 和 [http://www.hanewin.net/encrypt/](http://www.hanewin.net/encrypt/)

# c# - 从 Excel 中检索“行对”

> ID：15041489
> 
> 赞同：3
> 
> 时间：2013-02-23T14:17:19.217
> 
> 标签：c#, linq, excel, grouping

我正在尝试使用 C# 从 Excel 电子表格中检索数据。电子表格中的数据具有以下特点：

*   没有分配列名

*   行可以有不同的列长度

*   一些行是元数据，这些行标记下一行中列的内容

因此，我需要构造的对象将始终在第一列中具有它们的名称，并且其参数包含在接下来的列中。从上面的行中检索参数名称很重要。一个例子：

```
row1|---------|FirstName|Surname|

row2|---Person|Bob------|Bloggs-|

row3|---------|---------|-------|

row4|---------|Make-----|Model--|

row5|------Car|Toyota---|Prius--| 
```

所以不幸的是数据是异构的，确定哪些行“属于一起”的唯一方法是检查行中的第一列是否为空。如果是，则读取该行中的所有数据，并通过检查上面的行来检查哪些参数名称适用。起初我认为直接的方法是简单地循环

1）包含所有工作表的数据集，然后
是 2）数据表（即工作表）和
3）行。

但是，我发现尝试使用嵌套循环和 if 语句提取这些数据会导致代码变得糟糕、不可读和不灵活。有没有办法在 LINQ 中做到这一点？我查看了[这篇文章](https://stackoverflow.com/questions/2396954/how-to-filter-out-null-rows-from-datatable-with-linq)，首先过滤了数据之间的空行，但并没有真正得到任何结果。有人可以用一些代码片段为我指明正确的方向吗？

提前致谢 ！广

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:40:53.230

我看到您已经接受了答案，但我认为更通用的解决方案是可能的 - 使用反射。

假设您将数据作为一个`List<string[]>`列表中的每个元素是一个字符串数组，其中包含来自相应行的所有单元格。

```
List<string[]> data;
data = LoadData();

var results = new List<object>();
string[] headerRow;

var en = data.GetEnumerator();
while(en.MoveNext())
{
    var row = en.Current;
    if(string.IsNullOrEmpty(row[0]))
    {
        headerRow = row.Skip(1).ToArray();
    }
    else
    {
        Type objType = Type.GetType(row[0]);
        object newItem = Activator.CreateInstance(objType);

        for(int i = 0; i < headerRow.Length; i++)
        {
            objType.GetProperty(headerRow[i]).SetValue(newItem, row[i+1]);
        }
        results.Add(newItem);
    }
} 
```

# jquery - 搜索表单不适用于 jquery 动画

> ID：15041490
> 
> 赞同：1
> 
> 时间：2013-02-23T14:17:20.980
> 
> 标签：jquery, jquery-animate, search-form

我有这个用 jQuery 动画的[搜索表单。](http://www.fuiba.com/ux/search/ndx.html)`.button`问题是，当我在打开输入（类）后单击搜索图标（带有类）时`.globalsearch_input`，搜索不起作用，因为动画覆盖了搜索操作。

HTML：

```
<div id="header">
        <div class="wrapper-simple">
            <form method="get" action="">
                <input type="hidden" value="">
                <input type="text" value="" class="globalsearch_input" placeholder="Search...">
                <input type="submit" value="" class="globalsearch_submit" >
                <button type="submit" value="" class="globalsearch_submit button"></button>                  
            </form>
        </div>
    </div> 
```

jQuery：

```
$(document).ready(function() {
    $('.wrapper-simple button.globalsearch_submit').click(function(){
        $('#statistics').hide();
        $('.wrapper-simple').animate({'width':'275px'})
            .end().find('.wrapper-simple input[type=text]').css({opacity: 0, visibility: "visible"}).animate({'width': '231px', opacity: 1}) 
            .end().find('.wrapper-simple .button').animate({ 'right': '30px' })//.attr('disabled', false)   
            .end().find('.wrapper-simple input[type=submit]').css({'background': 'url("close.png") no-repeat center'}).animate({'marginLeft':'235px', opacity: 1}, 10).hover(function() {
                $(this).addClass('close-hover');
            }, function() {
                $(this).removeClass('close-hover');
            }); 
        return false;
    }); 
    $('.wrapper-simple input[type=submit]').click(function() {
        $('#statistics').show();
        $('#statistics').delay(500).css('opacity',0).show().animate({opacity:1},100); 

        $('.wrapper-simple').animate({'width':'40px'}) 
            .end().find('.wrapper-simple input[type=text]').animate({'width': '1px', opacity: 0})
            .end().find('.wrapper-simple .button').animate({ 'right': '0' })//.attr('disabled', true)
            .end().find('.wrapper-simple input[type=submit]').animate({'marginLeft':'0', opacity: 0}).attr('value', ''); 
        return false;
    });
}); 
```

打开输入后，如何停止**.button**的动画？
我试过了，`.attr('disabled', true)`但没有用。

任何帮助表示赞赏。
谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:35:55.500

一种不需要解除绑定事件处理程序的可能方法是使用简单的类名条件。

例如，使用`expanded`添加到按钮的类名，

```
var $globalsearch_submit = $('.wrapper-simple button.globalsearch_submit');

$globalsearch_submit.click(function(){
    if($globalsearch_submit.hasClass("expanded")) {
        /* Process form's submit */
        return true;
    }
    $globalsearch_submit.addClass("expanded");
    ...
}); 

$('.wrapper-simple input[type=submit]').click(function() {
    $globalsearch_submit.removeClass("expanded");
    ...
}); 
```

# javascript - magento：在每个页面上添加自定义 html

> ID：15041492
> 
> 赞同：0
> 
> 时间：2013-02-23T14:17:27.190
> 
> 标签：javascript, magento

我想在我网站的每个页面（magento）上添加一些使用 javascript 和 .css 的简单 html 代码。

我已经知道在 head 部分中添加 javascript 和 .css 文件的位置。

想知道 html 代码放在哪里？（可能在`<body></body>`标签内，不在`<head></head>`章节内）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:20:47.923

后端有一个配置字段，用于统计、跟踪器等。

```
System > Configuration > Design > Footer 
```

# codeigniter - Codeigniter - 全新 xampp 安装的空白页

> ID：15041501
> 
> 赞同：0
> 
> 时间：2013-02-23T14:18:34.180
> 
> 标签：codeigniter, xampp

我有奇怪的问题。我必须修改旧的 CodeIgniter 项目。

我使用本地 Windows XAMPP 服务器进行开发，我的项目正在使用 XAMPP。

几周前我重新安装了操作系统。我安装了 XAMPP（相同版本）并将 htdocs 从默认值`c:\xampp\htdocs`移至`e:\htdocs`. 我对移动 htdocs 的 XAMPP 没有任何问题（其他非 codeigniter 项目运行良好）。

今天我将应用程序从生产服务器复制到我的本地主机，但它不工作。

当我尝试在浏览器中打开时：`http://localhost/myprojectfolder`我得到空白页。

在本地 Windows XAMPP 上干净的 CodeIgniter 安装可以工作（但是干净的安装不使用 .htaccess）。

项目在具有 .htaccess 文件的生产 Web 服务器上正常工作，如下所示：

```
<IfModule mod_rewrite.c>

    RewriteEngine On
    RewriteBase /myprojectfolder

    ### Canonicalize codeigniter URLs

    # If your default controller is something other than
    # "welcome" you should probably change this
    # RewriteRule ^(welcome(/index)?|index(\.php)?)/?$ / [L,R=301]
    # RewriteRule ^(.*)/index/?$ $1 [L,R=301]

    # Removes trailing slashes (prevents SEO duplicate content issues)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)/$ $1 [L,R=301]

    # Removes access to the system folder by users.
    # Additionally this will allow you to create a System.php controller,
    # previously this would not have been possible.
    # 'system' can be replaced if you have renamed your system folder.
    # RewriteCond %{REQUEST_URI} ^system.*
    # RewriteRule ^(.*)$ /index.php/$1 [L]

    # Checks to see if the user is attempting to access a valid file,
    # such as an image or css document, if this isn't true it sends the
    # request to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?/$1 [L]

</IfModule>

<IfModule !mod_rewrite.c>

    # Without mod_rewrite, route 404's to the front controller
    ErrorDocument 404 /index.php

</IfModule> 
```

我不记得，我是否有单独的 .htaccess 文件用于 localhost。如果我有 - 它被生产服务器的文件覆盖。

项目中使用的 MySQL 数据库在两台服务器上都是相同的（名称、用户、密码、结构等）。

我`$config['uri_protocol']`的设置为`AUTO`，它正在使用`AUTO`.

我的文件权限`htdocs`很好（启动 httpd.exe 服务的用户可以在那里读写）。

我的路由：

```
$route['default_controller'] = "home";
$route['admin'] = 'admin/start';
$route['404_override'] = ''; 
```

有任何想法吗？

# php - 过滤掉早于自定义日期字段的帖子

> ID：15041503
> 
> 赞同：1
> 
> 时间：2013-02-23T14:18:49.457
> 
> 标签：php, wordpress, date, conditional-statements

我正在尝试隐藏自定义日期字段早于今天日期的帖子。我的代码当前设置的方式是在 LI 标签中添加一个名为 expired 的类，如果较旧但它不玩球......

```
 <?php 
                wp_reset_query();

                query_posts(array('post_type' => 'events',
                                  'showposts' => 5,
                                  'meta_key'=>'event_date',  
                                  'orderby' => 'meta_value', 
                                  'order' => ASC));
            ?>

            <?php while (have_posts()) : the_post(); ?>

                                    <?php 

                                        $eventDate = DateTime::createFromFormat('Ymd', get_field('event_date'));
                                        $currentdate = date("Ymd");

                                    ?>

                            <li class="<? if ($eventDate < $currentdate) { echo "expired"; } ?>">

                                    <h4><a href="<?php the_permalink() ?>"><?php the_title(); ?></a></h4>
                                    <span class="date"><strong>Event Date:</strong> <? echo $eventDate->format('d/m/Y'); ?></span>

                            </li>

            <?php endwhile;?> 
```

请帮帮我:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:53:30.213

目前您正在将[DateTime](http://www.php.net/manual/en/class.datetime.php)对象与字符串进行比较 - 您需要确保您正在比较等效的数据类型：

```
// Convert stored date to DateTime object
$eventDate = DateTime::createFromFormat('Ymd', get_field('event_date'));

// Get the current date as a DateTime object
$nowDate = new DateTime();

// And compare them
if ($eventDate == $nowDate) {
   // They're the same, woohoo
} elseif ($eventDate < $nowDate) {
   // Expired
} 
```

# ruby-on-rails-3.2 - 为什么我需要在带有 rails / ajax 的远程链接上添加“数据：{type：”script“}”

> ID：15041506
> 
> 赞同：5
> 
> 时间：2013-02-23T14:19:10.157
> 
> 标签：ruby-on-rails-3.2, ujs

在我的一个项目中，代码：

```
 = link_to "add", new_me_category_path, class: "btn btn-success", remote: true 
```

可以正确加载远程表单。

但是有些不能工作，浏览器没有执行responese js代码。我需要像这样添加“数据：{type：”script“}”：

```
 = link_to "add", new_me_category_path, class: "btn btn-success", remote: true, data: {type: "script"} 
```

我想知道原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-27T15:12:18.473

我不是 JS 专家，也不懂 Ruby，但我认为：

当数据类型设置为`script`- 下载的代码会立即加载并执行。

当数据类型为默认 ( `html`) - 下载的代码只是加载到浏览器中。您必须“手动”执行它（例如通过调用某些函数）。

如果您的代码只有一些函数可用于先前加载的代码 - 这些函数将可用并且可以工作（当数据类型为 时`html`）。

如果您的代码中有定义的事件 - 它们将不起作用，因为它们没有被初始化，因为代码没有被执行。

`jQuery.get()`如果我的解释不好 - 您可能会阅读和`jQuery.getScript()`方法之间的区别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-26T18:14:32.987

在幕后，使用 jQuery 的`ajax`方法：[http://api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/) by uJS [https://github.com/rails/jquery-ujs](https://github.com/rails/jquery-ujs)每当`data-remote="true"`设置链接的属性时，就完成了由`remote: true`.

如文档中所述，Ajax 确定发送的 HTTP Accepts 标头并根据传递给的`dataType`和参数解释返回值，此处这些参数取自uJS 的锚点属性。`accepts``ajax()``data-`

如果`dataType`通过`data-type`属性设置 no，jQuery 会“智能地”推断请求和响应类型。如果您没有明确指定它，这可以解释不一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T10:11:13.060

如果你加载脚本正确的模板应该有`.ejs`扩展名（或者像这样渲染原始脚本：）`render js: 'some code'`。您必须`j`像这样在 ejs 模板中使用 html 转义：

模板.ejs

```
$('some selector').html('<%= j render('some template') %>'); 
```

请也给我网址。正确的应该以 . 结尾`.js`。

# java - 从Java执行屏幕命令

> ID：15041515
> 
> 赞同：0
> 
> 时间：2013-02-23T14:20:46.327
> 
> 标签：java, linux, sh, gnu-screen

我正在使用以下代码在 Linux 中执行 SH 文件

```
Runtime.getRuntime().exec(new String[] { "/bin/sh", "-c", file.getPath() }); 
```

此代码有效，但是从 Java 执行时我无法在 SH 文件中使用 screen 命令，我收到此错误

> 必须连接到终端。

那么有可能将java“连接”到终端吗？当我通过 SSH 连接时，我希望也能够查看此屏幕，因此我认为它必须连接到您通过 SSH 连接到服务器时显示的终端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T22:03:41.823

我发现如果我使用`screen -dm`它会起作用。谢谢！

# opengl - 什么是openGL中的顺时针面

> ID：15041517
> 
> 赞同：8
> 
> 时间：2013-02-23T14:20:49.217
> 
> 标签：opengl, graphics, render, raster, culling

在背面剔除中，您可以使用面法线来查看面是否指向您的相机，如果三角形是顺时针绘制还是逆时针绘制，您可以做一些技巧。

我对顺时针方向的这种技术感到困惑。似乎使用这种方法，发送到显卡的顶点数据的顺序决定了它是面向还是远离相机。我不明白这有什么意义，因为相机可以朝任何方向看，就好像顶点数据必须根据相机位置而改变，而这显然不是在 CPU 上完成的。

我怎么能理解这个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T14:55:14.630

这是从对边看的一个三角形：

![顺时针与逆时针](../Images/736b52b8c0fc6e3a082e3658fc51e183.png)

3D 空间中的 3 个点定义了一个三角形。此外，如果这些点是有序的（如这里），它们还确定三角形的两个边（面）：顺时针和逆时针（它们由放置在面内的顺序时钟确定，将指向其顶点）

在上面的例子中，三角形是逆时针纹理的

现在想象这个三角形是骰子的一个元素：

![ccw 纹理盒](../Images/e31dcf126ae60b7fa8cc9675f59ca2d7.png)

如果你掷骰子（或围绕它旋转相机），我们的逆时针三角形变成顺时针，我们不希望它再有纹理了。

这个骰子实际上是由 12 个这样的三角形组成的，如果我们对它们进行正确排序，我们将一次只对 6 个面向相机的纹理进行纹理处理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T14:47:14.950

我将在一个示例四边形上向您展示：

```
 (0,0)-------(1,0)
    |           |
    |     X     |
    |           |
  (0,1)-------(1,1) 
```

假设我们从`(0,0)`. 现在，如果您以“顺时针”顺序缠绕（通过）顶点，下一个将`(1,0)`是`(1,1)`和`(0,1)`。`(1,0)`或多或少在 2 点钟，`(1,1)`4 点钟，依此类推。

因此 GPU 内存中的数据：`0,0, 1,0, 1,1, 0,1`.

当您将卷绕方向与您的设置相关联时，您可以轻松区分什么是“正面”和“背面” - 为了更好地想象，您可以将它画在透明的东西上，然后从另一侧看 - 卷绕方向将是逆转。

所以上卷方向的规范只是告诉GPU哪一边是前面，哪一边是后面，因为它不能自己做——三角形的两边都一样好，给定多边形的法向量可以要么是`N`要么`-N`。但是，GPU 可以验证它们中的哪些与正确的结束顺序对齐。

[The (Old) Red Book 的](http://www.glprogramming.com/red/chapter02.html)第 2 章对 OpenGL 特定的东西有一些很好的解释，这在今天仍然很相关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-15T08:05:52.317

这正是重点：当您创建/绘制面部时，顶点顺序*最初*与相机方向无关！请注意，相机只是一种变换，而不是由 openGL 本身识别的东西。
因此，在渲染时，在您通过相机“观看”之后，openGL 只需检查（如果启用了剔除）面顶点的新顺序，现在根据新方向（在应用所有变换之后），以显示与否。

# php - socket_bind() 无法绑定地址

> ID：15041518
> 
> 赞同：4
> 
> 时间：2013-02-23T14:20:55.910
> 
> 标签：php, linux, webserver, websocket

我正在尝试为我正在处理的一个小项目创建一个 Web 套接字服务器。

我已经设置了服务器（位于家里）并转发了 80 和 22 端口。我阅读了本教程：[这里](http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/)

每当我 ssh 进入我的服务器以运行“startDarmon.php”时，我都会收到以下错误：

```
PHP Warning:  socket_bind(): unable to bind address [98]: Address already in use in  
/var/www/server/socket.class.php on line 48
2013-02-23 14:15:38 System: Socket bound to localhost:8000.
2013-02-23 14:15:38 System: Start listening on Socket 
```

这就是我认为阻止我的客户端连接到服务器的原因。所以在 startDarmon.php 文件中我有：

```
$WebSocket = new socketWebSocket('MY_IP_NOT_LAN_IP',8000); 
```

在我的客户文件中，我有：

```
var host = "ws://MY_IP_NOT_LAN:8000/server/startDaemon.php"; 
```

有没有人对为什么这不允许我建立连接有任何建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T14:26:13.573

我猜问题出在Linux服务器上。

`netstat -a -p -n`在 root 下运行命令（例如使用`sudo`）以了解哪个进程正在使用该端口。然后也许做一个[setsockopt(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/setsockopt.2.html)（更多`SO_REUSEADDR` 见[socket(7)](http://www.kernel.org/doc/man-pages/online/pages/man7/socket.7.html)）。

TCP 协议在几分钟内有一些指定的延迟（例如，keepalive 等）。参见例如[tcp(7)](http://www.kernel.org/doc/man-pages/online/pages/man7/tcp.7.html)

我确实建议阅读一本关于 Linux 系统编程的好书，比如[Advanced Linux Programming](http://advancedlinuxprogramming.com/)，也许还有一些关于网络编程的材料。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-08T09:09:02.577

您可以使用以下设置重复使用地址：

```
if ( ! socket_set_option($sock, SOL_SOCKET, SO_REUSEADDR, 1)) 
{ 
    echo socket_strerror(socket_last_error($sock)); 
    exit; 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-28T06:36:29.783

另一个应用程序已经在使用您尝试使用的端口。您可以运行

```
lsof -i:port_no 
```

使端口自由。

# c++ - 基准测试、代码重新排序、易失性

> ID：15041519
> 
> 赞同：19
> 
> 时间：2013-02-23T14:21:05.443
> 
> 标签：c++, benchmarking, compiler-optimization, volatile

我决定要对特定函数进行基准测试，所以我天真地编写了这样的代码：

```
#include <ctime>
#include <iostream>

int SlowCalculation(int input) { ... }

int main() {
    std::cout << "Benchmark running..." << std::endl;
    std::clock_t start = std::clock();
    int answer = SlowCalculation(42);
    std::clock_t stop = std::clock();
    double delta = (stop - start) * 1.0 / CLOCKS_PER_SEC;
    std::cout << "Benchmark took " << delta << " seconds, and the answer was "
              << answer << '.' << std::endl;
    return 0;
} 
```

一位同事指出我应该声明`start`and`stop`变量`volatile`以避免代码重新排序。例如，他建议优化器可以像这样有效地重新排序代码：

```
 std::clock_t start = std::clock();
    std::clock_t stop = std::clock();
    int answer = SlowCalculation(42); 
```

起初我怀疑这种极端的重新排序是否被允许，但经过一些研究和实验，我知道它是允许的。

但是 volatile 感觉不是正确的解决方案。volatile 不只是用于内存映射 I/O 吗？

尽管如此，我补充说`volatile`，不仅基准测试花费的时间明显更长，而且每次运行都非常不一致。如果没有 volatile（并且幸运地确保代码没有被重新排序），基准测试始终需要 600-700 毫秒。使用 volatile，通常需要 1200 毫秒，有时甚至超过 5000 毫秒。两个版本的反汇编列表显示除了寄存器选择不同之外几乎没有区别。这让我想知道是否有另一种方法可以避免代码重新排序而不会产生如此巨大的副作用。

我的问题是：

> 在这样的基准测试代码中防止代码重新排序的最佳方法是什么？

我的问题类似于[这个](https://stackoverflow.com/questions/6130100/using-volatile-to-prevent-compiler-optimization-in-benchmarking-code)（关于使用 volatile 避免省略而不是重新排序）、[这个](https://stackoverflow.com/questions/4247586/benchmarking-using-ctime-and-instruction-reordering)（没有回答如何防止重新排序）和[这个](https://stackoverflow.com/questions/9712192/can-compiler-reorder-code-over-calls-to-stdchronosystem-clocknow)（争论问题是代码重新排序还是死代码）消除）。虽然这三个人都在这个确切的话题上，但没有人真正回答我的问题。

**更新**：答案似乎是我的同事弄错了，这样的重新排序不符合标准。我赞成所有这么说的人，并将赏金授予马克西姆。

我见过一个案例（基于[此问题](https://stackoverflow.com/questions/14965553/difficulties-to-measure-c-c-performance/14981627#14981627)中的代码），其中 Visual Studio 2010 按照我的说明重新排序了时钟调用（仅在 64 位版本中）。我试图做一个最小的案例来说明这一点，以便我可以在 Microsoft Connect 上提交错误。

对于那些说 volatile 应该慢得多的人，因为它强制读取和写入内存，这与发出的代码不太一致。在我对[这个问题](https://stackoverflow.com/questions/14965553/difficulties-to-measure-c-c-performance/14981627#14981627)的回答中，我展示了带有和不带有 volatile 的代码的反汇编。在循环内部，所有内容都保存在寄存器中。唯一的显着差异似乎是寄存器选择。我不太了解 x86 程序集，无法知道为什么非易失性版本的性能*始终如一*地快，而易失性版本的性能却*不一致*（有时甚至非常慢）。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-25T16:35:12.663

> 一位同事指出，我应该将 start 和 stop 变量声明为 volatile 以避免代码重新排序。

对不起，但你的同事错了。

编译器不会对定义在编译时不可用的函数的调用重新排序。简单地想象一下，如果编译器将这些调用重新排序`fork`，`exec`或者围绕这些调用移动代码，将会产生怎样的欢笑。

换句话说，任何没有定义的函数都是编译时内存屏障，也就是说，编译器不会移动调用之前的后续语句或调用之后的先前语句。

在您的代码调用中，`std::clock`最终调用定义不可用的函数。

我不能推荐足够多的[原子武器：C++ 内存模型和现代硬件](http://herbsutter.com/2013/02/11/atomic-weapons-the-c-memory-model-and-modern-hardware/)，因为它讨论了关于（编译时）内存屏障的误解以及`volatile`许多其他有用的东西。

> 尽管如此，我添加了 volatile 并发现基准测试不仅花费了更长的时间，而且每次运行都非常不一致。如果没有 volatile（并且幸运地确保代码没有被重新排序），基准测试始终需要 600-700 毫秒。使用 volatile，通常需要 1200 毫秒，有时甚至超过 5000 毫秒

不确定是否`volatile`应该归咎于此。

报告的运行时间取决于基准测试的运行方式。确保禁用 CPU 频率缩放，以便它不会打开涡轮模式或在运行过程中切换频率。此外，微基准测试应作为实时优先级进程运行，以避免调度噪音。可能是在另一次运行期间，某些后台文件索引器开始与您的基准测试竞争 CPU 时间。有关更多详细信息，请参阅[此](https://stackoverflow.com/questions/9006596/is-the-unix-time-command-accurate-enough-for-benchmarks/9006802#9006802)内容。

一个好的做法是测量多次执行函数所需的时间并报告 min/avg/median/max/stdev/total 时间数。高标准偏差可能表明没有进行上述准备工作。第一次运行通常是最长的，因为 CPU 缓存可能是冷的，它可能需要许多缓存未命中和页面错误，并且还会在第一次调用时解析来自共享库的动态符号（惰性符号解析是 Linux 上的默认运行时链接模式，例如），而后续调用将以更少的开销执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T17:10:09.207

防止重新排序的常用方法是编译障碍，即`asm volatile ("":::"memory");`（使用 gcc）。这是一条什么都不做的 asm 指令，但我们告诉编译器它将破坏内存，因此不允许在其中重新排序代码。这样做的成本只是删除重新排序的实际成本，这显然不是改变优化级别等其他地方所建议的情况。

我相信`_ReadWriteBarrier`微软的东西是等价的。

根据 Maxim Yegorushkin 的回答，重新排序不太可能是您的问题的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-17T22:14:39.473

**相关问题：如何阻止编译器将一个微小的重复计算提升出循环**

我在任何地方都找不到这个 - 所以在提出问题 11 年后添加我自己的答案;)。

对变量使用 volatile 不是您想要的。这将导致编译器每次都从 RAM 中加载和存储这些变量（假设必须保留该变量的副作用：aka - 对 I/O 寄存器有益）。当您进行基准标记时，您对测量从记忆中获取某些内容或将其写在那里需要多长时间不感兴趣。通常你只希望你的变量在 CPU 寄存器中。

`volatile`如果您在没有得到优化的循环之外分配给它*一次（例如对数组求和），则可以使用它作为打印结果的替代方法。*（就像问题中的长期运行函数一样）。但不在一个小循环*内；*这将引入存储/重新加载指令和存储转发延迟。

* * *

我认为提交编译器不将基准代码优化到地狱的唯一方法是使用`asm`. 这使您可以欺骗编译器，使其认为它对您的变量内容或用法一无所知，因此它必须每次都做所有事情，就像您的循环要求它做的那样频繁。

例如，如果我想对`m & -m`m 的位置进行基准测试`uint64_t`，我可以尝试：

```
uint64_t const m = 0x0000080e70100000UL;
for (int i = 0; i < loopsize; ++i)
{
  uint64_t result = m & -m;
} 
```

编译器显然会说：我什至不打算计算它；因为你没有使用结果。又名，它实际上会这样做：

```
for (int i = 0; i < loopsize; ++i)
{
} 
```

然后你可以尝试：

```
uint64_t const m = 0x0000080e70100000UL;
static uint64_t volatile result;
for (int i = 0; i < loopsize; ++i)
{
  result = m & -m;
} 
```

编译器说，好的 - 所以你希望我每次都写结果并做

```
uint64_t const m = 0x0000080e70100000UL;
uint64_t tmp = m & -m;
static uint64_t volatile result;
for (int i = 0; i < loopsize; ++i)
{
  result = tmp;
} 
```

`result` `loopsize`正如您所要求的，花费大量时间写入时间的内存地址。

最后，您也可以使`m`volatile，但结果在汇编中看起来像这样：

```
507b:   ba e8 03 00 00          mov    $0x3e8,%edx
  # top of loop
5080:   48 8b 05 89 ef 20 00    mov    0x20ef89(%rip),%rax        # 214010 <m_test>
5087:   48 8b 0d 82 ef 20 00    mov    0x20ef82(%rip),%rcx        # 214010 <m_test>
508e:   48 f7 d8                neg    %rax
5091:   48 21 c8                and    %rcx,%rax
5094:   48 89 44 24 28          mov    %rax,0x28(%rsp)
5099:   83 ea 01                sub    $0x1,%edx
509c:   75 e2                   jne    5080 <main+0x120> 
```

除了请求的寄存器计算之外，从内存读取两次并写入一次。

**因此，正确的方法是**：

```
for (int i = 0; i < loopsize; ++i)
{
  uint64_t result = m & -m;
  asm volatile ("" : "+r" (m) : "r" (result));
} 
```

这会产生汇编代码（[来自 Godbolt 编译器资源管理器上的 gcc8.2](https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAM1QDsCBlZAQwBtMQBGAOgCYAOAJyCALAFYADPwDswucNIArLqVbNaoZAFJeAIR27SAZ1QBXYsg4ByHQGY8tZK1NYA1FtsBhIwXz1uCB7YWhIAgiGhAG6oeOiuBJg%2BVKaOnBLpENGxAJTu0vphrkWuDgSurKioAA5GeABemO62ACKuaekeBaHFrqalAGwiAPplALZNrRIAHumz/BKY0hLtswCqADKdERE9NMSuEKUlE64SnccenuWVNfWY5wYGeNk7xVr5rz199IMjrsSJUysMoeVrjHT9VwAWlGW0KPVczCM42iagIeHYBx0vGxrhA7l4OL0xFxEFGuXx2JJhIOAKMQII2Reti6PXezW20g5YW2YSycQSSRSyAgKVqwFomDiFWqtQauXerOK3wIvzGJ2ms3S80Wyy1Eg2cO6xXQqDySq%2BA2GZTpDJO4N4kJhRoRiORrlRzHRmIg2NxlMJBmpvAO5LxBN4wdpgOBTJdby5rgA7ggMY0IFCoTLbvLzq4APT51y0PCWN3jTCRTC0ZOEBD/FLo0aNSLMYh4ZgAI0x2bl9x5XN54TChYjoKjaFoPmIzCO7GY6CM8TNzGu1ShLGI7alriwVWrWEcAE9yngANaNcEtVwOp2wvkxOJmAhVUxEWisI%2Biqd4CU73t3AqHzwkUKpqjeGozFqOpLCs6SGiyny7maipIaBVp/LawL2gSd7xj0o7CggmDIGe8TERGha4p2b7vsurhGJgjQEBRDisA4mBQki4xoKMzb0LWLHkY0OhiK41SYDOtCLq4VAYuwcQOGh5YeqgaJpliga8LY4lvq%2BIK8JIxQOPpBJiJw/pji0UZkhSEY2VhjLMhaeStCmGkZlmNx9s5nLcsOAVgdaxZ0EMnrepg37ipK0reYB5pIUFfxXpMUFzAssH6ghLlJTaMYEPhyEJSBxSOThELQrCiElUU3FFL6WkhgGOLWaSYbNQ5%2BVxtVxpFOyyapj6mYAbmPUEfmAIEOYNaOXmBZFkmjTAJgZTMEmzAnkmdbPqp6mYngVDJo0piMcJ/z5aQJQ1ixeBLiwjFIZN02nEa7IRFY2SqCAVhiFYpC0N9Eh/ag32eI8egMWYFgidpnB/QQgMfZ9Z4gCIvDcBIticLYYj8AI/D9JIyxfVYIh/aMXDpP9iOkCDVh/UYIASKQCNWEDn1wLAMCICgqCjFUaZkBQEC8QL7DECAwB46QcnApJjMQJ2NOdg4bZHt9cOkLx/EEAA8h%2B6ts39WCjOowDsDT%2BAAsg6JVozRukJgUwkW%2B1ia6UmCsBrf3sZ2M7EEengYG78PthTVhw59ND0EwbAcDwAjCOIUiyPIChqBoKDg4YvuM5An3VOidD21Cus6VCADqbCsNCFdOwQM7QlQVbEJ2qCMVxyIM1DlhcJ9Xs/X9AMO3TUwE1CgyuMAyDIK4/B8AcuCECQBJY5dQf84Lq%2BcLkYN6AY8OI0ypDEQukmUMjIBiNI3CCP0BMiJw0icNjIhyCTZOkBT/QSBjoj9LYXg0gBBpE4IIWw1MR7fQZkzFmR9SCcx5qLQW5BKDIPFpLaWssEjEAVkrB2KtaBq29lrPmOt9afktpgU2GgLYOytiRW2iQaZOxdgkEhHsB6a19v7QOwcSENzwOHSOMs6CMBYBbBOQhRCSBkGndOZss77z0KoPAnY84QALlUIuU5vql3LlXVgNdK710bjCNsyBAgtAQEiRaRju7mF7jvEmv1IFA1pt9Me/QJ4iCnjPOeC8IBLyIPsOwnB158zFpJVevBd7Z0PkbY%2BA9P4U1sIIW%2BEgxC2H6MA5%2BQh5jSDccDaBxhYGs3Zpfa%2Bt976DCfi/Wwb907fVsEPGmdMEkVJJrwVpUD6ZwMSZ9FutQ6CoyAA%3D)）：

```
 # gcc8.2 -O3 -fverbose-asm
    movabsq $8858102661120, %rax      #, m
    movl    $1000, %ecx     #, ivtmp_9     # induction variable tmp_9
.L2:
    mov     %rax, %rdx      # m, tmp91
    neg     %rdx            # tmp91
    and     %rax, %rdx      # m, result
       # asm statement here,  m=%rax   result=%rdx
    subl    $1, %ecx        #, ivtmp_9
    jne     .L2
    ret 
```

在循环内完全执行三个请求的汇编指令，加上循环开销的 sub 和 jne。

这里的诀窍是通过使用`asm volatile`¹并告诉编译器

1.  `"r"`输入操作数：它使用 的值`result`作为输入，因此编译器必须在寄存器中实现它。
2.  `"+r"`输入/输出操作数：`m`保留在同一个寄存器中，但（可能）被修改。
3.  `volatile`：它有一些神秘的副作用和/或不是输入的纯函数；编译器必须与源代码一样多次执行它。这迫使编译器将您的测试片段单独留在循环中。请参阅[gcc 手册的 Extended Asm#Volatile](https://gcc.gnu.org/onlinedocs/gcc/Extended-Asm.html#Volatile)部分。

脚注 1：`volatile`这里需要 ，否则编译器会将其变成一个空循环。非易失性 asm（具有任何输出操作数）被认为是其输入的纯函数，如果结果未使用，则可以优化掉。或 CSEd 如果多次使用相同的输入，则仅运行一次。

* * *

## **下面的一切都不是我的——我不一定同意。——卡罗伍德**

如果您使用过`asm volatile ("" : "=r" (m) : "r" (result));` (**带有`"=r"`只写输出**)，编译器可能会为`m`and选择相同的寄存器`result`，从而创建一个循环携带的依赖链来测试计算的延迟，而不是吞吐量。

从那里，你会得到这个asm：

```
5077:   ba e8 03 00 00          mov    $0x3e8,%edx
507c:   0f 1f 40 00             nopl   0x0(%rax)    # alignment padding
  # top of loop
5080:   48 89 e8                mov    %rbp,%rax    # copy m
5083:   48 f7 d8                neg    %rax         # -m
5086:   48 21 c5                and    %rax,%rbp    # m &= -m   instead of using the tmp as the destination.
5089:   83 ea 01                sub    $0x1,%edx
508c:   75 f2                   jne    5080 <main+0x120> 
```

这将每 2 或 3 个周期运行 1 次迭代（取决于您的 CPU 是否具有 mov-elimination）。没有循环携带依赖项的版本可以在 Haswell 及更高版本和 Ryzen 上以每个时钟周期运行 1 次。这些 CPU 的 ALU 吞吐量可以在每个时钟周期运行至少 4 微秒。

这个 asm 对应于 C++，如下所示：

```
for (int i = 0; i < loopsize; ++i)
{
  m = m & -m;
} 
```

通过用只写输出约束误导编译器，我们创建了看起来不像源代码的 asm（看起来它每次迭代都从一个常量计算一个新结果，而不是使用结果作为下一次迭代的输入迭代..)

您可能*想要*对延迟进行微基准测试，以便您可以更轻松地检测编译的好处`-mbmi`或`-march=haswell`让编译器在一条指令中使用[`blsi %rax, %rax`](https://www.felixcloutier.com/x86/blsi)和计算。`m &= -m;`但是，如果 C++ 源代码与 asm 具有相同的依赖项，则更容易跟踪您正在执行的操作，而不是欺骗编译器引入新的依赖项。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T16:29:22.420

您可以制作两个 C 文件，`SlowCalculation`用`g++ -O3`（高级优化）编译，一个基准测试用`g++ -O1`（较低级别，仍然优化 - 这可能足以用于该基准测试部分）。

根据*手册页*`-O2`，代码的重新排序发生在`-O3`优化级别。

由于优化发生在编译期间，而不是链接期间，因此基准测试端不应受到代码重新排序的影响。

假设您正在使用`g++`- 但在另一个编译器中应该有等效的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-25T17:22:11.577

在 C++ 中执行此操作的正确方法是使用*类*，例如

```
class Timer
{
    std::clock_t startTime;
    std::clock_t* targetTime;

public:
    Timer(std::clock_t* target) : targetTime(target) { startTime = std::clock(); }
    ~Timer() { *target = std::clock() - startTime; }
}; 
```

并像这样使用它：

```
std::clock_t slowTime;
{
    Timer timer(&slowTime);
    int answer = SlowCalculation(42);
} 
```

请注意，我实际上并不相信您的编译器会像这样重新排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-26T11:06:44.030

Volatile 确保了一件事，而且只有一件事：从 volatile 变量中读取的内容每次都会从内存中读取——编译器不会假定该值可以缓存在寄存器中。同样，写入将被写入内存。编译器不会将它保存在寄存器中“一段时间，然后再将其写入内存”。

为了防止编译器重新排序，您可以使用所谓的编译器围栏。MSVC 包括 3 个编译器栅栏：

_ReadWriteBarrier() - 全栅栏

_ReadBarrier() - 负载的两侧围栏

_WriteBarrier() - 商店的两侧围栏

ICC 包括 __memory_barrier() 完整围栏。

完整的栅栏通常是最好的选择，因为在这个级别上不需要更细的粒度（编译器栅栏在运行时基本上是无成本的）。

语句重新排序（大多数编译器在启用优化时都会这样做），这也是某些程序在使用编译器优化编译时无法操作操作的主要原因。

建议阅读[http://preshing.com/20120625/memory-ordering-at-compile-time](http://preshing.com/20120625/memory-ordering-at-compile-time)以了解我们在编译器重新排序等方面可能面临的潜在问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-28T02:09:14.123

我能想到几种方法。这个想法是创建编译时间障碍，以便编译器不会重新排序一组指令。

避免重新排序的一种可能方法是强制编译器无法解析的指令之间的依赖关系（例如，将指针传递给函数并在以后的指令中使用该指针）。我不确定这将如何影响您对基准测试感兴趣的实际代码的性能。

另一种可能性是使函数`SlowCalculation(42);`成为`extern`函数（在单独的 .c/.cpp 文件中定义此函数并将文件链接到主程序）并将 和 声明`start`为`stop`全局变量。我不知道编译器的链接时间/过程间优化器提供了哪些优化。

此外，如果您在 O1 或 O0 编译，编译器很可能不会打扰重新排序指令。[您的问题与（编译时间障碍 - 编译器代码重新排序 - gcc 和 pthreads](https://stackoverflow.com/q/13540810/811335)）有些相关

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-25T17:18:12.810

你的同事描述的重新排序只是打破了 1.9/13

> 之前排序是由单个线程 (1.10) 执行的评估之间的不对称、传递、成对关系，这会在这些评估之间产生偏序。给定任意两个评估 A 和 B，如果 A 在 B 之前排序，那么 A 的执行将在 B 的执行之前。如果 A 没有在 B 之前排序并且 B 没有在 A 之前排序，那么 A 和 B 是 unsequenced 。[注意：未排序评估的执行可以重叠。—尾注] 当 A 在 B 之前排序或 B 在 A 之前排序时，评估 A 和 B 的排序不确定，但未指定哪个。[注意：不确定顺序的评估不能重叠，但可以先执行。——尾注]

所以基本上你不应该在不使用线程时考虑重新排序。

# asp-classic - HTTP/1.1 500 服务器错误与 ASP 经典

> ID：15041525
> 
> 赞同：2
> 
> 时间：2013-02-23T14:22:10.000
> 
> 标签：asp-classic, iis-7.5

首先，我想声明这是我创建的第一个 ASP 经典页面，自从第一次在 IIS 上部署以来，它给了我服务器 500 错误。我已经搜索了整个网络，并做了几乎所有可能的事情来做到这一点，但都是徒劳的。

我使用 Web Matrix 创建了一个经典的 ASP 页面。这是一个基于 Web 的仪表板，它连接到 MSSQL 服务器并获取必要的信息。我在 php 中有一个类似的应用程序，它运行完美，但我想学习 ASP，因此试图在 ASP 上制作一个类似的网络应用程序。这个应用程序在 Web Matrix 上运行良好。当我从网络矩阵（在 chrome 和 IE 上）运行这个应用程序时，它连接到所需的数据库，我可以按预期浏览详细信息。当我在 IIS（我的 Windows 7 电脑上的本地主机）上托管它时，问题就开始了。这是我遵循的确切程序：

1.  在 IIS 上创建了一个名为“YCube”的新站点
2.  使用基本设置，我为应用程序提供了以下物理路径 (D:\YVXS\Personal\ASP\SSTool\Ycube) {项目输出文件夹}
3.  在绑定页面中，我分配了端口 81
4.  IIS 身份验证设置为“匿名身份验证”
5.  asp 的应用程序池设置为经典（正如 IIS 首先声明它无法在集成模式下执行任务）

在此之后，当我尝试浏览 localhost:81/menu.asp 时，它给了我服务器 500 错误。21 天研究现在开始（以下要点）

1.  为了得到网页上的描述性错误，我做了以下操作，但错误描述没有改变 IIS->asp->Compliation->将错误发送到浏览器 =true，IE 上的友好 http 错误 = 禁用

2.  IIS 日志文件，不确定 iam 是否无法理解错误但正在关注日志文件 (C:\inetpub\logs\LogFiles\W3SVC1

2013-02-23 08:07:44 ::1 GET /menu.asp |-|ASP_0147|500_Server_Error 80 - ::1

1.  在 IIS 论坛上，只有我在时间 global.asa 文件会导致这个问题，我删除了这个文件并尝试过，一切都是徒劳的

2.  我的站点的文件夹和文件权限是只读的，但是我也尝试了相同的读写权限，这也没有帮助

3.  在 IIS 的错误页面上，我已将“编辑功能设置”更改为“详细错误”，这也没有给我任何进一步的错误描述。

4.  24 次我卸载了 IIS 并重新安装，什么也没发生

5.  有人建议创建一个虚拟的 asp 文件并尝试托管相同的 IIS，所以我使用了一个小代码

`<HTML> <BODY> This page was last refreshed on <%= Now() %>. </BODY> </HTML>`，这给出了正确的输出（此页面最后一次刷新是在 18:88:22 ....），但是对于我原来的 asp 页面，我仍然收到服务器 500 错误

1.  我的一个朋友建议从 IIS 中删除所有其他托管网页并尝试（我在 IIS 上有一个 PHP），因此我删除了相同的并尝试了，根本没有任何更改

2.  事件日志文件没有显示任何与 ASP 相关的内容（只有少数文件表明我的 PC 意外关闭）

3.  我创建了第二个 ASP 文件，该文件在后台具有 MS 访问权限，这也给了我相同的服务器 500 错误

4.  我尝试过的其他事情是更改 web.config 文件以发送详细的错误，（我忘记了确切的行）但这也对我没有帮助

这是我的系统配置和其他详细信息 Windows 7 专业版、IIS7.5.7600、MSSQLR2express。另请注意，我已经尝试在我拥有的两台其他电脑（Windows 7）和 Office Server 2003 上托管它，但都给了我相同的服务器 500 错误。

从来没有想过学习一个经典的 asp 会让我进入所有这些爵士乐......请帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T11:34:11.063

在 IIS 中配置 ASP 站点时需要注意的几件事

1) 启用父路径 = true

2）如果您有 64 位机器需要将您的应用程序池设置为 32 位。

这是我们需要注意的默认设置。

# android - Android MediaPlayer 流缓冲

> ID：15041528
> 
> 赞同：1
> 
> 时间：2013-02-23T14:22:19.710
> 
> 标签：android, android-mediaplayer

我正在制作一个可以播放来自 URL 的音频流的 android 应用程序。

Activity 包含一个简单的播放/暂停按钮和一个 Seekbar。

我已经设法通过将媒体播放器作为服务运行来播放流，但现在我想实现缓冲。

从某种意义上说，当媒体播放器启动时，我希望将流保存在缓冲区或临时位置中。

我还想在搜索栏中显示这个缓冲量（可能作为次要进度）&当用户将搜索栏拖到任何缓冲点时，播放器应该播放该流而不会受到任何干扰。

所以，我正在为此寻找一个体面的教程。我尝试搜索但无法找到版本 >= 2.3 的更简单的解决方案。（但是，如果它也适用于 2.2，那也很棒）

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-23T12:02:14.677

我在这里的答案中使用了互联网广播流媒体：[Android 的在线广播流媒体应用程序](https://stackoverflow.com/questions/6283568/online-radio-streaming-app-for-android)

然后我使用了这个人的一些工作来实现可视化器：[https ://github.com/felixpalmer/android-visualizer](https://github.com/felixpalmer/android-visualizer)

不过我在三星 S3 上遇到了麻烦。您对流式网络广播有任何问题吗？它在三星音乐、Note、Note II、S II、S III mini、（甚至）S4 和 Google Nexus 手机上运行良好，但据说由于 S3 上的一些固件缓冲区设置，它只是不能在 S3 上流式传输音乐。

我在 2-5 分钟后得到了类似流式传输的结果，但谁愿意等待 5 分钟才能开始广播流 - 没有人！

我发现它有时取决于流的比特率。例如，96 kb/s 比特率流在 S3 上立即开始播放，而 128 kb/s 比特率流需要 2 分钟以上。这实际上是没有意义的，因为人们会认为较高的比特率流会比较低的比特率流更快地填充缓冲区。

你对我有什么意见或建议吗？我在[这里](https://stackoverflow.com/questions/16693601/why-does-it-take-longer-for-some-internet-audio-streams-to-start-playing-on-a-sa)和[这里](https://stackoverflow.com/questions/16672568/mediaplayer-error-1-1004-aka-media-error-io-trying-to-stream-music-on-samsun)有问题。

# ios - 在播放 iOS 中的下一首歌曲之前，我是否需要先停止 MusicPlayerController？

> ID：15041531
> 
> 赞同：1
> 
> 时间：2013-02-23T14:23:26.273
> 
> 标签：ios, cocoa-touch, mpmusicplayercontroller

在我的应用程序中，我必须播放 iPod 库中的歌曲`MPMusicPlayerContrller's` `iPodMusicPlayer`。

我只想知道，在我的应用程序中，第一首歌曲正在从专辑播放，当我想从播放列表中播放另一首歌曲时，`UITableView`我需要`[self.player stop];`在更改下一首歌曲之前使用停止功能吗？

或者我可以直接播放而不停止当前播放的歌曲？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:29:54.587

无需停止。我的问题是“为什么要停止？”。不，从来没有，没有必要停下来。ios 已经为您提供了通过属性从播放列表中播放新歌曲的功能。

如果你停止它并再次播放它，它只是浪费执行时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:26:49.150

因为您可能使用`skipToNextItem`或者`skipToPreviousItem`直接使用它们是完全合法的。

[MPMusicPlayerController](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/MPMusicPlayerController_ClassReference/Reference/Reference.html)的文档。

# python - “SELECT ... WHERE ... IN”，参数数量未知

> ID：15041534
> 
> 赞同：14
> 
> 时间：2013-02-23T14:23:36.727
> 
> 标签：python, sqlite

我正在尝试以...的形式执行查询

```
SELECT col2 FROM tab WHERE col1 IN (val1, val2, val3...) 
```

...其中值存储在任意长度的 Python 列表/元组中。我似乎找不到一种“干净”的方式来做到这一点。

```
>>> db = connect(":memory:")
>>> db.execute("CREATE TABLE tab (col1 INTEGER, col2 TEXT)")
>>> db.execute("INSERT INTO tab VALUES(1,'one')")
>>> db.execute("INSERT INTO tab VALUES(2,'two')")
>>> db.execute("INSERT INTO tab VALUES(3,'three')")
>>> db.execute("INSERT INTO tab VALUES(4,'four')")
>>> db.execute("INSERT INTO tab VALUES(5,'five')")
>>> db.commit()

# Expected result
>>> db.execute("SELECT col2 FROM tab WHERE col1 IN (1,3,4)").fetchall()
[(u'one',), (u'three',), (u'four',)]

>>> vals = (1,3,4)

>>> db.execute("SELECT col2 FROM tab WHERE col1 IN (?)", vals).fetchall()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
sqlite3.ProgrammingError: Incorrect number of bindings supplied. The current statement uses 1, and there are 3 supplied.

>>> db.execute("SELECT col2 FROM tab WHERE col1 IN (?)", (vals,)).fetchall()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
sqlite3.InterfaceError: Error binding parameter 0 - probably unsupported type.

>>> db.execute("SELECT col2 FROM tab WHERE col1 IN (?)", (','.join(str(val) for val in vals),)).fetchall()
[]

>>> 
```

现在我可以执行以下操作，（我认为......如果我错了请纠正我）保留了内置参数替换的安全性，但它仍然有点难看：

```
>>> db.execute("SELECT col2 FROM tab WHERE col1 IN (" + ",".join("?"*len(vals)) + ")", vals).fetchall()
[(u'one',), (u'three',), (u'four',)]
>>> 
```

这是我最好的选择，还是有更好的解决方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T14:25:51.313

这是您最好的选择*，无需使用额外的库*。我过去当然[不止一次地](https://stackoverflow.com/questions/14245396/using-a-where-in-statement/14245421#14245421)[提倡过这种技术](https://stackoverflow.com/questions/14142554/sqlite3-python-executemany-select/14142611#14142611)。

你也可以改用 SQLAlchemy，它会为你生成 SQL，但这需要你爬上它的学习曲线并重写你的大部分应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-22T11:55:25.470

一个简单而干净的解决方案是：

```
vals = [1,3,4]
cursor.execute('SELECT col2 FROM tab WHERE col1 IN {}'.format(str(tuple(vals)) 
```

# tfs - 如何仅与使用 Team Foundation Service 的客户共享产品待办列表？

> ID：15041538
> 
> 赞同：2
> 
> 时间：2013-02-23T14:24:08.723
> 
> 标签：tfs, azure-devops

我团队的项目托管在 Team Foundation Service (TFS) 上。如何将我的客户对项目的访问限制为**仅**产品待办事项项？

最小的权限集似乎是“查看项目级信息”，但这仍然允许用户访问代码本身，我不希望这样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T22:29:22.647

这在今天是不可能的。我们更经常听到这个请求，并在[用户语音](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2085675-hide-work-item-types-wits-based-on-permission-se)上进行跟踪。

随意投票支持该建议。它帮助我们优先考虑我们的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T00:25:11.787

要拒绝对代码的所有访问，您需要：

*   VS2012 中的开源控制资源管理器
*   右键单击您的团队项目名称 ($/MyTeamProject)。
*   选择“高级”
*   选择“安全...”
*   在左侧选择他们的 TFS 组（即积压阅读器）
*   单击右侧的“继承允许”（或“允许”）权限，直到它变为“拒绝”。

然后保存更改。

# asp.net-mvc-3 - Html.RenderPartial 和 Ajax.BeginForm -> 提交被调用两次

> ID：15041540
> 
> 赞同：18
> 
> 时间：2013-02-23T14:24:26.390
> 
> 标签：asp.net-mvc-3, razor, asp.net-ajax, partial-views, double-submit-problem

我有以下索引视图：

```
@model BoringStore.ViewModels.ProductIndexViewModel
@{
    ViewBag.Title = "Index";
}

<h2>Produkte</h2>

<div id='addProduct'>
    @{ Html.RenderPartial("Create", new BoringStore.Models.Product()); }
</div>

<div id='productList'>
    @{ Html.RenderPartial("ProductListControl", Model.Products); }
</div> 
```

“productList”只是所有产品的列表。

addProduct 呈现我的创建视图：

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
<div id="dialog-confirm" title="Produkt hinzufügen" style="display:none">
@using (Ajax.BeginForm("Index_AddItem", new AjaxOptions { UpdateTargetId = "productList" }))
{ 
    @Html.Raw(DateTime.Now.ToString());

    <div>
        @Html.LabelFor(model => model.Name)
        @Html.EditorFor(model => model.Name)
    </div>
    <br />
    <div>
        @Html.LabelFor(model => model.Price)
        @Html.EditorFor(model => model.Price)
    </div>
    <br /><br />
    <div>
        <input type="submit" value="Produkt hinzufügen" />
    </div>
} 
```

提交表单时，我的控制器中的 Index_AddItem 方法被调用。不幸的是，表单总是调用该方法两次。:(

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-23T14:34:29.910

不要在局部视图中包含脚本！他们应该去你的“主要”观点或你的`_layout.cshtml`.

您的问题是您`jquery.unobtrusive-ajax.min.js`在页面中包含了两次。一次在你的`Create`局部，一次在其他地方。因为如果您多次包含该脚本，它将多次订阅提交事件，因此您只需单击一次即可获得多次提交。

因此，请确保您在页面中只包含该脚本一次。所以将`jquery.unobtrusive-ajax.min.js`参考移动到您的索引视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-20T11:16:26.760

确保您没有`jquery.unobtrusive-ajax.min.js`在上述布局中重复文件，并且您可以使用浏览器检查器进行检查

我遇到的另一个可能导致此错误的问题是在 ajax 请求中使用 jquery 来休息表单，如下所示

```
$("form").trigger("reset"); //just remove this line 
```

# c# - NHibernate Icriterion .NET 委托不匹配

> ID：15041543
> 
> 赞同：2
> 
> 时间：2013-02-23T14:24:51.300
> 
> 标签：c#, .net, nhibernate

我在带有 DI 的存储库模式中使用 NHibernate 以保持灵活性。我不希望相关的接口暴露任何特定于供应商的东西，比如 ICriterion。但是，我希望我的查询类接受我可以放入 .Where 子句的委托。

我需要类似的东西：

```
public IEnumerable<MyClass> Execute(Func<MyClass, bool> selector)
{
    return session
        .QueryOver<MyClass>()
        .Where(selector)
        .....
} 
```

有没有办法实现这一点，还是我以错误的方式去做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:07:02.557

你不会走错路。我认为您的代码有效；您的问题是您在内存中检索完成过滤的所有表。

我想这应该可以在数据库级别过滤可以转换为 SQL 的标准：

```
public IEnumerable<MyClass> Execute(Expression<Func<MyClass, bool>> selector)
{
    return session.Query<MyClass>().Where(selector).ToList();
} 
```

我敢打赌这也应该有效：

```
public IEnumerable<MyClass> Execute(Expression<Func<MyClass, bool>> selector)
{
    return session.QueryOver<MyClass>().Where(selector).ToList();
} 
```

希望这会有所帮助

# php - Expedia API 响应转换为 html PHP

> ID：15041544
> 
> 赞同：0
> 
> 时间：2013-02-23T14:24:59.723
> 
> 标签：php, api, xml-parsing

我在 API 调用和学习阶段还很陌生。我正在使用 php 使用 Expedia 开发 API。我成功获得了响应转储，并且可以在页面上显示转储。但是，有人可以告诉我我需要做什么来转换/解析该 API 响应并快速转换为网页。我真的很难理解如何使用该输出转换为 html 以显示为正常的假期预订或酒店网站。为了更好地理解，我粘贴了我从 Expedia 收到的回复。请指教

```
 [HotelSummary] => SimpleXMLElement Object
            (
                [@attributes] => Array
                    (
                        [order] => 0
                    )

                [hotelId] => 425669
                [name] => Hôtel Luxor
                [address1] => 24, Rue Ernest Renan
                [city] => Issy-les-Moulineaux
                [postalCode] => 92130
                [countryCode] => FR
                [airportCode] => SimpleXMLElement Object
                    (
                        [0] =>    
                    )

                [supplierType] => E
                [propertyCategory] => 1
                [hotelRating] => 1.0
                [confidenceRating] => 52
                [amenityMask] => 0
                [tripAdvisorRating] => 1.5
                [locationDescription] => Near Paris Expo Porte de Versailles
                [shortDescription] => <p><b>Location. </b> <br />Hôtel Luxor is located in Issy-les-Moulineaux's Gare Montparnasse - Porte de Versailles neighborhood, close to Paris Expo Porte de Versailles, Eiffel Tower, and Stade de
                [highRate] => 43.76
                [lowRate] => 43.76
                [rateCurrencyCode] => EUR
                [latitude] => 48.82882
                [longitude] => 2.28239
                [proximityDistance] => 1.7304468
                [proximityUnit] => MI
                [hotelInDestination] => true
                [thumbNailUrl] => /hotels/6000000/5670000/5669900/5669864/5669864_4_t.jpg
                [deepLink] => http://travel.ian.com/index.jsp?pageName=hotAvail&cid=55505&hotelID=425669&mode=2&numberOfRooms=1&room-0-adult-total=1&room-0-child-total=0&arrivalMonth=8&arrivalDay=17&departureMonth=8&departureDay=18&showInfo=true&locale=en_US&currencyCode=EUR
                [RoomRateDetailsList] => SimpleXMLElement Object
                    (
                        [RoomRateDetails] => SimpleXMLElement Object
                            (
                                [roomTypeCode] => 200245723
                                [rateCode] => 201427808
                                [maxRoomOccupancy] => 2
                                [quotedRoomOccupancy] => 1
                                [minGuestAge] => 0
                                [roomDescription] => Moderate - shared bathroom
                                [currentAllotment] => 10
                                [propertyAvailable] => true
                                [propertyRestricted] => false
                                [expediaPropertyId] => 5669864
                                [rateKey] => 3f0bfd6a-d45b-496d-a986-eb8aade2b3e8
                                [RateInfo] => SimpleXMLElement Object
                                    (
                                        [@attributes] => Array
                                            (
                                                [rateChange] => false
                                                [promo] => false
                                                [priceBreakdown] => true
                                            )

                                        [ChargeableRateInfo] => SimpleXMLElement Object
                                            (
                                                [@attributes] => Array
                                                    (
                                                        [total] => 47.0
                                                        [surchargeTotal] => 3.24
                                                        [nightlyRateTotal] => 43.76
                                                        [maxNightlyRate] => 43.76
                                                        [currencyCode] => EUR
                                                        [commissionableUsdTotal] => 57.72
                                                        [averageRate] => 43.76
                                                        [averageBaseRate] => 43.76
                                                    )

                                                [NightlyRatesPerRoom] => SimpleXMLElement Object
                                                    (
                                                        [@attributes] => Array
                                                            (
                                                                [size] => 1
                                                            )

                                                        [NightlyRate] => SimpleXMLElement Object
                                                            (
                                                                [@attributes] => Array
                                                                    (
                                                                        [promo] => false
                                                                        [rate] => 43.76
                                                                        [baseRate] => 43.76
                                                                    )

                                                            )

                                                    )

                                                [Surcharges] => SimpleXMLElement Object
                                                    (
                                                        [@attributes] => Array
                                                            (
                                                                [size] => 1
                                                            )

                                                        [Surcharge] => SimpleXMLElement Object
                                                            (
                                                                [@attributes] => Array
                                                                    (
                                                                        [amount] => 3.24
                                                                        [type] => TaxAndServiceFee
                                                                    )

                                                            )

                                                    )

                                            )

                                    )

                                [ValueAdds] => SimpleXMLElement Object
                                    (
                                        [@attributes] => Array
                                            (
                                                [size] => 1
                                            )

                                        [ValueAdd] => SimpleXMLElement Object
                                            (
                                                [@attributes] => Array
                                                    (
                                                        [id] => 2048
                                                    )

                                                [description] => Free Wireless Internet
                                            )

                                    )

                            )

                    )

            )

    )

  ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-01T07:07:53.147

你在一个变量中得到了响应，然后像这样使用每个变量

例如，您的变量是`$obj`指然后将其作为

> foreach ($obj['HotelListResponse']['HotelList']['HotelSummary'] as $HOTEL) { "你的 html 代码在这里例如：如果我需要酒店的名称 } 像这样

并在最后关闭 for each

> ```
> <?php }?> 
> ```

希望这可以帮助

# c - C中的整数数组

> ID：15041545
> 
> 赞同：-1
> 
> 时间：2013-02-23T14:25:04.460
> 
> 标签：c

我有以下代码： -

```
while(string[i] != '\0') {
    switch(string[i]) {
        case '0' :
            numbers[counter] = 0;
            break;
        case '1' :              
            numbers[counter] = 1;
            break;
            case '2' :
            numbers[counter] = 2;
            break;
        case '3' :
            numbers[counter] = 3;
            break;
    } // end switch.
    i++;
    counter--;
} // end while. 
```

出于某种原因，无论何时任何 numbers[counter] = lines 运行，计数器似乎都会被我想要将数组设置为的数字覆盖。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:26:53.477

如果我从您在没有上下文的情况下发布的代码部分中*猜*对了，您可能想要`i++`and `counter++`. 递减`i`，移动*到字符串的开头*特别不可能是正确的，因为您希望`\0`在某个时候找到 a 。

# java - 使用 nonce 进行无状态 cookie 身份验证的最佳实践

> ID：15041552
> 
> 赞同：0
> 
> 时间：2013-02-23T14:25:46.110
> 
> 标签：java, php, jakarta-ee, nonce

我一直在阅读有关使用 cookie 进行身份验证的信息。这似乎具有挑战性，因为 cookie 可能会从浏览器缓存中被窃取或在 HTTP 消息中被截获。

我想到了为此使用 nonce 的想法。我喜欢它，因为有人偷了它，一旦真正的用户再次尝试访问 WebApp，他就会失去访问权限。为了继续窃取它，他必须离用户有点近。

但我无法找到合适的算法。Wordpress nonce 实现使用 user_id，它的身份验证 cookie 生成器有点复杂（我会继续阅读它，但我想要更简单的实现）。

这些是我被迫使用的约束：

*   它不应该要求在 DB 或 HD 上编写它，因为它不值得那么复杂
*   它不能使用 Session，它必须是无状态的，这意味着服务器不能保存任何类型的数据，所有数据（登录和随机数）必须通过 cookie 发送给客户端，并且他必须将 cookie 数据发送回
*   可以在 cookie 中添加登录名，例如“login|nonce”，因此当我收到 cookie 时，我可以将其子串为 login 和 nonce 并验证它
*   它必须在 PHP 和 Java Servlet 中实现！如果它使用其中任何一个的核心功能，我必须在另一个上实现该功能或找到替代品，但它们不需要可互换
*   它是一个随机数，因此对于每个 HTTP 响应，我都会生成一个新的随机数，它只会有效一次，然后如果再次尝试使用就会变得无效
*   如果 nonce 只能用于下一个请求，那就太好了，但我认为这需要将这个 nonce 存储在某个地方并检索它以进行比较，我仍然认为打破无状态是不值得的，所以我认为有时间限制可能就足够了（时间限制意味着使用`time() / ( $nonce_life / 2 )`作为随机数的参数之一，所以它只能在那个时间使用

这个想法是有一个无状态的、仅 cookie 的方式来知道谁登录了。$nonce_life 可以是 1 天，因此用户在第一天访问期间登录并保持登录状态直到一天结束。

正如我在 Wordpress 中看到的那样，实际上并没有办法知道 nonce 只使用一次，它所做的所有验证都是它是否在其生命周期内被使用。因此，如果 $nonce_life 是 1 天，则可以在该天无限使用 Wordpress 随机数。我认为这是有风险的，也许最好将 nonce 存储在 HD 文件上，打破无状态，但确保 nonce 只使用一次。我可以使用一个简单的 rand() 来创建它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T20:49:03.013

我终于明白了 Wordpress `_auth_cookie()`，我错过了旧的 PHP`extract()`和`explode()`. 它的 cookie 值保持不变`$cookie = $user->user_login . '|' . $expiration . '|' . $hash;`，$hash 包含很多信息，如登录名、密码和过期时间。

正如我想用“login|nonce”做的，但它增加了过期时间。

# jsf - Primefaces 向导语言环境

> ID：15041556
> 
> 赞同：4
> 
> 时间：2013-02-23T14:26:03.760
> 
> 标签：jsf, primefaces

按照此：

[http://code.google.com/p/primefaces/wiki/PrimeFacesLocales](http://code.google.com/p/primefaces/wiki/PrimeFacesLocales)

我可以更改日历组件的语言环境。

但是向导组件的语言环境不会改变下一个按钮的文本。

也许应该在 js 数组中添加一个新的键值，但我不知道它是哪个键。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-23T14:40:58.293

简单，使用：

```
nextLabel="Siguiente" 
```

和

```
backLabel="Atrás"  (Atr&aacute;s) 
```

# iphone - 使用 NSPredicate 如何从核心数据中过滤值

> ID：15041568
> 
> 赞同：0
> 
> 时间：2013-02-23T14:26:54.190
> 
> 标签：iphone, ios, xcode, ipad

我有一个实体和三个属性，分别称为名称、版本、公司。我想从公司属性中过滤值，例如“快餐”。

```
 NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Device" inManagedObjectContext:managedObjectContext];
    [request setEntity:entity];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"('company' contains[c] 'Fast Foood')"];
    [request setPredicate:predicate];
    NSLog(@"Pre %@",predicate);

    NSError *error = nil;
    NSMutableArray *mutableFetchResults = [[managedObjectContext executeFetchRequest:request error:&error] mutableCopy];
    if (mutableFetchResults == nil) {
        // Handle the error.
    }

    // Set self's events array to the mutable array, then clean up.
    [self setDataarr:mutableFetchResults]; 
```

但我不能这样做请帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:32:29.113

您无需将属性名称括在引号中：

```
[NSPredicate predicateWithFormat:@"company CONTAINS[c] 'Fast Foood'"]; 
```

或更好

```
[NSPredicate predicateWithFormat:@"company CONTAINS[c] %@", @"Fast Foood"]; 
```

顺便说一句：您的谓词搜索“快餐”，而不是“快餐”。

* * *

*（回应您的评论）*您应该使用一对多关系定义实体*类别* 和*菜肴：*

![在此处输入图像描述](../Images/009a63936867239fef40e61e12c8490a.png)

现在，您可以使用以下获取请求找到给定类别的所有菜肴：

```
NSString *catName = @"Desert";
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"Dish"];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"category.name = %@", catName];
[request setPredicate:predicate]; 
```

# c++ - 错误：未在此范围内声明“CLSS”？

> ID：15041571
> 
> 赞同：-1
> 
> 时间：2013-02-23T14:27:11.803
> 
> 标签：c++

为什么我的函数 'CSS()' 在这段代码中不起作用，错误是：

```
C:\Users\KEstudio\Desktop\Programming\Learning C++ resources\projects\homework     saver\main.cpp||In function 'int main()':|
C:\Users\KEstudio\Desktop\Programming\Learning C++ resources\projects\homework    saver\main.cpp|20|error: 'CLSS' was not declared in this scope|
||=== Build finished: 1 errors, 0 warnings (0 minutes, 0 seconds) ===| 
```

这是我的代码：

```
#include <iostream>
#include <cstdlib>
#include <fstream>
#include <string>
#include <sstream>
using namespace std;

void ClSS()
{
    system("CLS");
}
const char* CTS(string);

int main()
{
    A:
    string HWS, HW;//We will be saving our input in this
    cout << "Please enter the homework subject:" << endl;
    getline(cin, HWS);
    CLSS();

    cout << "Please enter the homework:" << endl;
    getline(cin, HW);
    CLSS();

    ofstream myfile;
    myfile.open(CTS(HWS+".txt"));
    myfile << HW;
    myfile.close();

    cout << "You have saved the information to a file! :D" << endl;

    string SEL;
    bool ASEL=false;
    cout << "Do you wan't to add another entry? yes or no" << endl;
    getline(cin, SEL);
    system("CLS");
    if(SEL=="yes" || SEL=="Yes" || SEL=="YES" || SEL=="Y" || SEL=="y")
        ASEL=true;
    else
        ASEL=false;
    if(ASEL==true)
        goto A;
    return 0;
}

const char* CTS(string strng)
{
    const char* FON;
    FON=strng.c_str();
    return FON;
} 
```

我可以看到我的函数已声明，我知道 C++ 不会有这样的错误，所以我做错了，这不可能是 C++ 的错误，所以请告诉我我是什么我做错了（希望它不是完全愚蠢，所以我看起来不太愚蠢，尽管使用这样的代码，它可能是一个简单的解决方案）抱歉在这里漫无目的，堆栈溢出让我输入更多细节。

好的，我可以看到 CLSS 是在 main 函数之上声明的，并且函数不需要在 main 函数中声明，它们就可以在其中工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:28:34.087

你已经宣布`ClSS()`，但你在呼唤`CLSS()`。后者没有在任何地方声明。

# python - Python read() 自动将十六进制转换为字符？

> ID：15041573
> 
> 赞同：0
> 
> 时间：2013-02-23T14:27:18.967
> 
> 标签：python, hex, byte, bmp

我正在尝试将 4x4、5.6.5.0.0、.bmp 文件转换为 rgb 值列表以插入另一个需要特定格式的程序，但我被卡住了，因为我认为 read() 方法在Python 在我可以使用它之前转换了一些数据，即使我在“rb”模式下打开它也是如此。

例如，当我使用：

```
f = open("imgFile.bmp", "rb")
imgData=f.read()
f.close()

print imgData 
```

我得到：

> BMh\x00\x00\x00\x00\x00\x00\x006\x00\x00\x00(\x00\x00\x00\x04\x00\x00\x00\xfc\xff\xff\xff\x01\x00\x18 \x00\x00\x00\x00\x002\x00\x00\x00\x12\x0b\x00\x00\x12\x0b\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xcc \xbb\xaa\xff\xee\xdd\x00\x00\x00\xff\xff\xff\xdd\xcc\xbb\x00\x00\x00\xff\xff\xff\x00\x00\x00\x00\x00 \x00\xff\xff\xff\x00\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\xff\xff\xff3"\x11\x00\x00

这在大多数情况下都很好（我可以在 bmp 标头之后获取我需要的十六进制值 - 这些值从“\xcc\xbb\xaa ......”开始，但看起来一些十六进制值被解释为其他字符并且符号，这至少会使翻译变得更加困难，但最坏的情况是会导致歧义，从而无法确定地恢复原始数据。

例如，您会在字符串末尾附近找到此序列：

> \xff3"\x11

这应该显示为：

> \xff\x33\x22\x11

（[此表](http://www.techdictionary.com/ascii.html)显示，'33' 可以解释为 '3'，'22' 可以解释为 '"'，我确信它应该是这样的 - 请参阅下面的文本编辑器中的数据显示方式）。

现在，如果没有歧义，将所有符号转换回十六进制格式会很容易，但在更复杂的文件中有很多可能性。例如，如果我有序列“6666”，它只会被更改为“ff”，我将无法从我的数据中可能已经存在的“ff”实例中分辨出来。

我的问题是：如何保持数据未翻译和明确，以便在 Python 中进一步解析和格式化？

为了确认我所描述的正在发生，我在 SublimeText 中打开了该文件，它显示为：

> 424D 6800 0000 0000 0000 3600 0000 2800 0000 0400 0000 FCFF FFFF 0100 1800 0000 0000 3200 0000 120B 0000 120B 0000 0000 0000 0000 0000 CCBB aaff EEDD 0000 00FF FFFF DDCC bb00 0000 FFFF FF00 0000 0000 00FF FFFF 0000 00FF FFFF FFFF FF00 0000 FFFF FF33 2211 0000

，这是正确且可用的（虽然对我的目的来说效率不高，每次都必须在文本编辑器中打开），所以我想用 Python 自动化这个过程。

顺便说一句，我认为这可能也是[这个人](https://stackoverflow.com/questions/4218760/convert-binary-files-into-ascii-in-python)正在发生的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:28:21.440

Python 向您显示一个文字字符串值，并使用转义码来防止您的终端失控。任何不是可打印 ASCII 字符的内容都显示为转义码。

值本身*仍然是完全二进制*的。

```
>>> '\x00'
'\x00'
>>> len('\x00')
1
>>> '\x65'
'e' 
```

在上面的例子中，空字节显示为`\x00`转义码，但它仍然只有一个字节（长度为 1）。十六进制值为 65 的字节显示为 an，`e`因为它是可打印的 ASCII 字符。

# php - 从 Google Analytics 获取数据的最简单方法是什么？

> ID：15041576
> 
> 赞同：2
> 
> 时间：2013-02-23T14:27:36.773
> 
> 标签：php, google-analytics

我正在构建一个像 Wix.com 这样的服务，用户可以轻松构建简单的多页网站。每个网站都将包含在具有唯一配置文件的全球 Google Analytics 帐户中，然后将跟踪代码放置在网站页面中。

现在，在网站仪表板上，我想分别显示每个网站的在线访问者和网站的访问者总数，尝试这样做我有：

尝试使用 GAPI ( [http://code.google.com/p/gapi-google-analytics-php-interface/](http://code.google.com/p/gapi-google-analytics-php-interface/) ) 但由于 Google Analytics 的重大更新，它不再起作用。

我找到了 Google Core Reporting API for Analytics，但我相信它是为为其客户访问 GA 数据的第三方应用程序而设计的，这意味着用户应该拥有网站的 Google 帐户和 GA 配置文件，并且该应用程序只是连接到该帐户并检索数据。当然，这里不是这种情况；我无法要求用户创建 Google 帐户并将跟踪代码嵌入网站 HTML；否则我来这里是为了什么？

有图片吗？我需要最简单的方法来做到这一点，没有花哨的东西。

PS：几分钟前我发现了这个：Google Analytics Query Explorer ( [http://ga-dev-tools.appspot.com/explorer/](http://ga-dev-tools.appspot.com/explorer/) )，它是一个为 GA 构建自定义查询并为您提供链接的第 3 方应用程序，例如那 ：

[https://www.googleapis.com/analytics/v3/data/ga?ids=](https://www.googleapis.com/analytics/v3/data/ga?ids=) (ID) &dimensions=ga%3AvisitCount&metrics=ga%3Avisitors&segment=gaid%3A%3A-1&start-date=2013-02-01&end-日期=2013-02-23&最大结果=50

现在，尝试访问 URL（思考；这很容易 :)）响应是先登录请求：

{"error":{"errors":[{"domain":"global","re​​ason":"required","message":"需要登录","locationType":"header","location":"授权"}],"code":401,"message":"需要登录"}}

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-26T17:27:02.293

除非您的客户少于 50 个，否则此计划不会按您要求的方式运作。（每个帐户限制为 50 个配置文件。）

1.  客户必须制作自己的 GA 编号并将其提供给您作为他们网站的设置。

2.  为了在您网站的仪表板上显示客户报告，您还必须让他们授权您为访问而创建的 GA 应用程序。

# configuration - 如何使用 BND 为配置创建默认布尔值

> ID：15041578
> 
> 赞同：0
> 
> 时间：2013-02-23T14:27:48.103
> 
> 标签：configuration, boolean, osgi, bnd

我正在使用 BND 注释来帮助创建由 OSGI cm 管理的配置。

这是我的简单配置

```
@Meta.AD(required = false, type = Type.Boolean, deflt = "false")
boolean enabled(); 
```

我已经多次使用 BND 配置注释库，但这是我第一次想使用布尔类型。

我已经阅读了[这个](http://www.aqute.biz/Bnd/MetaType)

为了方便起见，它讨论了基于整数或其他替代数字的布尔值处理。问题是 deflt 方法总是返回一个字符串值，如果我的类型是一个整数，我会做“2”（这些被解析）。但是直到这个分配点，布尔值似乎没有在可配置的 BND 代码中被解析。

```
if (resultType == boolean.class || resultType == Boolean.class) {
            if ( actualType == boolean.class || actualType ==   Boolean.class)
                return o;

            if (Number.class.isAssignableFrom(actualType)) {
                double b = ((Number) o).doubleValue();
                if (b == 0)
                    return false;
                else
                    return true;
            }
            return true; 
```

我想进一步知道为什么当 deflt 值甚至从未被解析时返回 true。我希望这会更严格地遵循规范并返回 false，因为 cm 会尝试执行 Boolean.parseFrom，所以任何不“真”等于忽略大小写的东西都是假的。

所有这一切都不是完全失败，因为如果我通过 cm 更改值，它会在设置为 true 后正常工作，然后再次设置为 false，但显然这只是想知道它是否会起作用。

只是我想知道是否有人知道如何使用 BND 的配置注释设置 BOOLEAN 默认值。

谢谢

# linux - 如何在 Linux 中编写一个在我打开计算机时自动运行的程序？

> ID：15041579
> 
> 赞同：0
> 
> 时间：2013-02-23T14:27:48.530
> 
> 标签：linux

我每次都在创建一个进程，但是在“kill -9 -1”之后，我丢失了我创建的进程。我知道为什么我每次都丢失它。但是无论如何，我可以让我的程序自动运行，每次我打开我的电脑？

谢谢，，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:34:59.697

大多数发行版仍然支持[SysV Init Scripts](http://www.cyberciti.biz/tips/linux-write-sys-v-init-script-to-start-stop-service.html)。

最简单的方法是从一个简单的 init 脚本中获取`/etc/init.d/`并更改它以满足您的需要：

```
sudo cp /etc/init.d/foo /etc/init.d/my_foo
sudo gedit /etc/init.d/my_foo 
```

然后，您需要启用它：

```
sudo /sbin/chkconfig my_foo on 
```

如果`chkconfig`不可用，您可能需要安装它。此外，还有`insserv`可能可用的 LSB 别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T00:17:32.677

Ubuntu 系统现在带有[Upstart](http://upstart.ubuntu.com/)，其配置文件可能比 System V`init`脚本更简洁。Upstart 的简单作业配置如下所示，然后进入，例如`/etc/init/example.conf`：

```
# this is a comment
start on startup
stop on shutdown
exec /path/to/program --some-args maybe-another-arg 
```

然后它将分别在启动和关闭时启动和停止。要手动启动和停止它，请使用`start`and`stop`命令`root`：

```
$ sudo start example
$ sudo stop example 
```

[您可以在其 Cookbook](http://upstart.ubuntu.com/cookbook/#configuration)中找到有关 Upstart 配置的更多信息。`init`有关安装了 Upstart 的系统的第 5 节的手册页中也提供了信息。( `man 5 init`)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T03:54:07.387

Fedora 带有[systemd](http://www.freedesktop.org/wiki/Software/systemd)，许多其他 Linux 发行版都在采用它（Ubuntu 和现在的 Debian 除外）。该软件包包括您可能想要查看的几个帮助程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T00:29:42.140

[Supervisor](http://www.supervisord.org/)将允许您这样做，以及具有一些其他功能，例如 FastCGI 支持、如果服务崩溃则自动重生服务（同时对它很聪明，如果它一遍又一遍地崩溃就不会重新启动它），并保留其输出日志.

在它被[安装](http://www.supervisord.org/installing.html)并[配置为在启动时运行之后](http://www.supervisord.org/running.html#running-supervisord-automatically-on-startup)，您可以修改它的配置文件以添加一个运行程序的部分。一个简单的例子可能是这样的：

```
; this is a comment
[program:example]
command = /path/to/program --some-args maybe-another-arg 
```

这确实是一个简单程序所必需的，但还有许多其他配置选项可用；[请参阅文档](http://www.supervisord.org/configuration.html#program-x-section-settings)。

添加配置后，您可以告诉 Supervisor 添加/删除（并启动/停止）您在配置中添加或删除的任何进程：

```
$ sudo supervisorctl update 
```

如果需要，您也可以手动启动和停止服务：

```
$ sudo supervisorctl start example
$ sudo supervisorctl stop example
$ sudo supervisorctl restart example 
```

您还可以看到所有进程的漂亮状态显示，例如：

```
$ sudo supervisorctl status
cgi-pass                         RUNNING    pid 4223, uptime 68 days, 23:57:22 
```

并查看程序输出记录的内容：

```
$ sudo supervisorctl tail example         # stdout
$ sudo supervisorctl tail example stderr  # stderr
$ sudo supervisorctl tail -f example      # continuous 
```

可用命令的文档可通过`supervisorctl help`.

# jquery - $(input).change 与 Internet Explorer 的问题

> ID：15041580
> 
> 赞同：1
> 
> 时间：2013-02-23T14:28:00.210
> 
> 标签：jquery, internet-explorer, onchange

我有一小段 javascript，用于对文件输入字段进行一些验证。它在 Chrome、Safari、Opera、Firefox 中运行良好，但在 Internet Explorer 9 及更低版本中无法运行......我使用的是 Jquery 1.8.3，显然从 1.4.2 开始，.change 属性应该适用于 IE . 我也试过 $(".fileInput").live('change'...

看不懂，欢迎指教！

```
jQuery(document).ready(function($){

    // Detect sh*tty IE
    if ($.browser.msie && $.browser.version <= 9) {

    // Bind to property change
    $(".fileInput").bind('propertychange', function() {

        fileChange(this);
    });

    } else {

    $(".fileInput").change(function() {

        fileChange(this);
    });
    }

  function fileChange($item) {

    // Get the filename
    var $fileName = $($item).val();
    var $inputId = $($item).attr('id');
    var $fakeName = $($item).val().split('\\').pop();
    var $fileSize = (($item.files[0].size)/1024)/1024;
    var $ext = $($item).val().split('.').pop().toLowerCase();
    var $acceptFiles = ['jpg', 'jpeg'];

    if ($.inArray($ext, $acceptFiles) == -1) {

        alert('For security, we can only accept jpeg images');

        // Reset the value of $item item
        $($item).val('');

        return;
    }

    // Make sure the file size isn't bigger than 1mb
    if ($fileSize >= 1.8) {

        alert("The image you've chosen is too big. \n\nWe accept images up to 2mb in size");

        // Reset the value of $item item
        $($item).val('');

        return;
    }

    // Check that the file
    if ($fileName != '') {

        $fileNotification = $('<li>', { id: 'file_'+$inputId, class: 'fileNotification', text: $fakeName});

        // Append it to the list
        $('#filesList').append($fileNotification);
    }

    // Hide the file input
    $($item).css({display : 'none'});

    // Show the next field
    $($item).next().show();     

  };
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:32:52.250

这与 IE 的事件或 jQuery 处理程序无关`change`，而是旧的 IE 缺乏 HTML5 API。

IE9 及以下不[支持](http://caniuse.com/fileapi)[File API](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications)。因此：

```
var $fileSize = (($item.files[0].size)/1024)/1024; 
```

输入元素的`files`属性在旧 IE 中，`undefined`您将收到一个错误，因为您无法访问`0`. `undefined`也就是说，您将无法使用 File API 在旧 IE 客户端轻松测试文件大小。

而且由于旧的 IE 也不支持 XHR2，你甚至不能通过 Ajax 发送文件来检查服务器端的大小。如果您想让该测试在旧 IE 中运行，您将需要一些非常难看的解决方法 - 例如，自动将表单提交到隐藏`iframe`文件以在服务器端进行文件大小检查，或使用闪存。

我相信无论如何你都有服务器端验证，因为 JS 可以很容易地绕过，所以将客户端检查变成渐进增强将是一种更简单的方法：

```
if ($item.files) { //browser supports the HTML5 File API, do the client-side check
    var $fileSize = (($item.files[0].size)/1024)/1024;
    if ($fileSize >= 1.8) {
        alert("The image you've chosen is too big. \n\nWe accept images up to 2mb in size");
        $($item).val('');
        return;
    }
} 
```

这意味着旧的 IE 用户仍然可以选择大文件，但只要您在服务器端验证表单数据（这对于任何现实世界的 Web 应用程序都是必需的），那么您只需要显示一个有意义的错误消息即可。

* * *

附言。你不需要`.split('\\').pop()`输入值——即使文件输入显示了用户的完整路径，浏览器永远不会让 JS 知道磁盘中文件的完整路径，只知道它的文件名（除非你篡改安全设置，见[相关](https://stackoverflow.com/q/3489133/1331430)）。

ps2。您不需要用更少的绑定处理程序进行`userAgent`嗅探，该事件对于 IE 的文件输入将与其他浏览器一样触发。`$.browser``propertychange``change`

# haskell - 为什么 ghci 给我一个类型为“1 ++ 2”而不是 ragequitting？

> ID：15041581
> 
> 赞同：26
> 
> 时间：2013-02-23T14:28:04.143
> 
> 标签：haskell

GHCI 会给我一个类型`1 ++ 2`：

```
$ ghci
GHCi, version 7.4.2: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
Prelude> :t 1 ++ 2
1 ++ 2 :: Num [a] => [a] 
```

但这显然是错误的。如果我尝试评估它，而不是仅仅输入检查它，事情就会正确地失败：

```
Prelude> 1 ++ 2

<interactive>:3:1:
    No instance for (Num [a0])
      arising from the literal `1'
    Possible fix: add an instance declaration for (Num [a0])
    In the first argument of `(++)', namely `1'
    In the expression: 1 ++ 2
    In an equation for `it': it = 1 ++ 2 
```

是什么赋予了？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-23T14:32:52.843

> 但这显然是错误的。

不，完全正确。

的类型`(++)`是

```
(++) :: [a] -> [a] -> [a] 
```

整数文字的类型是

```
1 :: Num n => n 
```

因此`[a]`，参数`(++)`必须具有的类型`Num n => n`与文字具有的类型统一，给出

```
1 ++ 2 :: Num [a] => [a] 
```

如果您有一个带有`Num`实例的列表类型，则也可以评估该表达式。

但是，默认情况下，没有可用的列表类型的实例`Num`，因此当您尝试评估它时，ghci 抱怨它找不到.`Num``[a]`

例如：

```
Prelude> instance Num a => Num [a] where fromInteger n = Data.List.genericReplicate n 1 

<interactive>:2:10: Warning:
    No explicit method or default declaration for `+'
    In the instance declaration for `Num [a]'

<interactive>:2:10: Warning:
    No explicit method or default declaration for `*'
    In the instance declaration for `Num [a]'

<interactive>:2:10: Warning:
    No explicit method or default declaration for `abs'
    In the instance declaration for `Num [a]'

<interactive>:2:10: Warning:
    No explicit method or default declaration for `signum'
    In the instance declaration for `Num [a]'
Prelude> 1 ++ 2 :: [Int]
[1,1,1] 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-23T15:54:42.323

因为有人*可以*将列表定义为数字：

```
instance Num a => Num [a] where
 (+) = zipWith (+)
 (*) = zipWith (*)
 (-) = zipWith (-)
 negate = map negate
 abs = map abs
 signum = map signum
 fromInteger x = [fromInteger x] 
```

然后你输入的内容会起作用，因为

```
 1++2 == fromInteger 1++fromInteger 2 == [1]++[2] 
```

（并不是说这个`Num`例子很有意义..）

# linux - 使用 ucs4 问题构建 numpy

> ID：15041589
> 
> 赞同：1
> 
> 时间：2013-02-23T14:28:38.803
> 
> 标签：linux, numpy, python-2.7, ucs

我已经成功安装了 ucs4 格式的 python2.7。

如果我使用以下命令安装 numpy：sudo pip install --upgrade numpy，它可以工作并且我可以使用它，但是通过这种方式安装只会将 numpy 放入我的 dist-packages，但是它需要在 site-packages 中。（因为 Jepp 只能在那里找到它们）

因此，我下载了 numpy tar 文件，构建了它（sudo python setup.py build）并安装了它（sudo python setup.py install），但它给了我未定义的符号：PyUnicodeUCS2_FromUnicode。对我来说，它用ucs2安装了numpy。

我如何强制使用 ucs4 安装 numpy？（我读过这篇文章：[Numpy 需要 ucs2](https://stackoverflow.com/questions/9929170/numpy-needs-the-ucs2)但 EPD 不是我的解决方案）

任何想法都可以帮助我！提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:07:56.817

我只是将安装的文件从 dist-packages 复制到站点包。如果有人有更好的解决方案，请告诉我。

# visual-studio-2012 - 错误 LNK2038：检测到“_MSC_VER”不匹配：值“1600”与 moc_testqt5.obj 中的值“1700”不匹配

> ID：15041595
> 
> 赞同：4
> 
> 时间：2013-02-23T14:29:30.147
> 
> 标签：visual-studio-2012, qt5

我尝试在 Visual Studio 2012 中使用 Qt5.0.1 编译一个简单的 GUI 应用程序，但出现以下错误：

```
qtmaind.lib(qtmain_win.obj) : error LNK2038: mismatch detected for '_MSC_VER': value '1600' doesn't match value '1700' in moc_testqt5.obj 
```

如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-19T10:26:08.547

可能你在 VS 2012 中使用 VS 2010 的库。如果你想用 VS 2012 构建你的程序，你需要获取或构建 VS 2012 的库。

# ios - 在 Adob e AIR 中将特定影片剪辑写入位图

> ID：15041596
> 
> 赞同：1
> 
> 时间：2013-02-23T14:29:38.323
> 
> 标签：ios, actionscript-3, air, screenshot

我正在 Adob​​e AIR 中为 iOS 开发游戏，我想截取屏幕截图（或屏幕特定部分/电影剪辑的位图捕获）。我已经读过可以使用本机扩展来截取屏幕截图，但我实际上并不需要整个屏幕，我只需要 Adob​​e AIR 中特定影片剪辑（或屏幕区域，如果可能的话）的位图表示。我认为我不需要访问本机 SDK 来实现这一点，但我找不到任何资源来实现我想要做的事情。

如何在**不**使用本机扩展的情况下在 Adob​​e AIR 中保存影片剪辑的“位图快照”？

谢谢，

能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:48:54.763

如果您只需要空中应用程序中的内容快照（例如 MovieClip/其他 DisplayObject），您可以使用 BitmapData 的[draw()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#draw%28%29)方法：

```
/*
* getSnapshot - simple snapshot of a DisplayObject
* @param matrix - the transformation matrix of the object to be drawn(translation/rotation/scale)
*                 use this parameter to include the object's tranformations or an arbitrary one. 
*                 Ex. getSnapshot(myClip,myClip.transform.concatenatedMatrix);
* @param coordinateSpace - the coordinate space from used to get bounds. if you're object's rotated, 
*                          the by passing null, the bitmap will include all contents, otherwise it will be
*                          clipped using the original/'unrotated' bounds.
*/
function getSnapshot(obj:DisplayObject,matrix:Matrix = null,coordinateSpace:DisplayObject = null):BitmapData{
    var bounds:Rectangle = obj.getBounds(coordinateSpace);
    var result:BitmapData = new BitmapData(bounds.width,bounds.height,true,0x00FFFFFF);
    result.draw(obj,matrix);
    return result;
} 
```

例如

```
var test:Shape = addChild(new Shape()) as Shape;
test.graphics.beginFill(0);test.graphics.drawRect(0,0,100,100);test.graphics.endFill();

var snapShot:Bitmap = addChild(new Bitmap(getSnapshot(test))) as Bitmap;
snapShot.x = test.width+10;

function getSnapshot(obj:DisplayObject,matrix:Matrix = null,coordinateSpace:DisplayObject = null):BitmapData{
    var bounds:Rectangle = obj.getBounds(coordinateSpace);
    var result:BitmapData = new BitmapData(bounds.width,bounds.height,true,0x00FFFFFF);
    result.draw(obj,matrix);
    return result;
} 
```

# git - Git 子模块 Foreach 拉取的语法？

> ID：15041599
> 
> 赞同：1
> 
> 时间：2013-02-23T14:29:56.863
> 
> 标签：git

我已经克隆了一个包含子模块的存储库，并且子模块都已经过 git-inited 和 git-updated。在将更改推送到一个或多个子模块（由另一台机器）后，我运行以下命令：

```
git submodule foreach git pull origin master 
```

在本地获取最新信息 - 但是当我进入我的子模块并执行操作时，`git status`我会收到“当前不在任何分支上”的消息。然后，我必须结合`git checkout`并`git pull`回到子模块的主分支。

如果我的目标是在我的所有子模块中“从主分支获取最新信息”，那么正确的 foreach 命令是什么？

**编辑例如**：

考虑一下：

1.  我有一个带有子模块 B 和两台机器 Z 和 Y 的存储库 A
2.  我将存储库和子模块克隆到 Y 和 Z。
3.  我在 Y 上更改 B 并将其推回服务器。

现在，我要的是使 Z 保持最新并获得 B 中的最新更改的语法——以这样一种方式，它可以扩展到多个子模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:25:45.137

如果我理解正确，您希望获得所有子模块的所有更改并将它们合并。如果是这样，`git submodule update --merge`应该可以解决问题。不知道为什么你甚至试图在那里使用 foreach 。

# javascript - 如何防止浏览器缓存json文件

> ID：15041603
> 
> 赞同：24
> 
> 时间：2013-02-23T14:30:27.047
> 
> 标签：javascript, html, json, caching

所以我正在做这个小项目，但我在捕捉时遇到了一些麻烦。不工作的一件事是浏览器不断缓存包含保存数据的 json 文件，当我在其他地方更新 json 时，浏览器会返回到它缓存的旧版本的 json 文件并读取它。不幸的是我不想那样。我根本不希望浏览器缓存文件，这样每次加载页面时，它都会向服务器询问 json 文件并根据该文件而不是它缓存的任何文件进行操作。但是，我希望能够缓存页面上的所有其他内容，但如果必须为此做出牺牲，那么这是我愿意做出的牺牲。一世'

```
<script src="mySaveFiles.json" cache="no"> 
```

或类似的东西来帮助我实现我所说的......帮助？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-02-23T14:34:25.947

最简单的方法是在源字符串中附加一些随机参数，这在服务器端会被忽略

```
<script src="mySaveFiles.json?nocache=123" ></script> 
```

一种解决方案是使用 JavaScript 生成脚本元素并附加当前时间，如下所示：

```
var el = document.createElement( script );
el.src = 'mySaveFiles.json?nocache=' + (new Date()).getTime();
document.head.appendChild( el ); 
```

这样，浏览器将永远不会缓存 JSON 文件，因为它在每次调用中似乎都是不同的文件（由于参数）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-23T14:36:59.147

我最喜欢的一个就是 htaccess（如果这对你来说是可能的，我看不到）

禁用多个扩展的缓存

```
<FilesMatch ".(pl|php|cgi|spl|scgi|fcgi|json)$">
    Header unset Cache-Control
</FilesMatch> 
```

仅对 1 个扩展禁用缓存

```
<Files .json>
    Header unset Cache-Control
</Files> 
```

我在这里找到它：[http ://www.queness.com/post/5421/17-useful-htaccess-tricks-and-tips](http://www.queness.com/post/5421/17-useful-htaccess-tricks-and-tips)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T14:35:52.590

两种选择：

1.  将 mySaveFiles.json?t=timestamp 查询参数添加到 url 的末尾。
2.  使用 XmlHttpRequest 对象拉入文件（您可能仍需要添加时间戳，具体取决于服务器）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-23T14:34:38.493

如果您不想缓存任何数据，则可以使用以下元标记

```
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="expires" content="-1"> 
```

# django - Django 管理员选择字段错误

> ID：15041604
> 
> 赞同：1
> 
> 时间：2013-02-23T14:30:26.700
> 
> 标签：django, admin, choicefield

我正在尝试在管理员中为我的用户设置性别但得到错误

> `Value u"[u'm']" is not a valid choice.`

管理员.py

```
class PlayerForm(forms.ModelForm):
    GENDER_CHOICES = (
        ('m', 'Male'),
        ('f', 'Female'),
    )
...
gender = forms.MultipleChoiceField(label="Gender", choices=GENDER_CHOICES)
...

class Meta:
    model = Player

class PlayerAdmin(admin.ModelAdmin):
    form = PlayerForm

admin.site.register(Player, PlayerAdmin) 
```

models.py（玩家模型）

```
class Player(AbstractBaseUser):
    GENDER_CHOICES = (
        ('m', 'Male'),
        ('f', 'Female'),
    )
    ...
    gender = models.CharField(max_length=1, choices=GENDER_CHOICES)
    ... 
```

有趣的事实：表单确实在管理员中显示了来自数据库的正确默认值。

尝试提交表单时的 POST Payload：

```
------WebKitFormBoundary009tVyo4cRJvIAnC
Content-Disposition: form-data; name="gender"

m 
```

编辑：忘了提到数据库是 Postgres 8.4 并且有问题的列是

```
VARCHAR(1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:37:27.217

由于您使用的是[`MultipleChoiceField`](https://docs.djangoproject.com/en/dev/ref/forms/fields/#MultipleChoiceField)：

```
gender = forms.MultipleChoiceField(label="Gender", choices=GENDER_CHOICES) 
```

它将性别保存到“列表”中。导致：

```
>>> gender = ['m'] 
```

您需要使用[`ChoiceField`](https://docs.djangoproject.com/en/dev/ref/forms/fields/#ChoiceField)which 用于选择单个事物：

```
gender = forms.ChoiceField(label="Gender", choices=GENDER_CHOICES) 
```

导致：

```
>>> gender = 'm' 
```

# php - 在文件夹中的所有文件中搜索字符串

> ID：15041608
> 
> 赞同：11
> 
> 时间：2013-02-23T14:30:55.507
> 
> 标签：php, linux

我正在寻找在某些文件夹结构中搜索某些字符串的最快方法。我知道我可以使用 file_get_contents 从文件中获取所有内容，但我不确定是否很快。也许已经有一些快速有效的解决方案。我正在考虑使用 scandir 来获取所有文件和 file_get_contents 来读取它的内容和 strpos 来检查字符串是否存在。

你认为有更好的方法吗？

或者也许尝试将 php exec 与 grep 一起使用？

提前致谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-23T14:38:55.180

您的两个选项是[DirectoryIterator](http://www.php.net/manual/en/class.directoryiterator.php)或[glob](http://php.net/manual/en/function.glob.php)：

```
$string = 'something';

$dir = new DirectoryIterator('some_dir');
foreach ($dir as $file) {
    $content = file_get_contents($file->getPathname());
    if (strpos($content, $string) !== false) {
        // Bingo
    }
}

$dir = 'some_dir';
foreach (glob("$dir/*") as $file) {
    $content = file_get_contents("$dir/$file");
    if (strpos($content, $string) !== false) {
        // Bingo
    }
} 
```

在性能方面，您始终可以[计算代码的实时速度](https://stackoverflow.com/a/1202746/427992)或很容易地找出[内存使用情况。](http://php.net/manual/en/function.memory-get-usage.php)对于较大的文件，您可能希望[使用](https://stackoverflow.com/a/9059073/427992)`file_get_contents`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T14:32:00.433

使用目录迭代器和 foreach： http: [//php.net/manual/en/class.directoryiterator.php](http://php.net/manual/en/class.directoryiterator.php)

# javascript - 我应该在什么时候或在什么情况下使 jQuery 中的对象无效？

> ID：15041609
> 
> 赞同：1
> 
> 时间：2013-02-23T14:30:57.923
> 
> 标签：javascript, jquery, performance, internet-explorer, memory-leaks

我正在开发一个大量使用 Javascript 并包含大量 DOM 操作的项目。随着代码的增长，我注意到有时在**Internet Explorer** (9) 下页面加载时 Javasript 执行会有延迟（大约 1-2 秒）。这种延迟从未在 Firefox 上发生过。

例如：

```
// the actual code contains much more stuff
$("body").append("<p>paragraph</p>"); 
```

尽管它`p`是动态生成的，但它应该在现代浏览器上的页面加载后立即看到。但在 IE 上，有时我可以清楚地看到在所有静态内容加载`p`后被**添加**，这使得整个页面跳跃。

如果我重新启动 IE，延迟就消失了。**但是，如果**已经完成了大量的 DOM 操作，它会在下一页刷新时再次发生。

所以我在想这是否是`memory leak`由于我很少取消对象引用引起的。

```
var foo = $("#foo");
foo.on("click", function() {
    var bar = '<div id="bar">bar</div>';
    $("body").append(bar);
    // nullify bar
    bar = null;
});
// nullify foo
foo = null; 
```

问题：

1.  我应该像上面的例子一样在使用完**每个对象引用后取消它们吗？**

2.  如果 Q1 的答案是否定的，我应该在什么时候或在什么情况下使对象引用无效？

3.  除了无效之外，我还能做些什么来防止内存泄漏？

PS：几年前我读过一些类似的问题，它们主要针对 IE 6/7。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T17:41:59.593

> 我应该像上面的例子一样在使用完每个对象引用后取消它们吗？

不，那是矫枉过正。

> 如果 Q1 的答案是否定的，我应该在什么时候或在什么情况下使对象引用无效？

当您不再需要它但它在仍然存在的功能范围内时。在您的示例中，`foo`可以从单击处理程序中引用，因此只要处理程序附加到 DOM，它就不会被垃圾收集。然而，没有理由取消`bar`。

> 除了无效化之外，我还能做些什么来防止内存泄漏？

*   根本不要使用变量。在您的示例中，您可以简单地使用链接：`$("#foo").on(…);`
*   如果它们与使用它们的执行上下文无关，请在不同的范围内声明您的处理程序函数：

```
$(document).ready(function() {
    var foo = $("#foo");
    foo.on("click", showBar);
    // do anything else with `foo`
});
function showBar() {
    var bar = '<div id="bar">bar</div>';
    $("body").append(bar);
}); 
```

> 几年前我读过一些类似的问题，它们主要针对 IE 6/7。

这是因为 IE6/7 在其垃圾收集器中存在一些错误（[javascript、循环引用和内存泄漏](https://stackoverflow.com/q/1999840/1048572)、[MSDN](http://msdn.microsoft.com/en-us/library/bb250448(VS.85).aspx) [文章](http://msdn.microsoft.com/en-us/library/dd361842(VS.85).aspx)）。然而，上面提到的技术与此无关，它们假设一个正确工作的 GC。通过优化 GC，甚至可能不需要它们，例如 V8 确实收集了实际上在范围内但不再使用的变量（[调试显示模块模式：函数在调用之前不在范围内？](https://stackoverflow.com/q/14853938/1048572)）。

# c# - 用于特定搜索功能的服务器端缓存 JQuery 自动完成

> ID：15041612
> 
> 赞同：2
> 
> 时间：2013-02-23T14:31:09.200
> 
> 标签：c#, jquery, asp.net, caching, jquery-autocomplete

我想将**服务器端缓存**与**JQuery UI Autocomplete**一起使用。我的网站在 ASP.NET 4.5 中，我使用 JQuery 1.9。

我创建了一个webservice函数如下：

```
SearchPhones(string phrase, byte type_id) 
```

为了识别缓存变量，如果我是正确的，我需要将短语和 type_id 保存到变量名称中，以便稍后在其他客户端询问具有相同短语和 type_id 的查询时引用该缓存变量。这种方法是否有任何限制（可变名称长度，就允许的字符数而言）？

例如：`HttpContextCurrent.Cache["the_search_term-type_id"]`

我还需要考虑空格和其他字符，这些字符不允许作为变量名的一部分。不过，我可能全都搞错了。**我不能**在函数顶部使用属性缓存，因为由于某种原因它不适用于 Ajax GET 请求。

结果：需要对使用 ASP.NET 4.5 Web 服务的 JQuery 自动完成 UI 使用服务器端缓存。

需要你的帮助。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:34:21.753

您可以利用 http 处理程序
[http://osman.it/aspnet/autocomplete-using-jquery-aspnet-c/](http://osman.it/aspnet/autocomplete-using-jquery-aspnet-c/)
这是一个可以使用会话`IRequiresSessionState`
[的方法 我如何在 HttpHandler 中使用会话变量](https://stackoverflow.com/questions/1240732/how-can-i-use-session-variable-in-an-httphandler)

# jsf - JSF primefaces更新对话框未将值传递给bean

> ID：15041614
> 
> 赞同：1
> 
> 时间：2013-02-23T14:31:24.123
> 
> 标签：jsf, primefaces

我遇到以下问题：

我可以毫无问题地添加角色，但是当我需要删除或编辑它时，由于*roleController.selectedRole*为**null**而无法正常工作。起初，我将托管 bean 用作 requestScope，但我认为 null 可能来自那里，因为每个请求都会重新创建 bean。所以我改为 ViewScoped 修复了添加按钮再次工作，但我仍然遇到编辑和删除的相同问题。

发生的事情如下：我选择一行并单击按钮编辑。这将正确显示包含角色信息的对话框。但是当我单击编辑时，我得到空值。我看过几个例子，似乎我没有做错任何事。但我可能会遗漏一些非常基本的东西：/

任何见解将不胜感激！

至于豆子，我有以下几点：

```
@ManagedBean
@RequestScoped
....
private Roles selectedRole = new Roles();
(I have the normal setter and getter)
    public void edit() {
        Logger.getGlobal().log(Level.INFO, "====> EDIT ROLE" + selectedRole.getRole());
    } 
```

该页面如下所示，省略了 ui:define 和 header 内容。

```
<h:form id="contentView">
    <p:dataTable id="lstRoles" var="r" value="#{roleController.rolesList}" selectionMode="single" 
                 selection="#{roleController.selectedRole}" rowKey="#{r.role}" paginator="true"
                 paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {CurrentPageReport}  {RowsPerPageDropdown}"
                 rowsPerPageTemplate="10,15,50" rows="10">
        <p:column headerText="Role" sortBy="#{r.role}">
            <p:outputLabel value="#{r.role}"></p:outputLabel>
        </p:column>
        <p:column headerText="Description">
            <h:outputLabel value="#{r.description}"></h:outputLabel>
        </p:column>                
        <f:facet name="footer">
            <p:commandButton value="New" icon="ui-icon-star" oncomplete="newRoleDialog.show()"></p:commandButton>
            <p:commandButton value="Edit" icon="ui-icon-check" oncomplete="editRoleDialog.show()" update=":editRoleForm:editRolePanel"></p:commandButton>
            <p:commandButton value="Delete" icon="ui-icon-trash"></p:commandButton>
        </f:facet>
    </p:dataTable>
    <p:blockUI block="lstRoles" trigger="lstRoles">
        LOADING 
    </p:blockUI>
</h:form>

<!-- Edit User -->
<p:dialog header="Edit User" widgetVar="editRoleDialog" resizable="false">
    <h:form id="editRoleForm">
        <p:panelGrid id="editRolePanel" columns="2">
            <h:outputText value="Role: "></h:outputText>
            <h:outputText value="#{roleController.selectedRole.role}"></h:outputText>

            <h:outputText value="Description: "></h:outputText>
            <p:inputText value="#{roleController.selectedRole.description}" required="true"></p:inputText>

            <f:facet name="footer">
                <p:commandButton value="Confirm" update=":contentView:lstRoles :growl" oncomplete="handleSubmitRequest(xhr, status, args, 'editRoleDialog','editRoleForm');" actionListener="#{roleController.edit()}"></p:commandButton>
                <p:commandButton type="reset" value="reset"></p:commandButton>
            </f:facet>
        </p:panelGrid>
    </h:form>
</p:dialog> 
```

**编辑：**我正在使用带有 primefaces 3.5 的 Glassfish 3.1

**编辑 2：**所以，看来我不能使用输出标签。如果我更改为输入，那么我会在 managedbean 中获得所需的值（我猜这是因为它调用了 setter，尽管我假设它在选择行时已经被处理）。但我不想编辑第一个字段，因为这是 PK 键，它也用作表中的 FK。但至少知道我知道发生了什么，或多或少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:55:05.930

您需要将从数据表中选择的角色设置为 managedbean 的 selectedrole 属性，试试这个：

```
<p:commandButton value="Edit" icon="ui-icon-check" oncomplete="editRoleDialog.show()" update=":editRoleForm:editRolePanel">
    <f:setPropertyActionListener target="#{roleController.selectedRole}" value="#{r}"/>
</p:commandButton> 
```

您很可能还需要制作 bean ViewScoped。

编辑：我不知道数据表的选择功能，以澄清您是否使用不需要上述代码。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-18T08:39:34.020

在 inputtext 中尝试**valueChangeListener属性。**您通常很难在**@SessionScope**中拥有实体的一部分。如果你使用它肯定有效

```
<inputText value="#{bean.value}"/> 
```

但如果你使用可能无法工作

```
<inputText value="#{bean.entity.value}"/> 
```

. 使用**valueChangeListener**并创建这样的方法可以强制为您的实体保存价值。

```
public void saveValue(ValueChangeEvent event) {
        Integer newValue = (Integer) event.getNewValue();//u can use getOldValue to get value before
        entity.setValue(newValue);
    } 
```

祝你好运！

# python - 如何在网页中连续显示python输出？

> ID：15041620
> 
> 赞同：11
> 
> 时间：2013-02-23T14:32:20.933
> 
> 标签：python, python-2.7, flask, jinja2

我希望能够访问一个网页，它将运行一个 python 函数并在网页中显示进度。

因此，当您访问网页时，您可以看到脚本的输出，就像您从命令行运行它一样，并在命令行中看到输出。

我需要在函数中做什么？

我需要在模板中做什么？

编辑：

我正在尝试将 Markus Unterwaditzer 的代码与模板一起使用。

```
{% extends "base.html" %}
{% block content %}

{% autoescape false %}

{{word}}

{% endautoescape %}

{% endblock %} 
```

Python代码

```
import flask
from flask import render_template
import subprocess
import time

app = flask.Flask(__name__)

@app.route('/yield')
def index():
    def inner():
        for x in range(1000):
            yield '%s<br/>\n' % x
            time.sleep(1)
    return render_template('simple.html', word=inner())
    #return flask.Response(inner(), mimetype='text/html')  # text/html is required for most browsers to show the partial page immediately

app.run(debug=True, port=8080) 
```

它运行但我在浏览器中看不到任何东西。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-23T15:45:58.063

这是一个非常简单的应用程序，它使用普通 HTTP 流式传输进程的输出：

```
import flask
import time

app = flask.Flask(__name__)

@app.route('/yield')
def index():
    def inner():
        for x in range(100):
            time.sleep(1)
            yield '%s<br/>\n' % x
    return flask.Response(inner(), mimetype='text/html')  # text/html is required for most browsers to show the partial page immediately

app.run(debug=True) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-05-03T13:16:43.327

我今天遇到了同样的问题，并找到了一种方法来调整 Markus Unterwaditzer 的答案以使用模板。

关键是使用 jinja's[`Template.generate()`](http://jinja.pocoo.org/docs/api/#jinja2.Template.generate)而不是`Template.render()`flask's 使用的`render_template()`.

```
import flask
import time

from jinja2 import Environment
from jinja2.loaders import FileSystemLoader

app = flask.Flask(__name__)

@app.route('/yield')
def index():
    def inner():
        for x in range(100):
            time.sleep(1)
            yield '%s<br/>\n' % x
    env = Environment(loader=FileSystemLoader('templates'))
    tmpl = env.get_template('result.html')
    return flask.Response(tmpl.generate(result=inner()))

app.run(debug=True) 
```

假设有一个`result.html`看起来像这样的模板：

```
{% extends "layout.html" %}
{% block body %}
<body>
  {% for line in result %}
    {{ line }}
  {% endfor %}
</body>
{% endblock %} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-23T15:12:14.973

我认为最直接的方法是创建页面，然后使用 AJAX 定期向服务器发出请求，并使用结果更新页面上的内容。这可能包括实施[长轮询](http://en.wikipedia.org/wiki/Comet_%28programming%29)来做到这一点。

无论如何，您都需要以某种方式使您的函数成为非阻塞的，这样您仍然可以在它运行时为请求提供服务。如果有一个等待，您可以手动编写一个为请求提供服务的函数，否则继续运行该函数的下一个“块”。这将涉及将您的功能分解为小部分，以便您可以根据需要分派它们。

更好的方法可能是使用线程或多处理，具体取决于您的函数是否受 IO 或 CPU 使用率的限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-24T01:49:22.027

你有使用 WebSocket 的计划吗？如果是这样，你可以参考：[Websocket with Flask and Gevent](http://www.socketubs.net/2012/10/28/Websocket_with_flask_and_gevent/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-23T15:05:58.133

您可以在其中一个模板中使用元刷新

元 http-equiv="刷新" 内容="5"

# c# - 从 c# 添加或删除访问文件时更新访问文件中的数据

> ID：15041626
> 
> 赞同：1
> 
> 时间：2013-02-23T14:33:02.297
> 
> 标签：c#, database

我在c#和access 2007之间有一个项目连接，当通过c#程序的接口添加或删除任何数据时，我的基础数据库没有任何变化，没有任何错误。请帮我 ...

# ios - AFNetworking 检查可用性

> ID：15041631
> 
> 赞同：19
> 
> 时间：2013-02-23T14:33:29.037
> 
> 标签：ios, ios6, afnetworking, reachability

我在`AFNetworking`没有子类`AFHTTPClient`化的情况下实现了，部分使用了以下代码`DownloadQueueManager`：

```
-(void)downloadPodcastAt:(NSString *)url toPath:(NSString *)path
{
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:url]
                                             cachePolicy:NSURLRequestReturnCacheDataElseLoad
                                         timeoutInterval:60.0];
    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];

    operation.outputStream = [NSOutputStream outputStreamToFileAtPath:path append:NO];

    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject)
    {
        [self saveQueuedItemInformation];
    } failure:^(AFHTTPRequestOperation *operation, NSError *error)
    {
        // Other stuff
    }];

    [operation start];
} 
```

我的问题是多方面的。我用谷歌搜索直到我的手指麻木了，还没有找到一个像样的代码示例，可以使用`AFNetworking`. （奇怪的是，有很多关于 importing 的讨论`SystemConfiguration.framework`，这似乎很容易）。因此，如果我的用户想要最小化他们的数据使用量，并且只使用 wifi 下载，我如何检查 wifi，并且只有在 wifi 可用时才下载？

其次，它似乎`AFNetworking`想成为一个用户友好的前端。但我实际上可以在这个前端使用一个前端，因为那里有很多东西需要人们清除才能获得需要的东西。我只需要访问一个 url，下载一个 xml 文件（基于可达性），然后用它做一些事情。我是否遗漏了一些使这成为一项简单任务的东西？

当我理解这一点时，我完全构建了一个或五个前端来简化实现（假设我不只是一个白痴）。提前感谢您的任何回复。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-23T17:04:06.310

实际上与[A-Live 所说的“](https://stackoverflow.com/questions/15041631/afnetworking-checking-availability#comment21142906_15041631)可达性是 AFNetworking”的一部分相反。它在`AFHTTPClient.h` [这里](https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFHTTPClient.h#L75-L81)实现。您需要在您的`.pch`文件中进行正确的导入，如此处所述[才能](https://stackoverflow.com/a/13479569/902968)使用它。

要使用它，您可能希望有一个 的子类，`AFHTTPClient`以便可以[在此处](https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFHTTPClient.h#L176)`setReachabilityStatusChangeBlock`使用定义。这是一个不使用子类的简单示例。

```
AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://google.com"]];
[client setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) {
    if (status == AFNetworkReachabilityStatusNotReachable) {
        // Not reachable
    } else {
        // Reachable
    }

    if (status == AFNetworkReachabilityStatusReachableViaWiFi) {
        // On wifi
    }
}]; 
```

如果您不喜欢这种可达性设置的工作方式，那么我会推荐[Tony Million 的](https://github.com/tonymillion/Reachability)Apple 可达性分支。简单的例子：

```
Reachability *reach = [Reachability reachabilityWithHostname:@"google.com"];
if ([reach isReachable]) {
    // Reachable
    if ([reach isReachableViaWiFi]) {
        // On WiFi
    }
} else {
    // Isn't reachable

    [reach setReachableBlock:^(Reachability *reachblock)
    {
        // Now reachable
    }];

    [reach setUnreachableBlock:^(Reachability*reach)
    {
        // Now unreachable
    }];
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-09-29T13:00:21.397

使用`AFNetworking`2.0 及更高版本，可以像这样检查可用性，

```
 [[AFNetworkReachabilityManager sharedManager] setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status) {
    switch (status) {
        case AFNetworkReachabilityStatusUnknown:
        case AFNetworkReachabilityStatusReachableViaWWAN:
        case AFNetworkReachabilityStatusReachableViaWiFi:
            //available
            break;
        case AFNetworkReachabilityStatusNotReachable:
            //not available
            break;
        default:
            break;
    }

    NSLog(@"Reachability: %@", AFStringFromNetworkReachabilityStatus(status));

}];

//start monitoring
[[AFNetworkReachabilityManager sharedManager] startMonitoring]; 
```

获取当前状态

```
[AFNetworkReachabilityManager sharedManager].reachable 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-06-04T20:02:34.773

只是一个更新，较新版本的 AFNetworking 已弃用 AFHTTPClient。

您可以改用 AFHTTPRequestOperationManager.h

取自 github 页面本身的一些小东西：

```
AFHTTPRequestOperationManager *manager = [[AFHTTPRequestOperationManager alloc] initWithBaseURL:url]; //url can be google.com or something you want to reach

NSOperationQueue *operationQueue = manager.operationQueue;
[manager.reachabilityManager setReachabilityStatusChangeBlock:^(AFNetworkReachabilityStatus status)

{
    switch (status)
    {
        case AFNetworkReachabilityStatusReachableViaWWAN:
        case AFNetworkReachabilityStatusReachableViaWiFi:
        {
            NSLog(@"SO REACHABLE");
            [operationQueue setSuspended:NO]; // or do whatever you want
            break;
        }

        case AFNetworkReachabilityStatusNotReachable:
        default:
        {
            NSLog(@"SO UNREACHABLE");
            [operationQueue setSuspended:YES]; 
            //not reachable,inform user perhaps
            break;
        }
    }
}];
[manager.reachabilityManager startMonitoring]; 
```

# spring-mvc - Spring MVC/Freemarker：在 Freemarker 表达式中使用来自 bundle 的消息

> ID：15041632
> 
> 赞同：2
> 
> 时间：2013-02-23T14:33:30.657
> 
> 标签：spring-mvc, internationalization, freemarker

在 Fremarker 模板中，我需要访问从 Freemarker 表达式中 Spring MVC 提供的 i18n 资源包中获取的消息。

我已经从中导入了 Spring 宏，`spring.ftl`并且可以将消息与以下宏一起使用：

```
<@spring.messageText "my.key" "Default message" /> 
```

但实际上我无法从内部表达式访问消息，例如内置函数：

```
${myBoolean?string( ###here I want my true message###, ###here I want my false message###)} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-24T09:22:08.030

在您展示的具体案例中，也许您应该只写

```
<#if myBoolean><@spring.messageText ...><#else><@spring.messageText ...></#if> 
```

如果经常需要，那就做一个`#macro`。

在更一般的情况下，问题是您不能从表达式中调用宏（或指令），Spring 也应该提供一个函数变体`message`。我不知道 Spring MVC，但是看着`spring.ftl`，似乎`springMacroRequestContext.getMessage(code, text)`应该可以解决这个问题。但这很冗长，所以您可能想创建一个`/lib/springutils.ftl`内容如下：

```
<#function message code text=''>
    <#if text != ''>
        <#return springMacroRequestContext.getMessage(code, text)>
    <#else>
        <#return springMacroRequestContext.getMessage(code)>
    </#if>
</#function> 
```

然后在您的模板中：

```
<#import "/lib/springutils.ftl" as su>

${myBoolean?string(su.message(...), su.message(...))} 
```

但是，请注意，如果您使用 打印一个值`${...}`，它会受到`#escape`（当然，如果您使用它）的影响，而如果您使用 打印一些东西`<@...>`，它永远不会转义（作为`<@...>`/`<#...>`意味着打印标记）。因此，如果您的消息包含 HTML，`${...}`那么您最终可能会按字面意思为用户显示 HTML 标记（如`<`将转义到`&lt;`等等）。除非，你写`<#noescape>${...}</#noescape>`.

（转义更新：FreeMarker 2.3.24 支持不带 的自动转义`#escape`，你可以使用`${su.message(...)?no_esc}`。更好的是，如果你在`message`函数内部知道消息是 HTML，你可以使用`<#return springMacroRequestContext.getMessage(...)?no_esc>`，然后只写`${su.message(...)}`，FreeMarker 不会加倍-逃脱它。）

# dotnetbar - 无法加载文件或程序集 DevComponents.DotNetBar2

> ID：15041635
> 
> 赞同：0
> 
> 时间：2013-02-23T14:33:43.600
> 
> 标签：dotnetbar

所以我得到了这个文件，它应该将访问数据库转换为 SQL（对于一个名为 PROFFIX 的特定程序，但这并不重要......）。但是，如果我尝试运行它，则会产生以下错误：

```
Fehler beim Starten von PROFFIX dbConvert! 
```

*（运行 PROFFIX dbConvert 时出错）*

```
System.IO.FileLoadException: Could not load file or assembly
'DevComponents.DotNetBar2, Version=10.3.0.4, Culture=neutral,
PublicKeyToken=7eb7c3a35b91de04' or one of its dependencies. The located
assembly's manifest definition does not match the assembly reference.
(Exception from HRESULT: 0x80131040)
File name: 'DevComponents.DotNetBar2, Version=10.3.0.4, Culture=neutral,
PublicKeyToken=7eb7c3a35b91de04'
  at dbconvert.frmHaupt.InitializeComponent()
  at dbconvert.frmHaupt..ctor()
  at dbConvert.pxDbConvertFkt.Main()

WRN: Assembly binding logging is turned OFF.
To enable assembly bind failure logging, set the registry value
[HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.
Note: There is some performance penalty associated with assembly bind failure
logging.
To turn this feature off, remove the registry value
[HKLM\Software\Microsoft\Fusion!EnableLog]. 
```

所以有人知道这个 DevComponents.DotNetBar2 到底有什么问题，我在哪里可以找到这个问题的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-27T01:19:56.423

构建您的应用程序所使用的控件版本与可执行文件随附的控件版本不同，或者根本不包含 DotNetBar。您必须始终在可执行文件中包含与您的应用程序编译时使用的完全相同版本的 DotNetBar。.NET Framework 始终绑定到编译程序集应用程序的确切版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-23T09:39:53.417

即使您已经拥有它的 dll 文件，但您应该从[http://www.devcomponents.com/dotnetbar/download.aspx安装 DotNetBar 模块](http://www.devcomponents.com/dotnetbar/download.aspx)

但当前版本不是 10.3.0.4。

您可以通过谷歌搜索或向他们或我要求找到它。

# c# - 找不到实体集名称“BIKESEntities.BIKEINFO”

> ID：15041637
> 
> 赞同：0
> 
> 时间：2013-02-23T14:34:13.163
> 
> 标签：c#, entity-framework

我正在使用存储库模式
我正在使用 Asp.net MVC。我已从业务层调用此存储库方法。

```
public class Repository:IRepository
{
    private BIKESEntities context;

    public Repository(BIKESEntities context)
    {
        this.context = context;
    }

    public void Save<T>(T entity)
    {            
        context.AddObject("BIKEINFO", entity);
        context.SaveChanges();
    }
} 
```

我在排队时遇到错误 `context.AddObject("BIKEINFO", entity);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:49:35.417

尝试这个。

```
context.AddObject(entity.GetType().Name, entity); 
```

或者，您也可以使用。

```
context.AddObject(typeof(T).Name, entity); 
```

这将使用泛型类型参数。

# asp.net - 在 masterpage 中使用 radsplitter 时运行 webapp 会发生什么？

> ID：15041640
> 
> 赞同：0
> 
> 时间：2013-02-23T14:34:18.557
> 
> 标签：asp.net, telerik

我`RadSplitter`在 my 中使用`masterpage`并创建了我`webform`using `masterpage`。

但是我对这个组件有一个问题，我可以使用它，但是在运行时`contentplaceholder`我`webform` 已经与页面的页脚合并，我不能在单独的窗口中使用它。请帮忙。

**母版页**：

```
 <%@ Page Title="" Language="C#" MasterPageFile="~/Main.Master" AutoEventWireup="true" CodeBehind="WebForm1.aspx.cs" Inherits="Automation.WebForm1" %>
<%@ Register TagPrefix="telerik" Namespace="Telerik.Web.UI" Assembly="Telerik.Web.UI" %>
<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div style="border:5px solid black">
            <h3>Request an Account</h3>
            <p>Accounts will be activated pending the approval of the Administrator.</p>
  </div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T15:04:31.410

你的意思是？只需将 ContentPlaceHolder 放在所需 RadPane 内的母版页中，内容就会出现在那里。RadSplitter 也允许内联内容，请参阅[此处](http://demos.telerik.com/aspnet-ajax/splitter/examples/externalcontentloading/defaultcs.aspx)的操作。

# iis-7 - IIS 重写规则以删除斜杠

> ID：15041643
> 
> 赞同：0
> 
> 时间：2013-02-23T14:34:35.447
> 
> 标签：iis-7, url-rewriting

我们收到了一些人发送的电子邮件，他们将 URL 弄乱为 /pagename.aspx/?email=emailaddress

而不是 /pagename.aspx?email=emailaddress

我需要一个重写规则来删除 .aspx 之后的斜线，有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-29T15:33:43.023

您应该在 web.config 中插入此规则：

```
<rule name="RemoveTrailingSlashRule" stopProcessing="true">
    <match url="(.*)/$" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
    </conditions>
    <action type="Redirect" url="{R:1}" />
</rule> 
```

# java - 如何有效地计算数百万个字符串之间的余弦相似度

> ID：15041647
> 
> 赞同：8
> 
> 时间：2013-02-23T14:34:48.797
> 
> 标签：java, python, algorithm, divide-and-conquer, cosine-similarity

我需要计算列表中字符串之间的余弦相似度。例如，我有一个超过 1000 万个字符串的列表，每个字符串都必须确定其自身与列表中每个其他字符串之间的相似性。我可以用来高效快速地完成此类任务的最佳算法是什么？分治算法是否适用？

**编辑**

我想确定哪些字符串与给定字符串最相似，并且能够拥有与相似度相关的度量/分数。我认为我想做的事情与最初不知道集群数量的集群一致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T19:14:20.900

你可以试试[SimString](http://www.chokkan.org/software/simstring/)。

它是一个用于近似字符串匹配的 C++ 库（带有 Python 或 Ruby 绑定）。

它声称可以在 1 毫秒内为 1300 万个字符串的数据库找到具有高余弦相似度的字符串。

[这里](http://www.aclweb.org/anthology-new/C/C10/C10-1096.pdf)使用的算法是基于倒排列表的修剪来描述的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:50:50.513

使用转置矩阵。这就是 Mahout 在 Hadoop 上所做的以快速完成此类任务（或仅使用 Mahout）。

本质上，以天真的方式计算余弦相似度是不好的。因为你最终会计算很多 0 * 的东西。相反，您最好在*列*中工作，并*在此处保留所有 0*。

# django - Django 无法在尚未保存的对象中对 upload_to 使用 pk

> ID：15041648
> 
> 赞同：0
> 
> 时间：2013-02-23T14:34:51.190
> 
> 标签：django, django-uploads

我在我的项目中建立了一个向导。在第一步中，我创建了一个对象“Building”并将其保存在数据库中。在第二步中，我让用户上传在第一步中保存的建筑物的图像。

图像在建筑物的模型中。

当我尝试自定义图像的保存路径时，我发现“instance.pk”为None。

如果我尝试访问应该在“实例”中的模型的每个属性，也会发生同样的事情。我可以访问的唯一属性是我在视图中手动设置的属性（例如 nome、descrizione、...）

我不明白为什么会发生这种情况。有人可以向我解释一下吗？

模型的一部分：

```
 class Building(models.Model):
    utente = models.ForeignKey(User);
    nome = models.CharField(max_length=200, unique=True)
    descrizione = models.TextField(max_length=1000, blank=True)
    link = models.URLField(blank=True)
    foto = ImageField(upload_to=content_file_name, blank=True)
    ... 
```

内容文件名：

```
 def content_file_name(instance, filename):         
    estensione = '.jpg'       
    posizione_punto = filename.rfind('.')        
    if posizione_punto > 0:
            estensione = filename[posizione_punto:]
    return '/'.join(['buildings', str(instance.pk), 'vetrina'+estensione]) 
```

视图的一部分（第二个向导步骤）：

```
 # I load the building from the db
 building = get_object_or_404(Building, pk=b_id)

 if request.method == 'POST':

       form = StepOneForm(request.POST, request.FILES)
       if form.is_valid():
            data = form.save(commit=False)
            building.data_update = datetime.datetime.now()
            building.nome = data.nome
            building.descrizione = data.descrizione
            building.link = data.link
            building.foto = data.foto

            building.save()

            ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:19:38.113

首先，您已经定义了您的`foto`字段，因为`foto = ImageField()`它可能应该是 `foto = models.ImageField()`

其次，当您启动表单时，您不包括`instance`参数（查看[文档](https://docs.djangoproject.com/en/1.4/topics/forms/modelforms/#modelform)）。它应该是这样的 -

```
form = StepOneForm(request.POST, request.FILES, instance=building) 
```

这就是 django 知道将 html 表单数据添加到现有实例的方式。如果你这样声明你的表格 -

```
from django.forms import ModelForm

class BuildingForm(ModelForm):
    class Meta:
        model = Building 
```

然后，当您执行此操作时，`data = form.save(commit=False)`您的`data`变量实际上是`Building`. 如果您已经说过表单与特定实例相关（例如，`building`您在视图开头声明的），那么`data`将是`Building`.

这意味着您可以将视图代码更改为 -

```
def your_view(request):
    building = get_object_or_404(Building, pk=b_id)
    if request.method == 'POST':
        form = BuildingForm(request.POST, request.FILES, instance=building)
           if form.is_valid():
               building = form.save(commit=False)
               building.save()
    else: #... 
```

查看[Form](https://docs.djangoproject.com/en/1.4/topics/forms/)和[ModelForm](https://docs.djangoproject.com/en/1.4/topics/forms/modelforms/#modelform)文档。

# c - 想改变gtkfilechooser

> ID：15041652
> 
> 赞同：0
> 
> 时间：2013-02-23T14:35:37.067
> 
> 标签：c, linux, gtk, gnome, vala

![](../Images/c67a44a414c9430d89674eb2572656af.png)

我希望为每个调用的程序更改此弹出窗口

```
public class OpenFileDialog : FileChooserDialog { 
```

理想情况下，它将涉及删除桌面和更改搜索等。我只是希望有人知道底层文件在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:28:20.917

文件选择器对话框的 UI 布局位于 gtk/gtkfilechooserwidget.c

[http://git.gnome.org/browse/gtk+/tree/gtk/gtkfilechooserwidget.c](http://git.gnome.org/browse/gtk+/tree/gtk/gtkfilechooserwidget.c)

# entity-framework - 实体框架约束以通过并发调用保持正值

> ID：15041655
> 
> 赞同：0
> 
> 时间：2013-02-23T14:36:06.920
> 
> 标签：entity-framework, asp.net-mvc-4, concurrency

我目前正在使用代码优先实体框架（5.0）制作一个 ASP.NET MVC4 应用程序。这是我第一个使用 ASP.NET MVC 和实体框架的项目，所以我对一些细节感到不知所措。该应用程序处理超市收银员的交易。

为了在超市进行销售，我有一个可用产品列表和每种产品的可用数量。按照逻辑，任何时候都不应该有给定产品的负数——所以我的问题是，我怎样才能以最好的方式解决并发问题？

发生这种情况时可能会出现问题：

我们有 4 根香蕉可用。出纳员 A 试图卖出 2 根香蕉。收银员 B 试图同时用 3 根香蕉进行销售。如果两个事务都通过，则数据库将保留 -1 香蕉并处于无效状态。

那么防止这种情况的最佳方法是什么？我试图找到几个选项，但我不知道该选择哪一个或它们是否适合：

1.  添加一个 Rowversion 列，以便仅在未对数据库进行任何更改时进行每个事务。我在这里看到的问题是，可能同时有很多交易，我不知道考虑到我们只需要保留这样严格的支票（每次另一位收银员进行交易时返回错误）是否值得金额为正。即每天可能只有 1-2 笔交易会导致问题，收银员将不得不不断地重新检查他们的销售额。
2.  在事务中的每个 SaveChanges 之后执行检查，如果项目数量无效，则回滚。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T08:40:33.877

此约束更容易在数据库中实施。想到的两个选项是（我会选择第二个）：

1.  使用可以检查结果计数 >= 0 的存储过程进行更新
2.  添加列约束，该列必须 >= 0

# sorting - 对 ListView 组进行排序？

> ID：15041656
> 
> 赞同：5
> 
> 时间：2013-02-23T14:36:10.630
> 
> 标签：sorting, listview, delphi, delphi-xe2

在 ListView 中，项目按组“BGroup”、“CGroup”和“DGroup”（这些是组标题）分组。现在，当我向 ListView 添加一个新项目并为该项目分配一个标题为“AGroup”的新组时，组“AGroup”总是插入到组的末尾；所以新的组顺序是：BGroup、CGroup、DGroup、AGroup。那么我怎样才能让组按正确的字母顺序排序呢？顺序应该是：AGroup、BGroup、CGroup、DGroup。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T15:10:10.010

您可以为此使用[`ListView_SortGroups`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775130%28v=vs.85%29.aspx)宏，例如，此宏希望您有自己的比较函数，由[`LVGroupCompare`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775142%28v=vs.85%29.aspx)函数原型定义。在以下代码中[`Header`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TListGroup.Header)，使用该[`CompareText`](http://docwiki.embarcadero.com/Libraries/XE2/en/System.SysUtils.CompareText)函数按属性对组进行排序，但现在由您来构建自己的比较。

忘记注意了；无论您传递给宏的最后一个`Pointer`类型参数，[`ListView_SortGroups`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775130%28v=vs.85%29.aspx)您都将在参数中的[`LVGroupCompare`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775142%28v=vs.85%29.aspx)函数中收到`pvData`，因此这将是某个列表视图的组排序函数，最好直接传递[`Groups`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TListView.Groups)该列表视图的集合以便于操作。

由于没有直接的方法可以按组 ID 查找列表视图组，因此我将为[`TListGroups`](http://docwiki.embarcadero.com/Libraries/XE2/en/Vcl.ComCtrls.TListGroups)该类使用以下辅助函数：

```
type
  TListGroups = class(ComCtrls.TListGroups)
  public
    function FindItemByGroupID(GroupID: Integer): TListGroup;
  end;

implementation

function TListGroups.FindItemByGroupID(GroupID: Integer): TListGroup;
var
  I: Integer;
begin
  for I := 0 to Count - 1 do
  begin
    Result := Items[I];
    if Result.GroupID = GroupID then 
      Exit;
  end;
  Result := nil;
end; 
```

[`LVGroupCompare`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775142%28v=vs.85%29.aspx)然后你可以通过这种方式在函数回调中使用这个辅助方法：

```
function LVGroupCompare(Group1_ID, Group2_ID: Integer;
  pvData: Pointer): Integer; stdcall;
var
  Item1: TListGroup;
  Item2: TListGroup;
  Groups: TListGroups;
begin
  Result := 0;
  Groups := TListGroups(pvData);
  Item1 := Groups.FindItemByGroupID(Group1_ID);
  Item2 := Groups.FindItemByGroupID(Group2_ID);
  if Assigned(Item1) and Assigned(Item2) then
    Result := CompareText(Item1.Header, Item2.Header);
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  Item: TListItem;
  Group: TListGroup;
begin
  Group := ListView1.Groups.Add;
  Group.Header := 'AGroup';

  Item := ListView1.Items.Add;
  Item.Caption := 'Item X';
  Item.GroupID := Group.ID;

  ListView_SortGroups(ListView1.Handle, LVGroupCompare, ListView1.Groups);
end; 
```

# ios - 如何在目标 C 中创建对象？

> ID：15041657
> 
> 赞同：-9
> 
> 时间：2013-02-23T14:36:33.460
> 
> 标签：ios, objective-c

我有两个.m 文件一个是masterdetail.m 和detailview.m 这里我要在masterdetail.m 中创建detailview.m 的对象它是怎么写的？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:41:04.893

首先`#import "detailview.h"`在中添加语句`masterdetail.m`

*并在（相关位置*）写入以下代码`masterdetail.m`

```
detailview *myObj =[[detailview alloc] init]; 
```

这 `myObj`是对象，`detailview`它根据您的要求使用。

更多信息[参考本官方文档](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/WorkingwithObjects/WorkingwithObjects.html)

# javascript - 需要在 javascript 中阻塞睡眠

> ID：15041658
> 
> 赞同：0
> 
> 时间：2013-02-23T14:36:35.177
> 
> 标签：javascript

我知道，我知道，这不是一个好的设计。非阻塞 setTimeout 或 setInterval 是一种更好的方法，但要实现非阻塞，您需要重构整个代码以在我的场景中具有回调点。让我解释：

1.  我有一个旨在从缓存（存储）中获取对象的函数
2.  如果对象可用，我接受它
3.  当对象不可用时，我请求它并通过轮询等待直到可用，并带有到期计数器/时间。在某一时刻（不太远）它将可用，然后我返回给调用者

我**无法实现回调，因为调用链（堆栈）非常深**且复杂，并且根本不可能重构所有代码以使用异步回调/等。在这种特定情况下，我真的需要一个单线程阻塞循环。

**现在问题来了：**

我不想简单地使用带计数器的简单 for 循环。这会消耗过多的 CPU 周期，并会导致计算机风扇启动（即使是几秒钟）。我正在寻找可以用作阻塞方法的最慢的 javascript 命令（或命令集）是什么，例如：

```
while ( needToContinue ) {
    slowestCommandOrFunction();
    needToContinue = checkIfNeedToContinue();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:41:09.147

听起来这是您想要同步的 ajax 请求。你可以用第三个参数来做到这一点`XMLHttpRequest.open`：

```
xhr.open('GET', url, false); 
```

不过，我仍然建议您花时间重构您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:44:41.943

如果你想加快重构速度，你可以使用 streamlinejs。基本上，您必须使用 streamlinejs 编译您的 JS，但作为交换，您可以通过在所有参数列表中添加下划线来使同步函数异步。例如

```
function foo() {
  for (var i=0; i<10; i++) {
    bar()
  }
} 
```

简单地变成

```
function foo(_) {
  for (var i=0; i<10; i++) {
    bar(_)
  }
} 
```

此外，如果您将服务器端 javascript 与 nodejs 一起使用，则可以使用光纤。

# php - 将带有简码的文件渲染到 wordpress 插件中

> ID：15041659
> 
> 赞同：1
> 
> 时间：2013-02-23T14:36:39.733
> 
> 标签：php, wordpress

我对 php 和 wordpress 比较陌生，我想知道如何在没有 include 语句的情况下呈现 php 文件。

例如，如果我有两个文件`plugin.php`和`component.php`

插件.php

```
<?php
  add-shortcode('myshortcode', 'myshortcode-func');

  function myshortcode-func()
    // magic function that loads
    $result = LOAD('component.php');
    return $result;
  }
?> 
```

组件.php

```
<div>
   <img scr="<?php getimage() ?>" />
</div> 
```

**注意** 我不想使用包含，因为我认为它会破坏渲染并在调用时将页面插入流中。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:44:02.637

您可以使用输出缓冲区：

```
function myFunc(){
  ob_start();
  include('component.php');
  return ob_get_clean();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:42:05.283

如何：

```
$php = file_get_contents("component.php");
eval($php); 
```

`eval`但是非常危险，不应该在生产中使用。

如果这是用于生产，我建议使用钩子/过滤器（参见 wordpress 源代码）。这使您可以即时执行代码块，但受到更多限制。

# java - Java删除不删除

> ID：15041660
> 
> 赞同：1
> 
> 时间：2013-02-23T14:36:48.807
> 
> 标签：java, file-io, directory

我正在编写一些代码来删除目录中的所有文件，到目前为止我有：

```
@ViewScoped
@ManagedBean
public class Delete {

    public void DeleteFiles() throws IOException {
        System.out.println("Called deleteFiles");
        File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/build/web/resources/pdf/up617648/");

        String[] myFiles;
        if (file.isDirectory()) {
            myFiles = file.list();
            for (int i = 0; i < myFiles.length; i++) {
                File myFile = new File(file, myFiles[i]);
                System.out.println(myFile);
                myFile.delete();
            }
        }

    }
} 
```

当我调用它时，我可以看到所有文件都被调用，但没有任何内容被删除，为什么会这样，这就是我在控制台中得到的：

```
INFO: Called deleteFiles
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\build\web\resources\pdf\up617648\1.png
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\build\web\resources\pdf\up617648\lecture04_A_slides.pdf 
```

路径中的所有文件都被删除了，但是在 Netbeans 中我仍然可以看到资源文件夹中的文件，即使该文件夹的直接路径为空，我已经完成了一个干净的构建。

这有点奇怪，它可以很好地从目录中删除文件，在 Netbeans 中它仍然显示文件，重新启动 netbeans 然后文件又出现在目录中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:39:13.163

Windows 文件系统对 Java 进行删除的方式并不友好。很可能其他东西拥有对该文件的引用/句柄，这使得 Windows 阻止其删除。如果您之前接触过同一个文件并且没有正确清理资源，那么这个东西可能实际上是任何东西，甚至是 JVM 本身。

# .htaccess - Iifr.ini 重写条件

> ID：15041666
> 
> 赞同：0
> 
> 时间：2013-02-23T14:37:22.650
> 
> 标签：.htaccess, redirect, http-status-code-301, iirf

在过去的 4 周里（是的，你没看错，4 周）我一直在尝试将我的网站重定向到一个新的域。

这是我想要做的：

将我的网站的根目录从 ukmotorhomehirerental 重定向到休闲出租直接.com

无需重定向所有子文件夹。IE。如果我点击 google 中的链接到我们的一个次要页面，我想登陆新域上的那个页面，而不被重定向到索引页面。值得一提的是，我确实希望逐页重定向次要页面。

我正在这样做（这很完美）......

```
RedirectRule ^/pages/contentPage.asp\?QN=94 http://www.leisurerentalsdirect.com/pages/contentPage.asp?QN=94 [I,R=301] 
```

然而，这是问题所在......

```
RedirectRule ^/ http://www.leisurerentalsdirect.com [I,R=301] 
```

我知道以上内容对浏览器意味着所有请求 ukmotorhomehirerental 的流量都将被转发到休闲租赁直接

我想我需要一些寻求条件申请，但我就是不明白如何做到这一点，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:07:42.280

您实际上并没有说出问题所在，但我认为您希望 www.ukmotorhomehirerental.com 转到 www.leisurerentalsdirect.com 和 www.ukmotorhomehirerental.com/somepage 转到 www.leisurerentalsdirect.com/somepage，对吗？

如果是这样，您应该只需要一个重定向规则：

```
RewriteCond %{HTTP_HOST} ^www\.ukmotorhomehirerental\.com/? [NC]
RewriteRule ^(.*)$ http://www.leisurerentalsdirect.com/$1 [L,R=301] 
```

这将简单地将 ukmotorhomhirerental.com 上的任何页面重定向到休闲租赁直接.com 上的同一页面（或根，如果没有）。

# java - 如何对列表进行排序 在Java中根据日期

> ID：15041670
> 
> 赞同：0
> 
> 时间：2013-02-23T14:37:44.960
> 
> 标签：java

我有一些表名作为我的方法的 i/p 参数。我需要获取creationDate（日期），计算每个表并将其放入合并列表中）

然后根据创建日期对列表进行排序。

这是方法：

```
public String getData(List tablename){
    Lifecycle.beginCall();
    EntityManager mgr = (EntityManager) Component.getInstance("entityManager");
    List data = new ArrayList();
    if (!tablename.isEmpty())
    {
        Iterator itr = tablename.iterator();
        while(itr.hasNext())
        {
            String element = itr.next().toString();
            Query q = mgr.createQuery("select to_date(s.creationDate), count(s)" +
                                      " from " + element + " s" +
                                      " group by to_date(creationDate)" +
                                      " order by to_date(creationDate)");
            List dataTemp = q.getResultList();

            data.addAll(dataTemp);

        }
    }
} 
```

现在我有列表数据，例如：

```
({["Jan 3, 2013 12:00:00 AM",10],
  ["Feb 3, 2013 12:00:00 AM",10],
  ["Jan 1, 2013 12:00:00 AM",10],
  ..........}) 
```

这里的挑战是我希望这个列表根据日期排序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:42:11.510

看看[Collections.sort()](http://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#sort%28java.util.List,%20java.util.Comparator%29)。您需要做的就是编写一个实现 a 的类，`Comparator<Date>`并将它与要排序的列表一起提供。

更好的是，由于 Date 已经是 Comparable，您只需调用`Collections.sort(data)`它，它将按升序排序。

编辑：仔细检查后，您的列表 ( `data`) 不包含 Date 对象，它实际上是一个 List ，每个元素都是大小为 2 的对象数组 - 数组中的第一项是表创建日期，第二项是行数。所以你需要这样排序：

```
Collections.sort(data, new Comparator<Object> {
    @Override
    public int compare(Object o1, Object o2) {
        Object[] a1 = (Object[]) o1;
        Object[] a2 = (Object[]) o2;
        Date d1 = (Date) a1[0];
        Date d2 = (Date) a2[0];
        return d1.compareTo(d2);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:49:25.453

最简单的方法是在数据库级别进行排序。

将您的查询更改为

```
 Query q = mgr.createQuery("select to_date(s.creationDate), count(s)" +
                                  " from " + element + " s" +
                                  " group by to_date(creationDate)" +
                                  " order by creationDate asc"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:52:15.227

如我所见，您从几个表中进行选择。您可以编写一个 SQL 查询，`UNION`用于通过一个查询选择所有记录。这是非常相似的查询：[SQL Query - Using Order By in UNION](https://stackoverflow.com/questions/213851/sql-query-using-order-by-in-union)。

# java - 更新 jTable - 将 jTable 作为参数传递

> ID：15041672
> 
> 赞同：1
> 
> 时间：2013-02-23T14:38:08.453
> 
> 标签：java, swing, netbeans, jdbc, jtable

我在 A 类中有一个方法，我希望 B 类（主 GUI）调用该方法，但是 A 类需要对 B 类中的 jTable 执行一些操作。

我不希望此方法在 B 类中，因为它需要与数据库的连接，并且我不希望我的 GUI 保存任何此类方法。

这是A类中的代码：

```
public void populatejTable(TableModel x) {
    try {
        String stmt = "SELECT * FROM APP.DATAVAULT";
        PreparedStatement ps = Main.getPreparedStatement(stmt);
        ResultSet rs = ps.executeQuery();
        x.setModel(DbUtils.resultSetToTableModel(rs));
        ps.close();
        rs.close();
    } catch (SQLException e) {
        System.out.println(e.getMessage());
    }
} 
```

我需要传递一个 jTable 类型的参数来设置它的模型。我尝试过所有不同的常见数据类型，例如 String、int 等……甚至尝试过 jTable 和 TableModel。

我猜你真的不应该这样做，但我找不到更好的解决方法？

这是在 B 类（我的 GUI）中调用此方法的代码：

```
//table
Account acc = new Account();
acc.populatejTable(datavaultjTable); 
```

我该怎么做呢？

我正在使用 Netbeans 7.3 Beta 2 GUI builder 创建表和 GUI - 在 OS X 上用 Java 编写。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:51:55.307

A 类中的代码无法编译。TableModel中没有`setModel()`方法。您的目标是在 GUI 类中不包含与数据库相关的代码是一个很好的目标，但如果它导致在与数据库相关的代码中包含 GUI 代码，结果会更糟。

GUI 类应该只包含 GUI 代码。数据访问代码应仅包含与数据库相关的代码。GUI 应该调用数据库访问代码上的方法来获取数据。它不应该将 JTable 实例甚至 TableModel 实例传递给数据访问代码：

```
public class GUI {
    private JTable table;
    private MyTableModel tableModel;
    private DataAccess dataAccess;
    ...

    public void fillTableWithDataFromDatabase() {
        List<Product> products = dataAccess.getProductsFromDatabase();
        tableModel.setProducts(products);
    }
}

public class DataAccess {
    public List<Product> getProductsFromDatabase() {
        // TODO:
        // create an empty list
        // execute a query
        // loop through each row
        // for each row, create a Product instance and add it to a list
        // return the list
    }
} 
```

# ios - 一个 UIBarButtonItem 的两个动作？

> ID：15041673
> 
> 赞同：0
> 
> 时间：2013-02-23T14:38:18.470
> 
> 标签：ios, objective-c, selector, uibarbuttonitem

我有一个`edit button`, 我通过它获得`self.editButtonItem`并将它设置为`self.navigationItem.leftBarButtonItem`，这样当它被按下时， a`UITableView`开始编辑并变成`"Done" button`. 再次按下时，视图停止编辑，按钮返回正常状态。当按下编辑按钮时，我还希望将`"add" button`一个链接到一个不同的动作。`"Clear" button`（就像`iPhone` `"Phone" app's favourites tab,`当按下编辑按钮时加号按钮变成一个清除按钮一样）。

我真的很想以`edit action`这种方式（）获得 and 样式等`self.editButtonItem`，但我也希望有一个额外的选择器链接到`edit button`.

**我该怎么做呢？**我试图为 创建一个类别`UIBarButtonItem`，但我真的不知道该怎么做。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:58:00.293

要创建标题可以更改的按钮，您可以执行以下操作：

为按钮定义一个 ivar：

```
UIBarButtonItem *_btnAddClear; 
```

在`viewDidLoad`：

```
_btnAddClear = [[UIBarButtonItem alloc] initWithTitle:@"Add" style:UIBarButtonItemStyleBordered target:self action:@selector(addClearAction:)];
_btnAddClear.possibleTitles = [NSSet setWithObjects:@"Add", @"Clear", nil]; 
```

由于您希望在点击“编辑/完成”按钮时更改此按钮的标题，因此您可以添加如下代码：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated {
    [super setEditing:editing animated:animated];

    _btnAddClear.title = editing ? @"Clear" : @"All";
} 
```

最后，按钮处理程序：

```
- (void)addClearAction:(UIBarButtonItem *)button {
    if (self.editing) {
        // perform "clear" action
    } else {
        // perform "add" action
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:55:08.517

**给101**`UIBarButton`之类的标签；

 **并在 BarButton 方法中编写以下内容

```
-(void)barButtonMethod
{
    UIBarButtonItem * myButton = (UIBarButtonItem *) sender;

    if(sender.tag == 101)
    {
         yourBtn.tag = 102;

         // Write Your first action method such like

         [self ActionMethod1];
    }
    else
    {
         yourBtn.tag = 101; 

        // Write Your second action method such like

         [self ActionMethod2]; 
     }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:57:02.347

对于editButtonItem，您真的不需要新的操作。

有一个属性可以跟踪 UIViewController 是否处于编辑状态。

```
@property(nonatomic, getter=isEditing) BOOL editing 
```

为了做你想做的事，你可以在你的 UITableViewController 中实现以下方法：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated {
    [super setEditing:editing animated:animated]        
    //Do your thing
} 
```**

# iphone - 如何在 iphone sdk 中使用 openlayers

> ID：15041676
> 
> 赞同：3
> 
> 时间：2013-02-23T14:38:29.010
> 
> 标签：iphone, objective-c, openlayers

我想使用openlayer创建自定义地图。但是我无法使用openlayer。我想在 iphone 中不使用谷歌地图来创建地图，所以我想使用其他方式在地图中填写自己的数据。我认为可以通过开放层实现，但我不知道。所以请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-23T23:29:02.983

OpenLayers 是一个 JavaScript 库。作为基于客户端的地图查看实用程序，它允许[“显示从任何来源加载的地图图块、矢量数据和标记”](https://www.npmjs.com/package/openlayers)。它类似于[Leaflet](http://leafletjs.com/)。

只有当你想在网络上渲染时，它们才有用（在这种情况下，你需要从某个地方（例如[OpenStreetMap](http://www.openstreetmap.org/)）抓取地图图块或地图图像，或者设置你自己的地图服务器）。

如果您想要在 iOS 上本地渲染地图，那么您可能需要一个工具包来获取和渲染地图图块或图像。这里有一些可能会有所帮助：

*   [WhirlyGlobe-Maply](https://mousebird.github.io/WhirlyGlobe/) ;
*   [七巧板](https://github.com/tangrams/tangram-es);
*   [全球地图](https://getyourmap.com/get_started/#objc)；
*   [Mapzen iOS SDK](https://github.com/mapzen/ios)；
*   [纽泰克 SDK](https://www.nutiteq.com/nutiteq-sdk/overview/)；
*   [Mapbox iOS SDK](https://www.mapbox.com/ios-sdk/)
*   [石英图](https://iosphere.de/en/products/quartzmaps/)；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:55:43.970

你可以在[phonegap](http://phonegap.com/)的帮助下使用它。

如果您不想使用 phonegap，那么您可以简单地使用 UIWebView。您可以在其中加载数据。在 UIWebView 中加载 HTML 文件。html 文件，包括 javascript 和 css 以及图像文件，没有任何问题。

```
NSString *fullPath = [NSBundle pathForResource:@"filename" ofType:@"html" inDirectory:path];
 [yourWebView loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:fullPath]]]; 
```

有关[openLayers的更多信息](http://www.openlayers.org/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T15:55:54.917

听起来您只是对在 iOS 应用程序中提供自定义地图感兴趣。如果是这样，那么[MapBox-iOS-SDK](https://github.com/mapbox/mapbox-ios-sdk)将允许您使用许多不同的地图源，而无需 Web 视图。如果您查看 github 上的 MapBox 项目，他们也有工具可以帮助您创建 SDK 可以使用的地图。

# colors - 在终端中为所有用户输入着色的简单方法？

> ID：15041678
> 
> 赞同：1
> 
> 时间：2013-02-23T14:38:49.210
> 
> 标签：colors, terminal

我知道有很多信息可以为某些命令的输出着色，但我想为我写入 Mac 终端的*所有内容指定一种颜色。*

它可以让我对我输入的所有内容都有一个特殊的颜色 - 而不是输出，只是我个人输入的代码 - 使我可以轻松地将代码扫描到最后一个命令所在的位置。我想找到一种方法来做到这一点，而不必为每个命令都写一个颜色别名——一种默认情况下将为我在终端中编写的所有内容实现唯一颜色的方法。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T16:16:18.580

我现在整理了这个...

在您喜欢的任何编辑器中打开您的 ~/.bash_profile。

添加以下代码：

```
export PS1="\e[0;32m[\u@\h \W]\$ \e[m" 
```

并保存。

你现在会看到你的命令提示符是绿色的，在终端中很容易找到自己:)

希望这对尝试解决相同问题的人有所帮助！

PS> 这些说明不仅仅涵盖终端中的颜色......它们还控制它在命令提示符中显示的内容。我担心它需要比我更高级的编码来破译哪个位指的是什么......对不起！

# r - R编程帮助编辑代码

> ID：15041684
> 
> 赞同：0
> 
> 时间：2013-02-23T14:39:42.330
> 
> 标签：r, edit, average, mean

我已经问了很多关于这个的问题，所有的答案都非常有帮助......但是我的数据再次很奇怪，我需要帮助......基本上，我想要做的是在一定的间隔范围内找到平均速度...可以说从 6 秒到 40 秒，我的平均速度将是 5 m/s...等等。所以有人指出我要使用此代码...

```
library(IRanges)
idx <- seq(1, ncol(data), by=2)
# idx is now 1, 3, 5\. It will be passed one value at a time to `i`.
# that is, `i` will take values 1 first, then 3 and then 5 and each time
# the code within is executed.
o <- lapply(idx, function(i) {  
    ir1 <- IRanges(start=seq(0, max(data[[i]]), by=401), width=401)
    ir2 <- IRanges(start=data[[i]], width=1)
    t <- findOverlaps(ir1, ir2)
    d <- data.frame(mean=tapply(data[[i+1]], queryHits(t), mean))
    cbind(as.data.frame(ir1), d)
}) 
```

这给出了这个输出

```
# > o
# [[1]]
#   start end width mean
# 1     0 400   401 1.05
# 
# [[2]]
#   start end width mean
# 1     0 400   401  1.1
# 
# [[3]]
#   start end width     mean
# 1     0 400   401 1.383333 
```

因此，如果我希望它是每 100 秒...我将更`ir1 <- ....., by = 401`改为`by=100`.

但是由于一些原因，我的数据很奇怪

1.  我的数据并不总是从 0 s 开始，有时它从 20 s 开始......取决于标本及其是否移动
2.  我的数据收集不会每 1 秒或 2 秒或 3 秒发生一次。因此，有时我会得到 1-20 秒的数据，但它会跳过 20-40 秒，因为样本没有移动。
3.  我认为这`findOverlaps`部分代码会影响我的输出。我怎样才能在不影响输出的情况下摆脱它？

这里有一些数据来说明我的麻烦......但我所有的真实数据都在 2000 年代结束

```
Time    Speed   Time    Speed   Time    Speed
6.3 1.6 3.1 1.7 0.3 2.4
11.3    1.3 5.1 2.2 1.3 1.3
13.8    1.3 6.3 3.4 3.1 1.5
14.1    1.0 7.0 2.3 4.5 2.7
47.4    2.9 11.3    1.2 5.1 0.5
49.2    0.7 26.5    3.3 5.9 1.7
50.5    0.9 27.3    3.4 9.7 2.4
57.1    1.3 36.6    2.5 11.8    1.3
72.9    2.9 40.3    1.1 13.1    1.0
86.6    2.4 44.3    3.2 13.8    0.6
88.5    3.4 50.9    2.6 14.0    2.4
89.0    3.0 62.6    1.5 14.8    2.2
94.8    2.9 66.8    0.5 15.5    2.6
117.4   0.5 67.3    1.1 16.4    3.2
123.7   3.2 67.7    0.6 26.5    0.9
124.5   1.0 68.2    3.2 44.7    3.0
126.1   2.8 72.1    2.2 45.1    0.8 
```

从数据中可以看出，它不一定以 60 秒等结束，有时它只以 57 秒等结束

**编辑**添加数据输入

```
structure(list(Time = c(6.3, 11.3, 13.8, 14.1, 47.4, 49.2, 50.5, 
57.1, 72.9, 86.6, 88.5, 89, 94.8, 117.4, 123.7, 124.5, 126.1), 
    Speed = c(1.6, 1.3, 1.3, 1, 2.9, 0.7, 0.9, 1.3, 2.9, 2.4, 
    3.4, 3, 2.9, 0.5, 3.2, 1, 2.8), Time.1 = c(3.1, 5.1, 6.3, 
    7, 11.3, 26.5, 27.3, 36.6, 40.3, 44.3, 50.9, 62.6, 66.8, 
    67.3, 67.7, 68.2, 72.1), Speed.1 = c(1.7, 2.2, 3.4, 2.3, 
    1.2, 3.3, 3.4, 2.5, 1.1, 3.2, 2.6, 1.5, 0.5, 1.1, 0.6, 3.2, 
    2.2), Time.2 = c(0.3, 1.3, 3.1, 4.5, 5.1, 5.9, 9.7, 11.8, 
    13.1, 13.8, 14, 14.8, 15.5, 16.4, 26.5, 44.7, 45.1), Speed.2 = c(2.4, 
    1.3, 1.5, 2.7, 0.5, 1.7, 2.4, 1.3, 1, 0.6, 2.4, 2.2, 2.6, 
    3.2, 0.9, 3, 0.8)), .Names = c("Time", "Speed", "Time.1", 
"Speed.1", "Time.2", "Speed.2"), class = "data.frame", row.names = c(NA, 
-17L)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:19:13.693

对不起，如果我不完全理解你的问题，你能解释一下为什么这个例子没有做你想做的事吗？

```
# use a pre-loaded data set
mtcars

# choose which variable to cut
var <- 'mpg'

# define groups, whether that be time or something else
# and choose how to cut it.
x <- cut( mtcars[ , var ] , c( -Inf , seq( 15 , 25 , by = 2.5 ) , Inf ) )

# look at your cut points, for every record
x 

# you can merge them back on to the mtcars data frame if you like..
mtcars$cutpoints <- x
# ..but that's not necessary

# find the mean within those groups
tapply( 
    mtcars[ , var ] , 
    x ,
    mean
)

# find the mean within groups, using a different variable
tapply( 
    mtcars[ , 'wt' ] , 
    x ,
    mean
) 
```

# javascript - 我的基于 Google Maps API 的代码不起作用

> ID：15041685
> 
> 赞同：0
> 
> 时间：2013-02-23T14:39:46.070
> 
> 标签：javascript, google-maps

我从 Google Maps API 复制了一个叠加折线示例的源代码，当我从 .htm 文件执行该代码时，它没有显示任何内容。我一直在学习 html、javascript 和 CSS，但我自己无法解决这个问题。这是我到目前为止的代码：

```
<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
<meta charset="utf-8">
<title>Google Maps JavaScript API v3 Example: Polyline Simple</title>
<link href="/maps/documentation/javascript/examples/default.css" rel="stylesheet">
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
<script>

  function initialize() {
    var myLatLng = new google.maps.LatLng(0, -180);
    var mapOptions = {
      zoom: 3,
      center: myLatLng,
      mapTypeId: google.maps.MapTypeId.TERRAIN
    };

    var map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

    var flightPlanCoordinates = [
        new google.maps.LatLng(37.772323, -122.214897),
        new google.maps.LatLng(21.291982, -157.821856),
        new google.maps.LatLng(-18.142599, 178.431),
        new google.maps.LatLng(-27.46758, 153.027892)
    ];
    var flightPath = new google.maps.Polyline({
      path: flightPlanCoordinates,
      strokeColor: '#FF0000',
      strokeOpacity: 1.0,
      strokeWeight: 2
    });

    flightPath.setMap(map);
  }
 </script>
 </head>
 <body onload="initialize()">
 <div id="map_canvas"></div>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:43:57.410

它的工作你只是看不到它。向其中添加以下样式：

```
#map_canvas{
    height:500px;
} 
```

小提琴：http: [//jsfiddle.net/ax6wg/](http://jsfiddle.net/ax6wg/)

# algorithm - 在给定范围内打印 BST 键

> ID：15041686
> 
> 赞同：0
> 
> 时间：2013-02-23T14:39:48.253
> 
> 标签：algorithm, runtime

我试图了解在给定范围内打印 BST 密钥的运行时间。我试图从[这个例子](http://prpds.blogspot.com/2011/07/print-bst-keys-in-given-range.html)中理解它，但我做不到。

我想我明白它的`O(log n)`来源。那是递归地通过BST，这将`O(log n)`适用于每一方，但我不确定：

1.  是从哪里来`K`的。它只是打印所需的恒定时间吗？如果是，为什么运行时不是`O(log n)`+ `O(k)`，而不是你会忽略 K

2.  `O(n)`from in order 遍历在哪里？因为它不在这个运行时。

3.  如果我们在树的每一侧的范围内都有多个值，运行时将如何变化。例如，如果范围从 4 开始呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-24T04:13:17.027

理解解决方案的更简单方法是考虑以下算法：

1.  在 BST 树中搜索大于键 k1 的最小值 - O(lgn)
2.  从 k1 按顺序遍历 BST 树节点，直到我们到达小于或等于 k2 的节点，并打印它们的键。因为完整的 BST 的中序遍历需要 O(n) 时间，如果 k1 和 k2 之间有 k 个键，则中序遍历需要 O(k) 时间。

给定的算法正在做同样的事情；在 k1 和 k2 之间搜索一个键需要 O(lgn) 时间，而打印只对 k1 和 k2 范围内的 k 个键进行，即 O(k)。如果所有 BST 密钥都位于 k1 和 k2 内，则运行时间将为 O(lgn) + O(n) = O(n)，因为需要打印出所有 n 个密钥。

# google-maps - Sencha Touch - 谷歌地图和居中标记

> ID：15041697
> 
> 赞同：3
> 
> 时间：2013-02-23T14:41:05.980
> 
> 标签：google-maps, sencha-touch-2

只是我还是 google maps api 似乎有点古怪？尝试简单地显示某些坐标的标记，然后将屏幕居中放置在标记上。

在我从视图中触发的控制器中：

```
onGoogleMapRender: function (googleMap) {

        var long = record.get("Longitude");
        var lat = record.get("Latitude");

        var pos = new google.maps.LatLng(lat, long);

        var marker = new google.maps.Marker({
            position: pos
        });

        marker.setMap(googleMap);
        googleMap.setCenter(marker.getPosition());
        googleMap.setZoom(14);

    } 
```

它似乎将标记放置在屏幕的中心，但是当我返回并在第二次或第三次显示相同的屏幕时，添加了标记，但这次标记没有居中。

有没有人让这个工作正常？我不认为它与任何 ST2 相关，但更多的是 google api 的怪癖。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:52:37.203

你必须以一个小的超时时间将其居中，这样它才能正常工作。

```
setTimeout(function() {
    googleMap.panTo(marker.getPosition());
}, 100); 
```

我不知道这是否是一个错误，但这种方式显示在陈列柜中。

# liferay - 在 cloudbees 上部署带有 liferay 的 portlet

> ID：15041699
> 
> 赞同：3
> 
> 时间：2013-02-23T14:41:09.630
> 
> 标签：liferay, liferay-6, portlet, cloudbees, liferay-theme

由于本教程，我成功在 cloudbees 上部署了 liferay 6.1.1：http: [//blog.cloudbees.com/2011/09/15-minutes-to-liferay-on-cloudbees-paas.html](http://blog.cloudbees.com/2011/09/15-minutes-to-liferay-on-cloudbees-paas.html)

现在，我在问如何在这个环境中部署主题和自定义 portlet 有没有办法，或者我应该切换到另一个 Paas 解决方案吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T22:08:08.963

您可以将 Liferay 与 portlet 重新打包到“堆栈”中并部署它 - 或者您可以让 liferay 从文件系统以外的其他地方加载 portlet（需要文件系统支持才能动态加载，这是一项正在进行的工作） .

# joomla2.5 - Joomla 2.5 仅在主页设置模块

> ID：15041701
> 
> 赞同：0
> 
> 时间：2013-02-23T14:41:42.407
> 
> 标签：joomla2.5

您好，我是开发人员，没有管理员，我的网站（电子商店）有问题。我在我的网站上使用 HikaShop 组件，并希望在主页上显示最后的产品。在主页中，我添加模块并设置位置，并在配置中设置为仅在主页上可见。但不工作。我在管理中配置哪里可见哪里不可见。我尝试在我的索引手册中添加

```
<div id="wraper"> 
   <jdoc:include type="message" />
    <?php
        $app = JFactory::getApplication();
        $menu = $app->getMenu();
        if ($menu->getActive() == $menu->getDefault()) 
        {?>
            <jdoc:include type="modules" name="position-10" /><?php
        } ?>

        <jdoc:include type="component" />

</div><!--END OF WRAPER --> 
```

我有顶部菜单（主页、关于我们、产品、联系人），当我单击顶部菜单中的关于我们和其他页面时，该模块不可见工作正常。但在现场我有侧边栏，我显示产品类别。还有一个问题，当我点击类别时，最后一个产品模块在那里可见。

示例：--> 顶部菜单

> example.com -> TRUE = 模块上一个产品可见
> 
> example.com/index.php/abut-us -> FALSE = 模块上一个产品不可见
> 
> example.com/index.php/product -> FALSE = 模块上一个产品不可见
> 
> example.com/index.php/contact -> FALSE = 模块上一个产品不可见
> 
> --> 边栏
> 
> example.com/category/17-fishing-road -> TRUE = 模块最后一个产品在所有类别中可见，但我仅在主页上配置

并且在所有侧边栏都是可见的。任何想法如何解决这个问题并只在

example.com/index.php（主页）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-17T18:05:20.097

尝试这个：

```
if(JRequest::getVar('view') == "frontpage" ) {
    //You are in!
}
else {
    //You are out!
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T14:09:20.277

模块的分配是通过模块管理器完成的，而不是模板 index.php

sp，进入模块管理器（后端），打开你要分配的模块，在左下角你可以选择你要分配的菜单项。

如果使用此方法不起作用，那么您的网站一定有问题。

希望这可以帮助

# java - Netty 4 beta1 内存消耗

> ID：15041706
> 
> 赞同：1
> 
> 时间：2013-02-23T14:42:19.077
> 
> 标签：java, netty

我注意到 Netty 4 Alpha 8 和 Netty 4 Beta 1 之间的内存消耗大幅增加（+70 个月）

使用 java 7 运行时在 Win7 上测试。

Netty 4 alpha 8 代码：[https ://github.com/ccheneau/Holmes/tree/b_netty_4_alpha_8/holmes-core/src/main/java/net/holmes/core/http](https://github.com/ccheneau/Holmes/tree/b_netty_4_alpha_8/holmes-core/src/main/java/net/holmes/core/http)

Netty 4 beta 1 代码：[https ://github.com/ccheneau/Holmes/tree/b_netty_4/holmes-core/src/main/java/net/holmes/core/http](https://github.com/ccheneau/Holmes/tree/b_netty_4/holmes-core/src/main/java/net/holmes/core/http)

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T21:35:12.537

实际上，内存增量是由新的池化字节缓冲区分配器分配的内存。

像这样使用 UnpooledByteBufAllocator：

```
ServerBootstrap sb = ...
sb.childOption(ChannelOption.ALLOCATOR, UnpooledByteBufAllocator.HEAP_BY_DEFAULT); 
```

减少内存消耗，但也可能提高性能。

# mysql - 查询没有返回正确的值

> ID：15041707
> 
> 赞同：-3
> 
> 时间：2013-02-23T14:42:26.827
> 
> 标签：mysql, sql

作为我的[查询问题](https://stackoverflow.com/questions/14829856/fetching-data-from-multiple-tables/14832228#14832228)的一部分，我正在尝试编写一个返回 null 和零值的 sql 查询，如何解决这个问题，[请参阅](http://sqlfiddle.com/#!2/30321/16)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:46:40.260

在您提供的[SQL Fiddle](http://sqlfiddle.com/#!2/30321/16)中，您需要删除周围的单引号：

```
'user_messages.messageid' 
```

只是：

```
user_messages.messageid 
```

第一个实际上与结果不匹配。

[更新的 SQL Fiddle](http://sqlfiddle.com/#!2/30321/22)

# c++ - 在 Visual Studio 中，在 c++ 项目的项目属性中，参考窗口是什么？

> ID：15041714
> 
> 赞同：1
> 
> 时间：2013-02-23T14:43:27.700
> 
> 标签：c++, visual-studio-2010, reference, project

这可能是很多人问的问题，但我找不到任何答案。

这个窗口是什么，他可以代替手动添加“添加包含文件夹”和“添加链接器文件夹”吗？为什么以及何时应该使用它（假设我与 openCV 或其他第三方合作）

谢谢

![在此处输入图像描述](../Images/f8ab2d19bf4962915434246e8c84d67e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:06:48.207

您可以改用 Additional Dependencies，但如果它是您解决方案中的另一个项目，最好将其添加为参考，因为这将确保正确的构建顺序。如果它是第三方静态库 (.lib)，则只能使用 Additional Dependencies。尽管您显示的屏幕截图适用于 C++/CLI 项目，但您也可以在其中添加对 .NET 程序集和 COM 组件的引用。

# ember.js - Morph 无法在 IE 8/9 中删除

> ID：15041720
> 
> 赞同：1
> 
> 时间：2013-02-23T14:44:28.420
> 
> 标签：ember.js

我正在开发一个 Ember 应用程序（使用 RC1）并且遇到了 IE 问题（惊喜）。我们有一系列嵌套视图，可以显示旅行的摘要、详细信息或编辑。行程视图（大致）如下所示：

```
{{#if tripController.showSummary}}
    {{template "view/TripSummaryView"}}
{{/if}}

{{#if tripController.showDetails}}
    {{template "view/TripDetailView"}}
{{/if}}

{{#if tripController.showEdit}}
    {{template "view/TripEditView"}}
{{/if}} 
```

在旅行摘要视图周围的 div 上，我有一个操作：

```
<div {{bindAttr id="tripController.tripId"}} 
     class="card single-line" 
     {{action "toggleDetails" tripController on="click"}} 
     style="cursor:pointer"> 
```

控制器处理动作：

```
toggleDetails: function(tripController) {
    if (this.get('showDetails')) {
        this.set('showDetails', false);
        this.set('showSummary', true);
    } else {
        this.set('showDetails', true);
        this.set('showSummary', false);
    }
}, 
```

一切都很普通，它在 Chrome、FF 和 Safari 中都能完美运行。但是当我在 IE 中运行它时，它会在 metamorph 的 realNode() 函数中爆炸（ember.js 中的第 17264 行）：

```
var realNode = function(start) {
    while (start.parentNode.tagName === "") {
      start = start.parentNode;
    }

    return start;
  }; 
```

出现此错误：

```
SCRIPT5007: Unable to get value of the property 'parentNode': object is null or undefined 
```

当我在代码中放置断点时，Ember 似乎正在尝试删除 2 个变形，但第二个在第一个内部，因此`start`第二次为 null。我在 Chrome 中的该函数中放置了一个断点，但它似乎从未被调用过。

我已经尝试将其简化为 JSFiddle，但我似乎无法让它崩溃 - 所以我们设置视图的方式一定有一些东西导致了问题。任何有关如何进行调试的建议将不胜感激！

谢谢，斯科特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T21:38:30.640

您可以使用 ContainerView 实现相同的目的，但我也面临类似的问题，即子视图未接收模型/控制器。这是一个[类似的帖子]（[一个需要 ContainerView 的示例，其中 childViews 与它们各自](https://stackoverflow.com/questions/15097868/an-example-of-containerview-required-where-childviews-are-binded-with-their-resp)的控制器绑定“containerview 的 childviews 控制器绑定”）

# php - 每个用户的表中最多 3 行

> ID：15041723
> 
> 赞同：0
> 
> 时间：2013-02-23T14:44:51.397
> 
> 标签：php, mysqli, query-optimization

如果新行是该特定用户的第 4 行，是否可以在没有 else/if 的情况下创建一个脚本？

我有一个名为 points_history 的表。字段是：

日期（日期时间），fk_player_id（整数），积分（整数）

这是我的插入：

```
mysqli_query($mysqli,"INSERT INTO points_history (date,fk_player_id,points) VALUES (NOW(),$player,$points)"); 
```

这样做的原因我希望能够回到球员历史和检查点，但只有最后 3 点并且不想要一个有一百万行的表格。

可以在一个sql查询中完成吗？

希望提前帮助和感谢:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T16:47:57.017

如果您向表中添加主键，这很容易做到`points_history`。

**第 1 部分：**
使用以下脚本将主键添加`points_history_id`到表中：

```
ALTER TABLE points_history RENAME TO points_history_old;

CREATE TABLE points_history
(
  `points_history_id` int(11) UNSIGNED NOT NULL AUTO_INCREMENT,
  `date` datetime NOT NULL,
  `fk_player_id` int(11) NOT NULL,
  `points` int(11) NOT NULL,
  PRIMARY KEY (`points_history_id`)
);

INSERT INTO points_history (date, fk_player_id, points)
SELECT date, fk_player_id, points
FROM points_history_old;

-- Drop table if migration succeeded (up to you)
-- DROP TABLE points_history_old; 
```

这只需要运行一次！

**第 2 部分：**
现在您可以使用以下 SQL 脚本添加新记录并删除过时的记录：

```
-- First insert the new record
INSERT INTO points_history (date,fk_player_id,points)
VALUES (NOW(),:player,:points);

-- Create temporary table with records to keep
CREATE TEMPORARY TABLE to_keep AS
(
    SELECT points_history_id
    FROM points_history
    WHERE fk_player_id = :player
    ORDER BY date DESC
    LIMIT 3
);

SET SQL_SAFE_UPDATES = 0;

-- Delete all records not in table to_keep
DELETE FROM points_history
WHERE points_history_id NOT IN (SELECT points_history_id FROM to_keep);

SET SQL_SAFE_UPDATES = 1;

-- Drop temporary table
DROP TEMPORARY TABLE to_keep; 
```

如果您使用支持事务的数据库，我强烈建议将此脚本包装在事务中。我在 MySQL 5.5.29 上对其进行了测试，它运行良好。

# c++ - 从 DLL 中获取 char *

> ID：15041733
> 
> 赞同：1
> 
> 时间：2013-02-23T14:46:00.887
> 
> 标签：c++, dll, char, loadlibrary

我有个问题。我的 dll 中有一个函数，定义如下：

```
int function(char *inVal, char *outVal, int *retVal) 
```

我使用 LoadLibrary 成功地将我的 dll 加载到控制台应用程序中，并使用函数指针调用我的函数：

```
typedef int (__cdecl *functionPtr)(char *, char *,int *); 
```

然后我将我的 inVal 传递给我的函数：

```
char * inVal = "input"; 
```

现在我想获得我的 outVal 和 retVal，我已经成功获得了 retVal，但我的 outVal 为 NULL：

```
int retVal = 0;
char outVal[200] = {0}; 
```

然后我调用我的函数：

```
int return = functionLNK(inVal , outVal, &retVal) 
```

有什么线索吗？！！

**编辑1：**

代码如下：

```
int function(char *inVal, char *outVal, int *retVal) 

{

PKI_Buf inBuf, signBuf, pemBuf;

......

outVal = (char*)pemBuf.data;

//I check outVal in this point and it is not NULL

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:00:24.240

问题出在`function`. 您按值传递`outVal`，这意味着您在函数内的指针是您传入的指针的副本。然后您使用`outVal = (char*)pemBuf.data;`. 您所做的只是修改了副本。外面没有变化。

不过，这不是您的方法的唯一问题。您还试图将指针传递给即将超出范围的对象成员。`pemBuf`具有自动存储持续时间（因为它是本地的`function`），这意味着它将在返回时被销毁。然后你的指针将指向一个无效的对象。

相反，您要做的是将`pemBuf.data`over 的内容复制到 . 指向的数组元素中`outVal`。您可以使用`std::copy`或来执行此操作`strcpy`。但是，您还有另一个问题是您没有传递缓冲区的大小（而且我不知道`pemBuf.data`数组的大小）。但是，假设您知道要复制多少`N`，您可以这样做：

```
std::copy(pemBuf.data, pemBuf.data + N, outVal); 
```

但是，您的代码非常类似于 C - 使用 C 风格的字符串、输出参数等。我建议您开始使用`std::string`.

# grails - Grails：使用 Criteria + projections 的结果作为原始表的过滤器

> ID：15041738
> 
> 赞同：2
> 
> 时间：2013-02-23T14:46:15.160
> 
> 标签：grails, hibernate-criteria, createcriteria

我有下表/模型：

```
class Post {
  int id;
  String comment;
  static belongsTo = [category_id:Category];
} 
```

我希望创建一个可以过滤`Post`掉`id`每个`Category`. 我想要`List<Post>`形式的结果。

换句话说（我相信）在 SQL 中，查询将如下所示：

```
SELECT *
FROM
  Post AS source
  JOIN (
    SELECT MAX(id) AS id, category_id 
    FROM Post
    GROUP BY category_id
  ) AS filter
  ON source.id = filter.id; 
```

如果我理解正确，第一步是使用`HibernateCriteriaBuilder`：

```
def c = Post.createCriteria();
  def results = c.list {
    projections {
      groupProperty("category_id", "myid")
      max("id", "version")
    }
  } 
```

所以我的问题分为两部分：

1.  我在正确的轨道上吗？

2.  如何使用结果对象获取`List<Post>`数组？

    （有点像`def latest = Post.FindAllByXXX(result);`：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-24T10:36:46.583

是的，你在正确的轨道上。我还将 Post 的*id*属性添加到我的预测中：

```
projections {
    property('id')
} 
```

然后使用*id*收集所有帖子以获取帖子列表，例如：

```
def latestPosts = results?.collect{Post.read(it[0])} 
```

# c# - 跳过 OnActionExecuted 执行

> ID：15041739
> 
> 赞同：5
> 
> 时间：2013-02-23T14:46:17.280
> 
> 标签：c#, .net, asp.net-mvc, actionfilterattribute, onactionexecuted

我制作了一个实现了 OnActionExecuted 方法的 ActionFilterAttribute。这意味着，它在 Action 方法之后运行。但是，在某些情况下，我希望 OnActionExecuted 不被执行。

我如何从 Action 方法中阻止 ActionFilter 被执行？

现在，我做了这个：

关于 Action 方法：

```
RouteData.Values.Add("CancelActionFilter", true); 
```

在 ActionFilter.OnActionExecuted() 上：

```
if (filterContext.RouteData.Values["CancelActionFilter"] != null)
{
    return;
} 
```

但我认为这可能存在一种更优雅的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:36:14.393

OnActionExecuted 在 ControllerActionInvoker 类的 InvokeActionMethodFilter 方法内调用。

在这个方法里面没有什么可以阻止被执行的动作。我认为你的解决方案很好。

[ControllerActionInvoker 类的代码](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/1acb241299a8#src/System.Web.Mvc/ControllerActionInvoker.cs)

# oop - 单元测试不同的类层次结构

> ID：15041740
> 
> 赞同：3
> 
> 时间：2013-02-23T14:46:30.243
> 
> 标签：oop, unit-testing, testing, tdd

进行考虑不同类层次结构的单元测试的最佳方法是什么，例如：

我有一个基类`Car`和另一个基类`Animal`。

Car 具有派生类`VolksWagen`和`Ford`. Animal 有派生类`Dog`和`Cat`.

您将如何开发在运行时决定您将使用哪种对象的测试。考虑到这些测试将应用于来自不同层次结构的数百万个对象，在不使用代码复制的情况下实现此类测试的最佳方法是什么？

这是我的一个朋友问的一个面试问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T11:21:36.517

我看到的问题：避免重复常见的测试来验证一个常见的基本类型的 n 派生。

*   创建一个抽象的测试夹具。在这里，您使用抽象方法 GetTestSubject() 在抽象基类（搜索术语“抽象测试夹具”）中针对基类型 & 编写测试。此类型的派生会覆盖该方法以返回要测试的类型的实例。因此，您需要使用单个重写方法编写 N 个子类型，但您的测试将只编写一次。
*   一些单元测试框架，如 NUnit 支持“参数化测试”（搜索词）——您必须在其中实现一个方法/属性，该方法/属性将返回需要运行测试的所有对象。然后它将在运行时针对每个这样的对象运行一个/所有测试。这样您就不需要编写 N 个推导 - 只需一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:16:17.827

这是我以前使用过的一种方法（嗯，它的一种变体）。

假设您`go`在 Car 上`breakDown`有某种通用方法（

```
public class Car {
    protected String engineNoise = null;

    public void go() {
        engineNoise = "vroom";
    }

    public void breakDown() {
        engineNoise = null;
    }

    public String getEngineNoise() {
        return engineNoise;
    }
}

public class Volkswagen extends Car {
    public void breakDown() {
        throw new UnsupportedOperationException();
    }
} 
```

然后你可以定义一个测试如下：

```
public abstract class CarTest<T extends Car> {
    T car;

    @Before
    public void setUp() {
        car = createCar();
    }

    @Test
    public void testVroom() {
        car.go();
        assertThat( car.getEngineNoise(), is( "vroom" ) );
    }

    @Test
    public void testBreakDown() {
        car.breakDown();
        assertThat( car.getEngineNoise(), is( null ) );
    }

    protected abstract T createCar();
} 
```

现在，由于`Volkswagen`需要在`testBreakDown`方法中做一些不同的事情——并且可能还有其他需要测试的方法——那么你可以使用以下`VolkswagenTest`.

```
public class VolkswagenTest extends CarTest<Volkswagen> {
    @Test(expected = UnsupportedOperationException.class)
    public void testBreakdown() {
        car.breakDown();
    }

    protected Volkswagen createCar() {
        return new Volkswagen();
    }
} 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T17:02:39.557

实际上**Unit Test**是指**Method Test**，当你要编写单元测试时，你必须考虑要编写和测试的方法的功能，然后创建用于测试的类和方法。通过在设计和编写代码时考虑这种方法，可能会创建类的层次结构或仅创建单个类或任何类型的其他设计。

但是当你必须像上面提到的那样使用现有设计时，最好的做法是使用`Interfaces`或`Base Classes`依赖对象，因为这样你可以轻松地模拟或存根这些类。

# maven - Maven Jetty 插件：如何从扫描 freemarker 模板中排除

> ID：15041745
> 
> 赞同：2
> 
> 时间：2013-02-23T14:46:54.313
> 
> 标签：maven, jetty, maven-plugin

我在带有 Freemarker 视图引擎的 Spring MVC 项目中使用 Maven Jetty 插件。按照建议，我将所有 ftl 模板放在：

```
/src/main/webapp/WEB-INF/ftl 
```

现在，每次我对 ftl 文件进行更改时，Jetty 都会因为自动扫描功能而重新启动。我想保留自动扫描和重新启动功能，但我不希望它对 ftl 模板文件起作用。

我阅读了有关插件配置的信息并将其配置为：

```
<configuration>
    ...
    <scanTargetPatterns>
        <scanTargetPattern>
            <directory>src/main/webapp</directory>
            <excludes>
                <exclude>**/*.ftl</exclude>
            </excludes>
        </scanTargetPattern>
    </scanTargetPatterns>
    <scanIntervalSeconds>10</scanIntervalSeconds>
</configuration> 
```

但这似乎不起作用。
每次我保存 ftl Jetty 都会重新启动。

# c - 保存字符串转换的数据结构

> ID：15041746
> 
> 赞同：0
> 
> 时间：2013-02-23T14:46:56.333
> 
> 标签：c, data-structures

我有一组从文件中解析的字符串转换规则。规则如下所示：

```
'aaa' -> 'bbb'

'aa' -> 'bc' 
```

假设我知道如何解析文件，那么在 C 中保存这些转换的好的数据结构是什么？稍后我将需要遍历数据结构并获取**所有**规则的转换的“输入”和“输出”。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T19:56:15.833

```
struct map {
  char* key;
  char* value;
}; 
```

假设您知道所有键，则可以创建这些结构的数组，按键搜索遍历它，然后使用关联的值。

# mysql - mysql数据库规范化/建模

> ID：15041747
> 
> 赞同：0
> 
> 时间：2013-02-23T14:47:01.383
> 
> 标签：mysql, database

我正在尝试将我的办公室移动到数据库应用程序中。这是我得到的：（ [来源：][[phunkei.de](http://www.phunkei.de/images/erd_office.png)][）][![](../Images/45102fd88df9f8b3d6a3a03963c7b5c8.png)](https://i.stack.imgur.com/OsnZS.png)

**公司**和**个人从****客户**那里继承（1:1 关系）。那是因为他们俩都可以是“客户”并收到账单，我想参考**orders**中的单个表。公司和客户之间还有另一种关系：多对多。我希望你们有一些改进的想法，因为我不太确定这一点。

编辑：公司和个人会有一些不同的领域...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:06:22.953

我认为自己是一个数据库新手，所以对这个建议持保留态度。我个人很想将其设置为星型模式。下面是一个例子：

[微软技术：BI 维度模型 - 星型模式](http://blog-mstechnology.blogspot.com/2010/06/bi-dimensional-model-star-schema.html)

![星型图式](../Images/43d251c7c7a4637a488b30de7f73eb5c.png)

这应该允许快速查询速度（如果所有内容都正确索引），并且应该允许您轻松添加更多属性进行查询。快速查询的一种权衡是更新 Fact 表。由于索引，这将变慢。

在过去的项目中，这对我来说效果很好，但同样，我绝不是合格的数据库专业人士。

# jquery - jQuery mobile 的 pageinit 导致导航返回问题

> ID：15041748
> 
> 赞同：0
> 
> 时间：2013-02-23T14:47:07.870
> 
> 标签：jquery, jquery-mobile, page-init

我使用 JQM 的应用程序具有用于动态填充自动完成框的用户搜索功能。服务器请求在输入 3 个字符后激活，然后在每个后续字符上激活。它工作正常，允许用户单击自动完成框中的链接并导航到页面。但是，在按下后退按钮时，输入第三个字符时永远不会进行服务器调用，我确信这取决于 JQM 推荐使用`$(document).on('pageinit')`.

如何更改此设置，以便在导航返回后可以使用搜索功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T18:27:13.623

我知道您使用的是“on”，但 Pageinit 只会在页面首次初始化时触发一次。

您应该将您的函数绑定到“pageshow”。

```
$( '#theSearchPage' ).on( 'pageshow',function(event){

           ../Do Your Stuff
}); 
```

# php - ajax表单提交后刷新页面

> ID：15041751
> 
> 赞同：0
> 
> 时间：2013-02-23T14:47:44.530
> 
> 标签：php, javascript, jquery, html

您好，我需要知道如何在提交 ajax 表单后刷新页面。Atm 我正在使用 onClick 功能，它似乎刷新了页面，但我仍然需要按 f5 才能看到我所做的更改。

js：

```
 <script>
    function reloadPage()
      {
      location.reload()
      }
    </script> 
```

形式：

```
echo'<form class="imageform" method="post" enctype="multipart/form-data" action=\'clase/app/admin_activare_oferta.php\'>';
echo'<input  type="hidden" name="id_oferta"  value="'.$oferta.'">';
echo'<input type="submit" id="activ" value="" onclick="reloadPage()"></form>'; 
```

我知道为什么我需要按两次按钮才能看到更改，因为我需要在 ajax 提交后运行刷新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:54:52.057

在 IE 中你应该使用 window.parent.location.href

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:51:16.307

location.href 或 location.replace 应该可以解决问题：

读这个：

[http://www.bloggingdeveloper.com/post/Location-href-vs-Location-replace-The-Difference-Between-JavaScript-Redirect-Methods.aspx](http://www.bloggingdeveloper.com/post/Location-href-vs-Location-replace-The-Difference-Between-JavaScript-Redirect-Methods.aspx)

# android - android应用程序的xml背景

> ID：15041753
> 
> 赞同：0
> 
> 时间：2013-02-23T14:48:13.047
> 
> 标签：android, background

![安卓应用的背景](../Images/b1ddbb20cf98f65c7e993b7e916da671.png)

我想为我的android应用程序制作一个背景xml，我附上了相同的图像，但我不知道如何制作，请帮助我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:56:33.707

试试这个例子实验并自己探索你可能会学到的东西:)

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
   <gradient
      android:startColor="#FFFFFF"
      android:endColor="#808080"
      android:angle="270" />
</shape> 
```

也试试这个。

```
<shape>
   <solid
      android:color="#449def" />
   <stroke
      android:width="2dp"
      android:color="#2f6699" />
   <corners
      android:radius="3dp" />
   <padding
      android:left="15dp"
      android:top="15dp"
      android:right="15dp"
      android:bottom="15dp" />
</shape> 
```

不要忘记将它们放在您的可绘制文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:42:45.197

这种方式解决了我的需求，但任何人都有更好的方法

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
<item>
    <shape android:shape="rectangle"> 
        <solid android:color="#017db1"/>
     </shape>
</item>

<item android:top="1px">
    <shape android:shape="rectangle" >
       <solid android:color="#ffffff"/>
    </shape>
</item>

<item android:top="2px">
    <shape android:shape="rectangle"> 
        <solid android:color="#017db1"/>
     </shape>
</item> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-23T15:03:45.883

我假设您是 Android 新手开发人员。

不要说应用程序。当您使用基于活动的 Android 开发时。

我假设您有一个名为 MyActivity.java 的主 Activity。在 onCreate 方法中，您必须添加一行代码，告诉活动使用自定义布局，例如：

```
setContentView(R.layout.my_layout); 
```

然后你必须在文件夹 /res/layout 中创建一个名为 my_layout.xml 的布局 xml，其中至少包含一个 Layout 组件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/my_bg_image"
    android:orientation="vertical" >
</LinearLayout> 
```

注意使用自定义图像的背景属性。此图像必须以 my_bg_image.jpg 的形式保存在项目的 /res/drawable 文件夹中。

这是一个开始。不断改进。

# autotools - 如何在 autoconf configure.ac 中获取顶级构建目录的绝对路径？

> ID：15041754
> 
> 赞同：9
> 
> 时间：2013-02-23T14:48:15.147
> 
> 标签：autotools, autoconf, automake

我正在开发一个项目，该项目需要一个具有自己的 makefile 和 configure.ac 的子项目。子项目是用于为主项目生成源文件的程序。有一个选项可以禁用此项目的构建并尝试使用已安装的版本。

在任何一种情况下，我都会创建一个变量，该变量在我的 Makefile.am 中使用，其中包含程序的路径。

我的问题是，当使用项目的本地版本时，如何获取它的位置以在我的 Makefile.am 中使用？

我试过了

```
FOOPLACE=${abs_top_builddir}/bar/foo 
```

但这总是使`FOOPLACE`contains only `/bar/foo`。我什至不确定这是否是正确的方法，即使原则上也是如此。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T21:11:11.377

我只是用一个简单的`configure.ac`.

`$abs_top_builddir`除非通过替换（即），否则我无法获得合理的值`AC_CONFIG_FILES`。根据[预设输出变量（autoconf）](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Preset-Output-Variables.html)，它们至少应该在`config.status`（即`AC_CONFIG_COMMANDS`）期间可用。他们不是。

潜入`config.status`，我发现它`@abs_top_builddir@`被设置为`$ac_abs_top_builddir`。这看起来很奇怪，我认为这可能是一个错误。[我已将其发送到 bug-autoconf](https://lists.gnu.org/archive/html/bug-autoconf/2013-02/msg00008.html)以了解他们的想法。

故事的寓意：它应该在任何完成替换的地方都起作用。您也许可以使用`$ac_abs_top_builddir`within `config.status`，但我不会依赖它。

这是我使用的测试：

配置.ac：

```
AC_PREREQ([2.67])
AC_INIT([], [0], [foo@example.com])
AC_MSG_NOTICE([notice: ${abs_top_builddir}])
AC_MSG_NOTICE([notice+ac: ${abs_top_builddir}])
AC_CONFIG_COMMANDS_PRE([echo "pre+ac: ${ac_abs_top_builddir}"])
AC_CONFIG_COMMANDS_PRE([echo "pre: ${abs_top_builddir}"])
AC_CONFIG_COMMANDS_POST([echo "post+ac: ${ac_abs_top_builddir}"])
AC_CONFIG_COMMANDS_POST([echo "post: ${abs_top_builddir}"])
AC_CONFIG_COMMANDS([echo],
[echo "config.status+ac: ${ac_abs_top_builddir}"
echo "config.status: ${abs_top_builddir}"])
AC_CONFIG_FILES([test], [chmod +x test])
AC_OUTPUT 
```

测试输入：

```
#!/bin/sh
# -*- sh -*-
# @configure_input@
echo "test: @abs_top_builddir@"
echo "test+ac: @ac_abs_top_builddir@" 
```

运行它`autoconf && ./configure && ./test`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-16T22:59:00.703

查看配置脚本内部，我看到运行配置脚本的绝对路径是通过使用设置的

```
ac_abs_confdir=`(
    cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error $? "$ac_msg"
    pwd)` 
```

我已经通过`$ac_abs_confdir`在 configure.ac 中使用它进行了测试，它可以工作。

# mysql - 改善案例何时表现？

> ID：15041758
> 
> 赞同：2
> 
> 时间：2013-02-23T14:48:53.687
> 
> 标签：mysql, database, innodb

请参阅下面的 SQL 查询：

```
 SELECT SUM(CASE WHEN status=0 AND type  IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_0',
           SUM(CASE WHEN status=0 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_0',
           SUM(CASE WHEN status=2 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_2',
           SUM(CASE WHEN status=2 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_2',
           SUM(CASE WHEN status=3 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_3',
           SUM(CASE WHEN status=3 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_3',
           SUM(CASE WHEN status=4 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_4',
           SUM(CASE WHEN status=4 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_4',
           SUM(CASE WHEN status=5 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_5',
           SUM(CASE WHEN status=5 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_5'
    FROM sales; 
```

需要半秒钟才能得到结果，我想进一步提高性能。有什么建议可以做什么？

`sales`表`innodb`被`status` `type`索引。表中超过 50,000 行`sales`。

我的.ini 文件：

```
[wampmysqld]
port        = 3306
socket      = /tmp/mysql.sock
skip-locking
key_buffer = 16M
max_allowed_packet = 1M
table_cache = 64
sort_buffer_size = 512K
net_buffer_length = 8K
read_buffer_size = 256K
read_rnd_buffer_size = 512K
myisam_sort_buffer_size = 8M
basedir=c:/wamp/bin/mysql/mysql5.1.36
log-error=c:/wamp/logs/mysql.log
datadir=c:/wamp/bin/mysql/mysql5.1.36/data

#innodb_data_home_dir = C:\mysql\data/
#innodb_data_file_path = ibdata1:10M:autoextend
#innodb_log_group_home_dir = C:\mysql\data/
#innodb_log_arch_dir = C:\mysql\data/
#innodb_additional_mem_pool_size = 2M
#innodb_log_file_size = 5M
#innodb_log_buffer_size = 8M
#innodb_flush_log_at_trx_commit = 1
#innodb_lock_wait_timeout = 50
innodb_buffer_pool_size = 500M 
```

3GB 内存，英特尔双核 CPU。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T14:51:35.040

在查询中添加`WHERE`子句

```
SELECT  SUM(CASE WHEN status=0 AND type  IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_0',
        SUM(CASE WHEN status=0 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_0',
        SUM(CASE WHEN status=2 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_2',
        SUM(CASE WHEN status=2 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_2',
        SUM(CASE WHEN status=3 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_3',
        SUM(CASE WHEN status=3 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_3',
        SUM(CASE WHEN status=4 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_4',
        SUM(CASE WHEN status=4 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_4',
        SUM(CASE WHEN status=5 AND type IN (0, 5, 7) THEN 1 ELSE NULL END) AS 'a_5',
        SUM(CASE WHEN status=5 AND type IN (1, 6, 8) THEN 1 ELSE NULL END) AS 'b_5'
FROM    sales
WHERE   status IN (0,2,3,4,5) AND
        type IN (0,1,5,6,7,8) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T14:59:32.890

您可以使用

```
SELECT COUNT(*) FROM sales AS 'a0' WHERE status=0 AND type  IN (0, 5, 7) 
```

其他 7 个查询类似。您可以通过连接将所有查询组合成一个大型查询。

# javafx-2 - JavaFX 打开新窗口

> ID：15041760
> 
> 赞同：49
> 
> 时间：2013-02-23T14:48:55.887
> 
> 标签：javafx-2

查看[此代码](http://code.metager.de/source/xref/netbeans/javafx2.samples/FXML-LoginDemo/src/demo/Main.java)，他们展示了一种在登录后显示新窗口的方法。当用户名和密码正确时，它会打开新对话框。我想要一个按钮单击以打开新对话框，而不检查用户名和密码。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-02-23T15:01:03.610

如果你只想要一个按钮来打开一个新窗口，那么这样的工作：

```
btnOpenNewWindow.setOnAction(new EventHandler<ActionEvent>() {
    public void handle(ActionEvent event) {
        Parent root;
        try {
            root = FXMLLoader.load(getClass().getClassLoader().getResource("path/to/other/view.fxml"), resources);
            Stage stage = new Stage();
            stage.setTitle("My New Stage Title");
            stage.setScene(new Scene(root, 450, 450));
            stage.show();
            // Hide this current window (if this is what you want)
            ((Node)(event.getSource())).getScene().getWindow().hide();
        }
        catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-03-15T19:07:30.690

我在我的 JavaFX 应用程序中使用以下方法。

```
newWindowButton.setOnMouseClicked((event) -> {
    try {
        FXMLLoader fxmlLoader = new FXMLLoader();
        fxmlLoader.setLocation(getClass().getResource("NewWindow.fxml"));
        /* 
         * if "fx:controller" is not set in fxml
         * fxmlLoader.setController(NewWindowController);
         */
        Scene scene = new Scene(fxmlLoader.load(), 600, 400);
        Stage stage = new Stage();
        stage.setTitle("New Window");
        stage.setScene(scene);
        stage.show();
    } catch (IOException e) {
        Logger logger = Logger.getLogger(getClass().getName());
        logger.log(Level.SEVERE, "Failed to create new Window.", e);
    }
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-10-11T19:24:22.730

下面的代码对我有用，我在按钮类中使用了上面的部分代码。

```
public Button signupB;

public void handleButtonClick (){

    try {
        FXMLLoader fxmlLoader = new FXMLLoader();
        fxmlLoader.setLocation(getClass().getResource("sceneNotAvailable.fxml"));
        /*
         * if "fx:controller" is not set in fxml
         * fxmlLoader.setController(NewWindowController);
         */
        Scene scene = new Scene(fxmlLoader.load(), 630, 400);
        Stage stage = new Stage();
        stage.setTitle("New Window");
        stage.setScene(scene);
        stage.show();
    } catch (IOException e) {
        Logger logger = Logger.getLogger(getClass().getName());
        logger.log(Level.SEVERE, "Failed to create new Window.", e);
    }

}

} 
```

# css - 为 Google Chrome 中的每个页面打印页眉

> ID：15041761
> 
> 赞同：15
> 
> 时间：2013-02-23T14:49:01.323
> 
> 标签：css, google-chrome, printing

我正在创建一个电视节目表，它至少对一个标准浏览器不应该有任何打印问题。

我需要在每个页面上放置徽标和标题以及表格标题，经过几天的尝试和搜索，我发现 Chrome 不会因为这个[已知的错误](http://code.google.com/p/chromium/issues/detail?id=24826)`position: fixed`而在每个页面上打印表格标题和元素。

由于`-webkit-print-color-adjust: exact`我经常使用的打印背景颜色和使用 CSS`@page`属性更改页面边框等功能，我已经自定义视图以使用 Google Chrome，但现在我看到它无法打印我正在寻找的标题替代品是：

*   忘记 Chrome 并开始为另一个需要调整打印背景颜色和更改页边距的浏览器创建打印视图（恐怕这是不可能的）。
*   找到一个 CSS/JS 解决方案，让谷歌浏览器在每一页上打印表格标题。

**TL; DR：**你知道任何 jQuery/JavaScript/等吗？在 Chrome 中的每个页面上打印表头的代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-10-03T22:25:37.087

是的，这是一个 Webkit/Chrome 的东西。它不会在每一页上打印标题。例如 FF。你可以做些什么来实现这样的事情是使用分页符。

分页符仅适用于块元素，因此您应该相应地设置 tr 的样式。

像这样：

```
tr{
    display:block;
} 
```

现在，您应该开始复制您的 thead 并使用 javascript 将其放入每 X 行：

```
var head = $('table thead tr');
$( "tbody tr:nth-child(10n+10)" ).after(head.clone()); 
```

在屏幕上，你不想要所有这些头像。使用媒体查询删除它们（为方便起见，我在 th > tr 行上添加了一个 .head 类。：

```
@media screen {
    tbody .head{
        display: none;
    }
} 
```

现在在每个 .head 之前进行分页：

```
tbody tr.head {
    page-break-before: always;
    page-break-inside: avoid;
} 
```

在此处查看：http: [//jsfiddle.net/jaap/7ZGVv/2/](http://jsfiddle.net/jaap/7ZGVv/2/) 请记住，jsfiddle 不允许您仅打开预览框架，因此此处无法打印，请将所有内容合并到您自己的文件中并您会看到表格将被拆分，样式并不完美，并且它不像您的浏览器本身决定拆分位置那样灵活，但是，嘿，这是一些东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-09T18:57:46.137

我在[这里发布了一个解决方案](https://stackoverflow.com/questions/7211229/having-google-chrome-repeat-table-headers-on-printed-pages/25737442#25737442)，可以解决这个问题，并且不需要您尝试使用强制分页符来抢占自然分页符（这种技术本质上是不可靠的并且容易浪费纸张）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-23T23:07:00.353

此解决方案不适用于表格标题，但它允许任意 html 的标题。我创建了一个库，允许 Chrome 打印页眉和页脚，请参阅[此答案](https://stackoverflow.com/a/34444930/2196424)。

# c# - 在 ASP.NET MVC 中创建 Cookie

> ID：15041765
> 
> 赞同：3
> 
> 时间：2013-02-23T14:49:18.903
> 
> 标签：c#, cookies, asp.net-mvc-4

这似乎应该很简单。但是，对于我的生活，我似乎无法在 ASP.NET MVC 中创建 cookie。目前，我有以下代码：

```
DateTime lastActivityDate = DateTime.UtcNow;
if (Request.Browser.Cookies)
{
  HttpCookie lastActivityCookie = new HttpCookie(COOKIE_LAST_ACTIVITY, lastActivityDate.ToShortDateString());
  lastActivityCookie.Expires = DateTime.Now.AddMonths(-12);                    
  this.ControllerContext.HttpContext.Response.Cookies.Add(lastActivityCookie);
} 
```

我设置了一个断点，并注意到似乎正在添加 cookie。（是的，我正在进入`Request.Browser.Cookies`街区）。然后我尝试使用以下方法检索 cookie：

```
DateTime lastActivity = DateTime.UtcNow.AddDays(-7);        // Default to the past week

HttpCookie lastActivityCookie = Request.Cookies[COOKIE_LAST_ACTIVITY];
if (lastActivityCookie != null)
{
  DateTime temp = DateTime.UtcNow;
  if (String.IsNullOrWhiteSpace(lastActivityCookie.Value) == false)
  {
    if (DateTime.TryParse(lastActivityCookie.Value, out temp))
      lastActivity = temp;
  }
} 
```

不幸的是，`lastActivityCookie`总是`null`。此外，当我在 Chrome 中查看“资源”选项卡时，我看到了 cookie 分支，但是，我尝试创建的 cookie 没有列出。不过，还列出了另外两个 cookie，包括 .ASPXAUTH cookie。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T14:55:40.313

查看*HttpCookie对象的**Expires*属性- 更多内容请参见[此处](http://msdn.microsoft.com/en-us/library/system.web.httpcookie.expires.aspx)。我相信你应该在未来设置 cookie 过期日期，就像 msdn 网站上的示例一样。因为您在过去设置了日期时间，所以 cookie 会自动过期并且您永远无法读取它。

# ruby - 使用 Rspec 测试 Goliath + Grape

> ID：15041777
> 
> 赞同：0
> 
> 时间：2013-02-23T14:50:21.370
> 
> 标签：ruby, testing, rspec, grape, goliath

我正在尝试测试 Goliath + Grape 应用程序，如下所示：

```
require 'em-synchrony/em-mongo'
require 'yajl/json_gem'
require 'goliath'
require 'grape'

class API < Grape::API
  version 'v1', :using => :path
  format :json

  resource 'categories' do
    # http://0.0.0.0:9000/v1/categories/
    get "/" do
      coll = env.mongo.collection('categories') #Connection Pool from Goliath ENV
      coll.find({})
    end
  end
end

class App < Goliath::API
  def response(env)
    API.call(env)
  end
end 
```

这两个类位于一个名为 app.rb 的文件中。运行`ruby ./app.rb -sv`启动一个`http://0.0.0.0:9000/v1/categories/`可以完美运行的 goliath 应用程序，但在制作更复杂的端点之前需要 rspec。无论如何运行我得到的规范

> 未定义的局部变量或方法“app”

我无法摆脱：

```
$ bundle exec rspec spec/api_spec.rb
FFFF

Failures:

  1) App App GET /v1/categories get several categories of repositories by name
     Failure/Error: get "/v1/categories"
     NameError:
       undefined local variable or method `app' for #<RSpec::Core::ExampleGroup::Nested_1::Nested_1::Nested_1:0x993eec4>
     # ./spec/api_spec.rb:9:in `block (4 levels) in <top (required)>' 
```

api_spec 如下所示：

```
require 'spec_helper'

describe App do
  include Rack::Test::Methods

  describe App do
    describe 'GET /v1/categories' do
      it 'get several categories of repositories by name' do
        get "/v1/categories"
        last_response.status.should == 200
        JSON.parse(last_response.body)["name"].should == "Ruby Web Frameworks"
      end
    end
  end
end 
```

更新 ：

将 app 方法添加到 spec/api_spec.rb ：

```
def app
    App
end 
```

引发另一种错误：

```
 1) App App GET /v1/categories get several categories of repositories by name
     Failure/Error: get "/v1/categories"
     NoMethodError:
       undefined method `call' for App:Class
     # ./spec/api_spec.rb:13:in `block (4 levels) in <top (required)>' 
```

更新

在 spec/api_spec.rb 中添加从 app 方法调用的 API 类：

```
def app
  API
end 
```

得到`undefined method`mongo'`：

```
Failures:

  1) App App GET /v1/categories get several categories of repositories by name
     Failure/Error: get "/v1/categories"
     NoMethodError:
       undefined method `mongo' for #<Hash:0xad5ea58>
     # ./app.rb:14:in `block (2 levels) in <class:API>'
     # ./spec/api_spec.rb:13:in `block (4 levels) in <top (required)>' 
```

见`coll = env.mongo.collection('categories')`内部 API 类

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-25T22:36:51.843

[我终于能够使用goliath test_helper](https://github.com/postrank-labs/goliath/blob/master/lib/goliath/test_helper.rb)使其工作。这是为了跟踪目的，希望它可以帮助别人。

在 spec/spec_helper.rb 添加 goliath 测试助手和所有依赖项。就我而言：

```
require 'em-synchrony/em-http'
require 'goliath/test_helper'
require 'yajl/json_gem'

Goliath.env = :test

RSpec.configure do |c|
  c.include Goliath::TestHelper, :example_group => {
    :file_path => /spec\//
  }
end 
```

在规范/app_spec.rb

```
require 'spec_helper'
require File.join(File.dirname(__FILE__), '../', 'app')

describe App do
  def config_file
    File.expand_path(File.join(File.dirname(__FILE__), '..', 'config', 'app.rb'))
  end

  let(:api_options) { { :config => config_file } }

  it 'renders ' do
    with_api(App, api_options) do
      get_request(:path => '/v1/categories') do |c|
        resp = JSON.parse(c.response)
        categories = resp.map{|r|r['name']}
        categories.to_s.should =~ /Ruby Web Frameworks/
      end
    end
  end
end 
```

Goliath 应用程序目录树，如下所示：

```
lsoave@ubuntu:~/rails/github/GGM$ ls -l 
total 48
-rw-rw-r-- 1 lsoave lsoave  483 Feb 25 23:06 app.rb
-rw-rw-r-- 1 lsoave lsoave 6321 Feb 25 23:06 categories.json
drwxrwxr-x 2 lsoave lsoave 4096 Feb 25 23:06 config
-rw-rw-r-- 1 lsoave lsoave  381 Feb 25 23:06 Gemfile
-rw-rw-r-- 1 lsoave lsoave 2293 Feb 25 23:06 Gemfile.lock
-rw-rw-r-- 1 lsoave lsoave   59 Feb 21 20:37 Procfile
-rw-rw-r-- 1 lsoave lsoave  123 Feb 25 23:06 Rakefile
-rw-rw-r-- 1 lsoave lsoave 7003 Feb 21 20:37 README.md
-rw-rw-r-- 1 lsoave lsoave  238 Feb 25 23:06 README.mongoimport
drwxrwxr-x 2 lsoave lsoave 4096 Feb 25 23:23 spec
lsoave@ubuntu:~/rails/github/GGM$ 
```

其中 config 和 spec 子目录如下所示：

```
lsoave@ubuntu:~/rails/github/GGM$ ls -l config spec
config:
total 4
-rw-rw-r-- 1 lsoave lsoave 870 Feb 25 23:06 app.rb

spec:
total 11
-rw-rw-r-- 1 lsoave lsoave  777 Feb 25 23:06 app_spec.rb
-rw-rw-r-- 1 lsoave lsoave  218 Feb 25 23:06 spec_helper.rb
lsoave@ubuntu:~/rails/github/GGM$ 
```

主要的 goliath 应用程序与我的第一篇文章相同：

```
require 'em-synchrony/em-mongo'
require 'yajl/json_gem'
require 'goliath'
require 'grape'

class API < Grape::API
  version 'v1', :using => :path
  format :json

  resource 'categories' do
    # http://0.0.0.0:9000/v1/categories/
    get "/" do
      coll = env.mongo.collection('categories') #Connection Pool from Goliath ENV
      coll.find({})
    end
  end
end

class App < Goliath::API
  def response(env)
    API.call(env)
  end
end 
```

最后非常简单。如果您想深入了解，请查看[https://github.com/lgs/GGM](https://github.com/lgs/GGM)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:11:24.923

我认为您必须在测试中提供一种方法来指定您的应用程序的类

```
def app
  App
end 
```

更新

改用 API 类

```
def app
  API 
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-16T07:59:08.537

添加其他 POST 示例：

```
require 'spec_helper'

describe V1::API do
  it "login" do
    with_api V1::Login do

      post_request(path: "/v1/login", :head => {'authorization' => HTTP_BASIC_HEADER }, :body =>{mobile: 18600112233}) do |async|

        async.response_header.status.should == 201
        async.response.should == { mobile: '18600112233' }.to_json
      end
    end
  end

end 
```

# php - 使用 where 和 SUBSTRING 推动

> ID：15041778
> 
> 赞同：0
> 
> 时间：2013-02-23T14:50:32.267
> 
> 标签：php, sql, propel

为什么这不起作用？

```
$allRecords = RecordsQuery::create()
->where('SUBSTR(Records.paymentTime, 1, 7) = ?', '2013-02')
->findOne(); //
var_dump($allRecords); 
```

它只是返回null。如果我将其用作 SQL 命令，它将返回正确的记录。

Records.paymentTime 是一个日期字段。

真诚的。

# asp.net-mvc - 如何使用 AJAX 获取列表的当前项？

> ID：15041779
> 
> 赞同：0
> 
> 时间：2013-02-23T14:50:32.920
> 
> 标签：asp.net-mvc, jquery, asp.net-mvc-4

也许标题不是很清楚。

想象一下，我在剃刀视图中有两列。

其中一列显示以下列表。

```
 @for (int i = 0; i < questions.Length; i++) {
        <tr>
            <td><span>@i</span>.</td>
            <td class="questionText">@Html.ActionLink(questions[i].QuestionText, "AddItemToAssignmentContent", new { itemId = "Q" + questions[i].Id })
        </tr>
    } 
```

如您所见，每个都有一个 url。

然后，第二列称为`SelectedItems`，其目的是当您单击第一列的链接时，将项目添加到第二列。

我想用 Ajax 来做这件事，但直到现在我还不知道如何用它来实现。

这是行动。

```
 public ActionResult AddItemToAssignmentContent(string itemId)
    {
        var list = Session["SelectedItems"] as List<CreateAssignmentSelectedItem>;

        CreateAssignmentSelectedItem item = new CreateAssignmentSelectedItem();
        item.Id = itemId;
        item.Display = itemId;
        item.Quantity = 5;

        list.Add(item);

        return PartialView("_SelectedAssignmentContent", list);
    } 
```

我错过了什么，或者我应该怎么做才能使用 AJAX 将项目添加到第二列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T01:21:06.640

一种方法是定义一个 javascript 函数，该函数将在执行链接的点击事件时被调用。该函数将通过 ajax 将请求异步发送到控制器操作，获取结果（部分视图）并填充 div

模拟功能

```
function addQuestionToList(questionId){
    var linkToControllerAction = ‘@Url.Content(….)’

    $.ajax({
        url: linkToControllerAction,
        type: ‘post’,
        data: { ‘itemId’: questionId }
    }).done(function(partialViewResult){
         $(‘#divHostingThePartialView’).html(partialViewResult);
    });
} 
```

并将此函数与每个 tr 的单击事件挂钩，这会显示问题的名称，替换您的操作链接

# c - %n 不能在 printf 中工作

> ID：15041781
> 
> 赞同：0
> 
> 时间：2013-02-23T14:50:44.460
> 
> 标签：c

我有一个问题，printf 中的 %n 不起作用，我在 win7 上使用 Dev-Cpp 5.3.0.4

```
#include<stdio.h>
int main(void)
{
int n;
char *x;
gets(x);
printf("\n%s%n\n",x,&n);
printf("n: %d\n",n);
return 0;
} 
```

输出：

```
hello how are you?

hello how are you?n: 2046

--------------------------------
Process exited with return value 0
Press any key to continue . . . 
```

为什么？我该如何解决？提前致谢 ;）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T14:53:48.263

看一下`printf`手册页：

> ```
>  n      The  number of characters written so far is stored into the integer indicated by the int
>           * (or variant) pointer argument.  No argument is converted. 
> ```

所以，你必须传递一个*指向*int 的指针。此外，正如 Xavier Holt 指出的那样，您必须使用有效的缓冲区才能读入。尝试这个：

```
#include <stdio.h>
int main(void)
{
  int n;
  char x[1000];
  fgets(x, 1000, stdin);
  printf("\n%s%n\n",x,&n);
  printf("n: %d\n",n);
  return 0;
} 
```

这段代码对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T14:53:40.360

您需要将指针传递给`n`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T14:54:24.770

to 的参数`n`需要是指向有符号整数的指针，而不是有符号整数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T14:56:24.353

这不是如何使用“%n”说明符。

请参阅[C99 标准](http://port70.net/~nsz/c/c99/n1256.html#7.19.6.1)。

> n
> 参数应该是一个指向有符号整数的指针，其中写入了到目前为止通过调用 fprintf 写入输出流的字符数。没有参数被转换，但有一个被消耗。如果转换规范包括任何标志、字段宽度或精度，则行为未定义。

您还需要一些地方来存储输入（提示：初始化`x`）

# clojure - Clojure AND / OR 的集合

> ID：15041782
> 
> 赞同：1
> 
> 时间：2013-02-23T14:50:49.597
> 
> 标签：clojure, functional-programming

```
(defn GetValuesFromWhereCommand
    "return a list of values from Where command"
    [Query tableName]
    (let [values (re-seq #"[0-9a-zA-Z_=<>]+" ((re-find #"WHERE(.*)" Query) 1))
        bitwise (re-find #"AND|OR" Query)
        tempList (ref #{})
       ] 
   ; first loop will look for the operators  = < >
   (doseq [item values]
    (let [result (case (re-find #"[=><]" item)
        "=" (GetRowsfromCondition tableName item = )
        "<" (GetRowsfromCondition tableName item < )
        ">" (GetRowsfromCondition tableName item > )
        nil (println "nothing")
     )]
     (when (not= nil result) (dosync (alter tempList conj result)) )
    tempList)
   )
   (println tempList)
   tempList)     ; get the Where from Update ','
) 
```

这是我的输出。

```
#<Ref@5a4e229e: #{#<Ref@3fc2e163: #{0}> #<Ref@63280c85: #{0 1}>}> 
```

我想实现将返回 #{0} 的 AND 操作
和将返回 #{0 1} 的 OR。

我的问题是如何访问我创建的列表。由于某种原因，我无法使用联合/交集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T14:55:40.933

您应该取消所有内部集合并将联合应用于新集合，它应该看起来像这样：

```
(let [newList (ref #{})] (doseq [item @your_ref_to_set_of_refs] (dosync (alter newList conj @item))) (apply union @newList)) 
```

# python - AttributeError: addinfourl 实例没有 __call__ 方法

> ID：15041784
> 
> 赞同：0
> 
> 时间：2013-02-23T14:50:57.040
> 
> 标签：python

第一遍一切正常，但第二次运行我得到 AttributeError: instance has no __ addinfourl call__ 方法，我不知道出了什么问题

第一次通过真状态：OK

第二遍 文件“D:\python\New Status\status.py”，第 124 行，打印 mainstatus.bite() 文件“D:\python\New Status\status.py”，第 109 行，咬 s = file ("cc.beat") AttributeError: addinfourl 实例没有调用方法

基本上用它来检查服务器的状态并确认另一个进程处于活动状态

```
 failure = True
    servestatus = False

    def log():
        a=open ("Status.failures","a")
        now = datetime.now()
        tiempo = str (now) +"  -  Error\n"
        a.write(tiempo)
        a.close ()

    class mainstatus(object):

        @staticmethod
        def xmlstatus():
            try:        
                file = urllib2.urlopen('http://192.168.1.110:9900/admin/xmlstatus?user=&password=')
                data = file.read()
                file.close()
                dom = parseString(data)
                xmlTag = dom.getElementsByTagName('Status')[0].toxml()
                xmlData=xmlTag.replace('<Status>','').replace('</Status>','')
                if xmlTag == "<Status>OK</Status>":
                    stat = True
            except:
                stat= False
            return stat

        @staticmethod
        def hola():
            x = "test"
            return x

        @staticmethod
        def internet(url):
            try:
                response=urllib2.urlopen(url,timeout=1)
                return True
            except urllib2.URLError as err: pass
            return False

        @staticmethod
        def heartbeat():
            a=open ("heart.beat","w")
            now = datetime.now()
            tiempo = str (now.minute)
            a.write(tiempo)
            a.close ()

        @staticmethod
        def push(mensaje):
            #Miguel
            conn = httplib.HTTPSConnection("api.pushover.net:443")
            conn.request("POST", "/1/messages.json",
              urllib.urlencode({
                "token": "",
                "user": "",
                "message": mensaje,
              }), { "Content-type": "application/x-www-form-urlencoded" })
            conn.getresponse()
            #Gerswin
            conn = httplib.HTTPSConnection("api.pushover.net:443")
            conn.request("POST", "/1/messages.json",
              urllib.urlencode({
                "token": "",
                "user": "",
                "message": mensaje,
              }), { "Content-type": "application/x-www-form-urlencoded" })
            conn.getresponse()

        @staticmethod
        def colam():
            cola = 0
            for root, dirs, files in os.walk("\\\\Server0\\smsdata\\Q"):
                    for file in files:    
                            if file.endswith('.req'):
                                    cola += 1
        @staticmethod
        def wol():
            HOST = "192.168.1.1"
            user = "root"
            password = "16745665"
            tn = telnetlib.Telnet(HOST)
            tn.read_until("login: ")
            tn.write(user + "\n")
            if password:
                tn.read_until("Password: ")
                tn.write(password + "\n")
            tn.write("/usr/sbin/wol -i 192.168.1.255 -p 7 00:11:25:36:08:FE\n")
            tn.write("exit\n")
            tn.read_all()

        @staticmethod
        def bite(): 
            now = datetime.now()
            tiempo = (now.minute)
            s = file("cc.beat")
            status = int(s.readline())
            s.close()
            vivo = tiempo - status    
            if (vivo > 0):
                return False
            else:
                return True

    count = 5
    print "Server Status Check: Runing..."

    while (count < 9):

        time.sleep(2)
        print mainstatus.bite()
        pulso = True
        if pulso == False:
            #os.startfile('check.exe')
            print "activa"
        else:
            pass
        status = mainstatus.internet("http://192.168.1.110:9900")
        mainstatus.heartbeat()
        if status == True:
          if   mainstatus.xmlstatus() == True:
              print '\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\bStatus:OK',

              if failure == True:
                  accion = os.system('net stop "NowSMS"')
                  file = urllib2.urlopen('http://sql.gerswin.com/status.php?status=OK')
                  data = file.read()
                  file.close()
                  failure = False

              if mainstatus.colam() >= 20 and servestatus == False:
                  accion = os.system('net start "NowSMS"')
                  mainstatus.push("Server Overload, Server 2 Running")
                  servestatus = True
              else:
                  if mainstatus.colam() < 20 and servestatus == True:
                      mainstatus.push("Stoping Server 2")
                      accion = os.system('net stop "NowSMS"')
                      servestatus = False
                      file = urllib2.urlopen('http://sql.gerswin.com/status.php?status=OK')
                      data = file.read()
                      file.close()

          else:
              print '\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\bStatus: Modem Failure',
              mainstatus.wol()        
              if servestatus == False:
                  accion = os.system('net start "NowSMS"')
                  mainstatus.push("Modem Failure, Server 2 Running")
                  log()
                  file = urllib2.urlopen('http://sql.gerswin.com/status.php?status=2')
                  data = file.read()
                  file.close()
                  servestatus = True

        else:
            print "\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\bStatus: Fallo Server",
            mainstatus.wol()
            if servestatus == False:           
                accion = os.system('net start "NowSMS"')
                file = urllib2.urlopen('http://192.168.1.110:9900?ok=no')
                data = file.read()
                file.close()
                log()
                mainstatus.push("Server Failure, Server 2 Running")
                servestatus = True 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T14:55:58.000

您正在使用全局变量`file`来存储`urllib2.urlopen()`两次调用的结果。但您也希望将其用作内置[`file()`类型](http://docs.python.org/2/library/functions.html#file)：

```
>>> import urllib2
>>> file('/dev/random')
<open file '/dev/random', mode 'r' at 0x10c8ee660>
>>> file = urllib2.urlopen('http://stackoverflow.com')
>>> file('/dev/random')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: addinfourl instance has no __call__ method 
```

不要那样做。不要使用您自己的变量名隐藏内置函数，*也*不要使用`file()`. 请改用该[`open()`功能](http://docs.python.org/2/library/functions.html#open)。

```
>>> open('/dev/random')
<open file '/dev/random', mode 'r' at 0x10c8ee6f0>
>>> response = urllib2.urlopen('http://stackoverflow.com') 
```

# android - 通过 xml 中声明的 id 从活动中获取自定义视图的引用

> ID：15041788
> 
> 赞同：1
> 
> 时间：2013-02-23T14:51:06.463
> 
> 标签：android, android-layout, view, reference

我有一个扩展 ImageView 的自定义视图，我在这样的 XML 布局中使用它：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="center"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_marginTop="10dp">

        <com.android.example.MyView
            android:id="@+id/myview1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp" />

        <com.android.example.MyView
            android:id="@+id/myview2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp" />

    </LinearLayout>

</LinearLayout> 
```

在我的活动中，我照常做： setContentView(R.layout.myLayout) 。

现在，我需要获取我的类/视图“MyView”的引用以设置自定义侦听器，但我无法从 id 中获取它。

```
myview (MyView) findViewById(R.id.myview1); 
```

返回空值。

我试图查看类似的问题，但没有发现任何对我有帮助的问题。

请注意，如果我从 Activity 以编程方式将视图添加到布局中，一切正常，但我希望能够在这里找到问题所在。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:56:09.840

它确实有效。

您使用的布局`setContentView`必须与您添加自定义视图的布局相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-24T14:45:46.280

我发现问题是一个愚蠢的剪切和粘贴错误，我在调用 super() 时忘记添加 AttributeSet

有

```
public MyView(Context context, AttributeSet attrs) {
    super(context);
} 
```

代替

```
public MyView(Context context, AttributeSet attrs) {
    super(context, attrs);
} 
```

# type-conversion - 在 Rust 中创建类型之间的自定义转换的标准方法是什么？

> ID：15041794
> 
> 赞同：3
> 
> 时间：2013-02-23T14:51:20.793
> 
> 标签：type-conversion, rust

如果我定义了一些枚举并想创建一个从字符串到该类型的解析器，有没有比仅仅更好的东西：

```
impl TheType {
    fn from_str(s: &str) -> TheType { 
        // ...
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T19:18:58.127

从字符串转换/解析文本的正确方法是实现[`FromStr`](https://doc.rust-lang.org/std/str/trait.FromStr.html)特征。对于问题中的示例，它看起来像这样：

```
use std::str::FromStr;

enum Failure {
    ReasonOne,
    ReasonTwo,
}

impl FromStr for TheType {
    type Err = Failure;

    fn from_str(s: &str) -> Result<TheType, Self::Err> { 
        unimplemented!()
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-19T11:21:04.450

对于不能失败的通用转换，您应该实现[`std::convert::From`](https://doc.rust-lang.org/std/convert/trait.From.html)特征：

```
use std::convert::From;

#[derive(PartialEq, Eq, Debug)]
enum MyEnum {
    One,
    Two,
    Many(i64),
}

impl From<i64> for MyEnum {
    fn from(val: i64) -> Self {
        match val {
            1 => MyEnum::One,
            2 => MyEnum::Two,
            _ => MyEnum::Many(val),
        }
    }
}

fn main() {
    assert_eq!(MyEnum::from(1), MyEnum::One);
    assert_eq!(MyEnum::from(2), MyEnum::Two);
    assert_eq!(MyEnum::from(3), MyEnum::Many(3));
} 
```

方便的是，实现`From`也自动实现[`Into`](https://doc.rust-lang.org/std/convert/trait.Into.html)：

```
let one: MyEnum = 1.into(); assert_eq!(one, MyEnum::One);
let two: MyEnum = 2.into(); assert_eq!(two, MyEnum::Two);
let many: MyEnum = 3.into(); assert_eq!(many, MyEnum::Many(3)); 
```

对于可能失败的转换，您应该实施[`std::convert::TryFrom`](https://doc.rust-lang.org/std/convert/trait.TryFrom.html)。它仅在 Rust 1.34 及更高版本中可用，在这些版本之前，您可以使用[`conv`crate](https://docs.rs/conv/*/conv/trait.TryFrom.html)中的实现。

# ember.js - TypeError：编译不是函数

> ID：15041795
> 
> 赞同：2
> 
> 时间：2013-02-23T14:51:29.057
> 
> 标签：ember.js, handlebars.js

我该如何处理错误：

**TypeError: compile is not a function
template = compile(script.html());**

在 ember-1.0.0-rc.1.js 中？

包含的框架有：

jquery-1.9.1.js

车把.1.0.0-rc.3.js

ember-1.0.0-rc.1.js

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T20:27:25.487

Ember 只*需要*Handlebars 运行时（可`handlebars.runtime.js`从[http://handlebarsjs.com](http://handlebarsjs.com)获得）。如果您想在浏览器中进行模板编译（而不是预编译所有模板并将生成的 JavaScript 发送到浏览器），您需要在页面上包含完整的 Handlebars 并更改`compile`为`Ember.Handlebars.compile`. （`Ember.Handlebars.compile`包含`Handlebars.compile`一些 Ember 特定的魔法。）

例如，

```
<script src="/assets/jquery-1.9.js"></script>
<script src="/assets/handlebars-1.0.0-rc.3.js"></script>
<script src="/assets/ember-1.0.0-rc.1.js"></script> 
```

和

```
MyView = Ember.View.extend({
  template: Ember.Handlebars.compile("{{foo}} {{bar}}"),
}); 
```

# ruby-on-rails - 为什么突出显示的结果包含在数组中？

> ID：15041796
> 
> 赞同：0
> 
> 时间：2013-02-23T14:51:34.137
> 
> 标签：ruby-on-rails, elasticsearch

向查询中添加突出显示选项时，为什么突出显示的文本会包裹在数组中？我需要在视图中执行此操作：

```
<%= link_to question.highlight.description[0].html_safe, question_path(question.id) %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:54:12.500

那是因为 elasticsearch 会返回一个它找到的高亮数组。

# c# - 简单生成的 MSIL 抛出“操作可能会破坏运行时”

> ID：15041803
> 
> 赞同：5
> 
> 时间：2013-02-23T14:52:39.587
> 
> 标签：c#, .net, cil, dynamicmethod

我创建了一个非常简单的函数，它执行以下操作：

```
 public static object[] ToArray(int ID) {
        return new object[4];
    } 
```

这是生成 MSIL 的代码。为什么这会引发“操作可能会破坏运行时”异常？我看不出有什么问题；它与 Reflector/Reflexil 中看到的组件完美匹配。

```
 // create method
    Type arrayType = typeof(object[]);
    Type intType = typeof(int);
    DynamicMethod dm = new DynamicMethod(methodName, arrayType, new Type[] { intType });
    ILGenerator il = dm.GetILGenerator();

    // create the array -- object[]
    il.Emit(OpCodes.Ldc_I4, 4);
    il.Emit(OpCodes.Newarr, typeof(object));
    il.Emit(OpCodes.Stloc_0);

    // return the array
    il.Emit(OpCodes.Ldloc_0); 
    il.Emit(OpCodes.Ret);

    return dm;
    object result = dm.Invoke(null, new object[] { 1 }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:02:22.040

我发现新变量没有正确声明。

您需要使用`DeclareLocal(typeof(T))`语法来声明一个新的本地变量。

更新后的代码片段如下：

```
 // create method
    Type arrayType = typeof(object[]);
    Type intType = typeof(int);
    DynamicMethod dm = new DynamicMethod(methodName, arrayType, new Type[] { intType });
    ILGenerator il = dm.GetILGenerator();

    // create the array -- object[]
    LocalBuilder arr = il.DeclareLocal(arrayType);
    il.Emit(OpCodes.Ldc_I4, 4);
    il.Emit(OpCodes.Newarr, typeof(object));
    il.Emit(OpCodes.Stloc, arr);  // <-- don't use direct addresses, use refs to LocalBuilder instead

    // return the array
    il.Emit(OpCodes.Ldloc, arr); // <-- don't use direct addresses, use refs to LocalBuilder instead
    il.Emit(OpCodes.Ret);

    return dm;
    object result = dm.Invoke(null, new object[] { 1 }); 
```

**编辑：**感谢 Jon Skeet，最终优化的代码片段如下：

```
 // create method
    Type arrayType = typeof(object[]);
    Type intType = typeof(int);
    DynamicMethod dm = new DynamicMethod(methodName, arrayType, new Type[] { intType });
    ILGenerator il = dm.GetILGenerator();

    // create the array -- object[]
    LocalBuilder arr = il.DeclareLocal(arrayType);
    il.Emit(OpCodes.Ldc_I4, 4);
    il.Emit(OpCodes.Newarr, typeof(object));

    // return the array
    il.Emit(OpCodes.Ret);

    return dm;
    object result = dm.Invoke(null, new object[] { 1 }); 
```

# php - 在哪里以及如何存储 PHP 可用的 MySQL 密码

> ID：15041805
> 
> 赞同：4
> 
> 时间：2013-02-23T14:52:48.440
> 
> 标签：php, security

我正在使用带有单例 PDO 的 PHP 来访问数据库，它显然需要 MySQL 的用户名和密码。

众所周知，用户名和密码不应存储在公共目录中。

因此，我可以做一些类似`require 'some_path/my_secrets.php';`设置一堆变量的事情，但是这些变量可能是全局定义的，这不是一个好主意（授予，在使用单例时不是全局的，但仍然如此）。好的，我只能在某些函数中需要秘密文件，但要记住的东西很多......

有没有更好的方法让 PHP 脚本可以使用私有数据？另外，我应该采取任何其他步骤吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:14:16.237

我有同样的问题，最初

*   数据库密码存储在目录中的*包含*文件中`includes`（即防止偶然的 PHP 代码直接从 Web 文件中显示）

然后出现了另一个想法，有点复杂但仍然很可行

*   制作一个 C 程序，该程序拥有已编码的 DB 数据并通过*系统*调用传递数据。源代码（包括编码密码）在安全的地方拥有。C 代码必须执行一些检查以确保调用来自 PHP 等...

但这相当昂贵 - C 速度很快，但一直通过*系统*加载密码很昂贵。因此，将 APC 添加到游戏中会使整个事情变得更容易和更快

*   在第一次请求期间，将 DB 数据加载到 APC 永久变量中 - 因此数据在内存中，更难以从外部获取。通常，该算法是

算法

```
Check if APC variables are set
If yes use them
If no load them from C program, only once 
```

[APC 文档](http://php.net/manual/en/book.apc.php)

*   另一个想法，例如使用是在包含密码`php-fpm`的 fpm 配置（只能由*root读取）中设置一个环境变量*

最后，您还可以创建自己的 PHP 扩展，提供来自 C 代码的数据（扩展通常用 C 编写）。[这是一些扩展文档](http://devzone.zend.com/303/extension-writing-part-i-introduction-to-php-and-zend/)。

这不是如何防止密码窃取的最终答案，但至少它会使黑客更难确定密码 - 并且还需要更多的知识。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:20:40.140

我知道的大多数系统都有一个受 .htaccess 保护的包含文件。在里面定义一个配置数组并完成。也许不是最安全的方法，但许多商店、CRM 和其他网络服务都这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:46:07.450

首先，我想说，除非您的 PHP 应用程序需要它，否则尽可能地限制应用程序的数据库帐户的权限（例如：对适当表的读取权限，也许尽可能少的写入权限）。如果您的应用程序需要管理员访问权限来创建表等，那完全是“另一罐蠕虫”。

其次，正如 ring0 建议的那样，不要以纯文本形式存储数据库密码。我建议使用散列 API 来存储密码的散列，例如：[https](https://gist.github.com/nikic/3707231) ://gist.github.com/nikic/3707231 。当然，哈希可能最好存储在其他第三个位置（至少是一个单独的文件）。如果您的用户是值得信赖的，并且您可以找到一种方法，则可以根据用户的登录信息计算散列，但这可能需要在您的密码文件中为每个用户单独输入（因为每个散列的数据库密码都是不同的）。

从来没有万无一失的方法，我也不是安全专家，但我知道纯文本总是不利于存储密码，所以我认为这是朝着正确方向迈出的一步。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-23T17:21:55.627

你的解决方案很好。

大多数建议的解决方案都被夸大了，尽管它们可能会提高安全级别，但不值得付出额外的努力。

因为安全不应只依赖于密码的保密性。充其量，即使密码被泄露，它的知识对于攻击者来说也毫无价值，因为他无法使用它。

这意味着，使用专用于您的应用程序的 MySQL 用户，其权限遵循[最小权限原则，](http://en.wikipedia.org/wiki/Principle_of_least_privilege)并且只允许从该应用程序的 Web 服务器访问数据库（请参阅[MySQL 访问权限系统](http://dev.mysql.com/doc/refman/5.6/en/privilege-system.html)）。

# string - 如何将其转换为正确的字符串？

> ID：15041806
> 
> 赞同：2
> 
> 时间：2013-02-23T14:52:52.250
> 
> 标签：string, actionscript-3, flash, string-conversion

我从使用`URLRequest`ActionScript 3 加载的 php 文件接收数据。当我跟踪时，`data.toString()`我得到以下输出。

```
systemResult=Invalid%0D%0A%3C%21%2D%2D%20Hosting24%20Analytics%20Code%20%2D%2D%3E%0D%0A%3Cscript%20type%3D%22text%2Fjavascript%22%20src%3D%22http%3A%2F%2Fstats%2Ehosting24%2Ecom%2Fcount%2Ephp%22%3E%3C%2Fscript%3E%0D%0A%3C%21%2D%2D%20End%20Of%20Analytics%20Code%20%2D%2D%3E%0D%0A 
```

我想将其转换为正确的字符串。有没有办法在 AS3 中做到这一点。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T15:05:50.567

用于`unescape()`解码字符串。

所以`unescape(data.toString())`应该给你输出：

```
systemResult=Invalid

<!-- Hosting24 Analytics Code -->

<script type="text/javascript" src="http://stats.hosting24.com/count.php"></script>

<!-- End Of Analytics Code --> 
```

# authentication - 将移动设备链接到用户帐户

> ID：15041808
> 
> 赞同：0
> 
> 时间：2013-02-23T14:53:02.200
> 
> 标签：authentication, mobile, smartphone

对于一项任务，我必须使 CMS 系统易于通过移动设备访问。理想情况下，我们希望以尽可能少的输入创建一种用户身份验证方式。

我用 php/javascript 创建了一个模仿 android 模式锁的系统，所以此时用户可以通过滑动模式登录。但问题仍然是他们仍然必须手动输入用户名。

是否有可能从智能手机获取某种唯一 ID，因此我们可以将其存储在数据库中并将其链接到帐户。这样如果用户想登录CMS，他只需要浏览网站，系统就会识别他是谁，他刷他的图案，用户就被认证了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T06:02:48.253

不幸的是，不可能从浏览器中获取唯一的设备 ID。

但是，您可以这样做：

![记住我](../Images/923fd160b43bdfdb20ae0ee83586ba52.png)

如果选中记住我，您可以在存储用户名的客户端浏览器上设置[cookie 。](http://en.wikipedia.org/wiki/HTTP_cookie)下次用户打开页面时，您检查是否设置了 cookie。如果是这样，您预先填写用户名。

这样，用户只需第一次输入用户名，它就会被预填充，直到他删除浏览器的 cookie 或 cookie 过期。

# bigdata - 在 GATE 源代码中添加自定义 jape 文件

> ID：15041809
> 
> 赞同：2
> 
> 时间：2013-02-23T14:53:09.580
> 
> 标签：bigdata, gate, named-entity-extraction

谁能指导我如何创建一个自定义**JAPE**文件并使用 GATE 源代码对其进行**配置。**我尝试使用以下代码并获得诸如**“解析语法时出错：”和“未设置语法 URL 或 binaryGrammarURL 参数！”之类的异常。**

```
 try{
             Document doc = new DocumentImpl();
              String str = "This is test.";
              DocumentContentImpl impl = new DocumentContentImpl(str);
              doc.setContent(impl);
          System.setProperty("gate.home", "C:\\Program Files\\GATE_Developer_7.1"); 
          Gate.init();
          gate.Corpus corpus = (Corpus) Factory
            .createResource("gate.corpora.CorpusImpl");
          File gateHome = Gate.getGateHome();
          File pluginsHome = new File(gateHome, "plugins");
          Gate.getCreoleRegister().registerDirectories(new File(pluginsHome, "ANNIE").toURI().toURL());  

          Transducer transducer = new Transducer();
             transducer.setDocument(doc);
transducer.setGrammarURL(new URL("file:///D:/misc_workspace/gate-7.1-build4485-SRC/plugins/ANNIE/resources/NE/SportsCategory.jape"));
transducer.setBinaryGrammarURL(new URL("file:///D:/misc_workspace/gate-7.1-build4485-SRC/plugins/ANNIE/resources/NE/SportsCategory.jape"));

LanguageAnalyser jape = (LanguageAnalyser)Factory.createResource(
                  "gate.creole.Transducer", gate.Utils.featureMap(
                          "grammarURL", "D:/misc_workspace/gate-7.1-build4485-SRC/plugins/ANNIE/resources/NE/SportsCategory.jape",
                          "encoding", "UTF-8")); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T18:10:23.153

您需要加载 ANNIE 插件

```
Gate.getCreoleRegister().registerDirectories(
  new File(Gate.getPluginsHome(), "ANNIE").toURI().toURL()); 
```

然后创建一个`gate.creole.Transducer`具有正确参数的实例

```
LanguageAnalyser jape = (LanguageAnalyser)Factory.createResource(
  "gate.creole.Transducer", gate.Utils.featureMap(
      "grammarURL", new URL("file:///D:/path/to/my-grammar.jape"),
      "encoding", "UTF-8")); // ensure this matches the file 
```

但是我们通常提倡的方法是在 GATE Developer 中按照您想要的方式组装和配置整个管道，使用您需要的任何标准组件以及您自己的语法，然后将应用程序状态保存到文件中。然后，您可以使用一行代码从代码中重新加载整个应用程序

```
CorpusController app = (CorpusController) PersistenceManager.loadObjectFromFile(savedAppFile); 
```

* * *

编辑：您添加到问题中的代码有几个基本问​​题。首先，您必须`Gate.init()`在使用 GATE 执行任何其他操作之前调用 - 它必须*在*您创建`Document`. 其次，您绝不能[直接](http://gate.ac.uk/userguide/sec%3aapi%3afactory)[调用类的构造函数`Resource`](http://gate.ac.uk/userguide/sec%3aapi%3afactory)- 始终使用`Factory`. 同样，您永远不需要`init()`直接调用，因为这是作为`Factory.createResource`. 例如：

```
// initialise GATE
Gate.setGateHome(new File("C:\\Program Files\\GATE_Developer_7.1"));
Gate.init();

// load ANNIE plugin - you must do this before you can create tokeniser
// or JAPE transducer resources.
Gate.getCreoleRegister().registerDirectories(
   new File(Gate.getPluginsHome(), "ANNIE").toURI().toURL());

// Build the pipeline
SerialAnalyserController pipeline =
  (SerialAnalyserController)Factory.createResource(
     "gate.creole.SerialAnalyserController");
LanguageAnalyser tokeniser = (LanguageAnalyser)Factory.createResource(
     "gate.creole.tokeniser.DefaultTokeniser");
LanguageAnalyser jape = (LanguageAnalyser)Factory.createResource(
  "gate.creole.Transducer", gate.Utils.featureMap(
      "grammarURL", new File("D:\\path\\to\\my-grammar.jape").toURI().toURL(),
      "encoding", "UTF-8")); // ensure this matches the file
pipeline.add(tokeniser);
pipeline.add(jape);

// create document and corpus
Corpus corpus = Factory.newCorpus(null);
Document doc = Factory.newDocument("This is test.");
corpus.add(doc);
pipeline.setCorpus(corpus);

// run it
pipeline.execute();

// extract results
System.out.println("Found annotations of the following types: " +
  doc.getAnnotations().getAllTypes()); 
```

如果您还没有，我强烈建议您完成至少模块 5 的[培训课程材料](http://gate.ac.uk/wiki/TrainingCourseJune2012/)，这将向您展示加载文档并在其上运行处理资源的正确方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T20:29:10.797

谢谢伊恩。这些培训课程材料很有帮助。但我的问题不同，我已经解决了。以下代码快照是如何**在 GATE 中使用自定义 jape 文件**。现在我的自定义 jape 文件能够**生成新的注释**。

```
 System.setProperty("gate.home", "C:\\Program Files\\GATE_Developer_7.1"); 
  Gate.init();

  ProcessingResource token = (ProcessingResource)   Factory.createResource("gate.creole.tokeniser.DefaultTokeniser",Factory.newFeatureMap());

 String str = "This is a test. Myself Abhijit Nag sport";
   Document doc = Factory.newDocument(str);

  gate.Corpus corpus = (Corpus) Factory.createResource("gate.corpora.CorpusImpl");
  corpus.add(doc);
  File gateHome = Gate.getGateHome();
  File pluginsHome = new File(gateHome, "plugins");

  Gate.getCreoleRegister().registerDirectories(new File(pluginsHome, "ANNIE").toURI().toURL());  

 LanguageAnalyser jape = (LanguageAnalyser)Factory.createResource(
              "gate.creole.Transducer", gate.Utils.featureMap(
                      "grammarURL", "file:///D:/misc_workspace/gate-7.1-build4485-SRC/plugins/ANNIE/resources/NE/SportsCategory.jape","encoding", "UTF-8"));
      jape.setCorpus(corpus);
      jape.setDocument(doc);
      jape.execute();

  pipeline = (SerialAnalyserController) Factory.createResource("gate.creole.SerialAnalyserController",
                Factory.newFeatureMap(), Factory.newFeatureMap(),"ANNIE");
              initAnnie();
              pipeline.setCorpus(corpus);
              pipeline.add(token);
              pipeline.add((ProcessingResource)jape.init());
              pipeline.execute();
      AnnotationSetImpl ann = (AnnotationSetImpl) doc.getAnnotations();
      System.out.println(" ...Total annotation "+ann.getAllTypes()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-15T14:56:13.520

如果您想更新 ANNIE 管道，这是另一种选择。

1.  首先获取管道中默认/现有处理资源的列表
2.  创建 JAPE 规则的实例
3.  迭代现有处理资源的列表，将每个处理资源添加到新集合中。将您自己的自定义 JAPE 规则添加到此集合中。
4.  当您执行 ANNIE 管道时，您的 JAPE 规则将自动被拾取，因此无需指定文档路径或单独执行。

示例代码：

```
File pluginsHome = Gate.getPluginsHome();
File anniePlugin = new File(pluginsHome, "ANNIE");
File annieGapp = new File(anniePlugin, "ANNIE_with_defaults.gapp");
annieController = (CorpusController) PersistenceManager.loadObjectFromFile(annieGapp);

LanguageAnalyser jape = (LanguageAnalyser)Factory.createResource(
                "gate.creole.Transducer", gate.Utils.featureMap(
                        "grammarURL", new URL("file:///C://Program Files//gate-7.1//plugins//ANNIE//resources//NE//opensource.jape"),
                        "encoding", "UTF-8")); 

Collection<ProcessingResource> newPRS = new ArrayList<ProcessingResource>();
Collection<ProcessingResource> prs = annieController.getPRs();
for(ProcessingResource resource: prs){
    newPRS.add(resource);
}
newPRS.add((ProcessingResource)jape.init());
annieController.setPRs(newPRS); 
```

# c++ - OpenGL - 使用文本文件绘制对象

> ID：15041813
> 
> 赞同：1
> 
> 时间：2013-02-23T14:53:34.940
> 
> 标签：c++, opengl

我从一个包含对象位置的文本文件中加载了一个数组，它看起来像这样：

```
0,0,0,5
0,5,0,0
0,0,5,0
0,5,5,0 
```

该对象如下所示：

```
struct object
{
    int x, y, value;
} 
```

其中 x,y 是坐标，值是 1 或 0（它告诉对象是否被“拾取”，所有对象的开头都为 1）。对象存储在数组中`object obj_array[5]`。

为了绘制它们，我使用这个函数：（BOARD_Y 和 BOARD_Y 是数组的大小，这里是 4x4）

```
void draw_board(){

    for (int iy = 0; iy < BOARD_Y; iy++) {      
        for (int ix = 0; ix < BOARD_X; ix++) {

            if ( (board[iy][ix] == 5) )
            {
                glPushMatrix();                 
                glTranslatef( ix, iy, 0 );
                glutSolidCube(1);
                glPopMatrix();  
            }
        }
    }
} 
```

它完美地绘制了所有这些。但是我想跳过绘制一个对象，如果它的值为 0（对象被玩家拾取）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:43:43.327

好的，我可以看到发生了什么；你把事情复杂了一点。除了非常愚蠢的位置比较之外，没有办法仅从这个循环访问任意对象：

```
if ( (board[iy][ix] == 5) ) {
    for (auto const& obj : objects) {
        if (obj.x == ix && obj.y == iy) {
            // obj is the object in given position
            // ...
            break;
        }
    }
} 
```

**不要那样**做。

相反，要么存储对板上对象的一些引用。通过引用我的意思是（不限于！）：

*   唯一的对象 ID
*   指向对象的指针

然后，您将能够更快、更轻松地访问驻留在给定图块上的对象。如果您需要示例，请发表评论，但我认为这两个选项都相当容易实现。

如果您仍想将这些“5”放在里面，请将板更改为结构数组。哦，*请*使用`std::array`而不是`int**`.

这是示例

```
using id_t = unsigned;

std::map<id_t, object> objects;

constexpr std::size_t size_x = 4, size_y = 4;
std::array<id_t, size_x * size_y> board; 
```

让我们假设`id`等于 0 意味着对象不存在。现在您可以通过以下方式访问特定对象：

```
unsigned x, y;

id_t obj_id = board[x + size_x * y];

if (obj_id != 0) // is there any object?
    if (objects[obj_id].value != 0) // is its value equal to 0?
        // ... 
```

并将其设置为`board[...] = obj;`

为每个对象生成唯一 ID 的简单方法就是增加计数器。

```
id_t last_id = 1;
objects[last_id++] = obj_id; 
```

# xml - 带有 minOccurs 和 maxOccurs 属性的 xml 架构验证错误

> ID：15041814
> 
> 赞同：0
> 
> 时间：2013-02-23T14:53:36.190
> 
> 标签：xml, xsd

我是 xml 模式的新手并正在做作业，但我遇到了问题。我正在使用 w3schools.com 的教程和位于[http://www.validome.org/grammar/validate/](http://www.validome.org/grammar/validate/)的验证器 下面是我的架构的开头，它不会验证：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
   <xs:element name="products">
     <xs:complexType>
       <xs:element name="product" minOccurs="1" maxOccurs="unbounded">
         <xs:complexType>
           <xs:sequence>
             <xs:element name="fname" type="xs:string"/>
             <xs:element name="manufacturer" type="xs:string"/>
           </xs:sequence>
         </xs:complexType>
       </xs:element>
    </xs:complexType>
   </xs:element>
 </xs:schema> 
```

Validator 说第 5 行存在许多问题： 1\. 它说 minOccurs 和 maxOccurs 属性是不允许的 2\. 发现以元素“xs:element”开头的无效内容。

据我所知，我正在关注 w3schools 教程。注意：如果我删除第 3 行和第 4 行及其相应的结束标记，以及 minOccurs 和 maxOccurs 属性，则文档将生效。

任何人都可以帮忙吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:55:00.480

xs:element 不能直接作为 xs:complexType 的子项出现；您需要插入一个 xs:sequence 元素。这是来自撒克逊的信息：

> xs：test.xsd 的第 4 行第 71 列上的元素出错：元素 xs：元素不能出现在此处：预期 {choice、sequence、assert、openContent、annotation、attributeGroup、anyAttribute、simpleContent、all、attribute、group、complexContent 之一} 或者什么都没有

# image-processing - 图像隐写术的 DCT 方法实现

> ID：15041817
> 
> 赞同：3
> 
> 时间：2013-02-23T14:53:51.203
> 
> 标签：image-processing, steganography, dct

我需要实现一个程序，使用 DCT 矩阵在图像中嵌入文本消息（PNG 或 BMP 无关紧要）来隐藏消息。我阅读了一些文章，但其中大多数都非常复杂。以下是基本步骤：

1.  将图像分成 8x8 块（像素强度矩阵）。
2.  对每个块进行离散余弦变换 (DCT)。所以我们得到 8x8 DCT 系数矩阵。
3.  以某种方式将消息插入 DCT 系数矩阵中最不重要的元素中。
4.  执行 IDCT 并获得内部带有秘密消息的正常图像表示。

我不明白我应该在第三步做什么？也许在 C# 或 Java 中存在这种技术的一些现有实现？

# java - 两个项目中的一类和序列化java

> ID：15041818
> 
> 赞同：2
> 
> 时间：2013-02-23T14:53:52.277
> 
> 标签：java, serialization

我有三个项目。第一个是 RMI 客户端，第二个是 RMI 服务器。我还有第三个项目，我有一些共同的课程。我从第三个项目制作了库并添加到其他项目（客户端和服务器）中。当我想将库（第三个项目）中的某个类 A 作为远程类的参数传递时，我遇到了问题。我的问题是我得到关于 serialVersionUID 的异常......问题出在哪里？我认为问题在于在客户端和服务器之间传递这个 A 类。

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T14:57:11.867

您是否在您的课程中设置了**serialVersionUID ？**

如果不是，序列化程序可能会认为您正在尝试反序列化同一类的不兼容版本。这是因为将生成 serialVersionUID，并且可能在不同平台上有所不同。

* * *

请参阅此 Fíndbugs 模式，了解为什么要定义一个： http: [//findbugs.sourceforge.net/bugDescriptions.html#SE_NO_SERIALVERSIONID](http://findbugs.sourceforge.net/bugDescriptions.html#SE_NO_SERIALVERSIONID)

也看看这个问题[什么是serialVersionUID，我为什么要使用它？](https://stackoverflow.com/questions/285793/what-is-a-serialversionuid-and-why-should-i-use-it)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:02:51.683

似乎您在第一个和第二个项目中为一个类使用了不同的实现。既然你说类 A 在共享库中，现在你应该检查该类中使用的字段，并确保与它们相关的所有类都是共享的（如果你从它们的子类传递实例，你应该检查这些子类也是）。

# javascript - 在不同域的 iframe 中注入脚本

> ID：15041820
> 
> 赞同：5
> 
> 时间：2013-02-23T14:54:07.180
> 
> 标签：javascript, html, iframe, inject

我试图在 iframe 元素中注入脚本试图以这种方式实现，子元素和父元素不属于同一个域（我知道 XSS 在最新的浏览器中被阻止）有没有办法将脚本注入到按钮单击父元素的子元素元素。（在 chrome 控制台中运行脚本有点相似）

```
var myIframe = document.getElementById("myIframeId");
var script = myIframe.contentWindow.document.createElement("script");
script.type = "text/javascript";
script.src = "randomshit.js";
myIframe.contentWindow.document.body.appendChild(script); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T15:07:37.317

没有。[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)可以追溯到 Netscape 2.0。

除非您可以破解/XSS 其他站点的文件以注入 JS，否则您将很难过。

现在，如果您合法地需要与其他页面通信，并且您可以控制其他页面或可以设置它与您的服务器进行通信，您可以使用[`window.postMessage`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)JSONP[甚至](https://stackoverflow.com/q/2067472/1331430)Ajax 与 CORS（后 2 将更难通过动态虽然内容）。但我相信事实并非如此。

# r - R中数据帧的条件总和

> ID：15041825
> 
> 赞同：3
> 
> 时间：2013-02-23T14:54:45.660
> 
> 标签：r, dataframe

我想组合数据帧并根据其中一个数据帧的值有条件地计算它们的总和。

对于下面的示例，如果一个单元格`df4`不是 0 并且不是 NA，则总和应该是，`df3 + df4`否则总和应该是`df1 + df2 + df3`。

```
> df1
  1 2 3
A 0 3 2
B 1 1 0
C 5 0 2

> df2
  1 2 3
A 3 2 2
B 4 3 4
C 1 0 3

> df3
  1 2 3
A 1 3 4
B 3 4 3
C 1 2 3 
```

条件取决于此框架：

```
> df4
   1  2  3
A  6  0  0
B  0  0 NA 
C NA  4  0 
```

对于上述示例，这是预期的结果：

```
> dfsum
  1 2 3
A 7 8 8
B 8 8 7
C 7 6 8 
```

我如何在 R 中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T15:11:44.047

```
m1 <- matrix(c(0,1,5,3,1,0,2,0,2),3)
m2 <- matrix(c(3,4,1,2,3,0,2,4,3),3)
m3 <- matrix(c(1,3,1,3,4,2,4,3,3),3)
m4 <- matrix(c(6,0,NA,0,0,4,0,NA,0),3)

msum <- m3 + m4
temp <- m1 + m2 + m3
cond <- is.na(m4) | m4==0

msum[cond] <- temp[cond]

#     [,1] [,2] [,3]
#[1,]    7    8    8
#[2,]    8    8    7
#[3,]    7    6    8 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-23T15:15:48.753

使用@Roland 的定义：

```
ifelse(is.na(m4) | m4==0, m1+m2+m3, m3+m4)
##      [,1] [,2] [,3]
## [1,]    7    8    8
## [2,]    8    8    7
## [3,]    7    6    8 
```

# wicket - 将 Spring Social 与 Wicket 一起使用

> ID：15041830
> 
> 赞同：0
> 
> 时间：2013-02-23T14:55:13.647
> 
> 标签：wicket, spring-social

我正在尝试在我的 wicket 应用程序中实现 Facebook 登录。我正在经历 Spring 社交，在继续之前想知道，它是否可以使用 Wicket 轻松实现，因为它类似于某种 Spring MVC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:10:04.293

将 Spring MVC 构建的东西与 Wicket 集成可能并不容易，因为它们是完全不同的架构。

[Wicket Facebook 项目](https://github.com/wicketstuff/core/wiki/Facebook)看起来像是你需要的一个良好的开端，虽然我不能真正保证它，因为我从未尝试过这个。

# java - 使用 Java 1.7 处理套接字的最新技术是什么？

> ID：15041832
> 
> 赞同：14
> 
> 时间：2013-02-23T14:55:21.867
> 
> 标签：java, sockets, try-with-resources

我正在寻找使用 Java 1.7 ( *try-with-resources* ) 的适当特性来实现客户端/服务器套接字通信的最佳模式。必须确保所有线程和资源都完全关闭和释放。[应考虑有效的 Java](https://rads.stackoverflow.com/amzn/click/com/0321356683) / [Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)项以及简单的可调试性（每行中只有一个语句）。

任何反馈或讨论将不胜感激。

# 第一种方法

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.UnknownHostException;

import org.junit.Test;

public final class ThreadedServerTest1 {
    private static final class ThreadedServer implements Runnable {
        private final Socket socket;

        ThreadedServer(final Socket socket) {
            this.socket = socket;
        }

        public static void main(final String arguments[]) {
            final int port = arguments.length > 0 ? Integer.parseInt(arguments[0]) : 9999;
            try (final ServerSocket serverSocket = new ServerSocket(port)) {
                while (true) {
                    final Socket socket = serverSocket.accept();
                    final ThreadedServer server = new ThreadedServer(socket);
                    final Thread thread = new Thread(server);
                    thread.start();
                }
            } catch (final IOException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void run() {
            // @formatter:off
            try (
                // See http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7027552 and
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7013420:
                final Socket socket = this.socket;
                final InputStream inputStream = socket.getInputStream();
                final InputStreamReader inputStreamReader = new InputStreamReader(inputStream);
                final BufferedReader bufferedReader = new BufferedReader(inputStreamReader);
                final OutputStream outputStream = socket.getOutputStream();
                final OutputStreamWriter outputStreamWriter = new OutputStreamWriter(outputStream);
                final PrintWriter printWriter = new PrintWriter(outputStreamWriter);
            ) {
                // @formatter:on
                final String request = bufferedReader.readLine();
                System.out.println(String.format("Received from client: %s", request));
                printWriter.println("Hello client!");
                printWriter.flush();
            } catch (final Exception e) {
                e.printStackTrace();
            }
        }
    }

    private static final class Client {
        public static void main(final String arguments[]) {
            final int port = arguments.length > 0 ? Integer.parseInt(arguments[0]) : 9999;
            try {
                final InetAddress loopbackAddress = InetAddress.getByName(null);
                // @formatter:off
                try (
                    final Socket socket = new Socket(loopbackAddress, port);
                    final OutputStream outputStream = socket.getOutputStream();
                    final OutputStreamWriter outputStreamWriter = new OutputStreamWriter(outputStream);
                    final PrintWriter printWriter = new PrintWriter(outputStreamWriter);
                    final InputStream inputStream = socket.getInputStream();
                    final InputStreamReader inputStreamReader = new InputStreamReader(inputStream);
                    final BufferedReader bufferedReader = new BufferedReader(inputStreamReader)
                ) {
                    // @formatter:on
                    printWriter.println("Hello server!");
                    printWriter.flush();
                    final String answer = bufferedReader.readLine();
                    System.out.println(String.format("Answer from server: %s", answer));
                } catch (final IOException e) {
                    e.printStackTrace();
                }
            } catch (final UnknownHostException e) {
                e.printStackTrace();
            }
        }
    }

    @Test
    public void test() {
        final String[] arguments = new String[] { "9999" };
        final Thread tread = new Thread() {
            @Override
            public void run() {
                ThreadedServer.main(arguments);
            };
        };
        tread.start();
        Client.main(arguments);
    }
} 
```

优点：

*   更少的代码行

缺点：

*   大型 try-with-resources 块（Eclipse 格式化程序不支持）
*   `Socke`使用 try-with-resources 所需的第二个t 实例
*   由于`UnknownHostException`from的深层嵌套`InetAddress#getByName(null)`

# 第二种方法

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;

import org.junit.Test;

public final class ThreadedServerTest2 {
    private static final class Connection implements AutoCloseable {
        final Socket socket;
        final InputStream inputStream;
        final InputStreamReader inputStreamReader;
        final BufferedReader bufferedReader;
        final OutputStream outputStream;
        final OutputStreamWriter outputStreamWriter;
        final PrintWriter printWriter;

        private Connection(final Socket socket) throws IOException {
            this.socket = socket;
            inputStream = socket.getInputStream();
            inputStreamReader = new InputStreamReader(inputStream);
            bufferedReader = new BufferedReader(inputStreamReader);
            outputStream = socket.getOutputStream();
            outputStreamWriter = new OutputStreamWriter(outputStream);
            printWriter = new PrintWriter(outputStreamWriter);
        }

        static Connection serverConnection(final Socket socket) throws IOException {
            return new Connection(socket);
        }

        static Connection clientConnection(final String hostname, final int port) throws IOException {
            final InetAddress inetAddress = InetAddress.getByName(hostname);
            final Socket socket = new Socket(inetAddress, port);
            return new Connection(socket);
        }

        static Connection localhostCientConnection(final int port) throws IOException {
            return clientConnection(null, port);
        }

        @Override
        public void close() {
            closeAndIgnoreException(printWriter, outputStreamWriter, outputStream, bufferedReader, inputStreamReader, inputStream, socket);
        }

        private void closeAndIgnoreException(final AutoCloseable... closeables) {
            for (final AutoCloseable closeable : closeables) {
                try {
                    closeable.close();
                } catch (final Exception ignore) {
                }
            }
        }
    }

    private static final class ThreadedServer implements Runnable {
        private final Socket socket;

        private ThreadedServer(final Socket socket) {
            this.socket = socket;
        }

        public static void main(final String arguments[]) {
            final int port = arguments.length > 0 ? Integer.parseInt(arguments[0]) : 9999;
            try (final ServerSocket serverSocket = new ServerSocket(port)) {
                while (true) {
                    final Socket socket = serverSocket.accept();
                    final ThreadedServer server = new ThreadedServer(socket);
                    final Thread thread = new Thread(server);
                    thread.start();
                }
            } catch (final IOException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void run() {
            try (Connection connection = Connection.serverConnection(socket)) {
                final String request = connection.bufferedReader.readLine();
                System.out.println(String.format("Received from client: %s", request));
                connection.printWriter.println("Hello client!");
                connection.printWriter.flush();
            } catch (final Exception e) {
                e.printStackTrace();
            }
        }
    }

    private static final class Client {
        public static void main(final String arguments[]) {
            final int port = arguments.length > 0 ? Integer.parseInt(arguments[0]) : 9999;
            try (Connection connection = Connection.localhostCientConnection(port)) {
                connection.printWriter.println("Hello server!");
                connection.printWriter.flush();
                final String answer = connection.bufferedReader.readLine();
                System.out.println(String.format("Answer from server: %s", answer));
            } catch (final IOException e) {
                e.printStackTrace();
            }
        }
    }

    @Test
    public void test() {
        final String[] arguments = new String[] { "9999" };
        final Thread tread = new Thread() {
            @Override
            public void run() {
                ThreadedServer.main(arguments);
            };
        };
        tread.start();
        Client.main(arguments);
    }
} 
```

优点：

*   干净且可读的 try-with-resources 块
*   支持 Eclipse 格式化程序

缺点：

*   更多代码行
*   需要自己的`Connection`班级
*   可能会忘记关闭类`AutoCloseable`中的实例`Connection`（容易出错）

您对利弊有反馈或补充吗？还有更多的弱点吗？

# 第三种方法

这是下面讨论的结果：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;

import org.junit.Test;

public final class ThreadedServerTest3 {
    private static final class ThreadedServer implements Runnable {
        private final Socket socket;

        private ThreadedServer(final Socket socket) {
            this.socket = socket;
        }

        public static void main(final String arguments[]) {
            final int port = arguments.length > 0 ? Integer.parseInt(arguments[0]) : 9999;
            try (final ServerSocket serverSocket = new ServerSocket(port)) {
                while (true) {
                    final Socket socket = serverSocket.accept();
                    final ThreadedServer server = new ThreadedServer(socket);
                    final Thread thread = new Thread(server);
                    thread.start();
                }
            } catch (final IOException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void run() {
            // @formatter:off
            try (
                // See http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7027552 and
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=7013420:
                Socket socket = this.socket;
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
                PrintWriter printWriter = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()));
            ) {
                // @formatter:on
                final String request = bufferedReader.readLine();
                System.out.println(String.format("Received from client: %s", request));
                printWriter.println("Hello client!");
                printWriter.flush();
            } catch (final Exception e) {
                e.printStackTrace();
            }
        }
    }

    private static final class Client {
        public static void main(final String arguments[]) {
            final int port = arguments.length > 0 ? Integer.parseInt(arguments[0]) : 9999;
            // @formatter:off
            try (
                Socket socket = new Socket(InetAddress.getByName(null), port);
                PrintWriter printWriter = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()));
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(socket.getInputStream()))
            ) {
                // @formatter:on
                printWriter.println("Hello server!");
                printWriter.flush();
                final String answer = bufferedReader.readLine();
                System.out.println(String.format("Answer from server: %s", answer));
            } catch (final IOException e) {
                e.printStackTrace();
            }
        }
    }

    @Test
    public void test() {
        final String[] arguments = new String[] { "9999" };
        final Thread tread = new Thread() {
            @Override
            public void run() {
                ThreadedServer.main(arguments);
            };
        };
        tread.start();
        Client.main(arguments);
    }
} 
```

优点：

*   更少的代码行
*   拒绝复杂且最易读的 try-with-resources 块
*   没有异常

缺点：

*   Eclipse 格式化程序不支持
*   一些违反规则“每行只有一个语句”（简单可调试性）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T15:29:04.777

*   正如规范[所写](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.20.3)，final 修饰符在 try-with-resources 中是多余的：

    > 如果在 ResourceSpecification 中声明的资源未显式声明为 final，则它被隐式声明为 final（第 4.12.4 节）。

*   关闭阅读器也将关闭底层流，与关闭编写器相同。因此没有必要将中间流声明为资源。
*   您的第二种方法错误地忽略了关闭资源时引发的异常。关闭流会刷新它，如果没有成功，则不会发送所有数据，这显然需要引发异常。相反，try-with-resources 语句确实会传播关闭时抛出的异常（可能是被抑制的异常，详见规范[）](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.20.3.1)。

因此，我建议：

```
try (
    Socket socket = this.socket;
    BufferedReader reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
    PrintWriter writer = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()))
) { 
```

# python - 以 Python 方式将多个值插入到列表中

> ID：15041834
> 
> 赞同：4
> 
> 时间：2013-02-23T14:55:33.477
> 
> 标签：python, list, insert, idioms

我想打开这个列表：

```
l=["Three","Four","Five","Six"] 
```

进入这个：

```
['Three', 3, 'Four', 4, 'Five', 5, 'Six', 6] 
```

我用这段代码（效果很好）来做到这一点：

```
for i,j in zip(range(1,len(l)*2,2),range(3,7)*2):
    l.insert(i,j) 
```

但我猜 Python 不会以此为荣。有没有更短的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T14:59:28.803

我可能会做这样的事情：

```
>>> a = ["Three","Four","Five","Six"]
>>> b = range(3,7)
>>> zip(a,b)
[('Three', 3), ('Four', 4), ('Five', 5), ('Six', 6)]
>>> [term for pair in zip(a,b) for term in pair]
['Three', 3, 'Four', 4, 'Five', 5, 'Six', 6] 
```

或者，使用`itertools.chain`：

```
>>> from itertools import chain
>>> list(chain.from_iterable(zip(a,b)))
['Three', 3, 'Four', 4, 'Five', 5, 'Six', 6] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-23T15:02:11.767

```
In [124]: l=["Three","Four","Five","Six"]

In [125]: [x for x in itertools.chain(*zip(l, range(3,7)))]
Out[125]: ['Three', 3, 'Four', 4, 'Five', 5, 'Six', 6] 
```

# html - 只有主页正确呈现？

> ID：15041839
> 
> 赞同：2
> 
> 时间：2013-02-23T14:55:45.440
> 
> 标签：html, css

我在一个 MVC 项目上工作了 6 个多月，一直以来我都遇到了与 html css 相同的问题：主页正确呈现。示例： http: [//prntscr.com/tucp1](http://prntscr.com/tucp1)

所有其他页面的单词之间都有一些空白。示例：[http](http://prntscr.com/tucui) ://prntscr.com/tucui HTML 的一部分：

```
<div class="search right">
    <div class="nav">
        <ul>
            <li><a>Nav1</a></li>
            <li><a>Nav2</a></li>
            <li><a>Nav3</a></li>
        </ul>
    </div> 
```

我的CSS的一部分：

```
.nav ul li {
line-height: 27px;
display: inline;
float: left;
list-style-type: none;

.nav ul li a {
color: #424242;
padding: 0 10px;
font-weight: bold;
} 
```

昨天我发现我没有漂浮在 li 上。我正在内页上进行测试，所以我很容易发现问题......有谁知道如何才能正确呈现 hompepage，一些解释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:17:09.960

内联列表项依赖于空格（就像 inline-block 元素一样） - 这意味着您的标记需要像这样：

```
<div class="search right">
<div class="nav">
    <ul>
        <li><a>Nav1</a></li><li><a>Nav2</a></li><li><a>Nav3</a></li>
    </ul>
</div> 
```

摆脱它们之间的空间。

阅读此答案以获取更多信息：[管理内联列表项之间空格的最佳方法](https://stackoverflow.com/questions/241512/best-way-to-manage-whitespace-between-inline-list-items)

# c# - 静态媒体元素

> ID：15041840
> 
> 赞同：2
> 
> 时间：2013-02-23T14:55:49.830
> 
> 标签：c#, wpf, binding, static, mediaelement

我有两个窗口（win1 和 win2）。在 win1.xaml 中，我有 mediaelement，我尝试从 win2 C# 源代码调用它，这迫使我拥有一个静态的 mediaelement。

所以我使用绑定来填充源，但是将方法调用为 mediaelement.play() 我该怎么做，因为 mediaelement 在 xaml 中声明并且不是静态的？

谢谢你的帮助。

win1.xml

 ````
<Grid x:Name="LayoutRoot" Width="630" Height="460" VerticalAlignment="Top" HorizontalAlignment="Left">
<Grid.ColumnDefinitions>
    <ColumnDefinition Width="626"></ColumnDefinition>
    <ColumnDefinition Width="24*"></ColumnDefinition>
</Grid.ColumnDefinitions>

    <StackPanel Height="440" Width="620" HorizontalAlignment="Right"  VerticalAlignment="Bottom" Margin="0,0,2,-12">
        <StackPanel Height="350" Width="587" Background="White" Margin="0,10,0,0">
            <!-- MediaElement -->
            <MediaElement Margin="10,11,10,0" Name="MediaElement1" Source="{Binding MediaElement1Source, Source={x:Static bindableSettings:BindingManager.Instance}}"
             Width="565" Height="330" LoadedBehavior="Manual" UnloadedBehavior="Close" Stretch="Fill" />
        </StackPanel>
    </StackPanel>

</Grid> 
```` 

win1.xaml.cs MediaElement init 和其他一些东西

win2.xaml 只是一个按钮调用函数

win2.xaml.cs `namespace MyApp { public partial class win2 : Window { public win2() { InitializeComponent(); }`

 ````
 public static void MediaElement1_Play()
    {
        MessageBox.Show("MediaElement1_Play Called");
        win1.MediaElement1.Play();
        MessageBox.Show("MediaElement1_Play Exited");

        // Other statics stuff
    }
} 
```` 

`}`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-07-23T15:23:48.567

我也尝试使用静态媒体元素（在后面的代码中将其定义为静态类成员）。它编译好，但没有声音会播放。我不确定为什么——也许你们中的一些专家会理解？我放弃了静态想法，转而将其包含在每个窗口的代码中。（不理想，因为我有一个代码块来操作它——在我的情况下播放通知声音——我现在在每个窗口中都复制了该代码。）如果有人有更好的解决方案，我很想听听。

# post - Qtranslate get_page_by_path

> ID：15041841
> 
> 赞同：0
> 
> 时间：2013-02-23T14:55:49.807
> 
> 标签：post, get, qtranslate

我有这段代码可以得到与我的“项目描述”同名的帖子。我需要使用 qtranslate 动态翻译我的帖子，但它只能获取整个帖子内容......所以简而言之，我可以同时看到英语和其他语言。谁有好的解决方案？

```
<?php $content_post = get_page_by_path( $item->item_description, OBJECT, 'post' );
if($content_post)
{
$content = $content_post->post_content;
echo $content;
}?> 
```

我不熟悉 php，所以请尽量“清楚”你的答案。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T17:17:54.800

我找到了这个解决方案，它可以工作，但我不确定它是否是一个相当好的代码：

```
if($content_post)
{
if(qtrans_getLanguage() == "it"){
$content = qtrans_use('it', $content_post->post_content,false); 
echo $content;
}else{
$content = qtrans_use('en', $content_post->post_content,false); 
echo $content;
}
}?> 
```

# c - 内联装配控制台打印

> ID：15041842
> 
> 赞同：0
> 
> 时间：2013-02-23T14:55:54.817
> 
> 标签：c, assembly

所以，我想制作一个简单的程序来在控制台上打印一个字符串，为此，我创建了一个带有内联汇编的简单函数，我的想法是，在不使用 windows lib 或 C/C++ 函数的情况下对字符串进行标记，像 printf 或 cout .... 所以，我知道 VC++ 的宏汇编编译器使用 masm sintax ...所以，我做了这个：

```
void print(char *msg)
{
    __asm
    {
        mov ah, 9
        mov dx, msg
        int 21h
    }
}

int main()
{
    print("hello");
    return 0;
} 
```

但是，我认为使用旧的 DOS 中断不能正常工作:(所以，有办法做到这一点，不使用 printf 或 cout 或 c/c++ 函数，只使用 C 和汇编？？？

# c# - 使用对象而不是索引选择行

> ID：15041844
> 
> 赞同：1
> 
> 时间：2013-02-23T14:55:59.577
> 
> 标签：c#, winforms, datagridview

我`DataGridView`在 C# 表单应用程序中有一个表 ()。对象列表就是`binded`它。我可以从选定的行中获取绑定对象。

但我也想通过只有列表中的对象以编程方式在表中选择行。我该怎么做？

我不想按`Index`（整数值）选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T08:13:21.450

如果`BindingSource = BindList<CPatient>`你可以使用这个

```
public class CPatient
{
    public int Id { get; set; }
    public string IdNo { get; set; }
    public string Name { get; set; }
} 
```

*加载事件*

```
//Global Variable
BindingList<CPatient> bind = new BindingList<CPatient>();
BindingSource bs = new BindingSource();

private void Form1_Load(object sender, EventArgs e)
{

    bind.Add(new CPatient { Id = 1, IdNo = "1235", Name = "test" });
    bind.Add(new CPatient { Id = 2, IdNo = "6789", Name = "let" });
    bind.Add(new CPatient { Id = 3, IdNo = "1123", Name = "go" });
    bind.Add(new CPatient { Id = 4, IdNo = "4444", Name = "why" });
    bind.Add(new CPatient { Id = 5, IdNo = "5555", Name = "not" });
    bs.DataSource = bind;
    dataGridView1.DataSource = bs;
} 
```

*点击事件*

```
 private void button1_Click_1(object sender, EventArgs e)
 {
     bs.Position = bs.List.Cast<CPatient>().ToList().FindIndex(c => c.Id == 5);
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:04:18.697

我会尝试这样的事情：

```
var row = dataGrid.Rows
                  .Cast<DataGridViewRow>()
                  .FirstOrDefault(r => (CPatient)r.DataBoundItem = myItem);

var rowIndex = row != null ? row.Index : -1; 
```

如果网格不包含使用该对象绑定的行，它应该返回行索引或 -1。

如果用户能够在运行时重新排序 dataGrid，您可以使用`row.DisplayIndex`而不是。`row.Index`那是因为`DataGridViewBand.Index`有以下注释：

> 此属性的值不一定与集合中波段的当前视觉位置相对应。例如，如果用户`DataGridView`在运行时对 a 中的列重新排序（假设`AllowUserToOrderColumns`属性设置为 true），则`Index`每列的属性值不会改变。相反，列`DisplayIndex`值会发生变化。然而，对行进行排序确实会改变它们的`Index`值。

# algorithm - 来自有序列表位置的金字塔层位置

> ID：15041846
> 
> 赞同：2
> 
> 时间：2013-02-23T14:56:08.440
> 
> 标签：algorithm

一开始这似乎是一个简单的问题，但现在我不太确定。

我有一个球员名单，按他们的排名排序。

```
1, 2, 3, 4, 5, 6, 7, 8, 9, 10 
```

我必须将这个列表显示为一个金字塔，其中每一层可以拥有的玩家数量增加一个。所以，排名第一的玩家在金字塔的顶端，第二和第三在第二层，以此类推……

```
 1 
    2 , 3
  4 , 5 , 6
7 , 8 , 9 , 10 
```

我想知道是否有可能从排名位置（RP）得到金字塔层数（LN）。例如：

```
1 RP = 1 LN
3 RP = 2 LN
5 RP = 3 LN
8 RP = 4 LN 
```

试图创建一个公式来获得这个值，但现在很明显我的数学需要加强。所以……我来了。

X RP = Y LN？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T16:56:46.433

让我处于L级。

那么之前的 (L-1) 个级别有 L(L-1)/2 个数字。换句话说，由于 x 层有 x 个数，我们知道

x(x-1)/2 < i ≤ x(x-1)/2 + x

或等效地

x^2 - x - 2i < 0

和

x^2 + x - 2i ≥ 0

上述两个方程的判别式为 D = 1 + 8i。显然，水平 L 必须低于第一个二次方的正根；那是

L < (1+√(1+8i))/2

并且至少是第二个二次方的正根，即

L≥(-1+√(1+8i))/2

所以，我们所要做的就是拿下最后一个的天花板。

在 C 语言中，这个值，作为一个整数，是

(int) ceil((-1.0 + sqrt(1.0 + 8.0 * i)) / 2.0)

好问题！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:42:59.403

`LN(RP=x) = ceil((sqrt(1+8x)-1)/2)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T16:04:45.790

您需要创建两个循环，外循环用于每个级别，内循环用于级别中的位数。

```
int pyramidCount(int val){
    if (val == 0)
        return 0;
    int count =0; 
    for (int i=1;i <=val;i++){
        for(int j=0;j <i; j++ ){
            count ++;
            if(count == val) return i;
        }
    }
    return 0;
} 
```

# javascript - 好的编程，我应该重用值吗？

> ID：15041848
> 
> 赞同：0
> 
> 时间：2013-02-23T14:56:16.580
> 
> 标签：javascript

在过去的 6 个月里，我一直在练习 JavaScript，目前正在尝试改进我的编码方式。

我想知道的是..我是否应该为变量分配一个我将继续使用的值，即使它与我想要完成的事情无关？

在这个例子中，我一直重复使用 init_value，因为它等于 3。

```
 function roll_dice(){
         return Math.floor(Math.random() * init_value);
        }

       var source = ["hello.jpg","hello2.jpg","hello3.jpg", "hello4.jpg"];
       var init_value = 3;

       if( (source.length - 1) === init_value ){
         var roll = roll_dice();
         alert(roll);
       }

       for(i = init_value; i >= 0; i--){
        alert(source[i]);
       } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:00:55.310

不要那样做。给你的变量起有意义的名字，并将它们用于它们的设计。没有任何理由考虑重用变量，除非您在有限的硬件（例如嵌入式系统）上进行开发。

一个示例（只是一些与您的代码具有相同精神的模拟代码）：

```
 var max_users = 10;
 var max_connections = 10;

 if (connections == max_connections) {
      alert("No more connections allowed!");
 }

 if (users == max_users) {
      alert("Maximum number of users reached.");
 } 
```

即使数字相同，我也不会重复使用相同的变量。在这种情况下，我也不会创建像`i`or这样的变量`max_connections_or_users`，除非那是我想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:11:27.257

让我们看看如果您选择变量只是为了它们的值会是什么样子：

```
 var superman = 1,
    marypoppins = 0,
    mario = 3;

    function roll_dice(){
     return Math.floor(Math.random() * superman * mario );
    }

   var source = ["hello.jpg","hello2.jpg","hello3.jpg", "hello4.jpg"];
   var init_value = mario + superman * marypoppins;

   if( (source.length - superman) === mario + marypoppins ){
     var roll = roll_dice();
     alert(roll);
   }

   for(i = init_value; i >= marypoppins * mario; i--){
    alert(source[i]);
   } 
```

仍然认为重用变量很酷吗？

# django - 在 Heroku 上运行 loaddata 而不将数据文件添加到存储库

> ID：15041853
> 
> 赞同：7
> 
> 时间：2013-02-23T14:56:38.453
> 
> 标签：django, heroku

我需要运行一个 manage.py loaddata 命令将一些数据导入我的 heroku 实例的数据库中，而 heroku 的 ethereal 文件系统在这方面存在一些问题。我真的不希望将数据文件添加到我的heroku存储库并在每次我想运行loaddata时推送更新（因为我需要定期为不同的heroku实例运行不同的文件相同的代码库。）有没有办法a）在远程实例上运行 loaddata 而无需将数据文件驻留在实例的文件系统上，可能是通过管道传输数据或引用本地文件，或者 b) 上传文件并在同一会话中运行 loaddata，以便在执行命令时文件可以存在于实例上？（我意识到它会在交互式会话结束后立即消失）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2018-03-07T13:20:25.440

**（……几年后）**

@Ben Roberts 的方法是明智的，但请注意，几年后，所有障碍都已修复：

*   [Django 加载数据现在接受来自标准输入的输入，使用`-`](https://code.djangoproject.com/ticket/27978)
*   Heroku 运行命令管道已修复（[Ben 链接的问题现已关闭](https://github.com/heroku/legacy-cli/issues/256)）

因此，您不需要自定义管理命令。从本地文件加载数据到 Heroku 现在应该很简单：

```
$ cat your-data-file.json | heroku run --no-tty -a <your-app> -- python manage.py loaddata --format=json - 
```

奖励：对于相等和相反的动作，您可以使用[此处](https://stackoverflow.com/questions/39457549/heroku-django-dumpdata)的答案转储数据。

[编辑：`--no-tty`感谢@rgov添加选项]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-26T03:20:09.480

这是 a 想出的（使用我的（a）想法和来自标准输入的管道），但由于 heroku 运行的这个问题它不起作用：[https ://github.com/heroku/heroku/issues/256](https://github.com/heroku/heroku/issues/256)

用于包装 loaddata 以使其使用标准输入的管理命令（如果您设置了 django eviron，则可以将其编写为 python 脚本）：

```
# someapp/management/commands/loaddata_stdin.py

import os
import sys
from django.core.management import BaseCommand, call_command

class Command(BaseCommand):

    def transfer_stdin_to_tempfile(self):
        content = sys.stdin.read() # could use readlines if content is expected to be huge
        outfile = open ('temp.json', 'w')
        outfile.write(content)
        outfile.close()
        return outfile.name

    def handle(self, *args, **options):
        tempfile_name = self.transfer_stdin_to_tempfile()
        call_command('loaddata', tempfile_name, traceback=True )
        os.remove(tempfile_name) 
```

用法：

```
$ cat some_dump.json | heroku run python manage.py loaddata_stdin.py 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-06T22:54:32.230

Heroku 的[PG Backups 插件](https://devcenter.heroku.com/articles/pgbackups)可以帮助您解决这个问题（也许去年这个时候还不存在）：[https ://devcenter.heroku.com/articles/heroku-postgres-import-export](https://devcenter.heroku.com/articles/heroku-postgres-import-export)

本教程以相当简单的术语描述了如何使用`pg_dump`创建 sql 转储（在此处添加命令以防链接更改）：

```
$ pg_dump -Fc --no-acl --no-owner -h localhost -U <your username> mydb > mydb.dump 
```

我亲自上传`mydb.dump`到 Dropbox 文件夹，然后运行 ​​pgbackups 命令：

```
$ heroku pgbackups:restore <database url> '<url for mydb.dump>' 
```

我尝试了您的方法并且它有效，但是随着文件大小变大遇到了一些问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-13T17:01:49.010

或者您可以`loaddata`访问本地数据库，然后：

```
heroku pg:push mylocaldb HEROKU_POSTGRESQL_MAGENTA --app sushi 
```

文档：[https ://devcenter.heroku.com/articles/heroku-postgresql#pg-push](https://devcenter.heroku.com/articles/heroku-postgresql#pg-push)

# c# - 发布创建的文件

> ID：15041854
> 
> 赞同：1
> 
> 时间：2013-02-23T14:56:51.073
> 
> 标签：c#, windows-8, windows-runtime

我有以下代码将 Base64 字符串转换为 PDF 文件，保存它然后尝试打开它：

```
//Converts the Base64 data to bytes
byte[] bytes = Convert.FromBase64String(Base64String);

//Stores the converted Base64 data in the application's Local Resource directory, in PDF format
StorageFolder folder = ApplicationData.Current.LocalFolder;
string fileName = file.pdf";
CreationCollisionOption options = CreationCollisionOption.FailIfExists;

var file = await folder.CreateFileAsync(fileName, options);
var fs = await file.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite);
var outStream = fs.GetOutputStreamAt(0);
var dataWriter = new Windows.Storage.Streams.DataWriter(outStream);
dataWriter.WriteBytes(bytes);
await dataWriter.StoreAsync();
dataWriter.DetachStream();
await outStream.FlushAsync();

string pdfPath = folder.Path + "\\" + fileName;

StorageFile fileToLaunch = await StorageFile.GetFileFromPathAsync(pdfPath);
await Windows.System.Launcher.LaunchFileAsync(fileToLaunch); 
```

当文件在 Adob​​e Reader 中打开时，会显示一条消息，指出该文件仍在被其他应用程序使用。如何让我的应用程序“发布”文件，以便 Adob​​e 可以打开它？请注意，这是一个 Windows 8 应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:08:32.423

我怀疑这是问题所在：

```
var outStream = fs.GetOutputStreamAt(0); 
```

`IOutputStream`extends `IDisposable`，但你没有处理流。尝试将代码的该部分更改为：

```
using (var outStream = fs.GetOutputStreamAt(0))
{
    var dataWriter = new Windows.Storage.Streams.DataWriter(outStream);
    dataWriter.WriteBytes(bytes);
    await dataWriter.StoreAsync();
    dataWriter.DetachStream();
    await outStream.FlushAsync();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:27:25.557

我不得不将代码更改为以下内容：

```
 var file = await folder.CreateFileAsync(fileName, options);

        using (var fs = await file.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite))
        {
            using (var outStream = fs.GetOutputStreamAt(0))
            {
                using (var dataWriter = new Windows.Storage.Streams.DataWriter(outStream))
                {
                    dataWriter.WriteBytes(bytes);
                    await dataWriter.StoreAsync();
                    dataWriter.DetachStream();
                    await outStream.FlushAsync();
                }
            }
        } 
```

# c# - PowerShell在读取文件时保持文本格式

> ID：15041857
> 
> 赞同：16
> 
> 时间：2013-02-23T14:57:09.700
> 
> 标签：c#, powershell, pastebin

我相信这是一个简单的问题，但我无法理解它。我想在 Windows 上的命令外壳中执行诊断命令。像这样：

```
 $cmd =  "ipconfig >> c:\test.txt"

   $message = Invoke-Expression($cmd)

   [String]$message = Get-Content c:\topsecret\testme.txt 
```

然后我希望能够读取文件并保留格式，最后通过他们的 API 将其发布到 pastebin。我试过了，但无论我做什么，我似乎都会丢失格式。这可能吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-23T15:04:05.983

发生这种情况是因为您的选角。`Get-Content`返回一个对象数组，文本文件中的每行都有一个字符串对象。当您将其转换为 时`[string]`，它会连接数组中的对象。问题是您没有指定要使用什么来连接对象（例如 linebreak `(backtick)n`）。

```
ipconfig >> test.txt

#Get array of strings. One per line in textfile
$message = Get-Content test.txt

#Get one string-object with linebreaks
$message = (Get-Content test.txt) -join "`n" 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-02-23T15:12:31.120

将所有数据作为单个字符串读取并嵌入换行符

```
$file = 'c:\testfiles\testfile.txt'

(IPconfig /all) > $file

[IO.File]::ReadAllText($file) 
```

如果你有 V3，他们添加了 -Raw 参数来完成同样的事情：

```
Get-Content $file -Raw 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T15:02:25.053

投射到一个字符串数组，也许。像这样，对于你的最后一个例子：

```
$message = @(Get-Content c:\topsecret\testme.txt) 
```

或者这是第二个：

```
$message = [string[]](ipconfig) 
```

# jquery - .htaccess 将链接重写为锚链接

> ID：15041860
> 
> 赞同：0
> 
> 时间：2013-02-23T14:57:13.763
> 
> 标签：jquery, .htaccess, rewrite, anchor

是否有我可以部署的 htaccess 重写，它将`http://example.com/about`在页面上显示相同的位置`http://example.com/#about`？如果没有，我可以用 jQuery 来做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T22:41:45.510

在这里，我想通了。它并不完美（它重定向到锚点，因此您可以在 url 中看到它）但它对我有用：

```
RewriteEngine On
RewriteRule ^([a-zA-Z0-9_]+)$  /\#$1 [R,NE] 
```

如果你使用这个，`http://example.com/about`会变成`http://example.com/#about`.

# iphone - [自我presentModalViewController：作曲家动画：YES]；已弃用

> ID：15041862
> 
> 赞同：-4
> 
> 时间：2013-02-23T14:57:34.553
> 
> 标签：iphone, ios, objective-c

```
 [self presentModalViewController:composer animated:YES]; 
```

在 iOS 6 中已弃用

那我放什么代替这段代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:03:11.463

查看`presentModalViewController:animated:`. 不推荐使用的方法的文档清楚地说明了您应该使用什么来代替它。

请记住，文档是您的朋友。:)

替换是`presentViewController:animated:completion:`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:02:52.210

利用

```
[self presentViewController:pNewController animated:YES completion:nil]; 
```

你会没事的。它完全一样。

有关已弃用的 UIViewController 方法的官方信息，请参见此处：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T15:05:28.820

```
[self presentViewController:vc animated:NO completion:nil]; use this code for `iOS 6` 
```

在中，有和`iOS SDK`两种方法。`UIViewController``presentModalViewController:animated:``presentViewController:animated:completion:`

上述两种说法的主要区别在于

`presentViewController:animated:completion:`使用中`iOS 5 or lattere.`
`presentModalViewController:animated:`早前使用`iOS 5`

另请参阅[此站点以获取演示视图控制器](http://useyourloaf.com/blog/2012/10/08/presenting-view-controllers.html)

# javascript - 光标不会在 JSON 回调中恢复为默认值

> ID：15041864
> 
> 赞同：2
> 
> 时间：2013-02-23T14:58:03.230
> 
> 标签：javascript, jquery, json

```
$('#logonButton').click(function() {
    if ( $(this).text() == 'logon') {
        $(this).css('cursor','wait');
        $.getJSON('http://localhost:8080/test?method=logon', function(data, returnValue) {
            $('#output').append("<p>"+data+"</p>");
            $('#logonbutton').css('cursor','default');
            $('#logonButton').text('logoff');
        });
    ... 
```

此登录需要一些时间，因此我想在 JSON 调用之前将光标设置为“等待”，然后在点击回调时将其设置回“默认”。

调用返回，数据附加到输出 div，但#logonButton div 文本没有改变，光标停留在“忙碌”上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:01:56.377

应该是`#logonButton`，不是`#logonbutton`。

```
$('#logonButton').css('cursor','default'); 
```

注意大写`B`。

此外，您应该考虑在处理程序中恢复光标，[`.always()`](http://api.jquery.com/deferred.always/)这在发生 AJAX 错误的情况下也可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:01:35.883

您在这一行有一个错误：

```
$('#logonbutton').css('cursor','default'); 
```

应该

```
$('#logonButton').css('cursor','default'); 
```

# javascript - 使用 Javascript 遍历未知长度的文本区域数组

> ID：15041866
> 
> 赞同：0
> 
> 时间：2013-02-23T14:58:05.370
> 
> 标签：javascript, arrays, textarea, loops

我正在尝试使用 ClassName 遍历我的页面上的一组文本区域`TextInput`并更改它们的值（`innerHTML`）。我写的函数如下——

```
 function init() {
        var TextInput[] = document.getElementByClassName("TextInput"); //line 12
        for(var i = 0; i < TextInput.length; i++) {
            TextInput[i].innerHTML = "N/A";
        }
    } 
```

Firefox 18.0.2 的调试控制台`SyntaxError: missing ; before statement`在第 12 行显示。

我的代码有什么问题，我该如何实现我想要做的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:00:07.057

您不需要添加`[]`，只需

```
var TextInput = document.getElementByClassName("TextInput"); //line 12 
```

编辑：正如@Benjamin 指出的那样，函数名称缺少`s`.

这应该有效：

```
var TextInput = document.getElementsByClassName("TextInput"); //line 12 
```

# iphone - 列出IOS中的文档文件

> ID：15041867
> 
> 赞同：-12
> 
> 时间：2013-02-23T14:58:10.153
> 
> 标签：iphone, ios, ipad

我需要了解基本问题。

1）我需要从我的应用程序中下载一些数据..我应该将它存储在哪里（文档目录或其他路径）。

2）如果我存储在..delete my app..的文档目录中，那么我所有下载的数据不会被删除。

3）我下载的数据可能会以GB为单位增加空间大小，所以我应该将它存储在哪里。

**下面的代码给了我文档目录的列表数据**

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

  documentsDirectory = [paths objectAtIndex:0];
 NSLog(@"path %@",documentsDirectory);
 filePathsArray = [[NSFileManager defaultManager] subpathsOfDirectoryAtPath:documentsDirectory  error:nil];
NSLog(@"af%@",filePathsArray); 
```

4）如果我需要列出某个特定文件夹的数据，`"/users"`那么代码中应该有哪些变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:17:21.080

1) Apple 更喜欢将下载的数据存储在应用程序的`Caches`目录中，因为如果数据被删除，数据可以被替换。

2) 是的，如果用户删除一个应用程序，存储在应用程序沙箱中的所有数据都将被删除。你期望会发生什么？

3）使用`NSCachesDirectory`。

4)`/Users`不是应用沙箱中的有效路径。在模拟器中运行时可能会看到这样的路径，但在真实设备上却看不到。

Apple 的文档讨论了 iOS 文件系统和应用程序沙箱的结构。你真的应该从阅读这些文档开始。

顺便说一句 - 使用 Google 或搜索此站点只需几分钟即可找到这些答案中的每一个。这就是为什么你得到所有反对票的原因。在发布问题之前，请努力寻找自己的答案。请阅读（整个）常见问题解答。

# python - 在 matplotlib 图中渲染 Pandas 'to_latex' 方法的输出

> ID：15041868
> 
> 赞同：5
> 
> 时间：2013-02-23T14:58:11.117
> 
> 标签：python, pandas, matplotlib, latex

**Python Pandas DataFrame 有一个`to_latex`方法：**

```
import pandas as pd
from numpy import arange

a = pd.DataFrame(arange(4))
a.to_latex() 
```

**输出：**

> '\begin{表格}{|l|c|c|}\n\hline\n{} & 0 \\\n\hline\n0 & 0 \\\n1 & 1 \\\n2 & 2 \\\ n3 & 3 \\\n\hline\n\end{表格}\n'

**我想将此表覆盖在 matplotlib 图上：**

```
import pylab as plt
import matplotlib as mpl

mpl.rc('text', usetex=True)
plt.figure()
ax=plt.gca()

plt.text(9,3.4,a.to_latex(),size=12)
plt.plot(y)
plt.show() 
```

**但是，我收到此错误：**

> RuntimeError：LaTeX 无法处理以下字符串：'\begin{tabular}{|l|c|c|}'

**我的问题是：**

如何在 matplotlib 图中渲染 Pandas 'to_latex' 方法的输出？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-23T16:05:03.590

问题是 matplotlib 不能很好地处理多行乳胶字符串。解决它的一种方法是用空格替换乳胶字符串中的换行符。也就是说，做这样的事情：

```
ltx = a.to_latex().replace('\n', ' ')
plt.text(9, 3.4, ltx, size=12) 
```

# sql-server - 如何将 SQL Server 表导入到 itab？

> ID：15041871
> 
> 赞同：1
> 
> 时间：2013-02-23T14:58:34.693
> 
> 标签：sql-server, abap, opensql, internal-tables

是否可以直接将 SQL Server 表中的数据导入内部表（itab）？

我想在 SE37 函数中使用这个 itab。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:36:18.353

对于您的任务，您可以使用功能模块（SE37），也可以使用模块池或报告（SE38、SE80）。检查此报告：

```
report zinsertdb.

data: oref   type ref to cx_root,
      p_conex type dbcon_name value 'YOUR_DB_CONNECTION_STRING', " Ask the basis for this
      lv_sw type c,
      errormessage type string.

data it_mydata type standard table of mara.

start-of-selection.

  perform connect.
  perform insert_into_db.
  perform disconnect.

form connect.
  try.
      EXEC SQL.
        CONNECT TO :p_conex
      ENDEXEC.
      lv_sw = 'X'.
    catch cx_sy_native_sql_error into oref.
      lv_sw = space.
      errormessage = oref->get_text( ).
  endtry.
endform.

form disconnect.
  clear errormessage.
  if lv_sw = 'X'.
    try.
        EXEC SQL.
          COMMIT
        ENDEXEC.
      catch cx_sy_native_sql_error into oref.
        errormessage = oref->get_text( ).     
    endtry.
  endif.
endform.

form insert_into_db.

   data wa_mydata like line of it_mydata.
   data zcount type i.

   select * from mara into corresponding fields of table it_mydata.

   if sy-subrc EQ 0.

     loop at it_mydata into wa_mydata.

        try .

            exec sql. 
              EXECUTE PROCEDURE sp_get_data ( IN :wa_mydata-EAN11, IN :wa_mydata-MEINS, OUT :zcount ) 
            endexec.

            if zcount eq 0.
              exec sql.
                INSERT INTO "Your_Database".dbo.[Your_table]
                (Field1, Field2, Field3, FieldN)
                 VALUES (:wa_mydata-matnr,
                         :wa_mydata-ean11,
                         :wa_mydata-matkl,
                         :wa_mydata-meins)
              endexec.
              lv_sw = 'X'.
            endif.

          catch cx_sy_native_sql_error into oref.
            lv_sw = space.
            errormessage = oref->get_text( ).   
        endtry.

     endloop.

   endif.

endform. 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T11:06:44.267

目前还不清楚你想做什么。我假设您的意思是您想将整个 SQL 表（或其中的某些条目）读入程序内存？也许您可以在这里阐明更多信息？

如果是这种情况，您可以简单地声明一个内部表，该表具有包含数据的 SQL 表的结构。

`DATA: table_name TYPE STANDARD/HASHED/SORTED TABLE OF name_of_sql_table.`

`FIELD-SYMBOLS <structure> TYPE name_of_sql_table.`

`SELECT * FROM name_of_sql_table INTO TABLE table_name.`

从那里它只是从内部表中读取数据。

`READ TABLE table_name ASSIGNING <structure> WITH KEY table_key_field(s) = condition(s).`

但正如贾格尔所说，要小心你的桌子有多大。

# python - 定义函数，TypeError

> ID：15041876
> 
> 赞同：2
> 
> 时间：2013-02-23T14:59:23.757
> 
> 标签：python, python-3.x, typeerror

可能很明显，但由于某种原因，这段代码：

```
import random
import time
def tables():
    global tablesUsed
    tablesUsed = [int(x) for x in input("Please choose which multiplication tables you wish\nto practice, then type them like this: 2 5 10.\n").split()]
    return tablesUsed
def timer():
    timer  = input("Do you wish to play with the timer? (yes or no)\n")
    if timer == "yes":
        withTimer()
    else:
        withoutTimer()
def withTimer():
    playAgain = "yes"
    total = 0
    correct = 0
    while playAgain == "yes":
        total = total + 1
        random1 = random.choice(tablesUsed)
        random2 = random.randint(1, 12)
        realAnswer = random1 * random2
        start = time.time()
        humanAnswer = int(input("What is the answer to this multiplication sum?\n" + str(random1) + " * " + str(random2) + "\n"))
        if realAnswer == humanAnswer:
            elapsed = round((time.time() - start), 1)
            correct = correct + 1
            score = str(int(correct / total * 100)) + "%"
            if elapsed < 2:
                print("Congratulations, you got it correct in " + str(elapsed) + " seconds!\nThat is a very good time!\nScore: " + score)
            else:
                print("Congratulations, you got it correct in " + str(elapsed) + " seconds!\nNow work on your time.\nScore: " + score)            
        else:
            score = str(int(correct / total * 100)) + "%"
            print("Unforunately, you got this one incorrect, the actual answer was " + str(realAnswer) + ".\nScore: " + score)
        playAgain()
def withoutTimer():
    playAgain = "yes"
    total = 0
    correct = 0
    while playAgain == "yes":
        total = total + 1
        random1 = random.choice(tablesUsed)
        random2 = random.randint(1, 12)
        realAnswer = random1 * random2
        humanAnswer = int(input("What is the answer to this multiplication sum?\n" + str(random1) + " * " + str(random2) + "\n"))
        if realAnswer == humanAnswer:
            correct = correct + 1
            score = str(int(correct / total * 100)) + "%"
            print("Congratulations, you got it correct!\nScore: " + score)         
        else:
            score = str(int(correct / total * 100)) + "%"
            print("Unforunately, you got this one incorrect, the actual answer was " + str(realAnswer) + ".\nScore: " + score)
        playAgain()
def playAgain():
    playAgain = input("Do you wish to play again? (yes or no)\n")
    if playAgain == "yes":
        settings()
    else:
        print("Thank you for practising your multiplication tables with me. Your final score was " + score + " and your average time was " + averageTime)
def settings():
    settings = input("Do you wish to edit settings? (yes or no)\n")
    if settings == "yes":
        tables()
        timer()
tables()
timer() 
```

返回一个错误说：

```
TypeError: 'str' object is not callable, line 66, line 10, line 35 
```

请有人帮忙告诉我我做错了什么？我认为这可能与错误地定义函数有关，但我找不到任何可以解决我的问题的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-23T15:02:34.117

您在函数中定义`playAgain`为函数和局部变量`withTimer`：

```
def withTimer():
    playAgain = "yes"

    # ...

    while playAgain == "yes":
        # ....

        playAgain()   # this is now a string, not the function 
```

不要那样做，使用有意义的名称，不会影响您的函数名称。

# regex - 使用变量作为 RegEx 模式

> ID：15041877
> 
> 赞同：29
> 
> 时间：2013-02-23T14:59:28.260
> 
> 标签：regex, perl, variables

我想使用一个变量作为匹配文件名的正则表达式模式：

```
my $file = "test~";
my $regex1 = '^.+\Q~\E$';
my $regex2 = '^.+\\Q~\\E$';
print int($file =~ m/$regex1/)."\n";
print int($file =~ m/$regex2/)."\n";
print int($file =~ m/^.+\Q~\E$/)."\n"; 
```

结果（或在[ideone.com](http://ideone.com/x2TbFm)上）：

```
0
0
1 
```

谁能向我解释如何将变量用作 RegEx 模式？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-02-23T15:04:13.260

正如[文件](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators)所说：

```
 $re = qr/$pattern/;
    $string =~ /foo${re}bar/; # can be interpolated in other patterns
    $string =~ $re; # or used standalone
    $string =~ /$re/; # or this way 
```

因此，请使用`qr`类似引号的运算符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-23T15:02:33.703

您不能`\Q`在单引号/非插值字符串中使用。词法分析器必须看到它。

无论如何，波浪号不是元字符。

添加`use regex "debug"`，您将看到实际发生的情况。

# php - 当我用 jquery ajax 调用 php 文件时，wordpress 返回 404

> ID：15041879
> 
> 赞同：2
> 
> 时间：2013-02-23T14:59:32.927
> 
> 标签：php, wordpress, .htaccess, http-status-code-404

我有用于将电子邮件地址添加到新闻列表的 php 文件，该文件位于我的 wp-content/plugins 目录中

我的文件名为 add_subscriber.php

我认为我的 htaccess 出于某种原因阻止了此文件

我的 htaccess 文件如下

```
IndexIgnore .htaccess */.??* *~ *# */HEADER* */README* */_vti*

<Limit GET POST>
order deny,allow
deny from all
allow from all
</Limit>
<Limit PUT DELETE>
order deny,allow
deny from all
</Limit>

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

当我尝试调用此文件时，它会以某种方式重定向到 404 页面。

我的 AJAX 代码

```
<script>
    <?php echo 'var blog_url = \''.get_bloginfo('wpurl').'\''; ?>;

function validateEmail(email) { 
    var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(email);
}

function subscribeMailList(){
    email=jQuery("#ml-email").val();
    if(!validateEmail(email)){
        return false;
    }
    //jQuery("#ml-img").fadeIn(0);
    //jquery ajax request
    var url=blog_url+"/wp-content/plugins/mail-list/ajax/add_subscriber.php"

    console.log(url);

    jQuery.post(url,{emailaddress:email},function(result){
        if(result=="true"){
            $("#newsletter-form-succeeded").css("display","block");
            $("#newsletter-form").css("display","none");
        }      
    });

    //hide the form
    /*jQuery("#ml-img").fadeOut(0);
    jQuery('#ml-p').fadeOut(0);
    jQuery('#ml-p-sent').fadeIn(0);
    jQuery('#ml-form').fadeOut(0);
    jQuery('#ml-newsletterform').delay(3000).fadeOut(1000);*/
    return false;
}

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-08T18:54:00.490

如果您想在 WordPress 中使用 AJAX，您需要确保 AJAX 请求通过**wp-admin文件夹中的****admin-ajax.php**文件。

 **看看这篇详细解释的文章：

> [http://wp.smashingmagazine.com/2011/10/18/how-to-use-ajax-in-wordpress/](http://wp.smashingmagazine.com/2011/10/18/how-to-use-ajax-in-wordpress/)**

# maps - Windows Phone - 从地图控件中提取图像部分

> ID：15041882
> 
> 赞同：0
> 
> 时间：2013-02-23T14:59:58.463
> 
> 标签：maps, windows-phone-8, windows-phone, bing-maps

我正在使用 Windows Phone 8 地图控件。我想将显示的地图的一部分提取为图像以将其用作图块。是否有内置功能，因为如果您将位置固定为图块，本机地图应用程序会执行相同的操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T23:00:01.817

在图块中显示地图的一种可能性是使用 Bing Maps 中的静态图像 REST 服务，如果您正在寻找它，请参阅 MSDN 了解更多信息：

[http://msdn.microsoft.com/en-us/library/ff701724.aspx](http://msdn.microsoft.com/en-us/library/ff701724.aspx)

您将能够生成可以在图块中使用的静态图像，并且有一些选项可以设置中心、样式甚至添加内容。

# android - 像facebook这样的android菜单

> ID：15041887
> 
> 赞同：0
> 
> 时间：2013-02-23T15:00:12.660
> 
> 标签：android, facebook

我想制作从左到右出现的 android 菜单，如 facebook 应用程序菜单这个组件的名称是什么或如何？

这是 Facebook 菜单的图片 [http://img703.imageshack.us/img703/7627/img20130223153440.jpg](http://img703.imageshack.us/img703/7627/img20130223153440.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:11:33.630

第一：你和感叹号是怎么回事？还是您的猫决定在 Shift 和 1 键上小睡一下？;)

第二：将这个 android 库用于这些类型的菜单： [https ://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)

它运行良好，并被许多“著名”应用程序使用（有关更多信息，请参见链接）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:18:02.740

有一些图书馆可以做到这一点。我找到的最好的是来自[SimonVT](https://github.com/SimonVT/android-menudrawer)和 Jake Wharton 的 MenuDrawer。它非常简单且功能强大。它还使用硬件层，因此不会通过在布局下方绘制菜单来创建过度绘制。

# php - 根据从数据库中获取的值检查正确的复选框

> ID：15041888
> 
> 赞同：0
> 
> 时间：2013-02-23T15:00:22.390
> 
> 标签：php, codeigniter

我正在为一个项目使用 codeigniter。在 html 方面，我有 3 个复选框，我将在其中查看哪个是选中的复选框并将值存储在数据库中。现在我想获取值并选中相应的复选框。

我的复选框如下

```
<div class="span2">
   <label class="radio">
      <input class="attrInputs" type="radio" name="shoulder" value="flat">
      Flat
   </label>
   <img src="http://placehold.it/126x126/cbcbcb" class="push-top">
</div>
<div class="span2">
   <label class="radio">
      <input class="attrInputs" type="radio" name="shoulder" value="regular">
      Regular
   </label>
   <img src="http://placehold.it/126x126/cbcbcb" class="push-top">
</div>
<div class="span2 border-right">
   <label class="radio">
      <input class="attrInputs" type="radio" name="shoulder" value="sloped">
      Sloped
   </label>
   <img src="http://placehold.it/126x126/cbcbcb" class="push-top">
</div> 
```

因此，例如，如果我检查输入元素的斜率值，斜率值将存储在数据库中，当用户登录时，它会预加载其检查的斜率值输入

提前谢谢各位！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:59:08.377

好的，没有您的控制器以及您如何返回数据，我将向您介绍其工作原理的基础知识。本质上，您将检查肩部的值并确定适当的框。因此，在您的控制器中，您会将数据发送到类似这样的视图（同样我不知道您的数据库或表是什么样的，所以这只是示例）。

控制器：

```
$this->load->model('someModel');
//the following populates the formData variable with an array from your database.
//I am going to assume you know how to do this.
$data['formData'] = $this->someModel->getData();
$this->load->view('someView',$data); 
```

查看，虽然使用 CI 的内置表单处理程序可能更容易，但这不是必需的，因此我将仅使用您的代码作为示例。

```
<div class="span2">
   <label class="radio">
      <input class="attrInputs" type="radio" name="shoulder" value="flat" 
       checked="<?=$formdata['shoulder'] == 'flat' ? 'checked' : '' ;?>">
      Flat
   </label>
   <img src="http://placehold.it/126x126/cbcbcb" class="push-top">
</div>
<div class="span2">
   <label class="radio">
      <input class="attrInputs" type="radio" name="shoulder" value="regular" 
       checked="<?=$formdata['shoulder'] == 'regular' ? 'checked' : '' ;?>">
      Regular
   </label>
   <img src="http://placehold.it/126x126/cbcbcb" class="push-top">
</div>
<div class="span2 border-right">
   <label class="radio">
      <input class="attrInputs" type="radio" name="shoulder" value="sloped" 
       checked="<?=$formdata['shoulder'] == 'sloped' ? 'checked' : '' ;?>">
      Sloped
   </label>
   <img src="http://placehold.it/126x126/cbcbcb" class="push-top">
</div> 
```

上面的代码所做的是使用简写 if 语句来确定应该选中哪个框。在每一个中，它都会检查您的数据库返回的 'should' 的值是否与复选框相同，并将其检查值设置为已检查，如果不是，则设置为空白。

它还使用 php 短标签，因此如果您的服务器上未启用这些短标签，请启用它们或调整 php 标签以读取：

```
 checked="<?php echo ($formdata['shoulder'] == 'flat' ? 'checked' : '') ;?>" 
```

# android - Android 通用图像加载器自动调整大小

> ID：15041891
> 
> 赞同：2
> 
> 时间：2013-02-23T15:00:44.270
> 
> 标签：android, universal-image-loader

该库允许从网络上自动下载和调整图像大小。这是网站 wiki 中的代码片段：

```
 ImageSize targetSize = new ImageSize(120, 80); // result Bitmap will be fit to this size
    imageLoader.loadImage(imageUri, targetSize, displayOptions, new SimpleImageLoadingListener() {
    @Override
    public void onLoadingComplete(String imageUri, View view, Bitmap loadedImage) {
        // Do whatever you want with Bitmap
    }
}); 
```

这是我的代码：

```
ImageView imageView = (ImageView)findViewById(R.id.imageGrid1); // view, where the image will be displayed
String imageUrl = "http://img33.imageshack.us/img33/9336/51863504.jpg"; 
ImageLoader imageLoader = ImageLoader.getInstance();
imageLoader.init(ImageLoaderConfiguration.createDefault(this));
ImageSize targetSize = new ImageSize(120, 80);
DisplayImageOptions options;

imageLoader.loadImage(imageUrl,  targetSize, options, new SimpleImageLoadingListener() {
    @Override
    public void onLoadingComplete(String imageUri, View view, Bitmap loadedImage) {
        // Do whatever you want with Bitmap
    }
}); 
```

Eclipse 不想编译返回此错误的代码。在 imageloader.loadImage 上，错误是

```
Multiple markers at this line
    - SimpleImageLoadingListener cannot be resolved to a type
    - The method loadImage(String, ImageSize, DisplayImageOptions, ImageLoadingListener) in the type ImageLoader is not applicable for the arguments 
     (String, ImageSize, DisplayImageOptions, new SimpleImageLoadingListener(){}) 
```

在 OnloadingComplete 错误是

```
The method onLoadingComplete(String, View, Bitmap) of type new SimpleImageLoadingListener(){} must override or implement a supertype method 
```

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-27T03:57:06.633

```
ptions = new DisplayImageOptions.Builder()
            .showImageOnLoading(R.drawable.ic_stub)
            .showImageForEmptyUri(R.drawable.ic_empty)
            .showImageOnFail(R.drawable.ic_error).cacheInMemory(true)
            .cacheOnDisk(true).considerExifParams(true)
            .displayer(new RoundedBitmapDisplayer (20))
            .bitmapConfig(Bitmap.Config.RGB_565).build(); 
```

# jquery - 使用 jQuery 放大双击功能

> ID：15041896
> 
> 赞同：-1
> 
> 时间：2013-02-23T15:01:11.443
> 
> 标签：jquery, mobile, zooming

我有兴趣为我的网页上的图像添加“双击放大”功能，以便移动用户能够通过点击图像来放大和缩小。是否可以使用 jQuery 来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:03:13.983

如果我理解您的意思，大多数移动操作系统已经具有此功能（iOS 和 Android 肯定有）。不需要任何 jQuery 脚本。

# shell - cakephp cron 作业 - 缺少数据库表

> ID：15041902
> 
> 赞同：1
> 
> 时间：2013-02-23T15:01:57.210
> 
> 标签：shell, cakephp, cron

我在`app/vendors/shells`文件夹中创建了一个 report.php 文件，其中包含以下内容

```
class ReportShell extends Shell {
    var $uses = array('User');

    function main() {
        $userData = $this->User->find('first');
    }
} 
```

当我想从应用程序文件夹运行它时，`../cake/console/cake report`出现以下错误

`Error: Missing database table 'users' for model 'User'`

`users`数据库中确实存在表，`User`模型中也存在。该项目运行良好，我的意思是模型、控制器、视图没有问题。我的蛋糕版本是1.3

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T16:20:29.813

我想通了，问题是在 db config 中而不是`'host' => 'localhost'`必须写入`'host' => '127.0.0.1'`，另请参阅此答案

[在 Mac OSX 上使用 MAMP 时，如何让 CakePHP 烘焙以查找 mysql.sock 并识别 MySQL？](https://stackoverflow.com/questions/366550/how-do-i-get-cakephp-bake-to-find-mysql-sock-and-recognize-mysql-while-using-mam/366556#366556)

# sql - 在 RDB 模式中，何时将列组合成一个单独的分隔列会更好？

> ID：15041903
> 
> 赞同：2
> 
> 时间：2013-02-23T15:02:06.590
> 
> 标签：sql, database, schema, relational-database, normalization

例如，考虑您有两个数据和平的情况，其中一个值很少使用另一个值。作为一个例子，这里是一个包含用户认证数据的表格：

```
CREATE TABLE users
(
id INT PRIMARY KEY, 
auth_name STRING,
auth_password STRING,
auth_password_salt STRING
) 
```

我认为没有盐的密码是没有意义的，反之亦然。我也可以选择以这种方式表示数据：

```
CREATE TABLE users
(
id INT PRIMARY KEY, 
auth_name STRING,
auth_secret STRING,
) 
```

在 中`auth_secret`，存储字符串，例如`D5SDfsuuAedW:unguessable42`

一般来说，在任何情况下将列组合成一个分隔列会是更好的选择吗？

即使总体上它从来都不是一个“更好的选择”，但拥有更多列而不是更少列（对于相同的数据）是否有任何*成本（性能、空间等）？*我的动机是更好地理解并在有人提出此类建议时能够更有能力地反对它。

* * *

--***编辑***我更改了示例...原始示例如下：

```
CREATE TABLE points
(
id INT PRIMARY KEY, 
x_coordinate INT,
y_coordinate INT,
z_coordinate INT
) 
```

对比

```
CREATE TABLE points
(
id INT PRIMARY KEY,
position STRING
) 
```

在`position`，存储字符串，如`7:3:15`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:07:10.123

当没有机会需要加入、查询、报告或聚合数据时，您可以这样做。

换句话说 - 从来没有。这是糟糕的数据库设计。

第一范式 (NF1) 指出属性应该是不同的——这是基本要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:56:43.107

这个问题唯一可能的答案是*never*。永远不要将分隔数据存储在列中。它破坏了用于分隔数据的列的整个点，并使执行数据库设计的任何事情变得异常困难。这是对规范化的严重违反，以至于您将在 Stack Overflow 上花费数小时试图在几个月内纠正它。

### 永远不要这样做。

然而，“永不言败”。

在某些极其有限的情况下，这没关系。永远不要假设它没关系，但它*可以*。

一个很好的例子是 Stack Overflow 自己的[Posts 表](https://data.stackexchange.com/stackoverflow/query/99472)，它以分隔格式存储标签以便快速*阅读*。从数据库中读取问题的标签比编辑它们的频率要高得多。标签存储在单独的表 PostTags 中，然后在更新时非规范化为 Posts。

简而言之，即使您可以通过这种方式对数据进行非规范化，也不要这样做。尽一切可能避免它。如果您遇到一种情况，您已经优化了好几天，而更快获得某些东西的唯一方法是非规范化，那么没关系。只需确保您只会从该列*读取*数据，并且您有一个辅助流程来确保它保持最新。如果非规范化数据的更新失败，请回滚所有内容以确保您的数据一致。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T15:47:15.823

您遗漏了一个重要的选项：创建适当的用户定义数据类型。（[PostgreSQL 长期以来一直有 2-space 的内在数据类型](http://www.postgresql.org/docs/9.2/static/datatype-geometric.html#AEN6473)。）

*   [PostgreSQL](http://www.postgresql.org/docs/9.2/static/sql-createtype.html)
*   [甲骨文](http://docs.oracle.com/cd/E11882_01/server.112/e17118/sql_elements001.htm#i46376)
*   [SQL 服务器](http://msdn.microsoft.com/en-us/library/ms175007.aspx)
*   [DB2](http://pic.dhe.ibm.com/infocenter/db2luw/v9r7/index.jsp?topic=/com.ibm.db2.luw.sql.ref.doc/doc/r0008476.html)

这些实现有很大不同。

但是您可能没有使用这些平台之一的奢侈。例如，您可能必须使用不支持用户定义数据类型的 MySQL。

关系理论认为数据类型可以任意复杂。它们可以有内部结构。最常见的具有内部结构的数据类型是“日期”类型。关系理论指定了 dbms 应该如何处理此类数据类型。dbms 必须要么

*   完全忽略内部结构，或
*   提供操作部件的功能。

在日期的情况下，每个 SQL dbms 都提供了操作这些部分的函数。

您可以为存储 3 空间坐标（如 MySQL 中的“7:3:15”）的单个列提供一个很好的参数。为了与关系理论保持一致，您希望 dbms 忽略该结构，并仅返回单个值“7:3:15”；部件的操作留给应用程序代码。

*在 MySQL 中实现*类似的一个问题是 MySQL 不强制 CHECK 约束。所以要阻止像“wibble:frog:foo”这样的值进入数据库要困难得多。

# matlab - Matlab - 关闭图形窗口

> ID：15041904
> 
> 赞同：5
> 
> 时间：2013-02-23T15:02:06.587
> 
> 标签：matlab, figures

我在 Matlab 编辑器中编写了一些代码，它有大约 30 个数字。所以，当我发布它时，它会打开 30 个数字的窗口，这很烦人。如何防止它打开窗口，但将数字保留在已发布的窗口中？

我试过了`close(figure)`，但是这些数字没有显示在发布的窗口上。

提前致谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-23T15:09:22.810

最简单的事情是`close all`当你完成了这些数字。我不确定这是否可以成为脚本的一部分，或者您是否必须在发布后手动运行它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-24T01:02:10.827

至少该`plot`命令具有控制图形可见性的选项。所以你会写类似

```
h = plot(... , 'Visible', 'off'); 
```

我希望这些也适用于其他图形对象，我知道它适用于与`anova`.

**编辑**：上面隐藏了情节，但没有隐藏图形本身。要在创建后立即隐藏图形，请执行

```
set(gcf, 'Visible', 'off') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-08T07:16:22.307

[matlab 中的close](http://in.mathworks.com/help/matlab/ref/close.html)函数可以满足您的需求。阅读文档以获取更多详细信息

要同时关闭所有地块，您可以使用

```
close all 
```

要关闭名为“fig5”的特定图形（例如），您可以使用

```
fig5 = scatter(x, y);
close(fig5) 
```

如果您只使用“关闭”，则只有最近的数字会关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-14T13:47:36.360

概述解决方案，

**第一步是使用处理程序进行绘图。使用fig=图；其中 figa 现在是 figure 的处理程序。如果你使用多个，比如你说的 30，数字，那么 figa=figure;figb=figure.......figad=figure; 第二步; 将这些数字用于您想要绘制的任何内容；必须通过撤销图形来完成，例如图形（figa）；保持；情节（x1，y1）图形（figb）；保持；情节（x2，y2）....等30个情节第三set 是保存所有数字 saveas(figa,'1.fig');saveas(figb,'2.fig');....... 以此类推 30 个图；第四步是从你的监视器关闭所有地块；第五步是重新打开这些数字 openfig('1.fig');openfig('2.fig');...... 30 个无花果**

一个建议：使用 excel 创建这个长长的图形名称列表，并更好地使用单独的 .m 文件，以避免增加您的 matlab 主代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-24T00:55:30.983

Perhaps you want [hold on](http://www.mathworks.com/help/matlab/ref/hold.html) which will plot all of the graphs to the same window?

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-01-14T07:45:48.317

您可以使用 subplot(m,n,p) 在同一图形窗口上绘制多个图形。

# ruby-on-rails - Rails 中的会员加入模型协会

> ID：15041907
> 
> 赞同：0
> 
> 时间：2013-02-23T15:02:24.673
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有以下型号

```
Class User
  has_many :memberships

Class Membership
  belongs_to :user 
```

成员资格表有两列，`user_id`和`organization_id`。但是，`organization_id`它也是一个用户 ID。

我怎样才能指定一个关联，以便：

`@user.organizations`返回此用户所属的组织（其他用户）的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:56:32.843

我认为这样做的正确方法是创建三个模型，如下所示：

```
#user.rb
class User < ActiveRecord::Base
  has_many :memberships
  has_one :organization
end

#organization.rb
class Organization < ActiveRecord::Base
  attr_accessible :user_id
  belongs_to :user
  has_many :memberships
end

#membership.rb
class Membership  < ActiveRecord::Base
  attr_accessible :user_id, :organization_id
  belongs_to :user
  belongs_to :organization
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T20:07:29.107

弄清楚了：

```
class Membership < ActiveRecord::Base
  belongs_to :user
  belongs_to :organization, class_name: "User"
end

class User < ActiveRecord::Base
  has_many :memberships
  has_many :organizations, through: :memberships
end 
```

# ruby - 真正的轮胎方法的代理？

> ID：15041912
> 
> 赞同：0
> 
> 时间：2013-02-23T15:02:40.727
> 
> 标签：ruby, elasticsearch, tire

我正在阅读[轮胎宝石](https://github.com/karmi/tire)的文档，我对以下段落的含义感到困惑。有人可以解释一下吗？

> 事实上，一直以来，您一直只使用真实轮胎方法的代理，它们存在于模型的轮胎类和实例方法中。只有当不踩到别人的脚时——大多数情况下——Tire 才会把它的方法带到你的类的命名空间中。
> 
> 所以，为了安全起见，你可以写而不是`Article.search`写 `Article.tire.search`，而不是`@article.update_index`你可以写。`@article.tire.update_index`让我们看一个使用映射方法的示例：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T08:14:12.407

它的意思就是它所说的：Tire 尽量不将方法拖到您的模型/命名空间中，并且仅在它们不存在时才定义其方法。

作为普通用户，您不必太在意它。每当您调用`MyModel.search`or`MyModel.mapping`时，您也可以调用`MyModel.tire.search`or `MyModel.tire.mapping`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T05:01:38.983

为了背诵 Karmi 所说的话，如果您的模型已经定义了搜索，您可能会发现这很有用。

因此，如果说**Post.search**已经在您的 rails 应用程序中执行了某些操作，您可以只使用**Post.tire.search**来进行轮胎搜索。我喜欢用它来向所有可能在我之后使用代码的开发人员发出信号，这是一个轮胎方法，所以他们（希望）不会花时间思考在**Post**模型中哪里可以找到搜索方法。

# wcf - 使用 SVCUtil 生成代码文件时出现 WCF 服务错误

> ID：15041913
> 
> 赞同：1
> 
> 时间：2013-02-23T15:02:51.450
> 
> 标签：wcf, mono, svcutil.exe

我在 Windows 操作系统上使用 net framework 4.0 创建了一个 WCF 服务；其工作正常使用 SVCUtil 生成客户端代码文件。但它在带有单声道的 ubuntu apache 上失败了。错误信息如下：

```
exception :System.ServiceModel.Description.DataContractSerializerMessageContractImporter

details:
Due to the namespace "http://schemas.datacontract.org/2004/07/System" with data
contract name "MarshalByRefObject" reference types "System. MarshalByRefObject, 
mscorlib, VerSion = 4.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 "
 with import DataConTract does not match, so can't use. you need to remove the 
type of the reference. 
```

但是如何删除单声道上的引用 MarshalByRefObject 的类型？

任何援助将不胜感激。非常感谢您的帮助。

# macos - 如何着手为 ipad 制作应用程序，使其成为 Mac 键盘

> ID：15041919
> 
> 赞同：1
> 
> 时间：2013-02-23T15:03:00.497
> 
> 标签：macos, ipad, keyboard, bonjour, iokit

我试图弄清楚如何制作一个具有按钮的应用程序，当按下这些按钮时，我的 mac 会键入某个字符（或修饰符）。我已经按照想要的方式布置了按钮，所以我的项目现在距离完成只有两步之遥：

1.  向mac发送一条消息，让它知道要按哪个键。
2.  让 mac 按下实际键 For 1 我正在考虑设置一个 bonjour 服务，该服务将与在 ipad 上按下的键相关联的字符串发送到 mac。然后mac会收到这个。我键盘上的一些键是需要移位的字符（即@），所以我想这个代码将类似于 S120。无论接收到什么消息，然后都会读取字符串，看到它需要刺激 shift 按下与 120 相关的键。对于 2，我不太清楚。请记住，这需要快速，因为它将是键盘。我正在考虑制作一个 iokit 项目，它将接收字符串解码并模拟正确的密钥。不过这可能有点过头了，而且我听说在处理内核时你真的必须小心。如果我的想法不正确，请提出更好的方法并填写详细信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:18:49.590

至于模拟按键，有一种使用 Applescript 的简单方法。

```
tell application "System Events"
    keystroke "A"
end tell 
```

（您可能需要在 Accessibility prefpane 中“启用辅助设备访问”）。

或者，可以在命令行上运行相同的脚本

```
osascript -e 'tell app "System Events" to keystroke "a"' 
```

**编辑：**如果您担心速度，脚本桥可以提供帮助。

```
#import <Foundation/Foundation.h>
#import <ScriptingBridge/ScriptingBridge.h>

int main(int argc, char *argv[]) {
    @autoreleasepool {  
        id sysEvents = [SBApplication applicationWithBundleIdentifier: @"com.apple.systemevents"];

        [sysEvents keystroke: @"h" using: 'Ksft'];
        [sysEvents keystroke: @"e" using: 0];
        [sysEvents keystroke: @"l" using: 0];
        [sysEvents keystroke: @"l" using: 0];
        [sysEvents keystroke: @"o" using: 0];

        // keyCode might be more suitable for your purposes

        for (int i = 32; i < 64; i++) 
        {
            [sysEvents keyCode: i using: 0];    
        }
    }
} 
```

您可以使用此应用程序找到关键代码。

[http://manytricks.com/keycodes/](http://manytricks.com/keycodes/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T17:05:14.810

您可能需要Quartz 事件服务中的[`CGEventCreateKeyboardEvent()`功能或类似功能。](https://developer.apple.com/library/mac/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html#//apple_ref/c/func/CGEventCreateKeyboardEvent)

# simperium - 如何发布 Simperium 笔记？

> ID：15041921
> 
> 赞同：2
> 
> 时间：2013-02-23T15:03:14.173
> 
> 标签：simperium

如何使用 PublishURL 属性发布笔记？

```
{"tags": [], "deleted": false, "shareURL": "", "systemTags": [], "content": "updated note with new modification time", "publishURL": "", "modificationDate": 1341563318.0, "creationDate": 1335390338.091453} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T22:45:12.297

发布功能目前仍使用旧 API - 您可以使用以下调用发布笔记

```
GET https://simple-note.appspot.com/api2/data/[note key]/publish 
```

响应应包含一个发布密钥：

```
{ "publishkey" : "xdAa5s" } 
```

您可以使用 Simperium 中的 X-Simperium-Token 标头进行身份验证。

# android - ListView.setOnItemClickListener 中的 StartActivity 崩溃

> ID：15041928
> 
> 赞同：1
> 
> 时间：2013-02-23T15:04:23.727
> 
> 标签：android, eclipse, android-listview, crash, android-activity

我在开始一项活动时遇到了一个奇怪的问题。我可以使用菜单从菜单启动它

```
Intent intent = new Intent(this,SplashScreen.class);
this.startActivity(intent); 
```

但如果我尝试从 ListView.setOnItemClickListener 启动它，它会崩溃。但是我尝试了各种方法，结果是一样的（我想开始的活动是一个空白屏幕，所以没什么可疑的）。这是当前的代码...

```
 list.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
startActivity(new Intent(getBaseContext(), SplashScreen.class));
            }}); 
```

活动被添加到清单中......并且主类扩展了活动。

日志猫

```
02-23 17:17:11.070: W/dalvikvm(3200): threadid=1: thread exiting with uncaught exception (group=0x40a13300)
02-23 17:17:11.248: E/AndroidRuntime(3200): FATAL EXCEPTION: main
02-23 17:17:11.248: E/AndroidRuntime(3200): java.lang.RuntimeException: Unable to start activity ComponentInfo{ro.pca.rentme/ro.pca.rentme.SplashScreen}: java.lang.NullPointerException
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.os.Handler.dispatchMessage(Handler.java:99)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.os.Looper.loop(Looper.java:137)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.ActivityThread.main(ActivityThread.java:4745)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at java.lang.reflect.Method.invokeNative(Native Method)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at java.lang.reflect.Method.invoke(Method.java:511)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at dalvik.system.NativeStart.main(Native Method)
02-23 17:17:11.248: E/AndroidRuntime(3200): Caused by: java.lang.NullPointerException
02-23 17:17:11.248: E/AndroidRuntime(3200):     at ro.pca.rentme.SplashScreen.onCreate(SplashScreen.java:46)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.Activity.performCreate(Activity.java:5008)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
02-23 17:17:11.248: E/AndroidRuntime(3200):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
02-23 17:17:11.248: E/AndroidRuntime(3200):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:24:21.270

您不需要`getBaseContext()`使用您的活动名称。

```
list.setOnItemClickListener(new OnItemClickListener() {
  public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    startActivity(new Intent(YourActivityName.this, SplashScreen.class));
  }
}); 
```

确保清单中的两个活动：

```
 <application ...>
    <activity android:name="your.package.name.MainActivity" /> <!-- or .MainActivity -->
    <activity android:name="your.package.name.SplashScreen" />
 </application> 
```

# java - 在 Android 中使用 isReachable() 时出错

> ID：15041929
> 
> 赞同：1
> 
> 时间：2013-02-23T15:04:26.840
> 
> 标签：java, android, inetaddress

我是android开发的新手。这是我的代码

```
boolean isReachable = false;
try{
    isReachable = InetAddress.getByName(MyIPAddress).isReachable(reachableTimeout);
} catch (Exception e){
    Log.e("InetAddress", e.getMessage());
}finally {
    if (!onlyReachables || isReachable) {
        // Do something
    }
} 
```

当我`AndroidManifest.xml`没有这些行时它工作正常

```
<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" /> 
```

当它出现时，我的应用程序*“不幸的是，myApp 已停止”*

任何人都可以帮助修复它吗？

我的日志猫：

```
E/AndroidRuntime(9310): FATAL EXCEPTION: main
E/AndroidRuntime(9310): java.lang.RuntimeException: Unable to start activity
ComponentInfo{com.thesis.wifihotspot/com.thesis.wifihotspot.MainActivity}:
java.lang.NullPointerException: println needs a message
E/AndroidRuntime(9310):     at
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2110)
E/AndroidRuntime(9310):     at
android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2135)
E/AndroidRuntime(9310):     at
android.app.ActivityThread.access$700(ActivityThread.java:140)
E/AndroidRuntime(9310):     at
android.app.ActivityThread$H.handleMessage(ActivityThread.java:1237)
E/AndroidRuntime(9310):     at
android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(9310):     at android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(9310):     at
android.app.ActivityThread.main(ActivityThread.java:4921)
E/AndroidRuntime(9310):     at
java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(9310):     at
java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(9310):     at
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1027)
E/AndroidRuntime(9310):     at
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:794)
E/AndroidRuntime(9310):     at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(9310): Caused by: java.lang.NullPointerException:
println needs a message
E/AndroidRuntime(9310):     at android.util.Log.println_native(Native Method)
E/AndroidRuntime(9310):     at android.util.Log.e(Log.java:297)
E/AndroidRuntime(9310):     at
com.thesis.wifihotspot.MainActivity.setClientsList(MainActivity.java:226)
E/AndroidRuntime(9310):     at
com.thesis.wifihotspot.MainActivity.onCreate(MainActivity.java:58)
E/AndroidRuntime(9310):     at
android.app.Activity.performCreate(Activity.java:5206)
E/AndroidRuntime(9310):     at
android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
E/AndroidRuntime(9310):     at
android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2074)
E/AndroidRuntime(9310):     ... 11 more 
```

**更新：** 根据此[链接](http://www.vogella.com/articles/AndroidNetworking/article.html)，从 Android 3.0 (Honeycomb) 开始，如果在用户界面线程中访问网络，则 StrictMode 配置为因 NetworkOnMainThreadException 异常而崩溃。所以我需要添加这些代码才能使应用程序正常工作。

> StrictMode.ThreadPolicy 策略 = 新的 StrictMode。ThreadPolicy.Builder().permitAll().build(); StrictMode.setThreadPolicy(policy);

感谢您的支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T15:10:53.527

它可能与您的问题无关，但您应该使用`getByAddress`而不是`getByName`如果您有 IP 地址。

```
isReachable = InetAddress.getByAddress(MyIPAddress).isReachable(reachableTimeout); 
```

这是[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/InetAddress.html#getByName%28java.lang.String%29)。

**编辑：**

你有一个没有任何消息的异常。首先，删除`e.getMessage()`. 然后，如果您需要解决问题，请显示更多代码。

# javascript - 小胡子条件和循环

> ID：15041930
> 
> 赞同：9
> 
> 时间：2013-02-23T15:04:28.737
> 
> 标签：javascript, ruby-on-rails, mustache

以下是资源：

**JSON**

```
{
  "badges":{
    "unlocked": [
      {"name": "Win 1"},
      {"name": "Win 2"},
      {"name": "Win 3"}
    ],
    "locked":[
      {"name": "Lose 1"},
      {"name": "Lose 2"},
      {"name": "Lose 3"}
    ]
  }
} 
```

**算法**

```
{{ if_has_badges }}
<div class="badges">
  <h1>Badges</h1>

  {{ if_has_badges_unlocked }}
    <div class="badges-unlocked">
      <h2>Unlocked!</h2>
      {{ loop_badges_unlocked }}
      <a href="#" class="badge">
        <strong>{{ name }}</strong>
      </a>
      {{ end_loop_badges_unlocked }}
    </div>
  {{ end_if_has_badges_unlocked }}

  {{ if_has_badges_locked }}
    <div class="badges-locked">
      <h2>Locked!</h2>
      {{ loop_badges_locked }}
      <a href="#" class="badge">
        <strong>{{ name }}</strong>
      </a>
      {{ end_loop_badges_locked }}
    </div>
  {{ end_if_has_badges_locked }}

</div>
{{ end_if_has_badges }} 
```

我如何编写这个算法来使用 Mustache 编译器？

我需要这样做才能与两个方面一起工作，第一个是 RubyOnRails 应用程序，第二个是客户端 (JavaScript)。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-23T15:08:10.790

您的问题有两种解决方案。

## 使用选择和反转选择

这是来自 mustache 文档的示例：

```
{
  "repos": []
} 
```

模板：

```
{{#repos}}<b>{{name}}</b>{{/repos}}
{{^repos}}No repos :({{/repos}} 
```

输出：

```
No repos :( 
```

正如你看到的倒选让我做条件逻辑。在您的情况下，它看起来像：

杰森：

```
var viewModel = {
    badges:[]//badges here
}
viewModel.anyBadges = badges.length >0; 
```

胡子：

```
 <div class="badges-unlocked">
   {{#anyBadges}}
      <h2>Unlocked!</h2>
   {{/anyBadges}}
   {{#badges_unlocked}}
      <a href="#" class="badge">
        <strong>{{ name }}</strong>
      </a>
   {{/badges_unlocked}} 
```

## 不要在无逻辑的模板中做逻辑

这就是我会做的。如果您的 Mustache 模板中有条件逻辑，我认为您做错了。您可以使用在这方面更先进的[Handlebars ，或者将您的逻辑移到其他地方（到您的 javascript）。](http://handlebarsjs.com/)

请参阅[Mustache 自述文件](https://github.com/janl/mustache.js)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-24T10:43:33.727

最好的答案（对于 Ruby 和 JavaScript）是将您的逻辑（`if_has_badges`类型问题）封装到 View 类中。

`length`实际上，您可以使用数组属性为 Ruby 和 JavaScript 中所需的一点逻辑伪造它：

```
{{# badges.length }}
<div class="badges">
  <h1>Badges</h1>

  {{# badges.unlocked.length }}
    <div class="badges-unlocked">
      <h2>Unlocked!</h2>
      {{# badges.unlocked }}
      <a href="#" class="badge">
        <strong>{{ name }}</strong>
      </a>
      {{/ badges.unlocked }}
    </div>
  {{/ badges.unlocked.length }}

  {{# badges.locked.length }}
    <div class="badges-locked">
      <h2>Locked!</h2>
      {{# badges.locked }}
      <a href="#" class="badge">
        <strong>{{ name }}</strong>
      </a>
      {{/ badges.locked }}
    </div>
  {{# badges.locked.length }}

</div>
{{/ badges.length }} 
```

但这有点肮脏的做法......

# php - POST 变量不变

> ID：15041931
> 
> 赞同：0
> 
> 时间：2013-02-23T15:04:51.840
> 
> 标签：php, javascript, forms

我有一个带有一些 jQuery UI 可排序的表单，这些表单的`data-`属性被序列化到隐藏的文本框中，所以当我发送表单时，我的 PHP 脚本可以查看`$_POST["contents"]`（这是一个像这样的字符串`1-2-2-1`）的值并将其传递给我的 MySQL更新查询。问题是，在发送表单（来自 javascript）之前，文本框的报告值与`$_POST`.

**表格：**

```
<form method="post" action="?update">
    <input type="text" name="id" style="display:none" value="1" />
    <input type="text" name="path" placeholder="Endereço Ex.: /pacotes/pureenergy" value="/some/path" /> <input type="text" name="title" placeholder="Título da página" value="<?php echo $t;?>" /><br />
    <!-- Some stuff hidden for briefness -->
    <input type="text" id="ci" name="contents" style="display:none" value="1-2-2-1" />
    <input type="submit" value="Atualizar página" onclick="updateForm()">
</form> 
```

**Javascript：**

```
function updateForm() {
    var txt = $("#dropzone li:first-of-type").data("id");
    $("#dropzone li:not(:first-of-type)").each(function() {
        txt = txt+"-"+$(this).data("id");
    });
    $("#ci").text(txt);
    alert(txt);
} 
```

**PHP：**

```
$id = $_POST["id"];
$p = $_POST["path"];
$t = $_POST["title"];
$c = $_POST["contents"];
mysql_query("UPDATE aruna.pages SET path='$p', title='$t', contents='$c' WHERE id=$id") or die(mysql_error()); 
```

javascript 报告的值`alert()`符合预期，但是当我发送表单时， 的值`$_POST["contents"]`与 HTML 中硬编码的值相同。

**编辑：** PHP 不会抱怨`$_POST["contents"]`未设置，如果有错字，它会抱怨。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:09:26.190

您可以尝试 .val() 而不是 .text()

# jackson - 为什么@JsonTypeInfo 不与@JsonIdentityInfo 一起使用？

> ID：15041933
> 
> 赞同：3
> 
> 时间：2013-02-23T15:04:56.763
> 
> 标签：jackson

@JsonIdentityInfo 按预期使用以下类：

基类：

```
@JsonIdentityInfo(generator =  ObjectIdGenerators.PropertyGenerator.class, property = "uuid")
public class TestEntityBas {
    @JsonProperty
    public String uuid = "0001";
} 
```

子类：

```
public class TestEntityGoa extends TestEntityBas  {
    @JsonProperty
    public String texten = "This is text!";
} 
```

容器类：

```
public class TestEntity {
    @JsonProperty
    String stringer = "Hej hopp!";

    @JsonIdentityReference(alwaysAsId = true)
    public TestEntityGoa goa = new TestEntityGoa(); 
} 
```

结果如预期：

```
{"stringer":"Hej hopp!","goa":"0001"} 
```

当我像这样将@JsonTypeInfo 添加到基类时：

```
@JsonTypeInfo(use=JsonTypeInfo.Id.CLASS, include=JsonTypeInfo.As.PROPERTY, property="@class")
@JsonIdentityInfo(generator =  ObjectIdGenerators.PropertyGenerator.class, property = "uuid")
public class TestEntityBas {
    @JsonProperty
    public String uuid = "0001";
} 
```

现在整个 TestEntityGoa 像这样被序列化：

```
{"stringer":"Hej hopp!","goa":{"@class":"com.fodolist.model.TestEntityGoa","uuid":"0001","texten":"This is text!"}} 
```

即使我在同一类中使用@JsonTypeInfo 和@JsonIdentityInfo，我也希望得到第一个结果。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T19:36:22.457

我在这里看不到任何明显的错误，所以你可能发现了一个错误。类型和身份信息的组合处理起来有点棘手，因此可能存在尚未按预期工作的边缘情况，那么您能否为此在 Github 问题跟踪器中提交错误？

# mysql - 查询以获取用户的详细信息

> ID：15041935
> 
> 赞同：0
> 
> 时间：2013-02-23T15:04:57.730
> 
> 标签：mysql, sql, select, join

这是我的[查询](http://sqlfiddle.com/#!2/30321/25)，它生成下表

```
SELECT user_messages.messageid,user_messages.message,
user_messages.sentby,user_messages.visibility,

(
   SELECT GROUP_CONCAT(  `post_images`.`image_id` SEPARATOR ';')
    FROM  `post_images`
    JOIN user_messages
  ON `post_images`.`messageid` =user_messages.messageid
) AS  `Image_post_id`,
(
   SELECT GROUP_CONCAT(  `post_images`.`small_pic_path` SEPARATOR ';')
    FROM  `post_images`
    JOIN user_messages
  ON `post_images`.`messageid` =user_messages.messageid
) AS Small_pic_path,
(
  SELECT count(*) FROM likes
  WHERE element_id=user_messages.messageid
  )AS Total_Likes

FROM user_messages
WHERE user_messages.userid='1'; 
```

![sql表](../Images/9686affd629980c24d7f69be479d3f6a.png)

在这里，我想包含 sendby 的详细信息，**它**是 smsusers 表中的 id。我想要来自 smsusers 表的 fname、lname 和 profile_pic 表中的 small_pic_path 的详细信息。如何获取详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:06:32.673

```
SELECT  user_messages.messageid,
        user_messages.message,
        user_messages.sentby,
        user_messages.visibility,
        (
            SELECT  GROUP_CONCAT(  `post_images`.`image_id` SEPARATOR ';')
            FROM    `post_images`
                    JOIN user_messages
                        ON `post_images`.`messageid` =user_messages.messageid
        )   AS  `Image_post_id`,
        (
            SELECT GROUP_CONCAT(  `post_images`.`small_pic_path` SEPARATOR ';')
            FROM  `post_images`
            JOIN user_messages
                ON `post_images`.`messageid` =user_messages.messageid
        ) AS Small_pic_path,
        (
            SELECT count(*) 
            FROM likes
            WHERE element_id=user_messages.messageid
        ) AS Total_Likes, 
        smsusers.*  -- select the columns you want to show
FROM    user_messages
        INNER JOIN smsusers 
        ON user_messages.SENTBY = smsusers.id
WHERE   user_messages.userid= '1'; 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/30321/26)

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

# php - 使用 Ajax 显示从数据库中获取的图像

> ID：15041936
> 
> 赞同：0
> 
> 时间：2013-02-23T15:05:05.477
> 
> 标签：php, mysql, ajax

我正面临着 Ajax 的显示图像。我不知道为什么它不在 div 标签中绘制图像。当我将操作放入表单标记并将其发送到 find.php 时它可以工作，但不能与 Ajax 一起使用

```
//display.php
<script>
$(document).ready(function() {

var str = 'img_arr='+ img_arr + '&img_url=' + img_url ;

if (window.XMLHttpRequest){
   xmlhttp=new XMLHttpRequest();
}else{// code for IE6, IE5
   xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}
 xmlhttp.onreadystatechange=function(){
   if (xmlhttp.readyState==4 && xmlhttp.status==200){
   document.getElementById("here").innerHTML=xmlhttp.responseText;
 }
}

 xmlhttp.open("GET","find.php?"+str,true);
 xmlhttp.send();
});
</scrpt>

<input type="text" id="img_url" name="img_url" value="google.com" />
<input type="text" id="img_arr" name="img_arr"  value="img.jpg" />
<div id="here"></div>

//find.php

<?
  $q = "...." 
  $r = @mysqli_query($dbc,$q);

  while($row = @mysqli_fetch_array($r)){
     echo ("<img src='button.png' style='margin-left:".$row['x_coord'].";margin-top:".$row['y_coord']."; position:absolute;' />");  
  }

?> 
```

# linux - 配置：错误：C 预处理器未通过完整性检查

> ID：15041937
> 
> 赞同：9
> 
> 时间：2013-02-23T15:05:15.590
> 
> 标签：linux, compiler-errors, configure, icc

我正在 Ubuntu 12.04 x86_64 上编译几个库。首先，我用 GCC 4.7.2 编译了库，一切顺利。然后我尝试使用 Inte Composer 2013 u2 重新编译它们。为了这个目的，我做了：

```
export CC=/opt/intel/composer_xe_2013.2.146/bin/intel64/icc
export CPP=/opt/intel/composer_xe_2013.2.146/bin/intel64/icpc 
```

然后我运行`./configure`并收到以下错误：

```
checking how to run the C preprocessor... /opt/intel/composer_xe_2013.2.146/bin/intel64/icpc
configure: error: in `/var/www/workspace/freetype/freetype-2.4.11/builds/unix':
configure: error: C preprocessor "/opt/intel/composer_xe_2013.2.146/bin/intel64/icpc" fails sanity check
See `config.log' for more details
make: *** [setup] Error 1 
```

配置日志文件包含此错误：

```
configure:3345: checking how to run the C preprocessor
configure:3415: result: /opt/intel/composer_xe_2013.2.146/bin/intel64/icpc
configure:3435: /opt/intel/composer_xe_2013.2.146/bin/intel64/icpc  conftest.c
conftest.c(14): error: identifier "Syntax" is undefined
             Syntax error
             ^

conftest.c(14): error: expected a ";"

compilation aborted for conftest.c (code 2)

configure:3435: $? = 2
configure: failed program was:
| /* confdefs.h */
| #define PACKAGE_NAME "FreeType"
| #define PACKAGE_TARNAME "freetype"
| #define PACKAGE_VERSION "2.4.11"
| #define PACKAGE_STRING "FreeType 2.4.11"
| #define PACKAGE_BUGREPORT "freetype@nongnu.org"
| #define PACKAGE_URL ""
| /* end confdefs.h.  */
| #ifdef __STDC__
| # include <limits.h>
| #else
| # include <assert.h>
| #endif
|            Syntax error
configure:3435: /opt/intel/composer_xe_2013.2.146/bin/intel64/icpc  conftest.c
conftest.c(14): error: identifier "Syntax" is undefined
             Syntax error
             ^

conftest.c(14): error: expected a ";"

compilation aborted for conftest.c (code 2) 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-27T22:40:39.733

问题很可能是表示“你的 C++ 编译器”的 GNU make 隐式变量不是`CPP`but `CXX`，而`CPP`表示“你的 C 预处理器”的隐式变量是；所以你的

```
export CPP=/opt/intel/composer_xe_2013.2.146/bin/intel64/icpc 
```

告诉`configure`icpc 是预处理器，并且`CXX`可能默认为 g++。

错误支持这一点`./configure`：

> 检查如何运行 C 预处理器... /opt/intel/composer_xe_2013.2.146/bin/intel64/icpc

尝试：

```
export CXX=/opt/intel/composer_xe_2013.2.146/bin/intel64/icpc 
```

要不就：

```
./configure CXX=/opt/intel/composer_xe_2013.2.146/bin/intel64/icpc 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-08-05T10:41:00.107

FWIW，我今天遇到了这个问题，我的解决方案是

`export CPP='<path to icpc> -E'`

也就是说，告诉 configure 预处理器应该与`-E`标志一起运行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-11T06:30:26.843

谢谢 Menno，在我的情况下，出口并没有完全做到这一点，但它已经接近了。通过 CPP=... 进行配置就可以了：

```
mkdir build
cd build
../configure --prefix=/usr/local/gcc/ CC=/usr/local/gcc/bin/gcc \
 CXX=/usr/local/gcc/bin/g++ CPP='/usr/local/gcc/bin/g++ -E' 
```

# c++ - 理解“文件编码”的概念

> ID：15041938
> 
> 赞同：2
> 
> 时间：2013-02-23T15:05:21.370
> 
> 标签：c++, file, encoding

我已经在网上浏览了一些东西，SOF 解释了“文件编码”，但我仍然有疑问。文件是一组相关的记录，在磁盘上，它的内容只是存储为'1'和'0'。每次，一个正在运行的程序想要读入一个文件或写入该文件，该文件就会被带入 RAM 并放入正在运行的程序（又名进程）的地址空间中。现在是什么决定了文件中的位（或字节）应该如何解码/编码以及读取和显示/写入？

关于 SOF 有一种解释，它读作“在存储级别，文件包含一个字节数组。除此之外，您还有文本文件的编码层。格式层位于最后，位于文本文件的编码层之上，或位于所有其他二进制文件的字节数组之上。我对此很好，但想知道它是否 100% 正确。

这个问题基本上是在理解 C++ 中的文件打开模式时出现的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:26:12.420

让我们看看这是否有帮助......

一个 Unix 文件只是一个位数组 (1/0)，文件中当前的最小位数是 8，即 1 个字节。所有文件交互都在不低于字节级别完成。在当今的大多数系统上，您实际上不必担心文件的最大大小。操作系统中仍然存在一些小的差异，但如果没有最大大小小于 1 GB 的系统，则很少有差异。

文件的编码或格式仅取决于使用它的应用程序。

有许多常见的文件格式，例如“unix ASCII 文本”和 PDF。您将遇到的大多数文件都会在网络上的某个地方有文档化的格式规范。例如，“Unix ASCII 文本文件”的规范是：

一组 ascii 字符，其中每行都以行尾字符结尾。行尾字符在 c++ 中指定为 std::endl' 或带引号的“\n”。Unix 将此字符指定为二进制值 - 012(oct) 或 00001010。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:41:04.807

如何编码/显示某些东西的决定完全取决于程序的设计者。当然，某些类型的文件有标准——PDF 或 JPG 文件的内容有标准格式。PDF 和 JPG 的定义都相当复杂。

文本文件至少有一些标准——但是如何解释或使用文本文件的内容可能与 JPEG 一样复杂和令人困惑——唯一的区别是内容是（某种）文本，所以你可以在文本编辑器中加载它并尝试理解它。但请参阅下面的“数据库类型应用程序中的文本”示例行。

在 C 和 C++ 中，基本上只有一个区别，文件是“二进制”或“文本”（“非二进制”）。不同之处在于“特殊位”的处理，主要与“结尾”有关 - 文本文件将包含行尾标记或换行符（`'\n'`）[更多关于换行符]，并且在某些操作系统中，也包含“文件结束标记” - 例如在旧 CP/M 中，文件大小为 128 或 256 字节的块。所以如果我们有`"Hello, World!\n"`在文本文件中，该文件的长度为 128 个字节，其余 114 个字节将是“文件结束”标记。大多数现代操作系统以字节为单位跟踪文件大小，因此不需要在文件中包含文件结束标记。但是 C 支持许多新旧操作系统，因此该语言对此有所考虑。文件结尾通常是 CTRL-Z（DOS、Windows 等）或 CTRL-D（Unix - Linux 等）。当 C 运行时库遇到文件结尾字符时，它将停止读取并给出错误代码/行为，就像“这里没有要读取的文件”一样。

行尾或换行需要特殊处理，因为它们在文件所在的操作系统中并不总是相同的。例如，Windows 和 DOS 使用“回车换行”（CR、LF - CTRL-M、CTRL-J、ASCII 13 和 10 分别）作为行尾。在各种形式的 Unix 中（例如 Linux、MacOS X 和 BSD），行尾是单独的“换行符”（LF、CTRL-J）。在较旧的 MacOS 中，行尾仅是“回车”。因此，作为程序员的您不必担心行结束的确切方式，C 运行时库会将“本机”行尾转换为标准化的行尾`'\n'`（转换为“换行”或字符值 10)。当然，这意味着C运行时库需要知道“如果有一个CR后跟LF，

对于二进制文件，我们真的不希望对数据进行任何转换，仅仅因为我们的像素恰好是彼此相邻的值 13 和 10，并不意味着我们希望将其合并为单个 10 字节，对吗？如果代码读取值 26 (CTRL-Z) 或 4 (CTRL-D) 的字节，我们当然不希望输入停在那里......

现在，如果我有一个包含以下内容的数据库文本文件：

```
 10 01353-897617 14000 Mats 
```

你可能几乎不知道这意味着什么——我的意思是你可能知道“垫子”是我的名字——但也可能是那些放在眼镜下的小纸板东西（又名“啤酒垫”）或其他东西在地板上，例如为穆斯林准备的“祈祷垫”。

数字 10 可以是客户编号、商品编号、“行号”或类似的东西。01353-896617 几乎可以是任何东西——也许是我的电话号码[不，不是，但确实很像]——但它也可以是“制造商零件号”或某种形式的序列号等。14000？每件商品的价格、库存单位的数量、我的薪水 [我希望不会！]、从我的地址到澳大利亚悉尼的距离（我想大概是）。

我敢肯定，没有其他任何东西的其他人可能会想出数百个其他答案。

[事实是，为了这个答案的目的，它只是胡说八道，除了“电话号码”开头的那位，这是一个有效的英国区号 - 重点是解释“a的含义只有在描述字段含义的内容时才能理解文本文件中的字段集"]

当然，这同样适用于二进制文件，只是由于缺少分隔符，通常更难弄清楚内容是什么——如果上面的文本中没有空格和破折号，那就更难了知道什么属于哪里，对吧？二进制文件中通常没有“空格”和其他类似的东西。这完全取决于某人在某处代码中的描述或定义，或类似的东西。

我希望我在这里的漫谈能给你一些想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-23T17:12:19.127

我认为这里对层顺序的描述令人困惑。我会认为格式和编码是相关的，但不会紧密联系在一起。让我们尝试正式定义它。

文件是连续的字节序列*。*一个*字节*是一个连续的位序列。

*符号*是数据的单位。字节是一种符号。还有其他不是字节的符号。考虑数字 6 - 它是一个符号，但不是一个字节。然而，它可以被编码为一个字节，通常为`00000110`（这是 6 的二进制补码编码）。

*编码*将一组符号映射到另一组符号。最常见的是，它从一组非字节符号映射到字节，当应用于整个文件时，它会成为*文件编码*。二进制补码给出数值的表示。另一方面，例如，ASCII 以字节表示拉丁字母和相关字符。如果你把 ASCII 应用到一个文本字符串上，比如“Hello, World!”，你会得到一个字节序列。如果将此字节序列存储为文件，则文件编码为 ASCII。

*格式*描述了一组有效的符号序列。当应用于文件的字节时，它是一种*文件格式*。一个例子是用于存储光栅图形的 BMP 文件格式。它指定开头必须有几个字节来标识文件格式为 BMP，后跟几个字节来描述图像的大小和深度，依此类推。不是文件格式的格式示例是我们如何用英语编写十进制数字。基本格式是一系列数字字符，后跟一个可选的小数点和更多的数字字符。

### 文本文件

*文本文件*是一种格式非常简单的文件。它的格式非常简单，因为它没有结构。它立即以字符的某种编码开始，并以最终字符的编码结束。通常没有页眉或页脚或元数据或类似的东西。您只需从头开始将字节解释为字符。

但是你如何解释文件中的字符呢？这就是编码的用武之地。如果文件被编码为 ASCII，则该字节`01000001`表示拉丁字母 A。还有更复杂的编码，例如 UTF-8。在 UTF-8 中，字符不一定用单个字节表示。有些可以，有些不能。您从第一个字节的前几位确定要解释为字符的字节数。

当您在您最喜欢的文本编辑器中打开文件时，它如何知道如何解释字节？嗯，这是一个有趣的问题。文本编辑器必须确定文件的编码。它可以尝试以多种方式做到这一点。有时文件名通过其扩展名给出提示（`.txt`可能至少与 ASCII 兼容）。有时文件的第一个字符可以很好地提示编码是什么。但是，大多数文本编辑器都会让您选择指定将文件视为哪种编码。

文本文件可以有格式。通常格式完全独立于文本的编码。也就是说，格式根本没有描述有效的字节序列。相反，它描述了有效的字符序列。例如，HTML 是一种用于标记文档的文本文件格式。它描述了确定文档内容的字符序列（注意：不是字节序列）。例如，它表示字符序列`<html>`是一个开始标签，并且必须在某个点后跟结束标签`</html>`。当然，格式[比这要详细得多](http://www.whatwg.org/html)。

### 二进制文件

*二进制文件*是具有由其文件格式决定的含义的文件。文件格式描述了文件中有效的字节序列以及该序列的含义。在文件格式级别重要的不是对字节的某种解释——而是字节的顺序和排列。

如上所述，BMP 文件格式提供了一种存储光栅图形的方法。它说前两个字节必须是`01000010 01001101`，接下来的四个字节必须给出文件的大小作为字节数的计数，依此类推，直到实际的像素数据。

二进制文件可以在其中包含编码。为了说明这一点，请考虑前面的示例。我说过 BMP 文件中前两个字节后面的四个字节给出了文件的大小（以字节为单位）。这些字节是如何解释的？BMP 文件格式声明这些字节将大小作为无符号整数给出。这是这些字节的编码。

因此，当您浏览计算机上的目录以查找 BMP 文件并打开它时，您的系统如何知道如何打开它？它如何知道使用哪个程序来查看它？与文本文件的编码相比，文件扩展名更强烈地暗示二进制文件的格式。如果文件名`.bmp`末尾有，您的系统可能会认为它是一个 BMP 文件，只需在您拥有的任何图形程序中打开它即可。它还可能会查看前几个字节并查看它们的建议。

### 概括

理解文件中字节含义的第一层次是该文件的格式。文本文件的格式非常简单——从头开始，解释字符直到结束。您如何解释字符取决于该文本文件的字符编码。然而，大多数格式都更复杂，并且可能会在其中嵌套编码。在某种程度上，你必须开始从你的字节中提取抽象信息，这就是编码开始的地方。但是任何被编码的东西也可以有一个应用到它的格式。在获得所需信息之前，您拥有一系列格式和编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-23T15:18:43.360

所以基本上我们主要讨论的是文本文件，对吧？

现在重点：当您的文本编辑器将文件加载到内存中时，它会根据一些信息推断出其文件编码（您告诉它，或者它在文件的前几个字节中具有特殊的文件格式标记，或其他）。然后**是程序本身决定它如何处理原始字节。**

例如，如果您告诉文本编辑器以 ASCII 格式打开文件，它会将每个字节视为一个单独的字符，并且`A`只要遇到数字 65 作为当前要显示的字节，它就会显示该字符，等等（因为 65 是)的 ASCII 字符代码`A`。

但是，如果您告诉它以 UTF-16 格式打开文件，那么它将一次抓取两个字节（更准确地说，是两个*八位字节*），它将使用这个所谓的“单词”作为数值查找，例如，`ç`当它读取的两个字节对应于`231`的 Unicode 字符代码时，它将显示一个字符`ç`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-23T15:17:31.617

> 现在是什么决定了文件中的位（或字节）应该如何解码/编码以及读取和显示/写入？

文件的格式，很明显。如果您正在读取 BMP 文件，则必须先读取文件头，然后读取`height`*`width`像素数据。如果您正在阅读`.txt`，请按原样阅读字符。文本文件可以有不同的*编码*，例如 Unicode。

某些格式（例如`.png`.

具体算法的选择取决于各种因素。在 Windows 上，重要的通常是扩展名。在网络中，`content type`占主导地位。

一般来说，如果你尝试读取其他格式的文件，你通常会得到垃圾。有时可能会被迫这样做：`.bmp`例如，尝试在文本编辑器中打开文件。

# ios - iOS 设置包：如何验证输入

> ID：15041942
> 
> 赞同：1
> 
> 时间：2013-02-23T15:05:37.533
> 
> 标签：ios, objective-c, cocoa-touch, settings, nsuserdefaults

我想将数值存储在 iOS 设置包中。但是，我没有找到限制这些值的有效范围的方法。

是否可以输入最小和最大范围或检查代码中的范围？

使用滑块时，可以通过设置最小值和最大值来限制范围。但是，不会显示用户选择的实际值。除了滑块之外，是否可以显示实际值？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:10:04.640

您可以将滑块单元格的`showValue`键设置`<true />`为显示其值，如此[处](http://iphonedevwiki.net/index.php/Preferences_specifier_plist#Slider_and_switch_cells)所述。

# mongodb - 有没有办法以 unix 格式向 ISODate 显示时间戳？

> ID：15041953
> 
> 赞同：14
> 
> 时间：2013-02-23T15:07:02.843
> 
> 标签：mongodb, mongodb-query, aggregation-framework

我们在 MongoDB 中使用 unix 时间戳存储了一个日期，我如何在查询时获取日期？有没有办法以 ISODate 格式显示时间戳？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-01T13:34:53.070

### 背景

*   unixtime值表示自*纪元*（1970 年 1 月 1 日）以来的[秒数。](http://en.wikipedia.org/wiki/Unixtime)

**   [JavaScript Date()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date) 表示自纪元以来的 毫秒*数。*

    *   在 MongoDB 中，[`ISODate()`](http://docs.mongodb.org/manual/core/shell-types/#date)它是一个方便的包装器`Date()`，允许您从`mongo`shell 中的 ISO 字符串创建日期。如果`new Date()`在 shell 中使用，它将返回一个`ISODate()`.* 

 *### 转换

要在 a`unixtime`和 ISODate() 之间进行转换，您可以将 unix 时间戳乘以 1000，然后将此值传递给`new Date()`构造函数。

### `mongo`shell中的一个简单示例：

```
> db.mydata.insert({
    unixtime: 1362143511
})

> var doc = db.mydata.findOne();

// convert unixtime seconds to milliseconds and create JS date
> var date = new Date(doc.unixtime * 1000);

> date
ISODate("2013-03-01T13:11:51Z") 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-07-27T21:52:48.417

MongoDB 4.0 引入了[`$toDate`](https://docs.mongodb.com/manual/reference/operator/aggregation/toDate/)聚合，大家可以试试

```
db.collection.aggregate([
  { "$project": {
    "toDate": {
      "$toDate": "$unixTimestamp"
    }
  }}
]) 
```

[在这里](https://mongoplayground.net/p/6-RYH1VqZ09)试试

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-23T20:18:12.670

`Date`在 Mongo 控制台中，您可以在文档打印到屏幕之前根据时间戳创建 JavaScript对象：

```
> db.stuff.find().forEach(function (doc) {
  doc["timestamp_field"] = new Date(doc["timestamp_field"])
  printjson(doc)
}) 
```

请注意该代码，与常规代码不同，`find()`它不会对结果进行分页，而是在不暂停的情况下打印每个匹配的文档。*

# c# - 实例化委托的各种方式之间的区别（Func )?

> ID：15041955
> 
> 赞同：8
> 
> 时间：2013-02-23T15:07:08.517
> 
> 标签：c#, syntax, delegates, anonymous-function, func

**1**：

```
Func<int, int> myFunc = new Func<int,int>(delegate(int x) {
    return x + 1;
}); 
```

**2**：

```
Func<int, int> myFunc = delegate(int x) {
    return x + 1;
}; 
```

**3**：

```
Func<int, int> myFunc = x => x + 1; 
```

它们之间有什么区别？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-23T15:09:15.580

它们都是一样的——只是编译成相同东西的[语法糖。](http://en.wikipedia.org/wiki/Syntactic_sugar)

也就是说 - 使用类型推断和其他编译器好东西，3 只是说 1 的一种非常短的方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-23T15:10:09.690

他们都是一样的。前两个是[*匿名方法*](http://msdn.microsoft.com/en-gb/library/0yw3tz5k.aspx)的例子。[*最后一个是lambda 表达式*](http://msdn.microsoft.com/en-gb/library/bb397687.aspx)的示例。匿名方法和 lambda 表达式统称为*匿名函数*。

C# 2 中引入了匿名方法；lambda 表达式是在 C# 3 中引入的，主要取代了匿名方法。请注意，lambda 表达式也可以转换为将代码表示为数据而不是 IL 的[*表达式树*](http://msdn.microsoft.com/en-us/library/bb397951.aspx)以及委托。

请注意`Func<TResult>`，`Func<T, TResult>`等只是委托类型的示例。您可以将匿名函数转换为任何兼容的委托类型。例如：

```
public delegate int Foo(string x);

Foo foo = text => text.Length; 
```

# php - 像 Google 一样使用布尔运算符（AND、OR、NOT）搜索字符串中的单词

> ID：15041957
> 
> 赞同：0
> 
> 时间：2013-02-23T15:07:14.243
> 
> 标签：php, javascript, regex, perl

我想使用“或”、“与”和“非”等运算符在具有“*谷歌”风格的字符串中进行搜索。*可以在正则表达式中模拟这个运算符吗？

例如，我想使用单词“Javascript”、“PHP”和“Perl”在给定的字符串中进行以下搜索。

1.  Javascript 和 PHP
2.  Javascript而不是PHP
3.  Javascript 和 PHP 和 Perl
4.  Javascript 和（PHP 或 Perl）

PS：我不介意区分大小写的问题，因为所有重要的语言都有一个选项。

评论后编辑：很明显，可以使用多个模式匹配扫描运行任何布尔表达式，但是，在单个正则表达式中考虑解决方案很有趣。此外，“前瞻”功能可以解决非常复杂的模式匹配问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-23T15:07:14.243

**是的！**

感谢*“期待”运算符，它是在**Perl*语言的正则表达式语法中引入的。*Perl* RegEx 框架被许多语言使用，包括*PHP*和*Javascript*。

Perl 中也存在*“look behind”*运算符，但*Javascript*不支持它。

下面，我展示了用于搜索的带有*JavaScript*语法的正则表达式：

**1-**搜索*（“Javascript”和“PHP”）*

```
 S = "Javascript is a client language and PHP is a server language";
       patt = /^(?=.*Javascript).*PHP/;    
       if ( S.match(patt) ) 
         document.write("Found it!"); 
       else 
          document.write("Not Found"); 
```

它打印**“找到它”**。

**2-**现在搜索*（“Javascript”而不是“PHP”）*

```
 S = "Javascript is a client language and PHP is a server language"; 
     patt = patt = /^(?!.*PHP).*Javascript/;
     if ( S.match(patt) ) 
       document.write("Found it!"); 
     else 
       document.write("Not Found"); 
```

它打印**“未找到”**，因为 PHP 包含在字符串中。

**3-**第三次搜索是*（“Javascript”和“PHP”和“Perl”）*

```
 S = "Javascript rules, PHP are in most server, however Perl is inspiring";
    patt = /^(?=.*Javascript)^(?=.*PHP).*Perl/;
    if ( S.match(patt) ) 
       document.write("Found it!"); 
    else 
       document.write("Not Found"); 
```

它打印**“找到它！”** .

**4-**最后，最后一种情况是（*“Javascript”*和（*“PHP”*或*“Perl”*））。没有什么不同，我只是使用带括号的传统分组（圆括号）：

```
 S = "Javascript rules, however Perl is inspiring"; 
    patt = /^(?=.*Javascript)(.*PHP|.*Perl)/;
    if ( S.match(patt) ) 
       document.write("Found it!"); 
    else 
       document.write("Not Found"); 
```

它打印**“找到它！”** 因为缺少 PHP，但 Perl 在字符串中。

**评论后编辑：**

我已经承认了。“向前看”的语法很糟糕。但是，这很容易理解。扫描仪看着但不要走路！

```
 patt = /Bee (?=Gees)/;     // patt = patt1(?=patt2) => patt1 + patt2 
        S = "Bee Gees";
        if (S.match(patt)) 
              document.write('ok');  // print OK and cursor stops at "G" 
```

那是积极的展望

```
 patt = /Bee (?!Gees)/;   // patt = patt1(?!patt2) => patt1 + Not (patt2) 
       S = "Bee Gees";         
       if (S.match(patt)) 
             document.write('ok'); // it does not match
       S = "Bee Goes";         
       if (S.match(patt)) 
             document.write('ok'); // print OK and cursor stops at "G" 
```

那是消极的期待

好消息是**Patt2**可以是一个复杂的模式，具有分组、子分组等。

*最后解释：*

*   .* : 0 个或多个字符
*   ^ : 如果是字符串的开头，则匹配。它不移动光标。
*   $ : 匹配如果是字符串的结尾。它不移动光标。
*   (p1|p2|...) ：如果**p1**或**p2**或 ... 匹配，则匹配。

所以

```
 patt = /^(?=.*Javascript).*PHP/; 
```

是一个正则表达式（**/**是一个正则表达式分隔符，作为字符串的引号），表示**期待**（跳转字符直到找到“Javascript”），如果成功，跳转字符直到找到“PHP” *（请记住，期待不会'不要移动光标！）* 即，如果扫描仪找到“Javascript”，“PHP”就匹配。

# java - 杰克逊序列化没有正确处理单引号

> ID：15041958
> 
> 赞同：10
> 
> 时间：2013-02-23T15:07:16.680
> 
> 标签：java, javascript, json, spring, jackson

由于与 Spring 框架的集成，我刚刚开始使用 Jackson，并且遇到了值中单引号的问题。尝试在页面上使用 jQuery 解析 JSON 时，出现 JavaScript 错误`"SyntaxError: missing ) after argument list"`。我习惯于使用 Gson 来序列化我的对象，并且不会遇到这个问题，因为 Gson 会用 Unicode \u0027 替换单引号。

例如;
**爪哇**

```
public final class Person {
  private String firstName;
  private String lastName;

  public Person() {}

  public void setFirstName(String firstName) {
    this.firstName = firstName;
  }

  public String getFirstName() {
    return firstName;
  }

  public void setLastName(String lastName) {
    this.lastName = lastName;
  }

  public String getLastName() {
    return lastName;
  }
} 
```

**JSON**
在杰克逊 `[{"person":{"firstName":"James","lastName":"O'tool"}}]`
在Gson `[{"person":{"firstName":"James","lastName":"O**\u0027**tool"}}]`

**JavaScript**；
`// This is where the JavaScript fails with the Jackson serialized object
$.parseJSON('${requestScope.person}');`

我一直在寻找解决方案，但找不到。有谁知道是否可以像 Gson 一样配置 Jackson 来处理单引号？

感谢您的时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-25T19:32:22.683

另一个答案显示了一种方法，它应该工作得很好。

但是还有另一种方法可以做到这一点，它的工作量要少一些，在“[使用 Jackson 强制转义 JSON 中的 HTML 字符](http://www.cowtowncoder.com/blog/archives/2012/08/entry_476.html)” 中进行了解释

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T17:01:44.253

为了解决这个问题，我最终为 Jackson 创建了一个自定义字符串序列化程序。我从 Gson 那里借了一些资料。

```
 public class HtmlStringSerializer extends StdSerializer<String> {
      protected HtmlStringSerializer() { super(String.class); }

      private static final String[] HTML_SAFE_REPLACEMENT_CHARS;
      static {
        HTML_SAFE_REPLACEMENT_CHARS = new String[128];
        for (int i = 0; i <= 0x1f; i++) {
          HTML_SAFE_REPLACEMENT_CHARS[i] = String.format("\\u%04x", i);
        }
        HTML_SAFE_REPLACEMENT_CHARS['"'] = "\\\"";
        HTML_SAFE_REPLACEMENT_CHARS['\\'] = "\\\\";
        HTML_SAFE_REPLACEMENT_CHARS['\t'] = "\\t";
        HTML_SAFE_REPLACEMENT_CHARS['\b'] = "\\b";
        HTML_SAFE_REPLACEMENT_CHARS['\n'] = "\\n";
        HTML_SAFE_REPLACEMENT_CHARS['\r'] = "\\r";
        HTML_SAFE_REPLACEMENT_CHARS['\f'] = "\\f";
        HTML_SAFE_REPLACEMENT_CHARS['<'] = "\\u003c";
        HTML_SAFE_REPLACEMENT_CHARS['>'] = "\\u003e";
        HTML_SAFE_REPLACEMENT_CHARS['&'] = "\\u0026";
        HTML_SAFE_REPLACEMENT_CHARS['='] = "\\u003d";
        HTML_SAFE_REPLACEMENT_CHARS['\''] = "\\u0027";
      }

      @Override
      public void serialize(String string, JsonGenerator gen, SerializerProvider provider) throws IOException, JsonProcessingException {
        int last = 0;
        int length = string.length();
        StringBuilder sb = new StringBuilder(length);

        for (int i = 0; i < length; i++) {
          char c = string.charAt(i);
          String replacement;
          if (c < 128) {
            replacement = HTML_SAFE_REPLACEMENT_CHARS[c];
            if (replacement == null) { continue; }
          } else if (c == '\u2028') {
            replacement = "\\u2028";
          } else if (c == '\u2029') {
            replacement = "\\u2029";
          } else {
            continue;
          }
          if (last < i) {
        sb.append(string.substring(last, i));
          }
          sb.append(replacement);
          last = i + 1;
        }
        if (last < length) {
          sb.append(string.substring(last));
        }
        gen.writeString(sb.toString());
      }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-11T13:01:51.830

@Bergi 想说：不要使用：

```
$.parseJSON('${requestScope.person}') 
```

只需使用

```
${requestScope.person} 
```

直接地！

# html - 不会拉伸整个页面

> ID：15041960
> 
> 赞同：0
> 
> 时间：2013-02-23T15:07:20.140
> 
> 标签：html, css, background

我一直在制作一个网站，它一直运行良好，直到我尝试添加一些页内链接（这是一个相当大的页面）。所以我这样做了，然后背景不会延伸页面的整个长度。所以我会向下滚动，`<body>`嵌入在标签中的`<html>`标签覆盖了我电脑屏幕上的正确数量，但不是页面。我知道它是`<html>`标签的原因是在检查页面时，它显示`<html>`标签刚刚结束。所以然后我删除了我所做的事情，并且由于某种原因问题仍然存在。如果您需要更多信息，例如 .css 或编码，请告诉我。谢谢您的帮助。

* * *

这里有一些代码可以提供帮助。我只把内容放到标签停止的地方。

```
<link rel="stylesheet" type="text/css" href="http:**********/index.css>     
<title>School</title>
<div id="containerSchool" class="GenericContainerProperties1">
<div id="SchoolHeading1" class="GenericHeaderProperties1">
<span id="spanid1" class="spangroup1" ><a class="linktype1"href="***********">Home</a>
</span>
<span id="spanid2" class="spangroup1" ><a class="linktype1"href="*****/school/login.html">School</a></span>
<span class="spangroup1" ><a class="linktype1"href="**********/Testing/page.html">Testing</a></span>
</div>
<div id="SchoolBody1">
<p style="font-size:40px;text-align:center"><b>School</b></p>
<body>
<hr class="SchoolHrGroup1">
<p>Biology</p>
<table border="1" align="center">
<tr>
<td>Title</td>
<td>Link</td>
<td>Date Added</td>
<td>Latest Version</td>
<tr>
<td>Semester 1 Laps</td>
<td><a href="*******">0</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap I Notes</td>
<td><a href="********"target="new">1</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap II Notes</td>
<td><a href="*********" target="new">0</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap III Notes</td>
<td><a href="*********" target="new">1</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap IV Notes</td>
<td><a href="*********** target="new">0</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap V Notes</td>
<td><a href="************" target="new">1</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap VI Notes</td>
<td><a href="*********" target="new">0</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap VII Notes</td>
<td><a href="****************" target="new">1</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap IIX Notes</td>
<td><a href="**************" target="new">0</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Midterm Review</td>
<td><a href="*************">1</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Lap IX Notes</td>
<td><a href="*******" target="new">0</a></td>
<td>1/13/13</td>
<td>Yes</td>
<tr>
<td>Lap X Notes</td>
<td><a href="************" target="new">1</a></td>
<td>2/4/13</td>
<td>Yes</td>
<tr>
<td>Lap XI Notes</td>
<td><a href="***************" target="new">0</a></td>
<td>2/4/13</td>
<td>Yes</td>
<tr>
<td>Lap XII Notes</td>
<td><a href="*************" target="new">1</a></td>
<td>2/19/13</td>
<td>No</td>
<tr>
</table>
<hr class="SchoolHrGroup1">
<p style="text-align:center">Spanish</p>
<table border="1" align="center">
<tr>
<td>Title</td>
<td>Link</td>
<td>Date Added</td>
<td>Latest Version</td>
<tr>
<td>Semester 1 Laps</td>
<td><a href="*************">2</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Midterm Review</td>
<td><a href="****************">3</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
</table>
<hr class="SchoolHrGroup1">
<hr class="SchoolHrGroup1">
<p style="font-family:Liberation Serif;text-align:center">History</p>
<table border="1" align="center">
<tr>
<td>Title</td>
<td>LInk</td>
<td>Date Added</td>
<td>Latest Version</td>
<tr>
<td>Semester 1 Laps</td>
<td><a href="http://99.186.124.64/school/HistoryLaps.zip">4</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Midterm Study Guide</td>
<td><a href="http://99.186.124.64/school/FALLSEMESTER.docx">5</a></td>
<td>N/A</td>
<td>Yes</td>
<tr>
<td>Chapter 8 Notes...</td>
<tr>
<td>Section 1.1
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page1.jpg">6</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.2</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page2.jpg">7</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.3</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page3.jpg">8</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.4</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page4.jpg">7</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.5</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page5.jpg">8</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.6</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page6.jpg">7</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.7</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page7.jpg">8</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 1.8</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section1/Page8.jpg">7</a></td>
<td>1/14/13</td>
<td>Yes</td>
<tr>
<td>Section 2.1</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section2/Page1.jpg">8</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 2.2</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section2/Page2.jpg">7</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 2.3</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section2/Page3.jpg">8</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 2.4</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section2/Page4.jpg">7</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 3.1</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section3/Page1.jpg">8</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 3.2</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section3/Page2.jpg">7</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 3.3</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section3/Page3.jpg">8</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Section 3.4</td>
<td><a href="http://99.186.124.64/school/Chapter8/Section3/Page4.jpg">7</a></td>
<td>1/15/13</td>
<td>Yes</td>
<tr>
<td>Chapter 9</td>
<tr>
<td>Section 1.1</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page1.jpg">8</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 1.2</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page2.jpg">7</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 1.3</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page3.jpg">8</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 1.4</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page4.jpg">7</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 1.5</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page5.jpg">8</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 1.6</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page6.jpg">7</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 1.7</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section1/Page7.jpg">8</a></td>
<td>1/25/13</td>
<td>Yes</td>
<tr>
<td>Section 2.1</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section2/Page1.jpg">7</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 2.2</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section2/Page2.jpg">8</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 2.3</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section2/Page3.jpg">7</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 2.4</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section2/Page4.jpg">7</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 3.1</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section3/Page1.jpg">8</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 3.2</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section3/Page2.jpg">7</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 3.3</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section3/Page3.jpg">8</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Section 3.4</td>
<td><a href="http://99.186.124.64/school/Chapter9/Section3/Page4.jpg">7</a></td>
<td>1/29/13</td>
<td>Yes</td>
<tr>
<td>Chapter 10</td>
<tr>
<td>Section 1.1</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page1.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.2</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page2.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.3</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page3.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.4</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page4.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.5</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page5.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.6</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page6.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.7</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page7.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.8</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page8.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.9</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page9.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 1.10</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section1/Page10.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.1</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page1.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.2</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page2.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.3</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page3.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.4</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page4.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.5</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page5.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.6</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page6.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.7</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page7.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.8</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page8.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.9</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page9.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 2.10</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section2/Page10.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.1</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page1.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.2</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page2.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.3</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page3.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.4</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page4.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.5</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page5.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.6</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page6.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.7</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page7.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 3.8</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section3/Page8.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.1</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page1.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.2</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page2.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.3</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page3.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.4</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page4.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.5</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page5.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.6</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page6.jpg">8</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
<td>Section 4.7</td>
<td><a href="http://99.186.124.64/school/Chapter10/Section4/Page7.jpg">7</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
</table>
<hr class="SchoolHrGroup1">
Theology
<table border="1" align="center">
<tr>
<td>Title</td>
<td>Link</td>
<td>Date Added</td>
<td>Latest Version</td>
<tr>
<td>Lap I Notes</td>
<td><a href="https://www.evernote.com/shard/s238/sh/a0c556ea-131b-4cd6-bb58-8b76de14463f/56f7484459730261bf3dbd40293a5b92">9</a></td>
<td>1/16/13</td>
<td>Yes</td>
<tr>
<td>Lap II Notes</td>
<td><a href="https://www.evernote.com/shard/s238/sh/faf8bd81-26b0-45f6-81c9-b6b0a363d650/761637099b3070b10911b83ec7600632" target="new">10</a></td>
<td>2/4/13</td>
<td>Yes</td>
<tr>
<td>Lap III Notes</td>
<td><a href="https://www.evernote.com/shard/s238/sh/c28748b0-4a95-4c0d-b89d-6370a56600cd/3b9793830d55404d1aa84e7e9c159875" target="new">9</a></td>
<td>2/19/13</td>
<td>Yes</td>
<tr>
</table>
<a href="http://99.186.124.64/index.html"><img src="http://99.186.124.64/pics/SpanishMastiff.jpg" style="width:150;height:130;"></>
</body>
</div>
</div>
</html> 
```

* * *

一些 CSS

```
/*ID:containers*/
#containerSchool {border-color:blue;background-color:#B2CCFF}
#containerHome {border-color:#FF6600;background-color:#FF4040;border-color:red; }
#AuthenticationContainer {border-color:#003300; background-color:#00FF00; }
#LoginContainer {border-color:black; background color:white}
/*ID:contents*/
#Homebody {font-family:Arial; text-align:center; }
#SchoolBody1 {text-align:center; }
/*ID:spans*/
#span1 {color:white}
/*ID:headers*/
#HomeHeading1{background-color:#FF0000;text-align:left; }
#SchoolHeading1{background-color:blue;text-align:left }
#AuthenticationHeader {background-color:#003300;text-align:left}
#LoginHeader {background-color:red;text-align:left}
/*SPECIFIC TAGS*/
hr {color:blue}
html,body {width:100%;height:100%;margin:0;padding:5; }
body {font-family:Arial;text-align:center }
/*CLASSES*/
.linktype1 {color:white;text-decoration:none; }
.spangroup1 {margin-left:15px;margin-right:15px;font-size:20px }
.SchoolHrGroup1 {color:blue; }
.HomeHrGroup1 {Color:red; }
.GenericHeaderProperties1 {padding:13px; }
.GenericContainerProperties1 {border-style:ridge;height:100% }
.SpanTime { float:right; font-size: 15px; color:black; } 
```

好的，这就是一切。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-23T15:17:06.793

将 html 和 body 的高度和宽度设置为 100%，然后将 padding 和 margin 设置为零，以删除您在某些浏览器中可能在边缘发现的任何额外空间。所以我想补充一下朱利安的说法。

```
html, body {
width:100%;
height:100%;
margin:0;
padding:0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-23T15:09:28.503

您需要做的就是设置 html 的高度和宽度，也许还有 body：

```
html, body {
    width:100%;
    height:100%;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T18:41:13.867

好的，所以我发现了问题，我不应该在 css 文件中有任何高度。现在它只是包装内容，一切都适合在那里。

# ms-access - asp + msaccess ，比较表中的关键字

> ID：15041968
> 
> 赞同：0
> 
> 时间：2013-02-23T15:08:38.437
> 
> 标签：ms-access, asp-classic

希望有人已经这样做了，所以有一些代码可以帮助我

我目前有这个查询

```
ForumID = request("ID") 
QID = ForumID

DB.CreateQueryDef QID, "SELECT * FROM Topic WHERE Keywords = '" & QID & "' ORDER BY LastPost DESC" 
```

我所拥有的是一个包含主题的表格主题。我添加了一个字段关键字，其中包含关键字，例如“motocross、mx、motox”

我如何查询数据库，例如包含关键字 motocross 的任何表？

还有这怎么能用多个词

```
eg
two topics
topic1 -> Keywords motocross, mx
topic2 -> Keywords motocross, dance 
```

如果例如 search.asp?ID= 越野摩托车无关

它将在数据库中搜索两者，例如获取关键字字段包含查询中的 2 个单词中的任何一个或 4 个或更多单词的所有主题

也可以像这样的 youtube 进行相关搜索吗？

两个主题 topic1 -> 关键词 motocross, 1 topic2 -> 关键词 motocross, 2

例如 search.asp?ID=motocross 1

主题 1 将首先显示，因为查询中的两个词都匹配“motocross”和“1”，而 topic2 只有 motocross

是否可以这样做，以便计算关键字匹配

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T11:31:05.587

您需要使用“OR”进行查询 ....

我有 2 个关键字（汽车，公共汽车）所以我的查询就像

DB.CreateQueryDef QID, "SELECT * FROM Topic WHERE (Keywords = 'car' OR Keywords = 'Bus') ORDER BY LastPost DESC"

这只是作为静态查询的示例，您可以使用逗号分隔值的循环使其运行时..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T19:54:31.413

首先，您的查询字符串不应包含空格。使用不同的分隔符。A + 是一个很好的使用。因此，您的 URL 将类似于：search.asp?ID=motocross+1。

这会将您的关键字拆分为一个数组，然后一次取一个来构建 and 子句。替换删除了第一个 AND。

```
SQL = "SELECT * FROM Topic WHERE"
ForumID = request("ID")
QID = Split(ForumID, "+")
For Each KW in QID
    SQL = SQL & "AND Keywords Like '*" & QID & "*' "
Next
SQL = Replace(SQl, "WHEREAND", "WHERE")
SQL = SQL & " ORDER BY LastPost DESC" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-23T20:01:53.007

你试过用 LIKE 吗？

"从表中选择 * 字段 LIKE '%" & 值 & "%'"

# localization - 在 LightSwitch 中翻译选择列表

> ID：15041969
> 
> 赞同：0
> 
> 时间：2013-02-23T15:08:44.117
> 
> 标签：localization, visual-studio-lightswitch

是否可以翻译为 LightSwitch 实体属性定义的选择列表项的显示名称？

我希望能够在查看 SAME 记录时以他们的语言显示不同的用户翻译的显示名称，并在他们编辑记录时在自动完成组合框中显示翻译的名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-24T13:07:00.640

不是真的，不。这些值存储在*LSML*文件中，并且无法在运行时进行修改。如果您需要翻译这些值，则需要使用查找表（可能通过使用自定义 RIA 服务）而不是*选择列表*。

*选择列表*的优点是设置起来非常快速和容易。

*选择列表*的缺点是缺乏灵活性，甚至是可重用性（每次你想在某个地方使用它时都必须定义列表的值）。

# c# - C# - 绘制图像时 DrawIcon 不使用光标掩码（I 型光标示例）

> ID：15041970
> 
> 赞同：4
> 
> 时间：2013-02-23T15:08:58.943
> 
> 标签：c#, cursor, icons, screenshot

如果我在截屏时使用 DrawIcon，它可以正确绘制带有蒙版的 I 型光标，但如果我想在任何图像上使用 DrawIcon，则蒙版不起作用。

此 DrawIcon 示例正常工作：

```
 public static Image CaptureRectangleNative(IntPtr handle, Rectangle rect, bool captureCursor = false)
    {
        if (rect.Width == 0 || rect.Height == 0)
        {
            return null;
        }

        IntPtr hdcSrc = NativeMethods.GetWindowDC(handle);
        IntPtr hdcDest = NativeMethods.CreateCompatibleDC(hdcSrc);
        IntPtr hBitmap = NativeMethods.CreateCompatibleBitmap(hdcSrc, rect.Width, rect.Height);
        IntPtr hOld = NativeMethods.SelectObject(hdcDest, hBitmap);
        NativeMethods.BitBlt(hdcDest, 0, 0, rect.Width, rect.Height, hdcSrc, rect.X, rect.Y, CopyPixelOperation.SourceCopy | CopyPixelOperation.CaptureBlt);

        if (captureCursor)
        {
            Point cursorOffset = CaptureHelpers.ScreenToClient(rect.Location);

            try
            {
                using (CursorData cursorData = new CursorData())
                {
                    cursorData.DrawCursorToHandle(hdcDest, cursorOffset);
                }
            }
            catch (Exception e)
            {
                DebugHelper.WriteException(e, "Cursor capture failed.");
            }
        }

        NativeMethods.SelectObject(hdcDest, hOld);
        NativeMethods.DeleteDC(hdcDest);
        NativeMethods.ReleaseDC(handle, hdcSrc);
        Image img = Image.FromHbitmap(hBitmap);
        NativeMethods.DeleteObject(hBitmap);

        return img;
    }

    // This function inside CursorData class
    public void DrawCursorToHandle(IntPtr hdcDest, Point cursorOffset)
    {
        if (IconHandle != IntPtr.Zero)
        {
            Point drawPosition = new Point(Position.X - cursorOffset.X, Position.Y - cursorOffset.Y);
            NativeMethods.DrawIcon(hdcDest, drawPosition.X, drawPosition.Y, IconHandle);
        }
    } 
```

但是这个 DrawIcon 示例没有使用遮罩，因此 I 形图标变为白色，并且在白色背景中不可见：

```
 public void DrawCursorToImage(Image img, Point cursorOffset)
    {
        if (IconHandle != IntPtr.Zero)
        {
            Point drawPosition = new Point(Position.X - cursorOffset.X, Position.Y - cursorOffset.Y);

            using (Graphics g = Graphics.FromImage(img))
            {
                g.DrawIcon(Icon.FromHandle(IconHandle), drawPosition.X, drawPosition.Y);
            }
        }
    } 
```

我想如果我不使用桌面 hdc，那么 DrawIcon 就没有使用蒙版。如何修复 DrawCursorToImage 方法以便它可以正确使用光标掩码？顺便说一句，我读了这篇文章：[C# - Capturing the Mouse cursor image](https://stackoverflow.com/questions/918990/c-sharp-capturing-the-mouse-cursor-image)，它也没有解决我的问题。感谢您阅读本文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-01-13T22:15:59.557

对 DrawCursorToImage 的这种修改应该可以使它起作用，但我无法真正解释它为什么起作用：

```
public void DrawCursorToImage(Image img, Point cursorOffset)
{
    if (IconHandle != IntPtr.Zero)
    {
        Point drawPosition = new Point(Position.X - cursorOffset.X, Position.Y - cursorOffset.Y);

        using (Graphics g = Graphics.FromImage(img))
        {
            IntPtr hdc = g.GetHdc();
            using (Graphics gfx = Graphics.FromHdc(hdc))
            {
                // For some reason it is necessary to redraw the image here
                gfx.DrawImage(img, 0, 0);
                gfx.DrawIcon(Icon.FromHandle(IconHandle), drawPosition.X, drawPosition.Y);
            }
            g.ReleaseHdc();
        }
    }
} 
```

# java - 如何删除目录的文件而不是文件夹

> ID：15041971
> 
> 赞同：2
> 
> 时间：2013-02-23T15:09:02.173
> 
> 标签：java, delete-file

我创建了一些代码来删除文件夹中的所有文件，问题是虽然这很好，但我希望能够删除目录中的所有文件但保持文件夹完整，所以我不必进入每个文件夹并删除其中的文件，这是我当前的代码：

```
@ViewScoped
@ManagedBean
public class Delete {

    public void DeleteFiles() throws IOException {
        System.out.println("Called deleteFiles");
        File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/up617648/");

        String[] myFiles;
        if (file.isDirectory()) {
            myFiles = file.list();
            for (int i = 0; i < myFiles.length; i++) {
                File myFile = new File(file, myFiles[i]);
                System.out.println(myFile);
                myFile.delete();
            }
            DeleteFiles2();
        }

    }
    public void DeleteFiles2() throws IOException {
        System.out.println("Called deleteFiles2");
        File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/Uploaded/up617648/");

        String[] myFiles;
        if (file.isDirectory()) {
            myFiles = file.list();
            for (int i = 0; i < myFiles.length; i++) {
                File myFile = new File(file, myFiles[i]);
                System.out.println(myFile);
                myFile.delete();
            }
        }

    }
} 
```

我怎样才能修改我的代码来实现这个目标？

编辑 ：

我已将代码更改为：

```
@ViewScoped
@ManagedBean
public class Delete {

    public void DeleteFiles() throws IOException {
        System.out.println("Called deleteFiles");
        File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");

        String[] myFiles;
        if (file.isDirectory()) {
            myFiles = file.list();
            for (int i = 0; i < myFiles.length; i++) {
                File myFile = new File(file, myFiles[i]);
                System.out.println(myFile);
               if (!myFile.isDirectory()) {
                    myFile.delete();
                }
            }
            DeleteFiles2();
        }

    } 
```

虽然这确实调用了所有文件夹，但这是我的控制台：

```
INFO: Called deleteFiles
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\web\resources\pdf\cam01342
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\web\resources\pdf\geg00061
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\web\resources\pdf\null
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\web\resources\pdf\up617648
INFO: D:\Documents\NetBeansProjects\printing~subversion\fileupload\web\resources\pdf\up626088
INFO: Called deleteFiles2 
```

Tt 不会删除这些文件夹中的文件，我该怎么做？

编辑 3：使用递归我现在收到堆栈溢出错误。

这是我的代码：

```
public void DeleteFiles() {
    File file = new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/");
    System.out.println("Called deleteFiles");
    if (file.isDirectory()) {
        for (File f : file.listFiles()) {
            DeleteFiles();
        }
    } else {
        file.delete();
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-23T15:11:36.253

为什么不只是做

```
if (!myFile.isDirectory()) myFile.delete(); 
```

代替

```
myFile.delete(); 
```

?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-23T15:22:46.070

使用递归非常简洁;-)

```
private void deleteFiles(File file) {
    if (file.isDirectory())
        for (File f : file.listFiles())
            deleteFiles(f);
    else
        file.delete();
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-23T15:12:04.143

只需使用 `File.isDirectory()`.

只需检查它是文件还是目录。如果是文件，则删除它，否则保留它

在你的情况下

```
if (!(myFile.isDirectory()))
{
 myFile.delete();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-23T15:13:49.507

我认为这会做

```
public void deleteFiles(File folder) throws IOException {
    List<File> files = folder.listFiles()
    foreach(File file: files){
        if(file.isFile()){
            file.delete();
        }else if(file.isDirecotry()) {
            deleteFiles(file)
        }
    }
} 
```

然后你需要打电话`deleteFiles(new File("D:/Documents/NetBeansProjects/printing~subversion/fileupload/web/resources/pdf/"))`；

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-23T16:30:06.960

递归是矫枉过正的，需要一个后续问题就证明了这一点。请参阅我的答案以获得更简单的方法：

[递归删除导致堆栈溢出错误](https://stackoverflow.com/questions/15042432/recursive-deletion-causing-a-stack-overflow-error/15042642#15042642)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-03T09:45:28.423

您可以使用以下方法。

```
public void deleteFiles(File folder) throws IOException {
    File[] files = folder.listFiles();
     for(File file: files){
            if(file.isFile()){
                String fileName = file.getName();
                boolean del= file.delete();
                System.out.println(fileName + " : got deleted ? " + del);
            }else if(file.isDirectory()) {
                deleteFiles(file);
            }
        }
    } 
```

# php - 数组的 php 和 MYSQL SELECT 问题

> ID：15041972
> 
> 赞同：0
> 
> 时间：2013-02-23T15:09:02.710
> 
> 标签：php, mysql

我想知道您是否可以告诉我我的代码有什么问题或指出我哪里出错了，因为我无法显示任何结果。$_POST['checkbox'] 是一个数组。

```
<?
   $get_id=$_POST['checkbox']; 

    if(empty($get_id)) {
        echo("<h3>You didn't select anything.</h3>");
   } else {  
        $where[]  = sprintf(" id='%s'",$_POST["checkbox"]);
   }

   $where_str = " WHERE ".implode(" AND ",$where);
   $sql = "SELECT * FROM products $where_str";
   $result = mysql_query($sql, $link);

    echo "<table>";
    echo "<tr> <th>Description</th> </tr>";
        while($row = mysql_fetch_array($result)) {
            echo "<tr><td>";     
            echo $row['description'];   
            echo "</td></tr>"; 
        }
   echo "</table>"; 
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-23T15:22:42.977

1.  您应该避免使用短标签`<?`，因为 PHP 5.4 之后不支持它们。
2.  您没有连接到 MySQL（`$link`未定义）
3.  您正在使用已弃用的 API ( `mysql_`)。请参阅替代品的评论（`mysqli_`或`PDO`）
4.  您应该使用`REQUEST_METHOD`索引`$_SERVER`来确定您的脚本是否已发布。

    `if( $_SERVER[REQUESTED_METHOD] == 'POST' && !empty($_POST['checkbox']) ) {` `... }`

5.  您需要使用错误处理来检查错误。如果您`echo $sql;`会看到未填充复选框：

    `SELECT * FROM products WHERE id=''`

6.  您的脚本容易受到 SQL 注入的攻击。当您切换到当前 API 时，请使用绑定参数。

7.  是`$_POST[checkbox]`数组吗？
8.  `sprintf`将无法按您的预期工作，因为您将整个`$_POST[checkbox]`数组传递给它。您需要遍历它来格式化它。（见奥利的回答）

**例子**

假设您的 HTML 如下所示：

```
<form method="post" ...>
<input type="checkbox" name="checkbox[]" value="1" />
<input type="checkbox" name="checkbox[]" value="2" />
<input type="checkbox" name="checkbox[]" value="3" />
<input type="submit" name="submit" />
</form> 
```

并且所有三个框都被选中；它将产生这个数组：

```
大批
(
    [0] => 1
    [1] => 2
    [2] => 3
)
```

按照 Collie 的循环：

```
foreach ($_POST['checkbox'] as $checkbox) {
    $where[]  = sprintf(" id='%s'",$checkbox);
} 
```

`$where`看起来像：

```
大批
(
    [0] => id='1'
    [1] => 身份证='2'
    [2] => 身份证='3'
)
```

你的脚本的其余部分应该可以工作。但是，您应该考虑使用[`IN`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_in)运算符。

这将使您能够跳过循环并仅使用`implode`：

```
$where = "'" . implode("', '", $_POST[checkbox]) . "'"; 
```

产生：

```
“1”、“2”、“3”
```

并结合`IN`：

```
$sql = "SELECT ... FROM WHERE id IN ($where)"; 
```

请注意，这没有经过消毒，您仍然容易受到注射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T15:15:29.690

如果`$_POST["checkbox"]`是你说的数组，那么你不能将它用作`sprintf`. 尝试使用`array_pop`返回该数组或类似数组的最后一个值。

您可以`foreach`通过数组中的每个元素：

```
foreach ($_POST['checkbox'] as $checkbox) {
    $where[]  = sprintf(" id='%s'",$checkbox);
} 
```

虽然如果要求 ID 等于两个不同的整数，这可能只会创建一个无效的 SQL 语句。

# c# - 如何在插入gridview之前知道一行的值？

> ID：15041973
> 
> 赞同：1
> 
> 时间：2013-02-23T15:09:05.207
> 
> 标签：c#, asp.net, sql-server-2008

我有这个查询：

```
SELECT COUNT(date) FROM patients WHERE date= 2012/02/23 
```

如果那个 COUNT 返回 10，就会有一个警告告诉用户它不能接受更多的访问。我该如何验证？我怎么知道？在php中我只需要这样做：

```
<?php

$QUERY = "SELECT COUNT(date) AS count_results FROM patients WHERE date= 2012/02/23";
$execute_query = $CONEXION ->prepare($query);
$execute_query->execute();
$results = execute_query->fetch(PDO::FETCH_ASSOC);

if(results['count_results ']==10)
{
echo "Cannot accept know visit.";
}else{
echo "Ok";
}
?> 
```

但我不知道如何在 ASP.NET C# 中做到这一点。帮助？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T16:00:23.407

如果您正在验证登录用户，请在 page_load 事件中执行检查。或者，如果您需要根据您尝试插入的用户值进行验证，请使用 button_click 事件来插入记录。

```
SqlCommand cmdEvent = new SqlCommand("SELECT COUNT(date) FROM patients WHERE date= '2012/02/23'", yourSqlConnection);
object myCount;
if (yourSqlConnection.State == ConnectionState.Closed){ yourSqlConnection.Open(); }
myCount = cmdEvent.ExecuteScalar();
if (yourSqlConnection.State == ConnectionState.Open){ yourSqlConnection.Close(); }

if (myCount != null)
{
  if ((int)myCount >= 10)
  {
    // Logic here e.g myLabel.Text = "You have reached your maximum of 10 visits!";
    return;
  }
} 
```

# python - Tornado/Python：为什么我不能在类中重置变量

> ID：15041978
> 
> 赞同：0
> 
> 时间：2013-02-23T15:09:34.270
> 
> 标签：python, class, variables, tornado

一个简化的代码如下：

```
....

class indexHandler(tornado.web.RequestHandler):
    a=[]

    def callback(self,response):
        #Do some other things, like write into database
        self.a=[]

    def get(self):
        print self.a
        self.a.append('abc')

        client=tornado.httpclient.AsyncHTTPClient()
        client.fetch('http://google.com',self.callback)

        self.write('OK')
        .... 
```

当我第一次访问该页面时，shell 显示 `[]`. 页面重新加载后，它显示`['abc']`，重新加载一次然后显示`['abc','abc']`等等。

为什么`a`不会重置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:50:33.893

感谢 Martijn 和 mkind！大家说的都对，我用过`__init__`，问题解决了。

替换`a=[]`为

```
def initialize(self):
    self.a=[] 
```

会解决这个问题。

请注意，`def __init__(self)`单独不起作用，Tornado 提供了`initialize`替代它的功能。在此处阅读：[python/tornado – 为什么会出现此错误？](https://stackoverflow.com/questions/14907489/python-tornado-why-am-i-getting-this-error)

# windows-phone-8 - mvvmcross 支持 windows phone 8 吗？

> ID：15041981
> 
> 赞同：2
> 
> 时间：2013-02-23T15:10:06.513
> 
> 标签：windows-phone-8, mvvmcross

我正在学习 MMVMCross Tip Calculator 教程。

启动并运行了一个 Android 实例，现在我将注意力转向了 Windows Phone 8。

到目前为止，我在 WindowsPhone bin 文件夹中找不到 Cirrious.MvvmCross.Plugins.Json 程序集，并且我还遇到了 CreateApp() 方法无法解析 Core.App 类的问题（有一堆关于追踪 Core 命名空间的建议，但没有一个里面有我可以看到的 App 类）。

当我梳理文档时，似乎明确支持 WP7，但没有提到 8。任何人都有运气让这种情况继续下去吗？有没有我错过的黑客？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T13:15:20.373

在 Andriod 项目中安装 Nuget 包（The HotTuna Startup）后，我无法构建并且在未解决 Core 的 CreateApp() 中遇到了同样的问题。我错过了将包 MVVMCross.Core 和 MvvmCross - Hot Tuna Libraries（添加了 app.cs）添加到我的核心 PCL 库中。这些 Nuget 包是入门的好方法！

现在很明显，但也许这会对其他人有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-23T15:40:49.097

是的，支持 Windows Phone 8，但还没有针对 WP8 的特定扩展（例如，我们仍然使用 Community C# SQLite 代码）

Core.App 类应该在您的核心/应用程序项目中。例如，在教程中它位于[https://github.com/slodge/MvvmCross/tree/vnext/Sample%20-%20Tutorial/Tutorial/Tutorial.Core](https://github.com/slodge/MvvmCross/tree/vnext/Sample%20-%20Tutorial/Tutorial/Tutorial.Core)

# javascript - 为什么这段代码给了我一个异常无效字符

> ID：15041991
> 
> 赞同：0
> 
> 时间：2013-02-23T15:10:56.787
> 
> 标签：javascript, json

我有这个 Web 服务，它获取城市的所有名称并返回 json 格式的字符串。

```
public  String  getDataForTowns( ) throws ClassNotFoundException 
{   
   String  strXml = "";

        Class.forName("org.postgresql.Driver");

            try 
            {
                conn = DriverManager.getConnection("jdbc:postgresql://localhost:5432/plovdivbizloca", "postgres", "tan");
            }   

        catch (SQLException ex) {
            ex.printStackTrace();
        }

        Statement mystmt = null;
        String selectQuery = "select * from municipality_id";
        try {
            mystmt = conn.createStatement();
            ResultSet mysr = mystmt.executeQuery(selectQuery);

            ResultSetMetaData rsmd = mysr.getMetaData();
            int colCount = rsmd.getColumnCount();
            int numberrow = 0;

            strXml += "{\"rows\": [";
            while (mysr.next()) 
            {               
                    String townname = mysr.getString(2);
                    String townid=mysr.getString(1);

                    strXml += "{\"town\":\"" + townname
                            + "\", \"id\":" + townid + "},";

                //strXml += ",";
            }
            strXml += "]}";
        } 

        catch (Exception ex) 
        {
        }

        return strXml;
    } 
```

在客户端我有这个功能，在警报声明中它给了我异常“无效字符”。

```
function loadTownSelect()
    {
         select =  document.getElementById('sphSel');
         createXMLHttpRequest();

         var txtDrop = new Array();
         var idDrop= new Array();

         xmlhttp.onreadystatechange = function() 
        { 
            if (xmlhttp.readyState==4 && xmlhttp.status==200) 
            {
                alert(xmlhttp.responseText);
                var xmlObj = xmlhttp.responseXML;   

                var textXML = xmlObj.documentElement.firstChild.firstChild.nodeValue;
                alert(textXML);

                var nwresp = JSON.parse(textXML);
                alert (nwresp.rows[2].town);               
            }
        }

        var url = "http://localhost:9091/localbusscat/services/localbusscat/getDataForTowns";
        xmlhttp.open("GET", url, true);
        xmlhttp.send(); 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T15:39:41.030

您的服务器端代码在*每个*“对象文字”之后添加一个逗号，即使是最后一个也不应该以逗号结尾。`JSON.parse()`在客户端解析字符串时，这个额外的逗号会导致错误

```
+ "\", \"id\":" + townid + "},";
-----------------------------^ 
```

# android - 如何检查片段是否存在？

> ID：15041992
> 
> 赞同：15
> 
> 时间：2013-02-23T15:11:04.137
> 
> 标签：android, android-fragments

我正在尝试从活动中与片段交谈，但我不确定片段是否可见。如果该片段不存在，我什至无法进行空检查，因为它会由于强制转换而引发异常。

如何检查片段是否存在？

```
PlayerFragment = (PlayerFragment) mManager.findFragmentById(R.id.bottom_container);
playerFragment.onNotificationListener.updateUI(); 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-23T15:25:00.037

一开始不要投。

```
Fragment f = mManager.findFragmentById(R.id.bottom_container);
if(f != null && f instanceof PlayerFragment) {
    PlayerFragment playerFragment = (PlayerFragment) f;
    playerFragment.onNotificationListener.updateUI();
} 
```

如果这不起作用，则发布堆栈跟踪，并收到您收到的异常。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-23T15:25:19.053

强制`null`转换为引用不会抛出异常，但会抛出异常。

使用`findFragmentById()`or`findFragmentByTag()`获取引用并检查其是否为空，如果不是，请检查引用的`isAdded()`or `isVisible()`。

```
PlayerFragment p = (PlayerFragment) mManager.findFragmentById(R.id.bottom_container);
if( p != null && p.isAdded()){
   p.onNotificationListener.updateUI();
} 
```

# c# - Linq ToList/ToArray/ToDictionary 性能

> ID：15041994
> 
> 赞同：23
> 
> 时间：2013-02-23T15:11:07.800
> 
> 标签：c#, .net, performance, linq

好吧，我遇到了很多情况，其中有一个 IEnumerable 是不够的。但是我不确定上述方法调用的性能。

我真正想问的是：

是 ToList/ToArray 的表现：

1.  将 IEnumerable 复制到新数组/列表的 O(n) 操作？
2.  如果我在列表上调用 linq 扩展方法，如果我调用 ToList，它具有 O(1) 性能，但如果调用 ToArray，它具有 O(n) 性能（如果我的原始列表是一个数组，则相反）？

3.  发生了一些神奇的事情，性能是 O(1)？

可能字典是 O(n)，对吧？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-23T15:19:11.523

> `ToList`/的性能是`ToArray`一个 O(n) 操作，它将 复制`IEnumerable`到一个新的数组/列表？

是的。`ToList`效率稍高一些，因为它不需要先将内部缓冲区修整到正确的长度。

> 如果我在列表上调用 linq 扩展方法，如果我调用 ToList，它具有 O(1) 性能，但如果调用 ToArray，它具有 O(n) 性能（如果我的原始列表是一个数组，则相反）？

不会。对于这两个调用，总是会创建一个*新集合；*这是原始集合的浅拷贝。`ToList`调用或调用`ToArray`any比调用未实现`ICollection<T>`的 simple更有效，因为对于已知长度的集合开始。（虽然这是在执行时检测到的；您不必担心编译时类型。）`IEnumerable<T>``ICollection<T>`

> 可能字典是 O(n)，对吧？

假设哈希是合理的，它是 O(N)，是的。基本上，它完全按照您可能期望的方式创建了一个新字典。

您可能想阅读我的 Edulinq 博客系列中的相应帖子：

*   [`ToList`](http://codeblog.jonskeet.uk/2011/01/01/reimplementing-linq-to-objects-part-20-tolist.aspx)
*   [`ToArray`](http://codeblog.jonskeet.uk/2011/01/02/reimplementing-linq-to-objects-part-24-toarray.aspx)
*   [`ToDictionary`](http://codeblog.jonskeet.uk/2011/01/02/reimplementing-linq-to-objects-todictionary.aspx)