# StackOverflow 问答 13790000-13790999

# java - 带正数和负数的 RangeCheck

> ID：13790001
> 
> 赞同：-1
> 
> 时间：2012-12-09T17:50:35.213
> 
> 标签：java, math, while-loop, range-checking

我正在开发一个有图表的小游戏。这个想法是我在目标位置（由上限和下限指定）尚未满足（在 0.5 以内）时执行操作。例如，如果我以 (7,7) 为目标，则当 x 和 y （在本例中）介于 6.5 和 7.5 之间时，循环应该停止。

但是，当出现负数时，出现以下情况给我带来了问题：

```
while ((X < tarX-0.5 || X > tarX+0.5) && (Y < tarY-0.5 || Y > tarY+0.5)) 
```

例如：如果我有目标 (-7,-7)，那么当 x 或 y 值之一在范围内时，循环将停止，而不是两者都在。

基本上，我的想法是根据 x 或 y 是否为正来创建四个不同的循环。但我想知道是否有更简单的方法？（我确实尝试使用 Math.abs() 来抵消负数，这很有效，但注定要 (-3,-3) 的东西仍然可以在 (3,3) 处停止）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T17:54:56.510

> 当 x 和 y （在这种情况下）都在 6.5 和 7.5 之间时，循环应该停止。

```
while (!(x >= 6.5 && x <= 7.5 && y >= 6.5 && y <= 7.5)) {
   ...
} 
```

应用[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)，以上等价于

```
while (x < 6.5 || x > 7.5 || y < 6.5 || y > 7.5) {
   ...
} 
```

# ruby-on-rails - 自动递增 text_field 编号 rails 3.2.6

> ID：13790009
> 
> 赞同：0
> 
> 时间：2012-12-09T17:51:42.263
> 
> 标签：ruby-on-rails, autocomplete, textfield

我一直在研究试图找到答案，但我正在努力解决这个问题。我有一个 booking_no text_field，当用户通过 booking/new 进行新预订时，我想自动设置它。我希望它是一个自动编号，从 100 开始每次只加 1。

我知道在模型中这样做可能最容易，但我不确定如何。

我的booking.rb：（我还没有设置验证）

```
class Booking < ActiveRecord::Base
  attr_accessible :booking_no, :car_id, :date, :user_id

  belongs_to :car
  belongs_to :user
end 
```

编辑评论：

```
#error ArgumentsError in booking_controller#create
wrong number of arguments (1 for 0) 
```

我的booking_controller#create

```
def create
@booking = Booking.new(params[:booking])

respond_to do |format|
  if @booking.save
    format.html { redirect_to @booking, :notice => 'Booking was successfully created.' }
    format.json { render :json => @booking, :status => :created, :location => @booking }
  else
    format.html { render :action => "new" }
    format.json { render :json => @booking.errors, :status => :unprocessable_entity }
  end
end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:05:54.763

`booking_no`如果您在数据库表本身中设置为自动增量字段，这可能是最好的。

否则，要在您的模型中管理它，您可以执行以下操作：

```
before_create :increment_booking_no

def increment_booking_no
    self.booking_no = (self.class.last.nil?) ? "0" : ((self.class.last.booking_no.to_i) + 1).to_s
end 
```

# forms - Wordpress Mailchimp 表单自定义复选框

> ID：13790013
> 
> 赞同：5
> 
> 时间：2012-12-09T17:52:19.890
> 
> 标签：forms, wordpress, plugins, custom-fields, mailchimp

我正在使用 Wordpress 的[Mailchimp 订阅插件](http://wordpress.org/extend/plugins/mailchimp/)（v. 1.2.13）。没关系，我只需要添加一个复选框来接受隐私条款。我已经通过[Mailchimp 表单管理](http://kb.mailchimp.com/article/advanced-customization-of-mailchimps-sign-up-forms)创建了该字段，它在表单中显示和工作，除了**我需要根据需要定义它**。在 mailchimp 中没有选项，我尝试在 html 中添加一个简单的“必需”属性，但它没有工作（如预期的那样）。

有什么建议吗？

我还发现 Mailchimp 定义了该字段是否需要在一个名为的数组/位置中，该数组/位置以某种`$var['req']`方式与字段名称相关联。但我找不到在哪里可以访问此数组或如何将我的自定义字段添加到该数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:10:05.323

我已将链接添加到您的帖子中，可以在 MailChimp 中访问表单的高级管理。[又来了](http://kb.mailchimp.com/article/advanced-customization-of-mailchimps-sign-up-forms)

但是，它只对付费用户可用。您可以在该位置自定义表单的每一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:48:21.220

这应该有效：

```
<input type="checkbox" id="acceptterms" /> 
```

然后假设您的 MailChimp“订阅”链接的 ID 为“mailchimpsubscribe”，那么您可以执行以下操作：

```
<script language="javascript" type="text/javascript"> jQuery('#mailchimpsubscribe').click(function() { if (jQuery('#acceptterms').prop('checked') == false) {return false; } }); </script> 
```

所以基本上你是在你的 MailChimp 提交按钮上添加一个点击事件，并检查条款复选框是否已被勾选——如果没有，返回 false，这样点击就不会完成。

# javascript - Codecademy 课程问题

> ID：13790017
> 
> 赞同：1
> 
> 时间：2012-12-09T17:52:27.373
> 
> 标签：javascript

我正在通过 Codecademy 学习 JavaScript，但我遇到了一个问题。下面的代码应该在`text`变量中搜索我的名字，`myName`然后将所有单个字母推送到`hits`数组中。我写的代码不正确，但 Codecademy 说它是正确的，让我继续上课。

我一直在尝试解决我没有运气的问题。问题是，当我运行该`hits.push(text);`行时，它将输出整个变量，但我已经尝试`hits.push(text[i]);`并得到未定义的结果。有人可以帮我理解我在哪里犯了错误吗？

```
/*jshint multistr:true */
var text = "XsddfasASSFABrandonSFsdfdasBrandonsddfadfaBrandon";
var myName = "Brandon";
var hits = [];
for (i=0; i<=text.length;i++){
    if (text[i]===myName[i]){
        for(var x=i; x<i+myName.length;x++){
            hits.push(text);
        }
    }
}
if (hits.length===0){
    console.log("Your name wasn't found!");
} else {
    console.log(hits);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:04:15.270

`indexOf`通常你会使用, `match`, `search`, `substr`or来做这种事情`substring`，它们都是[字符串方法](http://www.w3schools.com/jsref/jsref_obj_string.asp)。

但是，出于本练习的目的，您可以执行以下操作：

```
var text = "XsddfasASSFABrandonSFsdfdasBrandonsddfadfaBrandon";
var myName = "Brandon";
var hits = [],
    namePosition = 0;
for (var i = 0; i < text.length; i++) {
    if (text[i] === myName[namePosition]) {
        hits.push(text[i]);
        namePosition ++;
        if (hits.length === myName.length) {
            break;
        }
    }
    else {
        namePosition = 0;
        hits = [];
    }
}
if (hits.length === 0) {
    console.log("Your name wasn't found!");
} else {
    console.log(hits);
}​ 
```

（参见[http://jsfiddle.net/wCWxr/1/](http://jsfiddle.net/wCWxr/1/)工作）。您的原始代码存在的问题包括：

1.  您尝试比较`text[i]`，`myName[i]`但两个字符串的索引不匹配。

2.  您尝试一次将整个字符串推`text`入`hits`而不是一个字符

3.  您的逻辑不处理开头而不是结尾的可能性`myName`，`text`例如，如果文本是 aerwerBrasdfsgars

我的建议通过记录（用`namePosition`）我们当前在字符串中的位置来解决这个问题`myName`，并在我们找到`text`与 中的相关字符匹配的字符时递增该位置`myName`。如果字符不匹配，那么它不是真正的命中，所以我们重置`hits = []`和`namePosition = 0`。如果字符全部匹配，则`hits`最终达到的长度，`myName`因此我们跳出循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:06:39.703

我能想到的解释你的错误的最好方法就是简单地回顾一下你所写内容的一些逻辑。

```
for (i=0; i<=text.length;i++){ 
```

您的`for`循环将迭代变量`i`中的字符数`text`，因此：49 次。

```
if (text[i]===myName[i]){ 
```

第一次运行`for`循环，`i=0`您正在检查是否`text[0]`严格等于`myName[0]`。`text[0] = X`和`myName[0] = B`。不满足严格等于条件，因此循环继续递增`i`repeat:`text[1] = s`和`myName[1] = r`。这种情况又持续了 47 次，但条件从未满足。`myName[i]`在前 7 个循环之后未定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T17:59:32.397

如果您尝试查找 myName 是否在文本中，请执行以下操作：

正则表达式：

```
var pattern = new RegExp(myName);
if (pattern.test(text)){
    console.log(myName);
}else {
    console.log("Your name wasn't found!");
} 
```

指数：

```
if (text.indexOf(myName) != -1){
    console.log(myName);
}else {
    console.log("Your name wasn't found!");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-18T15:18:59.190

```
if (text[i]===myName[i]){ 
```

此行应该会产生错误，因为 myName[i] 不是 myName 的第一个字母。

```
if (text[i]===myName[0]){ 
```

更改此行应该有效。

# mysql - LEFT JOIN 根据某些条件 MYSQL 过滤某些 Null 值

> ID：13790020
> 
> 赞同：1
> 
> 时间：2012-12-09T17:52:50.447
> 
> 标签：mysql, sql

是否可以使用mysql中的某些条件在左连接后过滤某些空值

我的 sqlfiddle 供参考

[http://sqlfiddle.com/#!2/cb03b/1](http://sqlfiddle.com/#!2/cb03b/1)

我想返回带有特定预订日期时间状态的表格

我的表结构是错误的还是他们的解决方案....

2012 年 12 月 9 日 00:00:00+0000 日期的预期输出

```
TABLE_ID FLOOR_ID TABLE_STATUS  BOOKING_ID         D
1         1        seated            35      December, 09 2012 00:00:00+0000
2         1        free           (null)    (null)
3         1        free           (null)    (null)
4         1        free           (null)    (null)
5         1        free           (null)    (null) 
```

但我从预订表中得到其他空值

```
 TABLE_ID FLOOR_ID TABLE_STATUS BOOKING_ID  D
   1     1           seated       35    December, 09 2012 00:00:00+0000
   2     1                        (null)    (null)
   2     1                        (null)    (null)
   3     1            free        (null)    (null)
   4     1            free        (null)    (null)
   5     1            free        (null)    (null) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T17:58:22.273

您可以使用`Group By`它来执行此操作，但在一个表有多个匹配项的情况下，您并不清楚您想要什么。您可以使用`left outer join`和的组合`inner join`来忽略不需要的 booking_table 行：

```
Select
  t.table_id,
  t.floor_id,
  coalesce(Max(bt.table_status),'free') as table_status,
  max(bt.booking_id) as booking_id,
  max(bt.date) as d
From
  ttable as t
    Left Outer Join (
      Select
        bt.table_id,
        bt.table_status,
        b.booking_id,
        b.date
      From
        booking_table as bt 
          Inner Join
        booking As b
          On b.booking_id = bt.booking_id And b.date = '2012-12-09'
    ) bt On bt.table_id = t.table_id
Where
  t.floor_id = 1
Group By
  t.table_id,
  t.floor_id 
```

您可以使用 a`right outer join`来避免嵌套，但通常不建议这样做：

```
Select
  t.table_id,
  t.floor_id,
  coalesce(Max(bt.table_status),'free') as table_status,
  max(b.booking_id) as booking_id,
  max(b.date) as d
From
  booking_table as bt
    Inner Join
  booking b
    On b.booking_id = bt.booking_id And b.date = '2012-12-09'
    Right Outer Join
  ttable as t
    On bt.table_id = t.table_id
Where
  t.floor_id = 1
Group By
  t.table_id,
  t.floor_id 
```

[http://sqlfiddle.com/#!2/cb03b/20](http://sqlfiddle.com/#!2/cb03b/20)

# xaml - Windows 8 应用程序：固定按钮宽度：无法从文本“1in”创建“Windows.Foundation.Double”？

> ID：13790022
> 
> 赞同：2
> 
> 时间：2012-12-09T17:52:52.120
> 
> 标签：xaml, windows-8, app-store

我正在使用适用于 Windows 8 的 VS Express 2012 为应用商店创建一个 Windows 8 应用程序。我想要一个 1 英寸宽的按钮，无论屏幕尺寸和分辨率如何。我有这个标记，VS 可以完美处理：

```
<Button Width="1in">Back</Button> 
```

但是当我尝试在模拟器中启动我的应用程序以测试各种平板电脑方向时，我得到了这个：

```
WinRT information: Failed to create a 'Windows.Foundation.Double' from the text '1in'. 
```

这是怎么回事？我如何解决它？我的场景是否可行，还是我必须求助于基于像素的宽度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T04:39:16.837

宽度属性是一个双精度值，只有数字是有效值。1、3、5.5 等表示与设备无关的像素。您不能使用 in、mm、cm 或任何其他可以与 CSS 一起使用的名称。如果您想让按钮的宽度正好为 1 英寸，则必须使用[屏幕 dpi](http://msdn.microsoft.com/en-US/library/windows/apps/windows.graphics.display.displayproperties.logicaldpi)并使用它将英寸转换为 DIP。

# postgresql - 如何为 PostgreSQL 创建自定义窗口函数？（运行平均示例）

> ID：13790028
> 
> 赞同：9
> 
> 时间：2012-12-09T17:53:31.937
> 
> 标签：postgresql, user-defined-functions

我真的很想更好地了解在 PostgreSQL 中创建在 windows 上运行的 UDF 所涉及的内容。我做了一些关于如何创建 UDF 一般的搜索，但没有找到一个如何在窗口上操作的示例。

为此，我希望有人愿意分享有关如何编写 UDF 的代码（可以是 C、pl/SQL 或 PostgreSQL 支持的任何过程语言），它计算窗口中数字的运行平均值。我意识到有一些方法可以通过使用窗口语法（我相信语法之间的行）应用标准平均聚合函数来做到这一点，我只是要求这个功能，因为我认为它是一个很好的简单示例。另外，我认为如果有平均函数的窗口版本，那么数据库可以保持运行总和和观察计数，并且不会在每次迭代时总结几乎相同的行集。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-09T19:27:59.360

您必须查看 postgresql 源代码 postgresql/src/backend/utils/adt/windowfuncs.c 和 postgresql/src/backend/executor/nodeWindowAgg.c

没有好的文档 :( -- 功能齐全的窗口功能只能在 C 或 PL/v8 中实现 - 没有其他语言的 API。

[http://www.pgcon.org/2009/schedule/track/Version%208.4/128.en.html](http://www.pgcon.org/2009/schedule/track/Version%208.4/128.en.html) PostgreSQL 实现作者的演示文稿。

我发现只有一个非核心实现 - [http://api.pgxn.org/src/kmeans/kmeans-1.1.0/](http://api.pgxn.org/src/kmeans/kmeans-1.1.0/)

[http://pgxn.org/dist/plv8/1.3.0/doc/plv8.html](http://pgxn.org/dist/plv8/1.3.0/doc/plv8.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-23T03:42:59.263

根据[文档](http://www.postgresql.org/docs/9.4/static/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS)“*用户可以添加其他窗口函数。此外，任何内置或用户定义的普通聚合函数都可以用作窗口函数。* ”（第 4.2.8 节）。这对我计算股票分割调整很有用：

```
CREATE OR REPLACE FUNCTION prod(float8, float8) RETURNS float8
  AS 'SELECT $1 * $2;'
  LANGUAGE SQL IMMUTABLE STRICT;

CREATE AGGREGATE prods ( float8 ) (
  SFUNC = prod,
  STYPE = float8,
  INITCOND = 1.0
);

create or replace view demo.price_adjusted as
  select id, vd,
    prods(sdiv) OVER (PARTITION by id ORDER BY vd DESC ROWS UNBOUNDED PRECEDING) as adjf,
    rawprice * prods(sdiv) OVER (PARTITION by id ORDER BY vd DESC ROWS UNBOUNDED PRECEDING) as price
  from demo.prices_raw left outer join demo.adjustments using (id,vd); 
```

以下是这两个表的架构：

```
CREATE TABLE demo.prices_raw (
  id VARCHAR(30),
  vd DATE,
  rawprice float8 );

CREATE TABLE demo.adjustments (
  id VARCHAR(30),
  vd DATE,
  sdiv float); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-12-17T11:29:04.420

从表开始

```
付款
+------------------------------+
| 客户 ID | 金额 | 项目 |
| 5 | 10 | 书 |
| 5 | 71 | 鼠标 |
| 7 | 13 | 封面|
| 7 | 22 | 电缆 |
| 7 | 19 | 书 |
+------------------------------+

```

```
SELECT customer_id, 
    AVG(amount) OVER (PARTITION BY customer_id) AS avg_amount,   
    item, 
FROM payments` 
```

我们得到

```
+---------------------------------+
| 客户 ID | 平均金额 | 项目 |
| 5 | 40.5 | 书 |
| 5 | 40.5 | 鼠标 |
| 7 | 18 | 封面|
| 7 | 18 | 电缆 |
| 7 | 18 | 书 |
+---------------------------------+

```

`AVG`作为聚合函数，它可以充当窗口函数。然而，并不是所有的窗口函数都是聚合函数。聚合函数是非复杂的窗口函数。

在上面的查询中，我们不使用内置`AVG`函数，使用我们自己的实现。做同样的事情，只是由用户实现。上面的查询变为：

```
SELECT customer_id, 
    my_avg(amount) OVER (PARTITION BY customer_id) AS avg_amount,   
    item, 
FROM payments` 
```

与前一个查询的唯一区别是`AVG`已替换为`my_avg`. 我们现在需要实现我们的自定义函数。

# 关于如何计算平均值

将所有元素相加，然后除以元素的数量。对于`customer_id`7，那将是`(13 + 22 + 19) / 3 = 18`. 我们可以将其划分为：

*   一步一步的积累——总和。
*   最后的操作——除法。

# 关于聚合函数如何得到结果

平均值是逐步计算的。只有最后一个值是必需的。从初始值 0 开始。

1.  Feed 13\. 计算中间/累计和，即 13。
2.  Feed 22\. 计算累加总和，需要前一个总和加上这个元素：`13 + 22 = 35`
3.  Feed 19\. 计算累加总和，它需要前一个总和加上这个元素：`35 + 19 = 54`。这是需要除以元素数量 (3) 的总数。
4.  步骤 3\. 的结果被馈送到另一个函数，该函数知道如何将累积和除以元素的数量

这里发生的情况是，状态从初始值 0 开始，每一步都在改变，然后传递到下一步。

只要有数据，状态就会在步骤之间移动。当所有数据都被消耗完时，状态进入最终功能（终端操作）。我们希望状态包含累加器以及终端操作所需的所有信息。

在计算平均值的特定情况下，终端操作需要知道累加器使用了多少个元素，因为它需要除以那个。出于这个原因，状态需要包括累计和和元素的数量。

我们需要一个包含两者的元组。预定义的`POINT`PostgreSQL 类型来救援。POINT(5, 89) 表示 5 个元素的累加和，其值为 89。初始状态将为 POINT(0,0)。

累加器在所谓的*状态函数*中实现。终端操作在所谓的*最终函数*中实现。

在定义自定义聚合函数时，我们需要指定：

*   聚合函数名称和返回类型
*   初始状态
*   基础设施将在步骤之间传递到最终函数的状态类型
*   状态函数——知道如何执行累积步骤
*   最终功能——知道如何执行终端操作。并不总是需要（例如，在 SUM 的自定义实现中，累积和的最终值就是结果。）

这是自定义聚合函数的定义。

```
CREATE AGGREGATE my_avg (NUMERIC) ( -- NUMERIC is what the function returns
    initcond = '(0,0)', -- this is the initial state of type POINT
    stype = POINT, -- this is the type of the state that will be passed between steps
    sfunc = my_acc, -- this is the function that knows how to compute a new average from existing average and new element. Takes in the state (type POINT) and an element for the step (type NUMERIC)
    finalfunc my_final_func -- returns the result for the aggregate function. Takes in the state of type POINT (like all other steps) and returns the result as what the aggregate function returns - NUMERIC 
); 
```

剩下的就是定义两个函数`my_acc`和`my_final_func`.

```
CREATE FUNCTION my_acc (state POINT, elem_for_step NUMERIC) -- performs accumulated sum
RETURNS POINT
LANGUAGE SQL
AS $$
    -- state[0] is the number of elements, state[1] is the accumulated sum
    SELECT POINT(state[0]+1, state[1] + elem_for_step);
$$;

CREATE FUNCTION my_final_func (POINT) -- performs devision and returns final value
RETURNS NUMERIC
LANGUAGE SQL
AS $$
    -- $1[1] is the sum, $1[0] is the number of elements
    SELECT ($1[1]/$1[0])::NUMERIC;
$$; 
```

现在，上面定义的功能可用`CREATE AGGREGATE`，将成功运行。现在我们已经定义了聚合，可以运行基于`my_avg`而不是内置的查询：`AVG`

```
SELECT customer_id, 
    my_avg(amount) OVER (PARTITION BY customer_id) AS avg_amount,    
    item, 
FROM payments` 
```

结果与使用内置`AVG`.

PostgreSQL 文档建议用户仅限于实现用户定义的聚合函数：

> 除了这些 [预定义的窗口] 函数之外，任何内置或用户定义的通用或统计聚合（即，非有序集或假设集聚合）都可以用作窗口函数；

我怀疑的`ordered-set or hypothetical-set aggregates`意思是：

*   返回的值与所有其他行相同（例如`AVG`和`SUM`。相反`RANK`，根据更复杂的标准为组中的所有行返回不同的值）
*   分区时 ORDER BY 毫无意义，因为无论如何所有行的值都是相同的。相比之下我们想`ORDER BY`在使用的时候`RANK()`

询问：

```
SELECT customer_id, item, rank() OVER (PARTITION BY customer_id ORDER BY amount desc) FROM payments; 
```

# 几何平均数

以下是一个用户定义的聚合函数，我发现它没有内置聚合，可能对某些人有用。

状态函数计算项的自然对数的平均值。

最终函数将常量提升`e`到累加器提供的任何值。

```
CREATE OR REPLACE FUNCTION sum_of_log(state POINT, curr_val NUMERIC)
RETURNS POINT
LANGUAGE SQL
AS $$
    SELECT POINT(state[0] + 1,
        (state[1] * state[0]+ LN(curr_val))/(state[0] + 1));
$$;

CREATE OR REPLACE FUNCTION e_to_avg_of_log(POINT)
RETURNS NUMERIC
LANGUAGE SQL
AS $$
    select exp($1[1])::NUMERIC;
$$;

CREATE AGGREGATE geo_mean (NUMBER)
(
    stype = NUMBER,
    initcond = '(0,0)', -- represent POINT value
    sfunc = sum_of_log,
    finalfunc = e_to_avg_of_log
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-21T14:21:24.473

PL/R 提供了这样的功能。有关一些示例，请参见[此处](http://www.joeconway.com/plr/doc/plr-window-funcs.html)。也就是说，我不确定它（当前）是否满足您“保持 [ing] 运行总和和观察计数并且 [not] 总结 [ming] 在每次迭代中几乎相同的行集”的要求（参见[此处](http://lists.pgfoundry.org/pipermail/plr-general/2013-May/000756.html)） .

# php - 这是设置令牌 CSRF 的安全方法吗？

> ID：13790029
> 
> 赞同：11
> 
> 时间：2012-12-09T17:53:51.437
> 
> 标签：php, security

我想知道这是否是一种设置令牌的安全方法，除非确实生成了令牌，否则我会生成一个令牌，并在整个应用程序和这些表单中使用它。每个会话一个令牌？

```
if (!isset($_SESSION['token'])) {
    $data['token'] = uniqid(rand(), true);
    session_regenerate_id();
    $_SESSION['token'] = $data['token'];
} 
```

是否有必要清除提交表单上的令牌？还是坚持下去，即使我提交了表格？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-09T18:53:38.093

如果您不知道这些链接，[这](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29)应该可以帮助您理解一些场景，特别是[它](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet)会告诉您 DO 和 DONT。希望能帮助到你。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-09T18:08:03.710

就我个人而言，我会为我想要显示的每个表单生成一个新令牌。如果你这样做，只要会话保持活动状态，某人只需要一个会话 cookie 来读取你的令牌并使用它。

在我的应用程序中，我为每个表单显示生成一个令牌，如下所示：

```
<?php
$token = uniqid(rand(), true);
$_SESSION['csrf_tokens'][$token] = true; 
```

**HTML**

```
<form>
    <input type="hidden" name="token" value="<?php echo $token ?>" />
</form> 
```

在表单验证中，我检查该令牌，如下所示：

```
if (isset($_SESSION['csrf_tokens'][$token]) && $_SESSION['csrf_tokens'][$token] === true) {
    unset($_SESSION['csrf_tokens'][$token]);
    // additional code here
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T13:30:19.853

而不是使用`per-session token`我更喜欢`per-form/url token`额外的安全性，有些人可能会认为这`per-request token`是最安全的，但会影响可用性。

我还认为将会话存储与令牌存储分开并使用类似`Memcache`. 当您需要使用多个应用程序服务器等时，这会更好。我也更喜欢它，因为我可以添加自定义`expiration to the token` 而不必影响整体`session`

这是一个典型的例子

**HTML**

```
<form method="POST" action="#">
    IP:<input type="text" name="IP" /> <input type="hidden" name="token"
        value="<?php echo Token::_instance()->generate(); ?>" /> <input
        type="Submit" value="Login" />
</form> 
```

加工

```
$id = "id44499900";
Token::_instance()->initialise($id); // initialise with session ID , user ID or IP

try {

    Token::_instance()->authenticate();
    // Process your form
} catch ( TokenException $e ) {
    http_response_code(401); // send HTTP Error 401 Unauthorized
    die(sprintf("<h1>%s</h1><i>Thief Thief Thief</i>", $e->getMessage()));
} 
```

使用的类

```
class Token {
    private $db;
    private $id;
    private static $_instance;

    function __construct() {
        $this->db = new Memcache();
        $this->db->connect("localhost");
    }

    public static function _instance() {
        self::$_instance === null and self::$_instance = new Token();
        return self::$_instance;
    }

    public function initialise($id) {
        $this->id = $id;
    }

    public function authenticate(array $source = null, $key = "token") {
        $source = $source !== null ? $source : $_POST;

        if (empty($this->id)) {
            throw new TokenException("Token not Initialised");
        }

        if (! empty($source)) {
            if (! isset($source[$key]))
                throw new TokenException("Missing Token");
            if (! $this->get($this->id . $source[$key])) {
                throw new TokenException("Invalid Token");
            }
        }
    }

    public function get($key) {
        return $this->db->get($key);
    }

    public function remove($key) {
        return $this->db->delete($key);
    }

    public function generate($time = 120) {
        $key = hash("sha512", mt_rand(0, mt_getrandmax()));
        $this->db->set($this->id . $key, 1, 0, $time);
        return $key;
    }
}
class TokenException extends InvalidArgumentException {
} 
```

> 注意：请注意，该示例可能会影响“返回”按钮或刷新，因为令牌将在`120`sec 后自动删除，这可能会影响用户友好的功能

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-02T04:42:04.713

> 我想知道这是否是设置令牌的安全方法

这取决于您的网络应用程序需要有多安全。此行在密码学上不是安全的（正如 PHP 文档中针对 uniqid() 和 rand() 的警告）：

```
uniqid(rand(), true); 
```

如果令牌生成时间已知/确定并且 rand() 种子已知/确定，则攻击者确定/暴力破解这一点可能是可行的。但是，出于您的目的，它可能会很好，因为它仍然可以防止攻击者不知道令牌值的 CSRF 攻击。

> 每个会话一个令牌？

每个会话使用一个令牌可能适合您的目的。但是，请注意：

1.  如果会话长达 n 分钟，则攻击者有 n 分钟的窗口来尝试确定或获取您的令牌值并执行 CSRF 攻击。而当按表格生成令牌或定期重新生成令牌时，这种风险会降低，因为它们的寿命不够长。
2.  如果攻击者确定/获取令牌，每个会话使用单个令牌会暴露应用程序的所有功能（使用该令牌）进行攻击。而在每个表单中使用令牌会将攻击限制在单个表单中。

> 是否有必要清除提交表单上的令牌？还是坚持下去，即使我提交了表格？

这取决于您的应用程序对攻击者的目标价值有多大，以及攻击对您造成的破坏程度。您现有的措施使得执行 CSRF 攻击变得困难，但如果它具有很高的价值并且您有非常坚定的攻击者，那么您可能希望通过以下方式进一步降低 CSRF 的风险：

1.  使用加密安全令牌来防止确定或暴力破解令牌值的风险。
2.  定期重新生成令牌以减少令牌寿命，如果令牌被确定或获得，则减少攻击窗口。
3.  在确定或获得令牌的情况下，为每个表单生成令牌以将攻击限制为单一表单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-14T14:09:14.363

我已经在另一个论坛上回答了类似的问题：[here](http://halls-of-valhalla.org/forum.php?thread=58)。希望这会有所帮助。它解释了 CSRF 预防的基本过程，并链接到 CSRF 框架的一些代码。

如果您想要更高的安全性，请在每个会话的每个请求后更改令牌。如果您想要更好的可用性，请在每个会话中保留一个令牌。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-05T11:13:09.487

您能否参考以下网站，这可能会得到一些想法。

1.) [https://docs.djangoproject.com/en/dev/ref/contrib/csrf/](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/)

2.) [http://blog.whitehatsec.com/tag/session-token/](http://blog.whitehatsec.com/tag/session-token/)

谢谢您的回复。

# python - Python - 比较存在电子邮件但在不同行中的两个电子邮件列表

> ID：13790032
> 
> 赞同：2
> 
> 时间：2012-12-09T17:54:34.463
> 
> 标签：python, list, python-2.7, compare

我正在尝试编写一些代码来比较两个列表，其中每个列表都包含电子邮件地址。但是，逐行比较不是一种选择，因为相同的电子邮件`list1`可以存在于`list2`不同的行号中。

我正在使用这种方法：

```
F1 = open("c:\\FILEA.txt", "r").read().split('\n')
F2 = open("c:\\FILEB.txt", "r").read().split('\n')

lines1 = filter(None, (line.rstrip() for line in sorted([n.lower() for n in F1])))
lines2 = filter(None, (line.rstrip() for line in sorted([n.lower() for n in F2])))

for i in ( i for i in lines1 if lines2[:2] == lines1[:2]):
    print i
    break 
```

以上只是一个例子，只是逐行比较。有谁知道如何比较每封电子邮件`list1`并查看电子邮件是否存在于`list2`.

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T20:40:27.350

如果您只是想查看一个是否在另一个中（并且不关心频率等），您可以尝试使用`set`'s 来存储每个文件中的唯一事件，然后找到`intersection`两组中的这将表示两个文件中都存在的电子邮件（请注意，`with`带有两个文件的语句是 Python2.7+ 功能）：

```
>>> l1 = set()
>>> l2 = set()
>>> with open('FILEA.txt', 'rb') as f1, open('FILEB.txt', 'rb') as f2:
...     for line in f1.readlines():
...         l1.add(line.strip())
...     for line in f2.readlines():
...         l2.add(line.strip())
... 
>>> 
>>> l1
set(['another@gmail.com', 'andanother@hotmail.com', 'this@email.com'])
>>> l2
set(['unique@somehost.com', 'this@email.com', 'not@example.com'])
>>> l1 & l2
set(['this@email.com']) 
```

使用集合，您还可以执行其他（可能）有用的操作：

**识别两个集合中的项目（联合）：**

```
>>> l1 | l2
set(['another@gmail.com', 'unique@somehost.com', 'andanother@hotmail.com', 'this@email.com', 'not@example.com']) 
```

**一组中但不在另一组中的项目（差异）：**

```
>>> l1 - l2
set(['another@gmail.com', 'andanother@hotmail.com'])
>>> l2 - l1
set(['not@example.com', 'unique@somehost.com']) 
```

**每个集合唯一的项目（将其视为联合减去交集）（对称差异）：**

```
>>> l1 ^ l2
set(['another@gmail.com', 'not@example.com', 'unique@somehost.com', 'andanother@hotmail.com']) 
```

最后，您还可以使用方法而不是运算符来执行这些操作。要使用这些方法，请获取一个集合，将其中一个名称附加在上面的括号中，并将另一个设置为参数：

```
>>> l1.intersection(l2)
set(['this@email.com']) 
```

* * *

我的文件看起来像这样：

**文件A.txt**

```
this@email.com
another@gmail.com
andanother@hotmail.com 
```

**文件B.txt**

```
not@example.com
this@email.com
unique@somehost.com 
```

# iphone - UITableview 只允许单向滑动删除

> ID：13790033
> 
> 赞同：1
> 
> 时间：2012-12-09T17:54:35.593
> 
> 标签：iphone, ios, uitableview, uikit

我有一个启用了编辑模式的表格视图，因此用户可以在单元格上向任何方向滑动以调出删除按钮。但是，我在整个 tableview 上有一个手势，可以向右滑动来做其他事情，与删除无关。如果要删除的滑动仅在向左滑动时有效，我希望它可以在右侧滑动时调用我的手势识别器。现在，tableview 滑动完全覆盖了我的手势识别器。

有没有什么办法解决这一问题？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T10:06:58.990

您只需要向 tableView 添加一个 SwipeGesture ，重要的是不要设置 swipeGesture 的委托，也不要实现gestureRecognizer`shouldRecognizeSimultaneouslyWithGestureRecognizer`功能。

```
UISwipeGestureRecognizer *swipeRight = [[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(callYourMehod:)];
swipeRight.direction = UISwipeGestureRecognizerDirectionRight;
[self.table addGestureRecognizer:swipeRight]; 
```

它应该像我已经实现并在我的代码中使用它一样工作这就是表格单元格不会在右侧滑动时进入编辑模式的方式。

# c# - 用画线分隔文本框中的文本？

> ID：13790034
> 
> 赞同：-2
> 
> 时间：2012-12-09T17:54:44.187
> 
> 标签：c#, wpf, textbox, split, separator

就这样，我在 wpf 中制作了 ac# 项目，并且我坚持尝试制作一个带有分隔文本的行的文本框。

目前我得到了这样的文本框：

![在此处输入图像描述](../Images/ccdb04a2cc53df37f0ca51571229c188.png)

而不是使用“-------”我想在文本框中创建一个预定义的行。这可能吗 ？

聚合酶。文本框在运行时可编辑

绘制的线应具有以下属性：

*   它不应该是可编辑的！
*   它不应该只是一个空行
*   它应该是一条具有宽度的可见线`line.width = box.width`！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T11:17:28.627

如果您不需要完整的文本框实现，那么这可能会有所帮助。不显示光标等确实存在问题，但可能会给您一个开始。

![在此处输入图像描述](../Images/0979c9ccdab06d99fddf453efdbbca38.png)

首先将以下转换器添加到您的项目中。

```
public class TextLineConverter : MarkupExtension, IValueConverter
{
    static TextLineConverter converter;

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        string[] results = null;
        string newText = value as string;
        if (newText != null)
        {
            results = newText.Split('\r');
            if (results.Length > 0)
                for (int i = 0; i < results.Length; i++)
                    if (results[i].Length > 0)
                        if (results[i][0] == '\n')
                            results[i] = results[i].Substring(1, results[i].Length - 1);
        }
        return results;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        if (converter == null) converter = new TextLineConverter();
        return converter;
    }

    public TextLineConverter()
    {
    }
} 
```

以及以下风格。

```
<Style TargetType="TextBox">
            <Style.Resources>
                <Style TargetType="ListViewItem">
                    <Setter Property="Margin" Value="0"/>
                    <Setter Property="Padding" Value="0"/>
                    <Setter Property="IsEnabled" Value="False"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate>
                                <Border BorderThickness="0,0,0,2" BorderBrush="Black" >
                                <ContentPresenter Content="{Binding}" />
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Style.Resources>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <ListView Focusable="False" ItemsSource="{Binding Text, Converter={local:TextLineConverter}, UpdateSourceTrigger=PropertyChanged, RelativeSource={RelativeSource TemplatedParent}}"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:00:09.587

在重新阅读您的问题时，我相信做您想做的最好的方法是创建您自己的用户控件，该控件具有专门用于此的属性。对 C# 用户控件进行一些研究，也许你会发现如何做到这一点。

# java - 如何在 while 循环中使用 scan.nextInt 提示用户 int 类型？

> ID：13790035
> 
> 赞同：1
> 
> 时间：2012-12-09T17:54:49.197
> 
> 标签：java, exception-handling, java.util.scanner

```
System.out.println("How long is the word you would like to guess?");
    while (goodInput==false)
            {
                try
                {
                    wordSize=scan.nextInt();
                    goodInput=true;
                }
                catch(InputMismatchException ime)
                {
                    System.out.println("Thats not a number! Try again");
                }
            } 
```

输入错误类型的输入后，控制台在无限循环中重复“那不是数字...”。

*编辑

我试过了

```
while(goodInput==false)
        {
            if (scan.hasNextInt())
            {
                wordSize=scan.nextInt();
                goodInput=true;
            }
            else
            {
                System.out.println("Thats not a number! Try again");
            }
        } 
```

这也会产生相同的错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:07:19.630

```
 while (goodInput==false) {
      System.out.println("How long is the word you would like to guess?");
      if (scan.hasNextInt()) {
        wordSize=scan.nextInt();
        goodInput=true;
      }
      else scan.next();
  } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T18:03:48.180

如果提供了非整数，则永远不会消耗输入，因此输入会一次又一次地传递，从而导致无限循环。你*可以*使用：

```
scan.nextLine(); 
```

在您的异常块中，但最好使用：

```
while (scan.hasNextInt() && !goodInput) { 
```

# objective-c - 线程 1：由于 XIB 中的未知类而发出信号 SIGABRT

> ID：13790039
> 
> 赞同：1
> 
> 时间：2012-12-09T17:55:20.407
> 
> 标签：objective-c, ios, xcode, interface-builder, xib

当我按下链接到该视图的按钮时出现以下错误。为什么？

```
2012-12-09 18:44:52.634 LNG[42719:c07] Unknown class DensityViewController in Interface Builder file.
2012-12-09 18:44:52.645 LNG[42719:c07] *** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<UIViewController 0x71bcb90> setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key ethaneText.'
*** First throw call stack:
(0x1c93012 0x10d0e7e 0x1d1bfb1 0xb7d711 0xafeec8 0xafe9b7 0xb29428 0x2350cc 0x10e4663 0x1c8e45a 0x233bcf 0xf8e37 0xf9418 0xf9648 0xf9882 0x105235 0x3043d2 0x1024f3 0x102777 0x1027b7 0x46dfe2 0x45fad9 0x45fb54 0x10e4705 0x1b920 0x1b8b8 0xdc671 0xdcbcf 0xdbd38 0x4b33f 0x4b552 0x293aa 0x1acf8 0x1beedf9 0x1beead0 0x1c08bf5 0x1c08962 0x1c39bb6 0x1c38f44 0x1c38e1b 0x1bed7e3 0x1bed668 0x1865c 0x2c1d 0x2b45)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

密度视图控制器.h：

```
#import <UIKit/UIKit.h>
#import "FlipsideViewController.h"
#import "MainViewController.h"
@interface DensityViewController : UIViewController
[More code] 
```

和密度视图控制器.m

```
#import "DensityViewController.h"

@interface DensityViewController ()

@end

@implementation DensityViewController
[More code] 
```

最后是我的 XIB 的照片（IK 看起来很糟糕，WIP） ![在此处输入图像描述](../Images/22502151cc43891939a5f397acaec061.png)

我能做些什么来纠正这个错误？编辑：全.m

```
#import "DensityViewController.h"

@interface DensityViewController()

@end

@implementation DensityViewController
@synthesize tempratureText, methaneText, ethaneText, propaneText, nbutaneText,     ibutaneText,npetaneText, ipetaneText, nhexaneText, nitrogenText, oxygenText, outputText;

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

-(IBAction)textFieldReturn:(id)sender
{
[sender resignFirstResponder];
}
-(IBAction)backgroundTouched:(id)sender
{
[tempratureText resignFirstResponder];
[methaneText resignFirstResponder];
[ethaneText resignFirstResponder];
[propaneText resignFirstResponder];
[nbutaneText resignFirstResponder];
[ibutaneText resignFirstResponder];
[npetaneText resignFirstResponder];
[ipetaneText resignFirstResponder];
[nhexaneText resignFirstResponder];
[oxygenText resignFirstResponder];
[nitrogenText resignFirstResponder];

}

- (void)updateConversionLabel:(UITextField *)textField
{

NSNumberFormatter *fmt1  =  [NSNumberFormatter new]; //Temp
NSNumberFormatter *fmt2  =  [NSNumberFormatter new]; //Methane
NSNumberFormatter *fmt3  =  [NSNumberFormatter new]; //Ethane
NSNumberFormatter *fmt4  =  [NSNumberFormatter new]; //Propane
NSNumberFormatter *fmt5  =  [NSNumberFormatter new]; //n-butane
NSNumberFormatter *fmt6  =  [NSNumberFormatter new]; //i-butane
NSNumberFormatter *fmt7  =  [NSNumberFormatter new]; //n-petane
NSNumberFormatter *fmt8  =  [NSNumberFormatter new]; //i-petane
NSNumberFormatter *fmt9  =  [NSNumberFormatter new]; //n-hexane
NSNumberFormatter *fmt10 =  [NSNumberFormatter new]; //nitrogen
NSNumberFormatter *fmt11 =  [NSNumberFormatter new]; //oxygen

double temprature = [fmt1  numberFromString:tempratureText.text].doubleValue;
double methane    = [fmt2  numberFromString:methaneText.text   ].doubleValue;
double ethane     = [fmt3  numberFromString:ethaneText.text    ].doubleValue;
double propane    = [fmt4  numberFromString:propaneText.text   ].doubleValue;
double nbutane    = [fmt5  numberFromString:nbutaneText.text   ].doubleValue;
double ibutane    = [fmt6  numberFromString:ibutaneText.text   ].doubleValue;
double npetane    = [fmt7  numberFromString:npetaneText.text   ].doubleValue;
double ipetane    = [fmt8  numberFromString:ipetaneText.text   ].doubleValue;
double nhexane    = [fmt9  numberFromString:nhexaneText.text   ].doubleValue;
double nitrogen   = [fmt10 numberFromString:nitrogenText.text  ].doubleValue;
double oxygen     = [fmt11 numberFromString:oxygenText.text    ].doubleValue;

double Xi = 1;
double Mi = 2;
double Vi = 3;
double Vc = 4;
//Do not mind this, just placeholders for some other stuffs. 

double over1 = Xi * Mi;
double under1 = Xi * Vi - Vc;

double result =  over1 / under1;

NSString *resultString = [[NSString alloc]initWithFormat:@" Test %f", result];
/*
outputText.text = resultString;
*/
if (temprature == 0 || methane == 0 || ethane == 0 || propane == 0 || nbutane == 0 || ibutane == 0 || oxygen == 0 || npetane == 0 || ipetane == 0 || nhexane == 0 || nitrogen == 0)
{
    outputText.text = @"Please enter all values";
} else
{
    outputText.text = resultString;
}
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T18:11:50.073

试图删除界面中的 nibe 并重新从头开始。因为您可能会从其他项目中复制 nib，所以有时 xcode 会以这种方式运行。它肯定会起作用。

# iphone - 旋转拨盘 - 旋转限制

> ID：13790042
> 
> 赞同：2
> 
> 时间：2012-12-09T17:55:45.743
> 
> 标签：iphone, ios, ipad

我正在制作一部老式手机并获得了一个有效的起始代码，用户将手指移到 UIImageView 数字上并旋转拨号。然后将其移回原始位置。见截图。

![在此处输入图像描述](../Images/037e3f68a17253168fe2279d1df48bbc.png)

我似乎无法弄清楚的三个问题是；

1.  如何限制用户只能顺时针旋转？目前用户可以在任何方向（顺时针和逆时针）移动它

2.  如何检测用户选择了哪个号码？意思是用户触摸了 1 或 3 或 5？我需要此信息，以便在该数字到达右侧栏时停止旋转。

3.  在我当前的代码中，当我停止旋转并放开圆圈时，它会通过逆时针方向移回原位。如果我选择 1、2、3、4 效果很好，但对于任何数字 5 及以上，表盘顺时针移动回其原始位置。如何在 touchesEnded 上强制逆时针运动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T08:56:05.033

假设您正在谈论这个手势：

![转盘](../Images/85df4d009d907096e11536204fef7005.png) [来源](http://www.flickr.com/photos/emilymills/3173010050)。

* * *

构建单点触控旋转手势识别器。正确构建手势识别器后，您只需查看旋转并了解如何使用旋转垫。

在构建单点触控旋转手势识别器时，您需要考虑几件事。如果您查看`UIRotationGestureRecognizer`，它使用两个手指支持的两次触摸之间的连接来得出当前角度，然后将该角度与从较早的触摸更改事件得出的前一个角度进行比较，以查看增量。

**测量当前角度**

形成一条线需要两个点，并且您需要一条线来知道角度。如果您只使用一次触摸，则需要一个锚点。有很多方法可以将锚点发送到手势识别器，并且由于您可能要构建自定义类，请使用委托。

**累积旋转计数**

如果您只是在触摸更改期间记下角度并发送消息，它有时会起作用。但是，如果您想实现滞后（例如，这个旋转刻度盘只会顺时针旋转一次，然后它会收紧），您需要累积顺时针和逆时针方向的旋转计数。

幸运的是，您可以假设 a) 触摸事件不会太频繁地丢弃，并且 b) 只需将当前角度与过去角度进行比较，看看它们是否跨越象限边界就足够了。

例如：

*   如果触摸从左上象限移动到右上象限，则将旋转计数加一。
*   如果触摸从右上象限移动到左上象限，则从旋转计数中减去 1。

（是的，这确实有效。）

**发出正确的累积旋转**

如果你想像以前一样发出旋转信息`UIRotationGestureRecognizer`，你将跟踪四件事。

1.  **起始角度：**从锚点到起始触摸的连接与从锚点到固定参考点的连接之间的角度。
2.  **当前角度：**从锚点到当前触摸的连接与从锚点到固定参考点的连接之间的角度。
3.  **Rotation Count：**顺时针旋转的次数，通过不断比较当前角度的当前值与其上一个值（如上一节所述）得出。如果触摸逆时针移动，则该计数将变为负数。

您将提供`Rotation Count * 2_PI + (Current Angle - Starting Angle)`轮换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T20:38:13.370

这是一个更好的表盘：

![在此处输入图像描述](../Images/e55837bccf9b8495678d555ff58f0407.png)

玩得开心！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:17:23.947

好的，我会采取不同的方法。首先，您要创建一个`RotaryDial`类来封装所有行为。然后，您可以将其插入您认为合适的任何视图中。

为了简单起见，我会考虑让每个数字按钮成为可移动的 UIImageView，调用它`RotaryDialDigit`或类似的东西。您将实例化并放置其中的十个。

`RotaryDialDigit`当用户移动其中一个按钮时，表盘“框架”只会标记骑行。它只是一个图像（除非您希望用户能够触摸它并对其进行操作。

从那里，知道哪个按钮被按下并将其旋转限制在给定方向以及停在酒吧是相当容易的事情。

通过使用协议，您可以让`RotaryDial`实例在拨打号码时告诉容器。`RotaryDial`每次按下按钮时，容器都会感觉像键盘发送消息。除了完成的数字选择之外，您真的不希望容器打扰其他任何事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T22:42:55.787

在没有看到您的代码的情况下，我假设这些数字是静态图像，并且当手指孔旋转经过每个数字时，您正在为它们设置动画。如果是这样：

检测哪个数字：在每个按钮周围定义一个 CGRect。当用户点击屏幕时，检查哪个矩形包含点击位置。

控制旋转方向：当用户拖动手指时，连续计算从刻度盘到当前点击位置的角度。如果角度向错误的方向移动，请不要更新指孔的位置。请注意，三角函数返回从 +Pi 到 -Pi 弧度的值。对于大于 5 的数字，您可能希望将 2Pi 弧度（或 360 度）添加到角度，而不是处理负角度。

旋转错误的方式：5以下的数字是在0到-Pi范围内的生成角度。在没有看到代码的情况下，我怀疑将 2Pi 添加到角度会纠正您的旋转方向。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T19:21:25.873

要检测哪个数字被触摸，当您创建每个数字时，您应该设置`tag`其 UIView 的值。然后，当用户触摸该数字时，您可以通过检查该标签值来检测它是哪个 UIView 对象。

对于旋转问题，我建议看看你是如何计算角度的。我猜我会说对于大于 4 的数字（你可以从标签中看出），你需要做一些事情，比如从 360 度（以及 2Pi）中减去你当前计算的角度。（但我现在有点感冒，所以实际的数学正在逃避我:-)）

# android - 下载apk并在android应用程序中开始安装提示

> ID：13790048
> 
> 赞同：1
> 
> 时间：2012-12-09T17:56:21.470
> 
> 标签：android

我正在构建一个私有企业 Android 应用程序。我的目标是检测何时有可用更新并为用户提供下载。如果用户选择下载更新文件，则会显示安卓应用安装提示。

我成功检查更新，问题是没有下载 apk 文件（创建了空文件），因此“解析包时出现问题。” android 应用安装提示中显示错误。

代码：

```
public void downloadfileto(String fileurl, String filename) { 
    String myString; 
    try { 
            FileOutputStream f = new FileOutputStream(filename); 
            try { 
                    URL url = new URL(fileurl); 
                    URLConnection urlConn = url.openConnection(); 
                    InputStream is = urlConn.getInputStream(); 
                    BufferedInputStream bis = new BufferedInputStream(is, 8000); 
                    int current = 0; 
                    while ((current = bis.read()) != -1) { 
                            f.write((byte) current); 
                    } 
            } catch (Exception e) { 
                    myString = e.getMessage(); 
            } 
            f.flush(); 
            f.close(); 
            install(filename);
    } catch (FileNotFoundException e) { 
            e.printStackTrace(); 
    } catch (IOException e) { 
            e.printStackTrace(); 
    } 
} 

protected void install(String fileName) {
    Intent install = new Intent(Intent.ACTION_VIEW);
    install.setDataAndType(Uri.fromFile(new File(fileName)),
            "application/vnd.android.package-archive");
    startActivity(install);
} 
```

函数 downloadfileto 被调用：

```
downloadfileto("http://some-url/ind.apk", "data/data/my.package.name/app.apk"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:31:01.353

即使您下载成功，您也无法安装 APK 文件，因为安装程序将无法读取该文件。另外，正如 Chris Stratton 指出的那样，您的硬编码路径是草率的（在 Android 4.1 和更早版本上）和灾难性的（在 Android 4.2 和更高版本上）。

就下载逻辑而言，一次下载一个字节的性能不太可能很好。尝试这样的事情（对于`File`命名`output`和`URL`命名`url`）：

```
 HttpURLConnection c=(HttpURLConnection)url.openConnection();

  c.setRequestMethod("GET");
  c.setReadTimeout(15000);
  c.connect();

  FileOutputStream fos=new FileOutputStream(output.getPath());
  BufferedOutputStream out=new BufferedOutputStream(fos);

  try {
    InputStream in=c.getInputStream();
    byte[] buffer=new byte[8192];
    int len=0;

    while ((len=in.read(buffer)) > 0) {
      out.write(buffer, 0, len);
    }

    out.flush();
  }
  finally {
    fos.getFD().sync();
    out.close();
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:50:53.163

我要感谢大家在这里的帮助。我通过在服务器上打开 php 脚本解决了这个问题，该脚本使用 Web 视图计算下载量、检测下载、下载路径和启动活动以安装应用程序。

文件名始终采用“ind-version.apk”形式（例如：ind-1-0.apk），因为我在检查更新时获得了新更新的版本号，所以我决定将其放入附加文件中并用于确定文件名。

代码：

```
 WebView myWebView = (WebView) findViewById(R.id.helpview);
    showDialog();
    myWebView.setWebViewClient(new WebViewClient());

    myWebView.loadUrl(url);
    myWebView.getSettings().setJavaScriptEnabled(false);

    myWebView.setWebViewClient(new WebViewClient() {
         @Override  
         public void onPageFinished(WebView view, String url) {
             super.onPageFinished(view, url);
             dismissDialog();
         }  
    });

    myWebView.setDownloadListener(new DownloadListener() {
        public void onDownloadStart(String url, String userAgent,
                String contentDisposition, String mimetype,
                long contentLength) {
            Intent intent = new Intent(Intent.ACTION_VIEW);
            intent.setData(Uri.parse(url));
            startActivity(intent);

            Bundle extras = getIntent().getExtras();
            String v = extras.getString("v");
            v = v.replace(".", "-");
            Log.i("File", v);

            File loc = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS);
            Log.i("File", loc.toString() + "/ind-" + v + ".apk");

            install(loc.toString() + "/ind-" + v + ".apk");
        }
    }); 
```

并安装：

```
protected void install(String fileName) {
    Intent install = new Intent(Intent.ACTION_VIEW);
    install.setDataAndType(Uri.fromFile(new File(fileName)),
            "application/vnd.android.package-archive");
    startActivity(install);
} 
```

# php - PHP 101：变量与函数

> ID：13790051
> 
> 赞同：4
> 
> 时间：2012-12-09T17:56:44.670
> 
> 标签：php, performance

我正在创建一个全局文件来保存将在我的网站中重复使用的项目。这两行代码有什么区别？这个比那个好吗？

这个：

```
$logo = "img/mainlogo.jpg"; 
```

与这个：

```
function logo() {
   echo "img/mainlogo.jpg";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:05:06.863

您应该在 html 和 php 中编写清晰易读的代码并拆分。业绩利润并不显着...

```
<?php
...
$logo = "img/mainlogo.jpg";
...
?>
...
<img src="<?= $logo ?>" alt="logo"> 
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:05:53.953

在您发布的两个选项中，该功能是更好的选择。但是，老实说，这种事情*正是*常量的用途：

```
defined('MAIN_LOGO') || define('MAIN_LOGO','img/mainlogo.jpg'); 
```

假设您在一个必须支持多种语言的网站上工作，那么您可以简单地使用相同的技巧：

```
defined('CLIENT_LOCALE')  || define('CLIENT_LOCATE',$whereverYouGetThisFrom);
defined('MAIN_LOGO') || define('MAIN_LOGO','img/mainlogo_'.CLIENT_LOCALE.'.jpg');
//if language is EN, mainlogo_EN.jpg will be used, if lang is ES, mainlogo_ES.jpg, etc... 
```

此外，一个常量，一旦定义就不能重新定义（当然，线索就在名称中）。另外：由于 PHP 在引擎盖下仍然有很多 C 内容，并且您已经标记了这个问题`performance`，您可能会感兴趣的是常量很像 C 的宏，它比常规函数调用甚至 C++ 快得多内联函数（即使它们确实被编译为内联函数）。

无论如何，如果你有很多想要集中的东西，要么考虑`ini`为你的项目创建几个文件，然后将它们解析为某种全局对象

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:16:52.463

函数的主要目的是避免代码重复并执行特定任务。根据该定义，使用函数只返回一个值是一个糟糕的设计。

在这种情况下，我认为代码的良好可读性比节省几个字节的内存更好。我们在 2012 年，优化很好，但这种类型的微优化简直荒谬。我更喜欢分配一个变量，它很清楚并且做你所期望的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T18:01:45.077

### 功能不错。

我`function logo()`看那比`$logo`. `echo`不占用太多内存，但`$logo`确实如此。即使`function logo()`需要一些东西，它也会由 PHP 自己的垃圾收集器处理。您还可以使用这些功能来确保您没有滥用分配的内存。

1.  `memory_get_peak_usage();`
2.  `memory_get_usage();`

### 解释：

> 在使用中的函数结束时，PHP 会清除它正在使用的内存，至少比不使用函数时效率更高。如果您使用递归代码或类似的内存密集型代码，请尝试将代码放入函数或方法中，在关闭函数/方法时，用于函数的内存将比在循环中取消设置变量更有效地被垃圾处理本身。

**来源：** [防止PHP内存耗尽的7个技巧](http://v1.srcnix.com/2010/02/10/7-tips-to-prevent-php-running-out-of-memory/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T18:00:59.213

`$logo = "img/mainlogo.jpg";`可以在以后自然地重新定义，而无需通过这样做更改代码，`$logo="img/newmainlogo.jpg";`而函数必须在其第一个定义中自行修改。

# c# - 在 C# 中使用单密钥加密

> ID：13790054
> 
> 赞同：1
> 
> 时间：2012-12-09T17:57:13.170
> 
> 标签：c#, encryption

我在 C# 中有一个加密和解密 .txt 文件的代码。但我需要使用任何扩展名（如 pdf、zip、jpg 等）加密和解密文件。

我搜索蚂蚁试图找到流加密，但我找不到任何..

我正在尝试遵循[链接](http://support.microsoft.com/kb/307010)中的代码。我更改了文件路径并放了一些pdf或ppt。它工作正常，但我无法打开解密文件。

```
 using System;
using System.IO;
using System.Security;
using System.Security.Cryptography;
using System.Runtime.InteropServices;
using System.Text;

namespace CSEncryptDecrypt
{
   class Class1
   {
      //  Call this function to remove the key from memory after use for security
      [System.Runtime.InteropServices.DllImport("KERNEL32.DLL", EntryPoint="RtlZeroMemory")]
      public static extern bool ZeroMemory(IntPtr Destination, int Length);

      // Function to Generate a 64 bits Key.
      static string GenerateKey() 
      {
         // Create an instance of Symetric Algorithm. Key and IV is generated automatically.
         DESCryptoServiceProvider desCrypto =(DESCryptoServiceProvider)DESCryptoServiceProvider.Create();

         // Use the Automatically generated key for Encryption. 
         return ASCIIEncoding.ASCII.GetString(desCrypto.Key);
      }

      static void EncryptFile(string sInputFilename,
         string sOutputFilename, 
         string sKey) 
      {
         FileStream fsInput = new FileStream(sInputFilename, 
            FileMode.Open, 
            FileAccess.Read);

         FileStream fsEncrypted = new FileStream(sOutputFilename, 
            FileMode.Create, 
            FileAccess.Write);
         DESCryptoServiceProvider DES = new DESCryptoServiceProvider();
         DES.Key = ASCIIEncoding.ASCII.GetBytes(sKey);
         DES.IV = ASCIIEncoding.ASCII.GetBytes(sKey);
         ICryptoTransform desencrypt = DES.CreateEncryptor();
         CryptoStream cryptostream = new CryptoStream(fsEncrypted, 
            desencrypt, 
            CryptoStreamMode.Write); 

         byte[] bytearrayinput = new byte[fsInput.Length];
         fsInput.Read(bytearrayinput, 0, bytearrayinput.Length);
         cryptostream.Write(bytearrayinput, 0, bytearrayinput.Length);
         cryptostream.Close();
         fsInput.Close();
         fsEncrypted.Close();
      }

      static void DecryptFile(string sInputFilename, 
         string sOutputFilename,
         string sKey)
      {
         DESCryptoServiceProvider DES = new DESCryptoServiceProvider();
         //A 64 bit key and IV is required for this provider.
         //Set secret key For DES algorithm.
         DES.Key = ASCIIEncoding.ASCII.GetBytes(sKey);
         //Set initialization vector.
         DES.IV = ASCIIEncoding.ASCII.GetBytes(sKey);

         //Create a file stream to read the encrypted file back.
         FileStream fsread = new FileStream(sInputFilename, 
            FileMode.Open, 
            FileAccess.Read);
         //Create a DES decryptor from the DES instance.
         ICryptoTransform desdecrypt = DES.CreateDecryptor();
         //Create crypto stream set to read and do a 
         //DES decryption transform on incoming bytes.
         CryptoStream cryptostreamDecr = new CryptoStream(fsread, 
            desdecrypt,
            CryptoStreamMode.Read);
         //Print the contents of the decrypted file.
         StreamWriter fsDecrypted = new StreamWriter(sOutputFilename);
         fsDecrypted.Write(new StreamReader(cryptostreamDecr).ReadToEnd());
         fsDecrypted.Flush();
         fsDecrypted.Close();
      } 

      static void Main()
      {
         // Must be 64 bits, 8 bytes.
         // Distribute this key to the user who will decrypt this file.
         string sSecretKey;

         // Get the Key for the file to Encrypt.
         sSecretKey = GenerateKey();

         // For additional security Pin the key.
         GCHandle gch = GCHandle.Alloc( sSecretKey,GCHandleType.Pinned );

         // Encrypt the file.        
         EncryptFile(@"C:\MyData.txt", 
            @"C:\Encrypted.txt", 
            sSecretKey);

         // Decrypt the file.
         DecryptFile(@"C:\Encrypted.txt", 
            @"C:\Decrypted.txt", 
            sSecretKey);

         // Remove the Key from memory. 
         ZeroMemory(gch.AddrOfPinnedObject(), sSecretKey.Length * 2);
         gch.Free();
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T18:45:12.477

感谢您的回复。我找到了原因。我应该在decryptFile函数中使用filestream而不是streamwriter

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-09T18:11:10.233

按照我用来安全地序列化对象的例程。也许它可以帮助您了解流加密的工作原理：

```
public bool Save(string filename, object toSerialize)
    {

        byte[] SALT = new byte[]
        {0x26, 0xdc, 0xff, 0x00, 0xad, 0xed, 0x7a, 0xee, 0xc5, 0xfe, 0x07, 0xaf, 0x4d, 0x08, 0x22, 0x3c};

        string EncryptionKey = "MYPASSWORD";

        //basic serialization
        IFormatter form = new BinaryFormatter();
        var stream = new MemoryStream();
        form.Serialize(stream, toSerialize);

        //cryptography preparation
        var alg = new RijndaelManaged();
        var pdb = new Rfc2898DeriveBytes(EncryptionKey, SALT);
        alg.Key = pdb.GetBytes(32);
        alg.IV = pdb.GetBytes(16);

        stream.Position = 0;
        //cryptorgraphy serialization
        var encStream = new MemoryStream();
        var cryptoStream = new CryptoStream(encStream, alg.CreateEncryptor(), CryptoStreamMode.Write);
        cryptoStream.Write(stream.ToArray(), 0, (int)stream.Length);
        cryptoStream.FlushFinalBlock();

        var outputFileStream = new FileStream(fileName, FileMode.Create);
        outputFileStream.Write(encStream.ToArray(), 0, (int)encStream.Length);
        outputFileStream.Close();

        return true;
    } 
```

我还可以为您提供反序列化加密流的来源。

# javascript - jQuery没有更新一些跨度

> ID：13790056
> 
> 赞同：2
> 
> 时间：2012-12-09T17:57:39.003
> 
> 标签：javascript, jquery, html, repopulation

我正在为角色扮演游戏 GURPS 构建一个基于 Web 的工具。数据保存在几个加载到数组中的 XML 文件中。根据用户所做的更改，将数据重新填充到数组中的各种跨度、输入和下拉列表中。到目前为止没有问题。

为了给用户更多反馈，我添加了一个锚点，它会弹出一个悬停弹出窗口，显示当前武器的详细信息。对于初始编码，在我解决渲染问题时，这些值是硬编码的。仍然没有问题。

现在我正在尝试用真实数据填充悬停弹出窗口。我无法将真实数据加载到跨度中！我已经调试了这个函数，并且确定我已经提取了我想要的数据。我使用了类似的代码行来填充网页的其他部分。

细节：我想替换下面跨度中的“aa”：

```
<span id="weaponName1" name="weaponName1" class="weaponName">aa</span><img src="Images/Firearms/Makarov_Suppressed.jpg"> 
```

我用来*尝试*重新填充跨度的代码是：

```
function loadWeaponStats(person, weaponID) {
// Load stats of the current weapon into the "Details" anchor fly-out
for (xx1=0; xx1<WeaponsArray.length; xx1++) {
    if (weaponID == WeaponsArray[xx1][0]) {
        weaponName = WeaponsArray[xx1][1];
        alert("weaponName: "+weaponName+"\nperson: "+person);
        $("#weaponName"+person).val(weaponName);
        xx1 = WeaponsArray.length;  // Kill the loop
    }
} 
```

}

alert() 只是为了确认我有正确的数据。以下行*应*重新填充跨度，但事实并非如此。

所有 HTML、CSS 和 JavaScript 都可以在[GURPS 战斗计算器中找到](http://www.blackeagleblackeagle.com/webs/bebe/CombatCalculators/GURPS/index.html)

拔掉我剩下的一点头发。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:06:53.930

您还可以执行以下操作：

```
 $("#weaponName"+person).text(weaponName); 
```

你不能在这里使用 Val() 方法。

# iphone - PageControl 页面处理

> ID：13790063
> 
> 赞同：0
> 
> 时间：2012-12-09T17:58:25.143
> 
> 标签：iphone, xcode

我正在尝试将 UIPageControl 与我的 UIScrollView 一起使用。似乎我做错了什么，因为页面总是设置为一个。

这是我的 ViewDidLoad：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    scrollView.delegate = self;

    UIImageView *imgView1 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"tutorialScreen1.png"]];
    imgView1.frame = CGRectMake(0, 0, 320, 436);
    [scrollView addSubview:imgView1];

    UIImageView *imgView2 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"tutorialScreen2.png"]];
    imgView2.frame = CGRectMake(320, 0, 320, 436);
    [scrollView addSubview:imgView2];

    UIImageView *imgView3 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"tutorialScreen3.png"]];
    imgView3.frame = CGRectMake(640, 0, 320, 436);
    [scrollView addSubview:imgView3];

    scrollView.contentSize = CGSizeMake(960, 436);

    pageControl = [[UIPageControl alloc] init];

    [pageControl setNumberOfPages:3];
    [pageControl setCurrentPage:0];    
} 
```

这是我的 UIScrollView 委托方法：

```
-(void)scrollViewDidEndDecelerating:(UIScrollView *)scrollViewx{
    NSLog(@"%f",scrollView.contentOffset.x);
    NSLog(@"%f",(scrollViewx.contentOffset.x / 320));
    pageControl.currentPage = ((scrollViewx.contentOffset.x / 320));
} 
```

这是 y .h 文件：

```
@interface TutorialViewController : UIViewController <UIScrollViewDelegate>

@property (nonatomic,strong) IBOutlet UIScrollView *scrollView;
@property (nonatomic,strong) IBOutlet UIPageControl *pageControl;

@end 
```

有谁知道为什么它不改变？当然，我确保我的 UIPageControl 已连接到它的实例。

感谢你的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:34:28.620

好的。点没有改变，因为您创建了一个新的 UIPageControl 而不是使用您在 IB 中设置的那个。取出：`pageControl = [[UIPageControl alloc] init];`

# java - 什么是用于图像转换和后缓冲渲染的好 Java 库，而不需要用于服务器端编程的前端缓冲区？

> ID：13790064
> 
> 赞同：2
> 
> 时间：2012-12-09T17:58:28.837
> 
> 标签：java, image

我正在尝试找到一个简单的库来满足我的需求，但是因为我真的不知道 Java 库（我过去常常用我使用的任何编程语言从头开始做所有事情），而我需要的正是复杂的东西谷歌搜索查询，将不胜感激任何推荐。

我想要实现的是使用来自网络浏览器的提交信息在服务器端进行一些图像处理。不是简单的缩放或裁剪，而是能够旋转、缩放和裁剪每个精灵，并按照准确的顺序绘制它，以在后台缓冲区中合成最终的高分辨率图像，然后将其保存在 bmp 中并以较低的分辨率制作一些副本.png

我对从客户端到服务器的接口没有问题，而且我有游戏编程经验，所以我知道如何使用双缓冲。我需要的是一个库，它可以让我在不需要前缓冲区和图形硬件的情况下进行所有这些图像转换和后缓冲区绘制，因为输出不会是屏幕，并且能够访问内存中的每个像素 argb，能够以各种图像格式保存并作为一个加号但不要求能够从不同的字体呈现文本。

感谢您的任何回复和任何改进我的问题的建议也将不胜感激（我是新来的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-03T10:12:45.647

您可能会发现一些对 Java 中的服务器端图像处理很有帮助的库：

*   JH Labs 图像过滤器：[http ://www.jhlabs.com/ip/filters/index.html](http://www.jhlabs.com/ip/filters/index.html)
*   imgscalr 图片缩放库：[https ://github.com/thebuzzmedia/imgscalr](https://github.com/thebuzzmedia/imgscalr)

也不要忘记已经在 J​​ava 中的良好的旧 BufferedImage API：它具有快速的基本图像处理（裁剪等）的一系列功能。

*   [http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html](http://docs.oracle.com/javase/7/docs/api/java/awt/image/BufferedImage.html)

# python - 使用 .htaccess 通过 Tornado 保护 Web 请求

> ID：13790066
> 
> 赞同：1
> 
> 时间：2012-12-09T17:58:41.020
> 
> 标签：python, .htaccess, authorization, tornado

我用 Tornado 实现了一个非常小的应用程序，其中使用 HTTP GET 请求来执行操作。现在我想保护这些请求。什么是更好的方法？使用.htaccess？我怎么能意识到这一点？

它不一定适用于某些请求，它应该适用于在某个端口上运行的所有请求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T00:57:13.110

如果您的应用程序基于 Tornado“Hello World”示例，那么您可能没有，但您确实应该考虑将您的应用程序编写为`WSGI`应用程序。Tornado 对此没有任何问题，其优点是您的应用程序现在可以在多种其他环境下运行（`Apache`+`mod_wsgi`仅举一个例子）。

但这如何解决您最初的问题？好吧，只是谷歌“WSGI 身份验证中间件”，它会产生大量的点击。基本上，这需要透明地将您的应用程序“包装”`WSGI`在另一个应用程序中，一个允许您完全解耦应用程序的那个方面。如果你很幸运，并且其中一个命中结果非常合适，那么你可能根本不需要任何额外的代码就可以侥幸逃脱。

既然您提到`.htaccess`：*可以*让 Apache 在 Apache/mod_wsgi 配置中进行身份验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:18:53.603

`.htaccess`据我所知，Tornado 不支持文件。研究在 Tornado 上设置基本身份验证。像这样的东西：[https](https://gist.github.com/660185) ://gist.github.com/660185可能是你想要的。您需要存储自己的用户凭据，但 Tornado 没有像 apache 对 .htaccess 文件那样支持这一点。

# javascript - 如何更改html元素的顺序

> ID：13790070
> 
> 赞同：-2
> 
> 时间：2012-12-09T17:58:59.853
> 
> 标签：javascript, jquery, html

例如，我有一个这样的 li 列表：

```
<li id='r1' class='myclass'>something</li>
<li id='r2' class='myclass'>something</li>
<li id='r3' class='myclass'>something</li>
<li id='r4' class='myclass'>something</li>
<li id='r5' class='myclass'>something</li> 
```

我想使用一个函数来相互替换两个 li。

例如：将 li2 o 放在第一位，将 li1 放在第二位。

我有这样的功能：

```
function updown(li_id , dir)
{
 //what should i type here....
} 
```

li_id: 是我的 li id

dir：是“向上”还是“向下”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T17:59:57.153

使用 before() 或 after() 交换两个元素的顺序：

```
$('#r1').before($('#r2'));​ 
```

[**小提琴**](http://jsfiddle.net/2Ua2a/10/)

或您的功能：

```
function updown(li_id , dir) {
    $('#'+li_id)[dir!='up'?'before':'after']($('#'+li_id)[dir!='up'?'next':'prev']());
} 
```

像这样使用：

```
updown('r3', 'up');
updown('r1', 'down'); 
```

[**小提琴**](http://jsfiddle.net/2Ua2a/11/)

# c# - 如何选择安全传输协议

> ID：13790073
> 
> 赞同：2
> 
> 时间：2012-12-09T17:59:10.057
> 
> 标签：c#, linux, sftp

我正在帮助设计一个需要在服务器上安全传输和存储文件的应用程序。该应用程序是用 C# 编写的，但服务器是基于 Linux 的。我应该使用什么协议来传输和存储这些文件，最大为 2 GB？

我已经阅读了一些 sftp 和 ssh。这些会有什么好处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:10:50.410

如果您想要使用 .NET 使用最少的组件轻松安全地传输 BIG 文件，您通常会想要使用 FTPES，也称为**FTP through Explicit SSL**，有时也称为“FTPS”或“FTP-ES”。这是唯一受纯 .NET 方法支持且无需第三方插件的版本。

与 FTPES 不同，使用 SFTP 或 FTP over [SSH](http://www.ietf.org/rfc/rfc4253.txt)，您将不得不在您和您的客户端之间手动交换密钥。您还需要第三方库来实现它，因为 .NET 没有 SFTP 的内置功能。

如果您想编写一个客户端来使用 FTPES，您所要做的就是使用 FtpWebRequest 并将[EnableSSL 设置为 true](http://msdn.microsoft.com/en-us/library/system.net.ftpwebrequest.enablessl.aspx)。

**要避免什么：**

*   不要通过[隐式 SSL](https://stackoverflow.com/questions/1842186/does-net-ftpwebrequest-support-both-implicit-ftps-and-explicit-ftpes)使用 FTP 。在这一点上它已经被弃用了很多年，应该被认为是过时的。

*   不要只是对文件进行 PGP 加密，然后通过普通的旧 FTP 传输它们。使用普通的旧 FTP，所有用户名和密码都以明文形式发送，这将很容易让攻击者至少拦截您的 PGP 加密文件。

# ruby-on-rails - Ransack：可以自定义页面大小吗？

> ID：13790078
> 
> 赞同：3
> 
> 时间：2012-12-09T17:59:31.603
> 
> 标签：ruby-on-rails, spree, ransack

我正在使用 Spree，在产品/搜索控制器操作中它使用 Ransack。Spree 文档说 Spree 没有提供自定义页面大小的方法，所以我想我应该自定义操作本身以使用 Ransack 完全关闭分页。Ransack 是否支持不对结果进行分页或至少使分页变大的方法？

这是现有控制器操作中的代码：

```
@products = product_scope.ransack(params[:q]).result.page(params[:page]) 
```

当我把 @products 的类型放在后面时，它是 ActiveRecord::Relation。当我放

@products = product_scope.ransack(params[:q]).result

它也是 ActiveRecord::Relation，但在第一种情况下，rabl 模板中使用了一种方法“total_count”，而第二种方法中不存在。我已经挖掘了 ransack 的源代码，但找不到 .page 的定义位置。我想知道它是否可能包含在 Spree 引入的其中一个宝石中的 ActiveRecord::Relation 的一些 class_eval 中。

必须有人在某个地方遇到过这个问题并提出解决方案。我希望能找到那个人：P

京东

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T21:19:09.977

该`.page`方法来自 Kaminari gem，而不是 Ransack。

您可以通过更改 Kaminari 中的默认 per_page 值来使分页“巨大”：

`Kaminari.config.default_per_page = 1000`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T05:07:01.483

Ryan 已经得到了你，但我不确定是否还有其他方法可以做到这一点。如果您只是在谈论每页显示的产品数量，我无法从您的问题中看出，但听起来您是。

如果是这样，我已经使用内置的 Spree 首选项进行了相同的修改`products_per_page`。当 Spree 提供偏好时，我更喜欢（不是双关语）使用它而不是修改 gem 参数，因为它已经是他们设计的一部分。

我用 启动控制台`bundle exec rails c`，然后运行以下命令将我商店的首选项设置为每页 16 个产品： `Spree::Config.products_per_page = 16`

您也可以将它放在您的一个初始化文件中，这样如果您从头开始重建数据库，它就不会被意外删除...我从Spree 组的[这篇文章中了解到它。](https://groups.google.com/forum/?fromgroups=#!topic/spree-user/Hqf11LmGeC4)[我还在这里](http://guides.spreecommerce.com/preferences.html)找到了有关设置 Spree 首选项的详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-12T19:25:17.677

您想使用`.per`，例如：

```
collection.per(100)
collection.page(3).per(100)
collection.per(100).per(3) 
```

这些中的任何一个都可以。

# web - 使用密码保护网站（无用户名）

> ID：13790080
> 
> 赞同：0
> 
> 时间：2012-12-09T17:59:34.203
> 
> 标签：web, password-protection

是否有任何现成的解决方案可以仅使用密码（即没有用户名字段）来保护网站（或单个页面）？我一直在四处寻找，但没有找到任何东西。

密码保护不必特别强。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T06:16:42.190

您可以通过网址`?p=password-goes-here`末尾的网址发送密码。

比在网页上做的：

```
if($_GET['p'] != 'mach-password-goes-here'){
die("Wrong password.");
}else{
//the page content goes here
} 
```

为了提高安全性，您可以在 sha1 和 sult 中散列密码

```
if(sha1($_GET['p'].'sdfjkhdsfiosio213ij2') != 'sha1-with-sult-ass-goes-here'){
die("Wrong password.");
}else{
//the page content goes here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:06:28.800

我会使用 md5 加密密码，使用 JavaScript 询问密码，加密结果并查看两个值是否相等：

```
if("<MD5_PASSWORD>" == md5(window.prompt("Password", ""))){
    // right
}else{
    // wrong
} 
```

JavaScript 中的 md5 函数的代码，您可以在[此处](http://aktuell.de.selfhtml.org/artikel/javascript/md5/)获取。

# java - 如何指示下载文件的目的地

> ID：13790081
> 
> 赞同：0
> 
> 时间：2012-12-09T17:59:37.433
> 
> 标签：java, jsf, download

我使用 JSF 2.0 和 tomcat 7.0。要下载我使用的文件`org.apache.commons.io.FileUtils.copyURLToFile(url, new File("file.xls"));`

如何指示默认目标，因为现在文件保存在工作区目录中？我想将我的文件下载到所有用户的默认下载目录。例如在 Windows 系统中，所有下载的文件都保存在“下载”中。谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T02:44:53.773

`File`只需在构造函数中指定所需的目标文件夹即可。

```
File downloads = new File("/path/to/download/folder");
// ...
FileUtils.copyURLToFile(url, new File(downloads, "file.xls")); 
```

请注意，这个问题与 JSF 或 Tomcat 完全无关。在普通的 Java 应用程序中这样做时，您会遇到完全相同的问题。

另请注意，我假设您非常清楚这行代码绝对不会将文件从网络服务器发送到任意网络浏览器。相反，它将文件保存在网络服务器自己的磁盘文件系统中。当网络浏览器碰巧在与网络浏览器相同的机器上运行时，您只会通过误解体验将文件保存在“客户端”中的“效果”（并且没有意识到这实际上不会发生在现实世界中）。

# python - 在 Python 中，如何从列表列表中删除某个元素？

> ID：13790082
> 
> 赞同：0
> 
> 时间：2012-12-09T17:59:38.653
> 
> 标签：python, list

假设我有一个列表列表：

```
x = [[1,0,0,3],[1,1,1,1],[5,2,0,0],[4,3,0,1],[0,0,0,0] 
```

如何创建一个仅包含每个列表的非零项的新列表，这样

```
y = [[1,3],[1,1,1,1],[5,2],[4,3,1],[]] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:01:34.160

```
In [23]: x = [[1,0,0,3],[1,1,1,1],[5,2,0,0],[4,3,0,1],[0,0,0,0]]

In [24]: y = [[el for el in l if el != 0] for l in x]

In [25]: y
Out[25]: [[1, 3], [1, 1, 1, 1], [5, 2], [4, 3, 1], []] 
```

或者，

```
In [28]: [filter(None, l) for l in x]
Out[28]: [[1, 3], [1, 1, 1, 1], [5, 2], [4, 3, 1], []] 
```

或使用`functools`：

```
In [32]: map(functools.partial(filter, None), x)
Out[32]: [[1, 3], [1, 1, 1, 1], [5, 2], [4, 3, 1], []] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:03:07.447

使用[`list comprehensions`](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)：

```
>>> [[i for i in j if i] for j in x]
[[1, 3], [1, 1, 1, 1], [5, 2], [4, 3, 1], []] 
```

另外，请注意，我依赖于这样一个事实，即整数仅在等于 时才`int`被提升为，并且它们不等于。值得考虑的是使用而不是明智的，因为前者更明确，因此更 Pythonic。`false``0``true``0``if i != 0``if i`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:00:56.763

您可以`filter`列出：

```
y = map(lambda l: filter(None, l), x) 
```

或者您可以使用`partial`：

```
from functools import partial

y = map(partial(filter, None), x) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T18:08:54.107

```
x = [[1,0,0,3],[1,1,1,1],[5,2,0,0],[4,3,0,1],[0,0,0,0]]

print x
print 'id(x) ==',id(x)
for sublist in x:
    print map(id,sublist)

for sublist in x:
    for i in xrange(len(sublist)-1,-1,-1):
        if sublist[i]==0:
            del sublist[i]

print
print x
print 'id(x) ==',id(x)
for sublist in x:
    print map(id,sublist) 
```

使用此代码，您可以真正从初始列表中消除零，而无需创建另一个列表，也就是说，此代码在`x`

**id(x)**和**map(id,sublist)**的打印是为了显示这种修改方式：
身份，即子列表元素的地址（对于剩余的元素）和列表`x`本身，治疗前后都一样

如果列表很大，就地修改它可能会很有趣。
如果不是这种情况，您可以使用所有创建新列表对象的其他解决方案。

索引以相反的方式运行，`xrange(len(sublist)-1,-1,-1)`因为如果从左到右探索列表，则会给出错误的结果

结果

```
[[1, 0, 0, 3], [1, 1, 1, 1], [5, 2, 0, 0], [4, 3, 0, 1], [0, 0, 0, 0]]
id(x) == 18725984
[10021864, 10021876, 10021876, 10021840]
[10021864, 10021864, 10021864, 10021864]
[10021816, 10021852, 10021876, 10021876]
[10021828, 10021840, 10021876, 10021864]
[10021876, 10021876, 10021876, 10021876]

[[1, 3], [1, 1, 1, 1], [5, 2], [4, 3, 1], []]
id(x) == 18725984
[10021864, 10021840]
[10021864, 10021864, 10021864, 10021864]
[10021816, 10021852]
[10021828, 10021840, 10021864]
[] 
```

# prolog - 寻找序言解释器

> ID：13790087
> 
> 赞同：1
> 
> 时间：2012-12-09T18:00:10.070
> 
> 标签：prolog, logic, logic-programming

我是 prolog 的新手，想尝试一些逻辑程序，我正在寻找一个不错的 prolog 解释器。有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:31:08.110

[BProlog](http://en.wikipedia.org/wiki/BProlog)
[Eclipse](http://en.wikipedia.org/wiki/ECLiPSe)
[SWI-Prolog](http://www.swi-prolog.org)
[SICStus](http://www.sics.se/isl/sicstuswww/site/index.html)
[Gnu-Prolog](http://www.gprolog.org)
[Visual Prolog](http://www.visual-prolog.com)

如果你想在没有安装的情况下玩耍

[爱迪生](http://ideone.com)

还有更多，但这些应该足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:09:11.203

Gprolog 和 sicstus prolog 是大的。另外，下次使用谷歌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:22:30.803

[YieldProlog](http://yieldprolog.sourceforge.net/)带来了一个有趣而独特的观点。

让我喜欢的是，使用它你可以在你的页面中嵌入逻辑程序（使用 JavaScript）......

OTOH，如果您需要调试逻辑，它并没有多大用处...

# objective-c - 随机文本生成器 - iOS

> ID：13790089
> 
> 赞同：0
> 
> 时间：2012-12-09T18:00:23.393
> 
> 标签：objective-c, ios, xcode, random, label

我想制作一个随机文本生成器，我知道如何做一个普通的，但在这种情况下我无法让它工作。因此，我拍摄或选择图片的代码，然后将其显示在不同的视图控制器上，我想在每次拍摄照片时将最后一个视图控制器上的标签设置为随机句子。我不知道我是否正确解释了自己。这是我拥有的代码：

```
//ViewController.m   

     -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
        if([segue.identifier  isEqualToString:@"CameraSegue"] || [segue.identifier isEqualToString:@"LibrarySegue"])
        {

            UIImagePickerController *controller = [segue destinationViewController];
            controller.sourceType = [segue.identifier isEqualToString:@"LibrarySegue"] ?  UIImagePickerControllerSourceTypePhotoLibrary : UIImagePickerControllerSourceTypeCamera;
            controller.delegate = self;

        }
        else if([segue.identifier isEqualToString:@"ShowImageViewController"]){

            UIImage *image = (UIImage*)sender;
            ShowImageViewController *viewController = segue.destinationViewController;
            viewController.pickedImage = image;

            UILabel *label = (UILabel *) sender;
            ShowImageViewController *vc = segue.destinationViewController;
            vc.cap = label;
           //I tried to set the label here
            label.text = @"Hello";

        }
    }

    -(void)imagePickerControllerDidCancel:(UIImagePickerController *)picker{
        [self dismissViewControllerAnimated:YES completion:nil];
    }

    -(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info{
        UIImage *image = [info objectForKey:UIImagePickerControllerOriginalImage];
        [self dismissViewControllerAnimated:YES completion:^{
            picker.delegate = nil;
            [self performSegueWithIdentifier:@"ShowImageViewController" sender:image];
        }];
    }

//SeconViewController.h
@property(nonatomic, strong) UIImage *pickedImage;
@property (weak, nonatomic) IBOutlet UIImageView *pickedImageView;
@property(nonatomic, retain) IBOutlet UILabel *cap;

//SecondViewController.m

-(void)viewWillAppear:(BOOL)animated{
    self.pickedImageView.image = self.pickedImage;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T21:25:02.697

你可以用这个。它是ac函数，但你可以在objective-c中使用它，或者转换它。

```
 void generateRandomString() {

      int numRandChars = 15;
      for ( int i = 0; i < numRandChars; i++ ) {

          int intChar = arc4random()%126;

          // Limit to above 33+
          while ( intChar < 33 ) { intChar = arc4random()%126; }

          // Use ascii table to convert
          char aChar = (char)toascii(intChar);

          // Print or do whatever you want with the string
          printf("\n%d = %c",intChar, aChar);
      }
 } 
```

此外，如果您仍然在设置标签时遇到问题，您需要弄清楚“发件人”实际上是什么，即确保它不是 nil 并且它*实际上*是您期望的 UILabel。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-08T08:39:58.053

在swift中，您可以使用它来获取辅音和元音，只需将其放在循环中并创建您的单词，希望对您有所帮助

```
func getConsonant() {
    var consonant:NSString = "QWRTYPSDFGHJKLZXCVBNM"
    var selected = Character(UnicodeScalar(consonant.characterAtIndex(Int(arc4random_uniform(20)))))
    println("This is a consonant \(selected)")
}

func getVowel() {
    var vowel:NSString = "AEIOU"
    var selected = Character(UnicodeScalar(vowel.characterAtIndex(Int(arc4random_uniform(4)))))
    println("This is a vowel \(selected)")
} 
```

# c++ - OOP，构造函数不工作

> ID：13790090
> 
> 赞同：0
> 
> 时间：2012-12-09T18:00:25.280
> 
> 标签：c++

我正在尝试调用构造函数，但它不起作用。代码是这样的：

# // 事件.h

```
class Event
{
  private:
    int Time;
    int Date;
  public:
    Event();
    Event(int t, int d)
} 
```

# // 事件.cpp

```
Event::Event(){}

Event::Event(int time, int date){
Time=time;
Date=date;
} 
```

* * *

//现在在另一个 .cpp 文件中，我试图调用构造函数，如下所示：

```
Event eve;
eve(inputTime,inputDate); // inputTime and inputDate are inputs 4m user.
//Error is:  no match for call to â(Event) (Time&, Date&)â 
```

有什么建议么..............

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:04:17.627

这个

```
eve(inputTime,inputDate); 
```

要求你的`Event`班级有一个`operator()(something, somethingElse)`，它没有。`something`并且`somethingElse`将分别对应于 和 的类型`inputTime`，`inputDate`这些类型未在您的问题中指定。

大概你想构造一个`Event`使用两个参数的构造函数，你可以这样做：

```
Event eve(inputTime,inputDate); 
```

由于错误还提到了类型`Time`和`Date`，您可能需要添加一个构造函数，该构造函数将 const 引用指向这些类型，除非它们可以隐式转换为`int`.

# java - java中这个随机int生成器有什么问题？

> ID：13790091
> 
> 赞同：-1
> 
> 时间：2012-12-09T18:00:27.343
> 
> 标签：java, methods

我试图开发一个程序，其中随机数生成器将生成一个数字，然后根据选择的数字，将打印预定义数组的成员之一。（我希望在数组内部调用该方法索引号）

```
import java.util.Random;
import java.util.Scanner;

public class Testing{
public static void main(String args[]){
public static int calculatew () {
    Random generator = new Random();  
    int number1 = generator.nextInt(3);
}
String array1 [] = new String[4];
array1[1]="Tom";
array1[2]="Jerry";
array1[3]="Mike";
array1[0]="Dustin";
System.out.println("the very first name is "+array1[calculatew]+" The second name is "+array1[calculatew]+" the third accodental name is "+array1[calculatew]+" and the final random name is "+array1[calculatew]+".");

}
} 
```

编译程序时，它会返回以下错误：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problems: 
Syntax error on token(s), misplaced construct(s)
Syntax error on token "int", @ expected
calculatew cannot be resolved to a variable
calculatew cannot be resolved to a variable
calculatew cannot be resolved to a variable
calculatew cannot be resolved to a variable

at Testing.main(Testing.java:7) 
```

有人可以告诉我这个程序的主要问题是什么。

非常感谢您提前回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:01:45.937

一个问题是：

```
public static void main(String args[]){
public static int calculatew () {
    Random generator = new Random();  
    int number1 = generator.nextInt(3);
} 
```

将方法移到 main 之外

```
public static void main(String args[]){
 int calcResults = calculatew ();
....
}
public static int calculatew () {
    Random generator = new Random();  
    int number1 = generator.nextInt(3);
    return number1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:32:54.123

除了已经发布的关于如何调用方法的答案之外，calculatew 每次调用时都会创建一个新的 Random 实例。Random 在一天中的某个时间进行初始化，因此您可能会得到几个相同的结果。

最好将生成器设为类中的静态字段，在加载类时初始化一次。那么这一系列的 nextInt 调用实际上会得到一系列由其算法生成的数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:22:36.103

编译器只是告诉您 calculatew 不是变量。如果您希望将其用作方法（就像您一样），您必须键入 calcualatew()。括号告诉编译器，输入的内容是必须调用的方法。如果删除括号，编译器会将其视为变量，并且无法在变量堆栈中找到它，也无法将其视为对象句柄，因此它会告诉您无法找到它

- 编辑

尝试使用像[Eclipse](http://www.eclipse.org/)这样的 IDE，它会在您请求编译之前告诉您语法上是否有问题，并直接指向该行并提供有关如何解决问题的建议如果您需要有关使用 Eclipse 的帮助，请在评论中告诉我

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T18:02:52.300

您不能在方法中定义方法。您应该在 main() 方法之外定义 calculatew() 方法。您的代码必须是：

```
import java.util.Random;
import java.util.Scanner;

public class Testing {
  public static void main(String args[]){
    String array1 [] = new String[4];
    array1[1]="Tom";
    array1[2]="Jerry";
    array1[3]="Mike";
    array1[0]="Dustin";
    System.out.println("the very first name is "+array1[calculatew()]+" The second name is "+array1[calculatew()]+" the third accodental name is "+array1[calculatew()]+" and the final random name is "+array1[calculatew()]+".");
  }

  public static int calculatew () {
    Random generator = new Random();  
    int number1 = generator.nextInt(3);
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T18:02:53.037

您将计算方法定义放在主方法定义中，您不能在 java 中执行此操作。把它们并排放置，你应该没问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-09T18:05:07.430

旅游问题正是编译器告诉你的。在括号内更改为“calculatew()”，并将方法定义移到主方法之外。

# sql-server - 如何检查 ASP.NET MVC4 应用程序性能？

> ID：13790092
> 
> 赞同：2
> 
> 时间：2012-12-09T18:00:29.917
> 
> 标签：sql-server, asp.net-mvc, performance, asp.net-mvc-4

我是 asp.net mvc4 的新手，需要一些建议。

在我的项目中，一些图像被存储并从 SQL 2008 服务器加载。一切都很好，它们从那里快速加载，直到用户授权。之后，图像的加载速度变慢了两倍。

为什么会出现这种情况？我只使用一个数据库（共享主机限制）并且一个用户连接到它。我有两个与 DB 的连接。首先用于实体框架，其他用于简单授权。也许这是一个问题？

```
 connectionStrings
add name="AuthorizationConnection" providerName="System.Data.SqlClient" connectionString="data source=**********;initial catalog=*****;persist security info=True;user id=SQLUser;password=*********;" /
add name="AMKEntities" connectionString="metadata=res://*/Models.AMKDBEntities.csdl|res://*/Models.AMKDBEntities.ssdl|res://*/Models.AMKDBEntities.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=**********;initial catalog=*****;persist security info=True;user id=SQLUser;password=**********;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" /
/connectionStrings 
```

同样从所有正在加载的图像中，仅从大约 30 个延迟加载中加载 4-6 个图像（所有图像都是具有相同尺寸的类别图像，大约 10Kb）。但是这 30 张中的 4-6 张图像似乎是随机选择的。每个页面刷新只有 20% 加载慢。其他立即加载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T23:05:52.007

试试 Miniprofiler，它很容易使用，这就是 Stackoverflow 用来分析他们网站的方法。

链接在这里：

[http://miniprofiler.com/](http://miniprofiler.com/)

# database - 将 microsoft sql server 2008 r2 连接到 netbeans IDE 7.0“错误 18456 严重性 14 状态 38 登录失败”

> ID：13790096
> 
> 赞同：0
> 
> 时间：2012-12-09T18:00:58.577
> 
> 标签：database, database-connection, netbeans-7, sql-server-2008-express, jtds

这两天我一直在做这个，我就是无法完成它！我正在尝试使用 Jtds 或 sqljdbc 将 Microsoft Sql Server 2008 r2 添加到 netbeans 7，但它们似乎都不起作用。他们都给我这个错误：“无法使用 net.sourceforge.jtds.jdbc.Driver 建立与 jdbc:jtds:sqlserver://localhost:1433/C:\Program Files\Microsoft SQL Server\MSSQL10.R0CRID3R 的连接（无法打开登录请求的数据库“C”。登录失败。）用户“sa”登录失败。”

我已经启用了 TCP/IP 并打开了端口 1433 并设置了端口并设置了混合 windows 身份验证和 sql server 身份验证的登录。对于 Jtds 和 sqljdbc，它给了我这个错误。来自 sql server management studio 的日志告诉这个：“来源：登录，消息：错误：18456，严重性：14，状态：38 来源：登录，消息：用户 'sa' 登录失败。原因：无法打开明确指定的databes.[CLIENT: 127.0.0.1]" 我现在变得非常绝望。任何帮助都将远远超过appriciated。我还尝试以管理员身份打开 netbeans，并尝试重新启动数据库引擎。如果有任何细节我没有写，请询问，我会告诉它。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T15:50:50.233

这是 Netbeans 安装中的一个错误。即使更新后也没有修复。我卸载并下载了最新的netbeans ide，它是7.2.1，当我尝试它时，它完全没有任何问题。

# java - 线程“主”java.lang.StringIndexOutOfBoundsException 中的异常：字符串索引超出范围：11

> ID：13790098
> 
> 赞同：5
> 
> 时间：2012-12-09T18:01:15.313
> 
> 标签：java, string

每次我编写任何与此类似的代码时，都会收到此类错误。它正在构建一个文件但不让它运行，它只是抛出异常。我不熟悉例外情况，因为我是初学者，请帮助我并特别指出我正在犯的错误。

```
public static void main(String args[]) {
    String name = "Umer Hassan";
    String name1 = "Hassan Umer";
    char[] name2 = new char[name.length()];

    for (int j = 0; j <= name.length(); j++) {
        for (int i = 0; i <= name.length(); i++) {
            if (name.length() == name1.length()) {
                if (name.charAt(i) == name1.charAt(i)) {
                    name2[i] = name1.charAt(i);
                }
            }
        }
    }
} 
```

当我运行程序时，它显示以下错误：

```
Exception in thread "main" java.lang.StringIndexOutOfBoundsException: String index out of range: 11
    at java.lang.String.charAt(String.java:658)
    at Anagram.main(Anagram.java:24) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:03:36.800

您的循环控制变量（`i`/ `j`）正在*上升* `name.length()`- 这是一个超出范围的索引（因为字符串/列表的最大索引是`len - 1`- 请记住第一个索引是 0）。

尝试使用`i < name.length()`and`j < name.length()`作为循环条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:03:45.567

您应该将 for 循环编写为

```
for (int i = 0; i < name.length(); i++) 
```

字符串中的索引是从零开始的，就像在数组中一样，所以它们的范围是从 0 到长度 - 1。你去到长度，这是超出范围的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:11:59.813

```
for (int i=0; i<=name.length();i++){ 
```

字符串索引从`0`.

例子 ：

```
String str = "abc";
int len = str.length(); //will return 3 
```

`str.charAt(3);`将抛出`StringIndexOutOfBoundsException` `charAt`的起始位置是`0`。所以极限是`length-1`。

您必须将 for 循环更改为`for (int i=0; i<name.length();i++){`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T18:05:28.537

尝试这个：

```
public static void main(String args[]) {
String name = "Umer Hassan";
String name1 = "Hassan Umer";
char[] name2 = new char[name.length()];

for (int j = 0; j < name.length(); j++ {
    for (int i = 0; i < name.length(); i++) {
        if (name.length() == name1.length()) {
            if (name.charAt(i) == name1.charAt(j)) {
                name2[i] = name1.charAt(j);
            }
        }
    }
} 
```

}

# php - PHP/SQL 搜索依赖于两个字段

> ID：13790099
> 
> 赞同：-1
> 
> 时间：2012-12-09T18:01:18.680
> 
> 标签：php, sql, search

我正在开发一个可以按全名搜索用户的地方。我遇到的问题是现在它是名字和姓氏的两个单独的字段。我正在尝试进行搜索，如果有人键入“Jon Smith”，它会查找名称为“Jon Smith”的人。我知道我可以分解给定的变量并使用分解的变量进行搜索，但这也有一些缺陷。但我想知道除了爆炸变量或设置另一个字段之外是否还有其他方法可以解决此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:12:20.360

您可以使用全文索引直接在数据库中使用全文搜索。这样，如果有人以其他顺序键入这些值，这将是无关紧要的。如果有人输入的用户名与您的查询不完全匹配（如果这是您想要的），这也可以给您一个分值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:38:11.027

我看不出不爆炸它的用处。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:03:27.563

你**应该**把它炸开。如果他以 John Smith 的身份在您的数据库中搜索 Smith John 会怎样？

# ios5 - 接受信用卡付款 ios

> ID：13790110
> 
> 赞同：1
> 
> 时间：2012-12-09T18:01:46.340
> 
> 标签：ios5, ios4, ios6, credit-card, stripe-payments

如何在我的 iPhone 应用程序中接受信用卡付款？

我想做以下事情

*   允许用户提供他们的信用卡信息
*   当他们这样做时，使用 https 将信用卡发送到我的服务器，并在我的服务器上使用条带处理信用卡。

从技术上讲，这是正确的方法吗？如何确保信用卡信息的安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T19:32:59.677

您可以使用[Stripe 的 iOS 绑定](https://github.com/stripe/stripe-ios)轻松接受客户的付款信息。

该库使用我们的创建令牌 API 调用将任何敏感数据安全地发送到我们的服务器。然后，我们会将其转换为令牌并将其传递回您的应用程序 - 您可以将其提交到您的服务器以正常[创建实际费用](https://stripe.com/docs/tutorials/charges)。

# c++ - 运算符“删除”不返回使用的内存

> ID：13790111
> 
> 赞同：0
> 
> 时间：2012-12-09T18:02:25.090
> 
> 标签：c++, unix, memory, memory-leaks

> **可能重复：**
> [C 中的问题使用内存](https://stackoverflow.com/questions/5994543/problem-usage-memory-in-c)

我有问题：运算符“删除”不返回分配的内存。

和平代码来说明我如何使用“删除”操作符。当然，在此代码调用程序其他部分使用运算符“new”创建的所有指针之前：

```
std::multimap<std::string, Container*>::iterator it;
for ( it = MAPX.begin() ; it != MAPX.end(); )
{
    Container* ptr_container = it->second;

    // delete every object at the container
    std::multimap<unsigned int, TMB*>::iterator it_tmb;
    for ( it_tmb = ptr_container->map_thumbs.begin() ; it_tmb != ptr_container->map_thumbs.end(); )
    {
        TMB* ptr_currentGlobalThumb = it_tmb->second;

        ptr_container->map_thumbs.erase( it_tmb++ ); // erase from map      
        delete ptr_currentGlobalThumb; // delete at the memmory
    }

    delete ptr_container; // lets delete empty container now
    MAPX.erase( it++ ); // and erase it from map
} 
```

在我开始这段代码之前，我查看了我在 FreeBSD 上`top`的`ps aux`输出，发现该程序使用了 241M 的内存：

```
ps: abrahab 21351  3.5  7.3 263108 246932  ??  S     3:19PM   1:50.94 program
top: 21351 abrahab 8  -8    0   257M   241M biord   2   0:47  8.30% program 
```

清洁过程后没有任何改变！由于程序使用 241M 的 RAM，所以程序继续使用内存（未释放）。为什么？

重新启动程序后，我看到系统返回了内存（当然）：

```
abrahab 71595  0.0  5.0 185284 170360  ??  I     4:50PM   0:18.62 program 
```

**编辑：** 1）那么我如何控制程序运行时的**实际内存使用情况**？2）似乎程序崩溃（没有 .core 文件结束）当它开始在 32 位 FreeBSD 上使用约 1Gb 的内存时 - FreeBSD“结束”程序是否有可能使用太多内存？

# jquery - 在rails中使用jquery重定向

> ID：13790114
> 
> 赞同：0
> 
> 时间：2012-12-09T18:02:43.467
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, unobtrusive-javascript

我敢肯定这很简单，我只是还没有掌握它......

我有一个大 div，我希望用户单击它，它会将他单击的模型发送给它（就像在 SO 中一样，但是单击问题 div 上的任何位置都会重定向到问题）

```
<% @questions.each do |question| %>
<div id="question-<%= question.id%>" >
.... question details here ... not important to the question
</div>
<% end %> 
```

现在，在我`on-click="window.location = '<%= question_path(question) %>'"`对每个问题使用 so 之前，我会在单击 div 时获得适当的 url。

我想用 jquery 改变它（在一个单独的文件中）

问题.js.erb：

```
$(function() {
    $([id^="question-"]).bind("click", function() {
      window.location = <%= question_path(question) %>
    });
}); 
```

这正是我的问题.. JS 文件不知道是什么，因为它是循环`question`中的一个变量。`each`

有没有办法将信息传递给 JS，以便我可以使用它来生成正确的路径？

**在 Rahul garg 的建议下，实施的解决方案**是制作一个 html5 数据属性

```
<div id="question-<%= question.id%>" data-questionurl= '<%= question_path(question) %>'> 
```

然后在js中做

```
window.location = this.getAttribute("data-questionurl"); 
```

我希望这个解决方案是好的编码实践

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:13:44.477

.erb 文件在呈现到页面时会被处理一次。

所有路径助手都可用，因此只有一次，除非您进行了单独的 ajax 调用，否则您不能从客户端调用 rails 助手（或任何其他 rails 代码）。

因此，在这种情况下，您的选择是：

*   将路径存储在div 本身的一些中并在 js 函数中获取它`attr`。`#question`
*   将路径存储在 js array/hash 中，维护它们并适当地使用它
*   修改您的路线以使用 questions_path`collection`而不是 on `member`like`/question?id=5`而不是，在这种情况下，您可以在自己的 js 函数`question/5/`中添加查询参数并返回给您`id``questions_path``/question`

# html - 编辑远程网页并保存更改

> ID：13790117
> 
> 赞同：0
> 
> 时间：2012-12-09T18:02:56.110
> 
> 标签：html, css, browser

您是否知道任何可以更改和修改任何页面的 css 和/或 html 并在本地保存更改的软件（浏览器扩展或插件）。稍后当我打开该页面时，我的修改也将被加载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:06:08.003

尝试[时尚](http://en.wikipedia.org/wiki/Stylish)的[chrome](https://chrome.google.com/webstore/detail/stylish/fjnbnpbmkenffdnngjfgmeleoegfcffe)和[FF](https://addons.mozilla.org/en-US/firefox/addon/stylish/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:07:11.577

我不确定这是否可能，因为 CSS 样式可以（并且通常）位于不同的文件中。这是假设您要编辑已经存在的样式表。从头开始为网页创建样式表是不同的。

# ios - postinst 要求在 cydia iOS 中重新启动

> ID：13790119
> 
> 赞同：2
> 
> 时间：2012-12-09T18:03:12.207
> 
> 标签：ios, cydia, deb

我正在为 iOS 创建一个 .deb 安装包，我需要设备在安装包后要求在 Cydia 中重新启动，如何将这样的功能添加到我的 postinst 脚本中？以下内容已经在脚本中（它将文件权限设置为 755，之后我需要重新启动）

```
#!/bin/sh
chmod 755 /usr/libexec/airtunesd
chmod 755 /System/Library/LaunchDaemons/com.apple.airtunesd.plist
exit 0 
```

谢谢！:)

# javascript - jquery ui droppable 的贪婪设置不起作用？

> ID：13790126
> 
> 赞同：1
> 
> 时间：2012-12-09T18:03:53.523
> 
> 标签：javascript, jquery, jquery-ui

通过将 droppable 小部件的 greedy 设置为 true，只有最顶层的元素应该响应 drop 事件。这里真的没有复杂性，但我就是无法让它工作。这就是我没有太多工作要做的全部：

CSS：

```
.page{
    position:    absolute;
    width:       150px; 
    height:      150px;
    left:        0px; 
    top:         0px;
    text-align:  center;
    background:  #F0FFFF;
    border:      1px solid #89B;
} 
```

HTML：

```
<div class = 'page' id = 'page1'> page1 </div>
<div class = 'page' id = 'page2'> page2 </div>
<div class = 'page' id = 'page3'> page3 </div> 
```

JS：

```
document.ready = function(){

    $('.page').draggable()

    $('.page').droppable({

        greedy: true,

        drop: function( event, ui ){

            console.log( 'assert drop once')
        }

    })

} 
```

现在发生的事情是所有放置在元素上的元素都在响应放置事件。由于要保留的代码很少，我不知道如何诊断。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:08:40.280

阅读该`greedy`属性的文档，我不确定我的理解是否与您相同：

> 默认情况下，当一个元素被放置在嵌套的 droppable 上时，每个 droppable 都将接收该元素。但是，通过将此选项设置为 true，任何父 droppables 都不会接收该元素。

对我来说，这意味着如果您有一个`droppable`包含另一个较小 div 的大 div，`droppable`那么如果您将一个元素放在小的 div 中，那么只有小的 div 会收到事件。

检查此演示以了解我在解释什么：http: [//jquery-ui.googlecode.com/svn/tags/1.6rc4/demos/droppable/greedy.html](http://jquery-ui.googlecode.com/svn/tags/1.6rc4/demos/droppable/greedy.html)

# android - 如何 ACCESS_FINE_LOCATION 保持 GPS 关闭？

> ID：13790127
> 
> 赞同：4
> 
> 时间：2012-12-09T18:03:57.017
> 
> 标签：android, gps, locationmanager

我想通过`NETWORK_PROVIDER`关闭 GPS 来获得准确的位置以节省电池。这似乎是不可能的，因为当`ACCESS_FINE_LOCATION`指定时，即使没有向 GPS_PROVIDER 请求位置，android 也会打开 GPS。

我已经添加了：

```
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/> 
```

进入清单。我需要它以避免android混淆准确的位置。

`NETWORK_PROVIDER`我只使用而不是注册更新`GPS_PROVIDER`：

```
myLocationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 
        60000, 0, locationListener); 
```

GPS无论如何都会打开。我怎样才能避免它（不强制用户禁用 GPS，这实际上有效但不受欢迎）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-29T16:31:31.770

听起来很奇怪，如果您没有从 gps 提供者请求位置更新，它不应该启动 GPS。

不过，让我给你一条建议 - 不要指望网络提供商给你“很好”的准确性，除非你坐在谷歌知道位置的 wifi 上。

基于蜂窝塔的定位通常具有大约 500 - 2000m 的精度，在市中心可能为 3-500m。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-11T15:32:56.117

如果您想使用 GPS，请使用[ACCESS_FINE_LOCATION](http://developer.android.com/reference/android/Manifest.permission.html#ACCESS_FINE_LOCATION)，如果您不想使用 GPS，请使用[ACCESS_COARSE_LOCATION 。](http://developer.android.com/reference/android/Manifest.permission.html#ACCESS_COARSE_LOCATION)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-12T16:28:27.683

如果您的定位技术被禁用以节省电力，您如何期望获得准确的位置？这就像期待一辆车带你去上班，但不想给它加油。坦斯塔菲尔

如上所述，如果您在谷歌知道的几个 APN 周围，WiFi 定位可以为您提供相当不错的定位精度。如果有足够的时间和足够多的人使用他们的手机，谷歌最终会学习每一个不动的 APN。

# ruby-on-rails - 无法使用 PostGIS/RGeo 保存多边形

> ID：13790131
> 
> 赞同：2
> 
> 时间：2012-12-09T18:04:25.583
> 
> 标签：ruby-on-rails, postgresql, postgis

如何使用适用于 Rails 的 PostGIS 适配器保存多边形？在我的模型中，我有：

```
self.rgeo_factory_generator = RGeo::Geos.factory_generator
set_rgeo_factory_for_column(:bounds, RGeo::Geographic.spherical_factory(:srid => 4326)) 
```

但是当我尝试将多边形保存到数据库时，它不会引发任何错误，但总是无法存储多边形：

```
1.9.3p194 :011 > n.bounds = "POLYGON(-149.737965876574 61.1952881991104, -149.71848377896 61.1953198415937, -149.718483761252 61.1952938698801, -149.718483872402 61.1951924591105)"
 => "POLYGON(-149.737965876574 61.1952881991104, -149.71848377896 61.1953198415937, -149.718483761252 61.1952938698801, -149.718483872402 61.1951924591105)" 
1.9.3p194 :012 > n.save
   (0.2ms)  BEGIN
   (0.3ms)  COMMIT
 => true 
1.9.3p194 :013 > n.bounds
 => nil 
```

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-10T19:49:09.313

它是无效的[WKT](http://en.wikipedia.org/wiki/Well-known_text)，无法解析，原因有两个：

1.  没有戒指。您需要在坐标数组周围添加另一组括号。
2.  环没有闭合。重复起点作为终点。

有效的 WKT 应该是这样的：

```
POLYGON((-149.737965876574 61.1952881991104, -149.71848377896 61.1953198415937, -149.718483761252 61.1952938698801, -149.718483872402 61.1951924591105, -149.737965876574 61.1952881991104)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:27:04.907

在纯 PostGIS 中，这个多边形会产生`geometry contains non-closed rings`错误。尝试“关闭”多边形（在末尾添加第一个点）

# youtube-api - Youtube iframe 与 chrome 一起失败，可与 IE 一起使用

> ID：13790133
> 
> 赞同：1
> 
> 时间：2012-12-09T18:04:53.197
> 
> 标签：youtube-api

我制作了一个简单的测试页面，该页面在 chrome 中失败，但在 IE 中有效。
它位于： [http ://www.rateforsuccess.com/test2.aspx](http://www.rateforsuccess.com/test2.aspx)

如果您使用 IE，您会看到视频播放大约一秒钟，然后您可以进行搜索，（使用 SEEK 按钮）它会在视频中搜索 100 秒，然后播放大约 7 秒。你会看到和听到一个女人说话。

但在 chrome 中，这会以多种方式失败。有时单击 SEEK 按钮第一次不起作用，但第二次起作用。有时剪辑会播放，但没有任何视觉效果 - 您只是听到音频。它是一个简单的页面，所以我不明白这一点。

还有一件奇怪的事情，有时如果你清除缓存然后访问页面，你会得到错误，但如果你不清除缓存，最终它会起作用（有时）。任何帮助表示赞赏。

# iphone - iPhone Storyboard，以编程方式调用segue，导航问题

> ID：13790140
> 
> 赞同：1
> 
> 时间：2012-12-09T18:05:39.223
> 
> 标签：iphone, ios, uinavigationcontroller, storyboard, segue

所以我有一个 iPhone 应用程序。它结构简单，全部基于`UINavigationController`.

我有一个故事板，它有一个视图，一个视图到另一个视图，等等。现在这个另一个视图有一个`UITextView`我不想在这个屏幕上编辑的 - 如果用户点击它，我希望它飞到第二个screen 基本上具有相同的文本视图，但这个是全屏的，用户将在返回上一个屏幕之前编辑该屏幕上的文本。

所以我捕捉到了这个`textViewShouldBeginEditing`方法。我之前在情节提要编辑器中，手动创建了一个从前一个视图控制器到这个新视图控制器的推送 segue，并命名它以便我可以通过它的身份调用它，我这样做：

```
- (BOOL)textViewShouldBeginEditing:(UITextView *)textView
{
    // This is called when the user clicks into the textView as if to edit it.

    // Instead of editing it, go to this other view here:
    [self performSegueWithIdentifier:@"editMemoSegue" sender:self];

    // Return NO, as I don't actually want to edit the text on this screen:
    return NO;
} 
```

似乎有道理。它有效。排序。事实上，它确实让我转向了另一种观点。另一个视图的事件启动，我将它的文本视图设置为第一响应者，我在该屏幕上编辑文本。每个人都很高兴。

直到我想使用后退按钮返回上一个视图。

然后我很快发现——我的导航堆栈是 foobared。大多数时候，出于某种原因，我在堆栈上有两个新的编辑控制器实例，所以当我第一次点击后退按钮时，我又得到了同样的东西。然后，奇怪的是，偶尔它会按预期工作，我会看到我以前的控制器只需单击一次。

我开始阅读日志，发现：

```
2012-12-09 09:41:03.463 APP[8368:c07] nested push animation can result in corrupted navigation bar
2012-12-09 09:41:03.818 APP[8368:c07] Finishing up a navigation transition in an unexpected state. Navigation Bar subview tree might get corrupted.
2012-12-09 09:41:03.819 APP[8368:c07] Unbalanced calls to begin/end appearance transitions for <SecondController: 0x83881d0>. 
```

很明显，我在这里做错了。问题是，什么？以及如何以正确安抚 iPhone 框架的 tiki 之神的方式做我想做的事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-12T16:55:28.877

检查 textViewShouldBeginEditing 是否被调用了两次。我注意到这些类型的委托调用有时是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:56:03.997

你的@"editMemoSegue" 是如何在情节提要上创建的？它是从 textView 创建的吗？如果是，那么您应该直接从视图控制器或从视图控制器的顶部状态栏重新创建它，这样当您触摸触发器对象和以编程方式调用它时，它不会被调用两次。

# jquery - 如何使用 Flexslider 更改每张幻灯片的幻灯片放映速度？

> ID：13790141
> 
> 赞同：0
> 
> 时间：2012-12-09T18:05:49.947
> 
> 标签：jquery, wordpress

我正在使用 Wordpress 使用 Flexslider 创建主页幻灯片。我已经创建了输入幻灯片速度的选项。如何循环播放每张幻灯片的幻灯片放映速度？

```
$options[] = array( "name" => __('Banner 1 Speed','themetrust'),
                    "desc" => __('Enter speed in seconds for banner 1.','themetrust'),
                    "id" => "ttrust_home_banner_speed1",
                    "type" => "text");  
$options[] = array( "name" => __('Banner 2 Speed','themetrust'),
                    "desc" => __('Enter speed in seconds for banner 2.','themetrust'),
                    "id" => "ttrust_home_banner_speed2",
                    "type" => "text");

<?php $slideshow_delay = of_get_option('ttrust_slideshow_delay'); ?>
<?php $autoPlay = ($slideshow_delay != "0") ? 1 : 0; ?>
<?php $slideshow_effect = of_get_option('ttrust_slideshow_effect'); ?>

<script type="text/javascript">
//<![CDATA[

jQuery(window).load(function() {            
    jQuery('.flexslider').flexslider({
        slideshowSpeed: <?php echo $slideshow_delay . '000'; ?>,  
        directionNav: true,
        slideshow: <?php echo $autoPlay; ?>,                                
        animation: '<?php echo $slideshow_effect; ?>',
        animationLoop: true
    });  
});

//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T20:11:26.780

我很确定这不是 FlexSlider 支持的功能，所以这里有一种解决方法：

```
<?php $speed1 = intval( of_get_option( 'ttrust_home_banner_speed1' ) );
$speed2 = ( of_get_option( 'ttrust_home_banner_speed2' ) );
$speed1 = $speed1 ? $speed1 * 1000 : 6000; // Default duration of 6 seconds
$speed2 = $speed2 ? $speed2 * 1000 : 6000; // Default duration of 6 seconds

$slideshow_effect = of_get_option('ttrust_slideshow_effect'); ?>

<script type="text/javascript">
//<![CDATA[

jQuery(window).load(function() {
    var delays = [ <?php echo $speed1; ?>, <?php echo $speed2; ?> ],
        _curr_index = 0,
        _delay = false, 
        _aa_timeout = null,
        _auto_advancing = false;

    jQuery('.flexslider').flexslider({
        slideshowSpeed: 0,
        directionNav: true,
        slideshow: false,
        animation: '<?php echo $slideshow_effect; ?>',
        animationLoop: true,
        after: function( slider ){
            // If we weren't advancing to the next slide from the auto_advance_slide() function(from user controls for instance), we need to fix some things
            if ( ! _auto_advancing ) {
                clearTimeout( _aa_timeout ); // Clear the auto advance timeout
                _curr_index = slider.currentSlide; // Fix the current index
            };
            // Set-up the next timer for auto advancing
            auto_advance_slide();
        }
    });

    function auto_advance_slide() {
        if ( typeof( delays[ _curr_index ] ) != 'undefined' ) {
            _delay = delays[ _curr_index ];
        } else {
            _delay = delays[ 0 ];
            _curr_index = 0;
        };

        // Set time out to switch to next slide
        _aa_timeout = setTimeout( function(){
            _auto_advancing = true;
            // Switch to next slide.
            jQuery('.flexslider').flexslider('next');

            _auto_advancing = false;
        }, _delay );

        // Increase the current index. 
        _curr_index ++;
    }

    auto_advance_slide();
});

//]]>
</script> 
```

基本上，您首先获取每张幻灯片的持续时间（您可以稍后添加更多变量和选项）并检查以确保它具有正确的值（用于`intval()`将值转换为整数，然后如果不是`false`，则将其`0`乘以 1000获得毫秒值）。

在您的 JavaScript 中，您创建了几个变量。

1.  `delays`- 这是一个包含所有幻灯片延迟的数组。
2.  `_curr_index`- 这包含当前的幻灯片（和`delays`）索引。
3.  `_delay`- 我们稍后使用这个变量，但我们在这里设置它
4.  `_aa_timeout`- 这个变量将保存对我们稍后将使用的超时的引用
5.  `_auto_advancing`- 这将是一个标志变量，标记我们是通过我们的函数前进，还是用户使用了 FlexSlider 导航。

当您设置 FlexSlider 时，您没有设置幻灯片，因为我们将从脚本中推进幻灯片。`after`您还为 Flexslider的“事件”添加了一个回调函数- 它在每张幻灯片的动画完成后执行。在那里我们设置了将滑块推进到下一张幻灯片的超时，并检查用户是否使用了滑块控件，或者我们是否已经从我们自己的脚本推进到下一张幻灯片。

然后我们定义`auto_advance_slide()`实际设置前进到下一张幻灯片的超时的函数。

* * *

**PP：**我还没有测试过这个功能，有些人请测试它并告诉我它是否不起作用（最好是你在 FireBug 或 Chrome 的开发者控制台中看到的）。

# sql - 基本 PostgreSQL 问题 - 我需要其他用户吗？

> ID：13790145
> 
> 赞同：0
> 
> 时间：2012-12-09T18:06:15.430
> 
> 标签：sql, postgresql

我默认使用 apt-get 安装了 postgreSQL，我相信它已经自动为我添加了一个名为“postgres”的用户。

1.  我只有一个要在 postgres 上排序的数据库，所以为这个数据库创建另一个用户帐户是否有任何意义，或者我应该只保留安装了 postgreSQL“postgres”的那个？

2.  为我创建的用户帐户 postgres，是否提供了某种默认密码？是否建议我输入自己的密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:13:41.723

编辑：我误解了这个问题，OP 询问的是内部用户，而不是系统用户

## 原答案：运行服务器的系统用户

作为标准的安全实践，在 linux 机器上运行的大多数服务都有自己的独立用户。在 postgreSQL 服务器被入侵的可能性很小的情况下——要么你犯了错误，要么 postgresql 中存在漏洞，或者其他什么——攻击者只能访问允许运行 postgresql 服务器的用户的资源。如果该用户是 root，您将丢失机器。如果该用户是您的用户，那么您的损失不会那么多。如果该用户是`postgres`，它对任何东西的访问权限都很小。你会丢失数据库，仅此而已。

所以：

1.  您只需要一个用于 postgreSQL 服务器的用户，而不管该服务器进程究竟托管的是什么。如果（听起来像是）自动为您创建了一个用户，那么您已经完成了这一步。如果您需要手动创建一个（听起来您不需要），您还必须更改权限，以便新用户只能访问它需要的内容。

2.  该帐户很可能无法直接登录；如果它有密码，那就是很多随机数据。为了使用该帐户，您需要以 root 身份开始，然后自愿将自己“降​​级”为`postgres`. 在服务器的情况下，root 以“postgres 的名义”启动服务器。我建议不要管它。

## 第二个答案：数据库用户

一旦你有一个服务器运行，服务器将保留它自己的一组用户，用于访问数据库。你可以使用的最简单的架构就是让一个拥有完全权限的基本用户做所有事情。虽然这可行，但不建议您在外部托管它。更可取的解决方案是拥有一组用户，类似于操作系统的设置方式：一群用户执行特定任务，一个管理员用户来管理所有任务。那说：

1.  您不必这样做，但是如果您要在任何地方托管它（如果您不只是将它用于个人事务，而且它是全球可访问的），我会建议具有有限权限的额外用户。

2.  [http://archives.postgresql.org/pgsql-admin/2001-10/msg00192.php](http://archives.postgresql.org/pgsql-admin/2001-10/msg00192.php)

    > 默认没有密码；使用 ALTER USER 创建一个。
    > 
    > 除非 pg_hba.conf 设置为使用密码，否则密码不会生效。如果是这样，并且您没有为 postgres 分配密码，您将无法以 postgres 身份连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:31:07.723

重新 1)

在安装过程中创建的默认数据库用户是“超级用户”，出于同样的原因，您不应该以“root”身份进行日常工作，您也不应该在 DBMS 中使用超级用户。所以答案很明确：是的，一定要创建第二个用户。您可以授予该角色对默认数据库（也称为 postgres）的所有权限，这样您就不需要第二个数据库。

有关如何创建用户以及如何授予权限的更多详细信息，请参阅手册：

*   [http://www.postgresql.org/docs/current/static/sql-createuser.html](http://www.postgresql.org/docs/current/static/sql-createuser.html)
*   [http://www.postgresql.org/docs/current/static/sql-grant.html](http://www.postgresql.org/docs/current/static/sql-grant.html)

重新 2)

我不太了解 Linux，但通常应该在安装过程中要求您输入密码。在安装的某个时刻，使用`initdb`需要密码才能运行的命令初始化新的数据目录。

如果您不知道密码，则登录 postgres linux 帐户，然后您可能`psql`无需指定密码即可运行。这使您能够重置数据库密码并创建新用户。

有关用户和身份验证的更多详细信息，请参见手册：

*   [http://www.postgresql.org/docs/current/static/client-authentication.html](http://www.postgresql.org/docs/current/static/client-authentication.html)
*   [http://www.postgresql.org/docs/current/static/user-manag.html](http://www.postgresql.org/docs/current/static/user-manag.html)

# assembly - x86，BYTE 和 BYTE PTR 的区别

> ID：13790146
> 
> 赞同：26
> 
> 时间：2012-12-09T18:06:21.980
> 
> 标签：assembly, x86, nasm, masm

这两条线有什么区别？这里 PTR 有什么变化？

```
;first
mov BYTE [ecx], 0  
;second
mov BYTE PTR [ecx], 0 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-09T19:38:47.273

概括：

*   NASM/YASM 要求`word [ecx]`当操作数大小不被其他操作数暗示时。（否则`[ecx]`没问题）。
*   MASM/TASM 要求`word ptr [ecx]`当操作数大小不被其他操作数暗示时。（否则`[ecx]`没问题）。

他们每个人都对对方的语法感到窒息。

* * *

警告：这是一个非常奇怪的领域，没有任何 ISO 标准或易于找到的 BNF 表；而且我不是走专有 MASM 语法雷区的专家。

您的情况可能没有区别，但 PTR 运算符在其他情况下可能意味着：

[http://www.c-jump.com/CIS77/ASM/Instructions/I77_0250_ptr_pointer.htm](http://www.c-jump.com/CIS77/ASM/Instructions/I77_0250_ptr_pointer.htm)

> 通常，PTR 运算符强制将表达式视为指定类型的指针：

```
 .DATA
 num  DWORD   0

 .CODE
 mov     ax, WORD PTR [num] ; Load a word-size value from a DWORD 
```

我认为，还有汇编程序的特定要求（nasm/tasm/其他 asm），并且使用“byte ptr”更便携。

[另请查看India 书中](http://books.google.com/books?id=XZzUyvghwnsC&pg=PA133&dq=PTR)的第 4.2.16节和“*汇编语言编程的艺术*”中的第[8.12.3](http://cs.smith.edu/~thiebaut/ArtOfAssembly/CH08/CH08-4.html#HEADING4-147)节（和 8.11.3 “类型冲突”）。

 *更新：感谢 Frank Kotler，NASM 似乎“使用了英特尔汇编语法的变体”（wiki），其中不包括 PTR 操作。

UPDATE1：有来自英特尔的原始[“ *ASM86 LANGUAGE REFERENCE MANUAL* ”](http://bitsavers.informatik.uni-stuttgart.de/pdf/intel/ISIS_II/121703-003_ASM86_Language_Reference_Manual_Mar85.pdf)，1981-1983，PTR 运算符在第 4-15 页定义：

> **PTR 操作员**
> 
> 语法：输入 PTR 名称
> 
> 说明：PTR 运算符用于定义具有某种类型的内存引用。汇编器根据指令操作数的类型确定要汇编的正确指令。在某些情况下，您可以指定没有类型的操作数。这些情况涉及使用数字或寄存器表达式。这里 PTR 运算符用于指定操作数的类型。以下示例说明了这种用法：

```
MOV  WORD  PTR  [BX], 5        ;set word pointed to by BX = 5
INC  DS:BYTE  PTR  10          ;increment byte at offset 10
                               ;from DS 
```

> 这种形式也可以用来覆盖变量或标签的类型属性。例如，如果您希望以两个字节访问已定义的字变量，则可以编写以下代码：

```
MOV  CL, BYTE  PTR AWORD       ;get first byte
MOV  CL, BYTE  PTR AWORD + 1   ;get second byte 
```

> 字段值：
> 
> type 此字段可以具有以下值之一：BYTE、WORD、DWORD、QWORD、TBYTE、NEAR、FAR
> 
> name 该字段可以是： 1\. 变量名。2\. 标签名称。3\. 地址或寄存器表达式。4\. 表示偏移量的整数。

UPDATE2：感谢斯图加特大学的比特保护者！Microsoft (1981)有[原始的 MACRO-86 手册](http://bitsavers.informatik.uni-stuttgart.de/pdf/microsoft/cpm/Microsoft_8086_Utility_Software_Package_1981.pdf)。第 3-7 页：

> 在使用前向引用时，可以使用 PTR 运算符另一种方式来为自己节省一个字节。如果您将 FOO 定义为前向常量，您可以输入以下语句：

```
MOV [BX],FOO 
```

> 您可能希望将 FOO 称为立即字节。在这种情况下，您可以输入任一语句（它们是等效的）：

```
MOV BYTE PTR [BX],FOO

MOV [BX],BYTE PTR FOO 
```

> 这些语句告诉 MACRO-86 FOO 是一个字节立即数。生成更小的指令。

第 3-16 页：

> 覆盖运算符
> 
> 这些运算符用于覆盖变量和标签的段、偏移量、类型或距离。
> 
> 指针 (PTR)

```
<attribute>  PTR  <expression> 
```

> PTR 运算符覆盖操作数的类型（BYTE、WORD、DWORD）或距离（NEAR、FAR）。
> 
> `<attribute>`是新属性；新类型或新距离。
> 
> `<expression>`是要覆盖其属性的操作数。
> 
> PTR 最重要和最常见的用途是确保 MACRO-86 理解表达式应该具有的属性。对于 type 属性尤其如此。每当您在程序中放置前向引用时，PTR 都会明确表达式的距离或类型。这样可以避免相位错误。
> 
> PTR 的第二个用途是按类型访问数据，而不是变量定义中的类型。这通常发生在结构中。如果结构定义为 WORD 但您想以字节的形式访问项目，则 PTR 是此操作符。但是，更简单的方法是输入第二条语句，该语句也以字节为单位定义结构。这消除了对结构的每个引用都使用 PTR 的需要。请参阅第 4.2.1 节，内存指令中的 LABEL 指令。
> 
> 例子：

```
 CALL WORD PTR [BX][SI]
 MOV BYTE PTR ARRAY, (something)

 ADD BYTE PTR FOO,9 
```

在阅读本文并从这些文档中查看一些语法定义后，我认为编写 PTR 是强制性的。`mov BYTE [ecx], 0`根据 MA​​CRO-86 手册，使用不正确。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-10T00:54:13.670

您使用的是许可汇编程序，看来我的 C 编译器对内联汇编的支持肯定不满意。正确的语法是 BYTE PTR 告诉汇编器 ECX 寄存器中的值应该被当作一个指针来对待。PTR。*但这是过度指定*的语法，它已经可以通过将 [brackets] 放在寄存器名称周围来表明您打算将其用作指针。使用 [ecx] 已经清楚地表明您的意思是将零存储到 ECX 寄存器提供的地址中。

所以它知道如何使用 ECX 寄存器，它唯一不知道的*另一*件事是需要将多少字节设置为零。选项是 1、2 或 4。你说得很清楚，1\. BYTE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-04T02:27:02.457

在 MASM 中，BYTE PTR [ecx] 访问地址为 ecx 的内存。BYTE [ecx] 是语法错误（“'第一个操作数'中的内联汇编器语法错误；找到'['”）。

在 NASM 或 YASM 中，BYTE [ecx] 访问地址为 ecx 的内存。BYTE PTR [ecx] 是一个语法错误（NASM 中的“错误：预期的逗号、冒号或行尾”，YASM 中的“未定义符号 `PTR'”）。

在 TASM 中，BYTE PTR [ecx] 和 BYTE [ecx] 是等价的——都访问地址为 ecx 的内存。

但是，在 Gnu 汇编器 gas 中，当使用 intel 语法 BYTE PTR [ecx] 访问 ecx 处的内存时，BYTE [ecx] 实际上访问的是地址 ecx+1 处的内存。也就是说，BYTE [ecx] 等同于 BYTE PTR [ecx+1]，它看起来既不健全，也不记录在案。

Gnu 汇编器版本 2.18、2.24 或 2.26.1：

```
cat > foo.S << EOF
.intel_syntax noprefix
 movb BYTE [ecx], 0 
 movb BYTE PTR [ecx], 0 
.att_syntax prefix
EOF

as foo.S
objdump -dM intel a.out

0:  67 c6 41 01 00          mov    BYTE PTR [ecx+0x1],0x0
5:  67 c6 01 00             mov    BYTE PTR [ecx],0x0 
```*

# sql - 如何从 Informix 中的 syscolumns 检索“Is Null Allowed”属性？

> ID：13790151
> 
> 赞同：3
> 
> 时间：2012-12-09T18:06:39.057
> 
> 标签：sql, properties, informix

我试图弄清楚如何以编程方式确定给定表的列在 Informix 数据库中是否可以为空。我已经弄清楚如何获取任何给定数据的列数据，但这些结果似乎对我的目的没有用；也就是说，似乎没有一个属性可以指示该列是否接受空值。

我是否需要加入另一个 sys__*表*或类似的东西？

我目前正在使用的查询：

```
SELECT *
FROM "informix".syscolumns
WHERE tabid = (SELECT tabid FROM "informix".systables WHERE tabname = 'myTable'); 
```

这将返回一个包含 colname、tabid、colno、coltype、collength、colmin、colmax、extended_id、seclabelid 和 colattr 的表。也许可为空的属性是 coltype 中的东西......？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:13:18.090

[从手册中](http://publib.boulder.ibm.com/infocenter/idshelp/v10/index.jsp?topic=/com.ibm.sqlr.doc/sqlrmst41.htm)引用：

*`coltype`上一页列出的代码可以通过显示该列以下特征的位图递增。*

```
设置位时的位值意义
0x0100 NULL 值是不允许的
```

然后在下一页：

*同样，如果列不允许 NULL 值，则 coltype 值增加 256。要确定此类列的数据类型，请从值中减去 256，然后根据可能的 coltype 值计算余数。例如，如果 coltype 值为 262，则减去 256 得到余数 6，表示该列具有 SERIAL 数据类型*

# android - 离线安卓安装

> ID：13790154
> 
> 赞同：0
> 
> 时间：2012-12-09T18:07:10.703
> 
> 标签：android, windows

我有这三个文件：

> *   android-2.3.3_r02-linux.zip (81.5 MB)
> *   安装程序_r16-windows.exe (28.1 MB)
> *   平台工具_r10-windows.zip (9.54 MB)

我将安装此 SDK 的系统有 Windows7 和较差的 Internet 连接。

这三个文件够开发安卓项目吗？如何使用这些文件离线安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:24:05.330

您可能想要从这里获得 ADT 包：http: [//developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)看起来您拥有的文件已经过时了。

# haskell - 用 char 或 int 分割字符串/列表

> ID：13790156
> 
> 赞同：3
> 
> 时间：2012-12-09T18:07:11.320
> 
> 标签：haskell

我正在尝试在 Haskell 中创建一个函数来拆分某个字符串`char`和某个数字的列表。

为此， splitAt 函数正是我需要的数字，但我不能用这个函数给出一个字符。

例如

```
splitAt 5 [1,2,3,4,5,6,7,8,9,10] 
```

给

```
([1,2,3,4,5],[6,7,8,9,10]) 
```

这正是我在元组左侧的 5 所需要的。但现在我想用一个`char`和一个字符串来做到这一点。但`splitAt`只需要 and`int`用于第二个参数。我想

```
splitAt 'c' "abcde" 
```

导致

```
("abc", "de") 
```

我在寻找方向的东西

```
splitAt (findIndex 'c' "abcde") "abcde" 
```

但是该函数`findIndex`返回某种类型的东西`Maybe Int`并且`splitAt`需要一个`Int`. 然后我尝试了以下

```
splitAt (head (findIndices (== 'c') "abcde")) "abcde" 
```

这是一个可能的解决方案，但它返回以下内容

```
("ab","cde") 
```

c 在元组的错误一侧。您可以添加`succ`到 c，但如果 char 是 Z，结果会是什么。

有没有简单的修改方法

```
splitAt (findIndex 'c' "abcde") "abcde" 
```

工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:19:02.727

您可以使用`findIndex`，只需打开包装`Maybe`并添加一个：

```
import Data.List

splitAfter :: (a-> Bool) -> [a] -> ([a],[a])
splitAfter this xs = case findIndex this xs of
    Nothing -> (xs,[])
    Just n -> splitAt (n+1) xs 
```

给予，例如

```
*Main> splitAfter (=='c') "abcde"
("abc","de") 
```

Maybe 是一种方便的数据类型，用于以易于恢复的方式编码失败。甚至还有一个`maybe :: b -> (a -> b) -> Maybe a -> b`使用默认值的函数和一个分别处理这两种情况的函数：

```
splitAfter' :: (a-> Bool) -> [a] -> ([a],[a])
splitAfter' this xs = maybe (xs,[]) 
                  (\n -> splitAt (n+1) xs) 
                  (findIndex this xs) 
```

这也有效。例如

```
*Main> splitAfter' (==5) [1..10]
([1,2,3,4,5],[6,7,8,9,10]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:23:34.123

您可以使用该 `fromMaybe`函数从 Maybe 中获取结果，例如：

```
splitlist = splitAt (fromMaybe 0 (findIndex 'c' "abcde") "abcde") 
```

**fromMaybe :: a -> Maybe a -> a**

> fromMaybe 函数采用默认值和 Maybe 值。如果 Maybe 是 Nothing，则返回默认值；否则，它返回 Maybe 中包含的值。（[来源](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-Maybe.html)）。

将默认值设置为 0，如果您的 findIndex 返回 splitAt`Nothing`的结果`("",list)`，对于相同的情况，但默认值设置为`length list`finally 结果，它将是`(list,"")`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:28:58.250

给定`c :: Char`and `s :: String`，你可以写一些为

```
splitAt ((1+) $ fromJust $ findIndex (==c) s) s 
```

但

1.  如果`c`不进入，你会得到一个例外`s`
2.  你遍历`s`两次

另一种`Maybe`选择是

```
maybe Nothing (\x -> splitAt (1+x) s) (findIndex (==c) s) 
```

您可以设置*“其他值”*（`Nothing`在我的示例中）。

您可以将自己的函数编写为

```
splitAt' :: Char -> String -> (String, String)
splitAt' _ [] = ("", "")
splitAt' c (x:xs) | c == x = ([c], xs)
                  | True   = (x:cs, ys) where (cs, ys) = splitAt' c xs 
```

然后，如果`(s, "")`不在`c`.`s`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T19:19:28.717

这是一种不同的方式，它不涉及弄乱列表索引。

`break`几乎是你想要的。让我们重用它。您希望匹配元素包含在第一个输出列表的末尾，而不是第二个输出列表的开头。

```
import Control.Arrow ((***))

breakAfter :: (a -> Bool) -> [a] -> ([a], [a])
breakAfter p xs = map fst *** map fst $ break snd (zip xs $ False : map p xs) 
```

这是如何工作的：

1.  将我们的输入列表转换为对列表 ( `zip`)。每对的第一个元素取自原始列表。该对的第二个元素是`Bool`说明列表的*前一个*元素是否是我们正在寻找的元素。这就是为什么我们说`False : map p xs`--- 如果我们只是说`map p xs`，我们会准确地重现`break`. 在开始时坚持额外`False`是重要的一点。
2.  重用`break`。我们的条件编码在每对的第二个元素中。
3.  扔掉所有那些`Bool`s。我们不再需要它们了。

# android - Android玩市场推荐了解

> ID：13790159
> 
> 赞同：1
> 
> 时间：2012-12-09T18:07:18.163
> 
> 标签：android, android-intent, google-play

我正在尝试向我的应用程序添加一个推荐跟踪系统，以便我能够知道我的附属合作伙伴中的谁派用户下载我的程序。我遇到了几个写过它的网站，但仍然无法理解一些问题。

我已将此添加到我的清单中

`<receiver android:name="com.cool.PlayStoreReferralReceiver" android:exported="true"> <intent-filter> <action android:name="com.android.vending.INSTALL_REFERRER" /> </intent-filter> </receiver>`

并创建了这个对象：

```
public class PlayStoreReferralReceiver extends BroadcastReceiver {

@Override
    public void onReceive(Context context, Intent intent) {
        Bundle extras = intent.getExtras();
        if (extras != null) {
            String referrerString = extras.getString("referrer");
            Log.d("DEBUG", "Set Value:"+referrerString);

        }
      }

} 
```

它似乎工作正常，但我有 2 个问题

*   我不明白为什么我需要建立一个看起来像这样的链接，例如： [https ://play.google.com/store/apps/details?id=com.joelapenna.foursquared&referrer=utm_source%3Dtooyoou%26utm_medium%3Dbanner%26utm_term %3Dfoursquare%26utm_content%3Dfoursquare-tooyoou%26utm_campaign%3Dfoursquare-android](https://play.google.com/store/apps/details?id=com.joelapenna.foursquared&referrer=utm_source%3Dtooyoou%26utm_medium%3Dbanner%26utm_term%3Dfoursquare%26utm_content%3Dfoursquare-tooyoou%26utm_campaign%3Dfoursquare-android)

不要像我那样做： [https ://play.google.com/store/apps/details?id=com.joelapenna.foursquared&referrer=affiliate1](https://play.google.com/store/apps/details?id=com.joelapenna.foursquared&referrer=affiliate1)

*   我一直在用“Referral Tester”程序检查它，它似乎工作是否足够安全以进行中继？

非常感谢，或者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T17:22:26.117

对于那些需要知道的人：

*   `Referral Tester`工作得很好。

*   你可以得到这样的推荐： https: [//play.google.com/store/apps/details?](https://play.google.com/store/apps/details?id=com.joelapenna.foursquared&referrer=affiliate1) id= com.joelapenna.foursquared&referrer=affiliate1 或`referrer`参数后的任何内容

# jquery - 我的 jQuery 不工作

> ID：13790162
> 
> 赞同：-1
> 
> 时间：2012-12-09T18:07:41.587
> 
> 标签：jquery

我是第一次尝试 jQuery。此代码取自 W3schools。在这里，如果您单击按钮，您应该会看到 3 个框。我没有更改代码中的任何内容，除了我更改了 src 的头部。我正在使用火狐。

```
 <html>
        <head>
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
    $(document).ready(function(){
    $("button").click(function(){
    $("#div1").fadeIn();
    $("#div2").fadeIn("slow");
    $("#div3").fadeIn(3000);
  });
});
</script>
</head>

<body>
<p>Demonstrate fadeIn() with different parameters.</p>
<button>Click to fade in boxes</button>
<br><br>
<div id="div1" style="width:80px;height:80px;display:none;background-color:red;"></div><br>
<div id="div2" style="width:80px;height:80px;display:none;background-color:green;"></div><br>
<div id="div3" style="width:80px;height:80px;display:none;background-color:blue;"></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:16:19.310

更改您的 src = "http:// .... 因为它没有获取 Jquery 文件。

```
<html>
<head>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $("button").click(function () {
                $("#div1").fadeIn();
                $("#div2").fadeIn("slow");
                $("#div3").fadeIn(3000);
            });
        });
    </script>
</head>
<body>
    <p>
        Demonstrate fadeIn() with different parameters.</p>
    <button>
        Click to fade in boxes</button>
    <br>
    <br>
    <div id="div1" style="width: 80px; height: 80px; display: none; background-color: red;">
    </div>
    <br>
    <div id="div2" style="width: 80px; height: 80px; display: none; background-color: green;">
    </div>
    <br>
    <div id="div3" style="width: 80px; height: 80px; display: none; background-color: blue;">
    </div>
</body>
</html> 
```

# html - 当文本超过宽度时，继续换行

> ID：13790170
> 
> 赞同：20
> 
> 时间：2012-12-09T18:08:27.937
> 
> 标签：html, overflow

我有以下结构：

```
<ul>
<li>
<p style="width:10px;">
Text goes here
</p>
</li>
<li>
<p style="width:10px;">
Text goes here
</p>
</li>
</ul> 
```

当 p 的文本超过 10px 限制时，我希望它在新行中继续。我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-09T18:21:06.540

您的示例已经自动换行（因为`<p>`已经是块元素），如果您想分词，那么您可以尝试：

```
p.letters {
    word-wrap: break-word;
} 
```

这是一个基本的工作示例： http: [//jsfiddle.net/G9z5M/](http://jsfiddle.net/G9z5M/)（请参阅下面的更新）。

您可以使用各种技术来玩弄它：

```
/* Wraps normally, on whitespace */
p.words {
    word-wrap: normal;
}    

/* Hides non-wrapped letters */
p.hidden {
    overflow: hidden;
}

/* Outputs a single line, doesn't wrap at all */
p.nowrap {
    white-space: nowrap;
}​ 
```

查看更新的小提琴：http: [//jsfiddle.net/G9z5M/1/](http://jsfiddle.net/G9z5M/1/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-10-11T08:02:14.980

对我来说它有效

```
white-space: initial; 
```

可能对其他人有帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-09T18:19:32.183

Normaly`p`元素是块状的，因此`width`受到尊重，它应该以 10 像素换行。

见[http://jsfiddle.net/ejLmu/](http://jsfiddle.net/ejLmu/)

如果它对您不起作用，则意味着您有一些覆盖默认设置的 css 规则。您要么已设置`display:inline`（*在这种情况下不尊重宽度*），要么已设置`white-space:nowrap;`（*禁用文本换行*）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T18:25:20.267

我不知道我确实理解您的问题，但是使用 CSS 您应该尝试：

```
word-break: break-all; // normal; // keep-all; 
```

如果你想隐藏额外的内容：

```
overflow: hidden; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-09T18:19:16.457

你应该使用

```
style="width:10px; display: block;" 
```

# javascript - YUI 数据表拖放与单元格编辑器一起使用

> ID：13790176
> 
> 赞同：0
> 
> 时间：2012-12-09T18:09:00.860
> 
> 标签：javascript, drag-and-drop, datatable, yui

我对 YUI (2) 数据表和拖放组合有疑问。我有一个项目表，其中一个是项目描述，我使用 YUI 的 TextboxCellEditor 使其可编辑（和可保存）。我还使行可拖动（因此我可以将它们拖放到另一个容器中）。

但是我遇到了两个问题： - 我只能通过单击第二列来获得 DnD（第一列不起作用） - 我只能在初始化后的第二次尝试中让它工作。

这是我的 JS 中的一个片段（简化）：

```
nameFormatter = function (elCell, oRecord, oColumn, oData) {
    var link = '/share/page/site/' + Alfresco.constants.SITE + '/document-details?nodeRef=' + oRecord.getData('nodeRef');
    elCell.innerHTML = '<span><a href="' + link + '" class="drags">' + oData + '</a></span>';
};
descFormatter = function(elCell, oRecord, oColumn, oData) {
    elCell.innerHTML = '<pre class="desc">' + oData + '</pre>';
};
columnDefs = [
    {key: "name", label: "Name", sortable: true, formatter: nameFormatter, resizable: true}
    , {key: "description", label: "Description", sortable: true, formatter: descFormatter, editor: new YAHOO.widget.TextboxCellEditor(), resizable: true}
];
this.mediaTable = new YAHOO.widget.DataTable(this.id + "-media-table", columnDefs, this.dataSource, {
    MSG_EMPTY: "No files"
});
// now we want to make cells editable (description)
var highlightEditableCell = function(oArgs) {
    var elCell = oArgs.target;
    if(YAHOO.util.Dom.hasClass(elCell, "yui-dt-editable")) {
        this.highlightCell(elCell);
    }
};
this.mediaTable.subscribe("cellMouseoverEvent", highlightEditableCell);
this.mediaTable.subscribe("cellMouseoutEvent", this.mediaTable.onEventUnhighlightCell);
this.mediaTable.subscribe("cellClickEvent", this.mediaTable.onEventShowCellEditor);
this.mediaTable.subscribe("editorSaveEvent", this.saveDesc);
this.mediaTable.subscribe('cellMousedownEvent', this.onRowSelect); 
```

saveDesc 函数是简单的 Ajax 调用，用于保存项目的描述。这是 onRowSelect 函数：

```
onRowSelect = function(ev) {
    console.log(" == method onRowSelect");
    var tar = Event.getTarget(ev)
      , dd
    ;
    dd = new YAHOO.util.DDProxy(this.getTrEl(tar));
    dd.on('dragDropEvent', function(e) {
        YAHOO.Bubbling.fire('myCustomEvent', { target: e.info, src: tar});
        dd.unreg();
    });
}; 
```

如果我只是点击 desc，我会得到文本编辑器，如果我点击 name，我会打开链接。就像我说的，当我在第二列（描述）上鼠标按下时，第一次尝试我什么也没得到。然后我第二次单击并按住，这一次它起作用了（我得到了一个 DDProxy，我可以将它拖放到目标上，一切都在那里）。

另一个问题是，当我单击并按住名称列时，我没有得到 DDProxy（我得到了我的 onRowSelect 事件和正确的行）。

我在这里做错了什么？

**更新**：通过使用 Satyams 答案解决了第一个问题 - 使用链接删除我的单元格的格式化程序。第二个问题（仅在第二次单击时）已解决，因为我在*onRowSelect*函数中添加了缺少的*dd.handleMouseDown(ev.event) 。*

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T16:05:05.173

写 DD 的 Dav Glass 在他的页面中有这个例子：http: [//new.davglass.com/files/yui/datatable4/](http://new.davglass.com/files/yui/datatable4/) 我在我的例子中使用了它：http: [//www.satyam.com.ar/yui /2.6.0/invoice.html](http://www.satyam.com.ar/yui/2.6.0/invoice.html)，它工作得很好，虽然它比你有更多的参与。很抱歉，我无法更准确地帮助您解决问题，D&D 不是我的要点，但我希望这些示例可能会有所帮助。

您的问题的一个原因可能是单元格中的链接。这不是一个好主意，不管你有没有 DD。通常，处理此问题的推荐方法是侦听 cellClickEvent，如果单击的单元格的列是“导航”的列，则根据单击的记录中的信息构建 URL，然后导航或用它做任何你想做的事。这允许 DataTable 更快地呈现，因为它不需要格式化程序，并且在奇怪的情况下有人确实单击了单元格，然后您才费心进行计算。页面上 DOM 元素的大小和数量也会减少。

同样，对于带有预格式化标签的其他单元格，您可以轻松避免它。DataTable 中每列中的单元格获取由“yui-dt-col-”前缀和列的“key”值组成的 CSS 类名称（例如：yui-dt-col-description）。因此，您可以简单地为该 CSS 类名称添加样式声明，而不必使用格式化程序。同样，为了突出显示可编辑单元格，如何为 .yui-dt-editable:hover 选择器定义一些样式？我自己从来没有做过，但我想它应该可以工作。*

# ruby - 将多个值传递给 PTY 终端

> ID：13790183
> 
> 赞同：1
> 
> 时间：2012-12-09T18:09:50.673
> 
> 标签：ruby, command-line-interface, pty

我正在尝试使用 ruby​​ 与 CLI 交互，该 CLI 使用 PTY 获取多个值。但是，我只能获取 PTY 生成的伪终端来查看我传递的第一个值。下面的测试脚本：

**测试.rb**

```
require 'pty'
require 'expect'

def till_prompt(cout, prompt)
  buffer = ""
  regexPrompt = Regexp.new(Regexp.escape(prompt))
  loop { buffer << cout.getc.chr; break if buffer =~ regexPrompt }
  puts "buffer: \n" + buffer + "\nend of buffer\n"
  return buffer
end

$expect_verbose = true
PTY.spawn("ruby inputTest.rb") do |output, input, pid|

  till_prompt(output, "1: ")
  input.printf("hello\n\rworld\n\r")

  till_prompt(output, "2: ")
  input.printf("world\n\r")
end 
```

**输入测试.rb**

```
require 'highline/import'

word1 = ask("1: ")
word2 =  ask("2: ")
word3 =  ask("3: ")

system "echo '#{word1}\n#{word2}' > test.log"
puts "#{word1}\n#{word2}" 
```

**$ > 猫测试.log**

```
hello 
```

我不明白为什么它只收到第一个响应。

PS 我知道 expect 可以在这里使用，但我用自定义函数替换了它，以便更好地控制正在发生的事情以进行调试。

# php - 当字段为空时，它会输出一个空行

> ID：13790184
> 
> 赞同：0
> 
> 时间：2012-12-09T18:09:59.143
> 
> 标签：php, custom-fields

我将[Kirby](http://getkirby.com)用于我的 CMS。我设置了一个自定义字段，当里面什么都没有时，它仍然输出一个空行。

显示没有字段值的后端屏幕截图： http: [//cloud.chrisburton.me/LSyR](http://cloud.chrisburton.me/LSyR)
查看源显示空白行（52）：[http ://cloud.chrisburton.me/LSW0](http://cloud.chrisburton.me/LSW0)

**我的代码：**

```
 <ul class="credits">
    <?php 
    if($page->client() != '')
    echo '<li><span>Client: </span>'.$page->client().'</li>';
    ?>

    <?php 
    if($page->art_direction() != '')
    echo '<li><span>Client: </span>'.$page->art_direcion().'</li>';
    ?>

    <?php 
    if($page->typeface() != '')
    echo '<li><span>Typeface: </span>'.$page->typeface().'</li>';
    ?>
  </ul> 
```

我怎样才能删除它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:12:39.180

所见即所得。

![在此处输入图像描述](../Images/6707a8ca0eee483e0a329109d29c2f74.png)

我建议不同的方法...

```
<ul class="credits">
<?php
foreach(array('Client' => $page->client(), 'Direction' => $page->art_direction(), 'Typeface' => $page->typeface()) as $key => $value)
if($value != '') echo "\t<li><span>{$key}: </span>{$value}</li>\n";
?>
</ul> 
```

另外，请确保您不缩进`<?php`并且它从位置 0 开始。

[http://ideone.com/MBWLU0](http://ideone.com/MBWLU0)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:18:04.690

```
<ul class="credits">
    <?php 
    if($page->client() != '')
    echo '<li><span>Client: </span>'.$page->client().'</li>';

    if($page->art_direction() != '')
    echo '<li><span>Client: </span>'.$page->art_direcion().'</li>';

    if($page->typeface() != '')
    echo '<li><span>Typeface: </span>'.$page->typeface().'</li>';

    ?>
  </ul> 
```

# javascript - 在 Socket.io on function 中使用 this 关键字

> ID：13790186
> 
> 赞同：0
> 
> 时间：2012-12-09T18:10:08.817
> 
> 标签：javascript, oop, node.js, socket.io, this

我在我的一个函数中使用 socket.io 侦听器来侦听“失败者”事件，以告诉客户端另一个客户端赢了。但是，我不能在 socket.on 函数中使用“this”关键字来谈论我的客户端，因为 this 指的是套接字本身。我会以错误的方式解决这个问题吗？或者可以通过其他方式访问客户端对象，比如超级？

```
 socket.on('loser', function() {
                //Remove all current objects then restart the game.
                //THIS PART DOESN'T WORK, SINCE 'THIS' NO LONGER REFERS TO 
                //THE GAME OBJECT, BUT INSTEAD REFERENCES THE SOCKET LISTENER.
                for(var i = 0; i < this.board.objects.length; i++)
                {
                    this.board.remove(this.board.objects[i]);
                }
                //WORKS AS EXPECTED FROM HERE ON...
                Game.setBoard(1, new TitleScreen(gameType,
                        "Loser!",
                         "Press Space to Play Again", 
                     playGame));                    
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:12:16.623

函数不携带有关引用它们的对象的任何信息，您可以`.bind()`在传递函数之前将其绑定到对象：

```
socket.on('loser', function() {
    //Remove all current objects then restart the game.
    //THIS PART DOESN'T WORK, SINCE 'THIS' NO LONGER REFERS TO 
    //THE GAME OBJECT, BUT INSTEAD REFERENCES THE SOCKET LISTENER.
    for (var i = 0; i < this.board.objects.length; i++) {
        this.board.remove(this.board.objects[i]);
    }
    //WORKS AS EXPECTED FROM HERE ON...
    Game.setBoard(1, new TitleScreen(gameType, "Loser!", "Press Space to Play Again",
    playGame));
}.bind(this)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:12:49.510

在浏览器领域，执行此操作的常用方法是`var that = this;`在输入函数之前设置一个变量，然后使用`that`。

但是，ECMAScript5 引入了`bind()`，它可以让你防止价值`this`丢失。当然，在 NodeJS 中使用它是安全的（不像在浏览器领域，您必须支持旧版浏览器）。

```
socket.on('loser', (function() {
    //Remove all current objects then restart the game.
    for (var i = 0; i < this.board.objects.length; i++) {
        this.board.remove(this.board.objects[i]);
    }
    //WORKS AS EXPECTED FROM HERE ON...
    Game.setBoard(1, new TitleScreen(gameType, "Loser!", "Press Space to Play Again", playGame));
}).bind(this));​ 
```

有关详细信息，请参阅[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T22:18:09.013

这样的事情有什么问题？

```
var self = this;
socket.on('loser', (function() {
    //Remove all current objects then restart the game.
    for (var i = 0; i < self.board.objects.length; i++) {
        self.board.remove(self.board.objects[i]);
    }
} 
```

# c# - 根据正则表达式拆分字符串

> ID：13790187
> 
> 赞同：1
> 
> 时间：2012-12-09T18:10:21.607
> 
> 标签：c#, regex, c#-4.0

需要拆分由不同材料组合而成的字符串。需要使用 reg 表达式提取所有材料。

可能的输入是

```
 65%POLYESTER 30%COTTON 5%WOOL
 95% COTTON DENIM 5% OTHERS
 100% HS POLYPROPYLENE
 100% POLYPROPYLENE HEATSET 
```

输出应该是

```
65% Polyester
30% Cotton
5% wool 
```

试过这个

```
static IList<string> SplitContent(string input)
        {
            var list = new List<string>();
            var regex = new Regex("\\d*\\.\\d+%?[A-Za-z \\s]");
            var matches = regex.Matches(input);
            foreach (Match item in matches)
            {
                list.Add(item.Value);
            }
            return list;
        } 
```

但它没有返回任何匹配项。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:35:08.630

更好的方法是

```
List<string> output=Regex.Matches(yourInput,@"\d+(\.\d+)?%?[a-zA-Z\s]+")
                         .Cast<Match>()
                         .Select(x=>Regex.Replace(x.Value,@"(%)(?=\S)","$1 "))
                         .ToList(); 
```

* * *

`\d+`匹配 1 到多个数字

`(\.\d+)?`匹配一个点和 1 到多个数字 0 到 1 次 ( `?`)

`[a-zA-Z\s]+`匹配该类中的任何字符 1 到多次..

当有一个不存在的字符`[a-zA-Z\s]`或当您到达字符串末尾时，匹配会中断

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T18:17:23.660

使小数分隔符`.`可选，并将描述部分更改为“除空格之外的任何内容”，如下所示：

```
var regex = new Regex("\\d*(?:\\.)?\\d+%?[^\\s]+"); 
```

您的程序的其余部分工作正常，不需要任何修改（[指向 ideone 的链接](http://ideone.com/WVtCud)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:37:37.217

```
 string ip = "65%POLYESTER 30%COTTON 5%WOOL 95%COTTON DENIM 5%OTHERS 100%HS POLYPROPYLENE 100%POLYPROPYLENE HEATSET";
        List<string> lst = new List<string>();
        lst = SplitContent(ip);
        foreach (var item in lst)
        {
            string[] arr=item.Split('%');

            Console.WriteLine(arr[0]+"% "+arr[1]);
        } 
```

在您的 SplitContent 函数中，您的正则表达式不正确。它应该如下所示：

```
 public static List<string> SplitContent(string input)
    {
        var list = new List<string>();
        var regex = new Regex("\\d*\\%[A-Za-z]*");
        var matches = regex.Matches(input);
        foreach (Match item in matches)
        {
            list.Add(item.Value);
        }
        return list;
    } 
```

希望这可以帮助...！！

# yii - 使用 yii 框架将数据从一个表复制到另一个 aftersave

> ID：13790189
> 
> 赞同：0
> 
> 时间：2012-12-09T18:10:34.903
> 
> 标签：yii

我有这个代码片段。我想将数据从一个表复制到另一个..请看我的代码，这不起作用。

谢谢

```
protected function afterSave()
 //Copy data from Client to packageassignment ***
  // assuming     your you're in the Client model 
    //and Client has id,package_id,p_start_date
 {
    $packageassignment= new Packageassignment();
    $packageassignment->user_id=$this->id;
    $packageassignment->package_id=$this->package_id;
    $packageassignment->package_start_date=$this->p_start_date;
    $packageassignment->save();
    return parent::afterSave();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T23:51:32.887

你的代码看起来不错。问题可能出在一线

```
$packageassignment->save(); 
```

将其更改为

```
if(!$packageassignment->save()){
  echo 'packageassignment save failed!';
  //other debugging code
} 
```

然后看看它是否给出错误。或者替换为您喜欢的错误记录技术。

# ruby-on-rails - heroku 短信插件？——月影堂不见了

> ID：13790192
> 
> 赞同：4
> 
> 时间：2012-12-09T18:10:58.160
> 
> 标签：ruby-on-rails, heroku, sms, twilio

大约6 个月前，[Moonshado](http://moonshado.com/)是[Heroku](http://www.heroku.com/)的特色插件，可以轻松地将短信添加到一个应用程序中。我的一个使用 moonshado 的 heroku 托管应用程序仍在运行（并向我收费），并且[moonshado 指令](https://devcenter.heroku.com/articles/moonshadosms)仍然出现在[Heroku 的开发中心](https://devcenter.heroku.com/)。也就是说，[Heroku 的附加页面](https://addons.heroku.com/)中现在没有 Moonshado 。事实上，Heroku 当前的附加组件中似乎没有提供短信服务。

任何人都知道 Heroku 和 Moonshado 发生了什么，以及当前将短信添加到新 Heroku 应用程序的最佳方式是什么？

编辑：2014-06-25 - 正如我在下面的答案中详述的那样，我已经使用[Twilio](https://www.twilio.com/)在我的 rails 应用程序上工作了短信。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-21T21:11:07.313

Looks like [Heroku](https://www.heroku.com/) has a new add-on, [Blower.io](https://addons.heroku.com/blowerio), which offers SMS. It's in beta and there's currently only a free version -- 30 outbound messages/mn -- but looks worth checking out. I haven't had a chance to play with it yet myself but hope to soon. Thanks, Heroku! – BenU

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:45:10.337

我注意到我的应用程序最近完全停止工作，Heroku 支持人员刚刚告诉我，moonshado 在 2013 年 2 月的几个小时后停止工作。没有给出任何解释。

具体来说，Heroku 支持写道：

> 嘿，本，
> 
> Moonshado 在二月份的几个小时内停止了工作。您会在 2 月的发票上发现，我们从当月 1 日起将您切换到免费计划，这样您就不会再产生任何费用，并且在 3 月我们完全取消了附加组件的配置。
> 
> 最好的，
> 
> G

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T16:28:01.277

不知道为什么它从插件页面中丢失，但您仍然可以使用 CLI 添加 Moonshado：

```
heroku addons:add moonshadosms:free 
```

文档（有不正确的 CLI 指令）： [https ://devcenter.heroku.com/articles/moonshadosms](https://devcenter.heroku.com/articles/moonshadosms)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-25T21:22:01.347

I've been able to get sms working on my heroku rails app using [twilio](http://www.twilio.com/). I found [this](http://www.mutuallyhuman.com/blog/2012/01/20/twilio-on-rails/) and [this](http://www.mutuallyhuman.com/blog/2012/04/03/testing-sms-interactions-in-ruby-on-rails/) blog post by [Mutually Human](http://www.mutuallyhuman.com/) useful in getting me started. Twilio's docs have some [great sample ruby code](https://www.twilio.com/docs/quickstart/ruby/sms) as well.

# ruby-on-rails - 参考模板

> ID：13790195
> 
> 赞同：1
> 
> 时间：2012-12-09T18:11:18.477
> 
> 标签：ruby-on-rails, model-view-controller, reference, model, controller

我有一个模型艺术家，现在我想创建一个模型 user_artist，它应该保存当前登录的用户和对艺术家的引用。我采用一个新模型，因为该数据库中可能有多个用户用于一位艺术家。现在我有了模型，在用户创建新艺术家期间如何保存当前用户。

这是我目前的表格：

```
<%= form_for @artist do |f| %>
  <%= f.label :name, "Name" %>
  <%= f.submit "Create" %>
<% end -%> 
```

我必须如何更改它以同时将用户保存在数据库 user_artist 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:33:06.870

如果你想保存当前登录的用户，你可以编辑你的控制器，所以，在保存艺术家之后，你可以保存 UserArtist，例如这样

```
def create
   @artist = Artist.new(params[:artist])
   if @artist.save
       @user_artist = UserArtist.new(:artist_id => @artist.id, :user_id => current_user.id)
       if @user_artist.save
          #code...
       else
          #errors...
       end
   else
       #errors...
   end
end 
```

*（有一种我从未尝试过的更简单的方法；我会搜索并向您展示这种方式，但如果有人知道，请告诉我们）*

另外，我没有告诉你创建回调，因为在模型中你不能访问会话变量（我只记得它）

将来，当您想在一个表单上添加更多的 UserArtist 时，请查看[http://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)和[http://railscasts.com/剧集/197 嵌套模型形式第 2 部分](http://railscasts.com/episodes/197-nested-model-form-part-2)

**更新**

这是我之前告诉过你的方式（它将保存两条记录）：

```
@artist = Artist.new(params[:artist])
@artist.user_artists.new(:user_id => current_user.id)
if @artist.save
   #code
else
   #errors
end 
```

另外，我发现了这个有趣的条目：[仅当您成功保存父对象时才将更改保存到 has_many 关联？](https://stackoverflow.com/questions/4111345/save-changes-to-a-has-many-association-only-when-you-successfully-save-the-paren)

# c++ - astar_search 在以 listS 作为顶点容器的图上？

> ID：13790197
> 
> 赞同：3
> 
> 时间：2012-12-09T18:11:21.190
> 
> 标签：c++, boost, graph, a-star, boost-graph

似乎`boost::astar_search`不喜欢带有`boost::listS`顶点容器的图形。

```
typedef boost::adjacency_list<
    boost::listS,
    boost::listS,
    boost::undirectedS,
    WaypointNode,
    boost::property<boost::edge_weight_t, float> >
Waypoint; 
```

当我将第二个模板参数更改为时，上面的图形定义可以正常`boost::vecS`编译，而当我使用`boost::listS`.

我不太确定（因为模板错误消息拒绝被普通人理解）但问题似乎是因为算法需要`operator[]`出于某种原因访问。如果您确实使用，则不存在`listS`。我不太确定为什么需要随机访问，因为从概念上讲，无论如何您都可以从边缘列表中看到特定顶点存在哪个邻居。

我能做些什么来`astar_search`接受`listS`吗？

编辑：这是尝试编译（使用`g++`）上述代码时的错误消息。请注意，当我将第二个更改`boost::listS`为`boost::vecS`

这条线特别有趣，即它似乎抱怨（或缺乏）`operator[]`

```
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/shared_array_property_map.hpp: In member function 'T& boost::shared_array_property_map<T, IndexMap>::operator[](typename boost::property_traits<IndexMap>::key_type) const [with T = boost::default_color_type, IndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>]' 
```

这是完整的（和笨拙的）错误消息：

```
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/shared_array_property_map.hpp: In member function 'T& boost::shared_array_property_map<T, IndexMap>::operator[](typename boost::property_traits<IndexMap>::key_type) const [with T = boost::default_color_type, IndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>]':
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/property_map.hpp:361:   instantiated from 'void boost::put(const boost::put_get_helper<Reference, PropertyMap>&, K, const V&) [with PropertyMap = boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, Reference = boost::default_color_type&, K = void*, V = boost::default_color_type]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/astar_search.hpp:288:   instantiated from 'void boost::astar_search(const VertexListGraph&, typename boost::graph_traits<G>::vertex_descriptor, AStarHeuristic, AStarVisitor, PredecessorMap, CostMap, DistanceMap, WeightMap, VertexIndexMap, ColorMap, CompareFunction, CombineFunction, CostInf, CostZero) [with VertexListGraph = boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, AStarHeuristic = DistanceHeuristic<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS> >, AStarVisitor = WaypointNodeVisitor<void*>, PredecessorMap = boost::dummy_property_map, CostMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, DistanceMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, WeightMap = boost::adj_list_edge_property_map<boost::undirected_tag, float, const float&, void*, const boost::property<boost::edge_weight_t, float, boost::no_property>, boost::edge_weight_t>, VertexIndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>, ColorMap = boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, CompareFunction = std::less<float>, CombineFunction = boost::closed_plus<float>, CostInf = float, CostZero = float]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/astar_search.hpp:330:   instantiated from 'void boost::astar_search(const VertexListGraph&, typename boost::graph_traits<G>::vertex_descriptor, AStarHeuristic, const boost::bgl_named_params<P, T, R>&) [with VertexListGraph = boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, AStarHeuristic = DistanceHeuristic<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS> >, P = WaypointNodeVisitor<void*>, T = boost::graph_visitor_t, R = boost::no_property]'
Pathfinding.h:28:   instantiated from here
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/shared_array_property_map.hpp:36: error: no match for 'operator[]' in '((const boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >*)this)->boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >::data[boost::get [with PropertyMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>, Reference = const boost::detail::error_property_not_found&, K = void*](((const boost::put_get_helper<const boost::detail::error_property_not_found&, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >&)((const boost::put_get_helper<const boost::detail::error_property_not_found&, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >*)(&((const boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >*)this)->boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >::index))), ((void* const&)((void* const*)(& v))))]'
/usr/local/Cellar/boost/1.49.0/include/boost/smart_ptr/shared_array.hpp:103: note: candidates are: T& boost::shared_array<T>::operator[](ptrdiff_t) const [with T = boost::default_color_type]
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/shared_array_property_map.hpp: In member function 'T& boost::shared_array_property_map<T, IndexMap>::operator[](typename boost::property_traits<IndexMap>::key_type) const [with T = float, IndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>]':
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/property_map.hpp:361:   instantiated from 'void boost::put(const boost::put_get_helper<Reference, PropertyMap>&, K, const V&) [with PropertyMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, Reference = float&, K = void*, V = float]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/astar_search.hpp:289:   instantiated from 'void boost::astar_search(const VertexListGraph&, typename boost::graph_traits<G>::vertex_descriptor, AStarHeuristic, AStarVisitor, PredecessorMap, CostMap, DistanceMap, WeightMap, VertexIndexMap, ColorMap, CompareFunction, CombineFunction, CostInf, CostZero) [with VertexListGraph = boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, AStarHeuristic = DistanceHeuristic<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS> >, AStarVisitor = WaypointNodeVisitor<void*>, PredecessorMap = boost::dummy_property_map, CostMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, DistanceMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, WeightMap = boost::adj_list_edge_property_map<boost::undirected_tag, float, const float&, void*, const boost::property<boost::edge_weight_t, float, boost::no_property>, boost::edge_weight_t>, VertexIndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>, ColorMap = boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, CompareFunction = std::less<float>, CombineFunction = boost::closed_plus<float>, CostInf = float, CostZero = float]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/astar_search.hpp:330:   instantiated from 'void boost::astar_search(const VertexListGraph&, typename boost::graph_traits<G>::vertex_descriptor, AStarHeuristic, const boost::bgl_named_params<P, T, R>&) [with VertexListGraph = boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, AStarHeuristic = DistanceHeuristic<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS> >, P = WaypointNodeVisitor<void*>, T = boost::graph_visitor_t, R = boost::no_property]'
Pathfinding.h:28:   instantiated from here
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/shared_array_property_map.hpp:36: error: no match for 'operator[]' in '((const boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >*)this)->boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >::data[boost::get [with PropertyMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>, Reference = const boost::detail::error_property_not_found&, K = void*](((const boost::put_get_helper<const boost::detail::error_property_not_found&, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >&)((const boost::put_get_helper<const boost::detail::error_property_not_found&, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >*)(&((const boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >*)this)->boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >::index))), ((void* const&)((void* const*)(& v))))]'
/usr/local/Cellar/boost/1.49.0/include/boost/smart_ptr/shared_array.hpp:103: note: candidates are: T& boost::shared_array<T>::operator[](ptrdiff_t) const [with T = float]
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/vector_property_map.hpp: In member function 'typename std::iterator_traits<typename std::vector<T, std::allocator<_CharT> >::iterator>::reference boost::vector_property_map<T, IndexMap>::operator[](const typename boost::property_traits<IndexMap>::key_type&) const [with T = long unsigned int, IndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>]':
/usr/local/Cellar/boost/1.49.0/include/boost/property_map/property_map.hpp:361:   instantiated from 'void boost::put(const boost::put_get_helper<Reference, PropertyMap>&, K, const V&) [with PropertyMap = boost::vector_property_map<long unsigned int, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, Reference = long unsigned int&, K = void*, V = size_t]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/detail/d_ary_heap.hpp:118:   instantiated from 'void boost::d_ary_heap_indirect<Value, Arity, IndexInHeapPropertyMap, DistanceMap, Compare, Container>::push(const Value&) [with Value = void*, long unsigned int Arity = 4ul, IndexInHeapPropertyMap = boost::vector_property_map<long unsigned int, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, DistanceMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, Compare = std::less<float>, Container = std::vector<void*, std::allocator<void*> >]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/breadth_first_search.hpp:74:   instantiated from 'void boost::breadth_first_visit(const IncidenceGraph&, typename boost::graph_traits<G>::vertex_descriptor, Buffer&, BFSVisitor, ColorMap) [with IncidenceGraph = boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, Buffer = boost::d_ary_heap_indirect<void*, 4ul, boost::vector_property_map<long unsigned int, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, std::less<float>, std::vector<void*, std::allocator<void*> > >, BFSVisitor = boost::detail::astar_bfs_visitor<DistanceHeuristic<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS> >, WaypointNodeVisitor<void*>, boost::d_ary_heap_indirect<void*, 4ul, boost::vector_property_map<long unsigned int, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, std::less<float>, std::vector<void*, std::allocator<void*> > >, boost::dummy_property_map, boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, boost::adj_list_edge_property_map<boost::undirected_tag, float, const float&, void*, const boost::property<boost::edge_weight_t, float, boost::no_property>, boost::edge_weight_t>, boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, boost::closed_plus<float>, std::less<float> >, ColorMap = boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >]'
/usr/local/Cellar/boost/1.49.0/include/boost/graph/astar_search.hpp:260:   instantiated from 'void boost::astar_search_no_init(const VertexListGraph&, typename boost::graph_traits<G>::vertex_descriptor, AStarHeuristic, AStarVisitor, PredecessorMap, CostMap, DistanceMap, WeightMap, ColorMap, VertexIndexMap, CompareFunction, CombineFunction, CostInf, CostZero) [with VertexListGraph = boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, AStarHeuristic = DistanceHeuristic<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS> >, AStarVisitor = WaypointNodeVisitor<void*>, PredecessorMap = boost::dummy_property_map, CostMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, DistanceMap = boost::shared_array_property_map<float, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, WeightMap = boost::adj_list_edge_property_map<boost::undirected_tag, float, const float&, void*, const boost::property<boost::edge_weight_t, float, boost::no_property>, boost::edge_weight_t>, ColorMap = boost::shared_array_property_map<boost::default_color_type, boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t> >, VertexIndexMap = boost::adj_list_vertex_property_map<boost::adjacency_list<boost::listS, boost::listS, boost::undirectedS, WaypointNode, boost::property<boost::edge_weight_t, float, boost::no_property>, boost::no_property, boost::listS>, boost::detail::error_property_not_found, const boost::detail::error_property_not_found&, boost::vertex_index_t>, CompareFunction = std::less<float>, CombineFunction = boost::closed_plus<float>, CostInf = float, CostZero = float]'

make[2]: *** [build/Debug/GNU-MacOSX/BotManager.o] Error 1
make[1]: *** [.build-conf] Error 2
make: *** [.build-impl] Error 2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T06:12:52.260

`boost::detail::error_property_not_found&, boost::vertex_index_t`这是错误的重要部分。默认情况下，只有以 vecS 作为 VertexList 的邻接列表具有内部 vertex_index 属性映射。如果您真的想使用 listS（我相信它的唯一优点是删除顶点更简单），您需要通过`boost::property<boost::vertex_index_t, int, WaypointNode>`在图形声明中使用创建内部顶点索引属性映射，然后像[这样](https://stackoverflow.com/questions/11277820/bgl-adding-an-edge-with-multiple-properties)或[这样](http://boost.2283326.n4.nabble.com/BGL-add-vertex-vp-graph-with-mix-of-internal-amp-bundled-properties-td2571055.html)初始化它：

```
typedef boost::adjacency_list<
    boost::listS,
    boost::listS,
    boost::undirectedS,
    boost::property<boost::vertex_index_t, int, WaypointNode>,
    boost::property<boost::edge_weight_t, float> >
Waypoint;
Waypoint waypoint_graph;
...
add_vertex(boost::property<boost::vertex_index_t, int,WaypointNode>(0, waypoint_node_0), graph);
add_vertex(boost::property<boost::vertex_index_t, int,WaypointNode>(1, waypoint_node_1), graph);
...
astar_search(waypoint_graph, start, my_heuristic, boost::visitor(my_visitor)); 
```

或者您可以创建一个外部顶点索引属性映射，像[这样](https://stackoverflow.com/a/8555715/1252091)初始化它，然后`astar_search`使用命名参数调用`vertex_index_map`：

```
typedef boost::adjacency_list<
    boost::listS,
    boost::listS,
    boost::undirectedS,
    WaypointNode,
    boost::property<boost::edge_weight_t, float> >
Waypoint;
Waypoint waypoint_graph;
...
add_vertex(waypoint_node_0, graph);
add_vertex(waypoint_node_1, graph);
...
typedef map<typename boost::graph_traits<Waypoint>::vertex_descriptor, size_t> IndexMap;
IndexMap mapIndex;
associative_property_map<IndexMap> propmapIndex(mapIndex);
size_t i=0;
BGL_FORALL_VERTICES(v, waypoint_graph, Waypoing)
{
   put(propmapIndex, v, i++);
}
...
astar_search(waypoint_graph, start, my_heuristic, boost::visitor(my_visitor).vertex_index_map(propmapIndex)); 
```

这个问题不是独有的`astar_search`，这两种解决方案都可以与 Boost.Graph 库中的大多数算法一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T21:29:00.690

我不是 100% 肯定，但我想我之前用 listS 测试过一次 astar_search。我替换了以下图形类型的 vecS：

`boost::adjacency_list < boost::vecS, boost::vecS, boost::directedS, boost::no_property, boost::property<boost::edge_weight_t, Cost> >`

我在使用 listS 的 adjecency_list 上找到了一个执行 Dijkstra 最短路径的示例[。](http://www.boost.org/doc/libs/1_52_0/libs/graph/example/dijkstra-example-listS.cpp)看看那个。我的示例是在注释掉了很多依赖于向量的东西之后编译的，但是它仍然存在前任地图和距离地图的问题。该示例替换了那些使用 property_map 的示例。

# iphone - 使用 drawAtRect 绘制动画 NSString

> ID：13790198
> 
> 赞同：0
> 
> 时间：2012-12-09T18:11:22.987
> 
> 标签：iphone, objective-c, ios, ipad

我有几个，`UILabel's`我决定我想通过直接绘制而不是使用标签来提高`NSString`性能`NSString drawAtRect`。这一切都很好，除了稍后我在这个视图中有一个按钮，可以为`UILabel`. 我现在如何`NSString`为使用绘制的动画制作动画`drawRect`？

动画很简单，大概是这样的：

```
[UIView animateWithDuration:kDefaultAnimationDuration*2 animations:^{
        self.storyTitleLabel.alpha = 0.0;
        self.publisherNameLabel.alpha = 0.0;
        self.highlightButton.alpha = 0.0;
        self.highlightButton.enabled = NO;

        self.userFullName_.alpha = 1.0;
        self.lineDivider_.alpha = 1.0;
        self.numberOfHighlights_.alpha = 1.0;

        [self bringSubviewToFront:self.userFullName_];
        [self bringSubviewToFront:self.numberOfHighlights_];

        [self.userProfileButton setFrame:CGRectMake(115, 30, kProfilePicSize, kProfilePicSize)];
    } completion:^(BOOL finished) {

    }]; 
```

它本质上正在消失`UILabel's`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:30:51.360

我猜你的意思是`drawInRect; withFont:`。这借鉴了`UIView`. `UIView`您可以按照上面建议的相同方式为它的 alpha 设置动画。如果您在 上绘制了很多不同的东西`UIView`，并且不希望动画应用于所有这些东西，那么您将陷入困境。您必须创建另一个`UIView`大小合适的，将其作为子视图添加到第一个`UIView`，然后在其中绘制。很像一个`UILabel`，事实上...

# java - Java中的本机库位置

> ID：13790207
> 
> 赞同：1
> 
> 时间：2012-12-09T18:12:31.447
> 
> 标签：java, java-native-interface

我正在尝试开发一个名为 Sumerian (github.com/ryanthejuggler/Sumerian) 的程序，它是 Koper (koper.googlecode.com) 的一个分支。当我从 jar 中运行 Koper 时，它可以正常加载并且我可以使用该程序。我做了一些改进和重新编译，但现在它找不到**存储**在`libeinkfb.so`. 我已将其复制到下面输出的第二行中列出的位置，但该程序仍然仅在我从 jar 中运行时运行。

我重构的一部分是将所有东西都放在包中；原始代码具有扁平结构。

另外，我查看了 JAR 清单；这是非常基本的，只定义版本和入口类。

*我必须将 .so 文件放在哪里，以便我的 Java 程序可以看到它？*

**尝试运行我的代码：**

```
[root@(none) bin]# java com.ramuller.sumerian.Sumerian
/qte/lib:lib::/usr/java/packages/lib/arm:/lib:/usr/lib
construct EInkFB
java.lang.UnsatisfiedLinkError: com.ramuller.sumerian.display.eink.EInkFB.open(Ljava/lang/String;)Ljava/nio/ByteBuffer;
        at com.ramuller.sumerian.display.eink.EInkFB.open(Native Method)
        at com.ramuller.sumerian.display.eink.EInkFB.<init>(EInkFB.java:113)
        at com.ramuller.sumerian.Sumerian.main(Sumerian.java:72)
construct Display width=600 height=800Creating SwingDisplay...
Exception in thread "main" java.awt.HeadlessException: 
No X11 DISPLAY variable was set, but this program performed an operation which requires it.
        at java.awt.GraphicsEnvironment.checkHeadless(GraphicsEnvironment.java:207)
        at java.awt.Window.<init>(Window.java:535)
        at java.awt.Frame.<init>(Frame.java:420)
        at javax.swing.JFrame.<init>(JFrame.java:224)
        at com.ramuller.sumerian.display.SwingDisplay.<init>(SwingDisplay.java:21)
        at com.ramuller.sumerian.Sumerian.main(Sumerian.java:90) 
```

**之后立即运行 .jar，无需配置：**

```
[root@(none) bin]# java -jar ../Koper.jar 
User directory: /mnt/sd/bin
/qte/lib:lib::/usr/java/packages/lib/arm:/lib:/usr/lib
construct EInkFB
The framebuffer device was opened successfully.
^C[root@(none) bin]# java -version
java version "1.7.0_06"
Java(TM) SE Runtime Environment (build 1.7.0_06-b24)
Java HotSpot(TM) Client VM (build 23.2-b09, mixed mode) 
```

**编辑**我目前正在加载代码：

```
System.loadLibrary("einkfb"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:19:07.673

这行`com.ramuller.sumerian.display.eink.EInkFB.open(Native Method)`让我猜你重命名了包含本机方法的类的包，对吗？

使用 JNI，.so 文件中的方法名称和本地 Java 方法的名称需要完全匹配，包括方法的包名和类名。所以 Java 能够找到库（否则它会给出关于无法找到`einkfb`库的不同消息），但它无法找到该库中的方法。

您要么必须恢复类的重命名，要么还要重命名库中的函数，为此您必须重新编译它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:21:31.033

经过一番搜索，我发现您也可以使用显式加载库

```
System.loadLibrary("<name-of-lib>"); 
```

检查[此链接](http://www.swig.org/Doc1.3/Java.html#using_module)以获取更多信息。它给出了关于相同的描述`UnsatisfiedLinkError`。从给定的链接

> 最常见的原因是传递给 loadLibrary 函数的名称的本机库命名不正确。传递给 loadLibrary 函数的字符串不能在字符串中包含文件扩展名，即 .dll 或 .so。对于所有平台，该字符串必须是 name 而不是 libname。在 Windows 上，本地库必须称为 name.dll，而在大多数 Unix 系统上，它必须称为 libname.so。

还要检查[system.loadLibrary javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#loadLibrary%28java.lang.String%29)。

* * *

### 编辑

您还可以在发出`java`执行命令时指定库路径，如下所示。将`.so`文件放在目录中并在此处引用，

```
 java -Djava.library.path=. com.ramuller.sumerian.Sumerian 
```

# c++ - 三角形 - 二维正方形相交测试

> ID：13790208
> 
> 赞同：7
> 
> 时间：2012-12-09T18:12:33.807
> 
> 标签：c++, math, geometry, collision-detection, intersection

如何测试三角形和正方形是否相交？

当我们知道它是正方形而不是矩形时，有什么方法可以优化它？另外，正方形是轴对齐的，所以应该对性能有更多的提升吗？

还是我应该把正方形分成三角形，然后检查两次三角形-三角形相交？

**编辑：**澄清：我正在尝试检查这两个形状是否以任何方式相互重叠。所以三角形可以在正方形里面，正方形可以在三角形里面，它也应该返回true。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:32:44.920

将矩形（或正方形）与三角形的每条边进行比较，方法是获取三角形的顶点并为每条边建立直线方程，并以一致的顺序（围绕三角形顺时针或逆时针）。

如果矩形在任何边上完全位于三角形之外，则它不相交。

用矩形的边缘对着三角形再次测试。

通过知道矩形是轴对齐的，可能会提高性能，因为您可以计算出哪个角最有可能在三角形内，并仅测试那个角，而不是测试所有四个角。

这是否是一场胜利取决于实施。有时盲目地检查四个坐标而不是实际计算最好的坐标会更快。

对照矩形检查三角形应该更容易，因为当矩形轴对齐时，线方程是针对 x 或 y 的简单测试。

这是分离轴测试的一种广义形式 - 找到将两个对象分开的线或平面，从而证明它们不能相交。如果您想要更高的性能，您可以找到两个对象的最近特征来计算出最合适的线/平面来使用，而不是尝试所有这些。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-13T03:52:26.763

这是一个经典的碰撞检测问题。如果满足以下任一条件，则形状相交：

*   三角形中至少有一个顶点包含在矩形中。
*   矩形的至少一个顶点包含在三角形内。
*   三角形的任何边与矩形的任何边相交。

前两个条件涵盖了其中一个形状完全包含在另一个形状中的可能性（在这种情况下，边缘不会相交）。

一些优化是可能的。

*   计算形状的外接圆。如果两个形状的中心点之间的距离大于外接圆的半径之和，则可以排除碰撞。请注意，外接矩形的圆的中心点是其对角线的中点。三角形外接圆的中心点可以通过求任意两条边的垂直平分线的交点来获得。找到完全包含三角形的悲观估计圆的两种方法是：（1）使用最长边作为圆的直径，（2）创建一个边界矩形，角在（*mintx*，*minty*），（*mintx*，*maxty*）， （*最大TX*，*最大*) 和 ( *maxtx* , *minty* ) 其中***maxtx***是任何三角形角的最大 X 坐标，***mintx***是任何三角形角的最小 X 坐标，依此类推。

*   形状可以平移和旋转，以便矩形的顶点之一位于原点，矩形的底边沿 X 轴正方向。这使得查找三角形中的顶点是否包含在矩形内变得简单。

平移、旋转和线相交是很好理解的问题，您应该可以在 stackoverflow 、[stackoverflow](https://stackoverflow.com/questions/1585525/how-to-find-the-intersection-point-between-a-line-and-a-rectangle)或网络上的其他地方找到[合适的代码。](https://stackoverflow.com/questions/832959/line-intersection)

提示：

*   平移很容易——从每个 X 或 Y 坐标中添加或减去相同的值。
*   从概念上讲，旋转很容易——对于每个点，转换为极坐标，加上或减去旋转角度，然后再转换回笛卡尔坐标。由于转换到/从极坐标在计算上很昂贵，因此您可以使用以下公式进行旋转：

    Xrot = X * cos(theta) - Y * sin(theta)
    Yrot = X * sin(theta) + Y * cos(theta)

*   您可以通过取矩形的一侧来找到角度*theta*，并注意

    theta = atan2(deltaX, deltaY)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-11T02:20:08.973

作为对 Jay Elston 答案的改进，您可以将正方形/四边形拆分为两个三角形，然后使用[Möller–Trumbore](http://en.wikipedia.org/wiki/M%C3%B6ller%E2%80%93Trumbore_intersection_algorithm)相交算法来比较包含的顶点。如果你阅读发表的[论文](http://www.cs.virginia.edu/~gfx/Courses/2003/ImageSynthesis/papers/Acceleration/Fast%20MinimumStorage%20RayTriangle%20Intersection.pdf)，最后有一个算法的 C 实现。

这将让您检查顶点包含。然后使用 Jay 的链接之一作为交叉口。

# c - 函数在c中不起作用

> ID：13790209
> 
> 赞同：4
> 
> 时间：2012-12-09T18:12:37.490
> 
> 标签：c, function

我正在学习 C 编程并编写了一个简单的程序来学习 C 中的函数。我在这里使用了两个函数，虽然第一个有效但第二个无效！

这是简单的代码：

```
#include<stdio.h>

void main() {
  int a,b,c,sum;
  printf("Input your numbers one by one:\n");
  scanf("%d", &a);
  scanf("%d", &b);
  scanf("%d", &c);
  printf("You have put %d, %d, %d\n\n", a, b, c);
  max (a,b,c);
  min (a,b,c);
}

void max (int a, int b, int c) {
  int sum;
  a=sum;
  if(sum>b)
    sum=b;
  if(sum>c)
    sum=c;
}

void min (int f, int g, int h) {
  int sum;
  sum=f;
  if(sum<g)
    sum=g;
  if(sum<h)
    sum=h;
  printf("The lowest value is:%d\n\n\n",sum);
} 
```

谁能告诉我为什么会发生这种情况以及解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:16:09.600

您的任何功能都不应该起作用。第一个设置在变量`a`中，其当前值`sum`是未初始化的。

然后在搜索 MAX 值时，检查当前总和（假定为`a`）是否大于`b`，如果是，则将`b`值存储在`sum`.

然后，如果您想在定义之前调用函数，则需要将函数的原型放在文件的开头。在您调用它们之前，您会遇到编译错误`min()`。`max()`

它应该是这样的：

```
#include<stdio.h>

void max (int a, int b, int c);
void min (int f, int g, int h);

void main()
{
  int a,b,c,sum;
  printf("Put your numbers throughly one by one:\n");
  scanf("%d", &a);
  scanf("%d", &b);
  scanf("%d", &c);
  printf("You have putted %d, %d, %d\n\n", a, b, c);
  max (a,b,c);
  min (a,b,c);
}

void max (int a, int b, int c)
{
    int sum;
    sum = a;
    if(sum<b)
        sum=b;
    if(sum<c)
        sum=c;

    printf("The max value is:%d\n\n\n",sum);
}

void min (int f, int g, int h)
{
    int sum;
    sum=f;
    if(sum>g)
        sum=g;
    if(sum>h)
        sum=h;

    printf("The min value is:%d\n\n\n",sum);
} 
```

# javascript - JavaScript 继承 - 我做对了吗？

> ID：13790212
> 
> 赞同：3
> 
> 时间：2012-12-09T18:12:51.863
> 
> 标签：javascript, inheritance, prototype

## 问题：

1.  为什么第一种方法能正确识别物体为法拉利？（在 Chrome 中测试）
2.  我在这两种方法中正确地进行继承吗？
3.  我是否正确理解第一个示例中存在一些隐藏的“构造函数”属性，如果是，它们在哪里，是什么把它们放在那里？在我没有明确输入的第二个示例中是否有任何隐藏的构造函数属性？
4.  如果我已经正确地完成了继承，我应该使用最后两种方法中的哪一种来让对象被识别为法拉利？或者我应该不在乎 - 毕竟“instanceof”仍然有效？

## 语境：

**使用 JavaScript 的“新”方法创建对象，效果很好：**

```
Vehicle.prototype = {}; // Not required I know
function Vehicle() {

}

Car.prototype = new Vehicle();
function Car() {

}

Ferrari.prototype = new Car();
function Ferrari() {

}
var o = new Ferrari();
console.log(o); 
```

**哪个输出：**

```
> Ferrari
  > __proto__ : Car
    > __proto__ : Vehicle
      > __proto__ : Object <- The one that isn't required
        > __proto__ : Object <- Provided by JS
          ...
          hasOwnProperty: function hasOwnProperty() { [native code] }
          ... 
```

**现在我想做同样的事情来避免使用 new 关键字，这就是我所拥有的：**

```
Vehicle.prototype = {};
function Vehicle() {
  var vehicle = Object.create(Vehicle.prototype);
  return vehicle;
}

Car.prototype = Vehicle();
Car.prototype.constructor = Vehicle;
function Car() {
  var car = Object.create(Car.prototype);
  return car;
}

Ferrari.prototype = Car();
Ferrari.prototype.constructor = Car;

function Ferrari() {
  var ferrari = Object.create(Ferrari.prototype);
  //ferrari.constructor = Ferrari;  <- Lookey here - commented line
  return ferrari;
}

var o = new Ferrari();
console.log(o); 
```

**哪个输出：**

```
> **Car**
  > __proto__ : Car
    > constructor : function Car()
      __proto__ : Vehicle
      > constructor : function Vehicle()
        __proto__ : Object <- The one that isn't required
        > __proto__ : Object
          ...
          hasOwnProperty: function hasOwnProperty() { [native code] }
          ... 
```

*请注意，输出的第一行现在是 Car，而不是 Ferrari。这可以通过删除注释行来纠正，或者通过改变法拉利的原型如下：*

```
var realPrototype = Car();
realPrototype.constructor = Car;

Ferrari.prototype = Object.create(realPrototype);
Ferrari.prototype.constructor = Ferrari; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T23:05:03.047

> 为什么第一种方法能正确识别物体为法拉利？（在 Chrome 中测试）
> 
> 我是否正确理解第一个示例中存在一些隐藏的“构造函数”属性，如果是，它们在哪里，是什么把它们放在那里？在我没有明确输入的第二个示例中是否有任何隐藏的构造函数属性？

是的，如果您分配给函数的`prototype`属性或以某种方式创建新实例，Chrome 似乎会设置一个隐藏的“构造函数”属性。具体还没有弄清楚。

他们在哪里？可能是一些只能`console.log`访问的内部属性。然而，您似乎能够用显式的“构造函数”属性覆盖它们，至少对于`__proto__`对象的显示。

我猜这是由 Chrome 完成的，因为许多人在覆盖原型对象时忘记设置构造函数属性（因为[它实际上是无用的），尽管它](https://stackoverflow.com/q/4012998/1048572)[是推荐的](https://stackoverflow.com/q/4944278/1048572)- 另见[JavaScript 继承和构造函数属性](https://stackoverflow.com/q/8093057/1048572)。Chrome 开发人员想要制作一个`log`指示对象类型的漂亮函数，因此他们需要解决人们的懒惰问题。

> 我在这两种方法中正确地进行继承吗？

您的代码中的继承没有问题。新创建`Car`的实例具有期望的原型链，具有两种方法。

不过，也有一些陷阱。不要使用`new`关键字来创建原型~~对象~~实例。您不想要完整的实例，并在它们上应用构造函数。只需使用`Car.prototype = Object.create(Vehicle.prototype)`; 另请参阅[在 Derived.prototype = new Base 使用“new”关键字的原因是什么的答案](https://stackoverflow.com/q/12592913/1048572)

此外，您没有设置“构造函数”属性，或者做错了。在原型对象上定义的该属性由调用相应构造函数创建的所有对象继承`new`，并且应该为它们提供对该函数的引用。对于任何创建的函数，默认情况下都会执行此操作，请参阅[EcmaScript 规范 §13.2 步骤 16-18](http://es5.github.com/#x13.2)。

如果您重新分配给`fn.prototype`，您将覆盖该行为（无论它是对象文字、`new`构造还是`Object.create`调用）。实际上，“构造函数”属性然后[从原型链中更高的对象继承](https://stackoverflow.com/q/12394972/1048572)- 在您的第一个示例`o.constructor`中`Object`，是从空对象文字继承的。因此，在您的情况下，我们需要在分配后重置它：

```
Vehicle.prototype.constructor = Vehicle;
Car.prototype.constructor = Car;
Ferrari.prototype.constructor = Ferrari;

// or, we combine it with the Object.create call:
Car.prototype = Object.create(Vehicle.prototype, {
    constructor: {value:Car, configurable:true, writable:true}
}); 
```

请注意，无需在构造函数中显式设置它（如在第二个示例中），在对象上创建一个额外的属性。这就是继承的目的。

或者我们根本不关心“构造函数”属性：

> 我应该使用最后两种方法中的哪一种来让对象被识别为法拉利？或者我应该不在乎 - 毕竟“instanceof”仍然有效？

要将对象识别为法拉利，请始终使用`instanceof`. “构造函数”属性不可靠。它可能被忘记设置，或者它不是您在比较中所期望的：像这样的“类型检查”`someObj.constructor === Car`不适用于法拉利或任何其他正确设置其构造函数属性的“子类”。它与`instanceof`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-09T18:36:31.520

> **为什么第一种方法能正确识别物体为法拉利？**

因为对象的构造`o`函数是函数`Ferrari`。

> **我在这两种方法中正确地进行继承吗？**

您在第一种方法中做得正确，但在第二种方法中做得不正确。

> **如果我已经正确地完成了继承，我应该使用最后两种方法中的哪一种来让对象被识别为法拉利？或者我应该不在乎 - 毕竟“instanceof”仍然有效？**

为了统一起见，您应该在函数体内的每个原型上设置构造函数属性*，*这样您就不必这样做：

```
Car.prototype = Vehicle();
Car.prototype.constructor = Vehicle;

Aeroplane.prototype = Vehicle();
Aeroplane.prototype.constructor = Vehicle;

... 
```

相反，您应该使用：

```
function Vehicle() {
    var vehicle = Object.create(Vehicle.prototype);
    vehicle.constructor = Vehicle;
    return vehicle;
}

Car.prototype = Vehicle();
function Car() {
    var car = Object.create(Car.prototype);
    car.constructor = Car;
    return car;
}

Ferrari.prototype = Car();
function Ferrari() {
    var ferrari = Object.create(Ferrari.prototype);
    ferrari.constructor = Ferrari;
    return ferrari;
}

var o = new Ferrari();
console.log(o); 
```

这正确地导致了与您的第一个示例中的结构相似的结构。

# javascript - 无法在 AngularJS 模板中循环数组

> ID：13790213
> 
> 赞同：0
> 
> 时间：2012-12-09T18:12:58.130
> 
> 标签：javascript, angularjs

AngularJS 遇到了一个令人沮丧的问题。我要做的就是加载一个 json 文件并使用 ng:repeat 在模板中显示它。过去我对此没有任何问题，但由于某种原因，下面的代码不起作用。有人可以看看并告诉我我错过了什么吗？

如果您查看模板：

**调色板.html**

```
{{palette}}

<div ng-repeat="for color in palette">{{color}}</div> 
```

`{{palette}}`输出`[{"hex":"#6e4516"},{"hex":"#DDDABE"},{"hex":"#ECEAD9"},{"hex":"#98A349"},{"hex":"#798616"}]`但是 ng:repeat 什么也不显示。所以 json 被加载到作用域中，但由于某种原因，我无法遍历它。

这是我的主要 js 文件：

**应用程序.js**

```
var App = angular.module('App', []).
    config(function($routeProvider)
    {
        $routeProvider.
            when('/palette', {templateUrl:'templates/palette.html', controller:PaletteController}).
            otherwise({redirectTo:'/home'})
    });

function PaletteController($scope, $http){
    $http.get('palette.json').success(function(palette){
        $scope.palette = palette;
    });
} 
```

以及从 json 文件加载的数据：

**调色板.json**

```
[
    {"hex": "#6e4516"},
    {"hex": "#DDDABE"},
    {"hex": "#ECEAD9"},
    {"hex": "#98A349"},
    {"hex": "#798616"}
] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:22:06.733

您在 ng-repeat 的表达式部分中的代码不正确。你需要这样的东西：

```
<div ng-repeat="color in palette">{{color.hex}}</div> 
```

# c++ - 类数组 - 删除操作

> ID：13790215
> 
> 赞同：1
> 
> 时间：2012-12-09T18:13:06.450
> 
> 标签：c++, heap-memory

我有这个代码：

```
 Derived **args = new Derived*[2];
 args[0] = new Derived();
 args[0]->setname("BLABLA \n");
 cout << args[0]->getname();
 delete args[0];

 args[1] = new Derived();
 args[1]->setname("BLABLABLA\n");
 cout << args[1]->getname();
 delete args[1];
 delete [] args; 
```

是`delete [] args`必需的吗？为什么？

另外，`Derived **args = new Derived*[2]`真正的作用是什么？它是否为两个指针分配空间`Derived`？如果是这样，那么如何在堆上动态创建一个包含 2 个 Derived 类型的对象的数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:15:52.050

> `delete []`需要args吗？为什么？

是的。它释放由 分配的内存`new Derived*[2]`。

> 另外，`Derived **args = new Derived*[2]`真正的作用是什么？

它为两个*指向*`Derived`. 它不为任何`Derived` *对象*分配空间。

> 如何`Derived`在堆上动态创建一个包含 2 个类型对象的数组？

只需删除一级间接：

```
 Derived *args = new Derived[2];

 args[0].setname("BLABLA \n");
 cout << args[0].getname();

 args[1].setname("BLABLABLA\n");
 cout << args[1].getname();

 delete [] args; 
```

但请记住，数组和多态性不能混用。有关详细信息，请参阅[如何在 C++ 中创建具有多态性的数组？](https://stackoverflow.com/questions/13718527/how-to-make-an-array-with-polymorphism-in-c)

# php - Zend Framework 中未显示的错误

> ID：13790218
> 
> 赞同：1
> 
> 时间：2012-12-09T18:13:33.390
> 
> 标签：php, zend-framework, apache2

我的设置：

```
PHP 5.3.10-1ubuntu3.4 with Suhosin-Patch (cli) (built: Sep 12 2012 18:59:41) 
Copyright (c) 1997-2012 The PHP Group
Zend Engine v2.3.0, Copyright (c) 1998-2012 Zend Technologies
with Xdebug v2.1.0, Copyright (c) 2002-2010, by Derick Rethans

Zend Framework 1.11.1
PHP 5.3.4
php.ini:
   error_reporting E_ALL | E_STRICT
    display_errors On
    display_startup_errors On 
```

我还启用了对文件的错误日志记录（文件为空），
并打开了`xdebug.scream`.

但在某些情况下，不显示错误，我得到的是空白页面（例如，在某些类中解析错误（缺少分号）或使用不存在的接口）。

看起来我遇到了与这个旧问题非常相似的问题：http: [//framework.zend.com/issues/browse/ZF-2463](http://framework.zend.com/issues/browse/ZF-2463)

在这种情况下调试器不会启动，很难猜测错误实际发生在哪里。
设置自定义错误处理程序也无济于事，并且更改自动加载器的设置以抑制未找到的战争。

还有其他选项如何强制 ZF 始终显示错误消息？

## 编辑：

`application.ini`设置也设置正确

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:17:32.243

您应该添加：

```
define('APPLICATION_ENV', 'development'); 
```

在 index.php 中，相反的是：

```
define('APPLICATION_ENV', 'production'); 
```

然后在 application.ini ：

```
[production : bootstrap]

phpSettings.display_startup_errors = 0
phpSettings.display_errors         = 0
settings.debug.enabled             = false

[qa : production]

phpSettings.display_startup_errors = 0
phpSettings.display_errors         = 0
settings.debug.enabled             = false

[preqa : qa]

phpSettings.display_startup_errors = 0
phpSettings.display_errors         = 0
settings.debug.enabled             = false

[testing : preqa]

phpSettings.display_startup_errors = 1
phpSettings.display_errors         = 1
settings.debug.enabled             = false

[development : testing]

phpSettings.display_startup_errors = 1
phpSettings.display_errors         = 1
settings.debug.enabled             = true 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:17:45.797

application.ini中也有

```
phpSettings.display_startup_errors = 1
phpSettings.display_errors = 1
resources.frontController.params.displayExceptions = 1 
```

这些将覆盖您在 php.ini 或 index.php 中设置的任何内容。

# android - 适用于 Android 的 Google Analytics（分析）未发送命中

> ID：13790223
> 
> 赞同：1
> 
> 时间：2012-12-09T18:13:58.077
> 
> 标签：android, google-analytics

我什么都试过了。我三重检查了 analytics.xml 中 ID 中的破折号，我拥有所需的两个权限，我有

```
EasyTracker.getInstance().activityStart(this);
EasyTracker.getInstance().activityStop(this); 
```

在适当的方法中，我仍然在 logcat 中得到以下内容：

```
Thread[main,5,main]: Connection to service failed 1
Thread[main,5,main]: Need to call initialize() and be in fallbackmode to start dispatch.
Thread[GAThread,5,main]: No campaign data found.
Thread[GAThread,5,main]: putHit called
Thread[GAThread,5,main]: putHit called
Thread[Service Reconnect,5,main]: connecting to Analytics service
Thread[Service Reconnect,5,main]: connect: bindService returned false for Intent { act=com.google.android.gms.analytics.service.START (has extras) }
Thread[Service Reconnect,5,main]: Connection to service failed 1
Thread[GAThread,5,main]: Sending hit to store
Thread[GAThread,5,main]: Sending hit to store
Thread[GAThread,5,main]: dispatch running...
Thread[GAThread,5,main]: User-Agent: GoogleAnalytics/2.0 (Linux; U; Android 4.1.1; en-us; Galaxy Nexus Build/JRO03O)
Host: www.google-analytics.com
GET /collect?[information collected]
Thread[GAThread,5,main]: Exception sending hit: HttpHostConnectException
Thread[GAThread,5,main]: Connection to http://www.google-analytics.com refused
Thread[GAThread,5,main]: sent 0 of 40 hits 
```

然后它每 30 秒从“调度运行...”开始再次重复所有内容，这是我设置的时间间隔。

这不是互联网问题，因为我的应用程序可以很好地连接到其他网站。我在分析网站上的资料是针对 V2.0 的。自从我设置它以来已经两天多了。

我还可以做些什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T23:47:50.863

我注意到一个错误说

> 与 www.google-analytics.com/127.0.0.1 的连接被拒绝

我想*“这很奇怪，为什么会去本地主机？”* 然后我记得我有一个修改过的主机文件。看起来我放在手机上阻止广告的主机文件也阻止了谷歌分析。我已经删除了这些条目，一切正常。如果您遇到这些问题，请检查您的主机文件是否阻止了分析。

# javascript - Ember 绑定到数组元素

> ID：13790227
> 
> 赞同：2
> 
> 时间：2012-12-09T18:14:24.997
> 
> 标签：javascript, ember.js

我正在尝试在控制器和模型之间设置余烬绑定。控制器是数组的一部分（请参阅问题[Ember.js views (unlimited number)](https://stackoverflow.com/questions/13740417/ember-js-views-unlimited-number)），因此我正在尝试设置与模型（ArrayProxy）中的元素的绑定，其索引与索引相同控制器本身。

如果我将绑定链接到 ArrayProxy 的非索引元素，则绑定有效，但如果我尝试设置数组的元素，则绑定无效。所以，如果我像这样设置绑定：

```
answerBinding: 'App.SurveyData.test' 
```

并在 App.SurveyData 中将“test”设置为字符串，例如“StackOverlow”，正确设置了双向绑定。如果我设置一个绑定

```
answerBinding: 'App.SurveyData.content' 
```

其中内容是一个数组，我可以在控制台中查看“答案”的值为“数组 [2]”，并且每个元素都等于“测试对象”，如预期

当我尝试将 answerBinding 设置为

```
answerBinding: 'App.SurveyData.content[0]' 
```

它试图根据需要将答案链接到 SurveyData 中的第一个元素，我可以在控制台中查看“答案”的值未定义。

代码位于[http://jsfiddle.net/reubenposthuma/dyLGG/1/](http://jsfiddle.net/reubenposthuma/dyLGG/1/)

任何想法将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T03:05:30.943

Ember 的绑定仅适用于属性。不能绑定 Array 的特定索引，除非您通过计算属性这样做，例如：

```
answerBinding: 'App.SurveyData.firstItem' 
```

...并在 App.SurveyData 中定义了计算属性：

```
firstItem: function() { return this.objectAt(0); }.property('content') 
```

这样想：数组索引是`[]`函数的一个参数（不是字面意思，而是为了这个解释。）绑定不能除了参数；它们纯粹是要绑定的属性的静态路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T17:10:39.607

正如 Mars 所说，绑定不能接受数组的索引，所以我创建了一个解决方法。这是一种方式，尽管它可以修改为在数组本身上有一个观察者以进行双向绑定。出于我的目的（从调查中获取数据并将其放入答案数组中），一种绑定方式可以完美地工作。

```
answerObserver: function() {
  App.SurveyData.content[this.id-1] = this.answer;
}.observes('answer'), 
```

每当数据（在本例中为文本框）更改时，更改将被复制到数组的索引中。

# iframe - 如何获取我的 IFRAME 控件的名称？

> ID：13790229
> 
> 赞同：0
> 
> 时间：2012-12-09T18:15:19.407
> 
> 标签：iframe, dynamics-crm-2011

在[此讨论中，通过将 IFRAME 的名称称为“](https://stackoverflow.com/questions/7913468/ms-crm-2011-javascript-iframe-functions) *IFRAME_name* ”来提出解决方案。

我想知道我应该如何在我的 CRM 中获得该名称。

编辑：我正在谈论的组件看起来像一个 IFRAME，但实际上是一个网络资源（CRM 中的 HTML 文档**，**即不是外部页面）。当我提到 CRM 的东西时，我会去

```
parent.window.Xrm.Page + the usuals 
```

但是我怎样才能从 CRM**到**那个组件呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:27:15.320

当您在窗体上创建 IFrame 时，您设置了一个名称。

打开表单自定义并从那里读取名称。

![在此处输入图像描述](../Images/efe3291573fb8790a4d3605aa8ac8bf6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T16:02:11.310

采用：

```
console.dir(Xrm.Page.data.entity.attributes) 
```

然后按*F12*打开控制台以检查对象。必须在页面上打开控制台才能识别控制台变量，因此我通常在打开控制台的情况下刷新页面。

采用：

```
var iFrame = descriptionIFrame.contentDocument 
  || descriptionIFrame.contentWindow.document; 
```

访问 IFRAME 内容，其中*descriptionIFrame*是对 IFRAME 对象的引用。

# java - BubbleSort 输出图问题

> ID：13790230
> 
> 赞同：1
> 
> 时间：2012-12-09T18:15:28.950
> 
> 标签：java, execution, bubble-sort

嗨，我用 JAVA 编写了一个冒泡排序应用程序。该应用程序正在充分工作并提供足够的输出，但它并没有给我平均时间的输出。

这是我的代码：

```
public class BubbleSort {
static double bestTime = 10000000, worstTime = 0;
public static void main(String[] args) {
    int BubArray[] = new int[]{**#interger values are placed in here#**};
         System.out.println("Unsorted List Before Bubble Sort");
         for(int a = 0; a < BubArray.length; a++){
         System.out.print(BubArray[a] + " ");
            }

        System.out.println("\n Bubble Sort Execution ...");

                    for(int i=0; i<10000;i++) {
                        bubbleSortTimeTaken(BubArray, i);
                        }

         int itrs = bubbleSort(BubArray);
    System.out.println("");               
    System.out.println("Array After Bubble Sort");
    System.out.println("Moves Taken for Sort : " + itrs + " Moves.");
    System.out.println("BestTime: " + bestTime + " WorstTime: " + worstTime);
    System.out.print("Sorted Array: \n");

        for(int a = 0; a < BubArray.length; a++){
                System.out.print(BubArray[a] + " ");
        }
}

private static int bubbleSort(int[] BubArray) {

int z = BubArray.length;
int temp = 0;

int itrs = 0;

for(int a = 0; a < z; a++){
        for(int x=1; x < (z-a); x++){

                if(BubArray[x-1] > BubArray[x]){

                        temp = BubArray[x-1];
                        BubArray[x-1] = BubArray[x];
                        BubArray[x] = temp;

                }    

                itrs++;
        }
}

return itrs;
}

public static void bubbleSortTimeTaken(int[] BubArray, int n) 
{
long startTime = System.nanoTime();
    bubbleSort(BubArray);   
    double timeTaken = (System.nanoTime() - startTime);
    if (timeTaken > 0)
    {
        worstTime = timeTaken;
    }
    else if (timeTaken < bestTime)
    {
        bestTime = timeTaken;
    }

    System.out.println(n + "," + timeTaken);

}
} 
```

但我不确定如何 a) 获得每个的平均时间，以及如何在图表上绘制最佳、平均和最坏情况的结果。

这是一个示例输出：

```
Unsorted List Before Bubble Sort
#Integers Values of Unsorted List#

Bubble Sort Execution ... **#(execution number, time in nanoseconds)#**
0,6336584.0
1,5063668.0
2,3364580.0
3,3373289.0
4,3755912.0
5,3383866.0
....
9995,3431772.0
9996,3368312.0
9997,3743469.0
9998,4639362.0
9999,3433638.0

Moves Taken for Sort : 499500 Moves.
BestTime: 1.0E7 WorstTime: 3433638.0 
```

此外，我不确定我的`bubbleSortTimeTaken()`函数是否正常工作，因为每次运行程序都会给出 1.0E7，无论使用的整数数量（100、1000、10000、100000、1000000）已经过测试。我希望找到要绘制的平均、最佳和最坏情况。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:22:04.183

```
 if (timeTaken > 0)   // <- PROBLEM, Shouldn't be zero
    {
        worstTime = timeTaken;
    }
    else if (timeTaken < bestTime) //<- PROBLEM! , the 2 comparisons are unrelated
    {
        bestTime = timeTaken;
    } 
```

在那里。如果`timeTaken`> 0（大部分情况下），`else if`则永远不会执行。
因此，`bestTime`永远不会更新，并保留原始值 (1E7)。

要解决此问题，应将函数修改为如下所示：

```
public static void bubbleSortTimeTaken(int[] BubArray, int n) 
{
long startTime = System.nanoTime();
    bubbleSort(BubArray);   
    double timeTaken = (System.nanoTime() - startTime);
    if (timeTaken > worstTime)
    {
        worstTime = timeTaken;
    }
    if (timeTaken < bestTime)
    {
        bestTime = timeTaken;
    }

    System.out.println(n + "," + timeTaken);

}
} 
```

请注意，我也添加了一个可能的修复`worstTime`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:22:07.547

```
 if (timeTaken > 0)
{
    worstTime = timeTaken;
} 
```

这应该是

```
 if (timeTaken > worstTime)
{
    worstTime = timeTaken;
} 
```

否则你将无法正确设置它。这就解释了为什么你的 bestTime 总是 10e7。

要找到平均值，只需执行一定次数，记录所有时间，然后将它们相加并除以完成的次数。

# javascript - observable.subscribe 或自定义绑定或

> ID：13790242
> 
> 赞同：2
> 
> 时间：2012-12-09T18:16:57.170
> 
> 标签：javascript, knockout.js

我有一个带有 knockout.js 的简单培训案例，我想根据范围滑块值显示不同数量的苹果。这是滑块：

```
<input data-bind="value: currentAppleCount" type="range" step="1" min="2" max="10"/> 
```

每次用户移动滑块手柄时，都应该使用一些方法（如`renderApples(appleCount)`.

我应该使用 model.currentAppleCount.subscribe(renderApples) 还是有更好的方法，因为这种情况很简单，并且 knockoutjs 文档指出“您通常不需要手动设置订阅”。此外，作为一种良好做法，方法应该作为参数`renderApples`接收或直接访问 observable。`appleCount``model.currentAppleCount`

**编辑：**

问题是我需要使用带有添加和删除方法的第三方 api。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:53:19.510

使用 a`ko.computed`返回适当长度的数组。每次更新引用的 observable 时，都会重新评估计算的属性。

```
function ViewModel() {
    this.currentAppleCount = ko.observable(2);
    this.apples = ko.computed(function () {
        var currentAppleCount = this.currentAppleCount();
        var apples = [];
        for (var i = 1; i <= currentAppleCount; i++) {
            apples.push(i);
        }
        return apples;
    }, this);
}

ko.applyBindings(new ViewModel()); 
```

或者，您可以返回一个完整数组的切片。这样您就可以保留对象实例。

```
<input data-bind="value: currentAppleCount" type="range" step="1" min="2" max="10"/>
<ul data-bind="foreach: apples">
    <li>Apple #<span data-bind="text: $data"></span></li>
</ul> 
```

[http://jsfiddle.net/MizardX/KeHKB/](http://jsfiddle.net/MizardX/KeHKB/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T13:25:46.720

如果您正在使用第三方 API，例如 jQueryUI 小部件或类似的东西，那么设置订阅似乎是正确的做法。

我猜你的第三方 API 不理解淘汰赛，因此不知道如何处理 observables。设置订阅允许您拥有自己的代码，该代码将从 observable 获取更新的值并将其传递给 API。

```
model.currentAppleCount.subscribe(function(newValue) {
  someOtherAPI.UpdateAppleCount(newValue);
}); 
```

你是对的，文档说：

*您通常不需要手动设置订阅，因此初学者应跳过此部分*

这意味着您不再是初学者。:)

PS 如果您的第三方 API 能够更新 appleCount 的值，请务必挂钩到他们提供的某种类型的更新事件，然后从那里设置 observable。就像是：

```
// I'm just making up the OnAppleCountUpdate event.  I have 
// no idea what it might be called in the third party API.
someOtherAPI.OnAppleCountUpdate(function(newValueFromAPI) {
    model.currentAppleCount(newValueFromAPI);
}); 
```

这将允许您在 HTML/KO 片段和第三方 API 之间进行双向绑定。

# ruby-on-rails-3 - 推送到 Heroku 不更新我的 Rails 应用程序

> ID：13790245
> 
> 赞同：1
> 
> 时间：2012-12-09T18:17:13.487
> 
> 标签：ruby-on-rails-3, heroku, deploying

我正在使用 Heroku 部署我的 rails 应用程序。但是当我提交到 git 并推送到 Heroku 时，有些东西不会从我的本地应用程序更新。一些 CSS 和 AJAX 的东西主要来自我能说的。

我已经跑了`git status`，没有什么可承诺的。我没有从 Heroku 收到任何错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T01:24:08.977

我必须在部署之前预编译资产。

# grails - 如何使用 MockFor 在 HttpBuilder 上模拟客户端？

> ID：13790246
> 
> 赞同：4
> 
> 时间：2012-12-09T18:17:14.117
> 
> 标签：grails, groovy, httpbuilder

我有一些我想测试的 Grails 生产代码，我在这里看到了一些例子，见下文。问题是我在 HttpBuilder 的客户端部分遇到了 MissimgMethodExceptions。这是我要测试的生产代码：

```
class RunkeeperActivitiesRetrieverService {
    def http = new RESTClient("http://api.runkeeper.com/")

    def getActivities() {
        http.client.clearRequestInterceptors();
        http.client.addRequestInterceptor(new HttpRequestInterceptor() {
            void process(HttpRequest httpRequest, HttpContext httpContext) {
                httpRequest.addHeader('Authorization', 'Bearer xxxxxxxxxx')
            }
        })
        //Do more with the httpBuilder
    }
} 
```

我在这里找到了一些关于模拟 HTTPBuilder 的帮助：[Groovy HTTPBuilder Mocking the Response](https://stackoverflow.com/questions/9101084/groovy-httpbuilder-mocking-the-response)和一些关于在 groovy 文档中模拟接口的帮助：http: [//groovy.codehaus.org/Groovy+way+to+implement+interfaces](http://groovy.codehaus.org/Groovy+way+to+implement+interfaces)

使用该代码我来到了这个测试代码：

```
def mock = new MockFor(HTTPBuilder)
def impl = [
    addRequestInterceptor : {HttpRequestInterceptor interceptor -> println "hi 4"+interceptor},
    clearRequestInterceptors : {println "hi 88"}
            ]
def client = impl as HttpClient

mock.demand.getClient {return client}
mock.use{
    service.http = new HTTPBuilder()
    println service.getActivities()
} 
```

不幸的是，我对 Groovy 的了解太有限，无法解决引发的异常：`groovy.lang.MissingMethodException: No signature of method: $Proxy15.clearRequestInterceptors() is applicable for argument types: () values: []`

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T23:32:17.203

您正在转换`impl`-`HttpClient`它似乎没有在[该接口](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/HttpClient.html)上定义有问题的方法。也许您的意思是使用[`AbstractHttpClient`](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/impl/client/AbstractHttpClient.html).

# android - 具有 SPEC 的 Android 手机列表：VFP、NEON、ARMv6/7

> ID：13790249
> 
> 赞同：5
> 
> 时间：2012-12-09T18:17:23.967
> 
> 标签：android, arm

我正在寻找所有主要 android 手机的在线列表（可能是 wiki），例如：-

[http://en.wikipedia.org/wiki/Comparison_of_Android_devices](http://en.wikipedia.org/wiki/Comparison_of_Android_devices)

我希望它包含 VFP、VFPv3、NEON、ARMv6、ARMv7 等技术信息

最重要的是VFP（硬件浮点）

根据 Flurry 的说法，我们有 100 多个设备要检查，我想了解有多少设备支持浮点 VFP。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T23:25:35.740

我不认为这样的列表存在，因为你会对*大多数*感兴趣，只有谷歌会知道哪些是最常用的。

然而，Android 手机建立在平台/芯片组之上，这些平台/芯片组将 100 多台设备组合成少数几台设备，因此您应该检查这些设备的功能，而不是单个设备。

一些更具体的信息：

大多数 ARMv7 设备都包括 VFP，而那些不支持 NEON 的唯一平台是[nVidia Tegra2](http://wiki.debian.org/ArmHardFloatPort/VfpComparison#FPU)。

像 G1 这样的 ARMv6 设备不支持 VFP。

作为结束语，我认为这样的清单没有用处。如果旧设备尝试运行新应用程序，它应该会运行得更慢，因为您已经完成了作业并提供了兼容性。

# javascript - 如何访问尚未添加到 DOM 树的 html 字符串中的元素？

> ID：13790250
> 
> 赞同：0
> 
> 时间：2012-12-09T18:17:26.547
> 
> 标签：javascript, jquery, templates, dom, jquery-selectors

我正在加载一个 HTML 模板文件，其中包含我在整个应用程序中使用的模板。该文件如下所示：

```
<!DOCTYPE html><html><head><title>static_listview_templates</title></head><body>
<ul id="tmp_listview_basic" class="ui-listview"></ul>
<ul id="tmp_listview_inset" class="ui-listview ui-listview-inset ui-corner-all ui-shadow"></ul>

<li id="tmp_listview_divider" data-role="list-divider" role="heading" class="ui-li ui-li-divider ui-bar-[theme] ui-corner-top"><span class="ui-divider-text"></span></li>
...
</body></html> 
```

模板通过`requireJS`它把 HTML 代码作为文本字符串返回给我。

我已使用将字符串转换为 jQuery 对象，`var el = $( string )`但我仍然无法访问任何元素（我假设是因为它们尚未在 DOM 中）。

**问题**：
在 jQuery/javascript 中有没有办法

```
el.find('#tmp_listview_divider')   // which gives me an empty object [] 
```

从我的模板对象中选择一个元素？如果是这样，我如何访问和拉出 sub_templates 之一？如果不是，我将如何选择“按 ID”的字符串？我可以添加一个开始和结束标识符，但我不知道如何正则表达式`"from start-to-end"`

谢谢！

**编辑：**
我的 HTML 模板：

```
 <!DOCTYPE html><html><head><title>static_listview_templates</title></head><body><form id="tmp_listview_filter" class="ui-listview-filter ui-bar-[theme] ui-listview-filter-inset" role="search"><div class="ui-input-search ui-shadow-inset ui-btn-corner-all ui-btn-shadow ui-icon-searchfield ui-body-[theme]"><input placeholder="" data-type="search" class="ui-input-text ui-body-[theme]"><a title="" class="ui-input-clear ui-btn ui-btn-up-x ui-shadow ui-btn-corner-all ui-fullsize ui-btn-icon-notext ui-input-clear-hidden" href="#" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="delete" data-iconpos="notext" data-theme="[theme]" data-mini="false">><span class="ui-btn-text"></span><span class="ui-icon ui-icon-delete ui-icon-shadow">&nbsp;</span></span></a></div></form><ul id="tmp_listview_basic" class="ui-listview"></ul><ul id="tmp_listview_inset" class="ui-listview ui-listview-inset ui-corner-all ui-shadow"></ul><li id="tmp_listview_divider" data-role="list-divider" role="heading" class="ui-li ui-li-divider ui-bar-[theme] ui-corner-top"><span class="ui-divider-text"></span></li><li id="tmp_listview_item" data-filtertext="[filtertext]" data-theme="c" class="ui-li ui-btn ui-btn-icon-right ui-li-has-arrow ui-first-child ui-last-child ui-btn-up-[theme]"><div class="ui-btn-inner ui-li"><div class="ui-btn-text"><a href="[link]" class="ui-link-inherit">[link_content]</a></div><span class="ui-icon ui-icon-[link-icon] ui-icon-shadow">&nbsp;</span></div></li></body></html> 
```

在我的应用程序控制器中，我正在这样做：

```
... on pagebeforeshow ...
// pull template and language
require(['text!../tx/static_listview.html','i18n!nls/locale_search'], 

   function ( tmp_listview, lib_search ) {
        // element config JSON
        var dyn = $.parseJSON( page.find(':jqmData(template="true")').jqmData("config") );
        console.log( dyn );

        // template                    
        console.log( tmp_listview )
        var tmp = $( tmp_listview ),
            el = tmp.find('#tmp_listview_divider');

        // always []
        console.log( el )
   }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T00:46:18.370

这可以解决问题：

```
var el = $('<div />').html(string).find('#tmp_listview_divider'); 
```

或者：

```
var el = $(string).filter('#tmp_listview_divider'); 
```

但前者可能更稳定，以防模板返回包装在一个元素或其他东西中。

您必须执行其中一项，因为`.find()`获取匹配元素的后代，因此`$(string)`将返回您的文档片段`[<title>, <ul>, <ul>, <li>...]`，然后`.find()`将搜索 title、ul、ul、li 等的后代，`#tmp_listview_divider`这不是您想要的。您需要`.find()`先将其全部包装在一个元素中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:19:40.140

`el.find()`将 HTML 字符串放入 jQuery 对象后，您可以在文档片段上使用，但您的选择器`'#tmp_listview_divider#'`看起来错误。不应有尾随`#`。

如果您向我们展示相关的 HTML，我们可以帮助您正确选择选择器。

编辑：根据您现在添加到问题中的 HTML，您应该可以使用它：

```
el.find('#tmp_listview_divider') 
```

# java - 从视图侧填充 GWT 中的树组件

> ID：13790255
> 
> 赞同：0
> 
> 时间：2012-12-09T18:17:49.607
> 
> 标签：java, gwt

我正在代码中创建一个像这样的 GWT 树组件：

```
// Create a tree with a few items in it.
    TreeItem root = new TreeItem();
    root.setText("root");
    root.addTextItem("item0");
    root.addTextItem("item1");
    root.addTextItem("item2");

    // Add a CheckBox to the tree
    TreeItem item = new TreeItem(new CheckBox("item3"));
    root.addItem(item);

    Tree t = new Tree();
    t.addItem(root);

    // Add it to the root panel.
    RootPanel.get().add(t); 
```

但我不喜欢这里的 gui 和 value-code 的混合。来自 JSF，我习惯于拥有一个定义树的 xhtml 文件和一个为树提供值的支持类。

如何在 GWT 中实现相同的分离？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:37:09.910

您应该改用 CellTree api。参考示例 - [http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTree](http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTree)

我无法弄清楚你的 GWT 版本。CellTree 自 GWT 2.1 起作为 Cell Widgets 层次结构的一部分可用。

注意 - 您可能希望将它与 GWT 中的数据提供者概念一起使用，以实现更好的 GUI/数据分离。

# node.js - Node.js 中的缓冲区比较

> ID：13790259
> 
> 赞同：23
> 
> 时间：2012-12-09T18:18:20.593
> 
> 标签：node.js

我是 Node.js 的新手。没有缓冲区比较，我应该 为这些功能使用像[buffertools这样的模块。](https://github.com/bnoordhuis/node-buffertools)

但是当我比较纯 Node.js 中的 Buffer 对象时，我看到了一个非常奇怪的行为。

```
> var b1 = new Buffer([170]);
> var b2 = new Buffer([171]);
> b1
<Buffer aa>
> b2
<Buffer ab>
> b1 < b2
false
> b1 > b2
false
> b1 == b2
false 
```

和

```
> var b1 = new Buffer([10]);
> var b2 = new Buffer([14]);
> b1
<Buffer 0a>
> b2
<Buffer 0e>
> b1 > b2
false
> b1 < b2
true
> b1 == b2
false 
```

引擎盖下到底发生了什么？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-24T01:11:43.537

这就是比较运算符在对象上的工作方式：

```
var a = {}, b = {};
a === b; //false
a == b; //false
a > b; //false
a < b; //false

var c = { valueOf : function () { return 0; } };
var d = { valueOf : function () { return 1; } };
c === d; //false
c == d; //false
c > d; //false
c < d; //true 
```

## 在引擎盖下

（有点）

### 第 1 部分：平等

这是最简单的部分。抽象相等 ( `==`, [spec](http://es5.github.com/#x11.9.3) ) 和严格相等 ( `===`, [spec](http://es5.github.com/#x11.9.6) ) 都会检查您是否指的是同一个对象（比较引用的一种）。在这种情况下，他们显然不是，所以他们的回答是`false`（`==`规范步骤 10，`===`规范步骤 7）。

因此，在这两种情况下：

```
b1 == b2 //false
b1 === b2 //false 
```

### 第 2 部分：比较反击

有趣的部分来了。让我们看看关系运算符 (`<`和`>`)[是如何定义的](http://es5.github.com/#x11.8.5)。让我们关注这两种情况下的调用链。

```
x = b1 //<Buffer aa>
y = b2 //<Buffer ab>

//11.8.5 The Abstract Relational Comparison Algorithm (http://es5.github.com/#x11.8.5)
Let px be the result of calling ToPrimitive(x, hint Number).
Let py be the result of calling ToPrimitive(y, hint Number).

//9.1 ToPrimitive (http://es5.github.com/#x9.1)
InputType is Object, therefore we call the internal [[DefaultValue]] method with hint Number.

//8.12.8 [[DefaultValue]] (hint) http://es5.github.com/#x8.12.8
We try and fetch the object's toString method. If it's defined, call it. 
```

到这里我们已经到了高潮：什么是缓冲区的`toString`方法？答案深藏在 node.js 内部。如果你想，[就去吧](https://github.com/joyent/node/blob/51f128d64b250dfeb128aab5117b5bbcd2cc51b5/lib/buffer.js#L389)。我们可以通过实验简单地发现：

```
> b1.toString()
'�'
> b2.toString()
'�' 
```

好吧，那没有帮助。您会注意到，在抽象关系比较算法（多么花哨的名字`<`）中，有一个处理字符串的步骤。它只是将它们转换为它们的数值 - 字符代码。让我们这样做：

```
> b1.toString().charCodeAt(0)
65533
> b2.toString().charCodeAt(0)
65533 
```

65533 是一个重要的数字。它是两个平方的和：`142^2 + 213^2`。它也恰好是 Unicode 替换字符，一个表示“我不知道发生了什么”的字符。这就是为什么它的十六进制等价物是 FFFD。

显然，`65533 === 65533`，所以：

```
b1 < b2 //is
b1.toString().charCodeAt(0) < b2.toString().charCodeAt(0) //is
65533 < 65533 //false
b1 > b2 //following same logic as above, false 
```

就是这样。

### 哥们，什么鬼？

好的，这一定很令人困惑，因为我的解释努力没有经过深思熟虑。回顾一下，这就是发生的事情：

1.  您创建了一个缓冲区。[Benjamin Gruenbaum](https://stackoverflow.com/users/1348195/benjamin-gruenbaum)通过执行以下操作帮助我重新创建了您的测试用例：

    `var b1 = new Buffer([170]), b2 = new Buffer([171]);`

2.  输出到控制台时，这些值将转换为等效的十六进制（请参阅[Buffer#inspect](https://github.com/joyent/node/blob/51f128d64b250dfeb128aab5117b5bbcd2cc51b5/lib/buffer.js#L283)）：

    `170..toString(16) === 'aa'`

    `171..toString(16) === 'ab'`

3.  但是，在内部，它们表示无效字符（因为它不是十六进制编码；同样，您可以自由地深入研究实现细节，我不会（哦，讽刺的是））。因此，当转换为字符串时，它们用 Unicode 替换字符表示。

4.  由于它们是不同的对象，因此任何相等运算符都会返回`false`.

5.  但是，由于小于和大于的工作方式，它们被转换为字符串（然后转换为数字）进行比较。鉴于第 3 点，这是相同的值；因此，它们不能小于或大于彼此，导致`false`.

最后，只是为了让你的脸上露出笑容：

```
b1 <= b2 //true
b1 >= b2 //true 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-04-21T15:46:46.490

已经有一个被接受的答案，但我认为我仍然可以发表评论，因为我没有发现接受的答案特别清楚或有帮助。如果仅仅因为它回答了 OP 没有问的问题，它甚至是不正确的。所以让我们把它归结为：

```
> var b1 = new Buffer([170]);
> var b2 = new Buffer([171]);
> b1 < b2
> b1 > b2
> b1 == b2 
```

所要求的只是：“我如何在缓冲区上执行等价和小于/大于比较（又名（总）排序）”。

答案是：

*   要么通过逐步遍历两个缓冲区的所有字节来手动完成，并在相应的字节之间进行比较，例如`b1[ idx ] === b2[ idx ]`，

*   或使用`Buffer.compare( b1, b2 )`which 为您提供 、 或 中的一个`-1`，`0`具体`+1`取决于第一个缓冲区是在第二个缓冲区之前、完全相同还是之后排序（对`d`包含缓冲区的列表进行排序就像 一样简单`d.sort( Buffer.compare )`）。

观察我`===`在第一个例子中使用的；我在这个网站上关于`==`JavaScript 滥用的频繁评论应该很清楚为什么会这样。

# android - Android - 分组布局和视图

> ID：13790260
> 
> 赞同：1
> 
> 时间：2012-12-09T18:18:35.613
> 
> 标签：android, android-layout, android-ui

我需要一些关于如何最好地在 Android 中实现 UI 的建议。

我想要一个容器列表。每个容器有 7 个项目，如下所示。项目 5-7 是具有两个文本元素的子容器。

我在想一个`LinearLayout`包含`RelativeLayouts`. 这很清楚。至于如何在 中布置元素`RelativeLayout`，我不太确定。

关于如何切片的任何建议？将布局和视图组合在一起的最有效方法是什么？

谢谢！

![在此处输入图像描述](../Images/d75b43c4c69d8c16ecbe6a5129a40219.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:50:04.313

我认为你应该使用 ListView 和一个扩展自定义行的适配器。

对于我个人会使用 1 个父级 RelativeLayout 的行，并且直接将我的所有子级对齐在其中。但如果您更喜欢这些，则可以使用一些 LinearLayouts 来实现。

以这种方式构建它不仅可以使布局变得相当容易，如果您每个人都需要使用不同或更多数据（行）填充它，它还可以让您有机会使列表动态化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:41:36.133

我还没有测试过这段代码，我知道它看起来有点混乱，但我个人认为这是我个人会尝试的，因为我曾经写过一个具有几乎相似布局的自定义 ListView。

```
<RelativeLayout>
<TextView> //position at top
    Lorem ipsum dolor sit amet, consectetur adipisicing...
</TextView>
<TableLayout> //stretchcolumns = 2 && position at bottom
    <TableRow>
        <RelativeLayout>
            <TextView>
                Lorem Ipsum //position at top
            </TextView>
            <ImageView>
                icon    //position to left
            </ImageView>
            <TextView>
                Lorem Ipsum //position to right
            </TextView>
        <RelativeLayout>
    </TableRow>
    <TableRow>
        <TableLayout> //stretchcolumns = 3
            <TableRow> //give all children a weight of 1
                <RelativeLayout>
                    <TextView>
                        1234 //position at top
                    </TextView>
                    <TextView>
                        Lorem Ipsum //position at bottom
                    </TextView>
                </RelativeLayout>
                <RelativeLayout>
                    <TextView>
                        1234 //position at top
                    </TextView>
                    <TextView>
                        Lorem Ipsum //position at bottom
                    </TextView>
                </RelativeLayout>
                <RelativeLayout>
                    <TextView>
                        1234 //position at top
                    </TextView>
                    <TextView>
                        Lorem Ipsum //position at bottom
                    </TextView>
                </RelativeLayout>
            </TableRow>
        </TableLayout>
    </TableRow>
</TableLayout></RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:42:03.683

您可能会考虑[GridLayout](http://developer.android.com/reference/android/widget/GridLayout.html)，这里介绍了它的概述：[http ://android-developers.blogspot.com/2011/11/new-layout-widgets-space-and-gridlayout.html](http://android-developers.blogspot.com/2011/11/new-layout-widgets-space-and-gridlayout.html)

它是在 API 级别 14 (Android 4.0) 中引入的，但作为 Android 支持库的一部分，可以使用向下兼容到 API 级别 7 的向后移植。

# ruby-on-rails - ruby-on-rails 检查查询结果是否为空（Model.find）

> ID：13790263
> 
> 赞同：9
> 
> 时间：2012-12-09T18:18:48.223
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, activerecord

我正在使用 ruby​​ on rails 并尝试检查查询是否返回值。

这是查询：

```
@search = Customer.find_by_name($login_name) 
```

如果查询找到结果，一切都很好，但是我如何对空结果做出反应？

我试过：

```
if @search.empty?
  flash[:notice] = 'Username nicht bekannt'
  redirect_to :action => :login
end 
```

但我得到一个错误：

```
undefined method `empty?' for nil:NilClass 
```

任何想法出了什么问题？

谢谢！！！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-09T18:21:46.563

使用它来检查 nil 和空案例：

```
@search.blank? 
```

对于相反的情况（非零且非空），使用[.present?](http://api.rubyonrails.org/classes/Object.html#method-i-present-3F) ：

```
@search.present? #equivalent of !@search.blank? 
```

您的查询返回`nil` 而不是的原因`empty`是：

```
Customer.find_by_name($login_name) 
```

总是返回一个对象的结果，`Customer`或者`nil`如果没有这样的结果，

而像：

```
Customer.where(:name=>$login_name) 
```

将始终返回您`ActiveRecord::Relation`（可以有 0-n 个结果）。和`empty?` 方法将适用于它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-12T16:35:28.907

如果没有找到结果，则`find_by_name`返回一个 nil 对象，而不是一个空数组。要检查是否找到了客户，您可以使用`if @search.nil?`or 简单地`if !@search`or `unless @search`，因为 nil 在 ruby​​ 中是虚假的。

```
@search = Customer.find_by_name($login_name)
unless @search
  flash[:notice] = 'Username nicht bekannt'
  redirect_to :action => :login
end 
```

# objective-c - UIStoryboard+UITabBarController+单独的故事板

> ID：13790268
> 
> 赞同：1
> 
> 时间：2012-12-09T18:19:22.107
> 
> 标签：objective-c, ios, uitabbarcontroller, uistoryboard

有一个`UIStoryboard`带有 a的 main`UITabBarController`有 5 个项目，每个项目都足够大，可以由它自己的故事板实例来表示。我想将所有 5 个分成不同的故事板。换句话说，当`TabBarItem1`被选中时，我想`UIViewController`从不同的情节提要加载其各自的，是否有可能实现这一点？我正在考虑为此以`UITabBarController`编程方式创建，这会是最优雅的解决方案吗？

编辑 -

```
 NSMutableArray *viewControllers = [NSMutableArray array];

  MyViewController1 *myController1 = [[StoryboardManager myStoryboard1] instantiateInitialViewController];
  myController1.title = @"Title";
  [viewControllers addObject:myController1];

  MyViewController2 *myController2 = [[StoryboardManager myStoryboard2] instantiateInitialViewController];
  myController2.title = @"Title";
  [viewControllers addObject:myController2];
  // ...etc
  self.viewControllers = viewControllers; // self - subclass of a UITabBarController 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T21:11:18.800

您应该能够在代码中执行此操作，方法是获取其他故事板的实例，实例化它们的初始视图控制器，最后将它们添加到选项卡栏控制器 viewControllers 数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-23T08:45:18.400

如果您使用 iOS9，可以在 UITabbarController 的一个选项卡中选择所有视图控制器，选择 Editor -> Refactor to Storyboard in XCode，然后创建一个新的 Storyboard。XCode 将自动完成其他所有操作。不幸的是，它仅适用于 iOS 9。

# c - 使用 sprintf 和 char *

> ID：13790269
> 
> 赞同：1
> 
> 时间：2012-12-09T18:19:28.203
> 
> 标签：c, serialization, ansi, printf

我试图使用它，但是当我使用 valgrind 运行它时，我遇到了一些内存问题。

例如

```
char *serialize_file(t_file_package *pack) {

     char *payLoad = malloc(numDigits(pack->file_desc)+numDigits(pack->priority)+strlen(pack->code)+2);
     sprintf(payLoad, "%d#%d#%s", (uint32_t)pack->file_desc,(int16_t)pack->priority, pack->code);
     char *pack = malloc(numDigits(PROCESS) + numDigits((int64_t)strlen(payLoad)) + strlen(payLoad)+2);

     sprintf(pack, "%d#%d#%s",PROCESS, strlen(payLoad), payLoad);
     free(payLoad);
     return pack;
} 
```

我知道 asprintf 的存在，但我不知道为什么我不能在我的 GNU ANSI C 项目中使用它...我的 Eclipse 说该函数无法识别

提前谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:24:06.963

您忘记了尾随空字符`'\0'`。在调用的参数中再添加一个字节`malloc()`（替换`+2`为`+3`），一切都应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:24:36.620

您不允许字符串末尾的空字符有空格 - 字符串需要空格用于“file_desc”中的数字、“priority”中的数字、“code”中的字符、两个“#”字符**和**终端空字符。

第二次调用 malloc 也存在同样的问题

# android - 如何在android中的图像上添加多个图层

> ID：13790270
> 
> 赞同：1
> 
> 时间：2012-12-09T18:19:28.173
> 
> 标签：android, android-imageview

我希望在应用程序中有一个（地图的）图像，并以编程方式在其上添加一些图层（占位符、路径等......）我认为类似 Photoshop 的图层方法可能会有所帮助，但我不知道从哪里开始。任何指向教程或文档的简单示例/链接都是有用的:)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:48:02.437

我给你一个简单的方法，你可以建立在：

*   创建一个空的位图`finalBitmap`。这将是所有图层组合的最终目的地。
*   创建一个`Canvas`以绘制到`finalBitmap`. 此画布将用于将所有图层绘制到最终位图中。
*   `Bitmap`使用您的地图图像创建一个。将其绘制到`finalBitmap`使用画布。这将是第 1 层。
*   使用相同的方法放置标记、路线等。那些将是第 2 层、第 3 层等。

示例代码：

```
//The empty Bitmap
finalBitmap = Bitmap.createBitmap(width, height , Bitmap.Config.ARGB_8888);
canvas = new Canvas(finalBitmap );
imageView.setImageBitmap(finalBitmap );

//Create the map image bitmap
Config config = Config.RGB_565;
Options options = new Options();
options.inPreferredConfig = config;
InputStream in = null;
Bitmap bitmap = null;
try {
        in = new FileInputStream(fMapImage);
        bitmap = BitmapFactory.decodeStream(in);
        if (bitmap == null)
            throw new RuntimeException("Couldn't load bitmap from asset :" + fMapImage.getAbsolutePath());
    } catch (IOException e) {
        throw new RuntimeException("Couldn't load bitmap from asset :" + fMapImage.getAbsolutePath());
    } finally {
        if (in != null) {
            try {
                in.close();
            } catch (IOException e) {
            }
        }
}

//Draw the map image bitmap
Rect dst = new Rect(pt00.x, pt00.y, ptMM.x, ptMM.y);
canvas.drawBitmap(bitmap, null, dst, null);

//Here draw whatever else you want (markers, routes, etc.) 
```

问候

# linux - 安装 WWW::HtmlUnit 时“找不到类 com.gargoylesoftware.htmlunit.WebClient”

> ID：13790273
> 
> 赞同：0
> 
> 时间：2012-12-09T18:19:35.663
> 
> 标签：linux, perl, ubuntu, htmlunit, cpan

我正在尝试`WWW::HtmlUnit`在 Ubuntu 12.04 64 位中安装 perl。我正在按照[CPAN 页面](http://p3rl.org/WWW%3a%3aHtmlUnit)的指示进行操作。

但是我收到一条错误消息，指出

```
Class com.gargoylesoftware.htmlunit.WebClient not found at /usr/local/lib/perl/5.14.2/Inline/Java.pm line 619. 
```

我已经在下面粘贴了我的整个日志。我已经看到了对这个问题的其他一些回复，但它们是针对 Windows 而不是 Linux 的。

```
cpanm (App::cpanminus) 1.5018 on perl 5.014002 built for x86_64-linux-gnu-thread-multi
Work directory is /home/user/.cpanm/work/1355076552.11533
You have make /usr/bin/make
You have LWP 6.03
You have /bin/tar: tar (GNU tar) 1.26
Copyright (C) 2011 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by John Gilmore and Jay Fenlason.
You have /usr/bin/unzip
Searching WWW::HtmlUnit on cpanmetadb ...
--> Working on WWW::HtmlUnit
Fetching http://www.cpan.org/authors/id/A/AW/AWWAIID/WWW-HtmlUnit-0.18.tar.gz
-> OK
Unpacking WWW-HtmlUnit-0.18.tar.gz
Entering WWW-HtmlUnit-0.18
Checking configure dependencies from META.yml
Checking if you have ExtUtils::MakeMaker 0 ... Yes (6.57_05)
Configuring WWW-HtmlUnit-0.18
Running Makefile.PL
Checking if your kit is complete...
Warning: the following files are missing in your kit:
    lib/WWW/HtmlUnit/jar/commons-codec-1.4.jar
    lib/WWW/HtmlUnit/jar/commons-io-2.0.1.jar
    lib/WWW/HtmlUnit/jar/commons-lang-2.6.jar
    lib/WWW/HtmlUnit/jar/cssparser-0.9.5.jar
    lib/WWW/HtmlUnit/jar/htmlunit-2.9.jar
    lib/WWW/HtmlUnit/jar/htmlunit-core-js-2.9.jar
    lib/WWW/HtmlUnit/jar/httpclient-4.1.2.jar
    lib/WWW/HtmlUnit/jar/httpcore-4.1.2.jar
    lib/WWW/HtmlUnit/jar/httpmime-4.1.2.jar
    lib/WWW/HtmlUnit/jar/nekohtml-1.9.15.jar
Please inform the author.
Writing Makefile for WWW::HtmlUnit
Writing MYMETA.yml
-> OK
Checking dependencies from MYMETA.yml ...
Checking if you have ExtUtils::MakeMaker 0 ... Yes (6.57_05)
Checking if you have Inline::Java 0.53 ... Yes (0.53)
Building and testing WWW-HtmlUnit-0.18
cp lib/WWW/HtmlUnit.pm blib/lib/WWW/HtmlUnit.pm
cp lib/WWW/HtmlUnit/jar/xml-apis-1.3.04.jar blib/lib/WWW/HtmlUnit/jar/xml-apis-1.3.04.jar
cp lib/WWW/HtmlUnit/jar/commons-collections-3.2.1.jar blib/lib/WWW/HtmlUnit/jar/commons-collections-3.2.1.jar
cp lib/WWW/HtmlUnit/jar/xalan-2.7.1.jar blib/lib/WWW/HtmlUnit/jar/xalan-2.7.1.jar
cp lib/WWW/HtmlUnit/jar/serializer-2.7.1.jar blib/lib/WWW/HtmlUnit/jar/serializer-2.7.1.jar
cp lib/WWW/HtmlUnit/jar/commons-logging-1.1.1.jar blib/lib/WWW/HtmlUnit/jar/commons-logging-1.1.1.jar
cp lib/WWW/HtmlUnit/jar/htmlunit-confirmhandler-2.8.jar blib/lib/WWW/HtmlUnit/jar/htmlunit-confirmhandler-2.8.jar
cp lib/WWW/HtmlUnit/jar/xercesImpl-2.9.1.jar blib/lib/WWW/HtmlUnit/jar/xercesImpl-2.9.1.jar
cp lib/WWW/HtmlUnit/Sweet.pm blib/lib/WWW/HtmlUnit/Sweet.pm
cp lib/WWW/HtmlUnit/jar/sac-1.3.jar blib/lib/WWW/HtmlUnit/jar/sac-1.3.jar
Manifying blib/man3/WWW::HtmlUnit.3pm
Manifying blib/man3/WWW::HtmlUnit::Sweet.3pm
PERL_DL_NONLAZY=1 /usr/bin/perl "-MExtUtils::Command::MM" "-e" "test_harness(0, 'blib/lib', 'blib/arch')" t/*.t

#   Failed test 'use WWW::HtmlUnit;'
#   at t/00_basic.t line 9.
#     Tried to use 'WWW::HtmlUnit'.
#     Error:  Class com.gargoylesoftware.htmlunit.WebClient not found at /usr/local/lib/perl/5.14.2/Inline/Java.pm line 619.
# BEGIN failed--compilation aborted at (eval 4) line 2, <GEN7> line 4.
# Looks like you failed 1 test of 1.
t/00_basic.t ......... 
Dubious, test returned 1 (wstat 256, 0x100)
Failed 1/1 subtests 
Class com.gargoylesoftware.htmlunit.WebClient not found at /usr/local/lib/perl/5.14.2/Inline/Java.pm line 619.
BEGIN failed--compilation aborted at t/01_hello.t line 4, <GEN7> line 4.
t/01_hello.t ......... 
Dubious, test returned 2 (wstat 512, 0x200)
No subtests run 
t/02_hello_sweet.t ... 
Dubious, test returned 2 (wstat 512, 0x200)
No subtests run 
Class com.gargoylesoftware.htmlunit.WebClient not found at /usr/local/lib/perl/5.14.2/Inline/Java.pm line 619.
BEGIN failed--compilation aborted at t/03_clickhandler.t line 6, <GEN7> line 4.
# Looks like your test exited with 2 before it could output anything.
t/03_clickhandler.t .. 
Dubious, test returned 2 (wstat 512, 0x200)
Failed 8/8 subtests 

Test Summary Report
-------------------
t/00_basic.t       (Wstat: 256 Tests: 1 Failed: 1)
  Failed test:  1
  Non-zero exit status: 1
t/01_hello.t       (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: No plan found in TAP output
t/02_hello_sweet.t (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: No plan found in TAP output
t/03_clickhandler.t (Wstat: 512 Tests: 0 Failed: 0)
  Non-zero exit status: 2
  Parse errors: Bad plan.  You planned 8 tests but ran 0.
Files=4, Tests=1,  1 wallclock secs ( 0.04 usr  0.01 sys +  0.58 cusr  0.10 csys =  0.73 CPU)
Result: FAIL
Failed 4/4 test programs. 1/1 subtests failed.
make: *** [test_dynamic] Error 2
-> FAIL Installing WWW::HtmlUnit failed. See /home/user/.cpanm/build.log for details. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T23:23:24.003

然而，将另一个答案留给后代，问题是作者破坏了最新版本。如您的消息中所见，他忘记包含几个关键文件。

```
Warning: the following files are missing in your kit:
    lib/WWW/HtmlUnit/jar/commons-codec-1.4.jar
    lib/WWW/HtmlUnit/jar/commons-io-2.0.1.jar
    lib/WWW/HtmlUnit/jar/commons-lang-2.6.jar
    lib/WWW/HtmlUnit/jar/cssparser-0.9.5.jar
    lib/WWW/HtmlUnit/jar/htmlunit-2.9.jar
    lib/WWW/HtmlUnit/jar/htmlunit-core-js-2.9.jar
    lib/WWW/HtmlUnit/jar/httpclient-4.1.2.jar
    lib/WWW/HtmlUnit/jar/httpcore-4.1.2.jar
    lib/WWW/HtmlUnit/jar/httpmime-4.1.2.jar
    lib/WWW/HtmlUnit/jar/nekohtml-1.9.15.jar 
```

这值得一张错误票（实际上是两张，我在类路径代码中发现了一个错误）。

同时，您可以尝试安装旧版本：

```
cpanm http://cpan.metacpan.org/authors/id/A/AW/AWWAIID/WWW-HtmlUnit-0.16.tar.gz 
```

（根据需要使用`sudo`和`JAVA_HOME`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T20:23:45.610

您是否按照[安装说明](http://search.cpan.org/~awwaiid/WWW-HtmlUnit/lib/WWW/HtmlUnit.pm#INSTALLING)进行操作？看起来[Inline::Java](http://p3rl.org/Inline%3a%3aJava)找不到您的 java 库。

您可能需要检查您是否将`JAVA_HOME`路径设置为正确。我相信你可以通过运行类似的东西来得到这个：

```
update-alternatives --query java | perl -ne 'print if s/Value: //' 
```

对我来说，这给出了：

```
/usr/lib/jvm/java-6-sun/jre/bin/java 
```

但你不想要 bin 部分，所以我会使用

```
JAVA_HOME=/usr/lib/jvm/java-6-sun 
```

编辑：也不`/jre`想要

# c++ - C++ 优先级队列中的运算符重载或比较函数

> ID：13790276
> 
> 赞同：13
> 
> 时间：2012-12-09T18:19:46.473
> 
> 标签：c++, stl, performance

我正在用 C++ 编写一个程序，我想定义我的一个班级的优先级队列。我需要它通过类成员变量之一来比较对象。我使用了 operator< 重载，但我知道还有第二种方法可以实现这一目标 - 使用队列定义定义的特殊函数。哪种方式更好、更美观、更高效？以及如何编写这样的函数？

我已经这样做了：

```
#include <iostream>
#include <queue>
using namespace std;

class Human {

    public:
        string name;
        int age;
        Human(string name, int age);
};

Human::Human(string name, int age) : name(name), age(age) {}

bool operator<(Human a, Human b) {return a.age < b.age ? true : false;}

int main() {

    Human p1("Child",5);
    Human p2("Grandfather",70);
    Human p3("Older son",20);
    Human p4("Father",40);
    Human p5("Younger son",10); 

    priority_queue<Human> Q;

    Q.push(p1);
    Q.push(p2);
    Q.push(p3);
    Q.push(p4);
    Q.push(p5);

    while(!Q.empty()) {

        cout << "Name: " << Q.top().name << ", age: " << Q.top().age << endl;
        Q.pop();
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T18:28:39.403

## 风格

如果您的类型具有内在的“自然”顺序，则使用内置运算符表示它是合理的。

如果排序因您使用类型的方式而异（例如，您有一个按年龄排序的 Human 集合，一个按身高排序，一个按 IQ 排序），那么说排序是容器的属性而不是方式。

* * *

## 执行

你可以编写一个自由函数，或者如果你需要状态，可以使用一个仿函数。

请注意，这些都与内置运算符一样适合内联，因此在速度上没有固有的差异（编译器可能更难证明函数指针是可内联的，因此通常首选仿函数）*。*

```
struct OrderByAge
{
    bool operator() (Human const &a, Human const &b) { return a.age < b.age; }
};
typedef std::priority_queue<Human, std::vector<Human>, OrderByAge> age_queue; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:25:43.520

运算符的重载是最好的方法，因为只执行比较指令，没有什么比这更好的了，所以你的解决方案是最优的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-29T19:32:47.357

```
#include <iostream>
#include <queue>
#include <iomanip>
#include <cstdlib>
using namespace std;

struct DatenWert {
    int ordnungsnummer;
};

class DaternWert_Compare {
public:
    bool operator()(DatenWert& t1, DatenWert& t2)
    {
       if (t1.ordnungsnummer < t2.ordnungsnummer) return true;
       return false;
    }
};

int main(int argc, char** argv) {

    priority_queue<DatenWert, vector<DatenWert>, DaternWert_Compare> pq;

    DatenWert wert2 = {2};
    DatenWert wert1 = {1};
    DatenWert wert3 = {3};

    pq.push(wert1);
    pq.push(wert2);
    pq.push(wert3);

    while (! pq.empty()) {
       DatenWert t2 = pq.top();
       cout << setw(3) << t2.ordnungsnummer << " " << setw(3) << endl;
       pq.pop();
    }

    return 0;
} 
```

结果：

3 2 1

# android - 尝试从联系人获取电话号码时，onActivityResult 的 resultCode 始终为 0

> ID：13790285
> 
> 赞同：0
> 
> 时间：2012-12-09T18:21:16.737
> 
> 标签：android, contacts

我在 stackoverflow 和 google 上看到了很多类似的问题和答案，但没有运气。尝试从联系人获取电话号码时，onActivityResult 的 resultCode 始终为 0。这是代码，请帮助我，我将非常感谢你。`

```
package april19ideas.call.blocker;
import java.util.ArrayList; 
import java.util.Collections;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.ListActivity;
import android.content.ContentResolver;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.pm.PackageManager;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.preference.PreferenceManager;
import android.provider.ContactsContract;
import android.provider.ContactsContract.PhoneLookup;
import android.text.InputType;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.EditText;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

public class DNDCallBlockerBlackListActivity extends ListActivity {

private static final String TAG = "DNDCallBlockerBlackListActivity";
private static final int PICK_CONTACT = 3;
private static final int PICK_LOG = 4;
private static final String BLACKLIST_PREF = "blacklist";

private ArrayList<String> m_phones;
private ArrayList<String> m_contacts;
private LayoutInflater m_Inflater;
private ArrayAdapter<String> m_adapter;
private SharedPreferences settings;
private int checkedItem;
private Context myContext;

/**
 * Called when the activity is first created. Responsible for initializing
 * the UI.
 */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    myContext = this;
    settings = PreferenceManager.getDefaultSharedPreferences(myContext);

    PackageManager manager = getPackageManager();
    if (manager.checkSignatures("april19ideas.call.blocker",
            "april19ideas.call.blocker.key") == PackageManager.SIGNATURE_MATCH) {
        setContentView(R.layout.noad_blacklist);
    } else {
        setContentView(R.layout.blacklist);
    }

    m_Inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    m_phones = new ArrayList<String>();
    m_contacts = new ArrayList<String>();

    String tmp_phones = settings.getString(BLACKLIST_PREF, "");
    if (tmp_phones != "") {
        String[] tmp_phonesArr = tmp_phones.split(", ");
        Collections.addAll(m_phones, tmp_phonesArr);

        for (String s : m_phones) {
            // search contact for every saved phone number
            ContentResolver cr = getContentResolver();
            Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI,
                    Uri.encode(s));
            Cursor cur = cr.query(uri,
                    new String[] { PhoneLookup.DISPLAY_NAME }, null, null,
                    null);
            if (cur.moveToFirst()) {
                String name = cur.getString(cur
                        .getColumnIndex(PhoneLookup.DISPLAY_NAME));
                m_contacts.add(name);
            } else {
                m_contacts.add("N/A");
            }
            cur.close();
        }
    } else {
        // do nothing, list is empty
    }

    // this adapter makes the black list visible to user
    m_adapter = new ArrayAdapter<String>(this,
            R.layout.blacklist_list_item, m_phones) {
        @Override
        public View getView(int position, View reusableView,
                ViewGroup parent) {
            View row;

            if (reusableView == null) {
                row = m_Inflater
                        .inflate(R.layout.blacklist_list_item, null);
            } else {
                row = reusableView;
            }

            TextView tv1 = (TextView) row.findViewById(android.R.id.text1);
            tv1.setText(getItem(position));

            TextView tv2 = (TextView) row.findViewById(android.R.id.text2);
            tv2.setText(m_contacts.get(position));

            return row;
        }
    };
    setListAdapter(m_adapter);

    ListView lv = getListView();
    lv.setTextFilterEnabled(true);

    // to handle taps on list items
    lv.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                final int position, long id) {
            // construct an alert dialog
            AlertDialog.Builder alert = new AlertDialog.Builder(myContext);

            // set icon, title and message
            alert.setIcon(R.drawable.icon);
            alert.setTitle(R.string.app_name);
            alert.setMessage(m_phones.get(position) + " - "
                    + m_contacts.get(position));

            // configure two buttons
            alert.setPositiveButton(R.string.message_remove,
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog,
                                int whichButton) {
                            // when OK pressed, go to paypal donations
                            // web page
                            // remove item from list
                            m_phones.remove(position);
                            m_contacts.remove(position);
                            String tmp_phones = "";
                            if (m_phones.size() > 0) {
                                tmp_phones = m_phones.toString();
                                tmp_phones = tmp_phones.substring(1,
                                        tmp_phones.length() - 1);
                            }
                            // save updated list to sharedpreferences
                            SharedPreferences.Editor editor = settings
                                    .edit();
                            editor.putString(BLACKLIST_PREF, tmp_phones);
                            editor.commit();
                            // refresh ui
                            m_adapter.notifyDataSetChanged();
                            // inform user
                            String toast_text = getString(R.string.phone_removed);
                            Toast.makeText(getApplicationContext(),
                                    toast_text, Toast.LENGTH_SHORT).show();
                        }
                    });

            alert.setNegativeButton(R.string.message_keep,
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog,
                                int whichButton) {
                            // Canceled. Do nothing.
                        }
                    });

            // show the dialog window
            alert.show();
        }
    });

}

public void pickFromContacts(View target) {
    // start contact list activity to pick one phone number
    Intent intent = new Intent(Intent.ACTION_PICK,
            ContactsContract.Contacts.CONTENT_URI);
    intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
    startActivityForResult(intent, PICK_CONTACT);
}

public void pickFromCallLog(View target) {
    // start callog list activity to pick one phone number
    Intent intent = new Intent(DNDCallBlockerBlackListActivity.this,
            DNDCallBlockerCallogListActivity.class);
    startActivityForResult(intent, PICK_LOG);
}

@Override
protected void onActivityResult(int reqCode, int resultCode, Intent data) {
    //resultCode = -1;
    Log.e("resultCode", reqCode+ ":" + resultCode);

    super.onActivityResult(reqCode, resultCode, data);

    Log.e("reqCode",""+reqCode);

    switch (reqCode) {

    case (PICK_CONTACT):
        Log.e("PICK_CONTACT", "PICK_CONTACT" + resultCode);
        if (resultCode == Activity.RESULT_OK) {
            Log.e("PICK_CONTACT1", "PICK_CONTACT1");
            Uri contactData = data.getData();
            // somehow could be possible that data.getData is null :(
            if (contactData != null) {
                Cursor c = managedQuery(contactData, null, null, null, null);
                // get selected phone number & contact name
                if (c.moveToFirst()) {
                    try {
                        m_phones.add(c
                                .getString(
                                        c.getColumnIndexOrThrow(ContactsContract.CommonDataKinds.Phone.NUMBER))
                                .trim());
                        m_contacts
                                .add(c.getString(
                                        c.getColumnIndexOrThrow(ContactsContract.Contacts.DISPLAY_NAME))
                                        .trim());
                        // add new item to list
                        String tmp_phones = m_phones.toString();
                        tmp_phones = tmp_phones.substring(1,
                                tmp_phones.length() - 1);
                        // save to sharedpreferences
                        SharedPreferences.Editor editor = settings.edit();
                        editor.putString(BLACKLIST_PREF, tmp_phones);
                        editor.commit();
                        // refresh ui
                        m_adapter.notifyDataSetChanged();
                        // inform user
                        String toast_text = getString(R.string.phone_added);
                        Toast.makeText(getApplicationContext(), toast_text,
                                Toast.LENGTH_SHORT).show();
                    } catch (IllegalArgumentException e) {
                        Log.e(TAG, e.getMessage());
                    }
                }
                c.close();
            }
        }
        else {  
            // gracefully handle failure  
            Log.w("DEBUG_TAG", "Warning: activity result not ok");  
        } 
        break;
    case (PICK_LOG):
        Log.e("PICK_LOG", "PICK_LOG");
        if (resultCode == Activity.RESULT_OK) {
            Log.e("PICK_LOG1", "PICK_LOG1");
            String numtoadd = data.getAction();
            m_phones.add(numtoadd);
            // search contact for every saved phone number
            ContentResolver cr = getContentResolver();
            Uri uri = Uri.withAppendedPath(PhoneLookup.CONTENT_FILTER_URI,
                    Uri.encode(numtoadd));
            Cursor cur = cr.query(uri,
                    new String[] { PhoneLookup.DISPLAY_NAME }, null, null,
                    null);
            if (cur.moveToFirst()) {
                String name = cur.getString(cur
                        .getColumnIndex(PhoneLookup.DISPLAY_NAME));
                m_contacts.add(name);
            } else {
                m_contacts.add("N/A");
            }
            cur.close();
            // add new item to list
            String tmp_phones = m_phones.toString();
            tmp_phones = tmp_phones.substring(1, tmp_phones.length() - 1);
            // save to sharedpreferences
            SharedPreferences.Editor editor = settings.edit();
            editor.putString(BLACKLIST_PREF, tmp_phones);
            editor.commit();
            // refresh ui
            m_adapter.notifyDataSetChanged();
            // inform user
            String toast_text = getString(R.string.phone_added);
            Toast.makeText(getApplicationContext(), toast_text,
                    Toast.LENGTH_SHORT).show();
        }
        else {  
            // gracefully handle failure  
            Log.w("DEBUG_TAG", "Warning: activity result not ok");  
        }
        break;
    }
}

public void addPhoneNumber(View target) {
    final AlertDialog.Builder alert = new AlertDialog.Builder(this);
    final EditText input = new EditText(this);

    checkedItem = 0;

    input.setInputType(InputType.TYPE_CLASS_PHONE);

    input.setHint(R.string.hint_typehere);

    alert.setSingleChoiceItems(R.array.manual_phonenumber_types, 0,
            new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int item) {
                    checkedItem = item;
                }
            });

    alert.setView(input);
    alert.setIcon(R.drawable.icon);
    alert.setTitle(R.string.title_add_number);

    alert.setPositiveButton(R.string.message_ok,
            new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int whichButton) {
                    String value = input.getText().toString().trim();
                    if (!value.equals("")) {
                        switch (checkedItem) {
                        case 1:
                            value = value.trim() + "*";
                            break;
                        case 2:
                            value = "*" + value.trim() + "*";
                            break;
                        case 3:
                            value = "*" + value.trim();
                            break;

                        default:
                            break;
                        }
                        // put input to list
                        m_phones.add(value);
                        m_contacts.add("N/A");

                        // add new item to list
                        String tmp_phones = m_phones.toString();
                        tmp_phones = tmp_phones.substring(1,
                                tmp_phones.length() - 1);
                        // save to sharedpreferences
                        SharedPreferences.Editor editor = settings.edit();
                        editor.putString(BLACKLIST_PREF, tmp_phones);
                        editor.commit();
                        // refresh ui
                        m_adapter.notifyDataSetChanged();
                        // inform user
                        String toast_text = getString(R.string.phone_added);
                        Toast.makeText(getApplicationContext(), toast_text,
                                Toast.LENGTH_SHORT).show();
                    }
                }
            });
    alert.setNegativeButton(R.string.message_cancel,
            new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int whichButton) {
                    dialog.cancel();
                }
            });
    alert.show();
}

} 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:36:13.300

更改您`pickFromContacts`从联系人获取电话号码的方式：

```
public void pickFromContacts(View target) {
    // start contact list activity to pick one phone number
    Intent intent = new Intent(Intent.ACTION_PICK,
            ContactsContract.Contacts.CONTENT_URI);
    startActivityForResult(intent, PICK_CONTACT);
} 
```

如果您想通过将 setType 设置为`Phone.CONTENT_TYPE`with Intent 来选择联系人，则将您的更改`pickFromContacts`为：

```
public void pickFromContacts(View target) {
    // start contact list activity to pick one phone number
    Intent intent = new Intent(android.content.Intent.ACTION_PICK);
    intent.setType(ContactsContract.CommonDataKinds.Phone.CONTENT_TYPE);
    startActivityForResult(intent, PICK_CONTACT);
} 
```

# android - LGE Optimus L5 是 ARMv7a 设备吗？

> ID：13790287
> 
> 赞同：0
> 
> 时间：2012-12-09T18:21:20.447
> 
> 标签：android, arm

是`LGE Optimus L5`设备`ARMv7a`吗？

我用原生代码制作了 FAT `armeabi`APK `armeabi-v7a`。

`LGE Optimus L5`运行`armeabi`lib，我希望它运行`armeabi-v7a`lib。

更新：我确信 L5 有 ARMv7 CPU。（它甚至有 NEON 和 VFPv4） Android 系统信息也告诉我从 wiki 知道的内容。但它在我编译的应用程序中运行 armeabi lib 而不是 armeabi-v7a lib。

有什么问题？我是否可以错过在某处添加一些参数（AndroidManifest.xml ???）或 L5 具有运行 armeabi 库而不是 armeabi-v7a 库的操作系统设置？

更新：

如果我编译 FAT 并删除`armeabi`文件夹或仅编译，`armeabi-v7a`则 LGE L5 运行 ARMv7 代码，如果我同时拥有 ARMv5 和 ARMv7，则 LGE L5 运行 ARMv5 代码。

为什么？它应该为该 CPU 运行最优化的代码！我想知道如何强制使用 ARMv7 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T12:12:40.040

这是由于Android ICS中的错误而发生的

*   [http://www.moodstocks.com/2012/03/20/ice-cream-sandwich-why-native-code-support-sucks/](http://www.moodstocks.com/2012/03/20/ice-cream-sandwich-why-native-code-support-sucks/)
*   [https://groups.google.com/forum/#!msg/android-ndk/N8FLjvM81pg/2rYeClQZcckJ](https://groups.google.com/forum/#!msg/android-ndk/N8FLjvM81pg/2rYeClQZcckJ)

# multithreading - 来自 NPAPI 插件的浏览器主线程

> ID：13790292
> 
> 赞同：1
> 
> 时间：2012-12-09T18:21:52.630
> 
> 标签：multithreading, plugins, browser, model, npapi

我正在开发一个 NPAPI 插件，我需要从浏览器的主线程运行一些代码。

NPAPI 插件的线程模型是什么？NPAPI 执行的默认线程是什么？如何从浏览器的主线程运行我的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T05:26:02.993

正如 smorgan 所说，浏览器的线程模型是对浏览器的任何调用都必须发生在主线程上。对此有一两个奇怪的例外，但支持有些不一致。

[引入NPN_PluginThreadAsyncCall](https://developer.mozilla.org/en-US/docs/NPN_PluginThreadAsyncCall)正是为了解决这个问题；它接受一个函数指针和一个 void* 用于将数据传递给它，并将在主线程上调用该函数。当然，这里发生了一些棘手的事情，因为由于固有的竞争条件，如果您在插件关闭期间 调用[NPN_PluginThreadAsyncCall ，您不能保证您的函数会被调用。](https://developer.mozilla.org/en-US/docs/NPN_PluginThreadAsyncCall)[FireBreath](http://firebreath.org)做了一些相当奇特的巫术来解决这个问题并防止内存泄漏。

当您开始尝试支持除 FireFox 之外的其他浏览器时，事情会变得更加复杂。AFAIK FireFox 在所有版本中都支持此 API 调用，但至少某些版本的 Safari（尤其是 64 位）不支持 NPN_PluginThreadAsyncCall；最有趣的是，它们有时似乎支持它，但最终会得到一个错误的函数指针，当您尝试使用它时会崩溃。这可能已在最近的版本中修复，我不知道，因为我们很久以前就更改为在 Mac 上使用 NSTimer 以避免无法正确检测是否支持的问题。此外，众所周知，Windows 上的 Opera 不支持它。FireBreath 使用消息 HWND 并执行 PostMessage 在不支持它的 Windows 浏览器上的主线程上进行调用。

我不知道linux上是否存在类似问题；您没有指定您关注的平台。我还没有听说过关于 linux 的任何问题，但这可能意味着也可能没有任何意义。

关于该主题的其他值得一读的问题： [Generating async Javascript events from browser plugin (NPAPI)](https://stackoverflow.com/questions/1931883) [How to callback plugin thread on Safari 5.1 on OSX？](https://stackoverflow.com/questions/7924653)

祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T20:45:30.167

线程模型是浏览器会在主线程调用你的插件，你必须`NPN_*`从主线程调用方法。

# linux - 通过启动器从 bash 脚本调用时保持“vlc -I dummy”运行

> ID：13790300
> 
> 赞同：0
> 
> 时间：2012-12-09T18:23:20.160
> 
> 标签：linux, bash, signals, vlc, launcher

假设我有以下 bash 脚本：

```
#!/usr/bin/env bash

addrss="mms://enleuko.live24.gr/enleuko877"
echo -n "addr: "
read uaddr
[[ -n $uaddr ]] && addrss=$uaddr
vlc -I dymmy --quiet $addrss &
exit 0 
```

以上在 ttys 和 xterminal上运行，即使我注销或关闭窗口也会**继续运行。**如果我尝试通过如下所示的启动器调用它，它会`vlc`在我的脚本退出时终止。

```
[Desctop Entry]
Name=enleuko
Icon=icon
Exec=radio
Type=Application
Terminal=true
Categories=Network; 
```

*请注意，我的脚本有一个`read`声明，所以我需要这个`Terminal=true`值。

我已经尽可能多地阅读了关于`trap`,的内容`disown`，`nohup`并且尝试了多种组合，但没有任何帮助。我提前感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T19:12:32.400

怎么用`nohup`？

```
 nohup vlc -I dymmy --quiet $addrss & 
```

或者，您可以删除原始 vlc 命令的 fork 进程运算符“&”。

# django - Django：Form中的DateField必须具有不同的格式

> ID：13790302
> 
> 赞同：0
> 
> 时间：2012-12-09T18:23:34.560
> 
> 标签：django

我有一个名为 DateField() 的对象`event_date`，以及一个呈现`<input type="text" />`小部件的视图。

我的问题是 DateField() 对象将日期存储在表单`yyyy-mm-dd`中，但该`<input>`字段必须接受表单中的输入`dd.mm.yyyy`。这不验证。有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T14:33:03.920

您是否尝试本地化您的输入？[https://docs.djangoproject.com/en/dev/topics/i18n/formatting/#locale-aware-input-in-forms](https://docs.djangoproject.com/en/dev/topics/i18n/formatting/#locale-aware-input-in-forms)

其他方法是在表单中使用自定义字段。

# logging - 如何在 RMI 服务器中创建日志文件？

> ID：13790303
> 
> 赞同：0
> 
> 时间：2012-12-09T18:23:39.210
> 
> 标签：logging, rmi, sun

我目前在 RMI 服务器上工作，我添加了一个算法来测试它，我的问题是：

*   如何在服务器中创建然后读取日志文件？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:45:05.437

与您在任何其他类型的系统中执行此操作的方式相同。您使用您选择的日志记录包并编写代码。

# c++ - 在iso 8601时间戳c ++之前和之后获取设定时间

> ID：13790305
> 
> 赞同：3
> 
> 时间：2012-12-09T18:23:43.500
> 
> 标签：c++, c++11

给定一个标准的 ISO 8601 时间戳，是否有一种简单的方法可以从原始时间戳之前 20 分钟和另一个时间戳之后 20 分钟获取时间戳？

例如给出

```
 2010-01-25 18:02:00 
```

我希望返回一两个函数， `2010-01-25 17:48:00`并且 `2010-01-25 18:22:00`

我放弃的解决方案相当麻烦，我`s.substr(14,2)`用来获取分钟和`s.substr(12,2)`小时，将小时和分钟字符串转换为 int 并减去或添加带有条件的分钟值，如果它高于 60 或低于 0。是有更好/更简单的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-09T19:09:17.120

你可以：

1.  将字符串转换为`struct tm` [using`std::get_time`](http://en.cppreference.com/w/cpp/io/manip/get_time)。
2.  修改`struct tm`（无需考虑范围）。
3.  规范化`struct tm` [使用`mktime`](http://en.cppreference.com/w/cpp/chrono/c/mktime).
4.  打印`struct tm` [使用`std::put_time`](http://en.cppreference.com/w/cpp/io/manip/put_time)

* * *

```
#include <ctime>
#include <string>
#include <sstream>
#include <iostream>
#include <iomanip>

std::string increase_minutes(const std::string& input, int delta) {
    struct tm tm;
    constexpr auto format = "%Y-%m-%d %T";

    std::istringstream iss (input);
    iss >> std::get_time(&tm, format);
    tm.tm_min += delta;
    mktime(&tm);

    std::ostringstream oss;
    oss << std::put_time(&tm, format);
    return oss.str();
}

int main() {
    auto s = "2012-12-31 23:59:00";
    std::cout << increase_minutes(s, 20) << std::endl;
    std::cout << increase_minutes(s, -20) << std::endl;
} 
```

请注意，`std::get_time`和`std::put_time`在 g++/libstdc++ 中不存在。您可能需要使用 C 函数`sscanf`或解析字符串`strptime`，并使用 打印字符串`strftime`。另请参见[C++ 日期和时间](https://stackoverflow.com/questions/12346260/c-date-and-time)。

* * *

**编辑：**如果我们想通过泛型进行更改`std::chrono::duration`，最好`std::chrono::time_point`直接在 a 上进行操作。我们可以通过两步转换从 a 创建 time_point `struct tm`：time_point ↔ time_t ↔ struct tm，如下图所示：

```
#include <ctime>
#include <string>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <chrono>

template <typename R, typename P>
std::string increase_iso_time(const std::string& input, 
                              const std::chrono::duration<R, P>& duration) {
    struct tm tm;
    constexpr auto format = "%Y-%m-%d %T";

    std::istringstream iss (input);
    iss >> std::get_time(&tm, format);
    auto time = mktime(&tm);
    auto tp = std::chrono::system_clock::from_time_t(time);

    tp += duration;

    time = std::chrono::system_clock::to_time_t(tp);
    tm = *localtime(&time);
    std::ostringstream oss;
    oss << std::put_time(&tm, format);
    return oss.str();
}

int main() {
    auto s = "2012-12-31 23:59:00";
    std::cout << increase_iso_time(s, std::chrono::minutes(20)) << std::endl;
    std::cout << increase_iso_time(s, - std::chrono::hours(4)
                                      - std::chrono::minutes(20)) << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T19:35:43.490

`mktime()`从 C 或 C++ 标准查找。您需要`strptime()`将 ISO 8601 时间转换为`struct tm`(或者您可以使用`sscanf()`, 或 ...) 之类的东西。然后制作你的结构的两份副本，在其中一个中调整`tm_min`+20，在另一个中调整 -20，调用`mktime()`，然后`strftime()`。

这适用于 C 和 C++98、C++2003 以及 C++2011。如果您希望它仅适用于 C++2011，那么您需要转到`std::chrono`.

### 示例代码

由于标头，此代码适用于 C++，但可以通过更改为`<time.h>`and转换为`<stdio.h>`C。是的，它可能算不上“好”的 C++；它肯定会给您留下一些界面决定。但它确实完成了工作。（对于纯 C++，您可以删除对 . 的引用`struct`。）

```
#include <ctime>
#include <cstdio>

static void delta_t(const char *otime, int delta)
{
    struct tm tm1;
    int n;
    if ((n = sscanf(otime, "%4d-%2d-%2d %2d:%2d:%2d", &tm1.tm_year, &tm1.tm_mon, &tm1.tm_mday,
                    &tm1.tm_hour, &tm1.tm_min, &tm1.tm_sec)) != 6)
    {
        printf("%s: failed %d\n", otime, n);
        return;
    }
    printf("%.4d-%.2d-%.2d %.2d:%.2d:%.2d\n", tm1.tm_year, tm1.tm_mon, tm1.tm_mday,
            tm1.tm_hour, tm1.tm_min, tm1.tm_sec);

    tm1.tm_isdst = -1;
    tm1.tm_year -= 1900;
    tm1.tm_mon--;
    struct tm tm2 = tm1;
    tm2.tm_min += delta;
    struct tm tm3 = tm1;
    tm3.tm_min -= delta;
    mktime(&tm2);
    mktime(&tm3);
    char dt1[20];
    char dt2[20];
    char dt3[20];
    strftime(dt1, sizeof(dt1), "%Y-%m-%d %H:%M:%S", &tm1);
    strftime(dt2, sizeof(dt2), "%Y-%m-%d %H:%M:%S", &tm2);
    strftime(dt3, sizeof(dt3), "%Y-%m-%d %H:%M:%S", &tm3);

    printf("Input: %s\n", otime);
    printf("Date1: %s\n", dt1);
    printf("Date2: %s\n", dt2);
    printf("Date3: %s\n", dt3);
}

int main(void)
{
    delta_t("2010-01-25 18:02:00", 20);
    delta_t("2012-12-31 23:59:00", 20);
    return(0);
} 
```

样本输出：

```
2010-01-25 18:02:00
Input: 2010-01-25 18:02:00
Date1: 2010-01-25 18:02:00
Date2: 2010-01-25 18:22:00
Date3: 2010-01-25 17:42:00
2012-12-31 23:59:00
Input: 2012-12-31 23:59:00
Date1: 2012-12-31 23:59:00
Date2: 2013-01-01 00:19:00
Date3: 2012-12-31 23:39:00 
```

# unit-testing - 编写测试套件

> ID：13790312
> 
> 赞同：0
> 
> 时间：2012-12-09T18:24:39.770
> 
> 标签：unit-testing, phpunit

我知道每个人都同意单元测试应该是单一的事实。但是如果你读过这本书，你会注意到有构建测试套件的空间。

> 第 7 章组织测试 PHPUnit 的目标之一（见第 2 章）是测试应该是可组合的：我们希望能够同时运行任意数量或组合的测试，例如整个项目的所有测试，或者测试作为项目一部分的组件的所有类，或仅测试单个类。

示例 7.2：使用 XML 配置组成测试套件

```
<phpunit>
  <testsuites>
    <testsuite name="Object_Freezer">
      <file>Tests/Freezer/HashGenerator/NonRecursiveSHA1Test.php</file>
      <file>Tests/Freezer/IdGenerator/UUIDTest.php</file>
      <file>Tests/Freezer/UtilTest.php</file>
      <file>Tests/FreezerTest.php</file>
      <file>Tests/Freezer/StorageTest.php</file>
      <file>Tests/Freezer/Storage/CouchDB/WithLazyLoadTest.php</file>
      <file>Tests/Freezer/Storage/CouchDB/WithoutLazyLoadTest.php</file>
    </testsuite>
  </testsuites>
</phpunit> 
```

如果您添加测试依赖项的功能：

> 测试依赖
> 
> 单元测试主要是作为一种良好实践编写的，以帮助开发人员识别和修复错误、重构代码并作为被测软件单元的文档。为了实现这些好处，理想情况下，单元测试应该涵盖程序中所有可能的路径。一个单元测试通常涵盖一个功能或方法中的一个特定路径。然而，测试方法不一定是封装的、独立的实体。测试方法之间通常存在隐含的依赖关系，隐藏在测试的实现场景中。

您可以使用 @depends ClassName::Function 在类内或类之间使用依赖关系，并使用 ClassName::Function 提供的数据。

例如，如果 A 类提供也用于 B 类和 C 类的数据，您将获得：

```
A {
    function a()
    {
        return $data;
    }
}
B {
    /**
    * @depends A::a
    */
    function b($data)
    {
        return $data2;
    }
}
C {
    /**
    * @depends B::b
    */
    function c($data2)
    {
    }
} 
```

为什么这么糟糕？将 A::a 中的代码复制到 B::b 类，然后将 A::a 和 B::b 中的代码复制到 C::c 类中是否更好？

我想学习您认为的最佳实践..我之前一直使用测试套件，单元测试非常适合测试独立功能，但是当您需要测试依赖于依赖关系的整个服务时，它有点复杂..我应该完全放弃 PHPUnit 进行谁的测试，你有什么建议作为替代品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:33:33.717

我将写下与 markus-tharkun 的讨论记录：

PHPUnit 旨在进行单元测试，这意味着：

> 单元测试的重点在于“单元”一词，这意味着您要测试独立单元而不是整个服务。如果每个小单元都有效，那么您的代码就有效。单元测试并不意味着测试你的整个架构是否有意义。

正如我问他的那样，如果您正在测试一个具有依赖关系的函数，您可以向该函数注入一个 Mock 对象。您应该模拟该函数的所有外部依赖项，包括安全层、用户对象、数据库访问等所有内容。如果你真的不能模拟依赖，那么你可以使用@depends，但应该避免这种情况。

Markus 建议我使用 Mockery 框架：[https ://github.com/padraic/mockery](https://github.com/padraic/mockery)

# css - mod将子域重写为css和图像的文件夹中断路径

> ID：13790313
> 
> 赞同：2
> 
> 时间：2012-12-09T18:24:53.473
> 
> 标签：css, apache, .htaccess, mod-rewrite, subdomain

我正在尝试使用 mod rewrite 将子域重定向到文件夹中带有参数的文件。

该网站位于根目录下的 /new 文件夹中。

我现在的 .htaccess 是（放置在根目录中）

```
RewriteEngine on
RewriteCond %{HTTP_HOST}   ^[www\.]*new.mydomain.com [NC]
RewriteCond %{REQUEST_URI} !^/new/.*
RewriteRule ^(.*) /new/index.php?cust_id=1807 
```

这是有效的，它将浏览器重定向到带有参数的正确文件，但它破坏了所有 css、js 和图像链接。我知道使用绝对路径或设置基本路径可以轻松解决这个问题，但我想继续使用相对路径并让它工作。

例如，源现在链接到 css，如下所示： [http://new.mydomain.com/css/file.css](http://new.mydomain.com/css/file.css)而它应该是[http://new.mydomain.com/new/css/file.css](http://new.mydomain.com/new/css/file.css)

提前致谢！

编辑：排除 css 和图像文件不会解决这个问题，因为它们位于例如 /new/css

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:47:32.953

编辑：根据您的反馈

```
RewriteEngine on
# Redirect css,js,img to /new/(css,js,img) with a 301
RewriteCond %{HTTP_HOST}   ^[www\.]*new.mydomain.com [NC]
RewriteCond %{REQUEST_URI} ^/(css|js|img)/.*
RewriteRule ^(.*)$ /new/$1 [L,R=301]

# then redirect anything that's not already /new/ to the page you want
RewriteCond %{HTTP_HOST}   ^[www\.]*new.mydomain.com [NC]
RewriteCond %{REQUEST_URI} !^/new/.*
RewriteRule ^(.*) /new/index.php?cust_id=1807 
```

这是基于我所拥有的有限信息，请参阅下面的评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:53:45.090

添加另一个 rewriteCond 怎么样？就像是...

```
RewriteCond %{REQUEST_URI} !^.*\.(css|js|jpe?g|png|gif)$ 
```

这将从重写中排除任何带有这些后缀的文件。

顺便说一句，我认为这`[www\.]*`在您的第一个 RewriteCond 中看起来不正确......这意味着“w 或 w 或 w 或 . 的零个或多个出现”。所以它并没有真正做任何有用的事情。

# c++ - 将长 64 位十进制转换为二进制

> ID：13790318
> 
> 赞同：2
> 
> 时间：2012-12-09T18:25:36.140
> 
> 标签：c++, objective-c, c, cocoa, binary

好的，尽管我仍然遇到问题，但我要完成的工作相当简单。

**这是我的代码：**

```
- (NSString*)toBin:(long)dec
{
    long num = dec;
    NSString *res = [NSString string];

    for (long i=63; i>=0; i--)
    {
        long div = 1<<i;
        if ((num&div)==div) res = [res stringByAppendingString:@"1"];
        else res = [res stringByAppendingString:@"0"];
    }

    return res;
} 
```

**这就是我测试它的方式：**

```
 for (long i=1; i<10; i++)
    {
        NSLog(@"%u = %@",i,[self toBin:(long)i]);
    } 
```

但是，上面的输出是：

```
1 = 0000000000000000000000000000000100000000000000000000000000000001
2 = 0000000000000000000000000000001000000000000000000000000000000010
3 = 0000000000000000000000000000001100000000000000000000000000000011
4 = 0000000000000000000000000000010000000000000000000000000000000100
5 = 0000000000000000000000000000010100000000000000000000000000000101
6 = 0000000000000000000000000000011000000000000000000000000000000110
7 = 0000000000000000000000000000011100000000000000000000000000000111
8 = 0000000000000000000000000000100000000000000000000000000000001000
9 = 0000000000000000000000000000100100000000000000000000000000001001 
```

所以，它*几乎是*正确的（至于最后 32 位），尽管它似乎在前 32 位上复制了自己。我猜这与我的`long`体型有关，但`sizeof(long)`返回`8`. 有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:36:31.747

这个表达式：

```
long div= 1<<i; 
```

是一个整数，而不是一个长整数。所以你得到一个只有 32 位的整数（如果我只为我的机器说话，请原谅）。所以只需生成一个 64 位表达式：

```
long div = 1l<<i; 
```

# javascript - .click() 函数与 ajax 一起使用

> ID：13790321
> 
> 赞同：1
> 
> 时间：2012-12-09T18:25:43.237
> 
> 标签：javascript, jquery, html, ajax

JavaScript：

```
<script>

$('#alink').click(function () {
     $("#loading").ajaxStart(function(){
    $(this).show();
 }).ajaxStop(function(){
    $(this).hide();
 });

$('#aresult').load('content2.html', function() {
 $('#successdata').html('100% loaded');
});
 });
 </script> 
```

HTML：

```
<a href="#" id="alink">click me</a>
<div id="aresult"></div> 
```

这段代码有什么错误？当用户单击鼠标加载图像时，我想加载 ajax 调用页面

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:27:32.090

我会这样做，并避免全局 ajax 事件：

```
<script type="text/javascript">
    $(function() {
        $('#alink').on('click', function () {
             $("#loading").show();
             $('#aresult').load('content2.html', function() {
                 $('#successdata').html('100% loaded');
                 $("#loading").hide();
            });
        });
    });
</script> 
```

还要记住 document.ready 函数等。

# c++ - 了解算法解决方案

> ID：13790324
> 
> 赞同：0
> 
> 时间：2012-12-09T18:26:19.543
> 
> 标签：c++, algorithm

我想自己解决这里的问题：[在C++中找到左右和的最长子串](https://stackoverflow.com/questions/8469407/to-find-the-longest-substring-with-equal-sum-in-left-and-right-in-c)

代码在这里

```
int getEqualSumSubstring(string s) {
    int i=0,j=i,foundLength=0;
    for(i=0;i<s.length();i++)
    {
        for(j=i;j<s.length();j++)
        {
            int temp = j-i+1;

            if(temp%2==0)
            {
                int leftSum=0,rightSum=0;
                string tempString=s.substr(i,temp);
                // printf("%d ",tempString.length());
                for(int k=0;k<temp/2;k++)
                {
                    leftSum=leftSum+tempString[k]-48;
                    rightSum=rightSum+tempString[k+(temp/2)]-48;
                }
                if((leftSum==rightSum)&&(leftSum!=0))
                    if(tempString.length()>foundLength)
                    foundLength=tempString.length(); 
            }
        }
    }
    return(foundLength);
} 
```

我想知道 temp = i+j-1 的计算是如何完成的？他如何在纸上或通过例子得到这个等式。我尝试了很多，但我无法得到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:39:00.207

它只是子串的长度，其中 i 和 j 分别是子串的左右边界。如果我们在从 x 到 y 的直线上有一段，x < y，那么它的长度是 y - x。因为我们这里有一个离散对象，所以长度可以变化 1 或 2。这里，由于我们采用封闭边界，在位置 i 开始和结束的子串的长度将是 1 = i - i + 1，所以公式应该是 j - i + 1。

# ios - 将 iOS 中的一列 JSON 文件解析为数组？

> ID：13790327
> 
> 赞同：2
> 
> 时间：2012-12-09T18:27:04.080
> 
> 标签：ios, xcode, json

我已经设法使用 JSON 从我的网络服务器获取位置列表，并从应用程序中获取文件。我知道它可以得到等，因为我也打印了 NSLog，它出现在日志窗口中的 JSON 中。

我的下一步是将这些值放入一个数组中，以便最终将它们显示到 UIPickerView 中。

有人对我如何最好地将它们从当前 JSON 文件中放入数组有任何建议吗？

关键是“名称”。

我一辈子都无法让它循环并添加到数组中；也许我做错了？

JSON 数据如下所示：

```
[{"Name":"Aberdaron"},{"Name":"Aberdeen"},{"Name":"Aberdovey"},{"Name":"Aberporth"},{"Name":"Aberystwyth"},{"Name":"Albert-Bridge"},{"Name":"Aldeburgh"},{"Name":"Allington-Lock"},{"Name":"Alloa"},{"Name":"Amble"},{"Name":"Amlwch"},{"Name":"Annan-Waterfoot"},{"Name":"Anstruther-Easter"},{"Name":"Applecross"},{"Name":"Appledore"},{"Name":"Arbroath"},{"Name":"Ardglass"},{"Name":"Ardnave-Point"},{"Name":"Ardrossan"},{"Name":"Arklow"},{"Name":"Arnside"},{"Name":"Arrochar"}] 
```

我到目前为止的代码是：

```
 NSString * urlString = [NSString stringWithFormat:@"http://localhost:8888/Locations.php"];
NSURL * url = [NSURL URLWithString:urlString];
NSData * data = [NSData dataWithContentsOfURL:url];
NSError * error;
NSMutableArray *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
NSLog(@"%@",json); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:41:10.257

因此，您的 JSON 已经作为一个数组下降（通过您的键/值对包含在硬括号中这一事实来表示`[ ]`）。假设您没有使用任何第三方 JSON 消费库，您可以使用 iOS 的内置`NSJSONSerialization`将 JSON 数据转换为 Objective-C 对象。你可能会想要类方法`+ (id)JSONObjectWithData:(NSData *)data options:(NSJSONReadingOptions)opt error:(NSError **)error`，它只需要一个指向某个 NSData 的指针、一个选项标志和一个指向 NSError 的指针。

请注意该方法返回 type `id`，但由于您的 JSON 在数组中出现，请继续将其粘贴在数组变量中。`NSDictionary`现在，您有一个可以循环遍历的 s 数组。假设您的数组是 named `jsonDataArray`，将所有名称放入您的选择器的数组中的代码非常简单。当然，您可以`NSMutableArray`在初始数组中创建一个 and 循环，将`objectForKey:`字典中的结果添加到可变数组中。

一个更简单和优雅的方法是一个简单的单行：

```
NSArray *names = [jsonDataArray valueForKey:@"Name"]; 
```

在数组上使用时， valueForKey 将获取该键的对象的所有值。由于您的对象是`NSDictionary`s，因此值将是您所需要的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:00:17.530

第一个答案很好地描述了如何解析数组并将其放入本机对象中。我写了一个函数，它是 NSString 上的一个类别，你可以在下面使用。假设您的数组存储在一个名为 json 的变量中，我将使用以下代码，给定您的示例：

```
NSMutableArray *nameArray = [NSMutableArray array];
for (NSDictionary *dictionary in json)
{
    [nameArray addObject:[dictionary valueForKey:@"Name"]];
}
NSLog(@"%@",nameArray); 
```

现在 nameArray 是与您的示例中给出的“名称”键对应的所有值的数组。

# android - 使用 PhoneGap 将增量数据推送到云端

> ID：13790330
> 
> 赞同：1
> 
> 时间：2012-12-09T18:27:16.140
> 
> 标签：android, iphone, cordova, afnetworking, cloud-hosting

我似乎对当今移动框架和云存储中可用的无数选项感到困惑。我之前写过一些相对简单的原生 iPhone 应用程序，并且我已经用 Java 和 C++ 编程了一段时间。

我现在面临着跨多个移动平台编写应用程序的问题，我目前正在研究技术。

该应用程序是大量数据驱动的，并将数据存储在云中。数据将在设备上进行操作。我的问题不是找到一个移动框架和云提供商来完成这项工作，而是有这么多的事实！

像带有 Heroku 的 AFIncrementalStore (https://github.com/AFNetworking/AFIncrementalStore) 之类的东西似乎正是我在编写原生 iPhone 应用程序时所需要的。（目前在 mobile.heroku.com 上有一个很好的示例视频。）但是在使用 PhoneGap 时有这样的事情吗？除了性能之外，PhoneGap 似乎是我在 iOS 和 Android（我最初的两个平台）上快速编写应用程序的最佳选择。

我希望这个问题不会太模糊。如果是的话，就说明我的困惑程度了……

# mirth - 从 Mirthconnect 读取多个段时出错

> ID：13790331
> 
> 赞同：0
> 
> 时间：2012-12-09T18:27:20.573
> 
> 标签：mirth

我正在尝试使用 Mirthconnect 从 HL7 消息读取多个段 (OBR) 到数据库。消息正常，Mirthconnect 记录为数据库写入成功，但是我看不到数据库中的数据。谁能告诉我如何调试 Mirthconnect 与数据库的连接。

HL7 消息：

```
MSH|^~\&|AA|AA1|MSFT|AA1|20121203104758||OMG^O19|861232|T|2.4|||KA
PID|||P1563626|W981189|TEST^TEST^""^^MISS||20120910|F|||||||||||||||||||||""|L
PV1|||HOSP1||||||V2567697 ORC|WT|2R000112|||SD||||||||HOSP1 OBR|1|2R000112||TEST 1
ORC|WT|2R000445|||SD||||||||HOSP1 OBR|1|2R000445||TEST 2 ORC|WT|2R000399|||SD
||||||||HOSP1 OBR|1|2R000399||TEST 3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-22T01:25:26.127

首先在您的 Mirth Channel 中创建一个 Javascript 转换器。在 Source Transformer Message Translator 窗口中复制您的 HL7。您可以创建允许您遍历并遍历 OBR 段的 java 脚本。

```
var observation = {};
for each (obr in msg.OBR) {
 observation.type = obr['OBR.2'].toString();
} 
```

试试上面提到的，让我们知道。

# android - 适用于 android 的 java 对象到对象映射

> ID：13790335
> 
> 赞同：4
> 
> 时间：2012-12-09T18:27:35.083
> 
> 标签：android

哪个工具能够将一个对象映射到 Android 中的另一个对象？

我发现这个主题[any-tool-for-java-object-to-object-mapping](https://stackoverflow.com/questions/1432764/any-tool-for-java-object-to-object-mapping)

java有很多工具，我试过Orika和ModelMapper但没有成功。java.beans 错过了 ModelMapper。Orika 在 slf4j 日志记录方面存在问题。

# javascript - 添加 和 至 使用 jQuery

> ID：13790338
> 
> 赞同：2
> 
> 时间：2012-12-09T18:28:03.147
> 
> 标签：javascript, jquery, html-lists

在我的 Wordpress 页面中，我有许多以歌词为主题的帖子。我希望以不同的方式设计交替的歌词。到目前为止，我已经整理了基础知识，但是我需要帮助使用 jQuery 为每行歌词添加前缀和后缀`<li>`，`<ul>`以便使用 CSS 样式将样式应用于奇数行和偶数行，正如我在这篇文章中看到的那样（http://stackoverflow .com/questions/358350/alternate-background-colors-for-list-items）。我的 HTML 当前如下所示：

```
<div id="lyricstext" style="overflow: auto; height: 340px; width: 640px;">
<ul>
Leave me alone
Leave me alone
Leave me alone
So just leave me alone
I said leave me alone
Leave me alone
Leave me alone
I’m not in the mood!
Piss off!
So when I say leave me alone
Nah T don’t play
I’m like Michael Jackson in a non-paedo way
The thought of mad partyin’, debauchery tortures me
My T-shirt reads “Fuck off and don’t talk to me”
Approaching every situation awkwardly
Like I’m mesmerized under some sort of sorcery
Who’s calling me? Don’t know – I’ll ignore it G
If I don’t share my time then is there more for me?
</ul>
</div> 
```

所以，我想知道要在页面上应用什么 JS 来为我插入这些`<li>`和`</li>`标签，以便能够以不同的方式设置每个备用行的样式。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:31:37.433

你可以这样做 ：

```
$('#lyricstext ul').html($('#lyricstext ul').html().split('\n').map(function(v){
    return '<li>'+v+'</li>';
}));​​​​​​​​​​​​​​​​ 
```

[示范](http://jsfiddle.net/wZQQB/)

如果你有多个 ul 你需要类似的东西

```
$('#lyricstext ul').each(function(){
    $(this).html($(this).html().split('\n').map(function(v){
       return '<li>'+v+'</li>';
    }));
}); 
```

当然，就像应用在 DOM 上的几乎所有代码一样，它必须在 DOM 准备好之后调用。所以你必须将你的代码包装在一个准备好的回调中；

```
$(function(){
    $('#lyricstext ul').html($('#lyricstext ul').html().split('\n').map(function(v){
        return '<li>'+v+'</li>';
    }));​​​​​​​​​​​​​​​​
}); 
```

​​​​​​​​​​​​​​​​​​​​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:32:45.543

你可以使用这样的函数：

```
var html = $('#lyricstext ul').html().split('\n').map(function(text){
    return '<li>'+text+'</li>';
});
$('#lyricstext ul').html(html);​​​​​​​​​​​​​​​​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:43:26.713

很简单，试试这个：

```
var $ul = $("#lyricstext ul");
var lines = $ul.text().split('\n');

$.each(lines, function() {
    $ul.append('<li>' + this + '</li>');
    $ul.find('li:odd').addClass('alternate');
});​ 
```

# javascript - 如何在单击时更改框的内容和背景颜色？

> ID：13790339
> 
> 赞同：0
> 
> 时间：2012-12-09T18:28:10.217
> 
> 标签：javascript, jquery, html, fadein, fadeout

这是我第一次解决这个问题，所以如果我的术语有误，请纠正我。

我有一个高度为 500，宽度为 500 的 div 框，在它第一次加载时我将在其中包含文本内容。在底部我会有一个按钮，上面写着“点击这里”。单击该按钮时，我想更改框上的背景并加载图像。

请参考下图：

![所以当](../Images/7d9121fc1e574b814fdc468b3ba46815.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:03:16.293

我个人会采取不同的更直接的方法。也就是说，如果您只需要一些图像，您不妨提前获取它们并隐藏它们，跳过不必要的服务器请求：

[工作小提琴](http://jsfiddle.net/fNgjp/1/)

代码：

HTML：

```
<div id="container">
    <div id="button_layer">
        <p>Some Text</p>
        <button>Click Me</button>
    </div>
    <div id="images_layer">
        <img src="http://mattat.org.il/wp-content/themes/matat/img/aminadav.jpg"/>
        <img src="http://mattat.org.il/wp-content/themes/matat/img/aminadav.jpg"/>
         <img src="http://mattat.org.il/wp-content/themes/matat/img/aminadav.jpg"/>
    </div>
   </div> 
```

​ CSS：

```
#container {
width:500px;
height:500px;
background:grey;
}
#images_layer {
display:none;
} 
```

JS：

```
 $(document).ready(function(){
    $("button").click(function(){
         $("#button_layer").hide();
        $("#images_layer").show();
        $("#container").css("background","yellow");
    })
  }); 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:47:35.527

试试这个

```
var images = 10;

$('button').on('click' , function(){
    var html = '';
    for(var i =0;i<images ; i++){
      html += '<img src="images/image-'+ images + '"></img>';   
    }

    $('.a').removeClass('a').addClass('b').html(html);

});​

​&lt;div class="a">
   I am the initial div...
</div>

​&lt;button>Click Me</button>​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/ZJfuM/2/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:47:50.670

我将通过捕获 click 函数来完成此任务，然后通过从服务器请求将一些数据加载到 div 中。

```
$('button').on('click', function(){
    $.ajax({
        type: 'GET', //default anyway
        url: '/path/to/my/controller.ext',
        data: {'getImages' : true},
        success: function(data){
             $('.box').html(data); 
        }
    });
}); 
```

然后在服务端，我们可以抓取get请求，返回一串图片；这个例子是在 PHP 中。

```
if(isset($_GET['getImages']) && TRUE === $_GET['getImages']):
    //build some string to pass images..
    $str = '<img src="path/to/my/first_img.ext"/><img src="path/to/my/second_img.ext"/><img src="path/to/my/third_img.ext"/><img src="path/to/my/fourth_img.ext"/><img src="path/to/my/fifth_img.ext"/>';
    echo $str;
endif; 
```

如果对我们`.ajax()`调用中提供的文件名的请求发生，那么它将使用`GET`请求来抓取图像。我们有条件地检查`getImages`. 我们构建了一个包含图像的字符串，并将其传回。`success:function(data)`我们的调用`ajax()`处理返回的数据。在这个例子中。数据是`$str`我们在我们的`php conditional`. 我们只需将框的 HTML 更改为我们从服务器提供的字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T19:06:42.807

我上传了一个用动画改变背景颜色的例子：

[http://jsfiddle.net/TBvcW/1/](http://jsfiddle.net/TBvcW/1/)

它是使用 CSS3 制作的，但不支持它的浏览器会在没有动画的情况下更改颜色。颜色动画的关键代码是这些 CSS 属性：

```
-webkit-transition: background-color 0.5s, color 0.5s;
-mox-transition: background-color 0.5s, color 0.5s;
-o-transition: background-color 0.5s, color 0.5s;
transition: background-color 0.5s, color 0.5s; 
```

在哪里，我们决定在更改时（通过 CSS）哪个属性将被动画化，以及动画需要多长时间。

您甚至可以更改框的高度并按照其他答案中的说明添加图像：

[http://jsfiddle.net/TBvcW/2/](http://jsfiddle.net/TBvcW/2/)

干杯。

# android - 如何创建短信收件箱并将信息写入短信标题

> ID：13790341
> 
> 赞同：2
> 
> 时间：2012-12-09T18:28:22.213
> 
> 标签：android, sms, aes

我正在使用 aes256（使用 aes 的消息加密）开发一个 SMS 应用程序现在我必须解决两个问题。

**问题 1：**有什么资源可以让我学习如何创建一个有收件箱和发件箱的短信箱或类似 Android 短信应用程序的东西？

*其他问题：*当我发送消息时，我的应用程序会在另一端查看此消息。我想将我的应用程序信息实现到消息头信息中，当消息从我的应用程序到达时，我的应用程序将打开并查看带有收件箱的消息，并且默认的 Android SMS 应用程序不会打开即将到来的 SMS。

**问题 2：**如何在消息头中实现信息以识别我的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:36:44.687

库存的 Android SMS/MMS 应用程序是 Android 开源项目的一部分，完整源代码可在此处获得：[https ://android.googlesource.com/platform/packages/apps/Mms/](https://android.googlesource.com/platform/packages/apps/Mms/)

此处概述和引用了用于 SMS 标头的标准：[http ://en.wikipedia.org/wiki/User_Data_Header](http://en.wikipedia.org/wiki/User_Data_Header)

# java - IDEA IntelliJ 使用什么 Java GUI 库？

> ID：13790342
> 
> 赞同：8
> 
> 时间：2012-12-09T18:28:27.310
> 
> 标签：java, eclipse, macos, user-interface, intellij-idea

我正在寻找 Java GUI 库，尤其是在 Mac OS X 上。

我检查了 SWT/JFace，并以定制的 eclipse 为例测试了 eclipse 和 RCP。我还检查了 SWING，例如我测试了 NetBeans。

我发现IDEA ntelliJ、RubyMine 和PyCharm 等Jetbrains 工具似乎符合我的需求，但我不确定他们使用的是什么GUI 工具。

它们看起来不像是 RCP 应用程序，因为我没有看到任何 OSGi 库，而且 GUI 似乎与 SWING 有点不同。

IDEA IntelliJ 使用什么 Java GUI 库？此外，当我在 Mac OS X 上使用 SWT/JFace 和 SWING 以外的 Java 制作 GUI 程序时，我有哪些选择？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-09T18:32:29.850

它使用 Swing。我知道，因为您可以设置 Swing 附带的那些老式外观和感觉。

您也可以使用 JavaFX。

# c# - ArgumentNullException 改变框架

> ID：13790344
> 
> 赞同：8
> 
> 时间：2012-12-09T18:28:31.900
> 
> 标签：c#, windows-8, argumentnullexception, page-state

所以我正在尝试更改 Windows 8 应用程序中的框架。我尝试按照[此页面上](http://www.c-sharpcorner.com/UploadFile/99bb20/passing-multiple-values-between-pages-in-metro-style-app-usi/)的教程进行操作，但我不断收到相同的错误。

我在线上收到 ArgumentNullException：

```
frameState[_pageKey] = pageState; 
```

在 LayoutAwarePage.cs 类的 OnNavigatedFrom 方法中。

现在我不确定为什么会出现这个错误，因为我觉得在我的代码中没有什么可能导致它。我的按钮 onclick 函数有以下代码：

```
DateTime chosenDateTime = new DateTime(year, month, day, hours, minutes, seconds);
this.Frame.Navigate(typeof(MainPage), chosenDateTime.ToString()); 
```

我的 MainPage 中的 OnNavigatedTo 方法如下所示：

```
protected override void OnNavigatedTo(NavigationEventArgs e) {
   string parameter = (string)e.Parameter;
   if (parameter != "") {
       Windows.Storage.ApplicationDataContainer roamingSettings = Windows.Storage.ApplicationData.Current.RoamingSettings;
       roamingSettings.Values["chosenDateTime"] = parameter;
       chosenDateTime = Convert.ToDateTime(e.Parameter);
   } else {
       Windows.Storage.ApplicationDataContainer roamingSettings = Windows.Storage.ApplicationData.Current.RoamingSettings;
       if (roamingSettings.Values.ContainsKey("chosenDateTime")) {
           chosenDateTime = Convert.ToDateTime(roamingSettings.Values["chosenDateTime"].ToString());
       }
       if (roamingSettings.Values.ContainsKey("headline")) {
           chosenDateTextBlock.Text = roamingSettings.Values["headline"].ToString();
       }
   }
   SetTime();
} 
```

谁能给我一些关于如何解决这个问题的信息？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-09T19:12:42.043

好的，所以我找到了自己问题的答案！

在我引用和引用的两个页面上，我必须至少实现了这两种方法的最小实现：

```
protected override void OnNavigatedTo(NavigationEventArgs e) {
    base.OnNavigatedTo(e);
}

protected override void OnNavigatedFrom(NavigationEventArgs e) {
    base.OnNavigatedFrom(e);
} 
```

和

```
base.OnNavigatedFrom(e);
base.OnNavigatedTo(e); 
```

在方法中非常重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-05T06:20:03.443

可能触发此问题的另一种情况是，如果页面不再附加到任何框架（例如，由于事件处理程序或其他引用，它仍在内存中，但其框架已被导航离开页面）。

`Frame.Navigate()`如果您调用可能多次触发或多次附加到事件的事件处理程序，这很容易发生意外（第一次调用将起作用，但第二次调用将在页面不再有任何框架后调用） .

# javascript - 如何调用自定义 jQuery 函数

> ID：13790345
> 
> 赞同：-3
> 
> 时间：2012-12-09T18:28:30.683
> 
> 标签：javascript, jquery

我对 jQuery 比较陌生，我正在尝试创建一个自定义 jQuery 函数。该功能将旋转图像。够简单！这是我目前调用该函数的方式：

```
function rotate(degree) {
    $(this).css({
        "transform": "rotate(" + degree + "deg)",
        "-ms-transform": "rotate(" + degree + "deg)", /* Internet Explorer */
        "-moz-transform": "rotate(" + degree + "deg)", /* Firefox */
        "-webkit-transform": "rotate(" + degree + "deg)", /* Safari and Chrome */
        "-o-transform": "rotate(" + degree + "deg)" /* Opera */
    });
} 
```

我想像这样调用上面的函数：

```
$(".object").rotate(8); 
```

**我将如何更改上述功能以使其像这样工作？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:32:41.490

```
$.fn.rotate = function(degree){
   this.each(function(){
      $(this).css({
        "transform": "rotate(" + degree + "deg)",
        "-ms-transform": "rotate(" + degree + "deg)", /* Internet Explorer */
        "-moz-transform": "rotate(" + degree + "deg)", /* Firefox */
        "-webkit-transform": "rotate(" + degree + "deg)", /* Safari and Chrome */
        "-o-transform": "rotate(" + degree + "deg)" /* Opera */
      });
   });
   return this;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:34:16.433

没有必要使用`each()`. jQuery`css()`函数适用于整个集合，就像几乎每个 jQuery 函数一样。

这是（至少接近于）最佳实践，行业认可的创建新 jQuery 插件的方法。您的代码不起作用的原因是您所做的只是声明了一个全局函数。为了使 jQuery 对象可以访问该函数，您必须将该函数添加到 jQuery 对象本身，以便它与该对象的实例正确配对，从而`this`访问当前的 jQuery 集。如下所示。出于各种原因，您可以在大多数在线 jQuery 插件教程中阅读到函数中包含所有内容的有趣内容。请注意，在 jQuery 函数内部，不需要`$(this)`像`this`已经引用 jQuery 匹配集那样做。

```
(function($, window, undefined) {
   $.fn.rotate = function(degree) {
      return this.css({
         "transform": "rotate(" + degree + "deg)",
         "-ms-transform": "rotate(" + degree + "deg)", /* Internet Explorer */
         "-moz-transform": "rotate(" + degree + "deg)", /* Firefox */
         "-webkit-transform": "rotate(" + degree + "deg)", /* Safari and Chrome */
         "-o-transform": "rotate(" + degree + "deg)" /* Opera */
      });
   };
   $.fn.unrotate = function() {
      return this.css({
         "transform": "",
         "-ms-transform": "", /* Internet Explorer */
         "-moz-transform": "", /* Firefox */
         "-webkit-transform": "", /* Safari and Chrome */
         "-o-transform": "" /* Opera */
      });          
   };
}(jQuery, window)); 
```

我添加了一个`unrotate`功能，因此您也可以轻松删除 css。

[pimvdb](https://stackoverflow.com/users/514749/pimvdb)`transform`说 jQuery 1.8 将自动尝试前缀，因此如果您使用的是该版本或更高版本，则可能除了属性之外不需要任何东西。

# mysql - 如何从另一张表更新MYSQL中的一张表？有额外的价值

> ID：13790346
> 
> 赞同：2
> 
> 时间：2012-12-09T18:28:33.820
> 
> 标签：mysql, sql, database, sql-update

我有两张相似的桌子。

```
Table word
column names: id, name, describe
1 bob Is a cat
2 Sam Not a giraffe
3 Gub Like a cat

Table temp
column names: id, name, describe
1 bob Is a cat
2 Sam Not a giraffe
3 Gub Like a cat
4 Col The other one 
```

我目前正在使用它从表 temp 更新表字，但未添加第 4 个值。我该怎么做？

```
UPDATE temp p, word pp
SET pp.name= p.name, pp.describe = p.describe
WHERE pp.id = p.id; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:37:06.057

试试这个 :: INSERT ON DUPLICATE KEY UPDATE

```
INSERT INTO word(id, name, describe) SELECT id, name, describe FROM temp 
ON DUPLICATE KEY UPDATE SET word.name = temp.name, word.describe = temp.describe; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:38:53.560

如果我理解正确，您希望将值从一个表复制到另一个表，保持不变`id`。在这种情况下，您不能设置条件 WHERE pp.id = p.id。这样，它只会复制`id`“word”表中已经存在的行，跳过任何唯一的行。您可以使用“INSERT INTO...ON DUPLICATE KEY UPDATE”来解决它。[http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.1/en/insert-on-duplicate.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:33:56.183

最后一个需要插入语句，因为它还不存在

INSERT INTO word pp SELECT * FROM temp left join word on on temp.id = word.id where temp.id IS NULL

# android - 如何在 doInBackground 的 AsyncTask 中显示 toast

> ID：13790351
> 
> 赞同：14
> 
> 时间：2012-12-09T18:29:34.427
> 
> 标签：android, android-asynctask

在我正在使用的一项活动中`AsyncTask`。在`doInBackground()`我正在调用各种方法。在其中一种方法中，我遇到了异常，因此在 catch 块中，我想在 Toast 中显示错误。我知道我可以使用`Log`，但我仍然更喜欢 Toast。那么，如何在 doInBackground() 的 AsyncTask 中使用 Toast？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-09T18:41:45.820

从 doInBackground 返回为

```
protected String doInBackground(String... params){
    //some code
    try{
       //some code
     }catch(Exception e){
        return "Exception Caught";
     }
     return someValidResult;
}

protected void onPostExecute(String result){
    if(result.equalsIgnoreCase("Exception Caught")){
       //Display Toast
    }else{
       // // whatever you wana do with valid result
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-09T18:33:10.980

你可以把 Toast 包起来，[`runOnUIThread()`](http://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)但这不是最好的解决方案。当发生错误时，您应该在 catch 块中设置一个布尔标志，
然后在标志为 时显示适当的 Toast或任何其他具有 UI 访问权限的方法。`onProgressUpdate()``onPostExecute()``true`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-11-20T13:37:40.240

编写以下代码，您必须在`doInBackground()`方法中显示 toast

```
runOnUiThread(new Runnable() {

public void run() {

  Toast.makeText(getApplicationContext(), "Example for Toast", Toast.LENGTH_SHORT).show();

   }
}); 
```

*   顺便说一句：如果您正在使用`Fragments`，则需要`runOnUiThread(...)`通过您的活动来调用：

`getActivity().runOnUiThread(...)`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-09T18:38:00.090

您可以在一个方法中显示它，该方法可以访问 UI 线程，`onPreExecute()`例如`onProgressUpdate()``onPostExecute()`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-03T08:29:59.843

创建一个处理程序对象并使用它执行所有 Toast 消息。

```
@Override
protected Void doInBackground(Void... params) {

    Handler handler=new handler();
    handler=  new Handler(context.getMainLooper());
    handler.post( new Runnable(){
        public void run(){
            Toast.makeText(context, "Created a server socket",Toast.LENGTH_LONG).show(); 
        }
    });
  } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-12T10:27:31.417

```
runOnUiThread(new Runnable() {

public void run() {

  Toast.makeText(getApplicationContext(), "Example for Toast", Toast.LENGTH_SHORT).show();

   }
}); 
```

在 doInBackground() 方法中显示吐司的工作非常好

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-14T05:32:09.693

```
activity.runOnUiThread(new Runnable() {
 public void run() 
 {
    Toast.makeText(activity, "Toast teaxt", Toast.LENGTH_SHORT).show();
 }
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-05T06:43:35.897

试试这个代码

```
void showError(final String err) {
    runOnUiThread(new Runnable() {
        public void run() {
            Toast.makeText(downloadprogress.this, err + "error in download", Toast.LENGTH_LONG)
                    .show();
        }
    });
  } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-05T13:49:08.090

如果你必须声明任何与 Thread 相关的东西，那么它必须在 runOnUiThread() 方法之外，那么只有它会执行，

```
 @Override
    protected String doInBackground(String... strings) {
        for(int i=0; i<10; i++) {

            runOnUiThread(new Runnable() {
                public void run() {
                    Toast.makeText(getApplicationContext(), "Example for Toast "+i, Toast.LENGTH_SHORT).show();
                }
            });

            try {
                Thread.sleep(10);
            } catch (Exception e) {}
        }

        return "";
    } 
```

# c++ - 模板类中的可选代码

> ID：13790355
> 
> 赞同：6
> 
> 时间：2012-12-09T18:30:03.927
> 
> 标签：c++, gcc, c++11

假设我们拥有它`struct X;`并且我们使用 C++11 编译器（例如 gcc 4.7）。当且仅当，比如说，我想发出一些代码和属性`opt = true`。

```
template <bool opt>
struct X {
  void foo() {
    EMIT_CODE_IF(opt) {
      // optional code
    }

    // ...common code...
  }

  int optional_variable; // Emitted if and only if opt is true
}; 
```

1.  至于代码，我认为正常`if`就足够了。
2.  但是对于属性，如果不使用它们（何时`opt = false`），编译器会自动省略它们吗**？**我绝对不希望他们在那里的时候`opt = false`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:38:00.233

避免类模板中的属性的方法是从基类模板派生，如果成员不应该存在，则该模板专门为空。例如：

```
template <bool Present, typename T>
struct attribute {
    attribute(T const& init): attribute_(init) {}
    T attribute_;
};
template <typename T>
struct attribute<false, T> {
};

template <bool opt>
class X: attribute<opt, int> {
    ...
}; 
```

关于可选代码，您可能会使用条件语句，但通常代码不会编译。在这种情况下，您可以将代码分解为合适的函数对象，该函数对象专门在不需要时不做任何事情。

# java - java布尔问题

> ID：13790356
> 
> 赞同：0
> 
> 时间：2012-12-09T18:30:06.483
> 
> 标签：java, boolean, javaspaces

我正在尝试创建一个聊天客户端，我正在从 javaSpace 返回一条消息，然后设置 newMessage = true; 因此客户端可以看到有一条新消息需要阅读。

```
public void notify(RemoteEvent ev) 
{
    try 
    {
        messageRead = false;
        QueueItem qiTemplate = new QueueItem();
        newMessage = (QueueItem)space.take(qiTemplate,null,Long.MAX_VALUE);
        System.out.println(newMessage.getSender().getName()+ ": " + newMessage.getContent());
    } 
    catch (Exception e) 
    {
        e.printStackTrace();
    }
} 
```

那么对于客户来说，

```
while(true)
{
    try 
    {
        boolean temp  = _manager.messageRead;
        //System.out.println(temp);
        if(!temp)
        {
            QueueItem nextJob = _manager.newMessage;
            String nextJobNumber = nextJob.getSender().getName();
            String nextJobName = nextJob.getContent();
            System.out.println(nextJob.getSender().getName()+ ": " + nextJob.getContent());
            jobList.append( nextJobNumber + " : " + nextJobName + "\n" );

            _manager.messageRead = true;
        }

    }  catch ( Exception e) 
    {
        e.printStackTrace();
    }
} 
```

现在总是会返回 _messager.messageRead 为真，即使我只是将它设置得太假。如果我取消注释 //System.out.println(temp); 然后布尔值将由于某种原因被更新，它也将等于它的含义。

我以前从未遇到过这个错误，这对我来说非常奇怪，所以我希望有人能提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:31:49.407

您似乎没有同步访问您的 boolean flag `messageRead`。`println`碰巧为您做到了，因此您观察到了什么。

您可以通过标记 volatile 来解决您的问题：

```
private volatile boolean messageRead; 
```

这将确保您在一个线程中所做的更改在另一个线程中是可见的，而无需同步您的代码。

# .net - 将 .net 对象的类更改为子类

> ID：13790357
> 
> 赞同：3
> 
> 时间：2012-12-09T18:30:14.767
> 
> 标签：.net, oop, design-patterns

我有一个 OO 设计问题。

我正在使用工厂模式来创建适合我传递工厂的参数的类的对象。但是，有些属性我只能在创建对象后才能获得，然后我想用它们来进一步子类化或“专门化”对象的类型。

我需要多态的子类来为具有附加输入参数的对象使用自定义逻辑。

我认为这是一些设计模式“在运行时重新确定对象类”。我该如何实施？哦，可能是不好的做法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:32:38.417

您不能在运行时更改对象类型。如果您有基类的实例，那么它将保持基类类型。但是您可以在运行时创建新对象。使用组合而不是继承。

即，不是从您的基类继承，而是创建另一个对象层次结构 - 提取到新类（不是从您的基类继承）代码，该代码在您的基对象创建后发生变化。这可能是某种策略。然后在运行时为您的基对象提供不同的策略实现（即“专门化”基类实例）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:44:55.337

无法更改实例化对象的类型，但我看到 2 种可能的解决方法：
1\. 从您的初始工厂实例化另一个工厂，最终将创建所需类型的对象。
2\. 利用 Ruby 的“方法缺失”概念与 ExpandoObject。我不确定它是否适合您的情况。

# python - 在脚本中使用 Python 中的鼻子时覆盖现有配置

> ID：13790368
> 
> 赞同：1
> 
> 时间：2012-12-09T18:31:27.577
> 
> 标签：python, nose, nosetests

我正在尝试设置 Python 来执行鼻子，但仅限于我在本地开发**的现有应用程序。**我不希望鼻子在当前安装的所有库中跑来跑去。但是，我确实希望鼻子发现当前工作目录和子目录中的任何测试。

首先，我要做的就是确保正在使用我传递的参数（由下面的@need-batchelder 解决）。但是，目前看起来我传递的参数被忽略了，并且正在对测试进行全局发现（即也从 python 文件夹中获取测试。

从[文档](https://nose.readthedocs.org/en/latest/usage.html#options)：

```
 -V, --version
     Output nose version and exit 
```

从命令行运行 nosetests -V 会产生预期的版本输出：

```
 nosetests -V
     nosetests-script.py version 1.2.1 
```

但是，以下测试脚本开始运行它可以找到的每个测试，**包括安装在 python 路径中**而不是当前工作目录一部分的库，**即使它位于应用程序的根目录中**：

```
import nose, os

def main():
    print os.getcwd()
    x=raw_input() #This is just so I can see the output of the cwd before it launches into testing everything it can find.
    result = nose.run(argv=['-V']) 

if __name__ == '__main__':
    main() 
```

这是我尝试过的：

*   使用nose.main()、x=nose.core.run()、x=nose.run()。
*   将参数直接传递给 nose.run() 并使用列表。
*   使用nose.cfg 文件。

谢谢

**编辑：**尝试@ned-batchelder 的建议允许我使用给定的参数运行鼻子，但不允许在应用程序文件夹中发现测试。所以如果我这样做，我可以传递参数，但我不能测试我的应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T18:41:43.637

我相信鼻子希望 argv 是完整的 argv，这意味着第一个元素应该是程序的名称：

```
nose.run(argv=['me.py', '-V']) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T22:39:42.693

可能，你想要的是：

```
arguments = sys.argv[:1] + my_custom_argument_list + sys.argv[1:]
nose.run(argv=arguments) 
```

这将允许您使用自定义参数以及调用脚本的命令行中的参数。它还解决了 Ned 指出的关于 nose 要求第一个参数指向脚本的问题。

# c++ - 在某些情况下，我的快速排序实现失败

> ID：13790369
> 
> 赞同：0
> 
> 时间：2012-12-09T18:31:33.117
> 
> 标签：c++, algorithm, sorting, quicksort

我已经实现了一个快速排序算法，但是当我测试它时，我注意到当输入数组在第一个元素中具有最大元素时它会失败（这是我从中获得枢轴的元素）。这是我的代码：

```
void partition(int *a,int size){
    if(size<=1){return;}
    int pivot=a[0];
    int left=0,right=0;
    for(left=1,right=size-1;left<=right;){    //was size-1
        if(a[left]>=pivot&&a[right]<=pivot) {
            swap(left,right,a);
        }

        if(a[left]<pivot){left++;}
        if(a[right]>pivot){right--;}
    }
    swap(0,right,a);
    partition(a,right-1);
    partition(&(a[right+1]),size-right-1);
} 
```

它失败的一些示例：

```
I/P 245  111  32    4
O/P 4   111  32  245     `

I/P 154   11   43  3  7
O/P   7   11   43  3  154 
```

我犯了哪些可能的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:41:39.993

您错过了在分区函数中数组中有一个元素是枢轴的情况。

认为`arr = { 5, 5, 1 , 1, 5, }`

```
pivot = 5
iter1:
left=1, arr[left]=5 ; right=4,arr[right]=5
(swapping)
not increasing left nor decreasing right - since 5 < 5 == false ; 5 > 5 == false 
```

下一次迭代，同样的场景会重演，你实际上会得到一个无限循环。

处理它的一种方法是确定“大”部分还将增加所有恰好是枢轴的元素，如果 (not ) 则交换元素，如果( `arr[right] < pivot`not )则`<=`减少元素，例如：`right``arr[right] >= pivot``>`

```
...
for(left=1,right=size-1;left<=right;){    //was size-1      
        if(a[left]>=pivot&&a[right]<pivot) { 
        //                         ^ note < not <=
        swap(left,right,a);
    }

    if(a[left]<pivot){left++;}
    if(a[right]>=pivot){right--;}
    //        ^ note >=
}
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:53:16.470

好吧，问题出在这里：

```
partition(a,right-1); // <- It's partition(array,size)! 
```

将其更改为

```
partition(a,right); 
```

它会起作用。我想你知道原因。
要使分区功能正常工作，您必须提供 2 件事：

1）要处理的数组。
2）它具有的元素数量，大小。

问题在于对左子数组进行分区的第一次递归调用：  `partition(a,right-1)`

参数 2，即 `size`，被错误地指定为`right-1`，而实际上它是`right`。

这可以通过使用数组中从索引`a`到`b`（都包括在内`b>=a`） 的元素数是 的事实来计算`N= b-a+1`。

在这里，我们有`a=0`, `b=right-1`，因此左子数组中的元素数`size`, `N`= `(right-1)-(0)+1`= `right`。

因此，要正常工作，您必须将其称为`partition(a,right);`. 左子数组以 结尾`right-1`，但它有`right-1+1`=`right`元素。

一直在发生:)

# java - Java继承：为什么引用超类变量

> ID：13790377
> 
> 赞同：1
> 
> 时间：2012-12-09T18:32:04.677
> 
> 标签：java

我有一个超类“Sam”和一个子类“SubSam”

```
 public class Sam {

String msg;
String msg1;

Sam(String mm, String mm1) {
    msg = mm;
    msg1 = mm1;
}

@Override
public String toString() {
    return this.msg + "  " + this.msg1;
    }
}

class SubSam extends Sam {

String msg1="C";

public static void main(String[] args) throws Exception {
    SubSam obj = new SubSam();
    System.out.println(obj);
}

SubSam() {
    super("A", "B");
}
} 
```

输出是：

```
A  B 
```

为什么“toString()”指的是“Sam”的实例字段而不是“SubSam”。输出应为：AC

想了很久，还是没搞定？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:34:48.590

因为 Java 中的实例变量没有被覆盖，很简单。子类可以定义一个与其超类之一中定义的变量同名的变量，但对于所有意图和目的，它都算作一个单独的变量。

例如，考虑以下代码：

```
public class A {
    public String var;
}

public class B extends A {
    public int var;
} 
```

给定这些定义，实例`B`将有两个变量，一个是 type `String`，另一个是 type `int`，但两者都将被命名`var`。它们仍然是可以独立分配和读取的独立变量，Java 不认为这有什么问题。

如果您想按照您的意愿覆盖行为，则需要使用方法。例如，您可以这样做：

```
public class A {
    public String msg;
    private String msg1;

    public A(String mm, String mm1) {
        this.msg  = mm;
        this.msg1 = mm1;
    }

    public String msg1() {
        return(this.msg1);
    }

    @Override
    public String toString() {
        return(this.msg + " " + msg1());
    }
}

public class B extends A {
    public B() {
        super("A", "B");
    }

    @Override
    public String msg1() {
        return("C");
    }
} 
```

现在，如果您调用`System.out.println(new B());`，它将打印`A C`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:36:11.690

您没有覆盖 toString，因此调用了超类的 toString 方法。它打印超类的 msg 和 msg1，而不是子类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:39:34.767

您`msg1`在子类中设置，但在它的构造函数中您正在传递

```
super("A","B"); 
```

此时，在主类的构造函数中初始化的`super`变量是使用`this`关键字in`toString`方法使用的主类变量。

# java - Java尝试使用Period类获取2个日期之间的差异，不断获取Period无法解析为类型

> ID：13790378
> 
> 赞同：0
> 
> 时间：2012-12-09T18:32:05.280
> 
> 标签：java

我正在尝试制作倒数计时器。我打算使用 Period 类来获取 2 个 GregorianCalendar 日期之间的差异。

我不断收到句号无法解决类型错误。我假设这是因为我需要另一个导入。
我做了以下更改我的导入从 java.util.GregorianCalendar 到导入 java.util.*; 尝试添加 import java.util.Period;，它给出了错误

这必须是一个简单的修复，只是不能让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:01:41.980

该类无法解析为类型，因为该类未在您使用的 jre 中交付。据我所知，它绝对不包含在 java.util 包中（[java 6 util](http://docs.oracle.com/javase/6/docs/api/java/util/package-summary.html)，[java 7 util](http://docs.oracle.com/javase/7/docs/api/java/util/package-summary.html)）。
我看到[Joda 图书馆提供了一个](http://joda-time.sourceforge.net/api-release/org/joda/time/Period.html)*Period*课程。stackoveflow上有一个[类似的主题](https://stackoverflow.com/questions/1555262/calculating-the-difference-between-two-java-date-instances)，也许它对你有用。

# javascript - Javascript自动完成自动建议不起作用

> ID：13790384
> 
> 赞同：1
> 
> 时间：2012-12-09T18:32:43.953
> 
> 标签：javascript, autocomplete, ide

嗨，我对**JavaScript**、dom、html5 编程相当陌生。我已经尝试过一些 IDE，例如 Visual Studio for web 和 netbeans，但似乎无论我使用什么 IDE，它们都不能为`.value`或`.innerHTML`. 当我使用 ctrl+space 进行搜索时，他们就是找不到它们。示例如下：

```
//can't find .value after I type text-input
var songName = textInput.value;

//can't find .innerHTML
var li = document.createElement("li");
li.innerHTML = songName; 
```

这正常吗？我是否只需要手动输入这些内容，还是因为我没有包含必要的库以使 IDE 正常工作？

# c++ - 如何使用.bat文件在VS2010中添加环境变量？

> ID：13790389
> 
> 赞同：0
> 
> 时间：2012-12-09T18:33:15.873
> 
> 标签：c++, visual-studio-2010, batch-file, environment-variables, pre-build-event

我有一个包含以下代码的批处理文件：

```
@echo off
set VAR=7
echo the version is %VAR% 
```

我想使用预构建事件将此 .bat 文件添加到我的 Visual Studio 项目中。我在预构建事件中写了批处理文件的路径，但是当我输入：资源->预处理器定义-我看不到 VAR 如何添加它？任何帮助，将不胜感激！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:53:23.717

将您的 BAT 脚本更改为类似

```
echo #define VER 7 > version.h 
```

然后让你的代码使用

```
#include "version.h" 
```

# java - 无法写入文件

> ID：13790390
> 
> 赞同：0
> 
> 时间：2012-12-09T18:33:37.387
> 
> 标签：java, file-io

我需要一些帮助，请将输出写入文件，但我无法让它工作。如果我使用 System.out.println 它可以工作。如果我在实际方法中创建文件流和缓冲写入器，它会创建文件但不会向其中写入任何内容。我假设这是因为我的方法是递归的，并且每次该方法再次调用它时都会创建一个新文件。所以我创建了另一个打印方法并使用字符串值 key[i] 作为字符串参数，它什么也不做。

任何帮助表示赞赏，谢谢。

```
 public void print(String s)throws IOException
{
    fstream = new FileWriter("out.txt", true);
    out = new BufferedWriter(fstream);

    try{
        out.write("From print: " + s + " ");
        out.close();
    }catch (Exception e){//Catch exception if any
        System.err.println("Error: " + e.getMessage());
    }
}

public void generate() throws IOException
{ 
    while (k<randomWordNum())
    {
        if (randomNum() <= sumOfFreq[0])
        {
            //System.out.println(getKey[0] + " "); 
            print(getKey[i]);
            i++;
            k++;
            generate();
        }
        if (randomNum() >= sumOfFreq[i] && randomNum() <= sumOfFreq[i+1])
        {
            //System.out.println("From generate: " + getKey[i+1] + " "); 
            print(getKey[i+1]);
            i++;
            k++;
            generate();
        }
        else
        {
            i++;
            generate();
        }
    }//while
}//generate 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:35:36.450

您需要 .close 文件以确保写入内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:49:35.013

我认为构造函数`FileWriter`会覆盖文件。所以你需要使用这样的代码行：

```
fstream = new FileWriter("out.txt", true); // true for appending 
```

此外，始终在文件超出范围之前关闭文件，否则如果你不走运，它可能永远不会被刷新或关闭......

还有一件事，假设这不是某种调试/故障排除代码，“从不” catch `Exception`。如果您确实抓住了它，请务必在登录后重新扔掉它或您对它做了什么。但是，一般来说，总是捕获更具体的异常类型。

# linux - Linux Mandriva 上的 SVN - 从 Windows 网络浏览器访问远程存储库

> ID：13790394
> 
> 赞同：1
> 
> 时间：2012-12-09T18:34:06.790
> 
> 标签：linux, svn, redmine

我想从网络浏览器访问存储库，这样做 -

通过 WebDAV 访问。

密码文件：

```
 ...
    [users]
    harry = harryssecret
    sally = sallyssecret 
```

...

```
<VirtualHost remote-ip:81>
    <Location /svn>
      DAV svn
      SVNPath /home/svn
      AuthType Basic
      AuthName "...."
      AuthUserFile /etc/subversion/passwd
      Require valid-user
     </Location> 
</VirtualHost> 
```

然后重启 Apache：

```
ctlscript.sh restart apache 
```

来自 Windows 主机的请求：

```
http: //remote-ip:81/svn/test 
```

得到响应：

![在此处输入图像描述](../Images/aa937239569de0360f063020ff6c747c.png)

输入`harry`and `harryssecret`，但我得到：

> 401：需要授权

*此服务器无法验证您是否有权访问所请求的文档。要么您提供了错误的凭据（例如，错误的密码），要么您的浏览器不了解如何提供所需的凭据。*

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:54:17.963

> 我究竟做错了什么？

**一切**，从“不看[文档](http://svnbook.red-bean.com/en/1.7/svn.serverconfig.httpd.html)”开始

AuthUserFile 需要标准 Apache 的 passwd 文件，~~基于路径的 ACL（您*尝试*将其写入 passwd）需要 LoadModule 中的附加模块和附加指令`<Location>`~~，您的 passwd 文件来自 svn://-served repo for svnserve

我的实时系统示例（相关部分）

https.conf

```
AuthType Basic
AuthBasicProvider file
AuthUserFile ...htpasswd
AuthzSVNAccessFile ...authz

Satisfy Any
Require valid-user 
```

*   满足+要求 RO 匿名访问 repos
*   需要有效用户进行身份验证。写访问
*   AuthUserFile - 平面用户列表
*   AuthzSVNAccessFile - 基于路径的 ACL

密码

```
lazybadger:$apr1$5tg... 
```

（每个用户带有编码的用户名密码的字符串）

授权

```
[/]
*=r

[Elgg-Russian:/]
@Coders=rw

[Elgg-TranslationRU:/]
@Translators=rw

[Hello:/]
lazybadger=rw 
```

（SVN 位置中的组、子树，从默认访问权限更改）

# windows - Windows 批处理文件计时错误

> ID：13790398
> 
> 赞同：0
> 
> 时间：2012-12-09T18:34:29.910
> 
> 标签：windows, batch-file, timing

我以前用 %time% 来计时——至少我认为我有。我有这个奇怪的

```
IF NOT "%1" == "" (
    echo Testing: %1
    echo Start: %time%
    sqlcmd -S MYSERVER  -i test_import_%1.sql -o "test_%1%.log"
    sleep 3
    echo End:   %time%
) 
```

我运行它，它打印：

```
Testing: pm
Start: 13:29:45.30
End:   13:29:45.30 
```

在这种情况下，我的 sql 代码失败（不同的原因），但我认为 sleep 3 应该至少使时间增加 3。有任何想法吗？tx, tff

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:50:00.470

这与（不是）延迟扩展有关，但我不记得它是如何工作的。您可以通过使用这样的“子例程”来解决它：

```
@echo off
if "%1" == "" (
  call :doit
)

echo done
goto :eof

:doit
echo %time%
sleep 1
echo %time%
goto :eof 
```

输出：

```
C:\temp>q
19:46:36.43
19:46:37.45
done 
```

这样做的“正确”方式可能类似于（来自[Raymon Chen 的博客中的这篇文章](http://blogs.msdn.com/b/oldnewthing/archive/2006/08/23/714650.aspx)）：

```
setlocal enabledelayedexpansion
if "%1" == "" (
  echo !time!
  sleep 2
  echo !time!
) 
```

* * *

要“查看”立即扩展的问题，只需运行此（*不带* `echo off`）：

```
if "%1" == "" (
echo %time%
sleep 2
echo %time%
) 
```

输出（在 Windows 7 上）：

```
C:\temp>if "" == "" (
echo 19:48:31.95
 sleep 2
 echo 19:48:31.95
)
19:48:31.95
19:48:31.95 
```

`if`解析时，所有变量同时展开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:41:50.843

`Pause`根本不接受参数。它不会失败，但也不会继续。如果一切正常，您应该会看到一个按键提示。

你得到的时间，就是脚本启动的时间。显然`%time%`环境变量在脚本执行期间没有更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:55:18.180

DOS 没有“睡眠”功能。您需要将此添加到批处理文件的末尾（或类似的内容）：

```
@ECHO off
TITLE Initial title
SET TITLETEXT=Sleep
:: start of script
CALL :sleep 5
:: rest of script
GOTO :END
:: Function
:sleep ARG
ECHO Pausing...
FOR /l %%a in (%~1,-1,1) do (TITLE %TITLETEXT% -- time left %%as&PING.exe -n 2 -w 1 127.0.0.1>nul)
EXIT /B 0
:END
pause
::this is EOF 
```

我测试了这段代码，它应该可以正常工作。

# math - 这应该是溢出条件吗？

> ID：13790399
> 
> 赞同：0
> 
> 时间：2012-12-09T18:34:37.840
> 
> 标签：math, assembly, binary, emulation, cpu

我正在尝试编写一个 MOS 6502 8 位仿真器来更好地了解 CPU。

多亏了[这个问题](https://stackoverflow.com/questions/8034566/overflow-and-carry-flags-on-z80/8037485#comment18965304_8037485)的很多帮助，我已经实现了我的 ADC（带进位加法）指令。我的输出与问题答案的示例输出完全相同。

问题是，我现在不确定该答案是否存在错误，因为我认为 255 + 1 会导致进位和溢出（因为 255 + 1 = 256，而不是 0）。使用上面回答的问题中采用的方法，我只得到一个进位，而不是溢出。

哪个是对的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:43:35.917

不。根据链接的答案，当您对数字的符号解释溢出时，会设置溢出标志。(无符号)255 = 0xff = (有符号)-1。并且 -1 + 1 = 0 没有溢出。

# asp.net-mvc-4 - 使用 pushstate 进行部分视图分页时优雅地处理永久链接

> ID：13790400
> 
> 赞同：1
> 
> 时间：2012-12-09T18:34:46.043
> 
> 标签：asp.net-mvc-4, partial-views, permalinks, pushstate

当我的应用程序使用 pushstate 加载 ASP.NET MVC 部分视图进行分页时，我正在寻找一种处理永久链接的干净方法

如果我的控制器返回一个局部视图（当前），则永久链接将单独显示局部视图，而不显示由 _Layout.cshtml 定义的站点的其余部分。

如果我的控制器返回常规视图，则永久链接有效，但将整个页面加载到仅为部分页面提供的容器中会创建一种 Droste 效果。

我发现的唯一解决方案是将 404 重定向到主页并使用 url 的相关部分导航到正确的页面。

但是，这使我无法使用我的自定义错误页面（恰好是一个很棒的错误页面）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:17:01.833

好的，我想出了如何使用双控制器设置来完成这项工作。

NavigationController 处理 ajax 调用并返回部分视图（注意没有“索引”）

```
public class NavigationController : Controller
{
    public PartialViewResult Home()
    {
        return PartialView("Home", null);
    }

    public PartialViewResult About()
    {
        return PartialView("About", null);
    }

    ...
 } 
```

单独的 PermalinkController 通过返回整个常规视图来处理永久链接（注意这有一个“索引”但没有“主页”：

```
public class PermalinkController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult About()
    {
        return View();
    }

    ...
} 
```

路线：

```
 routes.MapRoute(
            "PermalinkRouter",
            "{action}",
            new { controller = "Permalink", action = "Index" },
            new { }
        );

        routes.MapRoute(
            "NavigationRouter",
            "Navigation/{action}/{id}",
            new { controller = "Navigation", action = "Home", id = UrlParameter.Optional },
            new { }
        ); 
```

意见：

~/Views/Shared/_Layout.cshtml：

```
...
<header></header>
<div id="pageViewContainer">
    @RenderBody()
</div>        
<footer></footer>
... 
```

~/Views/Navigation/Home.cshtml 部分视图：

```
<div> Home Content </div> 
```

~/Views/Permalink/Index.cshtml 视图：

```
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
 }

 @Html.Partial("~/Views/Navigation/Home.cshtml", null) 
```

# php - 安全有效地存储/提供网站图像

> ID：13790403
> 
> 赞同：2
> 
> 时间：2012-12-09T18:34:59.830
> 
> 标签：php, mysql, ubuntu, nginx, security

你好网络开发大师

在不影响性能的情况下安全地存储和提供图像的最佳做法是什么？

是否可以将用户图像存储在无法通过网络访问的文件夹中（可能更高，在 /www 之前？）并在用户登录页面后按需提供服务？已有用户名和密码访问机制。

用户不希望这些图像可公开访问。

我在 Ubuntu 上使用 php 运行 nginx。数据库是mysql。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:42:35.360

您可以使用 php 文件来提供这些图像，并在提供它们之前进行一些检查。我会尝试这样的事情：

```
<?php
if ( /* YOUR CHECK HERE */ ) {
    header('Content-Type: image/jpeg'); // Or whatever your content type might be
    readfile('/path/to/file');
} 
```

您可以使用 RewriteRule 使对 php 文件的调用看起来像真实图像：

```
rewrite /img/users/pictures/(.*) /your_php_file.php?path=$1 break; 
```

或类似的东西。

**这可能是安全的，但不是很有效，因为您的服务器必须访问两个文件。php文件和图像文件**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:07:36.660

执行此类操作的最有效方法可能是通过 Apache 重写。当用户登录时，您将一个条目添加到以用户会话 ID 为键的重写映射中。条目的值指向保存图像的目录。您将有一个重写规则，从 cookie 中解析出会话 id 并将 URL 重写到图像目录。实际上，您正在使目录仅对该用户进行网络访问。

任何涉及 Apache 重写的东西都是伏都教。除非你真的有那种流量，否则不值得这么复杂。通过 PHP 提供文件效率低下，但在许多情况下，效率低下是可以容忍的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:54:27.617

也许您应该评估使用像 Amazon S3 这样的 CDN，它通过 RESTful 身份验证提供安全访问：http: [//s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html](http://s3.amazonaws.com/doc/s3-developer-guide/RESTAuthentication.html)并避免您的服务器完成这项工作of 提供静态内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T19:18:16.380

这取决于您还有什么其他要求。您可能希望让您的用户通过发送链接来共享他们的图像，这样只有拥有此链接的人（即使在您的系统中没有经过身份验证）才能看到图像。您提出的实施将使这变得困难。

如果您不太担心可能的“泄漏”，您可以为您的图像生成随机名称，并将所有努力都放在真正的随机性上，这样就很难猜到图像名称。密码。一方面，您可以考虑这种“密码保护”，但请记住，您的路径将被缓存在代理、浏览器历史记录等中......所以这可能不是您的解决方案，具体取决于您所保护的资源。

# sql - 向抽象类型添加约束

> ID：13790406
> 
> 赞同：1
> 
> 时间：2012-12-09T18:35:17.467
> 
> 标签：sql, oracle, constraints, object-oriented-database

我有我创建的这种类型：

`create type baseType as Object(...) NOT Instantiable not Final`

我想为某些字段添加约束。问题是这种类型，`not instantiable`因此，我无法为其字段添加约束。那么，当我创建我的继承类型时

```
create type childType1 under baseType (...) 

create type childType2 under baseType  (...) 
```

我必须为所有子表添加约束。这是正确的方法吗？我认为有一种方法可以仅在父类型中添加对公共字段的约束。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T07:47:53.463

您根本无法向对象类型添加约束 - 约束在表上。如果对象不可实例化，则不能有基于它的表，因此对它没有约束。

我想答案是使对象类型可实例化。然后，您可以基于它创建一个带有约束的表。当然，这些约束不会被子类型“继承”。

尽管如此，我个人尽可能避免使用 Oracle 对象类型。

# java - Java：重新设计开源库的并发性

> ID：13790413
> 
> 赞同：0
> 
> 时间：2012-12-09T18:35:39.310
> 
> 标签：java, concurrency, transactional-memory

作为对 JVM STM 框架的一些分析的一部分，我正在考虑重新设计一个开源库的锁定机制以改用 STM。然后我会运行一些测试来比较性能、编码的易用性等。

显然，性能测试必须支持 STM 的乐观锁定，但可以在以后解决它的语义。

但是，就目前而言，我只对开源库候选者感兴趣。想到的一个是 EhCache，因为它具有内部锁定措施。

还有哪些合适的候选人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:49:42.253

我会假设STM

*   然而产生更优雅的代码
*   它比合理使用锁要慢得多。它可能比编写没有锁的单线程代码慢得多。

注意：STM 重新锁定可能会陷入死锁之类的情况，它永远无法获得所需的所有锁。

您很可能会发现 STM 还不够成熟，无法提供性能优势。

# javascript - html5 视频：javascript 在 window.onload 中错误地调整大小，但在其他地方正确？

> ID：13790414
> 
> 赞同：1
> 
> 时间：2012-12-09T18:35:37.667
> 
> 标签：javascript, html, onload

我正在调用一个函数，使用 window.onload，它将视频的 style.height 和 style.width 设置为窗口中可能的最大值（同时保持纵横比）。当在 onload 事件中调用它时，视频的左侧和右侧都有黑条，当浏览器调整大小时这些黑条仍然存在，并且从那时起似乎是视频（或其容器？）的一部分。

当我将“resizevid”函数退出 onload 并仅在 onresize 中调用它时，黑条不存在。

有想法该怎么解决这个吗？onload 事件改变了视频宽度的解释方式之后会发生什么？如果您能启发我，非常感谢！

整页的 url：在 onload 中使用 resizevid： [http](http://thebeach.name/video.html) : //thebeach.name/video.html 仅在 onresize 中使用 resizevid ：http: [//thebeach.name/videores.html](http://thebeach.name/videores.html)

代码摘录： 风格：

```
<style>
html, body, div, video{border:0px;margin:0px;padding:0px;background-color:black;vertical-align:top;text-align:center;}
video{width:100%}
</style> 
```

html:

```
<body onresize="resizevid();" align=center>
<video align=center id="myvideo" autoplay loop>
</video>
</body> 
```

脚本：

```
window.onload = function() {
changevid();
resizevid();
}

function resizevid(){

//find out the viewport size

var viewportwidth;
var viewportheight;

if (typeof window.innerWidth != 'undefined'){
    viewportwidth = window.innerWidth,
    viewportheight = window.innerHeight
}

 else if (typeof document.documentElement != 'undefined'
 && typeof document.documentElement.clientWidth !=
 'undefined' && document.documentElement.clientWidth != 0)
{
    viewportwidth = document.documentElement.clientWidth,
    viewportheight = document.documentElement.clientHeight
}

// older versions of IE

else
{
        viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
        viewportheight = document.getElementsByTagName('body')[0].clientHeight
}

//get the aspect ratio of the video

var vidwidth = document.getElementById('myvideo').offsetWidth;
var vidheight = document.getElementById('myvideo').offsetHeight;
var aspratio = vidheight/vidwidth;

//set video to full height, find correct width
function vidTooTall(){
    d=document.getElementById('myvideo');
    var newheight = viewportheight+'px';
    var newwidth = viewportheight/aspratio;
    newwidth = newwidth+'px';
    d.style.height = newheight;
    d.style.width = newwidth;
}

//set video to full width, find correct height
function vidTooWide(){
    d=document.getElementById('myvideo');
    var newwidth = viewportwidth+'px';
    var newheight = aspratio*viewportwidth;
    newheight = newheight+'px';
    d.style.height = newheight;
    d.style.width = newwidth;
}
//if windowheight/windowwidth < vidheight/vidwidth
//video is too tall, else video is too wide

if(viewportwidth*aspratio>viewportheight){
        vidTooTall();
    }
else{
        vidTooWide();
}

} 
```

# jquery - 隐藏（）之后的 JQuery 显示（）

> ID：13790416
> 
> 赞同：3
> 
> 时间：2012-12-09T18:35:54.800
> 
> 标签：jquery, text, hide, show

HTML：

```
<table id="table1">
    <tr>
        <th>1</th>
        <th>2</th>
        <th>3</th>
    </tr>
    <tr>
        <td class="table1column1"><input type="text" id="idInput1" /></td>
        <td class="table1column2"><input type="text" id="idInput2" /></td>
        <td class="table1column3"><input type="text" id="idInput3" /></td>
        </tr>
</table>
<button>Hide-Text-Show</button> 
```

查询：

```
$(document).ready(function() {
    $('button').click(function() {
        $('#idInput1').hide();
        $('.table1column1').text('Test');
        $('#idInput1').show();
    });
}); 
```

[http://jsfiddle.net/QNxyG/](http://jsfiddle.net/QNxyG/)

我不明白为什么当我在 td 元素中添加文本时， show() 方法不起作用？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:39:17.917

因为随着`.text()`您覆盖`#idInput1`元素（*它被删除*），所以下一个`$('#idInput1')`找不到要显示的元素..

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T18:40:37.763

[http://jsfiddle.net/QNxyG/4/](http://jsfiddle.net/QNxyG/4/)

使用 .text() 您可以覆盖示例中的任何内容...因此输入不再存在

HTML

```
<table id="table1">
    <tr>
        <th>1</th>
        <th>2</th>
        <th>3</th>
    </tr>
    <tr>
        <td class="table1column1"><span class="text" style="display:none;"></span><input type="text" id="idInput1" /></td>
        <td class="table1column2"><span class="text" style="display:none;"></span><input type="text" id="idInput2" /></td>
        <td class="table1column3"><span class="text" style="display:none;"></span><input type="text" id="idInput3" /></td>
    </tr>
</table>

<button>Hide-Text-Show</button> 
```

jQuery

```
$(document).ready(function() {
    $('button').click(function() {
        var input = $('#idInput1');
        var text = input.parent('td').find('.text');
        text.text('text');
        text.toggle();
        input.toggle();
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:42:48.350

```
$(document)
    .ready(function () {
    $('button')
        .click(function () {
        $('#idInput1')
            .hide(function () {
            $('.table1column1 input')
                .val('Test', function () {
                $('#idInput1')
                    .show();
            });
        });
    });
}); 
```

# javascript - javascript在画布上消失的对象

> ID：13790417
> 
> 赞同：1
> 
> 时间：2012-12-09T18:35:57.720
> 
> 标签：javascript

我正在编写一个脚本来绘制太阳的图像，并有一个围绕它的地球轨道的图像。

我已经这样定义了一个行星类：

```
function planet(name, size, rotateRate, startx, starty, colour, scale, oRad, oAng, oSpd){//container class for planets
this.name = name;
this.rotateRate = rotateRate;
this.x = startx;
this.y = starty;
this.colour = colour;
this.scale = scale;
this.size = size;
this.orbitRadius= oRad;
this.orbitAngle = oAng;
this.orbitSpeed = oSpd;
this.drawByArc = 
    function drawArcCircle(){//draws circles using the arc method
        context.save();
        context.strokeStyle = '#000000';
        context.fillStyle = this.colour;
        context.lineWidth=3;
        context.beginPath();
        context.arc(this.x,this.y,this.size*this.scale,0,Math.PI * 2,false)
        context.stroke();
        context.fill();
        context.closePath();
        context.restore();
    }
    } 
```

现在我在程序中创建了该类的两个实例，并使用以下函数很好地绘制了它们：

```
function gameLoop(){//The Game Loop
var thisTime = Date.now();//current time
var deltaTime = thisTime - lastTime;//find difference, not yet used
update();
draw();
lastTime = thisTime;
setTimeout(gameLoop, 1000/60);
}

function draw(){// Draws all the objects
    drawBackground();
    Sun.drawByArc();
    Earth.drawByArc();
}

function update(){// Updates for animation
//var newRotation = this.getCurrantRotation() + (this.getRotationRate()*deltaTime);
var gSegments;
gScale = 4;
simSpeed = 10;
Sun.scale = gScale;
Earth.scale = gScale;
Earth.orbitSpeed = 360/simSpeed;
//Earth.x = Sun.x + Earth.orbitRadius * Math.cos(Earth.orbitAngle * Math.pi / 180);
//Earth.y = Sun.y - Earth.orbitRadius * Math.sin(Earth.orbitAngle * Math.pi / 180);
} 
```

当我注释掉更新方法的最后两行时，两个圆圈都画得很好，但是当我添加最后两行以尝试更新地球在轨道上的位置时，当我尝试在 chrome 中运行代码时地球球消失！

Chrome 调试器没有显示任何错误，所以我不知道它为什么会发生。

编辑::

好吧，我发现由于一个小的输入错误（math.pi 而不是 Math.PI），我的行星 x 和 y 值变成了 NaN。

但是现在我的地球被困在其轨道上的 90 度角，根本不动，至少它在画，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T20:00:04.960

解决了。

大多数问题来自使用 math.pi 而不是 Math.PI 最重要的是，我没有设置一个值来改变轨道角度，这意味着轨道始终保持在 90，因此没有轨道。

Chrome 调试非常帮助我弄清楚这一切，非常感谢 user1816548

# java - java打印图像文件

> ID：13790418
> 
> 赞同：0
> 
> 时间：2012-12-09T18:35:57.650
> 
> 标签：java, printing, thermal-printer

我正在使用 java print API 将图像和一些文本打印到热敏打印机。我尝试使用 Printable 界面，但无法绘制字符串和图像。所以我从文件系统中读取了一个文件，然后直接打印出来。有单独的打印命令来打印图像和文本。这是我使用的代码

```
try {
textStream = new FileInputStream("C:\\logs\\qrcode.gif"); 
} catch (FileNotFoundException ffne) { 
} 
if (textStream != null && printer != null) { 
    DocFlavor myFormat = DocFlavor.INPUT_STREAM.GIF;
    // Create a Doc

    Doc myDoc = new SimpleDoc(textStream, myFormat, null); 
    DocPrintJob job = printer.createPrintJob(); 

    try {
           job.print(myDoc,set);
    } catch (PrintException e) {
        logger.log(Level.SEVERE,e.getMessage(),e);
    }
} 
```

图像尺寸为 360 X 360，打印机分辨率为 180DPI，但要打印的图像非常小

这是一张图片[http://i.stack.imgur.com/oK3sX.jpg](http://i.stack.imgur.com/oK3sX.jpg)

但是当我直接打印图像文件时，它会占用整页。（您可以选择将页面打印到整个框架的选项）。如何使用 Java 做同样的事情？我还实现了可打印界面，但打印的图像向右移动。我无法在左端对齐它（当我在 0,0 处使用 drawImage 时，它​​是从中间绘制的，因此不会出现在整个页面上）。

# python - 跨设备数据匹配不同的时间戳约定

> ID：13790421
> 
> 赞同：0
> 
> 时间：2012-12-09T18:36:17.347
> 
> 标签：python, time

我需要分析一些存储在 csv 文件中的数据。每个文件代表 3 个设备的输出，每个设备具有不同的数据采样率和不同的时间戳约定。我想匹配每个 csv 文件中的时间戳，以便我可以将来自单个主题的所有数据整理到单个文件中，并使用它放入 R。

不同的时间戳约定如下

设备 1（皮肤电反应）：

```
04/12/2012 14:17 
```

设备 2（心率监测器）：

```
14:16:13 
```

设备 3（我们要求受试者执行的实际任务）：

```
134941 
```

我认为这意味着 13:49:41。

我知道每个实验的执行日期，所以这正是我需要匹配的时间。

数据代表心率、受试者的皮肤电反应和用户输入平板电脑的结果。我需要将他们在任务中的表现与皮肤电导率和心率的变化联系起来——因此我需要匹配这些时间。

例如，根据我们使用的各种实验条件，每个人有一个用于皮肤反应的文件和一个单独的心率，但有多个文件（具有相似的时间）用于我们的任务性能。我宁愿不亲自执行此匹配任务，因为这些文件大约有 300 个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:40:58.043

使用[time](http://docs.python.org/2/library/time.html#module-time)模块的**strptime()**方法将日期解析为时间对象，并使用**strftime()**以特定格式打印出来（如果需要）。

例子：

```
import time

device1 = '04/12/2012 14:17'
device2 = '14:16:13'
device3 = '134941'

time1 = time.strptime(device1, '%m/%d/%Y %H:%M')
time2 = time.strptime(device2, '%H:%M:%S')
time3 = time.strptime(device3, '%H%M%S') 
```

请注意，任何仅小时/分钟/秒或其任何子集的解析时间将默认具有 1900-01-01 的日期。但是，如果您所做的只是从已解析的 struct_time 对象中提取时间部分，则不会影响您。否则，您需要在解析字符串时为它们分配正确的日期：

```
time2 = time.strptime('04/12/2012 ' + device2, '%m/%d/%Y %H:%M:%S') 
```

# c# - c# MySql.Data 未加载

> ID：13790426
> 
> 赞同：2
> 
> 时间：2012-12-09T18:36:51.767
> 
> 标签：c#, mysql, c#-4.0

```
using System;
using MySql.Data.MySqlClient;
namespace Input
{
    class MainClass
    {
        public static void Main (string[] args)
        {
            string connectionString = "server=SQL09.FREEMYSQL.NET;database=m44m31;uid=m44m31;pwd=*******"; 
            MySqlConnection conn = new MySqlConnection(connectionString);
            try
            {
                conn.Open();
            }
            catch
            {
                Console.WriteLine("Failed to connect");
            }
        }
    }
} 
```

有我的代码，这是我不断收到的错误...我在 ubuntu 上使用单声道：

```
Unhandled Exception: System.IO.FileNotFoundException: Could not load file or assembly 'MySql.Data, Version=6.5.5.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d' or one of its dependencies.
File name: 'MySql.Data, Version=6.5.5.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d'
[ERROR] FATAL UNHANDLED EXCEPTION: System.IO.FileNotFoundException: Could not load file or assembly 'MySql.Data, Version=6.5.5.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d' or one of its dependencies.
File name: 'MySql.Data, Version=6.5.5.0, Culture=neutral, PublicKeyToken=c5687fc88969c44d' 
```

我真的不知道该怎么做，并且到处搜索，请帮助！

```
 [assembly: AssemblyVersion ("6.5.5.0")]
[assembly: InternalsVisibleTo ("MySql.Data.Tests, PublicKey = 0024000004800000940000000602000000240000525341310004000001000100d973bda91f71752c78294126974a41a08643168271f65fc0fb3cd45f658da01fbca75ac74067d18e7afbf1467d7a519ce0248b13719717281bb4ddd4ecd71a580dfe0912dfc3690b1d24c7e1975bf7eed90e4ab14e10501eedf763bff8ac204f955c9c15c2cf4ebf6563d8320b6ea8d1ea3807623141f4b81ae30a6c886b3ee1")]
[assembly: AssemblyConfiguration ("")]
[assembly: AssemblyKeyName ("ConnectorNet")]
[assembly: InternalsVisibleTo ("MySql.Data.CF.Tests, PublicKey = 0024000004800000940000000602000000240000525341310004000001000100d973bda91f71752c78294126974a41a08643168271f65fc0fb3cd45f658da01fbca75ac74067d18e7afbf1467d7a519ce0248b13719717281bb4ddd4ecd71a580dfe0912dfc3690b1d24c7e1975bf7eed90e4ab14e10501eedf763bff8ac204f955c9c15c2cf4ebf6563d8320b6ea8d1ea3807623141f4b81ae30a6c886b3ee1")]
[assembly: InternalsVisibleTo ("MySql.Data.Entity, PublicKey = 0024000004800000940000000602000000240000525341310004000001000100d973bda91f71752c78294126974a41a08643168271f65fc0fb3cd45f658da01fbca75ac74067d18e7afbf1467d7a519ce0248b13719717281bb4ddd4ecd71a580dfe0912dfc3690b1d24c7e1975bf7eed90e4ab14e10501eedf763bff8ac204f955c9c15c2cf4ebf6563d8320b6ea8d1ea3807623141f4b81ae30a6c886b3ee1")]
[assembly: Debuggable (DebuggableAttribute.DebuggingModes.IgnoreSymbolStoreSequencePoints)]
[assembly: CompilationRelaxations (8)]
[assembly: RuntimeCompatibility (WrapNonExceptionThrows = true)]
[assembly: TargetFramework (".NETFramework,Version=v4.0", FrameworkDisplayName = ".NET Framework 4")]
[assembly: AssemblyDescription ("ADO.Net driver for MySQL")]
[assembly: AssemblyCompany ("Oracle")]
[assembly: AssemblyProduct ("")]
[assembly: AssemblyCopyright ("Copyright © 2004, 2010, Oracle and/or its affiliates. All rights reserved.")]
[assembly: AssemblyTrademark ("")]
[assembly: ComVisible (false)]
[assembly: CLSCompliant (false)]
[assembly: AssemblyTitle ("MySql.Data.dll")]
[assembly: AllowPartiallyTrustedCallers ]
[assembly: SecurityRules (SecurityRuleSet.Level1)]
[assembly: AssemblyDelaySign (false)] 
```

它被添加到程序集中^^^^

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:39:11.843

看来您对 MySql.Data dll 的引用已损坏。验证 .csproj 文件是否包含对正确 dll 的引用以及该 dll 是否存在于正确的位置。如果这不能解决您的问题，请发布更多信息！

# java - 如何在java中使我的数据保持一致

> ID：13790432
> 
> 赞同：-5
> 
> 时间：2012-12-09T18:37:14.087
> 
> 标签：java

例如，如果我有不同行的地址字段，例如

```
(Ho. #  103 street #  65 Saat meel Kalar RAWALPINDI), 
(h no. 732 St. No. 55 Mor gha RAWALPINDI),
(h# 611 St. # 57  old lalazar RAWALPINDI) 
```

那我怎样才能让它独一无二

```
(Ho. # 103 street # 65 Saat meel Kalar RAWALPINDI), 
(Ho. # 732 Street # 55 Mor gha RAWALPINDI),
(Ho. # 611 Street # 57 old lalazar RAWALPINDI) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:41:20.413

看起来你并没有试图让它“独一无二”，而是就像标题所说的“一致”。

这很难做到。您需要做的是解析数据，允许使用不同类型的标识字符串。例如，对于房子，看起来您想要接受`"Ho. #"`、`"h no."`和`"h#"`。

一旦你解析了数据，你可以以任何你想要的方式存储它（可能在数据库中）。然后您可以自由地以您希望的任何格式输出它（如您的最后一个示例）。

没有任何内置功能可以神奇地为您做到这一点。

伪代码看起来像这样：

```
input = input.toLower()

house_ids = ['ho. #', 'h no.', 'h#']

p = start of string
While data left in string:
    if string_at(p) is one of house_ids:
        advance p
        house_num = number_at(p)
    // street, etc. 
```

# c++ - 在一个简单的 Rush Hour 求解器中使用 BFS - 为什么我的代码不能求解电路板？

> ID：13790433
> 
> 赞同：1
> 
> 时间：2012-12-09T18:37:18.913
> 
> 标签：c++, breadth-first-search

更新 - 主要问题由下面的回复者解决（我有一个'='，我应该有一个'=='），但现在我得到了错误的输出。我想我会按照建议提供一些输入/输出示例，所以也许有人可以发现我哪里出错了。

假设我输入输入：

```
......

......

xx....

......

......

...... 
```

这应该产生输出：

```
4

x r

x r

x r

x r 
```

表示 x 在 4 步中到达了第 3 行的最右边的位置，并且 x 必须每步向右移动。

相反，我得到了输出：

```
3

x r

x l

x r 
```

在下面的代码中，程序接受一个 6x6 的字符块来表示游戏板。（句号是空格，字符代表汽车。）在板类和主要功能中完成的工作是正确的，因为我已经与我的教授核实过。但是，我正在尝试纠正我的输出。我知道我在求解函数中使用的逻辑不是最好的方法，但我必须尝试让它发挥作用，这样我就可以在不复制教授的解决方案的情况下拿回分数。

```
#include <iostream>
#include <string>
#include <queue>
#include <set>
#include <list>

using namespace std;

class board
{
public:
board() {count = 0;}

bool isSolved()
{
    return currState[17] = 'x';
}

string currState;
string moveList;
int count;
};

bool operator < (const board& board1, const board& board2)
{
return board1.currState < board2.currState;
}

void solve (const board& curr, int i, list<board>& toTest, const set<board>& testedSet, bool vert)
{
board newMove(curr);

if (vert == false)
{
if (i % 6 == 0 && curr.currState[i] != '.')
{
    if (curr.currState[i] == curr.currState[i+1] && curr.currState[i+2] == '.')
    {
        newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
        newMove.currState[i+2] = newMove.currState[i];
        newMove.currState[i] = '.';
        newMove.count++;
    }

    if (curr.currState[i] == curr.currState[i+1] && curr.currState[i] == curr.currState[i+2] && curr.currState[i+3] == '.')
    {
        newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
        newMove.currState[i+3] = newMove.currState[i];
        newMove.currState[i] = '.';     
        newMove.count++;
    }
}

else if ((i + 1) % 6 == 0 && curr.currState[i] != '.')
{
    if (curr.currState[i] == curr.currState[i-1] && curr.currState[i-2] == '.')
    {
        newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "l" + "\n";
        newMove.currState[i-2] = newMove.currState[i];
        newMove.currState[i] = '.';
        newMove.count++;
    }

    if (curr.currState[i] == curr.currState[i-1] && curr.currState[i] == curr.currState[i-2] && curr.currState[i-3] == '.')
    {
        newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "l" + "\n";
        newMove.currState[i-3] = newMove.currState[i];
        newMove.currState[i] = '.';
        newMove.count++;
    }
}

else
{
    if (i % 2 != 0 && i % 3 != 0 && curr.currState[i] != '.')
    {
        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i-1] == '.' && curr.currState[i+2] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "l" + "\n";
            newMove.currState[i-1] = newMove.currState[i];
            newMove.currState[i+1] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i+2] == '.' && curr.currState[i-1] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
            newMove.currState[i+2] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i] == curr.currState[i+2] && curr.currState[i-1] == '.' && curr.currState[i+3] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "l" + "\n";
            newMove.currState[i-1] = newMove.currState[i];
            newMove.currState[i+2] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i] == curr.currState[i+2] && curr.currState[i+3] == '.' && curr.currState[i-1] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
            newMove.currState[i+3] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }
    }

    if (i % 2 == 0 && (i + 2) % 6 != 0 && curr.currState[i] != '.')
    {

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i-1] == '.' && curr.currState[i+2] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "l" + "\n";
            newMove.currState[i-1] = newMove.currState[i];
            newMove.currState[i+1] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i+2] == '.' && curr.currState[i-1] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
            newMove.currState[i+2] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i] == curr.currState[i+2] && curr.currState[i+3] == '.' && curr.currState[i-1] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
            newMove.currState[i+3] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }
    }

    if (i % 3 == 0 && curr.currState[i] != '.')
    {
        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i-1] == '.' && curr.currState[i+2] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "l" + "\n";
            newMove.currState[i-1] = newMove.currState[i];
            newMove.currState[i+1] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+1] && curr.currState[i+2] == '.' && curr.currState[i-1] != curr.currState[i])
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "r" + "\n";
            newMove.currState[i+2] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }
    }
}
}

if (vert == true)
{
    if (i < 17)
    {
        if (curr.currState[i] == curr.currState[i+6] && curr.currState[i] == curr.currState[i+12] && curr.currState[i+18] == '.')
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "d" + "\n";
            newMove.currState[i+18] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i+6] && curr.currState[i+12] == '.')
        {
            if (i < 6 || curr.currState[i] != curr.currState[i-6])
            {
                newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "d" + "\n";
                newMove.currState[i+12] = newMove.currState[i];
                newMove.currState[i] = '.';
                newMove.count++;
            }
        }
    }

    if (i > 17)
    {
        if (curr.currState[i] == curr.currState[i-6] && curr.currState[i] == curr.currState[i-12] && curr.currState[i-18] == '.')
        {
            newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "u" + "\n";
            newMove.currState[i-18] = newMove.currState[i];
            newMove.currState[i] = '.';
            newMove.count++;
        }

        if (curr.currState[i] == curr.currState[i-6] && curr.currState[i-12] == '.')
        {
            if (i > 29 || curr.currState[i] != curr.currState[i+6])
            {
                newMove.moveList = newMove.moveList + newMove.currState[i] + " " + "u" + "\n";
                newMove.currState[i-12] = newMove.currState[i];
                newMove.currState[i] = '.';
                newMove.count++;
            }
        }
    }

}

if (testedSet.find(newMove) == testedSet.end())
    toTest.push_back(newMove);
}

int main()
{
list<board> toBeTested;
string input;
board current;
set<board> tested;
bool vertical = false;

for (int i = 0; i < 6; i++)
{
    getline(cin, input);
    current.currState += input;
}

toBeTested.push_back(current);

while (toBeTested.size() > 0 && current.isSolved() == false)
{
    current = toBeTested.front();
    toBeTested.pop_front();

    if (current.isSolved() == false && tested.find(current) == tested.end())
    {
        tested.insert(current);

        for (int i = 0; i < 36; i++)
        {
            solve(current, i, toBeTested, tested, vertical);
            vertical = true;
            solve(current, i, toBeTested, tested, vertical);
            vertical = false;
        }

    }
}

if (current.isSolved() == false)
    cout << current.count << endl << current.moveList;
else
    cout << -1 << endl;

return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:10:40.527

很难弄清楚您在这里尝试做什么，因为许多值都是硬编码的，并且程序中没有使用很多抽象。

我猜你正在尝试做类似[http://www.theiling.de/projects/rushhour.html](http://www.theiling.de/projects/rushhour.html)的事情，其中​​输入是一个板，如：

```
aaobcc
..ob..
xx...
deeffp
d..kp
hh.kp

```

如果您对`board::isSolved()`我的评论进行更正：

```
bool isSolved()
{
    return currState[17] == 'x';
} 
```

你至少会得到-1以外的东西：

```
10
BD
分类
小时
普
普
普
FR
苦
升
小时

```

但是，这不是输入问题的解决方案。

看起来您没有正确计算下一个状态。移动车辆后，应该有一个循环遍历车辆的每一部分。

绝对尝试抽象更多细节。例如，也许您可​​以将方法添加到`board`(1) 计算有效移动列表和 (2) 应用单个移动，返回一个新的`board`. 此外，如果您还没有学会如何使用诸如 之类的调试器，那么`gdb`现在将是开始学习的绝佳时机。请参阅[如何使用 MinGW gdb 调试器在 Windows 中调试 C++ 程序？](https://stackoverflow.com/q/4671900/196844)

# jquery - Jquery，如何属性两个或多个输入名称并更改其值

> ID：13790434
> 
> 赞同：0
> 
> 时间：2012-12-09T18:37:22.330
> 
> 标签：jquery, attr, each

请我有以下标记：

```
<div class="closet">
   <input name="hello1" class="input" />
</div>

<div class="closet">
   <input  name="hello2" class="input" />
</div> 
```

我想为输入名称赋予属性并设置另一个值（例如 hello5 和 hello6），所以这是我的代码：

```
var i = 5;
$('.closet').each(function (k) 
{
    i++;

   $('.input').attr('name', 'hello'+i);
}); 
```

但它给我的两个输入值“hello6”的问题。

请问您有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:38:45.597

代替

```
$('.input').attr('name', 'hello'+i); 
```

和

```
$('.input', this).attr('name', 'hello'+i); 
```

所以要改变你的迭代所在`.input`的内部`.closet`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:40:06.280

您已经可以访问`each()`循环内的索引和元素：

```
$('.closet').each(function(index, elem)  {
   $('.input', elem).attr('name', 'hello'+(index+5));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T18:40:33.380

代替

```
$('.input').attr('name', 'hello'+i); 
```

应该

```
$(this).find('.input').attr('name', 'hello'+i); 
```

# mongoose - Mongoose 中的 document.get("nested.value")、document.get("nested").value 和 document.nested.value 有什么区别？

> ID：13790446
> 
> 赞同：0
> 
> 时间：2012-12-09T18:38:19.973
> 
> 标签：mongoose, getter

假设我有一个这样的模式和对象：

```
var documentSchema = new mongoose.Schema({
    simple: { type: String },
    nested: {
        value: { type: Number }
    }
}; 
```

那么以下和我应该使用哪一个之间有什么区别？

```
console.log( document.nested.value );
console.log( document.get('nested').value );
console.log( document.get('nested.value') ); 
```

它们都产生相同的结果。我想我应该使用`get()`，但有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:45:16.123

[`get`](http://mongoosejs.com/docs/api.html#document_Document-get)可以采用第二个参数来支持动态转换，但如果您不需要它，则通常不需要`get`直接使用，因为点表示法等效且更清晰。

# c# - C# tcp server-client，无法发送消息

> ID：13790447
> 
> 赞同：3
> 
> 时间：2012-12-09T18:38:27.127
> 
> 标签：c#, tcp, client-server

C# 客户端无法将消息写入服务器，我认为将字节解析为字符串是错误的。我通过 ipaddress 和端口使用 connect 方法在客户端类中连接。但是我开始编译服务器没有改变，但客户端会关闭。

这是我的服务器：

```
class Server
{
    private TcpListener tcpListener;
    private Thread listenThread;

    public Server()
    {
        this.tcpListener = new TcpListener(IPAddress.Parse("10.0.0.44"), 3000);
        this.listenThread = new Thread(new ThreadStart(ListenForClients));
        this.listenThread.Start();
    }

    private void ListenForClients()
    {
        this.tcpListener.Start();

        while (true)
        {
            //blocks until a client has connected to the server
            TcpClient client = this.tcpListener.AcceptTcpClient();

            //create a thread to handle communication
            //with connected client
            Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientComm));
            Thread clientThreadSend = new Thread(new ParameterizedThreadStart(HandleClientComm));
            clientThread.Start(client);
            clientThreadSend.Start(client);
        }
    }

    private void HandleClientComm(object client)
    {
        TcpClient tcpClient = (TcpClient)client;
        TcpClient sendClient = (TcpClient)client;
        NetworkStream clientStream = tcpClient.GetStream();

        byte[] message = new byte[4096];
        int bytesRead;

        while (true)
        {
            bytesRead = 0;

            try
            {
                //blocks until a client sends a message
                bytesRead = clientStream.Read(message, 0, 4096);
            }
            catch
            {
                //a socket error has occured
                break;
            }

            if (bytesRead == 0)
            {
                //the client has disconnected from the server
                break;
            }

            //message has successfully been received
            ASCIIEncoding encoder = new ASCIIEncoding();
            System.Diagnostics.Debug.WriteLine(encoder.GetString(message, 0, bytesRead));

            Console.WriteLine("To: " + tcpClient.Client.LocalEndPoint);
            Console.WriteLine("From: " + tcpClient.Client.RemoteEndPoint);
            Console.WriteLine(encoder.GetString(message, 0, bytesRead));
            clientStream.Flush();
            sendToClient("Test back", sendClient);
        }

        tcpClient.Close();
    }

    public void sendToClient(String line, TcpClient client)
    {
        try
        {
            NetworkStream stream = client.GetStream();
            ASCIIEncoding encoder = new ASCIIEncoding();
            byte[] buffer = encoder.GetBytes(line + "\0");

            stream.Write(buffer, 0, buffer.Length);
            stream.Flush();
        }
        catch
        {
            Console.WriteLine("Client Disconnected." + Environment.NewLine);

        }
    }

    public void broadcast(String line, TcpClient thisClient)
    {
        sendToClient(line, thisClient);
    }

    static void Main(string[] args)
    {
        new Server();
    }
} 
```

这是我的客户：

```
public class Client
{
    TcpClient _tcpClient;

    // Connects the client to a server at the specified
    // IP address and port.
    public void Connect(IPAddress address, int port)
    {
        _tcpClient = new TcpClient();

        IPEndPoint serverEndPoint = new IPEndPoint(address, port);

        _tcpClient.Connect(serverEndPoint);

        // Create a thread to read data sent from the server.
        ThreadPool.QueueUserWorkItem(
           delegate
           {
               Read();
           });
    }

    // Sends bytes to the server.
    public void Send(byte[] buffer)
    {
        _tcpClient.GetStream().Write(
           buffer, 0, buffer.Length);

        _tcpClient.GetStream().Flush();
    }

    public void Read()
    {
        ASCIIEncoding encoder = new ASCIIEncoding();
        byte[] buffer = new byte[4096];
        int bytesRead;
        while (true)
        {
            bytesRead = _tcpClient.GetStream().Read(buffer, 0, 4096);
            Console.WriteLine(encoder.GetString(buffer, 0, bytesRead));
        }
    }

    public void Dispose()
    {
        _tcpClient.Close();
    }

    public static void Main(string[] args)
    {
        Client c = new Client();
        c.Connect(IPAddress.Parse("10.0.0.44"), 3000);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:44:18.600

**僵局**

您`client`没有发送数据，也无法发送**任何**数据，因为它被阻止了`server``send`

```
bytesRead = clientStream.Read(message, 0, 4096); 
```

# couchdb - 使用 node.couchapp.js 将默认数据推送到 CouchDB 的预期方式

> ID：13790451
> 
> 赞同：2
> 
> 时间：2012-12-09T18:38:37.133
> 
> 标签：couchdb, couchapp

我有一个正在编写的沙发应用程序，并且正在使用 node.couchapp.js ( [https://github.com/mikeal/node.couchapp.js](https://github.com/mikeal/node.couchapp.js) ) 将文件（附件、视图等）从文件系统推送到沙发数据库。我也想推非设计文件；这样做的预期方式是什么？

编辑：

这大致就是我对 app.js ATM 的要求：

```
ddoc = { _id:'_design/app' };

couchapp.loadAttachments(ddoc, path.join(__dirname, 'attachments'));

module.exports = ddoc; 
```

这是我的data.json：

```
[
    { "_id": "doc1" },
    { "_id": "doc2" },
    { "_id": "doc3" },
    ...
    { "_id": "docN" },
]
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-09T20:40:41.917

只需指定不带前缀的文档 ID `_design/`，它将被视为常规文档。

# java - 我的 Java 代码无法编译 - 我有一个错误，我不明白为什么

> ID：13790452
> 
> 赞同：0
> 
> 时间：2012-12-09T18:38:37.207
> 
> 标签：java, sorting

```
package test;

   /* Read numbers from a text file and store them into an array; then
  sort the array and display it on the screen. Save the sorted array
in sorted.txt. */ 

import java.util.Scanner;
import java.io.*;

public class Test {

 static public void main(String[] args) throws IOException {

    /* Initialize the input stream reading from a text file */

Scanner inputFile; 
    inputFile = new Scanner(new File("arrayex1.txt"));

    /* Initialize the output stream writing into a text file */

PrintWriter outputFile;
outputFile = new PrintWriter(new FileWriter("sorted.txt"));

    /* Declare the array */

int[] numbers = new int[50];
int index = 0;

    int temp, smallest, smallest_index;

    /* Read the first number */
    numbers[index] = inputFile.nextInt();

    while (numbers[index] != 0) {

        index++;
        numbers[index] = inputFile.nextInt();

    }

    /* Sort the array using the selection sort method; the inner 
       loop finds the smallest unsorted number, and the outer
       loop places it in the right place. */ 

    for (int i = 0; i < index - 1; i++) {

        smallest = numbers[i];
        smallest_index = i;

        for (int j = i + 1; j < index; j++) {

        if (numbers[j] < smallest) { 
                smallest = numbers[j];
                smallest_index = j;
            }
        }

        /* If needed switch numbers[i] and numbers[smallest_index] */

        if (numbers[i] != numbers[smallest_index]) {

            temp = numbers[i];
            numbers[i] = numbers[smallest_index];
            numbers[smallest_index] = temp;
        }
    }

    /* Display the sorted array and also save the result in sorted.txt*/

    for (int i = 0; i < index; i++) {          
    System.out.print (numbers[i] + " ");
        outputFile.print (numbers[i] + " ");
    }

    inputFile.close();
    outputFile.close();

 }
  } 
```

这是错误获取：

```
Exception in thread "main" java.util.NoSuchElementException
at java.util.Scanner.throwFor(Unknown Source)
at java.util.Scanner.next(Unknown Source)
at java.util.Scanner.nextInt(Unknown Source)
at java.util.Scanner.nextInt(Unknown Source)
at test.Test.main(Test.java:37) 
```

请任何帮助和解决方案将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:41:36.360

`Scanner.hasNext()`始终通过调用而不是跳入来检查 Scanner 是否有下一个元素`Scanner.Next()`。

显示错误是因为扫描仪到达了最后一个元素并且没有其他元素可以再次显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-23T17:46:15.717

首先，由于我猜测每次排序的数字不会相同，因此，我建议使用整数的 ArrayList。

这是 read in 方法，并且隐含了导入：

```
 private static ArrayList<Integer> nums;
    public static void readIn() throws FileNotFoundException{
        Scanner sc = new Scanner(new File("file.txt"));
        boolean error = false;
        while(sc.hasNext()&&!error){
            try{
                nums.add(Integer.parseInt(sc.next()));
            }catch(NumberFormatException e){
                e.printStackTrace();
                error = true;
            }
        }
    } 
```

这可能是最有效排序的代码。

```
 int[] numbers = (int[]) nums.toArray();
        Arrays.sort(numbers);
        System.out.println(Arrays.toString(numbers)); 
```

# regex - 使用 RewriteRule 从重定向中删除主题标签

> ID：13790460
> 
> 赞同：4
> 
> 时间：2012-12-09T18:39:04.913
> 
> 标签：regex, mod-rewrite

我目前正在通过获取变量并将其插入新 URL 来重定向 URL。像这样：

```
RewriteCond %{QUERY_STRING} &pid=([0-9]*)$
RewriteRule ^vault/displayimage\.php$ photos/%1/? [R=301,L] 
```

不幸的是，一些链接在旧系统中有一个不需要的标签，所以我想在没有它们的情况下重定向（或将它们剥离）。前任。- 通过上述重定向，我们采取类似

```
/vault/displayimage.php?album=5&pid=10#top_pictures 
```

重定向到

```
/photos/10/#top_pictures 
```

我希望它只是

```
/photos/10/ 
```

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T21:25:53.070

位置哈希仅存在于浏览器中，从不发送到服务器。因此，您不能用重写规则来影响它们。

[这就是人们不建议使用它们](https://stackoverflow.com/questions/9340121/which-one-is-better-pushstate-or-location-hash)的原因之一。

另请参阅[URL 片段和 302 重定向](https://stackoverflow.com/questions/2286402/url-fragment-and-302-redirects)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T20:54:33.017

你可以使用

```
RewriteRule ^vault/displayimage\.php$ photos/%1/#? [R=301,L,NE] 
```

这适用于 Chrome、Safari 和 Opera，但**不适**用于 Firefox。我目前无法测试 IE。

另请注意，您最终会出现`#`在 url 中。这比 好`#top_pictures`，但并不完全干净。

真正解决这个问题的唯一方法是使用一些 JavaScript。

# django - django required=false 以 10 为基数的 int() 的无效文字：''

> ID：13790465
> 
> 赞同：0
> 
> 时间：2012-12-09T18:39:33.243
> 
> 标签：django, forms, validation

在 django 表单中，对于 int() 基数为 10 的错误无效文字：" 对于我未填写的字段。它发生在以下行：

```
if form.is_valid(): 
```

我不明白的是该字段需要= False。所以如果该字段为空，Django 不应该尝试验证它，不是吗？

这是模型：

```
prelexDosId = models.IntegerField(max_length=7, unique=True, blank=True, null=True, default=None) 
```

这里的表格：

```
prelexDosId = forms.RegexField(regex=r'^[1-9]([0-9]?){6}$', required=False) 
```

先感谢您，

罗曼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:54:21.547

我只是推测，但也许模型字段中的默认值导致了问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:54:59.207

`RegexField`在这里使用完全错误的字段。我不明白为什么无论如何你都需要覆盖默认表单字段，但如果你这样做，你至少应该使用[`forms.IntegerField`](https://docs.djangoproject.com/en/1.4/ref/forms/fields/#integerfield)，它负责正确地将结果转换为干净的整数。

# java - OpenGL ES 模型加载器示例

> ID：13790470
> 
> 赞同：0
> 
> 时间：2012-12-09T18:39:59.060
> 
> 标签：java, c++, opengl-es, shader

我想使用带有着色器的 OpenGL 加载具有照明和凹凸贴图的任何格式的模型。在哪里可以找到有关 c++ 或 java 的示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:04:58.350

我不认为你的问题有一个简单的答案。没有任何单一的，也没有任何“最常用”的 3D 引擎标准模型文件格式。虽然有几个标准，但其中大多数都是旧的并且不支持许多功能，因此许多引擎使用自己的文件格式来满足自己的要求。

确实存在的标准，比如 Ogre XML，甚至都不是特别常用，而且当它们被使用时，它主要是为了“幕后”——在创建模型时工作，然后经常被“编译”到某些引擎中——实际包含在游戏或程序中的特定格式。

您可以研究一些开源库，例如[JME](http://jmonkeyengine.com/)、[Jogamp 示例](http://jogamp.org/jogl/www/)或[Ogre](http://www.ogre3d.org/)，看看它们如何加载模型，但我没有看到任何“简单”示例。Jogamp 样本可能是最简单的，但也有些过于简单。它们当然不包括任何凹凸贴图等。

如果您想要很多功能而不必自己从头开始实现，那么您最好使用一些预制的游戏引擎库，例如 JME 或 Ogre，而不是直接使用 OpenGL。

# java - 将数据从 JSP 传递到 Servlet

> ID：13790474
> 
> 赞同：1
> 
> 时间：2012-12-09T18:40:08.320
> 
> 标签：java, jsp, servlets, javabeans

我以这种方式通过jsp将数据传递给我的servlet：

```
<a href="DetyraServlet?action=listDetyra&firstName=<c:out value="${user.firstName}"/>">Something</a> 
```

所以我从我的 bean 类中传递了 firstName 参数（如果我是正确的）。现在我想通过 session.getAttribute("username"); 传递 firstName 所以我想做这样的事情：

```
<%  
    String user = (String) session.getAttribute("user");  
%> 
```

接着

```
<a href="DetyraServlet?action=listDetyra&firstName="<%=user%>">Something</a> 
```

但是当我尝试这个时我遇到了错误。谁能告诉我我的坏处是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T18:47:45.183

用这个，

`<a href="DetyraServlet?action=listDetyra&firstName=<%=user%>">Something</a>`

删除了多余的 "（双引号）

正如评论所提到的，您无需将会话变量传递给您自己的 servlet（同一服务器）。您可以在 servlet 代码本身中执行 session.getAttribute。

# python - 使用 cron 或 subshel l 的绝对路径调用 Python 时不会退出

> ID：13790475
> 
> 赞同：3
> 
> 时间：2012-12-09T18:40:12.657
> 
> 标签：python, relative-path, freeze, absolute-path, unhandled-exception

我有一些通过 cron 运行的 python 脚本，当使用绝对路径调用脚本时它们不再正确退出。它们将挂起，直到进程终止。我相信它发生在我将 /var 和 /home 移动到不同的分区之后。

我检查了环境变量，没有发现任何明显错误，这发生在使用 cron 或 bash 子shell 运行时，但在直接运行时不会发生。

如果我将它作为子 shell 运行，它会挂起，直到我杀死它（ctrl-c），然后给我输出。

```
[wotstats@rock test]$ echo 'assert 0==1, "fails"' > test.py
[wotstats@rock test]$ /bin/bash -c "/usr/bin/python /var/home/wotstats/test/test.py"
^CTraceback (most recent call last):
  File "/var/home/wotstats/test/test.py", line 1, in <module>
    assert 0==1, "fails"
AssertionError: fails 
```

如果我不调用脚本，它会按预期终止而不会挂起：

```
[wotstats@rock test]$ /bin/bash -c "echo 'assert 0==1, \"fails\"' | /usr/bin/python"
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
AssertionError: fails 
```

发生异常时，我确实会立即收到日志错误：

```
Dec  9 13:33:44 rock abrt: detected unhandled Python exception in '/var/home/wotstats/test/test.py' 
```

我根据输入运行了一些测试，发现即使以 /test.py 调用并以 root 身份运行时也会出现此问题。我也试过 /root 和 /usr 具有相同的效果。

[此处提出了类似或相同的问题](https://stackoverflow.com/questions/12865637/why-doesnt-python-exit-from-a-raised-exception-when-executed-with-an-absolute-p)，并通过重新启动解决；如果可以的话，我宁愿弄清楚并避免重新启动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-11T01:41:19.850

好的，想通了。谢谢您的帮助。

我跑了一个strace，发现它挂在以下内容上：

```
socket(PF_FILE, SOCK_STREAM, 0)         = 4
connect(4, {sa_family=AF_FILE, path="/var/run/abrt/abrt.socket"}, 27^C
<unfinished ...> 
```

这导致了[Bugzilla](https://partner-bugzilla.redhat.com/show_bug.cgi?id=614752)，它表明 SELinux 是问题所在。我已经将 SELinux 更改为许可模式（我在移动 /var 时搞砸了），但没有重新启动 abrtd。

重新启动`abrtd`服务解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-23T13:41:25.007

代替：

```
/usr/bin/python /var/home/wotstats/test/test.py 
```

利用：

```
cd /var/home/wotstats/test/
/usr/bin/python test.py<br/> 
```

# hibernate - Primefaces 延迟过滤问题

> ID：13790485
> 
> 赞同：0
> 
> 时间：2012-12-09T18:41:06.090
> 
> 标签：hibernate, datatable, primefaces, lazy-loading, filtering

我正在尝试在我的应用程序中实现延迟加载，但我的过滤存在问题。此时排序工作正常。使用延迟过滤，数据表最初会从表中加载正确的计数，即 24 条记录，但它会一遍又一遍地重复第一条和第二条记录。任何帮助是极大的赞赏。

这是我的 ScreenshotListProducer 类代码：

```
 @ManagedBean
    @RequestScoped
    public class ScreenshotListProducer implements Serializable  {
       private static final long serialVersionUID = 1L;
       @Inject
       private EntityManager em;

       private List<Screenshot> screenshots;

       private LazyDataModel<Screenshot> lazyModel = null;

       private int pageSize = 5;

       public void setPageSize(int pageSize) {
           this.pageSize = pageSize;
       }

       public int getPageSize() {
           return pageSize;
       }

       @Produces
       @Named
       public List<Screenshot> getScreenshots() {
          System.out.println("************* getting screenshots list **************");
          return screenshots;
       }

       @PostConstruct
       public void LoadData() {
         lazyModel = new LazyDataModel<Screenshot>() {
        private static final long serialVersionUID = 1L;

      @Override
      public List<Screenshot> load(int first, int pageSize, String sortField, SortOrder sortOrder, Map<String,String> filters) { 
           int start = first;
                  int end = first + pageSize;
                  if (sortField == null) {
                     sortField = "time";
                  }

                 try {
               CriteriaBuilder cb = em.getCriteriaBuilder();
               CriteriaQuery<Screenshot> criteria = cb.createQuery(Screenshot.class);
               Root<Screenshot> screenshot = criteria.from(Screenshot.class);

               // sorting
               if (sortOrder.equals(SortOrder.ASCENDING))
                {
                  criteria.select(screenshot).orderBy(cb.asc(screenshot.get(sortField)));
                }
                else if (sortOrder.equals(SortOrder.DESCENDING))
                {
                   criteria.select(screenshot).orderBy(cb.desc(screenshot.get(sortField)));
                }

               // From
               Root<Screenshot> from = criteria.from(Screenshot.class);

               List<Predicate> predicates = new ArrayList<Predicate>();

               if (filters != null) {
                  // filters
                  for(Iterator<String> it = filters.keySet().iterator(); it.hasNext();) {
                     String filterProperty = it.next(); // table column name = field name
                     System.out.println("filterProperty is: " + filterProperty);

                     String filterValue = filters.get(filterProperty);
                     System.out.println("filterValue is: " + filterValue);

                     Expression<String> literal = cb.literal((String)filterValue);
                     predicates.add(cb.like(from.<String>get(filterProperty), literal));
                  }
                  criteria.where(predicates.toArray(new Predicate[predicates.size()]));
               }

               TypedQuery<Screenshot> s = em.createQuery(criteria);
               s.setMaxResults(end - start);
               s.setFirstResult(start);

               screenshots = s.getResultList();

            } catch (NullPointerException e) {
               e.printStackTrace();
            }

                          return screenshots;
           }

         };

   lazyModel.setRowCount(24);
   lazyModel.setPageSize(pageSize);

   if (lazyModel.getRowIndex() == -1 || lazyModel.getPageSize() == 0) {
            lazyModel.setRowIndex(-1);
       }
       else
           lazyModel.setRowIndex(lazyModel.getRowIndex() % lazyModel.getPageSize());
       }

   public LazyDataModel<Screenshot> getLazyModel() {
        return lazyModel;
    }
   } 
```

这是我的截图类：

```
@Entity
@XmlRootElement
@Table(name="Test2012", uniqueConstraints = @UniqueConstraint(columnNames = "id"))
public class Screenshot implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue
    @Column(name = "id", columnDefinition="INT")
    private Long id;

    private Timestamp time;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Timestamp getTime() {
        return time;
    }

    public void setTime(Timestamp time) {
        this.time = time;
    }   
} 
```

这是我的 xhtml 代码：

```
<p:dataTable id="table1" var="scrshot" rowKey="#{scrshot.id}" value="#{screenshotListProducer.lazyModel}" paginator="true" rows="7" paginatorPosition="bottom"
             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}" 
             rowsPerPageTemplate="7,20,50,100" widgetVar="dataTable" currentPageReportTemplate="(Number of Records: {totalRecords})"
             emptyMessage="No screenshot data found with given criteria" lazy="true" scrollable="true" draggableColumns="true" scrollHeight="217" style="width: 100%;"> 
      <f:facet name="header"> 
      </f:facet>
      <p:column selectionMode="multiple"/> 
      <p:column id="time" headerText="Time" sortBy="#{scrshot.time}" filterBy="#{scrshot.time}" filterMatchMode="startsWith"> 
        <h:outputText value="#{scrshot.time}"/> 
      </p:column>   
      <p:column id="id" headerText="ID" sortBy="#{scrshot.id}" filterBy="#{scrshot.id}" filterOptions="#{scrshot.id}" filterMatchMode="exact"> 
        <h:outputText value="#{scrshot.id}"/> 
      </p:column> 
</p:dataTable> 
```

Primefaces 3.3.1 Mojarra 2.1.5 JBoss AS 7.1.0.Final

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T16:18:42.317

几点说明：

*   您正在使用`@RequestScoped`. 我似乎记得过滤/排序和请求范围的问题（不确定这是这里的问题）。尝试`@ViewScoped`或使用更高的范围。
*   不要`EntityManager`在顶层（支持 bean）中使用数据访问（例如与数据库相关的东西，如 ）。将其分为 2 层或 3 层：GUI -（业务逻辑）-数据访问。
*   您发布的`ScreenshotListProducer`课程缩进混乱，难以阅读。它似乎也没有正确关闭（缺少“}”）。
*   JSF 中的`globalFilter`似乎没有连接到数据表。（我在这里可能是错的。）
*   您似乎正在创建 3 个过滤器、2 个列过滤器和 1 个全局过滤器，哪一个会导致问题？下次更具体;-)
*   删除不相关的代码并精简代码以制作一个简短的示例来演示您的问题。示例：`modeOptions`并且`formatOptions`似乎没有使用，只会影响问题的可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T16:14:28.453

感谢您的输入。我的加入问题与我的“来自”定义有关。我把它拿出来并在我的过滤器中使用了我原来的“屏幕截图”，它现在可以正确过滤了。

# bash - Untar 之后的流链

> ID：13790486
> 
> 赞同：2
> 
> 时间：2012-12-09T18:41:07.057
> 
> 标签：bash, stream, tar

我想**有效地**将​​ tar.gz 中包含的几个 jpeg 图像转换为 x264 mp4 电影。

```
gzip -cd Monitor-1-xx.tar.gz|cpio -i --to-stdout|jpegtopnm|ppmtoy4m -F 4:1| \
>  x264 --crf 24 -o Monitor-1-xx.mp4 --stdin y4m - 
```

这里的问题是，在 cpio 之后，我在一个流中有多个 jpg 文件，而 jpegtopnm 只转换第一个。

我想找到一个函数来拆分流（或预先拆分）。然后我想为每个拆分多次运行 jpegtopnm 。这有点像我先解压到磁盘时 xargs 所做的事情。写入磁盘是我试图避免的事情：

```
mkdir tmpMonitor && cd tmpMonitor && tar -xf ../Monitor-1-xx.tar.gz
find . -iname "*.jpg"|xargs -n1 jpegtopnm|ppmtoy4m -F 4:1| \
    x264 --crf 24 -o ../xx.mp4 --stdin y4m -
cd .. && rm -rf tmpMonitor 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T09:53:04.467

`tar`有几个可能在这里有用的选项（我有 GNU `tar`，所以我提前道歉假设你这样做，以防你实际上不这样做）：

1.  `--wildcards`- 让您可以使用 glob 选择要从 tar 中提取的文件，例如`*.jpeg`
2.  `--to-command`*- 将每个提取的文件*通过管道传输到给定的命令。

所以也许是这样的？

```
tar -xzf Monitor-1-xx.tar.gz --wildcards '*.jpeg' \
    --to-command="jpegtopnm|ppmtoy4m -F 4:1| x264 --crf 24 -o ../xx.mp4 --stdin y4m -" 
```

好吧，我不太了解，`x264`所以请考虑未经测试的代码。我使用简单`.txt` 文件而`.jpegs`不是`cat -n`等进行了测试`jpegtopnm`。另一件事是，我猜你想要*单独的*输出文件（每个 jpeg 一个），所以在我看来它`../xx.mp4`不会这样做......所以假设你想要**单独的**`jpegtopnm|ppmtoy4m -F 4:1| x264 --crf 24 -o ../xx.mp4 --stdin y4m -`为每个文件调用然后你想要一个不同的输出文件名，`-o`对吗？- 在这种情况下，以下 hack 可能会起作用：

```
tar -xzf Monitor-1-xx.tar.gz --wildcards '*.jpeg' \
    --to-command="jpegtopnm|ppmtoy4m -F 4:1| x264 --crf 24 -o ../xx-`date +%H%M%S%N`.mp4 --stdin y4m -" 
```

# python - 优化 Python 过滤程序的技巧

> ID：13790489
> 
> 赞同：0
> 
> 时间：2012-12-09T18:41:26.267
> 
> 标签：python, optimization

我一直在研究一个非常简单的程序，其要点如下所示：

```
 post = open(INPUTFILE1, "rb")
    for line in post:
        cut = line.split(',')
        pre = open(INPUTFILE2, "rb")
        for otherline in pre:
            cuttwo = otherline.split(',')
            if cut[1] == cuttwo[1] and cut[3] == cuttwo[3] and cut[9] == cuttwo[9]:
                OUTPUTFILE.write(otherline)
                break
    post.close()
    pre.close()
    OUTPUTFILE.close() 
```

实际上，它的作用是将两个 csv 文件作为输入（一个“pre”和一个“post”）。它查看“post”数据中的第一行，并尝试在“pre”数据中找到与第 2、4 和 10 列匹配的行。如果匹配，它将“pre”数据写入新文件。

它工作得很好，但它需要永远。虽然我的“post”数据可能只有几百（最多可能一千）行，但我的“pre”可能有多达 1500 万行。因此，可能需要大约 10 个小时才能完成。

我对 Python 还很陌生，所以我还没有学到很多关于优化技术的知识。有人对我可以尝试什么有任何指示吗？显然，我知道当我搜索整个“pre”数据以进行匹配时，就会发生僵局。有没有办法加快这个速度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:58:32.400

如果你只有几百行是潜在的，那么使用类似的东西：

```
from operator import itemgetter
key = itemgetter(1, 3, 9)
with open('smallfile') as fin:
    valid = set(key(line.split(',')) for line in fin)

with open('largerfile') as fin:
    lines = (line.split(',') for line in fin)
    for line in lines:
        if key(line) in valid:
            # do something.... 
```

这可以节省不必要的迭代，并充分利用 Python 内置的高效查找功能。

如果要在输出中使用小文件的整行（如果有匹配项），则使用字典而不是集合：

```
from operator import itemgetter
key = itemgetter(1, 3, 9)
with open('smallfile') as fin:
    valid = dict((key(line.split(',')), line) for line in fin) 
```

然后您的处理循环将类似于：

```
with open('largerfile') as fin:
    lines = (line.split(',') for line in fin)
    for line in lines:
        otherline = valid.get(key(line), None)
        if otherline is not None:
            # do something.... 
```

# objective-c - 正确指定非小数 CGFloat 值

> ID：13790500
> 
> 赞同：1
> 
> 时间：2012-12-09T18:42:30.973
> 
> 标签：objective-c, cocoa

在设置整个`CGFloat`值（因此通过暗示`float`和`double`值）时，最好的做法是包括小数点还是无关紧要？例如：

```
CGRect rect1 = CGRectMake(0, 10, 100, 200);         // Approach 1
CGRect rect2 = CGRectMake(0.0, 10.0, 100.0, 200.0); // Approach 2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:57:16.943

编译器将对浮点数进行隐式转换，因此任何一种方法都应该产生相同的浮点值。

但是，您的方法 2 实际上是指定 double 类型的值，然后将其转换为 float。要显式指定浮点数，您需要添加`f`后缀，即`200.0f`

就我个人而言，我总是指定这样的值，`xxx.0f`只是为了提醒我它们是浮点数，并搞砸编译器必须做的额外工作来解释我的代码——它是为了我的出价，而不是相反。

当然我也会这样做：

```
static const float left = 0.0f;
static const float top = 10.0f;
static const float width = 100.0f;
static const float height = 200.0f;

CGRect rect3 = CGRectMake(left, top, width, height); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:03:11.207

通常它们是相同的，因为隐式转换不会导致常见值（如 10、20 等）的精度损失......
但只是在整数溢出的极少数情况下，你最好使用漂浮。
例如：

```
CGRect rect1 = CGRectMake(0, 10, 100, INT_MAX+1); 
```

对比：

```
CGRect rect1 = CGRectMake(0, 10, 100, (float)INT_MAX+1); 
```

这两个表达式给出了完全不同的值。
在你的地方，我只使用整数，只有当我需要小数精度时才使用浮点数，或者当我可能冒着整数溢出的风险时。

# python - 正则表达式 grep，在 function() 中找到 $tring 和 $_tring

> ID：13790505
> 
> 赞同：2
> 
> 时间：2012-12-09T18:42:55.963
> 
> 标签：python, regex, linux, unix

在我的 debian 机器上，我正在玩一些代码和正则表达式。所以无论如何，我希望在一些代码文件中找到以下模式：

```
function(some text $tring||$_string) 
```

目前我正在使用以下命令

```
find . -type f | xargs grep "function" 
```

我尝试使用

```
find . -type f | xargs grep "function(*$string||$_tring*)" 
```

但它没有用。

本质上它需要搜索所有符合以下规则的模式

*   包括函数（）
*   在函数内部，匹配以下任一字符串
    *   $字符串或
    *   $_tring

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:52:43.527

```
find . -type f -exec egrep -Hn 'function\(.*(\$string|\$_string).*\)' '{}' ';' 
```

能够处理包含空格的文件名，以及如果有很多文件。

`man 3 regex`如果您想了解更多有关正则表达式语法的信息：

```
.            any character, in shell (sh/csh) this is '?'
.*           zero or more any characters
a*           zero or more a's
(alpha|beta) groups, either alpha or beta
^            beginning of string
$            end of string, that's why it needs to be escaped 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T18:47:51.747

我推荐你`ack`，它是为此目的而设计的（它过滤文件以不搜索`.svn`，`.git`以及这样的 dirs ）。

见[http://betterthangrep.com/](http://betterthangrep.com/)

所以 ：

```
ack -r "function.*(\$[s_]tring)" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:49:43.270

尝试

```
find . -type f | xargs egrep 'function\(.*$[s_]tring.*\)' 
```

# javascript - 用于迭代函数定义的 Javascript 闭包

> ID：13790506
> 
> 赞同：0
> 
> 时间：2012-12-09T18:43:17.070
> 
> 标签：javascript, function, closures

> **可能重复：**
> [Javascript 闭包？](https://stackoverflow.com/questions/11821484/javascript-closure)

以前可能有人问过这个问题，但是...

如果我想要一个函数列表

```
var funs = [
  function(){ console.log(1); },
  function(){ console.log(2); },
  function(){ console.log(3); },
  function(){ console.log(4); },
  function(){ console.log(5); } ] 
```

似乎可以通过以下方式实现：

```
var funs = [];
for(var i=1; i <= 5; i++){
  funs.push(function(){ console.log(i) };
} 
```

这不起作用，因为变量`i`是绑定到所有函数的单个变量，所以

```
funs[0](); funs[1](); funs[2](); funs[3](); funs[4](); 
```

输出

```
6
6
6
6
6 
```

不是

```
1
2
3
4
5 
```

这不是我想要的输出。我想我需要强制 javascript`i`在创建函数时绑定值的副本，而不是用`i`. 我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:45:55.240

最简单的方法是通过自执行函数的参数传递函数：

```
for(...) {
    (function(i) {
        // here you have a new i in every loop
    })(i);
} 
```

# javascript - 使用 jquery 读取提要 url 时出错

> ID：13790511
> 
> 赞同：0
> 
> 时间：2012-12-09T18:43:53.080
> 
> 标签：javascript, jquery

我正在使用 jquery 函数来读取提要 url。如果我使用其他提要网址，它工作正常。请告诉我提要网址有什么问题。我正在使用提要网址。

```
$(document).ready(function () {
 var resulta="";
$.get("http://feed43.com/6782621036337143.xml", function (data) {
alert(data);
  $(data).find('item').each(function(i){

    var title = $(this).find('title').text();
        var container = $(this).find('description').text();
        var img_url = $('img', container).attr('src');
        var url = $(this).find('link').text();
 var suffix='<span class="read">....<a href="'+url+'" target="_blank" >    
  →&amp;nbsp;Read&nbsp;More</a></span>';
        var container=container.substr(0,800).replace(/\s+?(\S+)?$/g, '')+suffix;

  resulta+='<div class="narticle"><div class="atext"><h2 class="title">
  <a href="'+url+'" target="_blank" >'+title+'</a></h2></div>
  <div class="new_content">'+container+'</div></div>';

   });
  $("#new_article").html(resulta); 
```

# mongodb - Grails瞬态属性不验证错误？

> ID：13790512
> 
> 赞同：1
> 
> 时间：2012-12-09T18:43:54.363
> 
> 标签：mongodb, grails, grails-orm, grails-domain-class

我有一个域类：

```
class Book {

    String id 
    Date dateCreated
    Date lastUpdated
    String title
    boolean acceptPolicy // defines if the user accepts the terms and privacy poicy
    String uploadImageId

    static transients = [ "acceptPolicy" ]  

    static constraints = {
            acceptPolicy( validator: { val, obj -> val == true} )
    }

} 
```

我选择“acceptPolicy”作为不应存储在数据库中的字段。当我创建一个书本对象时，一切都可以找到。当我更新书籍实例时会出现问题。每次我尝试保存时，都会收到“acceptPolicy”的验证错误。这不应该是这种情况，因为“acceptPolicy”没有存储在数据库中。我也尝试设置

```
acceptPolicy = true 
```

在隐藏的输入字段中，但仍然会出现此问题。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T21:31:28.913

更改验证器并使其行为，以便它仅在实体尚未持久时验证 acceptPolicy 字段：

```
 acceptPolicy( validator: { val, obj -> obj.id || val } ) 
```

# listview - 与 2.3 及更高版本与 listfragments、tabhost、simple curson 适配器的兼容性

> ID：13790513
> 
> 赞同：2
> 
> 时间：2012-12-09T18:44:03.573
> 
> 标签：listview, android-listview, android-asynctask, android-tabhost, android-2.3-gingerbread

我正在创建应用程序来加载特定公司的推文。为了使其与 Android 2.3 及更高版本兼容，我需要使用 FragmentActivity 和 ListFragment。我正在使用 AsyncTask 并添加选项卡并将它们加载到 sqlite DB 中的 FragmentAcitivity 类中获取有关应用程序启动的推文。现在，在选项卡单击时，我需要从我正在使用 LoaderManager 的 sqllite DB 加载这些推文，但在选项卡单击时没有显示任何内容。这是我的代码片段：

片段活动：

```
 @Override
    public void onTabChanged(String tag) {  
Log.d(TAG, "onTabChanged");  
TabInfo newTab = this.mapTabInfo.get(tag);  
if (mLastTab != newTab) {  
  FragmentTransaction ft = this.getSupportFragmentManager().beginTransaction();  
if (mLastTab != null) {  
if (mLastTab.fragment != null) {  
 ft.detach(mLastTab.fragment);  
 }  
}  
if (newTab != null) {  
if (newTab.fragment == null) {  
newTab.fragment = (ListFragment) ListFragment.instantiate(this, newTab.clss.getName(), newTab.args);  
ft.add(R.id.realtabcontent, newTab.fragment, newTab.tag);  
} else {ft.attach(newTab.fragment);  
}  
}     
mLastTab = newTab;  
ft.commit();  
this.getSupportFragmentManager().executePendingTransactions();  
}    
} 
```

列表片段：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
Bundle savedInstanceState) {  
Log.d(TAG, "onCreateView");  
if (container == null) {  
return null;  
}   
adapter = new SimpleCursorAdapter(getActivity().getApplicationContext(), R.layout.row, null,TweetStatusProvider.FROM,TweetStatusProvider.TO,CursorAdapter.FLAG_REGISTER_CONTENT_OBSERVER);  
adapter.setViewBinder(VIEW_BINDER);  
getLoaderManager().initLoader(STATUS_LOADER, null, this);  
Log.d(TAG, "initLoader executed");  
View view = inflater.inflate(R.layout.list_fragment_layout, container, false);      
ListView listView = (ListView)view.findViewById(android.R.id.list);  
listView.setAdapter(adapter);  
return view;  
} 
```

布局：main.xml：

```
 <?xml version="1.0" encoding="utf-8"?>  
 '<'TabHost xmlns:android="http://schemas.android.com/apk/res/android"  
  android:id="@android:id/tabhost"  
  android:layout_width="match_parent"  
  android:layout_height="match_parent" '>'  
'<'LinearLayout  
android:layout_width="match_parent"  
android:layout_height="match_parent"  
android:background="@drawable/background"  
android:orientation="vertical"  
android:padding="10dp" '>'  
'<'HorizontalScrollView  
android:layout_width="match_parent"  
android:layout_height="wrap_content"  
android:scrollbars="none" '>'  
'<'TabWidget  
android:id="@android:id/tabs"  
android:layout_width="54dp"  
android:layout_height="60dp" '/>'  

'<'/HorizontalScrollView'>'  
'<'FrameLayout  
android:id="@android:id/tabcontent"  
android:layout_width="match_parent"  
android:layout_height="match_parent"  
android:padding="5dp" '>'  
'<'/FrameLayout'>'  
'<'FrameLayout  
android:id="@+android:id/realtabcontent"  
android:layout_width="fill_parent"  
android:layout_height="0dp"  
android:layout_weight="1" /'>'  
'<'/LinearLayout'>'  
'<'/TabHost'>' 
```

list_fragment_layout.xml：

```
 '<'?xml version="1.0" encoding="utf-8"?'>'  
 '<'LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"     
 android:layout_width="match_parent"    
 android:layout_height="match_parent"    
 android:orientation="vertical" '>'    

 '<'ListView  
 android:id="@android:id/list"  
 android:layout_width="match_parent"  
 android:layout_height="wrap_content" '>'  
 '<'/ListView'>'    
'<'/LinearLayout'>' 
```

行.xml：

```
'<'?xml version="1.0" encoding="utf-8"?'>'  
'<'RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"  
    android:layout_width="match_parent"  
    android:layout_height="match_parent" '>'  
    '<'TextView  
 android:id="@+id/text_user"  
 android:layout_width="wrap_content"  
 android:layout_height="wrap_content"  
 android:layout_alignParentLeft="true"  
 android:layout_alignParentTop="true"  
 android:text="Large Text"  
 android:textAppearance="?android:attr/textAppearanceLarge" /'>'  

'<'TextView  
 android:id="@+id/text_created_at"  
 android:layout_width="wrap_content"  
 android:layout_height="wrap_content"  
 android:layout_alignParentRight="true"  
 android:layout_alignParentTop="true"  
 android:text="10 minutes ago"  
 android:textAppearance="?android:attr/textAppearanceMedium" /'>'  
'<'TextView  
  android:id="@+id/text_text"  
  android:autoLink="all"  
      android:layout_width="wrap_content"  
  android:layout_height="wrap_content"  
  android:layout_alignParentLeft="true"  
  android:layout_alignParentRight="true"  
  android:layout_below="@+id/text_user"  
  android:text="Small Text"  
  android:textAppearance="?android:attr/textAppearanceSmall" /'>'  
'<'/RelativeLayout'>' 
```

# objective-c - SecKeychain 加载项

> ID：13790515
> 
> 赞同：1
> 
> 时间：2012-12-09T18:44:06.227
> 
> 标签：objective-c, macos, cocoa, keychain

我想使用钥匙串从我的 Mac OSX 应用程序中存储 SMTP 数据。我阅读了 Apple 的 Keychain Services Programming Guide 并编写了这个方法来存储数据：

```
 - (BOOL)saveSMPTData
{
    OSStatus err;
    SecKeychainItemRef item = nil;
    SecProtocolType protocol = kSecProtocolTypeSMTP;
    const char *accessLabelUTF8 = [KEYCHAIN_NAME UTF8String];
    const char *serverNameUTF8 = [self.serverName UTF8String];
    const char *usernameUTF8 = [self.username UTF8String];
    const char *passwordUTF8 = [self.password UTF8String];

    SecAccessRef access = createAccess(KEYCHAIN_NAME);

    SecKeychainAttribute attrs[] = {
        { kSecLabelItemAttr, (int)strlen(accessLabelUTF8), (char *)accessLabelUTF8 },
        { kSecAccountItemAttr, (int)strlen(usernameUTF8), (char *)usernameUTF8 },
        { kSecServerItemAttr, (int)strlen(serverNameUTF8), (char *)serverNameUTF8 },
        { kSecProtocolItemAttr, sizeof(SecProtocolType), (SecProtocolType *)&protocol }
    };
    SecKeychainAttributeList attributes = { sizeof(attrs) / sizeof(attrs[0]), attrs };
    err = SecKeychainItemCreateFromContent(kSecInternetPasswordItemClass,
                                           &attributes,
                                           (int)strlen(passwordUTF8),
                                           passwordUTF8,
                                           NULL,
                                           access,
                                           &item);
    if (access) CFRelease(access);
    if (item) CFRelease(item);
    return (err == noErr);
}

SecAccessRef createAccess(NSString *accessLabel)
{
    OSStatus err;
    SecAccessRef access = nil;
    NSArray *trustedApplications = nil;

    SecTrustedApplicationRef myself;
    err = SecTrustedApplicationCreateFromPath(NULL, &myself);

    trustedApplications = [NSArray arrayWithObjects:(__bridge id)myself, nil];
    err = SecAccessCreate((__bridge CFStringRef)accessLabel,
                          (__bridge CFArrayRef)trustedApplications, &access);

    if (err) return nil;
    return access;
} 
```

当然我也想加载它们。我的第一次尝试是这样的：

```
- (BOOL)loadDataFromKeychain
{
    uint32_t serverNameLength = 0;
    const char *serverName = NULL;

    uint32_t usernameLength = 0;
    const char *username = NULL;

    uint32_t passwordLength = 0;
    void **password = NULL;

    OSStatus err = SecKeychainFindInternetPassword(NULL,
                                                   serverNameLength, serverName,
                                                   0, NULL,
                                                   usernameLength, username,
                                                   0, NULL,
                                                   0, 0,
                                                   0,
                                                   &passwordLength, password,
                                                   NULL); // How do I get the ItemRef?

    return (err == noErr);
} 
```

但这不起作用，我想我知道为什么不这样做。我不知道如何获取*SecKeychainFindInternetPassword*方法的*SecKeychainItemRef*。

也许有人可以帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T06:43:48.997

不要声明`password`a `void **`，而是声明它 a`void *`并传递`&password`倒数第二个参数。

您可能不需要 SecKeychainItemRef 来完成您要完成的工作。

顺便说一句，您是否尝试过使用**钥匙串访问**来验证物品是否进入钥匙串？

# machine-learning - SAS Enterprise Miner - Cluster node - 可以将坐标矩阵作为输入吗？

> ID：13790518
> 
> 赞同：1
> 
> 时间：2012-12-09T18:44:24.540
> 
> 标签：machine-learning, sas, cluster-analysis, data-mining, k-means

我正在使用 SAS proc 距离来创建距离矩阵。我想知道 SAS EM 集群节点是否可以使用这个矩阵来创建执行 K 均值集群？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T23:12:50.890

K-means*必须*与平方欧几里得一起使用。因为从技术上讲，它最小化了*方差*，而不是距离。

此外，它显然*不能*与距离矩阵一起使用，因为它不需要对象到对象的距离，而是对象到均值的距离（并且均值会发生变化）。

# objective-c - UITableView setContentOffset 但不滚动 tableView？

> ID：13790522
> 
> 赞同：2
> 
> 时间：2012-12-09T18:45:02.127
> 
> 标签：objective-c, ios, cocoa-touch, uitableview

我`setContentOffset`在 a 上使用是`UITableView`因为我想最初隐藏我的搜索字段`tableHeaderView`。

```
[self.tableView setContentOffset:CGPointMake(0, 56)]; // No scroll please! 
```

每次我推一个新的`viewController`我想用 contentOffset 隐藏搜索栏。但是当我弹出一个`viewController`偏移量由于某种原因不再有效并显示搜索栏时。为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:59:22.633

我猜你想阻止用户滚动到屏幕的最顶部。如果是这样，您可以实现以下 UITableView 委托（在 iOS5 及更高版本上）：

`scrollViewWillEndDragging:withVelocity:targetContentOffset:`

它允许您修改最终目标以更改 contentOffset。在实现中，您执行以下操作：

```
- (void)scrollViewWillEndDragging:(UIScrollView *)theScrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset
{
    if(targetContentOffset->y < 56) {
         targetContentOffset->y=56;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T18:50:04.987

您可以尝试在以下位置实现它

```
- (void)viewWillAppear:(BOOL)animated {
    [self.tableView setContentOffset:CGPointMake(0, 56)];
} 
```

这将使表格在屏幕上显示之前放置在正确的位置，我假设您在设置位置时没有动画。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-11T23:38:02.993

如果您试图在丢失某物的操作期间保留它的价值，自然的解决方案是自己保留它（“保留/恢复”）：

1.  “保持”：获取字段或局部变量的内容偏移量。[苹果文档](https://developer.apple.com/reference/uikit/uiscrollview/1619404-contentoffset)
2.  .. 做你想做的。
3.  “恢复”：将内容偏移设置为您上面得到的值。

（对不起，我不编写 Objective C 代码，所以无法提供确切的代码。欢迎编辑添加代码。）

* * *

在不同的情况下，可能需要**保留**您所在的行，然后滚动回该行：（
改编自：[https](https://stackoverflow.com/a/34270078/199364) ://stackoverflow.com/a/34270078/199364 ）

> (Swift)
> 1\. 保持当前行。

```
let holdIndexPath = tableView.indexPathForSelectedRow() 
```

> 2.  .. 做任何事（也许以“reloadData”结尾）。
>     
>     
> 3.  恢复保持行：

```
// The next line is to make sure the row object exists.
tableView.reloadRowsAtIndexPaths([holdIndexPath], withRowAnimation: .None)
tableView.scrollToRowAtIndexPath(holdIndexPath, atScrollPosition: atScrollPosition, animated: true) 
```

# .net - .NET 如何解析类型？

> ID：13790526
> 
> 赞同：4
> 
> 时间：2012-12-09T18:46:02.107
> 
> 标签：.net, c#-4.0, compiler-construction, types, runtime

我很好奇 .net 如何解析类型。我知道有一个编译时组件，因为您无法编译具有不在当前程序集或引用程序集中的 using 语句或完全限定类型的程序。我想知道是编译器通过错误还是Visual Studio在proj文件中找不到引用时抛出构建错误？

我也想知道.net 如何在运行时找到程序集。我知道 .net 使用 JIT 编译器，它在第一次运行到该程序集中的类型时加载程序集。我很好奇它是如何查找类型和搜索顺序的。程序集清单是否准确地告诉运行时在哪里查找引用的程序集（如 ASP.NET web.config 文件）？任何指向博客文章、书籍、规格等的链接将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T19:19:15.707

当您使用无法识别的标识符时，您收到的错误消息的最终来源是编译器。您将收到来自 IntelliSense 的早期警告，它将红色波浪线置于标识符名称下方。

编译器在它从您的源代码生成的程序集的元数据中记录程序集、命名空间和类型名称。对于程序集，它记录显示名称（如 System）、它在参考程序集中找到的 [AssemblyVersion] 和 PublicKeyToken（与强名称程序集相关的值）。

在运行时，CLR 的工作是仅使用这三个程序集属性来查找程序集。抖动将是要求 CLR 在需要生成代码时找到它的抖动。关于它有几个晦涩的细节，与覆盖正常的查找规则相关，你可以在任何关于 .NET 或 MSDN 的好书中找到它们。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/yx7xezcf%28v=VS.85%29.aspx)将详细介绍。

通常的方法是首先查看 GAC，这是程序集的存放处和所有 .NET 框架程序集的存储位置。GAC 很特别，因为它可以存储多个同名但版本不同的程序集，这是一个强大的 DLL Hell 对策。如果它在那里找不到它，使用与这三个属性和体系结构的完全匹配，然后它会在存储 EXE 的目录中查找，如果显示名称匹配则接受匹配。如果所有程序集属性都匹配并且可以使用相同的命名空间和类型名称找到类型，那么一切都很好。

# c# - 具有数组参数和任意元素类型的 C# FieldInfo.SetValue

> ID：13790527
> 
> 赞同：2
> 
> 时间：2012-12-09T18:46:02.747
> 
> 标签：c#, arrays, reflection, system.type, fieldinfo

我正在尝试使用反射设置一个数组字段，如下所示：

```
FieldInfo field = ...
A[] someArray = GetElementsInSomeWay();
field.SetValue(this, someArray); 
```

该字段具有类型`B[]`。`B`继承自，并且在编译时不知道 `A`确切的类型。返回，但里面的真正元素都是's. 是一种库方法，不能更改。`B``GetElementsInSomeWay()``A[]``B``GetElementsInSomeWay()`

我最多能做的就是得到`B`with `System.Type type = field.FieldType.GetElementType()`。但是我不能将数组转换为所需的类型，例如 `someArray as type[]`因为`[]`在声明数组类型之前需要一个确切的类型。或者我在这里错过了什么？`System.Type`如果在运行时使用变量知道该类型，我可以声明某种类型的数组吗？

以直接方式执行此操作会产生以下错误（这里`A`is`UnityEngine.Component`和`B`is`AbilityResult`也可以是其他几十个类之一，都继承自（可能通过长继承链）`UnityEngine.Component`）：

```
ArgumentException: Object type UnityEngine.Component[] cannot be converted to target type: AbilityResult[]
Parameter name: val
System.Reflection.MonoField.SetValue (System.Object obj, System.Object val, BindingFlags invokeAttr, System.Reflection.Binder binder, System.Globalization.CultureInfo culture) (at /Applications/buildAgent/work/3df08680c6f85295/mcs/class/corlib/System.Reflection/MonoField.cs:133)
System.Reflection.FieldInfo.SetValue (System.Object obj, System.Object value) (at /Applications/buildAgent/work/3df08680c6f85295/mcs/class/corlib/System.Reflection/FieldInfo.cs:150) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T20:42:26.893

我认为您需要更好地了解数组的*方差*。数组和.NET 1 一样`object[]`，`string[]`早在泛型（.NET 2）之前就已经出现了。否则他们可能被称为`Array<object>`and `Array<string>`。

现在，我们都知道 any`string`是`object`. 如果这个事实意味着，对于某些“构造” `Xxx`， any`Xxx<string>`是一个`Xxx<object>`，那么我们称之为[covariance](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)。从 .NET 4 开始，一些泛型接口和泛型委托类型可以是协变的，这`out`在其定义中用关键字标记，如

```
public interface IEnumerable<out T>
{
  // ...
} 
```

如果在“应用”时关系反转`Xxx<>`，则称为逆变。所以“`string`是`object`”和逆变变成了“`Xxx<object>`是`Xxx<string>`”。

现在，回到数组。这里自然的问题是：数组是协变的还是逆变的，或者两者都不是（“不变”）？由于您可以读取和写入数组中的每个“单元”，因此它们不能完全协变或逆变。但试试这段代码：

```
string[] arr1 = { "these", "are", "strings", };
object[] arr2 = arr1;                           // works! covariance!
var runtimeType = arr2.GetType();               // System.String[] 
```

所以 a`T[]`在 .NET 中是协变的。但是我不是说我可以写（比如`in`not `out`）到一个数组吗？那么如果我继续这样呢：

```
arr2[0] = new object(); 
```

我正在尝试将*不是*`object`a放入第零个插槽。上面的行必须编译（编译时类型为is ）。但它也必须提高运行时间。这就是数组和协方差的问题。*`string``arr2``object[]`*

 *那么逆变呢？试试这个：

```
object[] arrA = { new object(), DateTime.Now, "hello", };
string[] arrB = arrA;  // won't compile, no cotravariance 
```

`object[]`从to进行显式转换`string[]`仍然无法在运行时工作。

现在，您的问题的答案是：您正在尝试对数组应用逆变。`AbilityResult`是`Component`，但这**并不**意味着`Component[]`是`AbilityResult[]`。编写该`GetElementsInSomeWay()`方法的人选择创建一个`new Component[]`. 即使他放入其中`AbilityResult`的所有组件都是 ，仍然没有逆变。作者本`GetElementsInSomeWay()` **可以**选择制作一个`new AbilityResult[]`。`Component[]`由于 .NET 数组的协方差，他仍然可以有返回类型。

经验教训：数组的*真实*类型（由 显示的运行时类型）不会仅仅因为您进行转换而改变。`.GetType()`.NET 确实允许协变（类型的变量`Component[]`可能包含实际类型为 的对象`AbilityResult[]`）。最后，.NET*不允许*逆变（类型变量`AbilityResult[]`从不包含对真实类型对象的引用`Component[]`）。

希望这可以帮助。否则，我的回答应该给你一些术语，你可以在谷歌上找到优于我的解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:14:59.270

经过一番搜索，我偶然发现了这个问题：[How do I create a C# array using Reflection and only type info?](https://stackoverflow.com/questions/3419456/how-do-i-create-a-c-sharp-array-using-reflection-and-only-type-info)

我的问题的一个可能的解决方案是：

```
A[] someArray = GetElementsInSomeWay();
System.Type type = field.FieldType.GetElementType();
Array filledArray = Array.CreateInstance(type, someArray.Length);
Array.Copy(someArray, filledArray, someArray.Length);
field.SetValue(this, filledArray); 
```

我刚刚测试过，它可以工作。

但是，我仍然想避免复制元素。在我的情况下，数组非常小（最多 3-5 个元素），但如果有一个更清洁的解决方案，仍然会很高兴。*

# c++ - C++ 中的原型

> ID：13790529
> 
> 赞同：2
> 
> 时间：2012-12-09T18:46:38.093
> 
> 标签：c++, prototype

答案只是C和E吗？我对 bool &status 是否可以通过引用传递感到困惑？

您需要一个从指定文件中读取有关电影的数据并通过返回值或参数返回 Movie 对象的函数。它还应该通过返回值或参数返回一些成功或失败的指示。对于上述要求，以下哪项是可能的原型选择？选择所有符合条件的。

```
A.  Movie readMovie(string filename);
B.  bool readMovie(string filename, Movie m);
C.  Movie readMovie(string filename, bool &status);
D.  bool readMovie(string filename, const Movie &m);
E.  bool readMovie(string filename, Movie &m);
F.  Movie readMovie(string filename, bool status); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T20:31:44.413

他们*都可以*工作：

*   A. 如果`Movie`它本身可以有一个*众所周知的坏值*（相当于`end`,`EOF`或`NULL`），或者一个成员来检查它是否处于良好状态，这很好：

    ```
    Movie readMovie(string filename);
    Movie m = readMovie(filename);
    if (m.good() || m != Movie::InvalidMovie || ... ) { 
    ```

    但是，我怀疑提问者*认为*这不能算作*通过返回值表示成功......*

*   B. 如果`Movie`是 typedef'd 到一个指针，或者 a `shared_ptr`，或者如果 Movie 是一个引用计数`MovieImpl`对象的轻量级包装器（例如），这很好（因为调用者的共享状态是通过包装器`readMovie`的*副本改变的）*

    ```
    bool readMovie(string filename, Movie m); 
    ```

    但是，我怀疑提问者*认为*这不能算作*通过 ... 参数表示成功*。（注意。A`Movie`也可以是 typedef、智能指针或其他句柄体样式的东西）。

*   C. 这绝对没问题（甚至提问者都知道）

    ```
    Movie readMovie(string filename, bool &status); 
    ```

*   D. 与 B 相同的约束

    ```
    bool readMovie(string filename, const Movie &m); 
    ```

*   E. 很好

    ```
    bool readMovie(string filename, Movie &m); 
    ```

*   F. 愚蠢的：这*可以*和 A 一样工作，但是状态参数是无用的和误导性的。所以，我敢肯定提问者不希望这会起作用：

    ```
    Movie readMovie(string filename, bool status); 
    ```

* * *

所以，真正可以发挥作用的是：所有这些。

提问者可能想听到的内容：C、E。

你*应该*看什么：

*   设计清晰、富有表现力、高效且易于正确使用的界面（以上都不适合，IMO）
*   适当使用异常而不是返回码（如果失败确实是异常的）
*   `string filename`通过const 引用传递它
*   遇到更好的老师。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T20:58:12.937

电影是一件**大事**，所以应该动态分配。

因此，使用智能指针。

下面的代码演示/证明了每个提议的函数签名如何支持返回加载的电影并检查它是成功还是失败，*并以最自然的方式解释所提供的信息*（特别是“电影”是电影）。

请注意，问题中的签名都是非常糟糕的设计™的示例。

`right`但是，下面代码中命名空间中显示的签名是可以的：

*   它通常支持 Windows 文件名。

*   它确保如果加载失败，调用代码没有可以（错误地）播放的电影对象，这是通过抛出异常来指示失败来完成的。

*   它通过引用传递字符串`const`（为了提高效率和作为一般的好习惯）。

```
#include <memory>           // std::shared_ptr
#include <new>              // std::nothrow
#include <stdexcept>        // std::runtime_error
#include <string>           // std::string

class MovieData
{
    // Whatever
};

//          *** A movie is a big thing, so it should be allocated dynamically. ***
//          *** Therefore, use a smart pointer. ***
//
typedef std::shared_ptr< MovieData > Movie;

namespace a {
    using std::string;
    using std::nothrow;

    Movie readMovie(string filename)
    {
        return 0?0
            : filename == "succeed"?    Movie( ::new(nothrow) MovieData )
            : Movie();
    }

    bool test( string const& filepath )
    {
        Movie const m = readMovie( filepath );
        return (m != nullptr);
    }
}

namespace b {
    using std::string;
    using std::nothrow;

    bool readMovie(string filename, Movie m)
    {
        if( filename != "succeed" || m == nullptr )
        {
             return false;
        }
        *m = MovieData();
        return true;
    }

    bool test( string const& filepath )
    {
        Movie const m( ::new(nothrow) MovieData );
        return readMovie( filepath, m );
    }
}

namespace c {
    using std::string;
    using std::nothrow;

    Movie readMovie(string filename, bool &status)
    {
        status = false;
        if( filename != "succeed" )
        {
            return Movie();
        }
        Movie const result( ::new(nothrow) MovieData );
        status = true;
        return result;
    }

    bool test( string const& filepath )
    {
        bool result = false;
        readMovie( filepath, result );
        return result;
    }
}

namespace d {
    using std::string;
    using std::nothrow;

    bool readMovie(string filename, const Movie &m)
    {
        if( filename != "succeed" || m == nullptr )
        {
            return false;
        }
        *m = MovieData();
        return true;
    }

    bool test( string const& filepath )
    {
        Movie const m( ::new(nothrow) MovieData );
        return readMovie( filepath, m );
    }
}

namespace e {
    using std::string;
    using std::nothrow;

    bool readMovie(string filename, Movie &m)
    {
        if( filename != "succeed" )
        {
            return false;
        }
        m.reset( ::new(nothrow) MovieData );
        return (m != nullptr);
    }

    bool test( string const& filepath )
    {
        Movie m;
        return readMovie( filepath, m );
    }
}

namespace f {
    using std::string;
    using std::nothrow;

    Movie readMovie(string filename, bool status)
    {
        (void) status;  struct status;      // Intentionally not used.
        if( filename != "succeed" )
        {
            return Movie();
        }
        return Movie( ::new(nothrow) MovieData );
    }

    bool test( string const& filepath )
    {
        return (readMovie( filepath, bool() ) != nullptr);
    }
}

namespace right {
    using std::wstring;         // Using wide string supports nearly all Windows filenames.
    using std::runtime_error;

    Movie readMovie( wstring const& filepath )
    {
        if( filepath != L"succeed" )
        {
            throw std::runtime_error( "right::readMovie: failed because ..." );
        }
        return Movie( new MovieData );
    }

    bool test( wstring const& filepath )
    {
        try
        {
            readMovie( filepath );
            return true;
        }
        catch( ... )
        {
            return false;
        }
    }
}

#define TEST( name, filename ) \
    wcout << #name "::readMovie" << "( " << #filename << " ) " \
    << (name ::test( filename )? "succeeded" : "failed") << "." << endl;

#include <iostream>     // std::wcout, std::endl

int main()
{
    using std::wcout;  using std::endl;  using std::boolalpha;

    wcout << boolalpha;
    TEST( a, "succeed" );
    TEST( a, "fail" );
    wcout << endl;
    TEST( b, "succeed" );
    TEST( b, "fail" );
    wcout << endl;
    TEST( c, "succeed" );
    TEST( c, "fail" );
    wcout << endl;
    TEST( d, "succeed" );
    TEST( d, "fail" );
    wcout << endl;
    TEST( e, "succeed" );
    TEST( e, "fail" );
    wcout << endl;
    TEST( f, "succeed" );
    TEST( f, "fail" );
    wcout << endl;
    TEST( right, L"succeed" );
    TEST( right, L"fail" );
} 
```

输出（测试结果）：

```
a::readMovie( "succeed" ) 成功。
a::readMovie("fail") 失败。

b::readMovie("succeed") 成功。
b::readMovie("fail") 失败。

c::readMovie( "succeed" ) 成功。
c::readMovie("fail") 失败。

d::readMovie("succeed") 成功。
d::readMovie("fail") 失败。

e::readMovie( "succeed" ) 成功。
e::readMovie("fail") 失败。

f::readMovie( "succeed" ) 成功。
f::readMovie("fail") 失败。

right::readMovie( L"succeed" ) 成功。
对::readMovie(L"fail") 失败。

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T18:54:05.357

让我们来看看：

*   **A**不提供成功的布尔值指示。错误的。
*   **B**是按值传递`Movie`的，所以它不可能被返回。错误的。
*   **C**返回一个电影，并且`bool`由 ref 传递，因此它将被修改。真的。
*   （跳过）
*   **E**与**C**相反，所以它也可以工作。真的。
*   （返回）**D**与**E**相同，除了它`const Movie`可能是或可能不合适的。 *真的？*
*   **F与****B**相反，并且由于相同的原因而失败。错误的。

这不是一个非常清楚的问题，我会指出我对测试/作业答案的推理。

# ruby-on-rails - 在文本属性（如 HTML）中插入 Rails 对象的交叉超链接的解决方案

> ID：13790533
> 
> 赞同：5
> 
> 时间：2012-12-09T18:47:09.003
> 
> 标签：ruby-on-rails, ruby-on-rails-3, content-management-system, ckeditor, hyperlink

我在 Rails 中的一个 Web 应用程序中工作，它的行为很像 CMS：有文章，它们有一个 text 属性，其中包含指向其他文章（或其他对象类）的链接。我目前将属性存储为 HTML。

有没有什么好的方法可以以相对容易更改的方式对这些链接进行建模，并包含对对象 ID 的引用，而不是绝对 url？

**我在想的解决方案之一**是使用某种特殊标记，例如：

```
[link_to "Text for the link", Article:12] 
```

其中 12 是它链接到的文章的 ID。呈现文本时将解析此标记。

这样做的缺点是我必须侵入 TinyMCE（我想用来编辑 HTML 的编辑器），以便它可以通过访问数据库并自动分配对象类型和 ID 来插入指向其他对象的链接（编辑文本的人不知道 ID）。

**有什么简单的解决方案吗？**

或者我应该坚持使用绝对网址（除了维护问题之外，这在开发中很烦人，因为它们总是指向生产，这让我感到困惑）？

此外，是否有人在其他语言（php、Wordpress、其他 CMS 等）中有类似的示例可以很好地解决这个问题？我在想，这在 CMS 中非常重要，如果一个好的系统可以处理所有这些链接，可以减少很多工时。

**编辑：**

我正在考虑的另一种可能的解决方案是让人们直接在代码中复制文章的链接，但它应该在提交时生成正确的关联 id 并使其在 url 结构发生变化时，链接是始终保持最新。如果您尝试过，我想听听您对这种方法的意见和经验。

这种方法的挑战是用 Rails 解析链接并发现它指向一个文章，并且该文章具有 id `##`。然后我必须插入一个短代码，在解析和呈现时，它总是会转换为该文章的实际链接。

我找到了一种可以使之可行的方法：

```
Rails.application.routes.recognize_path 
```

但可能有一些我现在看不到的警告......

**编辑号 2**

我还想说明我选择[CKEditor](http://ckeditor.com/)作为内容编辑器，但是如果有更明显的优势我会考虑其他的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T19:31:59.270

一篇文章可以有许多related_articles，同时这篇文章可以与许多其他文章相关，因此最好将其建模为多对多关系。

在 Rails 中定义这种类型的关系的一种方法是`has_many :through`.

要使用`has_many :through`你必须创建一个连接模型，也许称之为**ArticleRelation**。该模型将有两个字段，一个代表当前文章的*article_id和一个代表相关文章的**related_article_id*。

```
class Article < AR::Base
  has_many :article_relations
  has_many :related_articles, :through => :article_relations
end

class ArticleRelation < AR::Base
  belongs_to :article
  belongs_to :article_relation, :class_name => 'Article'
end 
```

在创建自我参照关系时，重要的是要记住您只是在创建关系的一侧。尽管**article_1**可能将**article_2**列为相关，但**article_2 无法将 article_1**列为**相关**。您需要两个**ArticleRelation**记录来创建相互关系。

 ****很难想出合适的名称来定义关系的另一端，因此您可以在两者前面加上单词“inverse”来给出**inverse_article_relations**和**inverse_related_articles**。您还需要指定一些附加选项以使关系有效。对于**inverse_article_relations**，您必须指定另一个模型的名称，因为它无法从关系名称中推断出来，并且您还必须将外键定义为**related_article_id**。对于**inverse_related_articles**关系，您需要将源指定为**article**，因为它不能从关系的名称中推断出来。

```
has_many :inverse_article_relations, :class_name => "ArticleRelation", :foreign_key => "related_article_id"
has_many :inverse_related_articles, :through => :inverse_article_relations, :source => :article 
```

测试一下，这应该适合您当前的要求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T16:40:44.840

我使用简码系统构建了类似的东西，它允许我调用模型上的特定方法并替换文本中的简码：

### 帮手

```
def parse_shortcode(model)
  text = model.text      
  text.gsub(/(\[#!\s?\w+\])/i) do |match|
    result = model.try(match)
    result.nil? '' : link_to(result[:text], result[:url])
  end
end 
```

### 模型

```
def contact_link
  { :text => self.name, :url => self.url }
end 
```

### 看法

```
<%= parse_shortcode(@article) %> 
```

我没有测试过上面的代码，它显然有点简化，但它解释了我背后的思考过程。

编辑：只是为了澄清我上面的例子使用了发明的短代码语法`[#! method]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-08T16:54:45.707

我在许多其他 CMS 中看到的解决方案是 TinyMCE 中的自定义文件浏览器和页面重写的组合（类似于freakyDaz 的答案）。

TinyMCE 有实现自定义浏览器的[文档和示例代码。](http://www.tinymce.com/wiki.php/Configuration%3afile_browser_callback)当然，您必须提供后端部分。

CKEditor 也[有类似功能](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/File_Browser_%28Uploader%29/Custom_File_Browser)的文档。

让你的后端实现返回一些易于解析的 URL（例如 urlfor:Article:12），然后让你的渲染代码用实际的 URL 替换那些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-09T19:29:00.017

我只是想到了用例的另一种可能的解决方案：

1.  管理员用户在编辑文本之前指定关系（使用[Chosen.js](http://harvesthq.github.com/chosen/)，这可以以用户友好的方式完成）。
2.  然后该人要么提交表单以保存模型，要么可以异步完成。
3.  保存关系后，将为每个关系生成并显示一个短代码，并且可以轻松地将该短代码粘贴到文本中。
4.  在前端显示文本时，文本将被解析为简码，与[@freakyDaz](https://stackoverflow.com/a/14219816/322253)建议的方式类似。

通过这种方式，我不必在编辑器中破解或创建自定义操作。我认为这是一种非常务实的方法，但我想听听您的意见。当然，应该教育编写文本的管理员按顺序遵循流程，但在我的情况下，很少有人可以成为管理员（1 或 2），所以它是易于管理的。****

# user-interface - 无法在我的 Android 应用中使用 Timer 更新 textView

> ID：13790547
> 
> 赞同：2
> 
> 时间：2012-12-09T18:49:04.603
> 
> 标签：user-interface, timer, textview

我正在尝试创建一个显示当前时间的 Android 应用程序。我想用 Timer 更新我的 Activity 时间，但 TextView 没有更新，所以屏幕上总是只有一个时间。这是我的代码：

```
package com.example.androidtemp;

import java.sql.Date;
import java.text.SimpleDateFormat;
import java.util.Timer;
import java.util.TimerTask;

import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;
import com.example.androidtemp.R;

public class ActivityTime extends Activity
{
    SimpleDateFormat sdf;
    String time;
    TextView tvTime;
    String TAG = "States";

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_activity_time);

        sdf = new SimpleDateFormat("HH:mm:ss");
        time = sdf.format(new Date(System.currentTimeMillis()));

        tvTime = (TextView) findViewById(R.id.tvTime);

        Timer timer = new Timer();
        TimerTask task = new TimerTask()
        {
            @Override
            public void run()
            {
                // TODO Auto-generated method stub
                timerMethod();
            }
        };

        try
        {
            timer.schedule(task, 0, 1000);
        } 
        catch (IllegalStateException e)
        {
            // TODO: handle exception
            e.printStackTrace();
            Log.e(TAG, "The Timer has been canceled, or if the task has been scheduled or canceled.");
        }
    }

    protected void timerMethod()
    {
        // TODO Auto-generated method stub
        this.runOnUiThread(changeTime);
    }

    private  final Runnable changeTime = new Runnable()
    {
        public void run()
        {
            // TODO Auto-generated method stub
            //Log.d(TAG, "Changing time.");
            sdf.format(new Date(System.currentTimeMillis()));
            tvTime.setText(time);
        }
    };
} 
```

有没有人有这个问题的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:56:36.023

使用处理程序，因为它可以访问应用程序的视图。您的应用程序的视图已经属于主线程，因此创建另一个线程来访问它们通常不起作用。如果没有错，处理程序使用消息与主线程及其组件进行通信。在您有线程定义的地方使用它：

```
Handler  handler = new Handler();
handler.removeCallbacks(runnable);
handler.postDelayed(runnable, 1000); 
```

并将其添加到您的可运行定义中

```
handler.postDelayed(runnable, 1000); 
```

当添加新的 on 时，最后一条语句删除任何等待执行的可运行实例。有点像清理队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:21:32.107

如果您只想显示时间，我建议您使用 DigitalClock 或 TextClock（您可以在布局 xml 和 layout / layout-v17 中使用“包含”以使用不同的组件，具体取决于操作系统版本）。

如果您想拥有更多控制权，我建议您使用 Handler 或 ExecutorService 而不是 Timer。[Java Timer vs ExecutorService？](https://stackoverflow.com/questions/409932/java-timer-vs-executorservice)

如果您想按原样修复代码，只需修改变量“时间”的值；）

# python - 在 Python 中覆盖 equals 但仍然有引用相等检查

> ID：13790548
> 
> 赞同：2
> 
> 时间：2012-12-09T18:49:30.117
> 
> 标签：python, equals, overriding

我已经在 Python 中覆盖了 equals，但我仍然想做一个引用相等性检查。在 Java 中，这就是 == 和 equals 之间的区别。Python有类似的能力吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T18:51:07.090

您可以测试两个对象是否是同一个对象`is`：

```
>>> a = 12
>>> a is a
True 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T18:52:01.567

您可以为此目的使用内置[id](http://docs.python.org/2/library/functions.html#id)

```
>>> A=[1]
>>> B=A
>>> id(A) == id(B)
True
>>> A == B
True
>>> C = [1]
>>> A == C
True
>>> id(A) == id(C)
False 
```

# c - 显示 GTK 调试日志消息

> ID：13790559
> 
> 赞同：9
> 
> 时间：2012-12-09T18:50:17.213
> 
> 标签：c, logging, gtk

我对 GTK+ 有点陌生，我正在开始我的第一个项目（一个窗口管理器）。我的问题是这样的：我编写了一个有很多调试消息的程序，写成：

```
g_debug("foo");
...
g_debug("bar"); 
```

我只是想知道如何显示它们，因为它们在运行应用程序时不显示。我试图像这样运行应用程序：

```
./foobar --gtk-debug=all --gdk-debug=all 
```

但是调试消息仍然没有显示。我确定我错过了一些东西，但我似乎找不到路（在问这个之前用谷歌搜索了很多，相信我）。

提前致谢！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-09T23:38:31.847

尝试将[G_MESSAGES_DEBUG](https://developer-old.gnome.org/glib/stable/glib-running.html#G_MESSAGES_DEBUG)环境变量设置为“全部”

```
G_MESSAGES_DEBUG=all ./foobar 
```

# c++ - C++ 集合对象和 iStream 文件输入

> ID：13790560
> 
> 赞同：0
> 
> 时间：2012-12-09T18:50:24.140
> 
> 标签：c++, collections

我今天一整天都被我的代码难住了。我有许多课程来处理曲目和专辑的集合。我的代码编译并成功读取了文件，但是一旦我尝试在我的专辑集合类中使用 istream& 运算符，它就会在运行时出错。

这是错误：

```
 error LNK2001: unresolved external symbol "class std::basic_istream<char,struct    std::char_traits<char> > & __cdecl operator>>(class std::basic_istream<char,struct std::char_traits<char> > &,class AlbumCollection &)" (??5@YAAAV?$basic_istream@DU?$char_traits@D@std@@@std@@AAV01@AAVAlbumCollection@@@Z)1>C:\Users\Shardy\Desktop\AlbumDatabase\Debug\AlbumDatabase.exe : fatal error LNK1120: 1 unresolved externals 
```

我真的很感激一些帮助。它变得令人沮丧。我的书和谷歌都没有透露任何信息。谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:37:38.757

微不足道，在您的主中，您出现了无与伦比的大括号。你的 else 语句应该在 (ie `} else {...}`)之前有一个右大括号

更重要的是，我将尝试解决您主要列出的特定问题（关于编译）。首先，我列出我的假设。看起来，您的实现和接口被适当地分开（即您的类在头文件中声明，而您的实现在源文件中），因为您使用了作用域（`::`）来实现函数。

此外，我假设您的实现与您`operator<<`的 AlbumCollections 实现在同一个文件中。这很好，但是，您的主文件不知道这一点。目前仅针对源文件进行编译。如果没有更多信息，我认为这是解决您问题的关键。您将需要转发声明此运算符，以便它在其他文件中工作。

在专辑集合的头文件中，在声明之后包含前向声明`AlbumCollection`，如下所示（我假设您没有`using`在标题中使用该指令。如果是，您可能不应该使用）：

```
std::istream& operator>>(std::istream& is, AlbumCollection& albums); 
```

您可能需要在标题`#include <iostream>`中才能正确编译。但是，在您包含的任何地方`AlbumCollection.h`（或任何相应的标题被调用），这个重载都是可用的。当您将程序链接在一起时，将使用您之前定义的定义。此外，要使其正常工作，您可能必须`inline`从定义中删除限定符。

请注意，如果这是问题所在，则错误输出可能看起来很可怕。如果您遇到此问题，很多编译器错误输出将消失，并且调试您可能遇到的任何现有代码编译问题将变得更加简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:22:14.700

一些问题：

1.  main.c：如果文件打开成功，说明文件加载成功。如果文件已经加载，为什么还要首先打开文件？嗯，怎么可能？
2.  main.c：你永远不会调用从文件中读取的任何方法。
3.  main.c：您可以使用`if (file)`而不是`if (file.is_open())`
4.  main.c：您`}`在`if`声明中缺少结束语。
5.  main.c：你没有使用`argc`或者`argv`你可以声明`main` 为`main(void)`.
6.  您需要发布类声明（头文件）以及方法定义。
7.  duration.cpp：当您的输入法遇到非数字或空格的内容时，例如“:”，您的输入法会作呕。
8.  duration.cpp：您的加法运算符没有正确执行时间算术，尤其是溢出。尝试将“00:59:35”与“00:02:30”相加。
9.  duration.cpp：您`operator==`将返回最后一个表达式的结果，因为您使用的是逗号、',' 运算符。您可能想要使用`&&`or 逻辑 AND 运算符。
10.  duration.cpp：3 规则：如果定义构造函数、复制构造函数或析构函数，则应声明所有 3 和赋值运算符。
11.  duration.cpp：数学规则：如果你定义`operator+`或者 `operator-`你也应该实现操作符`+=`以及`-=`。请参阅 Boost 数学库。
12.  duration.cpp：排序规则：如果你打算排序或比较，你应该实现运算符`<, <=, ==, !=, >,`和`>=`。提示：将时间转换为秒，这应该会让您在比较时更轻松。请参阅 boost::less_than_comparable。
13.  track.cpp：您的输入法先读取曲目名称，然后读取时长。数据文件首先显示持续时间，然后显示曲目名称。您也没有代码来处理持续时间和列之间的字段分隔符。

    `Yep, a **debugger** would be helpful as well as pencil and paper to go through this code.`

# bash - BASH - 如何从 #SOF 到 #EOF 的文件中检索行

> ID：13790561
> 
> 赞同：2
> 
> 时间：2012-12-09T18:50:29.650
> 
> 标签：bash

如何从#SOF到#EOF的文件中检索行

```
in source.sh
#SOF
"Lorem ipsum dolor sit amet"
"Vivamus pretium enim"
"Est accumsan enim magnis"
#EOF

#SOF
"Eleifend tincidunt id justo"
"Tellus ut tincidunt vel ac a orci"
"Sapien Nullam Sed nunc"
"Vestibulum est accumsan enim"
#EOF

#SOF
"Consequat mauris mollis montes"
#EOF 
```

我需要获取 3 个文件

```
in target_1.sh
"Lorem ipsum dolor sit amet"
"Vivamus pretium enim"
"Est accumsan enim magnis"

in target_2.sh
"Eleifend tincidunt id justo"
"Tellus ut tincidunt vel ac a orci"
"Sapien Nullam Sed nunc"
"Vestibulum est accumsan enim"

in target_3.sh
"Consequat mauris mollis montes" 
```

告诉别人怎么做？谢谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T18:55:14.273

你可以用[awk](/questions/tagged/awk "显示标记为“awk”的问题")做到这一点：

```
awk '/^#EOF$/ {do_print=0}
     do_print {print > ("target_"f_index".sh")}
     /^#SOF$/ {do_print=1; f_index++}' source.sh 
```

**输入输出：**

*   匹配问题中显示的示例。

**解释：**

*   `awk '...'`: 调用 awk，一个逐行操作文本文件的工具。由一组单引号括起来的指令提供给 awk。
*   `/^#EOF$/ {do_print=0}`：是“行首”的`^`正则表达式锚，是“行`$`尾”的锚。在这里我们说，如果我们看到`#EOF`一行中唯一的东西，请关闭打印标志`do_print`。
*   `do_print {print > ("target_"f_index".sh")}`：这是为 awk 解析的每一行运行的。如果`do_print`设置了标志，则将该行附加到具有指定索引的输出文件中`f_index`。
*   `/^#SOF$/ {do_print=1; f_index++}`: 同样，如果我们只看到`#SOF`一行，打开打印标志，然后加`f_index`一。
*   请注意，最后 3 件事是为每行评估的，这就是为什么我们首先查找 EOF，然后打印该行（如果适用），然后再查找 SOF - 我们不想打印`#EOF`或`#SOF`.
*   `source.sh`：指定输入文件的名称`awk`；拯救一只猫。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T18:56:46.783

[awk](/questions/tagged/awk "显示标记为“awk”的问题")会优雅地做到这一点：

```
awk '
    /^#EOF/{l=0}
    l {
        print > "target_" file ".sh"
    }
    /^#SOF/{l=1;file++}
' source.sh 
```

**处理后**

```
$ ls -1t target_*
target_1.sh
target_2.sh
targer_3.sh 
```

**解释**

*   `l {}`等同于因为`if (l==1) {}`是`1`一个*真正的表达式*`awk`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:23:00.813

如果您只想使用[bash](/questions/tagged/bash "显示标记为“bash”的问题")（您只有一个标签），请尝试这样做：

```
#!/bin/bash
c=0
while read a; do
    if [[ $a =~ ^#SOF ]]; then
        l=1
        ((file++))
    fi

    [[ $a =~ ^#EOF ]] && l=0

    if [[ ! $a =~ ^#SOF ]] && ((l==1)); then
        echo $a >> "target_${file}.sh"
    fi
done < input_file 
```

# html - 在我的浏览器 WAMP 中运行 CGI 脚本

> ID：13790562
> 
> 赞同：2
> 
> 时间：2012-12-09T18:50:35.920
> 
> 标签：html, cgi

我正在尝试运行基本的 cgi 脚本来生成一些 html，而我只是得到原始代码，这是通用脚本。还有什么我必须设置的吗，我在windows系统上。

```
 #!/usr/bin/perl

 print "Content-type: text/html\n\n";
 print <<HTML;
 <html>
 <head>
 <title>A Simple Perl CGI</title>
 </head>
 <body>
 <h1>A Simple Perl CGI</h1>
 <p>Hello World</p>
 </body>
 HTML
 exit; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:57:49.990

你应该按照这里的教程：http: [//chromicdesign.com/2009/05/setting-up-perl-for-wampp.html](http://chromicdesign.com/2009/05/setting-up-perl-for-wampp.html)

希望你最终能够启动并运行。

干杯，

# php - 我的函数中包含带有模板标签的文件的问题

> ID：13790565
> 
> 赞同：0
> 
> 时间：2012-12-09T18:51:03.877
> 
> 标签：php

在我自己的函数中，首先我想要`include`一个`html`文件，然后如果在那个包含文件中，我们找到另一个`html`文件名，我想合并第一个包含文件和第二个包含文件的内容。

```
function inc($html){
$include_pattern = "\{\s*include\s*(\(|')\s*([a-zA-Z0-9-.\/-_]+)\s*(\)|')\s*\}";
preg_match_all("/$include_pattern/s",$html,$match);
if($len = count($match[0])){
$i=0;
        while($i<$len){
$file = preg_replace("/$include_pattern/s","$2",$match[0][$i]);

ob_start(); 
         include($file);
         $output = ob_get_contents();
         ob_end_clean();
//$output = $this->inc($output);
        $html = str_replace($match[0][$i],$output,$html);

$i++; 
     }
return $html;

       }
} 
```

在此函数中，如果您查看代码中的注释部分，我尝试获取第二个包含`html`文件的内容。想象一下，如果我们包含`1.html`，如果在这个包含的文件中我们有`2.html`，我们如何显示内容`2.html`和内容`1.html`？

如果您查看下面的图像，则可以清楚地了解当前主题。（我想在图像中获得类似“结果框”的结果）。

![在此处输入图像描述](../Images/26e2977d5c66dc1310cd0eb447d4916b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T13:23:04.667

我修复了我的功能中的问题。有改变的功能和运作良好......

```
function inc($html){
$include_pattern = "\{\s*include\s*(\(|')\s*([a-zA-Z0-9-.\/-_]+)\s*(\)|')\s*\}";
preg_match_all("/$include_pattern/s",$html,$match);
if($len = count($match[0])){
$i=0;
        while($i<$len){
$file = preg_replace("/$include_pattern/s","$2",$match[0][$i]);

ob_start(); 
         include($file);
         $output = ob_get_contents();
         ob_end_clean();

        $html = str_replace($match[0][$i],$output,$html);

$i++; 
     }
return inc($html); 
       }else{
     return $html;
   }
} 
```

# drupal-7 - 如何以编程方式在 drupal 7 中添加语言？

> ID：13790566
> 
> 赞同：2
> 
> 时间：2012-12-09T18:51:04.673
> 
> 标签：drupal-7

我在 drupal 7 中，我想在编写新配置文件时以编程方式添加默认语言以外的语言。并将其设置为默认值。

我不想使用翻译： http: [//localize.drupal.org/translate/downloads](http://localize.drupal.org/translate/downloads)

谁能帮忙？！谢谢 ：）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-10T09:17:45.050

With the Locale [locale_add_language](http://api.drupal.org/api/drupal/includes!locale.inc/function/locale_add_language/7) function. It is possible to create new languages. It also allows to set newly created language as default. In addition you can set default language by setting "language_default" variable to language **object**.

```
variable_set('language_default', $default); 
```

# android - 如何在 XML 视图中指向内部片段

> ID：13790570
> 
> 赞同：0
> 
> 时间：2012-12-09T18:51:40.260
> 
> 标签：android, android-fragments

我在一个活动中有两个内部片段。

活动被称为：`MainFragmentActivity (extends FragmentACtivity)`

里面是这样的：

```
public static class FeaturedFrag extends ListFragment {
public static class TopFrag extends ListFragment { 
```

我如何识别这里？

```
 <fragment
        android:id="@+id/featured_frag"
        android:layout_width="400dp"
        android:layout_height="match_parent"
        class="com.---.---.MainFragmentActvity$FeaturedFrag" />

    <fragment
        android:id="@+id/top_items_frag"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.---.---.MainFragmentActvity$TopItemFrag" /> 
```

将 XML 更改为建议，LogCat 下面。

```
12-05 00:27:35.639: E/AndroidRuntime(1243): Caused by: android.support.v4.app.Fragment$InstantiationException: Unable to instantiate fragment com.---.---.MainFragmentActvit$MasterFrag: make sure class name exists, is public, and has an empty constructor that is public 
```

我确实有一个具有该名称的类，一个空的构造函数并且它是公共的。

**完整的 LogCat：**

```
 12-05 00:37:38.090: E/AndroidRuntime(1384): FATAL EXCEPTION: main
12-05 00:37:38.090: E/AndroidRuntime(1384): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.---.---/com.---.---.master.MainFragmentActivity}: android.view.InflateException: Binary XML file line #10: Error inflating class fragment
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.os.Looper.loop(Looper.java:137)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.ActivityThread.main(ActivityThread.java:4745)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at java.lang.reflect.Method.invokeNative(Native Method)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at java.lang.reflect.Method.invoke(Method.java:511)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at dalvik.system.NativeStart.main(Native Method)
12-05 00:37:38.090: E/AndroidRuntime(1384): Caused by: android.view.InflateException: Binary XML file line #10: Error inflating class fragment
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:704)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:256)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.Activity.setContentView(Activity.java:1867)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at com.---.---.master.MainFragmentActivity.onCreate(MainFragmentActivity.java:85)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.Activity.performCreate(Activity.java:5008)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-05 00:37:38.090: E/AndroidRuntime(1384):     ... 11 more
12-05 00:37:38.090: E/AndroidRuntime(1384): Caused by: android.support.v4.app.Fragment$InstantiationException: Unable to instantiate fragment com.---.---.MainFragmentActivity$MasterFrag: make sure class name exists, is public, and has an empty constructor that is public
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.support.v4.app.Fragment.instantiate(Fragment.java:395)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.support.v4.app.Fragment.instantiate(Fragment.java:363)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:264)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:676)
12-05 00:37:38.090: E/AndroidRuntime(1384):     ... 21 more
12-05 00:37:38.090: E/AndroidRuntime(1384): Caused by: java.lang.ClassNotFoundException: com.kickinglettce.rate_this.MainFragmentActivity$MasterFrag
12-05 00:37:38.090: E/AndroidRuntime(1384):     at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
12-05 00:37:38.090: E/AndroidRuntime(1384):     at android.support.v4.app.Fragment.instantiate(Fragment.java:385)
12-05 00:37:38.090: E/AndroidRuntime(1384):     ... 24 more

Sample code from one of the inner fragments:

    public static class MasterFrag extends ListFragment {

       // fields

        public MasterFrag() {
        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {

            return inflater.inflate(R.layout.mastercat, container, false);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:36:25.287

校对所有代码。确保所有类名都相同，都在同一个包中，等等。否则 Android 不知道任何东西在哪里。

至于你原来的问题，格式是`class = "package.Activity$Fragment"`

# javascript - 如何在 HTML5 CSS3 和 javascript 中复制 Gmail ipad web-app 拆分窗格

> ID：13790572
> 
> 赞同：1
> 
> 时间：2012-12-09T18:52:02.297
> 
> 标签：javascript, html, css, gmail

**今天我想知道适用于iPad**的 GMAIL 网络应用程序是如何工作的。

基本上，页面**分为**两个窗格，两者都是**可滚动**的，并且页面**锚定**到浏览器。

是否可以将其复制到桌面 Web 应用程序？我试图弄清楚这一点。我能想到的唯一方法是*iframes*，但这不是最好的方法。

有什么建议么？

# html - 使用 Perl 的 TokeParser 从标签中提取 URL

> ID：13790575
> 
> 赞同：0
> 
> 时间：2012-12-09T18:52:20.653
> 
> 标签：html, perl, parsing, href

我正在尝试解析 HTML 文档并提取 URL，但无法弄清楚如何获取“a”标签的 href 值。如果有帮助，我正在查看此文档：http: [//perl.active-venture.com/lib/HTML/TokeParser.html](http://perl.active-venture.com/lib/HTML/TokeParser.html)

问题出在第三个“elsif”代码块中。

```
sub findTokens {
my $htmlFileName = $_[0];
my $pagesDir = $_[1];
my %titles = %{$_[2]};
my %mapping = %{$_[3]};
my @outLinks;

my $p = HTML::TokeParser->new("$pagesDir$htmlFileName") 
    or die("Can't open $htmlFileName: \n");
my @tokens;
my $url = $mapping{$htmlFileName};

while (my $newChunk = $p->get_token) {

        if ($newChunk->[0] eq 'T') {
            my @lineArray = split(' ', $newChunk->[1]);
            foreach my $i (@lineArray) {
                if ( lc($i) =~ /^[a-z]*\-?\'?s?$/) {
                    push(@tokens, lc($i));
                }
            }
        } elsif ($newChunk->[0] eq 'S') {
            if ($newChunk->[1] eq 'title') {
                $newChunk = $p->get_token;
                    $titles{$url} = $newChunk->[1];
                    #print $url;
                    #print $titles{$url};
            }
        } elsif ($newChunk->[0] eq 'S') {
            if ($newChunk->[1] eq 'a') {

                my %attr = %{$newChunk->[2]};
                push(@outLinks, $attr{'href'});
            }
        }
}

return (\@tokens, \%titles, \@outLinks); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:10:33.500

恕我直言，`HTML::TokeParser`代表老派。

既然我知道`HTML::TreeBuilder::XPath`了，我就不能回到过去。

您的帖子示例：

```
#!/usr/bin/env perl

use strict; use warnings;

use WWW::Mechanize;
use HTML::TreeBuilder::XPath;

my $m = WWW::Mechanize->new( autocheck => 1 );
$m->get("http://stackoverflow.com/q/13790575/465183");

my $tree = HTML::TreeBuilder::XPath->new_from_content( $m->content );

print join "\n", $tree->findvalues( './/a/@href' ); 
```

请参阅[http://en.wikipedia.org/wiki/Xpath](http://en.wikipedia.org/wiki/Xpath)

# javascript - 如何设置在 Facebook 应用程序上邀请的最少朋友

> ID：13790576
> 
> 赞同：-6
> 
> 时间：2012-12-09T18:52:23.033
> 
> 标签：javascript, facebook, api

我有这段代码在邀请朋友时可以完美运行，

```
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script>
FB.init({
appId:'APP_ID',
cookie:true,
status:true,
xfbml:true

});

function FacebookInviteFriends()
{
FB.ui({
method: 'apprequests',
message: 'Your Message diaolog'

});
}
</script>
<script type='text/javascript'>
if (top.location!= self.location)
{
top.location = self.location
}
</script>

<div id="fb-root"></div>
<a href='#' onclick="FacebookInviteFriends();"> 
Facebook Invite Friends Link
</a> 
```

如何设置好友邀请的最小数量以关闭对话框？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:58:13.657

政策**严格**禁止邀请朋友进一步进入 Facebook 应用程序，老实说，他们只会被标记为垃圾邮件。足够多的内容将使您的应用程序被删除。

# entity-framework-4 - 来自两个数据库的实体框架模型

> ID：13790580
> 
> 赞同：2
> 
> 时间：2012-12-09T18:52:54.583
> 
> 标签：entity-framework-4

是否可以从两个数据库创建实体模型，并在模型中反映表之间的所有关系？你是怎样做的？

我指的是 ADO.NET Entity Framework 版本 4。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T20:19:54.450

也许。这取决于几个因素。

如果使用现代版本的 SQL Server，有一个称为 Synonyms 的功能，它允许您将表从一个数据库“映射”到另一个数据库。

不幸的是，EF 数据设计器无法识别或理解同义词。有一种方法可以手动将两个 .EDMX 文件合并为一个，但这是一个巨大的痛苦。

使用同义词时，我更喜欢使用 Code First 方法。我使用 Entity Framework Power Tools 扩展将表逆向工程为代码优先模型，这适用于同义词。

如果你想使用 .EDMX，那么你可以尝试这里的方法：

[http://rachel53461.wordpress.com/2011/05/22/tricking-ef-to-span-multiple-databases/](http://rachel53461.wordpress.com/2011/05/22/tricking-ef-to-span-multiple-databases/)

# java - 按钮单击 onListener 并转到不同的 xml 布局

> ID：13790581
> 
> 赞同：2
> 
> 时间：2012-12-09T18:52:55.307
> 
> 标签：java, oop

我想单击保存按钮并转到不同的布局文件（layout_save）。我在 Button.on Click Listener() 上收到一条错误消息，并说不能解析为类型。

这是我的代码；

protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState);

```
 setContentView(R.layout.activity_final_project);

    Button buttonOne = (Button) findViewById(R.id.button1);
    buttonOne.setOnClickListener(new Button.onClickListener(){
        public void onClick(view v){
            setContentView(R.layout.layout_save);

        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:30:19.017

您不必在 setOnClickListener 方法中指定 onclicklistener 的实例。您需要做的就是像这样实例化一个新的点击监听器。

```
buttonOne.setOnClickListener(new OnClickListener(){
        public void onClick(View v){
            setContentView(R.layout.layout_save);

        }
    }); 
```

onclicklistner 已经从 set 方法中知道它是什么实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T03:47:20.877

您可能想尝试创建一个`Intent i = new Intent(this, ActivityThatSaves.class)`where 这是您正在进行的任何活动，而 ActivityThatSaves 是与您想要显示的 XML 布局相关的任何活动。然后，调用`startActivity(i)`

# java - Java获取用户输入的名字，姓氏，年龄，按字母顺序然后按年龄排序

> ID：13790583
> 
> 赞同：-1
> 
> 时间：2012-12-09T18:53:11.027
> 
> 标签：java, arrays, arraylist

> **可能重复：**
> [对 2 个数组列表进行排序的最佳方法？](https://stackoverflow.com/questions/13014952/best-way-to-sort-2-array-lists)

```
package bubblesort;

import java.util.*;

public class BubbleSort {

public static void main(String[] args)
{
    Scanner input = new Scanner(System.in);
    Scanner input2 = new Scanner(System.in);
    List<String> lastnamesList = new ArrayList();
    List<String> firstnamesList = new ArrayList();
    List<Integer> ageList = new ArrayList();       
    List<String> fullnamesList = new ArrayList();
    int decider;
    String EOF = "EOF";

    System.out.println("Enter in 0 to sort by Last Name, Enter in 1 to sort by Age");
    decider = input.nextInt();

    /*if(decider == 0)
    {
    System.out.println("Sorting by Last Name");
        for(int i=0;i<3;i++)
        {
        System.out.println("Please Enter in your Last Name, FirstName, Age: " );
        fullnamesList.add(input2.nextLine());
        }
    Collections.sort(fullnamesList);
    System.out.println("Sorting by Last Name: ");
    System.out.println(fullnamesList);
    }*/ 
    //String[] lastnamesArray = lastnamesList.toArray(new String[lastnamesList.size()]);
    //String[] firstnamesArray = firstnamesList.toArray(new String[firstnamesList.size()]);
    if(decider == 1)
    {
    System.out.println("Sorting by Age");
        for(int i=0;i<3;i++)
        {
        System.out.println("Please Enter in your Last Name: " );
        lastnamesList.add(input2.nextLine());
        System.out.println("Please Enter in your First Name: " );
        firstnamesList.add(input2.nextLine());
        System.out.println("Please Enter in your Age: " );
        ageList.add(input.nextInt());

        }

    String[] firstnamesArray = firstnamesList.toArray(new String[firstnamesList.size()]);
    String[] lastnamesArray = lastnamesList.toArray(new String[lastnamesList.size()]);
    fullnamesList.addAll(firstnamesList);
    fullnamesList.addAll(lastnamesList);
    String[] fullnamesArray = fullnamesList.toArray(new String[firstnamesList.size()+lastnamesList.size()]);

    Collections.sort(fullnamesList);
    System.out.println("Sorting by Age");
    System.out.println(fullnamesList);
    }
}
public static void sortStringBubble(String x[])
{
    int j;
    boolean flag = true;
    String temp;

    while(flag)
    {
        flag = false;
        for(j = 0;j < x.length -1 ; j++)
        {
            if (x [j].compareToIgnoreCase(x[j+1])>0)
            {
                temp = x[j];
                x[j] = x[j+1];
                x[j+1] = temp;
                flag = true;
            }
        }
    }
} 
```

}

我试图将名字、姓氏和年龄放在一起，但我希望它按字母顺序排序，而不是单独排序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T18:54:42.183

代替

```
List<String> lastnamesList = new ArrayList();
List<String> firstnamesList = new ArrayList();
List<Integer> ageList = new ArrayList(); 
```

利用

```
List<Person> personList = new ArrayList<>(); 
```

`Person`您自己编写的课程在哪里。比只有一个列表要排序。

`Person`会有字段`lastName`,`firstName`和`age`，所以他们会一直在一起。

另外，请参阅[this](https://stackoverflow.com/questions/13014952/best-way-to-sort-2-array-lists)和[this](https://stackoverflow.com/questions/10213493/can-i-sort-two-lists-in-relation-to-each-other) post，或其中[一些](https://stackoverflow.com/search?q=java%20sort%20two%20lists)。

# c# - c# 4.0、async CTP 和 async C# 5.0 兼容吗？

> ID：13790587
> 
> 赞同：2
> 
> 时间：2012-12-09T18:53:19.730
> 
> 标签：c#, async-await, async-ctp

我有一个使用异步 CTP 库的应用程序能够使用 async/await 关键字，并且我知道 C# 的实际版本 5.0 默认具有此功能，并且它并不是异步 CTP 的所有确切版本。我的意思是，例如在异步 CTP 中存在 TaskEx，而在 C# 5.0 中不存在，是 Task。

但是尽管有这些差异，我想知道异步方法返回的 Task 对象是否相同。

就我而言，我有一个用于存储库访问数据库的接口。目前这个存储库是由一个使用 C# 4.0 的类实现的，但它可以使用 asyc CTP 返回一个 Task 并使用 await keyowrd。但在未来，我想使用其他使用 C# 5.0 的类。

如果我的接口定义了一个返回任务的方法，我可以用使用 C# 4.0 的类和使用 C# 5.0 的类来实现这个接口吗？还是异步 CTP 和 C# 5.0 中的 Task 对象存在差异？

PD：我更正了 C# 的版本，我的意思是 5,0 而不是 C# 4.5。

PD2：似乎有了 VS2012，我可以使用 Microsoft.Bcl.Async 和 Microsoft.CompilerServices.AsyncTargetingPack 在目标是 .NET 4.0 的项目中使用 asyn/await 关键字。但我不知道它们之间有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T21:32:08.947

它与`Task`返回的类型相同。这种类型是在 .NET 4.0 中作为任务并行库的一部分引入的。

但是，如果我是您，我会将所有内容升级到 VS2012，将 Async CTP 替换为[Microsoft.Bcl.Async](https://nuget.org/packages/Microsoft.Bcl.Async)。底层编译器类型*不同*（并且相互不兼容），并且 Async CTP 中存在已知错误以及安装问题。

# javascript - Google map API 3 / javascript：标记突然变得不可见

> ID：13790589
> 
> 赞同：0
> 
> 时间：2012-12-09T18:53:32.720
> 
> 标签：javascript, google-maps, google-maps-api-3

我创建了一个带有自定义标记的谷歌地图。

该项目上线 10 个月。一切正常，突然所有自定义标记都变得不可见。

之前的地图是这样的：

![在此处输入图像描述](../Images/78d51ba8893ef1f9f7c819610fa2f71f.png)

我最近没有更改代码。我已经恢复了备份，问题仍然存在。

你能帮我理解发生了什么吗？

[点击这里在线查看谷歌地图项目。](http://www.reflexion-graphic.com/projets/google-map/google-map-fancybox.html)

要使用地图，只需单击地图底部的链接 (Invisibles_décalcomanie xx)。链接将地图移动到坐标。

我注意到了一些事情。如果用户缩小地图，可以看到标记（见图）。但是如果用户放大，它们会在错误的位置并消失。

![谷歌地图问题，看不到标记](../Images/509bdbc3ff6e39017279162c04b4b9da.png)

这是一个错误吗？我的代码可能是错误的。或者谷歌最近对 API 做了一些改变？

Javascript 代码（可以在源代码底部的演示中看到）：

```
 var markerArray = [];

    function initialize() {

    // Tableau images avatars
    var myLatlng = [
    // Ligne vide sinon décalage dans la boucle pour remplir tableau locations
      [47.263167,-1.579706,300,201,300,201],
      [47.264108,-1.575928,134,201,300,201],
      [47.265203,-1.581125,300,201,300,201],
      [47.259506,-1.568975,300,201,300,201],
      [47.254894,-1.565697,300,201,300,201],
      [47.254617,-1.576264,300,201,134,201],
      [47.261639,-1.571083,300,201,300,201],
      [47.253819,-1.574989,300,201,300,201],
      [47.256592,-1.575986,300,201,300,201],//9
      [47.259722,-1.575022,300,201,180,201],//10
      [47.262311,-1.577317,300,201,300,201],//11
      [47.258419,-1.566647,300,201,300,201],//12
      [47.26115,-1.570781,300,201,300,201],//13
      [47.261325,-1.566986,300,201,300,201],//14
      [47.260411,-1.565275,300,201,300,201],//15
      [47.255786,-1.571194,300,201,300,201],//16
      [47.252592,-1.568464,300,201,300,201],//17
      [47.261639,-1.582647,300,201,300,201],//18
      [47.255919,-1.569056,300,201,300,201],//19
      [47.260525,-1.574483,300,201,300,201],//20
      [47.25915,-1.566611,300,201,300,201],//21
      [47.264331,-1.576933,300,201,300,201],//22
      [47.257569,-1.576986,300,201,300,201],//23
      [47.258964,-1.578256,300,201,300,201],//24
      [47.260611,-1.563364,300,201,300,201],//25
      [47.252789,-1.566597,300,201,300,201],//26
      [47.253031,-1.569664,300,201,300,201],//27
      [47.258797,-1.573606,300,201,300,201],//28
      [47.261233,-1.573161,300,201,300,201],//29
      [47.264911,-1.578775,300,201,300,201],//30
      [47.265519,-1.578975,300,201,300,201],//31
      [47.264847,-1.575,300,201,300,201],//32
      [47.258528,-1.568064,300,201,300,201],//33 en attente erreur
      [47.261619,-1.572919,300,201,300,201],//34
      [47.261642,-1.573192,300,201,300,201],//35
      [47.263653,-1.578083,300,201,300,201]
    ];

        // contient le html
        var locationsInfos;
        //Tableau contient les infos relatives au markeurs, etc.
        var locations = [];

        //Boucle pour remplir le tableau
        for (j = 0; j < 35; j++) { 
        //alert(myLatlng[j][2]); 
        //alert('width : '+myLatlng[j][2]);

        locationsInfos = '<div class="popup">Arnaud Théval<br/>Invisibles_décalcomanie '+j+'/36<br/>2012<br/><a href="http://www.arnaudtheval.com/1-46-invisibles-decalcomanie.php" target="_blank" >en savoir +</a><br/><br/><a href="google-map/img/photos/THEVAL-decalcomanie-'+j+'a.jpg" class="fancybox" title="Invisibles_décalcomanie '+j+'" ><img src="google-map/img/THEVAL-decalcomanie-'+j+'a.jpg" width="'+myLatlng[j][2]+'" height="'+myLatlng[j][3]+'"/></a><a href="google-map/img/photos/THEVAL-decalcomanie-'+j+'b.jpg" class="fancybox" title="Invisibles_décalcomanie '+j+'"><img class="image_2" src="google-map/img/THEVAL-decalcomanie-'+j+'b.jpg" width="'+myLatlng[j][4]+'" height="'+myLatlng[j][5]+'"/></a></div>';

      //On remplit le tableau
        locations.push([locationsInfos, myLatlng[j][0], myLatlng[j][1], 4,'google-map/img/'+j+'-avatar.png']);
    };// en of loop

    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 14,
      center: new google.maps.LatLng(47.259981,-1.575233, 4),
          mapTypeControl: true,
        mapTypeControlOptions: {
      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
    },
    navigationControl: true,
     navigationControlOptions: {
        style: google.maps.NavigationControlStyle.SMALL,
        position: google.maps.ControlPosition.TOP_RIGHT
    },
        scaleControl: true,
    streetViewControl: false,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var infowindow = new google.maps.InfoWindow();

    var marker, i;

    //var point = 0;

    // Boucle création marqueurs
    // Loop create markers
   for (i = 0; i < locations.length; i++) { 
      marker = new google.maps.Marker({
        position: new google.maps.LatLng(locations[i][1], locations[i][2]),
        icon: new google.maps.MarkerImage(locations[i][4], new google.maps.Size(60,130), new google.maps.Point(0,0), new google.maps.Point(0, 150)),
        map: map
      });

      // Tableau : on stock les objets markers
      // Array : markers object
      markerArray.push(marker);

      google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          infowindow.setContent(locations[i][0]);
          infowindow.open(map, marker);
        }
      })(marker, i));
    }

    // test

    google.maps.event.addListener(map, 'click', function() {
            infowindow.close();
            infowindow.close(map, marker);
        });

    }

    // This function picks up the click and opens the corresponding info window
    function openMarker(i) {         
         //To force the click, 
         //you need to call google.maps.event.trigger 
         //which takes two params (instance, event)
         google.maps.event.trigger(markerArray[i], 'click');
         //map.setCenter(marker.position);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:07:47.363

您的地图使用的是 Google Maps API v3 的 v3.10，[即“已发布”版本](https://developers.google.com/maps/documentation/javascript/basics#Versioning)。一旦成为“发布”版本，标记就会出现许多问题。作为测试，尝试将版本硬编码为 3.9。为此，请更改此行：

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
```

到

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?v=3.9&sensor=false"></script> 
```

如果可行，请提出[问题](http://code.google.com/p/gmaps-api-issues/)（或星号和现有问题），因为大约 6 个月后，v3.9 将永久消失（当 3.10 变为“冻结”时）。

MarkerImage 类最近也被弃用了，取而代之的是[“Icon”对象](https://developers.google.com/maps/documentation/javascript/reference#Icon)

# windows - 如何将 Windows 上的 Git 升级到最新版本

> ID：13790592
> 
> 赞同：866
> 
> 时间：2012-12-09T18:53:46.320
> 
> 标签：windows, git, upgrade

我刚刚从以前的版本升级到 Git 1.8.0.1 for Windows `1.7.9.mysysgit.0`。[我从 Git 站点](http://cloud.github.com/downloads/msysgit/git/Git-1.8.0-preview20121022.exe)下载了新版本，并通过普通的 Git 安装程序 EXE 安装。

也就是说，当我启动终端窗口时，它仍然显示我正在运行 Git 版本`1.7.9.mysysgit.0`。当我`git --version`从提示中键入时，同样的事情。

我发现[这篇文章与 Mac OS X 上的 Git 有类似的问题](https://stackoverflow.com/questions/8957862/how-to-upgrade-git-to-latest-version-on-mac-osx-lion)，这让我相信它与故障有关`PATH`，但我仍然很新（五个月自学），所以我我不知道如何将其转换为 Windows。

[当我开始一个新的Ruby on Rails](https://en.wikipedia.org/wiki/Ruby_on_Rails)项目并尝试将其推送到 Git时，就出现了这个问题。我添加了遥控器：

```
git remote add origin git@github.com:brianscottk/blog.git 
```

然后：

```
git push -u origin master 
```

我收到以下错误消息：

> *致命：[https](https://github.com) ://github.com未找到参考文献：您是否在服务器上运行了 git update-server-info ？*

谷歌搜索该错误导致我看到[这篇文章](https://help.github.com/articles/https-cloning-errors)，这促使我升级，我在这里。

* * *

## 回答 #1

> 赞同：1773
> 
> 时间：2018-02-22T09:48:41.523

从 Git 2.16.1(2) 开始，您可以使用

```
C:\> git update-git-for-windows 
```

在 2.14.2 和 2.16.1 之间的版本中，命令是

```
C:\> git update 
```

（它后来被重命名以避免与更新本地存储库混淆，例如这样`svn update`做。）

该命令在 Git 2.13 及之前版本中不存在。

如果出现“不是 git 命令”的错误，那么要么您实际上没有适用于 Windows 的 Git，要么您的版本非常旧。

在这种情况下，只需从[https://git-scm.com/download](https://git-scm.com/download)获取最新的安装程序（检查您想要 32 位还是 64 位）并运行它来升级。

如果您已经拥有最新版本，它不会执行任何操作，在这种情况下，您可以手动运行安装程序重新安装。

```
C:\> git update-git-for-windows
Git for Windows 2.17.0.windows.1 (64bit)
Up to date 
```

* * *

## 回答 #2

> 赞同：228
> 
> 时间：2019-03-15T10:08:05.320

首先，使用此命令检查您的 Git 版本

```
git version 
```

然后根据你的Git版本跟进case

三种情况：

1.  如果您的 Git 版本是 2.14.1 或更早版本：

    **卸载 Git，下载最新的[Git](https://git-scm.com/download/win)，然后重新安装。**

2.  以及 2.14.2 和 2.16.1 之间的版本：

    使用命令**`git update`**

3.  如果版本等于或大于 Git 2.16.1(2)：

    使用命令**`git update-git-for-windows`**

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2020-07-16T13:31:55.197

只需在命令提示符下输入以下命令。

```
git update-git-for-windows 
```

这将要求您进行如下确认。按 Y 继续。

[![在此处输入图像描述](../Images/fda57fba2271ab591e77eff54c9f3474.png)](https://i.stack.imgur.com/qNz8s.png)

下载文件后，*继续*正常的安装过程。您可以在安装完成后使用以下命令检查 Git 版本：

```
git version 
```

对我来说，结果如下。

[![在此处输入图像描述](../Images/53e0fb87475e6e0e5ee921eb3d982b98.png)](https://i.stack.imgur.com/fPcMq.png)

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2020-03-30T08:52:12.337

### 重击

请注意，如果您想找出正在运行的[Git Bash](https://superuser.com/questions/1053633/what-is-git-bash-for-windows-anyway)版本，或者想查看是否需要更新 Git Bash，它是*Git for Windows*的一部分。

所以你的 Git Bash 版本是：

```
git --version 
```

> git 版本 2.23.0.windows.1

请注意，它在技术上与*Bash*不同。当我运行时在我的同一台机器上：

```
echo $BASH_VERSION 
```

> 4.4.23(1)-发布

### 适用于 Windows 安装程序的 Git

要更新到最新版本的 Git 和 Git Bash，您可以[下载](https://gitforwindows.org/)并安装最新版本的[Git for Windows](https://gitforwindows.org/)。根据此[常见问题解答](https://github.com/git-for-windows/git/wiki/FAQ#how-do-i-update-git-for-windows-upon-new-releases)，如果设置/自定义安装在适当的配置文件夹中，则应保留它们。

注意：他们的安装程序实际上是为做正确的事情而设计的（尽管它不会预先告诉您它会自动默认为您之前的设置！）。
如果您正在进行更新，则安装程序上的每个屏幕都预先标记了您*当前*（即将是以前）安装中的设置。

它没有向您显示通用默认设置。您无需查看其中任何一个，也无需担心会破坏您精心打磨的设置。保持一切原样，以保留您之前的选择。

事实上，他们让它变得更加容易（如果他们这样做很明显的话）。

底部有一个复选框`[] Show only new settings`（我不记得确切的措辞）。由于在您标记该框时第一个屏幕上没有任何变化，因此它的用途并不十分明显。如果您标记该框，则您当前的所有设置都将保留，并且会跳过向您显示那些（后续）设置屏幕。仅显示具有新引入设置的屏幕。

### `git update-git-for-windows`

或者，正如其他人所指出的，您还可以通过以下方式从 Git Bash 命令行更新 Git Bash 和 Git（根据定义，两者总是同时更新）：

```
git update-git-for-windows 
```

如果您键入`git update`，Git 会提醒您该命令已更新为`git update-git-for-windows`：

> 警告！`git update`已被弃用；
> 请`git update-git-for-windows`改用。
> Git for Windows 2.26.0.windows.1 (64bit)
> 最新

* * *

## 回答 #5

> 赞同：44
> 
> 时间：2016-09-26T13:33:40.077

更新（2016 年 9 月 26 日）：不再需要卸载以前版本的 Git 来将其升级到最新版本；在[Git Windows 下载站点上](https://git-scm.com/download/win)找到的安装程序包可以解决所有问题。只需按照提示操作即可。

有关其他信息，请按照[安装和升级 Git](https://confluence.atlassian.com/bitbucketserver/installing-and-upgrading-git-776640906.html)的说明进行操作。

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2020-01-14T04:41:33.230

如果你只是输入

```
git update-git-for-windows 
```

如果您遇到问题，请以管理员身份运行 Bash 或将“git.exe”路径添加到“通过受控文件夹访问允许的应用程序”。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2021-01-20T03:48:21.650

[![通过命令提示符更新 Git](../Images/509e8d0147522a31dc38d6b5fe59a758.png)](https://i.stack.imgur.com/oI7sr.png)

1.  检查版本：`git --version`

2.  如果您的 Git 版本是 2.27.0.windows.1 或更早版本

3.  如果版本等于或大于 Git 2.27.0.windows.1

4.  使用命令`git update-git-for-windows`

如果您想观看视频教程，[请单击此处](https://youtu.be/QhCL4bZyHKE)。

* * *

## 回答 #8

> 赞同：25
> 
> 时间：2019-12-18T05:41:24.373

赶紧跑：

```
git update-git-for-windows 
```

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2020-07-12T04:22:24.603

如果你已经安装了 Git，你可以使用命令更新 Git

`git update-git-for-windows`

要了解当前版本，请使用：

`git --version`

您可以在`cmd prompt`.

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2015-06-16T17:54:24.793

使用命令“where git”找出命令提示符如何获取版本。获得路径后，您可以继续完全卸载/删除以前的版本。然后，如果您安装并确保新安装的位置在路径中，它应该可以正常工作。

[使用像cmder](http://cmder.net/)这样对git 友好的工具会让你的生活更轻松。你真的不必再使用双启动或 cygwin 了，因为 Windows 中对 git 的支持现在已经是一流的了。（Windows 版的 Git 安装了 msysgit，其中包括来自 MinGW 的所有必要的 unix 工具。MinGW 已经存在了一段时间并且非常稳定。如果你愿意，你可以安装完整版的 msysgit 而不是[Windows](http://msysgit.github.io/)版的 Git。msysgit在 Git 上可用windows页面在底部。）

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2021-03-09T14:04:06.053

您可以使用，

```
git update 
```

或者，如果您在 Windows 机器上，您可以运行以下命令，

```
git update-git-for-windows 
```

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2021-10-28T02:26:57.877

```
PS Z:\MERN-STACK-ECOMMERCE-PROJECT> git --version
git version 2.31.0.windows.1

PS Z:\MERN-STACK-ECOMMERCE-PROJECT> git update-git-for-windows
Git for Windows 2.31.0.windows.1 (64bit)
Update 2.33.1.windows.1 is available
Download and install Git for Windows 2.33.1 [N/y]? y
############################################################################################################ 100.0%-
############################################################################################################ 100.0% 

PS Z:\MERN-STACK-ECOMMERCE-PROJECT> git --version
git version 2.33.1.windows.1
PS Z:\MERN-STACK-ECOMMERCE-PROJECT> 
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2012-12-09T20:58:42.407

根据[Simon 的回答](https://stackoverflow.com/questions/13790592/how-to-upgrade-git-on-windows-to-the-latest-version/13790866#13790866)，我首先卸载了新版本的 Git。然后我将新版本的 Git 重新**安装到与旧版本相同的目录中**，`C:/RailsInstaller/Git`而不是默认目录`C:/Git`。

现在我的 Ruby on Rails 终端窗口显示我正在运行新的 Git 版本 1.8.0。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2012-12-09T19:24:12.300

要检查您的`PATH`变量，请执行以下操作：

1.  在桌面上，右键单击*我的电脑*，然后单击*属性*。
2.  单击左栏中的*高级系统设置链接。*
3.  在“*系统属性*”窗口中单击`Environment Variables`按钮。

到达那里后，滚动以获取该`Path`行。您将获得一长串路径（例如`C:\windows\bin;C:\program files\git`，等）。

找到`git`被引用的一行或多行。然后，确保此路径指向您的 Git 1.8.x 安装。如果没有，请将其删除并添加最新 Git 版本的真实路径。最后，您应该在字符串中只有一个路径链接到 Git。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2020-02-16T21:08:50.870

如果您在*“git via git”部分查看*[Git 网站](http://git-scm.com/download)上的最新更新，您将看到更新旧版本的选项。

 *这是 git 在其网站上的命令：

```
git clone https://github.com/git/git 
```

它适用于我的 git 版本，它是一个`2.13.0.windows.1`.

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2012-12-10T05:46:04.267

我认为您的问题与 Windows 的全局*PATH*环境变量无关，因为`remote`特定于存储库。

[我推荐你在Cygwin](https://en.wikipedia.org/wiki/Cygwin)下使用 Git 。Git 可以在 Windows 命令行下工作，但可能会出现一些难以解决的奇怪问题。在 Cygwin 下，它更自然，错误更少。

您只需输入`bash`Window CMD，然后开始使用 Unix 工具和命令。您可以使用快捷方式加载`bash`；它就像使用普通的 Windows CMD 一样简单。

Ruby on Rails 和 Ruby 也是如此。我之前用过RailsInstaller，但是我发现用Cygwin安装Rails更稳定。

最后，如果你有时间（大约一个月来熟悉它），我会建议安装[Ubuntu双启动。](https://en.wikipedia.org/wiki/Ubuntu_%28operating_system%29)Windows 最终对每个 Unix 工具都不是很友好。你会发现所有的痛苦都停止了。*

# java - 列出所有联系电话和短信的优化方式？

> ID：13790593
> 
> 赞同：2
> 
> 时间：2012-12-09T18:53:50.173
> 
> 标签：java, android, sms, contacts

我正在开发一个小型应用程序，以便获得更多的 Android 开发经验。我编写了一个列出所有联系电话和总消息的方法（就像 GoSMS 或默认 SMS 应用程序一样）。但我现在面临的问题是性能缓慢。以下是我为获得结果所做的工作。

样本结果：AAA 先生 (10000)

脚步：

1.  获取所有短信线程 ID
2.  循环并获取属于每个线程 ID 的消息总数。
3.  获取属于该线程的联系电话。
4.  使用该号码和 PhoneLookup 获取联系人姓名。

这是方法：

```
public void populateContactList()
{

    // Get all sms threads
    Cursor smsAddressCursor = getContentResolver().query(
            SMSCVar.CONTENT_URI, 
            new String[] { "DISTINCT "+SMSCVar.THREAD_ID}, 
            null, 
            null, 
            null);

    while(smsAddressCursor.moveToNext())
    {
        Contact c = new Contact();

        // Get thread_id
        String thread_id = smsAddressCursor.getString(smsAddressCursor.getColumnIndex(SMSCVar.THREAD_ID));

        // Get total messages
        Cursor totalMessage = getContentResolver().query(
                SMSCVar.CONTENT_URI, 
                new String[] {"count("+SMSCVar.BODY+")"}, 
                SMSCVar.THREAD_ID+" = ?", 
                new String[] {thread_id}, 
                null);

        totalMessage.moveToNext();
        c.setNumberOfSMS(totalMessage.getInt(0));
        totalMessage.close();

        // Get number
        Cursor number = getContentResolver().query(
                SMSCVar.CONTENT_URI, 
                new String[] {SMSCVar.ADDRESS}, 
                SMSCVar.THREAD_ID+" = ?", 
                new String[] {thread_id}, 
                null);
        number.moveToNext();
        String pNumber = number.getString(0);
        number.close();

        // Get contact name
        Uri uriPhonenumber = Uri.withAppendedPath(ContactsContract.PhoneLookup.CONTENT_FILTER_URI
                , Uri.encode(pNumber));

        Cursor contactDisplayName = getContentResolver().query(
                uriPhonenumber, 
                new String[] {ContactsContract.PhoneLookup.DISPLAY_NAME}, 
                null, 
                null, 
                null);

        // If cursor is not null and has at least one result
        if(!contactDisplayName.isNull(0) && contactDisplayName.getCount() > 0)
        {
            // Get contact name for display
            contactDisplayName.moveToNext();
            c.setContactName(contactDisplayName
                    .getString(contactDisplayName
                            .getColumnIndex(ContactsContract.PhoneLookup.DISPLAY_NAME)));
        }
        else
        {
            // Get contact number for display
            c.setContactName(pNumber);
        }

        // Don't get confuse here, setContactNumber method is not used for display purpose.
        c.setContactNumber(pNumber);

        contactListAdapter.add(c);
        contactDisplayName.close();

    }
    smsAddressCursor.close();

} 
```

我已经编码正确关闭光标，但我仍然收到 GARBAGE COLLECTOR 消息和缓慢的检索时间（5 秒）。我的短信超过 11000 条。

所以请帮助我！

谢谢！

P/S：我不是以英语为母语的人，所以我已尽力使我的问题易于理解。

# c# - ToArray() 是否针对数组进行了优化？

> ID：13790597
> 
> 赞同：7
> 
> 时间：2012-12-09T18:54:11.957
> 
> 标签：c#, arrays, linq, resharper

ReSharper 建议枚举`IEnumerable<T>`一个列表或数组，因为我有*“可能的多个枚举`IEnumerable<T>`”*。

建议的自动代码重构内置了一些优化，以查看`IEnumerable<T>`在调用之前是否已经是一个数组`ToArray()`。

```
var list = source as T[] ?? source.ToArray(); 
```

*   这个优化不是已经内置在原始的 LINQ 方法中了吗？
*   如果没有，不这样做的动机是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T18:58:42.867

不，没有这样的优化。如果 source 是`ICollection`，那么它将被复制到新数组中。这是`Buffer<T>`结构的代码，用于`Enumerable`创建数组：

```
internal Buffer(IEnumerable<TElement> source)
{    
    TElement[] array = null;
    int length = 0;
    ICollection<TElement> is2 = source as ICollection<TElement>;
    if (is2 != null)
    {
         length = is2.Count;
         if (length > 0)
         {
             array = new TElement[length]; // create new array
             is2.CopyTo(array, 0); // copy items
         }
    }
    else // we don't care, because array is ICollection<TElement>

    this.items = array;
} 
```

这是`Enumerable.ToArray()`方法：

```
public static TSource[] ToArray<TSource>(this IEnumerable<TSource> source)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    Buffer<TSource> buffer = new Buffer<TSource>(source);
    return buffer.ToArray(); // returns items
} 
```

# c - 在 C 中使用带有结构和指针的 malloc

> ID：13790601
> 
> 赞同：-1
> 
> 时间：2012-12-09T18:54:28.157
> 
> 标签：c, pointers, struct, malloc

我对 C 有点陌生，我试图了解 malloc() 与结构和指针的使用。这是我正在尝试编写的程序片段

```
typedef struct
{
    char *id;
    char *ocup;
    char cj[15]; //data to fill the vector
} T1;

typedef struct
{
    T1 *a1;
    T1 *a2;
} T2;

T2* Aloc(int mp)
{
    T1 *p,*s;

    T2 *af = (T2*)malloc(sizeof(T2));
    if(af == NULL)
        return 0;
    af->a1 = (T1*)malloc(sizeof(T1) * mp);
    if(af->a1 == NULL)
        return 0;
    // trying to go through the freshly created vector
    // but without success 
    for(p = af->a1, s = p + mp; p < s; p++)
        af->a2 = p;
    return af;
}

// mp = size of the struct 
```

`T1 *a1`是向量的起始地址

`T2 *a2`是它的结尾（......或者它可能在向量中我想要的任何地方结束）

如果我尝试编译上面的代码，编译器会冻结。我没有主意了。我究竟做错了什么？:(

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:12:02.223

除了看起来很难阅读并且可能导致内存泄漏的代码之外，我会坚持说这段代码应该在没有“冻结”的情况下运行。

根据您的问题，它在编译期间冻结，这意味着您的编译器存在问题。虽然这可能与正在编译的代码有关，但编译器而不是您的代码需要修复。

如果您说错了并且在运行时发生了冻结，那么您需要更仔细地分析发生冻结的位置，因为我不相信它仅在此代码中。如今，大多数编译器都带有调试器。通过学习使用它，你会帮自己一个很大的忙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T00:28:24.433

就像乔纳森伍德说的我认为你有一个糟糕的编译器，编译器永远不应该锁定或崩溃。编译器甚至不会运行您的代码，它会查看它以确保它没有任何问题。如果您的代码有问题并且编译器正常工作，它应该会为您吐出一个很好的错误。

解决方法：你的编译器坏了，换一个新的。

对于 Windows：MinGW（只是编译器，但很容易与 Eclipse 一起使用）

*   [http://sourceforge.net/projects/mingw/files/](http://sourceforge.net/projects/mingw/files/)

对于 mac：Xcode（IDE + 编译器）

*   [https://developer.apple.com/xcode/](https://developer.apple.com/xcode/)

希望这有帮助！

# css - 用我自己的 css 类覆盖全局标签字体大小？

> ID：13790607
> 
> 赞同：0
> 
> 时间：2012-12-09T18:55:10.937
> 
> 标签：css

我正在尝试更新网站。有一个我想要设置样式的标签元素。看起来像：

```
 #foo {
     font-size: 9px;
 }

 <label id="foo"></label> 
```

但它看起来像“标签”元素的css定义覆盖了我设置的更具体的样式。我在萤火虫中看到了这个

```
label {
    font-size: 16px;
}
.foo {
    font-size: 9px; /* strikethrough on my font-size declaration here */
} 
```

那么有没有办法在不修改所有内容的情况下覆盖默认标签字体大小设置？（我认为我的更具体的定义默认会这样做）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:02:56.027

您将 for 的语法`id`与 for的语法混为一谈`class`：

```
#foo { /* # = id, . = class */
    font-size: 9px;
} 
```

请记住，`id`对于整个文档，s 应该是唯一的

或将您的标签切换为使用类：

```
<label class="foo"></label> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:02:43.733

您总是可以使用`!important`指标来优先考虑规则。

```
font-size: 9px !important; 
```

# r - 在 R 中通过命令行传递多个参数

> ID：13790610
> 
> 赞同：4
> 
> 时间：2012-12-09T18:55:25.060
> 
> 标签：r, command-line, arguments, argparse, optparse

我正在尝试通过命令行将多个文件路径参数传递给 Rscript，然后可以使用参数解析器对其进行处理。最终我想要这样的东西

```
Rscript test.R --inputfiles fileA.txt fileB.txt fileC.txt --printvar yes --size 10 --anotheroption helloworld -- etc... 
```

通过命令行传递并在解析时将结果作为 R 中的数组

```
args$inputfiles =  "fileA.txt", "fileB.txt", "fileC.txt" 
```

我已经尝试了几个解析器，包括 optparse 和 getopt 但它们似乎都不支持这个功能。我知道 argparse 可以，但它目前不适用于 R 版本 2.15.2

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T02:13:52.230

虽然当被问到这个问题时它没有在 CRAN 上发布，但是现在有一个 argparse 模块的 beta 版本可以做到这一点。它基本上是流行的同名 python 模块的包装器，因此您需要安装最新版本的 python 才能使用它。有关详细信息，请参阅安装说明。基本示例包括一个任意长的数字列表，这些数字应该不难修改，因此您可以获取任意长的输入文件列表。

```
> install.packages("argparse")
> library("argparse")
> example("ArgumentParser") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-08-22T20:40:07.293

您描述命令行选项的方式与大多数人期望使用它们的方式不同。通常，命令行选项将采用单个参数，并且没有前面选项的参数作为参数传递。如果一个参数需要多个项目（如文件列表），我建议使用 strsplit() 解析字符串。

这是一个使用 optparse 的示例：

```
library (optparse)
option_list <- list ( make_option (c("-f","--filelist"),default="blah.txt", 
                                   help="comma separated list of files (default %default)")
                     )

parser <-OptionParser(option_list=option_list)
arguments <- parse_args (parser, positional_arguments=TRUE)
opt <- arguments$options
args <- arguments$args

myfilelist <- strsplit(opt$filelist, ",")

print (myfilelist)
print (args) 
```

以下是几个示例运行：

```
$ Rscript blah.r -h
Usage: blah.r [options]

Options:
    -f FILELIST, --filelist=FILELIST
        comma separated list of files (default blah.txt)

    -h, --help
        Show this help message and exit

$ Rscript blah.r -f hello.txt
[[1]]
[1] "hello.txt"

character(0)
$ Rscript blah.r -f hello.txt world.txt
[[1]]
[1] "hello.txt"

[1] "world.txt"
$ Rscript blah.r -f hello.txt,world.txt another_argument and_another
[[1]]
[1] "hello.txt" "world.txt"

[1] "another_argument" "and_another"
$ Rscript blah.r an_argument -f hello.txt,world.txt,blah another_argument and_another
[[1]]
[1] "hello.txt" "world.txt" "blah"     

[1] "an_argument"      "another_argument" "and_another" 
```

请注意，对于 strsplit，您可以使用正则表达式来确定分隔符。我会建议如下内容，它可以让您使用逗号或冒号来分隔您的列表：

```
myfilelist <- strsplit (opt$filelist,"[,:]") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-09T19:01:34.497

在你的脚本 test.R 的前面，你把这个：

```
args <- commandArgs(trailingOnly = TRUE)

hh <- paste(unlist(args),collapse=' ')
listoptions <- unlist(strsplit(hh,'--'))[-1]
options.args <- sapply(listoptions,function(x){
         unlist(strsplit(x, ' '))[-1]
        })
options.names <- sapply(listoptions,function(x){
  option <-  unlist(strsplit(x, ' '))[1]
})
names(options.args) <- unlist(options.names)
print(options.args) 
```

要得到 ：

```
$inputfiles
[1] "fileA.txt" "fileB.txt" "fileC.txt"

$printvar
[1] "yes"

$size
[1] "10"

$anotheroption
[1] "helloworld" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-10T23:57:18.437

在四处搜索并避免自下而上编写新包之后，我认为使用包 optparse 输入多个参数的最佳方法是用一个最有可能非法包含在文件名中的字符分隔输入文件（例如，冒号）

```
Rscript test.R --inputfiles fileA.txt:fileB.txt:fileC.txt etc... 
```

文件名中也可以有空格，只要空格被转义（optparse 会处理这个问题）

```
Rscript test.R --inputfiles file\ A.txt:file\ B.txt:fileC.txt etc... 
```

最后，如果有一个支持多个参数的包（可能是 optparse 的修改版本）会很好，就像问题和下面提到的那样

```
Rscript test.R --inputfiles fileA.txt fileB.txt fileC.txt 
```

人们会认为这些微不足道的功能将被实现到广泛使用的包中，例如 optparse

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-11T20:23:07.230

如果输入参数是相同长度的列表，@agstudy 的解决方案将无法正常工作。默认情况下， sapply 会将相同长度的输入折叠成矩阵而不是列表。修复很简单，只需在 sapply 解析参数时显式设置 simple 为 false 。

```
args <- commandArgs(trailingOnly = TRUE)

hh <- paste(unlist(args),collapse=' ')
listoptions <- unlist(strsplit(hh,'--'))[-1]
options.args <- sapply(listoptions,function(x){
         unlist(strsplit(x, ' '))[-1]
        }, simplify=FALSE)
options.names <- sapply(listoptions,function(x){
  option <-  unlist(strsplit(x, ' '))[1]
})
names(options.args) <- unlist(options.names)
print(options.args) 
```

# r - 在按因子拆分的数据框中的许多列上应用 t 检验

> ID：13790611
> 
> 赞同：8
> 
> 时间：2012-12-09T18:55:34.937
> 
> 标签：r, dataframe, plyr

我有一个数据框，其中一个因子列有两个级别，还有许多数字列。我想按因子列拆分数据框并对列对进行 t 检验。

使用示例数据集 Puromycin 我希望结果看起来像这样：

```
Variable    Treated Untreated   p-value    Test-statistic CI of difference**** 
Conc        0.3450  0.2763          XXX     T           XX - XX
Rate        141.58  110.7272        xxx     T           XX - XX 
```

我想我正在寻找一种使用 PLYR 的解决方案，它可以将上述结果输出为一个不错的数据帧。

（嘌呤霉素只包含两个数字变量，但我正在寻找的解决方案将适用于具有许多数字变量的数据框）

*更新 - 我将尝试澄清我的意思。*

我想从如下所示的数据中获取：

```
Grouping variable   var1    var2    var3    var4    var5
1           3   5   7   3   7
1           3   7   5   9   6
1           5   2   6   7   6
1           9   5   7   0   8
1           2   4   5   7   8
1           2   3   1   6   4
2           4   2   7   6   5
2           0   8   3   7   5
2           1   2   3   5   9
2           1   5   3   8   0
2           2   6   9   0   7
2           3   6   7   8   8
2           10  6   3   8   0 
```

对于如下所示的结果数据框：

```
"Mean in group 1"   "Mean in group 2"  "P-value of difference" "N"

var1            ##          ##          ##          ##      
var2            ##          ##          ##          ##  
var3            ##          ##          ##          ##  
var4            ##          ##          ##          ##  
var5            ##          ##          ##          ## 
```

也许这是我正在寻找的mapply的东西，因为我想通过两级因子将我的数据帧分成dataframe1和dataframe2，并将函数（t-test）应用于dataframe1和dataframe2的第一部分，然后是对 dataframe1 和 dataframe2 的第二部分进行 t 检验，然后对 dataframe1 和 dataframe2 的第三部分进行 t 检验，依此类推，对按因子拆分生成的所有列对进行测试。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-10T13:48:46.320

也许这会产生您正在寻找的结果：

```
df <- read.table(text="Group   var1    var2    var3    var4    var5
1           3   5   7   3   7
1           3   7   5   9   6
1           5   2   6   7   6
1           9   5   7   0   8
1           2   4   5   7   8
1           2   3   1   6   4
2           4   2   7   6   5
2           0   8   3   7   5
2           1   2   3   5   9
2           1   5   3   8   0
2           2   6   9   0   7
2           3   6   7   8   8
2           10  6   3   8   0", header = TRUE)

t(sapply(df[-1], function(x) 
     unlist(t.test(x~df$Group)[c("estimate","p.value","statistic","conf.int")]))) 
```

结果：

```
 estimate.mean in group 1 estimate.mean in group 2   p.value statistic.t conf.int1 conf.int2
var1                 4.000000                 3.000000 0.5635410   0.5955919 -2.696975  4.696975
var2                 4.333333                 5.000000 0.5592911  -0.6022411 -3.104788  1.771454
var3                 5.166667                 5.000000 0.9028444   0.1249164 -2.770103  3.103436
var4                 5.333333                 6.000000 0.7067827  -0.3869530 -4.497927  3.164593
var5                 6.500000                 4.857143 0.3053172   1.0925986 -1.803808  5.089522 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T20:27:36.623

也许你会发现这很有用

```
res <- sapply(split(Puromycin[,-3],  Puromycin$state), t.test)[c(1:3,5),]
conf.level <- sapply(sapply(split(Puromycin[,-3],  Puromycin$state), t.test)[4, ], '[', 1:2)
res <- rbind(res, conf.level.lower=conf.level[1,], conf.level.upper=conf.level[2,])
res
                 treated    untreated   
statistic        4.297025   4.206221    
parameter        23         21          
p.value          0.00026856 0.0003968191
estimate         70.96417   55.50182    
conf.level.lower 36.80086   28.06095    
conf.level.upper 105.1275   82.94268 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-29T20:55:40.120

您也可以为此使用定制的包`matrixTests`。使用下面@Sven 准备的 data.frame 的示例：

```
df <- read.table(text="Group   var1    var2    var3    var4    var5
1           3   5   7   3   7
1           3   7   5   9   6
1           5   2   6   7   6
1           9   5   7   0   8
1           2   4   5   7   8
1           2   3   1   6   4
2           4   2   7   6   5
2           0   8   3   7   5
2           1   2   3   5   9
2           1   5   3   8   0
2           2   6   9   0   7
2           3   6   7   8   8
2           10  6   3   8   0", header = TRUE)

library(matrixTests)

col_t_welch(df[df$Group==1,-1], df[df$Group==2,-1])
     obs.x obs.y obs.tot   mean.x   mean.y  mean.diff     var.x     var.y   stderr        df  statistic    pvalue  conf.low conf.high alternative mean.null conf.level
var1     6     7      13 4.000000 3.000000  1.0000000  7.200000 11.333333 1.679002 10.963146  0.5955919 0.5635410 -2.696975  4.696975   two.sided         0       0.95
var2     6     7      13 4.333333 5.000000 -0.6666667  3.066667  5.000000 1.106976 10.938135 -0.6022411 0.5592911 -3.104788  1.771454   two.sided         0       0.95
var3     6     7      13 5.166667 5.000000  0.1666667  4.966667  6.666667 1.334226 10.995151  0.1249164 0.9028444 -2.770103  3.103436   two.sided         0       0.95
var4     6     7      13 5.333333 6.000000 -0.6666667 10.666667  8.333333 1.722862 10.146824 -0.3869530 0.7067827 -4.497927  3.164593   two.sided         0       0.95
var5     6     7      13 6.500000 4.857143  1.6428571  2.300000 13.142857 1.503624  8.285649  1.0925986 0.3053172 -1.803808  5.089522   two.sided         0       0.95 
```

# arduino - 用光电晶体管检测液滴的方法

> ID：13790615
> 
> 赞同：0
> 
> 时间：2012-12-09T18:55:59.800
> 
> 标签：arduino, signal-processing, circuit

ECE 人员：我有一个简单的电路，其中的 LED 指向光电晶体管。它们之间有一根管子，液滴会随机滴下。我正在用发射器上的 Arduino 读取电压，因为当 LED 被遮挡时它会下降。

非 ECE 人员：每次通过 Arduino 循环，我都在读取接近恒定的值。每隔一段时间，这个值可能会因一些未知数量的循环而改变。我想在每次发生这种情况时增加一个计数器并避免多次计数。

我已经尝试了一些我自己的方法（例如平均值持续一些值并检查不同的平均值），但它们似乎非常不稳定。我不是信号处理或任何方面的专家，但我想知道有什么好的方法/算法可以用于这种事情。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T03:29:34.070

这是一个简短的函数，用于更新到目前为止检测到的滴数。

```
int UpdateCount (int current, int old, int count) // current is current value of phototransisor, old is the old value
    if ((current==1)&(old==0)){
        return count count+1
    }
} 
```

该函数接收光电晶体管的“过滤”当前值和旧值，并根据这些值更新计数。

要实现低通滤波器，请参阅 wiki 上的低通滤波器 (http://en.wikipedia.org/wiki/Low-pass_filter)。您将获得一个可以轻松编码的表达式。

我相信这两个关于集成的子解决方案可以解决您的问题。

# java - 服务器端 Java：它可以读取 CAC 卡吗？如果可以，如何读取？

> ID：13790618
> 
> 赞同：1
> 
> 时间：2012-12-09T18:56:22.387
> 
> 标签：java, spring, weblogic11g, smartcard-reader, cac

我正在使用 Java 5 - 6、Spring 3.1 和 WebLogic 11g。

我工作的地方（政府）现在要求人们插入 CAC 卡才能进入他们的 PC。

我想学习如何使用服务器端 Java 从通用访问卡 (CAC) 卡中读取信息，可能用于身份验证和数字签名。

我在谷歌上发现的东西很少，我不知道从哪里开始。

是读取 CAC 生成的证书，然后通过浏览器发送的问题吗？

如果是这样，我也不知道如何从那开始。谁能指出我的教程和一些代码示例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T20:52:11.427

> 我想学习如何使用服务器端 Java 从通用访问卡中读取信息

客户端会将 CAC 卡放在*本地*机器中，因此服务器端实际上无法访问 CAC 卡。您应该在服务器端执行的操作是，例如使用来自 CAC 卡的证书进行客户端证书身份验证。有关于如何从 java 访问 CAC 的信息

# git - git commit 并推送本地 git 文件夹，无需合并

> ID：13790619
> 
> 赞同：0
> 
> 时间：2012-12-09T18:56:29.247
> 
> 标签：git, bitbucket

我真的不是 git 专家。通常我只使用 -"git add -A" 然后 "git commit -m"msg"" 然后 "git push" 这样一切正常。

这次进行更改，另一个用户对我的项目进行了提交，之后我还使用了“git checkout”，使用了旧提交或新提交的 SHA1，我什至不记得了。

从那时起，我已经分叉（成功）了另一个用户提交，现在我只想按原样提交我的文件夹，并继续正常工作。问题是，现在我得到 -

```
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Merge the remote changes (e.g. 'git pull')
hint: before pushing again. 
```

**我不想合并任何东西，我只想像本地*一样*提交并推送我本地计算机中的当前文件夹到bitbucket，然后继续正常使用它。**

以后我会深入研究git，我现在没有时间（很多工作......）-*请帮助*。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:18:44.537

这有点违反直觉，因为 Git 是为与合作伙伴一起工作的，所以通常情况下，如果另一个开发人员推送到您的分支上，您合并它，然后再推送。

如果您不想一起工作，那么每个人都制作自己的 repo，或者至少制作自己的分支。

不过，要回答您的问题，您可以写信`git push --force`按原样推送您的本地存储库。但是要**小心**，这将覆盖其他开发人员的更改，并且它们会*丢失**.

**你不能真正丢失 Git 提交的任何东西，但是在之后检索它需要一些努力。正如 Jonas 在评论中指出的那样，未引用的提交将在一段时间后自动删除，因此如果这是一个错误，您只有有限的时间（30 天）将其取回。*

# delphi - 监视目录以不允许创建具有特定扩展名的文件

> ID：13790621
> 
> 赞同：1
> 
> 时间：2012-12-09T18:56:39.107
> 
> 标签：delphi, file, directory, locking, blocking

是否可以在**Delphi**中创建一个应用程序来**监视**某些**目录**或目录以不允许系统创建具有某些指定**扩展名的****文件**，包括将现有文件重命名为此类**被阻止**的扩展名？或者可以允许使用仅**允许**的扩展名集创建/重命名文件？该解决方案应包括监视所有子目录...

# php - 从数据库导出到 php 中的特定 pdf 文件

> ID：13790625
> 
> 赞同：-1
> 
> 时间：2012-12-09T18:56:59.250
> 
> 标签：php, html

大家好，我想知道是否可以使用数据库中的一些信息填写特定的 PDF 文件。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T18:58:12.783

是的，有可能：[PHP PDF](http://php.net/manual/en/book.pdf.php)。还有[其他](https://www.google.co.uk/search?q=php%20to%20pdf&aq=0&oq=php%20to%20pdf&aqs=chrome.0.0j57j0j62l2j64.3625&sugexp=chrome,mod=9&sourceid=chrome&ie=UTF-8)各种库。

# css - 使用单独的 css 文件进行 CSS3 媒体查询

> ID：13790628
> 
> 赞同：2
> 
> 时间：2012-12-09T18:57:21.860
> 
> 标签：css, media-queries

**我想为移动设备创建一个不同的 CSS 文件。**我已经能够检测到设备是否是移动设备，但是，只有当我使用@media 语句在同一个文件中定义了所有样式时。

**我希望将文件分开，但我无法实现，并希望您告诉我如何实现。**

```
<link type="text/css" rel="stylesheet" href="css/combined.css" media="screen" /> 
```

combine.css：（这可行，但所有样式都在同一个 CSS 文件中）

```
// for desktop browsers
@media only screen and (min-width: 1000px) {
    h1 { text-decoration: none; }
}

// for mobile devices
@media only screen and (min-device-width: 320px) and (max-device-width: 480px) {
    h1 { text-decoration: underline; }
} 
```

当我试图将它们分开时...

```
<link type="text/css" rel="stylesheet" href="css/desktop.css" media="screen" />
<link type="text/css" rel="stylesheet" href="css/mobile.css" media="only screen and (min-device-width: 320px) and (max-device-width: 480px)" /> 
```

桌面.css：

```
h1 { text-decoration: none; } 
```

移动.css：

```
h1 { text-decoration: underline; } 
```

......它不再起作用了。**为什么？**我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T12:47:49.113

您如何检测设备是否为移动设备？你在使用 PHP 吗？

如果是这种情况，那么您可以轻松地根据您的 is_mobile 标志仅包含正确的文件。

```
<?php if(!$is_mobile) { ?>
    <link type="text/css" rel="stylesheet" href="css/desktop.css" />
<?php } else { ?>
    <link type="text/css" rel="stylesheet" href="css/mobile.css" />
<?php } ?> 
```

# python - Python 和线程 - 来自导入的未定义变量：start_new_thread

> ID：13790632
> 
> 赞同：1
> 
> 时间：2012-12-09T18:57:42.280
> 
> 标签：python, multithreading, import

尝试`thread`在 Python 中使用时，使用以下代码

```
import select, sys, time, thread

TIMEOUT = 30

def listenthread(server,result):

# some code 
#
#

def main(argv=None):
    if argv is None:
        argv = sys.argv[1:]
    server = Server()            
    clientaddrs = []
    # listen to clients in new thread
    thread.start_new_thread(listenthread, (server,clientaddrs)) # that line produces a problem 
```

`Undefined variable from import: start_new_thread`当我到达线路时我得到：

```
 thread.start_new_thread(listenthread, (server,clientaddrs)) 
```

可能是什么问题？

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:12:06.687

这是一个常见的 PyDev 错误。我认为您的代码没有任何问题，PyDev 只是提醒您注意不存在的错误。

[请参阅此处](https://stackoverflow.com/questions/2112715/how-do-i-fix-pydev-undefined-variable-from-import-errors)和[此处](https://stackoverflow.com/questions/4521258/pydev-undefined-variable-from-import-error)列出的答案。

# apache - Apache 403 错误 WampServer 2

> ID：13790634
> 
> 赞同：3
> 
> 时间：2012-12-09T18:57:56.383
> 
> 标签：apache, configuration, webserver, alias, http-status-code-403

我安装了 WampServer 2，并在我的计算机上创建了一个别名 test，它指向目录 g:/test/。

但是，当我尝试访问 localhost/test/ 时，我不断收到 403 错误

这是由我的 httpd.conf 中的这些行引起的（如果我将这些行注释掉，它会加载）

```
<Directory />
    AllowOverride none
    Require all denied
</Directory> 
```

我的测试配置如下：

```
Alias /test/ "g:/test/" 
<Directory "g:/test/">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride all
        Order allow,deny
    Allow from all
</Directory> 
```

如何覆盖我的 test.conf 文件中的 Require all denied 以停止 403 错误？

错误日志显示：[Sun Dec 09 18:51:23.757803 2012] [authz_core:error] [pid 5128:tid 884] [client ::1:50622] AH01630: client denied by server configuration: G:/test/

访问日志读取： ::1 - - [09/Dec/2012:18:51:23 +0000] "GET /test/ HTTP/1.1" 403 207

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:01:38.517

尝试替换已弃用的：

```
Order allow,deny
Allow from all 
```

经过：

```
Require all granted 
```

仅关注[Apache >= 2.4](http://httpd.apache.org/docs/2.4/mod/mod_access_compat.html)。但是，我建议禁用 mod_access_compat（LoadModule 行）以避免与 Require 发生 Order/Allow/Deny 冲突。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-21T09:45:05.063

选项索引 FollowSymLinks MultiViews AllowOverride all Allow from all #Require local Require all grant

以上文件注释#Require local add extra **Require all grant**

解决了

# android - android上的jquery ajax请求仅适用于async false

> ID：13790635
> 
> 赞同：1
> 
> 时间：2012-12-09T18:57:57.883
> 
> 标签：android, jquery

我有一个 jquery ajax 请求如下

```
$.ajax({
   url: "https://companydomain.com",
    username : "testuser",
    password : "testpassword",  
          async:false,            
        success: function(response, textStatus, jqXHR){
            // log a message to the console
            console.log("response :"+response);
    console.log("textStatus :"+textStatus);
    console.log("jqXHR :"+jqXHR);

        },
        error: function(jqXHR, textStatus, errorThrown){
           console.log("jqXHR:"+jqXHR);
           console.log("textStatus :"+textStatus);
           console.log("Error"+errorThrown);
        },
        complete: function(){            
           console.log("complete");
        }
}); 
```

问题是，只有在设置了“async:false”的情况下，这才适用于 android 模拟器/设备。当设置“async:true”时，它会立即失败。上述请求在 iOS 和 chrome 桌面浏览器上运行正常。只有android似乎是一个问题。有谁知道可能是什么原因？

Android v4.0.X，Jquerymobile：jquery.mobile-1.2.0，phonegap：v2.1

# php - 只有用户可以使用 PHP SDK 3 进行 facebook 连接

> ID：13790639
> 
> 赞同：2
> 
> 时间：2012-12-09T18:58:25.333
> 
> 标签：php, facebook, sdk, connect

我已使用使用 Graph API 的 PHP SDK 3 将 Facebook Connect 集成到我的网站

[和这篇文章](http://25labs.com/tutorial-integrate-facebook-connect-to-your-website-using-php-sdk-v-3-x-x-which-uses-graph-api/)一模一样

好的...

登录网址的 php 是

```
$loginUrl   = $facebook->getLoginUrl(
        array(
            'scope'         => 'email,publish_stream',
            'redirect_uri'  => $fbconfig['baseurl']
        )
);

        <a href="<?=$loginUrl?>">Facebook Login</a> 
```

我只有一个问题，我试图找到解决方案：

如果访问者正在尝试登录但他没有注册到我的 APP，Facebook 会将他重定向到**example.php**页面，而不要求他接受我的应用并注册。

换句话说，我只需要引导我当前的用户到 Fblogin url 的路径，如果他不是用户，那么我会将他重定向到其他页面，而不要求他注册我的应用程序。

有人可以帮我吗？

谢谢

# django - 带有dotcloud的django：跳过了部分URL

> ID：13790645
> 
> 赞同：0
> 
> 时间：2012-12-09T18:59:02.603
> 
> 标签：django, dotcloud

[这是一个 Django 站点，通过此文档](http://docs.dotcloud.com/0.4/tutorials/python/django/)迁移到 Dotcloud 。我的 URL 有问题：我无法访问我的管理部分，并且不应该匹配的根 URL 匹配！让我详细解释一下：

```
root/
|- settings.py
|- urls.py
|- champis/
   |- urls.py 
```

文件`root/urls.py`：

```
urlpatterns = patterns('',
    (r'^champis/', include('champis.urls')),
    (r'^admin/$', include(admin.site.urls)),
) 
```

文件`root/champis/urls.py`：

```
urlpatterns = patterns('champis.views',
    url(r'^$', 'index'),
    url(r'^recherche/$', 'search'),
    url(r'^glossaire/$', 'glossary'),
    url(r'^glossaire/(?P<letter>\w)/$', 'glossary'),
    url(r'^(?P<champi_name>\w+)/$', 'detail'),
    url(r'^(?P<champi_name>\w+)/(?P<photo_nb>\d+)/$', 'detail'),
) 
```

所以我应该在 找到我的管理站点，在 找到我`http://server.com/admin`的应用程序`http://server.com/champis`，但事实并非如此：

*   `http://server.com/admin`并`http://server.com/champis`触发 404
*   但我的申请在`http://server.com`!

看起来好像`champis`URL 的一部分被自动神奇地添加到根 URL 中......你有解释吗？谢谢 ！

编辑：我的摘录`settings.py`：

```
ROOT_URLCONF = 'urls' 
```

Django 版本是 1.4，实际上`DEBUG`设置为`True`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:52:23.127

`$`从以下位置删除`'^admin/$'`：

```
urlpatterns = patterns('',
    (r'^champis/', include('champis.urls')),
    (r'^admin/', include(admin.site.urls)),
) 
```

# networking - Netty BufferSizePredictor 截断 UDP 数据报

> ID：13790648
> 
> 赞同：1
> 
> 时间：2012-12-09T18:59:29.180
> 
> 标签：networking, udp, netty

我正在尝试开发可以接收自定义 UDP 数据包的自定义 Flume 源。这是我的代码：

```
public class XvlrUdpSource extends AbstractSource
        implements EventDrivenSource, Configurable {

    private static final Logger LOG = LoggerFactory.getLogger(XvlrUdpSource.class);

    private int port;
    private String host;
    private Channel nettyChannel;

    private static final Logger logger = LoggerFactory.getLogger(XvlrUdpSource.class);

    private CounterGroup counterGroup = new CounterGroup();

    public class XvlrUpdHander extends SimpleChannelHandler {

        @Override
        public void messageReceived(ChannelHandlerContext ctx, MessageEvent mEvent) {
            try {
                System.out.println("class: "+ mEvent.getMessage().getClass());
                /** ChannelBuffer holds just first 768 bytes of the whole input UDP packet*/
                ChannelBuffer channelBuffer = (ChannelBuffer)mEvent.getMessage();
                   Event xvlrPacketEvent = EventBuilder.withBody( ((ChannelBuffer)mEvent.getMessage()).array());
                System.out.println("Length is:["+xvlrPacketEvent.getBody().length+"]");
                //Event e = syslogUtils.extractEvent((ChannelBuffer)mEvent.getMessage());
                if(xvlrPacketEvent == null){
                    return;
                }
                getChannelProcessor().processEvent(xvlrPacketEvent);
                counterGroup.incrementAndGet("events.success");
            } catch (ChannelException ex) {
                counterGroup.incrementAndGet("events.dropped");
                logger.error("Error writting to channel", ex);
                return;
            }
        }
    }

    @Override
    public void start() {
        ConnectionlessBootstrap serverBootstrap = new ConnectionlessBootstrap
                (new OioDatagramChannelFactory(Executors.newCachedThreadPool()));
        final XvlrUpdHander handler = new XvlrUpdHander();
        serverBootstrap.setPipelineFactory(new ChannelPipelineFactory() {
            @Override
            public ChannelPipeline getPipeline() {
                return Channels.pipeline(handler);
            }
        });

        if (host == null) {
            nettyChannel = serverBootstrap.bind(new InetSocketAddress(port));
        } else {
            nettyChannel = serverBootstrap.bind(new InetSocketAddress(host, port));
        }

        super.start();
    }

    @Override
    public void stop() {
        logger.info("Syslog UDP Source stopping...");
        logger.info("Metrics:{}", counterGroup);
        if (nettyChannel != null) {
            nettyChannel.close();
            try {
                nettyChannel.getCloseFuture().await(60, TimeUnit.SECONDS);
            } catch (InterruptedException e) {
                logger.warn("netty server stop interrupted", e);
            } finally {
                nettyChannel = null;
            }
        }

        super.stop();
    }

    @Override
    public void configure(Context context) {
        Configurables.ensureRequiredNonNull(
                context, "port");//SyslogSourceConfigurationConstants.CONFIG_PORT);
        port = context.getInteger("port");//SyslogSourceConfigurationConstants.CONFIG_PORT);
        host = context.getString("host");//SyslogSourceConfigurationConstants.CONFIG_HOST);
        //formaterProp = context.getSubProperties("PROP");//SyslogSourceConfigurationConstants.CONFIG_FORMAT_PREFIX);
    }

} 
```

我在**messageRecieved**上进行了调试，并在 stacktrace 中看到：

```
/**
     * Sends a {@code "messageReceived"} event to the first
     * {@link ChannelUpstreamHandler} in the {@link ChannelPipeline} of
     * the specified {@link Channel} belongs.
     *
     * @param message        the received message
     * @param remoteAddress  the remote address where the received message
     *                       came from
     */
    public static void fireMessageReceived(Channel channel, Object message, SocketAddress remoteAddress) {
        channel.getPipeline().sendUpstream(
                new UpstreamMessageEvent(channel, message, remoteAddress));
    } 
```

我的**对象消息**已经是 768 字节长度。

根在这里**org.jboss.netty.channel.socket.oio.OioDatagramWorker**：

```
byte[] buf = new byte[predictor.nextReceiveBufferSize()];
            DatagramPacket packet = new DatagramPacket(buf, buf.length); 
```

Predictor 将缓冲区大小设置为 768 然后：

```
fireMessageReceived(
                    channel,
                    channel.getConfig().getBufferFactory().getBuffer(buf, 0, packet.getLength()),
                    packet.getSocketAddress()); 
```

我只得到前 768 个字节。有没有机会改变预测者的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T09:54:15.087

我找到了这个主题： [每个 UDP 数据报的 Netty 不同的管道](https://stackoverflow.com/questions/10336672/netty-different-pipeline-per-udp-datagram?rq=1)

可以使用特殊属性“注入”具有所需行为的预测器。所以完整的解决方案是：

```
public class XvlrUdpSource extends AbstractSource
        implements EventDrivenSource, Configurable {

    private static final Logger LOG = LoggerFactory.getLogger(XvlrUdpSource.class);

    private int port;
    private String host;
    private Channel nettyChannel;

    private CounterGroup counterGroup = new CounterGroup();

    public class XvlrUpdHander extends SimpleChannelHandler {

        @Override
        public void messageReceived(ChannelHandlerContext ctx, MessageEvent mEvent) {
            try {
                ChannelBuffer channelBuffer = (ChannelBuffer)mEvent.getMessage();
                int actualSizeOfUdpPacket = channelBuffer.readableBytes();
                byte[] body = Arrays.copyOf(channelBuffer.array(), actualSizeOfUdpPacket);
                Event xvlrPacketEvent = EventBuilder.withBody(body);
                LOG.debug("Event.body length is: {} ", xvlrPacketEvent.getBody().length);
                if(xvlrPacketEvent == null){
                    return;
                }
                getChannelProcessor().processEvent(xvlrPacketEvent);
                counterGroup.incrementAndGet("events.success");
            } catch (ChannelException ex) {
                counterGroup.incrementAndGet("events.dropped");
                LOG.error("Error writting to channel", ex);
                return;
            }
        }
    }

    @Override
    public void start() {
        OioDatagramChannelFactory oioDatagramChannelFactory =   new OioDatagramChannelFactory(                                                                           Executors.newCachedThreadPool());
        ConnectionlessBootstrap serverBootstrap = new ConnectionlessBootstrap(oioDatagramChannelFactory);
        serverBootstrap.setOption("sendBufferSize", 65536);
        serverBootstrap.setOption("receiveBufferSize", 65536);
        serverBootstrap.setOption("receiveBufferSizePredictorFactory",
                                    new AdaptiveReceiveBufferSizePredictorFactory(8192, 8192, 16384));

        final XvlrUpdHander handler = new XvlrUpdHander();

        serverBootstrap.setPipelineFactory(new ChannelPipelineFactory() {
            @Override
            public ChannelPipeline getPipeline() {
                return Channels.pipeline(handler);
            }
        });
        if (host == null) {
            nettyChannel = serverBootstrap.bind(new InetSocketAddress(port));
        } else {
            nettyChannel = serverBootstrap.bind(new InetSocketAddress(host, port));
        }

    }

        @Override
    public void stop() {
        LOG.info("Syslog UDP Source stopping...");
        LOG.info("Metrics:{}", counterGroup);
        if (nettyChannel != null) {
            nettyChannel.close();
            try {
                nettyChannel.getCloseFuture().await(60, TimeUnit.SECONDS);
            } catch (InterruptedException e) {
                LOG.warn("netty server stop interrupted", e);
            } finally {
                nettyChannel = null;
            }
        }

        super.stop();
    }

    @Override
    public void configure(Context context) {
        Configurables.ensureRequiredNonNull(context, "port");
        port = context.getInteger("port");
        host = context.getString("host");
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T20:49:08.573

要么您发送 768 字节，要么接收缓冲区只有 768 字节长。它当然与回车无关，除非您的代码中有一些错误的处理。

# sql - 更改 postgreSQL 文件的位置

> ID：13790652
> 
> 赞同：0
> 
> 时间：2012-12-09T18:59:57.767
> 
> 标签：sql, postgresql, debian

我正在使用 apt-get 在我的 debian 服务器上安装 postgreSQL。postgresql.conf 位于此处：

```
/etc/postgresql/8.4/main/postgresql.conf 
```

有没有一种方法可以实际更改 postgreSQL 查找此配置的位置，而无需通过从源代码构建它来安装 postgreSQL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:41:14.990

您可以在启动 PostgreSQL 时指定 .conf 文件的位置。

[从手册](http://www.postgresql.org/docs/8.4/static/runtime-config-file-locations.html)：

> *如果您愿意，可以使用参数 config_file、hba_file 和/或 ident_file 分别指定配置文件的名称和位置。config_file 只能在 postgres 命令行中指定*

`config_file refers`postgresql.conf 文件的位置在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:36:09.827

查看 in中的`do_ctl_all()`函数，`/usr/share/postgresql-common/init.d-functions`看看它如何尝试定位 postgresql 实例以在启动时启动：

```
for c in /etc/postgresql/"$2"/*; do
    [ -e "$c/postgresql.conf" ] || continue
    name=$(basename "$c")

    # evaluate start.conf
    if [ -e "$c/start.conf" ]; then
    .... 
```

这段代码表明，尽管路径`postgresql.conf`不是硬编码的（版本号和集群名称是变量），但通过连接不同部分来构建它的方式是硬编码的。

您仍然可以`postgresql.conf`手动符号链接到其他地方，尽管我不确定软件包的自动升级如何应对这种情况。

# concurrency - 消息传递模型和共享内存模型有什么区别？

> ID：13790653
> 
> 赞同：2
> 
> 时间：2012-12-09T19:00:04.137
> 
> 标签：concurrency, shared-memory, message-passing

该问题与[此处](https://stackoverflow.com/questions/1853284/whats-the-difference-between-the-message-passing-and-shared-memory-concurrency)提出的问题的主题重复。

我想要求就不同的观点做一些额外的澄清。

在分布式计算中，内存一致性最终是通过网络通道上的消息传递、分布式锁定等来实现的。消息传递，IIUC，并不总是消除并发性，除非在非常低的级别，因为进程通常仍然会影响彼此的状态。他们这样做，以他们认为一致的方式。

例如，可以在消息传递之上实现一个简单的命令解释器，并且可以将命令作为从多个熟悉进程并行执行的多个远程事务的一部分发送。因此，在大多数情况下，高级交互需要设计并发性。也就是说，IMO，进程不太可能没有长期操作的事务语义。

此外，发送具有一致状态值的消息并不能保证正确性。重要的是，这个值是如何产生的，以及在提供输入数据的消息和发布转换结果的消息之间发生了什么。

另一方面，与物理内存的低级交互本质上总是某种通过总线传递的消息。因此，在最低级别，共享内存和消息传递是相同的。

并且在每条指令级别，对齐的加载和存储的原子性通常得到保证。所以，区别对我来说仍然是模糊的。

在散文中，共享内存与消息传递的选择与并发性有何关系？只是选择解决并发问题的技术模式，以及定义和分析并行进程交互的数学模型，还是这些技术也是架构模式，当系统地应用时，从根本上影响系统中的并发问题？

谢谢。

**编辑*（一些补充说明）*：**

显然，这两种方法的区别在于正确性和性能。但是我对这种区别有以下问题。

我知道消息可以像大分散虚拟数据的传输一样。但是，“按值”方法不能保证在非单一（或程序生成）逻辑数据的原子读取之外没有同步的一致性。通过一致性，我暗示诸如更改的因果关系或顺序等。通过消息传递，实际上，每个进程只会改变自己的内存。进程的作用就像其私有内存的控制器。这就像在消息传递之上共享，由拥有数据的进程序列化，但在 MESSAGE-BY-MESSAGE 的基础上（类似于内存如何逐字或逐个缓存行序列化基础）。应用程序程序员仍然有责任保证发送消息所涉及的事务的同步。即，从多个熟悉的进程到一个进程的消息必须按照与这些进程正在执行的操作的语义相对应的一致顺序发送。可能是对拥有进程的控制消息，或者通过竞争者之间的直接协调，但是对消息的并发性进行一些限制应该是最有必要的。

对于本地进程间通信（忽略争用），共享内存确实可以更快，但是为什么跨机器通信会出现这种情况呢？分布式计算的共享内存是在网络通信之上实现的。所以，共享内存，除了缓存的好处，不能更快。

技术明显不同。我似乎无法理解的是，当对两者都没有本质上的好处时，如何将它们进行广泛的比较。必须假设平台提供什么，以及软件试图完成什么，而这样的假设不能普遍正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T02:21:45.133

如果您正在构建分布式和/或多线程应用程序，您会希望确保它比单进程单线程应用程序执行得更好。

对于分布式应用程序，即潜在的多个系统上的多个进程，通信节点之间的延迟是主要问题。随着微服务器的出现，延迟和功耗显着下降，软件开发人员应该开始考虑如何设计、开发、调试、部署等多核/微服务器应用程序。

在开发多进程应用程序时，通常归结为在最底层使用两组 OS 调用来实现进程间通信：共享内存，例如使用 shmget、shmat、shmctl 等，以及消息传递，例如通过使用 socket、accept、send、recv 等。

使用共享内存，延迟可以忽略不计。一旦获得对共享内存缓冲区的引用，应用程序就可以访问共享内存的任何部分并对其进行修改。当然，进程必须使用锁、互斥锁等进行合作，以确保维护数据结构的完整性并确保应用程序正常工作。这个解决方案的问题是，当无法控制何时可能发生上下文切换时，如何测试所有保持完整性的情况？

通过消息传递，不会共享任何数据。所有通信都是通过交换缓冲区来实现的。这样就不必担心锁、互斥锁等问题，但现在必须确保应用程序能够处理网络超时、带宽、延迟等问题。

为了开发可以扩展到单个系统之外的应用程序，最常见的方法是使用消息传递。如果通信进程碰巧在同一台主机上，它仍然可以工作。

无论是共享内存还是消息传递，并发本质上是在共享内存的情况下确保数据结构的完整性与锁/互斥锁和在消息传递的情况下序列化请求/响应。

# c# - C#：无需 3 倍代码重复即可访问私有成员

> ID：13790654
> 
> 赞同：-2
> 
> 时间：2012-12-09T19:00:13.893
> 
> 标签：c#, private-members

我有一堂课

```
public class Foo{
    public Foo{...}

    private void someFunction(){...}
    ...
    private Acessor{
        new Acessor
    }
} 
```

具有一些私有功能（someFunction）。但是，有时，我想允许另一个类调用 Foo.SomeFunction，所以我有一个内部类访问 Foo 并传递：

```
public class Foo{
    public Foo{...}

    private void someFunction(){...}
    ...
    public Acessor{
        Foo _myFoo;
        new Acessor(Foo foo){_myFoo = foo;}
        public void someFunction(){
            _myFoo.someFunction();
        }
    }
} 
```

使用这段代码，如果我想让 Foo 允许其他人调用 someFunction，Foo 可以传递一个新的 Foo.Accessor(this)。

不幸的是，这段代码允许任何人创建一个由 Foo 启动的 Foo.Accessor，并且他们可以访问 someFunction！我们不希望那样。但是，如果我们将 Foo.Accessor 设为私有，那么我们就不能将它从 Foo 中传递出去。

我现在的解决方案是让 Acessor 成为一个私有类，并让它实现一个公共接口 IFooAccessor；然后，我将 Foo.Accessor 作为 IFooAccessor 传递出去。这可行，但这意味着我必须声明 Foo.Accessor 在 IFooAccessor 中使用额外时间的每个方法。因此，如果我想重构这个方法的签名（例如，让 someFunction 带一个参数），我需要在三个地方引入更改。我不得不这样做好几次，它开始真正困扰我。有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:03:35.350

如果同一程序集中的类必须可以访问 someFunction，请使用 internal 而不是 private 修饰符。

[http://msdn.microsoft.com/en-us/library/7c5ka91b(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/7c5ka91b(v=vs.71).aspx)

如果它必须可供不在同一个汇编中的类访问，那么它应该是公共的。但是，如果它只被其他程序集中的几个类使用，您可能应该更好地考虑如何组织您的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:30:34.570

很难回答这个问题，因为不清楚（至少对我来说）你想要实现什么。（您在评论中写道`make it difficult for someone to inadverdantly use this code`）。

也许，如果该方法仅在特殊上下文中使用，那么显式实现接口可能是您想要的：

```
public interface ISomeContract {
    void someFunction();
}

public class Foo : ISomeContract {
    public Foo() {...}

    void ISomeContract.someFunction() {...}
} 
```

这意味着，该类的客户必须将其转换`ISomeContract`为调用`someFunction()`：

```
var foo = new Foo();
var x = foo as ISomeContract;
x.someFunction(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T09:01:11.620

我有一个类似的问题。一个简单、优雅且易于理解的类，除了一个丑陋的方法必须在一层中调用，它不应该在食物链的更下游调用。尤其是不受这一类消费者的影响。

我最终做的是在我的类的普通调用者不会使用的单独命名空间中在我的基类上创建一个扩展。由于我的方法需要私有访问，这与 M4N 显示的显式接口实现相结合。

```
namespace MyProject.Whatever
{
    internal interface IHidden
    {
        void Manipulate();
    }

    internal class MyClass : IHidden
    {
        private string privateMember = "World!";

        public void SayHello()
        {
            Console.WriteLine("Hello " + privateMember);
        }

        void IHidden.Manipulate()
        {
            privateMember = "Universe!";
        }
    }
}

namespace MyProject.Whatever.Manipulatable
{
    static class MyClassExtension
    {
        public static void Manipulate(this MyClass instance)
        {
            ((IHidden)instance).Manipulate();
        }    
    }
} 
```

# java - 开发 bean 时不需要以下哪项？

> ID：13790658
> 
> 赞同：-2
> 
> 时间：2012-12-09T19:00:31.050
> 
> 标签：java

我在面试时遇到了这个问题，我对正确答案感到困惑，所以请指教。

开发 bean 时不需要以下哪项？

1.  可序列化的实现。
2.  默认构造函数。
3.  内省能力。
4.  委托模型。
5.  SingleThreadModel的实现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:12:17.850

根据 Wikipedia，所有 bean 属性都需要一个默认构造函数以及 getter/setter（又名访问器/突变器），这有助于自省。

它还说它们应该是可序列化的。我不确定要读多少“应该”的用法，但我并不感到惊讶。我见过许多不可序列化的bean。但老实说，我不知道这是否合法。您必须检查规格才能确定。我会尽可能推荐可序列化性。

但是，我从未听说过 SingleThreadModel 或委托模型。所以我认为正确的答案是最后两项不是必需的。

[http://en.wikipedia.org/wiki/JavaBeans](http://en.wikipedia.org/wiki/JavaBeans)

# ios - iOS 上的 OpenCV：与 SurfFeatureDetector 和 FlannBasedMatcher 的错误匹配

> ID：13790659
> 
> 赞同：1
> 
> 时间：2012-12-09T19:00:35.173
> 
> 标签：ios, opencv, feature-detection, surf

我正在尝试使用 OpenCV 的特征检测工具来确定较大的场景图像中是否存在小样本图像。
我使用[这里](http://docs.opencv.org/doc/tutorials/features2d/feature_homography/feature_homography.html)的代码作为参考（没有单应性部分）。

```
UIImage *sceneImage, *objectImage1;
cv::Mat sceneImageMat, objectImageMat1;
cv::vector<cv::KeyPoint> sceneKeypoints, objectKeypoints1;
cv::Mat sceneDescriptors, objectDescriptors1;
cv::SurfFeatureDetector *surfDetector;
cv::FlannBasedMatcher flannMatcher;
cv::vector<cv::DMatch> matches;
int minHessian;
double minDistMultiplier;

minHessian = 400;
minDistMultiplier= 3;
surfDetector = new cv::SurfFeatureDetector(minHessian);

sceneImage = [UIImage imageNamed:@"twitter_scene.png"];
objectImage1 = [UIImage imageNamed:@"twitter.png"];

sceneImageMat = cv::Mat(sceneImage.size.height, sceneImage.size.width, CV_8UC1);
objectImageMat1 = cv::Mat(objectImage1.size.height, objectImage1.size.width, CV_8UC1);

cv::cvtColor([sceneImage CVMat], sceneImageMat, CV_RGB2GRAY);
cv::cvtColor([objectImage1 CVMat], objectImageMat1, CV_RGB2GRAY);

if (!sceneImageMat.data || !objectImageMat1.data) {
    NSLog(@"NO DATA");
}

surfDetector->detect(sceneImageMat, sceneKeypoints);
surfDetector->detect(objectImageMat1, objectKeypoints1);

surfExtractor.compute(sceneImageMat, sceneKeypoints, sceneDescriptors);
surfExtractor.compute(objectImageMat1, objectKeypoints1, objectDescriptors1);

flannMatcher.match(objectDescriptors1, sceneDescriptors, matches);

double max_dist = 0; double min_dist = 100;

for( int i = 0; i < objectDescriptors1.rows; i++ )
{ 
    double dist = matches[i].distance;
    if( dist < min_dist ) min_dist = dist;
    if( dist > max_dist ) max_dist = dist;
}

cv::vector<cv::DMatch> goodMatches;
for( int i = 0; i < objectDescriptors1.rows; i++ )
{ 
    if( matches[i].distance < minDistMultiplier*min_dist )
    { 
        goodMatches.push_back( matches[i]);
    }
}
NSLog(@"Good matches found: %lu", goodMatches.size());

cv::Mat imageMatches;
cv::drawMatches(objectImageMat1, objectKeypoints1, sceneImageMat, sceneKeypoints, goodMatches, imageMatches, cv::Scalar::all(-1), cv::Scalar::all(-1),
                cv::vector<char>(), cv::DrawMatchesFlags::NOT_DRAW_SINGLE_POINTS);

for( int i = 0; i < goodMatches.size(); i++ )
{
    //-- Get the keypoints from the good matches
    obj.push_back( objectKeypoints1[ goodMatches[i].queryIdx ].pt );
    scn.push_back( objectKeypoints1[ goodMatches[i].trainIdx ].pt );
}

cv::vector<uchar> outputMask;
cv::Mat homography = cv::findHomography(obj, scn, CV_RANSAC, 3, outputMask);
int inlierCounter = 0;
for (int i = 0; i < outputMask.size(); i++) {
    if (outputMask[i] == 1) {
        inlierCounter++;
    }
}
NSLog(@"Inliers percentage: %d", (int)(((float)inlierCounter / (float)outputMask.size()) * 100));

cv::vector<cv::Point2f> objCorners(4);
objCorners[0] = cv::Point(0,0);
objCorners[1] = cv::Point( objectImageMat1.cols, 0 );
objCorners[2] = cv::Point( objectImageMat1.cols, objectImageMat1.rows );
objCorners[3] = cv::Point( 0, objectImageMat1.rows );

cv::vector<cv::Point2f> scnCorners(4);

cv::perspectiveTransform(objCorners, scnCorners, homography);

cv::line( imageMatches, scnCorners[0] + cv::Point2f( objectImageMat1.cols, 0), scnCorners[1] + cv::Point2f( objectImageMat1.cols, 0), cv::Scalar(0, 255, 0), 4);
cv::line( imageMatches, scnCorners[1] + cv::Point2f( objectImageMat1.cols, 0), scnCorners[2] + cv::Point2f( objectImageMat1.cols, 0), cv::Scalar( 0, 255, 0), 4);
cv::line( imageMatches, scnCorners[2] + cv::Point2f( objectImageMat1.cols, 0), scnCorners[3] + cv::Point2f( objectImageMat1.cols, 0), cv::Scalar( 0, 255, 0), 4);
cv::line( imageMatches, scnCorners[3] + cv::Point2f( objectImageMat1.cols, 0), scnCorners[0] + cv::Point2f( objectImageMat1.cols, 0), cv::Scalar( 0, 255, 0), 4);

[self.mainImageView setImage:[UIImage imageWithCVMat:imageMatches]]; 
```

这行得通，但我不断得到大量的匹配，即使小图像不是大图像的一部分。
这是一个良好输出
![良好的输出](../Images/7dd2c7baeec03546cf4ce43d8ebb6c52.png)
的示例： 这是一个错误输出的示例：
![输出不良](../Images/88331069ec98a4a695e788a3d7bdcd92.png)
两个输出都是相同代码的结果。唯一的区别是小样本图像。
有了这样的结果，我不可能知道样本图像何时不在较大的图像中。
在进行研究时，我发现[了这个](https://stackoverflow.com/questions/7296915/opencv-object-matching-using-surf-descriptors-and-bruteforcematcher)stackoverflow 问题。我按照那里给出的答案，并尝试了“OpenCV 2 Computer Vision Application Programming Cookbook”一书中建议的步骤，但我无法使其适用于不同尺寸的图像（似乎是 cv:: findFundamentalMat 函数）。

我错过了什么？有没有办法使用 SurfFeatureDetector 和 FlannBasedMatcher 来知道一个样本图像何时是更大图像的一部分，而另一个样本图像不是？有没有更适合该目的的不同方法？

更新：
我更新了上面的代码以包含我使用的完整函数，包括尝试实际绘制单应性。另外，这里有 3 张图像 - 1 个场景，以及我试图在场景中找到的两个小物体。我的爪子图标的内部百分比越来越好，而不是 Twitter 图标，它实际上在场景中。另外，由于某种原因没有绘制单应性：
[Twitter Icon](http://imageshack.us/photo/my-images/42/twitterjh.png/)
[Paw Icon](http://imageshack.us/photo/my-images/716/pawb.png/)
[Scene](http://imageshack.us/photo/my-images/836/twitterscene.png/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T20:14:00.370

您的匹配器将始终将较小描述符列表中的每个点匹配到较大列表之一。然后，您必须自己寻找这些匹配中哪些有意义，哪些没有。您可以通过丢弃超过最大允许描述符距离的每个匹配来做到这一点，或者您可以尝试找到一个转换矩阵（例如使用 findHomography）并检查是否有足够的匹配与其对应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-18T07:35:13.500

这是一篇旧帖子，但我必须在课堂上完成类似的作业。删除错误输出的一种方法是检查大多数匹配线是否彼此平行（相对），并删除指向错误方向的匹配。

# c - C：只读文件的最后一行。没有循环

> ID：13790662
> 
> 赞同：11
> 
> 时间：2012-12-09T19:00:46.687
> 
> 标签：c, file-io

使用C，有没有办法***只读取文件的最后一行***而不循环它的全部内容？

问题是该文件包含**数百万**行，每行都包含一个整数（long long int）。文件本身可能非常大，我想甚至高达 1000mb。我确信最后一行不会超过 55 位，但也可能只有 2 位。使用任何类型的数据库都没有选择......我已经考虑过了。

也许这是一个愚蠢的问题，但来自 PHP 背景的我发现很难回答。我到处找，但没有找到*干净*的东西。

目前我正在使用：

```
if ((fd = fopen(filename, "r")) != NULL) // open file
{
    fseek(fd, 0, SEEK_SET); // make sure start from 0
    while(!feof(fd))
    {
        memset(buff, 0x00, buff_len); // clean buffer
        fscanf(fd, "%[^\n]\n", buff); // read file *prefer using fscanf
    }
    printf("Last Line :: %d\n", atoi(buff)); // for testing I'm using small integers
} 
```

这样我循环文件的内容，一旦文件变得大于〜500k行，事情就会变慢......

先感谢您。格言

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T19:02:34.000

只是[fseek](http://www.cplusplus.com/reference/cstdio/fseek/)并`fileSize - 55`向前阅读？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-09T19:03:47.023

如果存在最大行长，请*在 end 之前*寻找该距离。读到最后，找到缓冲区中的最后一个行尾。

如果没有最大行长，猜一个合理的值，在最后读那么多，如果没有行尾，把你的猜测加倍，然后再试一次。

在你的情况下：

```
/* max length including newline */
static const long max_len = 55 + 1;
/* space for all of that plus a nul terminator */
char buf[max_len + 1];

/* now read that many bytes from the end of the file */
fseek(fd, -max_len, SEEK_END);
ssize_t len = read(fd, buf, max_len);

/* don't forget the nul terminator */
buf[len] = '\0';

/* and find the last newline character (there must be one, right?) */
char *last_newline = strrchr(buf, '\n');
char *last_line = last_newline+1; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-09T19:03:09.523

打开`"rb"`以确保您正在阅读二进制文件。然后`fseek(..., SEEK_END)`从后面开始读取字节，直到找到第一行分隔符（如果您知道最大行长度为 55 个字符，请读取 55 个字符......）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-09T22:11:00.660

行。这一切都对我有用。我学到了一些新东西。立即读取了 41mb 大且行数 >500k 的文件的最后一行。感谢你们所有人，尤其是“无用”（喜欢你昵称的争议，顺便说一句）。我将在这里发布代码，希望将来的其他人可以从中受益：

只读取文件的最后一行：

该文件的结构方式是添加了一个新行，并且我确信任何行都比我的例子中的 55 个字符短：

```
file contents:
------------------------
2943728727
3129123555
3743778
412912777
43127787727
472977827

------------------------ 
```

注意附加的新行。

```
FILE *fd;                           // File pointer
char filename[] = "file.dat";       // file to read
static const long max_len = 55+ 1;  // define the max length of the line to read
char buff[max_len + 1];             // define the buffer and allocate the length

if ((fd = fopen(filename, "rb")) != NULL)  {      // open file. I omit error checks

    fseek(fd, -max_len, SEEK_END);            // set pointer to the end of file minus the length you need. Presumably there can be more than one new line caracter
    fread(buff, max_len-1, 1, fd);            // read the contents of the file starting from where fseek() positioned us
    fclose(fd);                               // close the file

    buff[max_len-1] = '\0';                   // close the string
    char *last_newline = strrchr(buff, '\n'); // find last occurrence of newlinw 
    char *last_line = last_newline+1;         // jump to it

    printf("captured: [%s]\n", last_line);    // captured: [472977827]
} 
```

干杯！格言

# java - 使用采用可变数量参数的方法

> ID：13790663
> 
> 赞同：0
> 
> 时间：2012-12-09T19:00:46.700
> 
> 标签：java

我正在尝试根据参数的数量使用不同的构造函数构建类（PhoneBook）的新对象的方法，但是它给出了错误

（线程“main”中的异常 java.lang.ArrayIndexOutOfBoundsException: 0）

```
public static PhoneBook createObjects(String fName,String lName,String num,String...optional)
{
    n++;    
    if (optional[0]==null)
        ArrayOfObjects[n]=new PhoneBook(fName,lName,num);
    else if (optional[1]==null)
        ArrayOfObjects[n]=new PhoneBook(fName,lName,num,optional[0]);

    return ArrayOfObjects[n];   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:02:50.163

`optional[0] == null`您应该检查是否存在可选参数，而不是检查是否`optional.length`存在。

也是如此`optional[1]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:09:16.667

而不是在这里检查`optional[0]`和`optional[1]`，你应该检查到`optional.length`。另外，请记住，`optional`它本身很可能是`null`，所以类似于：

```
if(optional != null) {
    if(optional.length > 0) {
        // I now know that optional has at least one element in it, and optional[0] should be valid, though I don't know that it is non-null.
        if(optional.length > 1) {
            // I now know that optional[1] is valid, though I do not know it is non-null.
        }
    }
} 
```

如果你需要非空：

```
if(optional.length > 0 && optional[0] != null) 
```

第二部分`optional[0] != null`只有在第一部分评估为真时才会被调用。

# php - 使用 ODBC 连接 MS Access 时如何更改连接字符集？

> ID：13790669
> 
> 赞同：3
> 
> 时间：2012-12-09T19:01:36.017
> 
> 标签：php, sql, ms-access, unicode, odbc

这就是我连接数据库的方式：

```
$dbh = new PDO("odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=C:\\xampp\\htdocs\\bd\\db\\icr.accdb;Uid=Admin"); 
```

在我的数据库中，我有带有波兰字符的数据和字段，因此 sql 查询仅在文件以 ANSI 编码时才有效。但是我的整个网站都有字符集 utf8（也有很多波兰字符）。那么，有什么方法可以将数据库的字符集更改为 utf8？

我正在尝试这个：

```
$dbh->exec("set names utf8"); 
```

和这个：

```
$dbh = new PDO("odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=C:\\xampp\\htdocs\\bd\\db\\icr.accdb;Uid=Admin", null, null, array(
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
    PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8"
  )); 
```

但两者都没有工作。有任何想法吗？

//不要问我为什么要在 php 中使用 access 数据库 -> 我必须在我的大学项目中使用它：/

编辑：代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<body>
<?php
try{
   // Connect
   $dbh = new PDO("odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dbq=C:\\xampp\\htdocs\\bd\\db\\icr.accdb;Uid=Admin");
        $dbh->exec("set names utf8");
    $sql = "SELECT * FROM Miasta";
                        $myFile = "testFile.txt";
$fh = fopen($myFile, 'w') or die("can't open file");
    foreach ($dbh->query($sql) as $row)
        {
echo $row['Nazwa'] .' - '. $row['IDWojewództwa'] . '<br />';
$stringData = $row['Nazwa'] .' - '. $row['IDWojewództwa'] . '<br />';
fwrite($fh, $stringData);
        }
fclose($fh);
    /*** close the database connection ***/
    $dbh = null;
}
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T09:45:32.583

解决方案：

```
$tresc1 .= iconv("iso-8859-2","utf-8", $row['Nazwa'] .' - '. $row['IDWojewodztwa'] . '<br />'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-19T06:48:38.397

使用如下：

```
$dbh = new PDO("odbc:Driver={Microsoft Access Driver (*.mdb  *.accdb)};Dbq=path\;Uid=Admin");
$dbh->exec("set names utf8"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-11T09:56:07.703

您可以参考以下链接。这可能会对您有所帮助。>>http://docs.oracle.com/cd/E17952_01/refman-5.0-en/connector-odbc-configuration-connection-parameters.html

另请查找>>http://www.herongyang.com/JDBC/JDBC-ODBC-MS-Access-Connection.html 了解更多程序

# php - 调用函数@垃圾回收

> ID：13790672
> 
> 赞同：0
> 
> 时间：2012-12-09T19:01:55.477
> 
> 标签：php

您好，如果用户未正确注销，我正在尝试想办法更新我的数据库。利用 session.gc_maxlifetime 似乎是正确的方法。当生命周期到期并且垃圾收集器销毁会话时，是否可以调用函数？还有 gc_maxlifetime 如何重置它的计时器？是在某些 $_SESSION 变量更新时吗？还是只是客户要求？

我试过寻找解决方案，但它们都涉及用户交互，例如我设置了一个自定义会话计时器，如果用户在不活动太长时间后与网页交互，“注销”功能就会启动并且会话被破坏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:28:42.137

您可以通过[编写自己的会话处理程序](http://php.net/session.customhandler)并使用[`session_set_save_handler()`](http://php.net/function.session-set-save-handler). `gc`当需要对会话执行 GC 时，将调用作为参数给出的函数。

请注意，这些函数只能访问*序列化*的会话数据，并且会话使用的序列化格式与普通的 PHP 序列化方法*略有不同。*如果您尝试在 GC 过程中读取用户数据，那么这样做不会有太多乐趣。

相反，您可能希望单独记录附加会话 ID 的用户活动，并将不活动和缺少注销作为单独的机制进行跟踪。

# jquery - jQuery单击位于另一个div之上的div

> ID：13790673
> 
> 赞同：5
> 
> 时间：2012-12-09T19:01:57.797
> 
> 标签：jquery

I have a problem with jQuery `click`when the selector is a for a `div`that is on top of another `div`as seen here..

html

```
<div id="parent">
 <div id="child">
 </div>
</div>​ 
```

css

```
#parent{
 background-color:red;
 width:100px;
 height:100px;   
 position:relative;
}

#parent:hover #child {
 display:block;

}
#child{
 background-color:yellow;  
 width:10px;
 height:10px;  
 border: 1px solid black;
 position:absolute;
 display:none;
 bottom:0;
 right:0;
} 
```

js

```
$("#parent").bind("click", function() {
    alert('you clicked on red');
});

$("#child").bind("click", function() {
    alert('you click on yellow');
});​ 
```

如果您单击红色`#parent`，它会给出正确的警报。如果单击黄色`#child`，它会给出黄色警报和红色警报。

见[jsfiddle](http://jsfiddle.net/qTdkt/3/)

有没有办法来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T19:06:09.567

[使用 jQuery 的`.stopPropagation()`](http://api.jquery.com/event.stopPropagation/)

```
$("#parent").bind("click", function() {
  alert('you clicked on red');
});

$("#child").bind("click", function(e) {
  e.stopPropagation();
  alert('you click on yellow');  
});​ 
```

[http://jsfiddle.net/qTdkt/4/](http://jsfiddle.net/qTdkt/4/)

# html - 使部分 div 边框透明 html

> ID：13790675
> 
> 赞同：7
> 
> 时间：2012-12-09T19:02:07.700
> 
> 标签：html, css, border, transparent

我可以使 div 边框的一部分（从 x1 到 x2）透明吗？

如果不是，您可以建议什么方法？

我的想法 [非常糟糕] 是在画布元素中绘制边框并将其（画布主体是透明的）放在 div 元素上。

![在此处输入图像描述](../Images/ed9f2893b858f5c85395e2b50d78f80a.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T19:14:03.203

由于 DIV 只有 4 个元素（上、下、左、右），因此您不能使边框的一部分透明 AFAIK。

但是，您可以创建覆盖您的 div 的元素，并使用相对定位来构建符合您口味的边框。例如：

```
<style>
 .multiborder{
        border:1px solid black;
        border-top:none;
        width:500px;
        height:100px;
        position:relative;
    }
    .top-border-1{
        border-top:2px solid red;
        width:100px;
        position:absolute;
        top:0px;
        right:0px;
    }
    .top-border-2{
        border-top:3px double blue;
        width:300px;
        position:absolute;
        top:0px;
        left:0px;
    }
</style>
<div class="multiborder">
    <div class="top-border-1"></div>
    <div class="top-border-2"></div>
</div> 
```

[你可以在http://jsfiddle.net/Bekqu/3/](http://jsfiddle.net/Bekqu/3/)看到结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-19T15:44:02.820

这里有两种可能的方法来做到这一点：

两种方法中的required`HTML`将保持不变，如下所示：

**HTML：**

```
<div class="box"></div> 
```

* * *

**方法#01：**

1.  `border`使用css 属性绘制顶部、右侧和左侧边框。
2.  `linear-gradient`使用css 属性绘制底部透明边框。

**CSS：**

```
.box {
  /* Following css will create bottom border */
  background: linear-gradient(to right, #000 30%, transparent 30%, transparent 70%, black 70%) no-repeat;
  background-size: 100% 8px;
  background-position: 0 100%;

  /* Following css will create top, left and right borders */
  border: solid #000;
  border-width: 8px 8px 0;

  width: 100px;
  height: 50px;
} 
```

```
html,
body {
  height: 100%;
}
body {
  background: linear-gradient(to top, #ff5a00 0, #ffae00 100%);
  margin: 0;
}
.box {
  background: linear-gradient(to right, #000 30%, transparent 30%, transparent 70%, black 70%) no-repeat;
  background-size: 100% 8px;
  background-position: 0 100%;
  border: solid #000;
  border-width: 8px 8px 0;
  margin: 20px 15px;
  width: 100px;
  height: 50px;
}
```

```
<div class="box"></div>
```

* * *

**方法#02：**

1.  `border`使用css 属性绘制顶部、右侧和左侧边框。
2.  `:before`使用和`:after`伪元素绘制底部边框。

**CSS：**

```
.box {
  /* Following css will create top, left and right borders */
  border: solid black;
  border-width: 8px 8px 0;

  position: relative;
  overflow: hidden;
  width: 100px;
  height: 50px;
}

/* Following css will create bottom border */
.box:before,
.box:after {
  position: absolute;
  background: #000;
  content: '';
  height: 8px;
  width: 30%;
  bottom: 0;
  left: 0;
}

.box:after {
  left: auto;
  right: 0;
} 
```

```
html,
body {
  height: 100%;
}
body {
  background: linear-gradient(to top, #ff5a00 0, #ffae00 100%);
  margin: 0;
}
.box {
  border: solid black;
  border-width: 8px 8px 0;
  position: relative;
  overflow: hidden;
  margin: 15px 10px;
  width: 100px;
  height: 50px;
}

.box:before,
.box:after {
  position: absolute;
  background: #000;
  content: '';
  height: 8px;
  width: 30%;
  bottom: 0;
  left: 0;
}

.box:after {
  left: auto;
  right: 0;
}
```

```
<div class="box"></div>
```

# iphone - 将图片发送到 iMovie iPhone 应用程序

> ID：13790676
> 
> 赞同：2
> 
> 时间：2012-12-09T19:02:10.453
> 
> 标签：iphone, ios

iPhone 的 iPhoto 应用程序具有一项功能（它是共享选项的一部分），可让您将一张或多张照片发送到 iMovie iPhone 应用程序。

有谁知道如何实现这样的功能（将照片从另一个应用程序发送到 iMovie 应用程序）？它似乎正在使用 URL Schemas，但我找不到任何关于它的文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T11:55:07.077

使用[UIDocumentInteractionController](http://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/DocumentInteraction_TopicsForIOS/Articles/PreviewingandOpeningItems.html#//apple_ref/doc/uid/TP40010410-SW1)：

就在文档中：

> 要提示用户仅在另一个应用程序中打开文件，请调用**presentOpenInMenuFromRect:inView:animated:**或**presentOpenInMenuFromBarButtonItem:animated:**方法。

或者

> 要使用一组选项提示用户，包括在另一个应用程序中打开文件的选项，请调用**presentOptionsMenuFromRect:inView:animated:**或**presentOptionsMenuFromBarButtonItem:animated:**方法。

您可以这样做：

1.  注册您的**第一个**应用程序，以便能够处理您喜欢的图像文件类型
2.  在您的**第二个**应用程序中，实现我在 UIDocumentInteractionController 中所述的方法。所以它会提示用户选择将图片发送到第**一个**应用程序。[文档](http://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/DocumentInteraction_TopicsForIOS/Articles/RegisteringtheFileTypesYourAppSupports.html#//apple_ref/doc/uid/TP40010411-SW1)为此。
3.  在您的**第一个**应用程序中，实现此方法：

    `-(BOOL)application:openURL:sourceApplication:annotation:`

    打开从第一个应用程序传输的图片。图片将存储在`Documents/Inbox`. 然后，您现在可以愉快地在您的第一个应用程序中使用该图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T06:26:47.923

首先，您需要要共享的图像的 NSURL。如果您的图像只是在内存中，您可以将图像保存在某处，然后使用该 URL。

```
NSURL *imageURL = /* URL of your image */ 
```

现在使用以下方法创建一个 UIDocumentInteractionController：

```
UIDocumentInteractionController *documentInteractionController = 
     [UIDocumentInteractionController interactionControllerWithURL:imageURL]; 
```

而已。您可以继续使用以下任何方法展示您的 documentInteractionController：

```
– presentOptionsMenuFromRect:inView:animated:
– presentOptionsMenuFromBarButtonItem:animated:
– presentOpenInMenuFromRect:inView:animated:
– presentOpenInMenuFromBarButtonItem:animated:
– dismissMenuAnimated: 
```

所以现在会出现一个弹出窗口，列出**所有愿意使用您的图像的应用程序（包括 iMovie，如果已安装）。**

如果您想了解有关 UIDocumentInteractionController 的更多信息，请访问此处：http: [//developer.apple.com/library/ios/#documentation/UIKit/Reference/UIDocumentInteractionController_class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIDocumentInteractionController_class/Reference/Reference.html)

# entity-framework - 实现第二部分很少区分的复合键的策略。实体框架代码优先

> ID：13790677
> 
> 赞同：0
> 
> 时间：2012-12-09T19:02:17.187
> 
> 标签：entity-framework, entity-framework-5, composite-primary-key, identity-column, sql-server-ce-4

我有以下情况：

实体通常是唯一的 `Atom`，可以使用单个`AtomID`字段作为其主键存储在数据库中。`. In rare cases the`Atom `needs to be split. In that case a second record must be created in the database table with an identical`AtomID `but a discriminating`SplitID`。

所以，基本上我需要一个复合键，并且`AtomID`很少有区别。我不想失去 SQLServerCompact4 数据库提供的 AutoID 功能，但是当我在 Fluid API 中为实体定义复合键时会发生这种情况。`SplitID``SplitID``Atom`

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:14:17.540

您应该使用外键创建一个新表，`AtomID`并区分`SpiltID`以显示两者之间的关系。

# module - 在 prestashop 模块中。如何在中心栏中显示内容？

> ID：13790680
> 
> 赞同：0
> 
> 时间：2012-12-09T19:02:43.463
> 
> 标签：module, prestashop

我正在尝试为 PrestaShop 1.5 编写一个 CMS 新闻模块。而且我找不到在中心栏中显示内容的方法或钩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:28:25.100

您需要创建自己的 php 和 tpl 文件来制作自己的页面并在中心栏中显示内容。更多信息可以在[官方指南中找到如何为 Prestashop 1.5 创建一个模块](http://doc.prestashop.com/display/PS15/Creating+a+PrestaShop+module#CreatingaPrestaShopmodule-Displayingcontent)

# c# - 异步与线程，何时使用每个选项？

> ID：13790683
> 
> 赞同：3
> 
> 时间：2012-12-09T19:03:00.003
> 
> 标签：c#, multithreading, async-await

此页面[http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx)在线程部分中表示异步方法不在其他线程中运行，如果我想使用其他线程，我会使用Task.Run。

所以我知道异步和线程是两个不同的东西，每个选项在某些情况下都有好处。我想知道什么时候使用异步更好，什么时候使用线程更好。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:21:54.353

当你有持续的工作要做时，你会使用线程。直接使用自定义写入池。即使这样，您也可以将其隐藏在自定义任务计划程序后面（使用他自己的线程池）。

当您不需要控制低级线程参数时，线程具有一些优势 - 这是非常罕见的。诸如设置优先级之类的琐事您也可以在异步中执行（记住要回退），但有时您需要为互操作设置很多东西。

尽管如此，这些天线程是一个非常低级的 API - 由于任务与自定义调度程序一起使用，因此您确实很少使用自定义任务调度程序之外的线程（它可能在内部使用自定义线程的线程池作为低级 API） .

当您为 LONG TERM 分配线程时，线程也很方便。长期不一定是“计算密集型”。我在这里有一个在自定义线程上以 24 小时循环运行的 API - 我启动一个线程，调用一个“处理数据”方法，该方法会回调给我。该方法在问题/错误时返回，或每天一次（为下一个实时数据块立即重新启动）。显然，忙个不停，这对于线程来说是一个很好的例子，而不是一个任务，因为一个任务的所有高级特性都是无用的。

对于几乎所有其他事情这些天我使用任务/异步。

# ruby-on-rails - 设计发送到错误 Heroku 应用程序的确认电子邮件

> ID：13790686
> 
> 赞同：2
> 
> 时间：2012-12-09T19:03:08.397
> 
> 标签：ruby-on-rails, heroku, devise, sendgrid

我在 Heroku 上运行两个 Rails 3.1.0 应用程序。这些应用程序之一仅用于登台目的。我正在使用 Devise 进行身份验证并使用 sendgrid 来处理电子邮件。

当用户在主应用程序上注册时，确认电子邮件似乎可以正常发送。但是，当用户单击电子邮件中的确认链接时，它们会被发送到暂存应用程序。电子邮件中的链接是 Confirmation_url，它似乎没有硬编码到我的应用程序中的任何内容。

关于为什么会发生这种情况的任何想法或关于如何进行调试的建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-10T02:49:31.747

你很可能已经在你的`config/environments/production.rb`

```
# Email settings
config.action_mailer.default_url_options = { :host => "www.your-staging-server-url.com" }
config.action_mailer.smtp_settings = {
  :address        => 'smtp.sendgrid.net',
  :port           => '587',
  :authentication => :plain,
  :user_name      => ENV['SENDGRID_USERNAME'],
  :password       => ENV['SENDGRID_PASSWORD'],
  :domain         => 'heroku.com'
} 
```

# sql - 加入选择 SQL Server 存储过程

> ID：13790692
> 
> 赞同：0
> 
> 时间：2012-12-09T19:03:21.470
> 
> 标签：sql, sql-server, stored-procedures

我正在尝试创建一个存储过程来将数据插入到 SQL Server 中的 2 个表中。

我尝试将连接放在代码的所有不同位置，但仍然出现错误。

```
 CREATE PROCEDURE sp_Insert_Person
 @s_FirstName nvarchar(50),
 @s_Surname nvarchar(50),
 @s_AddressLine1 nvarchar(50),
 @s_AddressLine2 nvarchar(50),
 @s_Postcode nvarchar(10),
 @s_Phone nvarchar(50),
 @s_Department nvarchar(50)
 AS
BEGIN
INSERT INTO 
        tbl_person(FirstName, Surname, AddressLine1, AddressLine2, 
                   Postcode, Phone, tbl_Department.Department)
INNER JOIN tbl_person
ON  tbl_person.DepartmentID = tbl_Department.DepartmentID

VALUES (@s_FirstName,
        @s_Surname,
        @s_AddressLine1,
        @s_AddressLine2,
        @s_Postcode,
        @s_Phone,
        @s_Department)

END 
```

我已经尝试了最后的连接，一开始我到处寻找插入连接，想知道我是不是弄错了。

我有一个部门表和一个人员表，并认为我可以通过`DepartmentID`我在人员表中的 FK 访问部门表，部门表中的 PK 也是如此

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:08:11.547

我想这样的事情

```
INSERT INTO tbl_person
                     (FirstName,
                     Surname, 
                     AddressLine1, 
                     AddressLine2, 
                     Postcode, 
                     Phone, 
                     DepartmentID)
Select @s_FirstName,
        @s_Surname,
        @s_AddressLine1,
        @s_AddressLine2,
        @s_Postcode,
        @s_Phone, 
        tbl_Department.DepartmentID 
from  tbl_person 
join DepartmentID
ON  tbl_person.DepartmentID = tbl_Department.DepartmentID 
where tbl_Department.Department = @s_Department 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:10:45.097

```
 CREATE PROCEDURE sp_Insert_Person
 @s_FirstName nvarchar(50),
 @s_Surname nvarchar(50),
 @s_AddressLine1 nvarchar(50),
 @s_AddressLine2 nvarchar(50),
 @s_Postcode nvarchar(10),
 @s_Phone nvarchar(50),
 @s_Department nvarchar(50)
 AS
BEGIN
if not Exists(select * from tbl_Department where Department=@s_Department)
   insert into tbl_Department (Department) Values (@s_Department)

INSERT INTO tbl_person
                     (FirstName,
                     Surname, 
                     AddressLine1, 
                     AddressLine2, 
                     Postcode, 
                     Phone, 
                     DepartmentID)

select @s_FirstName,
        @s_Surname,
        @s_AddressLine1,
        @s_AddressLine2,
        @s_Postcode,
        @s_Phone,
        @s_Department,
        DepartmentID 
        from tbl_Department 
        where Department=@s_Department
END 
```

# xaml - 如何在 MS Blend 4 中获得类似 Eclipse 的提示

> ID：13790693
> 
> 赞同：1
> 
> 时间：2012-12-09T19:03:22.477
> 
> 标签：xaml, expression-blend

如何在 MS Blend 4 中获得提示。在 Eclipse 中，这是 CTRL+空格，在这里它不起作用。当我写错时，提示列表消失，我必须删除 = 符号的字符，以便它们再次出现。![在此处输入图像描述](../Images/99d92e0784702eaf5de89c9fbd2f7b1d.png)

# ios - Grand Central Dispatch 和并发任务

> ID：13790701
> 
> 赞同：3
> 
> 时间：2012-12-09T19:04:03.943
> 
> 标签：ios, multithreading, concurrency, grand-central-dispatch

我需要执行三个彼此独立的任务，所以我想同时执行它们。但我需要他们都完成通知另一个对象。AFAIK，*dispatch_apply* 创建并发线程，但它迭代一个集合或一个对象数组并执行相同的任务多个循环，我想为每个线程执行不同的任务。使用GCD可以做我想做的事吗？如果没有，最好的方法应该是什么？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T19:25:55.833

使用`dispatch_group`. [Concurrency Programming Guide](http://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW25)提供了一个示例，还有[更多 API](http://developer.apple.com/library/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008079-CH2-SW19)也可能对您有所帮助。

*   使用 创建一个调度组`dispatch_group_create`。

*   将每个“任务”放入组中，方法是使用`dispatch_group_async`.

    （或者，使用`dispatch_group_enter`and手动告诉 GCD 每个任务何时开始和停止`dispatch_group_leave`。）

*   要在组中的所有任务完成后运行一个块，请使用`dispatch_group_notify`.

    （或者，在您的应用程序设计允许您同步等待的不太可能的情况下，请`dispatch_group_wait`改用。）

*   当你完成了小组，`dispatch_release`它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T19:27:58.370

调度组是您所需要的。查看 GCD 函数。您要做的是创建组和并发队列（或使用标准队列）。将三个操作（块）与 dispatch_group 相关联，然后创建第四个块，并让该块执行 dispatch_group_wait（按内存键入名称），然后当它返回时，它可以向其他对象发布“成功”消息。将等待的块放入任何并发队列中。

我在我的应用程序中正是这样做的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-12T06:42:16.153

我知道你问过 GCD，但这[`NSOperationQueue`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/NSOperationQueue_class/Reference/Reference.html)是另一种可能性。例如：

```
NSOperationQueue *queue = [[NSOperationQueue alloc] init];
queue.maxConcurrentOperationCount = 3;

// create my completion operation (which will be added to the queue later, once
// the dependencies with all of the other operations has been established)

NSBlockOperation *completionOperation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"All done");
}];

// let's add our three operations

NSBlockOperation *operation;

operation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"starting task 1");
    sleep(5);
    NSLog(@"stopping task 1");
}];

[completionOperation addDependency:operation];
[queue addOperation:operation];

operation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"starting task 2");
    sleep(4);
    NSLog(@"stopping task 2");
}];

[completionOperation addDependency:operation];
[queue addOperation:operation];

operation = [NSBlockOperation blockOperationWithBlock:^{
    NSLog(@"starting task 3");
    sleep(6);
    NSLog(@"stopping task 3");
}];

[completionOperation addDependency:operation];
[queue addOperation:operation];

// now let's add the completion operation (which has been configured as dependent
// upon the other operations

[queue addOperation:completionOperation]; 
```

有很多不同的方法可以解决这个问题，但这`NSOperationQueue`是另一种选择。[并发编程指南](https://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091-CH1-SW1)讨论了所有选项。

# php - MySQL-IF 语句错误

> ID：13790702
> 
> 赞同：0
> 
> 时间：2012-12-09T19:04:03.593
> 
> 标签：php, mysql, sql, database

我遇到了这个 SQL 语句的问题：

```
$sql="SELECT b.FrameNumber, b.BikeCode, IF(b.ProductID = 0, p.FrameNumber) 
   AS FrameNumber 
 FROM BikeStock b LEFT JOIN Purchase p ON b.FrameNumber = p.FrameNumber 
 WHERE b.bikecode = '$bikecode'"; 
```

我希望 SQL 语句以这种方式工作：

```
Select FrameNumber & BikeCode from BikeStock 
THEN IF ProductID(BikeStock) is equal to 0 
     then it will grab the framenumber from the purchase table where bikecode is equal to $bikecode 
```

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:07:57.277

您必须将 else 部分添加到您的[`if()`](http://dev.mysql.com/doc/refman/5.5/en/control-flow-functions.html#function_if)

```
SELECT b.FrameNumber, b.BikeCode,
       IF(b.ProductID = 0, p.FrameNumber, NULL) AS FrameNumber
FROM BikeStock b
LEFT JOIN Purchase p ON b.FrameNumber = p.FrameNumber
WHERE b.bikecode = '$bikecode' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:09:02.550

MySQL`IF`语句具有以下语法：`IF(condition, expression if true, expression if false)`.

据我从您的问题中可以看出，您实际上是在寻找一个`WHERE`子句（请记住，您可以有多个条件`WHERE`- 使用布尔运算符将它们组合起来）：

```
SELECT b.FrameNumber, b.BikeCode, p.FrameNumber
FROM BikeStock b
LEFT JOIN Purchase p ON b.FrameNumber = p.FrameNumber
WHERE b.bikecode = :bikecode AND b.ProductID = 0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:08:17.293

您忘记了`else`该 IF 语句的一部分：

```
$sql = "SELECT b.FrameNumber, b.BikeCode, IF(b.ProductID = 0, p.FrameNumber, NULL /* ELSE HERE */) AS FrameNumber 
        FROM BikeStock b 
        LEFT JOIN Purchase p 
            ON b.FrameNumber = p.FrameNumber 
        WHERE b.bikecode = '$bikecode'"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T19:13:49.140

试试这个

```
 $sql="SELECT b.FrameNumber, b.BikeCode, p.FrameNumber (
          CASE WHEN b.ProductID = 0 THEN p.FrameNumber ELSE NULL END AS Framenumber)  
          FROM BikeStock b 
          LEFT JOIN Purchase p ON b.FrameNumber = p.FrameNumber 
          WHERE b.bikecode = '$bikecode'"; 
```

# iphone - iPhone 上的屏幕外 FBO

> ID：13790704
> 
> 赞同：0
> 
> 时间：2012-12-09T19:04:08.490
> 
> 标签：iphone, opengl-es, opengl-es-2.0

我正在使用 iPhone 4、iOS 6.0.1。我正在创建一个与主 FBO 大小不同的屏幕外 FBO。我使用以下代码来执行此操作，其中 cxFBO 和 cyFBO 是主 FBO 大小的两倍：

```
glGenRenderbuffers(1, &_colorRenderBuffer);
glBindRenderbuffer(GL_RENDERBUFFER, _colorRenderBuffer);
glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA, cxFBO, cyFBO);

glGenFramebuffers(1, &_frameBufferID);
glBindFramebuffer(GL_FRAMEBUFFER, _frameBufferID);
glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, _colorRenderBuffer);

glGenTextures(1, &_fboTextureID);
glBindTexture(GL_TEXTURE_2D, _fboTextureID);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, cxFBO, cyFBO, 0, GL_RGBA, GL_UNSIGNED_BYTE, NULL);
glFramebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, _fboTextureID, 0); 
```

然后我在打电话后画到它`glBindFramebuffer(GL_FRAMEBUFFER, _frameBufferID)`。我不想用着色器发布整个绘图程序。我认为我没有做任何特别的事情，但是如果您认为这很重要，我将发布一个简短的示例。问题是只有四分之一的纹理被顶点填充，其他 3 个四分之一是由`glClearColor()`.

我究竟做错了什么？我对格式特别有点困惑，即`GL_RGBA`. 我应该使用`GL_RGBA_OES`吗？到处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:58:48.393

问题是我忘记调用 glViewPort()。如果您考虑一下，这很明显;-)

# node.js - 循环 node.js 中的回调

> ID：13790706
> 
> 赞同：1
> 
> 时间：2012-12-09T19:04:53.247
> 
> 标签：node.js, callback

我不明白如何在循环中设置回调：

```
models.chat_user.find( {user_id: app.locals.session.user._id}, function(err, result){
    if(result.length < 1){
        chat.user = new models.chat_user({
        user_id: app.locals.session.user._id
        })
        chat.user.save();
    }
    models.chat_user.find(function(err, result){
        for(value in result){
        models.user.findOne({_id: result[value].user_id}, function(err, user){
                chat.users[value] = {};
                chat.users[value].username = user.username
                chat.users[value].mail = app.locals.user.getAvatar(user.mail, 50);
            });
        }
    })
}); 
```

当我在循环中找到所有数据时，我想设置一个回调，但我不知道 result.lenth 的条件如何，但这不是很干净

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:25:49.487

[`async.forEach`](https://github.com/caolan/async#forEach)像这样使用：

```
models.chat_user.find(function(err, result){
    async.forEach(result, function(value, callback) {
        models.user.findOne({_id: result[value].user_id}, function(err, user){
            chat.users[value] = {};
            chat.users[value].username = user.username
            chat.users[value].mail = app.locals.user.getAvatar(user.mail, 50);
            callback(err);
        });
    }, topLevelCallback);
}); 
```

`topLevelCallback`当所有`forEach`迭代都调用它们时调用它们`callback`，如果有错误则传递任何错误。

# android - Android ORMLite - ForeignCollection 子项具有空的外部字段

> ID：13790709
> 
> 赞同：3
> 
> 时间：2012-12-09T19:05:04.980
> 
> 标签：android, ormlite, foreign-collection

我目前遇到以下情况；

基本上我有一个 Work 类，它有一个 ForeignCollection 的 WorkTasks。我想简单地接收链接到 Work 对象的所有 WorkTasks。

如果我查询所有 WorkTasks，我会得到一个结果列表，但带有“work = null”。因此它无法与正确的 Work 对象建立任何链接。查询 work_id 和 Work 本身的空列表时没有结果。

我已经无数次地看到过这样的例子和问题，但显然我错过了一些东西。

下面是我使用的相关代码；

数据库助手；

```
@Override
public void onCreate(SQLiteDatabase database, ConnectionSource connectionSource) {
    try {

        applicantDao = DaoManager.createDao(connectionSource, Applicant.class);
        educationDao = DaoManager.createDao(connectionSource, Education.class);
        workDao = DaoManager.createDao(connectionSource, Work.class);
        workTaskDao = DaoManager.createDao(getConnectionSource(), WorkTask.class);
        onlinePersonDao = DaoManager.createDao(connectionSource, OnlinePerson.class);
        institutionDao = DaoManager.createDao(connectionSource, Institution.class);
        lessonDao = DaoManager.createDao(connectionSource, Lesson.class);

        TableUtils.createTable(connectionSource, Applicant.class);
        TableUtils.createTable(connectionSource, Education.class);
        TableUtils.createTable(connectionSource, Work.class);
        TableUtils.createTable(connectionSource, Institution.class);
        TableUtils.createTable(connectionSource, Lesson.class);
        TableUtils.createTable(connectionSource, OnlinePerson.class);
        TableUtils.createTable(connectionSource, Reference.class);
        TableUtils.createTable(connectionSource, WorkTask.class);

[....]

 public Dao<WorkTask, Integer> getWorkTaskDao() {
    if (null == workTaskDao) {
        try {
            workTaskDao = getDao(WorkTask.class);
        } catch (java.sql.SQLException e) {
            e.printStackTrace();
        }
    }
    return workTaskDao;
} 
```

数据库管理员：

```
public List<Experience> getAllWork() {
        List<Experience> exp = null;
        try {
            exp = getHelper().getWorkDao().queryForAll();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return exp;
    }

    public List<WorkTask> getAllWorkTask() {
        List<WorkTask> workTask = null;
        try {
            workTask = getHelper().getWorkTaskDao().queryForAll();
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return workTask;
    }

public List<WorkTask> getWorkTaskByWorkId(int workId) {
        List<WorkTask> workTasks = null;
        try {
            workTasks = getHelper().getWorkTaskDao().queryForEq("work_id", workId);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        return workTasks;
    }

public void addWork(Collection<Work> jobs) {
        try {
            for (Experience work : jobs) {
                Work w = (Work) work;
                // Add nested child first
                this.addInstitution(w.institution);
                this.addWorkTask(w.tasks);

                getHelper().getWorkDao().createOrUpdate(w);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public void addWorkTask(Collection<WorkTask> worktasks) {
        try {
            for (WorkTask wt : worktasks) {
                getHelper().getWorkTaskDao().createOrUpdate(wt);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    } 
```

工作模型的列表（从抽象父级获取预填充的 id）：

```
@ForeignCollectionField(eager = true)
    @SerializedName("tasks")
    public Collection<WorkTask> tasks;

    public ArrayList<WorkTask> getTasks(){
        ArrayList<WorkTask> taskList = new ArrayList<WorkTask>();
        Iterator iterator = tasks.iterator();
        while(iterator.hasNext()){
            WorkTask task = (WorkTask) iterator.next();
                    taskList.add(task);

        }
        return taskList;
    } 
```

工作任务：

```
public class WorkTask {

    /**
     * Auto-incremented id for the ORMLite-SQLite database
     */
    @DatabaseField(generatedId = true)
    public int id;

    /**
     * Foreign field id for the ORMLite-SQLite database
     */
    @DatabaseField(foreign = true, foreignAutoCreate = true, foreignAutoRefresh = true, columnName = "work_id")
    public Work work; 
```

最后是所有让我失望的事情：

```
 ArrayList<WorkTask> tasks_iterated = work.getTasks();

        ArrayList<WorkTask> tasks_id = (ArrayList<WorkTask>) DatabaseManager.getInstance()
                .getWorkTaskByWorkId(work.id);

        ArrayList<WorkTask> tasks = (ArrayList<WorkTask>) DatabaseManager.getInstance().getAllWorkTask(); 
```

这最终给我留下了：

tasks_iterated = empty
tasks_id = empty
tasks = 我的任务的完整列表，但所有任务都具有属性“work = null”，因此我无法将它们放置到正确的 Work 对象中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T18:09:46.823

通过将我的添加方法更改为：

```
public void addWorkTask(Collection<WorkTask> worktasks, Work work) {
        try {
            for (WorkTask wt : worktasks) {
                wt.work = work;
                getHelper().getWorkTaskDao().createOrUpdate(wt);
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    } 
```

不确定这是否是唯一的方法。似乎有点奇怪，我必须手动执行此操作。

# java - 在 Java 中不鼓励传递对对象的引用吗？

> ID：13790710
> 
> 赞同：1
> 
> 时间：2012-12-09T19:05:16.970
> 
> 标签：java, user-interface, object, reference, constructor

我是一名自学成才的程序员，和许多其他菜鸟一样，我曾经为经典的“在表单之间传递数据”问题苦苦挣扎。大约一年前，当我用 Java 构建我的第一个聊天应用程序时，我再次遇到了这个问题。我通过将对正在运行的 GUI 的引用传递给另一个类的构造函数来解决它，这样它就可以直接操作 GUI。例如：

```
class GUI {
    Writer w;
    void initGUI() {
        w = new Writer(this);
    }
}

class Writer {
    GUI ui;
    public Writer(GUI ui) {
        this.ui = ui;
        ui.textBox.write("Yo");
        // now, instead of the "this" keyword, I can say "ui.w" or "ui.w.ui.w.ui.w..."
    }
} 
```

我确信这是“上游”传输数据的最有效方式之一，但我因在论坛上为遇到同样问题的人提出这一建议而感到悲痛（和一些表扬）。那么在更大的应用程序上这样做会引起什么样的混乱呢？当我查看使用它的应用程序时，我注意到它们非常实用和高效，但也有点过于有机（如果你愿意的话）和复杂（特别是当有线程在不同时间访问 GUI 时等）。

有没有更好的方法来做到这一点？在使用 Qt 时，我出于需要采取了不同的方法，但它更复杂，因为它使用了信号、插槽和线程。请指出我正确的方向。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:17:20.177

这种方法的主要问题是耦合。Writer 类不是一个通用的、可重用的 Writer 类，它能够完成它的工作并在需要时发送关于它所做的事情的事件，它与这个特定的 GUI 紧密耦合。

如果它接受侦听器，就像所有 Swing 组件一样，您可以在几个不同的 GUI 中重用 Writer，或者选择更新文本区域而不是文本字段。

另一种解决方案是使用拉而不是推。您可以让编写器的 GUI 调用方法来查询其状态，而不是让编写器更新 GUI。这并不总是可能的，但它经常是。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:30:46.877

> 我通过将对正在运行的 GUI 的引用传递给另一个类的构造函数来解决它，这样它就可以直接操作 GUI。

您希望将业务逻辑与表示层分离。您希望能够独立于 gui 独立地测试您的业务逻辑。您希望能够更改前端 gui，而无需修改后端。这称为[关注点分离](https://en.wikipedia.org/wiki/Separation_of_concerns)。

有许多设计模式可以帮助您实现这一目标。

其中之一是[模型视图控制器（MVC）](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)。

您无需直接与 GUI 交互，而是直接与模型交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:39:06.993

是的，Java 绝对是对象的引用传递。

但是你所做的是你`Writer`假设你`GUI`是一成不变的，这意味着它总是有一个名为`textBox`.

仅从外观上看，`Writer`不应该负责访问和操作`GUI`. 如果您更改 . 中的内容`GUI`，您还需要重新编码`Writer`课程。

您可以将您的代码重新编码`Writer`为仅向其发送一条消息，`GUI`因为它的职责只是告诉`GUI`您要写什么，而不是如何写。然后将其留给`GUI`处理该消息：

```
class GUI
{
     Writer w;
     void initGUI()
     {
        w = new Writer(this); 
     }

     void ReceiveMessage(string message)
     {
         this.textBox.text = message;
     }
} 
```

你的`Writer`班级：

```
class Writer
{
    GUI ui;

    public Write(GUI ui)
    {
         this.ui = ui;
         // Don't send the message in the constructor.
    }

    // The program calls this function with whatever text the user enters.
    public void SendMessage(string message)
    {
        ui.ReceiveMessage(message);
        // Writer no longer depends on ui to have a textbox Element.
    }
} 
```

上面的代码可以通过接口进行改进。这样，您可以将任何需要知道如何接收消息的内容传递给您的作者：

```
interface IMessageReceiver
{
    void ReceiveMessage(string message);
} 
```

现在，你`GUI`变成了一个 IMessageReceiver：

```
class GUI implements IMessageReceiver
{
     Writer w;
     void initGUI()
     {
        w = new Writer(this); 
     }

     public void ReceiveMessage(string message)
     {
         this.textBox.text = message;
     }
} 
```

`Writer`现在上课：

```
class Writer
{
    IMessageReceiver receiver;

    public Write(MessageReceiver receiver)
    {
         this.receiver = receiver;
         // Don't send the message in the constructor.
    }

    // The program calls this function with whatever text the user enters.
    public void SendMessage(string message)
    {
        receiver.ReceiveMessage(message);

    }
} 
```

这里的区别是`Writer`不再关心它是否是`GUI`. 只要它`IMessageReceiver`知道如何接收消息，它就会接受任何对象。

如果您不熟悉接口，请对其进行一些阅读/研究。它们非常方便，如果不是，至关重要！

# php - 从url获取文件内容，然后提取关键字

> ID：13790712
> 
> 赞同：-6
> 
> 时间：2012-12-09T19:05:32.610
> 
> 标签：php, json

我有这个 json 页面： [https://www.googleapis.com/books/v1/volumes?q=9789264187061](https://www.googleapis.com/books/v1/volumes?q=9789264187061) 看起来像这样：

> {“种类”：“books#volumes”，“totalItems”：1，“items”：[{
> “种类”：“books#volume”，“id”：“Z9i0nRGVYrcC”，“etag”：“6BZ/vrmjoqQ” , "selfLink": " [https://www.googleapis.com/books/v1/volumes/Z9i0nRGVYrcC](https://www.googleapis.com/books/v1/volumes/Z9i0nRGVYrcC) ",
> 在国家和地方层面刺激创新的政策必须建立并促进创新集群的活力。本书介绍了该领域的政策制定者和学术专家撰写的一系列论文，展示了为什么以及如何在不同的国家背景下做到这一点。", "industryIdentifiers": [ { "type": "ISBN_10", "identifier ": "9264187065" }, { "type": "ISBN_13", "identifier": "9789264187061" } ], "pageCount": 419, "printType": "BOOK", "categories": [ "Business & Economics" ]，“averageRating”：1.0，“ratingsCount”：[http://bks6.books.google.it/books?id=Z9i0nRGVYrcC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api](http://bks6.books.google.it/books?id=Z9i0nRGVYrcC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api) ", "缩略图": " [http://bks6.books.google.it/books?id= Z9i0nRGVYrcC&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api](http://bks6.books.google.it/books?id=Z9i0nRGVYrcC&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api) " }, "language": "en", "previewLink": " [http://books.google.it/books?id=Z9i0nRGVYrcC&printsec=frontcover&dq=9789264187061&hl=&cd=1&source =gbs_api](http://books.google.it/books?id=Z9i0nRGVYrcC&printsec=frontcover&dq=9789264187061&hl=&cd=1&source=gbs_api) ", "infoLink": " [http://books.google.it/books?id=Z9i0nRGVYrcC&dq=9789264187061&hl=&source=gbs_api](http://books.google.it/books?id=Z9i0nRGVYrcC&dq=9789264187061&hl=&source=gbs_api) ", "canonicalVolumeLink": " [http://books.google.it/books/about /Innovative_Clusters。html?hl=&id=Z9i0nRGVYrcC](http://books.google.it/books/about/Innovative_Clusters.html?hl=&id=Z9i0nRGVYrcC)" }, "saleInfo": { "country": "IT", "saleability": "NOT_FOR_SALE", "isEbook": false }, "accessInfo": { "country": "IT", "viewability": "ALL_PAGES ”，“可嵌入”：真，“publicDomain”：假，“textToSpeechPermission”：“ALLOWED_FOR_ACCESSIBILITY”，“epub”：{“isAvailable”：真，“acsTokenLink”：“ [http://books.google.it/books/下载/Innovative_Clusters-sample-epub.acsm?id=Z9i0nRGVYrcC&format=epub&output=acs4_fulfillment_token&dl_type=sample&source=gbs_api](http://books.google.it/books/download/Innovative_Clusters-sample-epub.acsm?id=Z9i0nRGVYrcC&format=epub&output=acs4_fulfillment_token&dl_type=sample&source=gbs_api) " }, "pdf": { "isAvailable": false },"webReaderLink": " [http://books.google.it/books/reader?id=Z9i0nRGVYrcC&hl=&printsec=frontcover&output=reader&source=gbs_api](http://books.google.it/books/reader?id=Z9i0nRGVYrcC&hl=&printsec=frontcover&output=reader&source=gbs_api)", "accessViewStatus": "SAMPLE" }, "searchInfo": { "textSnippet": "本书介绍了该领域的政策制定者和学术专家撰写的一系列论文，展示了为什么以及如何在不同的国家背景。” } } ] }

我必须阅读并定义 $book_title 和 $book_author

> “volumeInfo”：{“title”：“创新集群”，“作者”：[“Pim Den Hertog”，“Svend Reme”，

根据上面的代码

> 回声 $book_title;

应该返回“创新集群”和

> 回声 $book_author;

应该返回“Pim Den Hertog 和 Svend Reme”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:18:30.990

看[`json_decode()`](http://php.net/json_decode)功能。
当第一个参数放置您的`json`代码（或 var）时，第二个 if 设置为`true`将返回一个关联数组。

```
$file = file_get_contents('https://www.googleapis.com/books/v1/volumes?q=9789264187061');
$json = json_decode($file, true);

print_r($json); 
```

这是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:34:20.650

请参阅此[链接](http://webhole.net/2009/08/31/how-to-read-json-data-with-php/)。不要指望别人做你的功课，稍微研究一下代码，你会在不到 10 分钟的时间内找到答案。基本上，当您解码 json 时，您将根据需要获得对象或数组。所以如果你这样做

```
 $data=json_decode($str);//$str is your json string
   foreach($data->items as $item){
      foreach($item as $bookdata){
         if(is_object($bookdata) && isset($bookdata->title)){
                echo $bookdata->title ; 
              }
           } 
        } 
```

我把它留给你弄清楚如何获得作者；）结合这个和以前的答案，你就在那里

# objective-c - 使 NSTableView 处于活动状态

> ID：13790718
> 
> 赞同：2
> 
> 时间：2012-12-09T19:06:09.430
> 
> 标签：objective-c, macos, cocoa, nstableview, nstextfield

可可菜鸟在这里。

我有一个简单的 Mac 应用程序，其中包含一个 NSTextField，它获取一些结果并将它们放入 NSTableView。我希望能够在文本字段中按向上/向下键来激活表格视图中的第一个/最后一个项目。

我做了以下事情：

```
- (void)keyUp:(NSEvent *)theEvent {
    switch([theEvent keyCode]) {
        case 125: {
            NSLog(@"I need to move down");
            NSIndexSet *indexSet = [NSIndexSet indexSetWithIndex:0];
            [resultsTableView selectRowIndexes:indexSet byExtendingSelection:NO];
            [resultsTableView becomeFirstResponder];
            break;
        }
        case 126: {
            NSLog(@"I need to move up");
            NSIndexSet *indexSet = [NSIndexSet indexSetWithIndex:[results count]-1];
            [resultsTableView selectRowIndexes:indexSet byExtendingSelection:NO];
            [resultsTableView becomeFirstResponder];
            break;
        }
    }
} 
```

这部分是我想要的。它确实选择了 中的第一个或最后一个项目`resultsTableView`，但所选项目保持灰色，并且 textview 保持活动状态。

我以为调用`becomeFirstResponder`the`resultsTableView`可以解决问题，但事实并非如此。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-09T23:52:56.027

永远不要直接打电话`becomeFirstResponder`。使用 NSWindow 的`makeFirstResponder:`

```
[[resultsTableView window] makeFirstResponder:resultsTableView]; 
```

# java - JSTL URL 标签在 Heroku 上不起作用

> ID：13790720
> 
> 赞同：2
> 
> 时间：2012-12-09T19:06:24.447
> 
> 标签：java, url, heroku, jstl

我有一个在本地（在 Tomcat 中）以及 Google App Engine 和 Heroku 上部署的简单应用程序。

该应用程序使用 JSTL 标记，并且它们在所有部署中都可以正常工作，除了 URL 标记 ( `<c:url value="/someUrl"/>`)，它仅在 Heroku 上附加了一个额外的正斜杠，这会搞砸一切。这就是我的意思：

```
<c:url value='/laundryLists/search.htm'/> 
```

在我的本地 Tomcat 中，应用程序使用“testApp”上下文部署，上面的代码片段将在页面中生成以下字符串：

“/testApp/laundryLists/search.htm”

哪个是对的。

在我的 GAE 部署应用程序中，地址为 testApp.appspot.com，上面的代码片段生成：

“/laundryLists/search.htm”

这是正确的，因为这里的应用程序上下文是“/”（根）

在我的 Heroku 版本中，该版本部署在“testApp.herokuapp.com”

完全相同的代码生成：

“//laundryLists/search.htm”（注意开头有两个正斜杠）

这是错误的，因为如果放在链接中，例如

```
<a href="<c:url value='/laundryLists/search.htm'/>">whatever</a> 
```

链接 URL 将是：

```
http://laundryLists/search.htm 
```

这显然是错误的。

值得一提的是，其他 JSTL 标记（例如“forEach”）在 Heroku 中也可以正常工作。

所以我的问题是，为什么在 Heroku 上会发生这种情况，我该如何修复它（除了硬编码 URLS）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-27T07:56:03.967

将[WAR 文件部署到 Heroku](https://devcenter.heroku.com/articles/war-deployment)时，WAR 文件使用[Webapp Runner](https://github.com/jsimone/webapp-runner)启动，它只是 Tomcat 的一个薄包装器，允许它从命令行轻松运行。在当前部署的 Webapp Runner 版本中，默认上下文路径是`/`，这是额外斜杠的来源。要将路径设置为其他内容（包括空字符串），您可以使用`--path`参数。要为使用 WAR 部署的 Heroku 应用程序设置此项，您可以`WEBAPP_RUNNER_OPTS`像 thisr 一样在 config var 中设置它：

```
heroku config:add WEBAPP_RUNNER_OPTS="--path ''" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-07T22:07:30.720

为了补充 ryanbrainard 所说的话，以防有人遇到我遇到的同样的麻烦。我发现在部署时尝试在命令行设置此标志没有效果，可能是因为我在执行 git push 时进行部署，而不是使用命令行部署战争。

我必须在我的项目中更新 /Procfile 并在那里添加选项。所以我的看起来像： web: java $JAVA_OPTS -Dspring.profiles.active=prod -jar target/dependency/webapp-runner.jar --port $PORT --path '' target/*.war

这为我解决了这个问题。

# c# - 如何从 ebay getFeedback API 检索数据

> ID：13790721
> 
> 赞同：0
> 
> 时间：2012-12-09T19:06:26.467
> 
> 标签：c#, ebay-api

我正在尝试使用 ebay 的 getFeedback API 为指定用户获取一些数据，并最终得到此代码。

```
namespace one
{
class Program
{
    private static ApiContext apiContext = null;

    static void Main(string[] args)
    {
        ApiContext apiContext = GetApiContext();

        GeteBayOfficialTimeCall apiCall = new GeteBayOfficialTimeCall(apiContext);

        GetFeedbackCall call = new GetFeedbackCall(apiContext);
        call.UserID = "abc";

        Console.WriteLine(call.GetFeedback().ToString());
        Console.ReadKey();
    }

    static ApiContext GetApiContext()
    {

        if (apiContext != null)
        {
            return apiContext;
        }
        else
        {
            apiContext = new ApiContext();

            apiContext.SoapApiServerUrl = ConfigurationManager.AppSettings["Environment.ApiServerUrl"];
            ApiCredential apiCredential = new ApiCredential();
            apiCredential.eBayToken = ConfigurationManager.AppSettings["UserAccount.ApiToken"];
            apiContext.ApiCredential = apiCredential;

            apiContext.Site = SiteCodeType.US;

            return apiContext;
        }
    }
}
} 
```

它在控制台中打印以下行

> eBay.Service.Core.Soap.FeedbackDetailTypeCollection

如何获取原始数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:41:37.277

call.GetFeedback() 返回 FeedbackDetailType 成员的集合，因此您可以使用 foreach 检索有关所有特定反馈的信息（例如反馈分数和其他内容）。

[在此处](http://developer.ebay.com/DevZone/WindowsSDK/docs/LibRef/eBay.Service.Core.Soap.FeedbackDetailTypeMembers.html "完整列表")查看 FeedbackDetailType 成员的完整成员列表 ！

例如

```
foreach (FeedbackDetailType feedback in call.GetFeedback())
{
       Console.WriteLine(feedback.CommentText);
       //and other stuff
} 
```

或者你可以使用类似的东西

```
 call.GetFeedback();
    Console.WriteLine(call.FeedbackScore); 
```

# javascript - 比较用 ASP 编写的 html 实体和 JS 读取的 html 实体

> ID：13790723
> 
> 赞同：1
> 
> 时间：2012-12-09T19:06:31.327
> 
> 标签：javascript, jquery, html, ajax, entities

我有几个不同的 html 字符串通过 ASP.NET 写入 DOM 并存储在会话中。这些字符串包含 html 实体，如“ `&nbsp;`”和“ `&minus;`”。

我使用 .html() 来获取由 asp 打印的 html，然后使用 AJAX 在后台将 html 发布到另一个 asp 文档，在该文档中我尝试将会话中的 html 与 JS 在编写后抓取的 html 进行比较。

我的问题是，当它们进行比较时，来自 JS 的字符串将显示为“- blah”，而 asp 会话显然显示为“ `&minus;&nbsp;blah`”。我怎样才能让 JS 匹配 asp 或其他方式？

我尝试使用 Server.HTMLEncode(session("name")) 来获取大多数字符串匹配，但将 ' `&`' 上的 ' `&minus;`' 更改为 ' `&amp;minus;`'。

任何帮助将不胜感激！提前致谢。

这是显示代码的小提琴。JS小提琴不运行asp。 [http://jsfiddle.net/JnKaT/3/](http://jsfiddle.net/JnKaT/3/)

jQuery

```
$('#submit').click(function(st) {       

    $('input[type=radio]:checked').each(function(rc) {
        var userAns =  $(this).parent().next('td').html();

        console.log(userAns);

        $.ajax({
            cache: false,
            type: "POST",
            data: userAns,
            url: "/beta/includes/answerCheck.asp",
            success: function(msg) {
                console.log(msg+" ");
            },
            error: function(err) {
                console.log(err.responseText);                
            }
        });

    });

    return false;
    st.preventDefault();
});​ 
```

ASP

```
<!-- creating dynamic session name for html string -->
<%
for j = 1 to itemCount
sessionName = "correctAns"&(j)
session(sessionName) = session("d1")

response.write("<div class='qans'>"&session(sessionName)&"</div>")

next
%>

<!-- asp used by AJAX to compare the session to the js string -->

<%
userAns = request.form()

    corSessionName = "correctAns"&(qn)
    userSessionName = "userAns"&(qn)

        if userAns = session(corSessionName) then
            response.write("correct! ")

            response.write("ASP:"&session(corSessionName))
            response.write(" ,user:"&userAns)
        end if

        if userAns <> session(corSessionName) then 
            session(userSessionName) = userAns

            response.write("incorrect :( ")

            response.write("ASP:"&session(corSessionName))
            response.write(" ,user:"&userAns)
        end if  
%> 
```

按钮

```
<button id="submit" name="Check my answers!!" align="left">Check my answers!</button>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T21:10:19.473

正如 Sime Vidas 所说，我无法从 DOM 中获取 HTML 实体，因此为了解决我的问题，我在 asp 会话中解码了 html 字符串以使其与 DOM 上的 html 匹配

```
Dim I
tempAns = Replace(tempAns, "&quot;", Chr(34))
tempAns = Replace(tempAns, "&lt;"  , Chr(60))
tempAns = Replace(tempAns, "&gt;"  , Chr(62))
tempAns = Replace(tempAns, "&amp;" , Chr(38))
tempAns = Replace(tempAns, "&nbsp;", " ")

For I = 1 to 255
    tempAns = Replace(tempAns, "&#" & I & ";", Chr(I))
Next

session(sessionName) = tempAns 
```

# java - Json中getString()和optString()的区别

> ID：13790726
> 
> 赞同：80
> 
> 时间：2012-12-09T19:06:45.367
> 
> 标签：java, json, org.json

`getString()`JSON和JSON有什么区别`optString()`？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2012-12-09T19:14:48.383

正如 Diego 所提到的，在此处发布问题之前检查[文档](http://www.json.org/javadoc/org/json/JSONObject.html#optString%28java.lang.String%29)（此链接现已过时 - 还好我们有[Wayback Machine！](https://web.archive.org/web/20150101212410/http://www.json.org/javadoc/org/json/JSONObject.html#optString(java.lang.String))）是个好主意，但现在您有：

不同之处在于，如果您指定的键不存在，则`optString`返回空字符串 ( )。另一方面抛出一个. 如果数据丢失是错误的，或者如果您不确定它是否会存在，请使用。`""``getString``JSONException``getString``optString`

编辑：文档中的完整描述：

> 获取与键关联的可选字符串。如果没有这样的键，它会返回一个空字符串。如果值不是字符串且不为空，则将其转换为字符串。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-08-09T08:31:08.267

如果你想避免`NullPointerException`你最好利用`optString()`

如果您`JSON`在任何时候获取数据，您可能会有`null`特定 Key 值的数据，此时与其实现 Null 条件，不如利用此优化方法`optString("<keyname>")`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-03T06:31:24.193

public java.lang.String optString(int index) 获取与索引关联的可选字符串值。如果该索引处没有值，则返回一个空字符串。如果该值不是字符串且不为空，则将其转换为字符串。参数： index - 索引必须介于 0 和 length() - 1 之间。返回：一个字符串值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-09T06:30:34.273

> optString() 用于克服 NullPointerException，当所需的键在 json 中不存在时，我们在使用 getString() 时得到它，它基本上替换为默认值。

示例让输入 Json 为

```
{
"name":"abhi",
"country":"india"
} 
```

现在在 java 中执行

```
String city = json.getString("city"); 
```

它会抛出一个`NullPointerException`.

通过使用`optString(String key, String default)`我们可以克服上述问题。

```
String city= json.optString("city","default");

System.out.println(city); 
```

**输出：默认**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-09T05:33:34.470

1) **getString(String name):-**如果存在，则返回按名称映射的字符串值，必要时强制转换，如果不存在这样的映射，则**抛出 JSONException**。

2) **optString (String name)：-**如果存在，则返回按名称映射的字符串值，必要时强制它，如果不存在这样的映射，则返回**空字符串（“”）**。

# jquery - iframe 在 Firefox 中不起作用

> ID：13790728
> 
> 赞同：0
> 
> 时间：2012-12-09T19:07:04.657
> 
> 标签：jquery, firefox, iframe

请查看我的网站[inpages.nl](http://inpages.nl/)

如果您转到“weer”一词并单击它，则会显示一个包含某种天气图的 iframe。问题是它没有在 Firefox 中显示天气图。我用谷歌搜索它，似乎 Firefox 确实存在显示 iframe 的问题。然而奇怪的是它确实显示了 iframe，它只是一个没有显示的（动态）天气图。如果我将 iframe 与 click 事件隔离并在页面加载时显示它，那么一切似乎都可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:54:51.390

在 Firefox 和 chrome 中检查您的 html 后，看起来有问题，不是在您的脚本中，而是在您在 iframe 中打开的页面中（但不要担心，我找到了可能的解决方法）。

**首先，这是问题所在**：使用 Chrome 的检查器和 Firefox 的 firebug，您会看到 iframe 指向 `http://www.weeronline.nl/Go/ExternalWidgetsNew/RainAnd2DaysCity?gid=4057473&temperatureScale=Celsius&defaultSettings=False`，在该网页内还有另一个 iframe 指向`http://www.weeronline.nl/Go/ExternalWidgetsNew/RainWidgetContent?gid=4057473&sizeType=1`（两个浏览器中的两个地址都相同）。

在那个内部 iframe 中有一个名为 的 div `radar-container`，它的 css 有一个`.image-rotator-container`已设置的选择器`display:none;`。在谷歌浏览器中，div 包含一个内联样式`display:block`（和一个背景图像）。但在 Firefox 中，div 没有`display:block`（只有背景图像）。所以，问题是 teir 脚本没有“显示”地图的 div。

**好消息：**看起来如果你“手动”重新加载 iframe（我是通过使用 firebug 向 url 添加一个假参数来做到的：）`http://www.weeronline.nl/Go/ExternalWidgetsNew/RainWidgetContent?gid=4057473&sizeType=1&foo`你可以看到地图。因此，您可以在页面加载时让 iframe 的 url 为空，然后 (on `$(document).ready()`) 设置 url。

旁注：您的网页无法`http://inpages.nl/jquery.nicescroll.min.js`从您的网站中找到很多图片。这与您的问题无关，但您应该看看。

# android - 在 RelativeLayout 中难以将 GridView 居中

> ID：13790729
> 
> 赞同：1
> 
> 时间：2012-12-09T19:07:31.760
> 
> 标签：android, gridview, android-relativelayout

小伙伴们怎么了，问个简单的问题。我试图让我的 GridView 在它的父级中居中，这是一个相对布局。我希望整个网格居中，而不是项目。据我所见，默认对齐方式是“左对齐”，很难改变这种行为。[我尝试了在此处](https://stackoverflow.com/questions/6141910/android-center-gridview-horizontally)找到的其他 SO 问题以及其他几个问题中建议的其他一些解决方案。这似乎是一件微不足道的事情，而且不应该如此令人头疼。我尝试将 GridView 包装在具有水平方向的 LinearLayout 中，但无济于事。

我发现的唯一半解决方法是弄乱左右填充，但即使这种方法在侧面留下了太多的空白空间。

此图像是在我更改填充之前 ![前](../Images/0cb189458ce8feaf06607a0efffa95d4.png)

这张图片是在我弄乱了填充之后，但又一次......似乎有点骇人听闻，并不是我真正想要的。我正在寻找没有侧面额外填充物的齐平中心

![后](../Images/e04d65ce1be3685d46d67631487e8039.png)

这种方法不切实际的另一个原因是由于额外的空间，选择器似乎太大了..如下图所示

![在此处输入图像描述](../Images/52b5a9dbcefd2c00f0fcfb2c06ace599.png)

对此的任何帮助都会很棒，一如既往地感谢！

布局代码

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/weatherFragRoot"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<GridView
    android:id="@+id/menuGridView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="10dp"
    android:background="@drawable/weathermate_lv_background"
    android:gravity="center_horizontal"
    android:listSelector="@drawable/list_selector"
    android:numColumns="3"
    android:paddingLeft="30dp"
    android:paddingRight="5dp"
    android:stretchMode="columnWidth"
    android:visibility="invisible" >
</GridView>

</RelativeLayout> 
```

编辑

根据用户的建议，我将每个网格项目行置于它自己的相对布局中......这给了我想要的结果！这是反映解决方案的更新的 XML 文件

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/weatherFragRoot"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:orientation="horizontal" >

<GridView
    android:id="@+id/menuGridView"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="10dp"
    android:background="@drawable/weathermate_lv_background"
    android:gravity="center_horizontal"
    android:listSelector="@drawable/list_selector"
    android:numColumns="3"
    android:stretchMode="columnWidth"
    android:visibility="invisible" >
</GridView>

</RelativeLayout> 
```

这是网格行的布局。如您所见，对我有用的是将方向设置为水平并将 android:layout_centerHorizo​​ntal="true" 添加到每个孩子。

```
 <?xml version="1.0" encoding="utf-8"?> 
```

```
<ImageView
    android:id="@+id/menuItem"
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:layout_centerHorizontal="true"
    android:background="@android:drawable/ic_menu_add" >
</ImageView>

<TextView
    android:id="@+id/tvMenuItemName"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@id/menuItem"
    android:layout_centerHorizontal="true"
    android:text="Option"
    android:textColor="@android:color/white" >
</TextView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:31:39.533

答案是将每个网格中的图像和文本视图居中，因为它们具有单独的布局:)

# iphone - Objective c iOS，从文本框中读取？

> ID：13790733
> 
> 赞同：0
> 
> 时间：2012-12-09T19:07:38.953
> 
> 标签：iphone, objective-c, ios, ios5, ios6

我是目标 c 的新手，我在玩标签按钮和文本框，我有一个标签、文本框和两个按钮（添加、清除），

我想要做的是，在文本框中写一些东西，当按下“添加”按钮时，我希望文本出现在标签上，清除按钮应该清除标签和文本框

我已经运行了程序并且构建成功但是当我写一些文本并按下返回按钮时没有任何反应，虚拟键盘仍然停留在那里并且文本没有出现在标签上，我的代码如下：

在 .h 文件中

```
@interface ViewController : UIViewController
@property (retain, nonatomic) IBOutlet UILabel *label;
@property (retain, nonatomic) IBOutlet UITextField *txtbox;
@property (retain, nonatomic) IBOutlet UIButton *btnadd;
@property (retain, nonatomic) IBOutlet UIButton *btnclear;

- (IBAction)btnadd:(id)sender;
- (IBAction)btnclear:(id)sender;
- (IBAction)txtbox:(id)sender; 
```

在 .m 文件中

```
@implementation ViewController
@synthesize label,txtbox,btnadd,btnclear;
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)dealloc {
    [label release];
    [txtbox release];
    [btnadd release];
    [btnclear release];
    [super dealloc];
}
- (IBAction)btnadd:(id)sender {

    label.text = (txtbox.text);

}

- (IBAction)btnclear:(id)sender {
    txtbox.text=@"";
    label.text=@"";
}

- (IBAction)txtbox:(id)sender {
}
@end 
```

如果有人提供帮助，我将不胜感激，在此先感谢

Ps：如果我添加退出按钮，结束程序的代码是什么？

再次感谢，

阿西姆·贡杜兹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:31:15.133

代码看起来不错，但你可以试试这些教程，

[链接 IBOutlet 和 IBAction](http://www.techotopia.com/index.php/Creating_an_Interactive_iOS_5_iPad_App)

[隐藏键盘](http://www.techotopia.com/index.php/Writing_iOS_5_Code_to_Hide_the_iPad_Keyboard)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:18:18.463

您是否正确链接了 .xib/storyboard 中的所有内容？

阅读[本文](https://stackoverflow.com/questions/274319/how-do-you-dismiss-the-keyboard-when-editing-a-uitextfield)，了解如何正确处理返回键。

您不应该使用按钮退出应用程序。关闭应用程序的唯一方法应该是按下主页按钮。但是，您可以使用

```
exit(0); 
```

# php - PHP _POST 解析代码的位置

> ID：13790736
> 
> 赞同：5
> 
> 时间：2012-12-09T19:07:49.573
> 
> 标签：php

有谁知道我在哪里可以找到 PHP 用来将发布数据解析为`$_POST`and的代码`$_FILES`？我试图弄清楚它如何处理未转义的文件名，但我似乎找不到它。这是一个巨大的项目，我什至不知道在哪里看，搜索也无济于事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:19:44.743

它在`main/rfc1867.c`。查看 inside `rfc1867_post_handler`，它解析 Content-Disposition 标头的位置。该函数用于`php_ap_getword_conf`解析文件名值。

# javascript - 使用 JavaScript 向图像添加 JavaScript 事件

> ID：13790742
> 
> 赞同：2
> 
> 时间：2012-12-09T19:08:37.600
> 
> 标签：javascript, html, dynamic, image

好的，所以我将尝试尽可能清楚地说明这一点。我想编写一个函数，调用时会`onmouseout`为图像添加一个属性。

在图像被鼠标悬停之前。

```
<img src="myfile.jpg" onmouseover="function()" /> 
```

后

```
<img src="myfile.jpg" onmouseover="function()" onmouseout="anotherFunction()" /> 
```

我也想用`function()`onmouseout把图片改回原图。我知道如何在图像代码中使用 onmouseover 和 onmouseout 更改图片，但我试图简化这一点，因为我必须做 100 次左右的图像更改，而且我不想多次写出代码。啊，我希望这很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:12:52.337

这比你想象的要简单：

```
function SetImageSource(ele, url) {
    ele.src = url;
}

<img src="myfile.jpg" 
     onmouseover="SetImageSource(this, 'someURL')"
     onmouseout="SetImageSource(this, 'someOtherURL')" /> 
```

**注意：**内联 JavaScript 并不理想。我建议阅读 JS 中的事件处理。更具体地说，阅读有关附加到事件的信息。

**根据说明进行编辑**

```
<img id="imgMyImage" src="myfile.jpg" 
     onmouseover="SetImageSource(this, 'someURL')"
     onmouseout="SetImageSource(this, 'someOtherURL')" />

function AddEvent(html_element, event_name, event_function) 
{       
   if(html_element.attachEvent) //Internet Explorer
      html_element.attachEvent("on" + event_name, function() {event_function.call(html_element);}); 
   else if(html_element.addEventListener) // Everything else
      html_element.addEventListener(event_name, event_function, false);
}

AddEvent(document.getElementById('imgMyImage'),
                                 'onmouseover',
                                 // do something
                                 ); 
```

**附加信息**

参见[`.addEventListener()`MDN](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener)

见[`.attachEvent()`MSDN](http://msdn.microsoft.com/en-us/library/ie/ms536343%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:58:09.487

我们去[http://jsfiddle.net/5U9w9/2/](http://jsfiddle.net/5U9w9/2/)

我将使用更多评论更新 jsFidle，并将在此处更新链接。

**javascript**

```
// grab all the required element on the page
var img_all = document.getElementsByTagName('img');

// for every element do this
for (i=0; i< img_all.length; i++){
    var img = img_all[i];
    // set the required event on the element
    // when the event of the element occurs, the associated function will be called with event object as it's argument.
    // https://developer.mozilla.org/en-US/docs/Mozilla_event_reference
    //img.addEventListener('mouseover', mouseover_handler, false);
    AddEvent(img, 'mouseover', mouseover_handler) 

    //mouseout_handler will be called, on mouseout event
    // img.addEventListener('mouseout', mouseout_handler, false);
    AddEvent(img, 'mouseout', mouseout_handler)
}

function mouseover_handler(e){
    // el is and event object and has various properties like clientX, clientY, srcElement, etc. you can check them by console.log(el)
    console.log(e)

    // to get the element i'm hovering, use
    var element = e.srcElement;

    //element is DOM element and can be manupulated
    element.style.width="100px";
}

// similarly handler for an another event.
function mouseout_handler(e){
    e.srcElement.style.width="50px";
}

​// cross-browser addEventListner
function AddEvent(html_element, event_name, event_function) 
{       
   if(html_element.attachEvent) //Internet Explorer
      html_element.attachEvent("on" + event_name, function() {event_function.call(html_element);}); 
   else if(html_element.addEventListener) // Everything else
      html_element.addEventListener(event_name, event_function, false);
} 
```

**更新**

*   `AddEvent`代替`addEventListner()`IE 支持使用。（信用：@James Hill 的回答）

# objective-c - 在运行时修改对象类型

> ID：13790743
> 
> 赞同：1
> 
> 时间：2012-12-09T19:08:54.033
> 
> 标签：objective-c

在 Objective C 中是否可以在运行时修改对象类型而编译器不会抱怨？

例如

```
id object; 
```

在初始化方法中

```
initWithType:(someEnumType) type 
```

然后根据类型将对象设置为类类型。

如果没有编译器标记对象未声明 someMethod 的错误，如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:25:45.377

最常见的方法是在*工厂方法*中，而不是在初始化器中：

```
typedef enum {
    etString,
    etNumber
} EnumType;

@implementation MyFactory

+(id)makeNewObjectWithType:(EnumType)et {
    id res;
    switch (et) {
        case etString:
            res = [NSString string];
            break;
        case etNumber:
            res = [NSNumber numberWithInt:12345];
            break;
        default:
            res = nil;
            break;
    }
    return res;
}

@end 
```

# objective-c - 没有信息传递给 DetailView Objective-c

> ID：13790745
> 
> 赞同：1
> 
> 时间：2012-12-09T19:09:08.480
> 
> 标签：objective-c, null, uisplitviewcontroller

我的问题 - 我想从 DetailView 中的 TableView 传递信息，但在**self.detailViewController.detailItem**的某处没有传递任何值。

那是：

```
self.detailViewController.detailItem =@"123";

NSString *sss = self.detailViewController.detailItem;

NSLog(@"%@",  sss); 
```

在 NSLog 输出中（空）

这是我的源代码：

**DetailViewController.h**

```
#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController <UISplitViewControllerDelegate>

@property id detailItem;
@property id TitleOfDetail;

@property (weak, nonatomic) IBOutlet UILabel *detailDescriptionLabel;

@end 
```

**细节视图控制器.m**

```
#import "DetailViewController.h"

@interface DetailViewController ()
@property (strong, nonatomic) UIPopoverController *masterPopoverController;
- (void)configureView;
@end

@implementation DetailViewController

#pragma mark - Managing the detail item

-(void)setTitleOfDetail:(id)newTitleOfDetail {

    NSLog(@"123");

    if (_TitleOfDetail != newTitleOfDetail) {
        _TitleOfDetail = newTitleOfDetail;
        // Update the view.
        [self configureView];
    }
}

-(void)setDetailItem:(id)newDetailItem
{
    NSLog(@"123");

    if (_detailItem != newDetailItem) {
        _detailItem = newDetailItem;

        // Update the view.
        [self configureView];
    }

    if (self.masterPopoverController != nil) {
        self.title = self.TitleOfDetail;
        [self.masterPopoverController dismissPopoverAnimated:YES];
    }        
}

- (void)configureView
{
    // Update the user interface for the detail item.

    NSLog(@"1%@", self.TitleOfDetail);
    NSLog(@"2%@", [self.detailItem description]);

    if (self.TitleOfDetail) {
        self.title = self.TitleOfDetail;
    }

    if (self.detailItem) {
        self.detailDescriptionLabel.text = [self.detailItem description];
    }
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self configureView];
}
… 
```

**我的班级.h**

```
@class DetailViewController;

@interface myclass : UITableViewController 

@property DetailViewController *detailViewController;

@end 
```

**我的班级.m**

```
#import "choiseAvtoController.h"
#import "DetailViewController.h"

@interface myclass ()
@end

@implementation myclass

@synthesize detailViewController;

…

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    self.detailViewController.detailItem =@"123";

NSString *sss = self.detailViewController.detailItem;

NSLog(@"%@",  sss);
} 
```

可能是什么问题以及如何解决？

PS对不起我的英语，我只是在学习））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:32:07.290

由于您使用的是故事板，因此您应该在 segue 上打开细节控制器。

在故事板中查找 segue 标识符（例如，它是`OpenDetail`），然后将以下代码添加到您的初始控制器：

```
-(void)prepareForSegue:(UIStoryboardPopoverSegue*)segue sender:(id)sender {
    if ([segue.identifier isEqualToString:@"OpenDetail"]) {
        DetailViewController *dest = segue.destinationViewController;
        dest.detailItem =@"123";
    }
} 
```

# svg - 平滑重叠的笔划边缘

> ID：13790748
> 
> 赞同：0
> 
> 时间：2012-12-09T19:09:18.763
> 
> 标签：svg, raphael

我正在使用 Raphael 绘制弧线，如下图所示：
![SVG 用于绘制 3 条弧线](../Images/4e915b00cc50b4cb3725084bc957c3d3.png)

Z-index 的顺序是从低到高：灰色、蓝色、绿色。灰色和蓝色弧线都从顶部开始，绿色弧线从顶部开始。

有什么方法可以改善边缘吗？尤其是蓝色的绿色。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-11T05:56:24.867

问题是您正在重叠形状。这会导致一些颜色从下面溢出。要解决这个问题，您需要在前一个结束的地方开始每个弧。

您可能会得到非常微弱的间隙，这可以通过对每个弧线应用 1px 笔划轻松解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:26:31.000

恐怕你无能为力。如何呈现形状取决于查看器（浏览器、图像查看器或导入应用程序）。您可以使用[渲染属性](http://www.w3.org/TR/SVG/painting.html#RenderingProperties)，看看这是否会给您带来改进，但我相信几乎没有任何 SVG 实现支持它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T19:30:09.703

我不确定你的意思，而且如果没有 raphael 代码，很难知道你是如何制作图像的。您是在谈论绿色弧的外边缘略微超出蓝色弧的外边缘的方式吗？我会检查两条路径的角点是否相同，并在路径计算中包括笔画宽度。

也许您可以尝试将笔画宽度减小到 0 以使事情变得更容易。

# javascript - Javascript；列出所有同源窗口/选项卡

> ID：13790750
> 
> 赞同：0
> 
> 时间：2012-12-09T19:10:02.157
> 
> 标签：javascript, google-chrome, web-applications, webkit, chromium

目标是让一个窗口/选项卡具有其具有相同域的兄弟窗口/选项卡的列表。

我第一次尝试 SharedWorker 失败了，请参阅[JavaScript: How to know if a connection with a shared worker is still alive?](https://stackoverflow.com/questions/13662089/javascript-how-to-know-if-a-connection-with-a-shared-worker-is-still-alive)

仅 Webkit 的解决方案就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:13:26.303

您可以使用 localStorage，它是每个域的。让选项卡使用一些唯一 ID 作为 localStorage 键注册自己，并在卸载时删除该条目。

# azure - Azure 数据库的密码重置

> ID：13790752
> 
> 赞同：106
> 
> 时间：2012-12-09T19:10:05.997
> 
> 标签：azure, azure-sql-database

我有一个新的 Azure 帐户。我能够以管理员身份登录“管理”页面，但我忘记了其中一个数据库的密码。我想在那个数据库上重置密码。我怎么做？微软似乎没有这方面的知识库——至少我找不到。谢谢。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2012-12-10T01:48:22.053

如果您指的是特定 Windows Azure SQL 数据库*服务器*的管理密码，您可以从新门户中执行此操作。选择左侧的 Database 选项，然后选择 Servers：

![在此处输入图像描述](../Images/58aa311aaea87e54db929013050421cf.png)

然后，选择服务器后，您将在右侧看到重置管理员密码的选项：

![在此处输入图像描述](../Images/74832958f78933b309970567857e28d5.png)

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2015-06-11T18:15:43.393

使用新的 Azure 门户： [https ://portal.azure.com](https://portal.azure.com)

1.  点击浏览（查看所有资源）

[![资源清单](../Images/f0fb5fb978fe63227daf4c16039c9139.png)](https://i.stack.imgur.com/yVTL9.png)

2.  选择 SQL 数据库

3.  选择您要更改凭据的服务器中的数据库。

4.  选择该选定数据库的服务器名称 url。这应该会打开服务器配置刀片。

5.  重置密码是左起第二个按钮。

[![对于选定的数据库](../Images/92829ccc9566b4fc94f1717a74f928cb.png)](https://i.stack.imgur.com/rzsWJ.png)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2016-08-29T21:20:45.237

新 Azure 门户的另一个变体（绕过数据库），#1[直接访问 SQL 服务器](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Sql%2Fservers)；#2 点击要更新密码的数据库服务器，#3 点击铅笔，#4 更新密码，确认并保存。

[![在此处输入图像描述](../Images/5674e6b1d921b7e5dfe5c16591bff5b2.png)](https://i.stack.imgur.com/g8hJG.png)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-07-02T18:03:56.703

要重置 SQL 数据库服务器的管理员密码，请使用以下步骤：

1.  转到位于[http://manage.windowsazure.com](http://manage.windowsazure.com)的 Windows Azure 管理门户，然后单击左侧导航窗格中的 SQL 数据库。
2.  单击 SQL 数据库工作区顶部的服务器选项卡。这将启动服务器列表视图。
3.  在服务器列表视图中，单击要更新的服务器的名称。这将启动服务器仪表板。
4.  在服务器仪表板上，单击工作区右侧快速浏览任务下的重置管理员密码。
5.  在“重置密码”对话框中，指定新密码，然后确认新密码。
6.  要完成操作，请单击右下角的复选标记按钮。您将返回到服务器的服务器仪表板。

如果在服务器上存在与数据库的活动连接期间重置 SQL 数据库服务器密码，则可能需要使用 KILL 语句来终止用户会话。这将强制客户端连接刷新它们与数据库和主机服务器的会话。有关详细信息，请参阅 KILL（Windows Azure SQL 数据库）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-12-07T00:00:16.230

对于接口的当前迭代，该过程类似于上面描述的过程，但多了一个步骤：

1.  如上所述进入概述。
2.  新：单击服务器名称（我只是偶然发现它。糟糕的 UI 设计。）
3.  现在有一个选项可以重置密码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-09T23:58:33.333

您实际上可以使用旧的/以前的 Silverlight 门户将您的管理员密码重置到您的 SQL 数据库。

1.  登录[https://windows.azure.com/](https://windows.azure.com/)或当前登录并从您的登录中选择“上一个门户”

2.  在上一个门户中单击左下角的“数据库”菜单项

3.  从订阅中选择数据库

4.  点击“重置密码”

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-05-22T22:04:19.990

您可以在 Azure CLI 2.0 中使用以下命令来更改/重置 Azure SQL 数据库的密码：

```
az sql server update -n {database server name}
    -g {resource group name}
    -p {password} 
```

来源：[https ://buildazure.com/2017/05/18/azure-cli-2-0-reset-azure-sql-database-password/](https://buildazure.com/2017/05/18/azure-cli-2-0-reset-azure-sql-database-password/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-13T04:49:30.007

新门户更新：

转到托管 SQL DB 的 SQL 服务器，然后单击“重置密码”。

[![在此处输入图像描述](../Images/3ba7600d7dbe9c9107c2dc09cf24b50a.png)](https://i.stack.imgur.com/8jzB2.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-01-27T12:51:55.887

如果有人忘记了他的 DB 密码，首先，查看连接字符串（appsettings.json）。你会在那里找到它。

# android - Android：单击按钮时如何显示TextView？

> ID：13790753
> 
> 赞同：2
> 
> 时间：2012-12-09T19:10:19.153
> 
> 标签：android, textview, visibility

我目前已经设置好了，所以有几个 TextViews：

*   单击一个按钮时其中一个会更新，单击另一个按钮时不会更改它。

*   其他 TextViews 显示一个数字，我希望在单击任一按钮时更改它们，但目前所有 TextViews 都是可见的并且数字没有改变。

我希望其他 TextViews（下面的 num1-num3）最初是不可见的，然后当用户单击其中一个按钮时，TextViews 变得可见，并且它们的值由我编写的方法更新。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_name);
    num1 = randNum();
    num1 = alterNum(num1);      
    num1View = (TextView) findViewById(R.id.number1); 
    num1View.setText("Num1 Number: " + String.valueOf(num1));

    num2 = randNum();
    num2 = alterNum(num2);
    num2View = (TextView) findViewById(R.id.number2); 
    num2View.setText("Num2 Number: " + String.valueOf(num2));

    num3 = randNum();
    num3 = alterNum(num3);
    num3View = (TextView) findViewById(R.id.number3); 
    num3View.setText("Num3 Number: " + String.valueOf(num3));

    // This one is always visible, the ones above should be invisible
    // and appear onClick
    currentNum = randNum();
    myTextView = (TextView) findViewById(R.id.current_number); 
    myTextView.setText("Current Number: " + String.valueOf(currentNum));
    okButton = (Button) findViewById(R.id.ok_button);
    okButton.setOnClickListener(this);
    changeButton = (Button) findViewById(R.id.change_button);
    changeButton.setOnClickListener(this);
} 
```

我的点击：

```
@Override
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.num_confirmation:
        //do nothing
        // do not let user hit buttons more than once (either case)
        changeButton.setEnabled(false);
        okButton.setEnabled(false);
        break;
    case R.id.swap_button:
        currentNum = alterNum();
        myTextView.setText("Current Number: " + String.valueOf(currentNum));
        // do not let user hit buttons more than once (either case)
        swapButton.setEnabled(false);
        okButton.setEnabled(false);
        break;
    default:
        break;
    }
} 
```

这是怎么做到的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T19:16:01.147

set the initial value of "visible" to "invisible" in your xml layout file for textViews that should be invisible and in your onClick method alter its text valie and change visibility:

```
 myTextView.setVisibility(View.VISIBLE); 
```

here is similar question that should help: [How to change visibility of layout programaticly](https://stackoverflow.com/questions/3465841/how-to-change-visibility-of-layout-programaticly)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:14:54.983

```
yourTextView.setVisibility(View.VISIBLE); 
```

这使您的文本视图可见。

```
yourTextView.setVisibility(View.INVISIBLE); 
```

这使您的 textview 不可见，但保留布局。

```
yourTextView.setVisibility(View.GONE); 
```

This removes it so other Views can rearrange. You can still call View.VISIBLE to make it appear again.

So for example you could put this after you define the TextView (findviewbyid)

```
 num1View.setVisibility(View.INVISIBLE); 
```

Then where you want it to come back:

```
num1View.setVisibility(View.VISIBLE); 
```

# javascript - jQuery each: 分别运行每一个 li 集合

> ID：13790754
> 
> 赞同：1
> 
> 时间：2012-12-09T19:10:22.663
> 
> 标签：javascript, jquery, loops, each

我什至不知道如何解释我的问题——这就是奇怪的标题的来源。我有一个`ul`包装另一个`ul`像下面的样品。

```
<ul class="event-items">
   <li class="year 2012"></li>
   <li class="year 2011"></li>
   <li class="year 2010">
      <ul>
         <li></li>
         <li></li>
         <li></li>
      </ul>
   </li>
<li class="year 2010"></li>
… 
```

![在此处输入图像描述](../Images/15e8d305c84a0976499b418880f68022.png)

所以每个`li.year`人都有另一个`<ul>`里面有多个孩子。

**现在我的问题：**

我想知道我如何才能`each` `li.year`单独完成。

现在我正在这样做……</p>

```
$('ul.event-items li.year ul li').each(function(i) {
    if ( i % 4 == 0 ) $(this).addClass('clearLeft');
}); 
```

但是，此`each`循环通过 ALL 运行`<li>`。我想知道如何单独运行每个`li:year li`。听起来很奇怪吧？

所以我实际上想单独循环遍历每一个，`li.year`以便我的`i`计数总是在每个内部重新开始`li.year`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T19:13:44.997

使用嵌套循环分别迭代每个内部的孩子`ul`：

```
$('ul.event-items li.year ul').each(function() {
    $("li", this).each(function(i) {
        if (i % 4 == 0) 
            $(this).addClass('clearLeft');
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:14:04.343

你是这个意思吗？

```
$('ul.event-items li.year').each(function(i) {
    if ( i % 4 == 0 ) $(this).find('ul li').addClass('clearLeft');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:23:51.050

或者，您也可以使用[`.index()`](http://api.jquery.com/index/).

```
$('ul.event-items li.year ul li').each(function() {
  var $this = $(this);
  if ( $this.index() % 4 == 0 ) $this.addClass('clearLeft');
}); 
```

`.index()`将返回每个`li`相对于其父级的索引，`ul`.

# sql - Rails：与 GROUP BY 结合使用时不会出现 SQL SELECT 语句

> ID：13790755
> 
> 赞同：0
> 
> 时间：2012-12-09T19:10:26.293
> 
> 标签：sql, ruby-on-rails

我在 Ruby 中有以下代码：

```
Comment.select("comments.*, COALESCE(SUM(votes.value), 0) AS rating,
  user_votes.value AS user_value").
  joins("LEFT JOIN votes ON votes.voteable_type = '"+type+"' AND votes.voteable_id = comments.id").
  joins("LEFT JOIN votes AS user_votes ON user_votes.voteable_type = '"+type+"' AND user_votes.voteable_id = comments.id AND user_votes.user_id = #{user_id}").
  where(conditions).group("comments.id").order("comments."+method).limit(limit).offset(offset) 
```

当 Rails 生成这个 SQL 查询时，它不包括完整的 select 语句：

```
SELECT COUNT(*) AS count_all, comments.id AS comments_id FROM `comments`
LEFT JOIN votes ON votes.voteable_type = 'reply' AND votes.voteable_id = comments.id 
LEFT JOIN votes AS user_votes ON user_votes.voteable_type = 'reply' AND 
user_votes.voteable_id = comments.id AND user_votes.user_id = 1 WHERE (commentable_id = 
1 AND commentable_type = 'Impression')
GROUP BY comments.id ORDER BY comments.rating DESC LIMIT 10 OFFSET 0 
```

但是，如果我删除了 group 语句，那么它会正确地包含完整的 select 语句。这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-08T22:18:00.010

select comments.* 在您的 select 语句中与 group by("comments.id") 冲突。

选择的每一列必须要么在 GROUP BY 子句中，要么包含在聚合函数中。

SQL Server 显示 SQL 错误：select c.* from tt_country c group by c.name

列“tt_country.country_id”在选择列表中无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。

ActiveRecord 和 arel 抛出指定的选择，因为它不明确/无效。

# ruby - 对多个数字范围的匹配响应

> ID：13790759
> 
> 赞同：0
> 
> 时间：2012-12-09T19:10:42.563
> 
> 标签：ruby, functional-programming, logic

我有一个方法可以返回 1 - 100 之间的数字

取决于响应 (x) 是否在 100 - 90 之间，我想要一个响应，89 - 85 另一个 84 - 72 另一个......等等

我用

```
if x > 90
 response a
elsif x > 85
 response b
elsif etc... 
```

但这似乎有点混乱，有没有更好的重构方法？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T19:29:45.867

利用[`Range#===`](http://ruby-doc.org/core-1.9.3/Range.html#method-i-3D-3D-3D)并使用`case`语句：

```
case x
when 72..84
  # Do something
when 85..89
  # Do something
when 90..100
  # Do something
else
  # Do something when no matches
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T19:26:09.633

您可以尝试一个表（a `Hash`），其中键是范围，值是您要返回的数字：

```
T = { 
  (90..100) => 1,
  (85..89) => 2,
  # and so on
}

(r,v) = T.find {|r,v| r.member? x}

if v then 
  return v
else
  # x wasn't in any of the defined ranges
end 
```

# regex - Bash RegEx 从用户输入中检查浮点数

> ID：13790763
> 
> 赞同：10
> 
> 时间：2012-12-09T19:11:24.497
> 
> 标签：regex, bash, expression, bash4

我对 bash 编程比较陌生，目前正在创建一个简单的计算器。

它需要使用浮点数并检查它们是否如此。

我有一个 checkNumbers 函数：

```
function checkNumber {

    regExp=[0-9]

    if [ $testNo =~ $regExp ]
    then
        echo "That is a number!"
        let check=1
    else
        echo "Damn! Not A Number!"
    fi
} 
```

我让用户输入这样的数字：

```
while [ $check -eq 0]
do
    echo "Please enter a number
    read testNo
    echo ""
    checkNumber
done 
```

这不起作用，我收到此错误：

> ./calculator.sh: 第 39 行: [: =~: 期望二元运算符

第 39 行是：

```
if [ $testNo =~ $regExp ] 
```

我尝试了很多正则表达式，例如：

```
^*[0-9]*$ 
```

和

```
^*[0-9]\.[0.9]*$ 
```

等等等等

此外，我还绑定了其他执行检查的方法：

```
case $testNo
in
    ^*[0-9]*$) echo "That is a number!";;
    *) echo "Error! Not a number!";;
esac 
```

和

```
if [ $testNo = ^*[0-9]*$ ]
then
    echo "etc etc"
else
    echo "oops"
fi 
```

我还需要它来处理浮点数。

有人可以让我知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-09T19:21:02.787

此正则表达式`^[-+]?[0-9]+\.?[0-9]*$`将仅匹配带有可选的数字`.`：

```
$ echo 30 | grep -Eq '^[-+]?[0-9]+\.?[0-9]*$' && echo Match
Match

$ echo 30.10 | grep -Eq '^[-+]?[0-9]+\.?[0-9]*$' && echo Match
Match

$ echo 30\. | grep -Eq '^[-+]?[0-9]+\.?[0-9]*$' && echo Match
Match

$ echo +30 | grep -Eq '^[-+]?[0-9]+\.?[0-9]*$' && echo Match
Match

$ echo -30 | grep -Eq '^[-+]?[0-9]+\.?[0-9]*$' && echo Match
Match 
```

我想当你尝试时`^*[0-9]`你想要`^[0-9]*`

解释：

```
^       # Match start of string
[-+]?   # Match a leading + or - (optional)
[0-9]+  # Match one or more digit
\.?     # Match a literal . (optional, escaped)
[0-9]*  # Match zero or more digits
$       # Match the end of the string 
```

注意：这匹配数字后跟一个`.`like `30.`，不确定这是否适合您。

编辑：不要引用`regex`

```
testNo=30.00

if [[ $testNo =~ ^[+-]?[0-9]+\.?[0-9]*$ ]]; then 
    echo Match
fi

>>> Match 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T19:20:20.040

要使用该类型的功能，您需要 `[[ ... ]]`条件的版本。`[`是“旧”`test`命令，根本不处理正则表达式。

```
#! /bin/bash
function checkNumber {
    regExp='^[+-]?([0-9]+\.?|[0-9]*\.[0-9]+)$'
    if [[ $testNo =~ $regExp ]]
    then
        echo "That is a number!"
        let check=1
    else
        echo "Damn! Not A Number!"
    fi
}
testNo=1
checkNumber
testNo=-1.2
checkNumber
testNo=+.2
checkNumber
testNo=+0.
checkNumber
testNo=a
checkNumber
testNo=hello2you
checkNumber

$ ./t.sh
That is a number!
That is a number!
That is a number!
That is a number!
Damn! Not A Number!
Damn! Not A Number! 
```

请参阅[test、[ 和 [[ 之间有什么区别？](http://mywiki.wooledge.org/BashFAQ/031).

关于正则表达式的解释：

```
^ Anchor at start of string
$ Anchor at end of string 
```

这两个使正则表达式匹配传递的整个字符串，不允许部分匹配。

```
[+-] 
```

匹配`+`或`-`。

```
[+-]? 
```

使该部分成为可选的，因此上面的内容完全匹配`+`，`-`或者根本不匹配。

然后有一个交替`(part1|part2)`匹配 if `part1`or`part2`匹配。

第一部分是：

```
[0-9]+\.? 
```

它匹配一个或多个 ( `+`) 数字（但不是零数字/空集）和一个可选的`.`. 这处理表单`123`和的数字`534.`。但不只是`.`。

第二部分是：

```
[0-9]*\.[0-9]+ 
```

这匹配零个或多个 ( `*`) 数字，后跟 a `.`，后跟一个或多个数字。这匹配所有其他浮点数，如`1.3`or `.543`（没有指数表示法），但仍然不包括`.`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-03T20:39:37.660

```
#!/bin/bash
#script to validate 

while [ true ]; do
clear
echo "Introduce the numeric value: "
read -r var
if [[ $var =~ ^[+-]?([0-9]+)$ ]]
   then
      echo "You introduced an integer value (without decimals)"
      read
   else
      if [[ $var =~ ^[+-]?([0-9]+\.)$ ]]
         then
            echo "Incomplete floating value (no values provided at the right of the point)"
            read
         else
            if [[ $var =~ ^[+-]?(\.[0-9]+)$ ]]
               then
                  echo "Incomplete floating value (no values provided at the left of the point)"
                  read
               else
                  if [[ $var =~ ^[+-]?([0-9]+\.[0-9]+)$ ]]
                     then
                        echo "You introduced a correct floating value"
                        read
                     else
                        echo "You introduced something other than a valid numeric value"
                        read
                  fi
            fi
      fi
fi
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-21T03:50:23.907

我在开头包含一个可选的点。

```
 user@debian:~$ testNo=.01
       user@debian:~$ if [[ $testNo =~ ^[+-]?[.]?[0-9]+\.?[0-9]*$ ]]; 
                    > then         
                    > echo Match; 
                    > fi
         Match 
```

# .net - IIS 上的 WCF 和由于访问控制列表错误而拒绝访问

> ID：13790766
> 
> 赞同：1
> 
> 时间：2012-12-09T19:12:05.023
> 
> 标签：.net, wcf, iis-7, ado.net

我正在编写使用 IIS 上托管的 WCF 服务应用程序的简单应用程序。一切都在 VS12 中运行，所以现在我想将 WCF 放在 IIS 服务器上。我将所有 svc、svc.cs 和 web.config 文件复制到 WCFHost 文件夹并在 WCFHost/bin/ 中放置由调试器创建的文件。我配置了 IIS，当尝试在 chrome 中运行主机时，它给了我错误：

```
Server Error in '/WCFHost' Application.

Access is denied.

Description: An error occurred while accessing the resources required to serve this request. You might not have permission to view the requested resources. 

Error message 401.3: You do not have permission to view this directory or page using the credentials you supplied (access denied due to Access Control Lists). Ask the Web server's administrator to give you access to 'C:\Users\MiSiek\Documents\WcfNewsletter_2'.

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.17929 
```

在 IIS 上创建新应用程序时，我使用了我的用户并通过了。

我的 web.config：

```
 <?xml version="1.0"?>
<configuration>
  <connectionStrings>
    <add name="NewsletterEntities" connectionString="metadata=res://*/NewsletterDAL_EF.csdl|res://*/NewsletterDAL_EF.ssdl|res://*/NewsletterDAL_EF.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=(local)\SQLEXPRESS;Initial Catalog=Newsletter;Integrated Security=True;Pooling=False;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient"/>
  </connectionStrings>
  <appSettings>
    <add key="aspnet:UseTaskFriendlySynchronizationContext" value="true" />
  </appSettings>

  <system.web>
    <compilation debug="true" targetFramework="4.5" />
    <httpRuntime targetFramework="4.5"/>
  </system.web>
  <system.serviceModel>
    <services>
      <service name="WCFHost.MessageService">
        <endpoint address="" binding="basicHttpBinding" contract="WCFHost.IMessageService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8733/WcfServiceLibrary/MessageService/" />
          </baseAddresses>
        </host>
      </service>
      <service name="WCFHost.MailingListService">
        <endpoint address="" binding="basicHttpBinding" contract="WCFHost.IMailingListService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8733/WcfServiceLibrary/MailingListService/" />
          </baseAddresses>
        </host>
      </service>
      <service name="WCFHost.RecipientService">
        <endpoint address="" binding="basicHttpBinding" contract="WCFHost.IRecipientService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8733/WcfServiceLibrary/RecipientService/" />
          </baseAddresses>
        </host>
      </service>
      <service name="WCFHost.SenderService">
        <endpoint address="" binding="basicHttpBinding" contract="WCFHost.ISenderService">
          <identity>
            <dns value="localhost" />
          </identity>
        </endpoint>
        <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8733/WcfServiceLibrary/SenderService/" />
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <!-- To avoid disclosing metadata information, set the values below to false before deployment -->
          <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true"/>
          <!-- To receive exception details in faults for debugging purposes, set the value below to true.  Set to false before deployment to avoid disclosing exception information -->
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>

    <protocolMapping>
      <add binding="basicHttpsBinding" scheme="https" />
    </protocolMapping>

    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
  </system.serviceModel>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
    <!--
        To browse web app root directory during debugging, set the value below to true.
        Set to false before deployment to avoid disclosing web app folder information.
      -->
    <directoryBrowse enabled="true"/>
  </system.webServer>

</configuration> 
```

# python - 洪流客户端：向对等方发送握手消息

> ID：13790771
> 
> 赞同：0
> 
> 时间：2012-12-09T19:12:26.907
> 
> 标签：python, bittorrent, handshake

从我得到对等列表并建立到对等的 tcp 连接，我尝试向他们发送握手消息，但他们似乎没有响应。

这是我在代码中的消息：

```
message = bytes(chr(19))+"BitTorrent protocol00000000"+self.getInfoHash(torrentCont)+self.peer_id 
```

self.getInfoHash(torrentCont) 是种子文件的原始哈希

这是我发送的实际内容：

```
BitTorrent protocol00000000ŒïƒœÝtDØ´öÙÄ×àŠD³T4F11T6ZGBQK2Y5LB8I4 
```

关于我做错了什么的任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-10T00:31:22.620

你混淆了字节和字符。规范所说的是您应该发送八个空字节，而不是字符“0”（即 chr(48)）的八倍：

```
message = (chr(19) +
           "BitTorrent protocol" +
           8 * chr(0) +               # <--- here
           self.getInfoHash(torrentCont) +
           self.peer_id)

# in case of doubt...
assert len(self.getInfoHash(torrentCont)) == 20
assert len(self.peer_id) == 20 
```

# android - 通用方式中的精灵尺寸不起作用

> ID：13790773
> 
> 赞同：0
> 
> 时间：2012-12-09T19:12:33.920
> 
> 标签：android, android-layout, andengine, game-engine

我必须在背景精灵上设置一个新精灵。背景精灵具有根据通过像素格式获得的设备尺寸设置的尺寸..

我也在使用 andengine 和 ratio Resolution 但是..

问题有点复杂..我试着用像素让说

**Glaxy S3 ha *dimensions 720*1280 所需的精灵位置是 (584,608)**

所以我以方式设置**（CAMERA_WIDTH/1.233f，CAMERA_HEIGHT/2.112f）**

但是**HTC experia 的尺寸是 320*480**所以需要的位置根据

**(CAMERA_WIDTH/1.233f,CAMERA_HEIGHT/2.112f) 是 (2599.5,227.27)**

但是根据显示这是错误的...**当我将其设置为（244,172）以使其完美运行时**...请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T02:27:40.337

在方法中：

```
public Engine onCreateEngine() {
this.camara = new Camera(0, 0, camara_width, camera_height);
return new EngineOptions(true, ScreenOrientation.LANDSCAPE,
new FillResolutionPolicy(), this.camara).setNeedsSound(true).setNeedsMusic(true);
} 
```

参数“new FillResolutionPolicy()”自动调整宽度和高度，你只需要为一个分辨率制作一个应用程序在任何智能手机上运行

# yii - 如何控制 YII 闪光灯的放置位置？

> ID：13790774
> 
> 赞同：0
> 
> 时间：2012-12-09T19:12:37.947
> 
> 标签：yii

使用[YII Flash](http://www.yiiframework.com/wiki/21/how-to-work-with-flash-messages/)，您可以这样做：

```
Yii::app()->user->setFlash('success', "Data saved!"); 
```

但是，当 flash 出现在页面上时，它看起来像这样：

```
<div id="yw1">
  <div class="alert in alert-block fade alert-info"><a class="close" data-dismiss="alert">×</a>
     MESSAGE
  </div>
</div> 
```

我如何控制它的放置位置？我在 layouts/main.php 中没有看到任何控制它的东西，但它们显示了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T21:40:56.000

除非你打电话给他们，否则他们不会在任何地方显示，Yii 默认应用程序中的一个很好的例子是*站点/联系人*视图：

```
<?php if(Yii::app()->user->hasFlash('contact')): ?>    
    <div class="flash-success">
        <?php echo Yii::app()->user->getFlash('contact'); ?>
    </div>    
<?php else: ?>
    ... 
```

并且使用`setFlash`方法设置flash

```
Yii::app()->user->setFlash('contact','Thank you for contacting us. We will respond to you as soon as possible.'); 
```

一种可能性是控制器根类（*protected/components/Controller.php*）中可能有一个检查，其中有人可能编写了一个`init()`检查它们的函数。这将在每个控制器/动作调用中调用，因此它可能存在。

另一种可能性是，创建项目的人在框架文件夹中编辑了 flash 方法（或可能对其进行了扩展），您可以在那里查看，它位于*framework/web/auth/CWebUser.php*

但正如 Mik 所说，尝试在您的项目中为**getFlash**或什至只是**flash进行文本搜索**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:16:20.237

我会在您的视图文件夹中对 user->getFlashes() 进行文本搜索。您可以使用此功能在任何地方输出消息

```
<?php
    foreach(Yii::app()->user->getFlashes() as $key => $message) {
        echo '<div class="flash-' . $key . '">' . $message . "</div>\n";
    }
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T22:20:50.057

您，开发人员，需要显示 Flash 消息。Yii 不会为你做这些。

您将它们显示在视图中，如 Eskimo 和 Mik 所示，位于您自己选择的位置。Yii 永远做不到，因为 Yii 不知道你的视图布局。

# python - 模板不存在（Django）

> ID：13790781
> 
> 赞同：0
> 
> 时间：2012-12-09T19:13:56.037
> 
> 标签：python, django, django-templates

我正在尝试为我的第一个 django 站点加载注册模板，我将 register.html 文件放在 /home/Desktop/projects/purple/purple/templates/registration.html 此处但有一个错误说没有文件我不明白这是为什么？谁能有一个想法？

> 请求方法：GET
> 
> 请求网址：http...:127.0.0.1:8000/registration/
> 
> Django 版本：1.4
> 
> 异常类型：TemplateDoesNotExist
> 
> 异常值：registration.html

Django 尝试按以下顺序加载这些模板：

使用 loader django.template.loaders.filesystem.Loader:Django 尝试按以下顺序加载这些模板：

*   使用加载器 django.template.loaders.filesystem.Loader：

    *   /home/Desktop/projects/purple/purple/templates/registration.html（文件不存在）
*   使用加载器 django.template.loaders.app_directories.Loader：

    *   /usr/local/lib/python2.7/dist-packages/django/contrib/auth/templates/registration.html（文件不存在）

    *   /usr/local/lib/python2.7/dist-packages/django/contrib/admin/templates/registration.html（文件不存在）

*   使用加载器 django.template.loaders.eggs.Loader：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:37:16.500

鉴于异常复制和粘贴是指：

`/home/Desktop/projects/purple/purple/templates/registration.html`

并且找不到它...您所有的问题都在于`registration.html`目录中是否存在。

有2种可能：

1.  **文件不存在**
    cd 进入该确切目录并找出是否存在。

2.  **权限**
    `ls -lh /home/Desktop/projects/purple/purple/templates/registration.html`

确保它是可读的。

```
chmod 644 /home/Desktop/projects/purple/purple/templates/registration.html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T10:47:20.863

您在模板目录中有注册目录吗？

如果是这样，那么包括这是您的 settings.py 。

```
 TEMPLATE_DIRS = (
      BASE_DIR +'/Templates',
      BASE_DIR +'/registration',

  )
```

因为 django 在你的 Template 目录而不是 /template/registration 中寻找registration.html。

请参阅您在问题中提到的顺序。注意路径。

# javascript - 使用正则表达式在 CSV 中查找值

> ID：13790788
> 
> 赞同：1
> 
> 时间：2012-12-09T19:14:17.433
> 
> 标签：javascript, regex

我正在尝试确定 CSV 字符串是否包含特定数字（也是字符串），在本例中为数字 3。我编写了一些脚本来尝试此操作，但结果始终返回 null。正则表达式在使用在线测试工具时有效，但在通过脚本使用时无效。谁能确定我错过了什么？

这是我的代码：

```
var csv = ["1,25,3","3", "1", "1,9,10", "2,4,5,6,7,11,33,3", "2,1,2,12,15,27"];

function contains(param){
    var regex = /(,)?\D[3]\D(,)?/g;
    return param.match(regex);
}

for(var i = 0; i < csv.length; i++){
  console.log(contains(csv[i]));
} 
```

或者，如果您愿意：[JsFiddle](http://jsfiddle.net/JSHQB/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:21:09.360

问题是您的模式`\D`在`3`. 由于`3`您示例中的所有 s 都位于字符串的末尾，因此第二个`\D`永远不会匹配。你想要的可能是这样的：

```
var regex = /(?:^|\D)3(?!\d)/; 
```

对于字符串的结尾，我们使用负前瞻。这断言没有数字。这比断言有一个非数字字符要好（因为它也适用于字符串的末尾）。理想情况下，我们会在开始时使用相同的方法，但 JavaScript 不支持。所以我们说，要么我们有字符串的开头，要么有一个非数字字符。事实上（正如 Brad Koch 所指出的），在这种特定情况下，这两个条件都构成了一个单词边界（一个字符之间的位置`[a-zA-Z0-9_]`和一个不是字符串的位置或字符串的结尾）。所以你可以简单地使用：

```
var regex = /\b3\b/; 
```

*但是*，如果您的输入可以包含数字和逗号以外的其他字符（例如`1,text,2,a3b,somemoretext`），那么这些方法都不够。相反，您需要明确检查逗号：

```
var regex = /(?:^|,)3(?![^,])/; 
```

另外，由于您不需要实际匹配，而只想知道是否存在匹配，因此可以`test`改用：

```
return regex.test(param); 
```

这将为您提供一个布尔值而不是一个数组（这也可能会稍微提高效率）。

# javascript - 创建一个检查各种 URL 的安全区域的页面

> ID：13790790
> 
> 赞同：0
> 
> 时间：2012-12-09T19:14:47.727
> 
> 标签：javascript, jsp, internet-explorer-8

我想创建一个页面，在后台检查各种链接的 Internet（不受信任）本地 Intranet（受信任）等安全区域。我已经编写了一个检查安全区域的函数。这很好用！：

```
 function isTrustedIE(){
try{
    new ActiveXObject("Scripting.FileSystemObject");
}
catch(e){
    return false; //untrusted
}

return true; //trusted
} 
```

但是现在我需要进一步操作的帮助：我有以下用例：如果用户调用我的页面，它应该检查一些 URL 是否受信任。例如： [http](http://www.google.de) ://www.google.de 不受信任（Internet 区域） [http://www.intranet-fh.de](http://www.intranet-fh.de) 受信任（本地 Intranet）

因此，我需要一个 Javascript 解决方案来在后台加载 URL 而不会注意到它！这可能吗？

谢谢你的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:35:24.457

在默认配置中，这是不可能的。[由于同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，一个域上的页面无法访问另一个域上的页面；你不能在别人的域上运行你的代码。

此外，我不知道允许脚本访问 IE 的安全区域配置的 API。

如果您的页面在受信任的站点区域中运​​行，我想可以通过`WScript.Shell`'s从注册表中读取安全区域配置`regRead`。 [IE 将配置存储在 HKLM 和 HKCU 下](http://support.microsoft.com/kb/182569) `\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings`。

# android - 如何确保您的应用程序与各种设备兼容？

> ID：13790799
> 
> 赞同：0
> 
> 时间：2012-12-09T19:15:50.140
> 
> 标签：android

在 Google play（应用市场）中，如果某个应用与您的设备不兼容（由于某种原因，例如屏幕尺寸较小等）。然后它甚至没有显示在列表中。

现在，作为一名应用程序开发人员，我永远不想在我的应用程序中无意添加一个限制，禁止它在一系列设备中使用。

因此，在开发过程中，我如何确保应用程序能够在至少我想要的设备类型上运行。

另外，现在我正在开发一个应用程序并在我的手机上使用 2.3.5 版本对其进行测试。并且时不时地，Google 会更改一些方法名称和标志。

对于较新的 android 版本，我可以在模拟器上测试它，但在手机/标签/等上测试它。是另一回事。

请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:24:45.753

默认情况下，应用程序将可供尽可能广泛的用户使用。

您可以在清单文件中定义某些限制，例如在小屏幕尺寸上不可用，但它们由您自行决定。

Google 对您施加的唯一限制是任何 Android 版本低于您的最低 SDK 版本的用户都无法看到您的应用。为了解决这个问题，您可以为较低的 SDK 版本设计应用程序（我相信为 2.2 及更高版本构建可以让您访问大约 95% 的用户群）或维护多个版本的 APK。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:28:49.547

```
how can I make sure that the application will be able to run on atleast the type of devices that I intend. 
```

在清单文件中，您可以提及要运行应用程序的设备类型。对于测试，您可以为不同的设备创建模拟器来测试您的应用程序。尝试制作应用程序 UI，使其在所有设备上运行。

```
Google changes some method names & flags 
```

每当 Android 更改任何东西时，它总是向上兼容意味着如果您为 2.2 制作了应用程序，它将在 2.2 及更高版本上运行（屏幕尺寸或分辨率是另一回事）

关于 UI，请参阅我的答案 [Layout for 720*1280 devices](https://stackoverflow.com/questions/13660452/layout-for-7201280-devices/13660963#13660963)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:27:53.417

读[这个](http://developer.android.com/guide/practices/compatibility.html)。这真的会有所帮助。Next Eclipse 将为您提供很多帮助，首先您可以在清单中定义您希望支持的内容（屏幕尺寸和硬件要求，或者即使它们不是必需的但可以使用）。您可以根据运行的 Android 版本运行版本检查并实施 API。这就是我个人所做的，我检查 API 级别，如果它大于或等于我希望运行的 API，我会运行它，否则我会尝试找到兼容的代码（通常使用兼容性库）或者放弃对该功能的支持，例如 JellyBean 通知，扩展通知实际上没有任何解决方法，但我可以使用 NotifcationCompat 构建器。

# android - 如何使用 cwac-merge 隐藏或显示适配器/视图？

> ID：13790801
> 
> 赞同：0
> 
> 时间：2012-12-09T19:15:52.450
> 
> 标签：android, android-adapter, commonsware-cwac

我有一个包含多个列表的片段，您可能会猜到滚动是一团糟，所以我尝试使用[cwac-merge](https://github.com/commonsguy/cwac-merge)适配器，它似乎做得很好，但我想自定义一些项目，即我需要一些适配器来显示或隐藏，具体取决于它们有多少项目，现在空列表适配器显示一个空白区域，我想让它们消失，直到检索到项目。

![在此处输入图像描述](../Images/b142b62c340a1d209872d06f30db4884.png)

在屏幕截图上（请原谅它的模糊，但我还不允许展示产品）你可以看到我用红色矩形突出显示了空白区域，我将视图设置为 Visibility = GONE。

这些空白空间之一也是由于适配器没有项目而引起的。

有没有办法在 MergeAdapter 中隐藏或显示某些适配器或视图，以免它们占用空间？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T22:42:55.153

> 我将视图设置为 Visibility = GONE

IIRC，在 a`GONE`中排成一行`ListView`通常是有问题的。`MergeAdapter`应该不会对其产生影响。

> 这些空白空间之一也是由于适配器没有项目而引起的。

我比较怀疑。层次结构视图应该向您展示真正发生的事情。

> 有没有办法在 MergeAdapter 中隐藏或显示某些适配器或视图，以免它们占用空间？

`0`从返回的适配器不`getCount()`应该占用任何空间，如果你调用`notifyDataSetChanged()`它`MergeAdapter`以便它可以告诉它`ListView`重绘自己。

# javascript - getScript 不会加载所有脚本

> ID：13790802
> 
> 赞同：2
> 
> 时间：2012-12-09T19:15:57.863
> 
> 标签：javascript, ajax

所以我有这个网站，我在其中使用 ajax 将另一个 .html 中的内容加载到容器中。我一直面临的问题是使用名为“mosaic.js”的脚本的画廊加载的内容不起作用。奇怪的是 getScript 确实适用于另一个脚本。

这是我用于内容替换器的脚本。

[http://net.tutsplus.com/tutorials/javascript-ajax/how-to-load-in-and-animate-content-with-jquery/](http://net.tutsplus.com/tutorials/javascript-ajax/how-to-load-in-and-animate-content-with-jquery/)

```
$(document).ready(function() {

var hash = window.location.hash.substr(1); var href = $('#nav a').each(function(){ var href = $(this).attr('href'); if(hash==href.substr(0,href.length-4)){  var toLoad = hash+'.php #projectcontainer4';  $('#projectcontainer4').load(toLoad) }    });

$('#nav a').live('click', function () {

var toLoad = $(this).attr('href')+' #projectcontainer4'; $('#projectcontainer4').hide('fast',loadContent); $('#load').remove(); $('#wrapper').append('LOADING...'); $('#load').fadeIn('normal'); window.location.hash = $(this).attr('href').substr(0,$(this).attr('href').length-4);

$('#projectcontainer4').empty();

function loadContent() { $('#projectcontainer4').load(toLoad,'',showNewContent)  } 

function showNewContent() {      $.getScript("mosaic.js"); $('#projectcontainer4').show('normal',hideLoader()); }

function hideLoader() { $('#load').fadeOut('normal');

$('html, body').animate({scrollTop : 200},800);

}

return false;   

});

}); 
```

这是在加载的内容中不起作用的脚本

```
(function($){

    if(!$.omr){
        $.omr = new Object();
    };

    $.omr.mosaic = function(el, options){

        var base = this;

        // Access to jQuery and DOM versions of element
        base.$el = $(el);
        base.el = el;

        // Add a reverse reference to the DOM object
        base.$el.data("omr.mosaic", base);

        base.init = function(){
            base.options = $.extend({},$.omr.mosaic.defaultOptions, options);

            base.load_box();
        };

        // Preload Images
        base.load_box = function(){
            // Hide until window loaded, then fade in           if (base.options.preload){
                $(base.options.backdrop, base.el).hide();
                $(base.options.overlay, base.el).hide();

                $(window).load(function(){
                    // IE transparency fade fix
                    if(base.options.options.animation == 'fade' && $(base.options.overlay, base.el).css('opacity') == 0 ) $(base.options.overlay, base.el).css('filter', 'alpha(opacity=0)');

                    $(base.options.overlay, base.el).fadeIn(200, function(){
                        $(base.options.backdrop, base.el).fadeIn(200);
                    });

                    base.allow_hover();
                });             }else{
                $(base.options.backdrop, base.el).show();
                $(base.options.overlay , base.el).show();
                base.allow_hover();             }
        };

        // Initialize hover animations
        base.allow_hover = function(){
            // Select animation             switch(base.options.animation){

                // Handle fade animations
                case 'fade':
                    $(base.el).hover(function () {
                        $(base.options.overlay, base.el).stop().fadeTo(base.options.speed, base.options.opacity);
                    },function () {
                        $(base.options.overlay, base.el).stop().fadeTo(base.options.speed, 0);
                    });

                    break;

                // Handle slide animations
                case 'slide':
                    // Grab default overlay x,y position
                    startX = $(base.options.overlay, base.el).css(base.options.anchor_x) != 'auto' ? $(base.options.overlay, base.el).css(base.options.anchor_x) : '0px';
                    startY = $(base.options.overlay, base.el).css(base.options.anchor_y) != 'auto' ? $(base.options.overlay, base.el).css(base.options.anchor_y) : '0px';;

                    var hoverState = {};
                    hoverState[base.options.anchor_x] = base.options.hover_x;
                    hoverState[base.options.anchor_y] = base.options.hover_y;

                    var endState = {};
                    endState[base.options.anchor_x] = startX;
                    endState[base.options.anchor_y] = startY;

                    $(base.el).hover(function () {
                        $(base.options.overlay, base.el).stop().animate(hoverState, base.options.speed);
                    },function () {
                        $(base.options.overlay, base.el).stop().animate(endState, base.options.speed);
                    });

                    break;          };
        };

        // Make it go!
        base.init();
    };

    $.omr.mosaic.defaultOptions = {
        animation   : 'fade',
        speed       : 150,
        opacity     : 1,
        preload     : 0,
        anchor_x    : 'left',
        anchor_y    : 'bottom',
        hover_x     : '0px',
        hover_y     : '67px',
        overlay     : '.mosaic-overlay',    //Mosaic overlay        backdrop    : '.mosaic-backdrop'    //Mosaic backdrop
    };

    $.fn.mosaic = function(options){
        return this.each(function(){
            (new $.omr.mosaic(this, options));
        });
    };
     })(jQuery); 
```

这是当我用相同的方法加载它时实际工作的脚本。

```
// JavaScript Document

$('.ppt li:gt(0)').hide(); $('.ppt li:last').addClass('last'); $('.ppt li:first').addClass('first'); $('#play').hide();

var cur = $('.ppt li:first'); var interval;

$('#fwd').click( function() {   goFwd();    showPause(); } );

$('#back').click( function() {  goBack();   showPause(); } );

function goFwd() {  stop();     forward();  start(); }

function goBack() {     stop();     back();     start(); }

function back() {   cur.fadeOut( 500 );     if ( cur.attr('class') == 'first' )         cur = $('.ppt li:last');    else        cur = cur.prev();   cur.fadeIn( 500 );}function forward() {cur.fadeOut( 500 );if ( cur.attr('class') == 'last' )cur = $('.ppt li:first');else cur = cur.next();cur.fadeIn( 500 );}function showPause() {$('#play').hide();$('#stop').show();}function showPlay() {$('#stop').hide();$('#play').show();}function stop() {clearInterval( interval );}$(function() {start();} ); 
```

# visual-studio-2012 - 带有 LESS @import 的未声明变量。这是什么原因造成的？有解决办法吗？

> ID：13790807
> 
> 赞同：8
> 
> 时间：2012-12-09T19:16:43.487
> 
> 标签：visual-studio-2012, less

我有 2 个 LESS 文件。Globals.less 和 Site.less。Globals.less 包含我所有的全局（图）变量和对 CSS 重置定义的导入。Site.less 包含正在使用的样式。

Globals.less：

```
//Imports
@import "CSSReset.less";

//Colors
@color-background: rgb(0, 0 , 0); 
```

无站点：

```
@import "Globals.less";

body {
    background: @color-background url('/Images/BackgroundTextureBody.png');
} 
```

问题是这样的：在 Visual Studio 中，Site.less 中的 @color-background 带有下划线，错误是“未声明的变量”，但 LESS 可以很好地编译为 CSS，并且背景颜色正确设置为 #000。这比任何事情都更令人烦恼，但我失去了智能感知，并且在我的错误列表中收到警告。我希望编辑器按预期行事，并且在我编辑 Site.less 时能够“看到”我在 Globals.less 中的声明。我做错了什么，这是一个错误，还是我的环境设置不正确？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-06-18T09:05:06.400

要为特定的 less 文件获取智能感知，您可以添加参考路径，就像在 js 文件中获取智能感知一样。

**例子**

```
/// <reference path="Globals.less" />

@import "Globals.less";

body {
    background: @color-background url('/Images/BackgroundTextureBody.png');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:24:43.603

似乎 Visual Studio（或它的 LESS 解释器）不理解导入的 Globals.less 中变量的范围

导入变量是正常且常见的事情，因此我建议这是您的 Visual Studio 设置中的错误或缺失功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T20:17:28.373

事实证明，我使用的是旧版本的 Web Essentials 2012。我应该检查但没有做的第一件事是确保我的环境是最新的。将 Web Essentials 更新到最新版本更正了该问题。

# assembly - 使用写入系统调用程序集打印寄存器值

> ID：13790814
> 
> 赞同：0
> 
> 时间：2012-12-09T19:17:39.860
> 
> 标签：assembly, stack-overflow, inline-assembly

```
.section .bss
        .lcomm stack, 4

.section .text

.globl _start
_start:
nop

movl %eip,$stack   --> How i can move ESP or any other registers value which will actually be ADDRESS , into STACK variable?

movl $4, %eax
movl $1, %ebx
movl $stack, %ecx
movl $4, %edx
int $0x80

movl $1, %eax
movl $0, %ebx
int $0x80 
```

实际上，我想使用 WRITE 系统调用打印当前的 ESP 值，因为我将在我的 C 程序中将其用作内联汇编。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T13:48:23.863

此 GNU C/C++ 代码（GNU 因为它用于检索当前堆栈指针值的内联汇编风格）将打印堆栈指针的当前值（以十六进制表示）

```
static __inline__ void printESP(void) {
    static const hexdigit[] = "0123456789ABCDEF\n";
    uintptr_t SP;

    __asm__ __volatile__("mov %%esp, %0\n\t" : "=r"(SP));

    write(1, &hexdigit[SP >> 28], 1);
    write(1, &hexdigit[0xf & SP >> 24], 1);
    write(1, &hexdigit[0xf & SP >> 20], 1);
    write(1, &hexdigit[0xf & SP >> 16], 1);
    write(1, &hexdigit[0xf & SP >> 12], 1);
    write(1, &hexdigit[0xf & SP >> 8], 1);
    write(1, &hexdigit[0xf & SP >> 4], 1);
    write(1, &hexdigit[0xf & SP], 1);
    write(1, &hexdigit[16], 1);
} 
```

由于`static __inline__`，gcc 在大多数情况下（实际上，如果您使用函数指针除外）实际上不会创建此函数，而是将代码直接嵌入到调用点。

您可以构建一个更复杂的部分，它会执行以下操作：

```
static __inline__ printESP(void)
{
    static const char hexdigit[] = "0123456789ABCDEF\n";
    uintptr_t SP;
    char buf[9];

    __asm__ __volatile__("mov %%esp, %0\n\t" : "=r"(SP));

    buf[0] = hexdigit[SP >> 28];
    buf[1] = hexdigit[0xf & SP >> 24];
    buf[2] = hexdigit[0xf & SP >> 20];
    buf[3] = hexdigit[0xf & SP >> 16];
    buf[4] = hexdigit[0xf & SP >> 12];
    buf[5] = hexdigit[0xf & SP >> 8];
    buf[6] = hexdigit[0xf & SP >> 4];
    buf[7] = hexdigit[0xf & SP];
    buf[8] = hexdigit[16];
    write(1, buf, 9);
} 
```

这会在堆栈上构造一个临时缓冲区并`write()`仅调用一次。

第二段代码的缺点是它实际上*消耗了 stackspace*，这意味着如果你调用它，比如说，从一个溢出它的堆栈和/或损坏它的堆栈指针的函数中调用它，它就会崩溃。逐个字符发出地址的第一个微不足道可能仍然有效。

请注意您的初始汇编代码：这是使用*全局*缓冲区，因此不是线程安全的；如果你同时从多个线程调用它，它们会破坏变量并且你会得到垃圾。所以不，我不会帮助“修复”那个。

关于该方法的一般说明：就个人而言，我认为这就是调试器的用途。这种特定类型的运行时检测（以这种方式 - 通过直接打印值）相当无用；如果是运行时检测，那么最好记录到内存中的跟踪缓冲区，您可以在其中记录扩展信息，例如（部分）堆栈跟踪、线程 ID、时间戳、其他寄存器值等，以及堆栈指针。使用内存（环）缓冲区不依赖于文件描述符 1 的特殊含义，并且允许“上下文”信息比仅堆栈指针值更能描述正在发生的事情。

此外，如果该值不必 100% 准确，则可以使用gcc [builtins](http://gcc.gnu.org/onlinedocs/gcc/Return-Address.html)`uintptr_t SP = (uintptr_t)__builtin_frame_address(0)`代替。您根本不需要内联汇编。不同之处在于它会在函数*入口处为您提供堆栈指针，而不是调用站点的**当前*堆栈指针，即它不考虑局部变量和其他“临时”的堆栈使用情况。

# list - MIT 方案消息传递列表布尔值

> ID：13790817
> 
> 赞同：0
> 
> 时间：2012-12-09T19:18:05.330
> 
> 标签：list, scheme, message

在过去的几天里，我一直在为一个计划问题绞尽脑汁，该问题涉及创建一个带有消息传递的过程来跟踪朋友列表，然后可以操纵该列表以将特定朋友的值更改为在线或离线。如果放入的人是朋友，则返回 true。如果尚未添加它们，则返回 false。它还可以显示在线朋友列表，以及您拥有的另一个列表。基本上，这个想法是制作一个可变的 Facebook 跟踪器。它响应 4 个输入：'add、'toggle-status、'get-online-friends 和'get-friends。

到目前为止，这是我设法做到的：

```
(define (sort-strings lst)
    (sort lst string<?))

(define (make-facebook-list)
(let ((T '()))
(define (dispatch x)
  (define (add-person name)
(set! T (cons (cons name #f) T)) 
'done)
  (define (online? friend)
(eq? friend #t))
  (define (toggle-status! name)
(begin ;(if () (set! T (cons (cons name #t) T)))
  (if (member name T)
      (set-cdr! T (cons (cons name (not (cdr name)) T))))
  (if (member name T) #t #f)))
  (define (get-online-friends!)
(sort-strings (filter online? T)))
  (define (get-friends!)
(sort-strings T))
  (cond ((eq? x 'add) add-person)
    ((eq? x 'toggle-status) toggle-status!)
    ((eq? x 'get-online-friends) (get-online-friends!))
    ((eq? x 'get-friends) (get-friends!))
    (else (error "Unknown Request" x))))
dispatch)) 
```

这些是我正在使用的测试用例：

```
(define my-lst (make-facebook-list))
(display ((my-lst 'add) "Francis"))(newline) ; should return 'done
(display ((my-lst 'add) "Adrian"))(newline) ; should return 'done
(display ((my-lst 'add) "Zule"))(newline) ;  should return 'done
(display ((my-lst 'add) "Geralt"))(newline) ; should return 'done
(display ((my-lst 'add) "Dexter"))(newline) ; should return 'done
(display ((my-lst 'add) "Leonidas"))(newline) ; should return 'done
(display ((my-lst 'toggle-status) "Leonidas"))(newline) ; should return #t
(display ((my-lst 'toggle-status) "Francis"))(newline) ; should return #t
(display ((my-lst 'toggle-status) "Zule"))(newline) ; should return #t
(display ((my-lst 'toggle-status) "Xavier"))(newline) ; should return #f
(display (my-lst 'get-online-friends))(newline) ; should return ("Francis" "Leonidas" "Zule")
(display (my-lst 'get-friends)) ; should return ("Adrian" "Dexter" "Francis" "Geralt" "Leonidas" "Zule") 
```

我知道他们现在不会全部工作，这就是我注释掉一些程序的原因。我试图正确运行的是将状态切换为在线或离线的过程。我被引导相信“成员”用于检查某个值是否是列表的一部分。我是不是走错了路？

注意：sort-strings 过程旨在与返回朋友列表的过程一起使用，以保持它们按字母顺序排列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:49:15.217

你的朋友是`begin`，它强制按顺序计算以下表达式：

```
(define (make-facebook-list)
  (define T '())
  (define (dispatch x)
    (lambda (fl)
      (cond ((eq? x 'add) 
             (begin
               (set! T (append T (list fl)))
               'done))
            (else 'invalid))))
  dispatch)

scheme@(guile-user)> (define my-lst (make-facebook-list))
scheme@(guile-user)> ((my-lst 'add) "Francis")
$1 = done 
```

**编辑**

```
(define (make-facebook-account)
  (let ((*facebook-friends* '()))
    (define (sort-alphabetically sequence)
      (sort-list sequence string<?))
    (define (friend name)
      (assoc name *facebook-friends*))
    (define (friends-name friend)
      (car friend))
    (define (friends-status friend)
      (cdr friend))
    (define (online? friend)
      (eq? (friends-status friend) #t))
    (define (friend-on-facebook? name)
      (if (member (friend name)
                  *facebook-friends*)
          #t #f))
    (define (add-person! name)
      (begin
        (set! *facebook-friends*
              (cons (cons name #f)
                    *facebook-friends*))
        'done))
    (define (toggle-status! name)
      (if (friend-on-facebook? name)
          (begin
           (set-cdr! (friend name)
                      (if (online? (friend name))
                          #f #t))
           'done)
          (error
           "Person no friend on facebook -- TOGGLE-STATUS!" name)))
    (define (get-friends table)
      (sort-alphabetically
       (map friends-name table)))
    (define (get-online-friends table)
      (get-friends
       (filter online? table)))
    (define (dispatch m)
      (cond ((eq? m 'add!) add-person!)
            ((eq? m 'toggle-status!) toggle-status!)
            ((eq? m 'get-friends)
             (get-friends *facebook-friends*))
            ((eq? m 'get-online-friends)
             (get-online-friends *facebook-friends*))
            ((eq? m 'friend-on-facebook?) friend-on-facebook?)
            (else
             (error "Unknown request -- DISPATCH" m))))
    dispatch)) 
```

# scala - 应该避免 x._1,x._2... 语法吗？

> ID：13790823
> 
> 赞同：29
> 
> 时间：2012-12-09T19:18:54.413
> 
> 标签：scala, tuples

我刚刚开始使用 Scala。我发现自己经常使用元组变量。

例如，这是我写的一些代码：

```
/* Count each letter of a string and return in a list sorted by character
 * countLetter("test") = List(('e',1),('s',1),('t',2))
*/
def countLetters(s: String): List[(Char, Int)] = {
  val charsListMap = s.toList.groupBy((c:Char) => c)
  charsListMap.map(x => (x._1, x._2.length)).toList.sortBy(_._1)
} 
```

这种元组语法（x._1、x._2 等）是否受到 Scala 开发人员的反对？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-09T19:30:50.710

Scala 开发人员不喜欢元组访问器吗？

简短的回答：没有。

稍长（一个字符）答案：是的。

太多`_n`'s 可能是代码异味，在我看来，在您的情况下，以下内容要清楚得多：

```
def countLetters(s: String): List[(Char, Int)] =
  s.groupBy(identity).mapValues(_.length).toList.sortBy(_._1) 
```

有很多这样的方法`mapValues`是专门为减少对嘈杂的元组访问器的需求而设计的，所以如果你发现自己写`_1`了很多东西，这可能意味着你错过了一些不错的库方法。但有时它们是写东西的最干净的方式（例如，`_1`我重写的final）。

需要注意的另一件事是过度使用元组访问器应该被视为推动将元组提升为案例类的推动力。考虑以下：

```
val name = ("Travis", "Brown")

println("Hello, " + name._1) 
```

相对于：

```
case class Name(first: String, last: String)

val name = Name("Travis", "Brown")

println("Hello, " + name.first) 
```

第二个版本中额外的 case 类定义为单行代码购买了很多可读性。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-12-09T19:33:58.117

那么有一个更好的解决方案`x._N`。使用元组的常用方法是模式匹配：

```
charsListMap.map{case (a, b) => (a, b.length)} 
```

你也可以看看`scalaz`，有一些用于元组的[工具](http://scalaz.github.com/scalaz/scalaz-2.9.1-6.0.4/doc.sxr/scalaz/example/ExampleBifunctor.scala.html)：

```
import scalaz._
import Scalaz._

scala> (1, "a") bimap (_ + 2, _ + 2)
res0: (Int, java.lang.String) = (3,a2)

scala> ('s, "abc") :-> { _.length }
res1: (Symbol, Int) = ('s,3) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-06-01T13:20:25.370

从 开始`Scala 3`，使用[参数 untupling](https://dotty.epfl.ch/docs/reference/other-new-features/parameter-untupling.html)功能，以下将成为 的替代方案`.map(x => x._1 -> x._2.length)`：

```
.map(_ -> _.length) 
```

因此，您的示例变为：

```
"test".toList.groupBy(identity).map(_ -> _.length).toList.sortBy(identity)
// List(("e", 1), ("s", 1), ("t", 2)) 
```

* * *

关于更具体的示例并从 开始`Scala 2.13`，您还可以使用[groupMapReduce](https://www.scala-lang.org/api/2.13.x/scala/collection/immutable/WrappedString.html#groupMapReduce%5BK,B%5D(key:A=%3EK)(f:A=%3EB)(reduce:(B,B)=%3EB):scala.collection.immutable.Map%5BK,B%5D)（顾名思义），它相当于 a和 reduce 步骤`groupBy`：`mapValues`

```
"test".groupMapReduce(identity)(_ => 1)(_ + _).toList.sortBy(identity) 
```

# ios - 添加 UIAnimation

> ID：13790827
> 
> 赞同：0
> 
> 时间：2012-12-09T19:19:59.223
> 
> 标签：ios, arrays, image, uianimation

我有一个带有分页的 ScrollView，我有一个按钮，可以将我带到我的 scrollView 中带有图像的数组。这是我的代码

```
-(IBAction)scrollToPage:(id)sender {
    int scrollToPage = 1; 
    int scrollToX = 1-1; 
    [self.scrollView scrollRectToVisible:CGRectMake(scrollToX*self.scrollView.frame.size.width,0,self.scrollView.frame.size.width,self.scrollView.frame.size.height) animated:YES];
} 
```

我知道它已经动画了，但我需要为其添加自定义动画，例如：“水平翻转、交叉溶解等”

预先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T21:17:16.377

您可以使用以下代码片段来翻转您在`button pressed`操作方法中拥有的图像。这将允许翻转图像，然后您可以将其玩弄成您想要的。

```
UIImage* sourceImage = [UIImage imageNamed:@"whatever.png"];
UIImage* flippedImage = [UIImage imageWithCGImage:sourceImage.CGImage 
                     scale:1.0 orientation: UIImageOrientationUpMirrored]; 
```

看看这是否适合你。

# c++ - C ++中静态成员函数的目的？

> ID：13790828
> 
> 赞同：4
> 
> 时间：2012-12-09T19:20:18.517
> 
> 标签：c++

如果每个成员函数每个类只包含一次（由所有实例共享），那么声明成员函数静态的目的到底是什么？它是否像一个被声明为 const 的函数，因为它修改了特定类型的数据（在这种情况下，是静态数据成员）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T19:21:33.613

普通成员函数需要类实例才能运行。可以直接调用静态方法，而无需先创建类的实例。

普通方法：

```
MyClass myClass;
myClass.NormalMethod(); 
```

静态方法：

```
MyClass::StaticMethod(); 
```

因此，普通方法非常适合处理类数据的函数。如果一个方法不需要处理类数据，那么它可能会成为静态的候选方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:27:27.067

类方法，无论是静态的还是其他的，都可以访问该类的任何对象的私有成员，而不仅仅是它自己的实例。静态方法也是如此，除非您将实例传递给它们，否则它们没有实例。

您也可以使用自由函数并将其声明为友元，但自由函数意味着更高级别的抽象，可以对不同类的对象进行操作。静态类方法说“我只根据我的类才有意义”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T20:08:59.247

静态方法的一种应用是创建实例并返回指针。例如，可能存在调用者不应该知道的派生类——“工厂”函数知道要使用哪个派生类。

当然，当您需要创建一个对象时，您可能还没有一个对象可用于此，即使您这样做了，其他对象也不相关。

基本上，有时某些动作是类提供的抽象的一个方面，但该动作与特定对象无关 - 或者至少不是已经存在的对象。在这种情况下，您应该将操作实现为静态函数。

类似地，一些数据与类提供的抽象相关，但与该类的特定实例无关。该数据可能最好作为静态成员变量来实现。

# c++ - OOP，使用类的链表

> ID：13790832
> 
> 赞同：1
> 
> 时间：2012-12-09T19:20:43.187
> 
> 标签：c++

我有一类事件。现在我所要做的就是创建事件并将它们存储在一个链表中。但我不知道如何固定头部位置。我的意思是，如果我在构造函数中将 head 定义为 NULL，那么对于每个新事件，它将重新定义为 NULL。因此，我的链接列表中只有一个事件。我的代码是这样的：

```
// event.h
class event{
    private:
        Event *head;
        Event *nxt;
        int date;
        string name;

    public:
        event();
        event(int d, string n);
        Add_item();
}

//event.cpp
event::event(){}
event::event(int date, string name): date(date), name(name){
head=NULL; 
```

// 现在每次调用构造函数时，head 都会被重新定义为 NULL。我该怎么办？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:33:35.447

首先，代码显示它`class Event`是独立的。也就是说，`head`并且`nxt`是对象本身的一部分。如果您希望使用相互链接但不维护`head`外部的对象的链接列表，那么我将执行以下操作...

```
// event.cpp
event::event() {
    head = NULL;
}

event::event(int date, string name): date(date), name(name) {
    head = NULL;
}

event::event(event *prev, int date, string name): date(date), name(name) {
    if (prev->head != NULL) {
        this->head = prev->head;
    } else {
        prev->head = this->head = prev;
    }
    prev->nxt = this;
    this->nxt = NULL;
} 
```

使用它的一个例子如下：

```
event *tailEvent = new event(1, 'first');
event *nextEvent = new event(tailEvent, 2, 'second');
event *thirdEvent = new event(nextEvent, 3, 'third');
...
tailEvent = lastEvent; 
```

等等等等。因此，`tailEvent->head`将始终指向第一个创建的事件，并且`tailEvent->nxt`将在列表中跟随。

但是...这很容易出错，所以我建议将列表本身保留在外面，如果可能的话使用 STL。有关示例，请参阅[学习 C++：示例链接列表](http://learningcppisfun.blogspot.in/2005/10/sample-linked-list.html)。

编辑：

更好的方法： -

```
class Event {
    private:
        Event *next;
        int date;
        string name;

    public:
        Event() {};
        Event(int date, string name) : date(date), name(name) {};
        setNext(Event *next) { this->next = next; };
        int date() { return date; };
        string name() { return name; };
        Event *next() { return next; };
};

class EventList {
    private:
        Event *head;

    public:
        EventList() { head = NULL };
        void add(int date, string name);
        Event *head() { return head; }
}

void EventList::add(int date, string name) {
    Event *newEvent = new Event(date, name);
    newEvent->setNext(NULL);
    Event *tmp = head;
    if (tmp != NULL) {
        while (tmp->next() != NULL) tmp = tmp->next();
        tmp->setNext(newEvent);
    } else {
        head = newEvent;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:27:50.217

更好的方法是在这里设置两个类：一个用于存储每个事件，另一个用于管理和存储有关列表的信息。

您的列表中将有许多事件类。只有一个列表类。

现在，您的事件类实际上需要一些辅助方法，例如 next 和 previous 指针。您可以直接实现它们或创建第三个类，该类继承自或包含事件类。

但无论哪种方式，管理列表的类都应该只需要一个实例。在这种情况下，head 可以初始化为 null，并将根据需要进行更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T19:29:45.207

您的列表需要一些控制代码。列表项无法控制自己。

我建议您使用实现所有列表操作的容器 std::list 。

如果你想实现你的列表，你应该创建控制类，例如 EventContainer 并实现插入/删除和搜索操作。

# javascript - Javascript 正则表达式来获取 ap 标签的内容

> ID：13790833
> 
> 赞同：1
> 
> 时间：2012-12-09T19:20:44.167
> 
> 标签：javascript, regex

有人可以帮我编写一个包含此 p 内容的正则表达式代码：

`<p class="bc_shirt_name">101</p>`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:23:40.370

当您的标记格式良好时，最好使用[DOMParser 。](https://developer.mozilla.org/en-US/docs/DOM/DOMParser)

```
var parser = new DOMParser();
var doc = parser.parseFromString('<p class="bc_shirt_name">101</p>', "application/xml");
var contents = doc.documentElement.textContent; 
```

这几乎适用于任何 XML，而不仅仅是 XHTML。我也可以用这个`<tag>foo</tag>`。

这是一个演示：http: [//jsfiddle.net/vEeXX/](http://jsfiddle.net/vEeXX/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:36:45.953

您的浏览器应该能够解析 HTML，不是吗？

```
var div = document.createElement("div");
div.innerHTML = '<p class="bc_shirt_name">101</p>';
var p = div.getElementsByTagName("p")[0];
var html = p.innerHTML; // content as html
var text = p.textContent || p.innerText; // content as plain text 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T19:34:38.897

有很多方法，但这是原始问题所要求的使用正则表达式的方法：

```
var html = "<stuff><p class=\"bc_shirt_name\">101</p></stuff>";

var matches = html.match(/<p\s+class="bc_shirt_name">[\S\s]*?<\/p>/gi);
    matches = matches[0].replace(/(<\/?[^>]+>)/gi, ''); // Strip HTML tags?

alert(matches);​ 
```

JSFiddle 演示：http: [//jsfiddle.net/tGTb7/](http://jsfiddle.net/tGTb7/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-09T19:39:58.920

```
var str = "<p class="bc_shirt_name">101</p>";
var match, result = "", 
regex = /<p\s+class="bc_shirt_name">(.*?)<\/p>/ig;

while (match = regex.exec(str)) {
  result += match[1]; 
  }
 alert(result); 
```

结果变量将包含所需的数据。希望这可以帮助。

# android - vfb-虚拟帧缓冲区的目的是什么？

> ID：13790838
> 
> 赞同：3
> 
> 时间：2012-12-09T19:21:11.453
> 
> 标签：android, linux, linux-kernel, framebuffer, xvfb

我见过这个配置标志`CONFIG_FB_VIRTUAL=y`

*   它有什么作用？
*   它是如何工作的？
*   `vfb`和之间有什么关系`xvfb`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T19:28:00.680

根据[此页面](http://cateee.net/lkddb/web-lkddb/FB_VIRTUAL.html)，它用于测试。这是一个位于主内存而不是图形内存中的帧缓冲区，因此您基本上看不到它，但是如果您的应用程序环境出于某种原因需要帧缓冲区并且您的硬件没有图形（在嵌入式应用程序中并不罕见），那么它可以有用。

xvfb 是一个非常不同的野兽。它在用户空间中创建自己的虚拟帧缓冲区，用作 X 显示器。它可以与需要 X 连接的程序一起使用（例如旧版本的[PhantomJS](http://phantomjs.org/)）但由于某种原因系统没有现有的 X 显示。它不需要内核提供任何类型的支持来执行此操作 - 它使用帧缓冲区，但实际上帧缓冲区只是用于图形屏幕的一块内存的花哨术语。

# php - PHP flush() 不适用于 laravel？

> ID：13790844
> 
> 赞同：6
> 
> 时间：2012-12-09T19:21:55.807
> 
> 标签：php, laravel

我正在使用 Laravel，我需要在发生数据时输出数据。当我尝试在 Laravel 之外加载页面时，它工作得很好。如果我在 Laravel 中使用它，它不会刷新，它会等到最后并打印结果。

**视图.php**

```
<?php

if (ob_get_level() == 0) ob_start();
for ($i = 0; $i <= 10; $i++){

    echo "<br> Line to show. $i";
    echo str_pad('',4096)."\n";    

    ob_flush();
    flush();
    sleep(1);

}
ob_end_flush();
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T22:59:51.497

想通了，我需要添加 ob_flush();

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-26T08:58:43.317

更新，任何来这里的人。

上述解决方案对我不起作用。什么有效，是添加

`header('X-Accel-Buffering: no');`

在任何输出之前。

在这里找到它：[https ://laracasts.com/discuss/channels/laravel/live-output-in-blade-template-ob-flush](https://laracasts.com/discuss/channels/laravel/live-output-in-blade-template-ob-flush)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-22T06:39:44.393

这个序列对我有用。

```
ob_implicit_flush(true);
echo "Processing ... "; // Or give out JSON output
ob_flush();
sleep(5); //A time-consuming synchronous process (SMTP mail, maybe?)
echo "Done"; 
```

# c# - mvc3 查看 viewdata 和 viewbag 为空

> ID：13790845
> 
> 赞同：0
> 
> 时间：2012-12-09T19:22:06.460
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, visual-studio-2010

我似乎无法通过 ViewBag 或 ViewData 将任何数据传递给视图。它只是不断地以空值返回。

查看结果代码：

```
 public ViewResult EditProduct(Guid id)
    {
        var product = _repository.Products.FirstOrDefault(x => x.ID == id);

        ViewData["Categories"] = _repository.Categories;
        ViewData["CategoryList"] = _repository.Categories.Select(x => new SelectListItem { Text = x.Name, Value = x.ID.ToString(), Selected = product.ID == x.ID });
        ViewBag.Test = "Hello";

        return View(product);
    } 
```

这是剃刀代码：

```
@model NightingalecrossMVC.Domain.Entities.Product
@{
    var test = ViewData.Eval("CategoryList");

    var test2 = ViewBag.Test;

    ViewBag.Title = "Edit Treatment";

    AjaxOptions ajaxOpts = new AjaxOptions
    {
        UpdateTargetId = "saveData",
        HttpMethod = "Post",
        LoadingElementId = "loader"
    };
} 
```

为什么会这样？它在任何其他视图上都可以正常工作？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T20:01:41.463

获得空值的原因是因为我有这个：

```
 public ViewResult CreateProduct()
    {
        return View("EditProduct", new Product());
    } 
```

它必须是这样的：

```
 public ViewResult CreateProduct()
    {
        ViewBag.CategoryList = _repository.Categories.Select(x => new SelectListItem { Text = x.Name, Value = x.ID.ToString() });
        return View("EditProduct", new Product());
    } 
```

编辑

实际上，由于 LINQ 中的 ToString() 方法，您无法制作这样的 selectlistitem 列表，需要使用 {} 而不是 new SelectListItem 将其拉长，以使其具有适当的功能。但这会降低可读性。所以最好的解决方案是创建一个返回 IEnumerable 的函数，然后你可以创建一个 SelectList。

关于使用 SelectList 存在一些争议，并且 DropDownList 不支持这种重载。但是 SelectList 确实实现了 IEnumerable，因此不应该支持 SelectList。

# ruby-on-rails - Has_many的Rails 3'关联：[...]未找到'错误：通过关系

> ID：13790849
> 
> 赞同：0
> 
> 时间：2012-12-09T19:22:39.410
> 
> 标签：ruby-on-rails, activerecord

我很确定我已经为标准的 has_many 正确设置了模型：通过关系...但是，我使用 rails 生成器来创建模型，并且在第一次运行它时，我不小心创建了一个名为`Categorizations`(复数）而不是`Categorization`在我意识到错误之前一直设置所有内容。我回滚了迁移并删除了生成器创建的 4 个文件（迁移、模型、规格、工厂）。我重新开始，我仍然得到 `Association :category not found`错误。

我的主要问题： **由于我不小心创建并删除了复数名称的模型，我还需要撤消其他什么吗？**

后续问题： **如果这不是问题，那么我做错了什么？是否有一些明显的疏忽，因为我已经盯着这个很久了？**

跟进跟进： **我还能做些什么来帮助解决此问题？所有模型都可以在控制台中访问，并且似乎设置正确。有`rake routes`模型协会吗？**

这是我的看法：

`<%= f.association :category %>`

我也试过：

`<%= f.association :category, :required => true, :collection => @categories, :as => :check_boxes, :label => "Categories:" %>`（我在控制器中设置了@categories

以下是模型：

```
class PressRelease < ActiveRecord::Base
  has_many :categorizations
  has_many :categories, :through => :categorizations

  belongs_to :user
  belongs_to :press_contact

  attr_accessible :body, :summary, :user_id, :headline, :link, :press_contact_id, :publish_date, :subheadline

  self.per_page = 5

  def published
    "#{self.publish_date.strftime("%A, %B %d, %Y")}"
  end

end

class Category < ActiveRecord::Base
  has_many :categorizations
  has_many :press_releases, :through => :categorizations
  attr_accessible :description, :label
end

class Categorization < ActiveRecord::Base
  belongs_to :category
  belongs_to :press_release

  attr_accessible :category_id, :press_release_id

end 
```

**更新：**这一切都在控制台中工作：

```
pr = PressRelease.first
pr.categories
Category Load (0.2ms)  SELECT "categories".* FROM "categories" INNER JOIN "categorizations" ON "categories"."id" = "categorizations"."category_id" WHERE "categorizations"."press_release_id" = 1

c = Category.first
c.press_releases
PressRelease Load (0.3ms)  SELECT "press_releases".* FROM "press_releases" INNER JOIN "categorizations" ON "press_releases"."id" = "categorizations"."press_release_id" WHERE "categorizations"."category_id" = 21
 => [] 
```

因此，该协会似乎在某种程度上正在发挥作用。我越来越有信心我错过了一些小而明显或巨大而耀眼的东西。请帮忙！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:03:23.870

如果您正在工作，`PressRelease`您应该使用`<%= f.association :categories %>`，更改`:category`for `:categories`，因为关系。

# go - 在 Go 中捕获屏幕？

> ID：13790852
> 
> 赞同：15
> 
> 时间：2012-12-09T19:22:58.693
> 
> 标签：go

是否有跨平台的方式来捕获谷歌的 Go 中的屏幕？或任何方式，但首选跨平台。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-12-21T13:40:19.507

现在有：

[https://github.com/vova616/screenshot](https://github.com/vova616/screenshot)

```
go get github.com/vova616/screenshot 
```

例子：

```
package main

import "github.com/vova616/screenshot"

func main() {
    img, err := screenshot.CaptureScreen() // *image.RGBA
    myImg := image.Image(img) // can cast to image.Image, but not necessary
} 
```

如果您还需要 macOS 支持（直到合并拉取请求），请获取：

[https://github.com/kesarion/screenshot](https://github.com/kesarion/screenshot)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-10T09:28:27.723

不幸的是，没有图书馆可以做到这一点。[magickwand](http://www.imagemagick.org/script/magick-wand.php)有几个绑定（C 编程语言和 ImageMagick 图像处理库），请参阅[http://go-lang.cat-v.org/library-bindings](http://go-lang.cat-v.org/library-bindings)但这些不完整且没有屏幕捕获功能.

同时，正如 GeertJohan 所建议的，您可以使用 os.exec 运行外部程序并捕获屏幕（请参见下面的示例代码）。例如，您可以使用`import`imagemagick 的命令来捕获屏幕（应该在可以运行 imagemagick 的平台上工作）

```
package main

import (
    "bytes"
    "fmt"
    "log"
    "os/exec"
)

func main() {

    var buf bytes.Buffer

    path, err := exec.LookPath("import")
    if err != nil {
        log.Fatal("import not installed !")
    }
    fmt.Printf("import is available at %s\n", path)

    cmd := exec.Command("import", "-window", "root", "root.png")

    cmd.Stdout = &buf
    cmd.Stderr = &buf

    err = cmd.Run()
    if err != nil {
        panic(err)
    }
    fmt.Println(buf.String())
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T17:31:52.243

我不知道任何跨平台库，但是当存在 X 服务器时，您可以使用[xgbutil库来执行此操作。](https://github.com/BurntSushi/xgbutil)您可以[在此处查看如何截取屏幕截图的示例](https://github.com/BurntSushi/xgbutil/blob/master/_examples/screenshot/main.go)。

如果你想让它在 Mac/Windows 系统上运行，我可能会先检查[go.wde](https://github.com/skelterjohn/go.wde)的源代码，其中包括 Windows 和 Mac 的后端。我怀疑你会直接在其中找到捕获屏幕截图的代码，但它可能会给你一些提示或遵循的路径。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-18T07:21:14.020

该库似乎满足您的需求： [https ://godoc.org/github.com/kbinani/screenshot](https://godoc.org/github.com/kbinani/screenshot)

> 将屏幕截图图像捕获为 image.RGBA。支持 Mac、Windows、Linux、FreeBSD、OpenBSD、NetBSD 和 Solaris。

```
func Capture(x, y, width, height int) (*image.RGBA, error)
func CaptureDisplay(displayIndex int) (*image.RGBA, error)
func CaptureRect(rect image.Rectangle) (*image.RGBA, error)
func GetDisplayBounds(displayIndex int) image.Rectangle
func NumActiveDisplays() int 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-09T08:43:47.103

Google 的 Go中没有跨平台的截屏**方式**，因为截屏依赖于底层操作系统的特定 API。但是有 Go 的**库**可以做到这一点。

例如[https://github.com/vova616/screenshot](https://github.com/vova616/screenshot)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-10T09:09:16.243

我找不到一个图书馆来做到这一点。稳定的跨平台截屏需要大量的工作。屏幕捕获需要与操作系统的显示管理器/服务器或帧缓冲区进行交互，这对于许多操作系统和 Linux 发行版来说是不同的。您必须为每个 OS API 编写接口（或包装提供功能的库），然后将所有不同的方法抽象到一个包中，以便它可以跨平台工作。

另一种方法是运行现有的屏幕捕获应用程序（命令行）为您完成屏幕捕获工作，包括保存到文件。然后在你的 go 应用程序中读取文件。要让 Go 应用程序运行第三方应用程序，请使用[os/exec](http://golang.org/pkg/os/exec/)包，它位于标准库中。对于 Linux，您可以使用[fbgrab](http://hem.bredband.net/gmogmo/fbgrab/)将帧缓冲区保存到 png 文件中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-01-09T16:45:20.530

这是。这是一个两步的过程：

研究[https://github.com/ShareX/ShareX/tree/master/ShareX.ScreenCaptureLib](https://github.com/ShareX/ShareX/tree/master/ShareX.ScreenCaptureLib)以查看调用哪些 win32 API 来捕获屏幕/窗口 将该逻辑转换为 Go。您可以使用少数现有的 win32 api Go 绑定之一（例如[https://github.com/AllenDang/w32](https://github.com/AllenDang/w32)）。如果它们缺少所需的功能，您可以添加更多包装器。

# ant - 我想知道我的ant junit任务是否有问题

> ID：13790854
> 
> 赞同：0
> 
> 时间：2012-12-09T19:23:03.357
> 
> 标签：ant

我正在编写我的 build.xml。但是，我的 junit 任务似乎出了点问题。当我运行我的 junit 任务时。我可以构建成功，但 junit 报告仅显示运行 1 次测试时出错。但是我有10多个测试。所以我想知道我的junit任务是否运行了一些东西。这是我的代码。

```
<property name="src.dir"    value="src"/>
<property name="bin.dir"    value="bin"/>
<property name="dest.dir"   value="dest"/>
<property name="test.dir"   value="test/>
<property name="lib.dir"    value="lib"/>
<path id="classpath">
    <pathelement location="${lib.dir}/junit-4.11.jar"/>
    <pathelement location="${lib.dir}/ant-junit4.jar"/>
</path>

<target name="test" depends="compile">
    <junit printsummary="yes" haltonfailure="no">
            <classpath>
                <pathelement location="${bin.dir}"/>
                <path refid="classpath"/>
            </classpath>
            <formatter type="plain" usefile="false"/>   
                <batchtest fork="yes">
                    <fileset dir="${test.dir}" includes="*Test*.java"/>
                </batchtest>
            </junit>
        </target> 
```

我无法弄清楚出了什么问题，所以有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T00:53:50.407

发生了什么？您收到任何错误消息吗？

您通常需要执行以下操作：

*   编译你的正常代码。生成的`*.class`文件应该放在一个目录中，例如`target/classes`或`build/classes`。使用任务的`destdir`参数`<javac>`来执行此操作。
*   编译您的 JUnit 测试。
    *   在您的**类路径**中，您需要编译***普通***类所需的所有 jars
    *   您需要参考`destdir`您的***普通***类被编译到的位置。
    *   您需要 JUnit jar。
    *   这些应该编译到与普通 jar***不同的目录***。通常，这是`target/test-classes`或`build/test-classes`。

一旦你编译了 JUnit 测试，你就可以运行它们了。您可以`<junit>`像以前一样使用该任务。

*   您需要确保将`includeantruntime`参数设置为`true`
*   您还应该设置`fork`为`true`.
*   编译测试类时需要相同的类路径（包含所有三个元素）。可能需要更多的罐子，但通常不需要。
*   您在已***编译***的JUnit 测试***类文件***（您保存到`target/test-classes`或的那些文件上运行测试`build/test-classes`。在您的示例中，您尝试针对源运行它们。

我将 Maven 标准用于我的目录布局。这意味着我的 Java 源代码位于`src/main/java`我的 JUnit Java 文件位于`src/test/java`. 任何需要的 XML 或属性或其他无源文件都存储在`src/main/resources`. 常规源代码编译为，`target/classes`而 Junit 源代码编译为`target/test-classes`.

这使得单独编译代码和测试代码变得容易，而无需担心目录编译`**/test/**`中`**/Test/**`的`**/JUnit/**`异常，因为一切都是分开的。

希望这可以帮助。

# python - 如果“this”是答案，请返回上一行

> ID：13790855
> 
> 赞同：4
> 
> 时间：2012-12-09T19:23:10.520
> 
> 标签：python, loops, input

我目前正在学习 Python，并且想知道一些事情。我正在写一个小文字冒险游戏，需要帮助：例如，如果我写，

```
example = input("Blah blah blah: ")
if example <= 20 and > 10:
    decision = raw_input("Are you sure this is your answer?: ") 
```

我可以编写哪些函数会导致 "example = input("Blah blah blah: ")" 再次运行？如果用户对“decision = raw_input(”你确定这是你的答案吗？：“)”说不。

对不起，如果我让大家感到困惑。我对 Python 和编程有点陌生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:24:18.440

您正在寻找一个`while`循环：

```
decision = "no"
while decision.lower() == "no":
    example = input("Blah blah blah: ")
    if 10 < example <= 20:
        decision = raw_input("Are you sure this is your answer?: ") 
```

循环重复运行代码块，直到条件不再成立。

我们在一开始就做出决定，以确保它至少运行一次。显然，您可能希望进行比`decision.lower() == "no"`.

另请注意您的条件的编辑，因为`if example <= 20 and > 10:`在语法上没有意义（超过 10 个？）。你大概想`if example <= 20 and example > 10:`，这可以浓缩成`10 < example <= 20`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-09T19:58:25.677

您可以使用一个调用自身的函数，直到输入有效：

```
def test():
   example = input("Blah blah blah: ")
   if example in range(10, 21): # if it is between 10 and 20; second argument is exclusive
      decision = raw_input("Are you sure this is your answer?: ")
      if decision == 'yes' or desicion == 'Yes':
         # code on what to do
      else: test()
   else: # it will keep calling this until the input becomes valid
      print "Invalid input. Try again."
      test() 
```

# java - 向大多数父树元素添加一个复选框？

> ID：13790858
> 
> 赞同：0
> 
> 时间：2012-12-09T19:23:20.447
> 
> 标签：java, gwt

我想向最上层的父树元素添加一个复选框小部件，如[http://www.smartclient.com/smartgwt/showcase/#tree_checkbox中所示](http://www.smartclient.com/smartgwt/showcase/#tree_checkbox)

我怎么能通过只使用 GWT 来做到这一点？我只发现我可以创建一个带有复选框的 Tree*Item* 并将其添加到 Tree 中：

```
TreeItem item = new TreeItem(new CheckBox("box")); 
```

但是我怎样才能为树本身创建一个盒子呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T02:57:31.710

您需要组装您自己的扩展 gwt Composite 类的小部件，并在其中包装一个 tree/celltree 、 flowpanels 和您喜欢添加的任何小部件，例如全选复选框。

您应该尝试使用基于单元格小部件的**CellTree** - [http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTree](http://gwt.googleusercontent.com/samples/Showcase/Showcase.html#!CwCellTree)

它更具可定制性并确保更好的性能。

# php - Kohana 模型在两列上具有唯一键

> ID：13790859
> 
> 赞同：0
> 
> 时间：2012-12-09T19:23:27.663
> 
> 标签：php, kohana, kohana-3

我有一个数据库，其中一个表在和`categories`上具有唯一键。当我在控制器中添加新类别时，它使用：`item_id``user_id`

```
$category = new Model_Category();
$category->item_id = $item_id;
$category->user_id = $user_id;
$category->save(); 
```

Kohana 3.2 返回“重复条目 '1-3' for key”错误。将它包装在 try/catch 中是更好的做法，还是在尝试添加之前检查唯一键是否已经存在更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:32:56.223

我建议尝试捕获，因为它使用较少的查询来检查重复键，但是这可能会限制您可以向用户显示的信息量，因为我不确定异常是否包含违反键的实际列，我认为它只是一个通用错误，所以如果你想实际检查两列中的哪一列给出了错误，你可能想在此之前使用查询。希望能帮助到你。仅供参考，我大部分时间都使用 try catch，它更干净且易于记录错误。

# windows - 如何在 Windows 8 上启用公开功能？

> ID：13790861
> 
> 赞同：4
> 
> 时间：2012-12-09T19:23:49.567
> 
> 标签：windows, desktop

前几天我正在用无线鼠标移动我的笔记本电脑。我不小心把鼠标掉了，我不知道点击了哪些按钮。然而，曝光功能（就像在 Mac 上一样）出现了，我真的印象深刻！我喜欢 Mac 并拥有一台，但内心深处仍然是一个 Windows 人。有人知道吗？我不是在谈论安装外部软件，我知道该功能已内置在 Windows 8 中，因为我亲眼目睹了它。在网上搜索暴露、提示和技巧一无所获。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T19:53:21.217

好吧，我想通了。我爱微软...这可能适用于任何支持三个按钮的外接鼠标。我正在使用带有三个按钮的无线 Microsoft USB 鼠标，中间支持滚动功能（一个滚轮）。如果我按住鼠标左键或右键，然后单击滚轮，就会出现曝光。我也可以放开两个按钮，这样如果我使用滚动，我可以选择我想要关注的应用程序（或者也只需单击你想要的应用程序）。我唯一没有想到的是，当这第一次发生时，应用程序在暴露中包围了我的桌面。这一次，它们只是显示为一个有组织的网格。webappguy-dot-com 的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T19:27:37.843

windows 8 没有像 mac 那样的原生“暴露”。尽管如此，网络上仍有软件可以做到这一点。

触发应用滚动做**alt+tab**

# ruby-on-rails - 正确使用 simple_form collection_check_boxes

> ID：13790864
> 
> 赞同：3
> 
> 时间：2012-12-09T19:23:55.667
> 
> 标签：ruby-on-rails, simple-form, model-associations

我设置了 2 个模型，如下所示：

```
class Sector < ActiveRecord::Base
  attr_accessible :summary, :title, :sector_ids

  belongs_to :platform
end 
```

和

```
class Platform < ActiveRecord::Base
attr_accessible :name, :url
    has_many :sectors
end 
```

以及尝试使用此处示例的表单，如下所示：

```
<%= simple_form_for @platform, :html => { :class => 'form-vertical'} do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <div class="row-fluid">
        <div class="span12">
            <div class="span6">
              <%=  field_set_tag "General" do %>
    <%= f.input :name %>
    <%= f.input :url %>
<%= f.collection_check_boxes :sector_ids, Sector.all, :title, :title %>

    <% end %>
</div>
</div>
</div>
  </div>

  <div class="form-actions">
    <%= f.button :submit %>
  </div>
<% end %> 
```

然而，在我尝试提交表单后，我收到以下错误：

无法批量分配受保护的属性：sector_ids

我在这里想念什么？在添加适当的关联后，我成功迁移了数据库，但似乎 Rails 不知道现在如何使用所选的扇区 ID。

**解决方案 ：**

```
class Sector < ActiveRecord::Base
  attr_accessible :summary, :title

  belongs_to :platforms
end 
```

和

```
class Platform < ActiveRecord::Base
attr_accessible :name, :url, :platform_attributes, :sector_ids
    has_many :sectors
end 
```

在视图中：

```
<%= f.association :sectors, :as => :check_boxes %> 
```

当然，不要忘记运行“ `rake db"migrate`”，以防你还没有完成。我还需要重新启动服务器才能应用更改。

我希望这可以帮助别人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T17:16:38.583

尝试将 { :sector_ids => [] } 添加到您的平台许可列表中。

[https://github.com/rails/strong_parameters#nested-parameters](https://github.com/rails/strong_parameters#nested-parameters)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:45:09.500

首先，我认为您应该从**Sector的****attr_accessible**中删除**:sectors_ids**并尝试。

 ****如果上述方法不起作用（可能不起作用），请参阅**simple_form**的文档，特别阅读[https://github.com/plataformatec/simple_form#associations](https://github.com/plataformatec/simple_form#associations)和[https://github.com/plataformatec/simple_form#collection -复选框](https://github.com/plataformatec/simple_form#collection-check-boxes)；最后一个实现了你想要做的事情，但是，在他们使用**has_and_belongs_to_many**关联的关联中。

最后，检查一下[https://github.com/plataformatec/simple_form/issues/341](https://github.com/plataformatec/simple_form/issues/341)

**更新** 解决方法是建立一个has_and_belongs_to_many关系，没有出路，因为，你想将一些扇区关联到一个平台，但是，你想将相同的扇区关联到其他平台，否则你不需要复选框，只需嵌套表单以不断添加新记录。您必须在数据库设计和结构中进行此更改。****

# php - CakePHP 多对一 - 单表

> ID：13790869
> 
> 赞同：1
> 
> 时间：2012-12-09T19:24:37.427
> 
> 标签：php, database, cakephp

我有一个成员表：成员（id，name，gender，head_id）

我想要的是建立基于户主（谁是成员）的家庭关系。就像这样：一个成员属于一个家庭（由成员定义）

也许我可以把它分成 2 个表，一个成员和家庭表：家庭（id，head_id）和成员表会有一个family_id而不是head_id。

主要问题是添加新成员和修改关系。

编辑：所有的答案都很棒。
我最终手动完成。Dave 的解决方案是我一直在寻找的，但并没有完全按照我希望的方式锻炼。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:40:55.203

请参阅[“同一模型的多个关系”](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#multiple-relations-to-the-same-model)

“也可以创建自我关联，如下所示：”

```
class Post extends AppModel {

    public $belongsTo = array(
        'Parent' => array(
            'className' => 'Post',
            'foreignKey' => 'parent_id'
        )
    );

    public $hasMany = array(
        'Children' => array(
            'className' => 'Post',
            'foreignKey' => 'parent_id'
        )
    );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T09:49:36.317

从数据库的角度来看，我认为您应该有 3 个表：

*   **人员**（身份证、护照号码、姓名、出生日期、...）
*   **家庭**（id、father_id、mother_id、surname、number_of_members、...）
*   **family_persons** (family_id, person_id)

一个家庭被定义为两个人的结合，并且可能有一些其他的共同领域，例如*姓氏。*

无论如何，如果您按照自己的方式进行操作，则只需一张桌子即可。（父亲`head_id`设置为 0，其他家庭成员`head_id`参考他的 id。

如果要使用两个表，控制器可以使用多个模型，因此在`save`操作中处理更多表不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T17:14:17.593

你应该有两张桌子。这是最好的方法，并且会在您的应用程序中为您提供最大的灵活性和易用性。

**数据库表**

```
// families

id | name
------------------------------
 1 | Smith
 2 | Jones
 3 | Davis  

// members table

id | family_id | name      | gender
-----------------------------------
 1 |     2     | James     |   M
 2 |     3     | Christine |   F
 3 |     1     | David     |   M
 4 |     2     | Mark      |   M
 5 |     1     | Simon     |   M
 6 |     1     | Lucy      |   F 
```

**CakePHP 模型**

然后，您只需要定义您的模型，以便它们具有正确的关系。

```
// app/Model/Family.php
class Family extends AppModel {

    public $hasMany = array('Member');
}

// app/Model/Member.php
class Member extends AppModel {

    public $belongsTo = array('Family');
} 
```

然后你可以像这样检索你的家人：

**CakePHP 控制器**

```
// Find all members that belong to Family 1
$family = $this->Member->find('all', array(
    'conditions' => array('family_id' => 1)
)); 
```

或者

```
// Find Family 1 and get all its members
$family = $this->Family->find('first', array(
    'conditions' => array('family_id' => 1),
    'contain' => array('Member')
)); 
```

您在添加新成员或修改关系方面应该没有任何问题，就像您担心的那样，但如果您遇到任何具体问题，我们可能会为您提供帮助。这种模型关系极为普遍。

# android - android报警管理器+任务调度

> ID：13790874
> 
> 赞同：1
> 
> 时间：2012-12-09T19:25:10.183
> 
> 标签：android, task, alarmmanager

我需要帮助。我是 android 编码的新手。

我已经制作了任务清单，我想在任务中写下具体的事情。

这是我的任务项目

```
private long id;
private int mon;
private int tues;
private int wednes;
private int thurs;
private int fri;
private int satur;
private int sun;
private int profile; 
```

我有几天（星期一，星期二等），其中包含分钟数（对于 10:00，它是 600）。

按照一些教程，我有警报接收器

```
public class AlarmReciever extends  BroadcastReceiver{
    @Override
    public void onReceive(Context context, Intent intent) {
        try {
            Bundle bundle = intent.getExtras();
            String message = bundle.getString("alarm_message");

            Intent newIntent = new Intent(context, AlarmActivity.class);
            newIntent.putExtra("profile", message);
            newIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            context.startActivity(newIntent);
        } catch (Exception e) {
            Toast.makeText(context, "There was an error somewhere, but we still received an alarm", Toast.LENGTH_SHORT).show();
            e.printStackTrace();

        }
} 
```

它仍然未经编辑...

然后有代码调用在警报管理器中执行新任务

```
// get a Calendar object with current time

Calendar cal = Calendar.getInstance();
 // add 5 minutes to the calendar object
 cal.add(Calendar.MINUTE, 5);
 Intent intent = new Intent(ctx, AlarmReceiver.class);
 intent.putExtra("alarm_message", "O'Doyle Rules!");
 // In reality, you would want to have a static variable for the request code instead of 192837
 PendingIntent sender = PendingIntent.getBroadcast(this, 192837, intent, PendingIntent.FLAG_UPDATE_CURRENT);

 // Get the AlarmManager service
 AlarmManager am = (AlarmManager) getSystemService(ALARM_SERVICE);
 am.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), sender); 
```

我不明白如何在日历中指定，我需要在每个星期一的 10:00 重复（例如）新任务，并且当这种情况发生时，它会调用新函数，并为其提供“配置文件”变量来使用。

```
 private void setProfile(Integer profile)
{
 // Doing things with profile
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-22T22:28:50.820

看看下面的代码：

```
 alarmMgr = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
    Intent intent2 = new Intent(context, SampleAlarmReceiver.class);
    alarmIntent = PendingIntent.getBroadcast(context, 0, intent2, 0);

    Calendar calendar = Calendar.getInstance();
    calendar.setTimeInMillis(System.currentTimeMillis());

    // Set the alarm's trigger time to item hour
    calendar.set(Calendar.HOUR_OF_DAY, NuevoItemActivity.hora.getCurrentHour());
    calendar.set(Calendar.MINUTE, NuevoItemActivity.hora.getCurrentMinute());

    // Set the alarm to fire , according to the device's clock, and to repeat once a day.
    alarmMgr.setInexactRepeating(AlarmManager.RTC_WAKEUP,  
            calendar.getTimeInMillis(), AlarmManager.INTERVAL_DAY, (PendingIntent) alarmIntent); 
```

正如您在最后一行中看到的，您可以指示`AlarmManager.INTERVAL_DAY`重复`PendingIntent`.

# grammar - 当语法应该期待它和其他时，Bison 会生成意外的标记

> ID：13790879
> 
> 赞同：0
> 
> 时间：2012-12-09T19:25:34.860
> 
> 标签：grammar, bison, yacc, flex-lexer

我正在为格式化语言编写编译器，并且正在编写野牛文件。我认为我的语法是正确的，但是当我添加递归规则然后读取测试源文件时，它说它接受结束标记的规则但令牌是意外的......但事情是在我添加之前递归规则（对于开始和结束标签之间的一些标签）它工作得很好......这里有一些细节

这是源文件

```
\begin{document}

\title{test}
\author{test}
\date{21/02/1985}
\pagesetup{35, 80}

\end{document} 
```

这是野牛文件

```
%{
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>

    extern int  yylex();
    extern int  yyparse();
    extern FILE *yyin;
    extern FILE *yyout;
    extern int  yylineno;

    void yyerror(const char*);
    int header_status(int,int,int,int,int);

    // counters to check nubmer or document properties used, must all become 1
    int title   = 0;
    int author  = 0;
    int date    = 0;
    int pgsetup = 0;
    int tabsz   = 0;
%}

%union{
    int     iVal;
    char*   sVal;
}

%error-verbose

%start source
%token <sVal> SLASH
%token <sVal> BLOCK_S BLOCK_E
%token <sVal> DOC LIST ENUM
%token <sVal> TITLE AUTHOR DATE PG_SETUP TAB_SZ SECTION PARAGRAPH ITEM LINE
%token <sVal> LBRACE RBRACE LPAREN RPAREN
%token <sVal> DOCUMENT DIMENSIONS DATE_VAL STRING
%token <iVal> NUMBER
%token <sVal> ERROR_UN ERROR_IL WORD

%%

source
    : /* empty */  
    | entry_point doc_properties txt_properties exit_point
        { 
            if ( header_status(title, author, date, pgsetup, tabsz) == 0 )
                printf("\nfail\n"); //YYABORT;
        }
    ;

entry_point
    : SLASH BLOCK_S LBRACE DOC RBRACE 
    ;

doc_properties
    : /* empty */  
    | doc_properties header_properties
    ;

header_properties
    : title_property    { title++; }
    | author_property   { author++; }
    | date_property     { date++; }
    | pg_setup_property { pgsetup++; }
    | tab_sz_property   { tabsz++; }
    ;

txt_properties
    : /* empty */  
    ;

title_property
    : SLASH TITLE LBRACE STRING RBRACE
    ;

author_property
    : SLASH AUTHOR LBRACE STRING RBRACE
    ;

date_property
    : SLASH DATE LBRACE DATE_VAL RBRACE
    ;

pg_setup_property
    : SLASH PG_SETUP LBRACE DIMENSIONS RBRACE
    ;

tab_sz_property
    : SLASH TAB_SZ LPAREN NUMBER RPAREN
    ;

exit_point
    : SLASH BLOCK_E LBRACE DOC RBRACE
    ;

%%

int main (int argc, char* argv[])
{
    if ( argc < 2 || argc > 3)
    {
        fprintf(stdout, "%s: fatal error: needs one or two arguments\n\n\t%s inputFileName [outputFileName]\n\n", argv[0], argv[0]);
    }
    else if ( argc == 2 )
    {
        char* fn = (char *)calloc(strlen(argv[1])+12, sizeof(char));
        strcpy(fn, argv[1]);
        strcat(fn, ".output.txt");
        fprintf(stderr, "%s: using default output naming: <%s>\n\n", argv[0], fn);

        yyin = fopen(argv[1], "r");
        yyout = fopen(fn, "w");     
        yyparse();
        fclose(yyin);
        fclose(yyout);
    }
    else if ( argc == 3 )
    {
        yyin = fopen(argv[1], "r");
        yyout = fopen(argv[2], "w");        
        yyparse();
        fclose(yyin);
        fclose(yyout);
    }
    return 0;
}

void yyerror(const char* str) 
{
    fprintf(stderr,"syntax error[%d]: %s\n",yylineno, str);
}

int header_status(int title, int author, int date, int pgsetup, int tabsz)
{
    if ( title == 1 && author == 1 && date == 1 && pgsetup == 1 && tabsz == 1 )
    {
        return 1;
    }
    else
    {
        if ( title > 1 ) fprintf(stderr,"syntax error: title property was declared more than once\n");
        else if ( title < 1 ) fprintf(stderr,"syntax error: title property was not declared (all document properties must be present)\n");

        if ( author > 1 ) fprintf(stderr,"syntax error: author property was declared more than once\n");
        else if ( author < 1 ) fprintf(stderr,"syntax error: author property was not declared (all document properties must be present)\n");

        if ( date > 1 ) fprintf(stderr,"syntax error: date property was declared more than once\n");
        else if ( date < 1 ) fprintf(stderr,"syntax error: date property was not declared (all document properties must be present)\n");

        if ( pgsetup > 1 ) fprintf(stderr,"syntax error: pagesetup property was declared more than once\n");
        else if ( pgsetup < 1 ) fprintf(stderr,"syntax error: pagesetup property was not declared (all document properties must be present)\n");

        if ( tabsz > 1 ) fprintf(stderr,"syntax error: title tabsize was declared more than once\n");
        else if ( tabsz < 1 ) fprintf(stderr,"syntax error: title tabsize was not declared (all document properties must be present)\n");

        return 0;
    }
} 
```

我认为我的问题在于

```
doc_properties
: /* empty */  
| doc_properties header_properties
; 
```

当我空空如也的时候

```
\begin{document}
\end{document} 
```

对于源文件来说很好。具体来说，令牌将是

```
SLASH BLOCK_S LBRACE DOC RBRACE 
SLASH BLOCK_E LBRACE DOC RBRACE 
```

当我添加带有递归的规则时，虽然当它到达“结束”时，跟踪会说它接受了规则（词法），然后它生成了一个语法错误“意外的 BLOCK_E”。我唯一能想到的是它期待一些其他标签，但在递归中我有空作为替代，所以为什么......

另外，当我添加最终标签时

```
\begin{document}

\title{test}
\author{test}
\date{21/02/1985}
\pagesetup{35, 80}
\tabsize(4)

\end{document} 
```

当它到达 4 时，它表示接受 lex 文件中的规则和该规则

```
return NUMBER; 
```

但它说出乎意料的$undefined，当它刚刚说它接受规则时期待NUMBER，坦率地说我不认为它可以读取任何其他内容......

我的问题是第一部分...

如果有任何帮助，这是 flex 文件

```
%{
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>
    #include "UnicTextLang.y.tab.h"

    #define SAVE_S yylval.sVal = strdup(yytext)
    #define SAVE_I yylval.iVal = atoi(yytext)   
%}

WS      [ \t\n\r]
TAG     [a-zA-Z_][a-zA-Z0-9\-_]+
WORD    [a-zA-Z0-9`~!@#$%\^&*()\-_=+[\]{}\\|;:'",<.>/?]
NUMBER  ([1-9])|([1-9][0-9])|([1-3][0-9][0-9])
DIMEN   {NUMBER}{WS}*,{WS}*{NUMBER}
DAY     (0[1-9])|([12][0-9])|(3[01])
MONTH   (0[1-9])|(1[0-2])
YEAR    (19|20)[0-9]{2}
DATE    {DAY}\/{MONTH}\/{YEAR}

%option yylineno
%option noyywrap
%option noinput
%option nounput
%option debug

%x PROPERTY
%x VALUE
%x BLOCK
%x NUMBER

%%

^\\|{WS}\\                  { BEGIN(PROPERTY); /* fprintf(stdout, "FLEX> BEGINING PROPERTY [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return SLASH; }
{WS}?\{                     { BEGIN(VALUE); /* fprintf(stdout, "FLEX> READING PROPERTY VALUE [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return LBRACE; }
{WS}?\(                     { BEGIN(NUMBER); /* fprintf(stdout, "FLEX> READING NUMBER VALUE [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return LPAREN; }
{WS}                        { /* fprintf(stdout, "FLEX> EATING WHITESPACE(i)\n"); */ }
[^ \t\n\r\{(\\][^ \t\n\r]+  { fprintf(stderr, "lexical error[%d]: hingeless word: %s\n", yylineno, yytext); SAVE_S; return WORD; }
.                           { fprintf(stderr, "lexical error[%d]: illegal character detected: %s\n", yylineno, yytext); SAVE_S; return ERROR_IL; }

<PROPERTY>begin             { BEGIN(BLOCK); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return BLOCK_S; }
<PROPERTY>end               { BEGIN(BLOCK); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return BLOCK_E; }

<PROPERTY>title             { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return TITLE; }
<PROPERTY>author            { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return AUTHOR; }
<PROPERTY>date              { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return DATE; }
<PROPERTY>pagesetup         { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return PG_SETUP; }
<PROPERTY>tabsize           { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return TAB_SZ; }

<PROPERTY>section           { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return SECTION; }
<PROPERTY>paragraph         { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return PARAGRAPH; }
<PROPERTY>item              { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return ITEM; }
<PROPERTY>newline           { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> \n\t%s\n\n", yytext); */ SAVE_S; return LINE; }

<PROPERTY>{TAG}             { BEGIN(INITIAL); fprintf(stderr, "lexical error[%d]: |%s| undefined property: expecting property\n", yylineno, yytext); SAVE_S; return ERROR_UN; }
<PROPERTY>{WS}              { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> EATING WHITESPACE(p)\n"); */ }
<PROPERTY>[^ \t\n\r\{(]+    { BEGIN(INITIAL); fprintf(stderr, "lexical error[%d]: |%s| undefined property: illegal character detected\n", yylineno, yytext); SAVE_S; return ERROR_IL; }
<PROPERTY>.                 { fprintf(stderr, "lexical error[%d]: illegal character detected: %s\n", yylineno, yytext); SAVE_S; return ERROR_IL; }

<VALUE>{WS}*{DIMEN}{WS}*    { /* fprintf(stdout, "FLEX> \n\tdims: %s\n\n", yytext); */ SAVE_S; return DIMENSIONS; }
<VALUE>{WS}*{DATE}{WS}*     { /* fprintf(stdout, "FLEX> \n\tdate: %s\n\n", yytext); */ SAVE_S; return DATE_VAL; }
<VALUE>[^}]*                { /* fprintf(stdout, "FLEX> \n\tstrg: %s\n\n", yytext); */ SAVE_S; return STRING; }
<VALUE>\}                   { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> FINISHED READING PROPERTY VALUE [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return RBRACE; }
<VALUE>.                    { fprintf(stderr, "lexical error[%d]: illegal character detected: %s\n", yylineno, yytext); SAVE_S; return ERROR_IL; }

<NUMBER>{WS}*{NUMBER}{WS}*  { /* fprintf(stdout, "FLEX> \n\tnumb: %s\n\n", yytext); */ SAVE_I; return NUMBER; }
<NUMBER>[^)]*               { fprintf(stderr, "lexical error[%d]: |%s| illegal value: expecting number(1-399)\n", yylineno, yytext); SAVE_S; return STRING; }
<NUMBER>\)                  { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> FINISHED READING NUMBER VALUE [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return RPAREN; }
<NUMBER>.                   { fprintf(stderr, "lexical error[%d]: illegal character detected: %s\n", yylineno, yytext); SAVE_S; return ERROR_IL; }

<BLOCK>{WS}?\{              { /* fprintf(stdout, "FLEX> READING BLOCK TYPE [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return LBRACE; }
<BLOCK>{WS}*document{WS}*   { /* fprintf(stdout, "FLEX> \n\tresv: %s\n\n", yytext); */ SAVE_S; return DOC; }
<BLOCK>{WS}*itemize{WS}*    { /* fprintf(stdout, "FLEX> \n\tresv: %s\n\n", yytext); */ SAVE_S; return LIST; }
<BLOCK>{WS}*enumerate{WS}*  { /* fprintf(stdout, "FLEX> \n\tresv: %s\n\n", yytext); */ SAVE_S; return ENUM; }
<BLOCK>[^{}]*               { fprintf(stderr, "lexical error[%d]: |%s| undefined block type: expecting block type\n", yylineno, yytext); SAVE_S; return ERROR_UN; }
<BLOCK>\}                   { BEGIN(INITIAL); /* fprintf(stdout, "FLEX> FINISHED READING BLOCK TYPE [%d]: %s|\n", yylineno, yytext); */ SAVE_S; return RBRACE;}
<BLOCK>.                    { fprintf(stderr, "lexical error[%d]: illegal character detected: %s\n", yylineno, yytext); SAVE_S; return ERROR_IL; }

%% 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T20:42:40.203

您遇到的基本问题是解析器需要两个令牌前瞻来确定`doc_properties`结束的位置。这是因为您将其识别为`'\'`与属性字符串分开的标记，因此在看到`SLASH BLOCK_S`下一个输入标记为的输入后`SLASH`，它不知道是否应该减少一个空值`txt_properties`（在预期匹配标头属性。`BLOCK_E``SLASH``header_properties`

有很多方法可以解决这个问题。也许最简单的方法是完全摆脱`SLASH`标记，因为它只是告诉词法分析器何时查找属性字符串。删除`return SLASH;`第一个 lex 操作中的语句（因此它不返回标记，而是继续寻找`\`返回该标记之后的属性），并删除`SLASH`它出现在语法中的所有位置。

另一种可能性是对语法进行分解以摆脱 epsilon 规则（因为它们是导致移位/减少冲突的早期减少所必需的）。在没有 epsilon 规则的情况下，解析器可以转换到复合状态，在这种状态下它同时识别 RHS 上具有相同前缀的多个规则（这种能力是 LR 解析优于 LL 的优势）。为此，您将有如下规则：

```
source: /* empty */
      | entry_point exit_point
      | entry_point doc_properties exit_point
      | entry_point txt_properties exit_point
      | entry_point doc_properties txt_properties exit_point
      ; 
```

并且会改变`doc_properties`并`txt_properties`识别 1 个或多个而不是 0 个或多个：

```
doc_properties: header_property
              | doc_properties header_property
              ; 
```

# parsing - BISON中用于解析的基本问题

> ID：13790881
> 
> 赞同：1
> 
> 时间：2012-12-09T19:25:45.990
> 
> 标签：parsing, bison

我是野牛新手，如果您能帮助我，我有一些基本问题：

1.  以下哪一项是正确的：

    ```
    %left ’*’ ’/’ 
    ```

    或者

    ```
    %left '*' '/' 
    ```

    这意味着我没有获取令牌，而是使用它在解析器文件中定义它

2.  我可以定义这样的规则：

    ```
    EXP -> EXP "and" EXP 
    ```

    代替

    ```
    EXP -> EXP AND EXP //AND here is a token 
    ```

3.  如果我有用于构建解析器的 LEX 和 BISON 文件，哪个应该包含另一个，如果我使用了一个公共头文件，应该在其中一个文件中定义文件？

4.  如果 BISON 算法根据其中一条规则找到匹配项，首先会发生什么，它会进行 reduce，然后执行为匹配的规则定义的操作，或者首先执行操作，然后将 reduce 放入堆栈？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T20:05:47.900

1.  由于您的格式，很难说出您在问什么，但认为答案是否定的。 `%left`只定义一个令牌（完全一样`%token`），另外设置该令牌的优先级。您仍然必须通过在词法分析器中识别它并返回适当的令牌值来“获取”令牌。

2.  虽然您可以使用`"and"`，但您不想这样做，因为它几乎不可能正确。`AND`使用或`and`（无引号）要好得多。`#define`不同之处在于，使用引号会创建一个不会在文件中输出为 a 的标记`.tab.h`，因此没有简单的方法可以在您的词法分析器中生成该标记。

3.  有很多方法可以做到这一点。最简单的方法是不包含另一个并且让 lex 文件包含由野牛`-d`标志生成的标头 - 这是大多数示例所做的。也可以直接将文件包含在`lex.yy.c`文件的第三部分`.y`或包含`.tab.c`在文件的顶部`.l`（但不能同时包含两者！）在这种情况下，您只会编译一个文件。

4.  它首先执行规则的操作（因此在执行操作时 RHS 上的项目的值可用），然后进行堆栈缩减，用操作 put int 的值替换 RHS 项目`$$`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T08:02:37.140

我在第 2 点上有点不同意 Chris。最好使用它，`"and"`因为在错误消息中解析器将报告关于`"and"`而不是关于`TOK_AND`或`t_AND`肯定对用户没有意义的事情。

把它做好并不难：只要你插入

```
%token TOK_AND "and" 
```

在某处，您可以使用其中一个`"and"`或`TOK_AND`在语法文件中使用。但是，恕我直言，前者更清楚。

# jquery - 检查输入值 > 0 jQuery 咖啡

> ID：13790885
> 
> 赞同：2
> 
> 时间：2012-12-09T19:25:55.660
> 
> 标签：jquery, if-statement, coffeescript

我想做一个简单的检查，检查我的一个表单上的输入字段是否输入了文本，如果它不执行任何操作，它是否确实将进度指示器移向 16。

显然我在这里遗漏了一些简单的东西，但我不应该在这里检查 val 是否大于 1 吗？

这里是咖啡——

```
jQuery ->
    $("#user_first_name").blur (event) ->
      if $(this).val > 1
        setInterval (->
            front_index_gage.refresh 16
            ), 500
      else 
```

这是我的咖啡语法错误吗？

=======更新=============

在确保第一次现场检查有效之后，这似乎不是最优雅的解决方案，因为这是我要走的路

```
jQuery ->
    $("#user_first_name").blur (event) ->
      if $(this).val().length > 1
        setInterval (->
            front_index_gage.refresh 16
            ), 500
      else
jQuery ->
    $("#user_last_name").blur (event) ->
      if $(this).val().length > 1
        setInterval (->
            front_index_gage.refresh 33
            ), 500
      else
        setInterval (->
            front_index_gage.refresh 16
            ), 500 
```

使用 6 个表单字段来检查对 js 和咖啡来说相当新的内容，但这是我会使用 switch 条件来检查和刷新进度指示器的情况吗？

再次感谢您的关注

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:28:48.440

`.val()`对于不想向其传递任何参数的函数，您需要括号。

像这样应该工作。

```
if $(this).val() > 1 
```

否则`.val`试图`> 1`用作参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:29:03.620

“已输入文本”表示“值中有一个或多个字符”，即“*长度*> 0”。您正在比较价值本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T19:29:15.863

`.val`这是一个函数，所以你应该解决这个问题：

```
if $(this).val() > 1 
```

# r - 按名称将变量传递到赋值的右侧：= data.table

> ID：13790891
> 
> 赞同：1
> 
> 时间：2012-12-09T19:26:59.470
> 
> 标签：r, data.table

我想按名称将变量传递给 data.table X，如下所示：

```
myfunc <- function(varname){
  X[, newVar:= varname]
}
myfunc("oldVar") 
```

我应该怎么做？我试过`quote()`了`eval()`，但没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:33:23.747

将列查找为向量，并将其用于分配：

```
myfunc <- function(varname){
  X[, newVar := X[[varname]]]
}

X <- data.table(oldVar=1:4, b=5:8)

> myfunc("oldVar")
   oldVar b newVar
1:      1 5      1
2:      2 6      2
3:      3 7      3
4:      4 8      4 
```

# command-line - 如何从命令行锁定 Perforce 标签？

> ID：13790892
> 
> 赞同：3
> 
> 时间：2012-12-09T19:27:09.763
> 
> 标签：command-line, locking, perforce, labels

我最近将一个 VSS 存储库导入 Perforce。这包括数百个标签，使用 VSS（现在使用 Perforce）的开发人员依赖这些标签。我不小心删除了它们，不得不再次导入。为了防止将来发生这种意外删除，我想锁定所有标签，但是通过 P4V 这样做会很耗时。我想写一个脚本来为我做这件事。

我可以使用`p4 labels`命令将所有标签放入一个文本文件中，并且通过一些文本编辑器宏处理，我可以构建一个脚本来锁定它们。我只需要知道执行此操作的命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T18:32:23.563

这可以通过自动编辑标签规范的过程来完成。过程如下：

*   使用 -o 开关将标签规范发送到标准输出。
*   将该输出传送到可以操作它并将标签的“选项”设置为“锁定”的实用程序。在这种情况下，Unix 实用程序[sed](http://www.gnu.org/software/sed)完成了工作。（我在 Windows 上，所以我使用[了这个端口](http://sourceforge.net/projects/gnuwin32/?source=dlp)。其他可以在[这个答案](https://stackoverflow.com/a/127567/4228)中找到。）
*   使用 -i 开关将此更新后的规范返回到标签命令中。

把它们放在一起，你会得到一个看起来像这样的命令。

`p4 label -o <label name> | sed 's/^Options:.*/Options: locked/' | p4 label -i`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:41:13.220

相关的 Perforce 文档在[这里](http://www.perforce.com/perforce/doc.current/manuals/cmdref/label.html)。

要将标签规范转储到标准输出：

```
p4 -o *labelname* 
```

从标准输入读取标签规范：

```
p4 -i *labelname* 
```

在这两者之间，您需要处理文本以包含“选项：锁定”，可能通过将标准输出重定向到文本文件，例如（“p4 -o *labelname* > labelspect.txt”），以您选择的方式处理文本文件，然后将文件读入标准（'p4 -i *labelname* < labelspect.txt'）

# append - jsoup的正确使用

> ID：13790900
> 
> 赞同：0
> 
> 时间：2012-12-09T19:27:43.180
> 
> 标签：append, jsoup, attr

最近开始研究jsoup的使用方法

```
Document doc = Jsoup.parse(responseString); 
 Elements pngs = doc.select ("div.kk2"); 
```

用jsoup做了一个网页放图片的例子我

```
<div class="kk2" id="12" style="border:2px solid #FFFF00; top:-1px; left:-203px; height:151px; width:200px"> <img src = "http:// kk.org / t / ea / ff.jpg "alt =" text "style =" fff "/> </ div> 
```

筛选示例后

```
 for(Element png : pngs){
              sff2.append(png.attr("abs:href")).append("  ").append(png.text()).append("\n");
          } 
```

获取该值

```
init ~ kk.org ~ t / ea / ff.jpg ~ text 
```

如果我只是想得到这个值

```
http://kk.org/t/ea/ff.jpg 
```

我该怎么做？？我尝试使用

```
sff2.append (png.attr ("alt")). append (""). append (png.text ()). append ("\ n"); 
```

但没有成功

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T12:46:00.760

如果我理解正确，您只是想获取图像的地址？
如果是这样，这应该这样做。

```
Elements div = doc.select("div[class=kk2]");
Elements pngs = div.select("img");

for (Element png : pngs) {
        String src = png.attr("abs:src");
        src = src.replace(" ", ""); // Remove spaces
        System.out.println(src);
} 
```

# android - 在 Mono for Android 中添加 Google Maps API v2

> ID：13790908
> 
> 赞同：7
> 
> 时间：2012-12-09T19:28:05.833
> 
> 标签：android, google-maps, mono, xamarin.android, google-maps-api-2

适用于 Android 的 Google Maps API v2 于 12 月 3 日发布。

有没有可能将它添加到 Android 的 Mono 中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-17T22:48:37.620

我尝试了 TheNextman 建议的指南，但无法使其工作，所以几个小时后，我设法使用以下步骤使其工作：

1.  [从Xamarin 的 Github 页面](https://github.com/xamarin/monodroid-samples)下载最新的示例项目。

2.  在 MonoDevelop 上打开 monodroid-samples\MapsAndLocationDemo_v2\MapsAndLocationDemo.sln

3.  打开 Android SDK Manager 并从 Extras 部分下载“Google Play Services”

4.  复制 \extras\google\google_play_services\libproject\google-play-services_lib 到 monodroid-samples\MapsAndLocationDemo_v2\

5.  打开命令提示符并 cd 到 monodroid-samples\MapsAndLocationDemo_v2\google-play-services_lib

6.  键入以下两个命令：

    安卓更新项目-p。

    蚂蚁调试

7.  现在在 MonoDevelop 上将文件 google-play-services_lib/project.properties 作为链接文件添加到 GooglePlayServices 项目中

8.  现在创建一个[Google Maps API 密钥](https://developers.google.com/maps/documentation/android/start#the_google_maps_api_key)。不过要记住两件事：

    使用 MonoDroid 时调试密钥库的默认位置是：

    Windows Vista / Windows 7 / Windows 8: C:\Users[USERNAME]\AppData\Local\Xamarin\Mono for Android\debug.keystore OSX : /Users/[USERNAME]/.local/share/Xamarin/Mono for Android/调试密钥库

    您可以在清单标记中的 MapsAndLocationDemo/Properties/AndroidManifest.xml 文件中找到包名称。

9.  如果您要部署到真实设备，那就是全部，如果您要在模拟器上部署，请继续阅读

10.  使用此设置创建一个新的 AVD： 平台：4.1.2 CPU：ARM 保留其余参数的默认选项

11.  从真实设备中获取 vending.apk (com.android.vending.apk) 和 gms.apk (com.google.android.gms.apk)（查看本文末尾以获取更多详细信息）

12.  启动您刚刚创建的模拟器，然后打开命令提示符并 cd 到您下载 APK 的文件夹

13.  类型：

    adb -e 安装 vending.apk adb -e 安装 gms.apk

14.  享受！

资料来源：

(1) [https://github.com/xamarin/monodroid-samples/tree/master/MapsAndLocationDemo_v2](https://github.com/xamarin/monodroid-samples/tree/master/MapsAndLocationDemo_v2)

(2)[除非您更新 Google Play 服务（通过 Bazaar），否则此应用程序不会运行](https://stackoverflow.com/questions/13691943/this-app-wont-run-unless-you-update-google-play-services-via-bazaar) 检查 danbrough 的评论。如果可能，从有根设备中提取两个 APK com.android.vending 和 com.google.android.gms 以获取库的更新版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T21:42:15.000

对于那些使用 Mac 的人，有[一个 bash 脚本](https://github.com/xamarin/monodroid-samples/blob/master/MapsAndLocationDemo_v2/add_play_services.sh)会负责为您构建 Google Play 服务客户端。它确实假定您已设置环境变量`$ANDROID_HOME`（Android SDK 的路径）并安装了 Apache Ant。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T14:31:05.647

这是一个很好的指南，可以让这个工作：[使用新的谷歌地图和 Mono for Android](http://blog.neteril.org/blog/2012/12/10/using-the-new-google-maps-with-mono-for-android/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-11T11:34:50.483

关于jucas评论

> 尝试直接引用dll而不是项目，有时VS在从项目链接时找不到类型。您应该在 Google Services 库项目的 bin 文件夹中找到该 dll

对我来说，删除对 Mono.Android 的引用然后添加对 GooglePlayServices 的项目引用和对 Mono.Android 的引用会有所帮助。我不知道为什么它有效，但它确实有效。

# delphi - 如何显示进度条？

> ID：13790917
> 
> 赞同：1
> 
> 时间：2012-12-09T19:29:38.330
> 
> 标签：delphi, progress-bar, delphi-7

我创建了一个隐写术（在位图中隐藏文本）应用程序，我想添加一个进度条来显示该过程的工作时间。

```
procedure TForm1.Button2Click(Sender: TObject);
var
   x,y,i,currentBit,bitInChar,currentChar,currentPixel,newPixelValue,pixelsToSkip,skippedPixels: integer;
   pixels: PByteArray;
   bmp: TBitmap;
   stringToHide: string;
begin
if Image1.Picture.Bitmap=nil then
showmessage('gambar belum dipilih')
else
   memo1.lines.clear;
   stringToHide := AntiKeyLoggerMemo1.text;

   stringToHide:= stringToHide + chr(terminator); // add terminator to indicate end of text
   Image2.Picture.Assign(Image1.Picture.Bitmap);
   bmp := Image2.Picture.Bitmap;
   x := 0;
   y := 0;
   pixels := bmp.ScanLine[y];

   // iterate over the chars in the string we want to hide
   for i := 1 to length(stringToHide) do
   begin
      currentChar := ord(stringToHide[i]);
      memo1.lines.append('');
      memo1.lines.append('Sembunyikan ' + stringToHide[i] + ' - Ascii ' + inttostr(currentChar) + ' (biner ' + toBinary(currentChar) + ')');
      // iterate over the bits in the current char
      for currentBit := 7 downto 0 do
      begin
         begin
            if (i = 1) and (currentBit = 7) then
               pixelsToSkip := 0
            else
               pixelsToSkip := 1;
         end;
         for skippedPixels := 1 to pixelsToSkip do
         begin
            inc(x);
            if x = bmp.width then
            begin
               x := 0;
               inc(y);
               if (y = bmp.height) and (i < length(stringToHide)) then raise Exception.create('gambar terlalu kecil');
               pixels := bmp.ScanLine[y];
            end;
         end;
         bitInChar := getBit(currentChar, currentBit);
         // get the value of the pixel at x,y
         currentPixel := pixels[x];
         // set the least significant bit of the pixel to the bit we read from the char
         newPixelValue := setBit(currentPixel, 0, bitInChar);
         pixels[x] := newPixelValue;
         memo1.lines.append('Bit karakter ' + inttostr(currentBit) + '=' + inttostr(bitInChar) +
            ', pixel ke ' + inttostr(x) + ',' + inttostr(y) + ' desimal ' + inttostr(currentPixel) + ' (biner ' + toBinary(currentPixel) + ') ' +
            ' desimal baru ' + inttostr(newPixelValue) + ' (biner ' + toBinary(newPixelValue) + ')');

            end;
         end;
   memo1.lines.append('All done!');
   Button4.Enabled :=True;
   Button2.Enabled:=False ;
   Button5.Enabled:=True;
   Button1.Enabled:=False;
   AntiKeyLoggerMemo1.ReadOnly:=True;
     end; 
```

如何为该过程制作进度条？我必须把命令进度条放在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-09T19:38:26.767

首先，您需要将代码移动到它自己的线程中。否则 GUI 将不会响应。您还必须确保代码是线程安全的。

无论如何，在线程内部，您需要不时更新进度条。如果碰巧你有一个外循环和一个内循环，其中外循环每秒迭代一次左右，你可以更新那个地方的进度条。如果您只有一个大循环，您可能不想在每次迭代时更新进度条；例如，一次迭代可能仅在几毫秒内完成。

相反，您可以确保每秒更新一次进度条，左右。为此，您可以使用`GetTickCount`：

```
tc := GetTickCount;
if Terminated then Exit;
if tc - oldtc > 1000 then
begin
  PostMessage(FProgressBarHandle, PBM_SETPOS, TheNewPosition, 0);
  oldtc := tc;
end; 
```

这也显示了一种更新进度条的方法——只需发布一条消息！您还可以定义自己的消息并将其发送到主要来源。

# c# - 尝试 Response.Redirect 的正确方法是什么？

> ID：13790921
> 
> 赞同：1
> 
> 时间：2012-12-09T19:29:52.153
> 
> 标签：c#, asp.net, .net, html

我想重定向到一个 url，但如果它失败了会被通知。

据我所知，一个简单的 try-catch 块在这里不起作用，因为重定向*总是*抛出异常。虽然我可以检查该异常（ThreadAbortException），但这是最好的方法吗？

编辑：我正在尝试重定向到某个 url，如果它不存在 - 到另一个 url。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T20:23:55.450

由于重定向是客户端操作（服务器只是发送带有代码 302 的响应并将标头`location`设置为重定向目标），因此您不能指望服务器端`Request.Redirect`调用会在客户端上成功重定向（或者即使它会被遵循）给您任何指示。

您的选择：

*   就这样生活
*   如果重定向是本地的，您至少可以验证本地路径是否存在（或者如果 ysing MVC - 如果定义了具有给定参数的路由）。
*   如果重定向是远程的，您可以尝试先在服务器上发出请求，看看响应是否合理（如“不是 404”）。

不幸的是，所有用于查看目标页面是否存在的服务器端选项都有严重的缺点：

*   检查 Url 操作可能很慢
*   您将不会将身份验证信息/厨师传递到远程位置的页面
*   一些服务器以 200 响应“页面确实不存在，请看其他地方”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:40:08.927

我不认为这段代码会获奖，但这至少可以防止 ThreadAbortException ......

受[知识库文章启发](http://support.microsoft.com/kb/312629)

```
bool redirectOK = false;
try
{
  Repsonse.Redirect(url, false);
  redirectOK = true;
}
catch(Exception exp)
{
   // log/handle/whatever
}
if (redirectOK)
{
 // do what even you want for a serverside succeeded redirect
}
else
{
  // do what ever you want for a failure to redirect
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T04:24:10.370

好吧，这将检查 404 错误，如果没有错误则直接进入页面。

```
if URLExists(theURL){
Response.Redirect(theUrl);
}
else{
//redirect somewhere else
}

public static bool UrlExists(string url)
        {
            try
            {
                if (url == "")
                {
                    return false;
                }
                else
                {
                    new System.Net.WebClient().DownloadData(url);
                    return true;
                }
            }
            catch (System.Net.WebException e)
            {
                try
                {
                    if (((System.Net.HttpWebResponse)e.Response).StatusCode == System.Net.HttpStatusCode.NotFound)
                        return false;
                    else
                        throw;
                }
                catch
                {
                    return false;
                }
            }
        } 
```

# javascript - 贝塞尔手柄保持半径和对称，但不保持长度

> ID：13790923
> 
> 赞同：0
> 
> 时间：2012-12-09T19:29:59.873
> 
> 标签：javascript, bezier

我在用一些贝塞尔曲线构建的 Javascript 中有一个贝塞尔曲线。我可以移动手柄，它们保持对称。我通过首先计算贝塞尔曲线上的手柄和点之间的距离来做到这一点。然后我比较两个手柄的距离，计算一个乘数并将其应用于未拖动的手柄。这适用于保持对称。

但我想实现未拖动手柄的长度保持不变。

[http://cl.ly/image/0c1z00131m2y](http://cl.ly/image/0c1z00131m2y)（一张小图解释我的意思）。

我目前用来计算运动的代码是这样的：

```
 dx = Math.abs(drag.x - point.p[(draggedItemIndex)/2].x);
    dy = Math.abs(drag.y - point.p[(draggedItemIndex)/2].y);
    dx2 = Math.abs(point.cp[draggedItemIndex-1].x - point.p[draggedItemIndex/2].x);
    dy2 = Math.abs(point.cp[draggedItemIndex-1].y - point.p[draggedItemIndex/2].y);

    dxdx = dx2/dx;
    dydy = dy2/dy;

    point.cp[draggedItemIndex-1].x -= dragX*dxdx;
    point.cp[draggedItemIndex-1].y -= dragY*dydy; 
```

谢谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T15:03:43.657

我现在用循环计算来做。

```
 //Circle Center Point
                cx = point.p[(draggedItemIndex)/2].x;
                cy = point.p[(draggedItemIndex)/2].y;

                //Dragged Point Position (To Circle Origin)
                x1 = drag.x - cx;
                y1 = drag.y - cy;

                //Mirrored Point Position (To Circle Origin)
                x2 = point.cp[draggedItemIndex-1].x - cx;
                y2 = point.cp[draggedItemIndex-1].y - cy;

                //Angle Dragged Point
                a1 = Math.atan2(-y1,x1)*(180/Math.PI);

                //Mirrored Angle
                a2 = (a1-180)*(Math.PI/180)*(-1);

                //Mirrored Point Radius
                r = Math.sqrt(Math.pow(x2, 2)+Math.pow(y2, 2));

                //Apply new Position to Point
                point.cp[draggedItemIndex-1].x = cx + r * Math.cos(a2);
                point.cp[draggedItemIndex-1].y = cy + r * Math.sin(a2); 
```

# php - 如何每天轮换报价

> ID：13790924
> 
> 赞同：0
> 
> 时间：2012-12-09T19:30:02.193
> 
> 标签：php, mysql

这不是一个特定于编程的问题，而是一个普遍的问题：

我的数据库中有几个引号。我可以随时添加更多引号，但想法是这样的：

每天都会显示一个新报价，之后的第二天会显示下一个报价。当达到报价的“限制”时，会显示第一个报价，让您始终在您的网站上获得报价。

我该怎么做？

我知道需要进行检查，例如“如果昨天显示了报价，则显示新报价，并且如果昨天的报价也是数据库中的最新报价，则从第一个报价开始”。我完全不知道如何开始，所以非常感谢您的帮助！

我正在使用 PHP 和 MySQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:41:09.383

```
function get_daily_quote(){
    $q = floor(time()/86400);  // will produce a number
    $n = 100; // num of quotes - you can count the quotes in the database or something
    $res = mysql_query('SELECT * FROM `quotes` ORDER BY `id` ASC LIMIT '.($q%$n).', 1');
    return mysql_fetch_assoc($res);
} 
```

或者使用 pdo 代替 mysql 的旧函数，但你明白了......

**编辑**

只是为了解释一下 - $q 总是比前一天进步 1。从表中获取报价元组时，$q % $n 将是最重要的。我们将按 ID 排序以保持结果的顺序相同，ID 将是自动递增的主键。这应该可以解决问题。

当然，如果你想要性能，你可以将它保存到一个文件中并每天运行一次来​​更新它，这样你就不需要查询数据库了。

**编辑** 固定 $q

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:56:00.470

Galchens awnser 应该覆盖它，但是如果您添加或删除引号，您将获得两次相同的引号。

更好的方法是每天绘制一个随机报价（使用 cronjob）

```
SELECT * FROM Quotes ORDER BY RAND() LIMIT 1 
```

添加 2 个字段，used 和 today（枚举 0,1 或 int 1） set today = 1 表示每天随机报价 set used = 1 如果已使用报价和今天的报价

一旦没有更多未使用的引号离开更新为 0；

由于您已经在使用 cronjobs 将结果缓存到文件中！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:36:20.320

我会在数据库中通过 id 获取引号，例如 1-100，然后使用 php 函数从数据库中随机选择它

```
rand(1, 100); 
```

当然，您需要将为该日期选择的内容保存在另一个表格中，以便您可以检查是否已为新的一天生成。

# sql - 使用索引提高 PostgreSQL 查询性能

> ID：13790926
> 
> 赞同：1
> 
> 时间：2012-12-09T19:30:14.977
> 
> 标签：sql, performance, postgresql, indexing

我在 Postgres 数据库上有一个 Rails 应用程序，它严重依赖于这样的查询：

```
SELECT DISTINCT client_id FROM orders WHERE orders.total>100 
```

本质上，我需要所有具有满足特定条件的订单的客户的 ID。我只需要 id，所以我认为这比使用连接要快得多。

我会从向“总计”列添加索引中受益吗？我不介意插入速度，我只需要查询运行得非常快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-09T19:44:24.873

我希望以下[多列索引](http://www.postgresql.org/docs/current/interactive/indexes-multicolumn.html)最快：

```
CREATE INDEX orders_foo_idx ON orders (total DESC, client_id); 
```

PostgreSQL 9.2 可能会受益更多。凭借它的“仅索引元组”功能，它可以在有利的情况下为查询提供服务，而无需命中表：自上次以来没有写入`VACUUM`。

`DESC`或者`ASC`在这种情况下几乎不重要。可以在两个方向上几乎同样有效地搜索 B 树索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T19:41:28.700

绝对地。由于总列上没有索引，此查询将需要表扫描。对于总列上的索引，它将需要索引查找和键查找。随着表大小的增长，这将为您的查询提供巨大的性能提升。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T19:46:46.977

```
>  I only need the id, so I figured this is way faster than using joins. 
```

是的，虽然我不确定为什么在这种情况下你会首先考虑使用连接。

正如 cmotley 所说，您将需要此查询的总列上的索引。但是，最佳性能将取决于您正在运行的查询*。*例如，对于这个查询，使用这个表结构，最快的方法是创建一个索引，如下所示：

`CREATE INDEX IX_OrderTotals ON orders (total, client_id)`

通过将 client_id 包含在索引中，您可以在 client_id 列上创建称为[覆盖索引](https://stackoverflow.com/questions/609343/what-are-covering-indexes-and-covered-queries-in-sql-server)的内容，因此数据库引擎不必在后台查找行来获取您的数据。

# c++ - 迭代一系列范围

> ID：13790935
> 
> 赞同：4
> 
> 时间：2012-12-09T19:31:10.010
> 
> 标签：c++, boost, c++11

如果我有一系列范围，有没有办法将它们连接在一起并像它们是单个范围一样迭代它们？

我所说的范围是指任何类型的容器或迭代器对。基本上就像 boost 的[范围](http://www.boost.org/doc/libs/1_52_0/libs/range/doc/html/range/reference/overview.html)。Boost 已经具有将两个范围与 boost::join 连接在一起的功能，但该功能不能连接任意数量的范围。

基本上，我正在寻找一种方法来执行该`many`函数在这段代码中的作用：

```
std::vector<std::vector<int>> n = {{0, 1}, {2, 3}};
for (auto i : many(n))
    std::cout << i << '\n'; 
```

这将输出 0、1、2、3。

在 C# 中，我有`SelectMany`哪个可以做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T21:30:11.487

这是与基于范围的 for 一起使用的展平迭代器的示例（取自[此处](https://stackoverflow.com/questions/11783541/c-iterator-adapter-over-collection-of-vectors?lq=1)并添加`boost::make_iterator_range`到显示范围版本）（但仍需要工作）：

```
#include <boost/iterator/iterator_adaptor.hpp>
#include <boost/range.hpp>
#include <iostream>
#include <vector>
#include <algorithm>
#include <iterator>
#include <string>
#include <utility>

template <typename Iter>
class flattening_iterator :
    public boost::iterator_adaptor<
                flattening_iterator<Iter>,
                Iter,
                typename Iter::value_type::iterator::value_type,
                boost::forward_traversal_tag,
                typename Iter::value_type::iterator::value_type
    >
{
private:
        using super_t = boost::iterator_adaptor<
                                flattening_iterator<Iter>,
                                Iter,
                                typename Iter::value_type::iterator::value_type,
                                boost::forward_traversal_tag,
                                typename Iter::value_type::iterator::value_type
                        >;
        using inner_iterator = typename Iter::value_type::iterator;
public:
        flattening_iterator(Iter it)
                : super_t(it),
                  inner_begin(),
                  inner_end(),
                  outer_end(it)
        {}
        flattening_iterator(Iter begin, Iter end)
                : super_t(begin),
                  inner_begin((*begin).begin()),
                  inner_end((*begin).end()),
                  outer_end(end)
        {}
    using value_type = typename Iter::value_type::iterator::value_type;
private:
    friend class boost::iterator_core_access;
    inner_iterator inner_begin;
    inner_iterator inner_end;
    Iter outer_end;

    void increment()
    {
        if (this->base_reference() == outer_end)
            return; // At the end

        ++inner_begin;
        if (inner_begin == inner_end)
        {
            ++this->base_reference();
            inner_begin = (*this->base_reference()).begin();
            inner_end = (*this->base_reference()).end();
        }
    }

    value_type dereference() const
    {
        return *inner_begin;
    }
};

template <typename Iter>
auto flat_iter(Iter it) -> flattening_iterator<Iter>
{
    return flattening_iterator<Iter>(it);
}

template <typename Iter>
auto flat_iter(Iter begin, Iter end) -> flattening_iterator<Iter>
{
    return flattening_iterator<Iter>(begin, end);
}

template <typename Cont>
auto flatten(Cont& c) -> boost::iterator_range<flattening_iterator<decltype(std::declval<Cont>().begin())>>
{
    return boost::make_iterator_range(flat_iter(c.begin(), c.end()), flat_iter(c.end()));
}

int main()
{
    std::vector<std::vector<int>> v1{{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};
    for (auto i : flatten(v1))
    {
        std::cout << i << ' ';
    }
} 
```

**输出**

1 2 3 4 5 6 7 8 9

# mysql - 需要帮助加快聚合 SQLite 查询

> ID：13790936
> 
> 赞同：1
> 
> 时间：2012-12-09T19:31:11.247
> 
> 标签：mysql, performance, aggregate-functions, greatest-n-per-group

我有一个如下定义的表...

```
CREATE table actions (
  id INTEGER PRIMARY KEY AUTO_INCREMENT,
  end BOOLEAN,
  type VARCHAR(15) NOT NULL,
  subtype_a VARCHAR(15),
  subtype_b VARCHAR(15),
); 
```

我正在尝试查询在每个唯一`(subtype_a, subtype_b)`对上发生的某种类型的最后一个结束操作，类似于 group by（除了 SQLite 没有说明group by 保证返回*哪一行）。*

在大约 1MB 的 SQLite 数据库上，我现在的查询可能需要**两秒钟以上的时间**，但我需要加快速度，使其不到一秒钟（因为这将被频繁调用）。

示例查询：

```
SELECT * FROM actions a_out 
WHERE id = 
  (SELECT MAX(a_in.id) FROM actions a_in 
   WHERE a_out.subtype_a = a_in.subtype_a 
     AND a_out.subtype_b = a_in.subtype_b 
     AND a_in.status IS NOT NULL 
     AND a_in.type = "some_type"); 
```

如果它有帮助，我知道所有独特的可能性`(subtype_a,subtype_b)`

例如：

```
(a,1)
(a,2)
(b,3)
(b,4)
(b,5)
(b,6) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T08:44:13.570

从版本 3.7.11 开始，SQLite[保证](http://www.sqlite.org/releaselog/3_7_11.html)在组中返回哪条记录：

> 形式的查询：“SELECT max(x), y FROM table”返回包含最大 x 值的同一行上的 y 值。

因此[，每个组的最大 n](/questions/tagged/greatest-n-per-group "显示标记为“每组最大数”的问题")可以以更简单的方式实现：

```
SELECT *, max(id)
FROM actions
WHERE type = 'some_type'
GROUP BY subtype_a, subtype_b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T19:48:56.230

这是不是更快？

```
select * from actions where id in (select  max(id) from actions where type="some_type" group by subtype_a, subtype_b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T19:59:24.910

这是`greatest-in-per-group`StackOverflow 上经常出现的问题。

这是我解决它的方法：

```
SELECT a_out.* FROM actions a_out
LEFT OUTER JOIN actions a_in ON a_out.subtype_a = a_in.subtype_a 
    AND a_out.subtype_b = a_in.subtype_b
    AND a_out.id < a_in.id
WHERE a_out.type = "some type" AND a_in.id IS NULL 
```

如果您在 (type, subtype_a, subtype_b, id) 上有一个索引，它应该运行得非常快。

* * *

另请参阅我对类似 SQL 问题的回答：

*   [获取列的最大值所在的行](https://stackoverflow.com/questions/121387/fetch-the-row-which-has-the-max-value-for-a-column/123481#123481)
*   [检索每个组中的最后一条记录](https://stackoverflow.com/questions/1313120/retrieving-the-last-record-in-each-group/1313293#1313293)
*   [SQL join：选择一对多关系中的最后一条记录](https://stackoverflow.com/questions/2111384/sql-join-selecting-the-last-records-in-a-one-to-many-relationship/2111420#2111420)

或者 Jan Kneschke 的这篇精彩文章：[Groupwise Max](http://jan.kneschke.de/2007/2/15/groupwise-max/)。

# php - preg_replace，如何设置字符串

> ID：13790942
> 
> 赞同：0
> 
> 时间：2012-12-09T19:32:02.987
> 
> 标签：php

```
$item->description = preg_replace("/\<center\>\<a href=\"(.*)\"\>\<img alt=\"\" src=\"(.*)\" \/\>\<\/a\>\<\/center\>/", "$2", $item->description); 
```

但我需要将结果`$2`放入 string `$item->image`。
怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:33:07.693

尝试：

```
$item->image = preg_replace("/.*\<center\>\<a href=\"(.*)\"\>\<img alt=\"\" src=\"(.*)\" \/\>\<\/a\>\<\/center\>.*/", "$2", str_replace("\n", '', $item->description)); 
```

如何不要使用正则表达式来解析 html 而是[`DOM`](http://php.net/manual/en/book.dom.php)使用

# c# - 从应用程序到 mysql 数据库的安全访问

> ID：13790944
> 
> 赞同：0
> 
> 时间：2012-12-09T19:32:13.243
> 
> 标签：c#, mysql, fluent-nhibernate, security, remote-access

我对新主机有疑问。到目前为止，我一直在使用流畅的 nhibernate aproch 来访问远程数据库中的数据。由于某些情况，我不得不更改到另一个没有外部数据库访问权限的主机。最终用户使用没有静态 IP 的 Internet 连接（对于大多数人来说它是公共的，但它每 24-48 小时更改一次）在我的情况下我可以做些什么来使我的应用程序中的更改保持在最低限度？

数据传输是双向的。

我的想法：

*   使用新的托管 ftp 上传文件以使用 php 进行处理。很多工作。
*   设计某种网络访问服务。和上面一样。

上面的问题是第二个问题：如何在大型系统中提供对数据库的访问，而不能将连接限制在已知和安全的来源？

非军事区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T20:03:26.637

如果您没有对数据库的外部访问权限（如果不是默认设置，这很常见），您可以使用 VPN 或 SSH 隧道连接到外部服务器并像访问本地数据库一样访问数据库。

# c# - 查找动态添加的服务器控件并使用它的 HTML

> ID：13790946
> 
> 赞同：1
> 
> 时间：2012-12-09T19:32:17.460
> 
> 标签：c#, asp.net, dynamic, controls

我正在尝试从动态创建的服务器文本框中获取文本。我只是通过将文本放入我放置在 aspx 文件中的另一个文本框中进行检查，但我得到的始终是一个空字符串..（我还尝试了另一种包含在备注中的方法，但它也不起作用）

这是后面的代码：

```
public partial class Product_list : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        create_table();
    }

    protected void create_table()
    {
        DBServices db1=new DBServices();
        List<Product> list1 = db1.ReadProducts();
        int id_number=1;
        int id_numer2 = 7;
        int id_number3 = 13;

        Table tbl = new Table();
        tbl.ID = "tbl1";
        this.Controls.Add(tbl);

        foreach (Product p1 in list1)
        {
            TableRow rw = new TableRow();
            rw.ID = Convert.ToString(id_numer2);

            TableCell cell1 = new TableCell();
            cell1.Text = p1.Name;

            TableCell cell2 = new TableCell();

            Image img = new Image();
            img.ImageUrl = p1.ImagePath;
            img.Height = 50;
            img.Width = 50;

            cell2.Controls.Add(img);

            TableCell cell3 = new TableCell();
            cell3.ID = Convert.ToString(id_number3);

            TextBox textbox1 = new TextBox();
            textbox1.ID = Convert.ToString(id_number);

            cell3.Controls.Add(textbox1);

            rw.Controls.Add(cell1);
            rw.Controls.Add(cell2);
            rw.Controls.Add(cell3);

            tbl.Controls.Add(rw);

            id_number++;
            id_numer2++;
            id_number3++;
        } 
    }

    void save_list()
    {
        List<Product> Items_list = new List<Product>();

        //TextBox aControl =Page.FindControl("1") as TextBox;

        /var tbl1 = this.Page.FindControl("tbl1") as Table;
        var tr = tbl1.FindControl("7") as TableRow;
        var td = tr.FindControl("13") as TableCell;
        var txt = td.FindControl("1") as TextBox;

        txt1.Value = txt.Text;

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        save_list();
    }
} 
```

这是aspx代码：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="Product_list.aspx.cs" Inherits="Product_list" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title></title>
<script runat=server>
        public override void VerifyRenderingInServerForm(Control control)
        {
        }
    </script>
</head>
<body>
    <form id="form1" runat="server">
        <div id="header">
            <h1>Items List</h1>
        </div>

        <div id="prod_table" runat="server"></div>
        <div>
            <input type="text" runat="server" id="txt1" />
            <asp:Button ID="Button1" runat="server" Text="Button"
                onclick="Button1_Click" />
        </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-09T19:53:30.310

您应该了解，您在服务器的每个帖子上都重新创建了您的表。因此，您不能依赖动态表中的数据，因为每次发布后它都会丢失。我的建议是将此值保留在具有“隐藏”类型的永久输入控件中。然后在按钮单击事件上获取此值并将其分配给文本框。

# c++ - 为什么在 C++ 中，值 65536 的整数变量的输出为 0，< 65536 给出负整数，> 65536 值给出正整数？

> ID：13790947
> 
> 赞同：0
> 
> 时间：2012-12-09T19:32:19.000
> 
> 标签：c++, c, integer, type-conversion, turbo-c

为什么在 Turbo C++ IDE 中，硬编码值 65536 的整数变量的输出为 0，小于该值 (65536) 为负整数，大于该值 (65536) 为正整数？

如果我们用硬编码值 65536 初始化一个整数并打印它，它将打印 0，如果我们将该整数变量的值从 65536 更改为 65535 或更小，如 65534 等等，它会打印 -1、-2、。 .. 如果我们将该整数变量的值从 65536 更改为 65537 或更大，它将打印 1,2,3... 等等，为什么会发生这种情况？我在 Turbo C++ IDE 上验证了它。

由于我是初学者，请清楚地解释其背后的逻辑和工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-09T19:34:59.730

古老的 Turbo C++ 使用 16 位`int`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-09T19:45:25.963

您似乎在谈论 16 位有符号值（-32768 到 32767），这意味着它将最左边的位视为符号。

如果您将其放入 65535 (1111 1111 1111 1111) - 它将把它视为负数，因为最左边的位是 1。其他位（全为 1）给出最大的负值，等于“-1”。它将保持负数，直到最左边的位变为 0。它将是 32767。

如果您输入 65536 (0001 0000 0000 0000 0000) - 它只会剪切最后 16 位，全部为零，并且该值将等于“0”。

65538 (0001 0000 0000 0000 0010) - 再次剪切最后 16 位，你会得到 '2'

注意：一般来说，您不能保存超出类型范围的值。如果你有 16 位整数，只能存储（-32768 到 32767），那么你不能放 65535。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-09T20:01:22.260

我猜一旦我们越过整数限制，就会发生数字旋转。因此，一旦达到 65536，正数再次开始获得更大的值。

原来的限制是 -32768 到 32767。如果我们去 32768，我们实际上已经达到了 -32768。所以当我们达到 65536 时，我们得到 0，正数重新开始

# javascript - 下载生成的二进制内容在磁盘文件中包含 utf-8 编码的字符

> ID：13790949
> 
> 赞同：2
> 
> 时间：2012-12-09T19:32:25.873
> 
> 标签：javascript, utf-8, google-chrome-extension

我正在尝试使用以下代码从 chrome 扩展中将生成的 zip 文件保存到磁盘：

```
function sendFile (nm, file) {
  var a = document.createElement('a');
  a.href = window.URL.createObjectURL(file);
  a.download = nm; // file name
  a.style.display = 'none';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
function downloadZip (nm) {
  window.URL = window.webkitURL || window.URL;
  var content;
  content = zip.generate();
  var file = new Blob ([content], {type:'application/base64'});
  sendFile ("x.b64", file);
  content = zip.generate({base64:false});
  var file = new Blob ([content], {type:'application/binary'});
  sendFile ("x.zip", file);
} 
```

目前，这将我的 zip 的内容保存在两个版本中，第一个是 base64 编码的，当我使用`base64 -d`生成的 zip 对其进行解码时就可以了。
第二个版本应该只保存原始数据（zip 文件），但是这个原始数据以 utf-8 编码到达我的磁盘上。（每个值 >= 0x80 都以 0xc2 为前缀）。那么如何摆脱这种 utf-8 编码呢？尝试了各种类型字符串，例如`application/zip`，或完全省略类型信息，它总是以 utf-8 编码到达。我也很好奇如何让浏览器自己存储/转换 base64 数据（第一种情况），以便它们作为解码的二进制数据到达我的磁盘上......我使用的是 Chrome 版本 23.0.1271.95 m

PS：我在浏览器中使用 hexdump-utility 分析的第二个内容：它不包含 utf-8 编码（或者我的 hexdump 调用了一些进行隐式转换的东西）。为了完整起见（抱歉，它只是从 c 转换而来，所以它可能不是那么酷的 js 代码），我将它附加在这里：

```
function hex (bytes, val) {
  var ret="";
  var tmp="";
  for (var i=0;i<bytes;i++) {
    tmp=val.toString (16);
    if (tmp.length<2)
      tmp="0"+tmp;
    ret=tmp+ret;
    val>>=8;
  }
  return ret;
}
function hexdump (buf, len) {
  var p=0;
  while (p<len) {
    line=hex (2,p);
    var i;
    for (i=0;i<16;i++) {
      if (i==8)
        line +=" ";
      if (p+i<len)
        line+=" "+hex(1,buf.charCodeAt(p+i));
      else
        line+="   ";
    }
    line+=" |";
    for (i=0;i<16;i++) {
      if (p+i<len) {
        var cc=buf.charCodeAt (p+i);
        line+= ((cc>=32)&&(cc<=127)&&(cc!='|')?String.fromCharCode(cc):'.');
      }
    }
    p+=16;
    console.log (line);
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T19:15:57.730

从[工作草案](http://www.w3.org/TR/FileAPI/#dfn-Blob)：

> 如果 element 是 DOMString，请运行以下子步骤：
> 
> *   让 s 是使用 WebIDL [WebIDL] 中的算法将元素转换为 Unicode 字符序列 [Unicode] 的结果。
>     
>     
> *   将 s 编码为 UTF-8 并将结果字节附加到字节。

所以字符串总是被转换为 UTF-8，并且没有任何参数可以影响这一点。这不会影响 base64 字符串，因为它们只包含与每个代码点的单个字节匹配的字符，代码点和字节具有相同的值。幸运的是`Blob`，它公开了较低级别的接口（直接字节），因此这种限制并不重要。

你可以这样做：

```
var binaryString = zip.generate({base64: false}), //By glancing over the source I trust the string is in "binary" form
    len = binaryString.length,    //I.E. having only code points 0 - 255 that represent bytes
    bytes = new Uint8Array(len);

for( var i = 0; i < len; ++i ) {
    bytes[i] = binaryString.charCodeAt(i);
}

var file = new Blob([bytes], {type:'application/zip'});
sendFile( "myzip.zip", file ); 
```

# iphone - 与 UITableView 关联的 NSIndexPath

> ID：13790951
> 
> 赞同：0
> 
> 时间：2012-12-09T19:32:41.363
> 
> 标签：iphone, ios, core-data, nsfetchedresultscontroller, nsindexpath

我的主视图上有一个表格视图，我的详细视图上有一个文本字段。该应用程序很简单。添加包含一些信息的表格视图单元格。然后，如果您按下单元格，它会推动详细视图并在文本字段中显示单元格的`title`/ 。`text`在主视图中，我使用的是 NSFetchedResultsController。在第二个视图中，我试图加载数据，但由于某种原因，我没有正确使用我自己的 indexPath 变量，因为每个被按下的单元格都会显示`text`详细视图上的第一个单元格。代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell =
[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    // Set up the cell...
[self configureCell:cell atIndexPath:indexPath];
self.path = indexPath;
    //I have tried this as well.
    //self.path = [NSIndexPath indexPathForRow:indexPath.row inSection:0];
return cell;
} 
```

详细视图：

```
-(void)viewWillAppear:(BOOL)animated
{
if (self.context == nil)

{

    self.context = [(FBCDAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];

}

NSFetchRequest *request = [[NSFetchRequest alloc]init];

NSEntityDescription *entity = [NSEntityDescription entityForName:@"FailedBankInfo" inManagedObjectContext:self.context];

[request setEntity:entity];

NSError *error;

NSMutableArray *array = [[self.context executeFetchRequest:request error:&error] mutableCopy];

[self setTableArray:array];

FailedBankInfo *infoData = [self.tableArray objectAtIndex:self.root.path.row];

NSString *string = [NSString stringWithFormat:@"%@", infoData.name];

self.nameField.text = string;

string = [NSString stringWithFormat:@"%@", infoData.city];

self.cityField.text = string;

string = [NSString stringWithFormat:@"%@", infoData.state];

self.stateField.text = string;

[super viewWillAppear:YES];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:52:31.147

为什么不直接将索引路径传递给细节视图控制器

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

方法，带有自定义初始化程序：

```
- (id)initDetailViewControllerWithIndexPath:(NSIndexPath*)indexPath 
```

?

我不熟悉 UIViewController 上的“根”属性，那是什么？这似乎是试图从详细视图控制器中引用第一个视图控制器。您是否检查过 self.root.path.row 返回的内容？

无论如何，您的第一个视图控制器的路径属性与您拥有代码的方式选择的单元格无关。它只是设置为加载的最后一个单元格的 indexPath。如果您确实想了解如何从详细视图控制器访问此属性，则必须在 didSelectRowAtIndexPath 方法中设置它，而不是在 cellForRowAtIndexPath 方法中设置才能准确。

* * *

我认为，如果您在 didSelectRowAtIndexPath 中设置路径，您的方式应该可行。但是要编写自定义初始化程序，请向您的详细视图控制器添加一个名为 path 的属性，然后将自定义初始化程序添加到详细视图控制器，如下所示：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil andIndexPath:(NSIndexPath*)indexPath
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.path = indexPath;
    }
    return self;
} 
```

并使用第一个视图控制器的 didSelectRowAtIndexPath 方法调用它

```
DetailViewController *detailViewController = [[DetailViewController alloc] initWithNibName:nil bundle:[NSBundle mainBundle] andIndexPath:indexPath];
[self presentViewController:detailViewController animated:YES completion:nil]; 
```

（如果您不是从 xib 初始化，请自定义您正在使用的初始化程序）。

或者，您可以传入一个 NSDictionary，其中包含您在详细视图控制器中需要的数据（标题和文本），而不是传入索引路径。

# android - Android 将捕获的图像保存为捕获的 Android 相机

> ID：13790952
> 
> 赞同：0
> 
> 时间：2012-12-09T19:32:41.010
> 
> 标签：android, camera, android-cursor, image-capture

我正在尝试从我的应用程序中打开 android 自己的相机应用程序。它正在工作！但是当我想获取类似的信息时遇到了问题，

-图像 ID

-图像显示名称

-图像标题

-图像数据

-图片尺寸

- 拍摄日期

它应该存储在 MediaStore。我成功获取了图像的路径。之后，我必须获取上述信息，但是当我尝试获取信息时，应用程序会抛出异常。

部分我的代码是这样的：

```
while(cursor.moveToNext())
    {
        Date date = new Date(Long.valueOf(cursor.getString(5)));
        SimpleDateFormat dateF = new SimpleDateFormat("yyyy/MM/dd");
        SimpleDateFormat timeF = new SimpleDateFormat("HH:mm");

        imageListInfo.add(
                cursor.getString(0) + ";" 
                + cursor.getString(1) + ";" 
                + cursor.getString(2) + ";" 
                + cursor.getString(3) + ";" 
                + cursor.getString(4) + ";"
                + dateF.format(date) + ";"
                + timeF.format(date)
                );
    } 
```

在我捕获并保存从我的应用程序调用的默认相机应用程序中的照片之前，没有任何问题。

我认为应该解决一个问题。我如何在不从我的应用程序调用的情况下保存图像及其信息，例如捕获照片？

编辑：

*获取 id "cursor.getString(0)" 代码时会发生这种情况*

```
android.database.StaleDataException: Attempting to access a closed CursorWindow.Most probable cause: 
cursor is deactivated prior to calling this method.
at android.database.AbstractWindowedCursor.checkPosition(AbstractWindowedCursor.java:139)
at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:50)
at android.database.CursorWrapper.getString(CursorWrapper.java:114)
at com.canberk.data.warehouse.BaseActivity.indexingForImageMediaStore(BaseActivity.java:313)
at com.canberk.data.warehouse.BaseActivity$BackGroundWorker.doInBackground(BaseActivity.java:109)
at com.canberk.data.warehouse.BaseActivity$BackGroundWorker.doInBackground(BaseActivity.java:1)
at android.os.AsyncTask$2.call(AsyncTask.java:264)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
at java.util.concurrent.FutureTask.run(FutureTask.java:137)
at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
at java.lang.Thread.run(Thread.java:856) 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:51:46.963

> 但是当我想获取诸如...之类的信息时遇到了问题，这些信息应该存储在 MediaStore

好吧，只有`MediaStore`当用户直接调用相机应用程序来拍照时，该数据才会出现。当应用程序被调用以`Intent`将照片返回给您的应用程序时，图像数据可能会保存在您请求的位置，但没有任何内容隐式存储在`MediaStore`.

`MediaStore`如果您的应用程序正在请求照片，一种常见的技术是首先使用您想要关联的所有初始元数据进行插入，这将返回`Uri`您可以传递给相机应用程序以存储捕获的图像。然后返回后，如果您需要输入其他元数据，例如图像大小，您可以读取此信息并更新数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-09T20:02:46.417

您的堆栈跟踪似乎不言自明：您正在访问一个封闭`Cursor`的`indexingForImageMediaStore()`.

# delphi - 安装组件的最佳方式是什么？

> ID：13790953
> 
> 赞同：8
> 
> 时间：2012-12-09T19:32:54.297
> 
> 标签：delphi, installation, components, delphi-xe3

在 Delphi XE3 下安装组件是一场噩梦。

*   首先我需要将源文件添加到

    **工具**->**选项**->**库**

*   然后我需要找到一个正常的包并编译它

*   最后我需要找到设计时包并安装它。

这非常乏味且容易出错。有没有更好的方法来安装组件？

我找到了[Delphi Package Installer](http://code.google.com/p/delphipi/)。不幸的是，它不支持 Delphi XE3 或更高版本。

我听说有类似的东西会产生`exe`安装自己的包（比如 Inno Setup），但我找不到这样的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-09T19:47:01.250

不可以。上述步骤是必需的。

首先，添加文件路径`Tools->Options->Delphi Options->Library Path`是为了让编译器知道在哪里可以找到文件来编译它们。（实际上，这不是必需的 - 您可以通过确保 .dpk 文件与 .pas 文件位于同一文件夹中来消除此步骤，并且所有 .pas 文件名都列在`includes`.dpk 的部分中。如果.pas 文件位于不同的位置，您需要使用 .dpk 中的相对路径（例如，`MyComponents in '..\Source\MyComponents.pas'`）或将 .pas 文件的位置添加到`Project->Options->Delphi Compiler->Search Path`.)

下一步（查找“正常包”）是为了构建运行时包。这是必需的，因为设计时包（下一步）需要该包中的代码才能在表单设计器中运行。当您决定使用运行时包构建应用程序时，也需要它，如果您使用第三方组件并希望为其分发运行时包。

需要单独的设计时包（第三步），因为设计时代码只能在设计时使用；如果应用程序是使用运行时包构建的，并且步骤 2 中的包构建就是其中之一，则没有任何东西可以与应用程序一起分发。

这是从 Delphi 3 左右开始安装组件的方式，并且在 Delphi 5 中开始建议将设计时代码分离到自己的包中，并在 Delphi 6 中强制执行（当他们将大部分 IDE 设计时支持重新定位到他们的拥有单独的软件包并停止分发它们的源代码）。

确实没有其他选择，除非供应商为您提供预构建设计时和运行时包，或者提供将执行上述所有步骤的安装程序。（大多数不这样做。）但是如果您更新您的 Delphi 版本，您仍然必须完成上述步骤。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T12:18:08.993

内置组件安装程序呢？它是 Delphi XE、XE2 和 XE3 的一部分，可以在[此处](http://rvelthuis.de/programs/compinstall.html)找到描述（我写的）。它甚至会在 C++Builder 中安装组件。您可以安装到现有包中或安装到它将为您创建的新包中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-10T01:06:19.813

我想说安装组件的最佳方法是使用您的构建管理器（例如 FinalBuilder）并将每个组件添加到一个管理器项目文件中，该文件设置必要的路径，构建 DPK 文件，并在IDE 通过创建一个注册表项。这样，您就有了一个文档化的过程，可以让您可靠地设置或修复您完整的、经过测试的 Delphi 开发环境。当组件更新和测试后，您可以简单地重新运行项目。调整现有项目以处理新的 Delphi 版本也很容易。

供应商提供的安装程序的一大缺点是，我看到的所有安装程序都只是在更新时覆盖了以前的版本。我更喜欢自己控制安装，以便将以前的组件源版本存档并可供比较，以防测试发现升级存在问题。“一键安装”听起来不错，直到小组件升级突然导致您的应用程序停止工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T15:07:36.127

看看“ [Lazy Delphi Builder](http://www.lazyproject.info) ”。它的创建是为了一次简化许多组件的构建/安装。它自动解决包依赖关系。免费使用。 [链接到一些旧教程](http://www.lazyproject.info/support/docs-en/)

# mysql - MYSQL 与脚本的输出不同

> ID：13790956
> 
> 赞同：6
> 
> 时间：2012-12-09T19:33:08.570
> 
> 标签：mysql, linux, bash

从 bash 脚本执行命令时，MySQL 输出格式存在问题。

如果我在命令行上执行命令，那么我可以按预期格式获得输出。

```
$ mysql -u dbclient -pxxxx GEKONYLOGDB -e "select now(),max(time_stamp) from metrics"
+---------------------+---------------------+
| now()               | max(time_stamp)     |
+---------------------+---------------------+
| 2012-12-09 14:25:38 | 2012-12-09 14:25:20 |
+---------------------+---------------------+ 
```

但是，就好像我在脚本中保留相同的命令并执行一样，我没有得到格式化的输出。

```
$ cat test
#!/bin/bash
mysql -u dbclient -pxxxx GEKONYLOGDB -e "select now(),max(time_stamp) from metrics"

$ ./test
now()   max(time_stamp)
2012-12-09 14:27:52     2012-12-09 14:27:47 
```

所以我只需要脚本的相同输出。

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-09T19:34:50.377

通过`-t`or`--table`选项强制表格输出。

```
mysql --table -u dbclient -pxxxx GEKONYLOGDB -e "select now(),max(time_stamp) from metrics" 
```

来自`mysql --help`：

```
 -t, --table         Output in table format. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-15T13:04:20.677

如果您想在调用 mysql 程序时默认启用 --table 选项，请查看这个 SO 答案[How to store MySQL results to a file in table format](https://stackoverflow.com/a/58395334/565525)。

# c++ - 比较不同输入下相同代码的执行路径

> ID：13790959
> 
> 赞同：6
> 
> 时间：2012-12-09T19:33:24.230
> 
> 标签：c++, execution

我正在调试一个非常复杂的 C++ 函数，它在某些输入下会给我一些意想不到的结果。我想比较不同输入下的代码执行情况，以便找出导致我出错的部分。我正在寻找**可以比较代码执行路径**的工具。请让我知道是否存在这样的工具。或者，如果有一些技术我可以用来做同样的事情？

为了具体描述我的问题，这里我使用了一个人为的例子。

说这是**伪代码**中的函数，

```
double payTax(double income)
{
   if (income < 10000)
      return noTax();
   else if ( 10000 < income < 30000)
      return levelOneTax();
   else if (30000 < income < 48000)
      return levelTwoTax();
   else  
      return levelThreeAboveTax();
} 
```

给定输入 15000，该函数计算正确的税额，但不知何故，输入 16000 给出了错误的税额。假设输入 15000 和 16000 会导致函数通过完全相同的执行路径；另一方面，如果它们走不同的路径，那么函数中一定有问题。因此，比较执行路径的工具会揭示足够的信息，帮助我快速识别错误。我正在寻找这样的工具。最好与 Visual Studio 2010 兼容。如果这样的工具还保留变量的值会更好。

PS 调试是我最不想做的事情，因为我正在使用的代码库比简单的 payTax 示例要大得多且复杂得多。

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:45:41.637

您要查找的关键字是“代码覆盖率”或“覆盖率分析”或“代码覆盖率分析”。

您使用哪种工具自然取决于您的其他环境。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-09T19:53:48.407

你想要的工具是`printf`or `std::cerr`！

而且您的代码中有一个重大错误：类似的语句`if ( 10000 < income < 30000)`不会按预期工作！你想把它写成`if( 10000 < income && income < 30000 )`.

为了保持测试简单，请使用大括号，如下所示：

```
if( 10000 < income && income < 30000 ) {
    return levelOneTax();
} else if( ... 
```

因为这样添加调试输出会容易得多，如下所示：

```
if( 10000 < income && income < 30000 ) {
    std::cerr << "using levelOneTax for income=" << income << std::endl;
    return levelOneTax();
} else if( ... 
```

**编辑**

顺便说一句：“一个比较执行路径的工具会揭示足够的信息 [...]”，但在你所期望的意义上，这样的工具会揭示太多需要处理的信息。您能做的最好的事情是调试并验证您的代码是否按照您的预期进行。对于您的情况，“代码覆盖率”工具可能太大（而且此类工具也不便宜）。

# android-fragments - 如何在 Fragment 中放置 Sherlock ActionBar？

> ID：13790962
> 
> 赞同：0
> 
> 时间：2012-12-09T19:33:46.157
> 
> 标签：android-fragments, actionbarsherlock

如何在 Fragment 中放置 Sherlock ActionBar？

我已经有了侧导航，所有内容都放在可拖动的片段中。我希望在片段中有 ActionBar，并与片段同时拖动它。

这个怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:52:44.583

解决方案

```
ActionBar actionBar = getSherlockActivity().getSupportActionBar(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T01:31:32.960

您不会将 ActionBar 放在 SherlockFragment 中。ActionBar 位于 Fragment 之外，在您的`SherlockFragmentActivity`.

# combobox - RadComboBox 宽度无法更改

> ID：13790963
> 
> 赞同：2
> 
> 时间：2012-12-09T19:33:46.493
> 
> 标签：combobox, radcombobox

我正在评估 Kendo UI 网络控制试用版。我的应用程序使用了 RadComboBox 控件。它的宽度在页面上仍然是 100%，我无法更改它。

我将组合框宽度设置为 Width="300px" 但它在页面上仍然很宽。

# spring-mvc - 使用 Spring Security 进行身份验证

> ID：13790966
> 
> 赞同：0
> 
> 时间：2012-12-09T19:34:10.227
> 
> 标签：spring-mvc, spring-security

我正在尝试通过连接到 LDAP 使用 Spring Security 进行我的第一个演示。

我使用的Sping版本是：3.1.0.RELEASE

这是我的security-integration.xml：

```
<?xml version="1.0" encoding="UTF-8"?> <beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.1.xsd">

  <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
      <list>
        <value>classpath:com/demo/spring/security.properties</value>
      </list>
    </property>   </bean>

  <security:http auto-config='false' access-denied-page="/accessDenied" use-expressions="true">

    <!--I've removed login."htm"?error=true-->
    <security:form-login
      login-page="/login"
      authentication-failure-url="/login?error=true"
      login-processing-url="/loginProcess"
      default-target-url="/home"/>

    <!--<security:logout-->
      <!--invalidate-session="true"-->
      <!--logout-success-url="/login"-->
      <!--logout-url="/logout"/>-->

  </security:http>

  <bean id="contextSource"
        class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">
    <constructor-arg value="${securityContextSource.url}"/>
    <property name="userDn" value="${securityContextSource.userDn}"/>
    <property name="password" value="${securityContextSource.password}"/>   </bean>

  <bean id="userSearch" class="org.springframework.security.ldap.search.FilterBasedLdapUserSearch">
    <constructor-arg index="0" value="${filterBasedLdapUserSearch.searchBase}"/>
    <constructor-arg index="1" value="${filterBasedLdapUserSearch.searchFilter}"/>
    <constructor-arg index="2" ref="contextSource"/>   </bean>

  <bean id="bindAuthenticator" class="org.springframework.security.ldap.authentication.BindAuthenticator">
    <constructor-arg ref="contextSource"/>
    <property name="userSearch" ref="userSearch"/>   </bean>

    <bean id="ldapAuthProvider"
          class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
      <constructor-arg  ref="bindAuthenticator"/>
    </bean>

    <security:authentication-manager>
        <security:authentication-provider ref="ldapAuthProvider"/>
    </security:authentication-manager>

</beans> 
```

但是，每当我部署我的战争时，我都会遇到这个异常：

> HTTP 状态 500 -
> 
> 类型异常报告
> 
> 信息
> 
> 描述 服务器遇到一个内部错误 () 阻止它完成这个请求。
> 
> 例外
> 
> javax.servlet.ServletException：servlet spring 的 Servlet.init() 抛出异常 org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472) org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java: 98) org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927) org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407) org.apache.coyote.http11.AbstractHttp11Processor.process( AbstractHttp11Processor.java:987) org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579) org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307) java.util. concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885) java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907) java.lang.Thread.run(Thread.java:619) 根本原因
> 
> org.springframework.beans.factory.BeanDefinitionStoreException：从类路径资源 [com/demo/spring/security-integration.xml] 解析 XML 文档时出现意外异常；嵌套异常是 org.springframework.beans.BeanInstantiationException：无法实例化 bean 类 [org.springframework.security.config.SecurityNamespaceHandler]：构造函数抛出异常；嵌套异常是 java.lang.NoClassDefFoundError: org/springframework/security/config/method/InternalInterceptMethodsBeanDefinitionDecorator org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:412) org.springframework.beans.factory.xml。 XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334) org.springframework.beans.factory.xml.XmlBeanDefinitionReader。
> 
> org.springframework.beans.BeanInstantiationException：无法实例化bean类[org.springframework.security.config.SecurityNamespaceHandler]：构造函数抛出异常；嵌套异常是 java.lang.NoClassDefFoundError: org/springframework/security/config/method/InternalInterceptMethodsBeanDefinitionDecorator org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:162) org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java: 104) org.springframework.beans.factory.xml.DefaultNamespaceHandlerResolver.resolve(DefaultNamespaceHandlerResolver.java:129) org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1414) org.springframework.beans.factory。 xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T20:53:59.817

I have solved this issue by removing a dependency on AOP at my maven pom file:

```
<groupId>org.springframework</groupId>
<artifactId>spring-aop</artifactId> 
```

# iphone - 如何在 ViewController 中为 Universal App 设置 UIImageView 框架？

> ID：13790968
> 
> 赞同：0
> 
> 时间：2012-12-09T19:34:19.530
> 
> 标签：iphone, objective-c, ios, uiimageview, ios6

对于通用应用程序，如何在 ViewController 中设置 UIImageView 框架？

```
UIView *baseView = [[UIView alloc] init];

[self.view addSubview:baseView];

// Displays UIImageView

UIImageView *myImage = [[UIImageView alloc]
                        initWithImage:[UIImage imageNamed:@"tool.png"]];
[baseView addSubview:myImage]; 
```

当我运行应用程序时，它显示黑屏。所以我想我必须为它设置一个框架。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:41:37.170

你有点回答了你自己的问题——是的，你必须为它设定一个框架。您可能想尝试：

```
UIView *baseView = [[UIView alloc] initWithFrame:self.view.bounds];
[self.view addSubview:baseView];

// Displays UIImageView

UIImageView *myImage = [[UIImageView alloc]
                    initWithImage:[UIImage imageNamed:@"tool.png"]];
myImage.frame = baseView.bounds;
[baseView addSubview:myImage]; 
```

您还可以为 baseView 和 myImage 设置 autoresizingmask，以便当 self.view 的框架发生变化时，这两个视图也会发生变化。

此外，以防万一您不使用 ARC - 不要忘记在离开此方法之前自动释放这些视图。

# ios - ios - UITabBarController 和 UINavigationController - 选项卡单击并显示特定控制器

> ID：13790970
> 
> 赞同：0
> 
> 时间：2012-12-09T19:34:34.607
> 
> 标签：ios, uinavigationcontroller, uitabbarcontroller

在开发 iphone 应用程序时，我遇到了一个非常头痛的问题。这个应用程序是`UITabBarController`基于的，每个控制器`Tab`都是`UINavigationController`基于的。

在一个“UINavigationController”中，在这个“UINavigationController”堆栈中有两个Controller（我这里称它为A和B），当点击选项卡时会显示“A”，在“A”中，点击会有一个按钮转到“B”，如果单击“B”中的“返回”按钮，将返回“A”。见下图（对于客户的股份，我删除了一些部分）

控制器 - A

![在此处输入图像描述](../Images/7dd472c5e93e70d9efe84f00d06591d6.png)

控制器 - B

![在此处输入图像描述](../Images/bf1d41a0c1b8b1f495f891fe62eea44e.png)

问题是：客户端每次点击“设置”标签时都想显示“设置”页面，这意味着如果它在“条款”页面上，当点击“设置”标签时，它应该回到“设置”页面。 ..

我已经尝试过这些代码 -

```
- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController
{

    return YES;
} 
```

但是我不知道下一步该怎么做，如何比较才能知道“设置”选项卡被点击了？以及如何始终显示“设置”页面..任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:53:34.027

在您的条款控制器（您的示例中的控制器 B）中，只需添加以下代码：

```
-(void)viewDidDisappear:(BOOL)animated {
    [self.navigationController popViewControllerAnimated:NO];
} 
```

# gcc - /lib/i386-linux-gnu/libc.so.6、/lib/x86_64-linux-gnu/libc.so.6 和 /usr/lib/x86_64-linux-gnu/libc.so 有什么区别？

> ID：13790973
> 
> 赞同：10
> 
> 时间：2012-12-09T19:34:57.290
> 
> 标签：gcc, 64-bit, libc

我在我的 Linux Mint 14 Nadia 中安装了 Matlab（a uname -a 显示：Linux Ideapad-Z570 3.5.0-17-generic #28-Ubuntu SMP Tue Oct 9 19:31:23 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux）和从命令行调用它时，我会得到：“/lib64/libc.so not found”。

我通过在 /lib64 中创建一个链接来遵循 mathworks 的帮助：

```
ln -s /lib/x86_64-linux-gnu/libc.so.6 . 
```

这解决了这个问题。

现在，如果我对这个库进行定位，我会得到：

```
locate "libc.so"
/lib/i386-linux-gnu/libc.so.6
/lib/x86_64-linux-gnu/libc.so.6
/usr/lib/x86_64-linux-gnu/libc.so 
```

我将在这台计算机上使用 gcc 进行编译，我想要完整的 64 位编译。拥有所有这些不同的 libc.so 库究竟意味着什么？gnu 编译器将使用哪一个？我需要用 gcc 做任何不同的事情来编译 64 位吗？

我也很想尽可能优化我的新 i7 内核！！！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-09T20:13:51.227

> /lib/i386-linux-gnu/libc.so.6

这是该库的 32 位版本。

> /lib/x86_64-linux-gnu/libc.so.6

这是该库的 64 位版本。

两者通常都是指向实际库文件的符号链接，通常会根据 glibc 版本号命名，例如`libc-2.15.so`

> /usr/lib/x86_64-linux-gnu/libc.so

这不是一个库，而是一个链接器脚本文件，它引用了上面的符号链接。

为什么我们需要所有这些：

首先，无论安装的 libc 版本如何，链接器都会搜索`libc.so`，因为编译器驱动程序总是会将`-lc`选项传递给链接器。名称`libc`保持不变，并表示该库的最新版本。

符号链接以库的*soname*`libc.so.6`命名，或多或少对应于库的 ABI 版本。链接的可执行文件实际上包含对.*`libc.so``libc.so.6`*

 *如果我们想象有一天发布了一个严重不兼容 ABI 的 libc，它的 soname 可以命名为`libc.so.7`，例如，这个版本可以与旧`libc.so.6`版本共存，因此与一个或另一个链接的可执行文件可以在同一个系统中共存，

最后，名称`libc-2.15.so`指的是 libc 版本，当您安装新的 libc 包时，名称将更改为`libc-2.16.so`. 如果它与以前的版本二进制兼容，则`libc.so.6`链接将保持这种命名方式，并且现有的可执行文件将继续工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T19:42:33.970

要找到使用哪个，您必须首先找到`ld`（链接器）用于查找库的顺序，如下所示：

```
ld --verbose | grep SEARCH 
```

对我来说，它给了我这个输出：

```
SEARCH_DIR("/usr/x86_64-unknown-linux-gnu/lib64"); SEARCH_DIR("/usr/x86_64-unknown-linux-gnu/lib"); SEARCH_DIR("/usr/lib"); SEARCH_DIR("/usr/local/lib"); 
```

这意味着在我的计算机上`ld`，按顺序查看这些目录：

1.  /usr/x86_64-unknown-linux-gnu/lib64
2.  /usr/x86_64-unknown-linux-gnu/lib
3.  /usr/lib
4.  /usr/local/lib

因此，如果 libc 在 /usr/x86_64-unknown-linux-gnu/lib64 中，并且 libc 也在 /usr/lib 中，它将使用 /usr/x86_64-unknown-linux-gnu/lib64 版本，因为它已列出第一的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T19:52:07.430

您创建的符号链接对 GCC 没有任何影响。32 位版本仅在使用`-m32`GCC 标志编译时使用。GCC 不会尝试生成 32 位二进制文​​件，除非您明确告诉它（通过使用该标志。）*

# android - 我收到此错误：BitmapFactory.nativeDecodeAsset()

> ID：13790985
> 
> 赞同：0
> 
> 时间：2012-12-09T19:36:22.420
> 
> 标签：android, image, bitmap

我的应用程序对此有很多错误，我是编码新手，所以我很感激一些帮助。

我有一个应用程序，其中包含一些用户可以设置为壁纸的图像，这些图像是可绘制的，我将它们放在 Horizo​​ntalScrollView 中，我还有一个显示所选图像的 ImageView。

这就是我的 Main.java 的样子：

```
public class Main extends Activity implements OnClickListener {

ImageView display;
int wallPaper;
private AdView adView;
Bitmap setWall2;
Bitmap setWall3;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    /* START OF AdMob */

    // Create the adView
    adView = new AdView(this, AdSize.BANNER, "***************");

    // Lookup your LinearLayout assuming it’s been given
    // the attribute android:id="@+id/mainLayout"
    TableRow layout = (TableRow)findViewById(R.id.adView);

    // Add the adView to it
    layout.addView(adView);

    // Initiate a generic request to load it with an ad
    adView.loadAd(new AdRequest());

    /* END OF AdMob */

    wallPaper = R.drawable.image1;

    display = (ImageView) findViewById(R.id.iViewMain);
    ImageView image1 = (ImageView) findViewById(R.id.image1);
    ImageView image2 = (ImageView) findViewById(R.id.image2);
    ImageView image3 = (ImageView) findViewById(R.id.image3);
    ImageView image4 = (ImageView) findViewById(R.id.image4);
    ImageView image5 = (ImageView) findViewById(R.id.image5);
    ImageView image6 = (ImageView) findViewById(R.id.image6);
    ImageView image7 = (ImageView) findViewById(R.id.image7);
    ImageView image8 = (ImageView) findViewById(R.id.image8);
    ImageView image9 = (ImageView) findViewById(R.id.image9);
    ImageView image10 = (ImageView) findViewById(R.id.image10);
    ImageView image11 = (ImageView) findViewById(R.id.image11);
    ImageView image12 = (ImageView) findViewById(R.id.image12);
    ImageView image13 = (ImageView) findViewById(R.id.image13);

    Button setWall = (Button) findViewById(R.id.setWall);

    image1.setOnClickListener(this);
    image2.setOnClickListener(this);
    image3.setOnClickListener(this);
    image4.setOnClickListener(this);
    image5.setOnClickListener(this);
    image6.setOnClickListener(this);
    image7.setOnClickListener(this);
    image8.setOnClickListener(this);
    image9.setOnClickListener(this);
    image10.setOnClickListener(this);
    image11.setOnClickListener(this);
    image12.setOnClickListener(this);
    image13.setOnClickListener(this);

    setWall.setOnClickListener(this);

}

@SuppressWarnings("deprecation")
public void onClick(View v) {
    // TODO Auto-generated method stub

    switch (v.getId()) {
    case R.id.image1:
        display.setImageResource(R.drawable.image1);
        wallPaper = R.drawable.image1;
        break;
    case R.id.image2:
        display.setImageResource(R.drawable.image2);
        wallPaper = R.drawable.image2;
        break;
    case R.id.image3:
        display.setImageResource(R.drawable.image3);
        wallPaper = R.drawable.image3;
        break;
    case R.id.image4:
        display.setImageResource(R.drawable.image4);
        wallPaper = R.drawable.image4;
        break;
    case R.id.image5:
        display.setImageResource(R.drawable.image5);
        wallPaper = R.drawable.image5;
        break;
    case R.id.image6:
        display.setImageResource(R.drawable.image6);
        wallPaper = R.drawable.image6;
        break;
    case R.id.image7:
        display.setImageResource(R.drawable.image7);
        wallPaper = R.drawable.image7;
        break;
    case R.id.image8:
        display.setImageResource(R.drawable.image8);
        wallPaper = R.drawable.image8;
        break;
    case R.id.image9:
        display.setImageResource(R.drawable.image9);
        wallPaper = R.drawable.image9;
        break;
    case R.id.image10:
        display.setImageResource(R.drawable.image10);
        wallPaper = R.drawable.image10;
        break;
    case R.id.image11:
        display.setImageResource(R.drawable.image11);
        wallPaper = R.drawable.image11;
        break;
    case R.id.image12:
        display.setImageResource(R.drawable.image12);
        wallPaper = R.drawable.image12;
        break;
    case R.id.image13:
        display.setImageResource(R.drawable.image13);
        wallPaper = R.drawable.image13;
        break;
    case R.id.setWall:

        InputStream setWall3 = getResources().openRawResource(wallPaper);
        Bitmap setWall2 = BitmapFactory.decodeStream(setWall3);
        try {
            getApplicationContext().setWallpaper(setWall2);
            Context context = getApplicationContext();
            CharSequence text = "Wallpaper set!";
            int duration = Toast.LENGTH_SHORT;

            Toast toast = Toast.makeText(context, text, duration);
            toast.setGravity(Gravity.TOP|Gravity.RIGHT, 0, 0);
            toast.show();
        } catch(IOException e) {
            e.printStackTrace();
        }

        break;

    }
    System.gc();
}

@Override
protected void onResume() {
    // TODO Auto-generated method stub
    System.gc();
    super.onResume();

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub
    display = null;
    setWall2 = null;
    setWall3 = null;
    System.gc();
    super.onPause();
}

@Override
protected void onDestroy() {
    // TODO Auto-generated method stub

    ImageView image1 = (ImageView) findViewById(R.id.image1);
    image1.setImageDrawable(null);
    ImageView image2 = (ImageView) findViewById(R.id.image2);
    image2.setImageDrawable(null);
    ImageView image3 = (ImageView) findViewById(R.id.image3);
    image3.setImageDrawable(null);
    ImageView image4 = (ImageView) findViewById(R.id.image4);
    image4.setImageDrawable(null);
    ImageView image5 = (ImageView) findViewById(R.id.image5);
    image5.setImageDrawable(null);
    ImageView image6 = (ImageView) findViewById(R.id.image6);
    image6.setImageDrawable(null);
    ImageView image7 = (ImageView) findViewById(R.id.image7);
    image7.setImageDrawable(null);
    ImageView image8 = (ImageView) findViewById(R.id.image8);
    image8.setImageDrawable(null);
    ImageView image9 = (ImageView) findViewById(R.id.image9);
    image9.setImageDrawable(null);
    ImageView image10 = (ImageView) findViewById(R.id.image10);
    image10.setImageDrawable(null);
    ImageView image11 = (ImageView) findViewById(R.id.image11);
    image11.setImageDrawable(null);
    ImageView image12 = (ImageView) findViewById(R.id.image12);
    image12.setImageDrawable(null);
    ImageView image13 = (ImageView) findViewById(R.id.image13);
    image13.setImageDrawable(null);

    display = null;
    setWall2 = null;
    setWall3 = null;
    System.gc();
    super.onDestroy();
} 
```

}

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:42:34.313

你在关注 Youtube 上的教程吗？我也从其中一些开始，但学习了一些关于复合视图/视图组的非常低效的编码实践。首先，您真的不应该静态地创建这么多 imageView 对象并为每个对象设置单独的侦听器。这真的是非常糟糕的做法。所以完全避免这种方法。我的意思是，从现在开始习惯以正确的方式做事，这样你就不必像我一样回来改变/重新学习/把头撞到墙上太多:)！

您需要使用专门为此目的构建的 GridView、ListView、ViewFlipper、Gallery 或其他类型的容器。在使用当前方法时，您将不断遇到位图和 OOM 错误

[网格视图教程](http://developer.android.com/guide/topics/ui/layout/gridview.html)

[画廊教程](http://www.mobisoftinfotech.com/blog/android/android-gallery-widget-example-and-tutorial/)

# java - spring/hibernate JSR-303（Bean 验证）本地化消息中的命名参数

> ID：13790987
> 
> 赞同：3
> 
> 时间：2012-12-09T19:36:35.457
> 
> 标签：java, spring, localization, bean-validation, hibernate-validator

我有一个简单的 bean 在注册注册表模型上定义用户凭据：

```
public class UserCreds {
    @Length(min=1, max=50)
    @NotEmpty
    private String username;

    @Email
    private String email;

    @NotEmpty
    @Length(min=1, max=50)
    private String password;

    private String passwordConfirm;

    ... only obvious getters and setters below this line ...
} 
```

我在“userCreds”模型属性下传递它的实例，所以我有以下本地化包：

```
NotEmpty.userCreds.username=Username is required
NotEmpty.userCreds.password=Passsword is required
Length.userCreds.username=Username length must be between {2} and {1} symbols
Length.userCreds.password=Password length must be between {2} and {1} symbols
Email.userCreds.email=Ill-formed e-mail address 
```

它有效！

这里的问题：我不想使用这个神秘的 {N} 占位符，它可能偶尔会改变它们的位置（在捆绑中，'max' 以上绑定到 {1}，'min' 绑定到 {2}，它位于最不明显的定位）我希望使用注释的全名，如

```
Length.userCreds.username=Username length must be between {min} and {max} symbols 
```

（这不起作用-当我尝试时-出现`java.lang.IllegalArgumentException: can't parse argument number min`异常）

我可以在代码中定义消息（以下示例也适用）：

```
@Length(min=1, max=50, message = "Username length must be between {min} and {max} symbols")
@NotEmpty
private String username; 
```

但是当我在代码中定义它时，我失去了为不同语言本地化消息的能力。

做什么？

**更新 1**

~~在我的 IDE 中调试调试器几个小时后，我发现使用以下类：~~

 ~~```
public class BakaMessageSource extends ReloadableResourceBundleMessageSource {

    @Override
    protected MessageFormat resolveCode(String code, Locale locale) {
        /* original implementation *
        for (String basename : basenames) {
            List<String> filenames = calculateAllFilenames(basename, locale);
            for (String filename : filenames) {
                PropertiesHolder propHolder = getProperties(filename);
                MessageFormat result = propHolder.getMessageFormat(code, locale);
                if (result != null) {
                    return result;
                }
            }
        }
        */
        return null;
    }
} 
```~~ 

使用以下 spring-servlet.xml 声明：

```
<bean id="messageSource" class="org.eientei.radiorandom.framework.crutchy.BakaMessageSource"
          p:defaultEncoding="UTF-8"
          p:alwaysUseMessageFormat="false"
            >
        <property name="basenames">
            <list>
                <!-- my application-specific localization bundles -->
                <value>classpath:messages/root/errorMessages</value>
                <value>classpath:messages/root/langMessages</value>
                <value>classpath:messages/user/signupMessages</value>
            </list>
        </property>
    </bean> 
```

而不是原来的 ReloadableResourceBundleMessageSource 实际上有助于获取带有命名参数的本地化消息。

~~但我想当时交换课程并不是一个合适的解决方案。会是哪一个？~~

**更新 2**

我真是个白痴。我忘记了代码内消息，并认为它已正确插入。哎呀。所以，按字母顺序排列......我想我不能要求更多。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-09T20:10:46.780

我认为从 Spring 3.0.4 开始，实际顺序是按字母顺序排列的（“max”小于“min”）。

来自 SPR-6730 讨论（Juergen Hoeller 帖子）

> 对于第一个选项，Spring 管理的字段错误参数现在包括按字母顺序排列的实际约束注释属性。所以对于@Size(min=1,max=5)，它将包含字段名称为 {0} ，最大值为 {1} ，最小值为 {2}

见[https://jira.springsource.org/browse/SPR-6730](https://jira.springsource.org/browse/SPR-6730)

# android - 每 5 分钟执行一次代码，并在 2 分钟后完成。CountDownTimer 还是 Handler？

> ID：13790988
> 
> 赞同：0
> 
> 时间：2012-12-09T19:36:36.867
> 
> 标签：android

在android中，我需要每5分钟执行一次代码，并在运行时2分钟后完成。

什么更好用：

[http://developer.android.com/reference/android/os/CountDownTimer.html](http://developer.android.com/reference/android/os/CountDownTimer.html)

或者

[http://developer.android.com/reference/android/os/Handler.html](http://developer.android.com/reference/android/os/Handler.html)

我知道如何实现这两者，但我不知道什么更好，什么使用更少的内存和电池=

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:39:11.080

两者都不。使用`AlarmManager`和`IntentService`, 完成`IntentService`工作，如果工作尚未完成，两分钟后放弃。

# javascript - javascript映射所有路径

> ID：13790989
> 
> 赞同：1
> 
> 时间：2012-12-09T19:36:43.090
> 
> 标签：javascript

我无法弄清楚以下问题。在第 1 点我可以到第 2 点或第 5 点。从点到我可以到第 3 或第 4 点。从第 5 点我可以到第 6 或第 7 点。从第 7 点到第 9 点只有一条路径。我想计算所有完整路径。我不是在寻找最快的路线或任何东西。我需要以一种我可以轻松遵循它们的方式存在的所有路径。

我有两个问题：

1.  我不确定我是否使用正确的方式来“存储”选项（a[1]=[2,5]）。这可以吗还是有更好的方法？

2.  我不知道如何解决这个问题。谁能给我一个线索？我希望我在寻找正确的方向:-)

路径：

```
 1 ->2 ->3
        ->4
    ->5 ->6
        ->7 ->8 ->9 
```

和期望的结果：

```
 1,2,3
 1,2,4
 1,5,6
 1,5,7,8,9 
```

我尝试在 javascript 中解决这个问题

```
// this doesn't do what I need 
var a = [];
a[1]=[2,5];    
a[2]=[3,4];
a[5]=[6,7];
a[7]=[8];
a[8]=[9];

trytoloop(a,1);

function trytoloop(a,key){
    if(a[key]){
         for (var y in a[key]){
                document.write(key);

                trytoloop(a,a[key][y]);
         }
    } else {
        document.write(key);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:51:48.933

我在下面放了一个解决方案，但如果你不想剧透就不要看了！它只处理图中没有循环的情况。

一些没有给出答案的提示：我建议在你的递归函数中，你在第二个参数中跟踪到目前为止的整个路径，而不仅仅是当前位置，否则你最终会得到一个访问过的位置列表，但是你怎么知道把你带到每一个的路径？其次，在 Javascript 中，使用构造遍历数组并不是一种好的做法`for ... in`，因此您可以使用从 0 到数组长度的常规 for 循环。第三，你会想在某个时候打印出构建的路径，但你不想在每一步都这样做：相反，你想在路径完成时打印出来；也就是说，当从当前位置没有更多地方可去时。最后，我替换`document.write`为`console.log`，因为我相信`document.write`每次打印时都会覆盖文档内容。

```
var a = [];
a[1]=[2,5];
a[2]=[3,4];
a[5]=[6,7];
a[7]=[8,9];

trytoloop(a,[1]);

function trytoloop(a,path){
  var last = path[path.length - 1];
  var next_hops = a[last];
  // if there could be cycles, you might want to check that next_hops doesn't
  // contain any already visited locations
  if (next_hops) {
    for (var i = 0; i < next_hops.length; i++) {
      var new_path = path.concat([next_hops[i]]);
      trytoloop(a, new_path);
    }
  } else {
    console.log(path);
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-09T19:51:55.277

您没有跟踪到目前为止已建立的部分路径。不过，数组的想法似乎很好。这是一个带有一些更有意义名称的工作版本：http: [//jsfiddle.net/YkH5b/](http://jsfiddle.net/YkH5b/)。

```
// A cleaner way of defining the next keys
var nextKeysMap = {
    1: [2, 5],    
    2: [3, 4],
    5: [6, 7],
    7: [8],
    8: [9]
};

var fullPaths = [];
generateFullPaths([1], 1);  // start off with partial path [1] and thus at key 1

function generateFullPaths(partialPath, currentKey) {
    if(currentKey in nextKeysMap) {  // can we go further?
        var nextKeys = nextKeysMap[currentKey];  // all possible next keys
        for (var i = 0; i < nextKeys.length; i++) {  // loop over them
            var nextKey = nextKeys[i];
            // append the current key, and build the path further
            generateFullPaths(partialPath.concat(nextKey), nextKey);
         }
    } else {  // we cannot go further, so this is a full path
        fullPaths.push(partialPath);
    }
}

for(var i = 0; i < fullPaths.length; i++) {
    console.log(fullPaths[i].join(","));
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-09T20:09:31.450

这是我的解决方案：[小提琴](http://jsfiddle.net/rdiaz/EkdUK/)

最终输出到`console`，您可以在此处更改初始节点`console.log(getPaths(1));`（根据您的要求从节点 1 开始）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-09T20:00:55.707

我还没有尝试过，但是在我脑海中，您可以尝试以下方法：

```
// use an object, and set the numbers as keys and the values as the child options
var a = {};
a[1] = {2:{3:{},4:{}},5:{6:{},7:{8:{9:{}}}}};

(function trytoloop(obj,num,str){
    if(str.length>0) str += ',';
    str += num
    if(Object.keys(obj).length==0) document.writeln(str+'<br />');
    else for(var key in obj) trytoloop(obj[key],key,str);
})(a[1],1,''); 
```

# notepad++ - Notepad++ 查找和替换，删除某些行

> ID：13790993
> 
> 赞同：2
> 
> 时间：2012-12-09T19:36:57.550
> 
> 标签：notepad++

我的文件包含 18k 行，链接和 rondom ID 代码如下所示：

```
"http://arduino.cc/en/Main/ArduinoBoardNano
SC09661
http://arduino.cc/en/Main/ArduinoBoardUno
http://www.farnell.com/datasheets/1639172.pdf

SC09670
http://arduino.cc/en/Main/ArduinoBoardUno
SC09665
http://arduino.cc/en/Main/ArduinoEthernetShield
SC09662
http://arduino.cc/en/Main/ArduinoXbeeShield
CS23020
http://bcove.me/zypzpy2q
SC09147
http://cache.national.com/ds/LM/LM134.pdf
SC08546
http://cache.national.com/ds/LM/LM2574.pdf
SC08540
http://cache.national.com/ds/LM/LM2576.pdf" 
```

我需要从这个文件中删除所有那些 ID 代码（SC08540、SC09662、...）和不以 .pdf 结尾的链接，我知道它可以使用 Notepad++，但我不知道如何，也许有人可以帮助我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T20:21:36.533

找什么：`^((?!.pdf).)+$`

替换为：*留空*

并运行`Replace All`

我确定您不需要运行`[SC]+[0-9]+`来清除 ID 代码，因为第一个正则表达式会捕获它们

之后，用于`^\r?\n?$`从空行中清除