# StackOverflow 问答 14162000-14162999

# objective-c - GDB recursiveDescription 期间出现“无法识别的选择器”异常

> ID：14162001
> 
> 赞同：4
> 
> 时间：2013-01-04T17:35:54.940
> 
> 标签：objective-c, ios, xcode, gdb

在 Xcode 中使用 GDB 运行 recursiveDescription 时，我不断收到无法识别的选择器异常。具体来说，在断点处停止时，我在 GDB 中输入以下内容：

```
po [[self view] recursiveDescription] 
```

并得到以下异常：

```
-[UILabel length]: unrecognized selector sent to instance ... 
```

我不知道可能是什么标签导致了这种情况，也不知道如何进一步调查，更不用说修复它了。大概 recursiveDescription 的实现包括 [UILabel length] 调用，但是什么会导致我的标签破坏它呢？（我的用户界面非常简单，没有用标签或其他任何东西做任何不寻常的事情）。

非常感谢任何想法或提示。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T11:22:29.343

您可以尝试在 xcode 中添加异常断点。每当抛出异常时，断点就会在该行停止，因此您可以轻松了解代码中的问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T11:00:02.563

在**"Product > Scheme > Manage Schemes..."**下，选择您用于运行应用程序的方案。

选择左侧的**“运行”**，右侧面板的**“诊断” ，取消选中****“启用僵尸对象”**。

# c# - .net 设置（WinForms 或 WPF），在重新编译后重置为默认值时？

> ID：14162006
> 
> 赞同：1
> 
> 时间：2013-01-04T17:36:09.517
> 
> 标签：c#, wpf, winforms, visual-studio-2012

我在一些用户数据的设置 () 中使用了一个可序列化的（我们称之为`Gs`）类。`user.config`但是，有时当我在 VS2012 中重新编译我的应用程序时，设置消失了，这意味着重置为默认值（基本上是在使用的类的构造函数中设置的默认值）。在其他情况下，它们会持续存在。

**其实我想知道这是什么时候发生的。**首先我想，每当我改变时`Gs`。但这是不正确的，有时我对类进行了相当多的更改，但是在运行应用程序进行测试时，更改的值仍保持以前存储的状态。

另一方面，值被重置，没有任何变化`Gs`。下一个理论是每当我更改项目的版本号时。的路径`user.config`包含版本号。这可能是原因吗？但对于 ClickOnce 应用程序，更改版本号不会影响设置。有时这些值会在不更改版本号的情况下重置。

那么，当磁盘上的序列化值被清除并且更改没有影响时，**规则是什么。**猜测是组合，改了版本号`or`还有其他原因。

![我的项目中的设置](../Images/b27e02f55db911762a0856762bba4802.png)

# php - 使用 PHPExcel 设置列宽不起作用

> ID：14162013
> 
> 赞同：3
> 
> 时间：2013-01-04T17:36:26.230
> 
> 标签：php, phpexcel, xlsx

我正在尝试格式化我正在使用 PHPExcel 创建的文档的单元格宽度，但是当我使用 getColumnDimension('A')->setWidth(7) 方法时，它并没有在生成的 xlsx 文件中准确生成。

我在 Excel 中对文档进行了格式化，以便可以找到所需单元格的值，并得到两个值，一个以 Excel 单位表示，另一个以英寸为单位。

例如：

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth('7'); 
```

最终会给我一个 6.17 而不是 7 的列宽。我已经尝试过同时使用字符串和 int 值，没有任何变化。有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-04T17:51:00.590

这是因为 MS Excel 将图形本身调整为自己的内部单位：开发人员文档中有一个完整的部分（第 4.6.28 节，标题为“设置列的宽度”）解释了这一点。

从该部分的侧边栏中引用：

> PHPExcel 中的列宽度量与您在 Microsoft Office Excel 中可能习惯的度量不完全对应。列宽在 Excel 中很难处理，列宽有多种度量。
> 
> 1.  字符单位的内部宽度（例如 8.43，这可能是您在 Excel 中熟悉的）
> 2.  以像素为单位的全宽（例如 64 像素）
> 3.  字符单位的全宽（例如 9.140625，值 -1 表示未设置宽度）
> 
> PHPExcel 始终使用 3）“字符单位的全宽”，这实际上是存储在任何 Excel 文件中的唯一值，因此是最可靠的度量。**不幸的是，Microsoft Office Excel 没有为您提供此度量。相反，测量 1) 和 2) 由应用程序在打开文件时计算，这些值显示在各种对话框和工具提示中。**
> 
> 字符宽度单位是工作簿默认字体中“0”（零）字形的宽度。因此，只有在两个不同的工作簿具有相同的默认工作簿字体时，才能比较以字符为单位测量的列宽。
> 
> 如果您有一些 Excel 文件并且需要知道测量 3) 中的列宽，您可以使用 PHPExcel 读取 Excel 文件并回显检索到的值。

（我用粗体强调）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-08T21:10:38.203

将 0.71 添加到 excel 单元格宽度值并将该值赋予

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(10); 
```

例如：A Column width = 3.71（excel 值）

给列宽 = 4.42

将给出具有相同单元格宽度的输出文件。

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(4.42); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-29T09:07:20.323

在设置任何列的宽度之前，首先您需要禁用自动大小

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setAutoSize(false); 
```

之后，您需要设置一个宽度

```
$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(40); 
```

我在 MS Excel 中找到的宽度计算：MS Excel 从我们定义的大小减去 0.71。示例：当您在 MS Excel 设置宽度 39.29 的代码中定义宽度 40 时。放置任何列的确切所需大小的好方法，首先您在 MS Excel 中设置所需的宽度，然后在其中添加 0.71 并在您的代码中设置。

设置宽度后，您可以再次启用自动大小。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-01-04T17:40:45.937

试试这个：- 在设置宽度之前添加以下行：-

```
$objPHPExcel->setActiveSheetIndex(0); 
```

# svn - svnserve 和 http DAV 可以共享 SVN 认证/授权配置吗？

> ID：14162019
> 
> 赞同：0
> 
> 时间：2013-01-04T17:37:12.250
> 
> 标签：svn, apache

我有一个配置有多个存储库的 SVN 服务器，这些存储库通过 svnserve（协议 svn://）访问。它们都共享相同的 passwd（和 authz）文件。

我已经通过 apache 成功配置了对存储库的 DAV http（和 https）访问。在 svn-book 中，身份验证和授权是通过为 AuthUserFile 和 AuthzSVNAccessFile 定义的文件配置的。

然而，这意味着您必须维护两组身份验证/授权文件，一组用于 svn:// 协议，另一组用于 http://。**是否可以为两种协议使用单一配置**，因此您不会冒险配置不同的规则/用户/密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:38:38.677

**简短的回答**：没有

**更长的答案**：至少 svnserve 和 DAV 的用户文件完全不同（`user = pass`纯文本 vs `user:somehash`），您可以共享基于路径的授权文件

# gwt - 无法配置 gwt 设计器

> ID：14162021
> 
> 赞同：0
> 
> 时间：2013-01-04T17:37:18.303
> 
> 标签：gwt, gxt, gwt-designer

我已经建立了我的 GXT 项目并且能够运行它。我还安装了 GWT 设计器插件。但是当我进入设计视图时，我收到一条错误消息，说 GXT 需要一些 gxt-.css 文件。我已按照所有说明操作，并在我的 war 目录中复制了资源文件夹我正在使用 GWT 2.5 和 GXT 2.2.5 我附上了我的错误的屏幕截图。

谢谢。![这就是我得到的错误](../Images/116953ceda0badc271d0c596243326ad.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T16:49:01.770

[在 GWT Designer http://code.google.com/p/google-web-toolkit/issues/detail?id=6093](http://code.google.com/p/google-web-toolkit/issues/detail?id=6093)中报告并修复了一个类似问题

检查您的 GWT Designer 插件版本或 Eclipse 版本。否则，这可能是 GWT 团队的回归问题。

# python - 如何使用多个索引从 NumPy 数组中获取值

> ID：14162026
> 
> 赞同：45
> 
> 时间：2013-01-04T17:37:35.260
> 
> 标签：python, numpy

我有一个如下所示的 NumPy 数组：

```
arr = np.array([100.10, 200.42, 4.14, 89.00, 34.55, 1.12]) 
```

如何通过索引从此数组中获取多个值？

例如，如何获取索引位置 1、4 和 5 的值？

我正在尝试这样的事情，这是不正确的：

```
arr[1, 4, 5] 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-01-04T17:44:11.513

试试这样：

```
>>> arr = np.array([100.10, 200.42, 4.14, 89.00, 34.55, 1.12])
>>> arr[[1,4,5]]
array([ 200.42,   34.55,    1.12]) 
```

对于多维数组：

```
>>> arr = np.arange(9).reshape(3,3)
>>> arr
array([[0, 1, 2],
       [3, 4, 5],
       [6, 7, 8]])
>>> arr[[0, 1, 1], [1, 0, 2]]
array([1, 3, 5]) 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-11-04T11:37:42.763

另一种解决方案是`np.take`按照[https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.take.html中的说明使用](https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.take.html)

```
a = [4, 3, 5, 7, 6, 8]
indices = [0, 1, 4]
np.take(a, indices)
# array([4, 3, 6]) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-04T17:45:07.097

你很亲近

```
>>> print arr[[1,4,5]]
[ 200.42   34.55    1.12] 
```

# yii - 如何更改 portlet 小部件的输出

> ID：14162030
> 
> 赞同：0
> 
> 时间：2013-01-04T17:37:54.637
> 
> 标签：yii, widget

我正在做一个由 Yii 开发的项目。

我的工作是为它实现一个模板。开发者使用

```
$this->widget('SearchBlock', array(
         )); 
```

创建一个搜索块。但是块的标题在标签中。

如何更改 CPortlet 小部件的输出以便为标题放置标签而不是标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T16:12:53.687

是的，CPortlet 在块内容周围添加标签。如果您不想要这些标签或想要使用您自己的标签，您应该使用 CWidget。只需打开小部件类文件 - SearchBlock.php - 并从 CWidget 而不是 CPortlet 扩展类。但是 CWidget 没有 renderContent() 方法，因此您需要将其更改为 run() 。

此外，您可能需要将 import CPortlet 行替换为以下行：

```
Yii::import('zii.widgets.CWidget'); 
```

# c# - 按主机名的 MVC4 捆绑包

> ID：14162032
> 
> 赞同：7
> 
> 时间：2013-01-04T17:37:59.317
> 
> 标签：c#, asp.net-mvc-4, bundle

我是 MVC 的新手。

我知道如何创建捆绑包，它很简单，而且是一个很棒的功能：

```
 bundles.Add(new StyleBundle("~/content/css").Include(
    "~/content/main.css",
    "~/content/footer.css",
    "~/content/sprite.css"
    )); 
```

但是，假设您的应用程序可以在不同的域下访问，并根据主机名使用不同的 css 提供不同的内容。

如何让捆绑包根据主机名包含不同的文件？在我的 RegisterBundles 所在的应用程序开始（就像我开始使用的 MVC 标准互联网应用程序一样）我什至不知道主机名。

最佳实践是什么？

如果我在注册捆绑包时有可用的主机名，我可以为当前主机名选择正确的 .css 文件。例如，我可以在应用程序开始请求上注册捆绑包，并以某种方式检查它是否已经注册，如果没有，为请求的主机名选择正确的文件并注册它？

如果是，如何？

**编辑 1**

在过去的两个小时里，我对这个话题进行了更深入的研究，让我提出我的解决方案，希望比我更熟悉 MVC 的人可以纠正我的方法，如果错误的话。

我更换了：

```
@Styles.Render("~/Content/css") 
```

和：

```
@Html.DomainStyle("~/Content/css") 
```

这只是一个简单的助手：

```
public static class HtmlExtensions
{
  public static IHtmlString DomainStyle(this HtmlHelper helper, string p)
  {
    string np = mynamespace.BundleConfig.RefreshBundleFor(System.Web.Optimization.BundleTable.Bundles, "~/Content/css");

    if (!string.IsNullOrEmpty(np))
      return Styles.Render(np);
    else
    {
      return Styles.Render(p);
    }
  }
} 
```

RefreshBundleFor 在哪里：

```
public static string RefreshBundleFor(BundleCollection bundles, string p)
{
  if (bundles.GetBundleFor(p) == null)
    return null;

  string domain = mynamespace.Utilities.RequestUtility.GetUpToSecondLevelDomain(HttpContext.Current.Request.Url);

  string key = p + "." + domain;

  if (bundles.GetBundleFor(key) == null)
  {
    StyleBundle nb = new StyleBundle(key);

    Bundle b = bundles.GetBundleFor(p);
    var bundleContext = new BundleContext(new HttpContextWrapper(HttpContext.Current), BundleTable.Bundles, p);

    foreach (FileInfo file in b.EnumerateFiles(bundleContext))
    {
      string nf = file.DirectoryName + "\\" + Path.GetFileNameWithoutExtension(file.Name) + "." + domain + file.Extension;
      if (!File.Exists(nf))
        nf = file.FullName;

      var basePath = HttpContext.Current.Server.MapPath("~/");
      if (nf.StartsWith(basePath))
      {
        nb.Include("~/" + nf.Substring(basePath.Length));
      }
    }
    bundles.Add(nb);
  }

  return key;
} 
```

而 GetUpToSecondLevelDomain 只是从主机名中返回二级域，因此 GetUpToSecondLevelDomain("www.foo.bar.com") = "bar.com"。

如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T02:32:04.447

过于复杂 - 请求对象在 Application_Start 中可用。只需使用：

```
var host = Request.Url.Host; 
```

在您注册您的捆绑包并根据返回的值有条件地注册您的捆绑包之前。

**更新** 使用域密钥注册所有捆绑包：

```
StyleBundle("~/content/foo1.css")...
StyleBundle("~/content/foo2.css")... 
```

然后在所有控制器继承的基本控制器中，您可以构建捆绑名称以传递给视图：

```
var host = Request.Url.Host;  // whatever code you need to extract the domain like Split('.')[1]
ViewBag.BundleName = string.Format("~/content/{0}.css", host); 
```

然后在布局或视图中：

```
@Styles.Render(ViewBag.BundleName) 
```

# javascript - Javascript 在每个输出数组值的末尾附加一个换行符

> ID：14162033
> 
> 赞同：0
> 
> 时间：2013-01-04T17:38:03.713
> 
> 标签：javascript

当我运行以下代码时，br 将附加到日期列表的末尾。我试图让 br 在数组中的每个日期值之后附加。我尝试使用 for 循环，但这似乎不起作用。我究竟做错了什么？

```
dates = ['2012-09-06 22:39:29', '2012-09-06 22:41:02', '2012-11-05 15:01:10', '2012-11-06 15:37:58', '2012-09-08 10:22:00'];

$('#hi').append(dates.sort() + '<br>'); 
```

对于循环：

```
for(i = 0; i < dates.length; i++) {
    $('#hi').append(dates.sort() + '<br>');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:40:56.720

尝试：

```
dates.sort();
$("#hi").append(dates.join("<br />") + "<br />"); 
```

我不知道你怎么想`dates.sort()`，但你用它很奇怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:42:39.260

那是因为你有效地将整个数组与 BR 标签连接起来。考虑以下示例：

```
 dates.sort();
    for(i = 0; i < dates.length; i++) {
        $('#mydiv').append(dates[i] + '<br>');
    } 
```

# html - 如何在不破坏标记的情况下用包装器包装任意 HTML？

> ID：14162035
> 
> 赞同：3
> 
> 时间：2013-01-04T17:38:14.337
> 
> 标签：html, block, inline

我有以下 HTML

```
some text [selected HTML] more text 
```

我想用一个标记元素包装 [selected HTML] 部分，所以 a）我可以应用一些标记（颜色为浅蓝色）和 b）所以我可以用 jQuery 和 C 找到它，这样我就可以为服务器标记它什么时候我将所有 HTML 发送到服务器。我怎么能在不改变页面外观的情况下做到这一点？

如果我使用 DIV 元素，那将创建一个块元素，如果任意 HTML 只是文本，我绝对不想要它。

```
some text 
<div>[selected HTML which is text]</div>
more text 
```

如果我使用 SPAN 元素（即使使用`style='display:inline-block'`），那么我会假设任意 HTML 是内联的，这是我无法假设的。包裹 a`SPAN`是`DIV`无效的，不是吗？

```
some text 
<span style='inline-block;'>[selected HTML with <div>]</span>
more text 
```

有什么我可以使用的只是“标记”HTML，但不会在它周围创建块或内联元素吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T19:41:36.317

有一个元素“只是'标记'HTML，但不会在其周围创建块或内联元素”，即[`ins`](http://www.w3.org/TR/REC-html40/struct/text.html#edef-ins)元素。从语法上讲，`ins`and`del`元素“可以作为块级元素或内联元素（但不能同时作为两者）。它们可能在一个段落中包含一个或多个单词，或者包含一个或多个块级元素，例如段落、列表和表格”。

原则上，`ins`表示已“针对不同版本的文档插入 [...]”的内容。但我认为任何软件都不会认真对待这一点，*除非*现代浏览器通常默认强调内容。但是这种行为（在 CSS 2.1 规范和 HTML5 草案中是鼓励的）可以被覆盖，使用通常的 CSS 警告，很简单：

```
ins { text-decoration: none; } 
```

# javascript - 在 JavaScript 中，什么是终极根、对象或函数？

> ID：14162038
> 
> 赞同：13
> 
> 时间：2013-01-04T17:38:23.357
> 
> 标签：javascript, function, object

在 JavaScript 中，对象是所有实体的根还是函数是根？

例如在下面的源[objects-functions-and-prototypes-in.html](http://sidd-reddy.blogspot.com/2012/07/objects-functions-and-prototypes-in.html)中，首先作者说“Javascript 中的每个实体都是一个对象”，然后它说“任何新对象只能作为函数的实例创建（即使你执行 'var a = new Object;'，Object 也是一个函数）”。据我所知，作者基本上是自相矛盾的。

我在 JavaScript 的许多其他资源中看到了同样混乱的评论。在 Java 中这很容易，您知道任何类层次结构中的第一个实体是 Object 类，但在 JavaScript 中，我看到的只是混乱。

那么，有人可以澄清一下对象是先还是函数？什么是根。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-04T17:51:28.610

我相信该行的结尾是`Object.prototype`，这是一个对象。这就是让我这么想的原因：

```
Function.prototype;                    // the empty function object
Function.prototype.__proto__;          // the default Object prototype
Object.prototype;                      // the default Object prototype
Object.prototype.__proto__;            // null 
```

ECMAScript 5.1 规范是这样声明的：

1.  在[15.3.4 函数原型对象的属性中](http://es5.github.com/#x15.3.4)：

    > Function原型对象的[[Prototype]]内部属性的值是标准的内置Object原型对象

2.  并在[15.2.4 对象原型对象的属性](http://es5.github.com/#x15.2.4)

    > Object原型对象的[[Prototype]]内部属性的值为`null`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-03-08T17:23:45.207

这是[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/prototype)必须`Object.prototype`说的：

> 所有对象都从 Object.prototype 继承方法和属性，尽管它们可能被覆盖（除了具有空原型的对象，即 Object.create(null)）。

换句话说，`Object.prototype`是**几乎所有**对象的根。两者`Object`和`Function`都是 的子级`Function.prototype`，而后者本身就是 的子级`Object.prototype`。

当我忽略构造函数并专注于原型链时，我发现 Javascript 中的继承更容易理解。对我来说，这样做会使问题和答案都变得更简单；像这样的问题：

*   什么是对象的原型链？
*   给定两个对象 x 和 y，x 在 y 的原型链中吗？（或者：y 是否从 x 继承？）

您可以使用这个小片段（[此处](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getPrototypeOf)的有用文档）轻松地自己研究原型链：

```
function getPrototypes(obj) {
    var protos = [],
        parent = obj;
    while ( true ) {
        parent = Object.getPrototypeOf(parent);
        if ( parent === null ) {
            break;
        }
        protos.push(parent);
    }
    return protos;
} 
```

根据这个函数，[原语](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Glossary)没有原型：

```
> getPrototypes(3)
TypeError: Object.getPrototypeOf called on non-object 
```

所以让我们把图元排除在外。对于对象，层次结构看起来像这样（其中子级缩进到其父级的右侧）。据我所知，真正的多重继承在 Javascript 中是不可能的，所以每个对象都有一个父对象，除了`Object.prototype`没有父对象：

*   `Object.create(null)`
*   对象.原型
    *   `arguments`
    *   `Object.create(Object.prototype)`
    *   `{}`
        *   `Object.create({})` --*假设`{}`是上一行的对象，而不是单独的新对象*
    *   JSON
    *   数学
    *   Array.prototype
        *   `[]`
        *   `new Array()`
    *   函数原型
        *   大批
        *   目的
        *   功能
        *   数字
        *   布尔值
        *   细绳
        *   正则表达式
        *   `function MyFunction() {}`
        *   `Object.keys`
        *   `Object.prototype.toString`
        *   `Object.prototype.toString.call`
        *   `getPrototypes`
    *   MyFunction.prototype
        *   `new MyFunction()`
    *   String.prototype
        *   `new String('abc')`
            *   `Object.create(new String('abc'))`
    *   Number.prototype
        *   `new Number(41)`
    *   Boolean.prototype
        *   `new Boolean()`
        *   `new Object(false)`
    *   正则表达式原型
        *   `/a/`

这非常令人困惑！请注意，在大多数情况下，`X.prototype`它不是`X`!的原型。如果我们有一些更好的术语，情况可能会有所改善；但是......我们不 :( 如您所见，构造函数如`Number`和 与`Boolean`它们生成的对象处于单独的子层次结构中。此外，`Object`它本身继承自`Function.prototype`继承自`Object.prototype`.

如果您尝试这些示例，您还会发现使用该`constructor`属性是检查对象原型的一种糟糕方法，原因有几个。鉴于`var str1 = new String('abc'); var str2 = Object.create(str1);`，这就是为什么：

1.  一个对象可以是多个构造函数的一个实例：`str1 instanceof String`并且`str1 instanceof Object`都为真。这没有反映在`constructor`属性中：`str1.contructor === String`

2.  有时，我们在对象的原型链中找不到每个对象的构造函数： `Object.getPrototypeOf(str2).constructor === String`. 这是因为该`constructor`属性继承自`String.prototype`：both`str1.hasOwnProperty('constructor')`和`str2.hasOwnProperty('constructor')`为假，而`Object.getPrototypeOf(str1).hasOwnProperty('constructor')`为真。幸运的是，您可以使用该[`Object.prototype.isPrototypeOf`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/isPrototypeOf)方法来代替： `str1.isPrototypeOf(str2)`是真的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-04T17:40:17.967

你误会了。

Javascript 中的一切（包括所有函数）都是一个对象。

但是，每个对象都是函数的一个*实例*。（由对象的`constructor`属性指定）

# mysql - mysql的随机值

> ID：14162043
> 
> 赞同：0
> 
> 时间：2013-01-04T17:38:46.220
> 
> 标签：mysql, random, mysql-workbench

我想为表中的每一行创建不同的随机值，我尝试了以下方法：

```
select t.col1, rnd() from t; 
```

但`rnd()`只是为每一行创建了 1 个相等的随机值。是否可以仅使用 mysql 为 n 行创建 n 个不同的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T17:43:41.273

它适用于[`rand()`](http://dev.mysql.com/doc/refman/5.5/en/mathematical-functions.html#function_rand). 它为表中的每一行创建一个新的随机数

```
select col1, rand()
from t 
```

请参阅[SQL 小提琴](http://www.sqlfiddle.com/#!2/ee6f9/3/0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T17:44:46.103

它应该为每一行创建一个新号码。文档在这里：[http ://dev.mysql.com/doc/refman/5.0/en//mathematical-functions.html#function_rand](http://dev.mysql.com/doc/refman/5.0/en//mathematical-functions.html#function_rand)

它是转换为int还是什么？此外，如果您不想要从 0 到 1 的数字，那么您需要执行以下操作：

```
select t.col1, FLOOR(7 + (RAND() * 5)) from t; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T21:46:50.273

该`rnd()`函数是“round”的缩写，它只是四舍五入，在这种情况下，什么都没有。

# delphi - Rave Report (delphi)，计算（在代码中）垂直元素位置/大小

> ID：14162044
> 
> 赞同：0
> 
> 时间：2013-01-04T17:38:50.540
> 
> 标签：delphi, printing

是否可以（如何？）在打印之前计算元素大小（高度、宽度）？我正在寻找解决方案来检测是否需要使用（或不使用）指令 NewPage 如果下一个组件太大而无法在实际页面中固定。正是我有问题：

```
 var
  MemoBuf: TMemoBuf;
  begin
    MemoBuf := TMemoBuf.Create;
    MemoBuf.Text:=some_text;
    MemoBuf.PrintStart := 0.2; 
    MemoBuf.PrintEnd := SectionRight;
    //here is the main problem
    PrintMemo(MemoBuf, 0, false);
    MemoBuf.Free;
  end; 
```

我不知道的地方：我是插入“newpage”还是没有固定孔MemoBuf代替打印页面。

所有建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:49:15.700

我找到了解决方案：它使用的是 MemoBuf.ConstrainHeightLeft 方法。

# sql - Case 语句的多个 Then 值

> ID：14162046
> 
> 赞同：2
> 
> 时间：2013-01-04T17:39:25.030
> 
> 标签：sql, case

不确定这是否有意义，我正在尝试编辑现有存储过程以将变量添加到“Where”子句中，以返回所有值、无值或每条记录而不考虑值。

我在 Where 子句中使用 Case When/ Then 语句。

```
 WHERE 
      CASE (@work)
  WHEN 'Y' THEN part.corpid = ( 'Work EMP' , 'Work EMP 10' , 'Work FAM' )
  WHEN 'N' THEN part.corpid != ( 'Work EMP' , 'Work EMP 10' , 'Work FAM' )   
  ELSE part.corpid = *
  END 
```

设置是，如果是 Y，则仅返回员工及其家人，如果 N 则不返回任何员工或其家人，如果变量中为 NULL，则返回所有内容。

我不知道我在这里搞砸了什么，我在 Y 部分的 = 上不断出现错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T17:47:03.667

您应该能够使用以下`WHERE`子句：

```
WHERE 
(
  @work = 'Y'
  AND part.corpid IN ( 'Work EMP' , 'Work EMP 10' , 'Work FAM' )
)
OR
(
  @work = 'N'
  AND part.corpid NOT IN ( 'Work EMP' , 'Work EMP 10' , 'Work FAM' )
) 
OR
(
  @work is null 
  -- add other filters here if needed
  -- no need to include the part.corpid because all will be included
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:22:30.820

这是 Oracle 示例：

```
CASE grade 
  WHEN 'A' THEN dbms_output.put_line('Excellent');
  WHEN 'B' THEN dbms_output.put_line('Very Good');
  WHEN 'C' THEN dbms_output.put_line('Good');
  WHEN 'D' THEN dbms_output.put_line('Fair');
  WHEN 'F' THEN dbms_output.put_line('Poor');
  ELSE dbms_output.put_line('No such grade');
END CASE; 
```

# objective-c - iOS UI 导致我的音频流出现故障

> ID：14162053
> 
> 赞同：0
> 
> 时间：2013-01-04T17:39:54.520
> 
> 标签：objective-c, multithreading, core-audio, circular-buffer

我正在为 iPhone 编写一个基于 VOIP 的应用程序。我遇到了一个奇怪的问题，当用户按下屏幕时音频出现故障，当您按下手机本身的音量增大/减小按钮时也会发生这种情况。经过几天的调试，我发现它与我的循环缓冲区有关。我在这里换了一个：

[http://atastypixel.com/blog/a-simple-fast-circular-buffer-implementation-for-audio-processing/](http://atastypixel.com/blog/a-simple-fast-circular-buffer-implementation-for-audio-processing/)

这不会导致故障，但延迟比我的要长近 4 倍，我必须有最小的延迟并且无法弄清楚我的应用程序发生了什么。

设置：

我跟着： http: [//www.stefanpopp.de/2011/capture-iphone-microphone/](http://www.stefanpopp.de/2011/capture-iphone-microphone/)有点制作基本应用程序，但我有不同的设置/功能等。我有一个视图控制器，它有这个 audioProcessor 类的属性，这个类有一个用于循环缓冲区的变量。在录制回调中我发送数据，这一切都很好。在 CFSocket 回调中，我将来自网络的数据添加到此缓冲区，然后播放回调从此缓冲区中提取数据并将其传递给系统。

在播放过程中的某个时刻，如果用户按下会触发 UI 事件，这一切都会变得很糟糕，并且会出现这个奇怪的数据。我猜这是某种线程问题，但我在这方面几乎没有经验。我会很感激任何帮助。下面是相关代码：

**网络回调 - 将数据添加到缓冲区：**

```
static void addDataToBuffer(CFSocketRef socket, CFSocketCallBackType type, CFDataRef address, const void *data, void *info)
{
    AudioUnitCBufferProduce(&audioProcessor->auCBuffer, (uint8_t*)[(__bridge NSData *)data bytes], [(__bridge NSData *)data length]);
} 
```

**音频单元播放 - 从缓冲区复制数据并放入指向 ioData 的“targetBuffer”：**

```
static OSStatus playbackCallback(void *inRefCon,
                             AudioUnitRenderActionFlags *ioActionFlags,
                             const AudioTimeStamp *inTimeStamp,
                             UInt32 inBusNumber,
                             UInt32 inNumberFrames,
                             AudioBufferList *ioData)
{

    uint8_t *targetBuffer = (uint8_t*)ioData->mBuffers[0].mData;
    AudioUnitCBufferConsume(&audioProcessor->auCBuffer, targetBuffer, inNumberFrames);

    return noErr;
} 
```

**缓冲区初始化：**

```
void AudioUnitCBufferInit(AudioUnitCBuffer *b)
{
  // create array of bytes of length specified, fill with silence
  uint8_t buffer[2048];

  for(int i = 0; i < 2048; i++)
  {
      buffer[i] = 0xd5;
  }

  // init buffer elements
  b->buffer = buffer;
  b->consumer = buffer;
  b->producer = buffer;
  b->length = 2048;
} 
```

**缓冲区生产者/消费者：**

这是为了让你传入一个指向函数的指针，然后用数据填充这个指针，如果没有数据，指针将用 ALAW 十六进制值填充以保持静音。这使音频单元代码保持较小，因为缓冲区确保它始终向其提供数据。这也比复制到某个临时位置然后 memcpy 将其放入上面链接使用的缓冲区中要快得多，而且对于我的需要来说远远慢。

```
inline static void AudioUnitCBufferProduce(AudioUnitCBuffer *b, uint8_t *bytes, int32_t len)
{   
//printf("\n\ninside producer: len %i \n\n", len);
while(len--)
{
    // if producer catches up with consumer, skip a byte
    if (b->producer+1 == b->consumer)
    {
        //printf("b->producer+1 == b->consumer == continue \n");
        continue;
    }
    else
    {
        //printf("b->producer+1 != b->consumer == add byte \n");
        *b->producer = *bytes++;
        b->producer++;

        if(b->producer == &b->buffer[b->length-1])
        {
            //printf("\n\nproducer == end, skipping \n\n");
            b->producer = b->buffer;
        }
    }
}
}

inline static void AudioUnitCBufferConsume(AudioUnitCBuffer *b, uint8_t *bytes, int32_t len)
{
while(len--)
{
    // if producer catches up with consumer, skip a byte
    if (b->consumer == b->producer)
    {
        *bytes++ = 0xd5;
    }
    else
    {
        *bytes++ = *b->consumer;
        b->consumer++;

        if(b->consumer == &b->buffer[b->length-1])
        {
            b->consumer = b->buffer;
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T15:06:09.687

Ok 写了一种不同风格的 Circular 缓冲区，似乎已经成功了，延迟非常相似，没有故障。我仍然不完全明白为什么这会更好，请有这方面经验的任何人分享。

由于苹果发布的这些东西很少，下面是我的循环缓冲区实现，它适用于我的 VOIP 设置，请随意使用它，欢迎任何建议，如果没有就不要来找我为你工作。这次它是一个objective-c类。

请注意，这是设计用于 ALAW 格式而非线性 PCM，“0xd5”是 ALAW 中的一个静音字节，不确定这在 PCM 中会是什么，但预计会是噪音。

**循环缓冲区.h：**

```
//
//  CircularBuffer.h
//  clevercall
//
//  Created by Simon Mcloughlin on 10/1/2013.
//
//

#import <Foundation/Foundation.h>

@interface CircularBuffer : NSObject

-(int) availableBytes;
-(id) initWithLength:(int)length;
-(void) produceToBuffer:(const void*)data ofLength:(int)length;
-(void) consumeBytesTo:(void *)buf OfLength:(int)length;

@end 
```

**循环缓冲区.m：**

```
//
//  CircularBuffer.m
//  clevercall
//
//  Created by Simon Mcloughlin on 10/1/2013.
//
//

#import "CircularBuffer.h"

@implementation CircularBuffer
{
    unsigned int gBufferLength;
    unsigned int gAvailableBytes;
    unsigned int gHead;
    unsigned int gTail;
    void *gBuffer;
}

// Init instance with a certain length and alloc the space
-(id)initWithLength:(int)length
{
    self = [super init];

    if (self != nil)
    {
        gBufferLength = length;
        gBuffer = malloc(length);
        memset(gBuffer, 0xd5, length);

        gAvailableBytes = 0;
        gHead = 0;
        gTail = 0;
    }

    return self;
}

// return the number of bytes stored in the buffer
-(int) availableBytes
{
    return gAvailableBytes;
}

-(void) produceToBuffer:(const void*)data ofLength:(int)length
{
    // if the number of bytes to add to the buffer will go past the end.
    // copy enough to fill to the end
    // go back to the start
    // fill the remaining
    if((gHead + length) > gBufferLength-1)
    {
        int remainder = ((gBufferLength-1) - gHead);
        memcpy(gBuffer + gHead, data, remainder);
        gHead = 0;
        memcpy(gBuffer + gHead, data + remainder, (length - remainder));
        gHead += (length - remainder);
        gAvailableBytes += length;
    }
    // if there is room in the buffer for these bytes add them
    else if((gAvailableBytes + length) <= gBufferLength-1)
    {
        memcpy(gBuffer + gHead, data, length);
        gAvailableBytes += length;
        gHead += length;
    }
    else
    {
        //NSLog(@"--- Discarded ---");
    }
}

-(void) consumeBytesTo:(void *)buf OfLength:(int)length
{
    // if the tail is at a point where there is not enough between it and the end to fill the buffer.
    // copy out whats left
    // move back to the start
    // copy out the rest
    if((gTail + length) > gBufferLength-1 && length <= gAvailableBytes)
    {
        int remainder = ((gBufferLength-1) - gTail);
        memcpy(buf, gBuffer + gTail, remainder);
        gTail = 0;
        memcpy(buf + remainder, gBuffer, (length -remainder));
        gAvailableBytes-=length;
        gTail += (length -remainder);
    }
    // if there is enough bytes in the buffer
    else if(length <= gAvailableBytes)
    {
        memcpy(buf, gBuffer + gTail, length);
        gAvailableBytes-=length;
        gTail+=length;
    }
    // else play silence
    else
    {
        memset(buf, 0xd5, length);
    }
}

@end 
```

# xcode - Mac OSX：如何知道应用程序是否在会话启动/登录时自动启动？

> ID：14162059
> 
> 赞同：6
> 
> 时间：2013-01-04T17:40:15.820
> 
> 标签：xcode, macos, session, startup, app-startup

我的应用程序的用户可以选择是否要（或不）在会话启动时启动我的应用程序。

为此，我使用 LSSharedFileListRef ，如下所述：[How do you make your App open at login?](https://stackoverflow.com/questions/815063/how-do-you-make-your-app-open-at-login)

我现在想知道我的应用程序是在会话启动时自动启动还是通过单击 Dock 中的图标启动。确实，在这两种情况下，我必须采取不同的行动。

我感觉不可能在下面的委托方法中使用通知的参数来做到这一点：

```
- (void)applicationDidFinishLaunching:(NSNotification *)notification 
```

我看过以下帖子，但它们没有帮助：

[我如何知道我的应用程序是如何在 Mac OS 上启动的？](https://stackoverflow.com/questions/6687824/how-can-i-know-how-my-app-was-launched-on-mac-os)=>没有答案，除了一些没有帮助的其他帖子的链接......

[知道用户是否启动了应用程序](https://stackoverflow.com/questions/12465100/know-if-the-user-launched-an-app)=> 我不知道如何设置/获取本文中定义的“Y”参数

[Mac OS X：登录时打开应用程序，不显示主窗口](https://stackoverflow.com/questions/5597328/mac-os-x-open-application-at-login-without-showing-the-main-window)=> 处理启动时隐藏或不隐藏主窗口的事实；我想要的是更笼统的：如何知道应用程序是如何启动的？

任何人都可以帮助我吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:44:57.330

如果应用程序设置为在启动时运行，它将运行（为什么不呢？）。因此，您可以在某处保存应用程序的启动时间。并且在以后的运行中（比如用户退出你的应用程序并再次运行）检查是否有这个参数，如果它晚于系统启动时间，那么这个时间的应用程序不会自动运行。

您可以通过 [NSProcessInfo systemUptime] 查看系统启动时间

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:47:30.467

我会检查父进程 ID。如果它等于 1，则表示它是由 launchd 在启动时启动的。

```
struct kinfo_proc info;
size_t length = sizeof(struct kinfo_proc);
int mib[4] = { CTL_KERN, KERN_PROC, KERN_PROC_PID, pid };
if (sysctl(mib, 4, &info, &length, NULL, 0) < 0)
    return OPProcessValueUnknown;
if (length == 0)
    return OPProcessValueUnknown;

 //info.kp_eproc.e_ppid is what you need 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T22:02:51.793

如果你不能得到@bioffe 的答案，这里又多了一点：

来自：[http ://www.objectpark.net/parentpid.html](http://www.objectpark.net/parentpid.html)

```
#include <sys/sysctl.h>

#define OPProcessValueUnknown UINT_MAX

//Returns the parent process id for the given process id (pid).
int OPParentIDForProcessID(int pid)
{
    struct kinfo_proc info;
    size_t length = sizeof(struct kinfo_proc);
    int mib[4] = { CTL_KERN, KERN_PROC, KERN_PROC_PID, pid };
    if (sysctl(mib, 4, &info, &length, NULL, 0) < 0)
        return OPProcessValueUnknown;
    if (length == 0)
        return OPProcessValueUnknown;
    return info.kp_eproc.e_ppid;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T22:28:14.200

`last | grep '^reboot' | awk 'END { print $3" "$4" "$5" "$6 }'`正如@AnoopVaidya 指出的那样，打开一个终端窗口，键入以获取重新启动时间并匹配特定应用程序启动的时间。

# ios - 快速枚举并将对象添加到 NSMutableArray

> ID：14162065
> 
> 赞同：-2
> 
> 时间：2013-01-04T17:40:33.493
> 
> 标签：ios, nsmutablearray, fast-enumeration

我正在尝试将对象添加到`NSMutableArray "allItems1"`

```
for (PMGWine *w in [[PMGWineStore sharedStore]allItems]) {

    [allItems1 addObject:w];

    NSLog(@"%@", w);

}

    NSLog(@"%d", [allItems1 count]); 
```

`[[PMGWineStore sharedStore]allItems]``NSLog`由 15 个对象组成，这些对象在第一个语句中完美打印。但`[allItems1 count]`显示为 0。我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T17:45:34.147

问题是您没有分配 allItems1 数组。

请在 for 循环之前添加此行。

```
allItems1 = [[NSMutableArray alloc] init]; 
```

您也可以使用：

```
allItems1 = [[NSMutableArray arrayWithArray:[[PMGWineStore sharedStore] allItems]] retain]; 
```

或者

```
allItems1 = [[PMGWineStore sharedStore] allItems] copy]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T17:45:45.837

你可能忘记初始化`allItems1`NSMutableArray。在`for`你写之前

```
allItems1 = [[NSMutableArray alloc] init]; 
```

你也可以写：

```
allItems1 = [NSMutableArray arrayWithArray:[[PMGWineStore sharedStore]allItems]]; 
```

而不是 for 循环。

# xcode - Xcode用户默认值无法识别的选择器错误

> ID：14162071
> 
> 赞同：0
> 
> 时间：2013-01-04T17:40:55.860
> 
> 标签：xcode, unrecognized-selector, defaults

我开始在 Cocoa 上使用用户默认值，并且收到 [NSConcreteData alphaComponent]: unrecognized selector sent to instance`0x100123660`错误。这是源代码：

AppDelegate.m 文件：

```
- (void)awakeFromNib{
NSColor *myColor = [NSColor greenColor];
[PreferencesController setDefaultColor:myColor];
NSColor *color = (NSColor *)[PreferencesController defaultColor];
NSLog(@"Default color : %@ - %@",(NSColor *)color, [NSColor greenColor]);
[tableView setBackgroundColor:color];
[colorWell setColor:color];
} 
```

PreferencesController.m 文件：

```
+ (NSColor *)defaultColor{
NSColor * aColor;
NSData *theData=[[NSUserDefaults standardUserDefaults]      valueForKey:TableViewBackgroundColorKey];
if (theData != nil)
    aColor = (NSColor *)[NSUnarchiver unarchiveObjectWithData:theData];
return aColor;
}

+ (void)setDefaultColor:(NSColor *)color{
NSData *theData=[NSArchiver archivedDataWithRootObject:[NSArchiver archivedDataWithRootObject:color]];
[[NSUserDefaults standardUserDefaults] setObject:theData  forKey:TableViewBackgroundColorKey];
} 
```

NSLog 的返回值为：

```
<040b7374 7265616d 74797065 6481e803 84014084 8484074e 53436f6c 6f720084 84084e53
4f626a65 63740085 84016301 84046666 66660001 000186> - NSCalibratedRGBColorSpace 0 1 0 1 
```

所以返回的值`+ (NSColor *)defaultColor`不是 NSColor，当然也不是 `[NSColor greeenColor]`.

我也收到了错误`-[NSConcreteData alphaComponent]: unrecognized selector sent to instance 0x100184050`，我认为这一定是由于没有`NSColor`为提到的方法返回一个引起的。

请帮我调试。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T17:55:45.700

将 NSColor 存储在用户默认值中时，您必须以特殊方式处理它。NSColor 不是可以在属性列表中表示的对象；有关代码示例，请参阅[将 NSColor 存储在用户默认值中。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DrawColor/Tasks/StoringNSColorInDefaults.html)

# c# - 为 Office Open XML 包的 [Content_Types].xml 中的默认条目设置 ContentType

> ID：14162079
> 
> 赞同：0
> 
> 时间：2013-01-04T17:41:11.103
> 
> 标签：c#, ms-office, openxml

我最近继承了一些遗留代码，让您了解我对这个主题的熟悉程度。

我有一个 C# 应用程序，它通过构建包含必要 XML 文件的 zip 包来创建 Excel 电子表格 (.xlsx)。应用程序手动创建 [Content_Types].xml 文件，并使用 Visual J# 压缩包。我试图通过使用 System.IO.Packaging.ZipPackage 摆脱我们对 Visual J# 的依赖。

我可以正确地构建包含所有必要文件的 zip 包。当我添加包部分时，我设置了它们的内容类型字符串，这反映在 [Content_Types].xml 中。但是，[Content_Types].xml 缺少一些必要的条目，Excel 将其解释为损坏的文件。

例如，在正确的内容类型文件中，有一个名为“rels”的默认条目：

```
<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/> 
```

在我的 zip 包中，rels 条目的 ContentType 属性有一个空字符串。由于 rels 不是包中的一部分，我不知道如何设置它的 ContentType。有没有办法手动做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T19:32:14.213

在 Excel 文档的 ZipPackage 中创建部件“xl/_rels/workbook.xml.rels”和“xl/worksheets/_rels/datatable.xml.rels”时，将它们的 ContentType 字符串设置为“application/vnd.openxmlformats-package.relationships” +xml”。

这将根据 ISO/IEC 29500-2 附录 F 设置关系部分的 ContentType。

# sql - 从 SQL Server 生成文本文件以便导入 SAS 的正确方法是什么？

> ID：14162082
> 
> 赞同：2
> 
> 时间：2013-01-04T17:41:23.003
> 
> 标签：sql, sql-server-2008, csv, sas

我在 SQL Server 2008 数据库中有一个表，我想导出到 SAS，这个表有许多数据类型（整数、varchar、float）的列，在正常情况下这个过程会更简单，但我有一个有趣的场景：

我有两台机器：第一台连接到 SQL Server 2008 但它没有安装 SAS 软件，第二台安装了 SAS 软件但它没有连接到 SQL，因此我不能使用 PROC SQL 命令，所以我尝试：

1.  导出到带有逗号分隔的 CSV：如果我有一个像用户 ID 这样的字段，它通常是一个数字（SAS 将该字段识别为数字）并且 SAS 检测到一个带有字母数字值的记录，我会收到一条错误消息。

    我有一个导致（我猜）错误的列示例：

> ```
> user_ID
> 1251231253    ok
> 5645645642    ok
> 1111232135    ok
> CC19491855    fail 
> ```

*   错误消息是这样的：

> 注意：第 468 行 12-21 中的 user_id 数据无效。
> 规则：----+----1----+----2----+----3----+----4.....（等等on)
> 468 70988585,5,CC19491855 , , .... (等等, 等等, 数据, 数据...)
> 
> cod_001=70988585 tip_001=5 user_id=CC19491855 ....（等等，等等，数据，数据...）
> *错误*=1 *N* =467

1.  使用逗号分隔和带引号的列导出到 CSV：一切正常，我没有错误消息，但所有变量在 SAS 中导出为字母数字。

我是 SAS 的新手，所以如果在导出过程之后有一些方法可以格式化变量就可以了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:09:01.060

您目前使用什么将 CSV 导入 SAS？您最好的选择是使用文件->导入数据向导。执行此操作时，它将在日志窗口中生成一些 SAS 代码，如下所示：

```
data WORK.xx    ;
%let _EFIERR_ = 0; /* set the ERROR detection macro variable */
infile 'D:\sasdev\xxx\output\xxx.csv' delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
   informat datetimestamp anydtdtm40\. ;
   informat phoneHome best32\. ;
   informat phoneCell best32\. ;
   informat phoneBusiness best32\. ;
   format datetimestamp datetime. ;
   format phoneHome best12\. ;
   format phoneCell best12\. ;
   format phoneBusiness best12\. ;
input
            datetimestamp
            phoneHome
            phoneCell
            phoneBusiness
;
if _ERROR_ then call symputx('_EFIERR_',1);  /* set ERROR detection macro variable */
run; 
```

如果导入向导没有为您提供所需的结果，您可以复制它生成的代码并根据需要进行修改。在我上面的示例中，所有电话号码都被导入为数字。下面我稍微清理了一下代码，把phoneBusiness变量改成了长度为10的字符变量。

```
data WORK.xx    ;
  infile 'D:\sasdev\xxx\output\xxx.csv' delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;

  informat datetimestamp anydtdtm40\. ;
  informat phoneHome best32\. ;
  informat phoneCell best32\. ;
  informat phoneBusiness $10\. ;

  format datetimestamp datetime. ;
  format phoneHome best12\. ;
  format phoneCell best12\. ;
  format phoneBusiness $10\. ;

  input datetimestamp
        phoneHome
        phoneCell
        phoneBusiness $
        ;
run; 
```

**编辑/更新：**

关于“数据类型”的一些注释。

SAS 中实际上只有两种类型的数据。字符和数字。日期存储为数字数据，但通常格式化为以人类可读的表示形式出现。以下`types`评论中提到的称为格式/信息。

格式控制数据如何“显示”或“输出”。Informats 控制在用作输入时如何解析数据（例如从文件中读取）。您选择的信息应该代表数据的存储方式。您选择的格式实际上取决于您希望它如何显示。

您可以在此处找到文档：

[http://support.sas.com/documentation/cdl/en/leforinforref/63324/HTML/default/viewer.htm#titlepage.htm](http://support.sas.com/documentation/cdl/en/leforinforref/63324/HTML/default/viewer.htm#titlepage.htm)

上述代码的快速总结 -`best12.`是一种数字格式，最多可使用 12 个字符的宽度。将`best32.`使用最多 32 个字符的宽度。这`$10.`是一种字符格式（由 $ 符号标识），宽度为 10 个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:10:03.383

将您的表从 SQL Server 提取到一个分隔文件中；我建议使用制表符或管道（“|”）而不是逗号。不要在值周围加上引号；使用标准 ISO 日期格式格式化任何 DATE 或 TIME 列。如果可能，请在顶部包含一个包含列名的行。

完成后，您可以使用`PROC IMPORT`将文件读入 SAS 数据集。 `PROC IMPORT`只是一个代码生成器，它将检查输入文件并创建适当`INPUT`的处理语句。

如果您遇到特定错误（正如您在尝试选项 1 时所说的那样），请再次询问或使用确切的错误消息更新此问题。像这样的问题很容易解决。

# web-services - Magento 类别导航

> ID：14162083
> 
> 赞同：1
> 
> 时间：2013-01-04T17:41:24.660
> 
> 标签：web-services, magento, web, e-commerce, magento-1.7

我有一个 Magento 网站，其类别结构如下（大写字母是类别，小写字母是产品）：

```
ROOT CATEGORY
     APPARELS
          SHOP BY SIZE
               product1
               product2
               product3
          SHOP BY COLLECTION
               product4
               product5
          SHOP BY DESIGN
               product6
               product7
               product8
               product9 
```

我想将我的导航菜单显示为按尺寸购物、按系列购物和按设计购物。我不希望导航从 APPARELS 级别开始。有没有办法做到这一点？

注意：根据 Magento 设计，ROOT CATEGORY 不能显示在导航菜单中。导航菜单从第 2 级的类别开始，在这种情况下为服装。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:54:45.657

看一下navigation.php，您可以更改核心功能，但可以使用带有重写的模块（永远不要直接更改核心文件！）。当我需要自定义导航功能时，我总是从那里开始。

[http://freegento.com/doc/db/d56/_catalog_2_block_2_navigation_8php-source.html](http://freegento.com/doc/db/d56/_catalog_2_block_2_navigation_8php-source.html)

*编辑，虽然我经常使用这种方法，我建议尽可能避免重写，我认为在这种情况下它不可能很难，因为我们正在谈论将 lvl 2 类别显示为主要导航*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:30:48.350

如果你真的想使用设计 Root -> Apparels -> Shop By * 你可以通过一个单一的覆盖和修改来做到这一点

config.xml - 这显然是一个高度简化的文件，您需要为该文件提供一个帮助程序重写。

```
<?xml version="1.0"?>
<config>
    <helpers>
        <catalog>
            <rewrite>
                <category>Namespace_Module_Helper_Catalog_Category</category>
            </rewrite>
        </catalog>
    </helpers>
</config> 
```

Category.php 这假设您要使用站点根类别下的第一个子类别。在您的情况下，它将是“服装”。此修改考虑到使用平面或非平面类别表。还有其他选择 ID 的选项，一个是系统配置，将类别列表作为源，从而允许您直接选择导航根类别。

该文件的关键是让父 ID 成为您要作为导航基础的“根类别”。同样，对于您的情况，父 ID 将设置为“服装”类别的 ID。

```
class Namespace_Module_Helper_Catalog_Category extends Mage_Catalog_Helper_Category {
    public function getStoreCategories($sorted=false, $asCollection=false, $toLoad=true)
    {
        $parent     = Mage::app()->getStore()->getRootCategoryId();
        $cacheKey   = sprintf('%d-%d-%d-%d', $parent, $sorted, $asCollection, $toLoad);
        if (isset($this->_storeCategories[$cacheKey])) {
            return $this->_storeCategories[$cacheKey];
        }

        /**
         * Check if parent node of the store still exists
         */
        $category = Mage::getModel('catalog/category');
        /* @var $category Mage_Catalog_Model_Category */
        if (!$category->checkId($parent)) {
            if ($asCollection) {
                return new Varien_Data_Collection();
            }
            return array();
        }

        /* Change ian on 1/4/13 at 11:16 AM - Description: Here we capture the id of first child for use as the 'root' */
        $category->load($parent);
        /** @var $collection Mage_Catalog_Model_Resource_Category_Collection */
        $collection = $category->getChildrenCategories();
        if (is_array($collection)) {
            $category = array_shift($collection); //get the first category in the array.  Unknown key.
            $parent = $category->getId();
        } else {
            $parent = $collection->getFirstItem()->getId();
        }

        $recursionLevel  = max(0, (int) Mage::app()->getStore()->getConfig('catalog/navigation/max_depth'));
        $storeCategories = $category->getCategories($parent, $recursionLevel, $sorted, $asCollection, $toLoad);

        $this->_storeCategories[$cacheKey] = $storeCategories;
        return $storeCategories;
    }
} 
```

# php - $id=1 或 $id=2 或 $id=3

> ID：14162085
> 
> 赞同：-3
> 
> 时间：2013-01-04T17:41:43.803
> 
> 标签：php, mysql, css

```
$sql = mysql_query("SELECT number FROM domains WHERE domains_id=1");

$row = mysql_fetch_array($sql);

$domain = $row['number'];

if($domain = 0){
<li class="icon"><a href="">Rule 1</a></li>
<li class="icon"><a href="">Rule 2</a></li>
}

if($domain = 1){
<li class="icon"><a href="" class="yes">Rule 1</a></li>
<li class="icon"><a href="">Rule 2</a></li>                                              
}

if($domain = 2){
<li class="icon"><a href="">Rule 1</a></li>
<li class="icon"><a href="" class="yes">Rule 2</a></li>
} 
```

我有上面的代码，但它似乎不起作用。

当结果是

*   0 - 没有规则是红色的
*   1 - 规则 1 为红色
*   2 - 规则 2 为红色

请你能告诉我如何让它工作吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:46:21.060

您使用的是赋值而不是比较，但您应该尽可能使用严​​格比较 ( `===`)：

```
$sql = mysql_query("SELECT number FROM domains WHERE domains_id=1");

$row = mysql_fetch_array($sql);

$domain = (int)$row['number']; // cast the result

if($domain === 0){?>
<li class="icon"><a href="">Rule 1</a></li>
<li class="icon"><a href="">Rule 2</a></li>
<?php}

if($domain === 1){?>
<li class="icon"><a href="" class="yes">Rule 1</a></li>
<li class="icon"><a href="">Rule 2</a></li>
<?php}

if($domain === 2){?>
<li class="icon"><a href="">Rule 1</a></li>
<li class="icon"><a href="" class="yes">Rule 2</a></li>
<?php} 
```

一般来说，我在您的代码中修改了 3 件事：

*   使用比较 ( `===`) 而不是赋值 ( `=`)，
*   将数据库结果转换为整数 ( `(int)$row['number']`) 以获得干净的数据，
*   将 HTML 放在 PHP 代码之外，

**编辑**：刚刚注意到另一个问题，其他人之前注意到了。您有 3 个独立条件检查相同的数据。`if`您可以使用由一个end 两个`elseif`s组成的单个语句来代替这 3 个条件语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:46:21.013

除了`=`代替`==`，您还违反了 DRY。试试这个：

```
echo '<li class="icon"><a href=""'.($domain==1 ? ' class="yes"' : '').'>Rule 1</a></li>';
echo '<li class="icon"><a href=""'.($domain==2 ? ' class="yes"' : '').'>Rule 2</a></li>'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T17:42:27.040

尝试

```
if($domain == 0){
<li class="icon"><a href="">Rule 1</a></li>
<li class="icon"><a href="">Rule 2</a></li>
}

if($domain == 1){
<li class="icon"><a href="" class="yes">Rule 1</a></li>
<li class="icon"><a href="">Rule 2</a></li>                                              
}

if($domain == 2){
<li class="icon"><a href="">Rule 1</a></li>
<li class="icon"><a href="" class="yes">Rule 2</a></li>
} 
```

`=`当您需要双人时，您正在使用单人`==`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T17:47:22.337

您使用了不正确的比较运算符。`=`做分配，而不是比较。你应该使用`==`.

此外，您不会为了输出 HTTP 而退出 PHP。

尝试这个：

```
<?php 
    $sql = mysql_query("SELECT number FROM domains WHERE domains_id=1");

    $row = mysql_fetch_array($sql);

    $domain = $row['number'];
?>
<li class="icon"><a href="" class="<?php echo ($domain == 1)?"yes":""; ?>">Rule 1</a></li>
<li class="icon"><a href="" class="<?php echo ($domain == 2)?"yes":""; ?>">Rule 2</a></li> 
```

# design-patterns - 存储库模式和数据集

> ID：14162087
> 
> 赞同：0
> 
> 时间：2013-01-04T17:41:53.867
> 
> 标签：design-patterns, repository-pattern

我正在阅读存储库模式[的存储库模式](http://msdn.microsoft.com/en-us/library/ff649690.aspx)

在解决方案部分下，它提到了

> 存储库在数据源层和应用程序的业务层之间进行调解。它在数据源中查询数据，将数据从数据源映射到业务实体，并将业务实体中的更改持久化到数据源。存储库将业务逻辑与与底层数据源或 Web 服务的交互分开。

那么，是否可以将数据集称为存储库模式的示例。在我发现的目标部分下

> 您希望最大限度地利用自动化测试的代码量，并隔离数据层以支持单元测试。

哪个，任何人都可以用例子来解释吗？

万分感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:55:28.610

**答**：不，它们有不同的用途。

*Dataset* [表示数据*的内存缓存*，](http://msdn.microsoft.com/ru-ru/library/system.data.dataset.aspx)不提供修改数据的方法。

相比之下，*Repository*提供了对数据进行操作的方法：[对象可以添加到 Repository 中，也可以从 Repository 中删除，就像它们可以从简单的对象集合中一样，*Repository 封装的映射代码将在后台执行适当的操作*](http://martinfowler.com/eaaCatalog/repository.html)

**ps**：您可能会发现我的回答与*语言无关*，在这种情况下，请提供更多详细信息以及您的问题

# osx-mountain-lion - 构建和安装 OpenSceneGraph-3.1.3 给我一个 No WindowSystemInterface 错误？

> ID：14162089
> 
> 赞同：0
> 
> 时间：2013-01-04T17:42:08.977
> 
> 标签：osx-mountain-lion, openscenegraph

我正在尝试`OpenSceneGraph-3.1.4`在*Mac OS X Mountain Lion*上安装最新的 SVN 更新。

我需要安装特定的*WindowSystemInterface*吗？

```
$ osgviewer cow.osg

View::setUpViewAcrossAllScreens() : Error, no WindowSystemInterface available, cannot create windows.
Viewer::realize() - failed to set up any windows. 
```

我多次构建和重新构建，使用带或不带 Gui 的 CMake，编译 Unix 文件或从 Xcode 中编译，但仍然存在同样的问题。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T13:53:10.840

> 如果您想要更新的 Mac OSG 二进制文件，其中包括用户可运行的安装程序、支持 32 位和 64 位拱门的 OSG 框架等，您可以使用 ARToolworks 发布的那个：
> 
> [http://www.artoolworks.com/dist/openscenegraph/3.1.x/](http://www.artoolworks.com/dist/openscenegraph/3.1.x/)
> 
> 它不包括 COLLADA (.dae) 插件，但大多数其他插件都存在。
> 
> 问候，菲尔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T00:02:37.507

听起来好像`GraphicsWindow*.cpp`文件没有编译、链接和执行，因为这是提供`WindowSystemInterface`. 这是一种不寻常的情况，因为通常这是在库启动时自动构建、链接并执行的，用户永远不会更聪明。

我不知道该给你什么建议，只是为了重新检查你的构建过程，因为出现了很大的问题。

# javascript - 如何在ajax请求完成之前停止监听事件

> ID：14162092
> 
> 赞同：2
> 
> 时间：2013-01-04T17:42:14.510
> 
> 标签：javascript, jquery

我正在创建一个“滚动到底部”新闻提要，当用户滚动到页面底部时它会填充新闻。

我有以下代码（通过[检查用户是否滚动到底部](https://stackoverflow.com/questions/3898130/how-to-check-if-a-user-has-scrolled-to-the-bottom)）：

```
$(window).scroll(function() {
   if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
       //Ajax Request
   }
}); 
```

在完成 ajax 请求以填充新闻之前，如何确保用户不会向上滚动然后再次向下滚动。换句话说，在 ajax 请求完成并填写其结果之前，有什么方法可以暂停它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T17:45:39.907

像这样的东西：

```
var request_pending = false;

function at_bottom_of_page() {
    return $(window).scrollTop() + $(window).height() > $(document).height() - 100;
}

$(window).scroll(function() {
    if (request_pending) {
        return;
    }               
    if (at_bottom_of_page()) {
        request_pending = true;
        doAjax(function (moar_news) {
            render_news(moar_news);
            request_pending = false;
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T17:45:49.767

只需使用一个变量来标记是否存在未完成的 ajax 请求。如果是这样，请不要再提出请求。否则获取数据。我的想法是，让用户滚动，为什么要阻止 UI。在这种情况下，就像进行同步调用一样。

```
var isLoading = false;
//event handler
$(window).scroll(function () {
   // check height..
   // make an ajax request if isLoading is false
   if (!isLoading) {
       $.ajax(/* .. */, success: function () {
           isLoading = false;
       }, 
       error: function () {
           isLoading = false;
       });
       isLoading = true;
   }
} 
```

如果您仍然想在 ajax 响应之前停止侦听事件，只需删除绑定并将其重新附加到 ajax 响应处理程序中。

```
var isLoading = false;
addScrollEvent();

function scrollHandler(e) {
   // check height..
   // make an ajax request if isLoading is false
   if (!isLoading) {
       $.ajax(/* .. */, success: function () {
           isLoading = false;
           addScrollEvent();
       }, 
       error: function () {
           isLoading = false;
           addScrollEvent();
       });
       $(window).off('scroll', scrollHandler);
   }
}

function addScrollEvent() {
    $(window).on('scroll', scrollHandler);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T17:51:45.100

您可以使用`.off()`删除事件处理程序。

```
var attachEvent = function(){

    $(window).scroll(function() {

        $(window).off("scroll");
        $.ajax("example.php").done(function() { 

            //If you want to reattach event
            attachEvent(); 
        });            
    });
};

attachEvent(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T17:49:27.900

在发出 AJAX 请求之前，取消绑定`scroll`处理程序。处理完 AJAX 响应后，重新绑定`scroll`处理程序。您需要为`scroll`处理程序命名以启用解除绑定和重新绑定：

```
$(window).scroll(function scrollHandler() {
    if($(window).scrollTop() + $(window).height() > $(document).height() - 100) {
        $(window).off("scroll", scrollHandler);
        $.ajax({
            ...
            complete: function() {
                $(window).scroll(scrollHandler);
            }
        });
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T17:49:49.033

不是这样的答案，而是不适合评论的注释。

对于 IE6/IE7/IE8，它的`.scroll`性能并不好，每次滚动都会调用你的回调数十次（如果不是数百次）。在我们的项目中，我们使用一个封装函数`.detachedScroll`来防止这种行为：

```
/**
* Detached scroll prevents freezing in IE<=8
*/
if($.browser.msie && parseInt($.browser.version, 10) <= 8) {
    $.fn.scrollDetached = function(callback) {
        return $(this).each(function() {
            var oThis = this;
            clearInterval(this.detachedScrollInterval);
            this.detachedScrollInterval = setInterval(function() {
                if (oThis.hasScrolled) {
                    oThis.hasScrolled = false;
                    // Calling detached scrolling callback
                    callback();
                }
            }, 500);
            $(this).scroll(function() {
                // There was a scrolling event
                oThis.hasScrolled = true;
            });
        });
    };
} else {
    $.fn.scrollDetached = $.fn.scroll;
} 
```

# c# - 尝试在 C# 中访问 UniformGrid.Children 时出现 System.InvalidOperationException

> ID：14162098
> 
> 赞同：0
> 
> 时间：2013-01-04T17:43:04.977
> 
> 标签：c#, wpf, xaml

我正在填充一个`UniformGrid`绑定。源是 a `Square[,]`，而`UniformGrid`是用`Button`对象填充的。

这是我所做的： [双数组和网格之间的数据绑定](https://stackoverflow.com/questions/14148686/data-binding-between-a-double-array-and-a-grid)

我`System.InvalidOperationException`在尝试这样做时得到一个：

```
private void OnClickButton(object sender, RoutedEventArgs e)
{
    Button b = (Button)sender;
    UniformGrid grid = ItemControlGrid.ItemsPanel.LoadContent() as UniformGrid;
    int rows = grille.Rows;
    int columns = grille.Columns;
    UIElementCollection children = grid.Children; // I get the Exception here
    int index = children.IndexOf(b);
    int row = index / columns;
    int column = index % rows;
} 
```

这是我的 XAML：

```
<ItemsControl Background="Gray" Margin="0" Width="800" Height="800"  
    x:Name="ItemControlGrid"
    ItemsSource="{Binding MapGrid}"
    ItemTemplateSelector="{StaticResource selector}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid 
                IsItemsHost="true"
                x:Name="My_UniformGrid" Rows="25" Columns="25"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
 </ItemsControl> 
```

为什么我会得到这个`Exception`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:08:03.777

将出现异常的行更改为：

```
ItemCollection children = ItemControlGrid.Items; 
```

其余的代码应该编译得一样好。我认为`grille`实际上是`grid`.

```
<ItemsControl Background="Gray" Margin="0" Width="800" Height="800"  
    x:Name="ItemControlGrid">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid IsItemsHost="true" Rows="25" Columns="25"/>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <!-- First two elements are just dummies to test the result-->
    <Control />
    <Image />
    <Button Click="Button_Click_1" />
</ItemsControl> 
```

代码隐藏：

```
void Button_Click_1(object sender, RoutedEventArgs e)
{
    var b = (Button) sender;
    var grid = ItemControlGrid.ItemsPanel.LoadContent() as UniformGrid;
    var rows = grid.Rows;
    var columns = grid.Columns;
    var children = ItemControlGrid.Items;
    var index = children.IndexOf(b);
    var row = index/columns;
    var column = index%rows;
    //column will be 2
} 
```

# c# - UserPrincipal.FindByIdentity 抛出异常 - 服务器上没有这样的对象

> ID：14162099
> 
> 赞同：5
> 
> 时间：2013-01-04T17:43:10.160
> 
> 标签：c#, active-directory, directoryservices

我在一个简单的场景中苦苦挣扎：我想使用我用来登录计算机的用户名和密码从 Active Directory 中检索我的帐户。

我的第一个问题是我在尝试调用 UserPrincipal.FindByIdentity 时收到了来自服务器的推荐。我认为这有点奇怪，因为 PrincipalContext.ValidateCredentials 工作正常，但事实证明我的 DC 路径不正确。

我不确定如何正确制作我的 OU/DC 字符串。因此，我发现[这篇 SO 帖子](https://stackoverflow.com/questions/4015407/determine-current-domain-controller-programmatically) 很有帮助，提供了以下代码：

```
private static string GetDomainControllerString()
{
    string pdc;
    using (var context = new PrincipalContext(ContextType.Domain))
    {
        string server = context.ConnectedServer; // "pdc.examle.com"
        string[] splitted = server.Split('.'); // { "pdc", "example", "com" }
        IEnumerable<string> formatted = splitted.Select(s => String.Format("DC={0}", s));// { "DC=pdc", "DC=example", "DC=com" }
        string joined = String.Join(",", formatted); // "DC=pdc,DC=example,DC=com"

        // or just in one string

        pdc = String.Join(",", context.ConnectedServer.Split('.').Select(s => String.Format("DC={0}", s)));
    }

    return pdc;
} 
```

使用此代码正确生成我的 DC 字符串后，我的错误消息发生了变化。现在，我收到错误“服务器上没有这样的对象”。我怀疑问题出在我的 OU 或我如何调用 FindByIdentity。

这是我要检索的用户帐户的位置：

![在此处输入图像描述](../Images/1e06190f33c8717e63ad03a6b3b02dda.png)

这是我尝试访问所述用户的方式：

```
private static void Main(string[] args)
{
    const string Domain = "SLO1.Foo.Bar.biz";
    const string DefaultOU = "OU=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz";
    const string username = @"sanderso";
    const string password = "**********";

    var principalContext = new PrincipalContext(ContextType.Domain, Domain, DefaultOU, ContextOptions.Negotiate, username, password);
    bool areCredentialsValid = principalContext.ValidateCredentials(username, password, ContextOptions.Negotiate);

    if (areCredentialsValid)
    {
        UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(principalContext, username);
    }
} 
```

我也试过打电话：

```
UserPrincipal.FindByIdentity(principalContext, IdentityType.Name, "Sean Anderson");
UserPrincipal.FindByIdentity(principalContext, "Sean Anderson"); 
```

这些同样不成功。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T20:37:39.167

我相信不存在的对象是：

`"OU=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"`

用户是一个容器，而不是一个 OU。因此，您需要正确：

`"CN=Users,DC=SLO1,DC=Foo,DC=Bar,DC=biz"`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-04T19:06:13.643

这段代码应该对你有用 Sean 我目前在 BOA 的 AD 上工作并多次使用它。

```
public bool UserExists(string username)
{
   // create your domain context
   PrincipalContext domain = new PrincipalContext(ContextType.Domain);

   // find the user
   UserPrincipal foundUser = UserPrincipal.FindByIdentity(domain, IdentityType.Name, username);

   return foundUser != null;
} 
```

从 MSDN 每个参数是什么见下面的列表参数

```
context
  Type: System.DirectoryServices.AccountManagement.PrincipalContext

  The PrincipalContex that specifies the server or domain against which operations are performed.

identityType
  Type: System.DirectoryServices.AccountManagement.IdentityType

  A IdentityType enumeration value that specifies the format of the identityValue parameter.

identityValue
  Type: System.String

  The identity of the user principal. This parameter can be any format that is contained in the IdentityType enumeration.

Return Value
  Type: System.DirectoryServices.AccountManagement.UserPrincipal
  A UserPrincipal object that matches the specified identity value and type, or null if no matches are found. 
```

[UserPrincipal.FindByIdentity 方法（）](http://msdn.microsoft.com/en-us/library/bb344891.aspx)

# java - 将类路径文件名转换为真实文件名

> ID：14162100
> 
> 赞同：13
> 
> 时间：2013-01-04T17:43:11.727
> 
> 标签：java, classpath, filepath

如何将类路径上的文件名转换为真实文件名？

例如，假设该目录`"C:\workspace\project\target\classes"`位于您的类路径中。该目录中有一个文件，例如`info.properties`.

仅给定字符串，您将如何确定（在运行时） info.properties 文件的绝对文件路径`"info.properties"`？

结果将类似于`"C:\workspace\project\target\classes\info.properties"`.

为什么这很有用？在编写单元测试时，您可能希望访问捆绑在测试资源 ( `src/main/resources`) 中的文件，但正在使用第三方库或其他需要真实文件名而不是相对类路径引用的系统。

注意：我自己回答了这个问题，因为我觉得这是一个有用的技巧，但看起来以前没有人问过这个问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-04T17:43:11.727

使用 ClassLoader.getResource() 和 URL.getFile() 的组合

```
URL url = Thread.currentThread().getContextClassLoader().getResource( resource );
if( url == null ){
    throw new RuntimeException( "Cannot find resource on classpath: '" + resource + "'" );
}
String file = url.getFile(); 
```

**Windows 注意：**在上面的示例中，实际结果将是

```
"/C:/workspace/project/target/classes/info.properties" 
```

如果您需要更类似于 Windows 的路径（即`"C:\workspace\..."`），请使用：

```
String nativeFilename = new File(file).getPath(); 
```

# android - 在 Android 应用程序中使用 CordovaWebView 时出现 JNI 错误

> ID：14162101
> 
> 赞同：0
> 
> 时间：2013-01-04T17:43:12.193
> 
> 标签：android, cordova, java-native-interface

我的 Android 应用使用 Cordova/PhoneGap 在 JavaScript 端实现业务逻辑。所以有一个单独的活动加载一个 CordovaWebView，然后加载一些片段来提供本机 UI 元素。

这是Activity的`onCreate`方法及其`startFragment`实例化新片段的方法

```
public class MyPhoneGapActivity extends
    SherlockFragmentActivity implements CordovaInterface {

    private static CordovaWebView sGlobalCordovaWebView;
    private final ExecutorService mThreadPool = Executors.newCachedThreadPool();
    private SherlockFragment mLatestFragment;
    private Bundle mSavedInstanceState;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        this.mSavedInstanceState = savedInstanceState;

        setIntegerProperty("loadUrlTimeoutValue", 60000);
        setContentView(R.layout.phonegap_activity);

        sGlobalCordovaWebView = (CordovaWebView) findViewById(R.id.phonegap_activity_cordovawebview);
        sGlobalCordovaWebView.loadUrl("file:///android_asset/www/index.html");

        startFragment("com.acme.view.ExampleScreenView");
    }

    public SherlockFragment startFragment(String name) throws RuntimeException {
        try {

            mLatestFragment = (SherlockFragment) SherlockFragment.instantiate(getActivity(),
                Class.forName(name).getName());

            getSupportFragmentManager()
                .beginTransaction()
                .add(R.id.phonegap_activity_fragment,
                        mLatestFragment, "activityFragment").commit();
            getSupportFragmentManager().executePendingTransactions();

        } catch (ClassNotFoundException e) {
            throw new RuntimeException(
                "startFragment: The class for the desired fragment could not be found.");
        }
        return mLatestFragment;
    }
} 
```

但在我的 HTC EVO 设备上运行应用程序时会导致 JNI 错误：

```
01-04 17:58:11.537: E/dalvikvm(5451): JNI ERROR (app bug): attempt to use stale local     reference 0x1
01-04 17:58:11.537: E/dalvikvm(5451): VM aborting
01-04 17:58:11.537: A/libc(5451): Fatal signal 11 (SIGSEGV) at 0xdeadd00d (code=1)
01-04 17:58:11.967: I/DEBUG(5047): debuggerd: 2013-01-04 17:58:11
01-04 17:58:11.967: I/DEBUG(5047): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
01-04 17:58:11.967: I/DEBUG(5047): Build fingerprint: 'htc_europe/htc_shooteru/shooteru:4.0.3/IML74K/385730.1:user/release-keys'
01-04 17:58:11.967: I/DEBUG(5047): pid: 5451, tid: 5531  >>> eu.mobilion.wasserfinder <<<
01-04 17:58:11.967: I/DEBUG(5047): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr deadd00d
01-04 17:58:11.967: I/DEBUG(5047):  r0 00000000  r1 00c34d48  r2 00000000  r3 00000000
01-04 17:58:11.967: I/DEBUG(5047):  r4 deadd00d  r5 40950ce8  r6 0000020c  r7 52131900
01-04 17:58:11.967: I/DEBUG(5047):  r8 01320c50  r9 27600005  10 0000000c  fp 0127c3d0
01-04 17:58:11.967: I/DEBUG(5047):  ip 00000000  sp 52131650  lr 408e82db  pc 408e82da  cpsr 60000030
01-04 17:58:11.967: I/DEBUG(5047):  d0  0000000000000000  d1  0000000000000000
...
01-04 17:58:11.977: I/DEBUG(5047):  d30 0000000000000000  d31 3ff0000000000000
01-04 17:58:11.977: I/DEBUG(5047):  scr 60000013
01-04 17:58:12.247: I/DEBUG(5047):          #00  pc 000512da  /system/lib/libdvm.so (dvmAbort)
01-04 17:58:12.247: I/DEBUG(5047):          #01  pc 000326b8  /system/lib/libdvm.so (_ZNK16IndirectRefTable3getEPv)
01-04 17:58:12.247: I/DEBUG(5047):          #02  pc 00055ea4  /system/lib/libdvm.so (_Z20dvmDecodeIndirectRefP6ThreadP8_jobject)
01-04 17:58:12.247: I/DEBUG(5047):          #03  pc 0005724c  /system/lib/libdvm.so
01-04 17:58:12.247: I/DEBUG(5047):          #04  pc 0022707e  /system/lib/libwebcore.so
01-04 17:58:12.247: I/DEBUG(5047):          #05  pc 003ee990  /system/lib/libwebcore.so
01-04 17:58:12.247: I/DEBUG(5047):          #06  pc 003a2cd2  /system/lib/libwebcore.so
01-04 17:58:12.247: I/DEBUG(5047):          #07  pc 003a30ca  /system/lib/libwebcore.so
... 
```

注释行时`sGlobalCordovaWebView.loadUrl("file:///android_asset/www/index.html")`，应用程序启动并显示包括所有片段的本机 UI，但由于缺少 JavaScript 逻辑，当然没有任何功能。

我注意到了[android JNI ERROR](https://stackoverflow.com/questions/13248736/android-jni-error)但我没有为我做这个把戏。

* * *

**编辑`phonegap_activity.xml`：：**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <org.apache.cordova.CordovaWebView
        android:id="@+id/phonegap_activity_cordovawebview"
        android:layout_width="1dp"
        android:layout_height="1dp"
        android:visibility="invisible" />

    <FrameLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_below="@+id/phonegap_activity_cordovawebview"
        android:id="@+id/phonegap_activity_fragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >
    </FrameLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T16:24:44.760

解决了这个问题。诀窍是`getActivity().runOnUiThread(..)`在cordova插件中使用并将所有UI创建内容和片段开始放入其中。例如

```
 public class MyPlugin extends CordovaPlugin {

     public boolean execute(String action, final JSONArray jA, final CallbackContext cC) {
         if (action.equals("myAction"))
             return doSth(action, jA, cC);
     }

     private boolean doSth(String action, final JSONArray jA, final CallbackContext cC) {
         getActivity().runOnUiThread(new Runnable() {
             @Override
             public void run() {
                 // start fragment with UI stuff ....
             }
         }
         cC.success(); 
         return true;
     }

 } 
```

# android - 在 Android BroadcastReceiver 的 onReceive 之外使用 clearAbortBroadcast() 方法

> ID：14162106
> 
> 赞同：0
> 
> 时间：2013-01-04T17:43:20.477
> 
> 标签：android, broadcastreceiver

我正在开发一个 Android 应用程序来阻止传入的 SMS 消息并在执行一些过程后释放它们。

我想要做的是，当收到短信时需要阻止该消息并将其推送到在线服务器。之后，管理员可以查看通过网站推送到服务器的那些消息，并且他/她可以批准或拒绝。如果管理员批准该消息，则需要将其发布到电话收件箱，否则丢弃该消息。

我完成了除了一件事之外的所有事情。我所做的是在消息推送到服务器后，将启动一个计划的计时器任务，每 5 分钟读取一次在线服务器，并检查消息是否被批准。我正在使用“BroadcastReceiver”来跟踪传入的消息，并且我知道要释放被阻止的消息，我应该在“onReceive”方法结束之前使用“clearAbortBroadcast()”方法。但是我的计时器充当线程。因此，如果我在计时器内调用“clearAbortBroadcast()”方法，则“onReceive”方法已经完成执行并且消息不会被释放。

有人可以帮助我克服这个问题。

我的广播接收器类

```
public class SmsReceiver extends BroadcastReceiver{

// run on another Thread to avoid crash
private Handler mHandler = new Handler();
// timer handling
private Timer mTimer = null;
public static long NOTIFY_INTERVAL = 15000;
int id;
Context context;

SmsReceiver sr;

GetMsgStatus status;
Bundle bundle;

@Override
public void onReceive(Context context, Intent intent) 
{
    //this stops notifications to others
    this.abortBroadcast();

    this.context = context;

    //create a instance of GetMsgStatus class
    status = new GetMsgStatus(context);

    //---get the SMS message passed in---
    bundle = intent.getExtras();   
    SmsMessage[] msgs = null;
    String from = null;
    String to = null;
    String msg= null;
    String str = "";            
    if (bundle != null)
    {
        //---retrieve the SMS message received---
        Object[] pdus = (Object[]) bundle.get("pdus");
        msgs = new SmsMessage[pdus.length];            
        for (int i=0; i<msgs.length; i++){
            msgs[i] = SmsMessage.createFromPdu((byte[])pdus[i]);                
            str += "SMS from " + msgs[i].getOriginatingAddress();
            from = msgs[i].getOriginatingAddress();
            str += " :";
            str += msgs[i].getMessageBody().toString();
            msg = msgs[i].getMessageBody().toString();
            str += "\n"; 
        }
        System.out.println("from "+from);
        System.out.println("msg "+msg);
        Toast.makeText(context, "SMS Received : ",Toast.LENGTH_LONG).show();

        TelephonyManager mTelephonyMgr;
        mTelephonyMgr = (TelephonyManager)context.getSystemService(Context.TELEPHONY_SERVICE); 
        to = mTelephonyMgr.getLine1Number();

        //push msg to the server
        SendMsgToServer send = new SendMsgToServer(context, to, from, msg);

        //get the msg id of the pushed msg
        id = send.getId();

     // cancel if already existed
        if(mTimer != null) {
            mTimer.cancel();
        } else {
            // recreate new
            mTimer = new Timer();
        }

        // schedule task
        mTimer.scheduleAtFixedRate(new TimeDisplayTimerTask(), 0, NOTIFY_INTERVAL);

        }
}

class TimeDisplayTimerTask extends TimerTask {

    @Override
    public void run() {
        // run on another thread
        mHandler.post(new Runnable() {

            @Override
            public void run() 
            {               
                status.getDataFromServer(id);
                //if status is 0 means msg rejected
                if(status.getStatus()==0)
                {
                    mTimer.cancel();
                }

                //if status is 1 means msg approved
                else if(status.getStatus()==1)
                {
                    sr.clearAbortBroadcast();
                    mTimer.cancel();
                }

                //pending
                else
                {
                    System.out.println("pending");
                }
            }

        });
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:06:38.527

BroadcastReceiver 不应该活得那么久，所以你不能依赖 clearAbortBroadcast()。

在你的情况下，我认为你的流程是：

1.  接收广播并发送到服务器。
2.  中止广播并从手机中删除短信（应警告用户）
3.  等待服务器批准。
4.  如果批准，将消息保存到 SMS 并通知用户。

我不认为这种审查器很好，但你可能有你的理由，只要确保安装它的用户知道它的作用。

# css - Css styling layout issue

> ID：14162109
> 
> 赞同：0
> 
> 时间：2013-01-04T17:43:30.800
> 
> 标签：css, layout, footer

I have some issues regarding the basic layout of my webpage. What I want is the following: a header, then the content of the page with a menu on the left and the content on the right, and a footer. This footer should, in the case neither the content nor the menu exceeds a page in length, be at the bottom of the page with both content divs extending up to the header. In case the content exceeds the pagelength, and thus a scrollbar is shown, the footer should be at the bottom of the content.

What I currently have is the header and two columns for the content, at equal height using [this page](https://matthewjamestaylor.com/equal-height-columns). The footer is currently at the bottom of the page, but when the content exceeds the page length it stays there.

Here's the current code:

css:

```
 html, body{
    margin:0px;
    height:100%;
}
#container{
    height:100%;
    width:1024px;
    margin:auto;
}
#header{
    width:100%;
    height:100px;
    background:purple;
}
#container2{
    float:left;
    width:1024px;
    background:yellow;
    overflow:hidden;
    position:relative;
}
#container1{
    float:left;
    width:1024px;
    background:red;
    position:relative;
    right:874px;
}
#col1{
    float:left;
    width:150px;
    position:relative;
    left:874px;
    overflow:hidden;
}
#col2{
    float:left;
    width:874px;
    position:relative;
    left:874px;
    overflow:hidden;
}
#footer{
    width:1024px;
    background:purple;
    position:absolute;
    bottom:0px;
    height:30px;
} 
```

html:

```
<body>
    <div id='container'>
        <div id='header'>
            This is the header.
        </div>
        <div id='container2'>
            <div id='container1'>
                <div id='col1'>
                    Menu option 1<br />
                    Menu option 2<br />
                    Menu option 3<br />
                    Menu option 4<br />
                    ...
                </div>
                <div id='col2'>
                    Content!<br />
                    Content!<br />
                    Content!<br />
                    Content!<br />
                    Content!
                </div>
            </div>
        </div>
        <div id='footer'>
            This is the footer.
        </div>
    </div>
</body> 
```

And ofcourse, here's the fiddle: [http://jsfiddle.net/gVEpx/](http://jsfiddle.net/gVEpx/)

**EDIT:** to be perfectly clear, the footer should be: 1) if the content is **small**: at the bottom of the page (no scrollbar) 2) if the content is **big**: at the bottom of the content, thus you shall only see the footer when you scroll to the bottom of the page.

**EDIT 2:** Didn't mention quite clearly that the two columns should both follow all the way to the footer. I want to have a border on one of the columns, and that border needs to follow through the whole page, from header to footer.

**EDIT 3:** Here are two awesomely drawn images for clarification: [![Small content](../Images/952a2cdb6213490bf2445a86fc15dfe4.png)](https://i.stack.imgur.com/L665V.png) and [![big content](../Images/5793c4cd2f91ca9deda0c66f135d8e06.png)](https://i.stack.imgur.com/cD4aJ.png) .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:20:39.730

Look at this [fiddle](http://jsfiddle.net/gVEpx/10/).
The middle section is set to `min-height: 100%`, and then we use `padding: 100px 0; margin: -100px 0` to give place to the header and footer. And the we use `box-sizing: border-box` to not altering the overall height of the page. We also use `padding-bottom: 9999px; margin-bottom: -9999px` to stretch the content down to the footer even when there's not enough content.
If you want to vertically center the header and footer you can set the `line-height` equal to the `height`. If the content is going to be more than one line, then you can nest another div and use `display: table-cell; vertical-align: middle;`:

**HTML**

```
<div id="header" class="vcenter">
    <div>
        Header
    </div>
</div>
...
<div id="footer" class="vcenter">
    <div>
        Footer
    </div>
</div> 
```

**CSS**

```
.vcenter {
    display: table;
}
.vcenter > * {
    display: table-cell;
    vertical-align: middle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T17:52:50.117

These are the resources I used to do this for a recent project:

[css anchor div to foot of page](https://stackoverflow.com/questions/3066302/css-anchor-div-to-foot-of-page) [http://fortysevenmedia.com/blog/archives/making_your_footer_stay_put_with_css/](http://fortysevenmedia.com/blog/archives/making_your_footer_stay_put_with_css/)

In summation, you set a container element that contains everything but the footer to `height: 100%.` Then you give the footer a height and put a `margin-bottom: [footer height]` on the thing. I threw a `padding-bottom` on the last element in the container instead of using a separate div. See [http://cureholidayitis.com](http://www.cureholidayitis.com).

Let me know if I misunderstood the question.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T17:57:15.530

I added a conditional class for the footer element using jquery, basically merged an answer from [https://stackoverflow.com/a/2146903/1804496](https://stackoverflow.com/a/2146903/1804496) to work with your jsfiddle.

[http://jsfiddle.net/gVEpx/7/](http://jsfiddle.net/gVEpx/7/)

```
$(function() {
   // Check if body height is higher than window height :)
   if ($("body").height() < $(window).height()) {
      $("#footer").addClass('noOverflowFooter');
   }
});​ 
```

Here is another example, but without any jQuery

[http://jsfiddle.net/gVEpx/8/](http://jsfiddle.net/gVEpx/8/)

```
// Body Height
bodyH = document.body.offsetHeight;
// Window Height
windowH = window.innerHeight;
// Footer element
footer = document.getElementById("footer");
// Check if body height is higher than window height :)
if (bodyH < windowH) {
   // add to the Class attribute of the footer element
   footer.className += " noOverflowFooter";
}​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T18:01:20.377

Not sure if this is what you want? [JSFIDDLE](http://jsfiddle.net/gVEpx/4/)

I just modified the `#container2` div to have a height relative to the `#container` div and assigned `overflow:auto`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T18:13:25.580

I think this is what you are looking for

[http://jsfiddle.net/pr9XJ/1/](http://jsfiddle.net/pr9XJ/)

HTML:

```
<body>
        <div id='container'>
            <div id='header'>
                This is the header.
            </div>
            <div id='container2'>
                <div id='container1'>
                    <div id='col1'>
                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />                        Menu<br />
                        Menu<br />
                    </div>
                    <div id='col2'>
                        Content!<br />
                        Content!
                    </div>
                </div>
            </div>
        </div>
        <div id='footer'>
            This is the footer.
        </div>
    </body> 
```

CSS:

```
html, body
{
    margin: 0px;
    height: 100%;
}
#container
{
    height: auto;
    min-height: 100%;
    width: 1024px;
    margin: auto;
    overflow: auto;
}
#header
{
    width: 100%;
    height: 100px;
    background: purple;
}
#container2
{
    height: 100%;
    width: 1024px;
    background: yellow;
    overflow: auto;
}
#container1
{
    padding-bottom: 32px;
    overflow: auto;
}

#col1
{
    height: 100%;
    float: left;
    width: 150px;
    background: red;
    overflow: auto;
}
#col2
{
    height: 100%;
    float: left;
    width: 874px;
    overflow: auto;
}
#footer
{
    width: 1024px;
    background: purple;
    height: 32px;
    margin-top: -32px;
    clear: both;
    position: relative;
} 
```

# c# - 如何安全地将 mdb 文件从 C# 客户端上传和存储到 PHP 服务器？

> ID：14162110
> 
> 赞同：0
> 
> 时间：2013-01-04T17:43:39.497
> 
> 标签：c#, php, ms-access, security

我目前正在使用 C# 客户端使用以下代码上传大型 microsoft access 数据库文件。

```
System.Net.WebClient Client = new System.Net.WebClient();
Client.Headers.Add("Content-Type", "binary/octet-stream");
byte[] result = Client.UploadFile(@"http://localhost/upload.php", "POST", fileUpload); 
```

我希望最终添加凭据身份验证，以确保它是发送数据的预期客户端。我也希望通过 https 发送它。

但是，我完全不知道如何保护这个文件在 php 服务器上的存储。我担心的是它可以被下载，因为 php 脚本正在将文件从公共上传目录移动到私有目录。上传和存储此文档的最安全方式是什么？

这是 php 服务器端脚本当前的样子：

```
$uploaddir = 'upload/'; // Relative Upload Location of data file

if (is_uploaded_file($_FILES['file']['tmp_name'])) {
$uploadfile = $uploaddir . basename($_FILES['file']['name']);
echo 'File '. $_FILES['file']['name'] .'uploaded successfully.';

if (move_uploaded_file($_FILES['file']['tmp_name'], $uploadfile)) {
echo 'File is valid, and was successfully moved. ';
} 
```

# powershell - 在powershell中合并对象

> ID：14162113
> 
> 赞同：0
> 
> 时间：2013-01-04T17:43:50.073
> 
> 标签：powershell

我正在尝试使用 powershell 创建一个基本的异或文件加密。我的想法是这样的

```
[System.IO.File]::ReadAllBytes("test.txt") | foreach { [System.BitConverter]::ToInt32($_,0) -bxor [System.BitConverter]::ToInt32($password,0) } | Out-File "test.txt" 
```

但我的问题是，字节一个接一个地扔到管道上，这使得使用超过 1 个字符的密码毫无用处。因此，我正在寻找一种组合元素的方法，以便元素以密码长度的大小分组进入 for 循环。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T17:56:09.803

试过了

```
 get-content  -readcount 
```

`-readcount`参数设置为密码长度？

# objective-c - 更新核心数据问题

> ID：14162117
> 
> 赞同：0
> 
> 时间：2013-01-04T17:44:05.273
> 
> 标签：objective-c, ios, core-data

尝试更新一些核心数据。数据实际上是在“某处”更新，但它没有保存/更新数据库。

```
- (IBAction)Update:(id)sender {

    NSEntityDescription *entityDesc =
    [NSEntityDescription entityForName:@"Preferences"
                inManagedObjectContext:context];

    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    [request setEntity:entityDesc];

    NSError *error;
    NSArray *objects = [context executeFetchRequest:request
                                              error:&error];

    if ([objects count] == 0) {
        // No update, didnt find any entries.

    } else {

        for (NSManagedObject *obj in objects) {           

            [obj setValue:_salesPrice.text forKey:@"value"];
            if(![context save:&error]){
                NSLog(@"Saving changes failed: %@", error);
            }

        }

    }
    //[context save:&error];
} 
```

我已经`[context save:&error];`在评论区尝试过，但仍然没有保存。保存时我也没有错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:04:28.697

你只用 1 `NSManagedObjectContext`？您的命名约定并不理想。通常你会命名实体 Preference，因为它是一个对象。试试下面的代码。

```
CoreDataAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
NSManagedObjectContext *context = [appDelegate managedObjectContext];
// This is for completion. Usually you should not get the context from the App Delegate.   
// Its better to pass it from the App Delegate to 
// the initial view controller via a property (dependency injection).

NSFetchRequest *req = [[NSFetchRequest alloc] initWithEntityName:NSStringFromClass([Preferences class])];
    NSError *error = nil;
    NSArray *preferences = [context executeFetchRequest:req error:&error];

// Check error

if ([preferences count] == 0) {
    // No update, didnt find any entries.
} else {
    for (Preferences *preference in preferences) {           
        [preference setValue:_salesPrice.text forKey:@"value"];
    }
}
[context save:&error];
// Check error 
```

# ruby - 正则表达式交换嵌套引号？

> ID：14162118
> 
> 赞同：1
> 
> 时间：2013-01-04T17:44:06.577
> 
> 标签：ruby, regex, quotes

我正在用 Ruby 做一些文本处理。

对于我正在使用的某些文本：单引号不应该在双引号之外。所以，我想制作一个匹配单引号字符串的正则表达式，但不是那些已经用双引号括起来的字符串，所以我可以用脚本交换它们。有道理？

因此，在以下示例中，句子 #1、2、4、6 和 8 是可以的，而句子 #3、5 和 7 包含错误嵌套的单引号，我想交换它们：

1.  这是一个句子。
2.  这是一个“带双引号”的句子。
3.  **这是一个带有单引号**的句子。
***   这是一个带有'嵌套单引号'的句子。有时会有‘不止一个’。”*   **这是一个带有“嵌套双引号”**的句子。**有时有“不止一个”。***   这是一个句子“没有双'右引号'，这在本文中很常见。*   不幸的是，这句话**“没有一个“结束引号”也很常见。***   但是，我不想匹配撇号。那是行不通的。**

 **（粗体表示我想用 RegEx 进行匹配，所以我可以交换引号。）

重点：我试图引用已在其中引用的扩展段落。这需要我用单打交换他们的双打。

这可能吗？我已经尝试了几个小时，但我似乎无法得到它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:01:48.140

我不认为正则表达式是解决这个问题的方法。为什么不自己浏览文本呢？

（伪代码）

```
for each char in text

    if char is `"`, then ignore until next `"`
    else if char is `'` (and not part of a contraction), then capture until next `'` or `.`

end for 
```

我预见到未来的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:10:46.150

这可能不是一个完美的答案，但您可以尝试`gsub`在 #5 中使用类似这样的东西：

```
a=> This is a sentence 'with a "nested double quote." Sometimes there are "more than one."'
a.gsub(/^[A-Z][a-zA-Z\s]*'[a-zA-Z\s]*(".*")[a-zA-Z\s]*'/) { |m| m.gsub('"',"'")} 
```

对于 # 3 使用：

```
a.gsub(/^[A-Z][a-zA-Z\s]*('.*')/) { |m| m.gsub('"',"'")} 
```

等。

这些只是示例，但希望它们有所帮助。我认为您必须对此非常小心，因为根据您使用的数据和正则表达式，您可能会得到意想不到的结果，并且它可能会以使事情变得更糟的方式更改您的数据。确保编写一些 rspec 测试并使用非常大的样本进行测试，以使用最好的正则表达式来处理它。

您可能遇到的另一个问题是识别句子是否在段落中。它变得更加复杂，您可能需要使用 NLP 之类的东西来识别它们。

此外，您可以考虑在代码中使用`chr()`和`ord()`。

祝你好运！**

# asp.net-mvc - MVC 路由 -> 在 URL 中包含 Html.DropDownList 的选定项

> ID：14162119
> 
> 赞同：0
> 
> 时间：2013-01-04T17:44:06.097
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, html-select

Action Method 的签名如下所示：

```
 public ActionResult DwellingAdvertsByCity(
        string cityName,
        int numberOfResultsPerPage,
        int pageIndex) 
```

我的 Razor 表单如下所示：

```
 @using (Html.BeginForm(
    "DwellingAdvertsByCity", 
    "DwellingAdvert",
     new { controller = "DwellingAdvert", action = "DwellingAdvertsByCity" }, 
     FormMethod.Get
    ))
    {    
         @Html.DropDownList("CityName")

         <p>
             <input type="hidden" name="numberOfResultsPerPage" id="numberOfResultsPerPage" value="3" />
             <input type="hidden" name="pageIndex" id="pageIndex" value="1" />             
             <input type="submit" value="Submit" />
         </p>
    } 
```

提交我的“NewYork”选择后，我会在以下 URL 下看到结果列表：

```
http://localhost:XXX/DwellingAdvert/DwellingAdvertsByCity?CityName=NewYork&numberOfResultsPerPage=3&pageIndex=1 
```

任何想法**如何**从基本**配置更改路由配置：**

```
routes.MapRoute(null, "{controller}/{action}"); 
```

**要匹配，我会在以下 URL 下看到结果列表：**

`http://localhost:XXX/NewYork` **?**

我花了几个小时试图弄清楚，没有结果，所以我问你们。

关于问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T16:36:09.500

如果有人对此感兴趣，这是我发现并为我工作的解决方案：

我在路由配置中添加了以下路由路径，包括*CityName*：

```
routes.MapRoute(null,
        "{cityName}", // Matches /NewYork
        new { controller = "DwellingAdvert", action = "DwellingAdvertsByCity", pageIndex = 1, numberOfResultsPerPage = 3 }
        ); 
```

并使用了两种版本的*DwellingAdvertsByCity*操作方法，一种用于 POST 请求，另一种用于 GET 请求：

```
 [HttpPost]
    [ActionName("DwellingAdvertsByCity")]
    public ActionResult DwellingAdvertsByCityPost(
        string cityName,
        int numberOfResultsPerPage,
        int pageIndex)
    {
        return Redirect(@"~\" + cityName);
    }

    [HttpGet]
    public ActionResult DwellingAdvertsByCity(
        string cityName,
        int numberOfResultsPerPage,
        int pageIndex)
    {
      ... actual code ...
    } 
```

所以我可以在以下网址下看到预期的结果：

```
http://localhost:XXX/NewYork 
```

希望可以节省您的时间，以防您遇到类似问题。

# visual-studio-2010 - 安装 Azure SDK，不再发布到文件系统选项

> ID：14162122
> 
> 赞同：1
> 
> 时间：2013-01-04T17:44:16.413
> 
> 标签：visual-studio-2010, azure

现在我已经安装了 Azure SDK 并将我的一些站点发布到 Azure，我不再有允许发布到本地文件系统的构建选项。我怎样才能找回所说的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:13:12.657

我只安装了 VS2012，但是...当您右键单击您的云项目时，您应该会同时看到 Publish... 选项和 Package... 选项。选择后者将使用本地或云设置将包 + 配置文件写入磁盘。

![选择套餐...](../Images/2270ba6aa3165da49a78cd12fa7eeb0a.png)

![选择配置](../Images/e57fc4a93c41e8ae6a1127707751264b.png)

![生成并存储在磁盘上的文件](../Images/9bb3177770e84925a3a9241f1476a4af.png)

# php - 尝试更新内容时文件被刷新

> ID：14162130
> 
> 赞同：2
> 
> 时间：2013-01-04T17:44:53.327
> 
> 标签：php, logging, file-io

我编写了一个非常简单的页面计数器和一个记录脚本，该脚本递增存储在文件中的计数器并记录有关客户端操作系统和他们使用的浏览器的信息。这是我一直在从事的一个简单的业余时间项目，因此它非常初级，将计数器和记录的信息写入站点上每个页面的指定文件夹中，每天在一个新文件中。

问题是，我最近使用 blitz.io 来测试我的网站，当我运行每秒 250 个请求的“Rush”时，计数器和日志被完全刷新，除了最后一个查询。

我不完全确定发生了什么，但我怀疑 PHP 在处理下一个查询之前没有正确完成上一个查询。

我对它们都使用 file_get_contents()/file_put_contents()，而不是 file()。更改为 file() 会解决问题吗？

这是计数器：

```
 $filename = '.' . $_SERVER['PHP_SELF'];
$counterpath = '/Websites/inc/logs/counters/total/' . getCurrentFileName() . '-counter.txt';
$globalcounter = '/Websites/inc/logs/counters/total/global-counter.txt';

if (file_exists($counterpath)) {
    $hit_count = file_get_contents($counterpath);
    $hit_count++;
    file_put_contents($counterpath,$hit_count);
}
else {
    $hit_count = "1";
    file_put_contents($counterpath, $hit_count);
} 
```

这是记录器：

```
$logdatefolder = '/Websites/inc/logs/ip/' . date('Y-m-d',$_SERVER['REQUEST_TIME_FLOAT']);
    $logfile = $logdatefolder . "/" . getCurrentFileName() . '-iplog.html';
    $ua = getbrowser();
    if (false == (file_exists($logdatefolder))) {
        mkdir($logdatefolder);
    }
    function checkRef() {
        if (!isset($_SERVER['HTTP_REFERER'])) {
            //If not isset -> set with dummy value
            $_SERVER['HTTP_REFERER'] = 'N/A';
        } 
        return $_SERVER['HTTP_REFERER'];
    }

    /* Main logger */
    $logheader = "<!DOCTYPE html><html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en-US\"><head><title>" . getCurrentFileName() . " log</title><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /></head><body>";
    $logentry = date("Y-m-d, H:i:s, O T") . ":" . 
    "<br />- Requesting: http://giphtbase.org" . $_SERVER['REQUEST_URI'] . 
    "<br />- Arriving from: " . checkRef() . 
    "<br />- Browser: " . $ua['browser'] . 
    "<br />- Full browser name: " . $ua['name'] . 
    "<br />- Operating system: " . $ua['platform'] . 
    "<br />- Full user agent: " . $ua['userAgent'] . 
    "<br />";
    $logfooter = "<!-- Bottom --></body></html>";

    if (file_exists($logfile)) {
        $logPage = file_get_contents($logfile);
        $logContents = str_replace("<!-- Bottom --></body></html>","",$logPage);
        file_put_contents($logfile, $logContents . $logentry . $logfooter);
    }
    elseif (false == (file_exists($logfile))) {
        file_put_contents($logfile, $logheader . $logentry . $logfooter);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:50:15.383

你应该`FILE_APPEND`在你的中使用标志，`file_put_contents()`否则你只会看到最后一个条目：

```
file_put_contents($logfile, $logContents . $logentry . $logfooter, FILE_APPEND); 
```

至于计数器，看起来文件试图被不同的线程写入太多次，导致它无法访问。您应该使用数据库，或创建 file_lock，或创建临时文件并运行 cronjob 来计算。

# reporting-services - SSRS 2005 处理 Null 返回值 - 0 而不是 #Error

> ID：14162131
> 
> 赞同：0
> 
> 时间：2013-01-04T17:44:57.177
> 
> 标签：reporting-services

作为 SSRS 2005 的新手，我不清楚如何做到这一点，并且未能将此处提供的其他答案的建议融入我的具体情况。

场景：我正在按部门、性别等计算员工的平均年龄。在某些情况下，没有什么可计算的，在这种情况下，我更愿意返回零。在当前形式中，我的表达式返回#Error。

表达方式：

```
=Int(Avg(IIF(Fields!CustGender.Value = "F", CDec(Fields!Age.Value),Nothing),"ReportDataset")) 
```

使该表达式返回 0 的正确语法/逻辑是什么，该部门中没有女性员工？如果我将“Nothing”更改为零，那不会抛出 Avg 函数的计算吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:55:18.047

我还没有尝试过，但我认为如果您手动计算平均值，它应该可以工作。总和/计数：

```
=Int( SUM(
    IIF(
      Fields!CustGender.Value = "F",
      CDec(Fields!Age.Value),
      0
    ),"ReportDataset")
    / IIF(COUNT(
    IIF(
      Fields!CustGender.Value = "F",
      1,
      0
    ),"ReportDataset") = 0, 1,
    COUNT(
    IIF(
      Fields!CustGender.Value = "F",
      1,
      0
    ),"ReportDataset"))
    ) 
```

当然，如果“F”记录为零，这将引发错误。

# c - 使用共享内存平铺技术在 CUDA 中乘法矩阵

> ID：14162137
> 
> 赞同：0
> 
> 时间：2013-01-04T17:45:24.170
> 
> 标签：c, matrix, cuda

**在下面的作业代码中，我需要找出平铺矩阵乘法工作还需要哪些边界条件。**请帮助我，我已经尝试了一个星期来找出问题所在？

```
#include    <wb.h>

#define TILE_WIDTH 16

__global__ void matrixMultiplyShared(float * A, float * B, float * C,

                     int numARows, int numAColumns,
                     int numBRows, int numBColumns,
                     int numCRows, int numCColumns) {

//@@ Insert code to implement matrix multiplication here
//@@ You have to use shared memory for this MP
  __shared__ float s_A[TILE_WIDTH][TILE_WIDTH];
  __shared__ float s_B[TILE_WIDTH][TILE_WIDTH];

  int tx= threadIdx.x; int ty = threadIdx.y;
  int bx= blockIdx.x ; int by = blockIdx.y ;

  int Row = by*TILE_WIDTH + ty;
  int Col = bx*TILE_WIDTH + tx;

   if((Row < numARows  ) && (Col < numBColumns )) {

 float Pvalue =0.0;
  for (int m = 0; m < (numAColumns-1)/TILE_WIDTH+1; ++m) {

    if((Row < numARows) && ( (m*TILE_WIDTH+tx) < numAColumns)) {

      s_A[ty][tx] = A[Row*numAColumns +( m*TILE_WIDTH+tx)];
    }
    else
    {
      s_A[ty][tx] = 0.0;
    }
    if(((m*TILE_WIDTH+ty) < numBRows) && (Col < numBColumns)) {

      s_B[ty][tx] = B[(m*TILE_WIDTH+ty)*numBColumns+Col];
    }
    else
    {
      s_B[ty][tx] = 0.0;
    }
    __syncthreads();

   if((Row < numARows  ) && (Col < numBColumns )) {
    for (int k = 0; k < TILE_WIDTH; ++k)
      {

         Pvalue += s_A[ty][k] * s_B[k][tx];

      }
    __syncthreads();

  }
  }
    if((Row < numARows  ) && (Col < numBColumns )) { 
       C[Row*numCColumns+Col] = Pvalue;
    }
}
else
return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-13T10:24:47.580

问题在于进入循环加载 TILE 的条件，即 if((Row < numARows ) && (Col < numBColumns ))，并且下次在进行实际计算时再次检查相同的条件每个加载的 TILE 的结果元素，只有最后一个条件，即写入全局时就足够​​了。[您可以在此处](http://www.techdarting.com/2014/03/matrix-multiplication-in-cuda-using.html)找到详细的实现以供参考

# mysql - Mysql：从其他表中获取价值（左连接？）

> ID：14162138
> 
> 赞同：0
> 
> 时间：2013-01-04T17:45:23.963
> 
> 标签：mysql, join

我确实有一个mysql问题。这有点难以解释，但我会试一试。

所以，我确实有一张名为“FOODS”的表。其中的每个项目都有其唯一的 ID。

然后，还有另一个名为“EATERS”的表。每个食客也有自己的身份证。EATERs 表中有一个名为“atefood”的字段，其中存储了表 FOOD 的相应条目的 ID。

EATERs 表中可以有多个具有相同“atefood”ID 的条目。假设我是一个食客，并且我用我当前的 SESSION ID 存储在 EATER 表中。

现在，我想显示我吃的所有食物，但每种食物只显示一次。

希望这是合理的：D

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:55:32.907

select * from FOODS inner join eaters on eaters.atefood = foods.id where eaters.session = [session id]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:48:30.783

```
SELECT 
    * 
FROM eaters as e 
LEFT JOIN foods as f on e.food_id = f.id
GROUP BY f.id 
```

# python - PyRun_InteractiveLoop 全局/局部

> ID：14162140
> 
> 赞同：1
> 
> 时间：2013-01-04T17:45:26.820
> 
> 标签：python

我正在尝试在 PyRun_InteractiveLoop 调用中设置本地/全局变量。无法弄清楚如何做到这一点，因为与 exec 对应物不同，循环不接受全局/本地参数。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:03:16.237

如果您想要的是 exec 的 C API 版本，也许可以尝试一下`PyRun_File`？不确定您到底要完成什么。

# matlab - MATLAB将变量名传递给保存函数

> ID：14162143
> 
> 赞同：1
> 
> 时间：2013-01-04T17:45:36.160
> 
> 标签：matlab, matlab-figure

我正在尝试使用变量名作为 PDF 输出的文件名。该`save`函数有效，但仅当文件名包含在`''`. 所以...`saveas(h, 'fname', 'pdf')`有效，但我希望变量的值`fname`作为文件名，而不仅仅是 text `'fname'`。我在没有 的情况下尝试过`''`，但这根本没有保存任何东西。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:56:47.127

这在我的机器（R2012b winx64）上工作正常并生成两个预期的pdf

```
xx = 0:.01:1
h = plot(xx,sin(xx))

f_name = 'fname'  % // string version
saveas(h, f_name , 'pdf')  % // PDF1 - name: "fname.pdf"

f_name = 10;  % // now variable is a double
saveas(h, num2str(f_name) , 'pdf')  % // convert number in string first
                                    % // PDF2 - name "10.pdf" 
```

# java - 使用 Java POST 请求在 Django Tastypie 上创建资源但收到 500 错误代码

> ID：14162147
> 
> 赞同：0
> 
> 时间：2013-01-04T17:45:47.663
> 
> 标签：java, django, json, rest, tastypie

我正在尝试使用 Java 客户端将新资源发布到 django sweetpie API，但我收到了 Http 500 错误代码。基本上我只是想从客户端对我的 api 进行新的预订。

楷模：

```
class Author(models.Model):
    name = models.CharField(max_length=50)
    email = models.EmailField()

    def __unicode__(self):
        return self.name

class Product(models.Model):
    author = models.ForeignKey(Author)

    name = models.CharField(max_length=100)
    genre = models.CharField(max_length=100)
    pub_date = models.DateTimeField()

class Reservation(models.Model):
    user = models.ForeignKey(User)
    product = models.ForeignKey(Product)

    reserv_date_start = models.DateTimeField()
    reserv_finish = models.DateTimeField()
    penalty = models.BooleanField()

    def __unicode__(self):
        return self.product.name 
```

资源：

```
class AuthorResource(ModelResource):
    #user = fields.ForeignKey(UserResource, 'user')
    class Meta:
        queryset = Author.objects.all()
        resource_name = 'author'
        authentication = BasicAuthentication()
        authorization = DjangoAuthorization()

class ProductResource(ModelResource):
    author = fields.ForeignKey(AuthorResource, 'author')
    class Meta:
        queryset = Product.objects.all()
        resource_name = 'product'
        authentication = BasicAuthentication()
        authorization = DjangoAuthorization()

class ReservationResource(ModelResource):
    product = fields.ForeignKey(ProductResource, 'product')
    class Meta:
        queryset = Reservation.objects.all()
        resource_name = 'reservation'
        authentication = BasicAuthentication()
        authorization = DjangoAuthorization() 
```

我要发布的 json （我正在使用 java simple json 并且我得到了反斜杠，但我不知道如何取出它）：

```
public JSONObject encodeJsonObject(Reservation reservation){
    JSONObject obj=new JSONObject();
    obj.put("id",String.valueOf(reservation.getId()));
    obj.put("product","/api/reservation/product/"+reservation.getProduct().getId()+"/");      
    obj.put("reserv_date_start",new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'+00:00'").format(reservation.getReserv_date_start()));
    obj.put("reserv_finish",new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'+00:00'").format(reservation.getReserv_finish()));        
    obj.put("resource_uri", "/api/reservation/reservation/"+reservation.getId()+"/");
    obj.put("penalty",reservation.isPenalty());
    return obj;
} 
```

* * *

```
json: {
"product": "\/api\/reservation\/product\/12\/",
"id": "7",
"reserv_finish": "2013-01-05T23:11:51+00:00",
"resource_uri": "\/api\/reservation\/reservation\/7\/",
"penalty": false,
"reserv_date_start": "2013-01-05T23:11:51+00:00" 
```

}

* * *

我的客户发布代码：

```
public void apacheHttpClientPost(String url, String user, char[] pass, JSONObject data) {
     try {

    DefaultHttpClient httpClient = new DefaultHttpClient();
            httpClient.getCredentialsProvider().setCredentials(new AuthScope(AuthScope.ANY_HOST, AuthScope.ANY_PORT, AuthScope.ANY_REALM),
            new UsernamePasswordCredentials(user, new String(pass)));
    HttpPost postRequest = new HttpPost(url);
    StringEntity input = new StringEntity(data.toJSONString());
    input.setContentType("application/json");
    postRequest.setEntity(input);

    HttpResponse response = httpClient.execute(postRequest);

    if (response.getStatusLine().getStatusCode() != 201) {
        throw new RuntimeException("Failed : HTTP error code : "
            + response.getStatusLine().getStatusCode());
    }

    BufferedReader br = new BufferedReader(
                    new InputStreamReader((response.getEntity().getContent())));

    String output;
    System.out.println("Output from Server .... \n");
    while ((output = br.readLine()) != null) {
        System.out.println(output);
    }

    httpClient.getConnectionManager().shutdown();

  } catch (MalformedURLException e) {

    e.printStackTrace();

  } catch (IOException e) {

    e.printStackTrace();

  }

} 
```

调试错误之一：

> /usr/local/lib/python2.7/dist-packages/django/db/models/fields/init .py:808： **RuntimeWarning**：DateTimeField收到一个天真的日期时间（2013-01-04 17:31:57）而时间区域支持处于活动状态。运行时警告）

我发布到

> “http://localhost:8000/api/reservation/reservation/”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T20:43:30.233

JSON 中的日期时间缺少时区部分：

```
json: {
    "product": "\/api\/reservation\/product\/9\/",
    "id": "6",
    "reserv_finish": "2013-01-04T17:31:57",                 // <-- Here
    "resource_uri": "\/api\/reservation\/reservation\/6\/",
    "penalty": false,
    "reserv_date_start": "2013-01-04T17:31:57"              // <-- And here
} 
```

ISO-8601 日期时间应如下所示：

```
"2013-01-04T17:31:57+00:00"
                    ^^^^^^^ 
```

另外，`python-dateutil`你安装的是哪个版本？你能检查一下吗？

```
pip freeze | grep dateutil 
```

## 其他值得一看的东西：

*   [Tastypie](http://django-tastypie.readthedocs.org/en/latest/settings.html#tastypie-datetime-formatting)文档中的 TASTYPIE_DATETIME_FORMATTING。
*   [Django 文档中的时区](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T15:30:48.967

知道了。问题出在我的 json 不完整。我有一个未添加的用户资源外键。这是解决方案：

json:

```
{
    "product": "\/api\/reservation\/product\/12\/",
    "id": "7",
    "reserv_finish": "2013-01-06T15:26:15+00:00",
    "resource_uri": "\/api\/reservation\/reservation\/7\/",
    "penalty": false,
    "reserv_date_start": "2013-01-06T15:26:15+00:00",
    "user": "\/api\/reservation\/auth\/user\/1\/"
} 
```

资源：

```
class ReservationResource(ModelResource):
    user = fields.ForeignKey(UserResource, 'user')
    product = fields.ForeignKey(ProductResource, 'product')
    class Meta:
        queryset = Reservation.objects.all()
        resource_name = 'reservation'
        authentication = BasicAuthentication()
        authorization = DjangoAuthorization() 
```

java客户端代码：

```
public JSONObject encodeJsonObject(Reservation reservation){
    JSONObject obj=new JSONObject();
    obj.put("id",String.valueOf(reservation.getId()));  
    obj.put("product","/api/reservation/product/"+reservation.getProduct().getId()+"/");      
    obj.put("reserv_date_start",new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'+00:00'").format(reservation.getReserv_date_start()));
    obj.put("reserv_finish",new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss'+00:00'").format(reservation.getReserv_finish()));        
    obj.put("resource_uri", "/api/reservation/reservation/"+reservation.getId()+"/");
    obj.put("user", "/api/reservation/auth/user/1/"); //not dynamic yet
    obj.put("penalty",reservation.isPenalty());
    return obj;
} 
```

# javascript - 为什么我不能从 $(document).ready 调用外部函数

> ID：14162153
> 
> 赞同：0
> 
> 时间：2013-01-04T17:46:06.693
> 
> 标签：javascript, jquery, document

使用下面的代码，单击按钮不会调用 handleData() 函数，如果我使用匿名函数方式（在 /* */ 内），它可以工作。

有人可以解释问题是什么吗？以及如何解决？我想从 $(document).ready(...) 调用全局函数。

```
<html>
<head>
<script src="js/jquery/jquery-1.7.2.min.js"></script>

<script>
    function handleData(data, status) {
        $("#p1").text(data);
    };

    $(document).ready(function() {

        $("button").click(function() {
            $.get("testAsync?name=value", handleData(data, status));
        });

        /*
        $("button").click(function() {
            $.get("testAsync?name=value", function(data, status) {
                $("#p1").text(data);
            });
        });
         */
    });
</script>
</head>
<body>
    <button>Send an HTTP GET</button>
    <p id="p1"></p>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T17:48:12.747

该函数被立即调用，因为你有`(arguments)`它。

由于参数是有序的，只需`handleData`单独传递。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-04T17:48:18.610

将函数调用从

```
$.get("testAsync?name=value", handleData(data, status)); 
```

至

```
$.get("testAsync?name=value", handleData); 
```

在第一种情况下，您将立即执行该函数..只需传入函数指针，它就会按预期工作..

# java - 如何在 VB.NET 中写入（字节）0xFF

> ID：14162154
> 
> 赞同：-5
> 
> 时间：2013-01-04T17:46:11.433
> 
> 标签：java, vb.net, porting

我有一个小项目需要创建一个静态字节数组。

我得到了 Java 代码来在 Java 中创建一个固定的字节数组，如下面的代码。

```
private static final byte[][] P = new byte[][] {

    // p0
    {
        (byte) 0xA9, (byte) 0x67, (byte) 0xB3, (byte) 0xE8,
        (byte) 0x04, (byte) 0xFD, (byte) 0xA3, (byte) 0x76
    },

    // p1
    {
        (byte) 0x75, (byte) 0xF3, (byte) 0xC6, (byte) 0xF4,
        (byte) 0xDB, (byte) 0x7B, (byte) 0xFB, (byte) 0xC8}
    } 
```

如何在 VB.NET 中编写它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T21:45:53.710

Java 中的`byte`类型是有符号类型，而`Byte`VB.NET 中的类型是无符号类型。对于 VB，您需要使用`SByte`类型。此外，您的问题显示了一个数组数组，而不是二维数组，因此 VB.NET 中最接近的等价物是：

```
Private Shared ReadOnly P()() As SByte = _ 
    { _
    New SByte() { CSByte(&HA9), CSByte(&H67), CSByte(&HB3), CSByte(&HE8), CSByte(&H4), CSByte(&HFD), CSByte(&HA3), CSByte(&H76) }, _
    New SByte() { CSByte(&H75), CSByte(&HF3), CSByte(&HC6), CSByte(&HF4), CSByte(&HDB), CSByte(&H7B), CSByte(&HFB), CSByte(&HC8) } _
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T17:51:12.747

利用

```
Dim P(,) As Byte = New Byte(,) { _
    { &HA9, &H67, ... }, _
    { &H75, &HF3, ... }, _
    ... _
} 
```

# java - 在 Java 1.6 中为 JAX-WS 提供不同版本的 JAXB

> ID：14162159
> 
> 赞同：32
> 
> 时间：2013-01-04T17:46:24.383
> 
> 标签：java, web-services, jaxb, jax-ws

我有一个附带 jaxb-impl.jar 的第三方 jar，并将其包含在其清单类路径中。问题是，似乎提供您自己的 JAXB 版本（无论它可能是哪个版本）似乎会破坏 JAX-WS 中的 SoapFaultBuilder。

根据[Unofficial JAXB Guide](http://jaxb.java.net/guide/Migrating_JAXB_2_0_applications_to_JavaSE_6.html)，似乎 Sun 在将 JAXB 折叠到 JDK 时故意更改了包名，以避免与单机版本冲突。但是，JDK 附带的 SoapFaultBuilder（我相信是 JAX-WS 的一部分）显式依赖于新的内部包名称。如果您添加了独立的 JAXB jar（即使它与 JAXB 的版本**号**相同），这会导致它在构建错误消息时失败。

这是我的小测试用例：我做了一个微不足道的 Web 服务：

```
package wstest;

import javax.jws.WebMethod;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;
import javax.jws.soap.SOAPBinding.Style;

//Service Endpoint Interface
@WebService
@SOAPBinding(style = Style.RPC)
public interface HelloWorld{

    @WebMethod String getHelloWorldAsString(String name);

} 
```

以及一个简单地抛出异常的实现。（因为问题只发生在 SOAPFaultBuilder 中）：

```
package wstest;

import javax.jws.WebService;

//Service Implementation
@WebService(endpointInterface = "wstest.HelloWorld")
public class HelloWorldImpl implements HelloWorld{

    @Override
    public String getHelloWorldAsString(String name) {
        //return "Hello World JAX-WS " + name;
        throw new RuntimeException("Exception for: " + name);
    }

} 
```

还有一个发布 Web 服务的类：

```
package wstest;

import javax.xml.ws.Endpoint;

//Endpoint publisher
public class HelloWorldPublisher{

    public static void main(String[] args) {
       Endpoint.publish("http://localhost:9999/ws/hello", new HelloWorldImpl());
    }

} 
```

我运行 HelloWorldPublisher，然后针对它运行这个客户端：

```
package wstest;

import java.net.URL;
import javax.xml.namespace.QName;
import javax.xml.ws.Service;

public class HelloWorldClient{

    public static void main(String[] args) throws Exception {

    URL url = new URL("http://localhost:9999/ws/hello?wsdl");

        //1st argument service URI, refer to wsdl document above
    //2nd argument is service name, refer to wsdl document above
        QName qname = new QName("http://wstest/", "HelloWorldImplService");

        Service service = Service.create(url, qname);

        HelloWorld hello = service.getPort(HelloWorld.class);

        System.out.println(hello.getHelloWorldAsString("Matt"));

    }

} 
```

这正确地吐出由 Web 服务引发的异常。但是，当我添加任何版本的 jaxb-impl.jar 时，无论是在类路径中还是在认可的库中，我都会得到以下堆栈跟踪：

```
Exception in thread "main" java.lang.ExceptionInInitializerError
    at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:107)
    at com.sun.xml.internal.ws.client.sei.SyncMethodHandler.invoke(SyncMethodHandler.java:78)
    at com.sun.xml.internal.ws.client.sei.SEIStub.invoke(SEIStub.java:107)
    at $Proxy19.getHelloWorldAsString(Unknown Source)
    at wstest.HelloWorldClient.main(HelloWorldClient.java:21)
Caused by: java.lang.ClassCastException: com.sun.xml.bind.v2.runtime.JAXBContextImpl cannot be cast to com.sun.xml.internal.bind.api.JAXBRIContext
    at com.sun.xml.internal.ws.fault.SOAPFaultBuilder.<clinit>(SOAPFaultBuilder.java:533)
    ... 5 more 
```

发生异常是因为我的 jaxb-impl 中的 com.sun.xml.bind.v2.runtime.JAXBContextImpl 扩展了 com.sun.xml.bind.api.JAXBRIContext 而不是 com.sun.xml.internal.bind.api.JAXBRIContext (请注意包层次结构中缺少的“内部”子包）。

同样根据[Unofficial JAXB Guide](http://jaxb.java.net/guide/Migrating_JAXB_2_0_applications_to_JavaSE_6.html)，他们说您需要使用认可的 lib 才能正确覆盖 JAXB 的版本。但事实证明，SOAPFaultBuilder 使用 JAXBContext.newInstance() 在类路径中搜索名为 的文件`/META-INF/services/javax.xml.bind.JAXBContext`，然后根据文件中指定的类名手动加载（并反身地创建）一个 JAXBContext。所以没关系 - 类路径或认可的库给你同样的行为。

一种解决方法是添加`-Djavax.xml.bind.JAXBContext=com.sun.xml.internal.bind.v2.ContextFactory`到命令行，这会导致 JAXBContext.newInstance() 忽略`/META-INF/services/javax.xml.bind.JAXBContext`类路径中的文件并手动指定 JAXB 的内置版本。另一种解决方法是简单地不指定您自己的 JAXB 并使用 JDK 中内置的版本，但从非官方 JAXB 指南看来，Sun 设计该系统是为了能够处理提供您自己的 JAXB 实现。有没有人能够成功地提供一个 JAXB 版本并且仍然能够成功地捕获故障消息？（只要 Web 服务没有产生任何故障，对我来说一切都运行良好）。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-07-01T16:05:50.457

~~我被困在这个问题上，但能够通过设置这样的系统属性来使用此论坛~~问答中列出的“解决方法” ：

```
System.setProperty("javax.xml.bind.JAXBContext", 
                   "com.sun.xml.internal.bind.v2.ContextFactory"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T06:16:29.600

这个问题的症结在于 JAXB **API**发生了变化，您尝试使用的运行时实现与 JDK 捆绑的 JAXB API 的版本不匹配。

为了使用不同的版本，您应该将[jaxb-api.jar](http://www.java2s.com/Code/JarDownload/jaxb-api/jaxb-api-2.2.3.jar.zip)和[jaxws-api.jar](http://www.java2s.com/Code/JarDownload/jaxws/jaxws-api-2.2.1.jar.zip)的对应版本复制到认可的库中（例如`%JAVA_HOME%\lib\endorsed`）。

完整的选项列表[在非官方 JAXB 指南的第 7.1.2节中给出](http://jaxb.java.net/guide/Migrating_JAXB_2_0_applications_to_JavaSE_6.html#Using_JAXB_2_1_or_JAXB_2_2_with_JavaSE_6)

将实现 jars（例如 jaxb-impl.jar）复制到认可的库中是错误的，这些应该只是在您的类路径中。

另请注意，如果您尝试使用较新版本的 jaxb 而不包括兼容版本的 jaxws，则可能会遇到麻烦。这是因为旧的 jaxws 试图引用旧的 jaxb，所以如果您要更改一个，请确保两者都做。（包中的堆栈跟踪`com.sun.xml.internal.ws`暗示了旧的 jax-ws 实现。即使是最新版本的 Java 仍然附带旧版本 1 jaxb 和 jaxws api）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-21T13:06:26.097

API文档中描述了另一种不修改系统属性的可能解决方案

[https://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/1.6/api/javax/xml/bind/JAXBContext.html](https://docs.oracle.com/cd/E17802_01/webservices/webservices/docs/1.6/api/javax/xml/bind/JAXBContext.html)

您可以在模型类的包中放置一个 jaxb.properties 文件。

```
javax.xml.bind.context.factory=com.sun.xml.internal.bind.v2.ContextFactory 
```

# java - 如何检测何时通过 Selenium 在 GWT-LOG 中创建新条目？

> ID：14162163
> 
> 赞同：0
> 
> 时间：2013-01-04T17:46:28.927
> 
> 标签：java, gwt, selenium, webdriver, selenium-webdriver

我正在测试一个使用 Google Web Toolkit (GWT) 的网站。特别是，网站会弹出 GWT-LOG 窗口，该窗口显示网站上发生的所有后台活动。

我正在编写一些 Selenium 测试，我需要能够访问 GWT-LOG 中的条目。

现在，我已经设法通过使用 XPaths 编写了可以占用一大块 GWT-LOG 的代码——我正在使用**以前**和**当前**的“指针”来跟踪我上次在 GWT-LOG 窗口中离开的位置.

```
/**
 * Adds each GWT-LOG entry (one line) between "prevXPC" and "curXPC" into an
 * ArrayList<String> -- one line per ArrayList index.
 */
public void parseString(ArrayList<String> list) {
    // Total count of gwt-log entries
    int curXPC = driver.findElements(By.xpath(gwtXPath)).size();

    // Empty the ArrayList
    list.clear();

    // Add elements to the ArrayList between pXPC and cXPC counts
    for (int i = prevXPC; i <= curXPC; i++) {
        String logEntryXPath = "/html/body/table/tbody/tr[2]/td/div/div/div/div[" + i + "]";
        String newEntry = driver.findElement(By.xpath(logEntryXPath)).getText();
        list.add(newEntry);
    }

    prevXPC = (curXPC + 1); // Set the previous XPath count to the current one.
} 
```

当我知道所有日志条目都显示在 GWT-LOG 窗口中时，此代码工作正常。但是，当我执行一个显示一些条目的操作，然后在几秒钟后出现更多条目时，例如当站点正在等待服务器信息时，我的代码不是很有效。

有什么方法可以不断地“关注” GWT-LOG 条目并提醒我，或者`ArrayList<String>`像我以前一样使用 Selenium 将新的 GWT-LOG 条目保存到一个？

否则，我将不得不在我的测试中加入 Waits 来解决这个问题。这不是最理想的选择，因为等待的长度可能太长或太短。

# php - 从多个表中搜索、识别主键并返回结果

> ID：14162164
> 
> 赞同：0
> 
> 时间：2013-01-04T17:46:42.367
> 
> 标签：php, codeigniter, activerecord

在我的代码中，我只能搜索一个表并从一个表中返回一些东西，但是从发布的值姓氏中，我如何获取“emp_no”以便我可以从“dept_emp”返回“dept_no”和“title”从“头衔”？

控制器

```
public function findemp() 
{   
    // search in table 'employees'
    $name = $this->input->get('lastname');

    if($data['user'] = $this->fndmodel->finduser($name)) {

        $this->load->view('searchview', $data);
    }

    // search in table 'dept_emp'
    $dept = $this->input->get('deptmnt');
    // search in table 'titles'
    $title = $this->input->get('title');
} 
```

该模型

```
 public function finduser($name) {

    if ($name == null || $name == '') {
            return false;
    }

    $this->db->select('e.emp_no, e.first_name, e.last_name, t.title, d.dept_no');
    $this->db->from('employees AS e, titles AS t, dept_emp AS d');
    $this->db->where('e.emp_no = t.emp_no');
    $this->db->where('e.emp_no = d.emp_no');
    $this->db->where('e.last_name', $name);
    $data['query'] = $this->db->get();              
    return $data;

} 
```

这就是我想要的 activerecords

```
SELECT e.emp_no, e.first_name, e.last_name, t.title, d.dept_no
FROM employees e JOIN titles t
ON (e.emp_no = t.emp_no)
JOIN dept_emp d
ON (e.emp_no = d.emp_no)
WHERE e.last_name = "facello"; 
```

这是正确的吗？

```
$this->db->select('e.emp_no, e.first_name, e.last_name, t.title, d.dept_no');
$this->db->from('employees AS e, titles AS t, dept_emp AS d');
$this->db->where('e.emp_no = t.emp_no');
$this->db->where('e.emp_no = d.emp_no');
$this->db->where('e.last_name', $name);
$result = $this->db->get(); 
```

# mvvm - MVVM：如何使干净模型的视图模型集字段以将视图更改持久保存到数据库

> ID：14162168
> 
> 赞同：1
> 
> 时间：2013-01-04T17:47:09.643
> 
> 标签：mvvm, prism

在具有干净模型（未实现 INotifyPropertyChabged 之类的接口）的 MVVM 应用程序中，视图模型包含绑定到视图的属性，这些属性从视图模型中包含的模型对象获取其值，并且应该在视图更改时设置其属性的值绑定到这些属性的控件。问题是视图何时改变；更改由绑定视图模型属性捕获，但属性无法设置模型对象字段，模型不会更改。我需要模型字段接受视图模型属性的设置，然后考虑到它是一个干净的模型，我可以将更新的模型保存到数据库中。

这里是视图模型代码的一部分

```
public class SubsystemDetailsViewModel: INotifyPropertyChanged, ISubsystemDetailsViewModel
    {
        #region Fields
        //Properties to which View is bound
        private int? _serial;
        public int? Serial
        {
            get { return Subsystem.Serial; }
            set
            {
                //Subsystem.Serial=value;
                _serial = value;
                OnPropertyChanged("Serial");
            }
        }

        private string _type;
        public string Type
        {
            get { return Subsystem.Type; }
            set
            {
                //Subsystem.Type = value;
                _type = value;
                OnPropertyChanged("Type");
            }
        }

       //remaining properties ....

        #endregion

        //Service
        private readonly ISubsystemService _subsystemService;

        //Reference to the View
        public ISubsystemDetailsView View { get; set; }

        //Event Aggregator Event
        private readonly IEventAggregator eventAggregator;

        //Commands
        public ICommand ShowTPGCommand { get; set; }
        public DelegateCommand UpdateCommand { get; set; }

       //
        private bool _isDirty;

        //Constructor ************************************************************************************************
        public SubsystemDetailsViewModel(ISubsystemDetailsView View, ISubsystemService subsystemService, IEventAggregator eventAggregator)
        {
            _subsystemService = subsystemService;

            this.View = View;
            View.VM = this;

            //EA-3
            if (eventAggregator == null) throw new ArgumentNullException("eventAggregator");
            this.eventAggregator = eventAggregator;
            //Commands
            this.ShowTPGCommand = new DelegateCommand<PreCommissioning.Model.Subsystem>(this.ShowTestPacks);
            this.UpdateCommand = new DelegateCommand(this.UpdateSubsystem, CanUpdateSubsystem);

        }

        //****************************************************************************************************************
        //ICommand-3 Event Handler 
        //this handler publish the Payload "SelectedSubsystem" for whoever subscribe to this event
        private void ShowTestPacks(PreCommissioning.Model.Subsystem subsystem)
        {
            eventAggregator.GetEvent<ShowTestPacksEvent>().Publish(SelSubsystem);
        }
        //===============================================================================================
        private void UpdateSubsystem()
        {

            _subsystemService.SaveChanges(Subsystem);
        }

        private bool CanUpdateSubsystem()
        {
            return _isDirty;
        }
        //*******************************************************************************************
        public void SetSelectedSubsystem(PreCommissioning.Model.Subsystem subsystem)
        {
            this.SelSubsystem = subsystem;

        }

        //************************************************************************************************************
        /// <summary>
        /// Active subsystem >> the ItemSource for the View
        /// </summary>
        private PreCommissioning.Model.Subsystem _subsystem;
        public PreCommissioning.Model.Subsystem Subsystem
        {
            get
            { 
                //return this._subsystem;
                GetSubsystem(SelSubsystem.SubsystemNo);
                return this._subsystem;

            }

            set
            {
                if (_subsystem != value)
                {
                    _subsystem = value;
                    OnPropertyChanged("Subsystem");
                }

            }

        }

        //Call the Service to get the Data form the Database
        private void GetSubsystem(string SSNo)
        {
            this._subsystem = _subsystemService.GetSubsystem(SSNo);

        }

        #region Implementation of INotifyPropertyChanged
        public event PropertyChangedEventHandler PropertyChanged;

        private void OnPropertyChanged(string propertyName)
        {
            _isDirty = true;
            UpdateCommand.RaiseCanExecuteChanged();

            PropertyChangedEventHandler handler = this.PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(propertyName));
            }
        }
        #endregion

    }
} 
```

Subsystem 是使用 GetSubsystem() 方法填充的模型对象。像 Serial 这样的视图模型属性从模型中获取其值，如图所示。我尝试设置模型属性，如属性设置部分中的注释行所示，但子系统对象没有发生变化，始终保持其原始值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T21:43:03.730

如果`GetSubsystem`每次都返回一个新的子系统，那就是你的问题。在您绑定到视图的属性的“集合”中，您调用的是公共属性“子系统”，而不是您创建的私有字段。因此，每次您从视图中设置属性时，您都在调用 Subsystem.get 来调用`GetSubsystem(SelSubsystem.SubsystemNo);`.

我认为，在您的 ViewModel 属性中，您希望将其更改为：

```
//Properties to which View is bound
public int? Serial
{
    get { return _subsystem.Serial; }
    set
    {
        _subsystem.Serial=value; // NOTE THE USE OF THE PRIVATE FIELD RATHER THAN THE PROPERTY
        OnPropertyChanged("Serial");
    }
}

public string Type
{
    get { return _subsystem.Type; }
    set
    {
        _subsystem.Type = value; // NOTE THE USE OF THE PRIVATE FIELD RATHER THAN THE PROPERTY
        OnPropertyChanged("Type");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:06:06.013

您需要在视图模型中引用模型，并且视图模型会将值传递给模型。您的视图模型将实现 INotifyPropertyChanged 并将成为您视图的数据上下文。在您的视图模型中，编写您的绑定属性，如下所示：

```
private string yourProperty;
public string YourProperty
{
get { return yourProperty; }
set
{
if (value == yourProperty)
    return;
yourProperty= value;
YOUR_MODEL_REFERENCE.YourProperty= yourProperty;
this.RaisePropertyChanged(() => this.YourProperty);
}
} 
```

# c++ - 视频未写入文件

> ID：14162169
> 
> 赞同：3
> 
> 时间：2013-01-04T17:47:16.283
> 
> 标签：c++, opencv

我正在使用 opencv 直接从网络摄像头捕获视频并将其保存到 avi 文件。我使用了以下代码：

```
 #include "StdAfx.h"

using namespace std;
using namespace cv;

int _tmain()
{
    VideoCapture src;
    src.open(1);
    if(!src.isOpened())
    {
        cout<<"could not open camera\n";
        return -1;
    }
    else
    {
        cout<<"camera opened\n";
    }

    int ex=static_cast<int>(src.get(CV_CAP_PROP_FOURCC));
    Size s(Size((int)src.get(CV_CAP_PROP_FRAME_WIDTH),(int)src.get((CV_CAP_PROP_FRAME_HEIGHT))));
    VideoWriter out;
    out.open("out.avi",ex,20,s);
    while(1)
    {
        Mat im;
        src>>im;
        imshow("vid",im);
        out<<im;
        char c;
        c=cvWaitKey(50);
        if(c==27)
            break;
    }

    system("pause");
} 
```

所有标头都包含在 stdafx.h 中。但实际上我得到了一个大小为 0bite 的 avi 文件。如何解决这个问题？我需要录制网络摄像头视频而不显示。

* * *

注意：我是 openCV 的新手，我正在使用 Visual Studio 2010

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T20:03:43.440

运行应用程序而不显示网络摄像头只需删除

```
imshow("vid",im); 
```

out.avi大小为 0 **，**因为您在应用程序运行时打开它（当您打开视频流并在其上写入时），要打开您录制的视频，只需关闭应用程序以结束对视频的写入然后打开它 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T07:54:07.063

实际上，您的程序中没有逻辑错误。唯一的问题是`FOUR_CC`您用于编写视频的编解码器。

当我运行你的代码时，我遇到了和你一样的问题。当我将错误检查添加到`out.open()`函数中时，我发现了问题。

最有可能的是，avi 容器不支持相机的 FOUR_CC 编解码器。

当您使用 Windows 时，一个不错的选择是`CV_FOURCC_PROMPT`在`out.open`.

这将打开一个弹出列表框，其中包含可用的不同 FOUR_CC 编解码器。如果您不知道该选择哪一个，只需选择`Full Frames (Uncompressed)`。这是最兼容的选项，但会增加输出视频文件的大小。

最终代码应如下所示：

```
if(!out.open("out.avi",CV_FOURCC_PROMPT,20,s))
{
    cout<<"Writer Not Opened"<<endl;
    return -1;
} 
```

# xml - 使用 HXT 解析 Haskell 中的多个子节点

> ID：14162170
> 
> 赞同：3
> 
> 时间：2013-01-04T17:47:18.890
> 
> 标签：xml, haskell, hxt

我需要在 Haskell 中解析一个 XML 文件，所以我选择了 HXT。到目前为止我喜欢它，但我无法弄清楚如何做一件事。

我正在解析的文件包含作为配置文件的信息。它的结构类似于

```
<clients>
    <client>
        <name>SomeName</name>
        <info>MoreInfo</info>
        <table>
            <row>
                <name>rowname1</name>
                <value>rowvalue1</value>
            </row>
            <row>
                <name>rowname2</name>
                <value>rowvalue2</value>
            </row>
        </table>
    </client>
    ...
</clients> 
```

这种标记格式让我感到畏缩，但这是我必须使用的。

我在 Haskell 中对这些中的每一个都有如下记录

```
data Client = Client { name :: String, info :: String, table :: Table }
data Row = Row { name :: String, value :: String }
type Table = [Row] 
```

我想从文件中获取数据作为`Clients`. 我当前的代码看起来像

```
data Client = Client { name :: String, info :: String, table :: Table }
data Row = Row { name :: String, value :: String }
type Table = [Row]

getClients = atTag "client" >>>
    proc client -> do
        name <- childText "name" -< client
        info <- childText "info" -< client
        table <- getTable <<< atTag "table" -< client

        returnA -< Client name info table
    where
        atTag tag = isElem >>> hasName tag
        atChildTag tag = getChildren >>> atTag tag
        text = getChildren >>> getText
        childText tag = atChildTag tag >>> text

        getTable = atChildTag "row" >>>
            proc row -> do
                name <- childText "name" -< row
                value <- childText "value" -< row
                returnA -< Row name value 
```

但它不能编译，因为它只`Row`从 中得到一个返回`getTable`，而不是`Row`s 的列表。由于这是我第一次使用 HXT，我知道我做错了什么，但我不知道如何修复它。

任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T17:49:50.647

我最终在一个相关问题中找到了答案，我不知道存在`listA`（我对 Arrows 也很陌生），并且解决了它！

# jquery - 具有多个参数的服务方法的 Ajax 查询

> ID：14162171
> 
> 赞同：0
> 
> 时间：2013-01-04T17:47:20.567
> 
> 标签：jquery, ajax, grails, service

我需要进行 Ajax 查询来调用 Service 对象中的一个方法，该方法接受 3 个参数并返回一个布尔值。然后，我将这个布尔值用于在发布前发生的验证消息。

这就是我目前所拥有的（不工作），但我尝试了其他事情但无济于事。我们正在使用 JQuery 和 Grails：

```
var isUnique = ${remoteFunction(
    service: 'Project', 
    action:'checkUniqueUserProjectId',
    params:{
        // These values are from  hidden fields in the form.
        // userId and projectId are string values and the group is an object
        uniqueId: userId,
        group: userGroup,
        projectId: myProjectId
    }
)} 
```

这是在 ProjectService 中调用的方法：

```
// Check whether or not a Project with the provided uniqueId already exists 
// in the database that is not itself.
def checkUniqueUserProjectId(uniqueId,group,projectId) {
    def filterCriteria = Project.createCriteria()
    def projectList = filterCriteria.list {
        and {
            eq("userProjectId", uniqueId)
            eq("group", group)
            ne("id",projectId)
        }
    }

    if(projectList.empty)
        return true
    else
        return false
} 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:54:20.390

I ended up using a remote function with the code as follows:

```
${remoteFunction(action: 'isUniqueId', params: '\'uniqueid=\'+userId+\'&project_id=\'+myProjectId', onFailure:'$("#project").submit()', onSuccess:'verifyUniqueness(data, textStatus,detailsMessage)') } 
```

....

```
function verifyUniqueness(data, textStatus,detailsMessage) {
    if (data == 'false') {
        detailsMessage = detailsMessage + "A Project with the provided Project ID already exists.";
    }

    if (detailsMessage.trim() != '' ) { 
        stackedSummary.section('details', '<font style="color:red; font-weight:normal; line-height:0px;">' + detailsMessage + '</font>');
    } else {
        $('#project').submit();
    }
} 
```

ProjectController

```
def isUniqueId = {
    def project = Project.get(params.project_id)
    if (project == null) {
        render(projectService.checkUniqueUserProjectId(params.uniqueid, null, null)) as JSON
    } else {
        render(projectService.checkUniqueUserProjectId(params.uniqueid, project.group, project.id)) as JSON
    }
} 
```

Thank you everyone for your help! You helped lead me in the right direction :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:27:55.400

```
$.post('Project/checkUniqueUserProjectId', {
        uniqueId : userId,
        group    : userGroup,
        projectId: myProjectId
}, 
function (response) {
    if (response.firstChild.textContent=="true") {
        alert("hola mundo");
    }
}); 
```

如果响应是 JSON 格式会更好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:48:04.937

所以在你的控制器中：

```
if ( projectService.checkUniqueUserProjectId(params.uniqueId, params.group, params.projectId) )
{
    render([:] as JSON)
}
else
{
    response.status = 403
} 
```

JavaScript：

```
var isUnique;

$.ajax({
    type: "POST",
    url: "contextPath/controller/action",
    data: {uniqueId: userId, group: userGroup, projectId: myProjectId},
    success: function() { isUnique = true; },
    error: function() { isUnique = false; },
    dataType: "json"
}); 
```

# asp.net-mvc - ASP.NET MVC - 返回 View("MyView"); 崩溃的应用程序。我该如何调试？

> ID：14162175
> 
> 赞同：0
> 
> 时间：2013-01-04T17:47:40.500
> 
> 标签：asp.net-mvc, visual-studio

所以，今天我回到了我过去编写的应用程序中的一些旧方法，发现当我执行“ `return View("MyView");`”时，它会使我的应用程序崩溃。Chrome 只是不断加载和加载，没有任何反应。过去它工作得很好，我没有改变任何事情。我如何调试它并知道发生了什么？我在返回视图之前执行了一些其他的东西，但是断点成功地通过了这个返回，然后什么也没有发生。:-O

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:52:57.083

每当我遇到这个问题时，它总是由于 FormsAuthentication 的问题。该循环通常是重定向到登录页面，因为该页面检测到您未登录，但登录页面重定向回来，因为它检测到您已登录。

通常的原因是使用另一个应用程序进行身份验证，但两个应用程序使用的密钥（在 machineKey 设置中指定）不匹配。

# php - 检查空字符串 php

> ID：14162178
> 
> 赞同：1
> 
> 时间：2013-01-04T17:48:03.077
> 
> 标签：php

我正在尝试写入 csv。

使用此功能，如果没有写入其他值，我需要脸皮

我尝试过 empty、preg_match、strlen 但我总是得到一个或另一个所以我需要检查`$v->Klasifikacija`它是否为空然后输入`$v->BrojArtikla` 我该怎么做？

现在我得到了它，但不明白为什么：

```
if (strlen(trim((string)$v->Klasifikacija)) < 4) { 
```

如果你能向我解释一下？

```
elseif ($v3 == 'Referenca') {
    if (preg_match('/\S/', $v->Klasifikacija)) {
        $b .= $v->BrojArtikla . DELIMITER;
        $v->$v3 = $v->BrojArtikla;
    } else {
        $b .= $v->Klasifikacija . DELIMITER;
        $v->$v3 = $v->Klasifikacija;
    }
} 
```

这是解析 XML 文件的完整代码

```
 function parsing_xml($supplier_name,$xml_url,$opsi='string'){
                $xml = simplexml_load_file(utf8_encode($xml_url), 'SimpleXMLElement', LIBXML_NOCDATA);
                //$xml = simplexml_load_file($xml_url, 'SimpleXMLElement', LIBXML_NOCDATA);
                if(!$xml){echo "xml $xml_url not loaded.";exit;}
                $i=0;
                $string="";
                foreach($xml as $k=>$v){
                    $b="";
                    if($i==0){
                        foreach($v as $k1=>$v1){
                            $head[]=$k1;
                        }
                        array_push($head,"dugi_opis","meta_description","meta_tag","tax","supplier","quantity","price","Referenca");
                        //array_push($head,"dugi_opis","meta_description","meta_tag","tax","supplier","quantity","price","Referenca");
                        foreach($head as $k4=>$v4){
                            $b.= "$v4".DELIMITER;
                        }
                    }//echo $xml->$k->BrojArtikla."=>".$xml->$k->Image."<pre>".print_r($head,1)."</pre>";
                    foreach($head as $k3=>$v3){
                        if($v3=='meta_description'){$v3='Naziv';}

                        if(empty($v->$v3) or $v->$v3=="" or !isset($v->$v3)){
                            $v->$v3="|||";
                        }
                        if($v3=='tax'){
                            $b.=TAX.DELIMITER;
                            $v->$v3=TAX;
                        }elseif($v3=='supplier'){
                            $b.=$supplier_name.DELIMITER;
                            $v->$v3=$supplier_name;
                        }elseif($v3=='quantity'){
                            if($v->Status=="Dostupno"){
                            //if($v->Status=='Raspoloživo'){
                                $b.="2".DELIMITER;
                                $v->$v3=2;
                            }else{
                                $b.="0".DELIMITER;
                                $v->$v3=0;
                            }
                        }elseif($v3=='Akcija'){
                            $b.= (string) floatval($v->$v3).DELIMITER;
                            $v->$v3= (string) floatval($v->$v3);
                        }elseif($v3=='NetoPrice'){
                            $b.= (string) floatval($v->$v3).DELIMITER;
                            $v->$v3= (string) floatval($v->$v3);
                        }elseif($v3=='ListPrice'){
                            $b.= (string) floatval($v->$v3).DELIMITER;
                            $v->$v3= (string) floatval($v->$v3);
                        }elseif($v3=='Rabat'){
                            $b.= (string) floatval($v->$v3).DELIMITER;
                            $v->$v3= (string) floatval($v->$v3);
                        }elseif($v3=='price'){
                            $b.= (string) floatval($v->NetoPrice)*MARZA.DELIMITER;
                            $v->$v3=(string) floatval($v->NetoPrice)*MARZA;
                        }

                        elseif($v3=='meta_tag'){
                            $b.=$v->Klasifikacija.','.$v->Proizvodjac.DELIMITER;
                            $v->$v3=$v->Klasifikacija.','.$v->Proizvodjac;
                        }

                        elseif($v3=='Referenca'){
                            //if(empty($v->Klasifikacija)){
                            //if(strlen($v->Klasifikacija)===0){
                            ///if(preg_match('/\S/',$v->Klasifikacija)){

                            //if(isset($v->Klasifikacija) || $v->Klasifikacija === ''){
                            //if(isset($v->Klasifikacija)){
                            //if(strlen($v->Klasifikacija) < 2){

                            if(trim($v->Klasifikacija) === ''){

                            $b.=$v->BrojArtikla.DELIMITER;
                            $v->$v3=$v->BrojArtikla;

                            //$b.=$v->Klasifikacija.DELIMITER;
                           // $v->$v3=$v->Klasifikacija;

                            }else{

                            //$b.=$v->BrojArtikla.DELIMITER;
                            //$v->$v3=$v->BrojArtikla;

                            $b.=$v->Klasifikacija.DELIMITER;
                            $v->$v3=$v->Klasifikacija;

                            }

                        }

                        // ovo za sad nije potrebno
                        // elseif($v3=='dugi_opis'){
                            // $b.=$v->dugi_opis.DELIMITER;
                            // $v->$v3=$v->dugi_opis;
                        // }

                        else{
                            $b.=$v->$v3.DELIMITER;
                        }
                    }
                    $supplier_item[(string)$v->BrojArtikla]=$v;
                    $b=substr($b,0,-1);
                    $b=str_replace("'","\'",$b);
                    $b=str_replace('"','\"',$b);
                    $b=str_replace("\n"," ",$b);

                    $i++;
                    $string.="\n$b";    

                }
                if($opsi=='string'){
                    return $string;
                }elseif($opsi=='supplier_item'){
                    return $supplier_item;
                }else{
                    $z['string']=$string;
                    $z['supplier_item']=$supplier_item;
                    return  $z;
                }
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:03:59.450

检查字符串是否为空的最佳方法是使用[strlen](http://php.net/manual/en/function.strlen.php)。

注意字符串“0”的[空](http://php.net/manual/en/function.empty.php)返回true。

```
$a = "";
$b = "0";
echo empty($a), " ", empty($b), " ", strlen($a), " ", strlen($b), "\n";
//OUTPUT: 1, 1, 0, 1 
```

如果您想考虑只有空格为空的字符串，请查看[trim](http://php.net/manual/en/function.trim.php) PHP 方法。你的条件是：

```
if (0 == strlen(trim($v->Klasifikacija))) {} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:00:27.273

是什么类型的`$v->Klasifikacija`？如果它不是一个字符串（它可能是一个`SimpleXMLElement`实例），那么也许你应该将它转换为一个字符串并在之后检查是否为空。尝试`var_dump($v->Klasifikacija)`确定类型。也许你在这里有多个问题。你可以做类似的事情

```
$stringValue = (string) $v->Klasifikacija;
$stringValue = trim($stringValue);
if (strlen($stringValue) == 0)) {
    // ...
} 
```

还要记住，这`empty`是`true`为了`"0"`！

顺便说一句，您可以使用[PHPs CSV 函数节省](http://php.net/manual/en/function.fputcsv.php)大量时间！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T17:56:26.350

如果 $v->Klasifikacija 是一个字符串，那么试试这个....

```
 elseif($v3=='Referenca'){

        if(empty($v->Klasifikacija)){

        $b.=$v->BrojArtikla.DELIMITER;

        $v->$v3=$v->BrojArtikla;

        }else{

        $b.=$v->Klasifikacija.DELIMITER;

        $v->$v3=$v->Klasifikacija;

        }

    } 
```

您还可以检查 $v->Klasifikacija=='' 或 strlen($v->Klasifikacija)>0 等....

# django - 依赖会话变量的 Django 视图的后备

> ID：14162180
> 
> 赞同：1
> 
> 时间：2013-01-04T17:48:03.770
> 
> 标签：django, django-views, django-sessions

我有一个看起来像这样的视图：

```
def CineByCiudad(request):
    city = request.session["ciudad"]
    cines = Cine.objects.filter(ciudad=city)
    context = {'cines': cines}
    return render_to_response('cine-ciudad.html', context, context_instance=RequestContext(request)) 
```

现在，我正在使用会话变量“ciudad”来过滤我的查询。在我网站的主页上，我让用户设置他们的“ciudad”，一旦设置好，我将他们重定向到另一个页面，他们可以开始根据他们的城市（“ciudad”）查看内容。

我的主页检查会话是否有项目：

```
def index(request):
    #Checks to see if the session has items, in particular if a city has been set
    if not request.session.items():
        return render_to_response('index.html', context_instance=RequestContext(request))
    else:
        return redirect(Cartelera) 
```

现在让我们假设由于某种原因，用户删除了他的 cookie，并且在他访问的网站上，他访问了一个与主页不同的 url（例如 www.site.com/cartelera），然后他会收到一个错误，因为会话变量“ciudad”没有设置.

有没有办法为这个会话变量创建一个默认值，以防它没有被设置？或者什么是处理这个问题的好习惯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:50:24.297

如果未设置该值，请在会话上使用[dict.get方法检索默认值，如下所示：](http://docs.python.org/2/library/stdtypes.html#dict.get)

```
city = request.session.get('ciudad', 'default value') 
```

# asp.net-web-api - Breeze webapi 控制器“无法支持查询”超过 DbSet 错误

> ID：14162181
> 
> 赞同：0
> 
> 时间：2013-01-04T17:48:07.123
> 
> 标签：asp.net-web-api, entity-framework-5, breeze

[我的设置与示例 nuget](https://nuget.org/packages/Breeze.MVC4WebApiClientSample/0.82.1)中的微风示例应用程序非常相似。这是我的 api 控制器的代码：

```
[JsonFormatter, ODataActionFilter]
public class WorkOrdersController : ApiController
{
    readonly EFContextProvider<WorkOrdersContext> _contextProvider =
        new EFContextProvider<WorkOrdersContext>();

    public WorkOrdersController()
    {
        // I was thinking this may be the cause of the issue
        this._contextProvider.Context.Configuration.ProxyCreationEnabled = false;
    }

    [HttpGet]
    public string Metadata()
    {
        return _contextProvider.Metadata();
    }

    [HttpPost]
    public SaveResult SaveChanges(JObject saveBundle)
    {
        return _contextProvider.SaveChanges(saveBundle);
    }

    [HttpGet]
    public IQueryable<WorkOrder> WorkOrders()
    {
        return _contextProvider.Context.WorkOrders;
    }

} 
```

我遇到的问题是当我尝试对`WorkOrders`操作执行查询时，我得到 500 - Internal server error，这是响应的有效负载：

```
{"$id":"1","$type":"System.Web.Http.HttpError, System.Web.Http","Message":"An error has occurred.","ExceptionMessage":"The action 'WorkOrders' on controller 'WorkOrders' with return type 'System.Collections.Generic.List`1[[WorkOrders.Domain.Models.WorkOrder, WorkOrders.Domain, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]' cannot support querying. Ensure the type of the returned content is IEnumerable, IQueryable, or a generic form of either interface.","ExceptionType":"System.InvalidOperationException","StackTrace":"   at System.Web.Http.QueryableAttribute.ValidateReturnType(Type responseContentType, HttpActionDescriptor actionDescriptor)\r\n   at System.Web.Http.QueryableAttribute.OnActionExecuted(HttpActionExecutedContext actionExecutedContext)\r\n   at System.Web.Http.Tracing.ITraceWriterExtensions.TraceBeginEnd(ITraceWriter traceWriter, HttpRequestMessage request, String category, TraceLevel level, String operatorName, String operationName, Action`1 beginTrace, Action execute, Action`1 endTrace, Action`1 errorTrace)\r\n   at System.Web.Http.Tracing.Tracers.ActionFilterAttributeTracer.OnActionExecuted(HttpActionExecutedContext actionExecutedContext)\r\n   at System.Web.Http.Filters.ActionFilterAttribute.<>c__DisplayClass2.<System.Web.Http.Filters.IActionFilter.ExecuteActionFilterAsync>b__0(HttpResponseMessage response)\r\n   at System.Threading.Tasks.TaskHelpersExtensions.<>c__DisplayClass41`2.<Then>b__40(Task`1 t)\r\n   at System.Threading.Tasks.TaskHelpersExtensions.ThenImpl[TTask,TOuterResult](TTask task, Func`2 continuation, CancellationToken cancellationToken, Boolean runSynchronously)"} 
```

WorkOrders 是上下文中的 Dbset：

```
public DbSet<WorkOrder> WorkOrders { get; set; } 
```

我也尝试过将其显式转换为 IQueryable，没有任何变化：

```
[HttpGet]
public IQueryable<WorkOrder> WorkOrders()
{
    return (IQueryable<WorkOrder>)_contextProvider.Context.WorkOrders;
} 
```

唯一对我有用的是：

[HttpGet] public IEnumerable WorkOrders() { return _contextProvider.Context.WorkOrders.AsEnumerable(); }

然而，这在客户端给我带来了另一个问题，在[这个](https://stackoverflow.com/q/14148828/408643)问题中有所描述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:32:17.330

这里只是一个猜测，但您可以尝试使用具有以下属性的最新微风（v 0.82.1）。

[微风控制器]

而不是这些

[JsonFormatter，ODataActionFilter]

新的 [BreezeController] 属性完全替代了其他两个属性，并避免了其他一些问题。

# java - TestNG 在 Reporter 之后我可以在哪里运行代码？想发送 test-output/emailable-report.html

> ID：14162183
> 
> 赞同：0
> 
> 时间：2013-01-04T17:48:15.073
> 
> 标签：java, testng

我想运行代码来发送带有文件 emailable-report.html 的电子邮件。理想情况下，当我从 IDE 或 Maven 运行 TestNG 套件时，这将起作用。我认为这里提出了同样的问题： [https ://groups.google.com/forum/?fromgroups=#!topic/webdriver/fvJ-edHPJ3g](https://groups.google.com/forum/?fromgroups=#!topic/webdriver/fvJ-edHPJ3g)

从评论中，我试图了解按照建议做的最小方法，使用添加的代码覆盖现有 EmailableReporter 中的方法以发送电子邮件。我试图避免完全实现我自己的 IReporter 侦听器，尽管主要是因为我很难遵循关于这样做的说明（有点超出我的 java-foo，欢迎提供一个完整的示例）。

我的课看起来像：

```
public class TestMailSender extends EmailableReporter{
    TestMailer testMailer = new TestMailer();
    Message resultEmail;

@Override
public void generateReport(List<XmlSuite> arg0, List<ISuite> arg1, String arg2) {

    /* Use the parent class to do the work */
    super.generateReport(arg0, arg1, arg2);

    /* create email from utility class with address, subject line, message content */
    resultEmail = testMailer.makeEmail("someone@somewhere.com", "Build: " + "test"
            + "suite results", "results attached");

    /* fetch the hopefully completed default report */
    /* TODO: get report to common path for both IDE and Maven runs */
    File resultsFile = new File("./test-output/emailable-report.html");

    /* add file to the email with build referencing name, then send the email */
    resultEmail = testMailer.attachFile(resultEmail, resultsFile.getAbsoluteFile(),
            "build_" + "test" + "_emailable-report.html");
    testMailer.sendEmail(resultEmail);
}
} 
```

当我将上述类作为侦听器添加到 TestNG 套件时，我得到一个空结果。我正在尝试在 testNG.xml 套件中执行此操作，如下所述：http: [//testng.org/doc/documentation-main.html#listeners-testng-xml](http://testng.org/doc/documentation-main.html#listeners-testng-xml)

我想空结果可能是进度，因为它没有像我将代码放入@AfterSuite 时那样发送先前的运行结果文件。在完成 emailable-report.html 文件后，我不能像尝试那样运行我的代码，因为通过电子邮件发送的文件是空的。如果我更改 resultsFile 的路径，**我**会得到一些东西，我会得到 FileNotFoundException，但我猜该文件在我尝试发送它的时候还没有刷新和关闭。

我可以将我的代码放在哪里，以便它可以找到并发送完成的 emailable-report.html 文件以用于当前运行？我必须实现自己的 IReporter 侦听器，还是有一些简单的方法可以获取生成 emailable-report.html 文件的默认侦听器的（*已完成）输出？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T06:33:23.203

我最终将上面的代码示例编辑为对 generateReport 而不是 endHtml 的覆盖，但想法或多或少是相同的。我认为让我感到困惑的是，我尝试使用的路径不正确，一旦我切换到 arg2 而不是不正确的硬编码字符串，事情就开始起作用了。下面的代码块加上扩展类的定义作为我的 testNG.xml 中的侦听器，并且 Bob 是我的叔叔。

```
public class TestMailSender extends EmailableReporter{
TestMailer testMailer = new TestMailer();
Message resultEmail;

@Override
public void generateReport(List<XmlSuite> arg0, List<ISuite> arg1, String arg2) {

    super.generateReport(arg0, arg1, arg2);

    String someBuildIdAsParameter = arg1.get(0).getParameter("build");
    String someEmailAsParameter = arg1.get(0).getParameter("notifyEmail");
    /* create email from utility class with address, subject line, message content */
    resultEmail = testMailer.makeEmail(someEmailAsParameter, "Build: " + someBuildIdAsParameter
            + " suite results", "results attached");

    /* fetch the hopefully completed default report */
    File resultsFile = new File(arg2 + "\\emailable-report.html");

    /* add file to the email with build referencing name, then send the email */
    resultEmail = testMailer.attachFile(resultEmail, resultsFile.getAbsoluteFile(),
            "build_" + someBuildIdAsParameter + "_emailable-report.html");
    testMailer.sendEmail(resultEmail);
    }
} 
```

# javascript - 单独文档中的事件处理程序

> ID：14162184
> 
> 赞同：1
> 
> 时间：2013-01-04T17:48:17.880
> 
> 标签：javascript

我想将我所有的 JavaScript 保存在一个单独的文档中，我喜欢这样。现在我遇到了从我的 HTML 代码移动到我单独的 JavaScript 文档的最后一点代码的问题。

我有两个看起来像这样的事件处理程序：

```
<a href="http://www.commercial.se" onclick="confirmLeave()" target="_blank"> 
```

和

```
<IMG SRC="folder/pic_small.jpg" alt="Description"  onClick="view(this);"> 
```

这是两个事件处理程序的 javascript 代码：

```
function confirmLeave()
{
  if(confirm("Vill du lämna Blomstermåla-Bladet?")) {
    return true;
  } else {
    if(window.event) {
      window.event.returnValue = false;
    } else {
      e.preventDefault();
    }
    return false;
  }
} 
```

和

```
function view(img) {
   imgsrc = img.src.split("_")[0] + "_big.jpg";
   viewwin = window.open(imgsrc,'viewwin', "width=790,height=444,location=0");  
  viewwin.focus();  
} 
```

通过将我的 HTML 更改为以下内容，我设法解决了我的 HTML 文档中没有第一个 onClick 事件处理程序的 javascript 代码的问题：

```
<a href="http://www.commercial.com" id="external-link" target="_blank"> 
```

并将其添加到我的 javascript 文档中：

```
function init()
{
    var link = document.getElementById("external-link");

    link.onclick = confirmLeave;
}

window.onload = init; 
```

我尝试向另一个事件处理程序添加类似的解决方案，但我无法弄清楚我需要使用它来工作的代码。我也想知道如何将该事件处理程序添加到 init 函数中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:53:40.910

如果你不想改变`view`函数，你可以做类似的事情，只是你需要将图像作为参数传递给`view`函数。您可以通过将匿名函数设置为单击处理程序来执行此操作。

```
<IMG SRC="folder/pic_small.jpg" alt="Description" id="some-img"> 
```

```
function init()
{
    var img = document.getElementById("some-img");

    img.onclick = function(){
        view(this);
    };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:54:29.250

试试这个

```
 <a href="http://www.commercial.com" class="external-link" target="_blank"> 
 <IMG SRC="folder/pic_small.jpg" alt="Description" id = "external-image">

    function init() {
    var link = document.getElementById("external-link");

    var links = document.getElementsByClassName("external-link");
    for (var i = 0; i < links.length; i++) {
        links[i].onclick = confirmLeave;
    }

    var image = document.getElementById("external-image");
    image.onclick = view;
}

window.onload = init;​ 
```

而不是**img**在你的功能只是使用**这个**

```
function view() {
   imgsrc = this.src.split("_")[0] + "_big.jpg";
   viewwin = window.open(imgsrc,'viewwin', "width=790,height=444,location=0");  
  viewwin.focus();  
} 
```

# asp.net - Visual STudio 2010 中的 ASP.net。使用下拉列表和提交按钮

> ID：14162186
> 
> 赞同：0
> 
> 时间：2013-01-04T17:48:24.383
> 
> 标签：asp.net, visual-studio-2010

我是 Visual Studio 2010 的新手。我有一个下拉列表，可以从基本的 select from 语句中提取数据列表。下拉列表中只有 4 个选项。假设只有苹果、香蕉、梨和葡萄。我如何做到这一点，当我选择苹果时它会重定向到一个页面，但是如果我选择香蕉它会重定向到另一个页面？目前我有提交按钮指向一个页面，但我如何让它根据用户选择动态变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:55:11.727

处理 select 元素的 onchange 事件：

```
function getComboA(sel) {
    var value = sel.options[sel.selectedIndex].value;  
    // decide what to do with value for example
    if(value=='apple')
      window.location='pages.aspx';

}

<asp:dropDownList onchange="getComboA(this);" ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T20:01:58.480

到这个时候你不需要渲染任何控制asp。

选项1

```
<select id="myselect" onchange="myfunction();">
    <option value=""></option>
    <option value="apple">apple</option>
    <option value="banana">banana</option>
    <option value="pear">pear</option>
    <option value="grapes">grapes</option>
</select>
<script type="text/javascript">
    function myfunction() {
        var value = $("#myselect").val();
        switch (value) {
            case "apple":
                window.location = "http://www.apple.com/";
                break;
            case "banana":
                window.location = "http://www.google.com/";
                break;
            case "pear":
                window.location = "http://www.apple.com/";
                break;
            case "grapes":
                window.location = "http://www.apple.com/";
                break;
        }
    }
</script> 
```

选项 2

```
<asp:DropDownList ID="myselect" onchange="myfunction();" runat="server">
    <asp:ListItem Text="apple" Value="apple" />
    <asp:ListItem Text="banana" Value="banana" />
    <asp:ListItem Text="pear" Value="pear" />
    <asp:ListItem Text="grapes" Value="grapes" />
</asp:DropDownList>
<script type="text/javascript">
    function myfunction() {
        var value = $("#<%= myselect.ClientID %>").val();
        switch (value) {
            case "apple":
                window.location = "http://www.apple.com/";
                break;
            case "banana":
                window.location = "http://www.google.com/";
                break;
            case "pear":
                window.location = "http://www.apple.com/";
                break;
            case "grapes":
                window.location = "http://www.apple.com/";
                break;
        }
    }
</script> 
```

选项 3（需要回发）

```
<asp:DropDownList ID="myselect" runat="server" OnSelectedIndexChanged="myselect_SelectedIndexChanged" AutoPostBack="True">
    <asp:ListItem Text="apple" Value="apple" />
    <asp:ListItem Text="banana" Value="banana" />
    <asp:ListItem Text="pear" Value="pear" />
    <asp:ListItem Text="grapes" Value="grapes" />
</asp:DropDownList> 
```

在 .cs 后面的代码中

```
protected void myselect_SelectedIndexChanged(object sender, EventArgs e)
{
    switch (myselect.SelectedValue)
    {
        case "apple":
            Response.Redirect("http://www.apple.com/");
            break;
        case "banana":
            Response.Redirect("http://www.apple.com/");
            break;
        case "pear":
            Response.Redirect("http://www.apple.com/");
            break;
        case "grapes":
            Response.Redirect("http://www.apple.com/");
            break;
    }
} 
```

# .net - 多线程递归任务

> ID：14162191
> 
> 赞同：1
> 
> 时间：2013-01-04T17:48:47.550
> 
> 标签：.net, multithreading, .net-4.0, task-parallel-library

我有一个小程序，我正在尝试提高其性能。该程序非常简单，主要基于单个递归函数。然而，它背后的数据集非常大 - 需要大约 6,000,000,000 次递归，运行大约需要 4-6 小时，具体取决于机器。没有只处理数据的 I/O，我花了很多时间优化代码并设法找到了大约 60% 的改进。

我现在想看的是多线程代码，以便它利用主机中的所有内核。但是，我尝试使用线程、任务和 Parellel 库的位，但我一直找不到任何不会以负面方式影响性能的东西。

为了让您了解我正在查看的代码类型：

```
class Program
{
    static void Main(string[] args)
    {
        RecursiveFunction(0);
        Console.ReadLine();
    }
    static void RecursiveFunction(int currentLevel)
    {
        DoWork(currentLevel);

        if (currentLevel < 1000)
            for (int i = 0; i < (currentLevel % 6) + 1; i++)
                RecursiveFunction(currentLevel + 1);
    }
    static void DoWork(int currentLevel)
    {
        Thread.Sleep(42);
    }
} 
```

如您所见，函数的每次运行都不会花费很长时间，因此为每次递归创建线程的成本是不值得的。递归的每个分支都可以有不同的长度，而无法知道每个分支将有多长，因此在特定级别的线程不是正确的方法。

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T19:54:04.980

在树的上层使用并行性。那里的每次调用都需要几分钟到几小时，因此线程的开销非常小。

使用这些`Parallel.For*`方法并行执行循环。

在递归树的较低层使用正常的顺序循环。

以导致几千次并行循环迭代的方式选择截止级别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T12:17:37.270

您始终可以使用下面的代码链接您的任务，并让任务调度程序安排您的工作。

```
class Program
    {
        private static int MaxLevel = 1000;
        static void Main(string[] args)
        {
            Stopwatch stopwatch = new Stopwatch();
            stopwatch.Start();

            Task mainTask = ParallelRecursiveFunction(0);
            mainTask.Wait();
            stopwatch.Stop();
            Console.WriteLine("Total time of parallel execution  : {0}", stopwatch.ElapsedMilliseconds);

            Console.WriteLine("Press Enter to execute the operation sequentially");
            Console.WriteLine();
            Console.ReadLine();
            stopwatch.Reset();
            stopwatch.Start();

            SequentialRecursiveFunction(0);

            stopwatch.Stop();

            Console.WriteLine("Total time of sequential execution: {0}",stopwatch.ElapsedMilliseconds);
            Console.ReadLine();
        }

        private static void SequentialRecursiveFunction(int currentLevel)
        {
            if (currentLevel >= MaxLevel)
                return;
            DoWork(currentLevel);

            SequentialRecursiveFunction(currentLevel +1);
        }

        public static Task ParallelRecursiveFunction(int currentLevel)
        {
            if (currentLevel >= MaxLevel)
                return _completedTask;
            Task t1 = Task.Factory.StartNew(() => DoWork(currentLevel));

            Task<Task> t2 = Task.Factory.StartNew(() => ParallelRecursiveFunction(currentLevel + 1));

            return Task.Factory.ContinueWhenAll(new Task[] { t1, t2.Unwrap() }, Task.WaitAll);

        }
        private static Task _completedTask = ((Func<Task>)(() =>
        {
            var tcs = new TaskCompletionSource<object>();
            tcs.SetResult(null);
            return tcs.Task;
        }))();

        static void DoWork(int currentLevel)
        {
            Console.WriteLine("Do work at level {0}", currentLevel);

            Thread.Sleep(42);

        }
    } 
```

我测试了我的并行代码运行速度比顺序算法快大约 4 倍（= 我机器上的处理器数量）。

请让我知道你的想法。

干杯。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:44:08.883

在不了解应用程序的情况下很难发表评论。

对于相同的 level 值，递归函数被多次调用。你能收获之前运行的结果对于相同的 level 值吗？...我猜不是，您可能对副作用而不是运行结果感兴趣。

您是否尝试过使用 .NET 4.5 (VS 2012) TAP ？使用 async / await，Tasks，您可以尝试使用 Task.ContinueWith 来链接具有相同（级别 % CORE_COUNT ）的递归调用。这可能有助于平衡所有任务以及所有核心的负载。 [MSDN：链接多个任务。](http://msdn.microsoft.com/en-us/library/dd537612.aspx)

我希望你能回复对你有用的策略。

# spring - 自动完成（Jquery）焦点不绑定 Spring Propety

> ID：14162195
> 
> 赞同：1
> 
> 时间：2013-01-04T17:49:00.027
> 
> 标签：spring, jquery-ui, autocomplete, jquery-ui-autocomplete

我正在使用 Spring MVC 进行自动完成（jquery）。我已经完成了一切，数据在自动完成中正确显示，但属性不显示 onfocus 事件。每当我在 onfocus 方法中调用“ui.item.username”时，它总是显示空值。

```
$( "#city" ).autocomplete({
    minLength: 0,
    source: function( request, response ) {
        $.ajax({
            url: "person.ajax",
            dataType: "json",
            data: {
                maxRows: 6,
                startsWith: request.term
            },
            success: function( data ) {
                response( $.map( data.zipcodes, function( item) {
                    return {
                        label: item.realName + item.realName,
                        value: item.username
                    }
                }));
            }
        });
    }, 
```

直到这里它工作正常但是当我在 onfocus 方法中调用属性（在以下方法中）时，它在焦点事件（jquery）中显示我为 null

```
focus: function(event, ui) {
    alert($( event.target ).val(ui.item.ealName)); // it displays me null value at this point
},
select: function( event, ui ) {
} 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:54:29.233

您在 AJAX 请求的函数中构建的结果对象`success`用于自动完成小部件的所有方法/事件处理程序。如果您想稍后访问某个属性，则必须在构建传递给`response`函数的数据源时包含该属性：

```
success: function( data ) {
    response( $.map( data.zipcodes, function( item) {
        return {
            label: item.realName + item.realName,
            value: item.username,
            realName: item.realName // include realName
        }
    }));
} 
```

（来自评论）：

该`alert`函数*也确实*return `null`，因此如果您只想提醒该值，请使用：

```
alert(ui.item.realName) 
```

反而。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T21:30:59.110

我已经使用 spring mvc 实现了自动完成下拉。现在我的问题是，当任何用户从自动完成下拉菜单中选择/选择任何值时，我如何确定所选值是否正确？换句话说，我想确保用户是否从自动完成中选择了正确的值。因为用户可以在输入文本框中输入随机字符串并提交（从技术上讲，我还确保当用户从下拉列表中选择任何值时，提交将对用户可见，如果用户输入不正确的数据，按钮不应该被激活）。

这是一个代码

```
<script>
    $(function() {
        $( "input[name='creditCheck']" ).autocomplete({
            minLength: 2,
            source:function( request, response ) {
                $.ajax({
                    url: "creditCheck.ajax",
                    dataType: "json",
                    data: {
                        maxRows: 6,
                        startsWith: request.term
                    },
                success: function( data ) {
                    response( $.map( data.creditCheckData, function( item) {
                        return {
                            creditName: item.creditName,
                        }
                    }));
                }

                });
            }, 
```

上面的代码很好，它从服务器获取列表并显示自动完成数据。在下面的代码中，我只是切换按钮。但我也确保当用户从下拉列表中选择任何值时，提交将对用户，如果用户输入的数据不正确，则不应激活该按钮。

```
$('input[name="creditCheck"]').bind("change keyup", function () {
    if ($(this).val()!="") {
        $(this).nextAll("button[name='add']:first").removeAttr('disabled');
    } else {
        $(this).nextAll("button[name='add']:first").attr('disabled', 'disabled');
    }
}); 
```

# python - 我们真的可以在 Django 中跟踪用户的 IP 地址以进行手动阻止吗

> ID：14162198
> 
> 赞同：2
> 
> 时间：2013-01-04T17:49:12.520
> 
> 标签：python, django, ip, django-views

我正在构建一个 django 应用程序，用户在其中提交显示在主页上的数据。

由于不会有很大的流量，我个人想根据IP地址阻止数据！

现在，我需要知道用户的 IP 地址！我如何得到它？我在网上搜索了很多，特别是在这个网站上，但没有得到一个简单而正确的答案来完成这项工作。

谁能告诉我该怎么做？

是否有任何 API 东西可以帮助我阻止特定用户（可能是位置/大陆 - 我猜 GeoDjango 在那里）。

# java - OpenCSV 不会将数据库的第一行写入 CSV 文件

> ID：14162199
> 
> 赞同：3
> 
> 时间：2013-01-04T17:49:21.967
> 
> 标签：java, opencsv

我使用 Netbeans 在 Java 中创建了程序，该程序从数据库中下载数据，然后使用 OpenCSV 将其保存到 CSV 文件中。但是由于某种原因，数据库的第一行被跳过了。

```
while (rs.next()){

CSVWriter writer = new CSVWriter(new FileWriter("C:\\test2.csv"), ',');          
writer.writeAll(rs,false);
writer.flush();
writer.close();
} 
```

实际数据库数据：

```
1 Mark BMW
2 John Audi
3 Nick Fiat 
```

写入 CSV 文件的数据：

```
2 John Audi
3 Nick Fiat 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:52:11.480

我认为调用`rs.next()`是在结果集中推进一行，然后调用 writeAll 会在推进之后写入所有内容。尝试取出`while(rs.next)`代码周围的循环块，看看是否有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-14T13:53:33.493

您应该再次检查文档。它清楚地表明您不需要while循环。您只需将结果集扔给它并定义是否应返回标头。

```
writer.writeAll(yourResultSet, true); 
```

在上述情况下，标头将包含在生成的 csv 文件中

# twitter-bootstrap - 如何启用引导下拉按钮？

> ID：14162200
> 
> 赞同：4
> 
> 时间：2013-01-04T17:49:25.887
> 
> 标签：twitter-bootstrap

单击下拉按钮时不执行任何操作。在控制台中，我可以看到`.open`该类确实在单击时添加到按钮中，但它会立即被删除。

HTML：

```
<div class = 'btn-group'>
    <button class = 'btn dropdown-toggle' data-toggle = 'dropdown'>Radio Station <span class = 'caret'></span></button>
    <ul class = 'dropdown-menu'>
        <li><a href="#">WKAQ</a></li>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:07:44.137

仔细检查所有依赖项。确保您拥有所有适当的 CSS、JS 文件。

**确保您具有以下依赖项：**

```
<head>
<link href="assets/css/bootstrap.css" rel="stylesheet">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="assets/js/bootstrap-dropdown.js"></script>
</head> 
```

**你的html：**

```
<div class = 'btn-group'>
    <button class = 'btn dropdown-toggle' data-toggle = 'dropdown'>Radio Station <span class = 'caret'></span></button>
    <ul class = 'dropdown-menu'>
        <li><a href="#">WKAQ</a></li>
    </ul>
</div>​ 
```

这是您的 HTML 的一个工作示例：

[http://jsfiddle.net/JLXN7/18/](http://jsfiddle.net/JLXN7/18/)

# c# - 在 MVC3 中上传文件时遇到问题

> ID：14162204
> 
> 赞同：2
> 
> 时间：2013-01-04T17:49:29.913
> 
> 标签：c#, asp.net-mvc

我有以下图片上传代码和控制器。隐藏 ID 正在成功发布，但图像仍然为空。

表格：

```
@using(Html.BeginForm()){
<input type="hidden" name="merchandiseId" id="id" value="@ViewBag.Id"/>
<input type="file" name="image" id="image" />
<input type="submit" />
} 
```

控制器：

```
 [HttpPost]
 public ActionResult AddImage(int merchandiseId, HttpPostedFileBase image) 
```

调试和单步执行验证 image 是否为空，而商品 ID 具有正确的值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:54:12.043

您需要`enctype = "multipart/form-data"`在表单中添加。否则不会上传任何文件。

一个例子

```
@using (Html.BeginForm("UploadAction", "MyController", new { Model.Id }, FormMethod.Post, new { enctype = "multipart/form-data" }))
{
      <input type="file" name="myFile">
      <button type="submit>Upload</button>
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:52:53.477

尝试添加`new { enctype = "multipart/form-data" }`到您的表单

# git - 如何在 OpenShift 中保持文件同步？

> ID：14162209
> 
> 赞同：4
> 
> 时间：2013-01-04T17:49:40.363
> 
> 标签：git, openshift

对于 OpenShift：

我在 ~ 中创建了一个测试目录，`app-root/repo/data.` 我在本地也有 '`myapp'/data`目录。我可以用 git 推送到 OpenShift。我的测试文件上传正常，我可以用 ssh 检查。

现在我用 nano 或 vim 远程创建一个文件 --file 名为`remoteFileVim`文件存在于`repo/data`目录中。当我在本地执行 git pull 时，我看不到该文件`remoteFileVim`。

`app-root/data`我在调用中创建了第二个文件`secondVimFile`，如何将此文件拉到本地机器。我可以使用`git`吗？如果有帮助，我在 Openshift 上加载了 python 2.6、cron、mysql。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T02:48:45.510

如果您可以 ssh 进入机器，您应该可以使用`scp`.

简单地将新文件放入 Openshift 齿轮的`~/app-root/repo/`文件夹中不会导致文件被包含（签入）您的修订控制系统。通常，您应该使用`git commit`并`git push`在本地对您的应用程序进行大部分更改，然后将这些更改推送到您的 OpenShift 设备。

如果您的应用程序需要磁盘存储，或访问其他内容，例如[您希望保留在源代码之外的秘密令牌和密钥](https://openshift.redhat.com/community/blogs/secret-free-source-on-paas)- 您可以将此内容放在您的`~/app-root/data`文件夹中。此目录不受部署影响，已为您的应用程序的本地磁盘存储需求预留。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T21:06:55.487

查看此博客：[https ://community.jboss.org/people/ozizka/blog/2013/01/06/openshift--how-to-make-uploaded-files-public](https://community.jboss.org/people/ozizka/blog/2013/01/06/openshift--how-to-make-uploaded-files-public)

OpenShift 应用程序代码是使用 Git 上传的。推送后重新创建存储库目录中的任何更改。因此，将上传的文件存储在那里是行不通的。

您可以使用的唯一持久目录是 ../data。它的完整路径存储在环境变量 $OPENSHIFT_DATA_DIR 中。然而，这个目录不是公开的——所以没有 URL 指向那里。

解决方案非常简单——只需创建一个符号链接。这是 PHP 的一个示例。通过 SSH 登录到您的机器，然后运行：

```
mkdir app-root/data/photos
cd app-root/repo/php    #  php/ is the only publicly accessible directory (by default, not sure if not changeable in .htaccess).
ln -s ../../data/photos photos 
```

这使得 ../data/photos 中的内容可以在[http://myapp-myaccount.rhcloud.com/photos/](http://myapp-myaccount.rhcloud.com/photos/)上公开访问。管理文件的目录可以使用`$_ENV['OPENSHIFT_DATA_DIR']`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-26T15:12:06.537

anything you do do remotely (including SSH) happen in app-root. GIT uses app-deployments. you need to copy the files from app-root to your computer, then push them with GIT. ALSO, NEITHER /data, nor app-root scale. only app-deployments>current gets scaled.

# jquery - jquery youtube 检索描述

> ID：14162216
> 
> 赞同：0
> 
> 时间：2013-01-04T17:49:57.793
> 
> 标签：jquery, json, youtube

如何添加到此代码中，以便在 iframe 中提取描述以及标题和视频？

JavaScript：

```
$(function() {
    var htmlString = "<ul>";
    $.getJSON('http://gdata.youtube.com/feeds/users/(MY USER)/uploads?alt=json-in-script&callback=?&max-results=3', function(data) {
           $.each(data.feed.entry, function(i, item) {                                     
                   var title = item['title']['$t'];
                    var video = item['id']['$t'];
                    video_link = video.replace('http://gdata.youtube.com/feeds/videos/','http://www.youtube.com/watch?v=');
                    video_object = video.replace('http://gdata.youtube.com/feeds/videos/','http://www.youtube.com/v/');
                    htmlString +='<li><p id="video_title">' + title + '</p><object width="600" height="450"><param name="movie" value="' + video_object + '"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="' + video_object + '" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="600" height="450"><noembed>Browser does not support video</noembed></embed></object></li>';
            });
            $('#videos').html(htmlString + "</ul>");
    }); 
```

HTML：

```
<div id="videos"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:55:55.567

尝试：

```
var desc = item.media$group.media$description.$t; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:05:32.270

如果您阅读 getJson 中的 url，您会注意到该 url 需要一个用户名和一个回调方法。你两个都缺。

[http://gdata.youtube.com/feeds/users/](http://gdata.youtube.com/feeds/users/) **（我的用户）** /uploads?alt=json-in-script& **callback** =?&max-results=3

您可以在他们的指南上阅读有关如何使用 youtubes api 的更多信息 [https://developers.google.com/youtube/2.0/developers_guide_json](https://developers.google.com/youtube/2.0/developers_guide_json)

# android - 使用 Facebook Android SDK 3.0 上传照片时出现间歇性 SSL 错误

> ID：14162223
> 
> 赞同：3
> 
> 时间：2013-01-04T17:50:23.687
> 
> 标签：android, facebook, facebook-graph-api

我正在使用 Facebook Android SDK 3.0 将照片上传到我的相册。一切正常，但有时第一次上传失败并出现一些意外的 SSL 错误。

[请参阅Request.java](https://github.com/facebook/facebook-android-sdk/blob/master/facebook/src/com/facebook/Request.java)`toHttpConnection`中的函数。

```
try {
        connection = createConnection(url);

        serializeToUrlConnection(requests, connection);
    } catch (IOException e) {
        // THIS IS WHERE THE ERROR ORIGINATES FROM!
        throw new FacebookException("could not construct request body", e);
    } catch (JSONException e) {
        throw new FacebookException("could not construct request body", e);
    } 
```

将鼠标悬停`e`在 Eclipse 中会显示以下信息：

*javax.net.ssl.SSLException：写入错误：ssl=0x4f033008：系统调用期间的 I/O 错误，管道损坏 javax.net.ssl.SSLException：写入错误：ssl=0x4f033008：系统调用期间的 I/O 错误，管道损坏Write error: ssl=0x4f033008: I/O error during system call, Broken pipe [1277468208, 0, 1279934152, 48, 1280860304, 26, 1280860480, 58, 1280859576, 11, 1280859696, 4, 1277492792, 1, 1280859640, 7, 1280233152, 169, 1280233264, 36, 1280230744, 6, 1280236632, 0, 1280236576, 0, 1280238568, 6, 1280238512, 2, 1278731744, 21, 1279835640, 23, 1278097880, 2, 1279841920, 28, 1279843376, 2, 1277300032, 6]空*

这是 SDK 中的错误吗？有没有其他人遇到过这个？更重要的是，我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T23:42:42.290

我*几乎*已经准备好接受我之前的（删除的）答案，直到我看到这篇文章：http: [//vikaskanani.wordpress.com/2011/01/11/android-upload-image-or-file-using-http -post-multi-part/](http://vikaskanani.wordpress.com/2011/01/11/android-upload-image-or-file-using-http-post-multi-part/)

我决定试一试，它似乎奏效了！这是我的代码：

```
for (Bitmap b : bitmaps) {
    // id is just a string
    String response = executeUpload(b, id);

    // do something with the response
}

private String executeUpload(Bitmap b, String id) throws MalformedURLException, IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    b.compress(CompressFormat.PNG, 100, baos);
    byte[] data = baos.toByteArray();

    HttpPost postRequest = new HttpPost("https://graph.facebook.com/me/photos");
    HttpParams params = new BasicHttpParams();
    HttpConnectionParams.setConnectionTimeout(params, 3000);
    HttpClient httpClient = new DefaultHttpClient();
    httpClient.setHttpRequestRetryHandler(new DefaultHttpRequestRetryHandler(2, true));

    ByteArrayBody bab = new ByteArrayBody(data, id + ".png");
    MultipartEntity reqEntity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
    reqEntity.addPart("access_token", new StringBody(activeFacebookAccessToken));
    reqEntity.addPart("message", new StringBody(""));
    reqEntity.addPart("picture", bab);
    postRequest.setEntity(reqEntity);
    HttpResponse response = httpClient.execute(postRequest);
    BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), "UTF-8"));
    String s;
    StringBuilder builder = new StringBuilder();
    while ((s = reader.readLine()) != null) {
        builder = builder.append(s);
    }

    return builder.toString();
} 
```

如上面链接中所述，您必须安装最新版本`HttpClient`（位于[http://hc.apache.org/downloads.cgi](http://hc.apache.org/downloads.cgi)）。

另一个需要注意的重要事项是，Facebook 在任一维度上支持的最大图像尺寸为 720 像素。在我的代码中，我在上传之前将位图缩放到该大小限制内，这大大提高了性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-29T06:49:15.517

@i33t：我遇到了与 IoException 和 FacebookException 相同的问题。在我的情况下，问题在于在 UI 线程上运行网络操作。

如果你真的打印堆栈跟踪，你会得到这个。

**解决方法：**一定要在WorkerThread上执行这个**操作**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-21T10:06:43.483

我正在解决这个问题。我的 Facebook SDK 版本是 3.5.2。而且这个问题只能在三星Note2 4.3 os版本上重现。

这个问题表现得很奇怪，因为它表现为成功一次，失败一次然后成功一次，失败一次..

原因异常消息如下：

```
javax.net.ssl.SSLHandshakeException: javax.net.ssl.SSLProtocolException: SSL handshake aborted: ssl=0x59b399c8: Failure in SSL library, usually a protocol error
error:14077410:SSL routines:SSL23_GET_SERVER_HELLO:sslv3 alert handshake failure (external/openssl/ssl/s23_clnt.c:741 0x5d887c58:0x00000000) 
```

# java - 从密码字段中获取文本

> ID：14162225
> 
> 赞同：5
> 
> 时间：2013-01-04T17:50:29.583
> 
> 标签：java

您好我正在尝试在 java netbeans IDE 中创建一个登录表单。我的目标是创建多个用户 ID 及其各自的密码。我已将文本字段提供给 userID 和 passwordField 以获取密码以获取值，但问题是我想从密码字段中获取文本，但我无法获取它显示一些错误我认为语法有问题我的研究是如下有什么解决办法吗？需要你的帮助

```
private void lb_loginMouseClicked(java.awt.event.MouseEvent evt) {                                      
       DBUtil util = new DBUtil();
       String value1=tb_uid.getText();
       String value2=tb_pwd.getPassword();
       String user1="";
       String pass1="";
       try {

            Connection con = util.getConnection();
            PreparedStatement stmt = con.prepareStatement("SELECT * FROM login where username='"+value1+"' && password='"+value2+"'");
            ResultSet res = stmt.executeQuery();
            res = stmt.executeQuery();
            while (res.next()) {
                user1 = res.getString("username");
                pass1 = res.getString("password");
            }
            if (value1.equals(user1) && value2.equals(pass1)) {
            JOptionPane.showMessageDialog(this,"correct");
            }
            else{
            JOptionPane.showMessageDialog(this,"Incorrect login or password","Error",JOptionPane.ERROR_MESSAGE);
            }
            JOptionPane.showMessageDialog(null, "COMMITED SUCCESSFULLY!");
        } catch (Exception ex) {
            JOptionPane.showMessageDialog(null, ex.getMessage());

        }

    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-12-20T18:02:52.017

```
String pwd = new String(jPasswordField1.getPassword()); 
```

* * *

**选项1：**

```
jTextField1.setText(""+pwd); 
```

**选项 2：**

```
System.out.println(""+pwd); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-12-22T08:56:07.277

使用此代码：

```
String password = String.valueOf(jPasswordField.getPassword()); 
```

是加密的`JPasswordField`，但如果你使用`String.valueOf`它将把 Char 转换为 String。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-04T17:55:40.477

`value2`是 char 数组，因此进行`String`连接将导致`String`数组的表示，而不是`String`内容本身最终出现在 SQL 中。你可以更换

```
PreparedStatement stmt = con.prepareStatement("SELECT * FROM login where username='"+value1+"' && password='"+value2+"'"); 
```

和

```
PreparedStatement stmt = con.prepareStatement("SELECT * FROM login where username='"+value1+"' AND password='" + new String(value2) + "'"); 
```

相似地

```
if (value1.equals(user1) && value2.equals(pass1)) { 
```

需要是

```
if (value1.equals(user1) && pass1.equals(new String(value2)) { 
```

但是，最好使用`PreparedStatement`占位符来防止[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)攻击：

```
PreparedStatement stmt = con.prepareStatement("SELECT * FROM login where username=? AND password=?);
stmt.setString(1, value1);
stmt.setString(2, new String(value2)); 
```

注意：这不是密码查找的安全方法，[散列](https://exyr.org/2011/hashing-passwords/)比较会*相对*更安全。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T17:55:14.173

来自[http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#equals%28java.lang.Object%29](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#equals%28java.lang.Object%29)：

> 等于
> 
> 公共布尔等于（对象anObject）
> 
> 将此字符串与指定对象进行比较。当且仅当参数不为 null 并且是表示与此对象相同的字符序列的 String 对象时，结果才为真。

你的代码：

```
char[] value2=tb_pwd.getPassword();
...
String pass1="";
...
...&& value2.equals(pass1)... 
```

似乎您想将 char 数组转换为 String 然后重试转换。如果您仍然收到错误，请将其与相关输入一起发布，以便我们查看收到的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T20:46:44.140

您想将您的转换`char[]`为`String`. 当您调用 tb_pwd.getPassword() 时，将返回一个 char[]（字符数组）。如果要比较此密码，则必须将其转换为字符串，为此您可以使用以下方法：

```
String final_pass = "";
for(char x : passwordAsChar[]) {
     final_pass += x;
} 
```

至于比较数据库中的密码，您永远不应该以未加密的纯文本形式存储它们。您可以在数据库中存储一个 MD5 字符串，并将用户输入的密码转换为字符串，然后在其上调用以下方法。然后将返回的字符串与数据库中的字符串进行比较。如果它们匹配，则用户输入了正确的密码。

例子：

```
char[] pass = tb_pwd.getPassword();
String final_pass = "";
for (char x : pass) {
    final_pass += x;
}

String md5_encrypted_pass_userInput = encrypt(final_pass);
if (md5_encrypted_pass.equals(pass1)) { /* pass1 = the password from the database */
    // Correct password
} 
```

用于将字符串加密为 MD5 的方法是：

```
public static final String encrypt(String md5) {
    try {
        java.security.MessageDigest md = java.security.MessageDigest.getInstance("MD5");
        byte[] array = md.digest(md5.getBytes());
        StringBuffer sb = new StringBuffer();
        for (int i = 0; i < array.length; ++i) {
          sb.append(Integer.toHexString((array[i] & 0xFF) | 0x100).substring(1,3));
       }
        return sb.toString();
    } catch (java.security.NoSuchAlgorithmException e) {}
    return null;
} 
```

# sharepoint - 在 sharepoint 2010 中搜索 webpart

> ID：14162229
> 
> 赞同：0
> 
> 时间：2013-01-04T17:51:05.777
> 
> 标签：sharepoint, sharepoint-2010

我创建了一个包含大约 20 列的文档库，用于存储元数据。客户端希望使用基于两个值过滤数据的工具来搜索此元数据。例如，我们有两个日期列（生效日期和终止日期），他们想要查看的结果是具有生效日期和终止日期之间值的文件。

是否有任何开箱即用的解决方案可以用于此，或者我应该构建自定义 Web 部件。如果是这样，有人可以指导我完成....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T05:35:36.990

创建您的文档库，然后在“文档库设置”中单击“元数据导航设置”。

这应该给你你想要的。您可以指定要筛选数据的列。您可以堆叠过滤器，默认情况下它们显示在页面左侧，供用户交互。

# objective-c - iOS 上自动续订订阅所需的服务器

> ID：14162232
> 
> 赞同：3
> 
> 时间：2013-01-04T17:51:22.517
> 
> 标签：objective-c, ios, in-app-purchase, storekit, auto-renewing

有人可以向我解释 iOS 上的自动更新订阅需要什么吗？

我对它是否需要服务器端组件（由我自己构建）感到困惑？还是可以在应用程序内处理所有事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2017-06-29T17:11:43.090

对于最基本的设置，答案是否定的，您不需要自己的后端。苹果会处理这笔钱，您可以在应用程序中从苹果获取交易状态，并根据该信息解锁或锁定用户支付的任何费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:31:50.710

实际上，即使有图片和模式，苹果文档也完全涵盖了这个问题

[https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/Subscriptions.html](https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/Subscriptions.html)

简要地：

1）如果你想让你的订阅更灵活，你将需要服务器端（例如：在应用程序位于应用商店时添加更多子ns）在这种情况下，你的应用程序从服务器获取订阅列表

2）您可以通过将收到的收据发送到Apple-server，使用您的服务器检查交易的正确性，并在只有收据有效的情况下向用户提供内容。

# java - Java 2D游戏、游戏地图和矩形移动

> ID：14162234
> 
> 赞同：0
> 
> 时间：2013-01-04T17:51:30.053
> 
> 标签：java, collision-detection, rectangles

**游戏**

我编写了一个简单的 Java 游戏，其中有一个玩家在 2D 地图上的俯视图，它随着键盘箭头输入（上、下、左、右）移动，我的 Play 类包含我的所有游戏代码在一些方法中，init 保存初始游戏选项，例如游戏开始时玩家应该面对的方向，render 将所有内容绘制到屏幕上，例如实际玩家和地图，update 处理键盘输入和移动玩家，当我说移动玩家时，在这个游戏中实际上是移动地图，因为地图太大了，我需要玩家能够在地图周围走动，屏幕跟随它，这是最简单的做法那就是让玩家保持静止并移动地图，从而产生玩家实际上正在移动的错觉。

**问题**

除了地图，一切都很好，地图是一个大的 2D 图像，上面有障碍物，比如房子，此时玩家只是穿过房子和其他障碍物（现在让我们只专注于房子），我需要游戏阻止玩家穿过房子。所以我打算使用简单的矩形碰撞检测并在发生碰撞时简单地改变玩家的方向，所以我尝试制作两个矩形但是出现了问题，当我使用渲染方法在屏幕上绘制矩形时（上面的一个玩家（rectOne），房子上方的另一个（rectTwo））它没有完全按计划进行，在玩游戏时，当我尝试移动一个矩形时，另一个跟随它，这是一个问题，因为应该怎么做两个矩形的碰撞同时移动。

**编码**

显示的代码是包含所有游戏代码的 Play 类的简化版本：

```
 imports are here
    public class Play extends BasicGameState{
    Animation bucky, movingUp, movingDown, movingLeft, movingRight;
    Image worldMap;
    int[] duration = {200, 200};//how long frame stays up for
    float buckyPositionX = 0;
    float buckyPositionY = 0;
    float shiftX = buckyPositionX + 320;//keeps user in the middle of the screem
    float shiftY = buckyPositionY + 160;//the numbers are half of the screen size
    java.awt.geom.Rectangle2D.Float rectOne = new Rectangle2D.Float(shiftX, shiftY,90,90);
    java.awt.geom.Rectangle2D.Float rectTwo = new Rectangle2D.Float(500 + buckyPositionX, 330 + buckyPositionY, 210, 150);
    public Play(int state){
    }   
    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException{
          worldMap = new Image("res/world.png");
          Image[] walkUp = {new Image("res/b.png"), new Image("res/b.png")}; //these are the images to be used in the "walkUp" animation
          Image[] walkDown = {new Image("res/f.png"), new Image("res/f.png")};
          Image[] walkLeft = {new Image("res/l.png"), new Image("res/l.png")};
          Image[] walkRight = {new Image("res/r.png"), new Image("res/r.png")};
    movingUp = new Animation(walkUp, duration, false);
    movingDown = new Animation(walkDown, duration, false);  
    movingLeft = new Animation(walkLeft, duration, false);  
    movingRight = new Animation(walkRight, duration, false);
    bucky = movingDown;//facing screen initially on startup
    }
    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException{
    worldMap.draw(buckyPositionX, buckyPositionY);//position 0,0
    bucky.draw(shiftX, shiftY);//makes him appear at center of map
    g.fillRect((float)rectOne.getX(), (float)rectOne.getY(), (float)rectOne.getWidth(), (float)rectOne.getHeight());
    g.fillRect((float)rectTwo.getX(), (float)rectTwo.getY(), (float)rectTwo.getWidth(), (float)rectTwo.getHeight());
}
    public void update(GameContainer gc, StateBasedGame sbg, int delta)throws SlickException{
    Input input = gc.getInput();
    //up
    if(input.isKeyDown(Input.KEY_UP)){
        bucky = movingUp;//changes the image to his back
        buckyPositionY += 2;;//increase the Y coordinates of bucky (move him up)
        if(buckyPositionY>162){//if I reach the top 
            buckyPositionY -= 2;//stops any further movement in that direction
        }
    }
    //down
    if(input.isKeyDown(Input.KEY_DOWN)){
        bucky = movingDown;
        buckyPositionY -= 2;
        if(buckyPositionY<-550){
            buckyPositionY += 2;//basically change the direction if + make -
    }}
    //left
    if(input.isKeyDown(Input.KEY_LEFT)){
        bucky = movingLeft;
        buckyPositionX += 2;
        if(buckyPositionX>324){
            buckyPositionX -= 2;//delta * .1f
    }}
    //right
    if(input.isKeyDown(Input.KEY_RIGHT)){
        bucky = movingRight;
        buckyPositionX -= 2;
        if(buckyPositionX<-776){
            buckyPositionX += 2;
    }}}   
    public int getID(){
        return 1;
    }} 
```

代码显示两个矩形（rectOne 和 rectTwo） rectOne 在玩家的顶部，而 rectTwo 应该在地图上的房子顶部，这不会发生，两个矩形一起移动，记住，我提到地图正在移动并且玩家保持静止，地图设置为坐标 buckyPositionX 和 buckyPositionY，玩家设置为 shiftX 和 shiftY，这是屏幕的中心，如果需要，可以将其替换为常量，因为玩家不移动，如果update 方法下的语句修改了 buckyPositionX 和 buckyPositonY ，这意味着它们移动了地图，因此 rectTwo（这是房子）也必须移动，而 rectOne（玩家矩形）保持不动，这就是我使用变量 buckyPositionX 和 buckyPoitionY 的原因对于 rectTwo，但是我的问题仍然存在，所以一定有问题。

///////////编辑 - 删除段落以使帖子更短/////////////

先感谢您。

# data-structures - 在最大情况下，每个左节点都大于每个右节点的树数据结构？

> ID：14162235
> 
> 赞同：0
> 
> 时间：2013-01-04T17:51:32.947
> 
> 标签：data-structures, tree, heap

这样的树是否存在并有名字，还是只是我的想象？我曾经认为堆具有此属性，但似乎唯一的要求是子级小于父级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T17:59:01.403

正好相反，但您可能会想到[二叉搜索树](http://en.wikipedia.org/wiki/Binary_search_tree)，它具有以下属性：

> *   节点的左子树仅包含键小于节点键的节点。
> *   节点的右子树只包含键大于节点键的节点。
> *   左右子树也必须是二叉搜索树。
> *   不能有重复的节点。

所以保证每个左节点都小于每个右节点。您可以通过从根节点向右走来找到最大值，直到您无法再向右走为止。

# jquery - 防止触发重叠 HTML 元素的事件

> ID：14162237
> 
> 赞同：13
> 
> 时间：2013-01-04T17:51:34.687
> 
> 标签：jquery, events, delegates

所以，我有两个元素，一个嵌套在另一个元素中

```
<div id="outer">
    <div id="inner">
         <p>Lorem Ipsum</p>
    </div>
</div> 
```

外部容器比内部容器大，影响模态覆盖布局。我想在外部的暴露表面上注册一个单击事件，这将导致两者都被解除，但如果您单击内部 div，我不希望这种情况发生。

我正在使用 jQuery 委托/stopPropagation，并尝试询问元素以确保它是外部 div，但无济于事 - 它仍然接收外部事件。我正在考虑在内部 div 之外的命中区域手动启动，但我想知道是否有更优雅的选择。

编辑：

这里发布了几个很好的解决方案 - 非常感谢您的反馈！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-04T17:54:57.020

```
$("#inner").click(function(event){
  event.stopPropagation();
  // do something
}); 
```

这是一个小提琴：http: [//jsfiddle.net/sajjansarkar/fA2sd/1/](http://jsfiddle.net/sajjansarkar/fA2sd/1/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-04T17:54:22.173

```
$('#outer').on('click', function (e) {
    if ( e.target != this) return;
    // run your code here...
}); 
```

这是小提琴：http: [//jsfiddle.net/9sLCx/](http://jsfiddle.net/9sLCx/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T18:04:26.807

事件对象作为两个属性将帮助您完成此任务：

event.currentTarget 标识事件的当前目标，因为事件遍历 DOM。它始终指代事件处理程序已附加到的元素，而不是 event.target 标识发生事件的元素。外部 div 的事件通知将传递两次，首先在捕获阶段，然后在冒泡阶段，中间如果您在内部 div 中实例化一个处理程序，它将被通知。您可以在需要时停止传播。

[http://fiddle.jshell.net/hmariod/dvV4E/](http://fiddle.jshell.net/hmariod/dvV4E/)

```
document.getElementById("outer").addEventListener('click',etvFn,true);
document.getElementById("outer").addEventListener('click',etvFn,false);
document.getElementById("inner").addEventListener('click',etvFn,true);
document.getElementById("inner").addEventListener('click',etvFn,false);
document.getElementById("innerP").addEventListener('click',etvFn);

function etvFn(evt){
    var phase;
    if(evt.eventPhase === 1){
        phase = "Capture";
    }else if(evt.eventPhase === 2){
        phase = "Target";
    }else{
        phase = "Bubbling";
    }
    alert("Target:" + evt.target.id + "\nCurrent Target:" + evt.currentTarget.id + "\nPhase:" + phase);
}​ 
```

# actionscript-3 - 这是在 AS3 中做的“好习惯”（关于使用盛大事件）吗？

> ID：14162239
> 
> 赞同：1
> 
> 时间：2013-01-04T17:51:40.277
> 
> 标签：actionscript-3

首先，我要感谢您花时间阅读我的问题。所以，我制作了一个小 Flash 游戏（不能真正称其为游戏），无论如何，我正在检查 2 个对象是否相互碰撞。所以总结一下这里的代码

```
public function loop(e:Event):void
{
    y += vx;
    if(y > stageRef.stageHeight || y < 0)
        removeSelf();
    if(hitTestObject(target.hit))
    {
        removeSelf();
        stageRef.dispatchEvent(new GameOverEvent(GameOverEvent.DEAD)); // <--
        stageRef.addChild(new SmallImplosion(stageRef, x, y));
    }
} 
```

因此，当它们发生碰撞时，一个对象会调度一个事件，代码没有问题，它可以工作，但我想知道以这种方式处理它是否好。stageRef 是对阶段的引用，两个类都有它。

而我的其他类捕获该事件并触发一个函数，如下所示：

```
stageRef.addEventListener(GameOverEvent.DEAD, takeHit, false, 0, true); 
```

问题是，这是处理它的好方法吗？先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:07:15.353

在实现[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)时，每个参与的对象都有明确的作用：一个是主体，是发生动作的对象，另一个是观察者，监听主体上的事件。在 Flash 中，任何对象都可以是观察者，因为您将处理函数传递给 subscribe-method。但是，主题实现[IEventDispatcher](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/IEventDispatcher.html)并提供订阅主题的必要方法。还有标准实现[EventDispatcher](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/EventDispatcher.html)，它已经实现了必要的方法（许多类型是它的子类型）。

现在回到你的问题；您实际上是在引入第三方，即广播事件的舞台。不是将主题本地的事件分发到主题本身，而是将它们分发到全局舞台上，并且所有观察者都必须收听舞台而不是主题本身。

这通常不是您应该做的。每个主题 (IEventDispatcher) 应该只调度它自己的事件。就像您从被点击的按钮收到点击事件一样，您也会从触发它的对象收到 GameOverEvent。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:01:07.457

从名字`GameOverEvent`上，我相信暗示了一点意义。因为在比赛结束时有很多事情要做，所以我觉得在你的舞台上听这样的事件是合适的。

但是，不要使用这种技术来处理任何较小的系统。例如，如果碰撞只对玩家造成了一些伤害（我不知道这在你的游戏环境中是否有意义，但在这里和我一起滚动）那么最好让类检查碰撞和处理健康的类直接相互交互，而不是触发这些“*大事件*”。

# r - 将R中的重复测量数据重塑为长

> ID：14162241
> 
> 赞同：0
> 
> 时间：2013-01-04T17:51:53.110
> 
> 标签：r, reshape

我需要将每年对个人重复测量的“宽”数据框转换为“长”格式，以便我可以像 lm(y_year2 ~ x_year1) 和 lm(z_year2 ~ y_year2) 一样对其进行建模

我可以“手动”将它变成我想要的格式，但无法弄清楚如何`melt`/`dcast`它变成我想要的形状

下面我用一些模拟数据说明了我正在做什么

宽格式的数据框是这样的，每行一个

```
ID  SITE    L_03  M_03  R_03  L_04  M_04  R_04  L_05  M_05  R_05
1   forest    X     a   YES     Y     b   YES     Z     c   NO
2   forest    ... 
```

我想要 LONG 格式：

```
ID  SITE    L_year1  L_year2  M_year1  M_year2  R_year1   R_year2   year1  year2
1   forest      Z       Y       a         b       YES       YES       03    04
1   forest      Y       Z       b         c       YES       NO        04    05
2   forest      ...  
2   forest      ... 
```

**一些模拟数据：** L 和 M 是数字（长度和质量），R 是是/否因子（生殖），3 年重复测量（2003-2005）

```
 ID <- 1:10; SITE <- c(rep("forest",3), rep("swamp",3), rep("field",4))
    L_03 <- round(rnorm(10, 100, 1),3) ; M_03 <- round((10 + L_03*0.25 + rnorm(10, 0, 1)), 3)
    R_03 <- sample(c("Yes", "No"), 10, replace = TRUE) ; L_04 <- round((2 + L_03*1.25 + rnorm(10, 1,10)), 3) 
    M_04 <- round((10 + L_04*0.25 + rnorm(10, 0,10)), 3) ;R_04 <- sample(c("Yes", "No"), 10, replace = TRUE)
    L_05 <- round((2 + L_04*1.25 + rnorm(10, 1,10)),3) ; M_05 <- round((10 + L_05*0.25 + abs(rnorm(10, 0,10))),3)
    R_05 <- sample(c("Yes", "No"), 10, replace = TRUE); rm_data <- data.frame(ID, SITE, L_03, M_03, R_03, L_04, M_04,R_04, L_05, M_05, R_05) 
```

**方法 1：**我使用第一个“手动”进行临时重塑`rbind` ，使用 2003 和 2004 数据制作子集，然后使用 2004 和 2005 制作另一个

```
rm_data1 <- cbind(rm_data[ ,c(1,2,3:5, 6:8)], rep(2003,10), rep(2004,10))
rm_data2 <- cbind(rm_data[ ,c(1,2,6:8, 9:11)],rep(2004,10), rep(2005,10))
names(rm_data1)[3:10]<- c("L1", "M1", "R1", "L2", "M2", "R2", "yr1", "yr2")
names(rm_data2)[3:10]<- c("L1", "M1", "R1", "L2", "M2", "R2", "yr1", "yr2")
data3 <- rbind(rm_data1, rm_data2) 
```

**方法 2?：**我想用`reshape`/ `melt`/来做这个`dcast`。我不知道我是否可以`dcast`直接在宽数据帧上使用，或者一旦我使用`melt`它，如何将`dcast`其转换为我想要的格式。

```
library(reshape2)
rm_measure_vars <- c("L_03", "M_03", "R_03", "L_04", "M_04","R_04", "L_05", "M_05", "R_05")
rm_data_melt <-  melt(data = rm_data, id.vars = c("ID", "SITE"), measure.vars = rm_measure_vars, value.name = "data") 
```

我在融化的数据中添加了测量年份的代号

```
obs_year <- gsub("(.*)([0-9]{2})", "\\2", rm_data_melt$variable)
rm_data_melt <- cbind(rm_data_melt, obs_year) 
```

`dcast`看起来应该是这样的，但这还不是我需要的

```
dcast(data = rm_data_melt, formula = ID + SITE + obs_year ~ variable)
   ID   SITE obs_year    L_03   M_03 R_03    L_04   M_04 R_04    L_05   M_05 R_05
1   1 forest       03   99.96 35.364   No    <NA>   <NA> <NA>    <NA>   <NA> <NA>
2   1 forest       04    <NA>   <NA> <NA> 129.595 47.256  Yes    <NA>   <NA> <NA>
3   1 forest       05    <NA>   <NA> <NA>    <NA>   <NA> <NA> 177.607 58.204  Yes 
```

任何建议将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T20:21:52.480

我试了一下。这`reshape`是最容易的部分。其余的需要一些半手动处理，我相信。以下应该给你你想要的。

```
output <- reshape(rm_data, idvar=c("ID","SITE"), varying=3:11, 
                v.names=c("L_","M_","R_"), direction="long")
output$time <- output$time + 2    # to get the year
names(output)[3:6] <- c("year1", "L_year1", "M_year1", "R_year1")
output$year2 <- output$year1+1
rownames(output) <- c()

sapply(output[,4:6], function(x) {
  i <- ncol(output)+1
  output[,i] <<- x[c(2:length(x), NA)]
  names(output)[i] <<- sub("1","2",names(output)[i-4])
})

output <- output[,c(1,2,4,8,5,9,6,10,3,7)]    # rearrange columns as necessary 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-27T08:31:16.770

安装 onetree 软件包。devtools::install_github("yikeshu0611/onetree") 库(onetree)

# 3个步骤，使用onetree包

## 1 步

将数据重塑为长数据

```
long1=reshape_toLong(data = rm_data,
               id = "ID",
               j = "year",
               value.var.prefix = c("L_","M_","R_")) 
```

## 第二步

放弃5年，选择3年和4年；重复年份为 y

```
long2=long1[long1$year!=5,]
long2$y=long2$year 
```

按年份将 long2 重塑为广泛的数据

```
wide1=reshape_toWide(data = long2,
               id = "ID",
               j = "year",
               value.var.prefix = c("L_","M_","R_","y")
               ) 
```

现在，我们获得了第 3 年和第 4 年的数据，即您的目的数据中的第 1 年和第 2 年。所以我们在 colnames 中用 1 替换 3，用 2 替换 4。

```
colnames(wide1)=gsub(3,1,colnames(wide1))
colnames(wide1)=gsub(4,2,colnames(wide1)) 
```

## 第三步

再次执行第 2 步，这一次，我们放弃第 3 年，我们选择第 4 年和第 5 年。

```
long3=long1[long1$year!=3,]
long3$y=long3$year
wide2=reshape_toWide(data = long3,
                     id = "ID",
                     j = "year",
                     value.var.prefix = c("L_","M_","R_","y")
)
colnames(wide2)=gsub(4,1,colnames(wide2))
colnames(wide2)=gsub(5,2,colnames(wide2)) 
```

# 最后的

rbind宽1和宽2

```
data=rbind(wide1,wide2)
data[order(data$ID),]

   ID   SITE     L_1    M_1 R_1 y1     L_2    M_2 R_2 y2
1   1 forest 100.181 34.279 Yes  3  131.88 50.953  No  4
11  1 forest  131.88 50.953  No  4 158.642 50.255  No  5
2   2 forest 101.645 36.667 Yes  3 123.923 43.915  No  4
12  2 forest 123.923 43.915  No  4  163.81 55.979  No  5
3   3 forest  98.961 33.901 Yes  3 125.928 41.611  No  4
13  3 forest 125.928 41.611  No  4 165.865 57.417  No  5
4   4  swamp 100.807 36.254  No  3 117.856 48.634 Yes  4
14  4  swamp 117.856 48.634 Yes  4 137.487 50.945  No  5
5   5  swamp   99.75 33.881  No  3 132.419 50.563 Yes  4
15  5  swamp 132.419 50.563 Yes  4 168.461 58.373 Yes  5
6   6  swamp 100.463 34.859 Yes  3 122.884 40.301  No  4
16  6  swamp 122.884 40.301  No  4  152.85 57.491  No  5
7   7  field 102.527 34.521  No  3 123.363 35.935  No  4
17  7  field 123.363 35.935  No  4     168 55.692  No  5
8   8  field  99.957 35.236 Yes  3 139.083 34.793  No  4
18  8  field 139.083 34.793  No  4 177.648 62.638 Yes  5
9   9  field  100.16 36.454  No  3 135.468 45.115 Yes  4
19  9  field 135.468 45.115 Yes  4 180.666 57.233  No  5
10 10  field 100.037 35.612  No  3 139.165  46.95  No  4
20 10  field 139.165  46.95  No  4 169.333 55.782 Yes  5 
```

# xslt - 这个 XSLT 片段可以更简洁吗？

> ID：14162242
> 
> 赞同：2
> 
> 时间：2013-01-04T17:51:56.647
> 
> 标签：xslt, xpath, xslt-1.0

在下面的代码片段中，我有 3 个 for-each，但在我看来，它们应该能够合并为一个。它按原样工作，但我想知道是否有人知道更优雅的编写方式？

```
 <xsl:for-each select="/essentials/webservice">
        <xsl:for-each select="document(@filename)/productSearchResponse/products/product">
            <xsl:sort select="producingRegion" order="ascending"/> 
            <xsl:for-each select="producingRegion[not(preceding::producingRegion=.)]">
                <xsl:value-of select="."/>
                <br/>
            </xsl:for-each> 
        </xsl:for-each>
    </xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:58:22.557

在不知道输入 XML 的预期结果和结构的情况下很难给出答案，但我相信这应该可行。

```
<xsl:for-each select="/essentials/webservice">
    <xsl:for-each select="document(@filename)/productSearchResponse/products/product/producingRegion[not(preceding::producingRegion=.)]">
            <xsl:value-of select="."/>
            <br/>
    </xsl:for-each>
</xsl:for-each> 
```

编辑：我刚刚注意到 document(@filename) 是一个函数调用，而不是一个节点测试。在那种情况下，我认为你需要两个`for-each`es。

您可以通过在 XPath 表达式中使用双斜杠来使其更简洁，尽管我倾向于认为这不是一个很好的做法：

```
<xsl:for-each select="/essentials/webservice">
    <xsl:for-each select="document(@filename)//producingRegion[not(preceding::producingRegion=.)]">
            <xsl:value-of select="."/>
            <br/>
    </xsl:for-each>
</xsl:for-each> 
```

# jquery - jQuery Trent Richardson 的 DateTimePicker：使用类选择器将选择器设置为文本框中的值

> ID：14162243
> 
> 赞同：0
> 
> 时间：2013-01-04T17:51:57.423
> 
> 标签：jquery, asp.net, jquery-ui

我在 ASP.NET gridview 的模板字段中有几个文本框，我想使用[日期时间选择器](http://trentrichardson.com/examples/timepicker/)（日期和时间部分）。由于 ASP.NET 生成控件的前端 ID 的方式，最简单的选择方法文本框是按类别的。让文本框执行日期时间选择器并不难：

问题是，每次打开 datetimepicker 时，它都会从文本框中清除预填充的值，并且 datetimepicker 不会默认为文本框中存在的 datetime。如果有一个文本框和/或我事先有 ClientID，我可以相对容易地设置 defaultValue。但是文本框的实际 HTML ClientID 不以 asp id 结尾，因此我不能使用 endwith 函数 ( `ContentPlaceHolder1_GridView1_tbStartDate_0`) 并且我不能使用`<%# tbStartDate.ClientID %>`，因为文本框仅在按下更新按钮后生成。但我不确定如何使用 jQuery 类选择器来处理它。

为了方便起见，我让 ASP.NET 将日期时间格式化为 datetimepicker 使用的默认格式。

简化页面如下：

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
   <script src="Scripts/jquery-1.7.2.js" type="text/javascript"></script>
   <script src="Scripts/jquery-ui-1.9.1.custom.min.js" type="text/javascript"></script>
   <script src="Scripts/jquery-ui-timepicker-addon.js" type="text/javascript"></script>
   <link rel="stylesheet" media="all" type="text/css" href="Styles/jquery-ui-timepicker-addon.css">
   <link rel="stylesheet" media="all" type="text/css" href="http://code.jquery.com/ui/1.9.1/themes/smoothness/jquery-ui.css">
</Content>

<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">

   jQuery(document).ready(function () {
        $(".dateTimePickerClass").datetimepicker();
    });

   <asp:GridView ID="gridview1" runat="server" DataSourceID="SQLDataSource1">
      <asp:CommandField ShowEditButton="True" />
      <asp:TemplateField HeaderText="Start Date" SortExpression="startDate">
         <ItemTemplate>
            <asp:Label ID="Label2" runat="server" Text='<%# Bind("startDate") %>'></asp:Label>
         </ItemTemplate>
         <EditItemTemplate>
            <asp:TextBox CssClass="dateTimePickerClass" ID="tbStartDate" runat="server"
                 Text='<%# Bind("startDate", "{0:MM/dd/yyyy H:mm}") %>'></asp:TextBox>
         </EditItemTemplate>
      </asp:TemplateField>
      <asp:TemplateField HeaderText="End Date" SortExpression="endDate">
         <ItemTemplate>
            <asp:Label ID="Label2" runat="server" Text='<%# Bind("endDate") %>'></asp:Label>
         </ItemTemplate>
         <EditItemTemplate>
            <asp:TextBox CssClass="dateTimePickerClass" ID="endDate" runat="server"
                 Text='<%# Bind("endDate", "{0:MM/dd/yyyy H:mm}") %>'></asp:TextBox>
         </EditItemTemplate>
      </asp:TemplateField>
   </GridView>
   <asp:SQLDataSource id="SQLDataSource1" runat="server" />
</Content> 
```

生成的html：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Example</title>
    <script src="Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery-ui-1.9.1.custom.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery-ui-timepicker-addon.js" type="text/javascript"></script>
    <link rel="stylesheet" media="all" type="text/css" href="Styles/jquery-ui-timepicker-addon.css">
    <link rel="stylesheet" media="all" type="text/css" href="http://code.jquery.com/ui/1.9.1/themes/smoothness/jquery-ui.css">
</head>
<body>
<form id="form1">
    <script type="text/javascript">
        jQuery(document).ready(function () {
            $(".dateTimePickerClass").datetimepicker({ onClose: function (value) {$('input.datetime').val(value);}});
            });
    </script>

    <div>
        <table cellspacing="0" rules="all" border="1" id="ContentPlaceHolder1_gvHolds" style="border-collapse:collapse;">
            <tr>
                <th scope="col">&nbsp;</th><th scope="col">Start Date</th><th scope="col">End Date</th>
            </tr>
            <tr>
                <td>Update &nbsp;Cancel</td>
                <td><input name="ctl00$ContentPlaceHolder1$gvHolds$ctl02$tbStartDate" type="text" 
                    value="01/04/2013 10:43" id="ContentPlaceHolder1_gvHolds_tbStartDate_0" class="dateTimePickerClass" />
                </td>
                <td><input name="ctl00$ContentPlaceHolder1$gvHolds$ctl02$tbEndDate" type="text" 
                    id="ContentPlaceHolder1_gvHolds_tbEndDate_0" class="dateTimePickerClass" />
                </td>
            </tr>
        </table>
    </div>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-04T02:16:45.293

玩弄简化的 HTML 和工作的 JSFiddle，直到我注意到我正在运行 jquery-ui-1.9.1.js 并且 jsfiddle 使用 jquery-ui-1.8.16.js，我才能让它工作。切换到旧版本有效。

# sql - 带有附加条件的 SQL MAX（列）

> ID：14162249
> 
> 赞同：3
> 
> 时间：2013-01-04T17:52:38.750
> 
> 标签：sql, sql-server

我有一个表，我想返回一个由另一个标识符分组的 MAX(id) 列表。但是，我有第三列，当它满足某个标准时，“胜过”不符合该标准的行。

用一个例子可能更容易解释。样品表有：

UniqueId (int) GroupId (int) IsPriority (位)

原始数据：

```
UniqueId    GroupId    IsPriority
-----------------------------------
    1           1          F
    2           1          F
    3           1          F
    4           1          F
    5           1          F
    6           2          T
    7           2          T
    8           2          F
    9           2          F
   10           2          F 
```

因此，因为 groupId 1 中的任何行都没有设置 IsPriority，所以我们返回最高的 UniqueId (5)。由于 groupId 2 具有设置了 IsPriority 的行，因此我们返回具有该值 (7) 的最高 UniqueId。

所以输出将是：

```
5
7 
```

我可以想办法强制执行此操作，但我想看看是否可以在单个查询中执行此操作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T17:56:57.783

[SQL 小提琴演示](http://www.sqlfiddle.com/#!3/0f37f/1)

```
WITH T
     AS (SELECT *,
                ROW_NUMBER() OVER (PARTITION BY GroupId 
                                    ORDER BY IsPriority DESC, UniqueId DESC ) AS RN
         FROM   YourTable)
SELECT UniqueId,
       GroupId,
       IsPriority
FROM   T
WHERE  RN = 1 
```

# django - pgpool2 负载平衡不起作用

> ID：14162252
> 
> 赞同：8
> 
> 时间：2013-01-04T17:52:44.043
> 
> 标签：django, postgresql-9.1, pgpool

我有一个 Python/Django 应用程序，它将在不久的将来某个时候需要数据库负载平衡。与此同时，我正在尝试学习在本地虚拟机设置上实现 pgpool。

我有 4 个 Ubuntu 12.04 虚拟机：

```
192.168.1.80 <- pool, pgppool2 installed and accessible
192.168.1.81 <- db1 master
192.168.1.82 <- db2 slave
192.168.1.83 <- db3 slave 
```

我有 pgpool-II 版本 3.1.1，我的数据库服务器正在运行 PostgreSQL 9.1。

我有我的应用程序的数据库连接指向 192.168.1.80:9999 并且工作正常。

问题是当我使用 Apache ab 向它施加一些负载时，没有一个 SELECT 查询似乎是平衡的。所有的负载都交给我的 db1 master。另外，非常令人担忧的是池服务器本身的负载，它与 db1 相比确实很高，可能平均高出 8-10 倍。同时，我的 db2 和 db3 服务器的负载几乎为零，它们似乎只是从 db1 复制，这对于我使用 ab 进行的测试来说负载不是很密集。

```
ab -n 300 -c 4 -C 'sessionid=80a5fd3b6bb59051515e734326735f80' http://192.168.1.17:8000/contacts/ 
```

这将我的池服务器上的负载提高到大约 2.3。db1 上的负载约为 0.4，db2 和 db3 上的负载几乎为零。

有人可以看看我的配置，看看我做错了什么吗？

```
backend_hostname0 = '192.168.1.81'
backend_port0 = 5432
backend_weight0 = 1
backend_data_directory0 = '/var/lib/postgresql/9.1/main'
backend_flag0 = 'ALLOW_TO_FAILOVER'

backend_hostname1 = '192.168.1.82'
backend_port1 = 5433
backend_weight1 = 1
backend_data_directory1 = '/var/lib/postgresql/9.1/main'
backend_flag1 = 'ALLOW_TO_FAILOVER'

backend_hostname2 = '192.168.1.83'
backend_port2 = 5434
backend_weight2 = 1
backend_data_directory2 = '/var/lib/postgresql/9.1/main'
backend_flag2 = 'ALLOW_TO_FAILOVER'

load_balance_mode = on 
```

我的整个配置在这里：

```
http://pastebin.com/raw.php?i=wzBc0aSp 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T00:04:50.603

我需要

```
replication_mode = off
master_slave_mode = on 
```

感谢石井达男：

[http://www.pgpool.net/pipermail/pgpool-general/2013-January/001309.html](http://www.pgpool.net/pipermail/pgpool-general/2013-January/001309.html)

# sql-server-2008 - 停止队列的 N 个消费者

> ID：14162255
> 
> 赞同：0
> 
> 时间：2013-01-04T17:52:50.530
> 
> 标签：sql-server-2008, service-broker

我有一个 SSBS 队列和一个主进程向`M`队列发送消息。有`N`子流程会一一获取消息并进行处理。处理完所有消息后，子进程将退出。现在我正在做以下事情，

*方法一：*

发送消息后，主进程发送`N`“EndOfData” `M`。但是它不能很好地工作，因为某些子流程可能会收到多个“EndOfData”消息，因此某些子流程将永远不会收到该消息。

*方法2：（扩展方法1）*

为每个子流程分配一个 ID，同时在“EndOfData”消息中嵌入一个 ID。如果消息中的 ID 与其 ID 不匹配，则子流程回滚。但是，由于回滚过多并且队列被禁用，它会导致“平衡消息”问题。

```
begin tran
begin try
    WAITFOR(
        RECEIVE TOP(1)
            @MessageType = message_type_name,
            @MessageBody = CAST(message_body AS xml)
        FROM
            TargetQueue
    ) , TIMEOUT 1000
    if @MessageType = 'EndOfData' and 
       @MessageBody.value('(//ID/text())[1]', 'int') <> @ID
    BEGIN 
        rollback tran
        waitfor delay '00:00:02'
    END 
```

有没有好的方法来实现它？

**更新：**
子流程将执行以下步骤。

1.  收到一条消息
2.  如果“工作”，
    1.  处理消息（可能需要几分钟）
    2.  向队列发送“信息”消息以通知主进程消息已被处理
3.  如果 "EndOfData",
    1.  向主进程发送消息“退出”
    2.  收到`https://..../EndDialog`“Exist”消息并退出
4.  如果`https://.../EndDialog`是 2.2 发送的消息，直接接收

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:59:38.463

另一种方法，假设`N = 3`：

1.  发送“EndOfData”类型的消息，其中包含`3`.
2.  3 个子流程之一收到此消息，发送包含 的响应消息`2`，退出。所以剩下2个正在运行的子进程。
3.  接收响应`2`并发送“EndOfData”类型的消息，其中包含`2`.
4.  2 个子流程之一收到此消息，发送包含 的响应消息`1`，退出。所以剩下 1 个正在运行的子进程。
5.  接收响应`1`并发送“EndOfData”类型的消息，其中包含`1`.
6.  最后运行的子进程收到此消息，发送包含 的响应消息`0`，退出。没有正在运行的子进程。
7.  接收响应`0`并停止发送“EndOfData”类型的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T02:53:19.123

使用以下代码并将工作放入事务中。所以脚本块可以在收到`EndOfData`消息后退出。

```
$conn = new-object Microsoft.SqlServer.Management.Common.ServerConnection
$conn.DatabaseName = "..."
$conn.BeginTransaction()
$conn.ExecuteNonQuery("Receive message;")
# do work
$conn.CommitTransaction() 
```

[http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.common.serverconnection.committransaction.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.common.serverconnection.committransaction.aspx)

# regex - 正则表达式匹配一行的开头和结尾？

> ID：14162258
> 
> 赞同：1
> 
> 时间：2013-01-04T17:53:04.677
> 
> 标签：regex, bash, sed, end-of-line, start-of-line

谁能告诉我一个匹配一行开头或结尾的正则表达式？例如，如果我使用`sed 's/[regex]/"/g' filehere`输出将是引号中的每一行？我试过了`[\^$]`，`[\^\n]`但它们似乎都不起作用。我可能遗漏了一些明显的东西，我对这些很陌生

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T17:55:58.643

尝试：

```
sed -e 's/^/"/' -e 's/$/"/' file 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T20:33:27.530

在每行的开头和结尾添加引号很简单：

```
sed 's/.*/"&"/g' 
```

但是，您试图想出的匹配每行开头或结尾的 RE 是：

```
sed -r 's/^|$/"/g' 
```

它是一个 ERE（由“-r”启用），因此它可以与 GNU sed 一起使用，但不能与旧的 sed 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T20:35:51.207

matthias 的响应是完全足够的，但您也可以使用反向引用来执行此操作。如果您正在学习正则表达式，那么了解它们是一件很方便的事情。

这是使用反向引用完成的方法：

```
sed 's/\(^.*$\)/"\1"/g' file 
```

该正则表达式的核心是`^.*$`，这意味着匹配由行首 ( ) 和行尾( `.*`) 包围的任何内容 ( )，这实际上意味着它将每次都匹配整行。`^``$`

将该术语放在括号内会创建一个反向引用，我们稍后可以引用它（在替换模式中）。但是要让 sed 意识到您的意思是创建反向引用而不是匹配文字括号，您必须使用反斜杠对其进行转义。因此，我们最终得到了`\(^.*$\)`我们的搜索模式。

替换模式只是一个双引号，后跟一个`\1`，这是我们的反向引用（指回括号中的第一个模式匹配，因此是 1）。然后添加最后一个双引号以结束`"\1"`.

# r - 通过向量在 for 循环中调用数据帧

> ID：14162260
> 
> 赞同：-1
> 
> 时间：2013-01-04T17:53:24.973
> 
> 标签：r

我有一些`data.frames`

```
dat1=read.table...
dat2=read.table...
dat3=read.table... 
```

我会计算每个数据集的行数。所以名称是这样保存的（不能“改变”它） vector=c("dat1","dat2","dat3...)

```
p <- vector(numeric, length=1:length(dat))
counting <- function(x) {for (i in 1:x){
      p[i]<-nrow(dat[i])}
return(p)
} 
```

这不起作用，因为输入`nrow`是一个字符，但我需要整数（？）还是？

谢谢帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:26:37.813

你可以用`get`这个，但要小心！相反，阅读 a 的表格`list`是 R-ish 方式：

```
file.names <- list.files()

dat <- lapply(file.names, read.table) 
```

然后，您就可以享受家庭的所有便利`lapply`，`apply`例如：

```
lapply(dat, nrow) 
```

使用的解决方案`get`（也是`vector`一个错误的变量名，因为它是一个非常重要的功能）：

```
lapply(vector, function(x) nrow(get(x))) 
```

您的方法失败，因为没有调用`dat`要索引的对象。`for loop`可能看起来像：

```
p = NULL
for(v in vector) {
  p <- c(p, nrow(get(v)))
} 
```

但是由于很多原因，这种技术的形式很差......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:51:58.830

如果您想确定您知道在 中的项目的属性，则可以使用`.GlobalEnv`：

```
> sapply( c("A","B"), function(objname) nrow(.GlobalEnv[[objname]])  )
A B 
5 4 
```

您可以用任何字符向量替换 c("A","B")`。如果对象不在全局环境中，它只会返回 NULL，因此它相当健壮。

# php - 使用 onclick 方法抓取 $this 行并填充 Web 表单

> ID：14162270
> 
> 赞同：1
> 
> 时间：2013-01-04T17:54:15.987
> 
> 标签：php, javascript, jquery

我正在尝试从表格行中选择数据并在 Web 表单中使用该数据。我已经能够将记录 ID 作为行的数据属性传递。我被困在必须使用 $.on() 函数的部分，以及我在将与此 Javascript 代码相关联的 PHP Webform 中放入什么？

谢谢

## 这是Javascript

```
$(document).on('click', 'tr', function() {

        //Get the ID from the row clicked
        var id = $(this).data('recordId'); 

        //short-hand
        $('#section2').load('data_entry_form.php?id='+id);

}); 
```

## 这是用于 Web 表单的 PHP（请参阅前几行，我尝试“捕获”用户选择的记录 id。

```
<html>
<form>
<?php
   $_GET['id'];

   echo $id; //should echo the id being sent across.
?>
<input type="date"></input><br>
<input list="auditors" placeholder="Auditor" />
<datalist id="auditors">
    <option value="Foo" />
</datalist><br>
<input list="city" placeholder="City" />
<datalist id="city">    
    <option value="Bar" />
</datalist><br>
<input type="submit" name="submitbutton" id="submitbutton" value="Submit" />
</form>
</html> 
```

## 这是生成我从中选择行的原始表的 PHP。在这里，我传递了一个数据属性，即“fee_source_id”（与表中的第一列相同）。

```
<?php
require_once 'config.php';

$dbh = new PDO($dsn, $dbuser, $dbpass);

$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$dbh->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$result = $dbh->query("
    SELECT a_aif.aif_id,
      a_aif.fee_source_id,
      a_aif.company_name_per_sedar,
      a_aif.document_filing_date,
      IF (a_aif_remaining.aif_id IS NULL, 0, 1) `match`
    FROM  a_aif
      LEFT JOIN a_aif_remaining
        ON a_aif_remaining.aif_id = a_aif.aif_id
    WHERE aif_id = {$id}
    ORDER BY aif_id DESC");

$result->setFetchMode(PDO::FETCH_ASSOC);

if ( !empty($result) ) : endif;

?>

<table = "all_aifs">
<tr>
    <th><b>Document ID</b></th>
    <th><b>Pubco Name</b></th>
    <th><b>Filing Date</b></th>
    <th><b>PDF</b></th>
</tr>
<?php foreach($result as $index => $row) : ?>
<tr data-recordId="<?=$row[fee_source_id];?>"
    class="<?=$row["match"] ? "match" : "";?>">
    <td><?php echo $row[fee_source_id]; ?></td>
    <td><?php echo $row[company_name_per_sedar]; ?></td>
    <td><?php echo $row[document_filing_date]; ?></td>
    <td></td>
</tr>
<? endforeach;?>
</table> 
```

![在此处输入图像描述](../Images/c02c420eb92b3bc5c77eaafff293dbc5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:45:09.050

'$row['aif_id']' 设置在哪里？在上面的代码中，你有 '$id' 和 $row['aif_id'] 但是 $row['aif_id'] 是在哪里设置的？$row 应该代表用 $id 加载的数据吗？

```
$('document').ready(function(){
    $('table').find('tr').on({
     click: (function(e){
        var id = $(this).data('recordId');
        $('#section2').load('data_entry_form.php?id='+id);

     })

    });

});

<?php
   $id = $_GET['id'];

   echo $id; //should echo the id being sent across.
?> 
```

# java - 如何在java中将日期和时间添加到目录名称

> ID：14162276
> 
> 赞同：-4
> 
> 时间：2013-01-04T17:54:29.557
> 
> 标签：java, datetime

嗨，我想创建一个本地目录，名称中包含日期和时间，如下所示

目录名称_日期_时间

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T17:57:10.803

**更新**

尝试一些事情，如果你无法弄清楚，然后来 SO 并提出一个问题，提及你尝试过的事情。看看这个，看看它是否可以帮助您找出问题的解决方案：

```
Date date = new Date(); //creates a date based on current date/time

//provides a formatting string for your eventual output
SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd"); 
System.out.println(sdf.format(date)); //prints something like "2013-01-04" 
```

所以现在你已经得到了一个字符串的日期，你应该能够弄清楚如何将它附加到目录名称上。

您可以通过查看[http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html上的 API 为您的 SimpleDateFormat 创建更好的格式字符串](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)

# java - 圆圈周围的jmagick文本略微偏离

> ID：14162277
> 
> 赞同：2
> 
> 时间：2013-01-04T17:54:34.553
> 
> 标签：java, imagemagick, jmagick

我对 ImageMagick 和 java 比较陌生，并且正在开发一个项目，以在 Windows 上使用 ImageMagick 6.3.9 Q16 和 jmagick 6.3.9 Q16 在以 0 度为中心的圆的外部显示文本。我们正在从 PHP MagickWand 移植现有的图像魔法代码，但我认为由于以下差异，圆弧上每个字母的位置在 java 版本中有点偏离。

在 MagickWand 中，它通过这一行代码放置在弧上，该代码使用浮点 x、y 坐标值和浮点角度值（以获得更高的精度）来注释绘图棒（相当于 jmagick 中的 DrawInfo）并且工作得很好：

```
MagickAnnotateImage($magick_wand, $drawing_wand, $origin_x + $x, $origin_y - $y, $angle, $character); 
```

但是在 jmagick 中，annotateImage 方法只接受一个参数，即 DrawInfo，所以我最终得到了我认为唯一的另一种选择，compositeImage 方法。因此，为了做到这一点，我将每个字符绘制为单独的绘图信息，然后将其注释到透明的 png 图像，然后通过 rotateImage 方法旋转该图像，然后使用compositeImage 将其放置在我的画布图像上，但compositeImage 只处理x & y 作为 int 值（并且不考虑角度），所以我正在舍入我的 x & y double 值（以获得相同的小数位数或更多，就像 php 版本用来排除这种情况一样）怀疑是它让角色有点偏离圆圈的主要原因。

我执行工作的代码如下，其中 Article 是字体文件的本地路径（例如：E:\WCDE_ENT70\workspace\Stores\WebContent\AdminArea\CoordsCenterSection\fonts\ARIALN.TTF），nameNumStr 是要渲染的字符串圆（例如：SAMUELSON），fsize 是字体的点大小（例如：32），colorStr 是字体颜色名称（例如：黑色），radVal 是半径（例如：120），poix 是 x 原点起始坐标（例如: 150), poiy 是 y 原点起始坐标 (例如: 150):

```
public byte[] getArcedImage(String Article, String nameNumStr, int fsize, String colorStr, int radVal, int poix, int poiy)
{
     try {
            Font f = null;
            try {
                f = Font.createFont(Font.TRUETYPE_FONT, new FileInputStream(Article.replaceAll("%20"," ")));
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } catch (FontFormatException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }

            String fontName = f.getName();
            // Use awt's font metrics since jmagick doesn't have font metrics built in like php magickwand does
            FontMetrics fm = createFontMetrics(new Font(fontName, Font.PLAIN, fsize));
            int strImgW = fm.stringWidth(nameNumStr);
            int strImgH = fm.getHeight();

            String spacerImg = "E:\\WCDE_ENT70\\workspace\\Stores\\WebContent\\AdminArea\\CoordsCenterSection\\images\\600x600.png";

            //Read in large 600 png first as our main canvas
            ImageInfo bi = new ImageInfo(spacerImg);
            MagickImage bmi = new MagickImage(bi);

            // Make canvas image transparent
            bmi.setMatte(true);
            bmi.setBackgroundColor(PixelPacket.queryColorDatabase("#FFFF8800"));

            //defaults or param vals
            final int radius = radVal;
            final int origin_x = poix;
            final int origin_y = poiy;
            final int center_text_on = 0;
            final int charXGeom = 150;
            final int charYGeom = 150;

            double circumference = 0;
            double percentage = 0;
            double degrees = 0;
            double start = 0;
            double current_degree = 0;
            double angle = 0;
            double angle_adjustment = 0;
            double character_center = 0;

            /**
             * Calculate the circumference of the drawn circle and label the image
             * with it.
             */
            circumference = (2 * Math.PI * radius);

            /**
             * Calculate the percentage of the circumference that the string will
             * consume.
             */
            percentage = strImgW / circumference;

            /**
             * Convert this percentage into something practical - degrees.
             */
            degrees = 360 * percentage;

            /**
             * Because the string is centered, we need to calculate the starting point
             * of the string by subtracting half of the required degrees from the
             * anticipated center mark.
             */
            start = center_text_on - (degrees / 2);

            /**
             * Initialize our traversal starting point.
             */
            current_degree = start;

            // 
                        ImageInfo ci = null;
                        MagickImage cmi = null;

                        double x = 0;
                        double y = 0;
                        int finalStrWidth = 0;
                        int charImgW = 0;
                        int charImgH = 0;

                        for (int i=0; i<nameNumStr.length(); i++)
                        {
                                    /**
                                     * Isolate the appropriate character.
                                     */
                                    String charVal = nameNumStr.substring(i, i+1);

                                    charImgW = fm.stringWidth(charVal);
                                    charImgH = strImgH;

                                    ci = new ImageInfo(spacerImg);
                                    cmi = new MagickImage(ci);

                                    // Create Rectangle for cropping character image canvas to final width and height
                                    Rectangle charRect = new Rectangle(0,0,charImgW,charImgH);

                                    // Crop image to final width and height
                                    cmi = cmi.cropImage(charRect);

                                    // Make image transparent
                                    cmi.setMatte(true);
                                    cmi.setBackgroundColor(PixelPacket.queryColorDatabase("#FFFF8800"));

                                    // Set a draw info for each character
                                    DrawInfo cdi = new DrawInfo(ci);

                                    // Set Opacity
                                    cdi.setOpacity(0);

                                    // Set Gravity
                                    cdi.setGravity(GravityType.CenterGravity);

                                    // Set Fill Color
                                    cdi.setFill(PixelPacket.queryColorDatabase(colorStr));

                                    // Set Font Size
                                    cdi.setPointsize(fsize);

                                    // Set Font
                                    cdi.setFont(Article.replaceAll("%20"," "));

                                    // Set the text
                                    cdi.setText(charVal);

                                    // Make the text smoother
                                    cdi.setTextAntialias(true);

                                    // Annotate the draw info to make the character image
                                    cmi.annotateImage(cdi);

                                    // For debug purposes
                                    finalStrWidth += charImgW;

                                    /**
                                     * Calculate the percentage of the circumference that the character
                                     * will consume.
                                     */
                                    percentage = charImgW / circumference;

                                    /**
                                     * Convert this percentage into something practical - degrees.
                                     */
                                    degrees = 360 * percentage;

                                    /**
                                     * Calculate the x and y axis adjustments to make, based on the origin
                                     * of the circle, so we can place each letter.
                                     */
                                    x = radius * Math.sin(Math.toRadians(current_degree));
                                    y = radius * Math.cos(Math.toRadians(current_degree));

                                    // Rotate the character image to the angle
                                    cmi = cmi.rotateImage(angle);

                                    // Composite character image to main canvas image
                                    bmi.compositeImage(CompositeOperator.HardLightCompositeOp, cmi, (int)Math.round((origin_x+x)), (int)Math.round((origin_y-y)));

                                    // Increment the degrees
                                    current_degree += degrees;

                        }

                        bmi = bmi.trimImage();
                        byte[] pi = bmi.imageToBlob(ci);
                        return pi;

            } catch (MagickException e) {
                        e.printStackTrace();
                        return null;
            }
}

private FontMetrics createFontMetrics(Font font)
{
    BufferedImage bi = new BufferedImage(1, 1, BufferedImage.TYPE_INT_ARGB_PRE);
    Graphics g = bi.getGraphics();
    FontMetrics fm = g.getFontMetrics(font);
    g.dispose();
    bi = null;
    return fm;
}

private Rectangle2D createFontRectangle(Font font, String strVal)
{
    BufferedImage bi = new BufferedImage(1, 1, BufferedImage.TYPE_INT_ARGB_PRE);
    Graphics g = bi.getGraphics();
    FontMetrics fm = g.getFontMetrics(font);
    Rectangle2D rect = fm.getStringBounds(strVal, g);
    g.dispose();
    bi = null;
    return rect;
} 
```

从那以后，我发现可以使用 DrawInfo 的 setGeometry 方法来设置 x、y，并在我在 jmagick.org 的 wiki 上找到的一个示例中看到，它可以用于比 x、y 放置更多的地方，但不能找到任何其他示例或文档来展示它可以如何使用（希望也可以指定角度）。

我不是很肯定，但似乎 setGeometry 将是可能指定角度的唯一方法，因为 jmagick 的 annotateImage 实现仅将 Draw Info 作为参数。

**有谁知道使用 DrawInfo 的 setGeometry 方法设置 x、y 和角度的方法？我认为它可以解决我的问题。此外，如果有人有任何使用 jmagick 围绕他们愿意分享的圆圈绘制文本的工作示例，我将不胜感激。**

谢谢

# python - 需要基于 Python 中的正则表达式提取子字符串

> ID：14162278
> 
> 赞同：-6
> 
> 时间：2013-01-04T17:54:37.983
> 
> 标签：python, regex, substring

我需要使用 Python 提取 PO BOX 的任何可能组合之后出现的子字符串

例如

邮政信箱 88743

邮政信箱 04049

邮政信箱 304040

邮政信箱 49293

邮政信箱 2039a

结果：我应该能够提取以下子字符串

88743

4049（删除了前导 0）

304040

49293

2039a

子字符串可以是字母数字并包含 1-10 个数字

请帮忙！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T17:56:28.447

以下应该做到这一点：

```
re.findall(r'P[.]?O[.]?\s*box\s+0*([0-9a-zA-Z]+)', s, re.I) 
```

`s`你的字符串在哪里。

# php - php - CodeIgniter 中每个用户帐户 url 的一个域

> ID：14162279
> 
> 赞同：-1
> 
> 时间：2013-01-04T17:54:40.057
> 
> 标签：php, codeigniter, url

我正在为自己的婚礼开发一个婚礼网站，我有一些朋友想要使用它。

我只是在域之后匹配用户名的模式，如下所示：

`http://example.com/username => route to controler/index/username`

`http://example.com/username2 => route to controler/index/username2`

等等...

现在我想这样做：

`www.username.com => route to controler/index/username`

`www.username2.com => route to controler/index/username2`

但我想同时持有这两种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T18:04:13.810

你不能在 CI 中解决这个问题。它需要使用 apaches 域重写，因为这将格式化正确的重定向

```
<VirtualHost *>
  ServerName www.example.com
  Redirect 301 / http://example.com/username
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-04T19:04:29.423

你可以使用

```
 <meta http-equiv="refresh" content="1;url=<?php echo $adr; ?>"> 
```

并使用[$_SERVER](http://php.net/manual/en/reserved.variables.server.php)获取当前地址。（例如“用户名”并重定向到[http://www.username.com](http://www.username.com)。）

# iphone - UIView 边界之外的用户交互

> ID：14162280
> 
> 赞同：2
> 
> 时间：2013-01-04T17:54:40.273
> 
> 标签：iphone, objective-c, ios, uiview, screen

我想要做的是“导航”到一个更大的 UIView，按钮和控件位于不同的位置。我将主 UIView 的大小设置为比平常大两倍。它是 640x480 而不是 320x480。

单击屏幕第一部分的按钮后，我在 x 方向上进行了 -320px 的移动平移，以显示屏幕的第二个“隐藏”部分，其他功能将向用户显示。除了我无法将 UIView 恢复到原始位置之外，一切都完美无缺。我用来返回原始位置的按钮似乎是 320px 的“超出范围”，不起作用。

我的 UIView 被称为“introScreen”，以下是我调用的通过 x 方向平移屏幕的函数：

```
- (void)secondPartOfTheScreen {

        [UIView beginAnimations:nil context:NULL];
        [UIView setAnimationDuration:0.15];
        introScreen.transform = CGAffineTransformMakeTranslation(-320, 0);
        [UIView commitAnimations];

} 
```

调用此函数我的 UIView 正确移动，但是当我的按钮出现在屏幕的这一部分时，它没有得到任何用户交互。如果我在屏幕的第一部分移动那个按钮，它就可以正常工作。它与屏幕边界有关吗？有可能解决吗？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T18:20:08.200

您应该尝试将您的子类化`UIView`并覆盖其`pointInside:withEvent:`方法，以便将其边界之外的点也识别为属于视图。否则，就不可能按照您的意愿处理视图边界之外的用户交互。

这就是[事件处理指南](http://developer.apple.com/library/ios/#DOCUMENTATION/EventHandling/Conceptual/EventHandlingiPhoneOS/Introduction/Introduction.html)所说的：

> 在命中测试中，窗口在视图层次结构的最顶层视图上调用 hitTest:withEvent:；此方法通过在视图层次结构中返回 YES 的每个视图上递归调用 pointInside:withEvent: 来继续，沿着层次结构向下进行，直到找到发生触摸的子视图。该视图成为命中测试视图。

你可以在你的自定义中使用这样的东西`UIView`：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    for (UIView* view in self.subviews) {
      if (view.userInteractionEnabled && [view pointInside:[self convertPoint:point toView:view] withEvent:event]) {
        return YES;
      }
    }
    return NO;
} 
```

你可以这样做：

```
@interface MyView: UIView
@end

@implementation MyView

- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    for (UIView* view in self.subviews) {
      if (view.userInteractionEnabled && [view pointInside:[self convertPoint:point toView:view] withEvent:event]) {
        return YES;
      }
    }
    return NO;
}
@end 
```

将此类定义添加到`.m`您正在使用该视图的文件的开头。（您也可以使用单独的 .h/.m 文件，但为了测试一切是否正常，这就足够了）。然后，在您的 current 的实例化中`UIView`替换为，它应该可以工作。`MyView``UIView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:04:48.887

您没有正确使用 transform 属性，您应该考虑该属性的先前值，如下所示：

```
introScreen.transform = CGAffineTransformConcat(introScreen.transform, CGAffineTransformMakeTranslation(-320, 0)); 
```

希望这会有所帮助，并查看[Apple 的 UIView 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)和[CGAffineTransform 文档](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGAffineTransform/Reference/reference.html)以获取更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:42:07.160

2 件事。

首先，当您只是移动对象时，为什么要使用变换。您可以轻松设置框架。

```
CGRect frame = introScreen.frame;
frame.origin.x -= 320;
introScreen.frame = frame; 
```

（是的，这将在动画中起作用）

其次，如果你翻译一个视图，它的内容应该在它的范围内，不管你想首先显示的大小。

因此，您的容器视图（带有按钮的视图）应该是一个大小，以便所有包含的部分都在其范围内。任何超出其界限的东西都不会起作用。主视图的大小是两倍的大小不如包含的视图大小是两倍的有用。

像这样想。

您的桌子应该能够容纳您所看的任何东西。如果您有要显示的地图，您可以在桌子上滑动它。表格不需要和地图一样大，但地图需要足够大以向您展示其所有内容。如果地图太短而无法显示两极，那么您将没有信息。无论您如何改变地图，您都无法使用北极或南极..

To ensure the app reflects this you can turn on clip subviews on all the views in question, then if its outside the bounds it will not be visible.

# c++ - std::thread 没有例外？

> ID：14162287
> 
> 赞同：2
> 
> 时间：2013-01-03T12:18:21.420
> 
> 标签：c++, multithreading, exception, c++11

我想知道是否有一种方法可以`std::thread`毫无例外地使用，如果没有，我可以使用哪些替代方法？

实际上，我的目标是 windows 和 linux 桌面，但将来可能会扩展。

**编辑：**仅使用编译器选项来禁用异常，不是可接受的解决方案。错误必须以一种或另一种方式处理。

问题是我的代码中使用的唯一异常是那些处理`std::thread`错误的异常。我想摆脱那些拥有无异常代码的人

**edit2：**我找到了 tinythread++ 库，如果需要，它似乎很容易修改并且可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T12:33:01.517

您可以禁用 STL 的异常，但每个编译器都不同。当然，由于标准实际上说必须抛出一些异常，所以每当你做一些会抛出异常的事情时，你都会得到未定义的行为。

在 gcc 中，您可以使用禁用异常`-fno-exceptions`

在 MSVC 中：[我可以在 STL 中禁用异常吗？](https://stackoverflow.com/questions/553103/can-i-disable-exceptions-in-stl)

# c++ - 从文件中读取未知长度的 int 数组

> ID：14162293
> 
> 赞同：2
> 
> 时间：2013-01-04T17:55:08.420
> 
> 标签：c++, arrays, file

如何从文件中读取长度未知的整数数组？我看不到获取数组大小的方法，所以我尝试了一些临时字符串，但我的代码爆炸了......

有更好的主意吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T17:57:18.230

使用`std::vector`：

```
std::ifstream inFile(fileName);

std::vector<int> ints{
    std::istream_iterator<int>(inFile),
    std::istream_iterator<int>()
}; 
```

`std::vector`提供动态存储，因此它可以根据需要调整大小以适应它所拥有的内容。我所做的只是利用构造函数，它接受一对迭代器并循环遍历它们，从头到尾，并将值复制到向量中。我正在使用的迭代器将从文件中读取整数，直到无法读取，就像到达文件末尾的情况一样。我还使用统一初始化来避免最麻烦的解析，这是使用这种形式的构造函数时容易犯的错误。

# php - 在 PHP 中解码backbone.js JSON 包

> ID：14162294
> 
> 赞同：0
> 
> 时间：2013-01-04T17:55:09.783
> 
> 标签：php, jquery, json, backbone.js

因此，我一直无法解码从骨干网应用程序发送到服务器的有效 JSON 请求。无论我尝试什么，解码后的 $_POST 数据都返回 null。我戳了一下stackoverflow，找到[了这个解决方案](https://stackoverflow.com/questions/12162132/index-php-is-not-receiving-the-json-sent-by-the-backbone-post)：

```
$data = json_decode(file_get_contents('php://input'), true); 
print_r($data); 
```

这似乎是一个 hack，所以我想知道是否有更好的方法来处理 PHP 中来自主干的 JSON 数据。在 PHP 中接收和解码从骨干网应用程序发送的 JSON 数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:03:34.713

您应该检查用于将数据发送到脚本的请求方法，如下所示：

```
switch ($_SERVER['REQUEST_METHOD'])
{
    case 'POST':
    {
      // do something
    }
    break;

    case 'GET':
    {
      // do something else
    }
    break;

    case 'PUT':
    {
      // your snippet goes here
    }
    break;

    case 'DELETE':
    {
      // do something when request method == DELETE
    }
    break;
} 
```

您发布的代码是您在 REQUEST_METHOD 为 PUT 或 DELETE 时应该使用的代码。这根本不是黑客。

您还可以将 Backbone 配置为通过 POST 发送数据：

```
Backbone.emulateHTTP = true; 
```

来自 Backbone 的手册：

> 如果您想使用不支持 Backbone 的默认 REST/HTTP 方法的旧版 Web 服务器，您可以选择打开 Backbone.emulateHTTP。设置此选项将使用 HTTP POST 伪造 PUT 和 DELETE 请求，使用 true 方法设置 X-HTTP-Method-Override 标头。如果 emulateJSON 也打开，则 true 方法将作为附加的 _method 参数传递。

# html - 使 div 的高度为视口高度的 100% 或页面的整个高度

> ID：14162296
> 
> 赞同：5
> 
> 时间：2013-01-04T17:55:12.553
> 
> 标签：html, css

如果您看一下这个 jsfiddle 示例：http: [//jsfiddle.net/2YbpZ/](http://jsfiddle.net/2YbpZ/)

您可以看到`sidebar`和`content`元素都延伸到视口的底部。这就是我要的。

但是，当给定一些拉伸页面并要求用户滚动的内容时：http: [//jsfiddle.net/p6qGg/](http://jsfiddle.net/p6qGg/)

`sidebar`和div 在视口底部被`content`截断。我知道为什么会发生这种情况，因为`100%`指的是父元素的整个高度，在这种情况下是视口，但是当我将标记更改为有一个围绕这两个元素的包装 div 并发生`min-height: 100%`这种情况时：[http:// jsfiddle.net/Lr6k9/](http://jsfiddle.net/Lr6k9/)

同样，如果内容不再长到不适合视口，则`sidebar`和`content`div 就像根本没有分配高度一样：http: [//jsfiddle.net/xsHHv/](http://jsfiddle.net/xsHHv/)

所以我的问题是，如果内容没有超出页面，我怎样才能让`sidebar`和div 成为视口的高度，或者让它们成为内容的高度？`content`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-04T17:59:59.623

诀窍是给你的元素一个巨大`padding-bottom`的，相应的负数`margin-bottom`：

```
html, body {
    height: 100%;
}

#wrapper {
    min-height: 100%;
    overflow: hidden;
}

#sidebar, #content {
    float: left;
    padding-bottom: 999em;
    margin-bottom: -999em;
} 
```

这是你的小提琴：http: [//jsfiddle.net/Lr6k9/4/](http://jsfiddle.net/Lr6k9/4/)

# java - 在摇摆中制作自定义 UI

> ID：14162298
> 
> 赞同：1
> 
> 时间：2013-01-04T17:55:13.617
> 
> 标签：java, swing, graphics, custom-component, graphics2d

我需要制作一个自定义 ui，如下图所示：-

![在此处输入图像描述](../Images/cc8b1add9f6964d7c1fd87b1bf3c5136.png)

我知道如何将按钮更改为箭头形状和其他所有内容。但我不明白如何将那些关闭、恢复和最小化按钮移动到中心并赋予它们圆形（在 Windows 上）。

在谷歌上，我发现了如何制作自定义形状的窗口，但它不符合我的要求。谁能告诉我如何做到这一点或任何链接.??

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T17:57:40.693

您需要创建自己的标题栏作为另一个带有按钮的面板，然后删除框架上的窗口装饰。

```
JFrame frame = new JFrame(...);    
frame.setUndecorated(true);
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//This will close the frame and exit 
```

要最小化和最大化，请监听按钮事件并使用：

```
frame.setState(Frame.ICONIFIED);//minimizes

frame.setState(Frame.NORMAL);//restores 
```

详情请参阅[`Frame.setState(int)`](http://docs.oracle.com/javase/7/docs/api/java/awt/Frame.html#setState%28int%29)。

# sql - 具有许多布尔变量的模式的最佳实践

> ID：14162305
> 
> 赞同：3
> 
> 时间：2013-01-04T17:55:39.900
> 
> 标签：sql, indexing, boolean, bit-manipulation, multiple-columns

我正在创建一个 Postgresql 数据库，其中我们有许多（10-40）个具有布尔值的变量。考虑到适度的更新数量和大量的多列搜索，我想弄清楚存储这些数据的最佳方式是什么。

仅创建 30 个左右的布尔列并在必要时创建多列索引似乎非常简单。或者，有人建议创建一个组合所有布尔值的位字符串。似乎第二种选择应该更快，但其他人在网上给出的答案似乎是矛盾的（见下文）。

任何建议或解释都会有所帮助。数据有数千万行，但不会更大，我希望选择返回的数据介于 1/100 到 1/4 之间。

[https://stackoverflow.com/questions/14067969/optimized-sql-using-bitwise-operator](https://stackoverflow.com/questions/14067969/optimized-sql-using-bitwise-operator)

[替代 postgresql 中的位图索引](https://stackoverflow.com/questions/3824751/alternative-to-bitmap-index-in-postgresql)

更新：

如果您有多个变量（您应该在其中使用单独的列）并且少于 33 个左右（您切换到位串），我发现了一个建议使用整数或大整数的资源。这似乎更多地是由存储大小而不是易于搜索引起的。

[https://dba.stackexchange.com/questions/25073/should-i-use-the-postgresql-bit-string](https://dba.stackexchange.com/questions/25073/should-i-use-the-postgresql-bit-string)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T00:47:10.223

我在[数据库管理员](https://dba.stackexchange.com/questions/25073/should-i-use-the-postgresql-bit-string)站点上找到了相关讨论。

首先，我将定义/分析在您的上下文中什么是“最佳”。你只是在寻找速度吗？你的搜索模式是什么？数据/磁盘量是否有问题？

你有什么选择？除了位串之外，还可以使用普通的文本字符串、整数数组和单独的列。为了快速获取数据，您必须考虑索引。您提到了多列索引。在多个索引中存储/索引相同的位变量是否有意义？

没有太多重复记录的 40 位意味着最多 2^20 = 1.1E12 条记录。这使得全表扫描成为一件冗长的事情。另一方面，如果您有很多重复的键，则索引并没有真正的帮助。

如果您期望大约 25% 的结果集，则必须在数据库和应用程序之间传输 2.7E11（部分）记录。假设 10,000 条记录/秒，这将需要 7,736 小时或 10 个月。

**我的结论是，您应该考虑将数据存储在大 BLOB 中**（1.1E12 x 40 位仅为 40 GByte）。您可以对数据进行分区，将有趣的部分读入内存并在那里进行搜索。这或多或少是大数据或数据仓库系统正在做的事情。

# android - 如果在android中条件为真，如何启用按钮？

> ID：14162309
> 
> 赞同：1
> 
> 时间：2013-01-04T17:55:44.613
> 
> 标签：android

我有 4 个名为 a1、a2 和 a3 的 xml，然后我还有一个主 xml。在 a1 中有一个 editText 和一个 ok 按钮，在 a2 中有一个“禁用”的 ok 按钮。现在，我想要发生的是，当 a1 中输入的数据正确时，它将继续到 a2，然后那里的“禁用”按钮现在应该是“启用”。现在我的程序上发生的事情是，它已经在运行，除了 a2 中的按钮被启用，但它会立即返回被禁用。启用后如何防止它被禁用？我是android新手，所以请尽可能简单地解释它。提前致谢。

这是我的代码

主要活动.java

```
package com.example.myact1;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button btnClose = (Button) findViewById(R.id.btnExit);
    btnClose.setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0) {

            finish();
            System.exit(0);
        }
    });

    Button page1 = (Button) findViewById(R.id.btn1);
    page1.setOnClickListener(new View.OnClickListener() {
    public void onClick(View view) {
    Intent myIntent = new Intent(view.getContext(), a1.class);
   startActivityForResult(myIntent, 0);

    }

});

} 
```

}

MainActivity.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<Button
    android:id="@+id/btnExit"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:layout_marginBottom="45dp"
    android:text="Exit" />

<Button
    android:id="@+id/btn1"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/btnExit"
    android:layout_alignLeft="@+id/btnExit"
    android:layout_marginBottom="30dp"
    android:text="enter" /> 
```

一个 xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/btna1"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="155dp"

    android:text="Enter" />

<EditText
    android:id="@+id/eta1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/btna1"
    android:layout_centerHorizontal="true"
    android:layout_marginBottom="52dp"
    android:ems="10" >

    <requestFocus />
</EditText> 
```

a1.java

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.a1);

    Button page1 = (Button) findViewById(R.id.btna1);
    page1.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            EditText a1et = (EditText) findViewById(R.id.eta1);
            String a1 = a1et.getText().toString();
            if (a1.equalsIgnoreCase("abcde")) {
                Toast.makeText(getApplicationContext(), "correct", Toast.LENGTH_SHORT).show();
                Intent myIntent = new Intent(view.getContext(), a2.class);
                startActivityForResult(myIntent, 0);

                //enables the button in a2
                setContentView(R.layout.a2);
                Button stage2 = (Button) findViewById(R.id.btna2);
                stage2.setClickable(true);
                stage2.setEnabled(true);
            } else {
                Toast.makeText(getApplicationContext(), "wrong", Toast.LENGTH_SHORT).show();
            }
        }
    });
} 
```

这是我的 a2.java 的代码

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.a2);
    }
} 
```

a2.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/btna2"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="102dp"
    android:clickable="false"
    android:enabled="false"
    android:text="enter" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T17:58:57.413

还添加

```
stage2.setEnabled(true); 
```

正下方：

```
Button stage2 = (Button) findViewById(R.id.btna2);
stage2.setClickable(true); 
```

**编辑**查看所有代码后，我对您的代码进行了两次更正，以便它可以正常工作：

删除这部分代码`a1.java`：

```
//enables the button in a2
setContentView(R.layout.a2);
Button stage2 = (Button) findViewById(R.id.btna2);
stage2.setClickable(true);
stage2.setEnabled(true); 
```

还记得我们决定使用新活动而不是更改`contentView`当前活动吗？因为你有这个代码，所以按钮在它再次被禁用之前出现了一小会儿。

更改代码`a2.java#onCreate`：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.a2);
    Button stage2 = (Button) findViewById(R.id.btna2);
    stage2.setEnabled(true);    
} 
```

在这里，您没有启用按钮，那是您的问题。渲染 a2你会用一个新`Activity`的视图覆盖你已经在 a1 中渲染的视图。`Activity`一个按钮再次被禁用。我用这段代码纠正了这一点。

# javascript - 替换 URL（带链接）但在已经定义了一些链接的文本中

> ID：14162310
> 
> 赞同：3
> 
> 时间：2013-01-04T17:55:46.000
> 
> 标签：javascript, html, regex, url, hyperlink

我查看了此链接中基本问题的答案：[如何用链接替换纯 URL？](https://stackoverflow.com/questions/37684/how-to-replace-plain-urls-with-links/7138764#7138764)并决定使用[Christian Koch](https://stackoverflow.com/users/725349/christian-koch)建议的代码，但它仅部分涵盖了我需要做的事情。我希望这里有人可以帮助我。

Christian Koch 提供的代码很好用，但有一个例外 - 当我的文本已经包含链接并且只是纯文本时，这些链接会得到一个双“a”标签，因此会导致 html 问题，使文本无法正确显示在浏览器中。

例如，代码可以正常工作：

```
 www.yahoo.com is a website just like http://www.google.com 
```

我看到 yahoo 和 google 文本现在显示为链接，并且正如我所期望的那样，它们周围都有一个链接包装器：

```
 <a href="http://www.yahoo.com">www.yahoo.com</a> is a website just like <a href="http://www.google.com">http://www.google.com</a> 
```

现在获取此文本（包含基本文本和已定义的链接）：

```
 www.yahoo.com is a website just like <a href="http://www.google.com">http://www.google.com</a> 
```

使用提供的代码时，雅虎链接是正确的，但谷歌链接现在有一个双标签：

```
 <a href="http://www.yahoo.com">www.yahoo.com</a> is a website just like <a href="<a href="http://www.google.com">http://www.google.com</a>" target="_blank"><a href="http://www.google.com">http://www.google.com</a></a> 
```

**有人可以帮我正确设置模式，以便当文本已经包含链接时，模式会忽略它，但仍会替换没有标签的其他文本。当且仅当文本尚未包含在链接标记中时，我才希望模式进行替换。**

这是我在另一篇文章中使用的代码：

```
 doLinks: function(originalText) 
   {
    // http://, https://, ftp://
    var urlPattern = /\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;

    // www. sans http:// or https://
    var pseudoUrlPattern = /(^|[^\/])(www\.[\S]+(\b|$))/gim;

    // Email addresses *** here I've changed the expression ***
    var emailAddressPattern = /(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim;

    return originalText
        .replace(urlPattern, '<a target="_blank" href="$&">$&</a>')
        .replace(pseudoUrlPattern, '$1<a target="_blank" href="http://$2">$2</a>')
        .replace(emailAddressPattern, '<a target="_blank" href="mailto:$1">$1</a>');
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:37:24.570

好吧，在再看问题之后，我开始相信几个子模式的组合会比一个巨型模式做得更好。所以我将 pseudoUrlPattern 分为两部分，一个用于行首的 url，一个用于给定文本中的每个其他 url。考虑以下修改后的代码，并附上我的测试文本：

```
 var doLinks = function(originalText) {

        var urlPattern = /[^<>]\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|](?![^<>])/gim;

        var pseudoUrlPattern1 = /^([^\/])?(www\.[\S]+(\b|$|[^<>]))/gim
        var pseudoUrlPattern2 = /([^\/"><])(www\.[\S]+(\b|$))(?![^<>])?/gim;

        var emailAddressPattern = /(([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim;

        return originalText
            .replace(urlPattern, '<a target="_blank" href="$&">$&</a>')
            .replace(pseudoUrlPattern1, '$1<a target="_blank" href="http://$2">$2</a>')
            .replace(pseudoUrlPattern2, '$1<a target="_blank" href="http://$2">$2</a>')
            .replace(emailAddressPattern, '<a target="_blank" href="mailto:$1">$1</a>');
    }    

    var string = 'www.yahoo.com is a website just like <a href="http://www.google.com">http://www.google.com</a> and not like <a href="www.facebook.com "> www.facebook.com </a> and not like www.example.com'; 
```

试一试，告诉我结果如何。

需要注意的一件事：已经在锚标签中的 url 最好在 url 和标签之间不应该有任何空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:38:47.427

当 URL 在引号`'`或双引号中时，禁止替换`"`。

```
// http://, https://, ftp://
var urlPattern = /[^"']\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim;

// www. sans http:// or https://
var pseudoUrlPattern = /(^|[^\/"'])(www\.[\S]+(\b|$))/gim;

// Email addresses *** here I've changed the expression ***
var emailAddressPattern = /[^"'](([a-zA-Z0-9_\-\.]+)@[a-zA-Z_]+?(?:\.[a-zA-Z]{2,6}))+/gim; 
```

也许您需要转义引号或双引号。我没有测试它。

顺便说一句：您的正则表达式与所有域名都不匹配。国际化域名越来越多。[请参阅德语维基百科中](https://de.wikipedia.org/wiki/Umlautdomains#Beispiel-Domains)的示例

# api - google api 用于光荣的信息框？

> ID：14162311
> 
> 赞同：5
> 
> 时间：2013-01-04T17:55:48.637
> 
> 标签：api, google-api, freebase

我猜这个信息是有特权的，因为我在谷歌列出的 API 上找不到任何东西。事实上，如果它不是专有的安全固定的谷歌魔法，我会感到惊讶，但我想我还是会问的。

当您对女演员或摇滚乐队进行基本搜索时，是否有用于显示信息的 Google API？如果谷歌准确地找出您正在寻找的内容，您就会知道结果右侧出现的框。（尽管有下面的例子，我对音乐家特别感兴趣）

IE

[https://www.google.com/search?q=woody+allen](https://www.google.com/search?q=woody+allen)

![在此处输入图像描述](../Images/066cd7a78d0db7b9b82ba3b6d738e073.png)

我可以使用 Freebase 获得类似的里程，但 Google 总是更好。例如，如果它是音乐家，它甚至会拉出即将发生的事件等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:39:26.860

[Freebase 主题 API](https://developers.google.com/freebase/v1/topic-overview)包含您正在寻找的大部分内容。

例如`https://www.googleapis.com/freebase/v1/topic/en/woody_allen`

# tabs - 需要 Yii 中的标签扩展

> ID：14162313
> 
> 赞同：0
> 
> 时间：2013-01-04T17:56:06.043
> 
> 标签：tabs, yii

我想在基于 Yii 的项目中将 3 个 div 显示为表格框。

Yii 框架有内置的 Tabs 扩展吗？还是我必须为此编写自己的扩展程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:13:43.333

Yii 已经很好地集成了来自 jQuery 的 JUITabs，CJuiTabs 小部件：[http ://www.yiiframework.com/doc/api/1.1/CJuiTabs](http://www.yiiframework.com/doc/api/1.1/CJuiTabs)

# git - zsh 过分热心地尝试将功能更正为功能

> ID：14162322
> 
> 赞同：7
> 
> 时间：2013-01-04T17:56:57.550
> 
> 标签：git, zsh, git-flow

我正在使用 git 和 zsh。我们的老板正在使用 git-flow。Zsh 一直问我是否将“功能”错误地输入为“功能”。一位同事出于这个原因停止使用 zsh，我们必须解决这个问题，让他重新回到 zsh 的光中！

```
rainbow@pony:~/ruby-project-9000 (*) (!)
> git push origin feature/power_level
zsh: correct 'feature/power_level' to 'features/power_level' [nyae]? n 
```

* * *

## 更新：*完全禁用自动更正*

就像在接受的答案中一样，它**只是***correct_all*，但是禁用 zsh 自动更正的语法因更新而异。以下应该是一个全面的：

```
source $ZSH/oh-my-zsh.sh
DISABLE_CORRECTION="true"
unsetopt correct
unsetopt correct_all 
```

DISABLE_CORRECTION="true" - 目前对我有用，[从这里学到的](http://yountlabs.com/blog/2010/11/06/disable-autocorrect-in-zsh/)

* * *

## 更新：*禁用特定命令的自动更正*

要专门禁用它自动更正命令，但不幸的是不是“功能”，因为它是一个目录（感谢下面的答案！），请参阅[此解决方案以排除命令](https://gist.github.com/vitormil/4364864)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T17:59:39.060

完全关闭功能：

```
unsetopt correct_all 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-25T14:28:27.913

问题（正如@ZyX 所暗示的那样）是您的 git flow 功能分支根目录和称为 features 的 Cucumber 测试文件夹具有相似的名称。Zsh 认为它们足够接近以至于这是一个错字。

您有两个选择 - 为您的功能分支使用不同的名称（当您`git flow init`）为您的 Cucumber 测试使用不同的文件夹名称。

我选择后者是因为 'git flow init' 对大多数人来说是相对自动的，Cucumber 测试位置通常由代码使用，而不是人类，当人们找不到它时，他们会失败（即他们必须寻找测试）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-16T16:32:18.040

使用最新版本，`unsetopt correct_all`不起作用。它是相反的`unsetopt correct`。更好的解决方案是`DISABLE_CORRECTION="true"`在 ~/.zshrc 文件中

# objective-c - 使用 XMLParser 访问正确的 XML 节点

> ID：14162325
> 
> 赞同：1
> 
> 时间：2013-01-04T17:56:59.930
> 
> 标签：objective-c, ios, xml, xml-parsing, nsxmlparser

我无法访问 XML 的节点：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
    <array>
      <dict>
        <key>cnt_id</key>
        <string>lovenyc</string>
        <key>user</key>
        <string></string>
        <key>emps_cnpj</key>
        <string>11379404000154</string>
        <key>depto_id</key>
        <string>0</string>
        <key>id_device</key>
        <string>7543AF5F-495D-4739-BB83-56BF08CE7DF0</string>
        <key>data_acesso</key>
        <string>2013-01-04 12:48:21</string>
        <key>id_usuario</key>
        <string></string>
        <key>user_fav</key>
        <string>0</string>
        <key>user_like</key>
        <string>0</string>
        <key>user_lat</key>
        <string></string>
      </dict>
    </array>
 </plist> 
```

目标c代码：

```
-(void) parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)
namespaceURI qualifiedName:(NSString *) qName attributes:(NSDictionary *)attributeDict
{
    NSMutableDictionary * dict = [[NSMutableDictionary alloc]init];
    _xmlObjects = [[NSMutableArray alloc]init];

    NSLog(@"Attribute %@",[attributeDict allKeys]);
    NSLog(@"Attribute Values %@",[attributeDict allValues]);
} 
```

日志总是给我空值，例如，我无法访问该`<string>`值，有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:17:57.650

使用 Foundation 对象解析属性列表是一项微不足道的单行任务：

```
NSArray *array = [NSArray arrayWithContentsOfFile:@"PropList.plist"]; 
```

[文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html#//apple_ref/doc/uid/20000137-CBHBIGBI)中的更多信息。

（请注意，您必须使用正确的类 - 如果属性列表的根对象是`<dict>`，那么您应该使用`+ [NSDictionary dictionaryWithContentsOfFile:]`。）

# java - JRuby 等价于 Java 代码

> ID：14162331
> 
> 赞同：-2
> 
> 时间：2013-01-04T17:57:24.157
> 
> 标签：java, jruby

我如何在 JRuby 中表达这个 java 代码：

```
 // Convert the store to a certificate chain
            CertStore store = response.getCertStore();
            Collection<? extends Certificate> certs = store
                    .getCertificates(null);
            Certificate[] chain = new Certificate[certs.size()];

            int i = 0;
            for (Certificate certificate : certs) {
                chain[i++] = certificate;
            } 
```

我在 JRuby 中有“商店”，它被认为是一个集合。

例如

```
puts store.type 
#Collection 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T11:05:16.397

好的，这里的问题是我传入的是正则表达式而不是 CertSelector 对象。

此代码现在按预期工作。

```
store.get_certificates(nil) 
```

# jquery - 如何通过 CodeIgniter 集成 keyup() 来制作字符计数器？

> ID：14162333
> 
> 赞同：0
> 
> 时间：2013-01-04T17:57:26.170
> 
> 标签：jquery, codeigniter, keyup

我目前正在构建我的网站部分，用户可以在其中编辑他们的个人资料。在他们填写信息的每个类别中，都有一个文本区域，其中包含允许他们输入的字符数。我试图让数字在他们输入时倒计时。基本键。如何以及如何将此功能集成到代码点火器中？代码点火器是否为此提供了帮助程序？我对这一切都很陌生。

这是我试图将其应用于的代码：

```
<div class="edit_section_title">

            My Life <br /><span class="edit_section_sub">Tell us a about yourself <span class="edit_sub_text">(1350 character limit)</span>
        </div>
        <div class="edit_text_area">

        <?php
        if(empty($user['mylife']))
        {
            echo form_textarea('mylife');
        }
        else
        {
            echo form_textarea('mylife', $user['mylife']);
        }

        ?>  

        </div>
        <div class="edit_section_title">
            Occupation <br /><span class="edit_sub_text">(200 character limit) 
        </div>
        <div class="edit_input_area">
            <?php 

            if(empty($user['occupation']))
            {
                echo form_textarea('occupation');
            }
            else
            {
                echo form_textarea('occupation', $user['occupation']);
            }

            ?>
        </div>

thanks in advance 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:36:14.247

我会使用 keydown 事件，它会产生一个响应更快的 gui。

[http://jsfiddle.net/9BfR2/4/](http://jsfiddle.net/9BfR2/4/)

html:

```
<textarea data-max-length="1350" data-target="#theinput"></textarea>
<input size="4" id="theinput">​ 
```

javascript:

```
var timer;
$("textarea[data-max-length]").on("keydown cut paste input",function(){
    var self = $(this), 
        maxlength = $(this).data("maxLength"), 
        target = $( $(this).data("target") )[0];
    clearTimeout(timer);
    timer = setTimeout(function(){
        if (self.val().length > maxlength) {
            self.val(self.val().substr(0, maxlength));
        }
        target.value = maxlength - self.val().length;
    },0);
}).triggerHandler("keydown");​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:23:16.907

如果您正在寻找 jQuery 解决方案，您可以使用这些方法。例如，对于您的问题中显示的`textarea`属性`name`设置为。`myLife`

```
<textarea name="myLife"></textarea​​​​​​​​​​​&gt; 
```

1.  将`maxlength`属性添加到您的`textarea`. 这将指示浏览器将最大字符数限制为给定大小。

    ```
    <textarea name="myLife" maxlength="1350"></textarea​​​​​​​​​​​&gt; 
    ```

2.  添加一个带有`data-limit-for`属性的元素来保存剩余的字符数。的值是您要将其链接到的元素`data-limit-for`的`name`属性值。`textarea`在我们的例子中，它是`myLife`。

    ```
    <span data-limit-for="myLife">200</span> characters left 
    ```

3.  使用以下脚本更新`span`每个笔划的元素。该脚本将应用于任何`textarea`具有`maxlength`属性和具有链接到它的属性的`span`元素。`data-limit-for`

    ```
    $(function() {
        $("textarea[maxlength]").each(function() {
            var $this = $(this);
            var maxlength = $this.attr("maxlength");
            var $span = $("[data-limit-for=" + $this.attr("name") + "]");
            $this.on("keyup blur", function() {
                $span.text(maxlength - $this.val().length);
            });
        });
    });​ 
    ```

`textarea`您可以对其他或`input`元素重复步骤 #1 和 #2 。

[**看这里。**](http://jsfiddle.net/B9W3f/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:01:19.703

这应该适用于基本思想：

```
<script>
  $(function(){
    $(".edit_text_area textarea").keyup(function(){
     if($(this).val().length > 1350){
        $(this).val($(this).val().substr(0, 1350));
    }
  });
</script> 
```

或者使用它：

```
$(function(){
        $(".edit_text_area textarea").prop('maxlength',1350);
      }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T18:21:57.080

试试这个：

```
$('#a').keypress(function(e) { // you can give your textarea id here #yourid
    var count = 1350; // <----------max character limit
    var a = parseInt(count - $(this).val().split('').length);//<-- counting the characters
    if (a == 0) { // <----- if limit exceeds stop the keypress event.
      e.preventDefault();
      alert('character limit exceeded.'); // <---and alert the msg.
    }
    $('span').html(a);// <--- shows the characters left
}); 
```

在小提琴中找到这个：http: [//jsfiddle.net/f2hqt/1/](http://jsfiddle.net/f2hqt/1/)

这只是一个基本的想法。

试试看这是否对你有帮助。

# c++ - 计算 pi 的位数

> ID：14162335
> 
> 赞同：4
> 
> 时间：2013-01-04T17:57:39.007
> 
> 标签：c++, floating-point, gmp, pi, arbitrary-precision

我使用 GMP 库和 C++ 编写了 Gauss-Legendre 算法的实现来计算 pi 的位数。

它有正确的输出，但问题是我不知道输出在什么时候“变坏”，因为我必须在代码中指定精度。

这是使用 64 位精度的输出：3.141592653589793238* *35* *，最后两位数不正确。

我的问题是，如果我想要*n*位的 pi，需要多少位精度*b*以及算法*i*需要多少次迭代？

谢谢你

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-04T18:29:41.973

Gauss-Legendre 算法（又名 AGM 算法）需要全程精确。

与牛顿法迭代不同，AGM 迭代不是自校正的。因此，您从一开始就需要完全精确。此外，您需要额外的保护数字。

> 我的问题是，如果我想要`n`pi 的数字，需要多少位精度`b`？

首先，您需要将`n`（十进制）数字转换为`b`二进制位。所以那将是：

```
 log(10)
b = n ---------- + epsilon
        log(2) 
```

`epsilon`保护位数在哪里。您需要多少取决于实现和舍入行为，但通常 100 位对于任何 # 次迭代都绰绰有余。

至于你需要多少次迭代。这可以通过经验证据找到。

这是我编写的一个小应用程序的输出，它使用 Gauss-Legendre 算法将 Pi 计算到 1 亿位：

```
================================================================
Computing pi to 100000000 digits:
Threads: 8

Starting AGM...         1.394965 seconds
Starting Iteration 0...    -3 (error in decimal digits)
Starting Iteration 1...    -9
Starting Iteration 2...    -20
Starting Iteration 3...    -42
Starting Iteration 4...    -85
Starting Iteration 5...    -173
Starting Iteration 6...    -347
Starting Iteration 7...    -696
Starting Iteration 8...    -1395
Starting Iteration 9...    -2792
Starting Iteration 10...    -5586
Starting Iteration 11...    -11175
Starting Iteration 12...    -22352
Starting Iteration 13...    -44706
Starting Iteration 14...    -89414
Starting Iteration 15...    -178829
Starting Iteration 16...    -357661
Starting Iteration 17...    -715324
Starting Iteration 18...    -1430650
Starting Iteration 19...    -2861302
Starting Iteration 20...    -5722607
Starting Iteration 21...    -11445216
Starting Iteration 22...    -22890435
Starting Iteration 23...    -45780871
Starting Iteration 24...    -91561745
Starting Iteration 25...    -183123492
AGM:                    118.796792 seconds
Finishing...            3.033239   seconds
Radix Conversion...     2.924844   seconds

Total Wall Time:        126.151086 seconds

CPU Utilization:        495.871%
CPU Efficiency:         61.984%

Writing to "pi.txt"...  Done 
```

So 25 iterations is sufficient for 183 million digits. Likewise, it doubles with each iteration, so you can run some basic logarithm math to figure out how many iterations you need.

# ruby-on-rails-3 - Rails 3 Factory Girl + 多对多关系

> ID：14162344
> 
> 赞同：6
> 
> 时间：2013-01-04T17:58:11.070
> 
> 标签：ruby-on-rails-3, many-to-many, factory-bot

目前没有任何使用 Factory Girl 4.1 的最新答案（我可以找到） - 您如何在工厂内部设置多对多关系？

例如，我有**学生**和**教室**，它们使用连接表处于多对多关系，到目前为止，我有以下设置：

```
factory :classroom do
    name "Foo Class"
    ...
end

factory :student do
   name "John Doe"
   ...
end

factory :student_with_classroom, :parent => :student do
    after(:build) {|student| student.classrooms << classroom}
end 
```

然而，这会导致：

```
NameError:
       undefined local variable or method `classroom' for #<FactoryGirl::SyntaxRunner> 
```

我的尝试在很大程度上是猜测，因为我没有找到任何不推荐使用的语法来完成此操作。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-04T18:51:01.153

实际上，我设法找到了我一直在寻找的答案，隐藏在这个 SO 中的大量其他答案之下：[如何在工厂女孩中创建 has_and_belongs_to_many 关联](https://stackoverflow.com/questions/1484374/how-to-create-has-and-belongs-to-many-associations-in-factory-girl)

```
factory :classroom do
    name "Foo Class"
    ...
end

factory :student do
   name "John Doe"
   ...
end

factory :student_with_classroom, :parent => :student do
    classrooms {[FactoryGirl.create(:classroom)]}
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T06:17:28.967

查看这篇 SO 帖子：[如何使用 has_many 关联在 FactoryGirl 中设置工厂](https://stackoverflow.com/questions/6963298/how-to-set-up-factory-in-factorygirl-with-has-many-association)。它会将您指向[https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md](https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md)；搜索**has_many**。

# servicebus - 适用于 Windows Server 的服务总线 - 安全性/权限

> ID：14162346
> 
> 赞同：0
> 
> 时间：2013-01-04T17:58:20.413
> 
> 标签：servicebus

我一直在试验 Windows Server 的服务总线。

首先是关于我的环境的一些信息。

我有两个 Windows 7 盒子（我们称它们为主机和客户端）。他们都属于一个工作组（没有域）。每台机器都有两个用户帐户（我们称它们为 Admin 和 User）并且密码匹配。在主机上，管理员帐户被禁用，用户是管理员组的成员。用于 Windows Server 的服务总线安装在主机上。它是由用户帐户安装的。该服务在用户帐户凭据下运行，并且用户被列为 ServiceBusDefaultNamespace 的 ManageUser。

当我在安装了服务总线的同一帐户下在同一台机器上运行它们时，我设法让一个简单的发送器和接收器工作（从 Azure 服务总线示例中破解）。

然后我尝试将发件人复制到客户端并运行它。我在证书方面遇到了一些问题，但我已经解决了这些问题。如果我以用户身份登录客户端，则发件人可以工作。如果我以管理员身份登录客户端，发件人会给我一个 (401) Unauthorized。如果我在主机上启用管理员帐户，那么发件人就可以工作。

以上所有内容都有一定的意义。主机正在尝试对请求进行身份验证，当它发现相应的管理员帐户被禁用时，它会拒绝该请求，但它似乎造成了一点不便，因为它要求我在所有机器上都有活动帐户。

经过更多的挖掘，似乎我应该能够指定帐户。创建 MessagingFactory 时，我正在创建一个 TokenProvider，而 TokenProvider 允许我指定一组不同的凭据。

```
MessagingFactorySettings mfSettings = new MessagingFactorySettings()
{
    TokenProvider = TokenProvider.CreateWindowsTokenProvider( 
        new List<Uri>() { rootAddressManagement }, 
        new NetworkCredential( "Host\\User", "<User's Password>" ) )
}; 
```

但我仍然得到401。

我想我想弄清楚如何在不同的机器上运行（可能）多个发件人，而不需要发件人可能在主机上运行的每个帐户都具有活动帐户。即使在基于域的环境中，如果发件人正在运行的域帐户没有访问主机的权限，我似乎也会遇到这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T22:32:56.487

对于工作组机器，在指定网络凭据时，不要添加主机名，只添加用户。这应该让您的请求得到正确的身份验证：

```
MessagingFactorySettings mfSettings = new MessagingFactorySettings()
{
    TokenProvider = TokenProvider.CreateWindowsTokenProvider( 
        new List<Uri>() { rootAddressManagement }, 
        new NetworkCredential( "User", "<User's Password>" ) )
}; 
```

如果您仍然遇到问题，这个[其他线程有更多关于设置的信息。](https://stackoverflow.com/questions/12462894/connecting-to-windows-server-service-bus-on-aws)

# mysql - 根据主表中列的值连接表

> ID：14162348
> 
> 赞同：0
> 
> 时间：2013-01-04T17:58:28.757
> 
> 标签：mysql, join

```
notificationTable
ID              type        typeID      userID
==============================================
1               comment     34          2
2               accept      22          2

eventTable
ID              event       content
===================================
21              post        34  
22              accept      22

commentTable
ID              comment     eventID
===================================
34              'test'      21 
```

我想根据列类型的值加入不同的表。这是我当前的伪代码：

```
SELECT *
FROM notificationTable notification
IF (notification.type == 'comment')
    LEFT JOIN commentTable comment
    ON notification.typeID = comment.ID
ELSEIF (notification.type == 'accept')
    LEFT JOIN evenTable event
    ON notification.typeID = event.ID
WHERE notification.userID = 2 
```

有人知道我的意图的真正查询吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:01:28.770

就像是

```
SELECT *
FROM notificationTable notification   
LEFT JOIN commentTable comment
ON (notification.typeID = comment.ID AND notification.type == 'comment')
LEFT JOIN evenTable event
ON (notification.typeID = event.ID AND notification.type == 'accept')
WHERE notification.userID = 2 
```

但我强烈建议重新设计您的系统以避免多态关系......

# c# - Silverlight UI 效果

> ID：14162349
> 
> 赞同：-3
> 
> 时间：2013-01-04T17:58:31.997
> 
> 标签：c#, silverlight, user-interface, silverlight-5.0

我想用 Silverlight 构建一个漂亮的 UI，以一种微妙的方式不断移动（[比如这个介绍](http://demos.telerik.com/silverlight/)）

我当然知道这可以通过 Silverlight 的动画功能实现，但在我看来它们有点太累人了。我正在寻找一些现成的 UI 动画。

我记得，jquery 提供了很多非常易于使用的 UI 菜单（等等）。

我已经搜索了很多效果库或教程，但找不到任何有用的东西。

我唯一的选择是编写故事板并从头开始构建我的动画吗？

这被认为可以吗，或者我只是在这里无缘无故地重新发明轮子？

它是否使 jquery 成为花哨的 UI Web 应用程序的更好选择？（我没用过，随便看看）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:32:43.040

故事板和动画并不难学。起初它们令人生畏（因为它们可能很冗长），但如果你只是花一些时间来理解它们，它们就相当直截了当。您可以尝试一些第三方控制套件，例如 Telerik，它们具有一些动画/过渡功能，但我建议您深入了解它们的工作原理。

尝试学习动画的最佳方法是首先考虑您想做什么（简单的事情），然后研究/弄清楚。谷歌非常适合这个！当然首先要做一些简单的事情。

在 microsoft 查看示例 Silverlight 动画浏览器以开始使用...[示例动画](http://samples.msdn.microsoft.com/Silverlight/SampleBrowser/index.htm#/?sref=animation_ovw_intro)

# java - 在 Java 中创建资源时如何正确锁定资源

> ID：14162353
> 
> 赞同：4
> 
> 时间：2013-01-04T17:58:52.213
> 
> 标签：java, initialization, java.util.concurrent

我有这个创建对象的单例，目前它看起来像这样：

```
public ApplicationManagerSingleton {
    ....
    private Map<String, Thing> map = new HashMap<String, Thing>();

    public Thing getThingById( String id ) {
       Thing t = null;
       if ( !map.contains(id) ) {
        t = longAndCostlyInitializationOfThing();
        map.put(id, t );
       }
       return map.get(id);
     }
 } 
```

它的一个明显问题是，如果两个线程试图访问同一个东西，它们最终可能会复制这个东西。

所以我用了一个锁：

```
 public ApplicationManagerSingleton {
      private Map<String, Thing> map = new HashMap<Sring, Thing>();
      public Thing getThingById(String id ) {
          synchronized( map ) {
             if (!map.contains(id)) {
                 t = initialize....
             }
             map.put(id, t);
           }
           returns map.get(id);
      }
 } 
```

但现在这是最糟糕的，因为每次创建新资源时我都会锁定地图一段时间，因为其他线程想要不同的东西。

我很确定使用 Java 5 并发包会更好。有人可以指出我正确的方向吗？

我要避免的是锁定对其他事物感兴趣的其他线程的类或映射。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:15:57.543

如果您想防止多次创建该项目也尽可能少地阻止，我会使用两个地图。一个用于持有一组锁以在创建对象时使用，一个用于持有对象。

考虑这样的事情：

```
private ConcurrentMap<String, Object> locks = new ConcurrentHashMap<String, Object>();
private ConcurrentMap<String, Thing> things = new ConcurrentHashMap<String, Thing>();

public void Thing getThingById(String id){
    if(!things.containsKey(id)){        
      locks.putIfAbsent(id, new Object());
      synchronized(locks.get(id)){
         if (!things.containsKey(id)){
             things.put(id, createThing());
         }
      }
    }

    return things.get(id);
} 
```

这只会阻止多个线程尝试获取相同的密钥，同时防止`Thing`为同一密钥创建两次。

**更新**

番石榴缓存示例移至新答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T18:32:14.157

也许 ConcurrentHashMap 可以帮助你。顾名思义，它支持并发修改。

要只创建一次新元素，您可以执行以下操作：

```
private Map<String,Thing> map = new ConcurrentHashMap<>();
private final Object lock = new Object();
public Thing getById(String id) {
  Thing t = map.get(id);
  if (t == null) {
    synchronized(lock) {
      if (!map.containsKey(id)) {
        t = //create t
        map.put(id, t);
      }
    }
  }
  return t;
} 
```

一次只允许一个线程创建新内容，但对于现有值，没有任何锁定。

如果您想完全避免锁定，则必须使用 2 个映射，但它会有些复杂，只有当您真的希望许多线程不断填充映射时才值得。对于这种情况，最好将 FutureTasks 与线程池一起使用来异步创建对象，从而最大限度地减少锁定到位的时间（您仍然需要一个锁定，以便只有一个线程创建新元素）。

代码将是这样的：

```
private Map<String,Future<Thing>> map = new ConcurrentHashMap<>();
private final Object lock = new Object();
ExecutorService threadPool = ...;
public Thing getById(String id) {
  Future<Thing> t = map.get(id);
  if (t == null) {
    synchronized(lock) {
      if (!map.containsKey(id)) {
        Callable<Thing> c = //create a Callable that creates the Thing
        t = threadPool.submit(c);
        map.put(id, t);
      }
    }
  }
  return t.get();
} 
```

锁只会在创建 Callable、将其提交到线程池以获取 Future 并将该 Future 放入映射所需的时间内到位。Callable 将在线程池中创建元素，当它返回元素时，Future 的 get() 方法将解锁并返回其值（对于任何正在等待的线程；后续调用不会锁定）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T20:27:50.420

在调查之后，我认为这`Guava's` `LoadingCache`可能是一个非常好的解决方案。默认情况下，`CacheBuilder`将创建一个不执行任何驱逐的缓存（因此它只是一个映射），并且在加载已内置的键时具有线程阻塞。

[加载缓存](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/cache/LoadingCache.html)

[缓存生成器](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/cache/CacheBuilder.html)

```
 private Cache<String, Thing> myCache;

 MyConstructor(){
    myCache = CacheBuilder.newBuilder().build(
       new CacheLoader<String, Thing>() {
         public Thing load(String key) throws AnyException {
           return createExpensiveGraph(key);
         }
        });
 }

  public void Thing getThingById(String id){
    return myCache.get(id);
  } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T18:10:27.423

您可以立即在地图中插入轻量级代理。一旦初始化，代理将委托给真实对象，但在此之前一直阻塞。一旦实体`Thing`被初始化，它就可以替换地图中的代理。

```
private Map<String, Thing> map = new ConcurrentHashMap<>();

public Thing getThingById(String id) {
    ThingProxy proxy = null;
    synchronized (map) {
        if (!map.containsKey(id)) {
            proxy = new ThingProxy();
            map.put(id, proxy);
        }
    }
    if (proxy != null) {
        proxy.initialize();
        map.put(id, proxy.getRealThing());
    }
    return map.get(id);
}

private class ThingProxy implements Thing {

    private Thing realThing;
    private CountDownLatch countDownLatch = new CountDownLatch(1);

    @Override
    public void someMethodOfThing() {
        try {
            countDownLatch.await();
            realThing.someMethodOfThing();
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }

    public void initialize() {
        realThing = longAndCostlyInitializationOfThing();
        countDownLatch.countDown();
    }

    public Thing getRealThing() {
        return realThing;
    }
} 
```

这会锁定在地图上，但只是短暂地创建代理并在需要时放置它。

代理的代码可能会变得很费力，在这种情况下，您最好使用反射创建代理（请参阅 参考资料[`java.lang.reflect.Proxy`](http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html)）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-04T18:12:44.557

你可以使用一个`ConcurrentHashMap`. 这个可以被多个线程访问而没有问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T20:55:33.960

我尝试了这些解决方案，但它们在我的实施中的某个时候失败了，并不是说它们在其他场景中不起作用。

我最终做的是使用[ConcurrentMap](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentMap.html#putIfAbsent%28K,%20V%29)检查资源是否已被请求。如果没有，它会被创建并存储在其他地方。

```
... 
import java.util.concurrent.ConcurrentMap;
import java.util.concurrent.ConcurrentHashMap;

... 
private ConcurrentMap<String, Boolean> created = new ConcurrentMap<>();
....
if ( created.putIfAbsent( id, Boolean.TRUE ) == null ) {
    somewhereElse.put( id, createThing() );
} 
```

# c# - 将货币字符串转换为十进制？

> ID：14162357
> 
> 赞同：62
> 
> 时间：2013-01-04T17:58:57.920
> 
> 标签：c#, .net, type-conversion

## 客观的

对在一组数据中以数字`string`方式显示这样的货币数据的 a 进行排序。`$1,995.94`

## 代码

我目前正在使用下面的代码示例将`string`值转换为，`decimal`以便我可以对其进行正确排序。

```
if (sortBy == "checkAmount")
{
    StringBuilder sb = new StringBuilder();
    foreach (var c in Convert.ToString(p.GetType().GetProperty(sortBy).GetValue(p, null)))
    {
        if (!char.IsDigit(c) && c != '.') { continue; }
        sb.Append(c);
    }
    return Convert.ToDecimal(sb.ToString());
}
else
{
    return p.GetType().GetProperty(sortBy).GetValue(p, null);
} 
```

## 问题

有什么更好的方法来做到这一点？它有效，这很酷，但它不是很优雅。

## 最终解决方案

[Servy 提供](https://stackoverflow.com/q/14162357/1011722) 的答案按**预期工作**，我使用了该实现一段时间，但我和一位同事找到了更好的方法，所以我在这里记录它。***顺便说一句，我最终使用了这个解决方案。***

```
decimal.Parse(input, NumberStyles.AllowCurrencySymbol | NumberStyles.Number); 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-04T18:03:04.857

这个怎么样，但只适用于一个字符串值。所以你需要得到你的字符串`split`，`$`然后在保存到`array`或的同时进行转换`list`

```
 using System.Globalization;
    //rest of your code

          string str = "$50,550.20";
          decimal decval;
          bool convt = decimal.TryParse(str, NumberStyles.Currency,
            CultureInfo.CurrentCulture.NumberFormat, out decval);
          if (convt) 
          Console.WriteLine(decval);
          Console.ReadLine(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-10-06T13:11:38.363

这是一个更简单的解决方案：

```
 public static decimal ToDecimal(this string str)
    {
        return decimal.Parse(str, NumberStyles.Currency);
    } 
```

和单元测试：

```
 [Test]
    public void ToDecimal_Convert_String_To_Decimal()
    {
        Assert.AreEqual(1234M, "1234".ToDecimal());
        Assert.AreEqual(-1234.56M, "$(1,234.56)".ToDecimal());
        Assert.AreEqual(1234.56M, "$1,234.56".ToDecimal());
    } 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-01-04T18:07:45.197

这是一种与您提供的代码最相似的方法

```
public static decimal Parse(string input)
{
    return decimal.Parse(Regex.Replace(input, @"[^\d.]", ""));
} 
```

这是一个支持负数的选项，如果找到第二个句点值，它将停止，从而减少它返回的无效`decimal`值字符串的数量。它还有一些在 OP 中看不到的其他修改来处理当前代码没有的其他情况。

```
public static decimal Parse(string input)
{
    return decimal.Parse(Regex.Match(input, @"-?\d{1,3}(,\d{3})*(\.\d+)?").Value);
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-01-20T12:06:30.767

```
decimal amount = decimal.Parse("$123,456.78",
NumberStyles.AllowCurrencySymbol |
NumberStyles.AllowThousands |
NumberStyles.AllowDecimalPoint); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-26T11:01:20.037

**适用于所有文化：**

```
var d = decimal.Parse("$497.7", NumberStyles.Currency, CultureInfo.CreateSpecificCulture("us-US").NumberFormat);    

Console.WriteLine(d); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-14T08:59:31.243

```
public static decimal ToDecimalFromStringDecimalOrMoneyFormattedDecimal(this string s)
{
    try
    {
        return decimal.Parse(s);
    }
    catch
    {
        var numberWithoutMoneyFormatting = Regex.Replace(s, @"[^\d.-]", "");
        return decimal.Parse(numberWithoutMoneyFormatting);
    }
}

[Test]
public void Test_ToDecimalFromStringDecimalOrMoneyFormattedDecimal()
{
    Assert.That("$ 500".ToDecimalFromStringDecimalOrMoneyFormattedDecimal() == (decimal)500);
    Assert.That("R -500".ToDecimalFromStringDecimalOrMoneyFormattedDecimal() == (decimal)-500);
    Assert.That("-$ 500".ToDecimalFromStringDecimalOrMoneyFormattedDecimal() == (decimal)-500);
    Assert.That("P 500.90".ToDecimalFromStringDecimalOrMoneyFormattedDecimal() == (decimal)500.9);
    Assert.That("$ -50 0,090,08.08".ToDecimalFromStringDecimalOrMoneyFormattedDecimal() == (decimal)-50009008.08);
} 
```

# java - 为什么 Netbeans Ant 使用正确的 jar 编译但使用旧 jar 构建？

> ID：14162364
> 
> 赞同：0
> 
> 时间：2013-01-04T17:59:28.687
> 
> 标签：java, ant, build, jar, netbeans-7

我有一个项目“A”，它的库中有另一个项目“B”。Netbeans 编译项目“A”并说没有错误，但是当我去清理和构建项目“A”时，会转到项目“B”的旧版本。我已经清理并构建了项目“B”，然后清理并构建了项目“A”，但“A”仍然无法认为它正在使用旧的“B”。我试图弄清楚为什么 Netbeans 的 Ant 使用正确的项目“B”-dist/jar 进行编译，但使用旧的项目“B”jar 进行构建。“A”库中的其他罐子都没有“B”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T19:48:50.350

我发现解决此问题的方法是右键单击 netbeans 中的库文件夹并转到属性。有几个项目和 jars 以红色列出，并且没有显示在导航中，我删除了那些然后找出我需要哪些 jars/项目并将它们添加回项目“A”的库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:17:28.000

您指定的`build.xml`类路径与 Netbeans 中的项目类路径是分开的。显然后者是正确的，前者是错误的。您可以通过编辑您的`build.xml`.

# java - SharedPreferences 不存储数据并返回 NullPointerException

> ID：14162368
> 
> 赞同：0
> 
> 时间：2013-01-04T17:59:38.177
> 
> 标签：java, android, sharedpreferences

我在我的应用程序中使用一个类来创建一个会话，以便我可以在活动等之间存储一个移动变量。所以我有一个特定的类可以`SharedPrefrences`用来做到这一点。

我也有一个谷歌地图，上面有叠加层和项目。我的目的是能够在`onTap`事件发生时存储一些地理位置信息。

为此，我在我的`SessionManager`班级（使用 SharedPrefrences）中创建了第二个 void，我在`onTap`事件中调用它。问题是我面临一个`NullPointerException`. void 内的变量是从地图中正确收集的，并且不为空。这是在 onTap 事件中：

```
GeoPoint mPoint;
  OverlayItem item = mOverlays.get(index);
  mPoint = item.getPoint();

session.mapInputs(Double.toString(mPoint.getLatitudeE6()/1E6), Double.toString(mPoint.getLongitudeE6()/1E6); 
```

当我打电话时`mapInputs()`面对`NullPointerException`。我不确定获得 a 的所有原因是什么`NullPointerException`，Double 检查了在 void 中传递的变量，它们不是空的。我也尝试用 新建一个类`SharedPrefrences`，但同样的问题又出现了。

所以我无法弄清楚我做错了什么..

这是我的 Logcat 错误（MapFeeder 中的第 60 行是 mapInputs void）：

```
01-04 15:47:37.999: E/AndroidRuntime(308): FATAL EXCEPTION: main
01-04 15:47:37.999: E/AndroidRuntime(308): java.lang.NullPointerException
01-04 15:47:37.999: E/AndroidRuntime(308):  at        com.cabman.lol.ok.MapFeeder.onTap(MapFeeder.java:60)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.google.android.maps.ItemizedOverlay.onTap(ItemizedOverlay.java:453)
01-04 15:47:37.999: E/AndroidRuntime(308):  at  com.google.android.maps.OverlayBundle.onTap(OverlayBundle.java:83)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.google.android.maps.MapView$1.onSingleTapUp(MapView.java:347)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.google.android.maps.GestureDetector.onTouchEvent(GestureDetector.java:533)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.google.android.maps.MapView.onTouchEvent(MapView.java:647)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.view.View.dispatchTouchEvent(View.java:3766)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:897)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-04 15:47:37.999: E/AndroidRuntime(308):  at     android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:936)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1671)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1107)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.app.Activity.dispatchTouchEvent(Activity.java:2086)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1655)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1785)
01-04 15:47:37.999: E/AndroidRuntime(308):  at    android.os.Handler.dispatchMessage(Handler.java:99)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.os.Looper.loop(Looper.java:123)
01-04 15:47:37.999: E/AndroidRuntime(308):  at android.app.ActivityThread.main(ActivityThread.java:4627)
01-04 15:47:37.999: E/AndroidRuntime(308):  at java.lang.reflect.Method.invokeNative(Native Method)
01-04 15:47:37.999: E/AndroidRuntime(308):  at java.lang.reflect.Method.invoke(Method.java:521)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-04 15:47:37.999: E/AndroidRuntime(308):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-04 15:47:37.999: E/AndroidRuntime(308):  at dalvik.system.NativeStart.main(Native Method) 
```

这也是我的 SessionManger 课程的一部分：

```
public class SessionManager {

SharedPreferences pref;

Editor editor;

Context context;

int PRIVATE_MODE = 0; 
```

……

```
 public SessionManager(Context context){

    this.context = context;
    pref = context.getSharedPreferences(PREF_NAME,PRIVATE_MODE);
    editor = pref.edit();
} 
```

……

```
 public void mapInputs(String startLat,  String startLon ){

editor.putString(KEY_LAT, startLat);
editor.putString(KEY_LON, startLon);
editor.commit(); 
```

}

# jquery - Blueimp 文件上传和 Codeigniter

> ID：14162380
> 
> 赞同：0
> 
> 时间：2013-01-04T18:00:35.087
> 
> 标签：jquery, jquery-ui, codeigniter, blueimp

当我创建一个名为 utils 的非 CI 目录并将 server/php 代码放入其中并从 CI 控制器调用它时，一切正常。我动态地更改上传目录，这也有效。完成时返回的 json 如下：

```
{
    "files": [{
        "name": "pob1.pptx",
        "size": 2234155,
        "type": "application\/vnd.openxmlformats-officedocument.presentationml.presentation",
        "url": "https:\/\/www.myurl.com\/media\/ppt\/1\/pob1.pptx",
        "delete_url": "https:\/\/www.myurl.com\/media\/ppt\/1\/?file=pob1.pptx",
        "delete_type": "DELETE"
    }]
} 
```

* * *

当我将 UploadHandler.php 复制到库文件夹并使用控制器启动文件上传时，它也可以工作，并且我按预期将文件上传到我的自定义目录。但奇怪的是系统正在返回附加到第一个 json 文件的第二个 json 文件，并且它抛出“json 文件结束后的无效字符”错误。Json 文件如下：

```
{
    "files": [{
        "name": "pob1.pptx",
        "size": 2234155,
        "type": "application\/vnd.openxmlformats-officedocument.presentationml.presentation",
        "url": "https:\/\/www.myurl.com\/media\/ppt\/1\/pob1.pptx",
        "delete_url": "https:\/\/www.myurl.com\/media\/ppt\/1\/?file=pob1.pptx",
        "delete_type": "DELETE"
    }]
} {
    "files": [{
        "name": "pob1 (1).pptx",
        "size": 0,
        "type": "application\/vnd.openxmlformats-officedocument.presentationml.presentation",
        "error": "abort",
        "delete_url": "https:\/\/www.myurl.com\/media\/ppt\/1\/?file=pob1%20%281%29.pptx",
        "delete_type": "DELETE"
    }]
} 
```

请注意，这两个在第一部分中是相同的。在 CI 示例中添加了以“文件”属性开头的第二个 json 块。请注意，此实例具有更新的上传文件名，就好像它试图上传两次一样。这可能是什么原因造成的？CI实施中有什么？

有任何想法吗？这非常接近成为一个很棒的 Codeigniter 解决方案。

这是带有 jQ​​uery 1.8.3 和 jquery-ui 1.9.2 的全新 Blueimp 6.1，尽管我认为除了 UI 考虑之外这并不重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T08:11:27.520

我发现我正在调用提交方法并没有关闭初始化功能。我的错。问题解决了。

# objective-c - 检测已“擦除”的绘制图像的百分比

> ID：14162382
> 
> 赞同：0
> 
> 时间：2013-01-04T18:00:42.483
> 
> 标签：objective-c, ios, graphics, drawing

假设我在 iOS 的屏幕上有一个实心、不规则形状（但封闭）的形状（一种颜色）。然后，我想通过拖动手指来“擦除”该形状的部分，就像在典型的儿童着色应用程序中一样，在我触摸屏幕的地方用固定的画笔大小擦除。

我可以使用图像遮罩和触摸检测之类的方法轻松完成所有这些操作，但是，作为要求，我还需要确定剩余形状的粗略百分比。

例如，我需要知道 50% 的随机封闭形状何时被“擦除”。

解决这个问题的最佳方法是什么？是否有任何现有的 iOS 兼容库可以处理它？我在想我需要跟踪大量多边形并计算所有重叠，但似乎必须有解决这个问题的方法。

编辑：我已经对此问题进行了研究，但是手动跟踪所有多边形并计算它们的所有位置和区域重叠似乎过于复杂。我只是想知道是否有其他人遇到过类似的问题并找到了更好的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:23:27.363

您首先需要知道图像视图的固定空间。那么您将需要知道加载新图像时空白空间的百分比。像素

```
double percentageFilledIn = ((double)nonBlankPixelCount/totalpixels); 
```

获得该值后，您需要将该百分比用作现有百分比的基准

您的新计算将如下所示。

```
double percentageOfImageLeft = ((double)nonBlankPixelCount/totalpixels/percentageFilledIn); 
```

此计算可能会占用大量处理器。我只会谨慎计算。

由于这篇文章不是关于代码，而是关于登录，我将让您确定检测非空白像素的逻辑。

这里是如何找到像素颜色。

[如何在 iOS/ObjectiveC 中获取 TouchPoint 的坐标和 PixelColor](https://stackoverflow.com/questions/10711107/how-to-get-coordinates-and-pixelcolor-of-touchpoint-in-ios-objectivec)

祝你好运。

# android - 服务器拒绝连接

> ID：14162385
> 
> 赞同：0
> 
> 时间：2013-01-04T18:00:57.687
> 
> 标签：android, http

我正在使用 HTTP 后连接，并且我的应用程序会定期连接到服务器。在某个点之后，我无法连接到服务器，并且我的所有连接都出现以下异常：

java.net.ConnectException;无法连接到 www.somedomain.com/xxx.xxx.xxx.x（端口 80）：连接失败：ENETUNREACH（网络无法访问）

org.apache.http.conn.HttpHostConnectException;连接到[http://www.somedomain.com](http://www.somedomain.com)被拒绝

java.net.UnknownHostException;无法解析主机“www.somedomain.com”：没有与主机名关联的地址

我怀疑服务器可能会在某个时间点后阻止我。任何想法为什么会发生这种情况？重新安装应用程序后，连接仍然被阻止。

编辑：这是发送http请求的代码

```
public String send() throws ClientProtocolException, IOException {
    InputStream is = null;
    DefaultHttpClient httpclient = null;
    HttpResponse response = null;
    try {
        System.setProperty("http.keepAlive", "false");
        httpclient = new DefaultHttpClient();
        HttpProtocolParams.setUseExpectContinue(httpclient.getParams(), false);
        HttpRequestRetryHandler retryHandler = new HttpRequestRetryHandler() {

            public boolean retryRequest(IOException exception, int executionCount,
                    HttpContext context) {
                // retry a max of 5 times
                if(executionCount >= 5){
                    return false;
                }
                if(exception instanceof NoHttpResponseException){
                    return true;
                } else if (exception instanceof ClientProtocolException){
                    return true;
                } 
                return false;
            }
        };
        httpclient.setHttpRequestRetryHandler(retryHandler);
        String proxyHost = android.net.Proxy.getDefaultHost();
        int proxyPort = android.net.Proxy.getDefaultPort();
        // Set Proxy params of client, if they are not the standard
        if (proxyHost != null && proxyPort > 0) {
            HttpHost proxy = new HttpHost(proxyHost, proxyPort);
            httpclient.getParams().setParameter(
                    ConnRoutePNames.DEFAULT_PROXY, proxy);
        }
        HttpPost httppost = new HttpPost(url);
        httppost.setEntity(new UrlEncodedFormEntity(qData));
        response = httpclient.execute(httppost);
        is = response.getEntity().getContent();
        return inputStreamToString(is);
    } finally {
        try {
            if (is != null) {
                is.close();
            }
        } catch (Throwable e) {
        }
        try {
            if (response != null && response.getEntity() != null) {
                response.getEntity().consumeContent();
            }
        } catch (Throwable e) {
        }
        try {
            if (httpclient != null
                    && httpclient.getConnectionManager() != null) {
                httpclient.getConnectionManager().shutdown();
            }
        } catch (Throwable e) {
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T11:56:27.240

您可以使用 dig 或 nslookup 来验证 DNS 服务器。您可以在操作系统中配置已知良好的 DNS 服务器，例如 8.8.8.8 。异常错误消息也可能具有误导性：尝试使用wireshark捕获网络流量，然后您将看到DNS查询是否根本没有返回任何内容，“未找到”，或者DNS是否正常，但服务器主机拒绝您的请求。

您还可以通过将 www.somedomain.com 添加到主机文件及其 IP 地址来绕过 DNS 不确定性。

# python - 无法在 Django 应用程序中使用 Python 的 threading.Thread

> ID：14162388
> 
> 赞同：-1
> 
> 时间：2013-01-04T18:01:09.690
> 
> 标签：python, django, multithreading, django-views

我正在尝试创建一个 Web 应用程序作为另一个 Python 应用程序的前端。我让用户在表单中输入数据，提交后，想法是将数据保存在数据库中，并将数据传递给线程对象类。线程是基于用户操作严格启动的。我的问题是我可以导入线程，但无法访问 threading.Thread。当线程结束时，它会更新服务器，所以当用户查看作业信息时，他们会看到结果。

看法：

```
@login_required(login_url='/login')
def createNetworkView(request):
    if request.method == "POST":
        # grab my variables from POST
        job = models.MyJob()
        # load my variables into MyJob object
        job.save()
        t = ProcessJobThread(job.id, my, various, POST, inputs, here)
        t.start()
        return HttpResponseRedirect("/viewJob?jobID=" + str(job.id))
    else:
        return HttpResponseRedirect("/") 
```

我的线程类：

```
import threading # this works
print "About to make thread object" # This works, I see this in the log
class CreateNetworkThread(threading.Thread): # failure here
    def __init__(self, jobid, blah1, blah2, blah3):
        threading.Thread.__init__(self)

    def run(self):
        doCoolStuff()
        updateDB() 
```

我得到：

```
Exception Type: ImportError
Exception Value:    cannot import name Thread 
```

但是，如果我在命令行上运行 python，我可以导入线程，也可以从线程导入线程。这是怎么回事？

我见过其他的东西，比如[如何在 Django](https://stackoverflow.com/questions/2583567/how-to-use-thread-in-django)和[Celery](http://celeryproject.org/)中使用线程，但这似乎有点矫枉过正，而且我看不到该示例如何导入线程并使用 threading.Thread，而我不能。谢谢你。

编辑：我正在使用 Django 1.4.1、Python 2.7.3、Ubuntu 12.10、SQLite 作为数据库，并且我正在使用*./manage.py runserver*运行 Web 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T19:18:49.780

这是我遇到的一个愚蠢的问题。首先，我创建了一个名为“threading.py”的文件，有人建议我删除它，我做了（或认为我做了）。问题是因为我使用 Eclipse，Eclipse 的 PyDev (Python) 插件只删除了我创建的 threading.py 文件，并隐藏了 *.pyc 文件。我有一个挥之不去的 threading.pyc 文件，尽管 PyDev 有一个选项，我已启用删除孤立的 .pyc 文件。

# ios6 - 如何根据 UITextField 中的文本创建 UIAlertView？

> ID：14162391
> 
> 赞同：0
> 
> 时间：2013-01-04T18:01:20.090
> 
> 标签：ios6, uitextfield, uialertview, xcode4.5

我想在文本字段中输入文本并根据文本（如果显示“否”）我希望弹出警报视图。我在界面生成器中创建了一个 UITextField 并将其附加到文件所有者中的 UITextField 委托，这样就可以解决所有问题。但是当我在文本字段中输入文本时，特别是没有，然后单击文本字段或移除键盘，没有弹出警报视图。我在 viewcontroller.m 文件中为此创建了一个完整的方法。这是该方法的代码。

-（无效）参与警报{

```
 if (myTextField.text == @"No") {
      theAlertView = [[UIAlertView alloc] initWithTitle:@"Notice" message:@"MyMessageHere"
      delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil, nil];
      [theAlertView show];
 } 
```

}

我在这里错过了什么吗？当我在文本字段中输入 No 时，什么也没有发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:12:56.227

我认为罪魁祸首将是这条线

```
myTextField.text == @"No" 
```

由于您正在比较两个永远不会匹配的指针。

@"No" = 0x12341234 或 NSString 的静态地址的任何地址（@"" 可以被认为是编译器创建 NSString 对象的简写）

你会想要的是类似的东西

```
if( [myTextField.text isEqualToString:@"No"]) 
```

还要检查你不会用 theAlertView 泄漏内存，因为我看不到你在片段中释放它的位置。

# c# - 以编程方式打印到 PDF 打印机

> ID：14162392
> 
> 赞同：1
> 
> 时间：2013-01-04T18:01:24.913
> 
> 标签：c#, pdf-generation, xps, pdfsharp

我正在寻找一个免费的基于 .Net 的、*最好是 C#*的 pdf 打印机，例如[具有编程访问权限的 CutePDF 的 Custom PDF Writer，](http://www.cutepdf.com/solutions/pdfwriter.asp)它允许我将 xps 文档保存为 pdf 格式。我发现了许多能够将 xps 文档转换为 pdf 格式的替代方案，但它们不是开源的。我很想知道是否有人知道可以让我完成此任务的开源库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T15:18:04.527

对于尝试使用开源方式将 XPS 转换为 PDF 的任何人，我能够使用[PDFSharp 版本 1.31](http://pdfsharp.codeplex.com/releases/view/37054)成功地做到这一点。它成功升级到 .NET 4.5，我将 PdfSharp.Xps 项目包含在我的解决方案中。包含所有参考资料后，您只需要一行来链接到您的 XPS 文件。

`XpsConverter.Convert("D:\\Example\\test.xps");`

注意：还有其他可用的构造函数，但我在示例中使用了最简单的构造函数。

希望这可以帮助！

# java - 在不可编辑的 jcombobox 中更改所选值的颜色

> ID：14162395
> 
> 赞同：-1
> 
> 时间：2013-01-04T18:01:36.317
> 
> 标签：java, swing, jcombobox

如何在不可编辑的 jcombobox 中更改所选值的颜色？

我知道我必须使用自定义渲染器来更改出现在组合框下拉列表中的项目的颜色。我也知道可以与组合框的编辑器组件一起使用的 setForeground() 方法，但这仅适用于可编辑的组合框。我也知道我可以使用 UIManager 类，但这会影响全局的这些属性。

然而，这些都不是我需要的。这个图片

![在此处输入图像描述](../Images/f3389e2377ba2f72bd31aa688db3b824.png)

显示我想要影响的部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:42:21.833

> 如何在不可编辑的 jcombobox 中更改所选值的颜色？

*   改变值`UIManager`

> 这是可编辑的基本解决方法（将背景删除到当前背景，请注意 MetalComboBoxButton 中有快捷方式，然后是外观敏感，仅适用于金属和物质 L&f）

![在此处输入图像描述](../Images/c303cc5132fe4f861abc75bbe8062bd9.png)

```
import java.awt.*;
import java.util.Vector;
import javax.swing.*;
import javax.swing.UIManager;
import javax.swing.plaf.ColorUIResource;
import javax.swing.plaf.metal.MetalComboBoxButton;

public class MyComboBox {

    private Vector<String> listSomeString = new Vector<String>();
    private JComboBox someComboBox = new JComboBox(listSomeString);
    private JComboBox editableComboBox = new JComboBox(listSomeString);
    private JComboBox non_EditableComboBox = new JComboBox(listSomeString);
    private JFrame frame;

    public MyComboBox() {
        //for (int i = 0; i < 100000; i++) {
            listSomeString.add("-");
            listSomeString.add("Snowboarding");
            listSomeString.add("Rowing");
            listSomeString.add("Knitting");
            listSomeString.add("Speed reading");
        //}
//
        someComboBox.setPrototypeDisplayValue("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
        someComboBox.setFont(new Font("Serif", Font.BOLD, 16));
        someComboBox.setEditable(true);
        someComboBox.getEditor().getEditorComponent().setBackground(Color.YELLOW);
        ((JTextField) someComboBox.getEditor().getEditorComponent()).setBackground(Color.YELLOW);
//
        editableComboBox.setPrototypeDisplayValue("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
        editableComboBox.setFont(new Font("Serif", Font.BOLD, 16));
        editableComboBox.setEditable(true);
        JTextField text = ((JTextField) editableComboBox.getEditor().getEditorComponent());
        text.setBackground(Color.YELLOW);
        JComboBox coloredArrowsCombo = editableComboBox;
        Component[] comp = coloredArrowsCombo.getComponents();
        for (int i = 0; i < comp.length; i++) {// hack valid only for Metal L&F
            if (comp[i] instanceof MetalComboBoxButton) {
                MetalComboBoxButton coloredArrowsButton = (MetalComboBoxButton) comp[i];
                coloredArrowsButton.setBackground(null);
                break;
            }
        }
//
        non_EditableComboBox.setPrototypeDisplayValue("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
        non_EditableComboBox.setFont(new Font("Serif", Font.BOLD, 16));
//
        frame = new JFrame();
        frame.setLayout(new GridLayout(0, 1, 10, 10));
        frame.add(someComboBox);
        frame.add(editableComboBox);
        frame.add(non_EditableComboBox);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLocation(100, 100);
        frame.pack();
        frame.setVisible(true);

        //System.out.println(listSomeString.size());
        //System.out.println(someComboBox.getItemCount());
        //System.out.println(editableComboBox.getItemCount());
        //System.out.println(non_EditableComboBox.getItemCount());
    }

    public static void main(String[] args) {
        UIManager.put("ComboBox.background", new ColorUIResource(Color.yellow));
        UIManager.put("JTextField.background", new ColorUIResource(Color.yellow));
        UIManager.put("ComboBox.selectionBackground", new ColorUIResource(Color.magenta));
        UIManager.put("ComboBox.selectionForeground", new ColorUIResource(Color.blue));
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                MyComboBox aCTF = new MyComboBox();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:22:51.617

使组合框可编辑

获取组合框的编辑器组件

将 editorComponent 设置为可聚焦（false）

不确定这是您所追求的，因为您仍然可以更改所选项目，但无法专注于 editorComponent 来更改项目。

# jquery - WordPress 灯箱 jQuery 问题

> ID：14162399
> 
> 赞同：0
> 
> 时间：2013-01-04T18:02:00.687
> 
> 标签：jquery, wordpress, lightbox

我在这里为我的图片库使用 Light - Responsive LightBox 插件：http: [//inspiredworx-labs.com/sites/revoker/pictures/](http://inspiredworx-labs.com/sites/revoker/pictures/)

但是当我点击一张图片时，我只是得到了深色的叠加层。使用默认主题可以正常工作。我也尝试过停用所有其他插件。

我看不出可能是什么问题？

任何帮助或想法将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T14:40:09.447

已解决：我拿出了 Modernizer js，它起作用了！

# jquery - 带“无”选项的多选

> ID：14162400
> 
> 赞同：0
> 
> 时间：2013-01-04T18:02:00.753
> 
> 标签：jquery, html, forms

我正在构建一个将通过 ajax 提交到后台页面的表单。我想将选项呈现为多选控件，但带有“以上都不是”选项。

问题是，是否有可能做到这一点，以至于无法选择“无”选项并仍然选择其他选项？例如：

```
<select id="country" multiple="multiple">
    <option value>None</option>
    <option value="1">Jamaica</option>
    <option value="2">Cuba</option>
    <option value="3">France</option>
</select>​​​​​​​​​​​​​​​​​​​​​ 
```

用户可以单独选择“None”，或者同时选择“Cuba”和“France”——但不能选择“None”和“France”。因此，如果用户选择“无”，然后选择其他任何内容，“无”选项会自动取消选择吗？

如果有帮助，我将在页面中使用 jQuery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:09:37.570

奇怪的要求，但无论如何这可能对你有用：

```
$('#country').change(function() {
    if ($('option:first', this).is(':selected')) {
        $('option:not(:first)', this).prop('selected', false);
    }
});​ 
```

[http://jsfiddle.net/zhKKw/](http://jsfiddle.net/zhKKw/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:11:07.857

小提琴：http: [//jsfiddle.net/sajjansarkar/dRVN4/1/](http://jsfiddle.net/sajjansarkar/dRVN4/1/)

```
 var dropdown = $("#country");
  dropdown.click(function() {
    var val = dropdown.val();
    if (val) {
        var arr = val.toString().split(",");
        if (arr.length > 0 && arr[0] == "") {
            dropdown.val("");
        }
    }
});​ 
```

# c++ - 是否有获取 QImage 非白色区域的边界框的功能？

> ID：14162401
> 
> 赞同：2
> 
> 时间：2013-01-04T18:02:04.303
> 
> 标签：c++, qt, crop, qimage

我有一个 QImage，我需要修剪周围的白色（即只将它裁剪到非白色区域）。

QImage 或 QPixmap 是否有一个内置函数，该函数将返回图像非白色区域的边界框，类似于`QGraphicsPixmapItem::opaqueArea()`？意思是，在该边界框之外没有非白色像素。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:28:22.050

我没有看到为此的内置函数，但它应该很容易让你自己像这样：

```
QRect getBoundsWithoutColor(QImage qImage, const Qcolor &exclusionColor = Qt:white)
{
    QRect ofTheKing;

    int maxX = 0; int minX = qImage.width;
    int maxY = 0; int minY = qImage.height;

    for(int x=0; x < qImage.width(); x++)
        for(int y=0; y < qImage.height(); y++)
            if (QColor.fromRgb(qImage.pixel(x, y)) != exclusionColor)
            {
                if(x < minX) minX = x;
                if(x > maxX) maxX = x;
                if(y < minY) minY = y;
                if(y > maxY) maxY = y;
            }

    if (minX > maxX || minY > maxY)
        // The whole picture is white. How you wanna handle this case is up to you.
    else
        ofTheKing.setCoords(minX, minY, maxX+1, maxY+1);

    return ofTheKing;
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:22:32.640

QImage 中没有内置这样的功能，但是由于 QImage 允许直接访问像素数据，因此自己编写代码应该不会太难。在我的头顶上，它可能看起来像这样。

```
const QRgb CROP_COLOR = QColor(Qt::white).rgb();

QImage crop(const QImage& image)
{
    QRect croppedRegion(0, 0, image.width(), image.height());

    // Top
    for (int row = 0; row < image.height(); row++) {
        for (int col = 0; col < image.width(); col++) {
            if (image.pixel(col, row) != CROP_COLOR) {
                croppedRegion.setTop(row);
                row = image.height();
                break;
            }
        }
    }

    // Bottom
    for (int row = image.height() - 1; row >= 0; row--) {
        for (int col = 0; col < image.width(); col++) {
            if (image.pixel(col, row) != CROP_COLOR) {
                croppedRegion.setBottom(row);
                row = -1;
                break;
            }
        }
    }

    // Left
    for (int col = 0; col < image.width(); col++) {
        for (int row = 0; row < image.height(); row++) {
            if (image.pixel(col, row) != CROP_COLOR) {
                croppedRegion.setLeft(col);
                col = image.width();
                break;
            }
        }
    }

    // Right
    for (int col = image.width(); col >= 0; col--) {
        for (int row = 0; row < image.height(); row++) {
            if (image.pixel(col, row) != CROP_COLOR) {
                croppedRegion.setRight(col);
                col = -1;
                break;
            }
        }
    }

    return image.copy(croppedRegion);
} 
```

免责声明：此代码可能可以优化。我还没有测试它，它看起来像它编译但可能有一个错字。我只是把它放在那里以显示总体思路。

# vb.net - Visual Basic-“IF”没有结束

> ID：14162402
> 
> 赞同：0
> 
> 时间：2013-01-04T18:02:04.803
> 
> 标签：vb.net, if-statement, line-endings

```
If My.Computer.FileSystem.FileExists("pack/locale_ro.epk") Then My.Computer.FileSystem.DeleteFile("pack/locale_ro.epk")

    PB_GSM.Value = 10

    If My.Computer.FileSystem.FileExists("pack/locale_ro.eix") Then My.Computer.FileSystem.DeleteFile("pack/locale_ro.eix")

    PB_GSM.Value = 20

    If My.Computer.FileSystem.FileExists("pack/root.epk") Then My.Computer.FileSystem.DeleteFile("pack/root.epk")

    PB_GSM.Value = 30

    If My.Computer.FileSystem.FileExists("pack/root.eix") Then My.Computer.FileSystem.DeleteFile("pack/root.eix")

    PB_GSM.Value = 40

    My.Computer.Network.DownloadFile("http://example") 
```

我相信我写的一切都是正确的，但是我如何写“if”-s 并不重要，我无法结束它们。如果我在一行旁边写了 End if，它会说“End if 必须前面有一个匹配的 if”。还有一个问题，关于下载链接的行带有下划线，它说“重载解析失败，因为没有可访问的'DownloadFile'接受这个数量的参数”。

PS：这是一个metin2补丁的尝试，我不知道具体怎么做，但我确信这是一种只在我需要的文件上更新游戏的方法。谢谢你的帮助:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:04:17.827

您将它们全部放在一条线上。不要在“Then”关键字之后放置任何内容。

```
If My.Computer.FileSystem.FileExists("pack/locale_ro.epk") Then
  My.Computer.FileSystem.DeleteFile("pack/locale_ro.epk")
  PB_GSM.Value = 10
End If 
```

如果寻找 else-if 情况，这将是语法：

```
If My.Computer.FileSystem.FileExists("pack/locale_ro.epk") Then
  My.Computer.FileSystem.DeleteFile("pack/locale_ro.epk")
  PB_GSM.Value = 10
ElseIf My.Computer.FileSystem.FileExists("pack/locale_ro.eix") Then
  My.Computer.FileSystem.DeleteFile("pack/locale_ro.eix")
  PB_GSM.Value = 20
' etc, etc
End If 
```

请注意，这只会在找到的第一个“True”行上运行代码。

对于 DownloadFile，您还需要指定目标：

```
My.Computer.Network.DownloadFile("http://example", "c:\temp\myfile.txt") 
```

`c:\temp\`用您正在使用的路径替换路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:05:06.400

当您发布`Then`语句后跟关闭该`If`语句的表达式时。从本质上讲，您已经关闭了所有`If`陈述。

# objective-c - PDF 特别搜索 iOS

> ID：14162404
> 
> 赞同：2
> 
> 时间：2013-01-04T18:02:15.647
> 
> 标签：objective-c, ios, search, pdf

我知道有一个很棒的资源可以在 iOS 上进行 PDF 搜索，它是[PDFKitten](https://github.com/KurtCode/PDFKitten)

但我的情况是，我遇到了一些此来源不适用于搜索的 PDF 文件。我尝试通过 Mac 上的“预览”应用程序打开这些文件并尝试搜索，它可以工作。

我在这里上传[了一个文件](http://www.mediafire.com/view/?j523agkcaq5b3wp)。

您可以通过“预览”应用程序打开此文件并搜索“ra”一词来检查。它工作完美。如果您将此文件拖到源 PDFKitten 并进行一些配置以便源打开它，然后尝试搜索，它不起作用。

我检查了源代码，它关心所有显示运算符的文本，包括 Tj、'、''、TJ。我在这些运营商的回调中放置了一些日志行，我看到这些回调没有被调用。

你能给我一些建议或任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T00:29:28.380

如果我正确理解代码，PDFKitten 只会在页面的 /Resources 字典的 /Font 条目中查找字体。至少这是我对[Scanner 的方法 fontCollectionWithPage 的](https://github.com/KurtCode/PDFKitten/blob/master/PDFKitten/Scanner.m)解释，其结果由[pdfScannerCallbacks 中的 setFont](https://github.com/KurtCode/PDFKitten/blob/master/PDFKitten/pdfScannerCallbacks.mm)查询以设置当前字体对象。

此外，Do 运算符（即用于将 XObject 资源的内容注入页面内容的运算符）没有回调。除非 CGPDFScannerScan 在后台解释此运算符，否则根本不会扫描包含的 XObjects 的内容。这将符合您的观察，即文本设置运算符回调永远不会被调用。

但是，您的文件 mundo1.pdf 在其页面的 /Resources 字典中没有任何直接的 /Font 条目。相反，每个页面的所有实际内容都分别包装到单个 /XObject 资源中。这些 XObject 又拥有自己的 /Resources 字典，其中包含定义用于相应页面的字体的 /Font 条目。

因此，PDFKitten 对文件中使用的字体一无所知，尤其是它们的编码，因此无法从 PDF 内容中提取文本。也许它甚至看不到要解释的 PDF 内容。

因此，我建议您在 PDFKitten 问题管理网站上发布此问题。

顺便说一句，这个 PDF 结构完全符合 PDF 规范。尽管如此，它看起来像是对 iText 库的不充分使用。像这样使用 iText 的软件的作者应该检查他的代码并开始使用更适合的 iText 库类。

# git - 更改分支的父级

> ID：14162406
> 
> 赞同：3
> 
> 时间：2013-01-04T18:02:20.857
> 
> 标签：git, git-branch, branching-and-merging

一段时间以来一直在寻找解决方案，因为我远不是 git 专家 - 即使我接近解决方案，我也无法稍微修改它来完成它。

我一直在尝试像这里建议的那样工作：http: [//nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)，但是由于匆忙，而在分支修补程序时没有什么 - 我分支了从 dev 而不是 master 关闭。

简而言之，**假设我们有以下历史记录：**

```
A---B---C--------D---- < developer
\      / \      /
 R1--R2   H1---H2
       \         \
--------X---------Y--- < master 
```

R1 和 R2 是发布分支提交并且很好。但是，H1 和 H2 是修补程序分支提交，并且 H1 应该从 X（主）分支，而不是 C（开发）。由于 X 和 C 提交背后都有相同的代码，是否可以从 X 获得 H1 分支？

**我想让它看起来像这样：**

```
A---B---C--------D---- < developer
\      /        /
 R1--R2   H1---H2
       \  /      \
--------X---------Y--- < master 
```

这根本不会改变代码，我只想保持一致并在应该的地方开始分支。事情是 - 稍后在 dev 和 master 分支上都没有更多的提交。H1-H2 分支基本上是一个多月的历史，后来有超过一百次提交。

正如我所指出的，我是一个 git 初学者，并且一直在玩 rebase 等等，但结果却大错特错。

这个有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:30:52.153

如果不重写 H1，则无法做到这一点，然后又重写 H2，这也意味着重写 D 和 Y。因此，所有提交都需要更改和重新发布。并且重新发布已经发布的提交通常是一个坏主意。因此，如果这不是一个太大的问题，您不应该这样做并保持原样。

如果你仍然想这样做，你可以这样做：

*   基于 X 创建一个新的（临时）分支。
*   樱桃采摘H1；生成的 H1' 现在基于 X。
*   樱桃采摘H2。
*   将 master 重置为 X ( `git reset --hard X`)。
*   将临时分支合并到master。
*   删除临时分支。
*   将开发人员重置为 C。
*   将 master 合并到 developer。
*   使用 force 选项发布两个分支。

# jquery - 如何使用 jQuery 查找 HTML 表格的列号

> ID：14162407
> 
> 赞同：4
> 
> 时间：2013-01-04T18:02:20.230
> 
> 标签：jquery, html-table

我想使用 jQuery 找出 td 所属的列号。

例如：

```
<table>
    <tr>
        <td>Row1, Column1</td>
        <td>Row1, Column2</td>
    </tr>
    <tr class="totalRow">
        <td>Row2, Column1</td>
        <td class="columnChild">Row2, Column2</td>
    </tr>
</table> 
```

我想找到具有 . 类的单元格的列号`columnChild`。我知道它是 的第二个孩子`.totalRow`，并且是表中的第二列，但是我该如何找到它呢？

最终我想要实现的是将它添加到一个数组中，这样我就可以拥有一个类的列`columnChild`并将它们添加到数组中，这样我就可以为第二个子表的每一行运行一个函数。

我已经尝试写了好几次了，但是我遇到了一些编码障碍，所以任何帮助都将不胜感激。如果您需要更多信息，请告诉我，我会尽我所能。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-04T18:04:00.357

要获取 tr 中 td 的索引，您可以简单地使用

```
var index = $('.columnChild').index(); 
```

如果您有几个具有此类的单元格并且您希望它们在数组中的索引（我不确定我是否理解以“最终”开头的第二个问题），您可以这样做

```
var indexes = $('.columnChild').map(function(){return $(this).index()}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:23:37.257

> 所以我可以为第二个孩子的表格的每一行运行一个函数。

这将为您提供一个具有类 .columnChild 的 td 元素数组（在具有类 totalRow 的 tr 元素内）。

```
$(".totalRow .columnChild")

this will allow to iterate through the array

 $(".totalRow .columnChild")

 .each(function (index, element)
{

  // element is the tr element

  // your function
}); 
```

希望这有帮助。

# javascript - 单击时创建文本框

> ID：14162410
> 
> 赞同：2
> 
> 时间：2013-01-04T18:02:34.247
> 
> 标签：javascript, jquery, html-table, textbox

最初，当页面加载时，表格将正常显示，但是当我单击编辑标签时，它应该将名字值设为文本框以使其可编辑。我将输入值并按回车键将提交表单。我真的很困惑如何实现这一目标。

这是我的示例表，我无法超越。

```
<label id="edit" style="cursor:pointer; color:blue;">edit</label>

<table>
    <tr><td>First Name: </td>
        <td>John</td>
    </tr>
    <tr><td>Last Name: </td>
        <td>Wright</td>
    </tr>
</table> 
```

[jsfiddle](http://jsfiddle.net/rdRWC/1/)

​</p>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:06:46.697

不要把事情复杂化。只需添加另一个`<td>`带有文本框的标签并将其隐藏即可。然后添加一些 jsvascript 绑定到点击标签，`<td>`用静态文本隐藏并`<td>`用文本框显示。顺便说一句，您在这里不需要标签，`<span>`就足够了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:05:15.857

查看以下链接

[如何使用 Javascript 动态创建文本框并在后面的代码中读取控件值](https://www.codeguru.co.in/2008/03/how-to-create-textbox-dynamically-using.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T18:08:44.227

```
$('#edit').click(function() {
    var $table = $('table');
    if ($table.find('input').length) return;
    $table.find('td:nth-child(2)').html(function(i, v) {
        return '<input value=' + v + '>';
    })
})

$('table').on('blur', 'input', function() {
    $('table input').replaceWith(function() {
        return this.value;
    })
}) 
```

[http://jsfiddle.net/cnuDh/](http://jsfiddle.net/cnuDh/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T18:12:39.727

您可以使用`contentEditable`HTML5 和 javascript`keyPress`事件的支持来做到这一点。请尝试此链接[http://jsfiddle.net/rdRWC/8/](http://jsfiddle.net/rdRWC/8/)。

**HTML**

```
<div id="edit" style="border:1px solid #ccc" contenteditable="true" onkeypress="submitForm(event,this)">edit</div> 
```

**JS**

```
 function submitForm(e , t){
    var keyPressed = e.which;
if(e.which == 13){  //Pressed Enter Key
      alert("Do your Form Submittion Here");
   } 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T18:05:40.987

您应该使用 CSS 隐藏文本框，而不是在用户单击时创建文本框

```
display: none 
```

然后，当用户点击时，只需调用：

```
$('#textboxid').show(); 
```

我不鼓励动态创建文本框的原因是因为创建 HTML 比仅仅显示和隐藏文本框更难，也更难维护。

# php - 防止 MS Excel 使用 PHP 5.3 去除前导零

> ID：14162411
> 
> 赞同：0
> 
> 时间：2013-01-04T18:02:51.060
> 
> 标签：php, excel, csv

我在使用 PHP 生成的 CSV 文件中有以下示例行。当我`cat`文件时，这就是我所看到的：

```
541787,271561,"04/01/2013 09:26:35",18801872,Many,"PINSTRIPE JACKET",18806821872,75.00,GBP,1,0078,5051916991872 
```

但是，当我在 MS Excel 中打开此文件时，“0078”已更改为“78” - 因此 MS Excel 已自行删除前导零。它还将 EAN13 数字（在 L 列中）转换为指数。

![剥离零](../Images/de8b1b9be49256bb3450bc92b6e5fe0a.png)

就 PHP 代码而言，我使用以下代码将文件输出到浏览器，该代码原则上有效，但我想知道是否有一种方法可以控制使用 PHP 去除前导零？

```
// set the headers
header('Content-Type: application/csv');
header('Content-Disposition: attachment; filename=_report_' . date('Y-m-d-His') . '.csv');
header('Pragma: no-cache');

echo $report->getCSVOutput();
exit; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T12:21:23.997

事实证明，通过对[SimpleExcel](http://faisalman.github.com/simple-excel-php/)的小调整（如所有者所建议的那样），这个包*可以*处理前导零的剥离。

我正在使用下面的代码：

```
/**
 * get the order data in Microsoft Excel XML format (to be used when output to the browser directly)
 * @return void
 */
public function getExcelXMLOutput() {

    // instantiate new object (will automatically construct the parser & writer type as XML)
    $excel = new SimpleExcel('xml');                    

    // add some data to the writer
    $excel->writer->setData($this->orders);                                                 

    // save the file with specified name
    // and specified target (default to browser)           
    $excel->writer->saveFile('report_' . date('Y-m-d-His'));

} 
```

代码修改要求我将方法中的`XMLWriter`类更改`addRow`为：

```
$datatype = is_string($val) ? 'String' : (is_numeric($val) ? 'Number' : 'String'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:28:11.960

使用 CSV 格式，您无能为力。由于它不包含任何格式，Excel 会分析每个值并尝试猜测它最有可能是什么。

所以*0078*变成*78*（因为 Excel 认为它是一个数字），*5051916991872*变成*5.05192E+12*因为这是表示长数字的默认方式。

如果这是一个严重的问题，您需要使用可以指定值类型的文件格式。最简单的可能是*XML Spreadsheet 2003*。您可以通过按照您想要的方式格式化 Excel 电子表格来创建模板，然后将其保存为*XML Spreadsheet 2003*并在文本编辑器中打开它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-01T15:39:32.110

使用日期时，以下似乎有效。

只需用空格填充日期，如下所示：

```
$csvVal = '" ' . $DateTime->format('m/d/y') . ' "'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T18:24:38.280

以单引号开头的列值`'`将被 Excel 视为文本并保留前导零。

# windows - cmd / DOS / Batch 命令以管理员身份重命名文件

> ID：14162413
> 
> 赞同：0
> 
> 时间：2013-01-04T18:02:52.040
> 
> 标签：windows, batch-file, cmd, dos, rename

我想在 CMD 或批处理文件（.bat）中将名为 somefile.exe 的文件重命名为 somefile2.exe

当我在资源管理器中执行此操作时，我必须将文件重命名为管理员。像这样：

![在此处输入图像描述](../Images/e4387bb24109d103455a0f82d191403c.png)

（对不起瑞典语）

好的，我需要点击“继续”（“Fortsätt”），我可以重命名文件！很简单！

但在 CMD.exe 或批处理文件中，它显示“拒绝访问”我正在使用：

重命名 somefile.exe somefile2.exe

我如何在 CMD 或批处理文件中执行此操作？以管理员身份重命名文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:14:24.607

右键单击命令提示符快捷方式并选择***Run as administrator***。

然后，运行您的批处理文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:15:01.760

试试 RunAs 命令。您可以以其他用户身份运行命令。 [看这里 - runas](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/runas.mspx?mfr=true)

# applescript - Applescript 将应用程序放置在特定桌面上

> ID：14162415
> 
> 赞同：6
> 
> 时间：2013-01-04T18:03:05.690
> 
> 标签：applescript, desktop, osx-mountain-lion

我有一个在 Automator 中创建的 applescript，它打开了许多应用程序和文件夹，我将它们用作创建相册的工作流程的一部分。我的流程工作方式是桌面 1 中的 Photoshop Elements、桌面 2 上的四个 Finder 窗口、桌面 3 上的 iPhoto 和桌面 4 上的 Booksmart。

我的applescript会按照我的意愿打开其中的每一个，唯一的问题是它会打开我当时在桌面上的所有内容。然后我必须进入任务控制并在我的窗口中移动，将每个应用程序放到我希望它在的桌面上。只要在其必需的桌面上一个一个地打开应用程序，这将花费很长时间。

我曾尝试将桌面分配给应用程序，但这似乎并不能始终如一地工作。

是否有任何可以在特定桌面上打开应用程序的applescript？

我正在运行 OS X 10.8.2。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-12-05T10:00:59.590

您是否尝试将应用程序分配给桌面？

[![上下文菜单](../Images/237ce569a9ddd6796558dacdf8f822ff.png)](https://i.stack.imgur.com/XktF4.png)

[![停止选项](../Images/fe707ebadc1725f17c4833bd83bc7170.png)](https://i.stack.imgur.com/NFoJL.png)

这将在没有脚本帮助的情况下在正确的桌面上打开应用程序。

# c++ - 用里面的向量清理共享内存

> ID：14162419
> 
> 赞同：2
> 
> 时间：2013-01-04T18:03:29.107
> 
> 标签：c++, memory-management, boost-interprocess

我正在使用**boost::interprocess::managed_shared_memory**在不同进程之间共享一些数据，并且想知道清理是如何工作的。一般来说，我必须以下情况：

```
boost::interprocess::managed_shared_memory *sharedSegment;
typedef boost::interprocess::allocator< MyObject, boost::interprocess::managed_shared_memory::segment_manager>  SharedMemoryAlloc;
typedef boost::interprocess::vector<MyObject, SharedMemoryAlloc> SharedVector;
SharedVector *sVec;
unsigned int size;

// Do some other stuff and determine correct size
sharedSegment= new boost::interprocess::managed_shared_memory(boost::interprocess::create_only, "TEST", size);
SharedMemoryAlloc *allocToSharedSegment = new SharedMemoryAlloc(sharedSegment->get_segment_manager());
sVec = sharedSegment->construct<SharedVector>("MyVector")( (*allocToSharedSegment) );
delete allocToSharedSegment; 

// Fill sVec, do some computation etc..

// Start cleanup
//sVec->clear(); 
delete sharedSegment;

boost::interprocess::shared_memory_object::remove("TEST"); 
```

因为我调用 boost::interprocess::shared_memory_object::remove("TEST"); 我一直认为，无论如何，内存中的所有内容都会被删除，因此我不必照顾 sVec。但 Visual Leak Detector 告诉我，此时存在一些内存泄漏。如果我在删除共享内存之前清除向量，一切正常。是不是 sVec 在内部保存了指针，因此我必须调用 clear()？

# ruby-on-rails - 在 Rails 中使用视图检查数组

> ID：14162423
> 
> 赞同：3
> 
> 时间：2013-01-04T18:03:44.383
> 
> 标签：ruby-on-rails, ruby, arrays, views

我有一个带有一些视图的 rails 应用程序，如果视图是数组不包含任何数据，我想显示一些不同的东西。目前我的观点是这样的：

```
<% @trips.each do |trip| %>
  <p><%= trip.id %> | <%= trip.name %></p>
<% end %> 
```

但是，如果里面没有任何东西，有没有办法可以显示一些不同的文本`@trips`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T18:11:14.460

如果您使用部分：

**行程/_trip.html**

```
<p><%= trip.id %> | <%= trip.name %></p> 
```

**你的看法**

```
<%= render @trips || 'No trip' %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:05:52.127

当然，只需使用 if there，就像这样

```
<% if @trips.blank? %>
  <p>No trips</p>
<% else %>
  <% @trips.each do |trip| %>
    <p><%= trip.id %> | <%= trip.name %></p>
  <% end %>
<% end %> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T18:14:02.017

使用 if 语句并像这样检查它是否为空或空

```
<% if @trips.nil? || @trips.empty? %>
  <p>There are no trips</p>
<% else %>
  <% @trips.each do |trip| %>
    <p><%= trip.id %> | <%= trip.name %></p>
  <% end %>
<% end %> 
```

**编辑**

如果使用 Rails，您可能想要使用 @trips.blank?，如果您决定使用另一个 ruby​​ 框架或项目，那么您可以使用上面的 if/else 代码来检查数组是否为空或空

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T18:20:45.920

您可以使用 if/else 条件检查：

```
<% if (@trips != nil) then %>
  <p><%= trip.id %> | <%= trip.name %></p>
<% else %>
  <p>Some message</p>
<% end %> 
```

或者

```
<% if (@trips.blank?) then %>
  <p>Some message</p>
<% else %>
  <p><%= trip.id %> | <%= trip.name %></p>
<% end %> 
```

# asp.net - 在 ASP.NET MVC 4 中使用实体框架搭建脚手架

> ID：14162426
> 
> 赞同：0
> 
> 时间：2013-01-04T18:04:05.457
> 
> 标签：asp.net, entity-framework, asp.net-mvc-4

我正在关注“Professional ASP.NET MVC 4”并尝试使用实体框架从模型生成控制器。我的模型如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.Entity;

namespace MvcMusicStore.Models
{
    public class MusicStoreModels
    {
        public class Album
        {
            public virtual int AlbumId { get; set; }
            public virtual int GenreId { get; set; }
            public virtual int ArtistId { get; set; }
            public virtual string Title { get; set; }
            public virtual decimal Price { get; set; }
            public virtual string AlbumArtUrl { get; set; }
            public virtual Genre Genre { get; set; }
            public virtual Artist Artist { get; set; }
        }

        public class Artist
        {
            public virtual int ArtistId { get; set; }
            public virtual string Name { get; set; }
        }

        public class Genre
        {
            public virtual int GenreId { get; set; }
            public virtual string Name { get; set; }
            public virtual string Description { get; set; }
            public virtual List<Album> Albums { get; set; }
        }
    }
} 
```

当我右键单击我的*控制器*文件夹并选择*添加 > 控制器*时，我选择**“具有读/写操作和视图的 MVC 控制器，使用实体框架”**作为我的模板，并**选择“专辑 (MvcMusicStore.Models)”**作为我的模型类。这本书告诉我选择**“新数据上下文......”**并将其命名为**“MvcMusicStore.Models.MusicStoreDBContext”**。

一切看起来都不错，在执行上述操作之前，我已经保存并构建了我的解决方案。但是，我收到一条错误消息说

```
There was an error generating 'MvcMusicStore.Models.MusicStoreDBContext'.
Try rebuilding your project.' 
```

我有点不知所措。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T14:20:30.793

症状听起来很像这个问题： [http ://www.rhysgodfrey.co.uk/archive/2011/04/20/mvc3-tools-update-and-entity-framework-4-1-error.aspx](http://www.rhysgodfrey.co.uk/archive/2011/04/20/mvc3-tools-update-and-entity-framework-4-1-error.aspx)

我建议卸载所有版本的 Entity Framework，通过 NuGet 重新安装最新版本，然后从头开始重新生成 EF 上下文。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T04:19:23.477

我不太喜欢 C#（我认为这是 C# 代码 - 但不要引用我的话）.....

好吧，在将您的代码粘贴到一个新项目中之后，我注意到上面写着的那一行

```
Using System.Data.Entity; 
```

被标记为错误，并且一些进一步的研究表明您的 config.sys 文件中可能缺少引用...

回复：[http ://forums.asp.net/t/1381740.aspx/1](http://forums.asp.net/t/1381740.aspx/1)

# sharepoint - 指定 GroupBy 时 ListViewByQuery 不显示正确的列

> ID：14162430
> 
> 赞同：0
> 
> 时间：2013-01-04T18:04:21.337
> 
> 标签：sharepoint, listview, sharepoint-2010

我正在使用 Sharepoint 2010，并用 C#/VS2010 编写了一个应用程序页面。我正在使用 ListViewByQuery 来显示一个列表。一切都很好，直到我添加 GroupBy 标记来对列表进行分组。添加后，由于某种原因，我使用 query.ViewFields 选择的列将被忽略，而是在折叠和展开时显示其他三个列。代码在这里：

```
 //this section demonstrates how to display a list in an SP Application Page project:
        using (SPWeb web = site.OpenWeb())
        {
            myListQuery.List = web.Lists["Links"];
            SPQuery query = new SPQuery(myListQuery.List.DefaultView);
            //note: there seems to be bug somewhere... when the list is grouped by (folders), you
            //      don't see the fields you request - just three basic fields.  It seems to ignore the ViewFields
            //      that you specified, unless you don't group.  Weird.
            query.ViewFields = "<FieldRef Name=\"ID\" /><FieldRef Name=\"URLwMenu\" /><FieldRef Name=\"List\" /><FieldRef Name=\"Category\" /><FieldRef Name=\"Author\" />";
            query.Query = "<Where><Contains><FieldRef Name=\"List\"/><Value Type=\"Text\">Projects</Value></Contains></Where>";
            //if this next line is commented out, all the correct columns are shown
            query.Query += "<GroupBy Collapse=\"FALSE\" GroupLimit=\"100\"><FieldRef Name=\"Category\"></GroupBy>";
            myListQuery.DisableFilter = false;
            myListQuery.DisableSort = false;
            myListQuery.Query = query;
        } 
```

在此示例中，显示的列**是类型、编辑、URL 和注释。**如果有人有任何线索，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:58:07.517

您似乎在 GroupBy 子句中 FieldRef 的结束标记中缺少 / ：

```
<FieldRef Name=\"Category\"> 
```

# php - PHP My SQL 数据库表不可见

> ID：14162432
> 
> 赞同：0
> 
> 时间：2013-01-04T18:04:26.483
> 
> 标签：php, mysql

我是 PHP 和 mySQL 的初学者。我正在通过我的数据库创建导航。我设置了两张表，一张是主要导航项，一张是子导航项。它们由`subject_id`. 我正在使用循环来显示它们。第一个表显示，第二个表为信息应该在的位置留出空间，但它没有显示。我认为它一定是 SQL 设置中的东西，但我不知道。这是我的代码（我知道数据库已连接）：

```
 <?php require_once("includes/connection.php") ?>
    <?php require_once("includes/functions.php") ?>
    <?php include("includes/headder.php") ?>
    <table id="structure">
    <tr>
    <td id="navigation">
        <ul class="subjects">
    <?php
        $subject_set = mysql_query("SELECT * FROM subjects", $connection);
        if(!$subject_set){
            die("database query failed: " . mysql_error());
        }

        while ($subject = mysql_fetch_array($subject_set)) {
            echo "<li>" . $subject["menu_name"] . "</li>";

        $page_set = mysql_query("SELECT * FROM pages WHERE subject_id =    {$subject["id"]}", $connection);
        if(!$page_set){
            die("database query failed: " . mysql_error());
        }

        echo "<ul class=\"pages\">";
        while ($page = mysql_fetch_array($page_set)) {
            echo "<li>" . $page["menu_name"] . "</li>";
        }
        echo "</ul>";
        }
    ?>
    </ul>

    </td>
    <td id="page">
        <h2>Content Area</h2>

    </td>
    </tr>
    </table>
    <?php include("includes/footer.php") ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:14:13.110

由于您提到空白显示数据应该在哪里，看来确实找到了行。因此，您的 select 语句应该没问题。这很可能意味着在 $page 记录中找不到索引“menu_name”。

检查以确保“menu_name”确实是 pages 表的一列。

要测试 $page 记录有哪些有效列，您可以在 while $page 循环中使用以下内容：

```
var_dump($page); 
```

如果主题 id 是整数，则 where 子句中不需要单引号。但是，如果 subject_id 包含任何非整数字符，则您的 select 语句需要：

```
$page_set = mysql_query("SELECT * FROM pages WHERE subject_id =  '{$subject["id"]}'", $connection); 
```

# ios - ABRecordCopyValue 不同的值？

> ID：14162439
> 
> 赞同：0
> 
> 时间：2013-01-04T18:04:49.910
> 
> 标签：ios, abaddressbook

我试图在我的联系人列表中进行搜索，但是如果它是从应用商店新执行的，或者正如我现在测试的那样，从 TestFlight 执行，则此代码会崩溃。如果我卸载应用程序并点击运行，它会完美运行。但是直接从 TestFlight 执行它会崩溃，崩溃日志状态并且它在我所在的行中失败

```
BOOL found = NO;
NSString *name;
int i = 0;
NSLog(@"Hay %i", [people count]);
while (!found && i < [people count]) {
    ABRecordRef person = (ABRecordRef)[people objectAtIndex:i];
    ABMultiValueRef multi = ABRecordCopyValue(person, kABPersonPhoneProperty);
    NSLog(@"address: %@", multi);
    //Freshly from TestFlight this prints "address: Denis" wich is a contac, executed from Xcode it prints, address: ABMultiValueRef 0x1fb68400 with 1 value(s), so I see here's the problem

    if([[(NSMutableString*)ABMultiValueCopyValueAtIndex(multi, 0) componentsSeparatedByCharactersInSet:[[NSCharacterSet decimalDigitCharacterSet] invertedSet]] componentsJoinedByString:@""]){

        NSMutableString *tempPhone = [[NSMutableString alloc]initWithString:[[(NSMutableString*)ABMultiValueCopyValueAtIndex(multi, 0) componentsSeparatedByCharactersInSet:[[NSCharacterSet decimalDigitCharacterSet] invertedSet]] componentsJoinedByString:@""]];

        NSLog(@"telf: %@", tempPhone);

        int length = [tempPhone length] - 9;
        NSString *tempPhone2;
        if(length >= 0){
            tempPhone2 = [[NSString alloc]initWithString:[tempPhone substringFromIndex:length]];
        }

        NSLog(@"el telf: %@ y nombre %@ int %i",tempPhone2, [NSString stringWithFormat:@"%@ %@",ABRecordCopyValue(person, kABPersonFirstNameProperty) ? (NSString *)ABRecordCopyValue(person, kABPersonFirstNameProperty) : @"",ABRecordCopyValue(person, kABPersonLastNameProperty) ? (NSString *)ABRecordCopyValue(person, kABPersonLastNameProperty) : @""], i);

        if([[key objectForKey:@"phone"] isEqualToString:tempPhone2]){

            name = [NSString stringWithFormat:@"%@ %@",ABRecordCopyValue(person, kABPersonFirstNameProperty) ? (NSString *)ABRecordCopyValue(person, kABPersonFirstNameProperty) : @"",ABRecordCopyValue(person, kABPersonLastNameProperty) ? (NSString *)ABRecordCopyValue(person, kABPersonLastNameProperty) : @""];

            found = YES;

        }
    }

    i++;

} 
```

在这一行`NSLog(@"address: %@", multi);`上，当它的 Fresh from TestFlight “address: Denis” 是一个联系人时，它会在这一行打印，从 Xcode 执行它会打印，“address: ABMultiValueRef 0x1fb68400 with 1 value(s) ...”，所以我看到了问题所在，即不同，我不明白为什么不同，你能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:14:08.587

您似乎没有正确访问通讯录数据。我明白，正确的方法是这样的：

```
ABMultiValueRef multi = ABRecordCopyValue(person, kABPersonPhoneProperty);
NSString* label;
for (int i = 0; i < ABMultiValueGetCount(multi); i++) {
    label = (NSString*)ABMultiValueCopyLabelAtIndex(multi, i);
    ... <DO YOUR PROCESSING on label>
} 
```

希望这可以帮助。

# adapter - 如何在列表视图的每个项目中制作具有不同视图数量的适配器

> ID：14162440
> 
> 赞同：2
> 
> 时间：2013-01-04T18:04:59.520
> 
> 标签：adapter

我想在每个项目中创建一个具有不同视图数量的列表视图。像这样

列表显示

listitem1: 文本视图 1 文本视图 2 文本视图 3

listitem2：TextView1 按钮

列表项 3：文本视图 1 文本视图 2

我尝试在 getView 方法上使用 baseadapter 和 addview，但它不起作用，并且它创建的视图比我想要的多。我不知道是否有办法使用适配器。我在 stackflow 中找不到任何解决方案，我希望有人能给我一个简单的例子。谢谢你。

# javascript - 为什么每次单击工具栏按钮时我的 Javascript 都未定义？

> ID：14162442
> 
> 赞同：0
> 
> 时间：2013-01-04T18:05:04.293
> 
> 标签：javascript, firefox-addon, dom-events

我正在尝试创建一个简单的扩展，每次单击按钮时都会提醒鼠标单击（mouseup）坐标。（学习尝试）

扩展程序工作正常并且设置正确，除了一个小故障。

**我的 XUL 文件：**

```
<?xml version="1.0"?>

    <?xml-stylesheet type="text/css" href="chrome://global/skin/" ?>
    <?xml-stylesheet type="text/css"

href="chrome://mouseclick/skin/mouseclick.css" ?>

<!DOCTYPE overlay SYSTEM
  "chrome://mouseclick/locale/mouseclick.dtd">

<overlay id = "overlay-id" xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">
    <script type="application/x-javascript"
    src="chrome://mouseclick/content/mouseclick.js" />

    <toolbarpalette id="BrowserToolbarPalette">
    <toolbarbutton id="mouseclick-button" class="mouseclick-class"
                   label="&button.label;" tooltiptext="&tooltip.text;" 
                   oncommand = "mouseClick.display();"/>
  </toolbarpalette>
  <toolbar id="nav-bar">
    <toolbarbutton id="mouseclick-button" class="mouseclick-class"
                   label="&button.label;" tooltiptext="&tooltip.text;"
                   oncommand = "mouseClick.display();"/>
    </toolbar>
</overlay> 
```

**我的 JS 文件：**

```
if(mouseClick === undefined) {
  var mouseClick = {
    _x : "not yet clicked" ,
    _y : "not yet clicked"
  };
}

mouseClick.handler = function(e) {
  var x = e.pageX !== undefined ? e.pageX : e.clientX;
  var y = e.pageY !== undefined ? e.pageY : e.clientY;
  /*A TEST ALERT
  alert("(" + x + ", " + y + ")"); // a dummy command for testing
  */
  this._x = x;
  this._y = y;
};

mouseClick.display = function() {
    alert("(" + this._x + ", " + this._y + ")");
};

window.addEventListener("mouseup", mouseClick.handler, false); 
```

问题是，当我单击文档中的任何位置或窗口中除扩展按钮之外的任何位置时，**TEST 警报**命令会提醒正确的坐标。

**但是，当我单击我的按钮（即再次触发警报命令）时，第一个*TEST 警报*会返回正确的坐标。**

**但是，*主要警报*，警报`(not yet clicked, not yet clicked)`。**

为什么`mouseClick`每次单击我的扩展程序按钮时我的对象都会被重置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:08:29.800

> 为什么每次单击我的扩展程序按钮时我的 mouseClick 对象都会被重置？

它没有被重置，*它从未被设置*。

* * *

**问题**

在事件处理程序内部，`this`指的是`window`，而不是`mouseClick`。处理程序不会在对象的上下文中调用，因为您直接将其绑定到`window`.

含义，在函数内部，`this._x = x;`与`window._x = x;`. `myClick._x`永远不会改变。
稍后当您调用 时`mouseClick.display()`，`this`该函数内部会引用`mouseClick`并提醒初始值。

函数就像任何其他值一样。将其分配给对象的属性不会神奇地将其绑定到该对象。`this`所指的内容是在调用函数时确定的，**而**不是在创建函数时确定的。

[MDN 解释`this`得非常好](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)，[quirksmode.org 根据事件处理程序进行了解释](http://www.quirksmode.org/js/this.html)。

* * *

**解决方案**

您可以将处理程序显式绑定到`mouseClick`使用[`.bind` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
window.addEventListener("mouseup", mouseClick.handler.bind(mouseClick), false); 
```

或者传递一个函数，该函数依次调用`mouseClick.handler`：

```
window.addEventListener("mouseup", function(event) {
    mouseClick.handler(event);
}, false); 
```

# sql - SQL 总销售额计算

> ID：14162447
> 
> 赞同：4
> 
> 时间：2013-01-04T18:05:19.370
> 
> 标签：sql, sql-server, sql-server-2008, sum

我有一张销售表，包括购买/退货/换货示例：

```
--------**saleTbl**------------
CustID | DOP | SKU | Price
111 | 11/05/12 | 001 | 45.99
222 | 11/20/12 | 001 | 45.99
111 | 11/06/12 | 002 | 40.95
111 | 11/06/12 | 001 | -45.99
111 | 11/19/12 | 004 | 50.00
222 | 11/25/12 | 003 | 20.99
111 | 12/01/12 | 002 | -40.95
111 | 12/01/12 | 003 | 20.99 
```

标准是：在 2012 年 11 月 5 日至 2012 年 11 月 20 日期间找到每个客户的总数。如果客户交换了在此期间购买的商品并且在同一天购买的商品将被计算在内。预期结果是：

```
CustID | DOP | Price
222 | 11/20/12 | 45.99
111 | 12/01/12 | 70.99 
```

我试图得到总数，但当然这是不对的：

```
SELECT DISTINCT [num_cp] AS 'Member Id'
      ,MAX([dop]) AS 'Date'
      ,SUM([price]) AS 'Point'
  FROM [Mailing_List].[dbo].[UGG_DoublePoint]
  WHERE [num_cp] IN
  (
    SELECT [num_cp]
    FROM [Mailing_List].[dbo].[UGG_DoublePoint]
    GROUP BY [num_cp]
    HAVING SUM([price]) >0
  )
  --AND 
  AND [dop] BETWEEN '11/05/12' AND '11/20/12'
  GROUP BY [num_cp] 
```

请帮忙！谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:13:08.243

我认为您需要将查询更改为此

```
; WITH CTE AS 
(
    SELECT *, 
    COUNT(*) OVER (PARTITION BY CustID, DOP) Row_Cnt
    FROM TEST
), CTE2 AS 
(
    SELECT * FROM CTE
    WHERE [dop] BETWEEN '11/05/12' AND '11/20/12'
), CTE3 AS 
(
    SELECT * FROM CTE2 WHERE price > 0
    UNION
    SELECT * FROM CTE2 WHERE price < 0 
    and SKU IN (SELECT SKU FROM CTE2 WHERE Price > 0)
    UNION
    SELECT * FROM CTE
    WHERE row_cnt > 1 and DOP IN (
    SELECT max(A.dop) d FROM CTE A
    INNER JOIN CTE2 B ON A.CustID = B.CustID AND A.SKU = B.SKU
    )
 )
SELECT Custid, max(dop) dateid, sum(price) Price
from cte3
group by custid; 
```

检查[SQL Fiddle 演示](http://sqlfiddle.com/#!3/42c04/14)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:39:49.307

我认为这会奏效。它基本上通过使用左连接过滤掉结果集中的任何返回。

注意：如果有人在同一天购买/退回了同一物品的多个 SKU，则会出现问题。

```
select pur.CustId, sum(pur.price) TotalPrice
from test pur
left join test ret
  on pur.custid = ret.custid
   and pur.dop = ret.dop
   and pur.sku = ret.sku
   and pur.price = (-1 * ret.price)
where pur.dop between '11/05/2012' AND '11/20/2012'
  and ret.price is null
group by  pur.CustId 
```

# android - 如何在 Eclipse 中为同时运行的多个设备获取 Logcat

> ID：14162450
> 
> 赞同：21
> 
> 时间：2013-01-04T18:05:32.037
> 
> 标签：android, eclipse, logcat

我有两个 android 设备连接到同一个站。我想在 Eclipse 中以调试模式运行它们时查看两者的 logcat。

我在以下步骤中有一些运气：

1.  在设备 1 上运行应用程序
2.  在设备 2 上运行应用程序
3.  打开一个新窗口（窗口/新）
4.  在新窗口中，打开查看 logcat

大约 40% 的时间会导致每个 Eclipse 窗口显示来自不同手机的数据……但并非总是如此。这似乎几乎是一种运气的事情。通常两个窗口都显示相同的设备。如果我打开设备查看器并在*任*一窗口中选择一个设备，两者都会发生变化。

我怎么能一直这样做？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-06-03T17:45:12.957

这是一个很晚的回复，但您可能没有找到解决方案。

**解决方案：**

单击窗口 ---> 显示视图 ---> 其他 ---> Android ---> 设备。

只需单击一个设备即可切换到其 logcat。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-04T18:12:25.700

您可以尝试在两个不同的控制台窗口中使用 adb 来获取每个控制台的 logcat。

例子：

```
in console window 1: adb -s <device01_serial> logcat
in console window 2: adb -s <device02_serial> logcat 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T20:41:51.797

这是我使用 Juno M20120914-1800 在设备的 logcat 输出之间切换的方式。

不幸的是，它不是自动的，但它至少是我发现的最可靠的方法，一旦你习惯了它，它并没有那么糟糕。

我单击工具栏中的设备图标。

我单击设备名称。

然后我再次单击 logcat，它将显示我选择的设备。

似乎这应该是一项功能，能够一次监控多个设备/AVD。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T18:16:41.593

正如保姆所说。

您可以这样做：

1.  查找设备 1 和设备 2 的设备 ID。通过打开 shell 提示符并键入命令来执行此操作。 `adb devices` 您将获得已连接设备及其 ID 的列表。
2.  运行命令 `adb -s [device_1_id] logcat` 其中 [device_1_id] 是您在第一步中获得的设备 1 的设备 ID。
3.  打开另一个 shell 并执行与步骤 2 相同的操作，但为您设备 2。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-04T20:08:59.617

我不相信有一个好方法可以做到这一点。你可以近似它。一种选择是（正如其他答案所建议的那样）使用来自 adb 的 logcat。这显然不是那么漂亮。另一种方法是为您的第二个窗口直接运行 DDMS（而不是通过 Eclipse）。这让您非常接近，并为您提供了两个 logcat 窗口，每个窗口都有自己的设备选择器。DDMS 可执行文件位于 Android 安装的工具文件夹中。

# ruby - 第一个 ruby 和 postgreSql 应用程序 - 无法连接到服务器：没有这样的文件或目录

> ID：14162464
> 
> 赞同：1
> 
> 时间：2013-01-04T18:06:28.190
> 
> 标签：ruby, postgresql

> Mac OS X Lion 上的 Ruby 1.9.3

关注了关于这个主题的几篇关于 SO 的帖子。都没有帮助。

尝试在这里运行我的**第一个**rails 和 postgreSQL 应用程序。

在此之后：http: [//guides.rubyonrails.org/getting_started.html](http://guides.rubyonrails.org/getting_started.html)

当我做：

```
"rake db:create" 
```

我得到：

> 无法连接到服务器：没有这样的文件或目录服务器是否在本地运行并接受 Unix 域套接字“/tmp/.s.PGSQL.5432”上的连接？

一些事实：

不确定 /tmp/ 指的是什么，但如果它是来自根目录的，那么：

1) 权限：

drwxrwxrwx 11 根轮 374B Jan 4 17:33 tmp

2) 另外，我看不到文件 .s.PGSQL.5432。

3）我试图通过将以下内容添加到 database.yml 来强制套接字位置：

```
development:
    adapter: postgresql
    encoding: unicode
    database: testblog_development
    pool: 5
    username: blog
    password:
    socket: /var/pgsql_socket # <-- this line 
```

（它仍然显示与 /tmp/ 路径相同的错误）。

4）当我这样做时，`which postgres`我得到：

```
/usr/local/bin/postgres 
(I've used homebrew installation) 
```

5）当我这样做时：`brew info postgres`我得到：

> postgresql：稳定 9.2.2 [http://www.postgresql.org/](http://www.postgresql.org/)取决于：readline、ossp-uuid 与：postgres-xc /usr/local/Cellar/postgresql/9.2.2 冲突（2819 个文件，39M）* [https ://github.com/mxcl/homebrew/commits/master/Library/Formula/postgresql.rb](https://github.com/mxcl/homebrew/commits/master/Library/Formula/postgresql.rb)

和其他一堆信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:36:53.063

在我看来，服务器没有运行。当你从命令行运行时，你看到什么`ps aux | grep postgres`了吗？如果您看到的只是`grep postgres`输出中的内容，那么它没有运行。

由于您使用 Homebrew 安装了 PostgreSQL，`brew info postgres`如果确实如此，请尝试获取有关如何启动服务器的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:13:35.023

您不需要指定套接字。这是适用于 Postgres 的配置。您只需要更改数据库密码。

```
development:
  adapter: postgresql
  host: localhost
  pool: 5
  timeout: 5000
  username: postgres
  password: postgres
  database: testblog_development
  template: template0 
```

# c++ - 如何防止 MSVC++ 为 switch 语句过度分配堆栈空间？

> ID：14162465
> 
> 赞同：4
> 
> 时间：2013-01-04T18:06:32.177
> 
> 标签：c++, visual-c++, compiler-optimization

作为更新旧代码库工具链的一部分，我们希望从 Borland C++ 5.02 编译器迁移到 Microsoft 编译器（VS2008 或更高版本）。这是一个嵌入式环境，其中堆栈地址空间是预定义的并且相当有限。事实证明，我们有一个带有大 switch 语句的函数，它在 MS 编译器下导致比在 Borland 编译器下更大的堆栈分配，事实上，导致堆栈溢出。

代码的形式是这样的：

```
#ifdef PKTS
#define RETURN_TYPE SPacket

typedef struct
{
   int a;
   int b;
   int c;
   int d;
   int e;
   int f;
} SPacket;

SPacket error = {0,0,0,0,0,0};
#else
#define RETURN_TYPE int

int error = 0;
#endif

extern RETURN_TYPE pickone(int key);

void findresult(int key, RETURN_TYPE* result)
{
   switch(key)
   {
      case 1   : *result = pickone(5 ); break;
      case 2   : *result = pickone(6 ); break;
      case 3   : *result = pickone(7 ); break;
      case 4   : *result = pickone(8 ); break;
      case 5   : *result = pickone(9 ); break;
      case 6   : *result = pickone(10); break;
      case 7   : *result = pickone(11); break;
      case 8   : *result = pickone(12); break;
      case 9   : *result = pickone(13); break;
      case 10  : *result = pickone(14); break;
      case 11  : *result = pickone(15); break;
      default  : *result = error;       break;
   }
} 
```

使用 编译时`cl /O2 /FAs /c /DPKTS stack_alloc.cpp`，列表文件的一部分如下所示：

```
_TEXT   SEGMENT
$T2592 = -264                       ; size = 24
$T2582 = -240                       ; size = 24
$T2594 = -216                       ; size = 24
$T2586 = -192                       ; size = 24
$T2596 = -168                       ; size = 24
$T2590 = -144                       ; size = 24
$T2598 = -120                       ; size = 24
$T2588 = -96                        ; size = 24
$T2600 = -72                        ; size = 24
$T2584 = -48                        ; size = 24
$T2602 = -24                        ; size = 24
_key$ = 8                       ; size = 4
_result$ = 12                       ; size = 4
?findresult@@YAXHPAUSPacket@@@Z PROC            ; findresult, COMDAT

; 27   :    switch(key)

    mov eax, DWORD PTR _key$[esp-4]
    dec eax
    sub esp, 264                ; 00000108H
...

$LN11@findresult:

; 30   :       case 2   : *result = pickone(6 ); break;

    push    6
    lea ecx, DWORD PTR $T2584[esp+268]
    push    ecx
    jmp SHORT $LN17@findresult
$LN10@findresult:

; 31   :       case 3   : *result = pickone(7 ); break;

    push    7
    lea ecx, DWORD PTR $T2586[esp+268]
    push    ecx
    jmp SHORT $LN17@findresult

$LN17@findresult:
    call    ?pickone@@YA?AUSPacket@@H@Z     ; pickone
    mov edx, DWORD PTR [eax]
    mov ecx, DWORD PTR _result$[esp+268]
    mov DWORD PTR [ecx], edx
    mov edx, DWORD PTR [eax+4]
    mov DWORD PTR [ecx+4], edx
    mov edx, DWORD PTR [eax+8]
    mov DWORD PTR [ecx+8], edx
    mov edx, DWORD PTR [eax+12]
    mov DWORD PTR [ecx+12], edx
    mov edx, DWORD PTR [eax+16]
    mov DWORD PTR [ecx+16], edx
    mov eax, DWORD PTR [eax+20]
    add esp, 8
    mov DWORD PTR [ecx+20], eax

; 41   :    }
; 42   : }

    add esp, 264                ; 00000108H
    ret 0 
```

*分配的堆栈空间包括用于每种情况*的专用位置，用于临时存储从 返回的结构`pickone()`，但最终，只会将一个值复制到`result`结构中。可以想象，随着这个函数的结构更大、案例更多、递归调用更多，可用的堆栈空间被迅速消耗掉。

如果返回类型是POD，如上面不带`/DPKTS`指令编译时，每个case直接拷贝到`result`，栈使用效率更高：

```
$LN10@findresult:

; 31   :       case 3   : *result = pickone(7 ); break;

    push    7
    call    ?pickone@@YAHH@Z            ; pickone
    mov ecx, DWORD PTR _result$[esp]
    add esp, 4
    mov DWORD PTR [ecx], eax

; 41   :    }
; 42   : }

    ret 0 
```

谁能解释为什么编译器采用这种方法以及是否有办法说服它不这样做？我重新构建代码的自由有限，因此编译指示等是更理想的解决方案。到目前为止，我还没有找到任何可以产生影响的优化、调试等参数的组合。

谢谢！

**编辑**

我了解`findresult()`需要为 . 的返回值分配空间`pickone()`。我不明白的是为什么编译器会为开关中的每种可能情况分配额外的空间。一个临时的空间似乎就足够了。事实上，这就是 gcc 处理相同代码的方式。另一方面，Borland 似乎使用 RVO，将指针一直向下传递并避免使用临时变量。MS C++ 编译器是这三个编译器中唯一为开关中的每种情况保留空间的编译器。

我知道当您不知道测试代码的哪些部分可以更改时，很难建议重构选项——这就是为什么我的第一个问题是*为什么编译器**在测试用例中*会以这种方式运行。我希望如果我能理解这一点，我可以选择最好的重构/编译指示/命令行选项来修复它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:11:21.700

为什么不只是

```
void findresult(int key, RETURN_TYPE* result)
{
   if (key >= 1 && key <= 11)
     *result = pickone(4+key);
   else
     *result = error;
} 
```

* * *

假设这算作一个较小的更改，我只记得一个关于范围的老问题，特别是与嵌入式编译器有关。如果您将每个案例包装在大括号中以显式限制临时范围，优化器会做得更好吗？

```
switch(key)
{
   case 1   : { *result = pickone(5 ); break; } 
```

* * *

另一个范围更改选项：

```
void findresult(int key, RETURN_TYPE* result)
{
    RETURN_TYPE tmp;
    switch(key)
    {
      case 1   : tmp = pickone(5 ); break;
      ...
    }
    *result = tmp;
} 
```

这有点手动，因为我们只是想猜测哪个输入会诱使这个不幸的优化器做出明智的响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:23:55.853

我将假设允许重写该函数，只要更改不会“泄漏”到函数之外。我还假设（如评论中所述）您实际上有许多单独的函数要调用（但它们都接收相同类型的输入并返回相同的结果类型）。

对于这种情况，我可能会将函数更改为：

```
RETURN_TYPE func1(int) { /* ... */ }
RETURN_TYPE func2(int) { /* ... */ }
// ...

void findresult(int key, RETURN_TYPE *result) { 
    typedef RETURN_TYPE (*f)(int);

    f funcs[] = (func1, func2, func3, func4, func5, /* ... */ };

    if (in_range(key))
        *result = funcs[key](key+4);
    else
        *result = error;
} 
```

# javascript - Javascript异常处理查询

> ID：14162471
> 
> 赞同：0
> 
> 时间：2013-01-04T18:06:46.167
> 
> 标签：javascript, exception-handling

我对 Javascript 异常处理感到困惑 我想清除 Javascript 可以捕获哪些错误，或者哪些只能使用 if else 处理尽管两者都“未定义”，但 try 块（并且必须使用 if else 来捕获它）

第一的：

```
try {
    var x = 90;
    var value = x / y;
}
catch (err) {
    document.write(err.name + ": " + err.message + "<br/>");
} 
```

第二 ：

```
function add(x, y) {
    var resultString = "Hello! The result of your math is: ";
    var result = x + y;
    // return resultString + result; not returning  anything; hence, "undefined" also
}

try {
    var addResult = add(2, 3);
    document.write(" the result is : " + addResult + "<br/>");
} catch (err) {
    document.write(err.name + ": " + err.message + "<br/>");
} 
```

为什么我也没有在第二种情况下赶上阻止？

请澄清我的理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:10:35.193

在第一种情况下，您没有在任何地方定义 y 以便引发被 catch 块捕获的异常，但在第二种情况下，您已经定义`addResult=undefined`并且您只是显示值，所以没有异常

如果您的第一个案例是

```
try {
    var x = 90;
    var y = undefined;
    var value = x / y;
}
catch (err) {
    document.write(err.name + ": " + err.message + "<br/>");
} 
```

那么在第一种情况下也不会有例外。

希望你明白了:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:10:48.297

因为第二个例子没有任何错误。唯一的问题是它`addResult`不返回任何东西，这导致了`undefined`价值。但是，这不是错误。您的第一个示例捕获异常只是因为`y`变量未声明事件（它甚至没有`undefined`值）。

你可以在这里看到这个：

```
<script type="text/javascript">
//Error
try{
    alert(x);
}catch(e){
    alert(e.name + ': ' + e.message);
}
//Ok
try{
    var x;
    alert(x);
}catch(e){
    alert(e.name + ': ' + e.message);
}
</script> 
```

# touch - TouchDragEnter 进入 UIButton

> ID：14162473
> 
> 赞同：1
> 
> 时间：2013-01-04T18:06:53.363
> 
> 标签：touch, uievent, dragenter

是否可以在 uibutton 外部 TouchDown，然后使用 UIEventTouchDragEnter 或类似的东西在另一个 UIButton 中拖动？

我需要代码方面的帮助。我用 imageView 试过，但我会很感激有按钮的解决方案！

谢谢！

法兰胡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:16:00.157

该`UITouchDownEvent`事件必须发生在按钮内部，按钮才能跟踪触摸。该`UITouchDragEnter`事件意味着触摸从按钮内部开始（生成`UITouchDownEvent`），移到按钮外部（生成`UITouchDragExitEvent`）'，然后移回到按钮内部（生成`UITouchDragEnterEvent`）。

# c# - 如何将组件设置为始终位于 Windows Phone 顶部

> ID：14162476
> 
> 赞同：0
> 
> 时间：2013-01-04T18:07:04.483
> 
> 标签：c#, windows-phone-7

我有一个 ArrowBlock 组件，它有时会出现在与其他图像相同的位置，但它位于其下方。我想让这个 ArrowBlock 始终绘制在顶部。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T13:34:21.223

您可以尝试将[Canvas.ZIndex](http://msdn.microsoft.com/en-us/library/bb980110%28v=vs.95%29.aspx)设置为高于同一容器中所有其他组件的值（除了`Canvas`名称之外，还适用于其他容器）。

# ruby-on-rails - 清理生产服务器 rails 3 上的 shared/assets 文件夹

> ID：14162477
> 
> 赞同：1
> 
> 时间：2013-01-04T18:07:12.163
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, deployment, capistrano

我在生产服务器上有我的资产`/home/name/apps/myapp/shared/assets"`

我看到这个目录正在快速增长。现在权重文件夹是 40 Mb，但我当前资产的权重是 3.2 mb

**我的问题是如何使用 capistrano 自定义任务清理这个旧资产文件夹。当我做最后一个资产时，我只需要最后一个资产`cap deploy`**

编辑：

Capistrano 预编译任务：

```
namespace :assets do
    task :precompile, :roles => :web, :except => { :no_release => true } do
      from = source.next_revision(current_revision)
      if capture("cd #{latest_release} && #{source.local.log(from)} vendor/assets/ app/assets/ | wc -l").to_i > 0
        run_locally("rm -rf public/assets/*") 
        run_locally "bundle exec rake assets:precompile"
        find_servers_for_task(current_task).each do |server|
         run_locally "rsync -vr --exclude='.DS_Store' --recursive --times --rsh=ssh --compress --human-readable --progress public/assets #{user}@#{server.host}:#{shared_path}/"
        end
      else
        puts.info "Skipping asset pre-compilation because there were no asset changes"
      end
    end
  end 
```

我是生产服务器上的预编译资产，但我已更改为使用 rsync 将资产预编译到本地机器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:57:16.427

尝试`--delete`在您的 rsync 命令中使用。

从 rsync 手册页：`--delete delete extraneous files from dest dirs.`

# excel - EXCEL VBA UserInterfaceOnly:= True 不工作

> ID：14162483
> 
> 赞同：1
> 
> 时间：2013-01-04T18:07:37.167
> 
> 标签：excel, vba

当我使用`(some code here).copy destination:=(some code there)`. 它仍然会提示`protection issues on cells`. 基本上它不会让我的代码运行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-04T18:25:39.277

不幸的是，状态`UserInterfaceOnly:=TRUE`并未存储在文件中 - 因此，如果您重新打开文件，它将受到完全保护。使用该`Workbook_Open`事件重新应用此保护状态 - 或取消保护，然后直接在 VBA 代码中重新保护工作表。

有关详细信息，请参阅[Ozgrid](http://www.ozgrid.com/VBA/excel-macro-protected-sheet.htm)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-26T22:10:18.950

我在这里发布了一种解决此问题的方法：[https ://stackoverflow.com/a/69730040/13307304](https://stackoverflow.com/a/69730040/13307304)

就像彼得阿尔伯特提到的那样，密码本身不应该是硬编码的

# google-chrome - 背景图像作为背景颜色在 Chrome 中不可见

> ID：14162487
> 
> 赞同：1
> 
> 时间：2013-01-04T18:07:56.567
> 
> 标签：google-chrome, background, background-image, background-color, invisible

我正在使用 Firefox 在 localhost 上测试一个站点，现在我看到我提供的背景图像和颜色在 Chrome 中根本没有显示。在 IE 中，它在 IE9 中显示，但在 IE8 或 7 中不显示……所以在 Chrome、IE7 和 IE8 中，我都没有将图像视为颜色……

可能是什么问题？我同时使用一种颜色作为图像。这是我正在使用的代码：

```
background: url("http://localhost/test/wp-content/uploads/2013/01/bg.png") no-repeat scroll left 550px center #222; 
```

PS我使用左550px，因为我不想使用右-80px...有人告诉我使用减号不好...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:33:27.593

尝试将颜色放在 url 之前

根据 W3C：背景：[背景颜色] [背景图像] [背景重复] [背景附件] [背景位置]；

所以你的代码应该是这样的（我删除了 double left 属性，如果它是一个正数，而不是自动从左边推 550px）：

```
background: #222 url("http://localhost/test/wp-content/uploads/2013/01/bg.png") no-repeat scroll 550px center; 
```

# powershell - PowerShell 隐式远程处理不使用 $PSDefaultParameterValues

> ID：14162488
> 
> 赞同：0
> 
> 时间：2013-01-04T18:07:57.567
> 
> 标签：powershell, powershell-remoting

我正在尝试使用 $PSDefaultParameterValues 来简化我的生活。我遇到的问题是，当调用通过隐式远程处理加载的 cmdlet 时，我在 $PSDefaultParameterValues 中设置的任何内容都会被忽略。

我目前遇到的一个简化示例：

```
$domainController = 'dc1.ptloma.edu' 
Import-Module ActiveDirectory

foreach($command in (Get-Command -Module ActiveDirectory -ParameterName Server))
{
    $PSDefaultParameterValues["$($command.Name):Server"] = $domainController
}        

$exchangeSessionParameters = @{
    Name = "ExchangeInterop"
    ConfigurationName = "Microsoft.Exchange"
    Authentication = "Kerberos"
    Credential = $ExchangeCredential
    ConnectionUri = "http://server.domain.com/PowerShell/"
}

$exchangePsSession = New-PSSession @exchangeSessionParameters
$remoteModule = Import-Session -Session $exchangePsSession

foreach($command in (Get-Command -Module $remoteModule -ParameterName DomainController))
{
    $PSDefaultParameterValues["$($command.Name):DomainController"] = $domainController
}

try
{
    New-AdGroup -Path "OU=Automated,OU=Groups,DC=domain,DC=com" -Name "GroupA"
    Enable-DistributionGroup -Identity "CN=GroupA,OU=Automated,OU=Groups,DC=domain,DC=com" -Alias "GroupA" -PrimarySmtpAddress "GroupA@domain.com"
}
catch
{
    # Breakpoint here
    Write-Host $_.Exception.SerializedRemoteInvocationInfo
    throw
} 
```

我收到以下异常：

```
The operation couldn't be performed because object 'domain.com/Groups/Automated/GroupA' couldn't be found on 'dc2.domain.com'. 
```

请注意，它谈论的是 dc2，而不是我在 DomainController 属性上设置为默认值的 dc1。

深入查看错误记录，我发现异常 SerializedRemoteInvocationInfo 属性仅显示`Alias`、`PrimarySmtpAddress`和`Identity`作为绑定参数。看起来没有任何东西被传入 for `DomainController`。

我知道我可以重构并显式定义 DomainController 参数或使用脚本范围的哈希表和 splatting，但这需要进行很多更改，我真的很好奇为什么这种行为是这样的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:19:30.743

当您对这些 Exchange 会话使用隐式远程处理时，Exchange cmdlet（实际上它们是代理函数）将被传递到远程会话以供执行，然后将结果传递回您的本地会话。远程会话中不存在该哈希表。

# php - 允许 php 形式的 javascript 并避免像 JsFiddle 这样的黑客攻击

> ID：14162492
> 
> 赞同：2
> 
> 时间：2013-01-04T18:08:19.313
> 
> 标签：php, javascript, jsfiddle

我有一个会员网站，用户可以在其中将自己的代码嵌入到他们的个人资料中。我想允许他们在他们的个人资料中包含嵌入代码，例如 YouTube 和 Javascript 嵌入代码。

我注意到 JsFiddle.net 可以做到这一点。有人知道如何复制这种安全性吗？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T18:26:29.337

为用户提交的 HTML、CSS 和 JavaScript设置一个**完全**独立的域名（例如“exampleusercontent.com”） 。不允许通过您的主域名加载此内容。然后使用 iframe 将用户内容嵌入到您的页面中。

如果您需要比简单框架更紧密的集成，[`window.postMessage()`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)可能会有所帮助，允许不同框架中的脚本以受控方式相互通信。

或者，[Google Caja](http://code.google.com/p/google-caja/)是一个用于沙盒第三方 JavaScript 的开源编译器，尽管不时有人发现其中的漏洞。

您可能不想依赖 Caja 作为您唯一的防御层。毕竟，Facebook 确实放弃了类似的系统（称为 FBML/FBJS），转而支持 iframe 沙盒方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:11:32.950

我假设您希望从恶意代码注入、sql 注入等中获得安全性。

提交表单后，您需要验证输入服务器端。只要您在那里验证它是否符合您的期望，您应该没问题。您在 JavaScript（如果有的话）中所做的唯一验证应该是帮助用户将他们的信息添加到表单中并查看他们出错的地方，换句话说就是帮助。

我过去曾使用 YouTube API 来验证视频条目。不确定 Vimeo 是否有 API，如果没有，我会感到惊讶。

# sql - MS Access：如何在单击按钮时获取文本框的值？

> ID：14162496
> 
> 赞同：0
> 
> 时间：2013-01-04T18:08:51.897
> 
> 标签：sql, ms-access

这是一个完整的新手问题，但我在网上找不到任何解决方案（至少在我的理解中没有）。我想制作一个带有文本框和按钮的表单，单击时，按钮应采用文本框中写入的值，在表中找到具有该 ID 的行并将属性更改为`unavailable`. 通常我会用一个简单的 SQL 语句来做到这一点：

```
UPDATE table SET available='NO' WHERE id = *textbox.value*; 
```

我应该写什么而不是 textbox.value 以便它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:10:32.323

您可以参考一个开放的表格：

```
UPDATE table SET available='NO' WHERE id = Forms!MyForm!MyTextbox 
```

假设表单是主表单而不是子表单。您还可以在 VBA 中运行 SQL。确保您不会同时通过表单和查询或代码更新记录。

重新评论

在这种情况下，问题是腐败，我经常忘记提防。你会在这里找到一篇好文章：http: [//www.granite.ab.ca/access/corruptmdbs.htm](http://www.granite.ab.ca/access/corruptmdbs.htm)，包括反编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T20:15:21.027

在以下情况下，从文本框中获取值会更容易：

*   查询是从 VBA 执行的
*   VBA 与文本框的格式相同

如果我正确理解了这个问题，那么这里就是这种情况。

然后你可以这样做：

```
Dim SQL As String

'case 1: when the id is a string value
SQL = "UPDATE table SET available='NO' WHERE id = '" & Me.NameOfTheTextBox & "';"

'case 2: when the id is a numeric value
SQL = "UPDATE table SET available='NO' WHERE id = " & Me.NameOfTheTextBox & ";"

CurrentDB.Execute SQL 
```

# tabs - 如何在 Yii 的 CJuiTabs 中将小部件的输出作为内容传递？

> ID：14162502
> 
> 赞同：1
> 
> 时间：2013-01-04T18:09:30.333
> 
> 标签：tabs, yii, widget, cjuitabs

如何在 Yii 的 CJuiTabs 中将小部件的输出作为内容传递？

这是我尝试并得到错误的代码：

```
$this->widget('zii.widgets.jui.CJuiTabs',array(
'tabs'=>array(
    'Tab1'=> array('content' => $this->widget('zii.widgets.CListView', array(
        'dataProvider'=>$vulnerdataProvider,
        'itemView'=>'_latest_vulner' )),
        'id' => 'tab1'),
    'tab2'=>array('content'=>'Content for tab 2', 'id'=>'tab2'),
),
// additional javascript options for the tabs plugin
'options'=>array(
    'collapsible'=>true,
), 
```

));

它给出了这个错误：

类 CListView 的对象无法转换为字符串

编辑：除了斯图的回答，我发现了这个：http: [//yiibook.blogspot.nl/2012/09/handle-cjuitabs-in-yii.html](http://yiibook.blogspot.nl/2012/09/handle-cjuitabs-in-yii.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:24:51.483

是的，内容需要一个字符串，而小部件不返回字符串。我在这里找到了这篇博文：http: [//mrhandscode.blogspot.com/2012/03/insert-widget-to-another-widget-in-yii.html](http://mrhandscode.blogspot.com/2012/03/insert-widget-to-another-widget-in-yii.html)

所有者找到了一种非常创新的方法来解决这个问题，使用输出缓冲来收集一个小部件的输出，然后将其插入到第二个小部件中。

您可能可以通过以下方式实现它：

```
ob_start();
$this->widget('zii.widgets.CListView', array(
    'dataProvider'=>$vulnerdataProvider,
    'itemView'=>'_latest_vulner'
));
$tab1Content=ob_get_contents();
ob_end_clean();

$this->widget('zii.widgets.jui.CJuiTabs',array(
    'tabs'=>array(
        'Tab1'=> array('content' => $tab1Content,'id' => 'tab1'),
        'tab2'=>array('content'=>'Content for tab 2', 'id'=>'tab2'),
    ),
    // additional javascript options for the tabs plugin
    'options'=>array(
        'collapsible'=>true,
    ),
)); 
```

我没有测试过，可能需要修补！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-09T20:12:20.350

您可以将 $this->widget() 的第二个参数设置为 true，因此该方法将返回小部件的内容而不是回显它。

```
$this->widget('zii.widgets.jui.CJuiTabs',array(
'tabs'=>array(
    'Tab1'=> array('content' => $this->widget('zii.widgets.CListView', array(
        'dataProvider'=>$vulnerdataProvider,
        'itemView'=>'_latest_vulner' ), true),
        'id' => 'tab1'),
    'tab2'=>array('content'=>'Content for tab 2', 'id'=>'tab2'),
),
// additional javascript options for the tabs plugin
'options'=>array(
    'collapsible'=>true,
), 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-15T03:48:06.787

下面没问题。

```
'Tab1'=> array('content' => $this->widget('zii.widgets.CListView', array(
    'dataProvider'=>$vulnerdataProvider,
    'itemView'=>'_latest_vulner' ), true) 
```

# java - 行不在 SQLite 中创建并检索 AUTOINCREMENT 值 - Android

> ID：14162505
> 
> 赞同：0
> 
> 时间：2013-01-04T18:09:41.880
> 
> 标签：java, android, sqlite, auto-increment

希望这是允许的 - 我有 2 个不相关的问题。

1.  这是主要问题。出于某种原因，我的数据库中的最后一行没有被创建。我得到一个 SQLiteException。LogCat 和代码如下。错误代码行已被注释。

2.  有没有办法获取 AUTOINCREMENT 列的值？我无法使用 AUTOINCREMENT 列标题来访问`Cursor c = db.rawQuery("SELECT " + PERCENTAGE + " FROM " + TABLE + " WHERE " + RANK + " = " + rank, null);`它`RANK`。此游标始终返回 0。

数据库助手.java

```
// Table columns names. 
private static final String RANK = "_id"; 
private static final String SCORE = "score"; 
private static final String PERCENTAGE = "percentage";
private static final String SUM = "sum";

//Check if new record makes the top 10.
public boolean check(long score, int percentage, long sum) {
    Cursor c = db.rawQuery("SELECT " + SUM + " FROM " + TABLE, null);  //Line 82
    int z = c.getCount();
    c.moveToLast();
    int x = c.getInt(c.getColumnIndex(SUM));
    long y = calculateSum(score, percentage);
    if(z != 10) {
        insert(score, percentage, sum);
        return true;
    } else {
        if(y > x) {
            delete(10);
            insert(score, percentage, sum);
            sort();
            return true;
        } else {
            return false;
        }
    }
}

//Insert new record.
public long insert(long score, int percentage, long sum) {
    ContentValues values = new ContentValues();
    values.put(SCORE, score);
    values.put(PERCENTAGE, percentage);
    values.put(SUM, sum);

    return db.insert(TABLE, null, values);
}

public void onCreate(SQLiteDatabase db) {
    db.execSQL("CREATE TABLE " + TABLE + " ("
            + RANK + " INTEGER PRIMARY KEY AUTOINCREMENT,"
            + SCORE + " LONG,"
            + PERCENTAGE + " INTEGER,"
            + SUM + " LONG"
            + ");");
} 
```

LogCat 输出

```
01-04 02:00:24.635: E/AndroidRuntime(6224): FATAL EXCEPTION: main
01-04 02:00:24.635: E/AndroidRuntime(6224): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.test/com.example.test.Results}: android.database.sqlite.SQLiteException: no such column: sum (code 1): , while compiling: SELECT sum FROM HighscoresList
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.os.Looper.loop(Looper.java:137)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at java.lang.reflect.Method.invokeNative(Native Method)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at java.lang.reflect.Method.invoke(Method.java:511)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at dalvik.system.NativeStart.main(Native Method)
01-04 02:00:24.635: E/AndroidRuntime(6224): Caused by: android.database.sqlite.SQLiteException: no such column: sum (code 1): , while compiling: SELECT sum FROM HighscoresList
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:882)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:493)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:37)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:44)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1314)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.database.sqlite.SQLiteDatabase.rawQuery(SQLiteDatabase.java:1253)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at com.example.test.DatabaseHelper.check(DatabaseHelper.java:82)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at com.example.test.Results.showResults(Results.java:111)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at com.example.test.Results.onCreate(Results.java:60)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.Activity.performCreate(Activity.java:5104)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
01-04 02:00:24.635: E/AndroidRuntime(6224):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
01-04 02:00:24.635: E/AndroidRuntime(6224):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:52:03.847

1.  创建表有问题。从“总和”列中检索值时，堆栈跟踪显示错误。此错误意味着没有名为“sum”的列。您是否有可能在创建此表之前尝试获取值？

2.  您可以使用 for 循环检索数据：

    ```
    for(int i=0;i<z;i++){

    int ID = yourCursor.getInt(0);

    if(ID==YOUR_NEEDED_ID){

      int percantage = yourCursor.getInt(2);
       break; //if you got what you want, cursor could be stopped
     }

     yourCursor.moveToNext();

    } 
    ```

## 编辑

升级数据库使用

```
 @Override
    public void onUpgrade(SQLiteDatabase db, int arg1, int arg2) {
        // TODO Auto-generated method stub
        onCreate(db);
    } 
```

# java - 检查arraylist是否只包含空值

> ID：14162506
> 
> 赞同：9
> 
> 时间：2013-01-04T18:09:57.207
> 
> 标签：java, arraylist

我认为必须有更好的方法来做到这一点。我调用了一个返回 ArrayList 的函数。如果该 ArrayList 仅返回 10 个空项（默认值），是否有办法检查这一点而无需遍历所有 10 个项以查看它们是否为空？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2017-04-11T11:49:46.320

从 Java 8 开始，您可以像这样使用[Streams](https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html)：

```
boolean nullsOnly = list.stream().noneMatch(Objects::nonNull); 
```

这等于：

```
boolean nullsOnly = list.stream().allMatch(x -> x == null) 
```

在这里，您可以看到更通用的测试任何列表是否匹配给定[Predicate](https://docs.oracle.com/javase/8/docs/api/java/util/function/Predicate.html)的方法：

```
list.stream().allMatch(x -> /* Some testing function. */) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-04T18:14:40.313

一般来说，没有；没有其他方法可以告诉任意 ArrayList 包含十个`null`than 实例来循环遍历它并确保每个元素都是`null`. 当然，如果列表的 size() 不等于 10，您可以放弃这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-04T18:14:59.457

```
List<Object> arrayList = new ArrayList<Object>();

arrayList.isEmpty();
// first call returns true    

arrayList.add(null);
// second call returns false    
Object obj = new Object();

arrayList.add(obj);

arrayList.isEmpty();
// third call returns false 
```

那是你想要的吗？

多次添加空值会将大小增加一，但除非循环数组列表，否则没有具体的“简单方法”来查找空对象的数量。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-04T18:14:29.903

您是否要检查 ArrayList 是否为空？（即`myArrayList.isEmpty()`）或者您是否尝试检查 ArrayList 是否仅包含空引用？如果您尝试检查所有条目是否为空，那么您将需要检查每个条目...

```
boolean isListOfNulls(List myList){
    for(Object o: myList)
        if(!(o == null))
            return false;
    return true;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-29T10:41:55.563

尝试使用流 API。

```
boolean haveOnlyNulls = arraylist.stream().noneMatch(object -> object != null); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-17T09:31:17.087

检查的最佳方法是使用`boolean allMatch(Predicate<? super T> predicate);` 此返回此流的所有元素是否与提供的谓词匹配。如果不需要确定结果，则可能不会评估所有元素的谓词。如果流为空，则返回 true 并且不评估谓词。

```
 boolean hasAllNulls = list.stream().allMatch(Objects::isNull) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-04T21:38:30.093

将默认值更改为空 ArrayList 并使用 isEmpty()。目前的默认设置是毫无意义的。

# android - 更改操作栏中的图标

> ID：14162507
> 
> 赞同：0
> 
> 时间：2013-01-04T18:10:11.507
> 
> 标签：android, nullpointerexception, android-actionbar

我想将我的应用程序的徽标放在屏幕顶部的操作栏中。当前显示的是默认的绿色 android 启动器图标。

![在此处输入图像描述](../Images/e7c6d78be30b892b53d5d30b4cbd2507.png)

我尝试了以下方法，但没有看到任何变化：

我进入我的清单文件并更改了 android:icon 代码...

```
 <application
    android:allowBackup="true"
    android:logo="@drawable/logo"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" > 
```

这不起作用，所以我在我的代码中创建了一个 ActionBar 对象并使用了 setIcon 方法。

```
ab.setIcon(R.drawable.logo); 
```

但是，上面的代码行会生成以下运行时错误：

**java.lang.RuntimeException：无法启动活动 ComponentInfo{com.example.waitronproto3/com.example.waitronproto3.MainActivity}：java.lang.NullPointerException **

任何人都可以看到为什么会发生这种情况，资源 R.drawable.logo 存在，因为我可以在文件夹中看到它，并且在 IDE 中没有生成错误。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:16:11.673

`android:logo`是的，据我所知没有财产。你不能只创建一个`ActionBar`......你用过这个吗？

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(...);
    getActionBar().setLogo(R.drawable.logo)`
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:25:56.047

一切都是正确的，只是我忘记了对 ActionBar 的引用。下面的代码解决了这个问题。

```
ab = this.getActionBar();
    ab.setIcon(R.drawable.logo); 
```

# c# - 无法使用 Windows 服务加载 CLIPSLIB.dll 文件

> ID：14162508
> 
> 赞同：0
> 
> 时间：2013-01-04T18:10:20.067
> 
> 标签：c#, dll, windows-services, clips

我正在使用 C# 开发 Windows 服务。我想用 Windows 服务加载 CLIPSLIB.dll。首先，我尝试在 vs2010 中将 CLIPSLIB.dll 作为控制台应用程序写入服务，并将 CLIPSLIB.dll 放在项目调试文件夹中。它工作得很好。但是当我安装它并作为 Windows 服务运行时，它会抛出这个异常。

**无法加载文件或程序集“Mommosoft.ExpertSystem，版本=0.3.0.2，文化=中性，PublicKeyToken=20382083c6694bdc”或其依赖项之一。该系统找不到指定的文件。**

我发现这是因为 Windows 服务无法加载相关的 dll。那么我应该把外部 dll 放在什么位置来加载 Windows 服务呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:22:44.323

Scott Hanselman 有一篇文章描述了如何调试程序集加载错误。这种方法的缺点是它需要更改注册表项并重新启动才能启用融合加载程序日志记录。

那篇文章可以在这里找到： [http ://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx](http://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx)

因为您正在编写 Windows 服务，请检查程序集的引用是否引用 bin 目录而不是其他路径。否则，融合加载程序日志将识别它试图从哪里加载程序集。

至于 .dll 文件，将文件夹添加到您的项目并在那里添加 .dll 文件，将构建属性从不复制更改为如果更新则复制，以便 .dll 文件最终出现在您的构建输出 bin 路径中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-27T21:11:32.883

您必须重建 CLIPSLib 解决方案，

1.  下载此链接中的所有文件：链接： [https ://svn.code.sf.net/p/clipsnet/code/](https://svn.code.sf.net/p/clipsnet/code/)

    2.打开CLIPSLib文件夹中的CLIPSLib.sln

    3.右键单击解决方案并选择重建解决方案。

    4.转到您的 CLIPSLib.dll 和 CLIPSNet.dll 位于 ..\ ..\mlplatform\bin 文件夹中的 CLIPSLib 文件夹。

    希望这有帮助。

# c++ - 在集合迭代器上发布增量

> ID：14162509
> 
> 赞同：1
> 
> 时间：2013-01-04T18:10:25.707
> 
> 标签：c++, iterator, set

> **可能重复：**
> [迭代器有效性，在 std::set 中的 erase() 调用之后](https://stackoverflow.com/questions/1636578/iterator-validity-after-erase-call-in-stdset)

当我迭代一个集合并想要删除某些项目时，迭代器会更改。这会导致段错误，因为删除后迭代失败。我该如何克服这个问题？

```
std::set< std::pair<double,unsigned>, comparisonFunction> candidates;'
[...]

for( auto it = candidates.begin(); it != candidates.end(); ++it)
{
  [...]
  if ( some constraint satisfied)
  {
    candidates.erase(it);
  }
} 
```

使用此代码时遇到段错误。我的猜测是，这要么是由于迭代器损坏，要么是由于在某些情况下要删除的元素是最后一个元素。迭代器上的后增量是否克服了这个问题？像这样：

```
candidate.erase(it++); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T18:12:34.130

使用的返回值`erase`：

```
it = candidates.erase(it); 
```

请注意，如果您删除一个元素，则不能增加`it`，否则您的迭代器可能会失效。

```
for( auto it = candidates.begin(); it != candidates.end();)
{
  if ( some constraint satisfied)
  {
    it = candidates.erase(it);
  }
  else
    ++it;
} 
```

另请注意，这在 C++03 中是不可能的，因为`erase`没有返回任何迭代器。但是，由于您使用的是 C++11，所以这应该不是问题。

### 参考

*   [`std::set::erase`](http://en.cppreference.com/w/cpp/container/set/erase)

# java - 泛型和方法

> ID：14162518
> 
> 赞同：1
> 
> 时间：2013-01-04T18:10:52.260
> 
> 标签：java

为什么我必须这样做？

```
public <T> void myMethod(MyClass<T> value){

} 
```

为什么我必须提到`<T>`两次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:13:10.117

第一个`<T>`声明您的方法具有泛型参数。

第二个`<T>`指定`MyClass<>`类的泛型参数的值。（就像`MyClass<string>`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:13:45.603

第一个`<T>`声明您正在使用模板化方法。说以下话也很恰当：

```
public void myMethod(MyClass<?> value){

} 
```

您还可以像这样在类级别声明泛型参数：

```
public class MyClass<T> {

    public void myMethod(MyClass<T> value){
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T21:35:52.683

The outer <T> says 'this is a generic method' and also gives you the chance to place bounds on T, for example T extends Comparable<T>. You wouldn't want to be repeating all that for every parameter that used T.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T18:14:18.567

实际上，第一个定义了在您的函数中使用了一个泛型类，第二个 `MyClass<T>`值表示您的类的泛型类型`T`在`List<String>`哪里`String`可以是您的`T`.

# asp.net - Informix 数据源名称未找到且未指定默认驱动程序错误

> ID：14162525
> 
> 赞同：1
> 
> 时间：2013-01-04T18:11:18.643
> 
> 标签：asp.net, iis, informix

我已经为连接到 ccx 数据库的 Cisco 呼叫中心设置了一个墙板，当我通过 Visual Studio 运行它时一切正常，但是当我将它发布到 IIS 并尝试查看我得到的页面时：

```
ERROR [IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver 
```

当它访问数据源时。在我的搜索中，我只能找到我需要将驱动程序添加到我试图做的连接字符串中，但仍然没有运气。缺少什么？

```
connectionString="Dsn=Wallboard-1;driver={INFORMIX 3.50 32 BIT};server=uccx1_uccx;host=xxxx;service=1504;protocol=onsoctcp;database=db_cra;uid=xxx;pwd=xxxx" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T16:42:36.313

知道了！在 64 位环境中运行时，您需要通过 IIS 进入您的站点正在运行的应用程序池，并启用 32 位应用程序，以便它可以访问 SysWOW64 文件夹。它找不到驱动程序，因为它找不到 odbc dsn。

# javascript - 更改表单的 onsubmit 属性以提交它是一种好习惯吗？

> ID：14162535
> 
> 赞同：1
> 
> 时间：2013-01-04T18:12:30.727
> 
> 标签：javascript, html, ajax, jquery

我有这样的代码

```
<form onsubmit="return false;" id="myform">
<input type="text" id="data"/>
<input type="submit" value="Submit" id="submitForm" />
</form>

<script>
$(document).ready( function() {

    var form = $('#myform');

    var result = form.find('#data').val() != "";

    if ($.data( form, 'validated' ) && result) {
        return true;
    } 
    else
        $.data( form, 'validated', false );      

    $.post( 'http://myweb/action', form.serialize(), function (data) {
        var json_result = $.parseJSON(data);
        if (result && json_result.is_valid) {
          $.data( form, 'validated', true );
          form.attr('onsubmit', 'return true;' );
          form.submit();
        } 
        else {
          alert( 'There is an error in the form data!' );
        }
    }

});
</script> 
```

是一个好习惯吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:20:18.697

仅供参考。无论你想做什么这种风格

```
form.attr('onsubmit', 'return true;' ); 
```

不好，因为通过`onSubmit`直接设置属性，您正在杀死可能绑定到`submit`事件的其他处理程序。

# php - 我可以将php中的标头重定向更改为在PHP中具有相同状态的javascript重定向吗

> ID：14162542
> 
> 赞同：0
> 
> 时间：2013-01-04T18:12:50.907
> 
> 标签：php, javascript

> **可能重复：**
> [PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我的网站是[http://www.seoitc.com](http://www.seoitc.com)，我们在这个网站上使用 joomla，但是当我尝试自动重定向到显示错误的任何页面时遇到 1 个问题：警告：无法修改标头信息 - 标头已由 () 发送。我尝试更改重定向以使用 js，但不能使用与 php 中相同的状态（302,303 ...）。请帮助解决这个问题。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:14:12.610

在您调用标头函数之前，正在发送任何输出。在您的标头调用之前检查任何 html 代码，即使是空格或空行也会导致

根据[PHP 手册](http://us.php.net/manual/en/function.header.php)

> 请记住，必须在发送任何实际输出之前调用 header()，无论是通过普通 HTML 标记、文件中的空白行还是从 PHP 发送。使用 include 或 require 函数或其他文件访问函数读取代码并在调用 header() 之前输出空格或空行是一个非常常见的错误。使用单个 PHP/HTML 文件时也存在同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:21:37.623

您可以在页面顶部使用[ob_start() 。](http://php.net/manual/en/function.ob-start.php)以防止错误。
但您也可以使用此代码。如果您的页面发生任何错误，它会将您重定向到`$page`：

```
// page address
function redirect($page) 
{
    header("Location: ".$page);
}
set_error_handler("redirect"); 
```

您可以查看：[PHP 已发送的标头](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php?lq=1)

# jquery - 无法检查jquery中输入字段的值是否为空

> ID：14162543
> 
> 赞同：-1
> 
> 时间：2013-01-04T18:12:51.413
> 
> 标签：jquery, variables

```
var costp;
var anzahl_der_personen = $('#anzahl_der_personen').val();

    if( +anzahl_der_personen == 1 ) {
        costp = 0;
    }elseif( $.trim('#anzahl_der_personen').val() === null ){
        costp = 0;
    }else {
         costp = (59 * $('#anzahl_der_personen').val()) - 59;
    } 
```

由于某种原因，它永远不会出现在 elseif 语句中！我尝试了其他方法是 .lenght, .is(empty).. 来查看文本字段是否为空，但它总是转到 else 语句！如果值不是 1，则转到 else 语句。检查值是空还是 null 的正确方法是什么，因为如果用户没有在字段中输入任何内容，我希望变量 costp 为 0；

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:13:59.403

JavaScript 没有`elseif`声明。改为使用`else if`。

另外，你用`$.trim`错了。

* * *

最后，不需要所有冗余代码。试试这个：

```
var costp;
var anzahl_der_personen = +$('#anzahl_der_personen').val();

if ( ! anzahl_der_personen || anzahl_der_personen === 1 ) {
    costp = 0;
} else {
    costp = (59 * anzahl_der_personen) - 59;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:14:34.347

之间应该有空格`else if`

还要检查**空字符串**而不是**空值**

您使用该`$.trim`方法的方式存在语法错误。它需要一个字符串。

```
 else if( $.trim(anzahl_der_personen) === '' ){ 
```

# macos - Jenkins 调用 mount_smbfs 失败并出现身份验证错误

> ID：14162548
> 
> 赞同：6
> 
> 时间：2013-01-04T18:13:04.907
> 
> 标签：macos, jenkins, mount, samba

我在 Mac OS X 10.7.5 上运行 Jenkins，并让它处理夜间备份到 Windows 服务器上的 SMB 共享。我想自动挂载 SMB 驱动器作为备份脚本的一部分，但 mount_smbfs 在 Jenkins 中失败。我使用的 mount 命令格式如下：

```
mount_smbfs "//WORKGROUP;user:password@server/share" /Users/user/share 
```

这在终端命令行中运行良好，但在 Jenkins 中给了我错误：

```
mount_smbfs: server rejected the connection: Authentication error 
```

我已确保 Jenkins 以与命令行上相同的用户身份运行命令，并且 PATH 和其他环境变量的差异没有任何突出之处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-05T11:03:14.690

这还不是一个完整的答案 - 只是与诊断相关的信息列表。如果您发现任何适当的治疗方法，请编辑此答案。

以下是一些相关的 Apple 支持文章：

*   [http://support.apple.com/kb/HT1568](http://support.apple.com/kb/HT1568)
*   [http://support.apple.com/kb/HT4829](http://support.apple.com/kb/HT4829)

这些是手册页

*   人 mount_smbfs
*   人 smbutil
*   人 nsmb.conf

您可能想尝试 smbutil view "/WORKGROUP;user:password@server"

检查服务器的可用性。

mount_smbfs 命令的 -N 选项有利于自动化登录过程

```
 -N      Do not ask for a password.  At run time, mount_smbfs reads the
             ~/Library/Preferences/nsmb.conf file for additional configuration parameters
             and a password.  If no password is found, mount_smbfs prompts for it. 
```

还有明文或加密密码的问题，地址为：

*   [http://hints.macworld.com/article.php?story=20050506120948120](http://hints.macworld.com/article.php?story=20050506120948120)

# c# - 关于 XNA 到 Mono Android 的转换：处理活动生命周期的简单（或最简单）方法是什么？

> ID：14162552
> 
> 赞同：4
> 
> 时间：2013-01-04T18:13:09.663
> 
> 标签：c#, android, xna, xamarin.android

我是一名 C# 开发人员，致力于转换为 Mono Android。这些转换工作完美，除了当手机超时或黑屏并且用户再次触摸屏幕时......游戏失败了。

处理这个问题的最简单方法是什么？我听说它被称为生命周期，发现很多关于这个周期的简要描述，没有解释如何通过实例来实现它，尤其是如何通过 XNA 转换来实现它。

我的第一个解决方案是在 XNA 游戏中使用“暂停”方法，并为 Android 的“onPause”运行该方法。然而，可能有更简单的方法来处理这个问题，因为我听说有简单的 Mono Android 设置可供选择，可以自动处理超时和电话呼叫。

我要问的是..如何让我的 XnA 转​​换继续通过电话、屏幕超时等运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T16:05:43.847

请问您是使用[MonoGame](http://www.monogame.net)还是简单地使用 Mono for Android 附带的[AndroidGameView ？](http://docs.monodroid.net/index.aspx?link=T%3aOpenTK.Platform.Android.AndroidGameView)

如果您使用的是 AndroidGameView，我建议您按照[纹理立方体示例](https://github.com/xamarin/monodroid-samples/blob/master/TexturedCube/PaintingView.cs)在 OnLoad() 中手动重新加载纹理的约定。

使用 MonoGame 时，如果您通过 加载纹理`ContentManager.Load<Texture2D>()`，则会为您处理重新加载。使用加载的纹理`Texture2D.FromStream`必须在`GraphicsDevice.DeviceReset`事件中手动重新加载。

正如 Andrew Russell 所指出的，[ExEn](http://exen.codeplex.com/)的优势在于它不需要在每个简历上重新加载纹理。但是，在 Android 上支持重新加载图形资源仍然是必要的（或至少是良好的做法）。在许多设备上，如果没有它，您的游戏将无法从切换和返回中优雅地恢复。ExEn 目前不支持重新加载纹理。

Xamarin 目前正在[修复](http://forums.xamarin.com/discussion/comment/2418/#Comment_2418)AndroidGameView 中的一个错误，该错误将允许它在设备支持的位置正确恢复。一旦发布，这应该流向 MonoGame。

除了重新加载纹理和其他图形资源之外，生命周期的处理应该是相当简单的。MonoGame 尚未实现完整的 Windows Phone 生命周期（即墓碑和补水），但根据我的经验，这不是必需的。您可以将`Game.Activated`和`Game.Deactivated`事件用于在恢复游戏时显示暂停屏幕之类的事情。

# jsf-2 - 更新实体时复合组件错误的目标值

> ID：14162555
> 
> 赞同：0
> 
> 时间：2013-01-04T18:13:22.957
> 
> 标签：jsf-2, primefaces, composite-component, spring-data

我收到一个奇怪的错误。我创建了一个简单的 JSF 复合组件，即：

```
 <?xml version="1.0" encoding="ISO-8859-1" ?>  
     <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
    <html xmlns="http://www.w3.org/1999/xhtml"
xmlns:cc="http://java.sun.com/jsf/composite"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:p="http://primefaces.org/ui"
xmlns:f="http://java.sun.com/jsf/core">

<cc:interface>
    <cc:attribute name="fieldId" required="true" />
    <cc:attribute name="targetValue" type="java.sql.Date" required="true" />
    <cc:attribute name="required" default="false" />
    <cc:attribute name="disabled" default="false" />
    <cc:attribute name="styleClass" />
</cc:interface>

<cc:implementation>
    <p:calendar id="#{cc.attrs.fieldId}" disabled="#{cc.attrs.disabled}" required="#{cc.attrs.required}" locale="pt" navigator="true" pattern="dd/MM/yyyy" showOn="button" value="#{cc.attrs.targetValue}" styleClass="#{cc.attrs.styleClass}">
        <f:convertDateTime type="date" dateStyle="short" pattern="dd/MM/yyyy"/> 
        <f:ajax event="blur" execute="@this" render="@this" />
    </p:calendar>
</cc:implementation>

    </html> 
```

我通常在我的表格上使用它：

```
 <p:outputLabel for="inputInicial:dataInicial" value="#{msg['entity.dataInicial']}" />
                    <po:inputData id="inputInicial" targetValue="#{acaoController.entity.dataInicial}" fieldId="dataInicial"/>

                    <p:outputLabel for="inputFinal:dataFinal" value="#{msg['entity.dataFinal']}" />
                    <po:inputData id="inputFinal" targetValue="#{acaoController.entity.dataFinal}" fieldId="dataFinal" /> 
```

而且，当我单击添加新实体时它工作正常...我单击保存，它按预期保存。

当我单击以编辑现有实体并单击保存按钮时...发生此错误：

```
 SEVERE: Servlet.service() for servlet [facesServlet] in context with path [/ProjetoOlimpio] threw exception [javax.el.ELException: /resources/olimpio/inputData.xhtml @18,238 value="#{cc.attrs.targetValue}": Cannot convert 30/12/12 21:00 of type class java.util.Date to class java.sql.Date] with root cause
    javax.el.ELException: /resources/olimpio/inputData.xhtml @18,238 value="#{cc.attrs.targetValue}": Cannot convert 30/12/12 21:00 of type class java.util.Date to class java.sql.Date
        at com.sun.faces.facelets.el.TagValueExpression.setValue(TagValueExpression.java:139)
        at javax.faces.component.UIInput.updateModel(UIInput.java:818)
        at javax.faces.component.UIInput.processUpdates(UIInput.java:735)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIForm.processUpdates(UIForm.java:281)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at org.primefaces.component.layout.Layout.processUpdates(Layout.java:252)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIComponentBase.processUpdates(UIComponentBase.java:1242)
        at javax.faces.component.UIViewRoot.processUpdates(UIViewRoot.java:1231)
        at com.sun.faces.lifecycle.UpdateModelValuesPhase.execute(UpdateModelValuesPhase.java:78)
        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:462)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:395)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:250)
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722) 
```

我的模型当然使用 java.util.Date 类。

```
 import java.util.Date;
    [...]

@Column(name = "data_inicial")
@Temporal(TemporalType.DATE)
private Date dataInicial;

@Column(name = "data_final")
@Temporal(TemporalType.DATE)
private Date dataFinal; 
```

我正在使用 Spring Data 来坚持！很难理解...

为什么它在保存时起作用（而不是在更新时）？为什么单击编辑实体后，它会在视图上正确显示所选日期？

这里有一些关于我的环境的信息：信息：启动 Servlet 引擎：Apache Tomcat/7.0.12 信息：初始化 Mojarra 2.1.10 信息：在 PrimeFaces 3.4.2 上运行 信息：在 PrimeFaces 扩展 0.6.1 上运行

**编辑

1 - 正如我在评论中所说：问题出在复合组件上，如果我将 p:calendar 直接放在它工作的表单上。所以我会把CC的代码片段编辑成整个东西！:)

请注意，我有一个**type="java.sql.Date"**因为我正在测试而被添加。最初它没有类型属性。我还使用**type="java.util.Date**进行了测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-01T08:36:02.850

有一种解决方法，无需更改休眠模式。我更喜欢这种方式，因为所有更改都在 jsf 层中。

您可以在复合组件中使用绑定。下一个代码是 Rich:calendar 示例（使用 java.util.Date）

`... <cc:interface componentType="CalendarComponent">`

 `... </cc:interface>

<cc:implementation>

... <rich:calendar value="#{cc.attrs.value}" binding="#{cc.attrs.calendar}" />

... </cc:implementation>

...

and in CalendarComponent:

```
import java.util.Date;

import javax.faces.component.FacesComponent;
import javax.faces.component.UINamingContainer;
import javax.faces.context.FacesContext;

import org.richfaces.component.UICalendar;

@FacesComponent(value = "CalendarComponent")
public class CalendarComponent extends UINamingContainer {

@Override
public void processUpdates(FacesContext context) {

Object o = calendar.getValue();
   if (o instanceof Date) {
  Date d = (Date) o;
                    //this ensures type changing  
        calendar.setValue(new java.sql.Date(d.getTime()));
    }
    super.processUpdates(context);
}

private UICalendar calendar;

public UICalendar getCalendar() {
    return calendar;
}

public void setCalendar(UICalendar calendar) {
    this.calendar = calendar;
} 
```` 

`}`

# android - 即使手机处于静音模式，也试图让某些联系人响铃

> ID：14162556
> 
> 赞同：1
> 
> 时间：2013-01-04T18:13:22.830
> 
> 标签：android

我正在尝试让某些联系人响铃，即使手机处于静音模式。安装应用程序后第一次来电时，手机没有响铃，但后来病房运行良好....代码中是否有任何问题...

```
 package com.cnu.incoming;

      import android.app.PendingIntent;
      import android.content.BroadcastReceiver;
      import android.content.Context;
      import android.content.Intent;
      import android.hardware.Sensor;
      import android.hardware.SensorEvent;
      import android.hardware.SensorEventListener;
      import android.hardware.SensorManager;
      import android.media.AudioManager;
      import android.os.Bundle;
      import android.telephony.SmsManager;
      import android.telephony.TelephonyManager;
      import android.util.Log;
      import android.widget.Toast;

      public class IncomingCall extends BroadcastReceiver{

      private Context context;
      private String PhNumber;
      private int ringcheck=0;
      String state=null;
      Bundle bundle=null;

@Override
public void onReceive(Context context, Intent intent) {
     AudioManager maudio=(AudioManager)context.getSystemService(context.AUDIO_SERVICE);
        bundle = intent.getExtras();
        this.context = context;

        if(null == bundle)
                return;

        Log.i("IncomingCallReceiver",bundle.toString());

        state = bundle.getString(TelephonyManager.EXTRA_STATE);

        Log.i("IncomingCallReceiver","State: "+ state);

        if(state.equalsIgnoreCase(TelephonyManager.EXTRA_STATE_RINGING))
        {
                check();
                if(PhNumber.equals("+919876543210"))
                makeitNormal();
                PhNumber = bundle.getString(TelephonyManager.EXTRA_INCOMING_NUMBER);

                Log.i("IncomingCallReceiver","Incomng Number: " + PhNumber);

                String info = "Detect Calls Incoming number: " + PhNumber;

                maudio.setRingerMode(AudioManager.RINGER_MODE_NORMAL);

        }

        Log.i("baddu gadu" ,"baddu gadu");

        if(state.equalsIgnoreCase(TelephonyManager.EXTRA_STATE_OFFHOOK))
        {
            makeItSilent();
        }

        if(state.equalsIgnoreCase(TelephonyManager.EXTRA_STATE_IDLE))
        {
            makeItSilent();
        }

}

private void check() {
    // TODO Auto-generated method stub
    AudioManager maudio=(AudioManager)context.getSystemService(context.AUDIO_SERVICE);
    ringcheck=maudio.getRingerMode();

}

private void makeitNormal() {
    // TODO Auto-generated method stub

    AudioManager maudio=(AudioManager)context.getSystemService(context.AUDIO_SERVICE);
    maudio.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
    //Toast.makeText(context, "this is baradwaj", Toast.LENGTH_LONG).show();

}

private void makeItSilent() {
    // TODO Auto-generated method stub
    AudioManager maudio=(AudioManager)context.getSystemService(context.AUDIO_SERVICE);
    int ringer=maudio.getRingerMode();
    if (ringcheck==AudioManager.RINGER_MODE_SILENT){

        maudio.setRingerMode(AudioManager.RINGER_MODE_SILENT);

    }else if(ringcheck==AudioManager.RINGER_MODE_NORMAL){
        maudio.setRingerMode(AudioManager.RINGER_MODE_NORMAL);
    }
    else if(ringcheck==AudioManager.RINGER_MODE_VIBRATE){
        maudio.setRingerMode(AudioManager.RINGER_MODE_VIBRATE);
    }

}

public void onAccuracyChanged(Sensor arg0, int arg1) {
    // TODO Auto-generated method stub

}

public void onSensorChanged(SensorEvent event) {
    // TODO Auto-generated method stub

} 
```

}

# java - 从子类实例的（超类）列表中调用静态方法

> ID：14162558
> 
> 赞同：2
> 
> 时间：2013-01-04T18:13:28.740
> 
> 标签：java, android, static-methods

假设我有一个基类`A`（带有一个名为 的虚拟方法`normalInit()`）和 300 个子类：`A1, A2, A3, ...`每个子类都有一个`staticInit()`静态方法，外加一个`normalInit()`覆盖。（请不要问为什么；这是在生产软件中，已经给出，无法更改设计以更好地重用。实际上，这些子类是由代码生成器生成的，但现在这无关紧要。）

根据应用程序的不同执行，`A1, A2, A3, ...`需要初始化一个（小）子集。换句话说，有一些数据是特定的所有实例`Ai`共同共享或访问的。显然，将这​​些实体定义和处理为`static`成员/方法是合理的（因为它们由 a 的所有实例共享`Ai`）。

那么如何初始化这个子集的静态（并调用静态方法）呢？

简而言之，它不是静态初始化**所有** `Ai`子类的解决方案，因为只需要一个小子集（会浪费内存）。`static`Java 中的行为显然提供了一个解决方案：`static`当第一次访问一个类时，一个类的初始化器被初始化（我在这里忽略了一些特殊情况，例如编译器内联原始最终静态，就像在那种情况下，技术上存在没有类访问权限，仅在源代码级别上）。

问题是，我需要*确定性*（实际上是在预定义时间）静态初始化，因为它们的`static`行为也会访问应用程序的当前静态（全局）状态。所以`static`初始化器不是一个选项，我需要`static`方法，在适当的地方显式地调用它们。

在所讨论的应用程序中，必须在`Ai`通过迭代访问各种类的实例时完成此操作，超类`ArrayList<A>`在哪里`A`。

```
for (int i = 0; i < list.size(); ++i) {
        list[i].normalInit(args); // normalInit() is an instance method
    } 
```

该列表由`Ai`实例组成（例如 950 个实例`A1`、1750 个 实例`A2`等，按未排序的“随机”顺序）。

换句话说，我无权访问具体的类名（所以我不能只调用`A4.staticInit()`），因为我不知道`Ai`列表中有哪些实例。**请注意**，我知道静态是在编译时绑定的，而且我知道多态在这里是不可能的，所以我不是在问如何从上述循环中调用静态方法！具体调用的实例（以及它的`Class`）是在运行时决定的，由于动态调度，何时`normalInit()`被调用。

一个明显的解决方案是从覆盖中调用具体类的`staticInit()`方法：`normalInit()`

```
public class A2 {   

    @Override
    public void normalInit(int[] args) {
        // ...       

        staticInit();
    }

    private static void staticInit() {
           if (!sStaticInitialized)  {
                sStaticInitialized = true;
                ...
           }
    }
} 
```

为此，`Ai`必须修改生成子类的代码生成器模板。

但是这个（和上面的代码）看起来不是一个好的解决方案。我了解整体应用程序设计是否存在一些缺陷，但即使这是您的观点，如果此类声明能够通过额外的（独立的）建设性建议来增强，我将不胜感激。上述问题是否有更好的解决方案/习语？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:34:32.490

好的，使用反射回答它：

```
String classPrefixName = "com.your.company.A";
for (int i = 0; i< 300; i++) {
    Class<?> clazz = Class.forName(classPrefixName+i); //look for the class
    Method method = clazz.getDeclaredMethod("staticInit"); //look for the method
    method.invoke(null); //invoke(null), since it's a static method
} 
```

这样您就不需要将静态方法包装在实例中。

# mysql - 在codeigniter中增加子元素数据库获取

> ID：14162564
> 
> 赞同：0
> 
> 时间：2013-01-04T18:13:55.950
> 
> 标签：mysql, codeigniter, activerecord, array-merge

我正在尝试从包含交叉引用的数据库表中获取一系列 id - 每个元素，一个“主题”，都包含同一个表中的“父主题”列。给定一个父主题，我想构建一个包含所有以它为父主题的子主题的数组，然后是这些主题的所有子主题，等等。

这似乎并不难，但作为一个自学成才的程序员，我觉得我使用了所有错误的工具。尤其是`merge-array()`和`var_dump()`部分，感觉不对，我不确定整体方法。我应该用什么替换这些元素？

```
function get_subtopics($parent_topic)
{
    //returns an array of subtopics minus the first 
    $all_subs = array();

    $query = $this->db->get_where('topics', array('parent_topic' => $parent_topic));

    $subs = $query->result_array();
    $resubs = array();
    $query->free_result();
    //push subs to all_subs

    //while the subs array has members, find their child
    while (count($subs)>0) {
        foreach ($subs as $s) {
            $query = $this->db->get_where('topics', array('parent_topic' => $s['id']));
            $resubs = array_merge($resubs, $query->result_array());
            $query->free_result();
        }
        $all_subs = array_merge($all_subs, $resubs);
        var_dump($resubs);
    }

    //Returns an array of ids
    return $all_subs;
} 
```

编辑：这样做的目的是形成一个主题“池”，从中为随机生成器绘制问题 - 我试图将所有子主题放入一个数组中，没有树结构来区分它们。指定父主题（例如“数学”）的用户应该获得数学子主题（例如“代数”、“代数：二次方”或“微积分”）的均匀组合，从中可以得出问题。希望澄清一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:43:53.750

有两种方法可以做到这一点，或者只是从数据库中获取所有记录，然后使用如下所示的 php 递归函数构建树结构。

```
//Build menu array containing links and subs
$items = Array( 
    //highest level
    'cms' => Array(
        'title' => 'CMS',
        //Array containing submenu items for cms
        'subs' => Array(
            'intro-to-cms' => Array('title' => 'Intro to CMS'),
            'specific-cms' => Array('title' => 'Specific CMS'),
            'installing-a-cms' => Array('title' => 'Installing a CMS')
        ),
    )
);

//Display the menu
echo navlinks($items, $page);

/**
 * Recursive function creates a navigation out of an array with n level children
 * @param type $items
 * @return string containing treestructure
 */
function navlinks($items, $page=false)
{
  $html = '<ul>';
  foreach ($items AS $uri => $info) {
    //Check if the pagename is the same as the link name and set it to current when it is
    $html .= '<li'.($info['title'] == $page ? ' class="current"' : '').'>';
    echo '  <a href="' . $uri . '">' . $info['title'] . '</a>';
    //If the link has a sub array, recurse this function to build another list in this listitem
    if (isset($info['subs']) && is_array($info['subs'])) {
      $html .= navlinks($info['subs']);
    }
    $html .= '</li>';
  }
  $html .= '</ul>';
  return $html;
} 
```

为了只过滤 1 个父级及其底层子级，您需要提前进行一个相当棘手的查询，就像之前关于 stackoverflow 的评论中所解释的那样。（下方链接）

[MySQL父->子查询](https://stackoverflow.com/a/945480/1289385)

# javascript - 奇怪的 js 正则表达式行为

> ID：14162571
> 
> 赞同：1
> 
> 时间：2013-01-04T18:14:15.560
> 
> 标签：javascript, jquery, regex, firebug

我有以下代码：

```
$.get(TASK_FILE, function(data) {
    lines = data.split("\n");
    var place = /@[\S]*/g
    var category = /\+[\S]*/g
    lin = []
    for(line in lines)
    {
    var str = lines[line]
    var res = category.exec(str)
    console.log(res)
        if(res != null) 
    {
        str = str.replace(place, "");
        //lin[res[0]] = str;
    }

    }

    var res = category.exec("Czytanie +rosyjski @komunikacja @podrecznik")
    console.log(res) 
```

TASK_FILE 是文本文件的 url，其中包含：

```
Zadania z fizyki +mFizyka @dom
Czytanie +rosyjski @komunikacja @podrecznik 
```

如您所见，我想获取具有“+something”的文件的列表，并且我想将其保存到 var 但萤火虫输出真的让我大吃一惊： ![在此处输入图像描述](../Images/382201deaa3a9181547aa082eaefa6b3.png)

文件的第一行是正确处理的，但下一行不是。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:39:21.513

使用`g`(global) 标志和`exec`make`exec`从最后一个匹配的结尾继续搜索。当您同时切换搜索主题时，这当然会导致异常。只需使用`match`字符串上的函数即可：

```
str.match(category); 
```

# asp.net - 通过单击按钮动态添加控件

> ID：14162576
> 
> 赞同：0
> 
> 时间：2013-01-04T18:14:28.340
> 
> 标签：asp.net, .net, vb.net, textbox, controls

我正在尝试创建：

1.  一个加载了两个文本框（“item”和“amount”）和一个“add”按钮的表单。

2.  每次单击“添加”按钮时，都会添加另一组与第一组相同的文本框。

3.  单击“添加”按钮时，文本框需要保留在其中输入的任何内容。

做这个的最好方式是什么？我一直在尝试很多不同的东西，但没有一个是完全正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:09:06.253

我不得不在获胜表格和网页上做几次这样的事情。不幸的是，在网页上它不像在 win 表单上那么容易。我确定那里有 JQuery 实现，但我过去的做法是使用中继器。

项目命令事件的处理有点棘手，但我会尽量减少它。关于这个特定项目的一点背景是，我想出了一个界面，人们可以在其中编辑网页上的链接。原版在中继器中包含更多控件，但我对其进行了精简，因此不会占用太多空间。

首先，声明中继器很简单：

```
<asp:Repeater ID="rptLinks" runat="server">
    <HeaderTemplate>
        <table style="width:99%; text-align:center; margin-left:auto; margin-right:auto"><tr>
                <td style="width:15%;"><asp:Label ID="lblDisplayName" runat="server" Text="Display Name:"></asp:Label></td>
            </tr>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td style="width:15%;"><asp:TextBox ID="txtLinkDisplayName" runat="server" Width="95%" Text='<%#Bind("Name") %>'></asp:TextBox></td>
            <td style="width:5%;"><asp:Button ID="btnLinkSave" runat="server" Text="" CssClass="linkButton" style="background-image:url('Images/Save_16.png')" ToolTip="Update Link" CommandName="Update" CommandArgument='<%#Eval("Customer_Link_ID") %>' /></td>
            <td style="width:5%;"><asp:Button ID="btnLinkClear" runat="server" Text="" CssClass="linkButton" style="background-image:url('Images/Cancel_16.png')" ToolTip="Delete Link" CommandName="Delete" CommandArgument='<%#Eval("Customer_Link_ID") %>'/></td>
        </tr>
    </ItemTemplate>
    <FooterTemplate>
            <tr>
                <td style="width:15%;"><asp:TextBox ID="txtLinkDisplayName" runat="server" Width="95%"></asp:TextBox></td>
                <td style="width:5%;"><asp:Button ID="btnLinkNew" runat="server" Text="" CssClass="linkButton" style="background-image:url('Images/Add_16.png')" ToolTip="Save New Link" CommandName="New" /></td>
                <td style="width:5%;"><asp:Button ID="btnLinkCancel" runat="server" Text="" CssClass="linkButton" style="background-image:url('Images/close_16.png')" ToolTip="Clear" CommandName="Clear" /></td>
            </tr>
        </table>
    </FooterTemplate>
</asp:Repeater> 
```

基本上所有这些都是为转发器创建一个模板。标题部分开始表格并包含一个标签。项目模板用于显示绑定到转发器的数据。这种情况下的文本是使用服务器端包含绑定的，并且“绑定”函数中的值需要与绑定到转发器的表中的列完全匹配。在这种情况下，页脚是您输入新条目并关闭表格标签的地方。模板和页脚都包含 2 个按钮。重要的是要注意 CommandName 值是相应设置的，因为稍后将在服务器端使用该值。

因此，一旦客户端设置完毕，我们将需要在服务器上处理项目命令事件。我这样设置我的功能：

```
 Private Sub rptLinks_ItemCommand(ByVal source As Object, ByVal e As System.Web.UI.WebControls.RepeaterCommandEventArgs) Handles rptLinks.ItemCommand
    Try
        'This clears the datasource because if I didn't do this I was getting weird behavior.
        rptLinks.DataSource = Nothing
        rptLinks.DataBind()
        Select Case e.CommandName
            Case "New"
                 'Do whatever you need to for a new record
            Case "Update"
                 'Do whatever you need to to update the record
            Case "Clear"
                 'Clear the controls
            Case "Delete"
                 'Delete the link that is in this row
            Case Else
        End Select
        'rebind the repeater to the updated data.
        rptLinks.DataSource = LinksDatatable
        rptLinks.DataBind()
    Catch ex As Exception
    End Try
End Sub 
```

这是我发现确定单击哪个按钮的最简单方法，但我确信还有其他方法可以完成它。

现在，一旦您遇到需要处理的情况，您最终将需要从控件中获取值，并且您这样做的方式是：`e.Item.FindControl("txtLinkDisplayName")`. 就我而言，我在 directcast() 调用中使用了该代码，并根据需要转换控件以使其更易于使用。

因此，一旦一切就绪，数据绑定并处理每个案例，那么您应该准备好开始了。

# java - 朱尼特。有没有办法让输出格式化为 rspec 输出？

> ID：14162581
> 
> 赞同：2
> 
> 时间：2013-01-04T18:14:50.237
> 
> 标签：java, junit, tdd

我通常用 ruby​​ 编写代码，并使用 rspec 进行单元测试。

现在我必须在 java 中做一些工作，所以我使用的是 JUnit。多个测试套件的输出如下所示；

```
test:
    [junit] Running com.whatever.MapperTest
    [junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 0.542 sec
    [junit] Running com.whatever.ReducerTest
    [junit] Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 0.391 sec
    [junit] Running com.whatever.DenormalizerTest
    [junit] Tests run: 8, Failures: 0, Errors: 0, Time elapsed: 0.046 sec
    [junit] Running com.whatever.EventTest
    [junit] Tests run: 31, Failures: 0, Errors: 0, Time elapsed: 0.081 sec

BUILD SUCCESSFUL
Total time: 5 seconds 
```

这是相当密集的文本，并且很难看到失败和错误。

使用 RSpec，我得到这样的输出；

```
............F........F........E....... 
```

在哪里 '。' 代表通过测试，'F' 是失败，'E' 是错误。此输出下方是所有失败/错误的详细信息。

我发现这种格式更容易查看 - 在查看 JUnit 的正常摘要输出中的运行/失败/错误计数时，失败和错误会以一种它们不会出现的方式出现。

我已经通过 build.xml 文件的 junit 任务中的几个选项，包括：

```
<formatter type="plain" usefile="false" /> 
```

和

```
<junit printsummary="true"> 
```

使用 formatter="plain" 会使屏幕充满过多的冗余信息。我不需要将每一个通道都列为一行文本——理想的只有一个点。

有谁知道是否编写了一个自定义格式化程序来产生类似于我想要的格式的东西？

我使用的任何工具都需要在命令行上运行，所以花哨的 GUI 工具不是一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:08:36.690

您可以编写自己的格式化程序来解决问题。

这里有一些很好的说明可以帮助您入门： [http ://shaman-sir.wikidot.com/one-liner-output-formatter](http://shaman-sir.wikidot.com/one-liner-output-formatter)

基本上，您需要更改 addError 以记录有错误的测试。然后将 endTest() 更改为输出一个 . 而不是那里的所有信息，除非测试在失败或错误集中。

ANT 的 API 包含在它的二进制发行版中。请记住使用新创建的格式化程序更新 junit 格式化程序类名。

# grails - 在 Intellij Idea 中格式化 GroovyServer 页面

> ID：14162586
> 
> 赞同：0
> 
> 时间：2013-01-04T18:15:05.750
> 
> 标签：grails, formatting, intellij-idea

我正在尝试使用 IntelliJ Idea CE 作为编辑器来开发 Grails 网络应用程序。我创建了一个 GSP 文件

```
<!DOCTYPE html>
<html>
<head>
<title>Main</title></head>
<body>Welcome, to my online forum, the date today is ${date}
</body>
</html> 
```

并尝试使用 ctrl+alt+L 格式化，但什么也没发生。

**我的问题**

我们可以在 IntelliJ Idea 中格式化 .gsp 文件吗？如果可以，如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:26:26.273

IntelliJ IDEA 社区版不支持 Grails 开发。IntelliJ IDEA Ultimate 提供对 Grails 开发的全面支持，包括 GSP 页面的格式化。

# javascript - 检索 Fusion Tables 数据时出现问题 - Google Maps API

> ID：14162590
> 
> 赞同：1
> 
> 时间：2013-01-04T18:15:22.050
> 
> 标签：javascript, google-maps-api-3, kml, google-fusion-tables

我正在开发一个 JSP 应用程序，该应用程序检索大量要在地图上显示的多边形。

在告诉我的问题之前，我将尝试解释应用程序是如何工作的。

我的客户需要在谷歌地图上查看他的内部区域划分（一个区域是一组城市，它是一个多对多的关联）。可以通过应用程序菜单加载文件随时更改领土-城市关系。今天我们在系统中有35个地区和大约10000个协会地区城市。

我在 Fusion Tables 中有城市形状的多边形，但是当我尝试检索形状时，出现以下错误：

**为一个地区加载多边形的代码：**

```
layer = new google.maps.FusionTablesLayer({
    query:{
        select: 'geometry',
        from: {MYKEY},
        where: "NAME_CITY IN ("+listOfCities+")"
    }
}); 
```

**错误：**

> 加载资源失败：服务器响应状态为 414 (Request-URI Too Large)

我一直在寻找一种加载这些地区的方法，我已经尝试从 Java 中读取 KML 文件，并发送每个城市的坐标集，但是完成后 HTML 页面就像 300MB，它只是冻结浏览器并没有工作。所以融合表似乎是最好的方法。

由于 listOfCities 变量的大小（某些地区有大约 500 个相关城市），我发现了一些帖子，人们告诉他们使用 POST 方法来请求数据，但他们从未说过如何使用谷歌地图来做到这一点API。

我怎样才能做到这一点？有人有另一种方法来解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T19:44:19.603

您必须以某种方式简化查询。POST 不是一个选项，无法更改用于查询的方法。

但这可能是您可以开始的一点： *可以随时通过应用程序菜单加载文件来更改领土-城市关系。*

如 geocodezip 所建议的，您可以在表中添加另一列来存储“关系”，而不是过滤服务器上的城市并查询城市。

这可以在“文件”上传时自动完成（在这里您可以使用 POST）

新的 where 子句现在将变得简单而简短，例如：**`territory=35`**

# logging - Minicom 忽略某些字符

> ID：14162591
> 
> 赞同：1
> 
> 时间：2013-01-04T18:15:24.003
> 
> 标签：logging, printing, terminal, raspberry-pi, printer-control-language

你好所有的技术救星。

我正在使用 Minicom 成功地将串行数据捕获到文本文件中。串行数据来自发送到 HP 打印机的自动可编程控制器串行端口。

不幸的是，Minicom 忽略了 PCL 字符，例如 esc (ascii 27)。

例子：

从串口发送“(s16H00:01:41”

在 Minicom "16H00:01:41" 中收到

我确信打开 Minicom 时我没有得到正确的命令行。

有什么建议么？

感谢这么多人提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T18:45:32.087

您好，任何对此进行调查的人。

我找到了一条不同的途径，它可以完全满足我的需求，同时将串行数据转发到打印机。在这种情况下，我使用了 Python。

在线提供了 pyserial 的**serial_tcp_redirect.py**的修改版本。此版本允许用户设置可以通过以太网接收串行数据的远程主机。在这种情况下，打印机使用端口 9100 raw telnet。

我能够添加 file.write 选项以将串行数据附加到具有所有 PCL 字符的文件中。

我添加了这些行：

```
 logfile = open("/home/testwrite.txt","a")
        logfile.write("%s"%data)    
        print "%r" %data  #original part of program 
        logfile.close() 
```

# asp.net-mvc-3 - 在刷新MVC3之前获取下拉列表的值

> ID：14162592
> 
> 赞同：-1
> 
> 时间：2013-01-04T18:15:33.057
> 
> 标签：asp.net-mvc-3, onchange, html-select

我一周前刚开始 MVC3，我现在被踩到了，我有一个预填充的下拉列表，但我想在 HTTPpost 之前或者最好每次有人在列表中选择不同的选项来显示它时获取下拉列表的选定值。

```
 @Html.DropDownList("MyList",(object)@ViewBag.chosen)
You have chosen (object)@ViewBag.chosen 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T07:13:27.207

将此代码添加到您的 head 部分

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.0.min.js"></script>

$(document).ready(function () {
      $("#MyList").on("change", function () {
          $("#MyList").after("You have chosen " + $("#MyList").val());
      });
  }); 
```

# google-drive-api - 使用 updatedMin 参数列出评论返回所有评论？

> ID：14162594
> 
> 赞同：2
> 
> 时间：2013-01-04T18:15:44.080
> 
> 标签：google-drive-api

我试过这个页面来学习评论列表方法。

[https://developers.google.com/drive/v2/reference/comments/list#try-it](https://developers.google.com/drive/v2/reference/comments/list#try-it)

我想看看 updatedMin 查询参数的效果。我给了 2014-01-04T17:50:44.012Z 作为 updatedMin 参数的值

似乎它正确地形成了以下网址。

获取[https://www.googleapis.com/drive/v2/files/0B4Qf3Z8Q9xwOSUNaMkx0T25TNms/comments?updatedMin=2014-01-04T17%3A50%3A44.012Z&key=](https://www.googleapis.com/drive/v2/files/0B4Qf3Z8Q9xwOSUNaMkx0T25TNms/comments?updatedMin=2014-01-04T17%3A50%3A44.012Z&key=) {YOUR_API_KEY}

然而，该列表包括所有评论....而我期望为零（因为给出的年份是 2014 年）

请让我知道这里出了什么问题。

提前致谢。

# asp.net-mvc-3 - 在 MVC 3 应用程序中使用 LDAP 实现单点登录？

> ID：14162595
> 
> 赞同：1
> 
> 时间：2013-01-04T18:15:47.477
> 
> 标签：asp.net-mvc-3, authentication, single-sign-on

使用 MVC3、EF 4.1

我需要针对 LDAP 验证用户名，并将他的用户信息存储在对象中，该对象将在他的访问期间持续存在（超时无关紧要）。我需要这个对象来检查是否属于一个组？

启用访问的示例属性：isNextGenMonitor、isNextGensupervisor、isNextGenLead 和 isNextGenadmin

还包括用户信息：名字、姓氏、部门、电子邮件

任何人都可以发布创建用户对象的链接或示例，该对象将包含他的组列表和用户信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:18:24.517

实现单点登录的唯一方法是使用 Kerberos (SPNEGO) 而不是 LDAP。该框架将为您提供`SecurityPrincipal`由 IIS 获得的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T09:32:29.233

我看不到“通过使用 Kerberos (SPNEGO)”的持久性。

对于 SSO，请查看 SAML 或 Liberty 框架。

目前尚不清楚为什么您需要另一个对象来实现 LDAP 之外的持久性。-吉姆

# ruby - Ruby 使用非 libcurl 库上传文件

> ID：14162599
> 
> 赞同：2
> 
> 时间：2013-01-04T18:16:09.247
> 
> 标签：ruby, sinatra, httpclient

出于纯粹的好奇，我使用以下行将文件上传到 Sinatra 应用程序：

```
curl -silent --location --upload-file #{file} http://0.0.0.0:3000/sent/ 
```

它就像魅力一样。但是，如果我想使用像[HTTPClient](https://github.com/nahi/httpclient)这样的纯 ruby​​ 解决方案，获得相同结果的代码是什么？能给我举个例子？

**注意**：我对**libcurl**相关的解决方案不感兴趣。如果还有其他 gem，除了*HTTPClient*可以在**纯 ruby**​​ 中实现这一点，请分享。

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:30:56.583

Ruby 的[Net::HTTP](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html)允许您上传文件。从文档中：

```
uri = URI('http://www.example.com/todo.cgi')
req = Net::HTTP::Post.new(uri.path)
req.set_form_data('from' => '2005-01-01', 'to' => '2005-03-31')

res = Net::HTTP.start(uri.hostname, uri.port) do |http|
  http.request(req)
end

case res
when Net::HTTPSuccess, Net::HTTPRedirection
  # OK
else
  res.value
end 
```

将文件的正文添加到`set_form_data`哈希中，您应该可以上路了。

# backbone.js - “未捕获的 TypeError：未定义不是函数”初始化 Backbone 集合

> ID：14162605
> 
> 赞同：11
> 
> 时间：2013-01-04T18:16:33.003
> 
> 标签：backbone.js

我有一个 Backbone 集合，如下所示：

```
var FooCollection = Backbone.Collection.extend({
    model:Foo,

    initialize: function (attributes, options) {
        this.barId = options.barId;
    }
});

var Foo = Backbone.Model.extend({}); 
```

当我尝试初始化它时，我`_prepareModel()`在`Backbone.Collection`.

坏电话在`model = new this.model(attrs, options)`.

```
// Prepare a model or hash of attributes to be added to this collection.
_prepareModel: function(model, options) {
  options || (options = {});
  if (!(model instanceof Model)) {
    var attrs = model;
    options.collection = this;
    model = new this.model(attrs, options); // <-- BLOWS UP HERE
    if (!model._validate(model.attributes, options)) model = false;
  } else if (!model.collection) {
    model.collection = this;
  }
  return model;
}, 
```

当我在调试器中单步执行时，此时`_prepareModel()`的类型看起来是，实际上是未定义的。`this``child``this.model`

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-04T19:00:47.230

在我的实际代码`Foo`中是在`FooCollection`. 没有意识到 Javascript 不支持前向声明。**[总台]**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-03T23:54:35.880

我遇到了同样的问题。我的问题是我在收集脚本之后包含了我的模型脚本：

```
<script src="scripts/collections/Classes.js"></script>
<script src="scripts/models/Class.js"></script> 
```

要修复它，我只需将 Class.js 移到 Classes.js 上方：

```
<script src="scripts/models/Class.js"></script>
<script src="scripts/collections/Classes.js"></script> 
```

干杯

# javascript - 如何在 NicEdit RTE 中保存/恢复或保持光标位置？

> ID：14162609
> 
> 赞同：0
> 
> 时间：2013-01-04T18:16:49.487
> 
> 标签：javascript, asp.net, rich-text-editor, nicedit

我正在尝试将光标位置保存在我的 NicEdit 富文本编辑器中，以便在发布到服务器后我可以恢复用户正在工作的确切位置。

目前我正在尝试在客户端完成这一切，以便在尝试在帖子期间保存范围变量之前确保它可以正常工作。

```
<textarea id="editor" style="height:500px;width:500px;"></textarea>    
<input type="button" value="Save Postion" onclick="SavePosition();return false;" />
<input type="button" value="Restore Postion" onclick="RestorePosition();return false;" />

<script type="text/javascript">
    var editor;
    $(function () {
        editor = new nicEditor({ fullPanel: false });
        editor.addInstance('editor');
    });

    var range = null;
    var sel = null;
    function RestorePosition() {
        editor.nicInstances[0].selRng(range, sel);
        $('.nicEdit-main').focus();
    }
    function SavePosition() {
        range = editor.nicInstances[0].getRng();
        sel = editor.nicInstances[0].getSel();
        $('.nicEdit-main').focus(); 
    }
</script> 
```

如果用户突出显示一个单词，点击保存，点击其他地方然后点击恢复选择将被恢复。
但是，如果在按下 Save 时光标只是在那里闪烁，则按下 Restore 会将光标移动到开始处。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:36:53.190

好的，结果比我想象的要简单。我不得不忽略提供的功能，直接对内容可编辑的 div 进行操作。我还必须使用书签，因为我可以将书签字符串存储在隐藏字段中。

我还应该提到，这很可能只适用于 IE。

```
 var bookmark = null;
    function RestorePosition() {
        $('.nicEdit-main').focus();
        var range = document.selection.createRange();
        range.moveToBookmark(bookmark);
        range.select();
        $('.nicEdit-main').focus();
    }
    function SavePosition() {
        $('.nicEdit-main').focus();
        bookmark = document.selection.createRange().getBookmark;
        $('.nicEdit-main').focus();
    } 
```

# c++ - IDEone 执行时间代表什么

> ID：14162612
> 
> 赞同：1
> 
> 时间：2013-01-04T18:17:01.027
> 
> 标签：c++, time, execution

我正在使用 IDEone，我想知道执行后的“时间”值代表什么。

我正在执行的代码是一个简单的 hello world，其中我有一个 fork() 调用和一个 sleep(1)，它是一个 1 秒的睡眠，从 IDEone 返回的时间值是 0.01 ...

```
 result: Success      time: 0.01s    memory: 2680 kB     returned value: 0 
```

关于时间代表的任何解释？他们的常见问题解答中没有太多内容。

认为时间代表执行的 CPU-Time 是否正确？

# php - Yii 验证码不适用于博客

> ID：14162614
> 
> 赞同：1
> 
> 时间：2013-01-04T18:17:04.077
> 
> 标签：php, yii

我已经在这里应用了所有其他关于损坏 yii 验证码的解决方案，但无济于事。所以我要添加我自己的问题。

我已经阅读了 yii 博客教程（http://www.yiiframework.com/doc/blog/），但我不想让评论获得批准，我想在评论表单中有一个验证码。我已将此添加到评论表单视图中：

```
 <?php if(CCaptcha::checkRequirements()): ?>
    <div class="row">
            <?php echo $form->labelEx($model,'verifyCode'); ?>
            <div>
            <?php $this->widget('CCaptcha'); ?>
            <?php echo $form->textField($model,'verifyCode'); ?>
            </div>
            <div class="hint">Please enter the letters as they are shown in the image above.
            <br/>Letters are not case-sensitive.</div>
            <?php echo $form->error($model,'verifyCode'); ?>
    </div>
    <?php endif; ?> 
```

在 CommentController 中，accessRules() 变为：

```
public function accessRules()
{
        return array(
                array('allow',  // allow all users to perform 'index' and 'view' actions
                        'actions'=>array('index','view', 'captcha'),
                        'users'=>array('*'),
                ),
                array('allow', // allow authenticated user to perform 'create' and 'update' actions
                        'actions'=>array('create','update'),
                        'users'=>array('@'),
                ),
                array('allow', // allow admin user to perform 'admin' and 'delete' actions
                        'actions'=>array('admin','delete'),
                        'users'=>array('admin'),
                ),
                array('deny',  // deny all users
                        'users'=>array('*'),
                ),
        );
} 
```

我在 CommentController 中覆盖了 actions()：

```
public function actions()
{
    return array(
        // captcha action renders the CAPTCHA image displayed on the contact page
        'captcha'=>array(
            'class'=>'CCaptchaAction',
            'backColor'=>0xD99D25,
        ),
    );
} 
```

在 Comment 模型中，我添加了一条新规则：

```
array('verifyCode', 'captcha', 'on' => 'insert', 'allowEmpty'=>!Yii::app()->user->isGuest) 
```

和新的公众成员：

```
public $verifyCode; 
```

联系表格上的验证码工作正常。但是在评论表单中，图像已损坏，并且刷新它的链接不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T15:59:13.950

我将此代码添加到博客演示中，看起来对验证码的请求将发送到 PostController 而不是 CommentController。如果您将验证码操作添加到 PostController，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T07:43:34.220

你有没有打开你的萤火虫或网络检查器？它在验证码请求上给你什么响应？

# iis-7.5 - IIS 7.5 多个静态站点和一个应用程序池

> ID：14162615
> 
> 赞同：2
> 
> 时间：2013-01-04T18:17:12.333
> 
> 标签：iis-7.5, application-pool

我有一个服务器托管大约 40 个静态站点，全是 HTML，没有服务器端代码。我想通过将所有应用程序池合并为一个来提高此服务器的效率。现在，每个站点都有自己的应用程序池，如果有任何代码要执行，这将是有意义的。

所以我的问题是：从一个应用程序池托管 40 个站点是否安全，即使它们都是静态站点？这样做会带来性能上的好处吗？（即使用更少的内存？）

谢谢！

# jsf - 使用 GET 参数在 JSF 中初始化 SessionBean 的数据

> ID：14162617
> 
> 赞同：0
> 
> 时间：2013-01-04T18:17:21.027
> 
> 标签：jsf, postconstruct

我的导航案例如下。我有一个登录页面，我可以从中导航到商店页面。此商店页面可以使用两种不同的产品目录。这由给定的零售商对象控制。

从商店页面开始，有多个 bean 和页面将依赖于会话中的零售商。切换零售商的事件是来自登录页面的新选择。我可以通过在选择中触发一个动作然后导航到商店页面来控制会话中的零售商。但这必须在 bean 中的一个动作中进行控制。

我的问题是从导航栏直接导航到商店页面的情况。所以我需要一些机制来初始化商店页面中的给定零售商。这必须在该页面所依赖的每个 bean 上执行。这应该通过 GET 参数来完成。我可以在 preRenderView 侦听器处通过复杂的决定来实现这种行为，但我不觉得这是更优雅的方式。

因此，潜在的问题是**如何拦截到页面的直接导航，该页面的数据由多个 bean 管理（无论它们的范围如何），并在 session 中引入一些东西，**这些 bean 将在它们的操作中使用。

我已经尝试过了（在 SessionScoped bean 中）：

1) 如果我使用 @PostConstruct + @ManagedProperty(with param) 我在实例化 bean 时收到错误，因为 bean 是 SessionScoped

2）如果我使用 viewParam + preRenderView 事件，则在事件之前注入参数并获得我想要的行为，但是每次加载页面时都会发生这种情况。

我希望这个初始化只发生一次，并且我想使用 GET 参数。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:03:02.177

其中一种方法是仅在`f:viewParam`值仍然为时才执行工作`null`。

```
public void init() {
    if (value == null) {
        // ...
    }
} 
```

另一种方法是仅在非回发时执行该工作：

```
public void init() {
    if (!FacesContext.getCurrentInstance().isPostback()) {
        // ...
    }
} 
```

请注意，当在同一会话中触发新的 GET 请求时，这仍然会执行，并且您通常希望为此使用`@ViewScoped`bean 来防止多个浏览器选项卡/窗口相互干扰。

### 也可以看看：

*   [<f:metadata>、<f:viewParam> 和 <f:viewAction> 可以用来做什么？](https://stackoverflow.com/questions/6377798/what-can-fmetadata-and-fviewparam-be-used-for/6377957#6377957)
*   [如何选择合适的bean范围？](https://stackoverflow.com/questions/7031885/how-to-choose-the-right-bean-scope/7031941#7031941)

# google-fusion-tables - FusionTable API 查询 LIKE 运算符和通配符

> ID：14162620
> 
> 赞同：0
> 
> 时间：2013-01-04T18:17:28.383
> 
> 标签：google-fusion-tables

[当我根据从此处](https://developers.google.com/fusiontables/docs/v1/sql-reference)链接的[LIKE 文档](http://en.wikipedia.org/wiki/Like_%28SQL%29#LIKE)使用通配符时，查询不起作用。

```
SELECT * FROM mytable WHERE country LIKE 'Cana%' 
```

找不到匹配项并返回错误请求 400。当我将 'Cana%' 替换为 'Canada' 时，它可以工作，返回所有包含 'Canada' 的记录。

*   如何编写查询以使用通配符？
*   LIKE 是否适用于正则表达式？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:43:20.853

重要的是要知道如何发送请求。

% 用于在 URL 内进行编码，请尝试使用`%25`而不是`%`.
（`%25`是 url 编码的百分号）

示例：（[表](https://www.google.com/fusiontables/DataSource?docid=1GVGnBtjVXdwvVjLNVwbP_Pzy_I6rbqu0gv5njBM)）

`[SELECT Kilograms FROM 1GVGnBtjVXdwvVjLNVwbP_Pzy_I6rbqu0gv5njBM where Country LIKE 'Can%25'](https://www.googleapis.com/fusiontables/v1/query?sql=SELECT%20Kilograms%20FROM%201GVGnBtjVXdwvVjLNVwbP_Pzy_I6rbqu0gv5njBM%20where%20Country%20LIKE%20%27Can%25%27%20&key=AIzaSyAm9yWCV7JPCTHCJut8whOjARd7pwROFDQ)`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-07T13:06:35.963

这对我不起作用。我使用以下代码：

```
function changeMap() {
  var searchString = document.getElementById('searchString').value.replace("'", "\\'");
  layer.setQuery("SELECT 'lat' FROM " + tableid + " WHERE 'nameloc' CONTAINS IGNORING CASE '" + searchString + "'");
  return false;
} 
```

好的，当您使用数字 tableid，但不使用加密的 tableid 时！（LIKE 或 MATCHES 而不是 CONTAINS IGNORING CASE 没有区别）。

# java - 当单例为假时销毁方法不执行

> ID：14162621
> 
> 赞同：2
> 
> 时间：2013-01-04T18:17:35.483
> 
> 标签：java, spring

我是 Spring 框架的新手。当单例为真执行程序并在 xml 文件中指定销毁方法时，会执行指定的销毁方法，但单例为假时不执行。

在谷歌搜索时，我在某个地方知道 spring 无法管理非单例 bean 的完整生命周期。那么我们如何销毁该bean，以及spring无法管理非单例bean的完整生命周期的原因是什么。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:27:44.877

如果 bean 是 Spring `singleton`，那么每次你请求它时，Spring 都会给你同样的一个。因此，Spring 必须始终保留此 bean 的句柄，因此 Spring 可以在`ApplicationContext`关闭时将其销毁。

如果 bean 不是 Spring `singleton`，那么每次你请求一个 bean 时，你都会得到它的一个新实例（具有相同的配置）。由于 Spring 不需要持有这些 bean，它们不会对它们保持句柄，并且没有对它们的句柄，它们如何在`ApplicationContext`关闭时调用方法来销毁它们？他们不能。

现在，您可能会问，为什么 Spring 不保留从非单例范围创建的 bean 的列表？嗯，一个问题是记忆。如果这是一个长期存在的应用程序，有很多请求创建了许多`prototype`作用域 bean，那么我们可以看到 Spring 跟踪很多对象，这可能会占用宝贵的内存。

当然还有其他潜在的问题，可能太多了，无法在此处列出，所以我将保留它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:26:41.380

从[参考文档](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/beans.html#beans-factory-scopes-prototype)，第 5.5.2 节：

> 与其他作用域相比，Spring 不管理原型 bean 的完整生命周期：容器实例化、配置和以其他方式组装原型对象，并将其交给客户端，而无需进一步记录该原型实例。因此，尽管在所有对象上调用初始化生命周期回调方法而不考虑范围，但在原型的情况下，不会调用配置的销毁生命周期回调。客户端代码必须清理原型范围的对象并释放原型 bean 持有的昂贵资源。要让 Spring 容器释放原型范围的 bean 持有的资源，请尝试使用自定义 bean 后处理器，它包含对需要清理的 bean 的引用。
> 
> 在某些方面，Spring 容器对于原型作用域 bean 的作用是替代 Java 的 new 操作符。此后的所有生命周期管理都必须由客户处理。（有关 Spring 容器中 bean 生命周期的详细信息，请参阅第 5.6.1 节，“生命周期回调”。）

所以原因是他们决定在使用原型时不处理破坏。也许他们发现如果允许的话，可能会出现意想不到的问题。所以我很遗憾地说你必须自己处理破坏。

想多了，觉得有道理。如果您多次调用该方法，您将始终收到一个新的 bean 副本。如果要在容器关闭时调用每个副本的 dispose 方法，则 Spring Container 必须保留对每个副本的引用。这会造成令人不快的内存消耗。

# sql-server-2008 - 引用另一行的计算列函数？

> ID：14162622
> 
> 赞同：0
> 
> 时间：2013-01-04T18:17:36.777
> 
> 标签：sql-server-2008, tsql, sql-server-2005

我对 SQL 有点陌生，并且无法将此代码转换为可用于计算列的函数。这非常适合作为选择语句。

```
select (coalesce(a.samplevalue - (
    select b.samplevalue 
    from numericsamples b 
    where b.rowid = a.rowid - 1), a.samplevalue)) as Diff 
from dbo.NumericSamples a 
```

这基本上只是减去前一行的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T06:54:18.917

具有以下定义的 a`VIEW`对您来说不是更好吗？使用`ISNULL()`而不是`COALESCE()`我相信它会稍微快一点。我不确定我的 JOIN 标准是否正确。

```
CREATE VIEW [dbo].[Answer]
WITH SCHEMABINDING -- !Please read up about SCHEMABINDING!
AS
SELECT   T1.rowid 
        ,Result = ISNULL(T1.samplevalue - T2.samplevalue, T1.samplevalue)
FROM dbo.NumericSamples T1
JOIN dbo.NumericSamples T2  ON T1.rowid - 1 = T2.rowid 
--  OR
--  JOIN dbo.NumericSamples T2  ON T1.rowid = T2.rowid -1 
```

关于`ISNULL()`vs `COALESCE()`- 在这种情况下似乎`ISNULL()`更快

```
IF OBJECT_ID('tempdb.dbo.#ISNULL') IS NOT NULL DROP TABLE #ISNULL
IF OBJECT_ID('tempdb.dbo.#COALESCE') IS NOT NULL DROP TABLE #COALESCE

DECLARE @StopW DATETIME = GETDATE()
SELECT   T1.rowid 
        ,Result = ISNULL(T1.samplevalue - T2.samplevalue, T1.samplevalue)
INTO #ISNULL
FROM dbo.NumericSamples T1
JOIN dbo.NumericSamples T2  ON T1.rowid - 1 = T2.rowid 

PRINT DATEDIFF(MS, @StopW, GETDATE())
SET @StopW = GETDATE()

SELECT   T1.rowid 
    ,Result = COALESCE(T1.samplevalue - T2.samplevalue, T1.samplevalue)
INTO #COALESCE
FROM dbo.NumericSamples T1
JOIN dbo.NumericSamples T2  ON T1.rowid - 1 = T2.rowid 

PRINT DATEDIFF(MS, @StopW, GETDATE()) 
```

# ruby-on-rails - gmaps4rails：多个对象（json）

> ID：14162624
> 
> 赞同：0
> 
> 时间：2013-01-04T18:17:39.200
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gmaps4rails

在控制器中，我想尝试这样的事情：

```
@json = User.all.to_gmaps4rails
@json << Admin.all.to_gmaps4rails 
```

但那是行不通的。是否有标准实现如何处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:41:18.160

你可以这样做：

```
json_hash  = JSON.parse(User.all.to_gmaps4rails)
json_hash2 = JSON.parse(Admin.all.to_gmaps4rails)
@json      = (json_hash + json_hash2).to_json 
```

不太好，也许我应该修补宝石。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T07:11:27.617

```
(JSON.parse( User.all.to_gmaps4rails) + JSON.parse( Admin.all.to_gmaps4rails)).to_json 
```

# c++ - 代码块内存限制

> ID：14162632
> 
> 赞同：4
> 
> 时间：2013-01-04T18:18:01.383
> 
> 标签：c++, memory-management, codeblocks, memory-limit

如何增加 C 程序的内存限制。我正在使用代码块并尝试以下代码 -

```
int arr[10000000] 
```

它给了我运行时错误。我正在使用 Linux（Fedora）。有什么帮助...？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:33:02.693

这个声明发生在哪里？我认为它应该适合 Linux 机器的内存，但可能不适合堆栈，除非您采取特殊操作（例如`ulimit -s`）。一般来说，使用大型本地 C 样式数组不是一个好主意——事实上，除了特殊情况，使用本地数组根本不是一个好主意。只需像定义 C++ 中的任何普通数组一样定义它：

```
std::vector<int> arr( 10000000 ); 
```

这会将实际数据移动到堆上，这可能是如此大的数据集所属的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:30:13.047

```
int arr[10000000]; 
```

它对我有用.. 我不认为这取决于 C::B，我认为这是来自您的计算机。

# .net - 如何让 WebAPI 拒绝带有无效负载的请求？

> ID：14162636
> 
> 赞同：3
> 
> 时间：2013-01-04T18:18:12.383
> 
> 标签：.net, asp.net-mvc-4, asp.net-web-api

我在 web api 中使用了一些版本控制技术，这些技术基本上会根据标头中指定的 api 版本调用控制器。因此，假设我们有一个名为 api/GetSalesHistory 的入口点，但我们的服务器人员（我）必须更改请求合同才能让我们做我们需要做的事情。在某些情况下，这会成为重大更改（例如新的必填字段，或已更改为列表的单个值），因此需要进行版本控制。

因此，我的路由选择器将在标头中查找 api 版本，然后调用正确的控制器。版本1控制器具有版本1请求的参数类型，版本2控制器具有版本2请求的参数类型。

这就是问题所在。开箱即用，无论您发送的有效负载如何，控制器都会运行。回到 WCF，如果您发送了错误的对象，序列化将失败，从而导致整个请求失败。现在，如果我将版本 1 有效负载发送到版本 2 控制器，而不是序列化失败或请求失败，它会创建一个带有空字段的版本 2 请求的实例，然后继续运行。所以参数不会以null的形式出现，所以我不能简单地说 if(request == null) explode;

如果未收到预期的有效负载，如何强制控制器拒绝请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T06:01:14.927

我忘记了您可以使用 ModelState.IsValid 它将在上下文中解决目标。我只是检查：

```
if(!ModelState.IsValid) throw 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T20:17:13.793

任何反序列化异常都会记录在 ModelState 中，以便您以任何您喜欢的方式处理它们。所以你应该能够检查一个无效的 ModelState 并适当地处理它。这篇博文可能会给你一些想法：

[http://blogs.msdn.com/b/youssefm/archive/2012/06/28/error-handling-in-asp-net-webapi.aspx](http://blogs.msdn.com/b/youssefm/archive/2012/06/28/error-handling-in-asp-net-webapi.aspx)

# yui - 如何克隆 YUI3 中的元素？

> ID：14162638
> 
> 赞同：4
> 
> 时间：2013-01-04T18:18:22.707
> 
> 标签：yui

我有 div 元素，里面还有更多的元素，比如 UL 、 span 等。

那么，我如何克隆像 jquery clone 这样的元素。

请不要建议[http://www.jsrosettastone.com/](http://www.jsrosettastone.com/)因为我已经在那里检查过了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T19:37:55.573

```
YUI().use('node', function(Y){
   var node = Y.one('#doc');
   var clone = node.cloneNode(true); // true tells it to do a deep clone
}); 
```

它在 YUI API 文档中：http: [//yuilibrary.com/yui/docs/api/classes/Node.html#method_cloneNode](http://yuilibrary.com/yui/docs/api/classes/Node.html#method_cloneNode)

# android - Listview 持有人位置已洗牌

> ID：14162640
> 
> 赞同：3
> 
> 时间：2013-01-04T18:18:25.443
> 
> 标签：android, listview, imageview

我对 ListView 有疑问，或者更准确地说 - ImageView 放在上面。我的应用正在从 Youtube 下载缩略图。那个地方的一切都很好。后来，在使用 getView() 时出现了一个奇怪的行为。当我在 if 条件下将数据加载到持有者时：

```
 if(convertView == null){

convertView = mInflater.inflate(R.layout.list_item_user_video, null);
holder = new ViewHolder();  

holder.title = (TextView) convertView.findViewById(R.id.userVideoTitleTextView); 
holder.thumb = (UrlImageView) convertView.findViewById(R.id.userVideoThumbImageView);
Video video = videos.get(position);
holder.title.setText(video.getTitle());
holder.thumb.setImageDrawable(video.getThumbUrl());
                convertView.setTag(holder);
            } 
```

我的应用程序很快，但每对 ImageView 和 TextView 的位置在快速滚动时会被打乱。当部分：

```
 Video video = videos.get(position);
                holder.title.setText(video.getTitle());
                holder.thumb.setImageDrawable(video.getThumbUrl()); 
```

不在 if(convertView == null) ImageView 和 TextView 应该在的地方，但应用程序非常慢。我已经检查了所有内容，但我完全不知道如何解决这个问题。你可以帮帮我吗？如果您需要额外的信息，请询问。

谢谢。

视频Activity.java

```
 public class VideosAdapter extends BaseAdapter{
    // The list of videos to display
    List<Video> videos;
    // An inflator to use when creating rows
    private LayoutInflater mInflater;

    public VideosAdapter(Context context, List<Video> videos) {
        super();
        this.videos = videos;
        this.mInflater = LayoutInflater.from(context);
    }

    @Override
    public int getCount() {
        return videos.size();
    }

    @Override
    public Object getItem(int position) {
        return videos.get(position);
    }
@Override
    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;          

        if(convertView == null){

            convertView = mInflater.inflate(R.layout.list_item_user_video, null);
            holder = new ViewHolder();  

            holder.title = (TextView) convertView.findViewById(R.id.userVideoTitleTextView); 
            holder.thumb = (UrlImageView) convertView.findViewById(R.id.userVideoThumbImageView);
            Video video = videos.get(position);
        holder.title.setText(video.getTitle());
        holder.thumb.setImageDrawable(video.getThumbUrl());
            convertView.setTag(holder);
        }

        else {
            holder = (ViewHolder) convertView.getTag();
        }

    return convertView;
    }
    static class ViewHolder{
        UrlImageView thumb;
        TextView title;
        Video video;
        int id;
    }
} 
```

UrlImageView.java

```
 public class UrlImageView extends LinearLayout {

        private Context mContext;
        private Drawable mDrawable;
        private ProgressBar mSpinner;
        private ImageView mImage;

        public UrlImageView(Context context, AttributeSet attrs) {
            super(context, attrs);
            init(context);
        }

        public UrlImageView(Context context) {
            super(context);
            init(context);
        }

        private void init(final Context context) {
            mContext = context;

            mImage = new ImageView(mContext);
            mImage.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
            mImage.setVisibility(View.GONE);

            mSpinner = new ProgressBar(mContext);
            mSpinner.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

            mSpinner.setIndeterminate(true);

            addView(mSpinner);
            addView(mImage);
        }

        public void setImageDrawable(final String url) {
            mDrawable = null;
            mSpinner.setVisibility(View.VISIBLE);
            mImage.setVisibility(View.GONE);
            new Thread() {
                public void run() {
                    try {
                        mDrawable = getDrawableFromUrl(url);
                        imageLoadedHandler.sendEmptyMessage(RESULT_OK);
                    } catch (MalformedURLException e) {
                        imageLoadedHandler.sendEmptyMessage(RESULT_CANCELED);
                    } catch (IOException e) {
                        imageLoadedHandler.sendEmptyMessage(RESULT_CANCELED);
                    }

                };
            }.start();
        }

        private final Handler imageLoadedHandler = new Handler(new Callback() {
            @Override
            public boolean handleMessage(Message msg) {
                switch (msg.what) {
                case RESULT_OK:
                    mImage.setImageDrawable(mDrawable);
                    mImage.setVisibility(View.VISIBLE);
                    mSpinner.setVisibility(View.GONE);
                    break;
                case RESULT_CANCELED:
                default:
                    // Could change image here to a 'failed' image
                    // otherwise will just keep on spinning
                    break;
                }
                return true;
            }
        });

        private static Drawable getDrawableFromUrl(final String url) throws IOException, MalformedURLException {

            return Drawable.createFromStream(((InputStream) new URL(url).getContent()), "name");
        }

    } 
```

list_item_user_video.xml

```
<?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:gravity="center_vertical"
        android:orientation="horizontal" >

        <com.example.example.ui.widget.UrlImageView
            android:id="@+id/userVideoThumbImageView"
            android:layout_width="60dp"
            android:layout_height="45dp"
            android:layout_marginRight="10dp"
            android:contentDescription="YouTube video thumbnail"
            android:src="@drawable/ic_launcher"/>

        <TextView
            android:id="@+id/userVideoTitleTextView"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="Video Title Not Found" />

    </LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:23:48.353

从 VideosAdapter 的 getView() 方法中的 if/else 中移动以下行

```
holder.title.setText(video.getTitle());
holder.thumb.setImageDrawable(video.getThumbUrl()); 
```

就在上面

```
return convertView; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:26:17.507

您没有修改现有视图。If `convertView`is not null 这意味着 Android 正在回收视图而不是膨胀它，但您仍然必须使用新值更新它。像这样的东西会起作用：

```
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;          

    if(convertView == null) {
        convertView = mInflater.inflate(R.layout.list_item_user_video, null);
        holder = new ViewHolder();  
    }

    else {
        holder = (ViewHolder) convertView.getTag();
    }

    holder.title = (TextView) convertView.findViewById(R.id.userVideoTitleTextView); 
    holder.thumb = (UrlImageView) convertView.findViewById(R.id.userVideoThumbImageView);
    Video video = videos.get(position);
    holder.title.setText(video.getTitle());
    holder.thumb.setImageDrawable(video.getThumbUrl());

    convertView.setTag(holder);

    return convertView;

} 
```

PS 使用`Ctrl`++`Shift`很好`F`地格式化您的代码。:)

# android - 加速度计跳跃/步行/跑步手势，使用哪种方法

> ID：14162645
> 
> 赞同：1
> 
> 时间：2013-01-04T18:19:14.813
> 
> 标签：android, accelerometer, gesture

在我深入手势识别之前，我似乎有一些选择要做。我正在查找有关动态时间规整 (DTW) 和隐马尔可夫模型的读数。这两个主题都相当大，可能会让我花费大量时间。

为了识别跳跃或步行/跑步之类的东西，是否值得使用这些复杂的模型？如果是这样，出于某种特定原因，一个比另一个更好吗？

此处的用法涉及您手中或口袋中的电话。

# android - Android：使用 ListView ArrayAdapter/ArrayList

> ID：14162646
> 
> 赞同：1
> 
> 时间：2013-01-04T18:19:19.460
> 
> 标签：android, arrays

我是使用 Android 编程的新手，我试图通过允许用户通过 EditText 输入文本来制作 ListView。我终于让它工作了，但是我不太确定为什么我的第一种方法不起作用：

```
adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,values);
lv.setAdapter(adapter); 
```

这导致应用程序启动时强制关闭，我发现这是由于 lv.setAdapter(adapter)

在经历了许多 stackoverflow 问题后，我看到一个答案说不需要使用 ArrayList 和 ArrayAdapter。所以我尝试了以下方法，它奏效了：

```
adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1);
    lv.setAdapter(adapter); 
```

这一次当我没有创建数组列表时它工作得很好。

所以，我的问题是为什么当我没有在我的 ArrayAdapter 中定义/创建字符串数组时这会起作用，以及为什么我的第一个方法不起作用。

提前感谢您的帮助，如果我没有发布足够的代码，我很抱歉。

**编辑：** 这是我下面的第一个方法我试图重新创建我的第一个方法，它在下面：它仍然像第一次一样强制关闭。请注意，在我的第二种方法（有效）中，我所做的只是不使用 ArrayList 并在 arrayAdapter 构造中采用第三个参数。同样，既然您的回答告诉我，我的值可能为“null”，我认为您是正确的。我怎样才能纠正这个以备将来使用？谢谢！

```
public class TaskPage extends SherlockActivity {

EditText display;
ListView lv;
ArrayAdapter<String> adapter;
Button addButton;
ArrayList<String> values;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    display = (EditText) findViewById(R.id.editText1);
    lv = (ListView) findViewById(R.id.listView1);
    addButton = (Button) findViewById(R.id.button1);

    adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, values);
    lv.setAdapter(adapter);

    addButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            String task = display.getText().toString();
            values.add(task);
            adapter.notifyDataSetChanged();

        }
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:25:15.507

如果第二种方法有效，但第一种方法无效，则`values`至少有一个元素是`null`. 当 Adapter 尝试将此 null 值与 TextView 绑定时，这将引发异常。
只需从`values`.

来自 ArrayAdapter 的[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/widget/ArrayAdapter.java#ArrayAdapter.getView%28int%2Candroid.view.View%2Candroid.view.ViewGroup%29)：

```
T item = getItem(position);
if (item instanceof CharSequence) { // A null value throws an NPE here
    text.setText((CharSequence)item);
} else {
    text.setText(item.toString());
} 
```

* * *

我越想它`values`本身也可能是空的……这就是 LogCat 错误和调试器*非常方便*的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:36:26.700

确保`values`and`lv`不为空，并且不包含任何空元素后，这应该在 YourActivity 中工作，或者属于它的子类。：

```
adapter = new ArrayAdapter<String>(YourActivity.this, android.R.layout.simple_list_item_1, values);
lv.setAdapter(adapter); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-07T15:01:18.783

这篇文章很老了，但我遇到了它，想补充一下对我的修复。根据文档（[http://developer.android.com/reference/android/widget/ArrayAdapter.html](http://developer.android.com/reference/android/widget/ArrayAdapter.html)），“默认情况下，此类期望提供的资源 id 引用单个 TextView。” 我在里面使用了一个带有 TextView 的 RelativeLayout。这有点明显，但如果它可以帮助别人......

# sql - SQL Server 2012 列标识增量在第 7 个条目上从 6 跳到 1000+

> ID：14162648
> 
> 赞同：130
> 
> 时间：2013-01-04T18:19:23.743
> 
> 标签：sql, sql-server, sql-server-2012, identity

我有一个奇怪的场景，其中我的 SQL Server 2012 数据库中的 auto identity int 列没有正确增加。

假设我有一个使用 int 自动标识作为主键的表，它偶尔会跳过增量，例如：

1、2、3、4、5、1004、1005

这是在非常随机的时间随机数量的表上发生的，无法复制它以找到任何趋势。

这是怎么回事？有没有办法让它停止？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-01-04T18:29:22.503

这一切都很正常。Microsoft`sequences`在 SQL Server 2012 中添加，最后，我可能会添加和更改身份密钥的生成方式。在[这里](http://www.codeproject.com/Tips/668042/SQL-Server-2012-Auto-Identity-Column-Value-Jump-Is)查看一些解释。

如果你想拥有旧的行为，你可以：

1.  使用跟踪标志 272 - 这将导致为每个生成的身份值生成日志记录。打开此跟踪标志可能会影响身份生成的性能。
2.  使用带有 NO CACHE 设置的序列生成器 ( [http://msdn.microsoft.com/en-us/library/ff878091.aspx](http://msdn.microsoft.com/en-us/library/ff878091.aspx) )

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-23T13:01:45.730

遇到同样的问题，在 SQL Server 2012 中找到以下错误报告如果仍然相关，请查看导致问题的条件 - 那里也有一些解决方法（虽然没有尝试）。 [故障转移或重新启动导致重新植入身份](https://connect.microsoft.com/SQLServer/feedback/details/739013/failover-or-restart-results-in-reseed-of-identity)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-04T13:38:57.050

虽然跟踪标志 272 可能适用于许多人，但它绝对不适用于托管的 Sql Server Express 安装。因此，我创建了一个身份表，并通过 INSTEAD OF 触发器使用它。我希望这对其他人有所帮助，和/或让其他人有机会改进我的解决方案。最后一行允许返回最后添加的标识列。由于我通常使用它来添加单行，因此它可以返回单个插入行的标识。

身份表：

```
CREATE TABLE [dbo].[tblsysIdentities](
[intTableId] [int] NOT NULL,
[intIdentityLast] [int] NOT NULL,
[strTable] [varchar](100) NOT NULL,
[tsConcurrency] [timestamp] NULL,
CONSTRAINT [PK_tblsysIdentities] PRIMARY KEY CLUSTERED 
(
    [intTableId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF,  ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

和插入触发器：

```
-- INSERT --
IF OBJECT_ID ('dbo.trgtblsysTrackerMessagesIdentity', 'TR') IS NOT NULL
   DROP TRIGGER dbo.trgtblsysTrackerMessagesIdentity;
GO
CREATE TRIGGER trgtblsysTrackerMessagesIdentity
ON dbo.tblsysTrackerMessages
INSTEAD OF INSERT AS 
BEGIN
    DECLARE @intTrackerMessageId INT
    DECLARE @intRowCount INT

    SET @intRowCount = (SELECT COUNT(*) FROM INSERTED)

    SET @intTrackerMessageId = (SELECT intIdentityLast FROM tblsysIdentities WHERE intTableId=1)
    UPDATE tblsysIdentities SET intIdentityLast = @intTrackerMessageId + @intRowCount WHERE intTableId=1

    INSERT INTO tblsysTrackerMessages( 
    [intTrackerMessageId],
    [intTrackerId],
    [strMessage],
    [intTrackerMessageTypeId],
    [datCreated],
    [strCreatedBy])
    SELECT @intTrackerMessageId + ROW_NUMBER() OVER (ORDER BY [datCreated]) AS [intTrackerMessageId], 
    [intTrackerId],
   [strMessage],
   [intTrackerMessageTypeId],
   [datCreated],
   [strCreatedBy] FROM INSERTED;

   SELECT TOP 1 @intTrackerMessageId + @intRowCount FROM INSERTED;
END 
```

# c# - 使用 Assembly.Load(path) 时找不到文件或程序集

> ID：14162650
> 
> 赞同：3
> 
> 时间：2013-01-04T18:19:34.097
> 
> 标签：c#, asp.net, .net, asp.net-mvc-4

我正在实现一个支持插件的 ASP.NET MVC 4 应用程序，从今天开始我有一个奇怪的行为，我不知道为什么：
我加载`Assembly.Load(path)`了几天前工作正常的插件，但是锁定了我的文件，因为影子复制没有作为插件文件夹在外面工作`/bin`。
因此，我使用`Assembly.Load(File.ReadAllBytes(path))`它也可以正常工作，但我认为代码不是很干净，所以今天我将我的插件文件夹移到里面`/bin`并切换回`Assembly.Load(path)`，但现在我得到以下异常（在我的语言环境中翻译）执行我的代码：

> > 无法加载文件或程序集“PATH_TO_MY_DLL”或其依赖项之一。给定的程序集名称或代码库无效。（来自 HRESULT 的异常：0x80131047）

如果我切换回`Assembly.Load(File.ReadAllBytes(path))`它可以工作，但是为什么直接加载文件时它不再工作了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:27:34.687

我认为你在改回来时犯了一个错误。

`Assembly.Load(string name)`: 加载名为“name”的程序集。

你应该使用：

```
Assembly.LoadFile(path); 
```

# php - 从文本框中提交 MySQL 查询？

> ID：14162659
> 
> 赞同：0
> 
> 时间：2013-01-04T18:20:15.337
> 
> 标签：php, html, mysql, database

我在我的网站上创建了一个包含一些用户的数据库，并希望在我的网站上有一个带有文本框的表单，允许我针对我的数据库提交完整的 SQL 查询。

使用PHP时这可能吗？我看到它在 ASP.net 中是可能的，但我对那种语言有点不熟悉。

例子：

在我的页面 run_sql.php 上，我想要一个带有提交按钮的文本框。

在文本框中，我希望能够运行命令，例如

```
INSERT INTO `userdata`(`UserID`, `FirstName`, `LastName`, `Email`, `PF_Username`, `PF_Password`, `Endpoint`) VALUES ([value-1],[value-2],[value-3],[value-4],[value-5],[value-6],[value-7]) 
```

并将声明的值写入我的表中。

sql.php 代码仅供参考：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Run SQL - TEST</title>
  </head>

    <table border="0" cellpadding="10">
      <tr>
        <td>
          <img src="images/api_rat.png">
        </td>
        <td>
          <h1>TEST</h1>
        </td>
      </tr>
    </table>
<body>
    <form action="sql.php" method="GET">
        <textarea name="comments" cols="25" rows="5">Enter your SQL query here...</textarea><br>
        <input type="submit" value="Run Query on LIVE DB" />
    </form>
</body>
</html> 
```

这可能吗？在此先感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:22:23.323

当然，进行连接，然后执行 mysql_query($_GET['comments']);

但是你知道，如果这个脚本可以从网络上访问，你有一个非常非常大的问题吗？:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:25:55.867

这是可能的，但这是一个*非常*糟糕的主意。如果有人输入`DROP TABLE myreallyimportanttable`怎么办？

不过，如果你想这样做，只需将文本框输入捕获为字符串，并将其提供给 mysql 连接；

```
$sql = $_GET['comments'])
$dbconn = @mysql_pconnect("$dbhost:$dbport", $dbuser, $dbpassword);
return @mysql_query ($sql, $dbconn); 
```

尽情享受 SQL 注入攻击吧！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T00:47:04.607

试试这个

```
<?php
$sql = $_GET["comments"];
$result = mysql_query($sql);
if($result){
//if it works show this
}else{
//if it doesnt work show this
}
?> 
```

如果它不起作用告诉我。

# image-processing - 是否可以设置/识别轮廓是否包含 OpenCV 中的峰或孔？

> ID：14162663
> 
> 赞同：0
> 
> 时间：2013-01-04T18:20:42.990
> 
> 标签：image-processing, opencv

我正在尝试识别图像上的特殊细胞类型。我正在寻找的是指定距离内的一些颜色峰（图 1，峰标有蓝点）。我的方法是逐层划分图像并计算轮廓。这是伪代码：

```
FOR Treshold= 250 to 0 STEP=5 
  treshold image
  count contours having specified area
  IF specified number of contours found BREAK 
```

不幸的是，有些细胞有孔而不是峰。这些孔也会产生轮廓（图 2）。

我的问题是 1：是否有可能调用 cvFindContours 以丢弃“孔”轮廓？

2：如果不是，是否可以从 CvContour 结构中确定它是包围一个峰还是一个孔？

我自己在阅读 OpenCV 代码时无法找到它。

谢谢！

![包含峰的单元格](../Images/81247ccfceb858af84c1ff4f1d2c9c97.png)

![包含孔的单元格](../Images/d378db49101cee8f2b25b95d0298825d.png)

# wpf - 带有组合框的wpf过滤数据网格

> ID：14162666
> 
> 赞同：0
> 
> 时间：2013-01-04T18:21:00.477
> 
> 标签：wpf, datagrid, combobox, filter

我有一个与我的分组集合视图绑定的组合框

```
<CollectionViewSource x:Key="ContactsView"  Source="{Binding ContactsCollection }" Filter="Filter" >
    <CollectionViewSource.GroupDescriptions>
        <dat:PropertyGroupDescription PropertyName="Contact_grname" />
    </CollectionViewSource.GroupDescriptions>
</CollectionViewSource> 
```

在代码中：

```
ICollectionView contactsView = CollectionViewSource.GetDefaultView(dataGrid1.ItemsSource);
cmbGroup.ItemsSource = contactsView.Groups; 
```

组项目已正确添加到我的组合框中，但是当我在组合框中选择一个项目时，如何使用该选定组过滤我的数据网格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:37:00.743

我不知道我是否正确理解了您的问题，但您可以尝试以下方法

```
contactsview.Filter = new Predicate<object>(FilterFunction);

public bool FilterFunction(Object item)
{
     MyObject eachItem = item as MyObject;

    // return true if eachItem satisfies some criteria else false
} 
```

# sql - 在 SQL Server 中右修剪二进制数据

> ID：14162672
> 
> 赞同：5
> 
> 时间：2013-01-04T18:22:03.647
> 
> 标签：sql, sql-server, sql-server-2008-r2

**设想：**

我将一个字符串插入二进制字段（CONTEXT_INFO），然后尝试将其拉出并将其转换回字符串。当我这样做时，结果字符串的长度为 128，因为它有尾随空字符。

**例子：**

```
DECLARE @string VARCHAR(128)
DECLARE @binary VARBINARY(128)

SET @string = 'abcdefg'
SET @binary = CONVERT(VARBINARY(128), @string) --0x61626364656667000000...
SET CONTEXT_INFO @binary
SET @binary = CONTEXT_INFO()

-- I would like to change the following line so it trims trailing null chars
SET @string = CONVERT(VARCHAR(128), @binary)

SELECT
    @binary AS [binary],
    DATALENGTH(@binary) AS [binary.Length], --128 as expected
    @string AS [string],
    DATALENGTH(@string) AS [string.Length] --This is 128, but I need it to be 7 
```

**问题：**

将二进制字段转换为字符串时，如何修剪尾随的空字符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T18:40:41.463

试试这个，`works on Sql-Server 2008.`这里是[Sql Fiddle](http://sqlfiddle.com/#!3/d41d8/7512)。

请注意，我假设原始字符串中没有 Char(0)，因为这甚至可以简单地从原始字符串中替换它。

```
-- I would like to change the following line so it trims trailing null chars
SET @string = CONVERT(VARCHAR(128), @binary)
SET @string = REPLACE(@string, Char(0),'') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-04T18:45:35.413

这是我的解决方案。我这样做是因为 CONTEXT_INFO 使值看起来像（向右填充）。

```
DECLARE @string VARCHAR(128)
DECLARE @binary VARBINARY(128)

SET @string = 'abcdefg'
SET @string = REPLICATE(CHAR(0),128-LEN(@string))+@string
SET @binary = CONVERT(VARBINARY(128), @string)
SET CONTEXT_INFO @binary
SET @binary = CONTEXT_INFO()

SET @string = CONVERT(VARCHAR(128), REPLACE(@binary,CHAR(0),''))

SELECT
    @binary AS [binary],
    DATALENGTH(@binary) AS [binary.Length],
    @string AS [string],
    DATALENGTH(@string) AS [string.Length] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-06-18T16:12:20.887

作为记录，如果它们发生在数据中间，这将修剪尾随 0x00 并保留 0x00：

```
cast(substring(CONTEXT_INFO(), 1, len(REPLACE(REPLACE(CONTEXT_INFO(), 0x20, 0x21), 0x00, 0x20))) as varbinary(128)) 
```

这给出了一个 varbinary 的结果，如果你想要一个字符串，请删除外部演员

大多数其他解决方案要么最终删除中间的 0x00，要么将其更改为 0x20。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-28T03:25:13.433

从`nvarchar(x)`转换`varbinary(x)`回到`nvarchar(x)`将始终正确往返。出现此处描述的核心问题是因为`SELECT CONTEXT_INFO()`始终返回 128 个字节，而不管用于 set 的 varbinary 源的长度如何`CONTEXT_INFO`。

有两种解决方法。

**第一种解决方法**：从 SQL Server 2016 开始，[`sp_set_session_context`](https://msdn.microsoft.com/en-us/library/mt605113.aspx)可用于设置非常优越的[`session_context`](https://msdn.microsoft.com/en-us/library/mt590806.aspx).

**第二种解决方法**：`context_info`可以从*应该*工作[`sys.dm_exec_sessions`](https://msdn.microsoft.com/en-us/library/ms176013.aspx)的方式中检索。此查询将返回与当前连接关联的：`CONTEXT_INFO()` *`context_info`*

 *```
SELECT context_info FROM sys.dm_exec_sessions WHERE session_id = @@SPID 
```

下面是SSMS中两种检索方式的对比：

```
SET CONTEXT_INFO 0x010200340056;
GO

SELECT CONTEXT_INFO(); -- 0x0012003400560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
SELECT context_info FROM sys.dm_exec_sessions WHERE session_id = @@SPID; -- 0x001200340056

SET CONTEXT_INFO 0x;
GO

SELECT CONTEXT_INFO(); -- NULL
SELECT context_info FROM sys.dm_exec_sessions WHERE session_id = @@SPID; -- 0x 
```

**警告**：设置`CONTEXT_INFO`应在与通过检索分开的批次中执行`context_info`（`sys.dm_exec_sessions`如上所示，通过 SSMS 批次分隔符`GO`）。*

# c# - 将对象传递给用户控件和 + 对象引用未设置为对象的实例

> ID：14162673
> 
> 赞同：2
> 
> 时间：2013-01-04T18:22:04.130
> 
> 标签：c#, user-controls

我的问题是.. 我有一个 UserControl，我在上面放置了一个 DataGridView 和一个按钮。在这个控件上，我有这三个变量：

```
namespace MySpace
{
    public partial class PanelWithDataGrid : UserControl
    {
        public DatabaseMenager FDatabaseManager { get; set; }
        public SqlCeDataAdapter FDataAdapter { get; set; }
        private DataTable FDataTable { get; set;  }
        [...] 
```

构造函数如下所示：

```
public PanelWithDataGrid()
        {
            InitializeComponent();
        } 
```

而且..我有一个看起来像这样的方法：

```
public void Initialize(DatabaseMenager pDatabaseManager, DataTable pDataTable, SqlCeDataAdapter pDataAdapter)
        {
            FDataAdapter = pDataAdapter;
            FDatabaseManager = pDatabaseManager;
            FDataTable = pDataTable;
        } 
```

而且..我还有一个按钮，它有一个如下所示的点击事件：

```
private void btnAccept_Click(object sender, EventArgs e)
        {
            try
            {
                if (MessageBox.Show("Accept changes?", "Accept?", MessageBoxButtons.YesNo) == DialogResult.Yes)
                {
                    FDataTable.AcceptChanges();
                    FDataAdapter.Update(FDataTable);
                }
            }
            catch (Exception ex)
            {
                System.Windows.Forms.MessageBox.Show(String.Format("Error:\n\n{0}", ex.StackTrace));
            }
        } 
```

现在说点正题：

1.  在拥有该组件的表单中，我运行“初始化”方法。

2.  它显示我不想显示的数据。

3.  然后我更改了 datagridview 中单元格中的一些值。

4.  但是，当我单击此控件的“接受”按钮时，该按钮应该接受更改并更新连接到 datagridview 的数据表 - 出现错误，提示“对象引用未设置为对象的实例”。

请帮忙..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T21:41:23.957

问题解决了。

这个组件 - `PanelWithDataGrid`- 被放置在一个名为 的组件上`AdminPanel`。

`AdminPanel`正在执行一个方法 ，该方法`Initialize`将数据适配器和数据表传递给 PanelWithDataGrid 组件。这些变量为空，因为它们是在`Initialize`方法之后创建的。

所以这个问题的解决方案是在运行方法之前创建一个对象`SqlCeDataAdapter`和另一个对象。`Datatable``Initialize`

# mysql - 如何在 MySQL 中组合这两个查询？

> ID：14162675
> 
> 赞同：0
> 
> 时间：2013-01-04T18:22:12.380
> 
> 标签：mysql, sql

好吧，我是菜鸟，我接受。但我试图结合这两个查询，由于某种原因我不明白如何。

查询 1。

```
select t.id from tickets t 
```

查询 2。

```
SELECT name 
FROM groups 
WHERE id = (
            SELECT DISTINCT immediateparentid 
            FROM cachedgroupmembers c
            LEFT JOIN groups g
            ON c.groupid = g.id
            LEFT JOIN tickets t
            ON t.id = g.instance
            WHERE t.Id = 1234
            AND g.type = 'AdminCc'
            AND immediateparentid <> c.groupid
        ) 
```

第一个查询中的票证 ID 用于第二个查询的 where 子句。有没有办法结合这两个查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:27:06.977

```
SELECT 
        g.name,
        (SELECT id FROM tickets) as ID
FROM groups as g
WHERE id = (
            SELECT 
                DISTINCT immediateparentid 
            FROM cachedgroupmembers c
            LEFT JOIN groups g ON c.groupid = g.id
            LEFT JOIN tickets t ON t.id = g.instance
            WHERE t.Id = ID
            AND g.type = 'AdminCc'
            AND immediateparentid <> c.groupid
        ) 
```

这是一个依赖子查询

# xml - 将节点 xml 复制到另一个 xml

> ID：14162676
> 
> 赞同：0
> 
> 时间：2013-01-04T18:22:14.393
> 
> 标签：xml, dom

我想将一个 xml 的节点复制到另一个 xml。我已经创建了 xml 的两个 DOM，当我找到我需要的节点时，我试试这段代码

```
NodeList elementi = doc.getChildNodes();
for (int i = 0; i < elementi.getLength(); i++){
    NodeList datiTitolo = elementi.item(i).getChildNodes();
    for (int j = 0; j < datiTitolo.getLength(); j++){
        if(datiTitolo.item(j).getFirstChild().getTextContent().equals("cariplo")){
            buy.importNode(datiTitolo.item(j), true);
            System.out.println("Fatto");
            break;
        }
    }
} 
```

但似乎什么也没做..当我写入文件时什么都没有出现，错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T15:13:56.317

您忘记将导入的节点实际插入到目标文档中。

```
Node node = buy.importNode(datiTitolo.item(j), true);
buy.appendChild(node); // or wherever else the imported Node should be inserted 
```

# javascript - jPlayer swf：从亚马逊 ses 加载媒体时遇到问题

> ID：14162677
> 
> 赞同：1
> 
> 时间：2013-01-04T18:22:16.477
> 
> 标签：javascript, amazon-s3, jplayer

我一直在尝试在 IE8 中使用带有后备 swf 的 jPlayer 加载音频文件。我的音频文件存储在 amazon S3 中，尝试在 javascript 中创建播放器时出现错误。我已经通过在浏览器中访问它来验证我的 swf 是否正确加载，并且我的文件链接对于 s3 是正确的。任何建议或帮助将不胜感激。

错误：jPlayer 2.1.0：id='jquery_jplayer_0'：错误！

无法加载媒体 URL。

检查媒体 URL 是否有效。

代码

```
$('#jquery_jplayer_0'.toString()).jPlayer({
     ready: function () {
   $(this).jPlayer('setMedia', {
            m4a: audio.fields.link,
            oga: audio.fields.link,
             mp3: audio.fields.link
            });
                    },
                    preload: 'none',
                    swfPath: '/static/js/jplayer/',
                    cssSelectorAncestor: '#jp_interface_'+i.toString(),
                    supplied: 'm4a, oga, mp3, all',
                    solution:"flash, html",
                    wmode: 'window',
                    errorAlerts:true,nativeSuport:false
                }); 
```

# r - 在knitr中使用ggplot2时如何包装标签？

> ID：14162679
> 
> 赞同：1
> 
> 时间：2013-01-04T18:22:19.193
> 
> 标签：r, ggplot2, knitr

我正在使用 ggplot2 生成散点图并使用 knitr 导出为 pdf。有些标签有两个长，我想把它包成两行。

示例代码：

```
\documentclass{article}

\begin{document}

<<echo=FALSE, message=FALSE, warning=FALSE, comment=NA, results='hide'>>=

library("Hmisc")
library("ggplot2")
library("gridExtra")

x1 <- runif(100)
y1 <- rnorm(100)
x2 <- runif(100)
y2 <- rnorm(100)
test <- data.frame(cbind(x1,y1,x2,y2))
label(test$x1) <- "This is a Variable label for variable x1" 
label(test$y1) <- "This is a Variable label for variable y1" 
label(test$x2) <- "This is variable x2" 
label(test$y2) <- "This is variable y2" 

p1 <- ggplot(data = test, aes(x = x1, y = y1)) + 
    geom_point(size = .5) +
    scale_x_continuous(label(test$x1)) +
    scale_y_continuous(label(test$y1)) +
    geom_smooth()

p2 <- ggplot(data = test, aes(x = x2, y = y2)) + 
    geom_point(size = .5) +
    scale_x_continuous(label(test$x2)) +
    scale_y_continuous(label(test$y2)) +
    geom_smooth()

p3 <- ggplot(data = test, aes(x = x1, y = y2)) + 
    geom_point(size = .5) +
    scale_x_continuous(label(test$x1)) +
    scale_y_continuous(label(test$y2)) +
    geom_smooth()

p4 <- ggplot(data = test, aes(x = x2, y = y1)) + 
    geom_point(size = .5) +
    scale_x_continuous(label(test$x2)) +
    scale_y_continuous(label(test$y1)) +
    geom_smooth()

grid.newpage() 
pushViewport(viewport(width = .8, height = .8, layout = grid.layout(nrow=2, ncol=4)))
print(p1,vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
print(p2,vp = viewport(layout.pos.row = 1, layout.pos.col = 2))
print(p1,vp = viewport(layout.pos.row = 1, layout.pos.col = 3))
print(p2,vp = viewport(layout.pos.row = 1, layout.pos.col = 4))

@

\end{document} 
```

我想只包装 x1 和 y1 的标签，我该怎么做？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:55:13.560

要在两行中添加标签，`\n`请添加文本应断开的位置。

```
label(test$x1) <- "This is a Variable \nlabel for variable x1" 
label(test$y1) <- "This is a Variable \nlabel for variable y1" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:07:01.187

我创建了一个函数来拆分字符串并重建它。

```
wrap <- function(char,n){
          char1 <- word(char, start = 1, end=n)
          char2 <- word(char, start = n+1, end=sapply(strsplit(char, " "), length)) 
          char <- paste(char1,"\n",char2)
        }

if (nchar(label(data$x0))>20) {
  label(test$y1) <- wrap(label(test$x1),3)
  label(test$y1) <- wrap(label(test$y1),4)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-31T06:25:17.550

定义一个函数`mystrwrap`来包装字符串，并在给定的位置换行，`width`这样 ggplot 可以将其用作标签。`label()`将调用包装在`mystrwrap`. 这是修改后的 .Rnw 文件。

```
\documentclass{article}

\begin{document}

<<echo=FALSE, message=FALSE, warning=FALSE, comment=NA, results='hide'>>=

library(Hmisc)
library(ggplot2)
library(grid)
library(gridExtra)

x1 <- runif(100)
y1 <- rnorm(100)
x2 <- runif(100)
y2 <- rnorm(100)
test <- data.frame(cbind(x1,y1,x2,y2))
label(test$x1) <- "This is a Variable label for variable x1" 
label(test$y1) <- "This is a Variable label for variable y1" 
label(test$x2) <- "This is variable x2" 
label(test$y2) <- "This is variable y2" 

mystrwrap <- function(x, width = 25) {
  paste(strwrap(x, width = width), collapse = "\n")
}

p1 <- ggplot(data = test, aes(x = x1, y = y1)) + 
    geom_point(size = .5) +
    scale_x_continuous(mystrwrap(label(test$x1))) +
    scale_y_continuous(mystrwrap(label(test$y1))) +
    geom_smooth()

p2 <- ggplot(data = test, aes(x = x2, y = y2)) + 
    geom_point(size = .5) +
    scale_x_continuous(mystrwrap(label(test$x2))) +
    scale_y_continuous(mystrwrap(label(test$y2))) +
    geom_smooth()

p3 <- ggplot(data = test, aes(x = x1, y = y2)) + 
    geom_point(size = .5) +
    scale_x_continuous(mystrwrap(label(test$x1))) +
    scale_y_continuous(mystrwrap(label(test$y2))) +
    geom_smooth()

p4 <- ggplot(data = test, aes(x = x2, y = y1)) + 
    geom_point(size = .5) +
    scale_x_continuous(mystrwrap(label(test$x2))) +
    scale_y_continuous(mystrwrap(label(test$y1))) +
    geom_smooth()

grid.newpage() 
pushViewport(viewport(width = .98, height = .8, layout = grid.layout(nrow=2, ncol=4)))
print(p1,vp = viewport(layout.pos.row = 1, layout.pos.col = 1))
print(p2,vp = viewport(layout.pos.row = 1, layout.pos.col = 2))
print(p1,vp = viewport(layout.pos.row = 1, layout.pos.col = 3))
print(p2,vp = viewport(layout.pos.row = 1, layout.pos.col = 4))

@

\end{document} 
```

生成的图形需要对视口进行一些调整。（或者，只需使用`gridExtra::grid.arrange`） [![在此处输入图像描述](../Images/b922d35b080b73694dc1665e0b7a2b1f.png)](https://i.stack.imgur.com/GH8eb.png)

# android - 滑动菜单未正确显示

> ID：14162683
> 
> 赞同：6
> 
> 时间：2013-01-04T18:22:35.007
> 
> 标签：android, android-sliding

我是一名初学者 Android 程序员，我正在[玩弄 JFeinstein 很棒的滑动菜单](https://github.com/jfeinstein10/SlidingMenu)，试图弄清楚它是如何工作的并在我的应用程序中实现它，但在我的所有实现中，后面的视图覆盖了上述视图的 100%。

此外，返回上述视图的唯一方法是按下返回按钮，因此也不能`"sliding"`返回。如果我理解正确，这应该由 控制`BehindViewOffset`，但我似乎没有让它工作。无论如何，这里有一个小示例代码：

这是我的`MainActivity`：

```
public class MainActivity extends SlidingActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        setBehindContentView(R.layout.testing);

        populate();

        SlidingMenu menu = new SlidingMenu(this);
        menu.setMode(SlidingMenu.LEFT);
        menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
        menu.setBehindOffsetRes(R.dimen.slidingmenu_offset);
        menu.setFadeDegree(0.35f);
        menu.attachToActivity(this, SlidingMenu.SLIDING_CONTENT);
        setSlidingActionBarEnabled(true);
        menu.setMenu(R.layout.testing);

    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case android.R.id.home:
            toggle();
            return true;
        default:
            return super.onOptionsItemSelected(item);
        }
    }

    private void populate() {

        ListView lv = (ListView) findViewById(R.id.listView1);
        String[] values = new String[] { "One", "Two", "Three", "Four", "Five",
                "Six", "Seven", "Eight", "Nine", "Ten" };
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, android.R.id.text1, values);
        lv.setAdapter(adapter);

    }
} 
```

和布局xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ListView
        android:id="@+id/listView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >
    </ListView>

</LinearLayout> 
```

可悲的是，在我获得更多代表之前，我无法发布屏幕截图！

**编辑：**添加了 dimen.xml

```
 <resources>
    <dimen name="slidingmenu_offset">120dp</dimen>
    <dimen name="list_padding">10dp</dimen>
    <dimen name="shadow_width">15dp</dimen>
    <integer name="num_cols">1</integer>
</resources> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-05T13:52:58.933

好的，所以我仔细研究了这个例子，最后通过改变让它工作了

```
SlidingMenu menu = new SlidingMenu(this); 
```

为了：

```
SlidingMenu menu = getSlidingMenu(); 
```

所以这里是主要活动的 onCreate 的最终代码：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    setBehindContentView(R.layout.testing);

    populate();

    SlidingMenu menu = getSlidingMenu();

    menu.setMode(SlidingMenu.LEFT);
    menu.setShadowWidthRes(R.dimen.shadow_width);
    menu.setShadowDrawable(R.drawable.shadow);
    menu.setBehindOffsetRes(R.dimen.slidingmenu_offset);
    menu.setFadeDegree(0.35f);
    menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_FULLSCREEN);
    setSlidingActionBarEnabled(true);

} 
```

# arrays - SSRS Reporting Services - 字符串中的粗体字

> ID：14162687
> 
> 赞同：3
> 
> 时间：2013-01-04T18:23:12.133
> 
> 标签：arrays, function, reporting-services, contains, ssrs-expression

出版物 - 如何在字符串中加粗作者姓名？如果返回 1 个值但它是一个字符串（=iif(Fields!Author.Value = Parameters!5aAuthor.Value, "Bold", "Normal")，则会是这样的。示例：作者 + 年份 + 标题 + 期刊+ PMCID . Authors = Miter, MH, Owens, R, Thompson etc... . 像一个数组......

问题：

作者必须按一定顺序显示。这意味着作者可能会显示在第 1 位、第 3 位或第 5 位或其他位置。以下是所需内容。

我可以将其创建为视图，但我仍然遇到相同的加粗作者问题。

示例 - Mitre, MH、Owens, R.、**Thompson, P.**和 Berg, L.，2004，“糖尿病大鼠的胰岛素治疗”，J. Comp。神经学，373：350-378。

**布朗，B** . 和 Jones J.，2005，“果蝇中的重复序列”，J. Mol。生物学，242：503-510。Corman, T.、Walker, JD 和 Brown, B.，2006 年，“同种异体抗原耐受性的个体发生”，上午。J.Anat.，146:156。

**塞缪尔，J**。和 Peters M.，2009 年，“RNA 病毒的分子分析”，细胞分子生物学，卷。11 日，12-18 日。PMCID：PMC2583929

每 2 行（示例）将进入 1 个文本框...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T20:27:14.603

您的一般方法完全正确：

> 我需要拆分字符串 - 找到作者 - 加粗 - 并将其他字符串保留为默认值。像一个数组......

听起来您想在报告级别而不是在 SQL 中执行此操作。

如果您使用的是 SSRS 2008 或更高版本，您可以在其中使用占位符，那么我将这样做：

1.  在报表中的数据集中创建三个计算字段。

    1.  **左作者**：

        `=LEFT( Fields!BigString.Value , Instr( Fields!BigString.Value , Parameters!5aAuthor.Value) - 1 )`

    2.  **作者**：

        `=Parameters!5aAuthor.Value`

    3.  **作者的权利**：

        `=RIGHT( Fields!BigString.Value , LEN(Fields!BigString.Value) - Instr( Fields!BigString.Value , Parameters!5aAuthor.Value) + LEN(Parameters!5aAuthor.Value) )`

2.  现在将三个占位符放入您需要在其中显示的文本单元格中。将每个设置为按顺序引用这些计算字段之一。

3.  选择中间占位符（作者）并将其加粗。

上面的公式假定作者姓名在字段中的某处完全匹配。如果可能不是，您将需要添加错误处理。他们没有以任何方式进行测试，因此可能需要一些调整。

* * *

一些替代方法包括在 SQL 中分解字符串和/或使用 HTML`<b></b>`标记对字符串进行编码以进行显示，然后将 SSRS 设置为将其显示为 HTML。

# .net - 通过 NuGet 提供命令行工具，用于 Visual Studio 中的构建后事件

> ID：14162691
> 
> 赞同：11
> 
> 时间：2013-01-04T18:23:28.233
> 
> 标签：.net, visual-studio, powershell, nuget

我开发了一个命令行实用程序，它将 .NET 程序集作为输入并生成 XML 作为输出以供其他产品使用。

理想情况下，我会拥有它：

*   通过 NuGet 作为解决方案级包提供
*   可在项目级别的构建后事件中访问
*   **我被卡住的位：**只需指定不带路径的命令名称即可在该构建后事件中访问
    *   即*MyTool.exe /i $(TargetPath)*而不是*..\packages\ToolName-1.0.0.0\tools\MyTool.exe /i $(TargetPath)*

我已经可以做的前两件事，以及上面的构建后事件命令工作得很好，但前提是我首先打开包管理器控制台（即使我没有输入任何命令，只需要打开它） - 似乎它在启动时对路径进行了一些很酷的操作，因此我不必指定 ..\packages\ToolName-1.0.0.0\tools\MyTool.exe。

我的 NuGet 包是否可以使用 Init.ps1 脚本（或其他一些机制）来调整路径，以便在编写构建后事件时无需指定工具的完整相对路径，或者以其他方式包含运行工具自动作为后期构建步骤？

*注意*- 我接受 NuGet 可能不是提供此类工具的理想载体，但它会很方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-12-12T08:41:01.083

仅针对遇到此问题的人；

我见过人们为此使用 nuget 包，例如参见 nswag.msbuild： [https ://github.com/RicoSuter/NSwag/wiki/NSwag.MSBuild](https://github.com/RicoSuter/NSwag/wiki/NSwag.MSBuild)

简而言之，nuget 包包含该工具作为命令行实用程序可执行文件。它还定义了一些定义该工具路径的 buildprops（类似于`/packages/myToolNugetPkg/mytool.exe`）然后您可以在 msbuild 任务中使用此属性。

.NET 核心还支持“工具”，这正是您所需要的：

[https://docs.microsoft.com/en-us/dotnet/core/tools/global-tools](https://docs.microsoft.com/en-us/dotnet/core/tools/global-tools)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-10-15T00:54:12.027

Chocolatey（在技术上符合使用 NuGet 的条件）具有非常酷的神奇“匀场”功能。

简而言之，包中的任何可执行文件都将自动在 PATH 上可用。[这很酷。](https://chocolatey.org/docs/features-shim)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-29T08:02:17.957

This might help you -> [http://lostechies.com/joshuaflanagan/2011/06/24/how-to-use-a-tool-installed-by-nuget-in-your-build-scripts/](http://lostechies.com/joshuaflanagan/2011/06/24/how-to-use-a-tool-installed-by-nuget-in-your-build-scripts/)

I used the solution with the wildcard in the 'CD' command, so my postbuild looks like this:

```
CD "$(SolutionDir)packages\ToolName*\tools"
MyTool.exe 
```

# ruby - 如何将 Rails 应用程序（服务器代码）和 ruby gem（客户端代码）组合到一个通用包中？

> ID：14162692
> 
> 赞同：2
> 
> 时间：2013-01-04T18:23:35.290
> 
> 标签：ruby, ruby-on-rails-3, rubygems, directory-structure

我有两个包：一个 rails 3.2 应用程序（服务器代码）和一个 ruby​​ gem（客户端代码）。它们每个都有标准的目录结构，分别用于 rails app 和 ruby​​ gems。由于有可以而且应该在它们之间共享的通用代码，我想将它们组合成一个包。

最终的目录结构应该是什么样的？我很想看看任何具有这种目录布局的公共项目。

我的代码位于 Subversion 存储库中，因此使用 SCM 技巧（如 svn:external 定义）链接来自不同存储库的代码的解决方案也是可以接受的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:08:17.323

我会将常见的东西提取到gem（例如`mything-core`）中，并使客户端和服务器都依赖它。

# php - 通过 PHP 将 MySQL 数据传递给模态表单

> ID：14162694
> 
> 赞同：0
> 
> 时间：2013-01-04T18:23:36.653
> 
> 标签：php, jquery, html, twitter-bootstrap, modal-dialog

我正在尝试使用模式作为用户编辑 MySQL 数据库中数据的简单方法。似乎只有在我的 SELECT 语句中检索到的第一行可用于模态，我不明白为什么。换句话说，想象一个有几列的表，第一列是客户的姓名。我的目标是能够单击名称，显示带有表单的模式，然后传递该表单的结果以使用 PHP 更新数据库。但是，无论我单击哪个名称，都只会传递与第一条结果行相关的值。

表“项目”包括将出现在表中的所有行的信息。

`$personID`是通过`GET`并且是选择特定员工的客户的手段。

模式`div`包含在 PHP`while`子句中。

模式中包含的表单将信息传递给基本的 PHP 更新脚本。

非常感谢，迈克

PHP选择Stmt：

```
 <?php
        $query = "SELECT * FROM item WHERE personID = $personID";
        $result = mysql_query($query);
        while($info=mysql_fetch_array($result)){
        $itemID = $info['itemID'];
    ?> 
```

链接（众多之一；我已缩写此部分）：

```
 <div class='row-fluid'>
        <div class='span3'>
            <a href="#customerModal" data-toggle="modal"><?php echo($info['itemCustomer']); ?></a>
        </div>
    </div> 
```

模态：

```
<div id="customerModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel"><?php echo($info['itemID']); ?></h3>
</div>
<div class="modal-body">
    <form action='pipelineEdit.php' method='post'>
        <input placeholder='Customer Name' style='width:50%' type='text' name='editValue' id='editValue'>
        <input type='hidden' value='itemCustomer' name='editField' id='editField'>
        <input type='hidden' value='<?php echo($info['itemID']); ?>' name='itemID' id='itemID'>
        <input type='hidden' value='<?php echo($personID); ?>' name='personID' id='personID'>
</div>
          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary">Save changes</button>
          </div>
          </form>
        </div> 
```

PHP的结束`while`出现在模态之后：

```
 <?php } ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:32:01.493

您正在打印具有相同 ID = customerModal 的多个 div

ID 必须是唯一的，因此链接只会打开循环中打印的第一个模式。

改变：

```
<div id="customerModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> 
```

到：

```
<div id="customerModal<?php echo $info['itemID']; ?>" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"> 
```

和：

```
<a href="#customerModal" data-toggle="modal"> 
```

到：

```
<a href="#customerModal<?php echo $info['itemID']; ?>" data-toggle="modal"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:30:25.167

使用

```
while($info=mysql_fetch_array($result)){
    $itemID = $info['itemID']; 
```

表示您继续分配给 $itemId。最后 $itemId 只保存最后分配的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:32:44.850

您的模式用 id 标识。在 jQuery 中，只会引用具有该 id 的第一个 DOM 元素。要引用正确的模态，您可以将数据库 ID 附加到元素 ID，例如：

```
<div id="customerModal<?php echo $info['itemID']; ?>" 
```

该链接也需要附加：

```
<a href="#customerModal<?php echo $info['itemID']; ?>" data-toggle="modal"> 
```

有关使用 ID 选择器的更多信息，请查看 [此处](http://api.jquery.com/id-selector/)的 jQuery 文档。

# android - 在微调器中显示 ActionBar 搜索结果

> ID：14162706
> 
> 赞同：2
> 
> 时间：2013-01-04T18:24:44.610
> 
> 标签：android, android-actionbar, geocoding

我正在尝试向我的应用程序添加地理编码搜索功能，该功能的工作方式与 Google 地图中的功能相同： ![Android 版 Google 地图中的示例搜索](../Images/dbd7e07763f85e8bba1237b9f6b588be.png)

我已经使用 ActionView 在操作栏中实现了搜索：我在操作栏中添加了一个项目：

```
<item
    android:id="@+id/menu_Search"
    android:icon="@drawable/ic_action_search"
    android:orderInCategory="97"
    android:showAsAction="always|collapseActionView"
    android:title="Search"
    android:actionViewClass="android.widget.SearchView"/> 
```

并在 onCreateOptionsMenu 中定义了如何管理它：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    SearchView avSearch = (SearchView) menu.findItem(R.id.menu_Search).getActionView();

    avSearch.setIconifiedByDefault(true);

    avSearch.setOnQueryTextListener(new OnQueryTextListener() {
        int changes = 0;

        @Override
        public boolean onQueryTextChange(String s) {

            if (changes >= 4 || s.endsWith(" ")) {
                submitLocationQuery(s);
                changes = 0;
            } else
                ++changes;
            return true;
        }

        @Override
        public boolean onQueryTextSubmit(String query) {
            submitLocationQuery(query);
            return true;
        }

    });

    return true;
} 
```

搜索由后台线程提供给地理编码器：

```
private void submitLocationQuery(final String query) {
    Thread thrd = new Thread() {
        public void run() {

            try {

                foundAddresses = mGeoCoder.getFromLocationName(query, 5);
                gcCallbackHandler.sendEmptyMessage(0);
            } catch (IOException e) {
                Log.e(this.getClass().getName(), "Failed to connect to geocoder service", e);
            }
        }
    };
    thrd.start();
} 
```

并由 Handler 接收和处理：

```
private Handler gcCallbackHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        if (foundAddresses != null && !foundAddresses.isEmpty()) {
            GeoPoint foundGeo = new GeoPoint((int) (foundAddresses.get(0).getLatitude() * 1E6), (int) (foundAddresses.get(0).getLongitude() * 1E6));
            mapView.getController().animateTo(foundGeo);
        }
    }
}; 
```

所有这些都有效，并且我的地图在搜索时会缩放到位置，但是我怎样才能像谷歌地图那样在搜索下显示我的搜索结果呢？

提前感谢您的任何回复， ANkh

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-07T09:15:17.883

您在 Spinner 等小部件中看到的只是建议。

您可以按照本指南获得此效果：http: [//www.grokkingandroid.com/android-tutorial-adding-suggestions-to-search/](http://www.grokkingandroid.com/android-tutorial-adding-suggestions-to-search/)

或在 android 开发者指南上：http: [//developer.android.com/guide/topics/search/adding-custom-suggestions.html](http://developer.android.com/guide/topics/search/adding-custom-suggestions.html)

# android - android上的警报通知

> ID：14162709
> 
> 赞同：1
> 
> 时间：2013-01-04T18:24:54.963
> 
> 标签：android, trigger.io

是否可以使用 forge.notification.create() 或类似方法在 android 设备上显示类似警报的消息。在 ios 上它是这样工作的，但在 android 上它会在视图顶部显示一条消息。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T07:54:48.460

Forge v1.4.39 中包含本机警报、确认和 toast 消息。

```
forge.notification.alert('My Title: Alert', 'My Body: Alert'); 
```

![在此处输入图像描述](../Images/71021e08b7a5474527c01068b9929b95.png)

* * *

```
forge.notification.confirm("My Title: Confirm", "My Body: Confirm", "Y", "N", 
    function (userClickedYes) {
      if (userClickedYes) {
        // ... implement logic for when user clicked "Y"
      } else {
        // ... implement logic for when user clicked "N"
      }
}); 
```

![在此处输入图像描述](../Images/c3bebafe2d1928350c37c31481ea2703.png)

* * *

```
forge.notification.toast('My Body: Toast'); 
```

![在此处输入图像描述](../Images/79b79cc45aea485ed41658118c423a7d.png)

* * *

有关更多信息，请参阅[通知文档](https://trigger.io/docs/current/api/modules/notification.html)。

# mysql - GlassFish 动态 JDBC 池

> ID：14162711
> 
> 赞同：0
> 
> 时间：2013-01-04T18:25:14.297
> 
> 标签：mysql, jdbc, glassfish, glassfish-3, connection-pooling

我有 3 个数据库的 MySQL DBMS

*   配置
*   大师1
*   大师2

JSF 2.1 应用程序在配置数据库上使用特定用户名登录，然后进行一些查询并获取进行连接的数据库的名称。

现在有了 2 个简单的数据库，解决方案很简单：

1.  加入`master1`并`master2`使用配置并创建一个具有关系的单一单声道数据库......可能，但有分离用户数据的请求 - 所以丢弃。

2.  在 Glassfish 中创建`n`池，然后使用适当的池。

实际上我正在使用这个解决方案，但是如果我有 master 0...1000，我必须手动创建所有这些，这非常耗时。

我想：

1.  像往常一样连接到配置
2.  检索数据库名称
3.  检查资源（同名）是否存在
    1.  如果它不存在；创造它
4.  现在使用它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-09T21:13:22.260

你应该看看这个答案：[https](https://stackoverflow.com/a/21029975/686036) ://stackoverflow.com/a/21029975/686036 。

我相信您将能够使用 RESTful API 来做您想做的事。

1.  连接到配置*// 不确定您是否需要再执行此步骤*
2.  检索数据库名称*// 这是由你做的*
3.  检查资源是否退出给定名称

    ```
    curl LIST http://localhost:4848/management/domain/resources/jdbc-connection-pool/ 
    ```

    这将为您提供所有可用 jdbc 连接池的列表。然后由您自己查找是否找到了您要查找的那个。

    1.  如果资源不存在，则创建它

        ```
        curl -X POST -H "X-Requested-By: GlassFish REST HTML interface" 
        -d id=jdbc/myjdbcresource -d connectionpoolid=DerbyPool 
        http://localhost:4848/management/domain/resources/jdbc-resource 
        ```

        然后，这将是通过 cURL 请求在您的服务器上创建资源的示例代码。

4.  使用资源*// 来自应用程序。*

### 也可以看看 ：

*   [Oracle 使用 REST 接口管理 GlassFish Server](http://docs.oracle.com/cd/E26576_01/doc.312/e24928/general-administration.htm#gjipx)
*   [Oracle 的虚线名称](http://docs.oracle.com/cd/E26576_01/doc.312/e24938/dotted-names.htm#GSRFM00268)

# rdf - 语义网：音乐实体与音乐推荐之间的距离

> ID：14162715
> 
> 赞同：2
> 
> 时间：2013-01-04T18:25:17.297
> 
> 标签：rdf, semantic-web, jena

我有一个由音乐艺术家、发行和音乐组成的音乐本体。每个艺术家与其他艺术家的关系相似，我需要找到一种方法来生成音乐推荐。我一直在讨论实体之间的距离。这是生成简单推荐的最佳方式吗？我该怎么做？我正在使用耶拿。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T09:42:26.593

看看[Apache Mahout](http://mahout.apache.org/)项目。虽然它不使用 Jena 图作为数据源，但使用 Jena API 为 Mahout 填充输入很容易。Mahout 提供了多种运行推荐算法的方法。对于任何类型的协同过滤（“喜欢 X 的人也喜欢 Y”之类的东西），您还需要一些用户评分数据。获取足够的数据来获得一些初始建议来引导您的服务可能是一个问题。但是，“类似于”关系本身不太可能为您的用户生成非常高质量的建议。

# php - aws.push to more than one environment

> ID：14162716
> 
> 赞同：3
> 
> 时间：2013-01-04T18:25:30.773
> 
> 标签：php, git, amazon-web-services, amazon-elastic-beanstalk

I have two different environments running off of the same git repository. it looks like in the AWS console tools for git and elastic beanstalk, I can only connect one environment at a time, is there anyway to have it push to both of my environments at the same time?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T18:30:39.317

The latest version allows you to map different branches to different repositories, see [Announcement: Deploy Git Branches to Multiple Elastic Beanstalk Environments](https://forums.aws.amazon.com/ann.jspa?annID=1772):

> Starting today, you can use eb and Git to deploy branches to multiple Elastic Beanstalk environments. You can also manage and configure multiple Elastic Beanstalk environments using eb. For example, you can configure eb and Git to deploy your development branch to your staging environment and deploy your release branch to your production environment. [...]

# mongodb - mongo db 复制集合以避免缺少事务

> ID：14162721
> 
> 赞同：-1
> 
> 时间：2013-01-04T18:25:58.030
> 
> 标签：mongodb

我有一个带有集合 cA、cB 和 cC 的数据库。我需要以事务方式每 5 分钟更新一次数据库（cB 是 cA 和 cC 的 nm 关系）。[由于使用 mongo 模拟事务](http://docs.mongodb.org/manual/tutorial/perform-two-phase-commits/)似乎并不容易，我虽然可以在开始上传过程之前创建 cA、cB 和 cC 的快照 (db.cA.copyTo("cA_snapshot")) 并翻转读取查询进行插入时的快照。不幸的是，集合大小总计超过 8Gb，并且执行 collection.copyTo 似乎需要的时间太长。

那么，有没有办法使用日记来实现这一点？假设我在启动时花费了创建集合快照的成本。之后，我可以在 cA_snapshot 上手动重播 cA 的日志项吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T00:26:47.487

如果您愿意在更新“连接表”时锁定所有三个集合的所有更新，则可以使用应用程序级锁定来实现这一点。

简短版本：您创建一个“锁”集合。在更新三个集合 cA、cB 或 cC 中的任何一个之前，每个客户端都必须获得一个“写锁”。它通过更新 'locks' 集合中的文档来实现。当您准备好执行批量更新时，您将获取“写锁”，执行更新并释放锁。

这是一些实现锁定的简单示例代码。请注意，此代码有几个限制：

*   没有死锁检测或预防
*   没有锁超时
*   尝试重新锁定锁定的资源总是会失败，即使之前已成功获取锁定

解决这些限制留给读者作为练习。

```
XDB = db.mylocks;
/*
 * Set up the locking collection
 */
function setup_locking( res_name ) {
    var doc = { _id: res_name, state: "UNLOCKED", locker: null }; 
    // upsert to create document if it does not exist
    XDB.update( {id: res_name}, doc, true ); 
}

/*
 * Lock the resource named 'res_name' by process named 'proc' 
 *
 * Returns 'true' if resource was acquired, 'false' if it was not acquired
 */
function lockit( res_name, proc ) {
    /*
     * 1) Change state to LOCKED if & only if it was previously UNLOCKED
     */
    ret = XDB.findAndModify( {
            query: { _id:res_name, state:"UNLOCKED" } , 
            update: {"$set": { state:"LOCKED", locker: proc } },
            fields: { state:1, locker:1 },
            new: true
            }
        );
    /*
     * Return 'true' if this process acquired this resource
     */
    if ( ret && (ret.state == "LOCKED") && (ret.locker == proc) )return true;

    /*
     * 2) Failed to acquire this resource
     */
    return false;
}

/*
 *  Unlock the resource named 'res_name' previously held by 'proc'
 */
function unlockit( res_name, proc ) {
    // Unlock resource if this process had previously acquired it
    XDB.findAndModify( {
        query: { _id:res_name, locker: proc, state:"LOCKED" } , 
        update: {"$set": { state:"UNLOCKED", locker: null } },
        }
    );
}

/*
 * Check to see if resource 'res_name' is currently held by 'proc'
 */
function has_lock( res_name, proc ) {
    res = XDB.findOne({_id: res_name, locker:proc} );
    if (res == null) return false;
    return true;
}

XDB.drop();
setup_locking('collectionA');

result = lockit( 'collectionA', 'app1');
print("1: result =", result);

result = lockit( 'collectionA', 'app2');
print("2: result =", result);

result = lockit( 'collectionA', 'app1');
print("3a: result =", result);
result = has_lock( 'collectionA', 'app1');
print("3b: result =", result);
result = has_lock( 'collectionA', 'app2');
print("3c: result =", result);

unlockit( 'collectionA', 'app1');

result = lockit( 'collectionA', 'app2');
print("4: result =", result); 
```

# python - 用 None 替换 Pandas 或 Numpy Nan 以与 MysqlDB 一起使用

> ID：14162723
> 
> 赞同：216
> 
> 时间：2013-01-04T18:26:06.627
> 
> 标签：python, pandas, numpy, mysql-python

我正在尝试使用 MysqlDB 将 Pandas 数据框（或可以使用 numpy 数组）写入 mysql 数据库。MysqlDB 似乎不理解“nan”，我的数据库抛出一个错误，指出 nan 不在字段列表中。我需要找到一种将“nan”转换为 NoneType 的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2013-01-04T19:01:25.247

@bogatron 说得对，您可以使用[**`where`**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.where.html)，值得注意的是，您可以在 pandas 中本地执行此操作：

```
df1 = df.where(pd.notnull(df), None) 
```

注意：这会将**所有列**的 dtype 更改为`object`.

例子：

```
In [1]: df = pd.DataFrame([1, np.nan])

In [2]: df
Out[2]: 
    0
0   1
1 NaN

In [3]: df1 = df.where(pd.notnull(df), None)

In [4]: df1
Out[4]: 
      0
0     1
1  None 
```

* * *

注意：您不能重铸 DataFrame`dtype`以允许所有数据类型类型，使用[**`astype`**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html)，然后使用 DataFrame[**`fillna`**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html)方法：

```
df1 = df.astype(object).replace(np.nan, 'None') 
```

*不幸的是，无论是 this 还是 using [**`replace`**](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.replace.html)，都不能与`None`see [this (closed) issue](https://github.com/pydata/pandas/issues/1972)一起使用。*

* * *

顺便说一句，值得注意的是，对于大多数用例，您不需要将 NaN 替换为 None，请参阅有关[**Pandas 中 NaN 和 None 之间区别的**](https://stackoverflow.com/q/17534106/1240268)问题。

但是，在这种特定情况下，您似乎这样做了（至少在此答案时）。

* * *

## 回答 #2

> 赞同：230
> 
> 时间：2019-01-28T14:07:22.530

```
df = df.replace({np.nan: None}) 
```

注意：这会将**所有*受影响*列**的 dtype 更改为`object`.

在[这个 Github 问题](https://github.com/pandas-dev/pandas/issues/17494#issuecomment-328966324)上感谢这个人。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-01-04T18:57:52.763

您可以在 numpy 数组中替换`nan`为：`None`

```
>>> x = np.array([1, np.nan, 3])
>>> y = np.where(np.isnan(x), None, x)
>>> print y
[1.0 None 3.0]
>>> print type(y[1])
<type 'NoneType'> 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-08-02T19:47:59.477

在跌跌撞撞之后，这对我有用：

```
df = df.astype(object).where(pd.notnull(df),None) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2019-10-10T13:35:17.987

另一个补充：替换倍数并将列的类型从**object**转换回**float**时要小心。如果您想确定您`None`的 ' 不会翻转回`np.NaN`'，请使用 using 应用 @andy-hayden 的建议`pd.where`。替换如何仍然会“出错”的说明：

```
In [1]: import pandas as pd

In [2]: import numpy as np

In [3]: df = pd.DataFrame({"a": [1, np.NAN, np.inf]})

In [4]: df
Out[4]:
     a
0  1.0
1  NaN
2  inf

In [5]: df.replace({np.NAN: None})
Out[5]:
      a
0     1
1  None
2   inf

In [6]: df.replace({np.NAN: None, np.inf: None})
Out[6]:
     a
0  1.0
1  NaN
2  NaN

In [7]: df.where((pd.notnull(df)), None).replace({np.inf: None})
Out[7]:
     a
0  1.0
1  NaN
2  NaN 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2019-04-29T04:21:44.520

只是对@Andy Hayden 回答的补充：

由于[`DataFrame.mask`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mask.html)是 的相反双胞胎[`DataFrame.where`](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.where.html)，它们具有完全相同的签名但具有相反的含义：

*   `DataFrame.where`对于*替换条件为**False**的值很有用。*
*   `DataFrame.mask`用于*替换条件为**True**的值。*

所以在这个问题中，使用`df.mask(df.isna(), other=None, inplace=True)`可能更直观。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-11-09T14:48:22.423

很老了，但我偶然发现了同样的问题。尝试这样做：

```
df['col_replaced'] = df['col_with_npnans'].apply(lambda x: None if np.isnan(x) else x) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-07-13T12:51:09.413

我相信最干净的方法是使用方法中的`na_value`参数`pandas.DataFrame.to_numpy()`（[文档](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_numpy.html)）：

> **na_value** : 任意，可选
> 
> 用于缺失值的值。默认值取决于 dtype 和 DataFrame 列的 dtypes。
> 
> *1.1.0 版中的新功能。*

例如，您可以使用将 NaN 替换为 None 的字典转换为

```
columns = df.columns.tolist()
dicts_with_nan_replaced = [
    dict(zip(columns, x))
    for x in df.to_numpy(na_value=None)
] 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2022-01-26T11:37:27.583

replace `np.nan`with**在不同版本的 pandas 中**`None`以不同的方式完成：

 **```
if version.parse(pd.__version__) >= version.parse('1.3.0'):
    df = df.replace({np.nan: None})
else:
    df = df.where(pd.notnull(df), None) 
```

这解决了对于 pandas 版本 <1.3.0 的问题，如果其中的值`df`已经存在，`None`那么`df.replace({np.nan: None})`会将它们切换回`np.nan`!

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-05T19:52:34.913

您是否有要偶然查看的代码块？

使用*.loc*，pandas 可以根据逻辑条件（过滤）访问记录并对其进行操作（使用 = 时）。将*.loc*掩码设置为某个值将**就地**更改返回数组（所以在这里要小心；我建议在代码块中使用之前对 df 副本进行测试）。

```
df.loc[df['SomeColumn'].isna(), 'SomeColumn'] = None 
```

外部函数是*df.loc[row_label, column_label] = None*。我们将使用*.isna()方法为 row_label 使用布尔掩码，在**SomeColumn*列中查找“NoneType”值。

我们将使用*.isna()*方法返回*SomeColumn*列中的行/记录的布尔数组作为我们的**row_label**：*df['SomeColumn'].isna()*。它将隔离*SomeColumn具有 Pandas 使用**.isna()*方法检查的任何“NoneType”项目的所有行。

我们将在为 row_label 屏蔽数据框时使用 column_label，并为*.loc*掩码标识我们想要操作的列。

最后，我们将*.loc*掩码设置为*None*，因此返回的行/记录根据掩码索引更改为*None 。*

以下是有关*.loc*和*.isna()*的 pandas 文档的链接。

参考资料：
[https ://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html) [https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isna.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-12-01T07:07:55.690

在用 where 语句替换之前将 numpy NaN 转换为 pandas NA：

```
df = df.replace(np.NaN, pd.NA).where(df.notnull(), None) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-12-02T20:16:35.867

在将 Pandas 更新到 1.3.2 后发现推荐的答案和替代建议都不适用于我的应用程序后，我采用蛮力方法解决了安全问题：

```
buf = df.to_json(orient='records')
recs = json.loads(buf) 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-03-04T15:35:57.880

还有另一种选择，这实际上对我有用：

```
df = df.astype(object).replace(np.nan, None) 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2021-11-25T13:54:49.957

这对我有用：

```
df = df.fillna(0) 
```**

# java - 在 netbeans 运行时添加摆动组件

> ID：14162725
> 
> 赞同：0
> 
> 时间：2013-01-04T18:26:24.050
> 
> 标签：java, swing, components

我已经学习了核心 java 并且刚刚开始使用**netbeans**，但是当我试图在我的项目的运行时添加按钮、标签等组件时，我陷入了困境。我在谷歌上搜索了它，但是示例我研究的其中包括在其中使用面板的一些额外开销，，，，但是为什么我不能在运行时创建组件，因为我在像**记事本**这样的简单编辑器中创建它们，如下所示

```
JButton b4=new JButton("ok");
add b4; 
```

它不工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:44:42.603

要在运行时添加 Swing 框架元素，您需要有一个 JFrame 来添加元素。JFrame 只是一个窗口，就像您使用的任何其他窗口一样（就像 NetBeans 一样），它有一个名为`add(Component comp)`. 该参数是您要添加到 JFrame 的任何 Swing 或 AWT 组件。以下是一些示例代码，可帮助您入门：

```
// This line creates a new window to display the UI elements:
JFrame window = new JFrame("Window title goes here");

// Set a size for the window:
window.setSize(600, 400);

// Make the entire program close when the window closes:
// (Prevents unintentional background running)
window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

// This makes it so we can position elements freely:
window.setLayout(null);

// Create a new button:
JButton b4 = new JButton("ok");

// Set the location and size of the button:
b4.setLocation(10, 10);
b4.setSize(100, 26);

// Add the button to the window:
window.add(b4);

// Make the window visible (this is the only way to show the window):
window.setVisible(true); 
```

希望这可以帮助您！我记得当我开始使用 Java 时，我强烈建议首先尽可能地精通非 GUI 相关的东西，但如果你准备好使用 Swing，那么上面的代码应该可以工作。祝你好运！

# spring - Spring MVC [版本 Spring 3.1.0.RELEASE] 中的依赖注入问题

> ID：14162729
> 
> 赞同：2
> 
> 时间：2013-01-04T18:26:40.367
> 
> 标签：spring, spring-mvc, spring-3

我正在创建一个 Spring MVC 应用程序。

控制器依赖于服务层中的服务之一[名称：TestExecutionOrchestratorService.java]。TestExecutionOrchestratorService 依赖于其他几个服务 [名称：JUnitTestExecutorService、QTPTestExecutorService]。配置被设置为在 Map 中注入这些服务。

Controller 和 TestExecutionOrchestratorService 使用注释自动装配。TestExecutionOrchestratorService 及其依赖项使用 XML 配置进行连接。

## 我试图解决的依赖问题：

Controller 正在获取 TestExecutionOrchestratorService 的对象。TestExecutionOrchestratorService 正在获取注入的依赖服务映射 [我可以通过打印出的日志消息来判断]。我将此 Map 作为实例变量保存在 TestExecutionOrchestratorService 中。但是，Controller 中的 TestExecutionOrchestratorService 对象的实例在依赖注入期间似乎没有设置 Map。换句话说：

Controller---DEPENDS ON--->TestExecutionOrchestratorService---DEPENDS ON--->Map[of JUnitTestExecutorService, QTPTestExecutorService] 在Controller中设置的TestExecutionOrchestratorService实例中Map为空。我从日志消息中知道在服务器启动期间正在注入 Map。

代码和 XML 文件如下：

## 清单 1 - 控制器

```
 /**
     * Handles requests for the application home page.
     */
    @Controller
    public class HomeController {

    private static final Logger logger = LoggerFactory.getLogger(HomeController.class);

    @Autowired
    private TestExecutionOrchestratorService testExecutionOrchestratorService;

    /**
     * Simply selects the home view to render by returning its name.
     */
    @RequestMapping(value = "/", method = RequestMethod.GET)
    public String home(Locale locale, Model model) {
        logger.info("Welcome home! the client locale is "+ locale.toString());

        Date date = new Date();
        DateFormat dateFormat = DateFormat.getDateTimeInstance(DateFormat.LONG, DateFormat.LONG, locale);

        String formattedDate = dateFormat.format(date);

        model.addAttribute("serverTime", formattedDate );

        //ISSUE: Call to the service layer. The Map in the service is empty even though dependency injection is happening
                //there.
        if (testExecutionOrchestratorService != null) {
          logger.info("testExecutionOrchestratorService is not null. Executing it...");
          testExecutionOrchestratorService.runTests();
        }
        else {
          logger.info("testExecutionOrchestratorService is null. Why Why Why??");
        }

        return "home";
    }

} 
```

## 清单 2 - TestExecutionOrchestratorService

```
 /*
     * This class is the entry point into test execution. It takes the request to execute tests
     * and calls the appropriate test executors.
     */

    @Service("testExecutionOrchestratorService")
    public class TestExecutionOrchestratorService implements TestResultsReporter {
    /* List of executor services */
    private Map<String, TestExecutorService> testExecutors = new HashMap<String, TestExecutorService>();

  private static final Logger logger = LoggerFactory.getLogger(TestExecutionOrchestratorService.class);

  /*
   * For Spring's dependency injection - to inject all the test executors.
   */
  public void setExecutormap(Map<String, TestExecutorService> exMap) {
    if (exMap != null) {
      Set<Entry<String, TestExecutorService>> mapEntrySet = exMap.entrySet();
      logger.error("TestExecutionOrchestratorService [setExecutorMap]: Got a map of test executors. The entries are:");
      for (Entry<String, TestExecutorService> mapE: mapEntrySet) {
        logger.error("Key: " + mapE.getKey() + ", Value: " + mapE.getValue().getExecutorName());
      }

      //ISSUE: testExecutors is showing as null in the "runTests" method that is called by the Controller. Why??
      testExecutors.putAll(exMap);  
    }
    else {
      logger.error("TestExecutionOrchestratorService [setExecutorMap]: Got a null executors map");  
    }
  }

  /* runTests - Calls upon the various executors to run the tests.
   * ISSUE: The Controller is calling this method but the Map set in 'setExecutorMap' is not being found. */
  public void runTests() {
    logger.error("TestExecutionOrchestratorService [runTests]: Entering the method");
    /* Create a unique test run ID. This will be the current time stamp. */
    String testRunTimestamp = new Timestamp(new Date().getTime()).toString(); 
    logger.error("TestExecutionOrchestratorService [runTests]: Will execute executors with test run ID: " + testRunTimestamp);
        /* Call each executor and ask them to run their default tests. */

        if ((testExecutors != null) && (!testExecutors.isEmpty())) {
          logger.error("TestExecutionOrchestratorService [runTests]: test executors are available. Will execute them.");
          Collection<TestExecutorService> teServices = testExecutors.values();
          for (TestExecutorService teService: teServices) {

          teService.runTests(testRunTimestamp, null, this);

          }
        }
        else {
          /* ISSUE: THIS IS WHERE EXECUTION IS ALWAYS COMING */
          logger.error("TestExecutionOrchestratorService [runTests]: There are no test executors available.");
        }

    }
} 
```

## 清单 3 - Spring 的 Web 上下文 XML 文件 (root-context.xml)

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="..">

<!-- Root Context: defines shared resources visible to all other web components -->

<!-- Defining services -->
<!-- The following services are defined here: TestExecutionOrchestratorService,
JUnitTestExecutorService, QTPTestExecutorService -->
<!-- Definition of the JUnitTestExecutorService -->
<bean id="junitexecutor" name="junitexecutor" class="com.testing.autofwk.execution.JUnitTestExecutorService" />
<!-- Definition of the QTPTestExecutorService -->
<bean id="qtpexecutor" name="qtpexecutor" class="com.testing.autofwk.execution.QTPTestExecutorService" />
<!-- Definition of the TestExecutionOrchestratorService -->
<bean id="testexecutororchestrator" name="testexecutororchestrator" class="com.testing.autofwk.execution.TestExecutionOrchestratorService">
  <property name="executormap">
    <map>

       <entry key="junit">
         <ref local="junitexecutor"/>
       </entry>
       <entry key="qtp">
         <ref local="qtpexecutor"/>
       </entry>
    </map>
  </property>
</bean>

<context:component-scan base-package="com.testing.autofwk.execution" />

</beans> 
```

## 清单 4 - MVC 应用程序调度程序的上下文 XML 文件 (servlet-context.xml)

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="..">

<!-- DispatcherServlet Context: defines this servlet's request-processing infrastructure -->

<!-- Enables the Spring MVC @Controller programming model -->
<annotation-driven />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
<resources mapping="/resources/**" location="/resources/" />

<!-- Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory -->
<beans:bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <beans:property name="prefix" value="/WEB-INF/views/" />
    <beans:property name="suffix" value=".jsp" />
</beans:bean>

<context:component-scan base-package="com.testing.autofwk" />

</beans:beans> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:50:29.030

似乎您正在创建多个，`TestExecutionOrchestratorService`并且错误的一个被注入到您的控制器中。加载 root-context.xml 时会创建一个对象，并且由于`TestExecutionOrchestratorService`具有`@Service`注释，因此将在扫描类时创建其他 bean。

最重要的是，由于调度程序的上下文 XML 文件，某些包将被扫描两次。

在调度程序的上下文 XML 文件中使用类似这样的内容是一个很好的做法，以避免多次扫描同一个类：

```
<context:component-scan base-package="com.testing.autofwk" use-default-filters="false">
    <context:include-filter expression="org.springframework.stereotype.Controller" type="annotation" />
</context:component-scan> 
```

在根上下文中：

```
<context:component-scan base-package="com.testing.autofwk">
    <context:exclude-filter expression="org.springframework.stereotype.Controller" type="annotation"/>
</context:component-scan> 
```

# objective-c - 编译时检查 Xcode 中的有效文件引用

> ID：14162730
> 
> 赞同：5
> 
> 时间：2013-01-04T18:26:44.613
> 
> 标签：objective-c, ios, xcode, compiler-construction, llvm-clang

**是否可以强制 Xcode 编译器验证代码中引用的文件是否有效？**

当您通过 NSString 以编程方式自然地引用文件时，Cocoa 开发中有多个要点：

```
[UINib nibWithNibName:@"MyNib" bundle:nil];
[UIImage imageNamed:@"MyImage"];
[[UIViewController alloc] initWithNibName:@"MyNib" bundle:nil]; 
```

在编译时有什么方法可以检查这些文件引用是否有效？

经常使用上述方法后，我最终更改了引用文件的名称，但忘记在代码中更改名称。一切都没有问题，只有当您碰巧访问访问此文件的应用程序部分时，错误才会显示出来。

**人们是否使用另一种方法或技术来避免此类错误？**
通过字符串引用文件名感觉非常脆弱。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T19:05:37.400

**警告：这个答案大多已经过时了。总体思路很好，但现在存在更好的解决方案（例如，使用 SwiftGen 脚本生成枚举的图像资产）。**

Nibs 通常有一个与文件同名的类，例如

```
[[MyViewController alloc] initWithNibName:NSStringFromClassName([MyViewController class]) bundle:nil];
```

我通常将其隐藏到控制器的`init`方法中`[self class]`。

对于图像加载，编译时检查很困难。用宏帮助自己，首先用一个简单的宏替换加载方法，例如

```
#define LOAD_IMAGE(__IMAGE_NAME__) [UIImage imageNamed:__IMAGE_NAME__]
```

您应该做的第一件事是在`assert`此宏中添加一个并始终检查图像是否已成功加载。这不是编译时检查，但它有助于找到丢失的资源。

第二件事是编写一个 ruby​​/python/shell/（任何脚本语言）脚本，它将搜索您的源文件`LOAD_IMAGE`并检查文件（在括号之间）是否存在。作为一个shell 脚本，它会非常简单（例如使用`grep`）。您可以将此脚本添加到您的 xcode 项目中以在编译时运行。不要忘记检查 xibs 引用的图像。

但是，通常您必须动态创建图像名称，例如`NSString* imageName = [NSString stringWithFormat:@"image_%i", index]`. 无法在编译时检查它。

也不要忘记进行反向检查 - 不要包含未在任何地方使用的图像文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T05:20:30.107

[肯特萨瑟兰的自动完成功能`[UIImage imageNamed:]`](https://github.com/ksuther/KSImageNamed-Xcode)。
这在 Xcode 中提供了代码完成支持——一段出色的代码。这在 Xcode 4.6 中对我有用：![在此处输入图像描述](../Images/13e640365e8816a7cdd84ecd354c93bc.png)

目前这个项目不支持除`imageNamed:`. 为了支持这些，我将尝试编写一个编译时脚本。或者，也许我会变得大胆并尝试扩展萨瑟兰先生的精彩作品。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T18:48:43.253

Xcode 不支持这一点，但如果这个问题真的很困扰你，那么你可以使用以下 hack：

*   给每个捆绑内文件一个唯一的前缀（例如 app__）
*   将文件添加到项目时，请确保首先将其重命名以添加此前缀。
*   您的编译时（分发前）检查有两个部分：1）搜索所有 .m 文件并枚举以前缀开头的字符串。您不必检查字符串是否被引用，因为您的前缀是唯一的。2) grep project.pbxproj 为每个字符串检查它是否包含在包中。

通过一些努力，这个过程可以大部分自动化和优化，但上面的方法应该可以工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T20:16:30.317

这是我们使用的 bash 脚本，它列出了磁盘上的所有图像，但在代码中没有引用。 [https://gist.github.com/3750087](https://gist.github.com/3750087)

可能很容易扭转这种情况以检查非扩展图像和 xib。无论如何，脚本应该是一个很好的起点

# mysql - SQL / MySQL - 如何获得唯一的周数（独立于年份）？

> ID：14162731
> 
> 赞同：3
> 
> 时间：2013-01-04T18:26:54.843
> 
> 标签：mysql, sql

我想从以星期一作为一周的第一天开始的 DATE 获取一周的数量。虽然 WEEK() 可以部分实现这一点，但我希望每周都能被唯一标识。即，与其从 52 或 53 滚动到 0 或 1，不如继续计数到第 54 周、第 55 周等。

在 SQL 中完成此任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T18:30:31.750

如果周数应该是连续的（可能是为了计算时间跨度），您可以选择过去的任意一个星期日，应该是第 1 周，计算从那天起的天数，然后除以 7。（选择星期日将使星期一成为本周开始。）

```
SELECT CEIL( DATEDIFF( '2013-01-04', '1970-01-04' ) / 7 ) AS week;  # 2244 
```

如果您只需要唯一标识，则可以使用`YEARWEEK()`get`201253`等`201301`。

```
SELECT YEARWEEK( '2013-01-04', 1 ) AS week;  # 201301 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-21T01:39:17.013

我使用以下解决方案，从一个月和一周制作一个唯一的字符串

```
id=str(time.month)+str(time.isocalendar()[1]) 
```

# eclipse - Eclipse - “工作区正在使用或无法创建，请选择其他工作区。” 即使我删除了 .lock

> ID：14162733
> 
> 赞同：2
> 
> 时间：2013-01-04T18:27:05.530
> 
> 标签：eclipse

我移动了我的工作区，将其移回，现在我收到了这个错误。此错误的另一个[线程](https://stackoverflow.com/questions/7465793/eclipse-workspace-in-use-or-cannot-be-created-chose-a-different-one)建议我从 .metadata 文件夹中删除 .lock 文件，但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T10:13:06.980

有时 eclipse 或 java 进程仍在运行，即使您再也看不到 Eclipse 的任何 UI。然后它可能仍然持有文件锁或其他操作系统特定的资源锁。

因此，在崩溃后再次尝试使用工作区之前，请始终终止所有 eclipse 进程（和相关的 java 进程）。如果您不确定这些过程，重新启动是执行此操作的安全方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-18T09:23:45.047

您可以尝试以管理员身份启动 Eclipse。可能你有权限问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-25T04:32:08.173

在您的命令行中，将 eclipse 运行为：

```
eclipse -clean 
```

# java - CheckBox 接收堆栈中的所有事件，即使它没有被点击

> ID：14162736
> 
> 赞同：1
> 
> 时间：2013-01-04T18:27:15.140
> 
> 标签：java, libgdx

我有一个堆栈，我首先在其中添加按钮，然后添加复选框。

复选框仅填充整个元素中 1/4 的空间，但是当我尝试单击组内任意位置的按钮时，复选框会接收所有事件。

![看法](../Images/c698bab85d0050fca80c2140a1ea2e13.png)

```
TextureRegionDrawable drawable = new TextureRegionDrawable(tile.getTexture());
ImageButton button = new ImageButton(drawable, drawable);
Stack group = new Stack();

button.addListener(new ClickListener() {
        @Override
        public void clicked(InputEvent event, float x, float y) {
                super.clicked(event, x, y);
                createTileEditor(tile);
        }
});

CheckBox box = new CheckBox("", skin);

tileGroup.add(box);
group.add(button);
group.add(box);
box.align(Align.bottom | Align.right);
group.pack();

boxes.put(box, tile);

tileTable.add(group).pad(2f);

if (counter++ > 0 && counter % 4 == 0) {
        tileTable.row();
} 
```

# javascript - json 在不知道对象名称的情况下获取对象

> ID：14162737
> 
> 赞同：0
> 
> 时间：2013-01-04T18:27:22.300
> 
> 标签：javascript, json

我有一些从 jquery ajax 函数返回的 json。

这是所述json的示例：

```
 var b =
        {
            "SelectByUserResult": [{ "DateAdded": "/Date(1357300130930+0000)/", "Deleted": false, "FileExtension": "jpg", "Filename": "e5d1ee90-f3c0-4dd7-9996-d1725a1fc031.jpg", "Height": 768, "Id": 955, "IsBpMember": true, "OriginalFilename": "Tulips.jpg", "SessionId": "277d31bf-84e1-4678-ad66-e7b332936219", "Title": "New image", "TotalRecords": 16, "UserId": "ded98560-61d0-42f2-944e-30280d54e94b", "Width": 1024}]
        } 
```

我有其他 ajax 函数以类似的结构返回类似的 json，唯一的区别是对象“SelectByUserResult”可能更改为“SelectByIdResult”或“SelectByNameResult”。

所以在我的 ajax 函数中（在成功函数中）我会这样做来访问 json b.SelectByUserResult

我希望能够访问该对象但不指定名称（因为它并不总是已知的）。我该怎么做呢？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:35:32.830

我有趣的变体（也许不是最好的）。它将返回对象的第一个属性，我想这就是你需要的。

```
function getFirstProp(obj) {
    for (var i in obj) return obj[i];
} 
```

用法：

```
console.log(getFirstProp(b)); 
```

# c++ - 从函数返回容器：优化速度和现代风格

> ID：14162738
> 
> 赞同：0
> 
> 时间：2013-01-04T18:27:27.583
> 
> 标签：c++, optimization, c++11, rvalue-reference

不完全是一个问题，虽然只是我一直在思考如何通过风格更优雅地编写这样的代码，同时充分利用新的 c++ 标准等。这是示例

将斐波那契序列返回到一个容器中最多 N 个值（对于那些不倾向于数学的人，这只是将前两个值相加，前两个值等于 1。即 1,1,2,3,5,8,13,.. .)

示例从 main 运行：

```
std::vector<double> vec;
running_fibonacci_seq(vec,30000000); 
```

1)

```
template <typename T, typename INT_TYPE>
    void running_fibonacci_seq(T& coll, const INT_TYPE& N)
    {
        coll.resize(N);
        coll[0] = 1;
        if (N>1) {
        coll[1] = 1;
        for (auto pos = coll.begin()+2;
            pos != coll.end();
            ++pos)
        {
            *pos = *(pos-1) + *(pos-2);
        }
        }
    } 
```

2) 相同，但使用**右值**&& 而不是 & 1.e。

```
void running_fibonacci_seq(T&& coll, const INT_TYPE& N) 
```

**编辑：正如下面评论的用户所注意到的，右值和左值在时间上没有任何作用——由于评论中讨论的原因，速度实际上是相同的**

N = 30,000,000 的结果

```
Time taken for &:919.053ms

Time taken for &&: 800.046ms 
```

首先，我知道这确实不是一个问题，但是其中哪个或哪个是最好的现代 C++ 代码？使用右值引用 (&&) 似乎移动语义已经到位，并且没有制作不必要的副本，这在时间上做了一个小的改进（对我来说很重要，因为未来的实时应用程序开发）。一些具体的“问题”是

a) 将容器（在我的示例中是向量）作为参数传递给函数并不是真正应该如何使用右值的优雅解决方案。这是真的吗？如果是这样，在上面的示例中，右值如何真正显示它的轻量级？

b) **coll.resize(N);** 调用和**N=1**的情况，有没有办法避免这些调用，所以给用户一个简单的界面，只使用函数而不动态创建向量的大小。可以在这里使用模板元编程，以便在编译时为向量分配特定大小吗？（即running_fibonacci_seq<30000000>）因为数字可能很大，是否需要使用模板元编程，如果可以的话，我们也可以使用[这个（链接）](http://cpptruths.blogspot.co.uk/2011/07/want-speed-use-constexpr-meta.html)

c) 有没有更优雅的方法？我有一种感觉 std::transform 函数可以通过使用**lambdas**来使用，例如

```
 void running_fibonacci_seq(T&& coll, const INT_TYPE& N)
    {
        coll.resize(N);
        coll[0] = 1;
        coll[1] = 1;
        std::transform (coll.begin()+2,
                coll.end(),         // source
                coll.begin(),       // destination
                [????](????) {      // lambda as function object
                    return ????????;
                });
    } 
```

[1] [http://cpptruths.blogspot.co.uk/2011/07/want-speed-use-constexpr-meta.html](http://cpptruths.blogspot.co.uk/2011/07/want-speed-use-constexpr-meta.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T19:07:53.767

显而易见的答案：

```
std::vector<double> running_fibonacci_seq(uint32_t N); 
```

为什么 ？

由于 const-ness：

```
std::vector<double> const result = running_fibonacci_seq(....); 
```

因为更简单的不变量：

```
void running_fibonacci_seq(std::vector<double>& t, uint32_t N) {
    // Oh, forgot to clear "t"!
    t.push_back(1);
    ...
} 
```

但是速度呢？

有一种称为返回值优化的优化允许编译器在许多情况下省略副本（并直接在调用者的变量中构建结果）。*即使复制/移动构造函数有副作用*，C++ 标准也明确允许这样做。

那么，为什么要传递“out”参数呢？

*   你只能有一个返回值（*叹气*）
*   您可能希望重用分配的资源（这里是内存缓冲区`t`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T19:24:00.217

由于“引用折叠”，此代码不使用右值引用，也不移动任何东西：

```
template <typename T, typename INT_TYPE>
void running_fibonacci_seq(T&& coll, const INT_TYPE& N);

running_fibonacci_seq(vec,30000000); 
```

All of your questions (and the existing comments) become quite meaningless when you recognize this.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T19:17:40.453

简介：

```
#include <vector>
#include <cstddef>
#include <type_traits>

template <typename Container>
Container generate_fibbonacci_sequence(std::size_t N)
{
    Container coll;
    coll.resize(N);
    coll[0] = 1;
    if (N>1) {
      coll[1] = 1;
      for (auto pos = coll.begin()+2;
        pos != coll.end();
        ++pos)
      {
        *pos = *(pos-1) + *(pos-2);
      }
    }
    return coll;
}

struct fibbo_maker {
  std::size_t N;
  fibbo_maker(std::size_t n):N(n) {}
  template<typename Container>
  operator Container() const {
    typedef typename std::remove_reference<Container>::type NRContainer;
    typedef typename std::decay<NRContainer>::type VContainer;
    return generate_fibbonacci_sequence<VContainer>(N);
  }
};

fibbo_maker make_fibbonacci_sequence( std::size_t N ) {
  return fibbo_maker(N);
}

int main() {
  std::vector<double> tmp = make_fibbonacci_sequence(30000000);
} 
```

这些`fibbo_maker`东西只是我很聪明。但它可以让我推断出你想要的 fibbo 序列的类型，而不必重复它。

# java - 存储长度为键的字符串关联数组

> ID：14162748
> 
> 赞同：2
> 
> 时间：2013-01-04T18:27:57.677
> 
> 标签：java, string, collections, associative-array

我有这个输入：

```
5
it
your
reality
real
our 
```

第一行是后面的字符串数。我应该以这种方式存储它（伪代码）：

```
associative_array = [ 2 => ['it'], 3 => ['our'], 4 => ['real', 'your'], 7 => ['reality']] 
```

如您所见，关联数组的键是存储在内部数组中的字符串的长度。那么我怎么能在java中做到这一点？我来自php世界，所以如果你将它与php进行比较，那就很好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:30:15.313

```
MultiMap<Integer, String> m = new MultiHashMap<Integer, String>();

for(String item : originalCollection) {
    m.put(item.length(), item);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:37:15.290

djechlin 已经发布了一个更好的版本，但这是一个仅使用 JDK 类的完整独立示例：

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;    
   public class Main {
        public static void main(String[] args) throws Exception{
            BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
            String firstLine = reader.readLine();
            int numOfRowsToFollow = Integer.parseInt(firstLine);
            Map<Integer,Set<String>> stringsByLength = new HashMap<>(numOfRowsToFollow); //worst-case size
            for (int i=0; i<numOfRowsToFollow; i++) {
                String line = reader.readLine();
                int length = line.length();
                Set<String> alreadyUnderThatLength = stringsByLength.get(length); //int boxed to Integer
                if (alreadyUnderThatLength==null) {
                    alreadyUnderThatLength = new HashSet<>();
                    stringsByLength.put(length, alreadyUnderThatLength);
                }
                alreadyUnderThatLength.add(line);
            }
            System.out.println("results: "+stringsByLength);
        }
    } 
```

它的输出如下所示：

```
3
bob
bart
brett
results: {4=[bart], 5=[brett], 3=[bob]} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T18:42:53.747

Java 没有关联数组。但它确实有 Hashmaps，它主要实现了相同的目标。在您的情况下，您可以为任何给定键设置多个值。因此，您可以做的是使 Hashmap 中的每个条目成为数组或某种集合。ArrayList 是一个可能的选择。那是：

```
Hashmap<Integer,ArrayList<String>> words=new HashMap<Integer,ArrayList<String>>(); 
```

我不会通过代码从文件或其他任何内容中读取您的列表，这是一个不同的问题。但只是为了让您了解结构如何工作，假设我们可以对列表进行硬编码。我们可以这样做：

```
ArrayList<String> set=new ArrayList<String)();
set.add("it");
words.put(Integer.valueOf(2), set);
set.clear();
set.add("your");
set.add("real");
words.put(Integer.valueOf(4), set); 
```

等等。

```
In practice, you probably would regularly be adding words to an existing set. I often do that like this:

void addWord(String word)
{
  Integer key=Integer.valueOf(word.length());
  ArrayList<String> set=words.get(key);
  if (set==null)
  {
    set=new ArrayList<String>();
    words.put(key,set);
  }
  // either way we now have a set
  set.add(word);
} 
```

旁注：我经常看到程序员通过将“set”放回Hashmap来结束这样的块，即最后的“words.put(key,set)”。这是不必要的：它已经存在了。当您从 Hashmap 获得“设置”时，您获得的是参考，而不是副本，因此您所做的任何更新都只是“那里”，您不必将其放回原处。

免责声明：此代码不在我的脑海中。没有任何明示或暗示的保证。我有一段时间没有编写任何 Java，所以我可能有语法错误或错误的函数名称。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T18:30:36.337

由于您的密钥似乎是小整数，您可以使用列表列表。在这种情况下，最简单的解决方案是使用 MultiMap 之类的

```
Map<Integer, Set<String>> stringByLength = new LinkedHashMap<>();

for(String s: strings) {
   Integer len = s.length();
   Set<String> set = stringByLength.get(s);
   if(set == null)
        stringsByLength.put(len, set = new LinkedHashSet<>());
   set.add(s);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T18:35:29.917

```
private HashMap<Integer, List<String>> map = new HashMap<Integer, List<String>>();

void addStringToMap(String s) {
    int length = s.length();
    if (map.get(length) == null) {
        map.put(length, new ArrayList<String>());
    }
    map.get(length).add(s);
} 
```

# sql - 在 SSIS 包中将字符串转换为十进制值

> ID：14162749
> 
> 赞同：2
> 
> 时间：2013-01-04T18:28:02.627
> 
> 标签：sql, sql-server-2008, ssis, derived

我有一个使用 SSIS 包导入 SQL Server 2008 的平面文件。

该文件包含一个带数字的字段，当前一列值为负时，后跟一个带负号的列。

例如：

```
Price    Sign
-----    -----
9212.00 
  29.01    -
 268.00    -
 453.02 
```

我想将此值加载到表格的十进制列中。

为了实现这一点，我在我的数据流任务中创建了一个派生列。派生列的表达式是`[Sign] + [Price]`。我已经（使用高级编辑器）将派生列定义为类型 decimal `[DT_DECIMAL]`。

然后我只是将数据（连同派生列）加载到我的表中。

这听起来像是处理这种情况的好方法吗？我应该考虑另一种方法吗？使用这种方法有什么“陷阱”吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T14:53:08.327

你的方法似乎是最好的选择。平面文件中每一列的默认数据类型是字符串。因此，您的`[Sign] + [Price]`表达式正在执行字符串连接。而且，当移动到输出列时，数据会隐式转换为十进制值。

一项可以提高可读性的更改是将字符串值显式转换为小数。您可以将派生列组件中的表达式更改为：

```
(DT_DECIMAL, scale)[Sign] + [Price] 
```

where`scale`是一个与输出列的数据类型匹配的数字。

通过此更改，派生列组件的输出将是十进制数据类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T20:22:13.973

也许这行不通...

1.  您需要转换`Sign`为字符串数据类型和`Price`数字。
2.  然后比较 if `Sign`is `"-"`, if is, multiple from `-1`。

派生列代码示例：

```
(DT_WSTR, 1) [Sign]=="-"?  [Price]*-1 :  [Price] 
```

![在此处输入图像描述](../Images/aa4e9eae3939fe5bbfb235f60e316ff8.png)

# iphone - 触摸速度

> ID：14162755
> 
> 赞同：0
> 
> 时间：2013-01-04T18:28:23.393
> 
> 标签：iphone, objective-c, ios, cocos2d-iphone

我正在 cocos2d 中制作一个简单的物理游戏，并希望在滑动时以滑动的速度发射一个粒子。为了获得速度，我需要进行两次触摸并确定（位置差异）/（时间戳差异）。我的问题是我无法进行两次触摸。我尝试了几种方法，但都没有奏效。

我尝试存储第一次触摸

```
@property (nonatomic, strong) UITouch *firstTouch;

...

- (void)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];

    [self setFirstTouch:touch];
    NSLog(@"first touch time 1: %f", self.firstTouch.timestamp);
}

-(void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];

    NSLog(@"touch ended");
    NSLog(@"first touch time 2: %f", self.firstTouch.timestamp);
    NSLog(@"end of touch time: %f", touch.timestamp);
} 
```

但这给了我每次时间戳都为 0 的差异。它似乎用最近的触摸替换了 firstTouch

我对被替换的指针做错了吗？

也许我可以从 ccTouchesMoved 获得最后两次触摸？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T18:35:35.673

做你想做的事情的一个更简单的方法是添加一个`UIPanGestureRecognizer`，`[CCDirector sharedDirector].openGLView`然后使用`velocityInView`手势识别器的属性。

```
UIPanGestureRecognizer* gestureRecognizer = [[[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)] autorelease];
[[CCDirector sharedDirector].openGLView addGestureRecognizer:gestureRecognizer]; 
```

进而：

```
- (void)handleSwipe:(UIPanGestureRecognizer*)recognizer {
    ... recognizer.velocity...
} 
```

`ccTouches...`如果你想按照你的方法基于结尾。所以你需要跟踪你的手指在里面的移动`ccTouchesMoved:`；然后在 touchesEnded 中判断是水平还是垂直滑动，方向，并发出子弹。

希望这些建议中的任何一个都可能有所帮助。

# javascript - IE9：contenteditable div 内的 non-contenteditable span 可调整大小

> ID：14162757
> 
> 赞同：0
> 
> 时间：2013-01-04T18:28:56.950
> 
> 标签：javascript, html, internet-explorer-9, contenteditable

我试图在 contenteditable div 中有一些不可编辑的内容。下面的代码渲染在 IE9（以及其他浏览器）中做得很好。但是单独使用 IE9 就看到了一个奇怪的问题。不可编辑的内容在 IE9 中可重新调整大小。我不想要这种行为。所以我想通过尝试捕捉跨度上的点击事件并忽略它们来表现得聪明。然后我观察到另一个问题，其中没有调用单击事件函数。似乎确实没有任何事件可以附加到该跨度。有趣的是，当我删除 span 的 contenteditable 属性时，它开始接收事件（但这无济于事，因为我需要它是不可编辑的）。

所以问题是我们如何防止用户在 IE9 中调整这个 span 的大小？

```
<html>
<head>
  <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function() {
    $('span').bind('click', function(e) {
      e.preventDefault(); return false;
    });
  });
  </script>
</head>
<body>
    <div contenteditable="true">
      <span contenteditable="false">non-editable</span>
      editable div
    </div>
</body>
</html> 
```

有趣的是，当我在 jsfiddle 上尝试这个时，我发现我的问题已经解决了。我发现跨度确实不可调整大小。然后我意识到，如果我将上述内容呈现在 i-frame 中，那么它的行为就像我想要的那样（即禁用调整大小）。但是，这是一个非常粗略的解决方案。我期待应该有一个更好的解决方案。

# php - MySQL - 这个和这个或这个

> ID：14162759
> 
> 赞同：0
> 
> 时间：2013-01-04T18:29:02.893
> 
> 标签：php, mysql

这是一个更新字段，我正在检查以确保数字 AND 关键字 -> 或活动名称存在以防止重复。

此查询未按预期运行：

```
$STH = $DBH->prepare("
    SELECT * 
    FROM campaigns 
    WHERE number = :number AND keyword = :keyword
    OR name LIKE :name"
); 
```

我希望它检查是否 (number=number AND keyword=keyword) OR (name=name) - 作为两个彼此不相关的不同语句。即使我将它们括在括号中，我仍然得到不正确的结果。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:34:09.667

**LIKE如果它不应该像****=**运算符一样工作，还需要有 %

```
SELECT * FROM campaigns WHERE (number = :number AND keyword = :keyword) OR name LIKE %:name%" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:31:28.637

像这样试试

```
 $STH = $DBH->prepare("SELECT * 
                   FROM campaigns 
                   WHERE (number = :number AND keyword = :keyword)
                   OR name LIKE :name"
                   ); 
```

# file-upload - Yii图片上传maxsize

> ID：14162762
> 
> 赞同：0
> 
> 时间：2013-01-04T18:29:29.380
> 
> 标签：file-upload, yii, php

```
$uploadedFile5=CUploadedFile::getInstance($campaign,'image5');    

array('campaign_image,campaign_thumbnail,campaign_imagea,campaign_imageb', 'file','types'=>'jpg, gif, png', 'maxSize' => 5 * 1024 * 1024, 'tooLarge'=>'The file was larger than 5MB. Please upload a smaller file.','allowEmpty'=>true), 
```

大家好。以上是我验证图片上传的规则。但是，它仍然只允许我上传最大大小为 2MB 的文件，因为我的 php 中的 upload_max_filesize 是 2mb。

除了编辑我的 php.ini 文件之外，是否允许我上传大于 2MB 的图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:46:05.803

有~~两种~~方法可以修改**upload_max_filesize**而不编辑php.ini ~~...~~

 **~~在您的 PHP 文件中：~~

 ~~```
ini_set('upload_max_filesize', '10M'); 
```~~ 

~~或在您的 .htaccess 文件中：~~

 ~~```
php_value upload_max_filesize 10M 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-03T23:06:45.827

采用

```
; Maximum allowed size for uploaded files.
upload_max_filesize = 40M

; Must be greater than or equal to upload_max_filesize
post_max_size = 40M 
```

在你的 php.ini~~**

# javascript - 使用 fnAdjustColumnSizing 时 DataTable(s) 未调整大小

> ID：14162763
> 
> 赞同：0
> 
> 时间：2013-01-04T18:29:30.413
> 
> 标签：javascript, datatables

我的应用程序有左窗格和右窗格。右窗格有多个选项卡，每个选项卡都包含一个数据表。

如果用户只想查看右窗格，我提供了展开右窗格的功能，因此每当右窗格展开时我都需要展开我的数据表。

我目前正在使用下面的代码来展开/折叠数据表，但这似乎无法正常工作。只有一个数据表（屏幕上显示的当前表）正确调整大小，其他表未正确调整大小。

有人可以帮我解决这个问题吗？

```
function onCollapse(e) {
  var table = $.fn.dataTable.fnTables(true);
    if ( table.length > 0 ) {
        setTimeout(function () {
            for(var i=0;i<table.length;i++){
                $(table[i]).dataTable().fnAdjustColumnSizing();
            }
        }, 200);
    }
}

function onExpand(e) {
    var table = $.fn.dataTable.fnTables(true);
    if ( table.length > 0 ) {
        setTimeout(function () {
            for(var i=0;i<table.length;i++){
                $(table[i]).dataTable().fnAdjustColumnSizing();
            }
        }, 200);
    }
} 
```

谢谢， 巴拉尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:48:52.400

好的，我想出了解决此问题的方法。

我在（kendo tabstrip）选项卡的激活事件上添加了以下代码，这解决了这个问题。

```
 function onActivate(e) {
        var table = $.fn.dataTable.fnTables();
        if ( table.length > 0 ) {
            setTimeout(function () {
                for(var i=0;i<table.length;i++){
                    $(table[i]).dataTable().fnAdjustColumnSizing();
                }
            }, 200);
        }
    } 
```

谢谢， 巴拉尼

# objective-c - 在 UIAutomation 测试期间禁用 iPad 上的网络

> ID：14162765
> 
> 赞同：4
> 
> 时间：2013-01-04T18:29:34.000
> 
> 标签：objective-c, ios, ipad, ios-simulator, ui-automation

有没有办法在 UIAutomation 的模拟器上禁用然后启用网络。我正在开发一个应用程序，当网络被禁用时，它必须在应用程序上显示一个通知栏，我希望使用 UIAutomation 对其进行测试。

请建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T21:06:05.867

我没有完整的答案，但我确实有一些参考资料可能会有所帮助。

Apple 在 OS X 上的开发工具之一是 Network Link Conditioner，可用于模拟各种网络条件。其中包括“丢弃所有数据包”（尽管我怀疑这可能不是您所说的“网络禁用”）。

[这篇文章](http://useyourloaf.com/blog/2012/01/30/network-link-conditioner.html)很好地解释了该工具。请注意，它现在是可选下载（详情请[点击此处](http://juehualu.blogspot.co.uk/2012/12/network-link-conditioner-ios.html)）。

iOS 内置了相同的功能（具有相同的名称）（显然是最小的 iOS 6，仅在设备上，而不是模拟器上）。可以通过`Settings > Developer > Network Link Conditioner`查看[这篇文章](https://stackoverflow.com/questions/12528986/using-the-network-link-conditioner-on-ios-devices)进行设置。

我不知道是否可以通过 UIAutomation 启用/禁用这些，抱歉。

# ant - ant tstamp 模式的问题 - 总是前导 0

> ID：14162770
> 
> 赞同：0
> 
> 时间：2013-01-04T18:30:07.197
> 
> 标签：ant

看看我的 ant 脚本的以下部分：

```
<tstamp>
    <format property="SHORT_DAY" pattern="d MMM yyyy"/>
    <format property="SHORT_DAY_FORMATTED" pattern="d MMM yyyy"/>
</tstamp>

<echo message="${SHORT_DAY}"/>
<echo message="${SHORT_DAY_FORMATTED}"/> 
```

今天是 2013 年 1 月 4 日，所以我希望输出是：

```
 [echo] 4 Jan 2013
 [echo] 4 Jan, 2013 
```

但事实并非如此。我得到的是：

```
 [echo] 04 Jan 2013
 [echo] 4 Jan, 2013 
```

注意第一个回显中的前导 0。出于某种原因，ant 总是用前导零来打印它。这两个属性之间的唯一区别是月份和年份之间有一个逗号。

有谁知道这是怎么回事，更重要的是，如何阻止领先的 0？

蚂蚁版本是 1.7.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:07:05.803

事实证明，我之前在 ant 文件中定义了 SHORT_DAY（是的，它是一个大文件！）

```
<format property="SHORT_DAY" pattern="dd MMM yyyy"/> 
```

而且由于 ANT 不允许您覆盖属性，因此我的第二个定义（我希望使用的那个）被忽略了。

把它归结为另一个人为错误的案例:(

# ruby-on-rails - 模型属性不会更新，在未更新的单独属性上调用验证错误？

> ID：14162771
> 
> 赞同：0
> 
> 时间：2013-01-04T18:30:06.977
> 
> 标签：ruby-on-rails, postgresql, activerecord

我有以下半高级数据库查询，它通过过去 10 年的每小时价格并返回过去 7 天的每日平均价格：

```
averages = Trade.where('date >= ?', 7.days.ago).average(:price, :group => "DATE_TRUNC('day', date - INTERVAL '1 hour')") 
```

这将返回`date`（当天）和`averageprice`这样的：

```
"2012-12-29 00:00:00"=>#<BigDecimal:7f97932be328,'0.2513458333 33333333E2',27(27)> 
```

然后，我遍历每个响应并将它们保存为 TradeDailyAverage 模型中的新记录。

```
 # Loops through each daily average produced above 
    averages.each do |date, avg|

     # Converts the BigDecimal to Floating Point(?)
     averagefloat = avg.to_f

     # Rounds the Daily Average to only two decimal points
     dailyaverage = number_with_precision(averagefloat, :precision => 2)

     # Creates a new Object in the PpDailyAverage table  
     TradeDailyAverage.create(date: date, averageprice: dailyaverage) 
```

这可行，但是由于这将是一个每小时的**抽水任务**，每小时都会有新的价格出现，我该如何更改它以首先找到一个 TradeDailyAverage `date`，如果它存在，更新`averageprice`属性，或者如果它不创建一个新记录'不存在。

Validate_uniqueness 在 TradeDailyAverage 模型上设置。

**更新**

当我这样做时，会出现 7 个项目，具有准确的平均值。但他们就是不会保存。当我添加时，`newaverage.save!`我收到**“验证错误：日期已被占用！”**

```
 newaverage = TradeDailyAverage.find_or_initialize_by_date(date: date)
          newaverage.averageprice = dailyaverage
          puts newaverage.date
          puts newaverage.averageprice 
```

另外，如果我做 newaverage.new_record？曾经平均返回 TRUE

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:33:05.440

我想你会想要这样的东西：

```
tda = TradeDailyAverage.first_or_initialize(date: date)
tda.averageprice = dailyaverage
tda.save 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T18:28:29.140

问题（感谢 Alex 的帮助）是由于日期时间的不同造成的。保存到 PG 数据库后，小时会在日期时间发生变化。这可能是由于数据库中的时区问题。因此，上面的代码找不到现有记录，因为它包含的每小时时间与数据库中保存的时间不同。

由于我正在生成每日平均值，因此我不需要时间，只需要日期列中的日期。因此，我将日期转换为日期以避免时差问题。我还用 Case 稍微更改了代码，以便我可以报告错误。我认为这不是很有效，但它现在正在工作。我相信只要将日期时间值转换为具有以下条件的日期，亚历克斯的上述解决方案也可能有效`.to_date`：

```
# Loops through each daily average produced above 
    averages.each do |datetime, avg|

    # Converts the BigDecimal to Floating Point(?)
    avgfloat = avg.to_f

    # Rounds the Daily Average to only two decimal points
    avgprice = number_with_precision(avgfloat, :precision => 2)

    # Converts datetime to date since this will not work with datetime (PostgreSQL is time-zoned challenged)    
    avgdate  = datetime.to_date

        # These are printed to use for testing. 
      puts avgdate
      puts avgprice

      # Starts Case to either report an error, update an existing record, or create new.
      case

        when avgdate.blank? || avgprice.blank?
            puts "Something went terribly wrong with your seven day averages producing algorithm."

        when TradeDailyAverage.exists?(:date=>avgdate)
            updateavg = TradeDailyAverage.find_by_date(avgdate)
            updateavg.averageprice = avgprice
            updateavg.save

        else
            TradeDailyAverage.create(:date=>avgdate, :averageprice=>avgprice)

        end # Ends Case  

    end # Ends Loop for each Daily Average 
```

# javascript - jquery slideToggle 在所有打开的 div 上

> ID：14162774
> 
> 赞同：0
> 
> 时间：2013-01-04T18:30:16.087
> 
> 标签：javascript, jquery, html

我有 div 的 id 像这样：manufacturer_12、manufacturer_37、manufacturer_71 等...

有没有办法找到所有可见性可见的 div ，并对它们执行以下操作：

```
$('[id^="manufacturer"]').slideToggle("slow"); 
```

问题是它不可能创建一个 for 循环，因为它们的 id 不是连续的。

也许我应该使用[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:32:07.557

您可以使用`.each`，但这可能有效：

```
$("[id^='manufacturer']:visible").slideToggle("slow"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:32:14.177

确实，您可以使用[`:visible`](http://api.jquery.com/visible-selector/).

```
$('[id^="manufacturer"]').filter(":visible").slideToggle("slow"); 
```

但请注意，[`.slideToggle()`](http://api.jquery.com/slideToggle/)如文档所述，这将适用于所有匹配的元素。所以，你实际上不需要在`.each()`这里使用。

> `.slideToggle( [duration] [, callback] )`
> 
> 返回：jQuery
> 
> 描述：通过滑动显示或隐藏**匹配的元素。**

`id`在这种情况下，所有以 .开头的可见元素`manufacturer`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T18:36:19.133

相信我，这不是做事的好方法。
您最好为所有感兴趣的项目分配一个特定的类，并仅基于类名编写一个非常简单的选择器。这将工作得更快。

# excel - 在 Excel 列中查找缺失数据

> ID：14162777
> 
> 赞同：1
> 
> 时间：2013-01-04T18:30:19.410
> 
> 标签：excel, compare

我正在使用 Excel 2003 并尝试比较两列以在一列中查找不在另一列中的数据。

例如：

![在此处输入图像描述](../Images/9c3c006cc5887846ee55d925fe572bca.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:09:20.387

在 VBA 中，您可以尝试以下丑陋但有效的代码：

```
Sub missing()

Dim ya As Long, yb As Long, yc As Long, alast As Long, blast As Long
Dim flag As Boolean

yc = 2
yb = 2
flag = 0
alast = Range("A65536").End(xlUp).Row
blast = Range("B65536").End(xlUp).Row

For ya = 2 To alast
flag = 0

Do While yb <= blast
    If Range("A" & ya) = Range("B" & yb) Then flag = 1
    yb = yb + 1
    Loop

    If flag = 0 Then
        Range("C" & yc) = Range("A" & ya)
        yc = yc + 1
    End If

    yb = 2

Next ya

End Sub 
```

# asp.net - 如何在 asp.net mvc 3 中更改已创建视图的 _layout？

> ID：14162778
> 
> 赞同：0
> 
> 时间：2013-01-04T18:30:23.950
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, layout, view

如果我已经创建了一堆视图，有什么方法可以更改它们的布局页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:38:24.710

您可以在文件 _ViewStart.cshtml 中更改整个应用程序的默认布局页面。默认情况下，它具有以下代码：

```
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
 } 
```

这指定如果您的任何视图没有明确说明要使用哪个布局，它们将使用此布局。

或者，您可以将代码添加到您的视图（如上），明确说明要使用的布局。

# java - 扩展抽象类和实现接口的组合

> ID：14162788
> 
> 赞同：4
> 
> 时间：2013-01-04T18:30:52.623
> 
> 标签：java, oop, interface, abstract-class

> **可能重复：**
> [为什么 ArrayList 有“implements List”？](https://stackoverflow.com/questions/4387419/why-does-arraylist-have-implements-list)

我已经阅读了几篇文章[Diff b/w I vs AC](https://stackoverflow.com/questions/761194/interface-vs-abstract-class-general-oo)以及关于何时使用接口与抽象类的问题。

当我偶然发现 ArrayList 类时，ArrayList 类扩展了 AbstractList 类实现了 List 接口。AbstractList 和 List 有常用的方法，如 add()、remove() 等。

**编辑：**换句话说，如果 AbstractList 实现 List 为什么 Arraylist 类实现 List

当两者都有共同的方法时，这种组合继承行为设计何时更受欢迎？

```
public class ArrayList<E> extends AbstractList<E>
        implements List<E> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:46:48.250

有时我创建一个`BaseClass`实现接口的抽象`IBaseClass`并创建`ChildClass`扩展`BaseClass`. 我的意思是：

```
public interface IBaseClass {

}

public abstract class BaseClass implements IBaseClass {

}

public class ChildClass extends BaseClass {

} 
```

现在说我有一个接口`IChildClass`并`ChildClass`实现它。

```
public class ChildClass extends BaseClass implements IChildClass {

} 
```

并说`IBaseClass`有方法`someMethod`。现在，如果您想`ChildClass`通过实现接口使用 的实例，`IChildClass`例如：

```
IChildClass obj = new ChildClass(); 
```

然后你不能打电话`obj.someMethod()`。然后你需要这样做：

```
public interface IChildClass extends IBaseClass {

} 
```

您可以在[Java 1.2 文档](http://www.cs.mun.ca/~michael/java/jdk1.2-docs/api/index.html)中找到该接口`java.util.List`不扩展的接口`java.util.Collection`，它在最新版本中是这样做的。`java.util.List`是当时的最高接口，并且`java.util.AbstractList`实现`List`了`ArrayList`. `AbstructList`依次扩展`AbstractCollection`. `AbstractCollection`那时是至高无上的阶级。目前`AbstractCollection`实现`Collection`. 因此很明显，遵循这种设计模式是为了牢记 Java 的可扩展模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T18:36:47.553

在这种`implements List`情况下是多余的。可能要明确此调用实现 List 而不必导航类层次结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:36:31.720

`AbstractList<E>`也实现`List<E>`了，所以它们是相同的方法。

# ruby-on-rails-3.2 - 在 Atom Feed Rails 中，img 标签未呈现为 html

> ID：14162789
> 
> 赞同：0
> 
> 时间：2013-01-04T18:30:52.590
> 
> 标签：ruby-on-rails-3.2, atom-feed

```
entry.content "<img src=#{resource.image.url(:medium)} width='280', height='180'>".html_safe, :type => 'html' 
```

但是，当我在 Chrome 中查看它时，输出如下：

```
<content type="html">&lt;img src=http://s3.amazonaws.com/agile_designer_uploads/images/790/medium.png?1356457984 width='280', height='180'&gt;</content> 
```

如果只有 img 标签能正确渲染，一切都会变得美好。

关于如何让它正确渲染的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:11:41.793

为避免 html 标签被转义，您可以使用 image_tag 并在其上调用 html_safe。

`entry.content image_tag(resource.image.url(:medium)).html_safe, :type => 'html'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T04:44:49.930

我必须在这里验证我的原子提要格式：http: [//validator.w3.org/appc/check.cgi](http://validator.w3.org/appc/check.cgi)

一旦它验证了图像显示。

# php - 如何在 PHP 的函数中设置变量变量？

> ID：14162792
> 
> 赞同：1
> 
> 时间：2013-01-04T18:30:53.340
> 
> 标签：php, forms, scope

我正在制作一个表格，其中一些是可选的。为了显示这个表单的输出，我希望能够检查一个 POST 变量是否有内容。如果是，脚本应该创建一个新的普通 PHP 变量，其值和名称与 POST 变量相同，如果不是，它应该创建一个新的普通 PHP 变量，名称相同，但值为“未定义”。这是我到目前为止所拥有的：

```
function setdefined($var)
{
    if (!$_POST[$var] == "")
    {
        $$var = $_POST[$var]; // This seems to be the point at which the script fails
    }
    else
    {
        $$var = "Not defined";
    }
}
setdefined("email");
echo("Email: " . $email); // Provides an example output - in real life the output goes into an email. 
```

这个脚本不会抛出任何错误，而只是返回“Email:”，没有指定值。我认为这是我在函数中使用可变变量的方式的问题；以下代码按预期工作，但不太实用：

```
function setdefined(&$var)
{
    if (!$_POST[$var] == "")
    {
        $var = $_POST[$var];
    }
    else
    {
        $var = "Not defined";
    }
}
$email = "email"; // As the var parameter is passed by reference, the $email variable must be passed as the function argument
setdefined($email); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:40:33.360

你为什么不这样做：

```
function setdefined($var)
{
    if (isset($_POST[$var]) && !empty($_POST[$var]))
    {
        return $_POST[$var];
    }
    else
    {
        return "Not defined";
    }
}
$email = setdefined('email');
echo("Email: " . $email); 
```

您在第一个示例中创建的变量仅在函数内部可用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:44:07.310

您可以将可能是恶意用户提交的未知变量设为全局变量。为此，请将其添加到函数的开头：

```
global $$var ; 
```

这不仅丑陋，而且可能也不安全。

# cakephp-2.0 - CakePHP 2.3 添加新文件夹以加载模型不起作用

> ID：14162797
> 
> 赞同：2
> 
> 时间：2013-01-04T18:31:11.080
> 
> 标签：cakephp-2.0, cakephp-2.3

我在 bootstrap.php 中使用以下代码（如此[处](http://book.cakephp.org/2.0/en/core-utility-libraries/app.html#App%3a%3abuild)所述）也从另一个文件夹加载模型：

```
App::build(array('Model' => array('/my/path/to/models'))); 
```

这*似乎*有效。我在该文件夹中有一个模型*MyModel*，我将其包含在我想像往常一样使用它的控制器中：

```
var $uses = array('MyModel'); 
```

如果我打印**App::objects('Model')**，模型*MyModel*会显示在列表中，所以我假设它已正确加载。但是，当我尝试使用模型时（即**$this->MyModel->find()**它永远不会找到任何东西，它总是返回一个空数组。

请注意，如果我将相同的模型（*MyModel*）放在典型的模型文件夹（**app/Model/**）中，那么一切正常。

我缺少什么来完成这项工作？

**编辑**

**好的，所以当模型放在app**之外的那个文件夹中时，问题似乎出在与数据库的连接上。通过上面显示的代码，Cake 找到了模型。但是，当我执行**find()**时，我得到数据源的**缺失表**错误（在这种情况下为**默认值）。**

模型是否有可能没有加载正确的数据库配置，因为该配置位于**app/Config**文件夹中？如何使该模型加载该配置？如果我必须将该配置放在其他位置（可能在同一个*外部*文件夹中？）我可以这样做，但我如何告诉模型找到它？

**编辑 2**

我现在可以更好地看到问题所在。如果我将模型放在不同的文件夹中（除了**app/Model**）并使用**App::build()**设置新文件夹的路径，Cake 会找到它，毫无疑问（我使用**App::objects('Model ')**并且该模型与**app/Model**中的所有其他模型一起列出）。

然而，就好像 Cake 并没有真正阅读该模型类中的内容，或者至少不是所有内容。它似乎读取了**$useDbConfig**变量，但它忽略了**$useTable**和我在该模型中定义的任何函数。我的模型示例：

```
class Usuario extends AppModel {

var $name = 'Usuario';
var $primaryKey = 'id_usuario'; 
var $useDbConfig = 'BD_ControlAcceso';

function createTempPassword($len) {

    //some code
}
} 
```

如果我执行**$this->Usuario->find('all')**，它会正确返回所有记录。但是，如果我调用**$this->Usuario->createTempPassword(7)**我会得到一个**Database Error**。

我在同一个文件夹中有另一个模型（MyModel），带有**$useTable = 'mytable'**。如果我在其上执行**find()**，我会收到一条错误消息，指出**无法找到*****mytable***表。但是，如果我这样做**$this->MyModel->useTable = 'mytable'**那么它工作正常。

这怎么可能？这里发生了什么？

**编辑 3**

我只想补充一点，我已经进行了广泛的测试，问题很清楚：Cake“知道”模型在外部文件夹中（通过打印**App::objects('Model')**确认，模型在那里列出，如果我从该文件夹中删除它，则它不会列出）。但即使它知道它的存在，**它也会忽略模型文件中的任何内容**。我已经尝试了以下所有方法来加载模型，但都没有奏效。这是 CakePHP 中的错误吗？如果没有，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T02:54:53.797

您应该使用`App::uses('MyModel', 'Model')`并且应该在类声明之前使用，如下所示：

```
<?php

App::uses('MyModel', 'Model');
App::uses('AppController','Controller');
class UsersController extends AppController {
 // controller class
} 
```

另一件要尝试的事情是在需要的地方加载模型：

```
$this->loadModel('MyModel'); 
```

您可以尝试的另一件事是模型类顶部的模型实例化。尝试将您的模型更新为：

```
App::uses('AppModel','Model');
class Usuario extends AppModel {

var $name = 'Usuario';
var $primaryKey = 'id_usuario'; 
var $useDbConfig = 'BD_ControlAcceso';

function createTempPassword($len) {

    //some code
}
} 
```

# c - 生成数字的所有不同分区

> ID：14162798
> 
> 赞同：8
> 
> 时间：2013-01-04T18:31:11.260
> 
> 标签：c, algorithm, recursion, numbers, decomposition

我正在尝试编写一个 C 代码来生成具有给定数字的*不同*元素的所有可能的分区（分成 2 个或更多部分）。给定分区的所有数字的总和应该等于给定的数字。例如，对于 input `n = 6`，所有具有 2 个或更多具有不同元素的元素的可能分区是：

*   1、5
*   1、2、3
*   2、4

我认为递归方法应该可行，但我无法处理不同元素的附加约束。非常感谢 C/C++/Java 中的伪代码或示例代码。

谢谢！

**编辑：**如果它使事情变得更容易，我可以忽略具有至少 2 个元素的分区的限制。这将允许将数字本身添加到列表中（例如，6 本身将是一个微不足道但有效的分区）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:36:03.047

首先，编写一个递归算法来返回所有分区，包括那些包含重复的分区。

其次，编写一个算法来消除包含重复元素的分区。

编辑：

您可以通过避免对已经看到的数字进行递归调用来避免重复的结果。伪代码：

```
Partitions(n, alreadySeen)
 1\. if n = 0 then return {[]}
 2\. else then
 3\.    results = {}
 4\.    for i = 1 to n do
 5\.       if i in alreadySeen then continue
 6\.       else then
 7\.          subresults = Partitions(n - i, alreadySeen UNION {i})
 8\.          for subresult in subresults do
 9\.             results = results UNION {[i] APPEND subresult}
10\.    return results 
```

编辑：

您还可以避免多次生成相同的结果。通过修改循环的范围来做到这一点，这样您就只能以单调递增的方式添加新元素：

```
Partitions(n, mustBeGreaterThan)
1\. if n = 0 then return {[]}
2\. else then
3\.    results = {}
4\.    for i = (mustBeGreaterThan + 1) to n do
5\.       subresults = Partitions(n - i, i)
6\.       for subresult in subresults do
7\.          results = results UNION {[i] APPEND subresult}
8\.    return results 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:37:19.017

您尝试做的事情对我来说没有多大意义，但这就是我将如何处理它。

首先，我将创建一个`i`从 1 迭代到`n`- 1 的循环。在第一个循环中，您可以添加分区 1，即。然后我会使用 in 的值进行递归，`i`以获取所有也可以添加到 1 的子分区。

然后继续2，以此类推。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T20:53:51.313

你根本不需要递归。数字列表本质上是一个堆栈，并且通过按顺序迭代可以确保没有重复。

这是一个版本，它说明了我的意思（您标记了这个 C，所以我用 C 编写了它。在 C++ 中，您可以使用带有 push 和 pop 的动态容器，并对其进行大量整理）。

```
#include <stdio.h>
#include <stdlib.h>

void partition(int part)
{
int *parts;
int *ptr;
int i;
int idx = 0;
int tot = 0;
int cur = 1;
int max = 1;

    while((max * (max + 1)) / 2 <= part) max++;

    ptr = parts = malloc(sizeof(int) * max);

    for(;;) {
        if((tot += *ptr++ = cur++) < part) continue;

        if(tot == part) {
            for(i = 0 ; i < ptr-parts ; i++) {printf("%d ",parts[i]);}
            printf("\n");
        }

        do {
            if(ptr == parts) {free(parts); return;}
            tot -= cur = *--ptr;
        } while(++cur + tot > part);
    }
}

int main(int argc, char* argv[])
{
    partition(6);
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T19:00:09.277

我勾画了这个不应该产生重复的解决方案（它可以被美化和优化）：

```
void partitions(int target, int curr, int* array, int idx)
{
    if (curr + array[idx] == target)
    {
        for (int i=0; i <= idx; i++)
            cout << array[i] << " ";
        cout << endl;       
        return;
    }
    else if (curr + array[idx] > target)
    {
        return;
    }
    else
    {
        for(int i = array[idx]+1; i < target; i++)
        {
            array[idx+1] = i;
            partitions(target, curr + array[idx], array, idx+1);
        }
    }
}

int main(){
    int array[100];
    int N = 6;
    for(int i = 1; i < N; i++)
    {
        array[0] = i;
        partitions(N, 0, array, 0);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-12-30T01:29:06.927

这是另一种基于迭代算法的解决方案。它比@imreal 的算法快得多，也比@JasonD 的算法快一点。

计算 n = 100 所需的时间

```
$ time ./randy > /dev/null
./randy > /dev/null  0.39s user 0.00s system 99% cpu 0.393 total
$ time ./jasond > /dev/null
./jasond > /dev/null  0.43s user 0.00s system 99% cpu 0.438 total
$ time ./imreal > /dev/null
./imreal > /dev/null  3.28s user 0.13s system 99% cpu 3.435 total 
```

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int next_partition(int *a, int* kp) {
    int k = *kp;
    int i, t, b;

    if (k == 1) return 0;
    if (a[k - 1] - a[k - 2] > 2) {
        b = a[k - 2] + 1;
        a[k - 2] = b;
        t = a[k - 1] - 1;
        i = k - 1;
        while (t >= 2*b + 3) {
            b += 1;
            a[i] = b;
            t -= b;
            i += 1;
        }
        a[i] = t;
        k = i + 1;
    } else {
        a[k - 2] = a[k - 2] + a[k - 1];
        a[k - 1] = 0;
        k = k - 1;
    }
    *kp = k;
    return 1;
}

int main(int argc, char* argv[])
{
    int n = 100;
    int m = floor(0.5 * (sqrt(8*n + 1) - 1));
    int i, k;
    int *a;
    a = malloc(m * sizeof(int));
    k = m;
    for (i = 0; i < m - 1; i++) {
        a[i] = i + 1;
    }
    a[m - 1] = n - m*(m-1)/2;

    for (i = 0; i < k; i++) printf("%d ", a[i]);
    printf("\n");

    while (next_partition(a, &k)) {
        for (i = 0; i < k; i++) printf("%d ", a[i]);
        printf("\n");
    }
    free(a);
    return 0;
} 
```

# jquery - 无法进入图像地图区域

> ID：14162799
> 
> 赞同：0
> 
> 时间：2013-01-04T18:31:14.823
> 
> 标签：jquery, html, css, accessibility, imagemap

我想为此图像地图添加可访问性，因此除了（或代替）悬停之外，它们可以通过页面进行选项卡，并且区域形状将变得集中以显示文本。（我知道它现在正在使用鼠标悬停，我只是想先解决焦点问题）。

这是我尝试使用的示例：

```
<img src=img.png align='center' alt='some text' height='480px' width='1000px'
usemap='#imagemap'>

<map name = 'imagemap'>

<area shape='rect' style='position:relative' id=upperLeft coords='22,70,245,190'
tabIndex='0' alt='alt upper left text' onMouseOver=addUpperLeftText(this);></map>
<span id='upper_left'></span>

function addUpperLeftText(e){
    var upper_left_text = 'Upper left text';
    var cssObj = {
            'position': 'absolute',
            'width': '180px',
            'top': '155px',
            'left': '55px',
            'font-size': '18px',
            'line-height': '20px'
    };
    $('<p>').appendTo('#upper_left').text(upper_left_text).css(cssObj);
    e.onmouseover = null;
} 
```

我尝试添加 tabindex 和一个空的 href，但我对其他解决方案的搜索却很短。我只想在一个选项卡通过页面时使区域形状成为焦点。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T19:03:02.947

通过图像映射选项卡似乎对我来说很好：

```
<a href="#">Clickable element</a><br />
<img src="http://engagetolearn.com/ETL/virtualzoo/map.gif" usemap="#my-map" />
<map name="my-map">
    <area shape="rect" coords="0,0,100,100" href="#" />
    <area shape="rect" coords="100,0,200,100" href="#" />
</map> 
```

[http://jsfiddle.net/kboucher/YUvZU/](http://jsfiddle.net/kboucher/YUvZU/)

（确保在切换之前将焦点放在 jsFiddle 输出窗口上。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:57:36.313

你可以用绝对定位的锚元素做到这一点，甚至不需要 jQuery

[演示 jsfiddle](http://jsfiddle.net/j8S97/2/)

```
<div class="imgContainer">
    <img src="//placehold.it/1000x480" align="center" alt="some text" height="480" width="1000" />
    <a id="hotspot1" href="javascript:void(0)"></a>
    <a id="hotspot2" href="javascript:void(0)"></a>
    <a id="hotspot3" href="javascript:void(0)"></a>
</div> 
```

```
.imgContainer {
    position:relative;
    width:1000px;
    height:480px;
}

.imgContainer a {
    position:absolute;
    width:100px;
    height:100px;
    border:1px solid #eee;
}

.imgContainer a:focus, .imgContainer a:hover {
    background:rgba(255, 0, 0, .5);
}

#hotspot1 {
    top:20px;
    left:77px;
}

#hotspot2 {
    top:180px;
    left:320px;
}

#hotspot3 {
    top:200px;
    left:177px;
} 
```

# linux - urxvt 键盘选择仅适用于每个工作区的第一个实例

> ID：14162804
> 
> 赞同：3
> 
> 时间：2013-01-04T18:31:25.930
> 
> 标签：linux, terminal, x11

我目前正在使用 XMonad 和 urxvt（准确地说是 urxvtd+urxvtc）和键盘选择扩展（[urxvt-perls](https://github.com/muennich/urxvt-perls)）。

我观察到的是，键盘选择扩展仅被加载（或激活，不确定）为`XMonad`. 我已经尝试过了，`i3`那里的行为甚至更奇怪 - 它在某些实例中随机工作，即使对于启动新 urxvt 实例时它一直在工作的那些实例，它也会停止工作。

我不确定扩展程序是否没有被加载或者只是热键没有生效。而且我不确定如何找出它也是。

我已经尝试过使用 urxvt（与 urxvtd/urxvtc 组合相反），但它没有任何区别。

这是我的 urxvt 设置（通过from放置`.Xresources`和加载）：`xrdb ~/.Xresources``.xinitrc`

```
URxvt*.perl-ext-common: default,tabbed,keyboard-select,url-select
URxvt*.keysym.M-Escape: perl:keyboard-select:activate
URxvt*.keysym.M-s: perl:keyboard-select:search
URxvt*.url-select.launcher: firefox
URxvt*.keysym.M-u: perl:url-select:select_next

Xft.antialias: true
Xft.hinting: true
Xft.hintstyle: hintlight
Xft.rgba: rgb
URxvt.font: xft:DejaVu Sans Mono-8
URxvt.letterSpace: -1

Rxvt*.background: #111111
Rxvt*.foreground: #999999 
```

# iphone - 在 Objective-C 中无延迟播放音效

> ID：14162805
> 
> 赞同：8
> 
> 时间：2013-01-04T18:31:28.017
> 
> 标签：iphone, objective-c, ios, audio, ios6

当人们在我的应用程序中按下某些按钮时，我想播放一些简单的声音效果，我已经尝试了几件事，但我总是得到一个延迟，使声音看起来不同步。

我已经按照[这里](http://gregheo.com/blog/ios/simple-audio/)的教程进行操作，所以我尝试了音频服务中的构建，但它有延迟，我尝试了 AVAudioPlayer，但它也有延迟，即使我使用了“prepareToPlay”。

我真的必须安装一个像[Finch](https://github.com/zoul/Finch)这样的大而杂乱的库才能在我的简单应用程序中获得没有延迟的简单音效吗？

希望你能为我澄清事情！

更新

音频服务代码：

```
NSURL *soundURL = [[NSBundle mainBundle] URLForResource:@"PlopsX4"
                                      withExtension:@"aif"];
AudioServicesCreateSystemSoundID((CFURLRef)soundURL, &sound1);
AudioServicesPlaySystemSound(sound1); 
```

viewDidLoad 中 AVAudioPlayer 的代码：

```
NSURL *soundURL = [[NSBundle mainBundle] URLForResource:@"PlopsX4"
                                      withExtension:@"aif"];
self.avSound = [[AVAudioPlayer alloc] 
       initWithContentsOfURL:soundURL error:nil];
[self.avSound prepareToPlay] 
```

我要播放文件的方法中的 AVAudioPlayer 代码：

```
[self.avSound play]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:53:58.887

我得到这个工作的方式（我想我从另一篇关于 SO 的帖子中得到了这个想法）是创建一个空的 1 秒 .wav 文件并在初始化时“播放”它。之后，当我调用其他音效时，没有任何延迟。

我的声音播放器对象中有这样的东西

```
 SystemSoundID blID;
    SystemSoundID cID;

    +(void)doInit
    {
            if (spinitialized){
                    AudioServicesPlaySystemSound (blID);
                    return;
            }

            NSString *str = [[NSBundle mainBundle] pathForResource:@"ding.wav" ofType:@""];
            NSURL *uref = [NSURL fileURLWithPath:str];
            OSStatus error = AudioServicesCreateSystemSoundID ((CFURLRef)uref, &cID);
            if (error) NSLog(@"SoundPlayer doInit Error is %ld",error);

            str = [[NSBundle mainBundle] pathForResource:@"blank.wav" ofType:@""];
            uref = [NSURL fileURLWithPath:str];
            error = AudioServicesCreateSystemSoundID ((CFURLRef)uref, &blID);
            if (error) NSLog(@"SoundPlayer doInit Error is %ld",error);

            AudioServicesPlaySystemSound (blID);

            spinitialized = YES;
    } 
```

然后我可以毫不拖延地使用以下方法播放“叮当”：

```
 AudioServicesPlaySystemSound (cid); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T19:15:51.670

**解决方案**

我最终做了类似于上面迈克的事情。我最终在 viewDidLoad 中降低音量播放声音：

```
NSURL *soundURL = [[NSBundle mainBundle] URLForResource:@"PlopsX4"
                                              withExtension:@"aif"];
self.plops = [[AVAudioPlayer alloc] initWithContentsOfURL:soundURL error:nil];
[self.plops setVolume:0.0];
[self.plops play]; 
```

然后在我播放它的功能中，我这样做：

```
[self.plops setVolume:1.0];
[self.plops play]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T19:02:15.807

我发现似乎有帮助的一件事是，在进入可能播放声音的屏幕时，播放声音的一小部分。这似乎“启动”了声音机制——分配内部对象、分页等。

（我观察到这类似于 Mike M 的方法。）

# mysql - 带有 EF5 CodeFirst 迁移的 MySql：更改表列名称时出错（Fluent API）

> ID：14162812
> 
> 赞同：4
> 
> 时间：2013-01-04T18:32:14.660
> 
> 标签：mysql, ef-code-first, entity-framework-5

我将 EF5 CodeFirst 与 MySql DB 一起使用。

我有一个班级'用户'

```
public class User
{
    [Key]
    public string Username { get; set; }
    public string DisplayName { get; set; }
} 
```

我想将表列**DisplayName**更改为**display_name**。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<User>()
            .Property(u => u.DisplayName)
            .HasColumnName("display_name");
    } 
```

然后我执行`Add-Migration ChangeDisplayName`and`Update-Database -Verbose`并得到一个错误。

```
Using StartUp project 'CodeFirstNewDatabaseSample'.
Using NuGet project 'CodeFirstNewDatabaseSample'.
Specify the '-Verbose' flag to view the SQL statements being applied to the target database.
Target database is: 'CodeFirstNewDatabaseSample' (DataSource: localhost, Provider: MySql.Data.MySqlClient, Origin: Configuration).
Applying code-based migrations: [201301041748445_ChangeDisplayName].
Applying code-based migration: 201301041748445_ChangeDisplayName.
set @columnType := (select case lower(IS_NULLABLE) when `no` then CONCAT(column_type, ` ` , `not null `)  when `yes` then column_type end from information_schema.columns where table_name = `Users` and column_name = `DisplayName` );
set @sqlstmt := (select concat(`alter table Users change `DisplayName` display_name` , @columnType));
prepare stmt @sqlstmt;
execute stmt;
deallocate prepare stmt
MySql.Data.MySqlClient.MySqlException (0x80004005): Unknown column 'no' in 'field list'
   at MySql.Data.MySqlClient.MySqlStream.ReadPacket()
   at MySql.Data.MySqlClient.NativeDriver.GetResult(Int32& affectedRow, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.GetResult(Int32 statementId, Int32& affectedRows, Int64& insertedId)
   at MySql.Data.MySqlClient.Driver.NextResult(Int32 statementId, Boolean force)
   at MySql.Data.MySqlClient.MySqlDataReader.NextResult()
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteReader(CommandBehavior behavior)
   at MySql.Data.MySqlClient.MySqlCommand.ExecuteNonQuery()
   at System.Data.Entity.Migrations.DbMigrator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
   at System.Data.Entity.Migrations.DbMigrator.ExecuteStatements(IEnumerable`1 migrationStatements)
   at System.Data.Entity.Migrations.Infrastructure.MigratorBase.ExecuteStatements(IEnumerable`1 migrationStatements)
   at System.Data.Entity.Migrations.DbMigrator.ExecuteOperations(String migrationId, XDocument targetModel, IEnumerable`1 operations, Boolean downgrading, Boolean auto)
   at System.Data.Entity.Migrations.DbMigrator.ApplyMigration(DbMigration migration, DbMigration lastMigration)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ApplyMigration(DbMigration migration, DbMigration lastMigration)
   at System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
   at System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration)
   at System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update(String targetMigration)
   at System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.RunCore()
   at System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.Run()
Unknown column 'no' in 'field list' 
```

我认为错误会在这里->

```
set @columnType := (select case lower(IS_NULLABLE) when `no` then CONCAT(column_type, ` ` , `not null `)  when `yes` then column_type end from information_schema.columns where table_name = `Users` and column_name = `DisplayName` ); 
```

**`no`**是错误。

请帮我纠正这个错误。

# php - __deconstruct 不写会话变量

> ID：14162818
> 
> 赞同：-1
> 
> 时间：2013-01-04T18:32:31.920
> 
> 标签：php, yii, destructor

我有一个包含此功能的购物车库。从[文档](http://php.net/manual/en/language.oop5.decon.php)中可以看出：`PHP 5 introduces a destructor concept similar to that of other object-oriented languages, such as C++. The destructor method will be called as soon as there are no other references to a particular object, or in any order during the shutdown sequence.`

我不确定为什么从来没有调用过它。任何人都可以对此有所了解吗？

```
public function __deconstruct () {
    Yii::app()->session->add('cart', $this->order);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:34:08.937

这`__destruct`不是`__deconstruct`

[http://php.net/manual/en/language.oop5.decon.php](http://php.net/manual/en/language.oop5.decon.php)

# android - Admob SMART_BANNER 大小

> ID：14162819
> 
> 赞同：6
> 
> 时间：2013-01-04T18:32:31.430
> 
> 标签：android, admob

AdSize 类具有获取广告尺寸的 getWidthInPixels() 和 getHeightInPixels() 方法。虽然，它们对 BANNER 工作正常，但它们不工作 SMART_BANNER。他们总是返回-2。

您能否建议我在运行时获取 AdView 大小的方法？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-07T22:11:23.453

如果您使用的是 Google Play 服务库，您可以简单地使用：

```
int widthPixels = AdSize.SMART_BANNER.getWidthInPixels(this);
int heightPixels = AdSize.SMART_BANNER.getHeightInPixels(this); 
```

* * *

在旧的独立 Android AdMob SDK 中，您必须采用 hacky 方式：

*免责声明：这是创建 AdSize 的错误方法。**不要将此 AdSize 传递给 AdView 构造函数！***

希望智能横幅的实现将在未来的版本中得到修复，这样您就不必做这个骇人听闻的解决方法。但这里是如何做到的：

```
// This testSize should not be passed to the AdView constructor.
// Always pass AdSize.SMART_BANNER instead.
AdSize testSize = AdSize.createAdSize(AdSize.SMART_BANNER, this);
int widthPixels = testSize.getWidthInPixels(this);
int heightPixels = testSize.getHeightInPixels(this);
// testSize should not be referenced past this point. 
```

# jquery - JSON“POST”到烧瓶视图不起作用

> ID：14162821
> 
> 赞同：20
> 
> 时间：2013-01-04T18:32:38.613
> 
> 标签：jquery, python, json, post, flask

我想通过 POST 向我的 Flask View 发送一些 JSON。

这是我的代码

js：

```
$.post('/blog/add/ajax',
  { "title": "hallo", "article": "test" },
  function(data) {
    console.log(data.title);
    console.log(data.article);
  },
  "json"
); 
```

py:

```
@app.route('/blog/add/ajax', methods=['POST', 'GET'])
def add_blog_ajax():
    if request.method == 'POST':
        title = request.json['title']
        article = request.json['article']
        blog = Blog(title, article)
        db.session.add(blog)
        db.session.commit()
        return jsonify(title=title, article=article) 
```

错误：

```
TypeError: 'NoneType' object has no attribute '__getitem__' 
```

我不知道该怎么做，这里出了什么问题。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-04T18:57:18.833

好的，我有一个解决方案：

```
$.ajax({
  type: "POST",
  contentType: "application/json; charset=utf-8",
  url: "/blog/add/ajax",
  data: JSON.stringify({title: 'hallo', article: 'test'}),
  success: function (data) {
    console.log(data.title);
    console.log(data.article);
  },
  dataType: "json"
}); 
```

这对我有用！

# mysql - 如何在MySQL中逐行显示记录字符串

> ID：14162822
> 
> 赞同：1
> 
> 时间：2013-01-04T18:32:40.527
> 
> 标签：mysql, sql, select, count

当我执行我的选择查询时，我得到如下结果：

注意：我对 EmpId 和 Absent_dates 列使用 Group_ConCat() 函数，因为这些列在我的 Select Query 中从其他表返回多个值

我的查询：

```
SELECT Group_Concat(tp.EMPCODE), tp.DEPARTMENT, Group_Concat(d.dte) Absentddate, COUNT(tp.EMPCODE) Totalnoofabsentdates
FROM test_prefixmaster tp
JOIN daterange30 d
LEFT JOIN test_prefixtransactions tpt ON (tp.EMPCODE = tpt.empcode) AND DATE(S_DateTime) = d.dte
WHERE tpt.empcode IS NULL
GROUP BY tp.EMPCODE; 
```

执行我的查询后，结果如下：

```
 EmpId                 Absent_dates                   Total_no_of_Absent_days
    1101                  2012-12-02                            1
    1102,1102          2012-12-02,2012-12-03                    2
    1104,1104,1104     2012-12-02,2012-12-03,2012-12-04         3 
```

但我的实际要求是显示如下结果：

```
EmpId        Absent_dates            Total_no_of_Absent_days
1101          2012-12-02                     1
1102          2012-12-02
1102          2012-12-03                     2
1104          2012-12-02
1104          2012-12-03
1104          2012-12-04                     3 
```

任何人都可以在 MySQL 中使用什么功能吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:43:21.240

尝试这个

```
 SELECT tp.EMPCODE, tp.DEPARTMENT, d.dte Absentddate, COUNT(tp.EMPCODE) Totalnoofabsentdates
   FROM test_prefixmaster tp
   JOIN daterange30 d
  LEFT JOIN test_prefixtransactions tpt ON (tp.EMPCODE = tpt.empcode) AND DATE(S_DateTime) = d.dte
    WHERE tpt.empcode IS NULL
  ORDER BY tp.EMPCODE; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T10:29:33.740

尝试这个：

```
SELECT tp.EMPCODE, tp.DEPARTMENT, d.dte, IFNULL(A.Totalnoofabsentdates , '') Totalnoofabsentdates
FROM test_prefixmaster tp 
JOIN daterange d
LEFT JOIN test_prefixtransactions tpt ON (tp.EMPCODE = tpt.empcode) AND DATE(S_DateTime) = d.dte
LEFT JOIN ( SELECT tp.EMPCODE, d.dte Absentddate, COUNT(tp.EMPCODE) Totalnoofabsentdates
            FROM test_prefixmaster tp
            JOIN daterange1 d
            LEFT JOIN test_prefixtransactions tpt ON (tp.EMPCODE = tpt.empcode) AND DATE(S_DateTime) = d.dte
            WHERE tpt.empcode IS NULL
            GROUP BY tp.EMPCODE) AS A ON tp.EMPCODE = A.EMPCODE AND d.dte = A.Absentddate; 
```

# r - 在ggplot中设置日期范围

> ID：14162829
> 
> 赞同：23
> 
> 时间：2013-01-04T18:33:16.177
> 
> 标签：r, date, ggplot2

我的数据框是 z：

```
library(ggplot2); library(scales)
z <-     structure(list(Month = structure(c(14975, 15095, 15156, 15187, 
15248), class = "Date"), Value = c(1, 1, 1, 6, 1)), .Names = c("Month", 
"Value"), row.names = c(NA, 5L), class = "data.frame")

ggplot(z, aes(Month, Value)) + 
    geom_bar(fill="orange",size=.3,  stat="identity", position="identity") +
    geom_smooth(data=z,aes(Month,Value,group=1), method="lm", size=2, color="navyblue") + 
    scale_x_date(breaks = "1 month", labels=date_format("%b-%Y")) 
```

这工作正常，但我真的很喜欢我的数据范围在 2011 年 1 月 1 日到 2013 年 1 月 1 日之间。我的示例日期是从 1/12011 到 10/1/2011。有没有一种简单的方法可以在 ggplot 中强制将日期范围从 2011 年 1 月 1 日到 2013 年 1 月 1 日？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-01-04T18:43:06.553

的文档`?scale_x_date`提到它接受所有“典型的”连续比例参数，包括`limits`：

```
library(scales)
ggplot(z, aes(Month, Value)) + 
    geom_bar(fill="orange",size=.3,  stat="identity", position="identity") + 
    geom_smooth(data=z,aes(Month,Value,group=1), method="lm", size=2, color="navyblue") + 
    scale_x_date(date_breaks = "1 month", 
                 labels=date_format("%b-%Y"),
                 limits = as.Date(c('2011-01-01','2013-01-01'))) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-04T18:45:47.753

请注意，除了“ggplot2”之外，您还加载了`scales`包，这将是对 SO 用户的礼貌。有一个`ggplot2::xlim`功能，所以这有效：

```
 ...... + xlim(as.Date(c('1/1/2011', '1/1/2013'), format="%d/%m/%Y") ) 
```

更新：刚刚因为无法解释的原因投了反对票。原始问题中的代码不再有效，但如果您只用上面的 xlim() 调用替换 scale_x_date(.) 调用，则不会出现错误。

```
ggplot(z, aes(Month, Value)) + 
     geom_bar(fill="orange",size=.3,  stat="identity", position="identity") +
     geom_smooth(data=z,aes(Month,Value,group=1), method="lm", size=2, color="navyblue") + 
     xlim(as.Date(c('1/1/2011', '1/1/2013'), format="%d/%m/%Y") ) 
```

[![在此处输入图像描述](../Images/1c3506579bb545914d0825855d73453d.png)](https://i.stack.imgur.com/RKGUd.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-12T19:30:16.563

这是使用 ggplot 3.1 的解决方案，它需要对原始代码进行最少的调整：

```
ggplot(z, aes(Month, Value)) + 
    geom_bar(fill="orange",size=.3, stat="identity", position="identity") +
    geom_smooth(data=z,aes(Month,Value,group=1), method="lm", size=2, color="navyblue") + 
    scale_x_date(date_breaks = "1 month", 
           limits = as.Date(c('1/1/2011', '1/1/2013'), format="%d/%m/%Y"),
           date_labels="%b-%Y" ) +
    theme(axis.text.x = element_text(angle = 90)) 
```

最后`theme()`的 the 是可选的，但如果您想使用原始`"%b-%Y"`格式字符串，则格式更易于阅读。

# objective-c - 在动画帧更改后使用变换缩放 UIView 会导致 UIView 在缩放之前跳回原始帧

> ID：14162831
> 
> 赞同：0
> 
> 时间：2013-01-04T18:33:22.567
> 
> 标签：objective-c, ios, uiviewanimation, cgaffinetransform

我正在尝试在移动 UIView（带动画）后缩放它（带动画）。问题是，当缩放动画开始时，它会跳回原始位置。为什么？

```
[UIView animateWithDuration:t delay:0 options:UIViewAnimationOptionCurveEaseIn animations:^{
    // Drop the ball

    CGRect frame = coinView.frame;
    frame.origin.y += d;

    coinView.frame = frame;

    coinView.shouldSparkle = NO;
} completion:^(BOOL finished) {
    [UIView animateWithDuration:0.3 animations:^{
        // Initial scale up for ball "poof"

        coinView.transform = CGAffineTransformScale(coinView.transform, 1.5, 1.5);
    } completion:^(BOOL finished) {
        [UIView animateWithDuration:0.3 animations:^{
            coinView.transform = CGAffineTransformScale(coinView.transform, 0.000001, 0.000001);
        } completion:^(BOOL finished) {
            [coinView removeFromSuperview];
        }];
    }];
}]; 
```

编辑：这就是我生成 d 的方式：

```
static CGFloat groundPositionY = 325;

CGRect convertedFrame = [coinView.superview convertRect:coinView.frame toView:self.view];

CGFloat d = groundPositionY - CGRectGetMaxY(convertedFrame); 
```

EDIT2：好的，所以我将第二个 UIView 动画更改为以下内容，我发现跳转（和*缩小*）发生在第二个动画发生之前，即调用 animateWithDuration:delay:options:animations:completion: 时。

```
[UIView animateWithDuration:5 delay:3 options:0 animations:^{
    coinView.transform = CGAffineTransformScale(coinView.transform, 1.5, 1.5);
} completion:nil]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:59:26.073

我测试了你的代码，它对我来说很好。你如何生成你的d？它到底回到了哪个街区？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T21:13:10.097

我发现了问题...

coinView 是子视图控制器视图的子视图。问题来自这样一个事实，即我覆盖了子视图控制器的`viewDidLayoutSubviews`方法来布置所有的`coinView`'，因此每当调用该方法时，硬币视图都会移回子视图控制器预期的原始位置和大小。

感谢您的所有帮助，repoguy 和塞尔吉奥！！

# java - DELETE FROM where ID = '用户插入的文本'？

> ID：14162835
> 
> 赞同：1
> 
> 时间：2013-01-04T18:33:40.180
> 
> 标签：java, mysql, sql

我想删除 id = 用户在 Java 中将文本插入 jTextField 的 MySQL 行。我知道我需要使用类似`txtGebruikersID.getText();`但不确定如何正确组合它们的东西，以便当有人在 JTextField (txtGebruikersID) 中插入 25 时，25 的值会转到 25 所在的位置：

```
query = "delete from gebruiker where gebruiker_ID = 25"; 
```

我在 QueryManager.java 中使用的代码：

```
public void removeGebruiker() {
        String query;
        query = "delete from gebruiker where gebruiker_ID = 25";
        dbmanager.insertQuery(query);
    } 
```

JTextField 被称为**txtGebruikersID**

我在 userPanel.java 中使用的代码：

```
private void removeUserActionPerformed(java.awt.event.ActionEvent evt) {

        WinkelApplication.getInstance().getQueryManager().removeGebruiker();
        JOptionPane.showMessageDialog(null, "Gebruiker is verwijderd", "Gebruiker", JOptionPane.INFORMATION_MESSAGE);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:39:46.380

将函数编辑为如下内容：

```
public void removeGebruiker(String gebruiker_id) {
    //Some checks here perhaps
    String query;
    query = "delete from gebruiker where gebruiker_ID = " + gebruiker_id;
    dbmanager.insertQuery(query);
} 
```

假设你有一个面板，

```
WinkelApplication.getInstance().getQueryManager().removeGebruiker(TEXTFIELDNAMEHERE.getText()); 
```

如果用户将 12 放入文本字​​段，则结果查询将是：

```
delete from gebruiker where gebruiker_ID = 12 
```

然而，有更好的方法来做到这一点。准备好的语句确实更好。如果您确实使用此方法，请确保检查用户的输入。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T18:44:19.570

你应该做这样的事情。这是使用 sqls 的更优选方式

```
query = "delete from gebruiker where gebruiker_ID = ?";
PreparedStatement st = con.prepareStatement(query); // con is active connection
st.setInt(1,Integer.parseInt(txtGebruikersID.getText())); 
```

[什么是 SQL 注入”](http://en.wikipedia.org/wiki/SQL_injection)

# windows - Windows批处理中的通配符（星号）

> ID：14162837
> 
> 赞同：5
> 
> 时间：2013-01-04T18:33:43.813
> 
> 标签：windows, cmd, wildcard

我的 Windows 脚本（.cmd 文件）中有这个命令：

`CALL mv *.exe foo.exe`

通配符似乎根本不会被解释为通配符，因为在执行脚本时，它会抛出一个关于找不到具有名称的文件`*.exe`（字面意思是 *.exe）的错误。**顺便说一下，当前目录中**有一个 .exe 文件。

那么我应该如何重写这个命令呢？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:38:49.847

如果`mv`有的话，也许你有`sh.exe`或`bash.exe`附近有。然后很简单：

```
sh.exe -c "mv *.exe foo.exe" 
```

与 unix shell 不同，CMD 解释器不会扩展通配符：命令自己执行（或不执行）它。也许内置`ren`命令会扩展通配符，但我不确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:52:10.720

在 Windows 中，除非调用另一个批处理脚本，否则您不需要使用“调用”。您可能还想改用“移动”命令；这将在 Windows 中正确插入 *。

例如，如果您使用的脚本具有：

```
move *.exe foo.exe 
```

在其中，您会得到如下结果：

```
C:\dev\example>dir /B
a.exe
mymove.cmd

C:\dev\example>mymove

C:\dev\example>move *.exe foo.exe
C:\dev\example\a.exe
        1 file(s) moved.

C:\dev\example>dir /B
foo.exe
mymove.cmd

C:\dev\example> 
```

准确给出您正在寻找的行为！

# python - python相当于php natcasesort

> ID：14162838
> 
> 赞同：3
> 
> 时间：2013-01-04T18:33:44.173
> 
> 标签：python, sorting

> **可能重复：**
> [Python 是否具有用于字符串自然排序的内置函数？](https://stackoverflow.com/questions/4836710/does-python-have-a-built-in-function-for-string-natural-sort)

python中是否有相当于php的natcasesort()的函数？

[http://php.net/manual/en/function.natcasesort.php](http://php.net/manual/en/function.natcasesort.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:37:51.097

```
import re

def atoi(text):
    return int(text) if text.isdigit() else text.lower()

def natural_keys(text):
    '''
    alist.sort(key=natural_keys) sorts in human order
    http://nedbatchelder.com/blog/200712/human_sorting.html
    (See Toothy's implementation in the comments)
    '''    
    return [ atoi(c) for c in re.split('(\d+)', text) ]

names = ('IMG0.png', 'img12.png', 'img10.png', 'img2.png', 'img1.png', 'IMG3.png') 
```

标准排序：

```
print(sorted(names))
# ['IMG0.png', 'IMG3.png', 'img1.png', 'img10.png', 'img12.png', 'img2.png'] 
```

自然顺序排序（不区分大小写）：

```
print(sorted(names, key = natural_keys))
# ['IMG0.png', 'img1.png', 'img2.png', 'IMG3.png', 'img10.png', 'img12.png'] 
```

# c# - 如何将文本从动态生成的用户控件传输到文本框

> ID：14162839
> 
> 赞同：2
> 
> 时间：2013-01-04T18:33:59.320
> 
> 标签：c#

我有一个 Windows 窗体，其中有一个`button1`，当单击它时，`UserControl`动态添加到代码中的是：

```
 int c = 0;
    private void button1_Click(object sender, EventArgs e)
    {
        int v;
        v = c++;
        panel1.VerticalScroll.Value = VerticalScroll.Minimum;
        UserControl1 us = new UserControl1();
        us.Name = "us" + v;
        us.Location = new Point(50, 5 + (30 * v));
        us.Tag = btn;
        panel1.Controls.Add(us);
     } 
```

包含 4 个控件、`UserControl`2 个组合框和 2 个文本框

即`combobox1`,和`combobox2`_`textbox1``textbox2`

有 4 个文本框在同一个表单上

`still-textbox1`, `still-textbox2`,`still-textbox3`和`still-textbox4`

有`button2`，它会将文本传输到组合框和文本框，它们是`oldcombobox1`、和`oldcombobox2``oldtextbox1``oldtextbox2`

单击两次时`button1`，它将`UserControls`向表单添加两个。我想以以下格式传输文本

`oldcombobox1.text = still-textbox1.text + "," + combobox1.text(which is dynamically generated) + "," + combobox1.text (which is dynamically generated)`等`combobox1`来自 UserControl 的所有文本（动态添加）

`oldcombobox2.text = still-textbox2.text + "," + combobox2.text (which is dynamically generated) + "," + combobox2.text (which is dynamically generated)`等`combobox2`来自 UserControl 的所有文本（动态添加）

`oldtextbox1.text = still-textbox3 + "," + textboox1.text (which is dynamically generated) + "," + textbox1.text (which is dynamically generated)`等所有`textbox1`文本`UserControl`（动态添加）

意味着当`still-textbox1.text = first` 和当动态`UserControl`添加三次时它将包含3次`combobox1`然后`oldcombobox1`应该包含：

`first`, `combobox1.text`, `combobox1.text`,`combobox1.text`

我已经制作了这段代码，但它不起作用

```
 foreach (Control ctrl in panel1.Controls)
   {
     if (ctrl is UserControl)
     {
         UserControl1 myCrl = ctrl as UserControl1;
         oldcombobox1.text = still-textbox1.text + "," + myCrl.comboBox1.Text;
         oldcombobox2.Text =still-textbox2.text + "," + myCrl.comboBox2.Text;
         oldtextbox1.Text = still-textbox3.text + "," + myCrl.textBox1.Text;
         oldtextbox2.Text.Text = still-textbox4.text + "," + myCrl.textBox2.Text;
      }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:49:23.897

您应该`UserControl1`为您想要从另一个对象访问的每个字符串添加类似这样的内容（btw ;-) ），在这种情况下是字符串`textBox1`：

```
public String FirstTextBoxText 
{
   get { return this.textBox1.Text; }
} 
```

然后你可以在你的 Form 类中说：

```
 if (ctrl is UserControl)
 {
     UserControl1 myCrl = ctrl as UserControl1;
     // ...
     oldtextbox1.Text = still-textbox3.text + "," + myCrl.FirstTextBoxText;
 } 
```

它仍然是可怕的代码，但它会起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:46:19.083

我会用事件来做到这一点。

创建一个继承自EventArgs的类：（我更喜欢VB，可以翻译）

```
Public Class ControlEventArgs
  Inherits EventArgs

  Public Property Value1 As String = String.Empty
  Public Property Value2 As String = String.Empty
  Public Property Value3 As String = String.Empty
  Public Property Value4 As String = String.Empty

End Class 
```

然后在您的控件中添加事件：

```
Public Event ValueSubmittal As EventHandler(Of ControlEventArgs) 
```

在您的 Button2_Click 处理程序中：

```
RaiseEvent ValueSubmittal(me, new ControlEventArgs With {.Value1=comboBox1.Text, .Value2 = comboBox2.Text, .Value3 = textBox1.Text, .Value4 = textBox2.Text} 
```

在您动态创建控件的表单中，您需要连接事件处理程序：

```
AddHandler myNewControl.ValueSubmittal, AddressOf ValueSubmittalHandler 
```

和 ValueSubmittalHandler：

```
Private Sub ValueSubmittalHandler(sender as Object, e As ControlEventArgs)
  formControl1.Text = e.Value1
  formControl2.Text = e.Value2
  '  etc...
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:49:07.857

您可以创建一个类级别的变量：

```
 private UserControl1 us1;
    private UserControl1 us2;

    private void button1_Click(object sender, EventArgs e)
    {
        int v;
        v = c++;
        panel1.VerticalScroll.Value = VerticalScroll.Minimum;

        if(us == null) 
        {
            //this is the first time the control is created
            us1 = new UserControl1();
            us1.Name = "us" + v;
            us1.Location = new Point(50, 5 + (30 * v));
            us1.Tag = btn;        
            panel1.Controls.Add(us1);
        }
        else if(us2 ==null)
        {
            us2 = new UserControl1();
            //whatever code you want to execute to change second one
            //you can access first control as us1.xxx
            panel1.Controls.Add(us2);

        }
        else
        {
           //3rd 4th etc...
        }

     } 
```

# matlab - Matlab从具有多个空格分隔符的文件中导入数据

> ID：14162841
> 
> 赞同：1
> 
> 时间：2013-01-04T18:34:03.883
> 
> 标签：matlab, import, whitespace, delimiter

我必须从文本文件中导入一些数据才能在 Matlab 中使用它：

```
1947/02/28   79,1
1947/03/31   79,1
1947/04/30   80,2 
```

等等...

我的问题是：我不能将它导入一个 35x2 矩阵（35 只是一个随机数）或一个结构，该结构一方面包含一个 35x1 矩阵（字符串或日期时间），另一方面包含一个 35x1 矩阵（双)

我找不到像 textscan、importdata ... 这样的导入函数，它支持多个空格，否则它会尝试在“，”处拆分数据。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:21:15.407

假设`fid`是您的文件句柄。

```
r = struct('date', {}, 'value', {});
n_line = 0;
tline = fgets(fid);
while ischar(tline)
    tok = regexp(tline, '(\d+/\d+/\d+)\s+(\d+),(\d)', 'tokens');
    if ~isempty(tok)
        n_line = n_line + 1;
        r(n_line).date = datenum(tok{1}{1});
        r(n_line).value = 0.1 * str2double(tok{1}{3}) + str2double(tok{1}{2});
    end
    tline = fgets(fid);
end 
```

完成后不要忘记关闭`fid`。我假设您认为`80,2`它类似于德语符号`80.2`，但不确定这是否正确。

# java - 使用 android 保存按钮 id 的历史记录

> ID：14162844
> 
> 赞同：0
> 
> 时间：2013-01-04T18:34:20.650
> 
> 标签：java, android, button

我正在学习 android 编程，所以对我来说很酷。我的问题是，例如，我有 5 个按钮。用户单击 5 个按钮中的任何一个按钮并单击另一个按钮。那么如何跟踪以前单击的按钮 ID。所以第二个按钮单击输出基于上一个按钮。

谁能给我指点一下。我是java和android的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:27:49.843

我会建议您遵循（屏幕状态）基本方法；如下：

1.) 创建屏幕状态类并为每个状态分配一个唯一值。

2.) 你应该提到屏幕状态堆栈和当前屏幕状态。

3.) 当您按下按钮时，调用 OnstateChange() 函数。哪个应该确定下一个屏幕（基于当前屏幕以及用户是向前还是向后移动）。如果用户向后移动，则从堆栈中弹出屏幕并将其标记为当前屏幕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:16:46.807

如果您只需要记住您单击的最后一个按钮，请使用类成员变量来记住有关它的某些内容（按钮的 ID、或数字索引或其他内容）。您应该在按钮对应的 onClick() 调用中设置此成员变量。

如果您需要记住单击按钮的整个历史记录，请使用 List 实现（ArrayList 应该没问题）并在 onClick() 方法中添加（）有关按钮的信息（按钮的 ID，或数字索引等）对应按钮。

如果每个按钮都有不同的 OnClickHandler，这很简单。如果您共享一个 OnClickHandler，您将需要使用作为 onClick() 参数传入的视图的一些识别属性。

# mobile - 旋转到横向时，如何使 320 像素宽的移动站点缩放到全宽？

> ID：14162845
> 
> 赞同：0
> 
> 时间：2013-01-04T18:34:26.033
> 
> 标签：mobile, viewport

我一直在尝试多种视口组合，但似乎找不到合适的组合。

我有一个 320 像素宽的移动网站。我希望这些 320 像素能够在纵向和横向模式下拉伸屏幕的整个宽度，无论屏幕从哪个方向开始，或者查看者是否旋转设备。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:38:54.447

当您希望网站伸展时，使用固定像素值有什么意义？只需使用

```
width: 100% 
```

# mysql - MySQL查询优化，大表，使用临时文件排序

> ID：14162846
> 
> 赞同：0
> 
> 时间：2013-01-04T18:34:31.340
> 
> 标签：mysql, sql, performance, optimization

我需要您的帮助来优化查询。一个表是一个日志表，它有数百万个条目，我试图将我的查询打破到 < 1s。我的查询应该给出一个总体概述，因此应该很快。我确信我可以在脚本的帮助下对列表进行多个简单的查询。但是脚本可以做什么，我认为mysql可以做什么-至少我希望如此。也许并不是所有的部分都得到了最好的使用，但我被困在一个查询中，它产生了一个临时表和文件排序（我发现这真的很糟糕）。在阅读时，我发现使用了一些整洁且放置良好的索引，但现在我被困在一个特定的点上。

让我向您展示我的最终查询及其结果：

```
SELECT
    ps.SERVER_ID,
    ps.FULLNAME,
    SUM(CASE WHEN pml.ID_TYPE = 3 THEN 1 ELSE 0 END) 'amount_warning',
    SUM(CASE WHEN pml.ID_TYPE = 4 THEN 1 ELSE 0 END) 'amount_error',
    SUM(CASE WHEN pml.ID_TYPE = 5 THEN 1 ELSE 0 END) 'amount_alert',
    SUM(CASE WHEN pml.ID_TYPE = 7 THEN 1 ELSE 0 END) 'amount_critical'
FROM
    PAR_SERVER ps
INNER JOIN
    PAR_MONITORINGv2_LOG pml ON ps.SERVER_ID = pml.SERVER_ID
WHERE
    pml.CREATED_DATE > date_sub( NOW( ) , INTERVAL 7 DAY )
GROUP BY
    ps.SERVER_ID; 
```

这是我得到的：

```
mysql> [thequeryabove]
[...]
59 rows in set (11.69 sec)

mysql> explain [thequeryabove]
+----+-------------+-------+--------+-----------------------------+---------+---------+---------------------------+---------+----------------------------------------------+
| id | select_type | table | type   | possible_keys               | key     | key_len | ref                       | rows    | Extra                                        |
+----+-------------+-------+--------+-----------------------------+---------+---------+---------------------------+---------+----------------------------------------------+
|  1 | SIMPLE      | pml   | ALL    | SERVER_ID,SERVER_ID-ID_TYPE | NULL    | NULL    | NULL                      | 4014447 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | ps    | eq_ref | PRIMARY                     | PRIMARY | 4       | database.pml.SERVER_ID |       1 |                                              |
+----+-------------+-------+--------+-----------------------------+---------+---------+---------------------------+---------+----------------------------------------------+
2 rows in set (0.00 sec) 
```

这是我当前的表设置：

```
mysql> describe PAR_SERVER;
+----------------+--------------+------+-----+---------+----------------+
| Field          | Type         | Null | Key | Default | Extra          |
+----------------+--------------+------+-----+---------+----------------+
| SERVER_ID      | int(255)     | NO   | PRI | NULL    | auto_increment |
| FULLNAME       | varchar(255) | YES  |     | NULL    |                |
| SHORTNAME      | varchar(255) | YES  | MUL | NULL    |                |
+----------------+--------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)

mysql> show indexes from PAR_SERVER;
+------------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table      | Non_unique | Key_name  | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+------------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| PAR_SERVER |          0 | PRIMARY   |            1 | SERVER_ID   | A         |         142 |     NULL | NULL   |      | BTREE      |         |
| PAR_SERVER |          1 | shortname |            1 | SHORTNAME   | A         |         142 |     NULL | NULL   | YES  | BTREE      |         |
+------------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
2 rows in set (0.00 sec)

mysql> select count(*) from PAR_SERVER;
+----------+
| count(*) |
+----------+
|      142 |
+----------+
1 row in set (0.00 sec)

mysql> describe PAR_MONITORINGv2_LOG;
+--------------+----------+------+-----+---------+----------------+
| Field        | Type     | Null | Key | Default | Extra          |
+--------------+----------+------+-----+---------+----------------+
| ID           | int(11)  | NO   | PRI | NULL    | auto_increment |
| ID_TYPE      | int(11)  | NO   | MUL | NULL    |                |
| ID_SERVICE   | int(11)  | NO   | MUL | NULL    |                |
| SERVER_ID    | int(11)  | NO   | MUL | NULL    |                |
| MESSAGE      | tinytext | NO   |     | NULL    |                |
| CREATED_DATE | datetime | NO   |     | NULL    |                |
+--------------+----------+------+-----+---------+----------------+
6 rows in set (0.00 sec)

mysql> show indexes from PAR_MONITORINGv2_LOG;
+----------------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| Table                | Non_unique | Key_name          | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |
+----------------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
| PAR_MONITORINGv2_LOG |          0 | PRIMARY           |            1 | ID          | A         |     3998188 |     NULL | NULL   |      | BTREE      |         |
| PAR_MONITORINGv2_LOG |          1 | ID_TYPE           |            1 | ID_TYPE     | A         |           7 |     NULL | NULL   |      | BTREE      |         |
| PAR_MONITORINGv2_LOG |          1 | ID_SERVICE        |            1 | ID_SERVICE  | A         |           5 |     NULL | NULL   |      | BTREE      |         |
| PAR_MONITORINGv2_LOG |          1 | SERVER_ID         |            1 | SERVER_ID   | A         |          66 |     NULL | NULL   |      | BTREE      |         |
| PAR_MONITORINGv2_LOG |          1 | SERVER_ID-ID_TYPE |            1 | SERVER_ID   | A         |          66 |     NULL | NULL   |      | BTREE      |         |
| PAR_MONITORINGv2_LOG |          1 | SERVER_ID-ID_TYPE |            2 | ID_TYPE     | A         |         258 |     NULL | NULL   |      | BTREE      |         |
+----------------------+------------+-------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+
6 rows in set (0.00 sec)

mysql> select count(*) from PAR_MONITORINGv2_LOG;
+----------+
| count(*) |
+----------+
|  3998386 |
+----------+
1 row in set (0.00 sec) 
```

这是逐步分解我的查询的时间结果。在花了这么长时间修复每个部分之后，我可能会一步一步地走。但是目前只有运行时间为 2.30 秒的查询对这个问题感兴趣。

```
mysql> SELECT ps.SERVER_ID, ps.FULLNAME FROM PAR_SERVER ps INNER JOIN PAR_MONITORINGv2_LOG pml ON ps.SERVER_ID = pml.SERVER_ID WHERE pml.CREATED_DATE > date_sub( NOW( ) , INTERVAL 7 DAY ) GROUP BY ps.SERVER_ID;
[...]
59 rows in set (6.41 sec)

mysql> explain [thequeryabove]
+----+-------------+-------+--------+-----------------------------+---------+---------+---------------------------+---------+----------------------------------------------+
| id | select_type | table | type   | possible_keys               | key     | key_len | ref                       | rows    | Extra                                        |
+----+-------------+-------+--------+-----------------------------+---------+---------+---------------------------+---------+----------------------------------------------+
|  1 | SIMPLE      | pml   | ALL    | SERVER_ID,SERVER_ID-ID_TYPE | NULL    | NULL    | NULL                      | 4014788 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | ps    | eq_ref | PRIMARY                     | PRIMARY | 4       | database.pml.SERVER_ID |       1 |                                              |
+----+-------------+-------+--------+-----------------------------+---------+---------+---------------------------+---------+----------------------------------------------+
2 rows in set (0.00 sec)

mysql> SELECT ps.SERVER_ID, ps.FULLNAME FROM PAR_SERVER ps INNER JOIN PAR_MONITORINGv2_LOG pml ON ps.SERVER_ID = pml.SERVER_ID GROUP BY ps.SERVER_ID;
[...]
59 rows in set (2.30 sec)

mysql> explain [thequeryabove]
+----+-------------+-------+--------+-----------------------------+-----------+---------+---------------------------+---------+----------------------------------------------+
| id | select_type | table | type   | possible_keys               | key       | key_len | ref                       | rows    | Extra                                        |
+----+-------------+-------+--------+-----------------------------+-----------+---------+---------------------------+---------+----------------------------------------------+
|  1 | SIMPLE      | pml   | index  | SERVER_ID,SERVER_ID-ID_TYPE | SERVER_ID | 4       | NULL                      | 4015694 | Using index; Using temporary; Using filesort |
|  1 | SIMPLE      | ps    | eq_ref | PRIMARY                     | PRIMARY   | 4       | database.pml.SERVER_ID |       1 |                                              |
+----+-------------+-------+--------+-----------------------------+-----------+---------+---------------------------+---------+----------------------------------------------+
2 rows in set (0.00 sec)

mysql> SELECT pml.SERVER_ID FROM PAR_MONITORINGv2_LOG pml GROUP BY pml.SERVER_ID;
[...]
65 rows in set (0.00 sec)

mysql> explain [thequeryabove]
+----+-------------+-------+-------+---------------+-----------+---------+------+------+--------------------------+
| id | select_type | table | type  | possible_keys | key       | key_len | ref  | rows | Extra                    |
+----+-------------+-------+-------+---------------+-----------+---------+------+------+--------------------------+
|  1 | SIMPLE      | pml   | range | NULL          | SERVER_ID | 4       | NULL |   67 | Using index for group-by |
+----+-------------+-------+-------+---------------+-----------+---------+------+------+--------------------------+
1 row in set (0.00 sec) 
```

我可以通过为 (SERVER_ID, ID_TYPE) 定义一个索引来改进查询，正如我的以下示例查询所证实的那样：

```
mysql> SELECT count(*) 'count_warnings' FROM PAR_MONITORINGv2_LOG pml WHERE pml.SERVER_ID = 191 AND pml.ID_TYPE = 3 GROUP BY pml.SERVER_ID;
[...]
1 row in set (0.01 sec)

mysql> explain [thequeryabove]
+----+-------------+-------+------+-------------------------------------+-------------------+---------+-------------+-------+-------------+
| id | select_type | table | type | possible_keys                       | key               | key_len | ref         | rows  | Extra       |
+----+-------------+-------+------+-------------------------------------+-------------------+---------+-------------+-------+-------------+
|  1 | SIMPLE      | pml   | ref  | ID_TYPE,SERVER_ID,SERVER_ID-ID_TYPE | SERVER_ID-ID_TYPE | 8       | const,const | 10254 | Using index |
+----+-------------+-------+------+-------------------------------------+-------------------+---------+-------------+-------+-------------+
1 row in set (0.00 sec) 
```

我现在被困在最崩溃的查询中，执行时间长达 2.30 秒。我不知道如何为没有任何 where 子句的此类查询使用索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:42:10.593

在 PAR_MONITORINGv2_LOG(CREATED_DATE, SERVER_ID,ID_TYPE) 上添加复合索引肯定会让您的查询受益最大。但是，我建议即使是简单的索引`CREATED_DATE`也会大大提高性能。

# javascript - 简单的while问题（javascript）

> ID：14162850
> 
> 赞同：1
> 
> 时间：2013-01-04T18:34:53.210
> 
> 标签：javascript

任何人都可以解释为什么我不能停止并开始这个循环吗？

```
 <input type="button" value="start" onclick="start()">
 <input type="reset" value="stop" onClick="stop()">

var startLottery = false;

while(startLottery){
setInterval(function(){automateLottery()},120);
startLottery;
};

var start = function(){
startLottery = true;    
};

var stop = function(){
startLottery = false;   
}; 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:36:29.023

**问题 1**

只有当`while`操作数的计算结果为 时，才会执行循环`true`。

但是，您开始时`startLottery`变量等于`false`。

所以`while`循环永远不会执行。

**问题 2**

在任何时候你都没有真正改变`startLottery`变量的值，所以即使循环确实执行了，它也永远不会终止。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:39:47.300

您无法启动和停止这样的循环。您需要使用`setInterval`和`clearInterval`：

JS：

```
var lotteryInterval;

var start = function(){
    lotteryInterval = setInterval(lotteryFunc, 120);
};

var stop = function(){
    clearInterval(lotteryInterval);
};

var lotteryFunc = function () {
    automateLottery();
}; 
```

HTML：

```
<input type="button" value="start" onclick="start()">
<input type="reset" value="stop" onClick="stop()"> 
```

编辑：[工作演示](http://jsfiddle.net/3XwD8/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:40:17.847

我相信你正在寻找这个（假设你确实有一个`automateLottery`功能）：

```
var timer;

var start = function(){
    timer = setInterval(automateLottery, 120);
};

var stop = function(){
    clearInterval(timer);
};

start(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T22:54:51.430

如果您提供的代码与我看到的完全一样，`while`则永远不会进入循环。页面将被呈现（`input`s），然后变量`startLottery`将设置为`false`。接下来，循环将评估表达式（将始终返回`false`）并且永远不会真正进入循环。

# xml - 在 oracle 中解析 XML 数据

> ID：14162851
> 
> 赞同：1
> 
> 时间：2013-01-04T18:34:54.983
> 
> 标签：xml, oracle11g

我是 Oracle XML 领域的新手。我正在尝试解析 XML，但没有做到。

下面是 XML 数据。

* * *

```
<CompositeDataObject Type="ApplicantsAAT" Version="0">
<DataObjectElement SystemName="AccountRelationship" ObjectType="DataObjectCollection">
<CollectionItem ID="604008" EncryptedID="4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy" DataObjectCategory="RepeatingAttribute" DataObjectType="AccountRelationshipAAT"/>
<CollectionItem ID="604040" EncryptedID="4IrPkqeoo7EVLEuSm7egK96AAAAAB6r2zS" DataObjectCategory="RepeatingAttribute" DataObjectType="AccountRelationshipAAT"/>
</DataObjectElement>
<DataObjectElement SystemName="ApplicantCreditRefDetailsAATSL" ObjectType="DataObject" ID="603979" EncryptedID="4PPEFaEyt2Q!K48f13wy7gzAAAAAB6r2wR" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantCreditRefDetailsAATSL"/><DataObjectElement SystemName="CreditCardsTPF" ObjectType="DataObjectCollection"/><CompositeDataObjectElement SystemName="CreditObligations" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="CreditScoring" ObjectType="DataObject" ID="603970" EncryptedID="4CWx;PRGqbV1IMzP4DtnY2IAAAAAB6r2wY" DataObjectCategory="RepeatingAttribute" DataObjectType="CreditScoring"/><DataObjectElement SystemName="DependantDetails" ObjectType="DataObject" ID="603978" EncryptedID="4OReRldXZeF8IU9a2e3RZk9AAAAAB6r2wQ" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantDependantDetailsAATSL"/><DataObjectElement SystemName="EmploymentAATSL" ObjectType="DataObject" ID="603972" EncryptedID="4GkF83Ll!xLiLqS1zL;FMG4AAAAAB6r2we" DataObjectCategory="RepeatingAttribute" DataObjectType="EmploymentAperioOnlyAATSL"/><DataObjectElement SystemName="ExpenditureDetailsTPF" ObjectType="DataObject" ID="603980" EncryptedID="4G6EGC6aL8LmN94xr9LNgRxAAAAAB6r2wW" DataObjectCategory="RepeatingAttribute" DataObjectType="ExpenditureTPF"/><DataObjectElement SystemName="Fields" ObjectType="DataObject" ID="9251" EncryptedID="4MEw5;;AiwprG2uKYJGudrLAAAAAB6pn95" DataObjectCategory="Party" DataObjectType="Personal"/><DataObjectElement SystemName="FinancialAssetsAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="FinancialExpenseAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="FinancialLiabilitiesAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="FinancierDeductionAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="IncomeSalariedAATSL" ObjectType="DataObject" ID="603973" EncryptedID="4J04bAAaMKqPIXbr7AAUfoQAAAAAB6r2wf" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantFinancialIncomeSalariedFinalAATSL"/><DataObjectElement SystemName="IncomeSelfEmployedAATSL" ObjectType="DataObject" ID="603974" EncryptedID="4D;pvvFrYPDyLjkipR7sYyQAAAAAB6r2wc" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantFinancialIncomeSelfEmplAATAP"/>
<CompositeDataObjectElement SystemName="Tabs" ObjectType="DataObject" ID="378409" EncryptedID="4J!pTqS7x4XxIYZjRd2jA2UAAAAAB6o51z" CompositeDataObject="ApplicantsViewsAAT"/>
</CompositeDataObject> 
```

* * *

`CollectionItem`如果内部仅存在一次，则以下查询可以正常工作`DataObjectElement`。如果`collectionItem`出现不止一次，则失败。基本上我想要实现的是在看到标签 ID 时将数据考虑到新行中。

* * *

```
 WITH t AS (SELECT XMLType('<CompositeDataObject Type="ApplicantsAAT" Version="0">
<DataObjectElement SystemName="AccountRelationship" ObjectType="DataObjectCollection">
<CollectionItem ID="604008" EncryptedID="4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy" DataObjectCategory="RepeatingAttribute" DataObjectType="AccountRelationshipAAT"/>
<CollectionItem ID="604040" EncryptedID="4IrPkqeoo7EVLEuSm7egK96AAAAAB6r2zS" DataObjectCategory="RepeatingAttribute" DataObjectType="AccountRelationshipAAT"/>
</DataObjectElement>
<DataObjectElement SystemName="ApplicantCreditRefDetailsAATSL" ObjectType="DataObject" ID="603979" EncryptedID="4PPEFaEyt2Q!K48f13wy7gzAAAAAB6r2wR" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantCreditRefDetailsAATSL"/><DataObjectElement SystemName="CreditCardsTPF" ObjectType="DataObjectCollection"/><CompositeDataObjectElement SystemName="CreditObligations" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="CreditScoring" ObjectType="DataObject" ID="603970" EncryptedID="4CWx;PRGqbV1IMzP4DtnY2IAAAAAB6r2wY" DataObjectCategory="RepeatingAttribute" DataObjectType="CreditScoring"/><DataObjectElement SystemName="DependantDetails" ObjectType="DataObject" ID="603978" EncryptedID="4OReRldXZeF8IU9a2e3RZk9AAAAAB6r2wQ" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantDependantDetailsAATSL"/><DataObjectElement SystemName="EmploymentAATSL" ObjectType="DataObject" ID="603972" EncryptedID="4GkF83Ll!xLiLqS1zL;FMG4AAAAAB6r2we" DataObjectCategory="RepeatingAttribute" DataObjectType="EmploymentAperioOnlyAATSL"/><DataObjectElement SystemName="ExpenditureDetailsTPF" ObjectType="DataObject" ID="603980" EncryptedID="4G6EGC6aL8LmN94xr9LNgRxAAAAAB6r2wW" DataObjectCategory="RepeatingAttribute" DataObjectType="ExpenditureTPF"/><DataObjectElement SystemName="Fields" ObjectType="DataObject" ID="9251" EncryptedID="4MEw5;;AiwprG2uKYJGudrLAAAAAB6pn95" DataObjectCategory="Party" DataObjectType="Personal"/><DataObjectElement SystemName="FinancialAssetsAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="FinancialExpenseAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="FinancialLiabilitiesAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="FinancierDeductionAATSL" ObjectType="DataObjectCollection"/><DataObjectElement SystemName="IncomeSalariedAATSL" ObjectType="DataObject" ID="603973" EncryptedID="4J04bAAaMKqPIXbr7AAUfoQAAAAAB6r2wf" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantFinancialIncomeSalariedFinalAATSL"/><DataObjectElement SystemName="IncomeSelfEmployedAATSL" ObjectType="DataObject" ID="603974" EncryptedID="4D;pvvFrYPDyLjkipR7sYyQAAAAAB6r2wc" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantFinancialIncomeSelfEmplAATAP"/>
<CompositeDataObjectElement SystemName="Tabs" ObjectType="DataObject" ID="378409" EncryptedID="4J!pTqS7x4XxIYZjRd2jA2UAAAAAB6o51z" CompositeDataObject="ApplicantsViewsAAT"/>
</CompositeDataObject>') xmlcol
               FROM dual)
    SELECT extract(value(x),'//*[@ID]/@ID') linked_object_id,
    extractValue(value(x),'//*[@ID]/ancestor-or-self::*[@EncryptedID]/@EncryptedID') linked_object_encrypted_id,
    extractValue(value(x),'//*[@ID]/ancestor-or-self::*[@SystemName]/@SystemName') system_name,
    extractValue(value(x),'//*[@ID]/ancestor-or-self::*[@DataObjectCategory]/@DataObjectCategory') data_object_category,
    extractValue(value(x),'//*[@ID]/ancestor-or-self::*[@ObjectType]/@ObjectType') object_type,
    extractValue(value(x),'//*[@ID]/ancestor-or-self::*[@DataObjectType]/@DataObjectType') data_object_type,
     extractValue(value(x),'//*[@ID]/ancestor-or-self::*[@CompositeDataObject]/@CompositeDataObject') composite_data_object
    FROM t, TABLE(XMLSequence(extract(t.xmlcol,'/CompositeDataObject/*'))) x; 
```

====================================== 下面是我期待的简单示例

感谢您的宝贵回复。

您发布的查询工作正常。但正如您所看到的，有些字段生成为 NULL。例如。第一个 DataObjectElement 包含 2 个 CollectionItem(604008,604008a)，但 CollectionItem 中没有“SystemName”，所以我期待主 DataObjectElement 标记中的 SystemName .. 即“AccountRelationship”。对象类型也是如此

```
WITH t AS (SELECT XMLType('<CompositeDataObject Type="ApplicantsAAT" Version="0">
<DataObjectElement SystemName="AccountRelationship" ObjectType="DataObjectCollection">
<CollectionItem ID="604008" EncryptedID="4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy" DataObjectCategory="RepeatingAttribute" DataObjectType="AccountRelationshipAAT"/>
<CollectionItem ID="604008a" EncryptedID="4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy" DataObjectCategory="RepeatingAttribute" DataObjectType="AccountRelationshipAAT"/>
</DataObjectElement>
<DataObjectElement SystemName="ApplicantCreditRefDetailsAATSL" ObjectType="DataObject" ID="603979" EncryptedID="4PPEFaEyt2Q!K48f13wy7gzAAAAAB6r2wR" DataObjectCategory="RepeatingAttribute" DataObjectType="ApplicantCreditRefDetailsAATSL"/>
<CompositeDataObjectElement SystemName="Tabs" ObjectType="DataObject" ID="378409" EncryptedID="4J!pTqS7x4XxIYZjRd2jA2UAAAAAB6o51z" CompositeDataObject="ApplicantsViewsAAT"/>
</CompositeDataObject>') xmlcol
               FROM dual)

                 SELECT extractvalue(value(x), '/*/@ID') id,
              extractvalue(value(x), '/*/@EncryptedID') EncryptedID,
              extractvalue(value(x), '/*/@SystemName') SystemName,
              extractvalue(value(x), '/*/@DataObjectCategory') DataObjectCategory,
              extractvalue(value(x), '/*/@ObjectType') ObjectType,
              extractvalue(value(x), '/*/@DataObjectType') DataObjectType,
              extractvalue(value(x), '/*/@CompositeDataObject') CompositeDataObject
       FROM t, TABLE(XMLSequence(extract(t.xmlcol,'//*[@ID]'))) x; 
```

上述查询的结果是

```
ID      ENCRYPTEDID                         SYSTEMNAME                      DATAOBJECTCATEGORY  OBJECTTYPE              DATAOBJECTTYPE                  COMPOSITEDATAOBJECT
604008  4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy                                  RepeatingAttribute                          AccountRelationshipAAT  
604008a 4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy                                  RepeatingAttribute                          AccountRelationshipAAT  
603979  4PPEFaEyt2Q!K48f13wy7gzAAAAAB6r2wR  ApplicantCreditRefDetailsAATSL  RepeatingAttribute  DataObject  ApplicantCreditRefDetailsAATSL  
378409  4J!pTqS7x4XxIYZjRd2jA2UAAAAAB6o51z  Tabs                                                DataObject                                                                              ApplicantsViewsAAT 
```

我期待的只是轻微的变化（下面的结果包含 SYSTEMNAME 和 OBJECTTYPE 的值）

```
ID      ENCRYPTEDID                         SYSTEMNAME                      DATAOBJECTCATEGORY  OBJECTTYPE              DATAOBJECTTYPE                  COMPOSITEDATAOBJECT
604008  4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy  AccountRelationship             RepeatingAttribute  DataObjectCollection    AccountRelationshipAAT  
604008a 4GnX1!b8epwsAmwbfvZjo;xAAAAAB6r2wy  AccountRelationship             RepeatingAttribute  DataObjectCollection    AccountRelationshipAAT  
603979  4PPEFaEyt2Q!K48f13wy7gzAAAAAB6r2wR  ApplicantCreditRefDetailsAATSL  RepeatingAttribute  DataObject  ApplicantCreditRefDetailsAATSL  
378409  4J!pTqS7x4XxIYZjRd2jA2UAAAAAB6o51z  Tabs                                                DataObject                                                                              ApplicantsViewsAAT 
```

请把我的内容复制到一些文本板中以获得更清晰的视图。非常感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T21:04:13.890

im not totally sure what you're after but is it 1 row per "id"? if so..

```
 10  select id, EncryptedID,
 11         nvl(SystemName, extractvalue(xmlcol, '//*[child::*/@ID="' || id || '"]/@SystemName')) SystemName,
 12         DataObjectCategory,
 13         nvl(ObjectType, extractvalue(xmlcol, '//*[child::*/@ID="' || id || '"]/@ObjectType')) ObjectType,
 14         DataObjectType,
 15         CompositeDataObject
 16    from (SELECT t.xmlcol, extractvalue(value(x), '/*/@ID') id,
 17                 extractvalue(value(x), '/*/@EncryptedID') EncryptedID,
 18                 extractvalue(value(x), '/*/@SystemName') SystemName,
 19                 extractvalue(value(x), '/*/@DataObjectCategory') DataObjectCategory,
 20                 extractvalue(value(x), '/*/@ObjectType') ObjectType,
 21                 extractvalue(value(x), '/*/@DataObjectType') DataObjectType,
 22                 extractvalue(value(x), '/*/@CompositeDataObject') CompositeDataObject
 23          FROM t, TABLE(XMLSequence(extract(t.xmlcol,'//*[@ID]'))) x)
 24  ;

ID         ENCRYPTEDID          SYSTEMNAME           DATAOBJECTCATEGORY   OBJECTTYPE           DATAOBJECTTYPE       COMPOSITEDATAOBJECT
---------- -------------------- -------------------- -------------------- -------------------- -------------------- --------------------
604008     4GnX1!b8epwsAmwbfvZj AccountRelationship  RepeatingAttribute   DataObjectCollection AccountRelationshipA
           o;xAAAAAB6r2wy                                                                      AT

604040     4IrPkqeoo7EVLEuSm7eg AccountRelationship  RepeatingAttribute   DataObjectCollection AccountRelationshipA
           K96AAAAAB6r2zS                                                                      AT

603979     4PPEFaEyt2Q!K48f13wy ApplicantCreditRefDe RepeatingAttribute   DataObject           ApplicantCreditRefDe
           7gzAAAAAB6r2wR       tailsAATSL                                                     tailsAATSL

603970     4CWx;PRGqbV1IMzP4Dtn CreditScoring        RepeatingAttribute   DataObject           CreditScoring
           Y2IAAAAAB6r2wY

603978     4OReRldXZeF8IU9a2e3R DependantDetails     RepeatingAttribute   DataObject           ApplicantDependantDe
           Zk9AAAAAB6r2wQ                                                                      tailsAATSL

603972     4GkF83Ll!xLiLqS1zL;F EmploymentAATSL      RepeatingAttribute   DataObject           EmploymentAperioOnly
           MG4AAAAAB6r2we                                                                      AATSL

603980     4G6EGC6aL8LmN94xr9LN ExpenditureDetailsTP RepeatingAttribute   DataObject           ExpenditureTPF
           gRxAAAAAB6r2wW       F

9251       4MEw5;;AiwprG2uKYJGu Fields               Party                DataObject           Personal
           drLAAAAAB6pn95

603973     4J04bAAaMKqPIXbr7AAU IncomeSalariedAATSL  RepeatingAttribute   DataObject           ApplicantFinancialIn
           foQAAAAAB6r2wf                                                                      comeSalariedFinalAAT
                                                                                               SL

603974     4D;pvvFrYPDyLjkipR7s IncomeSelfEmployedAA RepeatingAttribute   DataObject           ApplicantFinancialIn
           YyQAAAAAB6r2wc       TSL                                                            comeSelfEmplAATAP

378409     4J!pTqS7x4XxIYZjRd2j Tabs                                      DataObject                                ApplicantsViewsAAT
           A2UAAAAAB6o51z 
```

# primefaces - PrimeFaces 数据表一旦设置就删除 selectionMode 属性

> ID：14162852
> 
> 赞同：2
> 
> 时间：2013-01-04T18:35:00.417
> 
> 标签：primefaces, datatable

我试图在简单的“单击行以选择”表和“第一列表中的多选复选框”之间切换。我在表格外有一个复选框来更改表格的状态。对于简单表（第一列中没有复选框），必须在`p:datatable`标签中设置 selectionMode；“单一”或“多重”。在这种状态下，一切正常。

如果更改状态以呈现多选列，则单击事件似乎是通过选择行来消耗的。一般来说，当使用这个多选复选框表时，不会设置 selectionMode；因此鼠标事件会改变复选框的状态。

如何“取消设置” selectionMode。以下是不起作用的事情：

1.  `table.setSelectionMode(null)`- 这会破坏选择（设置为“”也是如此）
2.  `table.getAttributes().get("javax.faces.component.UIComponentBase.attributesThatAreSet")`然后删除 selectionMode （它不在设置的属性中）。

我的 xhtml 看起来像：

```
<h:form id="addForm">

    <p:panel toggleable="false" closable="false" widgetVar="remarksPanel"
        id="remarksPanel" style="margin-bottom:5px; overflow:auto;">

        <p:selectBooleanCheckbox value="#{multipleSelectBean.bulkEdit}">
            <p:ajax update="addForm:remarksTable"
                listener="#{multipleSelectBean.editModeChanged}" />
        </p:selectBooleanCheckbox>
        <h:outputText value=" Bulk Edit" />

        <p:dataTable var="remark" id="remarksTable" rowIndexVar="rowNum"
            value="#{multipleSelectBean.remarkList}" rowKey="#{remark.id}"
            selectionMode="multiple"
            selection="#{multipleSelectBean.selectedRemarks}">

            <p:column rendered="#{multipleSelectBean.bulkEdit}"
                selectionMode="multiple" style="width:18px" />              

            <p:column headerText="Remark">
                <p:cellEditor>
                    <f:facet name="output">
                        <h:outputText value="#{remark.remark}" />
                    </f:facet>
                    <f:facet name="input">
                        <p:inputText style="width:98%" id="remark"
                            value="#{remark.remark}" />
                    </f:facet>
                </p:cellEditor>

            </p:column>

        </p:dataTable>

    </p:panel>

</h:form> 
```

我的 Bean 看起来像：

```
package gov.gsa.krichards.sandbox;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import java.util.Map;
import java.util.Random;
import java.util.Set;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;

import org.primefaces.component.datatable.DataTable;
import org.primefaces.event.SelectEvent;

@ManagedBean
@SessionScoped
public class MultipleSelectBean implements Serializable {

private static final long serialVersionUID = 1L;
private final static String[] categoryList;
private List<Remark> remarkList = new ArrayList<Remark>();
private Remark[] selectedRemarks = null;
private String words = "Mauris interdum, turpis nec euismod c aliquet fermentum nisl, in tristique arcu tincidunt nec.";
private boolean bulkEdit = false;
private boolean initialized = false;

static {
    categoryList = new String[4];
    categoryList[0] = "Cat5";
    categoryList[1] = "Cat4";
    categoryList[2] = "Cat3-UTP";
    categoryList[3] = "BNC";
}

public MultipleSelectBean() {
    Random r = new Random();
    for (int i = 0; i < 10; i++) {
        String cat = categoryList[r.nextInt(4)];
        int len = words.length();
        int begIndex = r.nextInt(len / 2);
        int endIndex = begIndex + r.nextInt(len - begIndex);
        Remark rem = new Remark(i, cat, words.substring(begIndex, endIndex));
        remarkList.add(rem);
    }
}

public void editModeChanged() {
    System.out.println("changed to " + bulkEdit);
}

public void setBulkEdit(boolean arg) {
    DataTable table = (DataTable) FacesContext.getCurrentInstance()
            .getViewRoot().findComponent("addForm:remarksTable");
    bulkEdit = arg;

    if (bulkEdit) {
        table.setSelectionMode("single");
    } else {
        table.setSelectionMode("multiple");
    }

}

public boolean isBulkEdit() {
    return bulkEdit;
}

public List<Remark> getRemarkList() {
    return remarkList;
}

public void setRemarkList(List<Remark> remarkList) {
    this.remarkList = remarkList;

}

public String[] getCategoryList() {
    return categoryList;
}

public Remark[] getSelectedRemarks() {
    if (selectedRemarks == null || selectedRemarks.length == 0)
        return null;
    return selectedRemarks;
}

public void setSelectedRemarks(Remark[] selectedRemarks) {
    this.selectedRemarks = selectedRemarks;
}

} 
```

# delphi - Delphi XE2 共享存储库

> ID：14162855
> 
> 赞同：2
> 
> 时间：2013-01-04T18:35:11.070
> 
> 标签：delphi, delphi-xe2

我们最近从 Delphi 7 迁移到 Delphi XE2。对于这两种环境，我们都使用网络上的“共享存储库”。这在 Delphi 7 中非常有效，但我们似乎无法在 Delphi XE2 中复制它。我在 Internet 以及 StackOverflow 和 StackExchange 上进行了很多搜索，但似乎找不到任何可以解决我的问题的方法。

在工具 > 选项 > 环境选项下，我指定了一个共享存储库（例如 \DEVSERVER\ShareName\XE2ObjectRepository）。

我可以毫无问题地将我的表单添加到共享存储库中，并且它们在“Delphi Projects > MyStuff”下的“文件”>“新建”>“其他”中显示良好（我的示例中的虚拟类别名称）。

正如我所期望的那样，在上面的“共享存储库”目录中创建了一个存储库模式文件 (RADStudioRepository.xml)。

当我尝试从其中一种形式继承时，问题就出现了。我收到以下错误：

无法同时找到表单 (\DEVSERVER\EN\XE2ObjectRepository\UFrmLookup.dfm) 和源文件 (\DEVSERVER\EN\XE2ObjectRepository\UFrmLookup.pas)。

正如您将在上面的错误消息中注意到的那样，路径名中添加了一个 \EN\。我一生都无法弄清楚这到底是从哪里来的。我想如果我能解决这个问题，这对我来说会很好。

谁能帮我解决这个问题？我已经断断续续地工作了几个月，但无法弄清楚。这可能是显而易见的，但我不知所措？？？？？？

# php - 聪明的语法问题

> ID：14162863
> 
> 赞同：1
> 
> 时间：2013-01-04T18:35:43.293
> 
> 标签：php, html, css, smarty

我是 smarty 的新手，我正在工作的两个文件是 browse.php

```
<?php
include ("include/config.php");

if(isset($_GET['offset']))
$offset=$_GET['offset'];
else
$offset=0;
//**** Set limit record per page
$limit=10;
$num=0;

function dateDiff($dformat, $endDate, $beginDate)
{
    return mysql_result(mysql_query("SELECT DATEDIFF('$beginDate', '$endDate')"),0,0);
}

if(isset($_GET[show_length]))
    $_SESSION[show_length] = $_GET[show_length];
elseif(!isset($_SESSION[show_length]))
    $_SESSION[show_length] = 'all';

if(isset($_GET[show_cat]))
    $_SESSION[show_cat] = $_GET[show_cat];
elseif(!isset($_SESSION[show_cat]))
    $_SESSION[show_cat] = 'all';

if(isset($_GET[show_category]))
    $_SESSION[show_category] = $_GET[show_category];
elseif(!isset($_SESSION[show_category]))
    $_SESSION[show_category] = 0;

if(isset($_GET[qry])) { //echo $_GET[qry];
    $_SESSION[show_category] = 0;
    $_SESSION[show_cat] = 'all';
    $_SESSION[show_length] = 'all';
}
    $category = '';
    if($_SESSION[show_category] != 0)
        $category = ' and pi.catid='.$_SESSION[show_category];

$param = " where ";

if ($_SESSION[show_cat] == 'txt_ad')
    $param .= " p.ad_type like '%txt_ad' ";

if ($_SESSION['show_cat'] == 'PicText_ad')
    $param .= " p.ad_type like '%PicText_ad' ";

elseif ($_SESSION[show_cat] == 'img_ad')
    $param .= " p.ad_type like '%img_ad' ";

elseif ($_SESSION[show_cat] == 'peel_ad')
    $param .= " p.ad_type like '%peel_ad' ";

elseif ($_SESSION[show_cat] == 'splash_ad')
    $param .= " p.ad_type like '%splash_ad' ";

elseif ($_SESSION[show_cat] == 'pop_ad')
    $param .= " p.ad_type like '%pop_ad' ";

elseif ($_SESSION[show_cat] == 'vdo_ad')
    $param .= " p.ad_type like '%vdo_ad' ";

elseif ($_SESSION[show_cat] == 'pop_under')
    $param .= " p.ad_type='pop_under' ";

elseif ($_SESSION[show_cat] == 'pop_up')
    $param .= " p.ad_type='pop_up' ";

elseif ($_SESSION[show_cat] == 'full_page')
    $param .= " p.ad_type='full_page' ";

elseif ($_SESSION[show_cat] == 'all')
    $param .= " p.ad_type<>'inline' AND p.ad_type<>'invideo' ";

if($_SESSION['show_length'] == 'ppc' || $_SESSION['show_length'] == 'ppm'){
    if($_SESSION[show_length] == 'ppc'){
        $param .= " and p.length='0' and p.ad_type like 'ppc_%' ";
    } else $param .= " and p.length='0' and p.ad_type like 'ppm_%' ";
}
elseif ($_SESSION[show_length] != 'all')
    $param .= " and p.length='$_SESSION[show_length]' ";

    $search = '';
if(isset($_GET[qry]))
    $search = " and  (pi.keywords like '%$_GET[qry]%' or pi.websitename like '%$_GET[qry]%') ";

$inqry = " select distinct p.pid, p.uid from publishers_adspaces p $param ";
//echo $inqry;
$inq = mysql_query($inqry);
$in_array = array();
while ($inr = mysql_fetch_assoc($inq)){
    $get_suspended_uid = mysql_result(mysql_query("select status from users where uid = '$inr[uid]' limit 1 "),0,0);
    if($get_suspended_uid == 0) continue;
    $in_array[] = $inr[pid];
}
$in_arr_str = implode(',',  $in_array);
$ws_qry = "select distinct t.pid, t.member_since, t.websitename, t.url, t.distinct_hits, t.google_page_rank, t.alexa_rank from (
select pi.* from publishersinfo pi inner join publishers_adspaces pa on pi.pid=pa.pid where pi.pid in ($in_arr_str) and pi.status = '1' $category $search order by ad_id desc)
as t";
//echo $ws_qry;
$num = mysql_num_rows(mysql_query($ws_qry));

$ws = mysql_query("$ws_qry limit $offset, $limit");
    while($row = @mysql_fetch_assoc($ws)){

    $a_cpc = mysql_result(mysql_query("select round(avg(cost),2) from publishers_adspaces where pid='$row[pid]' and length=0"),0,0);

    $def_len = $_SESSION[show_length];
    $def_ad_type = $_SESSION[show_cat];
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='txt_ad') $def_ad_type = 'ppc_txt_ad';
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='PicText_ad') $def_ad_type = 'ppc_PicText_ad';
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='img_ad') $def_ad_type = 'ppc_img_ad';
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='peel_ad') $def_ad_type = 'ppc_peel_ad';
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='splash_ad') $def_ad_type = 'ppc_splash_ad';
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='pop_ad') $def_ad_type = 'ppc_pop_ad';
        if($def_len == 0 && $def_len != 'all' && $def_ad_type=='vdo_ad') $def_ad_type = 'ppc_vdo_ad';
        if($_SESSION[show_cat] == 'pop_under') {$def_len = 0; $def_ad_type = 'pop_under';}
        if($_SESSION[show_cat] == 'pop_up') {$def_len = 0; $def_ad_type = 'pop_up';}
        if($_SESSION[show_cat] == 'full_page') {$def_len = 0; $def_ad_type = 'full_page';}

    if(($def_ad_type == 'all') && ($def_len == 'all'))
        $cst = mysql_result(mysql_query("select round(min(cost),3) from publishers_adspaces where pid='$row[pid]'  "),0,0); 
    elseif($def_ad_type == 'all')
        $cst = mysql_result(mysql_query("select round(min(cost),3) from publishers_adspaces where pid='$row[pid]' and length='$def_len' "),0,0);    
    elseif($def_len == 'all')
        $cst = mysql_result(mysql_query("select round(min(cost),3) from publishers_adspaces where pid='$row[pid]' and ad_type like '%$def_ad_type'"),0,0); 
    else 
        $cst = mysql_result(mysql_query("select round(min(cost),3) from publishers_adspaces where pid='$row[pid]' and length='$def_len' and ad_type='$def_ad_type'"),0,0);

//  $cst = mysql_result(mysql_query("select round(min(cost),3) from publishers_adspaces where pid='$row[pid]' "),0,0);

    $T = ''; $I = ''; $V = ''; $P = ''; $F = ''; $PU = ''; $S = ''; $PA = ''; $PEEL = ''; $PT = '';
    $txt = mysql_result(mysql_query("select count(*) from publishers_adspaces where ad_type like '%txt_ad' and pid='$row[pid]' "),0,0);
    if ($txt) $T = 'T';

    $PicText = mysql_result(mysql_query("select count(*) from publishers_adspaces where ad_type like '%PicText_ad' and pid='$row[pid]' "),0,0);
    if ($PicText) $PT = 'PT';

    $img = mysql_result(mysql_query("select count(*) from publishers_adspaces where ad_type like '%img_ad' and pid='$row[pid]'  "),0,0);
    if ($img) $I = 'I';

    $peel = mysql_result(mysql_query("select count(*) from publishers_adspaces where ad_type like '%peel_ad' and pid='$row[pid]'  "),0,0);
    if ($peel) $PEEL = 'PEEL';

    $splash = mysql_result(mysql_query("select count(*) from publishers_adspaces where ad_type like '%splash_ad' and pid='$row[pid]'  "),0,0);
    if ($splash) $S = 'S';

    $pop = mysql_result(mysql_query("select count(*) from publishers_adspaces where ad_type like '%pop_ad' and pid='$row[pid]' "),0,0);
    if ($pop) $PA = 'PA';

    $vdo = mysql_result(mysql_query("select count(*) from publishers_adspaces where (ad_type='vdo_ad' or ad_type like '%_vdo_ad') and pid='$row[pid]'  "),0,0);
    if ($vdo) $V = 'V';

    $popunder = mysql_result(mysql_query("select count(*) from publishers_adspaces where (ad_type='pop_under') and pid='$row[pid]'  "),0,0);
    if ($popunder) $P = 'P';

    $popup = mysql_result(mysql_query("select count(*) from publishers_adspaces where (ad_type='pop_up') and pid='$row[pid]'  "),0,0);
    if ($popup) $PU = 'PU';

    $fullpage = mysql_result(mysql_query("select count(*) from publishers_adspaces where (ad_type='full_page') and pid='$row[pid]'  "),0,0);
    if ($fullpage) $F = 'F';

//  $max_u = mysql_result(mysql_query("SELECT count(distinct ip) as total from hits where pub_id='$row[pid]' group by date order by total desc limit 1"),0,0);
    $date_now = date("Y-m-d");
    $reg_date = $row[member_since];
    $diff = dateDiff("-", $date_now, $reg_date);
    if($diff <= 0) $diff = 1;

    //$max_u_u = mysql_result(mysql_query("SELECT count(distinct ip) as total from hits where pub_id='$row[pid]' group by date order by total desc limit 1"),0,0); // live
    $max_u_u = $row['distinct_hits']; // NOT live

    $upvpd = round(($max_u_u / $diff),2);
//  if($upvpd >= 1) $upvpd = round($upvpd);
    if($upvpd == 0) $upvpd = "";

$realPath = dirname(__FILE__);
$thumbPath = $realPath.'/wwwThumb/thumb_'.$row[pid].'_pic.jpg';
if(file_exists($thumbPath) && filesize($thumbPath) > 0)
    $fileName = 'thumb_'.$row[pid].'_pic.jpg';
else
    $fileName = 'nothumb.jpg';

    $c[] = array ('pid' => $row[pid], 'wname' => $row['websitename'], 'alexa' => $row['alexa_rank'], 'gpr' => $row['google_page_rank'], 'url' => $row['url'], 'thumb' => $fileName, 'daily_users' => $upvpd, 'cpc' => $a_cpc, 'cost' => $cst, 'T' => $T, 'I' => $I, 'V' => $V, 'P' => $P, 'F' => $F,  'PU' => $PU, 'PT' => $PT, 'PA' => $PA, 'S' => $S, 'PEEL' => $PEEL );
//  print_r($c);
 }

$smarty->assign('winfo', $c);

// Pagination
$TblPagignationClass = new  TblPagignationClass('Previous','Next',$limit);
$TblPagignationClass->SetOffset($offset) ;
$TblPagignationClass->SetNumofRows($num) ;
$TblPagignationClass->SetFileName($_SERVER['PHP_SELF']) ;
//$TblPagignationClass->SetIdentifierVariable("orderby=picture_id") ; 
$Template_Pagignation_Data=$TblPagignationClass->CreatePagignationData() ;

$smarty->assign('Template_Pagignation_Data', $Template_Pagignation_Data);

$offset=1;
$smarty->assign('offset', $offset);
//

$smarty->assign('cat_menu', get_list('category', 'category'));

$m1 = mysql_result(mysql_query("select max(length) from textad"),0,0);
$m2 = mysql_result(mysql_query("select max(length) from imagead"),0,0);
$m3 = mysql_result(mysql_query("select max(length) from videoad"),0,0);

$max_length = max($m1,$m2,$m3);
for ($i=1; $i<=$max_length; $i++)
    $lens[$i] = $i.' Day Ads';
$smarty->assign('len_menu', $lens);
$smarty->assign('right_panel', 'off');
$content = $smarty->fetch('browse.tpl');
$smarty->assign('content',$content);
$smarty->display('master_page.tpl');
?> 
```

和浏览.tpl

```
<h1>{$_lang.Browse_Websites_To_Advertise_On}</h1>
    <div class="types">Types of ads we currently support:
    {if $_config.text_ad == 'on'}
          <img src="{$template_dir}/images/text_ad.png" alt="{$_lang.Text_Ads}" width="16" height="16" align="absmiddle" /> - {$_lang.Text_Ads}
          {/if}
          {if $_config.image_ad == 'on'}
           <br />
            <img src="{$template_dir}/images/img_ad.png" alt="{$_lang.Image_Ads}" width="16" height="16" align="absmiddle" /> - {$_lang.Image_Ads}
            {/if}</div><!--types -->

  <p>Feel free to browse through our marketplace. You can list the sites based on their categories and types of ads the owners are selling.</p>
  <div class="clearfix"></div>

  <div class="liner"></div>
  <div class="browsing">
  <select name="show_category"  onchange="javascript: if(this.value != '-1') window.location=location.pathname+'?show_category='+this.value;">
                <option value="-1">{$_lang.Choose_Category}</option>
                <option value="0">-- {$_lang.All} --</option>
                {html_options values=$cat_menu.cid output=$cat_menu.category  selected=$smarty.session.show_category}
  </select>

  <span class="choose">
  {if $smarty.session.show_length != 'ppc'}<a href="?show_length=ppc">{/if}Pay-Per-Click Ads{if $smarty.session.show_length != 'ppc'}</a>{/if}

  {if $smarty.session.show_length != 'ppm'}<a href="?show_length=ppm">{/if}PPM Ads{if $smarty.session.show_length != 'ppm'}</a>{/if}

  {if $smarty.session.show_length != 'all'}<a href="?show_length=all">{/if}{$_lang.Show_All}{if $smarty.session.show_length != 'all'}</a>{/if}
  </span>
  <span class="choose">
  {$_lang.Only_Show}: {if $_config.text_ad == 'on'}{if $smarty.session.show_cat != 'txt_ad'}<a href="?show_cat=txt_ad">{/if}{$_lang.Text_Ads}{if $smarty.session.show_cat != 'txt_ad'}</a>{/if}{/if}

  {if $_config.image_ad == 'on'}{if $smarty.session.show_cat != 'img_ad'}<a href="?show_cat=img_ad">{/if}{$_lang.Image_Ads}{if $smarty.session.show_cat != 'img_ad'}</a>{/if}{/if}

  {if $smarty.session.show_cat != 'all'}<a href="?show_cat=all">{/if}{$_lang.Show_All}{if $smarty.session.show_cat != 'all'}</a> {/if}
   </span>

  </div><!-- browsing -->

  <div class="liner"></div>

  {section name=num loop=$winfo}

  <div class="website">
    <div class="my-image">
      <img src='http://www.bitpixels.com/getthumbnail?code=63848&size=100&url={$winfo[num].url}'/><!--<img src="wwwThumb/{$winfo[num].thumb}" alt="{$winfo[num].wname}" width="60" height="44" />-->
    </div>

    <div class="adcost">
    <strong>{$_lang.Ad_Cost}:</strong> {$CURRENCY}{$winfo[num].cost|string_format:"%.2f"}

    <div class="details"><a href="website_page.php?pid={$winfo[num].pid}">{$_lang.More_Info}</a></div>
    </div><!--adcost -->

    <div class="site-name">
      <a href="website_page.php?pid={$winfo[num].pid}">{$winfo[num].wname}</a>
        {if $winfo[num].T == 'T'} <img src="{$template_dir}/images/text_ad.png" alt="{$_lang.Text_Ads}" width="16" height="16" align="absmiddle" /> {/if}
        {if $winfo[num].I == 'I'} <img src="{$template_dir}/images/img_ad.png" alt="{$_lang.Image_Ads}" width="16" height="16" align="absmiddle" /> {/if}
    </div>  

        <strong>{$_lang.Daily_Unique_Users}:</strong> {if $winfo[num].daily_users == ""}{$_lang.no_data}{else}{$winfo[num].daily_users}{/if}<br/>
        <strong>Google Page Rank: </strong>  {if $winfo[num].gpr == ""}{$_lang.no_data}{else}{$winfo[num].gpr}{/if}<br/>
        <strong>Alexa Rank: </strong>  {if $winfo[num].alexa == ""}{$_lang.no_data}{else}{$winfo[num].alexa}{/if}

  </div><!-- website -->   
  {/section}

{$Template_Pagignation_Data}

<div class="liner"></div>                    
<div class="my-tips">
{$TIP}
</div> 
```

和 config.php

```
<?php
error_reporting(1);
session_start();
ob_start();
error_reporting(0);
$_config = array();
$abs_path = dirname(dirname(__FILE__));
require_once($abs_path . "/include/class.sanitize.php");
require_once($abs_path . "/include/db_connection.php");
require_once($abs_path . "/include/libs/Smarty.class.php");
include($abs_path . "/include/functions.php");
require_once($abs_path . "/include/pagination.php");

$smarty = new Smarty;

if($admin_page == 'Y')
    {
    $smarty->assign('sel_tmp', $_config['template'] );
    $_config['template'] = 'default';
    }

$smarty->template_dir = 'templates/'.$_config['template'].'/';
$smarty->compile_dir = 'templates_c/';
$smarty->config_dir = 'configs/';
$smarty->cache_dir = 'cache/';
//$smarty->caching = true;
//$smarty->cache_lifetime = 3600;
$smarty->compile_check = true; //
$smarty->debugging = false;  //
$smarty->error_reporting = false;

if(isset($_SESSION['uid'], $_SESSION['lang'])){
    if(isset($_POST['mylang'])){
        mysql_query("UPDATE users SET lang = '$_POST[mylang]' WHERE uid = '$_SESSION[uid]' ") or die(mysql_error());
        $_SESSION['lang'] = $_POST['mylang'];
    }

    if($_SESSION['lang'] == '') $_SESSION['lang'] = 'English';

    $_config['lang'] = $_SESSION['lang'];
}
//die($_config['lang']);
$lang_file = $abs_path . '/include/lang/'.$_config[lang].'.php';

include($lang_file);
$smarty->assign('_lang',$_lang);

$lang_files = array();
if ($handle = opendir($abs_path . '/include/lang/')) {
   while (false !== ($file = readdir($handle))) {
       if ($file != "." && $file != "..") {
           $lang_files[] = substr($file, 0, -4);
        }
    }
    closedir($handle);
}
$smarty->assign('lang_files', $lang_files);

$smarty->assign('template_dir','templates/'.$_config['template']);

$smarty->assign('CURRENCY',$_config['currency']);

$smarty->assign('_config',$_config);

$scfn = $_SERVER['SCRIPT_FILENAME'];
$t = explode('/', $scfn );
$cp = $t[count($t)-1];
$smarty->assign('cp',$cp);

$tip = mysql_result(mysql_query("select tip from tips order by rand() limit 1"),0,0);
$TIP = '<p align="left" class="post-footer align-left" style="margin-bottom: 10px;">
    <span class="tips_body">
        <span class="tips">'.$_config[website_name].' '.$_lang[Tip].':</span>
        <span id="tips_text">'.
            stripslashes($tip);
        '</span>
    </span>
</p>';
$smarty->assign('TIP',$TIP);

/// Top sites ///
$top_sites_alexa = mysql_query("select distinct publishersinfo.* from publishersinfo, publishers_adspaces, users where publishersinfo.alexa_rank>0 and publishersinfo.status = '1' and publishers_adspaces.pid = publishersinfo.pid and users.status = '1' and users.uid = publishersinfo.uid 
order by publishersinfo.alexa_rank limit 5");
$top_sites_gpr = mysql_query("select distinct publishersinfo.* from publishersinfo, publishers_adspaces, users where publishersinfo.google_page_rank>0 and publishersinfo.status = '1' and publishers_adspaces.pid = publishersinfo.pid and users.status = '1' and users.uid = publishersinfo.uid 
order by publishersinfo.google_page_rank desc limit 5");
    while ($alexa_row = mysql_fetch_assoc($top_sites_alexa)) {
        $a[] = array('pid' => $alexa_row['pid'], 'wname' => $alexa_row['websitename'], 'a_rank' => $alexa_row['alexa_rank']);
    }
    while ($gpr_row = mysql_fetch_assoc($top_sites_gpr)) {
        $g[] = array('pid' => $gpr_row['pid'], 'wname' => $gpr_row['websitename'], 'g_rank' => $gpr_row['google_page_rank']);
    }

    $smarty->assign('alexa_top', $a);
    $smarty->assign('google_top', $g);
ob_end_clean();
?> 
```

现在的问题是如何从数据库中获取类别并输出到下拉菜单？

```
<select name="show_category"  onchange="javascript: if(this.value != '-1') window.location=location.pathname+'?show_category='+this.value;">
                    <option value="-1">{$_lang.Choose_Category}</option>
                    <option value="0">-- {$_lang.All} --</option>
                    {html_options values=$cat_menu.cid output=$cat_menu.category  selected=$smarty.session.show_category}
      </select> 
```

在browse.php我看到下面的代码cat_menu被分配

```
$smarty->assign('cat_menu', get_list('category', 'category')); 
```

但我找不到 get_list 函数。

我需要有关如何从数据库中获取类别信息的帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:40:35.573

我很确定该函数在您的 config.php 文件中。因此包含（“include/config.php”）；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T09:08:02.130

只是一个猜测：因为“get_list”是一个函数，你可以看看 config.php 包含的“/include/functions.php”；）

# c# - 电子邮件中的嵌入图像未显示 (.NET 3.5)

> ID：14162875
> 
> 赞同：0
> 
> 时间：2013-01-04T18:36:34.560
> 
> 标签：c#, .net, email, smtp, alternateview

在 .NET/C# 3.5 中，我构建了一封带有**嵌入图像的电子邮件，在****smtp4dev** (http://smtp4dev.codeplex.com/)中接收电子邮件，但图像不会显示。 *我使用 HTML Agility Pack 来解析 HTML 文档并进行一些清理（这部分工作正常）。*

```
//uninteresting code above

    var images = doc.DocumentNode.Descendants("img");

    List<MemoryStream> listOfStreams = new List<MemoryStream>();
    List<string> listOfCid = new List<string>();
    List<string> listOfReplacedSrcValues = new List<string>();

            foreach (var img in images)
            {
                var src = img.Attributes["src"];
                if (src != null && src.Value.StartsWith("http://"))
                {
                    listOfReplacedSrcValues.Add(src.Value);
                    //I build a string that looks like this inv_brandLogo_fr_gif
                    string cid = src.Value.Substring(src.Value.LastIndexOf('/'), src.Value.Length - src.Value.LastIndexOf('/')).Trim('/').Replace('.', '_');
                    string cidWithTimestamp = string.Format("cid:{0}_{1}", cid, DateTime.Now.ToString("yyyy-MM-dd-HH-mm-ss-fffffff")); //append a timestamp to ensure the cid is unique !
                    PageResult = PageResult.Replace(src.Value, cidWithTimestamp);
                    listOfCid.Add(cidWithTimestamp);

                    WebClient wc = new WebClient();
                    byte[] originalData = wc.DownloadData(src.Value);

                    MemoryStream ms = new MemoryStream(originalData);

                    listOfStreams.Add(ms);
                }
            }

            MailAlert.SendRecap(Context.User.Identity.Name, PageResult, listOfStreams, listOfCid);

//end of the 1st bit of code

public static void SendRecap(string connectedUser, string HTMLcontent, List<MemoryStream> listOfStreams, List<string> listOfCid)
        {
            try
            {
                SmtpClient sender = new SmtpClient();

                MailMessage message = new MailMessage();

                message.From = new MailAddress("recap@test.com");
                message.To.Add(string.Format("{0}@vente-privee.com", connectedUser));
                message.Subject = "Test Recap";
                message.Body = HTMLcontent;
                message.IsBodyHtml = true;

                int i = 0;
                string plainBody = "Plain text content, viewable by clients that don\'t support html";
                AlternateView plainView = AlternateView.CreateAlternateViewFromString(plainBody, null, "text/plain");
                AlternateView htmlView = AlternateView.CreateAlternateViewFromString(HTMLcontent, null, "text/html");

                //create the LinkedResource (embedded image)
                foreach (var ms in listOfStreams)
                {
                    ContentType ct = new ContentType();
                    if (listOfCid[i].Contains("gif"))
                    {
                        ct = new ContentType(MediaTypeNames.Image.Gif);
                    }
                    else if (listOfCid[i].Contains("jpg") || listOfCid[i].Contains("jpeg"))
                    {
                        ct = new ContentType(MediaTypeNames.Image.Jpeg);
                    }
                    else if (listOfCid[i].Contains("png"))
                    {
                        //contentType = "image/png";
                        ct = new ContentType(MediaTypeNames.Image.Jpeg);
                    }

                    LinkedResource imageResource = new LinkedResource(ms, ct);

                    imageResource.ContentId = listOfCid[i];
                    imageResource.TransferEncoding = TransferEncoding.Base64;

                    htmlView.LinkedResources.Add(imageResource);
                    i++;
                }

                message.AlternateViews.Add(plainView);
                message.AlternateViews.Add(htmlView);

                sender.Send(message);
            }
            catch (Exception ex)
            {
                throw ex;
            }
        } 
```

当我在 smtp4dev 中检查收到的电子邮件时，我可以在左列“MIME Parts”中看到它的所有部分：

*   未命名：多部分/替代（158959 字节）
    *   未命名：文本/纯文本（50642 字节）
    *   未命名：文本/纯文本（65 字节）
    *   未命名：多部分/相关（107752 字节）
        *   未命名：text/html（50642 字节）
        *   未命名：图像/gif（4610 字节）
        *   未命名：图像/jpeg（1908 字节）
        *   未命名：图像/gif（540 字节）
        *   未命名：图像/gif（544 字节）
        *   未命名：text/html（48466 字节）

我什至可以选择这些图像中的任何一个，单击“正文”选项卡，选择“另存为”并在我最喜欢的图像查看器中成功打开它们。

当我选择“未命名：文本/html（50642 字节）”行然后选择“正文”选项卡时，我可以看到电子邮件的 HTML 源代码和所有“cid：”（例如：src="cid:inv_brandLogo_fr_gif_2013-01-04 -18-50-34-4569409")

但是，如果我在 smtp4dev 中单击“打开”，则电子邮件会在 Internet Explorer 中打开而没有任何图像。

当 IE 打开时，它在底部显示一个警告：“Internet Explorer 限制此网页运行脚本或 ActiveX 控件”和一个按钮“允许阻止的内容”，我单击它，但无济于事......

我已经阅读了许多网站/博客，但无法弄清楚为什么嵌入的图像不会显示。我在这里想念什么？

# android - 重复AlarmManager如何启动AsyncTask？

> ID：14162887
> 
> 赞同：1
> 
> 时间：2013-01-04T18:37:15.323
> 
> 标签：android, android-asynctask, alarmmanager

我通常编写此代码来启动服务`AlarmManager`。

```
 intent = new Intent(getActivity(), someservice.class);
    pendingNotificationIntent = PendingIntent.getService(getActivity(), 0, intent, 0);
    alarm = (AlarmManager) getActivity().getSystemService(getActivity().ALARM_SERVICE);
    int interval = 30 * 1000;
    long now = Calendar.getInstance().getTimeInMillis();
    alarm.setRepeating(AlarmManager.RTC_WAKEUP, now, interval, pendingNotificationIntent); 
```

My`AsyncTask`是我注册`AlarmManager`对象的私有类。

如何使用对象调用`AsyncTask`而不是服务？`AlarmManager`

PS。如果有更好的方法可以`AsyncTask`每 X 秒/分钟运行一次，请提出！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-07T03:19:28.220

根据[munish-katoch](https://stackoverflow.com/users/1751027/munish-katoch)的回复，我有以下具体解决方案。

设置闹钟：

```
Intent intent = new Intent(context, AlarmReceiver.class);

PendingIntent alarmIntent = PendingIntent.getBroadcast(context, 0, intent, 0);

AlarmManager alarmMgr = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
alarmMgr.setInexactRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP, 
  SystemClock.elapsedRealtime() + 5 * 1000, 60 * 1000, alarmIntent); 
```

上述代码配置`AlarmManager`为触发 at `AlarmReceiver`，其定义如下：

```
public class AlarmReceiver extends WakefulBroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {  
    new MyAsyncTask.execute();
  }
} 
```

在发生警报`AlarmReceiver`时启动`MyAsyncTask`。

### 这里是龙

从 a实例化 an存在[生命周期问题](https://stackoverflow.com/questions/25174226/is-instantiating-an-asynctask-from-a-wakefulbroadcastreceiver-recommended)，即上述解决方案可能导致过早终止。此外，[违反了线程规则](https://stackoverflow.com/a/25172977/3664487)。`AsyncTask``WakefulBroadcastReceiver``MyAsyncTask`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:17:38.863

您可以这样做：

1.) 定义一个静态意图（intent1）并在设置时间时使用它传递给AlarmManager。所以现在无论何时，都会过去；AlarmManager 将通过发送 intent1 进行通知。

2.) 在intent1 的BroadcastReceiver 的onReceive 上，启动一个AsyncTask。在 AsyncTask 结束时，为 AlarmManager 设置下一次。

# printing - 我可以使用蓝牙使用 Windows Phone 8 打印到便携式打印机吗？

> ID：14162889
> 
> 赞同：6
> 
> 时间：2013-01-04T18:37:19.390
> 
> 标签：printing, bluetooth, windows-phone-8, zebra-printers

我正在 windows phone 8 上开发一个应用程序。此应用程序必须使用 Zebra MZ 220 移动打印机等移动打印机打印票证。

我一直在谷歌搜索，试图获取有关使用 windows phone 8 打印到蓝牙打印机的信息，但没有太多信息。

我担心必须在另一个移动操作系统（如 android）中开始新的开发，因为 wp8 不支持在蓝牙上打印。

有没有关于它的例子？是否有兼容 Microsoft Windows Phone 8 的便携式打印机？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T20:27:15.377

此代码适用于与诺基亚 820 配对的 Zebra 420。

```
 private async void PrintStuff()
        {
            string command = "^XA^LH30,30^F020,10^AD^FDHello World^FS^XZ";
            Byte[] buffer = new byte[command.Length];
            buffer = StringToAscii(command);

            PeerFinder.AlternateIdentities["Bluetooth:Paired"] = "";
            var pairedDevices = await PeerFinder.FindAllPeersAsync();

            if (pairedDevices.Count == 0)
            {
                Debug.WriteLine("No paired devices were found.");
            }
            else
            {
                PeerInformation selectedDevice = pairedDevices[0];
                StreamSocket socket = new StreamSocket();
                await socket.ConnectAsync(selectedDevice.HostName, "1");                
                await socket.OutputStream.WriteAsync(WindowsRuntimeBufferExtensions.AsBuffer(buffer));
            }
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T00:40:56.993

WP8上已经有其他 BT-SPP 打印机的[示例](https://www.youtube.com/watch?v=i4cZ2FQS-1k&playnext=1&list=PL83A84A595BE73552&feature=results_main)。应该可以连接到您的“Zebra”蓝牙打印机并发送作业。基于[此文档](http://www.zebra.com/id/zebra/na/en/documentlibrary/misc/bluetooth_connectivity.File.tmp/ConnectivityBTRev2-1.pdf)支持 WP8 支持的 BT-SPP（蓝牙串口端口）：

![引用](../Images/b0fd0d9c3bff6e9dd17a156342b867fd.png)

您首先必须弄清楚的一件事是您的设备预期的输入/输出字节数据包的细节。SPP 只是通过 BT 发送和接收字节，您需要知道您的设备需要的具体格式。例如，在我的[Mindwave Headset WP8 BT SDK](http://metroeeg.codeplex.com/wikipage?title=Standalone&referringTitle=Documentation)中，我必须找到[这个文档](http://wearcam.org/ece516/mindset_communications_protocol.pdf)，其中包含该特定设备的 BT-SPP 协议。似乎有[很多](http://sharpzebra.codeplex.com/) [Zebra 打印机的 OSS 项目](https://github.com/search?q=zebra%20printer&p=1&ref=searchbar&type=Repositories&l=)，所以您可能想看看它们是否具有这些格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-11T22:03:02.197

我正在开发一个使用蓝牙打印机的 Android 应用程序（稍后是 Windows Phone），它很简单，我发现它可以在任何具有蓝牙功能的操作系统上完成。每台打印机的连接方式都略有不同，但是一旦可以连接，您只需通过串行方式传递数据。就我而言，我正在使用图像并将字节作为字符串发送。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-04T19:45:27.863

Zebra[为 Windows Mobile .NET](http://www.zebra.com/us/en/products-services/software/adapt-software/zebralink-sdk-windows-mobile.html)框架提供了一个 API，用于在 WinMo .NET 中进行打印

# c# - 将子事件提升到父 UserControl 的最 DRY 方式

> ID：14162890
> 
> 赞同：4
> 
> 时间：2013-01-04T18:37:23.470
> 
> 标签：c#, winforms

目前这是相当重复的。我正在寻找一种更干燥的方法来处理这个问题，但我发现的每个解决方案并没有更好。问题是我是否希望事件作用于父 SearchResultItem。例如，如果标签位于父控件的最边缘，则父控件永远不会看到鼠标离开或进入，如果它发生在该子标签内。所以我也是每个孩子的方法。但是，如果添加了一个孩子，我必须记住并为我拥有的每个事件添加它。还会有双击和单击事件。你知道这样做的更好方法吗？

这是我的代码，经过简化以显示相关的内容：

```
public partial class SearchResultItem : UserControl
{
    public SearchResultItem()
    {
        SetupForm();
    }

    private void SetupForm()
    {
        //Setup the back color change on mouse enter
        SetupMouseEnter();
        //Setup the original back color when mouse leave
        SetupMouseLeave();
    }

    private void SetupMouseLeave()
    {
        this.MouseLeave += SearchResultItem_MouseLeave;
        this.lblRight.MouseLeave += SearchResultItem_MouseLeave;
        this.lblBottom.MouseLeave += SearchResultItem_MouseLeave;
        this.lblColor.MouseLeave += SearchResultItem_MouseLeave;
        this.lblTop.MouseLeave += SearchResultItem_MouseLeave;
        this.picture.MouseLeave += SearchResultItem_MouseLeave;
    }

    void SearchResultItem_MouseLeave(object sender, EventArgs e)
    {
        this.BackColor = Color.FromKnownColor(KnownColor.Control);
    }

    private void SetupMouseEnter()
    {
        this.MouseEnter += SearchResultItem_MouseEnter;
        this.lblRight.MouseEnter += SearchResultItem_MouseEnter;
        this.lblBottom.MouseEnter += SearchResultItem_MouseEnter;
        this.lblColor.MouseEnter += SearchResultItem_MouseEnter;
        this.lblTop.MouseEnter += SearchResultItem_MouseEnter;
        this.picture.MouseEnter += SearchResultItem_MouseEnter;
    }

    void SearchResultItem_MouseEnter(object sender, EventArgs e)
    {
        this.BackColor = Color.BlanchedAlmond;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:40:44.333

`Controls`您可以为表单集合中的每个控件添加此事件处理程序。

```
foreach (Control c in this.Controls)
{
    c.MouseLeave += SearchResultItem_MouseLeave;
} 
```

Note that if you may need this to be recursive if you need events from controls inside container controls on the form. I'm also assuming that you're not adding controls dynamically at runtime.

# foursquare - 如何找到 Foursquare 页面 USER_ID？

> ID：14162892
> 
> 赞同：0
> 
> 时间：2013-01-04T18:37:23.547
> 
> 标签：foursquare

我正在尝试使用 Foursquare Page 端点：[https ://developer.foursquare.com/docs/pages/pages](https://developer.foursquare.com/docs/pages/pages)

应该是这样的：[https ://api.foursquare.com/v2/pages/USER_ID?oauth_token=XXX](https://api.foursquare.com/v2/pages/USER_ID?oauth_token=XXX)

但是我不清楚 USER_ID 值应该是什么。例如，我想获取[https://foursquare.com/dbmagazine的页面信息](https://foursquare.com/dbmagazine)

我尝试将 USER_ID 值设置为“dbmagazine”，但我收到 400 响应，说“必须提供有效的页面 ID”。

我应该使用其他标识符吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T21:15:12.557

您需要为页面使用数字用户 ID。

要从页面的 twitter 句柄（“dbmagazine”）获取用户 ID，您可以使用[users/search](https://developer.foursquare.com/docs/users/search)端点，并将参数 twitter 设置为 dbmagazine。

# c# - 使用标准 WPF DatePicker：如何从年份开始？

> ID：14162894
> 
> 赞同：1
> 
> 时间：2013-01-04T18:37:44.593
> 
> 标签：c#, .net, xaml, datepicker

我希望下拉菜单在开始时显示年份而不是今天的日期。备注：[标准 WPF DatePicker](http://msdn.microsoft.com/en-us/library/system.windows.controls.datepicker%28v=vs.100%29.aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-1)没有“DisplayMode”，如其他来源所示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:47:22.483

```
dateTimePicker1.Format = DateTimePickerFormat.Custom;    
dateTimePicker1.CustomFormat = "YYYY dd, mmmm - dddd"; 
```

或者：

```
dateTimePicker1.Format = DateTimePickerFormat.Custom;    
dateTimePicker1.CustomFormat = "YYYY mm, dddd - dddd"; 
```

如需更详细的说明，您可以单击[此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.datetimepicker.customformat.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T13:55:32.037

非常感谢您的回答，但我找到了一个我更满意的解决方案（仅使用标准控件）

```
<DatePicker x:Name="_DatePicker" CalendarOpened="_DatePicker_CalendarOpened" />

 private void _DatePicker_CalendarOpened(object sender, RoutedEventArgs e) {
        // Finding the calendar that is child of stadart WPF DatePicker
        DatePicker datepicker = (DatePicker)sender;
        Popup popup = (Popup)datepicker.Template.FindName("PART_Popup", datepicker);
        System.Windows.Controls.Calendar cal = (System.Windows.Controls.Calendar)popup.Child;
        cal.DisplayMode = System.Windows.Controls.CalendarMode.Decade;
    } 
```

美好的一天，谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:49:28.390

如果您使用 WPF 工具包，那么

```
<toolkit:Calendar x:Name="yearCalender" DisplayModeChanged="yearCalender_DisplayModeChanged" DisplayMode="Year" /> 
```

C#代码：

```
private void yearCalender_DisplayModeChanged(System.Object sender, Microsoft.Windows.Controls.CalendarModeChangedEventArgs e)
{       
    yearCalender.DisplayMode = Microsoft.Windows.Controls.CalendarMode.Year;
} 
```

# c++ - GDIplus 闪烁

> ID：14162900
> 
> 赞同：0
> 
> 时间：2013-01-04T18:38:14.320
> 
> 标签：c++, winapi, gdi+

我正在尝试在透明窗口上使用 GDIplus 进行绘制并遇到很多闪烁。我已经阅读了很多建议实现双缓冲或渲染到屏幕外表面的线程会有所帮助，我已经这样做了，但无济于事。

知道我做错了什么以及如何解决吗？谢谢。

```
#include <Windows.h>
#include <stdio.h>
#include <time.h>
#include <GdiPlus.h>

#pragma comment(lib, "GdiPlus.lib")

HWND hWnd = NULL;
WNDCLASSEX wcex;
HDC hdc = NULL;
PAINTSTRUCT ps;
HGDIOBJ hfDefault;
MSG msg;
COLORREF transKey = RGB(37,14,103);
ULONG_PTR m_gdiplusToken;

char window_title[9] = "testings";
char window_class[9] = "testings";

int window_width = GetSystemMetrics(SM_CXSCREEN);
int window_height = GetSystemMetrics(SM_CYSCREEN);

DWORD MainThread(LPVOID lpArgs)
{
    while(1)
    {
        RECT rc = {0,0,window_width,window_height};
        InvalidateRect(hWnd, &rc, false);
        UpdateWindow(hWnd);
        Sleep(50);
    }
}

LRESULT CALLBACK WndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    if(msg == WM_CREATE)
    {
        hfDefault = (HFONT)GetStockObject(DEFAULT_GUI_FONT);

        Gdiplus::GdiplusStartupInput gdiplusStartupInput;
        Gdiplus::GdiplusStartup(&m_gdiplusToken, &gdiplusStartupInput, NULL);

        SetLayeredWindowAttributes(hWnd, transKey, 128, LWA_COLORKEY);
    }
    else if(msg == WM_PAINT)
    {
        hdc = BeginPaint(hWnd, &ps);

        Gdiplus::Graphics g(hdc);

        g.Clear(Gdiplus::Color(37,14,103));

        Gdiplus::Bitmap* curBitmap = new Gdiplus::Bitmap(window_width, window_height);
        Gdiplus::Graphics* g1 = g.FromImage(curBitmap);

        static int x=1,y=1;
        // x += 3;
        y += 2;

        Gdiplus::Pen pen(Gdiplus::Color(255, 255, 0, 255));

        g1->DrawLine(&pen, x, y, window_width/2, window_height/2);

        g.DrawImage(curBitmap, 0, 0);

        EndPaint(hWnd, &ps);
    }
    else if(msg == WM_CLOSE)
    {
        DestroyWindow(hWnd);
    }
    else if(msg == WM_DESTROY)
    {
        PostQuitMessage(0);
    }
    else
    {
        return DefWindowProc(hWnd, msg, wParam, lParam);
    }

    return 0;
}

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{
    HBRUSH hbrBackground = CreateSolidBrush(transKey);

    wcex.cbSize        = sizeof(WNDCLASSEX);
    wcex.style         = CS_HREDRAW | CS_VREDRAW;
    wcex.lpfnWndProc   = WndProc;
    wcex.cbClsExtra    = 0;
    wcex.cbWndExtra    = 0;
    wcex.hInstance     = hInstance;
    wcex.hIcon         = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_APPLICATION));
    wcex.hCursor       = LoadCursor(NULL, IDC_ARROW);
    wcex.hbrBackground = hbrBackground;
    wcex.lpszMenuName  = NULL;
    wcex.lpszClassName = window_class;
    wcex.hIconSm       = LoadIcon(wcex.hInstance, MAKEINTRESOURCE(IDI_APPLICATION));

    if(!RegisterClassEx(&wcex))
        return 1;

    hWnd = CreateWindowEx(
        WS_EX_LAYERED | WS_EX_TRANSPARENT | WS_EX_TOPMOST,
        window_class,
        window_title,
        WS_POPUP,
        0,
        0,
        window_width,
        window_height,
        NULL,
        NULL,
        hInstance,
        NULL
    );

    if(!hWnd)
        return 1;

    ShowWindow(hWnd, nCmdShow);
    UpdateWindow(hWnd);

    CreateThread(NULL, NULL, (LPTHREAD_START_ROUTINE)MainThread, NULL, NULL, NULL);

    while(GetMessage(&msg, NULL, 0, 0) > 0)
    {
        TranslateMessage(&msg);
        DispatchMessage(&msg);
    }

    Gdiplus::GdiplusShutdown(m_gdiplusToken);
    return msg.wParam;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:04:11.200

您的窗口上有该`WS_EX_TRANSPARENT`属性，这会导致其下方的窗口在每次您的窗口无效时重新绘制。尝试删除它。

的意思`WS_EX_TRANSPARENT`是告诉 Windows 你不会在整个窗口表面上绘图（即保持部分透明），因此它需要确保首先渲染下面的所有内容，以便它可以显示出来。

# iphone - 如何将 UIView 拖入表头

> ID：14162901
> 
> 赞同：1
> 
> 时间：2013-01-04T18:38:21.340
> 
> 标签：iphone, ios, uitableview, uiview

我正在阅读这本书：**开始 iOS 5 开发。** 其中一个例子是将 UIView 拖到 UITableView 的表头中

我试过很多次，无论我如何将我的 UIView 拖到 UITableView 上方，UIView 都不适合表头。它只是看起来像一个大矩形。

![在此处输入图像描述](../Images/7dd8c96024052d94a5777c44cc358d36.png) ![在此处输入图像描述](../Images/91aabef87296ee3b75cac2150a4cd882.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:59:49.837

当您将视图拖动到列表（占位符、对象）中的“表格视图”下方时，它应该被插入到那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T19:50:30.903

做一件事，在笔尖中选择您的表格，然后转到其属性。转到笔尖中的尺寸检查器，选择表格视图大小，您需要更改部分高度，假设您将其设为 80 像素，现在您可以将视图放在那里并将其高度也设为 80。并更改视图的框架以将其正确定位在表格视图标题上。你也可以从你的笔尖做希望它会帮助你。

谢谢萨比

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T01:19:16.953

我已经解决了我的问题。答案有点棘手，我看不到和书上显示的一样的效果，可能是界面生成器有一点变化。我只能看到桌子顶部的**一条小蓝线。**

**视图不能直接拖到表头中。**

1.  将 UIView 拖到视图中。
2.  将视图拖到表格上方/将其拖到左侧对象列表中的表格内。
3.  将视图大小调整为表头的高度

**请注意对象层次结构。**

![第一步](../Images/8cf091748fb4aa566afd69a4f19da350.png) ![第二步](../Images/f517a6f0880482e6625643cf40323c02.png) ![第三步](../Images/c2a7f1a156ef087e9ff9c99a7a8f7d46.png)

# ruby - 你如何在 ruby 中计算这样的公式？

> ID：14162904
> 
> 赞同：0
> 
> 时间：2013-01-04T18:38:40.923
> 
> 标签：ruby, math

我可以用笔和纸来做，但我很难尝试在 ruby​​ 中构建方法来计算像下面这样的简单公式。

![公式](../Images/837d4caf6ed42bbb2e92ba787ce82f95.png)

如何在 ruby​​ 中构建一个返回 CET 的方法？

（为了更容易考虑（dj-d0）/365 等于 j）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:52:59.497

如果您知道要使用的结构，这几乎可以直接翻译成 Ruby：

```
sum = (1..n).inject(0) do |s, j|
  fc[j] / ((1 + cet) ** (d[j] - d[0]) / 365) - fc[0]
end 
```

如果你想*解决*什么问题，那就是另一回事了。您可能想尝试 Mathematica。

# ios - RestKit/RestEASY -- 排队请求操作时出现 ClientAbortException

> ID：14162905
> 
> 赞同：1
> 
> 时间：2013-01-04T18:38:46.067
> 
> 标签：ios, rest, jboss, restkit, resteasy

我正在开发一个 iOS 应用程序，它将使用 RestKit 0.20 对在 JBoss AS 7.1.1 上运行的服务进行基于 REST 的调用，并使用 restEASY 作为其基于 REST 的 Web 服务框架。

客户端应用程序将调用的 REST 服务用于根据对象的唯一标识符检索对象。由于这些对象可大可小（> 1MB 大小）且数量众多（一次 20？50？100 个或更多），我不想一次调用一次大调用来检索它们。相反，我计划使用 RestKit 的排队操作支持根据对象标识符为每个对象创建一个 GET 请求，并异步执行调用。一旦 GET 完成，每个对象将通过使用 Objective-C 块进行处理，以避免任何不必要的阻塞。

我的 RestKit 客户端代码如下所示...

```
 NSArray *identifiers = ...
    RKObjectManager *objectManager = [RKObjectManager sharedManager];

    RKResponseDescriptor *getObjResp = [RKResponseDescriptor responseDescriptorWithMapping:[MyObject mapping] pathPattern:[WebServiceHelper pathForServiceOperation:@"/objects/:uniqueIdentifier"] keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];
    for (int i=0; i < identifiers.count; i++) {
        NSString *identifier = [identifiers objectAtIndex:i];
        NSURL *serviceURL = [WebServiceHelper urlForServiceOperation:[NSString stringWithFormat:@"/objects/%@", identifier]];
        NSURLRequest *request = [NSURLRequest requestWithURL:serviceURL];
        RKObjectRequestOperation *requestOp = [[RKObjectRequestOperation alloc] initWithRequest:request responseDescriptors:@[getObjResp]];

        [requestOp setCompletionBlockWithSuccess:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
            MyObject *obj = [mappingResult firstObject];
            if (self.delegate != nil) {
                [self.delegate didLoadObjectWithIdentifier:identifier myObj:obj];
            }
        } failure:^(RKObjectRequestOperation *operation, NSError *error){
            if (self.delegate != nil) {
                [self.delegate didFinishWithError:error];
            }
        }];

        [objectManager enqueueObjectRequestOperation:requestOp];
    } 
```

从那里，检索对象时调用的委托方法如下所示：

```
-(void)didLoadObjectWithIdentifier:(NSString *)identifier myObj:(MyObject *)myObj {
    if(secureMessage != nil) {
        NSLog(@"Message %@ retrieved successfully : %@:%@", identifier, myObj);
    } else {
        NSLog(@"NO OBJ");
    }
} 
```

这些调用似乎按预期运行，因为我能够打印出有关检索对象的信息。但是，我在服务端看到了一些奇怪/意外的行为。

首先，我看到 restEASY 抛出了一些异常：

```
13:22:02,903 WARN  [org.jboss.resteasy.core.SynchronousDispatcher] (http--0.0.0.0-8080-10) Failed executing GET /objects/BBFE39EA126F610C: org.jboss.resteasy.spi.WriterException: ClientAbortException:  java.net.SocketException: Broken pipe
    at org.jboss.resteasy.core.ServerResponse.writeTo(ServerResponse.java:262) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.writeJaxrsResponse(SynchronousDispatcher.java:585) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:506) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:119) [resteasy-jaxrs-2.3.2.Final.jar:]
    at org.jboss.seam.resteasy.ResteasyResourceAdapter$1.process(ResteasyResourceAdapter.java:145) [jboss-seam-resteasy.jar:2.3.0.Final]
    at org.jboss.seam.servlet.ContextualHttpServletRequest.run(ContextualHttpServletRequest.java:65) [jboss-seam.jar:2.3.0.Final]
    at org.jboss.seam.resteasy.ResteasyResourceAdapter.getResource(ResteasyResourceAdapter.java:120) [jboss-seam-resteasy.jar:2.3.0.Final]
    ... 
```

看起来好像 RestKit 正在以某种方式关闭套接字（或者其他一些错误正在阻止从服务器读取对象）。我在文档中找不到任何可以解释这里发生的事情的内容。

其次，当请求因此错误而失败时，我还看到*另一个*对同一对象的调用。为什么 GET 被多次调用？RestKit 是否重做失败的 GET 请求？

我最关心的是为什么在 restEASY 中会发生异常，因为它会使诊断真正失败的调用变得困难。有没有人见过这种行为？关于如何纠正这些问题的任何提示？谢谢你提供的所有帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T11:18:35.603

这些异常是由断开连接的客户端导致的，即一些用户可能会在等待进程完成时退出应用程序或出现网络故障（在客户端）。因此，断管。

# javascript - 停止浏览器请求

> ID：14162909
> 
> 赞同：0
> 
> 时间：2013-01-04T18:39:09.360
> 
> 标签：javascript, ajax

当点击刷新按钮时，是否可以停止页面上发生的所有请求/脚本？
我有一个需要几分钟的 $.ajax 请求。我试图在卸载事件中执行 window.stop() ；我试过 xhr = $.ajax(...); 和 xhr.abort(); 以及在互联网上找到的任何其他方法，但没有任何效果。

这甚至可能吗？为什么浏览器仍然等待该请求完成并发送回响应而不刷新页面？

**稍后编辑（已解决）：**似乎等待问题实际上来自*服务器*。如果在 ajax 调用中，脚本使用了*SESSION*，那么网页将冻结直到请求完成，即使我们中止了 xhr。

这是为什么？解释：

会话数据通常在脚本终止后存储，无需调用 session_write_close()，但由于会话数据被锁定以防止并发写入，任何时候只有一个脚本可以对会话进行操作。将框架集与会话一起使用时，由于这种锁定，您将体验到一个一个加载的框架。您可以通过在会话变量的所有更改完成后立即结束会话来减少加载所有帧所需的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T18:59:57.663

[也许像这里](https://stackoverflow.com/questions/9308336/execute-function-before-refresh)一样在刷新之前尝试取消？

```
window.onbeforeunload = function(event) {
    xhr.abort();
}; 
```

# xcode - 取消引用 Xcode 上的 void* 警告

> ID：14162914
> 
> 赞同：0
> 
> 时间：2013-01-04T18:39:32.137
> 
> 标签：xcode, compiler-errors, compiler-warnings, pointer-arithmetic

我知道[这个 SO question](https://stackoverflow.com/questions/4019671/in-c-can-i-do-arithmetic-on-void-pointers)和[这个 SO question](https://stackoverflow.com/questions/1997751/c-gcc-compiler-options-for-pointer-arithmetic-warning)。这篇文章的新颖之处在于它对 Xcode 的关注，以及它使用方括号来取消引用指向 void 的指针。

以下程序在 Xcode 4.5.2 中编译时没有警告，在 GCC 4.2 上编译时出现警告，即使我现在没有 Visual Studio，我记得它会认为这是编译器错误，MSDN 和 Internet 都同意.

```
#include <stdio.h>

int main(int argc, const char * argv[])
{
    int x = 24;

    void *xPtr = &x;
    int *xPtr2 = (int *)&xPtr[1];

    printf("%p %p\n", xPtr, xPtr2);
} 
```

如果我将 main 正文的第三行更改为：

```
int *xPtr2 = (int *)(xPtr + 1); 
```

它在 GCC 和 Xcode 上编译时都没有警告。

我想知道如何在 GDB**尤其是**Xcode/LLVM 上将这种沉默转变为警告或错误，包括函数 main 是 int 但没有显式返回任何值的事实（顺便说一下，我认为 -Wall 可以解决问题在 GDB 上）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T19:50:04.587

这根本没有错...

编译器不知道指针有多大... void[] ~~ void*
这就是为什么用作字符串的 char* 需要 \0 终止

您不能为此打开警告，因为在编译时无法确定“指针指向的内存指针的大小”

```
void *v = nil;
*v[1] = 0 //invalid

void *v = malloc(sizeof(int)*2);
*v[1] = 0 //valid 
```

*注意在 SO 上内联输入 - 抱歉任何非工作代码

# django - 对于使用 heroku 在生产中部署媒体和静态的 django 设置和 url，应该是什么样的？

> ID：14162915
> 
> 赞同：0
> 
> 时间：2013-01-04T18:39:33.317
> 
> 标签：django, heroku, amazon-s3, python-2.7, django-settings

目前，我一直在让我的静态和媒体与 heroku 上的 django 一起工作时遇到问题。我的静态终于可以工作了，但我的媒体不行，这是我在任何类型的生产环境中的第一次，所以我不确定它是否正确完成。我的媒体文件将在上传后工作，但是一旦我编辑不相关的内容并尝试将其推送到 heroku 输入，它们将不再工作：

```
git add .
git commit -m "changes"
git push heroku master 
```

因此，在我更新我的 heroku 应用程序后，用户必须重新添加他们的媒体文件才能让他们在我每次更新时都能正常工作。就我到目前为止的代码而言：

```
#settings.py
DEBUG = False
MEDIA_ROOT = 'media'
MEDIA_URL = '/media/'
STATIC_ROOT = 'static'
STATIC_URL = '/static/'
STATICFILES_DIRS = (
    'static',
)

#urls.py
urlpatterns += staticfiles_urlpatterns()

if not settings.DEBUG:
    urlpatterns += patterns('',
        (r'^static/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.STATIC_ROOT}),
        (r'^media/(?P<path>.*)$', 'django.views.static.serve', {'document_root': settings.MEDIA_ROOT}),
    ) 
```

我很不知道该怎么做，我尝试了几种不同的更改我的网址和设置，但没有任何运气。我读过其他帖子并尝试过，我读过文档，不幸的是我仍然不太明白。在开发中一切正常，但在我的设置下，我的开发项目有不同的代码。任何帮助将不胜感激。

编辑

因此，经过更多挖掘，我决定尝试使用 Amazon S3 来处理我的媒体文件。我仍然不确定如何将文件上传到 S3，但我已经创建了一个 S3 存储桶并设置了我的 heroku 设置（AWS_ACCESS_KEY_ID、AWS_SECRET_ACCESS_KEY、S3_BUCKET_NAME）。我仍然不确定我的媒体和静态设置应该是什么样子。如果有人能指出我正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:12:22.590

好的，所以在我的头撞到墙上很多之后，我终于让事情按照他们应该的方式工作了。我现在将 Amazon S3 用于我的静态和媒体文件（部分感谢[这篇](https://stackoverflow.com/questions/11380173/django-serving-static-media-fles-directly-from-heroku)文章，对我来说正确设置的最有帮助的文章是[这里](https://stackoverflow.com/questions/11569144/proper-way-to-handle-static-files-and-templates-for-django-on-heroku)。如果你使用 heroku，你可能想考虑使用 S3静态和媒体文件。是的，这是你必须尝试配置和集成的其他东西，不，它不是免费的，但如果你只是推回去，你最终可能会发现自己在使用它，所以节省一些时间。[这](https://stackoverflow.com/questions/10390244/how-to-set-up-a-django-project-with-django-storages-and-amazon-s3-but-with-diff/10825691#10825691)也有助于将静态和媒体分离到单独的目录中。

# .htaccess - robots.txt 和 .htaccess 语法高亮

> ID：14162916
> 
> 赞同：54
> 
> 时间：2013-01-04T18:39:34.503
> 
> 标签：.htaccess, sublimetext2, robots.txt

有没有办法对 robots.txt 和 .htaccess 语法进行颜色编码/突出显示？例如，使用 SublimeText2 插件。我找到了这个，但不知道如何安装它：[https ://github.com/shellderp/sublime-robot-plugin](https://github.com/shellderp/sublime-robot-plugin)

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2013-01-05T18:32:23.250

使用 Package Control 安装您要使用的语法包。如果你在没有包控制的情况下使用 Sublime Text，你会错过很多。

1.  [安装包控制](https://packagecontrol.io/installation)（按照链接的说明）
2.  重启后输入`Command`++`Shift`然后`P``Install Package`
3.  安装**ApacheConf**和你提到的**机器人框架**

可以非常轻松地添加和删除包，但可以极大地增强和个性化您可以使用 Sublime Text 执行的操作。

# postgresql - PostgreSQL 临时表缓存在内存中？

> ID：14162917
> 
> 赞同：5
> 
> 时间：2013-01-04T18:39:35.120
> 
> 标签：postgresql, session, caching, transactions, temp-tables

**上下文**：

我想将一些临时结果存储在一些临时表中。这些表可能会在几个可能及时发生的查询中重用，但在某些时候，我正在使用的进化算法可能不再需要一些旧表并继续生成新表。将有几个查询，可能同时使用这些表。只有一个用户执行所有这些查询。我不知道这是否澄清了有关会话等的所有内容，我仍然不确定它是如何工作的。

**目标**：

我想做的是创建临时表（如果它们不存在），尽可能将它们存储在内存中，如果在某些时候没有足够的内存，删除那些将提交给硬盘（我猜这些将是最近最少使用的）。

**例子**：

[客户端将对具有不同参数的EMA](https://stackoverflow.com/questions/8871426/how-to-calculate-an-exponential-moving-average-on-postgres)进行查询，并以不同的系数将它们聚合起来，每个人在使用的系数方面可能会有所不同，因此 EMA 的参数可能会重复，因为它们仍在基因库中，并且可能过一段时间就不需要了。会有更多参数的类似查询，遗传算法将为参数找到正确的值。

**问题**：

*   这就是“on commit drop”的意思吗？我看过有关会话和事务的描述，但我并不真正理解这些概念。对不起，如果这个问题很愚蠢。
*   如果不是，您是否知道让 Postgres 执行此操作的任何简单方法？

**解决方法**：

在最坏的情况下，我应该能够猜测我可以保留多少张表并尝试自己实现 LRU，但它永远不会像 Postgres 那样好。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T06:25:51.707

这是一个复杂的话题，可能需要深入讨论。我认为值得解释为什么 PostgreSQL 不支持这一点，以及你可以用最新版本做什么来接近你想要做的事情。

PostgreSQL 有一个很好的方法来缓存多个用户的不同数据集。通常，您不想让程序员指定如果临时表变得非常大，则必须将其保存在内存中。然而，临时表的管理方式与普通表完全不同，因为它们是：

1.  由单个后端缓冲，而不是共享缓冲区

2.  仅在本地可见，并且

3.  未登录。

这意味着您通常不会为临时表生成大量磁盘 I/O。这些表通常不会刷新 WAL 段，它们由本地后端管理，因此它们不会影响共享缓冲区的使用。这意味着只有偶尔才会将数据写入磁盘，并且只有在需要为其他（通常更频繁的）任务释放内存时才会写入。您当然不会强制磁盘写入，并且仅在其他东西用完内存时才需要磁盘读取。

最终结果是你真的不需要担心这个。PostgreSQL 已经在一定程度上尝试去做你要求它做的事情，并且临时表的磁盘 I/O 要求比标准表低得多。它不会强制表保留在内存中，如果它们变得足够大，页面可能会在 OS 磁盘缓存中过期，并最终在磁盘上。这是一个重要的特性，因为它确保在许多人创建许多大型临时表时性能会优雅地降低。

# php - 下面的 php 代码是否涉及任何安全风险？

> ID：14162920
> 
> 赞同：0
> 
> 时间：2013-01-04T18:39:53.463
> 
> 标签：php, security

page1.php

```
<form method="post" action="page2.php">
<textarea name="tryit" cols="!20" rows="10"></textarea>
</form> 
```

第 2.php 页

```
<?php
echo filter_input(INPUT_POST, 'tryit', FILTER_SANITIZE_SPECIAL_CHARS);
?> 
```

我只是不希望任何用户执行任何系统代码或调用任何系统函数。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:47:11.167

该代码在 XSS 方面是安全的，因为`filter_input()`使用该`FILTER_SANITIZE_SPECIAL_CHARS`标志将对 HTML 特殊字符进行编码，从而防止 XSS 漏洞。

从[手册](http://php.net/manual/en/filter.filters.sanitize.php)：

> **FILTER_SANITIZE_SPECIAL_CHARS**
> HTML-escape '"<>& 和 ASCII 值小于 32 的字符，可选择剥离或编码其他特殊字符。

它与以下内容相同：

```
echo htmlspecialchars($_POST['tryit']); 
```

如果将代码移动到另一个上下文中，例如 SQL 查询，那么它就不再安全了。特殊字符编码专门用于防止 XSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:52:13.763

此代码片段不会执行操作系统的任何功能或任何 shell 命令。

`filter_input`也不会执行任何系统功能。

`page2`只会显示`POST`as 文本收到的任何内容。

存储的值`$_POST['tryit']`不会受到影响。当您再次访问该变量（或将其 HTML 转义版本存储在某处）时，您需要单独对其进行清理。

`filter_input`不常用。您可以改用特定的转义函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T18:48:08.530

使用[htmlspecialchars](http://php.net/manual/en/function.htmlspecialchars.php)，这将替换所有特殊的 html 字符：`& ' " < >`到`&amp; &#039; &quot; &lt; &gt;`之后，它们将显示为普通字符。

# c++ - 一种无对角线运动的星型算法

> ID：14162925
> 
> 赞同：10
> 
> 时间：2013-01-04T18:40:15.247
> 
> 标签：c++, path-finding, a-star

**情况：** 我正在尝试将 A* 算法转换为不允许对角线移动的 C++ 代码，但我有一些奇怪的行为。

我的**问题**：即使没有对角线运动，是否也需要考虑对角线成本。当我在没有对角线成本的情况下进行计算时（使用“启发式”因子 10），我的 fscore 总是相同的 80（你可以在我计算 fscore、gscore 和 hscore 的第二张图片中看到这一点），这看起来真的很奇怪我。因此（几乎所有节点的 fscore 为 80），算法似乎不起作用，因为对于许多节点来说，最小的 fscore 相同，都是 80。

或者这是正常行为吗？没有对角线的 A* 星型实现是否必须执行更多工作（因为更多节点具有相同的最小 fscore）？

![对角线](../Images/fe856ee208a74d0ef602a793589b1e17.png)

![在此处输入图像描述](../Images/6200e51884d0b9e96d5c9fd75f021157.png)

我认为这个问题与我的代码无关，而是与我的推理有关，但无论如何我都会发布它：

路径查找.cpp

```
#include "pathFind.h"
#include <queue>
#include "node.h"
#include <QString>
#include <QDebug>
#include <iostream>

/** Pathfinding (A* algo) using Manhatten heuristics and assuming a monotonic, consistent
*   heuristic (the enemies do not change position)
*
*   TODO: add variable terrain cost
**/

//dimensions
const int horizontalSize = 20;
const int verticalSize = 20;

//nodes sets
static int closedNodes[horizontalSize][verticalSize]; //the set of nodes already evaluated
static int openNodes[horizontalSize][verticalSize]; // the set of nodes to be evaluated; initialy only containing start node
static int dir_map[horizontalSize][verticalSize]; //map of directions (contains parents-children connection)

//directions
const int dir=4;
static int dirX[dir]={1,0,-1,0};
static int dirY[dir]={0,1,0,-1};

//test class
static int map[horizontalSize][verticalSize]; //map of navigated nodes
pathFind::pathFind(){
    //test
    srand(time(NULL));
    //create empty map
    for (int y=0;y<verticalSize;y++){
        for (int x=0;x<horizontalSize;x++){
            map[x][y]=0;
        }
    }
    //fillout matrix
    for (int x=horizontalSize/8;x<horizontalSize*7/8;x++){
        map[x][verticalSize/2]=1;
    }
    for (int y=verticalSize/8;y<verticalSize*7/8;y++){
        map[horizontalSize/2][y]=1;
    }

    //randomly select start and finish locations
    int xA,yA,xB,yB;
    int n=horizontalSize;
    int m=verticalSize;

    xA=6;
    yA=5;

    xB = 14;
    yB = 12;

    qDebug() <<"Map Size (X,Y): "<<n<<","<<m<<endl;
    qDebug()<<"Start: "<<xA<<","<<yA<<endl;
    qDebug()<<"Finish: "<<xB<<","<<yB<<endl;

    // get the route
    clock_t start = clock();
    QString route=calculatePath(xA, yA, xB, yB);
    if(route=="") qDebug() <<"An empty route generated!"<<endl;
    clock_t end = clock();
    double time_elapsed = double(end - start);
    qDebug()<<"Time to calculate the route (ms): "<<time_elapsed<<endl;
    qDebug()<<"Route:"<<endl;
    qDebug()<<route<<endl<<endl;
}

QString pathFind::calculatePath(const int & xStart, const int & yStart,const int & xFinish, const int & yFinish){
    /** why do we maintain a priority queue?
    *   it's for maintaining the open list: everytime we acces the open list we need to find the node with the lowest
    *   fscore. A priority queue is a sorted list so we simply have to grab (pop) the first item of the list everytime
    *   we need a lower fscore.
    *
    *   A priority queue is a data structure in which only the largest element can be retrieved (popped).
    *   It's problem is that finding an node in the queue is a slow operation.
    **/
    std::priority_queue<node> pq[2]; //we define 2 priority list which is needed for our priority change of a node 'algo'
    static int index; //static and global variables are initialized to 0
    static node *currentNode;
    static node *neighborNode;
    //first reset maps
    resetMaps();

    //create start node
    static node * startNode;
    startNode= new node(xStart,yStart,0,0);
    startNode->updatePriority(xFinish, yFinish);

    // push it into the priority queue
    pq[index].push(*startNode);

    //add it to the list of open nodes
    openNodes[0][0] = startNode->getPriority();

    //A* search
    //while priority queue is not empty; continue
    while(!pq[index].empty()){
        //get current node with the higest priority from the priority list
        //in first instance this is the start node
        currentNode = new node(pq[index].top().getxPos(),
                               pq[index].top().getyPos(),
                               pq[index].top().getDistance(),
                               pq[index].top().getPriority());
        //remove node from priority queue
        pq[index].pop();
        openNodes[currentNode->getxPos()][currentNode->getyPos()]=0; //remove node from open list
        closedNodes[currentNode->getxPos()][currentNode->getyPos()]=1; //add current to closed list

        //if current node = goal => finished => retrace route back using parents nodes
        if (currentNode->getxPos()==xFinish && currentNode->getyPos()==yFinish){
            //quit searching if goal is reached
            //return generated path from finish to start
            QString path="";
            int x,y,direction; //in cpp you don't need to declare variables at the top compared to c
            //currentNode is now the goalNode
            x=currentNode->getxPos();
            y=currentNode->getyPos();
            while (!(x==xStart && y==yStart)){
                /** We start at goal and work backwards moving from node to parent
                 *  which will take us to the starting node
                **/
                direction=dir_map[x][y];
                path =(direction+dir/2)%dir+path; //we work our way back
                //iterate trough our dir_map using our defined directions
                x+=dirX[direction];
                y+=dirY[direction];
            }

            //garbage collection; the memory allocated with 'new' should be freed to avoid memory leaks
            delete currentNode;
            while (!pq[index].empty()){
                pq[index].pop();
            }
            return path;

            //return path;
        } else {
            //add all possible neighbors to the openlist + define parents for later tracing back
            //(four directions (int dir): up, down, left & right); but we want to make it
            //as extendable as possible
            for (int i=0; i<dir; i++){
                //define new x & y coord for neighbor
                //we do this because we want to preform some checks before making this neighbore node
                int neighborX = currentNode->getxPos()+dirX[i];
                int neighborY = currentNode->getyPos()+dirY[i];
                //check boundaries
                //ignore if on closed list (was already evaluted) or if unwalkable (currently not implemented)

                if (!(neighborX <0 || neighborY <0 || neighborX > horizontalSize || neighborY > verticalSize ||
                      closedNodes[neighborX][neighborY]==1)){
                    //ok -> generate neighbor node
                    neighborNode = new node (neighborX,neighborY,currentNode->getDistance(),currentNode->getPriority());
                    //calculate the fscore of the node
                    neighborNode->updatePriority(xFinish,yFinish);
                    neighborNode->updateDistance();

                    //if neighbor not in openset => add it
                    if(openNodes[neighborX][neighborY]==0){
                        //add it to open set
                        openNodes[neighborX][neighborY]=neighborNode->getPriority();
                        //add it to the priority queue (by dereferencing our neighborNode object
                        //pq is of type node; push inserts a new element;
                        //the content is initialized as a copy
                        pq[index].push(*neighborNode);
                        //set the parent to the node we are currently looking at
                        dir_map[neighborX][neighborY]=(i+dir/2)%dir;

                    //if neighbor is already on open set
                    //check if path to that node is a better one (=lower gscore) if we use the current node to get there
                    } else if(openNodes[neighborX][neighborY]>neighborNode->getPriority()) {
                        /** lower gscore: change parent of the neighbore node to the select square
                        *   recalculate fscore
                        *   the value of the fscore should also be changed inside the node which resides inside our priority queue
                        *   however as mentioned before this is a very slow operation (is going to be the bottleneck of this implemention probably)
                        *   we will have to manuall scan for the right node and than change it.
                        *
                        *   this check is very much needed, but the number of times this if condition is true is limited
                        **/

                        //update fscore inside the open list
                        openNodes[neighborX][neighborY]=neighborNode->getPriority();
                        //update the parent node
                        dir_map[neighborX][neighborY]=(i+dir/2)%dir;

                        //we copy the nodes from one queue to the other
                        //except the -old-current node will be ignored
                        while (!((pq[index].top().getxPos()==neighborX) && (pq[index].top().getyPos()==neighborY))){
                            pq[1-index].push(pq[index].top());
                            pq[index].pop();
                        }
                        pq[index].pop(); //remove the -old-current node

                        /** ?? **/
                        if(pq[index].size()>pq[1-index].size()){ //??? is this extra check necessary?
                            index=1-index; //index switch 1->0 or 0->1
                        }

                        while(!pq[index].empty()){
                            pq[1-index].push(pq[index].top());
                            pq[index].pop();
                        }
                        /** ?? **/

                        index=1-index; //index switch 1->0 or 0->1
                        pq[index].push(*neighborNode); //and the -new-current node will be pushed in instead
                    } else delete neighborNode;

                }
            }

            delete currentNode;
        }

    } return ""; //no path found
}

void pathFind::resetMaps(){
    for (int y=0;y<horizontalSize;y++){
        for (int x=0;x<verticalSize;x++){
            closedNodes[x][y]=0;
            openNodes[x][y]=0;
        }
    }
} 
```

节点.cpp

```
#include "node.h"
#include <stdio.h>
#include <stdlib.h>

/** constructor **/
node::node(int x,int y, int d,int p)
{
    xPos=x;
    yPos=y;
    distance=d;
    priority=p;
}

/** getters for variables **/
//current node xPosition
int node::getxPos() const {
    return xPos;
}

//current node yPosition
int node::getyPos() const {
    return yPos;
}

//gscore
int node::getDistance() const {
    return distance;
}

//fscore
int node::getPriority() const {
    return priority;
}

/** Updates the priority; the lower the fscore the higer the priority
 *  the fscore is the sum of:
 *  -path-cost (gscore) (which is the distance from the starting node to the current node)
 *  -heuristic estimate (hscore) (which is an estimate of the distance from the current node to the destination node)
 *
**/
void node::updatePriority(const int & xDest, const int & yDest){
    priority = distance + estimateDistance(xDest,yDest)*10;
}

void node::updateDistance(){//const int & direction
    distance +=10;
}

/** Estimate function for the remaining distance to the goal
*   here it's based on the Manhattan distance;
*   which is the distance between two points in a grid based on a strictly horizontal & veritcal path;
*   => sum of vertical & horizontal components
**/
const int & node::estimateDistance(const int & xDest, const int & yDest) const{
    static int xDistance,yDistance,totalDistance;
    xDistance=xDest-xPos;
    yDistance=yDest-yPos;

    totalDistance=abs(xDistance)+abs(yDistance);

    return (totalDistance);
}

/** class functor (I think) to compare elements using:
 *  operator overloading: "<" gets overloaded which we are going to use in our priority queue
*   to determine priority of a node in our queue;
*   returns true if node a has a lower fscore compared to node b
*
*   there is an ambiguity here: < -- >; better to make both >
*   also prototype is now friend which could probably be replaced with this for the first
*   argument; it advantage is that because of the friend function the operand order can be reversed
*   this doesn't really looks to favor our application; so should I use it or not?
**/
bool operator<(const node & a, const node & b){
    return a.getPriority() > b.getPriority();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T19:59:16.740

我认为您的算法没有问题，如果没有可用的对角线运动，则无需考虑。曼哈顿距离是一种简单的启发式方法，当您靠近目标节点时，H 函数会给出较小的数字，但 G 函数（从第一个节点到此处的距离）会变大。结果，许多节点具有相同的 f 分数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T20:10:25.317

A* 是完全通用的——你给它的图形可以是任何形状。它只关心你是否可以从 X 转到 Y，而不关心为什么。如果不允许对角线移动，它不关心。许多节点具有相同的分数是非常好的和合法的`f`——事实上，这是意料之中的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T12:00:32.433

我认为无论您在其中选择一个具有相同 f 分数 Bcz 的方块有多少并不重要。正如 A* 的主要算法中所说，“为了速度，选择你添加到打开列表中的最后一个会更快”。如果您不考虑对角线成本，我希望这不会是一个问题。它如何给出结果似乎很有趣。

我希望你已经阅读了这篇文章。如果没有看清楚。

# java - 首先调用哪个监听器来处理事件

> ID：14162928
> 
> 赞同：-4
> 
> 时间：2013-01-04T18:40:24.227
> 
> 标签：java, actionlistener

当添加两个或多个对象作为同一事件的侦听器时，首先调用哪个侦听器来处理该事件？首先添加的侦听器或最后添加的侦听器。我所说的事件是指 AWT 事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:53:09.023

在 Swing 中，这些通常使用`EventListenerList`保留插入顺序的对象（它们由数组支持）来实现。但是，这并不意味着将按该顺序调用侦听器。例如，这是以下实现`AbstractButton`：

```
protected void fireStateChanged() {
    // Process the listeners last to first, notifying
    // those that are interested in this event
    for (int i = listeners.length-2; i>=0; i-=2) {
       //etc.
    }
} 
```

所以在这种情况下，它实际上是以相反的顺序处理的。该代码符合[EventListenerList 的文档，](http://docs.oracle.com/javase/7/docs/api/javax/swing/event/EventListenerList.html)该文档给出了类似的示例。

向后遍历它的原因将在[另一篇文章](https://stackoverflow.com/questions/1559488/why-is-eventlistenerlist-traversed-backwards-in-firefooxxx)中讨论。

所有这些显然是特定于实现的，不应依赖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T18:43:45.677

我相信[这](https://stackoverflow.com/questions/4760267/java-swing-multiple-event-listeners-for-a-single-event-source-in-a-single-thread)就是你要找的。简而言之，射击顺序是不确定的。如果您希望确保特定顺序，可以尝试仅添加一个侦听器，然后按所需顺序将事件传递给您的其他侦听器。

# android - 自定义操作栏

> ID：14162933
> 
> 赞同：0
> 
> 时间：2013-01-04T18:40:36.877
> 
> 标签：android, android-actionbar

有人有使用 Android ActionBar 的经验吗？我目前正在从事一个涉及我必须使用操作栏的项目，但是我遇到了很多困难。

目前我正在尝试创建类似于下图的内容：

![在此处输入图像描述](../Images/ffc8e6c9732c38c517c80d25cf33fa01.png)

我使用 ms paint 在标有红色圆圈的项目中绘制。有人知道我如何实现这一目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T19:09:51.093

您可以使用自定义视图（上述视图的布局）并使用 setCustomView 函数将其设置为您的 ActionBar。

# javascript - jQuery ie8 attr 性能不佳

> ID：14162938
> 
> 赞同：3
> 
> 时间：2013-01-04T18:40:47.203
> 
> 标签：javascript, jquery

“我有一些类似于下面的html包含在一个循环中，其中父ID是动态生成的，

```
<t:loop>
    <div id="demoid-10132165498794631" class="lineItem-container">
        <div>
            <select/>
        </div>
    </div>
</t:loop> 
```

我正在尝试获取包含类 lineItem-container 的父元素的 id。

我正在使用以下脚本来获取 id，

```
var id = $("select").parents(".lineItem-container").attr("id").substring(6); 
```

html 可能会循环多达 1000 次，这会导致 ie8 的性能非常差。我的假设是性能问题是由 attr 选择器引起的。

来自 IE8 的 JS 日志

```
Function    Count   Inclusive Time (ms) Inclusive Time %    Exclusive Time (ms) Exclusive Time %    Avg Time (ms)   Max Time (ms)   Min Time (ms)

attr    431,334 21,609.38   12.65   14,406.25   8.43    0.05    2,234.38    0
attr    431,382 20,265.63   11.86   12,203.13   7.14    0.05    31.25   0
ATTR    239,906 20,531.25   12.02   9,125.00    5.34    0.09    8,156.25    0
attr    241,475 11,531.25   6.75    7,312.50    4.28    0.05    31.25   0 
```

有人对如何加快这个过程有任何建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T18:46:40.900

不要将 attr 选择器用于像 id 这样简单的事情。

替换`.attr("id")`为`[0].id`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:44:11.073

尝试[`.closest()`](http://api.jquery.com/closest/)

它将获得**最近的祖先**，而不是`all the parents for the element`可能消除额外开销的祖先。

```
var id = $("select").closest(".lineItem-container").attr("id").substring(6); 
```

# android - 使用地图来确定应用程序的其他用户？

> ID：14162940
> 
> 赞同：0
> 
> 时间：2013-01-04T18:40:56.990
> 
> 标签：android, gps, maps, location

我似乎找不到任何关于此的谷歌搜索，我基本上想使用谷歌地图 API，并让它注释其他使用这个应用程序的人？

我已经使用北极星实现了地图，并且可以添加标记，但是，我对如何实现这一点感到困惑？

# c# - 收藏已修改；枚举操作可能不在线程中执行

> ID：14162941
> 
> 赞同：-2
> 
> 时间：2013-01-04T18:41:06.220
> 
> 标签：c#, error-handling, enumeration

我真的无法深入了解这个错误，它可能是可见的，但需要一双额外的眼睛！

```
try
{
    while (Program.Alive)
    {
        List<Session> ToDispose = new List<Session>();
        List<Session> ToStop = new List<Session>();

        lock (mSessions)
        {
            lock (mSessionsToStop)
            {
                foreach (uint SessionId in mSessionsToStop)
                {
                    if (mSessions.ContainsKey(SessionId))
                    {
                        ToStop.Add(mSessions[SessionId]);
                    }
                }

                mSessionsToStop.Clear();
            }

            foreach (Session Session in mSessions.Values)
            {
                if (ToStop.Contains(Session))
                {
                    continue;
                }

                if (Session.Stopped)
                {
                    if (Session.TimeStopped > 15)
                    {
                        ToDispose.Add(Session);
                    }

                    continue;
                }
            }
        }

        if (ToStop.Count > 0)
        {
            using (SqlDatabaseClient MySqlClient = SqlDatabaseManager.GetClient())
            {
                foreach (Session SessionStop in ToStop)
                {
                    SessionStop.Stop(MySqlClient);
                }
            }
        }

        foreach (Session SessionDispose in ToDispose)
        {
            SessionDispose.Dispose();

            lock (mSessions)
            {
                if (mSessions.ContainsKey(SessionDispose.Id))
                {
                    mSessions.Remove(SessionDispose.Id);
                }
            }
        }

        Thread.Sleep(70);
    }
}
catch (Exception e)
{
    Output.WriteLine("[ExecuteMonitor.Error] " + e.Message, OutputLevel.CriticalError);
} 
```

它在一个单独的线程中运行，我们总是收到有关 Collection 已修改的错误；枚举操作可能无法执行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:57:02.870

在此代码示例中枚举时，我没有看到任何编辑。

您是否 100% 确定您不会忘记`lock`您的非局部变量？

编辑`mSessions`或`mSessionsToStop`在锁之外会导致您描述的异常。

# php - php重定向到变量（如果存在）

> ID：14162943
> 
> 赞同：-4
> 
> 时间：2013-01-04T18:41:14.540
> 
> 标签：php, redirect

下午！我正在尝试检查从 post 变量接收到的 URL 是否存在，以及它是否确实将用户发送到那里。如果不重定向到其他地方......我写了这个但由于某种原因不起作用，

有任何想法吗？干杯

```
<?php>
$file = $_POST["code"];
$file_headers =                   
@get_headers('http://example.co.uk/' $file);
if($file_headers[0] == 'HTTP/1.1 404 Not Found') {
/* does not exist
header('Location: http://example.co.uk/?exists=false');
echo $file 'not found';
}
else {
/* exists
header('Location: http://example.co.uk/' $file);
echo $file 'found';
};
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T18:43:05.540

您使用错误的评论。它是`//`而**不是** `/*`在做单行评论时。

正如您从降价显示中看到的那样，您的代码的整个结尾当前已被*注释掉*，您的脚本将出现错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-12T08:05:00.217

尝试这样做：

```
$file = 'http://www.domain.com/somefile.jpg';
$file_headers = @get_headers($file);
if($file_headers[0] == 'HTTP/1.1 404 Not Found') {
    $exists = false;
}
else {
    $exists = true;
} 
```

# javascript - winrt，javascript，来自字节数组的图像

> ID：14162945
> 
> 赞同：2
> 
> 时间：2013-01-04T18:41:21.850
> 
> 标签：javascript, image, windows-8

我有一个 C++/CX 组件，它可以将图像作为流返回（我可以很容易地让它返回一个 IBuffer，如果这让事情变得更容易的话）。目前，组件的返回类型是 IRandomAccessStream，实际流是 InMemoryRandomAccessStream。

我想将此流用作 HTML/JavaScript Windows 8 应用程序中的图像源。问题是我不知道如何将这个流或我可以从中创建的数组推送到图像中。我尝试了一些东西，但例如 URL.createObjectURL 不只需要一个 IRandomAccessStream，它需要一个 IRandomAccessStreamWithContentType。我还尝试使用画布和图像数据（http://www.w3schools.com/tags/canvas_createimagedata.asp）。

我的下一步可能是尝试将我的流包装在 IRandomAccessStreamWithContentType 中，看看我是否可以做到这一点。在 JavaScript 或我的 C++/CX 控件中。

任何有关如何解决此问题的建议将不胜感激。

谢谢，托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T07:33:23.760

我之前在 C# 中没有在 C++ 中做过这个，但基础应该是相似的。

1.  从流中获取字节数组
2.  将字节数组转换为 Base64String ( [Convert.ToBase64String](http://msdn.microsoft.com/en-us/library/dhx0d524.aspx?cs-save-lang=1&cs-lang=cpp#code-snippet-1) )
3.  现在您可以直接在图像标签中使用此字符串：

`<img src="data:image/png;base64,YOUR_STRING" />`

# visual-studio-2012 - 在 Visual Studio 2012 / 2013 中使用 SSIS BIDS

> ID：14162947
> 
> 赞同：74
> 
> 时间：2013-01-04T18:41:28.377
> 
> 标签：visual-studio-2012, ssis, visual-studio-2013, bids, sql-server-data-tools

我想在 Visual Studio 2012 中使用 SSIS /BIDS 项目。

我同时安装了 Visual Studio 2010 和 Visual Studio 2012 以及 Microsoft SQL Server 2012。

首先安装了 VS 2010，然后是 MS SQL 2012，它让我的 BIDS 与 VS 2010 集成。

但是，我似乎找不到将 BIDS 与 VS 2012 集成的任何帮助。

我遇到了几个与此主题相关的 SO 问题，但它们都与 2010 年而不是 2012 年集成。

我知道使用 MS SQL 2012 我得到了一个 SQL Server 数据工具。这是否意味着 Visual Studio 2012 和 BIDS 无法集成？

**解决方案 2012：**

我不得不在这里更新解决方案，因为我收到的答案之一部分解决了这个问题。提供的[答案](https://stackoverflow.com/a/15258988/314763)确实解决了@user2141936 的问题，但我在更新现有实例时不断收到 BlockMixedArchitectureInstall 错误。

它无需创建新实例即可工作！

**旁注**：安装更新将我的发布数据库项目破坏到 2012 服务器上。您需要为它下载并安装一个 DACFramework 补丁。

**解决方案 2013：**

下载并安装[http://www.microsoft.com/en-us/download/details.aspx?id=42313](http://www.microsoft.com/en-us/download/details.aspx?id=42313)

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2013-01-04T18:55:16.083

欢迎来到 Microsoft 营销 说地狱。在 SQL Server 2012 版本中，BIDS、Business Intelligence Designer Studio、Visual Studio 插件已重命名为 SSDT、SQL Server Data Tools。SSDT 可用于 2010 年和 2012 年。问题是，有两种不同的产品称为 SSDT。

SSDT 取代了 VS 2008 中称为 Data Dude 的数据库设计器，并在 2010 年成为数据库项目。这是一个免费安装，如果你安装了 Web 安装程序，这就是你安装 SSDT 时得到的。它将正确的项目模板等放入 Visual Studio。

还有 SSDT，它是开发 SSIS、SSRS 和 SSAS 东西的“BIDS”替代品。截至 2013 年 3 月，它现在可用于 Visual Studio 2012 版。下载标记为 SSDTBI_VS2012_X86.msi 也许这表明该产品将如何在营销材料中被提及。下载链接是

*   [适用于 Visual Studio 2012 的 Microsoft SQL Server Data Tools 商业智能](http://www.microsoft.com/en-gb/download/details.aspx?id=36843)（SSIS 包面向 SQL Server 2012）
*   [适用于 Visual Studio 2013 的 Microsoft SQL Server Data Tools 商业智能](http://www.microsoft.com/en-us/download/details.aspx?id=42313)（SSIS 包面向 SQL Server 2014）

尽管如此，我们还是在 Visual Studio 2012 中为我们提供了商业智能项目。人们确实为羔羊、蟾蜍、树懒、果蝠、猩猩和早餐麦片而欢欣鼓舞

![在此处输入图像描述](../Images/94a8c2cc88039b6dacfce29c485b6baa.png)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-06T22:02:48.063

今天，2013 年 3 月 6 日，Microsoft 发布了 SQL Server Data Tools – Business Intelligence for Visual Studio 2012 (SSDT BI) 模板。使用 SSDT BI for Visual Studio 2012，您可以开发和部署 SQL Server 商业智能项目。在 Visual Studio 2010 中创建的项目可以在 Visual Studio 2012 中打开，反之亦然，无需升级或降级 - 它可以正常工作。

下载/安装的名称是为了确保您获得包含商业智能项目的 SSDT 模板。这些工具的设置现在可以从 Web 获得，并且可以在此处以多种语言下载：http: [//www.microsoft.com/download/details.aspx?id=36843](http://www.microsoft.com/download/details.aspx?id=36843)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-22T19:20:42.060

首先，我反对关于**Visual Studio 2015**的另一个问题作为重复问题。 `How do I open SSRS (.rptproj) and SSIS (.dtproj) files in Visual Studio 2015? [duplicate]`

基本上这个问题的标题是...... `Visual Studio 2012 / 2013` **VS 2015 的所有改进和变化呢？SSDT 已更新和更改。** 进行各种添加和更新的整个方式是不同的。

因此，发泄/咆哮 - 我确实打开了一个 VS 2015 更新 2 实例并继续打开一个包含`.rptproj`项目的现有解决方案。现在这台电脑上还没有安装sql server。

ME 解决方案：工具 --> 扩展和更新 --> 更新 --> `sql server tooling updates`

单击更新按钮并等待很长时间，SSDT 然后安装并关闭 Visual Studio 2015 并重新打开它对我有用。

如果由于某种原因在 VS 2015 中找不到它：滚动到底部，选择您的语言 iso [https://msdn.microsoft.com/en-us/mt186501.aspx?f=255&MSPPError=-2147217396](https://msdn.microsoft.com/en-us/mt186501.aspx?f=255&MSPPError=-2147217396)

# .net - 在 VisualStudio 中禁用迁移报告

> ID：14162948
> 
> 赞同：16
> 
> 时间：2013-01-04T18:41:33.617
> 
> 标签：.net, visual-studio, visual-studio-2013, migration, projects-and-solutions

## 设想

我通常会下载很多 3rd 方源代码来检查它们并学习新事物。

## 问题

我使用的是 VS2013，每次打开旧的 Visual Studio 解决方案时，它都会自动升级项目，然后在我的默认 Web 浏览器上显示一个 html 报告。

## 问题

是否有**自动**禁用报告的方法？（不是迁移操作，只是报告）

我在 Visual Studio 中没有找到任何禁用报告的选项，但如果通过注册表设置该东西以破解它以完全禁用 Web 浏览器报告或在记事本中打开报告文件，也许可以研究其他方法例子？。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-04-16T22:14:37.203

据我所知，在较新版本的 Visual Studio（不是向后兼容版本）中打开旧解决方案时，无法禁用升级日志。

但是，如果您打开开发人员命令提示符并运行：

```
C:\dev\proj>devenv /upgrade thesolution.sln 
```

然后它将执行升级，而不会导致升级日志实际打开。

然后你只需要等待VS加载。我不确定这里的两个邪恶中哪个是较小的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-21T04:33:23.970

这个问题有一个解决方法。您需要编辑您的`.csproj`文件。

打开您的 .csproj 文件并找到以下元素：

```
<FileUpgradeFlags>0</FileUpgradeFlags> 
```

删除此标志的值并将其留空，您将不会获得迁移报告。如果值不为 0，则必须删除任何值。

# python - 龙卷风生成器引擎中的内存泄漏，当连接关闭时，try/finally 阻塞

> ID：14162950
> 
> 赞同：5
> 
> 时间：2013-01-04T18:41:43.233
> 
> 标签：python, memory-leaks, generator, tornado, try-finally

`gen`当连接关闭而不读取响应时，这个很棒的代码显示了龙卷风模块中的内存泄漏：

```
import gc
from tornado import web, ioloop, gen

class MainHandler(web.RequestHandler):
    @web.asynchronous
    @gen.engine
    def get(self):
        gc.collect()
        print len(gc.garbage)  # print zombie objects count
        self.a = '*' * 500000000  # ~500MB data
        CHUNK_COUNT = 100
        try:
            for i in xrange(CHUNK_COUNT):
                self.write('*' * 10000)  # write ~10KB of data
                yield gen.Task(self.flush)  # wait for reciever to recieve
            print 'finished'
        finally:
            print 'finally'

application = web.Application([
    (r"/", MainHandler),
    ])

application.listen(8888)
ioloop.IOLoop.instance().start()
```

现在，多次运行一个简单的测试客户端

```
#!/usr/bin/python
import urllib
urlopen('http://127.0.0.1:8888/')  # exit without reading response 
```

现在，服务器输出显示，内存使用量增加：

```
0
WARNING:root:Write error on 8: [Errno 104] Connection reset by peer
1
WARNING:root:Read error on 8: [Errno 104] Connection reset by peer
WARNING:root:error on read
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/iostream.py", line 361, in _handle_read
    if self._read_to_buffer() == 0:
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/iostream.py", line 428, in _read_to_buffer
    chunk = self._read_from_socket()
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/iostream.py", line 409, in _read_from_socket
    chunk = self.socket.recv(self.read_chunk_size)
error: [Errno 104] Connection reset by peer
2
ERROR:root:Uncaught exception GET / (127.0.0.1)
HTTPRequest(protocol='http', host='127.0.0.1:8888', method='GET', uri='/', version='HTTP/1.0', remote_ip='127.0.0.1', body='', headers={'Host': '127.0.0.1:8888', 'User-Agent': 'Python-urllib/1.17'})
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/web.py", line 1021, in _stack_context_handle_exception
    raise_exc_info((type, value, traceback))
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/web.py", line 1139, in wrapper
    return method(self, *args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/gen.py", line 120, in wrapper
    runner.run()
  File "/usr/local/lib/python2.7/dist-packages/tornado-2.4.1-py2.7.egg/tornado/gen.py", line 345, in run
    yielded = self.gen.send(next)
  File "test.py", line 10, in get
    self.a = '*' * 500000000
MemoryError
ERROR:root:500 GET / (127.0.0.1) 3.91ms 
```

如果设置`CHUNK_COUNT`为 1，则 10KB 的数据可以写入 OS 连接缓冲区，并且 'finished' 和 'finally' 文本将打印到控制台，并且由于生成器已完成，因此不会发生内存泄漏。

**但奇怪的**是，如果你删除 try/finally 块，问题就消失了！！（即使`CHUNK_COUNT`设置为 100）

这是 CPython 或龙卷风上的错误还是...？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-14T08:16:20.677

此错误使用 Tornado 2.4.1（提出此问题时的最新版本）进行了测试，并在[https://github.com/facebook/tornado/issues/660](https://github.com/facebook/tornado/issues/660)上报告。

该问题在提交[https://github.com/facebook/tornado/commit/769bc52e11656788782a6e7a922ef646503f9ab0](https://github.com/facebook/tornado/commit/769bc52e11656788782a6e7a922ef646503f9ab0)中修复并包含在 Tornado 3.0 中。

# javascript - AngularJS 服务器和客户端表单验证

> ID：14162951
> 
> 赞同：3
> 
> 时间：2013-01-04T18:41:53.073
> 
> 标签：javascript, mvvm, validation, angularjs

在 AngularJS 中结合客户端验证和服务器端验证时遇到了一些麻烦。这是HTML：

```
<form class="form-login" name="loginForm" novalidate ng-submit="login()">
    <fieldset>
        <h2>Login</h2>
        <input type="text" required class="input-block-level" placeholder="Username" ng-model="username" name="username">
        <div ng-show="loginForm.username.$dirty && loginForm.username.$invalid">
            <span ng-show="loginForm.username.$error.required">Username required.</span>
        </div>
        <input type="password" required class="input-block-level" placeholder="Password" ng-model="password" name="password">
        <div ng-show="loginForm.password.$dirty && loginForm.password.$invalid">
            <span ng-show="loginForm.password.$error.required">Password required.</span>
        </div>
        <div ng-show="loginForm.username.$dirty && loginForm.password.$dirty && loginForm.$invalid">
            <span>Invalid username or password</span>
        </div>
        <p><a href="#forgotPassword" data-toggle="modal" class="btn btn-link">Forgot password?</a></p>
        <p><button class="btn btn-primary btn-large" ng-disabled="loginForm.$invalid" type="submit">Login</button></p>
    </fieldset>
</form> 
```

...这是登录功能：

```
$scope.login = function() {
    $http.post('url', {
        "password": $scope.password
    }).success(function(data, status, headers, config) {
        console.log(status);
        console.log(data);
    }).error(function(data, status, headers, config) {
        if (404 === status) {
            $scope.loginForm.$invalid = true;
        }
    });
    return false;
} 
```

客户端验证工作正常，直到我提交表单并返回 404 状态。当返回 404 状态时，会显示 loginForm.$invalid 错误，但当我再次更改用户名和密码输入时，客户端验证不会将表单状态更改回有效状态。

是否有一种标准方法可以以相同的形式进行这种客户端+服务器端验证？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T22:25:52.547

我认为您不应该修改表单`$invalid`或`$valid`直接修改。你应该通过`$setValidity(validationErrorKey, isValid)`.

为什么不将“无效的用户名/密码”状态存储在单独的范围属性中？

```
$scope.login = function() {
    $http.post('url', {
        "password": $scope.password
    }).success(function(data, status, headers, config) {
        console.log(status);
        console.log(data);
    }).error(function(data, status, headers, config) {
        if (404 === status) {
            $scope.invalidUsernamePassword = true; // <--------------
        }
    });
    return false;
} 
```

而且模板会更简单：

```
<div ng-show="invalidUsernamePassword">
    <span>Invalid username or password</span>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T20:30:08.003

这是一个很好的服务器端验证指令，可能有用[https://groups.google.com/forum/#!msg/angular/6v-AillQboI/D0OaZzV7Me0J](https://groups.google.com/forum/#!msg/angular/6v-AillQboI/D0OaZzV7Me0J)

# php - 如何使用 jquery load() 和 zend 框架加载 html 文件？

> ID：14162953
> 
> 赞同：1
> 
> 时间：2013-01-04T18:42:05.663
> 
> 标签：php, javascript, ajax, zend-framework, load

我有一个 jquery ajax 函数，例如：

```
$(".content").load("test-content.phtml", function() {
    //some logic
}); 
```

和我的 zend 框架模块：

```
content
    - controllers
        - TestController.php
            - public function testContentAction(){}
    - views
        - scripts
            - test
               - test-content.phtml 
```

我的问题是如何告诉`load()`函数从哪里`test-content.phtml`加载内容。

我必须`content/test/test-content`从我的控制器调用该函数吗？

另外，我知道`AjaxContext`框架中有一个助手，但我需要使用 ajax 加载这个文件。

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T18:52:00.860

该 .phtml 文件应由控制器呈现，然后您的加载函数应将操作 url 作为参数。

```
$(".content").load("url/to/controllerAction"); 
```

# map - Dart encodeUriComponent Map.keys()

> ID：14162955
> 
> 赞同：0
> 
> 时间：2013-01-04T18:42:09.277
> 
> 标签：map, urlencode, dart

我在许多地方都看到了一个用于对 Map 进行编码的示例，如下所示：

```
#import('dart:uri');
String encodeMap(Map data) {
    return Strings.join(data.getKeys().map((k) {
        return "${encodeUriComponent(k)}=${encodeUriComponent(data[k])}";
    }), "&");
} 
```

在上面的示例中，我正在运行似乎是最新的 Dart 编辑器（版本 0.2.9_r 16323），对于 Dart M2，我相信它`data.getKeys()`已更改为`data.keys()`我已更改的内容。

但是，在编辑器中运行它时出现错误：

> 异常：NoSuchMethodError：找不到方法：'调用'"

我有两个问题：

*   我想知道上面的代码是否仍应在 M2 中使用指示的更改（Map.keys（））？
*   我想知道上面的代码是否与以下代码有所不同： JSON.stringify(data);

欢迎任何其他指针。

TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:22:17.203

要做的两个改变：

*   `import`语法发生了变化。
*   `getKeys()`方法变成了一个叫做`keys`.

一个工作版本：

```
import 'dart:uri';

String encodeMap(Map data) {
    return Strings.join(data.keys.map((k) {
        return "${encodeUriComponent(k)}=${encodeUriComponent(data[k])}";
    }), "&");
} 
```

正如您在下面的代码片段中看到的那样，由此生成的与由`String`生成的`encodeMap`完全不同：`JSON.stringify`

```
main() {
  final map = {"a":"b", "c":"d"};
  assert(encodeMap(map) == "a=b&c=d");
  assert(JSON.stringify(map) == '{"a":"b","c":"d"}');
} 
```

# java - 如何在“更新”按钮单击时更新存储在对象中的值 - Android？

> ID：14162961
> 
> 赞同：0
> 
> 时间：2013-01-04T18:42:35.417
> 
> 标签：java, android

**我有以下用于 android 应用程序的类。**

```
public class AccountVO
{

    private String id;
    private String username;
    private String password;
    private String email;
    private String firstName;
    private String lastName;

    public AccountVO(String tempID, String tempUserName, String tempPassword, String tempEmail, String tempFirstName, String tempLastName)
    {
        this.id = tempID;
        this.username = tempUserName;
        this.password = tempPassword;
        this.email = tempEmail;
        this.firstName = tempFirstName;
        this.lastName = tempLastName;
    }

    public String getId()
    {
        return id;
    }

    public String getUserName()
    {
        return username;
    }

    public String getEmail()
    {
        return email;
    }

    public String getFirstName()
    {
        return firstName;
    }

    public String getLastName()
    {
        return lastName;
    }
} 
```

**我在活动中创建以下对象。**

```
AccountVO userAccount = new AccountVO("1", "scott", "password", "scott@mail.com", "Scott", "James");
AccountVO userAccount2 = new AccountVO("2", "john", "password", "jsmith@mail.com", "John", "Smith"); 
```

**我有另一个活动，我从上面创建的对象中检索值并将它们显示在 EditText 字段中。假设我更改了字段中的数据并单击“更新”按钮，谁能告诉我如何更新旧 AccountVO 对象中的值？例如：如果我通过“userAccount”AccountVO 对象（例如 scott@abc.com）中的 edittitext 字段更改电子邮件，如何在同一对象中更新该值？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:47:40.813

为您拥有 getter 的每个字段编写一个 setter，如下所示：

```
public void setLastName(String lastName) {
    this.lastName = lastName;
} 
```

然后，在 Update 函数中调用 setter：

```
public void Update() { 
    userAccount.setLastName(editText.getText().toString());
} 
```

# php - 如何建立一个多语种网站

> ID：14162963
> 
> 赞同：1
> 
> 时间：2013-01-04T18:42:40.280
> 
> 标签：php, internationalization, multilingual

我正在尝试创建一种简单的方法来设置具有两种语言的多语言网站-一种是默认语言，另一种是用户可以切换到的语言。

我想通过在每个页面上加载两种语言来做到这一点，但只显示选择的一种。

当用户浏览网站时，我希望网站记住选择了哪种语言，并以该语言显示文本。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T23:50:27.537

考虑到您使用的是 Wordpress，此处描述了推荐的方法：[翻译 Wordpress](http://codex.wordpress.org/Translating_WordPress)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T00:07:57.483

要在 php 中使用上述方法回答这个问题：

```
<?php 
    $Languages = Array("English","Svenska","Deutsch");
    if(isset($_POST["lang"]))
    {
        foreach($Languages as $Possible)
        {
            if($_POST["lang"] == $Possible)
            {
                setcookie( "Lang", $_POST["lang"], strtotime( '+30 days' )); 
                $_COOKIE["Lang"] = $_POST["lang"];
            }
        }
    }
    $Lang = isset($_COOKIE["Lang"]) ? $_COOKIE["Lang"] : "English";
    $Tindex = 0;
    foreach($Languages as $Possible)
    {
        if($Possible == $Lang)
            $Index = $Tindex;
        $Tindex++;
    }
?>
<html>
    <head>
        <style type="text/css">
        <?php
            foreach($Languages as $Possible)
            {
                if($Lang != $Possible)
                {
                    echo ".language$Possible {";
                    echo "    display: none;";
                    echo "}";
                }
            }
        ?>
        </style>
    </head>
    <body>
        <form method="POST" action="">
            <select name="lang">
            <?php
            foreach($Languages as $Possible)
            {
                echo "<option value='$Possible' " . ($Lang == $Possible ? "selected='true'" : "") . " >";
                echo "    $Possible";
                echo "</option>";
            } ?>
            </select>
            <input type="submit" value="pick language">
        </form>
        <hr>
        <br>
        <br>
        <h1> Test case1: </h1>
        <div class="languageEnglish">
            Hello!
        </div>
        <div class="languageSvenska">
            Hallå!
        </div>
        <div class="languageDeutsch">
            Hallo!
        </div>
        <h1> Test case2: </h1>
        <div>
            <?php
                switch ($Lang) {
                    case "English":
                        echo "This is a test text!";
                        break;
                    case "Svenska":
                        echo "Denna text är en test text!";
                        break;
                    case "Deutsch":
                        echo "Dieses text ist einen test text!";
                        break;
                }
            ?>
        </div>
        <h1> Test case3: </h1>
        <div>
        <?php
            $Str = Array("There are lots of ways to print the text!","Det finns massa sätt att skriva texten!","Es gibt viel methoden, die text zu schreiben!");
            echo $Str[$Index];
        ?>
        </div>
    </body>
</html> 
```

# javascript - Javascript不显示unicode

> ID：14162968
> 
> 赞同：4
> 
> 时间：2013-01-04T18:43:08.547
> 
> 标签：javascript, html, unicode

根据我在其中指定 HTML 的列，我正在使用 Javascript 在 SharePoint 网站上显示标题。这是 HTML。

```
<DIV style ='text-align:center; font-weight:bold; font-size: 20px;'>◆&lt;/DIV> 
```

问题是脚本在页面中正确呈现 HTML 时，对 header 没有做同样的事情。它在 90% 的情况下都能正常工作，但不是显示 unicode “◆”，而是呈现“ **â** ”。

我已经尝试修改 Javascript 以尝试解释 unicode \u25c6，但我失败得很惨。任何人都可以帮助我或提供一些关于为什么会发生这种情况的线索吗？

这是Javascript。

```
<script type="text/javascript">
// Find all Web Parts in the page
var listWP = [],
    calWP = [],
    divs = document.getElementById("MSO_ContentTable").getElementsByTagName("div");
var count=divs.length;
for (i=0;i<count;i++) {
    try {
        if (divs[i].id.indexOf("WebPartWPQ")==0){
            if (divs[i].innerHTML.indexOf("ViewDefault_CalendarView")>=0) {
                // Calendars
                calWP.push(divs[i].id);
            } else {
                // Other Web Parts
                listWP.push(divs[i].id);
            }
        }
    }
    catch(e){}
}
function TextToHTML(NodeSet, HTMLregexp) {
    var CellContent = "";
    var i=0;
    while (i < NodeSet.length){
        try {
            CellContent = NodeSet[i].innerText || NodeSet[i].textContent;
            if (HTMLregexp.test(CellContent)) {
                NodeSet[i].innerHTML = CellContent;
            }
        }
        catch(err){}
        i=i+1;
    }
}

var regexpA = new RegExp("\\s*<([a-zA-Z]*)(.|\\s)*/\\1?>\\s*$");
var regexpTD = new RegExp("^\\s*<([a-zA-Z]*)(.|\\s)*/\\1?>\\s*$");
var WP = new Object;

function UpdateWP() {
    if (calWP.length>0){
        for (i=0;i<calWP.length;i++) {
            WP=document.getElementById(calWP[i]);
            if (WP.innerHTML.indexOf("&lt\;")>=0) {
                TextToHTML(WP.getElementsByTagName ("a"),regexpA);
            }
        }
    }
    if (listWP.length>0){
        for (i=0;i<listWP.length;i++) {
            WP=document.getElementById(listWP[i]);
            if (WP.innerHTML.indexOf("&lt\;")>=0) {
                TextToHTML(WP.getElementsByTagName ("td"),regexpTD);
            }
        }
    }
    // Check every 200000000 ms, forever
    setTimeout("UpdateWP()",200000000);
}
UpdateWP();
function HeaderToHTML(){
    var headers=document.getElementById("MSO_ContentTable").getElementsByTagName("li");
    var regexpTR1 = new RegExp("FilterValue1=([\\S\\s]*)'\\)");
    var regexpTR2 = new RegExp("FilterValue2=([\\S\\s]*)'\\)");

    for (i=0;i<headers.length;i++) {
        try{
            var sp=headers[i].getElementsByTagName("span");
            for (j=0;j<sp.length;j++) {
                var test = sp[j].innerText || sp[j].textContent || " ";
                //var test = sp[j].innerText;
                if (test.indexOf("...")>0) {
                    //alert(test);
                    //var value = regexpTR1.exec(headers[i].innerHTML)[1];
                    var inner = headers[i].innerHTML;
                    var value = (inner.indexOf("FilterValue2")>0) ? regexpTR2.exec(headers[i].innerHTML) [1] : regexpTR1.exec(headers[i].innerHTML)[1];
                    //alert(value);
                    //alert(value.replace(/\\u00/g,"\%"));
                    value=value.replace(/\\u00/g,"%");
                    sp[j].innerHTML=unescape(unescape(value)).replace(/8_/," ");
                } 
            }
        }catch(e){}
    }
}
setInterval(function(){HeaderToHTML();},100);
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T18:51:51.700

我建议使用 html dex/dec 作为符号。
那是，

`&#x25C6;`= ◆
`&#9670;`= ◆

Wikipedia 有一个很好的列表，将它们分类[在这里](http://en.wikipedia.org/wiki/Unicode_symbols)。[我在这里](http://en.wikipedia.org/wiki/Unicode_Geometric_Shapes)
找到了你要写的黑色钻石

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:48:45.020

我认为一个解决方案可能是在其编码中呈现您的角色，并通过以下方式让浏览器知道它：

```
<meta http-equiv="Content-Type" content="text/html; charset="..."> 
```

例如，如果您使用的是 UTF-8：

```
<meta http-equiv="Content-Type" content="text/html; charset="UTF-8"> 
```

# node.js - 如何从MongoDB集合中的数组中获取某个元素？

> ID：14162971
> 
> 赞同：1
> 
> 时间：2013-01-04T18:43:32.057
> 
> 标签：node.js, mongodb

我在 mongoDB 中有以下名为“CanvasCollection”的集合，我想从该集合中的数组中获取 ID 为“50e6fcc2edcbc10613000022”的图像对象：

```
{
"_id": ObjectId("50d1f440471ca84e1f000007"),
"image": [{
    "_id": ObjectId("50e6fcc2edcbc10613000022"),
    "type": "image",
    "filename": "50e6fcc2edcbc10613000022.jpg",
    "origname": "2811879134_7a57d7c586_m.jpg",
    "filepath": "upload/50e6fcc2edcbc10613000022.jpg",
    "thumbpath": "upload/50e6fcc2edcbc10613000022_small.jpg",)
}],
"text": [{
    "_id": ObjectId("50e6eda0edcbc1061300001b"),
    "content": "Type your text here"
}]
} 
```

这似乎不起作用：

```
CanvasCollection.find({'_id': new BSON.ObjectID('50d1f440471ca84e1f000007')}, {'image' : {$elemMatch: {'_id': new BSON.ObjectID('50e6fcc2edcbc10613000022')}}}) 
```

任何想法如何得到这个：

```
{
    "_id": ObjectId("50e6fcc2edcbc10613000022"),
    "type": "image",
    "filename": "50e6fcc2edcbc10613000022.jpg",
    "origname": "2811879134_7a57d7c586_m.jpg",
    "filepath": "upload/50e6fcc2edcbc10613000022.jpg",
    "thumbpath": "upload/50e6fcc2edcbc10613000022_small.jpg",)
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T00:24:02.263

如果你有 MongoDb 2.2 版，你可以这样做：

```
db.CanvasCollection.aggregate({$project: {image:1}},{ $unwind : "$image" },{ $match : {"image._id": ObjectId("50e6fcc2edcbc10613000022")}}) 
```

（这是来自 mongo shell），输出将是这样的：

```
{
"result" : [
    {
        "_id" : ObjectId("50d1f440471ca84e1f000007"),
        "image" : {
            "_id" : ObjectId("50e6fcc2edcbc10613000022"),
            "type": "image",
            "filename": "50e6fcc2edcbc10613000022.jpg",
            "origname": "2811879134_7a57d7c586_m.jpg",
            "filepath": "upload/50e6fcc2edcbc10613000022.jpg",
            "thumbpath": "upload/50e6fcc2edcbc10613000022_small.jpg"
        }
    }
],
"ok" : 1
} 
```

关于展开：[http](http://docs.mongodb.org/manual/reference/aggregation/unwind/) ://docs.mongodb.org/manual/reference/aggregation/unwind/ 。

类似主题：[仅检索 MongoDB 集合中对象数组中的查询元素](https://stackoverflow.com/questions/3985214/mongodb-extract-only-the-selected-item-in-array)..

如果您有较旧的 MongoDb 版本，我认为这是不可能的。

# c# - 当调用类本身是泛型时，是否可以强制外部类调用专门的重载？

> ID：14162977
> 
> 赞同：7
> 
> 时间：2013-01-04T18:43:56.740
> 
> 标签：c#, generics

我正在编写与无法更改的外部 API 接口的代码：

```
public class ExternalAPI
{
    public static void Read(byte[] buffer);
    public static void Read(int[] buffer);
    public static void Read(float[] buffer);
    public static void Read(double[] buffer);
} 
```

重要的是我在读入数据时调用了正确的重载方法`buffer`，但是一旦数据被读入，我将对其进行通用处理。我第一次通过代码是：

```
public class Foo<T>
{
    T[] buffer;

    public void Stuff()
    {
        ExternalAPI.Foo(buffer);
    }
} 
```

但是，C# 不会从 转换`T[]`为`byte[]`. 有没有办法枚举`T`可以显式表示的类型？我试过使用`where T :`子句，但似乎没有办法说`where T : {byte, int, float, double and nothing else ever}`？

遵循此处的建议：[Generic constraint to match numeric types](https://stackoverflow.com/questions/3329576/generic-constraint-to-match-numeric-types)，我向泛型添加了约束，并且还在我的模拟 API 中添加了一个泛型方法，该方法以 a`object`作为其参数

```
public class ExternalAPI
{
    public static void Read(object buffer);
    public static void Read(byte[] buffer);
    public static void Read(int[] buffer);
    public static void Read(double[] buffer);
}

public class Foo<T> where T: struct, IComparable, IComparable<T>, IConvertible, IEquatable<T>, IFormattable
{
    T[] buffer;

    public void Stuff()
    {
        ExternalAPI.Read(buffer);
    }
} 
```

这将愉快地编译和运行，但唯一被调用的方法是`Foo(object buffer)`，即使`T`是`byte`。当调用类是泛型时，有没有办法强制非泛型类的方法使用最具体的重载？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T18:53:48.270

我以前也遇到过这种情况，我想出的唯一解决方案是测试类型`T`并调用适当的函数；

```
public class Foo<T>
{
    T[] buffer;

    public void Stuff()
    {
        var type = typeof(T);

        if (type == typeof(int[]))
        {
            ...
        }
        else if (type == typeof(double[]))
        {
            ...
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T18:54:12.280

我知道这是一个可悲且多余的解决方案，但我认为没有比这更好的方法了：

```
public void Stuff()
{
    var bufferBytes = buffer as byte[];
    if (bufferBytes != null)
    {
        ExternalAPI.Read(bufferBytes);
        return;
    }
    var bufferInts = buffer as int[];
    if (bufferInts != null)
    {
        ExternalAPI.Read(bufferInts);
        return;
    }
    var bufferDoubles = buffer as double[];
    if (bufferDoubles != null)
    {
        ExternalAPI.Read(bufferDoubles);
        return;
    }
    ExternalAPI.Read(buffer);
} 
```

为了通过尽可能少的转换来提高性能，请重新排序检查并将最常调用的检查放在`if/else`链的顶部。即使`if (buffer is byte[]) ExternalAPI.Read(buffer as byte[]); else...`模型可以使代码更短，那也将代表无用的开销（因为您基本上会进行`buffer`两次转换）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T21:07:19.107

> Is there a way to force methods of non-generic classes to use the most specific overload when the calling class is generic?

Normally, the overload resolution takes place at compile-time. Since the constraints on `T`, namely `where T: struct, IComparable, IComparable<T>, IConvertible, IEquatable<T>, IFormattable`, cannot point to any other overload than the one taking in `object`, that's the overload getting called.

If you are willing to use `dynamic`, the overload resolution will happen at run-time. Simply cast the argument to `dynamic`, like this:

```
public void Stuff()
{
  ExternalAPI.Read((dynamic)buffer);
} 
```

The bad thing about this is that it's slower because overload resolution has to set in when your program runs. But if `T` is one of `byte`, `int`, and so on, the corresponding overload with `byte[]`, `int[]` etc. will be called. If `T` is something not supported, and if the `object` overload does not exist in `ExternalAPI`, this will fail at run-time, throwing an exception, but not until the `Stuff` method runs.

Another solution is to equip your `Foo<T>` class with a delegate to hold the correct method. It could be like:

```
T[] buffer;

readonly Action<T[]> readMethod;

public void Stuff()
{
  readMethod(buffer);
}

//constructor
public Foo(Action<T[]> readMethod)
{
  this.readMethod = readMethod;
} 
```

But then people would have to instantiate your class like this:

```
new Foo<byte>(ExternalAPI.Read) 
```

The right overload would be selected compile-time each place where people created instances of `Foo<>`. You could add checks in you instance constructor that `readMethod` is indeed a unicast delegate representing a method called `Read` defined by `typeof(ExternalAPI)`.

A third solution is to make the `readMethod` field `static`, and include a static constructor that initializes `readMethod`. That would look ugly, but the static constructor would only run once for each type (`byte`, `int`, etc.) you used. The static constructor could throw an exception if people used a wrong `T`. Here's what the static constructor may look like:

```
static Foo()
{
  if (typeof(T) == typeof(byte))
    readMethod = (Action<T[]>)(Delegate)(Action<byte[]>)ExternalAPI.Read;
  else if (typeof(T) == typeof(int))
    readMethod = (Action<T[]>)(Delegate)(Action<int[]>)ExternalAPI.Read;
  else if (typeof(T) == typeof(float))
    readMethod = (Action<T[]>)(Delegate)(Action<float[]>)ExternalAPI.Read;
  else if (typeof(T) == typeof(double))
    readMethod = (Action<T[]>)(Delegate)(Action<double[]>)ExternalAPI.Read;
  else
    throw new Exception("The type parameter T can't be " + typeof(T));
} 
```

**Edit:** Inspired by the first comment below, here's an attempt to make the static constructor use reflection instead:

```
static Foo()
{
  var methInfo = typeof(ExternalAPI).GetMethod("Read", new[] { typeof(T[]), });
  if (methInfo == null)
    throw new Exception("ExternalAPI has no suitable method for " + typeof(T[]));
  readMethod = (Action<T[]>)Delegate.CreateDelegate(typeof(Action<T[]>), methInfo);
} 
```

# c# - System.IO.File.Move--如何等待移动完成？

> ID：14162983
> 
> 赞同：12
> 
> 时间：2013-01-04T18:44:18.127
> 
> 标签：c#, wpf

我正在用 c# 编写一个 WPF 应用程序，我需要移动一些文件——问题是我真的真的需要知道文件是否成功。为此，我编写了一个检查，以确保文件在移动后到达目标目录 - 问题是有时我在文件完成移动之前进行检查：

```
 System.IO.File.Move(file.FullName, endLocationWithFile);

            System.IO.FileInfo[] filesInDirectory = endLocation.GetFiles();
            foreach (System.IO.FileInfo temp in filesInDirectory)
            {
                if (temp.Name == shortFileName)
                {

                    return true;
                }
            }

            // The file we sent over has not gotten to the correct   directory....something went wrong!
            throw new IOException("File did not reach destination");

        }
        catch (Exception e)
        {
            //Something went wrong, return a fail;
            logger.writeErrorLog(e);
            return false;
        } 
```

有人能告诉我如何确保文件真正到达目的地吗？--我要移动的文件可能非常大--（长达 2 小时的全高清 mp4 文件）

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T20:32:31.727

您可以使用流`Aysnc` `Await`来确保文件被完全复制

像这样的东西应该工作：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    string sourceFile = @"\\HOMESERVER\Development Backup\Software\Microsoft\en_expression_studio_4_premium_x86_dvd_537029.iso";
    string destinationFile = "G:\\en_expression_studio_4_premium_x86_dvd_537029.iso";

    MoveFile(sourceFile, destinationFile);
}

private async void MoveFile(string sourceFile, string destinationFile)
{
    try
    {
        using (FileStream sourceStream = File.Open(sourceFile, FileMode.Open))
        {
            using (FileStream destinationStream = File.Create(destinationFile))
            {
                await sourceStream.CopyToAsync(destinationStream);
                if (MessageBox.Show("I made it in one piece :), would you like to delete me from the original file?", "Done", MessageBoxButton.YesNo) == MessageBoxResult.Yes)
                {
                    sourceStream.Close();
                    File.Delete(sourceFile);
                }
            }
        }
    }
    catch (IOException ioex)
    {
        MessageBox.Show("An IOException occured during move, " + ioex.Message);
    }
    catch (Exception ex)
    {
        MessageBox.Show("An Exception occured during move, " + ex.Message);
    }
} 
```

如果您使用 VS2010，则必须安装[Async CTP](http://www.microsoft.com/en-us/download/details.aspx?id=9983)才能使用新的 Async/Await 语法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T18:48:57.220

您可以观察文件从原始目录中消失，然后确认它们确实出现在目标目录中。

我对文件观察者没有很好的经验。我可能会让执行移动的线程等待[AutoResetEvent](http://www.albahari.com/threading/part2.aspx#_Signaling_with_Event_Wait_Handles)，而单独的线程或计时器运行以定期检查文件是否从原始位置消失，检查它们是否在新位置，也许（取决于您的环境和需要）执行文件的一致性检查（例如 MD5 检查）。一旦满足这些条件，“检查器”线程/计时器将触发 AutoResetEvent 以便原始线程可以继续进行。

在“检查器”中包含一些“这花费了太长时间”的逻辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T20:13:51.213

为什么不通过复制流自己管理副本？

```
//http://www.dotnetthoughts.net/writing_file_with_non_cache_mode_in_c/
const FileOptions FILE_FLAG_NO_BUFFERING = (FileOptions) 0x20000000;

//experiment with different buffer sizes for optimal speed
var bufLength = 4096;

using(var outFile = 
    new FileStream(
        destPath,
        FileMode.Create, 
        FileAccess.Write, 
        FileShare.None, 
        bufLength, 
        FileOptions.WriteThrough | FILE_FLAG_NO_BUFFERING))
using(var inFile = File.OpenRead(srcPath))
{
    //either
    //inFile.CopyTo(outFile);

    //or
    var fileSizeInBytes = inFile.Length;
    var buf = new byte[bufLength];
    long totalCopied = 0L;
    int amtRead;
    while((amtRead = inFile.Read(buf,0,bufLength)) > 0)
    {
        outFile.Write(buf,0,amtRead);
        totalCopied += amtRead;
        double progressPct = 
            Convert.ToDouble(totalCopied) * 100d / fileSizeInBytes;
        progressPct.Dump();
    }
}
//file is written 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T19:24:01.347

您很可能希望移动发生在一个单独的线程中，这样您就不会在几个小时内停止应用程序的执行。

如果程序在移动未完成的情况下无法继续，那么您可以打开一个对话框并定期检查移动线程以更新进度跟踪器。这为用户提供了反馈，并防止他们感觉程序已冻结。

这里有信息和一个例子：http: [//hintdesk.com/c-wpf-copy-files-with-progress-bar-by-copyfileex-api/](http://hintdesk.com/c-wpf-copy-files-with-progress-bar-by-copyfileex-api/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T20:55:20.240

尝试在后台任务中定期检查复制的文件大小是否达到原始文件的文件大小（您可以在文件之间添加哈希比较）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-04T21:33:02.567

最近遇到了类似的问题。

```
OnBackupStarts();
//.. do stuff

 new TaskFactory().StartNew(() =>
                {
                    OnBackupStarts()
                    //.. do stuff
                    OnBackupEnds();
                });

void OnBackupEnds()
    {
        if (BackupChanged != null)
        {
            BackupChanged(this, new BackupChangedEventArgs(BackupState.Done));
        }
    } 
```

不要等待，对事件做出反应

# asp.net-mvc - ASP.NET MVC - 如何使用剃须刀助手 Html.Action() 执行 EXACT 操作；

> ID：14162990
> 
> 赞同：0
> 
> 时间：2013-01-04T18:44:44.303
> 
> 标签：asp.net-mvc

我有这样的事情：

```
class AccountController : Controller
{
   [HttpGet]
   public ActionResult Login()
   {...}

   [HttpPost]
   public ActionResult Login(LoginModel model)
   {...}
} 
```

现在，这很难解释：对于发送的每个请求，我都会检查用户是否经过身份验证，如果没有，我会在我的页面中为他们显示一个登录窗口。我通过执行来显示它：`@Html.Action("Login", "Account", new {})`这个动作通常会返回一个 partialView，所以我可以把它放在我的页面中。

现在我解释有问题的用例：当用户注册自己时，他将注册数据发回给我，当这个注册数据不正确并且我在我的控制器中检测到它时，我会将这些数据发回给用户，以便他可以更正自己。当我这样做时，我重新渲染发送给用户的页面，并通过这样做我`@Html.Action("Login", "Account", new {})`第二次执行。但是这次我在内存中有用户数据。所以模型绑定器认为，我没有请求 [HttpGet] Login() 方法，但它尝试执行 [HttpPost] 版本。现在我认为最好的办法是更改此操作的这两个版本的名称。但也许有某种魔法可以让我保持相同的名称并准确地执行我想要的，而无需让 modelbinder 决定？

# backbone.js - 如何挂钩异步 Backbone 事件以显示 HTML

> ID：14162995
> 
> 赞同：2
> 
> 时间：2013-01-04T18:45:19.207
> 
> 标签：backbone.js

我想要做的是调用数据库，然后在一些 HTML 中显示结果。我一切正常（数据从数据库中返回就好了），除了我不知道如何显示数据。

我知道这`fetch()`是异步的，但我不确定如何将它连接到我的集合视图中。这是我的骨干：

```
 (function() {
        window.App = {
            Models: {},
            Collections: {},
            Views: {},
            Router: {}
        };

        window.template = function(id) {
            return _.template( $('#' + id).html() );
        };

        App.Models.Main = Backbone.Model.extend({
            defaults : {
                FName: ''
            }
        });

        App.Collections.Mains = Backbone.Collection.extend({
            model: App.Models.Main,
            initialize: function(mains) {
                this.fetch({success: function(main) {
                    $('#web-leads').html(main);
                }});
            },
            url: '../leads/main_contact'
        });

        App.Views.Mains = Backbone.View.extend({
            tagName: 'ul',
            render: function() {
                var ul = this.collection.each(this.addOne, this);
                return ul;
            },
            addOne: function(main) {
                var mainC = new App.Views.Main({ model: main});
                this.$el.append(mainC.render().el);
                return this;
            }
        });

        App.Views.Main = Backbone.View.extend({
            tagName: 'li',
            template: template('mainContactTemplate'),
            render: function () {
                this.$el.html(this.template(this.model.toJSON()));
                return this;
            }

        });

        main = new App.Views.Main();
        mains = new App.Collections.Mains(main);

    })(); 
```

我需要能够`$('#web-leads').html()`使用从`mains`. 我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T19:48:26.333

Backbone 中这类事情的一般模式是：

1.  创建模型或集合
2.  将该模型/集合传递给视图
3.  该视图在模型/集合上注册一个事件处理程序
4.  模型/集合触发 AJAX 请求（可能是响应`fetch`调用）
5.  视图的事件处理程序被触发
6.  视图的事件处理程序更新页面

因此，由于 mu 建议太短，您最好的选择是遵循此模式并让您的视图将处理程序绑定到您的集合`reset`事件。

值得一提的是，这`reset`并不总是您想要绑定的事件。例如，您可能不想响应 AJAX 请求，除非它更改了模型的属性“X”。在这种情况下，您可以改为绑定到`change:X`，然后仅当 AJAX 响应更改 X 时才会触发您的处理程序。

要查看所有可能的选项，请参阅：

[http://documentcloud.github.com/backbone/#Events-catalog](http://documentcloud.github.com/backbone/#Events-catalog)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T19:46:59.640

您在正确的轨道上只需要让视图监听集合而不是集合监听视图。

下面是你的代码，稍微修改了谁听谁的。

为什么？理想情况下，我们希望集合对视图一无所知。

```
(function() {
    window.App = {
        Models: {},
        Collections: {},
        Views: {},
        Router: {}
    };

    window.template = function(id) {
        return _.template( $('#' + id).html() );
    };

    App.Models.Main = Backbone.Model.extend({
        defaults : {
            FName: ''
        }
    });

    App.Collections.Mains = Backbone.Collection.extend({
        model: App.Models.Main,

        url: '../leads/main_contact'
    });

    App.Views.Mains = Backbone.View.extend({
        tagName: 'ul',
        initialize : function(){
          this.collection.on('reset', this.render, this);
        },
        render: function() {
            var ul = this.collection.each(this.addOne, this);
            return ul;
        },
        addOne: function(main) {
            var mainC = new App.Views.Main({ model: main});
            this.$el.append(mainC.render().el);
            return this;
        }
    });

    App.Views.Main = Backbone.View.extend({
        tagName: 'li',
        template: template('mainContactTemplate'),
        render: function () {
            this.$el.html(this.template(this.model.toJSON()));
            return this;
        }

    });

    mains = new App.Collections.Mains();
    main = new App.Views.Main( {'collection' : mains} );
    mains.fetch(); 

})(); 
```