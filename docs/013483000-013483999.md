# StackOverflow 问答 13483000-13483999

# sql - 理解“Where”子句中的 case 表达式

> ID：13483001
> 
> 赞同：2
> 
> 时间：2012-11-20T22:05:16.917
> 
> 标签：sql, sql-server

我在这里有这段代码，你可以从我的伪代码中看到我想要完成的事情

```
select *

from dbo.BenefitsForms
     inner join Dependents on BenefitsForms.UserId = Dependents.BenefitsForm_UserId
     inner join CoverageLevels on BenefitsForms.MedicalId = CoverageLevels.Id

where (BenefitsForms.MedicalId > 0 AND BenefitsForms.MedicalId < 13)
  AND Dependents.IsSpouse = CASE when CoverageLevels.[Level] = 2 then 1
                                 when CoverageLevels.[Level] = 3 then 0 end
                                 when CoverageLevels.[Level] = 4 then [any, it doesnt matter] <--- my desire but it doesn't work. 
```

我该怎么做才能在括号中获得我想要的效果？如果 Coverage Level = 4 那么我不在乎 Dependents.IsSpouse 是什么，我什至不需要再按它排序了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T22:07:32.953

假设`isSpouse`只能是`0`or `1`... if `CoverageLevels.Level`is `4`，然后与`isSpouse`自身进行比较，这将始终导致`true`：

```
AND Dependents.IsSpouse = CASE 
    when CoverageLevels.[Level] = 2 then 1
    when CoverageLevels.[Level] = 3 then 0
    when CoverageLevels.[Level] = 4 then Dependents.IsSpouse
END 
```

或者，这也可以在没有 的情况下表示`CASE`：

```
WHERE
    BenefitsForms.MedicalId > 0 
    AND BenefitsForms.MedicalId < 13
    AND (
        (Dependents.IsSpouse = 1 AND CoverageLevels.[Level] = 2)
        OR (Dependents.IsSpouse = 0 AND CoverageLevels.[Level] = 3)
        OR CoverageLevels.[Level] = 4
    ) 
```

# python - Facebook Python登录脚本不使用API

> ID：13483002
> 
> 赞同：2
> 
> 时间：2012-11-20T22:05:19.033
> 
> 标签：python, facebook, urllib2

好的，所以不久前我找到了一个使用 python 登录 facebook 的基本脚本。它没有用 - 但经过一些调整（主要是围绕更新帖子字符串）它运行了很长一段时间。现在它又停止了——我怀疑是因为 facebook 稍微改变了他们的网站。

我已经尝试在 Firefox 中捕获登录并确保我尽可能多地模仿帖子值等进行进一步的调整。

我需要直接登录到该站点，因为我有一堆脚本可以收集可通过浏览器获得的数据，但不能通过 API。

花了几天时间试图解决这个问题，我仍然在画一个空白......我错过了什么？

```
import sys
import re
import urllib
import urllib2
import cookielib
import json

def main():
    # Check the arguments
    user = sys.argv[1]
    passw = sys.argv[2]

    # Initialize the needed modules
    CHandler = urllib2.HTTPCookieProcessor(cookielib.CookieJar())
    browser = urllib2.build_opener(CHandler)

    browser.addheaders = [('Referer', 'http://login.facebook.com'),
                        ('Content-Type', 'application/x-www-form-urlencoded'),
                        ('User-Agent', 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.7) Gecko/20091221 Firefox/3.5.7 (.NET CLR 3.5.30729)')]

    urllib2.install_opener(browser)
    res = browser.open('http://m.facebook.com/index.php')
    pg=res.read()
    mxt = re.search('name="li" value="(\w+)"', pg)
    mxt2 = re.search('name="m_ts" value="(\w+)"', pg)
    mxt3 = re.search('name="lsd" value="(\w+)"', pg)
    mxt4 = re.search('name="locale" value="(\w+)"', pg)

    li = mxt.group(1)
    m_ts = mxt2.group(1)
    lsd = mxt3.group(1)
    locale = mxt4.group(1)
    res.close()

    # Initialize the POST data
    data = urllib.urlencode({
        'lsd'               : lsd,
        'charset_test'      : urllib.unquote_plus('%E2%82%AC%2C%C2%B4%2C%E2%82%AC%2C%C2%B4%2C%E6%B0%B4%2C%D0%94%2C%D0%84'),
        'version'           : '1',
        'm_ts'              : m_ts,
        'li'                : li,
        'locale'            : locale,
        'signup_layout'     : 'header_button',
        'laststage'         :'first',
        'post_form_id'      : pfi,
        'email'             : user,
        'pass'              : passw,
        'login'             : 'Log in'
    })

    url='https://login.facebook.com/login.php?login_attempt=1&non_com_login=&'+ data
    res = urllib2.urlopen(url)
    print ('%s' % url)

    res.close()

    # Get Access Token
    res = browser.open('http://developers.facebook.com/docs/reference/api')
    conft = res.read()

    # For Debugging
    fh = open('debug.html', 'w')
    fh.write(conft)
    fh.close

    mat = re.search('access_token=(.*?)"', conft)
    acct = mat.group(1)
    print ('Using access token: %s' % acct) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T22:36:49.347

作为记录，这里是上述的工作答案。

```
#!/usr/bin/python

import mechanize

browser = mechanize.Browser()
browser.set_handle_robots(False)
cookies = mechanize.CookieJar()

browser.addheaders = [('User-agent', 'Mozilla/5.0 (X11; U; Linux i686; en-US)     AppleWebKit/534.7 (KHTML, like Gecko) Chrome/7.0.517.41 Safari/534.7')]
browser.open("http://m.facebook.com/")
browser.select_form(nr=0)

browser.form['email'] = 'YOUR_LOGIN'
browser.form['pass'] = 'YOUR_PASSWORD'
response = browser.submit() 
```

# python - Django-admin.py 突然无法识别

> ID：13483004
> 
> 赞同：1
> 
> 时间：2012-11-20T22:05:27.717
> 
> 标签：python, django

我昨天尝试启动一个新的 Django 项目，但是当我执行“django-admin.py startproject projectname”时，我收到一条错误消息：“django-admin.py 未被识别为内部或外部命令。” 奇怪的是，当我第一次安装 Django 时，我做了几个项目，一切正常。但是现在几个月后回去后它突然停止工作。

我试图四处寻找答案，但我能找到的只是这通常与系统路径设置有关，但是，我知道我设置了正确的路径，所以我不明白发生了什么。有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:16:46.370

首先检查 django 是否安装正确。

```
import django 
```

**编辑 1**

如果遇到异常，请尝试卸载并安装 django。

我建议通过 pip 执行此操作：

```
$> easy_install pip

$> pip uninstall django
$> pip install django 
```

然后检查文件是否`C:\Python26\Scripts\django-admin.py`存在。您可以用`c:\python26`本地 python 安装路径替换。如果您没有找到该文件，请卸载并安装 django，请参阅上面的**EDIT 1**。

然后将`C:\Python26`和添加`C:\Python26\Scripts`到您的路径中。看[这里](https://stackoverflow.com/questions/9546324/adding-directory-to-path-environment-variable-in-windows-xp)

来自[python 文档](http://docs.python.org/2/faq/windows.html)：

> PATH 环境变量的当前设置，您可以在“高级”选项卡下的“我的电脑”的属性窗口中找到该设置。请注意，如果您有足够的权限，您可以选择为当前用户或系统安装设置。如果您希望每个人都能够在机器上运行 Python，则首选后者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-12T09:57:38.933

我对编码完全陌生，所以请原谅我的业余答案。

我有类似的问题 - 我意识到当我的 Django 安装在 C 驱动器上时，我的文件保存在 D 驱动器上，我试图在命令提示符下从 D 驱动器运行 django-admin，这给出了上述错误。对我有用的是以下

1.  找到位于路径 C:\Users[Username]\AppData\Local\Programs\Python\Python38-32\Scripts> 下的 Django-admin.exe 和 django-admin.py 文件

2.  将这两个文件复制到我试图创建新项目的 D 驱动器文件夹中

3.  然后在终端命令提示符（设置为 D Drive 项目）上运行 django-admin startproject [filename] 并在该文件夹中创建了一个新文件 [filename] 并解决了此错误

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-02-28T13:09:23.397

您可以尝试使用以下代码

`py -m django startproject add_your_project_name_here`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-16T06:38:14.677

根据[此链接](https://docs.djangoproject.com/en/3.0/ref/django-admin/)，您可以尝试，

`python -m django <command> [options]`.

其中 python 是您正在使用的 python 的版本。

用法`python -m django startproject <projectname>`。

# iphone - 黑色 default.png 和应用拒绝？

> ID：13483011
> 
> 赞同：0
> 
> 时间：2012-11-20T22:06:25.387
> 
> 标签：iphone, ios, appstore-approval

Xcode 自动将黑色 default.png 添加到我的项目中。我没改，已经发给苹果了，等待审核。是拒绝的原因吗？default.png 可以是黑色还是不？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T22:32:34.263

黑色默认图像不会导致您的应用被拒绝。我已经接受了根本没有默认图像的应用程序-如果应用程序启动得足够快，或者启动图像没有合适的内容，那么您就不需要了。

咆哮：使用较大的默认图像来表示 iPhone 应用程序可以在 iPhone 5 上运行（IMO）是一个非常糟糕的决定——信息列表中的一个键会更明智。随着设备变得越来越快，分辨率越来越高，启动图像变得越来越荒谬。支持 iPhone 3、4、5、iPad 和 Retina iPad 的通用应用程序将基本上浪费数兆字节的空间，以支持显示几毫秒的图像。当设备速度较慢时需要它，但现在不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:13:36.477

[App Store 指南](https://developer.apple.com/appstore/resources/approval/guidelines.html#user-interface)第 10.6 节说：

> 10.6 Apple 和我们的客户高度重视简单、精致、有创意、经过深思熟虑的界面。他们需要做更多的工作，但值得。苹果设定了很高的标准。如果您的用户界面很复杂或不太好，它可能会被拒绝

显然，人们在没有启动屏幕的情况下获得批准的应用程序（即使它们在 HIG 中按[要求](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/IconsImages/IconsImages.html#//apple_ref/doc/uid/TP40006556-CH14-SW5)列出，我没想到空白屏幕也符合条件），所以我们会祈祷！

# ruby-on-rails - Rails：路由不正确，重定向回另一个控制器

> ID：13483013
> 
> 赞同：0
> 
> 时间：2012-11-20T22:06:33.263
> 
> 标签：ruby-on-rails, ruby, routes, hyperlink

我在网站上有一个页面，其中有很多锚链接，例如`#menu`| `#sauces`ETC

在页面本身上，链接工作正常，非常棒。但是，当我在不同的控制器/视图上时，这些链接不会带我回到主控制器，也不会回到单击的锚点。

这是一个锚链接的示例，它位于标题中（位于所有控制器视图中）

> ```
>  <%= link_to '#main', :id => 'menu_link' do %>
>     <li>Menu</li>
>     <% end %> 
> ```

那是在`:controller => "main", :action => "index"`

当我在另一个控制器中时，例如我的位置控制器，链接变成这样`localhost:3000/locations#menu`

真的应该是`localhost:3000/#menu`

根设置为转到主控制器和索引操作。

这是我的 routes.rb 文件

> ```
>  root :to => "main#index"
>    match 'admin', :to => 'access#admin_index'
>    match 'locations', :to => 'ranch_locations#locations'
>    match ':controller(/:action(/:id))(.:format)' 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:13:31.657

您需要指定它将转到不同的控制器。

```
<%= link_to '#main', :controller => "main", :action => "index", :id => 'menu_link' do %>
  <li>Menu</li>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:11:29.417

你应该使用`root_path(:anchor => :main)`而不是`"#main"`

```
link_to "Comment wall", profile_path(@profile, :anchor => "wall")
# => <a href="/profiles/1#wall">Comment wall</a> 
```

[http://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to](http://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to)

**更新：**

```
<%= link_to '#main', :id => 'menu_link' do %> 
```

应该改为

```
<%= link_to root_path(:anchor => :main), :id => 'menu_link' do %> 
```

# php - 用于内容索引/更新的 PHP (preg) 正则表达式

> ID：13483021
> 
> 赞同：2
> 
> 时间：2012-11-20T22:07:06.523
> 
> 标签：php, regex

我有以下代码：

```
/* record 863.content.en */
UPDATE language_def
SET en='<html>blah blah markup</html>'
WHERE page_id=863,
AND string_id='content';
/* record_end 863.content.en */ 
```

我想创建一个表达式来匹配该语句，其中：

1.  期间之间的数据`863.content.en`是可变的，但具体（连续会有许多这样的语句）
2.  两条评论之间的数据是可变的，但不是特定的

这是我到目前为止所拥有的：

```
'[/*]\s*record\s*specific_number[.]specific_string1[.]specific_string2\s*[*/].*[/*]\s*record_end\s*specific_number[.]specific_string1[.]specific_string2\s*[*/]' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:22:53.450

您的正则表达式存在一些问题。

首先，正如 FrankeTheKneeMan 指出的那样，您需要分隔符。`#`是 HTML 匹配的好选择（标准选择是`/`，但它经常干扰标签）：

```
'#[/*]\s*record\s*specific_number[.]specific_string1[.]specific_string2\s*[*/].*[/*]\s*record_end\s*specific_number[.]specific_string1[.]specific_string2\s*[*/]#' 
```

现在虽然`[.]`是转义单个字符的好方法，但对于`[/*]`. 这是一个字符类，匹配`/`或`*`。对`[*/]`. 改用这个：

```
'#/[*]\s*record\s*specific_number[.]specific_string1[.]specific_string2\s*[*]/.*/[*]\s*record_end\s*specific_number[.]specific_string1[.]specific_string2\s*[*]/#' 
```

现在`.*`是剩下的问题。实际上也有，一个是关键的，另一个可能不是。第一个是`.`默认不匹配换行符。您可以使用`s`(singleline) 修饰符来更改它。第二个，`*`就是贪心。**如果**一个部分在字符串中出现两次，您将获得从第一个对应`/* record`到最后一个对应的所有内容`/* record_end`，即使两者之间存在不相关的内容。由于您的记录似乎非常具体，我想情况并非如此。但是，通常最好的做法是使量词不贪婪，以使其消耗尽可能少。这是您的最终正则表达式字符串：

```
'#/[*]\s*record\s*specific_number[.]specific_string1[.]specific_string2\s*[*]/.*?/[*]\s*record_end\s*specific_number[.]specific_string1[.]specific_string2\s*[*]/#s' 
```

对于您提出的示例，这是

```
'#/[*]\s*record\s*863[.]content[.]en\s*[*]/.*?/[*]\s*record_end\s*863[.]content[.]en\s*[*]/#s' 
```

如果你想找到**所有**这些部分，那么你可以 make`863`和variable 捕获它们（使用括号）`content`并`en`使用反向引用来确保你得到相应的`record_end`：

```
'#/[*]\s*record\s*(\d+)[.](\w+)[.](\w+)\s*[*]/.*?/[*]\s*record_end\s*\1[.]\2[.]\3\s*[*]/#s' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:23:12.763

```
'#/\* record (\S+) \*/.*<html>(.*)</html>.*/\* record_end \1 \*/#is' 
```

此正则表达式会将您的字符串拆分为单独的记录，如此[处所示](http://regexr.com?32sh9)。您可以随意用 替换任何空格`\s*`，但为了便于阅读，我将其保留为这种方式。 `\S+`匹配任意数量的非空白字符，但您可以根据需要将其替换为您的特定字符串。否则，您可以解析 preg_match_all 返回的匹配对象，并使用第一个子捕获来获取特定记录，并使用第二个子捕获来获取`html`标签之间的信息。`#`s 是 php 分隔正则表达式所需的分隔符 -不`i`区分大小写并`s`匹配`.`新行。

# java - 在播放框架中生成的源代码（尤其是thrift）

> ID：13483024
> 
> 赞同：1
> 
> 时间：2012-11-20T22:07:14.570
> 
> 标签：java, playframework, thrift

我正在考虑使用 thrift 作为使用 play 框架编写的服务器的传输。Thrift 必须将 IDL 文件转换为 java 源代码。通过典型的构建过程（例如 ant），我知道如何在进入主编译步骤之前创建生成的源代码。由于 Play 控制了编译过程，我不确定如何将生成的源代码注入构建过程，或者即使有可能。有没有办法为 Play 创建额外的构建步骤，还是我只需要确保手动更新我的 thrift 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T08:07:03.860

Play 2 使用 SBT 作为构建工具，因此您可以使用完整的 SBT 功能： [http ://www.scala-sbt.org/release/docs/Howto/generatefiles.html](http://www.scala-sbt.org/release/docs/Howto/generatefiles.html)

在 setting() 块中添加 Build.scala 源生成器：

```
val main = PlayProject(appName, appVersion, appDependencies, mainLang = SCALA).settings(
  sourceGenerators in Compile <+= sourceManaged in Compile map { dir =>
    //example for one scala file, call your thrift generation here for multiple files
    val file = dir / "demo" / "Test.scala"
    IO.write(file, """object Test extends App { println("Hi") }""")

    Seq(file) //list your generated files here
   }
) 
```

# java - JavaFX 2 ComboBox setValue() 不设置 CB 文本

> ID：13483025
> 
> 赞同：6
> 
> 时间：2012-11-20T22:07:16.070
> 
> 标签：java, combobox, javafx-2

我的问题是，在使用 setValue() 选择后，所选的 ComboBox 项目文本在屏幕上不可见。以下是一些细节： 向我的 CB 添加项目：

```
combo.getItems().add("a");
combo.getItems().add("b");
combo.getItems().add("c");
combo.getItems().add("d"); 
```

之后，当按下按钮 A 时：

```
combo.setValue(null); 
```

按下按钮 B 时：

```
combo.setValue("a"); 
```

现在，如果我先按下按钮 B，则显示“a”，没关系。之后，如果我按下按钮 A，ComboBox 上不会显示任何文本，没关系。然后我按B，屏幕上的值没有改变。但是，如果我单击 CB，“a”的行将突出显示，combo.getValue() 返回“a”。

有什么建议如何处理吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-10-04T12:31:28.750

我也有同样的问题。它看起来像一个错误。这是一个`ComboBox`包含`Locale`s 的完整工作示例：

```
package org.example;

import java.util.Arrays;
import java.util.List;
import java.util.Locale;

import javafx.application.Application;
import javafx.event.EventHandler;
import javafx.geometry.Insets;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.HBox;
import javafx.stage.Stage;
import javafx.util.StringConverter;

public final class ComboBoxTest extends Application {
    @Override
    public void start(final Stage stage) throws Exception {
        // Initialize UI
        stage.setTitle("ComboBox Test");
        final HBox root = new HBox(5.0f);
        final ComboBox<Locale> cbLocales = new ComboBox<>();
        cbLocales.setConverter(new StringConverter<Locale>() {
            @Override
            public String toString(final Locale locale) {
                return locale.getDisplayName();
            }

            @Override
            public Locale fromString(String string) {
                throw new UnsupportedOperationException();
            }
        });
        cbLocales.setPrefWidth(250);
        HBox.setMargin(cbLocales, new Insets(10));
        root.getChildren().add(cbLocales);
        final Button btnFill = new Button("Fill");
        HBox.setMargin(btnFill, new Insets(10));
        root.getChildren().add(btnFill);
        final Scene scene = new Scene(root);
        stage.setScene(scene);

        btnFill.setOnMouseClicked(new EventHandler<MouseEvent>() {
            @Override
            public void handle(final MouseEvent event) {
                // Fill with content
                final List<Locale> locales = Arrays.asList(Locale.ENGLISH,
                        Locale.GERMAN, Locale.FRENCH);
                final Locale defaultLocale = locales.get(1);
                // cbLocales.getItems.setAll(locales) doesn't work
                cbLocales.getItems().clear();
                cbLocales.getItems().addAll(locales);
                // Set default locale
                cbLocales.setValue(defaultLocale);
                cbLocales.setPromptText(cbLocales.getConverter().toString(
                        cbLocales.getValue()));
            }
        });

        stage.show();
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

第`ComboBox`一次填充时，一切正常：`ComboBox`包含所有 3`Locale`秒，第二个`Locale`已设置。

![在此处输入图像描述](../Images/b77315084500ba54013d406220ce19b6.png)

填充第二次后，`ComboxBox.setValue`不起作用：`ComboBox`包含所有 3`Locale`秒但未设置*第二*`Locale`个。未选择任何项目，不显示提示。

 *![在此处输入图像描述](../Images/9d98323454fb90ba85eb2a0ecc37aa56.png)

我修复了提示问题

```
// Set default locale
cbLocales.setValue(defaultLocale);
cbLocales.setPromptText(cbLocales.getConverter().toString(
        cbLocales.getValue())); 
```

但它没有选择列表中的项目：

![在此处输入图像描述](../Images/fecb44e149ef1f87d0400fd10779aac6.png)

**一个解决方法是：**

```
cbLocales.getSelectionModel().select(defaultLocale);
cbLocales.setPromptText(cbLocales.getConverter().toString(cbLocales.getValue())); 
```

选择项目并设置提示。但我不知道，如果有问题（工具提示或类似）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-07T03:52:57.987

我认出了一个奇怪的行为。看起来`setItems()`在你设置你的“价值”之前不应该这样做......这是一些对我有用的代码：

```
 ComboBox<String> editableComboBox = new ComboBox<String>(); // <- setting the items here 
                                                             // brings the "bug"
    editableComboBox.setId("combobox_fields" + i);
    String desciption = pair.getDescription();
    editableComboBox.setValue(desciption);
    editableComboBox.setEditable(true); 
    editableComboBox.setItems(FieldType.FIELD_TYPES); // <- here we go! 
```

这里的价值观..

```
public static final ObservableList<String> FIELD_TYPES =
            FXCollections.observableArrayList("A", "B", "C",
                                              "D", "E", "F",
                                              "G", "H", "I"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:30:06.043

> 创建组合框时，必须实例化 ComboBox 类并将项目定义为可观察列表，就像其他 UI 控件如 ChoiceBox、ListView 和 TableView 一样。

示例代码：

```
ObservableList<String> options = 
    FXCollections.observableArrayList("A","B","C","D");

combo.setItems(options); 
```

现在结果应该如你所料:)（在我的本地机器上测试）

参考： [组合框](http://docs.oracle.com/javafx/2/ui_controls/combo-box.htm)*

# git - 维护两个共享补丁的并行 git 分支

> ID：13483026
> 
> 赞同：1
> 
> 时间：2012-11-20T22:07:19.267
> 
> 标签：git

我需要维护一个开源项目的两个 git 分支。第一个分支`official`基本上是官方仓库的克隆。第二个分支`custom`包含一些自定义补丁。其中一些补丁已合并到官方仓库中。如何`custom`在不引起冲突的情况下与官方 repo 保持同步？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:48:23.140

如果`custom`未发布（例如，`custom`未出现的提交`official`未推送到任何其他存储库），您可以`git fetch`然后将您的提交应用到分支`git rebase official`之上。`official`

如果这对您不起作用，您可以随时`pull` `official`进入`custom`，在更新分支时生成合并提交。

# sql - 使用oracle中的条件获取数据

> ID：13483027
> 
> 赞同：2
> 
> 时间：2012-11-20T22:07:20.750
> 
> 标签：sql, oracle

```
WITH DATA
     AS ( select ACCT_ID_1,  ACCT_ID, ACCT_ID_2 ... from two tables joined by criteria ),
DATA1
     AS (SELECT D1.*
           FROM DATA D1
          WHERE ACCT_ID_1 = ACCT_ID AND ACCT_ID_1 = '101'),
DATA2
     AS (SELECT D2.*
           FROM DATA D2
          WHERE ACCT_ID_2 = ACCT_ID AND ACCT_ID_2 = '101') 
```

如果 data1 中有数据（没有来自 data2 的数据），我需要获取 data1，否则我需要从 data2 获取。可以使用 SQL 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:30:54.863

这可能是我的做法：

```
WITH data1 AS (
  SELECT 1
  FROM dual
  WHERE 1=2 -- Set to 1 to reverse result
)
, data2 AS (
  SELECT 2
  FROM dual  
)
SELECT *
FROM data1
UNION ALL
SELECT *
FROM data2
WHERE NOT EXISTS (
  SELECT 1
  FROM data1
) 
```

以[SQLFiddle](http://www.sqlfiddle.com/#!4/d41d8/4513/0)为例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:18:46.683

```
SELECT ACCT_ID_1,  ACCT_ID, ACCT_ID_2, ...,
  IF EXISTS (SELECT D1.*
       FROM DATA D1
      WHERE ACCT_ID_1 = ACCT_ID AND ACCT_ID_1 = '101')
  THEN (SELECT D1.ACCT_ID_1
       FROM DATA D1
      WHERE ACCT_ID_1 = ACCT_ID AND ACCT_ID_1 = '101')
  ELSE (SELECT D2.ACCT_ID_2
       FROM DATA D2
       WHERE ACCT_ID_2 = ACCT_ID AND ACCT_ID_2 = '101')
  END IF 
```

# java - 线程 CPU 时间的定义是什么？

> ID：13483034
> 
> 赞同：0
> 
> 时间：2012-11-20T22:07:38.490
> 
> 标签：java, multithreading, time, cpu

我们如何为非本地线程定义“线程 CPU 时间”？更具体地说，它是如何在 JVM 上定义的（大概是从 JVM 抽象出 CPU，因此定义可能与较低级别的进程略有不同）......

我正在从这个测量的 JVM 实现工作：http: [//docs.oracle.com/javase/1.5.0/docs/api/java/lang/management/ThreadMXBean.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/management/ThreadMXBean.html)这似乎没有直接定义什么“线程CPU时间”是直接衡量的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:40:22.113

线程 CPU 时间已经是一个非常通用的术语。基本上它代表 CPU 在给定线程上花费的时间。

它的定义没有任何不同，因为它在 JVM 上，唯一需要考虑的重要部分是 JVM 是否真的允许您测量它。有些会，有些不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:41:41.537

不一定要打破抽象。POSIX 确实指定了一种测量每个线程的 cpu 时间的方法。然后是 Windows :)

搜索热点源，我看到：

**热点/src/share/vm/runtime/os.hpp**

```
 // JVMTI & JVM monitoring and management support
  // The thread_cpu_time() and current_thread_cpu_time() are only
  // supported if is_thread_cpu_time_supported() returns true.
  // They are not supported on Solaris T1. 
```

在**hotspot/src/os/linux/vm/os_linux.cpp中**，我确实看到**pthread_getcpuclockid**和**clock_gettime**被用于此目的

在**hotspot/src/os/windows/vm/os_windows.cpp**中，我看到使用了**GetThreadTimes**。

# java - 使用 ListIterator 在 Java 中的 LinkedList 上来回移动

> ID：13483035
> 
> 赞同：21
> 
> 时间：2012-11-20T22:07:51.090
> 
> 标签：java, iterator, linked-list

我有一个 LinkedList 我需要来回迭代多次。我正在使用它来跟踪将动态创建的工作流中的一系列页面。这不符合我的预期。给定这个例子：

```
LinkedList<String> navigationCases;
navigationCases.add("page1");
navigationCases.add("page2");
navigationCases.add("page3");
navigationCases.add("page4");

ListIterator navigationItr = navigationCases.listIterator();
navigationItr.next(); // Returns page1
navigationItr.next(); // Returns page2
navigationItr.previous(); //Returns page2 again
navigationItr.next(); //Returns page2 again 
```

我想也许我错误地构建了我的列表，或者错误地使用了迭代器，但是在阅读了文档之后，这似乎是设计使然：

**ListIterator 没有当前元素；它的光标位置始终位于调用 previous() 将返回的元素与调用 next() 将返回的元素之间。**

和：

**(Next) 返回列表中的下一个元素。可以重复调用此方法以遍历列表，或与调用 previous 混合调用以来回移动。（请注意，交替调用 next 和 previous 将重复返回相同的元素。）**

因此，在阅读完本文后，很清楚为什么我的代码的行为方式如此。我只是不明白为什么它应该这样工作。甚至 remove 似乎也在向后弯曲以适应这种实现：

**请注意，remove() 和 set(Object) 方法不是根据光标位置定义的；它们被定义为对调用 next() 或 previous() 返回的最后一个元素进行操作。**

从概念上讲，LinkedList 似乎很好地模拟了我的工作流案例，但我不能使用以这种方式运行的迭代器。我在这里遗漏了什么，还是我应该编写自己的课程来维护一个案例列表并浏览它们？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T22:44:01.133

这应该做你的工作：

```
public class Main {
    public static void main(String[] args) {
        final LinkedList<String> list = new LinkedList<String> ();

        list.add ("1"); list.add ("2"); list.add ("3"); list.add ("4");

        final MyIterator<String> it = new MyIterator (list.listIterator());

        System.out.println(it.next());
        System.out.println(it.next ());
        System.out.println(it.next ());
        System.out.println(it.previous ());
        System.out.println(it.previous ());
        System.out.println(it.next ());
    }

    public static class MyIterator<T> {

        private final ListIterator<T> listIterator;

        private boolean nextWasCalled = false;
        private boolean previousWasCalled = false;

        public MyIterator(ListIterator<T> listIterator) {
            this.listIterator = listIterator;
        }

        public T next() {
            nextWasCalled = true;
            if (previousWasCalled) {
                previousWasCalled = false;
                listIterator.next ();
            }
            return listIterator.next ();
        }

        public T previous() {
            if (nextWasCalled) {
                listIterator.previous();
                nextWasCalled = false;
            }
            previousWasCalled = true;
            return listIterator.previous();
        }

    }   
} 
```

和一个[小提琴](http://ideone.com/nO3Rmh)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-12-18T12:52:26.370

ListIterator 旨在以这种方式运行。请参阅 ShyJ 答案下方的对话以了解基本原理。

我发现这种行为非常愚蠢，而是写了一个非常简单的替代方案。这是带有 ArrayLists 扩展函数的 Kotlin 代码：

```
class ListIterator<E>(var list: ArrayList<E>) : Iterator<E> {

    private var cursor: Int = 0

    fun replace(newList: ArrayList<E>) {
        list = newList
        cursor = 0
    }

    override fun hasNext(): Boolean {
        return cursor + 1 < list.size
    }

    override fun next(): E {
        cursor++
        return current()
    }

    fun hasPrevious(): Boolean {
        return 0 <= cursor - 1
    }

    fun previous(): E {
        cursor--
        return current()
    }

    fun current(): E {
        return list[cursor]
    }

}

fun <E> ArrayList<E>.listFlippingIterator() = ListIterator(this) 
```

如果您希望包含删除功能，我强烈建议您编写 API 以明确指示迭代器是否应该删除左侧或右侧，例如通过将这些方法定义为`removeNext()`和`removePrevious()`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-20T22:28:10.730

做这样的事情（伪代码）——

```
class SkipIterator extends ListIterator {

    public E previous(){
        E n = super.previous();
        return super.previous();
    }

    ...

} 
```

然后：

```
LinkedList<String> navigationCases;
navigationCases.add("page1");
navigationCases.add("page2");
navigationCases.add("page3");
navigationCases.add("page4");

SkipIterator navigationItr = (SkipIterator)navigationCases.listIterator();
navigationItr.next(); // Returns page1
navigationItr.next(); // Returns page2
navigationItr.previous(); // Returns page1 
```

干杯

# c++ - Qtimer 在 QNetworkAccessManager 完成之前触发

> ID：13483042
> 
> 赞同：0
> 
> 时间：2012-11-20T22:08:14.010
> 
> 标签：c++, qt, qnetworkaccessmanager

我每 X 秒建立一次连接。但如果网络带宽超载，定时器会在 QNetworkAccessManager 发送完成信号和应用程序崩溃之前触发。

主窗口::构造：

```
pTimer = new QTimer(this);
connect(pTimer, SIGNAL(timeout()), this, SLOT(connect()));
pTimer->start(5000); 
```

主窗口::连接()

```
pNetworkManager = new QNetworkAccessManager(this);
connect(pNetworkManager, SIGNAL(finished(QNetworkReply*)), this, SLOT(result(QNetworkReply*)));
pNetworkManager->get(QNetworkRequest(url)); 
```

MainWindow::result(QNetworkReply *reply) 处理响应

如何在计时器再次触发之前检查 QNetworkAccessManager 是否已完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:45:10.400

不要为每个请求创建一个网络管理器，而只为您的班级创建一个网络管理器。否则，您会在每个请求中泄漏管理器，直到主窗口被销毁。

QNetworkManager::get 返回指向代表请求的[QNetworkReply的指针。](http://qt-project.org/doc/qt-4.8/QNetworkReply.html)您可以将该回复存储在 QPointer 中，连接到其信号，检查 QNetworkReply::isFinished() 等以跟踪请求是否仍在运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T11:44:54.037

为什么不在请求完成后简单地启动计时器？

```
pTimer = new QTimer(this);
pTimer->setSingleshot(true);
connect(pTimer, SIGNAL(timeout()), this, SLOT(connect()));
pTimer->start(5000);

pNetworkManager = new QNetworkAccessManager(this);
connect(pNetworkManager, SIGNAL(finished(QNetworkReply*)), this, SLOT(result(QNetworkReply*)));
connect(pNetworkManager, SIGNAL(finished(QNetworkReply*)), pTimer, SLOT(start())); 
```

# .net - PrincipalSearcher 过滤所有不匹配的记录

> ID：13483046
> 
> 赞同：0
> 
> 时间：2012-11-20T22:08:18.470
> 
> 标签：.net, directoryservices

有没有办法使用 PrincipalSearcher 搜索所有不匹配的记录。使用 DirectorySearcher，您可以应用过滤器，例如`(!sn="\*Jay\*")`. 换句话说，所有姓氏不包含序列“Jay”的记录。我想知道是否有任何方法可以使用 UserPrincipal 参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T21:48:49.637

不幸的是，这不是一个选择。我花了相当多的时间试图找到一种方法来轻松/有效地进行更高级的搜索。最接近*高级搜索*的是一些日期选项，但没有文本搜索。

我最终做的是使用 LDAP 查询单独运行 DirectorySearcher。我从搜索中返回的唯一属性（以最小化结果集大小并提高速度）是 DN 和对象类型（如果尚未过滤对象类型）。然后，我使用 DN 创建适当类型的新 Principal 对象并将其添加到集合中。

整个 AccountManagement 库的设计考虑了一组非常小的任务（显然），并且很难扩展。对于大多数任务，我几乎放弃了使用 DirectoryServices，因为它是应该使用的真正库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-08T15:39:16.670

我似乎总是在回答老问题，但这一直在搜索中出现，我相信我已经弄清楚了。如果它可以帮助找到它的人，这就是我设法拼凑的。

您要做的是创建一个自定义`AdvancedFilter`并根据您的需要创建一些自定义搜索规则。默认值相当有限，但您可以创建几乎任何您需要的东西。

你的问题的一个例子可以这样处理

```
public class MyAdvancedFilter : AdvancedFilters
{
    public MyAdvancedFilter(Principal principal) : base(principal)
    {

    }

    public void WhereLastName(string lastName, MatchType match)
    {
        // The * is the normal wildcard for LDAP.
        // Remove *'s for an exact match, or create a parameter to choose what to do.
        this.AdvancedFilterSet("sn", "*" + lastName + "*", typeof(string), match);
    }
} 
```

为了使用这个，你还必须有一个`UserPrincipal`实现这个的自定义对象。

```
[DirectoryObjectClass("user")]
[DirectoryRdnPrefix("CN")]
public class MyUser : UserPrincipal
{
    public MyUser(PrincipalContext context) : base(context)
    {

    }

    private MyAdvancedFilter searchFilter;
    // use custom search filters
    public new MyAdvancedFilter AdvancedSearchFilter
    {
        get
        {
            if (searchFilter == null)
                searchFilter = new MyAdvancedFilter(this);

            return searchFilter;
        }
    }
} 
```

现在您已准备好使用此代码。

```
MyUser u = new MyUser();
// find users without the last name containing "Jay"
u.AdvancedSearchFilter.WhereLastName("Jay", MatchType.NotEquals);

PrincipalSearcher ps = new PrincipalSearcher(u);
var res = ps.FindAll().Cast<MyUser>();

foreach (MyUser p in res)
{
    // use the results here.
} 
```

希望它可以帮助某人。

# java - 创建一个简单的事件驱动架构

> ID：13483048
> 
> 赞同：6
> 
> 时间：2012-11-20T22:08:23.570
> 
> 标签：java, events, architecture, event-driven

目前有一个项目有点麻烦。我正在实现一个游戏，我希望它是事件驱动的。

到目前为止，我有一个 EventHandler 类，它有一个重载方法，具体取决于生成的事件类型（PlayerMove、Contact、Attack 等）

我将让游戏驱动程序或类生成事件。我的问题是如何在不将事件生成类与事件处理程序紧密耦合并使 EDA 的使用变得多余的情况下有效地处理事件？

我想设计自己的简单处理程序，而不是为此使用内置的 Java

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T22:28:45.153

如果您想要一个`EventHandler`具有重载方法的类并且您的事件类型没有任何子类，那么这个使用反射的简单代码应该可以工作：

```
public class EventHandler {
    public void handle (final PlayerMove move) {
       //... handle
    }

    public void handle (final Contact contact) {
       //... handle
    }

    public void handle (final Attack attack) {
       //... handle
    }
}

public void sendEvent (final EventHandler handler, final Object event) {
    final Method method = EventHandler.class.getDeclaredMethod ("handle", new Class[] {event.getClass ()});
    method.invoke (handler, event);
} 
```

但是，如果您想`EventHandler`为不同的事件设置单独的 s，以下会更好。

```
public interface EventHandler<T extends Event> {
    void handle (T event);
}

public class PlayerMoveEventHandler implements EventHandler<PlayerMove> {
    @Override
    public void handle (final PlayerMove event) {
        //... handle
    }
}

public class EventRouter {
    private final Map<Class, EventHandler> eventHandlerMap = new HashMap<Class, EventHandler> ();

    public void sendEvent (final Event event) {
        eventHandlerMap.get (event.getClass ()).handle (event);
    }

    public void registerHandler (final Class eventClass, final EventHandler handler) {
        eventHandlerMap.put (eventClass, handler);
    }
} 
```

# xml - 从兄弟节点获取数据到数据等于其他节点数据的节点

> ID：13483050
> 
> 赞同：1
> 
> 时间：2012-11-20T22:08:29.187
> 
> 标签：xml, variables, xslt, merge, matching

我在一个 XSLT 文档中处理两个 XML 文档，并尝试将要放入一个 HTML 文档的数据合并。

文档在一个点上匹配，即 id。id 将作为*foo1.xml*中汽车节点的属性找到。关于*foo2.xml*的 id 可以在 Data 节点中找到，它是第一个 Cell 节点的子节点（它是 Row 节点的子节点）。第一个 Cell 节点之后的 Cell 节点包含 Data 节点，其中包含所需的数据（颜色和条件）。

当在 XSLT 文档中将数据添加到 td 单元格时，我（以某种方式）需要在*foo2.xml*中找到正确的 id ，并在最后两个 td 中输入汽车的颜色和状况。

在下面的 XSLT 文档中，您可以看到我失败的尝试这样做。那么，如何做到这一点呢？

提前非常感谢！

注意：两个文件中 id 的顺序不同。

**foo1.xml：**

```
<cars>
  <car id="8">
    <brand>Saab</brand>
    <model>95</model>
    <year>2011</year>
  </car>
  <car id="57">
    <brand>Chrysler</brand>
    <model>Voyager</model>
    <year>2010</year>
  </cars>
  ... 
```

**foo2.xml：**

```
<Table ss:ExpandedColumnCount="5" ss:ExpandedRowCount="79" x:FullColumns="1"
   x:FullRows="1" ss:DefaultColumnWidth="65" ss:DefaultRowHeight="15">
   <Column ss:Index="2" ss:AutoFitWidth="0" ss:Width="43"/>
   <Column ss:AutoFitWidth="0" ss:Width="113"/>
   <Column ss:Index="5" ss:AutoFitWidth="0" ss:Width="220"/>
   <Row ss:Index="6">
    <Cell ss:Index="3" ss:StyleID="s62"/>
   </Row>
   <Row>
    <Cell ss:Index="3" ss:StyleID="s62"/>
   </Row>
   <Row>
    <Cell ss:Index="3" ss:StyleID="s62"/>
   </Row>
   <Row>
    <Cell ss:Index="2"><Data ss:Type="String">57</Data></Cell>    // <-- where the id is to be found
    <Cell ss:StyleID="s62"><Data ss:Type="String">Yellow</Data></Cell>
    <Cell><Data ss:Type="String">New</Data></Cell>
   </Row>
   <Row>
    <Cell ss:Index="2"><Data ss:Type="Number">8</Data></Cell>    // <-- where the id is to be found
    <Cell ss:StyleID="s62"><Data ss:Type="Number">Black</Data></Cell>
    <Cell><Data ss:Type="Number">Used</Data></Cell>
   </Row>
   <Row>
    <Cell ss:Index="2"><Data ss:Type="Number">25</Data></Cell>    // <-- where the id is to be found
    <Cell ss:StyleID="s62"><Data ss:Type="Number">Blue</Data></Cell>
    <Cell><Data ss:Type="Number">Used</Data></Cell>
   </Row>
   ... 
```

**合并.xsl：**

```
 <- declarations... ->
         xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" >   <-- the XML namespace (ss:)

    <xsl:variable name="foo2" select="document('foo2.xml')" />

    <xsl:template match="/">
        <html>
            <head>
                <title>Cars</title>
            </head>
        <body>
            <xsl:apply-templates select="cars" />
        </body>  
        </html>
    </xsl:template>

    <xsl:template match="cars">

    <xsl:for-each select="$foo2//ss:Row">
        <xsl:value-of select="ss:Cell/ss:Data/text()" />
    </xsl:for-each>

    <table>
        <tr>
            <th>Id</th> <th>Brand</th> <th>Model</th> <th>Year</th> <th>Color</th> <th>Condition</th>
        </tr>
        <xsl:apply-templates select="car" />
    </table>
    </xsl:template>

    <xsl:template match="car">
        <xsl:variable name="id" select="data[2]/text()" />
            <tr>
                <td><xsl:value-of select="@id" /></td>
                <td><xsl:value-of select="brand" /></td>
                <td><xsl:value-of select="model" /></td>
                <td><xsl:value-of select="year" /></td>

                <td><xsl:value-of select="$positions//ss:Row/ss:Cell/ss:Data=@id/preceding-sibling::ss:Cell" /></td> <-- failed try (color)
                <td> ??? (Condition) </td>
            </tr>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:38:00.030

**这种转变：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kRowById" match="Row" use="Cell[1]/Data"/>

 <xsl:variable name="vDoc2" select="document('file:///c:/temp/delete/foo2.xml')"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="car">
  <xsl:variable name="vId" select="@id"/>
  <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     <xsl:for-each select="$vDoc2">
       <color><xsl:value-of select="key('kRowById', $vId)/Cell[2]/Data"/></color>
       <condition><xsl:value-of select="key('kRowById', $vId)/Cell[3]/Data"/></condition>
     </xsl:for-each>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的`foo1.xml`文件**时：

```
<cars>
    <car id="8">
        <brand>Saab</brand>
        <model>95</model>
        <year>2011</year>
    </car>
    <car id="57">
        <brand>Chrysler</brand>
        <model>Voyager</model>
        <year>2010</year>
    </car>
</cars> 
```

**并将所提供的`foo2.xml`文件存放在`c:\temp\delete`：**

```
 <Table xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
       xmlns:x="some:x"
       ss:ExpandedColumnCount="5" ss:ExpandedRowCount="79" x:FullColumns="1"
       x:FullRows="1" ss:DefaultColumnWidth="65" ss:DefaultRowHeight="15">
       <Column ss:Index="2" ss:AutoFitWidth="0" ss:Width="43"/>
       <Column ss:AutoFitWidth="0" ss:Width="113"/>
       <Column ss:Index="5" ss:AutoFitWidth="0" ss:Width="220"/>
       <Row ss:Index="6">
        <Cell ss:Index="3" ss:StyleID="s62"/>
       </Row>
       <Row>
        <Cell ss:Index="3" ss:StyleID="s62"/>
       </Row>
       <Row>
        <Cell ss:Index="3" ss:StyleID="s62"/>
       </Row>
       <Row>
        <Cell ss:Index="2"><Data ss:Type="String">57</Data></Cell>    // -- where the id is to be found
        <Cell ss:StyleID="s62"><Data ss:Type="String">Yellow</Data></Cell>
        <Cell><Data ss:Type="String">New</Data></Cell>
       </Row>
       <Row>
        <Cell ss:Index="2"><Data ss:Type="Number">8</Data></Cell>    // -- where the id is to be found
        <Cell ss:StyleID="s62"><Data ss:Type="Number">Black</Data></Cell>
        <Cell><Data ss:Type="Number">Used</Data></Cell>
       </Row>
       <Row>
        <Cell ss:Index="2"><Data ss:Type="Number">25</Data></Cell>    // -- where the id is to be found
        <Cell ss:StyleID="s62"><Data ss:Type="Number">Blue</Data></Cell>
        <Cell><Data ss:Type="Number">Used</Data></Cell>
       </Row>
</Table> 
```

**产生想要的和正确的合并输出**：

```
<cars>
   <car id="8">
      <brand>Saab</brand>
      <model>95</model>
      <year>2011</year>
      <color>Black</color>
      <condition>Used</condition>
   </car>
   <car id="57">
      <brand>Chrysler</brand>
      <model>Voyager</model>
      <year>2010</year>
      <color>Yellow</color>
      <condition>New</condition>
   </car>
</cars> 
```

**说明**：

正确使用：

1.  **[`document()`](http://www.w3.org/TR/xslt#function-document)**功能。

2.  **[键](http://www.w3.org/TR/xslt#key)**。

3.  **[`<xsl:for-each>`](http://www.w3.org/TR/xslt#element-for-each)**更改当前文档的指令。在 XSLT 1.0 中，该**[`key()`](http://www.w3.org/TR/xslt#function-key)**函数对*当前文档*进行操作。

# ruby - ruby on rails：如何为新模型创建表

> ID：13483051
> 
> 赞同：11
> 
> 时间：2012-11-20T22:08:30.033
> 
> 标签：ruby, database, ruby-on-rails-3

我用

```
rails generate model mynewmodel string:name string:description 
```

生成一个新模型。如何将此新模型部署到我的开发数据库？我的 sqlite 数据库中已经有一堆数据库。

我试过了

```
rake db:migrate 
```

在 db 中生成这个新表似乎有问题。

**更新**：添加错误消息

```
==  CreateMynewmodels: migrating ===============================================
-- create_table(:mynewmodels)
rake aborted!
An error has occurred, this and all later migrations canceled:

undefined method `name' for #<ActiveRecord::ConnectionAdapters::TableDefinition:0x3ad5c50>

Tasks: TOP => db:migrate 
```

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-20T22:13:45.540

您的 fieldname:type 组合的顺序不正确。尝试

```
rails generate model mynewmodel name:string description:string 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T22:14:04.547

中的错误`rails generate model mynewmodel string:name string:description`

你应该交换`string`和`name`

`rails generate model mynewmodel name:string description:string`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T22:14:42.383

使用`name:string`而不是`string:name`相同的描述

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-13T13:18:24.727

高级用法的好文章： [Advanced Rails 模型生成器](http://railsguides.net/2013/06/29/advanced-rails-model-generators/)

> 请注意，您必须将参数 price:decimal{10,2} 包装到引号中。这很重要，如果您不这样做，您可能会遇到不正确的生成器行为。

# jquery - jQuery & XML 之谜得到 Digits NOT Letters

> ID：13483052
> 
> 赞同：2
> 
> 时间：2012-11-20T22:08:32.400
> 
> 标签：jquery, html, xml

**大编辑 2012 年 11 月 19 日**

所以，我的问题就在这里。我正在尝试使用 jQuery 和 XML 开发一个简单的购物车应用程序。

一切正常，但前提是 My pizz 的名称仅包含数字...**为什么 ???**

试试自己，你会发现只有“66666”披萨在起作用……**为什么？**

[工作演示在这里](http://bzez.0fees.net/examples/jXML/)

**这是我的js代码：**

```
$(document).ready(function(){
 $.ajax({
  type: "GET",
  url: "example.xml", 
  dataType: ($.browser.msie) ? "text" : "xml",
  success: function(xml) {  
   $(xml).find('row').each(function(){
    var Col0 = $(this).find('nompizz').text();
    var Col1 = $(this).find('petit').text();
    var Col2 = $(this).find('moyen').text();
    var Col3 = $(this).find('grand').text();

    $('<tr id="bar"></tr>').html('<th class="title">'+Col0+'</th><td onclick="DisPlay('+Col1+');GetName('+Col0+');">'+Col1+'€&lt;/td><td onclick="DisPlay('+Col2+');GetName('+Col0+');">'+Col2+'€&lt;/td><td onclick="DisPlay('+Col3+');GetName('+Col0+');">'+Col3+'€&lt;/td>').appendTo('#pizzas');

   });
  }
 }); 
});
function DisPlay(Figure) {   
     var Display = document.getElementById('Display');
     if (Figure === null) {
         Display.value = Figure;
     }
     else {
         Display.value += "+"+Figure;
         Screen = Display.value
         result = eval(Screen);

         Display.value =result;
     }

      Figure = null;
}
function GetName(NomPizz) {
      var $newItem = '<li>Ajouté: '+NomPizz+'</li>';
      $('.theList').append($newItem); 
} 
```

**这里是我的 XML：**

```
<?xml version="1.0"?>
<document>
 <row>
  <nompizz>66666</nompizz>
  <petit>10</petit >
  <moyen>15</moyen >
  <grand>20</grand>
 </row>
 <row>
  <nompizz>Letters</nompizz >
  <petit>15</petit >
  <moyen>20</moyen >
  <grand>25</grand>
 </row>
</document> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T16:17:47.323

我认为您的问题是您的`GetAnswer()`功能与应用程序的其余部分无关。它不知道点击了什么。我认为最简单的做法是将`nom`参数添加到`DisPlay()`函数调用中。像这样：（删除换行符）

```
$('<tr id="bar"></tr>').html('<th class='+Col0+' data-item='+Col0+'>'+Col0+'</th>    <td onclick="DisPlay('+Col1+',\"'+Col0+'\")">'+Col1+'€&lt;/td>    <td onclick="DisPlay('+Col2+',\"'+Col0+'\")">'+Col2+'€&lt;/td>    <td onclick="DisPlay('+Col3+',\"'+Col0+'\")">'+Col3+'€&lt;/td>').appendTo('#pizzas'); 
```

然后你的`DisPlay(Figure)`变成：

```
function DisPlay(Figure, nom) {
    var Display = document.getElementById('Display');
    if (Figure === null) {
        Display.value = Figure;
    }
    else 
    {
        Display.value += "+"+Figure;

        //instead of this --> //GetAnswer();

        //in your old code you had some of these variables declared as non-global variables, but were using them like they were global variables
        Screen = Display.value.replace(/'/g, ' ');
        result = eval(Screen);   
        Display.value = result;
        $('.theList').append('<li>Ajouté: '+nom+'</li>');
    }
    Figure = null;
} 
```

关于全局变量与非全局变量的一句话。如果您在函数内部“更改”某些内容，则该变量是该函数的本地变量。似乎您正在混合和匹配您的变量。有关更多信息，[请阅读这篇文章。](https://stackoverflow.com/questions/1470488/difference-between-using-var-and-not-using-var-in-javascript)

编辑：

在您进行新编辑后，您只会获得数字披萨名称，因为您需要在适当的位置加上引号。尝试将所有内容更改`GetName('+Col0+');`为`GetName(\''+Col0+'\');`

所以整行将显示为：

```
$('<tr id="bar"></tr>').html('<th class="title">'+Col0+'</th><td onclick="DisPlay('+Col1+');GetName(\''+Col0+'\');">'+Col1+'€&lt;/td><td onclick="DisPlay('+Col2+');GetName(\''+Col0+'\');">'+Col2+'€&lt;/td><td onclick="DisPlay('+Col3+');GetName(\''+Col0+'\');">'+Col3+'€&lt;/td>').appendTo('#pizzas'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T05:35:22.170

实际上的问题是您的`onclick`函数在不带引号的情况下传递字符串，为两者加上引号，`GetName('value')`它将`DisPlay('value')`解决问题。

```
<td onclick="DisPlay('"+Col1+"');GetName('"+Col0+"');">'+Col1+'€&lt;/td> 
```

问题：

如果你把字符串不带引号 js 会认为它是变量，并通过未定义变量的错误而数字将起作用，因为 int 不需要任何引号：

例如; 文本

它将执行`DisPlay`并将 15 作为 int 在执行`GetName(Letter)`时它将尝试查找`Letter`未定义的变量而`GetName('Letter')`将执行。

# vb.net - 我可以在家中使用 Visual Studio Express 2012 for Web 或 2010 供个人使用吗？

> ID：13483055
> 
> 赞同：0
> 
> 时间：2012-11-20T22:08:41.527
> 
> 标签：vb.net, visual-studio-2010

我可以在家中使用 Visual Studio Express 2012 for Web 或 2010 供个人使用吗？我是网络开发的新手，我没有任何付费或学生版的 Visual Studio 或任何东西。

我很好奇我是否可以使用这些，因为我注意到 30 天后它会提示您注册产品。在该注册中，它会询问您的业务您的工作头衔、工作电话等。

我不打算出售我的软件，但我可能会。这是允许的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:10:34.633

如果您使用的是 Microsoft 开发工具的“快速”版本，您完全可以在家中免费使用它供个人使用，是的。这就是他们的 Express 版工具集的重点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T06:21:01.423

互联网上的普遍共识表明，您可以将 express 用于个人和商业用途。

[http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/1aaf1efc-04df-40b9-9289-f3db0420c206](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressinstall/thread/1aaf1efc-04df-40b9-9289-f3db0420c206)

# ruby-on-rails - Rails 3，多对多形式使用accepts_nested_attributes_for，如何正确设置？

> ID：13483057
> 
> 赞同：4
> 
> 时间：2012-11-20T22:08:57.453
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, nested-attributes, has-many-through

**我在Recipes**和**Ingredients**之间有多对多的关系。我正在尝试构建一个允许我在*食谱中添加成分*的表单。

（这个问题的变体已经被反复问过，我已经花了几个小时在这个问题上，但从根本上被什么弄糊涂了`accepts_nested_attributes_for`。）

在你被下面的所有代码吓到之前，我希望你会明白这确实是一个基本问题。以下是不可怕的细节......

### 错误

当我显示一个创建配方的表单时，我收到错误“未初始化的常量配方::IngredientsRecipe”，指向我的表单部分中的一行

```
18:   <%= f.fields_for :ingredients do |i| %> 
```

如果我更改此行以使“成分”单数

```
<%= f.fields_for :ingredient do |i| %> 
```

然后显示表单，但是当我保存时，我得到一个 mass assignment error `Can't mass-assign protected attributes: ingredient`。

### 模型（在 3 个文件中，相应命名）

```
class Recipe < ActiveRecord::Base
  attr_accessible :name, :ingredient_id
  has_many :ingredients, :through => :ingredients_recipes
  has_many :ingredients_recipes

  accepts_nested_attributes_for :ingredients
  accepts_nested_attributes_for :ingredients_recipes
end

class Ingredient < ActiveRecord::Base
  attr_accessible :name, :recipe_id
  has_many :ingredients_recipes
  has_many :recipes, :through => :ingredients_recipes

  accepts_nested_attributes_for :recipes
  accepts_nested_attributes_for :ingredients_recipes
end

class IngredientsRecipes < ActiveRecord::Base
  belongs_to :ingredient
  belongs_to :recipe

  attr_accessible :ingredient_id, :recipe_id
  accepts_nested_attributes_for :recipes
  accepts_nested_attributes_for :ingredients
end 
```

### 控制器

作为 RESTful 资源生成的`rails generate scaffold`

### 而且，因为“recipe”的复数形式不规则，`inflections.rb`

```
ActiveSupport::Inflector.inflections do |inflect|
    inflect.irregular 'recipe', 'recipes'
end 
```

### 查看 ( `recipes/_form.html.erb`)

```
<%= form_for(@recipe) do |f| %>
  <div class="field">
    <%= f.label :name, "Recipe" %><br />
    <%= f.text_field :name %>
  </div>
  <%= f.fields_for :ingredients do |i| %>
    <div class="field">
      <%= i.label :name, "Ingredient" %><br />
      <%= i.collection_select :ingredient_id, Ingredient.all, :id, :name %>
    </div>
  <% end %>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

### 环境

*   导轨 3.2.9
*   红宝石 1.9.3

### 尝试了一些东西

如果我更改视图`f.fields_for :ingredient`然后加载表单（它找到`Recipe::IngredientRecipe`正确，但是当我保存时，我收到如上所述的批量分配错误。这是日志

```
Started POST "/recipes" for 127.0.0.1 at 2012-11-20 16:50:37 -0500
Processing by RecipesController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"/fMS6ua0atk7qcXwGy7NHQtuOnJqDzoW5P3uN9oHWT4=", "recipe"=>{"name"=>"Stewed Tomatoes", "ingredient"=>{"ingredient_id"=>"1"}}, "commit"=>"Create Recipe"}
Completed 500 Internal Server Error in 2ms

ActiveModel::MassAssignmentSecurity::Error (Can't mass-assign protected attributes: ingredient):
  app/controllers/recipes_controller.rb:43:in `new'
  app/controllers/recipes_controller.rb:43:in `create' 
```

控制器中的故障线很简单

```
@recipe = Recipe.new(params[:recipe]) 
```

所以传递的参数，包括嵌套属性，在某种程度上是不正确的。但是我已经尝试了很多变体，它们可以修复一个又一个。我不明白什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T16:10:14.157

多亏了所有人的线索，我发现我的方法有什么问题。这是我解决它的方法。

我最初尝试使用简单的 HABTM 多对多关系，其中连接表按照标准 Rails 约定命名：`ingredients_recipes`. 然后我意识到，在某种程度上，`accepts_nested_attributes_for`它是为一对多的关系而设计的。于是我转为使用`has_many_through`，创建模型`IngredientsRecipes`。

`build`这个名字是核心问题，因为 Rails 在使用创建表单元素时需要能够从复数转换为单数。这导致它寻找不存在的类`Recipe::IngredientsRecipe`。当我更改我的表单以便它使用`fields_for :ingredient`显示的表单时，但仍然无法保存并出现批量分配错误。当我添加`:ingredients_attributes`到`attr_accessible`. 当我添加`@recipe.ingredients.build`到`RecipesController#new`.

将模型更改为单数形式是解决问题的最后关键。 `IngredientsRecipe`本来可以的，但我选择了`RecipeIngredients`，因为它更有意义。

所以总结一下：

*   不能`accepts_nested_attributes_for`与`has_and_belongs_to_many`;一起使用 需要选项`has_many`。`through`（感谢@kien_thanh）
*   添加`accepts_nested_attributes_for`创建一个必须添加到`attr_accessible`表单中的访问器`<plural-foreign-model>_attributes`，例如在`Recipe`我添加`attr_accessible :name, :ingredients_attributes`（感谢@beerlington）
*   在控制器的方法中显示表单之前，必须在创建新实例后`new`调用外部模型，如. 这导致 HTML 的名称类似于（感谢@bravenewweb）`build``3.times { @recipe.ingredients.build }``recipe[ingredients_attributes][0][name]`
*   与所有模型一样，连接模型必须是单数的。（全是我:-)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T22:21:53.617

如果您检查生成的表单，您会注意到嵌套字段的名称类似于“ingredients_attributes”。您收到批量分配错误的原因是您需要将这些字段添加到`attr_accessible`声明中。

像这样的东西应该可以解决它（您需要仔细检查字段名称）：

```
class Recipe < ActiveRecord::Base
  attr_accessible :name, :ingredients_attributes
  #...
end 
```

**更新**：这里有一个[类似的答案](https://stackoverflow.com/a/12064105/167614)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T02:34:49.987

将通话保留为

```
<%= f.fields_for :ingredients do |i| %> 
```

但在那之前做

```
<% @recipe.ingredients.build %> 
```

我猜这将允许以正确的方式创建您的表单，但是您的模型可能存在其他错误，如果它仍然无法正常工作，我可以在有更多时间时更详细地查看@它，但是：

就 accept_nested_attributes_for 所做的而言，当您将格式正确的 params 哈希传递给 Model.new 或 Model.create 或 Model.update 时，如果相关模型上的这些属性位于 params 哈希中，则它允许保存这些属性。此外，如果如 beerlington 所述，如果它们在父模型中不可访问，则您确实需要使属性可访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T04:41:06.187

我认为你只需要建立一个一对多的关联，一个配方有很多成分，一种成分属于一个配方，所以你的模型看起来像：

```
class Recipe < ActiveRecord::Base
  attr_accessible :name, :ingredients_attributes
  has_many :ingredients

  accepts_nested_attributes_for :ingredients
end

class Ingredient < ActiveRecord::Base
  attr_accessible :name, :recipe_id
  belongs_to :recipe
end 
```

你是正确的形式，所以我不再在这里写了。现在在您的新和创建控制器中将是这样的：

```
def new
  @recipe = Recipe.new

  # This is create just one select field on form
  @recipe.ingredients.build 

  # Create two select field on form
  2.times { @recipe.ingredients.build }

  # If you keep code above for new method, now you create 3 select field
end

def create
  @recipe = Recipe.new(params[:recipe])
  if @recipe.save
    ...
  else
    ...
  end
end 
```

看起来怎么`params[:recipe]`样？如果您只有一个选择字段，可能是这样的：

```
params = { recipe: { name: "Stewed Tomatoes", ingredients_attributes: [ { id: 1 } ] } } 
```

如果您有 2 个成分选择字段：

```
params = { recipe: { name: "Stewed Tomatoes", ingredients_attributes: [ { id: 1 }, { id: 2 } ] } } 
```

# homebrew - 如何修复“brew install pkg-config”？

> ID：13483059
> 
> 赞同：24
> 
> 时间：2012-11-20T22:08:59.750
> 
> 标签：homebrew, pkg-config

```
Warning: Could not link pkg-config. Unlinking...
Error: The `brew link` step did not complete successfully
The formula built, but is not symlinked into /usr/local
You can try again using `brew link pkg-config`‏‏‏‏‏‏ 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-20T22:08:59.750

1.  brew 重新安装 pkg-config
2.  rm -R 违规目录
3.  重复步骤 1

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-12-12T15:24:08.003

正如迈克尔·皮格（Michael Pigg）上面所说，就我而言，这是文件夹权限问题。我必须执行以下操作：

```
sudo chmod 777 /usr/local/bin
sudo chmod 777 /usr/local/share/man/man1
brew link pkg-config 
```

在我完成之后：

```
sudo chmod 755 /usr/local/bin
sudo chmod 755 /usr/local/share/man/man1 
```

恢复原来的权限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-09T09:17:39.533

这可能是 /usr/local/share 上的权限问题。您需要在该目录中具有写入权限才能完成链接。但是，如果您设置了写权限，zsh 会抱怨目录不安全。我授予了写入权限以允许安装 pkg-config，然后将其删除，以便 zsh 满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T07:24:13.073

1.  重新安装命令行工具：[https ://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)
2.  酿造链接 --overwrite --dry-run pkg-config

# java - 将数据解析为 DocumentHTML

> ID：13483067
> 
> 赞同：1
> 
> 时间：2012-11-20T22:09:17.313
> 
> 标签：java, android, html

当我使用 InputStreamReader 从网页读取数据时，一切正常。我在将数据解析为 DocumentHTML 时遇到问题。

主要原因是 HTML 脚本中有一些特殊字符使用不正确。有一个 & 符号两次（ "&&" ），我相信这会导致代码崩溃。

我的代码如下所示：

```
URL url = new URL(PageUrl);
URLConnection conn = url.openConnection();
// ... omitted ...

// parsing
HTMLDocument doc = (HTMLDocument)db.parse(conn.getInputStream()); 
```

由于我正在制作 Android 应用程序，因此我不使用标准解析函数，因为 DocumentHTML 对象会太大。

我发现了许多现有的解析 HTML 的例子，比如使用 jsoup，但它们不是我想要的。

我想编写自己的解析代码，以使 HTMLDocument 对象保持较小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:30:26.390

为什么不使用 java 中所有可用的 Html 解析器？他们有社区支持，因此是最佳选择。

[Java 中的开源 HTML 解析器](http://java-source.net/open-source/html-parsers)

# vba - Excel VBA 创建所有可能的组合（不重复）

> ID：13483071
> 
> 赞同：2
> 
> 时间：2012-11-20T22:09:50.573
> 
> 标签：vba, excel

我需要以下 excel 以及看起来像 VBA 问题的帮助。

这里的想法是在每个分组中生成所有可能的组合（不重复）。

输入

```
COLUMN A | COLUMN B

A | 1

X | 1

D | 1

C | 2

E | 2 
```

输出

```
COLUMN A | COLUMN B

A | X

A | D

X | D

X | A

D | A

D | X

C | E

E | C 
```

我设法做到了....仅当数据在同一组中时，我如何让它运行。

```
Option Explicit

Sub Sample()

    Dim i As Long, j As Long
    Dim CountComb As Long, lastrow As Long

    Application.ScreenUpdating = False

    CountComb = 0: lastrow = 1

    For i = 1 To 10: For j = 1 To 10

        Range("G" & lastrow).Value = Range("A" & i).Value & "/" & _
                                     Range("B" & j).Value

        lastrow = lastrow + 1
        CountComb = CountComb + 1
    Next: Next

    Application.ScreenUpdating = True
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T13:41:02.863

见下文。**请注意，您需要在 Tools >> References 中添加参考 Microsoft Scripting Runtime**。将 Range("A1:A5") 更改为动态命名范围或静态范围，例程将为您处理其余部分。它显示从 G1 开始的结果，但您也可以将其更改/使动态作为数据范围的偏移量。由你决定。

```
Option Explicit
Option Base 1

Dim Data As Dictionary

Sub GetCombinations()

    Dim dataObj As Variant
    Dim returnData As Variant
    Set Data = New Dictionary
    Dim i As Double

    dataObj = Range("A1:B5").Value2

    ' Group Data
    For i = 1 To UBound(dataObj) Step 1

        If (Data.Exists(dataObj(i, 2))) Then
            Data(dataObj(i, 2)) = Data(dataObj(i, 2)) & "|" & dataObj(i, 1)
        Else
            Data.Add dataObj(i, 2), dataObj(i, 1)
        End If

    Next i

    ' Extract combinations from groups
    returnData = CalculateCombinations().Keys()

    Range("G1").Resize(UBound(returnData) + 1, 1) = Application.WorksheetFunction.Transpose(returnData)

End Sub

Private Function CalculateCombinations() As Dictionary

    Dim i As Double, j As Double
    Dim datum As Variant, pieceInner As Variant, pieceOuter As Variant
    Dim Combo As New Dictionary
    Dim splitData() As String

    For Each datum In Data.Items

        splitData = Split(datum, "|")
        For Each pieceOuter In splitData
            For Each pieceInner In splitData

                If (pieceOuter <> pieceInner) Then

                    If (Not Combo.Exists(pieceOuter & "|" & pieceInner)) Then
                        Combo.Add pieceOuter & "|" & pieceInner, vbNullString
                    End If

                End If

            Next pieceInner
        Next pieceOuter

    Next datum

    Set CalculateCombinations = Combo

End Function 
```

# java - 从命令行编译类时出错

> ID：13483072
> 
> 赞同：0
> 
> 时间：2012-11-20T22:09:52.880
> 
> 标签：java, servlets, compilation

我尝试使用以下命令从 Mac 终端编译 Select.java servlet；

```
MyComputer-iMac:src name$ javac -Xlint:unchecked  
-classpath /Users/name/Development/apache-tomcat-6.0.35/lib
/servlet-api.jar:classes:.com/web/Select.java 
```

我得到这个错误；

```
com/web/Select.java:18: cannot find symbol
symbol  : class List
location: class com.web.Select
List result=be.getBrands(color);
^ 
```

我在 Select 类中导入了 java.io。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T22:12:09.727

谁说列表是 java.io？列表通常是 java.util.List

# scala - Scala递归类型别名错误

> ID：13483076
> 
> 赞同：8
> 
> 时间：2012-11-20T22:10:25.420
> 
> 标签：scala, types

我有几个函数，其唯一的参数要求是它具有某种可增长的集合（即它可以是队列、列表、优先队列等），因此我尝试创建以下类型别名：

```
type Frontier = Growable[Node] with TraversableLike[Node, Frontier] 
```

与函数定义一起使用，如下所示：

```
def apply(frontier: Frontier) = ??? 
```

但类型别名返回错误“涉及类型 Frontier 的非法循环引用”。有没有办法绕过非法循环引用来使用类型别名或类似的东西？

一种解决方案是使用以下内容：

```
def apply[F <: Growable[Node] with TraversableLike[Node, F]](f: F) = ??? 
```

但是当函数定义看起来与类型别名完全相同时，这似乎增加了不必要的冗长。该类型也用于其他地方，因此类型别名将大大增加可读性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T22:58:05.450

从[规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)的第 4.3 节：

> 定义（第 4 节）和类型参数（第 4.6 节）的范围规则使得类型名称可以出现在其自身的边界或右侧。但是，如果类型别名递归地引用已定义的类型构造函数本身，则会出现静态错误。

所以不，没有办法直接做到这一点，但你可以用类型别名上的类型参数完成很多相同的事情：

```
type Frontier[F <: Frontier[F]] = Growable[Int] with TraversableLike[Int, F] 
```

现在你只需要`apply`这样写：

```
def apply[F < Frontier[F]](frontier: F) = ??? 
```

仍然比您假设的第一个版本稍微冗长，但比写出整个内容要短。

您也可以只对存在类型使用通配符简写：

```
type Frontier = Growable[Node] with TraversableLike[Node, _] 
```

现在你的第一个`apply` *将按*原样工作。您只是说必须有*某种*适合该插槽的类型，但您不在乎它是什么。

但是，特别是在这种情况下，您是否有理由不使用它`Traversable[Node]`？它实际上会完成同样的事情，并且没有对其表示类型进行参数化。

# objective-c - 同步运行时，AFNetworking 永远不会完成

> ID：13483077
> 
> 赞同：0
> 
> 时间：2012-11-20T22:10:27.933
> 
> 标签：objective-c, ios, objective-c-blocks, afnetworking, synchronous

在有人向我发送垃圾邮件告诉我它不是最佳实践之前，我有正当理由在这种情况下不使用异步方法。

我试图强制我的 AFNetworking 库以同步模式运行某些方法调用（它已被分解）。

这是我的（被黑）片段：

```
 NSURL *url = [NSURL URLWithString:_apiBaseUrl];
    AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:url];
    NSMutableURLRequest *request = [client requestWithMethod:@"POST" path:path parameters:nil];

    NSDictionary *requestDict = [NSDictionary dictionaryWithObjects:@[@"2.0", path, params, [NSNumber numberWithInt:(int)[[NSDate date] timeIntervalSince1970]]] forKeys:@[@"jsonrpc", @"method", @"params", @"id"]];

    NSString *requestBody = [requestDict JSONString];

    NSLog(@"requestBody: %@", requestBody);

    // Set the request body
    [request setHTTPBody:[requestBody dataUsingEncoding:NSASCIIStringEncoding]];
    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {

        // Do something with the success (never reached)
        successBlock(request, response, JSON);

    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
        failureBlock(request, response, error, JSON);
    }];

    if (queue == 1) {
        [self.operationArray addObject:operation];
    }
    else {
        [operation waitUntilFinished];
        successBlock(nil, nil, nil);            
        //[operation start];

    } 
```

当运行该方法并且队列参数强制该方法 waitUntilFinished 时，永远不会到达成功块，也不会到达下一行。如果我使用 start 方法，它工作正常。

# ios - 建立在 4 英寸显示器上不显示黑色顶部和底部栏

> ID：13483078
> 
> 赞同：0
> 
> 时间：2012-11-20T22:10:31.680
> 
> 标签：ios, iphone, xcode

我最近完成了我的应用程序，但还没有实现 4 英寸屏幕。我决定还是把它上传到应用商店，然后再做 4 英寸的版本。如果在 4 英寸显示器上使用该应用程序，我希望显示黑色的顶部和底部栏。

我有一个名为 Default-568h@2x.png 的默认图像，但是当我构建它并将模拟器更改为 4 英寸时，它会拉伸我的屏幕并且不显示黑条。如果我删除 Default-568h@2x.png 它不会改变任何事情。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:41:56.797

在 Xcode 中删除文件不会从已安装的应用程序/构建文件夹/等中删除它们。这非常烦人。如果您真的希望您的应用程序仅在 3.5 英寸模式下运行，请删除 Default-568 文件并确保在 Xcode 中运行 Clean/Clean Build Folder，然后将应用程序完全从您的模拟器/设备中删除。它应该再次开始显示信箱。

Apple 仍然只接受 3.5 英寸的提交。

# android - Android 套接字失败

> ID：13483082
> 
> 赞同：0
> 
> 时间：2012-11-20T22:10:41.777
> 
> 标签：android, sockets, client

这是我的服务器代码

```
 using System;
    using System.IO;
    using System.Net.Sockets;
    using System.Text;
    using System.Collections;
    using System.Threading;

    public class SynchronousSocketListener
    {

    private const int portNum = 4444;
    private static ArrayList ClientSockets;
    private static bool ContinueReclaim = true;
    private static Thread ThreadReclaim;

    public static void StartListening()
    {

        ClientSockets = new ArrayList();

        ThreadReclaim = new Thread(new ThreadStart(Reclaim));
        ThreadReclaim.Start();

        TcpListener listener = new TcpListener(portNum);
        try
        {
            listener.Start();

            int TestingCycle = 3;
            int ClientNbr = 0;

            // Start listening for connections.
            Console.WriteLine("Waiting for a connection...");
            while (TestingCycle > 0)
            {

                TcpClient handler = listener.AcceptTcpClient();

                if (handler != null)
                {
                    Console.WriteLine("Client#{0} accepted!", ++ClientNbr);
                    // An incoming connection needs to be processed.
                    lock (ClientSockets.SyncRoot)
                    {
                        int i = ClientSockets.Add(new ClientHandler(handler));
                        ((ClientHandler)ClientSockets[i]).Start();
                        Console.WriteLine("Added sock {0}", i);
                    }
                    --TestingCycle;
                }
                else
                    break;
            }
            listener.Stop();

            ContinueReclaim = false;
            ThreadReclaim.Join();

            foreach (Object Client in ClientSockets)
            {
                ((ClientHandler)Client).Stop();
            }

        }
        catch (Exception e)
        {
            Console.WriteLine(e.ToString());
        }

        Console.WriteLine("\nHit enter to continue...");
        Console.Read();

    }

    private static void Reclaim()
    {
        while (ContinueReclaim)
        {
            lock (ClientSockets.SyncRoot)
            {
                for (int x = ClientSockets.Count - 1; x >= 0; x--)
                {
                    Object Client = ClientSockets[x];
                    if (!((ClientHandler)Client).Alive)
                    {
                        ClientSockets.Remove(Client);
                        Console.WriteLine("A client left");
                    }
                }
            }
            Thread.Sleep(200);
        }
    }

    public static int Main(String[] args)
    {
        while (true)
        {
            StartListening();
        }
        return 0;
    }
}

class ClientHandler
{

    TcpClient ClientSocket;
    bool ContinueProcess = false;
    Thread ClientThread;

    public ClientHandler(TcpClient ClientSocket)
    {
        this.ClientSocket = ClientSocket;
    }

    public void Start()
    {
        ContinueProcess = true;
        ClientThread = new Thread(new ThreadStart(Process));
        ClientThread.Start();
    }

    private void Process()
    {

        // Incoming data from the client.
        string data = null;

        // Data buffer for incoming data.
        byte[] bytes;

        if (ClientSocket != null)
        {
            NetworkStream networkStream = ClientSocket.GetStream();
            ClientSocket.ReceiveTimeout = 100; // 1000 miliseconds

            while (ContinueProcess)
            {
                bytes = new byte[ClientSocket.ReceiveBufferSize];
                try
                {

                    int BytesRead = networkStream.Read(bytes, 0, (int)ClientSocket.ReceiveBufferSize);
                    //BytesRead--;
                    if (BytesRead > 0)
                    {
                        Console.WriteLine("Bytes Read - Debugger " + BytesRead);
                        data = Encoding.ASCII.GetString(bytes, 0, BytesRead);

                        // Show the data on the console.
                        Console.WriteLine("Text received : {0}", data);

                        // Echo the data back to the client.
                        byte[] sendBytes = Encoding.ASCII.GetBytes("I rec ya abbas");
                        networkStream.Write(sendBytes, 0, sendBytes.Length);

                        if (data == "quit") break;

                    }
                }
                catch (IOException) { } // Timeout
                catch (SocketException)
                {
                    Console.WriteLine("Conection is broken!");
                    break;
                }
                Thread.Sleep(200);
            } // while ( ContinueProcess )
            networkStream.Close();
            ClientSocket.Close();
        }
    }  // Process()

    public void Stop()
    {
        ContinueProcess = false;
        if (ClientThread != null && ClientThread.IsAlive)
            ClientThread.Join();
    }

    public bool Alive
    {
        get
        {
            return (ClientThread != null && ClientThread.IsAlive);
        }
    }

} // class ClientHandler 
```

这是我的客户代码：

```
package com.example.socketclient;

import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

import java.io.BufferedReader;
import java.io.BufferedWriter; 
import java.io.IOException; 
import java.io.InputStream;
import java.io.OutputStreamWriter; 
import java.io.InputStreamReader;
import java.io.PrintWriter; 
import java.net.InetAddress; 
import java.net.Socket; 
import java.net.UnknownHostException; 
import android.util.Log; 

public class SocketCode extends Activity {

    public TextView txt;
    protected SocketCore Conn;
    public Button b;
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_socket_code);
        b = (Button)findViewById(R.id.button1);
        txt = (TextView)findViewById(R.id.textView1);
        Conn = new SocketCore(this,txt);
        b.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                Conn.execute();

            }
        });

    }

} 
```

套接字核心

```
package com.example.socketclient;
import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.app.ProgressDialog;

import android.content.Context;

import android.os.AsyncTask;
import android.os.SystemClock;

import android.os.Bundle;

import android.util.Log;

import android.view.View;
import android.view.View.OnClickListener;
import android.widget.TextView;

class SocketCore extends AsyncTask<Context, Integer, String>
{
    String text = "";
    String finalText = "";
    private Context ctx;
    ProgressDialog dialog;
    TextView Msg;
    Socket socket;
    public SocketCore(Context applicationContext,TextView Change) 
    {
        // TODO Auto-generated constructor stub
        ctx = applicationContext;
        dialog = new ProgressDialog(applicationContext);
        Msg = Change;
    }

    @Override
    protected String doInBackground(Context... arg0) {
        // TODO Auto-generated method stub

         try { 
                InetAddress serverAddr = InetAddress.getByName("192.168.0.150"); 
                Log.d("TCP", "C: Connecting....");

                socket = new Socket(serverAddr,4444); 
               // Log.d("TCP", "C: I dunno ...");
                String message = "Hello Server .. This is the android client talking to you .. First we are testing Server Crashing";

                PrintWriter out = null;
                BufferedReader in = null;

                try { 
                    Log.d("TCP", "C: Sending: '" + message + "'"); 
                    out = new PrintWriter( new BufferedWriter( new OutputStreamWriter(socket.getOutputStream())),true); 
                    in = new BufferedReader(new InputStreamReader(socket.getInputStream()));                
                   //serverReturnString = System.Text.Encoding.ASCII.GetString(response, 0, bytes);

                    out.println("quit");
                   //out.print("h");
                    while ((text = in.readLine()) != null) {
                        finalText += text;
                      if(text=="quit")
                      {
                          socket.close();
                      }
                        Log.d("TCP", "C: Done."+finalText);
                        }

               //   Msg.setText("LOLZ");
                    Log.d("TCP", "C: Sent."); 

                } catch(Exception e) { 
                    Log.e("TCP", "S: Error", e); 
                } /*finally { 
                    socket.close(); 
                    Log.d("TCP", "S: Closed"); 
                } */

            }catch (UnknownHostException e) { 
                // TODO Auto-generated catch block 
                Log.e("TCP", "C: UnknownHostException", e); 
                e.printStackTrace(); 
            } catch (IOException e) { 
                // TODO Auto-generated catch block 
                Log.e("TCP", "C: IOException", e); 
                e.printStackTrace(); 
            }       
           //dialog.setMessage("Recieved: "+finalText);

        return "COMPLETE";
    }
    protected void onPostExecute(String x)
    {
        super.onPostExecute("Finished");
        dialog.dismiss();
        Msg.setText(finalText);

    }
    protected void onPreExecute()
    {dialog.setTitle("Initializing Connection");
    dialog.setMessage("Connecting");

        dialog.show();
    }

} 
```

服务器可以从安卓手机读取，安卓客户端也可以从服务器获取消息。问题是每当服务器检测到连接并开始 Receives text and Sends Reply 。之后代码不接受更多连接。

注意：我尝试使用 C# 客户端进行测试，它工作正常，所以我在客户端遇到问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:59:43.867

你不能使用比 AsyncTask 更多的东西。

最简单的方法是将其中的代码移动`doInBackground()`到 a 中`Runnable`，然后`Thread`在每次单击时使用该可运行文件启动一个新的。

例子：

```
private Runnable rSocketCore = new Runnable() {
    public void run() {
          //here goes your connection code
    }
};

    b.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
             new Thread(rSocketCore).start();
        } 
```

`Note:``Handler`如果您想从线程与 UI 进行通信，您还需要一个。

问候。

# codeigniter - CodeIgniter 更改字段名称 result_array();

> ID：13483083
> 
> 赞同：0
> 
> 时间：2012-11-20T22:10:44.817
> 
> 标签：codeigniter, csv

我正在使用`$data = $query->result_array();`，但我需要将我的字段名称从 first_name 更改为 first name。

我查了一下发现这个......

```
foreach ($query->result_array() as $row)
{
   echo $row['title'];
   echo $row['name'];
   echo $row['body'];
} 
```

我想做这样的事情吗？

```
 foreach ($query->result_array() as $row)
    {
       $row = str_replace("_", " ", $row);
    }

$data = $row; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T09:45:21.703

如果你需要一个新数组，你可以轻松做到：

```
foreach ($query->result_array() as $key=> $value)
    {
       $data[] = array(
        str_replace("_", " ", $key)=>$value
       ); 
    } 
```

# c++ - 如何一次使用 3 个字符的 switch 语句？

> ID：13483084
> 
> 赞同：0
> 
> 时间：2012-11-20T22:10:47.417
> 
> 标签：c++, string, stl

我有一串不同的 3 个字母单词：

```
catdogmattabratliematdogatt 
```

我需要为每个单词分配一个字母并打印最终的字符串。

```
cat: P, dog: A, mat: T, tab: I, rat: E, lie: O, att: L 
```

所以我的输出应该是：

```
PATIEOTAL 
```

我尝试使用 switch 语句，但它不允许我一起输入 3 个字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:14:06.273

使用 a`map<string, char>`执行以下操作：

```
map<string, char> wordToChar;
// Load wordToChar appropriately; c++11 you can use an initializer list for simplicity

for (int i = 0; i < strLen; i += 3)
{
  string str;
  str.push_back(theString[i]);
  str.push_back(theString[i+1]);
  str.push_back(theString[i+2]);
  cout << wordToChar[theString] << endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T16:44:39.297

既然您询问了使用 switch 语句，我认为拥有 3 个字母单词及其对应字母的硬编码列表是可以接受的。在这种情况下，我会使用一系列 if-then-else 语句来解决这个问题，每个语句都试图匹配 3 个字母单词的字符。或者，您可以使用嵌套的 switch 语句，但语法使该解决方案更难阅读 IMO。

```
static char match_word(std::string const &str, std::size_t offset)
{
  char ret = '?';
  if (str[offset + 0] == 'c' && str[offset + 1] == 'a' && str[offset + 2] == 't') {
    ret = 'P';
  }
  else if (str[offset + 0] == 'd' && str[offset + 1] == 'o' && str[offset + 2] == 'g') {
    ret = 'A';
  }
  else if (str[offset + 0] == 'm' && str[offset + 1] == 'a' && str[offset + 2] == 't') {
    ret = 'T';
  }
  else if (str[offset + 0] == 't' && str[offset + 1] == 'a' && str[offset + 2] == 'b') {
    ret = 'I';
  }
  else if (str[offset + 0] == 'r' && str[offset + 1] == 'a' && str[offset + 2] == 't') {
    ret = 'E';
  }
  else if (str[offset + 0] == 'l' && str[offset + 1] == 'i' && str[offset + 2] == 'e') {
    ret = 'O';
  }
  else if (str[offset + 0] == 'a' && str[offset + 1] == 't' && str[offset + 2] == 't') {
    ret = 'L';
  }
  return ret;
} 
```

然后你可以用一个简单的 main 函数来测试代码，如下所示：

```
int main(int argc, char **argv)
{
  if (argc != 2) {
    std::cerr << "USAGE: " << argv[0] << " ENCODED" << std::endl;
    return 1;
  }
  else {
    std::string example(argv[1]);
    for (std::size_t idx = 0; idx < example.size(); idx += 3) {
      std::cout << match_word(example, idx);
    }
    std::cout << std::endl;
    return 0;
  }
} 
```

然后只需使用编码字符串作为唯一的参数运行程序，如下所示：

```
$ ./a.out catdogmattabratliematdogatt
PATIEOTAL 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:18:01.023

看来我可以在 - 语句中使用`char`三个`switch`！它也不仅仅是我，而是一种称为“多字符文字”的标准功能（参见 2.14.3 [lex.ccon] 第 1 段；这些野兽的类型是`int`）。并不是说我会建议任何人使用此 hack，但它可以工作，尽管根据系统的 Endianess 可能需要在计算中反转字符（我不确定那个细节）。这是一个完整的示例（尽管输入需要单独的单词而不是需要分隔的一个字符串）：

```
#include <iostream>
#include <string.h>

int main(int ac, char* av[])
{
    typedef unsigned char u;
    for (int i(1); i != ac; ++i) {
        if (strlen(av[i]) == 3) 
        {
            std::cout << std::hex;
            int value(u(av[i][2])
                      + 256u * (u(av[i][1])
                                + 256u * u(av[i][0])));
            switch (value) {
            default:
                std::cout << "option not found!: '" << av[i] << "'\n";
                break;
            case 'cat': std::cout << 'P'; break;
            case 'dog': std::cout << 'A'; break;
            case 'mat': std::cout << 'T'; break;
            case 'tab': std::cout << 'I'; break;
            case 'rat': std::cout << 'E'; break;
            case 'lie': std::cout << 'O'; break;
            case 'att': std::cout << 'L'; break;
            }
        }
    }
    std::cout << '\n';
} 
```

# c# - WPF 属性在 Windows 8 中无法正常工作

> ID：13483087
> 
> 赞同：0
> 
> 时间：2012-11-20T22:11:12.253
> 
> 标签：c#, wpf, windows

我在 Windows 8 中遇到了 BorderThickness 或 BorderBrush 属性的问题。

在win7中，下面的代码以5px粗的读取轮廓正确勾勒出了editControl，但是它在Windows 8中不起作用。我想知道Windows 8现在是否有一些已弃用或不支持的东西？我在微软文档中找不到任何概念。

```
editControl.BorderThickness = new Thickness(5);
editControl.BorderBrush = Brushes.Red; 
```

有谁能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T19:02:27.717

我找到了使用[Adorners](http://msdn.microsoft.com/en-us/library/ms743737.aspx)的解决方法。

```
 private class ErrorHighlightAdorner : Adorner
  {
      public ErrorHighlightAdorner(UIElement adornedElement)
          : base(adornedElement)
      {
      }

      protected override void OnRender(DrawingContext drawingContext)
      {
          Rect sourceRect = new Rect();
          FrameworkElement fe = AdornedElement as FrameworkElement;
          if (fe != null)
          {
              sourceRect = new Rect(fe.RenderSize);
          }
          else
          {
              sourceRect = new Rect(AdornedElement.DesiredSize);
          }

          Pen renderPen = new Pen(new SolidColorBrush(Colors.Red), 2.0);
          drawingContext.DrawRectangle(null, renderPen, sourceRect);
      }
  } 
```

# jquery - jQueryUI 的自动完成功能不理解 JSON？

> ID：13483088
> 
> 赞同：1
> 
> 时间：2012-11-20T22:11:25.330
> 
> 标签：jquery, json, jquery-ui

我有这个 JSON 数组：

```
[
    {"name":"Mario Kart Wii"},
    {"name":"Super Mario Galaxy 2"},
    {"name":"Super Mario Galaxy"},
    {"name":"Mario Sports Mix"},
    {"name":"Mario & Sonic at the Olympic Winter Games"}
] 
```

很简单。

还有我的 jQuery 代码：

```
$('#searchFieldGame').autocomplete({
        source: function(request, response) {
            console.log(response)
            $.getJSON('/index.php/search/autocomplete/'+request['term'],response)
        },
        select: function(event, ui) {
            $('#searchFieldGame').val(ui.item.value);
            $('#searchFormGame').submit()
        },
        minLength: 3
    }) 
```

我的问题是 - 当 JSON 更简单时，例如：

```
[
    "Mario Kart Wii",
    "Super Mario Galaxy 2",
    "Super Mario Galaxy",
    "Mario Sports Mix",
    "Mario & Sonic at the Olympic Winter Games"
 ] 
```

它工作得很好。但如果它更像第一个，它不会得到任何结果。我需要像第一个一样保持它，因为以后我希望每个数组中有更多元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:17:48.393

对于 jQuery UI 自动完成，只有两种可接受的数据格式。

```
['item', 'item2', 'item3', ...]
[{label: 'item', value: 'itemvalue'}, {label: 'item2', value: 'itemvalue2'}, ... ] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:13:45.890

如果它是一个对象数组，它必须至少具有值和/或标签属性。[资源](http://api.jqueryui.com/autocomplete/#option-source)

```
[
    {"value":"Mario Kart Wii"},
    {"value":"Super Mario Galaxy 2"},
    {"value":"Super Mario Galaxy"},
    {"value":"Mario Sports Mix"},
    {"value":"Mario & Sonic at the Olympic Winter Games"}
] 
```

如果这不是一个选项，您可以使用`$.map`它来修复它。

```
$.getJSON('/index.php/search/autocomplete/'+request['term'],function(data){
    response( $.map(data,function(obj) {
        return obj.name;
    }) );
}); 
```

# javascript - Javascript 的 getElementById 在我的循环中不起作用

> ID：13483091
> 
> 赞同：1
> 
> 时间：2012-11-20T22:11:50.613
> 
> 标签：javascript, forms, loops, for-loop, getelementbyid

我一直在处理的功能有问题。此函数的目的是获取两组文本输入框中的日期，计算两者之间的差异，然后将该天数放入第三组输入框中。我的功能如下图所示。

```
function daysBetween() {

for (var i = 0; i < 8; i++) {   

//Get the value of the current form elements
    var start = namestart[i];
    var end = namend[i];
    var out = names[i];

//Duration of a day
    var d = 1000*60*60*24;

// Split Date one
    var x = start.split("-");
// Split Date two
    var y = end.split("-");

/// // Set Date one object
    var d1 = new Date(x[0],(x[1]-1),x[2]);
//  // Set Date two object
    var d2 = new Date(y[0],(y[1]-1),y[2]);
//  
//  //Calculate difference
    diff = Math.ceil((d2.getTime()-d1.getTime())/(d));

    //Show difference
    document.getElementById(out).value = diff;

    }
} 
```

开头的变量引用的三个数组仅包含我希望访问的表单元素的名称。我已经使用警告框测试了 start、end 和 out 变量，如果代码中的 Show Difference 注释下没有该行，则循环运行良好。我也经历过并确保所有名称都匹配并且它们确实匹配。此外，我已经用每组名称手动运行页面八次（有八组框），它成功地在日期框中显示“NaN”（我在源框中还没有数据，所以 NaN 是预期的行为）。

当我运行这里显示的函数时，会发生第一组文本框按预期工作。然后循环停止。所以我的问题很简单，为什么即使 names[0] 值有效，循环也会与 getElementById 挂断，它会找到文本框并将计算出的差异放入框中。names[1] 的文本框不起作用，循环挂断。

如果您需要我的文本框的更详细代码，我可以提供，但它们遵循下面的简单模板。

```
// namestart[] array
<input type="text" name="start_date_one" id="start_date_one" value=""/> <br />
// namend[] array
<input type="text" name="end_date_one" id="end_date_one" value=""/> <br />
// names[] array
<input type="text" name="day_difference_one" id="day_difference_one" value=""/> 
```

感谢您提前提供任何帮助。

编辑：注意到我想我会添加我的数组定义以供参考的评论。这些是在我的 calcdate.js 文件中的函数上方直接定义的。

```
var namestart = new Array ();
namestart[0] = "trav_emer_single_date_go";
namestart[1] = "trav_emer_extend_date_go";
namestart[2] = "allinc_single_date_go";
namestart[3] = "allinc_annual_date_go";
namestart[4] = "cancel_date_go";
namestart[5] = "visitor_supervisa_date_go";
namestart[6] = "visitor_student_date_go";
namestart[7] = "visitor_xpat_date_go";

var namend = new Array ();
namend[0] = "trav_emer_single_date_ba";
namend[1] = "trav_emer_extend_date_ba";
namend[2] = "allinc_single_date_ba";
namend[3] = "allinc_annual_date_ba";
namend[4] = "cancel_date_ba";
namend[5] = "visitor_supervisa_date_ba";
namend[6] = "visitor_student_date_ba";
namend[7] = "visitor_xpat_date_ba";

var names = new Array ();
names[0] = "trav_emer_single_days";
names[1] = "trav_emer_extend_days";
names[2] = "allinc_single_days";
names[3] = "allinc_annual_days";
names[4] = "cancel_days";
names[5] = "visitor_supervisa_days";
names[6] = "visitor_student_days";
names[7] = "visitor_xpat_days"; 
```

我引用该文件并在我的标题中调用我的函数，如下所示：

```
<script type="text/javascript" src="calcdate.js"></script>
<script type="text/javascript">
window.onload = daysBetween;
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:14:20.717

首先，当一个对象没有 ID 时，您不能通过它的 ID 来引用它。

`<input type="text" id="start_date_one" name="start_date_one" />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:14:25.420

因为你说`out`包含一个你可能想要改变的名字

```
document.getElementById(out).value = diff; 
```

到

```
document.getElementsByName(out)[0].value = diff; 
```

或者您实际上可以将`id`属性添加到您的html并将其设置为与属性相同的值`name`，您可以避免更改您的javascript。

`getElementById`通过其 id 属性获取元素，`getElementsByName`获取具有指定 name 属性的所有元素并将其作为数组返回。在 HTML 中，id 应该是唯一的，这就是为什么 getElementById 只返回 1 个元素

# c++ - 存储指向 std::set 对象的引用/指针

> ID：13483096
> 
> 赞同：1
> 
> 时间：2012-11-20T22:12:17.147
> 
> 标签：c++

我正在制作一个关于弹珠的游戏，它使用一个结构来描述弹珠的属性：

```
struct Marble
{
Color color;
int weight;
//Other customizable marble properties
}; 
```

我目前正在使用 a`std::vector`来跟踪哪些弹珠在游戏板上的哪个位置：

```
std::vector<Marble> m_marbles; 
```

在任何时候，我都可以通过索引向量来检查给定位置的弹珠的属性。要检查位置 20 中大理石的颜色：

```
m_marbles[20].color; 
```

用户可以创建自定义弹珠并将它们添加到游戏板上。如果我想在游戏板上添加一个新的弹珠，我创建一个新的结构对象并将其推送到向量上：

```
Marble m;

//Fill struct with marble information

m_marbles.push_back(m) 
```

问题是游戏板非常大（成千上万的弹珠），并且许多弹珠完全相同。

假设游戏板上有 4000 个位置。也许其中 3000 个是重量为 1.0 的红色弹珠。在当前的解决方案中，3000 个等效的 Marble 对象占用了我的向量中的空间。

因为用户可以定义他自己的弹珠类型，所以我不能硬编码所有可能的弹珠类型，然后让向量存储一个指向适当弹珠对象的指针。

我正在考虑使用 a`std::set`来存储不同的大理石类型。然后，当用户去创建他的自定义弹珠时，他可以尝试将其插入到集合中。如果已经存在相同类型的大理石，则不会浪费内存。

我的问题是，如何将引用存储到`std::set`? 例如，假设我的集合由以下大理石类型组成：

```
{RedMarble, BlueMarble, StrangeMarble, ConfusedMarble} 
```

现在我想在游戏板上的位置 20 上分配一个红色弹珠：

```
m_marbles[20] = ? 
```

我还想检查 31 位大理石的颜色：

```
m_marble[31].color; 
```

是否可以以这种方式使用集合？find 和 insert 函数返回迭代器，但如果我在集合中插入更多项目，这些迭代器不会失效吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:45:00.060

构建一个`Marble`包含指向`MarbleType`定义每个弹珠的属性的指针的类（对于每种弹珠，您都有一个 实例`MarbleType`）。该向量可能包含`Marble`s 或指向 s 的共享指针`Marble`或唯一指针。如果`Marble`类很小（轻量级模式），您不会浪费空间，但仍然有一个干净灵活的解决方案。大理石类型可以命名（例如，通过字符串）并存储在`std::map`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:47:34.023

是的，你可以做你想做的事。您可以将指针存储在向量中，这些指针指向集合中的弹珠。或者您可以将迭代器存储在您的向量中，这些迭代器再次指向您集合中的 Marbles。

以下是我将如何使用指针：

```
// A useful helper funtction -- not required, but useful.
const Marble* Helper(const Marble& m) {
  static std::set<Marble> uniqueMarbles;
  return &*(uniqueMarbles.insert(m).first);
}

// A vector of pointers to marbles
std::vector<const Marble*> m_marbles;

// You can pass temporaries to the helper function, and it returns a permanent pointer
m_marbles.push_back(Helper(Marble(RED, 1.0));

Marble m;
m.setColor(BLUE);
m_marbles.push_back(Helper(m));

// You can reference your marbles
Color c = m_marbles[i]->getColor();

// Hopefully the following will produce a compiler error message
m_marbles[i]->setColor(GREEN); // Oops, m_marbles holds const pointers 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:15:16.033

您应该使向量包含*指向*Marble 结构的指针：

```
std::vector<Marble*> m_marbles; 
```

指针不会占用太多空间，您仍然可以`Marble`用作基类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:20:07.897

如果游戏板真的只有几千块大，我不会在乎浪费空间。例如

```
10000 places * sizeof(Marble) = 10000 * 100 bytes ~ 1 MB 
```

按照今天的标准，内存量并不大。

如果它可能变得非常大，那么您确实可以将您独特的 Marbles 存储在一个集合中并使用指针引用它们，正如@BenRuijl 已经展示的那样。

# java - 断言数组等于

> ID：13483101
> 
> 赞同：1
> 
> 时间：2012-11-20T22:12:39.830
> 
> 标签：java, unit-testing, junit4

我在 Junit 4 中测试两个数组，看看它们是否相等并得到错误：

> 数组首先在元素 [0] 处不同；预期：com.scheduling.Process<(Background, 1000)> 但是是：com.scheduling.Process<(Background, 1000)>

我知道这是非常少的信息。我在其他地方读过`assertArrayEquals`查看数组中的引用。

`assertArrayEquals(new Cat(), new Cat())`应该返回相等的东西（假设`Cat`该类实现了可比性）？还是会`assertArrayEquals`认为这两个`Cat`对象不同，因为它们没有通过引用链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:33:22.907

它比较使用`equals`. 您可以通过运行来检查

```
Assert.assertArrayEquals(new Object[]{new Integer(1)}, new Object[]{new Integer(1)}); 
```

或者通过创建一个只实现该方法的类`equals`。

即使这两个对象是不同的实例，数组仍然可以正确比较。

# android - 让 Android 动态壁纸响应关键事件？

> ID：13483106
> 
> 赞同：1
> 
> 时间：2012-11-20T22:13:02.327
> 
> 标签：android, key, overriding, volume, wallpaper

我想要做的是让我的动态壁纸在设备的音量按钮被按下时采取行动。

在我的活动中，我只是重写`onKeyDown()`来实现这一点。

在我的动态壁纸中，我看不到任何可以覆盖或注册为能够执行此操作的侦听器的内容。

有人做过这样的事情，或者知道这是不可能的吗？

# java - 需要帮助编写一个找到最高和第二高数字的程序是一个系列

> ID：13483117
> 
> 赞同：1
> 
> 时间：2012-11-20T22:13:51.670
> 
> 标签：java

该程序旨在让用户输入一系列数字，直到用户输入我设置为值 0 的哨兵。在用户输入哨兵后，程序应该打印其中的最高数字和次高数字列表。我遇到的麻烦是我希望第二高的数字是它打印 0 。

有没有更优雅的方法通过使用 ?: 运算符来解决这个问题？是否可以？

```
import acm.program.*;

public class LargestAndSecondLargest extends ConsoleProgram {

    public void run() {

        int a = 0;
        int b = 0; 

        while (true) {

            int value = readInt(" ?: ");

            if (value == SENTINEL) break;

            if (value > a) {
                a = value;   
            }
            else if (value > b) {
                b = value;
            }
        }

        println("the largest value is " + a);
        println("the second largest number is"  + b);
    }

    private static final int SENTINEL = 0; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:19:39.910

有两个问题：

1.  第二个比较是错误的。
2.  当您遇到新的最高数字时，您需要将之前的最高数字移动到第二高的位置。否则，序列 1、2、3 将产生 3 和 1 作为两个最高数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:15:41.870

```
else if ( b > value ) 
```

上述 else if 条件应为：-

```
else if ( value > b ) 
```

否则，`b`如果您只输入`positive`数字，您将永远不会改变，因此`2nd`最大值将是`0`.

另请参阅@NPE 的[答案](https://stackoverflow.com/a/13483208/1679863)中的第二个要求，这是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:19:33.247

将值插入到数组中。对数组进行排序，然后将数组中的前两个值分配到您的输出中。如果根据要求只给出一个值，则将它们都设置为相同的值或 1 为 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:39:01.030

这是我的解决方案（您可以适应您的超类）：

```
public class LargeAndSecondLargest {

    public static void main(String[] args) {
        new LargeAndSecondLargest().run("1 2 2");
    }

    public void run(String input) {
        final int SENTINEL = 0;
        int currVal;
        Scanner scanner = new Scanner(input);
        List<Integer> numbers = new ArrayList<>();
        while (scanner.hasNextInt() && ((currVal = scanner.nextInt()) != SENTINEL)) {
            numbers.add(currVal);
        }
        printFirstAndSecondLargest(numbers);
    }

    private void printFirstAndSecondLargest(List<Integer> numbers) {
        Collections.sort(numbers, Collections.reverseOrder());
        System.out.println("the largest value is " + numbers.get(0));
        System.out.println("the second largest number is " + numbers.get(1));
    }
} 
```

# php - 是否有替代 php imap 扩展的替代方案

> ID：13483119
> 
> 赞同：3
> 
> 时间：2012-11-20T22:13:59.393
> 
> 标签：php, imap

我的 godaddy 共享主机服务不会启用 PHP 的 IMAP 扩展。所以我在泡菜：

是否有 PHP 函数可以替换 PHP 中的 IMAP 功能？

这是错误：

```
Fatal error: Call to undefined function imap_last_error() 
```

这是我遇到问题的示例代码：

```
$mbox = imap_open ('{'.$email_host.':'.$email_port.'/pop3/novalidate-cert}INBOX', $email_username, $email_password) or die(imap_last_error());

        if(!$mbox){
            // send email letting them know bounce checking failed?
            // meh. later.
            echo 'Failed to connect when checking bounces.';
        }else{
            $MC = imap_check($mbox);
            $result = imap_fetch_overview($mbox,"1:{$MC->Nmsgs}",0);
            foreach ($result as $overview) {
                $this_subject = (string)$overview->subject;
                //echo "#{$overview->msgno} ({$overview->date}) - From: {$overview->from} <br> {$this_subject} <br>\n";
                $tmp_file = tempnam('/tmp/','newsletter_bounce');
                // TODO - tmp files for windows hosting.
                imap_savebody  ($mbox, $tmp_file, $overview->msgno);
                $body = file_get_contents($tmp_file);
                if(preg_match('/Message-ID:\s*<?Newsletter-(\d+)-(\d+)-([A-Fa-f0-9]{32})/imsU',$body,$matches)){
                    // we have a newsletter message id, check the hash and mark a bounce.
                    //"message_id" => "Newsletter-$send_id-$member_id-".md5("bounce check for $member_id in send $send_id"),
                    $send_id = (int)$matches[1];
                    $member_id = (int)$matches[2];
                    $provided_hash = trim($matches[3]);
                    $real_hash = md5("bounce check for $member_id in send $send_id");
                    if($provided_hash == $real_hash){
                        $sql = "UPDATE "._DB_PREFIX."newsletter_member SET `status` = 4, bounce_time = '".time()."' WHERE `member_id` = '".$member_id."' AND send_id = '".$send_id."' AND `status` = 3 LIMIT 1";
                        query($sql);
                        imap_delete($mbox, $overview->msgno);
                    }else{
                        // bad hash, report.
                    }
                }
                unlink($tmp_file);
            }
            imap_expunge($mbox);
            imap_close($mbox);
        }

    } 
```

提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:10:16.793

imap 扩展没有 PECL 替代品。如果你敢，你可以用 PHP 写一个，但那将是非常无效的。另一种方法是（假设他们不受客户请求的影响）将“GoDaddy”转换为“GoAwayDaddy”并将 ISP 更改为不阻止此的非常基本的扩展。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-23T17:30:24.330

这个适用于 Godaddy 共享主机： [http ://www.phpclasses.org/package/4014-PHP-Retrieve-and-delete-messages-from-a-POP3-mailbox.html](http://www.phpclasses.org/package/4014-PHP-Retrieve-and-delete-messages-from-a-POP3-mailbox.html)

这个也可以：http: [//framework.zend.com/manual/1.12/en/zend.mail.html](http://framework.zend.com/manual/1.12/en/zend.mail.html)

```
function __autoload($class_name) {
include $class_name . '.php';
}
 include_once 'Zend/Mail/Storage/AbstractStorage.php';
include_once 'Zend/Mail/Storage/Pop3.php';
$mail = new Zend\Mail\Storage\Pop3(array('host'     => '$host',
                                     'user'     => '$user',
                                     'password' => '$password'));

echo $mail->countMessages() . " messages found\n";
foreach ($mail as $message) {
   echo "Mail from '{$message->from}': {$message->subject}\n</br>";
   echo $message->getContent() . "</br>";
} 
```

# php - 回声随机颜色不起作用

> ID：13483125
> 
> 赞同：1
> 
> 时间：2012-11-20T22:14:15.430
> 
> 标签：php, html, css, random, echo

我的 <head> 部分中有以下内容

```
<?php
$rand = array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f');
$color = '#'.$rand[rand(0,15)].$rand[rand(0,15)].$rand[rand(0,15)].$rand[rand(0,15)].$rand[rand(0,15)].$rand[rand(0,15)];
?> 
```

我的 <body> 中有以下内容

```
<div class="featured-details" style="background-color: <?php echo $color; ?>;"> 
```

当我的页面加载时，CSS 会显示以下内容：

```
<div style="background-color: ;" class="featured-details"> 
```

即似乎没有生成颜色。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:19:25.767

可能是您头脑中的代码片段与您体内的代码在不同的范围内执行，这就是为什么`$color`为空白

如果`$color`在函数中，请尝试将其设为全局变量。

您需要先添加`global $color;` ，然后再将其设置在头部以及身体的某个位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:20:01.743

我的猜测是您`echo`的功能正常，而您的分配在全局范围内，反之亦然。`global $color;`如果是这种情况，请尝试输入功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:20:10.137

这个对我有用。检查以确保在`$color`回显变量时正确设置变量。

有一种方法可以简化颜色生成，使用[`dechex()`](http://php.net/manual/en/function.dechex.php)：

```
$color = '#'.dechex(rand(0,15)).dechex(rand(0,15)).dechex(rand(0,15)).dechex(rand(0,15)).dechex(rand(0,15)).dechex(rand(0,15)); 
```

当然，您可以使用循环进一步完善它：

```
$color = '#';
for ($i = 0; $i < 6; $i++) {
    $color .= dechex(rand(0, 15));
} 
```

# javascript - 是否有在 Javascript 中命名可变和谓词函数的约定？

> ID：13483130
> 
> 赞同：5
> 
> 时间：2012-11-20T22:14:24.523
> 
> 标签：javascript, coding-style, naming-conventions, predicate, mutable

是否有在 Javascript 中命名可变和谓词函数的约定？

例如，在 Ruby、Lisp 等中，改变其内容的函数，如`gsub!`，通常有一个感叹号作为约定，表示该函数是危险的。

或者，如果该函数返回一个布尔值，例如`even?`，该函数将带有一个问号。

不幸的是，您不能在 Javascript 中的函数名称中使用特殊字符`?`，`!`那么 Javascript 程序员使用什么约定来表示这些特殊类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T22:19:17.777

是的，命名返回函数的通常约定`true|false`是在它前面加上前缀`is`，如`isDate`, `isHidden`... 至于*变异*的方法，AFAIK 没有约定，但在 JavaScript 中，大多数方法不会修改原始对象，所以你只需要知道哪些可以，哪些不可以，但是您将能够分辨出来。例如`replace`，不会修改原始对象，因此您可以通过赋值来判断：`a = a.replace(...)`，但是像这样的方法`splice` *确实会*修改原始对象，因此您可以判断，因为在同一个变量上没有赋值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:18:14.123

默认情况下，JavaScript 中没有这样的东西。这取决于您工作的组织是否有他们遵守的任何编码约定。

我的公司遵循的一个约定是在函数前面加上下划线来表示内部变量/函数。这相当于 OOP 中的私有变量/函数。

例如，我将在 jMVC 的控制器中使用的一个常见的方法是：

```
_isIE = $('html').is('.ie8, .ie9'); 
```

因为我们只希望该控制器中的其他功能可以访问它。

# java - 更新 AppWidget 上的 TextView 文本大小

> ID：13483131
> 
> 赞同：1
> 
> 时间：2012-11-20T22:14:24.260
> 
> 标签：java, android, android-widget, widget

我想不通，我已经为此苦苦挣扎了好几天了，我已经厌倦了..

我正在使用配置活动中的微调器更改 AppWidget 上 TextView 的文本大小，但我无法正确更新它。我第一次告诉它时它不会更新，但它确实会更新第二次和第三次以及之后的每次。

如果有人能看一下我的代码，我会非常感激

非常感谢你

配置类：

```
public class WidgetConfig extends Activity implements OnItemSelectedListener{

    Dialog myDialog;
    Context context = WidgetConfig.this;
    static EditText info;
    static Spinner spinner;
    String appwidget_textsize = "0";
    private static final String[] paths = { "10", "12", "14", "16", "18", "20",
        "22", "24", "26", "28", "30", "32", "34", "36", "38", "40", "50", "60"};

    private static final String PREFS_NAME = "com.harteg.NotesWidgetPro.Widget";
    private static final String PREF_PREFIX_KEY = "prefix_";

    private static final String TAG = "MyActivity";

    int mAppWidgetId = AppWidgetManager.INVALID_APPWIDGET_ID;   

    float number;

    public WidgetConfig() {
        super();
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);

        Log.v(TAG, "onCreate() started");

        setContentView(R.layout.widgetconfig);
        context = WidgetConfig.this;
        // back button = cancel
        setResult(RESULT_CANCELED);
        info = (EditText) findViewById(R.id.etwidgetconfig);

        findViewById(R.id.bwidgetconfig).setOnClickListener(mOnClickListener);
        findViewById(R.id.bwidgetconfig1).setOnClickListener(mOnClickListener);

        // Find the widget id from the intent.
        Intent intent = getIntent();
        Bundle extras = intent.getExtras();
        if (extras != null) {
            mAppWidgetId = extras.getInt(AppWidgetManager.EXTRA_APPWIDGET_ID,
                    AppWidgetManager.INVALID_APPWIDGET_ID);
        }
        // If they gave us an intent without the widget id, just bail.
        if (mAppWidgetId == AppWidgetManager.INVALID_APPWIDGET_ID) {
            finish();
        }
        info.setText(loadTitlePref(WidgetConfig.this, mAppWidgetId));

        //------------ Text Size spinner ---------------
        spinner = (Spinner) findViewById(R.id.TxtSizeSP);

        ArrayAdapter<String> adapter = new ArrayAdapter<String>(WidgetConfig.this,
                android.R.layout.simple_spinner_item, paths);

        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapter);

        spinner.setOnItemSelectedListener(this); 

        //--------------------------------------------------

    } // onCreate finished

    public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {
        Log.v(TAG, "OnItemselected started");

        switch (position) {
        case 0:
            info.setTextSize(10.0f);
            Log.v(TAG, "position 0 chosed");
            appwidget_textsize = "10".toString();
            break;
        ... 

         }
         number = Float.valueOf(appwidget_textsize);    
        }

    public void onNothingSelected(AdapterView<?> arg0) {

    }

    View.OnClickListener mOnClickListener = new View.OnClickListener() {
        public void onClick(View v) {

            Log.v(TAG, "set remote view");
            RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget);
            AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(context);

            Log.v(TAG, "set txt size");
            views.setFloat(R.id.tvConfigInput, "setTextSize", number);
            appWidgetManager.updateAppWidget(mAppWidgetId, views);
            Log.v(TAG, "over txt size");

            // When the button is clicked, save the string in our prefs and
            // return that they clicked OK.
            String titlePrefix = info.getText().toString();
            saveTitlePref(context, mAppWidgetId, titlePrefix);

            // Push widget update to surface with newly set prefix
            Widget.updateAppWidget(context, appWidgetManager, mAppWidgetId,
                    titlePrefix, views);

            // Make sure we pass back the original appWidgetId
            Intent resultValue = new Intent();
            resultValue.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID,
                    mAppWidgetId);
            setResult(RESULT_OK, resultValue);
            Log.v(TAG, "onClick done");
            finish();

        }
    };

    // Write the prefix to the SharedPreferences object for this widget
    static void saveTitlePref(Context context, int mAppWidgetId, String text) {
        SharedPreferences.Editor editor = context.getSharedPreferences(PREFS_NAME, 0).edit();

        editor.putString(PREF_PREFIX_KEY + mAppWidgetId, text);

        // Saves the values
        editor.commit();
    }

    // Read the prefix from the SharedPreferences object for this widget.
    static String loadTitlePref(Context context, int mAppWidgetId) {
        SharedPreferences prefs = context.getSharedPreferences(PREFS_NAME, MODE_PRIVATE);

        String prefix = prefs.getString(PREF_PREFIX_KEY + mAppWidgetId, null);

        // If there is no preference saved, get the default from a resource
        if (prefix != null) {
            return prefix;
        } else {
            return context.getString(R.string.appwidget_prefix_default);
        }
    }

    static void deleteTitlePref(Context context, int mAppWidgetId) {
    }

    static void loadAllTitlePrefs(Context context,
            ArrayList<Integer> mAppWidgetIds, ArrayList<String> texts) {
    }

} 
```

AppWidgetProvider 类：

```
public class Widget extends AppWidgetProvider {

    private static final String TAG = "MyActivity";

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager,
            int[] appWidgetIds) {

        Log.v(TAG, "onUpdate started");
        // TODO Auto-generated method stub
        //super.onUpdate(context, appWidgetManager, appWidgetIds);

        final int N = appWidgetIds.length;
        RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget);

        for (int i=0; i<N; i++){
            int mAppWidgetId = appWidgetIds[i];
            String titlePrefix = WidgetConfig.loadTitlePref(context, mAppWidgetId);
                    updateAppWidget(context, appWidgetManager, mAppWidgetId, titlePrefix, views);

        }
    }

    @Override
    public void onDeleted(Context context, int[] appWidgetIds) {

        final int N = appWidgetIds.length;
        for (int i=0; i<N; i++) {
            WidgetConfig.deleteTitlePref(context, appWidgetIds[i]);
        }
    }

    ...

    static void updateAppWidget(Context context, AppWidgetManager appWidgetManager,
            int mAppWidgetId, String titlePrefix, RemoteViews views) {
        Log.v(TAG, "updateAppWidget started");
        // Getting the string this way allows the string to be localized.  The format
        // string is filled in using java.util.Formatter-style format strings.
        CharSequence text = context.getString(R.string.appwidget_text_format,
              WidgetConfig.loadTitlePref(context, mAppWidgetId));        

        appWidgetManager = AppWidgetManager.getInstance(context); 

        ...

        views = new RemoteViews(context.getPackageName(), R.layout.widget);
        views.setTextViewText(R.id.tvConfigInput, text);

        // Tell the AppWidgetManager to perform an update on the current app widget
        Log.v(TAG, "Bottom update started");
        appWidgetManager.updateAppWidget(mAppWidgetId, views);

    }

} 
```

字符串.xml

```
<resources xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
    <string name="appwidget_prefix_default"></string>
    <string name="appwidget_textsize"></string>
    <string name="appwidget_text_format"><xliff:g id="prefix">%1$s</xliff:g></string> 
    ...   
</resources> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T10:16:34.417

所以我在尝试了一百万种不同的东西后终于让它工作了。我最终通过 sharedpreferences 传递了一个带有值的字符串，就像我将文本获取到小部件一样，并且只是`views.setFloat(R.id.TextView, "setTextSize", Float.valueOf(SizeString));`在小部件提供程序中自行设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T03:34:51.633

您必须在 `ACTION_APPWIDGET_UPDATE` 启动配置 Activity 时首次广播自己。

Appwidgets[文档](http://developer.android.com/guide/topics/appwidgets/index.html)说：

> 创建 App Widget 时不会调用 onUpdate() 方法（启动配置 Activity 时系统不会发送 ACTION_APPWIDGET_UPDATE 广播）。首次创建 App Widget 时，配置 Activity 负责向 AppWidgetManager 请求更新。然而，onUpdate() 将被调用以进行后续更新——它只是在第一次被跳过。

## 更新：

尝试将此代码添加到 Config 活动的 finish() 行上方。

```
AppWidgetManager appWidgetManager = AppWidgetManager.getInstance(this);
appWidgetManager.updateAppWidget(
        new ComponentName(this.getPackageName(), Widget.class.getName()), views); 
```

# algorithm - 以小于或等于指定的成本找到最快的路径

> ID：13483133
> 
> 赞同：3
> 
> 时间：2012-11-20T22:14:28.953
> 
> 标签：algorithm, path

这是我的问题的可视化。

![在此处输入图像描述](../Images/4facac30bd4961d72a8a5bfaeac6cc3f.png)

我一直在尝试使用 djikstra，但是它没有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T03:41:31.597

在我看来，复杂之处在于 Dijkstra 的算法会丢弃您需要保留的信息：如果您试图从 A 到 E

```
 B
 /   \
A     D - E
 \   /
   C 
```

而且 ABD 比 ACD 短，Dijkstra 会忘记 ACD 曾经是一种可能性（它使用 ACD 作为从 A 到 D 的规范路线）。但是如果 ABD 的成本高于 ACD，并且 ABDE 高于配额，而 ACDE 低于配额，那么现在消除的 ACD 是正确的。问题是 Dijkstra 的算法假设如果一条路径至少和另一条一样长，它是弱支配的：没有理由更喜欢它。在一个维度的比较中，路径是弱排序的：给定任意两条路径，一条弱支配另一条。

但是这里我们有两个比较维度，因此排序不成立：一个路径可以更短，另一个更便宜。由于我们只能丢弃支配路径，因此我们必须保留所有尚未超出预算且未被支配的路径。我在实施这种方法方面做了一些工作；它看起来可行，但找不到低于指数复杂度的最坏情况界限的论据（尽管正常性能应该要好得多，因为在理智的图中，大多数路径都占主导地位）。

正如 Billiska 所指出的，您还可以使用第 k 个最短路径算法，然后继续检查它们的结果，直到找到低于预算的路径。使用时间 O(m+ K*n*log(m/n)); 但是除非有人看到 K 的上限，这样 K 可以保证在预算范围内包含一条路径（如果存在），我们需要将 K 设置为路径的总数，再次产生指数复杂度（尽管策略又是至少在长度和成本合理相关的情况下，逐渐增加 K 可能会产生合理的平均运行时间）。

编辑：

使我提出的修改的实现复杂化（也许是致命的）是 Dijkstra 的算法依赖于节点可访问性的排序，因此我们知道，如果我们采用最短路径的未探索节点，我们将永远找不到更好的到它的路线（因为已知所有其他路线都更长）。如果那条最短的路线也很昂贵，那不必成立；即使在探索了一个节点之后，我们也必须准备好根据进入它的更长但更便宜的路径来更新离开它的路径。我怀疑这会阻止它在最坏的情况下达到多项式时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T02:48:38.227

基本上你需要找到第一个最短路径，检查它是否有效，然后找到第二个最短路径，检查它是否有效，等等......

Dijkstra 的算法不适用于此类任务。只是在谷歌上搜索这个问题的新定义，我[就找到了关于查找 kth-shortest-paths 的 Stack Overflow 问题。](https://stackoverflow.com/questions/7208720/finding-kth-shortest-paths) 我还没有读过，所以不要问我。我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T12:33:33.063

我认为您可以使用 Dijkstra 来做到这一点，但是您必须更改在每一步中计算暂定距离的方式。不仅要考虑距离，还要考虑成本。新的距离应该是 2-d number `(dist, cost)`，当您选择最小距离时，您应该选择`dist`AND最小的距离`cost <= 6`，就是这样。

我希望这是正确的。

# matlab - 图像过滤

> ID：13483135
> 
> 赞同：3
> 
> 时间：2012-11-20T22:14:29.967
> 
> 标签：matlab, filter

我在从 OCT 图像中删除线伪影时遇到问题。我尝试了维纳和中值滤波，但没有任何效果。

![](../Images/00fdb602423a9387ffa10bc85e9feafa.png)

在这张图片中，可以清楚地看到两个方向的线伪影。

通过在 Z 轴上平均 450 张图像，我可以拍摄更多照片。

![](../Images/064d15ffbcbfe42622a6db3dace343bb.png)

你能帮助我吗？请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:58:31.410

另一种选择可能是使用垂直和水平线的两个 sincs (sinc(x)=sin(x)/x) 函数掩码对图像进行傅里叶过滤。另一方面，从我所看到的情况来看，您可能希望通过了解这些线的来源来改进数据采集（即拍摄背景图像，您“扫描”任何内容并补偿探测器的散粒噪声等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:40:53.277

如果您在谈论垂直线，那么由于线很窄，您可以使用形态运算符，例如 1x7 水平侵蚀（最小），然后是 1x7 水平扩张（最大）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:21:28.043

尝试几个像素的高斯模糊。然后，对于每一列减去中值像素。对行重复。

# iphone - 在 if 语句中引用方法

> ID：13483136
> 
> 赞同：0
> 
> 时间：2012-11-20T22:14:33.120
> 
> 标签：iphone, objective-c, ios

如何在 if 语句中检查方法是否正在运行？例如-

```
if ([(UIButton *)sender isEqual:blueButton] && **showBlueText method is running** )
{
    Keep playing.
}
else if ([(UIButton *)sender isEqual:blueButton] && **showBlueText method is NOT running** )
{
    Game over.
}

-(void)showBlueText
{
blueText.hidden = NO;
[self performSelector:@selector(hideText) withObject:nil afterDelay:textDelay];
[self performSelector:@selector(showGreenText) withObject:nil afterDelay:hideDelay];
} 
```

澄清一下，'showBlueText' 是它自己的循环的一部分，它独立于这个 if 语句运行。我只是想检查 showBlueText 当前是否正在运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:20:52.927

我建议用语句替换`Keep playing`或`Game over`或。如果我得到意想不到的结果，我总是用它来跟踪程序的变化。`Doing stuff``NSLog()`

所以你的陈述可能看起来像：

```
NSLog(@"Keep playing"); 
```

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:30:30.273

您想在此处记录状态。在这个类中创建一个新的实例变量。

```
// new iVar
BOOL textIsShowing;

// method
-(void)showBlueText {
  textIsShowing = YES;
  blueText.hidden = NO;
  [self performSelector:@selector(hideText) withObject:nil afterDelay:textDelay];
}

// method
- (void)hideText {
  textIsShowing = NO;
  blueText.hidden = YES;
}

// button press
- (void)buttonPressed {
  if (textIsShowing) {
    NSLog(@"Keep playing");
  } else {
    NSLog(@"Game over");
  }
} 
```

在您调用此方法和动画停止之间，不要将其视为“正在运行”。它安排代码稍后执行。相反，您希望在它最终运行后收到通知。

在这种情况下，最容易自己跟踪状态。使用一个新变量来跟踪事物的状态，并在状态发生变化时改变它的值。

* * *

但是你不能检查一下`if (blueText.hidden)`吗？是的，你可以。但是将程序的状态存储在随机不重要对象的一些晦涩属性中是不好的做法。

检查您的状态以找出您显示的内容。不要检查显示的内容来了解​​您的状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T05:31:42.060

只需检查文本是否隐藏。无需在控制器中存储并行状态 - 所做的只是创造它们不同步的可能性。

# r - 如何使用 R 根据子项的标签标记树状图中的每个节点

> ID：13483137
> 
> 赞同：3
> 
> 时间：2012-11-20T22:14:33.413
> 
> 标签：r, dendrogram, hierarchical-clustering

我在 R 中有一个树状图，其中每片叶子都有一个值。我喜欢通过对其子节点的值求和来定义每个节点的值。我熟悉 dendrapply，但是我不知道如何在函数中访问节点的子节点以及如何递归地编写函数。

这是开始的代码：

```
library("stats")
library("fastcluster")
library("cluster")
D = rbind( + c(1,1,1,1,1), 
 + c(1,2,1,1,1),
 + c(2,2,2,2,2), 
 + c(3,4,5,6,9)

)
dnd = as.dendrogram(hclust.vector(D))

apply_text <<- function(n) {
   if (!is.leaf(n)) {

      attr(n, "edgetext") <- add the value of the branches
   }
   if (is.leaf(n)) {
      attr(n, "edgetext") <- 1
   }
   n
}

tmp <- dendrapply(dnd, apply_text)
plot(tmp) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:02:18.897

这可能是一个答案，但是，它正在重新实现 dendrapply。

```
apply_text <<- function(n){
  if (!is.leaf(n)) {
    cutversion = cut(n, h = attributes(n)$height)
    leftLabel = attr(apply_text(cutversion$lower[[1]]), "edgetext")  
    rightLabel= attr(apply_text(cutversion$lower[[2]]), "edgetext")
    attr(n, "edgetext") = as.numeric(as.character(leftLabel)) + as.numeric(as.character(rightLabel)) 
     }
  if(is.leaf(n)) {
    attr(n,"edgetext") <- 1
  }
    n
}

tmp <- dendrapply(dnd, apply_text) 
```

有人知道如何删除标签上的多边形吗？其他人似乎也要求将其删除。这方面有什么进展吗？

# c# - Mono 不支持 System.Runtime.Serialization.DataMemberAttribute EmitDefaultValue 设置

> ID：13483138
> 
> 赞同：2
> 
> 时间：2012-11-20T22:14:35.810
> 
> 标签：c#, json, serialization, mono, portability

确定在 Windows 上的 Visual Studio 中尝试了代码。

Mono 框架似乎不`EmitDefaultValue`尊重`DataMemberAttribute`. 使用以下代码：

```
using System;
using System.IO;
using System.Runtime.Serialization.Json;
using System.Runtime.Serialization;

namespace MyApp
{
    class MainClass
    {
        public static void Main (string[] args)
        {
            Cereal specialK = new Cereal();
            specialK.TheValue="This is a what?";

            var ser = new DataContractJsonSerializer(typeof(Cereal));
            MemoryStream stm = new MemoryStream();
            ser.WriteObject(stm, specialK);
            string json = System.Text.Encoding.UTF8.GetString(stm.ToArray());

            Console.WriteLine(json);
            Console.ReadLine();
        }
    }

    [DataContract]
    class Cereal
    {
        [DataMember(Name="set_on_serialize")]
        private string _setOnSerialize = string.Empty;

        [DataMember(Name = "default_export", EmitDefaultValue = false)]
        private string _default_null;

        public Cereal() { }

        [DataMember(Name = "out_value")]
        public string TheValue
        {
            get;
            set;
        }

        [OnSerializing]
        void OnSerializing(StreamingContext content)
        {
            this._setOnSerialize = "A brick!";
        }
    }
} 
```

Mono 中的输出结果为：

```
{"default_export":null,"out_value":"This is a what?","set_on_serialize":""} 
```

default_export 属性被导出为 null 但不应输出，因为它是 type 的默认值`string`。

Windows 上 VS 的正确输出是：

```
{"out_value":"This is a what?","set_on_serialize":"A brick!"} 
```

这是 Mono 中的错误还是我遗漏了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T13:47:30.967

显然，此功能尚未在单声道中实现。请参阅[单声道源代码中的 FIXME 注释](https://github.com/mono/mono/blob/master/mcs/class/System.ServiceModel.Web/System.Runtime.Serialization.Json/TypeMap.cs#L197)（第 197 行）。

# c# - 如何让 WCF 数据服务的实体实现接口？

> ID：13483139
> 
> 赞同：1
> 
> 时间：2012-11-20T22:14:38.657
> 
> 标签：c#, wcf, entity-framework, interface, wcf-data-services

我有一个从 .tt 文件生成的 EF CF 模型，所以每个实体都有一个接口，比如 .tt 文件`IEntity`。

然后我有一个暴露模型的 WCF 数据服务。

但是当我向该服务添加服务引用时，生成的实体没有这样的接口，所以我不能对它们使用泛型。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T13:00:58.693

[这](https://stackoverflow.com/questions/4720730/wcf-and-interfaces-on-data-contracts)是您没有在客户端上获得 IEntity 的详细说明。如果共享程序集的方法对您不起作用，您仍然可以执行以下操作。而不是 IEntity 创建 EntityBase。比添加到这个属性`[KnownType(typeof(MyEntity1))], [KnownType(typeof(MyEntity2))]`之类的。您正在使用 tt，因此您将能够自动生成具有所有模型类型的 EntityBase 和 knowntype 属性。比在客户端上，您将获得所有实体的基类。

# actionscript-3 - 为什么使用 Flash (AS3) 加载视频会稍微改变像素颜色？

> ID：13483143
> 
> 赞同：0
> 
> 时间：2012-11-20T22:14:55.567
> 
> 标签：actionscript-3, flash, colors

我有一个使用 Flash (AS3) 加载的视频 (MP4)。我使用 NetStream 对象在本地加载视频，当我对像素进行采样时 - 它们有点“关闭”。

为了测试这一点 - 我准备了一个只有红色像素的 100 帧视频（所有像素都是 0xFF0000）。

当我使用 Flash 的 NetStream 类加载此视频，然后使用“getPixel”测试显示的帧的像素颜色时，我得到像素颜色为：

*   R = 255
*   G = 12
*   B = 0

.

为什么“绿色”值不是 0 ？

此外，当我加载仅包含绿色帧的视频时，Flash 加载后的像素值为：

*   R = 0
*   G = 232
*   B = 0

.

只有蓝色视频帧是正确的 (0,0,255)。

为什么是这样 ？是不是 Flash 对视频进行了解码并对其进行了一些处理来改变颜色？

我需要准确的颜色，因为我对不同的像素进行采样来检测东西，并且我需要显示的颜色与视频中的真实颜色完全一样！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:46:16.840

你是同一个人[吗](http://www.kirupa.com/forum/showthread.php?375745-Why-loading-a-video-with-Flash-%28AS3%29-changes-the-pixel-colors-a-bit&p=2648136)？我会**支持 bwhiting**提供的答案：

> 这将是编码过程，而不是闪存中的回读。我已经用这个和最好的解决方案做了很多测试（如果你在视频像素中嵌入数据，是使用阈值..因为它们的值不应该完全超出，而只是略微..但这又会根据压缩的方式而改变剪辑是 - 更多压缩 = 不太准确的颜色信息）

当您对红色或绿色视频进行编码时，它必须与损失有关。

# android - 在 Eclipse 中使用 JNI 构建 OpenCV 应用程序

> ID：13483144
> 
> 赞同：1
> 
> 时间：2012-11-20T22:14:54.117
> 
> 标签：android, c++, opencv, android-ndk

在 Eclipse 中使用 OpenCV 和 JNI 部分构建 android 应用程序时遇到问题。

问题在于项目的 ndk-build 正常运行，但 Eclipse 显示错误（通常与代码无关）。

例如，我正在构建 OpenCV4Android 示例之一：

```
boris@boris-ubuntu:~/src/OpenCV-2.4.3-android-sdk/samples/tutorial-3-native$ ndk-build 
Install        : libnative_camera_r2.2.0.so => libs/armeabi-v7a/libnative_camera_r2.2.0.so
Install        : libnative_camera_r2.3.3.so => libs/armeabi-v7a/libnative_camera_r2.3.3.so
Install        : libnative_camera_r3.0.1.so => libs/armeabi-v7a/libnative_camera_r3.0.1.so
Install        : libnative_camera_r4.0.0.so => libs/armeabi-v7a/libnative_camera_r4.0.0.so
Install        : libnative_camera_r4.0.3.so => libs/armeabi-v7a/libnative_camera_r4.0.3.so
Install        : libnative_camera_r4.1.1.so => libs/armeabi-v7a/libnative_camera_r4.1.1.so
Install        : libnative_sample.so => libs/armeabi-v7a/libnative_sample.so
Install        : libopencv_java.so => libs/armeabi-v7a/libopencv_java.so 
```

它运行正常，但 Eclipse 显示错误：

```
'size_t' is ambiguous '
Candidates are:
Field 'pt' could not be resolved
Field 'pt' could not be resolved
Field 'x' could not be resolved
Field 'y' could not be resolved
Invalid arguments '
Candidates are:
void detect(const cv::Mat &, ? &, const cv::Mat &)
void detect(const ? &, ? &, const ? &)
The type 'cv::FastFeatureDetector' must implement the inherited pure virtual method 'cv::FeatureDetector::detectImpl' 
```

以及其他项目中的类似错误。而且，Eclipse 智能感知（或者它是如何正确调用的 :) 不适用于 .cpp 文件。

我试图清理项目，删除 obj 和 lib 文件夹，但没有效果。

我的系统是ubuntu 12.04，OpenCV版本是2.4.3。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T16:03:07.157

在 ubuntu 12.04 上遇到同样的问题，OpenCV 版本是 2.4.3。完全在同一个例子中，我正在使用 eclipse-android 包。

这是我所做的：

使用 google repo 更新 NDK 插件，它已经安装但可以更新。

然后我将 size_t 更改为 int 并添加了一个临时变量，而不是像示例那样直接进行。这是代码：

```
Mat* pMatGr=(Mat*)addrGray;
Mat* pMatRgb=(Mat*)addrRgba;
vector<KeyPoint> v;
FastFeatureDetector detector(50);
detector.detect(*pMatGr, v);
for( int i = 0; i < v.size(); i++ )
{
     KeyPoint tK = v[i];
    circle(*pMatRgb, Point(tK.pt.x, tK.pt.y ), 10, Scalar(255,0,0,255));
} 
```

这确实是一个奇怪的错误，我的猜测是它与 eclipse 调试机制无法正常工作有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T04:21:44.487

是的，非常奇怪的错误。我在 Ubuntu 12.04 和 OpenCV 2.4.5 上。

我在“OpenCV 教程 2 - 混合处理”中遇到了同样的错误

无需重新安装 Eclipse 或 NDK 即可修复它。刚刚删除了示例项目，然后再次导入。现在工作正常。

# forms - 如何在函数开始时显示在函数结束时关闭的表单？

> ID：13483147
> 
> 赞同：1
> 
> 时间：2012-11-20T22:15:06.440
> 
> 标签：forms, vb6, modal-dialog

我有一个可能需要一些时间才能执行的功能。

如何在函数开始时显示一个小的模态表单，该表单在函数完成时关闭？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T22:58:30.087

我最喜欢的技巧是将运行的代码放入运行时显示的表单中。然后当它完成后调用 Unload Me

```
'Code in Form1
Call frmWait.Show(vbModal, Me)

'Code in frmWait
Private Sub Form_Activate()

    'Do some work ...

    Unload Me

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:17:38.610

假设 frmModal 是您希望显示的形式。在你的函数开始时放入

```
frmModal.Show
frmModal.refresh 
```

在你的函数结束时放入

```
Unload frmModal 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T07:30:13.263

当您加载表单模式（form1.show vbmodal）时，在模型表单关闭之前不会执行后续代码

模拟您想要的一种简单方法（没有 api）是无模式显示表单，并临时禁用其他表单

在以下测试项目中查看 command1 和 command2 之间的区别：

```
'3 forms :
'    Form1 : name=Form1
'        contains 2 command buttons with the name Command1 and Command2
'    Form2 and Form3 contain nothing special
Option Explicit

Private Sub Command1_Click()
  Dim lngEnd As Long
  Form3.Show vbModal
  lngEnd = Timer + 5
  Do While Timer < lngEnd
    Caption = CStr(Timer)
    DoEvents
  Loop
  Unload Form3
End Sub

Private Sub Command2_Click()
  Dim lngEnd As Long
  Enabled = False
  Form2.Show vbModeless, Me
  lngEnd = Timer + 5
  Do While Timer < lngEnd
    Caption = CStr(Timer)
    DoEvents
  Loop
  Enabled = True
  Unload Form2
End Sub 
```

# c++ - C++ 原子负载排序效率

> ID：13483150
> 
> 赞同：2
> 
> 时间：2012-11-20T22:15:16.673
> 
> 标签：c++, c++11, atomic

我有一个在线程 A 中更新并在其他线程中读取的内存变量。读者只关心值是否非零。我保证一旦值增加，它就永远不会回到零。如下优化有意义吗？换句话说，在读者方面，一旦我满足了我的条件，我就不需要“围栏”。

```
std::atomic<int> counter;

writer:
increment()
{ 
    counter.store(counter+1, std:memory_order_release)
}

reader:
iszero()
{
    if (counter.load(std::memory_order_relaxed) > 0) return false;
    // memory fence only if condition not yet reached
    return (counter.load(std::memory_order_acquire) == 0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:44:15.690

首先，如果您实际上没有尝试过使用默认（顺序一致）原子，测量您的应用程序的性能，对其进行分析，并显示观察到它们导致性能问题，我建议现在返回。

然而，如果你真的需要开始推理松弛原子......

* * *

尽管几乎可以肯定它可以在 x86 上运行，但这并不能保证达到您的预期。

我猜你正在使用它来保护其他一些非原子数据的发布。

在这种情况下，您需要保证**如果**您在读取器线程中读取了一个非零值，**那么**您在编写器中创建的非原子内存位置（即初始化您正在发布的数据）的各种其他副作用存储之前的线程将对读者线程可见。

读取非零`std::memory_order_relaxed`不与存储*同步*`std::memory_order_release`，因此您上面的代码没有此保证。

要获得我所描述的行为，您需要使用`std::memory_order_acquire`. 如果您使用的是 x86，那么获取不会产生任何内存围栏指令，因此它在性能上的唯一区别`memory_order_relaxed`是通过阻止一些编译器优化。

# c# - 如何验证登录并传递用户 ID

> ID：13483156
> 
> 赞同：-1
> 
> 时间：2012-11-20T22:15:41.043
> 
> 标签：c#, winforms, stored-procedures

> **可能重复：**
> [使用属性在两个表单之间传递数据](https://stackoverflow.com/questions/5087934/passing-data-between-two-forms-using-properties)

我正在使用以下代码来验证 winform 应用程序的登录。

```
public int Validate_Login(String Username, String Password)
        {

            //SqlConnection con = new SqlConnection(@"User id=judgment_day;Password=Kit$hen;Server=216.40.232.82, 2153;Database=new_judgment-system");
            SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["rawr"].ConnectionString);
            SqlCommand cmdselect = new SqlCommand();
            cmdselect.CommandType = CommandType.StoredProcedure;
            cmdselect.CommandText = "[dbo].[prcLoginv]";
            cmdselect.Parameters.Add("@Username", SqlDbType.VarChar, 50).Value = Username;
            cmdselect.Parameters.Add("@UPassword", SqlDbType.VarChar, 50).Value = Password;
            cmdselect.Parameters.Add("@OutRes", SqlDbType.Int, 4);
            cmdselect.Parameters["@OutRes"].Direction = ParameterDirection.Output;
            cmdselect.Connection = con;
            int Results = 0;

            try
            {
                con.Open();
                cmdselect.ExecuteNonQuery();
                Results = (int)cmdselect.Parameters["@OutRes"].Value;
            }
            catch (SqlException ex)
            {
                lblMessage.Text = ex.Message;
            }
            finally
            {
                cmdselect.Dispose();

                if (con != null)
                {
                    con.Close();
                }
            }
            return Results;
        }

        protected void btnlogin_Click(object sender, EventArgs e)
        {
            int Results = 0;

            if (txtUsername.Text != null && txtPassword.Text != null)
            {

                Results = Validate_Login(txtUsername.Text, txtPassword.Text);

                if (Results == 1)
                {

                    lblMessage.Text = "Login is Good";

                    this.Hide();
                    frmSwitch frm = new frmSwitch();
                    frm.Show();   

                }

                else
                {

                    lblMessage.Text = "Invalid Login";

                    lblMessage.ForeColor = System.Drawing.Color.Red;

                }

            }

            else
            {

                lblMessage.Text = "Please make sure that the username and the password is Correct";

            }
        } 
```

SP如下：

```
Create Proc [dbo].[prcLoginv]  
 (  
 @Username VarChar(50),   
 @UPassword varChar(50),  
 @OutRes int OUTPUT  
 )  
 AS  
set @OutRes = (SELECT count(*) FROM [dbo].Log_Users   
WHERE Username = @Username And [Password] = @UPassword)  
if(@OutRes = 1)  

begin  
set @OutRes = 1--Login is Correct  
end  
else  
begin  
set @OutRes = 0  --Bad login  
end 
```

我将如何修改它以返回用户 ID，以便我可以将其传递给另一个表单。我需要使用该 ID 来显示谁在处理什么文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:50:45.617

代替

```
set @OutRes = (SELECT count(*) FROM [dbo].Log_Users   
WHERE Username = @Username And [Password] = @UPassword) 
```

你可以试试

```
select @OutRes = userid from x where blah. 
```

如果查询没有返回任何行，则返回 0，如果有多行，则返回最后一行。

# magento-1.4 - Magento -> 这是一个匿名函数吗？

> ID：13483157
> 
> 赞同：0
> 
> 时间：2012-11-20T22:15:46.410
> 
> 标签：magento-1.4

我们的代码库中有很多代码是由第三方开发人员完成的。他们修改了核心中的许多地方，我们想弄清楚到底发生了什么。

他们有这样的代码：

```
$pidsess = Mage::getSingleton('core/session', array('name'=>'frontend'));
$pidsess->setNA_pid(array("PID" => $pid, "PartInfo" => $return_data['result'])); 
```

这样做是存储一个“全局可用变量”，可以在 Magento Session 活动的任何时候调用，如下所示：

```
$pidsess = Mage::getSingleton('core/session', array('name' => 'frontend'));
$piddata = $pidsess->getNA_pid(); 
```

我在哪里可以找到设置这个“变量”的代码？我搜索了“setNA_”并找到了几个调用，但没有一个是实际的函数调用。

这是 Magento 愚蠢的 EAV 架构的一部分，您可以在其中编写自己的函数来设置 EAV 值吗？如果是这样，这些值将存储在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:30:44.390

仅仅因为你没有时间理解和/或不喜欢它而称它为愚蠢肯定不会有帮助。但是，与许多 magento 基类一样，它可能只是在 magento 会话中设置了一个变量，该变量在会话存储中的某个位置结束。

我会`Mage::log(print_r($_SESSION,1)`先看看是否真的存在`['NA_pid']`.

它与EAV无关。

# selenium - 等待 Selenium 在不同页面上使用的相同 XPATH

> ID：13483160
> 
> 赞同：1
> 
> 时间：2012-11-20T22:16:01.820
> 
> 标签：selenium, webdriver, sleep, wait

我正在使用 Selenium Webdriver，并且在我的测试应用程序中遇到了以下问题。

该应用程序有多个页面，每个页面都有一个适当的“.page-title”元素，其中包含页面的名称（例如“其他文档”）。当测试在应用程序中导航时，他们断言浏览器在执行其他操作之前使用这些元素位于预期页面上。

问题是，如果您单击应用程序中执行操作的按钮，然后检查您是否在正确的页面上（例如检查 page-title 元素显示正确的文本），Webdriver 不会等待执行操作（例如新页面加载），它会立即返回并且测试失败。

如果您在执行操作和检查您是否在正确的页面之间添加一个短线程睡眠（500 毫秒），那么您会得到 StaleElementReferenceException（有时），如果您添加一个大线程睡眠，则测试通过（但不是*全部*时间）。

我的目标是减少测试的脆弱性，有没有人建议我如何在没有 Thread.sleep 的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T04:55:49.827

而不是显式地插入 thread.sleep 方法

在内置的 Implicitwait 方法中尝试 WebDriver ..（C# 代码片段）

```
Driver.Manage().Timeouts().ImplicitlyWait(TimeSpan.FromSeconds(Max_Time_Limit)); 
```

这使得 WebDriver 等待元素可见/可用。如果它在 Max_Time_Limit 之前找到元素，它会退出睡眠模式并恢复执行。

因此，无需等到硬绑定 Max_Time_Limit。这种方式也有助于加快您的执行时间。

我希望这会有所帮助......一切顺利:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T05:12:46.723

尝试使用此等待：使用此您可以等待最长 15 秒/等待预期条件为真，即等待某些元素出现。

您可以在下一页上提供某个元素的 xpath，当该元素可见时，将执行下一步。

WebDriverWait 等待 = 新的 WebDriverWait(驱动程序, 15); wait.until(ExpectedConditions.elementToBeClickable(By.xpath("\xpath of some element on next page"))); //断言页面标题

driver.getTitle();

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T07:54:24.730

您可以使用 Selenium 的`ExpectedCondition`. 下面的代码（用 JAVA 编写）等待`inTimeout`您要出现的元素最多几秒钟。如果元素出现得较早，则结束等待。

```
public static void wait(WebDriver b,long inTimeout) {
    final SlnDriver browser=b;
    final long NO_LOADING_TIMEOUT = inTimeout;

    class HasCondition implements ExpectedCondition<Boolean> {

        @Override
        public Boolean apply(WebDriver d) {
            Boolean expected=false;
            WebElement e = browser.findElement(By.xpath("blabla"));
                if (e.getText().contains("TextYouWant")) {
                    expected= true;
                    break;
                }
            }
            return expected;
        }

    }
    }
    for (;;) {
        try {
            new WebDriverWait(browser, NO_LOADING_TIMEOUT).until(new HasCondition());
        } catch (TimeoutException e) {
            return;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T07:58:41.957

使用fluentWait机制。被认为是一种稳健的方法。正如有关 fluent wait 的文档所给出的那样： *Wait 接口的实现可以动态配置其超时和轮询间隔。每个 FluentWait 实例定义等待条件的最长时间，以及检查条件的频率。此外，用户可以将等待配置为在等待时忽略特定类型的异常，例如在页面上搜索元素时的 NoSuchElementExceptions。* 您可以在这里获得的详细信息[是](http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/support/ui/FluentWait.html) 我使用的方法代码：

```
 public WebElement fluentWait(final By locator){
        Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
                .withTimeout(30, TimeUnit.SECONDS)
                .pollingEvery(5, TimeUnit.SECONDS)
                .ignoring(NoSuchElementException.class);

        WebElement foo = wait.until(
new Function<WebDriver, WebElement>() {
            public WebElement apply(WebDriver driver) {
                        return driver.findElement(locator);
                }
                }
);
                           return  foo;              }     ;

String xPathElement="...blablabla...";
fluentWait(By.xpath(xPathElement)).click();
//fluentWait(By.xpath(xPathElement)).getText(); 
```

希望对你有效。

# android - 在 Android 应用程序中使用混合 Java/Ruby 代码？

> ID：13483164
> 
> 赞同：3
> 
> 时间：2012-11-20T22:16:25.713
> 
> 标签：android, ruby, jruby, dalvik, mirah

是否可以用 Ruby 编写部分 Android 应用程序，然后使用 JRuby 和 Android 工具编译代码以在 Dalvik VM 上运行？我不需要任何运行时支持来解释 Ruby 代码，只需要运行一个 Ruby 模块。如果编译的代码是最小的，那将是很好的，而不是拖累整个 Ruby 标准库。

如何配置一些 IDE（如 Eclipse）和 Android 工具来支持它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-03T18:14:24.197

有关在 Dalvik VM 上运行的 @CharlesOliverNutter 的类似 Ruby 的 Mirah 语言，请参阅[这些](https://stackoverflow.com/a/2164646/1136063)/[三个](https://stackoverflow.com/a/4694044/1136063)/[答案（在 stackoverflow 上）。](https://stackoverflow.com/a/8830235/1136063)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:45:27.577

看看[鲁博托](https://github.com/ruboto/ruboto/)。

前段时间，我正在为正在使用它的 android 开发一个调试库，但我没时间了。我看了很多[ruboto-irb](https://github.com/ruboto/ruboto-irb)源代码。

我提出的主要缺点是它需要在设备上安装 ruboto。

# iphone - 关于跟踪字段的建议

> ID：13483165
> 
> 赞同：0
> 
> 时间：2012-11-20T22:16:35.623
> 
> 标签：iphone, ios, xcode

我发布此消息是为了获得有关最佳方法的建议。

我正在制作一个程序，用户可以在其中选择他们想要使用的字段。该列表以表格的形式出现在下一个屏幕上。根据所选字段，textFields 中的 placeHolder 会发生变化。因此，我必须跟踪选定的字段。

到目前为止，我已经考虑了以下方法：

1.  两个数组。一个存储单元格上的标签列表，第二个数组存储 1/0 值。1：选中字段，0：未选中。因此，我将不得不从数组 1 中获取字段的名称，以及是否从第二个中选择它。

2.  一个包含 1/0 的数组，指示该字段是否被选中。我遍历数组以确定是否应该显示哪些 placeHolders。

3.  NSDictionary：它将包含对象：“字段名称”和键：1 或 0。

我认为这些选项中的任何一个都不是好的编程习惯，因为有很多 if 和 else 语句，而且代码中存在大量重复。

您能否建议解决此问题的最佳方法？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:59:28.773

我想你想要的是弄清楚哪一个被选中了。您可以使用一个数字来标记选择了哪一个。
假设有 3 个字段：`field0` `field1` `field2`和 binary 中的数字`000`。一旦`field1`被选中，然后将数字标记为`010`。将此数字传递到下一个屏幕，然后您可以将`&`其用于每个文件。
对于`field0`，您可能会`010 & 000`得到一个结果`0`，即`field0`未选择。
对于`field1`，您可能会`010 & 010`得到一个结果，即没有选择`0`哪个鬃毛`field1`。
对于`field2`，您可能会`010 & 100`得到一个未选择`0`鬃毛的结果。`field2`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:37:00.160

不知道为什么你认为有很多 if/else 语句。您可以使用字典数组来完成，其中每个字典包含两个键：字段名称和选定。Fieldname 是 NSString，选择的是 NSNumber 包装一个布尔值。然后在你的 cellForRowAtIndexPath 你有类似的东西：

```
NSDictionary *cellData = dataArray[indexPath.row];
cell.textLabel.text = cellData[@"field_name"];
if ([[cellData@["selected"] boolValue] == YES) { ... do whatever you do when the cell is selected, like add a checkmark ... } 
```

您可能还考虑制作一个自定义数据类来保存每个单元格的数据。您可以为标签名称和选定属性创建属性（这将避免必须包装和打开 NSNumber 来表示是/否）。您可以在自定义类上定义根据所选内容返回正确标签的方法。然后，您只需创建这些自定义对象的数组。

# asp.net-mvc - “发生类型加载异常。” 将 DbContext 与 MySql 连接器与 Mono 一起使用

> ID：13483166
> 
> 赞同：1
> 
> 时间：2012-11-20T22:16:36.563
> 
> 标签：asp.net-mvc, mono, entity-framework-4.1, ef-code-first, mysql-connector

我正在尝试在 ASP.NET MVC 3 项目中将 MySQL 数据库与实体框架版本 4.1.0.0 和 Mono 2.11.4 一起使用。

在我的本地 Windows 系统上一切正常，但是当我将它发布到我的 Ubuntu 12.04 LTS 系统时，我得到了很多错误。

首先我得到：

> 无法从程序集“EntityFramework，Version=4.1.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”加载类型“System.Data.Entity.Infrastructure.DbUpdateException”。

当我按下时`F5`，每次页面刷新时都会出现不同的错误：

*   > 无法从程序集“EntityFramework，Version=4.1.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”加载类型“System.Data.Entity.Infrastructure.DbUpdateConcurrencyException”。

*   > 无法从程序集“EntityFramework，Version=4.1.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”加载类型“System.Data.Entity.Infrastructure.DbCompiledModel”。

*   > 无法从程序集“EntityFramework，Version=4.1.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”加载类型“System.Data.Entity.Infrastructure.ReplacementDbQueryWrapper`1[TElement]”。

*   > 无法从程序集“MySql.VisualStudio，版本=6.6.4.0，文化=中性，PublicKeyToken=c5687fc88969c44d”加载类型“MySql.Data.VisualStudio.Editors.SqlEditor”。

*   > 无法从程序集“MySql.VisualStudio，版本=6.6.4.0，文化=中性，PublicKeyToken=c5687fc88969c44d”加载类型“MySql.Data.VisualStudio.WebConfig.WebConfigDlg”。

*   > 发生类型加载异常。

当我尝试通过以下代码使用数据库时发生最后一个错误：

```
using (var db = new DefaultContext())
{
    db.Persons.Add(new Person() { Name = "hallo", Address = "bllaaa" });
    db.SaveChanges();

    var persons = db.Persons.ToList();
    return View(persons);
} 
```

有没有人遇到过类似的问题并解决了？我不知道该怎么办。

PS：我使用代码优先迁移

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:45:42.820

据我了解，Mono 正在捆绑实体框架的开源版本，它本质上是尚未发布的 v6。

[http://weblogs.asp.net/scottgu/archive/2012/07/19/entity-framework-and-open-source.aspx](http://weblogs.asp.net/scottgu/archive/2012/07/19/entity-framework-and-open-source.aspx)

因此，您似乎不能以 EF v4.x 为目标，因为代码可能已经发生了重大变化。虽然，如果您发现看似缺少的类型仍然存在，您可以尝试使用程序集重定向解决此问题（只需搜索 bindingRedirect）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T01:04:23.030

我知道为什么会这样。从源代码安装单声道后，我通过 apt-get 安装了 mono-fastcgi-server4。所以我安装了 2 个单声道版本，而旧的版本处于活动状态。(2.10.8)

实体框架对我来说似乎完全没用，因为只有新的 EF6 可以与数据库一起使用，但没有任何提供者支持 EF6 并使用单声道。

# jquery - 我想自动点击按钮

> ID：13483172
> 
> 赞同：0
> 
> 时间：2012-11-20T22:16:54.467
> 
> 标签：jquery

我想自动点击按钮

但是怎么做？

我试过这个但没有成功

```
 <html>
 <head>

 <script>
 $(function(){
 $("a").click(function(){
alert("hillo");
});
 });

$("a").click();

  </script>
</head>

<body>

<a href="http://google.com">google</a>

</body>

</html> 
```

这口井只用过也没成功

```
$("a").click(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:19:08.517

您需要在调用之前实际包含 jQuery`$(function...`

```
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
```

您还需要调用 to`.click()`在 ready 函数中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T22:19:59.520

您拥有它的方式`$("a").click()`将在文档就绪事件之前调用。如果将它放在同一个文档就绪处理程序中，它应该可以工作。

```
$(function(){
    $("a").click(function(){
        alert("hillo");
    });
    $("a").click();
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T22:22:15.090

您的代码有一些问题。

*   您没有包含对 jQuery 的引用：`<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>`
*   “自动”调用`.click`在文档 .ready 函数之外
*   [**http://jsfiddle.net/SpYk3/nww4S/**](http://jsfiddle.net/SpYk3/nww4S/)

> 你的代码*应该*是：

```
<html>
    <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            $("a").click(function(e) { alert("hillo"); });

            $("a").click();
        });
    </script>
    </head>
    <body>
        <a href="http://google.com">google</a>
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:18:00.130

尝试在`DOM handler`..中触发事件

evnet**甚至在它被分配之前就被触发了**`click()`，正如你所写的那样**`outside the DOM handler`**

 **假设你已经包含了 jQuery 文件

```
$(function(){
    $("a").click(function(){  // $("a").on('click', function()   
                              //  this is better
       alert("hillo");
     });

    $("a").click();   // Moved it inside
 }); 
```

[http://jsfiddle.net/sushanth009/XwjYj/](http://jsfiddle.net/sushanth009/XwjYj/)**

# excel - VBA：从用户表单中获取价值并在列中插入

> ID：13483173
> 
> 赞同：0
> 
> 时间：2012-11-20T22:16:54.123
> 
> 标签：excel, vba

我正在尝试从宏中获取用户输入并将该字符串复制到列的长度（理想情况下，只要我的第一列有内容）

例如：你在哪个国家？

用户输入：**美国**

```
Column1    Column2

Steve      United States

Bill       United States

Blank      United States

Alice      United States 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:41:40.923

忽略大量错误检查/确保已输入答案，这是最简单的方法：

```
 Sub Test()

  Dim Answer As String

  Answer = InputBox("What country are you in?")
  Intersect(ActiveSheet.UsedRange, ActiveSheet.Range("A:A")).Offset(0, 1).Value = Answer

  End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:04:22.700

给你。如果**A 列**中的单元格**不为空白**，则此子将仅填写**B 列**中的相应单元格。

 ****它遍历 A 列中的每个项目，检查单元格是否为空白，如果单元格不为空白，则将“答案”字符串放入 B 列。

```
Sub country()

Dim Answer As String, i As Range

Answer = InputBox("What country are you in?")

For Each i In ActiveSheet.Range("A2", ActiveSheet.Range("A300000").End(xlUp))

    If i <> vbNullString Then
        i.Offset(0, 1).Value = Answer
    End If

Next i

End Sub 
```****

# c# - Sharpbox DropBoxTokenIssuer.exe 工具不工作，其他用于轻松创建 Dropbox 访问令牌的工具？

> ID：13483174
> 
> 赞同：0
> 
> 时间：2012-11-20T22:17:01.687
> 
> 标签：c#, dropbox, dropbox-api

我想使用 SharpBox 附带的**DropBoxTokenIssuer**工具，以便轻松创建对 Dropbox 帐户的应用程序访问，但它在 atm 中不起作用。

有没有人知道如何修复它，或者知道可以做同样事情的不同工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T14:34:26.563

答案请参考以下网址...

[http://sharpbox.codeplex.com/workitem/18848](http://sharpbox.codeplex.com/workitem/18848)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T17:24:02.143

我一直在使用[DropNet](https://github.com/dkarzon/DropNet)（也在[NuGet](http://nuget.org/packages/dropnet)上）取得了巨大的成功。GitHub 说明为通过 Dropbox 授权工作流程提供了很好的示例代码。

# mysql - 获取未在我的 MySQL 数据库表中列出的第一个可用数字

> ID：13483176
> 
> 赞同：4
> 
> 时间：2012-11-20T22:17:12.130
> 
> 标签：mysql, sql, numbers

任何 SQL 来获取我的 MySQL 数据库表中未列出的第一个数字？前任：

表：用户

```
ID  | Name   | Number
------------------------
1   | John   | 1456
2   | Phil   | 345
3   | Jenny  | 345612 
```

在这种情况下，SQL 必须返回编号从 1 到 344 和 346 到 1455 和 1457 到 345611 的行列表

有什么建议么？也许有一些程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:28:53.257

鉴于评论，我的第一种方法是使用“随机数”探测。这种方法假设：

1.  `Number`被索引；和
2.  用户数量“明显少于”可用数量

方法：

1.  `N`在客户端随机选择（即1-10）个数字；
2.  查询数据库,`Number IN (ns..)`或`Number = n`; `N=1`然后
3.  *可以基于未找到*请求的记录来检测号码是否可用。

在这种情况下，大小`N=1`可能“没问题”，并且实现起来最简单，尽管它需要至少 6 个数据库请求才能找到 6 个空闲号码。较大的`N`将减少访问数据库的次数。

确保使用事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:33:39.170

我喜欢@pst 的答案，但会建议另一种选择。

1.  创建一个未分配数字的新表，在其中插入几千行左右。

2.  向用户展示其中一些数字。

3.  使用号码时，将其从未分配号码表中删除。

4.  根据需要定期生成更多未分配的号码。

这些未分配数字的生成可以使用@pst 建议的随机方法，但是使用这种方法，您可以将生成未分配数字列表需要多长时间的不确定性转移到批处理任务中，而不必在用户等待时的前端。如果数字空间的使用是稀疏的，这可能不是问题，但随着更多的数字空间被使用，它成为一个更大的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:32:18.273

只需使用自动增量列。数据库将自动分配下一个号码。您甚至不需要知道插入时它是什么。只告诉用户他得到的号码，根本不给他选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:44:19.953

```
SELECT 'start', 1 AS number FROM tableA
 UNION
SELECT 'min', number - 1 number FROM tableA
 UNION
SELECT 'max', number + 1 number FROM tableA
 ORDER BY number 
```

[您可以在http://www.sqlfiddle.com/#!2/851de/6](http://www.sqlfiddle.com/#!2/851de/6)查看答案

然后，您可以在下次填充时对缺失的数字进行比较。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T22:49:22.520

根据您的评论，以下方法可能对您有用。它并没有真正回答您的具体问题，但它可能满足您的要求。

我将假设您的要求不会改变（例如，向用户提供 6 个可能的 id 选择）。坦率地说，我认为这是一个奇怪的要求，但它产生了一些有趣的 SQL。:-)

这是我的方法：生成 10 个随机数。过滤掉数据库中已经存在的任何内容。向您的用户展示其中的 6 个随机数。与顺序 id 编号相比，随机 id 编号在事务性方面具有非常好的属性，因此如果您的应用程序变得流行，它应该可以很好地扩展。

```
SELECT
  temp.i
FROM
  (
          SELECT 18 AS i   -- 10 random
    UNION SELECT 42        -- numbers.
    UNION SELECT 88        
    UNION SELECT 191       -- Let's assume
    UNION SELECT 192       -- you generated
    UNION SELECT 193       -- these in the
    UNION SELECT 1000      -- application
    UNION SELECT 123456    -- layer.
    UNION SELECT 1092930
    UNION SELECT 9892919
  ) temp
LEFT JOIN
  mytable ON (temp.i = mytable.i)
WHERE
  mytable.i IS NULL       -- filter out collisions
LIMIT
  6                       -- limit results to 6 
```

* * *

**SQL弹出测验时间！！！**

*   为什么行“ `WHERE mytable.i IS NULL`”过滤冲突？（*提示*`mytable.i`：当它是主键时，它怎么可能是空的？）

* * *

下面是一些测试数据：

```
CREATE TABLE mytable (i BIGINT PRIMARY KEY) ;

INSERT INTO mytable VALUES (88), (3), (192), (123456) ; 
```

运行上面的查询，结果如下。请注意，88、192 和 123456 被过滤掉了，因为它们会与测试数据发生冲突。

```
+---------+
| i       |
+---------+
|      18 |
|      42 |
|     191 |
|     193 |
|    1000 |
| 1092930 |
+---------+ 
```

以及如何生成这些随机数？可能 rand() * 9223372036854775807 会起作用。（假设你不想要负数！）

# opengl-es - 我可以在 Windows Phone 8 应用程序中使用 OpenGL ES 吗？

> ID：13483179
> 
> 赞同：15
> 
> 时间：2012-11-20T22:17:34.687
> 
> 标签：opengl-es, windows-phone-8

我读过 Windows Phone 8 不支持 OpenGL 的地方，但我在 SDK 中找不到任何有用的东西。

那么我是否能够在我的 Windows Phone 8 游戏中使用 OpenGL (ES)？我有一个游戏我不想在移植时完全重写为 DirectX。

请引用好的来源，我发现的唯一东西是猜测和博客文章，几乎没有信息。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-21T00:12:58.890

WP8 不支持 OpenGL，但支持 Direct 3D 功能级别 9_3。如果您希望将游戏从 OpenGL ES 移植到 D3D，请查看[Angle Project](http://code.google.com/p/angleproject/)。Angle Project 有助于弥合 OpenGL ES 2.0 和 D3D 9 之间的差距。它还没有针对 WP8 的目标，并且您会遇到 WP8 不支持运行时编译着色器的问题，但 Angle 项目仍然是一个很好的第一步。

无论哪种方式，对于与其他平台的游戏可移植性，最好使用中间件游戏框架，例如 MonoGame、Unity、Cocos2D、Havok、Marmalade、SharpDX、Ogre、Autodesk Scaleform 或其他。这些引擎将主要在他们自己的框架内为您处理跨平台支持（每个引擎都有自己的代码和资产可移植性限制）。

如果你已经有一个现有的 OpenGL 游戏你想移植到 WP8，那么如果你最好的选择是 Angle 项目。如果您刚刚开始创建跨平台便携式游戏，那么选择一个似乎适合您游戏需求的游戏中间件框架才是正确的选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-18T06:11:59.267

Marmalade 确实让您编写 OpenGL ES 2.0 代码并使其在 Windows phone 8 中运行，而无需您做任何事情

检查此以获取更多详细信息：http: [//www.madewithmarmalade.com/windows-phone-8](http://www.madewithmarmalade.com/windows-phone-8)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:55:59.693

即使 Windows Phone 8 支持 OpenGL（它不支持），它也会支持 OpenGL ES，而不是 destkop OpenGL。因为它适用于嵌入式平台。

所以没有两次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-21T11:59:02.887

[Gideros](http://giderosmobile.com/)使用 OpenGL 并通过轻量级 DX 包装器定位 Windows RT/Phone 图形。

# javascript - 用于交互式图形绘图的轻量级 JavaScript 库？

> ID：13483180
> 
> 赞同：4
> 
> 时间：2012-11-20T22:17:42.023
> 
> 标签：javascript, graph

我有兴趣了解用于绘制交互式图形的最轻量级的 javascript 库。我掌握的数据主要是与海洋研究相关的科学数据。

我知道一些 jquery 库，即 Highcharts 和 JS 图表。但我正在寻找的是最轻量级的库。该图不需要提供实时数据，但它必须是交互式的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:32:56.907

我肯定会推荐[D3.js](http://d3js.org/)。

有一些制作精良的数据驱动文档和使用它的示例。最近[VizSec](http://www.vizsec.org/)会议的许多演示文稿也使用了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:35:53.293

我的一些同事使用了 Flot JQuery 插件。检查出。[http://www.flotcharts.org/](http://www.flotcharts.org/)

# html - htaccess 隐藏 html 扩展和 addThis 插件

> ID：13483186
> 
> 赞同：0
> 
> 时间：2012-11-20T22:18:03.150
> 
> 标签：html, .htaccess, addthis

我正在使用这个 htaccess 代码在我的网站上隐藏 .html 扩展名，但是这样做时 addThis 共享插件不起作用。您可以在这里找到 addThis：[https ://www.addthis.com/get/sharing](https://www.addthis.com/get/sharing)

有什么解决方法吗？

```
RewriteBase /

RewriteEngine on
RewriteCond %{THE_REQUEST} \ /(.+/)?index(\.html)?(\?.*)?\  [NC]
RewriteRule ^(.+/)?index(\.html)?$ /%1 [R=301,L]

RewriteCond %{ENV:REDIRECT_STATUS} ^$
RewriteRule ^(.+)\.html$ /$1 [R=301,L]

RewriteCond %{SCRIPT_FILENAME}.html -f
RewriteRule [^/]$ %{REQUEST_URI}.html [QSA,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T22:23:14.963

目前无法汇总不同 URL 的共享计数：

[http://support.addthis.com/customer/portal/questions/206634-can-i-total-share-counts-for-two-different-urls-short-and-full-for-the-same-content-](http://support.addthis.com/customer/portal/questions/206634-can-i-total-share-counts-for-two-different-urls-short-and-full-for-the-same-content-)

这不是重定向的问题，而是 addthis 代码的问题。

您应该从一开始就使用重定向代码。

# c# - 交替线程#2

> ID：13483192
> 
> 赞同：4
> 
> 时间：2012-11-20T22:18:18.160
> 
> 标签：c#, multithreading

想象这样一种情况，有一个国王和 n 个仆从提交给他。当国王说“一！”时，其中一个仆从说“二！”，但只有**一个**。也就是说，只有最快的仆从说话，而其他仆从必须等待国王的另一次召唤。

这是我的尝试：

```
using System;
using System.Threading;

class Program {
    static bool leaderGO = false;

    void Leader() {
        do {
            lock(this) {
                //Console.WriteLine("? {0}", leaderGO);

                if (leaderGO) Monitor.Wait(this);

                Console.WriteLine("> One!");
                Thread.Sleep(200);
                leaderGO = true;

                Monitor.Pulse(this);
            }
        } while(true);
    }

    void Follower (char chant) {
        do {
            lock(this) {
                //Console.WriteLine("! {0}", leaderGO);

                if (!leaderGO) Monitor.Wait(this);

                Console.WriteLine("{0} Two!", chant);
                leaderGO = false;

                Monitor.Pulse(this);
            }
        } while(true);
    }

    static void Main() {
        Console.WriteLine("Go!\n");

        Program m = new Program();

        Thread king = new Thread(() => m.Leader());

        Thread minion1 = new Thread(() => m.Follower('#'));
        Thread minion2 = new Thread(() => m.Follower('$'));

        king.Start();

        minion1.Start();
        minion2.Start();

        Console.ReadKey();
        king.Abort();
        minion1.Abort();
        minion2.Abort();
    }
} 
```

预期的输出将是这样的（# 和 $ 代表两个不同的奴才）：

```
> One!
# Two!
> One!
$ Two!
> One!
$ Two!

... 
```

它们出现的顺序无关紧要，它是随机的。然而，问题是这段代码在编译时会产生这个：

```
> One!
# Two!
$ Two!
> One!
# Two!
> One!
$ Two!
# Two!

... 
```

也就是说，不止一个仆从同时说话。这会引起更多奴才的骚动，国王不应该允许这种干涉。

什么是可能的解决方案？

* * *

对于未来的读者，这是最终的工作代码：

```
using System;
using System.Threading;

class Program { 
    static AutoResetEvent leader = new AutoResetEvent(false);
    static AutoResetEvent follower = new AutoResetEvent(false);

    void Leader() {
        do {
            Console.WriteLine("  One!");
            Thread.Sleep(300);

            follower.Set();     // Leader allows a follower speak
            leader.WaitOne();   // Leader waits for the follower to finish speaking
        } while(true);
    }

    void Follower (char emblem) {
        do {
            follower.WaitOne();     // Follower waits for the leader to allow speaking
            Console.WriteLine("{0} Two!", emblem);
            leader.Set();           // Follower finishes speaking
        } while(true);
    }

    static void Main() {
        Console.WriteLine("Go!\n");

        Program m = new Program();

        Thread king = new Thread(() => m.Leader());

        Thread minion1 = new Thread(() => m.Follower('#'));
        Thread minion2 = new Thread(() => m.Follower('$'));
        Thread minion3 = new Thread(() => m.Follower('&'));

        king.Start();

        minion1.Start();
        minion2.Start();
        minion3.Start();

        Console.ReadKey();
        king.Abort();
        minion1.Abort();
        minion2.Abort();
        minion3.Abort();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:23:58.207

尝试使用 AutoResetEvent 而不是锁/监视器。它允许您创建一个“门”，一次只能通过一个线程。

您的 Follower() 线程将调用`event.WaitOne()`（可选超时）。您的 Leader() 函数将调用`event.Set()`，这将释放其中一个等待线程。

一旦等待线程通过，AutoResetEvent（与其他类型的等待句柄相反）将自动“关闭门”。

[http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:35:55.050

你没有锁定追随者。所以两个线程都看到 leaderGo 是真的，并且响应。在写出之前让线程自己锁定，这应该可以解决它。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace Threading
{
    class Program
    {
    static bool leaderGO = false;
    static bool followerGo = false;

    void Leader()
    {
        do
        {
            lock (this)
            {
                //Console.WriteLine("? {0}", leaderGO);

                if (leaderGO) Monitor.Wait(this);

                Console.WriteLine("> One!");
                Thread.Sleep(200);
                leaderGO = true;
                followerGo = true;

                Monitor.Pulse(this);
            }
        } while (true);
    }

    void Follower(char chant)
    {
        do
        {
            lock (this)
            {
                //Console.WriteLine("! {0}", leaderGO);

                if (!leaderGO) Monitor.Wait(this);

                if(followerGo)
                {
                    followerGo = false;
                    Console.WriteLine("{0} Two!", chant);
                    leaderGO = false;
                }

                Monitor.Pulse(this);
            }
        } while (true);
    }

    static void Main()
    {
        Console.WriteLine("Go!\n");

        Program m = new Program();

        Thread king = new Thread(() => m.Leader());

        Thread minion1 = new Thread(() => m.Follower('#'));
        Thread minion2 = new Thread(() => m.Follower('$'));

        king.Start();

        minion1.Start();
        minion2.Start();

        Console.ReadKey();
        king.Abort();
        minion1.Abort();
        minion2.Abort();
    }
} 
```

}

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T22:40:40.383

你正在经历的是一个竞争条件。你有两个独立的线程在一个未锁定的资源（leaderGo）上运行，它控制着它们对临界区的访问（打印出“Two！”）。

在打印出“两个！”之前，在 leaderGo 上放置一个互斥锁（由 manman 推荐）是一个开始。您还需要在打印之前检查以确保 leaderGo 的值仍然为真，因为两个线程最终都会获得锁，但只有一个线程会在 leaderGo 为真时获得锁。

就像是：

```
lock(leaderGo)
{
     if (leaderGo)
         Console.WriteLine("{0} Two!", chant);
     leaderGo = false;
} 
```

这将确保只有一个追随者能够响应（因为它需要锁定）。它不会保证哪个线程获得锁，特定线程获得锁的频率，或类似的东西。然而，在每一次通过中，每个线程都会获得锁——重要的是谁是第一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T22:50:20.290

一些提示：

*   永远不要使用`lock(this)`. 通过从内部锁定对象，任何使用你的对象作为锁定焦点的东西都会干扰你自己代码的同步能力。
*   永远不要使用`Thread.Abort()`. 这是邪恶的；它通过注入异常来杀死正在运行的线程，这是不可预测的，因此很难或不可能优雅地捕获和处理。相反，尝试传递具有布尔属性 IsCancelled 的类的实例，并将其`!IsCancelled`用作保持循环的条件。

您的代码的实际问题是您的监视器和锁的组合导致锁被获取锁的线程从临界区释放，如果该线程认为其他人必须先行。您有三个线程，每个线程都可以获取，然后释放并等待，然后重新获取锁*并继续进行，就好像它等待的条件现在是 false 一样*。

一种可能的情况：

*   Follower 1 进入 Follower 的临界区（lock() 块）。
*   Follower 2 接近 Follower 的临界区并被告知等待。
*   King接近Leader的关键部分，并被告知等待。
*   Follower 1 看到 leaderGO 为 false 并等待，释放临界区的锁。
*   King，尽管排在第二位，但在 Follower 2 之前“竞速”进入了关键部分。
*   King 继续（leaderGo 为假，因此 King 永远不会 Wait()s），调用“One！” 并在关键部分结束时释放锁之前设置标志。
*   追随者 2 现在在追随者 1 之前“竞速”进入临界区，看到标志已设置，然后继续喊“二！” 并退出临界区。
*   追随者 1 现在开始转弯，重新获得关键部分中间的锁。*它不再关心 leaderGo 是否为 false*；它已经通过了检查。因此，它继续，也调用“Two！”，设置标志（设置为它已经存在的值）并退出。

根据您的设置方式，这些线程可以通过多种可能的方式“竞争”。

这可能会更好一些；它被称为双重检查锁定，虽然它不是万无一失的，但它比你拥有的要好得多：

```
private static readonly object syncObj = new object();

void Leader() {
    do {
        if(leaderGo) 
        {
           Thread.Sleep(200);
           continue;
        }
        lock(syncObj) {
            //the "double-check"; here it's not necessary because there's 
            //only one King to set leaderGo to true, 
            //but it doesn't hurt anything.
            if(leaderGo) continue;

            //we won't get here unless we have control of 
            //the critical section AND must do something.
            Console.WriteLine("> One!");
            Thread.Sleep(200);
            leaderGO = true;
        }
    } while(true);
}

void Follower (char chant) {
    do {
        if(!leaderGo) 
        {
           Thread.Yield();
           continue;
        }
        lock(syncObj) {
            //this double-check is critical;
            //if we were waiting on the other follower to release
            //the lock, they have already shouted out and we must not do so.
            if (!leaderGO) continue;

            //we only get here if we have
            //control of the lock and should shout out
            Console.WriteLine("{0} Two!", chant);
            leaderGO = false;                                
        }
    } while(true);
} 
```

**编辑：**正如评论中提到的，这个模型不依赖运气，但它不是万无一失的，因为.NET，为了性能，可以允许leaderGO的多个副本存在于各个线程的缓存中，并将它们同步到后面场景。如果 .NET 不是 johnny-on-the-spot 与该同步，则由一个线程执行的双重检查可能会看到标志的旧的“陈旧”状态，并在它应该退出时错误地继续前进。

您可以通过以下两种简单方法之一来解决此问题：

*   在任何更新 leaderGO 之后和任何读取 leaderGO 之前放置一个 MemoryBarrier。内存屏障，或者用其他语言称为“内存栅栏”，基本上将每个正在运行的线程阻塞在内存屏障上，直到所有线程都处于内存屏障（或以其他方式阻塞），确保所有指令发生在内存屏障之前内存屏障在运行后的任何指令之前已被执行。
*   将 leaderGO 声明为`volatile`. .NET 无法优化 volatile 变量；它保证在内存中的一个位置，任何运行该代码的线程都可以访问，但是效率很低。因此，任何其他线程都会立即看到对其值的任何更新。

# javascript - 使用 JavaScript 提取 Facebook 页面的源代码

> ID：13483194
> 
> 赞同：1
> 
> 时间：2012-11-20T22:18:26.263
> 
> 标签：javascript, facebook

如果我在 Chrome 的 JavaScript 控制台中编写代码，我可以通过输入以下内容来检索整个 HTML 源代码：

```
 var a = document.body.InnerHTML; alert(a); 
```

对于 Facebook 上的 fb_dtsg，我可以通过以下方式轻松提取它：

```
 var fb_dtsg = document.getElementsByName('fb_dtsg')[0].value; 
```

现在，我正在尝试从 Facebook 页面中提取代码“h=AfJSxEzzdTSrz-pS”。h 值对于 Facebook 报告特别有用。

如何获得报告的 h 值？我不知道 h 值是多少；当你与不同的用户交流时，h 值是完全不同的。没有那个 h 正确的值，你不能报告。实际上，h 值是 AfXXXXXXXXXXX（'Af' 之后的 11 个字符值），这就是我所知道的。

你有什么想法来获得在 Facebook 页面上生成的价值或任何功能。

Facebook 源代码片段如下，您可以在 facebook 个人资料中查看源代码，然后搜索 h=Af，您将获得值：

```
 <code class="hidden_elem" id="ukftg4w44">
<!-- <div class="mtm mlm">
  ...
   ....
  <span class="itemLabel fsm">Unfriend...</span></a></li>
  <li class="uiMenuItem" data-label="Report/Block...">
  <a class="itemAnchor" role="menuitem" tabindex="-1" href="/ajax/report/social.php?content_type=0&amp;cid=1352686914&amp;rid=1352686914&amp;ref=http%3A%2F%2Fwww.facebook.com%2      F%3Fq&amp;h=AfjSxEzzdTSrz-pS&amp;from_gear=timeline" rel="dialog">
  <span class="itemLabel fsm">Report/Block...</span></a></li></ul></div>

  ...
   ....
  </div> -->
  </code> 
```

请指导我。如何准确提取值？

我尝试使用以下代码，但注释块阻止我提取代码。如何提取注释块内的值？

```
 var a = document.getElementsByClassName('hidden_elem')[3].innerHTML;alert(a); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:57:00.410

这是我的第一次尝试，假设你不害怕一点 jQuery：

```
// http://stackoverflow.com/a/5158301/74757
function getParameterByName(name, path) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(path);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
}

var html = $('.hidden_elem')[0].innerHTML.replace('<!--', '').replace('-->', '');
var href = $(html).find('.itemAnchor').attr('href');
var fbId = getParameterByName('h', href); // fbId = AfjSxEzzdTSrz-pS 
```

[**工作演示**](http://jsfiddle.net/rtnNd/)

**编辑**：没有 jQuery 的方法：

```
// http://stackoverflow.com/a/5158301/74757
function getParameterByName(name, path) {
    var match = RegExp('[?&]' + name + '=([^&]*)').exec(path);
    return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
}

var hiddenElHtml = document.getElementsByClassName('hidden_elem')[0]
    .innerHTML.replace('<!--', '').replace('-->', '');

var divObj = document.createElement('div');
divObj.innerHTML = hiddenElHtml;

var itemAnchor = divObj.getElementsByClassName('itemAnchor')[0];
var href = itemAnchor.getAttribute('href');

var fbId = getParameterByName('h', href); 
```

[**工作演示**](http://jsfiddle.net/rtnNd/1/)

我真的很想为“取消注释” HTML 提供一个不同的解决方案，但我对正则表达式很讨厌 :)

# sql-server-2008 - SQL Server 2008 如何为一个表中的每条记录创建多个表？

> ID：13483199
> 
> 赞同：0
> 
> 时间：2012-11-20T22:18:54.800
> 
> 标签：sql-server-2008

我有一个表格，其中包含顾问的名字、姓氏、技能名称和认证，基本上显示了顾问是否获得了技能认证。我正在尝试创建一个脚本，该脚本将为每个顾问生成一个包含两列（技能和认证状态）的表格，一些顾问可能拥有不止一项技能。我正在考虑while循环语法或动态sql，但没有运气。我已经彻底搜索了网络，但没有运气。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:25:18.263

你可能最好以不同的方式解决这个问题。无需为另一个表中的每条记录创建表，只需创建一个以一对多关系链接到第一个表的第二个表。

例如：

```
Consultant
----------
ConsultantID
Name

Skill
-----
SkillID
SkillName
F_ConsultantID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T06:30:33.750

根据实验室问题的参数，对我有用的答案是：

```
USE Software

Declare @TableNameVar varchar(1000)
Declare @ConsultantIDVar int, @ConsultantIDMax int

Set @ConsultantIDVar = (Select MIN(ConsultantID) From Consultant)
Set @ConsultantIDMax = (Select MAX(ConsultantID) From Consultant)

While @ConsultantIDVar <= @ConsultantIDMax
Begin

   Set @TableNameVar = (Select (ConsultantFName + '_' + ConsultantLName)
                                From Consultant
                                Where ConsultantID = @ConsultantIDVar)

   Set @TableNameVar = 'Create Table '+ @TableNameVar + ' (SkillDescription varchar(40), Certification bit)'
   Exec (@TableNameVar)

   Set @ConsultantIDVar = @ConsultantIDVar + 1

End 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:28:43.623

我认为您需要一个联结或映射表，而不是您提出的解决方案。

```
Consultant
    - ID
    - First_Name
    - Etc...

Skill
    - ID
    - Name

Consultant_Skill
    - Consultant_ID
    - Skill_ID 
```

该表将允许您在和`consultant_skill`之间建立多对多关系。`consultant``skill`

# wcf - 如何使用 URL 和参数作为 GET 调用 WCF svc

> ID：13483206
> 
> 赞同：1
> 
> 时间：2012-11-20T22:19:25.493
> 
> 标签：wcf, url, get, svc

我正在处理一个简单的 WCF。我习惯了 .asmx 文件、Web 方法和 SOAP，但现在要切换它。使用脚本管理器和 ServiceReference 在 .aspx 页面中工作，如下所示

```
<asp:ServiceReference Path="~/MyTest.svc" /> 
```

一位同事现在需要它，以便他可以在 iOS 应用程序中调用它（对此不太了解），但他说他需要使用将参数作为 GET 传递的 URL 来调用它。您能告诉我如何更改 .svc 文件以使其成为可能吗？

非常感谢！

# sql - 在不同服务器中的表之间使用内部联接删除

> ID：13483209
> 
> 赞同：2
> 
> 时间：2012-11-20T22:19:57.937
> 
> 标签：sql, sql-server

我正在使用 sp_addlinkedserver 连接 2 台服务器。然后我需要使用内部连接删除。我的 sql 是

```
DELETE [server1].[database1].[dbo].orders 
FROM [server1].[database1].[dbo].orders
INNER JOIN [server2].[database2].[dbo].DeletedKeys
    ON [server1].[database1].[dbo].orders.ID = 
           [server2].[database2].[dbo].DeletedKeys.Id 
```

但它给出了一个错误：

> 无法绑定多部分标识符“[server1].[database1].[dbo].orders.ID”。
> 无法绑定多部分标识符“[server2].[database2].[dbo].DeletedKeys.Id”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:23:01.483

如果您给 4 部分名称起别名怎么办？

```
DELETE o
FROM 
    [server1].[database1].[dbo].orders o
    INNER JOIN [server2].[database2].[dbo].DeletedKeys dk
        ON o.ID = dk.Id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:33:50.900

如果您已成功`connected and logged in`访问两台服务器，则以下查询将完成这项工作。

```
DELETE [server1].[database1].[dbo].orders 
WHERE  ID IN 
     (SELECT dk.Id FROM [server2].[database2].[dbo].DeletedKeys dk) 
```

# iphone - UIButton 在开发过程中停止响应

> ID：13483212
> 
> 赞同：0
> 
> 时间：2012-11-20T22:20:01.577
> 
> 标签：iphone, ios, uibutton, uikit

我在视图中有几个按钮。这些在几天前进行了测试，并且工作正常。今天，由于某种原因，他们停止了工作。按钮是自定义的，带有图像。它们与以下动作相关联：

```
- (IBAction)walkTurnByTurn:(id)sender {
    NSLog(@"Clicked Turn By Turn Walk");
    CLLocationCoordinate2D destination = self.loadOficina.coordinate;
    MKPlacemark *endLocation = [[MKPlacemark alloc] initWithCoordinate:destination addressDictionary:nil];
    MKMapItem *endingItem = [[MKMapItem alloc] initWithPlacemark:endLocation];
    [endingItem setName:self.loadOficina.title];
    NSMutableDictionary *launchOptions = [[NSMutableDictionary alloc] init];
    [launchOptions setObject:MKLaunchOptionsDirectionsModeWalking forKey:MKLaunchOptionsDirectionsModeKey];

    [endingItem openInMapsWithLaunchOptions:launchOptions];
} 
```

我删除了按钮并再次创建它，将其连接到操作。它已启用，用户交互也已启用。看起来它根本不响应触摸，因为单击时它不会改变颜色。任何想法可能发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:30:57.950

它可能超出了它的超级视图的范围。如果超级视图框架是 0,0,100,100，您可以将按钮添加为从 200,200 开始的子视图。它会显示在屏幕上，但不会响应事件。这发生在很多使用 iPhone 5 布局的人身上。他们不小心将窗口硬编码为 320x480。控件显示在 y 位置 > 480，但它们不是交互式的。

# php - 什么更快：in_array 或 isset？

> ID：13483219
> 
> 赞同：105
> 
> 时间：2012-11-20T22:20:34.663
> 
> 标签：php, performance, micro-optimization

这个问题只是针对我的，因为我总是喜欢编写优化的代码，这些代码也可以在廉价的慢速服务器（或流量很大的服务器）上运行

我环顾四周，找不到答案。我想知道这两个示例之间哪个更快，记住在我的情况下数组的键并不重要（自然是伪代码）：

```
<?php
$a = array();
while($new_val = 'get over 100k email addresses already lowercased'){
    if(!in_array($new_val, $a){
        $a[] = $new_val;
        //do other stuff
    }
}
?>

<?php
$a = array();
while($new_val = 'get over 100k email addresses already lowercased'){
    if(!isset($a[$new_val]){
        $a[$new_val] = true;
        //do other stuff
    }
}
?> 
```

由于问题的重点不是数组冲突，我想补充一点，如果您担心 的插入冲突`$a[$new_value]`，您可以使用`$a[md5($new_value)]`. 它仍然可能导致冲突，但在从用户提供的文件（[http://nikic.github.com/2011/12/28/Supercolliding-a-PHP-array.html](http://nikic.github.com/2011/12/28/Supercolliding-a-PHP-array.html)）读取时可以避免可能的 DoS 攻击

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2012-11-20T22:48:14.670

到目前为止的答案是准确的。在这种情况下使用`isset`会更快，因为

*   它对键使用 O(1) 哈希搜索，而`in_array`必须检查每个值，直到找到匹配项。
*   作为一个操作码，它的开销比调用`in_array`内置函数要少。

这些可以通过使用具有值的数组（在下面的测试中为 10,000）来演示，从而强制`in_array`进行更多搜索。

```
isset:    0.009623
in_array: 1.738441 
```

这建立在 Jason 的基准上，通过填充一些随机值并偶尔找到数组中存在的值。都是随机的，所以要注意时间会波动。

```
$a = array();
for ($i = 0; $i < 10000; ++$i) {
    $v = rand(1, 1000000);
    $a[$v] = $v;
}
echo "Size: ", count($a), PHP_EOL;

$start = microtime( true );

for ($i = 0; $i < 10000; ++$i) {
    isset($a[rand(1, 1000000)]);
}

$total_time = microtime( true ) - $start;
echo "Total time: ", number_format($total_time, 6), PHP_EOL;

$start = microtime( true );

for ($i = 0; $i < 10000; ++$i) {
    in_array(rand(1, 1000000), $a);
}

$total_time = microtime( true ) - $start;
echo "Total time: ", number_format($total_time, 6), PHP_EOL; 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-11-20T22:27:34.760

> 哪个更快：`isset()`vs`in_array()`

`isset()`是比较快的。

虽然应该很明显，`isset()`但只测试一个值。而`in_array()`将遍历整个数组，测试每个元素的值。

粗略的基准测试很容易使用[`microtime()`](http://php.net/manual/en/function.microtime.php)。

### 结果：

```
Total time isset():    0.002857
Total time in_array(): 0.017103 
```

**注意：**无论是否存在，结果都是相似的。

### 代码：

```
<?php
$a = array();
$start = microtime( true );

for ($i = 0; $i < 10000; ++$i) {
    isset($a['key']);
}

$total_time = microtime( true ) - $start;
echo "Total time: ", number_format($total_time, 6), PHP_EOL;

$start = microtime( true );

for ($i = 0; $i < 10000; ++$i) {
    in_array('key', $a);
}

$total_time = microtime( true ) - $start;
echo "Total time: ", number_format($total_time, 6), PHP_EOL;

exit; 
```

### 其他资源

我鼓励你也看看：

*   [PHP 基准测试](http://www.phpbench.com)
*   [PHPPerf](http://phpperf.com)
*   [XDebug](http://xdebug.org)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-11-20T23:09:04.820

Using`isset()`利用了更快的查找，因为它使用[哈希表](http://en.wikipedia.org/wiki/Hash_table)，避免了`O(n)`搜索的需要。

首先使用[djb 散列函数](https://stackoverflow.com/questions/10696223/reason-for-5381-number-in-djb-hash-function)对键进行散列，以确定 中类似散列的键的桶`O(1)`。然后迭代地搜索存储桶，直到在 中找到确切的键`O(n)`。

除非有任何[故意的哈希冲突](http://www.securityfocus.com/bid/51193)，这种方法产生的性能比`in_array()`.

请注意，当以`isset()`您展示的方式使用时，将最终值传递给另一个函数需要使用`array_keys()`创建一个新数组。可以通过将数据存储在键和值中来进行内存折衷。

**更新**

查看代码设计决策如何影响运行时性能的好方法，您可以查看脚本的[编译版本](http://pecl.php.net/package/vld)：

*`echo isset($arr[123])`*

```
compiled vars:  !0 = $arr
line     # *  op                           fetch      ext  return  operands
-----------------------------------------------------------------------------
   1     0  >   ZEND_ISSET_ISEMPTY_DIM_OBJ              2000000  ~0      !0, 123
         1      ECHO                                                 ~0
         2    > RETURN                                               null 
```

*`echo in_array(123, $arr)`*

```
compiled vars:  !0 = $arr
line     # *  op                           fetch      ext  return  operands
-----------------------------------------------------------------------------
   1     0  >   SEND_VAL                                             123
         1      SEND_VAR                                             !0
         2      DO_FCALL                                 2  $0      'in_array'
         3      ECHO                                                 $0
         4    > RETURN                                               null 
```

不仅`in_array()`使用相对低效的`O(n)`搜索，还需要作为函数 ( `DO_FCALL`) 调用，而为此`isset()`使用单个操作码 ( `ZEND_ISSET_ISEMPTY_DIM_OBJ`)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-11-20T22:22:45.487

第二个会更快，因为它只查找特定的数组键，并且在找到之前不需要遍历整个数组（如果找不到，将查看每个数组元素）

# android - Android ViewPager、Fragments 和 AsyncTask。如何在方向更改时保留 AsyncTask 的状态？

> ID：13483223
> 
> 赞同：2
> 
> 时间：2012-11-20T22:21:07.050
> 
> 标签：android, android-asynctask, android-fragments, android-viewpager, android-lifecycle

首先; 是的，我到处都在寻找这个问题的答案，但没有人遇到过和我一样的问题。这个问题似乎与此处的另一个问题相同，但绝对不是:)

基本上我想要创建的是一个“First-start”活动，它由 4 个具有不同布局的片段组成。这是我自己做到的。我还有一个 AsyncTask 可以帮助其中一个片段调用远程服务器来检查用户是否存在于数据库中。这也有效。但是，只要我旋转手机并改变方向，就会重新创建 FragmentActivity（显然 =））。如果我在触发 AsyncTask 时这样做，它要么崩溃，要么在某些情况下完成用户检查。

所以我的问题是：**如果方向发生变化，我如何保留 AsyncTask 的状态？** 我已经看到了一些使用回调并将 AsyncTask 作为内部类的基本解决方案。由于我的寻呼机适配器的布局以及相同的 Fragments 类用于创建的所有四个片段的事实，它们在我的情况下不起作用。

任何帮助深表感谢。示例或解决方案更受赞赏！=)

请参阅下面的（丑陋的）代码，使这一切变得生动起来。

**FirstRunActivity.java**

```
import android.content.Intent;
import android.os.Bundle;
import android.support.v4.view.ViewPager;

import com.actionbarsherlock.app.SherlockFragmentActivity;
import com.actionbarsherlock.view.Menu;
import com.actionbarsherlock.view.MenuInflater;
import com.actionbarsherlock.view.MenuItem;
import com.iqqn.***.R;
import com.viewpagerindicator.IconPageIndicator;
import com.viewpagerindicator.PageIndicator;

public class FirstRunActivity extends SherlockFragmentActivity {

private FragmentAdapter mAdapter;
private ViewPager mPager;
private PageIndicator mIndicator;
private boolean userExit = false;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.first_run);

    mAdapter = new FragmentAdapter(getSupportFragmentManager());

    mPager = (ViewPager)findViewById(R.id.pager);
    mPager.setAdapter(mAdapter);

    mIndicator = (IconPageIndicator)findViewById(R.id.indicator);
    mIndicator.setViewPager(mPager);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.first_run, menu);
    return super.onCreateOptionsMenu(menu);
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
    case R.id.menu_exit:
        userExit = true;
        this.finish();
        return true;
    }
    return super.onOptionsItemSelected(item);
}

@Override
public void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
};

@Override
public void finish() {
    // Prepare data intent 
    Intent data = new Intent();
    if(userExit) {
        data.putExtra("exit", true);
        setResult(RESULT_CANCELED, data);
    } else {
        data.putExtra("signedIn", true);
        data.putExtra("registered", true);
        data.putExtra("acceptedEULA", true);
        // Activity finished ok, return the data
        setResult(RESULT_OK, data);
    }
    super.finish();
} 
} 
```

**片段适配器.java**

```
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.FragmentPagerAdapter;

import com.iqqn.***.R;
import com.viewpagerindicator.IconPagerAdapter;

class FragmentAdapter extends FragmentPagerAdapter implements IconPagerAdapter {
    protected static final int[] CONTENT = new int[] { R.layout.***_welcome_1, R.layout.***_welcome_2, R.layout.***_welcome_3, R.layout.***_welcome_4};
    protected static final String[] CONTENTTITLE = new String[] { "Welcome","Account","Intro","Let's start!" };
protected static final int[] ICONS = new int[] {
    R.drawable.perm_group_calendar,
    R.drawable.perm_group_camera,
    R.drawable.perm_group_device_alarms,
    R.drawable.perm_group_location
};

private int mCount = CONTENT.length;

public FragmentAdapter(FragmentManager fm) {
    super(fm);
}

@Override
public Fragment getItem(int position) {
    return Fragments.newInstance(CONTENT[position % CONTENT.length],position);
}

@Override
public int getCount() {
    return mCount;
}

@Override
public CharSequence getPageTitle(int position) {
    return FragmentAdapter.CONTENTTITLE[position % CONTENT.length];
}

@Override
public int getIconResId(int index) {
    return ICONS[index % ICONS.length];
}

public void setCount(int count) {
    if (count > 0 && count <= 10) {
        mCount = count;
        notifyDataSetChanged();
    }
}
} 
```

**片段.java**

```
public final class Fragments extends SherlockFragment {
    private static final String KEY_CONTENT = "Fragments:Content";
private int position = -1;
private RegisterAsyncTaskHelper registerTask = null;

public static Fragments newInstance(int content, int position) {
    Fragments fragment = new Fragments();
    fragment.mContent = content;
    fragment.position = position;
    return fragment;
}

private int mContent = -1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setRetainInstance(true);

    if ((savedInstanceState != null) && savedInstanceState.containsKey(KEY_CONTENT)) {
        mContent = savedInstanceState.getInt(KEY_CONTENT);
    }
}

@Override
public void onPause() {

    super.onPause();
}

@Override
public void onResume() {

    super.onResume();
}

@Override
public void onDestroy() {
     if (registerTask != null) {
         registerTask.cancel(false);
     }
    super.onDestroy();
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

    final View view = inflater.inflate(mContent, container, false);

    switch(position) {
    case 0:
        break;
    case 1:
        final Button btnRegister;
        final Button btnLinkToLogin;

        btnRegister = (Button) view.findViewById(R.id.btnRegister);
        btnLinkToLogin = (Button) view.findViewById(R.id.btnLinkToLoginScreen);
        // Register Button Click event
        btnRegister.setOnClickListener(new View.OnClickListener() {         
            public void onClick(View localview) {
                // Execute register task
                registerTask = new RegisterAsyncTaskHelper(getActivity(), view);
                if(registerTask != null)
                    registerTask.execute();
            }
        });

        // Link to Login Screen
        btnLinkToLogin.setOnClickListener(new View.OnClickListener() {

            public void onClick(View view) {
                // TODO Login
            }
        });
        break;
    case 2:
        break;
    case 3:
        break;
    default:
        break;
    }

    return view;
}

@Override
public void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putInt(KEY_CONTENT, mContent);
}

} 
```

**RegisterAsyncTaskHelper.java**

```
import org.json.JSONException;
import org.json.JSONObject;

import android.os.AsyncTask;
import android.support.v4.app.FragmentActivity;
import android.view.View;
import android.widget.EditText;
import android.widget.ProgressBar;
import android.widget.TextView;

import com.iqqn.***.R;
import com.iqqn.***.utils.DatabaseHandler;
import com.iqqn.***.utils.UserFunctions;

public class RegisterAsyncTaskHelper extends AsyncTask<Void, Integer, Void> {

// JSON Response node names
private static final String KEY_SUCCESS = "success";
private static final String KEY_ERROR = "error";
private static final String KEY_ERROR_MSG = "error_msg";
private static final String KEY_UID = "uid";
private static final String KEY_NAME = "name";
private static final String KEY_EMAIL = "email";
private static final String KEY_CREATED_AT = "created_at";

private View view = null;
private FragmentActivity activity = null;
private ProgressBar mProgress;

public RegisterAsyncTaskHelper(FragmentActivity activity, View view) {
    this.view = view;
    this.activity = activity;
    this.mProgress = (ProgressBar) view.findViewById(R.id.registerProgress);
}

@Override
protected void onPreExecute() {
    mProgress.setVisibility(View.VISIBLE);
}

@Override
protected Void doInBackground(Void... params) {

    final EditText inputFullName;
    final EditText inputEmail;
    final EditText inputPassword;
    final TextView registerErrorMsg;

    // Importing all assets like buttons, text fields
    inputFullName = (EditText) view.findViewById(R.id.registerName);
    inputEmail = (EditText) view.findViewById(R.id.registerEmail);
    inputPassword = (EditText) view.findViewById(R.id.registerPassword);
    registerErrorMsg = (TextView) view.findViewById(R.id.register_error);

    String name = inputFullName.getText().toString();
    String email = inputEmail.getText().toString();
    String password = inputPassword.getText().toString();
    UserFunctions userFunction = new UserFunctions();
    JSONObject json = userFunction.registerUser(name, email, password);

    // check for login response
    try {
        if (json.getString(KEY_SUCCESS) != null) {
            activity.runOnUiThread(new Runnable() {
                @Override
                public void run() {
                    registerErrorMsg.setText("");
                }
            });

            String res = json.getString(KEY_SUCCESS); 
            if(Integer.parseInt(res) == 1){
                // user successfully registred
                // Store user details in SQLite Database
                DatabaseHandler db = new DatabaseHandler(activity.getApplicationContext());
                JSONObject json_user = json.getJSONObject("user");

                // Clear all previous data in database
                userFunction.logoutUser(activity.getApplicationContext());
                db.addUser(json_user.getString(KEY_NAME), json_user.getString(KEY_EMAIL), json.getString(KEY_UID), json_user.getString(KEY_CREATED_AT));                        

                /*
                // Launch Dashboard Screen
                Intent dashboard = new Intent(ctx, DashboardActivity.class);
                // Close all views before launching Dashboard
                dashboard.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(dashboard);
                // Close Registration Screen
                finish();
                 */

            }else{
                // Error in registration
                activity.runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        registerErrorMsg.setText("Error occured in registration");
                    }
                });
            }
        }
    } catch (JSONException e) {
        e.printStackTrace();
    }
    return null;
}

@Override
protected void onProgressUpdate(final Integer... values) {

}

@Override
protected void onPostExecute(final Void result) {
    mProgress.setVisibility(View.GONE);
}
} 
```

只是为了澄清。到目前为止，这段代码不应该看起来很好。但它会在我得到这个工作之后。

// 亚历山大

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:41:08.260

> 如果方向发生变化，如何保留 AsyncTask 的状态？

由保留`AsyncTask`的片段（即调用`setRetainInstance(true)`自身的动态片段）管理。该片段将在配置更改后继续存在。

> 由于我的寻呼机适配器的布局以及相同的 Fragments 类用于创建的所有四个片段的事实，它们在我的情况下不起作用。

然后为`AsyncTask`. 它不必参与 UI：

```
if (getSupportFragmentManager().findFragmentByTag(MODEL)==null) {
  model=new ModelFragment();
  getSupportFragmentManager().beginTransaction().add(model, MODEL)
                             .commit();
} 
```

在这里，`ModelFragment`负责（以及活动所需的数据模型`Fragment`的`AsyncTask`任何部分，而不是保存在其他任何地方的内存中）。`MODEL`我们仅在其标签 ( )下不存在该片段时才创建该片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:28:46.160

使用[AsyncTaskLoader](http://developer.android.com/reference/android/content/AsyncTaskLoader.html)保存任务的状态和结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:44:54.867

在目标片段中使用意图服务和[LocalBroadcastManager](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:32:10.933

我在这种情况下所做的是使用[`BroadcastReceiver`](http://developer.android.com/reference/android/content/BroadcastReceiver.html). `AsyncTask`我建议不要将 your与 your紧密耦合`FragmentActivity`，而是建议使用 a`Thread`来运行您的后台操作和调用`context.sendBroadcast(...)`，然后在您的`FragmentActivity`.

# fonts - 即使正确加载字体，Google 字体加载程序也会报告字体加载失败

> ID：13483226
> 
> 赞同：3
> 
> 时间：2012-11-20T22:21:30.200
> 
> 标签：fonts, webfonts, google-font-api, webfont-loader

我有这个奇怪的问题。我正在使用谷歌字体加载器加载字体。

```
 var data = {
        active: call_resize,
        fontactive: bum,
        fontinactive: bam,
        custom : {
            families : [ 'League Gothic', 'FontAwesome' ],
            urls : [
                    'http://localhost/wordpress/wp-content/themes-ai1ec/vortex/less/bootstrap/font-awesome.css',
                    'http://localhost/wordpress/wp-content/themes-ai1ec/vortex/less/bootstrap/font-league-gothic.css'
                    ]
        }
    };
    require(
        [ 'http://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js' ],
        function(  ) {
            WebFont.load(data);
        } ); 
```

基本上这两种字体都已正确加载，但字体加载器会报告第二种字体未正确加载，而从图像中可以看出这是不正确的。

![字体](../Images/3c053cb96ef9b2a4ac41942e8603fde6.png)

这真的很乏味，因为我需要在加载所有字体时执行一个操作，现在 Firefox 和 chrome 在调用“活动”处理程序之前正在等待失败。

# jsf - jsf搞砸了链接

> ID：13483228
> 
> 赞同：0
> 
> 时间：2012-11-20T22:21:39.530
> 
> 标签：jsf, browser, controller, primefaces, hyperlink

我是 JSF 的新手。我的应用程序正在运行，但在使用控制器时我对浏览器中的链接感到困惑。顺便说一句，我的应用程序中还有 PrimeFaces，所以不要对`p:`标签感到惊讶。假设我有“列表”和“显示”页面，控制器在它们之间进行重定向。首先我在`http://localhost:8080/y/r/conversation/list.xhtml`页面上。有用 line 创建的链接`<p:commandLink action="#{lazyConversationBean.doShow(conv)}" ajax="false" value="View"/>`。lazyConversationBean 在这里充当我的控制器。有方法：

```
public String doShow(Conversation c) {
    this.setSelectedConversation(c);
    return "view";
} 
```

`http://localhost:8080/y/r/conversation/list.xhtml`即使它是正确的`http://localhost:8080/y/r/conversation/view.xhtml`页面，我也再次被重定向到...... （浏览器显示它）。我有链接`<p:commandButton action="#{lazyConversationBean.doList()}" ajax="false" value="Back to list"/>`，控制器又有方法：

```
public String doList() {
    return "list";
} 
```

我从中被重定向到......是的，你猜对了...... `http://localhost:8080/y/r/conversation/view.xhtml`（这又是浏览器显示的内容）即使它再次是正确的`http://localhost:8080/y/r/conversation/list.xhtml`页面。

它接缝为浏览器链接区域总是比当前显示的页面落后一步。我什至不知道这是否是一些不正确的行为，因为我不知道如何查询谷歌：D 只是为了测试我做了[这个](http://netbeans.org/kb/docs/web/jsf20-crud.html)简短的教程，netbeans 在我的一个实体上创建了整个代码堆栈，行为是同样，所以它与 PrimeFaces 魔法无关。

你能告诉我它为什么会发生，以及如何解决它吗？用户喜欢复制正确的链接；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:26:45.383

这不是问题，框架就是这样完成的。有不同的方法可以解决这个问题。例如，您可以像这样添加创建您的操作：

```
public String doShow(Conversation c)
{
    this.setSelectedConversation(c);
    return "view" + "?faces-redirect=true";
}

<p:commandLink action="#{lazyConversationBean.doShow(conv)}" ajax="false" value="View"/> 
```

它将强制重定向到操作视图，因此浏览器中的 URL 将更改。

编辑：这是 faces-config.xml 导航的解决方案（注意`<redirect />`）：

```
<navigation-rule>
    <navigation-case>
        <from-outcome>outcome1</from-outcome>
        <to-view-id>/outcome1.xhtml</to-view-id>
        <redirect />
    </navigation-case>
    <navigation-case>
        <from-outcome>outcome2</from-outcome>
        <to-view-id>/outcome2.xhtml</to-view-id>
        <redirect />
    </navigation-case>
</navigation-rule> 
```

# objective-c - 如何在 iOS 上使用 Facebook SDK 3.1 获取用户的电子邮件？

> ID：13483234
> 
> 赞同：14
> 
> 时间：2012-11-20T22:22:27.647
> 
> 标签：objective-c, ios, facebook

我正在使用电子邮件权限打开 facebook 会话，如下所示：

```
- (void)facebookOpenSession {
    NSArray *permissions = @[@"email"];
    [FBSession openActiveSessionWithReadPermissions:permissions
                                       allowLoginUI:YES
                                  completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {
        [self sessionStateChanged:session state:state error:error];
    }];
} 
```

然后会话状态的重要片段更改如下所示：

```
- (void)sessionStateChanged:(FBSession *)session
                      state:(FBSessionState) state
                      error:(NSError *)error {
    switch (state) {
        case FBSessionStateOpen: {
            [[FBRequest requestForMe] startWithCompletionHandler:^(FBRequestConnection *connection, NSDictionary<FBGraphUser> *user, NSError *error) {
             if (error) {
                //error
             } else {
                 self.myFirstNameLabel.text = user.first_name;
                 self.myLastNameLabel.text = user.last_name;
                 // self.myEmailLabel.text = @"";
             }
         }];
    }
    ... 
```

我如何实际提取用户的电子邮件？它是在提供的变量之一中，还是我必须在完成处理程序中进行另一个调用？

提前致谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-21T00:23:37.053

FBGraphUser 没有该属性（我假设是因为它是可选的/仅在您要求电子邮件权限时才可用）但您仍然应该能够从字典中访问它，如下所示：

```
[user objectForKey:@"email"] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-28T16:28:12.873

您应该在询问正确的权限之前检查

```
loginView.readPermissions = @[@"public_profile", @"email"]; 
```

# ios - 图层旋转：CGAffineTranslate、CGAffineRotate 和 AVMutableVideoCompositionLayerInstruction

> ID：13483238
> 
> 赞同：1
> 
> 时间：2012-11-20T22:22:52.857
> 
> 标签：ios, macos, cgaffinetransform, rotatetransform, avmutablecomposition

几天来我一直在尝试解决这个问题，显然我无法进行仿射变换。

基本上，我想将电影**多次**旋转90 度。这里有一个很好的例子：

[使用 AVMutableVideoCompositionLayerInstruction 旋转视频](https://stackoverflow.com/questions/5187789/rotating-video-w-avmutablevideocompositionlayerinstruction)

但这仅适用于第一次旋转，而我想将它从纵向旋转到横向，回到纵向，再回到横向。

无论我尝试什么，我都会得到绝对奇怪的结果。不幸的是，即使经过大量阅读，我对仿射变换的理解显然也没有提高。

所以我基本上要求一个算法的布局，它将

1.  将 AVMutableVideoComposition 的图层旋转 90 度，无论其当前方向如何。
2.  应用平移以将图层移动到中心。

每次单击按钮时都应该调用它。

但是无论我尝试什么，图层都正确旋转，但是平移正在将图层移出中心。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-01-29T08:14:28.207

> 但是无论我尝试什么，图层都正确旋转，但是平移正在将图层移出中心。这样做的正确方法是什么？

正确的方法是使用 2 个变换：一个旋转，一个平移。在处理开始时，确保设置您的当前位置 - 通过在处理开始时分配当前变换。然后，创建两个独立的变换 - 一个用于旋转，另一个用于平移。您可以“合并”这两个转换以创建一个新的转换来执行这两种操作 - 但如果您希望转换能够“就地”运行，请务必在应用新转换之前重新设置原始转换。

# windows-phone-7.1 - 更新地图 windows phone mango

> ID：13483242
> 
> 赞同：1
> 
> 时间：2012-11-20T22:22:57.437
> 
> 标签：windows-phone-7.1, bing-maps

我在使用 windows phone mango 的 bing 地图中的路由有问题。当用户每次点击搜索时，我需要更新地图以消除旧路径。我使用了以下指南： http: [//msdn.microsoft.com/en-us/library/ee681887.aspx](http://msdn.microsoft.com/en-us/library/ee681887.aspx)并且它可以工作，但是当我在地图上再次搜索时仍然是旧路径。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T09:02:29.967

我解决了这个问题。我在 xaml 地图中插入了一个属性 MapPolyline“percorso”，这是代码 c#

```
 // If the route calculate was a success and contains a route, then draw the route on the map.
        if ((e.Result.ResponseSummary.StatusCode == BingMapRouteService.ResponseStatusCode.Success) & (e.Result.Result.Legs.Count != 0))
        {
            this.percorso.Locations = new LocationCollection();
            // Retrieve the route points that define the shape of the route.
            foreach (Location p in e.Result.Result.RoutePath.Points)
            {                   
                Location location = new Location();
                location.Latitude = p.Latitude;
                location.Longitude = p.Longitude;
                this.percorso.Locations.Add(location);
            } 
```

# forms - 通过单击带有 javascript 或 jquery 的锚点来填写表格

> ID：13483243
> 
> 赞同：1
> 
> 时间：2012-11-20T22:22:59.987
> 
> 标签：forms, input, fill

我需要的是一个脚本，通过单击带有链接文本的同一站点上的链接来填写表单输入。昨天我找到了解决方案，但这只是我例外的一半。脚本必须填充第一个空输入字段。我已经在图片上说明了它：

![在此处输入图像描述](../Images/f71e7ea269f66da06b44dfcbb5b0a850.png)

同时点击的链接必须消失。在这种情况下，结果将是：

![http://img688.imageshack.us/img688/8010/slika2c.jpg](../Images/6325a2f0203968dc64b599d494af7362.png)

我不知道如何在 jquery 的 javascript 天气中做到这一点。请帮忙！

# mongodb - 更新 MongoDB 记录是重写整个记录还是只重写更新的字段？

> ID：13483251
> 
> 赞同：3
> 
> 时间：2012-11-20T22:23:48.837
> 
> 标签：mongodb

我有一个 MongoDB 集合，如下所示：

```
comment_id (number)
comment_title (text)
score (number)
time_score (number)
final_score (number) 
created_time (timestamp) 
```

分数是和整数，当有人对该记录投赞成票或反对票时，通常使用 $inc 1 或 -1 进行更新。但是 time_score 使用相对于时间戳和当前时间的函数以及其他因素进行更新，例如多少（整天过去）和多少（整周过去）.....等

所以我直接在 db 上执行 $inc 和 $dec，但是对于 time_score，我从 db 中检索数据计算新分数并将其写回。我担心的是，如果许多用户在我计算 time_score 期间增加了“score”字段，那么当我将 time_score 写入 db 时，它会破坏最后一个 score 值。

更清楚地说，更新 Mongo 记录中的特定字段会重写整个记录还是只重写更新的字段？（假设所有这些字段都被索引）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:27:40.497

默认情况下，整个文档都被重写。要指定更改的字段而不修改其他任何内容，请使用[$set](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)运算符。

**编辑：**对此答案的评论是正确的 - 任何[更新修饰符](http://www.mongodb.org/display/DOCS/Updating#Updating-ModifierOperations)都会导致仅重写相关字段而不是整个文档。“默认”是指不使用特殊修饰符的情况（提供了原始文档）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:59:39.830

您描述的算法绝对不是线程安全的。

当您阅读整个文档，更改一个字段然后写回整个文档时，您正在创建一个竞争条件 - 文档中在您读取之后但在您写入之前修改的任何字段都将被您的更新覆盖。

这是使用 $set 或 $inc 运算符以原子方式设置单个字段而不是根据其中可能的陈旧值更新整个文档的众多原因之一。

另一个原因是“就地”设置/更新单个字段比编写整个文档更有效。此外，当您传递较小的更新文档（{$set:{field:value}}，而不是文档的整个新版本）时，您的网络负载会更小。

# java - 谷歌地方查询限制

> ID：13483255
> 
> 赞同：0
> 
> 时间：2012-11-20T22:24:07.107
> 
> 标签：java, android

我使用 Google Map API 开发了一个 android 应用程序。当我使用本地提供商的家庭互联网时，该应用程序正在运行。

但是，当我将 Internet 更改为 AT&T 时，出现以下错误：

> 地点错误 - 已达到对 Google 地点的查询限制。

我不明白为什么会这样。2个互联网连接有区别吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:42:23.733

我认为你超过了谷歌地图 API 的使用。如果您超出了谷歌地图 API 的使用量，响应状态代码将为**OVER_QUERY_LIMIT**我假设您的操作与此相同

```
protected void onPostExecute(String file_url) {
            // dismiss the dialog after getting all products
            pDialog.dismiss();
            // updating UI from Background Thread
            runOnUiThread(new Runnable() {
                public void run() {
                    /**
                     * Updating parsed Places into LISTVIEW
                     * */
                    // Get json response status
                    String status = nearPlaces.status;

                    // Check for all possible status
                    if(status.equals("OK")){
                        // Successfully got places details
                        if (nearPlaces.results != null) {
                            // loop through each place
                            for (Place p : nearPlaces.results) {
                                HashMap<String, String> map = new HashMap<String, String>();

                                // Place reference won't display in listview - it will be hidden
                                // Place reference is used to get "place full details"
                                map.put(KEY_REFERENCE, p.reference);

                                // Place name
                                map.put(KEY_NAME, p.name);

                                // adding HashMap to ArrayList
                                placesListItems.add(map);
                            }
                            // list adapter
                            ListAdapter adapter = new SimpleAdapter(MainActivity.this, placesListItems,
                                    R.layout.list_item,
                                    new String[] { KEY_REFERENCE, KEY_NAME}, new int[] {
                                            R.id.reference, R.id.name });

                            // Adding data into listview
                            lv.setAdapter(adapter);
                        }
                    }
                    else if(status.equals("ZERO_RESULTS")){
                        // Zero results found
                        alert.showAlertDialog(MainActivity.this, "Near Places",
                                "Sorry no places found. Try to change the types of places",
                                false);
                    }
                    else if(status.equals("UNKNOWN_ERROR"))
                    {
                        alert.showAlertDialog(MainActivity.this, "Places Error",
                                "Sorry unknown error occured.",
                                false);
                    }
                    else if(status.equals("OVER_QUERY_LIMIT"))
                    {
                        alert.showAlertDialog(MainActivity.this, "Places Error",
                                "Sorry query limit to google places is reached",
                                false);
                    }
                    else if(status.equals("REQUEST_DENIED"))
                    {
                        alert.showAlertDialog(MainActivity.this, "Places Error",
                                "Sorry error occured. Request is denied",
                                false);
                    }
                    else if(status.equals("INVALID_REQUEST"))
                    {
                        alert.showAlertDialog(MainActivity.this, "Places Error",
                                "Sorry error occured. Invalid Request",
                                false);
                    }
                    else
                    {
                        alert.showAlertDialog(MainActivity.this, "Places Error",
                                "Sorry error occured.",
                                false);
                    }
                }
            });

        } 
```

正如您在此示例代码中看到的那样，[Android Hive](http://www.androidhive.info/2012/08/android-working-with-google-places-and-maps-tutorial/)将从 Google Places API 获得响应并在此之后进行检查，如果状态为**OVER_QUERY_LIMIT**，则错误将显示为“Places Error sorry query limit to google places is reached”。你可以在这个部分看到它

```
else if(status.equals("OVER_QUERY_LIMIT"))
                    {
                        alert.showAlertDialog(MainActivity.this, "Places Error",
                                "Sorry query limit to google places is reached",
                                false);
                    } 
```

您可以通过以下方式超出 Google Maps API Web 服务使用限制：

> 每天发送太多请求。发送请求太快，即每秒请求太多。发送请求太快太久或以其他方式滥用 Web 服务。超出其他使用限制，例如 Elevation API 中每个请求的点数。

上述问题可以通过结合两种方法来解决：

> 通过优化应用程序以更有效地使用 Web 服务来降低使用率。在可能的情况下，通过为您的 Maps API for Business 许可证购买额外的配额来增加使用限制。

有关更多信息，您可以在此处查看-> [Google Places API](https://developers.google.com/maps/documentation/business/articles/usage_limits)

如果您有任何问题，请随时在评论中提问：）

# rapidminer - RapidMiner 不工作

> ID：13483256
> 
> 赞同：1
> 
> 时间：2012-11-20T19:31:44.877
> 
> 标签：rapidminer

我在 RM 论坛上问过这个问题，但没有人回答。我创建了 SVM 预测模型，它曾经一直工作，直到有一天它突然给出错误“无法提供参数“kernel_type”设置为“多项式”的 AttributeWeights。”任何人都知道我点击了什么错误，因为我无法使用 RM 构建任何模型了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-21T20:25:01.837

SVM 通常只能使用二进制标签。多项式会向我表明您没有二进制标签。

# php - 将 html 包裹在 sql 表中的值周围以使表值成为链接

> ID：13483263
> 
> 赞同：0
> 
> 时间：2012-11-20T22:24:39.163
> 
> 标签：php, mysql, sql, phpmyadmin

我正在尝试将 html 包装为围绕 sql 表中的值的超链接。

查看图片

[一只忙碌的猫 http://carmanmanitoba.ca/mysqlquestion.png](http://carmanmanitoba.ca/mysqlquestion.png)

因此，对于每个“网站”的 meta_key，我想将 meta_value 的内容用一个字符串包裹起来，使其成为链接 IE

'www.heritagerealty.ca' 会变成`'<a href="http://www.heritagerealty.ca" target="_blank">www.heritagerealty.ca</a>'`

我要输入什么查询？我对 PHP 和以这种方式编辑数据库非常陌生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:29:55.290

插入时无需输入任何查询。只需在显示结果时将其链接，例如

```
<?php
while($res = mysql_fetch_array($result_set)) {
?>
<a href="<?php echo $res['meta_value']?>"><?php echo $res['meta_key']?></a>
<?php

}
?> 
```

# c# - WP7 - 将类绑定到网格

> ID：13483266
> 
> 赞同：0
> 
> 时间：2012-11-20T22:25:03.827
> 
> 标签：c#, windows-phone-7, xaml, data-binding

我有这样的网格：

```
<Grid x:Name="LayoutRoot" Background="Transparent" DataContext="{Binding}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <TextBlock x:Name="CurrentPoints" Grid.Row="1" Grid.Column="0" 
            Text="{Binding CurrentPoints}" Width="100" Height="100" Foreground="Red">
    </TextBlock>
    <TextBlock x:Name="PointsLeft" Grid.Row="1" Grid.Column="1" 
        Text="{Binding AllPoints}" Width="100" Height="100" Foreground="Red" />
    <TextBlock x:Name="AllPoints" Grid.Row="1" Grid.Column="2" 
        Text="{Binding EndPoints}" Grid.ColumnSpan="1"/>
     </Grid> 
```

页面代码如下：

```
Counter pocitadlo = new Counter(200);

        public MainPage()
        {
            InitializeComponent();
            Loaded += MainPage_Loaded;

        }

        void MainPage_Loaded(object sender, RoutedEventArgs e)
        {
            LayoutRoot.DataContext = pocitadlo;
        } 
```

这是我的反课：

```
class Counter : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    private int _currentPoints;
    public int CurrentPoints
    {
        get
        {
            return _currentPoints;
        }
        set
        {
            this._currentPoints = value;
            onPropertyChanged(this, "CurrentPoints");
        }
    }
    private int _allPoints;
    public int AllPoints
    {
        get
        {
            return _allPoints;
        }
        set
        {
            this._allPoints = value;
            onPropertyChanged(this, "AllPoints");
        }
    }
    private int _endPoints;
    public int EndPoints
    {
        get
        {
            return _endPoints;
        }
        set
        {
            this._endPoints = value;
            onPropertyChanged(this, "EndPoints");
        }
    }

    public Counter(int endPoints)
    {
        this._allPoints = 0;
        this._currentPoints = 0;
        this._endPoints = endPoints;
    }

    private void onPropertyChanged(object sender, string property)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(sender, new PropertyChangedEventArgs(property));

        }
    }
} 
```

为什么绑定不起作用？我错过了什么？谢谢

# c - 指针：引用第一个元素是否有助于定位整个数组？

> ID：13483267
> 
> 赞同：1
> 
> 时间：2012-11-20T22:25:04.153
> 
> 标签：c, pointers

我正在将 C 代码翻译成另一种语言。我对指针感到困惑。说我有这个代码。函数 foo 调用函数 bob，它们都是指针。

```
double
*foo(double *x, double *init, double *a){
   double *y = (double*)malloc(5*sizeof(double));
   double *z = (double*)malloc(5*sizeof(double));
   double *sum, *update;

   sum = (double*)bob(y, z)    //<---Q1: why y and z don't need stars in front of them? 
                               //I thought they are pointers?

   for (i<0; i<5; i++){
       z[i]=y[i]               //Q2: howcome it's ok to assign y to z? 
   }                           //aren't they pointer?(i.e.hold memory address)
}

double
*bob(*arg1, *arg2){
   something...
} 
```

所以，
1）为什么 y 和 z 前面不需要星星，y 和 z 不只是地址吗？
2）为什么 sum 没有星号，我认为 sum 被声明为指针。
3) 为什么可以将 y 分配给 z？

我已经学会了这些，但是它们已经很长时间了，有人能给我提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:36:00.937

基本指针概念：

```
double a = 42.0;   // a is a double
double b;          // b is a double
double *x;         // x is a pointer to double

x = &a;  // x is the pointer, we store the address of a in pointer x
b = *x;  // *x is the pointee (a double), we store the value pointed by x in b

// now b value is 42.0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:39:45.897

关于 2) 以及为什么 z[i] = y[i] 是可以接受的，我认为最好将您指向[此](http://www.lysator.liu.se/c/c-faq/c-2.html)页面，该页面详细描述了数组和指针，尤其是 2.1 到 2.8。该特定表达式中发生的事情（不一定按顺序）是从位置 y 开始，获取指针，将 i 添加到指针，然后获取指向该位置的值。从 z 开始，获取指针，将 i 添加到指针，并将值 (y[i]) 分配给该位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:52:55.087

```
double
*foo(double *x, double *init, double *a){
// x is a pointer to a double, init is a pointer to a double, a is a pointer to a double
// foo is a function returning a pointer to a double
//   and taking three pointers to doubles as arguments

   double *y = (double*)malloc(5*sizeof(double));
   // y is a pointer to a double. It is assigned a pointer returned by malloc.
   //   That pointer returned by malloc points to memory space for 5 doubles.

   double *z = (double*)malloc(5*sizeof(double));
   // z is a pointer to a double. It is assigned a pointer returned by malloc.
   //   That pointer returned by malloc points to memory space for 5 doubles.

   double *sum, *update;
   // sum and update are pointers to doubles    

   sum = (double*)bob(y, z)    //<---Q1: why y and z don't need stars in front of them? 
                               //I thought they are pointers?
   // sum (whose type is pointer to double) 
   //   is assigned a pointer to double returned by bob

   for (i<0; i<5; i++){
       y[i] = z[i]       //and are z and y pointers?!?!
       // y[i] === *(y+i)
       // (y + i) points to the i-th element in the space previously allocated by malloc
       // *(y + i) dereferences that pointer
       // equivalently, y[i] accesses the i-th element from an array
   }
   if(sum<0)
   z=y //Q2: howcome it's ok to assign y to z? 
       //aren't they pointer?(i.e.hold memory address)
   // after the assignment, z contains the same address as y (points to the same memory)
}

double
*bob(*arg1, *arg2){
   something...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T22:28:15.467

1.  值 y 和 z 不需要星号，因为添加星号会取消引用它们，并且您希望传递指针而不是值。
2.  同样，您需要指针而不是值。虽然从代码看来你确实想要这个值，所以那里可能应该有一颗星。
3.  您可以将一个指针分配给另一个指针，这意味着更改指针指向的地址。所以当`y=z`，`y`现在点哪里`z`点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T22:28:22.763

1.  它们不需要星号，因为您不会取消引用它们，而是作为指针传递。
2.  您可以比较指针，但这可能不是您想要的。
3.  分配指针是可以的，但请注意，它与复制值不同。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-20T22:28:37.933

对 Q1 的回答：您正在传递`y`并传递`z`给另一个以指针作为参数的函数，为什么要传递指针的值？

Ans2：它们是指针，您正在将一个分配给另一个

# jquery - JSON 图像查看器无法在实时 Firefox 上运行，可以在本地运行，也可以在其他浏览器等上运行。

> ID：13483273
> 
> 赞同：1
> 
> 时间：2012-11-20T22:25:38.467
> 
> 标签：jquery, json, image, firefox, getjson

我试图找出为什么 JSON 不能在整个论坛和互联网上的 Firefox 中工作。它适用于平板电脑，即 safari。它可以在我的 Firefox 桌面上运行，但在它上线后就不行了。我尝试了一些东西（注释掉），例如没有解决方案的 mimeType。我曾尝试使用 $.ajax，但运气不佳。Firefox 没有 javascript 错误。我正在使用 jQuery 1.7。

Console.log 正在打印数据。div introCon 是空的（仅在 Firefox 上）。

```
$(document).ready(function() {
  jQuery.support.cors = true;
  //$.ajaxSetup({ mimeType: "application/json" });
  /*$.ajaxSetup({ scriptCharset: "utf-8" , contentType: "application/json;   charset=utf-8"}); */

  // loading pictures
  $.getJSON("intro.json?format=json", function(data){
    var links = '';
    var imageload = '';
    var title = '';

    console.log(data);
    $.each(data, function(key, item) {
      links += ' <a href=' + item.image + '>' + key + '</a>';
      imageload += '<img src="' + item.image + ' " />';
      title += item.alt;
    });

    $('.introCon').html(imageload);
    $('.introCon img').hide();
    $('.introCon img:last').fadeIn(500);
    $('.introCon img').fadeIn(1000);

    rotatePics(2);
  });
});

function rotatePics(currentPhoto) {
  var numberOfPhotos = $('.introCon img').length;
  currentPhoto = currentPhoto % numberOfPhotos;
  $('.introCon img').eq(currentPhoto).fadeOut( function() {
    // re-order the z-index
    $('.introCon img').each(function(i) {
      $(this).css(
        'zIndex', ((numberOfPhotos - i) + currentPhoto) % numberOfPhotos
      );
    });
    $(this).show();
    setTimeout(function() {rotatePics(++currentPhoto);}, 3000);
  });
} 
```

这是来自单独文件的简单 JSON。

```
{
  "1" : {
    "image" : "portfolio/chrpic.png",
    "alt"   : "Blah.",
    "detail": "Quartz"},
  "2" : {
    "image" : "portfolio/mysspic.png",
    "alt"   : "Landing page.",
    "detail": "Container"},
  "3" : {
    "image" : "portfolio/decode-pic3.png",
    "alt"   : "Decode this.",
    "detail": "Landing page 2"},
  "4" : {
    "image" : "portfolio/simple-think-pic.png",
    "alt"   : "Simple Think",
    "detail": "simpilify your life"}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:03:27.463

好的，我一直在解决这个问题，我想我有一个解决方案（我已经剥离了[JS Fiddle](http://jsfiddle.net/A34Ne/5/)中的 JSON 部分，但我认为你可以看到它是如何重新适应的）。到目前为止，这是我想出的：

```
var data = {
    "1": {
        "image": "http://placekitten.com/200/300",
        "alt": "Blah.",
        "detail": "Quartz"
    },

    "2": {
        "image": "http://placekitten.com/g/210/300",
        "alt": "Landing page.",
        "detail": "Container"
    },

    "3": {
        "image": "http://placekitten.com/200/320",
        "alt": "Decode this.",
        "detail": "Landing page 2"
    },

    "4": {
        "image": "http://placekitten.com/g/210/320",
        "alt": "Simple Think",
        "detail": "simpilify your life"
    }
};
var images = [];

$.each(data, function(key, item) {
    images.push('<img src="' + item.image + '" alt="' + item.alt + '"/>')
});

$('.introCon').html(images.join(''));
$('.introCon img').hide();
$('.introCon img:last').fadeIn(500);

rotatePics(2);

function rotatePics(currentPhoto) {
    var numberOfPhotos = $('.introCon img').length;
    currentPhoto = currentPhoto % numberOfPhotos;
    $('.introCon img').eq(currentPhoto).fadeOut(function() {
        // re-order the z-index
        $('.introCon img').each(function(i) {
            $(this).css('zIndex', ((numberOfPhotos - i) + currentPhoto) % numberOfPhotos);
        });
        $(this).show();
        setTimeout(function() {
            rotatePics(++currentPhoto);
        }, 3000);
    });
} 
```

查看代码实际上有点难以弄清楚您正在经历什么。getJSON 看起来不错（cors 部分是不必要的，除非您的服务位于不同的域中，但是`console.log(data);`排除了您在获取数据时遇到问题的可能性。 $.each() 调用是正确的（我错了在询问它是否可以是一个数组），但是在构建图像列表时有一些奇怪的代码。我已经使用`Array.push()`字符串连接的方法将它简化为单个变量（更快但老实说在这个规模上可能不是瓶颈。然后有一个额外的东西`$('.introCon img').fadeIn(1000);`导致所有图像淡入淡出。我认为必须有一些 CSS 将所有这些图像放在彼此之上，我将其实现为`img { position: absolute; }`. 如果图像的大小都相同（或通过 CSS 调整大小），那么这应该可行，在我的情况下，因为我使用的是出色的[{placekitten}](http://placekitten.com/)服务，我必须为图像提供不同的大小才能获得不同的图片。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T07:38:46.290

尝试这样的事情

```
 $.each(data, function(key, obj){   
       $.each(obj, function(k, item){  
           links += ' <a href=' + item.image + '>' + key + '</a>';
          imageload += '<img src="' + item.image + ' " />';
           title += item.alt;
        });
  }); 
```

# matlab - Peekdata 只返回一个通道

> ID：13483277
> 
> 赞同：4
> 
> 时间：2012-11-20T22:26:04.923
> 
> 标签：matlab

我有一个 matlab 立体声音频输入 ala：

```
aud=analoginput('winsound',0);
addchannel(aud,1:2) 
```

当我完成运行并要求

```
aud_data=getdata(aud); 
```

我得到一个数组，显示来自两个通道的所有数据。我已验证此数据实际上是我想要的有效立体声信号。

但是，如果我运行

```
aud_peek=peekdata(aud,some_number_of_samples); 
```

在收集数据时，我似乎只获得了一个频道的数据，尽管 MathWorks[说我应该获得两个](http://www.mathworks.com/help/daq/ref/peekdata.html).

关于为什么会发生这种情况的任何想法？

我正在使用 Matlab 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T14:37:26.290

你试过
`aud_peek=peekdata(aud,some_number_of_samples,'native');`
还是
`aud_peek=peekdata(aud,some_number_of_samples,'double');`

# javascript - JQUERY/JSON 数据未定义，然后神秘定义

> ID：13483278
> 
> 赞同：1
> 
> 时间：2012-11-20T22:26:04.903
> 
> 标签：javascript, jquery, json

我有一个读取一些 JSON 数据的脚本：

```
var tempJson;
$.post("scripts/getJSON.php", function(data) {
     tempJson = data;
}, 'json');
alert("");  //First alert
alert("That: " + tempJson);  //Second alert 
```

当我包含第一个警报行时，第二个警报按预期给了我一个 [Object object]。当我省略第一个警报行时，我在第二个警报中收到 undefined。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:28:43.100

因为它是异步的，当您关闭警报时，ajax 已经完成并且数据返回并分配给变量。

你应该

```
var tempJson;
$.post("scripts/getJSON.php", function(data) {
     tempJson = data;
     alert(tempJson); // or whatever you want to do with the data should go here..
}, 'json'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:28:10.177

这在我看来是一个时间问题。您正在触发一个请求，而不是检查回调中的值，而是在发布脚本之后立即检查。AJAX 是异步的……又名**异步 JavaScript 和 XML**

```
var tempJson;
$.post("scripts/getJSON.php", function(data) {
     tempJson = data;

     // Callback here, response has most definitely happened
     alert(tempJson);
}, 'json');

// Response may not have happened yet when this is executed
alert("");  //First alert
// Still might not have happened when this is executed
alert("That: " + tempJson);  //Second alert 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:29:48.123

jQuery AJAX 默认是异步的。因此，如果您的请求延迟一点，您的警报将不会有请求数据。正确的是您在回调中调用警报。

目前您可以将 AJAX 请求更改为同步，但它现在已被 jQuery 弃用，它会挂起您的浏览器。所以最好的方法是你使用[jqXHR](http://api.jquery.com/jQuery.ajax/#jqXHR)的成功/完成/错误回调/事件。

# java - org.xml.sax.SAXParseException;序言中不允许引用。自动生成的 XHTML、java

> ID：13483281
> 
> 赞同：2
> 
> 时间：2012-11-20T22:26:20.133
> 
> 标签：java, xhtml, xml-parsing, saxparser, libreoffice

我只是想尝试使用[Flying Saucer](http://today.java.net/pub/a/today/2007/06/26/generating-pdfs-with-flying-saucer-and-itext.html)从 xhtml 代码生成 PDF。所以我所做的是在 LibreOffice 中进行布局，让它生成 xhtml 代码并（想要）将其交给解析库（在 java 中）以生成 pdf。但是，我无法以 1:1 接管所有 xml 代码，因为我需要转义一些东西。所以我用“<”转义了所有“<”，用“>”转义了所有“>”和所有双引号带有“\”“。

当试图解析整个事情时，我得到以下错误：

```
[Fatal Error] :1:2: Reference is not allowed in prolog. 
```

我试图通过一些逻辑思考和谷歌搜索来追踪它。如果我理解正确，以下是我的“序言”：

```
 buf.append("&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;");
    buf.append("&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN\" \"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd\"&gt;");
    buf.append("&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;&lt;!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--&gt;&lt;head profile=\"http://dublincore.org/documents/dcmi-terms/\"&gt;&lt;meta http-equiv=\"Content-Type\" content=\"application/xhtml+xml; charset=utf-8\"/&gt;&lt;title xml:lang=\"en-US\"&gt;- no title specified&lt;/title&gt;&lt;meta name=\"DCTERMS.title\" content=\"\" xml:lang=\"en-US\"/&gt;&lt;meta name=\"DCTERMS.language\" content=\"en-US\" scheme=\"DCTERMS.RFC4646\"/&gt;&lt;meta name=\"DCTERMS.source\" content=\"http://xml.openoffice.org/odf2xhtml\"/&gt;&lt;meta name=\"DCTERMS.issued\" content=\"2012-11-20T20:59:05.11\" scheme=\"DCTERMS.W3CDTF\"/&gt;&lt;meta name=\"DCTERMS.provenance\" content=\"\" xml:lang=\"en-US\"/&gt;&lt;meta name=\"DCTERMS.subject\" content=\",\" xml:lang=\"en-US\"/&gt;&lt;link rel=\"schema.DC\" href=\"http://purl.org/dc/elements/1.1/\" hreflang=\"en\"/&gt;&lt;link rel=\"schema.DCTERMS\" href=\"http://purl.org/dc/terms/\" hreflang=\"en\"/&gt;&lt;link rel=\"schema.DCTYPE\" href=\"http://purl.org/dc/dcmitype/\" hreflang=\"en\"/&gt;&lt;link rel=\"schema.DCAM\" href=\"http://purl.org/dc/dcam/\" hreflang=\"en\"/&gt;&lt;style type=\"text/css\"&gt;"); 
```

对巨大（和丑陋）的事情感到抱歉，但好吧..我做的下一件事是每行注释掉一行，看看哪里有问题。

如果我注释掉前两行，错误仍然出现，在第三行之后我得到一个不同的错误（“内容不允许在序言中”或类似）

但是，这是第三行..我找不到错误，感谢您的帮助:)

```
 buf.append("&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;&lt;!--This file was converted to xhtml by OpenOffice.org - see http://xml.openoffice.org/odf2xhtml for more info.--&gt;&lt;head profile=\"http://dublincore.org/documents/dcmi-terms/\"&gt;&lt;meta http-equiv=\"Content-Type\" content=\"application/xhtml+xml; charset=utf-8\"/&gt;&lt;title xml:lang=\"en-US\"&gt;- no title specified&lt;/title&gt;&lt;meta name=\"DCTERMS.title\" content=\"\" xml:lang=\"en-US\"/&gt;&lt;meta name=\"DCTERMS.language\" content=\"en-US\" scheme=\"DCTERMS.RFC4646\"/&gt;&lt;meta name=\"DCTERMS.source\" content=\"http://xml.openoffice.org/odf2xhtml\"/&gt;&lt;meta name=\"DCTERMS.issued\" content=\"2012-11-20T20:59:05.11\" scheme=\"DCTERMS.W3CDTF\"/&gt;&lt;meta name=\"DCTERMS.provenance\" content=\"\" xml:lang=\"en-US\"/&gt;&lt;meta name=\"DCTERMS.subject\" content=\",\" xml:lang=\"en-US\"/&gt;&lt;link rel=\"schema.DC\" href=\"http://purl.org/dc/elements/1.1/\" hreflang=\"en\"/&gt;&lt;link rel=\"schema.DCTERMS\" href=\"http://purl.org/dc/terms/\" hreflang=\"en\"/&gt;&lt;link rel=\"schema.DCTYPE\" href=\"http://purl.org/dc/dcmitype/\" hreflang=\"en\"/&gt;&lt;link rel=\"schema.DCAM\" href=\"http://purl.org/dc/dcam/\" hreflang=\"en\"/&gt;&lt;style type=\"text/css\"&gt;"); 
```

提前致谢！

[编辑1： http](http://validator.w3.org/check) ://validator.w3.org/check验证它是完全正确的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:25:14.357

您似乎对[这篇博客文章](http://today.java.net/pub/a/today/2007/06/26/generating-pdfs-with-flying-saucer-and-itext.html)的糟糕布局感到困惑。如果您下载[示例代码](http://today.java.net/today/2007/06/26/FlyingSaucerPDFSampleCode.zip)，您会看到 '<' 和 '>' 字符*没有*转换为“<” 和“>” 在作者的实际代码和数据中。

为了将引号放入硬编码的 Java 字符串中，您当然必须对它们进行转义。但是你不应该需要任何这种 xml 转义。

# typescript - 什么是关于 TypeScript 的 str 文件？

> ID：13483282
> 
> 赞同：0
> 
> 时间：2012-11-20T22:26:22.857
> 
> 标签：typescript

在 TypeScript 编译器的源代码中，isSTRFile 函数有多种用途，但不知道 .str 文件是什么。Anders 在他的 TypeScript 视频介绍中提到了“搅拌文件”，而不是 .ts 文件。有谁知道他们是什么，或者曾经是什么？我最好的猜测是 .str 代表“结构文件”并且是 .d.ts 文件的前身——在这种情况下 .str 文件已经过时了。任何人都可以发光吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:17:02.530

当产品处于开发阶段时，它有一个不同的代号，以及一个与该代号一起使用的扩展名。选择实际产品名称后，扩展名也会相应更新。

所以它只是代码中的历史残余。它没有语义意义。

# java - 使用什么 wtpversion 值？

> ID：13483284
> 
> 赞同：2
> 
> 时间：2012-11-20T22:26:34.433
> 
> 标签：java, eclipse, maven, maven-3, eclipse-wtp

在一篇文章中，我看到了将 Maven 项目转换为动态 Web Eclipse 项目的说明：

```
mvn eclipse:eclipse -Dwtpversion=1.5 
```

**那么， wtpversion**及其值**1.5**是什么意思？我应该在 Eclipse Indigo 和 jdk 1.7.0 中使用什么 wtpversion 值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-23T16:58:10.297

WTP 将 Web 应用程序支持添加到 Eclipse。您应该使用 WTP 2.0 版

```
mvn eclipse:eclipse -Dwtpversion=2.0 
```

# php - 如何逐字节发送/接收数据

> ID：13483287
> 
> 赞同：1
> 
> 时间：2012-11-20T22:26:44.393
> 
> 标签：php, python, client-server

我正在从客户端上的 python 脚本触发我的网络服务器上的 php 脚本。我正在处理我提供给客户端脚本的二进制数据，以便解析如下：

```
$file = "gw/gateway.py"
if (file_exists($file)) {
    $gw_file_sz = filesize($file);
    $filesz1 = $gw_file_sz/256;
    $filesz2 = $gw_file_sz%256;
}
    $binarydata = pack("C*", 0x01, $year1, $year2, $day1, $day2, $min1, $min2, $sec, 0x00, 0x3f, 0x02, 0x00, 0x1c, 0x2c , 0x4c, 0xdf, 0xcb,
                                                                                             0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe8, 0x41,
                                                 0x04, 0x00, 0x1c, 0x2c , 0x5c, 0xe4, 0x38,
                                                 0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe3, 0x7b,
                                                 0x02, 0x00, 0x1c, 0x2c , 0x4c, 0xdf, 0xbf,
                                                 0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe7, 0xd7,
                                                 0x02, 0x00, 0x1c, 0x2c , 0x4c, 0xdf, 0x64,
                                                 0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe7, 0x7a,
                                                 0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe8, 0x22,
                                               0x08, $filesz1, $filesz2);

echo $binarydata; 
```

现在这可以很好地处理这些数据，但是我如何在这个流的末尾附加我的文件 $file 以供我的客户接收？在 Python 方面，我从*fh = StringIO(data)*读取所有数据，在其中我得到像*MyByte = ord(fh.read(1))这样的字节*

[编辑] 我只是试图在最后（回声之前）附加数据，如：

```
 $fh = fopen($file);
    for ($i=0;$i<filesize($file); $i++) {
        $binarydata.=pack("C*",fread($fh,1));
    }
    fclose($fh); 
```

但它似乎不起作用，为什么不......？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:42:17.513

由于您正在输出数据流，因此我看不出有任何理由不能直接回显整个文件内容。我还将 $filesz1 修改为我认为您可能想要的。

```
$file = "gw/gateway.py"
if (file_exists($file)) {
    $gw_file_sz = filesize($file);
    $filesz1 = floor($gw_file_sz/256);
    $filesz2 = $gw_file_sz%256;
}
$binarydata = pack("C*", 0x01, $year1, $year2, $day1, $day2, $min1, $min2, $sec, 
    0x00, 0x3f, 0x02, 0x00, 0x1c, 0x2c , 0x4c, 0xdf, 0xcb,
    0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe8, 0x41,
    0x04, 0x00, 0x1c, 0x2c , 0x5c, 0xe4, 0x38,
    0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe3, 0x7b,
    0x02, 0x00, 0x1c, 0x2c , 0x4c, 0xdf, 0xbf,
    0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe7, 0xd7,
    0x02, 0x00, 0x1c, 0x2c , 0x4c, 0xdf, 0x64,
    0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe7, 0x7a,
    0x02, 0x00, 0x1c, 0x2c , 0x5c, 0xe8, 0x22,
    0x08, $filesz1, $filesz2);

echo $binarydata;
echo file_get_contents($file); 
```

# java - 合并两个凸包

> ID：13483289
> 
> 赞同：3
> 
> 时间：2012-11-20T22:26:55.643
> 
> 标签：java, algorithm, convex-hull

我目前正在编写 Convex Hull 算法的分而治之版本，它非常接近工作，但在合并两个凸包（以形成整体凸包）时遇到了麻烦。

我正在合并：

*   计算每个输入外壳 A 和 B 的上外壳和下外壳
*   通过确保右转找到组合的上层船体
*   通过确保左转找到组合的下部船体
*   计算 2 个组合船体的并集

我不是 100% 确定这是否是正确的方法 - 任何用于查找组合上/下船体的指导或伪代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:29:32.693

看一下这个; 它将为您提供非常聪明的凸包操作方法

[https://web.archive.org/web/20120617005317/http://moais.imag.fr/membres/denis.trystram/SupportsDeCours/convexHull.pdf](https://web.archive.org/web/20120617005317/http://moais.imag.fr/membres/denis.trystram/SupportsDeCours/convexHull.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:31:29.107

虽然这是使用 XNA 库，但您绝对可以将其移植到 Java：

```
public static class PolygonUnion
{
        public static bool PolyUnion(Vector2[] polya, Vector2[] polyb, out Vector2[] union, out Vector2[] intersection)
        {
            if (!Intersects(polya, polyb))
            {
                union = polya;
                intersection = polyb;
                return false;
            }

            LList a = new LList(polya), b = new LList(polyb);
            List<Intersection> intersections = new List<Intersection>();

            Vector2 vert;
            VNode aNode = a.First, bNode = b.First;
            //Find intersection points between the polygons
            do
            {
                do
                {
                    if (EdgeIntersects(aNode.Value, (aNode.Next == null) ? a.First.Value : aNode.Next.Value, bNode.Value,
(bNode.Next == null) ? b.First.Value : bNode.Next.Value, out vert))
                    {
                        //An intersection point has been found!
                        intersections.Add(new Intersection(vert, aNode, bNode, (aNode.Next == null) ? a.First : aNode.Next,
(bNode.Next == null) ? b.First : bNode.Next));
                    }
                    bNode = bNode.Next;
                }
                while (bNode != null);
                bNode = b.First;
                aNode = aNode.Next;
            }
            while (aNode != null);
            //Perform surgery on these intersections
            Intersection i;
            for (int j = 0; j < intersections.Count; j++)
            {
                i = intersections[j];
                i.aIn.Next = new VNode(i.Position, i.bOut, i.aIn);
                i.bOut.Prev = i.aIn.Next;

                i.bIn.Next = new VNode(i.Position, i.aOut, i.bIn);
                i.aOut.Prev = i.bIn.Next;
            }
            //Decompose and simplify polygons into arrays
            union = a.ToArray();
            intersection = b.ToArray();

            //Find exterior polygon
            if (union.Length < intersection.Length)
            {
                //Polygons need swapping!
                Vector2[] u = union;
                union = intersection;
                intersection = u;
            }
            return true;
        }

        private class Intersection
        {
            public Intersection(Vector2 position, VNode aIn, VNode bIn, VNode aOut, VNode bOut)
            {
                this.aIn = aIn;
                this.bIn = bIn;
                this.aOut = aOut;
                this.bOut = bOut;
                this.Position = position;
            }

            public VNode aIn, bIn, aOut, bOut;
            public Vector2 Position;
        }

        private class LList
        {
            public LList(Vector2[] poly)
            {
                First = new VNode(poly[0], null, null);

                current = First;
                for (int i = 1; i < poly.Length; i++)
                {
                    Add(current, poly[i]);
                    current = current.Next;
                }
                current = First;
            }

            private void Add(VNode prev, Vector2 pos)
            {
                prev.Next = new VNode(pos, null, prev);
            }

            public VNode First;
            private VNode current;

            public Vector2[] ToArray()
            {
                List<Vector2> ret = new List<Vector2>();
                current = First;
                int timeout = 1000;
                bool starting = true;

                while (current != null)
                {
                    if (current.Prev != null && current.Value == current.Prev.Value)
                    {
                        current = current.Next;
                        if (current.Value == current.Next.Value && current.Value == current.Prev.Value) break;
                        continue;
                    }
                    if (!starting && current.Value == First.Value) break;
                    starting = false;

                    ret.Add(current.Value);
                    current = current.Next;

                    timeout--;
                    if (timeout <= 0) break;
                }
                return Simplify(ret.ToArray());
            }
        }

        private class VNode
        {
            public VNode(Vector2 value, VNode next, VNode prev)
            {
                Value = value;
                Next = next;
                Prev = prev;
            }

            public VNode Next;
            public VNode Prev;
            public Vector2 Value;

            public override string ToString()
            {
                return Value.ToString();
            }
        }

        private static Vector2[] Simplify(Vector2[] poly)
        {
            const float tolerance = 25f;//5 pixels tolerance. (5^2 to save sqrt)
            if (poly.Length == 0) return poly;

            List<Vector2> ret = new List<Vector2>(1);
            ret.Add(poly[0]);
            float dist;

            for (int i = 1; i < poly.Length; i++)
            {
                dist = (poly[ret.Count - 1] - poly[i]).LengthSquared();
                if (dist < tolerance) continue;
                if (ret.Contains(poly[i])) continue;

                ret.Add(poly[i]);
            }
            return ret.ToArray();
        }

        /// <summary>
        /// Checks if the line segments intersect.
        /// </summary>
        private static bool EdgeIntersects(Vector2 x, Vector2 y, Vector2 a, Vector2 b, out Vector2 i)
        {
            i = Vector2.Zero;
            float dx, dy, da, db, t, s;

            dx = y.X - x.X;
            dy = y.Y - x.Y;
            da = b.X - a.X;
            db = b.Y - a.Y;
            if ((da * dy - db * dx) == 0) return false;

            s = (dx * (a.Y - x.Y) + dy * (x.X - a.X)) / (da * dy - db * dx);
            t = (da * (x.Y - a.Y) + db * (a.X - x.X)) / (db * dx - da * dy);
            i = new Vector2(x.X + t * dx, x.Y + t * dy);
            return (bool)(s >= 0 && s <= 1 && t >= 0 && t <= 1);
        }

        #region Intersection Test
        /// <summary>
        /// Checks if two polygons intersect.
        /// </summary>
        public static bool Intersects(Vector2[] aPoints, Vector2[] bPoints)
        {
            Vector2 edge, axis;
            float minA, maxA, minB, maxB, overlap;
            //Loop through all edges until a seperating axis is found
            for (int x = 0; x < aPoints.Length + bPoints.Length; x++)
            {
                //Calculate the current edge
                if (x < aPoints.Length) edge = aPoints[(x == aPoints.Length - 1 ? 0 : x + 1)] - aPoints[x];
                else
                {
                    x -= aPoints.Length;
                    edge = bPoints[(x == bPoints.Length - 1 ? 0 : x + 1)] - bPoints[x];
                    x += aPoints.Length;
                }
                //Find the axis perpendicular to current edge
                axis = new Vector2(-edge.Y, edge.X);
                axis.Normalize();
                //Project the two shapes onto this axis
                //Project this
                ProjectPoly(aPoints, axis, out maxA, out minA);
                ProjectPoly(bPoints, axis, out maxB, out minB);
                //Find the overlap between them
                if (minA < minB) overlap = minB - maxA;
                else overlap = minA - maxB;
                //If the overlap is negative then they are overlapping and the smallest
                //overlap must be found to find the minumum translation.
                //If it is bigger than 0 then they won't overlap at all.
                if (overlap < 0) return true;
            }
            return false;
        }
        /// <summary>
        /// Projects a polygon onto the axis, giving the maximum and minimum positions.
        /// </summary>
        /// <param name="points">Points that are in world space with origin at the centre</param>
        private static void ProjectPoly(Vector2[] points, Vector2 axis, out float max, out float min)
        {
            //Projecting a point onto an axis uses a dot product.
            float dotProduct = Vector2.Dot(axis, points[0]);
            min = dotProduct;
            max = dotProduct;
            //Now project the rest of the polygon...
            for (int i = 1; i < points.Length; i++)
            {
                dotProduct = Vector2.Dot(axis, points[i]);
                if (dotProduct < min) min = dotProduct;
                else if (dotProduct > max) max = dotProduct;
            }
        }
        #endregion
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-26T04:32:18.697

我不确定你所说的低和高是什么意思，最好指定它是 2D 还是 3D。

对于 2D 凸包。我制作了一个算法，根据我的测试，它是最快的（至少是 Chan 的两倍）并且两者都在 O(n log h) 中。

但我的不同之处在于，它支持“在线”喂食。我的意思是您可以一次动态地添加一个点（尚不支持删除）。每一点都保持在 O (log h) 内，这实际上是您可以获得的最快速度。我认为，它也是唯一一个在线并处于该性能范围内的产品。

关于凸包的文章是：[快速和改进的 2D 凸包算法及其在 O(n log h) 中的实现](https://www.codeproject.com/Articles/1210225/Fast-and-improved-D-Convex-Hull-algorithm-and-its)。但是“在线”部分尚未记录。我今天才完成（2018-01-25）。但是所有代码都可以在[GitHub 上](https://github.com/EricOuellet2/ConvexHull)访问。

为简单起见，您只能使用在线部分将任何内容与此代码动态合并（您可以添加凸包点或任何点）：

```
OuelletConvexHullAvl2Online.ConvexHullOnline convexHullOnline = new OuelletConvexHullAvl2Online.ConvexHullOnline();
                    foreach (Point pt in points)
                    {
                        convexHullOnline.DynamicallyAddAnotherPointToConvexHullIfAppropriate(pt);
                    }

                    return convexHullOnline.GetResultsAsArrayOfPoint(); 
```

# perl - PERL 计算不可打印字符

> ID：13483290
> 
> 赞同：4
> 
> 时间：2012-11-20T22:26:56.193
> 
> 标签：perl, ascii, non-ascii-characters, non-printable

我有 100,000 个文件要分析。具体来说，我想从任意大小的文件样本中计算可打印字符的百分比。其中一些文件来自大型机、Windows、Unix 等，因此很可能包含二进制和控制字符。

我从使用 Linux 的“文件”命令开始，但它没有为我的目的提供足够的细节。以下代码传达了我想要做的事情，但并不总是有效。

```
 #!/usr/bin/perl -n

    use strict;
    use warnings;

    my $cnt_n_print = 0;
    my $cnt_print = 0;
    my $cnt_total = 0;
    my $prc_print = 0;

    #Count the number of non-printable characters
    while ($_ =~ m/[^[:print:]]/g) {$cnt_n_print++};

    #Count the number of printable characters
    while ($_ =~ m/[[:print:]]/g) {$cnt_print++};

    $cnt_total = $cnt_n_print + $cnt_print;
    $prc_print = $cnt_print/$cnt_total;

    #Print the # total number of bytes read followed by the % printable
    print "$cnt_total|$prc_print\n" 
```

这是一个有效的测试调用：

```
 echo "test_string of characters" | /home/user/scripts/prl/s16_count_chars.pl 
```

这就是我打算调用它的方式，并且适用于一个文件：

```
 find /fct/inbound/trans/ -name "TRNST.20121115231358.xf2" -type f -print0 | xargs -0 head -c 2000 | /home/user/scripts/prl/s16_count_chars.pl 
```

这不能正常工作：

```
 find /fct/inbound/trans/ -type f -print0 | xargs -0 head -c 2000 | /home/user/scripts/prl/s16_count_chars.pl 
```

这也不是：

```
 find /fct/inbound/trans/ -type f -print0 | xargs -0 head -c 2000 | perl -0 /home/user/scripts/prl/s16_count_chars.pl 
```

它不是为查找返回的每一行执行一次脚本，而是为所有结果执行一次。

提前致谢。

* * *

迄今为止的研究：

管道和 XARGS 以及分隔符

[http://help.lockergnome.com/linux/help-understand-pipe-xargs--ftopict549399.html](http://help.lockergnome.com/linux/help-understand-pipe-xargs--ftopict549399.html)

[http://en.wikipedia.org/wiki/Xargs#The_separator_problem](http://en.wikipedia.org/wiki/Xargs#The_separator_problem)

* * *

***澄清：***
1.) 所需输出：如果目录中有 932 个文件，则输出将是 932 行文件名列表、从文件读取的总字节数和可打印字符的百分比。
2.) 许多文件是二进制文件。脚本需要处理嵌入的二进制`eol`或`eof`序列。
3.）许多文件很大，所以我只想读取第一个/最后一个 xx 字节。我一直试图分别使用`head -c 256`或`tail -c 128`读取前 256 个字节或后 128 个字节。解决方案可以在管道中工作，也可以在 perl 脚本中限制字节。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:33:21.863

该`-n`选项将您的整个代码包装在一个`while(defined($_=<ARGV>) { ... }`块中。这意味着您`my $cnt_print`和其他变量声明对于每一行输入都会重复，本质上是重置所有变量值。

解决方法是使用全局变量（`our`如果要继续使用，请使用 声明它们`use strict`），而不是将它们初始化为`0`，因为它们将为每一行输入重新初始化。你可以说类似

```
our $cnt_print //= 0; 
```

如果你不想`$cnt_print`和它的朋友在第一行输入中未定义。

看到[这个最近的问题](https://stackoverflow.com/q/13130119/168657)有一个类似的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:51:58.203

你可以`find`一次给你一个参数。

```
find /fct/inbound/trans/ -type f -exec perl script.pl {} \; 
```

但我会继续一次传递多个文件，`xargs`要么`find`通过`-exec +`.

```
find /fct/inbound/trans/ -type f -exec perl script.pl {} + 
```

以下代码片段支持两者。

您可以一次继续阅读一行：

```
#!/usr/bin/perl

use strict;
use warnings;

my $cnt_total   = 0;
my $cnt_n_print = 0;

while (<>) {
    $cnt_total += length;
    ++$cnt_n_print while /[^[:print:]]/g;
} continue {
    if (eof) {
        my $cnt_print = $cnt_total - $cnt_n_print;
        my $prc_print = $cnt_print/$cnt_total;

        print "$ARGV: $cnt_total|$prc_print\n";

        $cnt_total   = 0;
        $cnt_n_print = 0;
    }
} 
```

或者您可以一次读取整个文件：

```
#!/usr/bin/perl

use strict;
use warnings;

local $/;
while (<>) {
    my $cnt_n_print = 0;
    ++$cnt_n_print while /[^[:print:]]/g;

    my $cnt_total = length;
    my $cnt_print = $cnt_total - $cnt_n_print;
    my $prc_print = $cnt_print/$cnt_total;

    print "$ARGV: $cnt_total|$prc_print\n";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T19:15:03.487

这是我根据提供的反馈的 **工作解决方案。**

我将不胜感激有关形式或更有效方法的任何进一步反馈：

```
 #!/usr/bin/perl

    use strict;
    use warnings;

    # This program receives a file path and name.
    # The program attempts to read the first 2000 bytes.
    # The output is a list of files, the number of bytes
    # actually read and the percent of tbe bytes that are
    # ASCII "printable" aka [\x20-\x7E].

    my ($data, $n_bytes, $file_name, $cnt_n_print, $cnt_print, $prc_print);

    # loop through each file
    foreach(@ARGV) {
       $file_name = shift or die "Pass the file name on the command line.\n";

       # open the file read only with "<" in "<$file_name"
       open(FILE, "<$file_name") or die "Can't open $file_name: $!";

       # open each file in binary mode to handle non-printable characters
       binmode FILE;

       # try to read 2000 bytes from FILE, save the results in $data and the
       # actual number of bytes read in $n_bytes
       $n_bytes = read FILE, $data, 2000;

       $cnt_n_print = 0;
       $cnt_print = 0;

       # count the number of non-printable characters
       ++$cnt_n_print while ($data =~ m/[^[:print:]]/g);

       $cnt_print = $n_bytes - $cnt_n_print;
       $prc_print = $cnt_print/$n_bytes;

       print "$file_name|$n_bytes|$prc_print\n";
       close(FILE);
    } 
```

以下是如何调用上述脚本的示例：

```
 find /some/path/to/files/ -type f -exec perl this_script.pl {} + 
```

* * *

以下是我发现有用的参考文献列表：

[POSIX括号表达式](http://www.regular-expressions.info/posixbrackets.html)
[以binmode打开文件读取](http://oreilly.com/catalog/cookbook/chapter/ch08.html)
[功能](http://perldoc.perl.org/functions/read.html)
[打开文件只读](http://www.tizag.com/perlT/perlfileopen.php)

# regex - 带括号的组在 Scala 中有效吗？

> ID：13483292
> 
> 赞同：4
> 
> 时间：2012-11-20T22:27:23.797
> 
> 标签：regex, scala

正则表达式中的括号似乎在 match/case 语句中不起作用。例如下面的代码

```
val pat1 = """ab""".r
val pat2 = """(a)(b)""".r
val pat3 = """((a)(b))""".r
val pat4 = """((a)b)""".r
val pat5 = """(ab)""".r
"ab" match {
  case pat1(x) => println("1 " + x)
  case pat2(x) => println("2 " + x)
  case pat3(x) => println("3 " + x)
  case pat4(x) => println("4 " + x)
  case pat5(x) => println("5 " + x)
  case _ => println("None of the above")
} 
```

打印“5 ab”，但我希望任何模式都能匹配。我想使用“（...）？” 可选元素，但我不能。与此相关，我无法让 (?​​m) 工作。我的模式在匹配/案例表达式之外工作正常。有人可以向我解释一下 Scala 如何处理匹配/大小写表达式中的正则表达式吗？

我正在尝试在 Scala 中编写标记器

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T22:47:20.030

`Regex`定义`unapplySeq`，而不是`unapply`，这意味着您将每个组都放在自己的变量中。此外，虽然小写匹配器在某些情况下可能会起作用（即使用参数），但您确实应该使用大写。因此，将起作用的是：

```
val Pat1 = """ab""".r
val Pat2 = """(a)(b)""".r
val Pat3 = """((a)(b))""".r
val Pat4 = """((a)b)""".r
val Pat5 = """(ab)""".r
def no() { println("No match") }
"ab" match { case Pat1() => println("Pat1"); case _ => no }
"ab" match { case Pat2(x,y) => println("Pat2 "+x+" "+y); case _ => no }
"ab" match { case Pat3(x,y,z) => println("Pat3 "+x+" "+y+" "+z); case _ => no }
"ab" match { case Pat4(x,y) => println("Pat4 "+x+" "+y); case _ => no }
"ab" match { case Pat5(x) => println("Pat5 "+x); case _ => no } 
```

（你总会得到一场比赛。）

如果您想要所有匹配项，请使用`@ _*`

```
"ab" match { case Pat3(w @ _*) => println(w); case _ => no } 
```

我不确定你的意思，`(?a)`所以我不知道它有什么问题。不要`(?a)`与`(?:a)`（或与`(a?)`或与`(a)?`）混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:49:28.620

以下是如何访问`group(1)`每场比赛的示例：

```
val string = "one493two483three"
val pattern = """two(\d+)three""".r
pattern.findAllIn(string).matchData foreach {
  m => println(m.group(1))
} 
```

**[在这里](http://ideone.com/2XVzay)**测试这个演示。

# firefox-addon - 是否可以在 Firefox 附加组件中使用第三方 js 库，例如下划线？

> ID：13483296
> 
> 赞同：4
> 
> 时间：2012-11-20T22:27:45.677
> 
> 标签：firefox-addon, firefox-addon-sdk

我正在使用 Firefox Add-On SDK 将 Chrome 扩展移植到 Firefox。在 Chrome 中，加载像 Underscore 或 Backbone 这样的第三方库是微不足道的。在我的特殊情况下，我使用 jQuery、Underscore 和 Backbone 来定义与跨域 REST API 通信的模型。

我不清楚你如何在 Firefox 中做类似的事情。从我可以看到 main.js 直接对应于 Chrome 的后台页面，但似乎没有加载 js 文件的方法。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T11:59:12.773

附加 SDK 支持 CommonJS 模块 sysem，nodejs 也使用相同的模块 [https://github.com/mozilla/addon-sdk/tree/master/app-extension](https://github.com/mozilla/addon-sdk/tree/master/app-extension)

Underscore 支持 commonjs 模块格式，并且可以轻松加载 [https://github.com/documentcloud/underscore/blob/master/underscore.js#L54-L65](https://github.com/documentcloud/underscore/blob/master/underscore.js#L54-L65)

您只需要在 main.js 旁边添加下划线并按如下方式加载它：

```
var _ = require("./underscore") 
```

我确实相信骨干网也可以像人们在 nodejs 上使用它一样以类似的方式加载。

但它不适用于 jQuery，这是因为附加 SDK 模块运行的上下文与带有 DOM 的典型网页上下文不同，这是 jQuery 旨在使用的。

现在，如果您想做跨域请求，SDK 附带了一个模块来执行此操作： [https](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/request.html) ://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/addon-kit/request.html 还有另一个低级 XHR 模块，您可以使用它： [https ://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/api-utils/xhr.html](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/packages/api-utils/xhr.html)

因此，如果您只是想编写模型并与 REST API 交谈，那应该很简单，我不确定 jQuery 在您的用例中的作用是什么。它暗示了你想要显示的 DOM 和 UI。如果是这样，SDK 中有几个模块可以让您为 firefox 添加自定义 UI，您可能会找到关于该主题的有用教程： [https ://addons.mozilla.org/en-US/developers/docs/sdk/latest /dev-guide/tutorials/index.html](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/tutorials/index.html)

# java - JFormattedTextField 是在焦点上添加字符

> ID：13483298
> 
> 赞同：0
> 
> 时间：2012-11-20T22:27:55.087
> 
> 标签：java, swing, cursor, textfield, jformattedtextfield

我有一个使用代码初始化的 JFormattedTextField

```
JFormattedTextField f = new JFormattedTextField(createFormatter());
f.setValue(null);
f.setColumns(1);
f.setEditable(true);
f.setCaretPosition(0); 
```

textField 为 1 列宽，在我的 createFormatter 方法中

```
MaskFormatter formatter = null;
    try {
        formatter = new MaskFormatter("#");
        formatter.setValidCharacters("123456789");
    } catch (java.text.ParseException exc) {
        System.err.println("formatter is bad: " + exc.getMessage());
        System.exit(-1);
    }
    return (formatter); 
```

如您所见，我只想在文本字段中输入数字 1-9。这在切换到文本字段时效果很好，但是当我实际单击文本字段进行输入时，光标会发生这种奇怪的事情。

此处光标闪烁空白... ![光标闪烁白色](../Images/602aee28058868952d2972b9170edb35.png) 并且光标闪烁黑色。 ![光标闪烁黑色](../Images/cdc43dcd805ebfac6305fc5ce4465208.png)

如您所见，左上角有一个小黑点，光标从左侧移开。我可以突出显示左侧的区域，![高亮区域](../Images/3f9a0ed1fee50cb8df01b0ecadc19e5b.png)并且不能再向该文本字段添加任何字符（即使是数字 1-9）。这让我相信，当我用光标关注文本字段时，正在添加一个字符。我不知道这个角色是什么，我不知道如何解决这个问题。

有谁知道如何解决这个问题？

这是一个[sscce](http://sscce.org/)

```
public class FormattedTextField {

public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(100, 75);
    JPanel content = new JPanel(new FlowLayout());
    frame.setContentPane(content);

    JFormattedTextField f1 = new JFormattedTextField(createFormatter());
    f1.setValue(null);
    f1.setColumns(1);

    JFormattedTextField f2 = new JFormattedTextField(createFormatter());
    f2.setValue(null);
    f2.setColumns(1);

    content.add(f1);
    content.add(f2);

    frame.setVisible(true);
}

public static MaskFormatter createFormatter() {
    MaskFormatter formatter = null;
    try {
        formatter = new MaskFormatter("#");
        formatter.setValidCharacters("123456789");
    } catch (java.text.ParseException exc) {
        System.err.println("formatter is bad: " + exc.getMessage());
        System.exit(-1);
    }
    return (formatter);
} 
```

}

在这个例子中，左上角没有一个小黑点，但是当用鼠标聚焦文本字段时，仍然添加了一个空白字符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T07:38:52.693

在我的带有 JDK7 的 Mac 上，我的代码只会出现烦人的插入符号行为。我没有看到那个点。

从 a 切换`MaskFormatter`到 a`Format`似乎可以解决这个问题。我对 s 的个人经验`JFormattedTextField`总是与`Format`似乎有效的 a 结合使用（经过一些小调整，请参阅[这篇文章](https://stackoverflow.com/a/13424140/1076463)）。

无论如何，这里是您的 SSCCE 的调整版本，它使用`Format`

```
import javax.swing.JFormattedTextField;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.text.MaskFormatter;
import java.awt.FlowLayout;
import java.text.AttributedCharacterIterator;
import java.text.FieldPosition;
import java.text.Format;
import java.text.NumberFormat;
import java.text.ParsePosition;

public class FormattedTextFieldDemo {
  public static void main(String[] args) {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setSize(100, 75);
    JPanel content = new JPanel(new FlowLayout());
    frame.setContentPane(content);

    JFormattedTextField f1 = new JFormattedTextField(createFormat());
    f1.setValue(null);
    f1.setColumns(1);

    JFormattedTextField f2 = new JFormattedTextField(createFormat());
    f2.setValue(null);
    f2.setColumns(1);

    content.add(f1);
    content.add(f2);

    JFormattedTextField f3 = new JFormattedTextField(createFormatter());
    f3.setValue(null);
    f3.setColumns( 1 );

    JFormattedTextField f4 = new JFormattedTextField(createFormatter());
    f4.setValue(null);
    f4.setColumns(1);

    content.add(f3);
    content.add(f4);

    frame.setVisible(true);
  }

  private static MaskFormatter createFormatter() {
    MaskFormatter formatter = null;
    try {
      formatter = new MaskFormatter("#");
      formatter.setValidCharacters("123456789");
    } catch (java.text.ParseException exc) {
      System.err.println("formatter is bad: " + exc.getMessage());
      System.exit(-1);
    }
    return (formatter);
  }

  private static Format createFormat(){
    final NumberFormat format = NumberFormat.getInstance();
    format.setParseIntegerOnly( true );
    return new Format() {
      @Override
      public StringBuffer format( Object obj, StringBuffer toAppendTo, FieldPosition pos ) {
        return format.format( obj, toAppendTo, pos );
      }

      @Override
      public AttributedCharacterIterator formatToCharacterIterator( Object obj ) {
        return format.formatToCharacterIterator( obj );
      }

      @Override
      public Object parseObject( String source, ParsePosition pos ) {
        int initialIndex = pos.getIndex();
        Object result = format.parseObject( source, pos );
        if ( result != null && pos.getIndex() > initialIndex + 1 ) {
          int errorIndex = initialIndex + 1;
          pos.setIndex( initialIndex );
          pos.setErrorIndex( errorIndex );
          return null;
        }
        return result;
      }
    };
  }
} 
```

# tfs - tf命令行递归查找所有标签

> ID：13483306
> 
> 赞同：0
> 
> 时间：2012-11-20T22:28:27.347
> 
> 标签：tfs

如何搜索我应用的所有标签？我在文件夹或某些文件上应用了不同的标签。我试图在这里找到msdn文章：

[http://msdn.microsoft.com/en-us/library/t21wc9ca(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/t21wc9ca(v=vs.100).aspx)

但没有这样做的方向。有人帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:27:01.687

文件没有*标签*。标签*包含*文件。

您需要使用该[`tf labels`](http://msdn.microsoft.com/en-us/library/t21wc9ca%28v=vs.100%29.aspx)命令来检查您创建的标签，寻找您想要匹配的文件。

# java - 如何强制 RESTEasy 输出数字作为 json 中的字符串？

> ID：13483308
> 
> 赞同：1
> 
> 时间：2012-11-20T22:28:40.887
> 
> 标签：java, javascript, json, jackson, resteasy

我想在 RESTEasy（与杰克逊）的以下 json 中加上引号“”。

```
{
    "isReachable": false,
    "timestamp": 1353449973347
}

{
    "isReachable": "false",
    "timestamp": "1353449973347"
} 
```

我这样做的原因是因为我使用的是 GWT，而 gwt 无法将时间戳转换为长数据类型。您知道如何通过 RESTEasy 将值输出为字符串吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T00:13:56.050

您可以在 pojo 中使用注释对要序列化的时间戳属性进行`@JsonSerialize`注释，并指示 Jackson 使用字符串序列化程序。

```
public class YourPojo
{
     private boolean isReachable = false;

     @JsonSerialize(using = ToStringSerializer.class)
     private Long timestamp;

     //Getters and Setters omitted for brevity
} 
```

# c++ - 将函数作为参数传递的好习惯：复制、引用、常量引用？

> ID：13483315
> 
> 赞同：3
> 
> 时间：2012-11-20T22:29:16.047
> 
> 标签：c++, c++11, functor, lambda

> **可能的重复：**
> [模板通过值或常量引用传递或......？](https://stackoverflow.com/questions/4876913/template-pass-by-value-or-const-reference-or)

对于将函数作为参数的函数，以下最佳做法是什么：

```
template<class Function> void test1(Function f);
template<class Function> void test2(Function& f);
template<class Function> void test3(const Function& f); 
```

其中传递的函数可以是仿函数、std::function、函数指针或 lambda 函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T22:32:18.660

使用通用引用，您无需考虑它：

```
template<class Function> void test(Function&& f); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T23:00:01.723

当参数被传递给推断参数类型的函数模板时，应该如何传递参数是一个有趣的问题。值得注意的是，使用参数的确切性质无关紧要：参数是否用作函数对象、迭代器、值等与答案无关。有四个选项：

1.  `template <typename T> void f(T&& a)`
2.  `template <typename T> void f(T& a)`
3.  `template <typename T> void f(T const& a)`
4.  `template <typename T> void f(T a)`

函数模板的实际作用有点重要：如果`f()`它的参数所做的`a`只是将其转发给另一个函数，那么您希望通过通用引用传递。被调用的函数将整理细节并拒绝不合适的选项。当然，虽然通常有用，但转发功能有些乏味。

如果`f()`真的对对象做了什么，我们通常可以立即丢弃两个选项：

1.  通过通用引用传递会导致我们不知道它是引用还是值的类型。除了转发类型之外，这对于其他任何事情都毫无用处，因为它的行为要么像值，要么像引用。仅指定函数实际执行的操作将是一个有问题的舞蹈。
2.  绕过对`T const&`我们也没有多大好处：我们得到了一个对象的引用，该对象的生命周期我们无法控制，我们既不能从中移动也不能复制/删除它。

如果对象本身被修改，则通过非`const`引用传递对象可能很有用。这显然是功能契约的一个重要部分，也是一个强加的设计选择，在采用时不能被功能的客户覆盖。

首选的方法是按值取参数。通常，这使得函数行为的定义变得更加容易，并且实际上为用户保留了类型应该遵循值还是引用语义的选择！仅仅因为某些东西是按值传递的，并不意味着感兴趣的对象也按值传递。特别是对于函数对象的情况，标准 C++ 库甚至提供了一个通用适配器，给出了值类型引用语义：`std::ref()`.

当然，界面设计是微妙的，在某些情况下，每个选项都是必要的。但是，作为一般经验法则，我认为这很简单：

1.  转发函数使用通用引用。
2.  使用参数做某事的函数使用值。

...当然，这些规则仅适用于推导出类型的函数模板的参数。

# asp.net - web.config 发起的服务器错误上的 customError

> ID：13483316
> 
> 赞同：0
> 
> 时间：2012-11-20T22:29:26.710
> 
> 标签：asp.net, web-config

**笔记**

*我已经确定我在下面描述的问题是特定于加载文件中指定的 DLL 文件时遇到的错误`web.config`。即使在出现错误的情况下，我也想呈现一个用户友好的`web.config`错误。*

**尾注**

当我的 ASP.Net 应用程序遇到服务器错误时，我希望它向用户显示自定义错误消息，而不是以下默认的可怕消息。

```
Server Error in '/' Application.

Runtime Error

Description: An application error occurred on the server. The current custom error settings for this application prevent the details of the application error from being viewed remotely (for security reasons). It could, however, be viewed by browsers running on the local server machine. 

Details: To enable the details of this specific error message to be viewable on remote machines, please create a <customErrors> tag within a "web.config" configuration file located in the root directory of the current web application. This <customErrors> tag should then have its "mode" attribute set to "Off".

<!-- Web.Config Configuration File -->

<configuration>
    <system.web>
        <customErrors mode="Off"/>
    </system.web>
</configuration>

Notes: The current error page you are seeing can be replaced by a custom error page by modifying the "defaultRedirect" attribute of the application's <customErrors> configuration tag to point to a custom error page URL.

<!-- Web.Config Configuration File -->

<configuration>
    <system.web>
        <customErrors mode="RemoteOnly" defaultRedirect="mycustompage.htm"/>
    </system.web>
</configuration> 
```

我编写了一个非常简单的 HTML 页面并将其放在我的应用程序的根目录中。它被称为MaintenancePage.htm。

我已将 web.config 文件设置为以下内容：

```
<customErrors mode="RemoteOnly" defaultRedirect="MaintenancePage.htm">
  <error statusCode="404" redirect="PageNotFound.aspx" />
</customErrors> 
```

我也试过`~/MaintenancePage.htm`and `http://[mysite]/MaintenancePage.htm`。这些选项似乎都不起作用。

我测试的方法是重命名我的项目所依赖的 DLL，然后在 Web 浏览器中加载该站点。我希望既然有一个错误和一个`defaultRedirect`集合，那么显示错误页面应该没有问题，但是，我显然错了。

我已经搜索过这个问题，似乎大多数人都试图重定向到一个`aspx`页面，并且在这样做时遇到了错误。许多人甚至报告说他们无法将`aspx`页面加载为`defaultRedirect`，但他们可以`html`加载页面。

我在这里做错了什么？

我应该注意，我正在从公司防火墙外部的不同网络进行测试，因此更改`RemoteOnly`为`On`不是文档中的问题。正如预期的那样，在测试中更改`RemoteOnly`为`On`没有效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:43:43.893

**将RemoteOnly**更改为**On**。

仅远程：

> 指定仅向远程客户端显示自定义错误， **向本地主机显示 ASP.NET 错误**

此外，您的 URL 可能是绝对的或相对的。

[阅读有关 customErrors 设置的更多信息](http://msdn.microsoft.com/en-us/library/h0hfz6fc%28v=vs.100%29.aspx)

要在本地观看它：

```
<customErrors mode="On" defaultRedirect="/MaintenancePage.htm">
  <error statusCode="404" redirect="/PageNotFound.aspx" />
</customErrors> 
```

更简单的测试方法。

1.  尝试一个错误的 url 并观察你的 404 错误接管
2.  把它放在你的 default.aspx 页面**<% throw new Exception("gaah"); %>**

还有一件事要考虑：错误记录。可以通过[ELMAH](http://code.google.com/p/elmah/)轻松实现。

# c# - 创建目录时反斜杠是否计算两次，但在获取完整路径时只计算一次？

> ID：13483319
> 
> 赞同：1
> 
> 时间：2012-11-20T22:29:39.173
> 
> 标签：c#, .net

`Path.GetFullPath(path);`工作正常。但`Directory.CreateDirectory(path);`抛出`path too long`异常。这两种方法对反斜杠的计数是否不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T12:33:10.587

在[ILSpy](http://ilspy.net/)中，似乎[`GetFullPath`](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)使用`private const MaxDirectoryLength`(255) 而[`CreateDirectory`](http://msdn.microsoft.com/en-us/library/54a0at6s%28v=vs.100%29.aspx)使用 248。

Path.GetFullPath -> GetFullPathInternal -> NormalizePath

```
// System.IO.Path
private static readonly int MaxDirectoryLength = 255;

// ...
if (num8 - num5 > Path.MaxDirectoryLength)
{
    throw new PathTooLongException(Environment.GetResourceString("IO.PathTooLong"));
}
// ... 
```

Directory.CreateDirectory -> InternalCreateDirectory（顺便说一句，NormalizePath 在 InternalCreateDirectory 之前也被调用）

```
// ...
string text2 = list[list.Count - 1];
list.RemoveAt(list.Count - 1);
if (text2.Length >= 248)
{
    throw new PathTooLongException(Environment.GetResourceString("IO.PathTooLong"));
}
// ... 
```

因此，文件夹名称似乎不能超过 248 个字符，而完整路径（包括每个子文件夹）可以更长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:39:57.450

**转义字符在编译**时“被计算在内” ，因此两种方法都看到一个字符（反斜杠）而不是两个。转义字符在应用程序编译后是“不可见的”，它们只在源代码中可见；换句话说，“\\”序列在编译时（而不是运行时）解析并转换为单个反斜杠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:42:39.483

您必须达到 Windows Max Path size (248 chars) ，所以

```
Directory.CreateDirectory(path); 
```

无法创建目录。

您可以粘贴目录路径吗？

# javascript - 我无法使用 Javascript 连接到 Splunk，但可以使用 Java

> ID：13483324
> 
> 赞同：0
> 
> 时间：2012-11-20T22:29:58.027
> 
> 标签：javascript, splunk

我正在尝试使用 Javascript 连接到 Splunk。我已经与 Java 连接，能够做任何我想做的事情。当我尝试使用 Javascript 连接时，我不断收到 401。我对 Java 和 Javascript 使用相同的凭据，所以我知道那里没有问题。我的代码直接来自示例。这里是：

```
exports.main = function(opts, done) {
    // This is just for testing - ignore it
    opts = opts || {};

    var username = opts.username    || "username";
    var password = opts.password    || "password";
    var scheme   = opts.scheme      || "https";
    var host     = opts.host        || "domain.com";
    var port     = opts.port        || "8089";
    var version  = opts.version     || "5";

    var service = new splunkjs.Service({
        username: "username",
        password: "password",
        scheme: "https",
        host: "domain.com",
        port: "8089",
        version: "5"
    });

    // First, we log in
    service.login(function(err, success) {
        // We check for both errors in the connection as well
        // as if the login itself failed.
        if (err || !success) {
            console.log("Error in logging in");
            console.log(err);
            done(err || "Login failed");
            return;
        }

        // Now that we're logged in, let's get a listing of all the saved searches.
        service.savedSearches().fetch(function(err, searches) {
            if (err) {
                console.log("There was an error retrieving the list of saved searches:", err);
                done(err);
                return;
            }

            var searchList = searches.list();
            console.log("Saved searches:");
            for(var i = 0; i < searchList.length; i++) {
                var search = searchList[i];
                console.log("  Search " + i + ": " + search.name);
                console.log("    " + search.properties().search);
            }

            done();
        });
    });
};

if (module === require.main) {
    exports.main({}, function() {});
} 
```

这是错误消息：

```
There was an error retrieving the list of saved searches: { response: 
   { headers: 
      { connection: 'close',
        'content-length': '100',
        'content-type': 'text/xml; charset=utf-8',
        date: 'Tue, 20 Nov 2012 22:27:11 GMT',
        server: 'Splunkd' },
     statusCode: 401 },
  status: 401,
  data: '<response>\n<messages>\n<msg type="WARN">call not properly authenticated</msg>\n</messages>\n</response>',
  error: null } 
```

我用 Node 在命令行上运行它并得到 401 错误。我还需要检查什么以查看我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:41:54.357

跨域政策无疑是[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:47:46.123

当您开始使用 SDK 进入更高级的用例时，跨源策略绝对是您需要注意的事情，但是查看您的示例代码，您似乎在实例化`service`对象时无意中在变量名周围加上了双引号。

我复制了您的代码，将变量值替换到我的服务器，第二次删除了双引号并使用节点通过命令行对其进行了验证......它工作得很好。

# html - 在不指定确切大小的情况下使按钮具有相同的宽度

> ID：13483331
> 
> 赞同：14
> 
> 时间：2012-11-20T22:30:41.380
> 
> 标签：html, css

我有五个按钮。我希望他们占据其父 div 的可用宽度，每个 div 的大小相同：

```
<div style="width: 100%; background-color: red;">
    <button type="button" style="width: 20%;">A</button>
    <button type="button" style="width: 20%;">B</button>
    <button type="button" style="width: 20%;">C</button>
    <button type="button" style="width: 20%;">D</button>
    <button type="button" style="width: 20%;">E</button>
</div> 
```

有没有一种方法可以做到这一点，而无需手动确定它们每个都需要 20% 的宽度？我想在运行时删除一个按钮，这意味着我必须再次将每个剩余的按钮更新为 width=25%。

我只是在检查是否有更自动化的方法。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-20T23:10:57.580

最简单也是最稳健的方法是使用表格：

```
<style>
.buttons { 
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  background-color: red; 
}
.buttons button { 
  width: 100%;
}
</style>
<table class=buttons>
 <tr>
    <td><button type="button">A</button>
    <td><button type="button">B</button>
    <td><button type="button">C</button>
    <td><button type="button">D</button>
    <td><button type="button">E</button>
</table> 
```

（如果他们现在看到您的代码，这不会提高您在同事中的声誉，尽管它实际上可能比任何替代方案更好地解决问题。所以您可能会考虑做下一个最好的事情：使用`div`标记`display: table`等。在旧浏览器上失败不支持此类 CSS 功能。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-11-07T09:26:29.110

这是我最喜欢的方法（[Flexbox](https://en.wikipedia.org/wiki/CSS_Flexible_Box_Layout)）！-

```
<div style="width: 100%; background-color: red;">
    <button type="button">A</button>
    <button type="button">B</button>
    <button type="button">C</button>
    <button type="button">D</button>
    <button type="button">E</button>
</div>

div {
  display: flex;
  justify-content: space-around;
}
button {
  width: 100%;
  margin: 5px; /* or whatever you like */
} 
```

无论您有多少按钮，它都会自动调整按钮宽度并填充`div`.

工作笔：[http ://codepen.io/anon/pen/YpPdLZ](http://codepen.io/anon/pen/YpPdLZ)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T22:44:33.007

这就是我处理这种情况的方法，从前端网格系统中排队。使用类！删除按钮时，更改类。[这是一个小提琴](http://jsfiddle.net/crowjonah/mrJ5N/)。

您的 HTML 标记可能会更改为：

```
<div>
    <button type="button" class="fiveup">A</button>
    <button type="button" class="fiveup">B</button>
    <button type="button" class="fiveup">C</button>
    <button type="button" class="fiveup">D</button>
    <button type="button" class="fiveup" id="remove_this">E</button>
</div>
<button id="remove_one">Remove One</button>​ 
```

像这样的CSS：

```
.fiveup {width: 18%;margin:1%;float: left;}
.fourup {width: 23%;margin:1%;float: left;} 
```

和 jQuery 一样，尽管您可能希望将此脚本用作删除按钮的任何过程的一部分：

```
$('#remove_one').click(function(){
    $('#remove_this').remove();
    $('button').each(function(){
        $(this).removeClass('fiveup').addClass('fourup');
    });
});​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-06T08:17:25.847

使用引导程序，它就像

```
<div class="btn-group-vertical">

</div> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T22:35:04.987

如果我们认为他们的父母大小相同，那么您有两个解决问题的方法：

CSS：

```
button { /* You may want to limit the selector */
     width: 100%; /* Or any other percent */
} 
```

JavaScript (jQuery):

```
$("button").width("100%"); 
```

但是请注意，为确保您也获得准确的值，您可能需要坚持使用像素。如果你愿意使用 JavaScript，你也可以使用计算宽度。

* * *

**编辑**

如果您想在没有 jQuery 的情况下使用 JavaScript，请尝试：

```
var buttons = document.getElementsByTagName("button"),
    i = 0;
for (; i < buttons.length; i++) {
     buttons[i].width = "100%"; //Or any other value
} 
```

但是请注意，`.getElementsByTagName()`如果您想要更复杂的查询，则必须替换它。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-11-20T22:40:44.920

我认为，使用 jQuery，您可以做一些更动态的事情。

该算法的过程将是：

1.  获取div的宽度，放入变量中。

2.  将宽度除以按钮的数量并将该答案放入变量中。

3.  运行一个函数，以该宽度创建一个按钮，但需要多次。

# php - cURL 加载页面 SERVICE 不可用

> ID：13483333
> 
> 赞同：1
> 
> 时间：2012-11-20T22:30:45.513
> 
> 标签：php, curl, remote-access

我试图用 cURL 加载 shareflare.net，但每次我都会收到 Service Unavailable 错误。从我的本地主机它正常加载页面，但从我的网络主机我得到这个错误....请帮助。

```
 $load=curl_init();

    curl_setopt($load, CURLOPT_URL, "http://shf.wm-panel.com/");
    curl_setopt($load, CURLOPT_RETURNTRANSFER, false);
    curl_setopt($load, CURLOPT_FOLLOWLOCATION,true);
    echo $result=curl_exec($load); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:39:44.010

这是因为该站点返回 503 错误，并且该服务在美国确实不可用。

如果您有可以使用的代理，那么告诉 cURL 使用代理并不难：

```
curl_setopt($load, CURLOPT_PROXY, 'some.hostname.com:8888'); 
```

我从未真正使用过代理隧道，但我知道它是有效的。您可以使用一些[与代理相关的选项。](http://www.php.net/manual/en/function.curl-setopt.php)

# c# - 为什么我不能直接在 C# 中编辑列表成员

> ID：13483338
> 
> 赞同：1
> 
> 时间：2012-11-20T22:31:06.193
> 
> 标签：c#, list

我有一个声明为的类`public class DatumSet : List<datum>`，其中

```
public struct datum {
    public UInt32[] chan;
    public UInt64 sample_number;
    public float time;
    public UInt32 source_sector;
} 
```

我想遍历列表并进行一些更改。为什么这不起作用

```
 for (int i = 0; i < this.Count; i++) {
            this[i].sample_number = startSample;
            this[i].time = (float)startSample / _sample_rate;
            startSample++;
        } 
```

但这确实有效

```
 for (int i = 0; i < this.Count; i++) {
            datum d = this[i];
            d.sample_number = sampleNumber;
            d.time = (float)sampleNumber / _sample_rate;
            sampleNumber++;
        } 
```

我得到错误：

无法修改“System.Collections.Generic.List.this[int]”的返回值，因为它不是变量

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-20T22:33:07.580

这就是使用可变值类型所得到的：)

将索引器想象成一个方法调用。所以这：

```
this[i].sample_number = startSample; 
```

就好像：

```
GetValue(i).sample_number = startSample; 
```

但是因为`datum`是值类型（结构），所以该方法返回列表中值的*副本*——所以修改它对你没有任何好处。

编译器正在阻止你犯这个错误。

您*声称*这有效：

```
for (int i = 0; i < this.Count; i++) {
    datum d = this[i];
    d.sample_number = sampleNumber;
    d.time = (float)sampleNumber / _sample_rate;
    sampleNumber++;
} 
```

...但实际上，它没有任何用处。它相当于：

```
sampleNumber += this.Count; 
```

就这样。它可以*编译*，但这与它的*工作*方式不同。

我建议您将所有值类型设为不可变；它有助于防止您陷入这种混乱。因此*，*您可以保留`datum`为值类型，并在每次迭代时替换列表中的值，*或者*您可以将其更改为类，并通过存储在列表中的*引用修改对象。*

（无论哪种方式，我强烈建议您开始使用属性而不是公共字段，并开始遵循 .NET 命名约定。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-20T22:32:37.767

您遇到问题是因为您使用的是结构而不是类。

当您从集合中检索结构时，会生成一个副本。你的第一组代码给你一个错误，因为它检测到你正在做一些你可能不想做的事情。您实际上是在编辑结构的副本，而不是集合中的副本。

第二个不会产生错误，因为您在编辑之前明确地将副本从集合中拉出。此代码可以编译，但不会修改集合中的任何结构，因此不会给您预期的结果。

# java - java从某个点读取文件到另一个点

> ID：13483346
> 
> 赞同：0
> 
> 时间：2012-11-20T22:31:51.033
> 
> 标签：java, file

这是我在这里的第一个问题，希望各位好心的先生能帮助我，我提前谢谢你。

我正在尝试使用线程和复制的工人范式编写一个 Java 项目。我想要做的是创建一个任务工作池。工作人员必须做的任务只是计算指定文件中两个索引之间的单词数。我想创建一个这样的任务：(file,startIndex,finishIndex)。我在找出我应该使用什么文件处理类来打开文件并读取从 startIndex 到 finishIndex 的单词时遇到问题。我还应该提到，我被赋予了一个块大小，我应该使用它来分割任务。ChunkSize 是一个表示字节数的 int

底线：我想从 startIndex 到 startIndex + chunkSize 的文件中读取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:44:47.840

我认为您正在寻找[RandomAccessFile](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/RandomAccessFile.html)类。它有一个“seek”方法，可以让你跳到文件中的某个位置。例子：

```
int chunkSize = 64;
long startingIndex = 55;
byte[] bytesRead = new byte[chunkSize];

RandomAccessFile file = new RandomAccessFile("file.txt", "r");
file.seek(startingIndex);
file.read(bytesRead);
file.close(); 
```

请注意，这将寻求一些*字节*，而不是单词。在阅读之前不可能知道文件中的单词在哪里。计算空格并添加一个是一种天真的方法，在这种情况下会很好用。

# sql-server - CAKEPHP - 通过远程关联过滤记录时出现 MSSQL 错误

> ID：13483347
> 
> 赞同：0
> 
> 时间：2012-11-20T22:31:56.627
> 
> 标签：sql-server, cakephp, relationship

所以我有点卡在上面，我不断收到一个 sql server 错误。是的，我正在使用 mssql 服务器：| - 不是我的数据库。

一点背景，我关心的人际关系是这样的：

AssetMaintenanceRecord->(属于)->Asset->(属于)->Project->(有一个)->ProjectManager

（注意 ProjectManager 就像人员表的别名模型。项目表有一个 ProjectManager 的 ID，它只是人员 ID。

所以我试图做一个简单的过滤器，通过在 ProjectManager 上搜索来选择所有 AssetMaintenanceRecords。

AssetMaintenanceRecordsController.php 中的相关索引函数如下所示：

```
public function index() {
        $conditions = NULL;
        if (isset($this->params['url']['report']) && $this->params['url']['report']  == 'open') {
            $conditions[] = array('CompletedDate' => NULL);
        }

        if (isset($this->params['url']['report']) && $this->params['url']['report'] == 'notified') {
            $conditions[] = array('NotifiedDate BETWEEN ? AND ?' => array(date('M d Y g:iA', strtotime($this->params['url']['datefrom'])), date('M d Y g:iA', strtotime($this->params['url']['dateto']))));
        }

        if (isset($this->params['url']['report']) && $this->params['url']['report'] == 'completed') {
            $conditions[] = array('CompletedDate BETWEEN ? AND ?' => array(date('M d Y g:iA', strtotime($this->params['url']['datefrom'])), date('M d Y g:iA', strtotime($this->params['url']['dateto']))));
        }

        if (isset($this->params['url']['project'])) {
            $conditions[] = array('Asset.aCurrProject' => $this->params['url']['project']);
        }

        if (isset($this->params['url']['ptCode']) && $this->params['url']['ptCode'] != NULL) {
            $conditions[] = array('Asset.ptCode' => $this->params['url']['ptCode']);
        }

        if (isset($this->params['url']['asset']) && $this->params['url']['asset'] != NULL) {
            $conditions[] = array('Asset.aFullCode' => $this->params['url']['asset']);
        }

        if (isset($this->params['url']['pm']) && $this->params['url']['pm'] != NULL) {
            $pm_search_terms = explode(' ', $this->params['url']['pm']);
            foreach($pm_search_terms as $pm_search_term) {
                $conditions[] = array(
                                'OR' => array(
                                        'ProjectManager.PerGivenName LIKE' =>'%'.$pm_search_term.'%',
                                        'ProjectManager.PerSurname LIKE' =>'%'.$pm_search_term.'%',
                                  )
                          );
            }
        }

        $this->paginate['AssetMaintenanceRecord'] = array(
            'contain' => array(
              'Asset' => array(
                'Project' => array(
                    'ProjectManager'
             ))
            ),
          'order' => 'CompletedDate ASC',
          'limit' => 10
        );

        $planttype = $this->AssetMaintenanceRecord->Asset->PlantType->find('list');
        $this->set(compact('planttype'));
        $this->AssetMaintenanceRecord->recursive = -1;
        $this->set('records', $this->paginate('AssetMaintenanceRecord', $conditions));
    } 
```

如果没有 ProjectManager 过滤器，它可以正常工作，我可以回显 ProjectManager 数组等，但是当我输入搜索词时，会出现以下错误：

> 无法绑定多部分标识符“ProjectManager.PerSurname”。

执行的 sql 如下所示：

'SELECT TOP 10 [AssetMaintenanceRecord].[MtceRegID] AS [AssetMaintenanceRecord_ *0], [AssetMaintenanceRecord].[AssetID] AS [AssetMaintenanceRecord* _1], CAST(CAST([AssetMaintenanceRecord].[MtceRegNote] AS VARCHAR(8000)) AS TEXT) AS [AssetMaintenanceRecord_2 *]、[AssetMaintenanceRecord].[POno] AS [AssetMaintenanceRecord* _3]、CAST(CAST([AssetMaintenanceRecord].[NotifiedDate] AS VARCHAR(8000)) AS TEXT) AS [AssetMaintenanceRecord_4 *]、CAST(CAST([ AssetMaintenanceRecord].[CompletedDate] AS VARCHAR(8000)) AS TEXT) AS [AssetMaintenanceRecord* _5], [AssetMaintenanceRecord].[MtceRegTitle] AS [AssetMaintenanceRecord_ *6], CAST(CAST([AssetMaintenanceRecord].[CreatedDate] AS VARCHAR(8000) ) 作为文本) 作为 [资产维护记录*_7], [AssetMaintenanceRecord].[CreatedUserID] AS [AssetMaintenanceRecord_8 *], CAST(CAST([AssetMaintenanceRecord].[ModifiedDate] AS VARCHAR(8000)) AS TEXT) AS [AssetMaintenanceRecord* _9], [AssetMaintenanceRecord].[ModifiedUserID] AS [AssetMaintenanceRecord_10 *], [Asset].[aID] AS [Asset* _11], [Asset].[ptCode] AS [Asset_ *12], [Asset].[aNo] AS [Asset* _13], [Asset].[aFullCode ] AS [Asset_14 *], [Asset].[aDesc] AS [Asset* _15], [Asset].[aMake] AS [Asset_16 *], [Asset].[aModel] AS [Asset* _17], [Asset]。 [aSerialNo] AS [Asset_18 *], [Asset].[aRegNo] AS [* Asset_19], CAST(CAST([Asset].[aRegExpDate] AS VARCHAR(8000)) AS TEXT) AS [Asset_20 *], [Asset ].[aActive] AS [资产*_21], [Asset].[aIncAssetRpt] AS [Asset_22 *], [Asset].[aIncFinanceRpt] AS [Asset* _23], [Asset].[aIsTrailer] AS [Asset_24 *], [Asset].[aIsSurveyEquip] AS [Asset* _25]、[Asset].[aCostedItem] AS [Asset_26 *]、[Asset].[aCostedPeriod] AS [Asset* _27]、[Asset].[aWarrantyPeriod] AS [Asset_28 *]、[Asset].[aPONo ] AS [Asset* _29], CAST(CAST([Asset].[aPODate] AS VARCHAR(8000)) AS TEXT) AS [Asset_ *30], CAST(CAST([Asset].[aPOCostExGst] AS VARCHAR(8000)) AS TEXT) AS [Asset* _31], [Asset].[aQtyStock] AS [Asset_32 *], [Asset].[aQtyInUse] AS [Asset* _33], [Asset].[aCurrProject] AS [Asset_34 *], [Asset ].[aCurrOperator] AS [Asset* _35], [Asset].[aStolen] AS [Asset_*36], CAST(CAST([Asset].[aStolenDate] AS VARCHAR(8000)) AS TEXT) AS [Asset* _37], [Asset].[aWO] AS [Asset_38 *], CAST(CAST([Asset]. [aWODate] AS VARCHAR(8000)) AS TEXT) AS [Asset* _39], [Asset].[aSold] AS [Asset_40 *], CAST(CAST([Asset].[aSoldDate] AS VARCHAR(8000)) AS TEXT ) AS [Asset* _41], CAST(CAST([Asset].[aSoldPrice] AS VARCHAR(8000)) AS TEXT) AS [Asset_ *42], CAST(CAST([Asset].[aNotes] AS VARCHAR(8000)) AS TEXT) AS [Asset* _43], CAST(CAST([Asset].[LastModDate] AS VARCHAR(8000)) AS TEXT) AS [Asset_44 *], CAST(CAST([Asset].[CreatedDate] AS VARCHAR(8000) )) AS TEXT) AS [Asset* _45], [Asset].[aCat] AS [Asset_46 *], [Asset].[aPoliceRptNo] AS [Asset _47* ], [Asset].[aRelatedAssetID] AS [Asset_*48], [Asset].[aRelatedAssetFullCode] AS [Asset* _49], [Asset].[aPayMethod] AS [Asset_ *50], [Asset].[aInvoiceNo] AS [Asset* _51], CAST(CAST([Asset]. [aLastFuelDate] AS VARCHAR(8000)) AS TEXT) AS [Asset_ *52], [Asset].[aFuelType] AS [Asset* _53] FROM [tbMtceRegister] AS [AssetMaintenanceRecord] LEFT JOIN [tbAsset] AS [Asset] ON ([ AssetMaintenanceRecord].[AssetID] = [Asset].[aID]) WHERE [CompletedDate] 为 NULL 且 [Asset].[aCurrProject] 为 NULL 且 (([ProjectManager].[PerGivenName] LIKE '%test%') OR ( [ProjectManager].[PerSurname] LIKE '%test%')) ORDER BY [CompletedDate] ASC'

对我来说看起来不错，但我显然在哪里出错了？

任何帮助表示赞赏。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:43:17.820

ProjectManager 不包含在`FROM`或`JOIN`Part 中，但用于`WHERE`： `OR ([ProjectManager].[PerSurname] LIKE`

# javascript - 追加到 div 时，Appendchild 始终为空

> ID：13483351
> 
> 赞同：0
> 
> 时间：2012-11-20T22:32:20.297
> 
> 标签：javascript, html

我的网站有问题；

我正在尝试将 microsoft bing 地图添加到我的 div 中，如下所示：

```
<body onload="getPosition();">
    <div id="panel">
            <div id="header">
                Some text here 
            </div>
            <div id="map" style="display:block; position:relative;"> 
            </div>
            <input type="button" name="loadForm">Load Form</input>
    </div> 
```

加载地图的 Javascript 是这样完成的：

```
function getPosition() 
{
    var map;
    //get the map
    map = new Microsoft.Maps.Map(document.getElementById('map'), {credentials: bing_api, mapTypeId: Microsoft.Maps.MapTypeId.road, zoom: 1});
    if (navigator.geolocation)
    {
         //zoom into current location
         getCurrentLocation();
    }
    else
    {
        alert("Geolocation not supported");
    }
} 
```

但是，我的地图永远不会加载，调试器告诉我错误`Cannot call method 'appendChild' of null`。看起来引发错误的代码来自 Microsoft。

我的问题是，我做错了吗？我的印象是，`onload`在 body 标记中执行该事件将确保在加载 body 的所有元素之前我不会创建标记（看来情况并非如此）。谢谢！

# jquery - 使用 jquery 设置 ckeditor 实例值

> ID：13483352
> 
> 赞同：1
> 
> 时间：2012-11-20T22:32:20.707
> 
> 标签：jquery, ckeditor

我在 newedit.js 文件中有以下脚本。

```
$(document).ready(function() {
    $("[id^=save]").click(function() {
        $("#scholarship-short_desc").val("test");
        alert($("#scholarship-short_desc").val());
        $("form").submit();
    });

    $("#scholarship-short_desc").ckeditor();
}); 
```

我的 html 文件中也有以下条目。我正在使用 ckeditor 3.6.5。

```
<script src="/myapp/javascripts/ckeditor/ckeditor.js" type="text/javascript"></script>
<script src="/myapp/javascripts/ckeditor/adapters/jquery.js" type="text/javascript"></script>
<script src="/myapp/javascripts/scholarships/newedit.js" type="text/javascript"></script> 
```

这会在我的页面中正确显示 ckeditor。但是当我尝试使用 val 函数设置 textarea 的值时（如此处所述[（ckeditor's jquery guide）](http://docs.cksource.com/CKEditor_3.x/Developers_Guide/jQuery_Adapter)），该值没有被设置。

有任何想法吗？谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T22:31:32.840

CKEditor 不在您的 textarea 上运行，而是在 iframe 中启用了合成 contenteditable 的 html 页面上运行。您可以这样设置编辑器的新内容：

```
CKEDITOR.instances.yourInstanceName.setData( '<h1>Your HTML</h1>' ); 
```

如果您真的想将您的编辑器与其文本区域同步：

```
CKEDITOR.instances.yourInstanceName.updateElement(); 
```

当您调用时，这也会自动发生：

```
CKEDITOR.instances.yourInstanceName.destroy() 
```

您可以`yourInstanceName`通过浏览`CKEDITOR.instances`对象或阅读 textarea 的 id/name 找到（取决于您如何创建编辑器）。

快乐编码！;)

# hibernate - Hibernate 更新后从多对多关联表中删除记录

> ID：13483357
> 
> 赞同：2
> 
> 时间：2012-11-20T22:33:01.840
> 
> 标签：hibernate, many-to-many, hibernate-annotations, cascading-deletes, hibernate-cascade

在我的面向团队合作的应用程序中，我在用户和团队之间有多对多的关系，所以休眠创建关联表。问题是，在更新拥有 Team 的 User 后，hibernate 会从 USER_TEAM 表中删除相应的关联记录。

用户实体：

```
@Entity
@Table(name="USERS")
public class User extends SelectItem {

@Id
@Column(name="EMAIL")
private String email;

@Column(name="PASSWORD")
private String password;

@Column(name="NAME")
private String name;

@Column(name="GROUPNAME")
private String group;

@ManyToMany(
    targetEntity=Team.class
)
@ForeignKey(name="FK_TEAM_TO_USER", inverseName = "FK_USER_TO_TEAM")
@JoinTable(
    name="USER_TEAM",
    joinColumns=@JoinColumn(name="EMAIL"),
    inverseJoinColumns=@JoinColumn(name="TEAMNAME")
)
@LazyCollection(LazyCollectionOption.FALSE)
private List<Team> teamList;

@OneToMany(
        fetch = FetchType.EAGER,
        mappedBy="user")
private List<Invitation> invitationList;

//getters setters 
```

团队实体：

```
@Entity
@Table(name="TEAM")
public class Team extends SelectItem {

@Id
@Column(name="TEAMNAME")
private String name;

@ManyToOne
@ForeignKey(name="FK_TEAM_TO_TEAMLEADER")
@JoinColumn(name="TEAMLEADER")
private User teamLeader;

@ManyToMany(
    mappedBy = "teamList",
    targetEntity = User.class
)
@LazyCollection(LazyCollectionOption.FALSE)
private List<User> memberList;

//getters setters 
```

这是日志：

> 信息：20.11.2012 22:50:00,170 调试 org.hibernate.transaction.JDBCTransaction.begin：开始
> 信息：20.11.2012 22:50:00,175 调试 org.hibernate.transaction.JDBCTransaction.begin：当前自动提交状态：true
> 信息： 20.11.2012 22:50:00,175 调试 org.hibernate.transaction.JDBCTransaction.begin：禁用自动提交
> 信息：20.11.2012 22:50:00,175 调试 hibernate.jdbc.util.SQLStatementLogger.logStatement：选择 user_.EMAIL，user_.GROUPNAME作为 GROUPNAME0_，user_.NAME 作为 NAME0_，user_.PASSWORD 作为 PASSWORD0_ 来自 USERS user_ where user_.EMAIL=?
> 信息：休眠：从用户 user_ 中选择 user_.EMAIL，user_.GROUPNAME 作为 GROUPNAME0_，user_.NAME 作为 NAME0_，user_.PASSWORD 作为 PASSWORD0_，其中 user_.EMAIL=?
> 信息：20.11.2012 22:50:00,176 TRACE type.descriptor.sql.BasicBinder.bind：绑定参数 [1] 作为 [VARCHAR] - a@b.com
> 信息：20.11.2012 22:50:00,177 TRACE type.descriptor .sql.BasicExtractor.extract：发现 [users] 作为列 [GROUPNAME0_]
> 信息：20.11.2012 22:50:00,178 TRACE type.descriptor.sql.BasicExtractor.extract：发现 [default] 作为列 [NAME0_]
> 信息：20.11。 2012 22:50:00,178 TRACE type.descriptor.sql.BasicExtractor.extract：发现 [默认] 作为列 [PASSWORD0_]
> 信息：20.11.2012 22:50:00,251 调试 org.hibernate.transaction.JDBCTransaction.commit：提交
> 信息： 20.11.2012 22:50:00,252 调试 hibernate.jdbc.util.SQLStatementLogger.logStatement：更新用户设置 GROUPNAME=?，NAME=?，PASSWORD=? EMAIL=?
> **信息：休眠：更新用户集 GROUPNAME=?、NAME=?、PASSWORD=? EMAIL=?**
> 信息：20.11.2012 22:50:00,260 TRACE type.descriptor.sql.BasicBinder.bind：绑定参数 [1] 作为 [VARCHAR] - 用户
> 信息：20.11.2012 22:50:00,261 TRACE type.descriptor.sql.BasicBinder .bind：绑定参数 [2] 作为 [VARCHAR] - andy
> INFO：20.11.2012 22:50:00,261 TRACE type.descriptor.sql.BasicBinder.bind：绑定参数 [3] 作为 [VARCHAR] - 中断
> 信息：20.11。 2012 22:50:00,262 TRACE type.descriptor.sql.BasicBinder.bind：绑定参数 [4] 作为 [VARCHAR] - a@b.com
> **信息：20.11.2012 22:50:00,264 调试 hibernate.jdbc.util.SQLStatementLogger .logStatement：从 EMAIL=? 的 USER_TEAM 中删除
> 信息：休眠：从 EMAIL=? 的 USER_TEAM 中删除
> 信息：20.11.2012 22:50:00,271 TRACE type.descriptor.sql.BasicBinder.bind：绑定参数 [1] 作为 [VARCHAR] - a@b.com**
> 信息：20.11.2012 22:50:00,274 调试
> org.hibernate .transaction.JDBCTransaction.toggleAutoCommit：重新启用自动提交信息：20.11.2012 22:50:00,274 DEBUG org.hibernate.transaction.JDBCTransaction.commit：提交的 JDBC 连接

更新操作由spring的hibernateTemplate在UserDAO中这个简单的方法中提供：

```
public void saveUser(User user){
    hibernateTemplate.saveOrUpdate(user);
} 
```

（我知道不应该使用 hibernateTemplate，但我认为这不是这个问题的重点）

而DAO方法在事务中被spring service bean UserServiceImpl简单地调用：

```
@Transactional(readOnly=false)
public void saveUser(User user){
    userDao.saveUser(user);
} 
```

如您所见，我没有任何级联注释，并且在更新中我当然不会更改用户的 PK (EMAIL)，所以我不理解这种行为。我正在使用 spring 3.1.0.RELEASE 和休眠 3.6.10.Final。

感谢您的任何建议或解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T22:42:20.213

你不需要任何级联来实现这一点。给定用户的联接表的内容由`teamList`该用户的集合的内容决定。因此，如果您`saveOrUpdate()`使用具有空团队列表的用户调用，Hibernate 将删除该用户的联接表的内容。

# python - 输出到 Outlook 的超链接

> ID：13483361
> 
> 赞同：0
> 
> 时间：2012-11-20T22:33:19.003
> 
> 标签：python

我正在尝试执行以下操作，但最终输入到 Outlook 的数据是混乱的，请查看下面的粘贴链接以获取输入、输出和代码

1\. 使用 minidom 从 xml 读取数据 2\. 如果有超链接，则用正则表达式替换以添加 ahref 属性 3\. 将数据输出到 Outlook

```
INPUT/Output:-
http://pastie.org/5408694 
```

我的代码：-

[http://pastie.org/5408681](http://pastie.org/5408681)

```
# Import package to access Outlook
import win32com.client
import re
import xml.dom.minidom as minidom
resultslis=[]

def getsanityresults(xmlfile):
  dom = minidom.parse(xmlfile)
  data=dom.getElementsByTagName('Sanity_Results')
  textnode = data[0].childNodes[0]
  testresults=textnode.data
  for line in testresults.splitlines():
    line = line.strip('\r,\n')
    line = re.sub(r'(http://[^\s]+|//[^\s]+|\\\\[^\s]+)', r'<a href="\1">\1</a>', line)
    print line     
    resultslis.append(line)
  return resultslis

def main ():
  file = open('results.xml','r')
  sanityresults=getsanityresults(file)
  print sanityresults
  msg_body=("<HTML><head></head>"
        "<body> <font face = \"Calibri\" <br>"
          "<font face = \"Calibri\"%s<br><br>"

        "</body></html>"
        ) % (sanityresults)

  olMailItem = 0x0
  obj = win32com.client.Dispatch("Outlook.Application")
  newMail = obj.CreateItem(olMailItem)
  newMail.HTMLBody = msg_body
  newMail.display()

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T03:19:36.407

我正在回答我自己的问题。更改子程序后有效

```
def getsanityresults(xmlfile):
    testresult=[]
    dom = minidom.parse(xmlfile)
    data=dom.getElementsByTagName('Sanity_Results')
    textnode = data[0].childNodes[0]
    testresults=textnode.data
    for line in testresults.splitlines():
        line = line.strip('\r,\n')
        line = re.sub(r'(http://[^\s]+|//[^\s]+|\\\\[^\s]+)', r'<a href="\1">\1</a>', line)
        testresult.append(line) 
    return '<br>'.join(testresult) 
```

# php - 在带有字符串的 onclick 事件中需要转义什么？

> ID：13483367
> 
> 赞同：1
> 
> 时间：2012-11-20T22:33:24.930
> 
> 标签：php, javascript, onclick, escaping

我不确定我的字符串中需要转义哪些字符。我的 PHP 代码给出了字符串参数，但有时它有引号和双引号，我不知道该怎么处理。

```
onclick="eventBox('This is the string ' // " "')" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:35:23.940

引号 ( `"`) 应替换为`&quot;`. 反斜杠 ( `\`) 附加到`'`.

```
onclick="eventBox('This is the string \' // &quot; &quot;')" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:35:31.693

您将需要转义引号或对其进行编码，以便正确解析。

```
onclick="eventBox('This is the string \' // &quot; &quot;')" 
```

否则会因为引号不匹配而导致解析错误

# matlab - 在 MATLAB 中创建与 classperf 一起使用的分类器

> ID：13483372
> 
> 赞同：1
> 
> 时间：2012-11-20T22:33:45.557
> 
> 标签：matlab, machine-learning, classification, cross-validation

我正在研究一个新模型，并想使用 classperf 来检查我的分类器的性能。我如何让它使用我的分类器而不是内置的分类器之一？我在网上找到的所有示例都使用了 MATLAB 中包含的分类器。我想用K-fold来测试它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T12:58:25.450

尽管您可以编辑 knnclassify 或 svmclassify 之类的函数以查看它们是如何编写的，并尝试模拟该功能，但从 MATLAB 文档中不清楚如何执行此操作。

或者，有一个免费的 MATLAB 模式识别工具箱，它使用对象来表示分类器：

[http://www.mathworks.com/matlabcentral/linkexchange/links/2947-pattern-recognition-toolbox](http://www.mathworks.com/matlabcentral/linkexchange/links/2947-pattern-recognition-toolbox)

您可以通过对基本分类器对象进行子分类来制作新分类器：prtClass。

然后你可以这样做：

c = 我的分类器；yGuess = c.kfolds(dataSet,10); %10 倍 X-val

（完全披露，我是 PRT 工具箱的作者）

# web-services - 将 Eclipselink (MOXy) 与 SoapHandler 一起使用将去除 CDATA 标记

> ID：13483373
> 
> 赞同：1
> 
> 时间：2012-11-20T22:33:45.367
> 
> 标签：web-services, jax-ws, eclipselink, cdata, moxy

EclipseLink JAXB (MOXy) 具有用于处理 CDATA 的 @XmlCDATA 注释。

使用 Moxy 并注释字符串值时，例如

```
@XmlCDATA
private String payload; 
```

如果我运行此 Web 服务，它将在由 JAXB 处理后使用 CDATA 标记工作并显示（我无法控制 JAXB 处理，除非通过注释，所以这很有帮助）。

一旦我添加注释以调用 HandlerChain 文件 ex

```
@HandlerChain(file = "/META-INF/handler-chain.xml") 
```

我会丢失我的 CDATA 标签！这个特定的处理程序实现了 SOAPHandler。我一直在试验和玩弄它，但无法让它保留 CDATA 标签。就好像它在 handleMessage() 方法中被格式化。即使这个方法什么都不做，比如return false；或返回真；它仍然会丢失 CDATA 标签。

# java - java jframe使用main函数

> ID：13483375
> 
> 赞同：1
> 
> 时间：2012-11-20T22:33:51.690
> 
> 标签：java, swing, jframe

我已经用 swing 编码了几天，但我遇到了一个问题......我有来自不同类的函数和变量，这些函数和变量设置在运行程序并调用 jframe 的主类中。我遇到的问题是怎么做我在 jframe 代码中调用主类中的函数，该代码设置为一个名为的新类

```
public class login_sistema extends javax.swing.JFrame 
```

我已经尝试将 main 中的方法作为静态方法我仍然不能这样调用这些方法......如果你能帮助我，我将不胜感激......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:37:16.777

> 我已经尝试将 main 中的方法作为静态方法我仍然不能这样调用这些方法......如果你能帮助我，我将不胜感激......

静态方法是您应该使用的最后一件事。听起来您想让一个对象调用另一个对象的方法，并且要做到这一点，第一个对象必须具有对第二个对象的有效*引用*。这可以通过将它传递给第一个对象的构造函数参数或通过 setXXX(...) 方法来实现。

例如，如果第一个对象创建了第二个对象，它可以将对自身的引用传递给`this`第二个对象的参数。例如，

主类：

```
public class MainClass {
  private OtherClass otherClass;

  public MainClass() {
    otherClass = new OtherClass(this);
  }
} 
```

其他类：

```
public class OtherClass {
  public MainClass mainClass;

  public OtherClass(MainClass mainClass) {
    this.mainClass = mainClass;
  }

  public void someOtherClassMethod() {
     // now we can call methods with the MainClass reference
     mainClass.someMainClassMethod(); 
  }
} 
```

有关您的特定问题的更多详细信息，请考虑告诉我们更多信息并显示代码。

# knockout.js - 淘汰赛js。有没有办法将文本框数据绑定到可观察的和计算的？

> ID：13483382
> 
> 赞同：1
> 
> 时间：2012-11-20T22:34:27.643
> 
> 标签：knockout.js, knockout-mapping-plugin

这是我的 jsfiddle：http: [//jsfiddle.net/bigtek/3rW9S/17/](http://jsfiddle.net/bigtek/3rW9S/17/)

我的问题是：“txtSum”文本框包含其他两个文本框的总和。但是，用户可以在 txtSum 框中输入不同的数字。在这种情况下，我希望“txtSum”框以红色突出显示，以告诉用户数字不相加。

此外，分配按钮将使用它们各自的 allocatpct 计算两个文本框。发生这种情况时，我想用 txtSum 框中的任何数字进行计算，无论它是否同步。

```
<input type="text" data-bind="value:Sum" id="txtSum" /> 
```

（我这样做对吗？）

希望这是有道理的..谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:04:15.513

当然可以，它在文档中[的](http://knockoutjs.com/documentation/computedObservables.html)**示例 1：分解用户输入**标题下进行了演示。

```
function MyViewModel() {
    this.firstName = ko.observable('Planet');
    this.lastName = ko.observable('Earth');

    this.fullName = ko.computed({
        read: function () {
            return this.firstName() + " " + this.lastName();
        },
        write: function (value) {
            var lastSpacePos = value.lastIndexOf(" ");
            if (lastSpacePos > 0) { // Ignore values with no space character
                this.firstName(value.substring(0, lastSpacePos)); // Update "firstName"
                this.lastName(value.substring(lastSpacePos + 1)); // Update "lastName"
            }
        },
        owner: this
    });
}

ko.applyBindings(new MyViewModel()); 
```

> 在这个例子中，write 回调通过将传入的文本拆分为“firstName”和“lastName”组件来处理传入的值，并将这些值写回底层的 observables。

html:

```
<p>First name: <span data-bind="text: firstName"></span></p>
<p>Last name: <span data-bind="text: lastName"></span></p>
<h2>Hello, <input data-bind="value: fullName"/>!</h2> 
```

**编辑：**

快速分解

*   阅读：您实现的代码以返回将在计算的 observable 中显示的内容
*   write：写回底层可观察对象的内容。

# c# - 是什么阻止了这项任务长期运行？

> ID：13483384
> 
> 赞同：2
> 
> 时间：2012-11-20T22:34:31.683
> 
> 标签：c#, multithreading, asp.net-mvc-3, razor, task

出于测试目的，我直接在`.cshtml`页面的剃刀块内使用它。

```
@functions{
    public class Inline
    {
        public HttpResponseBase r { get; set; }
        public int Id { get; set; }
        public List<System.Threading.Tasks.Task> tasks = new List<System.Threading.Tasks.Task>();

        public void Writer(HttpResponseBase response)
        {
            this.r = response;
            tasks.Add(System.Threading.Tasks.Task.Factory.StartNew(
                    () =>
                    {
                        while (true)
                        {
                            r.Write("<span>Hello</span>");
                            System.Threading.Thread.Sleep(1000);
                        }
                    }
            ));
        }
    }
}

@{
    var inL = new Inline();
    inL.Writer(Response);
} 
```

我曾期望它每秒写一次带有文本“Hello”的跨度。它有时会写一次“Hello”，但不是每次甚至大部分时间。为什么这个任务没有长时间运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:49:49.127

您看到不同结果的原因是因为任务正在异步运行，并且如果响应对象在您的任务有机会写入它之前完成，则任务将引发异常并且它将终止您可以这样做的唯一方法是如果您在 Writer() 方法的末尾添加 Task.WaitAll() 。

这将起作用，但页面不会停止加载内容。

```
this.r = response;
tasks.Add(System.Threading.Tasks.Task.Factory.StartNew(
        () =>
        {
            while (true)
            {
                r.Write("<span>Hello</span>");
                r.Flush(); // this will send each write to the browser
                System.Threading.Thread.Sleep(1000);
            }
        }

));

//this will make sure that the response will stay open
System.Threading.Tasks.Task.WaitAll(tasks.ToArray()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T03:03:04.980

这是另一个使用自定义 ActionResult 的选项，它首先处理控制器（默认结果），然后完成它开始任务。

```
public class CustomActionResult:ViewResult
{
    public override void ExecuteResult(ControllerContext context)
    {
        base.ExecuteResult(context);
        var t =  Task.Factory.StartNew(() =>
             {

                  while (true)
                   {
                      Thread.Sleep(1000);
                      context.HttpContext.Response.Write("<h1>hello</h1>");
                      context.HttpContext.Response.Flush();
                   }
            });

        Task.WaitAll(t);
    }
} 
```

在您的控制器中

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
       return new CustomActionResult();
    }
} 
```

# mysql - create...select 语句中的外键约束会发生什么？

> ID：13483385
> 
> 赞同：4
> 
> 时间：2012-11-20T22:34:34.700
> 
> 标签：mysql, sql

只是想知道源表的外键约束在使用`CREATE...SELECT`语句复制时会发生什么。引用约束会被复制还是被忽略？

这是一个例子：

```
CREATE TABLE foo(a int, b int, PRIMARY KEY(a));
CREATE TABLE source(id int, a int, PRIMARY KEY(id), FOREIGN KEY(a) REFERENCES foo(a));

CREATE TABLE target SELECT * FROM source; 
```

所以，我的问题是`a`目标上的属性是否也指向`foo(a)`？如果答案是特定于供应商的，我正在寻找 MySQL 的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T22:45:11.403

不，它不会在`target`. CREATE TABLE...SELECT 只查看 SELECT 结果集的列和数据类型，这决定了新表的定义。

我认为使用 CREATE TABLE...LIKE 可能是一种解决方法，但我在 MySQL 5.5 上对其进行了测试，它也不会创建外键。

```
CREATE TABLE target LIKE source; 
```

我猜是因为外键是在 InnoDB 存储引擎中实现的，MySQL 的存储独立层无法识别它们，它们可能不会出现在独立于存储的 .FRM 文件中。

这个错误似乎证实了 CREATE TABLE...LIKE 是通过简单地复制 .FRM 文件来实现的： [http ://bugs.mysql.com/bug.php?id=35526](http://bugs.mysql.com/bug.php?id=35526)

但是提到的修复被放入 MySQL 6.1 分支，并且该分支很久以前就被杀死了。

所以现在，您必须将外键声明为单独的步骤。我知道将来 .FRM 文件将消失，因此他们必须更改 CREATE TABLE...LIKE 的工作方式。无论如何，这对你今天没有帮助。

# android - Android 问题：无限滚动查看

> ID：13483386
> 
> 赞同：6
> 
> 时间：2012-11-20T22:34:47.340
> 
> 标签：android, image, scroll, limits, edges

我有一个实现了滚动的自定义视图，但它似乎在图像上滚动。
即使我找到图像的边缘，它也会一直滚动到空白背景。

我不能使用 WebView，因为我也有一些 Canvas sutff。
有谁知道如何为这个问题设置限制？
如何适合滚动的图像边缘？

**编辑：**我在@JosephEarl 的帮助下找到了最好的解决方案。
我只设置了左侧和顶部边界，因为我的图像比屏幕大。
此外，我在使用缩放功能时*关闭*了边界，否则我无法再移动它。

**1) 在*onTouch*事件的 ACTION_MOVE 情况下，插入以下代码：**

```
if(!isZoomed) {
    if(mPosX < 0)
        mPosX = 0;
    else if(mPosX > mWidth)
        mPosX = mWidth;
    if(mPosY < 0)
        mPosY = 0;
    else if(mPosY > mHeight)
        mPosY = mHeight;
} 
```

**2)使用缩放时*打开*或*关闭*边界。
将以下代码添加到您的 ACTION_POINTER_UP 案例中：**

```
case MotionEvent.ACTION_POINTER_UP: {

    final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
    final int pointerId = ev.getPointerId(pointerIndex);

    if (pointerId == mActivePointerId) {
        final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
        mLastTouchX = ev.getX(newPointerIndex);
        mLastTouchY = ev.getY(newPointerIndex);
        mActivePointerId = ev.getPointerId(newPointerIndex);
        isZoomed = true;

    } else
        isZoomed = false;

    break;

} 
```

就这样。
以下是所有相关方法和完整的*onTouch*事件：

```
private float scaleFactor = 1.f;
private ScaleGestureDetector detector;

private static final int INVALID_POINTER_ID = -1;
private int mActivePointerId = INVALID_POINTER_ID;

private float mPosX;
private float mPosY;
private float mLastTouchX;
private float mLastTouchY;

private float mWidth;
private float mHeight;
private boolean isZoomed = false;

// OTHER CODE GOES HERE

@Override
public boolean onTouchEvent(MotionEvent ev) {
    detector.onTouchEvent(ev);

    final int action = ev.getAction();
    switch (action & MotionEvent.ACTION_MASK) {
        case MotionEvent.ACTION_DOWN: {
            final float x = ev.getX();
            final float y = ev.getY();

            mLastTouchX = x;
            mLastTouchY = y;
            mActivePointerId = ev.getPointerId(0);
            break;
        }

        case MotionEvent.ACTION_MOVE: {
            final int pointerIndex = ev.findPointerIndex(mActivePointerId);
            final float x = ev.getX(pointerIndex);
            final float y = ev.getY(pointerIndex);

            if (!detector.isInProgress()) {
                final float dx = x - mLastTouchX;
                final float dy = y - mLastTouchY;
                mPosX += dx;
                mPosY += dy;

                if(!isZoomed) {
                    if(mPosX < 0)
                        mPosX = 0;
                    else if(mPosX > mWidth)
                        mPosX = mWidth;
                    if(mPosY < 0)
                        mPosY = 0;
                    else if(mPosY > mHeight)
                        mPosY = mHeight;
                }

                invalidate();
            }

            mLastTouchX = x;
            mLastTouchY = y;

            break;
        }

        case MotionEvent.ACTION_UP: {
            mActivePointerId = INVALID_POINTER_ID;
            break;
        }

        case MotionEvent.ACTION_CANCEL: {
            mActivePointerId = INVALID_POINTER_ID;
            break;
        }

        case MotionEvent.ACTION_POINTER_UP: {

            final int pointerIndex = (ev.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
            final int pointerId = ev.getPointerId(pointerIndex);

            if (pointerId == mActivePointerId) {
                final int newPointerIndex = pointerIndex == 0 ? 1 : 0;
                mLastTouchX = ev.getX(newPointerIndex);
                mLastTouchY = ev.getY(newPointerIndex);
                mActivePointerId = ev.getPointerId(newPointerIndex);
                isZoomed = true;

            } else
                isZoomed = false;

            break;

        }
    }

    return true;
}

private class ScaleListener extends
        ScaleGestureDetector.SimpleOnScaleGestureListener {
    @Override
    public boolean onScale(ScaleGestureDetector detector) {
        scaleFactor *= detector.getScaleFactor();
        scaleFactor = Math.max(MIN_ZOOM, Math.min(scaleFactor, MAX_ZOOM));
        invalidate();
        return true;
    }
}

@Override
protected void onSizeChanged(int xNew, int yNew, int xOld, int yOld){
     super.onSizeChanged(xNew, yNew, xOld, yOld);
     mWidth = xNew;
     mHeight = yNew;
}

// OTHER CODE GOES HERE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:47:45.560

从您的代码看来，您在任何时候都不会尝试检测可滚动区域的大小并将位置限制在这些范围内，即您应该检查以确保`mPosX`不`mPosY`超过它们的范围。

系统不会自动限制你自定义View的位置，需要你自己做。

上界和左界将是 0, 0 - 您应该确保`mPosX`并且`mPosY`不大于此值。

右边界将是（容器视图的宽度 - 滚动视图的宽度）——这应该是负数（如果它大于则将右边界设置为 0）并且您应该确保`mPosX`不小于这个值。下限将是（容器的高度 - 滚动视图的高度）——这又应该是负数，你应该确保`mPosY`不小于这个值。

总而言之，当触摸事件开始计算边界时：

```
// Calculate our bounds.
int leftBound = 0;
int topBound = 0;
int rightBound = imageWidth - getWidth();
if (rightBound > 0) {
    rightBound = 0;
}
int bottomBound = imageHeight - getHeight();
if (bottomBound > 0) {
    bottomBound = 0;
} 
```

您正在滚动的任何内容的宽度和高度在哪里`imageWidth`以及是哪里。`imageHeight`

然后在滚动时确保遵守边界：

```
if (mPosX > leftBound) {
    mPosX = leftBound;
} else if (mPosX < rightBound) {
    mPosX = rightBound;
}

if (mPosY > topBound) {
    mPosY = topBound;
} else if (mPosY < bottomBound) {
    mPosY = bottomBound;
} 
```

# objective-c - 为什么在ios中重新打开会话后无法访问facebook好友列表

> ID：13483391
> 
> 赞同：3
> 
> 时间：2012-11-20T22:35:00.510
> 
> 标签：objective-c, ios, xcode, facebook, facebook-graph-api

我正在升级到适用于 ios 的 facebook 3.0 sdk。事情进展顺利，直到我在重新启动应用程序后尝试打开现有会话。我正在尝试访问 facebook 用户的朋友列表。

```
if ([[FBSession activeSession] isOpen]) {
    [request startWithCompletionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
        //do something here
    }];
}else{
    [[self session] openWithCompletionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
        if ([self isValid]) {
            [request startWithCompletionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
                //log this error we always get
                NSLog(@"%@",error);
                //do something else
            }];
        }
    }];
} 
```

但是我收到此错误：

```
Error Domain=com.facebook.sdk Code=5 "The operation couldn’t be completed. (com.facebook.sdk error 5.)" UserInfo=0x1d92ff40 {com.facebook.sdk:ParsedJSONResponseKey={
  body =     {
    error =         {
        code = 2500;
        message = "An active access token must be used to query information about the current user.";
        type = OAuthException;
    };
  };
  code = 400;
}, com.facebook.sdk:HTTPStatusCode=400} 
```

我发现如果我使用 FBSession reauthorize 方法，它可以让我完成请求而不会出错，但这也意味着我每次重新启动应用程序时都必须显示 UI 或切换应用程序，这是不可接受的。关于我应该做些什么不同的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:57:28.300

登录后我没有在请求上设置会话。简单的错误。

```
[[self session] openWithCompletionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
    if ([self isValid]) {
        //I should have been doing this
        request.session = [FBSession activeSession];
        [request startWithCompletionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
            //log this error we always get
            NSLog(@"%@",error);
            //do something else
        }];
    }
}]; 
```

# c++ - 果酱和 AppEasy

> ID：13483394
> 
> 赞同：0
> 
> 时间：2012-11-20T22:35:17.467
> 
> 标签：c++, marmalade

我想知道一些关于 Marmalade 和 AppEasy 的一般信息。[http://www.appeasymobile.com/](http://www.appeasymobile.com/)

我一直在关注 DrMop 的关于在 Marmalade 中创建游戏引擎的教程，但注意到从教程开始他就开始制作 AppEasy（和其他人一起）。我已经看过它并且有几个直接的担忧

1) 我可以多么容易地将文本文件/xml 文件与 XOML 合并。

2) 我对代码库的控制程度。

3) 引擎有多深，是否有可比的更好的铆钉。

我已经使用 DrMop 在他的教程中使用的 IWGame 引擎开始了我正在处理的项目，但我想知道如果我所有的恐惧都是没有根据的，是否值得继续？

干杯，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T19:11:30.993

对 IwGame 的支持即将结束。IwGame 正在被 AppEasy Core SDK 取代，这是一个开源便携式引擎，Marmalade 只是它计划支持的平台之一。AppEasy Core 也将是开源的，因此其他人可以为其开发做出贡献，提交错误修复等。

XOML + Lua 或 XOML + C++ 或所有 3 个一起使用提供了一个非常强大且易于使用的环境。您可以轻松地集成文本文件、XML 文件、图像文件、声音文件等。您应该查看官方网站 appeasymobile，那里有大量文档和一个拖放应用程序构建器，它可以生成基于 XOML + Lua 的跨平台应用程序。

Cocos2d-x 是一个不错的选择，但是您需要为您计划支持的每个平台设置每个开发环境（要做的非常痛苦），因为它不会为您跨平台编译东西。尽管 Marmalade 现在确实有一个稳定的 Cocos2dx 接口，这使您可以跨多个平台使用 Cocos2dx。

# jquery - jQuery Datepicker 日期格式

> ID：13483395
> 
> 赞同：0
> 
> 时间：2012-11-20T22:35:17.420
> 
> 标签：jquery, datepicker

使用 Datepicker 的默认示例：

```
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>jQuery UI Datepicker - Default functionality</title>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.1/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="/resources/demos/style.css" />
    <script>
    $(function() {
        $( "#datepicker" ).datepicker();
    });
    </script>
</head>
<body>

<p>Date: <input type="text" id="datepicker" /></p>

</body>
</html> 
```

如何将日期显示方式更改为 yy-mm-dd ？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:38:59.707

添加 dateFormat 作为选项 -

```
$( "#datepicker" ).datepicker({ dateFormat : 'yy-mm-dd' }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:37:27.293

```
$( ".selector" ).datepicker({ altFormat: "yy-mm-dd" }); 
```

取自 API 文档：[http ://docs.jquery.com/UI/API/1.8/Datepicker](http://docs.jquery.com/UI/API/1.8/Datepicker)

# html - 退出时显示一个博客 - 登录后显示所有博客

> ID：13483400
> 
> 赞同：0
> 
> 时间：2012-11-20T22:35:43.200
> 
> 标签：html, wordpress, blogs

我已经编写了这个 Wordpress 网站，但我发现博客区域有困难。博客部分只显示一个博客，但我以管理员身份登录，我可以看到页面上的所有博客。我需要它向所有人展示，无论他们是以用户身份登录还是只是网站的访问者。

我试图通过检查“设置>>阅读”设置来查看是否是wordpress问题，它们设置得很好，显示为每页10个帖子。这可能是循环有问题。我有从 index.php 中提取的博客。

[http://www.ilovepennycakes.com/category/blog/](http://www.ilovepennycakes.com/category/blog/)

这是未在提要中显示的博客的直接链接。 [http://www.ilovepennycakes.com/thanksgiving-thoughts/](http://www.ilovepennycakes.com/thanksgiving-thoughts/)

代码如下：

```
<?php get_header(); ?> 
```

```
<!-- Article Loop -->
<article>
  <?php if ( have_posts() ) : ?>
  <?php while ( have_posts() ) : the_post(); ?>
  <div class="news-top"></div>
  <div class="news">
    <div id="post-<?php the_ID(); ?>" <?php post_class(); ?>>
    <div class="post-header">
      <h1 class="meander"><a href="<?php the_permalink(); ?>" rel="bookmark" title="Permanent Link to <?php the_title_attribute(); ?>"><?php the_title(); ?></a></h1>
      <p class="likes m500"><?php comments_popup_link( '0', '1', '%' ); ?></p>
      <div class="clear"></div>
    </div><!--end post header-->
  <!--div class="entry clear"-->
  <div class="blog-content m500">
    <?php if ( function_exists( 'add_theme_support' ) ) the_post_thumbnail(); ?>
    <?php the_content(); ?>
    <?php wp_link_pages(); ?>
  </div>
<!--/div--><!--end entry-->
    <p class="date M500">Posted <?php the_time( 'j M Y' ); ?></p>
    <p class="M500"><?php edit_post_link( __( 'Edit', 'pennycakes' ), '<span>', '</span>' ); ?></p>
<!--end post footer-->
  </div><!--end post-->
  </div>
  <div class="news-bottom"></div>
    <?php endwhile; /* rewind or continue if all posts have been fetched */ ?>
    </div><!--end navigation-->
      <div class="navigation index">
      <div class="alignleft"><?php next_posts_link( 'Older Entries' ); ?></div>
      <div class="alignright"><?php previous_posts_link( 'Newer Entries' ); ?></div>
<?php else : ?>
<?php endif; ?>
</article>
<!-- //Article Loop --> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:45:52.553

好的，我有答案了：index.php 不是用于显示[http://www.ilovepennycakes.com/category/blog/](http://www.ilovepennycakes.com/category/blog/)的文件。用于这种类型的档案显示的文件是“category.php”。如果您的主题文件夹中没有这样的文件，请添加它（可能复制 index.php，因为您已对其进行了编程，或者从默认示例模板中获取）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:51:18.063

嗯...您的帖子仍然是“草稿”还是已发布？如果它们是草稿，则只有在您登录后才能看到它们是正常的，因为草稿未发布，因此任何访问者都不应看到。这是我的猜测。否则，请提供更多信息。

# jquery - 使用在 IE9 中工作的 ajax 发送文件/文件上传

> ID：13483408
> 
> 赞同：12
> 
> 时间：2012-11-20T22:36:34.830
> 
> 标签：jquery, ajax, internet-explorer, file-upload, multipartform-data

我需要使用 IE9 必须支持的 ajax 上传文件。[我使用的是这里](https://stackoverflow.com/questions/5392344/sending-multipart-formdata-with-jquery-ajax)提到的 FormData 。我的代码如下所示：

```
var files = new FormData();
JQuery.each($('#file')[0].files, function (i, file) {
    files.append('file', file);
});

$.ajax({
    type: "POST",
    url: '/url',
    cache: false,
    contentType: false,
    processData: false,
    data: files,
    ...
}); 
```

这在 Safari 和 Firefox 中运行良好，但在 IE9 中失败，因为 IE9 不支持 FormData。我尝试通过设置以文件形式发送：

```
data: $('#file')[0].files[0]
contentType: 'multipart/form-data' 
```

这会失败，因为数据是以 url 编码的形式发送的，并且无法在 java 端解析。任何有关如何解决此问题的帮助或指示将不胜感激。我需要适用于所有浏览器的东西。

编辑：我不需要任何上传进度条，因为文件通常很小。我不需要上传多个文件。我只需要一个文件上传。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-21T16:30:33.357

不幸的是，您不能使用 Ajax（`XMLHttpRequest`换句话说）来发送文件，但是您可以使用`<iframe/>`带有 a 的 a来实现类似的行为`<form method="post" enctype="multipart/form-data"/>`，其中包含`<input type="file"/>`使用“自然”方式发送用户选择的文件。您可以使用javascript调用父文档中的`form.submit()`then poll`<iframe/>`来检查文件上传过程是否完成。

`jQuery`有[很多很酷的插件](http://www.tutorialchip.com/jquery/9-powerful-jquery-file-upload-plugins/)可以完成这项工作，例如[我最喜欢的一个。](http://blueimp.github.com/jQuery-File-Upload/)

# sbt - 如何使用 sbtassembly 在 sbt 中禁用 jar 压缩？

> ID：13483412
> 
> 赞同：5
> 
> 时间：2012-11-20T22:37:02.877
> 
> 标签：sbt

我有兴趣构建未压缩的 jar 文件，以便在只有少数类更改时使我的 rsync 更快，到目前为止，我不知道如何告诉[sbtassembly](https://github.com/sbt/sbt-assembly)禁用压缩。

```
server > inspect assembly
[info] Task: java.io.File
[info] Description:
[info]  Builds a single-file deployable jar.
[info] Provided by:
[info]  {file:/.../}server/*:assembly
[info] Dependencies:
[info]  server/*:assembly-merge-strategy(for assembly)
[info]  server/*:assembly-output-path(for assembly)
[info]  server/*:package-options(for assembly)
[info]  server/*:assembly-assembled-mappings(for assembly)
[info]  server/*:cache-directory
[info]  server/*:test(for assembly)
[info]  server/*:streams(for assembly)
[info] Delegates:
[info]  server/*:assembly
[info]  {.}/*:assembly
[info]  */*:assembly 
```

...

```
server > inspect assembly-option(for assembly)
[info] Setting: sbtassembly.AssemblyOption = AssemblyOption(true,true,true,<function1>)
[info] Description:
[info]  
[info] Provided by:
[info]  {file:/.../}server/*:assembly-option(for assembly)
[info] Dependencies:
[info]  server/*:assembly-assemble-artifact(for package-bin)
[info]  server/*:assembly-assemble-artifact(for assembly-package-scala)
[info]  server/*:assembly-assemble-artifact(for assembly-package-dependency)
[info]  server/*:assembly-excluded-files(for assembly)
... 
```

[然而， AssemblyOption](https://github.com/sbt/sbt-assembly/blob/master/src/main/scala/sbtassembly/Plugin.scala#L396)没有说明任何关于打包的内容，并且该插件似乎为此使用了 sbt 自己的[Package](https://github.com/harrah/xsbt/blob/0.12.1/main/actions/Package.scala)，所以也许有一种方法可以配置*它*？包依次调用[IO.jar(...)](https://github.com/harrah/xsbt/blob/0.12.1/util/io/IO.scala#L364)来写入文件。这使用[withZipOutput](https://github.com/harrah/xsbt/blob/0.12.1/util/io/IO.scala#L461)来制作一个 ZipOutputStream （或一个 JarOutputStream），我想在其上调用[setMethod(ZipOutputStream.STORED)](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/ZipOutputStream.html#setMethod%28int%29)，但我不能。

除了 sbt 功能请求之外还有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-16T21:35:40.250

无法通过 sbt 配置直接执行此操作，因为 sbt 假定 zip 和 jar 工件中的任何文件都应该被压缩。

一种解决方法是解压缩并重新压缩（不压缩）jar 文件。您可以通过将以下设置添加到您的项目（例如在*build.sbt*中）来做到这一点：

```
packageBin in Compile <<= packageBin in Compile map { file =>
  println("(Re)packaging with zero compression...")
  import java.io.{FileInputStream,FileOutputStream,ByteArrayOutputStream}
  import java.util.zip.{CRC32,ZipEntry,ZipInputStream,ZipOutputStream}
  val zis = new ZipInputStream(new FileInputStream(file))
  val tmp = new File(file.getAbsolutePath + "_decompressed")
  val zos = new ZipOutputStream(new FileOutputStream(tmp))
  zos.setMethod(ZipOutputStream.STORED)
  Iterator.continually(zis.getNextEntry).
    takeWhile(ze => ze != null).
    foreach { ze =>
      val baos = new ByteArrayOutputStream
      Iterator.continually(zis.read()).
        takeWhile(-1 !=).
        foreach(baos.write)
      val bytes = baos.toByteArray
      ze.setMethod(ZipEntry.STORED)
      ze.setSize(baos.size)
      ze.setCompressedSize(baos.size)
      val crc = new CRC32
      crc.update(bytes)
      ze.setCrc(crc.getValue)
      zos.putNextEntry(ze)
      zos.write(bytes)
      zos.closeEntry
      zis.closeEntry
    } 
  zos.close
  zis.close
  tmp.renameTo(file)
  file
} 
```

现在，当您`package`在 sbt 中运行时，最终的 jar 文件将被解压缩，您可以使用`unzip -vl path/to/package.jar`.

# batch-file - 为什么这个批处理代码不起作用？

> ID：13483420
> 
> 赞同：1
> 
> 时间：2012-11-20T22:37:51.290
> 
> 标签：batch-file

假设这`%Edata%`是一个这样写的变量，`"A;B;C;1;2;3;"`那么这段代码应该能够将它分成一堆编号的变量：

```
set /a c=0
FOR %%A IN (%Edata%) DO (
  set /a c=%c%+1
  set var%c%=%%A
  echo.^>^>^> Set "%%A" to "var%c%"
) 
```

唯一的结果是将变量的所有部分设置为，`var0`因为`%c%`变量不会像预期的那样每次都计数。有人可以解释为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:54:39.757

此代码有效：

```
@echo off
setlocal EnableDelayedExpansion

set /a c=0
FOR %%A IN (%Edata%) DO (
  set /a c=!c!+1
  set var!c!=%%A
  echo.^>^>^> Set "%%A" to "var!c!"
) 
```

脚本中的问题是默认情况下变量在解析时而不是在执行时扩展。在这种情况下`c`只展开一次，在进入循环之前，这就是为什么它的值总是 0 并且永远不会改变。

您必须在执行时使用以下命令启用变量扩展：

```
setlocal EnableDelayedExpansion 
```

你必须使用！c！而不是 for 循环内的 %c% 。

# javascript - JQuery FadeOut 发生在错误的时间

> ID：13483422
> 
> 赞同：0
> 
> 时间：2012-11-20T22:37:57.350
> 
> 标签：javascript, jquery, css, fadeout

我有以下代码：

```
$(document).ready(function () {

$("#full-btns").children().delay(4000).fadeOut("slow");

$('#full-btns').hover(function() {
      $('#full-btns').children().stop().animate({opacity:'100'});
      $('#full-btns').children().show();

}, function() {
        $("#full-btns").children().fadeOut("slow");

}); 
```

页面加载后，`#full-btns`元素会在淡出之前显示 4000 毫秒。我遇到的问题是，如果用户在元素仍然可见时将其悬停在`#full-btns`元素上，则会导致它淡出，因为`$("#full-btns").children().fadeOut("slow");`在悬停时会调用它。我希望`#full-btns`将鼠标悬停在它上面时始终可见。

当页面加载时，将鼠标悬停在红色 div 上，注意它是如何淡出的。这是不可取的。当悬停在红色 div 上时（当它可见时）它应该保持可见

更新： http: [//jsfiddle.net/gazedge/nhBBc/](http://jsfiddle.net/gazedge/nhBBc/)（现在包括解决方案）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:06:54.640

如果我没有误解这个问题 - 你不能`return false;`在悬停呼叫结束时防止事件冒泡吗？

[http://www.quirksmode.org/js/events_order.html](http://www.quirksmode.org/js/events_order.html)
[http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/](http://fuelyourcoding.com/jquery-events-stop-misusing-return-false/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:32:02.560

使用 setInterval 和 clearInterval；

```
$('#full-btns').hover(function() {

      clearInterval(refreshIntervalId);        
      $('#full-btns').children().stop().animate({opacity:'100'});
      $('#full-btns').children().show();

}, function() { 
        $("#full-btns").children().fadeOut("slow");            
});

var refreshIntervalId = setInterval(function() {
     $("#full-btns").children().fadeOut("slow");
}, 4000); 
```

​</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T09:10:15.033

您唯一需要做的就是在任何人悬停之前清除所有动画。

```
$("#full-btns").children().delay(4000).fadeOut("slow");

    $('#full-btns').hover(function() {
        $('#full-btns').children().stop(true, true);  // Stop the fade-out animation
          $('#full-btns').children().stop().animate({opacity:'100'});
          $('#full-btns').children().show();

    }, function() {
        console.log('fadeOout called');
            $("#full-btns").children().fadeOut("slow"); 

    });​ 
```

[http://jsfiddle.net/nhBBc/5/](http://jsfiddle.net/nhBBc/5/)

**注意：** 第一次悬停时（在代码中）div 淡出不是因为 **$("#full-btns").children().fadeOut("slow");** 但是因为它只是完成了您应用的早期动画。[你的第一行]。

# android - 永远等待 Handler.postDelayed 执行

> ID：13483424
> 
> 赞同：2
> 
> 时间：2012-11-20T22:38:03.150
> 
> 标签：android, multithreading, camera, handler, postdelayed

我正在尝试使用 Android 相机拍照。当程序第一次启动时，我需要等待 1 秒左右，以便可以启动预览并拍摄照片。我用 Handler.postDelayed 做到了，它工作正常。

现在，我的问题是我想暂停程序的流程，直到 run() 被执行，其中我使用了一个带有标志的 while(true) 循环来表示该方法已经完成。但是，程序冻结。没有返回错误。任何人都可以发光吗？下面是我的代码

```
 flag = false;
 handler.postDelayed(new Runnable() { 
             public void run() 
             { 
                 preview.camera.takePicture(shutterCallback, rawCallback, jpegCallback);
                 preview.camera.startPreview();
                 flag = true;
             } 
        }, 1000);

        while (true)
        {
            if (flag) break;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:44:23.390

删除`while(true)`它应该继续，让我解释一下：

Android有一个任务队列，因此当完成当前任务时，它将转到下一个任务，因此在您的情况下，`PostDelayed`将在完成当前任务后执行`Infinity loop`，这将永远不会完成，因为循环阻塞了您`Runnable`的队列.

所以最好的方法是删除`Infinity loop`, 并在您的可运行调用结束时继续您的流程或侦听器的方法。

# javascript - 如何通过数组值递归检查复选框？

> ID：13483426
> 
> 赞同：0
> 
> 时间：2012-11-20T22:38:08.113
> 
> 标签：javascript, html, arrays, checkbox

我会尽量简洁:) 我正在做一个项目。该项目生成许多页面，其中包含缩略图，旁边有复选框。总缩略图的数量可能不同。缩略图被分类为 1000 个项目的 html 页面。所以 1000 个缩略图一个 html 页面。这些充满缩略图的页面由父 html 页面通过 iframe 调用。我的目标是让用户能够检查这些缩略图附近的复选框，然后将新页面加载到 iframe 中，那里的复选框，然后能够将上一页加载到 iframe 中，并让 javascript 检查框用户之前检查过。我使用数组跟踪用户检查了哪些复选框。

这是javascript。有两个问题！第一个问题是，我在那里有调试警报。它确实会提醒正确的值，但会提醒存储在数组中的所有值。我希望它只提醒 iframe 页面中存在的复选框，这就是为什么我将它放在 document.getElementByNames 中的原因。然后......它不检查任何框！没有框检查:(

关于如何做到这一点的任何想法？JS和HTML如下...

JS

```
function repGenChk(valNam) {
  var chkN = valNam.name;
  parent.genL.push(chkN);
  alert(parent.genL);
}
function chkSet() {
  for (var i = 0; i < parent.genL.length; i++) {
  var item = parent.genL[i];
  var item = document.getElementsByName(item);
  if (item != null) { document.getElementsByName(item).checked=true; }
  alert(parent.genL[i]);
}}

window.onload = chkSet(); 
```

HTML

```
<input type="checkbox" onClick="repGenChk(this);" value="1" name="1">
<input type="checkbox" onClick="repGenChk(this);" value="2" name="2">
<input type="checkbox" onClick="repGenChk(this);" value="3" name="3">
<input type="checkbox" onClick="repGenChk(this);" value="4" name="4">
so on and so forth for Xthousands of checkboxes.... 
```

非常欢迎任何想法、想法、建设性的批评和批评！过去我得到了很多 jQuery 建议，我开始认真考虑它。

非常感谢大家！

编辑 - 我能够弄清楚。我不认为我可以使用带有复选框的 ID，我可以。哇！

JS

```
function repGenChk(valNam) {
var chkN = valNam.id;
parent.genL.push(chkN);
alert(parent.genL);
}
window.onload = function chkSet() {
for (var i = 0; i < parent.genL.length; i++) {
if (document.getElementById(parent.genL[i]) != null) {     document.getElementById(parent.genL[i]).checked=true; }
}
} 
```

HTML

```
<input type="checkbox" onClick="repGenChk(this);" id="1">
<input type="checkbox" onClick="repGenChk(this);" id="2">
<input type="checkbox" onClick="repGenChk(this);" id="3">
<input type="checkbox" onClick="repGenChk(this);" id="4">
etc etc etc..... 
```

:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:59:49.687

考虑在包含复选框的元素上放置一个单击侦听器。给每个复选框一个唯一的 ID 或名称。当您单击容器时，请检查它的来源。如果它来自一个复选框，则将复选框的名称/ID 添加或删除到一个对象，该对象存储根据复选框是否被选中而被选中的对象。

当您想重新检查它们时，迭代对象（使用 for..in）并使用`getElementById`or`getElementsByName(…)[0]`来检查复选框。这样，您只需迭代与选中复选框一样多的对象属性，`getElementById`而且速度非常快，因此事情应该更简单、更快。

顺便说一句，[getElementsByName](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-71555259)返回一个[collection](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-75708506)，它类似于数组，但它不是数组。

# windows - Windows Logo Kit v1.6 - Win7 测试驱动

> ID：13483427
> 
> 赞同：2
> 
> 时间：2012-11-20T22:38:10.187
> 
> 标签：windows, driver, windows-kernel

我已被分配下载并安装 Windows Logo Kit v1.6 以测试 Windows 7 的驱动程序。到目前为止，我所做的是在干净的 Windows 2008 R2 64 位机器上安装控制器和工作室。我还有另一个干净的 Windows 7 Pro 32 位作为客户端。安装后，客户端计算机会显示在 Studio 中。

下一步是在客户端 PC 上安装驱动程序。我试过用谷歌搜索这部分的文档，但我没有找到任何文档。

1.  如何在客户端 PC 上安装驱动程序？我只是按照我一贯的方式安装它，还是需要遵循特殊的程序？

2.  在工作室，有很多测试要运行。我怎么知道选择哪个测试？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:49:13.543

我真的不明白问题出在哪里，尤其是因为`DTM.chm`我很清楚该做什么、如何做以及何时做。如果您已设置 DTM 控制器和客户端并将客户端注册到“机器池”中，则基本步骤是在 DTM 控制器上打开 DTM Studio，然后（引用[在线文档](http://msdn.microsoft.com/en-us/library/ff566924.aspx)）：

1.  打开驱动程序测试管理器 (DTM) Studio。
2.  在**Explorers**菜单上，单击**Device Console**。
3.  选择**按提交查看**。
4.  在**提交**控件中，单击**新建提交**。将出现**创建新提交向导**。
5.  在“**选择操作系统**”对话框中，单击客户端上安装的 Windows 操作系统，然后单击**“下一步”**。
6.  在“**选择类别**”窗口中，单击 ...

...这是否取决于您的驾驶员等级等。因此，如果没有精致的问题，就没有精致的答案。

无论如何，请跳过几步：

*   键入 INF 文件的路径，然后单击加载。您还可以使用**浏览**按钮来查找您的 INF 文件。

...这是您选择您的 - 希望是正确和经过测试的 - INF 文件的地方，其余的再次取决于您想要实现的目标。

如果您订阅了 MSDN，那么您每年还会有许多“免费”的支持事件，如果您被困在这里，这可能是个好主意。但是，到目前为止，文档足够合理，可以帮助我们完成...

**再次注意：**整个过程取决于您的驱动程序类。

**另请注意：**有一个***勘误表***（Microsoft 的术语）列表。确保这些是最新的并且没有过期，因为如果您有一个有特殊需求的驱动程序类，一些测试可能会失败，您需要选择适用于您的驱动程序的*勘误表*，然后才能达到所需的 100% 结果得到它交叉签名。虽然我们不执行完整的 Windows 徽标过程，但 DTM 部分应该是相同的。

# algorithm - 如何使四舍五入的百分比加起来等于 100%

> ID：13483430
> 
> 赞同：239
> 
> 时间：2012-11-20T22:38:55.757
> 
> 标签：algorithm, math, rounding, percentage

考虑下面的四个百分比，用`float`数字表示：

```
 13.626332%
    47.989636%
     9.596008%
    28.788024%
   -----------
   100.000000% 
```

我需要将这些百分比表示为整数。如果我简单地使用`Math.round()`，我最终得到 101%。

```
14 + 48 + 10 + 29 = 101 
```

如果我使用`parseInt()`，我最终得到 97%。

```
13 + 47 + 9 + 28 = 97 
```

将任意数量的百分比表示为整数同时仍保持总数为 100% 的好算法是什么？

* * *

**编辑**：在阅读了一些评论和答案之后，显然有很多方法可以解决这个问题。

在我看来，为了保持数字的真实性，“正确”的结果是最小化整体误差的结果，由相对于实际值引入多少误差来定义：

```
 value  rounded     error               decision
   ----------------------------------------------------
    13.626332       14      2.7%          round up (14)
    47.989636       48      0.0%          round up (48)
     9.596008       10      4.0%    don't round up  (9)
    28.788024       29      2.7%          round up (29) 
```

在平局（3.33、3.33、3.33）的情况下，可以做出任意决定（例如，3、4、3）。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2012-11-20T23:02:02.223

有很多方法可以做到这一点，只要您不担心对原始十进制数据的依赖。

第一种也许是最流行的方法是[最大余数法](http://en.wikipedia.org/wiki/Largest_remainder_method)

基本上是：

1.  四舍五入
2.  获得总和和 100 的差值
3.  通过按小数部分的降序向项目添加 1 来分配差异

在你的情况下，它会是这样的：

```
13.626332%
47.989636%
 9.596008%
28.788024% 
```

如果你取整数部分，你会得到

```
13
47
 9
28 
```

加起来是 97，你想再加三个。现在，你看看小数部分，它们是

```
.626332%
.989636%
.596008%
.788024% 
```

并取最大的，直到总数达到 100。所以你会得到：

```
14
48
 9
29 
```

或者，您可以简单地选择显示一位小数而不是整数值。所以数字将是 48.3 和 23.9 等。这将使方差从 100 下降很多。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2012-11-20T22:43:54.520

可能执行此操作的“最佳”方法（引用，因为“最佳”是一个主观术语）是保持对您所在位置的运行（非整数）计数，然后*将该*值四舍五入。

然后将其与历史一起使用来确定应该使用什么值。例如，使用您提供的值：

```
Value      CumulValue  CumulRounded  PrevBaseline  Need
---------  ----------  ------------  ------------  ----
                                  0
13.626332   13.626332            14             0    14 ( 14 -  0)
47.989636   61.615968            62            14    48 ( 62 - 14)
 9.596008   71.211976            71            62     9 ( 71 - 62)
28.788024  100.000000           100            71    29 (100 - 71)
                                                    ---
                                                    100 
```

在每个阶段，您都不会对数字本身进行四舍五入。相反，您将*累积*值四舍五入并计算出从前一个基线达到该值的最佳整数 - 该基线是前一行的累积值（四舍五入）。

这是有效的，因为您*不会*在每个阶段丢失信息，而是更智能地使用信息。“正确”的舍入值位于最后一列，您可以看到它们的总和为 100。

您可以在上面的第三个值中看到这与盲目四舍五入每个值之间的区别。虽然`9.596008`通常会四舍五入`10`，但累积的`71.211976`正确四舍五入到`71`- 这意味着只`9`需要添加到之前的基线`62`。

* * *

这也适用于“有问题的”序列，例如三个粗略值，其中*一个*应该四舍五入：`¹/[3]`

 *```
Value      CumulValue  CumulRounded  PrevBaseline  Need
---------  ----------  ------------  ------------  ----
                                  0
33.333333   33.333333            33             0    33 ( 33 -  0)
33.333333   66.666666            67            33    34 ( 67 - 33)
33.333333   99.999999           100            67    33 (100 - 67)
                                                    ---
                                                    100 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2012-11-21T03:27:55.510

[由于这里的答案似乎都没有正确解决它，这是我使用underscorejs](http://underscorejs.org/)的半混淆版本：

```
function foo(l, target) {
    var off = target - _.reduce(l, function(acc, x) { return acc + Math.round(x) }, 0);
    return _.chain(l).
            sortBy(function(x) { return Math.round(x) - x }).
            map(function(x, i) { return Math.round(x) + (off > i) - (i >= (l.length + off)) }).
            value();
}

foo([13.626332, 47.989636, 9.596008, 28.788024], 100) // => [48, 29, 14, 9]
foo([16.666, 16.666, 16.666, 16.666, 16.666, 16.666], 100) // => [17, 17, 17, 17, 16, 16]
foo([33.333, 33.333, 33.333], 100) // => [34, 33, 33]
foo([33.3, 33.3, 33.3, 0.1], 100) // => [34, 33, 33, 0] 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2016-01-23T05:30:01.850

舍入的目标是产生最少的错误。当您对单个值进行四舍五入时，该过程简单明了，大多数人都很容易理解。当您同时对多个数字进行四舍五入时，该过程变得更加棘手——您必须定义错误将如何组合，即必须最小化什么。

[Varun Vohra 投票赞成的答案](https://stackoverflow.com/a/13483710/5987)最大限度地减少了绝对误差的总和，并且实现起来非常简单。但是有一些边缘情况它不能处理——四舍五入的结果应该是什么`24.25, 23.25, 27.25, 25.25`？其中之一需要向上取整而不是向下取整。您可能会随意选择列表中的第一个或最后一个。

也许最好使用*相对*误差而不是*绝对*误差。将 23.25 向上舍入为 24 将其更改为 3.2%，而将 27.25 向上舍入为 28 仅将其更改为 2.8%。现在有一个明显的赢家。

可以进一步调整它。一种常见的技术是对每个错误进行*平方*，以便大错误比小错误更不成比例。我还会使用非线性除数来获得相对误差 - 1% 的误差比 99% 的误差重要 99 倍似乎是不对的。在下面的代码中，我使用了平方根。

完整的算法如下：

1.  在四舍五入后将百分比相加，然后从 100 中减去。这告诉您这些百分比中有多少必须四舍五入。
2.  为每个百分比生成两个错误分数，一个在向下舍入时，一个在向上舍入时。拿两者的区别。
3.  对上面产生的误差差异进行排序。
4.  对于需要向上取整的百分比数，从排序列表中取一个项目并将向下取整的百分比增加 1。

您可能仍然有多个组合具有相同的错误总和，例如`33.3333333, 33.3333333, 33.3333333`. 这是不可避免的，结果将是完全任意的。我在下面给出的代码更喜欢对左侧的值进行四舍五入。

将它们放在 Python 中看起来像这样。

```
from math import isclose, sqrt

def error_gen(actual, rounded):
    divisor = sqrt(1.0 if actual < 1.0 else actual)
    return abs(rounded - actual) ** 2 / divisor

def round_to_100(percents):
    if not isclose(sum(percents), 100):
        raise ValueError
    n = len(percents)
    rounded = [int(x) for x in percents]
    up_count = 100 - sum(rounded)
    errors = [(error_gen(percents[i], rounded[i] + 1) - error_gen(percents[i], rounded[i]), i) for i in range(n)]
    rank = sorted(errors)
    for i in range(up_count):
        rounded[rank[i][1]] += 1
    return rounded

>>> round_to_100([13.626332, 47.989636, 9.596008, 28.788024])
[14, 48, 9, 29]
>>> round_to_100([33.3333333, 33.3333333, 33.3333333])
[34, 33, 33]
>>> round_to_100([24.25, 23.25, 27.25, 25.25])
[24, 23, 28, 25]
>>> round_to_100([1.25, 2.25, 3.25, 4.25, 89.0])
[1, 2, 3, 4, 90] 
```

正如您在最后一个示例中看到的那样，该算法仍然能够提供非直观的结果。尽管 89.0 不需要四舍五入，但该列表中的一个值需要四舍五入；最小的相对误差来自于对那个大值而不是更小的替代值进行四舍五入。

这个答案最初主张通过向上/向下舍入的所有可能组合，但正如评论中指出的那样，更简单的方法效果更好。算法和代码反映了这种简化。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2016-01-18T00:55:47.967

我写了一个 C# 版本的舍入助手，算法与[Varun Vohra 的答案](https://stackoverflow.com/a/13483710/1745885)相同，希望对您有所帮助。

```
public static List<decimal> GetPerfectRounding(List<decimal> original,
    decimal forceSum, int decimals)
{
    var rounded = original.Select(x => Math.Round(x, decimals)).ToList();
    Debug.Assert(Math.Round(forceSum, decimals) == forceSum);
    var delta = forceSum - rounded.Sum();
    if (delta == 0) return rounded;
    var deltaUnit = Convert.ToDecimal(Math.Pow(0.1, decimals)) * Math.Sign(delta);

    List<int> applyDeltaSequence; 
    if (delta < 0)
    {
        applyDeltaSequence = original
            .Zip(Enumerable.Range(0, int.MaxValue), (x, index) => new { x, index })
            .OrderBy(a => original[a.index] - rounded[a.index])
            .ThenByDescending(a => a.index)
            .Select(a => a.index).ToList();
    }
    else
    {
        applyDeltaSequence = original
            .Zip(Enumerable.Range(0, int.MaxValue), (x, index) => new { x, index })
            .OrderByDescending(a => original[a.index] - rounded[a.index])
            .Select(a => a.index).ToList();
    }

    Enumerable.Repeat(applyDeltaSequence, int.MaxValue)
        .SelectMany(x => x)
        .Take(Convert.ToInt32(delta/deltaUnit))
        .ForEach(index => rounded[index] += deltaUnit);

    return rounded;
} 
```

它通过了以下单元测试：

```
[TestMethod]
public void TestPerfectRounding()
{
    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> {3.333m, 3.334m, 3.333m}, 10, 2),
        new List<decimal> {3.33m, 3.34m, 3.33m});

    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> {3.33m, 3.34m, 3.33m}, 10, 1),
        new List<decimal> {3.3m, 3.4m, 3.3m});

    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> {3.333m, 3.334m, 3.333m}, 10, 1),
        new List<decimal> {3.3m, 3.4m, 3.3m});

    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> { 13.626332m, 47.989636m, 9.596008m, 28.788024m }, 100, 0),
        new List<decimal> {14, 48, 9, 29});
    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> { 16.666m, 16.666m, 16.666m, 16.666m, 16.666m, 16.666m }, 100, 0),
        new List<decimal> { 17, 17, 17, 17, 16, 16 });
    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> { 33.333m, 33.333m, 33.333m }, 100, 0),
        new List<decimal> { 34, 33, 33 });
    CollectionAssert.AreEqual(Utils.GetPerfectRounding(
        new List<decimal> { 33.3m, 33.3m, 33.3m, 0.1m }, 100, 0),
        new List<decimal> { 34, 33, 33, 0 });
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-11-20T22:53:26.047

不要对四舍五入的数字求和。你会得到不准确的结果。根据术语的数量和小数部分的分布，总数可能会显着下降。

*显示*四舍五入的数字，但对实际值*求和。*根据您呈现数字的方式，执行此操作的实际方式会有所不同。这样你得到

> ```
> 14
>  48
>  10
>  29
>  __
> 100
> ```

无论你走哪条路，你都会有差异。在您的示例中，如果不以错误的方式“四舍五入”一个值，则无法显示加起来为 100 的数字（最小错误是将 9.596 更改为 9）

编辑

您需要在以下选项之一中进行选择：

1.  项目的准确性
2.  总和的准确性（如果您要对四舍五入的值求和）
3.  四舍五入的项目与四舍五入的总和之间的一致性）

大多数情况下，处理百分比 #3 是最佳选择，因为总和等于 101% 时比单个项目的总和不等于 100 时更明显，并且您保持单个项目准确。在我看来，“四舍五入”9.596 到 9 是不准确的。

为了解释这一点，我有时会添加一个脚注，解释各个值是四舍五入的，可能不是 100% - 任何了解四舍五入的人都应该能够理解该解释。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2012-11-20T22:50:22.153

您可以尝试跟踪由于四舍五入导致的错误，然后如果累积的错误大于当前数字的小数部分，则对纹理进行四舍五入。

```
13.62 -> 14 (+.38)
47.98 -> 48 (+.02 (+.40 total))
 9.59 -> 10 (+.41 (+.81 total))
28.78 -> 28 (round down because .81 > .78)
------------
        100 
```

不确定这是否能正常工作，但如果顺序颠倒，它似乎工作相似：

```
28.78 -> 29 (+.22)
 9.59 ->  9 (-.37; rounded down because .59 > .22)
47.98 -> 48 (-.35)
13.62 -> 14 (+.03)
------------
        100 
```

我确信在某些极端情况下这可能会失败，但任何方法都至少会有些武断，因为您基本上是在修改输入数据。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-11-20T23:38:46.453

我不确定您需要什么级别的准确度，但我要做的只是将第一个`n`数字加 1，`n`即小数总和的上限。在这种情况下，`3`我会在前 3 个项目中添加 1，然后将其余项目放在地板上。当然这不是非常准确，一些数字可能会在不应该的时候向上或向下四舍五入，但它可以正常工作，并且总是会导致 100%。

所以`[ 13.626332, 47.989636, 9.596008, 28.788024 ]`会是`[14, 48, 10, 28]`因为`Math.ceil(.626332+.989636+.596008+.788024) == 3`

```
function evenRound( arr ) {
  var decimal = -~arr.map(function( a ){ return a % 1 })
    .reduce(function( a,b ){ return a + b }); // Ceil of total sum of decimals
  for ( var i = 0; i < decimal; ++i ) {
    arr[ i ] = ++arr[ i ]; // compensate error by adding 1 the the first n items
  }
  return arr.map(function( a ){ return ~~a }); // floor all other numbers
}

var nums = evenRound( [ 13.626332, 47.989636, 9.596008, 28.788024 ] );
var total = nums.reduce(function( a,b ){ return a + b }); //=> 100 
```

您可以随时通知用户这些数字是四舍五入的，可能不是超级准确...

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-11-21T00:01:46.540

我曾经写过一个不完整的工具，用来找到一组数字的最小扰动来匹配一个目标。这是一个不同的问题，但理论上可以在这里使用类似的想法。在这种情况下，我们有一组选择。

因此，对于第一个元素，我们可以将其向上舍入到 14，或向下舍入到 13。这样做的成本（在二进制整数编程意义上）向上舍入比向下舍入要小，因为向下舍入需要我们将该值移动更大的距离。同样，我们可以将每个数字向上或向下取整，因此我们必须从总共 16 个选项中进行选择。

```
 13.626332
  47.989636
   9.596008
+ 28.788024
-----------
 100.000000 
```

我通常会在 MATLAB 中解决一般问题，这里使用二进制整数编程工具 bintprog，但只有少数选择需要测试，因此使用简单的循环来测试 16 个备选方案中的每一个都很容易。例如，假设我们要将这个集合四舍五入为：

```
 Original      Rounded   Absolute error
   13.626           13          0.62633
    47.99           48          0.01036
    9.596           10          0.40399
 + 28.788           29          0.21198
---------------------------------------
  100.000          100          1.25266 
```

产生的总绝对误差为 1.25266。可以通过以下替代舍入稍微减少它：

```
 Original      Rounded   Absolute error
   13.626           14          0.37367
    47.99           48          0.01036
    9.596            9          0.59601
 + 28.788           29          0.21198
---------------------------------------
  100.000          100          1.19202 
```

事实上，这将是绝对误差的最佳解决方案。当然，如果有 20 个词，则搜索空间的大小将是 2^20 = 1048576。对于 30 或 40 个词，该空间将非常大。在这种情况下，您将需要使用可以有效搜索空间的工具，可能使用分支定界方案。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-11-21T00:11:47.453

我认为以下将实现您所追求的

```
function func( orig, target ) {

    var i = orig.length, j = 0, total = 0, change, newVals = [], next, factor1, factor2, len = orig.length, marginOfErrors = [];

    // map original values to new array
    while( i-- ) {
        total += newVals[i] = Math.round( orig[i] );
    }

    change = total < target ? 1 : -1;

    while( total !== target ) {

        // Iterate through values and select the one that once changed will introduce
        // the least margin of error in terms of itself. e.g. Incrementing 10 by 1
        // would mean an error of 10% in relation to the value itself.
        for( i = 0; i < len; i++ ) {

            next = i === len - 1 ? 0 : i + 1;

            factor2 = errorFactor( orig[next], newVals[next] + change );
            factor1 = errorFactor( orig[i], newVals[i] + change );

            if(  factor1 > factor2 ) {
                j = next; 
            }
        }

        newVals[j] += change;
        total += change;
    }

    for( i = 0; i < len; i++ ) { marginOfErrors[i] = newVals[i] && Math.abs( orig[i] - newVals[i] ) / orig[i]; }

    // Math.round() causes some problems as it is difficult to know at the beginning
    // whether numbers should have been rounded up or down to reduce total margin of error. 
    // This section of code increments and decrements values by 1 to find the number
    // combination with least margin of error.
    for( i = 0; i < len; i++ ) {
        for( j = 0; j < len; j++ ) {
            if( j === i ) continue;

            var roundUpFactor = errorFactor( orig[i], newVals[i] + 1)  + errorFactor( orig[j], newVals[j] - 1 );
            var roundDownFactor = errorFactor( orig[i], newVals[i] - 1) + errorFactor( orig[j], newVals[j] + 1 );
            var sumMargin = marginOfErrors[i] + marginOfErrors[j];

            if( roundUpFactor < sumMargin) { 
                newVals[i] = newVals[i] + 1;
                newVals[j] = newVals[j] - 1;
                marginOfErrors[i] = newVals[i] && Math.abs( orig[i] - newVals[i] ) / orig[i];
                marginOfErrors[j] = newVals[j] && Math.abs( orig[j] - newVals[j] ) / orig[j];
            }

            if( roundDownFactor < sumMargin ) { 
                newVals[i] = newVals[i] - 1;
                newVals[j] = newVals[j] + 1;
                marginOfErrors[i] = newVals[i] && Math.abs( orig[i] - newVals[i] ) / orig[i];
                marginOfErrors[j] = newVals[j] && Math.abs( orig[j] - newVals[j] ) / orig[j];
            }

        }
    }

    function errorFactor( oldNum, newNum ) {
        return Math.abs( oldNum - newNum ) / oldNum;
    }

    return newVals;
}

func([16.666, 16.666, 16.666, 16.666, 16.666, 16.666], 100); // => [16, 16, 17, 17, 17, 17]
func([33.333, 33.333, 33.333], 100); // => [34, 33, 33]
func([33.3, 33.3, 33.3, 0.1], 100); // => [34, 33, 33, 0] 
func([13.25, 47.25, 11.25, 28.25], 100 ); // => [13, 48, 11, 28]
func( [25.5, 25.5, 25.5, 23.5], 100 ); // => [25, 25, 26, 24] 
```

最后一件事，我使用问题中最初给出的数字运行该函数，以与所需的输出进行比较

```
func([13.626332, 47.989636, 9.596008, 28.788024], 100); // => [48, 29, 13, 10] 
```

这与问题想要的不同=> [48、29、14、9]。在我查看总误差范围之前我无法理解这一点

```
-------------------------------------------------
| original  | question | % diff | mine | % diff |
-------------------------------------------------
| 13.626332 | 14       | 2.74%  | 13   | 4.5%   |
| 47.989636 | 48       | 0.02%  | 48   | 0.02%  |
| 9.596008  | 9        | 6.2%   | 10   | 4.2%   |
| 28.788024 | 29       | 0.7%   | 29   | 0.7%   |
-------------------------------------------------
| Totals    | 100      | 9.66%  | 100  | 9.43%  |
------------------------------------------------- 
```

本质上，我的函数的结果实际上引入了最少的错误。

[在这里](http://jsfiddle.net/bruno/4DU2H/1/)提琴

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-10-01T18:42:58.843

[我对Varun Vohra 投票赞成的答案的](https://stackoverflow.com/a/13483710/5987)JS 实现

```
const set1 = [13.626332, 47.989636, 9.596008, 28.788024];
// const set2 = [24.25, 23.25, 27.25, 25.25];

const values = set1;

console.log('Total: ', values.reduce((accum, each) => accum + each));
console.log('Incorrectly Rounded: ', 
  values.reduce((accum, each) => accum + Math.round(each), 0));

const adjustValues = (values) => {
  // 1\. Separate integer and decimal part
  // 2\. Store both in a new array of objects sorted by decimal part descending
  // 3\. Add in original position to "put back" at the end
  const flooredAndSortedByDecimal = values.map((value, position) => (
    {
        floored: Math.floor(value),
        decimal: value - Number.parseInt(value),
        position
    }
  )).sort(({decimal}, {decimal: otherDecimal}) => otherDecimal - decimal);

  const roundedTotal = values.reduce((total, value) => total + Math.floor(value), 0);
  let availableForDistribution = 100 - roundedTotal;

  // Add 1 to each value from what's available
  const adjustedValues = flooredAndSortedByDecimal.map(value => {
    const { floored, ...rest } = value;
    let finalPercentage = floored;
    if(availableForDistribution > 0){
        finalPercentage = floored + 1;
        availableForDistribution--;
    }

    return {
        finalPercentage,
        ...rest
    }
  });

  // Put back and return the new values
  return adjustedValues
    .sort(({position}, {position: otherPosition}) => position - otherPosition)
    .map(({finalPercentage}) => finalPercentage);
}

const finalPercentages = adjustValues(values);
console.log({finalPercentages})

// { finalPercentage: [14, 48, 9, 29]} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-09-26T14:26:11.050

**如果您只有两个选项**，您可以使用`Math.round()`。唯一有问题的值对是 X.5（例如 37.5 和 62.5），它会将两个值四舍五入，您最终会得到`101%`，您可以在这里尝试：

[https://jsfiddle.net/f8np1t0k/2/](https://jsfiddle.net/f8np1t0k/2/)

由于您需要始终显示 100%，您只需从其中删除一个百分比，例如在第一个

`const correctedARounded = Number.isInteger(aRounded-0.5) ? a - 1 : a`

或者，您可以支持具有更多 % 票数的选项。

对于 1-100 个值对之间的 10k 次除法，1% diff 的错误发生了 114 次。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-02-16T09:42:10.493

**注意：**选择的答案是更改不首选的数组顺序，在这里我提供了更多不同的变体，以实现相同的结果并保持数组的顺序

# 讨论

鉴于`[98.88, .56, .56]`你想如何舍入它？你有四个选择

1-四舍五入并从其余数字中减去添加的内容，因此结果变为`[98, 1, 1]`

这可能是一个很好的答案，但如果我们有`[97.5, .5, .5, .5, .5, .5]`呢？那么你需要把它四舍五入到`[95, 1, 1, 1, 1, 1]`

你知道它是怎么回事吗？如果您添加更多类似 0 的数字，您将失去其他数字的更多价值。当你有一大堆类似零的数字时，这可能会非常麻烦，比如`[40, .5, .5 , ... , .5]`. 当你四舍五入时，你可能会得到一系列的：`[1, 1, .... , 1]`

所以围捕不是一个好的选择。

2-你把数字四舍五入。所以`[98.88, .56, .56]`变成`[98, 0, 0]`，那么你比 100 少 2。你忽略任何已经是 0 的东西，然后将差值加到最大的数字上。所以更大的数字会得到更多。

3- 与前面相同，向下舍入数字，但您根据小数降序排序，根据小数除以差异，因此最大的小数将获得差异。

4-你四舍五入，但你将你添加的内容添加到下一个数字。所以就像波浪一样，您添加的内容将被重定向到数组的末尾。所以`[98.88, .56, .56]`变成`[99, 0, 1]`

这些都不是理想的，因此请注意您的数据将失去其形状。

在这里，我提供了案例 2 和 3 的代码（因为当您有很多类似零的数字时，案例 1 不实用）。它是现代 Js，不需要使用任何库

# 第二种情况

```
const v1 = [13.626332, 47.989636, 9.596008, 28.788024];// => [ 14, 48, 9, 29 ]
const v2 = [16.666, 16.666, 16.666, 16.666, 16.666, 16.666] // => [ 17, 17, 17, 17, 16, 16 ] 
const v3 = [33.333, 33.333, 33.333] // => [ 34, 33, 33 ]
const v4 = [33.3, 33.3, 33.3, 0.1] // => [ 34, 33, 33, 0 ]
const v5 = [98.88, .56, .56] // =>[ 100, 0, 0 ]
const v6 = [97.5, .5, .5, .5, .5, .5] // => [ 100, 0, 0, 0, 0, 0 ]

const normalizePercentageByNumber = (input) => {
    const rounded: number[] = input.map(x => Math.floor(x));
    const afterRoundSum = rounded.reduce((pre, curr) => pre + curr, 0);
    const countMutableItems = rounded.filter(x => x >=1).length;
    const errorRate = 100 - afterRoundSum;

    const deductPortion = Math.ceil(errorRate / countMutableItems);

    const biggest = [...rounded].sort((a, b) => b - a).slice(0, Math.min(Math.abs(errorRate), countMutableItems));
    const result = rounded.map(x => {
        const indexOfX = biggest.indexOf(x);
        if (indexOfX >= 0) {
            x += deductPortion;
            console.log(biggest)
            biggest.splice(indexOfX, 1);
            return x;
        }
        return x;
    });
    return result;
} 
```

# 第三种情况

```
const normalizePercentageByDecimal = (input: number[]) => {

    const rounded= input.map((x, i) => ({number: Math.floor(x), decimal: x%1, index: i }));

    const decimalSorted= [...rounded].sort((a,b)=> b.decimal-a.decimal);

    const sum = rounded.reduce((pre, curr)=> pre + curr.number, 0) ;
    const error= 100-sum;

    for (let i = 0; i < error; i++) {
        const element = decimalSorted[i];
        element.number++;
    }

    const result= [...decimalSorted].sort((a,b)=> a.index-b.index);

    return result.map(x=> x.number);
} 
```

# 第四种情况

您只需要计算在每次汇总中为您的数字添加或减少了多少额外空气，然后在下一项中再次添加或减去它。

```
const v1 = [13.626332, 47.989636, 9.596008, 28.788024];// => [14, 48, 10, 28 ]
const v2 = [16.666, 16.666, 16.666, 16.666, 16.666, 16.666] // => [17, 16, 17, 16, 17, 17]
const v3 = [33.333, 33.333, 33.333] // => [33, 34, 33]
const v4 = [33.3, 33.3, 33.3, 0.1] // => [33, 34, 33, 0]

const normalizePercentageByWave= v4.reduce((pre, curr, i, arr) => {

    let number = Math.round(curr + pre.decimal);
    let total = pre.total + number;

    const decimal = curr - number;

    if (i == arr.length - 1 && total < 100) {
        const diff = 100 - total;
        total += diff;
        number += diff;
    }

    return { total, numbers: [...pre.numbers, number], decimal };

}, { total: 0, numbers: [], decimal: 0 }); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-11-20T22:44:07.637

如果您正在舍入它，则没有好的方法可以在所有情况下都完全相同。

您可以取 N 个百分比的小数部分（在您给出的示例中为 4）。

添加小数部分。在您的示例中，总小数部分 = 3。

将分数最高的 3 个数字设置为上限，其余的设置为下限。

（抱歉编辑）

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-12-28T13:13:58.410

如果你真的必须舍入它们，这里已经有很好的建议（最大的余数，最小的相对误差，等等）。

还有一个很好的理由不四舍五入（你会得到至少一个“看起来更好”但“错误”的数字），以及如何解决这个问题（警告你的读者），这就是我所做的。

让我补充一下“错误”的数字部分。

假设您有三个事件/实体/...，其中一些百分比近似为：

```
DAY 1
who |  real | app
----|-------|------
  A | 33.34 |  34
  B | 33.33 |  33
  C | 33.33 |  33 
```

后来值略有变化，到

```
DAY 2
who |  real | app
----|-------|------
  A | 33.35 |  33
  B | 33.36 |  34
  C | 33.29 |  33 
```

第一个表存在已经提到的“错误”数字的问题：33.34 更接近 33 而不是 34。

但是现在你有一个更大的错误。比较第 2 天和第 1 天，A 的实际百分比值增加了 0.01%，但近似值显示减少了 1%。

这是一个定性错误，可能比最初的定量错误更糟糕。

可以为整个集合设计一个近似值，但是，您可能必须在第一天发布数据，因此您将不知道第二天的情况。所以，除非你真的，真的，必须近似，你最好不要。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-11-04T02:41:09.923

或者为了简洁起见，您只是在其中累积错误...

```
const p = [13.626332, 47.989636, 9.596008, 28.788024];
const round = (a, e = 0) => a.map(x => (r = Math.round(x + e), e += x - r, r));
console.log(round(p)); 
```

结果：**[14、48、9、29]**

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-12-31T03:24:09.337

这是一个实现最大余数方法的 Ruby gem： [https ://github.com/jethroo/lare_round](https://github.com/jethroo/lare_round)

要使用：

```
a =  Array.new(3){ BigDecimal('0.3334') }
# => [#<BigDecimal:887b6c8,'0.3334E0',9(18)>, #<BigDecimal:887b600,'0.3334E0',9(18)>, #<BigDecimal:887b4c0,'0.3334E0',9(18)>]
a = LareRound.round(a,2)
# => [#<BigDecimal:8867330,'0.34E0',9(36)>, #<BigDecimal:8867290,'0.33E0',9(36)>, #<BigDecimal:88671f0,'0.33E0',9(36)>]
a.reduce(:+).to_f
# => 1.0 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-04-12T05:56:40.947

这是@varun-vohra 答案的更简单的 Python 实现：

```
def apportion_pcts(pcts, total):
    proportions = [total * (pct / 100) for pct in pcts]
    apportions = [math.floor(p) for p in proportions]
    remainder = total - sum(apportions)
    remainders = [(i, p - math.floor(p)) for (i, p) in enumerate(proportions)]
    remainders.sort(key=operator.itemgetter(1), reverse=True)
    for (i, _) in itertools.cycle(remainders):
        if remainder == 0:
            break
        else:
            apportions[i] += 1
            remainder -= 1
    return apportions 
```

你需要`math`, `itertools`, `operator`.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-07-31T06:50:50.903

就我的测试用例而言，检查这是否有效，我能够使其正常工作。

假设数字是k；

1.  按降序排列百分比。
2.  从降序遍历每个百分比。
3.  计算第一个百分比的 k 百分比取输出的 Math.Ceil。
4.  下一个 k = k-1
5.  迭代直到消耗完所有百分比。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-09-13T22:34:47.657

我已经为列表和字典实现了 Varun Vohra's answer here 中的方法。

```
import math
import numbers
import operator
import itertools

def round_list_percentages(number_list):
    """
    Takes a list where all values are numbers that add up to 100,
    and rounds them off to integers while still retaining a sum of 100.

    A total value sum that rounds to 100.00 with two decimals is acceptable.
    This ensures that all input where the values are calculated with [fraction]/[total]
    and the sum of all fractions equal the total, should pass.
    """
    # Check input
    if not all(isinstance(i, numbers.Number) for i in number_list):
        raise ValueError('All values of the list must be a number')

    # Generate a key for each value
    key_generator = itertools.count()
    value_dict = {next(key_generator): value for value in number_list}
    return round_dictionary_percentages(value_dict).values()

def round_dictionary_percentages(dictionary):
    """
    Takes a dictionary where all values are numbers that add up to 100,
    and rounds them off to integers while still retaining a sum of 100.

    A total value sum that rounds to 100.00 with two decimals is acceptable.
    This ensures that all input where the values are calculated with [fraction]/[total]
    and the sum of all fractions equal the total, should pass.
    """
    # Check input
    # Only allow numbers
    if not all(isinstance(i, numbers.Number) for i in dictionary.values()):
        raise ValueError('All values of the dictionary must be a number')
    # Make sure the sum is close enough to 100
    # Round value_sum to 2 decimals to avoid floating point representation errors
    value_sum = round(sum(dictionary.values()), 2)
    if not value_sum == 100:
        raise ValueError('The sum of the values must be 100')

    # Initial floored results
    # Does not add up to 100, so we need to add something
    result = {key: int(math.floor(value)) for key, value in dictionary.items()}

    # Remainders for each key
    result_remainders = {key: value % 1 for key, value in dictionary.items()}
    # Keys sorted by remainder (biggest first)
    sorted_keys = [key for key, value in sorted(result_remainders.items(), key=operator.itemgetter(1), reverse=True)]

    # Otherwise add missing values up to 100
    # One cycle is enough, since flooring removes a max value of < 1 per item,
    # i.e. this loop should always break before going through the whole list
    for key in sorted_keys:
        if sum(result.values()) == 100:
            break
        result[key] += 1

    # Return
    return result 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-01-14T16:16:56.070

对于那些在熊猫系列中有百分比的人，这是我对[最大余数方法](https://en.wikipedia.org/wiki/Largest_remainder_method)的实施（如[Varun Vohra 的回答](https://stackoverflow.com/a/13483710/5987)），您甚至可以选择要四舍五入的小数。

```
import numpy as np

def largestRemainderMethod(pd_series, decimals=1):

    floor_series = ((10**decimals * pd_series).astype(np.int)).apply(np.floor)
    diff = 100 * (10**decimals) - floor_series.sum().astype(np.int)
    series_decimals = pd_series - floor_series / (10**decimals)
    series_sorted_by_decimals = series_decimals.sort_values(ascending=False)

    for i in range(0, len(series_sorted_by_decimals)):
        if i < diff:
            series_sorted_by_decimals.iloc[[i]] = 1
        else:
            series_sorted_by_decimals.iloc[[i]] = 0

    out_series = ((floor_series + series_sorted_by_decimals) / (10**decimals)).sort_values(ascending=False)

    return out_series 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2012-11-20T23:03:20.407

这是银行家四舍五入的情况，也就是“四舍五入”。BigDecimal 支持它。其目的是确保四舍五入平衡，即不利于银行或客户。*

# php - php 随机图片文件名

> ID：13483439
> 
> 赞同：7
> 
> 时间：2012-11-20T22:40:04.087
> 
> 标签：php

好的，我使用我在 google 上找到的一个片段来获取用户上传的图像并将其放在我的目录下 Content

但我担心重复，所以我要让它作为随机数上传图像

好吧，这是我的代码，无论如何，您可能都可以理解我的目的

```
<label for="file">Profile Pic:</label> <input type="file" name="ProfilePic" id="ProfilePic" /><br />

<input type="submit" name="submit" value="Submit" />

$ProfilePicName = $_FILES["ProfilePic"]["name"];
$ProfilePicType = $_FILES["ProfilePic"]["type"];
$ProfilePicSize = $_FILES["ProfilePic"]["size"];
$ProfilePicTemp = $_FILES["ProfilePic"]["tmp_name"];
$ProfilePicError = $_FILES["ProfilePic"]["error"];

$RandomAccountNumber = mt_rand(1, 99999);  
echo $RandomAccountNumber; 
move_uploaded_file($ProfilePicTemp, "Content/".$RandomAccountNumber.$ProfilePicType); 
```

然后基本上在这一切之后我会尝试让它把那个随机数放在我的数据库中

有人给了我一个新的片段，看起来它会做我想要的，但现在文件并没有一直到我的目录

```
$RandomAccountNumber = uniqid();
echo $RandomAccountNumber;

move_uploaded_file($ProfilePicName,"Content/".$RandomAccountNumber); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-20T22:41:50.813

尝试使用php`uniqid`方法生成你需要的唯一id

[http://php.net/manual/en/function.uniqid.php](http://php.net/manual/en/function.uniqid.php)

```
$RandomAccountNumber = uniqid();
move_uploaded_file($ProfilePicTemp, "Content/" . $RandomAccountNumber); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T23:00:40.263

这是我在上传图片时使用的：[session_id()](http://php.net/manual/en/function.session-id.php)、[time()](http://php.net/manual/en/function.time.php)和随机字符串的组合：

```
$rand = genRandomString();
$final_filename = $rand."_".session_id()."_".time();

function genRandomString() 
{
    $length = 5;
    $characters = "0123456789ABCDEFGHIJKLMNOPQRSTUVWZYZ";

    $real_string_length = strlen($characters) ;     
    $string="id";

    for ($p = 0; $p < $length; $p++) 
    {
        $string .= $characters[mt_rand(0, $real_string_length-1)];
    }

    return strtolower($string);
} 
```

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-20T22:42:26.893

当我上传图片时，我通常将其保存为`sha1()`图片内容的 ( `sha1_file()`)。这样一来，您就可以得到两只鸟：您永远不会（如果这样做，请填写最接近的彩票）获得重复的文件名，并且您将防止重复的图像（因为重复的图像将具有相同的校验和） .

然后，您有一个数据库来分类哪个图像是哪个图像，并将它们正确地显示给用户。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-20T22:51:26.753

`random != unique`

无论您使用什么方法来生成“随机”文件名，您都可能希望这样做以避免冲突。

```
$path = '/path/to/directory/';
do {
    $filename = some_function();
} while( file_exists($path.$filename) ); 
```

这不是非常必要的，但如果您只是在百万分之一的文件名冲突的情况下寻求安心，那么这几行额外的行就可以了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-20T22:47:44.750

我最喜欢的[编码恐怖文章](http://www.codinghorror.com/blog/2007/12/hashtables-pigeonholes-and-birthdays.html)之一解决了为什么这种方法比看起来更笨，你应该使用类似的东西`uniqid`而不是`mt_rand(1, 99999);`......

# java - 为什么'java -version'会进入stderr？

> ID：13483443
> 
> 赞同：22
> 
> 时间：2012-11-20T22:40:38.540
> 
> 标签：java, stdout, stderr

`java -version`去的结果有什么特别的原因`stderr`吗？

例如，此命令从 Windows 的提示行执行：

```
java -version > java_version.txt 
```

将文件`java_version.txt`留空。

`java.exe`编辑：在没有任何参数的情况下执行后打印出的帮助也会发生同样的情况。

编辑：纯粹出于好奇，我检查了它是否一直都是这样，结果发现它确实如此。`java -version`转到`stderr`JDK 1.1.8 和 JDK 1.2.2 中，但是`java.exe`没有任何参数的输出不会。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-20T22:46:35.477

> java -version 进入 stderr 的结果有什么特殊原因吗？

AFAIK，没有特殊原因。这就是`java`命令的执行方式。可能一直追溯到 Java 1.0，尽管很难验证这一点。

我的简短调查表明，这种行为与大多数 Linux 命令的行为方式*不一致*……我尝试过的所有其他操作都使用标准输出来获取版本信息。（毕竟版本信息不是“错误”输出。）

但是请注意`--version`/`-version`选项是一种约定，而不是任何正式标准所要求的。（[GNU 编码标准](http://www.gnu.org/prep/standards/html_node/_002d_002dversion.html)规定命令应该实现`--version`并且版本信息应该写入标准输出。但是 POSIX 标准没有提及这一点，LSB 标准也没有提及。）

* * *

你能/应该做什么？

*   在您的 shell 脚本或批处理文件中捕获 stderr 而不是 stdout 应该很容易。
*   这样做应该没有任何风险。Oracle 无法在`-version`不破坏客户脚本的情况下更改 Java 工具链以将输出发送到标准输出。这是极不可能的¹。

^(1 - 这是多么不可能的证据：[https](https://bugs.java.com/bugdatabase/view_bug.do?bug_id=4380614) ://bugs.java.com/bugdatabase/view_bug.do?bug_id=4380614 。请注意“解决方案：无法修复”......和最后的评论。)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T22:43:48.700

此问题的解决方法是：

```
java -version 2> java_version.txt 
```

# mysql - 保留“WHERE IN()”子句中的所有记录，即使它们没有找到

> ID：13483448
> 
> 赞同：5
> 
> 时间：2012-11-20T22:41:06.903
> 
> 标签：mysql

我有以下mysql查询：

```
SELECT id, sum(views) as total_views
FROM table
WHERE id IN (1,2,3)
GROUP BY id
ORDER BY total_views ASC 
```

如果只`id 1,3`在数据库中找到，我仍然想`id 2`出现，`total_views`设置为 0。

有没有办法做到这一点？这不能使用任何其他表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T22:43:46.313

该查询使用由联合组成的子查询对可能的 ID 列表进行硬编码……然后将这组 id 连接到包含要计数的信息的表中。

即使没有出现，这也会在您的结果中保留一个 ID：

```
SELECT ids.id, sum(views) as total_views
FROM (
    SELECT 1 AS ID 
    UNION ALL SELECT 2 AS ID 
    UNION ALL SELECT 3 AS ID 
) ids 
LEFT JOIN table
    ON table.ID = ids.ID
GROUP BY ids.id
ORDER BY total_views ASC 
```

或者，如果您有一个[numbers 表](https://stackoverflow.com/questions/9751318/creating-a-numbers-table-in-mysql)，您可以执行以下查询：

```
SELECT numbers.number, sum(views) as total_views
FROM
    numbers
    LEFT JOIN table
        ON table.ID = ids.ID
WHERE numbers.number IN (1, 2, 3)
GROUP BY numbers.number
ORDER BY total_views ASC 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T23:21:48.740

这是 Micheal 解决方案的替代方案（请注意，这不是一个糟糕的解决方案——即使有“很多”ID），只要您不针对集群进行查询。

```
create temporary table __ids (
  id int unsigned primary key
) engine=MEMORY;

insert into __ids (id) values
  (1),
  (2),
  (3)
;

SELECT table.id, sum(views) as total_views
FROM __ids left join table using (id)
GROUP BY table.id
ORDER BY total_views ASC 
```

如果您的查询变得复杂，我什至可以设想它以这种方式运行更有效。但是，如果我是你，我会将此选项与 Michael 使用真实数据的临时 UNION 表选项进行基准测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:51:22.827

在@Michael 的回答中，如果您*确实*有一个包含您关心的ID 的表格，您可以将其用作“ID”来代替Michael 的内联数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T23:05:43.333

检查这个小提琴...... [http://www.sqlfiddle.com/#!2/a9392/3](http://www.sqlfiddle.com/#!2/a9392/3)

```
Select B.ID, sum(A.views) sum from tableB B
 left outer join tableA A
 on B.ID = A.ID
group by A.ID 
```

还要检查 [http://www.sqlfiddle.com/#!2/a1bb7/1](http://www.sqlfiddle.com/#!2/a1bb7/1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-03T11:13:14.710

试试这个

```
 SELECT id 
                (CASE 1
                    IF EXISTS THEN  views = mytable.views END
                    IF NOT EXIST THEN views = 0 END
                CASE 2
                    IF EXISTS THEN  views = mytable.views END
                    IF NOT EXIST THEN views = 0 END
                CASE 3
                    IF EXISTS THEN  views = mytable.views END
                    IF NOT EXIST THEN views = 0 END), sum(views) as total_views
    FROM mytable
    WHERE id IN (1,2,3)
    GROUP BY id
    ORDER BY total_views ASC 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-03T22:18:18.287

它必须是行还是您可以旋转数据以为每个 id 提供一行和一列？

```
SELECT
  SUM(IF (id=1, views, 0)) views_1,
  SUM(IF (id=2, views, 0)) views_2,
  SUM(IF (id=3, views, 0)) views_3
FROM table 
```

# c# - 使用 LINQ 从 xml 中删除元素

> ID：13483452
> 
> 赞同：6
> 
> 时间：2012-11-20T22:41:36.330
> 
> 标签：c#, xml, xml-parsing, linq-to-xml

我有一个 xml 文件，例如：

```
<starting>
   <start>
      <site>mushfiq.com</site>
      <site>mee.con</site>
      <site>ttttt.co</site>
      <site>jkjhkhjkh</site>
      <site>jhkhjkjhkhjkhjkjhkh</site>
     <site>dasdasdasdasdasdas</site>
 </start>
</starting> 
```

现在我需要删除任何`<site>...</site>`内容，并且将从文本框中随机给出值。

这是我的代码：

```
XDocument doc = XDocument.Load(@"AddedSites.xml");                
var deleteQuery = from r in doc.Descendants("start") where r.Element("site").Value == txt.Text.Trim() select r;
foreach (var qry in deleteQuery)
{
    qry.Element("site").Remove();
}
doc.Save(@"AddedSites.xml"); 
```

如果我把第一个元素的值放在文本框中，那么它可以删除它，但是如果我把除了第一个元素的值之外的任何元素值都不能删除！我需要我将放置任何元素的任何值......因为它可以是第二个元素或第三个或第四个等等......有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-20T22:43:25.970

编辑：好的，通过进一步的编辑，你想做什么会更清楚，而且碰巧它比你做的要容易得多，这要归功于扩展[`Remove`方法](http://msdn.microsoft.com/en-us/library/bb357554.aspx)`IEnumerable<T> where T : XNode`：

```
string target = txt.Text.Trim();
doc.Descendants("start")
   .Elements("site")
   .Where(x => x.Value == target)
   .Remove(); 
```

这就是你所需要的。

# c# - C# 中的类型推断不起作用？

> ID：13483458
> 
> 赞同：5
> 
> 时间：2012-11-20T22:41:55.667
> 
> 标签：c#, vb.net, type-inference

给定以下 C# 代码：

```
var a = new[] {"123", "321", 1}; //no best type found for implicitly typed array 
```

以及它在 VB.NET 中的对应物：

```
Dim a = {"123", "321", 1} 'no errors 
```

看来 VB.NET 能够正确推断`a`=的类型`Object()`，而 C# 一直抱怨，直到将上述内容固定为：

```
var a = new object[] {"123", "321", 1}; 
```

对于上述场景，有没有办法在 C# 中自动推断类型？

**编辑：**在 C# 沙箱中使用不同类型后的有趣观察 - 如果所有元素在继承树中都有共同的父级，并且该父级*不是*，`Object`或者如果元素可以转换为更广泛的类型（不丢失精度，例如`Integer -> Double`）。所以这两个都可以工作：

```
var a = new[] {1, 1.0}; //will infer double[]
var a = new[] {new A(), new B()}; //will infer A[], if B inherits from A 
```

我认为这种行为在 C# 中是不一致的，因为所有类型都继承自`Object`，所以它与任何其他类型的祖先并没有太大的不同。这可能是一种设计，所以没有必要争论，但如果你知道原因，知道为什么会很有趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T22:44:46.097

不可以。C# 中的隐式类型数组要求数组初始值设定项中的表达式之一的类型是目标类型*。*基本上，编译器试图准确地找到一种元素类型，以便所有其他类型都可以转换为它。

当然，您可以将*任何*元素转换`object`为：

```
var a = new[] { (object) "123", "321", 1}; 
```

...但是您也可以只使用显式类型的数组初始值设定项：

```
var a = new object[] {"123", "321", 1}; 
```

或者在您确实*同时*声明一个变量的情况下：

```
object[] a = {"123", "321", 1}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:45:46.160

不可以。但是，您可以通过使用 Option Explicit On、Option Strict On 和 Option Infer Off 使 VB 的行为更像 C#。

[最佳实践：期权推断](https://stackoverflow.com/questions/667851/best-practices-option-infer)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T12:43:59.233

在 C# 中，您可以使用`dynamic`： `dynamic[] k = { "1", 2, "3" };`

但是，它并没有完全模仿 VB 的行为。 `dynamic[] k = { "1", "2", "3" };` 仍然给你一个对象数组，而在 VB 中你得到一个字符串数组。

而且当然：

```
dynamic[] k = { "1", "3", "3" };
int i = k[0].I_do_not_exist(); 
```

编译没有问题，但很可能会失败；）

# javascript - 下载选项表单的两个 onClick 事件

> ID：13483461
> 
> 赞同：2
> 
> 时间：2012-11-20T22:41:59.573
> 
> 标签：javascript, forms, events, onclick

我正在尝试制作一个表单，允许我选择一个单选按钮，该按钮将更改按钮 href 位置并在 javascript 弹出窗口中打开它。我拥有的 href 更改的 JS 是：

```
<script type="text/javascript">
<!--
// return the value of the radio button that is checked
// return an empty string if none are checked, or
// there are no radio buttons
function getCheckedValue(radioObj) {
if(!radioObj)
    return "";
var radioLength = radioObj.length;
if(radioLength == undefined)
    if(radioObj.checked)
        return radioObj.value;
    else
        return "";
for(var i = 0; i < radioLength; i++) {
    if(radioObj[i].checked) {
        return radioObj[i].value;
    }
}
return "";
}

// set the radio button with the given value as being checked
// do nothing if there are no radio buttons
// if the given value does not exist, all the radio buttons
// are reset to unchecked
function setCheckedValue(radioObj, newValue) {
if(!radioObj)
    return;
var radioLength = radioObj.length;
if(radioLength == undefined) {
    radioObj.checked = (radioObj.value == newValue.toString());
    return;
}
for(var i = 0; i < radioLength; i++) {
    radioObj[i].checked = false;
    if(radioObj[i].value == newValue.toString()) {
        radioObj[i].checked = true;
    }
}
}
//-->
</script> 
```

弹出窗口的 JS 来自 Highslide JS (highslide.com)

我拥有的代码是：

```
 <form name="radioExampleForm" method="get" action="" onsubmit="return false;">
<p><label for="number0"><input type="radio" value="popups/download1.html" name="number"     id="number0"> Free</label>
&nbsp;<label for="number1"><input type="radio" value="popups/download2.html" name="number" id="number1">Premium</label>

<p>
<input type="button" onclick="return hs.htmlExpand(this, { objectType: 'iframe' } ); window.location.href = (getCheckedValue(document.forms['radioExampleForm'].elements['number']));" value="Download" class="button">
</form> 
```

是否可以将这些结合起来，如果可以，我做错了什么？当我将它们结合起来时，这两个 JS 都不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:43:44.693

Highslide 允许您通过`src`其配置对象的属性覆盖 iframe src：

```
hs.htmlExpand(this, {
    objectType: 'iframe',
    src: 'mypage.html'
}); 
```

正如 Joshua 在您当前的代码中指出的那样：`return hs.htmlExpand ..`将阻止您的第二条语句 ( `window.location ..`) 执行。即使它要执行，它所做的只是将*当前*浏览器窗口的位置更改为目标 URL。

解决方案如下所示：

```
<form name="radioExampleForm" method="get" action="" onsubmit="return false;">
    <p>
        <label for="number0"><input type="radio" value="popups/download1.html" name="number" id="number0"> Free</label>&nbsp;
        <label for="number1"><input type="radio" value="popups/download2.html" name="number" id="number1">Premium</label>
    <p>

    <input type="button" onclick="return hs.htmlExpand(this, { objectType: 'iframe', src: getCheckedValue(document.forms['radioExampleForm'].elements['number']) } );" value="Download" class="button">
</form> 
```

# python - 在实例化时给一个类它自己的“自我”？

> ID：13483475
> 
> 赞同：0
> 
> 时间：2012-11-20T22:42:50.337
> 
> 标签：python, class, instantiation, self

我有一个按钮类，你可以像这样实例化：

```
engine.createElement((0, 0), Button(code=print, args=("Stuff!",))) 
```

当它被点击时，它会打印“Stuff！”。但是，我需要按钮在单击时自行销毁。像这样的东西：

```
engine.createElement((0, 0), Button(code=engine.killElement, args=(self,))) 
```

但是，这只会杀死调用者，因为此时 self 指的是调用者。我需要做的是提前给班级自己的“自我”......

我只想让字符串在单击时`'self'`引用`self`变量，但是如果我想`'self'`在参数中使用字符串怎么办？

这样做的方法是什么？我的架构是错的还是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:44:57.600

不幸的是，这是不可能的——按钮构造函数的参数在构造函数被计算之前被计算。您需要将按钮分配给一个变量，然后设置回调：

```
b = Button(code=engine.killElement)
b.args = (b, ) 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:51:00.847

您基本上已经对其进行了设置，因此您需要一个对象的引用才能创建该对象，这当然是不可能的。你可以做这样的事情（列表和元组一样好用于参数解包）：

```
arglist = []
button = Button(code=engine.killElement, args=arglist)
arglist.append(button)
engine.createElement((0, 0), button) 
```

这是不优雅、不清楚和冗长的，但它会将对实例的引用获取到实例中。

您可以使用另一张海报建议的哨兵值。也许更好的建议是简单地使用一个约定（如 Python 本身），`self`它始终作为第一个参数传递给指定函数，并且不需要显式指定。然后你的回调被写成总是 take `self`，即使他们不做任何事情。

但通常您不会通过将对象的行为传递给对象的构造函数来指定对象的行为，而是通过继承来指定对象的行为。换句话说，您将*子类* `Button`化，覆盖其`onClick`方法或其他任何东西，然后实例化子类。知道`onClick`它附加到哪个实例不是问题。所以我支持是的，你的架构有点错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:48:13.173

这一般是不可能的。

但是，如果您正在创建`Button`类，则可以传递一个特殊的标记值，即“您自己”。例如：

```
class Button(object):
    yourself = 'yourself'
    def __init__(self, code, args):
        self.code = code
        self.args = [self if arg is yourself else arg for arg in args] 
```

然后：

```
engine.createElement((0, 0), Button(code=engine.killElement, args=(Button.yourself,))) 
```

选择一个合适的哨兵可能会很棘手——明显的选择，比如`None`, `0`, 或者`''`可能是合法值，甚至你想出的棘手的东西在调试过程中可能会变成有用的参数。在模块中创建`yourself`一个类变量或全局变量意味着如果您确实需要重新定义哨兵，您只需在一个地方更改它，而不是在您使用它的任何地方。

请参阅[http://bytes.com/topic/python/answers/555169-sentinel-values-special-cases](http://bytes.com/topic/python/answers/555169-sentinel-values-special-cases)了解有关选择适当哨兵值的简要讨论。还有另一个博客有更多信息，但我没有在快速搜索中找到它......无论如何，这里有一些快速的想法：

1.  `None`如果它有效，它总是最好的答案。
2.  定义一个空类作为哨兵。可以使用类对象或类对象的任何实例。
3.  创建`object`类 ( `object()`) 的全局实例。
4.  定义一个空函数并使用它（或其`func_code`或其他）。
5.  `Ellipsis`（或`type(Ellipsis)`，这是一个名为 的类型`ellipsis`，但该名称不可访问）几乎总是安全的，因为它仅用于`__getitem__`和朋友（并且可能用于定义`slice`要传递给他们的对象）。
6.  如果有一个不可能是有效值的类型，并且您已经有实例，请使用其中的一个——例如，函数的`func_code`成员。`__init__`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T17:34:25.793

也许这样的事情会有所帮助：

```
class Button(object):
    def __new__(cls, *args, **kwargs):
        obj = object.__new__(cls, *args, **kwargs)
        kwargs['args'].append(obj)
        return obj

    def __init__(self, code, args):
        self.code = code
        self.args = args

    def click(self):
        return self.code, self.args

b = Button(code="engine.killElement", args=[])
print b.click() 
```

输出：

```
('engine.killElement', [<__main__.Button object at 0x00B59AF0>]) 
```

# c - C中的动态字符串数组

> ID：13483477
> 
> 赞同：2
> 
> 时间：2012-11-20T22:43:08.500
> 
> 标签：c, multidimensional-array

我正在尝试制作字符串数组，我有`rLine`从标准输入读取行的函数，我需要将每个输入的行保存在数组中，但我不知道输入的字符串行的数量。所以我需要动态增加数组大小来存储它们，我写了这样的代码：

```
char *res[2], *old = res;
while( 1 ){
  line = rLine( stdin ), len = strlen( line );
  res[row] = (char*)malloc( len + 1);
  strcpy( res[row++], line);
  res = (char**) realloc( res, row ); /* adding 1 more row, not sure adding size row? */
  if ( /*some cond*/ ) break;
} 
```

但是这段代码似乎不起作用，如何正确声明数组并增加它的大小？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:48:51.603

正如我在评论中所说，指针数组与指向指针的指针不同。您不能尝试将分配的内存分配给数组。

在使用它之前，您应该声明`res`为指向指针的指针并在循环开始时分配内存。

试试这样：

```
char **res = NULL, *old = res;
while( 1 ){
  line = rLine( stdin ), len = strlen( line );
  res = (char**) realloc( res, sizeof(char**) * (row + 1) ); /* adding 1 more row, not sure adding size row? */
  res[row] = (char*)malloc( len + 1);
  strcpy( res[row++], line);
  if ( /*some cond*/ ) break;
} 
```

请记住，在大多数情况下，数组会衰减为指针，但在下面的处理方式却大不相同。

# c++ - 使用opencv进行高斯平滑

> ID：13483479
> 
> 赞同：0
> 
> 时间：2012-11-20T22:43:23.030
> 
> 标签：c++, opencv, gaussian

我在 OpenCV 中创建了以下高斯内核，并将其与 OpenCV 的 GaussianBlur 函数进行了比较。但是，我得到的是黑色图像而不是平滑图像。有人可以对此有所了解吗？

```
Mat src, dst1,dst2;
Mat gaussiankrnl(3,3,CV_32F);
Point anchor;
double delta;
int ddepth;

anchor = Point( -1, -1 );
delta = 0;
ddepth = -1;

src = imread("coins.pgm");

gaussiankrnl.at<double>(0,0) = 1/16;
gaussiankrnl.at<double>(0,1) = 2/16;
gaussiankrnl.at<double>(0,2) = 1/16;
gaussiankrnl.at<double>(1,0) = 2/16;
gaussiankrnl.at<double>(1,1) = 4/16;
gaussiankrnl.at<double>(1,2) = 2/16;
gaussiankrnl.at<double>(2,0) = 1/16;
gaussiankrnl.at<double>(2,1) = 2/16;
gaussiankrnl.at<double>(2,2) = 1/16;

filter2D(src, dst1, ddepth , gaussiankrnl, anchor, delta, BORDER_DEFAULT );

GaussianBlur(src, dst2, Size(3,3), 1.0);

imshow("result1", dst1 );
imshow("result2", dst2 );

cvWaitKey(0);
return 0; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T23:02:52.797

您正在划分整数并使内核为零。

更改`1/16`为`1.0/16.0`以及其他值。

# php - 改进路由器

> ID：13483481
> 
> 赞同：1
> 
> 时间：2012-11-20T22:43:32.397
> 
> 标签：php, routes

现在，我正在尝试改进我的 MVC 路由器调度功能。我的主要问题是用户可以尝试访问对象，如果失败，显然会返回一个空白页面。

例如，如果我有一个名为的对象`error`，并且其中一个类方法是`setType()`，则用户可以输入`error/settype`的是 URI。

所有网址都写入`index.php?url=$1`

```
$url = explode('/', trim($_SERVER['REQUEST_URI'], '/'));

    $controller = !empty($url[0])  ? $url[0]  : 'home';
    $method = !empty($url[1]) ? $url[1] : 'index';
    $params = !empty($url[2]) ? $url[2] : $_POST;

    if (class_exists($controller)){

        $dispatchedController = new $controller;

        if (! method_exists($controller, $method)){
            /**
            * Error handling
            **/
        }

        return $dispatchedController->$method($params);

    } else{
            /**
            * Error handling
            **/
    } 
```

如何改进我的路由器？我认为提供白名单或黑名单不太实用。

# neo4j - neo4j 的命名约定是什么？

> ID：13483487
> 
> 赞同：14
> 
> 时间：2012-11-20T22:43:58.977
> 
> 标签：neo4j

我对 neo4j 中的命名约定很好奇。

我在他们的示例中注意到关系名称大写，例如

```
left-[r:KNOWS]->right 
```

那是公约吗？Neo4j 在关系名称中是否区分大小写？索引名称和属性名称是否有其他命名约定？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T23:23:56.953

那就是约定。我个人使用小写关系类型，是的，它区分大小写。带下划线。

通常，人们也使用下划线作为索引名称，它们通常是小写的，并且区分大小写。

另外，需要记住的一点是：如果您在创建时不指定方向，则默认为左<--右。对我来说不直观，但现在我总是指定方向。

对于属性，我认为大多数人使用 JSON 样式约定：http: [//google-styleguide.googlecode.com/svn/trunk/jsoncstyleguide.xml#Key_Names_in_JSON_Maps](http://google-styleguide.googlecode.com/svn/trunk/jsoncstyleguide.xml#Key_Names_in_JSON_Maps)

我也看到了属性的下划线，所以我猜它是两种方式。只要保持一致！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-11-16T09:55:01.190

是的，关系名称的约定是将它们全部大写。Neo4j 中的所有名称都区分大小写（标签、关系、属性……）

请记住，这是一个约定，而不是要求。**任何项目中最重要的部分是一致性。*使用编码风格并始终坚持下去！***

Neo4j 命名约定：

*   标签：UpperCamelCase（又名 PascalCase）
*   关系：CAPITALIZED_WITH_UNDERSCORE
*   属性键名：lowerCamelCase 或 snake_case

密码示例：

```
CREATE (:Person {name:"Anne"})-[:MANAGES {start_date:20121112}]->(:WorkGroup {name:"Dev"}); 
```

或者：

```
CREATE (:Person {name:"Anne"})-[:MANAGES {startDate:20121112}]->(:WorkGroup {name:"Dev"}); 
```

参考：

*   [Neo4j 开发者手册](https://neo4j.com/docs/developer-manual/current/introduction/#_label_names)
*   [O'Reilly 图形数据库 - Neo4j 图形数据库](https://neo4j.com/graph-databases-book/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-18T14:38:22.987

**使用LOWER()**和**UPPER()**字符串函数可以更容易地将所有内容变为大写或小写

**1-假设我有一个属性 name = 'name' 小写的节点，要找到它，您需要匹配确切的字符串**

```
Query:
CYPHER 2.0
START n=node(*)
WHERE n.name= "name"
RETURN id(n)

id(n)
5

Query took 3 ms and returned 1 rows. 
```

否则你将找不到它：

```
Query:
CYPHER 2.0
START n=node(*)
WHERE n.name= "Name"
RETURN id(n)

Query took 4 ms and returned no rows. 
```

但是，我们可以使用字符串函数 LOWER() 来匹配它：

```
CYPHER 2.0
START n=node(*)
WHERE n.name= LOWER("Name")
RETURN id(n)

id(n)
5

Query took 4 ms and returned 1 rows. 
```

**2- 使用任意字符串大小写输入节点属性，例如：“NaMe”，以匹配：**

```
START n=node(*)
WHERE LOWER(n.name)= "name"
RETURN id(n)

id(n)
8

Query took 5 ms and returned 1 rows. 
```

# actionscript-3 - 如何在移动设备上存储用户信息

> ID：13483491
> 
> 赞同：0
> 
> 时间：2012-11-20T22:44:15.777
> 
> 标签：actionscript-3, apache-flex, mobile

我正在使用 actionscript 3 在 Adob​​e Flex 移动版（flex 4.6）上开发一个手机应用程序。

这个应用程序将有一个用户名和密码，以便用户可以登录它。但我想将他的用户名和密码存储在某个地方，这样当他打开应用程序时，如果他上次登录，它将保留该信息，他不必再次登录。

由于这是我的第一个手机应用程序，我不知道，但如果你能以正确的方式指导我，我将不胜感激。谢谢你。

～喵喵

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:53:04.707

对于用户名和密码，我可能会使用[EncryptedLocalStore](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/data/EncryptedLocalStore.html)。

# java - 拉力赛：从查询输出到文件

> ID：13483493
> 
> 赞同：1
> 
> 时间：2012-11-20T22:44:19.973
> 
> 标签：java, task, rally

抱歉，Rally 编码、Java 等方面的新手。我需要一个查询来显示打开输出到文件的任务，以便我可以将其直接放入 OneNote 之类的东西中。我有获取数据的示例代码......但无法弄清楚输出部分。

提前致谢！

[https://rally1.rallydev.com/slm/webservice/1.39/task?query=((Owner.Name](https://rally1.rallydev.com/slm/webservice/1.39/task?query=((Owner.Name) = user@company.com) and (State != Completed))&order=Rank&fetch=true&stylesheet=/slm/doc /webservice/browser.xsl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:54:57.883

如果您使用的是 Linux 或 Unix 系统，则可以执行以下操作：

`curl -u username@company.com:topsecretpassword "https://rally1.rallydev.com/slm/webservice/1.39/task?query=((Owner.Name%20=%20%22username@company.com%22)%20and%20(State%20!=%20Completed))" >> MyTaskQuery.xml`

请注意，您需要使用 %20 对空格进行编码，并使用 %22 对双引号进行编码，以使其正常工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T17:09:42.550

无需在 Unix 或 Linux 中，curl 可用于几乎任何平台。

# python - 当我在 mxd.save 之后打开我的文档时，文本是相同的，即使它显示它在导出期间已被替换

> ID：13483509
> 
> 赞同：3
> 
> 时间：2012-11-20T22:45:36.167
> 
> 标签：python, arcgis, arcmap, arcpy

如果这是一个简单的解决方案，我对编码任何东西都很抱歉。

当我导出我的地图时，一切都很好，我的脚本完美地替换了文本。但是，当我手动打开地图文档以将其可视化时，文本仍然与替换之前相同。我什至从该文件夹中导出了一张地图而不替换文本，它显示文本已被替换。我不确定发生了什么事。在 mxd.save() 之前，我也使用了 arcpy.RefreshActiveView，但它仍然无法正常工作。任何帮助，将不胜感激。

```
import arcpy 
import os
import glob
folder = r"C:\Workspace\MapTest"
oldtext = '7351'
newtext = '7352'
mxds = glob.glob(folder + '\\' + '*.mxd')
arcpy.gp.overwriteOutput = True
for mxdFile in mxds:
    mxd = arcpy.mapping.MapDocument(mxdFile)
    for elm in arcpy.mapping.ListLayoutElements(mxd, "TEXT_ELEMENT"):
        if elm.text ==oldtext:
            elm.text = newtext          
    eps = mxdFile.replace('mxd', 'eps')
    arcpy.mapping.ExportToEPS(mxd,eps)
    mxd.save()
del mxd 
```

另外，我不确定如何将我的 eps 文档导出到另一个文件夹中。我也将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:45:09.530

好吧，我无法解决 mxd 保存问题——您的脚本非常适合我。要将 eps 保存到另一个文件夹，请执行以下操作：

```
bn = os.path.basename(mxdFile)[:-3]
eps = os.path.join('C:\\temp', bn + 'eps')
arcpy.mapping.ExportToEPS(mxd, eps)
mxd.save() 
```

对不起，我不能帮助储蓄业务。ESRI 产品有时会做一些奇怪的事情，一段代码在一台机器上运行而在另一台机器上失败的情况并不少见。你的代码对我来说看起来很好，并且在我的测试中做了它应该做的事情。

祝你好运，

麦克风

# java - 确定增加变量计数的语句执行频率为 n 的函数

> ID：13483512
> 
> 赞同：4
> 
> 时间：2012-11-20T22:45:47.003
> 
> 标签：java, algorithm, nested, nested-loops

好的，所以我是分析算法的新手，非常感谢任何可以分享的有用提示。我试图确定 count 作为 n 的函数增加了多少次。我在 ide 中运行了它，对于值 1-7，输出为 1、3、6、10、15、21、28。我只是不确定如何将其写为 n 的函数？谢谢。循环如下：

```
for(int i = 1 ; i <= n ; i++){

    for (int j = 1 ; j <= i ; j++) {

         count++;
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:51:50.310

这种练习的目的是教你如何在纸上分析它，而不是在机器上运行它。但是让我们看一下模式：

*   外循环将运行总`n`次数
*   内部循环将运行 1 到 1`n`次，具体取决于`i`当时的情况。但是您知道，平均而言，这将运行`(n+1)/2`时间。
*   因此`count = n(n+1)/2)`，即`O(n^2)`

见[算术级数](http://en.wikipedia.org/wiki/1_+_2_+_3_+_4_+_%C2%B7_%C2%B7_%C2%B7)

**更新：**根据要求 - 为什么内部循环是`(n+1)/2`：

外循环将使 i 在 1 和 n 之间递增。因此，在外循环的每次迭代中，内循环将比以前多“循环”一次。

因此内部循环将迭代这个次数：

*   1 + 2 + 3 + ... + n

所以我们可以做一些聪明的事情并配对：

*   n 与 1： (n + 1) = n + 1
*   n-1 与 2：(n - 1) + 2 = n + 1
*   n-2 与 3： (n - 2) + 3 = n + 1
*   ...

由于我们将它们配对，因此我们有 n/2 对这样的配对：

*   所以 1 + 2 + ... + n 的总和是 ( (n+1) * (n/2) )。
*   所以平均值为 ( (n+1) * (n/2) ) / n = (n+1)/2

（想象一下，当你在一条长纸条上写 1 + 2 + 3 + ... + n 时，你把它对折。）

我也强烈推荐阅读这个[关于卡尔弗里德里希高斯的著名故事，](http://www.jimloy.com/algebra/gauss.htm)这样你就会永远记得如何对算术级数求和 =)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T22:48:03.023

1

1+2 = 3

1+2+3 = 6

1+2+3+4 = 10

1+2+3+4+5 = 15

只有我能看到模式吗？:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T22:52:46.717

干得好：

计数 = n * (n + 1) / 2

# actionscript-3 - 使用键盘移动生成的网格

> ID：13483513
> 
> 赞同：0
> 
> 时间：2012-11-20T22:45:51.430
> 
> 标签：actionscript-3, flash

我正在尝试使用键盘移动生成的网格...当我尝试使用我的 .swf 文件时，它会运行但键盘...这是针对马里奥​​这样的平台游戏，因此您应该对一些没有感觉的代码行进行处理，但我向你保证他们会的！

所以，这是我的 AS ：

```
var map:Array = [
                 [1,1,1,1,1,1,10,0,0,11,1,1,1,1,1,1,1,1,1,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,1],
                 [1,0,0,0,0,0,6,1,0,0,4,4,4,4,0,0,6,1,0,1],
                 [1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,1,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,6,0,0,1,0,0,1,0,0,1,0,0,1,2,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
                 [1,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,3,1],
                 [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
                 ];

var stock:Array = [
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
             [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
             ];

function createMap():void{
    for (var i:int=0; i<20; i++){                               
        for (var j:int=0; j<15; j++){                           

            var T:int = 32
            var dT:int = T*.5
            var f:int = map[j][i]

            if(f>0) {
                var t:Block = new Block()
                t.x= i*T;       
                t.y= j*T;       
                t.gotoAndStop(f)        
                grid.addChild(t)
            }
        }
    }
}

var grid:MovieClip = new MovieClip();   

addChild(grid);

createMap();

stage.addEventListener(KeyboardEvent.KEY_DOWN, pushin);
stage.addEventListener(KeyboardEvent.KEY_UP, pushout);      

var right:Boolean=false;
var left:Boolean=false;
var up:Boolean=false;
var down:Boolean=false;

var lateral:Boolean = false;            
var saute:Boolean = false ;             
var none:Boolean = true                 

function paramMap():void {

    grid.sens = int(right)-int(left);           
    grid.up = int(up)-int(down)             
    grid.jump = -int(up)*11                 
    none = !right && !left && !up && !down  
    lateral = right || left;                        

function movingGrid():void{

    var L:int                                                               
    var C:int                                                               
    var Ls:int                                                              
    var Cs:int                                                              
    var A:Object
    var B:Object
    var Y:Number
    var P:Array

    with(grid){

        x += vit*sens;

        L =  y/T;
        C =  x/T;
        Ls = (y+T-1)/T;         
        Cs = (x+vit*sens)/T;

        P =  checkLateral(grid,L,Cs,vit*2,(y-dT)/T)

        L =  P[0]
        Cs = P[1]
        A =  stock[L][C]
        B =  stock[Ls][C]
        Y =  (L-1)*T    

        y += gravite; 

        if (gravite++>T) gravite=T
    }
}

}

function pushin(event:KeyboardEvent):void {
    if (event.keyCode == 38) up = true; 
    if (event.keyCode == 40) down = true;
    if (event.keyCode == 39) right = true;
    if (event.keyCode == 37) left = true;
}

function pushout(event:KeyboardEvent):void {
    if (event.keyCode == 38) up = false;
    if (event.keyCode == 40) down = false;              
    if (event.keyCode == 39) right = false;             
    if (event.keyCode == 37) left = false;              
} 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:14:26.093

我现在看到几个问题：

*   `paramMap`并且它的内部函数`movingGrid`永远不会被任何人调用。您可能希望将它们连接到`ENTER_FRAME`事件侦听器或在用户按下键时调用它们。

*   和属性不在这部分代码中，所以在我测试时它会抛出`vit`一个。对于.`T``grid``ReferenceError``checkLateral`

解决这些问题后，网格对象会正确移动。但是因为它是一个空的影片剪辑，所以您实际上还*看不到*它。您需要向其添加可见子项或移动现有对象。这是剥离的代码，正确地`grid`左右移动：

```
var grid:MovieClip = new MovieClip();

addChild(grid);

stage.addEventListener(KeyboardEvent.KEY_DOWN, pushin);
stage.addEventListener(KeyboardEvent.KEY_UP, pushout);

var right:Boolean = false;
var left:Boolean = false;
var up:Boolean = false;
var down:Boolean = false;

var lateral:Boolean = false;
var saute:Boolean = false;
var none:Boolean = true;

function paramMap():void
{

    grid.sens = int(right) - int(left);
    grid.up = int(up) - int(down);
    grid.jump =  -  int(up) * 11;
    none = ! right && ! left && ! up && ! down;
    lateral = right || left;

    var L:int;
    var C:int;
    var Ls:int;
    var Cs:int;
    var A:Object;
    var B:Object;
    var Y:Number;
    var P:Array;

    with (grid)
    {
        x +=  sens;
        L = y;
        C = x;
        Ls = (y - 1);
        Cs = (x + sens);
    }
}

function pushin(event:KeyboardEvent):void
{
    if (event.keyCode == 38)
    {
        up = true;
    }
    if (event.keyCode == 40)
    {
        down = true;
    }
    if (event.keyCode == 39)
    {
        right = true;
    }
    if (event.keyCode == 37)
    {
        left = true;
    }

    paramMap();
    trace(grid.x, grid.y);
}

function pushout(event:KeyboardEvent):void
{
    if (event.keyCode == 38)
    {
        up = false;
    }
    if (event.keyCode == 40)
    {
        down = false;
    }
    if (event.keyCode == 39)
    {
        right = false;
    }
    if (event.keyCode == 37)
    {
        left = false;
    }
} 
```

# yii - Yii CGridView 仅隐藏过滤器输入

> ID：13483514
> 
> 赞同：8
> 
> 时间：2012-11-20T22:45:55.867
> 
> 标签：yii

使用 CGridView 时，过滤器输入字段由组件自动生成。

我想选择哪些列将显示输入字段。例如：我的模型有 5 列。我希望 CGridView 仅显示第 1 列和第 2 列的输入过滤器。

有没有办法在不使用 CSS 或 jQuery 的情况下做到这一点，只需在 CGridView 选项上添加一些代码？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-20T23:32:22.607

```
array(
    'name'=>'col3',
    'value'=>'$data->col3',
    'filter'=>false,
) 
```

应该管用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-18T19:27:30.893

如果要删除整个过滤器中的所有过滤器`CGridView`，请配置`'filterPosition'=>''`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-20T08:29:22.593

只有评论和过滤器消失了......例如：

```
<?php $this->widget('zii.widgets.grid.CGridView', array(
'id'=>'usuario-grid',
'dataProvider'=>$model->search(),
//'filter'=>'false',
'columns'=>array(
    'rut_usuario', 
```

……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-05T07:23:40.793

设置`'filter'=>false,`对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-25T22:30:19.927

您可以设置'filter'=> false，但此属性将最小化列的witdh..禁用特定列过滤的另一种方法是返回带有属性'disabled'的输入，例如：

```
 'filter'=>'<input type="text" class="form-control" name="UsersSearch[password]" 
   disabled>', 
```

# android - 拍摄照片，将其保存在应用程序可绘制对象中并在 ImageButton 中显示

> ID：13483515
> 
> 赞同：3
> 
> 时间：2012-11-20T22:46:05.643
> 
> 标签：android, android-activity, camera

我有一个带有 ImageButton 的 Android 应用程序。当用户点击它时，意图启动以显示相机活动。当用户捕获图像时，我想将其保存在应用程序的可绘制文件夹中，并将其显示在用户单击的同一个 ImageButton 中，替换以前的可绘制图像。我使用了此处发布的活动：[从相机捕获图像并在活动中显示](https://stackoverflow.com/questions/5991319/capture-image-from-camera-and-display-in-activity)

...但是当我捕获图像时，活动不会返回到包含 ImageButton 的活动。

编辑代码是：

> ```
> public void manage_shop()
> {
>     static final int CAMERA_REQUEST = 1888;
> 
>     [...]
>     ImageView photo = (ImageView)findViewById(R.id.getimg);
>     photo.setOnClickListener(new View.OnClickListener() {
> 
>         @Override
>         public void onClick(View v) {
>             Intent camera = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE); 
>             startActivityForResult(camera, CAMERA_REQUEST); 
>         }
>     }); 
>    [...]
> } 
> ```

和 onActivityResult():

> ```
> protected void onActivityResult(int requestCode, int resultCode, Intent data)
> {
>   ImageButton getimage = (ImageButton)findViewById(R.id.getimg);
> 
>     if (requestCode == CAMERA_REQUEST && resultCode == RESULT_OK)
>     {  
>         Bitmap getphoto = (Bitmap) data.getExtras().get("data"); 
>         getimage.setImageBitmap(getphoto);
>     }
> } 
> ```

如何将捕获的图像存储在可绘制文件夹中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:57:35.723

将图像保存到文件后，您可以使用以下代码段添加到图库。

```
ContentValues values = new ContentValues(); 
values.put(MediaStore.Images.Media.TITLE, new File(path).toString());
values.put(MediaStore.Images.Media.MIME_TYPE, "image/jpeg");
values.put(MediaStore.Images.Media.DATA, path);
getContentResolver().insert( MediaStore.Images.Media.EXTERNAL_CONTENT_URI , values); 
```

要将文件保存到目录，请执行以下操作

```
private saveFileToDir() {
    final InputStream in = Wherever you input stream comes from;

    File f = generatePhotoFile();

    OutputStream out = new FileOutputStream(f);
    byte[] buffer = new byte[1024];

    int len;
    while ((len=in.read(buffer))>0)
    {
        out.write(buffer,0,len);
    }

    in.close();
    out.flush();
    out.close();        
}

private File generatePhotoFile() throws IOException {
    Date date = new Date();
    DateFormat df = new SimpleDateFormat("yyyymmdd_hhmmss");

    String newPicFile = "IMG_"+ df.format(date) + ".jpg";

    File f = new File(Environment.getExternalStorageDirectory()+"/DCIM/Camera/", newPicFile);

    if (!f.exists())
    {
        if(!f.getParentFile().exists())
            f.getParentFile().mkdir();

        f.createNewFile();
    }

    return f;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:11:34.940

> 如何将捕获的图像存储在可绘制文件夹中？

无法将图像动态保存到可绘制文件夹：

看：

[android图像保存到res/drawable文件夹](https://stackoverflow.com/questions/5469954/android-image-save-to-res-drawable-folder)

和

[即时写入/res/drawable/？](https://stackoverflow.com/questions/3374061/write-to-res-drawable-on-the-fly)

# php - 表单提交后数组的行和列验证

> ID：13483518
> 
> 赞同：2
> 
> 时间：2012-11-20T22:46:29.677
> 
> 标签：php, for-loop

我有两个 PHP 文件：

1）simplearraypost.php（包含表单）
2）echoarraypost.php（表单的验证）

该表格有 3 列，分别是

1) 行号
2) 项目号
3) 描述

现在，如果发布，需要对每个行和列的单元格进行验证！

两者的代码分别粘贴在这里。

**简单数组post.php**

```
<html>
<body>
  <form name="insertitem" method="post" action="echoarraypost.php">
  <table border="1">
    <thead>
      <tr>
        <th>Row No.</th>
        <th>Item</th>
        <th>Description</th>
      </tr>
    </thead>
<?php
  // Number of rows
  $number = 10;

  // Create rows
  for ($i = 1; $i <= $number; $i++) {
    echo '      <tr>' . "\n";
    echo '        <td align="right">' . $i . '</td>' . "\n";
    echo '        <td><input type="text" name="itemno[]" size="5"></td>' . "\n";
    echo '        <td><input type="text" name="description[]" size="50"></td>' . "\n";
    echo '      </tr>' . "\n";
  }
?>
    <tr>
      <td colspan="4" align="right"><input type="submit" name="submit" value="Submit" /></td>
    </tr>
  </table>
  </form>
</body>
</html> 
```

**echoarraypost.php**

```
<?php
  // store all posted item numbers and descriptions in local arrays
  $itemnos = $_POST['itemno'];
  $descriptions = $_POST['description'];

  // loop through array
  $number = count($itemnos);
  for ($i = 0; $i < $number; $i++) {
    // store a single item number and description in local variables
    $itno = $itemnos[$i];
    $desc = $descriptions[$i];

    // this is where your insert should be (instead of the echo),
    // insert the single values in $itnm and $desc

    if ($itemnos[$i] <> "") {
      echo "Item: " . $itno . "   Description: " . $desc . "<p>";
    }
    else {
      echo 'Error in row(s): ' . $i . ', <br>' . "\n";  // <-- How can I make this show the Row ID?
    }

  /* Un-Comment for checking posted info

    // Check POST array
    foreach ($_POST as $key => $value) {
      echo '<p>'.$key.'</p>';
      foreach($value as $k => $v) {
        echo $k.'<br/>';
        echo $v;
      }
    }

  */

  }
?> 
```

非常感激你的帮助！

samimi_it

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T00:26:15.023

对于任何对同一问题感兴趣的人，这是我设法得出的最终结果。欢迎评论和指正。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org /TR/xhtml1    /DTD/xhtml1-frameset.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Multiple Adds</title>
</head>
<body>
<?php

 // Get todays date fo day of signup entry
 $today = date("Y.m.d H:i:s");

 // Add one year to date of singup for login validity
 $nextyear = date('Y.m.d H:i:s', strtotime('+1 year'));

 /* 
    // Table to create which is used in this demo
    CREATE TABLE IF NOT EXISTS `users` (
      `id` int(11) NOT NULL AUTO_INCREMENT,
      `fname` varchar(155) NOT NULL,
      `sname` varchar(155) NOT NULL,
      `lname` varchar(155) NOT NULL,
      `email` varchar(155) NOT NULL,
      `dob` varchar(155) NOT NULL,
      `date_signup` datetime NOT NULL,
      `date_expire` datetime NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;
*/

// Set LOCALHOST mysql server connection parameters
define('DB_HOST', 'localhost');     // Change to your own

   define('DB_USER', 'root');           // Change to your own
    define('DB_PASSWORD', '');          // Change to your own
    define('DB_DATABASE', 'test'); // Change to your own

// Connect to mysql server
$link = mysql_connect(DB_HOST, DB_USER, DB_PASSWORD);
if(!$link) {
    die('Failed to connect to server: ' . mysql_error());
}

// Select database
$db = mysql_select_db(DB_DATABASE);
if(!$db) {
    die("Unable to select database");
}

// Create the Form with multiple rows
 echo '<form id="addusers" name="addusers" method="post">';
 echo '<table border="1">';
 echo '<tr><thead>
   <th>RID</th><th>First Name</th>
   <th>Second Name</th>
   <th>Last Name</th>
   <th>eMail</th>
   <th>DOB</th>
   <thead></tr>';

    for($rid=1;$rid <= 10; $rid++)
    {

        echo '<tr>
        <td align="right"><label>'.$rid.'</label></td>
        <td><input id="fname[]" name="fname[]" type="text" size="30"    /></td>
        <td><input id="sname[]" name="sname[]" type="text" size="30" /></td>
        <td><input id="lname[]" name="lname[]" type="text" size="30" /></td>
        <td><input id="email[]" name="email[]" type="text" size="40" /></td>            
        <td><input id="dob[]" name="dob[]" type="text" size="10" /></td>
        </tr>';

    }

 echo '<td colspan="6" align="middle"><input name="submit" id="submit" type="submit" value="Add Users"></td>';
 echo '</table>';
 echo '</form>';

 echo '<hr>';

 // Check for post errors for each field in each row, and prepare error flag and message for display

 $error=false;
 $errormsg="<ul><font color='red'><b><u>Please correct the error(s) in row(s): </font></b></u><br><br>";

    for($x=0;$x < count($_POST['fname']); $x++){        

        if(!$_POST['fname'][$x]){
        $rowNum = $x+1;
        $errormsg.="<li>Row $rowNum: First Name</li>";
        $error=true;
        }

    if(!$_POST['sname'][$x]){
    $rowNum = $x+1;
    $errormsg.="<li>Row $rowNum: Second Name</li>";
    $error=true;
    }

    if(!$_POST['lname'][$x]){
    $rowNum = $x+1;
    $errormsg.="<li>Row $rowNum: Last Name</li>";
    $error=true;
    }

    if(!$_POST['email'][$x]){
    $rowNum = $x+1;
    $errormsg.="<li>Row $rowNum: Email Address</li>";
    $error=true;
    }

    if(!$_POST['dob'][$x]){
    $rowNum = $x+1;
    $errormsg.="<li>Row $rowNum: Date of Birth</li>";
    $error=true;
    }

    }

if (strtoupper($_SERVER['REQUEST_METHOD']) == 'POST'){

if($error){

    // Print Errors

            $errormsg.= "<br><font color='red'><b><u>Errors, no data 

posted!</font></b></u></ul><br>"; 
                echo $errormsg;

                echo "<p>Please <a href='javascript:history.back()'><< Go Back</a> and correct!</p>";
}else{ 

    // Print Data submitted and Insert data into DB, but with teration for one time bulk insert of all

    $query = "insert into users (fname,sname,lname,email,dob,date_signup,date_expire) values ";     

    $count = count($_POST['fname']);

    for($x=0;$x < $count; $x++)     
    {

    $fname = $_POST['fname'][$x];
    $sname = $_POST['sname'][$x];
    $lname = $_POST['lname'][$x];
    $dob = $_POST['dob'][$x];
    $email = $_POST['email'][$x];

    echo $fname . $sname . $lname . $dob . $email . '<br>';

                     $query .= "(
                     '$fname', 
                     '$sname',
                     '$lname', 
                     '$email', 
                     '$dob',
                     '$today',
                     '$nextyear')";

                    /* If not last iteration, add a comma and a space */
                    if ($x < ($count - 1)) {
                          $query .= ", ";
                         }

                    $result = mysql_query($query);

            }
                            if(!$result){

die(mysql_error());
                                            @mysql_free_result($result);
                                            } else {

$totalRID = mysql_affected_rows();
                                    $lastRID = mysql_insert_id()-1;
                                    $q = "SELECT LAST_INSERT_ID() FROM users";
                                    $numRowsInerted = mysql_num_rows(mysql_query($q));
                                    echo "Total of <b>" . $totalRID . " </b> rows/records entered into the table!" . "<br>";                                    
                                    echo "Last record number before this bulk insert was: <b>" . $lastRID . 
                                    "</b><br>Last record number after this bulk insert is: <b> " . $numRowsInerted . " </b><br>";

                        }   

    }
}

echo '<hr>';

     // Remaining code hereafter is to get the Table records for display 

      //get the number of total rows
      $query = "SELECT * FROM users";
$result = mysql_query($query);

// Number of records found
$num_record = mysql_num_rows($result);

echo 'Total number of users: ' . $num_record;

echo '<table border="1">';

echo '<tr><thead>
      <th>RID</th><th>First Name</th>
      <th>Second Name</th>
      <th>Last Name</th>
      <th>eMail</th>
      <th>DOB</th>
      <th>Member Signup Date</th>
      <th>Member Renewal Date</th>
      <thead></tr>';

  //here you do your loop like
  while($row=@mysql_fetch_object($result)) {

 echo '<tr>
       <td align="right">'.$row->id.'</td>'.
       '<td>'.$row->fname.'</td>'.
       '<td>'.$row->sname.'</td>'.
       '<td>'.$row->lname.'</td>'.
       '<td>'.$row->email.'</td>'.      
       '<td>'.$row->dob.'</td>'.
       '<td>'.$row->date_signup.'</td>'.
       '<td>'.$row->date_expire.'</td>'.
       '</tr>';
}
echo '</table>';

?>

</body>

</html> 
```

# c# - C# Excel 自动化导致 Excel 内存泄漏

> ID：13483523
> 
> 赞同：12
> 
> 时间：2012-11-20T22:46:57.333
> 
> 标签：c#, excel, com, automation, interop

我正在尝试将 C# 与 COM 互操作库一起使用来打开一组非常繁重的 excel 工作簿。我必须使用 C#，因为我还需要启动宏，移动一些单元格，并启动我公司使用的自定义 excel-add-in。

然后我的程序退出，使工作簿保持打开状态，每个工作簿都在一个单独的 excel 实例中。我不想在程序退出时关闭工作簿。

问题是当我的 C# 程序退出时，随着时间的推移，excel 工作簿会逐渐消耗更多的内存，直到它们从原来的 500 mb 消耗 3.5 gigs 的内存。

我以前手动打开工作簿，而工作表从来没有消耗那么多内存。一旦我开始使用 C# 打开它们，它们就会因为极端的内存使用而开始崩溃。我的理论是，不知何故，当我与 COM Excel 对象交互时，我会造成内存泄漏。

以下是我的原始代码：

```
using Excel = Microsoft.Office.Interop.Excel;
...
excelApp = new Excel.Application();
excelApp.Visible = true;
excelApp.Workbooks.Open(filename, misValue, misValue, misValue, misValue, misValue,
               true, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue);
excelApp.Calculation = Excel.XlCalculation.xlCalculationAutomatic; 
```

我读到了你需要如何使用 Marshal 来释放使用，所以我现在正在尝试以下代码，但没有简单的方法来测试它，除了打开所有工作表并查看它们是否消耗太多数据。

```
 excelApp = new Excel.Application();
            excelApp.Visible = true;
            Excel.Workbooks currWorkbooks = excelApp.Workbooks;
            Excel.Workbook currWorkbook = currWorkbooks.Open(filename, misValue, misValue, misValue, misValue, misValue,
               true, misValue, misValue, misValue, misValue, misValue, misValue, misValue, misValue);
            //excelApp.Calculation = Excel.XlCalculation.xlCalculationAutomatic;

            int x = Marshal.ReleaseComObject(currWorkbook);
            currWorkbook = null;

            int y = Marshal.ReleaseComObject(currWorkbooks);
            currWorkbooks = null; 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-20T23:07:51.743

在使用 MS Office COM 互操作库时，我遇到了几件事来避免内存泄漏：

首先，“不要使用两个点”是记住它的最佳方式，但基本上，始终将新的 COM 对象引用分配给新变量，不要链式调用成员，即使 Intellisense 鼓励这样做。链式调用会在后台执行一些阻止 .NET 框架正确发布的操作。这是我用于启动 Excel 报告的一些代码：

```
//use vars for every COM object so references don't get leftover
//main Excel app
var excelApp = new Application();
var workbooks = excelApp.Workbooks;

//workbook template
var wbReport = workbooks.Add(@"C:\MyTemplate.xltx");

//Sheets objects for workbook
var wSheetsReport = wbReport.Sheets;
var wsReport = (Worksheet)wSheetsReport.get_Item("Sheet1"); 
```

其次，调用`Marshal.ReleaseComObject()`以创建相反顺序创建的每个变量，并在这样做之前调用几个垃圾收集方法：

```
//garbage collector
GC.Collect();
GC.WaitForPendingFinalizers();

//cleanup
Marshal.ReleaseComObject(wsReport);
Marshal.ReleaseComObject(wSheetsReport);
Marshal.ReleaseComObject(wbReport);
Marshal.ReleaseComObject(workbooks);
Marshal.ReleaseComObject(excelApp); 
```

每次我使用 Excel 时都使用这个方案解决了我的记忆问题，尽管我们不能像以前那样使用链式成员，这很乏味和遗憾。

# asp.net - 以编程方式挂载远程文件夹时找不到路径的一部分

> ID：13483524
> 
> 赞同：1
> 
> 时间：2012-11-20T22:47:10.710
> 
> 标签：asp.net

我正在使用以下代码安装远程驱动器：

```
public static void MapDrive()
{
    try
    {
        if (System.IO.Directory.Exists(remoteFolder1)) //"Z:\\"
        {
            DisconnectDrive(remoteDriveLetter); //"Z:"
        }
        System.Diagnostics.Process p = new System.Diagnostics.Process();
        p.StartInfo.UseShellExecute = false;
        p.StartInfo.CreateNoWindow = true;
        p.StartInfo.RedirectStandardError = true;
        p.StartInfo.RedirectStandardOutput = true;
        p.StartInfo.FileName = "net.exe";
        p.StartInfo.Arguments = @" use " + remoteDriveLetter + " " + remoteShareName + " " + userPwd + " /user:" + userName;

        //EventLog.WriteEntry("Conversion Service", "Remote drive mapped successfully", EventLogEntryType.Information);

        p.Start();
        p.WaitForExit();
    }
    catch (Exception ex6_5)
    {
        WriteException(ex6_5, "Ex6.5");
    }
} 
```

我可以验证 Z 驱动器是否可用并且能够通过拖动将文件保存到其中，但以下代码会引发 DirectoryNotFoundException“找不到路径'Z:\Default.pptx'的一部分。”

```
AsyncFileUpload1.SaveAs(remoteFolder + fileName); 
```

remoteFolder 中的值是“Z:\”，文件名是“Default.pptx”。

有人可以帮帮我吗？

谢谢，

理庄

# c - 为 png 图像解析 hiberfil.sys 文件

> ID：13483526
> 
> 赞同：0
> 
> 时间：2012-11-20T22:47:14.997
> 
> 标签：c

作为我的计算机安全课程的一部分，我正在解析 hiberfil.sys 文件，寻找 PNG 文件。我正在 C 中尝试这个。我已经准备好了逻辑，当涉及到指针和 CI 时，我完全感到困惑。我无法编译以下代码：

```
 #include<stdio.h>
    #include<string.h>
    int main(void)
    {
        FILE* fd = NULL;
        FILE* out = NULL;
        unsigned char* buff;
        unsigned char* chunk[1024];
        fd = fopen("hiberfil.sys","r");
        out = fopen("a.png","w+");
        if(NULL == fd)
        {
                printf("\n fopen() Error!!!\n");
                return 1;
        }
        fread(buff,2,1,fd);
        while(1){
        if(*buff==137){
            fread(buff,2,1,fd);
            if(*buff==80){
                fread(buff,2,1,fd);
                if(*buff==78){
                    fread(buff,2,1,fd);
                    if(*buff==71){
                        fread(buff,2,1,fd);
                        if(*buff==13){
                            fread(buff,2,1,fd);
                            if(*buff==10){
                                fread(buff,2,1,fd);
                                if(*buff==26){
                                    fread(buff,2,1,fd);
                                    if(*buff==10){
                                        int * a,b,c,d,e,f,g,h,i;
                                        *a=137;
                                        *b=80;
                                        *c=78;
                                        *d=71;
                                        *e=13;
                                        *f=10;
                                        *g=26;
                                        *h=10;
                                        fwrite(a,2,1,out);
                                        fwrite(b,2,1,out);
                                        fwrite(c,2,1,out);
                                        fwrite(d,2,1,out);
                                        fwrite(e,2,1,out);
                                        fwrite(f,2,1,out);
                                        fwrite(g,2,1,out);
                                        fwrite(h,2,1,out);
                                        break;
                                    }
                                    else continue;
                                }
                                else continue;
                            }
                            else continue;
                        }
                        else continue;
                    }
                    else continue;
                }
                else continue;
            }
            else fread(buff,2,1,fd);
        }
        }
        unsigned char type[4]=0;
        while(type[0]!=73 || type[1]!=69 || type[2]!=78 || type[3]!=68){
        fread(length,sizeof(int),1,fd);
        fread(type,4,1,fd);
        fread(chunk,length+4,1,fd);
        fwrite(length,sizeof(int),1,out);
            fwrite(type,4,1,out);   
        fwrite(chunk,length+8,1,out);
        }
    fclose(fd);
        fclose(out);
        return 0;

    } 
```

非常感谢！PS：有人可以帮我格式化代码块！
**编辑错误**

> 错误：一元'*'的无效类型参数（有'int'）<<<<引用int *指针
> 
> 错误：初始化“size_t fwrite(const void*, size_t, size_t, FILE*)”的参数 1 <<<< 我相信指的是 int 长度。

它们现在对我来说似乎微不足道，但少量的解释仍然会对我有所帮助。这些指针是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:53:36.503

一个错误是：

```
int * a,b,c,d,e,f,g,h,i;
*a=137;
*b=80;
*c=78; 
```

因为只有`a`一个`int*`，其余的变量都是类型`int`。要更正在一行上声明（这更易读并且不太可能出现此错误）或`*`在每个变量名之前放置一个。

另一个错误（不是编译器错误）是使用`buff`，它在使用时是一个未初始化的指针：

```
unsigned char* buff;
/* snip ... */
fread(buff,2,1,fd); 
```

一个可能的解决方法是：

```
unsigned char buff[2]; /* As 2 bytes appears to be required size. */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:01:05.250

除了 hmjd 的回答之外，您还应该考虑可以对类型的数组进行索引。您不必只取消引用第一项。

所以你可以说`buff[i]`（如果，说，声明为`unsigned char buff[1024];`），在哪里`i`是 a`size_t`或者`int`你在你去的时候递增。

一般来说，更有意义的是 - 正如您最初的想法一样 - 读取数据块，然后如果在您仍在检测它是否为 PNG 文件时遇到第一个块的末尾，则仅读取下一个块.

所以基本上你通读`hiberfil.sys`直到你在一个循环中到达文件的末尾。在这个循环中，您跟踪单个块，可能还有前一个块。例如，可以作为环形缓冲区来完成。然后，您在该块上运行检测代码（单独的函数，通过引用传递块）并 - 例如 - 从检测函数将偏移量返回到块中。这样，您还可以知道偏移量`hiberfil.sys`，以防万一您需要它，然后可以提取 PNG 文件。

或许也读过[这个](http://home.earthlink.net/~momotuk/pointers.pdf)。

# python - 为什么 functools.partial 不返回一个真正的函数（以及如何创建一个函数）？

> ID：13483527
> 
> 赞同：11
> 
> 时间：2012-11-20T22:47:15.057
> 
> 标签：python, function, partial, currying

所以我在 Python 中玩弄柯里化函数，我注意到的一件事是 functools.partial 返回一个部分对象而不是一个实际函数。让我烦恼的一件事是，如果我做了以下事情：

```
five = partial(len, 'hello')
five('something') 
```

然后我们得到

```
TypeError: len() takes exactly 1 argument (2 given) 
```

但我想要发生的是

```
TypeError: five() takes no arguments (1 given) 
```

有没有一种干净的方法可以让它像这样工作？我写了一个解决方法，但它对我的口味来说太老套了（对于带有可变参数的函数还不起作用）：

```
def mypartial(f, *args):
  argcount = f.func_code.co_argcount - len(args)
  params = ''.join('a' + str(i) + ',' for i in xrange(argcount))
  code = '''
def func(f, args):
  def %s(%s):
    return f(*(args+(%s)))
  return %s
  ''' % (f.func_name, params, params, f.func_name)

  exec code in locals()
  return func(f, args) 
```

**编辑：**我认为如果我添加更多上下文可能会有所帮助。我正在编写一个装饰器，它会自动对一个函数进行如下处理：

```
@curry
def add(a, b, c):
  return a + b + c

f = add(1, 2) # f is a function
assert f(5) == 8 
```

我想隐藏 f 是从部分创建的事实（也许是个坏主意：P）。上面的 TypeError 消息给出的消息是可以揭示某物是否为局部的一个示例。我想改变它。

这需要可推广，因此 EnricoGiampieri 和 mgilson 的建议仅适用于该特定情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:05:57.340

你绝对不想用`exec`.

你可以在纯 Python 中找到食谱`partial`，比如[这个——其中](http://code.activestate.com/recipes/577922-partial-with-out-of-order-arguments/)许多都被错误地标记为`curry`食谱，所以也要寻找它。无论如何，这些将向您展示在没有`exec`.

或者你可以直接包装`partial`……</p>

然而，无论你做什么，包装器都无法知道它定义了一个名为“five”的函数；这只是您存储函数的变量的名称。因此，如果您想要自定义名称，则必须将其传递给函数：

```
five = my_partial('five', len, 'hello') 
```

那时，您必须想知道为什么这比仅仅定义一个新函数更好。

但是，无论如何，我认为这不是您真正想要的。您的最终目标是定义一个`@curry`装饰器，它创建装饰函数的柯里化版本，与装饰函数具有相同的名称（和文档字符串、参数列表等）。替换中间体名称的整个想法`partial`是红鲱鱼。[`functools.wraps`](http://docs.python.org/2/library/functools.html#functools.wraps)在你的函数中正确使用，你`curry`如何定义柯里化函数并不重要，它会保留原始的名称。

在某些情况下，`functools.wraps`不起作用。事实上，这可能是其中一种情况——例如，您需要修改 arg 列表，因此`curry(len)`可以采用 0 或 1 个参数而不是 1 个参数，对吧？请参阅[`update_wrapper`](http://docs.python.org/2/library/functools.html#functools.update_wrapper)和（非常简单的）[源代码](http://hg.python.org/cpython/file/2.7/Lib/functools.py)，了解基础知识是如何工作的，并从那里构建`wraps`。`update_wrapper`

扩展前面的内容：要对函数进行柯里化，您几乎必须返回一些接受`(*args)`or`(*args, **kw)`并显式解析 args 的内容，并可能显式地引发`TypeError`和其他适当的异常。为什么？好吧，如果`foo`需要 3 个参数，`curry(foo)`则需要 0、1、2 或 3 个参数，如果给定 0-2 个参数，它会返回一个函数，该函数需要 0 到 n-1 个参数。

您可能想要的原因`**kw`是它允许调用者按名称指定参数 - 尽管当您完成累积参数时检查会变得更加复杂，并且可以说这与柯里化有关 - 它可能更好首先将命名参数与 绑定`partial`，然后`curry`是结果并以柯里化样式传递所有剩余的参数......</p>

如果`foo`有默认值或关键字参数，它会变得更加复杂，但即使没有这些问题，你已经需要处理这个问题。

例如，假设您实现`curry`为一个类，该类将函数和所有已经柯里化的参数作为实例成员。然后你会有这样的东西：

```
def __call__(self, *args):
    if len(args) + len(self.curried_args) > self.fn.func_code.co_argcount:
        raise TypeError('%s() takes exactly %d arguments (%d given)' %
                        (self.fn.func_name, self.fn.func_code.co_argcount,
                         len(args) + len(self.curried_args)))
    self.curried_args += args
    if len(self.curried_args) == self.fn.func_code.co_argcount:
        return self.fn(*self.curried_args)
    else:
        return self 
```

这非常简单，但它显示了如何处理基础知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:57:57.640

我的猜测是部分函数只是延迟了函数的执行，不要从中创建一个全新的函数。

我的猜测是直接在适当的位置定义一个新函数更容易：

```
def five(): return len('hello') 
```

这是一个非常简单的行，不会使您的代码混乱并且非常清晰，因此我不会费心编写函数来替换它，特别是如果您在大量情况下不需要这种情况

# regex - 需要帮助使用 grep 从列表中提取名称

> ID：13483534
> 
> 赞同：0
> 
> 时间：2012-11-20T22:47:38.350
> 
> 标签：regex, linux, bash, command-line, grep

我有这个球员名单，我想得到球员全名，后跟 9 个或更少的字符，我[`grep`](http://en.wikipedia.org/wiki/Grep)在 Linux 中使用该命令。

我尝试了以下方法，但它没有按我预期的方式工作：
`cat players.txt | grep -E ' .[0-9]_\('`

这是我正在使用的数据示例（players.txt 文件的一部分）

```
* Ron_Springett_(1959-1966),_33_Caps
* Alex_Stepney_(1968),_1_Cap
* Nobby_Stiles_(1965-1970),_28_Caps
* Mike_Summerbee_(1968-1973),_8_Caps
* Peter_Swan_(1960-1962),_19_Caps
* Bobby_Tambling_(1962-1966),_3_Caps
* Derek_Temple_(1965),_1_Cap
* Peter_Thompson_(1964-1970),_16_Caps
* Robert_Thomson_(1963-1964),_8_Caps
* Terry_Venables_(1964),_2_Caps
* Dennis_Viollet_(1960-1961),_2_Caps
* Anthony_Waiters_(1964),_5_Caps
* Gordon_West_(1968-1969),_3_Caps
* Frank_Wignall_(1964),_2_Caps
* Ray_Wilson_(1960-1968),_63_Caps
* Tommy_Wright_(1968-1970),_11_Caps
* Gerald_Young_(1964),_1_Cap 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:58:58.927

你的问题有点模糊，但这看起来或多或少像你想要做的。

```
cat players.txt | perl -ne '
    s/_/ /g; 
    /([A-Za-z]+ [A-Za-z]+).*?([0-9-]+)/ && print "$1 \t $2\n"
'

Ron Springett    1959-1966
Alex Stepney     1968
Nobby Stiles     1965-1970
Mike Summerbee   1968-1973
Peter Swan   1960-1962
Bobby Tambling   1962-1966
Derek Temple     1965
Peter Thompson   1964-1970
Robert Thomson   1963-1964
Terry Venables   1964
Dennis Viollet   1960-1961
Anthony Waiters      1964
Gordon West      1968-1969
Frank Wignall    1964
Ray Wilson   1960-1968
Tommy Wright     1968-1970
Gerald Young     1964 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T09:08:40.497

这根据您的问题有效；

```
grep -Eo '[A-Za-z_]+\([0-9-]{0,9}\)' players.txt

Ron_Springett_(1959-1966)
Alex_Stepney_(1968)
Nobby_Stiles_(1965-1970)
Mike_Summerbee_(1968-1973)
Peter_Swan_(1960-1962)
Bobby_Tambling_(1962-1966)
Derek_Temple_(1965)
Peter_Thompson_(1964-1970)
Robert_Thomson_(1963-1964)
Terry_Venables_(1964)
Dennis_Viollet_(1960-1961)
Anthony_Waiters_(1964)
Gordon_West_(1968-1969)
Frank_Wignall_(1964)
Ray_Wilson_(1960-1968)
Tommy_Wright_(1968-1970)
Gerald_Young_(1964) 
```

如果您需要其他格式，我建议使用 sed 而不是 grep。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T22:51:46.417

我不确定您所说的“不超过 9 个字符”是什么意思，但假设您想要一个不超过 9 个字符的全名，它是`' .{0,9}_('`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T08:31:48.637

不确定你的意思，但如果你想要提取球员姓名和年份/年份范围，你可以用 grep 这样做：

```
<players.txt grep -Eo '[^ *][^)]+\)' | tr '_' ' ' 
```

tr 将下划线转换为空格，输出：

```
Ron Springett (1959-1966)
Alex Stepney (1968)
Nobby Stiles (1965-1970)
Mike Summerbee (1968-1973)
Peter Swan (1960-1962)
Bobby Tambling (1962-1966)
Derek Temple (1965)
Peter Thompson (1964-1970)
Robert Thomson (1963-1964)
Terry Venables (1964)
Dennis Viollet (1960-1961)
Anthony Waiters (1964)
Gordon West (1968-1969)
Frank Wignall (1964)
Ray Wilson (1960-1968)
Tommy Wright (1968-1970)
Gerald Young (1964) 
```

# python - urllib2：如何从 SSL 隧道回复中访问标头

> ID：13483541
> 
> 赞同：1
> 
> 时间：2012-11-20T22:47:59.477
> 
> 标签：python, ssl, urllib2, proxytunnel

我正在使用带有代理服务器的 SSL 隧道连接到目标服务器。我使用 http 连接到代理服务器，使用 HTTPS 连接到目标服务器。SSL 隧道正常工作，我可以与远程服务器交换 HTTPS 消息，但是有一个问题。代理服务器在回复 urllib2 的请求以建立我需要查看的 SSL 隧道的请求时返回一个标头，但我看不到使用 urllib2 (Python 2.7.3) 访问它的方法。

我想我理论上可以自己实现 SSL 隧道握手，但这会让我比我想要的（或者我觉得舒服的）更深入地了解协议。

建立 SSL 隧道时，有没有办法使用 urllib2 访问回复？

更新：

下面是使用代理服务器连接目标服务器的代码（代理服务器和目标服务器的 URL 不是实际的）：

```
proxy_handler = urllib2.ProxyHandler({'https': 'http://proxy.com'})
url_opener = urllib2.build_opener (proxy_handler)
request = urllib2.Request ('https://target_server.com/')
response = url_opener.open (request)
print response.headers.dict 
```

我使用 WireShark 查看消息流量。WireShark 不会向我显示与目标服务器交换的消息的正文，因为它们是加密的，但我可以看到 SSL 隧道握手的正文。我可以看到我感兴趣的标头从代理服务器返回。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:29:22.833

您如何调用 https 页面。

你正在用吗

```
resp = urllib2.urlopen('https')
resp.info().headers 
```

# .net - 我应该设置 AssemblyConfigurationAttribute 吗？

> ID：13483542
> 
> 赞同：10
> 
> 时间：2012-11-20T22:48:02.617
> 
> 标签：.net, assemblyinfo

`AssemblyConfigurationAttribute`在 .Net 程序集文件中设置是一种好习惯吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-05T01:16:47.223

我没有发现这特别有用（因为只有最底层的工具才会显示此信息），而且我从未见过它在我处理过的生产代码中使用过。

无论如何，如果您需要，只需将以下行添加到您的 AssemblyInfo.cs 文件中：

```
#if DEBUG
[assembly: AssemblyConfiguration("Debug")]
#else
[assembly: AssemblyConfiguration("Release")]
#endif 
```

# sql - 我如何将其从执行 AND 操作切换到 OR？

> ID：13483545
> 
> 赞同：0
> 
> 时间：2012-11-20T22:48:05.827
> 
> 标签：sql, sql-server, tsql

现在，这个查询在一个名为 article 的表中搜索标题和摘要字段包含某个关键字的条目。它返回的集合是标题和摘要包含关键字的文章，但我想更改它，以便它返回标题或摘要包含关键字的文章。我将如何做到这一点？通过简单地将内部连接更改为外部连接？

```
BEGIN
    with articlesearch as (
    SELECT top 1000 FT_TBL.articleID, FT_TBL.title,FT_TBL.abstract,FT_TBL.publicationdate,
        (select j.journalID from journal  j where FT_TBL.journalID=j.journalID) as sourceID,
        (select j.journalname from journal  j where FT_TBL.journalID=j.journalID) as sourcename,
        (select j2.medabbr from journal j2 where FT_TBL.journalID=j2.journalID) as medabbr,
        (select j1.impactfactor from journal  j1 where FT_TBL.journalID=j1.journalID) as impactfactor,
        KEY_TBL.RANK,
        ROW_NUMBER() OVER (ORDER BY KEY_TBL.RANK desc) AS RowNumber
    FROM article AS FT_TBL 
        INNER JOIN 
            CONTAINSTABLE(article,title,@keyword) AS KEY_TBL
            ON FT_TBL.articleID = KEY_TBL.[KEY]
        INNER JOIN
            CONTAINSTABLE(article,abstract,@keyword) AS KEY_TBL2
            ON FT_TBL.articleID = KEY_TBL2.[KEY]
    where  FT_TBL.inactive=0
    ORDER BY RANK DESC
    )

    SELECT articleID, sourcename,title,abstract,publicationdate,medabbr  
    FROM articlesearch
    WHERE RowNumber BETWEEN @RowStart AND @RowEnd ORDER BY publicationdate desc;

END 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:04:37.593

以下版本将 s 更改`inner join`为`left outer join`s 并添加一个`where`子句以获得您想要的内容：

```
with articlesearch as (
SELECT top 1000 FT_TBL.articleID, FT_TBL.title,FT_TBL.abstract,FT_TBL.publicationdate,
    (select j.journalID from journal  j where FT_TBL.journalID=j.journalID) as sourceID,
    (select j.journalname from journal  j where FT_TBL.journalID=j.journalID) as sourcename,
    (select j2.medabbr from journal j2 where FT_TBL.journalID=j2.journalID) as medabbr,
    (select j1.impactfactor from journal  j1 where FT_TBL.journalID=j1.journalID) as impactfactor,
    KEY_TBL.RANK,
    ROW_NUMBER() OVER (ORDER BY KEY_TBL.RANK desc) AS RowNumber
FROM article AS FT_TBL 
    left outer JOIN 
        CONTAINSTABLE(article,title,@keyword) AS KEY_TBL
        ON FT_TBL.articleID = KEY_TBL.[KEY]
    left outer join 
        CONTAINSTABLE(article,abstract,@keyword) AS KEY_TBL2
        ON FT_TBL.articleID = KEY_TBL2.[KEY]
where FT_TBL.inactive=0 and (key_tbl.[key] is not null or key_tbl2.[key] is not null)
ORDER BY RANK DESC
)

SELECT articleID, sourcename,title,abstract,publicationdate,medabbr  
FROM articlesearch
WHERE RowNumber BETWEEN @RowStart AND @RowEnd ORDER BY publicationdate desc; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:52:09.810

看起来你可以将`INNER JOIN`每个更改为 a `LEFT JOIN`，这会让你得到你想要的。虽然我承认我不熟悉`CONTAINSTABLE`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:09:47.523

正如 DigitalD 所指出的，您需要将 更改`INNER JOIN`为`OUTER`，但是您还需要过滤至少有一个连接不为空的结果。

```
-- snip
----
-- /snip
FROM article AS FT_TBL 
    LEFT OUTER JOIN 
        CONTAINSTABLE(article,title,@keyword) AS KEY_TBL
        ON FT_TBL.articleID = KEY_TBL.[KEY]
    LEFT OUTER JOIN
        CONTAINSTABLE(article,abstract,@keyword) AS KEY_TBL2
        ON FT_TBL.articleID = KEY_TBL2.[KEY]
WHERE  FT_TBL.inactive=0
    AND (KEY_TBL.[KEY] IS NOT NULL OR KEY_TBL2.[KEY] IS NOT NULL)
ORDER BY RANK DESC
)

-- snip
----
-- /snip 
```

# java - 使用 Batik 读取 SVG 文件时使用自定义元素工厂

> ID：13483546
> 
> 赞同：0
> 
> 时间：2012-11-20T22:48:10.590
> 
> 标签：java, svg, batik

我正在尝试读取从旧程序导出的较大 (1 MB) svg 文件。我无权访问该程序或数据。我只有这个导出的 svg 文件，我可能需要定期从这个源导入一个新导出的 svg 文件。我发现使用蜡染的第一个问题是阅读此文件时非常严格。例如，Firefox 读取和显示此文件没有问题。蜡染（包括 Squiggle 无法显示，因为文档中有一些“自定义”标签）。我得到的例外是......

```
org.w3c.dom.DOMException: The current document is unable to create an element of the requested type (namespace: http://www.w3.org/2000/svg, name: menu).
    at org.apache.batik.dom.AbstractNode.createDOMException(AbstractNode.java:408)
    at org.apache.batik.dom.svg.SVGDOMImplementation.createElementNS(SVGDOMImplementation.java:211)
    at org.apache.batik.dom.svg.SVGOMDocument.createElementNS(SVGOMDocument.java:372)
    at org.apache.batik.dom.util.SAXDocumentFactory.startElement(SAXDocumentFactory.java:625)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:501)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:400)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2756)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:647)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:140)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:511)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:808)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:737)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:119)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1205)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:522)
    at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(SAXDocumentFactory.java:431)
    at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(SAXDocumentFactory.java:349)
    at org.apache.batik.dom.svg.SAXSVGDocumentFactory.createDocument(SAXSVGDocumentFactory.java:200)
    at com.samsix.nrg.io.SvgFileImporter.importFile(SvgFileImporter.java:74) 
```

...因此，使用不完全有用的链接[编写蜡染 Dom 扩展](http://xmlgraphics.apache.org/batik/using/extending.html#domExtension)，我设法编写了以下内容...

```
 public ImportReport importFile( final String    uri )
    throws
        IOException
{
    String parser = XMLResourceDescriptor.getXMLParserClassName();
    SAXSVGDocumentFactory factory = new SAXSVGDocumentFactory(parser);

    SVGDOMImplementation    implementation = (SVGDOMImplementation) factory.getDOMImplementation( null );

    implementation.registerCustomElementFactory( "http://www.w3.org/2000/svg",
                                                 "menu",
                                                 new ExtensibleDOMImplementation.ElementFactory() {
                                                    @Override
                                                    public Element create( final String prefix,
                                                                           final Document doc )
                                                    {
                                                        System.out.println( "Element.create: " + prefix );
                                                        return new GenericElement( "prefix",
                                                                                   (org.apache.batik.dom.AbstractDocument) doc );
                                                    }
                                                } );

    SVGDocument    doc = (SVGDocument) factory.createDocument( uri );

    System.out.println( doc.getDocumentURI() );
} 
```

但是我得到了同样的错误， System.out.println() 语句从未被命中，所以它显然没有正确注册我的工厂。附带说明一下，无论如何，是否有使 Batik 不那么严格，以便它像 Firefox 那样跳过它不理解的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:24:23.033

调查表明，[Batik 1.7.0 实现](http://grepcode.com/file/repository.springsource.com/org.apache.batik/com.springsource.org.apache.batik.dom.svg/1.7.0/org/apache/batik/dom/svg/SVGDOMImplementation.java#SVGDOMImplementation.0factories)不允许您创建拦截 SVG 命名空间中元素的 DOM 扩展；它会在其他情况下抛出异常，否则它会直接进入将执行注册工厂查找的代码。我不知道这是不是故意的。[有趣的是，当前版本的SVG 规范](http://www.w3.org/TR/SVG/svgdtd.html)中似乎根本没有`<menu>`定义元素。它要么已被弃用很久，要么是放置在错误命名空间中的扩展。啊。

最简单的解决方法可能是使用 XSLT 样式表将`<menu>`元素重新映射到另一个名称空间（这是一个非常简单的样式表 IIRC），然后注册您的自定义处理程序以根据您的选择进行处理（如果它甚至是必要的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:53:03.027

现在这是一个很好的解决方案，因为我可以通过这个过滤器运行文件。在不久的将来，我希望能够让用户自己上传 svg 文件，然后它需要更强大的解决方案。这是我创建的 xslt ...

```
<xsl:stylesheet version="1.0" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <!--Identity Transform.-->
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="svg:menu"/>
</xsl:stylesheet> 
```

......我跑了......

```
java -jar /usr/share/java/saxon.jar original.svg svgfix.xslt > fixed.svg 
```

# php - PHP循环阻塞其余代码执行

> ID：13483555
> 
> 赞同：-6
> 
> 时间：2012-11-20T22:49:09.643
> 
> 标签：php, logic

我有一个看起来有点像这样的循环的 scipt

```
[CODE]  [BIG LOOP] [SOME MORE CODE] 
```

我面临的问题是，只要循环正在运行，php 代码就不会继续加载页面的其余部分（[更多代码]）。我该如何解决这个问题？任何指针？

我正在执行的循环是从 MYSQL 数据库中获取数据、下载和保存图像。之后，它正在删除临时 MYSQL 数据。

但是循环所做的并不重要，IMO 每个循环都会阻塞正在进行的代码，直到循环完成。

所以我的问题是，是否有可能执行循环，但也可以在代码中继续？如果没有（我在想什么），是否有任何合乎逻辑的解决方案我可以解决这个问题，因为我想在这个页面上加载两个“代码块”。我认为将代码拆分为 2 .phps 并将其分开将面临同样的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:55:08.417

你可以试试：

```
[CODE]  [SOME MORE CODE]  [BIG LOOP] 
```

但是如果“更多代码”依赖于“大循环”，那么你就有问题了。这里有一些想法：

*   优化您的循环。您的循环中可能存在某种严重的低效率。
*   少做点工作。也许你不需要处理整个大循环，可以少做一些处理。
*   缓存您的结果。如果经常执行相同的循环并产生相同的结果，也许您可​​以将结果保存在 file/APC/memcached 中？
*   使用 AJAX。加载一个没有来自大循环的数据的页面，然后让该页面使用 AJAX 加载您需要的数据。您可以展示一个带有“请稍候，我们正在获取您的数据”消息/图标/其他内容的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:59:22.853

如果`[BIG LOOP]`需要计算结果并且还需要在此之前出现在 HTML 中`[SOME MORE CODE]`：没有解决方法。我说的是如果`[CODE=HTML] [BIG LOOP=PHP] [SOME MORE CODE=HTML]`。否则，更精确（或给出代码）。当您说“加载页面的其余部分”时，您的意思是“加载 HTML 页面”吗？在这种情况下，所有 PHP 代码都必须已经执行。尽管您可能应该以不同的方式进行，但这里有一个可能的技巧：

```
[CODE] [DIV FOR AJAX]  [SOME MORE CODE] [AJAX INSTRUCTION TO LOAD RESULT OF BIG LOOP IN DIV] 
```

现在，就 PHP 编程而言，这可能是一种非常聪明的方法！

# java - 将自定义对象作为元素/节点的 Java 二叉搜索树

> ID：13483557
> 
> 赞同：1
> 
> 时间：2012-11-20T22:49:16.197
> 
> 标签：java, binary-search-tree

我有一个二叉搜索树，其中包含一个带有字符串和 int 的对象：

```
 public Person() {
        name = "";
        age = 0;
    }
    public Person(String n, int a) {
        name = n;
        age = a;
    } 
```

我将所有 Person 对象添加到我的树中，但我不确定如何获取名称字符串？我只知道如何抓取整个对象，因为我给出了一个特定的对象来搜索，但我希望能够搜索给定的名称。我只是在寻找如何获取字符串名称，而不是搜索的实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:51:45.880

具有属性名称的**公共 getter**方法。

```
public class Person {
private String name;
private int age;
 //your cons
public String getName(){
   return name;
}
public void setName(String name){
 this.name = name;
}
} 
```

当您从树中获取人员对象时。您可以在其实例上调用 getter 方法。

```
 Person p1 = getThePersonFromtheTree;
     System.out.println(p1.getName()); 
```

## 编辑：

> 是否有可能穿过树直到找到那个名字？

当然，您只需要不断迭代您的树，直到找到具有特定名称的对象。例如，如果您想找到一个名为**krishna**的人对象。

```
 for(int i=0; i<personsTree.size(); i++){
          if(personsTree.getTheObj(i).getName().equals("Krishna")){
               //found the object with name krishna
           }
     } 
```

# http - 通过 POST PuTTY 发送文件

> ID：13483558
> 
> 赞同：3
> 
> 时间：2012-11-20T22:49:19.783
> 
> 标签：http, protocols, putty

我已经找到以下内容： [使用原始 HTTP (Putty) 通过 POST 发送文件](https://stackoverflow.com/questions/7553005/sending-a-file-via-post-using-raw-http-putty)

然而，当我发送请求时，Putty 搞砸了该死的空行。无论我做什么，腻子总是`ENTER`从我的*空行*中取出，所以它会在我完成输入之前发送请求：

```
POST /somepath/ http/1.0
Content-Type: application/x-www-form-urlencoded
Content-Lenght:15

hhhteaj=555555 
```

问题是我的 post 请求必须带有那个空行，否则它的语法不正确。我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:09:55.307

是你拼错的事实：

```
Content-Lenght:15 
```

造成问题？应该：

```
Content-Length:15 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T00:27:26.307

我找到了解决此问题的方法。如果您将剪贴板中的请求粘贴到 PuTTY 会话中（在我的配置中单击鼠标右键执行此操作），然后按 Enter，整个请求将被发送。您可以使用任何文本编辑器（记事本、Vim、emacs、Kedit 等）创建请求并将其复制到剪贴板。

如果这不方便，您似乎可以只将换行符复制到剪贴板并使用鼠标右键越过不会导致会话结束的空白行。

# regex - Fitnesse 正则表达式与管道

> ID：13483562
> 
> 赞同：3
> 
> 时间：2012-11-20T22:49:33.747
> 
> 标签：regex, fitnesse

我正在使用 Fitnesse，我需要匹配 2 个可能的输出。

我的脚本表如下所示：

```
|script|MyClass|
|check|doSomething|value|=~/Result1|Result2/| 
```

我的问题是管道 | 在正则表达式中被读取为列分隔符。有没有办法逃脱管道字符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T22:52:08.070

快速谷歌搜索带来了这个转义序列：

```
!-|-! 
```

看[这里](http://old.nabble.com/escape-%7C-%28vertical-bar%29-in-fitnesse-wiki-td22298159.html)，[这里](http://old.nabble.com/Use-of-Pipe-%28%7C%29-in-fitnesse-td16631663.html)和[这里](http://fitnesse.org/FitNesse.UserGuide.QuickReferenceGuide)。

为了提高可读性，您可能应该像这样使用它：

```
|check|doSomething|value|!-=~/Result1|Result2/-!| 
```

# c# - 海量：使用存储过程

> ID：13483575
> 
> 赞同：1
> 
> 时间：2012-11-20T22:50:31.240
> 
> 标签：c#, stored-procedures, massive

我正在尝试使用 Massive micro-orm 执行存储过程。

```
var tbl = new DynamicModel("Conn", tableName: "User", primaryKeyField: "UserID");
var result = tbl.Query("EXEC User_INSERT @0,@1,@2,@3", "7843bf9d-9cb8-495b-aaa5-785ac74b82a5", "7FBDDG58-B08E-4723-9477-C9E791CDF36E", "Admin", "11/20/2012"); 
```

在调试时，它甚至不会进入 Massive 库。我也试过像...

```
var result = tbl.Query(@"EXEC ...); 
```

并且

```
var result = tbl.Query("User_INSERT @0,...); 
```

似乎没有任何工作。使用相同的句柄 SELECT 查询有效，但不是存储过程。如果我在语句中创建一个断点并在“快速监视”中加载它并展开动态结果，它会启动存储过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-26T20:36:05.997

DynamicModel.Query 返回一个 IEnumerable，因此查询（或本例中的存储过程）永远不会在 SQL 中执行，直到需要在 C# 代码中评估 IEnumerable。

您可以通过简单地将 .ToList() 添加到 .Query() 调用的末尾来强制评估 IEnumerable：

```
var tbl = new DynamicModel("Conn", tableName: "User", primaryKeyField: "UserID");
var result = tbl.Query("EXEC User_INSERT @0,@1,@2,@3", "7843bf9d-9cb8-495b-aaa5-785ac74b82a5", "7FBDDG58-B08E-4723-9477-C9E791CDF36E", "Admin", "11/20/2012").ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T01:43:23.073

这只是一个粗略的猜测，因为我不明白您的错误消息是什么并且需要更多信息，但您不能将您的 GUID 作为字符串传递（除非它接受它作为字符串类型？）。也许尝试

```
var result = tbl.Query("EXEC User_INSERT @0,@1,@2,@3", 
New Guid("7843bf9d-9cb8-495b-aaa5-785ac74b82a5"), 
New Guid("7FBDDG58-   B08E-4723-9477-C9E791CDF36E"), "Admin", "11/20/2012"); 
```

# javascript - navigator.platform 的可靠性

> ID：13483579
> 
> 赞同：3
> 
> 时间：2012-11-20T22:50:56.650
> 
> 标签：javascript, http-headers

JavaScript 属性“navigator.platform”的可靠性如何？在什么情况下它可能会返回错误的操作系统？

# c# - 通过引用分配对象

> ID：13483581
> 
> 赞同：0
> 
> 时间：2012-11-20T22:51:06.480
> 
> 标签：c#, asp.net

我有两个 viewState 属性。

一个是一个`List<MyObject> MyObjects`
另一个是`MyObject SelectedObject`

每当用户从列表中选择一个对象时，我都会将其分配给 SelectedObject，如下所示：

```
SelectedObject = MyObjects.Where(x=>x.MyId ==IdSelectedInUI) 
```

这使我可以轻松操作`SelectedObject`.
现在，当我更改`SelectedObject`的属性时，如何将这些属性分配回列表中的原始对象？我正在考虑使用`ref`，但无法完全弄清楚。

**编辑** 所有对象都是类，而不是结构。
所以，这就是我所拥有的：

```
//Children are of type =List<MyParentObject.ChildObject>
 public MyParentObject MyParent
        {
            get
            {
                if (ViewState["MyParent"] == null)
                {
                    MyParent= GetItemsFromDatabase();
                }
                return (TaskInfo)ViewState["MyParent"];
            }

            set
            {
                ViewState["MyParent"] = value;
            }
        }

        public MyParentObject.ChildObject SelectedChild
        {
            get
            {
                return (MyParentObject.ChildObject)ViewState["Child"];
            }

            set
            {
                ViewState["Child"] = value;
            }
        }  
        protected onButtonClick()
        {
          SelectedChild =  MyParent.Children.Where(x=>x.Child_Id == Convert.ToInt32(txt.Text)).FirstOrDefault();
         SelectedChild.Property2 = "test2" //OldValue "test1"
         //now if I run 
        MyParent.Children.Where(x=>x.Child_Id ==Convert.ToInt32(txt.Text)).Select(x=>x.Property2) //Shows "test1" and I expect "test2"
        }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T22:54:32.570

`SelectedObject`是一个对象引用。它与列表中的原始对象相同 -`SelectedObject`并且“原始”对象是同一个对象。如果您看到的行为表明并非如此，请更新您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:08:07.167

这取决于。假设 MyObject 是一个类，它是“按值”传递的，但传递的值是对原始对象的引用。

例如：

```
void Mutate(SomeObject x)
{
     x.val = "banana";
}
void Reassign(SomeObject x)
{
     x = new SomeObject();
     x.val = "Garbage";
}
public static void Main()
{
     SomeObject x = new SomeObject();
     x.val = "Apple";
     Console.WriteLine(x.val); // Prints Apple
     Mutate(x);
     Console.WriteLine(x.val); // Prints banana
     Reassign(x);
     Console.WriteLine(x.val); // Still prints banana
} 
```

这就是 C# 中传递对象的工作方式。您可以修改内容，但不能修改对象本身的“值”（它是内存中指向它的指针）。

如果您希望更改对象的内容，则无需执行任何特殊操作。

通过 ref 参数传递对象将允许您重新分配对它的引用。例如，如果：

```
void Reassign(ref SomeObject x) // implementation 
```

在前面的示例中使用过，最终 WriteLine 的打印输出将是“垃圾”，因为引用本身已更改，并且由于 ref 参数，这也更改了调用者中的引用。

+Edit 如果 MyObject 是一个结构，但是，该结构在传递时会被复制，并且在不同的范围内重新分配它不会对原始结构产生影响。

你可以做的是让一个函数返回结构并分配它：

```
MyStruct Mutate(MyStruct x){}
// calling
myStruct = Mutate(myStruct); 
```

或者通过引用参数来做。

# user-interface - 将提示锁定到屏幕底部

> ID：13483585
> 
> 赞同：4
> 
> 时间：2012-11-20T22:51:31.610
> 
> 标签：user-interface, chat, go

全部。我正在用 Go 编写一个聊天客户端，作为我正在编写的库的概念验证。它需要接受用户输入并在同一个终端窗口中打印传入的消息。考虑以下。

```
user@debian ~ $ ./client
no session> 192.168.1.100
> Hello, there!
Hi!
> So, did you get that feature working yet?
Nope. I thought you were going to ask on StackOverflow.
>> Yeah, I'm aski 
```

如果在我打字时有另一条消息到达，那么它应该产生以下内容。

```
user@debian ~ $ ./client
no session> 192.168.1.100
> Hello, there!
Hi!
> So, did you get that feature working yet?
Nope. I thought you were going to ask on StackOverflow.
Or did you want me to?
>> Yeah, I'm aski 
```

有没有办法在 Go 中做到这一点？

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T00:09:15.207

如果您曾经使用过类似行为的控制台应用程序，它可能使用像 ncurses 这样的库来执行此操作。你不想自己编程，因为它非常复杂。

对于 Go，我推荐[termbox-go](https://github.com/nsf/termbox-go)。它很容易上手并且有一个结构良好的[api](http://go.pkgdoc.org/github.com/nsf/termbox-go)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:51:09.823

这可能不是正确的方法（不是控制台开发人员），但不久前我在 Go 中做了一个终端动画，我在我的 Android 手机上运行。通过清屏、绘图、清屏等方式完成。

我不记得我用来清除屏幕的内容，但例如我刚刚尝试过，`fmt.Print("\033[2J")`它似乎有效。这里要注意。平台甚至终端仿真器对转义序列清除屏幕的支持可能会有所不同。

但是考虑到这一点，您可以维护客户端应该是什么样子的缓冲区，当收到消息时，清除屏幕，然后更改并重新打印缓冲区。

# java - 将基于行的数据转换为 XML

> ID：13483589
> 
> 赞同：-1
> 
> 时间：2012-11-20T22:51:49.683
> 
> 标签：java, xml

我有一个表格，其中包含以下格式的数据：

![在此处输入图像描述](../Images/62bd4e99d732e3f161b0b82c7540ac71.png)

我需要进入以下 XML 格式：

```
<People>
     <Person>
          <FirstName>Mark</FirstName>
          <LastName>Smith</LastName>
          <PhoneNumbers>
               <PhoneNumber>
                    <Number>555-123-4567</Number>
                    <Type>Home</Type>
               </PhoneNumber>
               <PhoneNumber>
                    <Number>555-321-7654</Number>
                    <Type>Cell</Type>
               </PhoneNumber>
          <PhoneNumbers>
     <Person>
     <Person>
          <FirstName>Tim</FirstName>
          <LastName>Johnson</LastName>
          <PhoneNumbers>
               <PhoneNumber>
                    <Number>444-123-4567</Number>
                    <Type>Home</Type>
               </PhoneNumber>                   
          <PhoneNumbers>
     <Person>
     <Person>
          <FirstName>Larry</FirstName>
          <LastName>Walker</LastName>
          <PhoneNumbers>
               <PhoneNumber>
                    <Number>333-123-4567</Number>
                    <Type>Home</Type>
               </PhoneNumber>
               <PhoneNumber>
                    <Number>333-321-7654</Number>
                    <Type>Cell</Type>
               </PhoneNumber>
          <PhoneNumbers>
     <Person> 
```

我正在尝试发现这样做的最佳实践方式。不幸的是，当我被迫一一阅读表格的行时，我的双手被束缚住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T04:13:16.347

您可以使用 JAXB。假设您知道如何解析您的表格：

```
@XmlRootElement(name="People")
@XmlAccessorType(XmlAccessType.FIELD)
class People {
    @XmlElement(name = "Person")
    private List<Person> persons = new ArrayList<Person>();

    public void addPerson(Person person) {
        persons.add(person);
    } 
}

@XmlAccessorType(XmlAccessType.FIELD)
class Person {
    String FirstName;
    List<PhoneNumber> PhoneNumber;
}

@XmlAccessorType(XmlAccessType.FIELD)
class PhoneNumber {
    String Number;
    String Type;
}

public class Test {

    public static void main(String args[]) throws Exception {
        PhoneNumber phoneNumber = new PhoneNumber();
        phoneNumber.Number = "555-555-555";
        phoneNumber.Type = "Home";

        Person person = new Person();
        person.FirstName = "Peter";
        person.PhoneNumber = Arrays.asList(phoneNumber, phoneNumber);

        People people = new People();
        people.addPerson(person);
        people.addPerson(person);

        StringWriter s = new StringWriter();
        JAXB.marshal(people, s);

        System.out.println(s);
    }
} 
```

请注意，代码需要反应才能看起来更好

# php - 分层数据到数组中

> ID：13483593
> 
> 赞同：2
> 
> 时间：2012-11-20T22:52:12.700
> 
> 标签：php

对于以下问题，我需要一些逻辑，但无法理解。基本上我有一些数据，如以下数组

```
array(
    array('name' => 'Test1',
          'hierarchy'=> '1'),
    array('name' => 'Test2',
          'hierarchy'=> '1.1'),
    array('name' => 'Test3',
          'hierarchy'=> '1.2'),
    array('name' => 'Test4',
          'hierarchy'=> '1.2.1')
) 
```

现在我想以这样的方式输出一个数组

```
$array[1] = 'Test1';
$array[1][2][1] = 'Test4'; 
```

尝试了动态变量命名和动态创建多维数组，但似乎都不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:08:04.677

那是不可能的。

for`$array[1] = 'Test1';` `$array[1]`需要是一个字符串，但 for`$array[1][2][1] = 'Test4';`它需要是一个数组。

你可以这样做：

```
$array[1]['text'] = 'Test1';
$array[1][2][1]['text'] = 'Test4'; 
```

这是代码：

```
$result = array();

foreach ($input as $entry)
{
    $path_components = explode('.', $entry['hierarchy']);

    $pointer =& $result;
    foreach ($path_components as $path_component)
        $pointer =& $pointer[$path_component];

    $pointer['text'] = $entry['name'];

    unset($pointer);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:16:17.310

如果你不是绝对需要一个数组，你可以创建一个类并扩展[ArrayClass](http://www.php.net/manual/en/class.arrayobject.php)或者如果你只需要数组访问，你也可以实现[ArrayAccess](http://www.php.net/manual/en/class.arrayaccess.php)。从那里，您可以解析数据并返回应用程序所需的值。

# objective-c - 具有自定义选项/值的 NSObject 变量

> ID：13483600
> 
> 赞同：1
> 
> 时间：2012-11-20T22:52:46.657
> 
> 标签：objective-c, xcode, variables, nsobject

我不知道是否可以在目标 c 中声明一个带有一些预定义值的变量。

例如，我希望我的对象**"Location"**有一个名为**type**的变量，其可能值为：**"street"**、**"city"**或**"country"**。

这个想法是通过以下方式访问它：

```
Location *myLoction = [[Location alloc] init]
myLocation.type = city; 
```

然后做类似的事情：

```
if(myLocation.type == street) {
    //Do something here
} 
```

那可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T22:55:00.197

您正在寻找枚举：

```
typedef NS_ENUM(NSInteger, LocationType) {
    LocationTypeStreet,
    LocationTypeCity,
    LocationTypeCountry
};

@interface Location : NSObject 

@property (nonatomic) LocationType type;

@end 
```

您必须为这些值添加前缀，因为您没有命名空间。

```
if(myLocation.type == LocationTypeStreet) {
} 
```

# bash - 用第二个文件的内容替换一个文件中的字符串

> ID：13483613
> 
> 赞同：2
> 
> 时间：2012-11-20T22:53:52.197
> 
> 标签：bash, sed

我有两个文件：

*   `fileA`：

    ```
    date >> /root/kvno.out
    kvno serverXXX\$ >> /root/kvno.out 
    ```

*   `fileB`：

    ```
    foobar 
    ```

我需要创建一个新文件 ，`fileC`其内容与 相同`fileA`，但字符串`XXX`被替换为 的内容`fileB`：

```
date >> /root/kvno.out
kvno serverfoobar\$ >> /root/kvno.out 
```

我想使用`sed`.

我尝试了一些我发现的例子，但我只得到了`fileB`in的内容`fileC`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:04:59.433

这可能对您有用（GNU sed）：

```
sed '1{h;d};/XXX/{G;s/XXX\(.*\)\n\(.*\)/\2\1/}' fileB fileA >fileC 
```

编辑：

或者：

```
 sed 's|XXX|'$(tr -d '\n' <fileB)'|' fileA >fileC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T00:53:05.060

```
while IFS= read -r line; do
    echo "${line/XXX/$(< fileB)}"
done < fileA > fileC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T23:02:44.050

您的问题有些含糊不清，但如果我正确理解了您的要求，这将有效：

```
#!/bin/bash

string=$(cat fileB)
sed "s/XXX/$string/g" < fileA > fileC 
```

*警告：* `fileB`不能包含`/`

**解释：**

*   `string=$(cat fileB)`：将内容保存`fileB`到一个名为的变量中`string`
*   `sed "s/XXX/$string/g": use`sed `to replace all occurrences of`XXX `with what is inside the variable`$string `. (The`g` 部分表示全部替换）
*   `< fileA`: 输入重定向 -`fileA`用作输入
*   `> fileC`: 输出重定向 - 输出到`fileC`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T04:32:25.617

sed 是在单行上进行简单替换的出色工具。对于其他任何事情，只需使用 awk：

```
awk 'NR==FNR{b=b s $0; s=ORS; next} {sub(/XXX/,b)} 1' fileB fileA 
```

# php - 如何使用 php 创建 256 位加密的 zip 文件

> ID：13483614
> 
> 赞同：3
> 
> 时间：2012-11-20T22:53:54.613
> 
> 标签：php, encryption, aes

> **可能重复：**
> [使用 PHP 创建一个加密的 zip 存档](https://stackoverflow.com/questions/646195/create-an-encrypted-zip-archive-with-php)

如何使用 PHP 创建 256 位加密的压缩文件

如果有任何例子，那就太好了

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T23:10:00.757

在 Linux 上，您可以使用 7zip 创建 AES 加密的 zip 文件：

```
exec("7z a -p$PASSWORD -mem=AES256 -tzip $ZIP $SOURCE"); 
```

由[http://ubuntuforums.org/archive/index.php/t-1694923.html](http://ubuntuforums.org/archive/index.php/t-1694923.html)的*Nfabio提供*

一定要申请[`escapeshellarg()`](http://php.net/escapeshellarg)。

> 注意：虽然这种方法可行，但最好不要使用嵌入式密码调用 shell。从 php 7.2 开始，这将不再需要，因为[php 现在原生支持 AES zip 加密](https://stackoverflow.com/a/47589645/144364)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:13:55.617

我记得，PHP zip 类（我看到）/扩展不支持加密，所以对于便携式解决方案，我建议您：

*   压缩你的文件然后[加密它](https://stackoverflow.com/questions/2448256/php-mcrypt-encrypting-decrypting-file)。
*   使用 WinZip[兼容版本](https://stackoverflow.com/questions/646195/create-an-encrypted-zip-archive-with-php)加密您的文件。

# javascript - S3Slider jQuery 旋转一圈后停止

> ID：13483616
> 
> 赞同：1
> 
> 时间：2012-11-20T22:54:08.950
> 
> 标签：javascript, jquery, wordpress, slider

我在 WordPress 上使用 S3Slider。我希望它在旋转一圈后停止，但似乎无法弄清楚设置。

在 slider.js 文件中使用了以下代码。现在它在首页上的[http://beaconwc.com](http://beaconwc.com)上直播，希望它显示两张幻灯片，然后停止，直到用户刷新页面。

```
(function($){  

    $.fn.s3Slider = function(vars) {       

        var element     = this;
        var timeOut     = (vars.timeOut != undefined) ? vars.timeOut : 4000;
        var current     = null;
        var timeOutFn   = null;
        var faderStat   = true;
        var mOver       = false;
         var capOpacity  = vars.captionOpacity || .7;
        var items       = $("#" + element[0].id + "Content ." + element[0].id + "Image");
        var itemsSpan   = $("#" + element[0].id + "Content ." + element[0].id + "Image div");

        itemsSpan.css({
            'opacity': capOpacity,
            'display': 'none'
        });

        items.each(function(i) {

            $(items[i]).mouseover(function() {
               mOver = true;
            });

            $(items[i]).mouseout(function() {
                mOver   = false;
                fadeElement(true);
            });

        });

        var fadeElement = function(isMouseOut) {
            var thisTimeOut = (isMouseOut) ? (timeOut/2) : timeOut;
            thisTimeOut = (faderStat) ? 10 : thisTimeOut;
            if(items.length > 0) {
                timeOutFn = setTimeout(makeSlider, thisTimeOut);
            } else {
                console.log("Poof..");
            }
        }

        var makeSlider = function() {
            current = (current != null) ? current : items[(items.length-1)];
            var currNo      = jQuery.inArray(current, items) + 1
            currNo = (currNo == items.length) ? 0 : (currNo - 1);
            var newMargin   = $(element).width() * currNo;
            if(faderStat == true) {
                if(!mOver) {
                    $(items[currNo]).fadeIn((timeOut/6), function() {
                        if($(itemsSpan[currNo]).css('bottom') == 0) {
                            $(itemsSpan[currNo]).slideUp((timeOut/6), function() {
                                faderStat = false;
                                current = items[currNo];
                                if(!mOver) {
                                    fadeElement(false);
                                }
                            });
                        } else {
                            $(itemsSpan[currNo]).slideDown((timeOut/6), function() {
                                faderStat = false;
                                current = items[currNo];
                                if(!mOver) {
                                    fadeElement(false);
                                }
                            });
                        }
                    });
                }
            } else {
                if(!mOver) {
                    if($(itemsSpan[currNo]).css('bottom') == 0) {
                        $(itemsSpan[currNo]).slideDown((timeOut/6), function() {
                            $(items[currNo]).fadeOut((timeOut/6), function() {
                                faderStat = true;
                                current = items[(currNo+1)];
                                if(!mOver) {
                                    fadeElement(false);
                                }
                            });
                        });
                    } else {
                        $(itemsSpan[currNo]).slideUp((timeOut/6), function() {
                        $(items[currNo]).fadeOut((timeOut/6), function() {
                                faderStat = true;
                                current = items[(currNo+1)];
                                if(!mOver) {
                                    fadeElement(false);
                                }
                            });
                        });
                    }
                }
            }
        }

        makeSlider();

    };  

})(jQuery); 
```

谢谢！

来源 [http://www.serie3.info/s3slider/](http://www.serie3.info/s3slider/)

# java - 使用链表的循环调度程序

> ID：13483618
> 
> 赞同：0
> 
> 时间：2012-11-20T22:54:15.800
> 
> 标签：java, scheduling, round-robin

我正在尝试编写一个非常简单的操作系统模拟器，但我无法让我的循环算法工作。基本上我要做的是创建一个循环链表来存储进程的突发值。现在我得到一个空指针异常。自从我使用链表以来已经有一段时间了，所以请耐心等待我的代码：

```
public static void RR3(int numProcess, int[] cpuBurst, int[] arrivalTime){
    int quantum = 3,time = 0, temp;
    int completionTime = 0;
    LinkedList <Integer>process = new LinkedList();
    for (int i = 0; i < numProcess; i++) {
        process.add(i, cpuBurst[i]);
    }

    while (process.isEmpty() != true){

        for (int j  = 0; j < quantum; j++) {
            System.out.println(process.getFirst());
            if(process.peek() == 0 ){
                completionTime = completionTime + time;
                process.remove();
            }
            else{
                temp = process.pop();
                process.push(temp - 1);                   
                time++;                  
            }
        }
        process.addLast(process.getFirst()); 
        process.removeFirst();
    }

    double act = (double) completionTime/numProcess;
    System.out.println("-----------------RR3-----------------");
    System.out.println("             Act = " + act + "ms");  
} 
```

我使用链表对吗？任何帮助表示赞赏。编辑：我输入 System.out.println(process.getFirst()); 在第一个 for 循环之后获得某种堆栈跟踪，这是我的输出：

> 6 5 4 4 3 2 10 9 8 7 6 5 3 2 1 7 6 5 线程“main”中的异常 java.util.NoSuchElementException 4 3 2 1 4 3 1 在 java.util.LinkedList.getFirst(LinkedList.java:242 ) 2 1 在 OsSimulator.RR3(OsSimulator.java:61) 在 OsSimulator.main(OsSimulator.java:79) Java 结果：1

我输入的爆发时间是 6、4、10、7，所以看起来它在正确的轨道上，但我收到这条线的错误

```
process.addLast(process.getFirst()); 
```

现在它没有这样的元素例外。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:33:26.550

这意味着它所说的。没有第一个元素，因此`process`列表为空。

这一定会发生，因为在`j`循环中处理 quanta 使列表为空。

如果您添加跟踪代码以在每次迭代期间打印出整个列表，而不仅仅是第一个元素，那么发生的事情将变得非常明显。

调试总是让自己看到真正发生的事情，而不是猜测一个不透明的谜题。您必须可视化真正发生的事情（当您的大脑让您失望时）的主要工具是机器本身。添加跟踪代码或成为调试器专家。纪律是强迫自己看到真相。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:34:19.650

`process.getFirst()`我目前无法访问 eclipse 来检查这个，但是你确定你没有在从 for 循环内的列表中删除最后一个元素后尝试调用吗？

我建议在该行之前放置一个断点，然后在调试模式下运行代码进行验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-14T10:05:58.230

在调用之前`process.getFirst()`确保`List`不为空

```
public static void RR3(int numProcess, int[] cpuBurst, int[] arrivalTime) {
    int quantum = 3, time = 0, temp;
    int completionTime = 0;
    LinkedList<Integer> process = new LinkedList<Integer>();
    for (int i = 0; i < numProcess; i++) {
        process.add(i, cpuBurst[i]);
    }

    while (process.isEmpty() != true) {
        for (int j = 0; j < quantum; j++) {
            if (process.size() == 0)
                break;

            System.out.println("Process: " + process.getFirst());
            if (process.peek() == 0) {
                completionTime = completionTime + time;
                process.remove();
            } else {
                temp = process.pop();
                process.push(temp - 1);
                time++;
            }
        }
        if (process.size() == 0)
            break;
        process.addLast(process.getFirst());
        process.removeFirst();
    }

    double act = (double) completionTime / numProcess;
    System.out.println("-----------------RR3-----------------");
    System.out.println("             Act = " + act + "ms");
} 
```

# asp.net-mvc - .NET mvc3 验证最小长度，但不是必需的

> ID：13483624
> 
> 赞同：2
> 
> 时间：2012-11-20T22:54:47.897
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation

我目前正在使用 MVC 数据注释对我的模型执行验证。

```
[MinLength(4, ErrorMessage = "The {0} must be at least {2} characters long")]
[MaxLength(16, ErrorMessage = "The {0} must be {2} characters long or less")] 
[DataType(DataType.Password)]
[Display(Name = "New Password")]
public string Password { get; set; } 
```

但是，我一直在处理一个不需要的字段，但是当输入字段中有内容时需要有一个 MinLength 。只需删除

```
[Required] 
```

没有帮助。有没有办法在不创建另一个自定义验证属性的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:03:11.557

似乎您的属性具有空或空白字符串值，因为`MinLength`属性被`null`视为有效值：

```
public override bool IsValid(object value)
{
    this.EnsureLegalLengths();
    int length = 0;
    if (value == null) 
    {
        return true; // <-- null is valid!
    }
    string str = value as string;
    if (str != null)
    {
        length = str.Length;
    }
    else
    {
        length = ((Array) value).Length;
    }
    return (length >= this.Length);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:00:28.987

您正在寻找的注释是

```
[StringLength(100, ErrorMessage = "The {0} have to be {2} characters.", MinimumLength = 8)]
public string Password { get; set; } 
```

# javascript - 按名称绑定 Javascript 事件处理函数

> ID：13483627
> 
> 赞同：0
> 
> 时间：2012-11-20T22:55:01.100
> 
> 标签：javascript, function, binding

> **可能重复：**
> [JavaScript：var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/questions/336859/javascript-var-functionname-function-vs-function-functionname)

为什么这个工作...

```
$("#clickme").click( showAlert );

function showAlert() {
  alert( "Hiya" );
} 
```

……但不是这个……？

```
$("#clickme").click( showAlert );

var showAlert = function() {
    alert( "Hello" );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:03:55.663

这是由于[吊装](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)而发生的。
在您的第一种情况下，代码被解释为（注意如何首先评估函数声明）：

```
function showAlert() {
   alert( "Hiya" );
}
$("#clickme").click( showAlert ); 
```

你的第二个被解释为：

```
var showAlert;
$("#clickme").click( showAlert );

showAlert = function() {
   alert( "Hello" );
} 
```

由于`showAlert`是变量声明而不是函数声明（注意`var`关键字），因此首先计算变量声明，并且在绑定事件处理程序时，`showAlert`声明变量，但它保存`undefined`值。

这就是提升的作用：它将变量和函数声明*提升*到闭包的顶部。
有一些关于托管的好资源[，](http://elegantcode.com/2011/03/24/basic-javascript-part-12-function-hoisting/)包括[在 SO 上](https://stackoverflow.com/questions/3725546/variable-hoisting)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T22:59:01.137

第一个是一个`Function Declaration..`

第二个是一个`function Expression..`

**在执行任何代码之前首先读取**函数声明。****

 **所以第一个案例有效。第二种方法不起作用，因为在分配函数时尚未定义它，..

所以这会起作用

```
var showAlert = function() {
    alert( "Hello" );
}

$("#clickme").click( showAlert ); 
```

即，定义函数，然后分配处理程序**

# string - 从 Unix 文件的每一行中删除重复的字符串字符

> ID：13483628
> 
> 赞同：0
> 
> 时间：2012-11-20T22:55:00.863
> 
> 标签：string, file, unix, lines

我在 Unix 中有一个文件，每行末尾都有一个 '\' 字符。我想从每一行中删除它。有1000多行。

我看过一些例子，但并不完全奏效。我是 Unix 新手，希望能在这里得到答案。

谢谢，

抗体

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:56:10.947

尝试这样做：

```
sed -i.~ 's@\\$@@g' file.txt 
```

**解释**

*   `-i`在文件中替换真实的
*   `.~`用这个后缀制作备份文件
*   `s@@@`是替换的骨架语法（我任意选择`@`了分隔符）
*   `$`平均线尾

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T03:59:33.280

单线`Perl`。

```
perl -i~ -pe 's/\\$//' file 
```

这将创建带有`~`扩展名的原始备份，并`\`在每行的末尾替换 every。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T03:53:55.817

这消除了 e sed 's/.$//' original_file > new_file 的最后一个字符

# java - 方法声明无效，需要返回类型

> ID：13483629
> 
> 赞同：-2
> 
> 时间：2012-11-20T22:55:07.200
> 
> 标签：java

我在 public Rectangle(double width, double height){ 收到一个错误，说这是一个无效的方法声明，需要返回类型。我不知道如何解决它。这些也是我的作业说明：编写一个封装矩形的超类。矩形有两个属性，分别代表矩形的宽度和高度。它具有返回矩形的周长和面积的方法。这个类有一个子类，封装了一个平行六面体或盒子。平行六面体有一个矩形作为它的底，另一个属性是它的长度。它有两种计算和返回其面积和体积的方法。

```
`public class Rectangle1
{

private double width;
private double height;

public Rectangle1(){
}

public Rectangle(double width, double height){
this.width = width;
this.height = height;

}

public double getWidth(){
return width;
}

public void setWidth(double width) {
this.width = width;

}

public double getHeight(){
return height;

}

public void setHeight(double height){
this.height = height;

}

public double getArea(){
return width * height;
}

public double getPerimeter(){
return 2 * (width + height);

}

}

public class TestRectangle {

public static void main(String[] args) {

Rectangle1 rectangle = new Rectangle1(2,4);

System.out.println("\nA rectangle " + rectangle.toString());
System.out.println("The area is " + rectangle.getArea());
System.out.println("The perimeter is " +
rectangle.getPerimeter());
}
}` 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T22:55:59.897

**构造函数**名称应与您的**类名称**相同。`Rectangle1`因此，您的类名也`Constructor name`应该**相同**，目前**java编译器**将其作为**没有返回类型的方法**，因此它会**抱怨**。

```
public Rectangle(double width, double height){ 
```

应该

```
public Rectangle1(double width, double height){ 
```

# matlab - How to plot this equation in matlab

> ID：13483631
> 
> 赞同：0
> 
> 时间：2012-11-20T22:55:09.897
> 
> 标签：matlab, graph, plot, equation

alright well I have the follow function

```
y=sin(x)^2 + [(10+2x+x^2) / (5+2x^2)] 
```

i need to plot it on the interval y = -2 to y = 2 so how would I set that up?

I did this in matlab

```
 >>  y = sin(x).^2 + (10 + 2*x + x.^2)/(5+2*x.^2)
   >>  x = -2:0.01:2; 
```

is that a correct setup? Or have I done something wrong

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T22:56:16.560

You need to declare a variable before you use it. In this case, x doesn't depend on y, so declare it first. In addition, there is a `./` operator missing.

```
x = -2:0.01:2;
y=sin(x).^2 + (10+2*x+x.^2) ./ (5+2*x.^2);
plot(x,y) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-13T02:49:18.060

```
f = @(x) sin(x)^2 + [(10+2*x+x^2) / (5+2*x^2)];
ezplot(f) 
```

# ide - 可以在不删除“使用”的情况下从 Intellisense 隐藏 Linq 和其他扩展吗？

> ID：13483634
> 
> 赞同：6
> 
> 时间：2012-11-20T22:55:24.000
> 
> 标签：ide, visual-studio-2012, intellisense

有时我注意到我的 Intellisense 被我不经常使用的扩展方法弄乱了，我只是想看看当前对象中有什么可用的。

有什么办法可以隐藏智能感知的扩展？

现在我`using System.Linq`在处理不熟悉的对象时删除了和其他扩展，并将其重新添加，以便我可以编译

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T21:20:56.363

您可以分配`[EditorBrowsable(EditorBrowsable.Advanced)]`给自己的代码以隐藏某些方法。一些 IDE 工具（如 Resharper）和 VS Gallery 中的一些扩展可以修改或替换 Intellisense 菜单，使其功能更强大。

# regex - SAS 正则表达式匹配 1-3 位数字

> ID：13483640
> 
> 赞同：2
> 
> 时间：2012-11-20T22:56:02.300
> 
> 标签：regex, sas

我正在寻找一个 SAS 正则表达式来匹配字符串开头的 1-3 位数字，并且这样的数字序列后面应该跟空格 - 如下所示（`string1`和`string2`）`string3`：

```
data _null_;
string1='1   y';
string2='22  x';
string3='333 z';
string4='z1   y';
string5='2z  x';
rx=prxparse('/^\d????/');
if prxmatch(rx,string1) then put 'match';
if prxmatch(rx,string2) then put 'match';
if prxmatch(rx,string3) then put 'match';
if prxmatch(rx,string4) then put 'notmatch';
if prxmatch(rx,string5) then put 'notmatch';
run; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T02:03:55.370

只是为了好玩，一些微不足道的非正则表达式解决方案（每个都有弱点/优势取决于您的数据/期望的结果）......我不在这里检查大部分这些的长度，所以如果你需要消除你有的情况4 位或更多位（即，如果 string1="1234 main" 将失败）通过 length() 添加。

```
if notdigit(scan(string1,1)) then put 'no match';
if compress(scan(string,1),,'d') ne ' ' then put 'no match'; 
```

NOTDIGIT 对于这样的事情来说是一个很棒的功能——如果你不需要检查 4 个以上的字符，这可能是一个比正则表达式更快的解决方案。

另外，建议 - 对于 SAS，如果您使用的是 9.2 或更高版本，您应该这样编写正则表达式：

```
rx=prxparse('/^\d{1,3}(?=\s)/o'); 
```

o 指示编译器只编译一次正则表达式。（这取代了旧的 'retain and if `_n_`=1' 方法。）如果您想匹配 3 位数字而不是其他任何东西（即，如果“333”是匹配项，则相反，您可能还想使用 \b 而不是 \s到“333”，并且可以有一个 3 宽度的变量） - \s 是一个空白字符，而 \b 是一个单词边界，它类似于 \s 但也包括字符串的结尾标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:18:33.037

有点不清楚你在找什么，但我相信你需要这个正则表达式模式

```
^\d{1,3}(?=\s) 
```

# php - 为什么我不能再将图像上传到我的文件夹？

> ID：13483642
> 
> 赞同：0
> 
> 时间：2012-11-20T22:56:15.057
> 
> 标签：php, codeigniter

这是我几周前所做的工作，但是在我对视图文件进行了一些更改之后，图像现在不再保存到我的资产/上传文件夹中。我不断收到错误消息 - 您没有选择要上传的文件。尽管已确保路径绝对正确，但仍然如此。我在这里做错了什么？

这是我的控制器：

```
<?php
class HomeProfile extends CI_Controller 
{

function HomeProfile()
{
parent::__construct();
$this->load->model("profiles");
$this->load->model("profileimages");
$this->load->helper(array('form', 'url'));
 }

 function upload()
      {
    $config['path'] = './web-project-jb/assets/uploads/';
    $config['allowed_types'] = 'gif|jpg|jpeg|png';
    $config['max_size'] = '10000';
    $config['max_width'] = '1024';
    $config['max_height'] = '768';

    $this->load->library('upload', $config);
    $img = $this->session->userdata('img');
        $username = $this->session->userdata('username');
    $this->profileimages->putProfileImage($username, $this->input->post("profileimage"));
//fail show upload form
    if (! $this->upload->do_upload())
{

    $error = array('error'=>$this->upload->display_errors());

    $username = $this->session->userdata('username');

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $this->load->view('shared/header');
    $this->load->view('homeprofile/homeprofiletitle', $viewData);
    $this->load->view('shared/nav');
    $this->load->view('homeprofile/upload_fail', $error);
    $this->load->view('homeprofile/homeprofileview', $viewData, array('error' => ' ' ));
    $this->load->view('shared/footer');

    //redirect('homeprofile/index');

}

else
{
    //successful upload so save to database

    $file_data = $this->upload->data();

    $data['img'] = base_url().'./web-project-jb/assets/uploads/'.$file_data['file_name'];
    // you may want to delete the image from the server after saving it to db
    // check to make sure $data['full_path'] is a valid path
    // get upload_sucess.php from link above
    //$image = chunk_split( base64_encode( file_get_contents( $data['file_name'] ) ) );

    $this->username = $this->session->userdata('username');

    $data['profileimages'] = $this->profileimages->getProfileImage($username);

    $viewData['username'] = $username;
    $viewData['profileText'] = $this->profiles->getProfileText($username);

    $username = $this->session->userdata('username');

}

    }

  function index()
  {

$username = $this->session->userdata('username');

$data['profileimages'] = $this->profileimages->getProfileImage($username);

$viewData['username'] = $username;
$viewData['profileText'] = $this->profiles->getProfileText($username);

$this->load->view('shared/header');
$this->load->view('homeprofile/homeprofiletitle', $viewData);
$this->load->view('shared/nav');
//$this->load->view('homeprofile/upload_form', $data);
$this->load->view('homeprofile/homeprofileview', $data, $viewData, array('error' => ' ' ) );
$this->load->view('shared/footer');
   }

   } 
```

这是我的看法：

```
<div id="maincontent">
<div id="primary"> 
<?//=$error;?>
 <?//=$img;?> 
 <h3><?="Profile Image"?></h3>
  <img src="<?php echo'$img'?>" width='300' height='300'/>
   <?=form_open_multipart('homeprofile/upload');?>
    <input type="file" name="img" value=""/>
    <?=form_submit('submit', 'upload')?>
    <?=form_close();?> 
    <?php if (isset($error)) echo $error;?>
  </div> 
</div> 
```

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T03:18:31.253

Codeigniter Upload 类显示“*您没有选择要上传的文件*”，因为它正在寻找数组`userfile`中的密钥。`$_FILES`

来自文档：[http ://codeigniter.com/user_guide/libraries/file_uploading.html](http://codeigniter.com/user_guide/libraries/file_uploading.html)

> ### `$this->upload->do_upload()`
> 
> 根据您设置的首选项执行上传。注意：默认情况下，上传例程期望文件来自名为**`userfile`**... 如果您想设置自己的字段名称，只需将其值传递给 do_upload 函数：
> 
> ```
> $field_name = "some_field_name";
> $this->upload->do_upload($field_name) 
> ```

所以你有两个选择，改变

```
<input type="file" name="img"> 
```

至

```
<input type="file" name="userfile"> 
```

...或改变

```
$this->upload->do_upload() 
```

至

```
$this->upload->do_upload('img') 
```

# sql - 如何在 Teradata SQL 中过滤掉 NaN FLOAT 值？

> ID：13483651
> 
> 赞同：1
> 
> 时间：2012-11-20T22:57:11.420
> 
> 标签：sql, teradata

使用 Teradata 数据库，可以通过 Java 将 NaN、-Inf 和 +Inf 的值加载到 FLOAT 列中。不幸的是，一旦这些值进入表中，在编写需要过滤掉它们的 SQL 时就会变得很困难。没有 IsNaN() 函数，您也不能“CAST ('NaN' as FLOAT)”并使用相等比较。

我想做的是，

```
SELECT
  SUM(VAL**2)
FROM
  DTM
WHERE
  NOT ABS(VAL) > 1e+21 AND
  NOT VAL = CAST ('NaN' AS FLOAT) 
```

但失败并出现错误 2620，“格式或数据包含错误字符。”，特别是在 CAST 上。我尝试过简单的“... AND NOT VAL = 'NaN'”，但由于类似原因也失败了（3535，“字符串转换为数值失败。”）。我似乎无法弄清楚如何在 SQL 语句中表示 NaN。即使我可以在 SQL 语句中成功表示 NaN，我也会担心比较会失败。根据 IEEE 754 规范，NaN = NaN 应该评估为假。我真正需要的是一个 IsNaN() 函数。然而，该功能似乎并不存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:57:11.420

我想出了一个变通办法，我会与那些正在寻找解决方案的人分享。但首先，对我来说很明显，Teradata 对 NaN 浮点值的处理是不完整的，我偶然发现的任何行为都可能是无意的，并且在不同版本之间不一致。因此，我提供以下免费建议，不提供任何形式的保证、承诺或责任。买者自负。

在深入研究数据后，我发现如果我将 FLOAT 值转换为 VARCHAR(50)，则 NaN 值会以 22 个星号 ( `**********************`) 的字符串形式出现。我可以改为转换为 VARCHAR(1)，NaN 以单个星号 ( `*`) 的形式出现。这个比较还不错。

```
SELECT
  SUM(VAL**2)
FROM
  DTM
WHERE
  NOT CAST (VAL AS VARCHAR(1)) = '*' AND
  ABS(VAL) < 1.0e+21 
```

我会注意两点。

首先，在我的 Teradata 版本上，我最初对“NOT ABS(VAL) > 1.0e+21”的渴望似乎在幕后转换为“ABS(VAL) <= 1.0e+21”。这（有时）失败，因为比较的平等药水 - 错误 [2651]，“涉及 VAL 的操作错误计算表达式”。我假设正在发生从“NOT >”到“<=”的转换，因为“NOT ABS(VAL) >= 1.0e+21”工作正常（但看起来很难看）。使用“ABS(VAL) < 1.0e+21”可以很好地满足需求。

其次，虽然我无法始终如一地重现它，但在我的历史中有一些例子，其中“ABS(VAL) <= 1.0e+21”确实有效地屏蔽了 NaN，有些则没有，有些则以 [ 2651]（见上文），但 SQL 和表中的数据是相同的。我能得出的唯一结论是，当涉及 NaN（或者它认为可能是）时，Teradata 在评估比较的方式上不一致。不同的放大器可能会以不同的方式处理它，但我不确定。也就是说，where 子句中的上述两个比较始终有效地筛选出 Inf 和 NaN 值。

# php - 如何将数组的一个元素（或键）转换为字符串变量？

> ID：13483661
> 
> 赞同：-1
> 
> 时间：2012-11-20T22:58:18.340
> 
> 标签：php

我有一个这样的数组：

```
array
(
[0] => "string0"
[1] => "string1"
) 
```

我希望能够做这样的事情：

```
$str = array[0];
print_r ($str); 
```

并得到这样的结果：

```
"string0" 
```

相反，我得到了这个：

```
str
(
[0] => "string0"
) 
```

我想获取数组的一个元素并将其转换为字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:00:14.400

您应该使用`echo`or`print`代替`print_r`

```
$str = $array[0];
echo $str; 
```

`print_r`用于显示变量信息
`echo`+`print`用于直接输出变量

# jquery - jquery找出没有stopPropagation会触发什么

> ID：13483662
> 
> 赞同：1
> 
> 时间：2012-11-20T22:58:28.377
> 
> 标签：jquery, events, checkbox

我在我的一些 html 中发现了一个问题，一个复选框正在阻止它的默认事件。很烦人。我发现如果我将 stopPropagation 直接添加到它可以工作的复选框。我想知道是否有办法找出正在触发的事件而不是仅仅停止传播（我不喜欢让事件以我不希望它们的方式工作:)）。

是否可以设置类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:02:44.647

安装firebug，在复选框的事件处理程序中创建断点并调试。就这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:05:06.937

您应该在浏览器中设置[Visual Event 。](http://www.sprymedia.co.uk/article/Visual+Event+2)

启动它，它会向您显示绑定到页面上各种元素的所有事件。我用它所有的时间。

# button - touchesbegin 和 touchesmoved

> ID：13483663
> 
> 赞同：0
> 
> 时间：2012-11-20T22:58:39.327
> 
> 标签：button, detect, touchesbegan, touchesmoved

我的问题是当我按住一个按钮时它有声音，此时我触摸我另一根手指的同一个按钮，它也有声音。那么当我已经在同一个按钮上按住手指时，我可以禁用另一个触摸吗？与 TouchesMoved 相同的问题。

int touchesCount;

-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

```
UITouch *touch = [touches anyObject];

CGPoint touchLocation = [touch locationInView:self.view];

if(CGRectContainsPoint(img1.frame,touchLocation)){

    if (!img1.isHighlighted && touchesCount < 1){

        [img1 setHighlighted:YES];
        [img2 setHighlighted:NO];

        NSLog(@" Image 1");

        CFBundleRef mainBundle = CFBundleGetMainBundle();
        CFURLRef soundFileURLRef;
        soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"c", CFSTR ("mp3"), NULL);

        UInt32 soundID;
        AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
        AudioServicesPlaySystemSound(soundID);
    }
}else {
    [img1 setHighlighted:NO];

}if (CGRectContainsPoint(img2.frame,touchLocation)){

    if (!img2.isHighlighted && touchesCount < 1){

        [img2 setHighlighted:YES];
        [img1 setHighlighted:NO];

        NSLog(@" Image 2");

        CFBundleRef mainBundle = CFBundleGetMainBundle();
        CFURLRef soundFileURLRef;
        soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"d", CFSTR ("mp3"), NULL);

        UInt32 soundID;
        AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
        AudioServicesPlaySystemSound(soundID);
    }
}else {
    [img2 setHighlighted:NO];
} 
```

}

-(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

```
UITouch *touch = [touches anyObject];

CGPoint touchLocation = [touch locationInView:self.view];

if(CGRectContainsPoint(img1.frame,touchLocation)){

    if (!img1.isHighlighted && touchesCount < 1){

        [img1 setHighlighted:YES];
        [img2 setHighlighted:NO];

        NSLog(@" Image 1");

    CFBundleRef mainBundle = CFBundleGetMainBundle();
    CFURLRef soundFileURLRef;
    soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"c", CFSTR ("mp3"), NULL);

    UInt32 soundID;
    AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
    AudioServicesPlaySystemSound(soundID);
    }
}else {
    [img1 setHighlighted:NO];

}if (CGRectContainsPoint(img2.frame,touchLocation)){

     if (!img2.isHighlighted && touchesCount < 1){

         [img2 setHighlighted:YES];
         [img1 setHighlighted:NO];

    NSLog(@" Image 2");

    CFBundleRef mainBundle = CFBundleGetMainBundle();
    CFURLRef soundFileURLRef;
    soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"d", CFSTR ("mp3"), NULL);

    UInt32 soundID;
    AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
    AudioServicesPlaySystemSound(soundID);
     }
}else {
    [img2 setHighlighted:NO];
} 
```

}

-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event{

```
[img1 setHighlighted:NO];
[img2 setHighlighted:NO]; 
```

}

*   (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event { [self touchesEnded:touches withEvent:event]; }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T00:50:49.457

由于您正在使用点击点坐标检测“按钮”的触摸，因此您只需在 touchesBegan 中添加逻辑以检查您的按钮是否已被点击。例如，在类中添加一个“BOOL button1Tapped”变量。

# java - Mac OS X Lion Ant Eclipse JBPM Java 错误

> ID：13483664
> 
> 赞同：1
> 
> 时间：2012-11-20T22:58:41.623
> 
> 标签：java, eclipse, macos, ant, jbpm

我正在尝试从终端执行命令：

```
ant start.demo 
```

并且在构建过程中出现以下问题：

> 构建失败/Users/iaevgenia/Documents/jbpm-installer/build.xml:846：执行失败：java.io.IOException：无法运行程序“./eclipse/Eclipse.app/Contents/MacOS/eclipse”：错误=13 ， 没有权限

我应该怎么办？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:24:28.743

我认为这很明显。添加适当的权限`./eclipse/Eclipse.app/Contents/MacOS/eclipse`

# javascript - IE10 中的 setDragImage

> ID：13483666
> 
> 赞同：5
> 
> 时间：2012-11-20T22:58:55.447
> 
> 标签：javascript, internet-explorer-10

有没有办法在 IE10 中创建可拖动元素的快照，而不是元素本身，而是动态创建的表示可拖动元素的元素？基本上，我在拖放 IE 10 浏览器 API 中寻找 setDragImage 方法，但在文档中找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-29T14:53:55.843

`setDragImage`在 IE10（更普遍的 IE）中不原生支持，但是有这个[polyfill](https://github.com/MihaiValentin/setDragImage-IE)。

我已经使用过它并且它完成了这项工作。

# c - 使用 gcc 时找不到库错误

> ID：13483669
> 
> 赞同：2
> 
> 时间：2012-11-20T22:59:03.820
> 
> 标签：c

我正在尝试编译一个示例 C 程序并将其链接到一些静态库文件，使用：

```
gcc -I /usr/local/include -L /usr/local/lib -l libsundials_cvode.a -l libsundials_nvecserial.a cvRoberts_dns.c -o cvRoberts_dns.o 
```

（我确信上面的库文件和包含文件目录是正确的。）

我得到的错误是：

```
/usr/bin/ld: cannot find -llibsundials_cvode.a
collect2: ld returned 1 exit status 
```

我有两个问题：

1) 是否正确使用 -L 和 -l 选项？

2）上面的错误是b/c gcc在错误的位置寻找库文件对吗？我试图`$LD_LOAD_PATH`通过我的终端设置来解决这个问题`/usr/local/bin`。我仍然收到上述错误。我该如何解决？

谢谢！

-罗汉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:01:39.947

改用 -lsundials_cvode - 删除“lib”和“.a”部分

请注意，LD_LOAD_PATH 用于在运行时定位动态库，而不是在编译期间。

编辑：

```
I just tried that. The change addresses the cannot find library error but 
now I am faced with many "undefined reference to" errors. Does this mean 
the linking of the library files has failed somehow? How do I correct this? 
```

这意味着您链接的库中没有其他需要解析的符号。请注意，您需要更改两个库（命令行上有两个）。也可能它们的顺序错误。

# html - 是否可以在 HTML 中创建多边形元素？

> ID：13483670
> 
> 赞同：3
> 
> 时间：2012-11-20T22:59:12.390
> 
> 标签：html

我目前正在尝试制作`button`一个梯形形状的。我找到了一种创建形状的方法，其中涉及 CSS 制作边框等。CSS 方法的工作方式与它制作形状的方式相同，但我遇到了一个问题，即整个元素都包含在一个矩形中，因此当您单击梯形外部的空白区域时，它仍会注册为单击元素。

简而言之，我试图使 HTML 元素成为梯形的形状，而不仅仅是可见的形状本身。因此，当用户单击按钮周围在可见梯形之外但可能在按钮矩形的实际边界内的任何区域时，它应该忽略单击。谢谢。

编辑：有人要求我举一个例子来说明我的意思。 [http://jsfiddle.net/MichaelMitchell/aR72g/9/](http://jsfiddle.net/MichaelMitchell/aR72g/9/) 在这个链接中，有红色梯形，但是你可以看到背景颜色也是绿色的，当你点击绿色时它仍然会激活一个`onclick`. 换句话说，我只希望红色能够触发 onclick。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:09:00.347

如果您不愿意使用涉及`map`属性和图像的技巧（[请参阅文档](http://www.w3schools.com/tags/tag_map.asp)），那么您不能在 HTML 中拥有除矩形之外的其他可点击区域，但即便如此，您的图像仍将始终包裹在矩形边界框中（因此您只能假装具有不同的形状通过使用具有透明度的图像并表示`map`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-23T19:46:49.637

You can work around this by giving it an onmousemove event that determines whether or not that coordinate is actually inside the trapezoid and adds/removes the onclick event accordingly. Something like this:

```
<figure id ="trapezoid" onmousemove="trapezoidMouseMove(event)">

<p>Button</p>
</figure>

<script>
function trapezoidClick(e)
{
    //Whatever you need it to do
    alert("inside");
}

    function trapezoidMouseMove(e)
    {
        //Fill in the angle of your trapezoid
        angle = Math.PI / 4;
        insideLeft = e.offsetX > Math.tan(angle) * e.offsetY;
        insideRight = e.offsetX < e.toElement.offsetWidth - Math.tan(angle) * e.offsetY;
        if (insideLeft && insideRight)
        {
            e.toElement.style.cursor = "pointer";
            e.toElement.onclick = trapezoidClick;
        }else{
            e.toElement.style.cursor = "default";
            e.toElement.onclick = null;
        }
    }
</script> 
```

# c# - LINQ 为什么“Enumerable = Enumerable.Skip(N)”很慢？

> ID：13483672
> 
> 赞同：14
> 
> 时间：2012-11-20T22:59:24.420
> 
> 标签：c#, linq, ienumerable

我遇到了 LINQ 查询的性能问题，因此我创建了一个小型简化示例来演示以下问题。该代码采用小整数的随机列表并返回该列表，该列表被划分为几个较小的列表，每个列表的总数为 10 或更少。

问题是（正如我写的那样）代码需要 N 成倍增长。这只是一个 O(N) 问题。当 N=2500 时，代码在我的电脑上运行需要 10 多秒。

如果有人能解释发生了什么，我会非常感激。谢谢，马克。

```
int N = 250;
Random r = new Random();
var work = Enumerable.Range(1,N).Select(x => r.Next(0, 6)).ToList();
var chunks = new List<List<int>>();

// work.Dump("All the work.");  // LINQPad Print
var workEnumerable = work.AsEnumerable();

Stopwatch sw = Stopwatch.StartNew();
while(workEnumerable.Any())  // or .FirstorDefault() != null
{
    int soFar = 0;
    var chunk = workEnumerable.TakeWhile( x => 
                          {
                              soFar += x;               
                              return  (soFar <= 10);
                          }).ToList();
    chunks.Add(chunk);          // Commented out makes no difference.
    workEnumerable = workEnumerable.Skip(chunk.Count); // <== SUSPECT
}
sw.Stop();

// chunks.Dump("Work Chunks.");   // LINQPad Print
sw.Elapsed.Dump("Time elapsed."); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T23:12:34.277

`.Skip()`所做的是创建一个新的循环源，并且仅在第一个元素`IEnumerable`之后才开始产生结果。`N`你连锁谁知道有多少这些一个接一个。每次调用`.Any()`时，都需要再次遍历所有先前跳过的元素。

一般来说，在 LINQ 中设置非常复杂的运算符链并反复枚举它们是一个坏主意。此外，由于 LINQ 是一个查询 API，`Skip()`因此当您尝试实现的目标相当于修改数据结构时，类似的方法是一个糟糕的选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T23:13:17.903

您有效地将 Skip() 链接到同一个可枚举对象上。在 250 个列表中，最后一个块将由一个惰性枚举创建，前面有 ~25 个“跳过”枚举器类。

如果你这样做了，你会发现事情变得更快了

```
workEnumerable = workEnumerable.Skip(chunk.Count).ToList(); 
```

但是，我认为整个方法可以改变。

如何使用标准 LINQ 来实现相同的目标：

### **[在http://ideone.com/JIzpml](http://ideone.com/JIzpml)**上现场观看

```
using System;
using System.Collections.Generic;
using System.Linq;

public class Program
{
    private readonly static Random r = new Random();

    public static void Main(string[] args)
    {
        int N = 250;
        var work = Enumerable.Range(1,N).Select(x => r.Next(0, 6)).ToList();

        var chunks = work.Select((o,i) => new { Index=i, Obj=o })
            .GroupBy(e => e.Index / 10)
            .Select(group => group.Select(e => e.Obj).ToList())
            .ToList();

        foreach(var chunk in chunks)
            Console.WriteLine("Chunk: {0}", string.Join(", ", chunk.Select(i => i.ToString()).ToArray()));
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T00:11:35.220

该`Skip()`方法和其他类似方法基本上创建一个占位符对象，实现 IEnumerable，它引用其父可枚举并包含执行跳过的逻辑。因此，循环中的跳过是无效的，因为它们不是像您认为的那样丢弃可枚举的元素，而是添加了一个新的逻辑层，当您真正需要第一个元素之后，它会延迟执行我跳过了。

您可以通过调用`ToList()`或来解决此问题`ToArray()`。这迫使对该方法进行“急切”的评估`Skip()`，并且确实摆脱了您从将要枚举的新集合中跳过的元素。这会增加内存成本，并且需要知道所有元素（因此，如果您在`IEnumerable`代表无限系列的情况下运行它，祝您好运）。

第二种选择是不使用 Linq，而是使用`IEnumerable`实现本身来获取和控制`IEnumerator`. 然后代替`Skip()`，只需调用`MoveNext()`必要的次数。

# shopify - 重定向到应用程序 URL 中的参数不一致

> ID：13483673
> 
> 赞同：0
> 
> 时间：2012-11-20T22:59:32.113
> 
> 标签：shopify

我们最近在日志中注意到，在某些情况下签名验证失败（这种情况以前没有发生过，最近几周开始发生）。我进一步调查并注意到 URL 参数中的不一致。

一些示例（出于隐私原因将商店名称替换为“xxx”）：

成功

/oauth2/shopify?code=7e8ec807e9f4b29b6e6d352ff5a654cc&shop=xxx.myshopify.com×tamp=1353377082&signature=3edc31eb7d93813313e937a9ac1c6f8c

/oauth2/shopify?shop=xxx.myshopify.com&signature=63103f985dabf0f102fe7ce8335c9c4c×tamp=1353377555

失败

/oauth2/shopify?shop=xxx.myshopify.com

/oauth2/shopify?code=&shop=xxx.myshopify.com×tamp=1353361621&signature=91927831bbbe9ca37472c2a3fa260a49

请注意，在失败的情况下，参数要么丢失（第一个请求中没有时间戳或签名），要么“代码”参数为空（对于第二个请求）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T23:14:57.333

这是一个已确认的错误，已在管道中进行了修复。对回归感到抱歉！

# powershell - 导出具有不同属性的对象的方法？

> ID：13483674
> 
> 赞同：0
> 
> 时间：2012-11-20T22:59:33.050
> 
> 标签：powershell, quest

我最近在编写脚本时遇到了一个常见问题，并决定将其抛诸脑后，看看其他人如何处理这个问题。

**tl;博士;** 我想导出具有不同数量属性的对象。例如; 对象 1 可能有 3 个 IP 地址，但对象 2 有 7 个 IP 地址。

我已经发展到创建一个具有自定义属性的新对象，然后将这些对象注入一个数组作为我捕获结果的方法 - 很高兴听到是否有更好的方法，但这就是我的方式。当对象以列表格式显示时，此方法在输出到屏幕时 100% 有效 - 当我想捕获和存储输出以在 Excell 中读取时，我尝试了许多导出/输出文件方法无济于事.

以下是我构建对象并存储它的示例（代码的功能在这里并不重要 - 只是它生成的结果）：

```
add-pssnapin Quest.ActiveRoles.ADManagement
$Groups = get-qadgroup AmbigousGroupNameHere-
$UserInfo = @()

ForEach ( $Group in $Groups ) {
    $CurrentGroupMembers = get-qadgroupmember $Group
    write-host "Processing group:" $Group
    ForEach ( $GroupMember in $CurrentGroupMembers ) {
        If ( $GroupMember.type -eq "User" ) {
            $counter = 1
            write-host "Processing member:" $GroupMember
            $UserObject = get-qaduser $GroupMember | select SamAccountName,FirstName,LastName

            $objUserInfo = New-Object System.Object
            $objUserInfo | Add-Member -MemberType NoteProperty -Name SamAccountName -Value $UserObject.SamAccountName
            $objUserInfo | Add-Member -MemberType NoteProperty -Name FirstName -Value $UserObject.FirstName
            $objUserInfo | Add-Member -MemberType NoteProperty -Name LastName -Value $UserObject.LastName

            $GroupMembership = get-qadgroup -ContainsMember $GroupMember | where name -like "AmbigousGroupNameHere-*"

            ForEach ( $GroupName in $GroupMembership ) {
                $objUserInfo | Add-Member -MemberType NoteProperty -Name CtxGroup$counter -Value $GroupName.SamAccountName
                $counter++
            }
            $UserInfo += $objUserInfo
        } else {
            write-host "This is a group - we are ignoring it."
        }
    }
}

$UserInfo | Export-Csv UsersOutput.csv -NoType 
```

从上面 - 你可以看到我为每个组将对象属性名称缩放 1。`CtxGroup$counter`允许我为每个用户拥有的正确组数缩放对象。确认默认情况下输出到屏幕时效果很好。该对象已列出，我可以看到与该用户匹配的每个组的新属性。

现在解决问题。当我`export-csv`或`out-file`文件基于第一个对象生成了足够的标题时，它会根据第一个对象具有的属性数量创建标题。因此，假设第一个用户有 3 个匹配组，它将创建 header `CtxGroup1, CtxGroup2, CtxGroup3`。伟大的！**不。**

如果下一个用户有 5 个匹配组 - 只有前三个包含在输出中，另外 2 个被丢弃，因为我们没有`CtxGroup4, CtxGroup5`.

其他人到底是如何处理这个问题的？

边注; 我考虑将我的第一个对象创建为具有大量对象（以及标题）的虚拟对象，但是很好 - 这并不酷，而且真的让我感觉效率低下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T04:46:46.453

您可以通过属性的数量获得您想要的排序`$UserInfo`数组，它可以完成，但它不是那么简单，在您的情况下，我会添加另一个属性与添加的组数：

```
...
ForEach ( $GroupName in $GroupMembership ) {
                $objUserInfo | Add-Member -MemberType NoteProperty -Name CtxGroup$counter -Value $GroupName.SamAccountName
                $counter++
            }
$objUserInfo | Add-Member -MemberType NoteProperty -Name NbCtxGroup -Value ($counter - 1)
$UserInfo += $objUserInfo
... 
```

然后在此属性上对数组进行降序排序：

```
$UserInfo | Sort-Object -Property NbCtxGroup -Descending | Export-Csv .\F.csv 
```

这不是很好，但它会成功。

看一下 ：

```
$objUserInfo.psobject.Properties | Measure-Object 
```

# git - 我有似乎是来自 git 的一种标记，它间歇性地散布在我的代码周围

> ID：13483676
> 
> 赞同：0
> 
> 时间：2012-11-20T22:59:35.500
> 
> 标签：git, github, titanium

```
<<<<<<< HEAD
=======
function patients($count = 20,$offset=0) { 
//unmodified code here
}
>>>>>>> 1f7cf457993ef185a960744695e79229b2acc055 
```

这些分散在我的代码中，由 github 客户端或 Titanium 工作室插入。我完全不知所措。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:01:53.453

`git`告诉你你有冲突。解决它们：[http ://www.kernel.org/pub/software/scm/git/docs/v1.7.3/user-manual.html#resolving-a-merge](http://www.kernel.org/pub/software/scm/git/docs/v1.7.3/user-manual.html#resolving-a-merge)

# php - 找不到codeigniter MY_Controller

> ID：13483677
> 
> 赞同：8
> 
> 时间：2012-11-20T22:59:36.393
> 
> 标签：php, codeigniter, controllers, extending-classes

我正在将 Codeigniter.2.1.3 用于网站，所以我需要扩展 CI_Controller 以便我可以添加一个与所有控制器一起执行的方法，所以我做了 user_guide 中的内容：

在 application/core 文件夹中创建一个名为 MY_Controller.php 的文件，在其中创建扩展 CI_Controller 的 MY_Controller 类，更改我的常规控制器以扩展 MY_controller，如下所示：MY_controller.php：

```
class MY_Controller extends CI_Controller{
    protected $page;
    # Constructor
    function __construct (){
        parent::__construct();
        #code shared with all controllers
    }
    public function get_page(){
        #code to get_the right page here
    }
} 
```

名为 Regular.php 的常规控制器：

```
class Regular extends MY_Controller{
     public function __construct(){
         parent::__construct();
     }
     public function index(){
          $this->get_page();
     }
} 
```

但不断出现以下错误：

> 致命错误：在第 2 行的 /var/www/immo/CodeIgniter_2.1.3/application/controllers/regular.php 中找不到类 'MY_Controller'

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T01:28:55.897

您需要包含您的`MY_Controller`课程或自动加载它。我建议您通过将以下内容添加到`application/config/config.php`文件中来自动加载它。

```
function __autoload($class)
{
    if (strpos($class, 'CI_') !== 0)
    {
        if (file_exists($file = APPPATH . 'core/' . $class . EXT))
        {
            include $file;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-05T18:28:50.583

确保文件名大小写正确。Linux 服务器区分大小写。所以如果类名是 My_Controller 那么文件名应该是 My_Controller.php

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-28T16:41:29.953

`$config['subclass_prefix'] = "MY_"`

签入`config.php`，当然你应该在 Controller Name Like`MY_Controller.php`和 Named ***"class MY_Controller...."中使用它***

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-14T06:52:16.973

在**config/config.php**

```
/* load class in core folder */
function my_load($class) {        

    if (strpos($class, 'CI_') !== 0) {            
        if (is_readable(APPPATH . 'core' . DIRECTORY_SEPARATOR . $class . '.php' )) {                
            require_once (APPPATH . 'core' . DIRECTORY_SEPARATOR . $class . '.php');                
        }
    }

}

spl_autoload_register('my_load'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-04T14:40:10.397

这个答案迟到了，但我得到了

> “致命错误：找不到类 'MY_Controller'”错误

当我`.php`在 web 根目录而不是 application/controllers 目录中有一个同名的控制器 () 文件时。

实际上，不知道它是如何到达那里的，但是当我删除它时问题就消失了。

# ruby - 我安装 Ruby Watir::WebDriver 有什么问题？

> ID：13483681
> 
> 赞同：1
> 
> 时间：2012-11-20T22:59:46.580
> 
> 标签：ruby, watir-webdriver

我正在尝试在 Ubuntu 10.04 上为 Ruby 运行 Watir。我已经在我的（无显示）服务器上安装了 Chrome 和 ChromeDriver，并安装了 selenium-webdriver Gem。但是当我尝试在 Watir 中创建浏览器时，我得到：

```
$ irb
irb(main):001:0> require 'rubygems'
=> true
irb(main):002:0> require 'watir-webdriver'
=> true
irb(main):003:0> browser = Watir::Browser.new :chrome
NoMethodError: undefined method `closed?' for nil:NilClass
        from /usr/lib/ruby/1.8/net/http.rb:1060:in `request'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/remote/http/default.rb:83:in `response_for'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/remote/http/default.rb:39:in `request'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/remote/http/common.rb:40:in `call'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/remote/bridge.rb:598:in `raw_execute'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/remote/bridge.rb:92:in `create_session'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/remote/bridge.rb:68:in `initialize'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/chrome/bridge.rb:29:in `initialize'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/common/driver.rb:37:in `new'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver/common/driver.rb:37:in `for'
        from /usr/lib/ruby/gems/1.8/gems/selenium-webdriver-2.26.0/lib/selenium/webdriver.rb:65:in `for'
        from /usr/lib/ruby/gems/1.8/gems/watir-webdriver-0.5.5/lib/watir-webdriver/browser.rb:35:in `initialize'
        from (irb):3:in `new'
        from (irb):3
        from :0
irb(main):004:0> 
```

在“Watir::Browser.new”调用后长时间停顿，我假设某种超时？也许试图与 Chromedriver 交谈？我正在运行相关 Gems 的这些版本：

```
$ gem list

*** LOCAL GEMS ***

addressable (2.3.2)
childprocess (0.3.6)
fastercsv (1.5.5)
ffi (1.2.0, 1.0.11)
libwebsocket (0.1.3)
multi_json (1.3.7, 1.0.4)
rubygems-update (1.8.24)
rubyzip (0.9.9)
selenium-webdriver (2.26.0, 2.18.0)
watir-webdriver (0.5.5)
websocket (1.0.3)
yajl-ruby (1.1.0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:47:03.003

我正在尝试无头运行 Chrome，但我没有运行 X 服务器。Xvfb 成功了，我现在正在工作：

[http://en.wikipedia.org/wiki/Xvfb](http://en.wikipedia.org/wiki/Xvfb)

[http://blog.kagesenshi.org/2007/06/running-x-applications-headless-using.html](http://blog.kagesenshi.org/2007/06/running-x-applications-headless-using.html)

# objective-c - 从外部源 iOS 下载图像

> ID：13483683
> 
> 赞同：0
> 
> 时间：2012-11-20T22:59:57.690
> 
> 标签：objective-c, ios, uiimageview, uiimage, retina-display

是否可以从 Web 服务器下载图像并以这样的方式保存它们

```
[UIImage imageNamed:@"filename"] 
```

仍然适用于 filename.png 和 filename@2x.png 就像它们一直在应用程序包中一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T02:59:46.547

添加我的评论作为答案。您可以尝试发送基于视网膜/非视网膜的比例，然后基于此下载单个图像。您无需担心组合两个图像和下载，因为设备可以是视网膜或非视网膜。您不需要同时使用两个图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:23:04.683

您可以根据设备本身的视网膜/非视网膜下载图像。无需将两者保存在同一设备中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T00:26:03.680

由于您正在考虑下载这两个图像，因此带宽*本身*并不重要，为什么不将这两个图像组合成一个多分辨率 TIFF 并从 Web 服务器下载呢？如果您这样做并从文件中加载图像，则会自动选择正确的分辨率。

# php - 如何每隔几秒查询一次数据库？

> ID：13483690
> 
> 赞同：0
> 
> 时间：2012-11-20T23:00:18.640
> 
> 标签：php, mysql, database

所以，这是我的代码：

```
<?php
//Connect to the database
include("config.php");

//Query the database and get the count  
$result = mysql_query("SELECT * FROM ads");  
$num_rows = mysql_num_rows($result);  
?> 
```

我怎样才能使它每隔几秒钟查询一次数据库的计数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:05:20.990

单独保存您的 PHP 脚本（在我的示例中位于 thescript.php 下方）

```
<?php

  //Connect to the database
  include("config.php");

  //Query the database and get the count 
  $q = mysql_query("SELECT count(*) as num FROM ads");
  $count = mysql_fetch_result($q,0,'num');
  echo $count; 

?> 
```

然后在 home.php 文件中使用 AJAX/javascript/jQuery：

```
 <script>
    $(function(){
      function loadNum()
      {  
        $('h1.countdown').load('thescript.php');
        setTimeout(loadNum, 5000); // makes it reload every 5 sec
      }
      loadNum(); // start the process...
    });
 </script> 
```

# python - 获取 AttributeError：vq.whiten 中的 sqrt

> ID：13483697
> 
> 赞同：0
> 
> 时间：2012-11-20T23:00:39.913
> 
> 标签：python, numpy, scipy, cluster-analysis

我无法使用`vq.whiten`from`scipy.cluster`来规范化我的数据。我传入了一个 numpy 数组，其中缺少的特征值用每个特征的平均值填充。

它卡住的线是：

```
data = scipy.cluster.vq.whiten(self.imputed) 
```

这是我用来替换缺失数据的代码。

```
imputed = np.array([self.masked[:,i].filled(self.masked[:,i].mean()) 
                   for i in range(np.shape(self.masked)[1])])
self.imputed = np.transpose(imputed) 
```

我确信这部分也有更好的方法，除了它似乎破坏了我的代码这一事实。这似乎是一种丑陋的方式，这通常意味着 Python 有更好的方式。

我尝试减少发送到的数组的数量，`whiten`但无论我在 Traceback 中得到以下内容。

```
Traceback (most recent call last):
  File "C:\Users\jamie.bull\workspace\Metadata\src\draft_workflow.py", line 87, in <module>
    dataset.cluster()
  File "C:\Users\jamie.bull\workspace\Metadata\src\draft_workflow.py", line 59, in cluster
    data = scipy.cluster.vq.whiten(self.imputed)
  File "C:\Enthought\Python27\lib\site-packages\scipy\cluster\vq.py", line 131, in whiten
    std_dev = std(obs, axis=0)
  File "C:\Enthought\Python27\lib\site-packages\numpy\core\fromnumeric.py", line 2467, in std
    return std(axis, dtype, out, ddof)
AttributeError: sqrt 
```

聚类适用于相同的数据集，没有任何丢失的数据，所以我不知道接下来要尝试什么。

**编辑：** 我尝试使用以下方法打印出`imputed`完整数据集和缺少数据的每个项目的类型：

```
for item in imputed:
    print type(item) 
```

两者之间的区别在于，当没有调用平均替换和转置的版本时，`numpy.ndarray`每一行都有一个，而被平均替换的版本每列都有一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T01:45:51.023

我现在已经解决了这个问题，所以我会把答案放在这里以供未来迷失的灵魂使用。`float`问题是当原始数据存储为时，我的平均替换是用 s 替换缺失值`numpy.float64`。

`dtype`解决方案是运行列表推导并通过设置to 来遵循它`np.float64`。似乎`whiten`不喜欢接收混合数据类型。

另外，解决了列表推导后不得不转置的丑陋问题，我重新发现了`np.column_stack()`. 现在的工作功能是：

```
def mean_impute(self):
    imputed = np.column_stack(self.masked[:,i].filled(self.masked[:,i].mean()) 
               for i in range(np.shape(self.masked)[1]))
    self.imputed = np.array(imputed, dtype=np.float64) 
```

**编辑添加**

很久以前，但我想我会在这里更新。我现在将使用 pandas 进行数据处理和使用`pandas`以及`fill_na()`这种情况。

OP中的违规行可以替换为：

```
imputed = self.masked.fillna(self.masked.mean()) 
```

# javascript - Jquery 追加在 div 前面

> ID：13483702
> 
> 赞同：-1
> 
> 时间：2012-11-20T23:01:09.560
> 
> 标签：javascript, jquery, jquery-ui

所以我使用 Jquery Drag/Drop 将某些东西拖放到仪表板上。我现在想将我放在仪表板上的任何东西拖出仪表板，以便将其销毁/从仪表板中删除。

我尝试向拖放到仪表板上的东西添加一个类，然后尝试向其中添加一个可拖动对象，但拖动不起作用，我认为是因为当我将元素附加到仪表板时，它出现在仪表板后面（颜色有点褪色）。

这是我的代码-

```
 $(".draggable").draggable({helper:'clone'});
    $("#favouritesDashboard").droppable({
        accept:".draggable",
        drop: function(event,ui) {
            var toDrop = $(ui.draggable).clone();
            //create smaller version
            $(toDrop).addClass("inDashBoard");

            $(this).append(toDrop);
        }
    });
   $(".inDashBoard").click(function(){
    console.log("clicking elem in dashboard");
   }); 
```

我已经用点击替换了第二个可拖动的，console.log 从不打印，这表明我认为正在发生的事情实际上正在发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:05:23.550

这是由于 jQuery 中事件绑定/侦听器的性质。

当页面加载时，您要触发点击事件的元素不存在，它们是动态添加的。因此，为了确保您的方法附加到与选择器匹配的新元素，您应该使用“on”或“live”

```
$(".inDashBoard").on( "click", function(){
   console.log("clicking elem in dashboard");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:11:07.917

用于后期绑定[http://api.jquery.com/on/](http://api.jquery.com/on/)。

```
$(document).on('click', '.inDashBoard', function(){
    console.log("clicking elem in dashboard");
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:30:37.507

这应该工作：

```
$(".inDashBoard").live('click', function(){
    console.log("clicking elem in dashboard");
}); 
```

# asp.net - 如果在内容页面上添加和使用 Ajaxtoolkit，UpdateProgress 下拉列表和文本框将不起作用

> ID：13483703
> 
> 赞同：0
> 
> 时间：2012-11-20T23:01:24.130
> 
> 标签：asp.net, updatepanel

伙计们，我有这个奇怪的问题。如果添加了 AjaxControlToolkit.Binary.NET4 并在内容页面（与母版页）上使用，UpdateProgress 将无法正常工作。如果下拉列表已更改或文本框已更改但提交按钮正常，则不会显示 UpdateProgress。

我在下面的 zip 中创建了项目，请告诉我如何解决这个问题。 [http://www.sendspace.com/file/eijczf](http://www.sendspace.com/file/eijczf)

如果使用母版页并安装了 AjaxControlToolkit，则 UpdateProgress 将不起作用 如果未安装 AjaxControlToolkit.Binary.NET4，则 UpdateProgress 将起作用 UpdateProgress 将在没有母版页的情况下起作用

这个已经测试过 IE8 和 Firefox V16.0.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:48:13.370

我终于弄明白了。只需设置 ClientIDMode="AutoID"

# python - 素数分解+优化中的递归问题

> ID：13483708
> 
> 赞同：0
> 
> 时间：2012-11-20T23:01:40.960
> 
> 标签：python, recursion, prime-factoring

我正在为任意数量的因子创建一个模块。在其中，我还有两个函数（一个导致调用另一个）来找到数字 n 的素数分解。

出现的问题是递归错误（如果我对递归的定义是正确的）。当我为一个数字调用该函数时，它会打印所有的质因数，然后将最后两个质因数相加并再次打印，并重复执行此操作，显然没有尽头。

到目前为止我的代码：

```
def primeFactors(n):
   from primenum2 import isPrime
   from math import sqrt
   global pFact, y
   x, pFact, y = 2, [], 0
   if isPrime(n):
      return n
   else:
      while x <= sqrt(n):
         if isPrime(x) and (n%x==0):
            pFact.append(x)
            y = n / x
            if isPrime(y):
               pFact.append(y)
               print pFact
               break
            else:
               primeFactors2(y)
         else:
            x += 1

#NEW FUNCTION - I made two functions to avoid another recursion error that was occuring.

def primeFactors2(y):
   from primenum2 import isPrime
   from math import sqrt
   z = 2
   while z <= sqrt(y):
      if isPrime(z) and (y%z==0):
         pFact.append(z)
         y = y / z
         if isPrime(y):
            pFact.append(y)
            print pFact
            break
         else:
            primeFactors2(y)
      else:
         z += 1 
```

当我输入（在 Shell 中）时：`primeFactors(600851475143)`<---这原本是针对 Project Euler

预期输出（我已经解决了问题）：`[71, 839, 1471, 6857L]`

实际输出：

```
[71, 839, 1471, 6857L]
[71, 839, 1471, 6857L, 1471, 6857L]
[71, 839, 1471, 6857L, 1471, 6857L, 71, 839, 1471, 6857L]
[71, 839, 1471, 6857L, 1471, 6857L, 71, 839, 1471, 6857L, 1471, 6857L]
[71, 839, 1471, 6857L, 1471, 6857L, 71, 839, 1471, 6857L, 1471, 6857L, 71, 839, 1471, 6857L] 
```

它一遍又一遍地执行此操作，将 1471 和 6857L 附加到列表中，然后再次打印。然后，它再次添​​加所有主要因素，然后再次打印。不知道为什么会这样。非常感谢任何输入。另外，如果有任何方法可以使此代码更快/更 Pythonic，请告诉我 :) 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:30:55.513

你做的工作太多了。您不需要 isPrime 或递归函数。以下是基于试除法的最简单整数因式分解函数的伪代码：

```
define factors(n)
  f := 2
  while f * f <= n
    if n % f == 0
      output f
      n := n / f
    else
      f := f + 1
  output n 
```

尽管这对于 Project Euler #3 来说已经足够了，但还有更好的方法来分解整数。当你准备好时，我谦虚地在我的博客上推荐[这篇文章](http://programmingpraxis.com/essays)，其中包括这个因式分解算法和其他算法，用包括 Python 在内的五种语言实现。

# shell - 如何检查参数在shell中是否有单个字符

> ID：13483711
> 
> 赞同：5
> 
> 时间：2012-11-20T23:02:01.960
> 
> 标签：shell, grep, arguments, character

我正在尝试制作一个脚本来检查一个参数是否有一个大写或小写字母，或者它是否有其他任何东西（例如一个数字或一个单词。）

到目前为止已经完成了：

```
if echo $1 | egrep -q '[A-Z]';
    then echo "Uppercase";
elif echo $1 | egrep -q '[a-z]';
    then echo "Lowercase";
else
    echo "FAIL";
fi 
```

不仅如果它不是一个字母，而且如果我插入一个单词或 2 个字母，都需要让它失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:03:52.347

你很亲近！

```
if echo $1 | egrep -q '^[A-Z]$';
    then echo "Uppercase";
elif echo $1 | egrep -q '^[a-z]$';
    then echo "Lowercase";
else
    echo "FAIL";
fi 
```

*   我刚刚添加了特殊字符`^`& `$`，分别*表示行首*和*行尾*
*   不需要`egrep`，`grep`就够了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:04:06.443

使用`case`：

```
case "$1" in
    [a-z]) echo First argument is a lower case letter;;
    [A-Z]) echo First argument is an upper case letter;;
    *) echo First argument is not a single letter;;
esac 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:45:47.613

如果你使用 bash，

```
if [[ $1 == [[:upper:]] ]]; then
    echo "$1 is a single capital letter"
elif [[ $1 == [[:lower:]] ]]; then
    echo "$1 is a single lowercase letter"
else
    echo "$1 is not a letter or is more than 1 char"
fi 
```

双等号告诉 bash 匹配右侧的模式。

# css - 你如何让按钮在几毫秒内增加大小（125%），然后在点击时返回原始大小？

> ID：13483713
> 
> 赞同：0
> 
> 时间：2012-11-20T23:02:06.013
> 
> 标签：css, css-transitions

这可能是一个 css3 转换的东西，但我对 css 的了解不够好，无法创建它。我主要想做的是让按钮的大小（原始大小的 125%）增长几毫秒，然后在页面转到下一页之前恢复到原始大小。这对 css/css3/transitions 是否可行，如果可以，如何实现？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:19:37.373

制作你的按钮`<a>`并使用`:active`伪类来做扩展效果。一个不弄乱布局的简单方法是`outline`属性。

**演示：** [[[[![jsFiddle](../Images/827f57786617d886d70c0bce0ccca6b6.png)](http://jsfiddle.net/ThinkingStiff/Du7gh/)]]]

### CSS：

```
.button {
    background-color: black;
    border: 1px solid black;
    color: white;
    display: inline-block;
    padding: 5px;
}

.button:active {
    outline: 10px solid black;    
} 
```

### HTML：

```
<a class="button">press me</a>
​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:09:17.270

Mozilla Developer Network 有一个很棒[的 CSS3 过渡介绍教程](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_transitions)。我建议逐步浏览一些示例和源代码，看看这是否可以帮助您弄清楚您正在尝试做什么。

至于动画长度的计时 - 您应该能够轻松地从上面的链接中调整“过渡计时效果采样器”，并尝试不同的计时，直到获得您正在寻找的效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:19:40.697

对于如此快速的效果过渡是不需要的，只需更改元素的大小即可。

几毫秒不足以使效果可见。任何小于 20 毫秒的时间。根本不可见，因为屏幕更新速度不够快，无法显示它。大约 100 毫秒。需要它看起来像一个故意的效果，而不仅仅是一个小故障。

例子：

```
$('input[type=button]').click(function(){
  var e = $(this);
  e.addClass('grown');
  window.setTimeout(function(){
    e.removeClass('grown');
  }, 100);
}); 
```

演示：http: [//jsfiddle.net/Guffa/GEHCZ/](http://jsfiddle.net/Guffa/GEHCZ/)

# c# - 在 MVC4 中，如何一次保存多行编辑？

> ID：13483715
> 
> 赞同：9
> 
> 时间：2012-11-20T23:02:39.610
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我能找到的 MVC4 应用程序的每个示例都一次对一行数据进行编辑。它显示所有数据行，每行都有一个编辑，可将您带到另一页并允许您编辑该行。

我想做的是在行中显示所有数据元素，而不是让用户必须在每一行上单击编辑，所有行的数据点都已经在用户可以直接更新的文本框中。页面上只有一个 SAVE 可以一次保存所有更新/编辑。

如何设置我的 MVC 应用程序来支持它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T23:28:57.887

您可以为此使用**EditorTemplates 。**下面的示例显示了普通表单发布示例。如果需要，您可以通过使用该`serialize`方法并发送表单值来对其进行 ajaxify。

假设您需要编辑课程的学生姓名列表。所以让我们为此创建一些视图模型

```
public class Course
{
  public int ID { set;get;}
  public string CourseName { set;get;}
  public List<Student> Students { set;get;}

  public Course()
  {
    Students=new List<Student>();
  }
}
public class Student
{
  public int ID { set;get;}
  public string FirstName { set;get;}
} 
```

现在在您的`GET`操作方法中，您创建我们的视图模型的对象，初始化`Students`集合并将其发送到我们的强类型视图。

```
public ActionResult StudentList()
{
   Course courseVM=new Course();
   courseVM.CourseName="Some course from your DB here";

   //Hard coded for demo. You may replace this with DB data.
   courseVM.Students.Add(new Student { ID=1, FirstName="Jon" });
   courseVM.Students.Add(new Student { ID=2, FirstName="Scott" });
   return View(courseVM);
} 
```

**现在在Views/** ***YourControllerName***下创建一个名为**EditorTemplates**的文件夹。然后在名为以下内​​容的视图下创建一个新视图*`Student.cshtml`*

 *```
@model Student
@{
    Layout = null;
}
<tr> 
 <td>
  @Html.HiddenFor(x => x.ID)
  @Html.TextBoxFor(x => x.FirstName ) </td>
</tr> 
```

现在在我们的主视图（StudentList.cshtml）中，使用 EditorTemplate HTML helper 方法来带来这个视图。

```
@model Course
<h2>@Model.CourseName</h2>
@using(Html.BeginForm())
{
  <table>
     @Html.EditorFor(x=>x.Students)
  </table>
  <input type="submit" id="btnSave" />
} 
```

这会将带有每个学生姓名的所有 UI 显示在包含在表格行中的文本框中。现在，当表单发布时，MVC 模型绑定将在`Students`我们的视图模型的属性中包含所有文本框值。

```
[HttpPost]
public ActionResult StudentList(Course model)
{
   //check for model.Students collection for each student name.
   //Save and redirect. (PRG pattern)
} 
```

**解决方案**

如果您想对此进行 Ajaxify，您可以监听提交按钮的点击，获取表单并将其序列化并发送到相同的 post 操作方法。您可以返回一些指示操作状态的 JSON，而不是保存后重定向。

```
$(function(){
  $("#btnSave").click(function(e){
    e.preventDefault();  //prevent default form submit behaviour
    $.post("@Url.Action("StudentList",YourcontrollerName")",
                    $(this).closest("form").serialize(),function(response){
   //do something with the response from the action method
    });
  });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:19:51.520

您只需要指定正确的模型、示例列表，并发送带有每行（数组元素）信息的 ajax，在服务器端读取它并相应地更新每个元素。为此，您使用 Post 请求。只需将元素列表作为参数传递给控制器​​并使用 ajax 传递它。

例如，您的控制器可以定义为：

```
public ActionResult Update(List<MyEntity> list)
{
...
}
public class MyEntity
{
public string Name {get; set;}
public int Count {get; set;}
} 
```

JavaScript 可以是：

```
var myList = new Array();
// fill the list up or do something with it.

$.ajax(
{
   url: "/Update/",
   type: "POST",
   data: {list: myList}
}
); 
```

当然，您的“保存”按钮具有单击事件处理程序，它将通过 ajax 调用调用该功能。

为了您的方便，您可以考虑使用 KnockoutJS 或其他 MVVM 框架将数据与客户端的 DOM 绑定。*

# ios6 - 嵌套的模态视图控制器在 iOS6 下给出奇怪的消息？

> ID：13483724
> 
> 赞同：1
> 
> 时间：2012-11-20T23:03:03.133
> 
> 标签：ios6, presentmodalviewcontroller

我正在展示来自另一个模态视图控制器的模态视图控制器，这在 iOS6 之前的所有 iOS 版本下都运行良好。但在 iOS6 下，我在模拟器中收到以下警告消息：

```
Warning: Attempt to present <UINavigationController: 0x14e93680> on <UINavigationController: 0x9fc6b70> while a presentation is in progress! 
```

如果出现此警告，则不会显示模态视图控制器。基本上我使用这样的代码来显示模态视图控制器：

```
WebAuthViewController *authController = [[WebAuthViewController alloc] initWithNibName:nil bundle:nil];
authController.challenge = challenge;
authController.delegate = self;
UINavigationController *aNavController = [[UINavigationController alloc] initWithRootViewController:authController];
[self presentModalViewController:aNavController animated:YES];
[aNavController release];
[authController release]; 
```

已经显示的视图是 UIWebView 也显示在模态视图中，如下所示：

```
WebViewController *addController = [[WebViewController alloc] initWithNibName:nil bundle:nil];
addController.urlToLoad = [NSURL URLWithString:urlString];
addController.delegate = self;

UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:addController];
navigationController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:navigationController animated:YES];

[navigationController release];
[addController release]; 
```

苹果文档仍然建议应该能够像这样堆叠导航控制器，所以我不知道为什么会发生这种情况。有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T05:00:05.293

一个视图控制器只能呈现一个视图控制器。这在以前可能是允许的，但由于内部重组可能在 iOS6 中强制执行（在 iOS6`presentModalViewController:animated:`中已弃用）。是时候改变你的视图控制器组织了。也许可以引入一个要呈现的导航控制器。如果已经存在一个视图控制器，请将下一个视图控制器推送到导航堆栈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-30T08:39:50.867

好的，这真的很愚蠢 - 我忘记了 curl 的 URL 周围的引号，并且 shell 确实在后台执行了没有参数的命令。

# mysql - 使用 GROUP_CONCAT 查询

> ID：13483728
> 
> 赞同：0
> 
> 时间：2012-11-20T23:03:16.867
> 
> 标签：mysql, sql, group-concat

我对mysql查询没有什么问题。我需要 GROUP_CONCAT 中的 GROUP_CONCAT 之类的东西。看：

数据库设计：

![在此处输入图像描述](../Images/126208587fb52c7a874e80a9e8eda95a.png)

```
SELECT cid, country, capital,
    GROUP_CONCAT(DISTINCT mid, '=',city SEPARATOR '|*|') AS data
FROM t1
    INNER JOIN t2 ON t2.c_id = t1.cid
    INNER JOIN t3 ON t2.c_id = t3.mid
WHERE t1.cid =1 
```

返回

```
[cid] => 1
[country] => France
[capital] => Paris
[data] => 1=Lyon|*|2=Chartres|*|3=Valence 
```

但我想加入这个查询表 t4（我不知道怎么做），如果输出看起来像这样就好了

```
[cid] => 1
[country] => France
[capital] => Paris
[data] => 1=Lyon=|*|2=Chartres=Max#Alex#Frank|*|3=Valence=John 
```

附言。t4.m_id = t3.mid

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:31:20.867

我不完全确定您为什么要在 SQL 中执行此操作，但这里有一个返回所需结果的版本：

```
SELECT  t1.cid,
  t1.country,
  t1.capital,
  GROUP_CONCAT(DISTINCT t34.mid,"=", t34.city, "=", t34.names ORDER BY t34.mid SEPARATOR "|*|" )AS data
FROM table1 t1
INNER JOIN table2 t2 
  ON t1.cid = t2.c_id
LEFT JOIN
(
  select t3.mid, t3.city,
    Coalesce(GROUP_CONCAT(DISTINCT t4.names SEPARATOR "#"), '') names
  from table3 t3
  left join table4 t4
    on t3.mid= t4.m_id
  group by t3.mid, t3.city
) t34
  ON t2.city_id = t34.mid
where t1.cid = 1
group by t1.cid, t1.country 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/869b9/23)

结果：

```
| CID | COUNTRY | CAPITAL |                                                DATA |
---------------------------------------------------------------------------------
|   1 |  France |   Paris | 1=Lyon=|*|2=Chartes=Max#Alex#Frank|*|3=Valence=John | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:27:31.667

您的数据模型非常混乱......我的意思是`t2.city_id = t3s.mid`......认真吗？

无论如何，这是一个解决方案：

```
SELECT cid, country, capital, GROUP_CONCAT(city_list SEPARATOR "|*|") AS data
FROM (
  SELECT mid, CONCAT(mid, "=", city, "=", COALESCE(names_list, "")) AS city_list
  FROM (
    SELECT m_id, GROUP_CONCAT(names SEPARATOR '#') AS names_list
    FROM t4
    GROUP BY m_id
  ) AS t4s
  RIGHT JOIN t3 ON t3.mid = t4s.m_id
) AS t3s
JOIN t2 ON t2.city_id = t3s.mid
JOIN t1 ON t1.cid = t2.c_id
GROUP BY cid 
```

结果：

```
| CID | COUNTRY | CAPITAL |                                                 DATA |
----------------------------------------------------------------------------------
|   1 |  France |   Paris | 1=Lyon=|*|2=Chartres=Max#Alex#Frank|*|3=Valence=John | 
```

[在 SQLfiddle 上查看](http://sqlfiddle.com/#!2/48236/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:34:56.970

用于测试的[SQL Fiddle 。](http://www.sqlfiddle.com/#!2/e6d65/53/0)

```
select distinct cid,country,capital,
group_concat(distinct t3.mid,"=",city, '=', coalesce(names, '') separator "|*|") as data
from t1
inner join t2 on t2.c_id = t1.cid
inner join t3 on t2.city_id = t3.mid
left join (select m_id, group_concat(names separator '#') as names
           from t4
           group by m_id) t5 on t3.mid = t5.m_id
where t1.cid =1; 
```

# php - 获取帖子/页面 URL - Wordpress

> ID：13483732
> 
> 赞同：0
> 
> 时间：2012-11-20T23:03:35.533
> 
> 标签：php, html, wordpress, url, post

我有以下代码

```
<div id="featured-posts" class="container_12">
<?php
 global $post;
 $myposts = get_posts('numberposts=3&category=12');
 foreach($myposts as $post) :
 ?>

 <?php global $post; ?>
    <?php
    $src = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), array( 5600,1000 ), false, '' );
    ?>

        <?php
            $colors = array("#000000", "#949c51", "#571c1e", "#f36533", "#782a80", "#f6a41d", "#ed1b24");
            $randomColor = $colors[array_rand($colors)];
        ?>

<a href="LINK OF THE POST"><div class="grid_4 featured-home" style="background: url(<?php echo $src[0]; ?> ) !important;">
    <div class="featured-details" style="border-color: <?php echo $randomColor; ?>;">   
        <h2 style="color: <?php echo $randomColor; ?>;"><?php the_title(); ?></h2>
        <?php the_excerpt(); ?>
    </div>
    <div class="featured-lower" style="border-color: <?php echo $randomColor; ?>;"></div>
</div></a>
 <?php endforeach; ?>
 </div> 
```

这需要最近的 3 个帖子，在类别 12 中，并将它们显示在一个 div 中。我希望整个 div 链接到帖子。你会看到它在哪里说**LINK OF THE POST**。谁能帮我把网址弄到这里？

谢谢dvent

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T23:22:30.563

Wordpress 提供了一个方法：the_permalink();

查看[http://codex.wordpress.org/The_Loop](http://codex.wordpress.org/The_Loop)。

您还可以使用 get_permalink($id) 方法。 [http://codex.wordpress.org/Function_Reference/get_permalink](http://codex.wordpress.org/Function_Reference/get_permalink)

# c++ - 在 Windows 7 32 位上安装 OpenSSL

> ID：13483737
> 
> 赞同：3
> 
> 时间：2012-11-20T23:03:58.427
> 
> 标签：c++, visual-c++, windows-7, openssl

谁能列出一组在 Windows 7 上安装 OpenSSL 的完整步骤？我尝试了很多东西，但总是发现缺少一个或另一个库。我知道 OpenSSL 依赖于 libxml2、pthread 库等等。我尝试从各种来源下载它们，但我对一个接一个出现的许多错误感到有点沮丧。如果有人以前做过，如果你能帮助我列出步骤，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:19:32.130

下载最新的 OpenSSL 源代码分发（目前是[openssl-1.0.1c.tar.gz](http://www.openssl.org/source/openssl-1.0.1c.tar.gz)），而不是 FIPS 模块（[在此处](http://www.openssl.org/docs/fips/fipsnotes.html)阅读），然后按照源代码分发根目录中的`INSTALL.W32`or文件中的简单步骤进行操作。`INSTALL.W64`这是微不足道的。您需要的是受支持的 VC++ 版本和 Perl 之一（[Strawberry Perl](http://strawberryperl.com/)对我来说很好用），您可以选择在一些地方使用[NASM](http://www.nasm.us/)来优化代码。

根据您是否使用 NASM，它将是（不使用）：

```
perl Configure VC-WIN32 no-asm --prefix=d:/openssl 
```

或（使用 NASM）：

```
perl Configure VC-WIN32 --prefix=d:/openssl 
```

其次是：

```
ms\do_ms 
```

然后在为配置的环境启动 VC++ 命令行（“Visual Studio XXXX 命令提示符”）后，从源代码分发的根文件夹执行：

```
nmake -f ms\ntdll.mak 
```

然后：

```
nmake -f ms\ntdll.mak test 
```

如果结果干净（“通过所有测试”）：

```
nmake -f ms\ntdll.mak install. 
```

我只是在这一步运行它，它完美地工作（像往常一样！）在 Visual Studio 2005 下最新发布的 OpenSSL (1.0.1c)。现在用 2010 重新尝试。

**编辑：**刚刚在“Visual Studio 命令提示符（2010）”下尝试过，它在这里也能正常工作。

**注意：请**考虑`INSTALL.W64`（“Caveat lector”）中的评论。

**另请注意：** FIPS 模块补充了 OpenSSL 发行版。当您构建 FIPS 模块时，您实际上并没有编译 OpenSSL 本身！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T04:24:57.527

我刚刚从 VS2012 的“开发人员命令提示符”中尝试过这个。

它工作得很好。通过了所有测试。

我的路上有 ActiveState Perl；我相信它领先于我机器上的 Strawberry Perl。

-- HerbM

# javascript - 我希望从角度资源加载数据子集

> ID：13483738
> 
> 赞同：1
> 
> 时间：2012-11-20T23:04:05.040
> 
> 标签：javascript, angularjs

我的 JSON 数据如下所示，包含在名为“parks.json”的文件中：

```
{
    "description": "Farnborough features a good amount of green space and is indeed surrounded by plenty more. Our Parks section aims to tell you, not only where they all are but a little bit about the history behind them and the people who look after them today.",
    "id": "parks",
    "name": "Parks",
    "locations": [
        {
            "name": "Queen Elizabeth Park",
            "lat": 51.29692,
            "lng": -0.76080000000000003,
            "synopsis": "Once part of Windsor Great Park"
        },
        {
            ...
        }
    ]
} 
```

以下 $resource 查询将检索上述数据片段：

```
return $resource('locations/:categoryId.json', {}, {
    query: {method:'GET', params:{categoryId:'categories'}, isArray:true}
  }); 
```

传入的 categoryId 是“parks”，因此上面的代码将检索我的整个 Parks.json 文件并将其加载到一个对象中。这很好，但是我只想将其中的一部分提取到数组或对象中。

我的问题是如何调整上述内容以仅提取位置？我对 lat 和 lng 值特别感兴趣。我已经完成了各种其他工作，需要采取这种行动，因为我不太熟悉如何做到这一点。

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T02:44:47.927

一些东西：

*   这可能不是`$resource`. `$http`在这种情况下会更可取，因为您并没有真正处理 RESTful Web 服务。您显然正在处理`GET`.json 文件上的 s 。Using`$resource`将实例化一堆你不需要也不能使用的额外功能和开销。
*   过滤您返回的结果的最佳位置是在服务器上。我知道你不能用 .json 文件真正做到这一点，但值得一提。
*   这实际上不是 $resource 甚至 Angular 的问题，就像 JavaScript 的问题一样，您想要做的是从数组中获取对象的子集。

所有这一切都说...如果您*必须*使用 $resource 执行此操作，您可以执行类似以下伪代码的操作：

```
// a factory to create your Park resource service.
app.factory('Park', ['ngResource', function($resource) {
    //your Park resource constructor.
    var Park = $resource('locations/:categoryId.json', {}, {
        query: {method:'GET', params:{categoryId:'categories'}, isArray:true}
      });

    //a "static" function on Park to filter results.
    Park.filter = function(parks, predicate) {
        var results = [];
        for(var i = 0; i < parks.length; i++) {
            var park = parks[i];
            if(predicate(park)) {
                results.push(angular.copy(park));
            }
        }
        return results;
    };

    //return the constructor
    return Park;
}]);

// a controller example to consume your service.
app.controller('MainCtrl', function($scope, Park) {
    // get all parks in category 123
    var allParks = Park.query({categoryId: 123});

    // filter the parks down to the ones named "Hooterville Park"
    $scope.parks = Park.filter(allParks, function(park) {
        return park.name === 'Hooterville Park';
    });
}); 
```

问题是，$resource 可以与 RESTful 资源一起使用，如下所示：

```
// create a basic resource.
var Foo = $resource('/Foo/:id');

// get and update one item.
var foo = Foo.get(123, function() {
    foo.name = 'Test';
    foo.email = 'blah@sample.com';
    foo.$save();
});

// create a new item.
var foo2 = new Foo();
foo2.name = 'New guy';
foo2.email = 'new@guy.com';
foo.$save();

// get and update a bunch of items.
var foos = Foo.query();
for(var i = 0; i < foos.length; i++) {
   var fooItem = foos[i];
   fooItem.name = 'Foo ' + i;
   fooItem.$save();
} 
```

因此，除非您打算这样做，否则我会说继续使用 $http。

# android - android junit 测试谷歌示例代码

> ID：13483747
> 
> 赞同：0
> 
> 时间：2012-11-20T23:04:40.513
> 
> 标签：android, junit

我已经从 developer.android 下载了这段代码

```
public class SpinnerTestActivity extends
        ActivityInstrumentationTestCase2<SpinnerActivity> {

    private SpinnerActivity mActivity;
    private Spinner mSpinner;
    private SpinnerAdapter mPlanetData;
    public static final int ADAPTER_COUNT = 9;
    public static final int INITIAL_POSITION = 0;
    public static final int TEST_POSITION = 5;

    private String mSelection;
    private int mPos;

    public SpinnerTestActivity() {
        super("com.android.example.spinner", SpinnerActivity.class);
    } // end of SpinnerActivityTest constructor definition

    @Override
    protected void setUp() throws Exception {
        super.setUp();

        setActivityInitialTouchMode(false);

        mActivity = getActivity();

        mSpinner = (Spinner) mActivity
                .findViewById(com.android.example.spinner.R.id.Spinner01);

        mPlanetData = mSpinner.getAdapter();

    } // end of setUp() method definition

    public void testPreConditions() {
        assertTrue(mSpinner.getOnItemSelectedListener() != null);
        assertTrue(mPlanetData != null);
        assertEquals(mPlanetData.getCount(), ADAPTER_COUNT);
    } // end of testPreConditions() method definition

    public void testSpinnerUI() {

        mActivity.runOnUiThread(new Runnable() {
            public void run() {
                mSpinner.requestFocus();
                mSpinner.setSelection(INITIAL_POSITION);
            } // end of run() method definition
        } // end of anonymous Runnable object instantiation
                ); // end of invocation of runOnUiThread
        this.sendKeys(KeyEvent.KEYCODE_DPAD_CENTER);
        for (int i = 1; i <= TEST_POSITION; i++) {
            this.sendKeys(KeyEvent.KEYCODE_DPAD_DOWN);
        } // end of for loop

        this.sendKeys(KeyEvent.KEYCODE_DPAD_CENTER);
        mPos = mSpinner.getSelectedItemPosition();
        mSelection = (String) mSpinner.getItemAtPosition(mPos);
        TextView resultView = (TextView) mActivity
                .findViewById(com.android.example.spinner.R.id.SpinnerResult);

        String resultText = (String) resultView.getText();

        assertEquals(resultText, mSelection);

    }
} 
```

我的问题是：如何调用 testSpinnerUI？从哪里？我已经阅读了 junit 文档，但无法弄清楚.. 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:19:52.677

不过，愚蠢的问题。我在这个[博客](http://mobile.tutsplus.com/tutorials/android/android-sdk-junit-testing/)中找到了答案。

测试用例的生命周期基本上是这样的：`construction`、`setUp()`、`tests run`、`tearDown()`和`destruction`。该`setUp()`方法用于执行所有特定测试使用的任何一般初始化。测试用例中要运行的每个测试都作为自己的方法实现，其中方法名称以“test”开头。然后该`tearDown()`方法用于取消初始化该`setUp()`方法获取的任何资源。每个特定的测试都有自己的以“test”开头的方法——“test”方法名称前缀区分大小写！

我最初的问题是测试方法是如何运行的，因为没有人调用它。但是从上面的测试来看，每种方法都应该先与测试相结合，才能被识别出来。

# html - 离线使用 JSbin.com 或 CSSDesk？

> ID：13483748
> 
> 赞同：0
> 
> 时间：2012-11-20T23:04:55.303
> 
> 标签：html, css

我不知道这是不是问这个问题的正确地方，但是......

有没有办法离线使用 JSbin.com 或 CSSDesk.com 或者有没有可以进行实时编辑的软件（如果我可以这样称呼它）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:14:54.297

我一直在尝试 adobe 支架，它既漂亮又轻巧，虽然它仍然是实验性的，但它确实可以正常工作。

您可以在此处获取安装程序：http: [//download.brackets.io/](http://download.brackets.io/)

它还具有使用浏览器实时编辑 html + css + javascript 的功能。

# django - Django Forms - 关联对象（模型表单集？）

> ID：13483752
> 
> 赞同：1
> 
> 时间：2012-11-20T23:05:23.460
> 
> 标签：django, django-views, django-forms

说我有这样的事情：

```
class Product(models.Model)
    name = models.CharField()
    description models.TextField()

class Image(models.Model)
    product = models.ForeignKey(Product, null=True, blank=True, related_name="images")
    image = models.ImageField() 
```

假设我正在创建一个表单，`Product`并且在这个表单中有一个部分允许您上传图像。这些图像是异步上传的。我怎样才能拥有它：

创建时：
创建产品并且图像与之相关。

编辑时：
获取产品，获取相关图像。产品已编辑，图像已编辑。

目前，我有一个视图可以同时完成创建或编辑的工作`Products`。如何完成此产品表单的图像相关部分？模型表单集？

**编辑：**

```
@login_required
def create_or_edit_product(request, product_id=None):
    # Redirect user if he has no account associated to him
    try:
        account = Account.objects.get(membership__user=request.user)
    except:
        login_url = reverse('login') + ('?next=%s') % request.path
        return HttpResponseRedirect(login_url)

    # Get product if product id passed
    product_instance = None
    if product_id is not None:
        product_instance = get_object_or_404(product, id=product_id)

    # Get related pictures if product exists. Get picture values (dictionary list, used for initial formset data) if pictures found.
    pictures = product.pictures.all() if product_instance is not None else None
    pictures_values = pictures.values() if pictures else []

    PictureFormSet = formset_factory(PictureForm, formset=BasePictureFormSet, extra=0, can_delete=False, max_num=40)

    if request.method == "POST":
        product_form = productForm(request.POST, prefix='product', instance=product_instance)
        picture_formset = PictureFormSet(request.POST, prefix='pictures', initial=pictures_values)

        # If forms are valid
        if product_form.is_valid() and picture_formset.is_valid():
            try:
                # Add account to product and save
                product = product_form.save(commit=False)
                if product_instance is None:
                    product.account = account
                product.save()

                # Remove picture-product relationships of current pictures
                if pictures is not None:
                    pictures.update(product=None)

                # Update each picture with the product and corresponding sort order. (The field 'id' is a picture object. The form converts the passed picture id to a picture object)
                for index, form in enumerate(picture_formset):
                    picture = form.cleaned_data['id']
                    Picture.objects.filter(id=picture.id).update(product=product, sort_order=index)

            except Exception, e:
                # Rollback changes - something went wrong
                transaction.rollback()
                print "Transaction Rollback: %s" % e
            else:
                # Commit changes and redirect to product edit page
                transaction.commit()
                return HttpResponseRedirect('product_edit', product_id=product.id)
    else:
        product_form = productForm(prefix='product', instance=product_instance)
        picture_formset = PictureFormSet(prefix='pictures')

    # TODO: change add template to an add/edit one
    return render_to_response('products/add.html', {
        'product_form' : product_form,
        'picture_formset' : picture_formset,
        'pictures' : pictures,
    }, 
    context_instance=RequestContext(request)) 
```

我是 Python 和 Django 的新手，但这是我的一些工作观点。（到目前为止，我只尝试添加新产品）

用户看到的表单具有包含每个图片 ID 的隐藏输入的缩略图。如果表单失败，我想重新显示缩略图以及隐藏的输入（已经保留）。为了使它工作，我猜我必须查询图片ID，但表格无效，那么我该怎么做呢？（如果这甚至是正确的道路）

你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:22:41.917

@Aamir Adnan 是对的，这`Model Formsets`是一种优雅的处理方式。

这是一个与您需要的类似的完整示例 - [http://stellarchariot.com/blog/2011/02/dynamically-add-form-to-formset-using-javascript-and-django/](http://stellarchariot.com/blog/2011/02/dynamically-add-form-to-formset-using-javascript-and-django/)

如示例所示，由于最终用户可能需要添加与产品相关的其他“图像”（在您的情况下），您将需要一些 javascript 逻辑来处理表单的动态添加，以便用户可以任意添加和保存时上传图片。

# vb6 - vb.NET DLL 注册免费 COM 与 VB6

> ID：13483753
> 
> 赞同：4
> 
> 时间：2012-11-20T23:05:31.397
> 
> 标签：vb6, com-interop

我正在尝试让最简单的免费注册 COM 项目在 64 位 Windows7 中工作！COM 组件也是最简单的 vb.NET DLL，它在注册时可以在 VB6 EXE 中正常工作。

谁能建议为什么清单不起作用？

我已经尝试使用 mt.exe 更新任何 VB6 内部清单，但一般错误表明 Project2.exe 中没有内部清单

VB6 程序 (Project2.exe) 清单是....

```
 <assemblyIdentity name="Project2.exe" version="1.0.0.0" type="win32"    processorArchitecture="x86"/>

    <dependency>
     <dependentAssembly>
      <assemblyIdentity name="ClassLibrary1" version="1.0.0.0" type="win32"/>
     </dependentAssembly>
    </dependency>

    </assembly> 
```

DLL（ClassLibrary1.dll）清单是......

```
 <assemblyIdentity name="ClassLibrary1" version="1.0.0.0" type="win32"/>

    <clrClass
       name="ClassLibrary1.Class1"
       clsid="{D9531C2A-3822-4222-8D45-BC507FCDF5F3}"
       progid="ClassLibrary1.Class1"
       threadingModel="Both"/>

    <file name="ClassLibrary1.tlb">
     <typelib
         tlbid="{DA8A00C1-1E14-4295-AEDE-F8F23DD8E43D}"
         version="1.0"
         helpdir=""
         flags="hasdiskimage"/>
    </file>

    </assembly> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T07:46:00.103

假设 Id 是正确的，清单是正确的。所以你的问题是别的。你得到什么错误信息？

我成功地使用了 RegFree Com，一旦您拥有正确的清单，它就为我省去了无数麻烦。我不嵌入它们。为此，我使用了 Maze 软件的[Side-by-Side Manifest Maker](http://www.mazecomputer.com/)，它们非常有用，非常值得投资。我粘贴了应用程序清单和其中一个 dll 的清单，为您提供了一个工作示例。

**Filename=MyVB6App.exe.Manifest**（注意 .exe. 标签）

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">

<assemblyIdentity name="MyVB6App.exe" version="2.8.0.127" type="win32" processorArchitecture="x86"/>
<description>Built with: Side-by-Side Manifest Maker (3.7.1.4434) (x86)</description>

<dependency>
 <dependentAssembly>
  <assemblyIdentity name="MyNetComWrapper" version="1.0.24.0" type="win32" publicKeyToken="6ABF096D69195FE6"/>
 </dependentAssembly>
</dependency>

</assembly> 
```

**Filename=MyNetComWrapper.Manifest**（注意 .dll.tag 的缺失）

```
<assemblyIdentity name="MyNetComWrapper" version="1.0.24.0" type="win32" publicKeyToken="6ABF096D69195FE6"/>

<description>Built with: Side-by-Side Manifest Maker (3.7.1.4434) (x86)</description>

<clrClass
   name="MyComNetWrapper.SomeClass"
   clsid="{A68F56A1-8425-3E06-BA83-856EC8422F5B}"
   progid="MyComNetWrapper.SomeClass"
   runtimeVersion="v4.0.30319"
   threadingModel="Both"/>
<clrClass
   name="MyComNetWrapper.SomeOtherClass"
   clsid="{D5156DAF-0421-36AE-84B6-5D915068B2DC}"
   progid="MyComNetWrapperc.SomeOtherClass"
   runtimeVersion="v4.0.30319"
   threadingModel="Both"/>

<file name="MyComNetWrapper.tlb">
 <typelib
     tlbid="{D189D056-66F1-4C01-8EB9-1F95BA11254A}"
     version="1.0"
     helpdir=""
     flags="hasdiskimage"/>
</file>

</assembly> 
```

# validation - CakePHP - 多个条件的自定义验证功能和消息

> ID：13483754
> 
> 赞同：0
> 
> 时间：2012-11-20T23:05:33.273
> 
> 标签：validation, cakephp

我在我的模型中创建了一个自定义验证函数。我知道每条规则（以及随后的验证函数）都可以返回一条错误消息，如 $validation 数组中定义的那样。但是我的函数会检查多个条件，我想返回一个更量身定制的条件模型验证错误消息，而不是更通用的错误消息。例如，我不想显示“您尚未通过条件 A 或 B”作为规则消息，而是说“您已通过条件 A”、“您已通过条件 B”或“您尚未通过条件 A 和 B”取决于哪一个被违反。那可能吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T19:42:53.543

您可以在 beforeValidate 或 beforeSave 回调中检查这些并在那里调用

```
$this->invalidate('field_name1', 'error_message1');
$this->invalidate('field_name2', 'error_message2'); 
```

ETC

通过这种方式，您可以获得所需的灵活性。

# arrays - 类中的结构数组

> ID：13483757
> 
> 赞同：1
> 
> 时间：2012-11-20T23:06:05.050
> 
> 标签：arrays, class, function, struct

我遇到了一个错误，我不断收到 cpp 文件中“使用”函数的“不是类型名称”。我正在尝试制作一个结构数组，以存储“项目”的数据。我正在制作一个基于文本的 RPG 游戏，所以我正在尝试创建一个具有使用功能的项目类，以在角色上使用各种项目（在结构数组中）。我试过用几种不同的方式编写它并以其他方式调用它，但我无法让这个错误消失。甚至将结构放在课堂之前、公共场所等。

```
class Items 
{ 
private:
    struct eating
    {
        int itemNumber;
        char name[30];
    };

public:
    Items();
    eating useables[10];
    void use(useables);
};

void Items::use(useables) // Error is here, tells me useables is not a type name
{
    // To use items on characters
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:10:35.507

您需要将类型和名称传递给您的函数：

```
void Items::use(eating useables)
{
    // To use items on characters
} 
```

如果您只想使用内部`useables`对象，则无需将其传递给函数，只需编写

```
void Items::use()
{
    useables[1].itemNumber = 1; // For instance
} 
```

# java - 如何“部署”服务器以便可以通过 Internet 访问它？

> ID：13483760
> 
> 赞同：1
> 
> 时间：2012-11-20T23:06:34.553
> 
> 标签：java, android

我最近开发了一个 Android 应用程序，Android 设备可以通过该应用程序与另一个运行该应用程序的 Android 设备进行通信。通信通过套接字进行，因此我开发了一个在我的计算机上运行的服务器。

这是我的问题：

只要所有设备以及 PC 在同一个 LAN 中（例如通过同一个路由器连接），我的 PC 上运行的服务器上的设备之间的通信就可以正常工作。

现在我想让服务器联机，以便 Android 设备可以连接到“在线”服务器并从任何地方通过服务器相互通信。

我根本不知道如何使服务器联机并运行。我怎样才能做到这一点？

主要问题是，我知道本地客户端/服务器通信，但在“在线”领域没有经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:12:53.277

这更像是一个网络问题而不是编程问题。您的服务器打开一个套接字，因此任何能够访问该套接字的人都可以使用。

您必须在路由器上进行重定向。问题是你的机器没有公共IP，只有你的路由器有。因此，例如，当您的路由器在端口 21 上收到一个数据包时，它不知道如何处理它。您必须将其配置为“端口 21 必须重定向到本地 IP XXX”

您的调制解调器/路由器的公共 IP 也可以更改，具体取决于您的 ISP。如果你有一个固定的 IP，它不会改变，否则你必须安装一个像 dyndns 这样的软件才能有一个与你的 IP 相关联的域名。

# java - 如何解析自定义文本文件以进行分析

> ID：13483761
> 
> 赞同：-4
> 
> 时间：2012-11-20T23:06:42.300
> 
> 标签：java, parsing

我有一个这样的日志文件：

```
1352711989.822313 SENDING
  SR packet
    SSRC                  3760482201
    NTP timestamp: 1352711989.822293
    RTP timestamp:          30163617
    Packets sent:                 17
    Octets sent:                  85
    RR block 1
      SSRC                2520738017
      Fraction lost:               0
      Packets lost:                0
      Ext. high. seq. nr:      64175
      Jitter:                   2947
      LSR:                1035041236
      DLSR:                   284839
    RR block 2
      SSRC                2158728709
      Fraction lost:              14
      Packets lost:               43
      Ext. high. seq. nr:      54178
      Jitter:                    394
      LSR:                1035176766
      DLSR:                   149303
    RR block 3
      SSRC                 100700967
      Fraction lost:              36
      Packets lost:              120
      Ext. high. seq. nr:      45647
      Jitter:                   2365
      LSR:                1035002733
      DLSR:                   323342
  SDES Chunk:
    SSRC:                 3760482201 
```

我想把每个块解析成一个对象，所以我用java做了一些类。现在有没有办法顺利地浏览这段文本并将所有内容放入正确的 var 并为整个文本文件执行此操作？

所以最后我有一个包含信息的对象列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:13:56.883

由于看起来这里的所有内容都是名称值对，因此最简单的做法是遍历文件的行并将每一行添加到映射中。如果名称块很重要（例如`RR block 2`），您可以创建一个列表，当您没有值时将当前名称块添加到其中，然后在到达具有相同缩进的下一块时将其弹出。

# c++ - 锁定多个互斥锁

> ID：13483767
> 
> 赞同：22
> 
> 时间：2012-11-20T23:07:02.957
> 
> 标签：c++, multithreading, mutex

我想知道是否可以同时锁定多个互斥锁，例如：

```
 Mutex1.Lock();
 {
     Mutex2.Lock();
     {
          // Code locked by mutex 1 and 2.
     }
     Mutex2.Unlock();

     // Code locked by mutex 1.
 }
 Mutex1.Unlock(); 
```

这在某些情况下会非常有用。谢谢。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-11-20T23:14:44.743

`std::lock`似乎为此目的而存在。

> 使用死锁避免算法锁定给定的可锁定对象 lock1, lock2, ..., lockn 以避免死锁。对象被一系列未指定的 lock、try_lock、unlock 调用锁定。如果调用 lock 或 unlock 导致异常，则在重新抛出之前为任何锁定的对象调用 unlock。

[http://en.cppreference.com/w/cpp/thread/lock](http://en.cppreference.com/w/cpp/thread/lock)

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2017-07-06T08:03:43.290

C++17 还提供`scoped_lock`了锁定多个互斥锁的特定目的，以防止 RAII 样式中的死锁，类似于`lock_guard`.

```
#include<mutex>

std::mutex mtx1, mtx2;
void foo()
{
    std::scoped_lock lck{mtx1, mtx2};
    // proceed
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-11-20T23:12:23.190

这是可能的，但锁定的顺序必须在整个应用程序中保持一致，否则可能会导致死锁（如果两个线程以相反的顺序获取锁，则每个线程可能正在等待另一个线程释放其中一个锁）。

建议使用范围锁定和解锁工具来确保异常安全，以确保始终释放锁定（[`std::lock_guard`](http://en.cppreference.com/w/cpp/thread/lock_guard)例如[`std::mutex`](http://en.cppreference.com/w/cpp/thread/mutex)）：

```
std::mutex mtx1;
std::mutex mtx2;

std::lock_guard<std::mutex> mtx1_lock(mtx1);
{
    std::lock_guard<std::mutex> mtx2_lock(mtx2);
    {
    }
} 
```

如果您的编译器不支持这些 C++11 功能，则 boost 在[`boost::mutex`](http://www.boost.org/doc/libs/1_52_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.mutex)和[`boost::lock_guard`](http://www.boost.org/doc/libs/1_52_0/doc/html/thread/synchronization.html#thread.synchronization.locks.lock_guard).

# iphone - 从核心数据提取结果中提取某些键/值对

> ID：13483768
> 
> 赞同：0
> 
> 时间：2012-11-20T23:07:06.687
> 
> 标签：iphone, objective-c, core-data

:D 抱歉，我对此很陌生，我正试图围绕核心数据展开思考。我有两个视图控制器。第一个（称为 PVC）是一个表格视图控制器，有两个部分，其中包含用户输入的姓名和电子邮件。他们从该屏幕按添加，然后将他们带到第二个视图控制器（称为 PDVC），用户在其中添加姓名和电子邮件，并指定条目将属于哪个部分（受托人或收件人）。当他们在该屏幕上点击完成时，信息被保存到核心数据中，并将它们带回 PVC，核心数据在 PVC 中获取该信息并将其放入表视图中。

我想要完成的是，当用户点击从 PVC 发送时，我需要获取该信息（输入的每个名称和电子邮件）JSON，并将其发送到服务器。我用我想出的一个技巧成功地做到了这一点，它将每个项目存储到字典中，然后获取这些键/值对并将它们添加到一个可变数组中，所有这些都来自 PDVC。问题是，所有这些数据都需要像核心数据一样持久，因此使用核心数据来获取这些信息而不是我的hack是有意义的。我的问题是，这可能吗？我需要能够从核心数据中“提取”某些键值对。如果我能做到这一点，我相信我能解决剩下的问题。我了解您可以使用一种方法将核心数据信息存储到数组中，但它还附带我无法使用的其他信息：

```
array of fetched objects: (
"<Credentials: 0xb9c6ed0> (entity: Credentials; id: 0xb9bfa90 <x-coredata://BE51A026-9D1B-      4A93-BA34-4EAC55B8B9DF/Credentials/p1> ; data: {\n    category = Trustees;\n    name = aef;\n     settingsEmail = \"inawef@hioe.com\";\n})",
"<Credentials: 0xb9c6f40> (entity: Credentials; id: 0xb9c6ae0 <x-coredata://BE51A026-9D1B- 4A93-BA34-4EAC55B8B9DF/Credentials/p3> ; data: {\n    category = Trustees;\n    name = awef;\n     settingsEmail = \"waef@aioc.com\";\n})",
"<Credentials: 0xb9c6fc0> (entity: Credentials; id: 0xb9c6af0 <x-coredata://BE51A026-9D1B- 4A93-BA34-4EAC55B8B9DF/Credentials/p2> ; 
```

我只需要从该信息中获取名称和 settingsEmail 键/值对。任何帮助将不胜感激！这是我的其余代码

PVC.h

```
@interface PeopleViewController : UITableViewController<NSFetchedResultsControllerDelegate>
{
NSMutableArray *listOfItems;
}
- (IBAction)doneButtonPressed:(id)sender;
- (IBAction)sendPressed:(id)sender;
@property (nonatomic, strong) NSManagedObjectContext *managedObjectContext;

@end 
```

PVC.m

```
#import "PeopleViewController.h"
#import "AppDelegate.h"
#import "PeopleDetailViewController.h"
#import "Credentials.h"
#import "AlertLoad.h"
#import "Data.h"
#import "ASIFormDataRequest.h"

@interface PeopleViewController ()

@end

@implementation PeopleViewController
{
NSFetchedResultsController *fetchedResultsController;
AlertLoad *alertLoad;
Data *dataObj;

}
@synthesize managedObjectContext;

- (NSFetchedResultsController *)fetchedResultsController
{
if (fetchedResultsController == nil)
{

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];

    NSEntityDescription *entity = [NSEntityDescription        entityForName:@"Credentials" inManagedObjectContext:self.managedObjectContext];
    [fetchRequest setEntity:entity];

    NSSortDescriptor *sortDescriptor1 = [NSSortDescriptor   sortDescriptorWithKey:@"category" ascending:NO];
    NSSortDescriptor *sortDescriptor2 = [NSSortDescriptor  sortDescriptorWithKey:@"name" ascending:YES];
    [fetchRequest setSortDescriptors:[NSArray arrayWithObjects:sortDescriptor1,  sortDescriptor2, nil]];

    [fetchRequest setFetchBatchSize:20];

    fetchedResultsController = [[NSFetchedResultsController alloc]
                                initWithFetchRequest:fetchRequest
                                managedObjectContext:self.managedObjectContext
                                sectionNameKeyPath:@"category"
                                cacheName:@"Credentials"];

    fetchedResultsController.delegate = self;
}
return fetchedResultsController;
}

- (void)performFetch
{
NSError *error;
if (![self.fetchedResultsController performFetch:&error]) {
    FATAL_CORE_DATA_ERROR(error);
    return;
}
}

- (void)viewDidLoad
{
[super viewDidLoad];
NSLog(@"view did load");
dataObj = [Data dataObj];
dataObj.trusteeArray = [[NSMutableArray alloc]init];
dataObj.recipientArray = [[NSMutableArray alloc]init];

    if (self.managedObjectContext == nil)
    {
        self.managedObjectContext = [(AppDelegate *) [[UIApplication sharedApplication]  delegate] managedObjectContext];
        NSLog(@"After managedObjectContext: %@",  self.managedObjectContext);
    }
[self performFetch];
NSLog(@"array of fetched objects: %@", [fetchedResultsController fetchedObjects]);
[self.navigationController setToolbarHidden:NO];

self.navigationItem.title = @"Swipe to delete";
}

 - (void)didReceiveMemoryWarning {
[super didReceiveMemoryWarning]; // Releases the view if it doesn't have a superview
// Release anything that's not essential, such as cached data
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{

PeopleDetailViewController *controller = segue.destinationViewController;
controller.managedObjectContext = self.managedObjectContext;

}

#pragma mark Table view methods

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
//return [listOfItems count];
return [[self.fetchedResultsController sections] count];
}

// Customize the number of rows in the table view.
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

id <NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections]   objectAtIndex:section];
return [sectionInfo numberOfObjects];
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:  (NSInteger)section
{

id <NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController  sections] objectAtIndex:section];
return [sectionInfo name];

}

- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)indexPath
{

Credentials *credentials = [self.fetchedResultsController objectAtIndexPath:indexPath];
if ([credentials.name length] > 0)
{
    cell.textLabel.text = credentials.name;
}
else
{
    cell.textLabel.text = @"(New Entry)";
}
if (credentials.settingsEmail != nil)
{
    cell.detailTextLabel.text = credentials.settingsEmail;
}
else
{
    cell.detailTextLabel.text = @"Tap to edit";
}
}

- (void)tableView:(UITableView *)tableView commitEditingStyle:   (UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
if (editingStyle == UITableViewCellEditingStyleDelete) {
    Credentials *credentials = [self.fetchedResultsController  objectAtIndexPath:indexPath];
    [self.managedObjectContext deleteObject:credentials];

    NSError *error;
    if (![self.managedObjectContext save:&error]) {
        FATAL_CORE_DATA_ERROR(error);
        return;
    }
}
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath  *)indexPath
{

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle
                                   reuseIdentifier:CellIdentifier];
}
[self configureCell:cell atIndexPath:indexPath];
// Set up the cell...

return cell;
}

-(void)infoSent
{
[alertLoad close];
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Success" message:@"Your trustees and recipients have been submitted" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
[alert show];
[self dismissViewControllerAnimated:YES completion:nil];
}

-(void)sendDataWithString:(NSString *)string
{
NSURL *url = [NSURL URLWithString:@"http://lastwords.com.au/lastwords/"];

ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];

[request setPostValue:dataObj.username              forKey:@"author"];
[request setPostValue:dataObj.password              forKey:@"password"];
[request setPostValue:string                        forKey:@"participants"];
[request setPostValue:@"set_participants"           forKey:@"json"];
[request startSynchronous];

NSError *error = [request error];
if (error != nil)
{
    [alertLoad close];

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:error.localizedDescription delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
    NSLog(@"error: %@", error);
}
else
{
    NSString *response = [request responseString];
    NSLog(@"response: %@", response);
    [self performSelectorOnMainThread:@selector(infoSent) withObject:nil waitUntilDone:YES];
}

}

- (IBAction)doneButtonPressed:(id)sender
{
[self.navigationController dismissViewControllerAnimated:YES completion:nil];
}

- (IBAction)sendPressed:(id)sender
{

if ([self.tableView numberOfRowsInSection:0] > 3)
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Too many trustees" message:@"You can only submit a maximum of 3 trustees." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
}
else if ([self.tableView numberOfRowsInSection:0] < 3)
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Not enough trustees"  message:@"You must select 3 trustees." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
}
else if ([self.tableView numberOfSections] < 2)
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"No trustees or recipients" message:@"You must enter at least enter 3 trustees and at least one recipient." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [alert show];
}

else
{
    alertLoad = [[AlertLoad alloc]
                 initWithTitle:@"Submitting..."
                 message:@"Submitting your trustees and recipients. Please wait...\n\n\n"
                 delegate:self cancelButtonTitle:@"Cancel"
                 otherButtonTitles:nil];
    alertLoad.delegate = self;

    [alertLoad show];
    NSDictionary *dictionary = [NSDictionary  dictionaryWithObjectsAndKeys:dataObj.trusteeArray,@"trustees", dataObj.recipientArray,  @"recipients", nil];
    NSError *error;
    NSData* jsonData = [NSJSONSerialization dataWithJSONObject:dictionary options:kNilOptions error:&error];
    NSString* jSONString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
    NSLog(@"json??: %@", jSONString);
    [self performSelectorInBackground:@selector(sendDataWithString:) withObject:jSONString];

}

}

@end 
```

（取出获取结果委托的东西以节省空间）

PDVC.h

```
@interface PeopleDetailViewController : UIViewController<UITextFieldDelegate>
@property (weak, nonatomic) IBOutlet UITextField *txtFieldName;
@property (weak, nonatomic) IBOutlet UITextField *txtFieldEmail;
@property (nonatomic, strong) NSManagedObjectContext *managedObjectContext;
@property (weak, nonatomic) IBOutlet UISegmentedControl *segment;
- (IBAction)done:(id)sender;
@end 
```

PDVC.m

```
#import "PeopleDetailViewController.h"
#import "AppDelegate.h"
#import "Credentials.h"
#import "Data.h"

@interface PeopleDetailViewController ()

{
Data *dataObj;
}
@end

@implementation PeopleDetailViewController
@synthesize managedObjectContext;

- (void)viewDidLoad
{
[super viewDidLoad];
NSLog(@"view did load");
dataObj = [Data dataObj];

if (self.managedObjectContext == nil)
{
    self.managedObjectContext = [(AppDelegate *) [[UIApplication sharedApplication] delegate] managedObjectContext];
    NSLog(@"After managedObjectContext: %@",  self.managedObjectContext);
}
// Uncomment the following line to preserve selection between presentations.
// self.clearsSelectionOnViewWillAppear = NO;

// Uncomment the following line to display an Edit button in the navigation bar for this view controller.
// self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

#pragma mark - textField Delegate
- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
[textField resignFirstResponder];

return YES;
}

- (IBAction)done:(id)sender
{
NSString *emailRegEx = @"[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}";
NSPredicate *emailTest = [NSPredicate predicateWithFormat:@"SELF MATCHES %@", emailRegEx];

if (self.txtFieldEmail.text.length < 1 || self.txtFieldName.text.length < 1)
{
    [self dismissViewControllerAnimated:YES completion:nil];
}

else if ([emailTest evaluateWithObject:self.txtFieldEmail.text] == NO)
{
    //Valid email addres
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Invalid email" message:@"Please enter a valid email address" delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
        [alert show];
}

else
{
    Credentials *credentials = [NSEntityDescription insertNewObjectForEntityForName:@"Credentials" inManagedObjectContext:self.managedObjectContext];

    credentials.name = self.txtFieldName.text;
    credentials.settingsEmail = self.txtFieldEmail.text;

    if (self.segment.selectedSegmentIndex == 0)
    {
        credentials.category = @"Trustees";
        NSDictionary *trusteeDict = [NSDictionary dictionaryWithObjectsAndKeys:self.txtFieldName.text,@"name", self.txtFieldEmail.text,@"email", nil];
        NSError *error;
        NSData* jsonData = [NSJSONSerialization dataWithJSONObject:trusteeDict options:kNilOptions error:&error];
        NSString* jSONString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
        NSLog(@"json??: %@", jSONString);
        [dataObj.trusteeArray addObject:trusteeDict];
        NSLog(@"trusteeArray: %@", dataObj.trusteeArray);

    }
    else
    {
        credentials.category = @"Recipients";
        NSDictionary *recipientDict = [NSDictionary dictionaryWithObjectsAndKeys:self.txtFieldName.text,@"name", self.txtFieldEmail.text,@"email", nil];
        NSError *error;
        NSData* jsonData = [NSJSONSerialization dataWithJSONObject:recipientDict options:kNilOptions error:&error];
        NSString* jSONString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
        NSLog(@"json??: %@", jSONString);
        [dataObj.recipientArray addObject:recipientDict];
        NSLog(@"recipientArray: %@", dataObj.recipientArray);
    }

    NSError *error;
    if (![self.managedObjectContext save:&error])
    {
    FATAL_CORE_DATA_ERROR(error);
    return;
    }
        [self dismissViewControllerAnimated:YES completion:nil];
}
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:16:36.450

您的问题有点令人困惑，但您可以使用 2 种非常简单的方法从核心数据中获取特定信息。

1）像这样在提取中使用谓词

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"User"
                                              inManagedObjectContext:self.managedObjectContext];
    fetchRequest.entity = entity;
    fetchRequest.predicate = [NSPredicate predicateWithFormat:@"userID = %@", userIDYouAreLookingfor];

    NSArray *fetchedObjects = [self.managedObjectContext executeFetchRequest:fetchRequest error:&error];

    NSLog(@"%@",fetchedObjects); 
```

2) 父关系在 NSSet 中指定其实体，您可以测试它们以检索某些对象：

```
NSSet *picturesResult = [_thumbnailsStorage.pictures objectsPassingTest:^BOOL(id obj, BOOL *stop) {
        Picture *pic = obj;
        // Check for a condition here
        if (someCondition) {
            return YES;
        }
        return NO;
    }]; 
```

如果这不是您所要求的，请告诉我，看看我是否可以提供帮助。

# ant - 使用 ant+ivy 的 Arquillian Weld-EE 测试设置

> ID：13483769
> 
> 赞同：1
> 
> 时间：2012-11-20T23:07:10.523
> 
> 标签：ant, junit, ivy, jboss-arquillian, weld

我按照入门指南建立了一个项目。我必须使用常春藤。这些是我的依赖项：

```
 <dependencies>
    <dependency org="org.jboss.spec" name="jboss-javaee-all-6.0" rev="3.0.1.Final" conf="build->default" />

    <dependency org="org.jboss.arquillian.junit" name="arquillian-junit-container" rev="1.0.3.Final"  conf="test->default(*)" transitive="true"/>
    <dependency org="org.jboss.arquillian.junit" name="arquillian-junit-core" rev="1.0.3.Final"  conf="test->default(*)" transitive="true"/>

    <dependency org="org.jboss.weld.arquillian.container" name="arquillian-weld-ee-embedded-1.1" rev="1.1.2.Final" conf="test->default(*)" />
    <dependency org="org.jboss.weld" name="weld-core" rev="1.1.10.Final" conf="test->default(*)" />
    <dependency org="org.slf4j" name="slf4j-log4j12" rev="1.6.4" conf="test->default(*)" />

</dependencies> 
```

问题：虽然我映射到“*”，但 deps 没有传递解析。我必须手动添加每个罐子，就因为我被常春藤困住了吗？还是我错过了什么？

澄清：

我使用映射“myconf->default( *)”transitive="true"。我这样读到：“获取依赖项的默认配置并将其映射到“myconf”。（*）：如果依赖项不提供“默认”，则使用它提供的每个配置。所有这些都应该传递完成，这意味着每个子依赖项也将被映射。

但我得到的是：只有指定的罐子，以及运行测试时的大量 CNFE。我读到了 maven 项目中引用的 arquillian-container pom，我开始担心没有适用于 ivy 和 arquillian 的“开箱即用”依赖映射机制。如果有人可以确认这一点或提供我可以使用的工作（最佳：测试）依赖项配置，我很高兴。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T21:27:17.590

我建议您的 ivy 文件始终声明一组配置。配置是构建中 jar 的逻辑分组。

以下示例为典型 java 构建中使用的 3 个类路径创建配置：

*   编译
*   运行
*   测试

（另请注意“扩展”关键字）

```
<ivy-module version="2.0">
    <info organisation="com.myspotontheweb" module="demo"/>

    <configurations>
        <conf name="compile" description="Required to compile application"/>
        <conf name="runtime" description="Additional run-time dependencies" extends="compile"/>
        <conf name="test"    description="Required for test only" extends="runtime"/>
    </configurations>

    <dependencies>
        <!-- compile dependencies -->
        <dependency org="org.jboss.spec" name="jboss-javaee-all-6.0" rev="3.0.1.Final" conf="compile->default" />

        <!-- test dependencies -->
        <dependency org="org.jboss.arquillian.junit" name="arquillian-junit-container" rev="1.0.3.Final"  conf="test->default"/>
        <dependency org="org.jboss.arquillian.junit" name="arquillian-junit-core" rev="1.0.3.Final"  conf="test->default"/>
        <dependency org="org.jboss.weld.arquillian.container" name="arquillian-weld-ee-embedded-1.1" rev="1.1.2.Final" conf="test->default" />
        <dependency org="org.jboss.weld" name="weld-core" rev="1.1.10.Final" conf="test->default" />
        <dependency org="org.slf4j" name="slf4j-log4j12" rev="1.6.4" conf="test->default" />
    </dependencies>

</ivy-module> 
```

然后，配置映射会将本地配置映射到远程配置，如下所示：

```
conf="compile->default" 
```

远程“默认”配置通常是您所需要的，它将包括远程模块的编译依赖项。有关如何翻译 Maven 模块的更详细说明，我建议阅读以下答案：

*   [Maven 范围如何通过 ivy 映射到 ivy 配置](https://stackoverflow.com/questions/7104364/how-are-maven-scopes-mapped-to-ivy-configurations-by-ivy/7116577#7116577)

最后，您的构建文件可以使用这些配置来创建填充的 ANT 类路径：

```
<target name="init" description="Use ivy to resolve classpaths">
    <ivy:resolve/>

    <ivy:report todir='build/ivy' graph='false' xml='false'/>

    <ivy:cachepath pathid="compile.path" conf="compile"/>
    <ivy:cachepath pathid="runtime.path" conf="runtime"/>
    <ivy:cachepath pathid="test.path"    conf="test"/>
</target> 
```

“报告”任务对于记录类路径上每个 jar 的版本特别有用。

# tridion - 将数据库恢复到 tridion 的不同实例

> ID：13483770
> 
> 赞同：6
> 
> 时间：2012-11-20T23:07:24.487
> 
> 标签：tridion, tridion-2011

我已经完成了大部分工作，但某处似乎存在权限问题：

在还原之前，我的目标环境中的一切工作正常 - 目标有一个服务器登录帐户 TCMDBUser，该帐户映射到我的 tridion_cm 数据库用户 TCMDBUser

我的源 tridion_cm 数据库有用户 TCMDBUser_DEV。

将源 .bak 还原到我的目标后，TCMDBUser_DEV 是孤立的。

我编辑 TRUSTEES 表以更正目标环境的 MTSUser 和我的管理员日志帐户，并运行以下命令来修复我的孤立数据库用户：

```
sp_change_users_login @Action='update_one', 
@UserNamePattern='TCMDBUser_DEV', 
@LoginName='TCMDBUser'
GO 
```

我可以重新登录到 Tridion 资源管理器并查看预期的出版物列表，并且可以浏览树结构，但是当我来到一个应该包含项目的文件夹时，我看不到任何错误：

对应的事件日志错误为：

```
Unable to get list of SDL Tridion Content Manager items.
DESCRIPTION

Error Code:
0x80040000 (-2147221504)

Call stack:
System.Data.ProviderBase.FieldNameLookup.GetOrdinal(String)
System.Data.SqlClient.SqlDataReader.GetOrdinal(String)
System.Data.SqlClient.SqlDataReader.get_Item(String)
Tridion.ContentManager.Data.AdoNet.DatabaseUtilities.ConvertToFieldDictionary(IDataRecord,IDictionary`2)
Tridion.ContentManager.Data.AdoNet.IdentifiableObjectDataMapper.Read(TcmUri,IDataRecord,IDictionary`2)
Tridion.ContentManager.Data.AdoNet.ContentManagement.OrganizationalItemDataMapper.GetListItemsPost(IDataReader,TcmUri,OrganizationalItemItemsFilterData)
Tridion.ContentManager.Data.AdoNet.ContentManagement.OrganizationalItemDataMapper.Tridion.ContentManager.Data.ContentManagement.IOrganizationalItemDataMapper.GetListItems(TcmUri,OrganizationalItemItemsFilterData)
Tridion.ContentManager.ContentManagement.OrganizationalItem.GetListItemsData(OrganizationalItemItemsFilter)
Tridion.ContentManager.ContentManagement.OrganizationalItem.GetListItemsStream(OrganizationalItemItemsFilter)
Tridion.ContentManager.BLFacade.ContentManagement.OrganizationalItemFacade.GetListItemsXml(UserContext,String,ListFilter,ListColumnFilter)
Tridion.ContentManager.BLFacade.ContentManagement.OrganizationalItemFacade.GetListData(UserContext,String,EnumListKind,ListColumnFilter,String)
Folder.GetListItems 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T00:16:17.217

您需要从数据库中删除/删除 TCMDBUser_DEV，然后创建一个具有相同名称和密码的新数据库（或将其重新附加到您的 cm 数据库）。那应该可以解决您的问题。

我通常在 MS SQL 服务器上使用删除方法。我相信这是由于 TCMDBUser 在数据库架构上的所有权状态而发生的。

完成后，您的 TCMDBUser 用户应该对您的 Tridion_CM 数据库具有以下权限

![在此处输入图像描述](../Images/2b4d31df381c4d9fa314dff756ea2d9d.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T11:03:00.513

就像克里斯提到的那样，我总是从数据库中删除用户，然后将 SQL Server 中现有的 TCMDBUser 分配给恢复的数据库的权限。您可以使用以下命令删除用户（在恢复的数据库上）：

```
EXEC sp_dropuser TCMDBUser 
```

然后通过 SQL Server - Security - Logins，请求 TCMDBUser 的属性，并在 User Mapping 中添加以下数据库角色`db_datareader`：`db_datawriter`和`db_ddladmin`。

这就是我过去一直在做的并且对我有用，不确定它是否都是必需的，但我想值得一试

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T05:45:04.873

尝试在数据库中创建新用户 TCMDBUser 并运行以下命令

```
EXEC sp_change_users_login 'Update_One', 'TCMDBUser', 'TCMDBUser' 
```

# java - 我们怎么知道设置堆有多大？

> ID：13483773
> 
> 赞同：0
> 
> 时间：2012-11-20T23:07:37.003
> 
> 标签：java, compiler-construction, intermediate-language, intermediate-code

我正在尝试将 Java 转换为中间语言，并且正在弄清楚中间语言是如何工作的。

我有原始的 Java 代码：[http ://cs.ucla.edu/classes/spring11/cs132/cs132/mj/Factorial.java](http://cs.ucla.edu/classes/spring11/cs132/cs132/mj/Factorial.java)

我有中间代码表示（VAPOR）：[http ://cs.ucla.edu/classes/spring11/cs132/kannan/vapor-examples/Factorial.vapor](http://cs.ucla.edu/classes/spring11/cs132/kannan/vapor-examples/Factorial.vapor)

这是另一组：在 Java 中：[http ://cs.ucla.edu/classes/spring11/cs132/cs132/mj/BubbleSort.java](http://cs.ucla.edu/classes/spring11/cs132/cs132/mj/BubbleSort.java)

在 VAPOR 中：[http ://cs.ucla.edu/classes/spring11/cs132/kannan/vapor-examples/BubbleSort.vapor](http://cs.ucla.edu/classes/spring11/cs132/kannan/vapor-examples/BubbleSort.vapor)

我的问题是，所有的 VAPOR 代码都有`t.0 = HeapAllocZ(x)`（在哪里`x`）`int`。我想知道转换器如何确定堆大小需要为 size `x`。在`Factorial.vapor`中，它设置为`4`。在`BubbleSort.vapor`中，它设置为`12`。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:19:53.697

看起来它`HeapAlloc`基于您正在创建的结构的大小（假设`4`和`12`是字节值）。我认为查看您的数据结构使用的变量，并计算这些变量总和的字节数会给您分配的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:37:28.137

如果您注意到，Java 版本的 Factorial 没有数据成员。BubbleSort 的 Java 版本有两个 4 字节整数（总共 8 个字节）。

大概一个对象的“开销”是 4 个字节（指向类对象的指针的大小）。

所以 Factorial 的对象大小为 4，BubbleSort 的对象大小为 12。

# c# - 设置透视的缩放值等于透视

> ID：13483775
> 
> 赞同：2
> 
> 时间：2012-11-20T23:07:52.680
> 
> 标签：c#, math, matrix, sharpdx

我正在构建一个具有两种视图模式的小型形状编辑器：正交视图和透视视图。所以我发现它会很好，如果透视和正交的缩放值相等（或尽可能相等）。

通过设置 z 轴上的位置，可以简单地归档透视图的缩放值。对于正交，我将左、右、上和下角从 0.0 缩放到 X。

是否可以同样缩放它们？有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T08:45:22.323

我将相等的缩放值解释为形状在每种缩放模式下看起来都是相同的大小。由于从透视角度来看，形状部分的表观大小将取决于它们与相机的距离，因此这种“等变焦”只能在形状内的特定深度处实现。

假设您希望最接近相机的形状部分在两种视图模式中看起来相等。

要从透视图生成等效的正交视图，首先计算形状最近点处的视锥体的宽度和高度。

`width = tan(fovX) * distance`

`height = tan (fovY) * distance`

其中`distance`是从相机到形状上最近点的距离，是`fovX, fovY`透视模式下视野的水平和垂直角度。

然后，您可以将正交视图矩形设置为`0,0,width,height`，假设您将相机置于形状的中心。

要从正交视图生成等效透视图，只需反转等式：

`distance = width / tan(fovX)`

或者

`distance = height / tan(fovY)`

然后将相机的 z 值设置为对象上最近的点 - `distance`，假设您正在向下看正 z 轴。如果您的相机始终在原点，您可以设置对象的 z 值，使其最近点的 z 值等于距离。

# python - 在第三方鸡蛋上运行单元测试

> ID：13483777
> 
> 赞同：1
> 
> 时间：2012-11-20T23:08:02.990
> 
> 标签：python, unit-testing, plone, zope, test-runner

我正在尝试使用 Plone 中的一个鸡蛋（collective.z3cform.wizard）。我在阅读文档时关注文档测试，此时想为我自己的代码编写测试。

问题是，当我关注测试示例时，它们与我通过运行测试得到的不同。在寻找其他解决方案之前，我想在第三方 egg 上运行测试，问题是——我不知道怎么做。

在 Plone 3 中，可以通过 指定第三方测试`./bin/instance test`，当我试图`./bin/test`在 Plone 4 中运行时，我最终只运行我的开发测试。到目前为止，我已经尝试使用 --module 和 --package 选项，但我似乎得到的只是 ImportErrors。

更新：我只是在扩建，这是其中的一个相关部分

```
[test]
recipe = zc.recipe.testrunner
defaults = ['--auto-color', '--auto-progress']
eggs =
      ... my development eggs... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T09:39:08.157

该`bin/test`命令由构建部分创建，通常使用`zc.recipe.testrunner`or`collective.xmltestreport`配方。这些食谱支持一个`eggs`条目来配置它可用的鸡蛋。

如果您使用统一安装程序安装了 Plone，则该`[test]`部分设置为包含该部分中的`test-packages`条目`[buildout]`，因此您`development.cfg`也可以在该条目中添加鸡蛋以确保包含您要测试的鸡蛋。

要为一个包运行所有测试，请使用以下`-s`选项`bin/test`：

```
bin/test -s collective.z3cform.wizard 
```

# http - 没有 http 标头的 Http 响应

> ID：13483781
> 
> 赞同：5
> 
> 时间：2012-11-20T23:08:08.467
> 
> 标签：http, http-headers

我已经编写了一个极简的 http 服务器原型（深受 boost asio 示例的启发），目前我还没有在服务器响应中放置任何 http 标头，只有 html 字符串内容。令人惊讶的是，它工作得很好。

[在那个问题](https://stackoverflow.com/questions/4726515/clean-http-response-header)中，OP 想知道 http 响应中的必要字段，其中一条评论指出，它们在服务器端可能并不重要。

目前我还没有尝试响应二进制图像文件或 gzip 压缩文件，在这种情况下，我认为必须有一个 http 标头。

但是对于纯文本响应（html、css 和 xml 输出），**永远不要**在我的服务器响应中包含 http 标头可以吗？可能的风险/错误是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T03:54:31.687

至少，您**必须**提供带有状态行和日期的标题。

作为编写了许多协议解析器的人，**我恳求您**，以我的数字隐喻膝盖，请哦，请哦，请不要仅仅因为您最喜欢的浏览器让您侥幸逃脱就完全忽略规范。

创建一个功能最少的程序是完全可以的，只要它产生的数据是正确的。这不应该是一个主要的负担，因为您所要做的就是在响应的开头添加三行。其中一行是*空白*的！请花几分钟时间编写**两行代码**，使您的响应数据符合规范。

您真正应该提供的标题是：

*   状态行（必填）
*   日期标题（必需）
*   内容类型（强烈推荐）
*   内容长度（强烈推荐），除非您使用分块编码
*   如果您返回 HTTP/1.1 状态行，并且您没有提供有效的内容长度或使用分块编码，则添加`Connection: close`到您的标头
*   将标题与正文分开的空白行（必需）

您可以选择不随响应发送内容类型，但您必须了解客户端可能不知道如何处理数据。客户端必须猜测它是什么类型的数据。浏览器可能决定将其视为下载文件而不是显示它。自动化过程（某人的 bash/curl 脚本）可能会合理地确定数据不是预期的类型，因此应该将其丢弃。

来自[HTTP/1.1 规范](https://www.rfc-editor.org/rfc/rfc7231#section-3.1.1.5)第 3.1.1.5 节。内容类型：

> 生成包含有效负载正文的消息的发送者应该在该消息中生成 Content-Type 头字段，除非发送者不知道封闭表示的预期媒体类型。如果 Content-Type 头字段不存在，接收者可以假设媒体类型为“application/octet-stream”（[RFC2046]，第 4.5.1 节）或检查数据以确定其类型。

# java - 从 Android 应用程序通过电子邮件发送崩溃报告

> ID：13483783
> 
> 赞同：2
> 
> 时间：2012-11-20T23:08:21.730
> 
> 标签：java, android, email, system, crash-reports

嘿伙计们，我需要帮助配置一些源代码，以便基本上在发生错误时通过电子邮件向我发送崩溃报告。这是我正在玩的一些代码，我只需要对 java 有更多经验的人来忽略它并帮助我清理它。

谢谢，

```
public final class EmailUtils {

private EmailUtils()
 {
 }

private static int bytesToMb(long l)
 {
    return (int)((double)l / 1024D / 1024D);
 }

private static int getAvailableInternalMemorySize()
 {
    StatFs statfs = new StatFs(Environment.getDataDirectory().getPath());
    return bytesToMb((long)statfs.getBlockSize() * (long)statfs.getAvailableBlocks());
 }

private static String getEmailText(Context context)
 {
    String s = "";
    String s11;
    PackageInfo packageinfo =  context.getPackageManager().getPackageInfo(context.getPackageName(), 0);
    String s1 = packageinfo.versionName;
    int i = packageinfo.versionCode;
    String s2 = packageinfo.packageName;
    String s3 = Build.MODEL;
    String s4 = android.os.Build.VERSION.RELEASE;
    String s5 = android.os.Build.VERSION.SDK;
    String s6 = Build.DEVICE;
    String s7 = Build.DISPLAY;
    String s8 = Build.ID;
    String s9 = (new  StringBuilder(String.valueOf(Build.BRAND))).append("/").append(Build.MANUFACTURER).toString();
    String s10 = Build.PRODUCT;
    s = (new StringBuilder(String.valueOf(s))).append("\n\n------------------\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Version: ").append(s1).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Version num: ").append(i).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Package: ").append(s2).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Phone Model: ").append(s3).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Android Version: ").append(s4).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("SDK Version: ").append(s5).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Device: ").append(s6).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Product: ").append(s10).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Brand: ").append(s9).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Disp: ").append(s7).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Id: ").append(s8).toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Available Internal memory: ").append(getAvailableInternalMemorySize()).append("/").append(getTotalInternalMemorySize()).append(" Mb").toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Heap size: ").append(getHeapSizeMb()).append(" Mb").toString();
    s = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = (new StringBuilder(String.valueOf(s))).append("Mar: GO").toString();
    s11 = (new StringBuilder(String.valueOf(s))).append("\n").toString();
    s = s11;

    android.content.pm.PackageManager.NameNotFoundException namenotfoundexception;

 //   namenotfoundexception.printStackTrace();
  //  if(true) 
  //    goto

}

private static int getHeapSizeMb()
 {
    return bytesToMb(Runtime.getRuntime().maxMemory());
 }

private static int getTotalInternalMemorySize()
 {
    StatFs statfs = new StatFs(Environment.getDataDirectory().getPath());
    return bytesToMb((long)statfs.getBlockSize() * (long)statfs.getBlockCount());
 }

public static void sendContactEmail(Context context)
 {
    String s = context.getResources().getString(0x7f040000);
    String s1 = "";
    String s2;
    String s3;
    Intent intent;
    try
    {
        s1 = context.getPackageManager().getPackageInfo(context.getPackageName(),  0).versionName;
    }
    catch(android.content.pm.PackageManager.NameNotFoundException  namenotfoundexception) { }
    s2 = (new StringBuilder("[SUPPORT] ")).append(s).append(" ").append(s1).toString();
    s3 = getEmailText(context);
    intent = new Intent("android.intent.action.SEND");
    intent.setType("plain/text");
    intent.putExtra("android.intent.extra.EMAIL", new String[] {
        "support@myemail.com"
    });
    intent.putExtra("android.intent.extra.SUBJECT", s2);
    intent.putExtra("android.intent.extra.TEXT", s3);
    if(context.getPackageManager().queryIntentActivities(intent, 0).size() > 0)
    {
        context.startActivity(Intent.createChooser(intent, "Send mail..."));
    } else
    {
        CustomAlertDialogBuilder customalertdialogbuilder = new CustomAlertDialogBuilder(context);
        customalertdialogbuilder.setTitle("Contact us");
        customalertdialogbuilder.setIcon(R.drawable.ic_launcher);
        customalertdialogbuilder.setMessage(Html.fromHtml("No application found to send emails.<br /><br />Please contact us at: <b>support@email.com</b>."));
        customalertdialogbuilder.setNegativeButton("Close", null);
        customalertdialogbuilder.show();
       }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T00:14:28.037

> 我的主要目标是提取系统数据和意图。你推荐使用 ACRA 方法还是使用我的字符串方法？

绝对是阿克拉。同样，它已经存在，受支持，提供多种获取数据的方式（包括不透露您的电子邮件地址的方式），与 BugSense 等第三方服务集成。

更具体地说明我的两个代码注释：

*   永远永远永远永远永远永远永远永远不会对资源 ID 十六进制值进行硬编码，例如：`String s = context.getResources().getString(0x7f040000);`. 这些值会随着每次构建而改变，尤其是在您添加/删除资源时。始终使用资源 ID 符号（例如，`R.string.foo`）。

*   在`getEmailText()`中，请创建*一个* `StringBuilder`对象并附加到它。不要创建 30 个左右，每个使用一次并丢弃。

# c# - asp.net绑定用户控件属性

> ID：13483785
> 
> 赞同：0
> 
> 时间：2012-11-20T23:08:33.837
> 
> 标签：c#, asp.net

我有我用来检查某些控件的访问的方法。出于某种原因，当我在 HasAcess 方法中放置断点时，我只看到一次点击它，我在页面中的几个区域使用它。有任何想法吗。问这个问题我觉得真的很傻。这似乎很明显。

**ASPX 页面：**

```
 <asp:CheckBox ID="chkIncludeVersions" runat="server" Text="Search Versions" Visible='<%# TR.Utility.HasAccess("ugEpisodeVersionsView")%>' /> 
```

**代码背后：**

```
 public static Boolean HasAccess( string access)
    { // Breakpoint
        string userGroup = HttpContext.Current.Session["UserGroup"] as string;
        List<string> groupsAccess =  new List<string>( ((string)Settings.Default.Properties[access].DefaultValue).Split(','));

        return groupsAccess.Contains(userGroup);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:39:00.320

我知道这是非常愚蠢的事情。我所要做的就是添加 Page.DataBind(); 在后面的代码中。

# php - MySQL跨表查询3张表，空值显示网格

> ID：13483789
> 
> 赞同：1
> 
> 时间：2012-11-20T23:09:05.583
> 
> 标签：php, mysql, select, explode

我在 MySQL 中有三个表，它们连接在一起以显示用户拥有的资格。我想创建一个表，其中标题显示类型的完整列表，然后左侧列有用户名，然后列在类型标题下显示到期日期，如下所示：

```
Type
========
Type ID (PK, Int)
Type (VarChar)

User
========
User_ID (PK, Int)
Name (VarChar)

Qualification
========
Quali_ID (PK, Int)
User_ID (Int)
Type_ID (Int)
DateExpire (Date)
Status (VarChar) 
```

我想像这样创建一个输出：

```
Users  Type1   Type2   Type3   Type4   .......
User1  Qual    Qual            Qual    .......
User2          Qual    Qual            .......
User3                  Qual            .......
User4  Qual    Qual    Qual    Qual    ....... 
```

并非所有用户都具有所有资格，并且受制于资格状态等于“完整”并且到期日期不是从今天开始的过去日期。

我在下面的互联网上搜索高低后创建了一些 SQL，但我无法让它包含不存在的类型。

我计划从 PHP 中的 MySQL 查询中获取结果并分解每一行以使其填充一个表。如果有人可以帮助我完成 SQL 以使其显示缺少的类型列或提出更好的方法，我将不胜感激。

我的 SQL：

```
SELECT 'User_ID', 'Name', GROUP_CONCAT(Types.Title ORDER BY QualiList.Type_ID) AS QualType
FROM TYPES
INNER JOIN (SELECT DISTINCT Type_ID FROM Qualification) QualiList
ON (QualiList.Type_ID = Types.Type_ID)

UNION ALL

SELECT User.User_ID, User.Name AS Name, GROUP_CONCAT(IFNULL(Qualification.DateExpire,'NA') ORDER BY QualiList.Type_ID) AS QualType
FROM TYPES
INNER JOIN (SELECT DISTINCT Type_ID FROM Qualification) QualiList
ON (QualiList.Type_ID = Types.Type_ID)
LEFT JOIN Qualification ON (Qualification.Type_ID = QualiList.Type_ID)
INNER JOIN User ON (User.User_ID = Qualification.User_ID)
GROUP BY Name 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:52:31.090

检查答案

```
SELECT USER,
 if(sum(user_id*(1-abs(sign(type_id-1))))>0,DateExpire,'NA') AS TypeADate,
 if(sum(user_id*(1-abs(sign(type_id-1))))>0,Status,'NA') AS TypeAStatus,
 if(sum(user_id*(1-abs(sign(type_id-2))))>0,DateExpire,'NA') AS TypeBDate,
 if(sum(user_id*(1-abs(sign(type_id-2))))>0,Status,'NA') AS TypeBStatus,
 if(sum(user_id*(1-abs(sign(type_id-3))))>0,DateExpire,'NA') AS TypeCDate,
 if(sum(user_id*(1-abs(sign(type_id-3))))>0,Status,'NA') AS TypeCStatus

 FROM (
   SELECT U.USER, T.Type, Q.Type_ID, Q.User_ID,Q.DateExpire,Q.Status FROM Qualification Q
 LEFT OUTER JOIN TYPE T
   ON Q.Type_id = T.ID
 LEFT OUTER JOIN USER U
   ON Q.User_id = U.ID
 GROUP BY T.ID, U.ID
 ) xxx GROUP BY USER 
```

检查[http://www.sqlfiddle.com/#!2/c1233/16上的答案](http://www.sqlfiddle.com/#!2/c1233/16)

# javascript - 在双引号之间放一个变量

> ID：13483791
> 
> 赞同：1
> 
> 时间：2012-11-20T23:09:14.867
> 
> 标签：javascript, function, variables, double-quotes

我有一个小问题：

我在javascript中有一个函数。

```
var func = function(variable)
{
    result = variable;
} 
```

如果我打电话

```
func(rabbit); 
```

我需要结果是“兔子”。

我无法弄清楚如何将变量放在两个引号之间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:10:59.573

假设`rabbit`应该是一个字符串：

```
func("rabbit"); 
```

如果`rabbit`实际上是一个变量，那么就没有办法做到这一点，因为变量（意味着实现对变量的表示）实际上并没有传递给函数，而是它的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:45:24.690

实际上有一种古老的方法来检索变量名。

```
var func = function(variable)
{
    console.log(variable); // outputs "white"
    console.log(arguments.callee.caller.toString().match(/func\((.*?)\)/)[1]); // outputs "rabbit"
}

rabbit = 'white';

func(rabbit); 
```

看到它运行[http://jsfiddle.net/Q55Rb/](http://jsfiddle.net/Q55Rb/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-16T10:42:01.320

你可以这样做

```
function whatever(input) {
  return '\"' + input + '\"';
}
```

结果应该用引号引起来

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T23:11:13.817

我无法从您的问题中判断您是否希望“兔子”成为属性名称或值。所以这是两者：

```
var func = function(variable) {
    window[variable] = 'abc';    // Setting the variable as what is passed in
    window.result = variable;    // Normal
}

func('rabbit');    // Will set both window.rabbit to 'abc', and window.result to 'rabbit' 
```

不过，我不建议设置全局变量。[更多信息](https://stackoverflow.com/questions/8862665/what-does-it-mean-global-namespace-would-be-polluted)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T08:22:39.863

好的，我认为这是我的问题。现在我很确定那不是它，但我不知道那是什么。

我的函数中有这个：

```
defaults = {title :{'pan':-1,'left':0,'volume':0.30,'top':111}}; 
```

其中 title 是函数中的变量。但结果我得到的是默认标题，而不是存储在名为 title 的变量中的实际标题。你了解我吗？

# java - RESTful Python for Java (Jersey) 开发人员

> ID：13483793
> 
> 赞同：4
> 
> 时间：2012-11-20T23:09:24.107
> 
> 标签：java, rest, python-2.7, jersey

背景：

我有一个使用 Jersey 用 Ja​​va 实现的 REST API。我的 API 使用四个动词：GET、POST、PUT、DELETE。我发现在 Java 中开发 REST API 非常简单直接。

例如，这里是一个精心设计的`hello`web 服务（我之所以这么说是因为有更简单的方法，但这更具代表性）：

```
import javax.ws.rs.*;

@Path("/myresource")
public class MyResource{

   @GET
   @Path("name/{name}")
   @Produces({MediaType.APPLICATION_JSON, MediaType.APPLICATION_XML})
   public Response sayHello(@PathParam("name") String name){
       return Response.ok("Hello "+name).build();
   }
} 
```

问题：

我正在学习python。我想将我的 Java Jersey REST API 转换为 python。

基本上，Jersey 是 Java 的 REST 实现（又名 JAX-RS：用于 RESTful Web 服务的 Java API）。python有REST的参考实现吗？如果没有，是否有任何实现接近并且易于来自 Java-Jersey 的人使用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:20:42.310

您可能想查看之前的类似问题：[Python REST（Web 服务）框架的建议？](https://stackoverflow.com/questions/713847/recommendations-of-python-rest-web-services-framework)

Python 没有内置的 REST 框架，但我个人对[Flask](http://flask.pocoo.org/)和[Bottle](http://bottlepy.org/docs/dev/)有很好的体验。

它的使用与泽西岛非常相似（瓶子示例）：

```
@route('/')
@route('/hello/<name>')
def greet(name='Stranger'):
    return template('Hello {{name}}, how are you?', name=name) 
```

处理 HTTP 动词：

```
@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        do_the_login()
    else:
        show_the_login_form() 
```

# java - Java Web 应用程序中的内存泄漏

> ID：13483796
> 
> 赞同：21
> 
> 时间：2012-11-20T23:09:48.800
> 
> 标签：java, tomcat, web

我有一个在 Tomcat 7 上运行的 Java Web 应用程序，它似乎存在内存泄漏。在负载下（使用 JConsole 确定）时，应用程序的平均内存使用量随时间线性增加。内存使用量达到平稳期后，性能会显着下降。响应时间从约 100 毫秒到 [300 毫秒，2500 毫秒]，所以这实际上导致了真正的问题。

**我的应用程序的 JConsole 内存配置文件：** ![应用程序内存配置文件](../Images/ee8f1f92ecf5d172602a1963987e6fab.png)

使用 VisualVM，我看到字符数组（即 char[]）使用了至少一半的内存，并且大多数字符串（每个字符串的数量大致相同，300,000 个实例）是以下之一：“分配失败” 、“Copy”、“end of minor GC”，似乎都和垃圾回收通知有关。据我所知，该应用程序根本不监视垃圾收集器。VisualVM 找不到任何这些字符串的 GC 根，所以我很难找到它。

**内存分析器堆转储：** ![堆转储，无法访问的内存](../Images/993e942e805b38e9a1096e13630cad3f.png)

我无法解释为什么内存使用率会如此稳定，但我有一个理论来解释为什么性能一旦下降就会下降。如果内存是碎片的，应用程序可能需要很长时间来分配一个连续的内存块来处理新的请求。

将其与内置的 Tomcat 服务器状态应用程序进行比较，内存会增加并趋于平稳，但不会像我的应用程序那样达到很高的“地板”。它也没有大量不可访问的 char[]。

**Tomcat 服务器状态应用程序的 JConsole 内存配置文件：** ![在此处输入图像描述](../Images/42f400694753612eda21e6701aa863d2.png)

**Tomcat 服务器状态应用程序的内存分析器堆转储：** ![在此处输入图像描述](../Images/256710705bc3825220d76fc8634129a1.png)

这些字符串可以分配到哪里，为什么它们没有被垃圾收集？是否有可能影响此的 Tomcat 或 Java 设置？是否有特定的软件包可能会影响这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-04T19:09:55.187

我从中删除了以下 JMX 配置`tomcat\bin\setenv.bat`：

```
set "JAVA_OPTS=%JAVA_OPTS% 
    -Dcom.sun.management.jmxremote=true 
    -Dcom.sun.management.jmxremote.port=9090
    -Dcom.sun.management.jmxremote.ssl=false
    -Dcom.sun.management.jmxremote.authenticate=false" 
```

我无法再获得详细的内存堆转储，但内存配置文件看起来好多了： ![在此处输入图像描述](../Images/a9ed4639e399993bd552cee06b7056a8.png)

24 小时后，内存配置文件看起来一样： ![在此处输入图像描述](../Images/673158a09166d7d15f8ef5e68cdea294.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T11:41:11.077

我建议使用 memoryAnalyzer 来分析您的堆，它提供了更多信息。
[http://www.eclipse.org/mat/](http://www.eclipse.org/mat/) 有一个独立的应用程序和 Eclipse 嵌入式一个。您只需要在您的应用程序上运行 jmap 并以此分析结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T17:57:59.343

平台期是由于可用内存低于导致 Full GC 的默认百分比阈值。这就解释了为什么性能下降的原因是 JVM 在尝试查找和释放内存时不断暂停。

我通常建议查看对象缓存，但在您的情况下，我认为您的堆大小对于 Tomcat 实例 + webapp 来说太低了。我建议将您的堆增加到 1G ( `-Xms1024m -Xmx1024m`)，然后再次检查您的内存使用情况。

如果您仍然看到相同的行为，那么您应该进行另一个堆转储并查看 String 和 Char 之后的最大消费者。根据我的经验，这通常是缓存机制。如果可能，请进一步增加内存或减少缓存存储。一些缓存只定义对象的数量，因此您需要了解每个缓存对象的大小。

一旦您了解了您的内存使用情况，您可能可以再次降低它，但恕我直言，512MB 将是最低限度。

更新：

您不必担心无法访问的对象，因为它们应该由 GC 清理。此外，按类型划分的最大消费者通常是 String 和 Char - 大多数对象将包含某种 String，因此 Strings 和 Chars 在频率上是最常见的，这是有道理的。了解包含字符串的对象是什么，是找到内存使用者的关键。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-26T17:06:25.633

我可以推荐每个 Java 安装附带的**jvisualvm 。**启动程序，连接到您的 Web 应用程序。转到**Monitor -> Heap Dump**。现在可能需要一些时间（取决于大小）。通过 Heap Dump 导航非常简单，但是您必须自己弄清楚含义（虽然不太复杂），例如

转到**Classes**（在 heapdump 中），选择*java.lang.String*，右键单击**Show in Instances View**。之后，您将在**左侧表格中** 看到系统中当前处于活动状态的*字符串实例。*单击一个*String*实例，您会在右表的**右上方看到一些***String*首选项，例如*String*的*值*。

 ****在右表的**右下角**，您将看到**此** *String*实例的**引用**位置。在这里，您必须检查您的大部分 *String* 是从哪里引用的。但是对于您的案例（176/210，很有可能找到一些很快导致您的问题的*字符串*示例），经过一些检查后应该清楚问题出在哪里。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-04T11:36:18.503

我只是在一个完全不同的应用程序中遇到了同样的问题，所以 tomcat7 可能不是罪魁祸首。Memory Analyzer 显示进程中有 10M 无法访问的 String 实例（已经运行了大约 2 个月），并且大多数/所有这些实例都有与垃圾收集相关的值（例如，“分配失败”、“次要 GC 结束”）

**内存分析器**

![内存分析器](../Images/55f016cb29c59faded05b4c34d69c3d9.png)

Full GC 现在每 2 秒运行一次，但不会收集这些字符串。我的猜测是我们在 GC 代码中遇到了一个错误。我们使用以下java版本：

```
$ java -version
java version "1.7.0_06"
Java(TM) SE Runtime Environment (build 1.7.0_06-b24)
Java HotSpot(TM) 64-Bit Server VM (build 23.2-b09, mixed mode) 
```

以及以下虚拟机参数：

```
-Xms256m -Xmx768m -server -XX:+DisableExplicitGC -XX:+UseConcMarkSweepGC 
-XX:+UseParNewGC -XX:+CMSParallelRemarkEnabled -XX:NewSize=32m -XX:MaxNewSize=64m
-XX:SurvivorRatio=8 -verbose:gc -XX:+PrintGCTimeStamps -XX:+PrintGCDetails 
-Xloggc:/path/to/file 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-26T11:37:48.497

偶然地，我在 Tomcat 的 conf/catalina.properties 文件中偶然发现了以下几行，它们激活了字符串缓存。如果您打开了其中任何一个，这可能与您的情况有关。似乎[其他人警告](https://jira.atlassian.com/browse/JRA-15394)使用该功能。

```
tomcat.util.buf.StringCache.byte.enabled=true
#tomcat.util.buf.StringCache.char.enabled=true
#tomcat.util.buf.StringCache.trainThreshold=500000
#tomcat.util.buf.StringCache.cacheSize=5000 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-10-11T20:37:49.827

尝试使用 MAT 并确保在解析 heapdump 时，不要丢弃无法访问的对象。

为此，请按照[此处](http://wiki.eclipse.org/MemoryAnalyzer/FAQ#How_to_analyse_unreachable_objects)的教程进行操作。

然后你可以运行一个简单的内存泄漏分析（[这](http://docwiki.cisco.com/wiki/How_to_analyze_heap_dumps)是一个很好的教程）

这应该会很快引导您找到根本原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-26T16:58:00.740

因为这听起来不具体，所以一个候选人应该是 JSF。但是我本来预计哈希映射也会泄漏。

如果您使用 JSF：在**web.xml**中，您可以尝试：

*   javax.faces.STATE_SAVING_METHOD**客户端**
*   com.sun.faces.numberOfViewsInSession **0**
*   com.sun.faces.numberOfLogicalViews **1**

至于工具：**JavaMelody**对于持续统计可能很有趣，但需要努力。****

# sql-server - 查找距离特定点最多 500 米的纬度/经度行

> ID：13483799
> 
> 赞同：0
> 
> 时间：2012-11-20T23:10:00.673
> 
> 标签：sql-server, sql-server-2012, spatial

我有一个包含纬度和经度列（都是浮点数）的表，现在我正在构建一个存储过程，它获取一个点作为参数，并查找哪些行距它最远 500 米。

我在 where 子句中使用了以下语句，但它不起作用：

```
(geometry::STGeomFromText('POINT(' + CAST(Longitude AS VARCHAR(20)) + ' ' + 
  CAST(Latitude AS VARCHAR(20)) 
  + ')', 4326).STDistance(@currentLocation) / 1000) < @radius 
```

`@currentLocation`是`geometry`和`@radius`是`float`。

我正在使用 SQL Server 2012。我的 where 子句有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:17:24.807

从样式和性能的角度来看，存在几个问题，但就功能而言，查询不起作用的原因是（我猜）您提供的 @radius 参数为 500，期望它搜索500米范围内的位置？

但是，经度和纬度坐标是角坐标，以度为单位，对吧？所以你实际上在做的是找到那些距离@currentLocation 小于 500/1000 度的点（不知道你为什么要除以 1000？）

我猜你真的想为这个查询使用地理数据类型。您还应该使用 Point() 方法而不是 STGeomFromText() 方法，因为它不涉及所有 CAST，所以它会稍微快一些并且更整洁。

您的 WHERE 子句将如下所示：

```
geography::Point(Latitude, Longitude, 4326).STDistance(@currentLocation) < @radius 
```

这里仍然存在问题 - 因为您只是为查询中的每一行动态创建 geography Point 实例，您将无法使用任何索引，并且查询可能会很慢。更好的方法是在表中创建一个 PERSISTED 计算列：

```
ALTER TABLE yourTable
ADD Location AS geography::Point(Latitude, Longitude, 4326) PERSISTED; 
```

然后向该列添加空间索引（您需要在表上使用聚集主键），然后您的查询将变为：

```
SELECT * FROM yourTable
WHERE Location.STDistance(@currentLocation) < 500; 
```

# android - java.lang.NoClassDefFoundError：org.jivesoftware.smack.XMPPConnection

> ID：13483802
> 
> 赞同：1
> 
> 时间：2012-11-20T23:10:18.820
> 
> 标签：android, xmpp, smack, asmack

我正在尝试使用 asmack android jar 将我的 android 客户端连接到 gmail 服务器，但我收到运行时错误 NoClassDefFoundError on `ConnectionConfiguration`。我正在使用以下代码

```
ConnectionConfiguration config = new ConnectionConfiguration("talk.google.com",5222,"gmail.com");
    XMPPConnection connection= new XMPPConnection(config); 
```

即使我只使用`XMPPConnection connection= new XMPPConnection("gmail.com");`它仍然会抛出 NoClassDefFoundError on `XMPPConnection`。asmack-android-5.jar 文件在项目中。我什至尝试使用不同的 smack jar 来运行这个应用程序，但没有成功。没有构建错误，但运行时错误并且在 Eclipse DDMS 中可见。顺便说一句，我正在使用eclipse。

我已经阅读了另一个线程，但仍然无法解决问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T23:18:50.020

确保你的项目中有一个名为的文件夹，`libs`并且 smack jar 在那里。Android 将自动从该`libs`文件夹加载库。刷新后，jar 将自动出现在 Eclipse 项目中的“Android Dependencies”下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-18T11:28:35.407

我确实遇到了同样的问题。解决它需要很多时间。首先，您可以打开 Java 路径构建窗口。然后选择订单和导出选项卡。检查 asmack jar。把罐子升到顶部。

# monitoring - 为分布式系统构建数据收集和监控的中间件

> ID：13483809
> 
> 赞同：7
> 
> 时间：2012-11-20T23:11:06.113
> 
> 标签：monitoring, rabbitmq, zeromq, data-distribution-service, data-collection

我目前正在寻找一个好的中间件来构建监控和维护系统的解决方案。我们的任务是监控、收集和维护由多达 10,000 个独立节点组成的分布式系统。

该系统集群成 5-20 个节点的组。每个组通过处理传入的传感器数据来生成数据（作为一个团队）。每个组都有一个专用节点（蓝色框）作为组的外观/代理，将组中的数据和状态暴露给外界。这些集群在地理上是分开的，并且可以通过不同的网络连接到外部世界（一个可能通过光纤运行，另一个通过 3G/卫星）。我们很可能会经历更短（秒/分钟）和更长（小时）的中断。数据由每个集群在本地持久化。

这些数据需要由外部和集中式服务器（绿色框）收集（持续且可靠），以供各种客户端（橙色框）进一步处理、分析和查看。此外，我们需要通过每个组代理节点监控所有节点的状态。不需要直接监视每个节点，即使中间件可以支持它会很好（处理来自约 10,000 个节点的心跳/状态消息）。在代理失败的情况下，可以使用其他方法来查明单个节点。

此外，我们需要能够与每个节点交互以调整设置等，但这似乎更容易解决，因为这主要是在需要时手动处理每个节点。可能需要进行一些批量调整，但总而言之，它看起来像是标准的 RPC 情况（Web 服务或类似情况）。当然，如果中间件也可以通过一些请求/响应机制来处理这个问题，那将是一个加分项。

![监控](../Images/6572a1b4e43424df9c859f3810b6912a.png)

**要求：**

*   1000+ 节点发布/提供连续数据
*   数据需要可靠（以某种方式）并持续收集到一台或多台服务器。这很可能建立在中间件之上，使用某种明确的请求/响应来请求丢失的数据。如果这可以由中间件自动处理，这当然是一个加号。
*   多个服务器/订阅者需要能够连接到同一个数据生产者/发布者并接收相同的数据
*   数据速率最大为每组每秒 10-20 次
*   消息大小范围从大约 100 字节到 4-5 KB
*   节点范围从嵌入式受限系统到普通 COTS Linux/Windows 机器
*   节点一般使用C/C++，服务器和客户端一般使用C++/C#
*   节点应该（最好）不需要安装额外的软件或服务器，即每个节点一个专用的代理或额外的服务是昂贵的
*   安全性将基于消息，即不需要传输安全性

我们正在寻找一种解决方案，它可以处理主要代理节点（蓝色）和服务器（绿色）之间的通信，用于数据发布/轮询/下载，以及从客户端（橙色）到单个节点（RPC 样式）以调整设置。

对于相反的情况，似乎有很多讨论和建议；将数据从服务器分发到许多客户端，但很难找到与所描述情况相关的信息。一般的解决方案似乎是使用 SNMP、Nagios、Ganglia 等来监控和修改大量节点，但对我们来说棘手的部分是数据收集。

我们简要介绍了 DDS、ZeroMQ、RabbitMQ（所有节点都需要代理？）、SNMP、各种监控工具、Web 服务（JSON-RPC、REST/协议缓冲区）等解决方案。

**那么**，对于一个易于使用、健壮、稳定、轻量级、跨平台、跨语言的中间件（或其他）解决方案，您有什么建议吗？尽可能简单但不简单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T04:13:55.713

披露：我是一名长期的 DDS 专家/爱好者，我为其中一家 DDS 供应商工作。

良好的 DDS 实施将为您提供所需的内容。数据收集和节点监控是 DDS 的传统用例，应该是它的最佳点。与节点交互并调整它们也是可能的，例如通过使用所谓的内容过滤器将数据发送到特定节点。这假定您有一种方法来唯一标识系统中的每个节点，例如通过字符串或整数 ID。

由于系统的分层特性及其绝对（潜在）大小，您可能必须引入一些路由机制来在集群之间转发数据。一些 DDS 实现可以为此提供通用服务。通常也支持与其他技术（如 DBMS 或 Web 界面）的桥接。

特别是如果您可以使用多播，系统中所有参与者的发现可以自动完成，并且需要最少的配置。但这不是必需的。

对我来说，您的系统看起来很复杂，需要定制。我不相信任何解决方案都能“轻松满足要求”，尤其是在您的系统需要容错和健壮的情况下。最重要的是，您需要了解您的要求。在您提到的上下文中，关于 DDS 的几句话：

> 1000+ 节点发布/提供连续数据

这是一个很大的数字，但应该是可能的，特别是因为您可以选择利用 DDS 支持的数据分区功能。

> 数据需要可靠（以某种方式）并持续收集到一台或多台服务器。这很可能建立在中间件之上，使用某种明确的请求/响应来请求丢失的数据。如果这可以由中间件自动处理，这当然是一个加号。

DDS 支持一组丰富的所谓服务质量 (QoS) 设置，指定基础设施应如何处理其分发的数据。这些是开发人员设置的名称-值对。支持的 QoS-es 中的可靠性和数据可用性区域。这应该会自动满足您的要求。

> 多个服务器/订阅者需要能够连接到同一个数据生产者/发布者并接收相同的数据

一对多或多对多分布是一个常见的用例。

> 数据速率最大为每组每秒 10-20 次

每秒最多添加 20,000 条消息是可行的，尤其是在对数据流进行分区的情况下。

> 消息大小范围从大约 100 字节到 4-5 KB

只要消息没有变得过大，消息的数量通常比通过线路传输的总千字节数量更受限制——除非大消息具有非常复杂的结构。

> 节点范围从嵌入式受限系统到普通 COTS Linux/Windows 机器

一些 DDS 实现支持大范围的操作系统/平台组合，它们可以混合在一个系统中。

> 节点一般使用C/C++，服务器和客户端一般使用C++/C#

这些通常是受支持的，并且可以在系统中混合使用。

> 节点应该（最好）不需要安装额外的软件或服务器，即每个节点一个专用的代理或额外的服务是昂贵的

此类选项可用，但是否需要额外服务取决于 DDS 实施和您要使用的功能。

> 安全性将基于消息，即不需要传输安全性

这肯定会让您的生活更轻松——但对于那些必须在消息级别实施该保护的人来说却不是那么容易。DDS 安全是 DDS 生态系统中较新的标准之一，它提供对应用程序透明的全面安全模型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T06:20:10.023

似乎 ZeroMQ 可以轻松满足要求，无需管理中央基础设施。由于您的监控服务器是固定的，因此解决问题确实非常简单。0MQ 指南中的这一部分可能会有所帮助：

[http://zguide.zeromq.org/page:all#Distributed-Logging-and-Monitoring](http://zguide.zeromq.org/page:all#Distributed-Logging-and-Monitoring)

您提到“可靠性”，但您能否指定您想要恢复的实际故障集？如果您使用的是 TCP，那么根据定义，网络已经是“可靠的”。

# iphone - 带有空数组的 UIPickerView

> ID：13483812
> 
> 赞同：0
> 
> 时间：2012-11-20T23:11:20.980
> 
> 标签：iphone, objective-c, ios6

我已经成功设置了 UIPickerView，但我想知道当数据最初为空时处理这种情况的最佳方法。对于我当前的迭代，我将以下代码用于 pickerdelegate

```
-(NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row                           forComponent:(NSInteger)component
{ 
    if ([flash_cards count])
    {
        return [[flash_cards allKeys] objectAtIndex:row];
    }

return @"";
} 
```

在哪里

```
 flash_cards = NSMutableDictionary * 
```

每当我尝试滚动时，它都会产生一个 indexoutofbounds 错误，这只是合乎逻辑的。如何处理空数组的情况？

编辑：

同样作为代码的一部分，我实现了以下

```
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponen: (NSInteger)component
  {
     return [flash_cards count];

  }

  #pragma mark Picker Data Source Methods
  - (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
  {
   return 1;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T15:01:42.273

要解决此问题，您应该在数组为空时在方法中返回 1 而不是 0，如下例所示`numberOfRowsInComponent`： `UIPickerViewDataSource`

```
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component
{
    return [self.myArray count] == 0 ? 1 : [self.myArray count];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:23:36.560

您还应该实现[UIPickerViewDataSource](http://developer.apple.com/library/ios/#documentation/iPhone/Reference/UIPickerViewDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIPickerViewDataSource)方法：

```
- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component 
```

您仍然可以使用`flash_cards`（或`[flash_cards count]`）来导出这些方法的返回值；如果您的数据为空，您可以返回 0，然后`-reloadAllComponents`在加载数据时调用您的选择器视图。

# java - 无法显示首选项 3 点菜单

> ID：13483813
> 
> 赞同：1
> 
> 时间：2012-11-20T23:11:27.003
> 
> 标签：java, android, android-actionbar

我在一个应用程序上工作了很长时间，到目前为止我使用的主题是顶部的操作栏。

现在在操作栏中我有 3 个点符号（使用银河系）。

我决定不再需要操作栏，当我通过清单将其取下时，我没有像我应该的那样得到它。

任何想法为什么？

谢谢你。

这是活动的代码：

```
 public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
    //initialize
   this.spMain = getSharedPreferences("main", 0);
   this.numofcourses = this.spMain.getInt("numofcources", 0);
   this.tvTotalAvarge = (TextView)findViewById(R.id.totalAvarage);
   this.mainLayout = (LinearLayout)findViewById(R.id.mainlayout);

   if(this.numofcourses ==0) {
       Intent intent = new Intent(this,Newuser.class);
       startActivity(intent);
       finish();
   }

   else this.loadCourses();
}
 public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;

}

public boolean onOptionsItemSelected(MenuItem item) {
    Intent intent =new Intent(this, Newuser.class);
    startActivity(intent);
    finish();
    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:15:20.947

查看文章[向菜单按钮说再见](http://android-developers.blogspot.com/2012/01/say-goodbye-to-menu-button.html)

如果您的应用在没有专用菜单按钮的设备上运行，系统会根据您在清单元素中声明支持的 API 级别来决定是否将操作溢出添加到导航栏。逻辑归结为：

*   如果将 minSdkVersion 或 targetSdkVersion 设置为 11 或更高，系统将不会添加旧版溢出按钮。

*   否则，系统会在 Android 3.0 或更高版本上运行时添加旧版溢出按钮。

*   唯一的例外是，如果您将 minSdkVersion 设置为 10 或更低，将 targetSdkVersion 设置为 11、12 或 13，并且您不使用 ActionBar，则在 Android 4.0 或更高。

# linq - 无法让 !any() 查询与 raven db 一起使用

> ID：13483815
> 
> 赞同：1
> 
> 时间：2012-11-20T23:11:33.587
> 
> 标签：linq, ravendb

我是 RavenDB 的新手，尝试让 Any() LINQ 查询正常工作一直令人沮丧。这是我的文档的样子：

```
{
  "Key": "BKey",
  "Text": "B Key",
  "IsLocal": false,
  "Category": null,
  "_destroy": false,
  "Translations": [
    {
      "CultureCode": "es-ES",
      "Text": null
    },
    {
     "CultureCode": "ja-JP",
     "Text": "Hello"
    }
  ]
} 
```

我希望以下查询能给我所有没有“es-ES”翻译的条目：

```
var nonTranslatedEntries = 
_docs.Query<ResourceEntry>().Where( e => e.Translations == null || e.Translations.Count == 0 || !e.Translations.Any(t => t.CultureCode == "es-ES" && t.Text != null)) 
```

但是，这是行不通的。即使存在指定 CultureCode 的翻译，它也会带回条目。如果我在翻译数组中只有一项，它就可以工作。但是，一旦翻译数组中有多个项目，查询就会停止工作。

作为替代解决方案，我尝试执行以下操作：

```
var translatedEntries =  from re in _docs.Query<ResourceEntry>()
                                    where re.Translations.Any(t => t.CultureCode == cultureCode && t.Text != null)
                                    select new {Id = re.Id};
var translatedIds = translatedEntries.ToList().Select(e => e.Id).ToList();

var nonTranslatedEntries = 
  _docs.Query<ResourceEntry>().Where(e => !e.Id.In(translatedEntryIds)); 
```

但这只会带回一个空列表。

任何帮助将不胜感激。

谢谢，

尼扎尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:56:02.353

将完成工作的静态索引：

```
public class Resources_ByTranslation : 
    AbstractIndexCreationTask<ResourceEntry, Resources_ByTranslation.IndexEntry>
{
    public class IndexEntry
    {
        public string Key { get; set; }
        public string CultureCodes { get; set; }
    }

    public Resources_ByTranslation()
    {
        Map = entries => from entry in entries
                         select new {
                                     entry.Key,
                                     CultureCodes = entry.Translations
                                                     .Where(x => x.Text != null)
                                                     .Select(x => x.CultureCode)
                                    };
    }
} 
```

然后查询：

```
var nonTranslatedEntries =
    session.Query<Resources_ByTranslation.IndexEntry, Resources_ByTranslation>()
           .Where(x => x.CultureCodes != "es-ES")
           .As<ResourceEntry>(); 
```

请注意，CultureCodes 列表被视为单个字符串。这是由于索引匹配在内部是如何工作的。这有点奇怪，但它确实有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T16:22:40.233

我最终解决了我的问题，如下所示：

创建资源条目后，我继续创建所有可能的翻译并将翻译文本设置为 null：

```
{
  "Key": "BKey",
  "Text": "B Key",
  "IsLocal": false,
  "Category": null,
  "_destroy": false,
  "Translations": [
    {
      "CultureCode": "es-ES",
      "Text": null
    },
    {
     "CultureCode": "ja-JP",
     "Text": null
    }
  ]
} 
```

然后我创建了以下索引：

```
public class ResourceEntries_ByCultureCodes : AbstractIndexCreationTask<ResourceEntry>
    {
        public ResourceEntries_ByCultureCodes()
        {
            Map = entries => from e in entries
                             select new
                                 {
                                     e.Id,
                                     e.Key,
                                     e.Text,
                                     e.IsLocal,
                                     e.Category,
                                     _ = e.Translations.Select(t => CreateField(t.CultureCode, t.Text != null, false, true))
                                 };
        }
} 
```

如果存在针对该特定文化的翻译，这给了我一个平坦的翻译记录，其值设置为“真”。例如，我得到这样的东西：

```
{ 
   Id,
   Key,
   Text,
   IsLocal,
   Category,
   es-ES: <true> or <false> depending upon whether Translation.Text != null
   ja-JP:<true> or <false> depending upon whether Translation.Text != null
} 
```

然后我可以按如下方式执行 LuceneQuery 以获取所有未翻译的“es-ES”条目：

```
_docs.LuceneQuery<ResourceEntry, ResourceEntries_ByCultureCodes>().WhereEquals("es-ES", false); 
```

不过，我希望有一个更简单的解决方案。

# qa - QA 软件模拟日/周/月/年时间跨度？

> ID：13483819
> 
> 赞同：1
> 
> 时间：2012-11-20T23:11:39.187
> 
> 标签：qa

我正在尝试测试按计划每天/每周/等运行的东西。目前我需要等待一天中的特定时间进行测试。如果我想重新运行测试，我需要将时间重置为当天的下一个小时。这使测试变得很尴尬。我想知道是否存在某种可以用来模拟时间变化的软件。

例如，假设我有一些运行 Windows Server 的 VPC。我想做的是安装一些软件，可以诱使服务器比实时更快地推进时间。大约 5 分钟的时间会使服务器上的时间提前 1 小时或 1 天，等等。这样的事情是否存在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T10:22:14.893

您可以使用[Autoit](http://www.autoitscript.com/site/autoit/)之类的脚本编写脚本，该脚本会在一段时间内按您需要的时间间隔调整服务器时间。然后它可以通过弹出窗口或电子邮件向您发送消息。

最后，如果您需要创建的脚本在一天中的某个时间启动（例如，服务器时间将从中午开始以 10 分钟的间隔提前 5 分钟），您可以使用[Windows 任务计划程序](http://www.howtogeek.com/123393/how-to-automatically-run-programs-and-set-reminders-with-the-windows-task-scheduler/)来启动它。

# php - 无法使用 CraueFormFlowBundle 上传文件

> ID：13483820
> 
> 赞同：0
> 
> 时间：2012-11-20T23:11:42.023
> 
> 标签：php, symfony, file-upload, craueformflow

我正在尝试使用[CraueFormFlowBundle](https://github.com/craue/CraueFormFlowBundle)以多步骤形式上传文件。

一切正常，但在流程结束时，我的实体从未像以前那样使用文件路径更新

这基本上是我想要做的：

```
// FormType

public function buildForm(FormBuilder $builder, array $options) {
    switch ($options['flowStep']) {
        case 1:
            $builder->add('username', 'text', array('label'=>'Votre pseudo','required'=>false))
                ->add('file','file', array('label'=>'Photo de profil','required'=>false));
            break;
// .... 
```

虽然我的实体是这样设置的：

```
/**
 * Ray\CentralBundle\Entity\Client
 *
 * @ORM\Table(name="clients")
 * @ORM\Entity(repositoryClass="Ray\CentralBundle\Entity\ClientRepository")
 * @ORM\HasLifecycleCallbacks
 */
class Client implements UserInterface
{
    private $filenameForRemove;

    /**
     * @var string $username
     *
     * @ORM\Column(name="username", type="string", length=255)
     */
    private $username;

    /**
     * @var file $file
     *
     * @Assert\File(maxSize="6000000")
     */
    public $file;

    // ... 
```

似乎当`$flow->saveCurrentStepData();`被调用时，`$form['file']`被填充并指向临时文件。

我不明白的是，为什么在下一步中，文件值不会存储在会话中。

我已经扩展了这样的`getSessionData()`方法`Craue\FormFlowBundle\Form\FormFlow`：

```
protected function getSessionData() {

    var_dump($this->session->get($this->sessionDataKey, array()));

    return $this->session->get($this->sessionDataKey, array());
} 
```

正如预期的那样，这给了我除了“文件”之外的所有表单数据......

如何让文件上传与此捆绑包一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T11:11:42.420

这是因为您无法在会话中存储文件...

这里有可能管理它..

控制器

```
// ...
if ($flow->isValid($form)) {
    $data = $request->request->get($form->getName(), array());

    // upload the entity (Event) main picture
    if ($event->preUpload() && $picture = $event->upload()) {
        $data['picture'] = $picture;
    }

    // save form progress
    $flow->saveCurrentStepData($data);
// ... 
```

实体事件

```
// ...

public function preUpload()
{
    if(null !== $this->picturefile)
    {
        $this->picture = uniqid() . '.' . $this->picturefile->guessExtension();
        return $this->picture;
    }
} 
```

而且您必须覆盖 FormFlow 方法 saveCurrentStepData() ...（使用带有 getParent 的自定义 Bundle）

```
public function saveCurrentStepData($data = false) {
    $sessionData = $this->getSessionData();
    $sessionData[$this->currentStep] = $data ? $data : $this->request->request->get($this->formType->getName(), array()) ;
    $this->setSessionData($sessionData);
} 
```

# c# - 获取 WrapPanel 中的行数？

> ID：13483822
> 
> 赞同：4
> 
> 时间：2012-11-20T23:12:09.630
> 
> 标签：c#, wpf

我有一个将其 ItemsPanelTemplate 实现为 WrapPanel 的列表框。我需要计算行数以进行导航

```
<ListBox>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate>
            <WrapPanel Grid.IsSharedSizeScope="True" />
        </ItemsPanelTemplate>
    <ListBox.ItemsPanel>
<ListBox> 
```

有什么直接的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T23:20:10.230

因为这`WrapPanel`是一个流量控制，您必须执行计算以确定有多少对象适合自己。

取 的`ActualHeight`属性`WrapPanel`，除以您要放置在面板中的对象`ActualHeight`的项目（或`ItemHeight`的属性）的属性。`WrapPanel`那应该给你行数：

```
int numRows = (int)(WrapPanel.ActualHeight / Item.ActualHeight); 
```

或者：

```
int numRows = (int)(WrapPanel.ActualHeight / WrapPanel.ItemHeight); 
```

如果您设置了任何边距，则此计算将关闭，但您应该能够将它们考虑在内。

（您可以对`ActualWidth`and执行相同的操作`ItemWidth`来获取列数）。

# ruby-on-rails - 当用户单击 Ruby on Rails 中表单的提交按钮时，如何显示确认？

> ID：13483823
> 
> 赞同：0
> 
> 时间：2012-11-20T23:12:10.440
> 
> 标签：ruby-on-rails, ruby, forms, actionmailer

我是这门语言的新手，如果这浪费了你的时间，请原谅我。用户完成提交查询后，下面的代码应显示**“消息已成功发送” 。**它没有按预期工作。谢谢

```
flash.now.notice= "Message was successfully sent." 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:50:32.480

`flash`是一个哈希，试试`flash[:notice] = "mesage"`.

然后：

```
# on whichever template you want to render the flash messages, 
# most likely on layouts/application.html.erb
<% if flash[:notice] %>
  <div class="notice"><%= flash[:notice] %></div>
<% end %> 
```

# html - Set-Cookie 在 IE 中不起作用

> ID：13483825
> 
> 赞同：1
> 
> 时间：2012-11-20T23:12:14.960
> 
> 标签：html, cookies, php4, setcookie

我正在使用 Set-Cookie 功能..它在 chrome 和 firefox 中运行良好。

它设置了 cookie，我可以在 firebug 中看到它。

但由于某种原因，它没有在 IE 中设置 cookie

谁能验证我的语法是否正确或我做错了什么？

```
 function generateSession($cookieName="wic_secure_sess", $idTag="", $numChars=32, $expireSeconds=0, $path=null, $domain=null, $secure=2) {
        if (!isset($_COOKIE[$cookieName])) {
            $sessId = $idTag;
            for ($i=0; $i<$numChars; $i++) {
                srand((double)microtime()*1000000);
                $randomType=rand(1, 3);
                srand((double)microtime()*1000000);
                switch ($randomType) {
                case 1:
                    $sessId.=chr(rand(65, 90));
                    break;
                case 2:
                    $sessId.=chr(rand(97, 122));
                    break;
                case 3:
                    $sessId.=rand(0, 9);
                    break;
                }
            }

        $expires = str_replace('+0000', 'GMT', gmdate('r', strtotime('+30 days')));
            if ($expireSeconds != 0) {
                $expireSeconds = time()+$expireSeconds;
            }

            if (livecheck() || stagecheck()) {
            header( "Set-Cookie:". $cookieName."=".$sessId."; expires=".$expires."; path=".$path.";HttpOnly;secure;");

            }
            else {

                     header( "Set-Cookie:". $cookieName."=".$sessId.";               expires=".$expires."; path=".$path.";HttpOnly");

            }   

        } else {
            $sessId = $_COOKIE[$cookieName];
        }
        return $sessId;
    }
?>
I dont want to use setcookie() because i am running php4 version since php4 does not support httponly in the setcookie() function 
```

编辑： php setcookie() 函数在 IE 中运行良好。当我使用 header() 时，这会产生问题。

```
setcookie($cookieName, $sessId, $expireSeconds, $path, $domain, $secure); 
```

这是对我的函数的调用：

```
generateSession( "my_sess", "", 20, 14400, "/"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T15:29:15.783

您可能要考虑使用[P3P 隐私政策](http://www.w3.org/TR/P3P/)。这种策略格式目前只被 Internet Explorer 接受，但有助于克服浏览器隐私策略中的 cookie 阻止。P3P 隐私策略有两个部分：策略文件和紧凑策略头。对于大多数应用程序而言，紧凑的策略标头通常就足够了，而且实现起来也最省力。P3P 的不同类别在标题中具有简洁的代码，例如导航 => NAV。至少，我将从紧凑策略的交互式 (INT)、导航 (NAV) 和唯一 ID (UNI) 代码开始。

在 Grails/Java 中，下面是一个如何传回标头的示例：

```
response.setHeader("P3P", "CP='INT NAV UNI'"); 
```

# php - 还从 preg_match_all 获取不匹配的字符串

> ID：13483826
> 
> 赞同：0
> 
> 时间：2012-11-20T23:12:15.633
> 
> 标签：php, preg-match-all

我有一些带有`<img>`标签的文本，我需要将它们分开。它的格式

```
<img.../> Text text text <img.../>text text text<img.../> text text text 
```

我有我的正则表达式 qworking`preg_match_all`以便我得到

```
Array
(
    [0] => Array
        (
            [0] => <img ... />
            [1] => <img ... />
            [2] => <img ... />
            [3] => <img ... />
        ) 
```

但如果我能得到，那就太好了

```
Array
(
    [0] => Array
        (
            [0] => <img ... />
            [1] => text text text 
            [2] => <img ... />
            [3] => text text text 
            [4] => <img ... />
            [5] => text text text 
        ) 
```

我已经尝试了一些东西，但我真的对 PCRE 不太了解。`preg_split`如果可以避免，我不想使用它，因为每个图像标签都不同。

（我知道一般的 HTML 解析器不能用正则表达式编写，但在这种情况下，我认为这会起作用，因为我正在处理的输入数据是我描述的形式。不会有任何嵌套我需要担心的图像标签。）

**PS**我试过`/!<img.+>/`,`/!(<img.+>)/`和`/(!(<img.+>))/`来获取不匹配项，但它返回一个空数组。我不知道调试正则表达式以了解我做错了什么的好方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:40:29.770

我不知道您的问题（*或实际代码*）是什么，但是：

```
$r = preg_split('#<img[^>]+>#', $source, 0, PREG_SPLIT_DELIM_CAPTURE); 
```

结果是：

```
Array
(
    [0] => <img.../>
    [1] =>  Text text text 
    [2] => <img.../>
    [3] => text text text
    [4] => <img.../>
    [5] =>  text text text
) 
```

代替适当的正则表达式，您`#<img1>|<img2>|<img3>#`当然可以继续使用固定字符串（我想）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:47:50.343

通过执行以下操作，您可以获得您想要的信息，但格式不完全正确：

```
preg_match_all('~(<img[^>]*>)([^<]+)~', $str, $matches);

//if inside your "text text text" areas you have other html tags, use this:
preg_match_all('~(<img[^>]*>)(.+?)(?=<img|$)~', $str, $matches); 
```

此时，`$matches[0]`包含整个匹配的字符串。`$matches[1]`包含第一组括号`$matches[2]`中的所有匹配项，并包含第二组括号中的所有匹配项。

```
Array ( 
  [0] => Array ( 
    [0] => <img.../> Text text text 
    [1] => <img.../>text text text 
    [2] => <img.../> text text text 
  )
  [1] => Array ( 
    [0] => <img.../> 
    [1] => <img.../> 
    [2] => <img.../> 
  ) 
  [2] => Array ( 
    [0] =>  Text text text 
    [1] => text text text 
    [2] =>  text text text 
  ) 
) 
```

现在，如果您真的需要按照您想要的方式对其进行格式化，只需添加以下代码行：

```
$answer = array();
foreach($matches[0] as $i=>$match){
  $answer[] = $matches[1][$i];
  $answer[] = $matches[2][$i];
}; 
```

`$answer`现在看起来像这样：

```
Array ( 
  [0] => <img ... />
  [1] =>  Text text text 
  [2] => <img ... />
  [3] => text text text 
  [4] => <img ... />
  [5] =>  text text text 
) 
```

# css - IE 6,7,8,9 CSS 兼容性样式表

> ID：13483829
> 
> 赞同：4
> 
> 时间：2012-11-20T23:12:24.160
> 
> 标签：css, internet-explorer

为所有浏览器开发，然后争取 IE 兼容性是所有 Web 开发过程中众所周知的步骤。

不是网络集成商，您是否知道任何适合 IE 的通用兼容性样式表（在我的情况下，我只关心 IE7，但我会让所有版本的问题都开放）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T23:15:25.017

normalize.css 是一个很好的重置方法，可以解决很多跨浏览器问题。 [http://necolas.github.com/normalize.css/](http://necolas.github.com/normalize.css/)

如果您想要预制组件，[Twitter Bootstrap是不错的选择。](http://getbootstrap.com/)它与 IE 兼容。如果你决定使用 Bootstrap，它的重置实际上是从[normalize.css](https://github.com/twbs/bootstrap/blob/master/dist/css/bootstrap.css#L8)改编的（所以你不需要两者）

如果您从头开始，HTML5 Boilerplate 也可能有助于一些最佳实践标记： [https ://github.com/h5bp/html5-boilerplate](https://github.com/h5bp/html5-boilerplate)

特别是，我建议使用 HTML5BP 条件注释来定位特定的 IE 版本，如下所示：

```
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> 
```

这意味着在您的 CSS 中，您可以使用类解决 IE 版本特定的问题：

```
.lt-ie8 .awesome-component { ... } 
```

最后，我建议反对使用像 CSS3PIE 这样的 javascript polyfills。以我的经验，它们只会带来比其价值更多的麻烦，并添加不必要的标记。

了解一些关于优雅降级/渐进增强的知识。

另一个答案提到了 IE7.js，我认为这很好，但我不记得它有多么有用。您肯定需要填充缺少的 JS 函数（如果您使用的是 js），例如 IE <= 8 中的 Array.indexOf。我刚刚发现这个 ECMAScript5 shim 看起来不错： [https ://github.com/kriskowal/ es5-垫片](https://github.com/kriskowal/es5-shim)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:15:54.043

我通常使用 Eric Meyer 的 CSS 重置 (http://meyerweb.com/eric/tools/css/reset/)，这是一个很好的简单起点。

您可能还希望考虑使用 ie7js (http://code.google.com/p/ie7-js/)，它使用 JavaScript 让不同版本的 IE 表现得更好。

# javascript - 使用 dracula 时如何调整图形节点的大小以适合文本？

> ID：13483831
> 
> 赞同：0
> 
> 时间：2012-11-20T23:12:42.630
> 
> 标签：javascript, raphael

我正在使用[dracula](http://www.graphdracula.net/)来可视化一些图表。这是一个使用 dracula 的示例 html 页面：

```
<html>

    <head>
        <title>
            Testing Dracula
        </title>
        <script type="text/javascript" src="scripts/vendor/dracula/raphael-min.js">

        </script>
        <script type="text/javascript" src="scripts/vendor/dracula/dracula_graph.js">

        </script>
        <script type="text/javascript" src="scripts/vendor/dracula/dracula_graffle.js">

        </script>
        <script type="text/javascript" src="scripts/vendor/jquery.min.js">

        </script>
    </head>

    <body>
        <div id='canvas'>
        </div>
        <script type="text/javascript">
          var render = function(r, n) {
          var set = r.set().push(
          r.rect(n.point[0] - 30, n.point[1] - 13, 62, 86).attr({
                             "fill": "#fa8",
                             "stroke-width": 2,
                              r: "9px"
          })).push(r.text(n.point[0], n.point[1] + 30, n.label).attr({
                                   "font-size": "14px"
              })); /* custom tooltip attached to the set */
          set.items.forEach(
               function(el) {
                  el.tooltip(r.set().push(r.rect(0, 0, 0, 0).attr({
                                     "fill": "#fec",
                                     "stroke-width": 1,
                                     r: "9px"
                   })))
               });
          return set;
          };

          $(document).ready(function() {
             var width = $(document).width() - 20;
             var height = $(document).height() - 60;
             var g = new Graph();
             var data = {
               "vertices": ["This is some sample long text.", "A", "B", "C", "D\n some More Sample\n Text", "E"],
               "edges": [
                          [
                           0, 1],
                          [
                           0, 2],
                          [
                           0, 3],
                          [
                           2, 4],
                          [
                           3, 4],
                          [
                           4, 5]
                         ]
            };

            addNodes(data.vertices, g);
            addEdges(data.edges, g);

            var layouter = new Graph.Layout.Spring(g);
            layouter.layout(); /* draw the graph using the RaphaelJS draw implementation */
            var renderer = new Graph.Renderer.Raphael('canvas', g, width, height);
                                       renderer.draw();

                               });

            function addNodes(vertices, g) {
                jQuery.each(vertices, function(index, text) {
                g.addNode(index, {
                     label: text,
                     render: render
                             });
                           });
                               }
                 function addEdges(edges, g) {
                 jQuery.each(edges, function(index, arr) {
                 g.addEdge(arr[0], arr[1], {
                      directed: true
                   })
                 });
                               }
        </script>
    </body>

</html> 
```

如下图所示，节点中较长的文本在边界框之外流动。如何创建节点以使其尺寸足够大以容纳其范围内的内容？

![德古拉图示例](../Images/f65dcbe6ef5e286e70cb074960773183.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T21:35:25.890

你在正确的轨道上。您可以在渲染函数中执行此操作。首先添加文本元素，确定它的宽度，在创建框时使用该宽度，然后将文本元素移动到框元素之后。 [这就是为什么](https://stackoverflow.com/questions/6566406/svg-re-ordering-z-index-raphael-optional)第四步是必要的。

您可以将代码修改为以下内容：

```
var render = function(r, n) {
    var set = r.set().push(
    var textbit = r.text(n.point[0], n.point[1] + 30, n.label).attr({ "font-size": "14px" });
    var width = $(textbit.node).width() + 10 ;
    textbit.remove();
        r.rect(n.point[0] - Math.round(width / 2), n.point[1] - 13, width, 86).attr({
                     "fill": "#fa8",
                     "stroke-width": 2,
                      r: "9px"
    })).push(r.text(n.point[0], n.point[1] + 30, n.label).attr({
                           "font-size": "14px"
      })); /* custom tooltip attached to the set */
    set.items.forEach(
       function(el) {
          el.tooltip(r.set().push(r.rect(0, 0, 0, 0).attr({
                             "fill": "#fec",
                             "stroke-width": 1,
                             r: "9px"
           })))
       });
    return set;
}; 
```

当然，在这个例子中，我实际上并没有将文本元素移动到 DOM 的后面，而是首先创建文本的“测试”版本来获取宽度，然后我将其删除。简单地移动元素可能最终会更快（并且可能更优雅），但这有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-26T14:29:38.593

我能够以这种方式实现它。我为这种情况添加了自己的渲染函数，它根据节点的文本/标签处理节点的大小。

```
 var render = function (r, n) {
      var frame = r.rect(n.point[0] - 3*n.label.length, n.point[1] - 3, 6*n.label.length, 25);
      frame.attr({
          fill: n.Color, r: n.Radius,
          'stroke-width': (n.distance+'px')
      });
      /* the Raphael set is obligatory, containing all you want to display */
      var set = r.set().push(frame,
          /* custom objects go here */
          r.text(n.point[0], n.point[1] + 10,n.label)
      );
      return set;
  }; 
```

这将取决于您的字体大小，但公式将保持不变。

# http - 服务例如状态码响应

> ID：13483833
> 
> 赞同：2
> 
> 时间：2012-11-20T23:12:49.097
> 
> 标签：http, http-status-codes

我正在针对一些不同的响应（502、404、401 等）测试 curl。设置一些我可以点击并获得预定义响应的自定义设置是相当微不足道的，但如果那里有服务，它会节省我的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T18:01:11.330

Sripathi 的两个答案都是极好的工具。我希望他已经回答了，所以我可以将答案授予他：

> 请参阅[httpstat.us](http://httpstat.us)和[httpbin.org](http://httpbin.org)

# c# - windows程序数据文件存放在哪里？

> ID：13483837
> 
> 赞同：6
> 
> 时间：2012-11-20T23:13:20.110
> 
> 标签：c#

我的程序包含一个 sql lite db 文件，我的程序在第一次运行后创建该文件，然后将数据存储在 updon 应用程序使用中。数据库在一段时间内建立起来。在程序的安装目录下创建db文件

当修复了错误时，我必须定期更新应用程序，所以基本上我发布了一个新的 msi 安装程序，安装程序会删除除 db 文件之外的旧安装文件并安装新的程序文件。

一些用户没有将其安装到默认位置，因此在他们选择的位置中，db 文件不存在。

我想知道是否可以将数据文件存储到安装目录之外的某个程序数据文件夹中？这样我的程序的每个新更新都可以访问该程序数据文件夹中的数据..？

windows xp, vista 和 7 中是否有任何程序数据目录？以及如何在 C#/ 中访问它

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T23:23:30.757

查看[Environment.SpecialFolder Enum](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)以确定数据的正确位置。

我会投票给`Recent`文件夹，这里有其他选项：

*   ApplicationData（当前用户漫游配置文件）
*   CommonApplicationData（本地机器上的所有用户）
*   LocalApplicationData（本地机器上的当前用户）

获取您选择的文件夹

```
Environment.GetFolderPath(Environment.SpecialFolder.xxx)) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-20T23:20:08.337

将用户数据存储在应用程序文件夹中是非常危险的。如果用户更新或卸载您的应用程序，不仅数据会被破坏，而且标准用户甚至无法写入应用程序目录。

`Environment.SpecialFolder.ApplicationData`我通常在应用程序中包含一个种子数据库，并在应用程序启动时将其复制到文件夹中的一个文件夹中 。所有用户数据都存储在副本中；如果用户卸载应用程序，种子数据库将被删除，但用户数据仍然存在。有关示例，请参见此 SO[答案。](https://stackoverflow.com/a/13296809/22437)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T23:16:46.097

您不应将数据存储在安装文件夹中。[试试这个](http://msdn.microsoft.com/en-us/library/14tx8hby.aspx)。特殊文件夹旨在让您能够存储此类数据。还有应用程序设置，可以轻松访问并提供一种简单的方法来存储用户键值对[Information](http://msdn.microsoft.com/en-us/library/0zszyc6e.aspx)。

# xaml - 如何将富文本（FlowDocument？）从我的视图模型绑定到 RichTextBlock？

> ID：13483838
> 
> 赞同：5
> 
> 时间：2012-11-20T23:13:29.937
> 
> 标签：xaml, data-binding, windows-8, winrt-xaml

我能够在网上找到的将文本绑定到 WinRT 的唯一示例`RichTextBlock`如下所示：

```
<RichTextBlock>
    <Paragraph>
        <Run Text="{Binding Content}"/>
    </Paragraph>
</RichTextBlock> 
```

我能够找到的实际显示富文本的唯一示例如下所示：

```
<RichTextBlock>
    <Paragraph>
        <Run>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In ligula nisi, vehicula nec eleifend vel, rutrum non dolor. Vestibulum ante ipsum primis in faucibus orci</Run>
        <Run FontSize="30">luctus</Run>
        <Run>et ultrices posuere cubilia Curae; Curabitur elementum scelerisque accumsan. In hac habitasse platea dictumst. Maecenas eu nibh vitae nibh laoreet placerat. Duis dolor ante, semper luctus ullamcorper eget, placerat et ligula. Donec placerat tincidunt vehicula. Fusce condimentum lacus quis libero blandit semper sed vel quam. Proin eget nisl lacinia nibh convallis scelerisque at sed massa. Duis commodo tincidunt consequat. Duis malesuada, nisl a pharetra placerat, odio dui suscipit quam, vitae rhoncus sem risus quis odio. Aliquam justo nunc, adipiscing id elementum sit amet, feugiat vel enim. Aliquam pharetra arcu nec elit luctus euismod. Suspendisse potenti.</Run>
    </Paragraph>
</RichTextBlock> 
```

我将如何将文本数据绑定`RichTextBlock`到我的视图模型中可能包含多个段落并运行的属性？该视图模型属性需要是什么类型？

我看过一些关于使用 a 的参考资料`FlowDocument`，但我不知道这是否适用于 a `RichTextBlock`。但是，即使这些示例也没有显示任何与文档的数据绑定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T05:06:36.617

RichTextBlock 似乎不提供文档绑定。相反，您可以使用自定义 RichTextBlock 控件来实现它。你可以试试[Bindable RichTextBlock](http://geoffwebbercross.blogspot.in/2011/09/richtextblock-xaml-bindable-rich-text.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-07T13:49:28.927

我有同样的问题，我的解决方案是手动完成。

1.  订阅 view.xaml.cs 中的 notifyPropertyChanged
2.  发生更新时，检查是否是您的属性已更新
3.  如果是这样，请更新您的`RichTextBlock`

这是代码。

```
private void Page_OnLoaded(object sender, RoutedEventArgs e)
        {    
            SetReferences();
            (DataContext as INotifyPropertyChanged).PropertyChanged += OnPropertyChanged;
        }

        private void Page_OnUnloaded(object sender, RoutedEventArgs e)
        {
            (DataContext as INotifyPropertyChanged).PropertyChanged -= OnPropertyChanged;
        }

        private void OnPropertyChanged(object sender, PropertyChangedEventArgs e)
        {
            var propertyName = GetPropertyName<MyViewModel, object>(x => x.References); // I use this to avoid bugs at runtime
            if (e.PropertyName == propertyName)
                SetReferences();
        }

        private void SetReferences()
        {
            var references = (DataContext as MyViewModel).References;
            ReferencesRichTextBlock.Blocks.Clear();
            foreach (var reference in references)
            {
                var paragraph = new Paragraph();
                paragraph.Inlines.Add(new Run { Text = reference.Title, FontWeight = FontWeights.Bold});
                paragraph.Inlines.Add(new Run { Text = " : "});
                paragraph.Inlines.Add(new Run { Text = reference.Content});
                paragraph.Inlines.Add(new LineBreak());

                ReferencesRichTextBlock.Blocks.Add(paragraph);
            }
        }

        public static string GetPropertyName<T, P>(Expression<Func<T, P>> action) where T : class
        {
            var expression = (MemberExpression)action.Body;
            var name = expression.Member.Name;

            return name;
        } 
```

当然，这是 xaml

```
<Page ...
      Loaded="Page_OnLoaded"
      Unloaded="Page_OnUnloaded">
...
<RichTextBlock x:Name="ReferencesRichTextBlock">

                            </RichTextBlock>
</Page> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T04:09:10.860

I have bound data to the RichTextBlock in one of my projects. See the XAML below. I'm binding a few string values and an image. You can see a snapshot of how the page gets rendered here: ![enter image description here](../Images/90fb130a4321c7a0c262c114207efebe.png)

```
 <common:RichTextColumns x:Name="richTextColumns" Margin="117,0,117,47" VerticalAlignment="Top">
<RichTextBlock x:Name="richTextBlock" Width="560" Style="{StaticResource ItemRichTextStyle}" TextWrapping="Wrap">
    <Paragraph>
    <Run FontSize="20" FontWeight="Light" Text="{Binding Title}"/>
    <LineBreak/>
    </Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">
    <InlineUIContainer>
        <ItemsControl ItemsSource="{Binding Authors}">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
            <StackPanel Orientation="Vertical"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
            <StackPanel>
                <HyperlinkButton Content="{Binding}"
                    VerticalAlignment="Center" FontSize="14"
                    Tapped="AuthorSearchLinkTapped"
                    IsTapEnabled="True"
                    Padding="0, 0, 0, 0"/>
            </StackPanel>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
        </ItemsControl>
    </InlineUIContainer>
    </Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">
    <InlineUIContainer>
        <Image x:Name="image" MaxHeight="200" Margin="0,20,0,10" Stretch="Uniform" Source="{Binding ImageUrl}"/>
    </InlineUIContainer>
    </Paragraph>
    <Paragraph LineStackingStrategy="MaxHeight">
    <InlineUIContainer>
        <Grid Width="560" Height="125" MaxHeight="125">
        <TextBlock Text="Loading ad..." 
               VerticalAlignment="Center" 
               HorizontalAlignment="Center"
               Style="{StaticResource BasicTextStyle}"/>
        <UI:AdControl ApplicationId="ec6615c8-dc88-4413-af37-1fc3b5603e85" 
                  AdUnitId="104236"
                  Width="250" Height="125"
                  HorizontalAlignment="Center"/>
        </Grid>
    </InlineUIContainer>
    </Paragraph>
    <Paragraph>
    <Run FontWeight="SemiLight" Text="{Binding Description}"/>
    </Paragraph>
</RichTextBlock>

<!-- Additional columns are created from this template -->
<common:RichTextColumns.ColumnTemplate>
    <DataTemplate>
    <RichTextBlockOverflow Width="560" Margin="80,0,0,0">
        <RichTextBlockOverflow.RenderTransform>
        <TranslateTransform X="-1" Y="4"/>
        </RichTextBlockOverflow.RenderTransform>
    </RichTextBlockOverflow>
    </DataTemplate>
</common:RichTextColumns.ColumnTemplate>
</common:RichTextColumns> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-13T21:59:26.037

我也有类似的情况。我想根据一些正在进行的操作使用状态消息更新 ReadOnly RichTextBox 的内容。这就是我最终做的事情：

```
<UserControl 
  x:Class="RawhideCsControl.StorageViewUserControl2" 
  <!-- >

      <RichTextBox  x:Name="StatusText" HorizontalAlignment="Left"  Height="350.72" VerticalAlignment="Top" Width="636">
          <FlowDocument>
               <Paragraph>
                    <Run Text="{Binding Status}"></Run>
               </Paragraph>
          </FlowDocument>
      </RichTextBox>

  <!-- >
</UserControl> 
```

代码：

```
 public partial class StorageViewUserControl2 : System.Windows.Controls.UserControl
    {
        // . . .

        StatusChanger statusChanger = new StatusChanger();
        private void AddStatusLine(string format, params object[] args)
        {
            if (args.Length > 0)
                format = string.Format(format, args);

            //m_StorageViewTreeModel.MirrorStatusDisplay += string.Format("{0}\r\n", format); 
            statusChanger.Status += string.Format("{0}\r\n", format);

        }//end this.AddStatusLine(str)

        // . . .
     } // end partial class

    public class StatusChanger : INotifyPropertyChanged
    {
        private string status = string.Empty;
        public string Status
        {
            get { return status; }
            set
            {
                status = value;
                OnPropertyChanged("Status");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void OnPropertyChanged( string PropertyName )
        {
            if( PropertyChanged != null )
                PropertyChanged( this, new PropertyChangedEventArgs(PropertyName));
        }
    } // end class StatusChanger 
```

# php - 长字符串未在 sqlite db 上更新 - php

> ID：13483839
> 
> 赞同：0
> 
> 时间：2012-11-20T23:13:43.620
> 
> 标签：php, string

我对显示 sqlite 数据库并可以编辑某些值的 php 页面有一点问题。我的问题是短字符串写入我的数据库，而大字符串未写入数据库。这是我的代码:(我认为有很多错误，但我不知道 php :()

```
<div id="editor">

        <?php
            if($_POST['NewText']){  
                $textNew = $_POST['textAreaTesto'];

                $db->exec("UPDATE Argomenti_".$_SESSION[sessioneMateria]." SET Testo='".$textNew."' WHERE ID='".$idTestoSelezionato."'");   

                echo ("UPDATE Argomenti_".$_SESSION[sessioneMateria]." SET Testo='testo' WHERE ID='".$idTestoSelezionato."'");  
            }
        ?>

        <form name="form" method="post" action="<?php echo $PHP_SELF;?>">
            <textarea id="textAreaTesto" name="textAreaTesto" cols=50 rows=30><?php echo $TestoSelezionato;?></textarea>
            <input type="submit" name="NewText" class='btn' value="invia testo">
        </form>

    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:24:12.533

您可以（并且应该）利用准备好的语句：

```
$textNew = $_POST['textAreaTesto'];

$stmt = $db->prepare("UPDATE `Argomenti_{$_SESSION['sessioneMateria']}` 
    SET Testo=:text
    WHERE ID=:id");   

$stmt->execute(array(
    ':text' => $textNew,
    ':id' => $idTestoSelezionato,
)); 
```

请注意，如果`$_SESSION['sessioneMateria']`填充了用户提交的值，您应该对其进行清理（即确保它仅包含字母等）。

# packaging - 向 debuginfo RPM 包添加过时/冲突字段？

> ID：13483841
> 
> 赞同：0
> 
> 时间：2012-11-20T23:13:45.943
> 
> 标签：packaging, rpm, specifications

经历了包名称更改，因此我所有的新包（例如 newlib、newlib-devel 等）都已过时并与旧包（例如 oldlib、oldlib-devel）发生冲突。

然而，-debuginfo 包是自动创建的，有没有办法在不禁用其自动创建 (%define debuginfo %{nil}) 并“手动”创建 debuginfo 包的情况下将过时和冲突字段添加到包中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T12:34:17.823

我不知道你是否解决了你的问题，但对我来说，将 * *-debuginfo*包添加到我的 RPM 规范的*Obsoletes字段就足够了。*否则我在尝试更新旧包时会发生冲突。

例子：

```
Obsoletes: oldlib oldlib-debuginfo 
```

干杯，托马斯

# php - cURL 上传到 Google Drive

> ID：13483846
> 
> 赞同：5
> 
> 时间：2012-11-20T23:13:59.227
> 
> 标签：php, curl, upload, google-drive-api

我可以通过 json 在 Google Drive 中创建一个文件到 Drive 文件夹中：

```
$data = array(
    "title" => $_FILES['file']['name'],
    "parents" => array(array(
        "kind" => "drive#parentReference",
        "id" => $parent_id
    )),
    "mimeType" => "application/pdf"
);
$data = json_encode($data);

$url = "https://www.googleapis.com/drive/v2/files?oauth_token=".$accessToken;
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/json'));
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data); 
```

但我找不到在其上添加 PDF 文件的方法，因为 Google Drive 文档中没有指定 json 属性。

我必须在哪里添加文件内容？这可能吗？

我是否必须上传文件以上传/驱动，然后上传带有文件夹 ID 的元数据？我不觉得这有什么意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:25:26.803

您想将文件放在正文中（即在 CURLOPT_POSTFIELDS 中）。您还需要指定与文件类型匹配的 Content-Type 和 Content-Length。

这是[有据可查](https://developers.google.com/drive/manage-uploads)的。

文件元数据应该进入 /drive/v2/files，而不是 /upload/drive/v2/files。

这样，您必须提出两个请求。

如果你想同时做一个文件和元数据，你可以使用 API 和文件插入：

[https://developers.google.com/drive/v2/reference/files/insert](https://developers.google.com/drive/v2/reference/files/insert)

请注意，有一个[PHP 库](https://developers.google.com/drive/downloads)可以使这更容易。

# amazon-ec2 - Amazon 免费实例的小时数

> ID：13483847
> 
> 赞同：0
> 
> 时间：2012-11-20T23:14:06.893
> 
> 标签：amazon-ec2

我在 EC2 中使用 Amazon 免费实例。

所以，我有 750 小时/月的时间来度过一年。

我的问题是：如果我同时运行 2 个实例，我将花费 2 倍的小时数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:19:49.273

正确的。每个实例按小时计费。

**但是**，如果您同时运行 Linux AMI 和 Windows AMI，您将分别获得 750 个免费小时。

# c# - 虚拟事件处理程序会导致任何问题吗

> ID：13483848
> 
> 赞同：4
> 
> 时间：2012-11-20T23:14:14.470
> 
> 标签：c#, .net, events, delegates, virtual

将虚拟方法注册为事件处理程序而不是注册委托给虚拟方法的私有方法是否有任何问题？我更喜欢选项 1（这似乎可行），但我想确保它以后不会咬我。

**选项1**

```
public class Controller1
{
    public Controller1(EventNotifier eventNotifier)
    {
        eventNotifier.ImportantEvent += OnEventNotifierImportantEvent;
    }

    protected virtual void OnEventNotifierImportantEvent(object sender, EventArgs e)
    {
    }
} 
```

**选项 2**

```
public class Controller2
{
    public Controller2(EventNotifier eventNotifier)
    {
        eventNotifier.ImportantEvent += eventNotifier_OnImportantEvent;
    }

    private void eventNotifier_OnImportantEvent(object sender, EventArgs eventArgs)
    {
        OnEventNotifierImportantEvent(sender, eventArgs);
    }

    protected virtual void OnEventNotifierImportantEvent(object sender, EventArgs e)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T23:56:50.090

只是永远不要在构造函数中引发事件。这适用于在构造函数中调用任何虚拟方法，而不仅仅是引发事件。原因是对象被实例化，构造函数以自上而下的方式执行，而虚拟方法基本上是自下而上解析的。虽然虚拟方法的代码很容易找到，但如果在构造函数中调用它，则最派生的实现可能依赖于根本不存在的状态数据，因为对象尚未完全实例化。

第二个选项基本上愚弄了 ReSharper 之类的重构助手，因此他们不会将“构造函数中的虚拟调用”标记为问题；构造函数中的调用不是虚拟的，除非它足够聪明，可以追踪（大多数都不是），否则它不会对级联的虚拟事件视而不见。但是，如果事件（任何一个）是从构造函数中引发的，仍然会有问题。

除此之外，我不知道有任何问题。

# cakephp - CakePHP 2.2.3 认证错误

> ID：13483857
> 
> 赞同：2
> 
> 时间：2012-11-20T23:15:04.630
> 
> 标签：cakephp, authentication

当我尝试进行身份验证时，`Your username or password was incorrect.`即使我刚刚创建了用户，它也会说。当我尝试时，`debug($this->Auth->login())`我收到了消息`false`。我的代码有什么问题？

模型 - UserModel.php：

```
<?php
App::uses('AppModel', 'Model', 'AuthComponent', 'Controller/Component');
/**
 * User Model
 *
 * @property Group $Group
 * @property WashMachine $WashMachine
 */
class User extends AppModel {

/**
 * Validation rules
 *
 * @var array
 */ 
    public function beforeSave($options = array()) {
        $this->data['User']['password'] = AuthComponent::password($this->data['User']['password']);
        return true;
    }

    public function bindNode($user) {
        return array('model' => 'Group', 'foreign_key' => $user['User']['group_id']);
    }

    public $validate = array(
        'username' => array(
            'notempty' => array(
                'rule' => array('notempty'),
                //'message' => 'Your custom message here',
                //'allowEmpty' => false,
                //'required' => false,
                //'last' => false, // Stop validation after this rule
                //'on' => 'create', // Limit validation to 'create' or 'update' operations
            ),
        ),
        'name' => array(
            'notempty' => array(
                'rule' => array('notempty'),
                //'message' => 'Your custom message here',
                //'allowEmpty' => false,
                //'required' => false,
                //'last' => false, // Stop validation after this rule
                //'on' => 'create', // Limit validation to 'create' or 'update' operations
            ),
        ),
        'email' => array(
            'email' => array(
                'rule' => array('email'),
                //'message' => 'Your custom message here',
                //'allowEmpty' => false,
                //'required' => false,
                //'last' => false, // Stop validation after this rule
                //'on' => 'create', // Limit validation to 'create' or 'update' operations
            ),
        ),
        'password' => array(
            'notempty' => array(
                'rule' => array('notempty'),
                //'message' => 'Your custom message here',
                //'allowEmpty' => false,
                //'required' => false,
                //'last' => false, // Stop validation after this rule
                //'on' => 'create', // Limit validation to 'create' or 'update' operations
            ),
        ),
        'group_id' => array(
            'numeric' => array(
                'rule' => array('numeric'),
                //'message' => 'Your custom message here',
                //'allowEmpty' => false,
                //'required' => false,
                //'last' => false, // Stop validation after this rule
                //'on' => 'create', // Limit validation to 'create' or 'update' operations
            ),
        ),
    );

    //The Associations below have been created with all possible keys, those that are not needed can be removed

/**
 * belongsTo associations
 *
 * @var array
 */
    public $belongsTo = array(
        'Group' => array(
            'className' => 'Group',
            'foreignKey' => 'group_id',
            'conditions' => '',
            'fields' => '',
            'order' => ''
        )
    );

/**
 * hasMany associations
 *
 * @var array
 */
    public $hasMany = array(
        'WashMachine' => array(
            'className' => 'WashMachine',
            'foreignKey' => 'user_id',
            'dependent' => false,
            'conditions' => '',
            'fields' => '',
            'order' => '',
            'limit' => '',
            'offset' => '',
            'exclusive' => '',
            'finderQuery' => '',
            'counterQuery' => ''
        )
    );

} 
```

AppController.php

```
<?php
/**
 * Application level Controller
 *
 * This file is application-wide controller file. You can put all
 * application-wide controller-related methods here.
 *
 * PHP 5
 *
 * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)
 * Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)
 *
 * Licensed under The MIT License
 * Redistributions of files must retain the above copyright notice.
 *
 * @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)
 * @link          http://cakephp.org CakePHP(tm) Project
 * @package       app.Controller
 * @since         CakePHP(tm) v 0.2.9
 * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)
 */

App::uses('Controller', 'Controller');

/**
 * Application Controller
 *
 * Add your application-wide methods in the class below, your controllers
 * will inherit them.
 *
 * @package       app.Controller
 * @link http://book.cakephp.org/2.0/en/controllers.html#the-app-controller
 */
class AppController extends Controller {
    public $components = array(
        'Acl',
        'Auth' => array(
            'authorize' => array(
                'Actions' => array('actionPath' => 'controllers')
            )
        ),
        'Session'
    );

    public $helpers = array('Html', 'Form', 'Session');

    function beforeFilter() {

        //Configure AuthComponent
        $this->Auth->authorize = array(
            'Controller',
            'Actions' => array('actionPath' => 'controllers')
        );
        $this->Auth->authenticate = array('Form' => array('fields' => array('username' => 'login', 'password' => 'password')));
        $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login', 'admin' => false, 'plugin' => false);
        $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'login', 'admin' => false, 'plugin' => false);
        $this->Auth->loginRedirect = array('controller' => 'products', 'action' => 'index', 'admin' => false, 'plugin' => false);

    }
    function isAuthorized($user) {
        // return false;
        return $this->Auth->loggedIn();
    }

} 
```

用户控制器.php

```
<?php
App::uses('AppController', 'Controller');
/**
 * Users Controller
 *
 * @property User $User
 */
class UsersController extends AppController {
    function beforeFilter(){
       parent::beforeFilter();
       $this->Auth->allow('*');
    }

    public function login() {
        if ($this->request->is('post')) {
            if ($this->Auth->login()) {
                $this->redirect($this->Auth->redirect());
            } else {
                $this->Session->setFlash('Your username or password was incorrect.');
            }
        }
        if ($this->Session->read('Auth.User')) {
            $this->Session->setFlash('You are logged in!');
            $this->redirect('/', null, false);
        }
    }

    public function logout() {
        $this->Session->setFlash('Good-Bye');
        $this->redirect($this->Auth->logout());
    }
 /**
 * index method
 *
 * @return void
 */
    public function index() {
        $this->User->recursive = 0;
        $this->set('users', $this->paginate());
    }

/**
 * view method
 *
 * @throws NotFoundException
 * @param string $id
 * @return void
 */
    public function view($id = null) {
        $this->User->id = $id;
        if (!$this->User->exists()) {
            throw new NotFoundException(__('Invalid user'));
        }
        $this->set('user', $this->User->read(null, $id));
    }

/**
 * add method
 *
 * @return void
 */
    public function add() {
        if ($this->request->is('post')) {
            $this->User->create();
            if ($this->User->save($this->request->data)) {
                $this->Session->setFlash(__('The user has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The user could not be saved. Please, try again.'));
            }
        }
        $groups = $this->User->Group->find('list');
        $this->set(compact('groups'));
    }

/**
 * edit method
 *
 * @throws NotFoundException
 * @param string $id
 * @return void
 */
    public function edit($id = null) {
        $this->User->id = $id;
        if (!$this->User->exists()) {
            throw new NotFoundException(__('Invalid user'));
        }
        if ($this->request->is('post') || $this->request->is('put')) {
            if ($this->User->save($this->request->data)) {
                $this->Session->setFlash(__('The user has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The user could not be saved. Please, try again.'));
            }
        } else {
            $this->request->data = $this->User->read(null, $id);
        }
        $groups = $this->User->Group->find('list');
        $this->set(compact('groups'));
    }

/**
 * delete method
 *
 * @throws MethodNotAllowedException
 * @throws NotFoundException
 * @param string $id
 * @return void
 */
    public function delete($id = null) {
        if (!$this->request->is('post')) {
            throw new MethodNotAllowedException();
        }
        $this->User->id = $id;
        if (!$this->User->exists()) {
            throw new NotFoundException(__('Invalid user'));
        }
        if ($this->User->delete()) {
            $this->Session->setFlash(__('User deleted'));
            $this->redirect(array('action' => 'index'));
        }
        $this->Session->setFlash(__('User was not deleted'));
        $this->redirect(array('action' => 'index'));
    }
} 
```

Login.cp 视图：

```
<h2>Login</h2>
<?php
echo $this->Form->create('User', array('url' => array('controller' => 'users', 'action' => 'login')));
echo $this->Form->input('User.username');
echo $this->Form->input('User.password');
echo $this->Form->end('Login');
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:38:09.467

为什么您在表单设置中将“用户名”重新映射为登录”，但您的登录表单仍然包含“用户名”作为字段名称？

删除重新映射或将表单中的字段更改为“User.login”，因为您似乎有一个数据库字段用户名，首先应该完成：

```
'Form' => array('fields' => array('username' => 'username', 'password' => 'password'))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T12:20:44.043

You have to change from:-

```
 $this->Auth->authenticate = array('Form' => array('fields' => array('username' => 'login', 'password' => 'password'))); 
```

to:-

```
 $this->Auth->authenticate = array('Form' => array('fields' => array('username' => 'username', 'password' => 'password'))); 
```

or you can drop this line completely as it will take the default AuthComponent values defined

# html - Firefox 从缓存流而不是实时流

> ID：13483858
> 
> 赞同：3
> 
> 时间：2012-11-20T23:15:04.727
> 
> 标签：html, firefox, stream, icecast, internet-radio

我们构建了一个互联网广播流媒体，利用一个 icecast 服务器通过 html5 音频标签将 MP3 流式传输到 Firefox。但是，有时流媒体会因任何原因（断开连接等）而停止，当您重新启动流媒体时，它会从会话开始开始流式传输，这使我们相信它正在播放浏览器缓存中的内容。

让流媒体播放实际直播的唯一方法是删除 Firefox 中的历史记录。这在其他浏览器中不会发生。如果使用 flash 后备而不是 html5 音频标签，也会发生这种情况。

考虑过使用以下脚本，但认为它不适用于这种情况。

```
<meta http-equiv="Cache-control" content="no-cache" /> 
```

任何见解都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T04:09:28.623

**Note: See [@MosheL's answer](https://stackoverflow.com/a/54135422/362536) for a modern solution.**

**Old Answer (and probably still needed for SHOUTcast):**

I've found that with SHOUTcast/Icecast streams, the only way to guarantee that you won't be playing from cache is to use the old method of adding a cache-busting URL parameter.

If your original stream URL is this:

```
http://1.2.3.4/someMountPoint 
```

Then use JavaScript to generate a URL like this when playing:

```
http://1.2.3.4/someMountPoint?nocache=123456789 
```

This ensures that caching will not happen, as to the browser, they are different resources.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-01-10T19:09:05.640

冰铸.xml

```
 <http-headers>
    <header name="Cache-control" value="no-cache" />
</http-headers> 
```

更新（2020 年 3 月）：在 Chrome 上，我们需要解决一个缓冲直播流的问题：

```
<audio controls preload="false" autoplay="false" ..... 
```

# c# - 使用 NHibernate 生成 Crystal Report 文档

> ID：13483860
> 
> 赞同：1
> 
> 时间：2012-11-20T23:15:10.890
> 
> 标签：c#, crystal-reports, fluent-nhibernate, dataset

各位晚上好。

我正在 C#.Net 上使用 MVVM、Fluent NHibernate、WPF 开发应用程序，我们需要生成一些窗口的报告。我需要使用 Crystal Reports 工具创建报表。AFAIK，Crystal Reports 只生成带有数据集的报告。在简单的应用程序中，我只能生成一个数据集，构建报告并使其运行。但是我怎么做才能使 NHibernate 理解，或者如何使它工作，使用 NHibernate 传递数据，而不是创建一个 DataSet 并使这个报告直接访问数据库？简而言之：我想使用通过 NHibernate 获得的所有数据来填充报告。

欢迎任何帮助！！！

此致，

古斯塔沃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:37:51.810

[http://ayende.com/blog/2376/converting-an-object-collection-to-a-dataset](http://ayende.com/blog/2376/converting-an-object-collection-to-a-dataset)

[http://abombss.com/blog/2007/05/09/nhibernate-to-dataset/](http://abombss.com/blog/2007/05/09/nhibernate-to-dataset/)

你的问题不是新问题。基本上，通常的解决方案是从 NHibernate 获取信息作为域对象的集合，然后使用这些对象的属性手动构建 DataTable。

您还可以在 NHibernate 上添加一点香草 ADO。NHibernate ITransactions 有一个 Enlist() 方法，它基本上允许您在 NHibernate 实现的内部将一个普通的 ADO DbCommand 关联到 ADO DbTransaction 方法，并像不使用 NHibernate 时一样执行它，以获得结果ADO.NET 格式。这是我放入 Repository 实现的内容，允许我按名称调用遗留存储过程：

```
 public IDataReader ExecuteReaderStoredProcedure(string procName, IUnitOfWork uow, IEnumerable<KeyValuePair<string, object>> parameters)
    {
        var command = Sessions[uow].Connection.CreateCommand();

        command.CommandText = procName;
        command.CommandType = CommandType.StoredProcedure;
        foreach (var param in parameters)
        {
            var parameter = command.CreateParameter();
            parameter.ParameterName = param.Key;
            parameter.Value = param.Value;
            command.Parameters.Add(parameter);
        }

        Sessions[uow].Transaction.Enlist(command);
        return command.ExecuteReader();
    } 
```

然后可以使用 DataReader 来填充 DataTable/DataSet。

一些笔记；您看到的 IUnitOfWork 对象是链接到 Session 及其 Transaction 的令牌，用于控制它们的范围和生命周期；您可以修改它以使用您拥有的任何会话处理机制（包括从 SessionFactory 仅为此命令创建一个新的 Session，如果您选择）。你也可以传入“裸”的 SQL 字符串来执行；我通常会避免这种情况（事实上，实际实现中存储过程的名称是在特定静态类型的常量实例后面抽象出来的，类似于枚举）。

# windows-services - 从 Windows 服务捕获事件

> ID：13483862
> 
> 赞同：1
> 
> 时间：2012-11-20T23:15:22.263
> 
> 标签：windows-services, msmq

我构建了一个 Windows 服务，我们称之为 Jobs。我有一个 WinForm 应用程序，我们称之为 Viewer。

我希望 Viewer 在 Jobs 开始执行某事时接收来自 Jobs 的事件，以便 Viewer 可以向用户显示 Job A 开始、做某事、停止等。

有没有办法让 Jobs 抛出 Viewer 可以注册接收的事件？我能想到的最好的解决方案是使用 MSMQ，但是我想要一种更直接的方法，我启动 Viewer 并注册到 Jobs Windows 服务并要求从它接收通知/事件。

我似乎无法弄清楚如何在不使用 MSMQ 的情况下让 Windows 服务推送某些东西，或者让其他程序向它注册以接收推送。我绝对不想使用一些奇怪的文件和/或数据库系统，其中 Viewer 会休眠 5 秒，然后检查更改。我想要简化查看器等待事件的地方，但不必使用 MSMQ。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T08:00:37.497

您可以为此使用 WCF 双工绑定之一，例如 netTcpBinding 或 dualHttpBinding。[这里](https://stackoverflow.com/a/8897600/569662)有一个完整的例子，它似乎完全符合你的要求。

缺点是双工理解起来很复杂，而且可能不那么可靠。如果可以选择的话，我总是会使用单向通信（通过排队或其他机制）来实现解决方案。一种方式总是比双工更简单、更可靠。

# templates - 访问 Jinja2 中的全局变量包括

> ID：13483864
> 
> 赞同：1
> 
> 时间：2012-11-20T23:15:34.843
> 
> 标签：templates, jinja2

我有一个这样的模板：

```
{% extends 'master.html' %}
{% set myVar = true %}

...

{% block myBlock %}
    {% include '/includes/myinclude.html' %}
{% endblock %} 
```

我无法访问`myVar`我的包含内容。但是，如果我这样做：

```
{% block myBlock %}
    {% set myVar = myVar %}
    {% include '/includes/myinclude.html' %}
{% endblock %} 
```

神奇的是，它是可访问的。显然我不想在两个不同的地方设置我的变量。我做错了什么，或者这只是 Jinja2 做的一件愚蠢的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T01:00:11.503

我认为您必须将范围添加到块中，例如：

```
{% block myBlock scoped %}
    {% include '/includes/myinclude.html' %}
{% endblock %} 
```

来自文档：每个默认块可能无法从外部范围访问变量。

# c# - 在实体框架中搜索

> ID：13483870
> 
> 赞同：1
> 
> 时间：2012-11-20T23:16:03.267
> 
> 标签：c#, entity-framework-4.1

我试图让这段代码工作，但由于某种原因我得到了编译错误

```
 private IQueryable<T> FindObjects(Expression<Func<T, bool>> predicate, T item)
    {
        using (MainEntities mainEntities = new MainEntities())
        {
            try
            {
                return mainEntities.CreateObjectSet().Where(predicate);
            }
            catch (Exception exp)
            {
                throw new Exception(ErrorHelper.GenerateExceptionMessage(exp));
            }
        };
    } 
```

编译错误：无法从用法中推断方法“System.Data.Objects.ObjectContext.CreateObjectSet()”的类型参数。尝试明确指定类型参数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:42:34.280

假设这`T`是一个实体类型，您需要：

```
return mainEntities.CreateObjectSet<T>().Where(predicate); 
```

（顺便说一句：重新抛出一个新异常会掩盖调用代码的原始异常。至少使它成为新异常的 InnerException）。

# linux - 从信用卡读卡器解码音频

> ID：13483874
> 
> 赞同：6
> 
> 时间：2012-11-20T23:16:46.717
> 
> 标签：linux, audio, credit-card

我从我的银行那里得到了一个插入麦克风插孔的信用卡读卡器，他们为安卓和 MacOS 提供了应用程序来以这种方式接收付款。我没有任何这些系统，也不需要接受付款，但我对这个设备很好奇。我可以在笔记本电脑上录制声音。那么：有没有可以解码这个信号的 Linux 程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T19:25:13.090

感谢其他答案，我找到了正确的词来搜索并通过[作者的博客找到](http://blog.tehinterweb.com/?p=117)[了 mslib](https://github.com/ieatlint/mslib)，经过[一些调整](https://github.com/nomeata/mslib/commit/c4ae2aa876cab51d8d69e885d2313e2e96ef79fd)，让它从我的读者那里读取数据。

该库带有一个小型测试程序，可以读取由以下人员创建的文件：

```
arecord -c 1 -N -r48000 -f S16_LE -i -v
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:32:30.443

[这可能与基于 Square音频输入的读卡器](http://cosmodro.me/blog/2011/mar/25/rhombus-square-iskewedi/)做同样的事情；使用相当于磁带磁头的方式将信息读取为音频。有人[在 GitHub 上](https://github.com/sshipman/RhombusLib)编写了一些代码来解码这些数据。

# java - NullPointerException 使用带有 textview 的片段

> ID：13483875
> 
> 赞同：2
> 
> 时间：2012-11-20T23:16:46.637
> 
> 标签：java, android, xml, textview, nullpointerexception

我开始了`NullPointerException`，`tv.setMovementMethod(new ScrollingMovementMethod());`但我完全不知道为什么！我已经在 XML 文件中声明了 textView 并在 onCreateView 中对其进行了初始化。任何帮助，将不胜感激。

这是java代码的相关部分：

```
public class TestConnection extends Fragment {
    public TestConnection() {

    }

    JSONParser jParser = new JSONParser();

    //button pressed to get the items
    Button getAllItems;

    //declare list view
    TextView tv;

    //Progress dialog
    private ProgressDialog pDialog;

    //Make an arrayList containing all items
    ArrayList<HashMap<String, String>> itemsList;

    //url to get items
    private static String urlAllItems = "http://jamesalfei.netne.net/php/get_all_items.php";

    //JSON node/tag names
    private static final String TAG_SUCCESS = "success";
    private static final String TAG_ITEMS = "items";
    private static final String TAG_PID = "pid";
    private static final String TAG_NAME = "name";

    //items array
    JSONArray items = null;

    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.sql_layout,
                container, false);
        getAllItems = (Button) getActivity().findViewById(R.id.SQLGetItems);

        //listview
        tv = (TextView) getActivity().findViewById(R.id.sqltv); 

        tv.setMovementMethod(new ScrollingMovementMethod());

        getAllItems.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // Launching All products Activity
                retreiveProducts();
            }
        });
        return view;
    } 
```

这是xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <Button
            android:id="@+id/SQLGetItems"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:text="@string/getSQL" />

        <TextView
            android:id="@+id/sqltv"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_below="@+id/SQLGetItems"
            android:text="@string/sqlLabel" />

    </RelativeLayout> 
```

如果我使用了任何不好的编码实践，我深表歉意，但我对 android 编程非常陌生！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T23:19:58.000

您正在错误的视图中寻找您的 TextView。您应该搜索膨胀视图，而不是父视图，主要是因为您没有添加到`onCreateView()`. 所以替换：

```
tv = (TextView) getActivity().findViewById(R.id.sqltv); 
```

有了这个

```
tv = (TextView) view.findViewById(R.id.sqltv); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T23:19:34.913

视图没有附加到任何东西，因为您`false`在`inflate()`. 因此，您需要将范围`findViewById()`限定为具有 TextView 的布局。采用：

```
tv = (TextView) view.findViewById(R.id.sqltv); 
```

# c# - 替换 XContainer 上的元素，包括根元素

> ID：13483876
> 
> 赞同：1
> 
> 时间：2012-11-20T23:16:53.453
> 
> 标签：c#, xml, linq

给定一个 XContainer 我想完全包装它的内容（包括根元素）。XContainer 包含一些 XML。我试图通过将 XContainer 内容包装在父元素中来创建 XHTML 文档。

```
 XElement headElement = new XElement("head");
 XElement bodyElement = new XElement("body", container);
 container.ReplaceWith(new XElement("html", headElement, bodyElement)); 
```

以上不起作用。这可能吗？还是我需要创建另一个 XContainer 并使用原始 XContainer 的内容构建它？

**更新**

为含糊的问题道歉。让我添加一些上下文。我有一个将 XContainer 作为参数的方法。我想修改这个 XContainer 实例。期望的最终结果是原始 XContainer 内容被“包装”在 body 元素中。在下面的示例中，XContainer 在调用 ReplaceWith() 之后似乎没有改变。这意味着容器不包括元素，“html、head 或 body”。希望这更清楚。

```
 protected void BuildXhtmlDocument(XContainer container)
    {
        XElement headElement = new XElement("head");
        XElement bodyElement = new XElement("body", container);
        container.ReplaceWith(new XElement("html", headElement, bodyElement));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:23:06.483

为我工作。例如：

```
using System;
using System.Xml.Linq;

public class Test 
{
    static void Main() 
    {
        XDocument doc = new XDocument();
        doc.Add(new XElement("foo", new XElement("bar")));
        Console.WriteLine("Before:");
        Console.WriteLine(doc);
        Console.WriteLine();

        XContainer container = doc.Root;
        XElement headElement = new XElement("head");
        XElement bodyElement = new XElement("body", container);
        container.ReplaceWith(new XElement("html", headElement, bodyElement));
        Console.WriteLine("After:");
        Console.WriteLine(doc);
    }
} 
```

输出：

```
Before:
<foo>
  <bar />
</foo>

After:
<html>
  <head />
  <body>
    <foo>
      <bar />
    </foo>
  </body>
</html> 
```

看起来它的行为很完美。（这*恰好*是文档的根元素，但不一定是。）

现在，为了真正能够为您提供帮助，我们需要知道您尝试执行的操作与上述内容有何不同 - 或者如果这*就是*您尝试执行的操作，我们将不得不看到差异在我的代码和你的代码之间......

# sql - 使用两个单独的表按类别查找最大值

> ID：13483879
> 
> 赞同：1
> 
> 时间：2012-11-20T23:17:01.873
> 
> 标签：sql

基本上我正在做一个电影租赁公司的数据库。我需要能够给出比其类别中的任何其他电影赚更多钱的电影的名称。

目前，我有一个产品表和租赁表。

```
Product – 
Attributes: (Product_ID, Product_Title, Rating, Release_Date, Genre, Length_of_Movie, Director_Name, Key_Actor, Num_Copies)
PK – Product_ID

Rental – 
Attributes: (Rental_ID, Member_ID, Product_ID, Date_Rented, Date_Returned)
PK – Rental_ID
FK – Member_ID, Product ID 
```

每个租金的价值为 1.00 美元。我能够获得所有租金的收入，但我很难按类型或类别获得它。我通过这个查询获得了整体收入：

```
Select sum(count(Rental_ID) *1) as Revenue 
from Rental
Group by Rental_ID; 
```

* ***每次租金为 1.00 美元，因此只需计算创建唯一租金编号的次数并将其乘以固定费用，这是一个简单的计算。

我现在需要将其分解，并为每个流派或类别分配最高收入者。我完全被难住了......任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:58:58.647

我没有对此进行测试，但是：

我会创建一个视图来像这样获得每个产品的收入

```
Create View RevenuePerProduct As
Select
  r.Product_ID,
  Count(*) As Revenue -- as $1/rental we can just count
From
  Rental r
Group By
  r.Product_ID 
```

要按流派获得最大收益，您可以使用该视图，我将创建另一个视图，称为 MaxRevenueByGenre。

```
Create View MaxRevenueByGenre As
Select
  p.Genre,
  Max(rpp.Revenue) As MaxByGenre
From 
  RevenuePerProduct rpp
    Inner Join
  Product p
    On rpp.Product_ID = p.Product_ID
Group By
  p.Genre 
```

要获得每种类型收入最高的产品（或产品）有点棘手，因为您需要两次参考收入部分。您会注意到两个视图都被使用了。

```
Select
  best.Genre,
  best.ProductTitle,
  rpp.Revenue
From
  Product best
    Inner Join
  RevenuePerProduct rpp
    On best.Product_ID = rpp.Product_ID
    Inner Join 
  MaxRevenueByGenre mpg
    On best.Genre = mpg.Genre And rpp.Revenue = mpg.MaxByGenre 
```

如果每个流派与最高收入者并列，这将为每个流派产生多个结果。

如果您愿意，可以通过在括号内替换视图的 select 语句来解决没有视图的问题。

# objective-c - 不了解 cocos2d 的内存管理

> ID：13483882
> 
> 赞同：1
> 
> 时间：2012-11-20T23:17:29.717
> 
> 标签：objective-c, ios, xcode, memory, cocos2d-iphone

我在 NSAutoReleasePool 下分配了一些 ccrepeatforevers。当我排空池时，我没有取回分配的内存。谁能解释这段代码有什么问题以及如何恢复分配的内存？在函数“initPlayerAnimations”中，变量“a”跟踪内存，如该函数中的注释所示。

```
-(void) initPlayerAnimations
{
    if (!playerSpriteDirty) return;
    playerSpriteDirty = false;

    double a = [CCDirector getAvailableMegaBytes];
    // a = 32 megabytes approximately

    NSAutoreleasePool *pool;
    pool = [[NSAutoreleasePool alloc] init];

[self wipeAnimations];

    NSString *aString;
    aString = @"YHUMANS";
    [walkAnimations addObject:[self getARepeatForeverFor:aString With:15 AndDelay:mainDelay/15]];
    aString = @"YHUMANE";
    [walkAnimations addObject:[self getARepeatForeverFor:aString With:15 AndDelay:mainDelay/15]];
    aString = @"YHUMANNE";
    [walkAnimations addObject:[self getARepeatForeverFor:aString With:15 AndDelay:mainDelay/15]];
    aString = @"YHUMANN";
    [walkAnimations addObject:[self getARepeatForeverFor:aString With:15 AndDelay:mainDelay/15]];
    aString = @"YHUMANSE";
    [walkAnimations addObject:[self getARepeatForeverFor:aString With:15 AndDelay:mainDelay/15]];

    aString = @"YHUMANSI";
    [idleAnimations addObject:[self getARepeatForeverFor:aString With:25 AndDelay:mainDelay/10]];
    aString = @"YHUMANEI";
    [idleAnimations addObject:[self getARepeatForeverFor:aString With:25 AndDelay:mainDelay/10]];
    aString = @"YHUMANNEI";
    [idleAnimations addObject:[self getARepeatForeverFor:aString With:25 AndDelay:mainDelay/10]];
    aString = @"YHUMANNI";
    [idleAnimations addObject:[self getARepeatForeverFor:aString With:25 AndDelay:mainDelay/10]];
    aString = @"YHUMANSEI";
    [idleAnimations addObject:[self getARepeatForeverFor:aString With:25 AndDelay:mainDelay/10]];

    a = [CCDirector getAvailableMegaBytes];
    // a = 3 megabytes approximately

    [self wipeAnimations];

    [pool drain];

    a = [CCDirector getAvailableMegaBytes];
    // a = 5 megabytes approximately; where is the rest of memory?
}

-(CCAnimation*) animationWithFile2:(NSString*)name
                   frameCount:(int)frameCount
                        delay:(float)delay
{
    NSMutableArray* frames = [NSMutableArray arrayWithCapacity:frameCount];
    for (int i = 1; i < (1+frameCount); i++)
    {
        NSString* file = [NSString stringWithFormat:@"%@%i.PNG", name, i];
        CCTexture2D* texture = [self createPlayerSpriteFor:file];
        CGSize texSize = texture.contentSize;
        CGRect texRect = CGRectMake(0, 0, texSize.width, texSize.height);
        CCSpriteFrame* frame = [CCSpriteFrame frameWithTexture:texture rect:texRect];
        [frames addObject:frame];
    }
    return [CCAnimation animationWithFrames:frames delay:delay];
}

-(CCRepeatForever*) getARepeatForeverFor:(NSString*)aString With:(int)num AndDelay:(double)delay
{
    CCAnimation* anim =  [self animationWithFile2:aString
                                            frameCount:num
                                                 delay:delay];
    CCAnimate* animate = [CCAnimate actionWithAnimation:anim];
    CCRepeatForever* repeat = [CCRepeatForever actionWithAction:animate];

    return repeat;
}

-(void) wipeAnimations
{
    [walkAnimations removeAllObjects];
    [idleAnimations removeAllObjects];
}

-(CCTexture2D*) createPlayerSpriteFor:(NSString*)file
{
    CCSprite *aSprite = [[CCSprite alloc]initWithFile:file];
    aSprite.anchorPoint = ccp(0,0);

    NSArray *anArray = [file componentsSeparatedByString:@"."];
    NSString *aString = [anArray objectAtIndex:0];
    CCSprite *bSprite = NULL;

    if (thePlayer.mainHand) {
        aString = [aString stringByAppendingString:@"SWORD.PNG"];
        bSprite = [[CCSprite alloc]initWithFile:aString];
        bSprite.anchorPoint = ccp(0,0);
    }

   CCRenderTexture *rt = [[CCRenderTexture alloc]initWithWidth:aSprite.textureRect.size.width height:aSprite.textureRect.size.height pixelFormat:kCCTexture2DPixelFormat_Default];

   [rt begin];

   [aSprite visit];
   if (bSprite)
       [bSprite visit];

   [rt end];

   CCTexture2D *aTex = rt.sprite.texture;
   [aTex setAntiAliasTexParameters];

   [aSprite release];
   [bSprite release];

   return aTex;
} 
```

# python - 尝试使用正则表达式提取字符串 - Python

> ID：13483884
> 
> 赞同：2
> 
> 时间：2012-11-20T23:17:32.593
> 
> 标签：python, regex

我正在尝试使用正则表达式（re 模块）从 python 2.7 中的字符串中提取一部分。

我能得到的最好的是

```
res = "{{PakBusPort_somename} 11942 pakbus-port 1}\r\n{{Somename} 5436 CR800-series 2}"
p = re.compile('PakBusPort_')
m = p.findall( res ) 
```

这会给我“PakBusPort_”。但我也需要它给我“somename”部分。

基本上我需要以“PakBusPort_”开头的 { 和 } 之间的所有内容。我试过了

`p = re.compile('PakBusPort_.*}}')`

但没有结果。

我是一个正则表达式的菜鸟，所以任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:20:53.740

```
In [71]: p = re.compile(r'{PakBusPort_(.*?)}')

In [72]: p.findall(res)
Out[72]: ['somename'] 
```

如果您还需要包含`PakBusPort_`，请移动左括号：

```
In [73]: p = re.compile(r'{(PakBusPort_.*?)}')

In [74]: p.findall(res)
Out[74]: ['PakBusPort_somename'] 
```

需要问号才能使匹配成为*non-greedy*，这意味着它将在第一个停止`}`而不是匹配所有内容直到最后一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:22:15.783

你很接近，这应该会给你一个匹配你的正则表达式的元组列表：

```
res = '{{PakBusPort_somename} 11942 pakbus-port 1}\r\n{{Somename} 5436 CR800-series 2}'
p = re.compile('{(PakBusPort)_([^}]*)}')
m = p.findall( res )
print m

[('PakBusPort', 'somename')] 
```

# java - 如何在 jdbc postgresql 准备语句中多次使用相同的值

> ID：13483889
> 
> 赞同：2
> 
> 时间：2012-11-20T23:18:25.173
> 
> 标签：java, postgresql, jdbc

有没有办法在带有 jdbc postgresql 驱动程序的准备好的语句中多次使用相同的变量？

例如，我想使用以下语句，但每个问号具有相同的值：

```
PreparedStatement ps = 
    pg.prepareCall("SELECT * FROM mytable WHERE col1=? AND col2=? AND col3=?"); 
```

但不是输入三遍代码，例如：

```
ps.setInt(0,1);
ps.setInt(1,1);
ps.setInt(2,1); 
```

有没有办法在每个变量中简单地使用相同的值？我想到了类似于[pypostgresql](http://python.projects.pgfoundry.org/docs/1.0/driver.html#parameterized-statements)中的用法，可以简单地说`$1`用于每个字段。

```
"SELECT * FROM mytable WHERE col1=$1 AND col2=$1 AND col3=$1" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:25:28.923

据我所知，纯 JDBC 不支持命名查询参数。您可能会创建一个小函数来将值放在所有位置。否则，您正在考虑使用更重的东西，例如 Spring 或 JPA。

# jquery - 从 div 元素中删除内容

> ID：13483891
> 
> 赞同：0
> 
> 时间：2012-11-20T23:18:39.467
> 
> 标签：jquery

我正在尝试从 2 个 div 元素中删除内容而不删除 div 本身。

```
<div id='test'>

content I want to remove

    <div id='childDiv'>

      content I want to remove

   </div>

</div> 
```

我想保留 childDiv 和测试 div 但删除它们的内容。我怎么做？

`$('#test').empty()`也会删除`childDiv`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:20:19.710

如何存储 childDiv 然后清空父项，然后将内部子项放回去？

```
$('#test').html($('#childDiv').html()) // didn't quite work

// this clears both divs and leaves only the structure
$('#test').html($('#childDiv').html("")); 
```

jsFiddle，用 chrome 检查生成的黑线，检查。[http://jsfiddle.net/tbspn/](http://jsfiddle.net/tbspn/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:26:58.140

使用 `.contents()` 和`.filter()`功能将它们过滤掉..

```
$('div').each(function() {
    $(this).contents().filter(function() {
        return this.nodeType != 1
    }).remove();
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/3XjeE/)**

**[额外嵌套](http://jsfiddle.net/sushanth009/3XjeE/1/)**

`return this.nodeType != 1`将选择所有非元素类型节点并将它们从**DOM 中删除。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T23:29:40.087

这是 JavaScript 的方法：

```
document.getElementById('test').innerHTML = '';
document.getElementById('childDiv').innerHTML = ''; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T23:24:13.460

```
$('#test').html(''); 
```

也清除所有内部标记。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T23:24:36.353

这应该工作：

```
$('#test').text('');

$('#childDiv').text(''); 
```

# php - 在 10 个表中请求。表有不同的结构

> ID：13483892
> 
> 赞同：-4
> 
> 时间：2012-11-20T23:18:43.370
> 
> 标签：php, mysql, database

请建议我如何实施这样的事情？我有 10 个表 - 10 个不同类别的字典。所有表都有不同的结构。用户键入一个单词，然后需要显示所有表格的结果，并且您需要指定什么表格的结果是什么。抱歉机器翻译...

```
$tables = array("test_prefixvoc", 
                "test_prefixvoc_br",
                "test_prefixVoc_fraze",
                "test_prefixVoc_Gloss2",
                "test_prefixvoc_Lingvo",
                "test_prefixvoc_orfo",
                "test_prefixvoc_rb",
                "test_prefixvoc_sinonim",
                "test_prefixVoc_sinonim2",
                "test_prefixvoc_tolk");

$names = array('name', 'NAME', 'Name1', 'Name2', 'Name1', 
'name', 'name', 'Name1', 'Name1', 'NAME');

include 'DB.php';
$con = mysql_connect($host,$user,$pass);
$word =  $_GET["word"];

$array = array();
for($i=0; $i<count($tables); $i++) {
    $dbs = mysql_select_db($tables[$i], $con);
    mysql_query('SET NAMES utf8');  
    $result = mysql_query("SELECT * FROM $tables[$i] WHERE    $names[$i]='$word'");          //query
    $array[$i] = mysql_fetch_row($result);  

    mysql_close();  
}

echo json_encode($array); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:20:38.697

您需要对每个表进行特定查询，处理所有结果，并将处理后的消息显示给用户。

这就是没有标准化数据库结构的代价。

# .net - 如何具体检查SQL数据库是否已打开？- VB.NET 2012 MVC 4

> ID：13483893
> 
> 赞同：0
> 
> 时间：2012-11-20T23:18:46.463
> 
> 标签：.net, vb.net, asp.net-mvc-4

```
 Function SQLSelect() As ActionResult

    Dim theconnection As New SqlConnection("Data Source=(localdb);Database=test_drive_database;")
    Dim queryString As String = "SELECT * FROM ColorTable"
    Dim command As New SqlCommand(queryString)
    command.CommandTimeout = 15
    command.CommandType = CommandType.Text

    'Printing Out the SQL Result

    Return ViewData("command")

End Function 
```

我有一个空的 SQL 结果，没有错误消息。

调用上述函数的 URL 是：`http://localhost:1812/Home/SQLSelect`

问题是，有没有办法专门检查 SQL 数据库是否已打开？

**使用的工具：** *Visual Studio 2012、VB.NET MVC 4、Microsoft SQL Server Compact 4.0*

**注意：** *数据库名称为`test_drive_database`，数据库没有设置密码。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:03:36.833

您的代码中似乎有一些错误

如果您要连接到 Sql Server Compact，那么连接字符串应该是这样的

```
 Data Source=MyData.sdf;Persist Security Info=False; 
```

[请参阅连接字符串](http://www.connectionstrings.com/sql-server-2012)

然后要使用的对象是命名空间中的[SqlCeConnection](http://msdn.microsoft.com/en-us/library/system.data.sqlserverce.sqlceconnection%28v=VS.80%29.aspx)和[SqlCeCommand](http://msdn.microsoft.com/en-US/library/system.data.sqlserverce.sqlcecommand%28v=vs.80%29.aspx)

```
 System.Data.SqlServerCe 
```

另外两个问题是：您没有打开连接并且没有将连接与命令相关联

```
 theconnection.Open
  command.Connection = theconnection 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T00:34:34.173

正如史蒂夫所说，您需要调用`Open`SQLConnection 对象的方法来打开连接。

完成此操作后，您可以随时使用对象的`State`属性`SQLConnection`检查连接状态。

```
 Dim sConn As New SqlConnection(connectionString)
    If sConn.State = ConnectionState.Open Then
        Debug.Print("Your database connection is open")
    ElseIf sConn.State = ConnsectionState.Closed Then
        Debug.Print("Your database connection is closed")
    Else
        Debug.Print("Your database connection state: " & sConn.State.ToString)
    End If 
```

# ruby - 为什么我的 guard & spork setup 没有在 lib 中重新加载代码？

> ID：13483898
> 
> 赞同：0
> 
> 时间：2012-11-20T23:19:14.947
> 
> 标签：ruby, rspec, guard, spork

我正在使用带警卫的spork。它在更改时正确地重新加载规范和项目代码。但它不会重新加载 lib 中的代码。如果我更改 lib 中的代码，我必须重新启动警卫。更奇怪的是，guard 识别出正在更改的代码文件并重新运行正确的规范。但是，该代码不会重新加载。

（老实说，我什至不确定系统的哪一层负责将代码重新加载到 spork 中......没有重新加载 spork）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T14:49:39.263

可能是您的代码在 Spork 的 prefork 之前加载。您是否尝试[在诊断模式下使用 Spork](https://github.com/sporkrb/spork#diagnostic-mode)来查看代码何时加载？

```
spork --diagnose | less 
```

# javascript - JSON.stringify 看似缩写的值

> ID：13483899
> 
> 赞同：1
> 
> 时间：2012-11-20T23:19:18.377
> 
> 标签：javascript, jquery, json

我正在尝试将 javascript 数组转换为 json 字符串以存储在我的数据库中，该数据库将坐标等绘制到 html5 画布元素上。

我的问题是，对于某些值，它们似乎被 JSON.stringify 函数缩写或其他东西。例如，我有一堆看起来像这样的数据：

```
[340,154,"dragstart",6,"db3733"] 
```

但有时，这会发生在某些值上（通常当我“字符串化”大量数据时）：

```
[311,...6,"db3733"] 
```

为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T00:20:36.670

`console.log`（等）在检查对象时经常显示省略号而不是很长的字符串或数组，但通常您可以扩展它们（通过单击`+`或其他方式）。

# java - 如何在 JBoss 中以正确的顺序部署 OSGi 包

> ID：13483900
> 
> 赞同：0
> 
> 时间：2012-11-20T23:19:20.663
> 
> 标签：java, deployment, jboss, osgi, jboss7.x

我试图了解如何使用 OSGi 和 JBoss AS

我尝试部署树包：b1、b2。b3。我复制了 bundles 目录**jboss-as-7.1.1.Final/standalone/deployments**。然后我开始了 JBoss。以不正确的顺序部署的捆绑包。据我了解，我应该为此制作个人资料。但是我不明白怎么写。现在我认为我应该修改文件**standalone.xml**并添加我的包的描述。

你能帮我正确部署捆绑包吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T04:46:21.597

我认为由于捆绑 b1、b2 和 b3 之间的服务依赖关系，您需要捆绑启动顺序。在 OSGi 中，要管理服务依赖关系，您可以使用[动态服务](http://www.eclipsezone.com/eclipse/forums/t91059.rhtml)或[声明式服务](http://www.eclipsezone.com/eclipse/forums/t96740.html)。希望这可以帮助你。

# .net - 文件访问错误 - 从文件读取时已在使用 (vb.NET 2.0)

> ID：13483903
> 
> 赞同：0
> 
> 时间：2012-11-20T23:19:24.860
> 
> 标签：.net, file-io

使用：

```
Dim fileStream as System.IO.FileStream = System.IO.File.Open(filename, FileMode.Open) 
```

与（见行尾）相反：

```
Dim fileStream as System.IO.FileStream = System.IO.File.Open(filename, FileMode.Open, FileAccess.Read) 
```

在

```
Dim fileStream as System.IO.FileStream = System.IO.File.Open(filename, FileMode.Open)
Dim data(fileStream.length) as Byte
fileStream.read(data, 0, fileStream.length)
fileStream.close() 
```

从文件异常读取时，添加`FileAccess.Read`标志会停止遇到*已经在使用的情况吗？*

更好地 - 即使在其他地方打开，您也可以以只读模式访问吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-26T10:48:13.150

如果您没有明确指定访问权限，`FileAccess.[Value]`则该`System.IO.File.Open(...)`函数默认为读/写，从而引发错误。

请参阅：http: [//msdn.microsoft.com/en-us/library/system.io.file.open.aspx](http://msdn.microsoft.com/en-us/library/system.io.file.open.aspx)

# ios - 当应用程序处于后台时，iOS 会收到媒体播放器通知

> ID：13483908
> 
> 赞同：4
> 
> 时间：2012-11-20T23:19:40.837
> 
> 标签：ios, xcode, background-process, nsnotifications, mpmusicplayercontroller

可能是一个简单的问题 - iOS 应用程序进入后台后能否继续接收媒体播放器通知 [NSNotifications]（即 MPMusicPlayerControllerNowPlayingItemDidChangeNotification）？

我专门使用 iPodMusicPlayer 在我的主要应用程序功能上播放歌曲，并且我喜欢在应用程序进入后台模式后在此通知下执行代码。

不要求代码；只是正确方向的一点：背景媒体通知；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T15:13:05.350

我做了一些检查，因为我需要同样的。

不幸的是，我看到您的应用在后台时没有收到通知。

但是，我意识到一旦恢复它确实会收到整个通知队列。问题是通知是一起收到的，给你没有关于他们被解雇的时间和日期的信息。

当然，由于您一次收到所有内容，即使您尝试在 MPMusicPlayerControllerNowPlayingItemDidChangeNotification 之后保存 nowPlayingItem，当您的应用再次激活时，您也只会看到当前项目，仅此而已。不幸的是，我认为我们不能再做任何事情了，因为 Apple doc 也说

> 通知没有 userInfo 字典

这意味着您无法从通知中获取任何信息。

# java - 重定向到所有客户端中的一个页面（每个客户端都是一个 SessionScoped ManagedBean）

> ID：13483918
> 
> 赞同：0
> 
> 时间：2012-11-20T23:20:24.367
> 
> 标签：java, html, ajax, jsf, jsf-2

我有一个包含多个用户（客户端 1，客户端 2，...）的页面，我想按下按钮“Salir de reunion”（按钮 1）将我重定向到主页（[http://localhost:8080/FasMe /faces](http://localhost:8080/FasMe/faces) / Public / Inicio.xhtml) 在所有客户端上。

每个客户端都是一个 SessionScoped ManagedBean。

![在此处输入图像描述](../Images/0dfbd348a936d1dac6eea9b137e055dd.png)

我只会被重定向到按下按钮的用户（客户端）的主页（/Public/Inicio.xhtml）。我想在所有客户端（浏览器）上进行重定向。我该怎么办？

**ReunionActiva.xhtml**

```
 <h:panelGrid id="reunionPanel" columns="2" >
            <h:commandButton value="Salir de Reunion" styleClass="btn" action="#{reunionBean.salirReunion}"  ></h:commandButton>                
    </h:panelGrid> 
```

我的按钮“退出会议”的业务逻辑是：

**ReunionManagedBean.java** @ManagedBean(name="usuarioBean")

```
public String salirReunion(){

    Cuenta ctaCoordinador=participanteF.getCuentaReunion(reu, reuF.getCoordinadorReunion(reu.getIdReunion()));
    Cuenta ctaParticipante=ctaF.getCuentaByUsuario(usuarioActualBean.getCurrent(), ctaCoordinador.getServidorTareas());

    // If user is ADMIN then I want to delete all user of meeting and close de Meeting
    if(ctaCoordinador.getId().equals(ctaParticipante.getId())){
        Calendar cal = Calendar.getInstance();
        reu.setFechaFin(cal.getTime());
        reu.setEstado("Cerrada"); // It´s meaning setStatus CLOSE
        reuF.modificacionReunion(reu);

        List<CuentaHasReunion> p=participanteF.getAllParticipantes(reu);
        for (Object element : p) {
            CuentaHasReunion part= (CuentaHasReunion) element;
            participanteF.bajaParticipante(part); //Here I delete all user from meeting
            // Here is where I need to do the redirect to all Clients (Client1 , Client2)
         }
        ReunionSingleton.eliminarReunionActiva(reu);
    }
    // If user isn't ADMIN then I only delete user who click the button "salir reunion"
    else{
        participanteF.bajaParticipante(participanteF.getParticipante(ctaParticipante, reu));

    }

    return "/Public/Reunion.xhtml?faces-redirect=true";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:09:14.763

看看[ICEfaces Push](http://www.icesoft.org/java/projects/ICEfaces/ajax-push.jsf)（似乎是第一个使用这个的孩子）和 [PrimeFaces Push](http://www.primefaces.org/showcase/push/index.jsf)。通常网络是基于请求的，所以每个客户端都需要请求刷新。我相信这些允许客户端通过 ajax 定期询问服务器上是否有任何有趣的请求数据包。如果服务器说是，客户端然后说更新我。无论如何，我认为这就是您可能正在寻找的。

如果你需要更同步的东西，你可能需要使用网络套接字或 RMI 来实现一些东西，也许通过一个小程序。

# algorithm - 双向 Dijkstras 和 A* 算法

> ID：13483926
> 
> 赞同：6
> 
> 时间：2012-11-20T23:21:30.950
> 
> 标签：algorithm, graph, hadoop, mapreduce, graph-algorithm

我想在 MapReduce 中实现 BiDirectional Djikstras 和 A* 算法。我已经在 MapReduce 中完成了 Djikstras 的实现。我想知道是否有人遇到过相同的实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T02:29:36.030

几个链接可以帮助：

*   [Dijkstra 算法的 Hadoop MapReduce 解决方案](http://famousphil.com/blog/2011/06/a-hadoop-mapreduce-solution-to-dijkstra%E2%80%99s-algorithm/)
*   [迭代 MapReduce 和计数器](http://hadooptutorial.wikispaces.com/Iterative+MapReduce+and+Counters)

您还可以查看[Apache Giraph](http://incubator.apache.org/giraph/)用于执行大规模图形处理任务。

*   [Giraph 最短路径示例](https://cwiki.apache.org/confluence/display/GIRAPH/Shortest+Paths+Example)

# python - TideSDK 和 Python 中的长处理循环

> ID：13483928
> 
> 赞同：0
> 
> 时间：2012-11-20T23:21:48.047
> 
> 标签：python, event-loop, tidesdk

有没有办法在 Python 中进行长时间的处理循环而不用 TideSDK 冻结 GUI？或者我只需要使用线程......

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:35:48.823

TideSDK 这里并没有什么特别之处——这是任何围绕事件循环构建的程序的普遍问题，这意味着几乎所有的 GUI 应用程序和网络服务器等等。

共有三种标准解决方案：

1.  将长任务分解成一堆小任务，每个小任务都安排下一个运行。

2.  每隔一段时间让任务回调到事件循环。

3.  并行运行任务。

对于第一个解决方案，大多数基于事件的框架都有类似`doLater(func)`or的方法`setTimeout(func, 0)`。如果没有，他们至少必须有一种将消息发布到事件循环队列的方法，并且您可以很容易地`doLater`围绕它构建一个。这种 API 在类 C 语言中使用起来可能很糟糕，并且在 JS 中有点令人讨厌，只是因为奇怪的 this/范围规则，但在 Python 和大多数其他动态语言中它几乎是无痛的。

由于 TideSDK 是围绕浏览器 JS 引擎构建的，它几乎肯定会提供第一个解决方案。

第二种解决方案仅对围绕协作线程或显式协程构建的框架才有意义。然而，一些传统的单线程框架，如经典 Mac（以及因此，现代 Win32 和一些跨平台框架，如 wxWindows）使用它来运行后台作业。

第一个问题是你必须小心处理重入（至少`wx`有`SafeYield`一点帮助），否则你可能会遇到许多与线程相同类型的问题——或者更糟糕的是，一切似乎都正常，除了在大量使用下，您偶尔会因无限递归而导致堆栈崩溃。另一个问题是，它只有在一次只有一个繁重的后台任务时才能真正发挥作用，因为它不能很好地工作

如果你的框架有办法做到这一点，它会有一个类似`yieldToOtherTasks`or的函数`processNextEvent`，你所要做的就是确保每隔一段时间调用一次。（但是，如果还有`doLater`，则应首先考虑。）如果没有这样的方法，则此解决方案不适合您的框架。

`threading.Thread`第三种解决方案是通过或分拆任务`multiprocessing.Process`。

这种并行性的问题在于，您必须想出某种方法来安全地发出信号，并安全地共享数据。一些事件循环框架具有线程安全的“doLater”或“postEvent”方法，如果您需要的唯一信号是“任务完成”并且您需要共享的唯一数据是任务启动参数和返回值，那么一切都是简单的。但一旦这还不够，事情就会变得非常复杂。

此外，如果您有数百个长时间运行的任务要运行，您可能不希望每个任务都有一个线程或进程。事实上，你可能想要一个固定大小的线程或进程池，然后你必须将你的任务分解成足够小的子任务，这样它们就不会互相饿死，所以实际上你正在做所有无论如何，解决方案＃1的工作。

However, there are cases where threads or processes are the simplest solution.

# jquery - 表单元素仅在 Internet Explorer 8 上的 Jquery Fancybox 中不显示

> ID：13483929
> 
> 赞同：1
> 
> 时间：2012-11-20T23:21:52.713
> 
> 标签：jquery, iframe, internet-explorer-8, fancybox, modal-dialog

我正在使用 Fancybox（使用 Jquery）实现一个模态样式的登录窗口。模式框在除 Internet Explorer 8 之外的所有浏览器中都显示得很好。

在 Internet Explorer 8 中，表单元素（标签、按钮和字段）全部丢失。我怀疑这与 z-index 定位有关，但我无法弄清楚。

**有问题的页面位于：[http](http://d2-sandbox.parature.com/ics/support/default.asp?deptID=8210) ://d2-sandbox.parature.com/ics/support/default.asp?deptID=8210 。**

单击右上角的**登录**按钮以查看问题。就像我说的，IE8 是唯一有问题的浏览器。

这是我对 Fancybox 的呼吁：

```
<script type="text/javascript">
$(document).ready(function() {
    $(".fancybox").fancybox({
            scrolling : 'no',
            width : '500',
            height : '286',
            closeEffect: 'elastic',
            openEffect: 'fade'
        });}); 
```

下面是登录按钮的代码：

```
a class="fancybox fancybox.iframe" href="http://www.chrishallahan.com/parature-small.html"> 
```

...这是我的登录表单中的代码，它是一个 iframe：

```
<body>
<h1><span id="hide">suppport.kent.edu - Online Technology Help Center at Kent State University</span></h1>
<div id="login-form">
<form name="loginForm"  method="post" action="https://parature.kent.edu/default.aspx" target="_parent">
<label class="label">User Name:</label><input name="userid" class="searchbox" value="blank" size="30" type="text" /> <span class="email">@kent.edu</span><br />
<label class="label">Password:</label><input name="password" class="searchbox" value="blank" size="30" type="password" /><a class="forgot" href="https://login.kent.edu/ForgotPassword.aspx" target="_parent">Forgot Your Password?</a><br/>
<input type="submit" name="Button1" value="Log In" id="Button1" />
</form>
</div>
<div id="footer"><div id="text">Please log in with your FlashLine user name and password.</div></div> 
```

任何输入将不胜感激！

# objective-c - 将 NSCell 设置为 NSUinteger 值时避免隐式转换警告的正确方法？

> ID：13483930
> 
> 赞同：1
> 
> 时间：2012-11-20T23:21:54.267
> 
> 标签：objective-c, cocoa, type-conversion

我正在将一些旧的 Cocoa 代码转换为当前的 Cocoa 系统。

我有一个窗口，上面有一些单元格。它们是 NSCell 子类。

我想将单元格的值设置为`length`结构的值`NSRange`。所以我的代码如下所示：

```
[numPagesCell setIntValue:range.length]; 
```

我得到的问题是它`NSRange.length`是一个`NSUinteger`，并且该`setIntValue:`方法需要一个`unsigned long`. 我宁愿不在这里做演员，因为这是我经常做的事情。处理此问题的适当方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T02:17:39.597

只需使用 setIntegerValue: 而不是 setIntValue:

# scala - 功能风格提前退出深度优先递归

> ID：13483931
> 
> 赞同：9
> 
> 时间：2012-11-20T23:22:00.010
> 
> 标签：scala, recursion, functional-programming, depth-first-search

我有一个关于以函数式风格编写递归算法的问题。我将在这里使用 Scala 作为示例，但这个问题适用于任何函数式语言。

我正在对*n*叉树进行深度优先枚举，其中每个节点都有一个标签和可变数量的子节点。这是一个打印叶节点标签的简单实现。

```
case class Node[T](label:T, ns:Node[T]*)
def dfs[T](r:Node[T]):Seq[T] = {
    if (r.ns.isEmpty) Seq(r.label) else for (n<-r.ns;c<-dfs(n)) yield c
}
val r = Node('a, Node('b, Node('d), Node('e, Node('f))), Node('c))
dfs(r) // returns Seq[Symbol] = ArrayBuffer('d, 'f, 'c) 
```

现在说，有时我希望能够通过抛出异常来放弃解析超大树。这在功能语言中可能吗？具体来说，这可能不使用可变状态吗？这似乎取决于您所说的“超大”是什么意思。这是该算法的纯函数版本，当它尝试处理深度为 3 或更大的树时会引发异常。

```
def dfs[T](r:Node[T], d:Int = 0):Seq[T] = {
    require(d < 3)
    if (r.ns.isEmpty) Seq(r.label) else for (n<-r.ns;c<-dfs(n, d+1)) yield c
} 
```

但是，如果一棵树因为太宽而不是太深而变得过大怎么办？*具体来说，如果我想在第n*次递归调用函数时抛出异常，`dfs()`而不管递归有多深，该怎么办？我能看到如何做到这一点的唯一方法是拥有一个可变计数器，每次调用都会递增。如果没有可变变量，我看不到如何做到这一点。

我是函数式编程的新手，并且一直在假设你可以用可变状态做的任何事情都可以在没有的情况下完成，但我在这里看不到答案。我唯一能想到的就是编写一个版本，`dfs()`以深度优先的顺序返回树中所有节点的视图。

```
dfs[T](r:Node[T]):TraversableView[T, Traversable[_]] = ... 
```

然后我可以通过说来施加我的限制`dfs(r).take(n)`，但我不知道如何编写这个函数。在 Python 中，我只是在`yield`访问节点时创建一个生成器，但我不知道如何在 Scala 中实现相同的效果。（Scala 等效于 Python 样式的`yield`语句似乎是作为参数传入的访问者函数，但我不知道如何编写其中的一个来生成序列视图。）

**编辑**接近答案。

`Stream`这是一个以深度优先顺序返回节点的函数。

```
def dfs[T](r: Node[T]): Stream[Node[T]] = {
    (r #:: Stream.empty /: r.ns)(_ ++ dfs(_))
} 
```

差不多就是这样。唯一的问题是`Stream`memoizes所有结果，这很浪费内存。我想要一个可遍历的视图。以下是想法，但没有编译。

```
def dfs[T](r: Node[T]): TraversableView[Node[T], Traversable[Node[T]]] = {
    (Traversable(r).view /: r.ns)(_ ++ dfs(_))
} 
```

它为操作员提供了“found `TraversableView[Node[T], Traversable[Node[T]]]`, required`TraversableView[Node[T], Traversable[_]]`错误`++`。如果我将返回类型更改为`TraversableView[Node[T], Traversable[_]]`，我会在“found”和“required”子句切换时遇到同样的问题。所以有一些魔法类型的变体咒语我没有点燃然而，但这已经很接近了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T00:40:53.030

可以做到：您只需要编写一些代码以您想要的方式实际迭代子项（而不是依赖于`for`）。

更明确地说，您必须编写代码来遍历子列表并检查“深度”是否超过了您的阈值。这是一些`Haskell`代码（我真的很抱歉，我不流利地使用 Scala，但这可能很容易音译）：

[http://ideone.com/O5gvhM](http://ideone.com/O5gvhM)

在这段代码中，我基本上将`for`循环替换为显式递归版本。如果访问节点的数量已经太深（即`limit`不是正数），这允许我停止递归。当我递归检查下一个孩子时，我减去前一个孩子访问的节点数，`dfs`并将其设置为下一个孩子的限制。

函数式语言很有趣，但它们是命令式编程的巨大飞跃。它确实让您关注*状态*的概念，因为当您使用函数时，所有这些都在参数中非常明确。

**编辑：**再解释一下。

我最终从“仅打印叶节点”（这是 OP 的原始算法）转换为“打印所有节点”。这使我能够通过结果列表的长度访问子调用访问的节点数。如果要坚持使用叶节点，则必须携带已经访问过的节点数：

[http://ideone.com/cIQrna](http://ideone.com/cIQrna)

**再次编辑**为了澄清这个答案，我将所有的 Haskell 代码放在 ideone 上，并且我已经将我的 Haskell 代码音译为 Scala，所以这可以留在这里作为问题的明确答案：

```
case class Node[T](label:T, children:Seq[Node[T]])

case class TraversalResult[T](num_visited:Int, labels:Seq[T])

def dfs[T](node:Node[T], limit:Int):TraversalResult[T] =
    limit match {
        case 0     => TraversalResult(0, Nil)
        case limit => 
            node.children match {
                case Nil => TraversalResult(1, List(node.label))
                case children => {
                    val result = traverse(node.children, limit - 1)
                    TraversalResult(result.num_visited + 1, result.labels)
                }
            }
    }

def traverse[T](children:Seq[Node[T]], limit:Int):TraversalResult[T] =
    limit match {
        case 0     => TraversalResult(0, Nil)
        case limit =>
            children match {
                case Nil => TraversalResult(0, Nil)
                case first :: rest => {
                    val trav_first = dfs(first, limit)
                    val trav_rest = 
                        traverse(rest, limit - trav_first.num_visited)
                    TraversalResult(
                        trav_first.num_visited + trav_rest.num_visited,
                        trav_first.labels ++ trav_rest.labels
                    )
                }
            }
    }

val n = Node(0, List(
    Node(1, List(Node(2, Nil), Node(3, Nil))),
    Node(4, List(Node(5, List(Node(6, Nil))))),
    Node(7, Nil)
))
for (i <- 1 to 8)
    println(dfs(n, i)) 
```

输出：

```
TraversalResult(1,List())
TraversalResult(2,List())
TraversalResult(3,List(2))
TraversalResult(4,List(2, 3))
TraversalResult(5,List(2, 3))
TraversalResult(6,List(2, 3))
TraversalResult(7,List(2, 3, 6))
TraversalResult(8,List(2, 3, 6, 7)) 
```

PS这是我第一次尝试Scala，所以上面可能包含一些可怕的非惯用代码。对不起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T00:16:41.610

您可以通过传递索引或获取尾部将广度转换为深度：

```
def suml(xs: List[Int], total: Int = 0) = xs match {
  case Nil => total
  case x :: rest => suml(rest, total+x)
}

def suma(xs: Array[Int], from: Int = 0, total: Int = 0) = {
  if (from >= xs.length) total
  else suma(xs, from+1, total + xs(from))
} 
```

在后一种情况下，如果你愿意，你已经有一些东西可以限制你的广度；在前者中，只需添加一个`width`或类似的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T19:36:23.347

下面实现了对树中节点的惰性深度优先搜索。

```
import collection.TraversableView
case class Node[T](label: T, ns: Node[T]*)
def dfs[T](r: Node[T]): TraversableView[Node[T], Traversable[Node[T]]] =
  (Traversable[Node[T]](r).view /: r.ns) {
    (a, b) => (a ++ dfs(b)).asInstanceOf[TraversableView[Node[T], Traversable[Node[T]]]]
  } 
```

这将按深度优先顺序打印所有节点的标签。

```
val r = Node('a, Node('b, Node('d), Node('e, Node('f))), Node('c))
dfs(r).map(_.label).force
// returns Traversable[Symbol] = List('a, 'b, 'd, 'e, 'f, 'c) 
```

这做同样的事情，在访问了 3 个节点后退出。

```
dfs(r).take(3).map(_.label).force
// returns Traversable[Symbol] = List('a, 'b, 'd) 
```

如果您只想要叶节点，您可以使用`filter`，依此类推。

请注意，`dfs`函数的 fold 子句需要显式`asInstanceOf`强制转换。请参阅[“对 Traversable 视图执行 foldLeft 时 Scala 中的类型变化错误”](https://stackoverflow.com/questions/13499785/type-variance-error-in-scala-when-doing-a-foldleft-over-traversable-views)，以讨论需要这样做的 Scala 类型问题。

# javascript - JavaScript / jQuery 毕业去饱和 HEX 颜色

> ID：13483933
> 
> 赞同：0
> 
> 时间：2012-11-20T23:22:15.413
> 
> 标签：javascript, jquery, css, colors, hex

从（比如说）#ff0011 开始，我想为页面中的每个元素 div 缩放背景颜色。

结果应该是这样的：

```
 <div class="div-1"></div> // background-color:#ff0011;
    <div class="div-2"></div> // background-color:#ff0011 -0.2% saturation;
    <div class="div-3"></div> // background-color:#ff0011 -0.3% saturation;
    <div class="div-4"></div> // background-color:#ff0011 -0.4% saturation;
    <div class="div-5"></div> // background-color:#ff0011 -0.5% saturation; 
```

希望这个例子很清楚，我真的不知道从哪里开始这样做，所以任何链接教程都会非常感激。

编辑：我说的是毕业 DESATURATE 颜色

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:29:47.930

HTML：

```
<div class="div-1 shaded"></div> // background-color:#ff0011;
<div class="div-2 shaded"></div> // background-color:#ff0011 0.2% lighter;
<div class="div-3 shaded"></div> // background-color:#ff0011 0.3% lighter;
<div class="div-4 shaded"></div> // background-color:#ff0011 0.4% lighter;
<div class="div-5 shaded"></div> // background-color:#ff0011 0.5% lighter; 
```

JS：

```
$('.shaded').each(function(i){
    $(this).css('opacity', (1 - i/10));
}); 
```

这是一个由 Sushanth[演示的小提琴](http://jsfiddle.net/sushanth009/YxFcy)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:38:54.223

使用 CSS3 hsl 是一种选择吗？您可以轻松（和真实）控制来计算较浅或较深的颜色。 [https://developer.mozilla.org/en-US/docs/CSS/color_value#hsl](https://developer.mozilla.org/en-US/docs/CSS/color_value#hsl) ()

它不适用于 IE8 及更低版本，但在现代浏览器中得到广泛支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T08:56:30.617

好的，我找到了如何做到这一点，感谢你们所有人，但这是我需要的代码：

```
var i = 50;
    $.each($('div'),function(){
    $(this).css({'background-color':'hsl(145,37%,'+i+'%)'});
    i++
    }); 
```

感谢@KKetch，他给了我 css3 hsl() 示例！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T23:42:52.680

您可以使用 jQuery 或 Javascript 来使其正常工作..

**使用 Javascript**

```
var elems = document.getElementsByTagName('div');

for(var i =0;i< elems.length ; i++){
      var op = 1 - (i/10);
      var fil = 100 - (i * 10);
      elems[i].style.opacity = op;
     elems[i].style.filter = "alpha(opacity=" + fil + ")";
} 
```

HTML 和 CSS

```
<div class="div"></div>
<div class="div"></div> 
<div class="div"></div> 
<div class="div"></div> 
<div class="div"></div> ​

.div
{
    background-color: #ff0011;
    width:100px;
    height:50px;
    border : 1px solid green;
}​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/YxFcy/)**

​</p>

# asp.net - 自定义控件中的选定值在回发时消失

> ID：13483934
> 
> 赞同：1
> 
> 时间：2012-11-20T23:22:16.087
> 
> 标签：asp.net, postback, page-lifecycle

我有一个带有嵌套数据列表的 asp.NET Web 表单页面。内部数据列表包含一个自定义控件，其中包含一个下拉列表。自定义控件在页面标记中声明。所有控件都启用了 ViewsState。

所有数据绑定事件都有

```
if (!Page.IsPostback) 
```

周围的说法。

当外部数据列表触发它的 OnDataBound 事件时，我加载内部数据列表。

同样，当内部数据列表触发它的 OnDataBound 事件时，我会加载自定义控件。

自定义控件中的所有内容在加载时都正确绑定到实际数据，但是当我尝试保存更改时，用户控件中下拉列表的选定值已经消失。（也就是说，当我使用 SAVE 方法回帖时，我会检查下拉列表：它们存在，但未绑定。）

如何在我可以保存之前防止更改的值被解除绑定？

# c++ - 未正确处理用户输入

> ID：13483936
> 
> 赞同：0
> 
> 时间：2012-11-20T23:22:20.360
> 
> 标签：c++, user-input, cin, arrays

所以，我正在开发的这个程序并没有按照我想要的方式处理不正确的用户输入。用户应该只能输入一个 3 位数字，以便稍后在 HotelRoom 对象构造函数中使用。不幸的是，我的导师不允许在他的课堂上使用字符串对象（否则，我认为我不会有任何问题）。另外，我将 roomNumBuffer 传递给构造函数以创建一个 const char 指针。我目前正在使用 iostream、iomanip、string.h 和限制预处理器指令。尝试为 roomNumBuffer 输入太多字符后会出现此问题。以下屏幕截图显示了发生的情况： ![在此处输入图像描述](../Images/56daefc71e9c097cca4e95a6e07a568f.png)

此问题的相关代码如下：

```
cout << endl << "Please enter the 3-digit room number: ";
do {        //loop to check user input
    badInput = false;
    cin.width(4);
    cin >> roomNumBuffer;
    for(int x = 0; x < 3; x++) {
        if(!isdigit(roomNumBuffer[x])) {        //check all chars entered are digits
            badInput = true;
        }
    }
    if(badInput) {
        cout << endl << "You did not enter a valid room number. Please try again: ";
    }
    cin.get();      //Trying to dum- any extra chars the user might enter
} while(badInput);

for(;;) {   //Infinite loop broken when correct input obtained
    cin.get();      //Same as above
    cout << "Please enter the room capacity: ";
    if(cin >> roomCap) {
        break;
    } else {
        cout << "Please enter a valid integer" << endl;
        cin.clear();
        cin.ignore(numeric_limits<streamsize>::max(), '\n');
    }
}
for(;;) {   //Infinite loop broken when correct input obtained
    cout << "Please enter the nightly room rate: ";
    if(cin >> roomRt) {
        break;
    } else {
        cout << "Please enter a valid rate" << endl;
        cin.clear();
        cin.ignore(numeric_limits<streamsize>::max(), '\n');
    }
} 
```

任何想法将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:25:10.133

读取一个整数并测试它是否在所需的范围内：

```
int n;

if (!(std::cin >> n && n >= 100 && n < 1000))
{
    /* input error! */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:37:11.890

尽管 Kerrek SB 提供了一种解决问题的方法，但只是为了解释您的方法出现问题时的原因：可以成功读取整数数组。溪流状态良好，但您没有到达空间。也就是说，要使用您的方法，您还需要测试最后一个数字之后的字符，即流中的下一个字符，是某种空格：

```
if (std::isspace(std::cin.peek())) {
     // deal with funny input
} 
```

不过，第一个值的错误恢复似乎不太正确。您可能还希望`ignore()`所有字符直到行尾。

# php - 401 重定向神奇地导致 302 重定向

> ID：13483937
> 
> 赞同：5
> 
> 时间：2012-11-20T23:22:23.227
> 
> 标签：php, redirect, header, laravel

我正在使用`Redirect`该类将未登录的用户发送到登录页面，并带有**401**状态代码：

```
return Redirect::to('login', 401); 
```

这会发送正确的位置标头，但状态代码设置为**302**。

* * *

我一直追踪到基`Response`类

> laravel/vendor/Symfony/Component/HttpFoundation/Response.php

它正在调用：

```
$this->setStatusCode($status); 
```

使用正确的**401**代码。

* * *

我也尝试转储对象：

```
var_dump( Redirect::to('login', 401)->foundation ); 
```

我可以看到受保护的`statusCode`属性已正确设置为**401**。

* * *

尽管如此，生成的响应的 HTTP 状态代码仍设置为**302**。

是什么赋予了？我用错了吗？

* * *

**PS**我也在[Laravel 的论坛上发布了这个](http://forums.laravel.com/viewtopic.php?id=3579)，但无济于事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:40:56.663

这不是因为 laravel，你可以只用（windows 中的 php 5.4）重现它：

```
<?php
header("HTTP/1.1 401 Unauthorized");
header("Location: http://www.google.com"); 
```

看来php将其设置为302：

```
$ php-cgi "test.php"
Status: 302 Moved Temporarily
Location: http://www.google.com
Content-type: text/html; charset=UTF-8 
```

在 PHP 源代码 main/SAPI.C 中：

```
} else if (!STRCASECMP(header_line, "Location")) {
    if ((SG(sapi_headers).http_response_code < 300 ||
        SG(sapi_headers).http_response_code > 307) &&
        SG(sapi_headers).http_response_code != 201) {
        /* Return a Found Redirect if one is not already specified */
        if (http_response_code) { /* user specified redirect code */
            sapi_update_response_code(http_response_code TSRMLS_CC);
        } else if (SG(request_info).proto_num > 1000 && 
           SG(request_info).request_method && 
           strcmp(SG(request_info).request_method, "HEAD") &&
           strcmp(SG(request_info).request_method, "GET")) {
            sapi_update_response_code(303 TSRMLS_CC);
        } else {
            sapi_update_response_code(302 TSRMLS_CC);
        }
    } 
```

如您所见，当您`header()`使用时`"Location"`，http 状态码被修改为 302

如果你反过来做，你可以让它工作：

```
<?php
header("Location: http://www.google.com");
header("HTTP/1.1 401 Unauthorized"); 
```

这将给出：

```
$ php-cgi "test.php"
Status: 401 Unauthorized
Location: http://www.google.com
Content-type: text/html; charset=UTF-8 
```

但是laravel在设置状态后设置位置，所以状态无论如何都设置回302。但这是一个有争议的问题，即使您使用位置标头成功将状态设置为 401，浏览器也不会遵循重定向。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T23:41:05.713

浏览器不会让你这样做；您不能使用 401 重定向。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T00:18:17.120

我更进一步......直到`public function sendHeaders()`......`laravel/vendor/Symfony/Component/HttpFoundation/Response.php`它生成最终状态标题

```
 // status
    Header(sprintf('HTTP/%s %s %s', $this->version, $this->statusCode, $this->statusText)); 
```

...当然，它仍然是 401。

*然后*我恍然大悟。*您不能使用 401 重定向*，这是一个 ClientError。

（它也`isRedirect`会使同一`Response.php`文件中所述的测试失败。`mod_php`一旦您发送a，它将为您修复为302 `Location`（因为默认情况下状态为200，因此需要更新。PHP不检查它是否已经已更新为其他内容）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T20:12:24.743

正如其他人指出的那样，没有 401 重定向之类的东西。我迷上这个的原因是因为[我需要重定向非 AJAX 用户](https://stackoverflow.com/questions/13483937#comments-13484117)，但[AJAX 请求应该得到 401](http://www.bennadel.com/blog/2228-Some-Thoughts-On-Handling-401-Unauthorized-Errors-With-jQuery.htm)。

* * *

如果您发现自己处于类似情况，这就是我最终使用的：

```
return Request::ajax() ?
         Response::make('', 401, array('HTTP/1.1 401 Unauthorized')) :
         Redirect::to('login', 302); 
```

这使用 Laravel 处理标题的方法。

* * *

如果您使用的是普通 PHP，请使用以下命令：

```
$is_ajax_request = ! empty( $_SERVER['HTTP_X_REQUESTED_WITH'] ) && $_SERVER['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest';

$is_ajax_request ?
    header('HTTP/1.1 401 Unauthorized') :
    header('Location: http://site.com/login');

exit; 
```

# opencv - 通过修改 camshift 进行车辆跟踪

> ID：13483939
> 
> 赞同：2
> 
> 时间：2012-11-20T23:22:34.093
> 
> 标签：opencv

我在 camshift 的 openCV 示例文件中找到了这行代码，我想知道这是否是启动循环以跟踪对象的行？

```
int val = cvRound( cvGetReal1D(hist->bins,i)*histimg->height/255 ); 
```

另外，camshift 函数可以用于矩形对象而不是面吗？

# objective-c - 如何检测 UIBezierPath 是否与自身相交？

> ID：13483940
> 
> 赞同：1
> 
> 时间：2012-11-20T23:22:38.463
> 
> 标签：objective-c, ios, intersection, uibezierpath, cgpath

我有一个用户绘制的 UIBezierPath，我想知道它是否与自身相交。谁能指出我检测到这一点的好方向？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T05:24:12.310

你如何构建你的路径？它只是直线段的累积吗？如果是这样，您可以保留这些列表（与您的 UIBezierPath 平行，用于渲染），然后执行线交叉测试。但是，在幼稚的实现中它将是 O(N^2)。

# c++ - C++ 求职面试题？

> ID：13483942
> 
> 赞同：3
> 
> 时间：2012-11-20T23:23:05.413
> 
> 标签：c++

我期待一个 C++ 的工作面试，我应该期待什么样的问题？

我已经用 C 编程 5 年了。我知道 OOP 是什么，并且我已经阅读了一段时间。但很可能我会错过重要的细节，因为我没有在 C++ 上做任何真正的事情。

此致，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:25:31.800

您应该阅读“编程面试暴露 - 找到下一份工作的秘密”，这是一本非常好的编程面试书籍。

# flash - 如何使用 actionscript 3 读取/解析曲线调整 (*.acv) 文件

> ID：13483944
> 
> 赞同：3
> 
> 时间：2012-11-20T23:23:14.193
> 
> 标签：flash, parsing, image-processing, actionscript, photoshop

我有一个从 Photoshop 创建的 *.acv 文件，我很难弄清楚如何使用 AS3 在闪存中读取或解析这个文件。

我之前使用 Objective-C 和一个名为 GPUImage [https://github.com/BradLarson/GPUImage](https://github.com/BradLarson/GPUImage)的框架完成了它。这包含一个名为 GPUImageACVFile 的类，您在实例化它时传递 acv 文件的路径，它包含具有 rgb、红色、绿色和蓝色曲线点的数组，这是我在 flash 中尝试做的。

我找到了这个库[https://github.com/inspirit/GPUImage](https://github.com/inspirit/GPUImage)，我认为它是我上面提到的 Objective-C GPUImage 的移植版本，但我不太了解它。

经过进一步研究，我发现这个未回答的问题与我试图实现的目标相似[http://forums.adobe.com/thread/869447](http://forums.adobe.com/thread/869447)，不幸的是那里的回答没有帮助。

如有必要，或者如果有人认为它会有所帮助，我可以提供一个 acv 文件示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T21:20:41.227

.acv 是一个二进制文件（我认为格式可以在这里描述：http: [//www.adobe.com/devnet-apps/photoshop/fileformatashtml/](http://www.adobe.com/devnet-apps/photoshop/fileformatashtml/)）。您可以使用 URLLoader 和 ByteArray 加载和读取二进制文件。

# c++ - c ++附加到字符串

> ID：13483954
> 
> 赞同：0
> 
> 时间：2012-11-20T23:24:21.420
> 
> 标签：c++, string, for-loop, append

有没有一种简单的方法将整数附加到字符串？

我有一个这样的for循环：

```
for (int i = 0; i < text.length(); i++) {
  for (int g = 0; g < word.length(); g++) {
    if (text[i] == word[g]) {
      kodas.append(g);
    }
  }
} 
```

我需要得到相等的数组的索引，索引当然是整数类型。但是当我这样做时，我得到一个错误：

```
invalid conversion from ‘int’ to ‘const char*’ [-fpermissive]| 
```

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T23:28:59.157

如果您正在使用 std::strings，请使用 stringstream：`#include <sstream>`

```
#include <sstream>
using namespace std;
string oldString = "old";
int toAppend = 5;
stringstream ss(toAppend);
string newString = oldString + ss.str(); 
```

`newString`将会`"old5"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T23:28:28.863

**是**的。

例如，您可以：

*   使用`itoa`将整数转换为字符串的函数
*   像你想要的那样做你`kodas`的`ostringstream`和“写”到它`cout`：`kodas << g`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T23:28:43.530

最简单的是这样的：

```
if (kodas.empty()) { kodas += ' '; }
kodas += std::to_string(g); 
```

如果您没有 C++11，请`boost::lexical_cast<std::string>(g)`改用。

一切都失败了，你可以做这样可怕的事情：

```
kodas += static_cast<std::ostringstream&>(std::ostringstream() << g).str(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T23:28:54.697

itoa()，它的 into alpha 函数，应该可以帮助你。如果您愿意，sprintf 或 vsprintf 也可以使用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T23:29:11.273

在 C++ 中有几种将数字格式化为字符串的方法，包括[`sprintf()`](http://www.kernel.org/doc/man-pages/online/pages/man3/sprintf.3.html)、[`boost:lexical_cast()`](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_lexical_cast.html)等。请参阅[Manor Farm 的字符串格式化](http://www.gotw.ca/publications/mill19.htm)程序以获得很好的比较和其他建议。此外，C++11 有`std::to_string`. 你的编译器可能有也可能没有。

# java - 为我的客户类创建一个新文件

> ID：13483960
> 
> 赞同：0
> 
> 时间：2012-11-20T23:24:56.217
> 
> 标签：java

我对 java 和编码非常陌生，我还没有弄清楚如何为我的客户端类创建一个新文件。

这是我的错误：

> 类 TestRectangle 是公共的，应在名为 TestRectangle.java 的文件中声明

```
public class TestRectangle { 
```

这是我的第一堂课：

```
public class Rectangle1 { 
```

这是发生错误的地方：

```
public class TestRectangle {
    public static void main(String[] args) { 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:26:14.540

您是否将其保存在名为 TestRectangle.java 的文件中？当您创建一个`public`类时，Java 要求您的文件 (.java) 与该类具有相同的名称。

如果你愿意，你可以将你的类保存在同一个文件中——只要确保其中只有一个是`public`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T23:32:06.927

**Java**要求每个**文件**只有一个**公共类**。您有两个选择，要么制作两个单独的文件，分别称为**Rectangle1.java**和**TestRectangle1.java** ，要么使用**默认访问修饰符**制作**Rectangle1并将****文件**命名为**TestRectangle.java**

 ******## 选项1：

将**Rectange1**放在来自 TestRectangle的单独文件 (Rectangle1.java) 中

```
public class Rectangle1
{
} 
```

现在，制作一个名为 (TestRectangle.java) 的单独文件

```
public class TestRectangle {
    public static void main(String[] args) { 
```

## 选项2：

将此文件另存为**TestRectangle.java**

```
 public class TestRectangle {
        public static void main(String[] args) {
    }

     class Rectangle1 //observe that the access modifier is default(no-modifier) 
    {
    } 
```******

# nutch - Nutch 2.1 有哪些可用的数据库选项？

> ID：13483970
> 
> 赞同：1
> 
> 时间：2012-11-20T23:25:48.880
> 
> 标签：nutch

我正在尝试在一台 Windows 机器上测试 Nutch 2.1。以下命令死亡：

```
nutch crawl seeds -dir crawl -solr http://somehost:8983/solr -depth 2 -topN 2 
```

...有几个例外的回溯：

*   `java.net.ConnectionException: Connection refused`
*   `GoraException`
*   `SQLTransientConnectionException`
*   `org.hsqldb.HsqlException`

这与这篇文章的问题相同：[运行 Nutch 2 时出现连接被拒绝错误](https://stackoverflow.com/questions/12581492/connection-refused-error-when-running-nutch-2)

看起来 Nutch 2 想要已经安装了某种数据库，但是在我可以看到的（稀疏）文档中没有提到这一点。

生产环境最终将是一个 linux/Hadoop 集群，但目前我只是试图让一个简单的本地系统开箱即用。

那么简单的 Nutch 数据库有哪些选择呢？你如何告诉 Nutch 和 Gora 关于数据库的事情？一旦我们的 Hadoop 集群启动并运行，HBase 可能是一个很好的答案。然而; 与此同时，是否有一个简单的、甚至很慢的数据库可以在单个系统上进行初步探索？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T06:31:19.567

我已经尝试过使用 MYSQL 和 HBASE。

对于 MYSQL，此链接有助于消除大部分怪癖：[http ://nlp.solutions.asia/?p=180](http://nlp.solutions.asia/?p=180)

对于 HBASE，高于 0.90.x 的版本会导致问题（无效的主机值对）。我已经能够让它与 0.90.5 一起工作

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T21:04:49.733

Nutch 2.1 的数据库连接信息在 conf/gora.properties 文件中指定（应该已经看到）

# c - 编译稀疏 0.4.1

> ID：13483974
> 
> 赞同：0
> 
> 时间：2012-11-20T23:26:14.927
> 
> 标签：c, gcc

我正在尝试编译一个依赖 sparse 0.4.1 的项目，但在尝试编译 sparse 0.4.1 时，我最终遇到以下编译器错误：

```
included from parse.c:25:
./parse.h:63:22: error: member of anonymous struct redeclares 'label_statement'
                        struct statement *label_statement;
                                          ^
./parse.h:40:22: note: previous declaration is here
                        struct statement *label_statement; 
```

这让我很困惑，因为它们是两个不同结构的不同成员，所以为什么抱怨呢？

代码如下所示：

```
struct statement {
    enum statement_type type;
    struct position pos;
    union {
            struct /* declaration */ {
                    struct symbol_list *declaration;
            };
            struct /* label_arg */ {
                    struct symbol *label;
                    struct statement *label_statement;
            };
            struct {
                    struct expression *expression;
                    struct expression *context;
            };
            struct /* return_statement */ {
                    struct expression *ret_value;
                    struct symbol *ret_target;
            };
            struct /* if_statement */ {
                    struct expression *if_conditional;
                    struct statement *if_true;
                    struct statement *if_false;
            };
            struct /* compound_struct */ {
                    struct statement_list *stmts;
                    struct symbol *ret;
                    struct symbol *inline_fn;
                    struct statement *args;
            };
            struct /* labeled_struct */ {
                    struct symbol *label_identifier;
                    struct statement *label_statement;
            };
....... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:30:59.663

你在同一个 union 中声明语句 label_statement 两次，第一次在第 40 行，第二次在第 63 行

```
 struct statement *label_statement; 
```

尝试编辑第二个的名称。

# mysql - 使用游标更改 mysql 数据输出

> ID：13483975
> 
> 赞同：0
> 
> 时间：2012-11-20T23:26:17.173
> 
> 标签：mysql, cursor

我有以下具有挑战性的数据输出：

```
**AD_ID         Keyword**
6005090341554   Vitamin C
6005090341554   Vitaminsiz
6005090341554   Supplement Superstores
6005090341554   #Dietary supplement 
```

我的问题是如何通过以下方式使我的查询输出：

```
**Ad_ID         Keywords**
6005090341554   Vitamin C,Vitaminsiz,Supplement Superstores,#Dietary supplement 
```

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:39:46.993

使用`GROUP BY`和[`GROUP_CONCAT`](http://dev.mysql.com/doc/refman/5.6/en/group-by-functions.html#function_group-concat)

```
SELECT Ad_ID,GROUP_CONCAT(Keyword) as Keywords FROM my_table GROUP by Ad_ID; 
```

# c# - Windows Phone 实体框架数据层

> ID：13483978
> 
> 赞同：1
> 
> 时间：2012-11-20T23:26:29.333
> 
> 标签：c#, asp.net, entity-framework

这似乎是一个奇怪的问题，但我一直在研究制作一个数据层来与我的 windows phone 应用程序交互。我正在维护一个记录按下按钮的时间段的 Windows 手机应用程序，但是我需要将此信息发送并处理到 SQL 数据库中。实际的应用程序会相对较小，所以我认为不需要起诉 WCF。

我听说我应该使用实体框架将 Web API 与 ASP.net 4 一起使用，但我找不到任何教程。有什么建议么？

很抱歉很烦人，我只是在努力用它去任何地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T23:33:12.777

第一次搜索“web api 实体框架”：[ASP。NET Web API 与实体框架](http://code.msdn.microsoft.com/ASP-NET-Web-API-with-afa30545) 。

> 此示例包含 asp.net/web-api 站点上的教程 Using Web API with Entity Framework 的完整项目。摘录：本教程展示了如何使用代码优先的方式将 ASP.NET Web API 与 ADO.NET Entity Framework 一起使用development.Entity 框架是一个对象/关系

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:34:19.473

也许只是使用 EF 连接到远程服务器？

# database - 功能依赖的简约键？

> ID：13483979
> 
> 赞同：1
> 
> 时间：2012-11-20T23:26:37.460
> 
> 标签：database, functional-programming, normalization

我只是想了解功能依赖，我已经陷入了一个问题。我必须找到 R 的简约键。

关系 R(S, T, U, V ,W ,X ,YZ)

FD(S->TUV, TV->W, WXY->Z, X->YZ)

我该怎么做呢？

# ruby-on-rails-3 - 未定义的方法`gmaps4rails'用于...当使用gmaps4rails gem Rails 3 postgres local

> ID：13483980
> 
> 赞同：0
> 
> 时间：2012-11-20T23:26:52.153
> 
> 标签：ruby-on-rails-3, gmaps4rails

我正在尝试使用 gmaps4rails gem 实现谷歌映射。我已经按照github上的教程here

[https://github.com/apneadiving/Google-Maps-for-Rails/blob/master/README.rdoc](https://github.com/apneadiving/Google-Maps-for-Rails/blob/master/README.rdoc)

但是当我尝试渲染视图时，标题中出现错误：

未定义的方法`gmaps4rails'

根据这个线程

[Rails 3 谷歌地图](https://stackoverflow.com/questions/6103384/rails-3-google-maps)

答案是使用 check_process => false 或向数据库添加 gmaps:boolean 列。我都没有运气

从控制台：

```
Event.find(18).gmaps 
=>nil 
```

从模型：

```
class Event < ActiveRecord::Base
include Gmaps4rails::ActsAsGmappable

acts_as_gmappable 

def gmaps4rails_address
  #describe how to retrieve the address from your model, if you use directly a db column, you can dry your code, see wiki
 address
end

    end 
```

从控制器

```
 def index
@events=Event.all
@json = Event.all.to_gmaps4rails
  end 
```

从视图

```
<%= gmaps4rails(@json) %> 
```

注释掉视图代码可以消除错误。在视图中仅显示 @json 会呈现一个空数组。我也多次重置服务器，没有任何变化。

更新了完整的跟踪：

```
undefined method `gmaps4rails' for #<#<Class:0x007fb963deb9c0>:0x007fb963dd1778>

Extracted source (around line #18):

15:             <h3 class="twitter_caveat">
16:                 <-- Check twitter feed for updates and details
17:             </h3>
18:             <%= gmaps4rails(@json) %>
19: 
20:             <% @events=Event.find(:all, :order => :date) %> 
21:             <% unless defined? (old_date) 

Rails.root: /Users/taylorjackson/Desktop/eiweb
Application Trace | Framework Trace | Full Trace

    app/views/events/index.html.erb:18:in`_app_views_events_index_html_erb___2050852902177216198_70217110523400__1900275664769892622'
    actionpack (3.0.9) lib/action_view/template.rb:135:in `block in render'
activesupport (3.0.9) lib/active_support/notifications.rb:54:in `instrument'
actionpack (3.0.9) lib/action_view/template.rb:127:in `render'
actionpack (3.0.9) lib/action_view/render/rendering.rb:59:in `block in _render_template'
activesupport (3.0.9) lib/active_support/notifications.rb:52:in `block in instrument'
activesupport (3.0.9) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (3.0.9) lib/active_support/notifications.rb:52:in `instrument'
actionpack (3.0.9) lib/action_view/render/rendering.rb:56:in `_render_template'
actionpack (3.0.9) lib/action_view/render/rendering.rb:26:in `render'
actionpack (3.0.9) lib/abstract_controller/rendering.rb:115:in `_render_template'
actionpack (3.0.9) lib/abstract_controller/rendering.rb:109:in `render_to_body'
actionpack (3.0.9) lib/action_controller/metal/renderers.rb:47:in `render_to_body'
actionpack (3.0.9) lib/action_controller/metal/compatibility.rb:55:in `render_to_body'
actionpack (3.0.9) lib/abstract_controller/rendering.rb:102:in `render_to_string'
actionpack (3.0.9) lib/abstract_controller/rendering.rb:93:in `render'
actionpack (3.0.9) lib/action_controller/metal/rendering.rb:17:in `render'
actionpack (3.0.9) lib/action_controller/metal/instrumentation.rb:40:in `block (2 levels) in render'
activesupport (3.0.9) lib/active_support/core_ext/benchmark.rb:5:in `block in ms'
/Users/taylorjackson/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/benchmark.rb:310:in `realtime'
activesupport (3.0.9) lib/active_support/core_ext/benchmark.rb:5:in `ms'
actionpack (3.0.9) lib/action_controller/metal/instrumentation.rb:40:in `block in render'
actionpack (3.0.9) lib/action_controller/metal/instrumentation.rb:78:in `cleanup_view_runtime'
activerecord (3.0.9) lib/active_record/railties/controller_runtime.rb:15:in `cleanup_view_runtime'
actionpack (3.0.9) lib/action_controller/metal/instrumentation.rb:39:in `render'
actionpack (3.0.9) lib/action_controller/metal/implicit_render.rb:10:in `default_render'
actionpack (3.0.9) lib/action_controller/metal/implicit_render.rb:5:in `send_action'
actionpack (3.0.9) lib/abstract_controller/base.rb:150:in `process_action'
actionpack (3.0.9) lib/action_controller/metal/rendering.rb:11:in `process_action'
actionpack (3.0.9) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.0.9) lib/active_support/callbacks.rb:436:in `_run__3137438702937572687__process_action__2204161605349298996__callbacks'
activesupport (3.0.9) lib/active_support/callbacks.rb:410:in `_run_process_action_callbacks'
activesupport (3.0.9) lib/active_support/callbacks.rb:94:in `run_callbacks'
actionpack (3.0.9) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.0.9) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.0.9) lib/active_support/notifications.rb:52:in `block in instrument'
activesupport (3.0.9) lib/active_support/notifications/instrumenter.rb:21:in `instrument'
activesupport (3.0.9) lib/active_support/notifications.rb:52:in `instrument'
actionpack (3.0.9) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.0.9) lib/action_controller/metal/rescue.rb:17:in `process_action'
actionpack (3.0.9) lib/abstract_controller/base.rb:119:in `process'
actionpack (3.0.9) lib/abstract_controller/rendering.rb:41:in `process'
actionpack (3.0.9) lib/action_controller/metal.rb:138:in `dispatch'
actionpack (3.0.9) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.0.9) lib/action_controller/metal.rb:178:in `block in action'
actionpack (3.0.9) lib/action_dispatch/routing/route_set.rb:62:in `call'
actionpack (3.0.9) lib/action_dispatch/routing/route_set.rb:62:in `dispatch'
actionpack (3.0.9) lib/action_dispatch/routing/route_set.rb:27:in `call'
rack-mount (0.6.14) lib/rack/mount/route_set.rb:148:in `block in call'
rack-mount (0.6.14) lib/rack/mount/code_generation.rb:93:in `block in recognize'
rack-mount (0.6.14) lib/rack/mount/code_generation.rb:68:in `optimized_each'
rack-mount (0.6.14) lib/rack/mount/code_generation.rb:92:in `recognize'
rack-mount (0.6.14) lib/rack/mount/route_set.rb:139:in `call'
actionpack (3.0.9) lib/action_dispatch/routing/route_set.rb:493:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/head.rb:14:in `call'
rack (1.2.3) lib/rack/methodoverride.rb:24:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/flash.rb:182:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/session/abstract_store.rb:149:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/cookies.rb:302:in `call'
activerecord (3.0.9) lib/active_record/query_cache.rb:32:in `block in call'
activerecord (3.0.9) lib/active_record/connection_adapters/abstract/query_cache.rb:28:in `cache'
activerecord (3.0.9) lib/active_record/query_cache.rb:12:in `cache'
activerecord (3.0.9) lib/active_record/query_cache.rb:31:in `call'
activerecord (3.0.9) lib/active_record/connection_adapters/abstract/connection_pool.rb:354:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/callbacks.rb:46:in `block in call'
activesupport (3.0.9) lib/active_support/callbacks.rb:416:in `_run_call_callbacks'
actionpack (3.0.9) lib/action_dispatch/middleware/callbacks.rb:44:in `call'
rack (1.2.3) lib/rack/sendfile.rb:107:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/remote_ip.rb:48:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/show_exceptions.rb:47:in `call'
railties (3.0.9) lib/rails/rack/logger.rb:13:in `call'
rack (1.2.3) lib/rack/runtime.rb:17:in `call'
activesupport (3.0.9) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.2.3) lib/rack/lock.rb:11:in `block in call'
<internal:prelude>:10:in `synchronize'
rack (1.2.3) lib/rack/lock.rb:11:in `call'
actionpack (3.0.9) lib/action_dispatch/middleware/static.rb:30:in `call'
railties (3.0.9) lib/rails/application.rb:168:in `call'
railties (3.0.9) lib/rails/application.rb:77:in `method_missing'
railties (3.0.9) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.2.3) lib/rack/content_length.rb:13:in `call'
rack (1.2.3) lib/rack/handler/webrick.rb:52:in `service'
/Users/taylorjackson/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:111:in `service'
/Users/taylorjackson/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/httpserver.rb:70:in `run'
/Users/taylorjackson/.rvm/rubies/ruby-1.9.2-p320/lib/ruby/1.9.1/webrick/server.rb:183:in `block in start_thread' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T18:16:29.203

我不得不继续前进并暂时离开这个问题，当我回到分支（没有代码更改）时，gem 工作没有问题。我唯一的理论是我的本地 postgres 服务器直到我在过渡期间重新启动计算机后才正确关闭。

# c++ - c++ - 提取所有文件名 - FindFirstFile

> ID：13483986
> 
> 赞同：1
> 
> 时间：2012-11-20T23:27:30.540
> 
> 标签：c++, windows, file

我想获取特定目录中所有文件的列表。为此|我使用以下代码

```
void GetFileListing(std::list<std::string>& listing, std::string directory, std::string fileFilter, bool recursively=true)
{

//check if directory exits:

     DWORD attribs = ::GetFileAttributesA(directory.c_str());
  if (attribs == INVALID_FILE_ATTRIBUTES || !(attribs & FILE_ATTRIBUTE_DIRECTORY)) {
    return ;
  }

  // If we are going to recurse over all the subdirectories, first of all
  // get all the files that are in this directory that match the filter
  if (recursively)
    GetFileListing(listing, directory, fileFilter, false);

  directory += "\\";

  WIN32_FIND_DATA FindFileData;
  HANDLE hFind = INVALID_HANDLE_VALUE;

  // Setup the filter according to whether we are getting the directories
  // or just the files
  std::string filter = directory + (recursively ? "*" : fileFilter);

  // Find the first file in the directory.
  hFind = FindFirstFile(LPCWSTR(filter.c_str()), &FindFileData);

  if (hFind == INVALID_HANDLE_VALUE)
  {
    DWORD dwError = GetLastError();
    if (dwError!=ERROR_FILE_NOT_FOUND)
    {
      std::cout << "Invalid file handle for filter "<<filter<<". Error is " << GetLastError() << std::endl;
    }
  }
  else
  {
    // Add the first file found to the list
    if (!recursively)
    {
        wstring wFindFileData = FindFileData.cFileName;
      listing.push_back(directory + std::string(wFindFileData.begin(),wFindFileData.end()));
    }

    // List all the other files in the directory.
    while (FindNextFile(hFind, &FindFileData) != 0)
    {
      if (!recursively)
      {
        wstring wFindFileData = FindFileData.cFileName;
        listing.push_back(directory + std::string(wFindFileData.begin(),wFindFileData.end()));
      }
      else
      {
        // If we found a directory then recurse into it
        if ((FindFileData.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)>0 && FindFileData.cFileName[0]!='.')
        {
            wstring wFindFileData = FindFileData.cFileName;
          GetFileListing(listing, directory + std::string(wFindFileData.begin(),wFindFileData.end()), fileFilter);
        }
      }
    }

    DWORD dwError = GetLastError();
    FindClose(hFind);
    if (dwError != ERROR_NO_MORE_FILES)
    {
      std::cout << "FindNextFile error. Error is "<< dwError << std::endl;
    }
  }
}

int main(int argc, char *argv[])
{
    if(argc < 2)
        return 0;
    std::list<std::string> listing;
    GetFileListing(listing, argv[1], "*");
    for(std::list<std::string>::iterator it = listing.begin(); it!=listing.end();++it)
    {
        std::cout << *it << std::endl;
    }
} 
```

在 args 中，我传输了一个有效的现有目录。实际上 args[1] 变为“C:\dir”。但我没有得到想要的列表，而是出现以下错误：

```
Invalid file handle for filter C:\dir\*. Error is 123 
```

我不明白这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:14:48.353

您将 ANSI 与 UNICODE 混合使用，更糟糕的是，将 a`char*`转换为`wchar_t*`.

```
std::string filter;
// ...
LPCWSTR(filter.c_str()) // this does not work and causes the error! 
```

如果你要求你的函数使用`std::string`，请完全保持 ANSI（使用`FindFirstFileA`,`FindNextFileA`和`WIN32_FIND_DATAA`）。否则，使用 instead 并使用以instead of`std::wstring`结尾的函数/结构。`W``A`

窗口标题定义`FindFirstFile`为`FindFirstFileW`如果`UNICODE`已定义，`FindFirstFileA`否则。因此，对于通用解决方案， typedef a`std::basic_string<TCHAR>`并将其用作字符串类型。这样，它在`UNICODE`定义时使用 std::wstring ，否则使用 std::string 。

# grails - Grails 中的 lib 目录

> ID：13483988
> 
> 赞同：1
> 
> 时间：2012-11-20T23:27:35.570
> 
> 标签：grails, grails-2.0

我有几组 .jar 文件，并希望将它们放在 Grails“lib”文件夹中的不同子文件夹中。似乎一切都运行良好，但是当我运行应用程序时，我收到消息，它无法在 .jar 文件中找到类。当我在“lib”文件夹中混合所有 .jar 文件时，一切正常。有什么线索和建议吗？

礼萨

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:49:53.590

您可能正在尝试解决错误的问题。这些 jar 在 Maven 存储库中可用吗？如果是这样，最好将它们定义为 BuildConfig.groovy 中的依赖项。lib 目录应该只用于在某个地方的 repo 中不可用的 jar 文件，例如项目之间共享的内部库。但即便如此，我也会配置一个 Artifactory 或 Nexus 服务器（两者都是免费的，都易于设置）来托管这些私有 jar。您也可以使用该服务器来托管私有插件。

# c++ - 识别设置项

> ID：13483990
> 
> 赞同：1
> 
> 时间：2012-11-20T23:27:42.823
> 
> 标签：c++

我只是问了一个涉及的问题，`std::set`但在考虑了更多之后，我想我已经把我的问题缩小到了一些简单的问题上。

我有一套独特的物品。我想创建一个向量，其中向量中的每个元素都指向集合中的一个项目。

所以，我有一组（唯一的）A 对象：

```
class A
{
    int i;
};

std::set<A, compareclass> mySet; 
```

和 A* 的向量：

```
std::vector<A*> myVec; 
```

`set::insert()`返回一个对，其中包含指向集合中元素（已插入或已存在）的迭代器。从技术上讲，我可以像这样得到它的地址：

```
ret = myset.insert(A());
myVec.push_back(&(*ret.first)); 
```

不过，我认为这可能不是一个好主意。有没有其他方法可以让向量元素指向集合中的特定对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T23:32:56.677

`I'm thinking that might not be a great idea`， 为什么你这么想？我看到你唯一能做的就是使用类似于智能指针而不是普通指针的东西来澄清所有权，并避免随之而来的内存泄漏错误。

或者像 Jerry 建议的那样，迭代器更好！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T23:32:19.000

如果我是你，我会在堆上分配对象，并`shared_ptr`在集合和向量中存储指向它们的智能指针（例如 ）。

在我看来，这将大大减少与内存或指针相关的错误的可能性。它还将解耦集合和向量的生命周期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T23:34:59.650

你有没有尝试过类似的东西

```
 typedef std::shared_ptr<A> APtr

 std::set<APtr, compareClassThatTakesAPtr> aSet;
 aSet.insert(new A());

 std::vector<APtr> aVec;

 //...
 aVec.push_back(aSet.begin()); 
```

现在它们在堆上，`set`/`vector`不直接管理 A 的实例。`set`相反，您对您的和`vector`所有人都指向相同的对象这一事实负责。

# hadoop - 为每个作业设置最大映射/减少任务

> ID：13483991
> 
> 赞同：1
> 
> 时间：2012-11-20T23:28:10.383
> 
> 标签：hadoop, task, setting

我有两种类型的作业，要求集群每个节点具有不同数量的任务。经过研究，我最终得到了这个页面：

[https://issues.apache.org/jira/browse/HADOOP-5170](https://issues.apache.org/jira/browse/HADOOP-5170)

我想知道是否有其他人知道四处走动的方法。我不想每次都重新启动集群。

或者如果有人能告诉我，如果我为它设置一个错误的数字，性能会有多糟糕，比如说，每个节点有 1 或 999999 个任务。

谢谢，

# ios - iOS 在情节提要中切换嵌入式视图

> ID：13483992
> 
> 赞同：7
> 
> 时间：2012-11-20T23:28:13.710
> 
> 标签：ios, views, storyboard

我整天都在尝试解决这个问题，我知道它应该能够完成，但是对于使用 Objective-C 而不是 Appcelerator 进行 iOS 开发的新手，我遇到了新手问题。

我想要完成的是在我的其他视图之一中拥有一个嵌入式视图，但能够通过编程切换嵌入哪个视图。我正在使用故事板。当我尝试使用视图容器时，它会显示附加视图，但我无法将多个视图附加到情节提要中的容器。我画了一张图片，但令我烦恼的是，我无法在此处发布图片，因为我没有足够的“代表”点，所以我将其发布在我的网站上： [http ://static.c6gx.com/images/iphone -embedded-views-diagram.jpg](http://static.c6gx.com/images/iphone-embedded-views-diagram.jpg)

稍后我希望在该视图容器中看起来像是一个推送 segue，但首先我只想能够在嵌入式视图 1、2、3 等之间切换。我应该使用视图容器来完成这个，还是其他类型的控制器？那么我如何调用转换来改变视图呢？

感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T00:10:01.267

您可以像使用容器视图控制器一样切换视图控制器。我做了一个项目，在其中添加了一个容器视图（实际上是 2 个，但我们在这里只处理一个），并将此代码添加到嵌入式控制器中，当您在容器视图中拖动时会自动获得该控制器。我要切换到的控制器 NewRightController 是 UIViewController 子类——在情节提要中，我将控制器的大小设置为“自由形式”，并更改了视图的大小以匹配嵌入式控制器视图的大小。这实际上并不影响视图的大小（它仍然以全屏形式记录），它只是使布局子视图更容易。

```
-(IBAction)switchToNewRight:(id)sender {
    UIView *rcView = [(ViewController *)self.parentViewController rightView]; // rcView is the right container view in my root view controller that self is embedded in.
    NewRightController *newRight = [self.storyboard instantiateViewControllerWithIdentifier:@"NewRight"];
    newRight.oldRightController = self; // pass self to new controller so I can come back to the same instance
    newRight.view.frame = rcView.bounds;
    [self.parentViewController addChildViewController:newRight];
    [self moveToNewController:newRight];
}

-(void)moveToNewController:(UIViewController *) newController {
    UIView *rcView = [(ViewController *)self.parentViewController rightView];
    [self willMoveToParentViewController:nil];
    [self.parentViewController transitionFromViewController:self toViewController:newController duration:1 options:UIViewAnimationOptionTransitionCurlUp animations:^{}
         completion:^(BOOL finished) {
             [self removeFromParentViewController];
             [rcView constrainViewEqual:newController.view];
             [newController didMoveToParentViewController:self];
         }];
} 
```

经过大量实验后，我发现使视图具有正确大小并在旋转后正确调整大小的方法是最初将新控制器视图的框架设置为容器视图的边界，但是在过渡动画之后，添加约束到旋转后保持其大小的新视图。由于这段代码可能会被反复使用，我将它放在 UIView 上的一个类别中，使用一种方法，即 constrainViewEqual:。这是代码：

```
-(void)constrainViewEqual:(UIView *) view {
    [view setTranslatesAutoresizingMaskIntoConstraints:NO];
    NSLayoutConstraint *con1 = [NSLayoutConstraint constraintWithItem:self attribute:NSLayoutAttributeCenterX relatedBy:0 toItem:view attribute:NSLayoutAttributeCenterX multiplier:1 constant:0];
    NSLayoutConstraint *con2 = [NSLayoutConstraint constraintWithItem:self attribute:NSLayoutAttributeCenterY relatedBy:0 toItem:view attribute:NSLayoutAttributeCenterY multiplier:1 constant:0];
    NSLayoutConstraint *con3 = [NSLayoutConstraint constraintWithItem:self attribute:NSLayoutAttributeWidth relatedBy:0 toItem:view attribute:NSLayoutAttributeWidth multiplier:1 constant:0];
    NSLayoutConstraint *con4 = [NSLayoutConstraint constraintWithItem:self attribute:NSLayoutAttributeHeight relatedBy:0 toItem:view attribute:NSLayoutAttributeHeight multiplier:1 constant:0];
    NSArray *constraints = @[con1,con2,con3,con4];
    [self addConstraints:constraints];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-03T14:34:21.440

我想做同样的事情，这就是我发现的。

[创建自定义容器视图控制器](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html)

它的要点是您创建一个嵌入到容器视图中的导航控制器，它允许您根据需要在多个视图中导航。

这是一个简短的示例/演练：

1.  将导航控制器添加到您的故事板。
2.  将导航控制器嵌入到容器视图中。
3.  选择一个视图作为导航控制器的根视图控制器。
4.  为将在容器视图内部使用的每个视图控制器创建手动 segues，***包括根视图控制器***（我差点犯了不添加这个的错误）。确保为您创建的每个 segue 命名。
5.  在您的代码中，只要您想显示不同的视图控制器，只需调用相应的手动 segue。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T18:04:11.690

所以在玩了很多之后，我得到了它的工作，就像我想象的那样。此时它没有过渡，但我想发布代码供其他人查看。

在故事板中，我有一个用于整个游戏的视图控制器，其中有一个视图容器和一个按钮。嵌入到游戏视图中的视图是一个页面控制器，它将包含不同类型的问题。然后故事板中未附加的是不同类型的问题布局，在我的例子中是 teamDisplay 和 locationDisplay。

在 QuestionViewController 中，我向 .h 文件添加了两个属性：

```
@property (nonatomic, strong) UIPageViewController *pageViewController;
@property (nonatomic, strong) NSMutableArray *questionTypeViewControllers; 
```

声明了一个方法：

```
-(void)changeView; 
```

在 .m 文件中，合成它们：

```
@synthesize questionTypeViewControllers,
            pageViewController; 
```

在 viewDidLoad 方法中：

```
pageViewController = [[UIPageViewController alloc]
        initWithTransitionStyle:UIPageViewControllerTransitionStylePageCurl
        navigationOrientation:UIPageViewControllerNavigationOrientationHorizontal
        options:nil];

UIViewController *ldvc = [self.storyboard instantiateViewControllerWithIdentifier:@"locationDisplay"];
UIViewController *tdvc = [self.storyboard instantiateViewControllerWithIdentifier:@"teamDisplay"];

questionTypeViewControllers = [NSMutableArray arrayWithObjects:ldvc, tdvc, nil];

NSArray *initView = [NSArray arrayWithObject:ldvc];

[pageViewController setViewControllers:initView
                                      direction:UIPageViewControllerNavigationDirectionForward
                                       animated:NO
                                     completion:nil];
[self addChildViewController:pageViewController];
[self.view addSubview:self.pageViewController.view]; 
```

然后实现了changeView方法：

```
NSArray *initView = [NSArray arrayWithObject: [questionTypeViewControllers objectAtIndex:1]];
[pageViewController setViewControllers:initView
                                 direction:UIPageViewControllerNavigationDirectionForward
                                  animated:NO
                                completion:nil]; 
```

在按钮所在的 GameViewController 中，为按钮添加一个动作，并从 QuestionViewController 中调用新创建的 changeView 方法。

```
- (IBAction)change:(id)sender {
    // Need a more reliable way to get the QuestionViewController.
    [[self.childViewControllers objectAtIndex:0] changeView];
} 
```

就是这样。不费吹灰之力吧？！;)

我不知道这是否是正确的方法，但它奏效了。欢迎任何建议或改进。

# javascript - d3.js关于“点击”事件处理运行功能没有点击事件

> ID：13483995
> 
> 赞同：8
> 
> 时间：2012-11-20T23:28:26.577
> 
> 标签：javascript, d3.js

我目前正在为我的 d3 可视化进行鼠标单击事件处理：

```
fooCircle.on("click",fooFunction("barParameter")); 
```

我的问题是无需单击元素即可运行该功能。我知道这一点是因为我在函数中放置了打印语句。

有趣的是，当我将函数更改为不接受任何参数的函数时，该函数的行为应该如此，这意味着当我单击适当的元素时它会运行：

```
fooCircle.on("click",fooFunction); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T23:46:55.347

有人帮我解决了这个问题。解决办法是：

```
fooCircle.on("click", function () {fooFunction("barParameter"); }); 
```

这样，一个函数被传递给 on 函数，而不是函数的结果。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-20T23:43:14.800

`fooFunction`是的，因为您在订阅点击处理程序的地方调用：

```
fooCircle.on("click",fooFunction("barParameter"));// Calls fooFunction with param "barParameter" 
```

在那一刻，您会看到您的 console.log，因为您刚刚调用了该函数。

此外，我假设你`fooFunction`没有返回任何东西，这基本上意味着它返回`undefined`。那么订阅本质上就变成了：

```
fooCircle.on("click", undefined);// Nothing will happen since there's no handler 
```

这就是为什么第二个代码片段可以正常工作的原因；因为您为它提供了一个稍后调用的函数。

但是仍然存在一个问题，它的意义是`"barParameter"`什么？您是否需要将一些其他参数传递给-`fooFunction`除了d3 在单击时调用处理程序时将提供哪些参数？`d``i`