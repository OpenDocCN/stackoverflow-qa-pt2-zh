# StackOverflow 问答 15800000-15800999

# assembly - powerpc组装翻译

> ID：15800004
> 
> 赞同：1
> 
> 时间：2013-04-03T23:25:48.847
> 
> 标签：assembly, powerpc

有擅长组装power pc的人可以帮我破译这段代码吗？

```
extern inline void out_8(volatile unsigned char __iomem *addr, u8 val)
{
    __asm__ __volatile__("sync;\n"
                 "stb%U0%X0 %1,%0;\n"
                 : "=m" (*addr)
                 : "r" (val));
} 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:34:47.047

同步 - 意味着内存和无序缓冲区 - 刷新缓存等，然后是存储字节。看起来像内存屏障字节写入。确认...是的。同步用于确保处理器上所有先前的指令都已完成，并且没有启动后续指令。有趣的是，symc 通常发生在存储之后而不是之前，因此上面的代码确认在执行字节写入之前没有其他待处理的写入。

# scala - 为什么即使在未使用时，我也会在 Heroku 上收到超出内存配额的错误？(play2/scala)

> ID：15800010
> 
> 赞同：8
> 
> 时间：2013-04-03T23:26:28.973
> 
> 标签：scala, heroku, playframework-2.0

只是坐着没有请求，我的内存不断增加，最终超出了内存配额。有很多事情我不明白。

1.  为什么没有请求时内存使用量不断增加？
2.  “Process running mem”的值来自哪里（我可以说这似乎不是堆和非堆使用中的任何数字组合的总和）。
3.  为什么即使我有推荐它也会超过`JAVA_OPTS: -Xmx384m -Xss512k -XX:+UseCompressedOops -javaagent:heroku-javaagent-1.2.jar=stdout=true`？

这是日志文件的示例

```
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 275M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 276M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 277M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 277M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 278M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 212M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 213M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 213M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
app/web.1:  heroku-javaagent: JVM Memory Usage     (Heap): used: 214M committed: 349M max:349M 
app/web.1:  heroku-javaagent: JVM Memory Usage (Non-Heap): used: 37M committed: 37M max:219M 
app/web.1:  heroku-javaagent: JVM Threads                : total: 37 daemon: 7 non-daemon: 21 internal: 9 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
heroku/web.1:  Process running mem=517M(101.1%) 
heroku/web.1:  Error R14 (Memory quota exceeded) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-09T17:38:21.380

这个问题不应该是 Heroku 特有的，并且应该（理想情况下）能够在本地复制。首先，我建议以 Heroku 运行它的方式在本地运行您的应用程序：

*   运行[`sbt clean compile stage`](https://github.com/heroku/heroku-buildpack-scala/blob/master/bin/compile#L77)以创建`target/start`启动器
*   启动您的应用程序[`target/start -Dhttp.port=$PORT $JAVA_OPTS`](https://github.com/heroku/heroku-buildpack-scala/blob/master/bin/release#L23)（将 PORT 设置为您想要的任何内容）

然后我会使用一个内存分析器，比如[VisualVM](http://visualvm.java.net/)来附加到你在本地运行的应用程序，看看发生了什么。

如果这不起作用，或者您想更好地了解 Heroku 上的内存使用情况，我建议启用[log-runtime-metrics](https://devcenter.heroku.com/articles/log-runtime-metrics)。这也可以与[Log2Viz](https://log2viz.herokuapp.com/)一起使用以获得实时的内存可视化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-17T10:41:40.147

刚遇到类似的问题。我无法在本地重现该问题。事实证明，我们的日志记录配置中有一个文件附加程序。写入日志会使内存增长。您可以通过编写一个记录大量日志的小应用程序来验证这一点。如果启用 log-runtime-metrics，您将看到 memory_cache 和 memory_total 增长。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-07T16:56:28.507

在 heroku 中启用 log-runtime-metrics：

```
$ heroku labs:enable log-runtime-metrics
Enabling log-runtime-metrics for myapp... done
$ heroku restart 
```

这将允许您在日志中查看内存使用情况

```
heroku logs -t 
```

[https://devcenter.heroku.com/articles/log-runtime-metrics](https://devcenter.heroku.com/articles/log-runtime-metrics)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-03T15:32:29.820

我在 grails 应用程序中有相同的错误消息，我阅读了这篇[文章](http://www.objectpartners.com/2014/05/13/grails-r14-error-memory-quota-exceeded-on-heroku/)，解决方案很简单，在根文件夹中创建一个**system.property文件，内容为****java.runtime.version=1.7**，然后我重新部署应用程序，错误 R14 消失了

我希望它有帮助

# php - 否则如果 - 我做错了什么？

> ID：15800011
> 
> 赞同：0
> 
> 时间：2013-04-03T23:26:30.907
> 
> 标签：php, if-statement

我将以下代码与成员脚本结合使用，该脚本在页面上显示成员用户名或要求客人登录或注册。

PHP代码：

```
if ($_SESSION['username'])
{
echo "".$_SESSION['username'].", you are logged in.<br><small><a href=\"logout.php\">Click here to logout</a></small>";
}
else
echo "Welcome Guest!<br><small><a href=\"login.php\">Login</a> or <a href=\"register.php\">Register</a></small>"; 
```

它工作得很好，尽管现在我想修改它，所以如果具有管理员权限的用户登录它会识别用户名并提供指向管理页面的链接。

所以这是我修改后的代码：

```
<? php
$validateadmin = $_SESSION['username'];
if ($validateadmin == "admin1" or $validateadmin == "admin2")
  {
echo "Hello $validateadmin, you have <a href=\"admin.php\">admin</a> privileges.<br><small><a href=\"logout.php\">Click here to logout</a></small>";
  }
else if ($_SESSION['username'])
  {
echo "".$_SESSION['username'].", you are logged in.<br><small><a href=\"logout.php\">Click here to logout</a></small>";
 }
else
  {
echo "Welcome Guest!<br><small><a href=\"login.php\">Login</a> or <a href=\"register.php\">Register</a></small>";
 }
 ?> 
```

知道我做错了什么吗？它要么给我留下空白页，要么留下错误。我知道这可能是一个新手错误，但对于我的生活，我不知道出了什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:30:11.680

通常，您应该在 php 中使用 elseif 而不是“else if”，因为 php 解析器会将 else if 解释为 else { if { .... }} 并且您可能会遇到一些奇怪的错误。

此外，始终在控制语句中使用大括号以避免悬空子句是一种很好的做法。

另外，为了避免有关数组索引的通知，如果索引可能不存在，请不要执行 if($array[$index]) 之类的检查。使用任何 array_key_exists、isset、empty 等（它们都略有不同）来检查数组是否包含您要查找的键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:32:27.343

尝试以下

```
<?php #removed space
session_start(); #you will need this on all pages otherwise remove it if already called
$validateadmin = $_SESSION['username'];

if($validateadmin == "admin1" || $validateadmin == "admin2"){
    echo "Hello $validateadmin, you have <a href=\"admin.php\">admin</a> privileges.<br><small><a href=\"logout.php\">Click here to logout</a></small>";
}elseif(isset($_SESSION['username'])){ #you should use isset to make sure some variable is set
    echo $_SESSION['username'].", you are logged in.<br><small><a href=\"logout.php\">Click here to logout</a></small>";
}else{
    echo "Welcome Guest!<br><small><a href=\"login.php\">Login</a> or <a href=\"register.php\">Register</a></small>";
}
?> 
```

# javascript - JSON 到散列值

> ID：15800012
> 
> 赞同：2
> 
> 时间：2013-04-03T23:26:39.970
> 
> 标签：javascript, json

我想知道是否有人知道一个快速库或一些基本上可以做到这一点的解决方案。

```
code({ json: 1 }) -> codedsecret

decode(codedSecret) -> { json: 1 } 
```

基本上，我正在寻找一种将 JSON 转换为大多数人出于安全原因无法理解的编码字符串的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-03T23:32:06.767

如果“大多数人”是指非偷偷摸摸的开发人员，那么 base64 可能就足够了。现代浏览器应该实现`btoa`和`atob`（两个方向），但是如果你需要更多的兼容性，那里有库。

```
var secret = btoa(JSON.stringify({json: 1}));
JSON.parse(atob(secret)); // {json: 1} 
```

这根本不提供加密安全性，并且很容易被能够识别甚至解码 base64 字符串的开发人员破解。如果您需要涵盖这两种情况，那么您需要在与客户端通信之前考虑在服务器端进行加密，反之亦然。JavaScript 有 OpenSSL 实现，但我不确定我对它们的信任程度。

# css - CSS 相对绝对位置

> ID：15800016
> 
> 赞同：1
> 
> 时间：2013-04-03T23:27:07.483
> 
> 标签：css, position, css-position

我只有一个容器 div 元素，其中包含两个 div 元素，它们应该出现在容器 div 两侧的同一级别。以下解决方案不起作用：

```
<div id="result" >
    <div class="right">Update</div>
    <div class="left">delete</div>
</div> 
```

样式表如下：

```
div.left{
position:absolute;
left: 5px;
top:0px;
color: green;
border-style:solid;
border-color: green;
}
div.right{
position:absolute;
right: 2px;
top:0px;
color: red;
border-style:solid;
border-color: red;
}
#result{
position:relative;
width:100%;
border-style:solid;
border-color: blue;
} 
```

container-div 的蓝色边距不包含其他两个 div，并出现在其他两个容器的顶部。

我错过了什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:35:27.873

理想情况下 .left 和 .right div 会[浮动](http://jsfiddle.net/ZxT4X/1/)：

```
div.left{
    float: left;
    margin: 5px;
    color: green;
    border-style:solid;
    border-color: green;
}

div.right{
    float: right;
    margin: 5px;
    color: red;
    border-style:solid;
    border-color: red;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:31:51.527

你可以尝试的是 float:left 到你试图并排放置的两个元素，这应该推动它们，看看它是否有效并让我知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T23:34:05.057

你已经放置了基本上不需要的位置。看下面的答案

html在这里

```
<div id="result" >
<div class="right">Update</div>
<div class="left">delete</div>
</div> 
```

这里的 css

```
div.left{
left: 5px;
top:0px;
color: green;
border-style:solid;
border-color: green;
float:left;
}
div.right{
right: 2px;
top:0px;
color: red;
border-style:solid;
border-color: red;
float:right;
}
#result{
width:100%;
border-style:solid;
border-color: blue;
float:left;

} 
```

活的例子在这里。 [http://codepen.io/anon/pen/waKrH](http://codepen.io/anon/pen/waKrH)

如果这对您有帮助，请标记为答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T23:39:59.053

你想实现[这个小提琴](http://jsfiddle.net/uzgL9/)吗？

更好的方法是将绝对值更改为相对值，浮动。如果你使用浮动，不要忘记添加`overflow:hidden;`到父容器。

# python - 如何删除未涵盖的python代码

> ID：15800018
> 
> 赞同：2
> 
> 时间：2013-04-03T23:27:10.923
> 
> 标签：python, dependencies, code-coverage, minify

是否有一个工具可以删除运行时未涵盖的 python 代码，或者有一个工具可以删除特定函数不依赖的代码？如果没有，什么是好的方法？

更具体地说，这是我的问题：

我需要 github 上 networkx 算法模块的maxflow**子**集**。**

 **通常我会下载整个库，然后导入我需要的模块：

1）。我需要将其中一些算法物理打印到纸上。

2）。有些比赛有一个在线评委来运行你的代码。裁判没有安装networkx，所以我需要在上传给裁判之前将我需要的代码剪切并粘贴到一个.py文件中。法官规定文件大小限制为 50,000 字节。

例如，剪切和粘贴一个函数后

```
def ford_fulkerson(G, s, t, capacity='capacity'): 
```

但是 ford_fulkerson 依赖于其他算法、networkx 自定义错误以及整个 networkx 图和有向图类。

在剪切和粘贴这些依赖项之后，我从 50 行代码增加到了 3000 行代码。

我查看了一些应该涵盖所有内容的测试用例的覆盖率，但覆盖率仅为 39%。这 39% 的大部分只是读取甚至没有使用的函数的函数名称。

```
C:\Users\robert\code\play\spoj>coverage run TOSCORE.py < in.txt
No goal
Goal

C:\Users\robert\code\play\spoj>coverage report -m
Name      Stmts   Miss  Cover   Missing
---------------------------------------
TOSCORE     733    444    39%   226, 233, 236, 252, 280-283, 301, 377-389, 437-4
56, 489-497, 526-534, 568-570, 597, 618, 633, 655-658, 712-715, 772-801, 835, 86
4-869, 900-906, 948-949, 988-991, 1011-1014, 1107, 1115-1119, 1167-1170, 1195, 1
221, 1257-1260, 1297-1308, 1328-1331, 1357, 1361, 1406-1415, 1452, 1493-1512, 15
38, 1570-1574, 1600, 1636-1640, 1673-1677, 1704-1707, 1731-1733, 1757-1759, 1803
-1828, 2029, 2078-2091, 2142-2154, 2160, 2193-2203, 2232-2243, 2296, 2300-2301,
2305-2307, 2309-2311, 2359-2391, 2424-2425, 2455-2459, 2467, 2474, 2483-2484, 24
90-2491, 2498, 2502, 2551-2562, 2588-2599, 2608, 2645-2658, 2698-2709, 2747-2758
, 2798-2801, 2838-2841, 2859-2862, 2867, 2910, 2949-2963, 2979-2990, 3032-3055,
3084, 3091-3092, 3134-3140, 3148-3151, 3178-3180, 3192, 3198, 3208, 3254, 3265-3
283 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:08:40.877

在我看来，作为第一次尝试，可以将输出`coverage`用作（比如说）Python 脚本的输入，该脚本读取原始文件`TOSCORE.py`并写出`TOSCORE.py`省略所有未覆盖行的版本。

不过，在实践中，这种方法可能有点幼稚。更复杂的方法可能是：

1.  获取由 生成的未覆盖线列表`coverage`。
2.  找到比 1 行长的第一块未覆盖的行（假设单个未覆盖的行不太可能是整个未使用的函数）。
3.  写出`TOSCORE.py`省略该块的版本。
4.  在`TOSCORE.py`.
5.  如果测试成功运行，则返回步骤 1，使用修改后的版本作为要测量覆盖率`TOSCORE.py`的基础版本。`TOSCORE.py`
6.  如果省略给定的未覆盖代码块导致测试失败，请继续尝试省略下一个未覆盖代码块。

这可能需要一段时间才能执行，但它应该确保生成的缩短代码通过所有测试。

一种执行时间更短的中间方法是在再次运行测试之前尝试一次省略几个未发现的代码块。

一种更复杂的方法可能是插入一条`pass`语句来代替我们省略的行（以第一个省略行的缩进为前缀）来处理未覆盖的行包含在未使用的`if`语句分支或未使用的`while`循环中的情况，因此只是省略这些行会导致错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T06:10:54.840

我写了一个删除评论的小脚本，这就足够了。如果我使用标记器会更好，但无论如何都是这样：

```
data = open("mini_nx.py").read().replace("nx.", "").splitlines()
data = [line for line in data if not line.strip().startswith("#")]

final_data = []
inside = False
for line in data:
    if not inside and line.strip().startswith('"""'):
        if line.strip().endswith('"""') and line.count('"""') > 1:
            final_data.append(line)
        else:
            line = line.rstrip('"')
            if '"' in line:
                line += '-"""'
            else:
                line += '"""-"""'
            final_data.append(line)
            inside = True
        continue
    if inside and line.endswith('"""'):
        inside = False
    elif not inside and line.strip():
        final_data.append(line)

with open("converted_mini_nx.py", "w") as f:
    f.write("\n".join(final_data)) 
```**

# sql - 如何使表的属性成为该表中的外键？

> ID：15800022
> 
> 赞同：2
> 
> 时间：2013-04-03T23:27:28.187
> 
> 标签：sql, database, foreign-keys

我必须编写 SQL 来在此 ERD 中创建表、属性以及主键和外键：http: [//imgur.com/VYZbwr6](http://imgur.com/VYZbwr6)

在 ERD 的“Financial_Transactions”表中，有一个名为“previous_transaction_id”的属性和另一个名为“transaction_id”的属性。在此表中，“previous_transaction_id”除了是一个属性外，还是该表的外键。它引用表中的最后一个“transaction_id”。

这是我的“financial_transactions”表的 SQL：

```
CREATE TABLE financial_transactions(
transaction_id int IDENTITY(1,1) NOT NULL,
account_id int NOT NULL,
item_rental_id int NOT NULL,
previous_transaction_id int,
transaction_type_code int NOT NULL,
transaction_date date NOT NULL,
transaction_amount money NOT NULL,
transaction_comment varchar(512) NOT NULL);

ALTER TABLE financial_transactions ADD CONSTRAINT pk_financial_transactions PRIMARY KEY (transaction_id);

ALTER TABLE financial_transactions ADD  CONSTRAINT fk_financial_transactions_accounts FOREIGN KEY(account_id)
REFERENCES accounts (account_id);

ALTER TABLE financial_transactions ADD  CONSTRAINT fk_financial_transactions_customer_rentals FOREIGN KEY(item_rental_id)
REFERENCES customer_rentals (item_rental_id);

ALTER TABLE financial_transactions ADD  CONSTRAINT fk_financial_transactions_financial_transactions FOREIGN KEY(previous_transaction_id)
REFERENCES financial_transactions (previous_transaction_id);

ALTER TABLE financial_transactions ADD  CONSTRAINT fk_financial_transactions_transaction_types FOREIGN KEY(transaction_type_code)
REFERENCES transaction_types (transaction_type_code); 
```

当我运行我的 SQL（包括脚本中每个表的语句）时，我收到以下错误：

“消息 1776，级别 16，状态 0，第 87 行在引用表 'financial_transactions' 中没有与外键 'fk_financial_transactions_financial_transactions' 中的引用列列表匹配的主键或候选键。

消息 1750，级别 16，状态 0，第 87 行无法创建约束。查看以前的错误。”

所有其他语句正常执行。

我究竟做错了什么？

*我最初在 CREATE TABLE 下使用了此语句：previous_transaction_id int NOT NULL，但是，它导致了相同的错误，并且在搜索时我看到了一个类似的问题，该问题已通过删除 NOT NULL 得到修复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:31:52.100

这里

```
ALTER TABLE financial_transactions ADD  CONSTRAINT 
fk_financial_transactions_financial_transactions 
FOREIGN KEY(previous_transaction_id)
REFERENCES financial_transactions (previous_transaction_id); 
```

您有一个引用自身的列。这是您的意图还是您想引用 transaction_id？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:41:57.907

为同一个表定义外键没有任何问题，但是您有一个引用自身的列。

尝试更换：

```
ALTER TABLE financial_transactions ADD  CONSTRAINT fk_financial_transactions_financial_transactions FOREIGN KEY(previous_transaction_id)
REFERENCES financial_transactions (previous_transaction_id); 
```

和：

```
ALTER TABLE financial_transactions ADD  CONSTRAINT fk_financial_transactions_financial_transactions FOREIGN KEY(previous_transaction_id)
REFERENCES financial_transactions (transaction_id); 
```

# android - 如何将元素添加到 ListView？

> ID：15800026
> 
> 赞同：0
> 
> 时间：2013-04-03T23:28:02.340
> 
> 标签：android, android-widget

我想向我的 ListView 添加一个元素。我尝试使用 myAdapter.add() （参见下面的代码），因为 ArrayAdapter 有一个 add() 方法。但这没有用。将元素添加到我的 ListView 的正确方法是什么？

```
public class LinearLayoutDemo extends ListActivity implements OnItemClickListener {
    private static final String[] items={"1", "2", "4", "8", "16", "32", "64"};
ListView myLV;
ArrayAdapter myAdapter;

@Override public void onCreate(Bundle icicle) {
    super.onCreate(icicle);
    myAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_activated_1, items);
    myLV = (ListView) findViewById(android.R.id.list);
    myLV.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
    myLV.setAdapter(myAdapter);

    // The following causes the program to fail:
    myAdapter.add("128");
} 
```

此外，如果我尝试 myAdapter.clear()，程序会崩溃。我没有正确使用 ArrayAdapter 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:48:49.583

您必须添加到`items`然后调用`myAdapter.notifyDataSetChanged()`. 但是您定义的方式`items`无法`final`添加。如果您想轻松添加新元素，您应该将项目声明为`ArrayList<String>`.

```
public class LinearLayoutDemo extends ListActivity implements OnItemClickListener {
private static List<String> items = Arrays.asList("1", "2", "4", "8", "16", "32", "64");
ListView myLV;
ArrayAdapter myAdapter;

@Override public void onCreate(Bundle icicle) {
super.onCreate(icicle);

myAdapter = new ArrayAdapter(this, android.R.layout.simple_list_item_activated_1, items);
myLV = (ListView) findViewById(android.R.id.list);
myLV.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
myLV.setAdapter(myAdapter);

items.add("128");
myAdapter.notifyDataSetChanged();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:28:54.487

您需要致电：

```
myAdapter.notifyDataSetChanged(); 
```

在添加元素后在适配器上通知适配器数据集的任何更改，但是在创建`Array`. 改为使用`ArrayList`。

# java - 番石榴表 ConcurrentModificationException

> ID：15800027
> 
> 赞同：0
> 
> 时间：2013-04-03T23:28:04.607
> 
> 标签：java, guava

我正在阅读一些使用 Guava 表的代码，偶尔会抛出一个`ConcurrentModificationException`- 我理解这是因为我正在遍历表的列并在同一个循环中修改表。有没有一种干净/高效的方法来解决这个问题？我可以在 put 之前做一个 table.remove 并期望它工作吗？

```
final Set<Optional<SimpleWorkDataValue>> columnKeys = table.columnKeySet();
for (final SimpleWorkDataValue timeSeriesValue : timeSeriesValues) {
    final Optional<SimpleWorkDataValue> rowKey = Optional.of(timeSeriesValue);
    for (final Optional<SimpleWorkDataValue> columnKey : columnKeys) {
        if (!table.contains(rowKey, columnKey)) {
            table.put(rowKey, columnKey, ResultSet.EMPTY);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T23:54:34.423

根据嵌套循环的典型执行所涉及的行、列和单元格计数，您可以通过分解在此代码行中隐式实例化的迭代器来节省内存：

```
 for (final Optional<SimpleWorkDataValue> columnKey : columnKeys) { 
```

由于此 Iterable 在整个过程中不会更改，因此您可以在开始时将列键复制到 List 中，然后在内部循环中对其进行迭代：

```
 final List<Optional<SimpleWorkDataValue>> columnKeyList =
        ImmutableList.copyOf(table.columnKeySet());
    for (final SimpleWorkDataValue timeSeriesValue : timeSeriesValues) {
        final Optional<SimpleWorkDataValue> rowKey = Optional.of(timeSeriesValue);
        for (final Optional<SimpleWorkDataValue> columnKey : columnKeyList) {
            if (!table.contains(rowKey, columnKey)) {
                table.put(rowKey, columnKey, ResultSet.EMPTY);
            }
        }
    } 
```

而且，当然，这应该消除所有 ConcurrentModificationExceptions

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:47:27.657

详细说明我的评论：

```
//a temporary table
Table<Optional<SimpleWorkDataValue>, Optional<SimpleWorkDataValue>, Object> temp =
    HashBasedTable.create();

for (final SimpleWorkDataValue timeSeriesValue : timeSeriesValues) {
    final Optional<SimpleWorkDataValue> rowKey = Optional.of(timeSeriesValue);
    for (final Optional<SimpleWorkDataValue> columnKey : columnKeys) {
        if (!table.contains(rowKey, columnKey)) {
 //here add to temp instead of table
            temp.put(rowKey, columnKey, ResultSet.EMPTY);
        }
    }
}

//after loop, put everyting back into table
table.putAll(temp); 
```

# c# - 如何在 PropertyGrid 对象的集合编辑器中自定义描述？

> ID：15800029
> 
> 赞同：3
> 
> 时间：2013-04-03T23:28:13.587
> 
> 标签：c#, winforms, propertygrid, collectioneditor

我有一个包含几个公共属性的类。其中一个属性是包含另一个类的实例的列表。它分解了这样的东西：

```
namespace Irig106Library.Filters.PCM
{
    [Description("Definition")]
    public class MinorFrameFormatDefinition
    {
        [Description("Word Number")]
        public int WordNumber { get; set; }

        [Description("Number of Bits")]
        public int NumberOfBits { get; set; }
    }

    public class MinorFrame
    {
        // ... other properties here

        [Category("Format")]
        [Description("Minor Frame Format Definitions")]
        public List<MinorFrameFormatDefinition> MinorFrameFormatDefinitions { get; set; }
    }
} 
```

我有一个[PropertyGrid](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx)对象，它编辑 Minor Frame 对象。它有一个包含对对象集合的引用的字段`MinorFrameFormatDefinition`。当我单击此字段中的按钮以打开集合编辑器并单击添加按钮时，我得到以下信息：

![在此处输入图像描述](https://i.stack.imgur.com/7ImQk.png)

如何让集合编辑器用`Definition`而不是标记对象`Irig106Library.Filters.PCM.MinorFrameFormatDefinition`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T07:14:11.513

您可以像这样覆盖 ToString()

```
public class MinorFrameFormatDefinition
{
    [Description("Word Number")]
    public int WordNumber { get; set; }

    [Description("Number of Bits")]
    public int NumberOfBits { get; set; }

    public override string ToString()
    {
        return "hello world";
    }
} 
```

或者如果你不想改变类，你也可以在它上面定义一个 TypeConverter：

```
[TypeConverter(typeof(MyTypeConverter))]
public class MinorFrameFormatDefinition
{
    [Description("Word Number")]
    public int WordNumber { get; set; }

    [Description("Number of Bits")]
    public int NumberOfBits { get; set; }
}

public class MyTypeConverter : TypeConverter
{
    public override object ConvertTo(ITypeDescriptorContext context, CultureInfo culture, object value, Type destinationType)
    {
        if (destinationType == typeof(string))
            return "hello world";

        return base.ConvertTo(context, culture, value, destinationType);
    }
} 
```

# python - 对用户在 EPD 特征视图中按下的按钮做出反应？

> ID：15800040
> 
> 赞同：0
> 
> 时间：2013-04-03T23:29:16.627
> 
> 标签：python, traits, enthought, traitsui

我将 EPD 特征用于基本的 GUI 界面。我可以使用如下代码弹出一个设置窗口：

```
settings_w.configure_traits(kind="livemodal") 
```

该窗口有“确定”和“取消”按钮，我想做一些不同的事情，具体取决于按下哪个按钮退出窗口。似乎它应该很简单，但我不知道如何设置它。

理论上我想做这样的事情：

```
# Display the settings widget
settings_w.configure_traits(kind="livemodal")

if settings_w.CancelButtonPressed:
    pass
else:
    print "I got the input" 
```

但是让我知道是否有更好或更正确的方法来做到这一点。

FWIW：这是我的设置窗口的视图属性，带有标准的确定和取消按钮：

```
view = View( 
    settings_group, 
    title   = 'Settings Editor',
    width = 500,
    buttons = [OKButton, CancelButton, 'Help' ],
    kind = 'modal',
    handler = SaveRestore_Handler()
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T05:38:41.633

如果我理解这个问题，检查的输出`configure_traits`应该做你想做的事：

```
result = settings_w.configure_traits(kind="livemodal")

if result:
    print "The user pressed OK."
else:
    print "The user pressed Cancel or closed the window." 
```

# vba - 使用 vba name 语句将 xls 转换为 xlsx 会损坏文件

> ID：15800044
> 
> 赞同：1
> 
> 时间：2013-04-03T23:29:36.597
> 
> 标签：vba, excel, rename, corrupt

我正在尝试使用以下代码将文件重命名`abcd.xls`为`xyz.xlsx`-

```
 NumOfAttachments = Range("RecCount").Value
  DestinationFolderPath = Range("destinationfolder").Value
  NewShtName = "Sheet1"

  If NumOfAttachments <> 0 Then
    For X = 0 To NumOfAttachments - 1
      OrigName = Range("Startcell").Offset(X, 1).Value
      NewName = Range("startcell").Offset(X, 2).Value
      SourceFolderPath = Range("startcell").Offset(X, 3).Value
      NewFile = DestinationFolderPath & NewName
      If Dir(DestinationFolderPath & OrigName) <> "" Then Kill DestinationFolderPath & OrigName
      FileCopy SourceFolderPath & OrigName, DestinationFolderPath & OrigName

      If Dir(NewFile) <> "" Then Kill NewFile
      Name DestinationFolderPath & OrigName As NewFile 
```

在此之后，当我尝试打开文件（`xyz.xlsx`）时，我收到以下错误 -

`excel cannot open the file xyz.xlsx because the file format or file extension is not valid`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-03T23:33:40.143

原因很简单。您没有使用正确的文件格式。

您的`.SaveAs`代码应如下所示

```
.SaveAs "\myserver\test\xyz.xlsx", FileFormat:=51 
```

有关文件格式，请参见下表

```
50 = xlExcel12 (Excel Binary Workbook in 2007-2010 with or without macro's, xlsb)
51 = xlOpenXMLWorkbook (without macro's in 2007-2010, xlsx)
52 = xlOpenXMLWorkbookMacroEnabled (with or without macro's in 2007-2010, xlsm)
56 = xlExcel8 (97-2003 format in Excel 2007-2010, xls) 
```

会推荐这个[链接](http://msdn.microsoft.com/en-us/library/office/ff841185.aspx)

# json - 创建 Reads for Play 2.1 时出现类型不匹配错误

> ID：15800051
> 
> 赞同：2
> 
> 时间：2013-04-03T23:30:01.053
> 
> 标签：json, scala, playframework-2.1

我已经玩了几个小时了。我一直在尝试不同的方法来创建阅读，但我完全被难住了。

我在`Play 2.1.0`和`Scala 2.10.1`

**错误：**

```
type mismatch; found : models.Registration.type required: play.api.libs.json.Reads[?] 
```

**代码：**

```
package models

import play.api.libs.json._
import play.api.libs.functional.syntax._

case class Registration(
        user: (String,String,String,String,String,String)
)

object RegistrationHelper {
    implicit val regReads: Reads[Registration] = (
      (__ \ "user").read(
        (__ \ "id").read[String] and
        (__ \ "username").read[String] and
        (__ \ "first_name").read[String] and
        (__ \ "last_name").read[String] and
        (__ \ "email_address").read[String] and
        (__ \ "user_avatar").read[String]
        tupled
      )
    )(Registration) //!!ERROR ON THIS LINE
} 
```

**JSON：**

```
{
  user: {
    id: "35fc8ba5-56c3-4ebe-9a21-489a1a207d2e",
    username: "flastname",
    first_name: "Firstname",
    last_name: "Lastname",
    email_address: "foo@bar.com",
    user_avatar: "http://blog.ideeinc.com/wp-content/uploads/2010/04/tineye-robot.jpg"
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T03:44:39.137

这应该有效：

```
implicit val regReads: Reads[Registration] = (__ \ "user").read(
    (__ \ "id").read[String] and
      (__ \ "username").read[String] and
      (__ \ "first_name").read[String] and
      (__ \ "last_name").read[String] and
      (__ \ "email_address").read[String] and
      (__ \ "user_avatar").read[String]
      tupled
  ) map Registration.apply _ 
```

有关更多信息，请参阅[此](https://stackoverflow.com/questions/15042205/how-to-serialize-deserialize-case-classes-to-from-json-in-play-2-1)问题。

# php - PHP：排序/搜索具有 2 个键的数据（或由子数组键组成的数组数组）？

> ID：15800052
> 
> 赞同：1
> 
> 时间：2013-04-03T23:30:10.067
> 
> 标签：php, arrays, sorting, search, multidimensional-array

我已经打了几次，但从未找到解决它的最佳方法。用一个具体的例子来说明是最容易的。样本数据：

```
product_id     display_name         display_order
----------     ------------         -------------
"samgal3"      "Samsung Galaxy 3"        0
"motorazrh"    "Motorola Razr HD"        1
"iphone5"      "Apple iphone 5"          2

etc 
```

实际的数组通常很小（<20 项），但并非总是如此，并且保证了唯一的键/值。每个项目都有一个唯一的排序键（它列出的顺序，用于 html 表/枚举）、一个唯一的内部键（用于项目查找）和一个人类可读的显示名称。

通常，当在表单上使用选项列表时，我会遇到这个问题。相同的数据既用于填充表单上的下拉框，也用于验证提交的 $GET/POST 数据。生成表单时，需要按“排序”顺序对其进行枚举/列出，以按顺序创建 SELECT 框选项。提交表单时，需要通过“product_id”对其进行搜索（以验证“...&action=view&product_id=elephant...”是列表中的产品）。

如果我使用 'sort'=>array(other data) 作为键，那么通过 'sort' 显示很容易，但在 $data[ *** ]['product_id'] 中搜索很难 *（即识别 $KEY 如果它存在，有 $data[$KEY]['product_id'] == 'htcvox')*. 如果我使用 'product_id'=>array(other data) 作为键，那么搜索 'samgal3' 是否在数组中并找到它的数据很容易，但是没有简单的方法可以通过 'sort' 遍历/枚举数组来创建形式。

我想我可以进行自定义搜索/排序，其中 $data 中任何成员 $i 的搜索/排序键是 $i['product_id'] 或 $i['sort'] 但它很笨拙，我从来没有做过前。简单性很重要，因为代码将是开源的。

我期望将数据编码为数组数组，如下所示：

```
$data = array(
    0 => array('product_id'=>'samgal3',   'display_name' => 'Samsung Galaxy 3'),
    1 => array('product_id'=>'motorazrh', 'display_name' => 'Motorola Razr HD'),
    ... 
```

或者

```
$data = array(
    'samgal3'   => array('sort'=>0, 'display_name' => 'Samsung Galaxy 3'),
    'motorazrh' => array('sort'=>1, 'display_name' => 'Motorola Razr HD'),
    ... 
```

给定一个二维数组，以不同的方式提出相同的问题：**$data = array(array1, array2, array3, ....);** 其中所有的array1、array2、array3，...都包含一个具有固定名称的键/字段，是否有一种简单的方法可以在 $ARRAY[ *** *]['named_field'] 上搜索/排序嵌套数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:36:56.827

使用[http://www.php.net/usort](http://www.php.net/usort)生成自定义的用户定义排序。

例子：

```
<?php
//added a few more values
$data = array(
    0 => array('product_id'=>'samgal3',   'display_name' => 'Samsung Galaxy 3'),
    1 => array('product_id'=>'motorazrh', 'display_name' => 'Motorola Razr HD'),
    2 => array('product_id'=>'a', 'display_name' => 'a'),
    3 => array('product_id'=>'c', 'display_name' => 'c'),
    4 => array('product_id'=>'d', 'display_name' => 'd'),
    5 => array('product_id'=>'b', 'display_name' => 'b'),
    6 => array('product_id'=>'q', 'display_name' => 'q'),
    7 => array('product_id'=>'f', 'display_name' => 'f'),
);

function cmp($a,$b){
    return strcasecmp($a['display_name'],$b['display_name']);
}

usort($data,'cmp');
var_export($data); 
```

[http://codepad.viper-7.com/3mY8nU](http://codepad.viper-7.com/3mY8nU)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:37:57.480

您想要的本质上是将多个索引放入单个数组中，就像您在关系数据库中的单个表上有多个索引一样。（排序是一个单独但相关的问题。）

让我们从这个基本的数据结构开始，一组简单的数组，对键没有特别的重要性：

```
$data = array(
    array('display_order'=> 0, 'product_id'=>'samgal3',   'display_name' => 'Samsung Galaxy 3'),
    array('display_order'=> 1, 'product_id'=>'motorazrh', 'display_name' => 'Motorola Razr HD'),
    array('display_order'=> 2, 'product_id'=>'a', 'display_name' => 'a'),
    array('display_order'=> 3, 'product_id'=>'c', 'display_name' => 'c'),
    array('display_order'=> 4, 'product_id'=>'d', 'display_name' => 'd'),
    array('display_order'=> 5, 'product_id'=>'b', 'display_name' => 'b'),
    array('display_order'=> 6, 'product_id'=>'q', 'display_name' => 'q'),
    array('display_order'=> 7, 'product_id'=>'f', 'display_name' => 'f'),
); 
```

您可以轻松创建显式索引，然后使用它来获取`$data`项目：

```
$product_id_idx = array_flip(array_map(function($item){return $item['product_id'];}, $data));
$samgal3_array = $data[$product_id_idx['samgal3']]; // same as $data[0] 
```

对于排序，您可以使用 oft-forgotten [`array_multisort`](http://www.php.net/manual/en/function.array-multisort.php)。查看文档中的示例 3。诀窍是创建数组以进行排序，并将完整的数据集作为最后一个参数。例如：

```
array_multisort(array_keys($product_id_idx), SORT_ASC, SORT_STRING, $data); 
```

`$data`现在按产品密钥排序。然而，原来的数字数组键`$data`丢失了，这意味着我们`$product_id_idx`的不再可用。因此，如果您想继续使用索引，最好对数据数组的*副本进行排序。*

我们可以将这两种方法组合到一个类中以保持我们的理智：

```
class MultiIndex {

    protected $array;
    protected $indexes = array();
    protected $indexdefs = array();

    function __construct($array, $indexdefs)
    {
        $this->array = $array;
        $this->indexdefs = $indexdefs;
        foreach ($indexdefs as $name => $column) {
            $this->indexes[$name] = $this->makeIndex($column);
        }
    }

    function makeIndex($column)
    {
        $index = array();
        foreach ($this->array as $k => $v) {
            $index[$v[$column]] = $k;
        }
        return $index;
    }

    function get($key, $index=null)
    {
        $datapk = ($index===null) ? $key : $this->indexes[$index][$key];
        return $this->array[$datapk];
    }

    function getIndex($index)
    {
        return $this->indexes[$index];
    }

    function getData()
    {
        return $this->array;
    }
    function indexedBy($index)
    {
        $indexed = array();
        $indexedcolumn = $this->indexdef[$index];
        foreach ($this->indexes[$index] as $indexk => $arrayk) {
            $newarray = $this->array[$arrayk];
            unset($newarray[$indexedcolumn]);
            $indexed[$indexk] = $newarray;
        }
        return $indexed;
    }

    function sortedBy(/*multisort args*/)
    /* with strings converted to arrays corresponding to index of same name */
    {
        $args = func_get_args();
        foreach ($args as $n => $arg) {
            if (is_string($arg)) {
                $args[$n] = array_keys($this->indexes[$arg]);
            }
        }
        $sorted = $this->array;
        $args[] = $sorted;
        call_user_func_array('array_multisort', $args);
        return $sorted;
    }
} 
```

使用示例：

```
$dataidx = new MultiIndex($data, array('id'=>'product_id', 'disp'=>'display_order'));
var_export($dataidx->sortedBy('disp', SORT_STRING, SORT_ASC));
var_export($dataidx->indexedBy('id'));
var_export($dataidx->get('samgal3', 'id')); 
```

这应该是一个非常基本的基础，对于小型阵列应该没问题。为简单起见`MultiIndex`，数据是不可变的，键始终是数组索引。一些明显的增强方法是：

1.  使`$indexdefs`accept 成为一个可调用的，它返回一个项目的键，而不仅仅是一个字符串/int 命名一个数组键。这允许您在任何形状的数据上创建索引，甚至可以创建与数据不直接对应的索引。（例如，按显示名称中的字符数索引，或按保持日期和时间分开的数组的日期+时间等进行索引）
2.  删除索引键只有一个值的要求。（现在假设您创建的所有索引都是唯一的。）
3.  允许您为索引声明`SORT_*`数据类型并将其自动包含在 in 的参数`array_multisort`中`MultiIndex::sortedBy()`。
4.  包括稀疏索引：如果您有非常常见或非常稀有的值，或者只是有一个非常大的数据集并且您想节省内存，您可以将其设置为仅对某些值进行索引。如果在索引中未找到某个项目，则回退到对数据中未编制索引的项目进行全面扫描。
5.  添加[合理的接口实现](http://www.php.net/manual/en/reserved.interfaces.php)。
6.  允许`MultiIndex`有多个后端，因此您可以在任何类似数组的结构（例如，dbm 键值存储、像 DynamoDB、memcached 等云存储）上拥有多个索引，并使用相同的对象接口操作它们。
7.  `MultiIndex`保持可变数据并随着数据的变化自动增量更新索引。

我将把这段代码放在一个[要点](https://gist.github.com/favila/5306999)上，以便于分叉。

# html - 导航栏与 CSS 中的其他元素混淆

> ID：15800054
> 
> 赞同：0
> 
> 时间：2013-04-03T23:30:22.747
> 
> 标签：html, css, xhtml, lightbox

您好，我有一个运行良好的导航栏。然后我添加了灯箱效果。两者都可以完美地工作，但是在我的 css 中它们搞砸了。当我向 div 添加一些 css 到灯箱效果时，它会弄乱我的导航栏。我认为它与`a`标签有关。我的代码如下

**html:**

```
<div id="nav">
            <ul>
                <li><a href="#home">Home</a></li>
                <li><a href="#news">Regsiter</a></li>
                <li><a href="#contact">Rules</a></li>
                <li><a href="#about">Photo's</a></li>
                <li><a href="#about">Contact Us</a></li>
            </ul> 
</div>

<div class = "lightbox">
     <a href="images/image1.jpg" rel="lightbox[group]"><img src="images/image1t.jpg" /></a>
     <a href="images/image2.jpg" rel="lightbox[group]"><img src="images/image2t.jpg" /></a>
     <a href="images/image3.jpg" rel="lightbox[group]"><img src="images/image3t.jpg" /></a>
     <a href="images/image4.jpg" rel="lightbox[group]"><img src="images/image4t.jpg" /></a>
     <a href="images/image5.jpg" rel="lightbox[group]"><img src="images/image5t.jpg" /></a>
     <a href="images/image6.jpg" rel="lightbox[group]"><img src="images/image6t.jpg" /></a>
</div> 
```

**CSS：**

```
#nav ul
{
    list-style-type:none;
    margin:0;
    padding:0;
    overflow:hidden;
}

#nav ul li
{
    float:left;
}

#nav a:link,a:visited
{
    display:block;
    width:163.2px;
    height: 35px;
    font-weight:bold;
    color:#FFFFFF;
    background-color:#181818;
    text-align:center;
    text-decoration:none;
    text-transform:uppercase;
    line-height: 35px;
}

#nav ul li a:hover
{
    background-color:#989898;
} 
```

//下面是灯箱CSS

```
a
{
    border:3px solid #ccc;
    display:block;
    float:left;
    margin:10px;
}

a img
{
    margin:3px;
}

a:hover
{
    border:3px solid #666;
}
img
{
        display:block;
} 
```

就像我说的。如果我删除灯箱 CSS 导航栏工作正常。当我添加它时，导航栏上的边框和一切都会改变。我认为这与他们都有`a`标签但不确定。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:32:28.640

仅将灯箱 CSS 应用于灯箱内的元素：

```
.lightbox a{
  border:3px solid #ccc;
  display:block;
  float:left;
  margin:10px;
}

.lightbox a img{
  margin:3px;
}

.lightbox a:hover{
  border:3px solid #666;
}
.lightbox img{
  display:block;
} 
```

演示： http: [//jsfiddle.net/42BjW/](http://jsfiddle.net/42BjW/)（我没有灯箱JS，所以显然灯箱本身不起作用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:34:07.063

只需`.lightbox`在您以后的课程前面添加灯箱 css

# python - Python 脚本错误

> ID：15800056
> 
> 赞同：1
> 
> 时间：2013-04-03T23:30:44.937
> 
> 标签：python

我有这个脚本，我毫不怀疑它是有缺陷的：

```
import fnmatch, os, sys
def findit (rootdir, find, pattern):
    for folder, dirs, files in os.walk(rootdir):
        print (folder)
    for filename in fnmatch.filter(files,pattern):          
        with open(filename) as f:
            s = f.read()
            f.close()
            if find in s :                  
                print(filename)

findit(sys.argv[1], sys.argv[2], sys.argv[3]) 
```

当我运行它时，我得到`Errno2, no such file or directory`. 但是该文件存在。例如，如果我通过 go 执行它：`findit.py c:\python "folder" *.py`它会正常工作，列出所有包含“文件夹”一词的 *.py 文件。但是如果我去`findit.py c:\php\projects1 "include" *.php`

作为一个例子，我得到`[Errno2] no such file or directory: 'About.php'`（例如）。但是 About.php 存在。我不明白它在做什么，或者我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:43:10.097

如果您查看 的任何示例[`os.walk`](http://docs.python.org/3/library/os.html#os.walk)，您会发现它们都可以`os.path.join(root, name)`。你也需要这样做。

为什么？引用文档：

> `filenames`是 dirpath 中非目录文件的名称列表。请注意，列表中的名称不包含路径组件。要获取 dirpath 中文件或目录的完整路径（以 top 开头），请执行`os.path.join(dirpath, name)`.

如果只使用文件名作为路径，它将在当前工作目录中查找同名文件。如果没有这样的文件，你会得到一个`FileNotFoundError`. 如果有*这样*的文件，您将打开并读取错误的文件。只有当您碰巧正在查看当前工作目录时，它才会起作用。

* * *

您的代码中还有另一个主要问题：`os.walk`递归遍历目录树，查找给定`top`目录中的所有文件，或 的任何子目录`top`，或...的任何子目录，依此类推，为每个目录产生一次。但是你没有做任何有用的事情（除了打印出文件夹）。相反，您等到它完成，然后使用`files`它碰巧最后到达的目录。

如果您只想直接在目录中获取文件的平面列表，请使用[`os.listdir`](http://docs.python.org/3/library/os.html#os.listdir)，而不是`os.walk`. （或者也许使用[`glob.glob`](http://docs.python.org/3/library/glob.html#glob.glob)而不是显式列出所有内容然后使用过滤`fnmatch`。）

另一方面，如果您想在树上行走，则必须将第二个循环移到`for`第一个循环内。

* * *

您还有一个小问题：您`f.close()`在 a 内部调用`with open(…) as f:`，这导致`f`被关闭两次。这保证是完全无害的（至少在 2.5+ 中，包括 3.x），但这仍然是一个坏主意。

* * *

放在一起，这是您的代码的工作版本：

```
def findit (rootdir, find, pattern):
    for folder, dirs, files in os.walk(rootdir):
        print (folder)
        for filename in fnmatch.filter(files,pattern):
            pathname = os.path.join(folder, filename)
            with open(pathname) as f:
                s = f.read()
                if find in s:
                    print(pathname) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:36:15.160

您正在使用相对文件名。但是您的当前目录不包含该文件。而且你也不想在那里搜索。使用 os.path.join(folder, filename) 创建绝对路径。

# html - 自动对焦仅适用于页面刷新

> ID：15800058
> 
> 赞同：4
> 
> 时间：2013-04-03T23:30:56.980
> 
> 标签：html, forms, autofocus

我有一个弹出窗口中的表单，我已经设置了 autofocus 属性`autofocus="autofocus"`，但是当表单加载时它没有聚焦但是如果你刷新页面它会聚焦。表单被插入到`div`.

表格样本：

```
First Name:<input type="text" name="fname" placeholder="First Name" class="userField" autofocus="autofocus" id="firstNameUserField" value="<?php 
    if(isset($_SESSION['firstname'])){
       echo trim($_SESSION['firstname']);
    }
  ?>"> 
```

div表单插入：

```
 <div class="main">
    <a href="#x" class="overlay" id="detail_form"></a>
    <div class="popup">
      <div id="detailFormPopup"></div>
      <a class="close" id="logClose"href="#close"></a>
    </div>
  </div> 
```

如果用户登录并单击其用户名，则会显示表单：

```
if(isset($_SESSION['username'])){
          echo "<a href='#detail_form' class='navlinks' id='navUser'>".$_SESSION['username']."</a></h3>";
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-07-09T10:07:02.710

解决“自动对焦只在页面刷新时起作用”的问题

在您的文件中进行以下更改：-

```
//In module.ts file 

import { AutofocusModule } from 'angular-autofocus-fix';

@NgModule({
imports: [
AutofocusModule
],

//In package.json file add the dependencies as:- 

    "dependencies": {
    "angular-autofocus-fix": "^0.1.0"
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T23:45:33.120

`autofocus`将仅适用于页面中最初的元素，而不适用于使用 Javascript 加载的元素。

您可以在用于呈现 SimpleModal 的 Javascript 代码中强制获得焦点，将其添加到`onShow`事件中：

```
$('#firstNameUserField').focus(); 
```

您没有在问题中包含用于打开弹出窗口的 Javascript，因此这只是一个一般示例：

```
$("#popupEl").modal({onShow: function (dialog) {
 $('#firstNameUserField').focus();
}}); 
```

# php - 如何使用 usort() 按时间戳对 2 个数组进行排序

> ID：15800060
> 
> 赞同：0
> 
> 时间：2013-04-03T23:31:14.820
> 
> 标签：php, sorting, usort

我需要使用时间戳在 2 个数组之间进行排序`usort()`。下面的源代码将向您展示我所拥有的，以及我需要合并到源代码中的内容，我必须按时间戳对 2 个数组进行排序`usort()`。

忽略我的 php.ini 中的`db_open`,`db_query`​​ ,`db_fetch_all`函数。这些是我设置为捷径的功能。

**这是我为获取信息和合并 2 个数组而构建的内容。**

```
$db = db_open();

$query = "
SELECT postings.posting_id, postings.timestamp AS posting_timestamp, users.user_name, groups.group_name FROM groups 
LEFT JOIN postings 
ON postings.group_id = groups.group_id 
LEFT JOIN users 
ON postings.user_id = users.user_id 
WHERE groups.user_id = '".$_SESSION['user']['user_id']."' 
AND postings.user_id != '".$_SESSION['user']['user_id']."'";

$result = db_query($db, $query);
$result1 = db_fetch_all($result);

$query = "SELECT postings.posting_headline, comments.timestamp AS comment_timestamp, users.user_name 
FROM postings 
LEFT JOIN comments 
ON comments.posting_id = postings.posting_id 
LEFT JOIN users 
ON comments.user_id = users.user_id WHERE postings.user_id = '".$_SESSION['user']['user_id']."' 
AND comments.user_id != '".$_SESSION['user']['user_id']."'";

$result = db_query($db, $query);
$result2 = db_fetch_all($result);

$result = array_merge((array)$result1, (array)$result2); 
```

**这是我需要在上面的源代码中合并的内容，以按时间戳对数组进行排序。问题是，我该怎么做？** 另外，我不确定是什么`$a`和`$b`是。有人可以解释他们从我的查询中得到什么吗？

```
function cmp($a, $b)
{
    if ($a == $b) {
        return 0;
    }
    return ($a < $b) ? -1 : 1;
}

$a = array(3, 2, 5, 6, 1);

usort($a, "cmp");

foreach ($a as $key => $value) {
    echo "$key: $value\n";
} 
```

有关 usort 的更多信息：[http ://www.php.net/manual/en/function.usort.php](http://www.php.net/manual/en/function.usort.php)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:36:58.600

这个正在使用 usort()

```
 function cmp($a, $b)
    {
        if ($a[2] == $b[2]) {
            return 0;
        }
        return ($a[2] < $b[2]) ? -1 : 1;
    } 
```

另一种方法是使用array_multisort：

```
foreach ($array as $key => $node) {
   $timestamps[$key]    = $node[2];
}
array_multisort($timestamps, SORT_ASC, $array); 
```

# r - 引用 R 中的上一行应用

> ID：15800062
> 
> 赞同：3
> 
> 时间：2013-04-03T23:31:29.957
> 
> 标签：r

有没有办法`apply`在 R 中引用 's 中的前一行？

比如我`data.frame`是按日期顺序排序的，我想找出上一行的日期和当前行的日期之间的差异。这在循环中很容易。

```
for( i in 2:nrow(Y)) {
      Y[i,]$window =  as.numeric(as.Date( Y[i, ]$start_date )  -  
                         as.Date( Y[i-1, ]$end_date ))
} 
```

我可以使用应用来执行此操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:35:07.017

尝试使用`head`（或`tail`）

```
Y$window <- as.numeric(c(NA, as.Date(tail(y$start.date,-1)) - as.Date(head(y$end.date,-1)) )) 
```

# winapi - ResEdit x64 Winapi 删除手动创建的 ID

> ID：15800067
> 
> 赞同：1
> 
> 时间：2013-04-03T23:31:53.197
> 
> 标签：winapi, resources, editor

我正在使用 ResEdit x64 创建对话框和资源。但是当我想像按钮一样手动添加资源，然后我编辑说，另一个带有 resedit 的对话框，然后我保存文件，resedit 删除了我手动创建的 ID。

是否可以使用 resedit 来编辑我的主窗口？我只看到对话框的选项。

有人建议解决此问题，或其他免费资源编辑器吗？

# xcode - 在 Xcode 中调试时可以更改当前的执行行吗？

> ID：15800077
> 
> 赞同：2
> 
> 时间：2013-04-03T23:33:19.820
> 
> 标签：xcode, debugging

调试器让我拖动小绿线指针，但它似乎根本没有效果，当我踩它时，它的行为就像我从未拖动它一样。

只是想知道错误是否是：

*   它没有正确更改当前执行指针，或者
*   它让我可以完全拖动它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-06-08T00:37:54.577

Xcode 从能够从左侧拖动指令指针更改为全新的可视项并将其移动到最右侧。

汉堡图标（如下图所示）实际上是当前指令指针的拖动手柄。

[![在此处输入图像描述](https://i.stack.imgur.com/54k4k.jpg)](https://i.stack.imgur.com/54k4k.jpg)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T05:33:27.473

> 在 Xcode 中调试时可以更改当前的执行行吗？

**是的，它可以改变。**

在您跨步之后，它可以工作，但从下一次单击开始。

看这个例子：

假设绿色箭头在“a”中

```
>>  NSLog(@"a");
    NSLog(@"b");
    NSLog(@"c");
    NSLog(@"d");
    NSLog(@"e");
    NSLog(@"f"); 
```

它会进入一些堆栈，当您“跨步”时将打印这些堆栈。然后它移动到“b”。

作为：

```
 NSLog(@"a");
>>  NSLog(@"b");
    NSLog(@"c");
    NSLog(@"d");
    NSLog(@"e");
    NSLog(@"f"); 
```

然后“b”进入堆栈，它会被打印出来。现在通过拖动将 >> 更改为“e”，如下所示：

```
 NSLog(@"a");
    NSLog(@"b");
    NSLog(@"c");
    NSLog(@"d");
>>  NSLog(@"e");
    NSLog(@"f"); 
```

现在“b”将被打印出来，指针将移动到下一条语句，即“e”。

如果您再次向后或向前移动它，它会改变它的位置，但会打印“e”，因为它已经保存在一些准备打印的堆栈中。

# c# - 阻止从 win 表单访问屏幕

> ID：15800081
> 
> 赞同：0
> 
> 时间：2013-04-03T23:33:32.610
> 
> 标签：c#, .net, windows, winforms

我有一个在执行特定操作后弹出的获胜表格。我希望它以屏幕为中心，锁定对任何其他窗口的访问，直到表单关闭。

基本上保持在顶部，无法访问其他表格。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:36:57.467

您正在寻找的是模态表单：[显示模态和无模态 Windows 窗体](http://msdn.microsoft.com/en-us/library/aa984358%28v=vs.71%29.aspx)

```
Form1 form1 = new Form1();
/* Calling ShowDialog instead of Form.Show() will force
* the user to close that form first */
form1.ShowDialog(); 
```

**更新 1：**

[如果您正在像Workrave](http://www.workrave.org/)软件一样寻找系统范围的阻塞，可以执行以下操作：

*   创建一个没有边框的窗口，最大化并使边框（在您的情况下非常大）透明。在这个窗口的中间会有你的伪对话框。

*   同样，人们会截取屏幕截图并以该形式显示，但如果有一些屏幕活动，您将看不到屏幕活动。

Workrave 阻塞活动示例：

![在此处输入图像描述](https://i.stack.imgur.com/eALSb.png)

除非您跳过/推迟休息时间，否则您无法在桌面上执行任何操作。

注意：*Workrave 是一项有助于恢复和预防重复性劳损 (RSI) 的计划。该程序经常提醒您进行微暂停、休息时间并将您限制在每日限制范围内。*（来自他们的网站）

**更新 2：** 由于 Wrokrave 是开源的，因此可以浏览代码以查看他们是如何实现该阻塞系统的：http: [//sourceforge.net/projects/workrave/](http://sourceforge.net/projects/workrave/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:36:42.190

你可以使用：

```
YourForm.ShowDialog(). 
```

ShowDialog 不允许访问后台表单，除非当前表单已关闭。

# ruby-on-rails - :confirm in rails not working

> ID：15800092
> 
> 赞同：17
> 
> 时间：2013-04-03T23:34:07.130
> 
> 标签：ruby-on-rails, link-to, button-to

我刚开始使用 ruby​​ on rails 进行编码，我一直在遵循一个指南，该指南使用的 rails 版本比我使用的更过时。我正在使用 3.2.12

这是我的代码：

```
<%= button_to 'Destroy', product, :method => "delete", :confirm => 'Are you sure?'  %> 
```

据我了解，这些是传递给 rails 的符号，然后将其转换为 html 或 javascript 操作，然后弹出消息框并删除对象（如果适用）。上面的代码销毁了对象，但是并没有弹出确认框。为什么是这样？另外，我最初有以下内容：

```
<%= link_to 'Destroy', product, :method => "delete", :confirm => 'Are you sure?'  %> 
```

在任何情况下都不会弹出确认框，使用 link_to 或 button_to。下面是使用 Chrome 的检查器检查时呈现的 html。jquery 和 jquery-ujs 也被加载到了，所以我不确定从这里去哪里。

```
<input name="_method" type="hidden" value="delete">
<input data-confirm="Are you sureeee?" type="submit" value="Destroy">
<input name="authenticity_token" type="hidden" value="Q2xicqELHYHtrwarbtPBe5PT2bZgWV5C+JdcReJI8ig="> 
```

谢谢！

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2014-12-10T17:24:33.313

我必须在 data 属性中添加我的确认属性才能使其工作。我正在使用带有引导程序的 Rails 4。我希望这可以帮助遇到这个问题的其他人。

```
link_to 'Delete', @rule, method: :delete, data: { confirm: 'Are you sure you want to delete this alert?' } 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-04T00:17:22.427

这依赖于 jQuery，请确保您具有以下内容：

在你的 Gemfile

```
group :assets do
  gem 'jquery-rails'
end 
```

在您的 assets/javascripts/application.js 文件中，在该行之前`//= require_tree .`

```
//= require jquery
//= require jquery_ujs 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-04T01:10:52.273

link_to 和 button_to 的区别在于 HTTP 动词。link_to 发出 GET 请求，而 button_to 发出 POST 请求。使用 RESTful 路由，操作是对*controller/id*`delete`的 POST 请求。*如果您向controller/id*发出 GET ，它将被分派给操作。**`show`**

 **AIUI，link_to 与 GET 动词以外的任何内容都是一个坏主意。一，右键单击不保留动词。`delete`第二，即使您可能需要登录才能实际修改数据库，您也不希望爬取页面的机器人跟随链接从而触发操作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-05T02:53:48.417

感觉很笨，但 adblock 阻止了消息框。对于那个很抱歉。现在一切都很好，我只是禁用了adblock。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-27T22:35:28.043

我有一个在 Chrome 中运行的弹出窗口阻止程序。我刚刚列入白名单`http://localhost:3000`，它对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-09T11:18:14.990

如果你想在 rails 7 中删除带有确认框的东西，你可以试试这个：

与`button_to`（更喜欢恕我直言）：

```
<%= button_to 'Destroy', product, method: :delete,
  form: {data: {turbo_confirm: 'Are you sure?'}} %> 
```

`POST`这将呈现一个 HTML 表单标签，该标签在提交时（确认后）发送请求，但具有`_method`带有“删除”值的隐藏属性。因此，rails 会将此请求视为具有`DELETE`方法。

它将被路由到`products#destroy`（或您的路由所说的任何内容）。

与`link_to`：

```
<%= link_to 'Destroy', product,
  data: {turbo_method: :delete, turbo_confirm: 'Sure?'} %> 
```

这将呈现一个带有和属性的简单`a`标签。单击此链接将触发一个确认框，如果选择“确定”，将发送一个真实的请求。`data-turbo-method``data-turbo-confirm``DELETE`

如果您想`destroy`在控制器中使用 结束操作`redirect_to`，某些浏览器将使用方法重定向到新位置`DELETE`（导致错误），因此请确保添加`status: :see_other`参数，如[指南](https://guides.rubyonrails.org/getting_started.html#deleting-an-article)建议的那样。**

# ajax - 如何使用 AJAX 获得这种 jquery 滑动效果？

> ID：15800093
> 
> 赞同：-6
> 
> 时间：2013-04-03T23:34:27.070
> 
> 标签：ajax, jquery

我怎样才能用 AJAX 获得这个 jquery 滑动效果..

[http://livedemo00.template-help.com/wt_44012/index.html](http://livedemo00.template-help.com/wt_44012/index.html)

我在 google 中搜索，但总是出现滑动效果，通过从目的地的所有 div 传递过去。

任何人都知道如何滑出实际并直接通过所需的？

我知道正在使用 AJAX，但我还不能应用它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:40:27.663

有一个专门用于 SEM/SEO 的整个行业子部门。没有一种技术可以像魔术一样发挥作用。

以下是 Google 关于该主题的入门指南：

[http://static.googleusercontent.com/external_content/untrusted_dlcp/www.google.com/en/us/webmasters/docs/search-engine-optimization-starter-guide.pdf](http://static.googleusercontent.com/external_content/untrusted_dlcp/www.google.com/en/us/webmasters/docs/search-engine-optimization-starter-guide.pdf)

# javascript - 应用 xslt 样式表后，我可以使用 javascript 访问源 xml 吗？

> ID：15800095
> 
> 赞同：3
> 
> 时间：2013-04-03T23:34:54.707
> 
> 标签：javascript, html, dom

我可以从带有 xslt 样式表的 XML 实例文档创建 HTML 表单，以便在浏览器中运行。表单可以修改 XML 实例文档并将其发送回服务器。我的表格工作正常，但我觉得解决方案很草率。

我当前的解决方案：我在实例文档中设置样式表并让浏览器进行翻译。翻译后，我从表单运行 Javascript 以将 XML 文档*再次*加载到 Javascript var（XML DOM）中。为了发布表单数据，我使用 Javascript 从 HTML 文档（HTML DOM）中提取数据，更新 XML DOM，并使用 XMLHttpRequest 进行 POST。

我首选的解决方案：为了简化和优化，我宁愿从 HTML 文档中访问原始 XML DOM（在翻译之前必须存在的那个），这样我就不必再次加载 XML 实例文档。这似乎是可能的，因为当我从浏览器“查看源代码”时看到了原始 XML 文档。我已经使用 Firebug 搜索了在线和浏览器内部，但还没有发现任何魔法。

我的问题：有谁知道在应用 XSLT 样式表后 Javascript 是否可以从生成的 HTML DOM 访问原始 XML DOM？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-26T17:34:33.657

您只需修改您的 XSLT 以在 XHTML 输出中保留源 XML 的副本。要让任意标签进入 XHTML，请使用[此答案](https://stackoverflow.com/a/436176/1872046)中描述的技术。

# sql - Powershell SQL 查询结果转换为 XML

> ID：15800100
> 
> 赞同：2
> 
> 时间：2013-04-03T23:36:01.687
> 
> 标签：sql, sql-server, xml, powershell

我一直在努力解决这个问题。让我试着解释一下我想要完成的事情，我希望我能足够清楚。

我正在向 MSSQL 数据库发送两个查询并接收它们。下面的代码完美无缺，但是我想在 XML 写入 XML 文件之前稍微操作一下它的格式。我目前有 3 列（serviceGroupName、numAccounts、numDevices）我想完成两件事中的一件：

1）添加一个名为“ReportType”的新列，并根据它是通过foreach循环的第1个还是第2个来填写“Monthly”或“Total”（SQLQuery1是月度报告，SQLQuery2是自成立以来的总数）

2) 创建一个新的 PSObject 并让它填写适当的信息，例如它接收回来的数据 (serviceGroupName, numAccounts, numDevices)

以下是我当前的代码。正如我所提到的，它确实有效并且它生成了一个 XML，但如果可能的话，我想在管道之前添加一些更多信息到 ConvertTo-XML。

```
### Dates to use
$Date = (Get-Date -f MM-dd-yyyy)
$FDoTM = ((Get-Date -Day 01).AddMonths(0)).AddDays(0)
$LDo2PM = ((Get-Date -Day 01).AddMonths(-1)).AddDays(-1)
$TempDir = "C:\Temp"
$WebDir =     @("\\x.x.x.x\c$\inetpub\wwwroot\Reports\Accounts","\\x.x.x.x\c$\inetpub\wwwroot\Reports\Accounts")

### Something

$OutputXML = "$Date-Monthly-AccountReport.xml"

### Connection settings, uses windows authentication

$DBServer = "OMMITED"
$databasename = "OMMITED"
$Connection = new-object system.data.sqlclient.sqlconnection #Set new object to connect to sql database
$Connection.ConnectionString ="server=$DBServer;database=$databasename;trusted_connection=True" # Connectiongstring setting for local machine database with window authentication
Write-host "Connection Information:"  -foregroundcolor yellow -backgroundcolor black
$Connection #List connection information

### Connect to Database and Run Query

$SqlCmd = New-Object System.Data.SqlClient.SqlCommand #setting object to use sql commands

$OutputHeader1 = "This Month's counts"
$SqlQuery1 = @"

SET NOCOUNT ON;

WITH AccountDeviceStats(serviceGroupName,numAccounts,numDevices)
AS
(
    SELECT svg.name,COUNT(acct.serviceGroupId) as Accounts, NULL FROM bm_account acct WITH     (NOLOCK)
    INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = acct.serviceGroupId

    where acct.CreateStamp between '$($LDo2PM)' and '$($FDoTM)'
GROUP BY acct.serviceGroupId,svg.name
UNION ALL
SELECT svg.name, NULL, COUNT(device.serviceGroupId) as Devices FROM bm_device device WITH (NOLOCK)
INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = device.serviceGroupId, bm_account acct

where device.accountID=acct.accountId and acct.CreateStamp between '$($LDo2PM)' and '$($FDoTM)'
GROUP BY device.serviceGroupId,svg.name
)
SELECT ad1.serviceGroupName,ad1.numAccounts,ad2.numDevices FROM AccountDeviceStats ad1
INNER JOIN AccountDeviceStats ad2 ON ad1.serviceGroupName = ad2.serviceGroupName
WHERE ad1.numAccounts IS NOT NULL AND ad2.numDevices IS NOT NULL
ORDER BY numAccounts DESC,numDevices DESC
"@

$OutputHeader2 = "Total Counts"
$SqlQuery2 = @"

SET NOCOUNT ON;

WITH AccountDeviceStats(serviceGroupName,numAccounts,numDevices)
AS
(
SELECT svg.name,COUNT(acct.serviceGroupId) as Accounts, NULL FROM bm_account acct WITH     (NOLOCK)
INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = acct.serviceGroupId

where acct.CreateStamp < '12-31-2099'
GROUP BY acct.serviceGroupId,svg.name
UNION ALL
SELECT svg.name, NULL, COUNT(device.serviceGroupId) as Devices FROM bm_device device WITH (NOLOCK)
INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = device.serviceGroupId, bm_account acct

where device.accountID=acct.accountId and acct.CreateStamp < '12-31-2099'
GROUP BY device.serviceGroupId,svg.name
)
SELECT ad1.serviceGroupName,ad1.numAccounts,ad2.numDevices FROM AccountDeviceStats ad1
INNER JOIN AccountDeviceStats ad2 ON ad1.serviceGroupName = ad2.serviceGroupName
WHERE ad1.numAccounts IS NOT NULL AND ad2.numDevices IS NOT NULL
ORDER BY numAccounts DESC,numDevices DESC
"@

$sqlQueries = @($SqlQuery1, $SqlQuery2)

$Results = @()

Foreach ($Query in $sqlQueries){
    $Connection.open()
    Write-host "Connection to database successful." -foregroundcolor green -backgroundcolor black
    $SqlCmd.CommandText = $Query
    $SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter
    $SqlAdapter.SelectCommand = $SqlCmd
    $SqlCmd.Connection = $Connection
    $DataSet = New-Object System.Data.DataSet
    $SqlAdapter.Fill($DataSet)
    $Connection.Close()

$Results += $DataSet.Tables[0]

($Results | ConvertTo-XML -NoTypeInformation).Save("$TempDir\$OutputXML")
}

if ((Get-ChildItem $TempDir -filter "$Date-*.xml").count -gt 0){    
Foreach ($file in (Get-ChildItem $TempDir -filter "$Date-*.xml" -recurse)){
    Foreach ($webserver in $WebDir){
        Copy-Item $file.fullname "$webserver\$file" -force
        }
    Remove-Item $file.fullname -force
    }
} 
```

这是 XML 的输出格式

```
<?xml version="1.0"?>
<Objects>
  <Object>
    <Property Name="serviceGroupName">ServiceGroup1</Property>
    <Property Name="numAccounts">15</Property>
    <Property Name="numDevices">28</Property>
    <Property Name="RowError" />
    <Property Name="RowState">Unchanged</Property>
    <Property Name="Table">
      <Property>System.Data.DataRow</Property>
    </Property>
    <Property Name="ItemArray">
      <Property>ServiceGroup1</Property>
      <Property>15</Property>
      <Property>28</Property>
    </Property>
    <Property Name="HasErrors">False</Property>
  </Object>
  <Object>
    <Property Name="serviceGroupName">ServiceGroup1</Property>
    <Property Name="numAccounts">45</Property>
    <Property Name="numDevices">69</Property>
    <Property Name="RowError" />
    <Property Name="RowState">Unchanged</Property>
    <Property Name="Table">
      <Property>System.Data.DataRow</Property>
    </Property>
    <Property Name="ItemArray">
  <Property>ServiceGroup1</Property>
  <Property>45</Property>
  <Property>69</Property>
</Property>
<Property Name="HasErrors">False</Property> 
```

最后一件事。如果可以从 XML 中删除多余的膨胀，如您所见，它会使数据输出加倍，因为它创建了一个名为 ItemArray 的节点，其中包含所有相同的信息。

我希望这很容易理解。如果您需要更多信息，请告诉我。并提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:03:25.077

我认为您需要做的就是在 powershell 脚本中更新您的两个 T-sql 查询。第一个，添加如下代码：

```
 ...., "Monthly" as ReportType FROM AccountDeviceStats ad1... 
```

第二个，添加如下代码：

```
 ...., "Total" as ReportType FROM AccountDeviceStats ad1... 
```

```
 ### Dates to use
$Date = (Get-Date -f MM-dd-yyyy)
$FDoTM = ((Get-Date -Day 01).AddMonths(0)).AddDays(0)
$LDo2PM = ((Get-Date -Day 01).AddMonths(-1)).AddDays(-1)
$TempDir = "C:\Temp"
$WebDir =     @("\\x.x.x.x\c$\inetpub\wwwroot\Reports\Accounts","\\x.x.x.x\c$\inetpub\wwwroot\Reports\Accounts")

### Something

$OutputXML = "$Date-Monthly-AccountReport.xml"

### Connection settings, uses windows authentication

$DBServer = "OMMITED"
$databasename = "OMMITED"
$Connection = new-object system.data.sqlclient.sqlconnection #Set new object to connect to sql database
$Connection.ConnectionString ="server=$DBServer;database=$databasename;trusted_connection=True" # Connectiongstring setting for local machine database with window authentication
Write-host "Connection Information:"  -foregroundcolor yellow -backgroundcolor black
$Connection #List connection information

### Connect to Database and Run Query

$SqlCmd = New-Object System.Data.SqlClient.SqlCommand #setting object to use sql commands

$OutputHeader1 = "This Month's counts"
$SqlQuery1 = @"

SET NOCOUNT ON;

WITH AccountDeviceStats(serviceGroupName,numAccounts,numDevices)
AS
(
    SELECT svg.name,COUNT(acct.serviceGroupId) as Accounts, NULL FROM bm_account acct WITH     (NOLOCK)
    INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = acct.serviceGroupId

    where acct.CreateStamp between '$($LDo2PM)' and '$($FDoTM)'
GROUP BY acct.serviceGroupId,svg.name
UNION ALL
SELECT svg.name, NULL, COUNT(device.serviceGroupId) as Devices FROM bm_device device WITH (NOLOCK)
INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = device.serviceGroupId, bm_account acct

where device.accountID=acct.accountId and acct.CreateStamp between '$($LDo2PM)' and '$($FDoTM)'
GROUP BY device.serviceGroupId,svg.name
)
SELECT ad1.serviceGroupName,ad1.numAccounts,ad2.numDevices, ""Monthly"" as ReportType  FROM AccountDeviceStats ad1
INNER JOIN AccountDeviceStats ad2 ON ad1.serviceGroupName = ad2.serviceGroupName
WHERE ad1.numAccounts IS NOT NULL AND ad2.numDevices IS NOT NULL
ORDER BY numAccounts DESC,numDevices DESC
"@

$OutputHeader2 = "Total Counts"
$SqlQuery2 = @"

SET NOCOUNT ON;

WITH AccountDeviceStats(serviceGroupName,numAccounts,numDevices)
AS
(
SELECT svg.name,COUNT(acct.serviceGroupId) as Accounts, NULL FROM bm_account acct WITH     (NOLOCK)
INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = acct.serviceGroupId

where acct.CreateStamp < '12-31-2099'
GROUP BY acct.serviceGroupId,svg.name
UNION ALL
SELECT svg.name, NULL, COUNT(device.serviceGroupId) as Devices FROM bm_device device WITH (NOLOCK)
INNER JOIN bm_servicegroup svg WITH (NOLOCK) ON svg.servicegroupId = device.serviceGroupId, bm_account acct

where device.accountID=acct.accountId and acct.CreateStamp < '12-31-2099'
GROUP BY device.serviceGroupId,svg.name
)
SELECT ad1.serviceGroupName,ad1.numAccounts,ad2.numDevices, ""Total"" as ReportType FROM AccountDeviceStats ad1
INNER JOIN AccountDeviceStats ad2 ON ad1.serviceGroupName = ad2.serviceGroupName
WHERE ad1.numAccounts IS NOT NULL AND ad2.numDevices IS NOT NULL
ORDER BY numAccounts DESC,numDevices DESC
"@

$sqlQueries = @($SqlQuery1, $SqlQuery2)

$Results = @()

Foreach ($Query in $sqlQueries){
    $Connection.open()
    Write-host "Connection to database successful." -foregroundcolor green -backgroundcolor black
    $SqlCmd.CommandText = $Query
    $SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter
    $SqlAdapter.SelectCommand = $SqlCmd
    $SqlCmd.Connection = $Connection
    $DataSet = New-Object System.Data.DataSet
    $SqlAdapter.Fill($DataSet)
    $Connection.Close()

$Results += $DataSet.Tables[0]

($Results | ConvertTo-XML -NoTypeInformation).Save("$TempDir\$OutputXML")
}

if ((Get-ChildItem $TempDir -filter "$Date-*.xml").count -gt 0){    
Foreach ($file in (Get-ChildItem $TempDir -filter "$Date-*.xml" -recurse)){
    Foreach ($webserver in $WebDir){
        Copy-Item $file.fullname "$webserver\$file" -force
        }
    Remove-Item $file.fullname -force
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-01T13:15:18.497

最初的问题还询问了如何从 XML 中删除臃肿。我正在寻找一种解决方案，其中我从 SQL 结果生成的 XML 必须采用绝对特定的格式，并带有正确的标签和所有内容。我发现一旦你有了你的数据集对象 ($DataSet)，那么如果你想看看它有哪些方法和属性可用，($DataSet | gm) 那么其中之一就是 GetXML()。

这会自动格式化您的 SQL 输出，以便每个返回的列（或列别名）作为单独的标记返回（尽管注意，它不会为空值生成空标记）所以在这种情况下，如果您使用 $DataSet.GetXML( ）我本来希望看到输出类似于

```
 <NewDataSet>
  <Table>
    <serviceGroupName>ServiceGroup1</serviceGroupName>
    <numAccounts>15</numAccounts>
    <numDevices>28</numDevices>
  </Table>
</NewDataSet> 
```

所以没有膨胀！

由于这只是一系列字符串，因此您可以执行 ($Dataset.GetXML()).Replace('NewDataSet','OuterTag').Replace('Table','InnerTag') 之类的操作以提供更好的标签XML。一旦你对此感到满意，你可以输出

```
SET-CONTENT -PATH $xmlfilename -VALUE '<?xml version="1.0" ?>' 
```

或者一些这样的文件，然后附加 GetXML() 方法的输出，这样你就有了一个更整洁的 XML 格式！

```
($DataSet.GetXML()).Replace('NewDataSet','OuterTagName').Replace('Table','InnerTagName') | ADD-CONTENT -PATH $xmlfilename 
```

# php - 将变量从第一页传递到第三页PHP

> ID：15800104
> 
> 赞同：0
> 
> 时间：2013-04-03T23:36:26.093
> 
> 标签：php, variables

我在第一页有一个带有选择代码的下拉列表：

```
print "Select week for season 1:  <select name='Week_select'> <br>"; 
```

在第 2 页我有

```
$varWeek=$_POST['Week_select']; 
```

然后是另一个下拉列表：

```
print "Select a team that played season 1and week $varWeek:  <select name='Team_select'><br>"; 
```

到目前为止一切顺利，非常感谢所有让我走到这一步的人。

现在，当我转到第 3 页时，我失去了 $varWeek

我看到我应该使用 $_GET 或将其作为隐藏传递。我试过`$varWeek=$_GET['Week_select'];` 了，但没有用。

我不确定如何隐藏它。请帮助我了解更多。提前谢谢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:41:50.267

就像你说的那样，将变量作为隐藏字段添加到表单中，如下所示：

```
print '<input type="hidden" name="Week_select" value="'. $_GET['Week_select'] .'" />'; 
```

然后在处理表单的页面上，该变量将在`$_POST['Week_select']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:03:02.800

更好的方法是将这些变量注册为会话变量。这样它们就不会出现在 URL 中，您将能够跨多个页面访问它们。在这里阅读：

[http://www.php.net/manual/en/intro.session.php](http://www.php.net/manual/en/intro.session.php)

您可以像这样访问/存储会话变量：

```
$_SESSION['varname'] = 'value'; 
```

在另一个页面上

```
var_dump($_SESSION['varname']); 
```

# ios - UIScrollView - 在没有快照的情况下恢复到起始位置

> ID：15800111
> 
> 赞同：5
> 
> 时间：2013-04-03T23:37:01.443
> 
> 标签：ios, cocoa-touch, uitableview, uiscrollview, paging

如果拖得不够，我想恢复 UIScrollView 的内容偏移量：

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(CGPoint *)targetContentOffset {
    self.endingOffset = scrollView.contentOffset;

    if(abs(verticalOffset) > [self cellHeight] / 9) { // If the user scrolled enough distance, attempt to scroll to the next cell
        ...
    } else if(self.nextCellOrigin.y != 0) { // The scroll view is still scrolling and the user didn't drag enough
        ...
    } else { // If the user didn't drag enough
        self.tableView.decelerationRate = UIScrollViewDecelerationRateNormal;
        (*targetContentOffset) = self.startingOffset;
    }
} 
```

恢复到原始位置的代码在 else 部分，它总是有效的。但是，当我没有足够的滚动并快速做出手势时，它会弹回来。如果我滚动一点，然后保持该位置比平时稍长，它会顺利恢复。

我没有在 API 参考中找到任何关于用户触摸 UIScrollView 多长时间的内容，即使我这样做了，我如何使用它来改变我的还原代码的行为也不是很明显。我还尝试使用 setContentOffset:animated: 滚动到该位置，但这似乎并不能解决抖动问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T23:44:43.260

您是否尝试过记录速度以了解急动发生时的情况？

**编辑**：

您可以尝试做的是实现这两个 scrollView 委托方法，而不是 willEndDragging 方法。这个方案会给scrollView不一样的感觉，不过还是试试吧。

`checkOffset`用您需要的所有逻辑填充该方法。

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate {

    // if scrollView's contentOffset reached its final position during scroll, it will not decelerate, so you need a check here too
    if (!decelerate) {
       [self checkOffset];
    }
}    

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView {
   [self checkOffset];
}

- (void)checkOffset {
    CGPoint newOffset;
    ...
    // Do all the logic you need to move the content offset, then:
    ...
    [self.scrollView setContentOffset:newOffset animated:YES];
} 
```

**编辑＃2：** 如果您也将其添加到我的解决方案中，也许您可​​以获得更好的结果..尝试;）

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(CGPoint *)targetContentOffset {
    // This should force the scrollView to stop its inertial deceleration, by forcing it to stop at the current content offset
    *targetContentOffset = scrollView.contentOffset;
} 
```

# php - 如何用点管理数值？

> ID：15800113
> 
> 赞同：1
> 
> 时间：2013-04-03T23:37:21.187
> 
> 标签：php, numbers, comma

$val 代表我的 sql 中的 1,949.58

```
 $sold = 50;
    if ($val>$sold){
    echo "true";
    }
    else
    {
    echo "false";
    } 
```

我弄错了。不知何故，50 比 1,949.58 大，这是因为“，”符号。我需要一些关于如何管理这项权利的建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:41:03.473

`$val`被 php 解释为一个字符串。在进行比较时，它会进行字符串比较，因此您不会得到预期的结果。

您需要强制它们为浮点类型。查看[http://php.net/manual/en/function.floatval.php](http://php.net/manual/en/function.floatval.php) 特别是对该函数的注释。

像这样的东西*应该*工作：

```
function floatvalue($value) { 
     return floatval(preg_replace('#^([-]*[0-9\.,\' ]+?)((\.|,){1}([0-9-]{1,2}))*$#e', "str_replace(array('.', ',', \"'\", ' '), '', '\\1') . '.\\4'", $value)); 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:44:08.570

您需要将这些值转换为浮点数而不是字符串。现在你正在做字符串比较而不是数字比较。下面将这些字符串转换为浮点值。

```
$val = parseFloat('1,949.58'.replace(/\,/g,""))
$sold = parseFloat('50') 
```

.replace 在解析为浮点数之前从原始字符串中删除“，”。

# ruby-on-rails - 创建自定义路由，其中 使用模型属性而不是 Rails 中的 ID

> ID：15800114
> 
> 赞同：4
> 
> 时间：2013-04-03T23:37:27.160
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, routes, custom-routes

我有一个名为 的模型`Student`，其中有一个名为的属性`University_ID`。

我创建了一个自定义操作和路由，通过以下链接显示特定学生的详细信息：`students/2/details`即`students/:id/details`

但是，我希望能够允许用户使用他们的大学 ID 而不是数据库 ID，以便以下内容可以工作，`students/X1234521/details` 例如`students/:university_id/details`

我的路由文件现在看起来像这样：

```
resources :students
match 'students/:id/details' => 'students#details', :as => 'details' 
```

但是，这使用 Student_ID 而不是 University_ID，我已经尝试过

`match 'students/:university_id/details' => 'students#details', :as => 'details'`，但这仅对应于 Student_ID，而不对应于 University_ID。

我的控制器看起来像这样，如果这有任何帮助：

```
def details
  @student = Student.find(params[:id])
end 
```

我也尝试过，`@student = Student.find(params[:university_id])`但没有，没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:51:05.043

在与@teenOmar 交谈以澄清要求后，这是我们提出的解决方案，它允许现有`students/:id/details`路由接受 an`id`或 a `university_id`（以 a 开头`w`），并使用 a`before_filter`填充`@student`以用于各种控制器操作：

```
class StudentsController < ApplicationController

  before_filter :find_student, only: [:show, :edit, :update, :details]

  def show
    # @student will already be loaded here
    # do whatever
  end

  # same for edit, update, details

private

  def find_student
    if params[:id] =~ /^w/
      @student = Student.find_by_university_id(params[:id])
    else
      @student = Student.find(params[:id])
    end
  end

end 
```

# jquery - jquery 的焦点和模糊功能，但如果 val 不等于 null。

> ID：15800118
> 
> 赞同：3
> 
> 时间：2013-04-03T23:37:44.347
> 
> 标签：jquery, html, input, focus, blur

我正在尝试根据焦点和模糊事件修改输入的背景。该部分工作正常，但如果客户端在搜索框中输入了值，我也想设置背景。如果您输入文本然后立即单击提交按钮，它确实有效（尽管您可以非常短暂地看到背景更改）。

但是如果一个值当前在搜索框中并且客户端触发了模糊功能，它也会改变输入的背景。

如果搜索框中有值，如何确保不触发模糊功能？

这是我迄今为止的代码：

```
 // change input field on blur and focus
var $searchFocus = 'url("img/layout/spyglass.png") no-repeat 2px 0 #FFFFFF';
var $searchBlur = 'url("img/layout/spyglass-text.png") no-repeat 2px 0 #FFFFFF';
$('#query').css('background', $searchBlur);

if($('#query').val() !='') {
    $('#query').css('background', $searchFocus);
}

$('#query').focus(function(){
    $('#query').css('background', $searchFocus);
}); 

$('#query').blur(function() {
    $('#query').css('background', $searchBlur);
}); 
```

我做了一个[jsfiddle](http://jsfiddle.net/lharby/e6uTB/)

也许我想要与模糊功能不同的东西？

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T23:40:59.463

为了你的模糊：

```
$('#query').blur(function() {
    if(!$('#query').val()) $('#query').css('background', $searchBlur);
}); 
```

更新的工作小提琴：

[http://jsfiddle.net/e6uTB/3/](http://jsfiddle.net/e6uTB/3/)

* * *

**更新**

作为额外的奖励，我重构了您的代码！

[http://jsfiddle.net/e6uTB/8/](http://jsfiddle.net/e6uTB/8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:57:09.537

显而易见的解决方案是简单地测试模糊函数中的值。

但是，您的问题明确指出，仅当值为空时才应触发模糊功能。

此解决方案在值更改时添加和删除模糊功能。

```
function setSearchBackground() {
     $('#query').css('background', $searchBlur);  
}

$('#query').on('blur', setSearchBackground);

$('#query').change(function() {
    if($(this).val() == '') {
        $(this).on('blur', setSearchBackground);
    } else {
        $(this).off('blur', setSearchBackground);
    }
}); 
```

[http://jsfiddle.net/sUtTp/](http://jsfiddle.net/sUtTp/)

就个人而言，我会按照 Kyle 的描述解决问题，并在函数内执行值检查`blur`。

# php - PHP & jQuery ajax 调用无需等待响应

> ID：15800120
> 
> 赞同：3
> 
> 时间：2013-04-03T23:37:54.847
> 
> 标签：php, jquery, sql, ajax

我正在为某事挣扎。

我有一个 PHP 页面，它使用 jQuery 对另一个页面进行 ajax 调用`$.ajax`。它将请求异步发送到处理页面，然后返回响应。

现在这工作正常，但我们正在对后端和运行的处理（SQL 存储过程）进行一些更改，现在需要更长的时间，比如 5 分钟以上。等待很好，因为我们正在处理 SQL 中接近 200MM 的记录。

问题是我需要能够将请求发送到处理页面，而不必等待响应。处理页面触发 PHP 中的存储过程，如下所示：

```
 $query = $dbh2->prepare('exec sp_name :countID');
            $query->bindParam('countID', $countID);
            $query->execute(); 
```

现在，该存储过程再次需要一段时间才能运行，我们不需要将结果呈现给用户。尽管在存储过程之后需要运行一些额外的 PHP 代码，但也不需要将任何内容发送回浏览器。

我试图找出一种方法，可以调用处理页面并运行存储过程和其他代码，但用户的浏览器不需要等待响应。现在，如果尝试过早地关闭页面，它基本上会锁定浏览器一段时间并且不会完成处理。

对此的任何见解都会很棒。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:13:22.247

Sequenzia，如果我理解正确的话，那么经过大量研究，我已经来到这里并找到了通过这个泥潭的方法。

几个月前，我提供了一个类似问题的答案。不幸的是，OP 或其他任何人都曾接受/评论/upvoted/downvoted - nada。

*   [从我的网站运行批处理文件](https://stackoverflow.com/questions/13617185/run-a-batch-file-from-my-website/13618558#13618558)

这里有一些有用的参考资料：

**运行后台脚本（unix 命令）**

*   参考： http: [//nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/](http://nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/)
*   参考： http: [//www.mathinfo.u-picardie.fr/asch/f/MeCS/courseware/users/help/general/unix/redirection.html](http://www.mathinfo.u-picardie.fr/asch/f/MeCS/courseware/users/help/general/unix/redirection.html)

**如何编写 PHP $shortopts 和 $longopts**

*这是在从命令行运行时解释传递给 PHP 脚本的参数的方法，或者从带有 shell-exec() 的另一个 PHP 脚本*

*   参考：[http ://www.php.net/manual/en/function.getopt.php](http://www.php.net/manual/en/function.getopt.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:44:13.133

您可能会考虑设置该方法的`timeout`选项`$.ajax()`。通过设置可能半秒或其他的超时，ajax 将超时并进入错误处理程序（如果有）。

# javascript - 为什么我必须将所有脚本放在 jquery mobile 中的 index.html 中

> ID：15800121
> 
> 赞同：26
> 
> 时间：2013-04-03T23:38:04.043
> 
> 标签：javascript, jquery, html, cordova, jquery-mobile

我使用 $.mobile.changepage 在我的 phonegap+jquerymobile 项目中进行重定向。然而让我感到困惑的是，我需要将所有页面的脚本放到同一个文件 index.html 中。如果不是，则重定向页面无法执行其标头中的功能。

例如，我的 index.html 似乎是 `$(document).bind("deviceready",function(){$.mobile.changepage("test.html");})`

然后，我的设备将重定向到 test.html 这似乎是

```
$("#btnTest").click(function(){alert("123");})
<button id="btnTest">Test</button> 
```

但是，该脚本永远不会在 test.html 中执行。然后我把脚本放到index.html中，我期望的就完成了。无论如何，如果我将所有脚本放在同一个页面上，项目将变得越来越难以保存。感谢您的帮助。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-04-04T09:10:16.560

# 介绍

这篇文章也可以在**[这里](http://www.gajotres.net/how-jquery-mobile-page-handling-affects-javascript-executions/)**找到，作为我博客的一部分。

# jQuery Mobile 如何处理页面更改

要了解这种情况，您需要了解 jQuery Mobile 的工作原理。它使用 ajax 来加载其他页面。

第一页正常加载。它的**`HEAD`**和**`BODY`**被加载到 中**`DOM`**，它们在那里等待其他内容。加载第二页时，仅将其**`BODY`**内容加载到**`DOM`**. 更准确地说，甚至**`BODY`**没有满载。只有第一个具有 data-role="page" 属性的 div 将被加载，其他所有内容都将被丢弃。即使您有更多页面，也**`BODY`**只会加载第一个页面。此规则仅适用于后续页面，如果您在初始**HTML**中有更多页面，所有这些页面都将被加载。

这就是为什么您的按钮显示成功但单击事件不起作用的原因。**`HEAD`**在页面转换期间忽略其父级的相同单击事件。

这是官方文档：http: [//jquerymobile.com/demos/1.2.0/docs/pages/page-links.html](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)

不幸的是，您不会在他们的文档中找到此描述。以太他们认为这是一个常识，或者他们忘记像我的其他主题一样描述这个。（jQuery Mobile 文档很大，但缺少很多东西）。

# 解决方案 1

在您的第二页和其他所有页面中，将您的**`SCRIPT`**标签移动到**`BODY`**内容中，如下所示：

```
<body>
    <div data-role="page">
        // And rest of your HTML content
        <script>
            // Your javascript will go here
        </script>
    </div>
</body> 
```

这是一个快速的解决方案，但仍然是一个丑陋的解决方案。

工作示例可以在我的其他答案中找到：**[Pageshow not trigger after changepage](https://stackoverflow.com/a/16083870/1848600)**

另一个工作示例：[**页面加载方式与 jQuery-mobile 转换不同**](https://stackoverflow.com/questions/15430912/page-loaded-differently-with-jquery-mobile-transition/15431229#15431229)

# 解决方案 2

将您的所有 javascript 移动到原始的第一个 HTML 中。收集所有内容并将其放入单个 js 文件中，放入**`HEAD`**. 在加载 jQuery Mobile 后初始化它。

```
<head>
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>    
    <script src="index.js"></script> // Put your code into a new file
</head> 
```

最后，我将描述为什么这是一个好的解决方案的一部分。

# 解决方案 3

在您的按钮和用于更改页面的每个元素中使用**rel="external" 。**因为它不会使用 ajax 来加载页面，并且您的 jQuery Mobile 应用程序将表现得像一个普通的 Web 应用程序。不幸的是，在您的情况下，这不是一个好的解决方案。Phonegap 永远不能作为普通的网络应用程序运行。

```
<a href="#second" class="ui-btn-right" rel="external">Next</a> 
```

官方文档，找一章：**[Linking without Ajax](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)**

# 现实的解决方案

现实的解决方案将使用**解决方案 2**。但与解决方案 2 不同，我将使用相同的 index.js 文件并在**`HEAD`**每个可能的其他页面中对其进行初始化。

现在你可以问我**为什么**？

**`Phonegap`**就像 jQuery Mobile 有问题一样，如果您的每个 js 内容都在一个 HTML 文件中，迟早会出现错误并且您的应用程序将失败（包括加载的 DOM）。DOM 可能会被删除，并**`Phonegap`**会刷新您当前的页面。如果该页面没有javascript，则在重新启动之前它将无法工作。

# 最后的话

这个问题可以通过良好的页面架构轻松解决。如果有人感兴趣，我已经写了一篇关于优秀 jQuery Mobile 页面架构的**[文章。](http://www.gajotres.net/secrets-of-a-good-jquery-mobile-page-architecture/)**简而言之，我正在讨论 jQuery Mobile 如何工作的知识是您在成功创建第一个应用程序之前需要了解的最重要的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T06:03:22.463

与普通的普通 HTML 页面不同，jQuery Mobile 在页面之间导航时使用了 ajax 技术。因此，请确保在所有 html 页面中导入所有 JS 文件和库。

如果您仔细观察，您会发现在加载第二页时会考虑上一页中的 JS 文件。但是如果你强制rrefresh当前页面，那么当前页面的js文件就会生效。

所以正如我之前所说，确保在所有 html 文件中导入 js 文件。

也无需调用`deviceready`，使用以下语法调用页面特定的 js 函数

```
$(document).on('pageshow', '#YourPageID', function(){
    // Your code goes here
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T07:25:14.333

Jquery Mobile 使用 ajax 加载“页面”。这里的“页面”是一个带有 data-role=page 的 div。如果加载物理页面 index.html，则可以使用 changePage 导航到该页面内的任何“页面”div。

但是，如果您想从其他物理页面加载“页面”，jQM 只会从该页面加载第一个“页面”div。实际发生的情况是您不更改页面，jQM 只需使用 ajax 加载特定的“页面”div 并将其注入当前页面。

您有两种可能的架构，您可以将所有“页面”放在一个 html 页面中并从那里导航。或者你可以有多个页面架构。你可以随时混合这个。

要物理更改页面，您需要将 rel=external 添加到您的链接。

# python - 如何调用名称中带有空格的方法？

> ID：15800123
> 
> 赞同：3
> 
> 时间：2013-04-03T23:38:23.533
> 
> 标签：python, syntax, identifier

我有以下课程：

```
Help on class A in module a:

class A(__builtin__.object)
 |  Methods defined here:
 |  
 |  any vegetable(self)
 |      TODO document this
 |  
 |  getHeight(self)
 |      uses the chicken to measure it 
```

调用`any vegetable`不起作用：

```
>>> a.A().any vegetable()
  File "<stdin>", line 1
    a.A().any vegetable()
                      ^
SyntaxError: invalid syntax 
```

我怎么打电话`any vegetable`？

* * *

好吧，我不敢相信我必须提供更多的证据，但是这里。

```
>>> dir(a.A)
['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'any vegetable', 'getHeight'] 
```

这不是我的课，所以请不要告诉我重写它。我只需要调用该方法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-03T23:40:16.717

使用`getattr`：

```
>>> a = A()
>>> getattr(a, 'any vegetable')() 
```

请注意，名称中包含奇怪的字符（例如空格）是一个***非常非常糟糕的主意***。没有理智的人会这样做。

# jquery - Umbraco 4-6：自动从标签中删除关键的 jQuery 属性...为什么？

> ID：15800125
> 
> 赞同：-1
> 
> 时间：2013-04-03T23:38:54.300
> 
> 标签：jquery, umbraco, href

在 Umbraco 6.X 中，一些关键的 jQuery 属性会自动从所有包含`href="#"`..etc 的标签中删除... 具体示例：当`<a href="#" class="big-link" data-animation="fade" data-reveal-id="1">`粘贴到 Umbraco 的 HTML 编辑器中时，标签会`<a href="#" class="big-link">`在 HTML 更新时自动剥离。结果是 jQuery 效果 + 内容不起作用。
在没有线索的情况下翻阅文档..为什么会这样？

注意：这不会发生在我在 UMBRACO 4.9 中工作的本地主机上，仅在使用 UMBRACO 6 的开发人员中发生......显然需要在开发之前在开发人员中工作，但不能在开发人员中回到 4.9。

任何和所有的见解将不胜感激。先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T15:11:36.943

问题已在 Dev 中得到修复……至少目前是这样！通过在开发人员控制台中访问数据类型，我能够将 Richtext 编辑器（默认为 TinyMCE v3 wysiwyg）设置为 'UltraSimpleEditor' 。可以说，这里的罪魁祸首确实是所见即所得的编辑器（TinyMCE）。更具体地说，编辑器实际上剥离了标记中包含的关键 jQuery 代码，即使在其“纯”HTML 源代码模式/视图中，它显然没有设置在我的本地主机上执行此操作。根据您的建议，我希望将来接触 web.config 文件（可能还有其他配置文件）应该有助于“驯服”富文本编辑器的 URL 约定（我可能会在接下来的几天内对其进行修改——尤其是因为客户端，不知道 HTML 的人（也不应该期望）可能需要修改引用使用的 jQuery 库的问题的两个页面）。再次感谢Beetroot-Beetroot先生的投稿，希望以后能再相交！问候，warpOusa

# java - 让应用程序以编程方式登录到远程启用 SSO 的 Oracle Fusion 应用程序

> ID：15800128
> 
> 赞同：1
> 
> 时间：2013-04-03T23:39:18.563
> 
> 标签：java, oracle, single-sign-on, oracle-fusion-apps

我正在尝试模拟人类对受 SSO 保护的某个 Oracle Fusion 应用程序的日志记录。

所以我的第一直觉是做一些表单抓取来实现这一点，保存cookie然后发送它们，但是，我似乎在途中的某个地方被拒绝了。

我对如何使用篡改数据完成登录过程进行了一些分析，到目前为止，我认为一切顺利（我正在发送所有正确的 cookie 和大多数标题）所以我不知道我是什么米失踪。

请指教

这是我的代码：

```
//first I do a request to my report on OBIEE
java.net.URL u = new URL(null, "https://happyhost.domain/analytics/saw.dll?Go&Path=OpportunitiesReport&format=XML&jsonDataFormat=rowset&ViewName=tableView!1&rowsPerPage=9999999999&SyncOperation=1",new sun.net.www.protocol.https.Handler());
    URLConnection uc = u.openConnection();
    HttpsURLConnection connection = (HttpsURLConnection)uc;
    connection.setRequestProperty("User-Agent", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:20.0) Gecko/20100101 Firefox/20.0");
    connection.setRequestProperty("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
    connection.setRequestProperty("Accept-Language", "en-US,en;q=0.5");
    connection.setRequestProperty("Accept-Decoding", "gzip, deflate");

//read the response
BufferedReader in = new BufferedReader(new InputStreamReader(uc.getInputStream()));

//save the cookies to a HashMap (that's what the HttpCookies class is)
String headerName=null;
for (int i=1; (headerName = uc.getHeaderFieldKey(i))!=null; i++) {
        if (headerName.equals("Set-Cookie")) {
        HttpCookies.addCookieFromHeader(uc.getHeaderField(i));
    }
    System.out.println(headerName +": "+uc.getHeaderField(i)+"\n");
}

System.out.println("Sending the following cookies: "+HttpCookies.getCookiesString());
result = result + "Sending the following cookies: "+HttpCookies.getCookiesString()+"\n";

String fetchedContent = "";
String inputLine;
while ((inputLine = in.readLine()) != null) {
    fetchedContent = fetchedContent + inputLine;
}

System.out.println(fetchedContent);
result = result + "we downloaded"+ fetchedContent + "\n";

in.close();

String txt = fetchedContent;

HashMap<String,String> parametersMap = new HashMap<String,String>();

String re1="(<)";   // Any Single Character 1
String re2="(input)";       // Word 1
String re3="(.*?)";   // Non-greedy match on filler
String re11="(>)";  // Any Single Character 4

Pattern p = Pattern.compile(re1+re2+re3+re11,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
Matcher m = p.matcher(txt);

String parameters = "";

while (m.find())
{
    String c1=m.group(3);

    String re4="(name)";       // Word 3
    String re5="(=)";   // Any Single Character 3
    String re6="([\"']?([^'\" ]+)[\"']?)";    // Double Quote String 2

    Pattern p3 = Pattern.compile(re4+re5+re6,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
    Matcher m3 = p3.matcher(c1);

    String name = "";
    if(m3.find())
    {
        name = m3.group(3).replaceAll("\"", "");   
    }

    String re8="(VALUE)";       // Word 3
    String re9="(=)";   // Any Single Character 3
    String re10="([\"']?([^'\" ]+)[\"']?)";    // Double Quote String 2

    Pattern p2 = Pattern.compile(re8+re9+re10,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
    Matcher m2 = p2.matcher(c1);

    String value;
    if(m2.find())
    {
        value = m2.group(3).replaceAll("\"", "");
        parametersMap.put(name,value);
        if(name.equals("request_id")) {
            String[] bits = value.split(";");
            parametersMap.put(name,bits[bits.length-1]);    
        }
    }

}

for(String key : parametersMap.keySet())
{
   parameters = parameters + key+"="+parametersMap.get(key)+"&";
}

System.out.println("we are at "+uc.getURL());
result = result + "we are at "+uc.getURL() + "\n";

txt= uc.getURL().toString();

re1="(https)";       // Word 1
re2="(:)";   // Any Single Character 1
re3="(\\/)"; // Any Single Character 2
String re4="(\\/)"; // Any Single Character 3
String re5="((?:[a-z][a-z\\.\\d\\-]+)\\.(?:[a-z][a-z\\-]+))(?![\\w\\.])";   // Fully Qualified Domain Name 1
String re6="(:)";   // Any Single Character 4
String re7="(\\d+)";        // Integer Number 1
String re8="(\\/)"; // Any Single Character 5
String re9=".*?";   // Non-greedy match on filler
String re10="(b)";  // Any Single Character 6

p = Pattern.compile(re1+re2+re3+re4+re5+re6+re7+re8+re9+re10,Pattern.CASE_INSENSITIVE | Pattern.DOTALL);
m = p.matcher(txt);

String authServer = "";

if (m.find())
{
    String word1=m.group(1);
    String c1=m.group(2);
    String c2=m.group(3);
    String c3=m.group(4);
    String fqdn1=m.group(5);
    String c4=m.group(6);
    String int1=m.group(7);
    String c5=m.group(8);
    String c6=m.group(9);
    System.out.print("matched redirect "+word1.toString()+c1.toString()+c2.toString()+c3.toString()+fqdn1.toString()+c4.toString()+int1.toString());
    authServer = word1.toString()+c1.toString()+c2.toString()+c3.toString()+fqdn1.toString();
}

parameters = parameters + "&userid="+username+"&password="+password; 

System.out.println("\n\nSending paramenters:" + parameters+"\n\n");
System.out.println("\nSending to:" + authServer+"/oam/server/auth_cred_submit");

u = new URL(null, authServer+"/oam/server/auth_cred_submit",new sun.net.www.protocol.https.Handler());
uc = u.openConnection();
connection = (HttpsURLConnection)uc;
connection.setDoOutput(true);
connection.setDoInput(true);
connection.setInstanceFollowRedirects(true); 
connection.setRequestProperty("Cookie", HttpCookies.getCookiesString());
connection.setRequestMethod("POST"); 
//connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded"); 
//connection.setRequestProperty("charset", "utf-8");
connection.setRequestProperty("User-Agent", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:20.0) Gecko/20100101 Firefox/20.0");
//connection.setRequestProperty("Content-Length", "" + Integer.toString(parameters.getBytes().length));
connection.setUseCaches (false);

DataOutputStream wr = new DataOutputStream(connection.getOutputStream ());
wr.writeBytes(parameters);
wr.flush();
wr.close();
connection.disconnect();

in = new BufferedReader(new InputStreamReader(uc.getInputStream()));

headerName=null;
for (int i=1; (headerName = uc.getHeaderFieldKey(i))!=null; i++) {
        if (headerName.equals("Set-Cookie")) {                  
            HttpCookies.addCookieFromHeader(uc.getHeaderField(i));

    }
}

fetchedContent = "";
while ((inputLine = in.readLine()) != null) {
    fetchedContent = fetchedContent + inputLine;
}

System.out.println(fetchedContent);

in.close();

result = result + fetchedContent + "\n";

System.out.println("------------------------------");

u = new URL(null, "https://" + Settings.getInstance().getCrmHost()+"/analytics/saw.dll?Go&Path=%2Fshared%2FMobilytics%2FOpportunities&format=XML&jsonDataFormat=rowset&ViewName=tableView!1&rowsPerPage=9999999999&SyncOperation=1",new sun.net.www.protocol.https.Handler());
uc = u.openConnection();
connection = (HttpsURLConnection)uc;
connection.setRequestProperty("User-Agent", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:20.0) Gecko/20100101 Firefox/20.0");
connection.setRequestProperty("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8");
connection.setRequestProperty("Accept-Language", "en-US,en;q=0.5");
connection.setRequestProperty("Accept-Decoding", "gzip, deflate");

in = new BufferedReader(new InputStreamReader(uc.getInputStream()));

headerName=null;
for (int i=1; (headerName = uc.getHeaderFieldKey(i))!=null; i++) {
        if (headerName.equals("Set-Cookie")) {
        HttpCookies.addCookieFromHeader(uc.getHeaderField(i));
    }
    System.out.println(headerName +": "+uc.getHeaderField(i)+"\n");
}

System.out.println("Sending the following cookies: "+HttpCookies.getCookiesString());
result = result + "Sending the following cookies: "+HttpCookies.getCookiesString()+"\n";

fetchedContent = "";
inputLine = "";
while ((inputLine = in.readLine()) != null) {
    fetchedContent = fetchedContent + inputLine;
}

System.out.println(fetchedContent);
result = result + "we downloaded"+ fetchedContent + "\n"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T06:01:25.500

我强烈建议不要保存 cookie 并重放请求响应，而是模拟人工登录。我想你知道用户名和密码。您将能够使用 Apache Http 客户端模拟登录。请看下面的例子如何做到这一点： http: [//hc.apache.org/httpcomponents-client-ga/examples.html](http://hc.apache.org/httpcomponents-client-ga/examples.html)

# php - 在 Mac OS 10.8 上，我使用新模块重新编译 PHP，但 php -m 不显示它们

> ID：15800129
> 
> 赞同：0
> 
> 时间：2013-04-03T23:39:29.940
> 
> 标签：php, php-extension, recompile

我已经重新编译了 PHP 5.4.13（这不是 Mac OS 10.8 附带的 PHP 安装，这是我在 Mac 上升级 PHP 所做的构建），其中包含一些新模块，如 geoIP、WDDX 和其他一些扩展，但它的当我执行 php -m 时没有出现，它显示了相同的旧版本。

即使我执行 php -v ，它也会显示旧的构建详细信息，例如构建日期和构建时间。意味着我的 make install 真的没有用。但是当我运行 make install 时没有错误或什么。

我的 ./configure 命令是

```
./configure 
--prefix=/usr  \
--mandir=/usr/share/man/ \
--infodir=/usr/share/info/ \
--extension-dir=ext \
--enable-dependency-tracking \
--sysconfdir=/private/etc/ \
--with-apxs2=/usr/sbin/apxs  \
--enable-cli \
--with-config-file-path=/etc/ \
--with-libxml \
--with-openssl \
--with-kerberos=/usr/ \
--with-zlib \
--enable-bcmath \
--with-bz2 \
--enable-calendar \
--disable-cgi \
--with-curl \
--enable-dba \
--enable-ndbm=/usr/ \
--enable-exif \
--enable-fpm \
--enable-ftp \
--with-gd \
--with-freetype-dir=/BinaryCache/apache_mod_php/apache_mod_php-78~13/Root/usr/local \
--with-jpeg-dir=/BinaryCache/apache_mod_php/apache_mod_php-78~13/Root/usr/local \
--with-png-dir=/BinaryCache/apache_mod_php/apache_mod_php-78~13/Root/usr/local \
--enable-gd-native-ttf \
--with-icu-dir=/usr/ \
--with-iodbc=/usr/ \
--with-ldap=/usr/ \
--with-ldap-sasl=/usr/ \
--with-libedit=/usr/ \
--enable-mbstring \
--enable-mbregex \
--with-mysql=mysqlnd \
--with-mysqli=mysqlnd \
--without-pear \
--with-pdo-mysql=mysqlnd \
--with-mysql-sock=/var/mysql/mysql.sock \
--with-readline=/usr/ \
--enable-shmop \
--with-snmp=/usr/ \
--enable-soap \
--enable-sockets \
--enable-sqlite-utf8 \
--enable-suhosin \
--enable-sysvmsg \
--enable-sysvsem \
--enable-sysvshm \
--with-tidy \
--enable-wddx \
--with-xmlrpc \
--with-iconv-dir=/usr/ \
--with-xsl=/usr/ \
--enable-zend-multibyte \
--enable-zip \
--with-pcre-regex=/usr/ \
--with-pgsql=/usr/ \
--with-pdo-pgsql=/usr/ \
--with-geoip=geoip 
```

这是我的 php -m 输出

```
 [PHP Modules]
Core
ctype
date
dom
ereg
fileinfo
filter
hash
iconv
json
libxml
pcre
PDO
pdo_sqlite
Phar
posix
Reflection
session
SimpleXML
SPL
sqlite3
standard
tokenizer
xml
xmlreader
xmlwriter 
```

[Zend 模块]

这就是php必须说的，

```
/opt/local/bin/php 
```

这就是 whereis php 所说的，

```
/usr/bin/php 
```

有任何想法吗？

# php - 在 PHP 中有效地缓存和分页大型 MySQL 结果集

> ID：15800132
> 
> 赞同：3
> 
> 时间：2013-04-03T23:39:38.260
> 
> 标签：php, mysql

我有一个分布式 PHP5 应用程序，允许用户通过 MySQL 数据搜索和分页。有时，他们的查询可能包含数十万条记录，并且这些记录总是按时间戳排序，因此记录的数量和排序方式会按原样影响性能。

我需要提高分页效率。很久以前我放弃`SQL_CALC_FOUND_ROWS`了 a `COUNT(*)`，但这意味着查询仍然运行两次，一次有限制，一次没有。

*我可以结合这两个查询并依靠 PHP 对结果集进行分页，而不是使用`LIMIT`子句。*更新：这是不可能的，因为我尝试使用的大型数据集会超过为 php.ini 设置的内存限制。由于这是分布式的，我不能依赖每个人来更改他们的设置。

但是，我真的很想缓存结果并以这种方式分页 - 我会比再次查询 MySQL 快得多*。*因为它是一个分布式应用程序，所以我不会有任何我通常使用的缓存系统，比如 Memcached 等。会话存储可能太小了。

有没有其他选择？有没有更好的方法对结果进行分页，或者有一种安全的方法来缓存结果并让 PHP 对它们进行分页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:56:51.687

您需要显示结果的确切数量吗？您总是可以告诉您的用户“找到超过 1000 个结果”。此外，当您执行 count(*) 时，它可能不一定会查看表中的所有记录，它使用表上的索引来进行有效计数。

如果您的表很大，您可以随时使用`SHOW TABLE STATUS`查询来查找有关您的表的信息。如果是 MyISAM 表，此命令将为您提供确切的行数，但如果是 InnoDB，则可能不准确。

希望这可以帮助

# git - git：如何用另一个分支的内容重置分支？

> ID：15800145
> 
> 赞同：5
> 
> 时间：2013-04-03T23:40:45.430
> 
> 标签：git

我无法弄清楚如何将一个分支更新为与另一个分支相同。这是一个例子：

```
git init test; cd test
echo apple >a; echo banana >b; git add a b; git commit -m 'A1/a:apple;b:banana'
echo carrot >c; git add c; git commit -m 'A2/c:carrot'
git checkout -b second HEAD^1
echo beets >b; echo dandelion >d; git add b d; git commit -m 'B1/b:beets;d:dandelion' 
```

在这一点上，我的历史看起来像这样：

```
A1-----A2     (master, contains a:apple, b:banana, c:carrot)
 \
  \----B1     (second, contains a:apple, b:beets, d:dandelion) 
```

现在我想向“second”分支添加一个提交，使其内容与“master”分支匹配，即：

```
A1-----A2
 \
  \----B1--?--B2     (desired contents a:apple, b:banana, c:carrot) 
```

我的问题是，我要运行哪些 git 命令来执行此操作？我想出的最接近的是：

```
git checkout master .
git commit -m B2 
```

但是，虽然这会将 b 重置为香蕉并恢复 c，但它不会删除文件 d。我也无法想出任何`git reset`我想要的变体。我不认为我想做一个版本`git revert`，因为在我的实际存储库中，分支上的历史比这个例子更复杂，并且分支可能包含合并。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T03:31:04.137

## The simple way

You *almost* had the right answer. The solution is to first remove all of the files before checking out from `master`.

```
git checkout second
git rm -rf .
git checkout master .
git commit -m B2 
```

This will create a new commit with a new message, author, and timestamp. If you all that to be the same, your best bet is...

## Using git-reparent (shameless plug)

Download [git-reparent](https://github.com/MarkLodato/git-reparent), install it in your `$PATH`, and then

```
git checkout second
git branch parent
git reset --hard master
git reparent -p parent
git branch -d parent 
```

Explanation:

1.  Switch to the branch we want to modify (`second`).
2.  Save a pointer (`parent`) to the current commit.
3.  Point the commit that we want to end up at (`master`).
4.  Modify the current branch (`second`) to have the contents of the current commit but have the given parents (`parent`).
5.  Delete our saved pointer (`parent`).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T23:55:47.610

我假设当前分支是`second`. 如果您不满意`git reset --HARD master`（因为如果在任何地方发布它将需要强制推送），您可以通过（或者只是如果您不想列出所有提交，例如 B1）`second`撤消 B1 ，然后.`git revert B1``git revert master..second``git merge master`

使用@StevenPenny 的想法和`ours`策略我想出了这个解决方案：

```
git checkout master
git checkout -b transfer_second_to_master
git merge -s ours second
git checkout second
git merge transfer_second_to_master
git branch -d transfer_second_to_master 
```

这是一种`theirs`策略模拟，作为策略的倒置`ours`。现在`git diff master second`什么都不给，这意味着分支是相同的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-03T23:56:26.427

这听起来像是一份工作 [`git merge`](http://kernel.org/pub/software/scm/git/docs/git-merge.html)

```
git checkout master
git merge -s ours second 
```

更多信息

```
这解决了任意数量的头，但合并的结果树总是
当前分支头的变化，有效地忽略所有其他分支的所有更改
分支机构。它旨在用于取代side的旧开发历史
分支机构。

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-11T17:53:29.677

前

```
A1-----A2     (master, contains a:apple, b:banana, c:carrot)
 \
  \----B1     (second, contains a:apple, b:beets, d:dandelion) 
```

*   当前分支：第二
*   `git status`： 干净的

# 变体 1：没有引用 master（非常丑陋）

```
git read-tree -m -u master
git commit -m 'B2: copy of A2'
git diff master 
```

后：

```
A1-----A2      (master, contains a:apple, b:banana, c:carrot)
 \
  \----B1---B2 (second, contains a:apple, b:banana, c:carrot) 
```

*   当前分支：第二个（ff）
*   `git status`： 干净的
*   `diff`状态为`master`：干净

确认回退工作：

```
git reset --hard HEAD^
git clean -f
git branch -avv 
```

再次显示之前的状态。

这个变体有什么作用？

*   `git read-tree`将给定的其他提交（此处`master`）读入 INDEX
*   作为选项`-u`，它会相应地更新工作树
*   然后像往常一样将其提交到 B1
*   但是，它不会添加对“合并”树的引用。

# 变体 2：显示对 master 的合并引用（首选！）

对不起，我没有找到正确的方法。这是一种解决方法：

第一：做一个虚拟合并

```
git merge -s ours -m 'B2 dummy' master 
```

第二：修复合并到正确的数据

```
git read-tree -m -u master
git commit --amend -m 'B2: copy of A2' 
```

第三：检查它是否真的匹配`master`：

```
git diff master 
```

后：

```
A1-------A2    (master, contains a:apple, b:banana, c:carrot)
 \         \
  \----B1---B2 (second, contains a:apple, b:banana, c:carrot) 
```

*   当前分支：第二个（ff，合并，第一个父级：B1）
*   `git status`： 干净的
*   `diff`状态为`master`：干净

确认回退工作：

```
git reset --hard HEAD^
git clean -f
git branch -avv 
```

再次显示之前的状态，因为它应该。

这是如何运作的：

*   `git read-tree -m -u master`重置合并信息，所以我们不能开始合并，读取树然后提交这个合并，很遗憾。
*   但是我们想使用 option `-u`，因为这对于更新工作树至关重要。但是`-u`需要`-m`或类似的东西会让我们退出合并模式。
*   所以我们之前做了一个虚拟合并（并使用策略`ours`来防止合并冲突，这正是我们想要发生的错误事情）。
*   `git read-tree`然后我们根据需要从 master 读取状态
*   现在我们`amend`与现在终于正确的索引内容合并。
*   这将保留原始合并信息。
*   请注意，这是`ff`根据上游。

这有什么问题？

*   `git commit`意味着是原子的。要么你有一个正确的状态，要么没有。
*   然而，这引入了一种非原子情况，在这种情况下，竞争条件（停电）可能会使您的本地 git repo 处于某种不需要的状态
*   如果在自动设置中使用此策略，这是不好的，例如，在发布 (B1) 之后，当前上游（主）将用于重新启动以创建下一个版本（B2 和更高版本）。
*   因此，变体 2 不能被视为对此的最终定论。是的，它以某种方式有效，但它既不漂亮、干净也不完美。

其他解决方案似乎太复杂了。但也许我监督了一点？

*   要么使用完全难以理解的 git-plumbing 命令来自己创建正确的提交对象——不适合易于理解和使用的解决方案。

*   或者做一些非常复杂的子分支，然后快进到子分支，然后删除它 - 双重禁止，因为这甚至会引入更复杂的事情，比如如果出现问题需要进行复杂的清理。

*   或者找出需要哪些命令来将工作树更新为 a 之后的索引（就像`-u`已经可以做到的那样重新发明轮子）`git read-tree master`，因为这应该发生在（！）提交之前（像往常一样）。

# 去做

这尚未通过子模块进行彻底测试。如果它们被添加、删除、替换等，`.gitmodules`并且`.git/modules/`已经更新或阻止了一些东西。Loooooong 的故事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T02:22:20.533

听起来您只想`second`从 A2 开始分支。这很简单：

```
git branch -f second <commit-for-A2> 
```

该`-f`标志的意思是“重置分支以提交”。没有理由添加提交来展开/重置`second`分支。

[编辑] 如果您不能简单地重置，则执行 B1 的还原（在 上`second`），然后将 A2 从合并`master`到`second`. 像这样：

```
ebg@ebg(168)$ git log --graph --oneline --all
* ad6fb9d B1/b:beets;d:dandelion
| * 64c9f45 A2/c:carrot
|/  
* 07a4ceb A1/a:apple;b:banana
ebg@ebg(169)$ ls
a       b       d
ebg@ebg(170)$ git revert HEAD
[second 2b1de0c] Revert "B1/b:beets;d:dandelion"
 2 files changed, 1 insertion(+), 2 deletions(-)
 delete mode 100644 d
ebg@ebg(171)$ ls
a       b
ebg@ebg(172)$ git merge master
Merge made by the 'recursive' strategy.
 c |    1 +
 1 file changed, 1 insertion(+)
 create mode 100644 c
ebg@ebg(173)$ ls
a       b       c
ebg@ebg(174)$ git log --graph --oneline --all
*   0ffd24e Merge branch 'master' into second
|\  
| * 64c9f45 A2/c:carrot
* | 2b1de0c Revert "B1/b:beets;d:dandelion"
* | ad6fb9d B1/b:beets;d:dandelion
|/  
* 07a4ceb A1/a:apple;b:banana 
```

# c# - 从 .NET 中的 MS Access 查询中获取参数名称

> ID：15800151
> 
> 赞同：0
> 
> 时间：2013-04-03T23:41:12.780
> 
> 标签：c#, .net, ms-access, oledb

我有这个 C# 代码，它从 MDB 文件中获取第一个查询并执行它：

```
 OleDbConnection conn = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=c:\\db1.mdb");
        conn.Open();
        DataTable dt = conn.GetOleDbSchemaTable(OleDbSchemaGuid.Procedures, null);
        OleDbCommand cmd = new OleDbCommand();
        cmd.Connection = conn;
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = dt.Rows[0]["PROCEDURE_DEFINITION"].ToString();
        cmd.ExecuteReader(); 
```

我在最后一行收到错误，因为我没有为所需参数提供值。我希望此代码适用于任何查询，具有任意数量的参数，那么对于给定的查询，如何从 Access 获取参数列表？这样，我可以提示用户为每个值提供值，就像 Access 所做的那样。

我不认为我可以自己解析它们，因为查询可能如下所示：

从 [名称] = [昵称] 的订单中选择 *

在不知道表的所有字段名称的情况下（通过大量 JOINS 变得非常复杂），我不知道 [Name] 是表中的列还是需要提供的参数，与 [Nickname] 相同。我想我可以查找更多架构信息以获取所有字段名称......但希望有更简单的方法？

我正在尝试创建一个 Winforms .NET C# 表单，其中包含来自给定 MDB 文件的查询列表。用户可以选择这些查询中的任何一个，然后我将在 DataGridView 中显示结果。为了显示结果，我需要执行查询，但如果我不提供正确的参数，我将无法执行查询。

# sql - 在 SQL 中获得最成功的合作伙伴关系，也许使用条件 SUM？

> ID：15800154
> 
> 赞同：0
> 
> 时间：2013-04-03T23:41:50.713
> 
> 标签：sql

我有一个大型数据表，它是由队长将数据输入到电子表格中创建的，它基本上是我们当地羽毛球联赛的记分表。表示每个匹配项，并且该匹配项的所有数据都包含在该行中。例如日期、分区、主队、客队、球员、合作伙伴、得分等。

我试图从我的数据中得到的是最成功的合作伙伴关系。我已经开始使用以下方法识别所有不同的合作伙伴关系：

```
(SELECT "home mens 1" AS "mens" FROM "Results") UNION
(SELECT "home mens 2" AS "mens" FROM "Results") UNION
(SELECT "home mens 3" AS "mens" FROM "Results") UNION
(SELECT "away mens 1" AS "mens" FROM "Results") UNION
(SELECT "away mens 2" AS "mens" FROM "Results") UNION
(SELECT "away mens 3" AS "mens" FROM "Results") ORDER BY "mens" 
```

这给了我一个很好的配对清单。您可以在此处查看数据表，列标题：[https ://docs.google.com/spreadsheet/pub?key=0AkFtD3i39wUZdFJSbVVXUUVvNi0wSXNmNEJ5XzhCWEE&output=html](https://docs.google.com/spreadsheet/pub?key=0AkFtD3i39wUZdFJSbVVXUUVvNi0wSXNmNEJ5XzhCWEE&output=html)

如果不可能，或者如果我应该以某种方式重组数据，那么我很想听听替代解决方案。

我试过了：

```
(SELECT "home mens 1" AS "mens", SUM("home score game 1" + "home score game 2") AS "points total" FROM "Results") UNION
(SELECT "home mens 2" AS "mens", SUM("home score game 5" + "home score game 6") AS     "points total" FROM "Results") UNION
(SELECT "home mens 3" AS "mens", SUM("home score game 9" + "home score game 10") AS "points total" FROM "Results") UNION
(SELECT "away mens 1" AS "mens", SUM("away score game 1" + "away score game 2") AS "points total" FROM "Results") UNION
(SELECT "away mens 2" AS "mens", SUM("away score game 5" + "away score game 6") AS "points total" FROM "Results") UNION
(SELECT "away mens 3" AS "mens", SUM("away score game 9" + "away score game 10") AS "points total" FROM "Results") ORDER BY "mens"` 
```

但似乎根本不起作用..

在伙伴关系与游戏分数的关系方面：与配对相关的分数列如下：

*   男子对 1 玩游戏 1 和 2
*   女士对 1 玩游戏 3 和 4
*   男双 2 玩游戏 5 和 6
*   女士对 2 玩游戏 7 和 8
*   男子双人 3 玩游戏 9 和 10
*   女士对 3 玩游戏 11 和 12
*   混合对 1 玩游戏 13 和 14
*   混合双人玩游戏 15 和 16
*   混合对 3 玩游戏 17 和 18。

最成功的一对将是赢得最多比赛（得分为 15）的一对，然后是每场比赛平均得分最高的一对。

我在 OpenOffice Base 中执行此操作，虽然就 SQL 而言，我不确定这是基于什么 - 显然这意味着它正在使用 HSQL：[http ://www.oooforum.org/forum/viewtopic.phtml?t=140063](http://www.oooforum.org/forum/viewtopic.phtml?t=140063)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:38:17.720

假设列的内容是您所说的“伙伴关系”，那么您就在正确的轨道上。您需要对您指定的查询进行聚合、计数和排序。此外，您想使用`union all`而不是`union`, 因为`union`删除重复项 - 这是您想要找到的：

```
select "mens", count(*) as cnt
from ((SELECT "home mens 1" AS "mens" FROM "Results") UNION all
      (SELECT "home mens 2" AS "mens" FROM "Results") UNION all
      (SELECT "home mens 3" AS "mens" FROM "Results") UNION all
      (SELECT "away mens 1" AS "mens" FROM "Results") UNION all
      (SELECT "away mens 2" AS "mens" FROM "Results") UNION all
      (SELECT "away mens 3" AS "mens" FROM "Results")
     ) t
group by "mens"
order by count(*) desc 
```

这也许只是一个开始。您需要处理拼写差异，并且成功的定义可能不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:20:58.930

我认为您的数据遗漏了一些东西，这导致您无法准确找到“最成功的合作伙伴”。你有所有的合伙人，所有的比赛得分，但是哪个合伙人得到哪个比赛得分和多少得分之间没有关系。否则，不难发现你想要什么。

**如何找到最成功的主队合作伙伴关系的一个示例**

注意：假设 RDBMS 是 Oracle，未经测试的代码

```
 SELECT A.Partner, 
       SUM(CASE WHEN "GameScore" = 15 THEN 1 ELSE 0 END) AS "NumberOfWin", 
       AVG("GameScore") as "AvgGameScore"
FROM (
SELECT "home mens 1" AS "Partner", "home score game 1"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mens 1" AS "Partner", "home score game 2"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home ladies 1" AS "Partner", "home score game 3"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home ladies 1" AS "Partner", "home score game 4"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mens 2" AS "Partner", "home score game 5"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mens 2" AS "Partner", "home score game 6"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home ladies 2" AS "Partner", "home score game 7"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home ladies 2" AS "Partner", "home score game 8"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mens 3" AS "Partner", "home score game 9"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mens 3" AS "Partner", "home score game 10"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home ladies 3" AS "Partner", "home score game 11"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home ladies 3" AS "Partner", "home score game 12"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mixed 1" AS "Partner", "home score game 13"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mixed 1" AS "Partner", "home score game 14"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mixed 2" AS "Partner", "home score game 15"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mixed 2" AS "Partner", "home score game 16"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mixed 3" AS "Partner", "home score game 17"  AS  "GameScore" FROM "Results"  UNION ALL
SELECT "home mixed 3" AS "Partner", "home score game 18"  AS  "GameScore" FROM "Results"  
) A
GROUP BY A.Partner
ORDER BY SUM(CASE WHEN "GameScore" = 15 THEN 1 ELSE 0 END), AVG("GameScore") 
```

# actionscript-3 - 发出 HTTP 请求时访问重定向到的 URL

> ID：15800155
> 
> 赞同：3
> 
> 时间：2013-04-03T23:41:53.700
> 
> 标签：actionscript-3, flash, apache-flex

当发出导致重定向的 HTTP 请求（例如，使用 URLLoader）时，是否可以访问重定向链中的任何 URL？

例如，假设发生以下情况：

1.  我们向 example.com/a.gif 提出请求
2.  example.com 重定向到 example2.com/b.gif
3.  example2.com 重定向到 example3.com/c.gif

我已经盯着 URLLoader 及其各种事件的文档看了一段时间，似乎也没有办法：

1.  指示 URLLoader 不遵循重定向
2.  访问初始请求后涉及的任何 URL

有谁知道是否有办法做到这一点？我不喜欢使用 URLLoader，所以如果有另一个类支持此功能，我会很好地使用它。

谁能指出我正确的方向？提前致谢！

**编辑**- 我应该澄清一下：我知道如何使用 DOM 调试器检测 AS3 之外的重定向。我对访问 AS3 中的重定向链特别感兴趣。似乎可以通过[HttpStatusEvent](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/events/HTTPStatusEvent.html#responseURL)使用 AIR 播放器，但使用 Flash Player 时相关属性不可用。

**编辑 2** - 我也尝试过使用 HTTP 客户端库（具体来说是 as3httpclientlib）。除了它从端口 843 加载跨域策略而不是通过向 /crossdomain.xml 发出 HTTP 请求这一事实之外，这有效。我正在使用的上下文需要后者，因此除非有一种方法可以强制 Socket 从 HTTP 而不是端口 843 加载跨域策略，否则使用带有 Socket 底层的东西是行不通的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:23:25.723

重定向通常到位，因为不应再使用原始 URL。该文件在 example.com/a.gif 上不存在，因此理论上您不需要知道它。为什么需要中间请求路径？

我不知道为任何请求找到重定向链的动作脚本方式，但如果您想为特定链执行此操作，您可以使用 HttpFox for Firefox，或者在谷歌浏览器中点击 f12 并在制作时查看网络选项卡对重定向 URL 的请求。这仅在客户端被服务器重定向到新地址（HTTP 302 响应或类似内容）时才有效。如果服务器选择在某人的浏览器询问 example.com/ 时返回 example3.com/c.gif 的内容a.gif 你无能为力。

# php - 如何将 If then 语句放入 php 中的 mysql_fetch_array() 语句中

> ID：15800158
> 
> 赞同：0
> 
> 时间：2013-04-03T23:42:27.723
> 
> 标签：php, mysql, arrays, html-table

我有一个数据库和表来获取 OID 结果并将它们插入到表中。这个表里面有多种类型的值，我需要最终表能够区分它们。我将结果按 group by 排序，并将结果过滤到表格中`mysql_fetch_array()`。

继承人我有代码明智的。

```
$result = mysql_query("SELECT MAX(t1)AS t1, device, test, value FROM ACRC WHERE        test='Fan Speed' GROUP BY device, test ORDER BY device ASC, test ASC LIMIT 4");

echo "<table border='3' cellpadding='3'>
    <tr>
    <th>Timestamp</th>
    <th>Unit</th>
    <th>Test</th>
    <th>Result</th>
    </tr>
    <tbody>";

while($row = mysql_fetch_array($result))
    {
    echo"<tr>";
    echo"<td>". $row['t1']. "</td>";
    echo"<td>". $row['device']. "</td>";
    echo"<td>". $row['test']. "</td>";
    echo"<td>". $row['value']." %</td>";
    echo"</tr>";
    }

$result = mysql_query("SELECT MAX(t1)AS t1, device, test, value FROM ACRC WHERE test<>'Fan Speed' GROUP BY device, test ORDER BY  test ASC, device ASC LIMIT 8");

while($row = mysql_fetch_array($result))
    {
    echo"<tr>";
    echo"<td>". $row['t1']. "</td>";
    echo"<td>". $row['device']. "</td>";
    echo"<td>". $row['test']. "</td>";
    echo"<td>". $row['value']." F</td>";
    echo"</tr>";
    }

echo"</table>"; 
```

此设置当前有效，但我想`mysql_fetch_array()`使用 if/then/else 语句将其压缩为一个，因为每当风扇速度在测试列中时，该值都会在其表方的末尾添加一个 % 并且每当显示温度时在测试列中，我需要一个 F 出现在值方格中。数据当前在我的数据库中存储为一个简单的整数。

```
 --------------------
|Fan Speed  | 55   % |
----------------------
|Temperature| 70   F |
 -------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:51:29.947

只需摆脱您的 WHERE 条件，以便所有结果都出现在一个查询中。然后，正如您在问题标题中提到的那样，使用`if()`回显结果的条件来确定您是否输出 a `%`、`F`或任何下一个高于该值的值。

```
while($row = mysql_fetch_array($result))
    {
?>
<tr>
    <td><?php echo $row['t1']; ?></td>
    <td><?php echo $row['device']; ?></td>
    <td><?php echo $row['test']; ?></td>
    <td><?php echo $row['value']; ?> <?php echo('$row['test'] === 'Fan Speed' ? '%' : 'F'); ?></td>
</tr>
<?php
    } 
```

或者，如果你想花哨并保持代码干净，你甚至可以在 SQL 查询中使用 case 语句来填充一个新字段，如下所示：

```
SELECT
  MAX(t1)AS t1,
  device,
  test,
  value,
  (CASE test WHEN 'Fan Speed' THEN '%' ELSE 'F') AS symbol
FROM ACRC
... 
```

代码可能是：

```
while($row = mysql_fetch_array($result))
    {
?>
<tr>
    <td><?php echo $row['t1']; ?></td>
    <td><?php echo $row['device']; ?></td>
    <td><?php echo $row['test']; ?></td>
    <td><?php echo $row['value'] . ' ' . $row['symbol']; ?></td>
</tr>
<?php
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:54:05.190

如果我没有正确理解，请告诉我！

```
while($row = mysql_fetch_array($result))
    {
if( $row['value']==70)
{
    echo"<tr>";

    echo"<td>". $row['device']. "</td><td>F</td>";

    echo"</tr>";
    }else
{
 echo"<tr>";

    echo"<td>". $row['device']. "</td><td>" % . "</td> 

    echo"</tr>";
}
} 
```

# java - 如何在 JLabel 周围制作不可见的边框？(JAVA)

> ID：15800159
> 
> 赞同：3
> 
> 时间：2013-04-03T23:42:31.350
> 
> 标签：java, swing, jframe, border, jlabel

我一直在寻找如何在 JLabel 周围制作边框。但我不希望它没有颜色。提前致谢。

```
public TitlePanel()
{
    title = new JLabel("This is some text!", JLabel.CENTER);
    add(title);

    //This will make a black border around the "title" label
    title.setBorder(new LineBorder(new Color(0,0,0)));
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-03T23:43:38.240

只需使用[`EmptyBorder`](http://docs.oracle.com/javase/7/docs/api/javax/swing/border/EmptyBorder.html)

`title.setBorder(new EmptyBorder(10, 10, 10, 10));`

查看[如何使用边框](http://docs.oracle.com/javase/tutorial/uiswing/components/border.html)以获取更多示例

**更新**

正如 Eng.Fouad 所建议的，您确实应该使用`BorderFactory`来生成边框。

`title.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));`

一般来说，这可以减少应用程序创建的对象数量

# racket - PLT Redex：参数化语言定义

> ID：15800167
> 
> 赞同：13
> 
> 时间：2013-04-03T23:43:15.240
> 
> 标签：racket, formal-semantics, plt-redex

这是一个困扰我一段时间的问题，我想知道这里是否有人可以提供帮助。

我有一个名为 lambdaLVar 的语言的 PLT Redex 模型，它或多或少是一种普通的无类型 lambda 演算，但扩展了包含“晶格变量”或 LVars 的存储。LVar 是一个变量，其值只能随时间增加，其中“增加”的含义由语言用户指定的部分有序集合（又名格）给出。因此 lambdaLVar 实际上是一个语言家族——用一个格子实例化它，你就会得到一种语言；用不同的格子，你得到另一个。你可以看看[这里](https://github.com/iu-parfunc/lvars/tree/master/redex)的代码；重要的东西在[lambdaLVar.rkt](https://github.com/iu-parfunc/lvars/blob/master/redex/lambdaLVar.rkt)中。

在 lambdaLVar 的纸上定义中，语言定义由用户指定的格参数化。很长一段时间以来，我都想在 Redex 模型中做同样的参数化，但到目前为止，我还没有弄清楚如何做。部分麻烦在于语言的*语法*取决于用户如何实例化格：格的元素成为语法中的终结符。我不知道如何在 Redex 中表达一个在格上抽象的语法。

同时，我尝试使 lambdaLVar.rkt 尽可能模块化。该文件中定义的语言专门用于特定的格：自然数`max`作为最小上界（lub）操作。（或者，等效地，按 . 排序的自然数`<=`。这是一个非常无聊的格子。）特定于该格子的代码的唯一部分是`(define lub-op max)`靠近顶部的行，并`natural`出现在语法中。（有一个`lub`根据用户指定的函数定义的元`lub-op`函数。后者只是一个 Racket 函数，因此`lub`必须转义到 Racket 才能调用`lub-op`。）

除非能够以一种对晶格选择抽象的方式实际指定 lambdaLVar，否则我似乎应该能够编写一个具有最简单晶格的 lambdaLVar 版本——只有 Bot 和 Top 元素，其中Bot <= Top -- 然后`define-extended-language`用来添加更多东西。例如，我可以定义一种名为 lambdaLVar-nats 的语言，它专门用于我描述的 naturals lattice：

```
;; Grammar for elements of a lattice of natural numbers.
(define-extended-language lambdaLVar-nats
  lambdaLVar
  (StoreVal .... ;; Extend the original language
            natural))

;; All we have to specify is the lub operation; leq is implicitly <=
(define-metafunction/extension lub lambdaLVar-nats
  lub-nats : d d -> d
  [(lub-nats d_1 d_2) ,(max (term d_1) (term d_2))]) 
```

然后，为了替换两个归约关系`slow-rr`以及`fast-rr`我为 lambdaLVar 所拥有的关系，我可以定义几个包装器：

```
(define nats-slow-rr
  (extend-reduction-relation slow-rr
                             lambdaLVar-nats))

(define nats-fast-rr
  (extend-reduction-relation fast-rr
                             lambdaLVar-nats)) 
```

我对文档的理解`extend-reduction-relation`是，它应该重新解释 and 中的规则`slow-rr`，`fast-rr`但使用 lambdaLVar-nats。将所有这些放在一起，我尝试使用新的扩展缩减关系之一运行我拥有的测试套件：

```
> (program-test-suite nats-slow-rr) 
```

我收到的第一件事是违反合同的投诉：`small-step-base: input (((l 3)) new) at position 1 does not match its contract`. small-step-base 的契约线是 just `#:contract (small-step-base Config Config)`，其中`Config`是一个语法非终结符，如果在 lambdaLVar-nats 下重新解释比在 lambdaLVar 下重新解释，它具有新的含义，因为特定的格子的东西。作为一个实验，我摆脱了 和 的`small-step-base`合同`small-step-slow`。

然后我能够实际运行我的 19 个测试程序，但其中有 10 个失败了。也许不足为奇的是，所有失败的程序都是以某种方式使用自然数值 LVar 的程序。（其余的是完全不与 LVar 存储交互的“纯”程序。）因此，失败的测试正是使用扩展语法的测试。

所以我一直在跟踪兔子洞，似乎 Redex 想要我扩展所有现有的判断形式和元函数，以与 lambdaLVar-nats 而不是 lambdaLVar 相关联。这是有道理的，据我所知，它似乎对判断形式有效，但是对于元函数我遇到了麻烦：我希望新的元函数重载同名的旧元函数（因为现有的判断形式正在使用它) 并且似乎没有办法做到这一点。如果我必须重命名元函数，那就达不到目的了，因为无论如何我都必须编写全新的判断形式。我想我想要的是一种元函数调用的后期绑定！

**简而言之，我的问题是：** Redex 中是否有任何方法可以以我想要的方式参数化语言的定义，或者以某种方式扩展语言的定义，从而满足我的需求？我最终只需要编写生成 Redex 的宏吗？

谢谢阅读！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-06T18:58:09.713

我询问了 Racket 用户的邮件列表；线程从[这里](http://lists.racket-lang.org/users/archive/2013-April/057075.html)开始。总结一下由此产生的讨论：在今天的 Redex 中，答案是**否定**的，没有办法以我想要的方式参数化语言定义。但是，在带有模块系统的未来版本的 Redex 中*应该是可能的，目前正在开发中。*

`define-extended-language`以我在这里尝试的方式尝试使用 Redex 的现有扩展形式（ 、等）也不起作用`extend-reduction-relation`，因为 - 正如我发现的那样 - 原始元函数不会被传递性重新解释以使用扩展语言。但是模块系统显然也会对此有所帮助，因为它允许您将元函数、判断形式和归约关系打包在一起并同时扩展它们（参见[此处](http://lists.racket-lang.org/users/archive/2013-April/057076.html)的讨论）。

所以，就目前而言，答案确实是编写一个 Redex 生成宏。像这样的工作：

```
(define-syntax-rule (define-lambdaLVar-language name lub-op lattice-values ...)
  (begin
    ;; Entire original Redex model goes here, with `natural` replaced with
    ;; `lattice-values ...`, and instances of `...` replaced with `(... ...)`
)) 
```

然后你可以实例化特定的格子，例如：

```
(define-lambdaLVar-language lambdaLVar-nat max natural) 
```

我希望 Redex 能尽快获得模块，但与此同时，这似乎运作良好。

# javascript - 点击链接滚动到 div

> ID：15800175
> 
> 赞同：0
> 
> 时间：2013-04-03T23:43:52.713
> 
> 标签：javascript, jquery, hyperlink, scroll

关于这个主题，到处都有问题，但我为此尝试了很多不同的脚本，但我无法让它与我的网站一起使用。

我正在为自己构建一个个人作品集 wordpress 主题，并希望将其保留为单页主题。我想要的是当用户单击导航上的链接时，页面会向下滚动到该部分。容易吧？不。

我不知道为什么它在我的网站上不起作用，但我认为这与我用于滚动到固定导航的脚本有关。

这是我目前尝试用来创建此页内导航滚动效果的脚本： http: [//css-tricks.com/snippets/jquery/smooth-scrolling/](http://css-tricks.com/snippets/jquery/smooth-scrolling/)

这是我用来创建滚动到固定导航效果的脚本：

```
window.onscroll=function () {
    var top = window.pageXOffset ? window.pageXOffset : document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop;
    if(top > 640){
        document.getElementById("nav").style.position = "fixed";
        document.getElementById("nav").style.height="65px";
    } else {
        document.getElementById("nav").style.position = "relative";
        document.getElementById("nav").style.height="65px";
    }
} 
```

[您可以在http://www.tylerb.me](http://www.tylerb.me)查看我正在尝试执行此操作的网站

这两个脚本是否相互矛盾并使其中一个不起作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T23:57:51.293

看起来wordpress使用该`jQuery.noConflict()`方法来防止发生冲突。由于脚本冲突（例如，moo 工具也使用 $），请将每个替换`$`为`jQuery`. 这应该可以解决您的问题..我的意思是在调用插件的代码中，而不是插件本身。

例子：

```
//normal jquery method call:
$("element").method(etc);

//with noConflict code:
jQuery("element").method(etc); 
```

**更新 1：**

看起来你忘了留下一个特定的`$`人。这一行：

```
var target = jQuery(this.hash), target = this.hash; 
```

应该是这样的：

```
var $target = jQuery(this.hash), target = this.hash; 
```

这当然适用于任何以 a 开头的变量`$`。那些不应该被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:55:47.573

您的问题的核心是 jQuery 没有加载。

![在此处输入图像描述](https://i.stack.imgur.com/glFNA.png)

代达罗斯比我先到那里。这不是导致您的问题的冲突。只需使用 jQuery 而不是 $。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-17T07:56:32.370

这可能对某些人有用。

尝试使用：

```
jQuery(document).ready(function($){
    // do stuff here using $
}); 
```

代替

```
$(document).ready(function($){
    // do stuff here
}); 
```

这声明了一个本地 $ 而不是与先前声明的冲突。

它帮助了我很多次。

# c# - 存储过程解析器

> ID：15800176
> 
> 赞同：2
> 
> 时间：2013-04-03T23:43:57.450
> 
> 标签：c#, sql-server-2005, stored-procedures, text-parsing, sql-parser

我试图解析数百个存储过程，以专门获取它们的输出变量“@FirstName”、它们使用哪些表以及它们从“MyTbl.FirstName”中提取哪些字段。我能够很容易地收集变量，但我在收集表名时遇到了麻烦。有人可以帮忙吗？

到目前为止，我已经能够通过使用 StreamReader 解析 SQL 文件并逐行收集信息来提取这些字段中的大部分，例如，如果一行包含输出，那么我知道该行中的第一个文本很可能是@多变的。

```
@Address1 varchar(45) output,
@Address2 varchar(45) output,
@City varchar(35) output,
@State varchar(2) output,
@Zip varchar(10) output 
```

从那里我可以将@Variable 存储到字典中，如果任何行包含@Variable 并且还包含'='，那么我知道我们有一个匹配它对应的字段。

```
@Address1 = c.Address,          
@Address2 = c.AddressSecondLine,
@City = c.City,
@State = c.State,
@Zip = c.ZipOrPostalCode 
```

现在我只是在收集表名时遇到问题。我可以轻松地从字段名称中解析表别名，但在将别名与表名匹配时遇到问题。有谁知道这样做的好方法？这是我到目前为止一直在尝试的：

```
FROM Table.dbo.SalesStuff ss
LEFT OUTER JOIN Table.dbo.Customer c ON ss.CustNo = c.CustNo
Left JOIN Table.dbo.Vending v on @tmpVin = v.vin 
```

代码：

```
keyColl = tables.Keys;
foreach (string var in keyColl)
{
    if (line.Contains(" " + var + '\r') || line.Contains(" " + var + " ") || line.Contains(" " + var + ((char)13)) || line.Contains(" " + var + Environment.NewLine))
    {
        tables[var] = line.ToString();
        break;
    }    
} 
```

我认为这将与表别名匹配，因为大多数别名都是一个字母，后跟一个换行符，但到目前为止我还没有得到任何表名......有人知道吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T00:23:02.267

坦率地说，我认为您的解析想法不会走得太远。您正在对如何在每个过程中格式化代码做出非常大胆的假设。我对格式化非常细致，但我无法保证你在这么多程序中所依赖的那种一致性，即使我自己写了它们。

需要注意的是延迟名称解析可能会在后面咬你，并且依赖关系跟踪在 SQL Server 2005 中肯定远非完美（[请参阅我发布的解决方法，即使在 SQL Server 2008 中也能保持准确](https://sqlblog.org/2008/09/09/keeping-sysdepends-up-to-date-in-sql-server-2008)），这里有几个想法（而且它们也不完美，但它们肯定会减少白发）：

1.  通过使用目录视图，您可以以比暴力解析更简单的方式获取参数`sys.parameters`：

    ```
     SELECT OBJECT_NAME([object_id]), p.name, t.name
       FROM sys.parameters AS p
       INNER JOIN sys.types AS t
       ON p.system_type_id = t.system_type_id
       WHERE p.is_output = 1; 
    ```

2.  如果您的所有过程都已重新编译并且您不会遇到延迟名称解析问题，您可以从中获取表名和列名`sys.sql_dependencies`- 但是这将包括在 where/join 子句中引用的列，即使它们不在 select 中列表：

    ```
     SELECT [procedure] = OBJECT_NAME(d.[object_id]),
       [table] = OBJECT_NAME(d.referenced_major_id),
       [column] = c.name
       FROM sys.sql_dependencies AS d
       INNER JOIN sys.columns AS c
       ON c.[object_id] = d.referenced_major_id
       AND c.column_id = d.referenced_minor_id; 
    ```

这里有一列叫做`is_selected`，但我还没有发现它是准确/可靠的。

请注意，动态 SQL 中发生的任何事情都保留在动态 SQL 中——因此，如果您的过程使用动态 SQL，则几乎不可能剔除表/列名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:19:21.803

你可以使用[正则表达式](http://msdn.microsoft.com/en-us/library/hs600312.aspx)。例如对于像这样的字符串

```
FROM Table.dbo.SalesStuff ss 
```

您可以使用

```
 string pattern = @"\s*FROM\s+Table\.dbo\.(\w+)\s+(\w+)";
  string input = "line from stored proc body here";
  MatchCollection matches = Regex.Matches(input, pattern);

  foreach (Match match in matches)
  {
     Console.WriteLine("table name:       {0}", match.Groups[1].Value);
     Console.WriteLine("Alias:            {0}", match.Groups[2].Value);
     Console.WriteLine();
  } 
```

您必须为包含表名和别名的每种类型的字符串定义模式。

# iphone - 包含 Flurry 分析后，如何让我的构建在 xcode 中成功？

> ID：15800177
> 
> 赞同：1
> 
> 时间：2013-04-03T23:43:59.727
> 
> 标签：iphone, analytics, flurry

我在我的项目中包含了标有“Flurry”的文件夹。我在 AppDelegate.m 中添加了以下行：

```
#import "Flurry.h"

- (void)applicationDidFinishLaunching:(UIApplication *)application
{
    [Flurry startSession:@"my_key"];
} 
```

但是，尝试运行后出现 7 个错误。

```
Undefined symbols for architecture i386:
  "_SCNetworkReachabilityCreateWithAddress", referenced from:
      +[FlurryReachability flurryReachabilityWithAddress:] in libFlurry.a(libFlurry.a-i386-master.o)
  "_SCNetworkReachabilityCreateWithName", referenced from:
      +[FlurryReachability flurryReachabilityWithHostName:] in libFlurry.a(libFlurry.a-i386-master.o)
  "_SCNetworkReachabilityGetFlags", referenced from:
      -[FlurryReachability flurryCurrentReachabilityStatus] in libFlurry.a(libFlurry.a-i386-master.o)
      -[FlurryReachability isFlurryReachable] in libFlurry.a(libFlurry.a-i386-master.o)
      -[FlurryReachability isFlurryConnectionRequired] in libFlurry.a(libFlurry.a-i386-master.o)
      -[FlurryReachability isFlurryConnectionOnDemand] in libFlurry.a(libFlurry.a-i386-master.o)
      -[FlurryReachability isFlurryUserInterventionRequired] in libFlurry.a(libFlurry.a-i386-master.o)
      -[FlurryReachability isFlurryReachableViaWWAN] in libFlurry.a(libFlurry.a-i386-master.o)
      -[FlurryReachability isFlurryReachableViaWiFi] in libFlurry.a(libFlurry.a-i386-master.o)
      ...
  "_SCNetworkReachabilityScheduleWithRunLoop", referenced from:
      -[FlurryReachability flurryStartNotifier] in libFlurry.a(libFlurry.a-i386-master.o)
  "_SCNetworkReachabilitySetCallback", referenced from:
      -[FlurryReachability flurryStartNotifier] in libFlurry.a(libFlurry.a-i386-master.o)
  "_SCNetworkReachabilityUnscheduleFromRunLoop", referenced from:
      -[FlurryReachability flurryStopNotifier] in libFlurry.a(libFlurry.a-i386-master.o)
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T00:15:10.607

您收到这些错误是因为 Flurry.h/.a 引用了 framework `SystemConfiguration.framework`，而您尚未将其添加到您的项目中。

要将其添加到您的项目中，请在 Xcode 中选择您的项目（在左侧导航的最顶部），然后选择您的目标。向下滚动到标题“链接的框架和库”。旁边会有一个带有小工具箱的项目列表。单击该列表底部的加号按钮。

在生成的弹出窗口中，搜索“SystemConfiguration”。双击它。

*对每个目标重复*

运行你的项目。构建成功。完毕。

# c++ - 从模板转换为 const int 的二叉搜索树错误

> ID：15800178
> 
> 赞同：1
> 
> 时间：2013-04-03T23:44:00.260
> 
> 标签：c++, binary-search-tree

我正在做作业，我正在尝试实现一些二叉搜索树功能。我对编程也很陌生，对编程没有太多经验。我已经写出了函数，但我想弄清楚我收到的错误。我收到的错误是`btree.h(76): error C2664: 'Node<T>::find_node' : cannot convert parameter 1 from 'Node<T> *' to 'const int &' with [ T=int ] Reason: cannot convert from 'Node<T> *' to 'const int' with [ T=int ]`

这就是为什么我也放 cpp 文件的原因。在 cpp 文件中也会出现错误。所有文件均由我的教授提供。我只需要向 node.h 添加 2 个方法，就是这样。这是cpp文件tree2.cpp中的错误

`tree2.cpp(28) : see reference to class template instantiation 'BinaryTree<elemType>' being compiled with [ elemType=int ]`

如果有人可以帮助解释如何通过建议解决错误，那就太好了。

btree.h

```
#include    <iostream>
#include    "node.h"
//using namespace std;

template < typename elemType >
class BinaryTree {
  public:
BinaryTree( );
~BinaryTree( );
void insert( const elemType & );
void remove( const elemType & );
void inorder( );
bool empty( );
void clear( );

private:
Node< elemType >    *_root;

BinaryTree( const BinaryTree & );
BinaryTree &operator =( const BinaryTree & );
void clear( Node< elemType > * );
};

template < typename elemType >
inline BinaryTree< elemType >::BinaryTree( ) : _root(0)
{
    cout << "BinaryTree::BinaryTree() "
       << "default constructor\n";
}

template < typename elemType >
inline BinaryTree< elemType >::~BinaryTree( )
{
   cout << "BinaryTree::~BinaryTree() destructor\n";
   clear( );
}

template < typename elemType >
inline void BinaryTree< elemType >::clear( )
{
   if( _root )
   {
      clear( _root );
      _root = 0;
   }
}

template < typename elemType >
inline void BinaryTree< elemType >::clear( Node< elemType > *pt )
{
   if( pt ) {
      cout << "clear( ) left of  "  << pt->value( ) << '\n';
      clear( pt->left( ) );
      cout << "clear( ) right of " << pt->value( ) << '\n';
      clear( pt->right( ) );
      delete pt;
    }
}

template < typename elemType >
inline void BinaryTree< elemType >::insert( const elemType &e )
{
   if( !_root )
   {
      _root = new Node< elemType >( e );
   }
   else
   {
      _root->insert_value( e );
   }
}

template < typename elemType >
inline void BinaryTree< elemType >::remove( const elemType &e )
{
  _root->find_node( _root, e );
}

template < typename elemType>
inline void BinaryTree< elemType >::inorder( )
{
   _root->inorder( _root );
   cout << '\n';
} 
```

`node.h`

```
#ifndef     NODE_H

#define     NODE_H

#include    <string>

using namespace std;

template< typename T >
class Node
{
  public:
      Node( const T &);

      T  value( )  const;
      T  value( const T & );

      void insert_value( const T & );
      void inorder( const Node * );
      void find_node( const T &val, const T* root );
    //bool find_node( const T &val, Node < T > *node) const;
      void delete_node( Node< T > *&p );

      Node *  left ( ) const;
      Node *  left ( Node * );
      Node *  right( ) const;
      Node *  right( Node * );

   private:
      T       _value;
      Node *  _left;
      Node *  _right;
      Node< T > * root; //point to root node
      Node::Node( const Node & );
      Node &operator =( const Node & );

};

template< typename T >
inline Node< T >::Node( const T &rhs )
{
   _value = rhs;                       // assign rhs to _value
   _left  =  _right = 0;               // node is not part of a tree yet
}

template< typename T >
inline T Node< T >::value( ) const
{
   return _value;
}

template< typename T >
inline T Node< T >::value( const T &rhs )
{
   _value = rhs;                       // new value for _value
   return _value;
}

template< typename T >
inline Node< T > *Node< T >::left( ) const
{
   return _left;
}

template< typename T >
inline Node< T > *Node< T >::left( Node< T > *rhs )
{
   _left = rhs;

   return _left;
}

template< typename T >
inline Node< T > *Node< T >::right( ) const
{
   return _right;
}

template< typename T >
inline Node< T > *Node< T >::right( Node< T > *rhs )
{
   _right = rhs;
   return _right;
}

template< typename T >
inline void Node< T >::insert_value( const T &val )
{
    if( val == _value )
{
    return;                     // value already in the tree
}
if( val < _value )              // val should appear at the left
{
    if( ! _left )               // no left subtree ?
    {                           // add new node here
        _left = new Node( val );
    }
    else                        // try the subtree
    {
        _left->insert_value( val );
    }
}
else                            // val should appear at the right
{
    if( ! _right )              // no right subtree ?
    {                           // add new node here
        _right = new Node( val );
    }
    else                        // try the subtree
    {
        _right->insert_value( val );
    }
  }
}

template< typename T >
inline void Node< T >::inorder( const Node< T > *pt )
{
   if( pt )
   {
      inorder( pt->_left );
      cout << std::hex << pt->_left << std::dec << '\t';
      cout << std::hex << pt << std::dec << '\t';
      cout << std::hex << pt->_right << std::dec << '\t';
      cout << pt->_value << '\n';
      inorder( pt->_right );
   }
}

template <typename T>
Node<T> const * find_node(const T &val)
{
   Node<T> const * curr = root;
   while( curr != 0 )
   {
      if (val == curr -> _value)  {
       break;
    }
    else if (val < curr -> _value) {
        curr = curr -> _left;
    |
    else {
        curr = curr -> _right;
    }
}
return curr;
}
}

template <typename T >
inline void find_node( const T & val, const T * root ) {
Node<T> const * ptrFoundNode = find_node_pointer( val, root );
if( ptrFoundNode ) {
    delete_node( ptrFoundNode, root );
  }
}

template< typename T >
inline void Node< T >::delete_node(Node < T > *&p)
{

Node<T> *curr, *prev, *temp;
   if (p == NULL) return;
   if (p->_left == NULL && p->_right == NULL) {
    // no children - easy
    // *** if allowing counted duplicates:
    // ***    if (p->getCount() > 1) (*p)--;
    // ***    else {
       temp = p;
       p = NULL;
       delete temp;
    }
 else if (p->_left == NULL) {
    // only a right child - still easy
    // *** if allowing counted duplicates:
    // ***    if (p->getCount() > 1) (*p)--;
    // ***    else {
       temp = p;
       p = temp->_right;
       delete temp;
    }
 else if (p->_right == NULL) {
    // only a left child - still easy
    // *** if allowing counted duplicates:
    // ***    if (p->getCount() > 1) (*p)--;
    // ***    else {
       temp = p;
       p = temp->_left;
       delete temp;
    }
 else {
    // two children - this is the hard case
    // use successor: once right, then as far left as possible
    // *** if allowing counted duplicates:
    // ***    if (p->getCount() > 1) (*p)--;
    // ***    else {
       curr = p->_right;
       prev = NULL;
       while (curr->_left != NULL) {
           prev = curr;
           curr = curr->left;
       }
       p->data = curr->data;
       if (prev == NULL) p->_right = curr->_right;
       else prev->_left = curr->_right;

       delete curr;
   }
}

#endif 
```

`tree2.cpp`

```
#include    "btree.h"
#include    <fstream>
#include    <string>

using namespace std;

ifstream get_ifs( )                             // get input file stream
{
   string filename;                            // input file name

   cerr << "name of file to read from? ";
   cin  >> filename;

   ifstream ifs( filename, ifstream::in );
   if( ! ifs )                                 // cannot open file infilen
   {
      cerr << "cannot open input file '" << filename << "'\n";
      exit( 1 );
   }

   return ifs;                                 // return input file stream
}

int main()
{
   BinaryTree< int > bt;

   bt.insert( 30 );
   bt.insert( 20 );
   bt.insert( 40 );
   bt.insert( 50 );
   bt.insert( 10 );
   bt.insert( 15 );
   bt.insert( 35 );

   cout << "inorder traversal:\n";
   bt.inorder( );

   ifstream ifs = get_ifs( );

   string cmd;
   int    value;

   while( ifs >> cmd )
   {
      ifs >> value;

      cout << cmd << '\t' << value << '\n';

      if( cmd == "a" )
      {
          bt.insert( value );
      }
      else if( cmd == "d" )
      {
          bt.remove( value );
       }
      else
      {
          cout << "invalid command '" << cmd << "' ignored...\n\n";
      }

      bt.inorder( );
      cout << '\n';
   }

   return 0;
} 
```

`tree1.cpp`

```
#include    "btree.h"
#include    <fstream>
#include    <string>

using namespace std;

ifstream get_ifs( )                             // get input file stream
{
   string filename;                            // input file name

   cerr << "name of file to read from? ";
   cin  >> filename;

   ifstream ifs( filename, ifstream::in );
   if( ! ifs )                                 // cannot open file infilen
   {
      cerr << "cannot open input file '" << filename << "'\n";
      exit( 1 );
   }

   return ifs;                                 // return input file stream
}

int main()
{
   BinaryTree< string > bt;

   bt.insert( "Florida" );
   bt.insert( "California" );
   bt.insert( "Alabama" );
   bt.insert( "Mississippi" );
   bt.insert( "Georgia" );
   bt.insert( "Colorado" );
   bt.insert( "Idaho" );
   bt.insert( "Missouri" );
   bt.insert( "New York" );

   cout << "inorder traversal:\n";
   bt.inorder( );

   ifstream ifs = get_ifs( );

   string cmd, value;
   while( ifs >> cmd )
   {
      ifs >> value;

      cout << cmd << '\t' << value << '\n';

      if( cmd == "a" )
      {
          bt.insert( value );
      }
      else if( cmd == "d" )
      {
          bt.remove( value );
      }
      else
      {
          cout << "invalid command '" << cmd << "' ignored...\n\n";
      }

      bt.inorder( );
      cout << '\n';
   }

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:26:54.313

是否更改以下行

```
inline void find_node(  const T & val, const T * root ) { 
```

至

```
inline void find_node( const T * root, const T & val ) { 
```

帮助？

另请参阅：[修改二分搜索以查找然后删除](https://stackoverflow.com/questions/15794296/modifying-binary-search-to-find-then-delete)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:38:40.330

该`find_node`方法希望`T`类型不是节点；它想要节点中的数据类型。

当它不想要它时，你正在将整个节点传递给它。

# java - Tomcat 环境变量 - 是否可以使它们永久化？还是在重新部署时不会丢失？

> ID：15800183
> 
> 赞同：2
> 
> 时间：2013-04-03T23:44:37.423
> 
> 标签：java, tomcat, netbeans

我正在开发一个使用 Tomcat 环境变量（通过管理控制台创建）的应用程序。凭借我在这方面的一点经验，我意识到当应用程序被取消部署并再次重新部署时，这些会丢失。

我想将它们保留在那里，或者在部署时自动创建它们。

是否可以？由于每次重新部署时都重新创建环境变量很麻烦。

我正在使用 Tomcat 7.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T04:51:46.533

是的，这是可能的。您在 server.xml 中注册您的变量，并且每个应用程序上下文都可以选择引用其中的任何一个以使它们在 JNDI 中可用。

服务器.xml

```
<GlobalNamingResources>
    <Environment name="example" value="prod" type="java.lang.String" override="false" /> 
</GlobalNamingResources> 
```

上下文.xml

```
<ResourceLink name="example" global="example" type="java.lang.String" /> 
```

代码.java

```
String example = (String) (new InitialContext()).lookup("java:comp/env/example"); 
```

# python - UnicodeEncodeError: 'ascii' 编解码器无法编码字符 u'\xe9'

> ID：15800185
> 
> 赞同：3
> 
> 时间：2013-04-03T23:44:46.027
> 
> 标签：python, django, json, unicode

我在 django 1.5 的 views.py 中处理 ajax 的脚本。构建我的 json 文件后，我必须将用户名放入 cookie 中。这个名字有法国口音的名字，比如“hervé”。这是我的代码的一部分

```
if user.is_active:
            login(request, user)
            name = 'Hervé'
            jsondict['success'] = True
            jsondict['text']['welcome'] = 'Bienvenue, %s!' % name

            if name:
                fn = name
    response = HttpResponse(json.dumps(jsondict, cls=DjangoJSONEncoder, ensure_ascii=False),mimetype='application/json')
    if fn:
        set_cookie(response,"full_name",fn) 
```

出现的错误是

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\xe9' in position 4: ordinal not in range(128) 
```

为了解决这个问题，我使用了 unicode()、decode()……但没有任何改变。错误来自 set_cookie() 函数吗？还是 json 文件？我能做些什么来解决它？

这是 set_cookies 函数

```
def set_cookie(response, key, value, days_expire = 7):
import datetime
from django.conf import settings
if days_expire is None:
    max_age = 365 * 24 * 60 * 60  #one year
else:
    max_age = days_expire * 24 * 60 * 60 
expires = datetime.datetime.strftime(datetime.datetime.utcnow() + datetime.timedelta(seconds=max_age), "%a, %d-%b-%Y %H:%M:%S GMT")
response.set_cookie(key, value, max_age=max_age, expires=expires, domain=settings.SESSION_COOKIE_DOMAIN, secure=settings.SESSION_COOKIE_SECURE or None) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:54:26.013

好的，现在我修好了。在你的views.py的头，把这个解释器

```
# -*- coding: latin-1 -*- 
```

然后在你的函数中，

```
name = 'Hervé'
name.decode('latin-1').encode('ascii','xmlcharrefreplace') //add this line
jsondict['success'] = True
jsondict['text']['welcome'] = 'Bienvenue, %s!' % name 
```

# android - Android：绕过 Galaxy S3 上的低功耗音频播放器（LPA 播放器）

> ID：15800186
> 
> 赞同：1
> 
> 时间：2013-04-03T23:44:49.183
> 
> 标签：android, android-mediaplayer

我有一个音乐播放应用程序在某些 Galaxy S3 上出现问题。

在曲目结束时，播放器将音频输出从耳机切换到扬声器几秒钟，否则音量可能会瞬间升高。

我有一些建议可能与新的无缝 API 和三星的 LPA 播放器有关。在曲目结束时，`setNextMediaPlayer()`调用，我认为这是 Android 在默认媒体播放器和 LPA 播放器之间切换的地方（前提是 LPA 播放器可用）。因为 LPA 播放器会去除所有效果，所以我认为它会干扰音频流，并且手机会感到困惑。

我想找到一种绕过 LPA 播放器的方法。我有一些建议可以准备一个具有>60s mp3 的 MediaPlayer 来使用 LPA 播放器，但它似乎对我不起作用（我自己没有针对这个 bug 的测试设备），而且看起来很糟糕解决方案（我必须将应用程序与 mp3 一起发布，并且可能会浪费系统资源来保存应用程序生命周期中准备好的 MediaPlayer）。

我愿意接受建议，而且 - 我可以联系三星或谷歌的谁来正式解决这个问题？

谢谢。

# php - 将 php/js 网站转换为移动设备...创建新网站？

> ID：15800189
> 
> 赞同：-1
> 
> 时间：2013-04-03T23:45:06.750
> 
> 标签：php, mobile, web

我有一个复杂的 php/mysql/js 网站。我想创建一个移动版本。根据网络上的阅读，我认为它必须是一个专门的精简站点，如 m.google.com 或 m.yahoo.com，而不是响应式站点，因为当前站点具有多个列和图像。（它已经可以在移动浏览器上运行，但会让人眼花缭乱，而且还远未优化。）

我认为理想的版本是拥有一组文件，并且在检测到移动浏览器后只需在不同的样式表中 swqp。但是，该站点不是为此而构建的，这不是一个现实的选择。网站也没有使用模板构建。

另一方面，我不想重写所有的逻辑和数据库查询。

我能想到的两个选项如下：

选项1：一组文件，即一个网站。我可以检测移动浏览器并设置会话变量。然后在每个页面上，我会检查移动会话变量，如果存在，则显示针对手持设备优化的标记。

选项 2：将网站文件复制到单独的目录，例如 mobile。然后重做这些文件中的标记，使其针对手持设备进行优化。

我是否仍然可以执行选项 1 并让网站拥有自己的子域，如 m.site.com

当只是换出不同的样式表或使用单独的模板时，移动网站的最佳实践不是一种选择。

在此先感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:03:33.607

如果您绝对确信您需要单独的标记，那么最佳实践通常是首先**将您的业务逻辑与表示层分开，**以便您可以重用相同的后端逻辑，并动态地提供不同的前端视图/模板。Zend Framework、Codeignitor、Symphony、CakePHP（以及许多其他的）等 PHP 框架使这变得相对容易。

至于您是使用子域（m.mysite.com）还是会话变量，任何一种方式都可以很好地工作。在 PHP 中，您可以检查 $_SERVER['SERVER_NAME'] 以查看是否正在使用 'm' 子域，或者同样轻松地检查会话变量。

# c# - 在没有当前 HttpContext 可用的情况下访问 HttpApplicationState

> ID：15800190
> 
> 赞同：2
> 
> 时间：2013-04-03T23:45:07.620
> 
> 标签：c#, asp.net, web-applications, asp.net-mvc-4, application-state

通常，当我们需要对当前应用程序状态的引用时，我们会使用：

```
HttpContext.Current.Appliction 
```

但有时没有当前的 HttpContext ( `HttpContext.Current`returns `null`)。在这种情况下，如何获取对当前应用程序实例的引用？

一个例子可以`Session_End`发生。虽然我可以`Application`在事件处理程序内部使用属性`Session_End`，但是如果处理程序调用库方法并且`HttpApplicationState`库代码中需要该对象怎么办？我不喜欢传递“应用程序”参数...

我也不喜欢将它保存在一个`static`字段中（如单例模式），我正在寻找一种直接从上下文中获取它的方法。

有什么方法可以直接访问实例（类似于`HttpContext.Current.Application`方法）还是我必须选择上述不太干净的方法之一？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-23T22:57:45.800

我会使用`HttpRuntime.Cache`而不是应用程序状态对象。`HttpRuntime.Cache`可以在任何地方使用。

# php - 路由中的 Codeigniter 语言段

> ID：15800191
> 
> 赞同：1
> 
> 时间：2013-04-03T23:45:11.607
> 
> 标签：php, codeigniter

我有这个：

```
$route['(:any)'] = "front/$1"; // front
$route['admin/(:any)'] = "admin/$1"; // admin 
```

我想制作这样的网址：

```
mysite.com/en/somecontroller/somemethod

mysite.com/ru/somecontroller/somemethod

etc... 
```

我猜是这样的：

```
$route['(:any)'] = "front/$1"; // front
$route['(:any)/(:any)'] = "front/$2";

$route['admin/(:any)'] = "admin/$1"; // admin
$route['(:any)/admin/(:any)'] = "admin/$2"; 
```

但是当第一段是语言时我会出错，CI认为那是一个控制器

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:15:49.970

如果您使用 CodeIgniter 的*[语言类](http://ellislab.com/codeigniter/user-guide/libraries/language.html)*，那么这个[URI 语言标识符](https://github.com/EllisLab/CodeIgniter/wiki/URI-Language-Identifier)类扩展应该完全符合您的要求。

> 此语言类扩展允许您使用在配置文件或链接中预定义的语言缩写为所有站点 URL 自动添加前缀，并自动加载相应的语言翻译文件，然后路由正则表达式将更正所有内容正常工作。

# php - Apache 和终端在 Mac OS 10.8 上运行 2 个不同的 php 构建

> ID：15800197
> 
> 赞同：3
> 
> 时间：2013-04-03T23:46:18.907
> 
> 标签：php, macos, apache, osx-mountain-lion

由于 Mac OS 10.8 有一个旧的 PHP 版本，我不得不安装一个从未安装过的 PHP 版本。所以我只编译 PHP 5.4.13。然后我在终端上执行一个 php -v ，它显示新的 php 版本正在运行。但是当我从浏览器执行 phpinfo 时，它会显示旧的 PHP 版本，即 PHP 5.3.x。即使在创建到新 php 构建的软链接之后也是如此，/opt/local/lib/php(old one) -> /usr/bin/php(new one)

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-14T23:00:12.457

我刚刚遇到了同样的问题，想尝试需要 mcrypt 的 Laravel。

简而言之，我一直在使用 Mountain Lion 附带的内置 PHP 5.3.26，几个月后，在我对自制软件更加熟悉后，我用它安装了更新版本的 PHP。

```
brew update
brew upgrade
brew install php53 php53-mcrypt ... 
```

我放

```
<?php phpinfo(); 
```

进入 ~/Sites/info.php 然后去 localhost/info.php 查看我的 Apache+PHP 配置。在页面上，我在**Loaded Configuration File**下看到了这个：

```
/private/etc/php.ini 
```

然后在终端中，我运行了这个：

```
php -i | grep ini 
```

显示了这个输出

```
Loaded Configuration File => /usr/local/etc/php/5.3/php.ini 
```

再加上加载的更多配置......

```
Additional .ini files parsed => /usr/local/etc/php/5.3/conf.d/ext-mcrypt.ini,
/usr/local/etc/php/5.3/conf.d/ext-xdebug.ini,
/usr/local/etc/php/5.3/conf.d/redis.ini 
```

我遇到的问题是 mcrypt 正在加载 php cli 版本，但是我的 Laravel 测试页面无法加载，给出了 mcrypt extension not found 错误 [1]

我使用 diffmerge 工具 [2] 将 /private/etc/ 中的原始 Apple php.ini 与 /usr/local/etc/php/5.3/ 中安装的一个自制软件进行比较，发现存在显着差异！所以在尝试之前仔细检查：

我接下来要做的是备份

```
sudo mv /private/etc/php.ini /private/etc/php.ini.apple 
```

然后将 php.ini 符号链接到自制软件

```
ln -s /usr/local/etc/php/5.3/php.ini /private/etc/php.ini 
```

最后重新加载Apache后

```
sudo apachectl restart 
```

并加载了 mcrypt，现在他们使用的是单个配置。

如果您的本地主机上有另一个应用程序与新配置中断，只需删除符号链接，并将其更改为 .apple 版本并重新启动 Apache 以恢复。

1.  [Laravel 需要 Mcrypt PHP 扩展](https://stackoverflow.com/questions/16830405/laravel-requires-the-mcrypt-php-extension)
2.  [https://sourcegear.com/diffmerge/](https://sourcegear.com/diffmerge/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T23:51:49.923

这可能是一个很好的参考：

[如何在 Mac OS X Lion 上安装 php 5.4？](https://stackoverflow.com/questions/9534451/how-do-i-install-php-5-4-on-mac-os-x-lion)

有一些关于将 PHP 升级到 5.4 的详细说明，还有关于 MacPorts 如何使它变得非常轻松的注释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T17:49:16.697

我正在运行 OS X 10.9。我将 PHP 更新到 v5.5.8，发现 Apache 可以正确运行新版本，但终端仍在运行旧版本。在四处寻找解决方案后，我最终想，“我会重新启动它。”

答对了！终端和 Apache 运行相同版本的 PHP。

# iphone - 如何访问 iOS 上存储的背景，并更改设备背景？

> ID：15800198
> 
> 赞同：-2
> 
> 时间：2013-04-03T23:46:26.983
> 
> 标签：iphone, ios, objective-c, ipad

我正在开发一个 iOS 应用程序来搜索背景，将它们保存到设备上，并更改默认背景。我需要知道如何访问已存储在设备上的背景，如何将新背景保存到该位置，以及如何从我的应用程序中设置设备的默认背景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:59:23.787

2个问题：

*   “背景”和“图像”之间没有区别。您可以使用照片库中的任何图像作为背景图像。所以“我需要知道如何访问已经存储在设备上的背景”相当于查看照片库。

*   无法从第 3 方应用程序访问“设置为背景”方法。

# c# - 认识一个简单的字母

> ID：15800199
> 
> 赞同：4
> 
> 时间：2013-04-03T23:46:29.693
> 
> 标签：c#, ocr, image-recognition, aforge, accord.net

我正在尝试确定一种准确、快速、计算明智的方法来识别图像中的简单大写字母。

我只需要识别 AZ 字母范围（只有大写字母，没有特殊字符）。

例子：

*   字母“A”

![一封信](https://i.stack.imgur.com/2beCt.png)

*   字母“R”

![R 字母](https://i.stack.imgur.com/vvlQi.png)

有没有可以用来识别它们的函数或代码？

笔记：

*   裁剪图像中字母的位置不一样
*   我有原始的裁剪图像。所以我可以应用一个比较方法来获得集合中最相似的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T10:48:27.553

It might be worth having a look at the Tesseract source code - it's open and might give you some insights! However, it'd be much faster to simply use the library than rebuild your own interpretation of it! ;)

# c++ - C++ - 尝试使用字符串函数来反转输入字符串

> ID：15800200
> 
> 赞同：1
> 
> 时间：2013-04-03T23:46:34.273
> 
> 标签：c++, string, namespaces, reverse

作为家庭作业的一部分，我需要能够获取输入字符串并使用字符串函数列表以多种方式对其进行操作。第一个函数接受一个字符串并使用 for 循环将其反转。这就是我所拥有的：

```
#include <iostream>
#include <string>

namespace hw06
{
    typedef std::string::size_type size_type;

    //reverse function
    std::string reverse( const std::string str );

}

// Program execution begins here.

int main()
{
    std::string inputStr;

    std::cout << "Enter a string: ";
    std::getline( std::cin, inputStr );

    std::cout << "Reversed: " << hw06::reverse( inputStr )
    << std::endl;

    return 0;
}

//reverse function definition

std::string hw06::reverse( const std::string str )
{

    std::string reverseStr = "";
//i starts as the last digit in the input. It outputs its current 
//character to the return value "tempStr", then goes down the line
//adding whatever character it finds until it reaches position 0
    for( size_type i = (str.size() - 1); (i >= 0); --i ){
        reverseStr += str.at( i );
    }
        return reverseStr;
} 
```

程序要求输入，然后返回此错误：

> 在抛出 'std::out_of_range' what(): basic_string::tat 的实例后调用终止

我真的不知道我在这里做错了什么。循环对我来说似乎是正确的，所以我误解了如何引用该函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T00:01:38.523

除非您真的*想*编写一个循环，否则执行以下操作可能更容易：

```
std::string reverse(std::string const &input) { 
    return std::string(input.rbegin(), input.rend());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T23:54:42.907

问题是您的循环永远不会终止。你有你的条件`i >= 0`，但 size_type 是无符号的，所以`0 - 1 == 2^(sizeof(size_t) * 8) - 1`，这肯定超出了你的字符串的范围。因此，您需要选择其他东西作为您的终止条件。一种选择是您可以使用`i != std::string::npos`，但感觉不对。你可能会更好地使用类似的东西：

```
for (size_type i = str.size(); i != 0; ) {
    reverseStr += str.at(--i);
} 
```

**编辑：** 我做了一些检查`i != std::string::npos`。它应该定义明确并且可以。但是，这似乎仍然是错误的做法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-03T23:57:39.373

正如 Andreas Grapentin 所说，问题在于`std::string::size()`返回`size_t`标准要求为无符号类型的 a 。所以它会*一直*如此`>= 0`，当你击中`0`并减少它时，你会得到一个非常大的正数。

考虑这样的事情：

```
std::string hw06::reverse(const std::string &str)
{
    std::string reverseStr;

    for(size_t i = str.size(); i != 0; i--)
        reverseStr += str.at(i - 1);

    return reverseStr;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T00:55:37.777

我不热衷于回答作业问题，但看到一些答案，我无法抗拒：

```
std::string hw06::reverse(const std::string &str)
{ return std::string(str.rbegin(), str.rend()); } 
```

如果您不能就地完成，简单、干净且浪费最少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-03T23:58:00.077

正如其他答案所说，问题出在循环中。我建议使用以下“转到”运算符:)

```
for(size_t i = str.size(); i --> 0;)
{
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-10T10:04:39.513

使用 i-- 而不是 --i。或者你会在得到 char 和得到循环问题之前降低 i 值。

# java - 值“属性”不是“模型”的成员

> ID：15800202
> 
> 赞同：2
> 
> 时间：2013-04-03T23:46:43.950
> 
> 标签：java, view, playframework, playframework-2.0, playframework-2.1

我正在按照本教程[http://www.playframework.com/documentation/2.1.1/JavaTodoList](http://www.playframework.com/documentation/2.1.1/JavaTodoList)学习 Play Framework 的开发流程。

但是我`index.scala.html`看到这个编译错误：

> ### “值描述不是产品的成员”

这是我的产品型号：

```
package app.models;

import java.util.*;
import javax.validation.*;
import play.data.validation.Constraints.*;

/**
 * Product.
 */
public class Product
{
    public int id;
    public String name;
    public String description;
    public String dimensions;
    public double price;

    public static List<Product> all()
    {
        return new ArrayList<Product>();
    }

    public static void create(Product product)
    {
        return;
    }

    public static void delete(Long id)
    {
        return;
    }
} 
```

这是视图的代码：

```
@(products: List[Product], productForm: Form[Product])

@import helper._

@main("ezbuy") {
    <h1>@products.size() product(s)</h1>

    <ul>
        @for(product <- products) {
            <li>
                @product.description

                @form(routes.Application.deleteProduct(product.id)) {
                    <input type="submit" value="Delete">
                }
            </li>
        }
    </ul>

    <h2>Add a new product</h2>

    @form(routes.Application.newProduct()) {
        @inputText(productForm("label")) 

        <input type="submit" value="Create">
    }
} 
```

我只是没有找到问题出在哪里，因为我已经在视图顶部声明了产品列表，并且它正在使用该`@for`语句循环。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:03:20.533

有一个 Scala 类 scala.Product ( [http://www.scala-lang.org/api/current/index.html#scala.Product](http://www.scala-lang.org/api/current/index.html#scala.Product) )。Scala 自动从 scala 包中导入所有内容。我认为你得到了那个类而不是 app.models.Product。

使用完全限定的类名：

```
@(products: List[app.models.Product], productForm: Form[app.models.Product]) 
```

如果您将 Product 直接放入模型包中，则不会发生该错误，因为模型。* 默认情况下在 Play 的 Scala 模板中导入。所以不需要使用完全限定的类名。

# rest - 如何通过 JasperReports Server 中的 REST API 安排具有集合类型参数的报告？

> ID：15800212
> 
> 赞同：5
> 
> 时间：2013-04-03T23:48:35.153
> 
> 标签：rest, jasperserver

我正在使用*JasperReports Server v4.5*。

我们在使用*REST API*安排报告时遇到困难。

我们可以安排只接受字符串参数的报告，但是问题始于具有*java.util.Collection*类型参数的报告。我们尝试了所有方法，但找不到*java.util.Collection*的正确类型。

现在这有效：

```
<parameters>
    <name>string_input</name>
    <value xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        test
    </value>
</parameters> 
```

但我们无法让这个工作：

```
<parameters>
    <name>array_parameter</name>
    <value type=? >[1, 2, 3]</value>
</parameters> 
```

当我查看代码时，我可以看到*JasperReports Server* WS 接受数组，但是没有记录发送数组或数组类型的方法。

解决此问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-03T14:06:28.793

试试这个：

```
<parameters>
    <entry>
        <key>param_name</key>
        <value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="collection">
            <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string">1</item>
            <item xmlns:xs="http://www.w3.org/2001/XMLSchema" xsi:type="xs:string">2</item>
        </value>
    </entry>
</parameters> 
```

**更新：**

有些人建议删除`entry`标签。如果上述方法不起作用，请尝试删除`entry`标签。

# ms-access - 如何在 access 2007 中打开表单以显示空白记录？

> ID：15800213
> 
> 赞同：0
> 
> 时间：2013-04-03T23:48:35.543
> 
> 标签：ms-access, ms-access-2007, record

我是 2007 年的新手 .. 我按下了保存按钮 我希望员工表单刷新就像我按下了按钮一样。所以它准备好新的记录了。当我按下保存按钮时我的问题仍然是我以前的记录显示..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T23:54:35.327

在按钮`OnClick`事件中使用它：

```
DoCmd.GoToRecord , , acNewRec 
```

# asp.net-mvc - 我想将四个查询联合在一起并将其设置为转发器的数据源

> ID：15800218
> 
> 赞同：0
> 
> 时间：2013-04-03T23:49:00.877
> 
> 标签：asp.net-mvc, linq

根据用户设计，我必须将四个查询合并在一起并将它们放在一个转发器中。

```
 var qryIssuer = from l in dbRRSP.LOA
                        join lrb in dbRRSP.LOAOrReferredBy on l.LOAOrReferredById equals lrb.LoaOrReferredById
                        join lat in dbRRSP.LOAAccessType on l.LOAAccessTypeId equals lat.LOAAccessTypeId
                        join iss in dbRRSP.Issuer on l.IssuerId equals iss.IssuerId
                        where
                            l.PersonId == personId
                        select new
                                   {
                                       LOAOrReferredByDescription = lrb.LoaOrReferredByDescription, 
                                       lat.LOAAccessTypeDescription,
                                       PersonType = "Issuer",
                                       LOAName = iss.CompanyName, 
                                       l.DateAdded
                                   };
          var qryEMD = from l in dbRRSP.LOA
                        join lrb in dbRRSP.LOAOrReferredBy on l.LOAOrReferredById equals lrb.LoaOrReferredById
                        join lat in dbRRSP.LOAAccessType on l.LOAAccessTypeId equals lat.LOAAccessTypeId
                        join emd in dbRRSP.Agent on l.AgentId equals emd.AgentId
                        where
                            l.PersonId == personId
                        select new 
                                    {
                                        LOAOrReferredByDescription = lrb.LoaOrReferredByDescription, 
                                        lat.LOAAccessTypeDescription,
                                        PersonType = "EMD",
                                        LOAName = emd.CompanyName, 
                                        l.DateAdded
                                    };

        var qryEmdRep = from l in dbRRSP.LOA
                        join lrb in dbRRSP.LOAOrReferredBy on l.LOAOrReferredById equals lrb.LoaOrReferredById
                        join lat in dbRRSP.LOAAccessType on l.LOAAccessTypeId equals lat.LOAAccessTypeId
                        join ar in dbRRSP.AgentRepresentative on l.EMDRepresentativeId equals ar.AgentRepresentativeId
                        join arp in dbRRSP.Person on ar.PersonId equals arp.PersonId
                        where
                            l.PersonId == personId
                        select new 
                                   {
                                       LOAOrReferredByDescription = lrb.LoaOrReferredByDescription, 
                                       lat.LOAAccessTypeDescription,
                                       PersonType = "EMD Rep",
                                       LOAName = arp.FirstName + ' ' + arp.LastName, l.DateAdded
                                   };

        var qryLOAPerson = from l in dbRRSP.LOA
                           join lrb in dbRRSP.LOAOrReferredBy on l.LOAOrReferredById equals lrb.LoaOrReferredById
                           join lat in dbRRSP.LOAAccessType on l.LOAAccessTypeId equals lat.LOAAccessTypeId
                           join lp in dbRRSP.LOAPerson on l.LOAPersonId equals lp.LOAPersonId
                           where
                               l.PersonId == personId
                           select new 
                                      {
                                          LOAOrReferredByDescription = lrb.LoaOrReferredByDescription, lat.LOAAccessTypeDescription,
                                          PersonType = "Person",
                                          LOAName = lp.LOAPersonName, 
                                          l.DateAdded
                                      }; 
```

这是四个查询。最棘手的部分是最后一个字段是日期时间，这给我带来了一些问题。我知道如何像这样将它们中的两个结合在一起：

```
var qryMultipleLOA = qryIssuer.Union(qryEMD).ToList().Select(loa => new ExtendedLOA
{
                                                                                  LOAOrReferredByDescription = loa.LOAOrReferredByDescription, 
                                                                                   LOAAccessTypeDescription = loa.LOAAccessTypeDescription, 
                                                                                   PersonType = loa.PersonType,
                                                                                    LOAName = loa.LOAName,

DateAdded = DateTime.Parse(loa.DateAdded.ToString()).ToString("MM/dd/yyyy")
 }); 
```

但是我不知道如何添加最后两个查询 - 首先我尝试将它包装在括号中并添加一个不起作用的 .Union，然后当我尝试用适当的 .ToLists 嵌套它们时，那​​没有也不行。

下面是将其绑定到转发器的代码。

```
 rptLOA.DataSource = qryMultipleLOA;
            rptLOA.DataBind(); 
```

建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:35:23.913

你尝试过类似的东西吗？

```
var qryMultipleLOA = qryIssuer.Union(qryEMD).Union(qryEmdRep).Union(qryLOAPerson).ToList(); 
```

如果您的查询的足迹是相同的，那么将它们相互链接应该不是问题。

编辑：

我还会推荐以下内容：

1.  创建一个类来保存结果数据的实例。
2.  与其创建从 Linq 生成的动态变量列表并希望它们都匹配，不如将 linq 结果汇集到一个列表中。这样您就可以立即判断您是否有类型不匹配。
3.  一旦你有四个相同列表的列表，按照我上面的语法，联合将很快。

动态 Linq 列表可能很痛苦、笨拙，并且单个属性类型更改可能会在运行时而不是设计时抛出您的代码。如果您按照上述步骤操作，您的代码对您和其他人来说将更易于维护和清晰。

我希望这在某种程度上有所帮助。

# jquery - JQuery Select2 不会更改选定的 html 选项

> ID：15800224
> 
> 赞同：2
> 
> 时间：2013-04-03T23:49:45.500
> 
> 标签：jquery, asp.net, jquery-select2, autopostback

在我的 asp.net 项目中，我使用修改后的 Listbox 控件来显示一个多选下拉框，我使用 Select2() 直观地呈现它；

我设置 AutoPostBack="True" 以便在每次操作后我都可以更改代码中的对象。但是，因为 Select2 multple 不会更改`<select>`选项本身，所以 ViewState 不会将该项目识别为已选中。

我怀疑如果使用 Select2() 选择一个项目会改变 中的对应项`<option>`，`<select>`ViewState 会在重新加载页面时获取更改并将其标记为选中。

**页面：**

```
<cc1:MultiSelector ID="txtUsers" runat="server" CssClass="select" multiple="multiple"  OnSelectedIndexChanged="txtUsers_SelectedIndexChanged"></cc1:MultiSelector>
```

**多选器控制：**

```
public class MultiSelector : ListBox
{
    public IEnumerable SelectedItems
    {
        get
        {
            ListItemCollection items = this.Items as ListItemCollection;
            return this.Items.OfType().Where(item => item.Selected);
        }
    }
}
```

**代码背后：**

```
protected void txtUsers_SelectedIndexChanged(object sender, EventArgs e)
{
  // Do something with the selected items

}
```

请告知我如何将相应的 HTML 元素设置为选中状态。

`<option value='3' selected="selected">Item3</option>`

此外，删除现有项目也不起作用。很可能出于相同的原因，选择的属性永远不会被删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T20:51:51.273

我认为您在代码中犯了一个小“错误”。下面的工作示例 Aspx 页面（注意您未设置的 SelectionMode）：

`<cc1:MultiSelector ID="txtUsers" AutoPostBack="true" SelectionMode="Multiple" runat="server" CssClass="select" OnSelectedIndexChanged="txtUsers_SelectedIndexChanged"></cc1:MultiSelector`>

后面的代码：

```
 protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                for (var i = 0; i < 10; i++)
                {
                    txtUsers.Items.Add(new ListItem { Value = i.ToString(), Text = "option1 " + i.ToString() });
                }
            }

        }

        public void txtUsers_SelectedIndexChanged(object sender, System.EventArgs e)
        {
            foreach (ListItem item in txtUsers.Items)
            {
                if(item.Selected)
                    Debug.WriteLine(item);

            }
            Debug.Write(e);
        } 
```

顺便说一句：您可以编写以下 JavaScript 以确保选择了正确的选项。

```
 $(function () {
        $('select').change(function (evt) { 
            if (evt.added) {
                $(evt.target).find("option[value=" + evt.added.id + "]").attr("selected", "selected");
            }
            if (evt.removed) {
                $(evt.target).find("option[value=" + evt.removed.id + "]").removeAttr("selected");
            }
        });
    }); 
```

# c++ - QtableWidget 中的主键 - 如果行存在则更新，否则添加

> ID：15800228
> 
> 赞同：0
> 
> 时间：2013-04-03T23:50:30.897
> 
> 标签：c++, qt, qtablewidget

刚接触 Qt。我想知道是否有一种方法可以在 . 中添加主键`QtableWidget`。我想这样做的原因是因为我想创建一种机制，以便如果我添加一个带有不在表中的键的行，它会得到添加为新行，否则具有该键的现有行将被更新。关于如何完成此操作的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T05:28:14.533

```
 // Assuming m_table of QTableWidget* type
        // Assuming single column

        const int rowCount = m_table->rowCount();
        if(rowToInsert < rowCount)
        { 
           m_table->setItem(rowToInsert, 0, /* your data */ );
        }
        else
        {
          m_table->setRowCount(rowCount + 1);
          m_table->setItem(rowCount + 1, 0, /* your data */ );
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T08:21:22.710

使用`QTableWidgetItem::setData ( int role, const QVariant & value )`方法通过 custom 设置您的数据（主键）`role`，并`QVariant QTableWidgetItem::data ( int role )`检索它。`role`应该是`Qt::UserRole`或高于 的任何数字`32`。有关更多信息，请参阅[QTableWidgetItem::setData(int role, const QVariant & value)](http://qt-project.org/doc/qt-4.8/qtablewidgetitem.html#setData)参考。

如果您是 Qt 新手，您应该寻找[Qt model/view](http://qt-project.org/doc/qt-4.8/model-view-programming.html)，在您的情况下，签入`model`并显示模型的数据`QTableView`而不是`QTableWidget`.

# gcc - 如何将 gcc 生成的抽象语法树转储到 .dot 文件中？

> ID：15800230
> 
> 赞同：20
> 
> 时间：2013-04-03T23:50:48.363
> 
> 标签：gcc, graphviz, dot, abstract-syntax-tree

我认为问题的标题是不言自明的，我想将 gcc 生成的抽象语法树转储到 .dot 文件（Graphviz 生成的那些文件）中，因为我想在 .png 文件或类似文件中查看它。有什么办法可以做到吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-04T06:29:03.867

有两种方法，都包括两个步骤

1.  使用 GCC 内部 vcg 支持

    1.  用 vcg 转储编译你的代码（比如 test.c）

        `gcc -fdump-tree-vcg -g test.c`

    2.  使用任何第三方工具从 vcg 获取点输出

        `graph-easy test.c.006t.vcg --as_dot`

2.  使用原始转储进行编译，然后使用一些脚本对其进行预处理以形成点文件（就像在[这篇有用的文章中](http://digitocero.com/en/blog/exporting-and-visualizing-gccs-abstract-syntax-tree-ast)一样）

这两种方法都有其优点和缺点——首先，在 gimple 翻译之前，你实际上只能得到一个 AST 转储，但这很容易。使用第二个，您可以将任何原始转储转换为点格式，但您必须支持脚本，这是开销。

喜欢什么 - 取决于您自己的选择。

* * *

UPD：时代在变。gcc 4.8.2 的全新选项可以立即生成点文件。只需供应：

```
gcc test.c -fdump-tree-all-graph 
```

你会得到很多已经为你格式化的点文件：

```
test.c.008t.lower.dot
test.c.012t.cfg.dot
test.c.016t.ssa.dot
... etc ... 
```

请务必使用此选项使用新版本的 GCC。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2019-01-06T08:05:21.143

根据手册页，您可以通过`-fdump-`命令获取此信息。

让我们看一个虚拟的例子：

```
// main.c

int sum(int a, int b) {
    return a + b;
}

int main(void) {
    if (sum(8, 10) < 20) {
        return -1;
    }
    return 1;
} 
```

对于 gcc 7.3.0：

```
gcc -fdump-tree-all-graph main.c -o main 
```

有很多选项可以获取必要的信息。查看手册以获取此信息。

之后，您将获得许多文件。其中一些带有.dot respresentation（使用图形选项）：

```
main.c.003t.original
main.c.004t.gimple
main.c.006t.omplower
...
main.c.011t.cfg
main.c.011t.cfg.dot
... 
```

使用 GraphViz，我们可以为每个函数检索一个漂亮的打印图：

```
dot -Tpng main.c.011t.cfg.dot -o main.png 
```

你会得到这样的东西： [main.png](https://i.stack.imgur.com/1qB7r.png)

有很多开发人员选项可以帮助您了解编译器如何在低级别处理您的文件：[GCC 开发人员选项](https://gcc.gnu.org/onlinedocs/gcc/Developer-Options.html)

# javascript - XHR onProgress 完成

> ID：15800231
> 
> 赞同：1
> 
> 时间：2013-04-03T23:50:58.847
> 
> 标签：javascript, ajax, xmlhttprequest, progress

我正在尝试使用 ajax 实现一个带有上传百分比的标签。问题是xhr返回100%后，到readyState==4和status==200还需要17秒左右。

我正在使用 FormData() 对象发送图片 (png/jpg) 和字符串

```
<form onclick='send(this)'.... 
```

功能是：

```
function send(form){ var f = new FormData(form)....... 
```

我正在使用以下代码进行上传

```
if(xhr.upload) {
    xhr.upload.onprogress = function(e) {
        if (e.lengthComputable) {
            var perc = Math.round((e.loaded/e.total) * 100);
            var state = {
                'done': e.loaded,
                'total': e.total,
                'percent': perc
            };
            progress(state);
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:08:02.633

这很可能是您的服务器的问题，而不是您的客户端代码。只有在服务器返回对底层请求的响应后，才会`onreadystatechange`使用值 4 调用您的处理程序。`readyState`传递到您的处理程序的加载/总计值`onprogress`指示已发送到服务器的字节数。如果总 === 已加载，这并不一定表明服务器已返回响应。服务器可能会在收到最后一个字节后执行一些处理，然后返回响应（触发您的`onreadstatechange`处理程序）。如果您注意到在发送最后一个字节和调用您的处理程序之间有很长的时间`onreadystatechange`，这表明您的服务器无论出于何种原因都在花时间响应请求。

# assembly - 以“jmp 0f”或“b 0f”开头的内联汇编

> ID：15800235
> 
> 赞同：0
> 
> 时间：2013-04-03T23:51:14.857
> 
> 标签：assembly, pipeline, branch-prediction

**更新**

将汇编的第二行更改为实际使用的助记符 ( `mflr`) 并在底部添加了更多信息。

* * *

我遇到了一些类似于以下的代码（使用 gcc）（释义）：

```
#define SOME_MACRO( someVar ) \
do {                          \
  __asm__ (                   \
    "    b 0f\n"              \
    "0:  mflr %0\n"           \
    : "=r"( someVar )         \
  );                          \
} while(0) 
```

...其中`b`指令（ppc）是一个简短的 jmp 并且`mflr`正在获取“链接寄存器”的内容——这在某些方面类似于程序计数器。对于英特尔代码，我也看到过这种情况（参见[这个](https://stackoverflow.com/questions/878770/assembly-compilation-error-gcc4-2-4-win-gcc4-3-3-fail)问题中接受的答案）。

该分支充当无操作...我的问题：这有什么目的？

我猜它与分支预测有关，但到目前为止，我只发现人们在搜索时使用这个成语的代码。

* * *

看起来我在分支预测猜测上错了。 `mflr`获取链接寄存器的内容。

所以，我的问题归结为：为什么需要分支。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T16:48:20.093

像这样有趣的代码往往发生在`somethingelse`. 此类代码的一些已知用途是：

*   运行时状态检索；例如，在 x86 中，
    `__asm__("call 0f\n0: pop %0\n" : "=r"(pc))`
    是一种检索程序计数器的方法（IP 寄存器 - 这是隐藏的，不能直接访问，因此`call`将其推入堆栈的事实用于检索它）。
    请注意，由于*红色区域*，这在 64 位模式下的叶函数中使用是不安全的- 请参阅[破坏红色区域的内联程序集](https://stackoverflow.com/questions/6380992/inline-assembly-that-clobbers-the-red-zone)。在 x86_64 上执行此操作的正确方法是
    `asm("lea 0f(%%rip), %0\n0:\n" : "=r"(pc))`
    利用 PC 相对寻址在 64 位模式下可能的事实。
*   *检测*（调试/运行时跟踪），例如通过将跟踪代码/`NOP`槽放在那里，运行时跟踪实用程序可以修改以动态挂钩到代码中。Solaris DTrace 使用此类技术。
*   在 ARM（和 64 位 x86）上，该方法还用于在代码中*嵌入常量*，用于与 PC 相关的负载。

像这样的无条件分支是否会导致分支预测丢失惩罚或其他类型的停顿是非常依赖于 CPU 的。

# jquery - 如何直接链接到我的一个 JQuery 选项卡？

> ID：15800239
> 
> 赞同：-1
> 
> 时间：2013-04-03T23:51:39.257
> 
> 标签：jquery

**我的页面：** [https ://tornhq.com/WorkingOn/InteractiveMap/implementing.html](https://tornhq.com/WorkingOn/InteractiveMap/implementing.html)

我想知道，是否可以直接链接到我页面上的一个标签。例如，如果您单击加拿大图像，它将加载该图像的内容，该图像将用于以后使用等等。是否可以输入 URL 直接执行此操作？

就像您可以进入谷歌地图一样，环顾四周，然后获得您现在正在查看的内容的直接链接？

**例子：**

[https://tornhq.com/WorkingOn/InteractiveMap/implementing.html#Current](https://tornhq.com/WorkingOn/InteractiveMap/implementing.html#Current)

将带您到侧边菜单的“当前”选项卡，目前没有，但这是我希望能够做到的。

最好的问候，蒂姆

**编辑：**

另一个里面的标签切换器：http: [//jsfiddle.net/3N4n2/](http://jsfiddle.net/3N4n2/)

jQuery：

```
$('#tab-wrapper li:first').addClass('active');
$('#maps-slider li:first').addClass('active');
$('#tab-body > div').hide();
$('#Current > div').hide();
$('#tab-body > div:first').show();
$('#Current > div:first').show();

$('#tab-wrapper a').click(function() {
    $('#tab-wrapper li').removeClass('active');
    $(this).parent().addClass('active');
    var activeTab = $(this).attr('href');
    $('#tab-body > div:visible').hide();
    $(activeTab).show();
    return false;
});

$('#maps-slider a').click(function() {
    $('#maps-slider li').removeClass('active');
    $('#tab-wrapper li').removeClass('active');
    $(this).parent().addClass('active');
    $('#tab-wrapper #Current-Tab').addClass('active');
    var activeTab = $(this).attr('href');
    $('#Current > div:visible').hide();
    $('#tab-body > div:visible').hide();
    $('#Current > div:first').hide();
    $(activeTab).show();
    $('#tab-body > #Current').show();
    return false;
}); 
```

## 更新：

我已经更新了我的实时版本，我现在可以使用它。使用的代码如下：

```
// Parse URL Queries Method
(function($){
    $.getQuery = function( query ) {
        query = query.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
        var expr = "[\\?&]"+query+"=([^&#]*)";
        var regex = new RegExp( expr );
        var results = regex.exec( window.location.href );
        if( results !== null ) {
            return results[1];
            return decodeURIComponent(results[1].replace(/\+/g, " "));
        } else {
            return false;
        }
    };
})(jQuery);

// Document load
$(function(){
    var test_query = $.getQuery('test');
    alert(test_query); // For the URL http://YOUR DOMAIN/index.html?test=yes, the value would be "yes"
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:04:00.073

您只需要向 url 添加一个变量并解析它。
示例链接： [https ://tornhq.com/WorkingOn/InteractiveMap/implementing.html?tab=1](https://tornhq.com/WorkingOn/InteractiveMap/implementing.html?tab=1)

```
function getUrlVars() {
    var vars = {};
    // parse URL for variables
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value) {
        vars[key] = value;
    });
    // return an object with keys of names of the variables and associated values 
    // The returned object with the example URL is equivalent to vars = {tab:1};
    return vars;
}
// assign individual variables to the key values
var myTAB = getUrlVars()["tab"];
// just set the active variable in your jquery tab declaration = myTAB or update my generic selector to your own to set it afterwards...
if(myTAB) { $( ".selector" ).tabs( "option", "active", myTAB); } 
```

# database-connection - 具体5：如何访问外部asp.net数据库？

> ID：15800241
> 
> 赞同：0
> 
> 时间：2013-04-03T23:51:54.543
> 
> 标签：database-connection, concrete5

我正在做一个项目，我需要访问外部数据库（asp.net）以获取某些内容并在 Concrete5 上显示内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T05:11:24.750

具体5 使用ADOdb php 库。我假设您的 asp.net 应用程序使用 mssql。

[http://phplens.com/lens/adodb/docs-adodb.htm#connect_ex](http://phplens.com/lens/adodb/docs-adodb.htm#connect_ex)

向下滚动一点，您将进入 mssql 部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T00:59:42.697

你问如何连接到数据库？或者如何获取这些数据并将其显示在您的具体网站上？

连接到数据库与具体5无关——而只是谷歌“从 PHP 连接到 SQL Server 数据库”（或使用 ADODB，正如@mkly 在他的回答中指出的那样）。

但是，如果您询问如何显示内容，那么最简单的方法是创建一个 single_page - 请参阅[http://www.concrete5.org/documentation/developers/pages/single-pages](http://www.concrete5.org/documentation/developers/pages/single-pages)

# python - mod_wsgi 支持的输入字符

> ID：15800243
> 
> 赞同：0
> 
> 时间：2013-04-03T23:52:03.933
> 
> 标签：python, django, apache, mod-wsgi

目前，我的小组在 Ubuntu 8 上设置了 Django 服务器，使用 Apache、Django、Python 和 mod_python。我们计划建立一个新的服务器来取代这个。新服务器将运行当前服务器正在运行的软件的更新版本。例如，将使用 Ubuntu 12，Django 将从 1.3 更新到 1.5，Python 将更新到 2.6 或 2.7 将改变的一件事是，我们将使用 mod_wsgi 代替 mod_python。这主要是因为从 1.5 版开始，Django 已删除 mod_python 支持，而是使用 mod_wsgi ( [https://docs.djangoproject.com/en/1.5/internals/deprecation/#id2](https://docs.djangoproject.com/en/1.5/internals/deprecation/#id2) )。问题是我们使用的是 ARK 命名方案，并且过去曾遇到过 ARK 语法和 mod_wsgi 的问题。以下是关于 ARK 的一些信息：

*ARK 是一种特殊的 URL，它将用户连接到三件事：命名对象、其元数据以及提供者对其持久性的承诺。当输入到 Web 浏览器的位置字段时，ARK 将用户引导到命名对象。同样的 ARK，通过附加一个问号 ( `?'), returns a brief metadata record that is both human- and machine- readable. When the ARK is inflected by appending dual question marks (`??')，返回的元数据包含来自当前提供者的承诺声明。*

这是方舟规范页面，上面的信息来自：（[https://wiki.ucop.edu/download/attachments/16744455/arkspec.txt?version=1&modificationDate=1261036800000](https://wiki.ucop.edu/download/attachments/16744455/arkspec.txt?version=1&modificationDate=1261036800000)）

过去，mod_wsgi 不接受尾随**?** 还是**？？**字符，它们是 ARK 规范不可或缺的一部分。我已经搜索了几个小时，似乎无法确定是否在 mod_wsgi 中添加了对这些字符的支持，或者是否需要实施一些解决方法。

如果您知道这一点，或者您需要我提供任何其他信息，请告诉我。在此先感谢，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:37:13.613

在 mod_wsgi 邮件列表中回答：

*   [https://groups.google.com/forum/?fromgroups=#!topic/modwsgi/T0nanTIUL_4](https://groups.google.com/forum/?fromgroups=#!topic/modwsgi/T0nanTIUL_4)

# jquery - 使用数据表添加新行时，将重置现有 ckeditor 行中的数据

> ID：15800245
> 
> 赞同：0
> 
> 时间：2013-04-03T23:52:29.073
> 
> 标签：jquery, ckeditor, datatables

我在 jquery 中同时使用 ckeditor 和 datatable 时遇到问题。

这个问题的历史 -

我使用数据表显示表格，该表格有两个文本列、一个日期列和一个转换为 ckeditor 实例的文本区域。当我从数据库加载这个表时，数据很好并且按预期工作。但是当我在这个数据表中添加一行时，作为 ckeditor 实例的 textarea 中的现有文本或数据将被重置。通过我的分析，我发现当我添加一行时，数据表中的 fnAddRow() 会重新绘制表格，除非它被禁用。我对让表格重绘本身没有问题，但令人痛苦的是为什么单独重置 ckeditor 中的文本。

以下是片段 -

数据表定义 -

```
 var config = {

             "bJQueryUI": true,
             "bAutoWidth": true,
             "bFilter": false,
             "bSort": false,
             "bInfo": false,
             "bPaginate": false,
             "bDestroy": false,
             "aoColumnDefs": [
                { "sType": "html", "aTargets": [ 0,1,3 ] },
                {"sWidth": "350px", "aTargets": [ 4 ] },//,
                {"sWidth": "100px", "aTargets": [ 3 ] },//,
                {"sWidth": "165px", "aTargets": [ 2 ] },//,
                {"sWidth": "165px", "aTargets": [ 1 ] },//,
                {"sWidth": "165px", "aTargets": [ 0 ] }//,
                //{"sWidth": "15%", "aTargets": [ 3 ] },
                //{"sWidth": "15%", "aTargets": [ 2 ] },
                //{"sWidth": "15%", "aTargets": [ 1 ] },
                //{"sWidth": "15%", "aTargets": [ 0 ] },
             ],
             "oLanguage": {
                "sEmptyTable": "No data available"
             },
             "bRetrieve": true,
             "fnDrawCallback": function( oSettings ) {
                 //$( ".documents").ckeditor(planningeditorConfig);
                 alert('table redrawn..');
             }
        };
    var oTable =    $(".datatable").dataTable(config); 
```

向现有表添加行的函数 -

```
 $("#add-planning-row").click( function (e) {

        e.preventDefault();
        var aiNew = oTable.fnAddData( [ "", "", "", "", ""] );
        var nRow = oTable.fnGetNodes( aiNew[0] );
        nRow.className = " planningRow "+nRow.className;
        var aData = oTable.fnGetData(nRow);
        var jqTds = $(">td", nRow);
        var loopIndexValue = parseInt($("#loopIndexValue").val());

        var html  = "<input type=\"text\" value=\""+aData[0]+"\"   name=\"projectPlanning["+loopIndexValue+"].eftName\"   class=\"planningField\"  >"
        + "<input type=\"hidden\" value=\"${project.id}\" name=\"projectPlanning["+loopIndexValue+"].projectId\"  class=\"planningField\"  />"
        + "<input type=\"hidden\" value=\"added through ui\" name=\"projectPlanning["+loopIndexValue+"].description\"  class=\"planningField\"  />"
        + "<input type=\"hidden\" value=\"plan for ${project.name}\" name=\"projectPlanning["+loopIndexValue+"].name\"  class=\"planningField\"  />";

        var comboHtml = " <select class=\"combobox\" name=\"projectPlanning["+loopIndexValue+"].itemStatus.id\" id=\"projectPlanning"+loopIndexValue+".itemStatus.id\"  class=\"planningField\"  >  "+
        "   <option value=\"1\">New</option>  "+
        "   <option value=\"2\">On Track</option>  "+
        "   <option value=\"3\">Minor Impact</option>  "+
        "   <option value=\"4\">Major Impact</option>  "+
        "   <option value=\"5\">Complete</option>  "+
        " </select>  ";

        jqTds[0].innerHTML = html;
        jqTds[1].innerHTML = "<input type=\"text\" value=\""+aData[1]+"\"    name=\"projectPlanning["+loopIndexValue+"].item\"  class=\"planningField\"   >";
        jqTds[2].innerHTML = "<input type=\"text\" value=\""+aData[2]+"\"    name=\"projectPlanning["+loopIndexValue+"].itemDate\" class=\"datepicker planningField \"  >";
        jqTds[3].innerHTML = comboHtml;

        jqTds[4].innerHTML = "<textarea type=\"text\" value=\"\"    name=\"projectPlanning["+loopIndexValue+"].document\" class=\"documents  planningField \"  >"+aData[4]+"</textarea>";

        $("#loopIndexValue").val(loopIndexValue+1);
        $( ".datepicker" ).datepicker();
        $( ".combobox" ).combobox();
        $( ".documents").ckeditor(planningeditorConfig);

        nEditing = nRow;
    } ); 
```

HTML 表格 -

```
 <div id="planning-tab" class="planning-content">
        <div class="ui-dialog-buttonset">
                <input  id="delete-planning-row"  type="button" class="button" value="Delete planning item" />
                <input  id="add-planning-row"  type="button" class="button" value="Add planning item" />
            </div>
        <table id="planning-list" class="datatable" style="width: 1024px;">
            <thead>
                <tr>
                    <td> EFT </td>
                    <td> Item </td>
                    <td> Date </td>
                    <td> Status </td>
                    <td> Document </td>
                </tr>
            </thead>
            <tbody>
            <c:set value="0" var="loopIndexValue" ></c:set>
            <c:forEach items="${project.projectPlanning}" var="planning" varStatus="status">
                <tr class="planningRow">
                    <td>
                        <input value="<ctg:capitalize text="${planning.eftName}" />" name="projectPlanning[${status.index}].eftName"  class="planningField planningEftName"/>
                        <input type="hidden" value="${planning.id}" name="projectPlanning[${status.index}].id" class="planningField" />
                        <input type="hidden" value="${planning.name}" name="projectPlanning[${status.index}].name" class="planningField" />
                        <input type="hidden" value="${planning.description}" name="projectPlanning[${status.index}].description" class="planningField" />
                        <input type="hidden" value="${project.id}" name="projectPlanning[${status.index}].projectId" class="planningField" />
                        <%-- <input type="hidden" value="${planning.document}" name="projectPlanning[${status.index}].document" class="planningField" /> --%>

                    </td>                   
                    <td>
                        <input value="${planning.item}" name="projectPlanning[${status.index}].item" class="planningField planningItem" />
                    </td>                   
                    <td>
                    <input value="<fmt:formatDate pattern="MM/dd/yyyy" value="${planning.itemDate}" />" name="projectPlanning[${status.index}].itemDate" class="datepicker planningField"/>

                    </td>
                    <td>
                        <form:select path="projectPlanning[${status.index}].itemStatus.id" items="${projectStatuses}" itemLabel="name" itemValue="id"  cssClass="combobox planningField" />
                    </td>
                    <td>
                    <%-- <form:textarea class="ckeditor" id="ckeditorPlan" name="projectPlanning[${status.index}].document" path="document" rows="1" cols="20" /> --%>
                        <%-- <textarea  class="ckeditor" id="ckeditorPlan" name="projectPlanning[${status.index}].document" rows="1" cols="20" >${planning.document}</textarea> --%>
                        <textarea  contenteditable="true"  name="projectPlanning[${status.index}].document" rows="1" cols="20" class="documents planningField planningDocument">${planning.document}</textarea>
                    </td>
                </tr>

            </c:forEach>

            </tbody>
        </table> 
```

任何帮助是极大的赞赏。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:06:40.667

好吧..我试图自己解决这个问题。这似乎很简单，但在浏览了论坛和所有这些 cr*p 之后很难猜到。好的.. 解决方案是重置或销毁现有的 ckeditor 实例并重新创建它。以下是代码片段 -

JQUERY 方法 -

```
function resetCkEditors(){

    //alert("reseting editors.");

    for(var i in CKEDITOR.instances) {
        /* editor = CKEDITOR.instances[i]
        editor.destroy();
        editor = null; */

        var editorNm = CKEDITOR.instances[i].name;
        editor = CKEDITOR.instances[i];

        if(editorNm.indexOf('projectPlanText') != -1)
        {
            editor.destroy();
            editor = null;
        }

    }
}

    $("#add-planning-row").click( function (e) {

        resetCkEditors(); // -- THIS IS IMPORTANT AND MAKE SURE YOU ARE NOT DESTROYING ALL THE CKEDITOR INSTANCES OTHER THAN THE ONE IN THE DATATABLE

        e.preventDefault();
        var aiNew = oTable.fnAddData( [ "", "", "", "", ""] );
        var nRow = oTable.fnGetNodes( aiNew[0] );
        nRow.className = " planningRow "+nRow.className;
        var aData = oTable.fnGetData(nRow);
        var jqTds = $(">td", nRow);
        var loopIndexValue = parseInt($("#loopIndexValue").val());

        var html  = "<input type=\"text\" value=\""+aData[0]+"\"   name=\"projectPlanning["+loopIndexValue+"].eftName\"   class=\"planningField\"  >"
        + "<input type=\"hidden\" value=\"${project.id}\" name=\"projectPlanning["+loopIndexValue+"].projectId\"  class=\"planningField\"  />"
        + "<input type=\"hidden\" value=\"added through ui\" name=\"projectPlanning["+loopIndexValue+"].description\"  class=\"planningField\"  />"
        + "<input type=\"hidden\" value=\"plan for ${project.name}\" name=\"projectPlanning["+loopIndexValue+"].name\"  class=\"planningField\"  />";

        var comboHtml = " <select class=\"combobox\" name=\"projectPlanning["+loopIndexValue+"].itemStatus.id\" id=\"projectPlanning"+loopIndexValue+".itemStatus.id\"  class=\"planningField\"  >  "+
        "   <option value=\"1\">New</option>  "+
        "   <option value=\"2\">On Track</option>  "+
        "   <option value=\"3\">Minor Impact</option>  "+
        "   <option value=\"4\">Major Impact</option>  "+
        "   <option value=\"5\">Complete</option>  "+
        " </select>  ";

        jqTds[0].innerHTML = html;
        jqTds[1].innerHTML = "<input type=\"text\" value=\""+aData[1]+"\"    name=\"projectPlanning["+loopIndexValue+"].item\"  class=\"planningField\"   >";
        jqTds[2].innerHTML = "<input type=\"text\" value=\""+aData[2]+"\"    name=\"projectPlanning["+loopIndexValue+"].itemDate\" class=\"datepicker planningField \"  >";
        jqTds[3].innerHTML = comboHtml;
        jqTds[4].innerHTML = "<textarea id=\"projectPlanText-["+loopIndexValue+"]\" type=\"text\" value=\"\"    name=\"projectPlanning["+loopIndexValue+"].document\" class=\"documents planningField planningDocument\" >"+aData[4]+"</textarea>";

        $("#loopIndexValue").val(loopIndexValue+1);
        $( ".datepicker" ).datepicker();
        $( ".combobox" ).combobox();
        $( ".documents").ckeditor(planningeditorConfig); // -- THIS LINE IS IMPORTANT TO SET THE TEXTAREA TO CKEDITOR INSTANCES WITHOUT WHICH ONLY THE NEW ROW WILL HAVE THE CKEDITOR INSTANCE AND REST WILL BE TURNED BACK TO TEXTAREA

        nEditing = nRow;
    } ); 
```

# visual-studio-2012 - Resharper 在按下返回键时插入 br 标签

> ID：15800248
> 
> 赞同：2
> 
> 时间：2013-04-03T23:52:35.120
> 
> 标签：visual-studio-2012, resharper

我不确定这是怎么发生的，但是每当我在 HTML/Razor 编辑器窗口中按回车键时，它都会插入一个`<br>`标签而不是新行。

只有当我在光标位于标签末尾时按下回车键时才会这样做，例如在 this 的末尾`<div>`。

如果我的光标已经在一个空行上并且我按回车它工作正常。

我相信这与 ReSharper 有关，因为如果我禁用 ReSharper 它工作得很好，我已经尝试了所有我能想到的设置，以及将所有设置重置为默认值，但仍然没有运气。

*   锐器版本 7
*   视觉工作室 2012

有人有想法么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T23:54:51.903

这是[已](http://youtrack.jetbrains.com/issue/RSRP-330382)在 ReSharper v7.1 中修复的错误。尝试升级到较新的版本。

# java - 使给定字符串成为回文

> ID：15800249
> 
> 赞同：1
> 
> 时间：2013-04-03T23:52:41.423
> 
> 标签：java, oop, recursion, palindrome

有人可以讨论并解释一种方法我可以修改我的代码以使用这些测试用例...我试图让我的程序接受一个单词并通过替换单词中的一个字母来使其成为回文，以防止单词被回文

所需的测试用例：

```
Palindromes.isPalindrome2("cat", 'c') => true
Palindromes.isPalindrome2("axaa", 'x') => true
Palindromes.isPalindrome2("12bb", 'b') => true
Palindromes.isPalindrome2("ca", 'c') => true 
```

这是我迄今为止所拥有的......

```
public class Palindromes {

    public static boolean isPalindrome(String word) {
        //Strip out non-alphanumeric characters from string
        String cleanWord = word.replaceAll("[^a-zA-Z0-9]","");
        //Check for palindrome quality recursively
        return checkPalindrome(cleanWord);
    }

    public static boolean isPalindrome2(String word) {
        //Strip out non-alphanumeric characters from string
        String cleanWord = word.replaceAll("[^a-zA-Z0-9]","");
        //Check for palindrome quality recursively
        return checkPalindrome2(cleanWord);
    }

    public static boolean checkPalindrome(String word) {
        if(word.length() < 2) { 
            return true;  
        }
        char first  = word.charAt(0);
        char last   = word.charAt(word.length()-1);
        if(first != last) { 
            return false; 
        }
        else { 
            return checkPalindrome(word.substring(1,word.length()-1));
        }
    }

    public void replace(int first, int last) {
        if(first != last)
        { first = last;}
        else if(last != first) 
        { last = first;}
        }

    public static boolean checkPalindrome2(String word) {
        char special = 0;
        if(word.length() < 2) { 
            return true;  
        }
        char first  = word.charAt(0);
        char last   = word.charAt(word.length()-1);
        if(first != last) { 
            return false; 
        }
        if(first != last)
            return false; 
        else {
            return checkPalindrome2(word.substring(1,word.length()-1));
        }
    }
} 
```

replace() 是我处理通配符的尝试，但我似乎找不到合适的解决方案......所有帮助将不胜感激。谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:20:53.880

这是我要做的步骤：

*   将接收到的字符串拆分为 2 个子字符串。第一个字符串`front`是字符串的前半部分，第二个字符串`back`是字符串的一半末端。

例子：

```
char replacement = 'c';

String input = "aabbcc";
StringBuilder front = new StringBuilder(input.substring(0, input.length()/2));
// Do modulus to not include the odd middle (it mirrors itself)
StringBuilder back = new StringBuilder(input.substring((input.length()/2)+(input.length()%2)); 
```

*   比较两个字符串，如果一个匹配而另一个不匹配则替换。如果两者都不匹配并且不是给定的“替换”字符，则返回 false。如果您进行了多次替换，请返回 false （因为这就是您所说的要求）

例子：

```
int replacements = 0;
for (int i=0; i < front.length(); ++i)
{
    int backIndex = back.length() - i;
    if (front.charAt(i) != back.charAt(backIndex))
    {
        // Characters do not match at all to given replacement
        if ((front.charAt(i) != replacement) &&
            (back.charAt(backIndex) != replacement)
        {
            // Cannot make it 
            // (Or if you want to force it, set both to replacement
            //  by deleting this one if statement)
            return false;
        }
        // Front matches replacement
        else if (front.charAt(i) == replacement)
        {
            // Replace back character with replacement
            back.setCharAt(backIndex, replacement);
            replacements++;
        }
        // Back matches replacement
        else if (back.charAt(backIndex) == replacement)
        {
            // Replace front character with replacement
            front.setCharAt(i, replacement);
            replacements++;
        }
        if (replacements > 1)
        {
            // Can only replace one
            return false;
        }
    }
}

String output = front.toString() + back.toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T01:12:12.907

这是我的代码，它将输入分成两半，并将前半部分与相反的后半部分进行比较。如果它们相等，则输入已经是回文。如果它们不相等，则遍历前半部分，与`char`要替换的输入交换字母，并在每一步与反向的后半部分进行比较。然后它做同样的事情，但使用后半部分而不是前半部分：

```
public class CanMakePalindrome {

    public static void main(String[] args) {
        System.out.println("cat using c: " + canMakePalindrome("cat", 'c'));
        System.out.println("axaa using x: " + canMakePalindrome("axaa", 'x'));
        System.out.println("12bb using b: " + canMakePalindrome("12bb", 'b'));
        System.out.println("ca using c: " + canMakePalindrome("ca", 'c'));
    }

    private static boolean canMakePalindrome(String input, char c) {
        int length = input.length();
        String start = input.substring(0, length/2);
        String end = input.substring(length/2+length%2, length); // need modulus in the case of odd length input

        return (replaceLoop(start,end, c) || replaceLoop(end,start, c));
    }

    private static boolean replaceLoop(String start, String end, char c) {
        if (start.equals(reverse(end))) {
            System.out.println("Input is already a palindrome.");
            return true;
        }

        for (int i=0; i<start.length(); i++) {
            char[] startchars = start.toCharArray();
            char[] endchars = end.toCharArray();
            endchars = reverse(endchars);
            startchars[i] = c;
            if ((new String(startchars).equals(new String(endchars)))) return true;
        }

        return false;
    }

    private static char[] reverse(char[] input) {
        int length = input.length;
        char[] reversed = new char[length];
        for (int i=0;i<length;i++) {
            reversed[length-i-1]=input[i];
        }
        return reversed;
    }

    private static String reverse(String input){
        String reversed = new String(reverse(input.toCharArray())); 
        return reversed;
    }

} 
```

输出：

```
cat using c: true
axaa using x: true
12bb using b: false
ca using c: true 
```

请注意，仅使用一个字符更改无法将 12bb 制成回文，因此您的测试用例似乎与您仅替换一个字母的规范不匹配。如果给定一个空字符串作为输入，我的代码也将返回 true。

# sql - 为两列的组合添加唯一约束

> ID：15800250
> 
> 赞同：201
> 
> 时间：2013-04-03T23:52:48.780
> 
> 标签：sql, sql-server

我有一张桌子，不知何故，同一个人`Person`两次上了我的桌子。现在，主键只是一个自动编号，但还有另外两个字段，我想强制它们是唯一的。

例如，这些字段是：

```
ID  
Name  
Active  
PersonNumber 
```

**我只想要 1 条具有唯一 PersonNumber 且 Active = 1 的记录。**
（因此这两个字段的组合需要是唯一的）

SQL Server 中现有表的最佳方法是什么我可以做到，所以如果其他人使用与现有值相同的值进行插入，它会失败，所以我不必在我的应用程序代码中担心这一点。

* * *

## 回答 #1

> 赞同：295
> 
> 时间：2013-04-03T23:56:18.293

删除重复项后：

```
ALTER TABLE dbo.yourtablename
  ADD CONSTRAINT uq_yourtablename UNIQUE(column1, column2); 
```

或者

```
CREATE UNIQUE INDEX uq_yourtablename
  ON dbo.yourtablename(column1, column2); 
```

当然，在让 SQL Server 尝试插入行并返回异常（异常代价高昂）之前，通常最好先检查此违规行为。

*   [不同错误处理技术的性能影响](http://www.sqlperformance.com/2012/08/t-sql-queries/error-handling)

*   [在进入 TRY/CATCH 之前检查潜在的约束违规](http://www.mssqltips.com/sqlservertip/2632/checking-for-potential-constraint-violations-before-entering-sql-server-try-and-catch-logic/?utm_source=AaronBertrand)

如果您想防止异常冒泡到应用程序，而不对应用程序进行更改，您可以使用`INSTEAD OF`触发器：

```
CREATE TRIGGER dbo.BlockDuplicatesYourTable
 ON dbo.YourTable
 INSTEAD OF INSERT
AS
BEGIN
  SET NOCOUNT ON;

  IF NOT EXISTS (SELECT 1 FROM inserted AS i 
    INNER JOIN dbo.YourTable AS t
    ON i.column1 = t.column1
    AND i.column2 = t.column2
  )
  BEGIN
    INSERT dbo.YourTable(column1, column2, ...)
      SELECT column1, column2, ... FROM inserted;
  END
  ELSE
  BEGIN
    PRINT 'Did nothing.';
  END
END
GO 
```

但是如果你不告诉用户他们没有执行插入，他们会想知道为什么数据不存在并且没有报告异常。

* * *

**这里的编辑**是一个完全符合您要求的示例，即使使用与您的问题相同的名称，也可以证明这一点。在假设上述想法只处理一列或另一列而不是组合之前，您应该尝试一下......

```
USE tempdb;
GO

CREATE TABLE dbo.Person
(
  ID INT IDENTITY(1,1) PRIMARY KEY,
  Name NVARCHAR(32),
  Active BIT,
  PersonNumber INT
);
GO

ALTER TABLE dbo.Person 
  ADD CONSTRAINT uq_Person UNIQUE(PersonNumber, Active);
GO

-- succeeds:
INSERT dbo.Person(Name, Active, PersonNumber)
  VALUES(N'foo', 1, 22);
GO

-- succeeds:
INSERT dbo.Person(Name, Active, PersonNumber)
  VALUES(N'foo', 0, 22);
GO

-- fails:
INSERT dbo.Person(Name, Active, PersonNumber)
  VALUES(N'foo', 1, 22);
GO 
```

在所有这些之后表中的数据：

```
ID   Name   Active PersonNumber
---- ------ ------ ------------
1    foo    1      22
2    foo    0      22 
```

最后插入的错误消息：

> 消息 2627，级别 14，状态 1，第 3 行违反 UNIQUE KEY 约束“uq_Person”。无法在对象“dbo.Person”中插入重复键。该语句已终止。

此外，我最近还写了一篇关于以任一顺*序*将唯一约束应用于两列的解决方案的博客：

*   [在顺序无关紧要的情况下实施独特的约束](https://www.mssqltips.com/sqlservertip/6737/sql-unique-constraint-where-order-does-not-matter/?utm_source=AaronBertrand)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-08-18T15:21:34.843

这也可以在 GUI 中完成：

1.  在“人员”表下，右键单击*索引*
2.  单击/悬停*新索引*
3.  单击*非聚集索引...*

[![在此处输入图像描述](https://i.stack.imgur.com/ds2cO.png)](https://i.stack.imgur.com/ds2cO.png)

4.  将给出默认*索引名称*，但您可能需要更改它。
5.  选中*唯一*复选框
6.  单击*添加...*按钮

[![在此处输入图像描述](https://i.stack.imgur.com/98Bwm.png)](https://i.stack.imgur.com/98Bwm.png)

7.  检查要包含的列

[![在此处输入图像描述](https://i.stack.imgur.com/2MtYi.png)](https://i.stack.imgur.com/2MtYi.png)

8.  在每个窗口中单击*确定。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-14T17:01:47.003

在我的情况下，我需要允许许多不活动并且只有两个键的一个组合活动，如下所示：

```
UUL_USR_IDF  UUL_UND_IDF    UUL_ATUAL
137          18             0
137          19             0
137          20             1
137          21             0 
```

这似乎有效：

```
CREATE UNIQUE NONCLUSTERED INDEX UQ_USR_UND_UUL_USR_IDF_UUL_ATUAL
ON USER_UND(UUL_USR_IDF, UUL_ATUAL)
WHERE UUL_ATUAL = 1; 
```

这是我的测试用例：

```
SELECT * FROM USER_UND WHERE UUL_USR_IDF = 137

insert into USER_UND values (137, 22, 1) --I CAN NOT => Cannot insert duplicate key row in object 'dbo.USER_UND' with unique index 'UQ_USR_UND_UUL_USR_IDF_UUL_ATUAL'. The duplicate key value is (137, 1).
insert into USER_UND values (137, 23, 0) --I CAN
insert into USER_UND values (137, 24, 0) --I CAN

DELETE FROM USER_UND WHERE UUL_USR_ID = 137

insert into USER_UND values (137, 22, 1) --I CAN
insert into USER_UND values (137, 27, 1) --I CAN NOT => Cannot insert duplicate key row in object 'dbo.USER_UND' with unique index 'UQ_USR_UND_UUL_USR_IDF_UUL_ATUAL'. The duplicate key value is (137, 1).
insert into USER_UND values (137, 28, 0) --I CAN
insert into USER_UND values (137, 29, 0) --I CAN 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-01T06:04:07.837

如果您有很多插入查询但不想每次都发出错误消息，您可以这样做：

```
CREATE UNIQUE NONCLUSTERED INDEX SK01 ON dbo.Person(ID,Name,Active,PersonNumber) 
WITH(IGNORE_DUP_KEY = ON) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/RJ7n1.jpg)](https://i.stack.imgur.com/RJ7n1.jpg)

# python - 递归技术而不是python中的列表技术

> ID：15800251
> 
> 赞同：1
> 
> 时间：2013-04-03T23:52:54.710
> 
> 标签：python, recursion

我有一个函数，它的名字是 positive_negative

```
def positive_negative(list_changes):
    """ (list of number) -> (number, number) tuple

    list_changes contains a list of float numbers. Return a 2-item
    tuple where the first item is the sum of the positive numbers in list_changes and
    the second is the sum of the negative numbers in list_changes.

    >>> positive_negative([0.01, 0.03, -0.02, -0.14, 0, 0, 0.10, -0.01])
    (0.14, -0.17)
    """ 
```

我可以使用以下列表技术编写此函数：

```
def positive_negative(list_changes):
    pos = sum([item for item in list_changes if item > 0.0])
    neg = sum ([item for item in list_changes if item < 0.0]) 
    return pos, neg 
```

这是一个很好的解决方案。现在我的问题是如何使用递归技术来解决相同的功能，我尝试了以下代码，但不幸的是出现了问题。

```
def positive_negative(list_changes):
    pos = 0.0
    neg = 0.0
    if len(list_changes)== 0:
        pos =+ 0.0
        neg =+ 0.0
        return pos,neg
    else:
        if list_changes[0] > 0.0 :
            pos =+ list_changes[0]
        else:
            neg =+ list_changes[0]
        positive_negative(list_changes[1:])

    return pos,neg 
```

你能帮我找出我的错误以及如何获得正确的递归函数吗？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T23:56:27.707

你的第一个问题是这样的：

```
pos =+ list_changes[0] 
```

Python 没有`=+`运算符。所以，这相当于：

```
pos = (+list_changes[0]) 
```

因为`list_changes[0]`是一个数字，并且与任何数字`+n`相同`n`（除了在某些不重要的边缘情况下），你只是`pos`每次都替换而不是添加它。

你可能想要这个：

```
pos += list_changes[0] 
```

* * *

但是你试图使用的事实`+=`是一个更根本的误解。堆栈上的每个实例`positive_negative`都有自己的`pos`值`neg`。这些从 0.0 开始，然后添加`0.0`或添加`list_changes[0]`到它们，然后调用不影响它们的函数，然后返回它们。所以，你最终会返回`0.0, list_changes[0]`or `list_changes[0], 0.0`; 列表中后面的任何内容都不会影响结果。

* * *

如果您希望递归函数调用添加任何内容，则需要对其返回值做一些事情。像这样的东西：

```
def positive_negative(list_changes):
    if len(list_changes)== 0:
        return 0.0, 0.0
    else:
        pos, neg = positive_negative(list_changes[1:])
        if list_changes[0] > 0.0:
            pos += list_changes[0]
        else:
            neg += list_changes[0]
        return pos, neg 
```

当然，这个解决方案显然不是尾递归的……但这没关系，因为 Python 无论如何都不做尾递归优化。我认为这是最接近您想要完成的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-03T23:57:21.773

使用一些累加器（psum，nsum）：

```
def positive_negative(list_changes, psum=0, nsum=0):
    if len(list_changes) == 0:
            return psum, nsum
    if list_changes[0] < 0:
            nsum += list_changes[0]
    else:
            psum += list_changes[0]
    return positive_negative(list_changes[1:], psum, nsum)

# and another version:
def positive_negative2(list_changes, psum=0, nsum=0):
    if len(list_changes) == 0:
            return psum, nsum
    if list_changes[0] < 0:
            return positive_negative(list_changes[1:], 
                            psum, nsum + list_changes[0])
    return positive_negative(list_changes[1:], 
                            psum + list_changes[0], nsum)

print positive_negative([0.01, 0.03, -0.02, -0.14, 0, 0, 0.10, -0.01]) 
```

**输出**

```
(0.14, -0.17) 
```

附带说明一下，python 不进行尾调用优化，因此在使用递归时要小心。如果您的列表中有大约 1000 个项目，则上述功能将失败。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T00:05:32.240

不使用尾递归：

```
import operator

def positive_negative_change(l):
    if not l:
        return (0.0, 0.0)

    if l[0] >= 0:
        return tuple(map(operator.add, (l[0], 0.0),
                         positive_negative_change(l[1:])))
    else:
        return tuple(map(operator.add, (0.0, l[0]),
                         positive_negative_change(l[1:]))) 
```

在 python 中，一个人会使用生成器，或者尾递归……如果你想复习递归，只需阅读小计划者

# matlab - MATLAB：在满足某些条件的矩阵中保留许多随机行

> ID：15800253
> 
> 赞同：0
> 
> 时间：2013-04-03T23:53:02.947
> 
> 标签：matlab, matrix, random-sample

我在 Matlab 中有一个与此类似的矩阵，除了有数千行：

```
A =

     5     6     7     8
     6     1     2     3
     5     1     4     8
     5     2     3     7
     5     8     7     2
     6     1     3     8
     5     2     1     6
     6     3     2     1 
```

我想得到一个矩阵，它有三个随机行，第一列有一个“5”，三个随机行第一列有一个“6”。所以在这种情况下，输出矩阵看起来像这样：

```
A =

     5     6     7     8
     6     1     2     3
     5     2     3     7
     6     1     3     8
     5     2     1     6
     6     3     2     1 
```

这些行必须是随机的，而不仅仅是原始矩阵中的前三个或后三个。我不太确定如何开始，所以任何帮助将不胜感激。

编辑：这是我迄今为止最成功的尝试。我在第一列中找到了所有带有“5”的行：

```
BLocation = find(A(:,1) == 5);
B = A(BLocation,:); 
```

然后我试图像这样使用'randsample'从B中找到三个随机行：

```
C = randsample(B,3); 
```

但 'randsample' 不适用于矩阵。

我也认为这可以更有效地完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T02:01:44.420

您需要`randsample`在满足条件的行索引上运行，即等于 5 或​​ 6。

```
n = size(A,1);

% construct the linear indices for rows with 5 and 6 
indexA = 1:n; 
index5 = indexA(A(:,1)==5);
index6 = indexA(A(:,1)==6);

% sample three (randomly) from each 
nSamples = 3;
r5 = randsample(index5, nSamples);
r6 = randsample(index6, nSamples);

% new matrix from concatenation 
B = [A(r5,:); A(r6,:)]; 
```

**更新**：您也可以`find`按照 yuk 的建议来替换原来的索引结构，这被证明更快（并且优化了！）。

**基准测试(MATLAB R2012a **)****

 **```
A = randi(10, 1e8, 2); % 10^8 rows random matrix of 1-10

tic;
n = size(A,1);
indexA = 1:n;
index5_1 = indexA(A(:,1)==5);
toc

tic;
index5_2 = find(A(:,1)==5);
toc

Elapsed time is 1.234857 seconds.
Elapsed time is 0.679076 seconds. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T01:30:32.867

您可以按如下方式执行此操作：

```
desiredMat=[];
mat1=A(A(:,1)==5,:);
mat1=mat1(randperm(size(mat1,1)),:);
desiredMat=[desiredMat;mat1(1:3,:)];
mat1=A(A(:,1)==6,:);
mat1=mat1(randperm(size(mat1,1)),:);
desiredMat=[desiredMat;mat1(1:3,:)]; 
```

上面的代码使用逻辑索引。您也可以使用`find`函数来执行此操作（逻辑索引总是比 快`find`）。**

# java - Java PreparedStatement 无法识别子查询中的占位符

> ID：15800259
> 
> 赞同：3
> 
> 时间：2013-04-03T23:54:06.353
> 
> 标签：java, postgresql

使用 Java PreparedStatement 时，未检测到问号占位符。*调用statementName* .setLong(1, 123)时会抛出错误“列索引超出范围：1，列数：0” 。我的示例来自 Postgres 8.4，但问题发生在 SQL 有机会进入 SQL 服务器之前。

在与一些工作准备好的语句进行比较后，我意识到损坏的语句包含一个类似于以下内容的子查询：

```
SELECT * FROM ( 
  SELECT DISTINCT (name) 
    id, 
    name 
  FROM MyTable
  WHERE id > ?
  ORDER BY name) AS Level1
ORDER BY 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T23:54:06.353

对我有用的解决方案是将查询转换为 CTE（公用表表达式）。修改后的查询如下所示：

```
WITH Level1 AS ( 
  SELECT DISTINCT (name) 
    id, 
    name 
  FROM MyTable
  WHERE id > ?
  ORDER BY name)

SELECT * 
FROM Level1
ORDER BY 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T23:58:37.887

在 JDBC 中，prepared statements 的参数索引从 1 而不是 0 开始。

# opencv - cvConvertScale 错误

> ID：15800261
> 
> 赞同：1
> 
> 时间：2013-04-03T23:54:11.847
> 
> 标签：opencv, python-2.7

我是 Python 和 openCV 的新手，所以如果这很简单，我提前道歉。我正在尝试遵循[http://altruisticrobot.tistory.com/219](http://altruisticrobot.tistory.com/219)上的深度图代码。在下面的代码中`ConvertScale`引发以下错误：

```
src.size == dst.size && src.channels() == dst.channels() 
```

我花了几天时间，不知道为什么。任何指针将不胜感激。提前致谢。

```
im_l = cv.LoadImage('C:\Python27\project\captureL6324.png',cv.CV_LOAD_IMAGE_GRAYSCALE)
im_r = cv.LoadImage('C:\Python27\project\captureR6324.png',cv.CV_LOAD_IMAGE_GRAYSCALE)
imsize = cv.GetSize(im_l)
disp = cv.CreateImage(imsize,cv.IPL_DEPTH_16S,1)# to receive Disparity
#run stereo Correspondence-- returns a single channel 16 bit signed disparity
disparity = cv.FindStereoCorrespondenceBM(im_r,im_l,disp,cv.CreateStereoBMState())
#convert to a real disparity by dividing it by 16-- first create variable to hold the  converted scale
real_disparity = cv.CreateImage(imsize,cv.IPL_DEPTH_16S,1)
cv.ConvertScale(disparity, real_disparity, -16,0)
#get the point cloud
depth = cv.CreateImage(cv.GetSize(im_l),cv.IPL_DEPTH_32F,3)
cv.ReprojectIMageTo3D(real_disparity,depth, ReprojectMatrix) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T16:42:57.597

您的问题是，`FindStereoCorrespondenceBM`将结果保存在第三个参数中，但您使用的是返回值，`None`用于进一步计算。这会导致错误，因为需要特定大小和类型的矩阵。

所以只要改变

```
cv.ConvertScale(disparity, real_disparity, -16,0) 
```

到

```
cv.ConvertScale(disp, real_disparity, -16,0) 
```

为了运行整个脚本，我还将最后一行更改为

```
ReprojectMatrix = cv.CreateMat(4,4,cv.CV_32FC1);
cv.ReprojectImageTo3D(real_disparity,depth, ReprojectMatrix) 
```

这个脚本对我来说运行没有错误。但我还没有检查它是否给出了正确的结果。

# .net - .net rdf dblp 数据集查询

> ID：15800269
> 
> 赞同：0
> 
> 时间：2013-04-03T23:55:13.830
> 
> 标签：.net, rdf, dotnetrdf

当我运行以下代码以使用此代码片段查询 dblp 数据集时，我正在使用此端点[http://dblp.l3s.de/d2r/snorql](http://dblp.l3s.de/d2r/snorql) `enter code here` String st = ""; 字符串 qry = ""; 字符串 uri_V;

```
 uri_V = "http://dblp.l3s.de/d2r/sparql";

    // Modify if need......
    //String ns = "\""+TextBox1.Text.ToString()+"\"";
    // String qry = "SELECT DISTINCT ?name WHERE { ?person foaf:name ?name.FILTER regex(str(?name),"+ns+").}";
    if (radiosrch.SelectedIndex == 0)
    {
        qry = "SELECT ?title WHERE {?game <http://purl.org/dc/terms/subject> <http://dbpedia.org/resource/Category:First-person_shooters> .?game foaf:name ?title .}ORDER by ?title";
    }
    else// if (radiosrch.SelectedIndex == 1) 
    {
        // qry= "query for publisher."
        qry = "SELECT DISTINCT ?Concept WHERE {[] a ?Concept} LIMIT 10";
    }

    //Common
    SparqlRemoteEndpoint endpoint = new SparqlRemoteEndpoint(new Uri(uri_V));
    SparqlResultSet results = endpoint.QueryWithResultSet(qry);
    foreach (SparqlResult result in results)
    {
        Console.WriteLine(result.ToString());
        st = st + result.ToString() + "\n";
    }
    TextBox3.Text = st.ToString();
}
catch (Exception ex)
{
    Label1.Visible = true;
    Label1.Text = ex.ToString();
} 
```

我收到以下错误

VDS.RDF.Query.RdfQueryException：尝试进行 SPARQL 查询时发生 HTTP 错误，有关详细信息，请参阅内部异常 ---> System.Net.WebException：远程服务器返回错误：（400）错误请求。在 System.Net.HttpWebRequest.GetResponse() 在 VDS.RDF.Query.SparqlRemoteEndpoint.ExecuteQuery(Uri target, String postData, String accept) 在 VDS.RDF.Query.SparqlRemoteEndpoint.QueryInternal(String sparqlQuery, String acceptHeader) 在 VDS。 RDF.Query.SparqlRemoteEndpoint.QueryWithResultSet(ISparqlResultsHandler handler, String sparqlQuery) --- 内部异常堆栈跟踪结束 --- 在 VDS.RDF.Query.SparqlRemoteEndpoint.QueryWithResultSet(ISparqlResultsHandler handler, String sparqlQuery) 在 VDS.RDF.Query。 SparqlRemoteEndpoint.QueryWithResultSet(String sparqlQuery) at Index.ImageButton1_Click(Object sender, ImageClickEventArgs e) in d：

请帮我尽快解决，请

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:02:01.237

请参阅使用 dotNetRDF[调试 HTTP 通信的文档](https://bitbucket.org/dotnetrdf/dotnetrdf/wiki/HowTo/Debug%20HTTP%20Communication.wiki#!debugging-http-communication)

在您的请求之前设置以下内容：

```
Options.HttpDebugging = true; 
```

然后，这将使 dotNetRDF 向控制台打印有关 HTTP 请求和响应的调试信息，如果这还不够启发性，还可以启用以下功能：

```
Options.HttpFullDebugging = false; 
```

这会将完整的 HTTP 响应转储到控制台，这样您就可以准确地看到服务器发回的任何错误消息。

*然而*，打开后一个选项将导致后续代码失败并出现不同的错误，因为预期的响应流不会被耗尽，所以一旦这为您提供了足够的信息来调试您的问题，请不要忘记再次将其关闭！

# google-apps-script - 基于谷歌电子表格中两个单元格的条件格式

> ID：15800274
> 
> 赞同：0
> 
> 时间：2013-04-03T23:55:57.137
> 
> 标签：google-apps-script

尝试根据 a 列中的文本单元格或理想情况下 a 和 b 的组合对行进行条件格式化 [在 google 电子表格中]。[“热铅”+“大opp”]

我的标题行位于顶部，因此关键数据从 a3 开始。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:43:03.797

函数 onEdit() { var s = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Sheet1'), values = s.getRange('A3:B').getValues(), x, rowColors = [], color, colors = [ ], numCols = 3;

for (var row = 0, len = values.length; row < len; row++) { if (values[row][0] === 'Hot lead' && values[row][1] === 'large opp ') 颜色 = '红色'; 否则颜色='白色'; for (x = 0; x < numCols; x++ ) rowColors.push(color); 颜色.push(rowColors); 行颜色 = []; }

s.getRange('A3').offset(0,0,colors.length, numCols).setBackgroundColors(colors); }

# java - 同时在多个 java 实例上自动执行 JAVA 内存分析

> ID：15800278
> 
> 赞同：3
> 
> 时间：2013-04-03T23:56:09.770
> 
> 标签：java, memory, profiling, memory-profiling

我在开发 JAVA 方面相对缺乏经验，我希望能得到一些建议。

我有一个模块化的 JAVA 服务器应用程序设置，其中一个高级服务充当与 8 个较低级别服务通信的前端接口。

在生产中，每个服务都托管在自己的机器上。

我正在寻找一个标准的 SE 开发环境，它在本地启动所有实例。我目前正在使用 eclipse 和 JVMmonitor。

我目前的工作流程涉及手动启动每个服务，然后通过eclipse手动触发每个服务的监控过程。这个工作流程可以完成工作，但我确信有人遇到过更智能的解决方案。大多数论坛帖子只解决监控一个java实例。

还有其他任何人会建议的独立 JAVA 应用程序吗？如果可能，我想避免添加分析代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-08T11:22:02.403

大多数分析器允许您分析 JVM，而无需手动启动分析器。

例如，[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)将此称为“离线分析”，而 JProfiler GUI 中的集成向导有一个选项：

![在此处输入图像描述](https://i.stack.imgur.com/Zirxk.png)

免责声明：我公司开发 JProfiler。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T11:42:02.053

使用visualVM。您可以从您的本地计算机配置文件到不同的服务器。 [http://docs.oracle.com/javase/6/docs/technotes/guides/visualvm/applications_remote.html](http://docs.oracle.com/javase/6/docs/technotes/guides/visualvm/applications_remote.html)要在不同服务器中进行分析，您需要定义 jstatd.all.policy 文件。例如，如果您想监控不同的服务器，比如 s1,s2,s3，那么在 s1,s2,s3 服务器中定义 jstatd.all.policy 文件并运行 statd - Virtual Machine jstat Daemon。然后从您的本地计算机上您可以监控 3 s1 ,s2,s3 服务器。

在很容易配置它。

1.运行visualVm你可以得到ecipe插件。

2.运行 jstatd -J-Djava.security.policy=D:\jstatd.all.policy // 你的 jstatd.all.policy 文件在你的服务器中的位置

3.在 jstatd.all.policy 中定义授权代码库 "file:${java.home}/../lib/tools.jar" {

权限 java.security.AllPermission;

};

4.现在连接到您的服务器并从本地监控。

# java - 使随机字符串小写

> ID：15800284
> 
> 赞同：0
> 
> 时间：2013-04-03T23:56:36.717
> 
> 标签：java, substring, uppercase, lowercase

我需要创建一个由三个随机大写字母和三个随机数字组成的字符串，并输出我已经完成的结果。接下来我需要将整个字符串变为小写，输出结果，然后只将第一个字符变为大写并输出结果。我一直在尝试使用`substring()`，但它没有编译，我不太确定如何使用`substring()`随机生成器。这是我写的，如果我能得到一些帮助，那就太好了。

```
import java.util.Random;

public class RandomString
{
    public static void main(String[] args)
    {  Random generator = new Random();

       int randomNumber = generator.nextInt(2);
       char randomChar = (char)('A');
       System.out.print("A random string is " + randomChar);

       randomNumber = generator.nextInt(26);
       randomChar = (char)('A' + randomNumber);
       System.out.print(randomChar);

       randomNumber = generator.nextInt(26);
       randomChar = (char)('A' + randomNumber);
       System.out.print(randomChar);

       randomNumber = generator.nextInt(10);
       System.out.print(randomNumber);

       randomNumber = generator.nextInt(10);
       System.out.print(randomNumber);

       randomNumber = generator.nextInt(10);
       System.out.println(randomNumber);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:02:42.790

```
// Get the string representation of the number
String sRandomNumber = Integer.toString(randomNumber);

// Convert to lower case
sRandomNumber = sRandomNumber.toLowerCase();

// Print it
System.out.println("In Lower Case: " + sRandomNumber);

// Make first char upper case
sRandomNumber = sRandomNumber.substring(0,1).toUpperCase() + sRandomNumber.substring(1);

// Print it again
System.out.println("With 1st char upper case: " + sRandomNumber); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T03:15:45.143

```
 // create a string of 3 random capital letters
    StringBuilder sb = new StringBuilder();
    Random random = new Random();
    for(int i = 0; i < 3; i++) {
        sb.append((char)('A' + random.nextInt(26)));
    }
    // and 3 random digits
    for(int i = 0; i < 3; i++) {
        sb.append(random.nextInt(10));
    }
    // output the result
    System.out.println(sb);
    // make this whole string lower case and output the result
    String lowerCase = sb.toString().toLowerCase();
    System.out.println(lowerCase);
    // make only the first character upper case and output the result
    System.out.println(lowerCase.substring(0, 1).toUpperCase() + lowerCase.substring(1)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:05:07.153

字符串是板条箱的方式是无关紧要的。给定任何字符串，将第一个字母大写，其余字母小写：

```
str = str.substring(0, 1).toUpperCase() + str.substring(1).toLowerCase(); 
```

# mysql - Django双内连接与mysql慢

> ID：15800286
> 
> 赞同：2
> 
> 时间：2013-04-03T23:57:16.350
> 
> 标签：mysql, sql, django, join

为什么在使用 MySQL 的 Django 中这个查询很慢？我使用 OneToOne 和 ForeignKey 过滤了三个相互关联的模型。在我的数据库上进行以下大约 60k 行的查询需要大约 300 秒才能完成。

```
resutls = A.objects.filter(b__c__candy__icontains="gummybears")
results  # <-- 300 seconds 
```

应用中的模型：

```
class A(models.Model):
    b = models.OneToOneField(B, default=None)
    a_charfield = models.CharField(max_length=40, default='')

class B(models.Model):
    b_charfield = models.CharField(max_length=40, default='')
    primary_id = models.CharField(max_length=40, unique=True, primary_key=True, default='', null=False)

class C(models.Model):
    b = models.ForeignKey('B')
    candy = models.CharField(db_index=True, max_length=40, default='') 
```

打印 result.query 将 MySQL 查询显示为（我将列名组合为 *）：

```
SELECT *
FROM `app_a` 
INNER JOIN `app_b` ON (`app_a`.`b_id` = `app_b`.`primary_id`) 
INNER JOIN `app_c` ON (`app_b`.`primary_id` = `app_c`.`b_id`) 
WHERE `app_c`.`candy` LIKE %gummybears%  
ORDER BY `app_a`.`id` DESC 
```

我有两个可行的解决方案。

1.  从 B 获取结果作为 values_list 并用作 A 的过滤器 arg。 [https://docs.djangoproject.com/en/dev/ref/models/querysets/#in](https://docs.djangoproject.com/en/dev/ref/models/querysets/#in) 性能注意事项

    ```
    resutls = A.objects.filter(b__in=list(B.objects.filter(c__c_charfield__icontains="candy").values_list('pk', flat=True)) 
    ```

2.  切换到postgresql。双内连接工作 < 1 秒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-13T22:07:34.053

以下代码中的前导 % 强制查询执行全表扫描，而不是使用索引。如果糖果桌不适合内存，那将需要一段时间。

```
WHERE `app_c`.`candy` LIKE %gummybears% 
```

[请参阅B-Tree 索引特性](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)下的文档

# python - 将列表转换为集合会改变元素的顺序吗？

> ID：15800296
> 
> 赞同：2
> 
> 时间：2013-04-03T23:58:18.677
> 
> 标签：python, list, set

当我做类似的事情时：

```
U = [(1.0, 0.0), (0.0, 1.0)]
set(U) 
```

它给了我：

```
{(0.0, 1.0), (1.0, 0.0)} 
```

我只想将列表转换为集合。有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:07:42.067

套装不排序。字典也没有排序。如果要保留特定顺序，请使用列表。

```
>>> ''.join(set("abcdefg"))
'acbedgf'
>>> ''.join(set("gfedcba"))
'acbedgf'
>>> ''.join(set("1234567"))
'1325476'
>>> ''.join(set("7654321"))
'1325476' 
```

显然，当您迭代一个集合时，必须出现*某种*顺序。但订单是您无法指定的任意订单。

这是我最喜欢的：

```
>>> {'apple', 'banana'}
{'banana', 'apple'}
>>> {'banana', 'apple'}
{'apple', 'banana'} 
```

顺序受哈希冲突的影响，因此它不仅取决于集合的内容，还取决于插入的顺序。但是您无法真正控制订单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:36:11.827

我认为让您感到困惑的是元组的对称性质。将列表转换为集合并不会影响元组中项目的排列，而是影响元组的顺序。那是因为集合本质上是无序的。这是另一个不对称元组的例子。

```
>>> U = [(2.0, 0.0), (0.0, 1.0)]
>>> set(U)
{(0.0, 1.0), (2.0, 0.0)} 
```

# android - 可以在 UI Thread 上查询 DownloadManager 吗？

> ID：15800299
> 
> 赞同：7
> 
> 时间：2013-04-03T23:58:38.577
> 
> 标签：android, android-anr-dialog, android-download-manager

DownloadManager 有一个方法[query()](http://developer.android.com/reference/android/app/DownloadManager.html#query%28android.app.DownloadManager.Query%29)。我的问题是是否可以在 UI 线程上调用此方法，或者是否应该只从后台线程调用它？

调用它会导致 ANR 吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T00:19:46.967

如果查看方法的[来源](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/app/DownloadManager.java#L960)`query()`：

```
public Cursor query(Query query) {
  Cursor underlyingCursor = query.runQuery(mResolver, UNDERLYING_COLUMNS, mBaseUri);
  if (underlyingCursor == null) {
    return null;
  }
  return new CursorTranslator(underlyingCursor, mBaseUri);
} 
```

...这可以分解为在 UI 线程中访问游标是否安全的问题。请参阅 Mark Murphy 对此的[出色回答](https://stackoverflow.com/a/8319729/1140682)。提炼：

> 所以在后台线程中查询 DownloadManager。

# markdown - 停止 Jekyll 中 pre 标签之间的内容转换

> ID：15800301
> 
> 赞同：1
> 
> 时间：2013-04-03T23:58:52.203
> 
> 标签：markdown, jekyll, redcarpet

在 Jekyll 上运行一个小站点。*我一直遇到的一个问题是降价一直在修改pre*标签之间的内容。

两个显着的例子。

第一的：

```
<pre>a & b</pre> 
```

转换为

```
<pre>a &amp;</pre> 
```

第二个例子：

```
<pre>I am "happy"</pre> 
```

转换为

```
<pre>I am “happy”&lt;/pre> 
```

如果不是很清楚，后一个示例是将引号转换为智能引号。这对我不利，因为我的 pre 标签包含智能引号成为语法错误的代码示例。另外，我尝试在前置标签之间使用 &，希望转换器会插入一个 &。相反，它（叹气）将其保留为 &

有没有一种明显的方法可以告诉 Jekyll（或 Redcarpet）一段代码不应该通过降价转换器运行？

布拉德利

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T00:17:21.653

Redcarpet 2.2.2[不会修改 HTML 标记之间的代码](https://github.com/vmg/redcarpet#also-now-our-pants-are-much-smarter)。在[IRB](http://en.wikipedia.org/wiki/Interactive_Ruby_Shell)中试试这个：

```
require 'redcarpet'
markdown = Redcarpet::Markdown.new(Redcarpet::Render::HTML, :autolink => true, :space_after_headers => true, :fenced_code_blocks => true)
markdown.render("<pre>They're not for sale, says Johnson & Johnson.</pre>") 
```

这是我的结果：

```
"<pre>They're not for sale, says Johnson & Johnson.</pre>\n" 
```

# assembly - 暂停汇编程序

> ID：15800303
> 
> 赞同：-2
> 
> 时间：2013-04-03T23:59:03.873
> 
> 标签：assembly, interruption

有没有办法让汇编中的程序暂停 1 秒钟，然后让它恢复正常流程？我正在通过串口编程聊天，但由于某种原因，当我在其中一个程序上键入字符串时，另一个程序并不总是将它作为单个字符串接收；有时它将整个打印出来，但有时它只显示一个部分，并立即意识到还有更多字符串要接收并将其打印为第二个字符串。我想要做的是停止程序一秒钟左右，所以它可以确保它接收到整个字符串，而不仅仅是它的一部分。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T03:05:07.727

对于 80x86；如果操作系统类似于 MS-DOS 或“无”，那么您需要在执行 HLT（以节省电力）时循环轮询 BIOS 的“自午夜以来的滴答声”。要获得“自午夜以来的滴答声” ，请`int 0x1A`使用`ah=0x00`. 一秒大约是 18 个滴答声。翻转时要非常小心 - 如果您不小心并且在午夜之前执行“expiry_time = now + 1 seconds”，那么您可能会永远等待，您应该采取`if(expiry_time >= 0x001800B0) expiry_time -= 0x001800B0`措施防止这种情况发生。

如果操作系统是现代的（Windows、OS X、Linux、FreeBSD 等），那么您想告诉操作系统的调度程序运行其他任务 1 秒（以避免无缘无故地占用 CPU 时间）；你要么必须找到适当的（特定于操作系统的）API 来做到这一点，要么找到某种库来链接它为你做的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T08:45:01.490

我不是在回答问题本身，而是在回答：

从不（我的意思是**从不**！）为这样的目标使用时间延迟！这是非常、非常、非常糟糕的设计。串口通信是基于字符流的。正确设计的程序（无论使用何种语言）必须处理流而不需要任何时间延迟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:01:16.307

是的，

使用 GOTO 和 NOPS。

或创建一个包含 nop 的循环并在满足特定条件时将其转义。或者创建一个 GOTO 标签一堆 nop

```
startover
nop
nop
nop
nop
nop
nop
nop
nop
GOTO startover // this wil run forever! you need an escape condition 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T00:01:29.443

是的，您可以获取系统时钟，然后循环检查是否在获得时间后过了一秒...

如果您使用 x86 程序集，这可能会有所帮助：[https ://softwareengineering.stackexchange.com/questions/134084/assembly-instructions-execution-time](https://softwareengineering.stackexchange.com/questions/134084/assembly-instructions-execution-time)

或者你可以做一个很长的循环来暂停......第二个我不太推荐，但它可能适合你的需要

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-23T20:54:04.630

似乎问题来自缓冲。等待可能很好，但您必须回答“多少次？”这一主要问题。事实上，你并不知道。通常在 ASM 中，我们使用中断或等待“直到设置一个标志”。但只有“等待一定的秒数”似乎不是正确的选择（我 100% 同意 johnfound！）

建议：在发送端程序中，将数据缓存到 CR/LF 后再发送。在接收器上，等到 CR/LF 显示。还可以查看串行缓冲区指针（IN 和 OUT）以查看开始和结束指针的位置，这可能会提供一些解释正在发生的事情的信息。

# java - findViewById 使用 OnClickListener 接口的 OnClick 方法的参数返回 null

> ID：15800305
> 
> 赞同：2
> 
> 时间：2013-04-03T23:59:28.087
> 
> 标签：java, android

我的代码：

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
    Button btn = (Button) findViewById(R.id.btn_ok);

    btn.setOnClickListener(new Click());

} 
```

我的班级女巫实现了 OnClickListener

但是在“单击”类的方法单击上.. 参数 View v.. 不起作用。使用方法 findViewById.. 总是返回 null :(

有什么帮助吗？

```
 public class Click implements View.OnClickListener
{       
    @Override
    public void onClick(View v) {       
        TextView view = (TextView) v.findViewById(R.id.resultado);
        EditText textoEdit = (EditText) v.findViewById(R.id.campo_texto);

        String texto = textoEdit.getText().toString();
        view.setText("Obrigado " + texto);  
    }
} 
```

（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:03:54.273

该参数`View v`引用您的按钮。该按钮视图不包含带有`R.id.resultado`. 试试`v.getRootView()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:04:45.190

Button 没有任何子视图，因此当您调用`findViewById`. `View v`参数是产生触摸事件的视图。如果你想在你的布局中与`TextView`and对话，你应该在其中找到它们并将它们存储为类成员。`EditText``onCreate`

尝试：

```
TextView mTexto;
EditText mTextoEdit;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button btn = (Button) findViewById(R.id.btn_ok);
    btn.setOnClickListener(new Click());

    mTexto= (TextView) findViewById(R.id.resultado);
    mTextoEdit = (EditText) findViewById(R.id.campo_texto);
} 
```

在你的听众中：

```
public class Click implements View.OnClickListener
{       
    @Override
    public void onClick(View v) {       
        String texto = mTextoEdit.getText();
        mTexto.setText("Obrigado " + texto);  
    }
} 
```

# c# - 如何对@Html.DropDownListFor 进行排序？

> ID：15800308
> 
> 赞同：2
> 
> 时间：2013-04-03T23:59:53.473
> 
> 标签：c#, asp.net-mvc

我想对 MVC C# 中的下拉列表进行排序。这是我的下拉列表。所以我想按“全名”排序。

```
@Html.DropDownListFor(c => c.t_PEOPLE, 
                              new SelectList(Model.PEOPLE,
                                                 "KEY",
                                                 "FULLNAME", 
                                             Model.BOTKEY),
                                         new {onchange = "BusinessContact(this.value);" }) 
```

我该怎么做？？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T00:04:01.160

```
/* other code here.. */
new SelectList(Model.PEOPLE.OrderBy(x => x.FirstName),
                          // ^^^^^^^^^^^^^^^^^^^^^^^ this
/* rest of the code here */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:02:58.290

我不会在视图中这样做，但如果你*真的*想：

1.  使用 @using System.Linq 在视图中包含 System.Linq
2.  Model.PEOPLE.OrderBy(p => p.YourProperty)

# input - 多字用户输入与批量变量的比较

> ID：15800309
> 
> 赞同：0
> 
> 时间：2013-04-03T23:59:57.210
> 
> 标签：input, batch-file, comparison

我在将用户输入的多字字符串与批处理中的字符串变量进行比较时遇到了一些麻烦。这就是我所拥有的：

```
 set twowordstring=Pi Rocks
    echo What do you think about Pi?    
    set /p response=
    if %response% EQU %twowordstring% goto correct 
```

运行时 cmd 刚刚关闭，但我瞥见了错误消息。我认为 set /p 只收集两个词输入的第二个词。请帮忙，我设置输入错误还是有不同的命令来收集整行？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:43:02.180

您的`IF`陈述导致了问题。

语法是`if string equ string dosomething`

由于您的响应和要进行比较的字符串中都有空格，因此处理器会看到

```
if Pi Rocks equ Pi Rocks goto correct 
```

`equ`并期望在第一个字符串之后有一个比较运算符，因此对象`Rocks`并响应`Rocks was unexpected at this time`

要更正，只需将参数括在引号中

```
if "%response%" equ "%twowordsstring%" goto correct 
```

您也可以更改`if`为`if /i`使比较不区分大小写。

此外，放置一个

```
pause 
```

在一个战略点将阻止窗口关闭。

# python - Python os.walk，保存状态的方法？

> ID：15800310
> 
> 赞同：4
> 
> 时间：2013-04-03T23:59:57.930
> 
> 标签：python, python-2.7

我需要遍历文件服务器上的所有文件，并且我希望能够在文件树中的任何位置停止该过程并在以后恢复它。这可以用 os.walk 完成，还是需要从头开始实现？

编辑：理想情况下，我希望解决方案是持久的，因此脚本可以停止并稍后恢复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T00:23:23.433

`os.walk`是一个完全正常的生成器函数，这意味着您可以调用它，保存生成的生成器，然后在闲暇时对其进行迭代。例如：

```
w = os.walk(root)

for root, dirs, files in w:
   if root == 'foo':
       break
   else:
       # usual stuff

print('Hey, we found foo')

for root, dirs, files in w:
    # usual stuff 
```

你甚至`w`可以返回一个函数，或者从一个函数中返回它，或者将它用作你最喜欢的`itertools`函数的迭代器，等等。

* * *

*你不能*用它做的一件大事就是腌制它。所以，如果你想把它持久化到磁盘（或数据库），这样你就可以退出程序并从你离开的地方继续，或者将它发送到一个子进程来完成，或者其他什么，你不能这样做.

如果您有能力提前完成整个步行而不是懒惰地进行（即，您不需要动态修剪步行，并且步行本身的时间和存储与所需的时间和存储相形见绌你真正的工作），你可以坚持下去`list(w)`。然后，您只需要跟踪该列表以及您到目前为止所获得的索引（或者只是坚持`wlist[index:]`而不是`wlist`and `index`）。但对于某些用例，这是不可接受的。

幸运的是，`walk`它是用纯 Python 实现的，而且非常简单，因此您可以从[源](http://hg.python.org/cpython/file/3.3/Lib/os.py#l337)代码中复制代码并对其进行修改以使状态可持久化。问题是状态是部分隐含的，通过 的魔法`yield`，所以您必须将生成器从里到外翻转，或者将其转换为等效的纯迭代解决方案。这是一个开始：

```
class Walk(object):
    def __init__(self, top):
        self.queue = [top]
    def __iter__(self):
        return self
    def __next__(self):
        top = self.queue.pop(0)
        names = os.listdir(top)
        dirs, nondirs = [], []
        for name in names:
            if os.path.isdir(os.path.join(top, name)):
                dirs.append(name)
            else:
                nondirs.append(name)
        self.queue.extend(os.path.join(top, dir) for dir in dirs)
        return top, dirs, nondirs 
```

这不处理任何可选参数。`followlinks=False`并且`onerror`是微不足道的。处理动态剪枝`topdown=True`并不复杂（只需存储`top`和`dirs`，并在下一次调用开始时将子代入队，而不是在本次调用结束时）。这样做`topdown=False`会有点痛苦，但仍然不算*太*糟糕（您可以为标准的递归到迭代转换创建一个显式的状态堆栈，或者保留一个额外的双端队列，或者只是创建、存储和迭代一个列表新`Walk`对象）。如果您不需要它们，请不要费心添加它们。

我相信这`pickle`不会改变。（如果不是，它要么是微不足道的，要么是微不足道`__getstate__`的`__reduce__`。）如果你使用不同的持久性机制，真的，你需要坚持的是这是一个`Walk`对象，它`queue`是`self.queue`（这只是一个列表字符串），所以这应该很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-04T12:34:40.593

最后，为了解决同样的问题，我删除了 python 的 os.walk 的内部结构，并在处理目录之前和之后放置了一些包装器。

包装器与 sqlite 数据库对话，并回忆他们已经看到的目录。这使得它可以尽可能积极地修剪树以完成已经完成的工作。

注意：对于我的用例，重新处理给定目录中的文件不是问题，如果您需要严格重新输入 os.walk 准确地从您离开的地方，那么您也需要跟踪文件 - 不要不要忘记，一旦你完成了一个目录，你可以清除文件信息以节省数据库大小。

```
import os
import sys
import sqlite3
class WalkPersister():
    def __init__(self, db_filename, onerror=None, followlinks=False):
        self._db_filename = db_filename
        self._onerror = onerror
        self._followlinks = followlinks

    def __enter__(self):
        self._con = sqlite3.connect(self._db_filename)
        self._con.execute('''
        CREATE TABLE IF NOT EXISTS walk_persistence (
            path text PRIMARY KEY,
            files int,
            total_sub_files int
        )
        ''')
        return self

    def __exit__(self, exception_type, exception_value, traceback):
        self._con.commit()

    def walk(self, top, onerror=None, followlinks=False):
        # Almost entirely from https://github.com/python/cpython/blob/3.9/Lib/os.py#L344
        if not self._pre_visit(top):
            return

        dirs = []
        nondirs = []
        walk_dirs = []

        try:
            scandir_it = os.scandir(top)
        except OSError as error:
            if onerror is not None:
                onerror(error)
            return

        with scandir_it:
            while True:
                try:
                    try:
                        entry = next(scandir_it)
                    except StopIteration:
                        break
                except OSError as error:
                    if onerror is not None:
                        onerror(error)
                    return

                try:
                    is_dir = entry.is_dir()
                except OSError:
                    # If is_dir() raises an OSError, consider that the entry is not
                    # a directory, same behaviour than os.path.isdir().
                    is_dir = False

                if is_dir:
                    dirs.append(entry.name)
                else:
                    nondirs.append(entry.name)

        yield top, dirs, nondirs

        # Recurse into sub-directories
        islink, join = os.path.islink, os.path.join
        for dirname in dirs:
            new_path = join(top, dirname)
            if followlinks or not islink(new_path):
                yield from self.walk(new_path, onerror, followlinks)

        self._post_visit(top, dirs, nondirs)

    def _pre_visit(self, path):
        cursor = self._con.execute('''
        SELECT
            path
        FROM
            walk_persistence
        WHERE
            path = ?
        ''', (path, ))
        return cursor.fetchone() is None

    def _post_visit(self, path, dirs, nondirs):
        cursor = self._con.execute('''
        SELECT
            files
        FROM
            walk_persistence
        WHERE
            path LIKE ? || '%'
        ''', (path, ))
        sub_files = sum((i[0] for i in cursor.fetchall())) + len(nondirs)
        self._con.execute('''
        INSERT OR REPLACE INTO 
            walk_persistence
        VALUES (
            ?, ?, ?
        )
        ''', (path, len(nondirs), sub_files)) 
```

用法：

```
import pathlib
import random
with WalkPersister('/home/appuser/walk.db') as walker:
    for src_dname, sdirs, files in walker.walk('/data/'):
        src_dname = pathlib.Path(src_dname)
        for file in files:
            filepath = src_dname/file
            print(filepath)
            if random.randint(0, 5000) == 13: raise ValueError('Demo Exception') 
```

# sorting - 逐步合并排序

> ID：15800312
> 
> 赞同：-3
> 
> 时间：2013-04-04T00:00:00.850
> 
> 标签：sorting, mergesort

逐步迭代的合并排序看起来如何？我试图掌握合并排序中发生的事情。前任。在归并排序中，诸如 25、64、22、46、20、65、90、66、48、98 之类的值列表将如何逐步查看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:06:04.697

看看从维基百科找到的这张图片。数字是不同的，但它是每个递归调用中数据的一个很好的例子。[http://en.wikipedia.org/wiki/File:Merge_sort_algorithm_diagram.svg](http://en.wikipedia.org/wiki/File:Merge_sort_algorithm_diagram.svg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:03:58.527

[您可以在Wikipedia](http://en.wikipedia.org/wiki/Mergesort)上找到 MergeSort（和其他）的一些精美图片。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T00:04:20.440

自底向上归并排序：

```
25, 64, 22, 46, 20, 65, 90, 66, 48, 98   -> merge groups-of-1 ->
25, 64, 22, 46, 20, 65, 66, 90, 48, 98   -> merge groups-of-2 ->
22, 25, 46, 64, 20, 65, 66, 90, 48, 98   -> merge groups-of-4 ->
20, 22, 25, 46, 64, 65, 66, 90, 48, 98   -> merge groups-of-8 ->
20, 22, 25, 46, 48, 64, 65, 66, 90, 98   result 
```

# twitter-bootstrap - Bootstrap Carousel 标题在变大时消失

> ID：15800315
> 
> 赞同：0
> 
> 时间：2013-04-04T00:00:21.990
> 
> 标签：twitter-bootstrap

好的，所以我正在使用引导程序创建一个网页，我试图让轮播通过一些图像滑动，并且我已经从模板中复制了大部分内容。我的问题是当浏览器的宽度变大时，字幕似乎消失了。

我从这个例子[http://twitter.github.com/bootstrap/examples/carousel.html复制了代码和 css](http://twitter.github.com/bootstrap/examples/carousel.html)

```
<div id="myCarousel" class="carousel slide">
  <div class="carousel-inner">
    <div class="item active">
      <img src="assets/img/wood.jpg" alt="">
      <div class="container">
        <div class="carousel-caption">
          <h1>Web Design</h1>
          <p class="lead">A snappy website will attract new people!</p>
          <a class="btn btn-large btn-primary" href="#">Sign up today</a>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="assets/img/wood.jpg" alt="">
      <div class="container">
        <div class="carousel-caption">
          <h1>App Design</h1>
          <p class="lead">CA App will let you reach out to your followers!</p>
          <a class="btn btn-large btn-primary" href="#">Learn more</a>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="assets/img/wood.jpg" alt="">
      <div class="container">
        <div class="carousel-caption">
          <h1>Database Design</h1>
          <p class="lead">Databases are key to a companies success now adays!</p>
          <a class="btn btn-large btn-primary" href="#">Browse gallery</a>
        </div>
      </div>
    </div>
  </div>
  <a class="left carousel-control" href="#myCarousel" data-slide="prev">&lsaquo;</a>
  <a class="right carousel-control" href="#myCarousel" data-slide="next">&rsaquo;</a>
</div><!-- /.carousel --> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T08:39:13.653

我认为您也需要包含 Bootstrap 响应式 css 文件。

它应该在常规 bootstrap.css 文件之后添加，例如

```
<link href="assets/css/bootstrap.css" rel="stylesheet">
<link href="assets/css/bootstrap-responsive.css" rel="stylesheet"> 
```

# php - 如何使用文件大小限制调整图片大小

> ID：15800316
> 
> 赞同：0
> 
> 时间：2013-04-04T00:01:11.627
> 
> 标签：php, resize

我正在使用这个类[verot上传类](http://www.verot.net/php_class_upload_docs.htm?PHPSESSID=0c063fd3e994c1b7b14061843ac1525e "上传类")

我想在调整大小后将图像大小调整为最大 50kb。我的想法是使用一段时间循环并在圆圈内进行调整大小，将其保存在磁盘上并使用 php 函数检查新图片的大小。如果它大于 50 公斤，则用较小的调整值再做一个圆圈。

你认为有更好的解决方案吗？感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T16:21:26.850

类的创建者在这里。该类已经具有此功能，请参阅`jpeg_size`参数。例如：

```
$handle->jpeg_size = 50000; 
```

# java - appengine 是否对“超过最大分配的 ID”有新的限制？

> ID：15800319
> 
> 赞同：0
> 
> 时间：2013-04-04T00:01:21.677
> 
> 标签：java, google-app-engine, google-cloud-datastore

我的应用程序运行良好几个月。今天，它开始在数据存储放置时出现“超过最大分配的 ID”错误。这是 appengine 配额和限制的新东西吗？

[http://gochild2009.appspot.com](http://gochild2009.appspot.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:10:03.880

虽然我们不确定您最终是如何获得如此大的 ID，但我们正在采取措施来适应它们。

您可以在[https://code.google.com/p/googleappengine/issues/detail?id=9118](https://code.google.com/p/googleappengine/issues/detail?id=9118)上进行跟踪。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T02:41:18.567

我们的应用程序也有同样的问题。

没有这样的限制（配额）。似乎在某些时候为某些实体生成的 ID 很高，并且引发了此异常。

作为解决方案/解决方法，您可以生成自己的 ID。

# javascript - :hover 会产生错误。我怎样才能解决这个问题？

> ID：15800328
> 
> 赞同：6
> 
> 时间：2013-04-04T00:02:13.237
> 
> 标签：javascript, jquery, jquery-hover

我注意到我在我的网站上的控制台中收到以下错误。

> 错误：语法错误，无法识别的表达式：不支持的伪：hover @ /wp-includes/js/jquery/jquery.js?ver=1.8.3:2

我发现错误是由于我的一个 js 文件中的这一行引起的：

`if(qactive == 0 && !($('#slider').is(":hover"))) {`

我可以用什么替代方式编写此行以使错误消失？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T00:32:12.323

您只需要将元素绑定到几个事件。

```
$("#slider").hover(
    function(){
        $(this).addClass('is-hover'); // you can use every class name you want of course
    },
    function(){
        $(this).removeClass('is-hover');
    }
); 
```

或者，以更简洁的方式

```
$("#slider").hover(
    function(){
        $(this).toggleClass('is-hover'); // you can use every class name you want of course
    }
); 
```

这样，每次`mouseenter`触发事件时，您都会向元素添加一个`is-hover`类，并且在`mouseleave`触发事件时，您将删除该类。

在您的**if 语句中**，您只需更改：

```
if ( qactive == 0 && !($("#slider").hasClass('is-hover')) ) { 
```

就是这样。

请注意，当然，您必须使这个示例适应您的代码。在这里，我只是假设您*可能*需要什么，因为我看不到您的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:18:39.043

jQuery 1.8 中似乎不推荐使用“：悬停”选择器[http://bugs.jquery.com/ticket/11731](http://bugs.jquery.com/ticket/11731)另请参阅[jQuery 1.8：不支持的伪：悬停](https://stackoverflow.com/questions/11998514/jquery-1-8-unsupported-pseudo-hover)

您可能必须自己添加一个新的事件处理程序才能识别此状态：

```
$('.selector').on( 'mouseenter mouseleave', function() {
      $(this).toggleClass('hover');
   }
);

if(!$(this).parent().find('ul').first().hasClass('hover')) {
   $(this).parent().parent().removeClass('open');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:10:52.377

看看悬停鼠标事件。您可以将 !($('#slider').is(":hover")) 的检查替换为您通过悬停在 $('#slider') 上设置和取消设置的直接布尔标志\变量

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

如果你想要一个这样的例子，你需要提供更多的代码，也许还有一个 jsfiddle。

一个非常基本的例子可能是这样的：

```
var sliderHover= false;

$('#slider').hover(
    function () {
        sliderHover = true;
    },
    function () {
        sliderHover = false;
    }
});

// ...........MORE CODE ................

// Then later just check - watch your scoping though
if(qactive == 0 && !sliderHover) 
```

# c++ - 使用 FBO 绘制到渲染缓冲区

> ID：15800329
> 
> 赞同：1
> 
> 时间：2013-04-04T00:02:15.970
> 
> 标签：c++, opengl

我的问题非常接近这个问题：[FBO 和 Render to renderbuffer](https://stackoverflow.com/questions/4213023/fbo-and-render-to-renderbuffer)。我目前正在尝试在本[教程](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide/opengl_offscreen/opengl_offscreen.html)中的渲染缓冲区上渲染一个简单的三角形。我的程序是 Igor Pro 的一个插件，它使用 OpenGL 执行屏幕外渲染。

不幸的是，当我尝试读取像素值时，我得到的只是零。我已经知道该`initBuffers`功能有效，问题出在`display`功能上。

1）我的代码有什么问题？

2) 我想在不使用立即模式的情况下呈现顶点数据列表。我之前已经用 VBO 完成了一个实现。我可以重复使用该代码吗？

我的代码如下：

```
/*  
RenderTriangle.cpp
*/

#include "VC10\triangulation.h"
#include "XOPStandardHeaders.h"         // Include ANSI headers, Mac headers, IgorXOP.h, XOP.h and XOPSupport.h
#include <vector>

// Prototypes
HOST_IMPORT int main(IORecHandle ioRecHandle);

// Global Variables
const int windowSize = 512;

int size,el_size;
float* waveX=NULL;
float* waveY=NULL;
float* waveZ=NULL;
GLuint framebuffer, renderbuffer;

// Custom error codes
#define OLD_IGOR 1 + FIRST_XOP_ERR
#define NON_EXISTENT_WAVE 2 + FIRST_XOP_ERR
#define REQUIRES_SP_OR_DP_WAVE 3 + FIRST_XOP_ERR

#pragma pack(2)     // All structures passed to Igor are two-byte aligned.
typedef struct WaveParams {
  waveHndl waveZ;
  waveHndl waveY;
  waveHndl waveX;   
  double result;
} WaveParams, *WaveParamsPtr;
#pragma pack()      // Restore default structure alignment

// Prototypes of the OpenGL callbacks
void initBuffers(void);
void display(void);
void readPixels(void);

void initBuffers(void){

  GLenum status;

  //Generate the fbo where we will bind a render buffer object
  glGenFramebuffers(1,&framebuffer);
  glBindFramebuffer(GL_DRAW_FRAMEBUFFER,framebuffer);

  //Generate render buffer object
  glGenRenderbuffers(1,&renderbuffer);
  glBindRenderbuffer(GL_RENDERBUFFER,renderbuffer);

  glRenderbufferStorage(GL_RENDERBUFFER,GL_RGBA8, windowSize, windowSize);

  glFramebufferRenderbuffer(GL_DRAW_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, renderbuffer);

  status = glCheckFramebufferStatus(GL_FRAMEBUFFER);

  if (status != GL_FRAMEBUFFER_COMPLETE)
    XOPNotice("Error Framebuffer Complete");
  else
    XOPNotice("Framebuffer Complete");
}

void display(void){//display a simple triangle

  glViewport(0,0,windowSize,windowSize);
  glBindFramebuffer(GL_FRAMEBUFFER, framebuffer);
  glClearColor(1.0f, 0.0f, 0.0f,0.5f);
  glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
  glLoadIdentity();

  glBegin(GL_TRIANGLES);// Drawing Using Triangles
    glColor3f(1.0f, 0.0f, 0.0f);glVertex3f( 0.0f, 1.0f, 0.0f);// Top
    glColor3f(1.0f, 0.0f, 0.0f);glVertex3f(-1.0f,-1.0f, 0.0f);// Bottom Left
    glColor3f(1.0f, 0.0f, 0.0f);glVertex3f( 1.0f,-1.0f, 0.0f);// Bottom Right
  glEnd();// Finished Drawing The Triangle

  glFlush();

}

// Idle callback function for OpenGL API
void readPixels(void){

  //glBindFramebuffer(GL_FRAMEBUFFER, 0);

  float* pixels = (float*)malloc(windowSize*windowSize*sizeof(float));
  glReadBuffer(GL_COLOR_ATTACHMENT0);
  glReadPixels(0, 0, windowSize, windowSize, GL_DEPTH_COMPONENT, GL_FLOAT, pixels);

  waveHndl waveH;
  char waveName[MAX_OBJ_NAME+1];
  DataFolderHandle dfH;
  CountInt dimensionSizes[MAX_DIMENSIONS+1];
  float* wp;
  IndexInt p;
  double offset, delta;
  int err;
  strcpy(waveName, "wave1");
  dfH = NULL; // Put wave in the current data folder
  MemClear(dimensionSizes, sizeof(dimensionSizes));

  dimensionSizes[ROWS] = windowSize; // Make 1D wave with 100 points
  dimensionSizes[COLUMNS] = windowSize;

  if (MDMakeWave(&waveH, waveName, dfH, dimensionSizes, NT_FP32, 1))
    XOPNotice("Can't create wave when reading pixel values");

  wp = (float*)WaveData(waveH); // Get a pointer to the wave data

  for(p = 0; p < windowSize*windowSize; p++)
  *wp++ = pixels[p]; // Store point number in wave

}
void deleteBuffers(){
  glDeleteFramebuffers(1,&framebuffer);
  glDeleteRenderbuffers(1,&renderbuffer);
}
// Main function for the XOP
extern "C" int
  RenderTriangle(WaveParamsPtr p)
{
  //Pointers to the input waves
  waveX=(float*)WaveData(p->waveX);
  waveY=(float*)WaveData(p->waveY);
  waveZ=(float*)WaveData(p->waveZ);

  //Creates the window
  char *myargv [1];
  int myargc=1, windowHandle;
  myargv [0]=strdup ("RenderTriangle");

  glutInit(&myargc,myargv);
  glutInitDisplayMode(GLUT_SINGLE | GLUT_DEPTH | GLUT_RGB);
  glutInitWindowSize(windowSize,windowSize);
  windowHandle = glutCreateWindow("OpenGL");

  //Init glew library 
  glewInit(); 

  //Creates the fbo and render buffer object
  initBuffers(); 

  display();

  readPixels();

  //Deletes the fbo and render buffer object
  deleteBuffers();

  p->result = 1;

  return 0;
}

static XOPIORecResult
  RegisterFunction()
{
  int funcIndex;

  funcIndex = (int)GetXOPItem(0);           // Which function invoked ?
  switch (funcIndex) {
  case 0:                                   // y = RenderTriangle(w,x) (curve fitting function).
    return (XOPIORecResult)RenderTriangle;  // This function is called using the direct method.
    break;
  }
  return 0;
}

/*  XOPEntry()

This is the entry point from the host application to the XOP for all
messages after the INIT message.
*/
extern "C" void
  XOPEntry(void)
{   
  XOPIORecResult result = 0;

  switch (GetXOPMessage()) {
  case FUNCADDRS:
    result = RegisterFunction();    // This tells Igor the address of our function.
    break;
  }
  SetXOPResult(result);
}

/*  main(ioRecHandle)

This is the initial entry point at which the host application calls XOP.
The message sent by the host must be INIT.
main() does any necessary initialization and then sets the XOPEntry field of the
ioRecHandle to the address to be called for future messages.
*/
HOST_IMPORT int
  main(IORecHandle ioRecHandle)
{   
  XOPInit(ioRecHandle);                         // Do standard XOP initialization.
  SetXOPEntry(XOPEntry);                            // Set entry point for future calls.

  if (igorVersion < 600) {
    SetXOPResult(OLD_IGOR);
    return EXIT_FAILURE;
  }

  SetXOPResult(0);
  return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T06:19:39.167

我建议另一个教程： http: [//www.songho.ca/opengl/gl_fbo.html](http://www.songho.ca/opengl/gl_fbo.html)

但关于您的代码：

直接渲染**到纹理**会更简单。这样就没有理由使用 glReadPixels。整个操作将更快更容易实施。

`glFramebufferTexture2D`创建空纹理并通过渲染将其添加到 FBO，然后在纹理中获得结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T11:16:55.320

您需要一个工作的 OpenGL 上下文才能使其余部分正常工作，而您无需创建一个！您将 GLUT 用作框架，但 GLUT 仅在`glutCreateWindow`被调用时才会创建渲染上下文。在此之前，您根本没有活动的 RC，其余的将无法正常工作。

也许 Igor 本身在某个时候创建​​了一个 OpenGL 上下文，而你正在把它扔进那个上下文中。

而不是使用 GLUT，您应该使用系统级 API 来

1.  存储当前上下文状态（如果上下文在当前线程中处于活动状态，如果是，则上下文句柄）

2.  如果尚未完成：为您的插件创建一个屏幕外渲染上下文（使用 PBuffer 或不可见窗口与 FBO 一起使用）

3.  使用您自己的上下文进行渲染

4.  恢复保存在 1 中的上下文状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-01T23:25:01.060

同样，这是一个使用渲染缓冲区的示例。

[如何在 OpenGL 上渲染屏幕外？](https://stackoverflow.com/questions/12157646/how-to-render-offscreen-on-opengl)

1）创建上下文 2）创建 FBO（颜色、深度、模板的存储）和绑定 3）绘制 4）回读（根据 2））

我不确定说整个操作会更快更容易使用纹理实现是否正确。这一切都取决于我们想要做什么（glReadPixels 是同步的）。

# objective-c - 目标 C：使用 SHA512 发出 POST 请求

> ID：15800330
> 
> 赞同：1
> 
> 时间：2013-04-04T00:02:17.287
> 
> 标签：objective-c, post, sha512

我需要访问[https://btc-e.com/api/documentation](https://btc-e.com/api/documentation)上的 API 。我现在已经用谷歌搜索并尝试了很多东西 3 天，我完全失去了可以访问该 API 的希望。

它需要使用 SHA512 加密并使用密钥签名的 POST 请求。

所以，我尝试在 Objective C 中实现它。

我有问题的功能

```
NSString *hmacForKeyAndData(NSString *key, NSString *data)
{
const char *cKey  = [key cStringUsingEncoding:NSASCIIStringEncoding];
const char *cData = [data cStringUsingEncoding:NSASCIIStringEncoding];
unsigned char cHMAC[CC_SHA512_DIGEST_LENGTH];
CCHmac(kCCHmacAlgSHA512, cKey, strlen(cKey), cData, strlen(cData), cHMAC);
NSData *enryptedData= [[NSData alloc] initWithBytes:cHMAC length:sizeof(cHMAC)];
// encryptedData seems to be in right form
// <ef56b041 12345678 12345678 12345678 a6128b61 12345678 f409507e 12345678 54a91f40 52f491e0 12345678 18942391 12345678 b2749b14 12345678 12345678>
NSString *result;

// HERE: I need to somehow convert NSData to NSString

return result;
} 
```

我只是无法正确加密此消息以及如何将其转换为字符串，然后我可以将其作为 POST 参数发送:(

你能帮我处理带有密钥签名的SHA512吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:19:10.987

API 没有提到他们希望对签名进行 base64 编码。这个网站提供了一个很好的例子来说明如何做到这一点[http://aerson.net/base64-encode-and-decode-nsstring-cocoa](http://agerson.net/base64-encode-and-decode-nsstring-cocoa)。

我认为您还将加密与签名混淆了。API 似乎没有要求您加密数据。它要求您签署您的数据。您拥有的`enryptedData`变量是签名，不需要加密。只需对其进行base64编码并将其分配给`Sign`标题即可。

# ms-access-2007 - 连接两个表时记录太多

> ID：15800331
> 
> 赞同：0
> 
> 时间：2013-04-04T00:02:31.110
> 
> 标签：ms-access-2007

我有以下两张表

```
Table 1
=======

T1Col1  T1Col2  T1Col3

jkl     nnn     qoq
efg     Aaa     wow
efg     xxx     yoy
abc     iii     qoq
abc     fff     wow
abc     rrr     qoq
gdg     ppp     yoy

Table 2
=======

T2Col1  T2Col2  

qoq     nnn     
wow     aaa 
yoy     xxx 
```

两个表之间的链接列是 T1.T1Col3 和 T2.T2Col1

```
Expected Results
================

T1Col1  T1Col2  T1Col3  T2Col2

jkl     nnn     qoq      nnn
efg     Aaa     wow      aaa 
efg     xxx     yoy      xxx 
abc     iii     qoq      nnn
abc     fff     wow      aaa 
abc     rrr     qoq      nnn
gdg     ppp     yoy      xxx 
```

通过连接查询，我得到了多条记录。但我只在上面没有记录。因为在我的真实场景中，表 1 有超过一百万条记录。所以最终结果集记录数量巨大，超过了 MS ACCESS 限制

这可能吗

干杯

沙巴

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T07:07:03.857

您是否在表之间创建了关系..？直到您不创建关系，它才会给出一个称为笛卡尔积的结果..!!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:48:10.903

我会尝试在查询生成器中使用 count 函数。在选择分组依据的部分中，尝试下拉框并选择计数。

# android - java.lang.RuntimeException：无法在未调用 Looper.prepare() 的线程内创建处理程序

> ID：15800335
> 
> 赞同：1
> 
> 时间：2013-04-04T00:03:01.137
> 
> 标签：android, multithreading, service, handler

我有问题，我不知道如何解决它。我想要创建将传感器更改发送到客户端（线程）的服务。

我有线程在我启动服务的地方，客户端线程接收答案并通过蓝牙发送它们。问题是我无法处理服务。

```
public class SensorMsgService extends Service implements SensorEventListener{

public static final int MSG_SAY_HELLO = 1;
public static final int MSG_REGISTER_CLIENT = 1;
public static final int MSG_UNREGISTER_CLIENT = 2;
public static final int MSG_SET_VALUE = 3;

static final String TAG = "Sensor Msg Service";

ArrayList<Messenger> mClients = new ArrayList<Messenger>();

private SensorManager mSensorManager;
private Sensor mSensor;

private ArrayList<Float> temp;

private Looper mServiceLooper;

public class IncomingHandler extends Handler{

    public IncomingHandler(Looper looper) {
          super(looper);
      }

    @Override
    public void handleMessage(Message msg) {
            switch (msg.what) {
            case MSG_REGISTER_CLIENT:
                    mClients.add(msg.replyTo);
                    break;
            case MSG_UNREGISTER_CLIENT:
                    mClients.remove(msg.replyTo);
                    break;
            case MSG_SET_VALUE:
                    //mValue = msg.arg1;
                    for (int i = mClients.size() - 1; i >= 0; i--) {
                            try {
                                    /*mClients.get(i).send(
                                                    Message.obtain(null, MSG_SET_VALUE, 1, 0));*/
                                    Log.d(TAG, "Message from client");  
                            } 
                            //catch (RemoteException e) {
                            catch (Exception e) {
                                    // The client is dead. Remove it from the list;
                                    // we are going through the list from back to front
                                    // so this is safe to do inside the loop.
                                    mClients.remove(i);
                            }
                    }
                    break;
            default:
                    super.handleMessage(msg);
            }
    }

    //Toast.makeText(getApplicationContext(), "Hello service test", Toast.LENGTH_SHORT).show();
}

final Messenger mMessenger = new Messenger(new IncomingHandler(mServiceLooper));

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    Log.d(TAG, "binding");

    //return null;
    return mMessenger.getBinder();
}

@Override
public boolean bindService(Intent service, ServiceConnection conn, int flags) {
    // TODO Auto-generated method stub
    super.bindService(service, conn, flags);
 //     mServiceLooper.prepare();
    temp = new ArrayList<Float>();

    mSensorManager = (SensorManager) getSystemService(SENSOR_SERVICE);
    mSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mSensorManager.registerListener(this, mSensor, SensorManager.SENSOR_DELAY_NORMAL);

    return true;
}

@Override
public void unbindService(ServiceConnection conn) {
    // TODO Auto-generated method stub
    super.unbindService(conn);
    mSensorManager.unregisterListener(this);
}

@Override
public void onAccuracyChanged(Sensor sensor, int accuracy) {
    // TODO Auto-generated method stub

}

@Override
public void onSensorChanged(SensorEvent event) {
    // TODO Auto-generated method stub

    temp.add(event.values[0]);
    temp.add(event.values[1]);
    temp.add(event.values[2]);

    for (int i = mClients.size() - 1; i >= 0; i--) {
        try {

                mClients.get(i).send(
                                Message.obtain(null, MSG_SET_VALUE, temp));
                Log.d(TAG, "Message service to client sending");    
        } 
        //catch (RemoteException e) {
        catch (Exception e) {
                // The client is dead. Remove it from the list;
                // we are going through the list from back to front
                // so this is safe to do inside the loop.
                mClients.remove(i);
        }
}

}

} 
```

正如我从线程中所说的那样，我已经启动了这项服务：

```
 public class ConnectedThread extends Thread {

private final BluetoothSocket mmSocket;
private final InputStream mmInStream;
private final OutputStream mmOutStream;
private Context mContext;

/** Messenger for communicating with service. */
Messenger mService = null;
/** Flag indicating whether we have called bind on the service. */
boolean mIsBound;
ArrayList<Float> temp;

private Looper mServiceLooper;

public ConnectedThread(BluetoothSocket socket, Context ctxx) {
    Log.d("ConnectedThread", "constructor ConnectedThread");
    mContext = ctxx;
    mmSocket = socket;
    InputStream tmpIn = null;
    OutputStream tmpOut = null;

    temp = new ArrayList<Float>();

    // Get the BluetoothSocket input and output streams
    try {
        tmpIn = socket.getInputStream();
        tmpOut = socket.getOutputStream();
    } catch (IOException e) {
        Log.e("ConnectedThread", "it was trying create input and output sockets", e);
    }

    mmInStream = tmpIn;
    mmOutStream = tmpOut;
}

public void run() {
    Log.i("ConnectedThread", "run mConnectedThread");
    byte[] buffer = new byte[1024];

    /*int i = 0;
    while(true)
    {
        Log.i("ConnectedThread", "sending int test value");
        write(i++);
    }*/

    doBindService();
}

/**
 * Write to the connected OutStream.
 * @param buffer  The bytes to write
 */
public void write(byte[] buffer) {
    try {
        mmOutStream.write(buffer);

    } catch (IOException e) {
        Log.e("ConnectedThread", "Exception during write", e);
    }
}

public void write(int out) {
    try {
        mmOutStream.write(out);

    } catch (IOException e) {
        Log.e("ConnectedThread", "Exception during write", e);
    }
}

public void cancel() {
    try {
        //mmOutStream.write(EXIT_CMD);
        mmSocket.close();
    } catch (IOException e) {
        Log.e("ConnectedThread", "close() of connect socket failed", e);
    }
}

///------------------------------

/**
 * Handler of incoming messages from service.
 */
class IncomingHandler extends Handler {

        @Override
        public void handleMessage(Message msg) {
                switch (msg.what) {
                case SensorMsgService.MSG_SET_VALUE:
                        temp = (ArrayList<Float>) msg.obj;
                        //mCallbackText.setText("Received from service: " + msg.arg1);
                        Log.d("Handle message from service", temp.get(0) + " " + temp.get(1) + " " + temp.get(2) + "\n");
                        break;
                default:
                        super.handleMessage(msg);
                }
        }
}

/**
 * Class for interacting with the main interface of the service.
 */
private ServiceConnection mConnection = new ServiceConnection() {
        public void onServiceConnected(ComponentName className, IBinder service) {
                // This is called when the connection with the service has been
                // established, giving us the service object we can use to
                // interact with the service. We are communicating with our
                // service through an IDL interface, so get a client-side
                // representation of that from the raw service object.
                mService = new Messenger(service);
                //mCallbackText.setText("Attached.");

                // We want to monitor the service for as long as we are
                // connected to it.
                try {
                        Message msg = Message.obtain(null,
                                        SensorMsgService.MSG_REGISTER_CLIENT);
                        msg.replyTo = mMessenger;
                        mService.send(msg);

                        // Give it some value as an example.
                        msg = Message.obtain(null, SensorMsgService.MSG_SET_VALUE, this
                                        .hashCode(), 0);
                        mService.send(msg);
                } catch (RemoteException e) {
                        // In this case the service has crashed before we could even
                        // do anything with it; we can count on soon being
                        // disconnected (and then reconnected if it can be restarted)
                        // so there is no need to do anything here.
                }

                // As part of the sample, tell the user what happened.
                Toast.makeText(mContext, "Service connected",
                                Toast.LENGTH_SHORT).show();
        }

        public void onServiceDisconnected(ComponentName className) {
                // This is called when the connection with the service has been
                // unexpectedly disconnected -- that is, its process crashed.
                mService = null;
                //mCallbackText.setText("Disconnected.");

                // As part of the sample, tell the user what happened.
                Toast.makeText(mContext, "Service disconnedcted",
                                Toast.LENGTH_SHORT).show();
        }
};

/**
 * Target we publish for clients to send messages to IncomingHandler.
 */
final Messenger mMessenger = new Messenger(new IncomingHandler());

// do Bind

void doBindService() {
    // Establish a connection with the service. We use an explicit
    // class name because there is no reason to be able to let other
    // applications replace our component.

    mContext.bindService(new Intent(mContext, SensorMsgService.class),
                    mConnection, Context.BIND_AUTO_CREATE);
    mIsBound = true;
    Log.d("ConnectedThread", "doBindService");
}

void doUnbindService() {
    if (mIsBound) {
            // If we have received the service, and hence registered with
            // it, then now is the time to unregister.
            if (mService != null) {
                    try {
                            Message msg = Message.obtain(null,
                                            SensorMsgService.MSG_UNREGISTER_CLIENT);
                            msg.replyTo = mMessenger;
                            mService.send(msg);
                    } catch (RemoteException e) {
                            // There is nothing special we need to do if the service
                            // has crashed.
                    }
            }

            // Detach our existing connection.
            mContext.unbindService(mConnection);
            mIsBound = false;
            //mCallbackText.setText("Unbinding.");
    }
} 
```

}

问题是当我想运行这个线程时：

```
 04-04 01:36:26.853: W/dalvikvm(29341): threadid=12: thread exiting with uncaught     exception (group=0x420372a0)
  04-04 01:36:26.853: E/AndroidRuntime(29341): FATAL EXCEPTION: Thread-11596
  04-04 01:36:26.853: E/AndroidRuntime(29341): java.lang.RuntimeException: Can't create    handler inside thread that has not called Looper.prepare()
  04-04 01:36:26.853: E/AndroidRuntime(29341):  at android.os.Handler.<init>   (Handler.java:121)
  04-04 01:36:26.853: E/AndroidRuntime(29341):  at com.nauka.bluetooth.ConnectedThread$IncomingHandler.<init>(ConnectedThread.java:127)
  04-04 01:36:26.853: E/AndroidRuntime(29341):  at com.nauka.bluetooth.ConnectedThread.<init>(ConnectedThread.java:200) 
```

你能告诉我如何处理这个问题吗？谢谢

# ruby-on-rails - 为什么在使用 'acts_as_taggable_on' 时会自动创建 2 个以上的标签？

> ID：15800343
> 
> 赞同：1
> 
> 时间：2013-04-04T00:03:45.967
> 
> 标签：ruby-on-rails, ruby-on-rails-3, acts-as-taggable-on

我确实有用户、标签和标签模型。
标记和标记模型由名为`acts_as_taggable_on` ( [https://github.com/mbleigh/acts-as-taggable-on](https://github.com/mbleigh/acts-as-taggable-on) )的 gem 自动创建。
标记模型是标记的主表。那么标记模型就是由可标记模型与其所用标记之间的关系记录组成。

到目前为止，一切都已实现看起来工作正常。
但是，当用户尝试保存这些标签时，
`TEST PC ProjectX` 它会自动创建并保存这些
`TEST PC ProjectX Projectx`

`Projectx`实际上存在是因为其他人正在使用，但我不希望它在这里，除非用户键入它。

在这种情况下，我已经将我的`User`模型设置为每个用户记录最多 3 个标签，因此它不应该成功保存。
但是，它通过了罚款:(

我该如何处理这个问题？我不希望它匹配大小写。我只想要它二进制匹配。

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:33:47.543

我不确定我是否完全理解您的问题，所以我将从这里开始；也许您可以从将所有内容保存为小写开始，看看您的问题是否仍然存在......

> 如果您希望强制标记以小写形式保存，请将其放入初始化程序中：

```
ActsAsTaggableOn.force_lowercase = true 
```

来源：[https ://github.com/mbleigh/acts-as-taggable-on#configuration](https://github.com/mbleigh/acts-as-taggable-on#configuration)

# ios - iOS - 两个应用目标，共享应用内购买

> ID：15800346
> 
> 赞同：0
> 
> 时间：2013-04-04T00:03:55.823
> 
> 标签：ios, xcode, in-app-purchase, icloud

如果我同时拥有 iPhone 和 iPad 版本的应用，它们可以共享应用内购买吗？如果用户在 iPhone 上进行购买，然后在 iPad 上下载应用程序，我需要应用程序尊重购买。

我有很多艺术品文件，因此该应用程序相当大，我想知道在这种情况下是否可以使用单独的应用程序，而不是通用应用程序。

那么有可能与两个不同的目标共享应用内购买吗？我读过一些在这种情况下提到 iCloud 的东西，但不知道它是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:06:01.497

不可以。应用内购买产品与应用捆绑 ID 相关联。您需要使用通用应用程序。

# html - 需要快速的 CSS 技巧吗？

> ID：15800351
> 
> 赞同：2
> 
> 时间：2013-04-04T00:04:19.273
> 
> 标签：html, css

所以我正在努力完成一些事情。我正在建立一个响应式网站，我遇到了一个有趣的问题。

我有一个#wrapper，它的背景是#FFF。为了显示需要，我在其中放置了一个包含一些内容和正文的标题，每个标题都有不同的背景，因此很容易看到放置在哪里。

对于我的 Wrapper，我给了它 100% 的宽度，因此它可以随着浏览器窗口扩展和收缩。但将它的最大宽度限制为 750 像素，因为我不希望网站比这更宽。

```
#wrapper {
position:relative;
margin:20px auto;
padding:0px 20px;
width:100%;
max-width:750px;
background:#FFF;
} 
```

请注意，我在其上放置了 0px 20px 的填充。这就是我的问题所在。当您重新调整浏览器窗口的大小时，包装器会随之收缩，但由于某种原因，它忽略了右侧的填充。我想确保不会发生这种情况，因为无论浏览器窗口大小如何，我都希望左右两侧有 20 像素的空间。

任何想法，提示，教训:) ？[http://jsfiddle.net/wuJ9H/](http://jsfiddle.net/wuJ9H/)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T00:07:39.847

添加`box-sizing:border-box`为我修复了它（Chrome 26、FF 19、IE9/10）。这会导致填充包含在宽度计算中。

示例：http: [//jsfiddle.net/wuJ9H/3/](http://jsfiddle.net/wuJ9H/3/)

```
#wrapper {

    position:relative;
    margin:20px auto;
    padding:0px 20px;
    width:100%;
    max-width:750px;
    background:#FFF;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
} 
```

## 为什么它有效？

> 当您重新调整浏览器窗口的大小时，包装器会随之收缩，但由于某种原因，它会忽略右侧的填充。

需要明确的是，您的原始版本不仅隐藏了正确的填充区域。它隐藏了右侧填充区域+20px，即左侧填充区域的宽度。这是因为您告诉框是 100% 宽*加上*任何填充或边框。

因此，你的盒子是 100% + 40px 宽。

添加`box-sizing: border-box`指示浏览器在宽度计算中包括填充和边框。这对于基于百分比的值非常方便。

*   [CSS`box-sizing`属性](https://developer.mozilla.org/en-US/docs/CSS/box-sizing)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:09:16.630

如果添加`box-sizing:border-box`到，`#wrapper`则填充将包含在`width`.

[jsFiddle](http://jsfiddle.net/YN7b9/1/)

```
#wrapper {
    -moz-box-sizing:border-box;
    box-sizing:border-box;
} 
```

您现在可能希望`max-width:790px`在窗口较宽时使其显示相同。

## 支持

`box-sizing`[在 IE7 及以下参考](http://caniuse.com/#search=box-sizing)中不支持。如果你想支持 IE7 那么你需要在里面放置一个内部包装器`#wrapper`。

[jsFiddle](http://jsfiddle.net/s7Pft/)

```
#wrapper {
    position:relative;
    margin:20px auto;
    width:100%;
    max-width:750px;
}
#inner {
    padding:0px 20px;
    background:#FFF;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T00:10:37.033

只需删除宽度即可在解决问题的同时保持扩展功能：

```
#wrapper {
    position:relative;
    margin:20px auto;
    padding:0px 20px;
    max-width:750px;
    background:#FFF;
} 
```

[http://jsfiddle.net/wuJ9H/2/](http://jsfiddle.net/wuJ9H/2/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T00:07:28.920

您需要在尺寸定义中包含填充。添加`box-sizing:border-box`到包装器元素。

# c# - 从另一个文件调用一个方法或一段代码

> ID：15800358
> 
> 赞同：0
> 
> 时间：2013-04-04T00:05:08.510
> 
> 标签：c#, asp.net

A 有一段非常大的代码，我在我的网页上多次执行，每次只有细微差别（它使用来自数据库的信息。有时它在 foreach 循环中，使用“row.nameofrow”，其他时候它是只是一条记录，使用“query.nameofrow”）。

我对编码很陌生，我想知道是否有一种方法可以将大量代码放入另一个文件并在我使用它的每个实例中调用它（可能使用一个参数来确定它是使用“行”还是“查询” ") 而不是每次都写出整个代码块。我需要使用什么样的文件，我该如何称呼它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:10:41.783

在处理网站之前，先做一个非常简单的课程教程。

从简单的控制台应用程序开始比使用 asp 站点要容易得多。

从这里开始是个好地方：[http ://www.csharp-station.com/tutorials/lesson1.aspx](http://www.csharp-station.com/tutorials/lesson1.aspx)

从长远来看，花一两天时间学习基础知识将对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:09:13.150

您可以使用接受参数的静态方法创建一个公共静态类。然后，您可以使用调用此方法调用 `var returnValue = StaticClassName.StaticMethodName(yourArgument);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T00:08:44.923

创建一个简单的类并将重复的代码放在一个方法中。最简单（但不推荐）的方法是将方法设为静态，这样您就可以在不实例化类的情况下调用它。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-04-04T00:07:17.370

1.  编写网络服务
2.  编写一个可以导入其他应用程序并调用的 dll

如果您完全在 Visual Studio 中，请将一个项目添加到您的解决方案中，在该项目中的一个类中编写您的代码，使用“public”公开它，在您的其他项目中引用该项目，实例化该类并调用该方法。

这是一种编码 101，您需要研究上述内容。如果不写一篇大文章，我无法描述这一切。对不起

# java - 在骆驼中测试我的对象的正确方法

> ID：15800364
> 
> 赞同：0
> 
> 时间：2013-04-04T00:05:59.950
> 
> 标签：java, junit, apache-camel

我正在尝试为骆驼路线设置测试。我的测试路由读取一个二进制文件并将其发送到一个翻译器 bean，返回一个 POJO。现在，我想对 POJO 做一些断言，以确保那里的值与已知值匹配。我认为标准的东西。在我看到的示例中，body 似乎总是一个 String 或原始类型，并且可以对其进行简单的断言。但是，就我而言，它是一个对象，所以我想以某种方式获取该对象。

这是我到目前为止所尝试的：

```
@Override
protected RouteBuilder createRouteBuilder() throws Exception {
    return new RouteBuilder() {
        @Override
        public void configure() throws Exception {
            from("file:///path/to/dir/of/test/file/?noop=true")
            .bean(TranslatorBean.class)
            .to("mock:test").end();
        }
    };
}

@Test
public void testReadMessage() throws Exception {

    MockEndpoint endpoint = getMockEndpoint("mock:test");

    endpoint.whenAnyExchangeReceived(new Processor() {      
        @Override
        public void process(Exchange exchange) throws Exception {           
            Object body = exchange.getIn().getBody();

            assertIsInstanceOf(MyPOJO.class, body);

            MyPOJO message = (MyPOJO) body;

            assertEquals("Some Field", someValue, message.getSomeField());

            // etc., etc.

        }           
    });

    //If I don't put some sleep here it ends before anything happens
    Thread.sleep(2000);

} 
```

当我运行它时，它似乎运行正确，但是当我单步执行时，我可以看到断言失败。由于某种原因，这不会被报告。

所以然后我尝试像这样在路线中内联我的处理器：

```
public void configure() throws Exception {
    .from("file:///path/to/dir/of/test/file/?noop=true")
    .bean(TranslatorBean.class)
    .process(new Processor() {
        //same code as before
     });
} 
```

这种工作，但有一个巨大的问题。JUnit 仍然不会报告任何失败的断言。相反，它们被 Camel 捕获，并报告为 CamelExecutionException，而完全没有关于原因的信息。只有通过调试器单步执行才能确定哪个断言失败。此外，这样我的整个测试都在 configure 方法中，而不是在它自己的测试方法中。我必须在睡眠中包含一个空测试才能使其运行。显然这很糟糕，但我确信在这里做正确的事情是。看起来处理器可能不是正确的路线，但我没有看到正确的方法。非常感谢任何指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-02-04T14:44:10.203

如果您正在寻找一种方法来检索对象本身并对其执行断言，您需要类似的东西：

```
Product resultProduct = resultEndpoint.getExchanges().get(0).getIn().getBody(Product.class);
assertEquals(expectedEANCode, resultProduct.getEANCode()); 
```

`resultEndPoint`模拟端点在哪里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-07T07:25:24.473

我建议从 Apache Camel 文档开始阅读。在用户指南：[http](http://camel.apache.org/user-guide.html) ://camel.apache.org/user-guide.html有一个测试链接：[http](http://camel.apache.org/testing.html) ://camel.apache.org/testing.html有很多信息。此外，由于您使用模拟端点，请阅读：[http ://camel.apache.org/mock](http://camel.apache.org/mock)

例如，您拥有的模拟代码可以作为

```
MockEndpoint endpoint = getMockEndpoint("mock:test");
mock.allMessages().body().isInstanceOf(MyPojo.class) 
```

尽管人们经常在模拟端点等上使用预期的方法，例如，如果您期望 2 条消息，并且它们的正文按以下顺序排列：

```
MockEndpoint mock = getMockEndpoint("mock:result");
mock.expectedBodiesReceived("Hello World", "Bye World"); 
```

但请查看模拟和测试文档以了解更多信息。

如果你有 Camel in Action 这本书的副本，那么请阅读第 6 章，它都是关于使用 Camel 进行测试的。

# sql - 在 PostgreSQL 中选择具有特定列名的列

> ID：15800367
> 
> 赞同：12
> 
> 时间：2013-04-04T00:06:05.997
> 
> 标签：sql, database, postgresql, select, dynamic-sql

我想编写一个简单的查询来选择 PostgreSQL 中的许多列。但是，我不断收到错误 - 我尝试了一些选项，但它们对我不起作用。目前我收到以下错误：

> org.postgresql.util.PSQLException：错误：“列”处或附近的语法错误

要获取具有值的列，我尝试以下操作：

```
select * from weather_data where column like '%2010%' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-04T00:18:42.777

`column`是一个[**保留字**](https://www.postgresql.org/docs/current/sql-keywords-appendix.html)。除非双引号，否则不能将其用作标识符。喜欢：`"column"`。

但这并不意味着你应该这样做。只是不要使用保留字作为标识符。曾经。

到 ...

> 选择名称中包含 2010 的列的列表：

.. 您可以使用此功能从系统目录表动态构建 SQL 命令[**`pg_attribute`**](https://www.postgresql.org/docs/current/catalog-pg-attribute.html)：

```
CREATE OR REPLACE FUNCTION f_build_select(_tbl regclass, _pattern text)
  RETURNS text AS
$func$
    SELECT format('SELECT %s FROM %s'
                 , string_agg(quote_ident(attname), ', ')
                 , $1)
    FROM   pg_attribute 
    WHERE  attrelid = $1
    AND    attname LIKE ('%' || $2 || '%')
    AND    NOT attisdropped  -- no dropped (dead) columns
    AND    attnum > 0;       -- no system columns
$func$ LANGUAGE sql; 
```

称呼：

```
SELECT f_build_select('weather_data', '2010'); 
```

返回类似：

```
SELECT foo2010, bar2010_id, FROM weather_data; 
```

您不能使其完全动态化，因为在我们实际构建查询之前返回类型是*未知的。*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-04T00:27:03.290

这将为您提供特定表中的列列表（如果需要，您可以选择添加架构）：

```
SELECT column_name
FROM information_schema.columns
WHERE table_name = 'yourtable'
  and column_name like '%2010%' 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!1/cfe64/1)

然后，您可以使用该查询创建动态 sql 语句以返回结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T00:30:21.087

尝试使用像这样的动态结构通常表明您应该使用适合动态访问的数据格式，如`hstore`, `json`,等。`xml`

您*可以*通过在应用程序中动态创建 SQL 来获取动态列列表。您可以查询`INFORMATION_SCHEMA`以获取有关表列的信息并构建查询。

可以在 PL/PgSQL 中执行此操作并运行生成的查询，`EXECUTE`但您会发现处理结果有些困难`RECORD`，因为您必须获取和解码复合元组，您无法将结果集扩展为普通列列表。观察：

```
craig=> CREATE OR REPLACE FUNCTION retrecset() returns setof record as $$
values (1,2,3,4), (10,11,12,13);
$$ language sql;

craig=> select retrecset();
   retrecset   
---------------
 (1,2,3,4)
 (10,11,12,13)
(2 rows)

craig=> select * from retrecset();
ERROR:  a column definition list is required for functions returning "record"

craig=> select (r).* FROM (select retrecset()) AS x(r);
ERROR:  record type has not been registered 
```

您所能做的就是获取原始记录并在客户端中对其进行解码。您无法从 SQL 中对其进行索引，也无法将其转换为其他任何内容，等等。大多数客户端 API 不提供解析匿名记录的文本表示的工具，因此您可能必须自己编写。

所以：你*可以*在不知道结果类型的情况下从 PL/PgSQL 返回动态记录，这并不是特别有用，而且在客户端处理起来很痛苦。您真的只想首先使用客户端生成查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T00:12:36.030

您不能像那样搜索所有列。您必须指定一个特定的列。

例如，

```
select * from weather_data where weather_date like '%2010%' 
```

或者更好的是，如果它是一个日期，请指定一个日期范围：

```
select * from weather_data where weather_date between '2010-01-01' and '2010-12-31' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-12T09:47:15.250

[在这里](http://www.postgresonline.com/journal/archives/41-How-to-SELECT-ALL-EXCEPT-some-columns-in-a-table.html)找到这个：

```
SELECT 'SELECT ' || array_to_string(ARRAY(SELECT 'o' || '.' || c.column_name
        FROM information_schema.columns As c
            WHERE table_name = 'officepark' 
            AND  c.column_name NOT IN('officeparkid', 'contractor')
    ), ',') || ' FROM officepark As o' As sqlstmt 
```

结果是您只需要进一步执行的 SQL SELECT 查询。它符合我的需要，因为我将结果通过管道传输**到 shell 中，**如下所示：

```
psql -U myUser -d myDB -t -c "SELECT...As sqlstm" | psql -U myUser -d myDB 
```

这将返回格式化的输出，但它仅适用于 shell。希望有一天这对某人有所帮助。

# c - C 编程：读取文件并根据找到的数据在第二个文件中搜索

> ID：15800368
> 
> 赞同：-1
> 
> 时间：2013-04-04T00:06:06.317
> 
> 标签：c, regex, file, fgets, scanf

我有两个文件，file1.txt 和 file2.txt：

文件 1.txt：

```
1234:James Smith:100:110
1111:Steve Jones:150:130
4321:Bob Wilson:110:140 
```

文件2.txt

```
100;Area 1;0.00
110;Area 2;3.00
120;Area 3;4.75
130;Area 4;5.95
140;Area 5;10.00
150;Area 6;12.00 
```

我想做的是逐行读取file1.txt并将一些信息记录到file3.txt（输出文件）中，例如字段1（数字）和字段2（名称）。为了测试我是否可以检索这些，我使用了：

```
while (fscanf(file1, "%[^:]:%[^:]:%d:%d", number, name, &on, &off) == 4)
{
  printf("Name contains: %s", name);
} 
```

正如预期的那样，这检索了所有“名称”（字段 2）值并将它们显示在屏幕上。我现在想使用存储在“on”和“off”中的数据从 file2.txt 中检索附加信息。正如您在上面看到的，file1.txt 字段 3 和 4 与 file2.txt 中的字段 1 匹配。我正在查看的最终输出文件是：

```
1234 James Smith Area 1 to Area 2 3.00
1111 Steve Jones Area 6 to Area 4 6.05
4321 Bob Wilson Area 2 to Area 5 7.00 
```

我不确定如何完成逐行读取file1.txt并同时使用file2.txt执行“检查”并输出。我还需要一个简单的减法计算。

任何帮助将不胜感激。我对 fscanf、fgets、读取文件等没有太多经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:36:58.083

这是所需结构定义的示例：

```
#define MAX_LINES 1000

struct rec1 
{
   int n;
   char name[30];
   int area1;
   int area2;
};

struct rec1 rec1_list[MAX_LINES];

struct rec2
{
   int area;
   char desc[20];
   int rating;
};

struct rec2 rec2_list[MAX_LINES]; 
```

# django - 混合 django-filepicker 和 mongodb

> ID：15800370
> 
> 赞同：0
> 
> 时间：2013-04-04T00:06:28.153
> 
> 标签：django, mongodb, mongoengine, filepicker.io, filepicker

我正在开发一个 django 1.4 应用程序，我正在使用[django-filepicker](https://github.com/Filepicker/django-filepicker)上传图像。他们为图像使用了一个特殊的 modelField，称为 FPFileField。

我有兴趣将这些图像存储在 MongoDB 数据库中，而不是将其上传到“媒体”文件夹或类似的东西。

知道如何实现吗？

我试过 mongoengine 没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T12:55:46.550

你应该看看[GridFS](http://docs.mongodb.org/manual/faq/developers/#when-should-i-use-gridfs)

我也会考虑将它上传到亚马逊的[S3](http://aws.amazon.com/s3/)服务——这取决于你的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T03:03:11.647

我建议将 url 直接存储到您的 mongo 文档中，然后使用 filepicker.io URL 并内置 S3 支持，而不是将文件直接存储在您的服务器上。

# web-applications - 如何将数据属性传递给 FatFractal 服务器扩展并从扩展代码访问它们？

> ID：15800375
> 
> 赞同：2
> 
> 时间：2013-04-04T00:07:09.213
> 
> 标签：web-applications, custom-backend

[与我之前提出的问题](https://stackoverflow.com/questions/15629240/how-to-pass-an-object-to-a-fatfractal-server-extension-and-subsequently-return-t)类似，我想知道 A）如何将单个数据属性传递给服务器扩展，以及 B）如何从服务器扩展源代码内部访问这些数据属性。作为侧边栏（不一定是这个问题的主要目的），是否可以从服务器扩展返回一组 FatFractal 对象？我在我的客户端应用程序中使用 FatFractal JavaScript SDK。

基本上，我正在创建一个简单的搜索实用程序，其中输入参数将传递给服务器扩展，服务器扩展将返回与搜索条件匹配的 FFUser 对象数组。

FFDL：

```
CREATE EXTENSION /SearchUsers AS javascript:require('scripts/Search').searchUsers(); 
```

应用程序JS代码：

```
 function findUsers() {
            if(!ff.loggedIn()) {
                alert("You must be logged in to search for users.");
            }
            else {
                var searchCriteria = $("#input-user-search").val();

                // pass 'searchCriteria' to 'SearchUsers' extension
                // acquire handle to 'matchedUsers' returned from 'SearchUsers'

                ...

            }
        } 
```

服务器扩展JS代码：

```
var ff = require('ffef/FatFractal');

function searchUsers() {

    var matchedUsers; // an array of FFUser objects
    var searchInput; // the search criteria 

    // acquire handle to 'searchCriteria' passed from client app to assign to 'searchInput'

    ...

    // return 'matchedUsers' to client app

}

...

exports.searchUsers = searchUsers; 
```

同样，评论部分是我需要澄清的部分。其余的实现逻辑我相信我已经弄清楚了。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:17:32.367

对于您的应用程序 JS 代码，您可以将数据作为 URL 查询参数传递：

```
var searchCriteria = $("#input-user-search").val();

// suitable validation and URL encoding ...

ff.getArrayFromExtension("/SeachUsers?search=" + searchCriteria,
    function(result) {
        // success
}); 
```

（请注意，您也可以使用通常的`getArrayFromUri`功能，但在这种情况下，您必须提供 `/ff/ext/SearchUsers' 的完整扩展 URI。）

然后在你的扩展中，你需要先获取传入的参数：

```
var searchCriteria = ff.getExtensionRequestData().httpParameters['search']; 
```

最后，设置结果：

```
var r = ff.response();
r.responseCode = 200;
r.result = matchedUsers; 
```

请注意，您也可以使用该`postObjToExtension`函数，然后将对象发布到您的扩展程序中，但这对于这种情况来说可能是多余的。

# php - php mysql：在时间段内仅存储1个数据

> ID：15800386
> 
> 赞同：1
> 
> 时间：2013-04-04T00:08:09.453
> 
> 标签：php, mysql

我想知道是否有人可以提出一种在 mysql 数据库中一段时间​​内存储一个数据的好方法？

请注意，我指的是时间段，而不仅仅是日期时间。比如……一个小时。或者一天半。或者两周。或者一年。

具体来说，如果我有一段时间，在上午 8 点至晚上 10 点、上午 10 点至下午 12 点、下午 12 点至 14 点，我只想每两小时存储一个时间段数据，

我可以在 php 或 mysql 中做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T11:11:45.897

## 检查这个：

将类型中的新列添加`timestamp`到数据库的表中。

通过此提示使用您的 PHP 技能：

```
$sql = "SELECT $timestamp FROM $table ORDER BY $timestamp DESC LIMIT 1";

$result = mysqli_query($conection, "$sql");

if (/*the hour now*/ != /*the hour on $result*/) {
    // allow to store data
} else {
    // don't allow to store data
} 
```

剩下的就做吧，如果上面的代码有错误，我什至没有好好复习。只需使用您的编程技能..

*“但是，任何人都可以通过修改来改进这个答案。”*

# c# - 注册为用户失败... Asp.net mvc 实体框架

> ID：15800387
> 
> 赞同：1
> 
> 时间：2013-04-04T00:08:28.483
> 
> 标签：c#, asp.net-mvc, entity-framework

我正在学习这个 MvcMovie 教程，我正在做一些改变.....

最初，我有 2 个从 DbContext 派生的类，一个用于电影，另一个用于用户...

所以我将它们移到了单个 DbContext ....

```
public class MovieDBContext : DbContext
{
    public DbSet<Movie> Movies { get; set; }
    public DbSet<UserProfile> UserProfiles { get; set; }

} 
```

但是现在当我尝试将自己注册为用户时，我在 AccountController 的这一行中收到错误

```
 WebSecurity.CreateUserAndAccount(model.UserName, model.Password); 
```

错误是这个：

```
Cannot insert the value NULL into column 'xxx', table 'aspnet-MvcMovie-20120730162622.dbo.UserProfile'; column does not allow nulls. INSERT fails. 
```

我不明白那个 xxx 是什么，我在数据库中查看，但没有找到具有该名称的列...我只在我的 jquery 文件中找到了 xxx，类似这样

```
 /* Handles responses to an ajax request:

* - sets all responseXXX fields accordingly
 * - finds the right dataType (mediates between content-type and expected dataType)
 * - returns the corresponding response
 */ 
```

我不知道那是什么..我还没有学习jquery....我不知道这是我的问题的一部分还是与它无关...

# linux - mv 包含来自 shell 脚本的空格的文件

> ID：15800389
> 
> 赞同：5
> 
> 时间：2013-04-04T00:08:36.070
> 
> 标签：linux, shell, mv

我正在尝试`mv`一个文件（重命名它以用破折号替换空格）。如果我传递不带引号的源和目标参数，则源被分解，因为`mv`认为它是参数的结尾。

如果我用参数包围 source 和 dest，mv 报告找不到源。目前，$1 和 $2 在开头和结尾都有硬编码引号。$onam 和 $dnam 是没有硬编码引号的等价物。

提示符下的这个命令非常有效，因为 source 和 dest 被引号包围：

```
mv "/home/bryan/renametest/TestFolder/test file" "/home/bryan/renametest/TestFolder/test---file" 
```

这是我迄今为止尝试过的（输入和结果）

```
mv $1 $2
mv: cannot stat `"/home/bryan/renametest/TestFolder/test   file"'
   No such file or directory

mv $onam $dnam
mv: cannot move `/home/bryan/renametest/TestFolder' to a subdirectory of itself, 
  `/home/bryan/renametest/TestFolder/test---file'

mv $1 $dnam
mv: cannot stat `"/home/bryan/renametest/TestFolder/test   file"': 
  No such file or directory

mv $onam $2
mv: cannot move `/home/bryan/renametest/TestFolder' to `"/home/bryan/renametest/TestFolder/test---file"': 
  No such file or directory 
```

如何使用空格移动这些文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T00:26:06.263

采用：

```
mv "$onam" "$dnam" 
```

基本上，在包含可能包含空格的文件名的变量周围使用引号。但是，值本身不应包含引号，除非文件名或目录名称本身包含引号。

不幸的是，我无法立即想到一种简单的方法来使用这些值，例如`$1`在它们周围硬编码的引号中。你必须搞砸`eval`或附近。

* * *

### SSCCE（[简短、独立、正确的示例](http://sscce.org/)）

此代码与您显示的代码同构，但实际上做得更多。它也可以安全运行并在其身后清理。它假定您正在使用`bash`. 请注意，带空格的名称在一行中包含多个空格；如果您尝试使用包含单个空格的名称，很容易被愚弄成一种错误的安全感。

```
#!/bin/bash
testdir=test.$$
mkdir "$testdir" || exit 1

trap "rm -fr '$testdir'; exit 1" 0 1 2 3 13 15

(
    set -x
    x=$'\n\n'
    cd test.$$

    basedir="$PWD"
    sub1dir="rename  test"
    sub2dir="Test   Folder"
    subdir="$sub1dir/$sub2dir"

    mkdir -p "$basedir/$subdir"

    oldfile="test   file"

    cp /etc/group "$basedir/$subdir/$oldfile"

    echo "$x"
    ls -lR .

    echo "$x"
    newfile=$(echo "$oldfile" | sed 's/ /-/g')
    mv "$basedir/$subdir/$oldfile" "$basedir/$subdir/$newfile"
    ls -lR .

    echo "$x"
    new2dir=$(echo "$sub2dir" | sed 's/ /-/g')
    mv "$basedir/$subdir"  "$basedir/$sub1dir/$new2dir"
    ls -lR .

    echo "$x"
    new1dir=$(echo "$sub1dir" | sed 's/ /-/g')
    mv "$basedir/$sub1dir" "$basedir/$new1dir"
    ls -lR .
)

rm -fr "$testdir"
trap 0

#    $ mv "/home/bryan/renametest/TestFolder/test   file" "/home/bryan/renametest/TestFolder/test---file"
#
#Here are some inputs and results.
#
#    mv $1 $2
#    mv: cannot stat `"/home/bryan/renametest/TestFolder/test   file"': No such file or directory
#
#    mv $onam $dnam
#    mv: cannot move `/home/bryan/renametest/TestFolder' to a subdirectory of itself, `/home/bryan/renametest/TestFolder/test---file'
#
#    mv $1 $dnam
#    mv: cannot stat `"/home/bryan/renametest/TestFolder/test   file"': No such file or directory
#
#    mv $onam $2
#    mv: cannot move `/home/bryan/renametest/TestFolder' to `"/home/bryan/renametest/TestFolder/test---file"': No such file or directory
#
#Ideas? 
```

你必须小心；请注意我是如何从片段中建立名称并分解它们等的。但要小心，它可以完成。

### 示例输出

使用 运行`bash -x`，但您可以使用 just 运行它，`bash`并且您只会跳过一点输出，因为它`set -x`在子 shell 代码中包含 a 。

```
+ testdir=test.47648
+ mkdir test.47648
+ trap 'rm -fr '\''test.47648'\''; exit 1' 0 1 2 3 13 15
+ set -x
+ x='

'
+ cd test.47648
+ basedir=/Users/jleffler/tmp/soq/x3/test.47648
+ sub1dir='rename  test'
+ sub2dir='Test   Folder'
+ subdir='rename  test/Test   Folder'
+ mkdir -p '/Users/jleffler/tmp/soq/x3/test.47648/rename  test/Test   Folder'
+ oldfile='test   file'
+ cp /etc/group '/Users/jleffler/tmp/soq/x3/test.47648/rename  test/Test   Folder/test   file'
+ echo '

'

+ ls -lR .
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 rename  test

./rename  test:
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 Test   Folder

./rename  test/Test   Folder:
total 8
-rw-r--r--  1 jleffler  staff  2151 Apr  3 18:43 test   file
+ echo '

'

++ echo 'test   file'
++ sed 's/ /-/g'
+ newfile=test---file
+ mv '/Users/jleffler/tmp/soq/x3/test.47648/rename  test/Test   Folder/test   file' '/Users/jleffler/tmp/soq/x3/test.47648/rename  test/Test   Folder/test---file'
+ ls -lR .
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 rename  test

./rename  test:
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 Test   Folder

./rename  test/Test   Folder:
total 8
-rw-r--r--  1 jleffler  staff  2151 Apr  3 18:43 test---file
+ echo '

'

++ echo 'Test   Folder'
++ sed 's/ /-/g'
+ new2dir=Test---Folder
+ mv '/Users/jleffler/tmp/soq/x3/test.47648/rename  test/Test   Folder' '/Users/jleffler/tmp/soq/x3/test.47648/rename  test/Test---Folder'
+ ls -lR .
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 rename  test

./rename  test:
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 Test---Folder

./rename  test/Test---Folder:
total 8
-rw-r--r--  1 jleffler  staff  2151 Apr  3 18:43 test---file
+ echo '

'

++ echo 'rename  test'
++ sed 's/ /-/g'
+ new1dir=rename--test
+ mv '/Users/jleffler/tmp/soq/x3/test.47648/rename  test' /Users/jleffler/tmp/soq/x3/test.47648/rename--test
+ ls -lR .
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 rename--test

./rename--test:
total 0
drwxr-xr-x  3 jleffler  staff  102 Apr  3 18:43 Test---Folder

./rename--test/Test---Folder:
total 8
-rw-r--r--  1 jleffler  staff  2151 Apr  3 18:43 test---file
+ rm -fr test.47648
+ trap 0 
```

# php - 在 div 更改时发布到 PHP 页面

> ID：15800390
> 
> 赞同：0
> 
> 时间：2013-04-04T00:08:35.860
> 
> 标签：php, javascript, ajax

以下是我的代码。当其他事件发生时，div id jp_current_track_title 会自动更改。我正在尝试捕获进入 div 的内容“Track_title 并将其发布到 like.php。截至目前我无法弄清楚。我将某些内容返回到结果 div 但它没有发布。我做错了什么？

```
 $(document).ready(function() {
                    $('#track_title').change(function() {
                        var content = $('#track_title').html();
                        $.ajax({
                            url: 'like.php',
                            type: 'POST',
                            success: function(info){ $("#result").html(info)
                            },
                            data: {
                                content: content,
                            }
                        });
                    });
                }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:33:48.180

当 div 的内容发生更改时，您不会收到“更改”事件，它不会那样工作。

看这里：

[在 div 更改时触发 jQuery 事件](https://stackoverflow.com/questions/4979738/fire-jquery-event-on-div-change)

主要答案提到了如何跟踪 DOMNodeInserted / DOMNodeRemoved / DOMSubtreeModified 事件，但是这些在 IE 中不起作用。

最好的办法是使用 setTimeout() 并定期检查 div 的 innerHTML 以查看值是否已更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T02:09:33.593

`jp_current_track_title`您能否捕获导致更新的其他事件，而不是检测更改`jp_current_track_title`？如果是这样，你能从那里得到更新的标题吗？

# scala - 在 Scala Dispatch 中解码流式 GZIP 响应？

> ID：15800393
> 
> 赞同：4
> 
> 时间：2013-04-04T00:08:49.857
> 
> 标签：scala, scala-dispatch, asynchttpclient

从 API 接收 Gzipped 响应，但 Dispatch 0.9.5 似乎没有任何方法来解码响应。有任何想法吗？

这是我当前的实现，`println`唯一打印出字节的字符串表示形式。

```
 Http(
      host("stream.gnip.com")
      .secure
      .addHeader("Accept-Encoding", "gzip")
       / gnipUrl
      > as.stream.Lines(println))() 
```

试图看看实现我自己的处理程序，但不知道从哪里开始。这是相关文件`Lines`：[https ://github.com/dispatch/reboot/blob/master/core/src/main/scala/as/stream/lines.scala](https://github.com/dispatch/reboot/blob/master/core/src/main/scala/as/stream/lines.scala)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T17:42:36.073

干脆放弃了Dispatch，直接使用Java API。令人失望，但它完成了工作。

```
 val GNIP_URL = isDev match {
    case true => "https://url/apath/track/dev.json"
    case false => "https://url/path/track/prod.json"
  }
  val GNIP_CHARSET = "UTF-8"

  override def preStart() = {
    log.info("[tracker] Starting new Twitter PowerTrack connection to %s" format GNIP_URL)

    val connection = getConnection(GNIP_URL, GNIP_USER, GNIP_PASSWORD)
    val inputStream = connection.getInputStream()
    val reader = new BufferedReader(new InputStreamReader(new StreamingGZIPInputStream(inputStream), GNIP_CHARSET))
    var line = reader.readLine()
    while(line != null){
        println(line)
        line = reader.readLine()
    }
  }

  private def getConnection(urlString: String, user: String, password: String): HttpURLConnection = {
    val url = new URL(urlString)

    val connection = url.openConnection().asInstanceOf[HttpURLConnection]
    connection.setReadTimeout(1000 * 60 * 60)
    connection.setConnectTimeout(1000 * 10)

    connection.setRequestProperty("Authorization", createAuthHeader(user, password));
    connection.setRequestProperty("Accept-Encoding", "gzip")
    connection
  }

  private def createAuthHeader(username: String, password: String) = {
    val encoder = new BASE64Encoder()
    val authToken = username+":"+password
   "Basic "+encoder.encode(authToken.getBytes())
  } 
```

使用 GNIP 的示例：[https ://github.com/gnip/support/blob/master/Premium%20Stream%20Connection/Java/StreamingConnection.java](https://github.com/gnip/support/blob/master/Premium%20Stream%20Connection/Java/StreamingConnection.java)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-24T23:29:09.940

这与其说是一种解决方案，不如说是一种解决方法，但我最终求助于绕过`Future`基于 - 的东西并做：

`val stream = Http(req OK as.Response(_.getResponseBodyAsStream)).apply val result = JsonParser.parse( new java.io.InputStreamReader( new java.util.zip.GZIPInputStream(stream)))`

我在`JsonParser`这里使用是因为在我的情况下，我收到的数据恰好是 JSON；如果需要，用你的用例中的其他东西代替。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-27T10:46:54.227

我的解决方案只是定义了一个响应解析器，并且还采用了 json4s 解析器：

```
 object GzipJson extends (Response => JValue) {
      def apply(r: Response) = {
        if(r.getHeader("content-encoding")!=null && r.getHeader("content-encoding").equals("gzip")){
          (parse(new GZIPInputStream(r.getResponseBodyAsStream), true))
        }else
          (dispatch.as.String andThen (s => parse(StringInput(s), true)))(r)
      }
    } 
```

这样我就可以使用它来提取 Gzip Json 响应，如下代码：

```
 import GzipJson._

    Http(req OK GzipJson).apply 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-04T02:20:40.493

尝试`>>`代替`>`

见[https://github.com/dispatch/dispatch/blob/master/core/src/main/scala/handlers.scala#L58](https://github.com/dispatch/dispatch/blob/master/core/src/main/scala/handlers.scala#L58)

# php - 为什么 $some_array['an-undefined-key'] 在 Mac 上会抛出错误而不是 Wamp？

> ID：15800394
> 
> 赞同：0
> 
> 时间：2013-04-04T00:08:52.947
> 
> 标签：php, windows, macos, wamp

出于某种原因，我的 Mac 显示错误消息“未定义索引：未定义键”，而在带有 WAMP 的 Windows 上，它优雅地忽略了异常。

使用示例：

```
if ($some_array['an-undefined-key']) {
    // ...
} 
```

是否有改变这种行为的 PHP 配置？

我意识到我可以执行以下操作，但如果可能的话，我宁愿使用上述技术：

```
if (isset($some_array['an-undefined-key']) && $some_array['an-undefined-key']) {
    // ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:10:28.510

是的，您需要调整`error_reporting`和`display_errors`设置，这听起来在您的两个不同环境之间是不同的。

这里是链接

[错误报告](http://php.net/manual/en/function.error-reporting.php)

[PHP ini_set - 查看 display_errors 的第一个示例](http://php.net/manual/en/function.ini-set.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T01:08:43.510

您不应该在脚本中添加不必要的行，因为您必须在上线时更改它们。

编辑您的 php.ini（使用 wampmanager 菜单，以便获得正确的文件）

```
left click wampmanager -> PHP -> php.ini 
```

查找这些参数并更改为这些值

```
error_reporting = E_ALL 
```

这个在网页上显示错误

```
display_errors = On
error_log = "c:/wamp/logs/php_error.log" 
```

这将使错误记录到 error_log 指定的文件中，即使它们没有显示在屏幕上

```
log_errors = On 
```

WAMP 配置了 XDEBUG，因此您现在应该在网页中看到大的橙色错误 检查 php.ini 文件底部的这一行。版本号可能在您的系统上有所不同

```
; XDEBUG Extension
zend_extension = "c:/wamp/bin/php/php5.X.Y/zend_ext/php_xdebug-2.2.0-5.3-vc9.dll" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:12:11.230

Mac 上使用已安装 repo 的 PHP 与 WAMP 服务器之间的区别在于 php.ini，请尝试编辑脚本并将以下行附加到顶部：

```
 ini_set('display_errors', '1');
 error_reporting(E_ALL); 
```

这应该在您的脚本上。如果这不是问题，请回复评论，我会做出相应的更改。

# fullcalendar - 我可以防止有冲突时间的事件吗？

> ID：15800398
> 
> 赞同：3
> 
> 时间：2013-04-04T00:09:10.260
> 
> 标签：fullcalendar

如何防止发生冲突时间的事件？有没有要设置的变量？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T07:20:37.360

不，没有要设置的变量，但您可以使用诸如[clientEvents 之](http://arshaw.com/fullcalendar/docs/event_data/clientEvents/)类的东西来检索 fullcalendar 在内存中的事件。您可以在[eventDrop](http://arshaw.com/fullcalendar/docs/event_ui/eventDrop/)中使用下面的函数。在下面的例子中，它使用一个函数来过滤事件是否有重叠。

```
function checkOverlap(event) {  

    var start = new Date(event.start);
    var end = new Date(event.end);

    var overlap = $('#calendar').fullCalendar('clientEvents', function(ev) {
        if( ev == event)
            return false;
        var estart = new Date(ev.start);
        var eend = new Date(ev.end);

        return (Math.round(estart)/1000 < Math.round(end)/1000 && Math.round(eend) > Math.round(start));
    });

    if (overlap.length){  
            //either move this event to available timeslot or remove it
       }                  
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-01T08:31:00.930

您可以在 celendar 配置中添加 eventOverlap : false， [http ://fullcalendar.io/docs/event_ui/eventOverlap/](http://fullcalendar.io/docs/event_ui/eventOverlap/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-25T15:09:15.007

正确的重叠检查。

```
 eventDrop: function(event, dayDelta, minuteDelta, allDay, revertFunc, jsEvent, ui, view) {
            /// deny overlap of event
            var start = new Date(event.start);
            var end = new Date(event.end);

            var overlap = $('#calendar').fullCalendar('clientEvents', function(ev) {
                if( ev == event) {
                    return false;
                }
                var estart = new Date(ev.start);
                var eend = new Date(ev.end);

                return (
                    ( Math.round(start) > Math.round(estart) && Math.round(start) < Math.round(eend) )
                    ||
                    ( Math.round(end) > Math.round(estart) && Math.round(end) < Math.round(eend) )
                    ||
                    ( Math.round(start) < Math.round(estart) && Math.round(end) > Math.round(eend) )
                );
            });
            if (overlap.length){
                revertFunc();
                return false;
            }
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-03T11:26:33.347

在事件对象中添加自定义属性，`overlap:false` 例如您的事件对象将是

```
 `{
                    title:'Event',
                    start: '2017-01-04T16:30:00',
                    end: '2017-01-04T16:40:00',
                    overlap:false
                  }` 
```

现在覆盖 selectOverlap 函数，

```
selectOverlap: function(event) {
    if(event.ranges && event.ranges.length >0) {
      return (event.ranges.filter(function(range){
          return (event.start.isBefore(range.end) &&
                  event.end.isAfter(range.start));
      }).length)>0;
    }
    else {
      return !!event && event.overlap;
    }
  }, 
```

它不会让另一个事件覆盖已经放置的事件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-14T12:20:48.680

这可以解决问题。它还处理调整重叠事件的大小

```
var calendar = new Calendar(calendarEl, {
      selectOverlap: false,
      eventOverlap: false
  }
}); 
```

# mysql - 无法将 SQL 数据库从 mysql-server-5.0.95-5.el5_9 导入 5.5.29-0ubuntu0.12.10.1 (Ubuntu)

> ID：15800405
> 
> 赞同：0
> 
> 时间：2013-04-04T00:09:32.103
> 
> 标签：mysql, phpmyadmin

我在旧服务器上导出了数据库，当我在新服务器上导入时，我得到：错误

SQL查询：

```
-- phpMyAdmin SQL Dump
-- version 2.6.0-pl2
-- http://www.phpmyadmin.net
-- 
-- Host: localhost
-- Generation Time: Apr 03, 2013 at 06:33 PM
-- Server version: 5.0.95
-- PHP Version: 5.1.6
-- 
-- Database: `ipm`
-- 
-- --------------------------------------------------------
-- 
-- Table structure for table `audit`
-- 
DROP TABLE IF EXISTS `audit` ;

CREATE TABLE IF NOT EXISTS `audit` (
`id` int( 11 ) NOT NULL AUTO_INCREMENT ,
`user` varchar( 100 ) NOT NULL default '',
`type` varchar( 100 ) NOT NULL default '',
`sql` varchar( 200 ) NOT NULL default '',
`date` timestamp NOT NULL default CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP ,
`test` char( 1 ) NOT NULL default '',
PRIMARY KEY ( `id` )
) ENGINE = MYISAM AUTO_INCREMENT =48 DEFAULT CHARSET = latin1 AUTO_INCREMENT =48; 
```

MySQL 说：文档

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '`id` int(11) NOT NULL auto_increment,
  `user` varchar(100) NOT NULL default '',' at line 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T03:12:13.140

我手动移动了数据库文件，它工作正常。

# javascript - 有没有办法阻止 contenteditable 的插入符号出现在 IE10 中的元素上？

> ID：15800409
> 
> 赞同：25
> 
> 时间：2013-04-04T00:09:52.027
> 
> 标签：javascript, css, tinymce, contenteditable, internet-explorer-10

IE10 中似乎存在一个错误，如果我将一个元素放在具有该`contenteditable`属性的另一个元素上，编辑器的插入符号就会覆盖所有内容。

您可以在下图中和此[jsFiddle](http://jsfiddle.net/fjzVk/)中看到此行为。

![例子](https://i.stack.imgur.com/mT7lx.png)

我已经使用了大量的 CSS 属性，但无法找到解决方案。它在其他浏览器中按预期工作。

我需要这个的原因是因为我正在设计一个 WYSWIYG 编辑器（[TinyMCE](http://www.tinymce.com/) fork）体验，其中工具栏在需要时*滑过*文本。此错误使插入符号出现在工具栏的顶部。

我想到的唯一解决方案是模糊编辑器的焦点，并在工具栏消失时重新聚焦。但是，这会在工具栏被激活时阻止用户输入，并且还会导致跨浏览器的行为不一致。

这个错误有解决方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-08T17:57:19.900

无法将插入符号与 IE 中的另一个元素重叠。这个问题被问了很多次：

*   [链接 1](https://stackoverflow.com/questions/1823808/hiding-the-text-input-cursor-the-caret-showing-through-overlayed-elements-inte)
*   [链接 2](https://stackoverflow.com/questions/293657/how-to-hide-a-caret-in-ie-javascript)

...

但是您可以在获取插入符号位置后模糊文本区域（请参阅：[文本区域中的插入符号位置，从开头开始的字符](https://stackoverflow.com/questions/263743/how-to-get-caret-position-in-textarea)），然后显示您的工具栏。隐藏工具栏后，您可以再次聚焦 textarea，设置插入符号位置：

```
function setCaretPosition(elemId, caretPos) {
    var elem = document.getElementById(elemId);

    if(elem != null) {
        if(elem.createTextRange) {
            var range = elem.createTextRange();
            range.move('character', caretPos);
            range.select();
        }
        else {
            if(elem.selectionStart) {
                elem.focus();
                elem.setSelectionRange(caretPos, caretPos);
            }
            else
                elem.focus();
        }
    }
} 
```

请参阅：[在 html 文本框中设置键盘插入符号位置](https://stackoverflow.com/questions/512528/set-cursor-position-in-html-textbox)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:56:48.583

添加`-ms-user-select: none`到 contenteditable 元素。设置焦点将不会显示光标 - 猜测浏览器怪癖。一旦你点击左/右或输入另一个字符，光标可能会重新出现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-09T07:44:06.233

您可以使用 JavaScript 和 CSS ***模拟插入符号并对其进行自定义。***
通过适当的自定义，您可以针对此错误构建实用的解决方法。

这是一篇关于如何做到这一点的有趣文章：
[http ://www.dynamicdrive.com/forums/showthread.php?17450-Emulating-a-terminal-like-caret-with-javascript-and-css](http://www.dynamicdrive.com/forums/showthread.php?17450-Emulating-a-terminal-like-caret-with-javascript-and-css)

这是一个**演示**：
[http ://shachi.prophp.org/demo.html](http://shachi.prophp.org/demo.html)

此外，还有一个**jQuery Terminal Emulator**插件，您可以根据您的特定需求进行分叉和自定义：http:
[//terminal.jcubic.pl/#demo](http://terminal.jcubic.pl/#demo)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-10T21:13:26.767

显而易见的解决方法是降低 contenteditable div 的高度，并将工具栏显示在可编辑区域上方而不是在其顶部。

# php - 如何检测可以是日文、中文或英文的字符串的编码并转换为 utf8 进行显示？

> ID：15800410
> 
> 赞同：3
> 
> 时间：2013-04-04T00:09:52.230
> 
> 标签：php, html, email, character-encoding

在一个 php 网站上，我从 imap 收到电子邮件并将它们保存在数据库中。

另一方面，我想展示其中的一些。那个邮箱接收很多英文邮件，也有日文和中文。

以下代码的问题是我无法检测到所有字符集。如果我安排数组的顺序，这样中文字符就可以了，那么其他字符集就错了。

```
<?php
$subject = "板ｲﾃ淌"; // can be japanese
$subject = "这间面积70平"; // can be chinese
$subject = "This string can have latin1 chars also";

function get_subject($subject);

$encs = array();
$enc[] = "Big5";
$enc[] = "big5";
$enc[] = "euc-kr";
$enc[] = "EU-CN";
$enc[] = "GB2312";
$enc[] = "ISO-8859-1";
$enc[] = "GBK";
$enc[] = "CP936";
$enc[] = "ASCII";
$enc[] = "JIS";
$enc[] = "UTF-8";
$enc[] = "EUC-JP";
$enc[] = "SJIS";
$enc[] = "latin1";
$encoding = mb_detect_encoding($this->object_message, $encs);
$subject = mb_convert_encoding($this->object_message, 'UTF-8', $encoding);
$subject = iconv ( 'utf-8', 'ISO-8859-2' , $subject );
return $subject;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T09:57:16.637

如果不能显示，也不能正确的放入数据库。

您无法仅通过查看字节来检测编码字节的内容，但 UTF-8 除外，因为它具有独特且受限制的模式。这就是`detect_encoding`做的，因此对所有事情都没有用，除了在非常少量的具有专有属性的编码之间进行检测。

当您收到电子邮件时，您应该阅读编码标头并使用该编码将数据转换为 UTF-8。不要转换为 ISO-8859-2，因为它是一个很小的字符集，您会丢失大多数字符。

您可以使用[PHP 电子邮件解析器](https://github.com/plancake/official-library-php-email-parser)，它以 UTF-8 格式返回电子邮件内容。

# c# - Caliburn.Micro 自动激活不应该的 ViewModel

> ID：15800411
> 
> 赞同：0
> 
> 时间：2013-04-04T00:09:55.583
> 
> 标签：c#, wpf, castle-windsor, caliburn.micro

我使用 Caliburn.Micro 作为 WPF 框架，我的应用程序或多或少地模拟了 CM doco 中的示例代码。我使用 Castle.Windsor 作为 IoC 容器。

我的 ShellViewModel 有一个相应的视图，它在选项卡控件中显示“子”视图。一切都很好，但不知何故，我现在设法让它开始激活它不应该激活的特定视图模型。

我明确要求`ActivateItem(SomeViewModel)`我`ShellViewModel`打开 3 个标签。这可以。但是 CM 会自动激活第四个 ViewModel（我们称之为`NotYetViewModel`），我并没有要求它这样做。

堆栈跟踪似乎表明这是因为 Castle.Windsor 正在`Castle.MicroKernel.ComponentActivator.DefaultComponentActivator.CreateInstance(...)`使用此 ViewModel 类型调用 a ，这具有在不应该加载和显示视图时的副作用。

`NotYetViewModel`不是我想要激活的任何 ViewModel 的依赖项*，*也没有以任何方式从`ShellViewModel`引导程序创建的 .这个虚拟机没有我明确要求它。

我唯一的其他线索是，如果我从中删除默认构造函数`NotYetViewModel`，则不会创建它（可能是因为 CM/Castle*无法*创建它），但没有报告此失败的错误，这表明 Castle 不认为这种类型是其他东西的必需依赖项。

关于我可以研究什么来解决这个问题的任何建议？

# c# - 使用 NavigationCommands.GoToPage 后无法通过触发器设置 Frame.Source

> ID：15800412
> 
> 赞同：0
> 
> 时间：2013-04-04T00:10:16.780
> 
> 标签：c#, wpf, mvvm

我正在尝试创建一个支持 MVVM 的自定义控件，该控件扩展 Frame（来自 Navigation），并考虑了两个主要目标。

首先，我希望能够通过触发器更改帧的来源。这样，当 ViewModel 的属性发生更改时，我可以根据某些情况更改使用*哪个视图。*

其次，我希望视图本身能够更改使用*哪个视图*，在某些情况下，ViewModel 中没有任何变化。使用框架/页面系统并从页面内部调用 NavigationCommands.GoToPage 命令似乎是最合适的方法，因为每个不同的视图都可以定义为一个页面。

我遇到的问题是通过触发器设置 Frame.Source 工作得很好，直到第一次使用 GoToPage。在那之后，触发器似乎没有效果。GoToPage 似乎随时都可以工作。我整天都在搜索，找不到任何解释这一点的文档。

无论如何，这是我的自定义 Frame 的实现，我所做的只是绑定到 GoToPage 并确保 Pages 继承 DataContext：

```
public class FrameExtended : Frame
{
    public FrameExtended()
    {
        CommandBindings.Add(new CommandBinding(NavigationCommands.GoToPage, GoToPage_Executed));
        Navigated += new System.Windows.Navigation.NavigatedEventHandler(FrameExtended_Navigated);
    }

    void FrameExtended_Navigated(object sender, NavigationEventArgs e)
    {
        (Content as FrameworkElement).DataContext = this.DataContext;
    }

    void GoToPage_Executed(object sender, ExecutedRoutedEventArgs e)
    {
        if (e.Parameter is Uri) Source = e.Parameter as Uri;
        else if (e.Parameter is string) Source = new Uri(e.Parameter as string, UriKind.Relative);
    }
} 
```

这是我的 ViewModel 的测试用例，它与 ViewModel 一样简单：

```
public enum MyEnum { MyEnumVal1, MyEnumVal2, MyEnumVal3 }

public class ViewModel : INotifyPropertyChanged
{
    private MyEnum enumVal = MyEnum.MyEnumVal1;

    public MyEnum EnumVal
    {
        get { return enumVal; }
        set
        {
            if (enumVal != value)
            {
                enumVal = value;
                OnPropertyChanged("EnumVal");
            }
        }
    }

    protected void OnPropertyChanged(string PropertyName)
    {
        if (PropertyChanged != null) PropertyChanged(this, new PropertyChangedEventArgs(PropertyName));
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

这是 XAML 的测试片段，我在其中使用了框架并定义了一些触发器：

```
<Button Content="ChangeViewModel" Click="Button_Click"/>
<Control>
    <Control.Template>
        <ControlTemplate TargetType="Control">
            <local:FrameExtended x:Name="MyFrame"/>
            <ControlTemplate.Triggers>
                <DataTrigger Binding="{Binding EnumVal}" Value="MyEnumVal1">
                    <Setter TargetName="MyFrame" Property="Source" Value="Pages/testpage.xaml"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding EnumVal}" Value="MyEnumVal2">
                    <Setter TargetName="MyFrame" Property="Source" Value="Pages/testpage2.xaml"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding EnumVal}" Value="MyEnumVal3">
                    <Setter TargetName="MyFrame" Property="Source" Value="Pages/testpage3.xaml"/>
                    <Setter TargetName="MyFrame" Property="Background" Value="Green"/>
                </DataTrigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Control.Template>
</Control> 
```

其中 Button_Click 指的是：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    var vm = this.DataContext as ViewModel;

    switch (vm.EnumVal)
    {
        case MyEnum.MyEnumVal1: vm.EnumVal = MyEnum.MyEnumVal2; break;
        case MyEnum.MyEnumVal2: vm.EnumVal = MyEnum.MyEnumVal3; break;
        case MyEnum.MyEnumVal3: vm.EnumVal = MyEnum.MyEnumVal1; break;
    }
} 
```

除此之外，testpage.xaml 包含以下行：

```
<Button Content="NEXTPAGE" Command="GoToPage" CommandParameter="Pages/testpage2.xaml"/> 
```

其余页面只有一个 TextBlock 指示它是哪个页面。

如果我一遍又一遍地单击“ChangeViewModel”按钮，框架将按预期循环浏览页面（并在第 3 页上将其背景更改为绿色）。单击 testpage.xaml 中调用 GoToPage 的按钮后，Frame 将切换到 testpage2。之后，对 ChangeViewModel 的后续点击永远不会改变显示哪个页面，但仍然使 Frame 的背景在每 3 次点击时变为绿色（当 testpage3 应该显示时）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:06:02.860

我为这个问题找到的解决方法是在自定义控件中定义的 GoToPage 处理程序中使用 Frame.Navigate()，而不是直接设置源属性。似乎是从 C# 代码设置 Source 属性是阻止触发器更改它的原因（我猜是不同的优先级）。Navigate() 没有这个问题，它实际上是我首先尝试的并且很可能是理想的实现。它以前不起作用，因为所有这些实现都在控制库中，而 Navigate() 正在执行程序集中搜索我的页面。作为其他尝试做类似事情的人的旁注，请确保在传递给 Frame.Navigate() 的任何 URI 中包含程序集引用，否则默认情况下它将在执行程序集中搜索（不一定是定义程序集，与 XAML 中指定的 URI 一样）。我的 GoToPage 处理程序现在看起来像这样：

```
void GoToPage_Executed(object sender, ExecutedRoutedEventArgs e)
{
    if (e.Parameter is Uri) Navigate(e.Parameter as Uri);
    else if (e.Parameter is string) Navigate(new Uri(e.Parameter as string, UriKind.RelativeOrAbsolute));
} 
```

# python - Django错误的模板优先级？

> ID：15800421
> 
> 赞同：0
> 
> 时间：2013-04-04T00:11:09.327
> 
> 标签：python, django, templates

我花了很长时间才弄清楚为什么模板没有被覆盖，只是发现似乎 Django 根本没有使用正确的优先级来覆盖模板。

我要更改的模板是用于更改用户密码的模板，这些模板是为 URL 加载的`/accounts/password/change`。

我有我修改过的模板`mysite/myapp/templates/registration`；系统默认模板位于`/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/admin/templates/registration`. 当这两个目录中都存在模板时，Django 使用系统 ( `/Library`) 模板。嗯？

当我删除 中的模板时，会加载`/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/contrib/admin/templates/registration` 正确的模板（即我的 in ）。`mysite/myapp/templates/registration`

如何解决这个问题？也就是说，如何让 Django 加载我覆盖的模板而不删除`/Library`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:25:16.653

您必须在模板目录中创建一个管理目录，在其中设置要覆盖的模板

> 为了覆盖其中的一个或多个，首先在项目的模板目录中创建一个管理目录。这可以是您在 TEMPLATE_DIRS 中指定的任何目录。

[在此处阅读 Django 文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#overriding-admin-templates)

# php - PHP中的preg_match拒绝服务

> ID：15800422
> 
> 赞同：-3
> 
> 时间：2013-04-04T00:11:14.577
> 
> 标签：php, preg-match, denial-of-service

我正在使用一个表单来输入正则表达式本身，然后在 preg_match 中使用这个正则表达式，所以我们不需要验证（可能只有长度），但我在谷歌上听到不同编程语言的“正则表达式拒绝服务”。

似乎没有提到PHP，
**PHP也可以吗！？**

**我还应该考虑在 java web 应用程序中使用正则表达式客户端，因为要匹配的数据在服务器端并不是真正需要的！？？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:38:56.403

首先，永远不要相信来自客户端的任何数据都是有效的。您甚至不能假设数据来自您网站的表单，或者用户正在使用浏览器与您的网站进行交互。因此，即使您在客户端进行了一些基本验证（例如检查长度），您也应该始终在服务器端进行验证。

根据这篇文章 PHP 也不例外：

[http://www.abemiester.com/abemiester/post/RegEx-DOS-attack-Regular-Expressions-Now-you-have-3-problems.aspx](http://www.abemiester.com/abemiester/post/RegEx-DOS-attack-Regular-Expressions-Now-you-have-3-problems.aspx)

您需要确保仔细编写正则表达式。本文还提到了“Regex Fuzzer”，这是一种查找有问题的正则表达式的方法。文章顶部的链接有更多相关信息。

编辑：微软已经建立了一个程序来测试易受攻击的正则表达式。它可以从这里获得：http: [//www.microsoft.com/en-us/download/details.aspx?id=20095](http://www.microsoft.com/en-us/download/details.aspx?id=20095) 我自己没有尝试过，但这可能会帮助您找到您的正则表达式的任何问题。

# android - 如何设置 CheckBox 或 RadioButton

> ID：15800424
> 
> 赞同：1
> 
> 时间：2013-04-04T00:11:21.577
> 
> 标签：android, android-widget

我查看了 CheckBox 的文档，我看到了这两种方法：

```
setEnabled(boolean)
setSelected(boolean) 
```

所以，在我的代码中，我把

```
CheckBox myCB = (CheckBox) findViewById(R.id.CheckBox);
myCB.setEnabled(true);
myCB.setSelected(true); 
```

当我运行代码时，我希望上面的 CheckBox 已经被选中并在 GUI 中“打开”。但事实并非如此。看起来它是未经检查的。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:14:41.450

使用`setChecked(boolean checked)`或`toggle()`代替。[在这里](http://developer.android.com/reference/android/widget/CheckBox.html)查看 CheckBox 的 javadoc 。

请注意，例如，`setSelected(boolean selected)`它是从 TextView 继承的，用于确定文本的呈现方式，而不是选中或取消选中 CheckBox。

# java - ArrayIndexOutOfBounds 在另一个类中运行时存在，但不是预期的

> ID：15800430
> 
> 赞同：0
> 
> 时间：2013-04-04T00:11:55.860
> 
> 标签：java

```
Random random = new Random();
int numDigits;
int[] secretNumber = new int[numDigits];

public int[] convertNumToDigitArray(String number){
    int[] numToDigitArray = new int[numDigits];
    for (int i = 0; i<number.length(); i++){
        numToDigitArray[i] = number.charAt(i);
    }
    return numToDigitArray;
}

public int getNumDigits(){
    return numDigits;
    }

public int[] getSecretNumber(){
    return secretNumber;
    }

public void setNumDigits(int numDigits){
    this.numDigits=numDigits;
}

public void generateNewSecret(){
    int number = random.nextInt(((int)Math.pow(10, numDigits) - ((int)Math.pow(10, numDigits-1)))) + ((int)Math.pow(10, numDigits-1));
    int temporary = numDigits;
    for (int i = 0; i < numDigits; i++){
        secretNumber[i] = (int)(number/(Math.pow(10, temporary--)));   //here's where the exception is thrown!
        if (number < 10)
            break;
        number = number%((int)(Math.pow(10, temporary--)));
        temporary--;  
        }
    } 
```

大家好，我遇到了一个问题，需要一些帮助。我已经编写（并且正在调试）一个程序，该程序生成一个数字，将该数字放入一个数组中，然后将用户猜测与该数字进行比较。我坚持的一点是，当计算机生成数字时，我放入的数组抛出了索引超出范围的异常。这一定意味着（据我所知）该指数低于零。但是当我单独运行程序并检查索引时，它从 0 开始。有问题的方法独立运行并生成数组而不抛出异常，但是当从“母程序”调用它时抛出异常。它指向代码中在循环中填充数组的行。

任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:15:04.513

您需要确保`numDigits`始终等于`secretNumber`数组中的元素数：

```
public void setNumDigits(int numDigits){
    this.numDigits=numDigits;
    // Add this line
    secretNumber = new int[numDigits];
} 
```

目前，您可以设置`numDigits`为高于数组大小的值。这可能导致`for`循环中的错误`secretDigits`受到`numDigits`.

# android-ndk - 如何使用 Guardian-ffmpeg-Android 的结果？

> ID：15800432
> 
> 赞同：2
> 
> 时间：2013-04-04T00:12:07.877
> 
> 标签：android-ndk, ffmpeg

我正在尝试在 Android 上构建 ffmpeg。有很多教程。有些已经很老了。所以我想尝试一个可以使用更新版本的ffmpeg和Android NDK的。找了好久，找到了一个，[guardianproject / android-ffmpeg](https://github.com/guardianproject/android-ffmpeg#readme)

该项目在几个月前进行了更新。使用 NDK r8。ffmpeg是网上放的，所以是最新版本。

在按照所有说明进行操作后，我很困惑应该使用哪个结果以及如何使用它。自述文件提到了测试，例如：

```
# embedding metadata into a matroska video /data/local/ffmpeg -y -i test.mp4 \
    -attach attach.txt -metadata:s:2 mimetype=text/plain \
    -acodec copy -vcodec copy testattach.mkv 
```

首先，我找不到路径：/data/local 其次，这是一个命令。我将如何在 Android 中使用它？

完全糊涂了。有光吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:00:45.133

我假设您已成功构建 ffmpeg 可执行文件并了解构建中静态库和共享库之间的区别。如果不是，您应该在尝试在 android 的 CLI 上执行它之前阅读它。

我认为作者在 cli 上使用 ffmpeg，使用 system.exec 或 processbuilder 技术在手机上的 ./data/local/$yourSubDir... 中运行和执行。

请参阅[此处](https://stackoverflow.com/questions/12472242/using-ffmpeg-via-command-line-in-android)以了解有关 android 中 cli 上的 ffmpeg 的讨论，并注意很多人更喜欢使用完整的 JNI 路由，使用 java 接口来包装对 ffmpeg.main() 的调用。IMO JNI 路由对于您打算分发的应用程序更加健壮。但它适用于cli。

让您感到困惑的测试只是使用 ffmpeg 的表达式，需要使用您喜欢的方法（ system.exec 或 processbuilder ）在 android 中调用。您可以通过在开发环境中的 windows/linux 中简单地运行 ffmpeg 来熟悉 cli 测试。在那里获取一个 shell 并使用 ffmpeg 常见问题解答中提到的示例。

您可以查看 git 上的 halfninja 项目以获取有关 JNI 方法的更多示例。

# sql-server - 更改 Windows Server 2008“区域和语言”> 格式设置是否对安装在其上的 SQL Server 2008 R2 数据库引擎有任何影响？

> ID：15800434
> 
> 赞同：1
> 
> 时间：2013-04-04T00:12:22.283
> 
> 标签：sql-server, windows, sql-server-2008-r2, windows-server-2008

我在[MSDN](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/4cc28f9e-9036-49aa-80d1-4148670c7266/)发现

> 数据库引擎不关心区域设置

但我还没有找到任何支持这一说法的文件。例如，它会改变它在 SSMS 中显示（或我编辑）日期、时间或货币的方式吗？

似乎不会，因为数据库中的日期与“格式”选项卡中显示的示例日期完全不同。但是，在不得不多次重新启动服务器（这对我来说很昂贵）之前，我想对此进行更多阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-18T22:12:53.737

正如 MSDN 中所述，一般的答案确实是否定的。

更准确地说，**它会改变它在 SSMS 中显示（或我编辑）日期、时间或货币的方式吗？**

再次，不。它与用户语言设置有关，如[this](https://stackoverflow.com/a/13845341/1863970) answer所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T11:46:45.377

在大多数情况下确实如此，因为操作系统的区域设置几乎适用于计算机系统上安装的所有应用程序，其中包括 SSMS。货币、日期格式等。虽然 SSMS 有自己的日期时间格式，但有时也取决于这些应用程序的配置与您的网络设置相关。

# java - 当框架在屏幕上移动时，鼠标不会保持其位置

> ID：15800436
> 
> 赞同：1
> 
> 时间：2013-04-04T00:12:31.657
> 
> 标签：java, awt, mouseevent, repaint, paintcomponent

这是代码。

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.MouseInfo;
import java.awt.Point;
import java.awt.PointerInfo;
import java.awt.Robot;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseMotionListener;

import javax.swing.JPanel;

public class Paint extends JPanel implements MouseMotionListener, MouseListener {

    public Paint() {        
        setBackground(Color.RED);
        addMouseMotionListener(this);
        addMouseListener(this);
    }

    private boolean clicked = false;

    public void paintComponent (Graphics g) {
        super.paintComponent(g);
        PointerInfo a = MouseInfo.getPointerInfo();
        Point b = a.getLocation();
        int x = (int) b.getX() - 3;
        int y = (int) b.getY() - 23;

        if (clicked) {
            g.drawLine(x, y-5000, x,y+5000);
            g.drawLine(x+5000,y,x-5000,y);
            g.setColor(Color.white);
        }

        g.drawLine(x, y-5000, x,y+5000);
        g.drawLine(x+5000,y,x-5000,y);
        g.setColor(Color.black);

        // . . .
    }

    @Override
    public void mouseDragged(MouseEvent e) {
        repaint();

    }

    @Override
    public void mouseMoved(MouseEvent e) {
        repaint();
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mouseEntered(MouseEvent e) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mouseExited(MouseEvent e) {
        // TODO Auto-generated method stub

    }

    @Override
    public void mousePressed(MouseEvent e) {
        clicked = true;
        repaint();

    }

    @Override
    public void mouseReleased(MouseEvent e) {
        clicked = false;
        repaint();

    }

}

public class Frame extends JFrame {

    public Frame() {
        this.setSize(500,500);
        this.setTitle("Test painting");
        this.setResizable(false);
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);

        Paint panel = new Paint();

        this.add(panel);

        this.setVisible(true);
    }

    public static void main (String[] args) {
        new Frame();

    }

} 
```

当我运行程序时，当应用程序处于默认位置时，它看起来工作正常，但是一旦我将小程序移动到屏幕上我喜欢的位置，这些行就不会保持屏幕上的当前鼠标位置。

有人可以告诉我哪里出了问题或如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:17:27.177

绘制是从组件的上下文中完成的。任何给定组件的`Graphics`上下文都会被转换，以便左上角为 0x0。

`MouseInfo.getPointerInfo().getLocation()`正在返回鼠标在屏幕上的位置，而不是相对于组件的位置。

虽然有一种方法可以修复它，但更好的解决方案是简单地使用 a`MouseMotionListener`代替。发送到这个`MouseEvent`方法的已经被翻译到了组件坐标空间...

```
public void mouseMoved(MouseEvent me) {
    myPoint = me.getPoint();
} 
```

然后在你的`paintComponent`方法中，简单的参考`myPoint`而不是尝试使用`MouseInfo`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:16:38.263

我认为您最好在 MouseAdapter 中更改您的类的状态，调用`repaint()`然后让您的`paintComponent(...)`方法使用此状态来帮助它绘制。这对我来说似乎比在`paintComponent(...)`.

除此之外，如果您需要更具体的帮助，请考虑

*   告诉我们更多关于您正在尝试做什么以及您的程序如何不工作的信息。
*   创建并发布一个[sscce](http://sscce.org)，一个小型可编译和可运行的程序，为我们演示您的问题。

# c++ - 使用复制构造函数且存在虚函数时出现“在所有控制路径上递归”错误

> ID：15800440
> 
> 赞同：5
> 
> 时间：2013-04-04T00:12:47.570
> 
> 标签：c++, templates, visual-c++, multiple-inheritance, virtual-functions

下面的错误让我感到困惑。这是一段更复杂的代码。对我来说很奇怪，只有模板化构造函数和虚拟方法的存在才会导致错误，并且只有在复制初始化对象时才会发生错误。

有人有想法吗？谢谢。

```
 class A
    {
      long *p;
    public:
      A():p(0)
      {
      }

      template<class T>
      A(T val):p(val)// 1
      {
      }

      operator long*()
      {
       return p;
      }
    };

    class B
    {
      virtual void f()// 2
      {
      }
    };

    class C : public A, public B
    {
    };

    void main()
    {
      C c; 
```

下一行`main()`是

```
 A a=c; 
```

`// 1`如果标记的行和`// 2`都存在，则会触发以下错误：

```
warning C4717: 'C::C' : recursive on all control paths, function will cause runtime stack overflow 
```

但是在 中使用以下内容时`main()`，没有错误：

```
 A a;
      a=c;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T00:56:09.560

您所拥有的是[复制省略](https://stackoverflow.com/questions/7607598/copy-elision-method)和制作参数副本的构造函数的令人讨厌的融合。

*首先，让我们*澄清一个误解：`A a = c;`不等于. 第一个调用复制ctor，第二个调用赋值运算符。[使用此代码示例](http://ideone.com/nwj040)亲自查看。*`A a; a = c;`*

 *构造函数可以在调用它时`A::A<T>(T)`制作副本。`T`不幸的是，如果您使用`A`参数（或在您的示例`C`中为-a `A`）调用它，则该参数将尝试复制自身，然后`A::A<T>(T)`再次调用，然后再次复制自身......直到堆栈溢出。

`virtual void f()`当您没有in时，为什么不会发生这种情况`B`？这是复制省略的副作用，它是一个依赖于实现的特性。拥有虚拟方法可能足以让视觉工作室决定不删除副本，但无论如何你不应该依赖它。这就是为什么[强烈建议您不要对复制 ctor 产生可观察到的副作用](http://en.cppreference.com/w/cpp/language/copy_elision)。

以防万一您正在寻找解决方案，您可以通过更改`A::A<T>(T)`以获取参考来删除副本，例如`A::A<T>(T&)`. 更好的是，采取 a`const T&`因为这有助于确保 ctor 中没有副作用（因为您无法修改`T`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T01:44:52.000

```
 A a=c; // this results in A::A(C c) template constructor instantiation. 
```

之后是递归，因为要复制，您需要复制，您需要复制.... :)

正确使用请参考[this](http://en.cppreference.com/w/cpp/language/copy_constructor)。*

# ios - 如何在 Core Data iOS 中序列化和反序列化 pdf？

> ID：15800442
> 
> 赞同：0
> 
> 时间：2013-04-04T00:12:54.233
> 
> 标签：ios, pdf, core-data

要序列化 ​​pdf，我相信您可以`NSData dataWithURL:`在 Core Data 中使用和存储。但是，我不确定您将如何反序列化回 pdf 并使用 UIWebView 查看它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T09:17:35.797

您可以使用`CGPDFDocumentCreateWithProvider`：

如果您的 NSData 参考是`pdfData`：

```
CFDataRef myPDFData        = (CFDataRef)pdfData;
CGDataProviderRef provider = CGDataProviderCreateWithCFData(myPDFData);
CGPDFDocumentRef pdf       = CGPDFDocumentCreateWithProvider(provider); 
```

但我想你只是想在 web 视图中显示它，而以上不是你需要的。

但是，如果您已经拥有 url，那么存储 URL 而不是存储 pdf 不是更容易。

此外，如果您有数据，您可以暂时将其写入文档目录中的文件，然后使用 Web 视图加载此 url。

IE;

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *appFile = [documentsDirectory stringByAppendingPathComponent:@"New1.pdf"];
NSURL *fileURL = [NSURLRequest requestWithURL:appFile];
[data writeToURL:fileURL atomically:YES]; 
```

进而 ：

```
NSURLRequest *request = [NSURLRequest requestWithURL:fileURL];
[webView loadRequest:request]; 
```

如果你想从文档目录中删除文件，你可以使用：

```
[[NSFileManager defaultManager] removeItemAtURL:fileUrl error:nil]; 
```

删除您创建的临时 pdf。

# iphone - 为 iPhone 应用创建华丽的介绍

> ID：15800443
> 
> 赞同：2
> 
> 时间：2013-04-04T00:12:55.100
> 
> 标签：iphone, ios, opengl-es

我将如何创建 AirBnB 在其应用程序中使用的介绍？他们创建的功能可以在这里找到[http://www.youtube.com/watch?v=E_RlPZYIpIY](http://www.youtube.com/watch?v=E_RlPZYIpIY)

他们是在使用 OpenGL，还是只是对 uiview 进行了一些花哨的操作？任何和所有的帮助将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T00:23:35.240

它绝对不是 OpenGL。它可能只是一堆`UIView`动画块或核心动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:26:56.907

它们基本上是[CGAffineTransformation](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGAffineTransform/Reference/reference.html)效果：平移、缩放、旋转……

不过OpenGL很贵。如果你只想要一些 2D 效果，Core Graphics Framework 就足够了。

# ruby-on-rails-3 - rake db：最近迁移的回滚挂起

> ID：15800447
> 
> 赞同：1
> 
> 时间：2013-04-04T00:13:45.793
> 
> 标签：ruby-on-rails-3

我有一个最初在 rail 3 中编写的 rails 应用程序，大约一个月前升级到 rails 3.1.10。我刚刚在故事和标签之间创建了一个 habtm 关联，以及相关的数据库迁移。

```
class Story < ActiveRecord::Base

  belongs_to    :user
  has_and_belongs_to_many :tags, :uniq => true

end 
```

* * *

```
class Tag < ActiveRecord::Base

    has_and_belongs_to_many :stories, :uniq => true

end 
```

* * *

```
class CreateTags < ActiveRecord::Migration
  def change
    create_table :tags do |t|
      t.string :name

      t.timestamps
    end
  end
end 
```

* * *

```
class CreateStoriesTags < ActiveRecord::Migration
  def change
    create_table :stories_tags, :id => false do |t|
      t.references :story, :tag
    end

    add_index :stories_tags, [:story_id, :tag_id]
  end
end 
```

最后，这是相关的 schema.db：

```
 create_table "stories", :force => true do |t|
    t.string   "title"
    t.integer  "user_id"
    t.datetime "created_at"
    t.datetime "updated_at"
  end

  add_index "stories", ["user_id"], :name => "index_stories_on_user_id"

  create_table "stories_tags", :id => false, :force => true do |t|
    t.integer "story_id"
    t.integer "tag_id"
  end

  add_index "stories_tags", ["story_id", "tag_id"], :name => "index_stories_tags_on_story_id_and_tag_id"

  create_table "tags", :force => true do |t|
    t.string   "name"
    t.datetime "created_at"
    t.datetime "updated_at"
  end 
```

我迁移了数据库，然后在控制台中使用了关联。现在我想回滚迁移，以便在标签表中添加一些额外的列。（我知道我可以简单地创建一个新的迁移，但我仍然想了解为什么我会遇到这个问题。）现在，当我插入`rake db:rollback`控制台时，这里是初始输出：

```
[nw0.0.1master (development)]$ rake db:rollback
==  CreateStoriesTags: reverting ==============================================
-- drop_table(:stories_tags) 
```

到目前为止一切顺利，但是 rake 任务只是挂起。. . 用了几个小时。如果我在这里按 ctrl-c 输出到控制台：

```
^Crake aborted!
An error has occurred, this and all later migrations canceled:

Interrupt: : ROLLBACK
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/postgresql_adapter.rb:605:in `async_exec'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/postgresql_adapter.rb:605:in `block in execute'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/abstract_adapter.rb:245:in `block in log'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activesupport-3.1.10/lib/active_support/notifications/instrumenter.rb:21:in `instrument'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/abstract_adapter.rb:240:in `log'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/postgresql_adapter.rb:604:in `execute'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/postgresql_adapter.rb:664:in `rollback_db_transaction'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/abstract/database_statements.rb:201:in `rescue in transaction'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/connection_adapters/abstract/database_statements.rb:182:in `transaction'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/transactions.rb:208:in `transaction'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:742:in `ddl_transaction'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:686:in `block in migrate'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:671:in `each'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:671:in `migrate'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:553:in `down'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:627:in `move'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/migration.rb:541:in `rollback'
/.rvm/gems/ruby-1.9.2-p290@rails3firstgemset/gems/activerecord-3.1.10/lib/active_record/railties/databases.rake:232:in `block (2 levels) in <top (required)>'
Tasks: TOP => db:rollback
(See full trace by running task with --trace) 
```

有几点需要注意，因为这个应用程序是从 rails 3.0 开始的，所有早期的迁移都使用旧的`Class.up Class.down`方法来定义迁移。此外，当我第一次遇到挂起时，我将 CreateStoriesTags 迁移切换为使用`up`和`down`实例方法，但一切仍然挂起。

更新和答案

我注意到 PGAdmin3 Workbench 也挂了。所以，我重新启动了 Mac，现在回滚正在工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:25:31.980

原来是我的数据库服务器有问题。一个简单的重启解决了问题

# css - 如何在 CSS 中启用缩放设置为 100% 宽度的图像？

> ID：15800449
> 
> 赞同：5
> 
> 时间：2013-04-03T17:55:01.143
> 
> 标签：css, image

即使在 CSS 中将它们设置为 100% 宽度，如何启用放大图像？

这个问题可能听起来很矛盾——如果你将某些东西设置为 100% 宽度

```
img {
    width: 100%;
    height: auto;
    padding: 0;
    border: 0;
    margin-bottom: 0.66em; 
```

你想要那样，不是吗？

嗯......想象一下：有一个图片库，你希望它是 100% 宽的。用户缩放，这只会缩放文本。无论缩放级别如何，图像都将继续保持 100%。

我想要的是这种行为：

图像在中性缩放级别为 100% 宽，但是当用户缩放页面时，图像也会被缩放，但是：图像被调整为始终为窗口的 100%，即使用户调整浏览器大小（如果在正常情况下飞涨）。

**是否有唯一的 CSS 解决方案？**

**使用 javascript 的可能解决方案**是将图像宽度设置为 javascript 中浏览器窗口的 px。缩放将按预期适用于图像。当用户调整浏览器大小时，javascript 必须再次更改图像的宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T18:28:26.700

**缩放行为取决于浏览器，甚至是可配置**的，取决于访问者使用的浏览器，行为是您所描述的或您已经想要的！

控制行为的唯一方法是自己实现缩放。Javascript 是一种方式，但请记住，*浏览器缩放*永远不受您的控制。出于可访问性的原因，它在那里。您自己的缩放将允许用户以另一种方式缩放您决定使脚本使用的任何元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T18:36:33.730

遗憾的是，这不能在没有 JavaScript 的情况下完成，因为您需要的功能是在他们悬停的 PX 上进行缩放...所以是的，您可以将其放大，但是当他们移动图像时图像不会改变如您所料，光标在图像上。您应该选择使用[jQuery](http://jquery.com/)或任何其他 JavaScript 库，例如[Mootools](http://mootools.net/)。

在 Google 上简单地搜索[jQuery Zoom 之类的东西](http://www.google.co.uk/search?q=jquery%20zoom)- 你会被预先制作的插件数量所淹没，以便让你轻松完成这项任务。

这是我发现满足您要求的两个：

*   [杰克摩尔 jQuery 缩放](http://www.jacklmoore.com/zoom/)
*   jQZoom -[示例 4](http://www.mind-projects.it/projects/jqzoom/demos.php#demo4)
*   Jquery Image Zoom Plugin -[内部缩放示例](http://www.elevateweb.co.uk/image-zoom/examples#inner-zoom)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-02T05:56:07.447

我遇到了同样的问题。

首先要指出的是，缩放仍然适用于移动设备。对于其他设备，您可以设置 min-width:100% 而不是宽度。这将使您放大但不能缩小。

另一种解决方案是使用媒体查询根据屏幕大小设置 px 宽度，例如：

```
@media only screen and (min-device-width:1440px)
@media only screen and (max-device-width:960px)
@media only screen and (min-device-width:768px)
@media only screen and (max-device-width: 550px)
@media only screen and (max-device-width:480px)
@media only screen and (max-device-width: 400px) 
```

谢谢！

# java - JPanel 在添加到容器时仅显示一个组件

> ID：15800452
> 
> 赞同：1
> 
> 时间：2013-04-04T00:13:55.530
> 
> 标签：java, swing, user-interface, jpanel

大家好，我对此有点问题。我创建了一个 JPanel 并向其中添加了组件，然后将 JPanel 添加到容器中。现在，当我从 main 调用这个类时，会弹出一个窗口，但它只显示 JPanel 的第一个组件。为什么它只显示第一项而不是全部？谢谢。

注意：此代码不完整，我只是想弄清楚为什么我的组件在继续其他事情之前没有显示，请解决组件问题。

```
import java.awt.BorderLayout;
import java.awt.CardLayout;
import java.awt.Container;
import java.awt.FlowLayout;
import java.awt.event.*;
import javax.swing.*;

public class Player extends JFrame implements ActionListener
{
       private CardLayout playerCard;
       private JPanel cardPanel;
       public String player1;
       public String player2;

      // Constructor:
      public Player()
      {

        setTitle("Game");
        setSize(300,200);
        setLocation(10,200); 
        Container contentPane = getContentPane();
        contentPane.setLayout(new FlowLayout());

                //set up the panel
        cardPanel = new JPanel();
        playerCard = new CardLayout();
        cardPanel.setLayout(playerCard);

                //get player one name
        JLabel p1Name = new JLabel("Player 1 Name:");
        JTextField oneName = new JTextField();

                //get the name for player 2
        JLabel p2Name = new JLabel("Player 2 Name:");
        JTextField twoName = new JTextField();

                //the button to start the game
        JButton start = new JButton("Start");

        //add the components << Why is only the first component shown??
        cardPanel.add(start);
        cardPanel.add(p1Name);
        cardPanel.add(oneName);
        cardPanel.add(p2Name);
        cardPanel.add(twoName);

        contentPane.add("startCard",cardPanel);
        }

    @Override
    public void actionPerformed(ActionEvent arg0) 
    {
        // TODO Auto-generated method stub

    } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:19:25.537

您没有正确使用布局。在使用组件向**CardLayout**添加组件时使用 String 常量，而不是使用组件的**FlowLayout**。并且 String 常量在 add 方法中的组件*之后。*请阅读布局管理器教程，因为那里已经很好地解释了这一切。看起来您在不应该使用的地方使用 CardLayout，这就是为什么您只看到一个组件的原因。换句话说，您的程序完全使用低音布局。

换句话说，使用 CardLayout 的容器一次只能显示一个组件，也就是说，由于 cardPanel 使用 CardLayout，它只能显示*一个*组件，这里的 twoName 可能是唯一显示的内容。

# java - Play Framework 2.1 (Java) eBean @Encrypted 注解错误

> ID：15800453
> 
> 赞同：3
> 
> 时间：2013-04-04T00:13:58.307
> 
> 标签：java, playframework, playframework-2.0, playframework-2.1, ebean

我正在尝试在数据库模型的 String 字段上使用 eBean @Encrypted 注释。该文档使它看起来很简单，但是对于使用内置 H2 内存数据库的以下示例标准代码，我在浏览器中遇到了一个非常模糊的运行时错误：

```
package models; 

import java.util.*; 
import javax.persistence.*; 
import play.db.ebean.*; 
import play.db.ebean.Model.Finder; 
import play.data.format.*; 
import play.data.validation.*; 
import com.avaje.ebean.*; 
import com.avaje.ebean.annotation.*; 

@Entity  
public class Test extends Model { 

 @Id 
 public Long id; 

 @Encrypted 
 public String identifier;

} 
```

产生以下与 @Encrypted 注释相关的运行时错误：

```
Unexpected exception
RuntimeException: Error reading annotations for models.Test
No source available, here is the exception stack trace:
->java.lang.RuntimeException: Error reading annotations for models.Test
     com.avaje.ebeaninternal.server.deploy.parse.ReadAnnotations.readInitial(ReadAnnotations.java:26)
     com.avaje.ebeaninternal.server.deploy.BeanDescriptorManager.createDeployBeanInfo(BeanDescriptorManager.java:1026)
     com.avaje.ebeaninternal.server.deploy.BeanDescriptorManager.readEntityDeploymentInitial(BeanDescriptorManager.java:533)
     com.avaje.ebeaninternal.server.deploy.BeanDescriptorManager.deploy(BeanDescriptorManager.java:250)
     com.avaje.ebeaninternal.server.core.InternalConfiguration.<init>(InternalConfiguration.java:124)
     com.avaje.ebeaninternal.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:210)
     com.avaje.ebeaninternal.server.core.DefaultServerFactory.createServer(DefaultServerFactory.java:64)
     com.avaje.ebean.EbeanServerFactory.create(EbeanServerFactory.java:59)
     play.db.ebean.EbeanPlugin.onStart(EbeanPlugin.java:79)
     play.api.Play$$anonfun$start$1$$anonfun$apply$mcV$sp$1.apply(Play.scala:63)
     play.api.Play$$anonfun$start$1$$anonfun$apply$mcV$sp$1.apply(Play.scala:63)
     scala.collection.immutable.List.foreach(List.scala:309)
     play.api.Play$$anonfun$start$1.apply$mcV$sp(Play.scala:63)
     play.api.Play$$anonfun$start$1.apply(Play.scala:63)
     play.api.Play$$anonfun$start$1.apply(Play.scala:63)
     play.utils.Threads$.withContextClassLoader(Threads.scala:18)
     play.api.Play$.start(Play.scala:62)
     play.core.ReloadableApplication$$anonfun$get$1$$anonfun$1.apply(ApplicationProvider.scala:133)
     play.core.ReloadableApplication$$anonfun$get$1$$anonfun$1.apply(ApplicationProvider.scala:106)
     scala.Option.map(Option.scala:145)
     play.core.ReloadableApplication$$anonfun$get$1.apply(ApplicationProvider.scala:106)
     play.core.ReloadableApplication$$anonfun$get$1.apply(ApplicationProvider.scala:104)
     scala.util.Either$RightProjection.flatMap(Either.scala:523)
     play.core.ReloadableApplication.get(ApplicationProvider.scala:104)
     play.core.server.Server$class.sendHandler$1(Server.scala:56)
     play.core.server.Server$$anonfun$getHandlerFor$4.apply(Server.scala:88)
     play.core.server.Server$$anonfun$getHandlerFor$4.apply(Server.scala:87)
     scala.util.Either$RightProjection.flatMap(Either.scala:523)
     play.core.server.Server$class.getHandlerFor(Server.scala:87)
     play.core.server.NettyServer.getHandlerFor(NettyServer.scala:34)
     play.core.server.netty.PlayDefaultUpstreamHandler.messageReceived(PlayDefaultUpstreamHandler.scala:103)
     org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)
     org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:565)
     org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:793)
     org.jboss.netty.handler.codec.http.HttpContentDecoder.messageReceived(HttpContentDecoder.java:104)
     org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)
     org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:565)
     org.jboss.netty.channel.DefaultChannelPipeline$DefaultChannelHandlerContext.sendUpstream(DefaultChannelPipeline.java:793)
     org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:296)
     org.jboss.netty.handler.codec.frame.FrameDecoder.unfoldAndFireMessageReceived(FrameDecoder.java:455)
     org.jboss.netty.handler.codec.replay.ReplayingDecoder.callDecode(ReplayingDecoder.java:538)
     org.jboss.netty.handler.codec.replay.ReplayingDecoder.messageReceived(ReplayingDecoder.java:437)
     org.jboss.netty.channel.SimpleChannelUpstreamHandler.handleUpstream(SimpleChannelUpstreamHandler.java:75)
     org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:565)
     org.jboss.netty.channel.DefaultChannelPipeline.sendUpstream(DefaultChannelPipeline.java:560)
     org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:268)
     org.jboss.netty.channel.Channels.fireMessageReceived(Channels.java:255)
     org.jboss.netty.channel.socket.nio.NioWorker.read(NioWorker.java:84)
     org.jboss.netty.channel.socket.nio.AbstractNioWorker.processSelectedKeys(AbstractNioWorker.java:472)
     org.jboss.netty.channel.socket.nio.AbstractNioWorker.run(AbstractNioWorker.java:333)
     org.jboss.netty.channel.socket.nio.NioWorker.run(NioWorker.java:35)
     org.jboss.netty.util.ThreadRenamingRunnable.run(ThreadRenamingRunnable.java:102)
     org.jboss.netty.util.internal.DeadLockProofWorker$1.run(DeadLockProofWorker.java:42)
     java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
     java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
     java.lang.Thread.run(Thread.java:722) 
```

我在配置中正确配置了 encryptionKeyManager 设置（ebean.encryptKeyManager="com.avaje.tests.basic.encrypt.BasicEncyptKeyManager"）。一切都编译得很好，没有任何问题甚至警告。

我什至尝试在项目中手动添加 eBean 2.7.1 作为依赖项，但无济于事。

知道这意味着什么以及为什么我会收到此错误吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T16:04:14.313

我相信我可能已经解决了这个问题，但是是以一种非常迂回的方式。问题是，Play 框架无法解析 EBean 包中的 BasicEncryptKeyManager 类。我在查看整个堆栈跟踪时发现了这一点，因为我看到消息“未定义 EncryptKeyManager”，即使我在设置文件（application.conf、ebean.conf、ebean.properties - 你的名字）中明确指定了它它，我试过了）根据官方文档。

**因此，我必须使用如下所示的ServerConfigStartup**从头开始​​创建自己的（请注意，这只是一个快速而肮脏的示例，可能不是最安全或最有效的方法）：

```
package models;
import com.avaje.ebean.config.ServerConfig;     
import com.avaje.ebean.event.ServerConfigStartup;     
import com.avaje.ebean.config.EncryptKey;       
import com.avaje.ebean.config.EncryptKeyManager; 

public class CustomServerConfigStartup implements ServerConfigStartup { 

    @Override 
    public void onStart(ServerConfig serverConfig) {     
          serverConfig.setEncryptKeyManager(new BasicEncryptKeyManager());     
    }     
} 

class BasicEncryptKeyManager implements EncryptKeyManager{ 

 @Override 
 public EncryptKey getEncryptKey(String tableName, String columnName) {     
       return new CustomEncryptKey(tableName, columnName);     
 } 

 @Override 
 public void initialise() { 
     //Do nothing (yet)
 } 

} 

class CustomEncryptKey implements EncryptKey{ 

   private String tableName;

   private String columnName;

   public CustomEncryptKey(String tableName, String columnName){
      this.tableName = tableName;
      this.columnName = columnName;
   }

 @Override 
 public String getStringValue() {     
        return play.Configuration.root().getString("application.secret") + "::" + this.tableName + "::" + this.columnName;      
 }     
} 
```

然后在Play 应用程序的 conf 目录下的**application.conf**或**ebean.properties**文件中（不过这一步可能是多余的）：

```
ebean.encryptKeyManager="models.BasicEncryptKeyManager" 
```

这似乎解决了 @Encrypted 注释错误。在未来的某个版本中，Play 似乎必须在 Ebean 的实际框架中合并一个可访问的 EncryptionKeyManager 类，以避免这种解决方法。

# angularjs - AngularJS：绑定到服务属性的正确方法

> ID：15800454
> 
> 赞同：164
> 
> 时间：2013-04-04T00:14:00.800
> 
> 标签：angularjs, data-binding, angularjs-service, angularjs-controller

我正在寻找如何在 AngularJS 中绑定到服务属性的最佳实践。

我已经通过多个示例来了解如何绑定到使用 AngularJS 创建的服务中的属性。

下面我有两个示例说明如何绑定到服务中的属性；他们都工作。第一个示例使用基本绑定，第二个示例使用 $scope.$watch 绑定到服务属性

在绑定到服务中的属性时是否首选这些示例中的任何一个，或者是否有另一个我不知道的选项会被推荐？

这些示例的前提是服务应每 5 秒更新其属性“lastUpdated”和“calls”。更新服务属性后，视图应反映这些更改。这两个例子都成功地工作了；我想知道是否有更好的方法来做到这一点。

**基本绑定**

可以在此处查看和运行以下代码：http: [//plnkr.co/edit/d3c16z](http://plnkr.co/edit/d3c16z)

```
<html>
<body ng-app="ServiceNotification" >

    <div ng-controller="TimerCtrl1" style="border-style:dotted"> 
        TimerCtrl1 <br/>
        Last Updated: {{timerData.lastUpdated}}<br/>
        Last Updated: {{timerData.calls}}<br/>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.js"></script>
    <script type="text/javascript">
        var app = angular.module("ServiceNotification", []);

        function TimerCtrl1($scope, Timer) {
            $scope.timerData = Timer.data;
        };

        app.factory("Timer", function ($timeout) {
            var data = { lastUpdated: new Date(), calls: 0 };

            var updateTimer = function () {
                data.lastUpdated = new Date();
                data.calls += 1;
                console.log("updateTimer: " + data.lastUpdated);

                $timeout(updateTimer, 5000);
            };
            updateTimer();

            return {
                data: data
            };
        });
    </script>
</body>
</html> 
```

我解决绑定到服务属性的另一种方法是在控制器中使用 $scope.$watch。

**$scope.$watch**

可以在此处查看和运行以下代码：http: [//plnkr.co/edit/dSBlC9](http://plnkr.co/edit/dSBlC9)

```
<html>
<body ng-app="ServiceNotification">
    <div style="border-style:dotted" ng-controller="TimerCtrl1">
        TimerCtrl1<br/>
        Last Updated: {{lastUpdated}}<br/>
        Last Updated: {{calls}}<br/>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.js"></script>
    <script type="text/javascript">
        var app = angular.module("ServiceNotification", []);

        function TimerCtrl1($scope, Timer) {
            $scope.$watch(function () { return Timer.data.lastUpdated; },
                function (value) {
                    console.log("In $watch - lastUpdated:" + value);
                    $scope.lastUpdated = value;
                }
            );

            $scope.$watch(function () { return Timer.data.calls; },
                function (value) {
                    console.log("In $watch - calls:" + value);
                    $scope.calls = value;
                }
            );
        };

        app.factory("Timer", function ($timeout) {
            var data = { lastUpdated: new Date(), calls: 0 };

            var updateTimer = function () {
                data.lastUpdated = new Date();
                data.calls += 1;
                console.log("updateTimer: " + data.lastUpdated);

                $timeout(updateTimer, 5000);
            };
            updateTimer();

            return {
                data: data
            };
        });
    </script>
</body>
</html> 
```

我知道我可以在服务中使用 $rootscope.$broadcast 并在控制器中使用 $root.$on ，但是在我创建的其他示例中，在第一次广播中使用 $broadcast/$ 不会被控制器，但在控制器中触发了广播的其他调用。如果您知道解决 $rootscope.$broadcast 问题的方法，请提供答案。

但是为了重申我之前提到的内容，我想知道如何绑定到服务属性的最佳实践。

* * *

**更新**

这个问题最初是在 2013 年 4 月提出并回答的。2014 年 5 月，Gil Birman 提供了一个新答案，我将其更改为正确答案。由于 Gil Birman 的回答几乎没有赞成票，我担心阅读这个问题的人会无视他的回答，转而支持更多投票的其他答案。在您决定最佳答案之前，我强烈推荐 Gil Birman 的答案。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2014-05-21T05:40:29.430

考虑**第二种方法的一些优点和缺点**：

*   **0** `{{lastUpdated}}`而不是`{{timerData.lastUpdated}}`，这可能很容易`{{timer.lastUpdated}}`，我可能会认为它更具可读性（但我们不要争论......我给这一点一个中性评级，所以你自己决定）

*   **+1**控制器充当标记的一种API可能很方便，这样如果数据模型的结构发生某种变化，您可以（理论上）更新控制器的*API映射*而不接触html部分。

*   **-1**但是，理论并不总是实践，*无论如何，我通常发现自己必须在需要更改时修改标记**和*控制器逻辑。因此，编写 API 的额外努力抵消了它的优势。

**   **-1**此外，这种方法不是很干燥。

    *   **-1**如果您想将数据绑定到`ng-model`您的代码变得更不干燥，因为您必须在控制器中重新打包`$scope.scalar_values`以进行新的 REST 调用。

    *   **-0.1**创建额外的观察者对性能的影响很小。此外，如果将数据属性附加到不需要在特定控制器中观察的模型，它们将为深度观察者创建额外的开销。

    *   **-1**如果多个控制器需要相同的数据模型怎么办？这意味着您有多个 API 可以随着每次模型更改而更新。* 

 *`$scope.timerData = Timer.data;`现在开始听起来很诱人...让我们更深入地研究最后一点...我们在谈论什么样的模型更改？后端（服务器）上的模型？还是仅在前端创建并存在的模型？无论哪种情况，*数据映射 API*本质上属于*前端服务层*（角度工厂或服务）。*（请注意，您的第一个示例——我的偏好——在服务层*中没有这样的 API ，这很好，因为它很简单，不需要它。）

**总之**，一切都不必解耦。就将标记完全与数据模型分离而言，弊大于利。

* * *

**控制器，一般**不应该乱扔`$scope = injectable.data.scalar`'s. 相反，它们应该撒上`$scope = injectable.data`'s，`promise.then(..)`'s和`$scope.complexClickAction = function() {..}`'s

作为实现数据解耦和视图封装的另一种方法，**将视图与模型解耦真正有意义**的唯一地方是**使用指令**。但即使在那里，也不要在or函数`$watch`中标量值。这不会节省时间或使代码更易于维护和阅读。它甚至不会使测试更容易，因为*Angular 中的健壮测试通常会测试生成的 DOM*。相反，在指令中要求您的*数据 API*采用对象形式，并倾向于仅使用由.`controller``link`**`$watch``ng-bind`**

 *** * *

示例 [http://plnkr.co/edit/MVeU1GKRTN4bqA3h9Yio](http://plnkr.co/edit/MVeU1GKRTN4bqA3h9Yio)

```
<body ng-app="ServiceNotification">
    <div style="border-style:dotted" ng-controller="TimerCtrl1">
        TimerCtrl1<br/>
        Bad:<br/>
        Last Updated: {{lastUpdated}}<br/>
        Last Updated: {{calls}}<br/>
        Good:<br/>
        Last Updated: {{data.lastUpdated}}<br/>
        Last Updated: {{data.calls}}<br/>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.js"></script>
    <script type="text/javascript">
        var app = angular.module("ServiceNotification", []);

        function TimerCtrl1($scope, Timer) {
            $scope.data = Timer.data;
            $scope.lastUpdated = Timer.data.lastUpdated;
            $scope.calls = Timer.data.calls;
        };

        app.factory("Timer", function ($timeout) {
            var data = { lastUpdated: new Date(), calls: 0 };

            var updateTimer = function () {
                data.lastUpdated = new Date();
                data.calls += 1;
                console.log("updateTimer: " + data.lastUpdated);

                $timeout(updateTimer, 500);
            };
            updateTimer();

            return {
                data: data
            };
        });
    </script>
</body> 
```

* * *

**更新**：我终于回到这个问题来补充一点，我认为这两种方法都不是“错误的”。最初我写过 Josh David Miller 的回答是不正确的，但回想起来他的观点是完全正确的，尤其是他关于关注点分离的观点。

除了关注点分离（但切线相关）之外，还有另一个我没有考虑到的*防御性复制的原因。*这个问题主要涉及直接从服务中读取数据。但是，如果您团队中的开发人员决定控制器需要在视图显示之前以某种简单的方式转换数据怎么办？（控制器是否应该转换数据是另一个讨论。）如果她不首先制作对象的副本，她可能会无意中在另一个使用相同数据的视图组件中导致回归。

这个问题真正突出的是典型 Angular 应用程序（实际上是任何 JavaScript 应用程序）的架构缺点：关注点的紧密耦合和对象可变性。我最近迷上了使用 React*和*不可变数据结构构建应用程序。这样做很好地解决了以下两个问题：

1.  **关注点分离**：组件通过 props 使用它的所有数据，并且几乎不依赖全局单例（例如 Angular 服务），并且对视图层次结构中它*上面*发生的事情一无所知。

2.  **可变性**：所有道具都是不可变的，这消除了不知情的数据突变的风险。

Angular 2.0 现在有望大量借鉴 React 来实现上述两点。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-04-04T00:22:31.360

从我的角度来看，`$watch`这将是最佳实践方式。

您实际上可以稍微简化您的示例：

```
function TimerCtrl1($scope, Timer) {
  $scope.$watch( function () { return Timer.data; }, function (data) {
    $scope.lastUpdated = data.lastUpdated;
    $scope.calls = data.calls;
  }, true);
} 
```

这就是你所需要的。

由于属性是同时更新的，因此您只需要一只手表。此外，由于它们来自一个相当小的对象，我将其更改为仅查看`Timer.data`属性。传递给它的最后一个参数`$watch`告诉它检查深度相等，而不仅仅是确保引用相同。

* * *

为了提供一点上下文，我更喜欢这种方法而不是将服务值直接放在作用域上的原因是为了确保适当地分离关注点。您的视图不应该需要了解有关您的服务的任何信息即可运行。控制器的工作是将所有东西粘合在一起；它的工作是从您的服务中获取数据并以任何必要的方式处理它们，然后为您的视图提供所需的任何细节。但我不认为它的工作只是将服务传递给视图。否则，控制器甚至在那里做什么？当 AngularJS 开发人员选择不在模板中包含任何“逻辑”（例如`if`语句）时，他们遵循了相同的推理。

公平地说，这里可能有多种观点，我期待其他答案。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2016-04-06T03:37:07.153

派对迟到了，但对于未来的 Google 员工 - 不要使用提供的答案。

JavaScript 有一种通过引用传递对象的机制，而它只传递值“数字、字符串等”的浅拷贝。

**在上面的例子中，我们为什么不将服务暴露给范围**，而不是绑定服务的属性呢？

 **```
$scope.hello = HelloService; 
```

这种简单的方法将使 Angular 能够进行双向绑定以及您需要的所有神奇事物。不要用观察者或不需要的标记来破解你的控制器。

如果您担心您的视图会意外覆盖您的服务属性，请使用`defineProperty`使其可读、可枚举、可配置或定义 getter 和 setter。通过使您的服务更加可靠，您可以获得大量控制权。

最后提示：如果您花时间在控制器上而不是服务上，那么您做错了:(。

在您提供的特定演示代码中，我建议您这样做：

```
 function TimerCtrl1($scope, Timer) {
   $scope.timer = Timer;
 }
///Inside view
{{ timer.time_updated }}
{{ timer.other_property }}
etc... 
```

**编辑：**

正如我上面提到的，您可以使用控制服务属性的行为**`defineProperty`**

例子：

```
// Lets expose a property named "propertyWithSetter" on our service
// and hook a setter function that automatically saves new value to db !
Object.defineProperty(self, 'propertyWithSetter', {
  get: function() { return self.data.variable; },
  set: function(newValue) { 
         self.data.variable = newValue; 
         // let's update the database too to reflect changes in data-model !
         self.updateDatabaseWithNewData(data);
       },
  enumerable: true,
  configurable: true
}); 
```

现在在我们的控制器中，如果我们这样做

```
$scope.hello = HelloService;
$scope.hello.propertyWithSetter = 'NEW VALUE'; 
```

我们的服务将以`propertyWithSetter`某种方式更改值并将新值发布到数据库！

或者我们可以采取任何我们想要的方法。

请参阅[MDN 文档](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty)以获取`defineProperty`.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-05-08T21:52:27.820

我认为这个问题有一个上下文成分。

如果您只是从服务中提取数据并将该信息辐射到它的视图，我认为直接绑定到服务属性就可以了。我不想编写[大量样板代码](http://plnkr.co/edit/rKaXeo?p=preview)来简单地将服务属性映射到模型属性以在我的视图中使用。

此外，角度的性能基于两件事。第一个是页面上有多少绑定。第二个是 getter 函数的成本。[米斯科在这里](http://www.youtube.com/watch?v=ZhfUv0spHCY&t=49m51s)谈论这个

如果您需要对服务数据执行特定于实例的逻辑（而不是在服务本身内应用数据按摩），并且其结果会影响暴露给视图的数据模型，那么我会说 $watcher 是合适的，因为只要该功能不是非常昂贵。对于昂贵的函数，我建议将结果缓存在本地（到控制器）变量中，在 $watcher 函数之外执行复杂的操作，然后将范围绑定到结果。

需要注意的是，您不应该将**任何**属性直接挂在 $scope 上。该`$scope`变量不是您的模型。它引用了您的模型。

在我看来，简单地将信息从服务辐射到视图的“最佳实践”：

```
function TimerCtrl1($scope, Timer) {
  $scope.model = {timerData: Timer.data};
}; 
```

然后您的视图将包含`{{model.timerData.lastupdated}}`.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-06-26T09:29:15.490

基于上面的示例，我想我会采用一种透明地将控制器变量绑定到服务变量的方式。

在下面的示例中，对 Controller`$scope.count`变量的更改将自动反映在 Service`count`变量中。

在生产环境中，我们实际上使用 this 绑定来更新服务上的 id，然后异步获取数据并更新其服务变量。进一步的绑定意味着控制器会在服务自身更新时自动更新。

下面的代码可以在[http://jsfiddle.net/xuUHS/163/上看到](http://jsfiddle.net/xuUHS/163/)

看法：

```
<div ng-controller="ServiceCtrl">
    <p> This is my countService variable : {{count}}</p>
    <input type="number" ng-model="count">
    <p> This is my updated after click variable : {{countS}}</p>

    <button ng-click="clickC()" >Controller ++ </button>
    <button ng-click="chkC()" >Check Controller Count</button>
    </br>

    <button ng-click="clickS()" >Service ++ </button>
    <button ng-click="chkS()" >Check Service Count</button>
</div> 
```

服务/控制器：

```
var app = angular.module('myApp', []);

app.service('testService', function(){
    var count = 10;

    function incrementCount() {
      count++;
      return count;
    };

    function getCount() { return count; }

    return {
        get count() { return count },
        set count(val) {
            count = val;
        },
        getCount: getCount,
        incrementCount: incrementCount
    }

});

function ServiceCtrl($scope, testService)
{

    Object.defineProperty($scope, 'count', {
        get: function() { return testService.count; },
        set: function(val) { testService.count = val; },
    });

    $scope.clickC = function () {
       $scope.count++;
    };
    $scope.chkC = function () {
        alert($scope.count);
    };

    $scope.clickS = function () {
       ++testService.count;
    };
    $scope.chkS = function () {
        alert(testService.count);
    };

} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-12-17T07:32:40.167

我认为这是**绑定服务本身**而不是绑定属性的更好方法。

原因如下：

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.7/angular.min.js"></script>
<body ng-app="BindToService">

  <div ng-controller="BindToServiceCtrl as ctrl">
    ArrService.arrOne: <span ng-repeat="v in ArrService.arrOne">{{v}}</span>
    <br />
    ArrService.arrTwo: <span ng-repeat="v in ArrService.arrTwo">{{v}}</span>
    <br />
    <br />
    <!-- This is empty since $scope.arrOne never changes -->
    arrOne: <span ng-repeat="v in arrOne">{{v}}</span>
    <br />
    <!-- This is not empty since $scope.arrTwo === ArrService.arrTwo -->
    <!-- Both of them point the memory space modified by the `push` function below -->
    arrTwo: <span ng-repeat="v in arrTwo">{{v}}</span>
  </div>

  <script type="text/javascript">
    var app = angular.module("BindToService", []);

    app.controller("BindToServiceCtrl", function ($scope, ArrService) {
      $scope.ArrService = ArrService;
      $scope.arrOne = ArrService.arrOne;
      $scope.arrTwo = ArrService.arrTwo;
    });

    app.service("ArrService", function ($interval) {
      var that = this,
          i = 0;
      this.arrOne = [];
      that.arrTwo = [];

      $interval(function () {
        // This will change arrOne (the pointer).
        // However, $scope.arrOne is still same as the original arrOne.
        that.arrOne = that.arrOne.concat([i]);

        // This line changes the memory block pointed by arrTwo.
        // And arrTwo (the pointer) itself never changes.
        that.arrTwo.push(i);
        i += 1;
      }, 1000);

    });
  </script>
</body> 
```

你可以在[这个 plunker](http://plnkr.co/edit/d4QOZk?p=preview)上玩它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-04-12T09:34:23.780

我宁愿让我的观察者尽可能少。我的理由是基于我的经验，人们可能会在理论上争论它。
使用观察者的问题是您可以使用范围内的任何属性来调用您喜欢的任何组件或服务中的任何方法。
在一个真实世界的项目中，很快你就会得到一个*不可追踪的*（更好的说是难以追踪的）方法链被调用和值被改变，这特别使入职过程变得悲惨。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-11T16:09:31.653

绑定任何发送服务的数据不是一个好主意（架构），但如果你需要它，我建议你有两种方法来做到这一点

1）您可以获取不在服务内部的数据。您可以在控制器/指令内部获取数据，并且将其绑定到任何地方都不会有问题

2）您可以使用angularjs事件。无论何时，您都可以发送信号（来自$rootScope）并在任何您想要的地方捕获它。您甚至可以发送关于该事件名称的数据。

也许这可以帮助你。如果您需要更多示例，这里是链接

[http://www.w3docs.com/snippets/angularjs/bind-value-between-service-and-controller-directive.html](http://www.w3docs.com/snippets/angularjs/bind-value-between-service-and-controller-directive.html)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-12-23T17:42:08.677

关于什么

```
scope = _.extend(scope, ParentScope); 
```

ParentScope 在哪里是注入服务？

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2015-02-10T03:09:53.970

# 最优雅的解决方案...

```
app.service('svc', function(){ this.attr = []; return this; });
app.controller('ctrl', function($scope, svc){
    $scope.attr = svc.attr || [];
    $scope.$watch('attr', function(neo, old){ /* if necessary */ });
});
app.run(function($rootScope, svc){
    $rootScope.svc = svc;
    $rootScope.$watch('svc', function(neo, old){ /* change the world */ });
}); 
```

此外，我编写 EDA（事件驱动架构），所以我倾向于做类似以下的事情[过度简化的版本]：

```
var Service = function Service($rootScope) {
    var $scope = $rootScope.$new(this);
    $scope.that = [];
    $scope.$watch('that', thatObserver, true);
    function thatObserver(what) {
        $scope.$broadcast('that:changed', what);
    }
}; 
```

然后，我在所需通道上的控制器中放置了一个侦听器，并以这种方式使我的本地范围保持最新。

总之，只要您保持稳定并采用弱耦合，就没有太多的“最佳实践”——相反，它*主要是偏好。*我提倡后一种代码的原因是因为 EDA 在本质上具有*最低的耦合度。*如果你不太关心这个事实，让我们避免一起做同一个项目。

希望这可以帮助...*****

# php - 在 PHP 中调试 SOAP 调用：由于客户端数据引发了异常

> ID：15800458
> 
> 赞同：4
> 
> 时间：2013-04-04T00:14:33.920
> 
> 标签：php, api, soap, wsdl

我正在使用 UPS api 并且很难调试。我得到以下堆栈跟踪：

```
Details
Type: SoapFault
Message: An exception has been raised as a result of client data.
File: /Users/shawn/Documents/work/sites/Wingspan/kaleco/lib/SixString/Utilities/Ups.php
Line: 161
Trace

#0 /Users/shawn/Documents/work/sites/Wingspan/kaleco/lib/SixString/Utilities/Ups.php(161): SoapClient->__soapCall('ProcessShipment', Array)
#1 /Users/shawn/Documents/work/sites/Wingspan/kaleco/routes/ups.php(14): SixString\Utilities\Ups->getShipment()
#2 [internal function]: {closure}()
#3 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Router.php(172): call_user_func_array(Object(Closure), Array)
#4 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Slim.php(1222): Slim\Router->dispatch(Object(Slim\Route))
#5 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Middleware/Flash.php(86): Slim\Slim->call()
#6 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Middleware/MethodOverride.php(94): Slim\Middleware\Flash->call()
#7 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Middleware/SessionCookie.php(116): Slim\Middleware\MethodOverride->call()
#8 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Middleware/PrettyExceptions.php(67): Slim\Middleware\SessionCookie->call()
#9 /Users/shawn/Documents/work/sites/Wingspan/kaleco/vendor/slim/slim/Slim/Slim.php(1174): Slim\Middleware\PrettyExceptions->call()
#10 /Users/shawn/Documents/work/sites/Wingspan/kaleco/public/index.php(6): Slim\Slim->run()
#11 {main} 
```

这是代码块：

```
 try{
        $mode = array('soap_version' => 'SOAP_1_1',  'trace' => 1,'exceptions' => true );
        $client = new \SoapClient($wsdl , $mode);
        $client->__setLocation($endpointurl);

        $header = new \SoapHeader('http://www.ups.com/XMLSchema/XOLTWS/UPSS/v1.0','UPSSecurity',$this->upss);
        $client->__setSoapHeaders($header);

        if(strcmp($operation,"ProcessShipment") == 0 ) {
            $resp = $client->__soapCall('ProcessShipment',array($this->processShipment()));
            echo "Response Status: " . $resp->Response->ResponseStatus->Description ."\n";
            //print_r($client->__getLastRequest());
        }
        else if (strcmp($operation , "ProcessShipConfirm") == 0) {
            $resp = $client->__soapCall('ProcessShipConfirm',array($this->processShipConfirm()));
            echo "Response Status: " . $resp->Response->ResponseStatus->Description ."\n";
        }
        else {
            $resp = $client->__soapCall('ProcessShipeAccept',array($this->processShipAccept()));
            //get status
            echo "Response Status: " . $resp->Response->ResponseStatus->Description ."\n";
            echo "<pre>";
            print_r($resp);
            echo "</pre>";
        }
    }
    catch(Exception $ex){
        print_r ($ex);
    } 
```

第 161 行在上面的代码中，这是实际的行：

```
$resp = $client->__soapCall('ProcessShipConfirm',array($this->processShipConfirm())); 
```

我正在寻找一种调试方法。它似乎没有到达`catch`障碍，我似乎无法确定异常的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-02-23T10:53:08.330

尝试捕获异常`SoapFault`并打印其`detail`属性。

```
try {

   $response = $client->$call( $params );

} catch (\SoapFault $fault) {

    //trigger_error("SOAP Fault: (faultcode: {$fault->faultcode}, faultstring: {$fault->faultstring})", E_USER_ERROR);
    var_dump($fault->faultcode);
    var_dump($fault->faultstring);
    var_dump($fault->detail);
    die('Errore chiamata webservice UPS');

} 
```

参考： http: [//php.net/manual/en/function.is-soap-fault.php](http://php.net/manual/en/function.is-soap-fault.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-15T14:44:29.273

注意：对于它的价值，**UPS 会为错误的跟踪号码提供此错误**。使用一个好的（有效的）跟踪号，它纠正了我的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-04T20:47:42.220

我不知道 PHP 中异常处理的细微差别，但 Soap 异常也是 C# 中的小虫子。在 Visual Studio 的调试器中，您可以直接在 IDE 中获取未处理异常的详细信息。如果您可以选择执行此操作，请查找异常的`"detail"`XML 元素，因为这将包含 Web 服务的消息，告诉您您的请求有什么问题。

至于实际捕获异常，@Jeff Atwood 有一篇古老但很好的文章——尽管是为（喘气）VB.NET 编写的——可能仍然可以提供一些关于导致 Soap 异常的原因的一些见解，呃......滑：[编码恐怖 | 抛出更好的 SOAP 异常](http://www.codinghorror.com/blog/2004/08/throwing-better-soap-exceptions.html "在编码恐怖")

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-05T12:55:28.543

对于 Rates API 中的错误 ShipFrom/CountryCode 或 ShipTo/CountryCode，UPS 也会给出此错误。例如，德国无法评级。这在 UPS 开发文档中找不到。

# r - tol 参数在 QR 分解中的作用

> ID：15800463
> 
> 赞同：3
> 
> 时间：2013-04-04T00:14:52.047
> 
> 标签：r

我是 R 的新用户。你能告诉我或介绍一些描述`tol`在 R 中计算 QR 分解的论点的参考吗？

例如，这两行有什么区别：

```
qr(A, tol=1e-07) #Doesn't work

qr(A, tol=1e-20) #Works 
```

为什么我用这么小的值得到我想要的结果`tol`，但没有更大的值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T00:37:28.893

该`tol`参数`qr`根据列是否被判断为线性相关来控制是否为列返回值。我认为将`tol`值降低到 1e-16 以下会违背该检查的目的。（这几乎是双精度数学中零的实用定义。）

先看`qr.default`再找FORTRAN代码：

[http://svn.r-project.org/R/trunk/src/appl/dqrdc2.f](http://svn.r-project.org/R/trunk/src/appl/dqrdc2.f)

这是描述逻辑的 FORTRAN 例程的注释：

```
c     cycle the columns from l to p left-to-right until one
c     with non-negligible norm is located.  a column is considered
c     to have become negligible if its norm has fallen below
c     tol times its original norm.  the check for l .le. k
c     avoids infinite cycling. 
```

# entity-framework - 实体框架 dbcontext.SaveChanges() 给出除以零错误

> ID：15800464
> 
> 赞同：0
> 
> 时间：2013-04-04T00:14:57.023
> 
> 标签：entity-framework

我担心我错过了显而易见的事情。下面的代码在 SaveChanges() 上产生除以零错误。我几乎到处寻找可能的原因，但找不到。有人可以指出我正确的方向。

谢谢

```
Public Sub AddDetailRecords()
    Dim products As List(Of Product)

    'code that builds a list of products

    For Each prd In products
        Dim eqDetail As New EmployeeQuoteDetail
        Dim rateRec As Rate = RateRecord(prd)

        eqDetail = DetailRecordForProduct(prd, eqDetail)
        eqDetail.netRate = rateRec.rate1
        eqDetail.ratePer = rateRec.ratePer

        db.EmployeeQuoteDetail.Add(eqDetail)
    Next
    db.SaveChanges()
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-02T05:56:23.227

计算字段之一可能是`DivideByZeroException`您在实体框架执行的数据库提交期间看到的异常的根本原因。请确保任何此类字段不会导致表达式被零除。在那之后你应该很好。

# html - CSS 字体渲染问题

> ID：15800467
> 
> 赞同：3
> 
> 时间：2013-04-04T00:15:16.640
> 
> 标签：html, css, font-face, webfonts

我正在开发一个网站。我正在使用谷歌字体来设置我的页面样式。但它没有正确显示。我已经阅读了一些关于人造字体的内容，但我相信这仅适用于未提供所需字体的情况。我已经导入了我的谷歌字体，代码是

```
@font-face {
    font-family: 'Titillium Web';
    font-style: normal;
    font-weight: 600;
    src: local('Titillium WebSemiBold'), local('TitilliumWeb-SemiBold'), url(http://themes.googleusercontent.com/static/fonts/titilliumweb/v1/anMUvcNT0H1YN4FII8wprx7IBmrqA5IG9z8WNe77b9o.woff) format('woff');
} 
```

我的字体CSS是

```
font-size:30px;
font-family: 'Titillium Web';
font-style: normal;
font-weight: 600; 
```

但我相信它显示的是人造字体。这是左侧应该是什么样子的图像与右侧显示的图像之间的区别。

[我的问题 http://resource.theboulderdesign.com/400/homebox/gettingcompare.png](http://resource.theboulderdesign.com/400/homebox/gettingcompare.png)

我希望有人能解决我的问题。

摩根肯扬

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T00:25:10.650

这是 Chrome/Windows 的问题。它会影响字体粗细和字母间距，但您可以添加一个白色`text-stroke`来平滑它：

```
-webkit-text-stroke-width: 1px;
-webkit-text-stroke-color: white;
-webkit-text-fill-color: white; 
```

**演示：http: [//jsfiddle.net/zzmbu/](http://jsfiddle.net/zzmbu/)**

这是它的屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/OJwrh.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-14T03:15:04.463

我还发现如果你添加

```
text-shadow:0px 0px #FF0000; 
```

我的 CSS 的属性，它可以正确呈现。我不知道为什么。

# excel - 可以在 Sentonbehalfofname 中使用文本字符串吗？

> ID：15800468
> 
> 赞同：0
> 
> 时间：2013-04-04T00:15:20.747
> 
> 标签：excel, outlook, vba

我想从我的帐户使用 VBA 发送一封电子邮件，但它看起来是从另一个用户发送的。有没有办法使用 Sentonbehalfofname，这样您就可以在没有访问权限的情况下包含您想要的任何文本字符串？

```
Set outlookapp = CreateObject("outlook.application")
msg = "Enter Message here"
subject = "Enter subject here"
Set item = outlookapp.createitem(0)

With item
.Sentonbehalfofname = "Yogi Bear" 
```

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:23:19.597

不，Exchange Server 会将该名称解析为邮箱，并检查您是否有权代表该邮箱发送邮件。

如果您使用的是 SMTP 服务器，您可能可以指定任意名称，但这仅适用于某些 SMTP 服务器，不适用于 Exchange。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T12:33:50.873

```
.From = """Your string""  < sender@email.com>" 
```

# c# - 如何做到这一点，以便当用户单击取消时，它会取消对话框？

> ID：15800469
> 
> 赞同：1
> 
> 时间：2013-04-04T00:15:23.527
> 
> 标签：c#, winforms, visual-studio-2012, openfiledialog

我有以下代码：

打开文件代码

```
OpenFileDialog ofd = new OpenFileDialog();
        ofd.Title = "Open File";
        ofd.FileName = "";
        ofd.Filter = "Rich Text Files (*.rtf)|*.rtf|Text Document (*.txt)|*.txt|Microsoft Word Document (*.doc)|*.doc|Hypertext Markup Language Document (*.html)|*.html"; StreamReader sr = null;
        if (ofd.ShowDialog() != DialogResult.Yes) return;
        {
            NewFile();
        }
        try
        {

            sr = new StreamReader(ofd.FileName);
            this.Text = string.Format("{0} - Basic Word Processor", Path.GetFileName(ofd.FileName));
            richTextBoxPrintCtrl1.Text = ofd.FileName;
            richTextBoxPrintCtrl1.Text = sr.ReadToEnd();
            filepath = ofd.FileName;
            richTextBoxPrintCtrl1.LoadFile(fileName, RichTextBoxStreamType.RichText);

        }
        catch
        {
        }
        finally
        {
            if (sr != null) sr.Close();
        } 
```

新文件代码

```
if (richTextBoxPrintCtrl1.Modified)
        {
            DialogResult r = MessageBox.Show(this, "Save Current Document?", "Save?", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);
            if (r == DialogResult.Yes) SaveFile();
            if (r == DialogResult.Cancel) return;
        }
        this.Text = string.Format("Untitled - Basic Word Processor");
        richTextBoxPrintCtrl1.Text = "";
        filepath = null;
    }
    } 
```

将文件另存为代码

```
SaveFileDialog sfdSaveFile = new SaveFileDialog();
        sfdSaveFile.Title = "Save File";
        sfdSaveFile.FileName = "Untitled";
        sfdSaveFile.Filter = "Rich Text Files (*.rtf)|*.rtf|Text Document (*.txt)|*.txt|Microsoft Word Document (*.doc)|*.doc|Hypertext Markup Language Document (*.html)|*.html";
        if (sfdSaveFile.ShowDialog() == DialogResult.OK)
            try
            {
                filepath = sfdSaveFile.FileName;
                SaveFile();
                this.Text = string.Format("{0} - Basic Word Processor", Path.GetFileName(sfdSaveFile.FileName));
            }
            catch (Exception exc)
            {

            } 
```

保存文件代码

```
 if (filepath == null)
        {
            SaveFileAs();
            return;

        }
        StreamWriter sw = new StreamWriter(filepath);
        //StreamWriter stwrite = null;
        try
        {

            sw.WriteLine(richTextBoxPrintCtrl1.Text);
            richTextBoxPrintCtrl1.Modified = false;
            sw.Close();

        }
        catch (Exception e)
        {
            MessageBox.Show("Failed to save file. \n" + e.Message);
        }
        finally
        {
            if (sw != null) sw.Close();
        } 
```

目前，程序会跳过 NewFile 事件（即使文本已被修改）。我怎样才能做到这一点，当我单击“打开”时，它会询问我是否要保存（如果文本被修改）。然后，如果我单击取消，它会返回到表单吗？

对不起。我对编程真的很陌生，所以这都是一个学习曲线。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T00:34:00.997

好吧，我想我明白这里发生了什么。首先，我不相信`return;`你认为它的工作方式。

```
if (ofd.ShowDialog() != DialogResult.Yes) return;
        {
            NewFile();
        } 
```

`return;`如果显示对话框不是“是”，您就会接到一个电话。`{ newFile() }`代码不需要大括号。所以这些行真的是：

```
if (ofd.ShowDialog() != DialogResult.Yes) return;

NewFile(); 
```

现在，鉴于您的要求，无论如何在游戏中调用 NewFile 为时已晚。你希望在你问他们打开什么之前发生这种情况；就像大多数其他 Windows 程序一样工作。

但是，还有一个问题。您`return`在 NewFile 方法中的语句只是从 NewFile 返回。它并没有告诉以前的方法来纾困。

所以 NewFile 方法需要一个返回类型来指示是否允许调用方法前进。

而且，查看您的保存文件，您也有一个返回方法。所有的`return;`电话是怎么回事？

这让我们回到了如何解决这个问题？

答：重写整个事情。从以下方法开始：

```
private Boolean CanClear() {
    Boolean result = false;
    if (richTextBoxPrintCtrl1.Modified)
    {
        DialogResult r = MessageBox.Show(this, "Save Current Document?", "Save?", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question);
        if (r == DialogResult.Yes) {
            SaveFile();
            result = true;
        }
    } else {
        result = true;
    }  
    return result;
} 
```

现在，在您的 Open 和 New 文件方法中执行以下操作（假设这些是方法头）

```
protected void OpenFile(...) {
    if (!CanClear()) return;
    .... now execute the code to load the open dialog and the selected file.
}

protected void NewFile(...) {
    if (!CanClear()) return;

    this.Text = string.Format("Untitled - Basic Word Processor");
    richTextBoxPrintCtrl1.Text = "";
    filepath = null;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T00:30:52.013

问题在这里：

```
 if (ofd.ShowDialog() != DialogResult.Yes) return;
    {
        NewFile();
    } 
```

删除那个`return`。但是，正如@Chris 所说，您应该在用户选择要打开的新文件**之前**询问是否保存当前文件。

# c# - Windows 窗体应用程序中的 MDI 窗口

> ID：15800474
> 
> 赞同：0
> 
> 时间：2013-04-04T00:16:12.443
> 
> 标签：c#, image, mdichild, mdiparent

现在我有这段代码可以从名为 MDIParent1 的 MDIParent 窗口打开图像

```
private void OpenFile(object sender, EventArgs e)
{
    OpenFileDialog openFileDialog = new OpenFileDialog();
    openFileDialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.Personal);
    openFileDialog.Filter = "Image Files (*.jpg)|*.jpg|All Files (*.*)|*.*";
    if (openFileDialog.ShowDialog(this) == DialogResult.OK)
    {
        string FileName = openFileDialog.FileName;
        Process.Start(@FileName);
    }
} 
```

这将打开一个带有我的图像的新窗口，但是我希望它作为 MDIParent1 的子窗口打开。任何帮助将不胜感激。谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:42:50.480

`Process.Start(@FileName);`就像您在资源管理器中双击文件一样。所以它会打开一个新窗口。如果您设置了默认程序来打开图像，那么它将改为打开程序。

如果你想用 C# 来做，创建一个包含 PictureBox 的表单。然后，不要调用`Process.Start(@FileName);`，而是像这样调用表单：

```
Form1 form = new Form1();
form.MdiParent = this;
form.PictureBox1.ImageLocation = FileName;
form.Open(); 
```

# php - 保护隐藏字段

> ID：15800475
> 
> 赞同：1
> 
> 时间：2013-04-04T00:16:17.300
> 
> 标签：php, mysql

我正在使用此代码来检查答案是否正确：

```
<?php
$con=mysqli_connect("localhost","root","","teachme");
//check connection
if (mysqli_connect_errno()) {
    echo 'Failed to connect to MySQL: ' . mysqli_connect_error();
}

$query = "SELECT question, answer, explanation FROM grade8u1 WHERE id BETWEEN 1 AND 10 ORDER BY RAND()";
$result = mysqli_query($con, $query);
$row = mysqli_fetch_row($result);
echo ("<b>Question</b>: $row[0]<br>");
echo ("<b>Answer</b>: $row[1]<br>");
echo ("<b>Explanation</b>:<br> $row[2]<br>");

if (isset($_POST['answer'])) {
    $answer = $_POST['realanswer'];
    if ($_POST['answer'] == $answer) {
        echo "<br>";
        echo "Last answer was correct";
    }
    else {
        echo "<br>";
        echo "Last answer was incorrect";
    }
}
?>
<form action="random.php" method="post">
    <input type="hidden" name="realanswer" value="<?php echo $row[1]; ?>">
    Answer: <input type="text" name="answer">
    <input type="submit" value="Submit">
</form> 
```

存在一个问题，因为任何人都可以检查或编辑隐藏字段的值。我尝试了其他方法，例如使用会话，但每次用户按下提交时它们都会被替换。谢谢，汤姆。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:19:48.830

您有 2 个选项。

1.  使用加密。（秘密）服务器端密钥意味着您可以将隐藏输入设置为只能由服务器解密的加密字符串。
2.  使用会话（为了安全性更好，尽管挑剔者会指出一些超级奇怪的人和浏览器不支持它）。

如果会话之前对您不起作用，则说明您没有正确使用它们！（可能是一个被遗忘`session_start()`的电话；通常是这样）

此外，如果这是针对 CAPTCHA 或类似的，则不要使用选项 (1)；黑客可以多次重复使用相同的隐藏答案/真实答案组合。您可以通过添加和检查时间戳或使值一次性使用来减少问题，但使用会话会容易得多。

# css - 环绕图像的 Div 具有超出过去图像的边框

> ID：15800477
> 
> 赞同：0
> 
> 时间：2013-04-04T00:16:21.427
> 
> 标签：css, html, border

我不确定这个标题是否有意义，但我会尽我所能解释。

我想基本上在图像之上添加一个 div，这很简单。我将图像包裹在一个 div 周围，然后从中给出诸如 top:、left: 之类的内容。

然而，图像所在的这个 div 超出了实际图像的边界，并一直延伸到父 div。如何使 div 的边框围绕 div 内的实际图像。

黑色方块是图像。但是具有图像类的 div 没有环绕图像的边框。

```
<div id="page">

    <div class="image">
        <img src="http://upload.wikimedia.org/wikipedia/commons/8/85/Black_300.jpg">
            <div class="innerimage"></div>
    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:20:34.100

将 display: inline-block 添加到 .image div：

```
display: inline-block; 
```

[http://jsfiddle.net/wwRhB/4/](http://jsfiddle.net/wwRhB/4/)

# php - 输入的id

> ID：15800480
> 
> 赞同：0
> 
> 时间：2013-04-04T00:16:49.880
> 
> 标签：php, mysql

我正在发送带有表单的多个输入，如何获取实际输入的 id，以便我可以更新 mysql 内容？

我的代码：

```
if (isset($_POST['save']))
    {
    foreach ($_POST as $key => $value)
        {
        ${$key} = $value;
        mysql_query("UPDATE table SET img='$image_[id]', title='$title_[id]' where id='$id'");
        }
    }

while ($row = mysql_fetch_array($result))
    {
    echo "<b>Title: </b><input type='text' name='title_" . $row['id'] . "' value='" . $row['title'] . "'><br />";
    echo "<b>Image: </b><input type='text' name='image_" . $row['id'] . "' value='";
    }
echo '<input type="submit" name="save" value="save"><br /><hr>';
echo '</form>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:22:41.937

你的命名是错误的。使用这种方式。

```
echo "...    name='title[" . $row['id'] . "]'..."; 
```

在它之后，您`$_POST['title']`将包含一系列标题。

并阅读手册[如何在 HTML 中创建数组？](http://www.php.net/manual/en/faq.html.php#faq.html.arrays)

* * *

但如果你还是那样走。你可以使用这样的东西。

```
foreach ($_POST as $key => $value)
    {
    if (preg_match('^image_(\d*)$', $key, $matches))
        {
        $id = $matches[1];
        if (isset($_POST['title_' . $id]))
            {
            mysql_query("UPDATE table SET title='" . $_POST['title_' . $id] . "' where id='$id'");
            }
        }
    } 
```

但是在这里签名表明您了解此代码的所有漏洞。

# android - 将apk文件下载到SD卡时如何检查解析错误

> ID：15800488
> 
> 赞同：0
> 
> 时间：2013-04-04T00:17:36.540
> 
> 标签：android, download, apk

当有版本更新时，我会从服务器获取 apk 文件，这个 apk 文件有时会下载损坏。当我尝试安装文件时，这会导致解析错误是否有任何方法可以确保文件是 apk 文件在运行之前没有损坏。

我检查 `( (apkFile!=null) && (apkFile.exists()) )`了大小，但仍有例外

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T04:03:32.697

由于您知道有一个新文件，因此在该通知中包含 apk 文件的 md5。下载后获取下载的 apk 的 md5 并与预期进行比较。如果它们不同，那么您的下载已损坏。

# indexing - Kohana 路线索引操作

> ID：15800490
> 
> 赞同：0
> 
> 时间：2013-04-04T00:17:51.383
> 
> 标签：indexing, action, kohana, routes

我有个问题。

我有代码：

```
Route::set('user', '(<controller>(/<id>))')
->defaults(array(
    'controller' => 'user',

    'id' => '\d+',
)); 
```

而 mydomain.com/user/1 不起作用..

错误：

> 在此服务器上找不到请求的 URL user/1。

但是当我在控制器和 id （或其他东西）之间设置点时：

```
 Route::set('user', '(<controller>.abc(/<id>))')
->defaults(array(
    'controller' => 'user',
    'id' => '\d+',
)); 
```

mydomain.com/user.abc/1 工作。

为什么？:(

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:24:40.007

你想检查是否`id`是数字，对吧？然后像这样将它放在默认值中不是正确的方式，正如您可以在[3.3 文档中阅读的那样](http://kohanaframework.org/3.3/guide/kohana/routing#regex)

```
Route::set('user', '(<controller>(/<id>))',
    array(
        'id' => '\d+',
    ))
    ->defaults(array(
        'controller' => 'user',
        'action' => 'index',
    )); 
```

如果您有多个路线，那么在哪里定义该路线也很重要。您必须在路由中或默认**提供操作**（[doc ）](http://kohanaframework.org/3.3/guide/kohana/routing#default-values)

# c# - 如何在 C# 中使用 PInvoke 强制对 dll 函数进行参数计数

> ID：15800491
> 
> 赞同：3
> 
> 时间：2013-04-04T00:17:55.960
> 
> 标签：c#, .net, pinvoke

我编写了一个 C dll，其中包含一个接受 4 个参数并返回一个数字的函数。然后我创建了一个 C# 应用程序并使用 PInvoke 调用了 dll 函数。一切正常。然后我将 dll 函数中的参数从 4 更改为 3。但是我没有更改 C# 中的方法签名（DllImport 方法签名）。令我惊讶的是，调用仍然从 C# 成功，但我从 dll 函数返回了一些意外的值。

我期待一个例外，但电话通过了。使用 P/Invoke 进行函数调用时，有什么方法可以严格执行参数计数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T00:19:20.127

没有办法强制参数计数匹配。你只需要把它做对。调用约定、参数类型等也是如此。

与托管代码不同，本机 DLL 没有描述必须如何调用它们的元数据。

如果您启用 p/invoke 堆栈不平衡 MDA，那么您至少能够检测到您在运行时犯的错误。

# html - 提取同一组内的第一组数据

> ID：15800492
> 
> 赞同：1
> 
> 时间：2013-04-04T00:18:07.017
> 
> 标签：html, xml, xslt, xslt-1.0

我有一个 XSLT 问题，这是我之前提出的问题的后续问题。

挑战在于从相同的重复集中提取数据集`<root>`。我有一个来自@Kirill Polishchuk 提供的上一个问题的示例XSLT 解决方案。

[使用 xsl 从部分属性中提取类](https://stackoverflow.com/questions/13466641/extracting-a-class-from-the-section-attribute-using-xsl)

我只需要提取第一组数据，而忽略从 number="1" 开始的第二组数据

请注意我正在使用 XSLT 1.0。任何建议或指导将不胜感激。

输入：

```
<root>
  <page number="1" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="2" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="3" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="4" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="5" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="6" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="7" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="8" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="9" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="10" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="11" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="12" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="13" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="14" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="15" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="16" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="17" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="18" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="19" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="20" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="21" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="22" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="23" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="24" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="1" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="2" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="3" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="4" section="Arsenal_Stadium">Arsenal_Stadium</page> 
  <page number="5" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="6" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="7" section="Arsenal_Crowds">Arsenal_Crowds</page> 
  <page number="8" section="Arsenal_Crowds">Arsenal_Crowds</page>
  <page number="9" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="10" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="11" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="12" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="13" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="14" section="Arsenal_Finances">Arsenal_Finances</page> 
  <page number="15" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="16" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="17" section="Arsenal_Outlook">Arsenal_Outlook</page> 
  <page number="18" section="Arsenal_Outlook">Arsenal_Outlook</page>
 </root> 
```

期望的输出：

```
<table>
<tr>
<td class="Stadium">Arsenal_Stadium</td>
<td></td>
<td class="Crowds">Arsenal_Crowds</td>
<td></td>
<td class="Finances">Arsenal_Finances</td>
<td></td>
<td class="Outlook">Arsenal_Outlook</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>7</td>
<td>8</td>
<td>12</td>
<td>13</td>
<td>19</td>
<td>20</td>
<td>24</td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T02:53:41.607

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" omit-xml-declaration="yes" indent="yes"/>

  <xsl:key name="k" use="@section" match=
  "page[(@number > 1 and count(preceding-sibling::*[@number=1]) = 1)
      or
        (@number=1 and count(preceding-sibling::*[@number=1]) =0)
       ]"/>

  <xsl:template match="/*">
    <table>
      <tr>
        <xsl:apply-templates select=
          "page[generate-id() = generate-id(key('k', @section))]"/>
      </tr>
      <tr>
        <xsl:apply-templates mode="page"
          select="page[generate-id() = generate-id(key('k', @section))]" />
      </tr>
    </table>
  </xsl:template>

  <xsl:template match="page">
    <td class="{substring-after(@section, '_')}"><xsl:value-of select="."/></td>
    <td></td>
  </xsl:template>

  <xsl:template match="page" mode="page">
    <td><xsl:value-of select="@number"/></td>
    <td><xsl:value-of select="key('k', @section)[last()]/@number"/></td>
  </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<root>
    <page number="1" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="2" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="3" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="4" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="5" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="6" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="7" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="8" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="9" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="10" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="11" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="12" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="13" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="14" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="15" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="16" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="17" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="18" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="19" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="20" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="21" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="22" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="23" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="24" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="1" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="2" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="3" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="4" section="Arsenal_Stadium">Arsenal_Stadium</page>
    <page number="5" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="6" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="7" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="8" section="Arsenal_Crowds">Arsenal_Crowds</page>
    <page number="9" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="10" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="11" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="12" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="13" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="14" section="Arsenal_Finances">Arsenal_Finances</page>
    <page number="15" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="16" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="17" section="Arsenal_Outlook">Arsenal_Outlook</page>
    <page number="18" section="Arsenal_Outlook">Arsenal_Outlook</page>
</root> 
```

**产生想要的正确结果**：

```
<table>
   <tr>
      <td class="Stadium">Arsenal_Stadium</td>
      <td/>
      <td class="Crowds">Arsenal_Crowds</td>
      <td/>
      <td class="Finances">Arsenal_Finances</td>
      <td/>
      <td class="Outlook">Arsenal_Outlook</td>
      <td/>
   </tr>
   <tr>
      <td>1</td>
      <td>7</td>
      <td>8</td>
      <td>12</td>
      <td>13</td>
      <td>19</td>
      <td>20</td>
      <td>24</td>
   </tr>
</table> 
```

* * *

**概括**：

为了处理第 K 个“集合，很容易推广这种转换。

例如，以下转换处理相同的第二个“集合”，提供的 XML 文档（上图）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" omit-xml-declaration="yes" indent="yes"/>

  <xsl:key name="k" use="@section" match=
  "page[(@number > 1 and count(preceding-sibling::*[@number=1]) = 2)
      or
        (@number=1 and count(preceding-sibling::*[@number=1]) =1)
       ]"/>

  <xsl:template match="/*">
    <table>
      <tr>
        <xsl:apply-templates select=
          "page[generate-id() = generate-id(key('k', @section))]"/>
      </tr>
      <tr>
        <xsl:apply-templates mode="page"
          select="page[generate-id() = generate-id(key('k', @section))]" />
      </tr>
    </table>
  </xsl:template>

  <xsl:template match="page">
    <td class="{substring-after(@section, '_')}"><xsl:value-of select="."/></td>
    <td></td>
  </xsl:template>

  <xsl:template match="page" mode="page">
    <td><xsl:value-of select="@number"/></td>
    <td><xsl:value-of select="key('k', @section)[last()]/@number"/></td>
  </xsl:template>
</xsl:stylesheet> 
```

**在这种情况下，再次产生所需的正确结果：**

```
<table>
   <tr>
      <td class="Stadium">Arsenal_Stadium</td>
      <td/>
      <td class="Crowds">Arsenal_Crowds</td>
      <td/>
      <td class="Finances">Arsenal_Finances</td>
      <td/>
      <td class="Outlook">Arsenal_Outlook</td>
      <td/>
   </tr>
   <tr>
      <td>1</td>
      <td>4</td>
      <td>5</td>
      <td>8</td>
      <td>9</td>
      <td>14</td>
      <td>15</td>
      <td>18</td>
   </tr>
</table> 
```

# c++ - C++ Visual Studio 2010 LNK2019 错误 - 需要一些基本建议

> ID：15800500
> 
> 赞同：1
> 
> 时间：2013-04-04T00:19:02.207
> 
> 标签：c++, linker-errors, lnk2019

我得到以下代码：

```
FooClass.h

#pragma once

#include <string>
#include "StdAfx.h"
#include "FooClass.h"

#include <iostream>
#include "FooClass.h"

FooClass::FooClass(void)
{
}

FooClass::~FooClass(void)
{
}

int PrintMsg (std::string msg)
{
    printf ("%s\n", msg);
    return 1;
}

class FooClass
{
public:
    FooClass(void);
    ~FooClass(void);

    static int PrintMsg (std::string msg);
};

FooClass.cpp

CODETESTER.cpp

// CODETESTER.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"

#include "FooClass.h"

int _tmain(int argc, _TCHAR* argv[])
{
    FooClass::PrintMsg ("Hi World!!");

    return 0;
} 
```

在构建项目时，我收到以下错误：

> Erro 4 错误 LNK2019: símbolo externo indefinido "public: static int __cdecl FooClass::PrintMsg(class std::basic_string,class std::allocator >)" (?PrintMsg@FooClass@@SAHV?$basic_string@DU?$char_traits@ D@std@@V?$allocator@D@2@@std@@@Z) 参考函数 _wmain E:\2。MEZASOFT\DESENVOLVIMENTO\PROTOTIPOS\CODETESTER\CODETESTER\CODETESTER.obj CODETESTER

我已经阅读了几篇关于这个主题的文章以及帮助，但没有找到如何修复它。

我知道 .h 不足以让链接器知道 PrintMsg 代码在哪里，但是 - 我该如何解决它。

对不起，如果这是一个基本问题。很久以前，我曾经是一名优秀的 C 程序员。我作为 C++ 程序员回来了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:30:05.167

您为 FooClass 声明了 PrintMsg 函数，但从未定义/实现它。相反，您定义了一个与 FooClass 无关的函数 PrintMsg。

为 FooClass 正确实现 PrintMsg 函数：

```
int FooClass::printMsg(std::string msg)
{
    printf("%s\n", msg.c_str());
    return 1;
} 
```

作为旁注，您可能应该通过引用传递参数 msg 。这样，每次调用 printMsg 时都不会复制字符串对象。

```
// you'll also need to change the printMsg declaration inside the FooClass
int FooClass::printMsg(const std::string &msg)
{
    printf("%s\n", msg.c_str());
    return 1;
} 
```

# android - 选项卡式android应用程序基本结构

> ID：15800501
> 
> 赞同：0
> 
> 时间：2013-04-04T00:19:04.450
> 
> 标签：android, android-listfragment, android-fragmentactivity

我正在将我的应用程序从 iOS 移植到 Android，并且我想为其提供与 iOS 选项卡栏相同的选项卡式布局。

我发现目前最好的方法是为每个“选项卡”创建一个带有片段的操作栏。这是有效的，但我不明白如何在每个选项卡内导航。例如：一个选项卡片段是一个列表片段，当我点击一个列表条目时，我想推送一个新的（片段或活动？..建议）来显示有关该条目的详细信息。

在我用于选择事件的列表片段中：

```
 getFragmentManager()
         .beginTransaction()
         .replace(what_goes_here?, detailsfrag)
         .commit(); 
```

我试过的任何东西都只是在listfragment上方添加detailsfrag。

这是正确的布局吗？（3个标签，每个一个片段，每个推动片段） 额外问题：片段和片段活动之间的区别？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:34:08.740

你走在正确的道路上。该`.replace()`函数需要片段 - 应该被另一个替换的片段。第一个由其容器 ID 标识 - 例如`R.id.fragmentContainer`。第二个由参考确定。链接[API](http://developer.android.com/reference/android/app/FragmentTransaction.html#remove%28android.app.Fragment%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:28:28.650

我最终使用了一个意图来启动一个新的 FragmentActivity，但是它隐藏了操作菜单选项卡。但这是它应该考虑 android 最佳实践的方式。事实上，我想要显示的片段实际上应该是根据 android 的做事方式的活动。推特的应用程序也以这种方式工作，所以我认为这是正确的方式。

# java - Java 链表查找框架

> ID：15800506
> 
> 赞同：0
> 
> 时间：2013-04-04T00:19:45.250
> 
> 标签：java, linked-list

我有两个 JAVA 类用户和用户。用户是主类，它将在链接列表中列出用户类的实例。用户应该能够添加和删除用户。我的 coe 没有进行删除。

```
import java.util.*;
public class Users {

// Main method
public static void main(String[] args) {
    new Users();
}
//attributes
private LinkedList<User> users = new LinkedList<User>();

//Constructors
public Users(){
    add();
    add(); 
}

//Methods

//adds a user to the list
private void add(){
    users.add(new User());
}
//deletes a user from the list
private void delete(){
    User user = user(readName());
    if (user != null)
        users.remove(user);
    else
        System.out.println("    No such user");
}
 //returns the user if the user exists in the list
private User user(String name){
    for (User user: users)
        if (user.matches(name)){
            return user;
        }
    return null;

}
private String readName(){
    System.out.print("  Names: ");
    return In.nextLine();
}

}

User class

public class User {

//Attributes
private String name;
private Users users;

//Constructors
public User(){
    this.name = readName();
}

//Methods
//checks if the parameter is equal to the name field
public boolean matches(String name){
    return this.name == name;
}
public void add(){
    System.out.print(" " + name);
}
public void delete(){

}
public String readName(){
    System.out.print("  Name: ");
    return In.nextLine();
}

} 
```

在 Users 类中，该`user(String s)`方法不会传递元素，即使它已添加到列表中。请一些建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:31:30.373

您的 delete 方法需要将要删除的用户对象作为参数传入。当前，您正在声明一个新用户对象，该对象不包含有关您要删除的用户的任何信息，除非您提示输入用户名。您应该将用户对象传递给 delete 方法，使其看起来像这样。

```
//deletes a user from the list
private void delete(User user) {
    if (user != null) 
        users.remove(user);
    else
        System.out.println("     No such user");
} 
```

# php - 我的会话似乎在不应该的时候被破坏了

> ID：15800519
> 
> 赞同：0
> 
> 时间：2013-04-04T00:21:17.087
> 
> 标签：php

我有一个包含各种输入的页面，他们输入一些文本，然后按提交，将他们输入的信息插入数据库......它工作正常但是当我将它们重定向回他们的主页时（仅适用于登录用户）我的网站实际上将它们带回索引页面（每个人都可以使用），并显示“您必须登录才能执行此操作...”消息

然后我重新登录以检查我输入的内容是否已发布，它是......并且它是以我的名字发布的，这告诉我至少插入我的帖子的页面已经存储了我的会话

我已经检查了我的代码，以确保我正在传递会话变量，并且我似乎在做正确的事情。

这是我在主页上确保用户已登录的内容：

```
<?php session_start(); ?>
<?php
    if (!isset($_SESSION['id'])){
        header("Location: index.php?message=You Must Log in to go there!");
    }
?> 
```

这是 insert-post.php 页面的代码：

```
<?php session_start(); ?>
<?php require_once("../includes/include_all.php"); ?>
<?php

    #myslqi connection
    $con = new mysqli(host,db_username,db_password, db_name);

    #THE POST VARIABLES
    $content = $con->real_escape_string($_POST['content']);
    $details = $con->real_escape_string(nl2br($_POST['details']));
    $user_id = $_SESSION['id'];
    $subjectArray = explode(',', $_POST['subject']);
    $bonus = $_POST['bonus'];
    #DATES
    $date = date('Y-m-d G:i:s', time());
    $date_expires = date('Y-m-d G:i:s', time() + (3600*4)); 
    #photo
    $photo_name = $_POST['photo_name'];

    #cost of this post
    $cost = $bonus+200;

    #insert the question

    $query = "INSERT INTO questions 
                (content, award, image, details, user_id, category, sub_category, date_created, date_expires, alive) 
                    VALUES ('".$content."', 
                                    '".$bonus."',
                                    '".$photo_name."',
                                    '".$details."',
                                    '".$_SESSION['id']."', 
                                    '".$subjectArray[1]."',
                                    '".$subjectArray[0]."',
                                    '".$date."',
                                    '".$date_expires."',
                                    1)
                    ";
    $insert_question = $con->query($query);

    if (!$insert_question){
        die("Could not enter the question [" .$con->error . "]");
    } else{
        header("Location: ".document_root."home.php?query=questions&message=Your question post was successful!");
    }

?> 
```

标题将您带回主页，查询 = 问题，它只显示您最近的帖子并给您留下一条消息......它在同一个页面上，验证用户已登录......

编辑：登录验证代码：

```
#check for user via username/password
public function can_log_in($inputs){

   $query = "SELECT * FROM users WHERE user_name = '".$inputs['user_name']. "' AND password = '".$inputs['password']."'";
   $result = $this->con->query($query);
   if (!$result){
     die("Not performing query [" .$this->con->error);
   }
   if ($result->num_rows == 1){
    #start session
    $_SESSION['id'] = $this->get_user_id($inputs['user_name']);
    $_SESSION['user'] = $inputs['user_name'];
        return true;
    } else{
        return false;
        }
} 
```

和获取 user_id 功能

```
#fetch user id
public function get_user_id($username){
     $query = "SELECT * FROM users WHERE user_name = '".$username."'";
     $result = $this->con->query($query);
     while ($row = $result->fetch_assoc()){
    return $row['id'];
     }
} 
```

这些在用户类中

# c# - 绘制的表单内容不会保持绘制状态

> ID：15800521
> 
> 赞同：0
> 
> 时间：2013-04-04T00:21:36.830
> 
> 标签：c#, winforms, graphics

我已经尝试设置 ResizeRedraw，但它不会在调整大小时导致绘制事件，所以我开始在 myForm_Resize 内部无效。现在，当我调整大小时，我看到我的背景正在重新绘制，但是一旦我停止调整大小，我的控件就会用它的背景颜色重新绘制。我究竟做错了什么？

```
private void pbox_Paint(object sender, PaintEventArgs e) {
    Rectangle boardRect = pbox.ClientRectangle;
    using (Graphics g = pbox.CreateGraphics()) {
        g.FillRectangle(Brushes.Orange, boardRect);
    }
}

private void myForm_Resize(object sender, EventArgs e) {
    this.Invalidate(true);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:47:27.853

请注意，在事件处理程序中创建`Graphics`对象没有意义。`Paint`您应该`Graphics`使用`PaintEventArgs`. 像这样更改您的代码，它现在应该可以工作了：

```
private void pbox_Paint(object sender, PaintEventArgs e) 
{
      Rectangle boardRect = pbox.ClientRectangle;
      e.Graphics.FillRectangle(Brushes.Orange, boardRect);
} 
```

# php - 从文件服务器和 MYSQL 中选择匹配的照片？

> ID：15800525
> 
> 赞同：0
> 
> 时间：2013-04-04T00:22:06.590
> 
> 标签：php, mysql

我制作了一个程序，其中照片和照片名称存储在文件服务器中，名称、ID 和其他信息存储在`MYSQL`数据库中。

如果我有`user "1"`并且他们有一张名为的照片，该照片`"cat.jpg"`的名称存储在文件服务器和数据库中，我该如何区分这张照片`user 2's` `"cat.jpg"`？

/userphotos 的内容

```
cat.jpg  //uploaded by user 1

dog.jpg //uploaded by user 1

cat.jpg  //uploaded by user 2 
```

**MYSQL：**

```
USERID = "1" PHOTOID ="1" PHOTONAME = "cat.jpg" 

USERID = "2" PHOTOID ="2" PHOTONAME = "cat.jpg" 
```

如何根据用户获得正确的 cat.jpg？我是否必须在 /userphotos 中使用 PHOTOID 命名的照片？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:27:10.013

只需使用图像名称 + 用户名即可调用它 例如：user1_cat.jpg 和 user2_cat.jpg

# html - 如何在 chrome 的 noscript 标签中显示 html？

> ID：15800526
> 
> 赞同：28
> 
> 时间：2013-04-04T00:22:20.920
> 
> 标签：html, google-chrome, noscript

当我`noscript`在 Chrome 中查看时，我看到关闭 JavaScript 时显示的原始 html。

这：

```
<!DOCTYPE html>
<head></head>
<body>
<noscript>
    <div>No Javscript</div>
</noscript>
</body> 
```

将显示：

```
<div>No Javscript</div> 
```

这曾经有效，所以我猜有一个回归，但我在网上找不到任何关于它的信息。在其他浏览器（safari、firefox）中，我看不到 HTML。我在 OS X 10.7.5 上使用 Chrome 26.0.1410.43

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-08-08T02:30:36.663

刷新页面两次可解决此问题。

它仅在您第一次切换到禁用 javascript 时出现（即禁用 javascript 浏览的人不会体验到它）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:27:02.363

啊，我说得太早了。关闭 AdBlock 就是答案。

# hex - 十六进制编辑重新计算校验和

> ID：15800532
> 
> 赞同：0
> 
> 时间：2013-04-04T00:22:58.640
> 
> 标签：hex, edit

我正在尝试编辑一个专有文件，它是一个用于精确图形的 .pin 文件，如果您听说过它 +10 的话。我需要在十六进制环境（例如，HexEdit）中对其进行编辑，以将文件路径从程序文件更改为程序文件（x86）以进行升级。如果路径的长度没有改变，我可以这样做，但是添加这 6 个字节显然会改变它。更改此路径的唯一另一种方法是将其加载到我们的软件中并进行更改，有数千个这样的文件，我真的不想花几天时间在上面。

我研究了重新计算校验和并对其进行修补，但是我找不到对我来说足够深入的材料，我希望这里有人可以帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T04:40:36.743

为避免在尝试替换时更改路径长度`Program Files`，`Program Files (x86)`我建议您尝试使用[8.3 路径](http://en.wikipedia.org/wiki/8.3_filename)（即`PROGRA~2`），然后用空字符填充空白区域。

您可以像这样找到 8.3 路径：

```
dir %systemdrive%\Prog* /X /AD 
```

# java - C++ hasNextLine

> ID：15800535
> 
> 赞同：3
> 
> 时间：2013-04-04T00:23:19.283
> 
> 标签：java, c++, file-io, input

我在 Java 中很容易完成了一些事情，但是以下的 C++ 版本是什么：

```
while (in.hasNextLine())
{                
     String line = in.nextLine();

     if (i == 13)
     {
         i++;
         break;                    
     }  

     i++;
} 
```

这是 nextLine 部分，我似乎找不到 C++ 等价物

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T00:25:35.343

```
std::ifstream in("Path\\To\\File.txt");
std::string line;
while (std::getline(in, line))
{
    if (i++ == 13)
    {
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T00:27:25.900

假设`in`是一个文件流

```
#include <sstream>
#include <string>    
while (std::getline(in, line))
{

       // Do your thing 
} 
```

# excel - 设计一个宏，单击链接以下载 XLS 文件并将该文件复制到工作表中

> ID：15800541
> 
> 赞同：0
> 
> 时间：2013-04-04T00:23:40.343
> 
> 标签：excel, vba

我需要帮助在 excel 中设计一个宏：

1.  导航到下载 XLS 文件的网址（转到该地址将自动下载 XLS 文件，因此不需要自动执行）
2.  复制下载文件的第一张表的内容（称为“sheet1”）
3.  将 sheet1 粘贴到原始工作簿中
4.  删除已下载的 XLS 文件

任何帮助或提示将不胜感激，

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T10:00:19.973

好吧，首先，您可以尝试在 Google 上搜索与您的任务相关的信息。

1）我这样做了（搜索字符串：“ *excel vba url download to file* ”），你瞧，返回的第二个页面在**MrExcel**网站上，上面有 Excel MVP 和“*所有学习者的朋友*”科洛的回答：

[VBA - 从网站保存文件](http://www.mrexcel.com/forum/excel-questions/67123-visual-basic-applications-save-file-website.html#post318584)

2）您在 Excel 中的下一个任务是使用宏记录器（*工具>宏>记录新宏...*）来记录打开您下载的文件的步骤。这将为您提供一些代码供您查看并开始学习。

3) 接下来，再次使用宏记录器，将新打开的 excel 文件中的数据复制到宏工作簿中。这将为您提供一些代码供您查看并开始学习。

4) 现在您可以在 Google for **Excel VBA 上查找驱动器上的删除文件，**这将再次为您提供答案。

有任何问题，请告诉我们。

很高兴有帮助

菲利普

# javascript - 从其范围之外访问变量？

> ID：15800544
> 
> 赞同：0
> 
> 时间：2013-04-04T00:24:26.460
> 
> 标签：javascript, jquery, scope

所以，我对 javascript 还比较陌生，但仍然无法理解变量范围。所以，我想做的是从函数外部访问一个变量（都在同一个对象内）。

见下文：

```
function GameCard(imageSource, div)
{
    this.cardImage = new Image();
    this.cardImage.src = imageSource;

    this.imageString = "<img src='" + this.cardImage.src + "' />";

    this.hiddenImage = new Image();
    this.hiddenImage.src = HIDDEN_SOURCE;

    this.clicked = false;

    this.cardDiv = div;

    $(this.cardDiv).click(function() {
        alert(this.imageString);
        $(this).flip({
            direction:'lr',
        });
    });
} 
```

警报（我不幸的调试）说 imageString 在单击处理程序函数中未定义。这是有道理的，我将如何访问它？

在此先感谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:26:41.097

两种方法：首先，您可以存储`this`在另一个变量中：

```
var saveThis = this; 
```

在设置“click”处理程序之前，然后在处理程序代码中使用“saveThis”：

```
$(this.cardDiv).click(function() {
    alert(saveThis.imageString);
    $(saveThis).flip({
        direction:'lr',
    });
}); 
```

第二种方式：将处理函数绑定到您想要的对象：

```
$(this.cardDiv).click(function() {
    alert(this.imageString);
    $(this).flip({
        direction:'lr',
    });
}.bind(this)); 
```

第二种方式需要在较旧的 IE 版本中[使用 shim](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind#Compatibility)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:28:01.100

在函数外部声明一个 imageString var 并在 GameCard 和匿名 click() 事件的函数中使用它。

这两个函数不共享内存空间，因为匿名函数不在 GameCard 的上下文中执行，但它们都共享外部声明的全局变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T00:28:10.207

在这种情况下，“this”指的是 $(this.cardDiv) 而不是父对象。

您可能会考虑拥有一个包含 CardGame 对象之外的所有数据的 javascript 对象

这样，数据的范围就会更高，并且可以从您的方法中访问

# mysql - mysqliprepared statements dates and between子句

> ID：15800547
> 
> 赞同：3
> 
> 时间：2013-04-04T00:24:34.190
> 
> 标签：mysql, sql, prepared-statement

```
$stmt = $mysqli->prepare("SELECT vin FROM jobs WHERE out between ? and ?");
        $stmt->bind_param('ss', $startday, $endday);

        $startday = '2013-01-01';
        $endday = '2013-12-31';

        $stmt->execute();
        $stmt->store_result();

        $stmt->bind_result($vin);
echo $vin; 
```

如果我删除了语句的中间部分，上面的代码会发出这个错误查询工作。我尝试将列名括在括号中，但这也会杀死查询，所以我不得不删除它们。似乎问题出在 between 子句上，我可能不知道如何使用它。请帮忙

```
Fatal error: Call to a member function bind_param() on a non-object 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:27:58.537

问题不在于`BETWEEN`子句，而是使用保留关键字`OUT`作为列名。有两种方法可以保持这项工作，

一种是用反引号包裹它，

```
$stmt = $mysqli->prepare("SELECT vin FROM jobs WHERE `out` between ? and ?"); 
```

另一种是`ALIAS`在表上提供一个，并将其与列名一起使用。

```
$stmt = $mysqli->prepare("SELECT vin FROM jobs a WHERE a.out between ? and ?"); 
```

*   [MySQL 保留关键字列表](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

# python - python数据结构建议

> ID：15800554
> 
> 赞同：0
> 
> 时间：2013-04-04T00:25:25.497
> 
> 标签：python, data-structures

我有一些来自各种来源的意见。输入是键值对形式。键的类型为“abc”形式。来自不同来源的键可以相同，在这种情况下，我必须执行一组所有值。

我需要对数据结构做的事情：

*   我应该能够检索特定源 ID 的所有键和值
*   给定一个键，我应该能够找出与之关联的所有值，而不管源 ID 是什么。

我想要一个或多个节省空间的数据结构，我可以使用它来实现这一点。我最初想保留 2 个映射：一个用于源 id 与键，另一个用于键与值。但是在这里，我将源 ID 丢失为值映射。

速度/空间要求：获取每个键值列表的速度很重要；维护这些数据结构所需的内存也是如此。构建此数据结构和源 ID 到键/值检索速度所花费的时间并不重要。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:47:39.417

您可以稍微修改您的想法：保留一个字典将源与（键，值）对相关联，另一个将键与值集相关联。这应该可以快速构建/更新（添加一个条目需要两个字典查找和一个列表/集合插入），并且不需要太多的内存开销。然后，您想要的两个查找操作中的每一个只需要一个字典命中。

请注意，这只会使指向实际数据的指针数量增加一倍；如果值很大，那么内存使用量将远少于两倍。但是，如果这是一个问题，并且您不介意使源 id 到键值查找的速度慢得多，那么您可以只存储从键到（源，值）对的字典。然后您可以通过以下方式获取给定键的所有值

```
vals_for_key = [val for source, val in the_dict[key]] 
```

以及来自给定来源的键值对

```
keyvals_for_source = [(key, val)
                      for key, items in the_dict.iteritems()
                      for src, val in items
                      if src == source] 
```

# popcornjs - Popcorn.js 设置多个 cue()

> ID：15800556
> 
> 赞同：0
> 
> 时间：2013-04-04T00:25:39.027
> 
> 标签：popcornjs

当我运行以下命令时，我立即在我指定用于覆盖文本的区域中看到“五”。（我希望看到“一”一段时间，然后是“二”等）我错过了什么？

```
document.addEventListener("DOMContentLoaded", function () {
  putHere = document.getElementById("putHere");
  pop = Popcorn("#side1");   // Create a popcorn instance

  var states = function() {
    var rdy = pop.readyState();
    if (rdy !== 4) setTimeout(states, 10);
    else {
      pop.cue( 12, layover("One"));
      pop.cue(168, layover("Two"));
      pop.cue(336, layover("Three"));
      pop.cue(506, layover("Four"));
      pop.cue(703, layover("Five"));
    }
  }
  states();
}, false); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:53:18.160

在 IRC 上寻求帮助，建议将 pop.cue 行更改为：

```
pop.cue( 12, function() {layover("One");   });
pop.cue(168, function() {layover("Two");   });
pop.cue(336, function() {layover("Three"); });
pop.cue(506, function() {layover("Four");  });
pop.cue(703, function() {layover("Five");  }); 
```

工作。

（现在看看为什么它们在 Chrome 而不是 Firefox 中工作......）

# mysql - 更改日期的默认值

> ID：15800557
> 
> 赞同：0
> 
> 时间：2013-04-04T00:25:47.807
> 
> 标签：mysql

我有一个 Mysql 表，它的日期字段如下所示：

```
 | date          | timestamp    | NO   |     | CURRENT_TIMESTAMP |       | 
```

我正在使用此查询来更改它的默认值：

```
 alter table builds alter column date SET DEFAULT '0000-00-00 00:00:00'; 
```

但它似乎并没有改变列的默认值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:28:01.993

您需要将其更改为`datetime`类型而不是`timestamp`

```
ALTER TABLE builds MODIFY `date` datetime DEFAULT '0000-00-00' 
```

# php - 使用 .htaccess mod_rewrite 后找不到 url？

> ID：15800563
> 
> 赞同：0
> 
> 时间：2013-04-04T00:26:35.190
> 
> 标签：php, url

我的服务器上有一个 .htaccess 文件，我正在使用 mod_rewrite 隐藏 url 中的 .php 扩展名。所以`http://www.mysite.com/home.php`变成`http://www.mysite.com/home`

但是我收到一条 404 错误消息，提示找不到该页面。我错过了什么，我需要将链接更改为绝对路径吗？因为即使用户尝试输入`http://www.mysite.com/home`或`http://www.mysite.com/home.php`它仍然说找不到该页面。

这是我的 htacces 文件中的内容：

```
RewriteEngine On

RewriteCond %{THE_REQUEST} ^\w+\ /(.*)\.php(\?.*)?\ HTTP/
RewriteRule ^ http://%{HTTP_HOST}/%1 [R=301]

RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule .* $0.php 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:32:15.583

```
RewriteEngine On
# turn on the mod_rewrite engine

RewriteCond %{REQUEST_FILENAME}.php -f
# IF the request filename with .php extension is a file which exists
RewriteCond %{REQUEST_URI} !/$
# AND the request is not for a directory
RewriteRule (.*) $1\.php [L]
# redirect to the php script with the requested filename 
```

试试我发布的例子。这应该可以删除您的 PHP 扩展

# java - Spring MVC：大文件下载，OutOfMemoryException

> ID：15800565
> 
> 赞同：8
> 
> 时间：2013-04-04T00:26:42.720
> 
> 标签：java, spring-mvc, download

如何通过 spring 控制器提供大文件供下载？我关注了一些关于类似主题的讨论：

[从弹簧控制器下载文件](https://stackoverflow.com/questions/5673260/downloading-a-file-from-spring-controllers)

但是对于 300mb - 600mb 的大文件，这些解决方案失败了。我在最后一行收到 OutOfMemoryException ：

```
@RequestMapping(value = "/file/{dummyparam}.pdf", method = RequestMethod.GET, produces=MediaType.APPLICATION_OCTET_STREAM_VALUE)
public @ResponseBody byte[] getFile(@PathVariable("dummyparam") String dummyparam, HttpServletResponse response) {
.
.       
InputStream is = new FileInputStream(resultFile);

response.setHeader("Content-Disposition", "attachment; filename=\"dummyname " + dummyparam + ".pdf\"");
.
.         
return IOUtils.toByteArray(is); 
```

我的（天真的）假设是 IOUtils 甚至可以处理大文件，但这显然不会发生。有什么方法可以在下载过程中将文件拆分成块？文件通常约为 300 - 600mb 大。最大并发下载数估计为 10。

简单的方法是将文件链接为 webserver 目录中的静态内容，但我们想尝试在我们的 Spring 应用程序中执行此操作。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-04T00:33:28.710

这是因为您正在将整个文件读入内存，请改用缓冲读写。

```
@RequestMapping(value = "/file/{dummyparam}.pdf", method = RequestMethod.GET, produces=MediaType.APPLICATION_OCTET_STREAM_VALUE)
public void getFile(@PathVariable("dummyparam") String dummyparam, HttpServletResponse response) {

    InputStream is = new FileInputStream(resultFile);

    response.setHeader("Content-Disposition", "attachment; filename=\"dummyname " + dummyparam + ".pdf\"");

    int read=0;
    byte[] bytes = new byte[BYTES_DOWNLOAD];
    OutputStream os = response.getOutputStream();

    while((read = is.read(bytes))!= -1){
        os.write(bytes, 0, read);
    }
    os.flush();
    os.close(); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-22T12:39:18.810

对于 Spring，需要在 ResponseEntity 中使用**InputStreamResource类。**

演示代码：

```
 MediaType mediaType = MediaTypeUtils.getMediaTypeForFileName(this.servletContext, fileName);
        System.out.println("fileName: " + fileName);
        System.out.println("mediaType: " + mediaType);

        File file = new File(DIRECTORY + "/" + fileName);
        InputStreamResource resource = new InputStreamResource(new FileInputStream(file));

        return ResponseEntity.ok()
                // Content-Disposition
                .header(HttpHeaders.CONTENT_DISPOSITION, "attachment;filename=" + file.getName())
                // Content-Type
                .contentType(mediaType)
                // Contet-Length
                .contentLength(file.length()) //
                .body(resource);
    } 
```

参考链接：[https ://o7planning.org/en/11765/spring-boot-file-download-example](https://o7planning.org/en/11765/spring-boot-file-download-example)

# mysql - mySQL：使用 LIMIT 的问题

> ID：15800572
> 
> 赞同：0
> 
> 时间：2013-04-04T00:27:03.827
> 
> 标签：mysql, sql

我正在尝试查询 200 个用户，但不知道确切`Subj_Id`的 s。因此，我不能只查询一个范围`Subj_Ids`（尽管我知道我想从 200 开始），而是需要对`Subj_Ids`我正在查询的范围设置一个限制。我试过了：

```
SELECT *
    FROM session2
    WHERE Subj_Id > 200
    AND Subj_Id IN (
        SELECT Subj_Id
            FROM userdata
            WHERE `Primary Lang` != ''
            OR `Primary Lang` != '-'
            OR `Primary Lang` != '--'
    )
    LIMIT 200; 
```

但是，它只返回少数`Subj_Ids`. 这是我的语法问题还是我正在使用的数据库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:34:04.103

在子查询中选择您想要的用户，然后重新加入以获取会话。

您不清楚表格的格式。下面假设每个表都有一个`user_id`和那个`user_id`/`subj_id`定义一个会话：

```
select s.*
from (SELECT user_id, max(subj_id) as maxsi
      FROM session2
      WHERE Subj_Id > 200 AND
            Subj_Id IN (SELECT Subj_Id FROM userdata WHERE `Primary Lang` not in ('', '-', '--') )
      group by user_id
      LIMIT 200
    ) u join
    session2 s
    on u.user_id = s.user_id and s.subj_id = maxsi 
```

# delphi - ReportBuilder + cxGrid = 错误：“画布不允许绘图”

> ID：15800573
> 
> 赞同：2
> 
> 时间：2013-04-04T00:27:06.417
> 
> 标签：delphi, devexpress, reportbuilder, tcxgrid

是否有链接到同一个**DataSource的****cxGrid**和**ReportBuilder**报告。当我打印报告时，它显示错误：***“画布不允许绘图”***。

 ***这是我要解决的代码。

```
 Screen.Cursor := crHourGlass;
  cxGridModeloDBTableView1.DataController.DataSource := nil;
  try
    pprReportBuilder.Print;
  finally
    cxGridModeloDBTableView1.DataController.DataSource := dsModeloView;
    Screen.Cursor := crDefault;
  end; 
```

任何人都可以通过另一种方式帮助我解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T13:19:21.453

我的猜测是 ReportBuilder 正在导航数据集以创建报告，但 cxGrid 并不期望这样。

而不是解耦数据源，尝试使用`cxGrid.BeginUpdate`and `cxGrid.EndUpdate`before 和 after`pprReportBuilder.Print`像这样：

```
 Screen.Cursor := crHourGlass;
  cxGridModeloDBTableView1.BeginUpdate;
  try
    pprReportBuilder.Print;
  finally
    cxGridModeloDBTableView1.EndUpdate;
    Screen.Cursor := crDefault;
  end; 
```

高温高压***

# java - 使用按位运算进行基数排序

> ID：15800575
> 
> 赞同：0
> 
> 时间：2013-04-04T00:27:09.987
> 
> 标签：java, bit-manipulation, binaryfiles, radix-sort

我需要创建一个执行基数排序的方法，该方法使用按位运算符（>>、<<、&、|）从值中检索单个位。

该文件看起来像这样：

```
0100
1
0011
110
0010
101
0001
11
0000 
```

我目前已读入文件（其大小未知）。起初我将它们作为整数读入，但意识到我正在截断前导零。所以我将它们存储到 String[] 中。

```
public static void readFile(String fileName) throws FileNotFoundException, IOException
{
    File file = new File(fileName);

    byte[] bytes = new byte[(int) file.length()];
    try (FileInputStream fis = new FileInputStream(file))
    {
        fis.read(bytes);
    }

    String[] value = new String(bytes).split("\\s+");
    numbers = new String[value.length];
    System.arraycopy(value, 0, numbers, 0, value.length);

} // end of import file 
```

这是我目前导入该文件的方法，该文件正在运行。我的所有其他方法都在工作，除了基数排序，我不确定从哪里开始按位运算。

我有排序如何工作的概念，但实施它似乎更具挑战性。

问候，

麦克风

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T04:09:01.720

我将使用递归排序将数组划分为 3 个新数组：下一个数字 = 0 的数组，下一个数字 = 1 的数组和没有下一个数字的数组。因此，您的数字将按如下方式排序：

```
Input
0100
1
0011
110
0010
101
0001
11
0000

Step 1
 Array "no next" (empty)
 Array "next = 0"
 0100
 0011
 0010
 0001
 0000
 Array "next = 1"
 1
 110
 101
 11

Step 2 (only showing the array "next = 1")
 Array "no next"
  1
 Array "next = 0"
  101
 Array "next = 1"
  110
  11 
```

继续下去，直到你得到 0 或 1 个大小的数组，这样你就知道它们是排序的。然后你会返回返回排序数组，如[快速排序](https://es.wikipedia.org/wiki/Quicksort)

# java - 在复合键列上映射 @OnetoOne

> ID：15800578
> 
> 赞同：0
> 
> 时间：2013-04-04T00:27:17.613
> 
> 标签：java, hibernate, jpa, orm

首先，我有两个实体文件夹和 FolderObjectID 及其对应的表。

在文件夹表上，我有复合键 FolderID 和 ParentFolderID

```
Table Folder
+----------------+ 
|    Folder      |
+----------------+
|#FolderID       |
|#ParentFolderID |
+----------------+ 
```

在 FolderObjectID 表上，我将 FolderObjectID 作为主键。

```
Table FolderObjectID
+----------------+
| FolderObjectID |
+----------------+
|#FolderObjectID |
+----------------+ 
```

文件夹实体

```
@Entity
@Table(name = "Folder")
public class Folder implements java.io.Serializable {

   private FolderId id;

   //setter getter
} 
```

可嵌入类

```
@Embeddable
public class FolderId implements java.io.Serializable {

  private Integer folderId;
  private Integer parentFolderId;

  //setter getter
} 
```

FolderObjectID 实体

```
@Entity
@Table(name = "FolderObjectID")
public class FolderObjectID implements java.io.Serializable {

   private folderObjectId id;

   //setter getter
} 
```

现在我想要的是使用 Folder 表的 FolderID 列链接到 FolderObjectID 表的 FolderObjectID 列的两个实体上的一对一关系。不幸的是，我收到错误消息说我在文件夹实体上有一个损坏的列。

有人可以在这件事上启发我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T12:29:42.217

你想使用`@MapsId`我猜的功能。与此类似，但我还没有尝试过：

文件夹实体

```
@Entity
@Table(name = "Folder")
public class Folder implements java.io.Serializable {

   @EmbeddedId
   private FolderId id;

   @OneToOne
   @MapsId("folderId")
   private FolderObject folderObject;
} 
```

FolderObjectID 实体

```
@Entity @Table(name = "FolderObjectID")
public class FolderObjectID implements java.io.Serializable {

   @Id
   private long folderObjectId;

   @OneToOne(mappedBy = "folderObject")
   @JoinColumn(name = "folderObjectId") 
   private Folder folder;
} 
```

# ios - 从 AppBundle 与 CoreData 加载图像

> ID：15800589
> 
> 赞同：0
> 
> 时间：2013-04-04T00:28:26.960
> 
> 标签：ios, core-data, app-bundle

我正在制作一个目录，其中我的集合视图中的单元格将是带有标签的图像或 pdf。会有很多集合，它们本身是静态的。我希望用户能够保存他喜欢的单元格并在他自己的自定义视图中查看它们。

1）我可以将图像作为数据存储在 Core Data 中。

2）我可以将图像包含在我的 App Bundle 中，并在每次我的应用启动时从那里加载图像。

我已经意识到从 Core Data Store 读取数据会在构建我的应用程序时为我提供更多选择，并提供一些性能提升，而不是从应用程序包中读取数据。真的吗？当然请记住，大多数数据都是静态的。

在我的应用程序包中同时包含序列化图像和纯数据似乎效率低下。

我想我宁愿把它全部放在商店里，但它们必须在代码中的某个时刻从包中加载，对吗？

我很想知道其他开发人员是如何做到的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:36:20.537

现在在 Core Data 中有一个二进制数据的“允许外部存储”选项，这基本上意味着如果您的文件大于 1 MB，它将自动存储在您的数据库之外，您不必做任何不同的事情。在我看来，这是两全其美的方法，提高性能 + 自动化 + 快速查询（虽然当你允许外部存储时它们比平时慢，但仍然比自己做的快）

# python - 在字典列表中查找值匹配值

> ID：15800595
> 
> 赞同：4
> 
> 时间：2013-04-04T00:29:43.277
> 
> 标签：python

我有一个看起来像这样的字典列表：

```
serv=[{'scheme': 'urn:x-esri:specification:ServiceType:DAP',
  'url': 'http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/air.mon.anom.nobs.nc'},
 {'scheme': 'urn:x-esri:specification:ServiceType:WMS',
  'url': 'http://www.esrl.noaa.gov/psd/thredds/wms/Datasets/air.mon.anom.nobs.nc?service=WMS&version=1.3.0&request=GetCapabilities'},
 {'scheme': 'urn:x-esri:specification:ServiceType:WCS',
  'url': 'http://ferret.pmel.noaa.gov/geoide/wcs/Datasets/air.mon.anom.nobs.nc?service=WCS&version=1.0.0&request=GetCapabilities'}] 
```

我想找到对应的 URL，`ServiceType:WMS`这意味着`url`从这个列表中找到 key 的值，其中`scheme`key 具有 value `urn:x-esri:specification:ServiceType:WMS`。

所以我有这个工作：

```
for d in serv:
    if d['scheme']=='urn:x-esri:specification:ServiceType:WMS':
        url=d['url']
print url 
```

产生

```
http://www.esrl.noaa.gov/psd/thredds/wms/Datasets/air.mon.anom.nobs.nc?service=WMS&version=1.3.0&request=GetCapabilities 
```

但是我刚刚看了[Raymond Hettinger 的 PyCon 演讲](https://speakerdeck.com/pyconslides/transforming-code-into-beautiful-idiomatic-python-by-raymond-hettinger)，最后他说如果你可以把它说成一个句子，它应该用一行 Python 来表达。

那么有没有一种更漂亮、更惯用的方式来实现相同的结果，也许只需要一行 Python 代码？

谢谢，丰富

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:40:37.603

如果您只对一个 URL 感兴趣，那么您可以构建一个生成器，`serv`并`next`在未找到匹配项的情况下使用默认值，例如：

```
url = next((dct['url'] for dct in serv if dct['scheme'] == 'urn:x-esri:specification:ServiceType:WMS'), 'default URL / not found') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T01:01:23.083

您列出的`serv`数组看起来像一个到 URL 的字典映射方案，但它不是这样表示的。不过，您可以轻松地将其转换为`dict`using 列表推导，然后使用普通的字典查找：

```
url = dict([(d['scheme'],d['url']) for d in serv])['urn:x-esri:specification:ServiceType:WMS'] 
```

当然，您可以保存字典版本以供将来使用（以使用两行为代价）：

```
servdict = dict([(d['scheme'],d['url']) for d in serv])
url = servdict['urn:x-esri:specification:ServiceType:WMS'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T15:10:52.113

我会将其分成两行，以将目标与 url 检索分开。这是因为您的目标可能会随着时间而改变，所以这不应该是硬连线的。单行代码如下。

我会使用`in`而不是`==`因为我们想搜索所有这种类型的方案。这增加了更多的灵活性和可读性，假设这也不会捕获其他不需要的方案。但从描述来看，这是所需的功能。

```
target = "ServiceType:WMS"
url = [d['url'] for d in serv if target in d['scheme']] 
```

另外，请注意，这在所有情况下都会返回一个列表，以防有多个匹配项，因此您必须`url`在使用它的代码中循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T00:32:30.253

这个怎么样？

```
urls = [d['url'] for d in serv if d['scheme'] == 'urn:x-esri:specification:ServiceType:WMS']

print urls # ['http://www.esrl.noaa.gov/psd/thredds/wms/Datasets/air.mon.anom.nobs.nc?service=WMS&version=1.3.0&request=GetCapabilities'] 
```

它在做你的代码正在做的同样的事情，在哪里`d['url']`被追加到列表中——`urls`如果它们以`WMS`

你甚至可以添加一个 else 子句：

```
urls = [i['url'] for i in serv if i['scheme'].endswith('WMS') else pass] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-04T00:45:35.317

我一直在尝试将更多的函数式编程融入到我自己的工作中，所以这里有一个非常简单的函数式方法：

```
needle='urn:x-esri:specification:ServiceType:WMS'
url = filter( lambda d: d['scheme']==needle, serv )[0]['url'] 
```

`filter`将返回布尔值和要过滤的列表的函数作为参数。它返回一个元素列表，这些元素`True`在传递给布尔返回函数时返回（在本例中是`lambda`我动态定义的）。因此，要最终获得 url，我们必须获取`filter`返回列表的第 0 个元素。由于那是包含我们想要的 url 的 dict，我们可以`['url']`在整个表达式的末尾添加标签以获取相应的字典条目。

# c++ - 如何从外部循环遍历嵌套的 std::map ？

> ID：15800596
> 
> 赞同：1
> 
> 时间：2013-04-04T00:29:49.277
> 
> 标签：c++

我的谷歌技能让我失望了=(

我有以下地图：

```
std::map<std::string, std::map<std::string, std::string>> spriteSheetMap; 
```

我正在尝试这样做：

```
for (auto &animationKey : killerRabbit->spriteSheetMap) {
    for (auto &animation : animationKey) {
        //why doesn't this work?
    }            
} 
```

实际错误：

```
Invalid range expression of type 'std::__1::pair<const std::__1::basic_string<char>, std::__1::map<std::__1::basic_string<char>, std::__1::basic_string<char>, std::__1::less<std::__1::basic_string<char> >, std::__1::allocator<std::__1::pair<const std::__1::basic_string<char>, std::__1::basic_string<char> > > > >'; no viable 'begin' function available 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:38:56.467

第一个循环调用[`begin()`](http://www.cplusplus.com/reference/map/map/begin/)返回's （`std::pair`即's）。所以迭代这样的一对没有多大意义。我想你想要的是：`value_type``std::map`

```
for (auto &animation : animationKey.second) { 
```

这将遍历内部地图。请记住，同样的事情会发生在`animation`:`animation`将是一对，`animation.first`引用键和`animation.second`引用值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T00:39:33.877

错误是说它不能迭代一对。当您在第一个循环中通过迭代地图获得键值对结果时，以下解决了该问题。

```
for (auto &animation : animationKey.second) 
```

请参阅[map.begin()](http://www.cplusplus.com/reference/map/map/begin/)以查看第一个循环如何将对而不是值输出到 auto 变量的示例。

# c# - 从负数开始填充数组

> ID：15800601
> 
> 赞同：-7
> 
> 时间：2013-04-04T00:30:49.030
> 
> 标签：c#, windows

该数组由 100 个项目组成。我需要初始化从-2开始的序列号的数组元素。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T00:33:28.540

你的意思是`SomeArray[-2]`？这是不可能的，因为`[ ]`括号内的值是索引，它们不能是负数（但索引从 0 开始）......这就像在你的篮子里有负第二个苹果。

但是如果你的意思是价值，你可以通过一个循环轻松地做到这一点

```
for (i=0; i<=100; i++) {
    SomeArray[i] = i-2;
} 
```

# browser - 即使文档模式是固定的，IE8 也会根据浏览器模式以不同的方式呈现网页 - Intranet site

> ID：15800605
> 
> 赞同：1
> 
> 时间：2013-04-04T00:31:12.683
> 
> 标签：browser, internet-explorer-8, mode

我发现 IE8 会根据浏览器模式以不同方式呈现网页，尽管文档模式始终设置为相同。这是IE8的错误吗？

背景是：

*   IE8（SOE 的一部分）正在查看的企业 Intranet。
*   在兼容性设置中勾选以兼容模式显示 Intranet 站点。
*   我通过使用元标记方法为我的 Intranet 页面强制使用文档模式：`<meta http-equiv="X-UA-Compatible" content="IE=edge" />`
*   这导致浏览器模式设置为 IE8 Compat，文档模式设置为 IE8 标准。

到目前为止，这一切都很好，没有任何问题，我期望的页面布局等等。

就在最近添加了一些功能（我不会在这个阶段说什么 - 问题是关于页面呈现模式）并且页面布局不正确。在开发人员工具栏中将浏览器模式更改为 IE8（或在兼容性视图设置中取消勾选）修复了布局问题。这让我感到惊讶，因为文档模式没有改变。

因此，重新限制组合：

*   `Broswer Mode=IE8 Compat, Document Mode=IE8 Standards` **[破碎的]**
*   `Broswer Mode=IE8, Document Mode=IE8 Standards` **[作品]**

文档模式是一样的，唯一改变的是浏览器模式。我认为文档模式是唯一会影响页面渲染的东西，而浏览器模式基本上只会影响请求中发送的 UA 字符串。我是对的，还是我错了？如果我是正确的，那么一旦确定了文档模式，那么浏览器模式应该对渲染完全没有影响。这是IE8中的错误吗？还是我错了？即使使用相同的文档模式，浏览器模式是否会影响渲染？

限制：

*   我无法控制在我们所有用户的兼容性视图设置中取消勾选在兼容性视图中显示 Intranets（公司 Intranet，我们有其他旧版应用程序，太多测试以确保它们都在标准模式下工作，永远不会获得批准制作该类型全球变化）。
*   我没有为所有用户升级浏览器的选项。我们刚刚完成了从 IE6 到 IE8 的 6 个多月的项目升级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-06T08:48:07.777

我意识到这是一个非常古老的问题，但如果它可以帮助任何人：

根据对问题[IE8 browser mode vs document mode的](https://stackoverflow.com/questions/2950598/ie8-browser-mode-vs-document-mode)[回答](https://stackoverflow.com/a/25514196/1184604)，浏览器模式确实“只是”设置了 User-Agent 字符串。但是，由于在评估 IE 条件注释时使用此值，如果 (a) 任何代码直接针对 UA 字符串进行测试，或者 (b) 代码中有 IE 条件注释，浏览器模式可能会对呈现产生影响。

IE8 Compat 的浏览器模式通常会评估为 UA 字符串`MSIE 7.0`，因此，如果您有任何条件注释检查`if lt IE8`，例如，这可能是您的问题的根源。

# java - JAVA：如何搜索地图？

> ID：15800606
> 
> 赞同：2
> 
> 时间：2013-04-04T00:31:23.390
> 
> 标签：java, search, map

我有一个 Map，它的键和集合（包含整数）的值是字符串

假设我的钥匙看起来像“苹果”、“香蕉”、“橙子”等。

用户输入文本，我将其保存为字符串变量。如何在我的地图中搜索相同的键？因此，如果用户键入“apple”，我如何将该字符串提供给方法并让该方法在我的地图中搜索“apple”键并返回与其关联的整数集（值）？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T00:33:25.830

使用[get](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html#get%28java.lang.Object%29)方法

```
 Set<Integer> values = map.get("apple"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T00:36:22.707

您并没有真正*搜索*地图，而是从中检索值：

```
public static void main(String[] args) {
    final Map<String, Set<Integer>> myMap = new HashMap<>();
    //put new values into map
    myMap.put("MyString", new HashSet<Integer>());
    //get Set from Map
    final Set<Integer> mySet = myMap.get("myString");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T00:36:55.567

> 返回与其关联**的整数集（值）？**

地图需要不同的键，因此我假设您的地图声明看起来像`Map<String, List<Integer>> myMap`

检查映射中是否存在键： `myMap.containsKey(key)` 例如 `myMap.containsKey("apple")`

获取与键关联的值： `myMap.get(key)` 例如 `myMap.get("apple")`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-25T15:57:43.700

这是一个实现您需要的代码示例：

```
public <K, V> Set<K> getKeys(Map<K, V> map, V value) {
    Set<K> keys = new HashSet<>();
    for (Entry<K, V> entry : map.entrySet()) {
        if (entry.getValue().equals(value)) {
            keys.add(entry.getKey());
        }
    }
    return keys;
} 
```

# java - Activity 和 AlertDialog 正在启动两次

> ID：15800611
> 
> 赞同：1
> 
> 时间：2013-04-04T00:31:43.797
> 
> 标签：java, android

我有那个`AlertDialog`显示两次，我不知道为什么！该问题不仅适用于`AlertDialogs`; 但是，它也适用`"Activities"`。

请注意，我遇到了 Android 4.0.3 的问题。但是，当我在 Android 2.3.6 上运行应用程序时，一切正常。

为了解决我的问题`Activitie`，我在清单文件中设置了： `android:launchMode="singleInstance"`并且它有效。

但是，这不能为`AlertDialog`s 完成，因为它们在清单文件中没有任何引用来设置它`singleInstance`或类似的东西。

有人告诉我放一个`BreakPoint`以便检查我的代码之后`show()`。但我不知道如何放一个`BreakPoint`以及如何检查。

编辑：

我正在使用 HoloEverywhere 和 SherlockActionBar。我不知道他们有多大的影响。

```
@Override
public boolean onOptionsItemSelected(com.actionbarsherlock.view.MenuItem item) {
    switch(item.getItemId())
    {
    case R.id.action_one:
        alertDialog();
        break;
    case R.id.action_two:
        Intent i = new Intent(this,Info.class);
        startActivity(i);
        overridePendingTransition(0, 0);    
        break;

    }
    return super.onOptionsItemSelected(item);
}

private void alertDialog(){

        AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setTitle("My title");
        AlertDialog alert= builder.create();
        alert.show();

} 
```

在清单文件中`case R.id.action_two`设置后它工作正常。`launchMode="singleInstance"`然而，在`case R.id.action_one`哪个发射`AlertDialog`它仍然开放两次。

```
@Override
    public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
        // TODO Auto-generated method stub
        com.actionbarsherlock.view.MenuInflater inflater = getSupportMenuInflater();
        inflater.inflate(R.menu.action_options, menu);
        return super.onCreateOptionsMenu(menu);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:40:39.107

更改此行：

```
return super.onCreateOptionsMenu(menu); 
```

到：

```
return true; 
```

当您调用 时`super.onCreateOptionsMenu`，它会为菜单中的每个项目附加额外`onMenuItemClickListener`的侦听器，这样会导致记录 2 次点击。

（PS：其实我想通了，本来打算贴出来的，但不得不接电话。不是开玩笑）

# android - 如何在不扩展活动或服务的类中实例化广播接收器

> ID：15800615
> 
> 赞同：1
> 
> 时间：2013-04-04T00:32:27.610
> 
> 标签：android, broadcastreceiver

我有一个实用程序类，它需要能够从另一个类接收广播意图。该实用程序类不扩展 Activity 或 Service。如何在此类中实例化和注册广播接收器？

因为该类不是 Activity 类，所以没有 onCreate 或 onDestroy 回调方法。唯一放置注册接收器的地方是在构造函数中，但是没有 onDestroy 方法，所以我找不到放置取消注册接收器调用的地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:38:39.313

我不知道有什么方法可以做到这一点。您本质上是在问如何实例化一个需要依赖于活动生命周期而不依赖于活动生命周期的类。我建议你重构让你的代码在 onCreate() 和 onDestroy() 中被调用。但请记住，可以随时创建和销毁活动。如果您在应用程序中使用多个活动，当您从一个活动切换到另一个活动时，您将遇到接收广播的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:44:09.057

将实用程序类传递给您的应用程序实例，`Context`您可以使用它来注册接收器。如果您需要运行响应意图的代码，则*必须*使用 and`Activity`或`Service`。那是安卓。

# html - 你能阻止重定向吗？

> ID：15800619
> 
> 赞同：0
> 
> 时间：2013-04-04T00:32:57.503
> 
> 标签：html, redirect

HTML 重定向适用于许多网站，但不适用于 Youtube、Soundcloud 等网站。

前任：

```
<meta http-equiv="refresh" content="1;url=https://soundcloud.com"> 
```

这不起作用。Soundcloud 是否阻止了重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:38:56.557

不，一个站点不能阻止另一个站点重定向到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:41:11.420

在另一个浏览器中测试并检查您的网络设置 - 网站不可能知道您是如何访问它的 - 他们只能告诉您在您登陆他们的网站之前的位置（通过 HTTP 引荐来源网址）

# javascript - D3js 在线过渡不起作用

> ID：15800620
> 
> 赞同：0
> 
> 时间：2013-04-04T00:32:58.200
> 
> 标签：javascript, d3.js

我正在尝试使用`javascript`和在网页上显示图表`D3js`。

我已经按照[http://bost.ocks.org/mike/path/](http://bost.ocks.org/mike/path/)中的示例开始并扩展了那里显示的图表的功能。

但是，在尝试使用转换来平滑更新我的图表时，我遇到了一些问题。

这是我的更新函数的代码，带有一些额外的注释

```
updateChart= function(){  

            //generate a new point, integer [0 5]
    var newPoint=Math.floor(Math.random() * 5);

    data.push(newPoint);

    // redraw the line
    path
    .attr("d", line)
    .attr("transform", null);

    //update x domain for axis labels - 
    //the new domain is the same as before slided by 1 position
    xDomain=[(xDomain[0]+1),(xDomain[1]+1)];
    xScale.domain(xDomain);

    //slide xAxis       
    svg.select(".x.axis")
    .transition()
    .duration(500)
    .call(xAxis);     //xAxis is my scale function and works fine for labels and data display

    //slide the line to the left  
    path
    .transition()
    .duration(500)
    .ease("linear")
    .attr("transform", "translate(" + xScale(xDomain[0]) + ")");

    // pop the old data point off the front
    data.shift();

}; 
```

我的问题是，虽然轴标签正确地向左滑动一个位置并在 0.5 秒内顺利完成，但该线立即“跳转”到更新的位置，并且不像教程中那样平滑过渡。

当我更新 y 轴范围时，也会发生类似的事情。轴平滑变化，而新线立即跳转到新刻度。

更新：这里是 jsfiddle 的链接：[已删除，没有足够的声誉。这与版本 6 的更新 2 的 jsfiddle 相同]

**更新 2**请在此处找到 jsfiddle 中的工作代码，其中还包括 y 轴刻度的变化。还要注意 y 轴刻度的变化如何在显示的数据中产生 1 个位置的偏移。我也将不胜感激有关此行为的任何意见。谢谢！[已删除，声望不够。这与版本 8 的更新 2 的 jsfiddle 相同]

# 解决了

经过几个小时的尝试和阅读其他示例后，我已经能够解决问题

*   关于沿 x 轴的过渡，问题出在过渡参数中，我应该输入 xScale(xDomain[0]-1) 而不是之前的 xScale(xDomain[0])

*   关于不同比例之间的转换，问题出在我更新 yScale 之前应该发生的线的第一次重绘。通过移动线条

    ```
    path
    .attr("d",line)
    .attr("transform", null); 
    ```

以上

```
 yScale.domain(yDomain); 
```

过渡顺利进行。

希望这会为其他人节省一些时间。在这里你可以找到工作代码 [http://jsfiddle.net/4Z2FY/10/](http://jsfiddle.net/4Z2FY/10/)

正如ChrisJamesC所问，这里是更新y轴范围的相关代码

```
updateRange= function(newDomain){
//update domain
    yDomain=newDomain;

//redraw line BEFORE changing the yScale function 
    path
    .attr("d",line)
    .attr("transform", null);

    //change scale
    yScale.domain(yDomain); 

    //switch to new scale
    svg.select(".y.axis")
    .transition()
    .duration(750)
    .call(yAxis);

    // update the line
    path
    .transition()
    .duration(750)
    .attr("d", line)
    .attr("transform", null);    
} 
```

# css - 我的一个页面上的 CSS 出现问题，页面换行似乎稍微向左跳

> ID：15800621
> 
> 赞同：0
> 
> 时间：2013-04-04T00:33:01.770
> 
> 标签：css, html, tags

我已经将网站上传到互联网，所以你可以明白我的意思，如果你点击我的简历链接，你会注意到 pagewrap div 稍微向左跳。

[http://users.aber.ac.uk/bes16/cs15020/](http://users.aber.ac.uk/bes16/cs15020/)

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:35:55.237

这是因为您访问链接后添加的垂直滚动，如果这就是您所要求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:37:31.427

简单的回答。该页面的内容较长，因此右侧的滚动条会跳入，占用一些空间。所以内容向左跳转。

# javascript - 使用用户输入的文本来引用变量

> ID：15800631
> 
> 赞同：0
> 
> 时间：2013-04-04T00:34:22.527
> 
> 标签：javascript, html

我第一次相信我已经在 stackoverflow 上发布了，我希望我能解释我想尝试和完成的事情。

**为了尽量简洁地表达我的问题，有没有一种方法可以让用户在HTML**中输入一串单词到表单中，然后使用**Javascript**检查这些单词中的任何一个是否与已经声明的变量匹配并且然后引用该变量以便我可以使用保存在那里的值？

例如，我们将声明 var feet = 12，并且用户在文本字段中输入单词“feet”。我希望能够获取用户输入并使用它来引用变量以供以后在代码中使用。

希望能很好地解释我的情况，有人可以提供一些建议

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:39:20.787

如果该变量是全局变量，则可以使用`window[varname]`来获取名称为 in 的变量的值`varname`。

你真的需要允许用户访问任何随机的 Javascript 变量吗？如果没有，更好的方法是使用对象来保存您希望允许用户访问的数据。例如

```
var units = {
  feet: 12,
  inches: 1,
  ...
}

var conversion_factor = units[user_input]; 
```

# python - 从列表中删除偶数

> ID：15800634
> 
> 赞同：0
> 
> 时间：2013-04-04T00:35:27.143
> 
> 标签：python, list

如何从列表中删除偶数？

```
a = []
i = 0

while i < 10:
    c = int(raw_input('Enter an integer: '))
    a.append(c)
    i += 1  # this is the same as i = i + 1
    for i in a:
        if i % 2 == 0:
            a.remove(i)
print(a) 
```

即使在输入 10 之后，它也会一直要求输入数字

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:42:22.350

如果数字是偶数，为什么不阻止追加，而不是添加然后检查删除？

```
a = []
counter = 0
while counter < 10:
    c = int(raw_input('Enter an integer: ')) 
    if c % 2 != 0:
        a.append(c)
    counter += 1
print(a) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T00:40:28.380

`i`由`for`语句重新分配。使用不同的变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T02:11:04.457

如果您想了解如何根据谓词“过滤”列表，这里有一个示例：

```
a_without_even = filter(lambda x: x%2==1, a) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-12-24T13:22:52.240

```
def removalDiffMethod(self, array):
    l=0
    r=len(array)
    while l<r:
        if array[l]%2==0:
            array[l:r] = array[l+1:r+1]
            r-=1
        else:
            l+=1
    return array[:r] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-30T03:03:29.267

像这样的东西？

```
your_dirty_list = [2,3,3,3,4,4,2,2,7,7,8] 
your_clean_list = [clean_dude for clean_dude in your_dirty_list if clean_dude % 2] 
```

输出[]: [3, 3, 3, 7, 7]

# javascript - 具有可见性的 JQuery 无限脉冲函数：隐藏而不是显示：无

> ID：15800643
> 
> 赞同：0
> 
> 时间：2013-04-04T00:36:31.450
> 
> 标签：javascript, jquery, css, ajax, jquery-animate

我有这个无限脉动功能

```
function pulsate(element) {
    $(element || this).delay(150).fadeOut(1000).delay(150).fadeIn(1000, pulsate); 
} 
```

取自 [jQuery：infinite fadeOut $fadeIn effect？](https://stackoverflow.com/questions/11777997/jquery-infinite-fadeout-fadein-effect)

我想用`visibility:hidden`而不是做脉冲效果`display:none`

我读过这个线程 [jQuery fadeOut without display none?](https://stackoverflow.com/questions/4549389/jquery-fadeout-without-display-none) 但仍然令人困惑。如何将这种`visibility:hidden`方法实现到无限脉动功能。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:47:17.200

```
function pulsate(element) {
    $(element || this).animate({ opacity: 0 }, 1000, function() {
        $(this).animate({ opacity: 1 }, 1000, pulsate);
    });
} 
```

[http://jsfiddle.net/QWujL/](http://jsfiddle.net/QWujL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:43:43.543

如果你使用不透明度为0.01的fadeTo而不是fadeOut，我相信元素会保留，但肉眼是看不见的。

这样，您就不必担心完全隐藏可见性。

# mysql - 返回表行的平均值和标准偏差 - MySQL

> ID：15800648
> 
> 赞同：0
> 
> 时间：2013-04-04T00:37:01.650
> 
> 标签：mysql

我的表的一种方式`profile_test`如下所示（列名显示在值的前面）：

```
 1: profile1_test_1 153.3
  2: profile1_test_2 152.7
  3: profile1_test_3 151.5
  4: profile1_test_4 151.4
  5: profile1_test_5 151.7
  6: profile1_test_6 151.8
  7: profile1_test_7 156.7
  8: profile1_test_8 157.0
  9: profile1_test_9 156.8
  10: profile1_test_10 156.7 
```

我想知道如何创建一个查询，该`SQL`查询将返回每一行（而不是整列）的和？数据库是。我想做的是不同列的平均值（它们是不同测试运行的结果，所以了解它们的 avg 和 std 很有趣）。`AVG``STD``MySQL`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:42:47.650

这应该有效：

```
select rowid, avg(profile_test), stddev(profile_test)
from (select rowid,
             (case when n = 1 then profile1_test_1
                   when n = 2 then profile1_test_2
                   . . .
                   when n = 10 then profile1_test_10 
              end) as profile_test
      from profile_test cross join
           (select 1 as n union all select 2 union all select 3 union all select 4 union all select 5 union all
            select 6 union all select 7 union all select 8 union all select 9 union all select 10
           ) nums
      ) t
group by rowid 
```

通过在每一行上编写复杂的算术可能有一种更有效的方法，但这应该适用于中等数据大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:48:29.253

使用 UNION 将所有列放入子查询中的单个列中：

```
select run, avg(val), stddev(val)
from (select run, profile_test_1 val
      from mytable
      union
      select run, profile_test_2 val
      from mytable
      union
      select run, profile_test_3 val
      from mytable
      union
      ...) x
 group by run 
```

# java - 从 Double 到 double 的类转换异常

> ID：15800650
> 
> 赞同：1
> 
> 时间：2013-04-04T00:37:24.040
> 
> 标签：java

为什么将异常从 Double 转换为 double？

像这样使用：

```
Console.writeLine(Validator.TryParse("1.5", double.class)); 
```

代码：

```
public static <T> T TryParse(Object ConvertFrom, java.lang.Class<T> ConvertTo) {
        switch(ConvertTo.getSimpleName().toLowerCase()) {
            case "int":
            case "integer": return ConvertTo.cast((int)Integer.parseInt((String)ConvertFrom));      
            case "string": return ConvertTo.cast(String.valueOf(ConvertFrom));             
            case "double": return ConvertTo.cast((double)Double.parseDouble((String)ConvertFrom));              
            case "float": return ConvertTo.cast((float)Float.parseFloat((String)ConvertFrom));              
            case "long": return ConvertTo.cast((long)Long.parseLong((String)ConvertFrom));          
            default: return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:40:10.063

您正在混合基元和盒装基元。调用`TryParse("1.5", Double.class)`将正常工作（并且您可以删除所有不必要的原始类型转换`(int)` `(double)`等）。

您遇到的问题是`Class#cast`首先检查`Class#isInstance`并：

```
Double.class.isInstance(1.0); 
```

是真的，但是：

```
double.class.isInstance(Double.valueOf(1.0))
double.class.isInstance(1.0d) 
```

[如javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#isInstance%28java.lang.Object%29)中所解释的那样是错误的

> 如果此 Class 对象表示原始类型，则此方法返回 false。

底线：`primitive.class.cast()`总是会抛出异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T01:03:21.633

如果每次调用validator还是需要定义类，为什么不直接使用每个类的valueOf方法呢？诸如 Integer 和 Double 之类的 Object 类将能够处理原语并返回对象...

正如之前被问到的，你确定你需要实现这个吗？您可能想要查看您的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:41:47.707

它应该如下所示，注意**`Double`**.

```
Console.writeLine(Validator.TryParse("1.5", Double.class)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T00:47:49.967

您可以使用`Double.doubleValue()`和`Integer.intValue()`。

更多阅读：

*   [Double.doubleValue()](http://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#doubleValue%28%29)
*   [整数.intValue()](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html#intValue%28%29)

**除了....**

你的方法想要返回一个对象，所以你不能返回原语。

* * *

社论：

似乎您正在尝试做一些非常不自然和非 Java 的事情（Java 是一种类型语言是有原因的）。

# javascript - 使用 jQuery/JavaScript 将货币金额格式化为 0000.00

> ID：15800651
> 
> 赞同：0
> 
> 时间：2013-04-04T00:37:26.463
> 
> 标签：javascript, jquery

我正在尝试将变量格式化为具有特定格式 0000.00 目前我的变量被返回为 1.00 并希望获得 0001.00

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:04:29.460

这是一个非常简短的功能来做你想做的事：

```
function formatNum(num) {
    return ('0000'+num.toFixed(2)).slice(-7);
} 
```

演示：http: [//jsfiddle.net/DuZqk/](http://jsfiddle.net/DuZqk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:45:41.913

我曾经触及过这个话题，并且有这个功能。也许这对你有用。只需使用您的号码和您想要的数字调用该函数。

```
 function pad(num, digits) {
     var padding = '';
     var numdigits = num.toString();
     var parts = numdigits.split(".");

     if (parts[1].length < 2) {
         numdigits = numdigits + "0";
     }

     if (numdigits.length > digits) {
         warning("length number is longer than requested digits");
         return;
     } else {
         for (var i = 0; i < digits; i++) {
             padding += "0";
         }
         var numstr = padding + numdigits;
         numstr = numstr.substr(numdigits.length);
         return numstr;
     }

 } 
```

称呼：

```
pad(1.50, 6); 
```

结果“001.50”

小提琴：http: [//jsfiddle.net/djwave28/gKs3U/8/](http://jsfiddle.net/djwave28/gKs3U/8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:56:17.077

我对整数使用类似的方法，但我假设您正在处理一个字符串，因为 javascript return 1.00 as 1

```
function pad(num, size) {
    var f=num.split(".");
    while (f[0].length < size) f[0] = "0" + f[0];
    return f[0]+f[1];
} 
```

# ios - iOS 虚线字体库

> ID：15800654
> 
> 赞同：1
> 
> 时间：2013-04-04T00:37:42.993
> 
> 标签：ios, objective-c, xcode

我正在编写一个应用程序，我必须以点的形式插入文本，类似于记分牌上的文本。一个例子就像

![在此处输入图像描述](https://i.stack.imgur.com/mcssz.png)

是否有我可以用来执行此操作的 iOS 开源库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:50:21.320

您可以使用 UIFont 使用 .ttf 字体文件轻松完成此操作：

[http://kgriff.posterous.com/45359635](http://kgriff.posterous.com/45359635)

此字体可能适合您：

[http://www.dafont.com/score-board.font](http://www.dafont.com/score-board.font)

# jpeg - 利用 JPG 图像之间的冗余

> ID：15800657
> 
> 赞同：0
> 
> 时间：2013-04-04T00:38:05.077
> 
> 标签：jpeg, grayscale, huffman-code, libpng, lossless-compression

我希望利用一组**相似** `colored JPG`图像之间的冗余。`Set redundancy compression`已成功用于类似`8-bit grayscale`图像。他们基本上找到一组图像的`MAX`和`MIN`，并将原始图像编码为`differences`相对于 MAX 或 MIN 图像，取决于较小的差异。除了 gzip 或 bzip 等普通压缩工具外，使用这种方法对灰度图像进行了大约 20-50%的**额外压缩。**我执行以下操作：

*   将 JPG 图像解压缩到 RGB 字符缓冲区
*   计算 MIN 和 MAX 字符缓冲区
*   将差异字符缓冲区编码为 JPG 图像

问题是要从差异图像中检索原始图像，理想情况下我需要对差异进行无损编码。但是，libjpeg 中没有`lossless`从 RGB->JPG 的转换，即使质量=1.0，因为差异系数**很小**（1~10），我最终丢失了几乎所有信息（几乎所有解码数据都是 1~3） .

为了解决这个问题，我尝试使用`huffman encoding`差异字符缓冲区。

*   使用 Huffman 编码对差异字符缓冲区进行编码

原始 JPG 图像的大小约为 256 KB，相应的 RGB 缓冲区约为 7.8 MB，霍夫曼编码的差异图像大小约为 2.2 MB。因此，霍夫曼编码**确实节省**了大量空间 wrt RGB 缓冲区，但原始 JPG 等价物**要小得多**。

*   有什么建议可以有效地存储这些差异缓冲区的大小与 256 KB 原始文件**相当吗？**`JPG`
*   有没有办法将这些差异缓冲区保存`low valued data coefficients`为 JPG 图像而不会丢失大量信息？

# r - lmFit 和 rlm 有什么区别

> ID：15800660
> 
> 赞同：0
> 
> 时间：2013-04-04T00:38:27.533
> 
> 标签：r

我想在我的微阵列数据上使用强大的 limma，R 的用户指南说 rlm 是正确的函数，根据：

[http://rss.acs.unt.edu/Rdoc/library/limma/html/mrlm.html](http://rss.acs.unt.edu/Rdoc/library/limma/html/mrlm.html)

我目前有：

```
lmFit(ExpressionMatrix, design, method = "robust", na.omit=T) 
```

我可以看到我选择了稳健的方法。这是否意味着 rlm 将被这个 lmFit 调用？如果我不希望它变得健壮，我应该使用什么方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:52:57.300

# 帮助页面说：

```
The function mrlm is used if method="robust". 
```

然后继续：

> 如果method="ls"，则如果已指定相关结构，则使用gls.series，即，如果ndups>1 或block 为非空且相关性不为零。如果 method="ls" 并且没有相关结构，则使用 lm.series。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:51:55.327

`lmFit`如果您按照( `06.LinearModels`)帮助页面中的链接

> ## 拟合模型
> 
> 模型拟合的主要函数是lmFit。这是大多数用户的推荐界面。lmFit 生成 MArrayLM 类的拟合模型对象，其中包含每个基因的系数、标准误差和残差标准误差。lmFit 调用以下三个函数之一来进行实际计算：
> 
> ## `lm.series`
> 
> 每个基因的线性模型的直接最小二乘拟合。
> 
> ## `mrlm`
> 
> lm.series 的替代方法，使用 MASS 包中的 rlm 函数实现的稳健回归。
> 
> ## `gls.series`
> 
> 广义最小二乘法考虑了重复点（即同一阵列上的重复点）或相关阵列之间的相关性。函数 duplicateCorrelation 用于在使用 gls.series 之前估计重复项间或块间相关性。

# asp.net-web-api - 如何构建像 /owners/xxxx/dogs 这样的 web api url？

> ID：15800661
> 
> 赞同：0
> 
> 时间：2013-04-04T00:38:27.610
> 
> 标签：asp.net-web-api, asp.net-mvc-routing

我正在寻找使用 ASP.NET Web API 4.0 构建原型。如何构建类似以下 URI 的路由？

```
/People/PersonId/Dogs

/People/PersonId/Dogs/DogId 
```

其中 People 是控制器，PersonId 是一个 Int，Dogs 是该人拥有的狗的集合，DogId 是特定狗的一个 Int。

我还想要查询字符串选项，例如，

```
/People/PersonId/Dogs?color=white&activity=walking&location=backyard 
```

# java - 摇一摇播放声音

> ID：15800662
> 
> 赞同：0
> 
> 时间：2013-04-04T00:38:29.990
> 
> 标签：java, android, accelerometer, android-mediaplayer

我正在努力做到这一点，以便我的应用程序在我摇动它时播放声音。我认为我的抖动代码有效，但我在使用媒体播放器时遇到了问题。我按照[peceps 对震动的回答，](https://stackoverflow.com/questions/2317428/android-i-want-to-shake-it?rq=1)并使用[Chris 对声音的最终回答。](https://stackoverflow.com/questions/3369068/android-play-sound-on-button-click-null-pointer-exception)显然我没有把它变成 onClick 而是 onShake。

这是我的活动代码。（我得到的唯一错误是 mp）

```
package com.grifball.info;

import com.grifball.info.ShakeDetector.OnShakeListener;

import android.app.Activity;
import android.content.Context;
import android.hardware.Sensor;
import android.hardware.SensorManager;
import android.media.MediaPlayer;
import android.os.Bundle;

public class HammerActivity extends Activity {

private ShakeDetector mShakeDetector;
private SensorManager mSensorManager;

// Declare the MediaPlayer object
private MediaPlayer mMediaPlayer;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.hammer_page);

    // ShakeDetector initialization
    mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    mShakeDetector = new ShakeDetector();  

    mShakeDetector.setOnShakeListener(new ShakeDetector.OnShakeListener() {
        public void onShake() {
            // Initialize media player
            mMediaPlayer = MediaPlayer.create(HammerActivity.this, R.raw.hammer);

            // Add OnCompletionListener to release the 
            mMediaPlayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {
                @Override
                public void onCompletion(MediaPlayer mp) {
                    mMediaPlayer.release();
  }
            });
            mMediaPlayer.start();
    });
    };

    @Override
    protected void onResume() {
      super.onResume();
      mSensorManager.registerListener(mShakeDetector,
          mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER),
          SensorManager.SENSOR_DELAY_UI);
    }

    @Override
    protected void onPause() {
      mSensorManager.unregisterListener(mShakeDetector);
      super.onStop();
    }} 
```

这是我的 ShakeDetector 代码。

```
package com.grifball.info;

import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;

/**
 * Listener that detects shake gesture.
 */
public class ShakeDetector implements SensorEventListener {

  /** Minimum movement force to consider. */
  private static final int MIN_FORCE = 10;

  /**
   * Minimum times in a shake gesture that the direction of movement needs to
   * change.
   */
  private static final int MIN_DIRECTION_CHANGE = 3;

  /** Maximum pause between movements. */
  private static final int MAX_PAUSE_BETHWEEN_DIRECTION_CHANGE = 200;

  /** Maximum allowed time for shake gesture. */
  private static final int MAX_TOTAL_DURATION_OF_SHAKE = 400;

  /** Time when the gesture started. */
  private long mFirstDirectionChangeTime = 0;

  /** Time when the last movement started. */
  private long mLastDirectionChangeTime;

  /** How many movements are considered so far. */
  private int mDirectionChangeCount = 0;

  /** The last x position. */
  private float lastX = 0;

  /** The last y position. */
  private float lastY = 0;

  /** The last z position. */
  private float lastZ = 0;

  /** OnShakeListener that is called when shake is detected. */
  private OnShakeListener mShakeListener;

  /**
   * Interface for shake gesture.
   */
  public interface OnShakeListener {

    /**
     * Called when shake gesture is detected.
     */
    void onShake();
  }

  public void setOnShakeListener(OnShakeListener listener) {
    mShakeListener = listener;
  }

  @Override
  public void onSensorChanged(SensorEvent se) {
    // get sensor data
    float x = se.values[SensorManager.DATA_X];
    float y = se.values[SensorManager.DATA_Y];
    float z = se.values[SensorManager.DATA_Z];

// calculate movement
float totalMovement = Math.abs(x + y + z - lastX - lastY - lastZ);

if (totalMovement > MIN_FORCE) {

  // get time
  long now = System.currentTimeMillis();

  // store first movement time
  if (mFirstDirectionChangeTime == 0) {
    mFirstDirectionChangeTime = now;
    mLastDirectionChangeTime = now;
  }

  // check if the last movement was not long ago
  long lastChangeWasAgo = now - mLastDirectionChangeTime;
  if (lastChangeWasAgo < MAX_PAUSE_BETHWEEN_DIRECTION_CHANGE) {

    // store movement data
    mLastDirectionChangeTime = now;
    mDirectionChangeCount++;

    // store last sensor data 
    lastX = x;
    lastY = y;
    lastZ = z;

    // check how many movements are so far
    if (mDirectionChangeCount >= MIN_DIRECTION_CHANGE) {

      // check total duration
      long totalDuration = now - mFirstDirectionChangeTime;
      if (totalDuration < MAX_TOTAL_DURATION_OF_SHAKE) {
        mShakeListener.onShake();
        resetShakeParameters();
      }
    }

  } else {
    resetShakeParameters();
  }
}
  }

  /**
   * Resets the shake parameters to their default values.
   */
  private void resetShakeParameters() {
    mFirstDirectionChangeTime = 0;
    mDirectionChangeCount = 0;
    mLastDirectionChangeTime = 0;
    lastX = 0;
    lastY = 0;
    lastZ = 0;
  }

  @Override
  public void onAccuracyChanged(Sensor sensor, int accuracy) {
  }

} 
```

这是我的 OnCompletionListener 代码。包 com.grifball.info；

```
import android.media.MediaPlayer;

public class OnCompletionListener {

public void onCompletion(MediaPlayer mp) {
    // TODO Auto-generated method stub

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:11:28.500

我的猜测是你在这里搞混`interface`了`class`。

你的`OnCompletionListener` **课**完全没有必要。除非您在代码的其他地方使用它，否则您可以安全地删除它。

`MediaPlayer.setOnCompletionListener()`将类型**接口**`MediaPlayer.OnCompletionListener`作为参数。该界面已经为您存在。

至于你的其余代码。您从不声明您的 MediaPlayer 对象`mp`。它只是突然出现在里面`onShake()`。

```
public class HammerActivity extends Activity {

private ShakeDetector mShakeDetector;
private SensorManager mSensorManager;

// Declare the MediaPlayer object
private MediaPlayer mMediaPlayer;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // ShakeDetector initialization
    mSensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
    mShakeDetector = new ShakeDetector();  

    mShakeDetector.setOnShakeListener(new ShakeDetector.OnShakeListener() {
        public void onShake() {
            // Initialize media player
            mMediaPlayer = MediaPlayer.create(HammerActivity.this, R.raw.hammer);

            // Add OnCompletionListener to release the 
            mMediaPlayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {
                @Override
                public void onCompletion(MediaPlayer mp) {
                    mMediaPlayer.release();
                }
            });
            mMediaPlayer.start();
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T03:02:56.327

获取下面的代码并将其移至您的`onCreate()`方法

```
 mMediaPlayer = MediaPlayer.create(HammerActivity.this, R.raw.hammer);

            // Add OnCompletionListener to release the 
            mMediaPlayer.setOnCompletionListener(new MediaPlayer.OnCompletionListener() {
                @Override
                public void onCompletion(MediaPlayer mp) {
                    mMediaPlayer.release();
  }
            }); 
```

另请查看[SensorManager 文档](http://developer.android.com/reference/android/hardware/SensorManager.html)

```
protected void onResume() {
         super.onResume();
         mSensorManager.registerListener(this, mAccelerometer, SensorManager.SENSOR_DELAY_NORMAL);
     }

     protected void onPause() {
         super.onPause();
         mSensorManager.unregisterListener(this);
     } 
```

请注意：我只是从 SensorManager 文档中剪切并粘贴代码。您必须使其适应您的代码；我的主要观点是您的 onPause 声明是错误的。

# asterisk - 星号扩展中没有音频

> ID：15800663
> 
> 赞同：0
> 
> 时间：2013-04-04T00:38:36.057
> 
> 标签：asterisk

我有一个入站号码，我想连接到我的手机。我遇到的问题是，除非我使用音乐暂停标志，否则我不会收到任何音频。例如：

```
exten => 1**********,1,Dial(SIP/1**********@flowroute,30,m) 
```

上面的效果很好，我的手机响了，电话接通了，我们可以通话了。现在，当我因为需要铃声而删除音乐标志或尝试铃声标志时，它会连接到我的手机，但是当我回答时，我得到的只是沉默：

```
exten => 1**********,1,Dial(SIP/1**********@flowroute,30)
exten => 1**********,1,Dial(SIP/1**********@flowroute,30,r) 
```

以上都不起作用。

有人遇到过这个或者有解决办法吗？

[已解决] 我在一般区域下的 sip.conf 中添加了 progressinband=yes。现在，当我在没有标记的情况下拨打电话时，它会响起，并且在我接听后有音频。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T05:09:55.010

进行 SIP 跟踪并查看 1* ***对等方在没有“m”或“r”的情况下以什么顺序向您发送的“180 振铃”和/或“183 会话进度”响应中的哪一个，以及哪个具有 SDP。如果它与您收到回铃的情况不同，那么问题出在呼叫对等方，您需要`progressinband`为该对等方尝试不同的设置 ( `yes`/ `no`/ `never`) 才能解决它。

很奇怪，当你在 Dial() 中不使用“m”时，你在回答后会保持沉默。NAT问题？

# highcharts - 为小图表隐藏的 highcharts 上下文菜单

> ID：15800674
> 
> 赞同：1
> 
> 时间：2013-04-04T00:39:09.347
> 
> 标签：highcharts

我正在将仪表板类型屏幕迁移到[highcharts](http://www.highcharts.com/)，并希望使用默认上下文菜单（用于导出各种图像格式和打印图表）。

问题是这些图表中的很多都是小仪表类型的图表，当图表低于一定大小时，上下文菜单会被隐藏，这主要是因为上下文菜单出现在小图表大小的按钮上方。

有没有办法让上下文菜单总是出现在按钮下方？我知道我可以限制选项，这将解决问题，但理想情况下我希望使用默认选项列表。此外，我真的不想自己计算位置并移动它。

见[jsfiddle](http://jsfiddle.net/4MnYw/1/)

```
see code at jsfiddle 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T06:33:29.733

将以下样式添加到上下文菜单。

```
.highcharts-contextmenu {
    bottom: auto !important;
    top: 5px;
} 
```

**[小提琴](http://jsfiddle.net/maheshsapkal/xBUXK/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:47:14.700

不确定它是否适合您的情况，但您是否考虑过使用底部带有图例的饼图？

[http://www.highcharts.com/demo/pie-legend](http://www.highcharts.com/demo/pie-legend)

# python - 将单个项目和项目序列添加到数据框和系列

> ID：15800675
> 
> 赞同：0
> 
> 时间：2013-04-04T00:39:14.277
> 
> 标签：python, pandas

说我有一个数据框`df`

```
import pandas as pd
df = pd.DataFrame() 
```

我有以下元组和值：

```
column_and_row = ('bar', 'foo')
value = 56 
```

我怎样才能最容易地将此​​元组**添加**到我的数据框中，以便：

```
df['bar']['foo'] 
```

回报`56`？

如果我有这样的元组列表和值列表怎么办？例如

```
columns_and_rows = [A, B, C, ...]
values = [5, 10, 15] 
```

其中`A`和是列`B`和`C`行的元组（类似于`column_and_row`）。

同样，如何使用`Series`? 来完成此操作，例如：

```
import pandas as pd
srs = pd.Series() 
```

我想用索引和值向它**添加**一项，以便：`'foo'``2`

```
srs['foo'] 
```

回报`2`？

**注意：** 我知道这些**都不**是创建`dataframes`or的有效方法`series`，但我需要一个解决方案，让我在别无选择时以这种方式有机地扩展我的结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T00:44:19.487

对于系列，您可以使用 来完成`append`，但您必须首先根据您的值创建系列：

```
>>> print x
A    1
B    2
C    3
>>> print x.append( pandas.Series([8, 9], index=["foo", "bar"]))
A      1
B      2
C      3
foo    8
bar    9 
```

对于 DataFrame，您也可以使用`append`or `concat`，但仅对单个单元格执行此操作没有意义。DataFrames 是表格的，因此您只能添加整行或整列。 [该文档](http://pandas.pydata.org/pandas-docs/stable/merging.html#concatenating-objects)有很多示例，并且对此还有[其他问题](https://stackoverflow.com/questions/10715965/add-one-row-in-a-pandas-dataframe)。

编辑：显然你实际上可以用`df.set_value('newRow', 'newCol', newVal)`. 但是，如果该行/列不存在，这实际上将创建一个全新的行和/或列，而创建的行/列中的其余值将填充为 NaN。请注意，在这种情况下，将返回一个新对象，因此您必须`df = df.set_value('newRow', 'newCol', newVal)`修改原始对象。

然而，现在不管你怎么做，这将是低效的。Pandas 数据结构基于 Numpy，并且从根本上依赖于提前知道数组的大小。您可以添加行和列，但每次这样做都会创建全新的数据结构，因此如果您经常这样做，它会比使用普通的 Python 列表/dicts 慢。

# javascript - 如何检测 Django 中浏览器的关闭？

> ID：15800682
> 
> 赞同：2
> 
> 时间：2013-04-04T00:39:46.743
> 
> 标签：javascript, django, browser

我想知道如何检测浏览器的关闭以及如何根据 Django Web 框架中的检测触发功能。如果可能的话，有人请用代码片段指导我。

我尝试使用 JavaScript。它在 Firefox 中有效，但在 Chrome 中无效。

任何帮助表示赞赏。

干杯梅奥。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:49:50.793

```
window.onbeforeunload = function (e) {

  var e = e || window.event;

  if (e) {
    // do something here
  }

}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:49:04.380

您需要使用 JS 并将同步 XMLHttpRequest 调用绑定到 unload DOM 事件。

```
$(window).unload(function() {
  $.ajax({url:"pageExit", async:false});
}); 
```

# java - 在精确的时间间隔内获取 GPS 位置

> ID：15800686
> 
> 赞同：0
> 
> 时间：2013-04-04T00:40:21.813
> 
> 标签：java, android, timer, gps, refresh

我试图在不同的间隔范围内尽可能精确地获得 gps 位置，我几乎没有外部 gps、10hz、5hz 和 1hz

```
 LocationManager locationManager = (LocationManager) 
car.this.getSystemService(car.this.LOCATION_SERVICE);

    LocationListener locationListener = new LocationListener() {
                public void onLocationChanged(Location location) {
                    // Called when a new location is found

                }
                public void onStatusChanged(String provider, int status, Bundle extras) {}

                public void onProviderEnabled(String provider) {}

                public void onProviderDisabled(String provider) {}
            };

    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, 
locationListener); 
```

通过这种方式，我在匀速行驶时得到这样的日志更新

```
10hz GPS

81ms  new position
79ms  new position
88ms  new position
96ms  new position
196ms new positon
60ms  new positon
256ms new position
70ms  new position

5 hz GPS

187ms new...
189ms ..
275ms ..
140ms ..
180ms ..
220ms .. 
```

所以我认为 onStatusChanged 最初比标称频率快，但随后饱和并导致大跳跃

如果我使用计时器，效果很好，我每 100 毫秒（200 或 1000）获得一次位置，但计时器每 10 秒关闭 100 毫秒

编辑：为澄清起见，我想在每个精确（或接近）100ms、200ms 或 1000ms 时获得一个位置

*** *更新 12-04-13

在重做我的代码以使用 location.getTime() 之后，这是结果，所有测试都是在外部以中/高速进行的，并且每个设备在 10 分钟内进行记录

```
HTC Sensation Z710e 4.0.3 Internal GPS 1HZ

Average Accuracy: 12.1m       
Average intertval: 1186ms
Min: 98ms
Max: 2621ms

HTC Desire HD 4.0.4 Internal GPS 1HZ

Average Accuracy: 10.6m        
Average intertval: 1211ms
Min: 144ms
Max: 2588ms

ASUS Transformer TF101 4.0.4 Internal GPS 1HZ

Average Accuracy: 18.15m       
Average intertval: 1000MS
Min: 1000ms
Max: 1000ms

SAMSUNG NOTE II GT-N7100 4.1.2 Internal GPS 1HZ (Glonass)

Average Accuracy: 6.8m          
Average intertval: 1000MS
Min: 1000ms
Max: 1001ms

SAMSUNG, HTC OR ASUS  with external GPS 5HZ

Average Accuracy: 2.2m  
Average intertval: 200MS
Min: 200ms
Max: 200ms

SAMSUNG, HTC OR ASUS  with external GPS 10HZ (Glonass)

Average Accuracy: 1.6m    
Average intertval: 100MS
Min: 100ms
Max: 100ms 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T19:17:39.563

收到位置时不要查看（系统）时间戳，查看位置本身的时间戳，如果它是通过 GPS 传递的，它应该正好是 1000 毫秒（1/hz）。

Gps 接收器从不发送奇数毫秒，当使用 1hz 时，它们正好是 1000 毫秒。使用 location.getTime()，看看你自己。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:46:01.253

在虚拟化的多线程应用程序中没有精确的时间间隔。无论您是否使用计时器，当操作系统开始运行您的线程时，您都会收到通知。

# java - 用完ram java时写入磁盘

> ID：15800687
> 
> 赞同：3
> 
> 时间：2013-04-04T00:40:27.777
> 
> 标签：java, memory, jvm

我正在用非常大的数据测试数据结构的性能。

作为临时解决方法（[请参见此处](https://stackoverflow.com/questions/15799476/64-bit-java-wont-allocate-more-than-2gb-of-heap-memory?noredirect=1#comment22467888_15799476 "看这里")），我想将内存写入磁盘。

我想用非常大的数据集进行测试 - 我怎样才能做到这一点，以便当 java VM 内存不足时，它会将其中的一些写入磁盘？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:51:30.060

由于我们在这里讨论的是*临时*修复，如果您需要一些额外的空间，您可以随时增加您的页面文件（大多数 Linux 发行版中的交换文件）

这是来自 Microsoft 的链接：http: [//windows.microsoft.com/en-us/windows-vista/change-the-size-of-virtual-memory](http://windows.microsoft.com/en-us/windows-vista/change-the-size-of-virtual-memory)

Linux： [http ://www.cyberciti.biz/faq/linux-add-a-swap-file-howto/](http://www.cyberciti.biz/faq/linux-add-a-swap-file-howto/)

现在让我说这不是一个好的长期修复，但我知道有时开发人员只需要让它工作。如果这是在生产环境中看到的东西，您可能想看看像 Hadoop 这样的工具。它允许您将数据处理分布在多个 JVM 上——一种为您所描述的“大数据”应用程序构建的工具

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T20:16:02.873

也许你可以使用流，或者一些缓冲的。我认为这将是测试这种结构的最佳选择。如果您可以使用流从磁盘读取并且不会生成任何其他对象（仅是必要的对象），那么您可以为您的结构拥有所有 jvm 内存。但也许你可以更多地描述你的问题？

# c# - WebBrowser 在 ajax 调用完成之前触发 DocumentCompleted

> ID：15800699
> 
> 赞同：0
> 
> 时间：2013-04-04T00:42:00.567
> 
> 标签：c#, .net

似乎 WebBrowser 并不关心是否正在进行 ajax 调用，它只是在加载主 html 和图像时触发 DocumentCompleted ...

那么是否有可能知道包含所有 ajax 调用的页面何时完成？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-04T00:44:51.767

听起来您需要实现异步 ajax 调用。

[如何让 jQuery 执行同步而不是异步的 Ajax 请求？](https://stackoverflow.com/questions/133310/how-can-i-get-jquery-to-perform-a-synchronous-rather-than-asynchronous-ajax-re)

或者，在成功时，设置告诉您呼叫何时返回的标志。

# css - 图片标签/元素显示问题

> ID：15800700
> 
> 赞同：0
> 
> 时间：2013-04-04T00:42:07.207
> 
> 标签：css, html

我正在尝试在我的代码中实现新的 HTML5 图片标签，但是，当遵循 W3C 关于元素的指南时，它只显示后备图像，而不是调整大小时应该显示的图像。

我不确定图片容器是否需要 CSS 样式以确保在调整大小时切换图像。

任何帮助将不胜感激！

```
<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="Style.css">
</head>
<body>
<div id="container">
<div id="header">
</div> <!-- end of header -->

<nav>
<ul>

<li id="HomeButton">
<a href="index.html"><img id="HomeText" src="Images/Icons/HomeText.png" /></a>
</li>

<li id="WhatsWhatButton">
<a href="whatswhat.html"><img id="WhatsWhatText" src="Images/Icons/WhatsWhatText.png" /></a>
</li>

<li id="FoodFromPlantsButton">
<a href="foodfromplants.html"><img id="FoodFromPlantsText" src="Images/Icons/FoodFromPlantsText.png" /></a>
</li>

<li id="HowPlantsGrowButton">
<div id="HowPlantsGrowText">
<a href="howplantsgrow.html"><img src="Images/Icons/HowPlantsGrowText.png" /></a>
</div>
<div id="HowPlantsGrowIcon"></div>
</li>

<li id="PlantGameButton">
<a href="plantGame.html"><img id="PlantGameText" src="Images/Icons/PlantGameText.png" /></a>
</li>
</ul>
</nav> <!-- end of nav -->

<div id="page">
<div id="content">

<img class="title" src="Images/Icons/FoodFromPlantsTitle.png" width="250" height="100"/>

<picture alt="angry pirate">
   <source src=Images/Icons/HomeIcon.png media="min-width:800px">
   <source src=Images/Icons/FoodFromPlantsIcon.png media="min-width:480px">
   <source src=Images/Icons/PlantGame.png>
      <!-- fallback for browsers without support -->
      <img src=Images/Icons/WhatsWhatIcon.png alt="angry pirate">
</picture>

</div> <!-- end of content -->
</div> <!-- end of page -->

<footer>
</footer> <!-- end of footer -->
</div>  <!-- end of container -->
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-30T14:32:36.777

您尝试使用的浏览器很可能还不支持该`<picture>`元素。但是，它正在 Chrome、Firefox 和 WebKit/Safari 的最新版本中使用。

[在得到支持之前，请使用来自http://scottjehl.github.io/picturefill/](http://scottjehl.github.io/picturefill/)的官方 polyfill 。请注意，它需要一些时髦的标记才能在 IE 中工作，并且如果 JS 失败或被关闭，则根本不会显示图像（遗憾的是，没有办法解决这个问题）。

# linux - Postgresql 的 Linux 独立“安装”

> ID：15800701
> 
> 赞同：2
> 
> 时间：2013-04-04T00:42:17.437
> 
> 标签：linux, postgresql, deployment

为了便于部署，我想将 Postgres 安装作为应用程序的一部分提供。是否可以包含可以作为进程启动的已编译且可运行的 Postgres 版本？我能够用 Windows 和 MacOS 版本做这样的事情，但在这方面还没有发现任何关于 Linux 的信息。也许有人以前尝试过这个并且可以分享一些见解......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:30:01.780

您还没有说明您使用的是什么 linux 操作系统。

假设它是 Redhat 变体，为什么不将您的应用程序打包为 RPM 包？然后，您可以声明对标准 Postgres 包的依赖，该包将自动安装[yum](http://fedoraproject.org/wiki/Yum)。如果您使用的是基于 Debian 的系统，同样的原则也适用，只是打包格式不同。

从用户的角度来看，操作系统的本机打包格式始终是安装应用程序的最简单方法。只需要努力正确包装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-11T07:28:47.507

您可以从 PostgreSQL 官方网站上的这些页面中找到跨平台二进制文件：

*   对于简单的 GUI .run 安装程序，请使用[http://www.enterprisedb.com/products-services-training/pgdownload](http://www.enterprisedb.com/products-services-training/pgdownload)提供的链接。
*   如果您的目标机器上没有安装 X，或者您想使用 shell 脚本自动化安装过程，那么您可以从[http://community.openscg.com/se/postgresql/packages.jsp下载 RPM 或 Deb 包](http://community.openscg.com/se/postgresql/packages.jsp)

[我在http://www.postgresql.org/download/linux/ubuntu/](http://www.postgresql.org/download/linux/ubuntu/)的“交叉分发包”和“图形安装程序”下找到了这些链接。

我从这些页面中引用：

> 注意：交叉分发包不与特定平台的打包系统完全集成。
> 
> 您必须具有 root 权限才能安装这些软件包，但是，您的系统库文件都不会被更改。这些二进制文件所需的支持库作为安装的一部分包含在本地。这是允许相同的二进制文件在不同的 Linux 发行版上运行的“特殊酱汁”。

# c++ - 在结构中创建结构

> ID：15800703
> 
> 赞同：4
> 
> 时间：2013-04-04T00:42:34.950
> 
> 标签：c++, winapi, visual-c++

我正在将在 Visual c++ 6.0 中创建的旧 C Windows 驱动程序项目导入到 Visual Studio 2012 中。定义结构的方式导致 vs2012 中的错误。

```
typedef struct {
    LINK               Link;
    HANDLE             hFile;
    BYTE               handleType;
    OVERLAPPED         Overlapped;
    CRITICAL_SECTION   csIoCtrl;
} USB_HANDLE, *PUSB_HANDLE;

typedef struct {
    USB_HANDLE;        //error occurs here saying nothing was declared for USB_HANDLE
    LIST               PipeList;
    BOOL               bRemoved;
    CRITICAL_SECTION   csPipeList;
    SP_DEVICE_INTERFACE_DETAIL_DATA *InterfaceData;
} USB_DEVICE, *PUSB_DEVICE; 
```

然后该项目使用 USB_DEVICE mydevice 之类的调用；mydevice->hfile =句柄；

这种结构在vs2012中是否可行？

（编辑 - 虽然这些确实显示为错误，但 Visual Studio 2012 确实编译并成功构建了一个解决方案。我将测试驱动程序以查看是否一切正常。）

错误：

[![结构声明错误信息](https://i.stack.imgur.com/bElt3.png)](https://i.stack.imgur.com/bElt3.png)

[![会员错误信息](https://i.stack.imgur.com/sr1C5.png)](https://i.stack.imgur.com/sr1C5.png)

我认为可以使用的解决方法是制作 USB_DEVICE 结构：

```
typedef struct {
    USB_HANDLE         USB_HANDLE;        
    LIST               PipeList;
    BOOL               bRemoved;
    CRITICAL_SECTION   csPipeList;
    SP_DEVICE_INTERFACE_DETAIL_DATA *InterfaceData;
} USB_DEVICE, *PUSB_DEVICE; 
```

然后我可以进行其余的调用： mydevice->USB_HANDLE.hfile = handle;

这是一个等效的陈述吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:00:12.277

定义一个宏来声明`USB_HANDLE`，然后在两者中使用它。喜欢，

```
#define HANDLE_BODY                \
   LINK               Link;        \
   HANDLE             hFile;       \
   BYTE               handleType;  \
   OVERLAPPED         Overlapped;  \
   CRITICAL_SECTION   csIoCtrl;

typedef struct {
   HANDLE_BODY
} USB_HANDLE, *PUSB_HANDLE;

typedef struct {
    HANDLE_BODY
    LIST               PipeList;
    BOOL               bRemoved;
    CRITICAL_SECTION   csPipeList;
    SP_DEVICE_INTERFACE_DETAIL_DATA *InterfaceData;
} USB_DEVICE, *PUSB_DEVICE; 
```

`union`如果您也需要，您可以创建一个。否则，您可能需要一些特殊的非标准编译器选项。例如，许多编译器支持`transparent_union`，这也可以解决您的问题。但是，我认为 Visual C++ 不支持这一点。但也许对这些产品更了解的人可以提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T04:57:37.253

USB_DEVICE 中的 USB_HANDLE 类型似乎没有定义任何变量。

```
typedef struct {
    USB_HANDLE         handler;  // handler is missing?
    LIST               PipeList;
    BOOL               bRemoved;
    CRITICAL_SECTION   csPipeList;
    SP_DEVICE_INTERFACE_DETAIL_DATA *InterfaceData;
} USB_DEVICE, *PUSB_DEVICE; 
```

# python - 获取图像大小而不将图像加载到内存中

> ID：15800704
> 
> 赞同：141
> 
> 时间：2013-04-04T00:42:43.037
> 
> 标签：python, image, image-processing

我了解您可以通过以下方式使用 PIL 获取图像大小

```
from PIL import Image
im = Image.open(image_filename)
width, height = im.size 
```

但是，我想获得图像的宽度和高度*，而不*必将图像加载到内存中。那可能吗？我只对图像大小进行统计，并不关心图像内容。我只是想让我的处理速度更快。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-09-26T18:06:55.030

如果您不关心图像内容，那么 PIL 可能是矫枉过正。

我建议解析python魔术模块的输出：

```
>>> t = magic.from_file('teste.png')
>>> t
'PNG image data, 782 x 602, 8-bit/color RGBA, non-interlaced'
>>> re.search('(\d+) x (\d+)', t).groups()
('782', '602') 
```

这是一个围绕 libmagic 的包装器，它读取尽可能少的字节以识别文件类型签名。

脚本的相关版本：

[https://raw.githubusercontent.com/scardine/image_size/master/get_image_size.py](https://raw.githubusercontent.com/scardine/image_size/master/get_image_size.py)

[更新]

> 嗯，不幸的是，当应用于 jpeg 时，上面给出了“'JPEG 图像数据，EXIF 标准 2.21'”。没有图片大小！——亚历克斯·弗林特

似乎 jpeg 具有抗魔力。:-)

我明白为什么：为了获得 JPEG 文件的图像尺寸，您可能需要读取比 libmagic 喜欢读取的更多字节。

卷起我的袖子，带来了这个不需要第三方模块的[未经测试的片段（从 GitHub 获取） 。](https://github.com/scardine/image_size)

![看，妈！ 没有部门！](https://i.stack.imgur.com/DFowD.png)

```
#-------------------------------------------------------------------------------
# Name:        get_image_size
# Purpose:     extract image dimensions given a file path using just
#              core modules
#
# Author:      Paulo Scardine (based on code from Emmanuel VAÏSSE)
#
# Created:     26/09/2013
# Copyright:   (c) Paulo Scardine 2013
# Licence:     MIT
#-------------------------------------------------------------------------------
#!/usr/bin/env python
import os
import struct

class UnknownImageFormat(Exception):
    pass

def get_image_size(file_path):
    """
    Return (width, height) for a given img file content - no external
    dependencies except the os and struct modules from core
    """
    size = os.path.getsize(file_path)

    with open(file_path) as input:
        height = -1
        width = -1
        data = input.read(25)

        if (size >= 10) and data[:6] in ('GIF87a', 'GIF89a'):
            # GIFs
            w, h = struct.unpack("<HH", data[6:10])
            width = int(w)
            height = int(h)
        elif ((size >= 24) and data.startswith('\211PNG\r\n\032\n')
              and (data[12:16] == 'IHDR')):
            # PNGs
            w, h = struct.unpack(">LL", data[16:24])
            width = int(w)
            height = int(h)
        elif (size >= 16) and data.startswith('\211PNG\r\n\032\n'):
            # older PNGs?
            w, h = struct.unpack(">LL", data[8:16])
            width = int(w)
            height = int(h)
        elif (size >= 2) and data.startswith('\377\330'):
            # JPEG
            msg = " raised while trying to decode as JPEG."
            input.seek(0)
            input.read(2)
            b = input.read(1)
            try:
                while (b and ord(b) != 0xDA):
                    while (ord(b) != 0xFF): b = input.read(1)
                    while (ord(b) == 0xFF): b = input.read(1)
                    if (ord(b) >= 0xC0 and ord(b) <= 0xC3):
                        input.read(3)
                        h, w = struct.unpack(">HH", input.read(4))
                        break
                    else:
                        input.read(int(struct.unpack(">H", input.read(2))[0])-2)
                    b = input.read(1)
                width = int(w)
                height = int(h)
            except struct.error:
                raise UnknownImageFormat("StructError" + msg)
            except ValueError:
                raise UnknownImageFormat("ValueError" + msg)
            except Exception as e:
                raise UnknownImageFormat(e.__class__.__name__ + msg)
        else:
            raise UnknownImageFormat(
                "Sorry, don't know how to get information from this file."
            )

    return width, height 
```

[2019年更新]

查看 Rust 实现：[https ://github.com/scardine/imsz](https://github.com/scardine/imsz)

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2013-09-26T17:37:46.777

正如评论所暗示的，PIL 在调用时不会将图像加载到内存中`.open`。查看 的文档`PIL 1.1.7`，文档字符串为`.open`：

```
def open(fp, mode="r"):
    "Open an image file, without loading the raster data" 
```

源代码中有一些文件操作，例如：

```
 ...
 prefix = fp.read(16)
 ...
 fp.seek(0)
 ... 
```

但这些几乎不构成阅读整个文件。实际上`.open`只是简单地返回一个文件对象和成功时的文件名。此外，[文档](https://pillow.readthedocs.org/en/1.7.8/pythondoc-PIL.Image.html)说：

> 打开（文件，模式=“r”）
> 
> 打开并识别给定的图像文件。
> 
> 这是一个惰性操作；此函数识别文件，但在您尝试处理数据（或调用**load**方法）之前，不会从文件中读取实际的图像数据。

深入挖掘，我们看到`.open`调用`_open`是特定于图像格式的重载。每个实现`_open`都可以在一个新文件中找到，例如。.jpeg 文件位于`JpegImagePlugin.py`. 让我们深入研究一下。

这里的事情似乎有点棘手，其中有一个无限循环，当找到 jpeg 标记时会中断：

```
 while True:

        s = s + self.fp.read(1)
        i = i16(s)

        if i in MARKER:
            name, description, handler = MARKER[i]
            # print hex(i), name, description
            if handler is not None:
                handler(self, i)
            if i == 0xFFDA: # start of scan
                rawmode = self.mode
                if self.mode == "CMYK":
                    rawmode = "CMYK;I" # assume adobe conventions
                self.tile = [("jpeg", (0,0) + self.size, 0, (rawmode, ""))]
                # self.__offset = self.fp.tell()
                break
            s = self.fp.read(1)
        elif i == 0 or i == 65535:
            # padded marker or junk; move on
            s = "\xff"
        else:
            raise SyntaxError("no marker found") 
```

如果格式错误，它看起来*可以读取整个文件。*但是，如果它读取信息标记 OK，它应该会提前爆发。该函数`handler`最终设置`self.size`图像的尺寸。

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2018-09-13T20:18:58.680

pypi 上有一个名为的包`imagesize`，目前对我有用，虽然它看起来不是很活跃。

安装：

```
pip install imagesize 
```

用法：

```
import imagesize

width, height = imagesize.get("test.png")
print(width, height) 
```

主页：[https ://github.com/shibukawa/imagesize_py](https://github.com/shibukawa/imagesize_py)

[皮皮： https](https://pypi.org/project/imagesize/) ://pypi.org/project/imagesize/

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-02-04T19:02:08.310

我经常在 Internet 上获取图像尺寸。当然，你不能下载图像然后加载它来解析信息。太费时间了。我的方法是将块提供给图像容器并测试它是否每次都可以解析图像。当我得到我想要的信息时停止循环。

我提取了代码的核心并对其进行了修改以解析本地文件。

```
from PIL import ImageFile

ImPar=ImageFile.Parser()
with open(r"D:\testpic\test.jpg", "rb") as f:
    ImPar=ImageFile.Parser()
    chunk = f.read(2048)
    count=2048
    while chunk != "":
        ImPar.feed(chunk)
        if ImPar.image:
            break
        chunk = f.read(2048)
        count+=2048
    print(ImPar.image.size)
    print(count) 
```

输出：

```
(2240, 1488)
38912 
```

实际文件大小为 1,543,580 字节，您只需读取 38,912 字节即可获得图像大小。希望这会有所帮助。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-11-04T16:48:00.423

OP 对“更快”的解决方案很感兴趣，我对最快的解决方案很好奇，我正在尝试用真实世界的基准来回答这个问题。

我在比较：

*   `cv2.imread`：[https ://www.kite.com/python/docs/cv2.imread](https://www.kite.com/python/docs/cv2.imread)
*   `PIL.open`：[https ://pillow.readthedocs.io/en/stable/reference/Image.html](https://pillow.readthedocs.io/en/stable/reference/Image.html)
*   `opsdroid/image_size`：[https](https://github.com/opsdroid/image_size) ://github.com/opsdroid/image_size （打包版[https://raw.githubusercontent.com/scardine/image_size/master/get_image_size.py](https://raw.githubusercontent.com/scardine/image_size/master/get_image_size.py)）
*   `shibukawa/imagesize_py`：[https ://github.com/shibukawa/imagesize_py](https://github.com/shibukawa/imagesize_py)
*   `kobaltcore/pymage_size`：[https ://github.com/kobaltcore/pymage_size](https://github.com/kobaltcore/pymage_size)

我在 202897 主要是 JPG 文件上运行以下代码。

```
"""
pip install opsdroid-get-image-size --user
pip install pymage_size
pip install imagesize
"""

import concurrent.futures
from pathlib import Path

import cv2
import numpy as np
import pandas as pd
from tqdm import tqdm
from PIL import Image
import get_image_size
import imagesize
import pymage_size

files = [str(p.resolve())
         for p in Path("/data/").glob("**/*")
         if p.suffix in {".jpg", ".jpeg", ".JPEG", ".JPG", ".png", ".PNG"}]

def get_shape_cv2(fname):
    img = cv2.imread(fname)
    return (img.shape[0], img.shape[1])

with concurrent.futures.ProcessPoolExecutor(8) as executor:
    results = list(tqdm(executor.map(get_shape_cv2, files), total=len(files)))

def get_shape_pil(fname):
    img=Image.open(fname)
    return (img.size[0], img.size[1])

with concurrent.futures.ProcessPoolExecutor(8) as executor:
    results = list(tqdm(executor.map(get_shape_pil, files), total=len(files)))

def get_shape_scardine_size(fname):
    try:
        width, height = get_image_size.get_image_size(fname)
    except get_image_size.UnknownImageFormat:
        width, height = -1, -1
    return (width, height)

with concurrent.futures.ProcessPoolExecutor(8) as executor:
    results = list(tqdm(executor.map(get_shape_scardine_size, files), total=len(files)))

def get_shape_shibukawa(fname):
    width, height = imagesize.get(fname)
    return (width, height)

with concurrent.futures.ProcessPoolExecutor(8) as executor:
    results = list(tqdm(executor.map(get_shape_shibukawa, files), total=len(files)))

def get_shape_pymage_size(fname):
    img_format = pymage_size.get_image_size(fname)
    width, height = img_format.get_dimensions()
    return (width, height)

with concurrent.futures.ProcessPoolExecutor(8) as executor:
    results = list(tqdm(executor.map(get_shape_pymage_size, files), total=len(files))) 
```

结果：

*   `cv2.imread`: 8m23s
*   `PIL.open`: 2m00s
*   `opsdroid/image_size`: 29 秒
*   `shibukawa/imagesize_py`: 29 秒
*   `kobaltcore/pymage_size`: 29 秒

所以 opsdroid、shibukawa 和 kobaltcore 以相同的速度执行。现在对我来说另一个有趣的点是更好地了解哪些库具有最好的格式支持。

[编辑] 所以我继续测试快速库是否提供不同的结果：

```
# test if the libs provide the same results
def show_size_differences(fname):
    w1, h1 = get_shape_scardine_size(fname)
    w2, h2 = get_shape_pymage_size(fname)
    w3, h3 = get_shape_shibukawa(fname)
    if w1 != w2 or w2 != w3 or h1 != h2 or h2 != h3:
        print(f"scardine: {w1}x{h1}, pymage: {w2}x{h2}, shibukawa: {w3}x{h3}")

with concurrent.futures.ProcessPoolExecutor(8) as executor:
    results = list(tqdm(executor.map(show_size_differences, files), total=len(files))) 
```

他们没有。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-06-13T09:08:38.737

在 Unix 系统上执行此操作的另一种简短方法。这取决于`file`我不确定在所有系统上是否标准化的输出。这可能不应该在生产代码中使用。此外，大多数 JPEG 不报告图像大小。

```
import subprocess, re
image_size = list(map(int, re.findall('(\d+)x(\d+)', subprocess.getoutput("file " + filename))[-1])) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-24T05:20:37.840

这个[答案](https://stackoverflow.com/a/20380514/153487)有另一个很好的分辨率，但缺少*pgm*格式。这个[答案](https://stackoverflow.com/a/7369986/153487)已经解决了*pgm*。我添加了*bmp*。

代码如下

```
import struct, imghdr, re, magic

def get_image_size(fname):
    '''Determine the image type of fhandle and return its size.
    from draco'''
    with open(fname, 'rb') as fhandle:
        head = fhandle.read(32)
        if len(head) != 32:
            return
        if imghdr.what(fname) == 'png':
            check = struct.unpack('>i', head[4:8])[0]
            if check != 0x0d0a1a0a:
                return
            width, height = struct.unpack('>ii', head[16:24])
        elif imghdr.what(fname) == 'gif':
            width, height = struct.unpack('<HH', head[6:10])
        elif imghdr.what(fname) == 'jpeg':
            try:
                fhandle.seek(0) # Read 0xff next
                size = 2
                ftype = 0
                while not 0xc0 <= ftype <= 0xcf:
                    fhandle.seek(size, 1)
                    byte = fhandle.read(1)
                    while ord(byte) == 0xff:
                        byte = fhandle.read(1)
                    ftype = ord(byte)
                    size = struct.unpack('>H', fhandle.read(2))[0] - 2
                # We are at a SOFn block
                fhandle.seek(1, 1)  # Skip `precision' byte.
                height, width = struct.unpack('>HH', fhandle.read(4))
            except Exception: #IGNORE:W0703
                return
        elif imghdr.what(fname) == 'pgm':
            header, width, height, maxval = re.search(
                b"(^P5\s(?:\s*#.*[\r\n])*"
                b"(\d+)\s(?:\s*#.*[\r\n])*"
                b"(\d+)\s(?:\s*#.*[\r\n])*"
                b"(\d+)\s(?:\s*#.*[\r\n]\s)*)", head).groups()
            width = int(width)
            height = int(height)
        elif imghdr.what(fname) == 'bmp':
            _, width, height, depth = re.search(
                b"((\d+)\sx\s"
                b"(\d+)\sx\s"
                b"(\d+))", str).groups()
            width = int(width)
            height = int(height)
        else:
            return
        return width, height 
```

# c++ - C++ - while(getline) 没有得到文件的第一行

> ID：15800705
> 
> 赞同：1
> 
> 时间：2013-04-04T00:42:46.853
> 
> 标签：c++, reset, ifstream, getline

我一直在研究一个 C++ 程序，我在其中读取文件内容然后复制到另一个文件，但它似乎总是跳过第一行。我见过其他人对此有问题，他们使用了这些代码行：

```
file.clear();
file.seekg(0); 
```

重置位置，但它对我不起作用。我已经在多个地方尝试过，但仍然没有运气。有任何想法吗？这是我的代码。

```
ofstream write("Mar 23 2013.txt");

for(int x = 1; x <= 50; x++){

    stringstream ss;
    ss << "MAR23_" << x;

    ifstream file(ss.str().c_str());

    if(!file.is_open())
        cout << ss.str() << " could not be opened/found." << endl;
    else{  

        while(getline(file,line)){

            file >> time >> ch >> sensor1 >> ch >> temp >> ch >> 
                    sensor2 >> ch >> sensor3;

            file.ignore(numeric_limits<streamsize>::max(), '\n');

            //output = convertEpoch(time);

            write << time << "  Temperature:" << temp << "ºF  S1:" <<
                        sensor1 << "  S2:" << sensor2 << "  S3:" << 
                        sensor3 << endl;

        }
        file.close();
    }  
}

write.close();

return 0; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T00:46:03.700

您错过了第一行，因为您将其读入`line`. 事实上，你应该错过的不仅仅是第一行。

从文件中读取后，请使用字符串流。

```
while (std::getline(infile, line))
{
    std::istringstream iss(line);
    iss>> time >> ch >> sensor1 >> ch >> temp >> ch >> 
                    sensor2 >> ch >> sensor3;
// ...

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T00:51:02.047

您可以通过两种方式读取文本文件。逐行、使用`getline`或逐项使用`>>`。`getline`将一行文本读入其参数；`getline`在您的代码中调用 to 之后，`line`有已读入​​的文本。完成此操作后，提取器`file >> time >> ch ...`从停止的位置读取`getline`。

# angularjs - NetworkError：405方法不允许AngularJS REST

> ID：15800709
> 
> 赞同：12
> 
> 时间：2013-04-04T00:43:15.650
> 
> 标签：angularjs

在 AngularJS 中，我有以下功能，效果很好：

```
$http.get( "fruits.json" ).success( $scope.handleLoaded ); 
```

现在我想将它从一个文件更改为一个 url（使用一些甜蜜的 Laravel 4 返回 json）：

`$http.get( "http://localhost/fruitapp/fruits").success( $scope.handleLoaded );`

我得到的错误是：

```
"NetworkError: 405 Method Not Allowed - http://localhost/fruitapp/fruits" 
```

有什么问题？是因为fruit.json 是“本地”而 localhost 不是吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T01:22:05.797

从[w3](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)：

```
10.4.6 405 Method Not Allowed

The method specified in the Request-Line is not allowed for the resource 
identified by the Request-URI. The response MUST include an Allow header 
containing a list of valid methods for the requested resource. 
```

这意味着对于 URL：`http://localhost/fruitapp/fruits`服务器正在响应该 `GET`方法是不允许的。是一个`POST`还是`PUT`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-28T06:05:43.830

您使用的 Angular js 版本将是 <= 1.2.9。

如果是，试试这个。

```
return $http({                
    url: 'http://localhost/fruitapp/fruits',
    method: "GET",
    headers: {
        'Content-Type': 'application/json', 
        'Accept': 'application/json' 
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-04T00:19:38.613

我的 SpringBoot 项目遇到了类似的问题，我在浏览器控制台中遇到了同样的错误，但是当我查看后端日志时看到了不同的错误消息，它抛出了这个错误：“org.springframework.web. HttpRequestMethodNotSupportedException, message=Request method 'DELETE' not supported " 原来我在后端控制器中缺少 {id} 参数：

```
** Wrong code :** 
@RequestMapping(value="books",method=RequestMethod.DELETE)
	public Book delete(@PathVariable long id){
	Book deletedBook = bookRepository.findOne(id);
	bookRepository.delete(id);
	return deletedBook;
}

** Correct code :** 

@RequestMapping(value="books/{id}",method=RequestMethod.DELETE)
	public Book delete(@PathVariable long id){
		Book deletedBook = bookRepository.findOne(id);
		bookRepository.delete(id);
		return deletedBook;
}
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-21T20:36:13.093

对我来说，这是没有为 CORS 配置的服务器。这是我在 Azure 上的做法： 在 Azure 上[启用 CORS](https://docs.microsoft.com/en-us/azure/app-service-api/app-service-api-cors-consume-javascript) 我希望类似的东西也适用于您的服务器。我还找到了如何在 web.config 上配置 CORS 的建议，但不能保证：[在 web.config 中配置 CORS](http://enable-cors.org/server_iis7.html)。一般来说，您的服务器有一个预检请求，如果您做了一个跨域请求（即来自您服务器之外的另一个 url），您需要允许服务器上的所有来源（Access-Control-Allow-Origin *)。

# asp.net-mvc - Web 安全 - 防止来自 fiddler 等工具的发布请求

> ID：15800711
> 
> 赞同：2
> 
> 时间：2013-04-04T00:43:20.817
> 
> 标签：asp.net-mvc, http, https, security, fiddler

使用 fiddler 我可以拦截一个 ajax 发布请求，并且使用请求编写器我可以重新发送相同的请求，从而导致服务器正常响应它。协议是 http 还是 https（fiddler 解密 HTTPS 流量）并不重要，使用 Fiddler 之类的工具是可能的。

在 Web 应用程序方面，是否可以理解或阻止此类请求？如何？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T01:00:34.663

不，没有办法阻止这种情况。URL 是用来访问的。如果不应该访问它，请不要将其放到网上或要求某种身份验证方法。一些客户端可能会传递一个可识别的可被限制的 User-Agent 标头，Fiddler 可能也会这样做。然而，像 Fiddler 这样的工具的全部意义在于能够发出任何类型的自定义请求，其中包括这个 User-Agent 字符串。因此，即使您阻止了默认的 User-Agent，也没有什么能阻止 Fiddler 的用户将 User-Agent 更改为不会被阻止的东西。

# maven - 更改 Maven 项目的 {user}

> ID：15800713
> 
> 赞同：2
> 
> 时间：2013-04-04T00:43:42.843
> 
> 标签：maven, licensing, netbeans-7.3

我已经添加了：

```
<licenses>
  <license>
    <name>The Apache Software License, Version 2.0</name>
    <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
    <distribution>repo</distribution>
    <comments>A business-friendly OSS license</comments>
  </license>
</licenses> 
```

到我的 pom 文件中，并且 Apache 许可证整齐地出现在我创建的每个新源文件中。但是，许可证文本显示为：

```
/*
 * Copyright 2013 MyUserName.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
   ...
 */ 
```

我希望它是

```
/*
 * Copyright 2013 OldCurmudgeon <--- Note the new name.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
   ...
 */ 
```

这个字段看起来像是来自一个`{user}`属性，或者模板建议的。有什么办法可以在每个项目的基础上改变它？

* * *

**在对以下提供的选项进行一些试验后得到**答案。****

 **我对 pom 文件更改是正确的。

我选择了 Apache-2.0 许可证。您显然需要对您选择的许可证进行调整。

添加到您的 pom 文件中：

```
<licenses>
  <license>
    <name>The Apache Software License, Version 2.0</name>
    <url>http://www.apache.org/licenses/LICENSE-2.0.txt</url>
    <distribution>repo</distribution>
    <comments>A business-friendly OSS license</comments>
  </license>
</licenses> 
```

更改 Java 模板*（工具/模板/Java/Java 类（以及您希望的任何其他）/在编辑器中打开（按钮））*：

改变：

```
 ...
 * @author ${user}
 ... 
```

到

```
 ...
 * @author ${project.property.user}
 ... 
```

然后更改许可证文件*（工具/模板/许可证/您选择的许可证/在编辑器中打开（按钮））*：

```
...
${licensePrefix}Copyright ${date?date?string("yyyy")} ${project.organization!user}.
... 
```

到

```
...
${licensePrefix}Copyright ${date?date?string("yyyy")} ${project.property.user}.
... 
```

然后添加到您的 pom 文件中：

```
<properties>
  <!-- For the License -->
  <user>OldCurmudgeon</user>
</properties> 
```

你完成了。可惜我不得不更改许可证文件。也许在以后的 NetBeans 版本中，这将不是必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T02:15:22.653

### 用户属性

1.  选择工具 ---> 模板，然后单击设置按钮。

2.  编辑`User.properties file`以建立`user property`：例如，`user=your full name <your email/contact info>`

默认情况下，`user property`in`User.properties file` **被注释掉**。取消注释并编辑此行以向模板处理器提供一个漂亮的字符串。请注意向此文件添加其他属性然后在自定义模板中使用它们的可能性。

我希望这可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T18:53:12.637

如果你想要一个 PROJECT 特定的方式（User.properties 是全局的），你将不得不更改许可证头模板。将值从 ${user} 更改为 ${project.property.user}，然后在每个项目 pom.xml 文件中的 project/properties pom 元素中声明一个“用户”属性。请参阅此[netbeans.org 问题](https://netbeans.org/bugzilla/show_bug.cgi?id=206321)**

# php - 在 PHP 中使用键功能而不覆盖相同的键

> ID：15800719
> 
> 赞同：0
> 
> 时间：2013-04-04T00:44:35.347
> 
> 标签：php, key

我想从数组中的数组中提取数据。但问题是，当我使用 key 功能时，它会覆盖第一个条目。我希望得到 135 行的结果，但它只给我 114 行。

下面是我遇到问题的代码..

```
while($row1 = mssql_fetch_array($result1)) {
        $mycount = $mycount + 1;
        $boskey = $row1["EAN11"]."^".$row1["AUART"];
        $boskey1 = $row1["ORDNUM"]."^".$row1["ERDAT"]."^".$row1["KUNAG"]."^".$row1["NAME1"]."^".$row1["PERNR"]."^".$row1["FKIMG"]."^".$row1["BASEPRICE"]."^".$row1["NETPRICE"]."^".$row1["ZZMAXDISC"]."^".$row1["MVGR1"]."^".$row1["KDGRP"];
        $bos[$boskey][$boskey1] = $bos[$boskey][$boskey1];

    }

        for ($i = 0; $i < count($bos); $i++) {
            $abc = key($bos);   

            $arr = explode("^",$abc);
            $ean11 = $arr[0];
            $auart = $arr[1];

            echo $ean11 . " - " . $auart;

            for ($j = 0; $j < count($bos[$abc]); $j++) { //total count of $bos[$abc] is 114.
                $xxx = key($bos[$abc]);
                $arr1 = explode("^",$xxx);

                $ordnum = $arr1[0];
                $docdate = $arr1[1];
                $customer = $arr1[2];
                $name1 = $arr1[3];
                $ae = $arr1[4];
                $qty = $arr1[5];
                $baseprice = $arr1[6];
                $netprice = $arr1[7];
                //$discount = $arr1[8];
                $booktype = $arr1[9];
                $kdgrp = $arr1[10];
                $discount = 100 - (100 * ( $netprice / $baseprice)); 
```

# c++ - 使用 MPI_Gatherv() 和 MPI_Datatype 在 C++ 中“收集”动态分配的二维数组

> ID：15800720
> 
> 赞同：1
> 
> 时间：2013-04-04T00:44:39.743
> 
> 标签：c++, parallel-processing, mpi

我认为描述问题的最简单方法是使用简单的代码。在每个处理器上，我都动态分配了“二维数组”（通过 new*[rows],new[cols] 形式实现，请参阅下面的代码进行说明）。对或错，我正在尝试使用已提交的 MPI_Datatype 来帮助我执行 MPI_Gatherv() 以将所有数组收集到根处理器上的单个 2D 数组中。

这是代码，在它下面我突出显示了它的要点（如果编译并运行它应该很容易理解 - 它会询问您想要的数组的尺寸）：

```
#include <iostream>
#include <string>
#include <cmath>
#include <cstdlib>
#include <time.h>

#include "mpi.h" 

using namespace std;

// A function that prints out the 2D arrays to the terminal.
void print_2Darray(int **array_in,int dim_rows, int dim_cols) {
    cout << endl;
    for (int i=0;i<dim_rows;i++) {
        for (int j=0;j<dim_cols;j++) {
            cout << array_in[i][j] << " ";
            if (j==(dim_cols-1)) {
                cout << endl;
            }
        }
    }
    cout << endl;
}

int main(int argc, char *argv[]) {

    MPI::Init(argc, argv);

    // Typical MPI incantations...

    int size, rank;

    size = MPI::COMM_WORLD.Get_size(); 
    rank = MPI::COMM_WORLD.Get_rank();

    cout << "size = " << size << endl;
    cout << "rank = " << rank << endl;

    sleep(1);

    // Dynamically allocate a 2D square array of user-defined size 'dim'.

    int dim;
    if (rank == 0) {
        cout << "Please enter dimensions of 2D array ( dim x dim array ): ";
        cin >> dim;
        cout << "dim = " << dim << endl;
    }   

    MPI_Bcast(&dim,1,MPI_INT,0,MPI_COMM_WORLD);

    int **array2D;
    array2D = new int*[dim];
    for (int i=0; i<dim; i++) {
        array2D[i] = new int[dim](); // the extra '()' initializes to zero.
    }

    // Fill the arrays with i*j+rank where i and j are the indices.
    for (int i=0;i<dim;i++) {
        for (int j=0;j<dim;j++) {
            array2D[i][j] = i*j + rank;
        }
    }

    // Print out the arrays.
    print_2Darray(array2D,dim,dim);

    // Commit a MPI_Datatype for these arrays.
    MPI_Datatype MPI_ARRAYROW;
    MPI_Type_contiguous(dim, MPI_INT, &MPI_ARRAYROW);
    MPI_Type_commit(&MPI_ARRAYROW);

    // Declare 'all_array2D[][]' which will contain array2D[][] from all procs.
    int **all_array2D;
    all_array2D = new int*[size*dim];
    for (int i=0; i<size*dim; i++) {
        all_array2D[i] = new int[dim]();  // the extra '()' initializes to zero.
    }

    // Print out the arrays.
    print_2Darray(all_array2D,size*dim,dim);

    // Displacement vector for MPI_Gatherv() call.
    int *displace;
    displace = (int *)calloc(size,sizeof(int));
    int *dim_list;
    dim_list = (int *)calloc(size,sizeof(int));
    int j = 0;
    for (int i=0; i<size; i++) {
        displace[i] = j;
        cout << "displace[" << i << "] = " << displace[i] << endl;
        j += dim;
        dim_list[i] = dim;
    }

    // MPI_Gatherv call.
    MPI_Barrier(MPI_COMM_WORLD);
    MPI_Gatherv(array2D,dim,MPI_ARRAYROW,all_array2D,&dim_list[rank],&displace[rank],MPI_ARRAYROW,0,MPI_COMM_WORLD);

    // Print out the arrays.
    print_2Darray(all_array2D,size*dim,dim);

    MPI::Finalize();

    return 0;
} 
```

代码编译，但遇到分段错误（我用'mpic++'编译并使用'mpirun -np 2'来使用2个处理器）：

```
[unknown-78-ca-39-b4-09-4f:02306] *** Process received signal ***
[unknown-78-ca-39-b4-09-4f:02306] Signal: Segmentation fault (11)
[unknown-78-ca-39-b4-09-4f:02306] Signal code: Address not mapped (1)
[unknown-78-ca-39-b4-09-4f:02306] Failing at address: 0x0
[unknown-78-ca-39-b4-09-4f:02306] [ 0] 2   libSystem.B.dylib                   0x00007fff844021ba _sigtramp + 26
[unknown-78-ca-39-b4-09-4f:02306] [ 1] 3   ???                                 0x0000000000000001 0x0 + 1
[unknown-78-ca-39-b4-09-4f:02306] [ 2] 4   gatherv2Darrays.x                   0x00000001000010c2 main + 1106
[unknown-78-ca-39-b4-09-4f:02306] [ 3] 5   gatherv2Darrays.x                   0x0000000100000a98 start + 52
[unknown-78-ca-39-b4-09-4f:02306] *** End of error message ***
mpirun noticed that job rank 0 with PID 2306 on node unknown-78-ca-39-b4-09-4f.home exited on signal 11 (Segmentation fault). 
1 additional process aborted (not shown) 
```

在代码末尾附近执行“print_2Darray(all_array2D,size*dim,dim)”函数时会发生分段错误，其中“all_array2D”“应该”包含收集的数组。更具体地说，代码似乎为从主处理器收集的位打印“all_array2D”OK，但是当 print_2Darray() 函数开始处理来自其他处理器的位时，会给出 seg 错误。

代码要点：

1.  我声明了一个 MPI_Datatype，它是一个连续的内存块，其大小足以存储单行二维数组。然后我使用 MPI_Gatherv() 来尝试收集这些行。
2.  代码的 sleep(1) 调用只是为了帮助用户更清楚地看到“dims”的提示，否则它会被隐藏在“size”和“rank”之间。
3.  二维数组的元素被初始化为值“i*j + rank”，其中 i 和 j 分别是行和列索引。我的理由是生成的数字很容易放弃生成该数组的处理器的等级。

我想归结为我不知道 MPI_Gatherv() 动态分配数组的正确性...我应该使用 MPI_Datatypes 吗？对我来说，动态分配数组非常重要。

我将非常感谢任何帮助/建议！我的想法几乎耗尽了！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T12:01:33.340

`MPI_Gatherv`, `MPI_Scatterv`, 实际上所有其他采用数组参数的 MPI 通信调用都期望数组元素在内存中连续布局。这意味着在调用`MPI_Gatherv(array2D, dim, MPI_ARRAYROW, ...)`中，MPI 期望类型的第一个元素`MPI_ARRAYROW`从指向的内存位置`array2D`开始，第二个元素从 开始`(BYTE*)array2D + extent_of(MPI_ARRAYROW)`，第三个元素从 开始`(BYTE*)array2D + 2*extent_of(MPI_ARRAYROW)`，依此类推。这里`extent_of()`是`MPI_ARRAYROW`类型的范围，可以通过调用`MPI_Type_get_extent`.

显然，二维数组的行在内存中不是连续的，因为它们中的每一个都是由`new`操作符的单独调用分配的。也不`array2D`是指向数据的指针，而是指向每行指针向量的指针。这在 MPI 中不起作用，并且 StackOverflow 上还有无数其他问题，在这里讨论了这个事实 - 只需`MPI 2D`自己搜索并查看。

解决方案是使用一大块单独分配的内存块和伴随的涂料向量 - 请参阅[这个问题](https://stackoverflow.com/q/13578548/1374437)和`arralloc()`答案中提到的功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T12:00:21.233

这个涉及数组分配的问题在处理 C/C++ 和 MPI 时一直出现。这：

```
int **array2D;
array2D = new int*[dim];
for (int i=0; i<dim; i++) {
    array2D[i] = new int[dim](); // the extra '()' initializes to zero.
} 
```

分配一`dim`维数组，每个数组`dim`的长度为整数。但是，根本没有理由将它们彼此相邻放置 - 暗淡的数组可能分散在内存中。因此，即使从那里发送`dim*dim`整数`array2D[0]`也行不通。`all_array2D`是一样的；您正在创建`size*dim`数组，每个数组 size `dim`，但是它们彼此之间的关系谁知道，这使得您的位移可能是错误的。

要使数组在内存中连续，您需要执行类似的操作

```
int **array2D;
array2D = new int*[dim];
array2D[0] = new int[dim*dim];
for (int i=1; i<dim; i++) {
    array2D[i] = &(array2D[dim*i]);
} 
```

同样对于`all_array2D`. 只有这样你才能开始推理内存布局。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T15:00:52.143

我只是想总结一下@Hristolliev 和@JonathanDursi 帮助我找到的解决方案。

1.  MPI 命令就像`MPI_Gatherv()`处理连续分配的内存块一样，因此使用 ' `new`' 来构造 2D 数组，然后输入 MPI 命令将不起作用，因为 ' `new`' 不能保证连续块。改用 ' `calloc`' 来制作这些数组（请参阅下面的代码作为示例）。
2.  @Hristolliev 的重要一点： MPI_Gatherv() 的第一个和第四个参数必须是指向 type 的第一个元素的指针`MPI_ARRAYROW`。将二维数组解引用一级，例如 array2D[0] 将实现这一点（再次，请参见下面的修改后的工作代码）。

最终的工作代码如下：

```
#include <iostream>
#include <string>
#include <cmath>
#include <cstdlib>
#include <time.h>

#include "mpi.h" 

using namespace std;

void print_2Darray(int **array_in,int dim_rows, int dim_cols) {
    cout << endl;
    for (int i=0;i<dim_rows;i++) {
        for (int j=0;j<dim_cols;j++) {
            cout << array_in[i][j] << " ";
            if (j==(dim_cols-1)) {
                cout << endl;
            }
        }
    }
    cout << endl;
}

int main(int argc, char *argv[]) {

    MPI::Init(argc, argv);

    // Typical MPI incantations...

    int size, rank;

    size = MPI::COMM_WORLD.Get_size(); 
    rank = MPI::COMM_WORLD.Get_rank();

    cout << "size = " << size << endl;
    cout << "rank = " << rank << endl;

    sleep(1);

    // Dynamically allocate a 2D square array of user-defined size 'dim'.

    int dim;
    if (rank == 0) {
        cout << "Please enter dimensions of 2D array ( dim x dim array ): ";
        cin >> dim;
        cout << "dim = " << dim << endl;
    }   

    MPI_Bcast(&dim,1,MPI_INT,0,MPI_COMM_WORLD);

    // Use another way of declaring the 2D array which ensures it is contiguous in memory.
    int **array2D;
    array2D = (int **) calloc(dim,sizeof(int *));
    array2D[0] = (int *) calloc(dim*dim,sizeof(int));
    for (int i=1;i<dim;i++) {
        array2D[i] = array2D[0] + i*dim;
    }

    // Fill the arrays with i*j+rank where i and j are the indices.
    for (int i=0;i<dim;i++) {
        for (int j=0;j<dim;j++) {
            array2D[i][j] = i*j + rank;
        }
    }

    // Print out the arrays.
    print_2Darray(array2D,dim,dim);

    // Commit a MPI_Datatype for these arrays.
    MPI_Datatype MPI_ARRAYROW;
    MPI_Type_contiguous(dim, MPI_INT, &MPI_ARRAYROW);
    MPI_Type_commit(&MPI_ARRAYROW);

    // Use another way of declaring the 2D array which ensures it is contiguous in memory.
    int **all_array2D;
    all_array2D = (int **) calloc(size*dim,sizeof(int *));
    all_array2D[0] = (int *) calloc(dim*dim,sizeof(int));
    for (int i=1;i<size*dim;i++) {
        all_array2D[i] = all_array2D[0] + i*dim;
    }

    // Print out the arrays.
    print_2Darray(all_array2D,size*dim,dim);

    // Displacement vector for MPI_Gatherv() call.
    int *displace;
    displace = (int *)calloc(size,sizeof(int));
    int *dim_list;
    dim_list = (int *)calloc(size,sizeof(int));
    int j = 0;
    for (int i=0; i<size; i++) {
        displace[i] = j;
        cout << "displace[" << i << "] = " << displace[i] << endl;
        j += dim;
        dim_list[i] = dim;
        cout << "dim_list[" << i << "] = " << dim_list[i] << endl;
    }

    // MPI_Gatherv call.
    MPI_Barrier(MPI_COMM_WORLD);
    cout << "array2D[0] = " << array2D[0] << endl;
    MPI_Gatherv(array2D[0],dim,MPI_ARRAYROW,all_array2D[0],&dim_list[rank],&displace[rank],MPI_ARRAYROW,0,MPI_COMM_WORLD);

    // Print out the arrays.
    print_2Darray(all_array2D,size*dim,dim);

    MPI::Finalize();

    return 0;
} 
```

用 编译`mpic++`。

# wordpress - 如何让 wordpress 留在本地？

> ID：15800724
> 
> 赞同：-1
> 
> 时间：2013-04-04T00:45:01.410
> 
> 标签：wordpress

我有一个复制到本地主机（包括数据库）的现有 wordpress。我更改了`wp-config.php`本地主机，但是当我尝试访问 wordpress/wp-admin 时，它连接到我的实时站点...

我需要改变什么？（顺便说一句，使用 XAMMP）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T02:14:00.957

您必须在 Wordpress 数据库中编辑 URL。使用 PhpMyAdmin 或其他 MySQL 浏览器打开您的 WP 数据库，然后打开`wp_options`表。第一个条目是`siteurl`，您必须将其更改为您的 localhost url（如果您有一个示例，请不要忘记包括 localhost 端口：）`http://localhost:8888/wordpress`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T06:31:15.993

将这两行添加到您的 wp-config.php，其中“ `http://localhost/wordpress/`”是您网站的正确位置。

```
define('WP_HOME','http://localhost/wordpress/');
define('WP_SITEURL','http://localhost/wordpress/'); 
```

或检查表 wp_options 列`option_name = siteurl`检查`option_value`

请参阅此处了解更多信息[http://codex.wordpress.org/Changing_The_Site_URL](http://codex.wordpress.org/Changing_The_Site_URL)

# java - Java 问题，测试超时，需要修复我的方法 - 选择

> ID：15800726
> 
> 赞同：-2
> 
> 时间：2013-04-04T00:45:26.627
> 
> 标签：java

嘿，我的项目上的发布测试有这个代码超时，因为它只需要与唯一对象数量成比例的时间，我怎样才能减少时间？

给定一个随机数生成器，根据 Bag 中对象的分布情况从 Bag 中随机选择一个元素（例如，如果一个 Bag 包含 7 个 a 和 3 个 b，那么 70% 的时间选择应该返回一个 a，30%它应该返回 a b 的时间。

此操作所花费的时间与 Bag 中唯一对象的数量成正比，但不会更多。

此操作不应影响 Bag。@param r 随机数生成器 @return 随机选择的元素

```
public T choose(Random r) {
    ArrayList<T> keyArrayList = new ArrayList<T>();
    int index = 0;
    Iterator<T> it = denseBagMap.keySet().iterator();
    while (it.hasNext()){
         T current = it.next();
         while (index < denseBagMap.get(current)){
             keyArrayList.add(current);
             index++;
         }
         index = 0;
    }
    return keyArrayList.get(r.nextInt(keyArrayList.size()));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:54:29.347

如果这是一个 JUnit（即使它看起来不像，您可能希望将它变成一个），您可能希望为测试定义一个[超时](http://junit.sourceforge.net/javadoc/org/junit/Test.html)并减少它的随机性。您还可以使用[参数化](http://junit.sourceforge.net/javadoc/org/junit/runners/Parameterized.html)测试，这将帮助您使用不同的输入值运行测试，但我相信对于所有不同的参数集，超时将是相同的。

# django - Django 异常，选择向管理员报告的内容

> ID：15800727
> 
> 赞同：0
> 
> 时间：2013-04-04T00:45:30.707
> 
> 标签：django, exception-handling, django-middleware

有什么方法可以“告诉” Django 何时向管理员发送电子邮件，何时不向管理员发送电子邮件？例如，我不想在引发 DatabaseError 异常时发送电子邮件。

如果异常是 DatabaseError 类型，我想创建一个中间件并返回 None，但我相信这只会导致调用默认处理程序。

有什么见解或建议可以实现这一点并避免使管理员的收件箱混乱:)？

# webdriver - 如何在 Selenium Webdriver 中移动光标

> ID：15800730
> 
> 赞同：7
> 
> 时间：2013-04-04T00:45:40.727
> 
> 标签：webdriver, selenium-webdriver

编辑：

好的，我已经通过 jquery 小部件检查了代码及其渲染。

结尾

我正在尝试将光标移动到`<a \>`，但问题是元素不会被渲染，直到我将鼠标指针物理地移动到所选图像上。

我怎样才能移动到鼠标悬停在`<a \>`选择/单击？

```
FF version 20
Selenium WebDriver version: 2.31.2.0 
```

当前代码

```
 Actions actions = new Actions(driver);

 int locationX = Convert.ToInt32(ratingElementDiv[i].Location.X);
 int locationY = ratingElementDiv[i].Location.Y;

 actions.MoveToElement(WaitForElement(By.CssSelector(starElement)), locationX, locationY).Click().Perform(); 
```

我没有看到任何行动发生......有什么帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T12:04:51.630

动作由 3 个步骤组成。

*   配置

```
Actions builder = new Actions(driver); 
Point location ratingElementDiv[i].getLocation(); 
builder.MoveToElement(WaitForElement(By.CssSelector(starElement)), location.X, location.Y).click(); 
```

（我不确定点击）

*   采取行动

```
Action selectLink = builder.build(); 
```

*   执行

```
selectLink.perform(); 
```

试试这个，告诉我你是否还有问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-09T10:17:05.413

此链接将为您提供帮助。它解释了键盘和鼠标事件。

[http://www.guru99.com/keyboard-mouse-events-files-webdriver.html](http://www.guru99.com/keyboard-mouse-events-files-webdriver.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-17T20:37:23.360

假设当您单击“选择您的测试”时，您会看到一个包含多个元素（ABC、DEF、GHI 等）的下拉菜单。您要选择 ABC 并单击它。使用以下。

```
driver.findElement(By.linkText("Select Your Test")).click();
new Actions(driver).moveToElement(driver.findElement(By.linkText("ABC"))).click().perform(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-11T06:14:27.770

它对我有用

```
//定位一個按鈕
WebElement button = driver.findElement(By.xpath("//div[@class='page-button']"));
//new 一個移動滑鼠的物件
Actions clickAction = new Actions(driver).click(button);
//執行
clickAction.build().perform(); 
```

# javascript - 在 excel 中生成 html 页面的布局而不是在 css 中创建是否有益？

> ID：15800733
> 
> 赞同：0
> 
> 时间：2013-04-04T00:45:49.190
> 
> 标签：javascript, html, css, d3.js

我正在创建一个用于报告目的的仪表板，使用 html、d3.js 进行可视化和 css 进行布局。该仪表板将由大约 25 人内部使用，并将包含大约 7-8 个组件。我的同事正在争论我们应该在 excel 中设计布局，从中生成 html，然后只插入 d3 组件。他们同意 css 更适合布局，但由于管理层可能会要求我们多次移动/调整组件大小，因此最好在 excel 中创建布局，因为这样可以节省时间来满足他们未来的要求。

我反对这一点的论点首先是，如果 css 正确完成，移动/调整组件大小不会花费太多额外的时间。其次，excel生成的代码丑陋而庞大，即使没有表格数据也包含大量表格，并且比我在css中编写的代码长两倍或三倍。我理解敏捷和节省时间的必要性，但这不是太多了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:54:25.763

在我看来，您的同事使用 Excel 比使用 HTML/CSS 更舒服。

如果您真的只是创建 7 或 8 个容器，那么 HTML 应该很简单，CSS 只需要对每个容器的引用来设置特定的布局标准。

最坏的情况是，如果您无法通过浮动等方式获得所需的布局，您将需要调整容器的大小并可能对它们进行一些重新洗牌。（尽管我想您可以破解它并使用一切的绝对定位）。

如果没有别的，想想必须维护它的穷人。当然，您也可以随时讨论使用表格进行布局。

# python - 如何编辑文本文件中的特定行并将它们写入 Python 中的新文件？

> ID：15800737
> 
> 赞同：0
> 
> 时间：2013-04-04T00:46:21.663
> 
> 标签：python

我的目标是读取一个看起来像这样的文本文件：

```
DI00        =DI
Logic0      =OFF
Logic1      =ON
DI01        =DI
Logic0      =OFF
Logic1      =ON 
```

它一直持续到 DI11。我想编辑这个文件，并将其写入一个新的文本文件，如下所示：

```
DI00        =DOOR1
Logic0      =Door Open
Logic1      =Door Closed
DI01        =Camera1
Logic0      =CameraOn
Logic1      =CameraOff 
```

我已经尝试了一些东西，但似乎没有任何效果。我知道这只是一个简单的代码块，有人可以在两分钟内为我编写。主要问题是同一行出现多次，并且每次都需要进行不同的编辑。请记住，我不想就地编辑文件。我必须写一个新的。

这是我所拥有的：

导入文件输入

def IOConfig(siteLocation, siteName, timeServer, ip, mac):

```
for line in fileinput.FileInput("ik2210_vanilla.txt",inplace=1):
    line = line.replace("MOD_LOC=", "MOD_LOC=" + str(siteLocation))
    line = line.replace("MOD_NAME=", "MOD_NAME=" + str(siteName))
    line = line.replace("TIME_SERVER    =", "TIME_SERVER    =" + str(timeServer))
    line = line.replace("NET_IP     =192.168.127.254", "NET_IP      =" + str(ip))
    line = line.replace("NET_MAC        =192.168.127.254", "NET_MAC     =" + str(mac))  
    line = line.replace("Logic0     =OFF", "Logic0      =Door Open")

    print line, 
```

IOConfig（“大卫的办公室”，“大卫的测试站点”，“10.140.140.999”，“192.168.123.456”，“00-90-E8-31-D8-44”）

这里有一些额外的代码，但问题是最后一行。replace 替换了所有的 logic0 = Off's。我将发布第二次尝试写入新文件的尝试。

```
import re

rf = open("ik2210_vanilla.txt", "r")
wf = open("test#1", "w")

lines = rf.readlines()
for lines[2] in lines:
wf.write(str("Logic1    =Door Open"))
wf.write(str(lines))

rf.close()
wf.close() 
```

在这里，我试图更改文件的第三行并将其写入我的新文件。但它不起作用。

# java - 如何检查Java中的对象是否为空？

> ID：15800738
> 
> 赞同：1
> 
> 时间：2013-04-04T00:46:35.673
> 
> 标签：java, exception, null

检查职位是否被占用的最佳方法是什么？我认为我不应该使用“this==null”...

```
class Cell {
    int column;
    int row;
    char letter;

    public Cell(int column, int row, char letter) {
        super();
        this.column = column;
        this.row = row;
        this.letter = letter;
    }

    public boolean isEmpty() {
        if (this==null) return true;
        else return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:55:41.197

我将假设`char`是您的内容，`Cell`并且您想检查该内容是否是`null`.

首先，`this`永远不可能`null`。`this`是当前对象，因此 is 始终存在。

您正在使用`char`- 因为这是一个原语也不能`null`。将其更改为对象包装器并检查`null`

```
class Cell {

    int column;
    int row;
    Character letter;

    public Cell(int column, int row, Character letter) {
        this.column = column;
        this.row = row;
        this.letter = letter;
    }

    public boolean isEmpty() {
        return letter == null;
    }
} 
```

另一个需要注意的是，超类构造函数总是默认调用，没有理由调用`super()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:54:28.277

如果一个对象的实例*存在*，那么它就不可能存在`null`！（正如 Code-Guru 的评论所说）。但是，您要做的是检查`letter`对象的属性是否为（或不是）null。

只是作为一个建议，而不是使用`char`作为类型，使用`Character`，它是封装`char`类型的类。

您的课程可能如下所示：

```
class Cell {
    int column;
    int row;
    Character letter;

    public Cell(int column, int row, Character letter) {
        super();
        this.column = column;
        this.row = row;
        this.letter = letter; // This is an object, not a primitive type 
    }

    public boolean isEmpty() {
        if (letter==null) 
            return true;
        else 
            return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-02T19:49:56.990

`this`不可能是`null`因为`this`您的实例是 a `Cell`。无需更改`char`为`Character`：

```
class Cell {
    int column;
    int row;
    char letter;

    public Cell(int column, int row, char letter) {
        super();
        this.column = column;
        this.row = row;
        this.letter = letter;
    }

    public boolean isEmpty() {
        return letter == 0;
    }
} 
```

# iphone - 回调的代表数组不安全？

> ID：15800739
> 
> 赞同：1
> 
> 时间：2013-04-04T00:46:44.643
> 
> 标签：iphone, ios, objective-c, design-patterns, automatic-ref-counting

我理解在 iOS 的委托模式中你希望对委托的引用是弱的，但是如果我有这个：

```
@property (nonatomic, weak) NSMutableArray *delegates; 
```

在这个数组中是

```
id<myDelegateCallback> 
```

Array 对里面的项目有很强的保留。

我是在具有此属性的类中分配/初始化数组还是将数组设置为另一个类拥有的实例？

或者这不是委托模式的一个很好的实现？我知道我可以使用通知等，但想知道这是否真的可以在没有任何 ARC 问题的情况下工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T00:50:38.370

您只能有一个指定的委托对象，而不是一组委托。一些类有一个委托和一个符合独特协议的“数据源”，但这仅对需要从某个指定位置获取其内容的对象有意义。

但是如果你想通知几个监听对象发生了一些*事情*，可以考虑使用注册到[NSNotificationCenter的](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotification_Class/Reference/Reference.html)[NSNotification](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Notifications/Articles/NotificationCenters.html#//apple_ref/doc/uid/20000216-BAJGDAFC)。缺点是没有正式的或声明的协议方法供侦听器遵循（如果有任何问题，编译器也会抱怨）。

[这是一个相关问题，其中包含更多有用信息](https://stackoverflow.com/questions/2232694/delegates-vs-notifications-in-iphoneos)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T00:54:10.773

如果你*真的*需要一组弱委托，你可以使用一个带有保留和释放回调的桥接`CFMutableArray`初始化。`NULL`

在此处查看更多信息：[https ://developer.apple.com/library/mac/#documentation/CoreFOundation/Reference/CFMutableArrayRef/Reference/reference.html#//apple_ref/doc/uid/20001502](https://developer.apple.com/library/mac/#documentation/CoreFOundation/Reference/CFMutableArrayRef/Reference/reference.html#//apple_ref/doc/uid/20001502)

# unix - chmod：无法读取目录“。”：权限被拒绝

> ID：15800742
> 
> 赞同：30
> 
> 时间：2013-04-04T00:46:58.717
> 
> 标签：unix, ubuntu, chmod

我正在尝试递归更改“数据”目录的目录和子目录的权限并遇到以下错误..有人可以提供以下错误的输入吗？

```
<username:/local/mnt/workspace/data>chmod -R 0644 .
chmod: cannot read directory `.': Permission denied 
```

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-04-04T01:09:43.480

目录需要执行权限集才能查看其内容。

来自[http://content.hccfl.edu/polllock/AUnix1/FilePermissions.htm](http://content.hccfl.edu/pollock/AUnix1/FilePermissions.htm)

> 您可以这样考虑对目录的读取和执行：目录是数据文件，其中包含每个文件的两条信息，即文件名和它的 inode 编号。需要读取权限才能访问目录中的文件名。如果您已经知道文件的名称，则需要执行（也称为搜索）权限才能访问目录中文件的 inode。

当您将目录权限更改为 644 时，您将无法读取该目录中的文件，尽管您可以读取该目录以查看它是否存在。

你需要这样做：

```
$ chmod -R 0755 . 
```

如果您只想关闭，更好的方法可能是使用字符串权限

否则，您可以看到该目录，但无法访问该目录中的信息。

您最好使用相对权限而不是绝对权限：

```
$ chmod -R go-w . 
```

将删除组和其他的写入权限，但不会触及执行权限。

您也可以使用`find`仅设置目录或仅设置文件：

```
$ find . -type d -exec chmod 755 {} \; 
```

这只会触及目录，对所有目录设置读取和执行权限，并为所有者设置写入权限。这样，您就不会对文件本身设置执行权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:11:38.463

我猜想，由于您正在使用递归，因此您正在尝试 CD 到一个没有执行权限的目录。

# ios - 在 iOS 中将单元格从一个表格移动到另一个表格

> ID：15800747
> 
> 赞同：4
> 
> 时间：2013-04-04T00:47:39.113
> 
> 标签：ios, objective-c, cocoa-touch, uitableview

我正在尝试创建一个具有多个使用和实现核心数据的表视图的应用程序。我希望用户能够使用检查附件或带有操作表的 selectedCell 方法选择一个表格中的单元格并将它们移动到另一个表格中（例如在 Apple 的邮件应用程序中）。我被卡住了，因为我不知道您是否真的将单元格移动到另一个表格，或者您是否正在向新表格添加副本并删除原始表格。基本上，我要求提供细胞运动的基本示例，以推动我朝着正确的方向前进。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T01:12:25.530

你不会移动细胞。表格视图的模型是一个数组。在数组之间移动东西并告诉表格它们的模型已经改变。

```
id somePartOfMyModel = [self.arrayA objectAtIndex:someIndexPath.row];
[self.arrayA removeObject:somePartOfMyModel];
[self.arrayB addObject:somePartOfMyModel];

// the simplest, non-animated way to update the tables.
// I'd advise getting this working first, then later trying fancier UI to indicate changes
[self.tableViewA reloadData];
[self.tableViewB reloadData]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:49:30.443

从技术上讲，您不会将单元格移动到另一个表。我这样做的方法是`NSManagedObjectContextID`在表之间传递项目的 ，这取决于您的实体有多大以及表是否在同一个视图控制器中。

# android - ANDROID / 解析 JSON 对象编码字符串时出错

> ID：15800751
> 
> 赞同：0
> 
> 时间：2013-04-04T00:48:01.183
> 
> 标签：android, json, parsing, string-parsing

我的代码从服务器接收一个 JSON 对象编码的字符串，可以是：[{"logstatus":"0"}] 或 [{"logstatus":"1"}]

然后它转换这个 JSON（作为 ImputStream 接收），然后我把它转换成一个字符串，然后我想把它转换成一个 JSON 对象。但是这里出现了错误。这是我的代码：

```
public JSONArray getserverdata(ArrayList<NameValuePair> parameters, String urlwebserver ) {   
  httppostconnect(parameters,urlwebserver);    
  if (is!=null) { //si obtuvo una respuesta    
    getpostresponse();    
    return getjsonarray();   
  } else {   
    return null;    
  }
}

private void httppostconnect(ArrayList<NameValuePair> parametros, String urlwebserver) {
  try {
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost(urlwebserver);
    httppost.setEntity(new UrlEncodedFormEntity(parametros));
    //ejecuto peticion enviando datos por POST
    HttpResponse response = httpclient.execute(httppost);
    HttpEntity entity = response.getEntity();
    is = entity.getContent();
  } catch(Exception e) {
    Log.e("log_tag", "Error in http connection "+e.toString());
  }     
}

public void getpostresponse() {       
  try {    
    BufferedReader reader = new BufferedReader(new InputStreamReader(is,"UTF-8"),8);
    StringBuilder sb = new StringBuilder();
    String line = null;
    while ((line = reader.readLine()) != null) {
      sb.append(line + "\n");
    }
    is.close();
    result = sb.toString();
    Log.e("getpostresponse"," result="+sb.toString());
  } catch(Exception e) {
    Log.e("log_tag", "Error converting result "+e.toString()); 
  }
}

public JSONArray getjsonarray() {
  //parse json data
  try {       
    JSONArray jArray = new JSONArray(result);
    return jArray;
  } catch(JSONException e) {
    Log.e("log_tag", "Error parsing data "+e.toString());
    return null;
  } 
} 
```

错误在函数 getjsonarray() 中。

解析数据时出错 org.json.JSONException: Value ?? java.lang.String 类型的无法转换为 JSONArray。

我已验证服务器返回的 JSON 格式良好（可以是 [{"logstatus":"0"}] 或 [{"logstatus":"1"}]。

我也尝试过使用 JSONToken 但它也不起作用。

希望你能帮我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:10:51.860

如果您想从 String 创建 JsonArray，您需要首先验证您的 String 是否具有需要执行此操作的格式。

您可以打印结果字符串并[在此处进行测试。](http://jsonlint.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T00:59:44.600

请注销您收到的数据。我的猜测是你没有得到你的想法。该字符串看起来不错，应该可以很好地解析。当您注销异常时，还要注销有问题的字符串，您应该会看到问题。

# java - 如何保护 Android 应用程序中的秘密字符串？

> ID：15800755
> 
> 赞同：5
> 
> 时间：2013-04-04T00:49:00.797
> 
> 标签：java, android, security, cryptography

在我的 android 应用程序中，我使用需要两个字符串 clientId 和 clientSecret 的 Microsoft 翻译器。目前，我对这两个字符串进行了硬编码。由于我发现classes.dex可以转为jar，然后.class文件也可以转为.java文件，我认为硬编码那些敏感的字符串并不是一件好事。

所以我的问题很简单：如何向恶意人员隐藏这些字符串？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T02:58:43.877

预加密字符串并将其存储在资源文件中。使用密钥对其进行解密。这只是通过默默无闻的安全性，但至少“秘密”不会是纯文本。

```
public class KeyHelper {

    /**
     * Encrypt a string
     *
     * @param s
     *            The string to encrypt
     * @param key
     *            The key to seed the encryption
     * @return The encrypted string
     */
    public static String encode(String s, String key) {
        return base64Encode(xorWithKey(s.getBytes(), key.getBytes()));
    }

    /**
     * Decrypt a string
     *
     * @param s
     *            The string to decrypt
     * @param key
     *            The key used to encrypt the string
     * @return The unencrypted string
     */
    public static String decode(String s, String key) {
        return new String(xorWithKey(base64Decode(s), key.getBytes()));
    }

    private static byte[] xorWithKey(byte[] a, byte[] key) {
        byte[] out = new byte[a.length];
        for (int i = 0; i < a.length; i++) {
            out[i] = (byte) (a[i] ^ key[i % key.length]);
        }
        return out;
    }

    private static byte[] base64Decode(String s) {
        try {
            return Base64.decode(s);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }

    private static String base64Encode(byte[] bytes) {
        return Base64.encodeBytes(bytes).replaceAll("\\s", "");
    }
} 
```

另请注意，此示例要求您在项目中包含 Base64 类:)

# python - 构建将表达式应用于对象的字典

> ID：15800756
> 
> 赞同：0
> 
> 时间：2013-04-04T00:49:02.053
> 
> 标签：python, list-comprehension

我正在寻找是否有任何方法可以将操作应用于对象，并返回包含应用这些操作结果的字典。

这是我到目前为止所达到的

```
[{"len": len(s), "slice": s[2:4] } for s in [u'hello']][0] 
```

但这感觉很骇人听闻，因为列表推导被认为是与列表一起使用的，而不是与一个对象/一个结果一起使用。

我想知道在 python 中是否有任何直接、更好、更快、最佳的方法来做到这一点。

编辑：我希望只使用一个表达式来解决这个问题。我不想超过一行，并且 [u'hello'] 必须在表达式中只执行一次（而不是每次操作一次）。

这两个不是解决方案：

```
s = [u'hello']
{"len": len(s), "slice": s[2:4] }

{"len": len([u'hello']), "slice": [u'hello'][2:4] } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T01:08:39.360

当它不适合时，你不应该真的强迫单线想法太远。但是，有一个单行解决方案：

```
(lambda s: {"len" : len(s), "slice" : s[2:4]})(u'hello') 
```

在一行中阅读有点难看，但它只会创建一次“你好”。

# django - 第三方应用程序的 Django 自定义视图

> ID：15800761
> 
> 赞同：0
> 
> 时间：2013-04-04T00:49:21.503
> 
> 标签：django, view, module

假设我安装了一个名为“文章”的第三方应用程序，该应用程序包含基本模板和视图。并且有一个视图叫做'home'来列出文章。

我需要在该视图中添加一个表单，当然表单变量不在默认的“主页”视图中。我应该如何将表单变量添加到该视图？

我现在能想到的方法有两种：

1.  创建另一个应用程序并创建自定义视图。
2.  这看起来很疯狂，我不会这样做，但为了方便起见，添加一个上下文处理器以将表单变量添加到上下文中。

只是想知道是否有人遇到过这种情况，最好的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:05:37.760

好吧，您可能想尝试一个函数装饰器来重新定义以前的视图函数。不推荐使用上下文处理器或中间件，因为它是全局且脏的。

我可以做的另一种使用方式是使用定义的标签。这可能需要更多的努力，并且与标签的原始设计背道而驰。但这似乎是一个好方法。

# ios - 无法通过 openActiveSessionWithReadPermissions 与 Facebook 测试用户完成请求（错误代码 7）

> ID：15800765
> 
> 赞同：6
> 
> 时间：2013-04-04T00:49:33.537
> 
> 标签：ios, facebook, authentication, ios6, facebook-ios-sdk

## 背景

*   最近升级到 Facebook SDK **3.2**
*   在设备和模拟器上测试（iOS **5.1**到**6.1**）
*   仅在尝试对 Facebook**测试用户**进行身份验证时出现错误。

## 错误

> Facebook 服务器无法完成此访问请求：暂时无法代表 XXXXXX 进行 API 调用。
> 
> UserInfo={com.facebook.sdk:ErrorLoginFailedReason=com.facebook.sdk:SystemLoginCancelled, com.facebook.sdk:ErrorInnerErrorKey=错误域=com.apple.accounts 代码=7}

## 重现步骤

1.  清除模拟器或从设备设置中手动删除 Facebook 帐户。
2.  *通过 Facebook 的accounts/test-users*端点创建一个测试用户。
3.  在设备设置中添加 Facebook 帐户。
4.  通过 openActiveSessionWithReadPermissions 进行身份验证并接受权限对话框。

## 预期结果

*   FBSessionStateHandler 块返回状态 == FBSessionStateOpen。
*   一个零 NSError。

## 实际结果

*   FBSessionStateHandler 块返回 error.fberrorCategory == FBErrorCategoryUserCancelled 并带有上述用户信息跟踪。

## 解决方案尝试

*   我已按照[此问题](http://facebook.stackoverflow.com/questions/12644229/ios-6-facebook-posting-procedure-ends-up-with-remote-app-id-does-not-match-stor)中概述的步骤进行操作；即检查我的包名称，确保我的应用程序类型设置为**Native/Desktop**并将我**在客户端中的应用程序机密**设置为 NO。
*   同样，我确保我只要求读取权限（即电子邮件）。
*   我什至通过尝试使用**ACAccountStore**实例进行身份验证来完全绕过 Facebook SDK，并获得了相同的结果。
*   同样，对于普通用户来说一切正常（非测试）；所以它必须与配置和最近的 3.2 更改有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-28T07:09:58.513

1) Facebook 3.1 SDK 拆分读取和发布权限。在第一次身份验证调用中仅使用读取权限（例如，电子邮件）。两者都使用会破坏它并导致该一般错误。看起来 Facebook 的 SDK 实际上并没有做它应该做的事情：回退到旧的身份验证方法。David 告诉我更新的 Parse SDK 将使权限拆分更容易，但当然要由 Facebook 来修复他们 SDK 中的错误。

2）独立地，在设备的“设置”中退出 Facebook，然后重新登录后，我遇到的问题似乎已经消失。也许 iOS 集成出现故障？（但是，权限拆分问题在这里仍然适用。请确保您先阅读并稍后单独发布（例如，publish_actions），这是您第一次真正需要它的时候。）

# javascript - 使用 javascript replace 替换多个字符

> ID：15800766
> 
> 赞同：0
> 
> 时间：2013-04-04T00:49:41.773
> 
> 标签：javascript, regex, replace

我想使用javascript替换用“A”替换所有出现的重音字符À，Á，Â，Ã，Ä，Å（例如，“ÀNÁPIÂLÃZÄ”将呈现为“ANAPIALAZA”）。我试过：

```
var re = /À||Á||À||Á||Â||Ã||Ä||Å/g; 
name =  name.replace(re,"A"); 
```

和

```
var  re = /(ÀÁÂÃÄÅ)/g;
name =  name.replace(re,"A"); 
```

我不确定如何在正则表达式模式中表达所需的规则。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:51:53.437

方 [ ] 括号将解决您的问题。

```
var  re = /[ÀÁÂÃÄÅ]/g;
name =  name.replace(re,"A"); 
```

示例：http: [//jsfiddle.net/y2a6x/](http://jsfiddle.net/y2a6x/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T00:52:16.967

使用`[]`方括号，如下所示：

```
/[ÀÁÀÁÂÃÄÅ]/g 
```

顺便说一句，你的第一个例子的问题`||`是你应该只`|`在正则表达式中使用一个。

# python - 未定义全局名称的python问题

> ID：15800767
> 
> 赞同：0
> 
> 时间：2013-04-04T00:49:42.900
> 
> 标签：python

所以我正在尝试为一轮高尔夫编写用户界面。我已经定义了 Player 和 League 类，我不想更改它们。在我的用户界面中，我需要它能够为球员的文本文件输入 9 洞的成绩，并返回每个球员的总成绩、标准杆和小鸟球。我在 enterScores 函数中收到一个错误，即未定义位置。我不知道如何解决这个问题。

```
class Player:
""" Represents a player in the golf league """

    PAR = [4, 3, 4, 3, 4, 5, 4, 3, 5]
    """ par for each of the 9 holes """

    def __init__(self, name):
        """ creates a Player and keeps track of stats """
        self.__name = name
        self.__pars = 0
        self.__birdies = 0
        self.__gross = 0

    def getName(self):
        """ returns a player's name """
        return self.__name

    def getGross(self):
        """ returns a player's gross score """
        return self.__gross

    def getPars(self):
        """ returns number of pars made """
        return self.__pars

    def getBirdies(self):
        """ returns number of birdies made """
        return self.__birdies

    def recordScores(self, holeScores):
        """ mutator method that uses the results of one round of play
          (9 holes) to update a player's stats """
        self.__gross = sum(holeScores)
        self.__findparsandbirdies(holeScores)

    def __findparsandbirdies(self, scores):
        """ helper method that finds the number of pars and birdies """

        pars = 0
        birdies = 0
        hole = 0
        for score in scores:
            if score == Player.PAR[hole]:
                pars += 1
            if score == Player.PAR[hole] - 1:
                birdies += 1
            hole += 1
        self.__pars = pars
        self.__birdies = birdies

    def __str__(self):
        """ returns a string representation of a player """
        return 'a Player named ' + self.__name

class League:
""" represents the players of a golf league """

    def __init__(self, fileName = 'players.txt'):
        """ creates a list of Player objects from the
            names stored in the file specified """
        self.__playerList = []
        datafile = open(fileName, 'r')
        for line in datafile:
            playerName = line.rstrip()
            player = Player(playerName)
            self.__playerList.append(player)

    def getNumPlayers(self):
        """ returns the number of players is the league """
        return len(self.__playerList)

    def getPlayerbyPosition(self, position):
        """ returns the player at the specified position """
        return self.__playerList[position]

    def getPlayerbyName(self, name):
        """ returns the player with the specified name """
        for player in self.__playerList:
            if player.getName() == name:
                return player
        return None

    def __str__(self):
        return 'a golf league with ' + str(self.getNumPlayers()) + ' players'

def main():
    """The input and output for the program"""
    l= League()
    players= []
    enterScores(l, players, position)
    isValidScore(holeScores)
    output(players)

def enterScores(l, players, position):
    """enter the scores"""
    for pos in range(l.getNumPlayers()):
        holeScores= input(("Please enter a list of the player's scores: "))
        while not isValidScore(holeScores):
            holeScores= input(("Please enter a valid list of scores: "))
        p= l.getPlayerbyPosition(position)
        players.append(player)
        player.recordScores(holeScores)

def isValidScore(holeScores):
    """checks if the scores entered for a single hole are 1 to 10, inclusive"""
    for score in holeScores:
        if score == 1 or 2 or 3 or 4 or 5 or 6 or 7 or 8 or 9 or 10:
            return True
        else:
            return False                

def output(grossScore, pars, birdies):
    """prints output"""
    for player in players:
        print(player.getName())
        print('Gross score:', player.getGross())
        print('Pars: ', player.getPars())
        print('Birdies: ', player.getBirdies()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:55:47.390

您没有在 main() （或全局）中定义位置。

```
position = 10 
```

您也可以在函数调用中输入它：

```
enterScores(l, players, 10) 
```

# hadoop - 将 Hadoop Mapreduce 输出到本地磁盘或 STDOUT

> ID：15800769
> 
> 赞同：0
> 
> 时间：2013-04-04T00:50:00.873
> 
> 标签：hadoop, mapreduce

是否必须将 hadoop map reduce 程序的输出写入 HDFS。我们可以将其写入本地磁盘或在标准输出上显示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T00:57:58.727

我不认为 hadoop 目录中必须有文件，这取决于您如何运行 MapReduce 作业。当我从 Eclipse 运行我的 mapreduce 程序时，它以“独立”模式运行，并在我的个人文件系统中创建一个文件夹。

mapreduce 的另一种操作模式是“分布式”模式。

我的地图减少了驱动程序类行，其中我提到了输出和输入路径。

```
 FileInputFormat.addInputPath(job, new Path("src/demo/fulldictionary.txt"));
    FileOutputFormat.setOutputPath(job, new Path("output")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T06:31:15.557

您可以编写一个扩展 TextOutputFormat 并覆盖 getRecordWriter() 方法的自定义类。在其中，您可以将输出写入本地 fs。

# python - 支持项目分配的类中的 Python 静态字典

> ID：15800770
> 
> 赞同：2
> 
> 时间：2013-04-04T00:50:13.430
> 
> 标签：python, dictionary, python-2.7, static-members

我有一个包含静态字典的类：

```
class MyClass:
    my_dict = {}
    def __init__(self, name):
        self.name = name
        MyClass.my_dict[self.name] = []
    def __call__(self, data):
        MyClass.my_dict[self.name].append(data) 
```

每当我想更新字典时，我都必须使用`MyClass.my_dict[key]`，但我希望类本身支持项目分配，这样我就可以用`MyClass[key]`它来做同样的事情。有没有办法做到这一点？我正在使用 Python 2.7。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T17:19:25.007

所以，这就是我最终做的事情：

```
class MyClassType(type):
    my_dict = {}
    def __getitem__(cls, key):
        return cls.my_dict[key]
    def __setitem__(cls, key, value):
        cls.my_dict[key] = value
    def __str__(cls):
        return cls.my_dict.__str__()
    def iteritems(cls):
        return cls.my_dict.iteritems()

class MyClass(object):
    __metaclass__ = MyClassType
    def __init__(self, name):
        self.name = name
        MyClass[self.name] = []
    def __call__(self, data):
        MyClass[self.name].append(data) 
```

# mysql - 在表中添加外键约束与更改表中添加外键约束

> ID：15800775
> 
> 赞同：0
> 
> 时间：2013-04-04T00:50:51.263
> 
> 标签：mysql, foreign-key-relationship

我在这里有一个关于数据库设计的新手问题，我注意到了 2 个选项。1）在创建表块中包含外键约束 2）创建表，然后通过 ADD CONSTRAINT FOREIGN KEY 更改表

感谢您对此的经验看法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:01:50.553

```
1\. include the foreign key constrain in the create table block 
```

自我解释，您在创建表中创建外键约束没有记录。

```
2) create table then Alter table by ADD CONSTRAINT FOREIGN KEY 
```

如果您在表中没有任何记录，那么这将表现为 1。如果您在表中有任何记录，那么您需要注意可用记录是否不违反外键约束。

# css - 从一个选项卡导航到另一个选项卡时，引导选项卡不会更改类

> ID：15800781
> 
> 赞同：0
> 
> 时间：2013-04-04T00:51:56.157
> 
> 标签：css, twitter-bootstrap

这是我的小提琴[http://jsfiddle.net/codejedi/JJpNz/](http://jsfiddle.net/codejedi/JJpNz/)。我试图在单击时更改选项卡颜色和类。到目前为止，我能够从我要从中迁移的按钮中删除活动类，但无法将活动类添加到我正在单击的按钮中。

这是我的代码

```
$('#headerTab').click(function (e) {
    $('ul.nav-tabs li.active').removeClass('active')
    $(this).parent('li').addClass('active')
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T00:58:01.903

```
$('ul.nav-tabs li a').click(function (e) {
    $('ul.nav-tabs li.active').removeClass('active');
    $(this).parent('li').addClass('active');
}) 
```

[http://jsfiddle.net/JJpNz/3/](http://jsfiddle.net/JJpNz/3/)

# jquery - jQuery从div中插入和删除图像

> ID：15800782
> 
> 赞同：1
> 
> 时间：2013-04-04T00:51:59.927
> 
> 标签：jquery, html, css, image, lightbox

jQuery 有没有办法在单击时将图像插入到 div 中，并在单击时将其删除？

我正在尝试使用 jquery 制作一个灯箱，因此在准备好 dom 时，它将缩略图类应用于包装器 div 中的每个图像，然后单击它会切换整个类。但这会产生居中问题。所以我想要一个透明的 div 去 .5 不透明度并插入点击的图像，然后当你再次点击时，做相反的事情。

这是我到目前为止的代码：

```
 $(document).ready
            $('img, div.wrapper').each( function() {
                var $img = $(this);
                $img.addClass('thumbnail');
                $img.click(function(){
                    $img.toggleClass('full');
                });
        }); 
```

链接到 js 小提琴：http: [//jsfiddle.net/reveries/TLJYN/](http://jsfiddle.net/reveries/TLJYN/)

我只想添加一个宽度和高度为 100% 和 50% 不透明的 div，它将 text-align 设置为居中。这样当图像被注入到这个 div 中时，它会自动居中。然后单击时，50% 不透明的父 div 将显示：none，并且图像将放回原来的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T08:33:04.120

这会将单击的图像克隆到 div 中。您可以根据需要更改 css 和其余部分

```
$(document).ready(function(){
    $('img, div.wrapper').each( function() {
        var $img = $(this);
        $img.addClass('thumbnail');
        $img.click(function() {
            $img.clone().appendTo('#big');
        $('#big').fadeToggle('slow');
    });

    $('#big').click(function(){
        $('#big').fadeOut('slow').html('');
    }); 
```

});

我还更改了一些 CSS。见[小提琴](http://jsfiddle.net/Spokey/TLJYN/6/)。

# php - 如何在 PHP 中重定向到感谢页面

> ID：15800785
> 
> 赞同：1
> 
> 时间：2013-04-04T00:52:17.377
> 
> 标签：php, html, forms, redirect, contact

好的，所以我想在填写完联系表后重定向到感谢页面。现在，它只是一个普通的、没有样式的谢谢，我希望它重定向到我设计的名为contact-thank-you.html的页面

这是我的 HTML 表单：

```
<form action="form_processor.php" method="post" >
        Name:<br /><input type="text" name="name" required="required" /><br /><br />
        E-mail:<br /><input type="text" name="email" required="required" /><br /><br />
        Message:<br /><textarea name="message" required="required"></textarea><br /><br />
        <input type="submit" value="Submit">
</form> 
```

这是form_processor.php：

```
 $to      = 'myemail@email.com';
$subject = "New Message From Your Website";
$message = $_POST['message'];
$headers = 'From: ' . $_POST['name'] . ' <myemail@email.com>' . "\r\n" .
    'Reply-To: myemail@email.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();

mail($to, $subject, $message, $headers);

echo "Thank you, you message has been sent!"; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T00:53:18.743

消除`echo "Thank you, you message has been sent!";`

因为自从您重定向页面后就没有必要拥有它，然后在完成所有交易后使用它来重定向

```
header('Location: contact-thank-you.html');
exit(); 
```

并为您创建一个不错的*感谢模板*`contact-thank-you.html`

资源：

php.net：[标头（）](http://us3.php.net/manual/en/function.header.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T00:53:23.173

代替：

```
echo "Thank you, you message has been sent!"; 
```

和：

```
header('Location: contact-thank-you.html');
exit; 
```

**参考**

*   [`header()`](http://us3.php.net/manual/en/function.header.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:29:41.497

header('位置：thank-you.php');

或者你可以回声按摩（同一个地方的ajax消息）

```
if(@mail($address, $e_subject, $msg, "From: $email\r\nReturn-Path: $email\r\n"))
     {
    echo "<p class='ajax_success'>Thanks for Contact Us.</p>";
     }
     else
     {
     echo "<p class='ajax_failure'>Sorry, Try again Later.</p>";
     } 
```

在这里ajax验证；

```
jQuery.noConflict();

jQuery(document).ready(function ($) {
    //Main Contact Form...
    jQuery("#frmcontact").validate(
    { 
        //Onblur Validation...
        onfocusout: function(element)
        {   
            $(element).valid();
        },         
        rules:
        { 
          txtname:
          {
            required: true,
            minlength: 5
          },
          txtemail:
          {
            required: true,
            email: true
          },          
         txtphone:
          {
            required: true,
            minlength: 5
          },
         txtenquiry:
          {
            required: true,
            minlength: 10
          }       
        }
    });
    //Ajax Submit...
    $('#frmcontact').submit(function () {
    if($('#txtname').is('.valid') && $('#txtemail').is('.valid') && $('#txtphone').is('.valid') && $('#txtenquiry').is('.valid')) {

        var action = $(this).attr('action');

        $("#ajax_message").slideUp(750, function () {
            $('#ajax_message').hide();

            $.post(action, {
                name: $('#txtname').val(),
                email: $('#txtemail').val(),
                phone: $('#txtphone').val(),                
                comment: $('#txtenquiry').val()
            }, function (data) {
                document.getElementById('ajax_message').innerHTML = data;
                $('#ajax_message').slideDown('slow');
                if (data.match('success') != null) $('#frmcontact').slideUp('slow');
            });
        });
      }
      return false;     
    });

and lucks very good 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T00:57:38.053

```
header('Location: contact-thank-you.html'); 
```

这应该是您正在寻找的答案（：

你可以参考这里：[http ://www.cyberciti.biz/faq/php-redirect/](http://www.cyberciti.biz/faq/php-redirect/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-05T23:58:46.370

如果您想从 html 页面重定向到另一个页面，例如 php 页面，那么只需编写此代码，它将为您工作

```
<?php  
  header( 'Location: http://www.yoursite.com/new_page.html' ) ; 
   //or 
  header( 'Location: nextpage.php' ) ; 
 ?> 
```

# ios - 让使用 iPodMusicPlayer 的应用程序在后台运行

> ID：15800788
> 
> 赞同：1
> 
> 时间：2013-04-04T00:53:11.123
> 
> 标签：ios, objective-c, mpmediaplayercontroller

我已经编写了一个音乐播放器应用程序，并且我正在尝试添加一个功能，以在音频停止或应用程序退出时保存有关当前播放歌曲的所有信息（一些示例是库更新发生时，或者歌曲背景的变化）。目标是能够在任何合理的情况下恢复用户停止的音频（主要用于有声读物）。

我一直在对保持应用程序在后台以某种形式运行的方法进行大量研究，但我未能成功实施其中任何一种。

我的目标：

*   在后台使用应用程序响应播放更改

我有的：

*   info.plist 条目 - UIApplicationExitsOnSuspend = NO
*   info.plist 条目 - UIBackgroundModes -> item0 = 音频
*   [MPMusicPlayerController iPodMusicPlayer] 是我用来播放的
*   面向iOS5+iOS6的应用

问题（基本上，这是徒劳的努力）：

*   使用 iPodMusicPlayer 是否会阻止我的应用程序固有地在后台运行，因为它实际上并没有在我的应用程序中主动执行任何操作？
*   什么播放方法（如果有的话）可以让我的应用程序保持活跃，而不必从本质上重写大部分内容
*   考虑到相当简单的目标，在后台运行的内容是否存在限制，这会使它们变得不可能？

非常感谢任何有关方向的帮助。

# google-app-engine - 如何测试 /_ah/bounce？

> ID：15800793
> 
> 赞同：0
> 
> 时间：2013-04-04T00:53:32.337
> 
> 标签：google-app-engine

我已经通过从[文档](https://developers.google.com/appengine/docs/python/mail/bounce)中复制代码实现了一个反弹处理程序，但现在我想在将其推出生产之前测试此代码是否有效。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:02:17.877

[我最后使用了一个名为POSTMan](https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?hl=en)的 Chrome 扩展来制定一个包含所有必需参数的 POST 请求，如 BounceNotification 类的文档字符串所示：

```
 post_vars: a dict-like object containing bounce information.
          This is typically the self.request.POST variable of a RequestHandler
          object. The following keys are expected in the dict:
            original-from
            original-to
            original-subject
            original-text
            notification-from
            notification-to
            notification-subject
            notification-text
            raw-message 
```

当我发送所有必需的 POST 参数时，我确实看到我的退回处理程序收到了请求并记录了适当的信息。

# c++ - 如何正确移动带有区域的窗口？

> ID：15800795
> 
> 赞同：1
> 
> 时间：2013-04-04T00:53:46.357
> 
> 标签：c++, windows, winapi, region

我刚刚开始研究窗口区域，我正在尝试创建一个椭圆窗口，我可以通过拖动客户区来移动它。不幸的是，当我拖动窗口时，窗口从椭圆到普通窗口来回闪烁（好像我从未调用过`SetWindowRgn`），然后反复快速地返回。

我在 MSDN 上读到我必须调用`SetWindowRgn(nullptr);`，然后移动窗口，然后重置区域，这在我的代码中已经完成。我通过调用 、 和 来移动窗口`SetWindowPos`，并且`SWP_NOZORDER`我尝试添加所有、和，但无济于事。`SWP_NOSIZE``SWP_NOREDRAW``SWP_NOSENDCHANGING``SWP_DEFERERASE``SWP_NOCOPYBITS`

这是我的窗口过程，重点是`WM_MOUSEMOVE`. 我知道如果我在窗口外释放按钮，它将不起作用；我打算在这工作之后处理这个问题。我也省略了错误检查。很明显，调用确实有效，因为窗口在我拖动时确实会移动。

```
LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam) {
    static bool moving{};

    switch (msg) {
        case WM_DESTROY: {
            PostQuitMessage(0);
            return 0;
        }

        case WM_LBUTTONDOWN: {
            moving = true;
            return 0;
        }

        case WM_LBUTTONUP: {
            moving = false;
            return 0;
        }

        case WM_MOUSEMOVE: {
            static POINT old{0, 0};

            if (moving) {
                RECT r;
                GetWindowRect(hwnd, &r);

                int x = GET_X_LPARAM(lParam);
                int y = GET_Y_LPARAM(lParam);

                RECT newPos;
                newPos.left = r.left + x - old.x;
                newPos.top = r.top + y - old.y;

                SetWindowRgn(hwnd, nullptr, FALSE);

                SetWindowPos(hwnd, nullptr, newPos.left, newPos.top, 0, 0,
                    SWP_NOZORDER | SWP_NOSIZE | SWP_NOREDRAW
                );

                SetWindowRgn(hwnd, CreateEllipticRgn(200, 200, 600, 400), FALSE);
            }

            old.x = GET_X_LPARAM(lParam);
            old.y = GET_Y_LPARAM(lParam);

            return 0;
        }
    }

    return DefWindowProc(hwnd, msg, wParam, lParam);
} 
```

我也试过`ValidateRgn(hwnd, nullptr);`在 结束时调用`WM_MOUSEMOVE`，这并没有改变任何东西。同样，我尝试将`DefWindowProc`调用包装在一个如果设置为仅返回 0 的条件中，`moving`以查看是否只是正在发送的其他一些消息对其造成干扰，但这导致窗口在拖动时什么也不做。然后我将该条件应用于`WM_PAINT`和`WM_ERASEBKGND`处理程序，但是在拖动时会导致相同的闪烁问题。

为了更容易地测试它，这里是[完整的代码](http://pastebin.com/T4ap4XSt)（只是基本的窗口创建等）。我要以正确的方式移动窗户吗？是否有一些消息或我应该处理的东西，但没有？这发生在 Window 7 Ultimate N 上。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T01:14:53.063

处理移动逻辑的一种更简单的方法是处理[`WM_NCHITTEST`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645618%28v=vs.85%29.aspx)消息，返回`HTCAPTION`. 这使 Windows 为您处理所有移动逻辑。

# asp.net-mvc-3 - mvc3 模型绑定到多个相同类型的列表

> ID：15800796
> 
> 赞同：0
> 
> 时间：2013-04-04T00:54:03.913
> 
> 标签：asp.net-mvc-3, list, razor, model-binding

认为...

在剃刀视图中，我们有一个对象 A 的模型

```
@Model Object A 
```

对象 A 是类 A 的一个实例，它有多个类 B 的实例，其中有一个类型为 C 的列表

```
Class A
public B Object1
public B Object2

Class B
public List<C> List1 
```

对象 B 有一个 EditorView。对象 A 有一个更大的视图，其中每个对象 B 使用一个对象 B EditorView。

```
 @Model Object B

 ...do things with list in object B 
```

因此，当视图呈现时，存在多个 B 类的编辑器视图。我可以在编辑器视图中使用什么代码将额外的 C 添加到 B Object1 中的列表 List1 而不会影响 B Object2 中的列表 List1。

```
 @Model Object B

 ... would like to add to this list and have it post back, and only effect the b it in. I don't know how to reference this object's master to add to this list exculsively 
```

我看了几次[http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx 。](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)就像拥有多个...

```
<input type="text" name="[0].Title" value="Curious George" />
<input type="text" name="[0].Author" value="H.A. Rey" />
<input type="text" name="[0].DatePublished" value="2/23/1973" />

<input type="text" name="[0].Title" value="Curious George" />
<input type="text" name="[0].Author" value="H.A. Rey" />
<input type="text" name="[0].DatePublished" value="2/23/1973" /> 
```

在同一页面上，并希望他们在回发时回发给正确的主人。这就是我想做的。我想动态添加

```
<input type="text" name="...." value=""/> 
```

但是我遇到了问题，我应该在名称中添加什么来实现它。执行@Html.EditorFor 和@Html.HiddenFor 似乎可以将它们模型绑定到正确的父级，但它们不允许我向列表中添加额外的输入。

我的直觉方向 - 用反射（或不反射）来获取主人的对象的名称，用它来创建一个正确的名称？

请提供想法或代码示例。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:09:47.210

使用 Html.EditorFor 应该为您提供要使用的格式。它们需要是连续的，您需要计算现有项目 (-1) 以获得新的 [x] 索引以在名称中使用，或者使用正则表达式或字符串解析解析最后一个元素名称并提取其索引，假设您允许序列中有间隙，这意味着如果您想要间隙，您还需要一个自定义活页夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T14:15:00.800

好的，解决方案可能是使用不同变量的编辑器来获取父变量的通用名称，并使用 jquery/js 解析此名称，然后根据此名称动态插入输入 type=file 。

# java - 避免重复生成 id

> ID：15800802
> 
> 赞同：-1
> 
> 时间：2013-04-04T00:55:20.347
> 
> 标签：java, random, bluej, code-duplication

方法 generateId 为学生分配 id，方法 storeStudent 被 readData 方法调用，该方法读取数据，数据中的 StudentId 字段都设置为未知，因此方法 storeStudent 将单词 unknown 替换为每个学生的唯一 id，但是如果我有超过 10 个学生，它会出现问题，它会再次重复相同的 id，我试图避免 id 重复，所以我该如何解决这个问题

公共无效storeStudnet（学生学生）{

```
 student.setId(generateCustomerId("AB-",1));

         for(Student students : studentList)
        {
        if(student.getStudentID().equals(student.getStudentID()))
         {
             student.setId(generateId("AB-",1));
         } 

        }

}
  studentList.add(student);
 }

   public String generateId(int numberaOfDigits)
{
    Random random = new Random();
    for(int i=0;i<numberaOfDigits;i++)
    {

       random.nextInt(9);  

    }

    return  random.nextInt(9);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:07:50.637

如果您为此使用数据库和诸如 Hibernate 之类的 ORM，那么您已经有注释 (@Id) 可以解决这个问题。

如果您想自己创建它，您可能需要使用[同步](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)方法来处理始终递增 id。Random 不是一个好的选择，不能保证它不会选择一个已经存在的数字（检查[Random API](http://docs.oracle.com/javase/6/docs/api/java/util/Random.html)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-27T05:15:11.223

我认为最好的解决方案是在评论中不断增加数字。但是，如果这不符合您的要求，您可以保留一个单独的生成 id 列表，并使用 list.contains() 检查 id 是否已生成。一个样本可能是这样的：

```
ArrayList<int> id = new ArrayList<int>() ;
Random random = new Random();
public int generateId(int numberaOfDigits)
{
  int x = random.netxInt(number);
  while(id.contains(x))
       {
        x = random.nextInt(number)
        }
  return x;
} 
```

另外，您发布的代码中存在一些错误：

1.  您在 generateId() 中返回一个 int，但您定义了返回类型 String。
2.  我不确定你想用 generateId() 中的 for 循环做什么，但它没有做任何事情，接受生成甚至没有存储在任何地方的新随机数。

# python - “如果 Y 失败，则在 Y 之前运行 X”的 Pythonic 方式？

> ID：15800804
> 
> 赞同：2
> 
> 时间：2013-04-04T00:55:40.733
> 
> 标签：python

我正在寻找一种更好的方法来实现这种逻辑：

```
if not a():
    if not b():
        c()
        b()
    a() 
```

另一种形式：

```
try:
   a()
except:
   try:
      b()
      a()
   except:
      c()
      b()
      a() 
```

换句话说，“尝试运行A。如果我们不能做A，我们需要先做B。如果我们不能做B，我们需要先做C，等等。”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:04:32.550

创建一个函数，如`fallback_until_success(func_list)`, where `func_list = [a, b, c]`。如果你有参数，你可以绑定它们，例如通过传递`(func, *args, **kwargs)`.

然后你可以在一个while循环中遍历列表（包括每次迭代的回退回溯），直到你获得成功或到达列表的末尾；如果您没有成功，请返回最后一个异常（或异常列表）。

但是，这似乎是这样一种情况，即进行初始测试以告知您的代码路径比尝试先造成损害并回溯更好。您正在做的是滥用异常作为消息传递服务。

**更新：**无论如何，现在为时已晚，但这是一个具体的例子：

```
def fallback_until_success(func_list):
    index = 0
    results = []
    exceptions = []
    while (index < len(func_list)):
        try:
            print func_list[index::-1] # debug printing
            for func_spec in func_list[index::-1]:
                #func, args, kwargs = func_spec  # args variant
                #result = func(*args, **kwargs)
                func = func_spec 
                result = func()
                results.append(result)
            break
        except Exception, e:
            exceptions.append(e)
            index += 1
            results = []
            continue
        break
    return results, exceptions

# global "environment" vars
D = {
        "flag1": False,
        "flag2": False,
    }

def a():
    if not D["flag1"]:
        failstr = "a(): failure: flag1 not set"
        print failstr
        raise Exception(failstr)
    print "a(): success"
    return D["flag1"]

def b():
    if not D["flag2"]:
        failstr = "b(): failure: flag2 not set"
        print failstr
        raise Exception(failstr)
    else:
        D["flag1"] = True
        print "b(): success"
    return D["flag2"]

def c():
    D["flag2"] = True
    print "c(): success"
    return True

# args variant
#results, exceptions = fallback_until_success([(a, [], {}), (b, [], {}), (c, [], {})])

results, exceptions = fallback_until_success([a, b, c])
print results
print exceptions 
```

输出：

```
[<function a at 0x036C6F70>]
a(): failure: flag1 not set
[<function b at 0x03720430>, <function a at 0x036C6F70>]
b(): failure: flag2 not set
[<function c at 0x037A1A30>, <function b at 0x03720430>, <function a at 0x036C6F70>]
c(): success
b(): success
a(): success
[True, True, True]
[Exception('a(): failure: flag1 not set',), Exception('b(): failure: flag2 not set',)] 
```

当然，这是基于异常的，但您也可以将其修改为基于返回值的成功/失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T01:24:00.060

怎么样：

```
while not a():
    while not b():
        c() 
```

这只适用于`c()`预期最终`b()`成功的情况（对于`b()`and也是如此`a()`），但这对我来说是一种相对常见的模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T01:27:47.917

不确定您是否对此感觉“更好”；这是另一种选择。我相信有些人喜欢，有些人不喜欢。

```
a() or (b(),a())[0] or (c(),b(),a())[0] 
```

这是验证测试：

```
def a(ret):
    print 'run a, a succeeded?', ret
    return ret

def b(ret):
    print 'run b, b succeeded?', ret
    return ret

def c(ret):
    print 'run c, c succeeded?', ret
    return ret 
```

和

```
a(False) or (b(False),a(False))[0] or (c(True),b(False),a(False))[0] 
```

给

```
run a, a succeeded? False
run b, b succeeded? False
run a, a succeeded? False
run c, c succeeded? True
run b, b succeeded? False
run a, a succeeded? False 
```

和

```
a(False) or (b(True),a(False))[0] or (c(True),b(True),a(False))[0] 
```

给

```
run a, a succeeded? False
run b, b succeeded? True
run a, a succeeded? False 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T01:39:54.967

这应该有效。请注意，如果 a 失败，它将执行 b,c,a。如果 b 然后失败，它将执行 c,a,b ——也就是说，不是按照原始顺序，但如果顺序没有任何特别的偏好，应该是好的。

```
ops = [a,b,c]

while op = ops.pop(0):
  if (op()): 
    continue
  ops.append(op) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T01:56:42.270

根据 Shao-Chuan Wang 的[回答](https://stackoverflow.com/a/15801053/429533)，我想我最终可能会做这样的事情：

```
any(all((a())),
    all((b(), a())),
    all((c(), b(), a()))) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-04T02:06:42.407

为什么要将所有这些都暴露给调用者？调用者不应该知道/关心小部件*如何*工作的细节。为什么不通过执行以下操作将客户端代码与“胆量”隔离开来：

```
do_stuff()  # This is the only call you make directly

def do_stuff():
    ## commands for Step A, in this case
    ## try to update the changeset
    result = False
    # Do stuff and store result
    if (result == False):
        result = step_B()
    return result

def step_B():
    ## Commands for Step B, in this case
    ## try to pull the repository
    result = False
    # Do stuff and store the result
    if (result == False):
        result = step_C()
    return result

def step_C():
    ## Commands for Step C, in this case
    ## try to clone the repository
    ## and set `result' to True or False
    result = False
    # Do stuff and set `result'
    return result 
```

# git - 通过端口 443 推送到 heroku

> ID：15800806
> 
> 赞同：8
> 
> 时间：2013-04-04T00:55:43.513
> 
> 标签：git, heroku, ssh

我无法使用默认端口 22，因此根据 hartl rails 教程设置 git 和 heroku 时遇到了困难。

通过在 ~/.ssh/config 文件中包含以下内容，我能够推送到 git：

```
Host github.com
User git
Hostname ssh.github.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/id_rsa
Port 443 
```

但是，类似的条目不适用于 heroku：

```
Host heroku.com
User git
Hostname ssh.heroku.com
PreferredAuthentications publickey
IdentityFile ~/.ssh/id_rsa
Port 443 
```

它似乎挂在这个调试行：

```
 debug1: identity file /c/Users/[my folder name]/.ssh/id_rsa type 1 
```

...在此消息失败之前：

```
 ssh_exchange_identification: Connection closed by remote host. 
```

我对这个答案抱有希望， [git push heroku master 中的错误通过代理后面的 ssh](https://stackoverflow.com/questions/10555546/error-in-git-push-heroku-master-through-ssh-behind-proxy) 它对我也不起作用......

任何的建议都受欢迎。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T01:44:53.103

Heroku 正在努力提供将源代码移动到平台上的替代方法，请查看`heroku push`，例如：[https ://github.com/ddollar/heroku-push](https://github.com/ddollar/heroku-push)

它使用 https，因此不易受到您遇到的防火墙阻止的影响。

**更新**

Heroku 现在有[beta HTTP Git](https://devcenter.heroku.com/articles/http-git)支持。如果问题是由于您无法在端口 22 上访问 Heroku 引起的，那么 HTTP Git 应该可以解决它（它适用于端口 443）。

要使用 HTTP Git，首先确保 Toolbelt 已更新并且您的凭据是最新的：

```
$ heroku update
$ heroku login 
```

（这很重要，因为 Heroku HTTP Git 的身份验证方式与 Toolbelt 的其余部分略有不同）

在测试期间，您可以通过将`--http-git`标志传递给相关的`heroku apps:create`、`heroku git:clone`和`heroku git:remote`命令来获得 HTTP。要创建一个新应用并使用 HTTP Git 远程配置它，请运行以下命令：

```
$ heroku apps:create --http-git 
```

要将现有应用程序从 SSH 更改为 HTTP Git，只需从计算机上的应用程序目录运行以下命令：

```
$ heroku git:remote --http-git
Git remote heroku updated 
```

查看[开发中心文档，了解如何为 Heroku 设置 HTTP Git 的详细信息](https://devcenter.heroku.com/articles/http-git)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T01:12:09.257

哇。让我印象深刻的是 github 有远见在 443 上运行 ssh。heroku 很可能只是在运行 https，这显然不允许您建立与 git over 的 ssh 连接。

既然 github 为你工作，为什么不利用它呢？使用 travisci 之类的服务来观看 github、构建和部署到 heroku。

一个使用 travis 的简单示例：http: [//metabates.com/2012/10/23/deploying-to-heroku-from-travisci/](http://metabates.com/2012/10/23/deploying-to-heroku-from-travisci/)

# asp.net - gridview 的 SelectedIndexChanged 事件无法随机触发

> ID：15800808
> 
> 赞同：0
> 
> 时间：2013-04-04T00:55:54.847
> 
> 标签：asp.net, .net, gridview, visual-studio-2005, selectedindexchanged

您好我有一个 Gridview SelectedIndexChanged 事件。它会在单击该网格中的任何行时触发。但有时（10 次尝试一次）它不会触发。我在 AgeGrid_SelectedIndexChanged 中有一些设置会话变量的代码。当它失败时无法获得适当的价值。

知道为什么它会随机失败吗？

我没有为该页面设置 EnableEventValidation="false" 属性。并使用视觉工作室 2005。

```
<Asp:GridView ID="agendaGrid" runat="server" Width="96%" GridLines="Both" EnableViewState="true" HeaderStyle-CssClass="GridViewHeader "
                                    OnSorting = "AgeGrid_Sorting" CssClass="GridView"  
                                      AutoGenerateColumns="false" OnSelectedIndexChanged="AgeGrid_SelectedIndexChanged"
                                     AllowPaging="true" PageSize="10" ItemTemplateType="PopUpMenu"
                                    ShowTemplateFields="true"   EnableOnClick="true" RowStyle-Font-Size="13px" RowStyle-VerticalAlign="middle"
                                    EnablePopUpClick="true" OnRowDataBound="AgeGrid_RowDataBound" AllowSorting ="true"
                                    >
</Asp:GridView> 
```

欢迎任何建议。我需要从页面属性或 Gridview 属性中添加或删除什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T12:27:33.873

```
 protected void AgeGrid_SelectedIndexChanged(object sender, GridViewPageEventArgs e)
    {
       agendaGrid.PageIndex = e.NewPageIndex;
        BindGrid();
    } 
```

分页后绑定数据可能会出现问题，而不是分页错误。愿它帮助你。

# memory - DRAM 仪器

> ID：15800816
> 
> 赞同：0
> 
> 时间：2013-04-04T00:56:38.253
> 
> 标签：memory, x86, performance-testing

我正在尝试监视物理 DRAM。具体来说，我试图找出在物理 DRAM 上执行的读取和写入的数量，以便我可以粗略估计运行特定应用程序时的总内存能耗。你知道任何有助于测量的工具吗？

# html - Magento在body标签后自动插入html代码

> ID：15800817
> 
> 赞同：0
> 
> 时间：2013-04-04T00:56:41.210
> 
> 标签：html, magento, tags

我正在尝试解决 1 个月前出现的问题。

我开发的一个 magento 商店，在某些产品页面中，可能 javascript 会在页面顶部的 doctype 标记之前自动插入句点 [.]。

看到这个[链接](http://www.comandoadistancia.com/ditec-gol4c.html)

有没有人建议如何解决这个问题。想不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:01:28.590

我希望这很容易......我看到一个句号正在添加，但不是在代码的顶部。它在其他地方......仍在调试所有文件。

# c - 在 C 中初始化定时器

> ID：15800821
> 
> 赞同：0
> 
> 时间：2013-04-04T00:57:08.003
> 
> 标签：c, linux, timer

我正在运行 Linux，并且有这个代码片段，我想用它来操作 C 中的计时器，每 40 毫秒触发一个函数。到目前为止，我只尝试运行创建和启动新计时器的部分。但是我收到以下错误：

```
/tmp/ccA7MbyS.o: In function `main':
server.c:(.text+0x69e): undefined reference to `timer_create'
server.c:(.text+0x6be): undefined reference to `timer_settime'
collect2: ld returned 1 exit status 
```

如果我将这些方法注释掉，代码编译得很好。有任何想法吗？

```
#include <sys/time.h>
#include <signal.h>
#include <time.h>

// This struct is created to save information that will be needed by the timer,
// such as socket file descriptors, frame numbers and video captures.
struct send_frame_data {
  int socket_fd;
  // other fields
};

// This function will be called when the timer ticks
void send_frame(union sigval sv_data) {

  struct send_frame_data *data = (struct send_frame_data *) sv_data.sival_ptr;
  // You may retrieve information from the caller using data->field_name
  // ...
}

// ...

// The following snippet is used to create and start a new timer that runs
// every 40 ms.
struct send_frame_data data; // Set fields as necessary
struct sigevent play_event;
timer_t play_timer;
struct itimerspec play_interval;

memset(&play_event, 0, sizeof(play_event));
play_event.sigev_notify = SIGEV_THREAD;
play_event.sigev_value.sival_ptr = &data;
play_event.sigev_notify_function = send_frame;

play_interval.it_interval.tv_sec = 0;
play_interval.it_interval.tv_nsec = 40 * 1000000; // 40 ms in ns
play_interval.it_value.tv_sec = 0;
play_interval.it_value.tv_nsec = 1; // can't be zero

timer_create(CLOCK_REALTIME, &play_event, &play_timer);
timer_settime(play_timer, 0, &play_interval, NULL);

// The following snippet is used to stop a currently running timer. The current
// task is not interrupted, only future tasks are stopped.
play_interval.it_interval.tv_sec = 0;
play_interval.it_interval.tv_nsec = 0;
play_interval.it_value.tv_sec = 0;
play_interval.it_value.tv_nsec = 0;
timer_settime(play_timer, 0, &play_interval, NULL);

// The following line is used to delete a timer.
timer_delete(play_timer); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:01:20.113

我很确定这是因为您可能没有与实时库 (librt): 链接`-lrt`。

有关[其手册页的](http://man7.org/linux/man-pages/man2/timer_create.2.html)更多信息：

> 与 -lrt 链接。

# vim - vim python 提示

> ID：15800825
> 
> 赞同：0
> 
> 时间：2013-04-04T00:57:24.417
> 
> 标签：vim, python-2.7, python-idle

[这是删除偶数](https://stackoverflow.com/questions/15800634/remove-even-numbers-from-a-list#)的后续问题。

使用 IDLE Python 2.7，程序提示用户输入数字。但是，如果我从 vim 运行程序，它不会这样做。

只要用户不需要输入任何内容，我的 vim 就可以运行 python。有没有办法让 vim 像 shell 一样提示用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T05:33:44.007

如果您将脚本实现为 Vim 脚本，是的。否则没有。

您可以尝试[ConqueTerm](http://code.google.com/p/conque/)或简单地在单独的终端窗口中运行您的脚本。

# image-resizing - Lanczos 重采样错误

> ID：15800827
> 
> 赞同：1
> 
> 时间：2013-04-04T00:57:26.650
> 
> 标签：image-resizing, resampling, lanczos

我已经使用 Lanczos 重新采样编写了一个图像缩放器。我直接从 wikipedia 上的说明进行了实施。结果在视觉上看起来不错，但由于某种原因，它与 Matlab 使用 Lanczos 调整大小的结果不匹配（像素错误）。

有人看到任何错误吗？这根本不是我的专业领域...

这是我的过滤器（我默认使用 Lanczos3）：

```
double lanczos_size_ = 3.0;
inline double sinc(double x) {
  double pi = 3.1415926;
  x = (x * pi);
  if (x < 0.01 && x > -0.01)
    return 1.0 + x*x*(-1.0/6.0 + x*x*1.0/120.0);
  return sin(x)/x;
}

inline double LanczosFilter(double x) {
  if (std::abs(x) < lanczos_size_) {
    double pi = 3.1415926;
    return sinc(x)*sinc(x/lanczos_size_);
  } else {
    return 0.0;
  }
} 
```

还有我调整图像大小的代码：

```
Image Resize(Image& image, int new_rows, int new_cols) {
  int old_cols = image.size().cols;
  int old_rows = image.size().rows;
  double col_ratio =
      static_cast<double>(old_cols)/static_cast<double>(new_cols);
  double row_ratio =
      static_cast<double>(old_rows)/static_cast<double>(new_rows);

  // Apply filter first in width, then in height.
  Image horiz_image(new_cols, old_rows);
  for (int r = 0; r < old_rows; r++) {
    for (int c = 0; c < new_cols; c++) {
      // x is the new col in terms of the old col coordinates.
      double x = static_cast<double>(c)*col_ratio;
      // The old col corresponding to the closest new col.
      int floor_x = static_cast<int>(x);

      horiz_image[r][c] = 0.0;
      double weight = 0.0;
      // Add up terms across the filter.
      for (int i = floor_x - lanczos_size_ + 1; i < floor_x + lanczos_size_; i++) {
        if (i >= 0 && i < old_cols) {
          double lanc_term = LanczosFilter(x - i);
          horiz_image[r][c] += image[r][i]*lanc_term;
          weight += lanc_term;
        }
      }
      // Normalize the filter.
      horiz_image[r][c] /= weight;
      // Strap the pixel values to valid values.
      horiz_image[r][c] = (horiz_image[r][c] > 1.0) ? 1.0 : horiz_image[r][c];
      horiz_image[r][c] = (horiz_image[r][c] < 0.0) ? 0.0 : horiz_image[r][c];
    }
  }

  // Now apply a vertical filter to the horiz image.
  Image new_image(new_cols, new_rows);
  for (int r = 0; r < new_rows; r++) {
    double x = static_cast<double>(r)*row_ratio;
    int floor_x = static_cast<int>(x);
    for (int c = 0; c < new_cols; c++) {      
      new_image[r][c] = 0.0;
      double weight = 0.0;
      for (int i = floor_x - lanczos_size_ + 1; i < floor_x + lanczos_size_; i++) {
        if (i >= 0 && i < old_rows) {
          double lanc_term = LanczosFilter(x - i);
          new_image[r][c] += horiz_image[i][c]*lanc_term;
          weight += lanc_term;
        }
      }
      new_image[r][c] /= weight;
      new_image[r][c] = (new_image[r][c] > 1.0) ? 1.0 : new_image[r][c];
      new_image[r][c] = (new_image[r][c] < 0.0) ? 0.0 : new_image[r][c];
    }
  }
  return new_image;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-17T14:51:37.410

这是一个循环中的 Lanczosh。没有错误。顶部程序中提到的用途。

```
void ResizeDD(
double* const pixelsSrc, 
const int old_cols, 
const int old_rows,
double* const pixelsTarget, 
int const new_rows, int const new_cols)
{
double col_ratio =
    static_cast<double>(old_cols) / static_cast<double>(new_cols);
double row_ratio =
    static_cast<double>(old_rows) / static_cast<double>(new_rows);

// Now apply a filter to the image.
for (int r = 0; r < new_rows; ++r)
{
    const double row_within = static_cast<double>(r)* row_ratio;
    int floor_row = static_cast<int>(row_within);
    for (int c = 0; c < new_cols; ++c)
    {
        // x is the new col in terms of the old col coordinates.
        double col_within = static_cast<double>(c)* col_ratio;
        // The old col corresponding to the closest new col.
        int floor_col = static_cast<int>(col_within);

        double& v_toSet = pixelsTarget[r * new_cols + c];
        v_toSet = 0.0;
        double weight = 0.0;
        for (int i = floor_row - lanczos_size_ + 1; i <= floor_row + lanczos_size_; ++i)
        {
            for (int j = floor_col - lanczos_size_ + 1; j <= floor_col + lanczos_size_; ++j)
            {
                if (i >= 0 && i < old_rows && j >= 0 && j < old_cols)
                {
                    const double lanc_term = LanczosFilter(row_within - i + col_within - j);
                    v_toSet += pixelsSrc[i * old_rows + j] * lanc_term;
                    weight += lanc_term;
                }
            }
        }

        v_toSet /= weight;
        v_toSet = (v_toSet > 1.0) ? 1.0 : v_toSet;
        v_toSet = (v_toSet < 0.0) ? 0.0 : v_toSet;
    }
} 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-26T20:02:52.053

线

```
for (int i = floor_x - lanczos_size_ + 1; i < floor_x + lanczos_size_; i++) 
```

应该

```
for (int i = floor_x - lanczos_size_ + 1; i <= floor_x + lanczos_size_; i++) 
```

不知道，但也许还有其他错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-08T14:54:44.063

我认为您的 sinc 函数有错误。在分数栏下方，您必须平方 pi 和 x。另外，您必须将函数与 lanczos 大小相乘 `L(x) = **a***sin(pi*x)*sin(pi*x/a) * (pi**²**x**²**)^-1`

编辑：我的错，没关系。

# javascript - 1 (mod N) 是什么意思？

> ID：15800835
> 
> 赞同：6
> 
> 时间：2013-04-04T00:58:22.733
> 
> 标签：javascript, modulo

我正在尝试在 JavaScript 中实现一个简单的算法。无论我在哪里看，它都需要代码来解决`1 (mod N)`。据我所知，1 模任何（或`1%N`）是 1。

我错过了什么？它总是 1，如果是，为什么不直接使用 1？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-04T00:59:44.220

该算法可能会这样说：

```
x ≡ 1 (mod N)  # x is congruent to 1 (modulo N) 
```

和`(mod N)`三等号表示您正在使用模算术，而不是普通算术。把它想象成时钟的指针。在模算术中，`x ≡ 1`意味着`x`和`1`属于同一个[剩余类](https://en.wikipedia.org/wiki/Modular_arithmetic#Congruence_classes)。如果您有一个带有`N`小时刻度的时钟，转动指针`1`时间或`x`时间将使指针到达相同的结束位置。

对于您的特定情况，`x ≡ 1 (mod N)`可以`x % N === 1`在 JavaScript中表示*if `x`is never negative*。否则，即使应该相等，您的相等也不会成立：例如，`-1 ≡ 1 (mod 2)`但是`(-1) % 2 === -1`，`1`即使它们在模算术意义上“相等”也不等于。

如果你期望`x`是负数，你可以重新排列同余关系：

```
 x ≡ 1 (mod N)
⇒  x - 1 ≡ 0 (mod N) 
```

`x - 1`一致`0`意味着它`N`本身可以整除，因此您可以安全地使用模运算符：

```
if ((x - 1) % N === 0) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T02:24:38.463

模 (%) 运算符的工作原理在[ECMA-262 §11.5.3](http://www.ecma-international.org/ecma-262/5.1/#sec-11.5.3)中定义。有一些怪癖，ECMAScript 模运算符接受浮点数和整数：

对于整数：

```
1 % -Infinity returns 1
...
1 % -2 returns 1
1 % -1 returns 0
1 %  0 returns NaN
1 %  1 returns 0
1 %  2 returns 1
...
1 % Infinity returns 1 
```

对于花车，

```
1 % -1.1 returns 1
1 %  0.1 returns 0.09999999999999995
1 %  0.6 returns 0.4
1 %  0.5 returns 0
1 %  0.4 returns 0.19999999999999996
1 %  0.9 returns 0.09999999999999998
1 %  1.1 returns 1 
```

因此，如果没有模运算符如何应用的上下文，很难确定为什么要使用它。最重要的是代码的文档，但我想那是不可用的。

一种用途是，在需要整数的情况下，将 0 和 1 评估为 false，将其他所有内容评估为 true，因此：

```
if (1 % n) {
  // do this if n is something other than 0 or 1
} 
```

# c# - 如何跨多个 OU 按组成员身份过滤用户？

> ID：15800836
> 
> 赞同：1
> 
> 时间：2013-04-04T00:58:29.787
> 
> 标签：c#, active-directory, ldap, directoryservices

我有一个无法在 OU 级别完成的用户查询。我试图只返回他们是组成员的用户（我需要按组字符串值过滤，而不是实际的组对象）。这是它目前的样子：

```
using (var entry = new DirectoryEntry("LDAP://foo.net/DC=appName,DC=domainName,DC=com", Username, Password)) {
    using (var searcher = new DirectorySearcher()) {
        searcher.Filter = "(&(objectClass=user))";
        searcher.SearchRoot = entry;
        searcher.PropertiesToLoad.Add("memberOf");

        foreach (SearchResult sr in searcher.FindAll()) {
            var member = GetSearchResultProperty(sr, "memberOf");
        }
    }
} 
```

此查询跨越多个 OU，其中有不同的用户和组容器。

`memberOf`当我执行查询时（不指定任何类型的 OU），有没有办法可以过滤属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:07:12.333

只需在过滤器中添加另一个术语：

```
searcher.Filter = "(&(objectClass=user)(memberOf=myGroup))"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T15:40:20.917

您需要在搜索过滤器中包含组的完整可分辨名称，因为 memberOf 属性将包含该值。

```
searcher.Filter = "(&(objectClass=user)(memberOf=CN=myGroup,CN=groups,OU=theOU,DC=appName,DC=domainName,DC=com))"; 
```

**编辑 ：**

我很抱歉，因为我误读了这个问题。在不包括 OU 的情况下，唯一的其他方法是采用相反的方法，并首先定位组对象：

```
searcher.Filter = "(&(objectClass=group)(name=Your Group Name)" 
```

然后遍历`DirectoryEntry`使用它的属性：

```
foreach(object dn in group.Properties["member"] )
{
    string DistinguishedName = dn.ToString();
} 
```

但是，如果您要检索 1,000 多个用户，则需要采用更加细分的方法，[本文](http://msdn.microsoft.com/en-us/library/ms180907%28v=vs.80%29.aspx)对此进行了详细介绍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T13:56:14.623

在执行查询时，我尝试执行的操作似乎是不可能的，因为该`memberOf`属性需要是组的完整路径。就我而言，我实际上并不关心组对象，而是组名（每个 OU 将有不同的组，但可以具有相同的组名）。我不得不采取不同的方法来解决这个问题，这可能会对以后的性能产生影响。以防万一其他人发现这个问题正在寻找答案，这是我现在解决它的方法：

```
using (var entry = new DirectoryEntry("LDAP://foo.net/DC=appName,DC=domainName,DC=com", Username, Password)) {
    using (var searcher = new DirectorySearcher()) {
        searcher.Filter = "(&(objectClass=user))";
        searcher.SearchRoot = entry;
        searcher.PageSize = 5000;
        searcher.PropertiesToLoad.Add(DirectoryConstants.AD_PROPERTY_MEMBER_OF);
        searcher.PropertiesToLoad.Add(DirectoryConstants.AD_PROPERTY_DISPLAY_NAME);

        foreach (SearchResult sr in searcher.FindAll()) {
            //The memberOf property will be a string array if the user is in multiple groups.
            string[] memberOf = GetSearchResultProperties(sr, DirectoryConstants.AD_PROPERTY_MEMBER_OF);
            //Check if the user is in the group by analyzing the string.
            var group = memberOf.FirstOrDefault(m => m.StartsWith(string.Format("CN={0},", groupName)));

            if (group != null) {
                //The user is in the group!
            }
        }
    }
} 
```

# xcode - Xcode中的iAd，将AdBannerView连接到委托？

> ID：15800837
> 
> 赞同：0
> 
> 时间：2013-04-04T00:58:43.163
> 
> 标签：xcode, delegates, storyboard, iad

因此，在 youtube ( [https://www.youtube.com/watch?v=0NkgmhpJovM&list=UU6-UA1FoMnbO2LCLWPCM9aA&index=27](https://www.youtube.com/watch?v=0NkgmhpJovM&list=UU6-UA1FoMnbO2LCLWPCM9aA&index=27) ) 上观看 Geeky Lemon 的教程后，了解如何在您的应用中实施 iAd。我的问题是，当我完成所有代码并尝试将我的 AdBannerView 连接到委托时，出于某种原因在情节提要中选择 AdBannerView 时，我可以在右侧的检查器中看到委托连接，但是没有连接它的方法。这是我的代码。我的 .h 文件：

```
#import <iAd/iAd.h>
#import <UIKit/UIKit.h>

@interface FirstViewController : UIViewController <MFMessageComposeViewControllerDelegate,    ADBannerViewDelegate>         {
} 
```

我的 .m 文件：

```
#import "FirstViewController.h"

@interface FirstViewController ()

@end

@implementation FirstViewController 

- (void) bannerViewDidLoadAd:(ADBannerView *)banner{
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[banner setAlpha:1];
[UIView commitAnimations];

}

- (void) bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error {
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:1];
[banner setAlpha:0];
[UIView commitAnimations];
} 
```

所以总而言之，我需要知道如何在使用情节提要的同时将我的横幅连接到文件所有者？请您帮忙，非常感谢您提供的任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:06:11.410

连接您的代表的一种方法是选择您的广告横幅视图，然后调出 Outlet Collection 检查器（在右侧）。然后控制单击“委托”并将连接线拖到您的视图控制器上，如下所示：

![设置代理连接的一种方法](https://i.stack.imgur.com/ypSUf.jpg)

确保您也将视图控制器设置为正确的自定义类型！

# python - 为什么控制台说我的 print " ".join(row) 函数有问题？

> ID：15800841
> 
> 赞同：1
> 
> 时间：2013-04-04T00:59:40.813
> 
> 标签：python

```
import random

print "Welcome to my mastermind game. instead of colors, \
we will be using numbers, one through six \
(red is left, white is right)"

board = []
for x in range(0, 10):
    board.append(["O"]*4)

def mastermind_board(board):
    for row in board:
        print " ".join(row)

...
    mastermind_board(board)
turn + 1 
```

这些`print " ".join(row)`行是有问题的地方，在提交第一个项目后，它会输入错误（点是对问题不重要的额外代码）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:18:53.337

该代码没有任何问题，我只是在机器上尝试过。如果您使用的是 Python 3.3，则需要为 print 函数添加括号。尝试：

```
print(" ".join(row)) 
```

这是我得到的输出：

```
O O O O
O O O O
O O O O
O O O O
O O O O
O O O O
O O O O
O O O O
O O O O
O O O O 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:12:14.347

我认为问题在于您正在尝试在单个行上使用 .join() ：您可以将其应用于整个数组并且它应该可以正常工作。

（不过，您必须更改附加“O”的格式以使其看起来像您想要的那样）

# ios - 在 UITableViewCell 子类中实现自定义滑动功能

> ID：15800842
> 
> 赞同：1
> 
> 时间：2013-04-04T00:59:41.437
> 
> 标签：ios, uitableview, uikit

我正在尝试重新创建在许多应用程序中看到的效果，您有一个带有单元格的表格视图，在单元格上滑动，该视图被另一个包含其他按钮的视图替换。

我试图这样做如下：

```
 // Hacky hacky
    RCTReceiptCell *selectedCell = (RCTReceiptCell *)[sender view];

    RCTReceiptOptionsCell *optionsCell = [[RCTReceiptOptionsCell alloc] init];

    if (optionsCell) {
        NSBundle *mainBundle = [NSBundle mainBundle];
        NSString *class = NSStringFromClass([RCTReceiptOptionsCell class]);
        NSArray *cellComponents = [mainBundle loadNibNamed:class
                                                     owner:self
                                                   options:nil];
        optionsCell = [cellComponents objectAtIndex:0];
    }

    // Make sure subview gets inserted on top.
    NSArray *subviews = [[selectedCell contentView] subviews];
//  NSUInteger index = [subviews indexOfObject:[subviews lastObject]];
    UIView *selectedCellContentView = selectedCell.contentView;
    [selectedCell insertSubview:optionsCell aboveSubview:selectedCell.contentView];
    NSLog(@"subviews: %@",selectedCellContentView.subviews); 
```

我面临的挑战是让视野留在牢房上。取而代之的是视图短暂出现然后消失。我怎样才能让它留下来，然后一旦发生另一个触摸事件，我怎样才能让它消失呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T02:05:17.230

看看这个教程。那是你要找的吗？

[http://idevrecipes.com/2011/04/14/how-does-the-twitter-iphone-app-implement-side-swiping-on-a-table/](http://idevrecipes.com/2011/04/14/how-does-the-twitter-iphone-app-implement-side-swiping-on-a-table/)

# php - 在jQuery中输出json数组

> ID：15800848
> 
> 赞同：0
> 
> 时间：2013-04-04T01:00:15.303
> 
> 标签：php, jquery, mysql, json

我对如何从 jquery 中的 json 数组中检索所有值有点困惑。我知道它需要循环但如何？功能 - 目前是：

```
$.ajax({                                      
    url: 'query.php',                     
    data: "",                       
    dataType: 'json',                   
    success: ajaxfunction
   }); 

function ajaxfunction(json_data){
// problem is below, i need to output all the data from the array         
    console.log (json_data)
    while(json_data){
    $('#maindisplay').html("<b>Product: </b>"+json_data.prod_name+"<b> colour: </b>"+json_data.colour); // problem is here, i need to output all the data from the array
    }
  } 
```

php：

```
$result = mysql_query("SELECT * FROM fproduct WHERE fproduct.category='Shirts'");
$elements = array ();
do{
   $row=mysql_fetch_array($result); 
    if ($row)    //if there is anything
              $elements[] = ($row); 

} while($row);
echo json_encode($elements); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:03:01.967

您必须遍历数组的元素。

```
function ajaxfunction(json_data){
    for (var i = 0; i < json_data.length; i++){
        $('#maindisplay').append($("<b>Product: </b>"+json_data[i].prod_name+"<b> colour: </b>"+json_data[i].colour+"<br>"));
    }
} 
```

# asp.net-mvc - 发布到控制器时，输入文本的值为 value="on"

> ID：15800850
> 
> 赞同：0
> 
> 时间：2013-04-04T01:00:27.163
> 
> 标签：asp.net-mvc, razor

我有一个呈现文本框的视图

```
@Html.TextBoxFor(m => m.CarName,new{ id="carNameId"}) 
```

我将它绑定到模型

```
 public class Car 
    {
        public Car()
        {

        }

        [StringLength(40, ErrorMessage = ValidationMessages.LengthInvalid)]
        [DisplayName("Car Name")]
        public string CarName { get; set; }
} 
```

当我发布到我的控制器时

```
public ActionResult Index(Car car)
{
    if (ModelState.IsValid)
    {
        var _car = _vehicle.Verify(car);
    }

    return View(_car);
} 
```

汽车类中 CarName 的值是“on”而不是我输入的值，例如表单中的“Ford”或“GT”

绑定中发生了什么？

为什么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T05:05:29.220

我在名为“carName”的页面上有 2 个单选按钮，这导致了问题

# asp.net - CheckBoxList '.Selected' 在每种情况下都返回 false

> ID：15800858
> 
> 赞同：3
> 
> 时间：2013-04-04T01:01:42.417
> 
> 标签：asp.net, checkboxlist

我正在尝试从复选框列表中获取多个值并将它们添加到列表中，但是即使列表包含适当的计数值，选中的值也总是错误的。

要填充的代码：

```
Guid userGuid = (Guid)Membership.GetUser().ProviderUserKey;
HelpingOthersEntities helpData = new HelpingOthersEntities();
List<LookupStoreLocationsByUserName> theDataSet = helpData.LookupStoreLocationsByUserName(userGuid).ToList<LookupStoreLocationsByUserName>();
locCkBox.DataSource = theDataSet;
locCkBox.DataTextField = "slAddress";
locCkBox.DataValueField = "storeLocationID";
locCkBox.DataBind(); 
```

添加到列表的代码：

```
List<int> locList = new List<int>();

for (int x = 0; x < locCkBox.Items.Count; x++){
   if(locCkBox.Items[x].Selected){
        locList.Add(int.Parse(locCkBox.Items[x].Value));
    }
} 
```

我遇到的问题是我无法进入`items.selected` 我的价值总是错误的。

我已经尝试从回发填充复选框，但我得到了相同的结果。我的列表给了我适当`.Count`数量的值，但是`items.selected`= false？

我也尝试了一个 foreach 循环来添加到列表中，但我一遍又一遍地得到相同的结果。我错过了一个活动还是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T02:07:49.420

我将在这里猜测一下，并说在 pageload 事件中调用了执行填充内容的代码，因此您有以下内容。

```
private void Page_Load()
{
    Guid userGuid = (Guid)Membership.GetUser().ProviderUserKey;
    HelpingOthersEntities helpData = new HelpingOthersEntities();
    List<LookupStoreLocationsByUserName> theDataSet = helpData.LookupStoreLocationsByUserName(userGuid).ToList<LookupStoreLocationsByUserName>();
    locCkBox.DataSource = theDataSet;
    locCkBox.DataTextField = "slAddress";
    locCkBox.DataValueField = "storeLocationID";
    locCkBox.DataBind();
} 
```

如果是这种情况，那么您可以有效地在每个请求上写入回发数据。要解决这个问题，您只需要在不是回发时执行数据绑定，因此您需要将上面的代码更改为

```
private void Page_Load()
{
    if (!IsPostBack)
    {
        Guid userGuid = (Guid)Membership.GetUser().ProviderUserKey;
        HelpingOthersEntities helpData = new HelpingOthersEntities();
        List<LookupStoreLocationsByUserName> theDataSet = helpData.LookupStoreLocationsByUserName(userGuid).ToList<LookupStoreLocationsByUserName>();
        locCkBox.DataSource = theDataSet;
        locCkBox.DataTextField = "slAddress";
        locCkBox.DataValueField = "storeLocationID";
        locCkBox.DataBind();
    }
} 
```

然后，您应该能够测试项目的 Selected 属性。我也可能会将您用于测试所选内容的代码更改为类似

```
List<int> locList = new List<int>();
foreach(var item in locCkBox.Items)
{
  if(item.Selected)
  {
    locList.Add(int.Parse(item.Value));
  }
} 
```

或者，如果您使用 .NET 版本并提供 LINQ

```
List<int> locList = new List<int>();
(from item in locCkBox.Items where item.Selected == true select item).ForEach(i => locList.Add(i.Value)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-28T03:49:59.810

确保在绑定`checkboxlist`页面内加载时已设置此检查。

```
if (!Page.IsPostBack)
{
...bind your data
} 
```

这应该可以解决问题。

# perl - 如何打印拼写出来的月份名称而不是数字

> ID：15800862
> 
> 赞同：1
> 
> 时间：2013-04-04T01:02:01.487
> 
> 标签：perl, perl-module, cpan

如何让 Perl 打印月份名称而不是数字，例如：9 应该显示为九月。我希望下面的程序打印月份的名称而不是它们的数字。

```
#!/usr/bin/perl

use strict;
use warnings;
use Date::Easter;

print "Please enter a year";
chomp (my $year = <STDIN>);

my ($m1, $d1) = easter ($year);
my ($m2, $d2) = julian_easter ($year);
my ($m3, $d3) = orthodox_easter ($year);

print "Gregorian => Month: $m1 Day: $d1\n";
print "Julian    => Month: $m2 Day: $d2\n";
print "Orthodox  => Month: $m3 Day: $d3\n"; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T01:26:53.180

我正在使用内置`POSIX`模块：

```
#!/usr/bin/perl

use strict;
use warnings;
use Date::Easter;
use POSIX qw(strftime);

my %dispach_sub = (
    easter          => \&easter,
    julian_easter   => \&julian_easter,
    orthodox_easter => \&orthodox_easter,
);

print "Please enter a year: ";
chomp( my $year = <STDIN> );

foreach my $key ( keys %dispach_sub ) {

    print "[$key]\t";
    my ( $month, $day ) = $dispach_sub{$key}->($year);
    print POSIX::strftime( "Month: %B Day: %d",
        0, 0, 0, $day, $month - 1, $year - 1900 ),
      "\n";
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T01:17:09.607

我懒得下载这个模块来查看月份是从 0 到 11 还是从 1 到 12。为此，我假设月份是从 0 到 11。

最简单的方法是使用月份名称创建一个数组：

```
my @month_list = qw(Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec);

my ($m1, $d1) = easter ($year);
my ($m2, $d2) = julian_easter ($year);
my ($m3, $d3) = orthodox_easter ($year);

print "Gregorian => Month: $month_list[$m1] Day: $d1\n";
print "Julian    => Month: $month_list[$m2] Day: $d2\n";
print "Orthodox  => Month: $month_list[$m3] Day: $d3\n"; 
```

如果月份从 1 到 12 编号，则在数组的开头添加一个假月份：

```
my @month_list = qw(Foo Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec); 
```

# ios - 如何使用带有 xcode 的方案 url 启动 Siri？

> ID：15800863
> 
> 赞同：-1
> 
> 时间：2013-04-04T01:02:09.877
> 
> 标签：ios, objective-c, jailbreak, siri

我需要通过该方法启动**Siri**（在越狱设备上） 。`openUrl:`

例如

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"Siri://"]]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:12:10.030

这是不可能的。此外，Xcode 是一个 IDE - 一个代码编辑器。它不是一种语言或平台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-10T01:32:44.190

Siri似乎没有任何*URL 方案*，所以我认为你不能那样打开它。Siri 也不是普通的*App*，它是 SpringBoard 使用的库。

无论如何，如果您想以*另一种*方式打开它，我会尝试查看 rpetrich 的**libActivator**源代码。

如果[你看这里，你会看到类似于](https://github.com/rpetrich/libactivator/blob/master/LASimpleListener.x)你需要的东西。*虚拟助手*是“ Siri”。

```
- (BOOL)activateVirtualAssistant{   
   if ([%c(SBAssistantController) preferenceEnabled]) { 
      if ([%c(SBAssistantController) shouldEnterAssistant]) {
          SBAssistantController *assistant = (SBAssistantController *)[%c(SBAssistantController) sharedInstance];           
          if (assistant.assistantVisible)   
             [assistant dismissAssistant];          
          else {
             [(SpringBoard *)UIApp activateAssistantWithOptions:nil withCompletion:nil];
             return YES;
          }     
       }
   }    
   return NO;
} 
```

这里，代码调用[了 SpringBoard 类本身](https://github.com/optimo/SpringBoard-iOS5-Headers/blob/master/SpringBoard-Class.h)`activateAssistantWithOptions:withCompletion:`的一个方法。

当然，这种技术是基于 MobileSubstrate *hooking*的。

**免责声明：**我没有测试过这段代码。不过，只是看着它，它似乎就是你所需要的。

* * *

## 更新：

这没有使用 URL 方案，但我确实找到了另一种启动 Siri 的方法，[如本答案中所述](https://stackoverflow.com/a/18671422/119114)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:35:07.090

Siri 没有 URL 架构，目前也没有可用的集成 - iOS 7 中可能会集成，但现阶段无法执行此功能。

# javascript - nested_form fieldRemoved 事件未正确触发重新计算

> ID：15800866
> 
> 赞同：0
> 
> 时间：2013-04-04T01:02:23.773
> 
> 标签：javascript, ruby-on-rails

我正在使用nested_form 创建具有多个 invoice_line_items 的发票表单。然后我在用户输入他们的信息时使用 javascript 来计算总数。除了 fieldRemoved 侦听器事件没有触发重新计算外，一切正常。这是我的js：

```
function calculate_invoice() {
  $(".txtMult input").keyup(multInputs);

  function multInputs() {
    var mult = 0;
    // for each row:
    $("tr.txtMult").each(function () {
      // get the values from this row:
      var $quantity = $('.quantity', this).val();
      var $rate = $('.rate', this).val();
      var $total = ($quantity * 1) * ($rate * 1);
      // set total for the row
      $('.multTotal', this).text($total);
        mult += $total;
      });
    $("#grandTotal").text(mult);
  }
}

$(document).ready(function () {
  calculate_invoice();
});

$(document).on('nested:fieldAdded', function(event){
  calculate_invoice();
});

// not working
$(document).on('nested:fieldRemoved', function(event){
  calculate_invoice();
}); 
```

我放置了一个控制台输出以确保 js 函数正确触发并且确实如此。但是，页面不会重新计算。这是我的页面视图：

```
 %table.table#line_items_table
        %thead
          %td &nbsp;
          %td Description
          %td Quantity
          %td Rate
          %td Total
        %tbody#line-items
          = f.fields_for :invoice_line_items, :wrapper => false do |line_item|
            %tr.txtMult.fields
              %td= line_item.link_to_remove "X"
              %td= line_item.text_field :description, :label => false
              %td= line_item.text_field :quantity, :class => "input-mini quantity", :label => false, :id => "quantity"
              %td= line_item.text_field :rate, :class => "input-mini rate", :label => false, :id => "rate"
              %td.multTotal 0
      %p#grandTotal.pull-right 0
      %p= f.link_to_add "Add", :invoice_line_items, :data => { :target => "#line-items" }, :id => "hello"
      .form-actions
        = f.submit "Preview Invoice", :class => "btn btn-primary pull-right" 
```

为什么这不起作用？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:16:06.697

这样做的原因是，当您使用`nested_form`gem 删除字段时，字段本身并没有被删除，只是被隐藏了。具体来说，它会添加`style="display: none;"`到`.fields`元素中，因此当您循环计算小计时，您需要排除这些元素。更改您的循环`multInputs()`以排除隐藏元素应该可以解决问题，例如使用：

```
$("tr.txtMult:visible").each(function () { ... })
// or
$("tr.txtMult").not("[style]").each(function () { ... }) 
```

# c# - 如何删除使用 string.Replace("-", "") 后剩余的空间

> ID：15800867
> 
> 赞同：2
> 
> 时间：2013-04-04T01:02:29.947
> 
> 标签：c#, .net

我已经使用 PDFBox 将 PDF 文档转换为文本。但是，许多单词用破折号分成两行。

例如，单词`Others`变为`Oth-ers`，单词`becoming`变为`be-coming`等。

如果我用`string.Replace`空字符串替换“-”，它会在单词之间用空格分隔。

在 C# 中有没有办法删除单词中间的破折号并将单词的各个部分再次连接成一个单词？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:16:27.480

我写了这个单元测试，破折号被正确删除。

```
[TestMethod]
public void ReplaceDashByEmptyString()
{
    string othersWithDash = "Oth-ers";

    string othersWithoutDash = othersWithDash.Replace("-", string.Empty);

    Assert.AreEqual("Others", othersWithoutDash);
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T01:24:56.203

你可以用[`Regex.Replace`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.replace.aspx)这个。

```
var text =@"Others Oth-ers";
var matches = Regex.Matches(text, @"\w+\-\w+");
foreach(Match dashMatch in matches)
{
    text = Regex.Replace(text, Regex.Escape(dashMatch.Value), dashMatch.Value.Replace("-", string.Empty));
}    
//Then you can have your new test variable 
```

# jquery - 查找数组元素的索引

> ID：15800868
> 
> 赞同：0
> 
> 时间：2013-04-04T01:03:00.240
> 
> 标签：jquery, jquery-mobile

我有一个元素数组，我想获取被点击的元素的索引，但是在我的代码中我一直得到相同的值。即使通过萤火虫我可以看到所有元素都在数组中。我的代码如下

ajax 调用的回调如下：

```
function featuredtrackscallback(rtndata) 
{ 
//$('#pagetitle').html("New Articles");
var data="";
for(j=0;j<=rtndata.length -1;j++)
{
    links[j] = "<li><a href='./player.html?id="+rtndata[j].track_id+"' data-transition='slide' id="+rtndata[j].track_name+"><h3>" + rtndata[j].track_name + "</h3><p><strong>" + rtndata[j].artist_name + "</strong></p><p>" + rtndata[j].genre_name + "</p></a></li>";
    $('#featurelist').append(links[j]);
}
$('#featurelist').listview('refresh'); 
} 
```

在`.done`ajax 调用部分我正在使用这个函数

```
.done(function(){ 

        $('li').on('click', 'a', function () {
            alert(links.indexOf(this.li));

        }); 
```

当我单击链接时，我只能得到值 -1，这是不可能的。如何获取用户单击的列表视图中链接的索引值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:16:32.233

听起来您可能正在寻找 index() 方法。

[http://api.jquery.com/index/](http://api.jquery.com/index/)

您可能还需要 parent() 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T17:04:02.230

这段代码似乎工作正常

```
.done(function(){ 
        $('ul').children('li').on('click', function () {
        var selected_index = $(this).index();
        alert('Selected Index = ' + selected_index);
    }); 
```

但是如何使用该索引来获取索引中的值，例如 href 和 id

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:54:38.030

我认为最大的问题是您正在尝试将 DOM 元素与字符串匹配。这不会按照您的脚本编写方式工作。

完成这项工作需要两个修复程序。

第一个是获取该 DOM 元素并获取它的字符串版本：

```
 $('li').on('click', 'a', function () {
     var match_string = $(this).parent().clone().wrap('<li/>').parent().html();
     alert( links.indexOf( match_string ) );
  }); 
```

第二个需要更改设置数组时使用的引号`<li>`。放入字符串格式的 DOM 元素在其属性值周围使用双引号，并且两个字符串必须*完全*匹配才能使其工作。

```
links[j] = '<li><a href="./player.html?id='+rtndata[j].track_id+'" data-transition="slide" id="'+rtndata[j].track_name+'"><h3>'+rtndata[j].track_name+'</h3><p><strong>'+rtndata[j].artist_name+'</strong></p><p>'+rtndata[j].genre_name+'</p></a></li>'; 
```

[**解决方案证明**](http://jsbin.com/avibon/1/edit)

# html - 如何让弹窗覆盖文章

> ID：15800873
> 
> 赞同：0
> 
> 时间：2013-04-04T01:03:25.040
> 
> 标签：html, css, facebook, facebook-like

当我按下喜欢它假设弹出覆盖文章时，我无法弄清楚这个 Facebook Like 按钮，但我的它只是在文本后面，用户根本无法按下或做任何事情

![在此处输入图像描述](https://i.stack.imgur.com/OhBWP.png)

* * *

与我发现的其他网站不同，该网站以 Theverge 为例

他们的弹出窗口覆盖了文章，继续发送到Facebook墙不会有任何问题

![在此处输入图像描述](https://i.stack.imgur.com/Gnoix.png)

这是我现在拥有的共享按钮的 CSS

```
/* Share */
.share-post {
    clear: both;
    margin: 10px -20px -20px;
    padding: 10px 0 10px 10px;
    background: #F7F7F7;
    border-top: 1px solid #EAEAEA;
    height: 20px;
}

.mini-share-post {
    clear: both;
    margin: 10px -20px -20px;
    padding: 10px 10px 10px 25px;
    height: 20px;
}

.recent-box .mini-share-post {
    margin-bottom: -5px;
}

.share-post li, .mini-share-post li {
    float: left;
    width: 120px;
}

.share-post span.share-text {
    background: #FF8500;
    margin: -10px 10px -10px -10px;
    display: block;
    float: left;
    color: #FFF;
    padding: 9px;
    font-family: BebasNeueRegular, arial, Georgia, serif;
    font-size: 14pt;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:07:15.120

检查您的帖子所包含`z-index`的`div`（或其他内容，取决于您使用的内容），并为 Facebook 小部件设置一个更高的值。

通常`z-index: 1001;`在这种情况下设置对我有用，但如此高的值被认为是相当肮脏的修复。

# 编辑

好的，我现在知道出了什么问题（我假设是您个人资料中的网站）。`span`div 里面有一个class `fb-like fb_edge_widget_with_comment fb_iframe_widget`。将宽度更改`span`为大约 500 像素。

所以你不必更改`z-index`，但下次**请**提供一些代码。不是一切都可以从图像中猜到。

# javascript - Skrollr 相对模式在 Chrome 或 Safari 中无法正常工作

> ID：15800874
> 
> 赞同：1
> 
> 时间：2013-04-04T01:03:39.227
> 
> 标签：javascript, jquery, html, css

我正在使用 Skrollr 插件 ( [https://github.com/Prinzhorn/skrollr](https://github.com/Prinzhorn/skrollr) ) 使用相对模式来开始和结束我的动画。在 IE 中一切正常，但动画在 Safari 和 Chrome 中出现较早，在 Firefox 中出现较晚。我使用 data-bottom 作为起点，使用 data-center 作为终点。所以动画应该在整个元素刚刚从视口底部弹出并在视口中心结束时开始。

这是网站，您可以在“为什么妈妈事工”部分下的 div id="div56709" 下看到动画。

[http://group.com/womens-ministry/where-moms-connect](http://group.com/womens-ministry/where-moms-connect)

任何关于为什么会发生上述问题的想法将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T06:07:10.487

> 所以动画应该在整个元素刚刚从视口底部弹出时开始

嗯，不完全是。**是元素**底部位于视口底部时的`data-bottom`缩写`data-bottom-bottom`，表示元素的底部。你描述的是。**`data-bottom-top`**

 **我在 Firefox 和 Chrome 中尝试过，它看起来和预期的一样。

您可以尝试的一件事是调用`refresh()`window.onload。这将重新计算相对模式。也许当您调用时`init()`，有些图像未加载，它们会将内容向下移动（即使您明确设置`width`了`height`img 元素。）

编辑：事实上，我只是验证了这是问题所在。您可以通过按 ctrl+f5 来强制重新加载来验证。动画将关闭。如果您现在调整浏览器的大小（`refresh`内部触发），它可以工作。**

# mysql - WordPress 数据库性能：Percona 服务器 vs MySQL w/o InnoDB

> ID：15800875
> 
> 赞同：5
> 
> 时间：2013-04-04T01:03:52.227
> 
> 标签：mysql, performance, wordpress, innodb, percona

我不想主观地问“哪个 DBMS 最好？” 或“这两者中哪个 DBMS 更好？”。这不一定是狂热的辩论。

相反，我欢迎任何基准测试结果或特定经验，当涉及到一个特定标准 - 性能 - 特别是关于一个特定应用程序：WordPress。

我知道 WordPress 不使用 InnoDB，因此在 MySQL 中禁用 InnoDB 可以加快速度。另一方面，Percona 是 MySQL 的一个分支，它用 XtraDB 代替了 InnoDB，并且还声称高效、高性能。

在运行 WordPress 时，每种方法的性能如何？（无需竞争……据我所知，两者都可能看起来很好）

我已经尝试在 Google 上进行一般搜索，但没有遇到过智能讨论，更不用说性能基准测试了。

如果这里有任何专家可以分享他们的经验，将不胜感激。非常感谢！

并且请保留任何自鸣得意、讽刺的评论，比如“你为什么不试试”。如果可以的话，我会的。Stack Overflow 的目的是分享专业知识并相互学习，而不是自己做所有事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-10T22:36:17.077

这个问题比“MyISAM vs. InnoDB/XtraDB”要少“MySQL vs. Percona Server”。它们都有自己的性能特征，适合您的存储引擎很大程度上取决于您的工作负载。大多数 Wordpress 站点的流量都很低并且主要是读取，因此只要您的数据适合您的缓冲池（对于 InnoDB/XtraDB）或密钥缓存（对于 MyISAM），我希望性能不会太不同。

在 Wordpress 数据库优化方面做了大量工作后，我可以告诉您，您的 Wordpress 站点的性能更多地取决于您的硬件类别和您选择的插件。

*   您应该使用缓存插件，这样您就可以避免大量的数据库读取请求
*   您应该避免使用发出昂贵查询的插件（遗憾的是，这涵盖了大多数插件）
*   您应该修剪您的评论（通常评论是 99+% 的垃圾邮件，所以那些被标记为垃圾邮件的评论只是坐在您的数据库中占用空间）
*   您的主机应该有足够的 RAM 用于热数据集以适合内存

如果您真的想详细了解 MyISAM 与 InnoDB/XtraDB，可以查看以下链接：

[http://www.mysqlperformanceblog.com/2009/01/12/should-you-move-from-myisam-to-innodb/](http://www.mysqlperformanceblog.com/2009/01/12/should-you-move-from-myisam-to-innodb/) [http://www.rackspace.com/knowledge_center/article/mysql-engines-myisam- vs-innodb](http://www.rackspace.com/knowledge_center/article/mysql-engines-myisam-vs-innodb)

因此，要做出更长的回答，您需要在生成生产流量后分析您的 MySQL 实例。我知道你说你不能，但是......这个问题有点像我问“什么样的发型最适合我”，而不包括图片。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-10T23:02:32.507

Wordpress 可以很好地使用 InnoDB（或 XtraDB）。我已经使用 MyISAM、InnoDB 和 XtraDB 为大规模托管 WordPress 的网站进行过咨询和培训。

WordPress 3.5.1 创建表而不指定存储引擎。因此，它尊重您使用的任何 MySQL 实例的默认存储引擎。从 MySQL 5.5（约 2010 年 12 月）开始，默认存储引擎是 InnoDB。我测试了在运行 MySQL 5.6.10 的虚拟主机上安装 WordPress，它使用 InnoDB 存储引擎创建表。

我没有任何基准可以分享，但无论如何这些基准的用处都是有限的，因为性能在很大程度上取决于给定的硬件、流量负载和其他因素。

像 WordPress 这样的 CMS 往往偏重于只读查询。这是 InnoDB 应该带来好处的地方，因为它缓存数据页和索引。MyISAM 只缓存索引，并依赖文件系统缓存来保存数据。

因此，使 WordPress 表现良好的关键是分配足够的空间`innodb_buffer_pool_size`来保存所有表的数据和索引。WordPress 网站（即使是数百篇文章）的数据大小通常不是很大，因此您可能只需要几 GB 的缓冲池即可将所有频繁请求的数据保存在缓冲区中。一旦数据和索引页面填充了 InnoDB 缓冲池，99.9% 的查询将在 RAM 之外提供服务，并且该站点将具有出色的性能。

与任何缓存系统一样，性能的真正杀手是当您的“热”数据大于缓存时，会迫使查询产生磁盘 I/O。单个磁盘 I/O 值得数千次 RAM 访问，因此您希望尽可能完全地从 RAM 中提供内容。

XtraDB 的改进旨在帮助 Threads_running 的数量增加或缓冲池变得更大（例如几十 GB）。单个 WP 站点不太可能如此频繁地使用 MySQL 或 Percona Server，以至于这些改进提供的优势不仅仅是一点点优势。除非您要像托管公司一样在给定服务器上托管数百个 WP 站点。

您甚至可能会发现瓶颈不再是数据库，然后您需要专注于前端优化。

# javascript - 通过Javascript将远程图像保存到本地文件夹

> ID：15800876
> 
> 赞同：0
> 
> 时间：2013-04-04T01:03:52.573
> 
> 标签：javascript, ios, file-io, mobile-website, trigger.io

是否可以将具有指定 URL 的图像下载到 Web 应用程序空间内的文件夹中，例如 in `/images`，以便在本地访问？

I say this because I'm writing a mobile web app wrapped with TriggerIO but the native saving functionality is super slow and freezes up the phone in the process, so any touch interactions have a 5+ second delay.

Are there any known javascript options to get around this?

Thanks!

# android - 将 MapFragment 放在前面（在 DialogFragment 内）

> ID：15800877
> 
> 赞同：1
> 
> 时间：2013-04-04T01:03:53.290
> 
> 标签：android, android-dialogfragment, supportmapfragment

我已经成功地膨胀了一个 DialogFragment，然后以编程方式将 MapFragment 添加到“目标”框架布局中。地图显示正常，但顶部似乎有对话框不透明的黑色背景。无论如何要“把它带到前面”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-25T13:13:32.870

我有同样的问题。对我来说唯一可行的解​​决方案 - 实例化时启用`zOrderOnTop`标志`SupportMapFragment`：

```
SupportMapFragment supportMapFragment = SupportMapFragment.newInstance(new GoogleMapOptions().zOrderOnTop(true)); 
```

您也可以在 xml 中执行此操作：

```
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
   xmlns:map="http://schemas.android.com/apk/res-auto"
   map:zOrderOnTop="true"
   ...
/> 
```

# haskell - 作用域类型变量需要显式的 foralls。为什么？

> ID：15800878
> 
> 赞同：28
> 
> 时间：2013-04-04T01:03:56.423
> 
> 标签：haskell, ghc, type-systems, quantifiers, type-extension

如果要使用 GHC 的[词法范围类型变量](http://www.haskell.org/ghc/docs/7.6.2/html/users_guide/other-type-extensions.html#scoped-type-variables)，还必须使用[显式通用量化](http://www.haskell.org/ghc/docs/7.6.2/html/users_guide/other-type-extensions.html#explicit-foralls)。也就是说，您必须在`forall`函数的类型签名中添加声明：

```
{-# LANGUAGE ExplicitForAll, ScopedTypeVariables #-}

f :: forall a . [a] -> [a]      -- The `forall` is required here ...
f (x:xs) = xs ++ [x :: a]       -- ... to relate this `a` to the ones above. 
```

这实际上是否与量化有关，或者扩展编写者只是将`forall`关键字作为一个方便的标记，用于新的、更广泛的范围适用的地方？

换句话说，为什么我们不能`forall`像往常一样省略？函数体内注解中的类型变量指的是函数签名中的同名变量，这不是很清楚吗？还是打字会有问题或模棱两可？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-04T01:03:56.423

是的，量词是有意义的，并且是有意义的类型所必需的。

首先请注意，在 Haskell 中确实没有“未量化”类型签名这样的东西。没有 a 的签名`forall`实际上是隐式量化的。这段代码...

```
f :: [a] -> [a]                         -- No `forall` here ...
f (x:xs) = xs ++ [x :: a]               -- ... or here. 
```

...真正的意思是：

```
f :: forall a . [a] -> [a]              -- With a `forall` here ...
f (x:xs) = xs ++ [x :: forall a . a]    -- ... and another one here. 
```

因此，让我们弄清楚这说明了什么。重要的是要注意，在for和 for`a`签名中命名的类型变量由*单独*的量词绑定。这意味着它们是*不同*的变量，尽管共享一个名称。所以上面的代码等价于：`f``x`

 **```
f :: forall a . [a] -> [a]
f (x:xs) = xs ++ [x :: forall b . b]    -- I've changed `a` to `b` 
```

通过区分名称，现在不仅可以清楚地看出签名中的类型变量`f`和`x`是不相关的，而且声明的签名`x`可以`x`具有*任何*类型。但这是不可能的，因为`x`必须将特定类型绑定到`a`when`f`应用于参数。事实上，类型检查器拒绝了这个代码。

另一方面，`forall`签名中有一个`f`...

```
f :: forall a . [a] -> [a]              -- A `forall` here ...
f (x:xs) = xs ++ [x :: a]               -- ... but not here. 
```

... `a`in 签名 on由's 类型签名`x`开头的量词绑定，因此这表示与in的签名中调用的变量表示的类型相同的类型。`f``a``a``f`**

# compiler-construction - 添加 jmp 指令

> ID：15800881
> 
> 赞同：1
> 
> 时间：2013-04-04T01:04:28.387
> 
> 标签：compiler-construction, llvm, intel, instrumentation, testcocoon

我想在二进制文件中的每条类似 jmp 的指令之后添加**无害****，** `unconditional branches`以确保当我们记录使用 Intel 的. 就像在这段代码中：**`Last Branch Record`**

 **```
if(a==0){
 f1(); 
}
else{
 f2();
} 
```

当执行该`else`部分时，`jne`可能会执行一条指令。但是，没有`jmp-related`指令可以观察到该`if`部分已执行。

*   是否有工具可以在**二进制级别**或**源级别**为条件语句**静态添加**这些指令？`unconditional jmp`
*****   我试过`TestCocoon`这样使用：`csgcc --cs-branch -g test.c`但是，检测开销非常高（大约是原始可执行文件的 3 倍）。我想我没有使用正确的编译器选项。如果您可以提供一些指针来添加具有低检测开销的无害无条件分支，那就太好了。****

 ***** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T08:13:12.337

[Pin](http://software.intel.com/en-us/articles/pin-a-dynamic-binary-instrumentation-tool) is a good binary instrumentation tool for X86\. You can easily achieve with it what you intend.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T17:16:54.693

是的，有一个工具可以**静态**地做到这一点，尽管它需要源代码生产者的合作。这是一个[视频，其中一些开发人员使用 llvm 来尝试查找竞争条件](http://www.youtube.com/watch?v=CPnRS1nv3_s)。但是，建议的 PIN 工具可以精确地完成您想要的（或至少如所描述的那样）。

我认为您应该问自己的一个好问题是，这是否是分析是必须静态完成的事情。就此而言，我将您指向[动态分析](http://en.wikipedia.org/wiki/Dynamic_program_analysis)。另一个要问的问题是你是否真的应该从头开始这样做；社区制作的工具的可用性相当广泛。[这是一个很好的分析器](https://code.google.com/p/likwid/)，但我不确定这是否适合您的需求，因为您没有很好地描述您的需求......

另外，关于开销——我认为几乎任何检测工具都会增加*很多*开销。为了解决这个问题，我想说的是，产生高效分析所需的努力通常是不值得的。除非您正在制作分析库，否则我建议您不要这样做，因为您想要的只是检测的结果。******

# html - Ajax：响应消息的内容类型 text\/html 与绑定的内容类型不匹配（application\/soap+xml; charset=utf-8）

> ID：15800885
> 
> 赞同：0
> 
> 时间：2013-04-04T01:04:37.917
> 
> 标签：html, xml, ajax, wcf, iis

我一直在阅读与“响应消息的内容类型文本/html 与绑定的内容类型（应用程序/soap+xml；charset=utf-8）不匹配”问题相关的帖子但似乎没有一个解决我的问题。

让我解释：

我有一个对 WCF 方法的 ajax 调用，它返回一个 json 对象。

![阿贾克斯调用](https://i.stack.imgur.com/r900h.png)

好的，现在我的 wcf 服务位于同一个应用程序中（不要问我为什么）：

![WCF](https://i.stack.imgur.com/HHu5Z.png)

这是应用程序拥有的唯一 web.config。

```
<services>
    <service behaviorConfiguration="defaultBehavior" name="HSMobileApp.Services.HSMobile">

        <endpoint address="pox" behaviorConfiguration="poxBehavior" binding="webHttpBinding" bindingConfiguration="webBinding" contract="HSMobileApp.Services.IHSMobile" />

    <host>
        <baseAddresses>
            <add baseAddress="/Services/HSMobile" />
        </baseAddresses>
    </host>
    </service>
</services>

<bindings>
  <webHttpBinding>
    <binding name="webBinding" />
  </webHttpBinding>
</bindings>

<behaviors>
  <endpointBehaviors>
    <behavior name="poxBehavior">
      <webHttp defaultOutgoingResponseFormat="Xml" />
    </behavior>
    <behavior name="jsonBehavior">
        <webHttp defaultOutgoingResponseFormat="Json" />
    </behavior>
  </endpointBehaviors>

  <serviceBehaviors>
    <behavior name="defaultBehavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

所以，我的 ajax 调用我在同一个应用程序中托管的 svc，在 Visual Studio 2010 环境中工作正常，但是当我尝试在 IIS 上调试它时，这是我在达到 WCF 方法后得到的。

> "Associate":0,"MenuOptions":"响应消息的内容类型text/html与绑定的内容类型(application/soap+xml;charset=utf-8)不匹配。如果使用自定义编码器，确保 IsContentTypeSupported 方法正确实现。响应的前 1024 个字节是：...

我知道这一定是某种绑定 o IIS 的情况，但我不知道在哪里看，因为我的服务器 web.config 与客户端 web.config 相同

我在 Windows 7 Enterprise、IIS 7.5、VS2010 和 jquery 1.6.2 中工作

请帮我！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T11:34:12.983

您可以删除“jsonBehaviour”（因为它未使用）并尝试将其放入您的“poxBehaviour”中：

```
<webHttp automaticFormatSelectionEnabled ="true" /> 
```

您还应该能够简化您的服务，只需使用以下内容：

```
<endpoint address="pox" behaviorConfiguration="poxBehavior" kind="webHttpEndpoint" contract="HSMobileApp.Services.IHSMobile" /> 
```

在您的 AJAX 请求中，您可以设置接受标头或内容类型以明确告诉服务器您想要 JSON 结果，否则它将使用默认格式，[请参阅此处以获取有关“automaticFormatSelectionEnabled”设置的更多详细信息](http://aspdotnetcodebook.blogspot.co.uk/2011/01/how-to-return-multiple-response-from.html)。

请注意，这假定您的 WCF 属性已在您的服务器代码中正确设置（它们可能是这样，否则它永远不会起作用）。

# regex - 查找没有指定字符的文件名

> ID：15800888
> 
> 赞同：2
> 
> 时间：2013-04-04T01:05:05.343
> 
> 标签：regex, linux, file, unix, sed

`regex`找到所有**不**包含某个字符的文件有什么好处吗？我知道有很多可以找到包含匹配项的行，但我想要一些能够找到所有**不**包含我的匹配项的文件的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:22:16.240

使用`ls`and`sed`将所有没有扩展名的文件名（即不包含 a `.`）替换为`NoExtension`：

```
ls | sed -e 's/^[^.]*$/NoExtension/g' 
```

用扩展名替换具有扩展名的文件名：

```
ls | sed -e 's/^[^.]*$/NoExtension/g' -e 's/.*\.\(.*\)/\1/' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T01:20:40.260

对于 bash - 列出目录中的所有文件 - ：

```
shopt -s extglob
ls !(*.*) 
```

需要 extglob 设置才能启用！这否定了*.* ls的论据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T19:08:07.307

您应该丢弃所有解析`ls`read [here](http://mywiki.wooledge.org/ParsingLs)输出的答案，以了解原因。该工具`find`非常适合这一点。

```
# Show files in cwd
$ ls
file  file.txt

# Find the files with an extension 
$ find -type f  -regex '.*/.*\..*$'
./file.txt

# Invert the match using the -not option
$ find -type f  -not -regex '.*/.*\..*$'
./file 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T02:31:59.633

还有一个 awk 解决方案，可以很好地衡量。

```
ls | awk '$0 !~ /\..+$/{a++}END{print a}' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T08:34:39.547

这可能对您有用（查找，GNU sed & wc）：

```
find . -type f | sed -rn '\|.*/\.?[^.]+$|w NoExtensions' && wc -l NoExtensions 
```

这会给你一个计数和一个列表。

包括不带扩展名的NB`dot`文件。

# sql - SRSS 带有值范围的条件格式颜色？

> ID：15800889
> 
> 赞同：1
> 
> 时间：2013-04-04T01:05:37.313
> 
> 标签：sql, reporting-services

我有一个 sql 报告服务报告，显示我们所有商店的销售额等，它包括一个显示预算值百分比的列。我想要做的是如果值是`>= .35`然后使它成为单元格的背景`Green`，如果值是`< .35 and > .30`那么`Yellow`如果值是`< .30 then Red`。

这真的让我很头疼，我似乎无法让它与所有 3 个范围一起工作。

我可以在单元格的背景颜色属性中放入表达式：

```
=IIF(Fields!ID__to_Budget.Value >= 0.35, "Green", "Red") 
```

这行得通，但当然我没有任何黄色范围，任何低于 0.35 的东西都会变成红色。

我一直在尝试对背景颜色做一个嵌套表达式，如下所示：

```
=iif( (Fields!ID__to_Budget.Value >= 0.35), "Green",
      ( iif(Fields!ID__to_Budget.Value <0.35 and > 0.30, "Yellow",
         iif(Fields!ID__to_Budget.Value < 0.30 "Red", "White") ) ) ) 
```

但它抱怨“和> 0.30”部分的语法错误。

非常感谢兰斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T01:35:45.160

你少了一个逗号。但是，嵌套 Iif 很痛苦，所以要执行简单的函数路由，我会使用`Switch`函数来代替，所以你不必嵌套任何东西——这样更容易获得正确的语法。

```
=Switch(
   Fields!ID__to_Budget.Value < 0.30, "Red",
   Fields!ID__to_Budget.Value < 0.35, "Yellow",
   Fields!ID__to_Budget.Value >= 0.35, "Green"
) 
```

有关此函数的更多信息，请参阅[Reporting Services 表达式示例](http://technet.microsoft.com/en-us/library/ms157328%28v=sql.110%29.aspx)。

但在我看来，编码值的“严重性”在数据库中做得更好：

```
CREATE TABLE dbo.BudgetSeverity (
   FromValue decimal(20, 10) NOT NULL PRIMARY KEY CLUSTERED,
   ToValue decimal(20,10) NOT NULL,
   SeverityLevel tinyint NOT NULL
);
INSERT dbo.BudgetSeverity
VALUES
   (-9999999999, 0.3, 1),
   (0, 0.35, 2),
   (0.35, 9999999999, 3)
; 
```

然后在你的数据集中，加入这个表。

```
SELECT
   ...,
   BS.SeverityLevel
FROM
   ...
   INNER JOIN dbo.BudgetSeverity BS
      ON B.ID__to_Budget >= BS.FromValue
      AND B.ID__to_Budget < BS.ToValue 
```

最后，在您的报告中：

```
=Choose(Fields!SeverityLevel.Value, "Red", "Yellow", "Green") 
```

这样您就可以更改严重性级别，而无需部署新报告。如果您不喜欢将其放入数据库的想法，您还有其他选择。在报告的代码部分，您可以编写一个简单的函数来根据传入的值返回颜色。然后您可以使用更容易管理的 Case 语句，并且您可以在不同的字段中重用此函数，如果发生变化，可以更轻松地一次更新所有这些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:25:27.457

和颜色在`,`最后没有`iff clause``condition``Red`

```
=iif(Fields!ID__to_Budget.Value >= 0.35, "Green",
     iif(Fields!ID__to_Budget.Value <0.35 &
          Fields!ID__to_Budget.Value> 0.30,"Yellow", 
         iif(Fields!ID__to_Budget.Value < 0.30, "Red","White") ) )
    ) 
```

# javascript - 如何使用 JavaScript 枚举 JSON 列表列表

> ID：15800893
> 
> 赞同：1
> 
> 时间：2013-04-04T01:06:11.537
> 
> 标签：javascript, json, list, nested

我从第三方服务收到以下 JSON 字符串。（这是来自 JSON 字符串的有问题的片段）

```
"last_data_store" : { 
    "02:00:00:00:2a:1a" : 
        { "K" : 1364400231,
          "a" : 4.5,
          "b" : 67,
          "g" : 15634
        },
    "70:ee:50:00:2c:b8" : {
          "'" : 1003.1,
           "K" : 1364400233,
           "S" : 36,
           "a" : 16.199999999999999,
           "b" : 44,
           "e" : 1013.6,
           "g" : 11244,
           "h" : 413
     }
} 
```

如何递归解析它以便提取键：值对？

我可以遍历 last_data_store 中的两个列表“对象”中的每一个

```
LastDataStore = obj.body.devices[0].last_data_store;
var index = 0;
for (data in LastDataStore) {
console.log(data);
index ++;
} 
```

但我只得到 MAC 地址字符串（例如“02:00:00:00:2a:1a”）

如果我尝试类似

```
LastDataStore = obj.body.devices[0].last_data_store;
var index = 0;
for (data in LastDataStore) {
console.log(data.K);
index ++;
} 
```

我收到一个“未定义”的值。

同样，如果我使用以下

```
LastDataStore = obj.body.devices[0].last_data_store;
var index = 0;
for (data in LastDataStore) {
console.log(data);
index ++;
      for (foobar in data) {
          console.log(foobar);
      }
} 
```

我只得到数字 0 到 16，我认为这是 MAC 地址中的字符数。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:14:28.960

尝试：

```
LastDataStore = obj.body.devices[0].last_data_store;
var index = 0;
for (data in LastDataStore) {
  console.log(LastDataStore[data]);
  index ++;
} 
```

在您的每个示例中，您的`for`循环都返回键，您仍然需要索引到您的对象以获得相应的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:16:05.607

首先，你没有两个列表，你有两个对象。对象与列表非常不同。您`for...in`使用的循环是返回属性名称（键）而不是`data.K`未定义的值。

```
var prop, value;
for (prop in LastDataStore) {
    value = LastDataStore[prop];
    console.log(value.K); // this works now, you've fetched the object with the line above.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:18:41.033

```
LastDataStore = obj.body.devices[0].last_data_store;
for (x in LastDataStore) {
    for (y in LastDataStore[x]) {
        console.log("key: " + y + ", value: " + LastDataStore[x][y])
    }
} 
```

示例：http: [//jsfiddle.net/hZ7QB/](http://jsfiddle.net/hZ7QB/)

# python - 在列表中查找数字簇

> ID：15800895
> 
> 赞同：18
> 
> 时间：2013-04-04T01:06:51.630
> 
> 标签：python, list

我正在为此苦苦挣扎，因为我确信十几个 for 循环不是解决这个问题的方法：

有一个排序的数字列表，例如

```
numbers = [123, 124, 128, 160, 167, 213, 215, 230, 245, 255, 257, 400, 401, 402, 430] 
```

我想创建一个带有数字列表的字典，其中数字的差异（彼此跟随）不超过 15。所以输出将是这样的：

```
clusters = {
    1 : [123, 124, 128],
    2 : [160, 167],
    3 : [213, 215, 230, 245, 255, 257],
    4 : [400, 401, 402],
    5 : [430]
} 
```

我目前的解决方案有点难看（我必须在最后删除重复项......），我确信它可以以 python 的方式完成。

这就是我现在所做的：

```
clusters = {}  
dIndex = 0 
for i in range(len(numbers)-1) :
    if numbers[i+1] - numbers[i] <= 15 :
        if not clusters.has_key(dIndex) : clusters[dIndex] = []
        clusters[dIndex].append(numbers[i])
        clusters[dIndex].append(numbers[i+1])
    else : dIndex += 1 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-04T01:48:35.077

如果您的列表很小，则不是绝对必要的，但我可能会以“流处理”方式处理此问题：定义一个生成器，该生成器将您的输入迭代，并产生分组为相差 <= 15 的数字运行的元素。然后您可以使用它轻松生成字典。

```
def grouper(iterable):
    prev = None
    group = []
    for item in iterable:
        if prev is None or item - prev <= 15:
            group.append(item)
        else:
            yield group
            group = [item]
        prev = item
    if group:
        yield group

numbers = [123, 124, 128, 160, 167, 213, 215, 230, 245, 255, 257, 400, 401, 402, 430]
dict(enumerate(grouper(numbers), 1)) 
```

印刷：

```
{1: [123, 124, 128],
 2: [160, 167],
 3: [213, 215, 230, 245, 255, 257],
 4: [400, 401, 402],
 5: [430]} 
```

作为奖励，这甚至可以让您将运行分组为潜在的无限列表（当然，只要它们已排序）。您还可以将索引生成部分粘贴到生成器本身中（而不是使用`enumerate`）作为次要增强。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T01:20:33.667

```
import itertools
import numpy as np

numbers = np.array([123, 124, 128, 160, 167, 213, 215, 230, 245, 255, 257, 400, 401, 402, 430])
nd = [0] + list(np.where(np.diff(numbers) > 15)[0] + 1) + [len(numbers)]

a, b = itertools.tee(nd)
next(b, None)
res = {}
for j, (f, b) in enumerate(itertools.izip(a, b)):
    res[j] = numbers[f:b] 
```

如果你可以使用 itertools 和 numpy. 适用[`pairwise`](http://docs.python.org/2/library/itertools.html#recipes)于迭代器技巧。`+1`需要移动索引，将和`0`添加`len(numbers)`到列表中以确保正确包含第一个和最后一个条目。

你显然可以不用 out 来做到这一点`itertools`，但我喜欢`tee`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-03-04T19:00:07.200

您可以使用 numpy / pandas 在没有（显式）循环的情况下实现：

```
import pandas as pd    
import numpy as np

n = 15
numbers = [123, 124, 128, 160, 167, 213, 215, 230, 245, 255, 257, 400, 401, 402, 430]
nnumbers = np.array(numbers)
clusters = pd.DataFrame({
    'numbers': numbers,
    'segment': np.cumsum([0] + list(1*(nnumbers[1:] - nnumbers[0:-1] > n))) + 1
}).groupby('segment').agg({'numbers': set}).to_dict()['numbers'] 
```

诀窍是移动数字列表并将差异与您的阈值（15）进行比较，以找到段之间的“中断”。当然，第一个元素不会是中断。然后使用 cumsum 函数获取段并使用 set 函数进行分组（以防有重复项）。希望这对您有所帮助，即使自发布此问题以来已经过去了很多年。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-04T01:58:09.523

使用生成器分离逻辑：（一个函数做一件事）

```
numbers = [123, 124, 128, 160, 167, 213, 215, 230, 245, 255, 257, 400, 401, 402, 430]

def cut_indices(numbers):
    # this function iterate over the indices that need to be 'cut'
    for i in xrange(len(numbers)-1):
        if numbers[i+1] - numbers[i] > 15:
            yield i+1

def splitter(numbers):
    # this function split the original list into sublists.
    px = 0
    for x in cut_indices(numbers):
        yield numbers[px:x]
        px = x
    yield numbers[px:]

def cluster(numbers):
    # using the above result, to form a dict object.
    cluster_ids = xrange(1,len(numbers))
    return dict(zip(cluster_ids, splitter(numbers)))

print cluster(numbers) 
```

上面的代码给了我

```
{1: [123, 124, 128], 2: [160, 167], 3: [213, 215, 230, 245, 255, 257], 4: [400, 401, 402], 5: [430]} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-01T23:20:07.400

这是一个适用于列表或生成器的相对简单的解决方案。它会懒惰地产生对`(group_number, element)`，因此如果需要，您必须单独进行实际分组。（或者也许你只需要组号。）

```
 from itertools import tee

 def group(xs, gap=15):
    # use `tee` to get two efficient iterators
    xs1, xs2 = tee(xs)

    # the first element is in group 0, also advance the second iterator
    group = 0
    yield (group, next(xs2))

    # after advancing xs2, this zip is pairs of consecutive elements
    for x, y in zip(xs1, xs2):
        # whenever the gap is too large, increment the group number
        if y - x > gap:
            group += 1
        # and yield the second number in the pair
        yield group, y 
```

# c - 将二维数组转换为单个数组

> ID：15800896
> 
> 赞同：-4
> 
> 时间：2013-04-04T01:07:07.553
> 
> 标签：c, arrays

假设我有一个两个 D 数组。

```
#define ROWS 3
#define COLS 3

char a[ROWS][COLS]= {
                        {'1','2','3'},
                        {'4','5','6'},
                        {'7','8','9'}
                      }; 
```

如何将其值复制到单个数组中。我只想要 COLS 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:49:53.113

1）如果您需要按行顺序复制数组，您可以使用：

-首先有一个一维数组，可以容纳二维数组的所有元素，然后使用 memcpy(new1Darr, org2Darr, 总大小以字节为单位);

就像上面的例子，memcpy(new1Darray, a, sizeof(char)*ROWS*COLS)

2）而不是（1），或者如果您想更改必须存储数据的顺序，那么只需按照您想要的方式（主要列）遍历二维数组并一一复制元素。喜欢（考虑到您首先定义所有变量）

这将按列顺序复制新数组中的元素

```
k=0;
for(j=0;j<COLS;j++)
{
    for(i=0;i<ROWS;i++)
    {
        new1Darray[k] = a[i][j];
        k++;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T01:53:53.633

它非常简单。让我们看看“如何？” -

```
 #define ROWS 3
    #define COLS 3

    #include<stdio.h>
    #include<conio.h>

    char a[ROWS*COLS]={'1','2','3','4','5','6','7','8','9'};

    void main()
    {
     for(int i=0; i<ROWS*COLS;i=i+COLS)
     {
      for(int j=0; j<COLS; j++)
      {
       printf("%c\t",a[i+j]); //access array
      }
      printf("\n");
     }
     getch();
    } 
```

# sass - 如何定义新的重置？

> ID：15800897
> 
> 赞同：0
> 
> 时间：2013-04-04T01:07:09.947
> 
> 标签：sass, compass-sass, css-reset

通过包含`@import "compass/reset";`在我的 .scss 文件中，我可以让 Compass 自动包含一个简单的 HTML5 重置。我想使用不同的重置，那么如何将自己的重置添加到 Compass，或更改默认重置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T02:43:23.490

最简单的方法是在同一个目录中创建一个部分`_reset.scss`并导入它。

允许您跨项目使用它的最简单方法是创建自己的[Compass 扩展](http://compass-style.org/help/tutorials/extensions/)。

如果您从中创建一个 gem（甚至只是在本地），您可以`require`将它放在您`config.rb`的 s 中，然后`@import`将它放入您的`.scss`文件中。

# svg - 带有 .html 扩展名的内联 SVG 正确显示，而带有 .svg 扩展名则不能正确显示

> ID：15800900
> 
> 赞同：1
> 
> 时间：2013-04-04T01:07:44.513
> 
> 标签：svg, d3.js

我有一个由 d3 生成的饼图 SVG。如果我将内容保存在扩展名为 .svg 的文件中，则所有浏览器都无法显示它。

如果我将相同的内容保存在扩展名为 .html 的文件中，它会显示得很好。

为什么 ？

SVG 内容在这里[http://pastebin.com/9QPKT5ju](http://pastebin.com/9QPKT5ju)

更详细地说，不涉及 Web 服务器，只需将内容保存在扩展名为 .html 的文件中并在浏览器中加载文件即可使其正确显示，而将扩展名更改为 .svg 并在浏览器中重新加载会使其消失.

我这样做的原因是我在服务器端使用 Node.js 生成 svg 并希望将生成的 svg 嵌入到 html 页面和 PDF 文件中。对于上面的实验，我只是想看看生成的 svg 是否在浏览器中正确显示，因为它会在固定的 HTML 模板中动态加载。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:20:22.400

您需要将以下内容添加到基本 svg 元素：

```
xmlns="http://www.w3.org/2000/svg" 
xmlns:xlink="http://www.w3.org/1999/xlink" 
```

您的颜色定义也需要是这样的：

```
<radialGradient id="grad-0" cx="0" cy="0" r="190"><stop offset="0" stop-color="#ace98c"></stop><stop offset="0.3" stop-color="#ace98c"></stop><stop offset="1" stop-color="#70c046"></stop></radialGradient> 
```

而不是`radialgradient`（即骆驼外壳[很重要](http://www.w3.org/TR/SVG/styling.html#CaseSensitivity)。）

# java - 在 Java 中使用 Eclipse 为 CORBA IDL 启动命名服务

> ID：15800901
> 
> 赞同：0
> 
> 时间：2013-04-04T01:07:47.060
> 
> 标签：java, corba, idl

我正在学习 CORBA IDL，并且正在使用 Eclipse 和 ORB Studio 开发基于 Java 的分布式系统。我的问题是，除了必须从命令行启动它之外，有没有办法用 Eclipse 启动命名服务？：

tnameserv -ORBInitialPort 1050

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T13:59:45.710

您只需要按照以下步骤创建一个外部工具：

1.  在“外部工具...”中创建外部工具配置，然后在“新配置”中创建
2.  在“主要”选项卡中
3.  “位置”：C:\WINDOWS\system32\cmd.exe
4.  “参数”：/c tnameserv -ORBInitialPort 1050
5.  转到“通用”选项卡检查“分配控制台”
6.  点击运行按钮

# c++ - 模板调用彼此的函数

> ID：15800905
> 
> 赞同：0
> 
> 时间：2013-04-04T01:08:09.073
> 
> 标签：c++, c++11

所以，我有一组相当简单的模板，我想一起使用，但编译器一直告诉我 B::a 的类型不完整。一切都提前声明了，但它仍然不起作用......

```
#include <iostream>

using namespace std;

template <typename T> class A;
template <typename T> class B;

template <typename T>
class A{
public:
    void ATestFunction();
    void CallBFunction();
protected:
    B<T> b;
};

template <typename T>
class B{
public:
    void BTestFunction();
    void CallAFunction();

protected:
    A<T> a;
};

template <typename T>
void A<T>::ATestFunction(){
    cout << "A was used for a function call" << endl;
}

template <typename T>
void B<T>::BTestFunction(){
    cout << "B was used for a function call" << endl;
}

template <typename T>
void A<T>::CallBFunction(){
    b.BTestFunction();
}

template <typename T>
void B<T>::CallAFunction(){
    a.ATestFunction();
}

int main()
{
    A<int> dragons;
    dragons.CallBFunction();
    return 0;
} 
```

我问这个是因为我在编程一些相互依赖的数组类型类时遇到了一些困难（实现一个可以像这样访问的二维数组：[][]），但是这个问题发生了，并且在工作中投入了一个齿轮. 我做了这个测试程序，但它仍然失败。我在 Linux 上尝试过 MinGW 4.7.2 和 GNU g++，每个都给了我同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T01:15:18.097

这段代码可以看出问题的核心：

```
template <typename T>
class A{
    B<T> b;
};

template <typename T>
class B{
    A<T> a;
}; 
```

C++ 是一种具有值语义的语言，这意味着它`B<T> b;`表示类型的对象`B<T>`（而不是引用，如 Java 或 C# 中的引用类型）。也就是说，`A<T>` *包含*一个`B<T>`. 现在，如果您查看`B`模板的定义，您会看到它又包含一个`A<T>`子对象。这基本上是不可能的，因为`A<T>`不可能包含包含`A<T>`. `A<T>`物体的大小是多少？

在不知道要解决的真正问题的情况下，我不会冒险推荐一种方法，但是您可以考虑使用指针（`A<T>`将包含指向 的*指针*，`B<T>`而不是完整的`B<T>`子对象；或者类似地，可以`B<T>`包含*指向*`A<T>`; 或两者的指针），或参考资料。但也可能是更深层次的重新设计可能更有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:53:53.520

即使您使用指针，也无法正常工作。这基本上会触发创建 A 和 B 的无限循环

A创造B创造A创造B创造A...

这会奏效。

```
#include <iostream>

using namespace std;

template<typename T> class A;
template<typename T> class B;

template<typename T>
class A
{
public:
    A()
    {
        b = new B<T>(this);
    }
    A(B<T>* pb)
    {
        b = pb;
    }
    void ATestFunction()
    {
        cout << "A was used for a function call" << endl;
    }
    void CallBFunction()
    {
        b->BTestFunction();
    }
protected:
    B<T>* b;
};

template<typename T>
class B
{
public:
    B()
    {
        a = new A<T>(this);
    }
    B(A<T>* pa)
    {
        a = pa;
    }
    void BTestFunction()
    {
        cout << "B was used for a function call" << endl;
    }
    void CallAFunction()
    {
        a->ATestFunction();
    }

protected:
    A<T>* a;
};

int main()
{
    A<int> dragons;
    dragons.CallBFunction();

    B<int> bdragons;
    bdragons.CallAFunction();
    return 0;
} 
```

或者也许只是使用静态函数

```
#include <iostream>

using namespace std;

template<typename T> class A;
template<typename T> class B;

template<typename T>
class A
{
public:
    static void ATestFunction()
    {
        cout << "A was used for a function call" << endl;
    }
    void CallBFunction();

};

template<typename T>
class B
{
public:
    static void BTestFunction()
    {
        cout << "B was used for a function call" << endl;
    }
    void CallAFunction();

};
template<typename T>
void A<T>::CallBFunction()
{
    B<int>::BTestFunction();
}

template<typename T>
void B<T>::CallAFunction()
{
    A<int>::ATestFunction();
}

int main()
{
    A<int> dragons;
    dragons.CallBFunction();

    B<int> bdragons;
    bdragons.CallAFunction();
    return 0;
} 
```

# ios - 后退按钮 uinavigationcontroller

> ID：15800907
> 
> 赞同：0
> 
> 时间：2013-04-04T01:08:13.047
> 
> 标签：ios, uinavigationcontroller

我正在尝试制作一个自定义后退按钮以在导航控制器中弹回父级。我知道我应该在父控制器本身中制作后退按钮

`self.navigationItem.backBarButtonItem= backBarButton`

该按钮只是带有自定义文本的默认按钮，但它有效。没有任何格式或字体出现。因此，我在子 VC 中创建了一个自定义 leftBarButton：

```
UIButton *backBtn= [[UIButton alloc] init];
backBtn.backgroundColor = [UIColor clearColor];
backBtn.titleLabel.font = [UIFont fontWithName:@"CrimeFighter BB" size:20];
backBtn.titleLabel.textColor = [UIColor whiteColor];
backBtn.titleLabel.text = @"back";
[backBtn addTarget:self action:@selector(pop) forControlEvents:UIControlEventTouchUpInside];

UIBarButtonItem *backBarButton = [[UIBarButtonItem alloc] initWithCustomView:backBtn];
self.navigationItem.leftBarButtonItem = backBarButton; 
```

它工作正常，但按钮根本不可见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:14:06.230

新尝试：

[在 UIButton 上执行 alloc & init 并不是在代码中创建按钮的正确方法](https://stackoverflow.com/questions/6996530/why-uibutton-does-not-require-to-alloc-and-init)。

以编程方式创建按钮的方法是：

```
UIButton * backBtn = [UIButton buttonWithType: UIButtonTypeRoundedRect]; 
```

原始尝试：

您需要为自定义后退按钮提供适当的大小。在创建“”之前尝试这样做`UIBarButtonItem`。

```
backBtn.frame = CGRectMake(20.0f, 0.0f, 70.0f, 30.0f); 
```

最后一个数字是高度，倒数第二个数字是按钮宽度。

# outlook - 以编程方式设置 Outlook 2013 签名默认值？

> ID：15800911
> 
> 赞同：5
> 
> 时间：2013-04-04T01:08:49.030
> 
> 标签：outlook, office-interop, outlook-2013

是否可以以编程方式设置 Outlook 2013 默认签名设置？我们可以生成用户的签名 OK，但还想将签名设置为默认出现在用户的电子邮件中：

![Outlook 2013 电子邮件签名默认值](https://i.stack.imgur.com/hhFL2.png)

该设置本身似乎隐藏在 Outlook 配置文件下的注册表中：

`HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Profiles\Outlook\9375CFF0413111d3B88A00104B2A6677\00000002`

注册值：

*   `New Signature`
*   `Reply-Forward Signature`

...（具有二进制数据，可能对 HTML 文件名/引用进行编码）。

不确定我是否可以使用 Outlook 对象模型来访问和设置设置？ClickOnce 应用程序是否可以实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-21T16:32:08.437

我还没有清理代码，但这适用于我在 Outlook 2013 中设置签名。在 python 中（是的，我知道它丑陋而不是 PEP8）。

```
import _winreg
def set_default():

    try:
        #this makes it so users can't change it.
        outlook_2013_key = _winreg.OpenKey(_winreg.HKEY_CURRENT_USER, r"Software\Microsoft\Office\15.0\Common\MailSettings", 0, _winreg.KEY_ALL_ACCESS)
        _winreg.SetValueEx(outlook_2013_key, "NewSignature", 0, _winreg.REG_SZ, "default" )
        _winreg.SetValueEx(outlook_2013_key, "ReplySignature", 0, _winreg.REG_SZ, "default" )

        # sets the sigs in outlook profile
        outlook_2013_base_key = _winreg.OpenKey(_winreg.HKEY_CURRENT_USER, r"Software\Microsoft\Office\15.0\Outlook\Profiles", 0, _winreg.KEY_ALL_ACCESS)
        default_profile_2013_tup = _winreg.QueryValueEx(outlook_2013_base_key,'DefaultProfile')
        default_profile_2013 = default_profile_2013_tup[0]
        print default_profile_2013
        outlook_2013_profile_key = _winreg.OpenKey(_winreg.HKEY_CURRENT_USER,
                                                   "Software\\Microsoft\\Office\\15.0\\Outlook\\Profiles\\" + default_profile_2013 + "\\9375CFF0413111d3B88A00104B2A6676", 0, _winreg.KEY_ALL_ACCESS)
        for i in range(0, 10):
            try:
                outlook_2013_sub_key_name = _winreg.EnumKey(outlook_2013_profile_key,i)
                print outlook_2013_sub_key_name, "sub_key_name"
                outlook_2013_sub_key = _winreg.OpenKey(outlook_2013_profile_key, outlook_2013_sub_key_name, 0, _winreg.KEY_ALL_ACCESS)
                _winreg.SetValueEx(outlook_2013_sub_key, "New Signature", 0, _winreg.REG_SZ, "default" )
                _winreg.SetValueEx(outlook_2013_sub_key, "Reply-Forward Signature", 0, _winreg.REG_SZ, "default" )
            except:
                pass

    except:
        print('no 2013 found') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-11T20:26:46.097

Outlook 签名在配置文件数据（存储在注册表中）中基于每个帐户设置。您可以在[OutlookSpy](http://www.dimastr.com/outspy)中查看数据- 单击`IOlkAccountManager`按钮并双击该帐户。

[IOlkAccountManager](https://msdn.microsoft.com/en-us/library/office/gg394256.aspx)只能在 C++ 或 Delphi 中访问。如果使用[Redemption](http://www.dimastr.com/redemption)是一个选项（它可以用于任何语言，包括 VBA 或 .Net，我是它的作者），它会公开[RDOAccount](http://www.dimastr.com/redemption/RDOAccount.htm)。`ReplySignature`和`NewMessageSignature`属性。

# java - 正确部署maven项目

> ID：15800912
> 
> 赞同：1
> 
> 时间：2013-04-04T01:08:52.163
> 
> 标签：java, maven

我有一个 Maven 项目，这是一个多模块项目

```
Mainproject
    project1 - jar
    project2 - jar
    project3 - web 
```

现在我完成了项目，我想在服务器上测试它但不知道如何上传它们，在我的计算机上我添加了一个 tomcat 插件，它自动将war文件部署到 tomcat，但服务器没有行家。

这种项目的生产方式是什么？

我应该只上传每个模块的目标目录吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T04:06:56.900

你在这里问几个问题。有“我如何在服务器上测试”一个，还有一个“转移到生产的方式是什么”一个。它们可能完全不同。

我假设项目中的 JAR 文件由 WAR 文件使用并打包在其 WEB-INF/lib 目录中。如果我错了，那很好。只是这种信息很容易知道。

Maven 是一个构建工具。它不是一个部署工具。最后，您拥有的是一个 WAR 文件。如果您运行 mvn install（或 mvn deploy），您将拥有 WAR 文件的 SNAPSHOT 版本。这将适用于对其他机器的快速、临时测试。但是您很可能会使用适合托管容器的方法来使它们可用。注意：Maven DEPLOY 与将战争文件部署到 tomcat 是不同的。

在我看来，如果你将任何东西投入生产，或者在客户面前，或者在测试组面前，你应该使用 Maven 来发布产品。也就是说，使用发布插件（通过 release:prepare 和 release:plugin 目标）创建工件的非 SNAPSHOT 版本（在这种情况下，是 WAR 文件的正式版本）。一旦你有了那个 WAR 文件，你可以用任何最简单的方式将它迁移到你的生产服务器（复制，以最好的方式部署到 tomcat）。您没有提到此 Web 应用程序是否有数据库要求，在您更改任何生产应用程序之前需要考虑这一点。

但是，一旦有了正式版，就有源代码的标签，可以准确的知道运行的是什么代码。

我认为您不会得到的是能够将 WAR 文件从您的开发环境自动复制到生产服务器中。这里是龙。

# java - 集会休息回收站

> ID：15800913
> 
> 赞同：0
> 
> 时间：2013-04-04T01:09:07.333
> 
> 标签：java, api, rest, rally, recycle-bin

在 Rally REST Java API (1.40) 中，如何创建 QueryRequest 以通过 FormattedID 查找特定的 DELETED 项。

```
QueryRequest queryRequest = new QueryRequest("recyclebinentry"); 
```

我在一个不受限制的查询（例如，没有设置过滤器）中看到，FormattedID 的值在“ID”属性中返回，但在查询中使用该属性或 FormattedID 会导致 queryResponse.wasSuccessful() 为假。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:19:46.727

不幸的是，回收站只提供非常有限的查询能力。如您所见，FormattedID 不被接受，DeletedBy、Name、Type 或其他有用的识别字段也不被接受。您真正能做的最好的事情是按删除日期过滤。例如`(DeletionDate >= "2013-03-01T15:00:00Z")`缩小你的结果。然后在客户端手动搜索。

我建议将此作为功能请求发布到[Rally Ideas](https://ideas.rallydev.com)，因为这是一个常见的请求项。

# c++ - 在linux上将文件复制到usb，如何以编程方式知道何时提交文件并且可以释放usb？

> ID：15800915
> 
> 赞同：-1
> 
> 时间：2013-04-04T01:09:29.420
> 
> 标签：c++, linux, file, copy

将Linux上的文件从硬盘复制到USB时，如何知道该过程何时完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:11:21.390

如果您“卸载” USB 设备，所有未完成的写入都将提交到该设备。但是，这确实假设您有足够的权限来执行此操作。

# c# - 如何将属性传递给另一个命名空间中的方法

> ID：15800919
> 
> 赞同：0
> 
> 时间：2013-04-04T01:09:49.350
> 
> 标签：c#, properties, namespaces

我已经定义了一些设置，并计划在我的 VS 2008 C# WPF 项目中定义更多。我知道可以在设计时通过设置设计器在项目中指定设置。我也知道可以在运行时检索和设置设置。我想做的是能够访问其他程序集和项目的设置。

如果不编写新课程，我不明白如何做到这一点。由于设置类是在我的根命名空间中定义的，因此我无法在不创建循环引用的情况下直接从其他程序集中访问设置（如果您尝试添加对已经引用该项目的项目的引用，则会发生这种情况）。有没有办法传递属性而不必创建具有完全相同属性定义的重复类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T02:17:38.987

我了解您正在尝试从项目中未引用的程序集中读取属性。在这种情况下，[反思](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.110%29.aspx)就是答案。

读取该程序集的信息，无论它在哪里`dll`。加载`Settings`类、获取`Default`设置并访问所需的参数。

例如，我有一个名为 的 dll `se2.dll`，带有一个我通常会访问的参数：

```
string parameterValue = se2.Settings2.Default.MyParameter; 
```

现在，从另一个项目中，我必须像这样使用反射：

```
// load assembly
 System.Reflection.Assembly ass = System.Reflection.Assembly.LoadFrom(@"M:\Programming\se2\se2\bin\Debug\se2.exe");
// load Settings2 class and default object
Type settingsType = ass.GetType("se2.Settings2");
System.Reflection.PropertyInfo defaultProperty = settingsType.GetProperty("Default");
object defaultObject = defaultProperty.GetValue(settingsType, null);
// invoke the MyParameter property from the default settings
System.Reflection.PropertyInfo parameterProperty = settingsType.GetProperty("MyParameter");
string parameterValue = (string)parameterProperty.GetValue(defaultObject, null); 
```

# php - 包含路径被 ZF 覆盖

> ID：15800922
> 
> 赞同：2
> 
> 时间：2013-04-04T01:10:39.293
> 
> 标签：php, zend-framework, ubuntu, include-path

我遇到了 PHP 和 Zend Framework 的这个小问题。

我使用它安装了 ZF `apt-get install libzend-framework-php`，它还安装了二进制文件`zf.sh`和`zend-framework.ini`in `/etc/php5/apache2/conf.d`. 我取消注释文件中的行：

```
[Zend]
include_path=${include_path} ":/usr/share/php/libzend-framework-php" 
```

问题是这完全覆盖了我的 include_path。通常，它包含`/usr/share/php:/usr/share/pear`.

我的 include_path 现在只有：（来自 phpinfo()）

```
include_path    :/usr/share/php/libzend-framework-php 
```

你可以在[这个链接](http://creationsmicroweb.com/?phpinfo)上看到它。

我想知道怎么了，因为它很烦人！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T14:52:31.310

将 Zend 包含路径更改为：

```
include_path=${include_path} ":/usr/share/php/libzend-framework-php:/usr/share/php:/usr/share/pear" 
```

# wcf - 带有 HTTPS 和 Windows Phone 8 的 WCF

> ID：15800930
> 
> 赞同：0
> 
> 时间：2013-04-04T01:12:00.450
> 
> 标签：wcf, azure, https, certificate, windows-phone-8

我正在开发一项从 Windows Phone 8 和/或 WinRT 设备上的客户端访问的小型服务，该服务需要适度的安全性。我的目标是创建一个在 Windows Azure 中运行的服务。

我的应用程序需要验证两件事的身份验证：1）客户端的真实性 2）客户端的用户凭据

第 1 步）我需要在一定程度上确定调用服务的应用程序实际上是我的客户端应用程序。

步骤 2) 用户需要在系统中有一个可以被认证的账户。我可以通过简单地在接口中创建一个 Login() 方法来实现身份验证（除非有更好的方法）。但是，为此，客户端和服务器之间的通信需要安全，因为我不希望我的用户名+密码组合未加密。

我目前的观点是，将其实现为 WCF 服务可能是可行的方法，因为我可能对在客户端移植到其他平台有进一步的兴趣，并且快速浏览表明这在一定程度上得到了支持。

但是，由于我是所有这些证书恶作剧的新手，我的问题是我是否可以使用自签名证书来保护我的连接？只有我的服务器和我的客户端需要能够验证真实性。此外，是否有任何关于在 WP8 + Windows Azure 案例中究竟是如何做到这一点的指针？

另一个交易是假设一个漂亮的黑客从客户端硬件打开我的程序，他可以获取证书并使用它来创建他自己的客户端以使用（他的）用户名/密码登录并执行我原来的客户端执行的操作吗？或者有没有办法在客户端防止这种情况？换句话说，我的服务器是否可以根据我签署的有效证书来确定客户端软件的真实性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:19:18.307

第 1 步几乎是不可能的。无论您在代码中使用什么证明方法，它都可以被另一个程序复制到代码中。

第 2 步不需要 WCF，尽管您可以将它与基本身份验证一起使用。使用支持基本身份验证的 WebAPI 公开 RESTful 服务同样容易。对于 WCF 或 WebAPI，保护通信的安全性相同 - 使用 SSL。

WCF 不喜欢自签名证书，并且将其配置为使用它们会消除一些安全性，具体取决于您的操作方式。鉴于来自受信任 CA 的 SSL 证书起价约为 10 美元，因此不获得证书将是一种虚假的经济。Azure webworkers 支持 SSL 证书，并且对 Azure 网站的支持即将到来，尽管没有确定日期。

最后，托管代码中的客户端证书可以相当容易地提取，因此您不能依赖它来识别客户端代码。

# ruby-on-rails - 在 Ruby on Rails 上为关联设置数据库

> ID：15800931
> 
> 赞同：1
> 
> 时间：2013-04-04T01:12:07.703
> 
> 标签：ruby-on-rails, migration, seeding

第一次在 ruby​​ on rails 上工作，我有一个包含以下 3 个模型的应用程序：

```
class User < ActiveRecord::Base
  attr_accessible :username, :name, :email, :password
  has_many :comments
  has_many :ideas, :inverse_of => :user
end

class Idea < ActiveRecord::Base
  attr_accessible :title, :description, :rank, :user_id, :status, :privacy, :created_on, :updated_on
  belongs_to :user, :inverse_of => :ideas
  has_many :comments
end

class Comment < ActiveRecord::Base
  attr_accessible :text, :rank, :user_id, :idea_id, :created_on
  belongs_to :user
  belongs_to :idea
end 
```

我有一个评论表，创建如下：

```
create_table :comments do |t|
    t.string :comment_id
    t.string :text
    t.string :rank
    t.timestamps
end 
```

我正在尝试为这些播种。我想了解的是如何将带有父想法和父用户的单个评论存储在数据库中，因为这些列一次只能包含一个父级。我是否应该创建一个包含comment_id、user_id 和idea_type 的单独表，其中每个父级的单个评论输入两次？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:41:53.237

听起来您正在尝试将评论实现为连接模型，该模型指示特定用户对创意的评论。如果是这样，您应该能够按如下方式完成：

```
class User < ActiveRecord::Base
  attr_accessible :username, :name, :email, :password
  has_many :comments
  has_many :commented_ideas, :class_name => 'Idea', :through => :comments, :source => :comment
end

class Idea < ActiveRecord::Base
  attr_accessible :title, :description, :rank, :user_id, :status, :privacy, :created_on, :updated_on
  belongs_to :user  # the user who created the Idea
  has_many :comments
  has_many :commented_users, :class_name => 'User', :through => :comments, :source => :user
end

class Comment < ActiveRecord::Base
  attr_accessible :text, :rank, :user_id, :idea_id, :created_on
  belongs_to :user
  belongs_to :idea
end

create_table :comments do |t|
  t.string :text
  t.string :rank
  t.integer :user_id
  t.integer :idea_id
  t.timestamps
end 
```

# c# - 一对一映射问题

> ID：15800935
> 
> 赞同：1
> 
> 时间：2013-04-04T01:12:18.073
> 
> 标签：c#, asp.net-mvc, ef-code-first, entity-framework-5

我的 SQL 理解相当基础，而且我来自 NHibernate 的世界，所以我对这个问题相当困惑......

我有两节课：

```
public class UserProfile
{
    public UserProfile() { }

    [Key]
    public int UserId { get; set; }
    public string UserName { get; set; }
    public SerialNumber Serial { get; set; }
    // Other properties
} 
```

和

```
public class SerialNumber
{
    public SerialNumber() 
    {
        // My code that creates a unique Code
    }

    [Key]
    public string Code { get; set; }
    public UserProfile User { get; set; }

    // Other Properties
} 
```

我有这个

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    // Other modelBuilder stuff

    modelBuilder.Entity<UserProfile>()
        .HasOptional(s => s.Serial)
        .WithRequired(u => u.User);
} 
```

运行后，`Add-Migration`我得到了这个：

```
public override void Up()
{
    DropForeignKey("dbo.UserProfile", "Serial_Code", "dbo.SerialNumbers");
    DropIndex("dbo.UserProfile", new[] { "Serial_Code" });
    RenameColumn(table: "dbo.SerialNumbers", name: "Serial_Code", newName: "User_UserId");
    AddForeignKey("dbo.SerialNumbers", "User_UserId", "dbo.UserProfile", "UserId");
    CreateIndex("dbo.SerialNumbers", "User_UserId");
}

public override void Down()
{
    // Inverse of above
} 
```

运行后`Update-Database`出现错误： `"Either the parameter @objname is ambiguous or the claimed @objtype (COLUMN) is wrong."`

我可以通过生成的代码`Add-Migration`判断出问题所在，因为我的 db 表甚至没有名为`"Serial_Code"`

我需要`Code`成为我`Key`的，因为 EntityFramework 没有选项可以强制将列设置为`Unique`除了使其成为键。

我如何使它`Serial`成为一个可选属性`UserProfile`并`User`在`SerialNumber`添加到时自动设置`UserProfile`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T01:55:34.513

默认情况下，在一对一关系中，Entity Framework 要求依赖项上的外键也是主键。这可能是因为 Entity Framework 仅在主键上设置唯一约束（或者更确切地说，唯一约束由于它是主键而存在）。在数据库级别上，一对一并没有映射到关系的两边，即两个表上都没有创建外键。当您考虑参照完整性如何工作时，这是有道理的：如果删除关系的一侧，则会导致另一侧的数据库不完整性，从而导致一种无限循环。

因此，外键被添加到依赖项中，在像您这里这样的一对零对一的情况下，它是所需导航属性的结尾：您的`SerialNumber`模型。这意味着要真正创建一对一而不是一对多，您的键`SerialNumber`需要是`User_UserId`（自动生成的外键列，因为您没有手动指定外键属性）。要以这种方式进行设置，您的模型将如下所示：

```
public class UserProfile
{
    [Key]
    public int UserId { get; set; }

    public SerialNumber Serial { get; set; }

    ...
}

public class SerialNumber
{
    [Key]
    [ForeignKey("User")]
    public int UserId { get; set; }

    public UserProfile User { get; set; }

    ...
} 
```

或者使用 Fluent API：

```
modelBuilder.Entity<SerialNumber>()
    .HasRequired(m => m.User)
    .WithOptional(m => m.Serial); 
```

*（您需要省略`[Key]`数据注释，以便 EF 可以制作外键，它们是表的主键。）*

但是，这使您对您的`Code`财产没有唯一的限制。你当然可以在你的表上手动设置这个约束，或者如果你不使用自动迁移，你可以改变你的迁移来创建约束：

```
CreateIndex("dbo.SerialNumbers", "Code", unique: true); 
```

这里的问题是实体框架不会为您处理唯一验证。因此，您需要在您的代码中手动维护完整性（即，尝试`SerialNumber`使用`Code`您将要保存的 查找 a，并且只有在您没有从查询中得到任何返回时才保存它）。

这有点痛苦，我知道，但就目前而言，这就是你所能做的。希望 EF 最终会在未来的版本中解决唯一性问题。

# html - 将绝对定位的 div 固定在图像下

> ID：15800937
> 
> 赞同：0
> 
> 时间：2013-04-04T01:12:49.130
> 
> 标签：html, css, position

我有一个图像和一个小容器，我想将它放在容器上，但它将这个“.innerimage”设置在图像下方。

**不建议使用 top:xx;** 因为在我的实际项目中，我有许多具有相同类的 div，我不能使用 top 或者它会搞砸。

```
<div id="page">

    <div class="image">
        <img src="http://upload.wikimedia.org/wikipedia/commons/8/85/Black_300.jpg">
            <div class="innerimage"></div>
    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:43:31.707

如果我很了解您的需求并且您不必[支持 IE7](http://caniuse.com/#feat=css-table)，也许您可​​以使用`display:table`and`display:table-caption`

我用这些 CSS 属性更新了 JSFiddle：

[http://jsfiddle.net/ZhdMj/1/](http://jsfiddle.net/ZhdMj/1/)

# java - 提取使用 AST 解析器实现的类的接口

> ID：15800942
> 
> 赞同：2
> 
> 时间：2013-04-04T01:13:18.457
> 
> 标签：java, eclipse-jdt, abstract-syntax-tree

我正在使用 AST 解析器编译项目源。我可以通过什么方式提取类层次结构信息，即它是实现任何接口还是从另一个类扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T05:53:35.107

您可以访问该`TypeDeclaration`节点并从中获取类型绑定。

```
ITypeBinding typeBind = typDec.resolveBinding(); 
```

然后您可以获得超类和实现的接口，如下所示：

```
public boolean visit(TypeDeclaration typeDeclaration) {

        ITypeBinding typeBind = typeDeclaration.resolveBinding();
        ITypeBinding superTypeBind = typeBind.getSuperclass();
        ITypeBinding[] interfaceBinds = typeBind.getInterfaces();      

        return true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T07:37:53.153

如果您有 IType 实例（类型），则可以在 ITypeHierarchy 中获取类层次结构，如下所示

```
ITypeHierarchy typeHierarchie = type.newTypeHierarchy(new NullProgressMonitor()); 
```

ITypeHierarchy 具有查询已实现接口的方法

```
typeHierarchie.getSuperInterfaces(type); 
```

以及扩展了哪些课程

```
typeHierarchie.getSuperclass(type); 
typeHierarchie.getAllSuperclasses(type); 
```

# ios - MVC - 视图知道控制器吗？

> ID：15800945
> 
> 赞同：3
> 
> 时间：2013-04-04T01:13:44.107
> 
> 标签：ios, cocoa-touch, cocoa, model-view-controller

我目前正在重构我的应用程序以确保它符合 MVC。我想拆分控制器（扩展 UIController 的 MyController）和视图（扩展 UIView 的 HomeView）我在 myController 中使用

```
self.view = [[HomeView alloc] init]; 
```

当我按下 UIButton 时，会在视图中调用一个方法，在这个方法中我想从控制器调用一个方法。

在我看来

```
[zenModeBtn addTarget:self action:@selector(touchZenMode:) forControlEvents:UIControlEventTouchDown]; 
```

...

```
- (void) touchZenMode:(id) sender {
   [myController playZenMode];
} 
```

但是在视图中引用控制器确实是一种不好的做法，不是吗？

**编辑 ：**

所以在我的 UIViewController 我做了这个：

```
- (id) init {
    HomeView* myHomeView = [[HomeView alloc] init];
    [myHomeView.arcadeModeBtn addTarget:self action:@selector(touchArcadeMode) forControlEvents:UIControlEventTouchUpInside];
    self.view = myHomeView;
    return self;
} 
```

那是对的吗 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T01:41:14.653

正如这里的一些答案所概述的，与您的控制器交谈的视图没有问题。例如，文本字段可以通过定义的委托方法通知其控制器。

但是，您的设计仍然存在严重缺陷。您的视图完全没有处理按钮按下本身的事务。您认为视图不应该知道其控制器的直觉是正确的。

您的**控制器**应该知道按钮以及如何对被点击做出反应。这就是为什么控制器有 button`IBOutlet`来告诉按钮例如更改其标题或启用状态的原因。它有按钮处理程序来响应 UI 事件。处理这个逻辑是控制器的工作。显示标题、灰显或将点击事件发送回控制器是视图的工作。

您应该放入视图中的唯一代码基本上是如何绘制自身。*控制器无法*处理的一切。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T09:13:26.090

Cocoa Touch 中使用的 MVC 模式的基本思想：

![可可版本的 MVC 作为复合设计模式](https://i.stack.imgur.com/J0Ap0.gif)

如此处所述：[模型-视图-控制器设计模式](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/CocoaDesignPatterns.html#//apple_ref/doc/uid/TP40002974-CH6-SW1)

您想要实现的是一种松散的，甚至可能是盲目的耦合形式。通过使用协议（用于委托机制），a`View`只知道有一个采用特定协议的对象，它可以与之“对话”。

举个`UITableView`例子。它不需要知道是否有某种类型`UIViewController`可以帮助它收集数据，而只需要知道有一个对象采用`UITableViewDatasourceDelegate`and/or `UITableViewDelegate`; 该对象可以是任何类型。

在您的编辑中，您使用目标-动作机制，这是实现松散耦合的另一种方式。您在运行时设置连接；你的视图不知道你的控制器。因此：正确，*除了@Mundi 关于您的`init`实施不完整*的评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:26:43.253

视图需要某种方式将事情传回控制器，向它询问下一步要做什么等问题。因此，视图了解控制器的某些信息是非常好的。

一些内置视图，如 UITextField，定义了它们用来告诉委托人正在发生的事情或要求它做某事的协议。您通常在控制器中实现协议。这样，视图对控制器的了解并不多，仅足以进行通信。这使您的视图更加通用和可重用。

您要避免的是让您的视图直接链接到您的*模型*。控制器的作用是在视图和模型之间进行调解。您应该能够在不接触模型的情况下完全更改视图的实现方式，反之亦然。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T01:27:07.650

您可以将该方法放在视图界面中的协议中：

```
@protocol MyViewDelegateProtocol <NSObject>
    -(void)myMethod;
@end 
```

*   您在视图中放置了一个名为 delegate 的 NSObject 类型的新属性。
*   您使您的视图控制器遵守该协议，并在它启动视图时将委托属性分配给 self。
*   您在视图控制器实现中实现 myMethod 。
*   现在您只需在需要时从您的视图中调用 [delegate myMethod] 即可。

# couchdb - 这个 geocouch 错误中的 not_found 是什么？

> ID：15800953
> 
> 赞同：0
> 
> 时间：2013-04-04T01:14:53.557
> 
> 标签：couchdb, couchbase, geo

我对 geocouch 有点陌生，并且基本上没有使用 erlang 的经验，目前我得到了我认为可能导致错误匹配错误的索引损坏，但我并不完全确定。此响应在服务器运行一段时间后返回，并且似乎随着时间的推移而增加频率。如果我清理空间索引，错误会消失几个小时。

我们目前正在运行 couchbase-server-community_x86_64_1.1.deb 并且 couchbase 服务器在被褥中显示其版本 1.0.2。

我们发送的查询如下所示：

```
'_design/blah/_spatial/customView?43.07960959232345743,-88.20843166111015421,43.08021240619384429,-88.20760633888984614' 
```

其中 customView 看起来像这样：

```
"customView": "function(doc) {if (doc.type && doc.type == \"Custom\") {emit({type: \"Point\", coordinates: [doc.loc[0], doc.loc[1]]}, doc);}};" 
```

并且自定义文档类型具有这种条目：

```
"loc": [
       42.873055,
       -73.767514
   ], 
```

我们得到的回应是这样的

```
ServerError: (500, ("{{badmatch,not_found},\n [{vtree,'-add_remove/5-fun-0-',3},\n  {lists,foldl,3},\n  {vtree,add_remove,5},\n  {couch_spatial_updater,'-write_changes/4-fun-2-',5},\n  {lists,zipwith,3},\n  {couch_spatial_updater,write_changes,4},\n  {couch_spatial_updater,update,2}]}", '{gen_server,call,[<0.12711.178>,{request_group,241518},infinity]}')) 
```

所以问题是我知道这是一个调用堆栈，但我不完全确定发生了什么，并希望有人可以通过提供一些关于这是什么错误的线索/上下文来提供帮助，即。这实际上是一个损坏的索引吗？或者这是我正在使用的 geocouch 版本中的一个已知错误？甚至什么样的动作会导致 not_found 错误？等等

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T21:27:34.010

您的查询 URL 看起来不对，它缺少“bbox=”，但这可能不是问题所在。

您使用的是非常旧的 GeoCouch 版本，它实际上是一个使用现在不受支持的 Couchbase 产品的版本。我建议您升级到最新版本的[Apache CouchDB](http://couchdb.apache.org/)以及最新版本的[GeoCouch](https://github.com/couchbase/geocouch/)。

如果您仍然看到相同的错误，请告诉我。

# authentication - 使用 WebAPI 进行 RESTFul 身份验证

> ID：15800954
> 
> 赞同：18
> 
> 时间：2013-04-04T01:15:04.143
> 
> 标签：authentication, asp.net-web-api, single-page-application

我有一个使用 WebAPI 构建的 Web 服务，它接受 JSON 请求并做出相应的响应。核心架构已构建，但没有任何身份验证/授权。

经过大量谷歌搜索和浏览示例项目后，我不知道从哪里开始。我发现了 2008 年和 2009 年的大量材料，但没有找到很多 WebAPI/单页应用程序的最新指南/工作流程。我认为工作流程应该如下：

1.  检查用户是否已登录：如何使用 javascript 完成此操作？我是否将 cookie 发送到我的 webAPI？如果是这样，我是否将该 cookie 作为请求正文中的参数发送？

2.  让用户登录/注册：这些数据是如何加密/解密的？当然，我不能通过网络发送密码……这就是 SSL 的用武之地吗？

3.  为他们提供对他们有权访问的内容的访问权限：我想我明白了 - 我可以根据每个请求在控制器中授权。

任何信息都会很棒。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T01:45:53.277

基本上，您需要基于令牌的身份验证或授权。如果您指的是 ASP.NET WebAPI，以下项目将是一个很好的起点： [http ://thinktecture.github.com/Thinktecture.IdentityModel.45/](http://thinktecture.github.com/Thinktecture.IdentityModel.45/)

即使您不使用 ASP.NET WebAPI，以下视频也很好地介绍了如何在 RESTful Web 服务上提供身份验证/授权：http: [//vimeo.com/43603474](http://vimeo.com/43603474)

要回答您的一些问题：

> 检查用户是否已登录：如何使用 javascript 完成此操作？我是否将 cookie 发送到我的 webAPI？如果是这样，我是否将该 cookie 作为请求正文中的参数发送？

您可以使用 cookie，但我通常使用标头来避免常见的 XSRF 攻击。每当从浏览器发送 http 请求时，都会自动包含 Cookie。

> 这是 SSL 的用武之地吗？

是的。如果您打算继续使用基于令牌的方法，您可以使用单独的服务器（身份服务器）为您进行身份验证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T02:45:12.857

JavaScript 客户端是独一无二的。您是否在同一个域中拥有 Web API 和提供 JavaScript 的页面？如果不是，则您有相同的来源政策限制。如果您拥有托管网页和 Web API 的相同 Web 应用程序，则可以使用表单 Authn。在这种情况下，您不需要自己从 JavaScript 发送包含身份验证票的 cookie。浏览器会为你做这件事，这就是 XSRF 问题的原因。您必须小心 JavaScript 发送最终用户不应该知道的凭据。如果 JavaScript 知道一些东西，任何聪明的最终用户都可以得到这些知识。OAuth 2.0 隐式授权可能是一个不错的选择。最终用户在颁发访问令牌的授权服务器中输入凭据（密码）。

# wordpress - Wordpress 永久链接，其中包含 Wordpress 站点外的文件和文件夹

> ID：15800956
> 
> 赞同：0
> 
> 时间：2013-04-04T01:15:20.143
> 
> 标签：wordpress

我有一个 wordpress 网站，也有我在 wordpress 之外创建的页面/文件/文件夹。现在，我的 URL 没有固定链接，如 site.com?p=123。我想将永久链接（漂亮的链接）作为 site.com/postname（我知道永久链接字符串是 /%postname%/）。我的网站上也有与 wordpress 网站无关的页面。

当我更改 wordpress 中的永久链接时，我所有的帖子都可以正常工作。但是，当我尝试访问诸如 site.com/file_name.php 或 site.com/folder_name/ 之类的外部 wordpress 页面/文件夹时，我得到 HTTP 404 not found。

有没有办法可以做到这一点，还是我坚持只有帖子 ID 永久链接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T02:09:51.893

启用 SEO 永久链接后打开 Wordpress .htaccess 文件，并在顶部添加以下行：

```
ErrorDocument 401 default 
```

让我知道这是否有效，或者您始终可以在 .htaccess 文件中明确允许这些特定文件/文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T02:32:11.743

永久链接的默认 WordPress`.htaccess`配置应处理存在于 WordPress 之外的文件系统上的文件。您可以在 WordPress 上的[使用永久链接](http://codex.wordpress.org/Using_Permalinks)文档中阅读有关使用永久链接的信息。

值得注意的是您应该包含的片段`.htaccess`（因此可能更新您的 .htaccess 文件以包含此内容）：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>
# END WordPress 
```

这些`RewriteCond`子句告诉 WordPress，如果当前 URL 直接指向文件或目录，那么 WordPress 将忽略它并让文件正常加载。

# python - 从 findall 到 dict 的列表

> ID：15800961
> 
> 赞同：0
> 
> 时间：2013-04-04T01:16:11.577
> 
> 标签：python, regex, list, dictionary

我有一些看起来像这样的数据：

```
<subject="execute_and_get_modifiers"\><command="send_key"\><normalkey="b"\><modifier="0"\> 
```

我有一个可以很好地找到项目的正则表达式.. 像这样

```
p = re.compile('<([\w]+)="([\w\d]+)"')
self.data =  dict(p.findall(request)) 
```

看起来像：

```
 {'modifier': '0', 'normalkey': 'b', 'command': 'send_key', 'subject': 'execute_and_get_modifiers'} 
```

这实际上是关键：值对。那么我该如何访问 self.data['modifier'] 呢？

我尝试在 self.data 中为 key, value 做：但我得到“ValueError: too many values to unpack” - 但它的两个项目每个 dict 项目不是吗？

现在放轻松-我知道我是个傻瓜，但不知道为什么..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:21:20.877

你的 for 语句应该是：

```
for key, value in self.data.items() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T02:52:59.707

更好的是：

```
for key, value in self.data.iteritems() 
```

当您迭代这些对时，您应该使用 iteritems() 而不是 items() 来节省内存。items() 将在内存中建立 (key, value) 对的列表，而 iteritems() 将返回键值对的视图，您可以在恒定的内存空间中对其进行迭代。

# postgresql - Postgres：如何“插入……如果不存在……”

> ID：15800962
> 
> 赞同：0
> 
> 时间：2013-04-04T01:16:17.600
> 
> 标签：postgresql, node-postgres

我有一个 postgres 表来跟踪几所不同学校的时间表时间段，我正在尝试编写一个函数（在 JavaScript 中使用 node-postgres 库），每个学校每天每个时间段插入 1 个新行为即将到来的一周。

谁能帮我弄清楚 WITH 命令能够（在一个查询中）检查表中是否已经存在特定的学校/日期/时间组合，如果不存在，则插入它？那有意义吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:26:14.203

听起来您想向数据库添加约束。

```
ALTER TABLE school_table 
ADD CONSTRAINT school_date_time_uniq 
UNIQUE (school_name, school_date, school_time); 
```

您有什么特别的原因要使用 with 子句吗？

# php - 嵌套视图内的 Laravel 嵌套视图

> ID：15800971
> 
> 赞同：2
> 
> 时间：2013-04-04T01:17:13.463
> 
> 标签：php, laravel

好的，所以我一直在环顾四周，找不到答案。但是，我需要在另一个视图中嵌套一个视图。

我有一个 $layout 正在使用我拥有的 default.layout 刀片文件。那么该布局文件包含一个部分：

```
@yield('content') 
```

所以在我的管理面板中，我有这样的东西：

```
$this->layout->nest('content', 'admin.items.index', $this->data); 
```

但是，在我的 index.blade.php 文件中，我有一个 @yield('form')。然后我在 admin/items 目录下有一个 form.blade.php 文件。

```
@section('form')
FORM HERE
@endsection 
```

是的，嵌套表单不是必需的，但它与我正在做的事情有关。那么如何将该视图嵌套在嵌套在内容区域内的索引视图中呢？

我尝试了这可能是一个巨大的失败，但它不会工作：

```
$content = $this->layout->nest('content', 'admin.items.index', $this->data);
$content->nest('form', 'admin.items.form'); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T01:29:39.147

试试这个：

```
$this->layout->content = View::make('admin.items.index')
                             ->with('data', $this->data)
                             ->nest('form', 'admin.items.form'); 
```

现在您可以通过变量 $data 调用 $this->data 中的任何内容，它应该可以很好地加载表单。

# java - 如何在 Java EE 中检查用户是否已登录

> ID：15800972
> 
> 赞同：1
> 
> 时间：2013-04-04T01:17:17.387
> 
> 标签：java, struts2

我使用 Struts2 框架。在 jsp 中，我在我的项目中显示了一个登录框，当用户单击登录按钮时，我设置了一个名为“loggedin”的 cookie，并在 Action 类中将其值设置为“true”。

然后返回“成功”将再次加载此登录页面。

在登录页面：

```
<body>
<%
Cookie cookie[] = request.getCookies();
for( c : cookie )
{
 if( c.getName().equals("loggedin") )
 {
  if( !c.getValue().equals("true") )
  {

%>
//show login form here.

<%

  }//end inner if

  else //if cookie "loggedin" value is "true"
  {

%>

//show username/profile picture/logout button here

<%
  }//end else
 }//end outer if
}/end for loop
%>
</body> 
```

我有问题。当我单击登录表单中的登录按钮时，会设置一个 cookie 并重新加载页面。但是，在我手动重新加载页面之前，仍然显示登录表单，而不是用户名/个人资料图片。

1.  我该如何解决这个问题？
2.  我认为这不是检查是否登录的正确方法。有人可以告诉我如何以另一种方式检查吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T04:25:41.590

请 ！请 ！不要使用小脚本。它们很难维护，每个开发人员都讨厌它们。

有很多方法可以跟踪会话。

*   使用 cookie
*   网址重写
*   隐藏参数

这些在网络上都有很好的[记录](http://www.apl.jhu.edu/~hall/java/Servlet-Tutorial/Servlet-Tutorial-Session-Tracking.html)。生成会话的最快方法是执行`HttpSession session = request.getSession(true);`. 创建此对象后，您可以继续将会话信息附加到该对象。

看一看[JSTL 入门和关于](http://www.tutorialspoint.com/jsp/jsp_standard_tag_library.htm)[为什么 scriptlet 不好](https://www.coderanch.com/how-to/java/WhyNotUseScriptlets)的咆哮。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T05:20:42.887

永远不推荐在 jsp 中使用 scriptlet。为什么不使用 struts 标签或 JSTL 标签。使用 session 在每次成功登录时设置会话属性，并检查会话和特定属性以检查用户登录。像：

```
//on successfull login...
Session session=request.getSession(true);
session.setAttribute("id",id); //here in place of id you can use something related to user, that can uniquely identify to each user.

// now to check for user logged in or not

Session session=request.getSession(false);
// by providing false value it will try to access a session already available, but it won't create a new session.
//now you can check like this..
if(session!=null)
 {if(((String)session.getAttribute("id")).equals(id))
   {
    // do your stuffs here.........
    }

 else
  {
  // you can send the control to login page or to somewhere else as your requirement.
  }

    }

else{

// send the control to login page because session object is null...
} 
```

还有一件最重要的事情，不要在你的 jsp 中编写所有这些逻辑。Jsp 应该只放置视图逻辑。在 struts 中，将所有业务/主要逻辑放在 Action 类中。

# forms - Codeigniter form_open_multipart() 显示空白

> ID：15800973
> 
> 赞同：0
> 
> 时间：2013-04-04T01:17:42.303
> 
> 标签：forms, file, codeigniter, upload

一直在尝试 codeigniter 并想使用上传类创建一个非常简单的单个文件上传。但是，当我尝试使用 form_open_multipart 创建表单时，我总是得到一个空白页。我一直在环顾四周，但我似乎无法找到如何使这项工作。

HTML uploadPage.php

```
<body>

    <?php echo form_open_multipart('upload/theUpload');?>
    <input type="file" name="userfile">
    <input type="submit" name="submit" value="Upload File">
    </form>

</body> 
```

控制器上传.php

```
<? if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class upload extends CI_Controller{

    function index(){
        $this->load->view("uploadPage");

    }

    function theUpload(){

    }       

} 
```

# spring - 结果行：HibernateTemplate Find() 中的 null

> ID：15800974
> 
> 赞同：3
> 
> 时间：2013-04-04T01:17:50.187
> 
> 标签：spring, hibernate

以下行返回空值：

```
List accountList = hibernateTemplate.find("from Accounts a where a.userId=?",userId); 
```

我在控制台中得到以下信息：

> 2013-04-03 21:09:48 调试加载器：1197 - 结果行：空
> 
> 2013-04-03 21:09:48 调试加载器：1197 - 结果行：空

这是我的实体类：

```
@Repository
@Entity
@Table(name = "ACCOUNTS")
public class Accounts {

    @Column(name="ACCOUNT_ID")
    @Id
    @GeneratedValue
    private int accountId;
    @Column(name="ACCOUNT_NUMBER")
    private String accountNumber;
    @Column(name="ACCOUNT_TYPE_CODE")
    private String accountTypeCode;
    @Column(name="USER_ID")
    private String userId;
    @Column(name="ACCOUNT_NAME")
    private String accountName;
    @Column(name="DATE_OPENED")
    private Date dateOpened;
    @Column(name="DATE_CLOSED")
    private Date dateClosed;
    @Column(name="CURRENT_BALANCE")
    private double currentBalance;
    @Column(name="OTHER_ACCOUNT_DETAILS")
    private String otherAccountDetails;
    @Column(name="ADD_TS")
    private Date addTimestamp;
    @Column(name="ADD_USR")
    private String addUser;
    @Column(name="UPDT_TS")
    private Date updateTimestamp;
    @Column(name="UPDT_USR")
    private String updateUser;

    @ManyToOne

    private Customer customer; 
```

谁能帮我解决这个问题？我真的很感激。

* * *

这是 Hibernate 生成的查询

Hibernate: select accounts0_.ACCOUNT_ID as ACCOUNT1_23_, accounts0_.ACCOUNT_NAME as ACCOUNT2_23_, accounts0_.ACCOUNT_NUMBER as ACCOUNT3_23_, accounts0_.ACCOUNT_TYPE_CODE as ACCOUNT4_23_, accounts0_.ADD_TS as ADD5_23_, accounts0_.ADD_USR as ADD6_23_, accounts0_.CURRENT_BALANCE as CURRENT7_23_, accounts0_.customer_CUSTOMER_ID as customer14_23_ ，account0_.DATE_CLOSED 作为 DATE8_23_，accounts0_.DATE_OPENED 作为 DATE9_23_，accounts0_.OTHER_ACCOUNT_DETAILS 作为 OTHER10_23_，accounts0_.UPDT_TS 作为 UPDT11_23_，accounts0_.UPDT_USR 作为 UPDT12_23_，account0_.USER_ID 作为 USER13_23_ 从 ACCOUNT_ID=？

查询有问题吗？或域配置？

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T12:24:27.323

我有点不明白为什么要设置 USER_ID String(varchar) 类型的列，但是关于你的情况，你可以这样写：

```
hibernateTemplate.find("from Accounts a where a.userId='" + userId + "'"); 
```

它会很好用，也许对你有帮助:)

# php - session_unset 和 onclick

> ID：15800975
> 
> 赞同：0
> 
> 时间：2013-04-04T01:18:11.767
> 
> 标签：php, forms, session

我正在尝试清除已使用 PHP 会话填充的表单。

```
 Your name: <input type="text" name="name" 
       value="<?php echo($_SESSION['username'])?>" >
   Your email address: <input type="text" name="email" 
       value="<?php echo($_SESSION['email'])?>">
   <br>
       <textarea name="story" cols="60" rows="10">
   <?php echo($_SESSION['story']); ?>
       </textarea> 
   <br>
   <input type="submit" value="Submit"/><input type="reset" value="Reset"> 
```

问题是当我点击重置按钮时，表单并没有清除。

我想我需要使用 session_unset 命令，但无论我把它放在哪里，表格都会在按下重置按钮之前被清除。

如何结合 session_unset 和重置按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T01:24:21.247

你可以通过两种方式做到这一点。您可以开始给两个提交按钮一个名称，然后制作一个 PHP 脚本，通过

`<?php if(isset($_POST['reset']){unset($_SESSION['username'],$_SESSION['email']);} ?>`

然后当然将 Value 更改为`<?=$_SESSION['username'];?>`and `<?=$_SESSION['email'];?>`- 因为如果两个会话包含任何内容，它只会显示 value。

否则，您可以使用 JQuery 来完成。

**编辑：**

^ 你当然也应该取消设置`$_SESSION['story']`（一开始没看到）

**编辑2：**

```
$(document).ready(function(e) {
    $("form input[type=reset]").click(function(e) {
        $("form input[name=name]").attr("value","");
        $("form input[name=email]").attr("value","");
        $("form textarea[name=story]").attr("value","");
        return false;
    });
}); 
```

或者，如果您希望它重置基于文本的“任何内容”：

```
$(document).ready(function(e) {
    $("form input[type=reset]").click(function(e) {
        $("form input[type=text], form input[type=email], form input[type=password], form textarea").attr("value","");
        return false;
    });
}); 
```

^ 如果您愿意，请添加更多选项 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T01:24:11.620

我认为“重置”按钮会将表单重置为从服务器接收到的方式。所以这可能就是它不起作用的原因。它与数据一起接收，因此按钮恢复到其原始状态。不过我可能是错的，以前没有尝试过。

顺便说一句，要取消设置 $_SESSION，您可以这样做

```
unset($_SESSION['specific']); 
```

或者你可以摧毁整个事情。

```
session_destroy(); 
```

# php - 单选按钮选择未在 MYSQL 中发布

> ID：15800980
> 
> 赞同：1
> 
> 时间：2013-04-04T01:18:44.640
> 
> 标签：php, html, mysql

![在此处输入图像描述](https://i.stack.imgur.com/qUdR9.jpg)我正在使用一些 html 和 php 将一些数据发布到 mysql 数据库中。我在发布广播时遇到了一些困难。我想我搞砸了我在我的 php 和数据库中声明它的方式。我已将收音机定义为 tinyint。这是我的php

```
$value = $_POST['name'];
$value2 = $_POST['email'];
$value3 = $_POST['address'];
$value4 = $_POST['city'];
$value5 = $_POST['state'];
$value6 = $_POST['zip'];
$value7 = $_POST['primary'];

$sql = "INSERT INTO demo (name, email, address, city, state, zip, primary) VALUES ('$value', '$value2', '$value3', '$value4', '$value5', '$value6', '$value7')"; 
```

html

```
<div id="options">
        <div class="opt1"><input type="radio" name="primary" value="Color" /></div>
        <div class="opt2"><input type="radio" name="primary" value="Dry" /></div>
        <div class="opt3"><input type="radio" name="primary" value="Damaged" /></div>
        <div class="opt4"><input type="radio" name="primary" value="Thinning" /></div>
    </div> 
```

我有其他表单元素作为文本字段，但它们正在运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T01:26:42.067

您的问题（我相信）是由使用`intval()`.

您传递的值是一个字符串 - 颜色、干燥、损坏或变薄。

如果您想将整数传递给`$value7`- 将 html 中的单选按钮的值更改为所需的结果。

例如： `<div class="opt1"><input type="radio" name="primary" value="1" /></div>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T02:13:40.113

单选按钮和复选框作为数组传递给帖子。您需要更改所有单选按钮的名称。`<input type="radio" name="primary[]" value="Color" />`干燥、损坏和变薄也是如此。而且在你的 PHP 中： $value7 = $_POST['primary'][0];

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T01:23:45.507

你是如何定义你的数据库表的？如果您将其存储为整数，那么您应该传入值而不是文本。如果您要保存单选按钮的字符串值，那么您所做的可能不起作用，

[http://www.c-sharpcorner.com/UploadFile/051e29/insert-value-from-radio-button-in-mysql-in-php/](http://www.c-sharpcorner.com/UploadFile/051e29/insert-value-from-radio-button-in-mysql-in-php/)

看看这篇文章，希望这对你有用。

# android - 试图让一个按钮和edittext不出现在Android应用程序中

> ID：15800981
> 
> 赞同：0
> 
> 时间：2013-04-04T01:18:45.157
> 
> 标签：android, google-maps, android-edittext, android-button

我有一个使用 Google 地图的 Android 应用程序，如果 GPS 连接到 Android 设备，我有一个我不想显示的 Button 和 EditText。On Create 方法的代码如下。

如果 isGPS 为真，按钮和标签仍会显示。当isGPS为真时，我真的希望按钮和edittext不出现。任何帮助，将不胜感激。

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    LocationManager lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);

    final boolean isGPS = lm.isProviderEnabled(LocationManager.GPS_PROVIDER);
    setContentView(R.layout.activity_map_view_wogps);

    showCurrentLocationOnMap(); 

    // Getting reference to btn_find of the layout activity_main
    Button btn_find = (Button) findViewById(R.id.btn_find);
    final EditText etLocation = (EditText) findViewById(R.id.et_location);
    if (isGPS){
        btn_find.setVisibility(View.GONE);
        etLocation.setVisibility(View.GONE);
    }
    // Defining button click event listener for the find button
    OnClickListener findClickListener = new OnClickListener() {
        @Override
        public void onClick(View v) {

            // Getting user input location
            String location = etLocation.getText().toString();

            if(location!=null && !location.equals("")){
                AsyncTask<String, Void, List<Address>> execute = new GeocoderTask().execute(location);
            }
        }
    };

    // Setting button click event listener for the find button
    btn_find.setOnClickListener(findClickListener);

    try {
        showSheltersAndFuelStops();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T01:23:59.447

你需要否定isGPS：

```
if(!isGPS) {
  // This gets run ig isGPS is false
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T01:27:07.167

您的 if 语句正在检查 isGPS 是否为真，然后将按钮设置为不可见（如果是）。

通过它的声音，您希望仅当 isGPS 为 false 时才将按钮设置为不可见。

你需要`if (!isGPS)`而不是`(isGPS)`

# tokyo-cabinet - 京都内阁 HashDB 插入不是 O(1)

> ID：15800982
> 
> 赞同：2
> 
> 时间：2013-04-04T01:18:53.210
> 
> 标签：tokyo-cabinet, kyotocabinet

我正在试验京都内阁 HashDB。我的数据库将增长到 110 TB。键是 20 字节，值是 128 KB。我正在尝试插入大约 5 亿条记录。这是迄今为止我得到的最好的表现：

时间以秒为单位。'n' 是输入的 10000 条记录的数量。例如，第 10000 条记录需要 1 秒。第 5 条 10000 条记录耗时 5 秒，以此类推。如您所见，在输入大约 200 万条记录后性能开始下降。我创建了存储桶编号设置为 70 亿的数据库，其他一切都是默认设置。我正在使用 C/C++ 库，并将内存映射容量设置为 30 GB（我有 32 GB RAM）`db.tune_map(30LL << 30);`。

```
Inserted 10000 records. n: 1\. Time: 1
Inserted 10000 records. n: 2\. Time: 1
Inserted 10000 records. n: 3\. Time: 1
Inserted 10000 records. n: 4\. Time: 1
Inserted 10000 records. n: 5\. Time: 4
Inserted 10000 records. n: 6\. Time: 4
Inserted 10000 records. n: 7\. Time: 4
Inserted 10000 records. n: 8\. Time: 4
Inserted 10000 records. n: 9\. Time: 4
Inserted 10000 records. n: 10\. Time: 4
Inserted 10000 records. n: 11\. Time: 4
Inserted 10000 records. n: 12\. Time: 4
Inserted 10000 records. n: 13\. Time: 4
Inserted 10000 records. n: 14\. Time: 4
Inserted 10000 records. n: 15\. Time: 4
Inserted 10000 records. n: 16\. Time: 4
Inserted 10000 records. n: 17\. Time: 4
Inserted 10000 records. n: 18\. Time: 4
Inserted 10000 records. n: 19\. Time: 7
Inserted 10000 records. n: 20\. Time: 4
Inserted 10000 records. n: 21\. Time: 4
Inserted 10000 records. n: 22\. Time: 4
Inserted 10000 records. n: 23\. Time: 5
Inserted 10000 records. n: 24\. Time: 4
Inserted 10000 records. n: 25\. Time: 4
Inserted 10000 records. n: 26\. Time: 4
Inserted 10000 records. n: 27\. Time: 4
Inserted 10000 records. n: 28\. Time: 4
Inserted 10000 records. n: 29\. Time: 5
Inserted 10000 records. n: 30\. Time: 4
Inserted 10000 records. n: 31\. Time: 4
Inserted 10000 records. n: 32\. Time: 4
Inserted 10000 records. n: 33\. Time: 4
Inserted 10000 records. n: 34\. Time: 4
Inserted 10000 records. n: 35\. Time: 4
Inserted 10000 records. n: 36\. Time: 4
Inserted 10000 records. n: 37\. Time: 5
Inserted 10000 records. n: 38\. Time: 4
Inserted 10000 records. n: 39\. Time: 4
Inserted 10000 records. n: 40\. Time: 4
Inserted 10000 records. n: 41\. Time: 4
Inserted 10000 records. n: 42\. Time: 4
Inserted 10000 records. n: 43\. Time: 4
Inserted 10000 records. n: 44\. Time: 4
Inserted 10000 records. n: 45\. Time: 4
Inserted 10000 records. n: 46\. Time: 4
Inserted 10000 records. n: 47\. Time: 4
Inserted 10000 records. n: 48\. Time: 5
Inserted 10000 records. n: 49\. Time: 4
Inserted 10000 records. n: 50\. Time: 4
Inserted 10000 records. n: 51\. Time: 5
Inserted 10000 records. n: 52\. Time: 4
Inserted 10000 records. n: 53\. Time: 5
Inserted 10000 records. n: 54\. Time: 5
Inserted 10000 records. n: 55\. Time: 4
Inserted 10000 records. n: 56\. Time: 5
Inserted 10000 records. n: 57\. Time: 5
Inserted 10000 records. n: 58\. Time: 5
Inserted 10000 records. n: 59\. Time: 5
Inserted 10000 records. n: 60\. Time: 5
Inserted 10000 records. n: 61\. Time: 4
Inserted 10000 records. n: 62\. Time: 5
Inserted 10000 records. n: 63\. Time: 5
Inserted 10000 records. n: 64\. Time: 4
Inserted 10000 records. n: 65\. Time: 6
Inserted 10000 records. n: 66\. Time: 4
Inserted 10000 records. n: 67\. Time: 4
Inserted 10000 records. n: 68\. Time: 7
Inserted 10000 records. n: 69\. Time: 6
Inserted 10000 records. n: 70\. Time: 7
Inserted 10000 records. n: 71\. Time: 7
Inserted 10000 records. n: 72\. Time: 6
Inserted 10000 records. n: 73\. Time: 10
Inserted 10000 records. n: 74\. Time: 7
Inserted 10000 records. n: 75\. Time: 10
Inserted 10000 records. n: 76\. Time: 9
Inserted 10000 records. n: 77\. Time: 8
Inserted 10000 records. n: 78\. Time: 10
Inserted 10000 records. n: 79\. Time: 8
Inserted 10000 records. n: 80\. Time: 6
Inserted 10000 records. n: 81\. Time: 8
Inserted 10000 records. n: 82\. Time: 8
Inserted 10000 records. n: 83\. Time: 9
Inserted 10000 records. n: 84\. Time: 9
Inserted 10000 records. n: 85\. Time: 9
Inserted 10000 records. n: 86\. Time: 9
Inserted 10000 records. n: 87\. Time: 7
Inserted 10000 records. n: 88\. Time: 10
Inserted 10000 records. n: 89\. Time: 8
Inserted 10000 records. n: 90\. Time: 10
Inserted 10000 records. n: 91\. Time: 10
Inserted 10000 records. n: 92\. Time: 10
Inserted 10000 records. n: 93\. Time: 10
Inserted 10000 records. n: 94\. Time: 10
Inserted 10000 records. n: 95\. Time: 10
Inserted 10000 records. n: 96\. Time: 11
Inserted 10000 records. n: 97\. Time: 9
Inserted 10000 records. n: 98\. Time: 10
Inserted 10000 records. n: 99\. Time: 10
Inserted 10000 records. n: 100\. Time: 11
Inserted 10000 records. n: 101\. Time: 10
Inserted 10000 records. n: 102\. Time: 11
Inserted 10000 records. n: 103\. Time: 11
Inserted 10000 records. n: 104\. Time: 11
Inserted 10000 records. n: 105\. Time: 12
Inserted 10000 records. n: 106\. Time: 11
Inserted 10000 records. n: 107\. Time: 12
Inserted 10000 records. n: 108\. Time: 12
Inserted 10000 records. n: 109\. Time: 10
Inserted 10000 records. n: 110\. Time: 11
Inserted 10000 records. n: 111\. Time: 10
Inserted 10000 records. n: 112\. Time: 10
Inserted 10000 records. n: 113\. Time: 11
Inserted 10000 records. n: 114\. Time: 10
Inserted 10000 records. n: 115\. Time: 11
Inserted 10000 records. n: 116\. Time: 10
Inserted 10000 records. n: 117\. Time: 10
Inserted 10000 records. n: 118\. Time: 10
Inserted 10000 records. n: 119\. Time: 10
Inserted 10000 records. n: 120\. Time: 11
Inserted 10000 records. n: 121\. Time: 10
Inserted 10000 records. n: 122\. Time: 11
Inserted 10000 records. n: 123\. Time: 9
Inserted 10000 records. n: 124\. Time: 11
Inserted 10000 records. n: 125\. Time: 9
Inserted 10000 records. n: 126\. Time: 11
Inserted 10000 records. n: 127\. Time: 10
Inserted 10000 records. n: 128\. Time: 10
Inserted 10000 records. n: 129\. Time: 12
Inserted 10000 records. n: 130\. Time: 10
Inserted 10000 records. n: 131\. Time: 10
Inserted 10000 records. n: 132\. Time: 10
Inserted 10000 records. n: 133\. Time: 10
Inserted 10000 records. n: 134\. Time: 16
Inserted 10000 records. n: 135\. Time: 10
Inserted 10000 records. n: 136\. Time: 10
Inserted 10000 records. n: 137\. Time: 10
Inserted 10000 records. n: 138\. Time: 10
Inserted 10000 records. n: 139\. Time: 9
Inserted 10000 records. n: 140\. Time: 10
Inserted 10000 records. n: 141\. Time: 10
Inserted 10000 records. n: 142\. Time: 10
Inserted 10000 records. n: 143\. Time: 10
Inserted 10000 records. n: 144\. Time: 11
Inserted 10000 records. n: 145\. Time: 10
Inserted 10000 records. n: 146\. Time: 11
Inserted 10000 records. n: 147\. Time: 9
Inserted 10000 records. n: 148\. Time: 10
Inserted 10000 records. n: 149\. Time: 9
Inserted 10000 records. n: 150\. Time: 10
Inserted 10000 records. n: 151\. Time: 20
Inserted 10000 records. n: 152\. Time: 18
Inserted 10000 records. n: 153\. Time: 33
Inserted 10000 records. n: 154\. Time: 25
Inserted 10000 records. n: 155\. Time: 30
Inserted 10000 records. n: 156\. Time: 18
Inserted 10000 records. n: 157\. Time: 12
Inserted 10000 records. n: 158\. Time: 13
Inserted 10000 records. n: 159\. Time: 14
Inserted 10000 records. n: 160\. Time: 10
Inserted 10000 records. n: 161\. Time: 9
Inserted 10000 records. n: 162\. Time: 12
Inserted 10000 records. n: 163\. Time: 11
Inserted 10000 records. n: 164\. Time: 11
Inserted 10000 records. n: 165\. Time: 11
Inserted 10000 records. n: 166\. Time: 11
Inserted 10000 records. n: 167\. Time: 12
Inserted 10000 records. n: 168\. Time: 10
Inserted 10000 records. n: 169\. Time: 11
Inserted 10000 records. n: 170\. Time: 12
Inserted 10000 records. n: 171\. Time: 11
Inserted 10000 records. n: 172\. Time: 10
Inserted 10000 records. n: 173\. Time: 11
Inserted 10000 records. n: 174\. Time: 11
Inserted 10000 records. n: 175\. Time: 10
Inserted 10000 records. n: 176\. Time: 11
Inserted 10000 records. n: 177\. Time: 11
Inserted 10000 records. n: 178\. Time: 10
Inserted 10000 records. n: 179\. Time: 11
Inserted 10000 records. n: 180\. Time: 11
Inserted 10000 records. n: 181\. Time: 11
Inserted 10000 records. n: 182\. Time: 10
Inserted 10000 records. n: 183\. Time: 11
Inserted 10000 records. n: 184\. Time: 11
Inserted 10000 records. n: 185\. Time: 11
Inserted 10000 records. n: 186\. Time: 11
Inserted 10000 records. n: 187\. Time: 11
Inserted 10000 records. n: 188\. Time: 11
Inserted 10000 records. n: 189\. Time: 11
Inserted 10000 records. n: 190\. Time: 11
Inserted 10000 records. n: 191\. Time: 11
Inserted 10000 records. n: 192\. Time: 13
Inserted 10000 records. n: 193\. Time: 13
Inserted 10000 records. n: 194\. Time: 13
Inserted 10000 records. n: 195\. Time: 12
Inserted 10000 records. n: 196\. Time: 13
Inserted 10000 records. n: 197\. Time: 11
Inserted 10000 records. n: 198\. Time: 11
Inserted 10000 records. n: 199\. Time: 12
Inserted 10000 records. n: 200\. Time: 11
Inserted 10000 records. n: 201\. Time: 11
Inserted 10000 records. n: 202\. Time: 11
Inserted 10000 records. n: 203\. Time: 11
Inserted 10000 records. n: 204\. Time: 11
Inserted 10000 records. n: 205\. Time: 12
Inserted 10000 records. n: 206\. Time: 11
Inserted 10000 records. n: 207\. Time: 10
Inserted 10000 records. n: 208\. Time: 10
Inserted 10000 records. n: 209\. Time: 11
Inserted 10000 records. n: 210\. Time: 10
Inserted 10000 records. n: 211\. Time: 10
Inserted 10000 records. n: 212\. Time: 11
Inserted 10000 records. n: 213\. Time: 11
Inserted 10000 records. n: 214\. Time: 10
Inserted 10000 records. n: 215\. Time: 11
Inserted 10000 records. n: 216\. Time: 11
Inserted 10000 records. n: 217\. Time: 12
Inserted 10000 records. n: 218\. Time: 12
Inserted 10000 records. n: 219\. Time: 12
Inserted 10000 records. n: 220\. Time: 11
Inserted 10000 records. n: 221\. Time: 12
Inserted 10000 records. n: 222\. Time: 10
Inserted 10000 records. n: 223\. Time: 11
Inserted 10000 records. n: 224\. Time: 11
Inserted 10000 records. n: 225\. Time: 11
Inserted 10000 records. n: 226\. Time: 11
Inserted 10000 records. n: 227\. Time: 11
Inserted 10000 records. n: 228\. Time: 11
Inserted 10000 records. n: 229\. Time: 11
Inserted 10000 records. n: 230\. Time: 11
Inserted 10000 records. n: 231\. Time: 10
Inserted 10000 records. n: 232\. Time: 11
Inserted 10000 records. n: 233\. Time: 10
Inserted 10000 records. n: 234\. Time: 11
Inserted 10000 records. n: 235\. Time: 11
Inserted 10000 records. n: 236\. Time: 11
Inserted 10000 records. n: 237\. Time: 11
Inserted 10000 records. n: 238\. Time: 10
Inserted 10000 records. n: 239\. Time: 11
Inserted 10000 records. n: 240\. Time: 11
Inserted 10000 records. n: 241\. Time: 11
Inserted 10000 records. n: 242\. Time: 11
Inserted 10000 records. n: 243\. Time: 11
Inserted 10000 records. n: 244\. Time: 11
Inserted 10000 records. n: 245\. Time: 11
Inserted 10000 records. n: 246\. Time: 12
Inserted 10000 records. n: 247\. Time: 11
Inserted 10000 records. n: 248\. Time: 12
Inserted 10000 records. n: 249\. Time: 12
Inserted 10000 records. n: 250\. Time: 11
Inserted 10000 records. n: 251\. Time: 12
Inserted 10000 records. n: 252\. Time: 12
Inserted 10000 records. n: 253\. Time: 13
Inserted 10000 records. n: 254\. Time: 10
Inserted 10000 records. n: 255\. Time: 12
Inserted 10000 records. n: 256\. Time: 12
Inserted 10000 records. n: 257\. Time: 13
Inserted 10000 records. n: 258\. Time: 11
Inserted 10000 records. n: 259\. Time: 10
Inserted 10000 records. n: 260\. Time: 12
Inserted 10000 records. n: 261\. Time: 11
Inserted 10000 records. n: 262\. Time: 11
Inserted 10000 records. n: 263\. Time: 12
Inserted 10000 records. n: 264\. Time: 10
Inserted 10000 records. n: 265\. Time: 10
Inserted 10000 records. n: 266\. Time: 11
Inserted 10000 records. n: 267\. Time: 10
Inserted 10000 records. n: 268\. Time: 11
Inserted 10000 records. n: 269\. Time: 12
Inserted 10000 records. n: 270\. Time: 12
Inserted 10000 records. n: 271\. Time: 11
Inserted 10000 records. n: 272\. Time: 11
Inserted 10000 records. n: 273\. Time: 10
Inserted 10000 records. n: 274\. Time: 12
Inserted 10000 records. n: 275\. Time: 9
Inserted 10000 records. n: 276\. Time: 12
Inserted 10000 records. n: 277\. Time: 11
Inserted 10000 records. n: 278\. Time: 11
Inserted 10000 records. n: 279\. Time: 11
Inserted 10000 records. n: 280\. Time: 10
Inserted 10000 records. n: 281\. Time: 11
Inserted 10000 records. n: 282\. Time: 11
Inserted 10000 records. n: 283\. Time: 10
Inserted 10000 records. n: 284\. Time: 10
Inserted 10000 records. n: 285\. Time: 11
Inserted 10000 records. n: 286\. Time: 10
Inserted 10000 records. n: 287\. Time: 10
Inserted 10000 records. n: 288\. Time: 11
Inserted 10000 records. n: 289\. Time: 10
Inserted 10000 records. n: 290\. Time: 9
Inserted 10000 records. n: 291\. Time: 16
Inserted 10000 records. n: 292\. Time: 10
Inserted 10000 records. n: 293\. Time: 9
Inserted 10000 records. n: 294\. Time: 11
Inserted 10000 records. n: 295\. Time: 9
Inserted 10000 records. n: 296\. Time: 9
Inserted 10000 records. n: 297\. Time: 11
Inserted 10000 records. n: 298\. Time: 39
Inserted 10000 records. n: 299\. Time: 52
Inserted 10000 records. n: 300\. Time: 54
Inserted 10000 records. n: 301\. Time: 42
Inserted 10000 records. n: 302\. Time: 42
Inserted 10000 records. n: 303\. Time: 11
Inserted 10000 records. n: 304\. Time: 9
Inserted 10000 records. n: 305\. Time: 7
Inserted 10000 records. n: 306\. Time: 8
Inserted 10000 records. n: 307\. Time: 10
Inserted 10000 records. n: 308\. Time: 10
Inserted 10000 records. n: 309\. Time: 10
Inserted 10000 records. n: 310\. Time: 10
Inserted 10000 records. n: 311\. Time: 9
Inserted 10000 records. n: 312\. Time: 11
Inserted 10000 records. n: 313\. Time: 11
Inserted 10000 records. n: 314\. Time: 13
Inserted 10000 records. n: 315\. Time: 13
Inserted 10000 records. n: 316\. Time: 12
Inserted 10000 records. n: 317\. Time: 11
Inserted 10000 records. n: 318\. Time: 10
Inserted 10000 records. n: 319\. Time: 9
Inserted 10000 records. n: 320\. Time: 12
Inserted 10000 records. n: 321\. Time: 11
Inserted 10000 records. n: 322\. Time: 12
Inserted 10000 records. n: 323\. Time: 10
Inserted 10000 records. n: 324\. Time: 11
Inserted 10000 records. n: 325\. Time: 11
Inserted 10000 records. n: 326\. Time: 13
Inserted 10000 records. n: 327\. Time: 13
Inserted 10000 records. n: 328\. Time: 12
Inserted 10000 records. n: 329\. Time: 12
Inserted 10000 records. n: 330\. Time: 10
Inserted 10000 records. n: 331\. Time: 11
Inserted 10000 records. n: 332\. Time: 10
Inserted 10000 records. n: 333\. Time: 11
Inserted 10000 records. n: 334\. Time: 11
Inserted 10000 records. n: 335\. Time: 11
Inserted 10000 records. n: 336\. Time: 10
Inserted 10000 records. n: 337\. Time: 11
Inserted 10000 records. n: 338\. Time: 12
Inserted 10000 records. n: 339\. Time: 13
Inserted 10000 records. n: 340\. Time: 14
Inserted 10000 records. n: 341\. Time: 13
Inserted 10000 records. n: 342\. Time: 10
Inserted 10000 records. n: 343\. Time: 10
Inserted 10000 records. n: 344\. Time: 9
Inserted 10000 records. n: 345\. Time: 11
Inserted 10000 records. n: 346\. Time: 12
Inserted 10000 records. n: 347\. Time: 12
Inserted 10000 records. n: 348\. Time: 10
Inserted 10000 records. n: 349\. Time: 11
Inserted 10000 records. n: 350\. Time: 13
Inserted 10000 records. n: 351\. Time: 13
Inserted 10000 records. n: 352\. Time: 11
Inserted 10000 records. n: 353\. Time: 12
Inserted 10000 records. n: 354\. Time: 10
Inserted 10000 records. n: 355\. Time: 10
Inserted 10000 records. n: 356\. Time: 12
Inserted 10000 records. n: 357\. Time: 11
Inserted 10000 records. n: 358\. Time: 11
Inserted 10000 records. n: 359\. Time: 12
Inserted 10000 records. n: 360\. Time: 11
Inserted 10000 records. n: 361\. Time: 12
Inserted 10000 records. n: 362\. Time: 13
Inserted 10000 records. n: 363\. Time: 12
Inserted 10000 records. n: 364\. Time: 11
Inserted 10000 records. n: 365\. Time: 11
Inserted 10000 records. n: 366\. Time: 11
Inserted 10000 records. n: 367\. Time: 11
Inserted 10000 records. n: 368\. Time: 12
Inserted 10000 records. n: 369\. Time: 11
Inserted 10000 records. n: 370\. Time: 14
Inserted 10000 records. n: 371\. Time: 14
Inserted 10000 records. n: 372\. Time: 15
Inserted 10000 records. n: 373\. Time: 16
Inserted 10000 records. n: 374\. Time: 18
Inserted 10000 records. n: 375\. Time: 15
Inserted 10000 records. n: 376\. Time: 11
Inserted 10000 records. n: 377\. Time: 11
Inserted 10000 records. n: 378\. Time: 11
Inserted 10000 records. n: 379\. Time: 12
Inserted 10000 records. n: 380\. Time: 11
Inserted 10000 records. n: 381\. Time: 12
Inserted 10000 records. n: 382\. Time: 12
Inserted 10000 records. n: 383\. Time: 14
Inserted 10000 records. n: 384\. Time: 12
Inserted 10000 records. n: 385\. Time: 16
Inserted 10000 records. n: 386\. Time: 14
Inserted 10000 records. n: 387\. Time: 10
Inserted 10000 records. n: 388\. Time: 12
Inserted 10000 records. n: 389\. Time: 11
Inserted 10000 records. n: 390\. Time: 11
Inserted 10000 records. n: 391\. Time: 11
Inserted 10000 records. n: 392\. Time: 12
Inserted 10000 records. n: 393\. Time: 15
Inserted 10000 records. n: 394\. Time: 16
Inserted 10000 records. n: 395\. Time: 17
Inserted 10000 records. n: 396\. Time: 13
Inserted 10000 records. n: 397\. Time: 13
Inserted 10000 records. n: 398\. Time: 17
Inserted 10000 records. n: 399\. Time: 11
Inserted 10000 records. n: 400\. Time: 16
Inserted 10000 records. n: 401\. Time: 12
Inserted 10000 records. n: 402\. Time: 13
Inserted 10000 records. n: 403\. Time: 13
Inserted 10000 records. n: 404\. Time: 13
Inserted 10000 records. n: 405\. Time: 16
Inserted 10000 records. n: 406\. Time: 10
Inserted 10000 records. n: 407\. Time: 12
Inserted 10000 records. n: 408\. Time: 14
Inserted 10000 records. n: 409\. Time: 12
Inserted 10000 records. n: 410\. Time: 18
Inserted 10000 records. n: 411\. Time: 13
Inserted 10000 records. n: 412\. Time: 20
Inserted 10000 records. n: 413\. Time: 14
Inserted 10000 records. n: 414\. Time: 15
Inserted 10000 records. n: 415\. Time: 52
Inserted 10000 records. n: 416\. Time: 22
Inserted 10000 records. n: 417\. Time: 111
Inserted 10000 records. n: 418\. Time: 81
Inserted 10000 records. n: 419\. Time: 80
Inserted 10000 records. n: 420\. Time: 78
Inserted 10000 records. n: 421\. Time: 116
Inserted 10000 records. n: 422\. Time: 123
Inserted 10000 records. n: 423\. Time: 86
Inserted 10000 records. n: 424\. Time: 24
Inserted 10000 records. n: 425\. Time: 36
Inserted 10000 records. n: 426\. Time: 21
Inserted 10000 records. n: 427\. Time: 15
Inserted 10000 records. n: 428\. Time: 17
Inserted 10000 records. n: 429\. Time: 15
Inserted 10000 records. n: 430\. Time: 15
Inserted 10000 records. n: 431\. Time: 16
Inserted 10000 records. n: 432\. Time: 15
Inserted 10000 records. n: 433\. Time: 18
Inserted 10000 records. n: 434\. Time: 20
Inserted 10000 records. n: 435\. Time: 18
Inserted 10000 records. n: 436\. Time: 20
Inserted 10000 records. n: 437\. Time: 20
Inserted 10000 records. n: 438\. Time: 22
Inserted 10000 records. n: 439\. Time: 22
Inserted 10000 records. n: 440\. Time: 26
Inserted 10000 records. n: 441\. Time: 24
Inserted 10000 records. n: 442\. Time: 69
Inserted 10000 records. n: 443\. Time: 133
Inserted 10000 records. n: 444\. Time: 17
Inserted 10000 records. n: 445\. Time: 18
Inserted 10000 records. n: 446\. Time: 20
Inserted 10000 records. n: 447\. Time: 19
Inserted 10000 records. n: 448\. Time: 19
Inserted 10000 records. n: 449\. Time: 20
Inserted 10000 records. n: 450\. Time: 18
Inserted 10000 records. n: 451\. Time: 18
Inserted 10000 records. n: 452\. Time: 19
Inserted 10000 records. n: 453\. Time: 19
Inserted 10000 records. n: 454\. Time: 19
Inserted 10000 records. n: 455\. Time: 22
Inserted 10000 records. n: 456\. Time: 33
Inserted 10000 records. n: 457\. Time: 25
Inserted 10000 records. n: 458\. Time: 23
Inserted 10000 records. n: 459\. Time: 24
Inserted 10000 records. n: 460\. Time: 134
Inserted 10000 records. n: 461\. Time: 31
Inserted 10000 records. n: 462\. Time: 21
Inserted 10000 records. n: 463\. Time: 21
Inserted 10000 records. n: 464\. Time: 21
Inserted 10000 records. n: 465\. Time: 20
Inserted 10000 records. n: 466\. Time: 25
Inserted 10000 records. n: 467\. Time: 26
Inserted 10000 records. n: 468\. Time: 24
Inserted 10000 records. n: 469\. Time: 25
Inserted 10000 records. n: 470\. Time: 31
Inserted 10000 records. n: 471\. Time: 28
Inserted 10000 records. n: 472\. Time: 31
Inserted 10000 records. n: 473\. Time: 32
Inserted 10000 records. n: 474\. Time: 33
Inserted 10000 records. n: 475\. Time: 31
Inserted 10000 records. n: 476\. Time: 40
Inserted 10000 records. n: 477\. Time: 120
Inserted 10000 records. n: 478\. Time: 23
Inserted 10000 records. n: 479\. Time: 30
Inserted 10000 records. n: 480\. Time: 33
Inserted 10000 records. n: 481\. Time: 28
Inserted 10000 records. n: 482\. Time: 26
Inserted 10000 records. n: 483\. Time: 31
Inserted 10000 records. n: 484\. Time: 22
Inserted 10000 records. n: 485\. Time: 26
Inserted 10000 records. n: 486\. Time: 25
Inserted 10000 records. n: 487\. Time: 22
Inserted 10000 records. n: 488\. Time: 38
Inserted 10000 records. n: 489\. Time: 24
Inserted 10000 records. n: 490\. Time: 27
Inserted 10000 records. n: 491\. Time: 42
Inserted 10000 records. n: 492\. Time: 39
Inserted 10000 records. n: 493\. Time: 97
Inserted 10000 records. n: 494\. Time: 59
Inserted 10000 records. n: 495\. Time: 28
Inserted 10000 records. n: 496\. Time: 24
Inserted 10000 records. n: 497\. Time: 25
Inserted 10000 records. n: 498\. Time: 24
Inserted 10000 records. n: 499\. Time: 37
Inserted 10000 records. n: 500\. Time: 24
Inserted 10000 records. n: 501\. Time: 30
Inserted 10000 records. n: 502\. Time: 31
Inserted 10000 records. n: 503\. Time: 38
Inserted 10000 records. n: 504\. Time: 65
Inserted 10000 records. n: 505\. Time: 61
Inserted 10000 records. n: 506\. Time: 47
Inserted 10000 records. n: 507\. Time: 31
Inserted 10000 records. n: 508\. Time: 38
Inserted 10000 records. n: 509\. Time: 29
Inserted 10000 records. n: 510\. Time: 31
Inserted 10000 records. n: 511\. Time: 30
Inserted 10000 records. n: 512\. Time: 33
Inserted 10000 records. n: 513\. Time: 30
Inserted 10000 records. n: 514\. Time: 35
Inserted 10000 records. n: 515\. Time: 35
Inserted 10000 records. n: 516\. Time: 33
Inserted 10000 records. n: 517\. Time: 33
Inserted 10000 records. n: 518\. Time: 30
Inserted 10000 records. n: 519\. Time: 46
Inserted 10000 records. n: 520\. Time: 75
Inserted 10000 records. n: 521\. Time: 30
Inserted 10000 records. n: 522\. Time: 36
Inserted 10000 records. n: 523\. Time: 28
Inserted 10000 records. n: 524\. Time: 29
Inserted 10000 records. n: 525\. Time: 32
Inserted 10000 records. n: 526\. Time: 34
Inserted 10000 records. n: 527\. Time: 43
Inserted 10000 records. n: 528\. Time: 38
Inserted 10000 records. n: 529\. Time: 37
Inserted 10000 records. n: 530\. Time: 29
Inserted 10000 records. n: 531\. Time: 29
Inserted 10000 records. n: 532\. Time: 30
Inserted 10000 records. n: 533\. Time: 33
Inserted 10000 records. n: 534\. Time: 39
Inserted 10000 records. n: 535\. Time: 55
Inserted 10000 records. n: 536\. Time: 73
Inserted 10000 records. n: 537\. Time: 50
Inserted 10000 records. n: 538\. Time: 54
Inserted 10000 records. n: 539\. Time: 31
Inserted 10000 records. n: 540\. Time: 38
Inserted 10000 records. n: 541\. Time: 50
Inserted 10000 records. n: 542\. Time: 40
Inserted 10000 records. n: 543\. Time: 21
Inserted 10000 records. n: 544\. Time: 38
Inserted 10000 records. n: 545\. Time: 34
Inserted 10000 records. n: 546\. Time: 41
Inserted 10000 records. n: 547\. Time: 34
Inserted 10000 records. n: 548\. Time: 31
Inserted 10000 records. n: 549\. Time: 37
Inserted 10000 records. n: 550\. Time: 58
Inserted 10000 records. n: 551\. Time: 42
Inserted 10000 records. n: 552\. Time: 36
Inserted 10000 records. n: 553\. Time: 38
Inserted 10000 records. n: 554\. Time: 55
Inserted 10000 records. n: 555\. Time: 39
Inserted 10000 records. n: 556\. Time: 45
Inserted 10000 records. n: 557\. Time: 36
Inserted 10000 records. n: 558\. Time: 48
Inserted 10000 records. n: 559\. Time: 45
Inserted 10000 records. n: 560\. Time: 36
Inserted 10000 records. n: 561\. Time: 32
Inserted 10000 records. n: 562\. Time: 36
Inserted 10000 records. n: 563\. Time: 46
Inserted 10000 records. n: 564\. Time: 51
Inserted 10000 records. n: 565\. Time: 49
Inserted 10000 records. n: 566\. Time: 47
Inserted 10000 records. n: 567\. Time: 49
Inserted 10000 records. n: 568\. Time: 45
Inserted 10000 records. n: 569\. Time: 41
Inserted 10000 records. n: 570\. Time: 39
Inserted 10000 records. n: 571\. Time: 43
Inserted 10000 records. n: 572\. Time: 68
Inserted 10000 records. n: 573\. Time: 41
Inserted 10000 records. n: 574\. Time: 33
Inserted 10000 records. n: 575\. Time: 54
Inserted 10000 records. n: 576\. Time: 39
Inserted 10000 records. n: 577\. Time: 45
Inserted 10000 records. n: 578\. Time: 50
Inserted 10000 records. n: 579\. Time: 34
Inserted 10000 records. n: 580\. Time: 36
Inserted 10000 records. n: 581\. Time: 47
Inserted 10000 records. n: 582\. Time: 59
Inserted 10000 records. n: 583\. Time: 40
Inserted 10000 records. n: 584\. Time: 37
Inserted 10000 records. n: 585\. Time: 35
Inserted 10000 records. n: 586\. Time: 59
Inserted 10000 records. n: 587\. Time: 62
Inserted 10000 records. n: 588\. Time: 26
Inserted 10000 records. n: 589\. Time: 54
Inserted 10000 records. n: 590\. Time: 54
Inserted 10000 records. n: 591\. Time: 47
Inserted 10000 records. n: 592\. Time: 53
Inserted 10000 records. n: 593\. Time: 41
Inserted 10000 records. n: 594\. Time: 45
Inserted 10000 records. n: 595\. Time: 39
Inserted 10000 records. n: 596\. Time: 45
Inserted 10000 records. n: 597\. Time: 55
Inserted 10000 records. n: 598\. Time: 50
Inserted 10000 records. n: 599\. Time: 47
Inserted 10000 records. n: 600\. Time: 39
Inserted 10000 records. n: 601\. Time: 48
Inserted 10000 records. n: 602\. Time: 43
Inserted 10000 records. n: 603\. Time: 57
Inserted 10000 records. n: 604\. Time: 38
Inserted 10000 records. n: 605\. Time: 42
Inserted 10000 records. n: 606\. Time: 44
Inserted 10000 records. n: 607\. Time: 55
Inserted 10000 records. n: 608\. Time: 46
Inserted 10000 records. n: 609\. Time: 49
Inserted 10000 records. n: 610\. Time: 44
Inserted 10000 records. n: 611\. Time: 43
Inserted 10000 records. n: 612\. Time: 43
Inserted 10000 records. n: 613\. Time: 48
Inserted 10000 records. n: 614\. Time: 36
Inserted 10000 records. n: 615\. Time: 55
Inserted 10000 records. n: 616\. Time: 58
Inserted 10000 records. n: 617\. Time: 39 
```

有什么方法可以将性能线性保持在每 10000 条记录大约 9-10 秒？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T07:59:36.120

您的计算集中在密钥方面（密钥是否适合 RAM？）。这很重要，但是在达到一定的数据库大小（在您的情况下由值方主导）之后，写入磁盘的值将变得与速度更相关。我担心你只能在这种情况下优化你的磁盘（任何细节？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T12:53:45.537

你也修改了msiz吗？

您是否尝试过较低的 bnum 参数（例如 1 或 20 亿）？

你的文件系统是什么（在我的测试中，ext4 的性能比 ext3 好得多）？

# mpi - MVAPICH2 R3 Rendez-vu 协议魔术

> ID：15800988
> 
> 赞同：1
> 
> 时间：2013-04-04T01:19:54.913
> 
> 标签：mpi, mvapich2

我想知道为什么 R3 协议在使用多个耗尽注册缓存的不同缓冲区时表现出出色的性能。它是否不需要固定和取消固定为发送提供的缓冲区，或者它如何隐藏这种开销？坚持 R3 协议总是一个好的选择吗？

在底部，您会看到一个图表，显示我的观察结果。我使用了 2 个节点并行发送和接收。x 轴表示用于发送的缓冲区数 n（每个 1MB）。主循环如下所示：

```
\\ Take time
for(i to 20){
  for(a to n) IRecv(rec_buffer[a])
  for(a to n) ISend(send_buffer[a])
  waitForAllRecv()
  waitForAllSend()
}
\\ Plot time 
```

参见情节：http: [//i47.tinypic.com/2vkn6ty.jpg](http://i47.tinypic.com/2vkn6ty.jpg)

# foxpro - 将 VB.Net 中的 DBF 文件结构读取为二进制文件

> ID：15800991
> 
> 赞同：1
> 
> 时间：2013-04-04T01:20:12.577
> 
> 标签：foxpro, dbf

我在 VB.Net 中将 DBF 作为二进制文件打开以确定结构。我必须这样做，因为使用 Visual Foxpro OLEDB 驱动程序不会返回十进制字段的精度和小数位数。我成功地完成了我的任务，没有任何问题。我遇到的问题是：

字节 0 是 DBF 文件类型。
字节 1-3 是最后一次更新 (yymmdd)。
DBF 文件的字节 4-7 是文件中的记录数。
字节 8-9 是第一个数据记录的位置。
字节 10-11 是一条数据记录的长度，包括删除标志。
（此信息来自[http://www.dbf2002.com/dbf-file-format.html](http://www.dbf2002.com/dbf-file-format.html)）

以下是我的 DBF 文件的前 32 个字节，用连字符分隔：

48-13-2-6-158-0-0-0-168-9-18-3-0-0-0-0-0-0-0-0-0-0-0-0-0- 0-0-0-1-3-0-0

“48”（十六进制 30）表示 Visual Foxpro
字节 1-3 表示该文件最后一次更新是在 2013 年 2 月 6 日。
字节 4-7 表示该文件有 158 条记录。
所有这些都是正确的。

字节 8-9 是 168 和 9，字节 10-11 是 18 和 3。

实际记录大小为 786 字节。由于有 68 个字段，所以第一个数据记录的位置应该是 (68x32+31) = 2207。

我必须进行一些转换才能将 1689 转换为 2207 并将 183 转换为 786？

我已经尝试将 dec 转换为十六进制，反之亦然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T01:44:42.013

我认为您的 2207 不正确，但 786 是正确的。

我相信这些值基于低/高字节位置，由​​ 256 的幂表示，因为它也在备忘录文件中处理，但 4 个字节值得......

```
18 * 256^0 ( to the power 0 )  = 18 * 1  = 18
 3 * 256^1 ( to the power 1 )  = 3 * 256 = 768

18 + 768 = 786 
```

现在，另一个也一样...

```
168 * 256^0 ( to the power 0 )  = 168 * 1  = 168
  9 * 256^1 ( to the power 1 )  = 9 * 256 = 2304

168 + 2304 = 2472 
```

# python - TurboPascal 的绘图（x，y，颜色）的 Python 等价物？

> ID：15800997
> 
> 赞同：0
> 
> 时间：2013-04-04T01:20:41.743
> 
> 标签：python, graphics

在 TurboPascal 中，我可以使用以下方法在显示器上设置一个像素：

```
Plot (x, y, colour) 
```

Python中的等价物是什么？如何在 Python 中设置或取消设置单个像素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T02:02:56.927

python中有几个有用的库可以帮助你。我会说[PyGame](http://www.pygame.org/news.html)或[Pyglet](http://www.pyglet.org/)都是不错的绘图选择。Pyglet 是 Python 中 Opengl 的包装器，但它可以让您控制像素。如果您只是想在没有任何其他绘图功能的情况下进行粗略的像素集，python Imaging 库允许您这样做：

```
pixels = img.load() # create the pixel map

for i in range(img.size[0]):    # for every pixel:
    for j in range(img.size[1]):
        pixels[i,j] = (i, j, 100) # set the colour accordingly 
```

# eclipse - 项目/向导如何与透视相关联？

> ID：15800998
> 
> 赞同：3
> 
> 时间：2013-04-04T01:20:42.187
> 
> 标签：eclipse, eclipse-rcp, eclipse-plugin

当我们在eclipse中新建一个项目后，如果我们当前的透视图与该项目没有关联，会显示如下图所示的对话框。那么 Eclipse 如何以编程方式实现这一点？

![与透视相关](https://i.stack.imgur.com/xUayo.jpg)

我认为这取决于项目性质，但与项目性质`perspective extension point`无关。

谢谢你的时间:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T07:59:36.177

您必须`finalPerspective`在向导中设置属性。请参阅 [将向导与透视关联以](http://www.eclipse-tips.com/tips/11-associating-wizard-perspective)获取参考：

1.  将该属性添加`finalPerspective`到扩展中我们的向导元素的定义中。

2.  使 Wizard 类实现接口`IExecutableExtension`。这个接口只有一个方法`setInitializationData`。在类中实现方法并将参数分配给方法中`IConfigurationElement`的字段。

3.  在`performFinish`向导的方法中，调用`BasicNewProjectResourceWizard.updatePerspective`方法。