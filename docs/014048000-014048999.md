# StackOverflow 问答 14048000-14048999

# php - Zend Framework 1.12 选择元素 - 名称数组问题

> ID：14048000
> 
> 赞同：2
> 
> 时间：2012-12-27T00:34:32.940
> 
> 标签：php, zend-framework, zend-form, zend-form-element

由于某种原因，Zend_Form_Element_Select 与 setIsArray 结合使用时，Zend Framework 1.12 假定您需要多选。这似乎是框架的一种奇怪行为，所以我认为必须有一个解决方法或另一个我没有设置的选项。

例如，如果我使用以下代码：

```
$element = $this->getElement('element');
$element->setIsArray(true)
        ->setMultiOptions(array('a' => 'A')); 
```

我得到以下输出：

```
<select name="element[]" id="element" multiple="multiple">
<option value="a" label="A">A</option>
</select> 
```

当我想要所需的输出时：

```
<select name="element[]" id="element">
<option value="a" label="A">A</option>
</select> 
```

即我不想要多个=“多个”

我已经研究过解决这个问题的方法，但我觉得它们不适合像在表单元素的名称中添加括号这样的简单问题。在这一点上，我正在考虑使用 jquery 来删除页面加载时的这个多重属性，但这真的很hacky，无法想象 Zend Framework 会以这种方式工作。

有谁知道如何使用上面的代码示例来做到这一点？我不想实例化 zend 表单选择或 addElement 的新实例，因为已经建立了一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:32:25.243

[ZF Issue tracker](http://framework.zend.com/issues/browse/ZF-8452)有一个非常相似的线程，您尝试过建议的解决方法吗？

```
$element = new Zend_Form_Element_Select('selectbox', array('multiple' => false ));
$element->setIsArray(true); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T23:45:56.580

所以这是这个问题的解决方案，使用带有多个 => false 的 setOptions 方法，如下面的示例所示：

```
$element = $this->getElement('element');
$element->setMultiOptions(array('a' => 'A'))
        ->setIsArray(true)
        ->setOptions(array('multiple' => false)); 
```

# python - 单词搜索/查找单词生成器 Python

> ID：14048002
> 
> 赞同：0
> 
> 时间：2012-12-27T00:34:52.253
> 
> 标签：python, wordsearch

我正在尝试编写单词搜索/查找单词生成器，但我遇到了一些问题。此代码的目的是从用户输入中获取维度和单词，并生成随机单词搜索/查找单词。

问题是这些字母偶尔会相互覆盖。为了尝试阻止这种情况，我的函数中有这行代码：

```
lines[0][randCoO[0] - (i)][randCoO[1]] == '-': 
```

该行属于函数 U

它旨在测试空间是否为空（由 ' - ' 填充）

我知道我应该尽量避免将我的整个代码放入其中，因为它可能很长而且读起来很烦人，但是请尝试帮助我

这是我的代码：

```
 try:
    dim=int(raw_input('How many letters high and long do you want your find-a-word? (It has to be <= 79) '))
except ValueError:
        raise SystemExit, 'Dude, thats not a number!'

if dim > 79:
    raise SystemExit, "\n That number is bigger than 79\. It won't print to well. \n"

count=0

allwords = raw_input('What words do you want in your find-a-word?\n(Enter them all together seperated by a comma)')

allwords = allwords.upper()
allwords = allwords.split(', ')
nowords = len(allwords)

while count < nowords:
    if len(allwords[count])>dim:
        raise SystemExit, "\nYour find-a-word is not big enough for one or more of your words.\nIt is doomed to fail! "
    count = count + 1

    randletter = []
    import random
    randrange = random.randrange
    alphabet = ['A', 'B', 'C', 'D', 'E', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']

    all_words = ' '.join(allwords)

    print '\n\nTry to find these words in the word find-a-word\n\n'
    count = 0
    while count < nowords:
        print allwords[count],'\n'
        count=count+1

        drctn = ['U','D','L','R','UL','UR','DL','DR']

        randdrctnlist = []

for i in range(nowords):
    randdrctn = drctn[randrange(0,4)]
    randdrctnlist.append(randdrctn)

    d = {}

for i in range(dim):
    d['line' + str(i + 1)] = ['-']*dim

    lines = []
    lines.append(d.values())
    lines.sort()

    CoO1 = []
    CoO2 = []
    CoO = []

for i in range(dim):
    CoO1.append(i)
    CoO2.append(i)    

    CoO.append(CoO1)
    CoO.append(CoO2)

    count = 0

def U(word, wordno, count, dim, lines):
    stop = 0
    randCoO = []
    while count == 0:
        rand = CoO[0][randrange(0,dim)]
        randCoO.append(rand)
        rand = CoO[1][randrange(0,dim)]
        randCoO.append(rand)
        for i in range(len(word[wordno])):
            if randCoO[0] >= (len(word[wordno]) - 1) and lines[0][randCoO[0] - (i)][randCoO[1]] == '-':
                count = 1               
                lines[0][randCoO[0]][randCoO[1]] = word[wordno][0]
                while count < len(allwords[wordno]):
                    lines[0][randCoO[0] - (count)][randCoO[1]] = word[wordno][count]
                    count = count + 1                
            else:
                print randCoO
                randCoO = []
                stop = stop + 1
                print stop
                if stop > dim*dim:
                    raise SystemExit, "\nThe find-a-word is probably impossible to make\nwithout overwriting already placed letters.\nPlease try it again. If this has show up many times in a row try making the dimensions of you find-a-word bigger\n(Or you're just unlucky!)\n"
                break

def D(word, wordno, count, dim, lines):
    stop = 0
    randCoO = []
    while count == 0:
        rand = CoO[0][randrange(0,dim)]
        randCoO.append(rand)
        rand = CoO[1][randrange(0,dim)]
        randCoO.append(rand)
        for i in range(len(word[wordno])):
            if dim - randCoO[0] > len(word[wordno]) - 1 and lines[0][randCoO[0] + (i)][randCoO[1]] == '-':
                count = 1
                lines[0][randCoO[0]][randCoO[1]] = word[wordno][0]
                while count < len(allwords[wordno]):
                    lines[0][randCoO[0] + (count)][randCoO[1]] = word[wordno][count]
                    count = count + 1
            else:
                print randCoO
                randCoO = []
                stop = stop + 1
                print stop
                if stop > dim*dim:
                    raise SystemExit, "\nThe find-a-word is probably impossible to make\nwithout overwriting already placed letters.\nPlease try it again. If this has show up many times in a row try making the dimensions of you find-a-word bigger\n(Or you're just unlucky!)\n"
                break   

def L(word, wordno, count, dim, lines):
    stop = 0
    randCoO = []
    while count == 0:
        rand = CoO[0][randrange(0,dim)]                            
        randCoO.append(rand)
        rand = CoO[1][randrange(0,dim)]
        randCoO.append(rand)
        for i in range(len(word[wordno])):
            if dim - randCoO[1] > (len(word[wordno]) - 1) and lines[0][randCoO[0]][randCoO[1] + (i)] == '-':
                count = 1  
                lines[0][randCoO[0]][randCoO[1]] = word[wordno][0]
                while count < len(allwords[wordno]):
                    lines[0][randCoO[0]][randCoO[1] + (count)] = word[wordno][count]
                    count = count + 1
            else:
                print randCoO
                randCoO = []
                stop = stop + 1
                print stop
                if stop > dim*dim:
                    raise SystemExit, "\nThe find-a-word is probably impossible to make\nwithout overwriting already placed letters.\nPlease try it again. If this has show up many times in a row try making the dimensions of you find-a-word bigger\n(Or you're just unlucky!)\n"
                break

def R(word, wordno, count, dim, lines):
    stop = 0 
    randCoO = []
    while count == 0:
        rand = CoO[0][randrange(0,dim)]                            
        randCoO.append(rand)
        rand = CoO[1][randrange(0,dim)]
        randCoO.append(rand)
        for i in range(len(word[wordno])):
            if randCoO[1] >= (len(word[wordno]) - 1) and lines[0][randCoO[0]][randCoO[1] + (i)] == '-':
                count = 1  
                lines[0][randCoO[0]][randCoO[1]] = word[wordno][0]
                while count < len(allwords[wordno]):
                    lines[0][randCoO[0]][randCoO[1] - (count)] = word[wordno][count]
                    count = count + 1
            else:
                print randCoO
                randCoO = []
                print stop
                stop = stop + 1
                if stop > dim*dim:
                    raise SystemExit, "\nThe find-a-word is probably impossible to make\nwithout overwriting already placed letters.\nPlease try it again. If this has show up many times in a row try making the dimensions of you find-a-word bigger\n(Or you're just unlucky!)\n"
                break

for i in range(nowords):
    count = 0
    print randdrctnlist
    if randdrctnlist[i] == 'U':
        U(allwords, i, count, dim, lines)
    if randdrctnlist[i] == 'D':
        D(allwords, i, count, dim, lines)
    if randdrctnlist[i] == 'L':
        L(allwords, i, count, dim, lines)
    if randdrctnlist[i] == 'R':
        R(allwords, i, count, dim, lines)

for i in range(dim):
    print ' '.join(lines[0][i]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:16:53.943

我认为您需要重新考虑基本算法。您的代码试图在随机方向上创建单词，然后管理冲突。相反，您可以考虑所有单词之间的所有交点，然后构建所有可能的重叠，并从结果中随机选择。

例如：“FROG”以两个字母与“DOG”相交，因此它们可以从“G”上的 7 个方向和“O”上的 6 个方向相交。'CAT' 和 ('DOG' or 'FROG') 没有共同的字母，因此它们根本无法相交。如果您尝试“迄今为止的现有解决方案”的每种组合，然后递归调用您的解决方案并在适合拼图尺寸的所有其他可能组合中添加一个新单词，您将拥有所有可能的 find-a-words给定的单词。

为了降低这个的维度，我认为你应该首先放置不相交的单词。如果它们不完全适合，您可以退出并出现错误。然后按大小递减的顺序处理单词。

然后，您可以随机选择，也可以在找到解决方案后立即退出。如果您希望您的答案具有不同的特征（例如更加分散以使用整个给定尺寸），我认为您可以重新排列尝试组合的方式，并选择给定的第一个解决方案。

# intellij-idea - IntelliJ 在 Javascript 中包装注释

> ID：14048004
> 
> 赞同：4
> 
> 时间：2012-12-27T00:35:12.863
> 
> 标签：intellij-idea

是否可以将 IntelliJ 中的长注释行包装在 javascript 文件中？我已打开换行，如下面的设置所示，但是当我重新格式化代码时，它不会换行。

![在此处输入图像描述](../Images/9ec88c14c25e695ea095a83934dc7f5a.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T06:08:57.077

代码重新格式化尚不支持，[添加了新功能请求](http://youtrack.jetbrains.com/issue/WEB-5653)，请投票。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-17T14:10:00.980

我在 Mac 上使用 IntelliJ 14，它有一个 Fill Paragraph 命令。通过令人敬畏的通用 Command-Shift-A 动作搜索功能访问它。奇迹般有效！

# php - 将任何 dot com 的搜索结果拉入我网站上的 iframe 的最佳方式是什么

> ID：14048013
> 
> 赞同：-1
> 
> 时间：2012-12-27T00:36:17.327
> 
> 标签：php, javascript, jquery, iframe

我喜欢他们的搜索，我想在我的网站上使用它，该网站内置在 div 或 iframe 中……有没有人做过类似的事情，第四条最好的路线是什么？我注意到他们在 GET 中的变量

[http://anywhoyp.yellowpages.com/whitepages?from=AnyWho&fap_terms%5Bfirst%5D=Hunter&fap_terms%5Blast%5D=Thompson&fap_terms%5Bcity%5D=&fap_terms%5Bstate%5D=](http://anywhoyp.yellowpages.com/whitepages?from=AnyWho&fap_terms%5Bfirst%5D=Hunter&fap_terms%5Blast%5D=Thompson&fap_terms%5Bcity%5D=&fap_terms%5Bstate%5D=)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:48:36.993

在 iframe 外部内容之前获得许可。如果你这样做了 iframe，它会起作用，但第三方可以通过添加`X-Frame-Options: DENY`标题轻松阻止它，这会导致你的 iframe 停止工作。

# php - 检测并去除任何外来文本，同时保留特殊字符

> ID：14048016
> 
> 赞同：0
> 
> 时间：2012-12-27T00:36:47.920
> 
> 标签：php, javascript, regex

我正在尝试过滤掉所有非拉丁字符，例如`γειά σου`使用 javascript / regex，同时允许特殊字符，例如`!@#$%^&*()`.
但是如果 JS 是不可能的，那么 php`preg_replace`可能。

我试过JS `str = str.replace(/[^a-z0-9\-.,:;]/i, "");`，但没有做任何事情。

使用 php`$str = preg_replace('[^a-zA-Z0-9\xC0-\xFF]', '', $str);`但得到了相同的结果。

然而，这`echo htmlentities($str, ENT_QUOTES, "ISO-8859-1");`给了我乱码，![在此处输入图像描述](../Images/58acf84f43632cfa92098b0bdd8488a1.png)
也许我能以某种方式检测到？

问：最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T00:52:58.877

当我测试它时，这似乎有效，但您需要仔细检查：

```
$output = preg_replace('/[^(\x20-\x7F)]*/','', $output); 
```

# java - Apache tomcat servlet 实例化中的静态变量未得到更新

> ID：14048018
> 
> 赞同：0
> 
> 时间：2012-12-27T00:36:57.820
> 
> 标签：java, apache, tomcat, servlets, static

我是一个 tomcat/servlet 新手，在过去的 3/4 天里一直坚持这一点。任何帮助表示赞赏！我有一个 servlet 类，它有一个静态变量 name_print。静态函数 appInput 接受一个字符串并将 name_print 设置为该字符串。此类 appmonitor.java 的代码如下：

包 AppMonitor_pack；

导入语句...

```
private static String name_print;
public app_monitor() {
    // TODO Auto-generated constructor stub
}

/**
 * @param args
 */
public static void main(String[] args) {
    // TOsDO Auto-generated method stub

}

public static void appInput (String name){
    name_print = name;
    System.out.println("From appInput " + name_print);
}

@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp)
        throws ServletException, IOException {
    PrintWriter writer = resp.getWriter();
    writer.println("<body> "+ name_print +" </body>");
} 
```

}

我已经将这个简单的项目包含在另一个名为 Sockets 的项目中。在那里，我有一个监听套接字，它接收一个名为 name 的字符串。我调用第一个项目的静态函数 appInput 并将收到的字符串名称传递给它，以便它将 name_print 设置为这个新值。

Socket.java 中的相关行是：app_monitor.appInput(name);

当我编译并运行它时，我看到值名称设置为某个输入值“abc”。然后调试器进入另一个项目的 appInput 函数，并将 name_print 的值也设置为“abc”。

但是当我刷新运行tomcat服务器的网页时，它永远不会显示新设置的name_print值，而是继续显示appMonitor servlet类第一次加载时设置的旧值“null”。

我试图找出问题无济于事4天。有什么想法/帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T00:42:10.350

> 当我编译并运行它时，我看到值名称设置为某个输入值“abc”。然后调试器进入另一个项目的 appInput 函数，并将 name_print 的值也设置为“abc”。

听起来您是在与 Tomcat 分开运行的。这意味着您不仅有两个不同的类加载器 - 您还有两个完全独立的 JVM，它们恰好在同一台计算机上运行。静态变量不会在这些进程之间共享。

目前还不清楚您要实现什么，但是如果您希望来自一个进程的信息在一个单独的进程中可用，您将需要使用一些跨进程通信，或者共享一些比静态变量更全局的东西- 例如，将数据写入一个进程中的文件，然后从另一个进程中的文件中读取。

# html - 布局在不同的浏览器中呈现不佳

> ID：14048019
> 
> 赞同：0
> 
> 时间：2012-12-27T00:37:00.147
> 
> 标签：html, css, layout, cross-browser, positioning

我正在为一个网站做一个布局。无论如何，它仍在开发中，它在 Google Chrome 和 Opera 上显示得足够好，但在 Firefox 和 Internet Explorer 上却不行。在 Chrome 中它看起来不错，但可能无论如何定位都没有正确完成。你能帮我修一下吗？

**HTML 正文**

```
<div id="wrapper">
<header id="top-header">
<div id="logo1">
scritta
<img src="CS-G-100.png" class="logo" />
</div>
<nav id="top-nav">
<ul>
<li><a href="#">Home</a></li>
<li><a href="#">Pulsante2</a></li>
<li><a href="#">Pulsante3</a></li>
<li><a href="#">Pulsante4</a></li>
<li><a href="#">Pulsante5</a></li>
</ul>
</nav>
<div id="kenburns" class="slideshow">
    <img src="images/1.jpg" alt="1">
</div>
</header>
<section id="main-section">
<aside id="left">
</aside>
<article id="main-content">
</article>
<aside id="right">
</aside>
<footer id="the-footer">
<div id="center-footer">
Centro fisioterapico San Giusto Via Romana Est 78/2 Porcari p. iva : 01532540463
</div>
</footer>
</section>
</div> 
```

**CSS**

```
body {

width:100%;
margin:18px 20px 20px 20px;
display: box;                     /* As specified */
display: -moz-box;                /* Mozilla */
display: -webkit-box;             /* WebKit */
box-pack: center;                  /* As specified */
-moz-box-pack: center;             /* Mozilla */
-webkit-box-pack: center;          /* WebKit */
background-attachment: fixed;
background-image: url(sfondo-6.png);
background-repeat: repeat;
}

#wrapper {
border: 1px solid black;
width:1024px;
height:768px;
padding: 20px;
background: rgb(238,238,238); /* Old browsers */
background: -moz-linear-gradient(-45deg, rgba(238,238,238,1) 0%, rgba(238,238,238,1)  100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, right bottom, color- stop(0%,rgba(238,238,238,1)), color-stop(100%,rgba(238,238,238,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(-45deg, rgba(238,238,238,1) 0%,rgba(238,238,238,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(-45deg, rgba(238,238,238,1) 0%,rgba(238,238,238,1) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(-45deg, rgba(238,238,238,1) 0%,rgba(238,238,238,1) 100%); /* IE10+ */
background: linear-gradient(135deg, rgba(238,238,238,1) 0%,rgba(238,238,238,1) 100%); /* W3C */

}
#top-header {
position:absolute;
width:1022px;
height:234px;
display:block;
border:1px solid black; 
z-index:1;
background-color:#d2e5e3;
}

#top-nav {
position:relative;
width:700px;
display:block;
border:1px solid black;
top:-119px;
right:-321px;
z-index:2;
background-color:#d2e4e8;
}

#top-nav li {
display: inline;
/* Align children to the horizontal center of this box */
box-align: center;              /* As specified */
-moz-box-align: center;         /* Mozilla */
-webkit-box-align: center;      /* WebKit */
list-style:none;
text-align:center;
width:120px;
height:25px;
background:#5DBCD2;
opacity:0.7;
border-radius:10px;
-moz-border-radius:10px;
-o-border-radius:10px;
transition:transform 2s, opacity 2s, background 2s;
-webkit-transition::transform 2s, opacity 2s, background 2s;
-moz-transition:transform 2s, opacity 2s, background 2s;
-o--transform 2s, opacity 2s, background 2s;
}

#top-nav-li:hover {
transform-rotate:(360deg);
-webkit-transform:(360deg);
-moz-transform:rotate(360deg);
opacity:1px;
background:#0F3;
}

#top-nav li {
display:inline-block;   
}

#left-nav {
position:absolute;
border:1px solid black;
padding:0px;
left:0px;
top:0px;
z-index:2;
text-decoration:none;

}

#left-nav ul {
position:relative;
left:0px;
display:block;  
}

#left-nav li {
margin:0px opx 10px 0px;
display:block;
position:relative;
border-radius:0px 10px 0px 10px;
-webkit-border-radius:0px 10px 0px 10px;
-o-border-radius:0px 10px 0px 10px;
-moz-border-radius:0px 10px 0px 10px;
-ms-border-radius:0px 10px 0px 10px;
background-color:#9ED09D;
transition:opacity 2s;
-moz-transition:opacity 2s;
-o-transition:opacity 2s;
-webkit-transition:opacity 2s;
}

#left-nav li:hover {
opacity:1;  
}

#left {
position:relative;
float:left;
border: 1px solid black;
padding: 20px;
width:256px;
height:620px;

}

#right {
float:left;
border: 1px solid black;
padding:20px;
width:256px;
height:620px;
}

#main-content {
float:left;
border: 1px solid black;
padding:20px;
width:386px;
height:620px;
}

#the-footer {
display:table;
clear:both;
width:100%;
height:50px;
border:1px solid black;
}

#rollover {
position:relative;
top:-112px;
left:490px;
border:1px solid black;
width:500px;
height:200px;
background-color:#FFFFFF;

}

#logo1{
position:relative;
top:47px;
left:20px;
}

.logo {

}

.center-text {
vertical-align:middle;
text-align:center;  
}

#center-footer {
display:table-cell;
vertical-align:middle;
text-align:center;
margin:0px auto;
} 
```

下面是它在谷歌浏览器上的显示截图：（3的最佳渲染） ![谷歌浏览器](../Images/c8bc79da9028157f0151ca95fdb49abb.png)

这是它在 Firefox 上显示方式的屏幕截图： ![在此处输入图像描述](../Images/4093f134d422279ec354ebd4c171ced6.png) ![在此处输入图像描述](../Images/1a74ceb9c1e28466dface23ed112e0cd.png)

这是它在 Internet Explorer 上显示方式的屏幕截图：（比 firefox 好，但不像 Google Chrome 那样居中）

![在此处输入图像描述](../Images/b8ced4e8ac1a972e6965cbdc38181faf.png)

我给你小提琴：

这是代码：

[http://jsfiddle.net/Gwpbk/](http://jsfiddle.net/Gwpbk/)

这里是全屏视图：

[http://jsfiddle.net/Gwpbk/embedded/result/](http://jsfiddle.net/Gwpbk/embedded/result/)

我提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T00:59:38.853

您可能需要在 CSS 上进行一些调整。但我认为只为这个确切的问题提供一个解决方案并不是一个好主意，因为你要一次又一次地面对类似的问题。可能比你预期的要早。

CSS 是一门复杂的学科。当您尝试学习它时，我建议您使用 CSS 重置。

所有浏览器都有用于呈现不同 html 元素的默认 CSS 样式，并且这些规则通常在不同浏览器之间有所不同。

CSS Reset 是一组 CSS 规则，试图最小化浏览器之间的差异，从而在您添加自己的 CSS 时带来更相似的体验。我建议你检查[Normalize.css](http://necolas.github.com/normalize.css/)。看看[Html5Boilerplate.com 也](http://html5boilerplate.com/)想造成任何伤害。

# sql - 改进 SQLite 查询

> ID：14048021
> 
> 赞同：2
> 
> 时间：2012-12-27T00:37:10.193
> 
> 标签：sql, sqlite

我有一个事件表，其中包含大约 100k 行。以下是对“事件”表的复杂查询，希望对如何优化此查询提出您的意见...

```
SELECT id FROM event 
NATURAL JOIN (
    SELECT subj_id, max(timestamp) AS timestamp
    FROM event WHERE (
        timestamp >= 1342052128597 AND timestamp <= 9223372036854775807
        AND NOT subj_interpretation = 46))
    GROUP BY subj_id)
GROUP BY subj_id
ORDER BY  
timestamp DESC 
```

查询在 0.06-0.07 秒内执行。任何想法有什么好的指标和/或查询的重组。

目前我正在使用：

```
CREATE INDEX event_subj_id ON event(subj_id, timestamp, subj_interpretation) 
```

查询计划如下所示：

```
1 0 0 SCAN TABLE event USING COVERING INDEX event_subj_id (~27777 rows)
0 0 1 SCAN SUBQUERY 1 (~100 rows)
0 1 0 SEARCH TABLE event USING INDEX event_subj_id (subj_id=? AND timestamp=?) (~9 rows)
0 0 0 USE TEMP B-TREE FOR GROUP BY
0 0 0 USE TEMP B-TREE FOR ORDER BY 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T13:22:05.010

您可以通过删除来优化您的第二个查询`DISTINCT`，因为`GROUP BY subj_id`已经确保不能有重复的记录：

```
SELECT id,
       subj_id,
       max(timestamp) AS timestamp
FROM event
WHERE timestamp BETWEEN 1342055894621 AND 9223372036854775807
  AND subj_interpretation != 46
GROUP BY subj_id
ORDER BY timestamp 
```

索引本身已经是最佳的`GROUP BY`//查找`timestamp`。`subj_interpretation`但是，如果将`id`列添加到其中，SQLite 可以将其用作覆盖索引，这样就无需在`events`表本身中查找任何记录，这实际上可能使性能翻倍：

```
0 0 0 SCAN TABLE event USING COVERING INDEX event_subj_id_plus_id
0 0 0 USE TEMP B-TREE FOR ORDER BY 
```

# javascript - HTML 5 & Javascript 在 IE 上拖放

> ID：14048024
> 
> 赞同：0
> 
> 时间：2012-12-27T00:37:48.470
> 
> 标签：javascript, html, internet-explorer, drag-and-drop

我试图在 IE 9 和 8（或至少 IE 9）上仅使用 Javascript 和 HTML 5 进行拖放，但它不起作用，我已经阅读了拖放应该在 IE 上工作。你能看看我的代码并帮助我让它与 IE 一起工作吗？

代码：

```
<script type="text/javascript">
function allowDrop(ev){
    ev.preventDefault();
}

function drag(ev){
    var drag = ev.dataTransfer.setData("content", ev.target.id);

}

function drop(ev){
    ev.preventDefault();
    var image= ev.dataTransfer.getData("content");
    if ( image == ev.target.id) {
        ev.target.appendChild(document.getElementById(image));

    }

    else {

    }
}
</script>
<section id="planetBox">
<img class="planetImage" id="mercuryImg" draggable="true" 
    ondragstart="drag(event)" alt="A Planet" src="./images/planets/mercury.gif">  
</section>  

<div class="planet">
<section class="venusBox" id="venusImg" ondrop="drop(event)" 
    ondragover="allowDrop(event)"></section>
<section class="planetName"><h3>Venus</h3></section>    
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:27:57.163

尝试改变

```
var drag = ev.dataTransfer.setData("content", ev.target.id);
var image= ev.dataTransfer.getData("content"); 
```

至

```
var drag = ev.dataTransfer.setData("Text", ev.target.id);
var image= ev.dataTransfer.getData("Text"); 
```

你可能会考虑删除 if 条件

```
if ( image == ev.target.id) { 
```

# c# - 如何在 Visual Studio 2012 中使一个类完全静态，这样它就不会出现任何错误？- C＃

> ID：14048028
> 
> 赞同：-10
> 
> 时间：2012-12-27T00:37:57.953
> 
> 标签：c#, class, static, visual-studio-2012

我在使项目开始时不是静态的主类静态时遇到问题。但是，当我按照说明使类成为静态并运行它时，它会给出错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:40:34.947

这没有错误：

```
static class MyStaticClass {} 
```

你可以再详细一点吗？

如果“主”类是指定义主方法的类，那么请确保该类的所有成员也是`static`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T00:42:05.560

在这一点上这有点投机，但如果你让你的类静态你将不得不使

*   它的所有方法都是静态的
*   它的所有字段都是静态的
*   它的所有属性都是静态的
*   几乎所有关于你的类的东西都必须是静态的。

一般来说，你不能做任何依赖于被实例化的类的事情。

# tapestry - 在挂毯模板中循环一定次数

> ID：14048039
> 
> 赞同：1
> 
> 时间：2012-12-27T00:40:16.853
> 
> 标签：tapestry

在 Tapestry 组件模板中，有没有一种简单的方法来渲染一些标记 X 次，其中 X 是组件的参数？

我在 Tapestry 文档中能找到的只有 Loop 组件：

```
<table class="navigation" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_0_0.xsd">
    <tr>
        <t:loop source="pageNames" value="pageName">
            <td class="${tabClass}">
                <t:pagelink page="pageName">${pageName}</t:pagelink>
            </td>
        </t:loop>
    </tr>
</table> 
```

但是，如果我只想渲染 X 次而不需要传递任何参数，那就太矫枉过正了。对于这个用例，我真的期待像（伪代码）这样​​的东西：

```
<table class="navigation" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_0_0.xsd">
    <tr>
        <t:loop times="${x}">
            <!-- same markup every time -->
        </t:loop>
    </tr>
</table> 
```

但似乎不存在这样的东西——或者是吗？

现在我的解决方法是提供一个给出大小 X 的 List 的存根实现，并将其用作我的循环源：

班级：

```
private int x;

public List<Object> getX() {
    return new AbstractList<Object>() {
        public Object get(int arg0) {
            return null;
        }
        public int size() {
            return x;
        }
    };
} 
```

模板：

```
<t:loop source="x">
    <!-- same markup each time -->
</t:loop> 
```

但这很丑陋——肯定有更好的方法来做这么简单的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T16:23:29.707

这可以通过循环和挂毯的范围运算符来完成

```
Santa Claus said: <t:loop t:source="1..3">Ho</t:loop> 
```

[http://tapestry.apache.org/property-expressions.html](http://tapestry.apache.org/property-expressions.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T21:53:49.033

在模板中重复静态内容在我的世界中并不常见。如果它在你的，那么编写你自己的组件是有序的。

这是我的解决方案：[https ://gist.github.com/4402251](https://gist.github.com/4402251)

将其放入您的组件包中并像这样使用它：

```
 <t:repeat times="100">.</t:repeat>
 <t:repeat times="5" element="p">
     This is repeated 5 times...
 </t:repeat>

 <ul>
     <li t:type="repeat" times="3">Repeated 3 times</li>
 </ul> 
```

# clojure - 为什么 Clojure 允许 (eval 3) 尽管 3 没有被引用？

> ID：14048041
> 
> 赞同：8
> 
> 时间：2012-12-27T00:40:24.700
> 
> 标签：clojure, lisp, eval

我正在学习 Clojure，并试图通过与 Python 的类似功能进行比较来理解 reader、quoting、eval 和 homoiconicity。

在 Python 中，避免（或推迟）评估的一种方法是将表达式括在引号之间，例如。`'3 + 4'`. 您可以稍后使用 来评估它`eval`，例如。`eval('3 + 4')`屈服`7`。（如果您只需要引用 Python 值，您可以使用`repr`函数而不是手动添加引号。）

在 Lisp 中，您使用`quote`or`'`来引用和`eval`评估，例如。`(eval '(+ 3 4))`屈服`7`。

因此，在 Python 中，“引用”的内容由字符串表示，而在 Lisp 中，它由具有`quote`第一项的列表表示。

最后，我的问题是：为什么 Clojure 允许`(eval 3)`虽然`3`没有被引用？仅仅是 Lisp 风格的问题（尽可能给出答案而不是错误）还是背后有其他原因？这种行为对 Lisp 来说是否必不可少？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T00:53:06.083

简短的回答是数字（以及符号和字符串，例如）对自己进行评估。引用指示 lisp（读者）传递未评估的引用后面的任何内容。`eval`然后在您编写它时获取该列表，但没有引号，然后对其进行评估（在 的情况下`(eval '(+ 3 4))`，`eval`将评估两个参数的函数调用（`+`））。

最后一个表达式会发生以下情况：

1.  当您按 Enter 时，将评估表达式。它包含一个普通的函数调用 ( `eval`) 和一些参数。
2.  对参数进行评估。第一个参数包含一个引号，它告诉读者*生成*引号之后的内容（实际`(+ 3 4)`列表）。
3.  没有更多的参数，并评估实际的函数调用。这意味着`eval`使用*列表* `(+ 3 4)`作为参数调用函数。
4.  该`eval`函数再次执行相同的步骤，找到正常的函数`+`和参数，并应用它，获得结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T01:58:13.630

其他答案已经解释了机制，但我认为哲学点在于 lisp 和 python 看待“代码”的不同方式。在 python 中，将代码表示为字符串的唯一方法是，因此尝试评估非字符串当然会失败。Lisp 具有更丰富的代码数据结构：列表、数字、符号等。所以表达式`(+ 1 2)`是一个列表，包含一个符号和两个数字。评估列表时，您必须首先评估其每个元素。

因此，在运行 lisp 代码的普通过程中需要计算一个数字是非常自然的。为此，数字被定义为“对自己进行评估”，这意味着它们在评估后与之前相同：只是一个数字。该函数将相同的规则应用于编译器在编译时将应用`eval`的裸“代码片段” ，例如，较大表达式的第三个元素，如. 对于数字，这意味着不要管它。`3``(+ 5 3)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-27T01:30:48.313

应该`3`评估什么？Lisp 对自己评估一个数字是最有意义的。我们想要求在代码中引用数字吗？那将不是很方便并且非常成问题：

代替

```
(defun add-fourtytwo (n)
   (+ n 42)) 
```

我们必须写

```
(defun add-fourtytwo (n)
   (+ n '42)) 
```

代码中的每个数字都需要被引用。缺少报价会触发错误。这不是人们想要使用的东西。

作为旁注，想象一下当您想`eval`在代码中使用时会发生什么。

```
(defun example ()
  (eval 3)) 
```

上面会出错。需要引用数字。

```
 (defun example ()
   (eval '3)) 
```

上面可以，但是在运行时会产生错误。Lisp 的计算`'3`结果是数字 3。但是调用`eval`该数字将是一个错误，因为它们需要被引用。

所以我们需要写：

```
(defun example ()
   (eval ''3)) 
```

这不是很有用...

在 Lisp 的历史中，数字一直是自我评估的。但在早期的 Lisp 实现中，一些其他数据对象，如数组，不是自评估的。同样，由于这是一个巨大的错误来源，像 Common Lisp 这样的 Lisp 方言已经定义所有数据类型（除了列表和符号）都是自我评估的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-27T00:59:18.230

要回答这个问题，我们需要查看`eval`lisp 中的定义。例如，在[CLHS](http://www.ai.mit.edu/projects/iiip/doc/CommonLISP/HyperSpec/Body/fun_eval.html)中有定义：

> 语法：评估形式 => 结果*
> 
> 参数和值：形式 - 一种形式。
> 结果 - 评估形式产生的值。

`form`在哪里

> 1.  任何要评估的对象。
> 2.  一个符号、一个复合形式或一个自我评价的对象。
> 3.  （对于运算符，如`<<operator>> form'') a compound form having that operator as its first element.`引号形式是常量形式。''

在您的情况下，编号“3”是`self-evaluating object`. `Self-evaluating object`是`a form that is neither a symbol nor a cons is defined to be a self-evaluating object`。我相信对于clojure，我们可以在这个定义中替换`cons`为。`list`

在 clojure 中，仅`lists`被解释`eval`为函数调用。其他数据结构和对象被评估为自评估对象。

`'(+ 3 4)`等于`(list '+ 3 4)`。`'`（由读者转换为`quote`功能）只是避免评估给定的形式。所以在表达式`(eval '(+ 3 4))` `eval`中以列表数据结构`('+ 3 4)`作为参数。

# c++ - 如何处理 wxEVT_GRID_COL_SORT 事件以对网格进行排序？

> ID：14048043
> 
> 赞同：2
> 
> 时间：2012-12-27T00:40:51.517
> 
> 标签：c++, wxwidgets

我正在尝试对 wxGrid 进行排序。现在，[文档](http://docs.wxwidgets.org/trunk/classwx_grid.html)告诉我它不支持排序，但它确实会生成一个事件。该文档告诉我该事件被称为`wxEVT_GRID_COL_SORT`. 很公平！

现在，问题是我根本不知道如何让活动正常进行。我的框架有一个事件表，看起来像这样：

```
BEGIN_EVENT_TABLE(MainWindow, wxFrame)
EVT_BUTTON(XRCID("toevoegknop"), MainWindow::openAddWindow)
// A few other events that work
END_EVENT_TABLE() 
```

那里列出的事件已经很好地工作了。在我的 MainWindow 类中，我声明了一个函数：

```
void sortColumn(wxGridEvent& event); 
```

现在，我想添加所述`wxEVT_GRID_COL_SORT`事件。从我的角度来看，文档对我应该做什么并不是很清楚，所以我只是尝试通过将以下行添加到事件表来添加事件。

```
wxEVT_GRID_COL_SORT(MainWindow::sortColumn) 
```

引发语法错误，因此它是不正确的。我注意到其他事件刚刚从 EVT 开始，所以我尝试删除 wx，但我仍然不走运。

广泛搜索互联网将我带到了一个[pastebin帖子](http://pastebin.com/mJz8gvzE)，该帖子通过将以下行添加到框架的构造函数（在我的情况下为MainWindow）来处理事件

```
Grid->Connect(wxEVT_GRID_COL_SORT,(wxObjectEventFunction)&Frame::OnGridColSort); 
```

我是这样改编的（MainWindow 的几乎整个构造函数）

```
MainWindow::MainWindow(const wxString& title, const wxPoint& pos, const wxSize& size, Collection* library, MovieDB* database)
: wxFrame(), library_(library), database_(database) {
wxXmlResource::Get()->LoadFrame(this, NULL, _T("hoofdvenster"));

SetSize(size);
grid_ = (wxGrid *)FindWindowById(XRCID("filmtabel"));
// Irrelevant code removed, setting up the grid labels etc.

grid_->Connect(wxEVT_GRID_COL_SORT,(wxObjectEventFunction)&MainWindow::sortColumn);
} 
```

这引发了一个错误：

> 'wxEVT_GRID_COL_SORT' 未在此范围内声明

所以现在我不知道我还能尝试什么。请记住，我几天前才开始搞乱 wxWidgets，所以对任何 wxWidgets 用户来说微不足道的事情可能不适合我。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T03:44:59.863

看来您正在使用`wx 2.8.12`which 没有实现`wxEVT_GRID_COL_SORT`. 它已被添加，`wx 2.9`因此您必须获得最新的开发版本 ( `2.9.4`) 才能使用它。

但是，`wx 2.8`您可以相应地处理`wxEVT_GRID_LABEL_LEFT_CLICK`和调度事件以模拟事件。

要么将事件添加到事件地图，

```
EVT_GRID_CMD_LABEL_LEFT_CLICK(ID_GRID,Frame::OnGridLabelLeftClick) 
```

或在您的构造函数中连接它：

```
grid->Connect(wxEVT_GRID_LABEL_LEFT_CLICK,
    (wxObjectEventFunction)&Frame::OnGridLabelLeftClick); 
```

```
void Frame::OnGridColSort(wxGridEvent& event) {}
void Frame::OnGridRowSort(wxGridEvent& event) {}

void Frame::OnGridLabelLeftClick(wxGridEvent& event) {
    // GetCol and GetRow will return the index of the col/row label clicked
    event.Skip(); // the next handler will select col/row/everything, based
                  // on the label clicked; remove to prevent selection
    if( event.GetCol() >= 0 )
        OnGridColSort(event);
    else if( event.GetRow() >= 0 )
        OnGridRowSort(event);
    else
        ; // if both are -1, the upper left corner was clicked (select all)
} 
```

这将类似于`EVT_GRID_COL_SORT`.

# javascript - 更有效地检查是否设置了变量，然后设置它，或者只是不断地设置它？

> ID：14048044
> 
> 赞同：1
> 
> 时间：2012-12-27T00:41:04.847
> 
> 标签：javascript, performance, optimization

制作游戏……这样做更有效率？

```
if (37 in keysDown) { //left arrow
    if (sprite.state != 'left') sprite.state = 'left';
} 
```

或这个？

```
if (37 in keysDown) { //left arrow
    sprite.state = 'left';
} 
```

这是在我的游戏的更新函数中调用的（不断地，尽可能快）。

旁注：这是我的输入键检查代码。

```
//input
var keysDown = {};
window.addEventListener('keydown', function(e) {
    keysDown[e.keyCode] = true;
});
window.addEventListener('keyup', function(e) {
    delete keysDown[e.keyCode];
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T00:52:47.270

> “*我们应该忘记小的效率，大约 97% 的时间说：**过早的优化是万恶之源***。”

^([*http://c2.com/cgi/wiki?PrematureOptimization*](http://c2.com/cgi/wiki?PrematureOptimization))

这两种方式具有相同的复杂性，设置\更改四个字符变量不会成为您应用程序的瓶颈。

我在这里唯一关心的是您的代码的可读性，如果您想要`sprite.state`获得该值`left`，为什么需要检查以前的值是什么？
（哦，它节省了大约 20 位的带宽，这就像这里的性能提升......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T00:55:20.420

这样的事情不会比遍历键快得多吗？您可以非常快速地连续检查变量。

```
var keyleft=false;

window.onkeydown = keydown;
window.onkeyup = keyup;

function keydown(event)
{
    var keyCode = ('which' in event) ? event.which : event.keyCode;
    if (keyCode==37) keyleft=true;
}

function keyup(event)
{
    var keyCode = ('which' in event) ? event.which : event.keyCode;
    if (keyCode==37) keyleft=false;
} 
```

不保证这段代码会起作用，我忘记了如何在没有 jQuery 的情况下做事

# xcode - 无法启动“ " 获取进程任务失败 ?

> ID：14048051
> 
> 赞同：56
> 
> 时间：2012-12-27T00:42:06.180
> 
> 标签：xcode, ios6, build-error

使用 Xcode 4.5.2 并为 iOS4 或更高版本构建时，我在为我的设备构建时收到此消息（iOS 6.0.1 on 4s）。我关闭对话框，然后在我的设备上重新启动似乎可以工作的应用程序。我是iOS开发的新手，所以如果这是一个愚蠢的问题，我会提前道歉。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-06-20T09:07:34.313

我的问题是使用分发配置文件对应用程序进行签名，一旦我制作了开发配置文件，该应用程序就可以在 iPhone 上安装和运行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-11-28T09:12:42.083

答案似乎是“**您需要修复您的配置文件**”，但可能由于多种原因而发生，正如此处的其他答案所示。

就我而言，我没有将新设备添加到现有的开发人员配置文件中，所以我只是用新设备重新创建了配置文件，它就可以工作了！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-16T16:53:08.810

在我的情况下，我总是添加一个新的设备 ID，然后更新配置文件，下载并“在 Xcode 5 上安装它”。

要解决这个问题：

*   转到 Xcode>Preferences>Account Tab>Select Apple ID>View Details>Refresh Button（左下角）。
*   重新启动 Xcode。

再次启动应用程序，您将能够在设备中测试应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-27T21:48:06.427

以下是我的情况以及我如何解决问题：

*   我一直在将应用程序从 Xcode 运行到我的手机，一切都很好
*   我切换到不同的代码签名身份（我还必须更改捆绑名称以匹配）
*   我将应用程序运行到我的手机并收到错误消息。该应用程序会安装，但不会打开。
*   做了一堆东西，比如 Clean，close n open Xcode；从手机中删除应用程序。都没有好的效果。

解决方案：关闭手机。

巧合？我想不是。:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-13T19:15:44.307

X代码6：

只需为开发创建配置文件并将其分配给项目 -> 构建设置 -> 配置文件

对于上传，您必须更改分发配置文件的配置文件。

# runtime-error - 窗口 setBackGround：导致运行时错误

> ID：14048054
> 
> 赞同：0
> 
> 时间：2012-12-27T00:42:20.317
> 
> 标签：runtime-error, nswindow, setbackground

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T08:23:18.553

No, setBackground: did not cause the runtime errors.

In the paths code, the paths weren't being allocated and inited properly, although the project ran correctly until the setBackground: code was added. Strange!

I'm sorry I didn't enclose the paths code in my question because it was too long.

I found my mistakes by starting a new project and building it up slowly, a piece at a time.

# ios - 将 UIBarButton 项向下移动几个像素

> ID：14048059
> 
> 赞同：1
> 
> 时间：2012-12-27T00:43:22.580
> 
> 标签：ios, uibarbuttonitem

当按下某个按钮时，我有一个弹出窗口会在屏幕上滑动。

此视图具有与应用程序的其余部分不同的自定义外观。它也有一个 .xib 文件。我设法通过在 IB 的工具栏中添加 customClass 来更改标题背景颜色。我设法更改了标题文本的文本样式...我花了一些时间才弄清楚。我必须做的是从 IB 中的标题项目中创建一个 IBOutlet，然后在我的 m 中应用更改......就像这样

```
 - (void)customizeAppearance
{

//Sets custom text attribures for this views headers text

[_customNavText setTitleTextAttributes:
    [NSDictionary dictionaryWithObjectsAndKeys:
        [UIColor whiteColor], UITextAttributeTextColor,  //sets text color
        [UIColor blackColor], UITextAttributeTextShadowColor, //sets text shadow color
        [NSValue valueWithUIOffset:UIOffsetMake(0, 3)], UITextAttributeTextShadowOffset, //Moves drop shadow by its coordinates
        [UIFont fontWithName:@"Helvetica-Bold" size:27.0], UITextAttributeFont,nil]  //sets text font and size
    forState:UIControlStateNormal];

} 
```

一旦视图加载，这个函数就会被调用。所以我的文字只在这个视图上有自己的风格。伟大的。

所以，也许我越来越挑剔了，但现在我想将文本向下移动几个像素。

这就是我所做的，我在 customizeApperance 函数中添加了以下代码......

```
[[UIBarButtonItem appearance] setTitlePositionAdjustment:UIOffsetMake(25.0f, 25.0f) forBarMetrics:UIBarMetricsDefault]; 
```

但这做了一些有趣的事情，它不会将我的文本向下移动到我刚刚应用了这些样式的 UIBarButtonItem，而是移动导航栏上按钮的文本，例如取消按钮。

那么如何移动位于中间的 UIBarButtonItem ，其中包含导航标题的文本，而不是侧面按钮的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T19:17:27.973

我想你可能正在寻找：

```
[[UINavigationBar appearance] setTitleVerticalPositionAdjustment:1 forBarMetrics:UIBarMetricsDefault]; 
```

# ruby-on-rails - Rails 路线显示自定义路线上的操作

> ID：14048061
> 
> 赞同：0
> 
> 时间：2012-12-27T00:44:02.653
> 
> 标签：ruby-on-rails, ruby-on-rails-3, spree, rails-routing

我正在尝试将客户操作添加到我的一个资源中，因此我创建了一个自定义路线：

```
namespace :admin do
  resources :subscriptions

  match 'subscriptions/summary', :to => 'subscriptions#summary', :as => 'subscriptions_summary'

end 
```

在我的**rake 路线**中，我得到以下输出：

```
admin_subscriptions_summary        /admin/subscriptions/summary(.:format)                               spree/admin/subscriptions#summary 
```

现在的问题是，每当我尝试创建指向摘要操作的链接时，都会收到以下错误：

```
Missing template spree/admin/subscriptions/show 
```

为什么我的应用程序将显示操作与摘要操作混淆了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:06:40.607

```
namespace :admin do
  resources :subscriptions do
    collection do 
      get 'summary'
    end
  end
end 
```

解决了。

# java - 文字和动画

> ID：14048068
> 
> 赞同：0
> 
> 时间：2012-12-27T00:45:07.203
> 
> 标签：java, android, eclipse, animation, text

呃，我想在动画播放后显示我的文字。在这段代码中，它同时执行了动画和文本，那么我如何等到动画播放完之后再显示文本呢？或者如何在动画播放之前隐藏文本？

```
package com.example.magic8ballers;

import android.media.MediaPlayer;
import android.os.Bundle;
import android.app.Activity;
import android.graphics.drawable.AnimationDrawable;
import android.view.Menu;
import android.view.View;
import android.view.animation.Animation;
import android.view.animation.AnimationUtils;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

public class Magic8Ballers extends Activity {
    MediaPlayer song; //song reference
    TextView answer; // TextView reference
    Button button; // Button reference
    Magic8BallersCode m8b; // M8B reference
    // Animation object
    Animation an;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_magic8_ballers);

        // associate answer with TextView object with id textView1
        answer = (TextView) findViewById(R.id.textView1);
        // associate button with Button object with id button
        button = (Button) findViewById(R.id.button1);
        button.setText("Shake It!");
        //Create new Magic8Ball object
        m8b = new Magic8BallersCode();
        song = MediaPlayer.create(Magic8Ballers.this, R.raw.magic);

        //Shake it button animation
        Button button = (Button) findViewById(R.id.button1);//reference to the        
        button that shakes it and provides prediction
        final ImageView imgView =
                (ImageView) findViewById(R.id.imageView1);//reference to the animation image

        //Music Buttons                                                     
        Button btnSound = (Button) findViewById(R.id.button2);//reference to the 
        button that turns on the song
        Button btnSound2 = (Button) findViewById(R.id.button3);//reference to the     
        button that turns off the song

        //Animation
        final Animation an = AnimationUtils.loadAnimation(Magic8Ballers.this,
                R.anim.animation);

        //Button for animation
        button.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                imgView.startAnimation(an);
                String prediction = m8b.getAnswer();
                // Set the label's text with the new prediction
                answer.setText(prediction);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:16:55.557

你需要添加一个动画监听器：

```
an.setAnimationListener(new Animation.AnimationListener() {

            public void onAnimationStart(Animation animation) {
                // TODO Auto-generated method stub

            }

            public void onAnimationRepeat(Animation animation) {
                // TODO Auto-generated method stub

            }

            public void onAnimationEnd(Animation animation) {

                // ADD YOU TEXT HERE
            }
        }); 
```

动画播放完毕后，听众会添加您的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:22:03.733

您可以尝试使用`setAnimationListener method`. “动画侦听器从动画接收通知。通知指示动画相关事件，例如动画的结束或重复。” ——“developer.android.com”。

*   **例子：**

    ```
     an.setAnimationListener( new AnimationListener()

    { 

        public void onAnimationStart(Aninmation a){
             //Notifies the start of the animation.
          }

        public void onAnimationRepeat(Animation a){
            //Notifies the repetition of the animation.
           }

        public void onAnimationEnd(Animation a){
            //Notifies the end of the animation.
            //show your text here
        }

    }); 
    ```

# java - heroku 应用程序中的端口和 url 错误

> ID：14048072
> 
> 赞同：0
> 
> 时间：2012-12-27T00:45:38.583
> 
> 标签：java, web-services, heroku, cloud, port

我做了一个发布 wsdl 文件的网络服务，这里是代码

```
Endpoint.publish("http://localhost:"+args[0]+"/main/webServ", new WebServiceImpl()); 
```

这是procfile

```
worker: java -cp target/classes:target/dependency/* com.example.Publisher $PORT 
```

日志文件中没有错误，我从那里得到了端口号，可以说它的“7435”。当我跑步时：

```
telnet whispering-beyond-3102.heroku.com 
```

我什么都没有

如何访问网络服务网址？，我试图去：

```
http://whispering-beyond-3102.heroku.com:7435/run/java/main/webServ?wsdl 
```

我没有输出

我应该使用什么网址

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T01:38:54.423

如果您要公开 Web 服务，您将希望`web`在您的`Procfile`而不是流程中定义一个`worker`流程。`$PORT`这将告诉 Heroku在应用程序启动时注入环境变量，并将 Web 请求路由到该端口上的应用程序。从 Internet 到您的应用程序的 Web 请求应该使用默认的 80（或 HTTPS 的 443），然后 Heroku 会将请求路由到您提供的应用程序上`$PORT`。一旦你修复了`Procfile`，你应该能够在（在默认端口 80 上）访问你的 Web 服务：

```
http://whispering-beyond-3102.heroku.com/run/java/main/webServ?wsdl 
```

# r - R编程学生newman keul用GAD包测试

> ID：14048073
> 
> 赞同：0
> 
> 时间：2012-12-27T00:46:02.663
> 
> 标签：r, analysis

我收到一个错误：

> “if (colnames(tm.class)[j] == "fixed") tm.final[i, j] = 0 中的错误：
> 需要 TRUE/FALSE 的地方缺少值”

我所做的只是一个简单的`snk.test(lm(values ~ factor1*factor2))`，并且估计函数不断返回此错误。我不确定是什么 tm。类是，但我不知道为什么列名似乎是 NA 无论评估函数正在测试。我是 R 的初学者，并不真正知道如何调试预先编写的函数。

**好的编辑：** 我的数据在一个文本文件中，它看起来像这样

变量 | 因素1 | 因子2
x1 | f1 | f2
x2 | f12 | f22
等（所有值都是小数）。

我所做的只是从文件中读取.table，然后调用`snk.test(lm(variable ~ factor1*factor2, data=data))`并获取上述错误消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:21:15.383

如果您使用的估计操作只涉及两个因素，那么您应该首先查看真实的数据布局。您没有包含足够的代码来知道数据框的名称是什么，我当然希望您没有犯下使用的巨大错误`attach`：

```
 with( datafrm , table( fac1, fact2) ) 
```

我的猜测是，您会发现一个或多个表，在这些表中估计`snk.test`可能正在测试的内容是没有意义的。

# jquery - jQuery Stacked Draggables：是否可以在每个堆叠的可拖动 div 之上保留一个 div？

> ID：14048076
> 
> 赞同：0
> 
> 时间：2012-12-27T00:46:42.547
> 
> 标签：jquery, stack, draggable

所以这是我正在使用的代码，我需要#div2、#div3 和#div4 保持在#div1 之下。

```
 $(function() {
    $( "#div2, #div3, #div4" ).draggable({ stack: "#div2, #div3, #div4" });
  }); 
```

我试过 z-index 但它没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:11:41.983

您可以使用`stop`event 循环遍历元素并调整 z-indexes

```
$( "#div2, #div3, #div4" ).draggable({

    stop: function() {
       /* adjust z-indexes here*/
    }

}) 
```

# cakephp - Cakephp继承模型关联

> ID：14048079
> 
> 赞同：-1
> 
> 时间：2012-12-27T00:47:21.923
> 
> 标签：cakephp, inheritance, model-associations

如果我创建一个具有一些关联的模型车： hasOne Driver hasMany Wheel 然后创建一个模型卡车扩展 Car

```
class Truck extends Car { ... } 
```

来自 Car 的关联不继承自 Truck 是否正常？继承模型关联的可能性是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:35:13.877

继承与PHP相关；无论 cakephp 中的任何内容如何，​​您的自定义类都会以相同的方式运行。CakePHP 中的类继承完全取决于类的编写方式。继承是cakephp的重要组成部分；该框架非常面向对象。

您是否正确使用 App::uses() 将您的汽车类加载到卡车中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T10:02:41.143

The only way your `Truck` class will not inherit from the `Car` class is if you have defined the properties in the `Truck` class.

```
class Car extends AppModel {
    public $hasOne = array('Driver', ...);
}

class Truck extends Car {
    public $hasOne = array(); // now you have no hasOne relations
} 
```

# android - setText 出错：“只有原始线程 .. 可以触摸它的视图”

> ID：14048080
> 
> 赞同：1
> 
> 时间：2012-12-27T00:47:32.357
> 
> 标签：android

当我想将 setText 设置为 textView 时，应用程序强制关闭并给我这个错误：

> android.view.ViewRootImpl$CalledFromWrongThreadException：只有创建视图层次结构的原始线程才能接触其视图。

这是我的代码的一部分：

```
Thread ThreadRecording = new Thread(new Runnable() {
    public void run() {
        while(recorder)
        {
            if (body_num = 10)
            {
                TextView loog = (TextView)findViewById(R.id.textView1);
                loog.setText("Total : 10, Thank you");
            }
        }
    }
});
ThreadRecording.start(); 
```

有一个按钮；如果用户点击它，它会调用一个函数来设置`body_num = body_num + 1`，线程检查 body_num == 10

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T01:01:22.163

> 只有创建视图层次结构的原始线程才能接触其视图

因为只有使用 UI（主）线程，您才能操作视图。您可以使用 Hanlder 来更新您的视图。

Handler有两个主要用途：

1.  安排消息和可运行文件在未来某个时间点执行；和
2.  将要在与您自己的线程不同的线程上执行的操作排入队列。当为您的应用程序创建一个进程时，其主线程专用于运行一个消息队列，该队列负责管理顶级应用程序对象（活动、广播接收器等）以及它们创建的任何窗口。您可以创建自己的线程，并通过 Handler 与主应用程序线程进行通信。这是通过调用与以前相同的 post 或 sendMessage 方法来完成的，但来自您的新线程。给定的 Runnable 或 Message 将被安排在 Handler 的消息队列中，并在适当的时候进行处理。”
    ——来自“developer.android.com”

**例子：**

背景线：

```
new Thread() {

public void run() {
    while(recorder)
        {
            if (body_num = 10)
            {                
                messageHandler.sendEmptyMessage(0);
            }
        }
   }

}.start(); 
```

您放在主线程中的处理程序：

```
private Handler messageHandler = new Handler() {

public void handleMessage(Message msg) {
             //update your view here
   }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T00:57:34.293

只能在UI线程中修改视图，需要用到Handler，比如，

```
Handler h = new Handler(context.getMainLooper()) {
    public void handleMessage(Message msg) {
        TextView loog = (TextView)findViewById(R.id.textView1);
        loog.setText(msg.obj);
    }
};

Thread ThreadRecording = new Thread(new Runnable() {
    public void run() {
        while(recorder)
        {
            if (body_num = 10)
            {
                Message message = new Message();
                message.obj = "Total : 10, Thank you";
                handler.sendMessage(message);
            }
        }
    }
});
ThreadRecording.start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-16T16:07:30.307

这也可以通过使用 AsyncTask 来实现。下面是在 TextView 中设置字符串资源 (R.string.your_text) 的示例代码：

```
public class CommonSetText extends AsyncTask<Void, Void, Integer> {
private WeakReference<TextView> textView;
private int stringID;

public CommonSetText ( TextView textView, Integer stringID) {
    this.textView = new WeakReference<>(textView);
    this.stringID = stringID;
}

@Override
protected Integer doInBackground ( Void... voids ) {
    return stringID;
}

@Override
protected void onPostExecute ( Integer stringID ) {
    super.onPostExecute ( stringID );
    textView.get ().setText ( stringID );
}
} 
```

然后使用以下代码将文本设置为文本视图：

```
new CommonSetText ( textView, R.string.your_text ).execute (  ); 
```

# android - EndlessAdapter 重试按钮

> ID：14048081
> 
> 赞同：0
> 
> 时间：2012-12-27T00:48:06.087
> 
> 标签：android, commonsware-cwac

我使用 EndlessAdapter 有一段时间了，但我无法在挂起的视图上实现重试按钮功能。在 Play Store 中，当我们加载额外的数据并且有网络连接时，待处理的视图变成了一个带有重试按钮的文本视图。

我想使用 Commonsware 中的 EndlessAdapter 来执行此操作，但我不能这样做，因为它会在出现异常时隐藏待处理的行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T12:07:14.443

FWIW，我从未见过您从 Play 商店引用的行为。如果没有网络连接，它不会显示列表。

您的“重试”按钮需要成为常规行的一部分，而不是在待处理视图中，这样它才有希望与`EndlessAdapter`. 您可能需要推出自己的“无尽”构造，以考虑您对该重试功能的需求。

# java - GUI 未按预期显示

> ID：14048084
> 
> 赞同：3
> 
> 时间：2012-12-27T00:48:57.510
> 
> 标签：java, swing, layout, layout-manager, jtextarea

我正在尝试绘制如图所示的 gui，但不知何故我无法将对象放置在正确的位置（我猜问题出在布局上） textArea 应该在中间。 . 但根本没有显示

![在此处输入图像描述](../Images/b7d3deecdd918d1511aea5831a2a5d4a.png)

```
package Chapter22Collections;
import javax.swing.*;
import java.awt.*;

public class Exercise226 extends JFrame {
    private JButton jbSort;
    private JButton jbReverse;
    private JButton jbAdd;
    private JButton jbShuffle;
    private JLabel jlAddnum;
    private JTextArea jTextDisplay;
    private JTextField jTextAdd;

    public Exercise226() {
        jbSort = new JButton("Sort");
        jbReverse = new JButton("Reverse");
        jbShuffle = new JButton("Shuffle");
        jbAdd = new JButton("Add");
        jlAddnum = new JLabel("Add number here: ");
        jTextDisplay = new JTextArea();
        jTextAdd = new JTextField(8);

        setLayout(new BorderLayout());

        JPanel p1 = new JPanel(new GridLayout(1,3));
        p1.add(jlAddnum);
        p1.add(jTextAdd);
        p1.add(jbAdd);

        JPanel p2 = new JPanel(new GridLayout(1,3));
        p2.add(jbSort);
        p2.add(jbReverse);
        p2.add(jbShuffle);

        add(p1, BorderLayout.NORTH);
        add(jTextDisplay, BorderLayout.CENTER);    
        add(p2, BorderLayout.SOUTH);
    }

    public static void main(String... args) {

        Exercise226 gui = new Exercise226();
        gui.setTitle("Numbers");
        gui.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        gui.setSize(300, 200);
        gui.setLocationRelativeTo(null);
        gui.setVisible(true);   

    }     
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T00:58:48.010

这`JTextArea`实际上是您期望的位置，但没有轮廓边框。通常将组件放在 a`JScrollPane`中会产生这种效果：

```
add(new JScrollPane(jTextDisplay), BorderLayout.CENTER); 
```

或者干脆

```
add(new JScrollPane(jTextDisplay)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T02:01:54.797

要`textArea`使用窗口重新调整大小，请尝试[`BoxLayout`](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html). `Box`是“使用`BoxLayout`对象作为其布局管理器的轻量级容器”。

```
Box p1 = new Box(BoxLayout.X_AXIS); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-27T02:46:24.440

> 如何在框架中的元素之间添加间距/填充？所以文本区域更加明显和居中。

边框和填充。例如

![练习 226-with-padding-and-borders](../Images/d7a41c788077cccc0ef140d60d4bcb29.png)

和....相比：

![练习226](../Images/2f9535418f33eeb4ae23f2a0a485f409.png)

```
import javax.swing.*;
import java.awt.*;
import javax.swing.border.EmptyBorder;
import javax.swing.border.TitledBorder;

public class Exercise226 {
    private JButton jbSort;
    private JButton jbReverse;
    private JButton jbAdd;
    private JButton jbShuffle;
    private JLabel jlAddnum;
    private JTextArea jTextDisplay;
    private JTextField jTextAdd;

    private JPanel gui;

    public Exercise226() {
        gui = new JPanel(new BorderLayout(5,5));
        jbSort = new JButton("Sort");
        jbReverse = new JButton("Reverse");
        jbShuffle = new JButton("Shuffle");
        jbAdd = new JButton("Add");
        jlAddnum = new JLabel("Add number here: ");
        // set the size constraints using columns/rows
        jTextDisplay = new JTextArea("Here I am!", 6,20);
        jTextAdd = new JTextField(8);

        JPanel p1 = new JPanel(new GridLayout(1,3,3,3));
        p1.add(jlAddnum);
        p1.add(jTextAdd);
        p1.add(jbAdd);

        JPanel p2 = new JPanel(new GridLayout(1,3,3,3));
        p2.add(jbSort);
        p2.add(jbReverse);
        p2.add(jbShuffle);

        JPanel textAreaContainer = new JPanel(new GridLayout());
        textAreaContainer.add(new JScrollPane(jTextDisplay));
        textAreaContainer.setBorder(new TitledBorder("Text Area Here"));

        gui.add(p1, BorderLayout.PAGE_START);
        gui.add(textAreaContainer, BorderLayout.CENTER);    
        gui.add(p2, BorderLayout.PAGE_END);

        gui.setBorder(new EmptyBorder(4,4,4,4));
    }

    public Container getGui() {
        return gui;
    }

    public static void main(String... args) {
        JFrame f = new JFrame();

        Exercise226 gui = new Exercise226();
        f.setContentPane(gui.getGui());
        f.setTitle("Numbers");
        f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        f.pack();
        f.setLocationByPlatform(true);
        f.setVisible(true);   

    }     
} 
```

这段代码：

*   `int`主要在 GUI 中使用不同的构造函数为接受 2 个水平和垂直间距参数的布局提供“空白空间” 。
*   还添加了 2 个边框：
    1.  整个 GUI 周围的空白边框，以在它和框架装饰之间提供一些间距。
    2.  文本区域周围的标题边框，使其*非常*明显。
*   是否对原始代码的一个不必要的部分进行了更改。它不是扩展框架，而是简单地保留一个实例。
*   正如@Reimeus 所建议的那样，使用文本区域的`JScrollPane`容器。它为不需要滚动条的元素添加了一个漂亮的斜角边框。
*   专门创建一个`textAreaContainer`，以便我们可以设置一个带标题的边框来围绕滚动窗格 -*而不会*干扰其现有边框。
    可以将 a`CompoundBorder`用于由现有边框 ( `scroll.getBorder()`) 和标题边框组成的滚动窗格。然而，按钮和其他元素可能会改变选择或操作的边界，这会变得复杂。因此，要为屏幕元素（如此处的文本区域）设置“最外层边框”——我通常更喜欢先将整个组件包装在另一个容器中。
*   不在 EDT 上创建和显示 GUI。应在 EDT 上创建和修改 Swing GUI。留给用户作为练习。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

## 旧代码

这个答案的原始代码提供了上面看到的“比较 GUI 图像”。IT 与原始代码密切相关，但文本区域包裹在滚动窗格中（并因此获得斜角边框）并给出了一些要显示的文本。

![练习226](../Images/2f9535418f33eeb4ae23f2a0a485f409.png)

```
import javax.swing.*;
import java.awt.*;

public class Exercise226 extends JFrame {
    private JButton jbSort;
    private JButton jbReverse;
    private JButton jbAdd;
    private JButton jbShuffle;
    private JLabel jlAddnum;
    private JTextArea jTextDisplay;
    private JTextField jTextAdd;

    public Exercise226() {
        jbSort = new JButton("Sort");
        jbReverse = new JButton("Reverse");
        jbShuffle = new JButton("Shuffle");
        jbAdd = new JButton("Add");
        jlAddnum = new JLabel("Add number here: ");
        // set the size constraints using columns/rows
        jTextDisplay = new JTextArea("Here I am!", 6,20);
        jTextAdd = new JTextField(8);

        setLayout(new BorderLayout());

        JPanel p1 = new JPanel(new GridLayout(1,3));
        p1.add(jlAddnum);
        p1.add(jTextAdd);
        p1.add(jbAdd);

        JPanel p2 = new JPanel(new GridLayout(1,3));
        p2.add(jbSort);
        p2.add(jbReverse);
        p2.add(jbShuffle);

        add(p1, BorderLayout.NORTH);
        add(new JScrollPane(jTextDisplay), BorderLayout.CENTER);    
        add(p2, BorderLayout.SOUTH);
    }

    public static void main(String... args) {

        Exercise226 gui = new Exercise226();
        gui.setTitle("Numbers");
        gui.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        //gui.setSize(300, 200);
        gui.pack();
        //gui.setLocationRelativeTo(null);
        gui.setLocationByPlatform(true);
        gui.setVisible(true);   

    }     
} 
```

# php - 链接后在上一页回显文本？

> ID：14048086
> 
> 赞同：-1
> 
> 时间：2012-12-27T00:49:07.057
> 
> 标签：php, mysql, hyperlink

基本上我在用户个人资料页面上有一个最喜欢的图标。另一个用户可以按下此按钮，它将链接到收藏夹.php，它将执行 sql 查询以将该用户添加到数据库中。

然后，这会使用户停留在面临空白页面的 favorites.php 上。我希望 favorites.php 做的是在处理完查询后回显一段文本，上面写着用户添加到上一页 profile.php 上的收藏夹。但我不能简单地将它们重定向到 profile.php 使用标题，因为每个用户配置文件都有一个像 profile.php?id=13 这样的 id 扩展名，他们将点击该用户配置文件。

所以我的问题是我可以使用标题重定向到他们所在的上一页（特定于 url），以便他们最初与相应的用户 id 相同。可以这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:02:06.060

如今，这种 UI 交互通常通过 AJAX 调用来完成。

当用户点击收藏图标时，该页面上的一些 javascript 将在后台调用 favorites.php。Favorites.php 然后会发出 SQL 调用并返回一些 json（使用 json_encode()）来告诉您的 Javascript 代码 SQL 是否成功。然后，您的 javascript 会做出相应的反应并更新 UI。

jQuery 是完成此任务的一种非常常用的方法，因此我建议[您快速在 Google 上搜索“jquery ajax tutorial”](https://www.google.com/search?hl=en&q=jquery%20ajax%20tutorial&aq=f&oq=)。

如果您绝对必须支持没有 javascript 的浏览器，则另一种方法是让 favorites.php 查看引用：

```
<?php
//do important stuff here
http_redirect($_SERVER['HTTP_REFERER']);
?> 
```

但是，php 的手册表明[HTTP_REFERER 不可靠](http://php.net/manual/en/reserved.variables.server.php)，因此您仍然可能会出错。阿贾克斯为胜利。

# node.js - 在 Express 中 Mongoose 验证失败后如何向客户端返回错误消息

> ID：14048089
> 
> 赞同：1
> 
> 时间：2012-12-27T00:49:41.147
> 
> 标签：node.js, express, mongoose

我有一个非常基本的 POST 路由，可以根据给定的数据创建一个新用户。

这是我保存它的方法：

```
app.post('/create', function(req, res){
    var firstUser = new models.User(req.body);
    firstUser.save();
}); 
```

我的 Mongoose 用户模式有一些验证选项，它们有效。如果我传递了错误的数据，验证将失败并且不会创建用户。

但是有一个问题：Mongoose的save()函数是异步的，那我现在怎么让客户端验证失败呢？

届时将完成 post 功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T01:16:32.883

你应该看看[Mongoose 文档](http://mongoosejs.com/docs/models.html)。因为 save 方法是异步的，所以它需要一个回调作为参数。这是您应该检查错误的地方。

```
app.post('/create', function(req, res){
    var firstUser = new models.User(req.body);
    firstUser.save(function (err) {
        if (err) {
            res.send(500, { error: 'Saving first user failed!' });
        } else {
            res.send({ success: 'Saved!' }); 
        }
    })
}); 
```

# animation - openlaszlo 按钮和 Radiogroup 干扰

> ID：14048090
> 
> 赞同：2
> 
> 时间：2012-12-27T00:49:47.337
> 
> 标签：animation, openlaszlo

我是一个 openlaszlo 初学者，我想创建一个交互式 Web 界面来模拟 vomplex 天文钟的指示。应该可以输入例如坐标和日期/时间或选择实时或延时模式。

我尝试使用edittext 字段和按钮以及单选按钮组来选择信息，然后根据选择移动图像。当我只使用 edittext 字段和按钮时，它就可以工作。文本条目显示在输出的edittext字段中，图像真正旋转了给出的弧线。当我添加单选按钮组时，选定的弧线会显示在输出的编辑文本字段中，但不会发生图像旋转。有人可以帮忙吗？

这是代码

```
<canvas>
<!-- Load of the image -->
<view name="Zeiger" x="100" y="100" resource="images/Kal_Ring_Stundenzeiger.gif" id="HandID">
  <!-- Methode to rotate the image, Arc is set by the argument -->
  <method name="rotate" args="Arc">
      var increment = 0 + Arc;
  var dur = 700;
  this.animate('rotation',increment,dur);
  </method>
</view>

<!-- Control unit -->
<view name="Bedienung" x="200" y="10">
  <simplelayout axis="y" inset="8"/>  

  <text text="Output:"/>
  <edittext id="outputID" text = "0"/>     

  <text text="Arc:"/>
  <edittext id="WinkelID" text = "51"/>

  <button x="000" y="160"> 
    Rotation
    <!-- Handler to execute the Method  -->
    <handler name="onclick">
        var x = WinkelID.getText();
        HandID.rotate(x);
        outputID.setAttribute('text',x);
    </handler>
  </button>
  <!-- when I remove the radiogroup, then the image rotates -->
  <radiogroup id="group1ID">
    <handler name="onselect">
      var Arcchoice = this.getValue();
      HandID.rotate(Arcchoice);
      outputID.setAttribute('text',Arcchoice);
    </handler>
    <radiobutton value="0" text="0°" selected="true"/>
    <radiobutton value="90" text="90°"/>
    <radiobutton value="180" text="180°"/>
    <radiobutton value="270" text="270°"/>
    <radiobutton value="360" text="360°"/>
  </radiogroup>
</view>

</canvas> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:09:57.143

我已经使用 OpenLaszlo 5.0 主干测试了代码，它在 SWF10 和 DHTML 运行时中都按预期工作。

这是应用程序的屏幕截图，其中包含来自 LzClock 小部件的资源（没有可用于测试的 SWF 资源）。我已在文本字段中输入弧值并单击按钮设置旋转。

![在此处输入图像描述](../Images/93e7e07c35be1b5179b125f1df762ed9.png)

我已经在 Linux 上使用 Chrome 和 Firefox 进行了测试，还没有在 Windows 上进行测试。

# sql - COUNT DISTINCT with CONDITIONS

> ID：14048098
> 
> 赞同：135
> 
> 时间：2012-12-27T00:51:36.313
> 
> 标签：sql

我想根据特定条件计算列中不同项目的数量，例如，如果表是这样的：

```
tag | entryID
----+---------
foo | 0
foo | 0
bar | 3 
```

如果我想将不同标签的数量计为“标签计数”，并将条目 id > 0 的不同标签的数量计为同一张表中的“正标签计数”，我该怎么办？

我现在从两个不同的表中计数，在第二个表中我只选择了那些 entryID 大于零的行。我认为应该有一个更紧凑的方法来解决这个问题。

* * *

## 回答 #1

> 赞同：327
> 
> 时间：2012-12-27T00:58:10.320

你可以试试这个：

```
select
  count(distinct tag) as tag_count,
  count(distinct (case when entryId > 0 then tag end)) as positive_tag_count
from
  your_table_name; 
```

第一个`count(distinct...)`很容易。第二个，看起来有些复杂，实际上和第一个一样，只是你使用了`case...when`从句。在该`case...when`子句中，您只过滤正值。零或负值将被评估为`null`并且不会包含在计数中。

这里要注意的一件事是，这可以通过阅读表格一次来完成。当您似乎必须阅读同一张表两次或更多次时，实际上可以通过阅读一次来完成，在大多数情况下。因此，它将以更少的 I/O 更快地完成任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T01:01:28.770

这可能有效：

```
SELECT Count(tag) AS 'Tag Count'
FROM Table
GROUP BY tag 
```

和

```
SELECT Count(tag) AS 'Negative Tag Count'
FROM Table
WHERE entryID > 0
GROUP BY tag 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-04T15:24:01.257

试试下面的语句：

```
select  distinct A.[Tag],
     count(A.[Tag]) as TAG_COUNT,
     (SELECT count(*) FROM [TagTbl] AS B WHERE A.[Tag]=B.[Tag] AND B.[ID]>0)
     from [TagTbl] AS A GROUP BY A.[Tag] 
```

第一个字段将是标签，第二个字段将是整个计数，第三个字段将是正数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-03-02T13:44:16.653

当 [Entry Id]>0 时，代码计算 Tag 和 Entry ID 的唯一/不同组合

```
select count(distinct(concat(tag,entryId)))
from customers
where id>0 
```

在输出中它将显示唯一值的计数希望这会有所帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T01:12:46.243

这也可能有效：

```
SELECT 
    COUNT(DISTINCT T.tag) as DistinctTag,
    COUNT(DISTINCT T2.tag) as DistinctPositiveTag
FROM Table T
    LEFT JOIN Table T2 ON T.tag = T2.tag AND T.entryID = T2.entryID AND T2.entryID > 0 
```

您需要在左连接中而不是在 where 子句中使用 entryID 条件，以确保在第一个 DISTINCT 中正确计算任何只有 entryID 为 0 的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-06T15:20:37.933

我同意@ntalbs 解决方案，如果您想在另一列数据的条件有效时计算一列的数据，您可以这样做

```
select
  count(distinct tag) as tag_count,
  count(distinct tag, case when entryId > 0 then tag end) as positive_tag_count
from
  your_table_name; 
```

在第 3 行，我在 旁边添加了列名`distinct`，因此当 entryId 大于 0 时，它将计算不同的标签

# objective-c - 当 NSArray 有超过 2 个对象时，应用程序会崩溃

> ID：14048099
> 
> 赞同：2
> 
> 时间：2012-12-27T00:51:49.667
> 
> 标签：objective-c, nsarray, nsdictionary, nsnotificationcenter

所以我一直在使用`NSNotificationCenter`Xcode 并尝试`NSDictionary`使用`userInfo`.

```
NSArray *objects = [NSArray arrayWithObjects:@"Example Name", @"Example Description", @"Example Date", nil];
NSArray *keys = [NSArray arrayWithObjects:@"name", @"description", @"date", nil];
    NSDictionary *dict = [NSDictionary 
                               dictionaryWithObjects:objects 
                               forKeys:keys];
    [[NSNotificationCenter defaultCenter] postNotificationName:@"Notification" object:nil userInfo:dict]; 
```

当我尝试运行应用程序并发布通知时，它会在以下行崩溃：

```
NSArray *keys = [NSArray arrayWithObjects:@"name", @"description", @"date", nil]; 
```

后来我发现如果数组大小超过 2 个对象，应用程序就会崩溃。

因此，如果我将代码更改为下面的代码段，它将起作用。

```
NSArray *objects = [NSArray arrayWithObjects:@"Example Name", @"Example Description", nil];
NSArray *keys = [NSArray arrayWithObjects:@"name", @"description", nil];
NSDictionary *dict = [NSDictionary 
                                   dictionaryWithObjects:objects 
                                   forKeys:keys];
        [[NSNotificationCenter defaultCenter] postNotificationName:@"Notification" object:nil userInfo:dict]; 
```

有什么办法可以解决这个问题，还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T00:58:37.710

这段代码能编译吗？尝试清理和重建项目。

# jquery - $.get 本地主机上的 jquery url

> ID：14048104
> 
> 赞同：2
> 
> 时间：2012-12-27T00:52:21.193
> 
> 标签：jquery

为什么示例 1 中的 url 可以使用`$.get`，而示例 2 中的 URL 不能使用？有没有办法使示例二起作用？

# 示例一

```
$.get("http://localhost/magic/pages/tcgqueryoutput.php",
    function(data, statusTxt){
       $('#tcg_query_output').html(data);
    }); 
```

# 示例二

```
$.get("tcgqueryoutput.php",
    function(data, statusTxt){
       $('#tcg_query_output').html(data);
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:53:25.640

示例二基于当前的基本 url。因此，工作完全取决于您的 Web 应用程序的 url 路由/目录结构。

**编辑：**

在这种情况下，我想它正在尝试默认使用以下路由（假设该路由是从您的根目录定位的）：

`http://localhost/tcgqueryoutput.php`

因此，您需要在相对 url 中指定更多内容才能正确解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:12:33.557

在第一个示例中，您使用显式路径名。最佳实践应该是在生产中使用根目录中的显式路径名或完全限定路径。在我看来，您的第二种方法不起作用的原因是因为它从错误的位置推断路径名。它将采用当前语言环境，然后附加您拥有的 url。有几种可能性可以改变这一点。通常发生的情况是您将让服务器通过路径。

```
var serverPath = /*get value from server*/; 
```

但是，您也可以选择显式输入此值，

```
var serverPath = "http://mydomain.com/"; 
```

这将允许您将其用作基础：

```
$.get(serverPath + "magic/pages/tcgqueryoutput.php",
function(data, statusTxt){
   $('#tcg_query_output').html(data);
}); 
```

如果您从服务器传入了 serverPath，那么您将在 localhost 和生产环境中看到这项工作。如果您手动执行此操作，则需要将值从 localhost 更改为 mydomain.com。

# firefox - Firefox ADD-ON SDK：我可以使用带有 POST 方法的页面工作者吗？

> ID：14048112
> 
> 赞同：1
> 
> 时间：2012-12-27T00:53:20.170
> 
> 标签：firefox, post, firefox-addon-sdk

有没有办法将 POST 方法与 page-worker 一起使用？

我在文档中找不到任何有关设置请求方法的信息，并且在网上搜索也没有相关结果。我发现的唯一一件事是[如何在请求函数中使用 POST](https://stackoverflow.com/questions/7868175/how-to-use-post-in-request-function-at-firefox-addon-sdk)，但这给了我作为文本字符串而不是可用 DOM 的结果网页。

好吧，如果 POST 绝对不能与 page-worker 一起使用，那么解析这个文本将是一个 B 计划。但是一个非常丑陋的计划，所以我真的很感激不需要这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-10T18:40:51.877

如果我对您的理解正确，您想将帖子形式作为附加到页面的内容脚本吗？通常这不可能防止[跨站点脚本](https://en.wikipedia.org/wiki/Cross-site_scripting)攻击。我所做的是将需要从内容脚本发布的内容传递到附加脚本（[请参阅文档](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/dev-guide/guides/content-scripts/index.html)），并让附加脚本执行 POST[请求](https://addons.mozilla.org/en-US/developers/docs/sdk/latest/modules/sdk/request.html)。

# javascript - not :contains 不起作用

> ID：14048114
> 
> 赞同：0
> 
> 时间：2012-12-27T00:53:30.873
> 
> 标签：javascript, jquery

我做错什么了？当我运行此代码时，没有显示任何内容。

JavaScript 代码：

```
var currentTime = new Date()
var month = currentTime.getMonth() + 1
var day = currentTime.getDate()
var year = currentTime.getFullYear()

$(".whocares:not(:contains('' + month + '/' + day + '/'+ year + ''))").remove();​ 
```

和 HTML：

```
<div class="whocares">hi</div> <div class="whocares">12/26/2012 i like cake two</div> <div class="whocares">hi</div> 
```

[小提琴](http://jsfiddle.net/P3gYU/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T00:58:29.270

你的报价是错误的。它应该是这样的：

```
$(".whocares:not(:contains('" + month + "/" + day + "/"+ year+"'))").remove();​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T00:59:38.813

你的报价不正确。

```
$(".whocares:not(:contains('" + month + '/' + day + '/'+ year + "'))").remove();​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T01:00:03.170

在尝试包含变量时，请始终确保您正确地转义了字符串。如果您改用双引号，这很好用：

```
$(".whocares:not(:contains('" + month + "/" + day + "/" + year + "'))").remove();​​​​​​​​​​​​​​​​​​​​​​​ 
```

# php - PHP - 错误处理问题

> ID：14048115
> 
> 赞同：0
> 
> 时间：2012-12-27T00:54:19.753
> 
> 标签：php, error-handling, duck-typing

我有一些代码，用户可以通过数据库设置任意数量的数组元素。我是基于键名的鸭子类型函数，但并非所有键名都是要调用的对象，我不能保证键可以按静态顺序排列。代码与此类似：

```
$arr = get_arr_from_db();

foreach($arr as $key => $val){
    if($obj = new $key){
        unset($arr[$key]);

        $obj->give_data($arr);

        break;
    }
}

$obj->quack(); 
```

上面的代码不起作用，因为`$obj = new $key`会死。有什么办法可以防止上述循环在对象创建失败时死亡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:03:43.313

您可以`class_exists()`在尝试实例化之前使用，如果无法实例化，try/catch 块也会捕获任何错误。

```
foreach($arr as $key => $val){
  if(class_exists($key)){
    try {
        if($obj = new $key){
            unset($arr[$key]);

            if(method_exists($obj, 'give_data'){
                $obj->give_data($arr);
            }

            break;
        }
    } catch(Exception $e) {
        // do something with the exception
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T02:10:56.637

### 连载

[使用serialize](http://us1.php.net/manual/en/function.serialize.php)和[unserialize](http://us1.php.net/manual/en/function.unserialize.php)会更直接，它们将为您处理类初始化和类型检查。

例如：

```
$person = new Person();
$person->firstname = 'Chuck';
$person->lastname = 'Jones';

$blob = serialize($person); // put blob in the database 
```

### 序列化/反序列化接口

如果您想遵循该`give_data()`方法（例如，您的类属性与数据库中的列名匹配），您应该指定一个[interface](http://php.net/manual/en/language.oop5.interfaces.php)。接口保证您正在调用的类具有可用的 unserialize 方法并且它的行为方式符合您的预期（下面的示例使用工厂模式）：

```
<?php
interface ArraySerializable
{
    public static function createFromArray($array);
}

class Person implements ArraySerializable
{
    public static function createFromArray($array)
    {
        $temp = new self();
        $temp->firstname = $array['first_name'];
        $temp->lastname = $array['last_name'];
        return $temp;
    }
} 
```

然后你会测试[`class_implements()`](http://php.net/manual/en/function.class-implements.php)

```
$class_name = 'Person';

if (class_exists($class_name)
    && in_array('ArraySerializable', class_implements($class_name))
){
    $person = $class_name::createFromArray(array(
        'last_name' => 'Jones',
        'first_name' => 'Chuck'
    ));

    var_dump($person);
} 
```

要将其与更多类一起使用，您只需`ArraySerializable`为每个类实现接口。

如果你不想从头开始，你可以使用像[Doctrine](http://www.doctrine-project.org/)这样的全功能 ORM来完全抽象数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T01:07:52.047

最好使用[Reflector](http://php.net/reflection)类：

```
foreach($arr as $key => $val){
    $reflection = new ReflectionClass($key);
    if ($reflection->IsInstantiable()) {
        unset($arr[$key]);

        $obj = $reflection->newInstance();
        $obj->give_data($arr);

        break;
    }
} 
```

# php - 在 PHP / MySQL 查询中访问动态值

> ID：14048116
> 
> 赞同：1
> 
> 时间：2012-12-27T00:54:24.320
> 
> 标签：php, mysql

我正在从数据库表中获取一个值，然后根据第一个值获取另一个值。第一部分工作正常。我只是获取组织名称列表并将它们输出到列表中：

```
$org_name = mysql_query('SELECT org_name FROM Orgs_Teams GROUP BY org_name');
echo "<ul>";
while ($org_row = mysql_fetch_row($org_name)) {
echo "<li>{$org_row[0]}</li>";
}
echo "</ul>"; 
```

但这就是我卡住的地方。我现在需要获取每个组织内每个团队的名称。我正在使用一个包含两列的简单数据库表：org_name 和 team_name。

最终，我希望为我的导航菜单提供一个嵌套列表，如下所示（每个组织名称都会重复）：

*   组织名称 1
    *   团队名称 1
    *   团队名称 2
    *   团队名称 3

我一直在搞乱这样的不同查询：
$team_name_query = mysql_query('SELECT team_name FROM Orgs_Teams WHERE org_name = "$org_name" ');

但一直无法得到任何工作。我的想法是团队名称查询将进入“while”循环并创建嵌套列表，但我被卡住了。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:04:10.387

在您的团队表中有一个列，其中包含团队所属的组织 ID 并加入这些表。这可以一次为您提供所有数据

```
org_id   org_name
-------+---------
   1   |   Org 1
   2   |   Org 2

team_id    team_name    org_id
---------+------------+--------
    1    |   Team 1   |   1
    2    |   Team 2   |   1
    3    |   Team 3   |   2
    4    |   Team 4   |   2

$teams="SELECT * FROM Orgs
INNER JOIN Orgs_Teams USING (org_id)
WHERE org_id=1"; 
```

返回

```
org_id   org_name    team_id    team_name    org_id
-------+-----------+---------+------------+--------
    1  |   Org 1   |    1    |   Team 1   |   1
    1  |   Org 1   |    2    |   Team 2   |   1 
```

然后遍历结果以创建子列表元素，并使用来自第一个（或任何）结果的组织信息来创建父级。

```
echo '<ul><li>';
$i=0;
while ($row = mysql_fetch_row($teams)) {
    if ($i==0) echo $row['org_name'] .' <ul> ';
    echo '<li>' . $row['team_name'] .'</li>';
}
echo '</li></ul></li></ul>'; 
```

您可以使用不带 WHERE 子句的相同查询来获取所有组织和其中的团队，并在迭代时将当前 org_id 与前一个进行比较，以查看是否应该结束您正在填充团队的组织列表项并开始其他 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:07:33.593

您可以使用嵌套循环，因此在第一个循环的循环中执行第二个查询。另一种是将您的第一个查询的结果推送到一个数组中。然后，您可以循环数组并执行一系列查询。

```
$org_names = new array();
while ($org_row = mysql_fetch_assoc($org_name)) {
   $org_names = $org_row[];
}

echo "<ul>";
foreach($org_names as $name){
 // Do more queries
}
echo "</ul>"; 
```

同样正如刚才提到的，执行`JOIN`查询可以提取一个记录集中所需的所有数据。就像是：

```
SELECT A.org_name, B.team_name FROM Orgs_Teams AS A JOIN Orgs_Teams AS B ON A.org_id = B.org_id WHERE A.org_name = '$org_name'; 
```

# java - 文件输入流在编译器中工作正常，但在构建后不工作

> ID：14048117
> 
> 赞同：0
> 
> 时间：2012-12-27T00:54:31.143
> 
> 标签：java, audio, netbeans, classloader, jlayer

我正在尝试使用我刚刚发现的简洁库（JLayer）播放 mp3 文件，并且在使用以下代码编译（在 Netbeans 中）时它工作正常：

```
ClassLoader cl = this.getClass().getClassLoader();
url = cl.getResource("music/45.mp3");
pin = new FileInputStream(url.getFile());
p = new Player(pin);
p.play(); 
```

我构建了我的项目并尝试运行可执行 jar。我扩展了 JFrame，所以我可以直观地看到我的程序正在运行。执行时会出现 Frame，但没有声音。我虽然使用类加载器可以解决这个问题，但没有运气。帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T00:56:17.203

`FileInputStream`当您有可能在 jar 文件中的资源时不要使用- 使用`ClassLoader.gerResourceAsStream`或`Class.getResourceAsStream`. 这就是他们的目的。您在磁盘上没有*单独*的文件，因此尝试使用它是没有意义的`FileInputStream`。

（当然，您也可能*发现*您没有正确提供资源 - 但这是一个单独的问题。）

所以只需使用：

```
Player p = new Player(getClass().getResourceAsStream("/music/45.mp3"));
p.play(); 
```

（从您的代码看来，您声明变量的时间比您需要的早得多 - 或者甚至可能在逻辑上应该只是局部变量时将它们声明为字段。值得关注。确保您只使用当您真的想指示类或实例的某些状态时，请尽可能晚地声明局部变量 - 理想情况下是在初始化时。）

# django - django 如何在不进行过多查询的情况下检查该应用程序上是否已经存在用户？

> ID：14048118
> 
> 赞同：0
> 
> 时间：2012-12-27T00:54:33.210
> 
> 标签：django, django-queryset

假设这些是 django 模型：

```
class Question():

    question = charfield()
    choice = charfield(choices = answer_choice)

class Answer():

    question = models.foreignkey(Question, related_name = 'answers')
    answerer = models.foreignkey('auth.User')
    answer = models.charfield() 
```

我正在构建一个页面，其中显示 100 个问题，每个问题都`User`可以回答，但不能更改每个问题的答案。对于每个问题，我必须检查是否`User`已经存在`Answerer`。然后我制作模板标签：@register.filter def this_user_exists(user,obj): obj = obj.answers.filter(answerer_id = user.id) return obj

然后在模板上：

```
# obj is list of question
{% if not user|this_user_exists:obj %}
    # can answer
{% else %}
    # cannot answer
{% endif %} 
```

问题是，对于每个问题，它会生成 1 个查询，因此对于 100 个问题，它将生成 100 个查询。我试过这个查询来生成问题`Question.objects.all()` ，`Question.objects.prefetch_related('answers')`但仍然有问题。有没有更好的方法来实现这一点而无需进行太多查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:06:46.227

为了减少查询，您可以先查询出您需要的答案，然后获取所有相关的答案，

```
answers = Answer.objects.select_related('answerer').filter(xxxx)

# fetch related user id's
userids_in_answer = [answer.answerer.id for answer in answers]

# fetch user ids
user_id_set = set(User.objects.filter(id__in=userids_in_answer).values('id', flat=True) 
```

之后，您可以通过以下方式轻松知道用户是否存在，

```
for answer in answers:
  if answer.answerer.id in user_id_set:
      xxx 
```

查询数量减少，您可以检查这是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:06:52.743

在您看来：

```
answered_ids = [ans.question_id for ans in Answer.objects.filter(answerer=request.user)] 
```

在您的模板中：

```
{% if not obj.id in answered_ids %}
    # can answer
{% else %}
    # cannot answer
{% endif %} 
```

# django - Django 模型定义竞赛

> ID：14048125
> 
> 赞同：0
> 
> 时间：2012-12-27T00:55:23.277
> 
> 标签：django

您如何处理模型 (A) 依赖于定义的模型 (B)，但模型 (B) 也依赖于定义的模型 (A) 的情况。

例如，我有

```
class event(models.Model):
    competition_start = models.DateField() 
    competitors = models.ManyToManyField(picture)
    results = models.CommaSeparatedIntegerField(max_length=20)

class picture(models.Model):
    uploader = models.OneToOneField(UserProfile)
    upload_date = models.DateField()
    image = models.ImageField(upload_to="media")
    score = models.DecimalField(max_digits=10,decimal_places=10)
    score_RD = models.DecimalField(max_digits=10,decimal_places=10)
    rated = models.BooleanField()
    last_competed = models.DateField() 
    competition = models.OneToOneField(event) 
```

竞争者领域依赖于定义的图片，但图片依赖于定义的事件。

请注意，每张图片 (A) 与一个事件共享一对一的关系，但该事件可以涉及多个其他图片（集合（S）-A）。

我试着换成推杆

```
competitors = models.ManyToManyField(picture) 
user_pic = models.OneToOneField(picture) 
```

在事件内部并摆脱“竞争”领域，但我相信 SQL 不允许这样做。有人可以解释为什么吗？

如果我需要一个字段的 OneToOne 关系和另一个字段的 ManyToMany 关系，我应该执行什么修复？（在两个相同的班级之间）

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:58:23.017

您可以将类名的字符串传递给定义`OneToOne`并`ForeignKey`让它“懒惰地”评估。

```
competitors = models.ManyToManyField('picture') 
```

此外，模型类名称的约定是驼峰式（例如，'picture' => 'Picture'，'event' => 'Event'）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T00:59:11.973

```
class event(models.Model):
  competition_start = models.DateField() 
  competitors = models.ManyToManyField('MODULE.picture')
  results = models.CommaSeparatedIntegerField(max_length=20)
  ... 
```

此外，根据定义，您不能同时拥有一对一和多对多。我认为您希望 Picture 类上的关系是外键而不是一对一的。

# logging - 使用企业库日志记录到 Azure SQL？

> ID：14048132
> 
> 赞同：1
> 
> 时间：2012-12-27T00:56:41.860
> 
> 标签：logging, enterprise-library, azure-sql-database

我正在尝试让 Enterprise Library 5.0 日志记录到 Azure SQL。我认为我的 .config 还可以，但我正在尝试使用 EntLib 5.0 ( `\EntLib50Src\Blocks\Logging\Src\DatabaseTraceListener\Scripts\`)附带的脚本设置 SQL 表和存储过程

由于脚本很长，我已将[其上传到此处](http://pastebin.com/4T4GURPr)（与有问题的嵌入相比）

不幸的是，该脚本是 EntLib 团队在 2005 年编写的，从未更新或维护。随后，许多命令不适用于 Azure SQL 甚至 SQL Server 2012。我在 SQL Server 2012 上遇到的错误是

`Could not find stored procedure 'sp_dboption'.`

是否有用于为 Azure SQL 设置表和存储过程的更新脚本？此外，如果您正在登录 Azure SQL，将不胜感激您分享您的脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T05:45:39.303

可能正式正确的答案是从[Microsoft Enterprise Library 5.0 Integration Pack for Windows Azure](http://www.microsoft.com/en-us/download/details.aspx?id=28189)下载 EnterpriseLibraryIntegrationPack-WindowsAzure-sqlscripts.exe 。解压后，它包含企业库所需的所有 SQL 脚本，这些脚本由 Patterns & Practices 团队修改以使用 SQL Azure。

我将在下面留下我的原始答案，因为它与提供的脚本几乎相同。

为数据库日志记录提供的脚本适用于 SQL Server。 [SQL Azure 不支持 sp_dboption 存储过程](http://msdn.microsoft.com/en-us/library/windowsazure/ee336237.aspx)。

基本上，您真正需要的只是 Category、CategoryLog 和 Log 表以及 AddCategory、WriteLog 和 InsertCategoryLog 存储过程。

首先创建 Logging 数据库（使用门户或通过运行脚本）：

```
CREATE DATABASE [Logging]
(MAXSIZE=1GB,
EDITION='web');
GO 
```

如果您删除不受支持的语句，脚本将如下所示：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[dbo].[Category]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN
CREATE TABLE [dbo].[Category](
    [CategoryID] [int] IDENTITY(1,1) NOT NULL,
    [CategoryName] [nvarchar](64) NOT NULL,
 CONSTRAINT [PK_Categories] PRIMARY KEY CLUSTERED 
(
    [CategoryID] ASC
) 
) 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[dbo].[CategoryLog]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN
CREATE TABLE [dbo].[CategoryLog](
    [CategoryLogID] [int] IDENTITY(1,1) NOT NULL,
    [CategoryID] [int] NOT NULL,
    [LogID] [int] NOT NULL,
 CONSTRAINT [PK_CategoryLog] PRIMARY KEY CLUSTERED 
(
    [CategoryLogID] ASC
) 
) 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[dbo].[Log]') AND OBJECTPROPERTY(id, N'IsUserTable') = 1)
BEGIN
CREATE TABLE [dbo].[Log](
    [LogID] [int] IDENTITY(1,1) NOT NULL,
    [EventID] [int] NULL,
    [Priority] [int] NOT NULL,
    [Severity] [nvarchar](32) NOT NULL,
    [Title] [nvarchar](256) NOT NULL,
    [Timestamp] [datetime] NOT NULL,
    [MachineName] [nvarchar](32) NOT NULL,
    [AppDomainName] [nvarchar](512) NOT NULL,
    [ProcessID] [nvarchar](256) NOT NULL,
    [ProcessName] [nvarchar](512) NOT NULL,
    [ThreadName] [nvarchar](512) NULL,
    [Win32ThreadId] [nvarchar](128) NULL,
    [Message] [nvarchar](1500) NULL,
    [FormattedMessage] [ntext] NULL,
 CONSTRAINT [PK_Log] PRIMARY KEY CLUSTERED 
(
    [LogID] ASC
) 
) 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[InsertCategoryLog]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE InsertCategoryLog
    @CategoryID INT,
    @LogID INT
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @CatLogID INT
    SELECT @CatLogID FROM CategoryLog WHERE CategoryID=@CategoryID and LogID = @LogID
    IF @CatLogID IS NULL
    BEGIN
        INSERT INTO CategoryLog (CategoryID, LogID) VALUES(@CategoryID, @LogID)
        RETURN @@IDENTITY
    END
    ELSE RETURN @CatLogID
END
' 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[AddCategory]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

CREATE PROCEDURE [dbo].[AddCategory]
    -- Add the parameters for the function here
    @CategoryName nvarchar(64),
    @LogID int
AS
BEGIN
    SET NOCOUNT ON;
    DECLARE @CatID INT
    SELECT @CatID = CategoryID FROM Category WHERE CategoryName = @CategoryName
    IF @CatID IS NULL
    BEGIN
        INSERT INTO Category (CategoryName) VALUES(@CategoryName)
        SELECT @CatID = @@IDENTITY
    END

    EXEC InsertCategoryLog @CatID, @LogID 

    RETURN @CatID
END

' 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[ClearLogs]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'CREATE PROCEDURE ClearLogs
AS
BEGIN
    SET NOCOUNT ON;

    DELETE FROM CategoryLog
    DELETE FROM [Log]
    DELETE FROM Category
END
' 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'[dbo].[WriteLog]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'

/****** Object:  Stored Procedure dbo.WriteLog    Script Date: 10/1/2004 3:16:36 PM ******/

CREATE PROCEDURE [dbo].[WriteLog]
(
    @EventID int, 
    @Priority int, 
    @Severity nvarchar(32), 
    @Title nvarchar(256), 
    @Timestamp datetime,
    @MachineName nvarchar(32), 
    @AppDomainName nvarchar(512),
    @ProcessID nvarchar(256),
    @ProcessName nvarchar(512),
    @ThreadName nvarchar(512),
    @Win32ThreadId nvarchar(128),
    @Message nvarchar(1500),
    @FormattedMessage ntext,
    @LogId int OUTPUT
)
AS 

    INSERT INTO [Log] (
        EventID,
        Priority,
        Severity,
        Title,
        [Timestamp],
        MachineName,
        AppDomainName,
        ProcessID,
        ProcessName,
        ThreadName,
        Win32ThreadId,
        Message,
        FormattedMessage
    )
    VALUES (
        @EventID, 
        @Priority, 
        @Severity, 
        @Title, 
        @Timestamp,
        @MachineName, 
        @AppDomainName,
        @ProcessID,
        @ProcessName,
        @ThreadName,
        @Win32ThreadId,
        @Message,
        @FormattedMessage)

    SET @LogID = @@IDENTITY
    RETURN @LogID

' 
END
GO
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
IF NOT EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'FK_CategoryLog_Category') AND parent_obj = OBJECT_ID(N'[dbo].[CategoryLog]'))
ALTER TABLE [dbo].[CategoryLog]  WITH CHECK ADD  CONSTRAINT [FK_CategoryLog_Category] FOREIGN KEY(  [CategoryID])
REFERENCES [dbo].[Category] (   [CategoryID])
GO
IF NOT EXISTS (SELECT * FROM sysobjects WHERE id = OBJECT_ID(N'FK_CategoryLog_Log') AND parent_obj = OBJECT_ID(N'[dbo].[CategoryLog]'))
ALTER TABLE [dbo].[CategoryLog]  WITH CHECK ADD  CONSTRAINT [FK_CategoryLog_Log] FOREIGN KEY(   [LogID])
REFERENCES [dbo].[Log] (    [LogID])
GO

SET QUOTED_IDENTIFIER ON 
SET ARITHABORT ON 
SET CONCAT_NULL_YIELDS_NULL ON 
SET ANSI_NULLS ON 
SET ANSI_PADDING ON 
SET ANSI_WARNINGS ON 
SET NUMERIC_ROUNDABORT OFF 
go

DECLARE @bErrors as bit

BEGIN TRANSACTION
SET @bErrors = 0

CREATE NONCLUSTERED INDEX [ixCategoryLog] ON [dbo].[CategoryLog] ([LogID] ASC, [CategoryID] ASC )
IF( @@error <> 0 ) SET @bErrors = 1

IF( @bErrors = 0 )
  COMMIT TRANSACTION
ELSE
  ROLLBACK TRANSACTION 
```

然后，我按照[使用 SQL Server Management Studio 管理 Windows Azure SQL 数据库](http://www.windowsazure.com/en-us/develop/net/common-tasks/sql-azure-management/)的方式使用 SSMS来运行脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T05:57:22.590

我最终做的是：

1.  [从这里下载 Microsoft SQL Server Data Tools](http://msdn.microsoft.com/en-us/data/hh297027)。如果您管理任何 Azure SQL 数据库，这是必须具备的。Schema 比较和合并更改以及能够将其余代码推入 GIT 非常棒。无论如何，回到主题......

2.  在我的解决方案中添加了“SQL Server 数据库项目”。

3.  “右键单击数据库项目 => 属性 => 将目标设置为“Windows Azure SQL 数据库”。还在同一部分的输出类型区域中选中“创建脚本”。

4.  右键单击数据库项目 => 导入 SQL => 将 2005 年的 EntLib5.0 脚本传递给它。这会将脚本分解为每个表和每个存储过程的单独 .SQL 文件。

5.  Visual Studio 抱怨无法分解整个脚本（主要是存储过程）。它能够导入的内容在导入的脚本中被注释掉（很好，防止重复）

6.  我手动添加了存储的过程。添加新项目 => 存储过程 => 使用 2005 脚本中的名称 => 复制粘贴相同的旧 SQL 代码。对 2005 SQL 脚本文件中的所有 4 个 SP 执行此操作

7.  “构建”项目 => 没有错误

8.  右键单击数据库项目 => 架构比较 => 指向您的 azure 数据库

9.  点击更新

单击更新将自动创建 SQL 脚本，并将针对 Azure 数据库运行它。生成的脚本如下。由于某种原因，相同的脚本无法在 SQL Server 2012 Management Studio 中正常运行（是的，即使在 SQL CMD 模式下）。然而，即使从 VS2012 数据项目（上图）运行它也能正常工作。

```
/*
Deployment script for test

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;

GO
:setvar DatabaseName "Logging"
:setvar DefaultFilePrefix "Logging"
:setvar DefaultDataPath ""
:setvar DefaultLogPath ""

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END

GO
USE [$(DatabaseName)];

GO
PRINT N'Creating [dbo].[Category]...';

GO
CREATE TABLE [dbo].[Category] (
    [CategoryID]   INT           IDENTITY (1, 1) NOT NULL,
    [CategoryName] NVARCHAR (64) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY CLUSTERED ([CategoryID] ASC)
);

GO
PRINT N'Creating [dbo].[CategoryLog]...';

GO
CREATE TABLE [dbo].[CategoryLog] (
    [CategoryLogID] INT IDENTITY (1, 1) NOT NULL,
    [CategoryID]    INT NOT NULL,
    [LogID]         INT NOT NULL,
    CONSTRAINT [PK_CategoryLog] PRIMARY KEY CLUSTERED ([CategoryLogID] ASC)
);

GO
PRINT N'Creating [dbo].[CategoryLog].[ixCategoryLog]...';

GO
CREATE NONCLUSTERED INDEX [ixCategoryLog]
    ON [dbo].[CategoryLog]([LogID] ASC, [CategoryID] ASC);

GO
PRINT N'Creating [dbo].[Log]...';

GO
CREATE TABLE [dbo].[Log] (
    [LogID]            INT             IDENTITY (1, 1) NOT NULL,
    [EventID]          INT             NULL,
    [Priority]         INT             NOT NULL,
    [Severity]         NVARCHAR (32)   NOT NULL,
    [Title]            NVARCHAR (256)  NOT NULL,
    [Timestamp]        DATETIME        NOT NULL,
    [MachineName]      NVARCHAR (32)   NOT NULL,
    [AppDomainName]    NVARCHAR (512)  NOT NULL,
    [ProcessID]        NVARCHAR (256)  NOT NULL,
    [ProcessName]      NVARCHAR (512)  NOT NULL,
    [ThreadName]       NVARCHAR (512)  NULL,
    [Win32ThreadId]    NVARCHAR (128)  NULL,
    [Message]          NVARCHAR (1500) NULL,
    [FormattedMessage] NTEXT           NULL,
    CONSTRAINT [PK_Log] PRIMARY KEY CLUSTERED ([LogID] ASC)
);

GO
PRINT N'Creating FK_CategoryLog_Category...';

GO
ALTER TABLE [dbo].[CategoryLog] WITH NOCHECK
    ADD CONSTRAINT [FK_CategoryLog_Category] FOREIGN KEY ([CategoryID]) REFERENCES [dbo].[Category] ([CategoryID]);

GO
PRINT N'Creating FK_CategoryLog_Log...';

GO
ALTER TABLE [dbo].[CategoryLog] WITH NOCHECK
    ADD CONSTRAINT [FK_CategoryLog_Log] FOREIGN KEY ([LogID]) REFERENCES [dbo].[Log] ([LogID]);

GO
PRINT N'Creating [dbo].[ClearLogs]...';

GO
CREATE PROCEDURE ClearLogs
AS
BEGIN
    SET NOCOUNT ON;

    DELETE FROM CategoryLog
    DELETE FROM [Log]
    DELETE FROM Category
END
GO
PRINT N'Creating [dbo].[InsertCategoryLog]...';

GO
CREATE PROCEDURE InsertCategoryLog
    @CategoryID INT,
    @LogID INT
AS
BEGIN
    SET NOCOUNT ON;

    DECLARE @CatLogID INT
    SELECT @CatLogID FROM CategoryLog WHERE CategoryID=@CategoryID and LogID = @LogID
    IF @CatLogID IS NULL
    BEGIN
        INSERT INTO CategoryLog (CategoryID, LogID) VALUES(@CategoryID, @LogID)
        RETURN @@IDENTITY
    END
    ELSE RETURN @CatLogID
END
GO
PRINT N'Creating [dbo].[WriteLog]...';

GO
CREATE PROCEDURE [dbo].[WriteLog]
(
    @EventID int, 
    @Priority int, 
    @Severity nvarchar(32), 
    @Title nvarchar(256), 
    @Timestamp datetime,
    @MachineName nvarchar(32), 
    @AppDomainName nvarchar(512),
    @ProcessID nvarchar(256),
    @ProcessName nvarchar(512),
    @ThreadName nvarchar(512),
    @Win32ThreadId nvarchar(128),
    @Message nvarchar(1500),
    @FormattedMessage ntext,
    @LogID int OUTPUT
)
AS 

    INSERT INTO [Log] (
        EventID,
        Priority,
        Severity,
        Title,
        [Timestamp],
        MachineName,
        AppDomainName,
        ProcessID,
        ProcessName,
        ThreadName,
        Win32ThreadId,
        Message,
        FormattedMessage
    )
    VALUES (
        @EventID, 
        @Priority, 
        @Severity, 
        @Title, 
        @Timestamp,
        @MachineName, 
        @AppDomainName,
        @ProcessID,
        @ProcessName,
        @ThreadName,
        @Win32ThreadId,
        @Message,
        @FormattedMessage)

SET @LogID = @@IDENTITY
RETURN @LogID
GO
PRINT N'Creating [dbo].[AddCategory]...';

GO
CREATE PROCEDURE [dbo].[AddCategory]
    -- Add the parameters for the function here
    @CategoryName nvarchar(64),
    @LogID int
AS
BEGIN
    SET NOCOUNT ON;
    DECLARE @CatID INT
    SELECT @CatID = CategoryID FROM Category WHERE CategoryName = @CategoryName
    IF @CatID IS NULL
    BEGIN
        INSERT INTO Category (CategoryName) VALUES(@CategoryName)
        SELECT @CatID = @@IDENTITY
    END

    EXEC InsertCategoryLog @CatID, @LogID 

    RETURN @CatID
END
GO 
```

# android - 应用对象及其内存管理

> ID：14048134
> 
> 赞同：0
> 
> 时间：2012-12-27T00:56:45.470
> 
> 标签：android, memory-management

基本上我知道一些与主题相关的东西，比如什么是应用程序对象以及我们应该何时使用它。但我心中仍有一些问题需要回答。

让我们假设我们有一个包含自定义应用程序的项目，并且在某个地方，该项目引发错误并出现强制关闭。

那么应用程序对象还会活着吗？如果是，它将如何以及何时处理？

# sql - 在数据库中存储图像参考的最佳实践

> ID：14048135
> 
> 赞同：5
> 
> 时间：2012-12-27T00:56:48.537
> 
> 标签：sql, sql-server, database-design

我正在开发一个网站，上传到该网站的单个图像可以被多个业务模块使用，例如**Food Item**、**Dish**、**Gallery**或其他。
我有一个主**图像表**，用于存储对文件系统上实际图像的引用。
现在，该表上的每条记录都可以通过 item、dish 或 gallery 表进行引用。
我的问题是，所有这些引用应该存储在一个表上还是应该维护一个单独的表，如 ItemImage、DishImage？
单张桌子的问题是我担心这张桌子会被高点击量轰炸，最终会增加响应时间。多个表的问题是随着业务前端模块数量的增加，我必须不断添加更多表。
如果我说性能是我网站的重中之重，那么最好的方法是什么？

SQL Server 2012、.Net 4.5、MVC 4。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T03:35:13.360

我建议使用单个表。正如@Brandon 所提到的，如果索引正确，应该没有性能问题。

我还建议您仅存储来自公共根文件夹的相对路径（如 @SpectralGhost 所建议的那样）。然后，公共根文件夹可以作为配置设置，允许运营团队更改文件的存储位置，而无需对数据库进行大规模更新。

如果单个文件夹中有数千个文件，文件系统性能可能会成为问题。我建议为更多的树结构制作几个级别的子文件夹。例如，如果文件名`ABCDE.jpg`使用类似的路径，`A/B/ABCDE.jpg`则会将文件拆分为数千个子文件夹。

我还建议您使用 GUID 或类似名称作为上传文件的基本文件名，以避免任何命名冲突（并使用 GUID 的无破折号版本来保存 4 个字符）。如果您需要原始文件名，请将其放在图像表的另一列中。存储其他图像元数据，例如宽度、高度和内容类型（例如“image/jpeg”）也是一个好主意。

使用关键字标记系统对每个图像进行分类可能是对图像进行逻辑分组的最佳方法。然后理论上可以将每个图像分配给任意数量的类别（包括零）。这将需要一个标签列表表和一个包含`(tag_id, image_id)`对的单独映射表。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-27T01:52:13.737

这就是索引存在的目的。将它们全部放在一个表中，只要它的索引性能对于这种情况就不会成为问题。

想想你是否有一本书，里面有 1,000,000 页。即使对于作为人类的你来说，找到任何给定的页码也不会花费那么长时间......只要页面是有序的。而且，您在 100,000,000 页的书中找到一页的时间差异确实不会显着延长。

现在，如果您对数据进行复杂的报告，它可能会有所不同，但这只是一个查找表。

# java - 使用 TokenCredentials 的 Exchange Web 服务 (EWS) 单点登录？

> ID：14048136
> 
> 赞同：23
> 
> 时间：2012-12-27T00:57:01.097
> 
> 标签：java, authentication, single-sign-on, exchangewebservices, ewsjavaapi

我正在 Android 应用程序中使用[EWS Java API 1.2](http://archive.msdn.microsoft.com/ewsjavaapi)。使用用户名/密码登录`WebCredentials`可以正常使用，如下所示：

```
ExchangeService service = new ExchangeService();
ExchangeCredentials credentials = new WebCredentials("domain\\username", "password");
service.setCredentials(credentials); 
```

我不想每次都提供密码，而是提供一个身份验证令牌。EWS API 包含一个`TokenCredentials`类，但如何使用它？给定用户名和密码，如何生成可重复使用的身份验证令牌？一旦我生成了这样的令牌，它的有效期是多久？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-13T07:22:27.593

您现在可以使用 OAuth 令牌： http: [//msdn.microsoft.com/en-us/library/office/dn626019](http://msdn.microsoft.com/en-us/library/office/dn626019(v=exchg.150).aspx) (v=exchg.150).aspx 。这个话题在几周前刚刚更新了一些基本信息。

# url - Extjs 4 - Ajax 请求 404 错误

> ID：14048138
> 
> 赞同：0
> 
> 时间：2012-12-27T00:57:02.863
> 
> 标签：url, extjs4, http-status-code-404, ajax-request

我正在使用`Extjs 4.1.3`和`Symfony1.4`作为我的 php 框架，我的问题是使用`Ext.Ajax.request`它时经常返回 404 错误。我说有时是因为其他时候它可以通过并且工作正常。

我的操作基本上是在单击保存时检查数据输入并将数据插入数据库。数据输入检查尝试与服务器通信`Ext.Ajax.request`，但就像我说的那样，它经常返回一个`404 Error`.

当我转到链接时，通过使用萤火虫和复制位置，它工作正常。该链接按预期返回一个 json 文件。

这可能是什么原因？我该如何防止这种情况？

这是我的代码片段：

```
 Ext.Ajax.request({
    params: {
    agentName       : 'Test'
    },
    url: '/home/CheckEntry',
    timeout: 60000,
    success: function(response, opts) {
    alert('success');
    },
    failure: function(response, opts) {
            alert('fail');
    }
}); 
```

**action.class.php**：

```
public functionn executeCheckEntry(sfWebRequest $request)
{
       $returnData = array();
       $agentName = $request->getParameter('agentName');
       try{
        ..............Did validation
        ..............SQL queries
        $return_data['success'] = true;
    } catch(Exception $e) {
        $return_data['success'] = false;
    }
    die(json_encode($return_data));
  } 
```

我希望这已经足够了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T08:59:14.520

“当用户尝试跟踪损坏或死链接时，网站托管服务器通常会生成“404 Not Found”网页” [http://en.wikipedia.org/wiki/HTTP_404](http://en.wikipedia.org/wiki/HTTP_404)

这意味着您的 URL 不正确。可能`url: '/home/CheckEntry'`是正确的，正如您所说，有时它会起作用。您需要检查您传递的参数是否正确。

# data-structures - 为什么在单个链表中删除 O(1)？

> ID：14048143
> 
> 赞同：22
> 
> 时间：2012-12-27T00:57:51.333
> 
> 标签：data-structures, linked-list, singly-linked-list

[正如维基百科文章](http://en.wikipedia.org/wiki/Linked_list)所说，我不太明白为什么在单个链表末尾删除会在 O(1) 时间内进行。

单个链表由节点组成。一个节点包含某种数据，以及对下一个节点的引用。链表中最后一个节点的引用为空。

```
--------------    --------------           --------------
| data | ref | -> | data | ref | -> ... -> | data | ref |
--------------    --------------           -------------- 
```

我可以删除 O(1) 中的最后一个节点。但在这种情况下，您不会将新的最后一个节点（前一个节点）的引用设置为 null，因为它仍然包含对已删除的最后一个节点的引用。所以我想知道，他们在运行时间分析中是否忽略了这一点？还是认为您不必更改它，因为引用只是指向任何内容，而这被视为空值？

因为如果不忽略它，我会认为删除是 O(n)。由于您必须遍历整个列表才能到达新的最后一个节点并将其引用也设置为 null。只有在双链表中它才真正是 O(1)。

-edit- 也许这种观点给出了一些更清晰的信息。但我将“删除节点”视为成功删除节点本身并将先前的引用设置为空。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-12-27T01:11:22.933

我不确定我是否在 Wikipedia 文章中看到它说可以在 O(1) 时间内删除单链表的最后一个条目，但在大多数情况下该信息是不正确的。给定链表中的任何单个节点，始终可以通过围绕该新节点重新连接链表，在 O(1) 时间内删除该节点之后的节点。因此，如果给你一个指向链表中倒数第二个节点的指针，那么你可以在 O(1) 时间内删除链表的最后一个元素。

但是，如果除了头指针之外没有任何额外的指向列表的指针，那么您不能在不扫描到列表末尾的情况下删除列表的最后一个元素，这将需要 Θ(n) 时间，因为你已经注意到了。您绝对正确，仅删除最后一个节点而不首先更改指向它的指针将是一个非常糟糕的主意，因为如果您要这样做，现有列表将包含指向已释放对象的指针。

更一般地说 - 在单链表中进行插入或删除的成本是 O(1)，假设您在要插入或删除的节点之前有一个指向节点的指针。但是，您可能需要做额外的工作（最多 Θ(n)）才能找到该节点。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-27T01:08:38.587

*在任何*位置添加/删除*任何*节点都是 O(1)。代码只是使用固定成本（很少的指针计算和 malloc/frees）来添加/删除节点。对于任何特定情况，此算术成本都是固定的。

 *但是，到达（索引）所需节点的成本是 O(n)。

文章只是列出了多个子类（中间、开头、结尾的添加）的添加/删除，以表明中间添加的成本与开头/结尾的添加成本不同（但各自的成本仍然是固定的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T01:11:35.603

O(1) 仅表示“恒定成本”。这并不意味着 1 次操作。这意味着“至多 C”操作，无论其他参数如何变化（例如列表大小），C 都是固定的。事实上，在有时令人困惑的 big-Oh 世界中：O(1) == O(22)。

相比之下，删除整个列表的成本为 O(n)，因为成本随列表的大小 (n) 而变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T09:21:54.613

如果您包括修复悬空节点的成本，您仍然可以在 O(1) 中使用哨兵节点结束（也在该页面上描述）。

您的“空”列表以单个哨兵开始

```
Head -> [Sentinel] 
```

添加一些东西

```
Head -> 1 -> 2 -> 3 -> [Sentinel] 
```

现在通过将节点 3 标记为无效来删除尾部 (3)，然后删除指向旧哨兵的链接，并为其释放内存：

```
Head -> 1 -> 2 -> 3 -> [Sentinel] 
Head -> 1 -> 2 -> [Sentinel] -> [Sentinel] 
Head -> 1 -> 2 -> [Sentinel] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-01T04:49:01.693

为了将来参考，我必须说，经过一些研究，我发现为回答这个问题而提供的所有论点都不相关。答案是我们简单地决定堆栈的顶部是链表的头部（而不是尾部）。这将在 push 例程中引入轻微的变化，但 pop 和 push 都将保持 o(1)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-29T20:05:36.043

如果您在单个链表中给出要删除的节点的指针，那么您可以通过简单地将下一个节点复制到要删除的节点上来在恒定时间内删除该节点。

```
M pointer to node to delete
M.data=M.next.data
M.next=M.next.next 
```

否则，如果您需要搜索节点，那么您不能做得比 O(n) 更好

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-30T02:03:41.813

是的，即使您没有维护指向“前一个元素”的指针，您也可以在 O(1) 时间内完成此操作。

假设您有这个列表，其中“head”和“tail”是静态指针，“End”是标记为结束的节点。您可以正常使用“next == NULL”，但在这种情况下，您必须忽略该值：

`head -> 1 -> 2 -> 3 -> 4 -> 5 -> End <- tail`

现在，你得到了一个指向节点 3 的指针，但不是它的前一个节点。你也有头和尾指针。这是一些 python 风格的代码，假设是 SingleLinkedList 类。

```
class SingleLinkedList:

    # ... other methods

    def del_node(self, node):  # We "trust" that we're only ever given nodes that are in this list.
        if node is self.head:
            # Simple case of deleting the start
            self.head = node.next
            # Free up 'node', which is automatic in python
        elif node.next is self.tail
            # Simple case of deleting the end. This node becomes the sentinel
            node.value = None
            node.next = None
            # Free up 'self.tail'
            self.tail = node
        else:
            # Other cases, we move the head's value here, and then act
            # as if we're deleting the head.
            node.value = self.head.value
            self.head = self.head.next
            new_head = self.head.next
            # Free up 'self.head'
            self.head = new_head 
```

唉，这会重新排序列表，*并*移动值，这对您的应用程序可能合适，也可能不合适。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-12-27T01:10:30.330

例如，您可以有一个指向 last 之前的元素（“倒数第二个”）的指针，并且在删除时： 1\. 删除此“倒数第二个”元素的 *next。2\. 将此“倒数第二个”*next 设置为 NULL*

# c# - 装饰不同生活方式的界面

> ID：14048152
> 
> 赞同：1
> 
> 时间：2012-12-27T00:58:30.477
> 
> 标签：c#, dependency-injection, simple-injector

我使用 Simple Injector 作为我的 IoC 容器。SimpleInjector 使用[这种简单的技术来处理 Per Thread 和 Per Web Request 的混合生活方式](https://stackoverflow.com/questions/13147509/mixed-lifestyle-for-per-thread-and-per-web-request-with-simple-injector)

```
container.RegisterPerWebRequest<IWebUnitOfWork, UnitOfWork>();
container.RegisterLifetimeScope<IThreadUnitOfWork, UnitOfWork>();
container.Register<IUnitOfWork>(() => container.GetInstance<UnitOfWork>());

// Register as hybrid PerWebRequest / PerLifetimeScope.
container.Register<UnitOfWork>(() =>
{
    if (HttpContext.Current != null)
        return container.GetInstance<IWebUnitOfWork>() as UnitOfWork;
    else
        return container.GetInstance<IThreadUnitOfWork>() as UnitOfWork;
}); 
```

我希望用, &之类的`IUnitOfWork`类来装饰界面。我应该装饰什么？`UnitOfWorkAuthoriseDecorator``UnitOfWorkExceptionDecorator``UnitOfWorkTraceDecorator`

*   `IUnitOfWork`
*   `IWebUnitOfWork`&`IThreadUnitOfWork`
*   `IUnitOfWork`&& `IWebUnitOfWork`_`IThreadUnitOfWork`
*   `UnitOfWork`
*   别的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T13:40:58.310

`IUnitOfWork`对我来说，装饰实例似乎最直观：

```
container.RegisterDecorator(typeof(IUnitOfWork),
    typeof(UnitOfWorkAuthoriseDecorator));

container.RegisterDecorator(typeof(IUnitOfWork),
    typeof(UnitOfWorkExceptionDecorator));

container.RegisterDecorator(typeof(IUnitOfWork),
    typeof(UnitOfWorkTraceDecorator)); 
```

装饰其他任何东西可能会相当尴尬，因为在装饰多个接口时，您需要每个接口都有一个装饰器（在您的情况下，每个接口需要 3 个装饰器）。

装饰`UnitOfWork`类是可能的，但可能非常不方便，因为您必须将此类的所有成员设为虚拟并在装饰器中覆盖它们，因为这些装饰器需要继承自`UnitOfWork`.

# android - android片段自定义适配器

> ID：14048157
> 
> 赞同：0
> 
> 时间：2012-12-27T00:59:11.537
> 
> 标签：android, adapter, fragment

我在 Android Fragment 中使用自定义适配器时遇到了一些问题。这是代码。但在我在活动中使用此代码之前，一切都很好。我在使用 Fragments 时找不到出错的地方。

```
package com.testapp.test.fragments;

import org.holoeverywhere.LayoutInflater;
import org.holoeverywhere.app.Fragment;
import com.testapp.test.R;

import android.content.Context;
import android.os.Bundle;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.ImageView;
import android.widget.ListView;
import android.widget.TextView;

public class LawDocFragment extends Fragment{

private static LawDocFragment instance;

public static LawDocFragment getInstance() {
    if (LawDocFragment.instance == null) {
        return new LawDocFragment();
    }
    return LawDocFragment.instance;
}

public LawDocFragment() {
    LawDocFragment.instance = this;
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setRetainInstance(true);
}

String[] zakonmenubig;
String[] zakonmenusmall;
Integer[] zakonmenuicon = { R.drawable.ic_menu_zakonu_pravila, 
                            R.drawable.ic_menu_zakonu_strafu, 
                            R.drawable.ic_menu_zakonu_doc,
                            R.drawable.ic_menu_zakonu_u77,
                            R.drawable.ic_menu_zakonu_u33,
                            R.drawable.ic_menu_zakonu_u400,
                            R.drawable.ic_menu_zakonu_p1103};

myAdapter zakonAdapter;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View LawDoc = inflater.inflate(R.layout.zakonbaza);     
    ListView zakonmenulist = (ListView)LawDoc.findViewById(R.id.zakonmenulist);     
    zakonAdapter = new myAdapter();     
    zakonmenulist.setAdapter(zakonAdapter);

    zakonmenubig = getResources().getStringArray(R.array.zakonmenubig);
    zakonmenusmall = getResources().getStringArray(R.array.zakonmenusmall);

    return LawDoc;
}

//start myAdapter
public class myAdapter extends BaseAdapter {
    private LayoutInflater mLayoutInflater;

    public myAdapter(Context ctx) {
        mLayoutInflater = LayoutInflater.from(ctx);
    }

    public int getCount() {
        return zakonmenubig.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public String getString(int position) {
        return zakonmenubig[position] + " (" + zakonmenusmall[position] + ")";
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        if (convertView == null)
            convertView = mLayoutInflater.inflate(R.layout.list_zakonbaza, null);

        ImageView image = (ImageView) convertView.findViewById(R.id.icon);
        image.setImageResource(zakonmenuicon[position]);

        TextView sign = (TextView) convertView.findViewById(R.id.zakonmenuitem);
        sign.setText(zakonmenubig[position]);

        TextView date = (TextView) convertView.findViewById(R.id.zakonmenuitemsmall);
        date.setText(zakonmenusmall[position]);
        return convertView;
    }
} // end myAdapter

} 
```

现在 Eclipse 在行中显示错误“构造函数 LawDocFragment.myAdapter() 未定义”

```
zakonAdapter = new myAdapter(); 
```

如果我改成

```
zakonAdapter = new myAdapter(getActivity()); 
```

我会得到这个例外

```
12-27 00:39:25.297: E/AndroidRuntime(652): FATAL EXCEPTION: main
12-27 00:39:25.297: E/AndroidRuntime(652): java.lang.NullPointerException
12-27 00:39:25.297: E/AndroidRuntime(652):  at com.testapp.test.fragments.fragments.LawDocFragment$myAdapter.getCount(LawDocFragment.java:72)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.widget.ListView.setAdapter(ListView.java:436)
12-27 00:39:25.297: E/AndroidRuntime(652):  at com.testapp.test.fragments.fragments.LawDocFragment.onCreateView(LawDocFragment.java:55)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app._HoloFragment.onCreateView(_HoloFragment.java:177)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app.Fragment.performCreateView(Fragment.java:1460)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:911)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.os.Handler.handleCallback(Handler.java:587)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.os.Handler.dispatchMessage(Handler.java:92)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.os.Looper.loop(Looper.java:123)
12-27 00:39:25.297: E/AndroidRuntime(652):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-27 00:39:25.297: E/AndroidRuntime(652):  at java.lang.reflect.Method.invokeNative(Native Method)
12-27 00:39:25.297: E/AndroidRuntime(652):  at java.lang.reflect.Method.invoke(Method.java:521)
12-27 00:39:25.297: E/AndroidRuntime(652):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-27 00:39:25.297: E/AndroidRuntime(652):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-27 00:39:25.297: E/AndroidRuntime(652):  at dalvik.system.NativeStart.main(Native Method) 
```

在“LawDocFragment.java:72”行我有这段代码

```
return zakonmenubig.length; 
```

在“LawDocFragment.java:55”行中我有

```
zakonmenulist.setAdapter(zakonAdapter); 
```

我认为 myAdapter 类有问题，但是什么......以及为什么在简单的活动中一切正常......

我发现了这个[问题](https://stackoverflow.com/questions/12884084/android-newbie-facing-issue-for-setadapter-listview)并尝试使用代码但仍然没有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:27:01.083

好的，这里的问题是

1.  使用空白构造函数显示错误是正确的，因为适配器类中没有类似的构造函数。所以要么创建一个没有参数的构造函数（坏主意），要么只传递上下文。

2.  您的空指针出现是因为

    扎孔菜单

在您创建适配器时尚未定义，而是在您的适配器之前创建这些元素，如下所示：

```
zakonmenubig = getResources().getStringArray(R.array.zakonmenubig);
zakonmenusmall = getResources().getStringArray(R.array.zakonmenusmall);

ListView zakonmenulist = (ListView)LawDoc.findViewById(R.id.zakonmenulist);     
zakonAdapter = new myAdapter();     
zakonmenulist.setAdapter(zakonAdapter); 
```

现在你的 zakonmenubig 将被初始化。

# ios - 如果已安装，则重定向到应用程序，否则重定向到 App Store

> ID：14048159
> 
> 赞同：78
> 
> 时间：2012-12-27T00:59:27.883
> 
> 标签：ios, redirect, app-store

我知道可以通过注册自定义方案（例如so://）直接链接到iOS 中的应用程序，也可以通过iTunes 链接到应用程序商店中的应用程序。

在许多情况下，理想的流程是提供一个链接，如果已安装，则重定向到应用程序，*如果*未安装，则重定向到商店。这可能吗？如果可以，怎么做？

**为清楚起见**，添加的场景是我从我的 iphone 上的电子邮件中打开一个链接 (http)，邀请我加入应用程序中的一个组。如果用户在该设备上安装了应用程序，它应该打开，否则 http 链接应该重定向到 iTunes。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2014-10-16T21:09:04.740

我认为更简单的答案是使用以下 javascript 在您的服务器上设置一个页面：

```
(function() {
  var app = {
    launchApp: function() {
      window.location.replace("myapp://");
      this.timer = setTimeout(this.openWebApp, 1000);
    },

    openWebApp: function() {
      window.location.replace("http://itunesstorelink/");
    }
  };

  app.launchApp();
})(); 
```

这基本上会尝试重定向到您的应用程序并设置超时以在失败时重定向到应用程序商店。

您甚至可以使代码更智能，并检查用户代理以查看他们是 ios 用户、android 用户还是 web 用户，然后适当地重定向它们。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-12-27T02:09:15.610

没有办法对此进行检查。但是，有一个很好的解决方法。

这个想法基本上是这样的：

1.  第一次打开应用程序时，您会从应用程序内打开移动 Safari 到服务器上的预定义 URL
2.  在该 URL 上，您设置了一个 cookie，例如 appInstalled 到用户的移动 safari
3.  然后，您使用您注册的方案将用户踢回您的应用程序（与 FB 对 SSO 所做的相同）
4.  您所有的电子邮件链接都指向您的网站，但在网站上您检查浏览器是否为移动版 Safari，以及是否存在 appInstalled cookie
5.  如果浏览器不是移动 Safari 或未找到 cookie，您将重定向到 AppStore，或留在您的网页中。
6.  如果 #4 的条件为真，则使用注册的方案将用户重定向到您的应用
7.  如果应用程序已被用户删除，因此自定义 url 方案失败，您有一个故障安全重定向到应用程序商店

最后两个步骤[在此 SO 帖子中进行了解释](https://stackoverflow.com/a/2391031/312312)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-01-04T16:51:58.950

如果您有一个网页，您从电子邮件中链接到该网页，该网页包含`iframe`设置`src`为您的应用程序的自定义方案的网页，iOS 将自动重定向到应用程序中的该位置。如果未安装该应用程序，则不会发生任何事情。这使您可以在已安装的应用程序中进行深度链接，如果未安装，则可以重定向到应用程序商店。

例如，如果您安装了 twitter 应用程序，并导航到包含以下标记的网页，您将立即被定向到该应用程序。如果您没有安装 Twitter 应用程序，您会看到文本“未安装 Twitter 应用程序”。

```
<!DOCTYPE html>
<html>
    <head>
    <title>iOS Automatic Deep Linking</title>
    </head>
    <body>
        <iframe src="twitter://" width="0" height="0"></iframe>
        <p>The Twitter App is not installed</p>
    </body>
</html> 
```

这是一个更详尽的示例，如果未安装应用程序，它将重定向到应用程序商店：

```
<!DOCTYPE html>
<html>
    <head>
    <title>iOS Automatic Deep Linking</title>
    <script src='//code.jquery.com/jquery-1.11.2.min.js'></script>
    <script src='//mobileesp.googlecode.com/svn/JavaScript/mdetect.js'></script>
    <script>
      (function ($, MobileEsp) {
        // On document ready, redirect to the App on the App store.
        $(function () {
          if (typeof MobileEsp.DetectIos !== 'undefined' && MobileEsp.DetectIos()) {
            // Add an iframe to twitter://, and then an iframe for the app store
            // link. If the first fails to redirect to the Twitter app, the
            // second will redirect to the app on the App Store. We use jQuery
            // to add this after the document is fully loaded, so if the user
            // comes back to the browser, they see the content they expect.
            $('body').append('<iframe class="twitter-detect" src="twitter://" />')
              .append('<iframe class="twitter-detect" src="itms-apps://itunes.com/apps/twitter" />');
          }
        });
      })(jQuery, MobileEsp);
    </script>
    <style type="text/css">
      .twitter-detect {
        display: none;
      }
    </style>
    </head>
    <body>
    <p>Website content.</p>
    </body>
</html> 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-05-26T13:43:03.400

“智能应用横幅” - 不确定它们何时出现，但在找到此帖子后寻找相同的内容，然后是智能应用横幅，这是后续行动。

智能应用横幅是您希望通过网络体验提供应用的每个页面标题中的单行 html 元标记：

```
<meta name="apple-itunes-app" content="app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL"> 
```

这会在页面顶部显示该图标，并使用应用程序或路由到 App Store 来“打开此页面”。

[![在此处输入图像描述](../Images/0cb17d7a6350fc2385dea49e0d27a571.png)](https://i.stack.imgur.com/63uNa.png)

iPhone 上此页面的元数据如下所示（当然是匿名的）：

```
<meta name="apple-itunes-app" content="app-id=605841731, app-argument=lync://confjoin?url=https://meet.rtc.yourcorporatedomain.com/firstName.lastName/conferenceID"> 
```

 [Apple 开发者文档 - 使用智能应用横幅推广应用](https://developer.apple.com/library/content/documentation/AppleApplications/Reference/SafariWebContent/PromotingAppswithAppBanners/PromotingAppswithAppBanners.html)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-12-27T01:03:49.300

是的，这很容易。这需要您要打开的应用程序在 plist 中声明一个 url 方案：

```
//if you can open your app
if([[UIApplication sharedApplication] canOpenURL:[NSURL URLWithString:@"yourapp://"]])
{
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"yourapp://"]];
}
else
{
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"ituneappstorelink"]];
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-02-09T12:04:36.747

有几个简单的步骤来实现这个动作

**第1步**

转到 -> 项目（选择目标）-> 信息 -> URL 类型

[![在此处输入图像描述](../Images/eee53f16178f54a11ca57f2d72049570.png)](https://i.stack.imgur.com/5NTBF.png)

像这样在 Xcode 中创建 URL Scheme

[![在此处输入图像描述](../Images/ae81f5f78a198e2961df4b09f6d971ee.png)](https://i.stack.imgur.com/aJRbf.png) 这里的 URL Scheme 是 myApp（最好所有字符都小写）。

**第2步**

如果您计划从 URL 接收参数/查询字符串，则设置委托

这是代码：

```
- (BOOL)application:(UIApplication *)application
            openURL:(NSURL *)url
            options:(NSDictionary<UIApplicationOpenURLOptionsKey,id> *)options {

     NSLog(@"APP : simple action %@",url.scheme);

    if ([url.scheme hasPrefix:@"myapp"]) {

        NSLog(@"APP inside simple %@",url.absoluteString);

        NSURLComponents *urlComponents = [NSURLComponents componentsWithURL:url
                                                    resolvingAgainstBaseURL:NO];
        NSArray *queryItems = urlComponents.queryItems;
        NSString * abc = [self valueForKey:@"abc"
                           fromQueryItems:queryItems];
        NSString * xyz = [self valueForKey:@"xyz"
                           fromQueryItems:queryItems];

        NSLog(@"Sid up = %@", abc);

        NSLog(@"PID up = %@", xyz);

      // you can do anything you want to do here

        return YES;
    }
return NO;
} 
```

Xcode 端工作结束。

**第 3 步**

在这里引用@BananaNeil 代码，因为我不是前端人员

```
(function() {
  var app = {
    launchApp: function() {
      window.location.replace("myApp://share?abc=12&xyz=123");
      this.timer = setTimeout(this.openWebApp, 1000);
    },

    openWebApp: function() {
      window.location.replace("http://itunesstorelink/");
    }
  };

  app.launchApp();
})(); 
```

希望对大家有帮助

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-03-01T16:15:17.293

这里有一堆复杂的边缘情况，所以最简单的解决方案是让其他人处理这些事情。

这就是[https://branch.io/](https://branch.io/)所做的。您可以使用他们的免费计划来实现您想要的，并提供一些奖励功能

*   统计数据
*   您可以将信息与链接一起传递，即使用户必须先进行安装，它也会被检索到
*   链接将在桌面上工作（默认情况下，它将向您的手机发送安装链接）

我不隶属于 Branch.io，但我确实使用他们的产品。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-01-07T07:35:06.967

如果有人仍然陷入这个问题并且需要最简单的解决方案，你会喜欢[node-deeplink](https://www.npmjs.com/package/node-deeplink)

1.) 如果安装了应用程序：通过深度链接调用应用程序将始终调用根组件的componentDidMount。所以你可以在那里附加一个监听器。像：

```
Linking.getInitialURL()
      .then(url => {
        if (url) {
          this.handleOpenURL({ url });
        }
      })
      .catch(console.error);

    Linking.addEventListener('url', this.handleOpenURL);

handleOpenURL(event) {
    if (event) {
      console.log('event = ', event);
      const url = event.url;
      const route = url.replace(/.*?:\/\//g, '');
      console.log('route = ', route);
      if(route.match(/\/([^\/]+)\/?$/)) {
        const id = route.match(/\/([^\/]+)\/?$/)[1];
        const routeName = route.split('/')[0];

        if (routeName === 'privatealbum') {
          Actions.privateAlbum({ albumId: id });
        }
      }
    }
  } 
```

2.) 如果未安装应用程序：只需在您的服务器中设置路由，当您的手机中未安装应用程序时， [node-deeplink包将处理 Web 浏览器与应用商店之间的桥接。](https://www.npmjs.com/package/node-deeplink)

如此一来，两宗案件都将不费吹灰之力处理

# magento - 如何从静态块切换到“管理类别”

> ID：14048162
> 
> 赞同：1
> 
> 时间：2012-12-27T00:59:58.730
> 
> 标签：magento

我是 Magento (1.7) 的新手，想建立一个电子商务网站。我已经下载了一个主题并开始研究它。我正在关注在线帮助并设置商店。在用户指南中，它讨论了分类日志-> 管理分类以创建新分类和子分类。我照原样按照说明进行操作。但是前端正在从名为“top_nav”的 cms-> 静态块中提取类别选项卡

我应该在哪里进行更改，以便从我在 Catelog->Manage Categories 中设置的内容中选择类别和子类别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T04:06:21.040

这是因为自定义主题正在做的事情，并且有很多方法可以做到这一点；最好的办法是询问主题作者。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T07:04:27.237

您的问题的答案实际上取决于主题的创建者为删除旧导航并实施由 CMS 块控制的新导航所做的工作。但是，我已尽力为您提供一些关于如何解决问题的一般指导方针。

首先我们需要查看当前正在写入现有主菜单的模板文件。

**打开 Magento 模板路径提示。**

1.  访问系统>>配置>>开发人员。
2.  很有可能，您当前的配置范围（左上角）设置为“默认配置”。您不能全局设置 Magento 模板路径提示。
3.  您需要将配置范围设置为网站或商店配置。（例如默认商店视图）。见下图。
4.  将当前配置范围设置为商店或网站视图后，您需要将模板路径提示更改为是。这可以在 Debug 标题下找到。 ![magento - 打开模板路径提示](../Images/8d4126ece5e1b18a292ed08905721a37.png)

**识别正在调用现有主菜单的模板**

5.  现在访问您的网站（您可能需要清除缓存），在每个部分上方，您将看到该部分正在使用的模板的路径。请注意您的菜单所在的模板名称。这是调用 CMS 块菜单的模板。

6.  在下面的屏幕截图中，我们看到文件是 top.phtml 及其内部的 header.phtml。 ![magento - 前端的模板提示](../Images/78afd10ea3f48d4883f20764cc4da961.png)

7.  要禁用此主菜单，请转到模板，在本例中为 header.phtml 或 top.phtml 并注释掉/删除引用。请记住，我们需要在此处添加默认菜单引用，以便保持文件打开。

**恢复 magento 的默认菜单**

8.  在您当前的主题布局文件夹（app/design/frontend/PACKAGE/THEME/layout/）中打开 page.xml。

9.  找到以 this 块开头的部分开头：`<block type="page/html_header" name="header" as="header">`如果它不存在，则在其中添加以下代码：

    ```
    <block type="core/text_list" name="top.menu" as="topMenu" translate="label">
    <label>Navigation Bar</label>
    <block type="page/html_topmenu" name="catalog.topnav" template="page/html/topmenu.phtml"/>
    </block> 
    ```

10.  打开您的标题模板（app/design/frontend/PACKAGE/THEME/template/page/html/header.phtml）并在您希望菜单出现的位置添加以下代码。 `<?php echo $this->getChildHtml('topMenu') ?>`

# python - 紧凑的 Python for() 循环

> ID：14048164
> 
> 赞同：4
> 
> 时间：2012-12-27T01:00:04.783
> 
> 标签：python

如何将以下代码重新排列为简化的列表理解？

```
for i in xrange(len(list)):
    if list[i].startswith('c'):
        list[i] = prefix + list[i] 
```

我尝试了以下方法，但似乎没有用：

```
[prefix + list[i] for i in xrange(len(list)) if list[i].startswith('c')] 
```

以下让我失望：

```
list[i] = prefix + list[i] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T01:02:20.443

你需要在[`ternary operator`](http://docs.python.org/2/reference/expressions.html#conditional-expressions)这里使用：

```
[prefix + i if i.startswith('c') else i for i in my_list] 
```

请注意，这不会更改原始`my_list`，它只是返回一个新列表。

您可以简单地将列表理解分配回`my_list`以实现：

```
my_list=[prefix + i if i.startswith('c') else i for i in my_list] 
```

PS：不要`list`用作变量名

# python - 双数据库查询

> ID：14048165
> 
> 赞同：0
> 
> 时间：2012-12-27T01:00:43.893
> 
> 标签：python, database, sqlalchemy

我的一些代码：

```
u = User.query.filter_by(username=requested_username.lower()).first()

teamie = Team.query.filter_by(name=requested_team)
team = teamie.filter_by(user_id=u.id).first() 
```

^我做错了什么？（它不起作用 - 但我不知道为什么还有将两条与团队相关的线路合并为一条线路？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:30:21.560

这取决于你的 sqlalchemy 设置的其余部分，但如果我猜你的设置，我认为这可能会奏效：

```
u = User.filter_by(User.username==requested_username.lower()).first()

teamie = Team.filter_by(Team.name==requested_team)\
             .filter_by(Team.user_id==u.id).first() 
```

这是一个解释：首先，在您的 filter_by 语句中，您需要一个双等号“==”而不仅仅是“=”。此外，它实际上是具有查询方法的会话对象，而不是模型本身，因此您不需要查询，除非您像这样使用它（我假设您的会话对象实际上称为会话）：

```
u = session.query(User).filter_by(User.username==requested_username.lower()).first()

teamie = session.query(Team).filter_by(Team.name==requested_team)\
                            .filter_by(Team.user_id==u.id).first() 
```

最后，您通常需要在过滤器语句中使用 model.column 语法。希望能有所启发。

# java - 有和没有初始化为 null 的内存使用情况

> ID：14048167
> 
> 赞同：1
> 
> 时间：2012-12-27T01:01:17.600
> 
> 标签：java, memory, initialization

不初始化实例变量会节省内存吗？

例如，比较以下两个类：

```
public class Class1 {
    private String s;
    // getter/setter for s
}

public class Class2 {
    private String s = "";
    // getter/setter for s
} 
```

假设`""`其他地方已经有一个字符串常量，`new Class1()`消耗的内存是否比`new Class2()`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:23:39.410

不，默认情况下，未初始化的变量设置为 null。原始类型的其他一些默认初始化规则是：

*   `boolean`- 始终设置为 false。
*   `int`,`float`和`double` - 设置为零。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T01:02:45.050

可能取决于 JVM 实现。两者的主要区别在于生成的代码。`Class2`在所有情况下都将明确设置`s`某物的值。而`Class1`可能从未设置`s`为导致意外行为的特定内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T04:03:57.083

如果将其初始化为 null （默认值）没有区别，因为无论如何它都会被初始化，所以我认为不会有任何内存使用差异。

但通常为了更好地理解（无需记住所有代码阅读器的默认值），显式初始化它们似乎很好。

# php - 警告：mysql_fetch_array()：提供的参数不是第 40 行中的有效 MySQL 结果

> ID：14048170
> 
> 赞同：0
> 
> 时间：2012-12-27T01:01:34.520
> 
> 标签：php, html, mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

我不断收到错误警告：mysql_fetch_array()：提供的参数不是我网页第 40 行中的有效 MySQL 结果我不知道为什么..请帮助我。背景：此脚本用于将我的数据库表拉到名为 yname、用户名、密码、日期、评论、作品、dworks 的作品和 dworks 是为那些尝试过的人提供的，然后他们可以判断它是否有效 - 是的，它有效 dworks - 不，它没有工作，它应该是投票，忘记我的问题就像这个脚本的 40 一样，请帮助我

```
<php require "br.htm" ?>
<style>
<?php require "styles.css" ?>
</style>
<?php

$host="host"; // Host name 
$username="name"; // Mysql username 
$password="pass"; // Mysql password 
$db_name="dbname"; // Database name 
$tbl_name="passes"; // Table name 

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// select record from mysql 
$sql="SELECT * FROM $tbl_name order by id desc";
$result=mysql_query($sql);
?>
<table background='https://lh6.ggpht.com/DFABQFuYSXLBiB6qlvDPfOONOUxCiwM6_S-dHnjW82iognQToTkORsy7RVXsAz0Y23w=w705' width='50%'>
<tr>
<th align='center'>Submition By</th><th align='center'>ScreenName</th><th align='center'>Password</th><th align='center'>Does This Work?</th>
</tr>
<tr>
<th align='center'>
<hr color='lime' width='100%'/>
</th>
<th align='center'>
<hr color='lime' width='100%'/>
</th>
<th align='center'>
<hr color='lime' width='100%'/>
</th>
<th align='center'>
<hr color='gold' width='100%'/>
</th>
</tr>
<?php
while($rows=mysql_fetch_array($result)){
?>

<tr>
<td background='transparent' align='left'><i><b><? echo $rows['yname']; ?> </b></i></td>
<td background='transparent' align='center'><i><b><? echo $rows['username']; ?></b></i></td>
<td background='transparent' align='right'><i><b><? echo $rows['password']; ?></b></i></td>
<td background='transparent' align='right'><i><b>&nbsp;&nbsp;&nbsp;Yes<? echo $rows['works']; ?></b></i></td>
</tr>

<?php
// close while loop 
}
?>

</table>

<?php
// close connection; 
mysql_close();
?>
<center> 
```

我不想重新设计页面的样式，但如果我必须这样做的话。如果你看到有什么问题，请在下面发帖并告诉我它在哪一行以及如何更正它，然后我会回来告诉你如果它有效:) 谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T01:08:31.143

此错误表示您的查询失败。如果发生错误则`mysql_query()`返回，然后您将传递给哪个触发错误消息。`false``false``mysql_fetch_array()`

由于缺少/错误的表或字段，您的查询可能会失败。要查看详细错误，请打印`mysql_error()`.

* * *

该`mysql_*`库已弃用。建议升级到 MySQLi 或 PDO。

# java - 代码片段在 Eclipse 中被删除，为什么？

> ID：14048172
> 
> 赞同：6
> 
> 时间：2012-12-27T01:02:17.060
> 
> 标签：java, android, eclipse

在我制作 Android 应用程序时，Eclipse 会删除一些内容。更具体地说，`Gallery`. 这是一个屏幕截图：

![在此处输入图像描述](../Images/10dfd50582aaf1d26d299693c358b648.png)

当我将鼠标悬停在警告上时，它会显示`The type Gallery is deprecated`. 我不知道是什么`Deprecated`意思，但我知道这是一个 Java 术语。任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-27T01:04:22.800

（来自编辑前的问题：该术语已被弃用，而不是被贬值。这是一个常见的错字，但出于搜索目的值得注意:)

它基本上有点像“过时的”——我们鼓励您不要使用已弃用的类或方法。通常，文档会解释*为什么*您不打算使用它们，并为您提供更好的选择。通常，不推荐使用的版本仅用于向后兼容。

值得认真对待这一点 - 很多时候，如果您使用的是已弃用的 API，那么您会从根本上存在缺陷的方法中得到一些东西。[`Date`](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)是最明显的例子，Java 1.0 API 在 1.1 中几乎完全被弃用，当[`Calendar`](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html)它被引入时。使用不推荐使用的方法`Date`是为自己存储问题的可靠方法。

有关详细信息，请参阅 Oracle [“如何以及何时弃用 API”](http://docs.oracle.com/javase/7/docs/technotes/guides/javadoc/deprecation/deprecation.html)页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T01:03:38.973

已弃用意味着它曾经支持较旧的 SDK，但不再支持。这就是你收到警告的原因。
在大多数情况下它只是一个警告，但你最要小心，因为它可能会导致新版本出现问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T01:05:49.467

已弃用不是 Java 术语。它用于许多其他事情，但在编程中很多。它只是意味着它不再受支持......通常用其他东西代替。[Android Docs](http://developer.android.com/reference/android/widget/Gallery.html)将帮助您根据您正在做的事情调整它以适应您的需要

# css - 在 jQuery 中定位 ::selection 以获取输出？

> ID：14048175
> 
> 赞同：2
> 
> 时间：2012-12-27T01:03:10.670
> 
> 标签：css, jquery-selectors, jquery

我正在查看[http://jsfiddle.net/duhTB/](http://jsfiddle.net/duhTB/)，它使用 CSS 来定位 ::selection。

现在，我想做的有点不同。忍受我。

这是代码：http: [//jsfiddle.net/Ywq2x/15/](http://jsfiddle.net/Ywq2x/15/)。我正在尝试这样做，以便当我突出显示已输入到#id_input-id'd 文本区域的文本并按 ctrl+b 时，突出显示的文本将输出到 #id_selected-id'd 预块。

如果您发现我正在使用的代码有任何问题，请指出它们并告诉我如何纠正这些问题？如果我想要做的事情对 jQuery 来说是不可能的，你能解释一下为什么吗？如果还有其他方法，你能解释一下吗？

谢谢你。

为了方便和持久的力量，我还将在此处发布有问题的代码：

JS/jQuery

```
$(document).ready(function(e) {
    $("#id_input").keypress(function(e) {
        if(e.keyCode == 66 && e.ctrlKey) {    
            var val = $("#id_input::selection").val();
            $("#id_selected").text(val);
        }
    });
}); 
```

HTML：

```
<p>A1:</p>
<textarea rows="2" cols="30" class="txt_input_area dotted" id="id_input">
</textarea>
<div class="now_working">
  <pre id="id_selected"></pre>
</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T07:12:30.257

选择`::selected`器似乎在 jQuery 中不起作用，但好消息是 dwieeb 有一个[jquery-textrange 插件](https://github.com/dwieeb/jquery-textrange)，用于从输入字段和文本区域中获取选定的文本。

试试这个 ：

```
$(function() {
    $("#id_input").on('keydown', function(e) {
        if (e.keyCode == 66 && e.ctrlKey) {
            e.preventDefault();//inhibit opening Opera's sidebar
        }
    }).on('keyup', function(e) {
        if (e.keyCode == 66 && e.ctrlKey) {
            var txt = $("#id_input").textrange('get', 'text');
            $("#id_output").text(txt);
        }
    });
}); 
```

工作**[演示](http://jsfiddle.net/Ywq2x/17/)**

作为记录，这些是 jquery-textrange 的全部功能：

*   ('get', 'position')：光标在文本字段中的位置
*   ('get', 'start')：所选文本在文本字段中的起始位置
*   ('get', 'end')：所选文本在文本字段中的结束位置
*   ('get', 'length')：文本字段中选中文本的长度
*   ('get', 'text')：被选中的文本
*   ('set')：选择字段中的所有文本
*   ('set', n)：从第 n 个字符到文本末尾选择
*   ('set', n, length)：从第n个字符开始，选择`length`字符（或到文本末尾）
*   ('set', n, 0)：等价于 ('setcursor', n)
*   ('setcursor', n)：将光标设置到文本字段中的指定位置
*   ('replace', 'some text')：替换选中的文本，或者在光标位置插入。

*2014 年 2 月 28 日修订以反映插件的最新状态*

感谢 dwieeb 提供了一个插件，它消除了 Web 编程中最令人作呕的方面——文本范围——的痛苦。

# github - 如何在同一帐户上设置“Dev repo”（在产品和团队之间）

> ID：14048185
> 
> 赞同：0
> 
> 时间：2012-12-27T01:05:00.433
> 
> 标签：github

我已经这样做了，但肯定有更好的方法来做到这一点。

假设我有一个由 5 名开发人员组成的公司的组织帐户。

我可以在我的组织中建立一个 repo 并让所有开发人员分叉它，但我想要一个“dev repo”来合并每个人的工作并在推送到生产 repo 之前对其进行测试。

最好的方法是什么？我们可以将 repo 分叉到组织帐户中还是只创建独立的帐户？

因为我发现的唯一方法是创建另一个帐户“Company_Dev”，它分叉生产仓库“Company/Project”，每个开发人员都分叉“Company_Dev/Project”仓库，但可能有一种方法可以做到这一点业主对吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T11:26:53.030

git中似乎存在一个基本的误解。你有一个 repo，你已经通过设置一个 org. 那太棒了。您和您的开发人员在他们的存储库中分叉并单独工作。那也很好。

现在，如果您是首席开发人员，并且想了解人们的工作情况，您可以在 GitHub 上的中央 org 存储库中组织所有这些。即开发人员发送拉取请求，您将它们拉入开发分支，您不必将它们拉入主分支。在您的开发分支中，您可以测试合并后的代码，看看它是否符合您的需求。如果您不喜欢它，则不必将其与您的生产和/或主分支合并。

在 git 中，你使用分支来整理好和坏的东西。您批准的所有内容都合并。

# c - 了解 Cerrno

> ID：14048187
> 
> 赞同：3
> 
> 时间：2012-12-27T01:05:03.367
> 
> 标签：c, libc

在我的系统上`errno`定义为：

```
int *    __error(void);
#define errno    (* __error()) 
```

我理解`errno`是一个宏并扩展为`* __error()`功能：

1.  我到处搜索（我系统上的源代码），但我找不到`__error()`函数的定义，有人可以显示/解释它的定义是什么吗？

2.  表达式如何`errno = 0`与上述定义一起工作（分配`0`给函数？）？`errno = 0`扩展`* __error() = 0`为?

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-27T01:06:50.360

该`__error`函数返回一个指向`errno`调用线程变量的指针。宏取消引用该`errno`指针，从而产生一个可以出现在等号两侧的左值。

要回答您的问题：

1.  该函数确定该`errno`特定线程的变量的正确地址。每个线程都有自己的。

2.  是的，它变成`(* __error()) = 0;`了分配`0`给该线程`errno`变量的那个。

# jquery-ui - jQuery UI Tooltip 小部件自动关闭

> ID：14048189
> 
> 赞同：13
> 
> 时间：2012-12-27T01:05:32.650
> 
> 标签：jquery-ui, tooltip

我如何在 1 秒后自动关闭 jQuery UI Tooltip Widget。我使用以下代码：

```
var du=1000;    
$(document).tooltip(
{show:{effect:'slideDown',delay:du,duration:du/2}},
{hide:{effect:'explode',pieces:20,duration:du,delay:du/4}},
{track:true}
); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-27T02:13:20.330

尝试：

```
$(document).ready(function () {
    var du = 1000;
    $(document).tooltip({
        show: {
            effect: 'slideDown'
        },
        track: true,
        open: function (event, ui) {
            setTimeout(function () {
                $(ui.tooltip).hide('explode');
            }, du);
        }
    });
}); 
```

[小提琴](http://jsfiddle.net/Nzr4f/)

希望这可以帮助！

# java - 是否有任何 SaaS 可以生成高亮代码并与他人共享？

> ID：14048193
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:06:00.107
> 
> 标签：java, saas

例如，我写了一个代码。我想在互联网上与其他人分享，我们是否有任何 SaaS 网络服务可以在线执行此操作，可以生成网页并与他人分享。

高亮代码更好~~

更好地支持 c、C++、python、lisp、java、Ruby 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:35:08.923

[要点](http://gist.github.com/)呢？它似乎拥有您想要的所有元素，包括[API](http://developer.github.com/v3/gists/)和启用博客的亮点。

# android - 以编程方式排序 TableLayout 列值

> ID：14048203
> 
> 赞同：-3
> 
> 时间：2012-12-27T01:08:11.527
> 
> 标签：android, android-tablelayout

我有一个包含显示为分钟的字符串数据的 TableRow。我想以编程方式对该列数据进行排序/排序。那可能吗？我真的需要这个功能。
![在此处输入图像描述](../Images/e2375234b03e3e98cc906f80bfbc1e2c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:38:51.157

您显示的图像看起来不像单个`TableRow`；事实上，它看起来像 10。

无论如何，您应该做的是保留一份包含数据的列表，并对其进行排序。一个简单的方法是保留一个代表分钟的整数列表（在本例中为 76、84、46、68、8、9、78、78、68、46），然后对其进行排序。然后，您可以使用已排序的数据重新填充布局对象（无论它们是什么）。

```
ArrayList<Integer> minutes = new ArrayList<Integer>();
minutes.add(76);
minutes.add(84);
// ...
minutes.add(46);
Collections.sort(minutes); 
```

然后，如果您已经设置了视图，则可以使用 引用每个视图`findViewById()`，并调用`setText()`它们为它们提供信息，或根据数据创建视图：

```
ViewGroup group = ...; // Might be a TableRow, LinearLayout, whatever...
group.removeAllViews();
for (Integer i : minutes) {
    // Create a new view
    yourView.setText(i + "'"); // Put it in 0' format
    group.addView(yourView);
} 
```

然后，您的`group`布局将包含一组表示您的`minutes`数组的视图。

对于它的价值，最好在`ListView`这里使用 a；这就是它的设计目的。

# delphi - Delphi - Graphics32，绘制抗锯齿圆角矩形

> ID：14048204
> 
> 赞同：3
> 
> 时间：2012-12-27T01:08:22.940
> 
> 标签：delphi, antialiasing, graphics32

如何使用 Graphics32 绘制抗锯齿圆角矩形？

我设法用 TPolygon 在 bitmap32 画布上制作了一个普通矩形，但我找不到任何关于绘制圆角的参考。将不胜感激一些代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T05:01:49.630

```
function GetRoundedFixedRectanglePoints(const Rect: TFloatRect; dx, dy: single): TArrayOfFixedPoint;
var
  i, j, k, arcLen: integer;
  arcs: array [0 .. 3] of TArrayOfFixedPoint;
begin
  //nb: it's simpler to construct the rounded rect in an anti-clockwise
  //direction because that's the direction in which the arc points are returned.

  with Rect do
  begin
    arcs[0] := GetArcPointsEccentric(
      FloatRect(Left, Bottom -dy*2, Left+dx*2, Bottom), rad180, rad270);
    arcs[1] := GetArcPointsEccentric(
      FloatRect(Right-dx*2, Bottom -dy*2, Right, Bottom), rad270, 0);
    arcs[2] := GetArcPointsEccentric(
      FloatRect(Right - dx*2, Top, Right, Top + dy*2), 0, rad90);
    arcs[3] := GetArcPointsEccentric(
      FloatRect(Left, top, Left+dx*2, Top+dy*2), rad90, rad180);

    //close the rectangle
    SetLength(arcs[3], Length(arcs[3])+1);
    arcs[3][Length(arcs[3])-1] := arcs[0][0];
  end;

  //calculate the final number of points to return
  j := 0;
  for i := 0 to 3 do
    Inc(j, Length(arcs[i]));
  SetLength(Result, j);

  j := 0;
  for i := 0 to 3 do
  begin
    arcLen := Length(arcs[i]);
    for k := 0 to arcLen -1 do
      Result[j+k] := arcs[i][k];
    Inc(j, arcLen);
  end;
end; 
```

用法：

```
var
  pts: TArrayOfFixedPoint;
begin    
  pts := GetRoundedFixedRectanglePoints(FloatRect(Left+2, Top+2, Left + Width-2, Top + Height-2), 5, 5);

  SimpleFill(ABitmap32, pts, 0, Color32(clBlack)); 
```

# php - mysql 语法错误 - date_format

> ID：14048208
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:08:54.513
> 
> 标签：php, mysql, syntax-error, date-format

我正在尝试在 php 中格式化日期时间字段，但我收到此错误代码：

```
You have an error in your SQL syntax; check the manual that  
corresponds to your MySQL server version for the right syntax  
to use near 'DATE_FORMAT(date, '%b %d 
```

这是我的整个代码：

```
SELECT * FROM topics, DATE_FORMAT(date, '%b %d %Y, %h:%i %p') AS f_date 
```

我已经检查了所有内容，这通常是我进行格式化的方式，将代码与我完成的其他格式进行了比较。
有什么问题有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T01:11:23.590

尝试`SELECT *, DATE_FORMAT(date, '%b %d %Y, %h:%i %p') AS f_date FROM topics`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T01:14:55.550

您不能选择所有 (*)，然后使用该语法添加列。可以这样做：

```
SELECT topics.*, DATE_FORMAT(date, '%b %d %Y, %h:%i %p') AS f_date FROM topics 
```

编辑：正如@Vyacheslav Voronchuk 指出的那样，如果您只查询一个表，您可以使用 just`*`而不是。`topics.*`

# .net - 为 IIS Web 服务验证 iOS 应用程序

> ID：14048209
> 
> 赞同：0
> 
> 时间：2012-12-27T01:08:56.730
> 
> 标签：.net, ios, web-services, encryption

我的团队将构建一个应用程序的 iOS 和 Android 版本，供该领域的数百名员工使用。我们将在内部开发一个 .NET Web 服务，以便为这些应用程序提供数据。由于这将是我们第一次涉足移动开发，我想确保我们能够正确地进行。:)

考虑到这一点，实现以下目标的最佳方法是什么：

*   保护 .NET 网络服务，使除我们之外的其他应用程序无法使用它。
*   确保从 Web 服务到客户端应用程序的数据传输是安全的。
*   验证我们的用户 - Windows 还是 Forms 验证？

此外，如果有任何好的教程可以推荐用于开发用于移动应用程序的 Web 服务的最佳实践，请告诉我。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:39:03.743

- 使用带有适当证书的 https 而不是 http。

- 使用 IIS 重写模块只允许您的应用程序代理名称，或在 Web 配置中阻止其他人。

> ```
>  <rules>
>     <rule name="Ban user-agent RogueBot" stopProcessing="true">
>       <match url=".*" />
>       <conditions>
>         <add input="{HTTP_USER_AGENT}" pattern="googlebot|msnbot|slurp|yandex|yahoo|chrome|safari|google|explorer|mozilla|gecko|opera"/>
>       </conditions>
>       <action type="AbortRequest" />
>     </rule>
>   </rules> 
> ```

- 让您的移动客户端在第一次启动应用程序时生成唯一的随机 UUID，使用此 UUID 来识别客户端，当然您应该在每个请求中发送此 ID，并且您应该在帖子正文中发送，而不是在查询字符串中发送。SSL！在您在网络服务中做某事之前，您可以随时检查收到的 ID 是否已注册。

- 除了唯一 ID NTLM 身份验证之外，您还应该考虑实施 OAuth，我建议使用 1.0 而不是 2.0。文档可以在这里找到

对于 Web API，[这](http://www.asp.net/web-api)是一个很好的起点

# google-chrome - Google Chrome Hosted App 禁用标签地址栏，关闭其他标签，最大化窗口

> ID：14048210
> 
> 赞同：0
> 
> 时间：2012-12-27T01:09:02.703
> 
> 标签：google-chrome, hosted, google-chrome-app

我们试图通过 Google Chrome Hosted App 完成的一些任务如下。应用程序启动后，

```
 - the app will close all other tabs.
      - the address bar will be disabled
      - the app will open in maximum size window 
```

根据我对文档的阅读，我相信它可以通过打包的应用程序来实现。我认为打包的应用程序就像具有接收和发布信息的界面的移动应用程序。我们不想创建这样的接口，也不需要离线工作的功能。

我们开发团队中的一些人认为即使使用托管应用程序也可以实现上述功能，但不知道如何实现。

我被这个谜题困扰了很长一段时间。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T18:21:22.307

听起来你想要一个打包的应用程序。托管应用程序无法禁用地址栏。他们可以操纵标签，但这是一个糟糕的用户体验——我会看看打包应用程序的方法。

# visual-studio - 我可以在项目之间共享预编译头文件以减少编译时间吗？

> ID：14048212
> 
> 赞同：6
> 
> 时间：2012-12-27T01:09:34.370
> 
> 标签：visual-studio, precompiled-headers

我在 Visual Studio 中有近 200 个项目，构建它们所需的时间太长。我注意到为每个项目构建 stdafx.cpp（预编译头文件）很慢。我对每个项目都使用相同的标头，那么为什么我必须构建它约 200 次？如何构建一次并在项目之间共享？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T01:09:34.370

这个问题[以前也](https://stackoverflow.com/questions/3045645/precompiled-headers-question) [有人](https://stackoverflow.com/questions/645747/sharing-precompiled-headers-between-projects-in-visual-studio) [问](https://stackoverflow.com/questions/4128974/sharing-pre-compiled-headers-efficiently) [过](http://social.msdn.microsoft.com/Forums/en-US/vclanguage/thread/665d4183-f85c-481d-bada-03283b310099)，但是 Visual Studio 变了。

在 Visual Studio 2008 中，可以与一些黑客共享预编译的标头。指定一个项目来构建 PCH，并让其他所有项目都依赖它（项目依赖关系）。确保您只有一个 stdafx.h 并且每个项目都可以使用 #include "stdafx.h"（附加包含目录）看到它。将每个客户端项目设置为使用主 PCH 文件（预编译头文件）。现在使用 xcopy 将 master 的 .pdb 和 .idb 复制到*每个客户端输出目录*中。您必须将主项目设置为输出具有不同名称的 pdb（输出文件）。有关更多详细信息，请参见上面的链接。

在 Visual Studio 2010 和 Visual Studio 2012 中，没有已知的共享 PCH 文件的方法。

# html - 为什么我的块元素的宽度和高度为 0？

> ID：14048217
> 
> 赞同：1
> 
> 时间：2012-12-27T01:10:36.827
> 
> 标签：html, css

我正在为 5 星评级系统开发 html，由于某种原因，我无法让我的锚点具有宽度和高度，即使我将它们设置为块元素也是如此。我已将问题缩小到以下基本代码：

CSS：

```
.outerdiv{
    height:20px;
    width:90px;
    background-color:red;
    }
.innerdiv{
    height:20px;
    width:63px;
    background-color:blue;
    }
.1{
    display:block;
    height:20px;
    width:18px;
    z-index:5;
    background-color:green;
    }
.1:hover{
    background-color:orange;
    }​ 
```

HTML：

```
<div class="outerdiv">
    <div class="innerdiv">
        <a class="1"></a>
    </div>
</div>​ 
```

同样位于：http: [//jsfiddle.net/knoell8504/qsjqL/4/](http://jsfiddle.net/knoell8504/qsjqL/4/) 此代码与我正在使用的代码之间的主要区别在于，此代码使用背景颜色，而我的代码使用背景图像。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T01:12:30.270

类名不能以数字开头（我认为这在 HTML5 中有所改变，但这仍然不是一个好主意）。因此没有应用样式。

# python - 如何在 Python 中存储第三方服务的用户密码？

> ID：14048219
> 
> 赞同：1
> 
> 时间：2012-12-27T01:10:40.877
> 
> 标签：python, security, python-3.x, passwords, credentials

这不一定需要 Python 特定的答案，但这就是我正在使用的，确切地说是 Python 3.2。我也在Linux下开发。

我有一个脚本，它连接到网站、登录并为用户获取信息。如何安全地存储用户的凭据？或者最佳实践是什么？加密似乎很愚蠢，因为加密的凭据和加密密钥将在同一个地方。我唯一能想到的就是存储在一个限制读取访问的文件中，但这感觉我做得还不够。但是，这大致是如何在 Rails答案[中存储第三方服务的凭据中描述的内容。](https://stackoverflow.com/questions/11365207/how-to-store-credentials-for-third-party-services-in-rails)

我只想尽我所能尊重用户的安全。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:16:27.787

您可能希望将其存储在内存中，并让他们在启动程序时输入一次（还包括使其成为程序而不仅仅是脚本，除非脚本永远不会消失）。然而，这也受到一些攻击。

如果您有权访问要从中检索信息的网站，您可能需要设置二级、有限特权（只读）帐户，这样即使密码被泄露，也没什么大不了的（假设数据本身不太敏感）。这就是我不使用 mint.com 的原因，但如果他们与银行合作来实现此功能，我会这样做。

# ruby-on-rails - rails - 未配置开发数据库

> ID：14048221
> 
> 赞同：0
> 
> 时间：2012-12-27T01:10:52.013
> 
> 标签：ruby-on-rails, redmine

我正在尝试设置 redmine 并创建了一个愚蠢的简单 database.yml，如下所示：

```
development:
  adapter: sqlite3
  database: db/development.sqlite3
  pool: 5
  timeout: 5000

production:
  adapter: sqlite3
  database: db/production.sqlite3
  pool: 5
  timeout: 5000 
```

当我运行`rake db:create`它时，它会按预期创建开发数据库。然而，当我运行`rake db:migrate`它失败说：

```
development database is not configured! 
```

`db:migrate`如果`database.yml`配置正确到可以创建数据库，为什么我不能运行？

**编辑：**

我运行`RAILS_ENV=development rake db:migrate`并收到以下错误消息：

```
Invalid gemspec in [/var/lib/gems/1.8/specifications/mail-2.4.4.gemspec]: invalid date format in specification: "2012-03-14 00:00:00.000000000Z"
Invalid gemspec in [/var/lib/gems/1.8/specifications/tilt-1.3.3.gemspec]: invalid date format in specification: "2011-08-25 00:00:00.000000000Z"
NOTE: SourceIndex.new(hash) is deprecated; From /usr/share/redmine/config/../vendor/rails/railties/lib/rails/vendor_gem_source_index.rb:100 in `new'.
rake aborted!
ERROR: 'rake/rdoctask' is obsolete and no longer supported. Use 'rdoc/task' (available in RDoc 2.4.2+) instead. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T01:38:24.850

尝试运行

```
RAILS_ENV=development rake db:migrate 
```

您也可以使用 --trace 运行 rake 任务来找出问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T01:14:04.527

检查`config/environment.rb`您正在运行的模式。如果没有记错，redmine 默认在生产模式下运行。

# java - 当有人输入字母作为菜单选项时输出错误

> ID：14048222
> 
> 赞同：-2
> 
> 时间：2012-12-27T01:10:51.550
> 
> 标签：java

当有人输入字母作为菜单选项时，我想让这个程序输出错误

```
package main;

import java.util.Scanner;

public class Main {
    Scanner input = new Scanner(System.in);

    public static void main(String[] args) {
        int UserIn = 0;
        double numberInputA;
        double numberInputB;
        double Answer;

        Scanner input = new Scanner(System.in);

        while (UserIn != 5) {
            System.out.println("What type of calculation would you like to perform?");
            System.out.println("1\. Add\n2\. Subtract\n" +
                               "3\. Multiply\n4\. Divide\n5\. Exit");
            UserIn = input.nextInt();

            if (UserIn > 5) {
                System.out.println("ERROR choose the numbers on the menu");
            } else if (UserIn < 1) {
                System.out.println("ERROR choose the numbers on the menu");
            }

            if (UserIn < 5) {
                System.out.println("Enter first number:");
                numberInputA = input.nextDouble();
                System.out.println("Enter second number");
                numberInputB = input.nextDouble();

                if (UserIn == 1) {
                    Answer = numberInputA + numberInputB;
                    System.out.println("Number 1 is:" + numberInputA);
                    System.out.println("Number 2 is:" + numberInputB);
                    System.out.println("Result is : " + Answer);
                    System.out.println("");
                }

                if (UserIn == 2) {
                    Answer = numberInputA - numberInputB;
                    System.out.println("Number 1:" + numberInputA);
                    System.out.println("Number 2:" + numberInputB);
                    System.out.println("Result is :" + Answer);
                    System.out.println("");
                }

                if (UserIn == 3) {
                    Answer = numberInputA * numberInputB;
                    System.out.println("Number 1:" + numberInputA);
                    System.out.println("Number 2:" + numberInputB);
                    System.out.println("Result is :" + Answer);
                    System.out.println("");
                }

                if (UserIn == 4) {
                    Answer = numberInputA / numberInputB;
                    System.out.println("Number 1:" + numberInputA);
                    System.out.println("Number 2:" + numberInputB);
                    System.out.println("Result is :" + Answer);
                    System.out.println("");
                }
            }

            if (UserIn == 5) {
                System.out.println("Program exited");
            }

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:53:25.123

如果您想在用户输入正确之前使用循环功能，您可以使用此代码段。

```
while(true){
   try{
      UserIn = input.nextInt();
      break;
   }catch (Exception ex){
         System.out.println("Not an acceptable input.");
         input.nextLine();
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:19:53.293

您可以使用“Character.isLetter(char)”检查字符是否为字母

```
if(Character.isLetter(UserIn))
{
    //do something
} 
```

希望这可以帮助！

（PS：以后请把你的文本格式更清晰一点，并且清楚你的问题到底是什么，不仅在标题栏中，而且在问题的主要内容中。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T03:54:04.510

您可以简单地在代码中应用 try catch 块，以便在您方便时输出错误，例如：

```
 try{
        while (UserIn != 5) {
            System.out.println("What type of calculation would you like to perform?");
            System.out.println("1\. Add\n2\. Subtract\n" +
                    "3\. Multiply\n4\. Divide\n5\. Exit");
            UserIn = input.nextInt();

            if (UserIn > 5) {
                System.out.println("ERROR choose the numbers on the menu");
            } else if (UserIn < 1) {
                System.out.println("ERROR choose the numbers on the menu");
            }

            if (UserIn < 5) {
                System.out.println("Enter first number:");
                numberInputA = input.nextDouble();
                System.out.println("Enter second number");
                numberInputB = input.nextDouble();

                if (UserIn == 1) {
                    Answer = numberInputA + numberInputB;
                    System.out.println("Number 1 is:" + numberInputA);
                    System.out.println("Number 2 is:" + numberInputB);
                    System.out.println("Result is : " + Answer);
                    System.out.println("");
                }

                if (UserIn == 2) {
                    Answer = numberInputA - numberInputB;
                    System.out.println("Number 1:" + numberInputA);
                    System.out.println("Number 2:" + numberInputB);
                    System.out.println("Result is :" + Answer);
                    System.out.println("");
                }

                if (UserIn == 3) {
                    Answer = numberInputA * numberInputB;
                    System.out.println("Number 1:" + numberInputA);
                    System.out.println("Number 2:" + numberInputB);
                    System.out.println("Result is :" + Answer);
                    System.out.println("");
                }

                if (UserIn == 4) {
                    Answer = numberInputA / numberInputB;
                    System.out.println("Number 1:" + numberInputA);
                    System.out.println("Number 2:" + numberInputB);
                    System.out.println("Result is :" + Answer);
                    System.out.println("");
                }
            }

            if (UserIn == 5) {
                System.out.println("Program exited");
            }

        }
    }catch (Exception e) {
        System.out.println("Invalid Input !!! Program will exit");
    } 
```

# c# - C#中两个项目的循环依赖

> ID：14048235
> 
> 赞同：13
> 
> 时间：2012-12-27T01:12:33.200
> 
> 标签：c#, circular-dependency

我在名为 ProjectA (ConsoleApplication) 和 ProjectB (ClassLibrary) 的解决方案中有两个项目。ProjectA 具有对 ProjectB 的引用。一般来说，ProjectA调用ProjectB中的一个方法来做一些事情，并将结果返回给ProjectA。但是，有时我需要 ProjectB 向 ProjectA 发送一些“附加”信息（更具体地说，是调用`Console.WriteLine()`ProjectA 中的方法）。为此，我需要在 ProjectB 中引用 ProjectA，但是当我尝试这样做时，出现以下错误：

`A reference to ProjectA could not be added. Adding this project as a reference would cause a circular dependency`.

我了解整个耦合概念，并且收到此消息确实有意义，但是，在某些情况下，我需要向 ProjectA 发送其他信息。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-27T01:59:20.183

实际上可以创建具有成功编译的循环依赖项的项目，但我*强烈*建议不要这样做。相反，组织您的项目，使它们具有非循环依赖图。

有很多方法可以解决这个问题，其中一些已经在其他答案中提到过。一个尚未发布的是完全消除项目 A 和项目 B 之间的依赖关系，并创建*第三个*项目 C，它定义了 A 和 B 通信的接口。那是：

```
namespace C
{
    public interface IFoo { void Frob(); }
    public interface IBar { void Qux(); }
} 
```

然后让项目 A 和 B 引用项目 C，并让他们的类实现 IFoo、IBar 等。当项目 A 中的方法需要对项目 B 中的对象调用 Frob 时，它通过获取 IFoo 来实现，而不是获取 B 中的某个类。

那有意义吗？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-27T01:15:01.670

我建议你使用事件和监听器。例如，您可以从 ProjectB 发送消息，`Trace.WriteLine`而在 ProjectA 中，您可以为跟踪添加订阅者。.NET 已经提供了一个`ConsoleTraceListener`类，用于将`Trace`消息路由到控制台。您可以通过以下方式从 ProjectA 添加侦听器：

```
Trace.Listeners.Add(new ConsoleTraceListener()); 
```

或者，如果您不想使用集成类，您可以在 ProjectB 中构建一个非常简单的“源”类，它将公开一个事件`Action<string>`作为其签名（尽管我建议您为其创建一个委托），然后从 ProjectA 订阅它。通常，.NET 类更灵活。

**项目B**

```
public static class MyTrace
{
    public static event Action<string> MessageReceived;

    internal static void Broadcast(string message)
    {
        if (MessageReceived != null) MessageReceived(message);
    }
} 
```

**项目A**

```
MyTrace.MessageReceived += s =>
{
    /*Operate*/
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T01:15:20.547

你不能这样做。如果项目相互调用，它们应该在同一个项目中。或者，ProjectB 可以将其信息公开，以便 ProjectA 可以访问它，而不是 ProjectB 调用 ProjectA。

你不能有循环依赖。你怎么能？编译器如何知道首先构建哪个？你有一个基本的设计问题，这就是需要解决的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T01:35:55.507

我实际上会在 ClassB 上创建自己的活动

```
public event EventHandler MySpecialHook; 
```

EventHandler 是一个标准的委托

```
public delegate void EventHandler(object sender, EventArgs e); 
```

然后，在您的 Class A 中，在创建 ClassB 的实例之后，当 B 中发生 A 应该知道的事情时，挂钩到事件处理程序以进行通知。很像 OnActivated、OnLostFocus、OnMouseMove 或类似事件（但它们具有不同的委托签名）

```
public class ClassB {

public event EventHandler MySpecialHook;

public void SomeMethodDoingActionInB()
{

    // do whatever you need to.
    // THEN, if anyone is listening (via the class A sample below)
    // broadcast to anyone listening that this thing was done and 
    // they can then grab / do whatever with results or any other 
    // properties from this class as needed.
    if( MySpecialHook != null )
        MySpecialHook( this, null );
 } 
}

public class YourClassA
{

   ClassB YourObjectToB;

   public YourClassA
   {
      // create your class
      YourObjectToB = new ClassB();
      // tell Class B to call your "NotificationFromClassB" method
      // when such event requires it
      YourObjectToB += NotificationFromClassB;
   }

   public void NotificationFromClassB( object sender, EventArgs e )
   {
      // Your ClassB did something that your "A" class needs to work on / with.
      // the "sender" object parameter IS your ClassB that broadcast the notification.
   }
} 
```

# asp.net - 导致 JavaScript 运行时错误的链接按钮：无法获取未定义或空引用的属性“id”

> ID：14048236
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:12:33.983
> 
> 标签：asp.net, ajax

我有一个 Javascript 代码来检查是否单击了链接按钮，我会执行一些服务器端操作，并且在操作完成后，将触发一些 UI 动画。

**Javascript：**

```
function endRequestHandler(sender, args) {
 if (sender._postBackSettings.sourceElement.id == 'lbSearch')
 {
     //Ui animation code goes here...
 }
} 
```

**代码背后**

```
 sp.RegisterAsyncPostBackControl(lbSearch); 
```

**LinkBut​​ton 的ASPX 声明**：

```
<asp:LinkButton ID="lbSearch" runat="server" CssClass="searchButton" OnClick="btnManualSearch_Click">></asp:LinkButton></span> 
```

而且，当我将鼠标悬停时，它显示

```
javascript:__doPostBack('ctl00$cphTopLeft$lbSearch','') 
```

但它一直显示，“JavaScript 运行时错误：无法获取未定义或空引用的属性 'id'”，有人知道是什么导致了问题吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-27T01:36:32.443

这些 id 是您为代码隐藏输入的内容。ASP.NET 2.0 为 html 生成另一个 id。所以在你的javascript中找不到它.... [stackoverflow.com/questions/2444239/](https://stackoverflow.com/questions/2444239/)

# apache - 虚拟主机文档路由之外的 Apache 别名

> ID：14048239
> 
> 赞同：1
> 
> 时间：2012-12-27T01:13:14.623
> 
> 标签：apache, alias

我有一种情况，我的图像与我的文档根目录位于同一级别。

所以我需要 /Users/jwindhall/Sites/gdw/my_app/images (www.example.local/images)

指向 /Users/jwindhall/Sites/gdw/images。

我一直在做：

其余的...

```
<VirtualHost *:80>
ServerAdmin example@whatever.com
DocumentRoot "/Users/jwindhall/Sites/gdw/my_app/"
ServerName www.example.local
ServerAlias www.example.local
<Directory "/Users/jwindhall/Sites/gdw/my_app">
   Options All Includes Indexes FollowSymLinks
   Order allow,deny
   Allow from all
   AllowOverride All
</Directory>
Alias /images /Users/jwindhall/Sites/gdw/images
</VirtualHost> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:19:55.247

需要在您的`Alias`虚拟主机中定义（或直接在服务器配置中，但这可能不是一个好主意）：

```
<VirtualHost *:80>
    ServerAdmin example@whatever.com
    DocumentRoot "/Users/jwindhall/Sites/gdw/my_app/"
    ServerName www.example.local
    ServerAlias www.example.local
    <Directory "/Users/jwindhall/Sites/gdw/my_app">
        Options All Includes Indexes FollowSymLinks
        Order allow,deny
        Allow from all
        AllowOverride All
    </Directory>

    Alias /images /Users/jwindhall/Sites/gdw/images
    <Directory "/Users/jwindhall/Sites/gdw/images">
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T01:22:09.040

将别名放在 VirtualHost 中。此外，您不需要与 ServerName 相同的 ServerAlias。

```
 <VirtualHost *:80>
    ServerAdmin example@whatever.com
    DocumentRoot "/Users/jwindhall/Sites/gdw/my_app/"
    ServerName www.example.local
    <Directory "/Users/jwindhall/Sites/gdw/my_app">
       Options All Includes Indexes FollowSymLinks
       Order allow,deny
       Allow from all
       AllowOverride All
    </Directory>
    Alias /images /Users/jwindhall/Sites/gdw/images
 </VirtualHost> 
```

如果这不起作用，你会得到什么错误？apache 用户是否有权访问图像目录？

# ios - 带有情节提要的 IOS Facebook 登录屏幕

> ID：14048240
> 
> 赞同：0
> 
> 时间：2012-12-27T01:14:03.520
> 
> 标签：ios, login, uitableview

你好我搜索了很多。我试图做的是在 facebook 应用程序或 twitter 中构建我自己的登录界面。 [不知道我的意思？看看这个](http://extdesenv.com/wp-content/uploads/2012/05/facebook-login-ios.png)

我想知道是否有人知道使用情节提要的教程甚至示例应用程序来创建具有组原型单元格的登录屏幕视图控制器？

非常感谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:18:04.930

使用[解析](http://www.parse.com)。

真的就这么简单...

Parse 是一个适用于 iOS 的 SDK，它允许你做各种各样的事情，以及使用他们很棒的免费实现包来全面管理用户帐户。

Parse SDK 带有一个完全可定制的登录和注册控制器，它与您的应用程序的在线用户数据库链接。他们有很棒的教程，你可以[在这里](https://www.parse.com/docs)查看他们的文档。

编辑：

请求后，这里是一个类似的 SO 问题的链接，其中有一个更以登录为中心的答案： [如何制作像 Facebook 应用程序一样的登录屏幕？](https://stackoverflow.com/questions/8961914/how-to-make-a-login-screen-like-facebook-app)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-26T14:13:23.807

我最终构建了一个视图控制器，加载了背景图像并添加了[底部单元格图像](http://i.stack.imgur.com/YgsP5.png)和 [顶部单元格图像](http://i.stack.imgur.com/eNiub.png)

然后将标签添加到它的安全文本。

该图像很难看到它的白色图像。右击下载图片。这行得通

# java - Hibernate：在非主键上跨连接表连接（但这是其中的一部分）

> ID：14048242
> 
> 赞同：3
> 
> 时间：2012-12-27T01:14:12.530
> 
> 标签：java, hibernate, hibernate-mapping

我正在尝试映射具有一些相当有趣的连接场景的遗留数据库。我特别试图通过连接表连接到非主键。现在，我收到一个错误，指出引用未映射到单个属性

## 数据库

首先是数据库，对于这个问题已经大大简化了。有三个感兴趣的表： ![数据库关系图](../Images/df2547e2a79ffd17d198a3a9f8cc87be.png)

**User**表包含主要数据并包含一列“ReferenceId”。**Location**表的相似之处在于它也有一个“ReferenceId”，并表示我想在一天结束时嵌入到用户中的数据。该表值得注意，因为它 a) 具有复合键 b) 我尝试加入的列是该键的一部分。最后，**UserLocation**是将它们联系在一起的表，具有referenceIds 到ReferenceIds 的映射。

## 课程

现在将它们映射在一起。我有我的课：

**用户**：

```
@Entity
@Table(name = "user")
public class User implements Serializable {
    private static final long serialVersionUID = 3709178675764332063L;

    @Id
    private Long id;

    @Column(name = "uname")
    private Long name;

    @OneToOne(targetEntity = Location.class, fetch = FetchType.LAZY)
    @JoinTable(name = "CandidateLocation", joinColumns = { @JoinColumn(name = "UserReference") }, inverseJoinColumns = { @JoinColumn(name = "LocationReference", referencedColumnName="ReferenceId") })
    private Location location;

} 
```

和地点：

```
@Entity
@Table(name = "Locations")
@IdClass(LocationPK.class)
public class Location implements Serializable {
    private static final long serialVersionUID = -582319915736694876L;

    @Id
    @Column(name = "referenceId")
    private Long referenceId;

    @Id
    @Column(name = "IDParam1")
    private Long IDParam1;

    @Column(name = "loc_name")
    private String name;

    // ETC... 
} 
```

## 问题

我得到的问题是该关联不起作用。相反，我得到一个如下所示的异常：

> org.hibernate.AnnotationException：com.foo.User.location 的 referencedColumnNames(ReferenceId) 引用 com.foo.Location 未映射到单个属性。

我不能省略，`referenceColumnName`否则它将默认为PK，但除此之外，我有点茫然。希望我错过了对其他人来说显而易见的东西。任何帮助将不胜感激。

# c++ - 从基类调用重写的方法

> ID：14048244
> 
> 赞同：21
> 
> 时间：2012-12-27T01:14:29.837
> 
> 标签：c++, methods, overriding

假设我有以下课程：

```
class A {
 public:
  virtual void foo() {
    bar();
  }

 protected:
  virtual void bar() {
    // Do stuff
  }
}

class B : public A {
 protected:
  virtual void bar() {
    // Do other stuff
  }
} 
```

如果我有一个 B 的实例并调用 foo 方法，会调用哪个 bar 方法？这个编译器是特定的吗？

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-27T01:17:16.113

如果`A::foo`您`B::bar`有`B`. 实例是通过指针引用还是基类引用无关紧要：不管这个，`B`调用 's 版本；这就是使*多态*调用成为可能的原因。该行为不是特定于编译器的：虚函数根据标准以这种方式运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-17T23:35:09.370

你不能，但你可以绕过它。在这种情况下，您可以将`true`默认 bool 参数添加到 A 构造函数，并`false`在 B 中将 a 传递给它：

```
class A 
{
public:
    A(bool construct = true) { 
        if (!construct) return;
        bar(); 
    }
    virtual void bar() { cout << "A::bar" << endl; }
};

class B : public A 
{
public:
    B() : A(false) { bar(); }
    void bar() override { cout << "B::bar" << endl; }
};

int main()
{
    A a;
    B b;
} 
```

输出：

```
A::bar
B::bar 
```

# python - Python 使用 dict .get() 方法，其中 value = 0

> ID：14048246
> 
> 赞同：3
> 
> 时间：2012-12-27T01:14:38.473
> 
> 标签：python, dictionary

（Python 2.7.2）我想更好地理解为什么在映射到键的值为0时使用字典.get（）方法查找键时返回默认值。

考虑以下

```
x = {1:0}

print x.get('1', 'a')

'a' 
```

空字符串、集合等也会发生同样的情况。

但如果我这样做：

```
print x[1]
0 
```

当引发 a 并且返回的值为 0 或空集时，该方法是否`.get()`返回`default value`两者？`keyError`

是否与 dict 对象是不可变的事实有关，并且当我指向存储在 上的值时`key = 1`，我得到了一个对等于 False 的对象的引用。

我知道我可以编写自己的 get 方法来执行

```
def get(key, default=None):
    try: return x[key]
    except KeyError: return default 
```

但我想对该`.get`方法有更深入的了解。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T01:16:41.760

`1` != `'1'`; an `int` isn't equal to a `str`.

```
>>> x = {1:0}
>>> 
>>> print x.get('1', 'a')
a
>>> print x.get(1, 'a')
0 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T01:17:05.667

You made mistake in your first experiment:

```
>>> x = {1: 0}
>>> x.get('1', 'a')
'a'
>>> x.get(1, 'a')
0 
```

In Python, dict keys can be any hashable type, not just strings.

# actionscript-3 - 底层的按钮不起作用

> ID：14048247
> 
> 赞同：0
> 
> 时间：2012-12-27T01:14:53.507
> 
> 标签：actionscript-3, flash, actionscript, flash-cs5

我在舞台上有 4 个按钮，顶层有 2 个，底层有 2 个。顶层按钮与底部按钮重叠。当我看到底部按钮出现时，顶部按钮在被点击时会隐藏起来（效果很好）。问题是底层按钮处于活动状态，即使已经设置了监听器，就像顶层按钮一样？我尝试`btn.enabled=true;` `btn.mouseChildren =false;`了`btn.buttonMode=true`底部按钮，甚至两次摆脱了听众但没有帮助。是 Flash IDE 的问题吗？我是 Flash 和 ActionScript 的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:22:16.223

看起来像常见的隐形重叠问题。当它们被点击时，您是否设置了`.alpha = 0;`顶部按钮？如果是，那就是问题所在。将其更改为`.visible=false;`.

试试看！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:21:41.067

尝试跟踪按钮的每个操作，然后查找单击侦听器是否处于活动状态..

# java - 什么更好用于创建布局。Java 还是 XML？

> ID：14048255
> 
> 赞同：3
> 
> 时间：2012-12-27T01:15:41.913
> 
> 标签：java, android, xml

我是新手，`Android`正在开发一个新的应用程序。

我在`XML`文档中创建了一些布局，这些布局恰好相当大。我知道如果我用`Java`循环创建布局可以节省很多空间，但另一方面布局是我可能不需要经常更改的东西。

什么是更好的性能明智？`Java`代码还是`XML`布局？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T05:31:45.637

大多数时候我更喜欢`layout XML resource`文件，但它会根据需要而变化。

1.  首先，资源集（例如，`res/layout-land/`除了`res/layout/`）允许您定义在不同情况下使用的多个 UI。

    *   layout-land -> 用于横向

    *   布局端口 -> 用于纵向

    *   layout-v15 -> 安卓版本 >= 15

    *   layout-sw600dp -> 用于特定宽度的屏幕

2.  其次，有一些工具可以帮助您成功创建这些布局资源。Eclipse 的拖放式 GUI 构建就是其中之一。

3.  第三，它往往更简洁，因此如果您手动输入这些内容，XML 将减少输入。

4.  在 Java 代码中，您必须编译并运行代码以查看布局的外观，而在 XML（如果您使用 eclipse）中，您可以直接使用 eclipse 提供的工具查看它。

对于所有静态的东西，我都使用 XML，因为它很容易在您的项目结构中找到。

但在某些情况下，您想要创建动态布局，而您别无选择，只能使用 Java 代码。在这方面要聪明，所以如果您必须添加几个看起来相同的视图，请执行此操作

> 从我的角度来看，`xml layouts`如果您希望 android 自动处理布局，这很好。这适用于 **数据输入类型的应用程序（如银行应用程序）**。Java 布局更适合需要严格控制 UI 的应用程序（如愤怒的小鸟）

# windows-phone-7 - 我想设计一个metro风格的登录页面，有人能给我一些建议吗？

> ID：14048275
> 
> 赞同：1
> 
> 时间：2012-12-27T01:18:17.837
> 
> 标签：windows-phone-7, login, styles, microsoft-metro

很多人认为没有磁贴不是地铁风格，所以我想在我的登录页面中添加一些磁贴。但是页面的功能很简单，添加磁贴可能会破坏整个页面布局。有人可以给我一些建议或告诉我地铁式登录页面的特点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:30:05.943

您可以使用 Twitter Bootstrap [http://twitter.github.com/bootstrap/](http://twitter.github.com/bootstrap/)开发页面，这是一个您可能已经知道的框架，由 Twitter 开发。它可以帮助您快速制作原型，但也可以将其用于生产。它创建了一个布局网格。它可以是固定的或流动的，并且是响应式的。

然后在你下载 Bootstrap 之后，你可以使用一个名为 Bootmetro 的引导主题，你可以在这个 Github 存储库中找到它：http: [//aozora.github.com/bootmetro/](http://aozora.github.com/bootmetro/)

# symfony - Symfony2 在“Symfony\Component\HttpKernel\EventListener\RouterListener”之后静默失败

> ID：14048276
> 
> 赞同：0
> 
> 时间：2012-12-27T01:18:58.647
> 
> 标签：symfony, development-environment

我的 Symfony2 项目无声无息地失败了。PHP 中没有致命错误输出，PHP 错误日志中没有任何内容。

dev.log 的最后一行始终是：

```
[2012-12-27 01:14:05] event.DEBUG: Notified event "kernel.request" to listener 
 "Symfony\Component\HttpKernel\EventListener\RouterListener::onKernelRequest". [] [] 
```

关于它为什么会死的任何想法？

**更新**

另外值得注意的是，这仅在我的产品服务器上。本地还好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T14:30:54.690

固定的。

设法在那里使用无限循环`forward()`。

它一定是刚刚崩溃。

# antlr - ANTLR4 键/值语法

> ID：14048277
> 
> 赞同：1
> 
> 时间：2012-12-27T01:19:15.073
> 
> 标签：antlr, antlr4

我有一个非常简单的键/值语法（不是我正在研究的实际语法，但这是我能想到的最简单的语法，它显示了我的问题），它似乎与 ANTLR 4.0b4 中的词法分析器匹配顺序有问题。语法是：

```
grammar test;

r     : HELLO COLON VALUE;
HELLO : 'hello';
COLON : ':';
VALUE : .+; 
```

鉴于此语法和输入 'hello:world' 我希望它能够正确解析，但是似乎整个输入被拉入单个 VALUE 令牌并因此失败：

```
hello:world
[@0,0:11='hello:world\n',<3>,1:0]
[@1,12:11='<EOF>',<-1>,2:12]
line 1:0 mismatched input 'hello:world\n' expecting 'hello' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T03:03:34.910

语法编译器应该发出关于`.+`在词法分析器中使用贪婪的警告。

该`VALUE`规则的字面意思是“尽可能多地使用字符，而不考虑字符是什么”。如果您的输入不*完全是* `hello`or ，那么您的词法分析器将使用包含整个输入`:`的单个标记。`VALUE`

也许以下词法分析器更接近您所追求的：

```
lexer grammar textLexer;

HELLO : 'hello';
COLON : ':' -> pushMode(ValueMode);

mode ValueMode;

    VALUE : ~[\r\n]+ -> popMode; 
```

# geolocation - 如何将 LocationTracking 添加到我的 WMAppManifest 文件中？

> ID：14048278
> 
> 赞同：0
> 
> 时间：2012-12-27T01:19:29.067
> 
> 标签：geolocation, manifest, winrt-xaml, windows-phone-8

基于此演示文稿中的代码：http: [//channel9.msdn.com/Series/MVA-Jump-Start/Building-Apps-for-Windows-Phone-8-Jump-Start-14-Maps-and-Location-在 Windows-Phone-8 中](http://channel9.msdn.com/Series/MVA-Jump-Start/Building-Apps-for-Windows-Phone-8-Jump-Start-14-Maps-and-Location-in-Windows-Phone-8)

...我尝试将“LocationTracking”添加到 WMAppManifest.xml，但没有显示的 xaml：

```
<Tasks>
<DefaultTask Name="_default" NavigationPage="MainPage.xaml">
      <BackgroundExecution>
        <ExecutionType Name="LocationTracking" />
      </BackgroundExecution>
</DefaultTask>
</Tasks> 
```

...也不是以下内容，类似于编译器似乎想要的东西：

```
 <ExtendedTask>
    <ExecutionType Name="LocationTracking" />
  </ExtendedTask> 
```

...会编译。

有人如何让这个工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:39:34.993

你在那里的第一个代码片段工作得很好。您不需要添加整个`<Task>`元素，因为它已经是 WmAppmanfiest 的一部分，只需添加`<BackgroundExecution/>`嵌套元素。

有关端到端示例，[请参阅本文，您可以在](http://www.developer.nokia.com/Community/Wiki/What%27s_new_in_Windows_Phone_8#Apps_Tracking_GeoLocation_in_the_background)[此处](http://www.developer.nokia.com/Community/Wiki/images/a/a8/WhatsNewInWP8_FullExample.zip?20121030190717)下载示例代码。

# java - 如何更改 JAXB 实现？

> ID：14048283
> 
> 赞同：2
> 
> 时间：2012-12-27T01:20:46.350
> 
> 标签：java, jaxb, annotations

如何将默认 JAXB 实现更改为另一个？我正在运行 Java 1.7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:58:55.773

您必须将一个名为的文件放置`jaxb.properties`在与域模型相同的包中，其内容如下，将 EclipseLink MOXy 指定为 JAXB (JSR-222) 提供者（我是 MOXy 负责人）。

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)

# java - Java Regex 去除分隔字符串中的所有前导零

> ID：14048285
> 
> 赞同：2
> 
> 时间：2012-12-27T01:21:30.503
> 
> 标签：java, regex

我有字符串“08,09,10,11”，我想要“8,9,10,11”，即去掉所有前导零。

正则表达式

```
"08,09,10,11".replaceAll("^0+(?!$)", "") 
```

接近但给了我 '8,09,10,11' （即 9 上的零没有被剥离。

有人有我可以用来做我需要的正则表达式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-21T20:37:04.533

这将起作用：

`str.replaceAll("^0+", "")`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-27T01:23:54.290

我认为这会起作用：

```
str.replaceAll("(?<!\d)0+(?=\d+)", ""); 
```

这里有一些测试： http: [//fiddle.re/rp57](http://fiddle.re/rp57)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-23T08:57:58.070

这里提到了两种方法之间的区别：

```
str.replaceAll("^0+", "")

"0001000" ----> "1000"
"0000000" ----> ""

replaceAll("^0+(?!$)", "")

"0001000" ----> "1000"
"0000000" ----> "0" 
```

(?!$) 是一个所谓的负前瞻，寻找字符串的结尾，不要删除字符串结尾后面的“0”。因此，如果前导零也是字符串的最后一个字符，它不会被删除

# z-index - 试图让 z-index 与 div 和 section 一起工作

> ID：14048298
> 
> 赞同：0
> 
> 时间：2012-12-27T01:22:35.900
> 
> 标签：z-index

我有一个部分和一个 div 一个接一个，我想让 div 稍微低于 margin-top:-10px 的部分，以切断我用border-radius创建的圆角。现在所发生的只是顶部部分向上移动，其中的文本位于 div 顶部，而不是部分本身。这是 jsfiddle [http://jsfiddle.net/37PkJ/](http://jsfiddle.net/37PkJ/)中的内容。基本上我不会让橙色和黑色落在蓝色之下。谢谢

html/wordpress

```
<?php
/*
Template Name:Home
*/
?>
<?php get_header(); ?>
    <section id="mastHead">
        <div id="navResponsive">
            <ul>
                <li><a href="#about">about</a></li>
                <li><a href="#skills">skills</a></li>
                <li><a href="#contact">contact</a></li>
                <li><a href="#footer"><i class="icon-twitter"></i></a></li>
                <li><a href="http://www.linkedin.com/pub/austin-kitson/31/143/296" target="_blank"><i class="icon-linkedin"></i></a></li>
            </ul>
        </div>
        <div id="nav">
            <ul>
                <li><a href="#about">about</a></li>
                <li><a href="#skills">skills</a></li>
                <li><a href="#contact">contact</a></li>
                <li><a href="#footer"><i class="icon-twitter"></i></a></li>
                <li><a href="http://www.linkedin.com/pub/austin-kitson/31/143/296" target="_blank"><i class="icon-linkedin"></i></a></li>
            </ul>
        </div>
    </section>
    <div id="menu">
        <div id="menuCenter">
            <a href="toggleMenu"><i class=" icon-reorder"></i></a>
        </div>
    </div>
<?php get_footer(); ?> 
```

css

```
html {
  font-size: 62.5%; }

#container {
  background: aqua;
  width: 100%; }

#mastHead li {
  list-style-type: none; }

ul {
  margin: 0;
  padding: 0; }

#navResponsive {
  display: none; }

#menu {
  display: none; }

/*-------------MEDIA QUERIES BITCHES---------------*/
/*-------------------------------------------------*/
/* Smartphones (portrait and landscape) ----------- */
@media only screen and (min-width: 320px) and (max-width: 1024px) {
  #navResponsive {
    display: block;
    background: #44749d;
    width: 50%;
    margin-left: auto;
    margin-right: auto; }
    #navResponsive li {
      text-align: center; }
    #navResponsive a {
      font-size: 3em; }

  #nav {
    display: none; }

  #menu {
    display: block;
    width: 50%;
    background: orange;
    margin-left: auto;
    margin-right: auto; }

  #menuCenter {
    width: 4.5em;
    padding: 1em;
    border-radius: 0.5em;
    margin-left: auto;
    margin-right: auto;
    background: black; }
    #menuCenter a {
      text-decoration: none; }
    #menuCenter i {
      font-size: 5em; } }
/*---------------END MEDIA QUERIES-----------------*/
/*-------------------------------------------------*/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:58:22.417

我必须在 mastHead div 上将位置设置为相对位置。简单的。

# python - 将变量从一个函数移动到另一个函数（在 Django 用户注册中），python

> ID：14048299
> 
> 赞同：0
> 
> 时间：2012-12-27T01:22:43.717
> 
> 标签：python, django, variables, global

我对此很陌生，我已经尝试了几个小时，但它不起作用。如果您能帮助我，我将不胜感激。太感谢了。

这是我的代码：

```
def login_view(request):

    username1 = request.POST['username']
    password1 = request.POST['password']
    user = auth.authenticate(username=username1, password=password1)
    if user is not None and user.is_active:
        # Correct password, and the user is marked "active"
        auth.login(request, user)
        # Redirect to a success page.
        return HttpResponseRedirect("/account/loggedin/")
    else:
        # Show an error page
        return HttpResponseRedirect("/account/invalid/")

def profile_page(request):
    html = loader.get_template('profile_test.html')
    login_view(request)
    c = Context({'user' : username1})
    return HttpResponse(html.render(c)) 
```

当我将 username1 放在 profile_page 引号中时，一切正常。但是，当我使用 username1 作为全局变量时，它不起作用。如何使用 username1 作为全局变量？非常感谢，我已经尝试了好几个小时了，但没有任何效果。再次感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:30:19.970

因为没有返回 HttpResponse，所以 login_view 调用什么也不做。

如果您的用户已登录，则任何请求都应自动包含该用户。所以，例如：

```
if request.user.is_authenticated():
    user = request.user
    context['user'] = user.username 
```

否则，您可以在 url 中传递用户，然后在视图中获取用户名（或者只使用模板中的用户对象并将 {{ user.username }} 插入到您的模板中。

# ios - 如何在中心呈现具有自定义大小的模态视图控制器？

> ID：14048301
> 
> 赞同：9
> 
> 时间：2012-12-27T01:23:07.257
> 
> 标签：ios, ios6, xamarin.ios, uikit, uimodalpresentationstyle

我想展示一个自定义大小的模态视图控制器，底部有动画。`ModalPresentationStyle`我可以用to来实现这个动画`FormSheet`，但[它迫使我使用默认大小 540x620](http://commanigy.com/blog/2010/11/18/uimodalpresentationformsheet-width-and-height-for-an-ipad-in-landscape-mode)并且我的视图不适合。

如何对放置在屏幕中心的任意大小的视图（控制器）执行类似的转换？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T01:23:07.257

我没有从模态控制器本身找到一种方法，所以我创建了一个类和一个扩展方法：

```
public class ModalViewController : UIViewController
{
    public SizeF OriginalViewSize { get; private set; }

    void Initialize ()
    {
        ModalPresentationStyle = UIModalPresentationStyle.FormSheet;
    }

    public override void ViewDidLoad ()
    {
        OriginalViewSize = View.Bounds.Size;
        base.ViewDidLoad ();
    }

    public ModalViewController (IntPtr handle) : base (handle)
    {
        Initialize ();
    }

    public ModalViewController (string nibName, NSBundle bundle) : base (nibName, bundle)
    {
        Initialize ();
    }

    public ModalViewController () : base ()
    {
        Initialize ();
    }
}

public static class ModalViewControllerExtensions
{
    public static void PresentModalViewController (this UIViewController parent, ModalViewController target)
    {
        parent.PresentViewController (target, true, null);

        target.View.Superview.AutoresizingMask = UIViewAutoresizing.FlexibleMargins;
        target.View.Superview.Frame = new RectangleF (PointF.Empty, target.OriginalViewSize);
        target.View.Superview.Center = UIScreen.MainScreen.Bounds.Center ().Rotate ();
    }
} 
```

这大致是我使用它的方式：

```
this.PresentModalViewController (
    new PublishModalViewController (Item, HandlePublishAction)
); 
```

我不需要显式指定大小很方便，因为它使用界面构建器中的根视图边界。我不确定这对自动旋转有何反应，可能需要一些调整。我在这里也使用了两种扩展方法：

```
public static PointF Rotate (this PointF pt)
{
    return new PointF (pt.Y, pt.X);
}

public static PointF Center (this RectangleF rect)
{
    return new PointF (
        (rect.Right - rect.Left) / 2.0f,
        (rect.Bottom - rect.Top) / 2.0f
        );
} 
```

就是这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-29T09:56:34.030

更简单的方法如下

将模态视图控制器呈现为表单，并在模态视图控制器中添加：

```
public override void ViewWillLayoutSubviews ()
{
    base.ViewWillLayoutSubviews ();
    this.View.Superview.Bounds = new RectangleF (0, 0, 900, 700);
} 
```

如果您不希望 ios 分配默认表单大小，则设置所需的宽度和高度很重要

更新：在 ios 8 中，至少在某些情况下，上述解决方案会触发无限循环。似乎在某些情况下（例如当在模态视图中嵌入 webview 并在某些 html 输入文本中点击时）更改超级视图边界会触发模态视图上的布局，从而导致无限循环和应用程序冻结。但在 ios 8 中，您可以简单地设置 PrefferedSize 属性来达到相同的效果。

# c++ - c ++：如何将任何文件读入std :: string

> ID：14048305
> 
> 赞同：5
> 
> 时间：2012-12-27T01:23:12.403
> 
> 标签：c++, file, utf-8, ucs2, ucs

我有一堆 txt 文件，想将它们读入 std::string，其中一些是 UCS-2、UTF-8 编码的。如何将它们读入 std::string。我只想将任何文本文件读入 std::string。我必须转换它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:52:30.607

它们的读取方式取决于您的操作系统支持什么以及您使用的语言环境。

如果您只是天真地读入文件而不接触您的语言环境，并且它们的语言环境与您的 std c++ 库正在使用的语言环境不匹配，您可能会遇到困难。单字节和多字节字符集的类似问题。

在读取文件之前没有可靠的方法来判断文件的语言环境（元数据可能是错误的），所以一般的策略是先尝试以最常见的格式读取，然后用不同的格式重新尝试如果失败（即遇到无效字符）。即便如此，它也可能是模棱两可的。这是一个看似复杂的问题，您在解析带有疯狂字符集的 HTML 时遇到了同样的问题。

通常，有两组文件 I/O 函数可用，一组用于多字节字符集，另一组用于单字节字符集。不过，对此功能的支持是特定于平台的，因此，如果您使用的是未添加特殊字符支持的英文本地化操作系统，那么如果不使用外部库，C++ 可能不会直接支持多字节集。

Microsoft 为 cin 和 cout 指定了非标准扩展。通过在它们前面加上 aw，它们按字节宽度分隔流。

```
wcout << "儫"; 
```

这可以按您的预期工作，但您必须`#define _UNICODE`编译它。作为旁注，Windows 将其许多系统 API 调用分为两个版本，一个采用单字节字符串，另一个采用多字节字符串。即`CreateProcessA`与`CreateProcessW`。

总而言之，IO 功能是按照字符集的字节宽度和语言环境来划分的。为了给你一个更有针对性的回答你的问题，我需要更多地了解你的目标。查看 C++ 的语言环境支持以更好地了解这一点。特别是和中`ios_base`的语言环境函数。目前还没有很好的方法来处理广泛部署的 C++ 版本的这些问题，尽管我知道这些问题在即将发布的 C++ 版本中得到了缓解。`imbue``getloc`

# android - Galaxy S3 应用程序调试：无法打开 zip 存档。没有权限

> ID：14048307
> 
> 赞同：2
> 
> 时间：2012-12-27T01:23:19.737
> 
> 标签：android, eclipse

USB 调试已启用，安装非市场应用程序已启用，并且我的设备在 Eclipse 中被正确识别。但是当我尝试在连接手机的情况下运行我的应用程序时，我得到：

```
[2012-12-26 19:07:38 - TestApp] Installing TestApp.apk...
[2012-12-26 19:07:39 - TestApp] Installation failed due to invalid APK file!
[2012-12-26 19:07:39 - TestApp] Please check logcat output for more details.
[2012-12-26 19:07:39 - TestApp] Launch canceled! 
```

LogCat 显示了这一点：

```
Unable to open Zip archive 'data/local/tmp/TestApp.apk': Permission Denied
failed to open Zip archive 'data/local/tmp/TestApp.apk' 
```

我用谷歌搜索了一段时间，找不到任何可以作为解决方案的东西，但我只是不知道发生了什么。有人说要启动一个 adb shell 并使用 chmod 777 /data。尝试了它的地狱，但它没有用。其他人说这可能是自定义 ROM 问题，所以我恢复为 root 股票，但它仍然给我同样的问题。我还尝试使用 Eclipse 清理项目，重新启动所有内容并删除我的 .android 文件夹。我完全不知所措。

有谁知道会发生什么？

编辑：如果我将其通过电子邮件发送给自己并通过 gmail 应用程序安装，该应用程序也可以正常安装。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-12T07:59:09.420

[https://stackoverflow.com/a/14890187/1155151](https://stackoverflow.com/a/14890187/1155151)

这个答案在我的 Galaxy S3 上为我解决了同样的问题

如果您已将手机植根，则可能会出现 data/local/tmp 目录具有 -rw----- 权限并且归 root 拥有且安装程序进程权限不足的问题。创建符号链接绕过了这个问题，因为这个文件夹的权限似乎在某些时候被覆盖了。

```
# cd /data/local
# mv tmp tmp-old # (or simply rm -rf tmp)
# mkdir /mnt/sdcard/tmp
# ln -s /mnt/sdcard/tmp ./tmp 
```

# silverlight - 列表框默认图片

> ID：14048310
> 
> 赞同：0
> 
> 时间：2012-12-27T01:23:24.417
> 
> 标签：silverlight, windows-phone-7

在 Windows phone 7 应用程序中，我正在用远程图像填充一个列表框.. 因为图像不会立即下载，所以我想加载默认图像，直到远程图像准备好。做这个的最好方式是什么？

到目前为止，我有以下代码骨架：

```
public partial class RemoteImage : PhoneApplicationPage
{
    ObservableCollection<Image> images = new ObservableCollection<Image> { };

    public RemoteImage()
    {
        InitializeComponent();

        listImage.ItemsSource = GetAllImages();
    }

    private ImageSource GetImageSource(string fileName)
    {
        return new BitmapImage(new Uri(fileName, UriKind.Absolute));
    }

    private ObservableCollection<Image> GetAllImages() 
    {
        WebClient restClient = new WebClient();
        restClient.OpenReadAsync(new Uri(@"http://www.my-api.com"));
        restClient.OpenReadCompleted += new OpenReadCompletedEventHandler(onReadComplete);

        return images;
    }

    private void onReadComplete(object sender, OpenReadCompletedEventArgs args)
    {
        Stream stm = args.Result;

        DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(RootObject));
        RootObject ro = (RootObject)ser.ReadObject(stm);

        foreach (var item in ro.items)
        {
            images.Add(new Image{ PhotoSource = GetImageSource(item.image.link) });    
        }
    }    
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T05:30:15.187

如果您知道需要多少图像，则应首先创建默认图像的数量。直接在您的项目中加载一些图像文件并将其用作默认图像的 imageSource。然后，当您完成下载远程图像时，您应该为每个图像设置新的图像源。

当我遇到类似的问题时，我在定义哪个确切下载的图像是指页面上的哪个对象时遇到了一些问题。（你还记得 WebClient 对象是异步工作的，所以如果你在页面上有 10 个图像并一次下载 10 个远程图像，你不能说第一个下载的图像是页面上的第一个）要解决这个问题，你可以创建更复杂的下载方法（我使用委托来传输图像的 ID/名称）或使用递归（启动第一个图像的下载方法，下载它，在页面上设置一个源，下载下一个......）。

# ios - iOS OpenTok - 如何设置视频视图的样式？

> ID：14048313
> 
> 赞同：2
> 
> 时间：2012-12-27T01:23:47.147
> 
> 标签：ios, view, video-streaming, styling

我正在使用 OpenTok iOS 框架来允许在我的应用程序中进行视频聊天。但是，我正在尝试找到一种方法来自定义显示用户和连接用户流的视图的样式。根据我的发现，这些视图似乎是在 OTVideoView 文件中创建的，但我只能访问标题。

谁能指出我如何自定义流视图的正确方向，以便我可以使它看起来比默认样式更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T00:12:33.193

您好，publisher.view 的每个 Subscriber.view 实际上是一个 UIView 对象（技术讲座：OTVideoView 是 UIView 的子类）。您可以通过对视图应用变换等来设置您喜欢的样式。

例如，要动态调整宽度/高度，您可以执行以下操作： [_publisher.view setFrame:CGRectMake(left, top, width, height)];

你可以对 UIView 做的任何事情，你都可以用 OTVideoView 做。这是 UIView 的文档：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)

希望有帮助，宋

PS 如果你有时间，请查看这篇关于使用 Core Graphics 和 OpenTok 的视频流来做一些漂亮的图像识别的博客文章！ [http://www.tokbox.com/blog/fun-with-core-graphics-in-ios/](http://www.tokbox.com/blog/fun-with-core-graphics-in-ios/)

# android - Is it possible to program an Arduino from an Android device?

> ID：14048317
> 
> 赞同：0
> 
> 时间：2012-12-27T01:24:25.603
> 
> 标签：android, gcc, arduino

Is it possible to write Arduino programs on Android phones?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:45:29.250

Actually, it seems like it is possible. What you need is AVR-GCC to compile your code, and it looks like [someone has ported](http://code.google.com/p/andavr/) it to [Android](http://en.wikipedia.org/wiki/Android_%28operating_system%29).

But how you would go about getting the program onto your Arduino device I'll guess is quite a bit harder though.

You'll probably want to check out the forum post *[Android Hosted Toolchain](http://www.avrfreaks.net/index.php?name=PNphpBB2&file=printview&t=122043&start=20)*.

# iphone - 在 Objective-C 中读取 JSON

> ID：14048322
> 
> 赞同：0
> 
> 时间：2012-12-27T01:25:07.613
> 
> 标签：iphone, objective-c

> **可能重复：**
> [哪个 JSON 库用于 iPhone 上的数据](https://stackoverflow.com/questions/1977800/which-json-library-to-use-for-data-on-iphone)

我有一个 JSON 文件。我想读取每个元素值并将这些值存储到一个数组中。

我该如何进行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T01:27:30.093

使用`NSJSONSerialization`. 它是内置的。

[http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html](http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)

# javascript - javascript中的上下文

> ID：14048323
> 
> 赞同：3
> 
> 时间：2012-12-27T01:25:19.413
> 
> 标签：javascript

```
function katana(){
  this.isSharp = true;
}
katana();
assert( isSharp === true, "A global object now exists with that name and value." );

var shuriken = {
  toss: function(){
    this.isSharp = true;
  }
};
shuriken.toss();
assert( shuriken.isSharp === true, "When it's an object property, the value is set within the object." ); 
```

我实际上没有得到这段代码试图告诉什么？谁能解释一下 JavaScript 中的 Context 是什么，以及上面代码中的 context 到底代表什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T01:34:20.020

好吧，`this === window`第一个示例和`this === shuriken`第二个示例中的原因都与创建这些函数的位置有关。请注意，当您`shuirken.toss`在对象之外定义时，`this`指向窗口对象。当你调用`katana`with时`new`，`this`指向新创建的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T01:39:13.333

第一次调用相当于：

```
katana.call(window); // window is now referenced as this inside the function 
```

以类似的方式，您可以将调用更改为`katana()`这样以更改上下文：

```
var shuriken = {}
katana.call(shuriken); // shuriken.isSharp === true 
```

第二次调用隐含了这个等效的函数调用：

```
shuriken.toss.call(shuriken); 
```

# javascript - 如何使用 Knockout.js 将下拉列表中的选定项目自动更新到 SignalR 中所有连接的客户端？

> ID：14048324
> 
> 赞同：1
> 
> 时间：2012-12-27T01:25:23.367
> 
> 标签：javascript, data-binding, asp.net-mvc-4, knockout.js, signalr

**已解决**：

添加了新的更正代码行并注释了旧代码行。

* * *

对于使用**SignalR****的实时**应用程序，我希望所有连接的客户端都可以实时看到用户所做的更改。

 **可以使用简单的**文本****框**，但是当我使用**下拉列表**时：当用户选择一个项目时，我希望从下拉列表中选择的项目**自动设置（自动更新）**到所有连接的客户端。

**Knockout.js**似乎是显而易见的选择，但我认为我在订阅时遇到问题......或其他地方？

我有的：

（**ASP .NET Razor**）**下拉列表**：

```
//@Html.DropDownListFor(model => model.UserProfile.UserId, (SelectList)ViewBag.DDLUsersId, "Select User", new { @class = "ui-corner-all", @data_bind="value: selectedResponsible_UserId" })

@Html.DropDownListFor(model => model.UserProfile.UserId, (SelectList)ViewBag.DDLUsersId, "Select User", new { @class = "ui-corner-all", @data_bind="value: Responsible_UserId" }) 
```

( **HTML** ) 生成：

```
//<select class="ui-corner-all" data-bind="value: selectedResponsible_UserId" id="UserProfile_UserId" name="UserProfile.UserId"><option value="">Select User</option>

<select class="ui-corner-all" data-bind="value: Responsible_UserId" id="UserProfile_UserId" name="UserProfile.UserId"><option value="">Select User</option>
    <option value="1">test1</option>
    <option value="2">test2</option>
</select> 
```

( **JavaScript** )**视图模型**：

```
function taskViewModel(id, title, Responsible_UserId, ownerViewModel)
{
    this.taskId = id;

    this.title = ko.observable(title);

    //this.selectedResponsible_UserId = ko.observable(Responsible_UserId);

    this.Responsible_UserId = ko.observable(Responsible_UserId);

    this.notification = function (b) { notify = b }

    var self = this;

    this.title.subscribe(function (newValue) 
    {
        ownerViewModel.updateTask(ko.toJS(self));
    });

    //this.selectedResponsible_UserId.subscribe(function (newValue) 

    this.Responsible_UserId.subscribe(function (newValue) 
    {
        ownerViewModel.updateTask(ko.toJS(self));
    });
} 
```

( **JavaScript** )来自**客户端的****函数**，它使用指定的对象从**服务器端调用函数：**

 ****```
this.updateTask = function (task)
{    
    if (notify) 
        this.hub.server.s_Update(task);
} 
```

( **C#** )来自**服务器端的****函数**，它修改**数据库**中的值并从**客户端**为所有连接的具有指定对象的**客户端调用函数：**

 ******```
public bool S_Update(Task updatedTask)
{
    using (var context = new ToDoDbContext())
    {
        var oldTask = context.Tasks.FirstOrDefault(t => t.taskId == updatedTask.taskId);

        if (oldTask == null)
            return false;
        else
        {
            oldTask.title = updatedTask.title;

//??? Here, value 'updatedTask.Responsible_UserId' was NULL !!!
            oldTask.Responsible_UserId = updatedTask.Responsible_UserId;

            context.SaveChanges();

            Clients.All.C_TaskUpdated(oldTask);

            return true;
        }
    }
} 
```

（**JavaScript**）来自**客户端**的**函数**应该**更新****接口**：

 ******```
this.hub.client.C_TaskUpdated = function (t)
{
    var task = ko.utils.arrayFilter(tasks(), function (value) { return value.taskId == t.taskId; })[0];

    notify = false;
        task.title(t.title);    

//!! obvious, here was set to NULL.     
        //task.selectedResponsible_UserId(t.Responsible_UserId);

        task.Responsible_UserId(t.Responsible_UserId);
    notify = true;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T15:41:29.723

如果我正确地遵循这一点，您的道具会`selectedResponsible_UserId`在客户端和`Responsible_UserId`服务器上调用。看起来这种潜在的不匹配导致了您的问题。******************

# jquery - 使用 jQuery 的 Chrome 扩展程序泄漏内存

> ID：14048327
> 
> 赞同：1
> 
> 时间：2012-12-27T01:25:55.553
> 
> 标签：jquery, google-chrome, memory-leaks, google-chrome-extension, chromium

我目前正在开发一个使用内容脚本的扩展（jquery 是内容脚本之一），我注意到页面在长时间使用后会变慢。页面不是动态的，而是在每次点击时刷新（点击按钮时转到不同的页面）。如果我打开任务管理器，我可以清楚地看到内容脚本是造成内存泄漏的原因。

扩展已禁用（大约 20 次刷新后）

![扩展已禁用](../Images/6319d805454ffaec738d404c7e1f64da.png)

启用（大约 20 次刷新后）

![启用扩展](../Images/77b77cb018093d3b96395512cbc08b8e.png)

我通过删除所有其他脚本并通过删除 jQuery 脚本来确认泄漏，从而将泄漏范围缩小到 jQuery 和 jQueryUI 脚本，以便不再存在泄漏。

我正在使用最新版本的 jQuery，并且在使用它的其他页面中没有看到这种泄漏。

我能做些什么来至少减少内存泄漏吗？

**- 编辑**

扩展是[Project-Axeman](https://github.com/JustBuild/Project-Axeman)，所以如果你认为它是其他泄漏的东西，你可以看看。

**- 更新**

我已将 jQuery 替换为 beta 版本，但问题仍然存在...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T06:19:08.800

有[**`Demo's`**](https://developers.google.com/chrome-developer-tools/docs/heap-profiling-summary)使用 chrome 的开发者工具的 Heap Profile，有了这些你可以得到

*   对象占用[空间](https://developers.google.com/chrome-developer-tools/docs/heap-profiling-summary)概览
*   通过多次调用操作留下的[垃圾](https://developers.google.com/chrome-developer-tools/docs/heap-profiling-comparison)
*   [检查](https://developers.google.com/chrome-developer-tools/docs/heap-profiling-containment)闭包的变量，并窥探对象内部
*   发现[DOM 泄漏](https://developers.google.com/chrome-developer-tools/docs/heap-profiling-dom-leaks) 等等

但是，任务管理器中还有一些其他选项，它们提供的细节比**抽象内存值**更多。

![在此处输入图像描述](../Images/00254a6b70bde0ee87fdf0a74008f348.png)

# java - 如何在 JAXB 中执行某些操作，例如忽略 xml 元素的顺序？

> ID：14048329
> 
> 赞同：0
> 
> 时间：2012-12-27T01:26:07.363
> 
> 标签：java, xml, binding, jaxb, annotations

更具体的问题：如何克服 JAXB 中的以下限制（如果可能）：

1) xml 文件的验证需要在 HD 的某处创建模式文件。我不应该创建一个新文件来验证 xml。我确实使用一些流找到了关于堆栈溢出的帖子，但想知道是否还有其他方法。

2）如何在我的文件中指定 xml 元素并仍然加载它。例如，我希望以下两个都正确加载：

```
<xml>
 <defaults .../>
 <people>
 ...
 </people>
</xml>

<xml>
 <people>
 ...
 </people>
 <defaults .../>
</xml> 
```

用于解组的代码：

```
JAXBContext context = JAXBContext.newInstance(MyConfig.class);

SchemaFactory sf = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);

context.generateSchema(new MySchemaOutputResolver(schemaF));

Unmarshaller unmarshaller = context.createUnmarshaller();
Schema schema = sf.newSchema(schemaF);
unmarshaller.setSchema(schema);
MyConfig loaded = (MyConfig)unmarshaller.unmarshal(settingsU);

   private static class MySchemaOutputResolver extends SchemaOutputResolver {

      public MySchemaOutputResolver(File schemaFile) {
         this.schemaFile = schemaFile;
      }

      @Override
      public Result createOutput(String namespaceUri, String suggestedFileName) throws IOException {
         return new StreamResult(schemaFile);
      }

      private File schemaFile;
   } 
```

属性也是如此。即乱序指定属性也应该起作用。我还没有测试过属性，但上面肯定无法加载。JAXB 对元素强制执行顺序。在上面的例子中应该是可选的。

3) 允许属性和元素是可选的。如果未指定，文件仍应加载，只是不设置缺少的属性（即使用类中初始化的默认值）。目前这也不起作用。如果即使 required=false 我也没有放置属性，它只是无法加载整个文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T02:03:46.040

**回答 1**

您可以使用 Bean Validation (JSR 303) 注释来指定验证规则而不是 XML 模式。

**回答 2 & 3**

默认情况下，JAXB (JSR-222) 实现不要求元素按模式顺序或存在所需的元素以便将 XML 解组为对象形式。如果你有一个`Schema`集合，你可以设置一个`ValidationEventHandler`忽略错误。

*   [http://blog.bdoughan.com/2010/12/jaxb-and-marshalunmarshal-schema.html](http://blog.bdoughan.com/2010/12/jaxb-and-marshalunmarshal-schema.html)

# tsql - 为什么有人会在 T-SQL 中将空字符串添加到参数中？

> ID：14048330
> 
> 赞同：2
> 
> 时间：2012-12-27T01:26:24.343
> 
> 标签：tsql

我继承了一组到处都有这种东西的脚本：

```
coalesce(''+ColumnName+'', '') 
```

我了解合并的使用，但是有充分的理由不只是这样吗？

```
coalesce(ColumnName, '') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T12:53:49.350

是的，您完全正确， coalesce(ColumnName, '') 等效于 coalesce(''+ColumnName+'', '') 无论 ColumnName 是否具有 varchar/char 等效数据类型。COALESCE 返回其参数中的第一个非空表达式。

# node.js - node.js 应用程序的 Publish-AzureServiceProject 命令失败

> ID：14048331
> 
> 赞同：1
> 
> 时间：2012-12-27T01:26:26.093
> 
> 标签：node.js, azure

我正在按照本教程将 node.js 应用程序从我的机器部署到 Windows azure： [https ://www.windowsazure.com/en-us/develop/nodejs/tutorials/getting-started/](https://www.windowsazure.com/en-us/develop/nodejs/tutorials/getting-started/)

我的命令如下：

```
Publish-AzureServiceProject -ServiceName socketlistener -Location "East US" -Launch 
```

但我收到以下错误

```
Publishing  to Windows Azure. This may take several minutes...

1:32:36 PM - Preparing runtime deployment for service 'socketlistener'
1:32:38 PM - Preparing deployment for socketlistener with Subscription ID: ***...
1:32:40 PM - Verifying storage account 'socketlistener'...

Publish-AzureService : Path for package doesn't exist in D:\dev\node\socketlistener\cloud_package.cspkg.
At line:1 char:21
Publish-AzureService <<<<
CategoryInfo : CloseError: (:) [Publish-AzureService], FileNotFoundException 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T04:37:19.030

我怀疑是您的应用程序配置（服务定义或服务配置）存在一些问题，导致包创建问题。错误消息也暗示了同样的问题。基于 Publish-AzureServiceProject 命令执行，下一步是在验证存储帐户后创建包。在创建包之后，下一步是连接服务端点，您可以在上面您在教程中关注的相同链接中验证该端点。

要验证您的机器或与 Windows Azure 应用程序的连接没有问题，请尝试创建一个新的 Node.js 应用程序，添加新的 web/worker 角色并且不要对配置进行任何更改，然后尝试部署。这将验证您的机器配置（如果有）或其他问题是否有任何问题：

*   新 AzureServiceProject your_node_project
*   添加 AzureNodeWebRole
*   发布-AzureServiceProject -ServiceName socketlistener-位置“美国东部”-启动

# javascript - 制作一个javascript文件

> ID：14048332
> 
> 赞同：-5
> 
> 时间：2012-12-27T01:26:54.817
> 
> 标签：javascript, jquery

我想问我是否可以将以下 JavaScript 代码合并到一个文件中？

当我输入一个 file.js

```
$(document).ready(function(){$(&#39;#slider-with-blocks-1&#39;).royalSlider({arrowsNav:true,arrowsNavAutoHide:false,fadeinLoadedSlide:false,controlNavigationSpacing:0,controlNavigation:&#39;bullets&#39;,imageScaleMode:&#39;none&#39;,imageAlignCenter:false,blockLoop:true,loop:true,numImagesToPreload:6,transitionType:&#39;fade&#39;,keyboardNavEnabled:true,block:{delay:400} })  }); 
```

和

```
$(document).ready(function(){
$(&#39;.credit &#39;).append(&#39; credit by &lt;span&gt;&lt;/span&gt;&#39;);
$(&#39;.credit span&#39;)
.html($(&#39;<a/>&#39;).attr(&#39;href&#39;,&#39;www.google.com&#39;)
 .text(&#39;This is my link to google!&#39;)
 );
$(&#39;.credit span a&#39;)
.attr(&#39;id&#39;, &#39;credit&#39;);
}); 
```

和

```
$(&quot;[role=&#39;navigation&#39;]&quot;).flexNav(); 
```

和

```
window.onload = function() {
    if (!document.getElementById('credit') || document.getElementById('credit').href != "http://www.google.com/") {
        alert('Kreditnya jangan diilangin sob!');
    }
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:37:38.827

将其存储在 js 文件中：

```
$(document).ready(function(){
    $('#slider-with-blocks-1').royalSlider(
        {arrowsNav:true,
         arrowsNavAutoHide:false,
         fadeinLoadedSlide:false,
         controlNavigationSpacing:0,
         controlNavigation:'bullets',
         imageScaleMode:'none',
         imageAlignCenter:false,
         blockLoop:true,
         loop:true,
         numImagesToPreload:6,
         transitionType:'fade',
         keyboardNavEnabled:true,
         block:{delay:400} });

    $('.credit ').append(' credit by &lt;span&gt;&lt;/span&gt;');
    $('.credit span').html('<a/>').attr('href:\\www.google.com').text('This is my link to google!');
    $('.credit span ').attr('id', 'credit');

    $("[role='navigation']").flexNav();

 });

$(window).load(function() {
    if (!document.getElementById('credit') || document.getElementById('credit').href != "http://www.google.com/") {
        alert('Kreditnya jangan diilangin sob!');
    }
)}; 
```

并调用它：

```
<script type="text/javascript" src="myFile.js"></script> 
```

取消转义代码是一件好事，并正确缩进源代码：[http](http://en.wikipedia.org/wiki/Indent_style) ://en.wikipedia.org/wiki/Indent_style以提高可读性。

# grand-central-dispatch - 使用 iOS GCD 和 NotificationCenter 在异步数据加载完成时提醒用户（一次异步加载多个数据集）

> ID：14048335
> 
> 赞同：0
> 
> 时间：2012-12-27T01:27:03.917
> 
> 标签：grand-central-dispatch, viewcontroller, nsnotificationcenter, nsnotification

我正在编写一个 iPad 应用程序，在其中异步加载多层建筑的数据。一旦所有楼层的数据加载完成，我已经设置了 NSNotifications 来提醒用户。

当在 ChildViewController（弹出式 VC）中按下加载按钮时，每个楼层的数据加载将循环启动

ChildViewController 从 ParentViewController 启动。

我在 ChildViewController 中为名为“dataloaded”的通知添加了一个观察者，并设置了一个处理函数 childDataLoaded 来处理该通知。

由于 ChildViewController 可能在数据加载完成之前被解除，我还在 ParentViewController 中设置了一个观察者和处理程序（parentDataLoaded）来处理相同的“数据加载”通知。

我在 AppDelegate 中实现了数据加载函数 'parseAndSaveData'。单击 ChildViewController 按钮时调用 parseAndSaveData。它将楼层标识符（NSString）作为参数。它调用 Web 服务来获取该楼层的数据并将这些数据加载到数据库中。网络服务很快，但将数据添加到 sqllite 数据库需要更长的时间（我使用的是核心数据）。因此，我使用 dispatch_asynch 调用来调用这个数据加载部分（因为这是最耗时的部分）。

完成后的数据加载部分会发布“已加载数据”通知。

我希望此通知能够调用 ChildViewController 或 ParentViewController 中的处理程序（以在发布通知时处于活动状态）

我遇到的问题是通知是不可预测的，我看到只有一个处理程序（ChildViewController 中的那个）被调用，并且它只被调用到一个楼层，尽管所有楼层都成功加载。

任何有关上述设计和实施或替代方案的建议将不胜感激！

为@Samuel 的 dispatch_group 建议添加代码

```
Confirm action on my popup VC kicks off the following…
   creates a a GCD dispatch_group, floorDataGroup                    
   creates a GCD dispatch_queue, floorDataQueue, using dispatch_get_global_queue  
   with default priority

   loops over floors in building and for each floor  {
    dispatch_group_async(floorDataGroup, floorDataQueue, ^{  
              // start dispatch_group_async block
      //gets rooms details for the building and floor as follows:
      Calls webservice (using AFNetworking Library) to get room details, 
              which on success executes a block
        ( ^{
              Parses the XML, extracts room data 
                          Inserts room data into Core Data/sqllite table
           }); //end web service success block

    }); //end dispatch_group_async block
} //end loop over each floor

   dispatch_group_notify(floorDataGroup, floorDataQueue, ^{  
       //start dispatch_group_nbotify block
       create alert (UIAlert) with message “All floors loaded” 
       and an OK button to dismiss the alert
    [alert show]
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T16:51:43.413

我会考虑使用[Apple GCD Docs中的 NSOperationQueue...](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html#//apple_ref/c/func/dispatch_group_async)

> GCD 不限于系统级应用程序，但在将其用于更高级别的应用程序之前，您应该考虑 Cocoa 中提供的类似功能（通过 NSOperation 和块对象）是否更易于使用或更适合您的需求。有关详细信息，请参阅并发编程指南。

具体看看使用[NSBlockOperation](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSBlockOperation_class/Reference/Reference.html)。[您可以使用addExecutionBlock:](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSBlockOperation_class/Reference/Reference.html)将每个数据请求添加到单独的执行块中。[然后使用setCompletionBlock:](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSOperation_class/Reference/Reference.html#//apple_ref/occ/cl/NSOperation)设置完成块。确保在主线程上触发完成块。

如果您必须使用 GCD，那么我建议您查看[groups](https://developer.apple.com/library/mac/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW17)。

与stackoverflow相关的问题有很好的答案：

*   [使用 GCD 完成块](https://stackoverflow.com/questions/13788873/completion-block-using-gcd)
*   [我如何知道我在 GCD 中的所有任务都已完成？](https://stackoverflow.com/questions/9632235/how-do-i-know-all-my-tasks-in-grand-central-dispatch-finished)
*   [iOS - 如何在线程（使用 GCD）结束它的工作时收到通知](https://stackoverflow.com/questions/7077589/ios-how-to-be-notified-when-a-thread-using-gcd-ends-its-job)

# asp.net-mvc-4 - 创建过滤器以确保小写网址

> ID：14048338
> 
> 赞同：2
> 
> 时间：2012-12-27T01:27:53.503
> 
> 标签：asp.net-mvc-4, routing, seo, asp.net-mvc-routing

我的 mvc Web 应用程序的 global.asax 中有以下代码：

```
/// <summary>
    /// Handles the BeginRequest event of the Application control.
    /// </summary>
    /// <param name="sender">The source of the event.</param>
    /// <param name="e">The <see cref="EventArgs" /> instance containing the event data.</param>
    protected void Application_BeginRequest(object sender, EventArgs e)
    {
        // ensure that all url's are of the lowercase nature for seo
        string url = Request.Url.ToString();
        if (Request.HttpMethod == "GET" && Regex.Match(url, "[A-Z]").Success)
        {
            Response.RedirectPermanent(url.ToLower(CultureInfo.CurrentCulture), true);
        }
    } 
```

这样做的目的是确保所有访问站点的 url 都是小写的。我想遵循 MVC 模式并将其移至可以全局应用于所有过滤器的过滤器。

这是正确的方法吗？以及如何为上述代码创建过滤器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T05:07:48.190

我的意见 - 过滤器为时已晚，无法处理全局 url 重写。但是要回答您关于如何操作的问题，请创建一个操作过滤器：

```
public class LowerCaseFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        // ensure that all url's are of the lowercase nature for seo
        var request = filterContext.HttpContext.Request;
        var url = request.Url.ToString();
        if (request.HttpMethod == "GET" && Regex.Match(url, "[A-Z]").Success)
        {
            filterContext.Result = new RedirectResult(url.ToLower(CultureInfo.CurrentCulture), true);
        }
    }
} 
```

并在 FilterConfig.cs 中注册您的全局过滤器：

```
public class FilterConfig
{
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute()); 
        filters.Add(new LowerCaseFilterAttribute());
    }
} 
```

**但是**，我建议将此任务推送到 IIS 并使用重写规则。确保将[URL 重写模块](http://www.iis.net/download/urlrewrite)添加到 IIS，然后在 web.config 中添加以下重写规则：

```
<!-- http://ruslany.net/2009/04/10-url-rewriting-tips-and-tricks/ -->
<rule name="Convert to lower case" stopProcessing="true">
    <match url=".*[A-Z].*" ignoreCase="false" />
    <conditions>
        <add input="{REQUEST_METHOD}" matchType="Pattern" pattern="GET" ignoreCase="false" />
    </conditions>
    <action type="Redirect" url="{ToLower:{R:0}}" redirectType="Permanent" />
</rule> 
```

# ruby-on-rails - nil:NilClass 的未定义方法“*”

> ID：14048342
> 
> 赞同：0
> 
> 时间：2012-12-27T01:28:24.200
> 
> 标签：ruby-on-rails, ruby, acts-as-shopping-cart

[使用acts-as-shopping-cart gem](https://github.com/crowdint/acts_as_shopping_cart)时出现此错误：

> ```
> undefined method `*' for nil:NilClass  Extracted source (around line #5):
> 
> 2:
> 3: <%= render :partial => 'shopping_cart_item', :collection => @shopping_cart.shopping_cart_items %>
> 4:
> 5:  SubTotal:<%= number_to_currency @shopping_cart.subtotal %>
> 6:  Taxes:<%= number_to_currency @shopping_cart.taxes %>
> 7:  Total:<%= number_to_currency @shopping_cart.total %> 
> ```

这些字段似乎是在 gem 源中定义的。

### 显示.html.erb

```
<h1>Shopping Cart</h1>

<%= render :partial => 'shopping_cart_item', :collection => @shopping_cart.shopping_cart_items %>

<div><b>SubTotal:</b><%= number_to_currency @shopping_cart.subtotal %></div>
<div><b>Taxes:</b><%= number_to_currency @shopping_cart.taxes %></div>
<div><b>Total:</b><%= number_to_currency @shopping_cart.total %></div> 
```

### 购物车.rb

```
class ShoppingCart < ActiveRecord::Base
  acts_as_shopping_cart

  def tax_pct
    8.25
  end

  def taxes
    (subtotal - 10) * tax_pct
  end

end 
```

应用程序跟踪

> app/views/shopping_carts/show.html.erb:5:in `_app_views_shopping_carts_show_html_erb__2338506009803118188_70153042369260'

shopping_carts.controller

```
class ShoppingCartsController < ApplicationController
  before_filter :extract_shopping_cart

  def create
    @product = Product.find(params[:product_id])
    @shopping_cart.add(@product, @product.price)
    redirect_to shopping_cart_path
  end

  def show

  end

  private
  def extract_shopping_cart
    shopping_cart_id = session[:shopping_cart_id]
    @shopping_cart = session[:shopping_cart_id] ? ShoppingCart.find(shopping_cart_id) : ShoppingCart.create
    session[:shopping_cart_id] = @shopping_cart.id
  end
end 
```

我的回购

[https://github.com/atbyrd/Bootstrapped_Devise](https://github.com/atbyrd/Bootstrapped_Devise)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T05:03:05.050

仅当您将未**定价的商品**添加到购物车时才会出现此问题。

所以你需要确保所有产品都有价格，可能使用验证，可能使用 before_save 函数，但确保所有产品都有价格，这个问题就会消失。

**ps**在测试之前不要忘记从你的数据库中清除任何未定价的产品

# jquery - jQuery mouseup 功能仅在鼠标左键上？

> ID：14048344
> 
> 赞同：6
> 
> 时间：2012-12-27T01:28:38.177
> 
> 标签：jquery, html, css, animation, mouseup

我有这个元素在一个`mouseup`函数上动画，但现在，它适用于**左右**按钮。有没有办法只使用**左键**？

```
$(document).ready(function() {
    $("div").mouseup(function() {
        top: "-101%"
    });
}); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-27T01:37:05.220

您可以检查使用哪个鼠标按钮按下`e.which`（`1`主要，`2`中间和`3`次要）：

```
$(document).ready(function() {
    $("div").mouseup(function(e) {
        if (e.which != 1) return false;    // Stops all non-left-clicks

        ...
    });
}); 
```

# windows-phone-8 - 在 windows phone 8 中更改电池电量

> ID：14048345
> 
> 赞同：0
> 
> 时间：2012-12-27T01:28:51.517
> 
> 标签：windows-phone-8, windows-phone-8-emulator

我可以在模拟器中更改 windows phone 8 的电池电量吗？我想模拟资源密集型任务在 %90 下不起作用。我可以为 windows phone 模拟器设置电池电量吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:43:41.227

我认为不可能在 WP8 模拟器中有机地激活 ResourceIntensiveBackgroundTasks。如果您出于测试目的尝试激活它，我会改用[ScheduledActionService.LaunchForTest("myService")](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.scheduler.scheduledactionservice.launchfortest%28v=vs.105%29.aspx)方法。

正如您所提到的，ResourceIntensiveBackgroundAgents 不能在[MSDN](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202942%28v=vs.105%29.aspx#BKMK_ConstraintsforResourceintensiveAgents)上所述的电量低于 90% 的设备上运行。

> 除非设备的电池电量大于 90%，否则不会运行资源密集型代理。

无论出于何种原因，如果您想在现实世界中进行测试，最好在真实设备上进行。

# java - Java TCP 服务器在收到 16384 字节 MAC 操作系统后不接受客户端请求

> ID：14048346
> 
> 赞同：2
> 
> 时间：2012-12-27T01:29:07.953
> 
> 标签：java, sockets, tcp

我正在做一个实验，看看java中的TCP需要多长时间。首先我启动服务器。然后多次调用函数client_tcp，超过50000次。并测量连接、发送和接收 1 个字节所需的时间。当服务器收到超过 16384 个请求（有时会有所不同）时，客户端无法连接到服务器。

我不知道是不是因为服务器套接字中的接收缓冲区大小。就我而言，ss.getReceiveBufferSize() = 131072。

这是代码：

```
public synchronized void server_tcp(int port) {
    ServerSocket ss;
    Socket       so;
    InputStream  is;
    OutputStream os;

    try {           
        ss = new ServerSocket(port);
    } catch (Exception e) {
        System.out.println("Unable to connect to port " + port +
                " TCP socket.");
        return;
    }

    while (true) {
        try {
            so = ss.accept();
            is = so.getInputStream();
            os = so.getOutputStream();
            int ch = is.read();
            os.write(65);
            so.close();
        } catch (IOException e) {
            System.out.println("Something went wrong.");
        } catch (InterruptedException e) {
            System.out.println("Bye.");
        }
    }
}

public void client_tcp(String host, int port) {

    Socket       so = null;
    InputStream  is = null;
    OutputStream os = null;

    try {
        so = new Socket(host, port);
    } catch (UnknownHostException e) {
        System.err.println("Error Host not found.");
        return;
    } catch (IOException e) {
        Syste.err.println("Error Creating socket.");
        return;
    }

    try {
        os = so.getOutputStream();
        is = so.getInputStream();

        os.write(65);

        is.read();

        os.close();
        is.close();
        so.close();
    } catch (IOException e) {
        System.err.println("Error.");
        return;
    }
} 
```

怎么了？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:28:46.937

您几乎同时创建了大量的套接字，而操作系统没有足够的时间来释放它们。您可以在调用该`client_tcp()`方法的循环中添加一个微小的延迟（通过实验调整）。

```
for(int i=0; i<50000; i++) {
    new SocketReuse().client_tcp("127.0.0.1", 4444);
    Thread.sleep(2); // 2 milliseconds delay
} 
```

# php - SQL 语法错误 'LIMIT 0, 10'

> ID：14048351
> 
> 赞同：2
> 
> 时间：2012-12-27T01:30:07.940
> 
> 标签：php, sql, web

嘿，我在尝试访问我的网站时遇到此错误；“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'LIMIT 0, 10' 附近使用正确的语法”

对我来说第一行是`<?php require_once('Connections/blog.php'); ?>`

但似乎错误来自这里；

```
$maxRows_getDisplay = 10;
$pageNum_getDisplay = 0;
if (isset($_GET['pageNum_getDisplay'])) {
  $pageNum_getDisplay = $_GET['pageNum_getDisplay'];
}
$startRow_getDisplay = $pageNum_getDisplay * $maxRows_getDisplay;

mysql_select_db($database_blog, $blog);
$query_getDisplay = "SELECT news.title, news.pre,  
 DATE_FORMAT(news.updated, '%M %e, %Y') AS formatted 
 FROM news ORDER BY news.updated DESC LIMIT 2";
$query_limit_getDisplay = sprintf("%s LIMIT %d, %d", 
 $query_getDisplay, $startRow_getDisplay, $maxRows_getDisplay);
$getDisplay = mysql_query($query_limit_getDisplay, $blog) or die(mysql_error());
$row_getDisplay = mysql_fetch_assoc($getDisplay); 
```

如果您有任何想法，请因为我完全迷路了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T01:31:16.103

您创建了一个带有两个 LIMIT 子句的 SQL 语句，这是不允许的。

这个例子展示了通过盯着你用来构建 SQL 字符串的代码来调试 SQL 是多么困难。

如果可以输出*最终*的SQL 字符串来调试它会容易得多。

```
$query_getDisplay = "SELECT news.title, news.pre,  
 DATE_FORMAT(news.updated, '%M %e, %Y') AS formatted 
 FROM news ORDER BY news.updated DESC LIMIT 2";
$query_limit_getDisplay = sprintf("%s LIMIT %d, %d", 
 $query_getDisplay, $startRow_getDisplay, $maxRows_getDisplay);
error_log("What's wrong with this SQL?  " . $query_limit_getDisplay);
$getDisplay = mysql_query($query_limit_getDisplay, $blog) or die(mysql_error()); 
```

您将在错误日志中看到：

```
What's wrong with this SQL?  SELECT news.title, news.pre,  
DATE_FORMAT(news.updated, '%M %e, %Y') AS formatted 
FROM news ORDER BY news.updated DESC LIMIT 2 LIMIT %d, %d 
```

这使得发现无效的 SQL 语法变得更加容易（假设您可以识别有效和无效的 SQL 语法）。

# jsp - ORA-01861: 文字与 jsp 中的格式字符串不匹配

> ID：14048354
> 
> 赞同：1
> 
> 时间：2012-12-27T01:30:34.663
> 
> 标签：jsp

我正在尝试使用 JSP 将几个值插入到 oracle 表（oracle 10g）中。我一直遇到 ORA-01861 错误...有人可以帮帮我吗？

```
int eid = Integer.parseInt(request.getParameter("srno"));
String enm = "";
int exit_tp = Integer.parseInt(request.getParameter("applntype"));
int ecadre = 0;
String ecdr = "";
String epost = "";
String edob = "";
String eappt_da = "";
String ecadre_date = "";
String edor = "";
String esubmitted_by = "";
String esubmitted_ip = "";
String ezn = "";
String ezone = "";
String edivision = "";
String ebranch = "";

String tmp = "select ep.name,ep.cadre,cd.descpn,epv.post,ep.dob,ef.appt_da,ep.cadre_date,add_months(ep.dob-1,720),z.short,ep.zone,ep.division,ep.branch " +
        "from empfile ef,emp_prov ep,v$emp_prov epv,cadre cd,zone z " +
        "where ep.srno=epv.srno(+) " +
        "and ef.srno=ep.srno(+) " +
        "and ep.cadre=cd.code(+) " +
        "and ep.zone=z.zn(+) " +
        "and ep.srno=" + eid;

PreparedStatement stmt = conn.prepareStatement(tmp);

ResultSet rset = stmt.executeQuery();

if (rset.next()) {
    enm = rset.getString(1);
    ecadre = rset.getInt(2);
    ecdr = rset.getString(3);
    epost = rset.getString(4);
    edob = rset.getString(5);
    eappt_da = rset.getString(6);
    ecadre_date = rset.getString(7);
    edor = rset.getString(8);
    ezn = rset.getString(9);
    ezone = rset.getString(10);
    edivision = rset.getString(11);
    ebranch = rset.getString(12);
}
rset.close();
stmt.close();

String tmp1 = "insert into online_exit(srno,name,exitcode,cadre,post,dob,appt_da,cadre_date,dor,submit_date,submit_stt,zone,division,branch) " +
        "values (?,?,?,?,?,to_date(?,'DD/MM/YYYY'),to_date(?,'DD/MM/YYYY'),to_date(?,'DD/MM/YYYY'),to_date(?,'DD/MM/YYYY'),SYSDATE,2,?,?,?)";

PreparedStatement pstmt = conn.prepareStatement(tmp1);

pstmt.setInt(1, eid);
pstmt.setString(2, enm);
pstmt.setInt(3, exit_tp);
pstmt.setInt(4, ecadre);
pstmt.setString(5, epost);
pstmt.setString(6, edob);
pstmt.setString(7, eappt_da);
pstmt.setString(8, ecadre_date);
pstmt.setString(9, edor);
pstmt.setString(10, ezone);
pstmt.setString(11, edivision);
pstmt.setString(12, ebranch);

pstmt.executeUpdate();

pstmt.close();
conn.close(); 
```

表格说明如下

```
Name                                      Null?    Type
 ----------------------------------------- -------- ------------
 SRNO                                      NOT NULL NUMBER(6)
 NAME                                               VARCHAR2(50)
 EXITCODE                                           NUMBER(2)
 CADRE                                              NUMBER(2)
 POST                                               VARCHAR2(30)
 DOB                                                DATE
 APPT_DA                                         DATE
 CADRE_DATE                                         DATE
 CONF_STT                                           VARCHAR2(3)
 DOR                                                DATE
 VIG_DIS_STT                                        VARCHAR2(50)
 APPLN_DA                                           DATE
 APPLN_ACK_DA                                       DATE
 REC_CO_DA                                          DATE
 PREF_EXIT_DA                                       DATE
 NOTICE_PER_EXP_DA                                  DATE
 REASON                                             VARCHAR2(50)
 PENSION_OPT                                        VARCHAR2(2)
 REVERSN                                            VARCHAR2(2)
 COMP_AUTH                                          NUMBER
 EXIT_DATE                                          DATE
 SUBITTED_BY                                        NUMBER(6)
 SUBMIT_DATE                                        DATE
 SUBMITTED_IP                                       VARCHAR2(15)
 VALIDATED_BY                                       NUMBER(6)
 VALIDATED_ON                                       DATE
 VALIDATE_IP                                        VARCHAR2(15)
 SUBMIT_STT                                         NUMBER(2)
 ZONE                                               VARCHAR2(2)
 DIVISION                                           VARCHAR2(3)
 BRANCH                                             VARCHAR2(4) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:41:29.063

使用`ResultSet#getDate()`方法返回`java.sql.Date`并调用`PreparedStatement#setDate()`方法分配`java.sql.Date`给参数。

```
java.sql.Date edob;
...
if (rset.next()) {
  ..... 
  edob = rset.getDate(5);
  ....
}
....
String tmp1 = "insert into online_exit(srno,name,exitcode,cadre,post,dob,appt_da,cadre_date,dor,"
             +"submit_date,submit_stt,zone,division,branch) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

PreparedStatement pstmt = conn.prepareStatement(tmp1);

.....
pstmt.setDate(6, edob);
..... 
```

注意：如果您有字符串日期，则使用`SimpleDateFormat`方法来解析字符串日期。

编辑：

> 当我尝试初始化 java.sql.Date edob = new java.sql.Date() 时，我收到“构造函数 Date() 未定义”错误

您必须`java.sql.Date`通过将 millis 传递给它的构造函数来实例化：

```
java.sql.Date edob=new java.sql.Date(new java.util.Date().getTime());
//Or use java.sql.Date.valueOf() method
java.sql.Date date=java.sql.Date.valueOf("2012-12-31"); 
```

# php - PHP上传图片并获取url

> ID：14048358
> 
> 赞同：0
> 
> 时间：2012-12-27T01:30:59.563
> 
> 标签：php, html

我一直在研究一个预制的图像上传模板，因为我对 php 不太擅长，所以我似乎无法解决这个问题。

我需要能够提取到我的图像的直接链接（`$upload_dir`变量+文件扩展名），以便我可以在我的`index.php`页面中使用它。我试图将我的`post_file.php`文件包含在我的文件中，`index.php`但我收到了`Wrong HTTP-method`消息。

我的网站在`html5`其中，如果这与我的上传文件混淆，它正在使用拖放来启动上传。

**post_file.php**：

```
$demo_mode = false;
$upload_dir = 'uploads/'.date(d).rand(0000,9999);
$allowed_ext = array('jpg','jpeg','png','gif');

if (strtolower($_SERVER['REQUEST_METHOD']) != 'post') {
    exit_status('Error! Wrong HTTP method!');
}

if (array_key_exists('pic',$_FILES) && $_FILES['pic']['error'] == 0 ) {
    $pic = $_FILES['pic'];

    if (!in_array(get_extension($pic['name']),$allowed_ext)) {
        exit_status('Only '.implode(',',$allowed_ext).' files are allowed!');
    }    

    // Uploads are being ignored, but logged.
    if ($demo_mode) {
        $line = implode('        ', array( date('r'), $_SERVER['REMOTE_ADDR'], $pic['size'], $pic['name']));
        file_put_contents('log.txt', $line.PHP_EOL, FILE_APPEND);

        exit_status('Uploads are ignored in demo mode.');
    }

    // Move image,rename it and log it all
    if (move_uploaded_file($pic['tmp_name'], $upload_dir.'.'.get_extension($pic['name']))) {         
        $line = implode('        ', array( date(r),    'http://website.com/'.$upload_dir.'.'.get_extension($pic['name'])));
        file_put_contents('log.txt', $line.PHP_EOL, FILE_APPEND);

        exit_status('Upload was successful');
    }
}

exit_status('Something went wrong with your upload!'); 
```

**功能**

```
function exit_status($str) {
    echo json_encode(array('status'=>$str));
    exit;
}

function get_extension($file_name) {
    $ext = explode('.', $file_name);
    $ext = array_pop($ext);
    return strtolower($ext);
} 
```

当我收到错误消息时使用`include('post_file.php')`is 时，如何在不包含`post_file.php`在我的`index.php`文件中的情况下获取新的图像名称 + 路径和扩展名，然后在变量中回显它？

提前致谢！

# testing - JPA 测试 UniqueConstraint

> ID：14048360
> 
> 赞同：0
> 
> 时间：2012-12-27T01:31:15.873
> 
> 标签：testing, jpa, playframework, constraints

我想在 JPA/Playframework 中测试 UniqueConstraint：

```
 @Test
    public void saveWithTitleNotUnique() {  // not unique title

        Software software1 = builder.template1().withTitle("title1").create();
        Software software2 = builder.template1().withTitle("title1").create();

        software1.save();

        try {
            software2.save();
            fail("software.title is not unique");
        } catch (Exception ex) {}

    } 
```

...

```
@Entity
public class Software extends Model {

    @Column(unique = true)
    public String title; 
```

但是每次都测试失败，因为没有任何异常发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T09:47:31.380

您还没有将软件实例设为例外！你必须做一个：`Software software = new Software();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T21:59:20.690

我想通了：

我在构建软件实例时犯了一个错误。因此，它可以工作并引发异常。

```
@Test
public void saveWithTitleNotUnique() {  // not unique title

    SoftwareTemplateBuilder builder1 = new SoftwareTemplateBuilder();
    Software software1 = builder1.template1().withTitle("title1").create();

    SoftwareTemplateBuilder builder2 = new SoftwareTemplateBuilder();
    Software software2 = builder2.template1().withTitle("title1").create();

    software1.save();

    try {
        software2.save();
        fail("software.title is not unique");
    } catch (PersistenceException ex) {}
} 
```

# linq - 查找/计算列表中的冗余记录

> ID：14048364
> 
> 赞同：1
> 
> 时间：2012-12-27T01:31:34.403
> 
> 标签：linq, c#-4.0, data-structures

我正在寻找一种方法来识别重复记录……只是我想/期望看到它们。

因此，记录并没有完全复制，而是我目前不关心的唯一字段。我只是想看看他们是否通过完全相同的卡向完全相同的人支付了完全相同金额的 X# 付款。（假的例子只是为了说明）

该集合是一个 List<>，无论 X# 是 List<>.Count 是 X#。换句话说，列表中的所有记录都匹配（同样只是我关心的字段），否则我将拒绝它。

我能想到的最好的办法是获取第一条记录的值，比如 PayAmount 和 LINQ 其他两个，看看它们是否具有相同的 PayAmount 值。重复所有要匹配的字段。这似乎非常低效，但我不够聪明，无法想出更好的方法。

因此，任何想法，想法，指针将不胜感激。

JB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T01:36:39.137

像这样的事情应该这样做。

```
var duplicates = list.GroupBy(x => new { x.Amount, x.CardNumber, x.PersonName })
                     .Where(x => x.Count() > 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:52:59.420

工作示例：

```
class Program
{
    static void Main(string[] args)
    {
        List<Entry> table = new List<Entry>();

        var dup1 = new Entry
        {
            Name = "David",
            CardNumber = 123456789,
            PaymentAmount = 70.00M
        };

        var dup2 = new Entry
        {
            Name = "Daniel",
            CardNumber = 987654321,
            PaymentAmount = 45.00M
        };

        //3 duplicates
        table.Add(dup1);
        table.Add(dup1);
        table.Add(dup1);

        //2 duplicates
        table.Add(dup2);
        table.Add(dup2);

        //Find duplicates query
        var query = from p in table
                    group p by new { p.Name, p.CardNumber, p.PaymentAmount } into g
                    where g.Count() > 1
                    select new
                    {
                        name = g.Key.Name,
                        cardNumber = g.Key.CardNumber,
                        amount = g.Key.PaymentAmount,
                        count = g.Count()
                    };

        foreach (var item in query)
        {
            Console.WriteLine("{0}, {1}, {2}, {3}", item.name, item.cardNumber, item.amount, item.count);
        }

        Console.ReadKey();
    }
}

public class Entry
{
    public string Name { get; set; }
    public int CardNumber { get; set; }
    public decimal PaymentAmount { get; set; }
} 
```

其中的肉是这样的：

```
var query = from p in table
            group p by new { p.Name, p.CardNumber, p.PaymentAmount } into g
            where g.Count() > 1
            select new
            {
                name = g.Key.Name,
                cardNumber = g.Key.CardNumber,
                amount = g.Key.PaymentAmount,
                count = g.Count()
            }; 
```

您的唯一条目基于姓名、卡号和付款金额这 3 个标准，因此您可以按它们进行分组，然后`.Count()`用来计算这些唯一值中有多少存在。`where g.Count() > 1`仅将组过滤为重复项。

# node.js - 如何使用 now.js 遍历组

> ID：14048365
> 
> 赞同：0
> 
> 时间：2012-12-27T01:32:04.963
> 
> 标签：node.js, nowjs-sockets

有没有办法使用 now.js 遍历用户组？

当用户断开连接时，我想在他们所属的组上运行一些功能。

类似于此处的答案 1 ( [1](https://stackoverflow.com/questions/9947391/nowjs-group-leave-event-called-multiple-times) )，但由于某种原因，该代码不起作用。

**代码：**

```
nowjs.on('disconnect', function() { 
    var that = this;
    this.getGroups(function(groups){
         for (i=0;i<groups.length;i++){
             nowjs.getGroup(groups[i]).removeUser(that.user.clientId);
             console.log('user removed');
         }
    })
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T04:28:28.323

I forgot that I had already created an array called serverRoomsList. That held, oddly enough, a list of all the chat rooms I had already created. I just looped through that to get all of the group names.

However, I would still like to know if Now itself keeps track of groups in an array, or if I have to do it.

# php - 单击链接到sql进程后重定向用户？

> ID：14048367
> 
> 赞同：0
> 
> 时间：2012-12-27T01:32:06.057
> 
> 标签：php, redirect

我在一个名为收藏夹的用户个人资料上有一个链接。另一个用户可以单击此按钮，该用户将被添加到他们的收藏夹列表中。

链接收藏夹转到收藏夹.php，此代码在其中处理查询：

```
<?php

require_once('includes/session.php');
require_once('includes/functions.php');
require('includes/_config/connection.php');

session_start();

    confirm_logged_in();

    if (isset ($_GET['to'])) {
    $user_to_id = $_GET['to'];

}

if (!isset($_GET['to']))
    exit('No user specified.');

$user_id = $_GET['to'];

$result = mysql_query("INSERT INTO ptb_favorites (user_id, favorite_id) VALUES (".$_SESSION['user_id'].", ".$user_to_id.")") 
or die(mysql_error()); 

header("Location: profile.php" . $_SERVER['HTTP_REFERRER']);

?> 
```

因此，一旦此过程完成，我的目标是让标头将用户带回 profile.php（上一页），同时使用 $_SERVER['HTTP_REFERRER'] 调用用户 ID。

因此，如果用户 id 为 16，它会将他们重定向回 profile.php?id=16

相反，它只是重定向到 profile.php 并且不包括该配置文件的 id。

有人可以告诉我是否有办法做到这一点，如果我的方式完全正确，为什么它不起作用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:34:58.837

我想你正在寻找：

```
header("Location: profile.php?id=" . $_SESSION['user_id']); 
```

ps你的代码不安全。阅读有关 SQL 注入的信息。切换到 MySQLi 或 PDO

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:08:18.050

HTTP_REFERRER 不是这样写的，它是 HTTP_REFERER (1 R)。它包含用户来自的页面，因此 header("Location: profile.php" . $_SERVER['HTTP_REFERRER']) 不应该工作。你应该这样做：

```
header("Location:" . $_SERVER['HTTP_REFERRER']); 
```

但是 HTTP_REFERRER 不是很可靠，你应该使用：

```
header("Location: profile.php?id=" . $user_to_id); 
```

您应该将最后一个选项更改为您的网站如何构建链接，我们只是从您的示例中假设的。

此外，您正在设置变量 $user_id = $_GET['to'] 但您正在使用 $user_to_id 插入数据库。

另外你的代码很容易被破解，请不要这样使用，查看 PDO 或 Mysqli 函数。

# perl - 如何在 perl 中输入一定数量的字符后将字符串输入到文本文件中？

> ID：14048371
> 
> 赞同：2
> 
> 时间：2012-12-27T01:32:53.900
> 
> 标签：perl

我有一个很长的 sql 查询，我试图将它放入 VBA for Excel。VBA for Excel 对一行中的文本数量有限制，似乎约为 1000 个字符。我想要做的是将查询复制到文本文件并通过 perl 脚本运行它并输出到文本文件，并将其格式化为 VBA 所需的格式。

我需要 Perl 将字符计数到 1000，然后写入 (" & _) 然后换行符然后 (") 然后重复该过程直到文件末尾。空格或字符类型无关紧要。任何帮助是极大的赞赏。我会经常回来看看是否有人需要更多信息。谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T01:45:39.260

单线：

```
 perl -lape 's/(.{1000})(?=.)/$1" &_\n"/g;' < input > output 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:47:22.540

如果您的文本已经在字符串中，那么执行此操作的一种方法是：

```
$string =~ s/(.{1000})/$1" & _\n"/sg;
print '"', $string, '"'; 
```

或者，也许更好：

```
my @chunks = unpack '(A1000)*', $string;
s/\"/""/g, s/\n/" & vbCrLf & _\n"/g for @chunks;  # escape special characters
print '"', join(qq(" & _\n"), @chunks), '"'; 
```

如果您正在从文件中读取输入，也可以通过设置[输入记录分隔符](http://perldoc.perl.org/perlvar.html#%24%2f)在不将所有输入读入内存的情况下执行此操作：

```
{
    local $/ = \1000;  # read input in chunks of 1000 chars
    print '"';
    while ( <> ) {
        s/\"/""/g; s/\n/" & vbCrLf & _\n"/g;  # escape special characters
        print $_, qq(" & _\n");
    }
    print '"';
} 
```

（其中一些方法有时会`""`在最后一行留下毫无意义的信息——事实上，最后一种方法*总是*会这样做——但我认为这不应该是一个问题。）

最后，请注意，这些方法都不会对可能出现在输入中的任何特殊字符（如双引号）进行转义。如果您的输入可能包含此类字符，则需要单独处理它们。如果需要，我已经标记了可以插入代码的点。

**编辑：**我做了一些谷歌搜索，看起来需要在双引号 VBA 字符串中转义的主要字符是双引号（需要加倍）和换行符（没有简单的编码，需要用克鲁格喜欢`" & vbCrLf & "`）。我已经编辑了上面的代码来实现这种转义。我想，如果想更加确定，也可以使用以下内容转义*所有*不可打印和非 ASCII 字符：

```
s/([^\n -~])/sprintf '" & Chr(%d) & "', ord $1/eg 
```

（Ps. 中的反斜杠`s/\"/""/g`只是为了避免混淆 SO 的语法荧光笔。）

# ios - ios: UIButton 标题格式延迟

> ID：14048373
> 
> 赞同：0
> 
> 时间：2012-12-27T01:33:35.077
> 
> 标签：ios, text, formatting, uibutton, delay

我有一些按钮，我左对齐和换行标题文本。

当我运行该应用程序时，文本未格式化的位置存在延迟：

[预格式化文本 http://imageshack.us/a/img28/1958/preformat.jpg](http://imageshack.us/a/img28/1958/preformat.jpg)

到对齐和换行生效的时间：

[后格式文本 http://imageshack.us/a/img821/6118/postformat.jpg](http://imageshack.us/a/img821/6118/postformat.jpg)

在模拟器上，延迟非常明显（约 1 秒），在我朋友的 iPhone 5 上，延迟要小得多，但仍然很明显。

是什么导致了这种延迟？我可以解决这个延迟吗？

提前致谢！

* * *

**编辑**

在我的 viewDidLoad 方法中，我创建了 10 个按钮：

```
for (int i = 1; i <= STEP_NUMBER; ++i)
    [self createStepButtion:i isIphone:isIphone isRetina:isRetina]; 
```

在createStepButton中，相关代码如下：

```
UIButton * b = [UIButton buttonWithType:UIButtonTypeCustom];

// Listener
[b addTarget:self action:@selector(goToStep:) forControlEvents:UIControlEventTouchUpInside];

[self.scrollView addSubview:b];

// Set button size.
CGFloat width = self.scrollView.frame.size.width;
// CGRectMake(x, y, width, height)
int y = stepNum * margin + (stepNum - 1) * buttonHeight;
int buttonWidth = width - margin * 2;
b.frame = CGRectMake(margin, y, buttonWidth, buttonHeight);

b.layer.cornerRadius = cornerRadius;
b.clipsToBounds = YES;
b.showsTouchWhenHighlighted = YES;

// Image
[b setImage:img forState:UIControlStateNormal];
b.imageEdgeInsets = [self makeImageInsets:buttonWidth];

// Text
[b setTitleEdgeInsets:UIEdgeInsetsMake(0, titleLeftMargin, 0, titleRightMargin)];
b.contentHorizontalAlignment = UIControlContentHorizontalAlignmentLeft;
b.titleLabel.lineBreakMode = UILineBreakModeWordWrap;
[b setTitle:[NSString stringWithFormat:@"%i - %s", stepNum, STEP_NAMES[stepNum - 1]]forState:UIControlStateNormal];

[b setTitleColor:[UIColor blackColor] forState:UIControlStateNormal];
b.titleLabel.font = [UIFont systemFontOfSize:fontSize];

// Background
[b setBackgroundColor:[UIColor whiteColor]];

// The step number this button represents.
b.tag = stepNum; 
```

# linux - 如何从 tcl 文件中的单个变量执行多个命令

> ID：14048375
> 
> 赞同：1
> 
> 时间：2012-12-27T01:34:00.130
> 
> 标签：linux, command, format, tcl

我正在尝试使用 tcl 文件制作自定义 MOTD 标头。我已经成功地将命令添加到 /etc/profile 的最后一行

```
cowsay -f $(ls /usr/share/cowsay/cows/  | shuf -n1) $(whoami), $(fortune) 
```

我想将它添加到我现有的 MOTD 中，但我不知道在没有管道中断命令的情况下执行多个命令的正确语法。正如您在下面看到的，我已经尝试过：

```
#!/usr/bin/env tclsh

# * Variable
set cows [exec -- /usr/bin/whoami | /usr/games/fortune | cowsay]

# * Output

puts "$cows" 
```

它输出了 fortune 和 cowsay 很好但是，我似乎无法让 whoami 命令与其他命令一起执行。

```
\   ^__^
 \  (oo)\_______
    (__)\       )\/\
        ||----w |
        ||     || 
```

任何有关如何从 tcl 格式的语法中执行多个命令的帮助将不胜感激，谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T05:26:05.370

iagreen 的答案当然是正确的并且可能更易于维护，但是要回答您的子问题：如何翻译`$(some command)`成 tcl：

在 bash 中，`$(...)`语法通过在另一个 shell 中评估括号捕获的字符串来执行它——一个新的 bash 实例，通常称为子 shell。

在 tcl 中，该`exec`命令将其参数作为要在子 shell 中评估的单词列表来执行。

因此，将两个和两个放在一起`$(...)`是 is的正确翻译`[exec ...]`。

所以直接翻译这个：

```
cowsay -f $(ls /usr/share/cowsay/cows/  | shuf -n1) $(whoami), $(fortune) 
```

这是：

```
exec cowsay -f [exec ls /usr/share/cowsay/cows/ | shuf -n1] \
               [exec whoami], [exec fortune] 
```

这与iagreen给出的答案基本相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T02:44:54.987

您的方法的问题是财富忽略了标准输入。

看起来您正在构建一个要传递给 cowsay 的字符串。为什么不使用 Tcl 字符串分段构建字符串。例如，

```
#!/usr/bin/env tclsh

# * Variable
set cowsParam [exec /usr/bin/whoami]
append cowsParam ", " [exec /usr/games/fortune]
set cowImage [exec ls /usr/share/cowsay/cows/  | shuf -n1]
set cows [exec cowsay -f $cowImage $cowsParam]

# * Output

puts "$cows" 
```

# php - 为什么第二个查询不起作用？

> ID：14048376
> 
> 赞同：0
> 
> 时间：2012-12-27T01:34:01.083
> 
> 标签：php, sql, ajax

我使用 ajax 调用一个 php 文件来执行 sql 查询。当用户按下按钮时，php 文件会执行一些查询，包括一次选择和两次插入。当用户第一次按下按钮时它工作正常。在第二次中，只有选择查询和第一个插入查询有效，第二次插入查询不插入任何内容。我检查了查询，一切都很好。由于某种原因，似乎没有执行第二个插入查询。

```
$itemquery = "insert into `Items` values (...)";
if($affected_rows = $db->exec($itemquery) ){
    ...
    $pickupquery = "insert into `Pickup` values (...)";
    if ($affected_rows2 = $db->exec($pickupquery)) {
        echo "success";
    }
    else echo "No pickup is inserted";
} 
```

我第一次按下按钮，两个查询都可以正常工作（输出“成功”）。项目被插入到表中。但是我第二次按下它时，只有 $itemquery 起作用，$pickupquery 没有插入任何东西（输出“未插入拾取”）。$pickupquery 本身没有问题，但我不知道为什么它在第一次按下后就不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:42:31.557

您的 SQL 语法不正确。它应该是

```
INSERT INTO `Items` (COL_NAMES) VALUES (a, b,...) 
```

例如

```
INSERT INTO `Items` (`name`, `price`) VALUES ('Beans', 0.40); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:45:25.380

您也可以像这样插入 SQL（虽然我不确定这是好是坏，但它更容易）：

```
INSERT INTO `Items` SET name='Beans', price='0.40' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T02:02:47.807

我认为我们没有足够的信息来回答这个问题。这可能是一个javascript问题，它可能是数据库上的一个唯一索引，它阻止第二次插入或相同的值等。

要开始调试它，您应该使用 Firebug。使用 Firebug，您应该复制使用 Ajax 调用的链接并尝试直接从浏览器访问它。之后刷新页面以查看是否有任何错误，这应该模拟使用 Ajax 按下按钮 2 次。

使用 difebug 检查 ajax 调用是否调用了正确的页面，并且它调用了 2 次（每次按下按钮 1 次）。

然后检查为该主机定义的错误文件中是否有任何错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-22T00:31:00.413

我在数据库中将属性设置为唯一是一个愚蠢的错误，我试图插入一个重复的值，这导致了问题。代码没有任何问题。

# java - Google Maps API v2 显示空白地图

> ID：14048381
> 
> 赞同：3
> 
> 时间：2012-12-27T01:34:44.513
> 
> 标签：java, android, xml, google-maps, google-maps-api-2

我已经设置了一个 Android 应用程序，以便在谷歌地图上查看一些东西。我使用了 Google Maps API v2 并遵循了可以在[此处](https://developers.google.com/maps/documentation/android/start#the_google_maps_api_key)找到的所有设置。我什至使用我在 Google 网站上申请的密钥注册了该应用程序。
我已经能够让 Activity 运行，但每次打开它时都会看到一个空白屏幕。

![显示我的空白屏幕](../Images/4f5f69dc177fa7cdad4da3d38a47ad79.png)

**这是我的清单文件**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.stullich.tim.woistmeinphoto"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="18" />

<permission
    android:name="com.stullich.tim.woistmeinphoto.permission.MAPS_RECEIVE"
    android:protectionLevel="signature" />

<uses-permission android:name="com.stullich.tim.woistmeinphoto.MAPS_RECEIVE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />

<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <uses-library android:required="true" 
        android:name="android.test.runner"> 
    </uses-library> 
    <activity
        android:name="com.stullich.tim.woistmeinphoto.PhotoGalleryActivity"
        android:label="@string/app_name"
        android:screenOrientation="landscape" 
        >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity android:name=".FullImageViewActivity"
        android:screenOrientation="landscape" >
    </activity>

    <activity android:name=".MapViewActivity"
        android:screenOrientation="landscape" >
    </activity>

    <meta-data
        android:name="com.google.android.maps.v2.API_KEY"
        android:value="Excluded this for now" />       
</application> 
```

**这是我加载地图的活动**

```
package com.stullich.tim.woistmeinphoto;

import android.os.Bundle;
import android.support.v4.app.FragmentActivity;

import com.google.android.gms.maps.SupportMapFragment;

public class MapViewActivity extends FragmentActivity 
{
   @Override
   protected void onCreate(Bundle savedInstanceState)
{
   super.onCreate(savedInstanceState);
   setContentView(R.layout.map_view_activity);

  SupportMapFragment fragment = new SupportMapFragment();
  getSupportFragmentManager().beginTransaction()
          .add(android.R.id.content, fragment).commit();
}
} 
```

我听说没有使用正确的 API 密钥会导致这个问题，但我现在已经对密钥进行了三次检查，我认为这不是问题所在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-11T07:27:01.000

[Akhil](https://stackoverflow.com/users/1386918/akhil)也为我解决了这个问题。

我正在使用 OSX，并且 debug.keystore 位于`$HOME/.android/debugkeystore`. debug.keystore 的密码是“android”，如[Signing in Debug Mode](http://developer.android.com/tools/publishing/app-signing.html#debugmode)文档中所述。您需要执行 keytool 来获取 SHA1 字符串

```
$> keytool -list -v -keystore .android/debug.keystore 
Enter keystore password:  

Keystore type: JKS
Keystore provider: SUN

Your keystore contains 1 entry

Alias name: androiddebugkey
Creation date: Mar 7, 2013
Entry type: PrivateKeyEntry
Certificate chain length: 1
Certificate[1]:
Owner: CN=Android Debug, O=Android, C=US
Issuer: CN=Android Debug, O=Android, C=US
Serial number: 5138a42f
Valid from: Thu Mar 07 15:29:03 CET 2013 until: Sat Feb 28 15:29:03 CET 2043
Certificate fingerprints:
     MD5:  BA:3C:6D:7A:4C:4A:AD:3E:65:DB:53:D1:3A:23:A3:4D
     SHA1: A5:38:93:50:7C:EA:55:22:51:1E:BC:EE:AA:A5:6D:A8:6C:B7:16:35
     Signature algorithm name: SHA1withRSA
     Version: 3 
```

在[Google API 控制台](https://code.google.com/apis/console/)中，您需要 SHA1 字符串`A5:38:93:50:7C:EA:55:22:51:1E:BC:EE:AA:A5:6D:A8:6C:B7:16:35`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T09:00:29.187

我遇到了同样的问题，发现我的调试密钥是错误的。我改变了它，现在它正在工作。

# java - 调用 TreeSet 时出现 ClassCastException .contains(Long.valueOf(someLongValue))

> ID：14048382
> 
> 赞同：0
> 
> 时间：2012-12-27T01:34:50.490
> 
> 标签：java, generics, jsf-2, updatemodel

我难住了。我这样宣布我的集合：

```
 private Set<Long> applicationIds; 
```

然后我像这样填充它：

```
public void setApplicationIds( Set<Long> applicationIds ) {
    this.applicationIds = new TreeSet<Long>( applicationIds );
    this.applications = null;
} 
```

然后我尝试使用它：

```
public List<Application> getApplications() {
    if ( applications == null ) {
        applications = new ArrayList<Application>();
        if ( applicationIds != null ) {
            for ( Application application : availableApplications ) {
                if ( applicationIds.contains( Long.valueOf( application.getId() ) ) ) {
                    applications.add( application );
                }
            }
        }
    }
    return applications;
} 
```

我最终得到了这个：

```
java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Long
    at java.lang.Long.compareTo(Long.java:50)
    at java.util.TreeMap.getEntry(TreeMap.java:346)
    at java.util.TreeMap.containsKey(TreeMap.java:227)
    at java.util.TreeSet.contains(TreeSet.java:234)
    at org.mitre.asias.pf.pnp.viewmodel.Subscription.getApplications(Subscription.java:84) 
```

导致异常的行（堆栈跟踪中的第 84 行）是这一行：

```
 if ( applicationIds.contains( Long.valueOf( application.getId() ) ) ) { 
```

也许我遗漏了一些东西，但如果声明是`Set<Long>`并且我正在调用`contains`传递`Long.valueOf`值的方法，我怎么能得到这个异常？

这是 JSF 应用程序的模型 bean。我正在使用 Java 6、Tomcat 6.0.32、mojarra 2.1.14，但这些都不应该真正重要，因为泛型应该防止这种问题的编译时间......

**- - - - - - - 编辑 - - - - - - - - -**

它实际上是 JSF ......我用这个 setter 组合了一个超级简化的例子：

```
public void setSelectedValues(Set<Long> selectedValues) {
    this.selectedValues = selectedValues;
    if (logger.isTraceEnabled()) {
        StringBuilder message = new StringBuilder("Selected values:");
        for (Object value : selectedValues) {
            message.append("\n\t'").append(value.getClass().getName())
                    .append("': '").append(value.toString()).append("'");
        }
        logger.trace(message.toString());
    }
    this.selections = null;
} 
```

绑定到这个组件：

```
<p:selectManyCheckbox id="numbers"
   value="#{controller.selectedValues}" layout="pageDirection">
  <f:selectItems value="#{controller.availableValues}" />
</p:selectManyCheckbox> 
```

将其写入日志：

```
15:45:16.887 [http-bio-8080-exec-9] TRACE com.pastdev.learn.debug.Controller - Selected values:
    'java.lang.String': '1'
    'java.lang.String': '5' 
```

所以，简单的答案是正确的（感谢@PaulTomblin 强调这一点）。使用包含s 的*a*调用setter 。那么现在，转换的最佳过程是什么？我是否需要遍历将每个值转换为 Long 的列表？`Set``String`

附带说明一下，我使用 Java 7 在 Tomcat 7 上对此进行了测试，ClassCastException 消失了，但是，该`contains`方法总是`false`按预期返回。

**-------------- 编辑 2 -----------------**

[我在这里](https://stackoverflow.com/a/13866179/516433)找到了正确绑定我的组件的方法的答案。

**-------------- 编辑 3 -----------------**

这是对问题的更好解释[。](https://stackoverflow.com/a/3823776/516433)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T01:40:29.400

> 也许我遗漏了一些东西，但是如果声明是 Set 并且我正在调用包含 Long.valueOf 值的 contains 方法，我怎么能得到这个异常？

请注意，在 Java 中，泛型类型注解只是对编译器的提示，在运行时不起作用，因此在运行时可能会违反这些约束（但在某处会出现编译器警告）。

看起来您`Set<Long>`实际上至少包含一个字符串。那个 Set 是从哪里来的？

> 因为泛型应该防止这种问题的编译时间

是的，您的代码中应该有关于缺少泛型类型或未经检查的强制转换的警告。这只是一个警告，因为泛型是可选的。在您确实使用它们的地方，这将是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:09:31.367

好的@Lucas我刚刚尝试使用您在问题中发布的代码使用快速而肮脏的代码，它工作正常。可能你需要再次检查你的`Application`课程。

```
package javaapplication2;
import java.util.ArrayList;
import java.util.List;
import java.util.Set;
import java.util.TreeSet;

public class JavaApplication2 {

private static Set<Long> applicationIds;

private List<Application> applications;

private static final List<Application> availableApplications = new ArrayList<>();

public static void main(String[] args) {

    JavaApplication2 proj = new JavaApplication2();
    for (int i = 1; i <= 11; i++) {
        Application application = new Application();
        application.setId(i);
        availableApplications.add(application);
    }
    Set<Long> applicationIds1 = new TreeSet<>();
    applicationIds1.add(11L);
    applicationIds1.add(12L);
    applicationIds1.add(13L);

    proj.setApplicationIds(applicationIds1);
    for (Application appl : proj.getApplications()) {
        System.out.println(appl.getId());
    }
}

public void setApplicationIds(Set<Long> applicationIds) {
    this.applicationIds = new TreeSet<Long>(applicationIds);
    this.applications = null;
}

public List<Application> getApplications() {
    if (applications == null) {
        applications = new ArrayList<Application>();
        if (applicationIds != null) {

            for (Application application : availableApplications) {
                if (applicationIds.contains(Long.valueOf(application.getId()))) {
                    applications.add(application);
                }
            }
        }
    }
    return applications;
} 
```

}

和：

```
package javaapplication2;

class Application {
private int id;

public int getId() {
    return id;
}

public void setId(int id) {
    this.id = id;
}

} 
```

# php - 如何从mysql中的其他表中选择一个项目和项目数组？

> ID：14048392
> 
> 赞同：0
> 
> 时间：2012-12-27T01:36:08.937
> 
> 标签：php, mysql

假设我有两张桌子：

表1（带对象）：

```
| object_id                          | int(11)       | NO   | PRI | NULL         | 
| owner_of_object_id                 | int(11)       | NO   | PRI | NULL         | 
```

表2（附时间表）：

```
| object_id                          | int(11)       | NO   | PRI | NULL         | 
| reserved_from_date                 | date          | NO   | PRI | NULL         | 
| reserved_to_date                   | date          | NO   | PRI | NULL         | 
| reserved_to_id                     | int(11)       | NO   | PRI | NULL         | 
```

第一个表定义了我的对象，并且只有唯一的对象，第二个表定义了对象的时间表。对象可以安排在不同的日期，我的意思是可以有一个object_id的记录，但日期不同。

我想以这种方式从这些表中选择数据：

```
Array ( [0] => Array ( [object_id] = xxx, [reservations] = array( ALL RESERVATIONS ) ), [1] => next object) etc etc 
```

如何查询呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T01:55:07.817

您无法根据需要选择记录。SQL 返回一个 1 级数组，我认为你不能让它返回一个多级数组。您可以做的是获取记录并处理它们以获得您想要的。
您应该运行命令从第二个表中选择所有内容（无需连接），然后：

```
$current_id = 0; $counter = 0;
foreach($records as $record) {
    //if this is not the first run and the current id is different then the db id then you should add this to your results array
    if($record->object_id != $current_id && $counter) {
        $results[] = array('object_id' => $current_id, 'reservations' => $_tmp_array);
        $_tmp_array = array();
    }
    $_tmp_array[] = $record;
    $counter++;
}
//final add to the results array
$results[] = array('object_id' => $current_id, 'reservations' => $_tmp_array); 
```

# java - 使用 curl 发出 POST 时找不到 HTTP 404

> ID：14048394
> 
> 赞同：1
> 
> 时间：2012-12-27T01:36:24.880
> 
> 标签：java, json, curl, jersey, http-post

我正在尝试通过 curl 命令将 JSON 字符串传递给 POST 方法。但是，我收到 HTTP 1.1 404 Not Found 错误。我正在尝试创建一个简单的 Web 服务，它将 JSON 字符串传递给它以填充 mysql 数据库。

这是我的 DAO 类，用于执行GETS 和POSTS。

```
import java.sql.Connection;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class PersonDAO {

 public List<Person> findAll() {
        List<PErson> list = new ArrayList<Person>();
        Connection c = null;
        String sql = "SELECT * FROM person ORDER BY firstName";
        try {
            c = ConnectionHelper.getConnection();
            Statement s = c.createStatement();
            ResultSet rs = s.executeQuery(sql);
            while (rs.next()) {
                list.add(processRow(rs));
            }
        } catch (SQLException e) {
            e.printStackTrace();
            throw new RuntimeException(e);
        } finally {
            ConnectionHelper.close(c);
        }
        return list;

    public Person create(Person person) {
        Connection c = null;
        PreparedStatement ps = null;
        try {
            c = ConnectionHelper.getConnection();
            ps = c.prepareStatement("INSERT INTO Person (firstName,lastName) VALUES (?, ?)",
                new String[] { "ID" });
            ps.setString(1, person.getfirstName());
            ps.setString(2,person.getlastName());
            ps.executeUpdate();
            ResultSet rs = ps.getGeneratedKeys();
            rs.next();
            int id = rs.getInt(1);
            person.setId(id);
        } catch (Exception e) {
            e.printStackTrace();
            throw new RuntimeException(e);
        } finally {
            ConnectionHelper.close(c);
        }
        return person;
    }
 protected Person processRow(ResultSet rs) throws SQLException {
        Person person = new Person();
        person.setfirstName(rs.getString("firstname"));
        person.setlastName(rs.getString("lastname"));
        return person;
    } 
```

我的 POJO

```
@XmlRootElement
public class Person{
  private Integer id;
  private String firstName;
  private String lastName;

  //GETTERS AND SETTERS
} 
```

我的注释的我的人资源类：

```
@Path("/people")
public class PersonResource{
PersonDAO dao = new PersonDAO();

@GET
@Produces(MediaType.APPLICATION_JSON)
public List<Person> findAll(){
  System.out.println("findAll");
  return dao.findAll();
}

@POST
@Produces(MediaType.APPLICATION_JSON)
@Consumes(MediaType.APPLICATION_JSON)
public Person creare(Person person){
  System.out.println("creating person");
  return dao.create(person);
} 
```

当我发出 GET curl 命令时，它工作正常，它返回人员表中的所有值。但是，如果我发出 POST curl 命令，我会收到以下错误：

```
HTTP/1.1 404 Not Found
Server: Apache-Coyote/1.1
Content-Type: text/html;charset=utf-8
Content-Length: 1025
Date: Thu, 27 Dec 2012 01:33:41 GMT

<html><head><title>Apache Tomcat/7.0.32 - Error report</title><style> [...] 
```

请让我知道我哪里出错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T04:26:56.677

I assume you must be missing **-H 'Content-Type:application/json'** in the command you issue.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-15T09:02:17.147

I had exactly same problem and figured out it's related to Spring Security. Increase the logging level of spring security in your logging library with something similar to following:

```
logging.level.org.springframework.security.web: DEBUG 
```

After that, when you send your request you can see what is the last filter executed on the filter chain. In my case it was CsrfProtectionFilter. I disabled it and it worked.

If that doesn't help, also try enabling the tracing of your REST framework. That can also give you a clue. You can do it in jersey by following:

```
HashMap<String, Object> map = new HashMap<String, Object>();
map.put(ServerProperties.TRACING, "ALL");
this.addProperties(map); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T01:45:42.617

在 POST before 方法中，添加 PATH，尝试一下。

# c# - 当你从其他类中建立一个类时，它叫什么？

> ID：14048397
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:36:45.730
> 
> 标签：c#, class

我最近在学习 C# 并了解基础知识。我不是在下面写这段代码，而是试图理解它。line 类在声明 start 和 end 字段时使用 Point。这在 C# 中叫什么？

```
public class Point
{
    private float x;

    public float X
    {
        get { return x; }
        set { x = value; }
    }
    private float y;

    public float Y
    {
        get { return y; }
        set { y = value; }
    }

    public Point(float x, float y)
    {
        this.x = x;
        this.y = y;
    }

    public Point():this(0,0)
    {
    }

   }

}

class Line
{
    private Point start;

    public Point Start
    {
      get { return start; }
      set { start = value; }
    }

    private Point end;

    public Point End
    {
      get { return end; }
      set { end = value; }
    }

    public Line(Point start, Point end)
    {
        this.start = start;
        this.end = end;
    }

    public Line():this(new Point(), new Point())
    {
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:46:21.397

我不确定你在问什么，但我想你想知道正确的术语：

```
public class Point // a class (obviously)
{
    private float x; // private field; also the backing
                     // field for the property `X`

    public float X // a public property
    {
        get { return x; }  // (public) getter of the property
        set { x = value; } // (public) setter of the property
                           // both are using the backing field
    }

    public float Y // an auto-implemented property (this one will
    { get; set; }  // create the backing field, the getter and the
                   // automatically, but hide it from accessing it directly)

    public Point(float x, float y) // constructor
    {
        this.x = x;
        this.Y = y;
    }

    public Point()  // a default constructor that calls another by
        : this(0,0) // using an "instance constructor initializer"
    {}
} 
```

# c - 指向用于 ptr++ 算术的 char 数组 [10] 的指针

> ID：14048398
> 
> 赞同：0
> 
> 时间：2012-12-27T01:36:59.000
> 
> 标签：c

我的帖子试图用 1 块石头杀死 2 只鸟。提前为无知道歉。

我正在尝试创建一个字符串数组，我可以`index[0]`或使用它`ptr++`来推进数组。我不确定是否应该创建一个`char`指针数组或指向数组的指针`char`。变量将存储在结构中。原谅我的无知，我只是很难确定何时何地使用的优先顺序`()`。我了解一个基本结构，就是当我开始使用指向字符串的指针时，我开始松散语法结构。如果我能理解它的语法，我可以将它进一步应用于数组的维度结构。

假设我对变量的分配是正确的，我想我宁愿使用`ptr++`类似`printf("%s", ptr++)`. 如果我理解正确，`ptr++`会将指针移动到下一个字符串，或者一些 for of`ptr++`可以。这对吗？对于很多很多事情来说，这似乎会更快。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

struct Umbrella {
  char  *name[10]; 
} Umbrella;

int main ()
{
  struct Umbrella * ptr;

 // Not understanding this way... 
  ptr->name[0] = "Some name";

 // or this way. Well name++ as long as it wasn't the first string.
  ptr->name++ = "Some name";
  return 0;
} 
```

引导说明：我已阅读 Prata 的“C Primer Plus”。他在解释事物方面做得很好，只是当您开始按照自己的意愿弯曲事物时，您才开始无法应用语法。例如，它从未涵盖使用指向结构的指针来访问多维数组，并且它没有涵盖以您实际使用它的语法方式的指针运算。任何人都可以推荐另一本书，至少可以通过这种方法进行钎焊吗？

PS 这是我的第二篇文章，我忘了说我真的很喜欢这个网站的文本输入设计。不得不说:-)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:44:19.147

好吧，`char *name[10]`实际上就是这样：

```
char *name0;
char *name1;
char *name2;
// .. etc 
```

按 as 访问它`ptr->name[0]`只会选择`ptr->name0`as `char*`。

`ptr->name++ = "asdf";`这是一个非常糟糕的主意。它的基本作用是：

```
*(ptr->name) = "asdf";
ptr->name += 1; 
```

当然，你不能在这里将 name 加一（它是一个数组，而不是一个指针），所以编译器不会允许它。

* * *

该`++`运算符*在*迭代过去的对象时很有用。例子 ：

```
ptr->name[9] = nullptr; // Make sure the last element is a NULL pointer.

// Take the first element
char **it = ptr->name;

char *current;
// Loop until we reach the NULL
while ((current = *(it++)) != nullptr) {
    printf("%s\n", current);
} 
```

以上是遍历数组的一种（非常丑陋的）方式。

在预先分配的数组中插入东西：

```
char **it = ptr->name; // Start at the first element

*(it++) = "Hi!";
*(it++) = "This is the second message.";
*(it++) = "Hello world!";
*(it++) = nullptr; // End the array 
```

当然，所有这些迭代的东西都来自一个黑暗的过去：现在我们有 C++ 来为我们处理大部分这些事情，via`std::vector`等等。

# css - 优雅降级的正确方法？

> ID：14048400
> 
> 赞同：1
> 
> 时间：2012-12-27T01:37:21.697
> 
> 标签：css, html, graceful-degradation

我有一个在 IE 中不起作用的 HTML 5 拖放游戏，所以我想基本上只是以图像的形式显示答案。目前，我正在使用 CSS`div`在 IE 中隐藏游戏并`div`使用`display: block;`显示图像并`display: none`在 Chrome 等浏览器上使用隐藏它。

这是一种基于浏览器切换内容的好方法，还是我应该考虑另一种方法？这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:55:01.120

IE 中唯一可拖动的元素是`<a>`and`<img>`元素。

有些人只是用无处可去的标签包装他们的（文本）内容`<a>`，如 Remy Sharp 的演示所示：http: [//html5demos.com/drag](http://html5demos.com/drag)。这在 IE9 中工作得很好，而且可能是旧版本的 IE。

所以处理 IE 的“正确”方法是使用这些元素。

# r - 在 R 中模拟来自对数正态的数据

> ID：14048401
> 
> 赞同：0
> 
> 时间：2012-12-27T01:37:31.803
> 
> 标签：r, simulation

假设我想从对数正态分布中模拟 10 个观察值并重复 100 次。我写了一些 R 代码，但由于某种原因它不起作用。这是代码：

```
for(i in 1:100) 
 {

x = rlnorm(10, meanlog = 0, sdlog = 1)

 } 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T01:55:23.950

这可以工作：

```
lapply(1:100, function(i) rlnorm(10, meanlog = 0, sdlog = 1)) 
```

**编辑**
要计算平均值和标准差，请使用：

```
lapply(1:100, function(i) {
    x <- rlnorm(10, meanlog = 0, sdlog = 1)
    c(mean=mean(x), sd=sd(x))
}) 
```

或者以矩阵格式返回它（使用`do.call`）：

```
do.call(rbind, lapply(1:100, function(i) {
    x <- rlnorm(10, meanlog = 0, sdlog = 1)
    c(mean=mean(x), sd=sd(x))
})) 
```

并且还要使您的原始代码正常工作（请参阅 DWin 的注释），请使用：

```
x <- list()
for(i in 1:100) {
    x[[i]] <- rlnorm(10, meanlog = 0, sdlog = 1)
} 
```

# php - 如何通过移动网站的 Graph API“获取”Facebook 页面状态

> ID：14048410
> 
> 赞同：0
> 
> 时间：2012-12-27T01:39:16.423
> 
> 标签：php, facebook-graph-api, status, posts, mobile-website

我正在为我的教会设计一个移动网站，我想在网站上发布我教会的 Facebook 状态更新。我尝试了 Facebook like 框，但我发现它的功能有限，并且在移动网站上效果不佳。

然后我发现了 Facebook 的 Graph API。我在我的网站上找到了一个 PHP 脚本（http://stackoverflow.com/questions/9373645/can-you-get-a-public-facebook-pages-feed-using-graph-api-without-asking-a -user），然后我在 Facebook 上创建了一个应用程序。使用 Facebook 的 Graph API Express，我正在尝试自定义输出，因此我只获取页面的状态更新和时间戳。

例如，我尝试了 https://graph.facebook.com/[profile ID]/posts。但是，这包括我发布图片和创建活动的时间；我只想要状态更新。有什么方法可以通过将“类型”指定为“状态”来使用 Graph API 来限制帖子？我无法让它工作。

理想情况下，我希望代码能够获取我的教会 Facebook 页面的状态更新，尤其是“消息”和“创建时间”字段，并且我希望将结果限制为 10。

如果有更好的方法来做到这一点，请告诉我。我是这方面的新手，我基本上只是想找到实现这一点的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:42:12.313

> 有什么方法可以通过将“类型”指定为“状态”来使用 Graph API 来限制帖子？

Graph API 包含一个“状态”端点作为[用户对象](https://developers.facebook.com/docs/reference/api/user/)的一部分。它的访问方式与“posts”端点类似：

```
https://graph.facebook.com/[profile ID]/statuses 
```

要将结果限制为仅 10 个状态，您可以在 URL 中添加“限制”参数：

```
https://graph.facebook.com/[profile ID]/statuses?limit=10 
```

例如，`facebook.com/boo`使用应用程序访问令牌的 Boo 页面。

```
<?php
$access_token = '1111111111|2Cha_1-n5';
$graph_url = "https://graph.facebook.com/Boo/statuses?limit=10&access_token=" 
    . $access_token;
$page_posts = json_decode(file_get_contents($graph_url), true);

foreach($page_posts['data'] as $post){
    $message = $post['message'];
    $post_time = $post['created_time'];
}

echo $message .' '. $post_time;
?> 
```

有关过滤 API 输出的此方法和其他方法的更多信息，请参阅[Graph API 的分页文档](https://developers.facebook.com/docs/reference/api/pagination/)。

# azure - Azure 表设计器

> ID：14048413
> 
> 赞同：4
> 
> 时间：2012-12-27T01:39:56.087
> 
> 标签：azure

我有一个 Azure 测试站点，我正在尝试将它连接到 Azure SQL 数据库。我使用 Azure 门户创建了一个新数据库。由于数据库创建成功，然后我打开 SSMS 2012 并连接到服务器和数据库。我希望能够使用标准的创建表 GUI（允许您以网格格式输入列名、身份、数据类型等的那个）通过 SSMS 创建新表等，但 SSMS 2012 似乎没有有一个表格设计窗口。我错过了什么吗？是否有针对此的 OOB 版本？我正在运行 VS 2012 Ultimate、SSMS 2012 并且我已经拥有 VS2012 Azure SDK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:21:20.307

我认为你应该看看应该包含在 SQL Server 2012 中的 SQL Server Data Tool (SSDT)。不确定它是否包含在 Express 中，但是一旦你安装了 SQL 2012，你会在 Visual Studio 2012 中找到一个新窗口，你可以在 GUI 中设计您的 Azure SQL 数据库。

我有一个关于此功能的博客，但我认为它的安装和使用变得更加简单。 [http://blogs.shaunxu.me/archive/2012/04/28/ssdt-ndash-makes-sql-azure-development-easy.aspx](http://blogs.shaunxu.me/archive/2012/04/28/ssdt-ndash-makes-sql-azure-development-easy.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T16:49:09.690

为什么不使用在线门户？您用于创建数据库的同一门户允许您使用您所描述的网格格式构建表格。只需单击左下角的设计按钮，然后单击底部的新表即可。您还可以创建索引、外键等。

# visual-studio - 使用 opencv 库在 Qt 中进行图像处理的 GUI

> ID：14048415
> 
> 赞同：0
> 
> 时间：2012-12-27T01:40:24.703
> 
> 标签：visual-studio, qt, opencv

我已经编写了用于打开 RGB 图像的图像处理代码，将其转换为灰度图像，将阈值转换为二进制图像，侵蚀二进制图像，扩大被侵蚀的图像，找到连接的组件并在 Visual Studio 2010 中使用 opencv 库对其进行标记，但现在我必须为上述步骤创建一个 GUI，就像我必须创建六个按钮一样，如果我按下第一个按钮，它应该打开一个图像，如果我按下第二个按钮，它应该将其转换为二进制阈值图像等。

谁能帮我这个？我已经实现了打开图像的按钮，但之后我不知道如何继续。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T05:15:18.143

尝试获取**OpenCV 2 Computer vision application programming cookbook**这本书...第一章涉及 Qt GUI 和 OpenCV ..here is the pdf [link](http://www.google.co.in/url?sa=t&rct=j&q=opencv%20cookbook%20pdf&source=web&cd=1&cad=rja&ved=0CDEQFjAA&url=http://zenithlib.googlecode.com/svn/trunk/books/OpenCV_2_Computer_Vision_Application_Programming_Cookbook.pdf&ei=vtjbUIL0K478rAfeyoGAAw&usg=AFQjCNGE_l6oDgAErQEsHH6QLTvBfW1ORw&bvm=bv.1355534169,d.bmk)

# jquery - 如何在悬停时显示“兄弟姐妹”的 CSS，但不在悬停的项目上显示 CSS？

> ID：14048420
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:41:00.727
> 
> 标签：jquery, css

我有 5 位文本，我希望当您将鼠标悬停在其中一个文本上时，CSS 波纹管将应用于除您悬停的文本之外的所有文本位。

您可以使用 jquery 和 .siblings() 属性来执行此操作吗？

html:

```
<table width="1138" height="38" border="0" class="Home111">
<tr>
<th width="146"   scope="col"> <div class="top" id="one"><a href="T-Shirts.html"class="blur out">T-SHIRTS</a></div>
</th>
<th width="146"  scope="col"> <div class="top" id="two"><a href="Bits &amp; Bobs.html"class="blur out">BLOG</a></div>
</th>
<th width="146"  scope="col"> <div class="top" id="three"><a href="Music.html"class="blur out">MUSIC</a></div>
</th>
<th width="146"  scope="col"> <div class="top" id="four"><a href="Contact.html"class="blur out">CONTACT</a></div>
</th>
<th width="146" height="38"  scope="col"> <div class="top" id="five"><a href="About.html"class="blur out"> ABOUT</a></div>
</th> 
```

CSS：

```
a.blur
{
text-decoration: none;
color: #339;
}

a.blur:hover, a.blur:focus
{
text-decoration: underline;
color: #933;
}

.textshadow a.blur, .textshadow a.blur:hover, .textshadow a.blur:focus
{
text-decoration: none;
color: rgba(0,0,0,0);
outline: 0 none;
-webkit-transition: 400ms ease 100ms;
-moz-transition: 400ms ease 100ms;
transition: 400ms ease 100ms;
}

.textshadow a.blur,
.textshadow a.blur.out:hover, .textshadow a.blur.out:focus
{
text-shadow: 0 0 4px #339;
}

.textshadow a.blur.out,
.textshadow a.blur:hover, .textshadow a.blur:focus
{
text-shadow: 0 0 0 #339;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T01:55:51.873

要做到这一点，你不能简单地使用`.siblings()`，因为它们不是严格的兄弟姐妹，更像是非常远的表亲:)所以为了加快速度，你应该将所有项目的列表保留在一个变量中，然后用于`.not(this)`排除当前项目`hover()`回调。

```
var items = $('.Home111 a'); // all anchors inside table with class Home111

items.hover(function() {
    var others = items.not(this);
    // others = the siblings of current item
}, function() {
    var others = items.not(this);
    // others = the siblings of current item
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T01:44:58.090

没有 HTML 就无法具体，也不知道应该将哪些规则应用于兄弟姐妹

```
$('a.blur').hover(function(){
    $(this).siblings().addClass('someclass');
}, function(){
    $(this).siblings().removeClass('someclass');
}); 
```

# python - 优化类模拟代码？

> ID：14048421
> 
> 赞同：1
> 
> 时间：2012-12-27T01:41:02.227
> 
> 标签：python, class, random, simulation

我创建了一个类，可以有效地从 52 张牌组中随机发一张扑克牌。然后我写了几行代码来模拟 52 次绘制的 100K 模拟，因为我想知道分布是否正确实现。当我这样做时，我意识到运行 sim 需要 87 秒。这对我来说似乎很长一段时间。任何人都可以指出#2 中的一些可能使它变得如此缓慢的事情吗？

```
import time
import random as rand
import numpy as np
class PlayingCard:
    ranks = ['2','3','4','5','6','7','8','9','10','J','Q','K','A']
    suits = ['Spades', 'Hearts', 'Clubs', 'Diamonds']
    def __init__(self, rank = None, suit = None):
        if rank is None: self.rank = PlayingCard.ranks[rand.randint(0,12)]
        elif rank in PlayingCard.ranks: self.rank = rank
        else: raise NameError('Invalid rank')

        if suit is None: self.suit = PlayingCard.suits[rand.randint(0,3)]
        elif suit in PlayingCard.suits: self.suit = suit
        else: raise NameError('Invalid suit')

    def identity(self):
        return (self.rank,self.suit)
#2
start = time.clock()

deck = zip(PlayingCard.ranks*4,PlayingCard.suits*13)
mat = [[PlayingCard().identity() for x in range(52)] for y in range(100000)]
res = [[(y.count(x)/52.0) for x in deck] for y in mat]
mean = [np.mean([res[y][x] for y in range(len(res))]) for x in range(52)]

end = time.clock() - start
print end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T01:52:17.427

为什么不只计算抽奖次数？它更快：

```
import pprint
import random

from collections import defaultdict

ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A']
suits = ['Spades', 'Hearts', 'Clubs', 'Diamonds']

deck = zip(ranks * 4, suits * 13)

def test(trials=100000):
    draws = defaultdict(int)

    for i in range(trials):
        draws[random.choice(deck)] += 1

    return {card: float(value) / trials for card, value in draws.iteritems()}

pprint.pprint(test(100000)) 
```

这对我来说大约需要`0.6`几秒钟：

```
{('10', 'Clubs'): 0.01961,
 ('10', 'Diamonds'): 0.01897,
 ('10', 'Hearts'): 0.0196,
 ('10', 'Spades'): 0.01902,
 ('2', 'Clubs'): 0.01953,
 ('2', 'Diamonds'): 0.0201,
 ('2', 'Hearts'): 0.01889,
 ('2', 'Spades'): 0.01891,
 ('3', 'Clubs'): 0.01943,
 ('3', 'Diamonds'): 0.0198,
 ('3', 'Hearts'): 0.01893,
 ('3', 'Spades'): 0.01953,
 ('4', 'Clubs'): 0.01973,
 ('4', 'Diamonds'): 0.01946,
 ('4', 'Hearts'): 0.01822,
 ('4', 'Spades'): 0.01931,
 ('5', 'Clubs'): 0.01845,
 ('5', 'Diamonds'): 0.01956,
 ('5', 'Hearts'): 0.01978,
 ('5', 'Spades'): 0.01943,
 ('6', 'Clubs'): 0.01852,
 ('6', 'Diamonds'): 0.01903,
 ('6', 'Hearts'): 0.01928,
 ('6', 'Spades'): 0.01848,
 ('7', 'Clubs'): 0.0195,
 ('7', 'Diamonds'): 0.01881,
 ('7', 'Hearts'): 0.0194,
 ('7', 'Spades'): 0.01926,
 ('8', 'Clubs'): 0.01946,
 ('8', 'Diamonds'): 0.0188,
 ('8', 'Hearts'): 0.01985,
 ('8', 'Spades'): 0.01875,
 ('9', 'Clubs'): 0.01914,
 ('9', 'Diamonds'): 0.01908,
 ('9', 'Hearts'): 0.01937,
 ('9', 'Spades'): 0.01838,
 ('A', 'Clubs'): 0.01935,
 ('A', 'Diamonds'): 0.01843,
 ('A', 'Hearts'): 0.01957,
 ('A', 'Spades'): 0.01852,
 ('J', 'Clubs'): 0.01992,
 ('J', 'Diamonds'): 0.01933,
 ('J', 'Hearts'): 0.01881,
 ('J', 'Spades'): 0.01946,
 ('K', 'Clubs'): 0.01932,
 ('K', 'Diamonds'): 0.01845,
 ('K', 'Hearts'): 0.01935,
 ('K', 'Spades'): 0.02015,
 ('Q', 'Clubs'): 0.0189,
 ('Q', 'Diamonds'): 0.01942,
 ('Q', 'Hearts'): 0.01977,
 ('Q', 'Spades'): 0.01988} 
```

# java - Checkstyle：ParenPad Check 的使用

> ID：14048428
> 
> 赞同：0
> 
> 时间：2012-12-27T01:42:30.397
> 
> 标签：java, checkstyle

我是 Checkstyle 的新手，虽然我主要通过 Maven Checkstyle 插件使用它。

我有一种情况，我认为 Checkstyle 缺乏灵活性。可能是我，不熟悉 Checkstyle 及其配置选项。

我遇到的问题是使用 METHOD_CALL 令牌类型的 ParenPad 检查；我相信。

在大多数情况下，我不允许方法调用中括号前后的任何空格。

```
e.g. object.method(arg1);                          Case 1 
```

但是，当我使用 StringBuffer 或 StringBuilder 构建 SQL 语句、电子邮件文本或其他一些长字符串时；我喜欢为用于构建长字符串的语句提供 LTR 感觉，以便更容易阅读。

```
e.g. buffer.append("String 1 ");                   Case 2
     buffer.append(          variable);
     buffer.append(                 " String 2"); 
```

我试图获得的风格是在方法调用的左括号之后不允许有一个或多个空格，但在方法调用的右括号之前不允许有空格。

似乎我无法将 Checkstyle 配置为允许这样做。我可以让它接受案例 1 并拒绝案例 2 或反之亦然，但要让它接受两者，我需要一起禁用 ParenPad 测试，我觉得这太激烈了。我希望使用 checkstyle 规则来接受和执行**这两种情况。**

请告知我如何使用 Checkstyle 完成此操作。我需要什么配置？使用 Checkstyle 来实现这一点是否有“技巧”？是否有 Checkstyle 扩展来满足我的需求？还是我需要写一个自定义检查？

寻求任何帮助或建议。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T06:21:23.273

我找到了一个我现在正在使用的解决方法，但希望情况得到改善。我已将 ParenPad 的 Checkstyle 规则修改为如下：

```
 <module name="ParenPad">
      <property name="option" value="nospace"/>
      <property name="tokens" value="CTOR_CALL,LPAREN,RPAREN,SUPER_CTOR_CALL"/>
    </module> 
```

基本上，它不会对 ParenPad 进行方法调用的规则检查。虽然对于所有其他出现的括号不强制使用空格，但对于用于方法调用的括号来说，它是一个免费的。

我需要的是在方法调用的右括号之前强制没有空格，但在方法调用的左括号之后不允许有一个或多个空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T22:07:09.403

您可以使用该`tokens`属性来达到预期的效果。只需省略`LPAREN`令牌即可解除左括号的限制：

```
<module name="ParenPad">
  <property name="tokens" value="CTOR_CALL,METHOD_CALL,RPAREN,SUPER_CTOR_CALL"/>
</module> 
```

在 Eclipse 中，这看起来像这样：

![Eclipse Checkstyle Paren Pad 配置](../Images/e756d2f9d685416a398afc277bacf96f.png)

# forms - Django Crispy Forms：用图像替换标签和单选按钮

> ID：14048430
> 
> 赞同：3
> 
> 时间：2012-12-27T01:42:33.363
> 
> 标签：forms, django-forms, radio-button, django-crispy-forms

我有一个表单，其中某个字段是具有 3 个选项的单选选择器。假设这代表“好”、“多或少”和“坏”。

我设法将它们与 InlineRadio 放在同一行，如下所示：

```
self.helper.layout = Layout(InlineRadio(field_name)) 
```

现在，我需要做两件事：

1) 替换每个选项，即呈现为单选按钮及其标签的预定义图像。

2) 添加 2 张图像，一张在单选按钮的左侧，一张在右侧。所以，最后，我将连续有 5 张图像。从左到右：`Image of Smile (just the image)`- `Image of selector (Good)`- `Image of selector (More-or-Less)`- `Image of selector (Bad)`- `Image of Sad face (just the image`)

是否可以使用 django-crispy 来实现它们？如果没有，我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T16:55:25.987

我是脆皮形状的主要开发者。您可以使用`Field`布局对象和自定义模板来做到这一点。

```
Field('field_name', template="custom_inline_radio.html") 
```

您拥有的其他选择是创建自己的布局对象子类化`InlineRadio`。这样你只需要这样做：

```
CustomInlineRadio('field_name') 
```

实际上，您尝试做的基本上是覆盖 Django 中默认小部件的输出，如果您在 Django 表单中使用自定义小部件，这可能更有意义，crispy-forms 会很好地配合它。我写了一篇您可能感兴趣的关于[小部件和 Django 表单的文章。](http://tothinkornottothink.com/post/10815277049/django-forms-i-custom-fields-and-widgets-in-detail)

# javascript - 从 DOM 创建可重用的文档片段

> ID：14048432
> 
> 赞同：4
> 
> 时间：2012-12-27T01:42:37.780
> 
> 标签：javascript, html, dom, fragment

我想在架子上有一个文档片段/元素，我已经连接了一堆其他元素。然后，每当我想将这些元素系统之一添加到 DOM 时，我都会复制片段，添加唯一的 DOM ID 并附加它。

因此，例如：

```
var doc = document,
    prototype = doc.createElement(),  // or fragment
    ra = doc.createElement("div"),
    rp = doc.createElement("div"),
    rp1 = doc.createElement("a"), 
    rp2 = doc.createElement("a"),
    rp3 = doc.createElement("a");

ra.appendChild(rp);
rp.appendChild(rp1);
rp.appendChild(rp2);
rp.appendChild(rp3);
rp1.className = "rp1";
rp2.className = "rp2";
rp3.className = "rp3";

prototype.appendChild(ra); 
```

这将创建原型。然后我希望能够复制原型，添加 id 并附加。像这样：

```
var fr = doc.createDocumentFragment(),
    to_use = prototype; // This step is illegal, but what I want!
                        // I want prototype to remain to be copied again.

to_use.id = "unique_id75";
fr.appendChild(to_use);
doc.getElementById("container").appendChild(fr); 
```

我知道这不合法。我做过小提琴和研究等等，但它不起作用。一篇 SO 帖子建议`el = doc.appendChild(el);`返回`el`，但这并没有让我走得太远。

那么……这可能吗？你能创建一个可以重复使用的现成元素吗？还是每次都必须从头开始构建想要添加的 DOM 结构？

本质上，我正在寻找性能提升，因为我正在创造数千个这样的傻瓜:)

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-27T04:15:13.160

使用[`Node.cloneNode`](https://developer.mozilla.org/en-US/docs/DOM/Node.cloneNode)：

```
var container = document.getElementById('container');

var prototype = document.createElement('div');
prototype.innerHTML = "<p>Adding some <strong>arbitrary</strong> HTML in"
 +" here just to illustrate.</p> <p>Some <span>nesting</span> too.</p>"
 +"<p>CloneNode doesn't care how the initial nodes are created.</p>";

var prototype_copy = prototype.cloneNode(true);

prototype_copy.id = 'whatever'; //note--must be an Element!

container.appendChild(prototype_copy); 
```

## 速度提示

您要最小化三个操作：

### 字符串解析

当您使用`innerHTML`. `innerHTML`单独使用时速度很快。由于所有这些 DOM 方法调用的开销，它通常比等效的手动 DOM 构造更快。但是，您不想使用`innerHTML`内部循环，并且不想将其用于追加。 随着元素的内容变得越来越大`element.innerHTML += 'more html'`，特别是具有*灾难性的运行时行为。*它还会破坏任何事件或数据绑定，因为所有这些节点都被破坏并重新创建。

因此`innerHTML`，为方便起见，请使用创建“原型”节点，但对于内部循环，请使用 DOM 操作。要克隆您的原型，请使用`prototype.cloneNode(true)`which 不会调用解析器。（请注意克隆原型中的 id 属性——当您将它们附加到文档时，您需要确保它们是唯一的！）

### 文档树修改（重复`appendChild`调用）

每次修改文档树时，您可能会触发文档窗口的重绘并更新文档 DOM 节点关系，这可能会很慢。相反，将您的追加分批成 a`DocumentFragment`并仅将其追加到文档 DOM 一次。

### 节点查找

如果您已经有一个内存中的原型对象并想要修改它的片段，那么无论您使用 DOM 遍历、`getElement*`. 还是`querySelector*`.

通过在创建原型时保留对要修改的节点的引用，将这些搜索排除在您的内部循环之外。然后，每当您想要克隆原型的几乎相同副本时，修改您已经引用的节点，然后克隆*修改后*的原型。

## 示例模板对象

最重要的是，这是一个基本的（可能是快速的）模板对象，说明了使用`cloneNode`和缓存节点引用（减少了字符串解析和节点查找的使用）。

为它提供一个带有类名和`data-attr="slotname attributename"`属性的“原型”节点（或字符串）。类名成为文本内容替换的“槽”；元素`data-attr`成为属性名称设置/替换的插槽。然后，您可以为该`render()`方法提供一个对象，其中包含您定义的槽的新值，并且您将获得完成替换的节点的克隆。

示例用法在底部。

```
function Template(proto) {
    if (typeof proto === 'string') {
        this.proto = this.fromString(proto);
    } else {
        this.proto = proto.cloneNode(true);
    }
    this.slots = this.findSlots(this.proto);
}
Template.prototype.fromString = function(str) {
    var d = document.createDocumentFragment();
    var temp = document.createElement('div');
    temp.innerHTML = str;
    while (temp.firstChild) {
        d.appendChild(temp.firstChild);
    }
    return d;
};
Template.prototype.findSlots = function(proto) {
    // textContent slots
    var slots = {};
    var tokens = /^\s*(\w+)\s+(\w+)\s*$/;
    var classes = proto.querySelectorAll('[class]');
    Array.prototype.forEach.call(classes, function(e) {
        var command = ['setText', e];
        Array.prototype.forEach.call(e.classList, function(c) {
            slots[c] = command;
        });
    });
    var attributes = proto.querySelectorAll('[data-attr]');
    Array.prototype.forEach.call(attributes, function(e) {
        var matches = e.getAttribute('data-attr').match(tokens);
        if (matches) {
            slots[matches[1]] = ['setAttr', e, matches[2]];
        }
        e.removeAttribute('data-attr');
    });
    return slots;
};
Template.prototype.render = function(data) {
    Object.getOwnPropertyNames(data).forEach(function(name) {
        var cmd = this.slots[name];
        if (cmd) {
            this[cmd[0]].apply(this, cmd.slice(1).concat(data[name]));
        }
    }, this);
    return this.proto.cloneNode(true);
};
Template.prototype.setText = (function() {
    var d = document.createElement('div');
    var txtprop = (d.textContent === '') ? 'textContent' : 'innerText';
    d = null;
    return function(elem, val) {
        elem[txtprop] = val;
    };
}());
Template.prototype.setAttr = function(elem, attrname, val) {
    elem.setAttribute(attrname, val);
};

var tpl = new Template('<p data-attr="cloneid id">This is clone number <span class="clonenumber">one</span>!</p>');

var tpl_data = {
    cloneid: 0,
    clonenumber: 0
};
var df = document.createDocumentFragment();
for (var i = 0; i < 100; i++) {
    tpl_data.cloneid = 'id' + i;
    tpl_data.clonenumber = i;
    df.appendChild(tpl.render(tpl_data));
}
document.body.appendChild(df); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T01:58:41.153

如果 innerHTML 没有更快，我会感到震惊。预编译的模板，例如 lo-dash 或 dot 提供的模板，似乎是个不错的选择！

看看这个简单的例子：http: [//jsperf.com/lodash-template](http://jsperf.com/lodash-template)

它表明，对于一个相当复杂的模板，使用 lo-dash 的预编译模板进行循环，您可以获得 300,000 次操作/秒。对我来说似乎相当快，而且 JS 更干净。

显然，这只是问题的一部分。这会生成 HTML，实际上插入 HTML 是另一个问题，但再一次，innerHTML 似乎胜过了 cloneNode 和其他基于 DOM 的方法，而且通常代码更干净。 [http://jsperf.com/clonenode-vs-innerhtml-redo/2](http://jsperf.com/clonenode-vs-innerhtml-redo/2)

显然，您可以将这些基准值作为一粒盐。真正重要的是您的实际应用程序。但我建议在下定决心之前尝试多种方法并自己对它们进行基准测试。

注意：很多关于 JSPerf 模板的基准测试都做错了。他们在每次迭代时都重新编译模板，这显然会很慢。

# python - 查看和过滤模型：管理面板还是非管理面板？

> ID：14048435
> 
> 赞同：0
> 
> 时间：2012-12-27T01:43:18.463
> 
> 标签：python, django

我对 Django 相当陌生，尽管我过去曾研究过其他 Web 框架。

我需要查看模型的所有实例，能够通过各种标准交互式地对它们进行排序和过滤，并对选定的对象执行任意处理。

我最初的方法是使用管理面板，因为它似乎提供了我正在寻找的开箱即用的功能以及身份验证（你可以猜到，我正在尝试建立某种后台办公室） .

尽管如此，我觉得管理面板本质上是为另一种用例设计的，这样使用它们会是不好的形式（呵呵，“形式”......没关系）。Django 书这一[章](http://www.djangobook.com/en/2.0/chapter06.html)的结尾似乎也印证了这种感觉。

这是正确的方法吗，还是我应该考虑从头开始写一些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:19:09.193

django 中的 Admin 非常强大和灵活。您可以定义自定义操作、验证、覆盖保存方法、覆盖默认模板等。因此建议修改管理员以满足您的需求，而不是从头开始编写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:49:04.443

我会毫不犹豫地选择 django admin。它提供 100% 您正在寻找的内容，并且适合模型编辑应用程序。从头开始构建东西将是一个非常耗时的过程。此外，您的最终代码可能会做管理员已经做过的事情，可能以一种效率较低的方式。

即使您没有使用 django admin 应用程序的经验，学习曲线也没有开发新界面那么高+您将知道如何在以后的项目中使用它。

我只会注册没有管理员前缀的管理站点，然后从那里开始:)

```
urlpatterns = patterns('',
    (r'^', include(admin.site.urls)),
) 
```

旁注：如果您想为管理应用程序增添趣味，您可以查看各种扩展它的第三方应用程序，例如grapelli 或 yawd-admin。

# javascript - .Js 如何晚餐 | 黑屏和增强元素，屏幕效果

> ID：14048439
> 
> 赞同：1
> 
> 时间：2012-12-27T01:43:49.170
> 
> 标签：javascript, jquery, dialog, screen, modal-dialog

我想制作一个屏幕效果，就像当你按下一个按钮时，一个对话框会出现在中心，而其余的空间会随着不透明度而变暗。

当您单击其按钮时，一个示例将类似于 Boostrap 的模态。

[http://twitter.github.com/bootstrap/javascript.html](http://twitter.github.com/bootstrap/javascript.html)

我的理解是显示一个我们可以简单地使用 .dialog() 等的元素，屏幕效果应该是 .dialog() 等内部使用的另一个函数。

我想知道，他们如何或使用什么功能来实现这种特定的屏幕效果？？？？我会很感激我会有一个脚本示例。非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T01:48:07.913

基本上，这是通过将 a 覆盖`div`在所有当前屏幕元素之上，并将其背景设置为黑色并将其不透明度设置为 50%-75% 来完成的。`div`然后最重要的是，将另一个包含您的“模态”内容的内容居中。

我建议使用 KendoUI、ExtJS、JQueryUI 等库，但它们都会执行类似于以下快速而肮脏的演示的操作：

```
<!DOCTYPE html>
<html>
<head>
    <title>Demo</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>
        $(function () {
            $('#button').click(function () {
                var blackOverlay = $('<div/>')
                    .attr('id', 'overlay')
                    .css({
                        'position': 'absolute',
                        'width': '100%',
                        'height': '100%',
                        'background-color': 'black',
                        'top': 0,
                        'left': 0,
                        'z-index': 1001,
                        'opacity': .75
                    });

                var modalContent = $('<div/>')
                    .css({
                        'z-index': 1002,
                        'background-color': 'white',
                        'display': 'inline-block',
                        'width': 300,
                        'height': 150,
                        'margin-left': 400,
                        'margin-top': 400
                    })
                    .html('This is the modal content.<br/>');

                var okayButton = $('<input/>')
                    .attr('type', 'button')
                    .attr('value', 'OK')
                    .click(function () {
                        blackOverlay.remove();
                    });

                modalContent.append(okayButton);

                blackOverlay.append(modalContent);

                $('body').append(blackOverlay);
            });
        });
    </script>
</head>
<body>
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    Here is some content.<br />
    <input id="button" type="button" value="Click Me" />
</body>
</html> 
```

# objective-c - 在 NSStatusItem 上实现 NSPopover

> ID：14048442
> 
> 赞同：4
> 
> 时间：2012-12-27T01:44:29.500
> 
> 标签：objective-c, cocoa, nsstatusitem, nspopover

我目前有一个`NSStatusItem`这样初始化的状态栏`awakeFromNib`：

```
 statusItem = [[NSStatusBar systemStatusBar] statusItemWithLength:NSVariableStatusItemLength];
    [statusItem setMenu:statusMenu];
    [statusItem setImage:statusImage];
    [statusItem setAlternateImage:statusHighlightedImage];
    [statusItem setHighlightMode:YES];
    [statusItem setTarget:self]; 
```

`NSMenu`单击图标时，我会打开一个。单击其中一个选项时，应该`NSPopover`从状态栏图标打开一个。为此，我有这段代码，它通过 Interface Builder 连接到菜单项：

```
- (IBAction)prefs:(id)sender {    
    NSRectEdge prefEdge = NSMaxYEdge;

    [[self pop] showRelativeToRect:[[statusItem view] bounds]
                          ofView:[statusItem view]
                   preferredEdge:prefEdge];
} 
```

但是，当我单击应该打开 Popover 的菜单项时，什么也没有发生。有什么特别的原因会导致这种情况吗？据我所知，应该可以做到。

提前致谢。我尽我所能查看了 Stack Overflow，但如果有一个真正重复的问题，请将我链接到它。

仅供参考：`statusItem`变量是`NSStatusItem`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:29:49.400

您需要自己设置一个视图，使用`[statusItem setView:]`for`[statusItem view]`来返回非`nil`.

如果您不介意使用私有 API，则可以尝试调用`[statusItem _button]`，但如果您打算提交到 App Store，则不允许这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-14T09:48:33.647

我不知道这个问题是否已经解决，但我没有什么笔记。

1.  第一步是验证（发出 NSLog，或在调试器中的断点处停止）您的菜单项确实有效，并且`prefs:` `IBAction`正在被调用。
2.  我不知道您的 UI 设计，但显示弹出框相对于命令它出现的 NSMenuItem 而不是相对于 NSStatusItem 是有意义的。所以使用`[(NSMenuItem *)sender view]`作为你的锚和它的界限。
3.  尝试从应用程序中的其他位置显示您的弹出窗口 - 只是为了确保实际的弹出窗口正常并且可以显示。

# ruby-on-rails-3.2 - 无法将现有 Rails 3.2.9 应用程序指向使用 postgres.app 创建的数据库

> ID：14048444
> 
> 赞同：0
> 
> 时间：2012-12-27T01:44:48.160
> 
> 标签：ruby-on-rails-3.2, postgresql-9.2, postgres.app

我目前有一个使用 PostgreSQL 数据库的 Rails 3.2.9 应用程序，当我将 Mac Mini 服务器升级到 Mountain Lion 时，这些数据库是使用 PgAdmin 重新创建的。数据库创建为我不知道的 9.2.1 版本。我想我使用的 PgAdmin 版本使用该版本号创建了它们。我只有升级到 Mountain Lion 的 Postgres 版本 9.1.4。我提交了另一个关于如何让 psql 的版本与我的数据库文件的版本相匹配的问题，因为这导致了实现 queue_classic 以运行后台作业的问题。在这一点上，我还没有收到任何回复。我继续查看并了解了 postgres.app。当前版本正在运行 PostgreSQL 9.2.2。

我已将当前数据库中的数据复制到 CSV 文件中。我还在 postgres.app 中使用了 psql 终端，并创建了我想在我的 Rails 应用程序中使用的新数据库。我决定更改 config/database.yml 中开发和测试数据库的定义，以确保在彻底测试之前不会弄乱生产数据库。为了确保我知道不同的数据库，我创建了不同名称的数据库，以确保我能够确定我的 Rails 应用程序指向使用 postgres.app 创建的数据库。

如 postgres.app 网站所述，我更改了 ,bashrc 中的路径。当我执行 which psql 时，它正确指向 postgres.app 版本 9.2.2。根据 postgres.app 网站所说的，我将 config/database/yml for development 更改为以下内容。

```
development:
  adapter: postgresql
  encoding: unicode
  database: newname_devl 
```

当我像往常一样使用 localhost:3000 运行我的 Rails 应用程序时，应用程序指向原始数据库。我期待一个错误，因为我没有执行 rake db:migrate 来重建新数据库中的所有表。

不知何故，我需要能够让我的 PostgreSQL 数据库版本与 PostgreSQL 的版本相匹配，但我不知道从这里去哪里。我会继续寻找。

任何帮助，将不胜感激。

**更新 2012 年 12 月 31 日上午 5:50 CST GMT-6**

我尝试了下面的命令。这是我之前尝试过的一个。我得到了命令下列出的错误（用户名被屏蔽）。

```
psql -h localhost
psql: FATAL:  role "username" does not exist 
```

我创建了角色“用户名”并再次尝试了该命令。我收到以下错误。

```
psql: FATAL:  database "username" does not exist 
```

我决定尝试下面的命令。我得到了命令下列出的错误。

```
psql -h localhost -U _postgres
psql: FATAL:  database "_postgres" does not exist 
```

数据库_postgres 不存在；数据库 postgres 可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T18:32:21.847

如果您已将 database.yml 更新为正确的名称，我不确定它将如何访问错误的数据库。当您将 database.yml 中的数据库名称更改为“foobar123”或您确定的某个名称在旧 Postgres 或新 Postgres 中都不存在时会发生什么？

# url - 登录后重定向到上一页？

> ID：14048455
> 
> 赞同：0
> 
> 时间：2012-12-27T01:46:03.430
> 
> 标签：url, redirect, login, joomla2.5

例如：我在个人资料页面的位置，当会话过期时，我刷新，重定向到登录页面。登录后如何重定向到个人资料页面？我正在使用 joomla 2.5。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T04:54:09.513

这是登录后重定向到上一页的一种方式。

```
$app                = JFactory::getApplication();

/*Return Url*/
$url = base64_encode(JRoute::_('index.php?option=com_test&view=products));

/*Login Url*/
$link = JRoute::_('index.php?option=com_users&view=login&return='.$url);

$app->Redirect($link); 
```

# javascript - 拆分 Ajax 动画

> ID：14048460
> 
> 赞同：0
> 
> 时间：2012-12-27T01:47:06.677
> 
> 标签：javascript, jquery, ajax, html, animation

我正在使用 jQuery 开发一个移动 Web 应用程序，我被要求将每个页面转换到下一个页面，其中页面“分成两半”，然后让上半部分向上滑动，底部向下滑动，因此揭示下一页。

我有一个小想法，但我似乎没有了解的知识：

2 带显示的画布：无，每个宽度宽度：100%，高度：50%。- 查看

将实际显示渲染到所述画布中 - 我没有丝毫想法。

Ajax 在两个画布下方的 div 中的下一页 - 检查

沿各自方向滑动画布 - 检查

将画布设置为 display: none 并将它们恢复到原始位置 - 检查

有什么想法吗？如果需要，我愿意使用 jQuery 中的任何其他框架 appart。我也愿意将我的画布想法变成其他东西。

编辑：至于澄清想象页面是一个壁橱，但是一个垂直的，所以它的门（实际页面）将分别滑入屋顶和地板（它不是最大的比较，但请耐心等待），因此让您看到壁橱的内容并与之互动（下一页）。这将一直持续到应用程序的工作流程在最后一个屏幕结束，因为没有后退按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:25:37.010

我很确定我知道你想要什么。您的注册/表单过程中有多个页面，而不是旧的淡入/淡出或滑动效果，您希望上半部分向上滑动，下半部分向下滑动。为了做到这一点，我会放弃这个`canvas`想法。我认为目前还没有一种简单的方法可以使用画布来做到这一点。您可以尝试使用[html2canvas](http://html2canvas.hertzen.com/)脚本，但在渲染此类内容时它并不是 100% 准确的。

作为替代方案，我建议使用以下过程。作为前言，请确保表单中的每个步骤都有自己的容器 div（称为“step-wrap”或“step-container”之类的明显名称）。然后，当你开始动画时，首先要做的是复制当前的 step-wrap，称之为 step-wrap-animation。将原始环绕、步进环绕、a 设为`height`50%，并将副本放置在第一个下方，高度相同为 50%。两个 div 都应该具有隐藏溢出的样式。还要确保`scrollTop`将重复的 div 设置为滚动到底部，使其看起来像第一个 div 的延续。从这里开始的一切都应该一帆风顺。

其次，一旦你在第一步中完成了所有工作，就开始动画过程。您可以随心所欲地执行此操作，因为我们已经确定了拆分功能。确保在开始将两个 div 分开之前，将下一步放在上一步之后，以便它解开。

本质上，您需要做的是：

1.  复制 div
2.  放置两个 div（原始和副本），使两个高度都等于 50%，并且它们看起来像彼此的延续
3.  动画顶部 div 向上，底部 div 向下

[这是](http://jsfiddle.net/gVa65/)一个基本的小提琴，说明了这样的事情应该如何工作。单击渲染的屏幕以启动动画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:26:27.443

看看基于backbone.js的[backbone.js](http://backbonejs.org)和[marionette.js 。](http://marionettejs.com/)

Backbone.js 是 MVC 框架，您可以在其中定义单独的视图。Marionette 是一个扩展，它支持基于任何你想要的区域和切换视图。在切换逻辑中，您可以轻松实现转换。非常通用的答案，但也许它会帮助您入门。

# webdriver - 在 Spock 规范中将参数传递给 Geb 的静态 at()

> ID：14048464
> 
> 赞同：1
> 
> 时间：2012-12-27T01:47:19.907
> 
> 标签：webdriver, spock, geb

我是否可以将参数传递给“at()”，以便在模块中使用参数？这是我的场景：

包含有关产品的一些常见细节的页面的模块（ProductModule，它有一个我想参数化的内容标题）。我有一个使用该模块的页面，但我希望“at()”在测试期间将产品标题传递给它。这可能吗？

我的用途是（在伪代码中）

```
...
...
when:
go ProductPage

then:
at ProductPage(title:”Product title goes here”) // this is the parameter I want to pass down to the “at” since the check is a content segment in the Module

and:
…
… 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T18:42:32.560

您可以在 ProductPage 上设置一个静态字段：

ProductPage.title = "标题"

然后 at 定义将使用 ProductPage.title 字段

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T13:13:52.027

事实证明，图书馆的创建者对创建类似的功能犹豫不决。该功能（个别测试方法）应负责检查。我仍然希望看到与此相关的内容，因此我可以保留一组简单的“页面”对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T20:04:43.543

我相信答案是“不”。而且我还没有找到实现这一目标的替代方法。自从你几个月前问过这个问题以来，也许你已经问过了？

# c# - BigInteger 到十六进制/十进制/八进制/二进制字符串？

> ID：14048476
> 
> 赞同：13
> 
> 时间：2012-12-27T01:51:49.980
> 
> 标签：c#, tostring, biginteger

在Java中，我可以做

```
BigInteger b = new BigInteger(500); 
```

然后按照我的喜好格式化

```
b.toString(2); //binary
b.toString(8); //octal
b.toString(10); //decimal
b.toString(16); //hexadecimal 
```

在 C# 中，我可以做到

```
int num = int.Parse(b.ToString());
Convert.ToString(num,2) //binary
Convert.ToString(num,8) //octal 
```

等等，但我只能用`long`更小的值来做。是否有某种方法可以打印具有指定基数的 BigInteger？我发布了这个，[BigInteger Parse Octal String?](https://stackoverflow.com/questions/14040483/biginteger-parse-octal-string/14040916) ，昨天收到了如何将基本上所有字符串转换为 BigInteger 值的解决方案，但没有成功输出。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-16T08:19:37.593

# 转换`BigInteger`为十进制、十六进制、二进制、八进制字符串：

让我们从一个`BigInteger`值开始：

```
BigInteger bigint = BigInteger.Parse("123456789012345678901234567890"); 
```

# 基数 10 和基数 16

内置的 Base 10（十进制）和 Base 16（十六进制）转换很容易：

```
// Convert to base 10 (decimal):
string base10 = bigint.ToString();

// Convert to base 16 (hexadecimal):
string base16 = bigint.ToString("X"); 
```

## 前导零（正与负 BigInteger 值）

请注意，当 的值为正时，这`ToString("X")`可确保十六进制字符串具有前导零。这与从抑制前导零的其他值类型转换时`BigInteger`的通常行为不同。`ToString("X")`

例子：

```
var positiveBigInt = new BigInteger(128);
var negativeBigInt = new BigInteger(-128);
Console.WriteLine(positiveBigInt.ToString("X"));
Console.WriteLine(negativeBigInt.ToString("X")); 
```

结果：

```
080
80 
```

这种行为是有目的的，因为前导零表示它`BigInteger`是一个正值——本质上，前导零提供了符号。这是必要的（与其他值类型转换相反），因为 a`BigInteger`没有固定大小；因此，没有指定的符号位。前导零表示正值，而不是负值。这允许通过“往返”`BigInteger`值输出`ToString()`和返回 through `Parse()`。此行为在 MSDN 上的[BigInteger Structure](http://msdn.microsoft.com/library/dd268287)页面上进行了讨论。

# 扩展方法：BigInteger 到 Binary、Hex 和 Octal

`BigInteger`这是一个包含将实例转换为二进制、十六进制和八进制字符串的扩展方法的类：

```
using System;
using System.Numerics;
using System.Text;

/// <summary>
/// Extension methods to convert <see cref="System.Numerics.BigInteger"/>
/// instances to hexadecimal, octal, and binary strings.
/// </summary>
public static class BigIntegerExtensions
{
  /// <summary>
  /// Converts a <see cref="BigInteger"/> to a binary string.
  /// </summary>
  /// <param name="bigint">A <see cref="BigInteger"/>.</param>
  /// <returns>
  /// A <see cref="System.String"/> containing a binary
  /// representation of the supplied <see cref="BigInteger"/>.
  /// </returns>
  public static string ToBinaryString(this BigInteger bigint)
  {
    var bytes = bigint.ToByteArray();
    var idx = bytes.Length - 1;

    // Create a StringBuilder having appropriate capacity.
    var base2 = new StringBuilder(bytes.Length * 8);

    // Convert first byte to binary.
    var binary = Convert.ToString(bytes[idx], 2);

    // Ensure leading zero exists if value is positive.
    if (binary[0] != '0' && bigint.Sign == 1)
    {
      base2.Append('0');
    }

    // Append binary string to StringBuilder.
    base2.Append(binary);

    // Convert remaining bytes adding leading zeros.
    for (idx--; idx >= 0; idx--)
    {
      base2.Append(Convert.ToString(bytes[idx], 2).PadLeft(8, '0'));
    }

    return base2.ToString();
  }

  /// <summary>
  /// Converts a <see cref="BigInteger"/> to a hexadecimal string.
  /// </summary>
  /// <param name="bigint">A <see cref="BigInteger"/>.</param>
  /// <returns>
  /// A <see cref="System.String"/> containing a hexadecimal
  /// representation of the supplied <see cref="BigInteger"/>.
  /// </returns>
  public static string ToHexadecimalString(this BigInteger bigint)
  {
    return bigint.ToString("X");
  }

  /// <summary>
  /// Converts a <see cref="BigInteger"/> to a octal string.
  /// </summary>
  /// <param name="bigint">A <see cref="BigInteger"/>.</param>
  /// <returns>
  /// A <see cref="System.String"/> containing an octal
  /// representation of the supplied <see cref="BigInteger"/>.
  /// </returns>
  public static string ToOctalString(this BigInteger bigint)
  {
    var bytes = bigint.ToByteArray();
    var idx = bytes.Length - 1;

    // Create a StringBuilder having appropriate capacity.
    var base8 = new StringBuilder(((bytes.Length / 3) + 1) * 8);

    // Calculate how many bytes are extra when byte array is split
    // into three-byte (24-bit) chunks.
    var extra = bytes.Length % 3;

    // If no bytes are extra, use three bytes for first chunk.
    if (extra == 0)
    {
      extra = 3;
    }

    // Convert first chunk (24-bits) to integer value.
    int int24 = 0;
    for (; extra != 0; extra--)
    {
      int24 <<= 8;
      int24 += bytes[idx--];
    }

    // Convert 24-bit integer to octal without adding leading zeros.
    var octal = Convert.ToString(int24, 8);

    // Ensure leading zero exists if value is positive.
    if (octal[0] != '0' && bigint.Sign == 1)
    {
      base8.Append('0');
    }

    // Append first converted chunk to StringBuilder.
    base8.Append(octal);

    // Convert remaining 24-bit chunks, adding leading zeros.
    for (; idx >= 0; idx -= 3)
    {
      int24 = (bytes[idx] << 16) + (bytes[idx - 1] << 8) + bytes[idx - 2];
      base8.Append(Convert.ToString(int24, 8).PadLeft(8, '0'));
    }

    return base8.ToString();
  }
} 
```

乍一看，这些方法似乎比必要的复杂。实际上，添加了一些额外的复杂性以确保正确的前导零出现在转换后的字符串中。

让我们检查每个扩展方法，看看它们是如何工作的：

## BigInteger.ToBinaryString()

以下是如何使用此扩展方法将 a 转换`BigInteger`为二进制字符串：

```
// Convert BigInteger to binary string.
bigint.ToBinaryString(); 
```

这些扩展方法的基本核心是`BigInteger.ToByteArray()`方法。此方法将 a 转换`BigInteger`为字节数组，这就是我们如何获得值的二进制表示`BigInteger`：

```
var bytes = bigint.ToByteArray(); 
```

但请注意，返回的字节数组是小端顺序的，因此第一个数组元素是`BigInteger`. 由于 a`StringBuilder`用于构建输出字符串（从最高有效位 (MSB) 开始），因此**必须反向迭代字节数组，**以便首先转换最高有效字节。

因此，索引指针被设置为字节数组中的最高有效位（最后一个元素）：

```
var idx = bytes.Length - 1; 
```

为了捕获转换后的字节，`StringBuilder`创建了 a：

```
var base2 = new StringBuilder(bytes.Length * 8); 
```

构造`StringBuilder`函数获取`StringBuilder`. 所需的容量`StringBuilder`是通过将要转换的字节数乘以八来计算的（每个转换的字节产生八位二进制数字）。

然后将第一个字节转换为二进制字符串：

```
var binary = Convert.ToString(bytes[idx], 2); 
```

此时，如果`BigInteger`是正值，则必须确保存在前导零（参见上面的讨论）。如果第一个转换的数字不是零并且`bigint`是正数，则将 a`'0'`附加到`StringBuilder`：

```
// Ensure leading zero exists if value is positive.
if (binary[0] != '0' && bigint.Sign == 1)
{
  base2.Append('0');
} 
```

接下来，转换后的字节被附加到`StringBuilder`：

```
base2.Append(binary); 
```

为了转换剩余的字节，循环以相反的顺序迭代字节数组的剩余部分：

```
for (idx--; idx >= 0; idx--)
{
  base16.Append(Convert.ToString(bytes[idx], 2).PadLeft(8, '0'));
} 
```

请注意，每个转换后的字节在必要时在左侧用零（'0'）填充，以便转换后的字符串是八个二进制字符。这是极其重要的。如果没有此填充，十六进制值“101”将转换为二进制值“11”。前导零确保转换为“100000001”。

当所有字节都被转换后，`StringBuilder`包含完整的二进制字符串，由扩展方法返回：

```
return base2.ToString(); 
```

## BigInteger.ToOctalString

将 a 转换`BigInteger`为八进制（以 8 为基数）字符串更为复杂。问题是八进制数字表示三位，这不是由`BigInteger.ToByteArray()`. 为了解决这个问题，数组中的三个字节被组合成 24 位的块。每个 24 位块均匀地转换为 8 个八进制字符。

第一个 24 位块需要一些模数学：

```
var extra = bytes.Length % 3; 
```

此计算确定当整个字节数组被分成三字节（24 位）块时有多少字节是“额外的”。第一次转换为八进制（最重要的数字）获得“额外”字节，因此所有剩余的转换将分别获得三个字节。

如果没有“额外”字节，则第一个块获得完整的三个字节：

```
if (extra == 0)
{
  extra = 3;
} 
```

第一个块被加载到一个名为的整数变量中，该变量`int24`最多可容纳 24 位。块的每个字节都被加载。随着额外的字节被加载，之前的位`int24`被左移 8 位以腾出空间：

```
int int24 = 0;
for (; extra != 0; extra--)
{
  int24 <<= 8;
  int24 += bytes[idx--];
} 
```

将 24 位块转换为八进制是通过以下方式完成的：

```
var octal = Convert.ToString(int24, 8); 
```

`BigInteger`同样，如果是正值，则第一个数字必须是前导零：

```
// Ensure leading zero exists if value is positive.
if (octal[0] != '0' && bigint.Sign == 1)
{
  base8.Append('0');
} 
```

第一个转换的块附加到`StringBuilder`：

```
base8.Append(octal); 
```

剩余的 24 位块在循环中转换：

```
for (; idx >= 0; idx -= 3)
{
  int24 = (bytes[idx] << 16) + (bytes[idx -1] << 8) + bytes[idx - 2];
  base8.Append(Convert.ToString(int24, 8).PadLeft(8, '0'));
} 
```

与二进制转换一样，每个转换后的八进制字符串都用零填充，因此“7”变为“00000007”。这确保不会从转换后的字符串中间删除零（即，'17' 而不是 '100000007'）。

## 转换为基数 x？

将 a 转换`BigInteger`为其他数字基数可能要复杂得多。只要数字基数是 2 的幂（即 2、4、8、16），由 所创建的字节数组`BigInteger.ToByteArray()`就可以适当地拆分为比特块并进行转换。

但是，如果数基不是 2 的幂，问题就会变得复杂得多，并且需要大量的循环和除法。由于这种基数转换很少见，我在这里只介绍了流行的计算基数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-30T14:17:28.437

经过漫长的一天与 BigInteger 的合作，我找到了一种更好的方法来输出二进制字符串，试试这个！（适用于负数）

```
// Important note: when parsing hexadecimal string, make sure to prefix
// with 0 if the number is positive. Ex: 0F instead of F, and 01A3 instead of 1A3.
// If the number is negative, then the first bit should be set to 1.

var x = BigInteger.Parse("0F", NumberStyles.HexNumber); // Or: BigInteger.Parse("15")

var biBytes = x.ToByteArray();

var bits = new bool [8 * biBytes.Length];

new BitArray(x.ToByteArray()).CopyTo(bits, 0);

bits = bits.Reverse().ToArray(); // BigInteger uses little endian when extracting bytes (thus bits), so we inverse them.

var builder = new StringBuilder();

foreach(var bit in bits)
{
    builder.Append(bit ? '1' : '0');
}

string final = Regex.Replace(builder.ToString(), @"^0+", ""); // Because bytes consume full 8 bits, we might occasionally get leading zeros.

Console.WriteLine(final); 
```

> 输出：1111

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-03T17:07:41.597

`BigInteger`这是将 a 转换为任何基数的简单方法：

```
public static string ToNBase(BigInteger a, int n)
        {
            StringBuilder sb = new StringBuilder();
            while (a > 0)
            {
                sb.Insert(0,a % n);
                a /= n;
            }
            return sb.ToString();
        } 
```

它非常适合base 2-10。如果您希望它产生十六进制或其他更高的基字符串，您必须`a % b`在插入之前根据基数修改 ' 的形式。

# datatable - YUI Datatable -- 如何将行标记为已修改？

> ID：14048488
> 
> 赞同：1
> 
> 时间：2012-12-27T01:54:08.973
> 
> 标签：datatable, yui3

我正在使用 YUI 3.7.3，并且有一个 DataTable 的实例。表中的行由“Session”对象表示，表列中显示的值来自每个 Session 对象的内部列表（即，我为每列指定“格式化程序”。）当新数据添加到内部列表（基本上是更新的会话状态），我希望能够告诉 DataTable 该行需要标记为脏/重新显示。但是怎么做？DataTable.modifyRow() 似乎没有这样做，因为我实际上并没有修改 Session 对象的直接属性——我正在将数据添加到 Session 的子列表中。

告诉 DataTable 需要重新显示特定行的推荐方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:15:39.100

似乎没有一种直接的方法来指示单行的记录需要重新呈现。您可以尝试在相关模型上模拟[更改](https://yuilibrary.com/yui/docs/api/classes/Model.html#event_change)事件。

```
var table = new Y.DataTable({
  columns: [
    { key: 'obj', label: 'nested', formatter: function (o) { return o.value.nested; } }
  ],
  data: [ {obj: {nested: 42}} ]
}).render('#table'), row = table.getRecord(0), data = row.get('obj');

data.nested = 47;
row.fire('change', { changed: { prevVal: data, newVal: data } }); 
```

根据您想模仿[Model:change](https://yuilibrary.com/yui/docs/api/classes/Model.html#event_change)事件的程度，您可能希望在更改数据之前执行数据的深层复制，然后将其作为 prevVal 传递。出于更新 DataTable 视图的目的，这似乎无关紧要，因为您也可以这样做：

```
row.fire('change'); 
```

结果是一样的。这是脆弱的，并且可能不是该界面的预期使用方式。但是，如果您需要完成的只是在更改内部状态后更新视图，而不是触发任何与更改相关的事件，那么[DataTable.syncUI](https://yuilibrary.com/yui/docs/api/classes/DataTable.html#method_syncUI "数据表.syncUI")是一个更优雅的解决方案。

```
var table = new Y.DataTable({
  columns: [
    { key: 'obj', label: 'nested', formatter: function (o) { return o.value.nested; } }
  ],
  data: [ {obj: {nested: 42}} ]
}).render('#table'), row = table.getRecord(0), data = row.get('obj');

data.nested = 47;
table.syncUI(); 
```

有了这个，您可以执行所有数据操作，然后`syncUI`在您想要重绘时调用，而不是为修改的每一行触发。希望这可以帮助。

# oracle - 来自多个表/数据集的 Oracle/SAS 记录匹配

> ID：14048489
> 
> 赞同：1
> 
> 时间：2012-12-27T01:54:13.133
> 
> 标签：oracle, sas

我有 4 张非常大的桌子。让我称它们为 X、A、B 和 C。

我想从 X 创建另外两个表 X1 和 X2，如下所示：

考虑表 X 中的记录 r。如果 r 在表 A、B 和 C 中的至少一个中具有相应的记录，我将其放在 X1 中。否则我把它放在 X2 中。

（我如何确定 r 在 A、B 或 C 中有对应的记录？我将 r 的一些字段与 A、B 或 C 中记录的一些字段进行比较。A、B 或 C 的字段可能不同并且可能有多个标准可以将 r 与 A、B 或 C 中的记录匹配。可能这部分与主要问题无关。）

我有两种选择：我可以将 X、A、B 和 C 作为 Oracle 表或 SAS 数据集。

解决这个问题最有效的方法是什么？

问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T14:36:01.353

Tartaglia 的答案相当接近，但一步完成可能更容易。

```
data x1 x2;
merge x(in=x) a(in=found keep=id) b(in=found keep=id) c(in=found keep=id);
by id;
if x and found then output x1;
else if x then output x2;
run; 
```

**确保 'found' 和 'x' 不是任何原始数据集上的变量，否则使用其他** 变量 如果你这样做了，那么如果你有多个匹配场景，那么你需要弄清楚如何确保你得到正确的变量。还需要对所有四个表进行排序（可能很慢）。

另一个 SAS 解决方案：哈希表。这*不需要*对数据集进行排序。如果您的数据集尚未按顺序排列，这可能会更快。但是，它确实需要足够的内存来将所有表 a、b 和 c 存储在内存中，这可能会受到这些数据集大小的限制；并且当 a,b,c 相对于 x 较小而不是它们具有相似大小时更好。可以使用defineData对其进行操作以从a / b / c产生数据而不仅仅是返回代码，但是如果在a，b，c中的两个（或三个都）。

```
data abc/view=abc;
set a b c;
keep id;
run;

data x1 x2;
if _n_ = 1 then do;
 declare hash abc(dataset:"abc");
 abc.defineKey("id");
 abc.defineDone();
 call missing(id);
end;
set x;
rc = abc.find();
if rc=0 then output x1;
else output x2;
run; 
```

要在 oracle 中做到这一点，我想我会做一些更接近 tartaglia 解决方案的事情 - 创建三个“匹配”表，然后将它们合并（删除联合中的重复项），然后创建 x2 作为 x 减x1 表。IE（这在 SAS 中的 PROC SQL 中有效，不确定 oracle 是否完全相同）：

```
create table x1 as
  select x.* from x,a where x.id=a.id
  union
  select x.* from x,b where x.id=b.id
  union
  select x.* from x,c where x.id=c.id
;
create table x2 as
  select * from x except select * from x1; 
```

我使用 SAS 测试了这些（包括 SQL 解决方案，Oracle 可能更擅长但应该是类似的顺序 - 尽管如果您的 oracle 服务器比您的 sas 服务器更快，这可能会改变一些事情）。

使用具有 5e7 条记录的数据集“x”和具有公平重叠的三个数据集“a”“b”“c”（可能 25% 左右的记录在 2 个或更多数据集中，84% 在一个或多个数据集中）和每条记录在 1.5e7 和 3e7 之间（具体来说，一个全是奇数，一个是 3 的倍数，一个是 4 的偶数倍数），SQL 解决方案在排序和合并时需要 5 分钟以上的时间来处理解决方案排序大约需要 2.5 分钟，合并大约需要 0.5 分钟，因此总共大约需要 3 分钟。这可能有点夸张，因为数据集是按排序创建的，因此排序本身可能会更快一些（尽管 SQL 也会从有序的数据集中获得一些收益）。

相比之下，5e7 数据集 x 的写出时间约为 5 秒。

哈希解决方案不适合我的笔记本电脑上的内存，整个 ~6e7 记录数据集 abc，所以我将它们缩小到总共 ~2e7（所以几率从 1 到 2e7，然后是 3 的倍数从 2e7 到 4e7，然后是从 4e7 到 6e7 的 4 的倍数），但剩下的 x 中有 5e7 条记录。然后哈希解决方案总共花费了 1:41，而排序和合并解决方案花费了相似的时间，其中大部分是对 x 进行排序（大约一分钟）并合并/写出结果数据集（大约半分钟） . 这比对较大数据集进行排序要快得多，因为较小的数据集在内存中排序，而较大的数据集则不能。使用这些数据集的 SQL 解决方案大约需要 4 分钟，因此仍然慢得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T14:25:23.080

如果我理解正确，你可以这样做：

将数据集 X 和 A 合并到要在其中查找匹配项的变量上。将 X 中与记录形式 A 匹配的记录输出到 X1，并将不匹配的记录输出到 X2。

假设您正在处理示例数据集 X 和 A：

```
data x;
input id some_value $;
datalines;
1 a
2 b
3 c
4 d
5 e
run;

data a;
input id some_value $ some_value_2 $;
datalines;
1 a x
4 d v
5 g u
run; 
```

现在，您可以像这样进行合并：

```
data x1_a x2_a;
merge x(in=table_x) a(in=table_a keep=id some_value);
by id some_value;
if table_x = 1 and table_a = 1 then output x1_a;
if table_x = 1 and table_a = 0 then output x2_a;
run; 
```

对数据集 B 和 C 重复此操作，如果与数据集 B 和 C 的匹配规则不同，则更改`by`and语句。还要更改 and 的名称等，这样它们就不会被覆盖。`keep``x1_a``x2_a``x1_b`

附加所有`x1_`表格，您就拥有了`X1`问题中描述的数据集（您可能必须处理重复项）。

附加所有`x2_`表，并计算不同的行。与您要比较的初始数据集（在本例中为 3；A、B、C）完全相同的行是您保留的行。

# android - 在surfaceview膨胀布局上使用点击监听器

> ID：14048495
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:55:07.347
> 
> 标签：android, surfaceview

我有一个surfaceview，它打开一个带有膨胀布局的alertdialog，我想在这个布局的imageview上使用一个图像onclicklistener，但是每当我尝试加载对话框时都会得到一个nullpointerexception，当我将onclicklistener设置为imageview时会发生这种情况'鸣叫'。如果我删除侦听器，它将加载而不会出现错误。下面是我的代码

```
 activity.runOnUiThread(new Runnable(){

                public void run() {
                    AlertDialog.Builder adb = new AlertDialog.Builder(Panel.this.context);

                     try{ 
                         LayoutInflater inflater = ((Activity) context).getLayoutInflater(); 
                        View dialoglayout = inflater.inflate(R.layout.activity_anime_action, null);

                       adb.setView(dialoglayout)
                       .setNegativeButton("Done", new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog, int id) {
                                Intent myIntent = new Intent(context, ActivityOne.class);
                                myIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                context.startActivity(myIntent);
                                ((Activity) context).finish(); 
                                dialog.cancel(); 
                            }
                        }); 
                           ImageView tweet = (ImageView)((Activity) context).findViewById(R.id.dialog_tweet);
                           tweet.setOnClickListener(new View.OnClickListener() {

                            public void onClick(View v) {
                                Log.d(VIEW_LOG_TAG, "WORKD");

                            }
                            });
                       }catch(Exception e){Log.d("INFLATER ERROR", e.toString());}
                    adb.show(); 

                }}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:26:46.320

您应该从中找到 ImageView `dialogLayout`，因为那是您正在使用的对话框的布局。

更新的代码应该是：

```
ImageView tweet = (ImageView) dialoglayout.findViewById(R.id.dialog_tweet); 
```

# z3 - Z3 API 中的自定义理论求解器方法发生了什么变化？

> ID：14048498
> 
> 赞同：1
> 
> 时间：2012-12-27T01:55:26.490
> 
> 标签：z3

我一直在阅读 Nikolai 关于 Z3 工程理论的文章，​​了解如何将自定义决策程序与 Z3 接口。其中提到了几种方法，例如 AssertTheoryAxiom、NewAssignment 和 FinalCheck 等。[但是，我无法在http://research.microsoft.com/en-us/um/redmond/projects/z3/namespace_microsoft_1_1_z3.html](http://research.microsoft.com/en-us/um/redmond/projects/z3/namespace_microsoft_1_1_z3.html)的最新（新？）Z3 API 中找到它们。有人可以告诉我他们或他们的替代者在哪里吗？2\. 在相关说明中，我在界面中看到了几个新概念，例如探针和战术。这些是否在任何地方进行了描述或解释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:30:39.673

当前不推荐使用自定义决策过程的界面。它们仍然可以与旧的求解器 API 一起使用。有关其他信息，请参阅以下帖子：

*   [将理论插件与求解器一起使用](https://stackoverflow.com/questions/13587101/using-theory-plugins-with-solvers)

*   [自定义简化器](https://stackoverflow.com/questions/13802651/custom-simplifiers)

[这](http://research.microsoft.com/en-us/um/redmond/projects/z3/deprecated.html#_deprecated000021)是已弃用 API 的完整列表。关于战术和探测，请参阅[这篇文章](http://research.microsoft.com/en-us/um/people/leonardo/strategy.pdf)，以及有关它的 Z3 教程（[Python](http://rise4fun.com/Z3Py/tutorial/strategies)和[SMT 2.0](http://rise4fun.com/Z3/tutorial/strategies)）。

# internet-explorer - Zend 框架 - Internet Explorer - phpsessid cookie 问题

> ID：14048499
> 
> 赞同：3
> 
> 时间：2012-12-27T01:55:34.290
> 
> 标签：internet-explorer, zend-framework, session, session-cookies, p3p

我创建了一个 Zend Framework 网站应用程序会话密集型。

它在 Chrome 和 Firefox 中运行良好，但在 IE 中无法运行。会话重置 IE 中的每个页面。

查看标题，我发现 IE 浏览器在同一浏览器中的每次获取或发布时都会获取不同的 phpsessid cookie，因此会话无法正常工作。在 FF 和 Chrome 中，phpsessid cookie 仍然存在。

任何人都知道为什么这只能在 IE 中发生？

我在 bootstrap.php 中有这段代码：

```
$generalSession  = new Zend_Session_Namespace('MyNameHere');
$generalSession ->setExpirationSeconds(1000 * 60); 
```

我使用以下方法恢复会话：

```
Zend_Auth::getInstance()->getStorage()->read(); 
```

我的 IE 隐私和安全配置设置为最低，使用 IE9。

我尝试在标题中放置一个 p3p cookie，但没有任何区别。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T21:51:57.970

我终于解决了IE的问题。

问题是我们的开发服务器是 dev_landing.mysite.com，而 IE 拒绝来自名称中带有“_”的站点的标头……这是 IE 设计的。

我在这里找到了完整的解释：http: [//odedpeer.blogspot.com.es/2009/08/why-are-my-http-cookies-rejected-by-ie.html](http://odedpeer.blogspot.com.es/2009/08/why-are-my-http-cookies-rejected-by-ie.html)

继续！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T10:40:22.187

您需要确保[会话在 ZF1 中开始](http://framework.zend.com/manual/1.12/en/zend.session.advanced_usage.html#zend.session.advanced_usage.starting_a_session)：

```
 //in bootstrap.php
 protected function _initsession()
    {
        Zend_Session::start();
    } 
```

这将像在普通 PHP 中一样初始化会话。

除非你在别处改变它[Zend_Auth 使用 Zend_Session_Namespace('Zend_Auth');](http://framework.zend.com/manual/1.12/en/zend.auth.introduction.html#zend.auth.introduction.persistence.default) 因此 Zend_Auth 将无法访问您创建的任何名称空间。

当您创建[Zend_Session_Namespace()](http://framework.zend.com/manual/1.12/en/zend.session.advanced_usage.html#zend.session.advanced_usage.starting_a_session)的实例时，如果会话尚未启动，它将启动。

如果您在资源管理器中没有获得新的会话 ID，我不得不怀疑每次您的 boostrap.php 运行（每个请求） Zend_Session_Namespace() 调用。也许尝试在引导程序中调用 start 并在需要时实例化命名空间。您的问题中不存在的某些代码/信息也可能会影响会话。

这里有很多猜测，祝你好运。

# php - 循环仅在返回一行时有效

> ID：14048501
> 
> 赞同：0
> 
> 时间：2012-12-27T00:52:25.390
> 
> 标签：php, loops

我正在使用以下命令查询数据库：

```
$result = mysql_query("SELECT * FROM users WHERE country = '$_SESSION[country]' AND city = '$_SESSION[city]' ORDER BY id DESC");
if(mysql_num_rows($result) == 1) {
  while($row = mysql_fetch_array($result)) {
    echo "OK";
    $n = 1;
    echo '<div class="control-group">
          <div class="controls">
          <label class="checkbox">
          <input type="checkbox" name="users" value="'.$row['id'].'" onclick="\'chkcontrol('.$n++.')\';">'.$row['name'].'
          </label>
          </div>
          </div>';
  }
} 
```

如果表中只有一行，它将返回 True（有效）。如果我添加另一个，它会返回 False。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T00:58:45.943

`if(mysql_num_rows($result) == 1)` 必须`if(mysql_num_rows($result) >= 1)`确定。

否则只有当恰好为 1`if`时才会为真（并进入循环） 。`mysql_num_rows($result)`

解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:05:22.357

您对会话变量的查询似乎不正确，应该是

```
$result = mysql_query("SELECT * FROM users WHERE country = '{$_SESSION['country']}' AND city = '{$_SESSION['city']}' ORDER BY id DESC"); 
```

# c# - 我应该使用什么组件而不是列表框？

> ID：14048511
> 
> 赞同：-1
> 
> 时间：2012-12-27T01:58:10.247
> 
> 标签：c#, silverlight, windows-phone-7, listbox

我的应用程序显示来自社交网络的新闻源。每个提要都有不同的附件 - 图像、视频、音频等，因此每个提要都有不同的高度。新闻源使用模板选择器显示在列表框中。我阅读了[MSDN](http://blogs.msdn.com/b/slmperf/archive/2010/10/06/silverlight-for-windows-phone-7-listbox-scroll-performance.aspx)并且如我所见 - 我打破了几乎所有如何使用列表框的规则（非固定大小的项目、嵌套列表框等）。结果 - 我有滞后列表框，它可以在需要时从一个项目跳到另一个项目。所以，如果 MS 不能制作一个列表框，它通常可以与动态项目一起使用，我用什么来获得项目的平滑滚动？

UPD：为什么是减号？你可以解释吗？这是个坏问题？我认为不仅对我来说它很重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T10:35:57.687

您可以在滚动查看器中尝试堆栈面板。

您也可以仅在滚动查看器接近显示该项目时才加载图像和文本，而不是在开始时一直加载所有内容。这减少了互联网流量、加载时间和滚动时的延迟。当然这会花费你一些编码时间，但相信我——这将是非常值得的！大多数服务都使用它，从而减少服务器负载和流量。

检查是否有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T11:25:50.360

您可以尝试使用 ItemTemplate 的 ItemPresenter 控件。

# c# - 如何计算当前支付期结束的时间？

> ID：14048514
> 
> 赞同：1
> 
> 时间：2012-12-27T01:58:20.990
> 
> 标签：c#

我想知道如何计算这个支付期的最后日期？

我知道工资是双周的，第一期从 2012 年 1 月 9 日开始。到目前为止我所做的

```
 DateTime d = new DateTime();
    d = Convert.ToDateTime("01/09/2012");

    while (d <= Convert.ToDateTime("01/06/2013")) {

        PayPeriod.Items.Add(new ListItem(d.ToString("MM/dd/yyyy"), d.ToString("MM/dd/yyyy")));

        d = d.Date.AddDays(14);
    } 
```

这项工作很完美，但它很完美，因为我已经手动将当前支付期的结束时间设置为“01/06/2013”​​。

我的问题是如何自动找出当前支付期的最后日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T02:24:49.180

您可以使用以下逻辑轻松完成此操作：

```
DateTime startTime = new DateTime(2012,09,01);
DateTime now = DateTime.Now;
var diff = now.Subtract (startTime);
int daysToEndPeriod = diff.Days % 14;
if (daysToEndPeriod == 0)
    Console.WriteLine("end of pay period");
else
    Console.WriteLine("end of pay period is: " + DateTime.Now.AddDays(14-daysToEndPeriod).Date); 
```

这是有效的，因为您将始终让 Modulo 运算符返回您离开支付期的天数。

# c# - 调试 .net 的 WebClient

> ID：14048527
> 
> 赞同：4
> 
> 时间：2012-12-27T02:01:50.127
> 
> 标签：c#, webclient

有什么好的方法（除了安装 WireShark）来获取发送到网络服务器的原始 http 请求数据吗？我怀疑我发送的请求不正确或格式错误，但我不知道如何通过调用 WebClient.UploadValues 获取它发送到网络服务器的原始请求字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T02:13:58.683

**Fiddler**在我们 Windows 开发人员中间已经有很长一段时间了，即使它被[Telerik 收购，](http://www.telerik.com/automated-testing-tools/blog/christophereyhorn/12-09-10/here-we-grow-again-telerik-acquires-fiddler-what-s-next.aspx)它仍然是调试在线上所有内容的最佳工具之一。

顺便说一句，Fiddler 不仅适用于“.NET WebClient”，它适用于整个网络中计算机中发生的所有事情，并且`ajax`在使用 javascript 调试请求时非常有用！

[**安装**并启动它](http://www.fiddler2.com/Fiddler2/version.asp)

*   在左侧，您将让所有对象通过带有漂亮颜色编码的“电线”
*   在右侧，您可以了解有关所选请求/响应的所有信息
*   右侧垂直分为两部分，顶部区域表示*请求*，底部区域表示*响应*

![在此处输入图像描述](../Images/564baf504a85e2d98f61138df58b6f33.png)

只需在左侧选择您发送的请求，在右侧选择**Inspector**，然后在顶部选择*Header*（查看完整的标头）或*Raw*以查看已发送的全文，在底部执行相同操作.

如果您没有获得有关响应的任何信息，请将*Transformer*设置为**无压缩**，这样您就可以看到整个响应，即使它已被压缩。

有关更多信息，请参阅[他们页面上的教程](http://www.fiddler2.com/Fiddler/help/video/default.asp)

另外，安装[语法高亮](http://www.fiddler2.com/Fiddler2/extensions.asp)插件...非常有用

* * *

对于您的特定问题：

1.  打开**提琴手**
2.  在您的网页上，执行所有操作，直到您单击某个操作以执行您需要的操作
3.  返回 Fiddler 并清除所有请求 Edit > Remove > All Sessions 或`Ctrl`+`X`
4.  单击您的链接或按钮，该链接或按钮会发出您需要调试的请求
5.  看看清单上发生了什么
6.  点击请求（在左侧）
7.  在**检查器**中选择*Raw*
***   通过单击请求详细信息底部的*Raw来查看响应**   查看所有其他视图并找到问题**

# python - Tastypie：包括来自相关模型的计算字段？

> ID：14048531
> 
> 赞同：1
> 
> 时间：2012-12-27T02:03:08.900
> 
> 标签：python, django, tastypie

我查看了 Tastypie 的文档并搜索了一段时间，但似乎无法找到答案。

假设我们有两个模型：`Student`和`Assignment`，它们之间存在一对多的关系。该`Assignment`模型包括一个`assignment_date`字段。基本上，我想使用 Tastypie 构建一个 API，它返回**按最近分配日期排序的**`Student`对象。排序是在服务器还是在客户端完成并不重要——但无论在哪里完成排序，都需要排序。**`assignment_date`**

 **想法＃1：只需与学生一起返回作业。

```
class StudentResource(ModelResource):
    assignments = fields.OneToManyField(
        AssignmentResource, 'assignments', full=True)

    class Meta:
        queryset = models.Student.objects.all()
        resource_name = 'student' 
```

不幸的是，每个学生可能有数十或数百个作业，因此这是臃肿且不必要的。

想法#2：在脱水循环期间增加数据。

```
class StudentResource(ModelResource):    
    class Meta:
        queryset = models.Student.objects.all()
        resource_name = 'student'

    def dehydrate(self, bundle):
        bundle.data['last_assignment_date'] = (models.Assignment
            .filter(student=bundle.data['id'])
            .order_by('assignment_date')[0].assignment_date) 
```

这并不理想，因为它将为每个学生记录执行单独的数据库往返。它也不是很具有声明性，也不是优雅的。

那么，有没有一种很好的方法可以通过 Tastypie 获得这种功能？还是有更好的方法来做我想要实现的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T16:43:48.697

您可以按字段名称对 ModelResource 进行排序。查看文档的这一部分[http://django-tastypie.readthedocs.org/en/latest/resources.html#ordering](http://django-tastypie.readthedocs.org/en/latest/resources.html#ordering)

您还可以在模型中默认设置此排序：[https ://docs.djangoproject.com/en/dev/ref/models/options/#ordering](https://docs.djangoproject.com/en/dev/ref/models/options/#ordering)**

# php - 通过 css 和 html 随机加载壁纸

> ID：14048532
> 
> 赞同：0
> 
> 时间：2012-12-27T02:03:24.527
> 
> 标签：php, html, css, image, random

我是 css 和 html 甚至编码的新手。我目前正在使用本地路径制作自己的起始页，它将我的书签加载到 html 文件中。背景图像控件通过`style.css`文件。我已经搜索了一些解决方案来创建一个 php 脚本以通过 css 和 html 加载随机图片，并且我尝试了各种解决方案，但它似乎对我不起作用。所以我们开始：

用于传递背景图像的 index.html 文件：

```
<link rel="stylesheet" href="style.css" type="text/css" /> 
```

和 style.css：

```
body {
background-image: url("Wallpaper01.jpg") ; 
```

}

自从下载了代码，我不知道如何更改它。.jpg 文件也与 html 和 css 位于同一目录中。

有人可以帮我制作一张随机图片吗？请提供执行此操作的代码、插入位置或我需要的任何内容，这将比告诉我要做什么更有帮助。

非常感谢，如果有人可以帮助我。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T02:08:53.007

您可以尝试以下方法：

```
<?php
  $bg = array('bg-01.jpg', 'bg-02.jpg', 'bg-03.jpg', 'bg-04.jpg', 'bg-05.jpg', 'bg-06.jpg', 'bg-07.jpg' ); // array of filenames

  $i = rand(0, count($bg)-1); // generate random number size of the array
  $selectedBg = "$bg[$i]"; // set variable equal to which random filename was chosen
?> 
```

**CSS（在头部）**

```
<html>
        <head>
            <title></title>
            <style type="text/css">
                <!--
                body{
                background: url(images/<?php echo $selectedBg; ?>) no-repeat;
                }
                -->
            </style>
        </head>
        <body>
             <!-- website -->
        </body>
    </html> 
```

**编辑（用户评论）**

```
<?php
          $bg = array('bg-01.jpg', 'bg-02.jpg', 'bg-03.jpg', 'bg-04.jpg', 'bg-05.jpg', 'bg-06.jpg', 'bg-07.jpg' ); // array of filenames

          $i = rand(0, count($bg)-1); // generate random number size of the array
          $selectedBg = "$bg[$i]"; // set variable equal to which random filename was chosen
?>

        <html lang="en"> 
            <head> 
                <meta charset=utf-8> 
                <link rel="stylesheet" href="style.css" type="text/css" /> 
                <title>Start Page</title> 
                <style type="text/css">
                        <!--
                        body{
                        background: url(images/<?php echo $selectedBg; ?>) no-repeat;
                        }
                        -->
                </style>
            </head>
            <body> 
                <div id="one">01 <div class="title">General</div> 
                <div class="links"> <a href="google.com">Google </a> 

                </div> 
            </div>
            </body>
        </html> 
```

# php - 将文件夹附加到 curPageURL

> ID：14048537
> 
> 赞同：0
> 
> 时间：2012-12-27T02:04:55.433
> 
> 标签：php

我正在使用 php 来抓取和回显 curPageURL

```
<?php echo curPageURL(); ?> 
```

这给了我类似的东西：http: [//mywebsite.com/folder/](http://mywebsite.com/folder/)

这很棒，但我还想添加另一个 href ，重定向到： http: [//mywebsite.com/folder/thankyou/](http://mywebsite.com/folder/thankyou/)

但我想将 /thankyou/ 附加到 curPageURL

就像：curPageURL/thankyou/

那有意义吗 ？

它用于 fb feed api，并希望使用我的代码添加一个 redirect_uri（我一切正常），而不是 /thankyou/ 位......</p>

只是想知道我是否可以将目录附加到 CurPageURL 的末尾

（我真的不想使用显式网址）

斯特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:10:36.637

我想我修好了（只是没想到）

```
$thisurl = curPageURL();
$thanks = "thanks/";
$thaturl = $thisurl . $thanks; 
```

# macos - 如何在 NSSearchField 上添加阴影

> ID：14048539
> 
> 赞同：0
> 
> 时间：2012-12-27T02:05:05.147
> 
> 标签：macos, shadow, nssearchfield

我想覆盖 NSSearchField 类并让它看起来像 ![在此处输入图像描述](../Images/380400c699e2263e99e57181b1090554.png)

我查看了Apple的Document，发现NSSearchField继承自NSTextField，继承自NSControl，而NSControl本身继承自NSView。

因此，NSTextField 可以对应于 setShadow: 方法，但是，我尝试在 NSSearchField 实例上设置一个 NSShadow，但实际上什么也没发生。

谁能告诉如何获得阴影效果？谢谢~

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T06:49:35.467

## NSTextField 与 NSShadow

```
// Modify theTextField so that its NSShadow will be visible.
theTextField.wantsLayer = YES ;
theTextField.bezeled = NO ;
theTextField.drawsBackground = NO ;

NSShadow* redShadow = [NSShadow new] ;
redShadow.shadowOffset = NSMakeSize(2, 2) ;
redShadow.shadowColor = [NSColor redColor] ;
theTextField.shadow = redShadow ; 
```

这导致： ![灰色文字，红色阴影](../Images/2df8f9392770b01fc7391329bdc029a1.png)

根据我使用 NSShadows 和 NSTextFields/NSSearchFields 的经验，除非 NSTextField 没有被挡板并且没有绘制其背景，并且闪烁的光标与其前面的文本一起被遮蔽，否则阴影不会出现。

*编辑：*

## 子类 NSSearchField，覆盖`drawRect:`

```
- (void) drawRect:(NSRect)dirtyRect {
    NSShadow* redShadow = [NSShadow new] ;
    redShadow.shadowOffset = NSMakeSize(2, -2) ;
    redShadow.shadowColor = [NSColor redColor] ;

    [NSGraphicsContext saveGraphicsState] ;
    self.wantsLayer = YES ;     // or NO
    [redShadow set] ;
    [super drawRect:dirtyRect] ;
    [NSGraphicsContext restoreGraphicsState] ;
} 
```

结果是： ![想要层 = YES](../Images/5265448fda7e204838212e84fb1872d1.png) ![想要层 = 否](../Images/71e705ad19c2927a75f6908b5e1cb37d.png)。我假设您不希望放大镜图标或 X 按钮有阴影，因此您可以：

## 在原来的后面添加第二个 NSSearchField

这在 Interface Builder 中可能更容易做到，但这里的代码可以在 NSSearchField 子类中完成此操作。

```
- (void) awakeFromNib {
    [super awakeFromNib] ;

    NSSearchField* shadowSearchField = [NSSearchField new] ;
    [self.superview addSubview:shadowSearchField  positioned:NSWindowBelow  relativeTo:self ] ;
    shadowSearchField.translatesAutoresizingMaskIntoConstraints = NO ;
    shadowSearchField.editable = NO ;

    float horizontalOffset = -2 ;
    float verticalOffset   = -2 ;
    [self.superview addConstraint: [NSLayoutConstraint constraintWithItem:self  attribute:NSLayoutAttributeLeading  relatedBy:NSLayoutRelationEqual  toItem:shadowSearchField  attribute:NSLayoutAttributeLeading  multiplier:1  constant:horizontalOffset ] ] ;
    [self.superview addConstraint: [NSLayoutConstraint constraintWithItem:self  attribute:NSLayoutAttributeTop      relatedBy:NSLayoutRelationEqual  toItem:shadowSearchField  attribute:NSLayoutAttributeTop      multiplier:1  constant:verticalOffset ] ] ;
    [self.superview addConstraint: [NSLayoutConstraint constraintWithItem:self  attribute:NSLayoutAttributeWidth    relatedBy:NSLayoutRelationEqual  toItem:shadowSearchField  attribute:NSLayoutAttributeWidth    multiplier:1  constant:0 ] ] ;
    [self.superview addConstraint: [NSLayoutConstraint constraintWithItem:self  attribute:NSLayoutAttributeHeight   relatedBy:NSLayoutRelationEqual  toItem:shadowSearchField  attribute:NSLayoutAttributeHeight   multiplier:1  constant:0 ] ] ;
} 
```

如果您可以调整第二个 NSSearchField 的位置和颜色，这会导致： ![带对焦环](../Images/22a093002e8d220c9ac23f05432afdc7.png) 和 ![无对焦环](../Images/aa054d57aa2f042e68e9df2a3c27f4bb.png)，这似乎最接近您想要的。

# linq - 在 crm 2011 组织导入错误之后

> ID：14048541
> 
> 赞同：1
> 
> 时间：2012-12-27T02:05:23.370
> 
> 标签：linq, import, dynamics-crm-2011, organization

我有一个部署在 IFD CRM 上的组织。我的目标是将该组织导入具有 CRM 2011 且没有 IFD 的新农场。导入时一切正常，但导入后我无法在新服务器上打开该组织。错误详细信息是：

事件代码：3007
事件消息：发生编译错误。
事件时间：27.12.2012 03:32:20
事件时间 (UTC)：27.12.2012 01:32:20
事件 ID：658277a3edea44089ca9af6e0c31f6c4
事件序列：236
事件发生：5
事件详细代码：0
异常消息：c:\Windows\ Microsoft.NET\Framework64\v4.0.30319\Config\web.config(389)：
错误 CS0234：命名空间“System”中不存在类型或命名空间名称“Linq”（您是否缺少程序集引用？）

在那个错误之后，我创建了新的组织，这个新组织没有问题。

CRM 带有更新汇总 8。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T18:51:08.247

您的某些解决方案中可能包含插件。它可能配置为使用与您以前的服务器的连接。因此，当您导入它时会遇到一些错误。这只是一个猜测！如果您提供有关错误消息的更多信息，则可以更好地对其进行分析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T14:39:39.447

打开 crm 服务器端跟踪。您将获得更好的错误信息。使用 CRM 诊断工具打开跟踪日志记录：[http](http://crmdiagtool2011.codeplex.com) ://crmdiagtool2011.codeplex.com 。

我想知道你是否有一些与组织相关的插件。因此，当您尝试访问它时，插件会触发并抛出该异常。

# php - 重定向后回显消息？

> ID：14048543
> 
> 赞同：0
> 
> 时间：2012-12-27T02:05:39.990
> 
> 标签：php, redirect, echo

我在用户个人资料上有一个按钮，允许其他用户将用户添加到他们的收藏夹中。单击此按钮后，它们将链接到 sql 进程文件 favorite.php。

一旦 sql 脚本运行，它将用户链接回原始配置文件页面，即 profile.php。

现在我想做的是找出在 sql 完成后如何在页面 profile.php 上回显一条消息。我已经尝试了以下但没有任何反应。

有人可以告诉我我需要做什么才能让它工作吗？谢谢你

最喜欢的.php：

```
<?php

require_once('includes/session.php');
require_once('includes/functions.php');
require('includes/_config/connection.php');

session_start();

    confirm_logged_in();

    if (isset ($_GET['to'])) {
    $user_to_id = $_GET['to'];

}

if (!isset($_GET['to']))
    exit('No user specified.');

$user_id = $_GET['to'];

$result = mysql_query("INSERT INTO ptb_favorites (user_id, favorite_id) VALUES (".$_SESSION['user_id'].", ".$user_to_id.")") 
or die(mysql_error()); 

header("Location: profile.php?id=" . $user_to_id['user_id'] . "added=1");

?> 
```

配置文件.php：

```
<?
if (isset($_GET['added']) && $_GET['added'] == 1) {
            $message = "<div class=\"infobox\">This user was successfully added to your favorites.</div>"; ?>

            <? } ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:09:00.987

您的重定向 URL 将如下所示：

```
 profile.php?id=123456added=1
 #                   ^ 
```

注意参数中的缺失`&`。调整您的`header()`呼叫并将其包含在`"added=1"`concat 之前。

```
 header("Location: profile.php?id=" . $user_to_id['user_id'] . "&added=1");
 #                                                              ^ 
```

在相关说明中，如果不是这样，您会更早发现`isset`：

```
 if (isset($_GET['added']) && $_GET['added'] == 1) { 
```

将其保留，因为这是必需的参数，并且您*希望在此类情况下获得注释*。相反，只需在您的生产服务器上打开通知/警告。

# mysql - 带有两个表的 Mysql UPDATE 查询

> ID：14048545
> 
> 赞同：0
> 
> 时间：2012-12-27T02:06:49.287
> 
> 标签：mysql

我想运行这个查询：

`UPDATE up SET up.pts = uc.checkin_worth WHERE uc.email = up.email AND uc.company_id = up.company_id AND uc.email = 'test@gmail.com' AND uc.company_id = '4' AND uc.qrcode = 'j'`

但是，我收到一个错误，因为我不知道如何在 UPDATE 查询中组合两个表（uc 和 up）。

谁能帮我解决这个问题？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:09:53.700

只需使用正常的 JOIN 语法：

```
UPDATE up JOIN uc ON uc.email = up.email AND uc.company_id = up.company_id
SET up.pts = uc.checkin_worth
WHERE uc.email = 'test@gmail.com' AND uc.company_id = '4' AND uc.qrcode = 'j' 
```

您还可以使用旧的逗号语法，它更类似于您的原始查询：

```
UPDATE uc, up
SET up.pts = uc.checkin_worth
WHERE uc.email = up.email
AND uc.company_id = up.company_id
AND uc.email = 'test@gmail.com'
AND uc.company_id = '4'
AND uc.qrcode = 'j' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T02:10:12.603

试试这个：

```
UPDATE up, uc 
SET up.pts = uc.checkin_worth, 
WHERE uc.email = up.email AND uc.company_id = up.company_id AND uc.email = 'test@gmail.com' AND uc.company_id = '4' AND uc.qrcode = 'j' 
```

# c# - 线程持有串行端口人质

> ID：14048546
> 
> 赞同：0
> 
> 时间：2012-12-27T02:06:59.920
> 
> 标签：c#, multithreading, serial-port, conflict

> 新更新：我们只是对外部盒子做了一些摆弄，让他可以接收，但不能发送。当外接盒无声，并且有问题的串行端口没有接收数据时，这里描述的问题就消失了；即，只要我们没有收到，我们就可以发送。那么，这是我应该处理的错误、功能还是“已知问题”？

在这个问题上将（非常）欢迎建议和指导。我的问题在三句话中是...

*   我可以从串口发送一组字节。

*   串口开始接收，一直在接收。

*   我无法发送另一组字节。

我得到一个似乎没有响应的系统。我告诉 Visual Studio 2010 打破一切。我的代码总是与指向它的弯曲绿色箭头对齐。我将鼠标悬停在它上面，然后我看到了类似这样的内容...

> 无法计算表达式，因为当前线程处于睡眠、等待或加入状态

如果有哪位高手能够将这种复杂性化为更简单的英文解释，这样的人会成为我很长一段时间的朋友。

这是停滞不前的方法......

```
 public static void Tell_Box_To_Stop_Sending()
        {
            int Length;
            int StartingPosition;
            byte[] TheBytesToSend;

            Length = TheseBytesAreThe.Command_06_Stop_Data_Flood.Length;
            StartingPosition = 0;
            TheBytesToSend = TheseBytesAreThe.Command_06_Stop_Data_Flood;

            OurSpecificPorts.TheActivePortWeAreUsing.Write(TheBytesToSend, StartingPosition, Length);   ////// The green arrow is on this line

        } 
```

这是用于打开端口的类。我应该把开放端口从这堂课中拿出来吗？

```
/**********************************************************************************
 * Class Name:          UART
 * 
 * Constructor:         Takes the string name, stores it, and does nothing else
 * 
 * Methods:             -- Open_TheActivePortWeWillUse --
 *                      
 **************************************************************************************/

class UART
{
    public SerialPort OurMainActiveSerialPort;                  

    public byte[] The_Immediate_Rx_Buffer;
    String The_Name_Of_The_Serial_Port;

    public UART(String ThePortNameTheCallerGaveUs)
    {
        The_Name_Of_The_Serial_Port = ThePortNameTheCallerGaveUs;
    }

    public static void send_command(byte[] The_Byte_Array, int Starting_Place, int Length)
    {
        ///OurMainActiveSerialPort.Write(The_Byte_Array, Starting_Place, Length);
        OurSpecificPorts.TheActivePortWeAreUsing.Write(The_Byte_Array, Starting_Place, Length);
    }

    /*****************************************************************
     * Method:      Open_TheActivePortWeWillUse
     * 
     * On Entry:    Caller gives us a name, in a string. C# and 
     *              Windows almost probably always use a format
     *              like "COM1" or "COM37" or some such scheme.
     *              
     *              Class:  OurSpecificPorts
     *              Item:   .TheActivePortWeAreUsing
     *              Has been defined as a serial port in the RegularVariables.cs file
     * 
     * 
     * Actions:     That serial port will be opened
     *              
     * 
     * On Exit:     The port will be connected, doing 8-N-1.
     * 
     *              
     *              We will store the port in a variable that's
     *              widely available to just about everybody.
     *              
     *              It will be in the class: OurSpecificPorts
     *              
     *              Its name will be: TheActivePortWeAreUsing 
     * 
     *              Another method, in this class, will take on
     *              the Event Handler which will respond to new
     *              bytes in the buffer.  (Don't be misled, this
     *              is not the UART FIFO buffer that you may be 
     *              thinking; but a buffer that Windows and C#
     *              arrange for us.)
     *              
     *              The name of that method will be...
     *              
     *              OurBackGroundSerialPortReceiver
     *              
     * 
     * Be Aware:    If this is a bluetooth connection, we get
     *              921600 bps irrespective of what we
     *              say we want for speed.
     * 
     * 
     *****************************************************************/
    public static void Open_TheActivePortWeWillUse(String Drone_StringNameFromUser)

                                                                                                    // First, open the port

        SerialPort TempSerialPort = new SerialPort (Drone_StringNameFromUser, int) SerialPortParameter.TheSerialPortSpeed);

        OurSpecificPorts.TheActivePortWeAreUsing = TempSerialPort;                                  // Now we have a name that anybody can see and use
        OurSpecificPorts.TheActivePortWeAreUsing.DataBits = 8;                                      
        OurSpecificPorts.TheActivePortWeAreUsing.Parity = Parity.None;                              
        OurSpecificPorts.TheActivePortWeAreUsing.StopBits = StopBits.One;                           

        OurSpecificPorts.TheActivePortWeAreUsing.DataReceived += new SerialDataReceivedEventHandler(OurBackGroundSerialPortReceiver);

        OurSpecificPorts.TheActivePortWeAreUsing.Open();                                            
    }

    /*************************************************************************************************
     * Method Name:         OurBackGroundSerialPortReceiver
     * 
     * Called By:           Windows internal things
     * 
     * Root Cause:          The UART generates an event
     * 
     * On Entry:            There is hopefully some data in the Uart's buffer
     * 
     *                      Windows and C# will set up two calling arguments
     *                      -- object sender
     *                      -- SerialDataReceivedEventArgs e 
     * 
     * Actions:             This method sets flags and semaphores to alert other parts of our code
     *                      of what we are doing, then it moves data out of the latest buffer that
     *                      the serial port provides, into another buffer. We'll use a trailer and
     *                      header scheme, much like our own box uses its interrupt handler with a
     *                      background/foreground scheme.
     *                      
     * On Exit:             Whatever was in the buffer is moved to the trailer/leader buffer which
     *                      other parts of the code will take and use
     *                      
     * Other References:    http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived
     * 
     *                      http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.aspx
     *                      
     *                      http://msdn.microsoft.com/en-us/library/ms143549.aspx
     * 
     *                      Microsoft actually has example code there which makes sense.
     * 
     * 
     * ***********************************************************************************************/

    public static void OurBackGroundSerialPortReceiver(object sender, SerialDataReceivedEventArgs e )
    {
        SerialPort CurrentPort = (SerialPort)sender;            // Int routine gave is this in the arguments

        int LastByteInUartBuffer = CurrentPort.ReadBufferSize;
        int TheNumberOfBytes = CurrentPort.BytesToRead;
        byte[] inputData = new byte[TheNumberOfBytes];
        int WeGotThisMany = CurrentPort.Read(inputData, 0, TheNumberOfBytes);                

        int Dest;
        Dest = UartPlaceHolders.RxBufferLeader;                 // Will index into buffer for Chief dispatch

        int Source;                                             // Will index into Uart buffer to fish it out
        Source = 0;                                             // therefore, we start at zero

        int TopEdge;                                            // We'll calculate this here once instead of in the loops below
        TopEdge = (int)TheSizeOf.OneSecondsWorthOfData;         // This will tell us when to wrap around

        if (Dest < UartPlaceHolders.RxBufferTrailer)             // Half the time we'll have wrap-around
        {                                                        // If that's the case, then the trailer > the leader
            while (
                  (Dest < UartPlaceHolders.RxBufferTrailer)      // If we are wrapped, make sure we don't
                   &&                                            // overtake either the trailer or
                   (Dest < TopEdge)                              // go over the top edge
                   &&                                            // At the same time, make sure that
                   (Source <= LastByteInUartBuffer)              // we don't fish out more than is there
                   )
            {                                                    // Move bytes into buff for chief
                UartData.TheImmediateSecondOfData[Dest] = inputData[Source];
                Dest = Dest + 1;
                Source = Source + 1;                             
            }

            if (Source >= LastByteInUartBuffer)                 // Have we done all the bytes for this event ?            
            {                                                   // Yes, therefore we will update the leader
                UartPlaceHolders.RxBufferLeader = Dest;         // This tells us where to start next time

                aUartSemaphoreThatTells.WhatTheUartBackgroundRxIsDoing = (int)aValueWhichIndicatesThat.WeHaveReceivedSomeData;

                return;                                         // and we are done
            }
                                                                // //   Else no, more bytes so...
            else if (Dest >= TopEdge)                           // Did we wrap around ?
            {                                                   // Yes, so
                Dest = 0;                                       // wrap around to the start
                while (                                         // Now we do the same thing again
                      Dest < UartPlaceHolders.RxBufferTrailer   // C# and windows keep buffers at 4K max, 
                      &&                                        // so we will wrap only once
                      Source < LastByteInUartBuffer             // May not even need that other test
                      )                                         // This will finish the rest of the bytes
                {
                    UartData.TheImmediateSecondOfData[Dest] = inputData[Source];      // There they go
                    Dest = Dest + 1;
                    Source = Source + 1;
                }

                UartPlaceHolders.RxBufferLeader = Dest;         // This tells us where to start next time
                return;
            }

            else                                             // Dest is neither <, >, nor =, we have logic error
            {
                ErrorFlags.SerialPortErrorDescription = (int)AnError.ExistsInTheSerialPortBufferPointers;
                return;
            }

        }

                                                                 // We now take this case when the leader is up
                                                                 // ahead of, or equal to, the trailer. In that
                                                                 // case, we change the while loop to check for
                                                                 // the leader overtaking the top edge, but not
                                                                 // the trailer. Since the buffer will be about
                                                                 // 4x the size of what we get from the Uart it
                                                                 // is approximately guaranteed not to overtake
                                                                 // the trailer; do the arithmetic and you will
                                                                 // probably agree.
                                                                 // I am purposely using to large, similar, but
                                                                 // not completely identical schemes instead of
                                                                 // another "else" appended to the previous bag
                                                                 // of code. This will greatly improve debug.

        if (Dest >= UartPlaceHolders.RxBufferTrailer)            // Now, if the Trailer is ahead of the leader, here we go
        {                                                        
            while (
                   (Dest < TopEdge)                              // We still want to stop before we hit the top edge
                   &&                                            // At the same time, make sure that we don't go past...
                   (Source < LastByteInUartBuffer)               // ... the end of the Uart buffer
                   &&                                            // Nor do we want to go past...
                   (Source < TheNumberOfBytes)                   // ...the last byte the Uart gave us
                   )
            {
                UartData.TheImmediateSecondOfData[Dest] = inputData[Source];      // Move bytes into buff for chief
                Dest = Dest + 1;
                Source = Source + 1;
            }

            if (Source >= LastByteInUartBuffer)                  // Have we done all the bytes for this event ?
            {                                                    // Yes, therefore we will update the leader
                UartPlaceHolders.RxBufferLeader = Dest;          // This tells us where to start next time

                aUartSemaphoreThatTells.WhatTheUartBackgroundRxIsDoing = (int)aValueWhichIndicatesThat.WeHaveReceivedSomeData;

                return;                                          // and we are done
            }                                                    // //   Else no, we have more bytes to move, so...

            else if (Dest >= TopEdge)                            // Did we wrap around ?
            {                                                    // Yes, so...
                Dest = 0;                                        // wrap around to the start
                while (                                          // Now we do the same thing again
                      Dest < UartPlaceHolders.RxBufferTrailer    // C# and windows keep buffers at 4K max, 
                      &&                                         // so we will wrap only once
                      Source < LastByteInUartBuffer
                      )
                {
                    UartData.TheImmediateSecondOfData[Dest] = inputData[Source];
                    Dest = Dest + 1;
                    Source = Source + 1;
                }

                UartPlaceHolders.RxBufferLeader = Dest;          // This tells us where to start next time

                aUartSemaphoreThatTells.WhatTheUartBackgroundRxIsDoing = (int)aValueWhichIndicatesThat.WeHaveReceivedSomeData;

                return;
            }

            else                                                 // Dest is neither <, >, nor =, we have logic error, so debug this
            {
                ErrorFlags.SerialPortErrorDescription = (int)AnError.ExistsInTheSerialPortBufferPointers;
                return;
            }

        }

    }

} 
```

我希望我没有包含太多代码。我在这里的前几个问题似乎总是导致人们要求查看更多代码。我想我已经在这里 2 周了，所以，感谢您理解我糟糕的协议。

# ios - 如何在 iOS 下动态加载字体。（真的）

> ID：14048549
> 
> 赞同：18
> 
> 时间：2012-12-27T02:07:25.493
> 
> 标签：ios, dynamic, fonts, truetype

我已经多次看到这个问题被问和回答过，但我还没有看到真正的答案。常见的“解决方案”是：

*   将字体添加到应用程序包中并将其注册到 info.plist 文件中。
*   使用自定义字体解析和渲染库（如 Zynga 的[FontLabel](https://github.com/zynga/FontLabel)）。
*   这是不可能的。

那么问题来了： iOS下**如何*动态*加载字体？** “动态”加载字体意味着加载在应用程序编译时未知的任何给定字体。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-27T02:07:25.493

可以轻松地从任何位置或任何字节流动态加载字体。请参阅此处的文章：http: [//www.marco.org/2012/12/21/ios-dynamic-font-loading](http://www.marco.org/2012/12/21/ios-dynamic-font-loading)

```
NSData *inData = /* your font-file data */;
CFErrorRef error;
CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)inData);
CGFontRef font = CGFontCreateWithDataProvider(provider);
if (! CTFontManagerRegisterGraphicsFont(font, &error)) {
    CFStringRef errorDescription = CFErrorCopyDescription(error)
    NSLog(@"Failed to load font: %@", errorDescription);
    CFRelease(errorDescription);
}
CFRelease(font);
CFRelease(provider); 
```

*   您不必将字体放入捆绑包中。
*   您不必在 info.plist 中显式注册字体。

另请参阅： [https ://developer.apple.com/library/mac/#documentation/Carbon/Reference/CoreText_FontManager_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008278](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/CoreText_FontManager_Ref/Reference/reference.html#//apple_ref/doc/uid/TP40008278)

[https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGFont/Reference/reference.html#//apple_ref/c/func/CGFontCreateWithDataProvider](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGFont/Reference/reference.html#//apple_ref/c/func/CGFontCreateWithDataProvider)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-27T04:01:46.930

Marco 最近发表了一篇题为[动态加载 iOS 字体](http://www.marco.org/2012/12/21/ios-dynamic-font-loading)的帖子的好时机。

```
NSData *inData = /* your decrypted font-file data */;
CFErrorRef error;
CGDataProviderRef provider = CGDataProviderCreateWithCFData((CFDataRef)inData);
CGFontRef font = CGFontCreateWithDataProvider(provider);
if (! CTFontManagerRegisterGraphicsFont(font, &error)) {
    CFStringRef errorDescription = CFErrorCopyDescription(error)
    NSLog(@"Failed to load font: %@", errorDescription);
    CFRelease(errorDescription);
}
CFRelease(font);
CFRelease(provider); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-07T06:49:34.050

```
// Note : add "CoreText.framework" into your project to support following code

// Put loadCustomFont function inside app delegate or any shared class to access any where in code...

    -(void)loadCustomFont:(NSMutableArray *)customFontFilePaths{

        for(NSString *fontFilePath in customFontFilePaths){

            if([[NSFileManager defaultManager] fileExistsAtPath:fontFilePath]){

                NSData *inData = [NSData dataWithContentsOfFile:fontFilePath];
                CFErrorRef error;
                CGDataProviderRef provider = CGDataProviderCreateWithCFData((__bridge CFDataRef)inData);
                CGFontRef font = CGFontCreateWithDataProvider(provider);
                // NSString *fontName = (__bridge NSString *)CGFontCopyFullName(font);
                if (!CTFontManagerRegisterGraphicsFont(font, &error)) {
                    CFStringRef errorDescription = CFErrorCopyDescription(error);
                    NSLog(@"Failed to load font: %@", errorDescription);
                    CFRelease(errorDescription);
                }
                CFRelease(font);
                CFRelease(provider);
            }
        }
    }

    // Use as follow inside your view controller...

    - (void)viewDidLoad
    {
        [super viewDidLoad];

        // pass all font files name into array which you want to load dynamically...
        NSMutableArray *customFontsPath = [[NSMutableArray alloc] init];
        NSArray *fontFileNameArray = [NSArray arrayWithObjects:@"elbow_v001.ttf",@"GothamRnd-MedItal.otf", nil];

        for(NSString *fontFileName in fontFileNameArray){

            NSString *fileName = [fontFileName stringByDeletingPathExtension];
            NSString *fileExtension = [fontFileName pathExtension];
            [customFontsPath addObject:[[NSBundle mainBundle] pathForResource:fileName ofType:fileExtension]];
        }

        AppDelegate *appDel = (AppDelegate *)[[UIApplication sharedApplication] delegate];
        // load custom font into memory...
        [appDel loadCustomFont:customFontsPath];

        // Use font as below
        [lblName setFont:[UIFont fontWithName:@"Elbow v100" size:15.0]];
        [lblName2 setFont:[UIFont fontWithName:@"Gotham Rounded" size:20.0]];
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-01-07T17:00:27.557

**从服务器下载 TTF 文件？**

如果您正在下载 TTF 文件，那么您可以执行以下操作以使用 iOS 字体管理器注册您的自定义字体，这段代码还负责 TTF 文件**更新**（字体更新）：

```
+(void)registerFontsAtPath:(NSString *)ttfFilePath
{
    NSFileManager * fileManager = [NSFileManager defaultManager];

    if ([fileManager fileExistsAtPath:ttfFilePath] == YES)
    {
        [UIFont familyNames];//This is here for a bug where font registration API hangs for forever.

        //In case of TTF file update : Fonts are already registered, first de-register them from Font Manager
        CFErrorRef cfDe_RegisterError;
       bool fontsDeregistered = CTFontManagerUnregisterFontsForURL((__bridge CFURLRef)[NSURL fileURLWithPath:ttfFilePath], kCTFontManagerScopeNone, &cfDe_RegisterError);

        //finally register the fonts with Font Manager,
        CFErrorRef cfRegisterError;
        bool fontsRegistered= CTFontManagerRegisterFontsForURL((__bridge CFURLRef)[NSURL fileURLWithPath:ttfFilePath], kCTFontManagerScopeNone, &cfRegisterError);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-09-04T13:32:03.750

这是 Swift 3 的 @mt81 的更新答案：

```
guard
    let path = "Path to some font file",
    let fontFile = NSData(contentsOfFile: path)
else {
    print "Font file not found?"
}

guard let provider = CGDataProvider(data: fontFile)
else {
    print "Failed to create DataProvider"
}

let font = CGFont(provider)
let error: UnsafeMutablePointer<Unmanaged<CFError>?>? = nil

guard CTFontManagerRegisterGraphicsFont(font, error) else {
    guard
        let unError = error?.pointee?.takeUnretainedValue(),
        let description = CFErrorCopyDescription(unError)
    else {
        print "Unknown error"
    }
    print description
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-30T11:48:43.287

这里是快速版本：

```
let inData: NSData = /* your font-file data */;
let error: UnsafeMutablePointer<Unmanaged<CFError>?> = nil
let provider = CGDataProviderCreateWithCFData(inData)
if let font = CGFontCreateWithDataProvider(provider) {
    if (!CTFontManagerRegisterGraphicsFont(font, error)) {
        if let unmanagedError = error.memory {
            let errorDescription = CFErrorCopyDescription(unmanagedError.takeUnretainedValue())
            NSLog("Failed to load font: \(errorDescription)");
        }
    }
} 
```

# security - 是 url 路径 '/#!' 特殊还是利用？

> ID：14048552
> 
> 赞同：5
> 
> 时间：2012-12-27T02:07:52.090
> 
> 标签：security, url, browser

我`/#!`在我的博客上定期收到请求的路径，我想知道为什么会这样（因为它与我博客上的任何 URL/资源都不匹配）。用户代理说它总是 IE7 浏览器请求这个但来自多个不同的 IP 地址。我正在尝试确定我是否可以忽略这一点，或者我是否需要对此做点什么。我特别想知道以下内容：

*   它是某些 Web 浏览器/Web 服务器的某种特殊 URL 吗？
*   它与特定的漏洞利用有关吗？

我可以忽略它吗？

如果它相关，则该站点托管在 Windows azure 中并在 MVC4 上运行。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-27T02:15:04.890

这是一个[散列 URL](https://stackoverflow.com/questions/3009380/whats-the-shebang-hashbang-in-facebook-and-new-twitter-urls-for)。它们被一些 AJAX Web 应用程序使用，例如 Facebook 和 Twitter。Google 对它们进行了一些[特殊处理](https://developers.google.com/webmasters/ajax-crawling/)，以使通常无法抓取的 AJAX 网站可以抓取。

但是，如果您的网站没有运行使用它们的应用程序，则您不应该看到它们。而且您绝对不应该在服务器端看到它们，因为重点是`#`URL 中 a后面的所有内容都是[片段标识符](http://en.wikipedia.org/wiki/Fragment_identifier)，并且应该在从服务器请求 URL 之前由用户代理剥离。

**编辑：**如果我不得不猜测是什么在请求这样的 URL，我会说它可能是一些错误的机器人。它显然是在假装 IE 的事实表明它可能没有任何好处。也许它是某种垃圾邮件机器人。无论如何，这样的请求很可能是无害的，您可以忽略它们。如果它让你感觉更好，你总是可以设置一个重写规则来明确拒绝它们，比如：

```
RewriteRule \x23 - [F] 
```

`#`这应该拒绝任何对包含403 Forbidden 错误字符的 URL 的请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T02:15:55.520

好吧，`#`是一个有效的锚点，仅表示“页面”。你也可以做一个'！' 锚，例如

```
<!-- some html here -->
<a href="#!">Click me!</a>
<!-- lots more html -->
<div id="!">
   Wooaaaah!
</div> 
```

所以我的猜测是你可以放心地忽略它......但这只是一个猜测;）

# c# - JsonSerializer - 序列化变量的静态类

> ID：14048554
> 
> 赞同：0
> 
> 时间：2012-12-27T02:08:00.643
> 
> 标签：c#, json, class, serialization, static

> **可能重复：**
> [序列化静态类？](https://stackoverflow.com/questions/1293496/serialize-a-static-class)

是否可以序列化类，例如：

```
public static class Foo
{
    public static int foo1 = 1;
    public static int foo2 = 2;
    public static string foo3 = "test";
} 
```

在 C# 中使用 JsonSerializer 转换为 JSON？

如果我使用：

```
 JsonWriter jw = new JsonTextWriter(streamWriter)
  JsonSerializer serializer = new JsonSerializer();
  serializer.Serialize(jw, Foo); 
```

出现错误： `error CS0118: 'Example.Foo' is a 'type' but is used like a 'variable'` 提前感谢您的任何回复。

@Update 序列化静态类是不可能的，但是你可以创建这个类的静态实例并序列化它。样本：

```
 public static FooClass Foo = new FooClass();
    [Serializable]
    public class FooClass : System.Runtime.Serialization.ISerializable
    {
        public FooClass()
        {

        }
        public static int foo1 = 1;
        public static int foo2 = 2;
        public static string foo3 = "test";

        public void GetObjectData(SerializationInfo info, StreamingContext context)
        {
            info.AddValue("static.foo1", FooClass.foo1, typeof(int));
            info.AddValue("static.foo2", FooClass.foo2, typeof(int));
            info.AddValue("static.foo3", FooClass.foo3, typeof(string));
        }

        public FooClass(SerializationInfo info, StreamingContext context)
        {
            FooClass.foo1 = info.GetInt32("static.foo1");
            FooClass.foo2 = info.GetInt32("static.foo2");
            FooClass.foo3 = info.GetString("static.foo3");
        }
    }
    ...
    serializer.Serialize(jw, Foo); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T16:40:04.613

或者，如果你不想实现所有的序列化垃圾，你可以只序列化一个匿名类型：

```
JsonWriter jw = new JsonTextWriter(streamWriter)
JsonSerializer serializer = new JsonSerializer();
serializer.Serialize(jw, 
    new {
        foo1 = Foo.foo1,
        foo2 = Foo.foo2,
        foo3 = Foo.foo3
    }); 
```

# java - 如何使用 ANTLR v3 构建日期/小时语法？

> ID：14048557
> 
> 赞同：0
> 
> 时间：2012-12-27T02:08:03.080
> 
> 标签：java, antlr, antlr3

我想使用 Antlr 解析一串法语日期。

我有三种类型的日期：

*   date_day：2004 年 10 月 3 日（小时/分钟为午夜）
*   date_time : 12h（日、月、年以当前日期完成）
*   date_complete：2004 年 10 月 3 日 12 小时。如你看到的`date_complete : date_day date_hour`

我要解析的文档只是一串`date_day`,`date_time`和`date_complete`（没有分隔符）。

这是我要解析的字符串的示例

```
3 Octobre 2005 12h 13h 5 Octobre 2004 3 Septembre 2005 11h
Expected : date_complete date_time date_day date_complete

12h
Expected : date_time

3 Octobre 2005 5 Octobre 2004 12h 13h 3 Septembre 2005 11h
Expected : date_day date_complete date_time date_complete

**// NEW REQUIREMENTS**

3 Octobre 2005
Expected : date_day 

3 Octobre 
Expected : date_day 

3 
Expected : date_day 
```

我尝试了很多东西，Antlr v3 总是说我的语法不明确：

```
warning(200): /meleo.dates/src/Grammar.g:25:48: 
Decision can match input such as "{FRI, MON..TUE, WED} TWO_DIGITS DECEMBER FOUR_DIGITS {FRI..HOURG, MON..WED}" using multiple alternatives: 1, 2
As a result, alternative(s) 2 were disabled for that input
 |---> date_day (date_day | date_complete | date_hour)+ 
```

写那个语法的正确方法是什么？

这是语法：

```
grammar MeleoDates;

options {
  language = Java;
}

@header {
  package meleo.data.dates ; 

  import rainstudios.meleo.crawler.data.Dates ;
  import rainstudios.meleo.crawler.data.EventDate ;
}

@lexer::header {
  package meleo.data.dates ;   

  import rainstudios.meleo.crawler.data.EventDate ;
 }

input           returns [Dates dates] 
                @init {Dates r = new Dates() ; } : 
                (   date 
                    {r.addDay($date.date);}
                    DATE_SEP?)+ 
                EOF
                    {$dates = r ;}
                ;

date            returns [EventDate date] :
                (date_complete)=> date_complete 
                    {$date = $date_complete.date;}
                | date_day 
                    {$date = $date_day.date;}
                | date_time 
                    {$date = $date_time.date;}
                ;

date_complete  returns  [EventDate date]   
                @init   {EventDateBuilder builder = new EventDateBuilder() ; } : 
                 day=date_day 
                    {builder.addDay($day.date);}
                 HOUR_SEP? 
                 time=date_time 
                    {builder.addTime($time.date);}
                    {$date = builder.toDate();}
                ;

date_day        returns [EventDate date] 
                @init   {EventDateBuilder builder = new EventDateBuilder() ; } :
                (
                dayOfWeek=( 
                     MON
                   | TUE
                   | WED
                   | THU
                   | FRI
                   | SAT
                   | SUN
                )?
                (day=INT)=> INT 
                    {builder.addDay($day.text);}
                (   m=ID 
                        {builder.addMonth($m.text);}
                    year=INT ?
                        {builder.addMonth($year.text);}
                )?
                )
                    {$date = builder.toDate();}
                ;

date_time       returns [EventDate date]  
                @init   {EventDateBuilder builder = new EventDateBuilder() ; } :
                    TIME 
                    {builder.addTime($TIME.text);}
                    {$date = builder.toDate();}
                ;

month   : DECEMBER | JANUARY ;

MON 
 : 'lundi'  
 | 'lun' 
 ;

 TUE 
 : 'mardi'  
 | 'mar' 
 ;

 WED 
 : 'mercredi'  
 | 'mer' 
 ;

 THU 
 : 'jeudi'  
 | 'jeu' 
 ;

 FRI 
 : 'venredi'  
 | 'ven' 
 ;

 SAT 
 : 'samedi'  
 | 'sam' 
 ;

 SUN 
 : 'dimanche'  
 | 'dim' 
 ;

DECEMBER    : 'dec' | 'decembre' ;
JANUARY     : 'jan' | 'janvier' ;

DATE_SEP    : 'et'| ',' | '-'; 
HOUR_SEP    : 'à' | 'a' ;
INT         : ('0'..'9')+;
TIME_SEP    : ':'  | 'h' ;
TIME        : INT TIME_SEP INT?;
ID          : ('a'..'z'|'A'..'Z')+;

WS : (' ' | '\t' | '\n' | '\r' | '\f')+ {$channel = HIDDEN;}; 
```

** 已编辑：添加了新要求（date_day 的可选月份和年份）**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T04:12:02.637

考虑使用句法谓词：

```
input      : date+;
date       : (date_complete) => date_complete
           | date_day
           | date_time
           ; 
```

实际上，这告诉 ANTLR 在尝试`date_complete`像往常一样匹配它找到的任何内容之前尝试 a （这可能不是技术上准确的描述，但你明白了）。没有这个，`date`规则可以匹配具有相同输入的多个选项，而 ANTLR（无论如何，v3）无法解决这个问题。

这是一个完整的测试语法：

```
grammar AmbiguousDates;

input           : date+ EOF;

date            : (date_complete)=> date_complete 
                    {System.out.println("date_complete: " + $date_complete.str);}
                | date_day 
                    {System.out.println("date_day: " + $date_day.str);}
                | date_time 
                    {System.out.println("date_time: " + $date_time.str);}
                ;

date_complete   returns [String str]
                : date_day date_time 
                    {$str = String.format("\%s \%s", $date_day.str, $date_time.str);}
                ;

date_day        returns [String str]
                : day=INT ID year=INT 
                    {$str = String.format("\%s \%s \%s", $day.text, $ID.text, $year.text);}
                ;

date_time       returns [String str]
                : TIME 
                    {$str = $TIME.text;}
                ;

INT     : ('0'..'9')+;
TIME    : INT 'h';
ID      : ('a'..'z'|'A'..'Z')+;
WS      : (' '|'\t'|'\f'|'\r'|'\n')+ {skip();}; 
```

### 输入

```
3 Octobre 2005 12h 13h 5 Octobre 2004 3 Septembre 2005 11h 
```

### 输出

```
date_complete: 3 Octobre 2005 12h
date_time: 13h
date_day: 5 Octobre 2004
date_complete: 3 Septembre 2005 11h 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:48:03.163

我不认为您通过使用 ANTLR 获得任何收益。您可以改为使用[SimpleDateFormat#parse](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html#parse%28java.lang.String,%20java.text.ParsePosition%29)以及一些额外的工作来检查尾随小时（即“h”）标记以实现您的目标，如下所示：

包装问题；

```
import java.text.ParseException;
import java.text.ParsePosition;
import java.text.SimpleDateFormat;
import java.util.Locale;

public class FrenchDateParser {
    private static SimpleDateFormat date_complete = new SimpleDateFormat("d MMMM yyyy h", Locale.FRENCH);

    private static SimpleDateFormat date_day = new SimpleDateFormat("d MMMM yyyy", Locale.FRENCH);

    private static SimpleDateFormat date_time = new SimpleDateFormat("h", Locale.FRENCH);

    private static String parse(String input) {
        ParsePosition parsePosition = new ParsePosition(0);
        StringBuilder stringBuilder = new StringBuilder();
        int inputSize = input.length();
        while (parsePosition.getIndex() < inputSize) {
            int startingParsePositionIndex = parsePosition.getIndex();

            if (date_complete.parse(input, parsePosition) != null) {
                if (input.charAt(parsePosition.getIndex()) == 'h') {
                    stringBuilder.append("date_complete ");
                    parsePosition.setIndex(parsePosition.getIndex() + 1);
                    continue;
                }
                parsePosition.setIndex(startingParsePositionIndex);
            }

            if (date_day.parse(input, parsePosition) != null) {
                stringBuilder.append("date_day ");
                continue;
            }

            if (date_time.parse(input, parsePosition) != null) {
                if (input.charAt(parsePosition.getIndex()) == 'h') {
                    stringBuilder.append("date_time ");
                    parsePosition.setIndex(parsePosition.getIndex() + 1);
                    continue;
                }
                parsePosition.setIndex(startingParsePositionIndex);
            }

            throw new IllegalArgumentException("Unable to parse input [" + input + "]");
        }
        return stringBuilder.toString().trim();
    }

    public static void main(String... args) throws ParseException {
        String[] inputs = {"3 Octobre 2005 12h 13h 5 Octobre 2004 3 Septembre 2005 11h", "12h",
                "3 Octobre 2005 5 Octobre 2004 12h 13h 3 Septembre 2005 11h"};

        String[] expecteds = {"date_complete date_time date_day date_complete", "date_time",
                "date_day date_complete date_time date_complete"};

        for (int i = 0; i < inputs.length; i++) {
            String actual = parse(inputs[i]);
            System.out.println(expecteds[i].equals(actual));
        }
    }
} 
```

# python - 使 SQLalchemy 将字符串存储为小写的正确方法是什么？

> ID：14048562
> 
> 赞同：5
> 
> 时间：2012-12-27T02:08:30.293
> 
> 标签：python, sqlite, sqlalchemy, case-insensitive

我正在使用 SQLAlchemy 与我的数据库通信。因为没有多少人会使用我的应用程序（至少最初是这样），我认为 SQLite 是最快/最简单的后端。

我有一个`User`，它有一个基于字符串的唯一 ID，例如`asdf@asdf.com`或`Mr. Fnord`。我不在乎 id 是什么格式 - 只是它是独一无二的。但是，我希望这是一个不区分大小写的唯一性。所以`Mr. Fnord`和`mr. fNoRd`将是等价的。

显然，`COLLATE`您可以使用架构上的设置，但是（至少使用 sqlite）它似乎并没有向前发展。我的解决方案是使用类上的属性在它上桌之前将所有内容小写，但这似乎很脆弱/hackish。

**属性是**处理小写所有内容的最佳方法，还是有更好的方法通过 SQLAlchemy/SQLite 使事物不区分大小写？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T02:53:34.377

我没有亲自尝试过，但也许您可以使用[自定义比较器运算符](http://docs.sqlalchemy.org/en/rel_0_7/orm/extensions/hybrid.html#building-custom-comparators)？IE

```
class CaseInsensitiveColumnComparator(ColumnProperty.Comparator):
    def __eq__(self, other):
        return func.lower(self.__clause_element__()) == func.lower(other) 
```

这样，您的 ID 可以在任何情况下存储，但会以小写形式进行比较。

* * *

另一个想法 -[增加](http://docs.sqlalchemy.org/en/rel_0_8/core/types.html#augmenting-existing-types) [sqlalchemy.types.Text](http://docs.sqlalchemy.org/en/rel_0_8/core/types.html#sqlalchemy.types.Text)，并将其用于您的 ID。

```
import sqlalchemy.types as types

class LowerCaseText(types.TypeDecorator):
    '''Converts strings to lower case on the way in.'''

    impl = types.Text

    def process_bind_param(self, value, dialect):
        return value.lower()

class User(Base):
    __tablename__ = 'user'
    id = Column(LowerCaseText, primary_key=True)
    ... 
```

# symfony - Symfony2 CRUD 多对多 - 对具有多个项目的列表框进行排序

> ID：14048563
> 
> 赞同：1
> 
> 时间：2012-12-27T02:08:30.607
> 
> 标签：symfony, many-to-many, crud, symfony-forms

这可能是一个基本问题，但我是 Symfony 的新手，目前一无所知。我有一个多对多关系，其中 2 个表由第三个链接，其中包含初始 2 个表的主键。

我使用 generate:doctrine:crud 生成了 CRUD。

当我在第一个表（表 1）中创建数据时，我有一个列表框，其中包含第二个表（表 2）中的许多条目。这确实是一个很大的列表，可以通过按 CTRL 来选择许多条目。巨大的列表真的很难，但它工作得很好。所有表格都被很好地填充。

我想按名称 ASC 对列表框进行排序，但到目前为止还没有找到一种方法。任何帮助将不胜感激。

代码完全由 Symfony2 生成。当它为第一个实体（表 1）创建实例时，在其构造方法中，它从表 2 中收集数据以显示列表框：

$this->table2id = new \Doctrine\Common\Collections\ArrayCollection();

这是我所理解的，但是如何选择这些数据以及如何对其进行排序？

干杯，埃里克

更新：

我在文档中发现 @ORM\OrderBy 可以解决问题，但它似乎对我不起作用。任何人都可以在此注释中发现错误？

```
`/**
 * @var \Doctrine\Common\Collections\Collection`
 *
 * @ORM\ManyToMany(targetEntity="Suburb", inversedBy="workerid")
 * @ORM\JoinTable(name="workersuburb",
 *   joinColumns={
 *     @ORM\JoinColumn(name="WorkerID", referencedColumnName="id")
 *   },
 *   inverseJoinColumns={
 *     @ORM\JoinColumn(name="SuburbID", referencedColumnName="id")
 *   }
 * )
 * @ORM\OrderBy({"SuburbID"="DESC"})
 */
private $suburbid;` 
```

# ant - 一个接一个地调用 Ant 任务

> ID：14048564
> 
> 赞同：0
> 
> 时间：2012-12-27T02:08:40.360
> 
> 标签：ant

一旦 RunTests 完成，我想调用 sendmail，但它不起作用

```
<project name="Sample usage of Salesforce Ant tasks" basedir="." xmlns:sf="antlib:com.salesforce" default="RunTests">
    <!--******************************************* P R O P E R T Y   F I L E *********************************************-->
    <property file="build.properties"/>
    <property environment="env"/>
    <!--*******************************************RunTests***********************************************************-->
    <target name="RunTests">
        <record name="RunTest.log" action="start"/>
            <sf:compileAndTest  username="${sf.backup_username}" password="${sf.backup_password}" serverurl="${sf.backup_serverurl}" >
                <runTests Alltests="true"/>
            </sf:compileAndTest>
        <record name="RunTest.log" action="stop"/>    
    </target>
    <target name="sendmail" depends="RunTests"> 
        <mail mailhost="email.corp.testcompany.com" mailport="25" subject="Run all tests - Sandbox 1337" messagefile="RunTest.log">
            <from address="user2@testcompany.com"/>
            <replyto address="user2@testcompany.com"/>
            <to address="user2@testcompany.com"/>
        </mail> 
    </target>       
</project> 
```

我得到以下失败 -

构建失败 C:\ANT_HOME\QA_1337_TestRunner\build.xml:8: 失败：

即使早期任务失败，有什么方法可以执行“sendemails”任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T02:26:22.700

尝试运行

```
ant sendmail 
```

或将默认值更改为 sendmail

```
<project name="Sample usage of Salesforce Ant tasks" basedir="." xmlns:sf="antlib:com.salesforce" default="sendmail"> 
```

并简单地执行

```
ant 
```

**编辑：**

在快速查看任务的[salesforce 文档](http://www.salesforce.com/us/developer/docs/apexcode/Content/sforce_api_calls_compileandtest.htm)`sf:compileAndTest`后，我没有找到任何有用的信息来说明如何在测试和/或编译失败时避免目标执行失败。（也许是[`checkonly`](http://www.salesforce.com/us/developer/docs/apexcode/Content/sforce_api_calls_compileandtest_request.htm)属性，但我不确定这是你需要的，也不确定你是否可以通过 ant 任务传递它）

所以我认为你必须在外部处理目标执行失败。为此，您可以使用[来自 ant-contrib 的 trycatch 任务。](http://ant-contrib.sourceforge.net/tasks/tasks/index.html)

它看起来像这样：

```
<trycatch property="foo" reference="bar">
  <try>
    <record name="RunTest.log" action="start"/>
        <sf:compileAndTest  username="${sf.backup_username}" password="${sf.backup_password}" serverurl="${sf.backup_serverurl}" >
            <runTests Alltests="true"/>
        </sf:compileAndTest>
    <record name="RunTest.log" action="stop"/>
  </try>

  <catch>
    <echo>Got error while running compileAndTest</echo>
  </catch>

  <finally>
    <mail mailhost="email.corp.testcompany.com" mailport="25" subject="Run all tests - Sandbox 1337" messagefile="RunTest.log">
        <from address="user2@testcompany.com"/>
        <replyto address="user2@testcompany.com"/>
        <to address="user2@testcompany.com"/>
    </mail>
  </finally>
</trycatch> 
```

请注意，您可以使用该`<catch>`部分在测试失败时发送特殊电子邮件。

`property`和`reference`可用于获取有关失败的信息（如果有）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T06:56:30.957

我认为您想研究`failureProperty`and`haltOnFailure`属性。

此线程答案中的更多信息： [https ://stackoverflow.com/a/134563/708777](https://stackoverflow.com/a/134563/708777)

# c++ - 使用 Qt5 在 Windows 上获取 HWND（来自 WId）

> ID：14048565
> 
> 赞同：34
> 
> 时间：2012-12-27T02:08:43.720
> 
> 标签：c++, windows, qt, user-interface, qt5

我正在尝试将 Qt4 应用程序转换为 Qt5。我唯一想不通的是如何获取小部件的*HWND*。该程序使用[EcWin7](https://code.google.com/p/dukto/downloads/detail?name=EcWin7-1.0.2.zip&can=2&q=)在 win 7+ 的任务栏图标上显示进度，但需要*HWND*。*在将Q_WS_WIN*更改为*Q_OS_WIN*后，lib 本身似乎可以正常编译）在 Windows 上的 Qt4 中，*WId*只是*HWND*的 typedef ，所以这没问题。在 Qt5 中，情况不再如此。我发现了一些可以提供线索的[邮件列表发布](http://comments.gmane.org/gmane.comp.lib.qt.user/4895)，但似乎*QPlatformNativeInterface*不再是 Qt5 的公共 API 的一部分。

程序调用*EcWin7.init(this->winId());* 我需要某种方式将此 ID 转换为*HWND* id 或其他方式来获取它。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-21T23:59:08.117

在 Qt5`winEvent`中被替换为`nativeEvent`：

```
bool winEvent(MSG* pMsg, long* result) 
```

就是现在

```
bool nativeEvent(const QByteArray & eventType, void * message, long *result) 
```

而且你必须`EcWin7::winEvent`投到：`void``MSG`

```
bool EcWin7::winEvent(void * message, long * result)
{
    MSG* msg = reinterpret_cast<MSG*>(message);
    if (msg->message == mTaskbarMessageId)
    {
      ... 
```

我能够让应用程序正常工作！只需更换：

```
 mWindowId = wid; 
```

和

```
 mWindowId = (HWND)wid; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-24T11:27:56.387

```
#include <QtGui/5.0.0/QtGui/qpa/qplatformnativeinterface.h>

static QWindow* windowForWidget(const QWidget* widget) 
{
    QWindow* window = widget->windowHandle();
    if (window)
        return window;
    const QWidget* nativeParent = widget->nativeParentWidget();
    if (nativeParent) 
        return nativeParent->windowHandle();
    return 0; 
}

HWND getHWNDForWidget(const QWidget* widget)
{
    QWindow* window = ::windowForWidget(widget);
    if (window && window->handle())
    {
        QPlatformNativeInterface* interface = QGuiApplication::platformNativeInterface();
        return static_cast<HWND>(interface->nativeResourceForWindow(QByteArrayLiteral("handle"), window));
    }
    return 0; 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-09T22:23:55.060

你可以试试：

```
(HWND)QWidget::winId(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-13T05:12:40.867

winId() 在 Qt 5.1 上为我工作，至少在我使用时它具有相同的值

```
bool Widget::nativeEvent(const QByteArray & eventType, void * message, long * result)
{
    MSG* msg = reinterpret_cast<MSG*>(message);
    qDebug() << msg->hwnd;

    return false;
} 
```

和

```
qDebug() << winId(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T09:33:54.103

试试这个功能：`QWindowsNativeInterface::nativeResourceForWindow`

# html - HTML 列表框未显示正确的选定选项

> ID：14048566
> 
> 赞同：0
> 
> 时间：2012-12-27T02:08:47.433
> 
> 标签：html, mysql

我有一个从表中选择颜色列表的查询。选择语句是`SELECT ColorDesc, ColorCode FROM Colors ORDER BY ColorCode`。

表中的数据样本为：

```
ColorDesc, ColorCode
Select Color -#0
Black -#000000
Navy -#000080
DarkBlue -#00008B
MediumBlue -#0000CD
Blue -#0000FF
DarkGreen -#006400... 
```

当列表返回时，列表框返回正确的选项，但是当它应该是“选择颜色”时，显示选项默认为“黑色”。

生成的 HTML（2012.12.26 更新）：

```
<label for="skinColorId">Select Skin Color</label>      
                                    <select id="skinColorId" name="skinColorId" title="Select Skin Color">
                                    <option value="#000000" selected="selected">Select Color</option><option value="#00FFFF">Aqua</option><option value="#7FFFD4">Aquamarine</option><option value="#F0FFFF">Azure</option><option value="#F5F5DC">Beige</option><option value="#FFE4C4">Bisque</option><option value="#000000" selected="selected">Black</option><option value="#FFEBCD">BlanchedAlmond</option><option value="#0000FF">Blue</option><option value="#8A2BE2">BlueViolet</option><option value="#A52A2A">Brown</option><option value="#DEB887">BurlyWood</option><option value="#5F9EA0">CadetBlue</option><option value="#7FFF00">Chartreuse</option><option 
```

JSP 代码（2012.12.26 更新）：

```
<li>
<form:label for="skinColorId" path="skinColorId">Select Skin Color</form:label>     
                                        <form:select path="skinColorId" id="skinColorId" title="Select Skin Color">
                                        <form:options items = "${skinColor.skinColorList}" itemValue="colorCode" itemLabel="colorDesc"/>
                                        </form:select>          
                                        <form:errors path="skinColorId" class="errors"/><label class="colorPreviewer" id="skinColorPreviewer">color previewer</label>
</li> 
```

更新 (2012/12/27)

当我将“选择颜色”设置为 #000000 并将“黑色”设置为 #000000 时，选择列表将黑色显示为所选值，而黑色则显示在列表中。但是，当我将“选择颜色”设置为 #FFFFFF 并将“黑色”设置为 #FFFFFF 时，这两个值都相同，默认值为“选择颜色”。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:25:33.747

您有两个正在使用的选定属性，因此第二个是选定的，而不是预期的“选择颜色”。`selected="selected"`从以下内容中删除并重试.. :)

```
<option value="#000000" selected="selected">Black</option> 
```

# html - 居中对齐水平导航栏的问题

> ID：14048567
> 
> 赞同：0
> 
> 时间：2012-12-27T02:08:52.303
> 
> 标签：html, css

我已经尝试了几件事来将导航栏作为一个整体移动，但我被卡住了。导航栏的容器需要根据导航栏的大小获取其大小。链接的数量会定期变化，所以我不能使用固定的宽度。

无论我在父标签中做什么，float: left 在 li 的 css 中都会将其保持在左侧。我已经尝试了很多事情，但我最终决定承认我只是在我的头上。

继承人的CSS：

```
#main {
    margin: 0px auto;
}

#nav_bar {
    height: 72px;
    width: auto;
    text-align:center;
}

#main_nav { list-style: none; margin: 0; padding: 0; display: inline;}
#main_nav li { float:left;}
#main_nav li a { text-indent: -999999px; overflow: hidden; display: block; height: 72px; } 

#home { background: url(NavBar/home.jpg); width: 105px; }
#home:hover { background: url(NavBar/home.jpg); 0 0 !important; }

#main_nav:hover li a#home { background-position: -232px center; }

#logo { background: url(NavBar/logo.jpg); width: 116px; }
#logo:hover { background: url(NavBar/logo.jpg); 0 0 !important; }

#main_nav:hover li a#logo { background-position: -232px center; }

#photo { background: url(NavBar/photo.jpg); width: 116px; }
#photo:hover { background: url(NavBar/photo.jpg); 0 0 !important; }

#main_nav:hover li a#photo { background-position: -232px center; }

#animation { background: url(NavBar/animation.jpg); width: 116px; }
#animation:hover { background: url(NavBar/animation.jpg); 0 0 !important; }

#main_nav:hover li a#animation { background-position: -232px center; }

#print { background: url(NavBar/print.jpg); width: 116px; }
#print:hover { background: url(NavBar/print.jpg); 0 0 !important; }

#main_nav:hover li a#print { background-position: -232px center; }

#other { background: url(NavBar/other.jpg); width: 116px; }
#other:hover { background: url(NavBar/other.jpg); 0 0 !important; }

#main_nav:hover li a#other { background-position: -232px center; } 
```

继承人的html：

```
<body>
<div id="main">
<div id="nav_bar">
<ul id="main_nav">
            <li><a href="" id="home">Home Page</a></li>
            <li><a href="" id="photo">Photos</a></li>
            <li><a href="" id="print">Print</a></li>
            <li><a href="" id="logo">Logos</a></li>
            <li><a href="" id="animations">3D</a></li>
            <li><a href="" id="other">Other</a></li>
        </ul> 
</div>
<div id="footer">Copyright</div>
</div>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:57:59.540

你去[http://jsfiddle.net/5PXEe/1/](http://jsfiddle.net/5PXEe/1/)

这将居中，`ul`并将很好地扩展新的菜单项

你需要`display: inline-block;`在你的 main_nav

# google-chrome - chrome控制台如何避免停止发生错误的位置

> ID：14048571
> 
> 赞同：0
> 
> 时间：2012-12-27T02:09:12.320
> 
> 标签：google-chrome

如果有一些错误包括一些错误，那么 chrome 调试器会在错误发生之前自动停止并等待用户的输入来检查语句。但是我想让这个设置无效。你知道如何避免这个设置吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T20:54:55.887

JavaScript 标准规定，一旦遇到未处理的异常，应用程序就应该停止执行。这意味着您的代码引发了一个未在 try(){...}catch(){} 块中**捕获的****错误。**将您的代码包装在 try-catch 块中以使其工作

 **例如：

```
function raiseError(){
  //...Error-raising code here
  throw new Error("Test Exception");
};

try{
  raiseError();
}
catch(e){
  console.log("Error caught", e);
} 
```**

# php - PHP邮件抄送只为回复所有

> ID：14048575
> 
> 赞同：0
> 
> 时间：2012-12-27T02:09:33.257
> 
> 标签：php, email

是否可以将 CC 添加到 PHP 电子邮件但不能将电子邮件发送到 CC。CC 仅适用于所有在收件人端的回复。我在想类似于回复和发件人属性的东西。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-27T02:23:08.547

听起来您想生成一封歪曲有关消息实际发送方式的电子邮件。不要撒谎。使用 Reply-To 标头（您的直觉是正确的），如[mail() 的 PHP 手册页上的](http://php.net/manual/en/function.mail.php "邮件的 PHP 手册页")示例 #2 。

**编辑1：**澄清 - 如果地址出现在抄送行，收件人将假定邮件的副本也已发送到那里。如果您的目标是创建一条看似已发送到实际上并未收到副本的地址的消息（这当然是可能的），那么您就是在歪曲消息传递。我建议你不要这样做。关于您想要做什么的问题中的更多细节可能会帮助我们理解？

**编辑 2：**这是一个示例，展示了如何建议邮件收件人的电子邮件客户端回复与收到原始邮件的地址不同的一组地址：

```
<?php
$to = 'you@example.com';
$subject = 'the subject';
$message = 'hello';
$replyList = array(
    'me@example.com',
    'him@acme.com',
    'her@ajax.com'
); 
$headers = array(
    'From: me@example.com',
    'Reply-To: ' . implode(',', $replyList)
);
mail($to, $subject, $message, implode("\r\n", $headers));
?> 
```

但是请注意，[RFC 2822](http://www.faqs.org/rfcs/rfc2822.html)中没有任何内容*要求*邮件客户端甚至支持不同的“回复”和“全部回复”操作，因此您无法准备电子邮件标题来精确控制“回复”的行为” 与“全部回复”。

特别是，没有标准的方法可以使“回复”仅将消息发送回发件人，而“全部回复”将消息发送回不是原始消息收件人的人员列表。这是你想要做的吗？

# r - 使用 R 将多个文件融合并合并到一个数据库中

> ID：14048577
> 
> 赞同：3
> 
> 时间：2012-12-27T02:09:43.853
> 
> 标签：r, merge, reshape2, melt

我一直在尝试导入几个 csv 文件，使用函数“melt”并将它们合并到 R 中的单个数据库中。所有文件都有一个“id”、“date.time”和“tag”列；但是，其余列因文件而异。这是一个文件中几行的示例：

> ```
>  date.time   tag 111015 111016 113949 113950
> 1 1 2012-10-11 00:00:00 14767      0      0      0      0
> 2 2 2012-10-11 01:00:00 14767      0      0      0      0
> 3 3 2012-10-11 02:00:00 14767      0      0      0      0
> 4 4 2012-10-11 03:00:00 14767      0      0      0      0
> 5 5 2012-10-11 04:00:00 14767      0      0      0      0
> 6 6 2012-10-11 05:00:00 14767      0      0      0      0
> 
> library(reshape2)
> 
> # Import files
> 
> files<-list.files()
> data<-lapply(files,read.csv,header=TRUE,sep=",",check.names=FALSE) 
> ```

我正在尝试使用此循环来融合每个文件并绑定生成的数据框。但是，它仅适用于循环中的最后一个文件。我不确切知道如何设置循环/函数，以便它可以首先执行每个文件的“融化”，然后将它们“合并/绑定”到单个数据帧中。

> ```
> for(j in 1:length(data)){
>    dm<-melt(data[[j]],measure.vars=c(4:length(data[[j]])),
>      id=c("date.time","tag"),variable.name="receiver")
> 
>    results<-rbind(dm)   
> 
>   } 
> ```

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T02:23:18.613

最好先`lapply`加载所有内容，然后`melt`按如下方式使用：（假设所有文件都在变量`files`中，

```
Note: Untested 
require(reshape2)
files <- list.files(my.dir, full.names = TRUE)
# first load all files
dd <- lapply(1:length(files), function(idx) {
    d <-read.csv(files[idx], header = TRUE, sep=",", check.names = FALSE)
    # if you want the file index
    d$file.idx <- idx
    d
})
# merge all
dd <- do.call(rbind, dd)
# now melt
dd.m <- melt(dd, c(4:length(d)), c("date.time","tag"), variable.name = "receiver") 
```

编辑：在 Op 的编辑之后

```
Note: Untested 
require(reshape2)
files <- list.files(my.dir, full.names = TRUE)
dd.m <- lapply(1:length(files), function(idx) {
    # load the file
    d <-read.csv(files[idx], header = TRUE, sep=",", check.names = FALSE)
    # now melt immediately
    d.m <- melt(d, c("date.time","tag"), c(4:length(d)))
})
# merge all
dd.m <- do.call(rbind, dd.m) 
```

# mongodb - 如何在 Meteor 中使用 Mongoose？

> ID：14048581
> 
> 赞同：6
> 
> 时间：2012-12-27T02:10:12.230
> 
> 标签：mongodb, orm, mongoose, meteor, odm

我查看了此处发布的答案：[Meteor：与 Mongoose 集成？](https://stackoverflow.com/questions/10106372/meteor-integration-with-mongoose)，但如果可能的话，我正在寻找一个更简单、更模块化的解决方案，以便将 Mongoose 与 Meteor.js 一起使用。

有没有更好的方法来处理我没有见过的 ODM 或原生支持？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-10-09T12:21:00.703

我决定只使用[Collection2](https://atmospherejs.com/aldeed/collection2)包，因为它似乎提供了我想要从 Mongoose 作为 ORM 获得的一切。这个包使用[简单模式](https://atmospherejs.com/aldeed/simple-schema)作为依赖。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-10T15:48:14.763

Meteor 已经与 mongodb 对话。但是你可以使用猫鼬。您可能会遇到反应性延迟 10 秒的问题。此外，您将无法在客户端上使用它。

Meteor 已经有了查询/更新等 mongodb 的方法。但是，如果需要，您可以强制猫鼬进入：

安装猫鼬（npm install mongoose）。并在你的流星代码中使用它：

```
 require = __meteor_bootstrap__.require; //to use npm require must be exposed.
 var mongoose = require('mongoose'); 
```

# java - 在 JBoss 中将 @EJB 注入到 Spring Bean 中

> ID：14048582
> 
> 赞同：1
> 
> 时间：2012-12-27T02:10:14.287
> 
> 标签：java, spring, jboss, ejb, jndi

我们有一个带有 @EJB 字段的 Spring 托管 bean

```
import org.springframework.security.web.authentication.logout.LogoutHandler;

public class MyLogoutHandler extends LogoutHandler {

    @EJB(name="MyService")
    private MyService myService;

    ...
} 
```

在我们的spring xml中，我们有

```
<beans:bean class="org.springframework.context.annotation.CommonAnnotationBeanPostProcessor">
    <beans:property name="alwaysUseJndiLookup" value="true" />
</beans:bean> 
```

这适用于 WebLogic 和 Glassfish，但不适用于 JBoss 7.1.2（参见 stacktrace @ [1]）。

挖掘 Spring 代码，似乎它将 JNDI 名称（即“MyService”）转换为 JBoss 似乎不支持的 Java EE 标准容器前缀“java:comp/env/”[2]。从 JBoss 日志来看，它似乎只支持以下内容：

```
java:global/my-ear/my-ejb/MyService!my,package.MyServiceLocal
java:app/my-ejb/MyService!my,package.MyServiceLocal
java:module/MyService!my,package.MyServiceLocal
java:global/my-ear/my-ejb/MyService
java:app/my-ejb/MyService
java:module/MyService 
```

但是，除了那些以“java:module”为前缀的会导致 javax.naming.NameNotFoundException 之外，这些似乎都有效。

现在我的问题是，有没有办法让我将我的 EJB bean 注入到我的 Spring Beans 中，这将 a.) 仍然允许相同的代码库在 WebLogic 和 Glassfish 中运行 b.) 最好，而不必重写每个 @ EJB 注入或不为将注入我的 spring bean 的每个 @EJB bean 指定一个 ref-bean？

[1]

```
08:20:18,697 ERROR [org.springframework.web.context.ContextLoader] (MSC service thread 1-6) Context initialization failed: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.filterChains': Cannot resolve reference to bean 'org.springframework.security.web.DefaultSecurityFilterChain#0' while setting bean property 'sourceList' with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.DefaultSecurityFilterChain#0': Cannot resolve reference to bean 'logoutFilter' while setting constructor argument with key [3]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'logoutFilter' defined in ServletContext resource [/WEB-INF/security-filter.xml]: Cannot resolve reference to bean 'myLogoutHandler' while setting constructor argument with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'myLogoutHandler': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'MyService' is defined: not found in JNDI environment
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyPropertyValues(AbstractAutowireCapableBeanFactory.java:1360) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1118) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:567) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:913) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:464) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:385) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:284) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111) [spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:3392) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:3850) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.web.deployment.WebDeploymentService.start(WebDeploymentService.java:90) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811)
    at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_32]
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_32]
    at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_32]
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.web.DefaultSecurityFilterChain#0': Cannot resolve reference to bean 'logoutFilter' while setting constructor argument with key [3]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'logoutFilter' defined in ServletContext resource [/WEB-INF/security-filter.xml]: Cannot resolve reference to bean 'myLogoutHandler' while setting constructor argument with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'myLogoutHandler': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'MyService' is defined: not found in JNDI environment
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:616) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:148) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
... 25 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'logoutFilter' defined in ServletContext resource [/WEB-INF/security-filter.xml]: Cannot resolve reference to bean 'myLogoutHandler' while setting constructor argument with key [0]; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'myLogoutHandler': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'MyService' is defined: not found in JNDI environment
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:328) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:106) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveManagedList(BeanDefinitionValueResolver.java:353) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:153) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:616) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:148) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1035) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:939) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:485) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
... 39 more
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'myLogoutHandler': Injection of resource dependencies failed; nested exception is org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'MyService' is defined: not found in JNDI environment
    at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessPropertyValues(CommonAnnotationBeanPostProcessor.java:306) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1106) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:517) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:322) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
... 53 more
Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'MyService' is defined: not found in JNDI environment
    at org.springframework.jndi.support.SimpleJndiBeanFactory.getBean(SimpleJndiBeanFactory.java:117) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.getResource(CommonAnnotationBeanPostProcessor.java:410) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor$EjbRefElement.getResourceToInject(CommonAnnotationBeanPostProcessor.java:698) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
    at org.springframework.beans.factory.annotation.InjectionMetadata$InjectedElement.inject(InjectionMetadata.java:150) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.beans.factory.annotation.InjectionMetadata.inject(InjectionMetadata.java:87) [spring-beans-3.1.0.RELEASE.jar:3.1.0.RELEASE]
    at org.springframework.context.annotation.CommonAnnotationBeanPostProcessor.postProcessPropertyValues(CommonAnnotationBeanPostProcessor.java:303) [spring-context-3.1.1.RELEASE.jar:3.1.1.RELEASE]
... 61 more 
```

[2] [http://grepcode.com/file/repo1.maven.org/maven2/org.springframework/spring-context/3.1.1.RELEASE/org/springframework/jndi/JndiLocatorSupport.java#JndiLocatorSupport.convertJndiName%28java .lang.String%29](http://grepcode.com/file/repo1.maven.org/maven2/org.springframework/spring-context/3.1.1.RELEASE/org/springframework/jndi/JndiLocatorSupport.java#JndiLocatorSupport.convertJndiName%28java.lang.String%29)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T23:23:18.173

出于某种奇怪的原因，它现在可以工作了。JBoss 现在可以查找我的服务 EJB。奇怪的是，我认为我做的唯一一件事就是让我的 JAXRS 类 @Stateless（来自 @RequestScoped）。尽管我没有对我的服务 bean 做任何更改，但修补 JAXRS 类似乎也使这些服务 EJB 对我的 Spring bean 可用。

编辑：对于那些寻找替代答案的人，在 jboss 中，java:module/env/ 似乎可以替代 java:comp/env/。

# javascript - 在javascript函数之间传递变量不起作用？

> ID：14048583
> 
> 赞同：2
> 
> 时间：2012-12-27T02:10:35.473
> 
> 标签：javascript, variables

我尝试使用此方法将变量传递给下一个函数：

```
function a(form, ctr) {
var a = form;
var b = ctr;
b(ctr);
} 

function b(ctr) {
var b = ctr;
} 
```

确切的代码要复杂得多，因为我正在使用带有 ajax 的 POST 方法：函数 a 在单击时开始并使用 form 和 ctr 参数 - 然后它转到只需要 ctr 的函数 b - 但是这种传递方法变量不起作用。有更好的解决方案吗？

```
function updateQuestion(form, ctr) { 
console.log("Called updateQuestion");
var str1 = "toggleDiv";
var str2 = ctr;
var id = str1.concat(str2);
var divVar = document.getElementById(id);
console.log(divVar);
  var getdate = new Date();  //Used to prevent caching during ajax call
  if(XMLHttpRequestObject) {
  console.log("XMLHttpRequestObject = TRUE");

var myVar = form.create_mcq_question.value;
  console.log("MyVar = " + myVar);
    var formQuestion = document.getElementById("formQuestion");
    console.log("1");
    XMLHttpRequestObject.open("POST","hiddent",true); 
        console.log("2");
    XMLHttpRequestObject.onreadystatechange  = handleServerResponse;
        console.log("3");
    XMLHttpRequestObject.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        console.log("4" + document.getElementById("create_mcq_question").value);

        var mcqid;
        var mcqQuestion;
        var mcqAnswerCorrect;
        var mcqAnswerWrong1;
        var mcqAnswerWrong2;
        var mcqAnswerWrong3;
        var mcqExplanation;

        var error = 0;

        if (form.create_mcq_question.value == "" || form.create_mcq_question.value == null  ) {
        error = 1;
        }
        else {
        mcqQuestion = form.create_mcq_question.value
        }
        if (form.create_mcq_answer_correct.value == "" || form.create_mcq_answer_correct.value == null) {
        mcqAnswerCorrect = "";
        error = 1;
        }
        else {
        mcqAnswerCorrect = form.create_mcq_answer_correct.value
        }
        if ((form.create_mcq_answer_wrong1.value == "" || form.create_mcq_answer_wrong1.value == null) && (form.create_mcq_answer_wrong2.value == "" || form.create_mcq_answer_wrong2.value == null) && (form.create_mcq_answer_wrong3.value == "" || form.create_mcq_answer_wrong3.value == null)) {
        error = 1;
        }

        if (form.create_mcq_answer_wrong1.value == "" || form.create_mcq_answer_wrong1.value == null) {
        mcqAnswerWrong1 = "";
        }
        else {
        mcqAnswerWrong1 = form.create_mcq_answer_wrong1.value
        }
                if (form.create_mcq_answer_wrong2.value == "" || form.create_mcq_answer_wrong2.value == null) {
        mcqAnswerWrong2 = "";
        }
        else {
        mcqAnswerWrong2 = form.create_mcq_answer_wrong2.value
        }
                if (form.create_mcq_answer_wrong3.value == "" || form.create_mcq_answer_wrong3.value == null) {
        mcqAnswerWrong3 = "";
        }
        else {
        mcqAnswerWrong3 = form.create_mcq_answer_wrong3.value
        }

                if (form.create_mcq_explanation.value == "" || form.create_mcq_explanation.value == null) {
        mcqExplanation = "";
        }
        else {
        mcqExplanation = form.create_mcq_explanation.value
        }
        if (error == 0) {
    XMLHttpRequestObject.send("create_mcq_question=" + mcqQuestion +
                              "&create_mcq_correct_answer=" + mcqAnswerCorrect + 
                              "&create_mcq_wrong_answer1=" + mcqAnswerWrong1 + 
                              "&create_mcq_answer_wrong2=" + mcqAnswerWrong2 + 
                              "&create_mcq_answer_wrong3=" + mcqAnswerWrong3 + 
                              "&create_mcq_explanation=" + mcqExplanation +
                              "&mcqid=" + mcqid ); 
                                console.log("5");
                                handleServerResponse(ctr);
                                }
                                else {
                                document.getElementById("divVar").innerHTML="Cannot update question - please ensure all required fields are filled!";
                                }
  }

}

function handleServerResponse(ctr) {
var str1 = "toggleDiv";
var str2 = ctr;
var id = str1.concat(str2);
var divVar = document.getElementById(id);
console.log("Handle server response called");
if (XMLHttpRequestObject.readyState == 1) {
console.log("Loading");
 document.getElementById(divVar).innerHTML="<img src=\"hidden">";
}

   if (XMLHttpRequestObject.readyState == 4) {
   console.log("4");
     if(XMLHttpRequestObject.status == 200) {
       document.getElementById(divVar).innerHTML=XMLHttpRequestObject.responseText; //Update the HTML Form element
       console.log("divVar found");
       console.log(divVar); 
     }
     else {
       document.getElementById(divVar).innerHTML="There was a problem updating your question - please try again!"; //Update the HTML Form element 
       console.log("divVar not found");
       console.log(divVar); 
     }
   }
} 
```

以及启动整个过程的按钮：

```
<input type="button" value="Update My Question!" onclick="updateQuestion(this.form,<?php echo" $ctr"; ?>)"> 
```

Firebug 显示第一个函数工作，并调用第二个函数，它没有得到变量：

```
[02:21:42.106] Called updateQuestion
[02:21:42.106] [object HTMLDivElement]
[02:21:42.106] XMLHttpRequestObject = TRUE
[02:21:42.106] MyVar = Gram- bacteria are stained purple with gram staining, while gram+ bacteria are stained pink.
[02:21:42.106] 1
[02:21:42.107] 2
[02:21:42.107] 3
[02:21:42.107] 4Gram- bacteria are stained purple with gram staining, while gram+ bacteria are stained pink.
[02:21:42.108] Handle server response called
[02:21:42.108] Loading
[02:21:42.108] 5
[02:21:42.108] Handle server response called
[02:21:42.109] Loading
[02:21:42.649] Empty string passed to getElementById(). @ hidden
[02:21:42.649] TypeError: document.getElementById(...) is null @ hidden
[02:21:42.647] Handle server response called
[02:21:42.648] 4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:18:52.490

在您的函数范围内已经有一个名为**“b”的变量。**这就是你得到错误的原因。如果它们是**全局**函数，您可以使用：

```
function a(form, ctr) {
    var a = form;
    var b = ctr;
    window.b(ctr);
} 

function b(ctr) {
    var b = ctr;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T02:14:50.277

以下内容真的没有意义：

```
var b = ctr;
b(ctr); 
```

在这里，变量`b`被视为函数并被调用，并且您将对其自身的引用作为参数传递。这真的是我们的意图吗？

**编辑：**现在有了附加信息，问题很容易解释。如果您查看您的日志，您会注意到 handleServerResponse 被多次调用。第一次“ctr”按预期传递。

问题在这里：

```
XMLHttpRequestObject.onreadystatechange  = handleServerResponse; 
```

这会设置一个回调，回调当然会在没有“ctr”的情况下调用你的函数，这就是你的代码运行的原因。您可以使用匿名函数，以便使用闭包：

```
XMLHttpRequestObject.onreadystatechange = function() { handleServerResponse(ctr); }; 
```

您可能想阅读 Crockford 的 JavaScript：The Good Parts，我认为这将有助于显着改进您的 JS 编码。

# java - 在android中找到多边形中的一个点

> ID：14048588
> 
> 赞同：0
> 
> 时间：2012-12-27T02:11:04.613
> 
> 标签：java, android, eclipse

我正在使用以下代码来查找代码中是否存在坐标点：

```
mMap.setOnMapClickListener(new OnMapClickListener() 
{
    public void onMapClick(LatLng point) 
    {
        boolean checkPoly = true;
        Point2D[] points = new Point2D[ myPoints.size()];
        for ( int i = 0; i < myPoints.size(); i ++)
        {
            LatLng pt = myPoints.get(i);
            points[i] = new Point2D(pt.latitude, pt.longitude);
        }
        Polygon2D polygon2d = new SimplePolygon2D(points);

        double a = point.latitude;
        double b = point.longitude;
        Point2D myPt = new Point2D(a,b);

        checkPoly = polygon2d.contains(myPt);
        Log.i("CHECK", String.valueOf(checkPoly));
        if (checkPoly)
        {
            setMarker(point);
        }
        else
            Toast.makeText(NewSearch.this,"The Location is outside of the Area", Toast.LENGTH_LONG).show();
    } 
```

我正在使用 JavaGeom 0.11.1 库来查找多边形点。然而，这段代码工作得很好。请注意，`myPoints`数组是`ArrayList<LatLng>`地图上绘制的多边形的所有顶点中的一个。但是发生了一些事情，现在它正在为地图之外的对面工作；如果我改变`!checkPoly`，那么它工作正常。

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:58:05.937

我查看[了多边形边界定义的来源](https://sourceforge.net/p/geom-java/code/357/tree/trunk/src/math/geom2d/polygon/LinearRing2D.java)。它使用“内部”的通常约定，这需要在“内部”空间周围以逆时针顺序给出顶点。您的边界很可能是按 CW 顺序给出的，这使得“内部”成为大多数人所说的外部。

换句话说，你认为的多边形实际上是覆盖整个 xy 宇宙的无限多边形中的一个洞。

所以颠倒边界顶点的顺序，事情应该开始按你的意愿工作。

**添加**

如果您不能反转顶点的顺序，则有一个不依赖于点顺序的不同多边形隶属度测试。如果您正在测试点 (x,y) 的成员资格，则此算法假定点 (infinity, y) 在多边形之外，然后确定 (x,y) 是否在对面。C 中的[实现归功于 WR Franklin](http://www.ecse.rpi.edu/~wrf/Research/Short_Notes/pnpoly.html)。将它移植到 Java 很容易。我已经多次使用它，效果非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-24T15:18:24.150

我一直在使用[Google android-maps-utils 库](https://github.com/googlemaps/android-maps-utils)，您可以使用 PolyUtil 类，尤其是在这种方法中：

```
public static boolean containsLocation(LatLng point, List<LatLng> polygon, boolean geodesic) 
```

# objective-c - 如何从 Cocoa Touch 上的实际打印机打印字符串

> ID：14048595
> 
> 赞同：1
> 
> 时间：2012-12-27T02:12:14.553
> 
> 标签：objective-c, ios, printing

我想使用代码从 iPad 向打印机发送一个字符串。

麻烦的是，我想用wifi连接到打印机，然后给它发送一个字符串进行打印。但是我不知道如何连接打印机，以及如何发送字符串，希望有人能帮助我。谢谢。

打印机和iPad在同一个本地离线，我想用socket通过打印机的IP地址来传输我要打印的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:22:44.510

如果打印机配置为 AirPrinter，那么使用[UIPrintInteractionController](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UIPrintInteractionController_Class/)相当容易。

# javascript - 茉莉花, javascript

> ID：14048596
> 
> 赞同：0
> 
> 时间：2012-12-27T02:12:40.223
> 
> 标签：javascript, unit-testing, jasmine

我刚开始学习 Javascript 和 Jasmine，并在运行测试时偶然发现以下错误消息：“ReferenceError：greet is not defined”

```
// greetSpec.js

  describe('greeter', function() {
    return it('should greet with message and name', function() {
      var result;
      result = greet('Hello', 'John Doe');
      return expect(result).toBe('Hello, John Doe!');
    });
  });

// greet.js    

      var greet;

      greet = function(message, person) {
        var greeting;
        return greeting = "" + message + ", " + person + "!";
      }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:20:50.427

~~该函数是在声明*之前*`greet`定义的。想想从上到下扫描的文件。到`describe`调用时，变量`greet`不存在，因此出现错误。尝试将 greet 函数定义放在调用之上。~~

事实证明，正如 Lennier 所说，“一些咖啡脚本生成的文件之间存在冲突”。很高兴我能帮上忙。

# javascript - WordPress .innerHtml 图片

> ID：14048599
> 
> 赞同：-1
> 
> 时间：2012-12-27T02:13:23.017
> 
> 标签：javascript, image, wordpress

我创建了一个 wordpress 主题，即使用 javascript .innerHTML 将内容插入到某些 div 中。它可以很好地插入文本，但不能插入图像。

```
 document.getElementById("title").innerHTML='<img src="images/header.gif"/>' 
```

我对 php 的了解很糟糕，但我也试过这个

```
 document.getElementById("title").innerHTML='<img src="<?php bloginfo('template_directory'); ?>/images/mainimage.jpg" title="" alt="" />'; 
```

这是 index.php

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head profile="http://gmpg.org/xfn/11">

<title><?php bloginfo('name'); ?><?php wp_title(); ?></title>

<meta http-equiv="Content-Type" content="<?php bloginfo('html_type'); ?>; charset=<?php bloginfo('charset'); ?>" /> 
<meta name="generator" content="WordPress <?php bloginfo('version'); ?>" /> <!-- leave this for stats please -->

<link rel="stylesheet" href="<?php bloginfo('stylesheet_url'); ?>" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="<?php bloginfo('rss2_url'); ?>" />
<link rel="alternate" type="text/xml" title="RSS .92" href="<?php bloginfo('rss_url'); ?>" />
<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="<?php bloginfo('atom_url'); ?>" />
<link rel="pingback" href="<?php bloginfo('pingback_url'); ?>" />
<script type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/javascript.js"></script>
<?php wp_get_archives('type=monthly&format=link'); ?>
<?php //comments_popup_script(); // off by default ?>
<?php wp_head(); ?>
</head>
 <body  onload="formatPage();">

  <div id="container">
    <div id="logo"></div>

    <div id="title"></div>

    <div id="nav"></div>

    <div id="content"></div>

    <div id="footer"></div> 
 </div>
 <script type="text/javascript" src="<?php bloginfo('template_url'); ?>/js/jquery.js"></script>

 </body>
 </html> 
```

这是javascript.js

```
 function formatPage(){
    document.getElementById("title").innerHTML='<img src="<?php bloginfo('template_directory'); ?>/images/header.gif" title="" alt="" />';
} 
```

我了解我的文档类型已过时，并且标题中可能有一些不需要的 php。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:40:12.603

确认图片路径正确。您必须在 head 部分包含该 js 文件。这就是图片没有被加载的原因。如果它现在在 index.php 中，也将头部部分移动到 header.php。

# jquery - jQuery：多个复选框选择和价格确定

> ID：14048600
> 
> 赞同：1
> 
> 时间：2012-12-27T02:13:28.640
> 
> 标签：jquery, jquery-selectors

我正在尝试创建一个“数字早餐/午餐/晚餐列表”，在两周的时间里，父母可以选择他们的孩子是否需要吃早餐、午餐和/或晚餐。这些值将与每餐的不同费率相乘以确定发票金额。父级单击返回总值的提交按钮。这是我到目前为止所得到的：

网络表格：

```
<input type="checkbox" name="breakfast">
<input type="checkbox" name="lunch">
<input type="checkbox" name="dinner"> 
```

有 14 天，每个天都重复。所以我总共有 42 个复选框。

jQuery：

```
var numBreakfast = $("input:checkbox[name='breakfast']").size();
var numLunch = $("input:checkbox[name='lunch']").size();
var numDinner = $("input:checkbox[name='dinner']").size();

var totalPrice = numBreakfast * priceBreakfast + numLunch * priceLunch + numDinner * priceDinner 
```

我想我的理解是正确的，但是当我调用总数时，我不断得到 0.00 美元的回报。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:33:20.697

试试这个来实际计算检查了多少项目：

```
var numBreakfast = $('input:checkbox[name=breakfast]:checked').length;
// same with all the others 
```

请注意使用`length`而不是，`size()`因为后者已被弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:28:50.207

```
function calculate(){
var numBreakfast = $("input:checkbox[name='breakfast']"),numBreakfastCount=0
numLunch = $("input:checkbox[name='lunch']"), numLunchCount=0;
numDinner = $("input:checkbox[name='dinner']"),numDinnerCount=0,
priceDinner=2.00,priceLunch=3.00,priceBreakfast=5.00;

for(i=0;i<numBreakfast.length;i++){
    if(numBreakfast[i].checked == true){
        numBreakfastCount++
    }
}

for(i=0;i<numLunch.length;i++){
    if(numLunch[i].checked == true){
        numLunchCount++
    }
}

for(i=0;i<numDinner.length;i++){
    if(numDinner[i].checked == true){
        numDinnerCount++
    }
}

var totalPrice = (numBreakfastCount * priceBreakfast) + (numLunchCount * priceLunch) + (numDinnerCount * priceDinner);
console.log(totalPrice);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T02:43:47.257

用`length`而不用`size`。

`$('input:checkbox[name="breakfast"]:checked').length`将为您提供选中的“早餐”框的数量。

这是一个工作示例：

[http://jsfiddle.net/senoramor/5qymM/1/](http://jsfiddle.net/senoramor/5qymM/1/)

# joomla - 选择对象时分离表格并更改下拉菜单

> ID：14048601
> 
> 赞同：2
> 
> 时间：2012-12-27T02:13:48.120
> 
> 标签：joomla, registration

在我的注册页面提供的图像中，我希望在左侧表格之间放置一个垂直分隔符，以便在右侧完成另一个表格以完成注册，但我不知道该怎么做。 [http://puu.sh/1fjia](http://puu.sh/1FJIA) 也是我问题的第二部分，与下拉菜单有关，除了#_usergroups之外，我将如何在选择时会更改下拉菜单以更改为文本框，又如何放置一个额外的选项？下面是用于 xml 的编码。

```
 <?xml version="1.0" encoding="UTF-8"?>
<form>
<fieldset name="default"
    label="COM_USERS_REGISTRATION_DEFAULT_LABEL"
>

    <field name="spacer" type="spacer" class="text"
            label="COM_USERS_REGISTER_REQUIRED"
        />

    <field name="name" type="text"
        description="COM_USERS_REGISTER_NAME_DESC"
        filter="string"
        label="COM_USERS_REGISTER_NAME_LABEL"
        message="COM_USERS_REGISTER_NAME_MESSAGE"
        required="true"
        size="30"
    />

    <field name="username" type="text"
        class="validate-username"
        description="COM_USERS_DESIRED_USERNAME"
        filter="username"
        label="COM_USERS_REGISTER_USERNAME_LABEL"
        message="COM_USERS_REGISTER_USERNAME_MESSAGE"
        required="true"
        size="30"
        validate="username"
    />

    <field name="password1" type="password"
        autocomplete="off"
        class="validate-password"
        description="COM_USERS_DESIRED_PASSWORD"
        field="password2"
        filter="raw"
        label="COM_USERS_REGISTER_PASSWORD1_LABEL"
        message="COM_USERS_REGISTER_PASSWORD1_MESSAGE"
        required="true"
        size="30"
        validate="equals"
    />

    <field name="password2" type="password"
        autocomplete="off"
        class="validate-password"
        description="COM_USERS_REGISTER_PASSWORD2_DESC"
        filter="raw"
        label="COM_USERS_REGISTER_PASSWORD2_LABEL"
        message="COM_USERS_REGISTER_PASSWORD2_MESSAGE"
        required="true"
        size="30"
    />

    <field name="email1" type="email"
        description="COM_USERS_REGISTER_EMAIL1_DESC"
        field="id"
        filter="string"
        label="COM_USERS_REGISTER_EMAIL1_LABEL"
        message="COM_USERS_REGISTER_EMAIL1_MESSAGE"
        required="true"
        size="30"
        unique="true"
        validate="email"
    />

    <field name="email2" type="email"
        description="COM_USERS_REGISTER_EMAIL2_DESC"
        field="email1"
        filter="string"
        label="COM_USERS_REGISTER_EMAIL2_LABEL"
        message="COM_USERS_REGISTER_EMAIL2_MESSAGE"
        required="true"
        size="30"
        validate="equals"
    />

    <field name="title" type="sql" 
        default="-None Listed-"
        label="Select your University" 
        description="Select the University you are currently attending, if                                                   

it's not on the list then create it below"
        query="SELECT title FROM #__usergroups WHERE ID > '8    ' "
        required="true"
    />

    <field
        name="captcha"
        type="captcha"
        label="COM_USERS_CAPTCHA_LABEL"
        description="COM_USERS_CAPTCHA_DESC"
        validate="captcha"
    />

</fieldset>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T22:42:29.893

**1.垂直分隔符**：

您可以使用 hack 即创建一些将输出标记的字段。

这里的想法是插入一个额外的

```
<div style='width:50%'> 
```

在第一个字段之前；然后一个

```
</div><div style='width:49%;border-left:1px dashed black'> 
```

你想要分隔符的地方，最后是 a 。

创建三个新的间隔字段。

您可以直接插入正确转义的 html：

```
<field type="spacer" name="splitterinit" label="&lt;div&gt;" /> 
```

或将 html 作为语言常量放在语言文件中：

```
SPLITTER_MID="</div><div style='width:49%;border-left:1px dashed black'>" 
```

并简单地使用 .xml 中的常量：

```
<field type="spacer" name="splittermid" label="SPLITTER_MID" /> 
```

**2.额外文字选项：**

*   简单：只需在下面添加一个文本字段以允许用户输入。
*   更难：创建一个自定义元素，在那里您可以编写 php 并根据需要进行制作

**3\. 忠告**

Chronoforms 具有用户注册覆盖功能，可让您定义所需的所有字段，并确保您会在 JED 上找到更多类似的扩展。此外，所有社区解决方案都具有自定义配置文件。

# iphone - UIWebView 未加载

> ID：14048603
> 
> 赞同：1
> 
> 时间：2012-12-27T02:14:30.490
> 
> 标签：iphone, ios, uiwebview

我正在尝试加载一个`UIWebView`，但我不明白为什么不起作用，我正在这样做：

```
Loading *load = [[Loading alloc] init];
[load searchName]; 
```

然后加载.h

```
@interface Loading : NSObject <UIWebViewDelegate>
{
UIWebView *myWebView;
}

- (void) searchName; 
```

加载.m

```
- (void) searchName{

myWebView = [[UIWebView alloc] init];
myWebView.delegate = self;

NSString *urlAddress = @"www.google.com";
//Create a URL object.
NSURL *url = [NSURL URLWithString:urlAddress];

//URL Requst Object
NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];

//Load the request in the UIWebView.
[myWebView loadRequest:requestObj];
}

- (void)webViewDidFinishLoad:(UIWebView *)thisWebView
{
NSString *yourHTMLSourceCodeString = [myWebView stringByEvaluatingJavaScriptFromString:@"document.body.innerHTML"];

NSLog(@"%@",yourHTMLSourceCodeString);
} 
```

为什么从不调用`webViewDidFinishLoad`方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:25:34.987

你是用 IB 创建这个 webview 的吗？您是否将代理连接到网络视图？

1.  尝试捕捉错误`webView:didFailLoadWithError:`（如果有错误，发布它们）
2.  尝试使用代码设置委托`[myWebView setDelegate:self];`或`self.myWebView.delegate = self;`

**如果没有发生任何事情，请检查委托的输出：**

```
self.myWebView.delegate = self;
NSLog(@"%@",self); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:29:52.113

是的，请注意内森所说的话。我只是在扩展。

如果您使用的是 IB，请连接插座。然后使用 [`myWebView setDelegate:self];`

请务必使用`http://`. Http 本身不会做任何事情。

您可以加载其他 URL 吗？

最后，我有一个用于 Cocoa 的开源基本 Web 浏览器，您可以看看。

[基本网页浏览器](https://sites.google.com/site/infiniteopensyntax/basic-web-browser)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T04:32:26.557

未显示您的 webview 的原因是您已经`NSObject`上课并且`NSObject`课程没有，`XIB`并且您所做的方式只是调用您的`-(void)searchName`方法而不是将其添加到`self.view`.

# google-app-engine - GAE：这是否可以在 cron/queue 冒充用户

> ID：14048609
> 
> 赞同：1
> 
> 时间：2012-12-27T02:15:51.080
> 
> 标签：google-app-engine, google-provisioning-api

假设我想使用 Google Apps Provisioning API 来检索我的域用户并将他们同步到我的 Google 数据存储中。我希望在 GAE Cron Job 中完成此操作，但 GAE Cron 不是登录用户，它没有任何凭据来调用 Google Apps Provisioning API。有没有办法模拟特定用户来调用 Google Apps Provisioning API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T13:20:43.467

您需要为[要模拟的用户获取 OAuth 2.0 令牌，](https://developers.google.com/accounts/docs/OAuth2WebServer)并确保[access_type=offline 已设置](https://developers.google.com/accounts/docs/OAuth2WebServer#formingtheurl)。然后使用存储的刷新令牌，即使没有用户“存在”，您也可以获得用户的当前访问令牌并执行 cron 操作。

# javascript - 使用 intellij 进行无头茉莉花测试

> ID：14048611
> 
> 赞同：2
> 
> 时间：2012-12-27T02:16:17.257
> 
> 标签：javascript, testing, intellij-idea, jasmine

有没有办法从 IntelliJ 运行无头 jasmine JavaScript 测试？我见过 jstestdriver 插件，它适用于浏览器测试，但我找不到在 IDE 中运行无头 jasmine 测试的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T05:22:52.187

我最终编写了一个类来解析 js 测试驱动程序配置并为 jasmine 文件生成规范。然后我使用 gradle 的 envjs 插件运行规范文件。

# c# - ListView 在运行时显示空的 TextBlocks

> ID：14048613
> 
> 赞同：0
> 
> 时间：2012-12-27T02:16:47.657
> 
> 标签：c#, xaml, listview, data-binding, design-time

我在数据绑定方面遇到了一个奇怪的问题。在设计器中，一切都正确显示，但在运行时我的 ListView 只包含那些 TextBlocks，其中包含一个空字符串。我正在为 ViewModels 使用 MVVM 灯。大部分代码是由 VS2012 通过为 WindowsStore-Apps 创建拆分页面生成的。

这是我的 XAML：（我已经删除了一些其他部分，例如`VisualStateManager`，但没有效果，所以这似乎不是问题。）

```
<common:LayoutAwarePage
    x:Name="pageRoot"
    x:Class="Kunden.OrderPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Kunden"
    xmlns:common="using:Kunden.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    DataContext="{Binding SelectCustomersViewModel, Source={StaticResource Locator}}">

    <Page.Resources>
        <CollectionViewSource
            x:Name="itemsViewSource"
            Source="{Binding Items}"/>
    </Page.Resources>

    <Grid Style="{StaticResource LayoutRootStyle}">
        <Grid.RowDefinitions>
            <RowDefinition Height="140"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="primaryColumn" Width="610"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid x:Name="titlePanel">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button
                x:Name="backButton"
                Click="GoBack"
                IsEnabled="{Binding DefaultViewModel.CanGoBack, ElementName=pageRoot}"
                Style="{StaticResource BackButtonStyle}"/>
            <TextBlock x:Name="pageTitle" Grid.Column="1" Text="Werbeauswahl" Style="{StaticResource PageHeaderTextStyle}" Margin="0,0,-2,40"/>
        </Grid>

        <!-- Elementliste mit vertikalem Bildlauf -->
        <ListView
            x:Name="itemListView"
            AutomationProperties.AutomationId="ItemsListView"
            AutomationProperties.Name="Items"
            TabIndex="1"
            Grid.Row="1"
            Margin="-10,-10,0,0"
            Padding="120,0,0,60"
            IsSwipeEnabled="False"
            SelectionChanged="ItemListView_SelectionChanged"
            ItemsSource="{Binding AvaiableCountries}">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Name}"/>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
... closing brackets etc. 
```

`IEnumerable`我要绑定的：

```
private IEnumerable<Country> avaiableCountries;

        public IEnumerable<Country> AvaiableCountries
        {
            get { return avaiableCountries; }
            set { avaiableCountries = value; RaisePropertyChanged(() => AvaiableCountries); }
        } 
```

`Country`我的 LINQ 查询所需的数据值对象：

```
public class Country
    {
        internal string Name { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T05:02:01.177

请尝试将 Name 属性的访问修饰符从`internal`to更改为`public`，看看是否可以解决您的问题？

如果这不起作用，请发布您使用数据填充 AvaiableCountries 的代码

# r - r中的打印循环问题

> ID：14048614
> 
> 赞同：1
> 
> 时间：2012-12-27T02:16:52.483
> 
> 标签：r

我对 R 编程语言比较陌生。我有一个数据框（标题为“DFA”），其中包含大量时间序列数据列表，标题为“TS1”、TS2”、TS3”等，直至“TS1000”。我需要将这些作为线添加到现有的 XY 图中，并希望通过使用简单的循环函数来自动添加这些时间序列。我使用了以下简单代码：

```
for (i in 1:1000) { 
    lines(DFA$year, DFA$ts[i], lty=1, col="grey", lwd=1) 
} 
```

不幸的是，这什么也没产生？当我添加 1 行 1 行（即没有循环）时，它工作正常。任何人都可以帮助指出循环失败以帮助我自动化流程吗？非常感谢。菲尔

继上述初始帖子之后，DFA 数据帧的一部分如下所示（每个时间序列有 157 个点，有 1000 个时间序列）：

```
 ts1 ts2 ts3 ts4
1   6871    6855    6843    6870
2   6872    6858    6848    6872
3   6873    6861    6854    6874
4   6874    6865    6859    6877
5   6876    6868    6864    6879
6   6877    6871    6869    6881
7   6879    6875    6874    6883
8   6880    6878    6879    6886
9   6882    6881    6884    6888
10  6883    6884    6889    6890 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T11:55:56.613

如果我了解您的最终目标，这里不需要循环。相反，您可以将数据集转换为实际的时间序列数据集并绘制结果数据。

这是您提供的示例数据：

```
temp <- read.table(header = TRUE, text = "    ts1 ts2 ts3 ts4
1   6871    6855    6843    6870
2   6872    6858    6848    6872
3   6873    6861    6854    6874
4   6874    6865    6859    6877
5   6876    6868    6864    6879
6   6877    6871    6869    6881
7   6879    6875    6874    6883
8   6880    6878    6879    6886
9   6882    6881    6884    6888
10  6883    6884    6889    6890") 
```

我们可以想象这个数据跨越 1990 年到 1999 年，并且是年度数据。

```
temp.ts <- ts(temp, start = 1990, end = 1999, frequency = 1)
plot(temp.ts, plot.type = "single") 
```

结果：

![在此处输入图像描述](../Images/adab828f72a686e25e3baf978bed8781.png)

我认为这是解决此问题的最有效方法。

另一种方法是为“年份”添加一个变量，并将数据从宽变长（但我不确定这将如何处理 1000 个时间序列变量）。基本方法是这样的：

```
temp$year <- seq(1990, length.out=10)
temp1 <- reshape(temp, direction = "long", idvar="year", 
                 varying=names(temp)[grepl("ts", names(temp))], sep ="")
plot(temp1$year, temp1$ts, type = "l") 
```

还有其他方法（特别是 using `lapply`，它将通过您`data.frame`的 by 列）您可能会觉得有用。

# ios - 如何在我的 ios 应用程序中包含 lpsolve，一个基于 c 的线性编程库

> ID：14048615
> 
> 赞同：3
> 
> 时间：2012-12-27T02:17:09.310
> 
> 标签：ios

该库可以在这里找到：

[http://lpsolve.sourceforge.net/](http://lpsolve.sourceforge.net/)

该站点上的演示代码显示他们执行#include "lp_lib.h"，然后对库进行 API 调用。

我的问题是：如何将站点在库下载时提供的各种 .so 文件转换为某种格式并转换为 xcode，以使我可以包含 .lib 并对其进行 API 调用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-01-28T12:11:59.100

为 armv7 架构编译 lp_solve 非常困难，并且已经得到了许多有才华的人的青睐。我这样说是因为上面的答案看起来如果你足够仔细地遵循说明，你将能够编译，然后拖放。

我会使用在 iOS 上工作的 GLPK。 [https://github.com/wisarutk/MyGLPK](https://github.com/wisaruthk/MyGLPK)。
为 iOS 编译这个包的那位先生最初试图为 lp_solve 做它，但无法让它工作。这个包将允许您进行概念验证，但会使用 GPL 许可证感染您的应用程序。如果您想将您的应用程序放在 iTunes 上，您必须弄清楚如何获得商业友好的软件包。

AlgLib 是最便宜的商用库，但它没有混合整数编程。其他解决方案 Gurobi、Frontline Solver、NAG、Rogue Wave 对开发者许可证收取超过 5,000 美元的费用，并且将与您达成大规模交易，仅向您的用户收取 350 美元的运行时许可证费用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:23:54.230

在 iOS 中，您不能使用动态链接，也就是说，您必须静态链接 lp_solve。文档有关于如何在[此处](http://lpsolve.sourceforge.net/5.5/Build.htm#Statically%20link%20your%20application%20with%20lpsolve)构建静态库的说明。

编译完静态库后，只需将生成的`.a`文件拖放到项目中，然后将其添加到目标的链接步骤。应该是这样的。但是，由于 lp_solve 是 LGPL 许可的，因此请注意许可问题，请参见[此处](http://lpsolve.sourceforge.net/5.5/FAQ.htm)。

# python - 使用python 27仅检索SQLITE中一行的最后一个值

> ID：14048620
> 
> 赞同：0
> 
> 时间：2012-12-27T02:18:01.087
> 
> 标签：python, sqlite

我正在使用此代码从 sqlite 行中获取所有数据，但我只想检索最后 30 个条目。

```
import sqlite3
from matplotlib import pyplot
fig = pyplot.figure()

con = sqlite3.connect('growll.db')
con.text_factory = str
cur = con.cursor()
cur.execute("select temp from GrowLLDados")
ar=[r[0] for r in cur.fetchall()] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:20:01.133

就像是 `"select temp from GrowLLDados ORDER BY id DESC LIMIT 30"`

哪里`id`是自动递增计数器，或者至少意味着数字越大，条目越近...

# matlab - 如何创建一个接受字符串的向量？

> ID：14048622
> 
> 赞同：-2
> 
> 时间：2012-12-27T02:18:09.267
> 
> 标签：matlab

好的，问题是，我想接收数学函数。在程序运行之前我不知道有多少。

当它运行时，我会询问`n`我将要接收的一些功能，并开始从输入中保存它们。

到目前为止我有这个

```
function test()  
n = input('number of equations?');  
v = [1:n]  
%in an ideal world, this ^ here would allow me to put a string in each position but  
% they are not the same type and I understand that.. but how can I build a vector for saving my                functions  
%I want a vector where I can put strings in each position that is what I need   
for i=1:n  
x = input('what is the function?','s');  
v(i)=x  
end  
v   
%this would be my vector already changed with a function in each position.  
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:38:02.437

如果要存储不同长度的字符串，请使用元胞数组：

```
v = cell(1,n);
for i=1:n   
    v{i} = input('what is the function?','s'); #% note the curly braces
end 
```

要将这些用作函数，请使用[str2func](http://www.mathworks.com/help/matlab/ref/str2func.html)：

```
for i=1:n
    fh{i} = str2func(v{i});
end 
```

`fh`现在是一个元胞数组，其中包含用户输入字符串定义的函数的句柄。

# php - 选择两行具有相同列值的位置并回显它们

> ID：14048630
> 
> 赞同：0
> 
> 时间：2012-12-27T02:19:52.770
> 
> 标签：php, mysql

在“ogitems”表中，我有一个名为“itemname”、“month”和“price”的列。

有重复的项目，按月排列。

我想检查“itemname”以查看是否有任何行具有相同的 itemname 值，如果是，则回显“itemname”以及过去两个月和这两个月的定价。

例子：

"itemname" = 奶酪切达干酪

CHEESE CHEDDAR 出现在第 11 个月和第 12 个月（因此 CHEESE CHEDDAR 有两条记录/行）。11 的“价格”为 51，而 12 的“价格”为 54

我想将该信息回显到一个锚标签中......

```
<a href="pricetrend.php?date=<?php echo "" . $row['month'] . "" ?>&price1=<?php echo $price1; ?>&price2=<?php echo $price2; ?>&item=<?php echo "" . $row['itemname'] . ""?>;"> 
```

**基本上**，我试图获取一件物品的两个最新价格并将它们回显到这个锚标签中。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:32:09.617

```
select * from ogitems where itemname='CHEESE CHEDDAR' order by month desc limit 2 
```

此 sql 语句应该可以解决您的问题

```
<?php 
  $result = mysql_query("select * from ogitems where itemname='CHEESE CHEDDAR' order by month desc limit 2")
  while ($row = mysql_fetch_assoc($result)) {
    echo $row["itemname"];
    echo $row["month"];
    echo $row["price"];
   }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:40:25.487

我假设您的月份是 a `date field`，这应该可以

**SQL Fiddle 链接：** [http ://sqlfiddle.com/#!2/d63a0/4](http://sqlfiddle.com/#!2/d63a0/4)

```
SELECT * FROM (
                 SELECT
                        o.itemname,
                        o.month,
                        ( SELECT price FROM ogitems i WHERE i.itemname = o.itemname AND i.month<o.month ORDER BY MONTH DESC LIMIT 1) AS last_month_price,
                        o.price AS current_month_price
                FROM
                    ogitems o
                ORDER BY
                    o.month DESC

              ) AS items
GROUP BY
  items.itemname
HAVING
  items.last_month_price IS NOT NULL 
```

# java - 通过 Java 运行时运行时，Microsoft C++ 中缺少启动横幅

> ID：14048631
> 
> 赞同：1
> 
> 时间：2012-12-27T02:19:57.143
> 
> 标签：java, visual-c++

我遇到了一个奇怪的问题。我在 Windows 7 SP1 64 位下安装了 Java JRE 7 64 位。我还安装了带有 C/C++ 编译器的 Visual Studio 2010 IDE。我正在尝试通过 Java Runtime Exec 执行 cl.exe 命令来获取编译器构建版本。

当我打开 cmd.exe shell 并在“C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE”目录中执行 ..\..\VC\bin\cl.exe 时，我得到以下输出：

Microsoft (R) 32 位 C/C++ 优化编译器版本 16.00.40219.01，适用于 80x86 版权所有 (C) Microsoft Corporation。版权所有。

用法： cl [ 选项... ] 文件名... [ /link 链接选项... ]

但是当我在 Java 运行时中执行相同的命令时，我会得到以下输出：

用法： cl [ 选项... ] 文件名... [ /link 链接选项... ]

输出不包含 2 行启动横幅。我需要启动横幅来显示编译器版本和内部版本号。

我用来执行命令的 Java 模板是：

```
public static void main(String[] args) {

    try {   
        Process p = Runtime.getRuntime().exec("cmd /d /c chdir /d C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE && ..\\..\\VC\\bin\\cl");   
        BufferedReader in = new BufferedReader( new InputStreamReader(p.getInputStream()));   
        String line = null;   
        while ((line = in.readLine()) != null) {   
            System.out.println(line);   
        }   
    } catch (IOException e) {   
        e.printStackTrace();   
    }   

} 
```

我怀疑 cl.exe 进程能够理解启动它的上下文并禁用启动横幅。知道如何获得启动横幅吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:27:17.127

这是因为`cl.exe`将横幅发送到错误流。阅读`p.GetErrorStream()`以找到横幅。您可以通过像这样执行 cl 在命令提示符下验证是否是这种情况：

```
cl 2>%userprofile%\Desktop\error.txt 
```

请注意，横幅不会出现，而是路由到您的桌面\error.txt。

# php - 数据库错误：列计数与第 1 行的值计数不匹配

> ID：14048640
> 
> 赞同：0
> 
> 时间：2012-12-27T02:21:53.147
> 
> 标签：php, database

```
echo $column;//Here $column="Date ,1007001 ,1007002 ,1007003 ,1007004 ,1007005 ,1007006";
echo $columnvalue; // Here $columnvalue="'12/27/2012' ,'1' ,'0' ,'1' ,'1' ,'0' ,'1'" ;
$sql_cmd ="INSERT INTO `databasename`.`$table` (`$column`) VALUES ($columnvalue)"; 
if(!mysql_query($sql_cmd)) {
       die('inside AddUserToDataBase Error: ' . mysql_error());
       } 
```

在这里我得到了错误：列数与第 1 行的值计数不匹配如何解决？请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:58:52.267

('$column') 应该是 ($column)
('$column') 表示列名

```
('Date ,1007001 ,1007002 ,1007003 ,1007004 ,1007005 ,1007006') 
```

这基本上是 1 列有一个奇怪的名称（名称是 'Date ,1007001 ,1007002 ,1007003 ,1007004 ,1007005 ,1007006' ），它应该是

```
(Date ,1007001 ,1007002 ,1007003 ,1007004 ,1007005 ,1007006) 
```

或者

```
('Date' ,'1007001' ,'1007002' ,'1007003' ,'1007004' ,'1007005' ,'1007006') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T13:32:00.403

“列计数与第 1 行的值计数不匹配”

通常在 values 子句中定义的列与您的实际表列不匹配时发生。

说你的桌子有 4 列，col1 col2 col3 col4

并且您只想将数据插入 col2, col3, col4

您的插入语句应该是：

`Insert into table (col2, col3, col4) values (col2val, col3val, col4val)`

# ios6 - 可达性错误

> ID：14048641
> 
> 赞同：2
> 
> 时间：2012-12-27T02:21:57.423
> 
> 标签：ios6, reachability

```
Undefined symbols for architecture i386:
  "_OBJC_CLASS_$_Reachability", referenced from:
      objc-class-ref in FirstViewController.o
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我查看了 FirstViewController、reachability.h 和reachability.m——它的定义很明确！我什至添加了 SystemConfiguration.Framework，以及 Reachability.m 在编译列表中。

有任何想法吗？我快疯了！附图片。

[http://i.imgur.com/uw4Zb.png](http://i.imgur.com/uw4Zb.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T13:24:41.110

*   尝试从您的 xCode 项目中删除对 Reachability.h 和 Reachability.m 文件的引用。- 确保它从编译源中消失。
*   搜索您的项目文件夹，确保其中没有 Reachability.h 和 Reachability.m 文件的重复项
*   Command+Shift+K 清理项目；
*   将 Reachability.h 和 Reachability.m 添加回 xCode 项目；

希望这会有所帮助。

# javascript - iFrame 填充与源不同

> ID：14048642
> 
> 赞同：2
> 
> 时间：2012-12-27T02:22:01.213
> 
> 标签：javascript, html, css, iframe, doctype

我创建了一个小型 javascript 富文本编辑器，但是当我在 iframe 中打开它时，某些对象的填充不正确。这是从源代码中看到的图像： ![来自源的正确填充](../Images/a9ca9ac137c93cda4f542e68212aecca.png)

但是，当我把它放在 iframe 中并使用这个源时，它看起来像这样：

![来自 iframe 的错误填充](../Images/cff353da0b7051a47384bcb76683ddd6.png)

我尝试更改`DOCTYPE`和更改`margin:`and `padding:`，`0px`但没有任何改变。我似乎无法解决这个问题。任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:04:09.640

据我所知，发生的事情是 iframe 的宽度不够。从源头上，颜色选择器框可以填充它需要的所有空间，但在 iframe 中它是狭窄的，缩小了其中的所有内容，并使最后的颜色带和灰色 16、32、64 下降到另一行。此外，颜色选择器的偏移量似乎已关闭；您是否使用百分比宽度和偏移量，也许？你可以做很多事情来解决这个问题：只需增加 iframe 的宽度（你不能让盒子只溢出 iframe），将颜色选择器框移到左边，固定选择器的大小（你需要调整 iframe 的大小或使其滚动，等等。不过，这可能不是 DOCTYPE 问题。更多细节将不胜感激，但我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T03:05:34.207

行。我想出了我需要做什么。我将颜色选择器`div`设置为特定`.offset()`于 jQuery，但它在 iframe 中没有完全发挥作用。原因是因为`div`颜色位函数的宽度是变化的。因此，jQuery 无法确定颜色选择器的左侧位置，`div`因为我编写的偏移函数使用`div`. 所以，我需要做的就是设置颜色选择器的宽度。;） 谢谢您的帮助！

# linux - 重用目录中的文件名

> ID：14048645
> 
> 赞同：-1
> 
> 时间：2012-12-27T02:22:23.310
> 
> 标签：linux, bash, shell

我想在创建新文件时重用特定目录中的文件夹名称。就像是：

```
cat /home/sss/features/{month}/file-* > /home/sss/features_{month}.txt 
```

我将在此命令中将 {month} 替换为 *。月份可以是任意 12 个月，并非所有月份都始终存在。最终结果应该是每个月的连接文件：

```
/home/sss/features_JAN_2012.txt
/home/sss/features_MAR_2012.txt
/home/sss/features_NOV_2012.txt 
```

是否有可能在linux中以某种方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:38:52.397

有什么问题

```
for dirname in features/*
do 
    month="$(basename "$dirname")"
    cat "$dirname"/file-* > "features-$month-2012.txt"
done 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T02:40:28.890

```
#!/bin/bash
BASE=/home/sss/features

for f in `ls $BASE`; do
    cat `ls $BASE/$f` > $BASE_$f.txt
done 
```

# java - Java Swing - 使用定时器刷新 jTable

> ID：14048651
> 
> 赞同：4
> 
> 时间：2012-12-27T02:23:19.093
> 
> 标签：java, swing, swingbuilder

我有 2 个简单的数据库查询`JTable`（客户端和服务器）。

客户端具有查看记录、打印、保存 PDF 等所有功能。服务器自动刷新数据库记录到表，计时器为 30 秒。（尚未实现。）

我的问题是我可以将数据库记录显示到表中，而以下代码没有问题。

```
PreparedStatement pst = conn.prepareStatement("SQL");
ResultSet rs = pst.ExecuteQuery();
jTable1.setModel(DbUtils.resultSetToTableModel(rs)); 
```

但我希望用上面的代码和定时器来实现表的自动刷新。

例如，我将代码插入到名为 public void 的方法`Update_Records()`中。我应该如何使用计时器来调用该方法以每 30 秒将记录显示到表中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T02:28:26.570

你可以这样做：

```
Timer timer = new Timer(0, new ActionListener() {

   @Override
   public void actionPerformed(ActionEvent e) {
      updateRecords();
   }
});

timer.setDelay(30000); // delay for 30 seconds
timer.start(); 
```

*另外：* Java 命名约定具有以小写字母开头的方法，并且通常不使用下划线，因此`Update_Records`变成`updateRecords`.

# ruby-on-rails - 修复 Rails 错误“找不到 SafetyTestsController 的操作‘show’”

> ID：14048653
> 
> 赞同：0
> 
> 时间：2012-12-27T02:24:08.950
> 
> 标签：ruby-on-rails, ajax, rest

我想`destroy`在我的应用程序中对操作进行 AJAX 调用，并且正在遵循[Rails 3.1 中的指南 Ajax 的示例 #3 -](http://madebydna.com/all/code/2011/12/05/ajax-in-rails-3.html#)执行此操作的路线图。我正在使用 Rails 3.2.8。

我让 AJAX 请求工作得很好，并且`destroy`按照我的预期调用了该操作。当用户请求`destroy`操作的 HTML 页面时，我想删除该项目，然后将她重定向到另一个页面。

问题是当我插入代码进行重定向时，HTML 和 AJAX 请求都停止工作。当代码存在时，AJAX 请求会返回 500 Internal Server Error，而 HTML 请求会返回“找不到 SafetyTestsController 的操作‘show’”。当这两行不存在时，AJAX 工作正常，HTML 仍然返回相同的错误。

**查看（未渲染）：**

```
<%= link_to 'Delete', {controller: 'safety_tests', action: 'destroy', id: safety_test.id}, remote: true, method: :delete, confirm: 'Are you sure?', id: "delete_safety_test" %> 
```

**查看（渲染）：**

```
<a href="/safety_tests/14" data-confirm="Are you sure?" data-method="delete" data-remote="true" id="delete_safety_test" rel="nofollow">Delete</a> 
```

**应用程序/控制器/safety_tests_controller.rb**

```
class SafetyTestsController < ApplicationController
  respond_to :html, :js
  ...
  def destroy
    test = SafetyTest.find(params[:id])
    student_id = test.student_id
    test.destroy

    respond_with(test) do |format|
      format.js { render nothing: true }
    end

    #Two lines below should run for an HTML request but not a Javascript request.
    #When uncommented, AJAX request returns 500 Internal Server Error 
    #flash[:notice] = 'Safety test deleted successfully.'
    #redirect_to controller: 'students', action: 'show', id: student_id
  end 
```

**耙路线**

```
new_user_session GET    /users/sign_in(.:format)                     devise/sessions#new
                user_session POST   /users/sign_in(.:format)                     devise/sessions#create
        destroy_user_session DELETE /users/sign_out(.:format)                    devise/sessions#destroy
                        root        /                                            dashboard#home
                    students GET    /students(.:format)                          students#index
                             POST   /students(.:format)                          students#create
                 new_student GET    /students/new(.:format)                      students#new
                edit_student GET    /students/:id/edit(.:format)                 students#edit
                     student GET    /students/:id(.:format)                      students#show
                             PUT    /students/:id(.:format)                      students#update
                             DELETE /students/:id(.:format)                      students#destroy
                       trips GET    /trips(.:format)                             trips#index
                             POST   /trips(.:format)                             trips#create
                    new_trip GET    /trips/new(.:format)                         trips#new
                   edit_trip GET    /trips/:id/edit(.:format)                    trips#edit
                        trip GET    /trips/:id(.:format)                         trips#show
                             PUT    /trips/:id(.:format)                         trips#update
                             DELETE /trips/:id(.:format)                         trips#destroy
                safety_tests GET    /safety_tests(.:format)                      safety_tests#index
                             POST   /safety_tests(.:format)                      safety_tests#create
             new_safety_test GET    /safety_tests/new(.:format)                  safety_tests#new
            edit_safety_test GET    /safety_tests/:id/edit(.:format)             safety_tests#edit
                 safety_test GET    /safety_tests/:id(.:format)                  safety_tests#show
                             PUT    /safety_tests/:id(.:format)                  safety_tests#update
                             DELETE /safety_tests/:id(.:format)                  safety_tests#destroy
               medical_forms GET    /medical_forms(.:format)                     medical_forms#index
                             POST   /medical_forms(.:format)                     medical_forms#create
            new_medical_form GET    /medical_forms/new(.:format)                 medical_forms#new
           edit_medical_form GET    /medical_forms/:id/edit(.:format)            medical_forms#edit
                medical_form GET    /medical_forms/:id(.:format)                 medical_forms#show
                             PUT    /medical_forms/:id(.:format)                 medical_forms#update
                             DELETE /medical_forms/:id(.:format)                 medical_forms#destroy
     parent_permission_forms GET    /parent_permission_forms(.:format)           parent_permission_forms#index
                             POST   /parent_permission_forms(.:format)           parent_permission_forms#create
  new_parent_permission_form GET    /parent_permission_forms/new(.:format)       parent_permission_forms#new
 edit_parent_permission_form GET    /parent_permission_forms/:id/edit(.:format)  parent_permission_forms#edit
      parent_permission_form GET    /parent_permission_forms/:id(.:format)       parent_permission_forms#show
                             PUT    /parent_permission_forms/:id(.:format)       parent_permission_forms#update
                             DELETE /parent_permission_forms/:id(.:format)       parent_permission_forms#destroy
    teacher_permission_forms GET    /teacher_permission_forms(.:format)          teacher_permission_forms#index
                             POST   /teacher_permission_forms(.:format)          teacher_permission_forms#create
 new_teacher_permission_form GET    /teacher_permission_forms/new(.:format)      teacher_permission_forms#new
edit_teacher_permission_form GET    /teacher_permission_forms/:id/edit(.:format) teacher_permission_forms#edit
     teacher_permission_form GET    /teacher_permission_forms/:id(.:format)      teacher_permission_forms#show
                             PUT    /teacher_permission_forms/:id(.:format)      teacher_permission_forms#update
                             DELETE /teacher_permission_forms/:id(.:format)      teacher_permission_forms#destroy
               trip_deposits GET    /trip_deposits(.:format)                     trip_deposits#index
                             POST   /trip_deposits(.:format)                     trip_deposits#create
            new_trip_deposit GET    /trip_deposits/new(.:format)                 trip_deposits#new
           edit_trip_deposit GET    /trip_deposits/:id/edit(.:format)            trip_deposits#edit
                trip_deposit GET    /trip_deposits/:id(.:format)                 trip_deposits#show
                             PUT    /trip_deposits/:id(.:format)                 trip_deposits#update
                             DELETE /trip_deposits/:id(.:format)                 trip_deposits#destroy
                   trip_fees GET    /trip_fees(.:format)                         trip_fees#index
                             POST   /trip_fees(.:format)                         trip_fees#create
                new_trip_fee GET    /trip_fees/new(.:format)                     trip_fees#new
               edit_trip_fee GET    /trip_fees/:id/edit(.:format)                trip_fees#edit
                    trip_fee GET    /trip_fees/:id(.:format)                     trip_fees#show
                             PUT    /trip_fees/:id(.:format)                     trip_fees#update
                             DELETE /trip_fees/:id(.:format)                     trip_fees#destroy
                   team_dues GET    /team_dues(.:format)                         team_dues#index
                             POST   /team_dues(.:format)                         team_dues#create
                new_team_due GET    /team_dues/new(.:format)                     team_dues#new
               edit_team_due GET    /team_dues/:id/edit(.:format)                team_dues#edit
                    team_due GET    /team_dues/:id(.:format)                     team_dues#show
                             PUT    /team_dues/:id(.:format)                     team_dues#update
                             DELETE /team_dues/:id(.:format)                     team_dues#destroy 
```

我怎样才能让两条线工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:35:28.567

```
respond_to do |format|
  format.html { redirect_to(url_for(controller: 'students', action: 'show', id: student_id), notice: 'Safety test deleted successfully.') } # actually can be without url_for
  format.js { render nothing: true }
end 
```

第二个原因可能是 HTML 请求不包含 DELETE 方法，因此 ActionDispatch 认为您在 SafetyTestsController 中请求 :action => 'show'。核实。

```
<%= link_to 'Delete', {controller: 'safety_tests', action: 'destroy', id: safety_test.id}, remote: true, method: :delete, :data => { confirm: 'Are you sure?' }, id: "delete_safety_test" %> 
```

为什么不使用命名路由？：

```
<%= link_to 'Delete', safety_test, remote: true, method: :delete, :data => { confirm: 'Are you sure?' }, id: "delete_safety_test" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T19:24:59.897

找到了答案。这是适用于 JS 和 HTML 的代码：

```
<%= form_for(safety_test, method: :delete, remote: true, html: {class: "delete_safety_test"}) do |f| %>
    <%= f.submit "Delete", confirm: "Are you sure?" %> 
<% end %> 
```

# intellij-idea - IDEA：如何更改工具栏颜色以指示测试是否覆盖特定行？

> ID：14048654
> 
> 赞同：2
> 
> 时间：2012-12-27T02:24:18.250
> 
> 标签：intellij-idea

我已经接受了[高效编码](http://www.jetbrains.com/idea/)的阴暗面，现在发现“线覆盖”和“线未覆盖”颜色不太华丽，也不够独特。我想让它更亮（亮绿色和亮红色会很好）

请问我该如何更改？

![在此处输入图像描述](../Images/d903dce246efeb157d804d4bb69230d5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T06:15:50.923

您可以更改设置中的颜色，但不能更改硬编码的不透明度：

![覆盖颜色](../Images/da142a27117a6b49c66fadaa7fc444cb.png)

如果无法通过更改颜色来实现您想要的效果，[请提交请求](http://youtrack.jetbrains.net/issues/IDEA)以使不透明度可配置。

# java - 设置主题后，Android 应用程序强制关闭

> ID：14048655
> 
> 赞同：3
> 
> 时间：2012-12-27T02:24:20.470
> 
> 标签：java, android

我刚刚开始使用 Android 开发，完成了一些教程，现在我正在开发一个简单的应用程序。在模拟器和我的手机（Android 4.0.3 模拟器，Android 4.1.1 Atrix HD）上，我认为是 Holo Light 的应用程序都显示。我宁愿它是 Holo Dark，但是当我将以下行添加到 Android Manifest 文件中的应用程序块时：`android:theme="@android:style/Theme.Holo"`应用程序编译正常，但一打开它就强制关闭。

我究竟做错了什么？我敢肯定这很简单，但正如我所说，我对此很陌生。先谢谢大家了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T10:18:43.537

The simplest thing you can do and you should always do is to read logs why does it crash. The log will tell you the reason of you crash. Please post the reason including logs from [Logcat](http://developer.android.com/tools/help/logcat.html) and only then ask about fixes:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T07:45:28.873

如果您想为应用程序的所有活动使用主题，那么您需要使用

```
<application android:theme="@style/CustomTheme"> 
```

在**AndroidManifest.xml**中。如果您希望将主题应用于应用程序中的一个 Activity，则将**android:theme**属性添加到**Activity**标记中。所以需要知道您在应用程序中使用的类型。但是看看这些东西会更清楚你..
[http://developer.android.com/guide/topics/ui/themes.html](http://developer.android.com/guide/topics/ui/themes.html)
[http://www.androidengineer.com/2010/06/using-themes-in-android-applications.html](http://www.androidengineer.com/2010/06/using-themes-in-android-applications.html)

# c# - 如何定位窗口内的所有按钮？

> ID：14048659
> 
> 赞同：1
> 
> 时间：2012-12-27T02:24:42.607
> 
> 标签：c#, wpf, button

我的`WPF`窗口中有几个按钮。如何定位窗口内的所有按钮，无论它们是在内部`Stack panels`还是`Dock Panels`. 我想针对所有人，以便能够通过设置更改所有人的背景颜色。

除了针对按钮的每个单独名称之外，还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:04:35.043

为资源中的按钮定义样式而不给出键名。它将自动应用于窗口中的所有按钮。

```
 <Style TargetType="{x:Type Button}">
        <Setter Property="Background" Value="Red"/>
    </Style> 
```

希望能帮助到你..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T02:56:26.873

看看这个问题[Find all controls in WPF Window by type](https://stackoverflow.com/questions/974598/find-all-controls-in-wpf-window-by-type)

它展示了如何获取 WPF 应用程序中的所有控件，然后您可以设置按钮的背景颜色。

```
foreach (Button btn in FindVisualChildren<Button>(window))
{
    btn.Background = new SolidColorBrush(Colors.Black);
} 
```

`FindVisualChildren`来自链接的答案。

# javascript - Ember.js 事件不起作用

> ID：14048666
> 
> 赞同：2
> 
> 时间：2012-12-27T02:25:44.620
> 
> 标签：javascript, ember.js

我编写了这个非常简单的 Ember 代码，但由于某种原因，当我按下按钮时，事件似乎没有触发。有小费吗？

```
<!DOCTYPE html>

<html>

  <head>
    <title>Test</title>
  </head>

  <body>

    <script type="text/x-handlebars">
      {{#view CounterView}}
        Counter: {{Counter.value}}

        <button {{action "increment"}}>Add 1</button>
      {{/view}}
    </script>

    <script src="jquery-1.7.2.min.js"></script>
    <script src="handlebars-1.0.rc.1.min.js"></script>
    <script src="ember-1.0.pre.min.js"></script>

    <script>
      Counter = Ember.Object.create({
        value: 1,
      })

      CounterView = Ember.View.extend({
        increment: function(event) {
          Counter.incrementProperty('value');
        }
      })
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T16:23:21.763

为了使事件系统正常工作，Ember.js 需要创建和初始化一个应用程序（框架会为您完成）。

将您的示例应用于默认的 Ember.js 启动 jsfiddle，结果如下：

html模板：

```
<script type="text/x-handlebars" data-template-name="application">
  {{#view MyApp.CounterView}}
    Counter: {{MyApp.counter.value}}
    <button {{action "increment"}}>Add 1</button>
  {{/view}}
</script> 
```

Javascript：

```
//Thanks to @Trek Instructions:
//The following line creates one listener for each user event (e.g. 'click') and
//controls event delegation.
MyApp = Ember.Application.create();

MyApp.counter = Ember.Object.create({
  value: 1
});

MyApp.CounterView = Ember.View.extend({
  increment: function(event) {
    MyApp.counter.incrementProperty('value');
  }
}); 
```

​ 工作小提琴：http: [//jsfiddle.net/6p6XJ/260/](http://jsfiddle.net/6p6XJ/260/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T04:39:06.343

我建议您阅读[http://trek.github.com/](http://trek.github.com/)，尤其是“最小的可行 Ember 应用程序”部分。

从 1.0.pre 开始，Ember 应用程序需要存在路由器。但是，网上的大多数文档/示例都是指 0.9.5 时代

Trek 指南 + ember 文档是开始使用该框架的好方法。

# android - 如何确定 Widget 中的 TextView 宽度？

> ID：14048667
> 
> 赞同：2
> 
> 时间：2012-12-27T02:25:59.503
> 
> 标签：android

当我查看解决方案时：

[如何在小部件中使用自定义字体](https://stackoverflow.com/questions/4318572/how-to-use-a-custom-typeface-in-a-widget)

**在上面的问题中，我在一个Widget中使用了自定义字体；使用解决方案：**

```
public Bitmap buildUpdate(String time) 
  {
    Bitmap myBitmap = Bitmap.createBitmap(160, 84, Bitmap.Config.ARGB_4444);
    Canvas myCanvas = new Canvas(myBitmap);
    Paint paint = new Paint();
    Typeface clock = Typeface.createFromAsset(this.getAssets(),"Clockopia.ttf");
    paint.setAntiAlias(true);
    paint.setSubpixelText(true);
    paint.setTypeface(clock);
    paint.setStyle(Paint.Style.FILL);
    paint.setColor(Color.WHITE);
    paint.setTextSize(65);
    paint.setTextAlign(Align.CENTER);
    myCanvas.drawText(time, 80, 60, paint);
    return myBitmap;
  } 
```

**问题：如何根据字符数确定生成的位图的宽高？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:34:26.747

有了这个：

```
Rect rect = new Rect();
paint.getTextBounds(time, 0, time.length(), rect); // time = your text
int w = rect.width(); // width text
int h = rect.height(); // height of text 
```

这会将文本的边界保存在 Rect 中，然后您可以测量 Rect。

# php - 在网站上投票

> ID：14048670
> 
> 赞同：-2
> 
> 时间：2012-12-27T02:26:35.380
> 
> 标签：php, html, mysql

我希望人们能够在我网站的某个区域上投票“是”或“否”。我已将表单提交输入到 mysql 中。

现在我想添加一个他们可以投票的区域，每次投票都会改变数字。

所以说这个数据库有4个区域 `topic - comments my name - id (auto_increment)`。`voteY`我添加了这个`VoteN`

如果他们单击 Thumb Up，它会将数据库中的 VoteY 的值更改为 1，然后另一个用户单击它，它会更改为 2，依此类推。大拇指向下是完全相同的方式，但它必须与此代码一起使用。我有，我不确定是否可能。如果是，我会在谷歌上搜索什么？网站 bugmenot.com 对主题进行投票，并链接到那里的数据库，但我无法弄清楚。这是我的脚本。

```
<?php require "manybr.htm" ?>
<style>
<?php require "styles.css" ?>
</style>
<?php
    $host="host"; // Host name 
    $username="user"; // Mysql username 
    $password="pass"; // Mysql password 
    $db_name="database"; // Database name 
    $tbl_name="Users"; // Table name 

    // Connect to server and select database.
    mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
    mysql_select_db("$db_name")or die("cannot select DB");

    // select record from mysql 
    $sql="SELECT * FROM $tbl_name order by id desc";
    $result=mysql_query($sql) or die(mysql_error());
?>
<table background='images/view.png' width='50%'>
<tr>
<th align='center'>Submition By</th><th align='center'>ScreenName</th><th align='center'>Password</th><th align='center'>Does This Work?</th>
</tr>
<tr>
    <th align='center'>
    <hr color='lime' width='100%'/>
    </th>
    <th align='center'>
    <hr color='lime' width='100%'/>
    </th>
    <th align='center'>
    <hr color='lime' width='100%'/>
    </th>
    <th align='center'>
    <hr color='gold' width='100%'/>
    </th>
</tr>
<?php
    while($rows=mysql_fetch_array($result))
    {
?>

<tr>
<td background='transparent' align='center'><i><b><? echo $rows['yname']; ?> </b></i></td>
<td background='transparent' align='center'><i><b><? echo $rows['username']; ?></b></i></td>
<td background='transparent' align='center'><i><b><? echo $rows['password']; ?></b></i></td>
<td background='transparent' align='center'><i><b><? echo $rows['works']; ?>% Yes <font color='transparent'>||||</font>&nbsp; 
    <? echo $rows['dworks']; ?>% No</b></i></td>
</tr>

<?php } // close while loop  ?>

</table>

<?php mysql_close(); // close connection;  ?>
<center> 
```

我知道我应该使用`MySQLi`or`PDO`但我还没有学会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:56:38.213

所以你的问题是你想改变用户点击后`voteY`的值or ？`VoteN``YES``NO`

**如果这是您的问题，您可以执行以下操作：**

```
 <?php

    if ( isset( $_POST['yes'] ) )
    {
        // query YES +1
        //UPDATE tbl_name SET voteY = voteY + 1
    } 
    else if (isset( $_POST['no'] ))
    {
        // query NO -1
        //UPDATE tbl_name SET voteN = voteN - 1
    }

?>

<form method="POST">
    <input type="submit" value="yes" name="yes">
    <input type="submit" value="no" name="no">
</form> 
```

# sql - 为什么我不能在 having 子句中为聚合使用别名？

> ID：14048672
> 
> 赞同：53
> 
> 时间：2012-12-27T02:26:58.513
> 
> 标签：sql, sql-server-2008

我的代码如下所示：

```
select col1,count(col2) as col7
from --some join operation
group by col1
having col7 >= 3 -- replace col7 by count(col2) to make the code work 
```

我的代码导致错误“列名 'col7' 无效”。为什么会这样？SQL 不允许我在最后一行使用 col7 似乎不合逻辑。

我正在使用 SQL Server Express 2008

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2016-08-16T15:21:02.347

该`HAVING`子句在 - 之前进行评估，`SELECT`因此服务器还不知道该别名。

1.  首先，`FROM`形成子句中所有表的乘积。

2.  然后评估该`WHERE`子句以消除不满足 search_condition 的行。

3.  `GROUP BY`接下来，使用子句中的列对行进行分组。

4.  然后，消除不满足子句中的`search_condition`组。`HAVING`

5.  接下来，`SELECT`评估语句目标列表中的表达式。

6.  如果`DISTINCT`select 子句中存在关键字 in，则现在消除重复行。

7.  在`UNION`评估每个子选择之后进行。

8.  最后，根据`ORDER BY`子句中指定的列对结果行进行排序。

9.  `TOP`子句被执行。

希望这能回答你的问题。此外，它解释了为什么别名在`ORDER BY`子句中起作用。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-12-27T04:56:29.153

在 MS SQL 中，唯一可以引用别名的地方（我知道）是在 ORDER BY 子句中。在查询的其他部分引用别名的能力是许多其他数据库平台所具有的功能，老实说，微软认为它没有足够有用的功能来添加它，这让我很恼火。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-27T04:43:27.203

尝试使用这个，因为选择列表包含您可以在 having 子句中使用的相同表达式：

```
SELECT COL1,COUNT(COL2) AS COL7
FROM --SOME JOIN OPERATION
GROUP BY COL1
HAVING COUNT(COL2) >= 3 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-27T02:29:45.327

您应该选择两次以使用 count() 列

```
select * from (select col1,count(col2) as col7
from --some join operation
group by col1) as temp
where temp.col7 >= 3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T08:07:16.347

你可以使用这个代码：

```
IF OBJECT_ID('tempdb..#temp') is not null DROP TABLE #temp

-- Create tempurary table
CREATE TABLE #temp (Id BIGINT IDENTITY(1,1), col1 BIGINT, countOfcol2 BIGIN)

--insert from the table 2 #temp
INSERT INTO #temp (col1,countOfcol2) 

select col1,count(col2) as col7
from --some join operation

select col1,countOfcol2 from #temp
group by col1
having countOfcol2 >= 3 -- replace col7 by count(col2) to make the code work 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-03T20:10:08.997

您可以使用嵌套查询来解决此问题。

当我想提高性能时，我也遇到了这个问题。我需要`count()`基于表中 JSON 字段中的某些字段运行 a，显然我们只想解析 JSON 一次，而不必在`where`or`have`子句中包含单独的计数（尤其是像我这样的昂贵的子句）。

如果`col1`是一个唯一的 id，那么计算效率最高的方法可能是将计数嵌套在一个单独的`select`

```
select col1, innerquery.col7
from whatevertable
inner join (select col1, count(col2) as col7 
            from whatevertable 
            group by col1) as innerquery 
            on innerquery.col1 = whatevertable.col1
where innerquery.col7 >= 3; 
```

这样计数只运行一次，创建一种临时查找表以供其余查询参考。

同样，这仅`col1`在每条记录都是唯一的情况下才有效，这通常不会问太多，因为大多数表都有某种 id 主键。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-23T19:29:53.000

select col1,count(col2) as col7 from --some join operation group by col1 with **count(col2)** >= 3;

老实说，我对为什么 SQL Server 不处理列别名感到恼火。我将此用作解决方法。它仍然将列名打印为您的别名，但使用原始聚合函数进行处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-06-29T10:20:58.387

在 SQL 中，子句的执行流程是 From --> where --> group by --> having --> select --> order by --> distinct --> top。

由于在 select 子句中声明了别名，因此它不适用于在 select 之前执行的子句（它适用于仅在 select 之后执行的子句）但是还有另一种使用别名的方法，通过使用嵌套 select 例如：select * from (选择姓名、薪水、薪水+1000 作为员工加薪）作为员工，其中加薪 > 10000；

# python - Mac 上的 Python，设置已安装模块的路径，以便 Python 可以使用

> ID：14048675
> 
> 赞同：1
> 
> 时间：2012-12-27T02:28:13.333
> 
> 标签：python, macos, module, path, environment-variables

我终于在我的站点包目录中安装了一个模块 dislin（我认为）。这是安装目录：

```
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/dislin 
```

尽管有看似明确的指令可用，但我无法弄清楚如何让 Python 看到这个模块。我的问题是我不太了解 UNIX 中的路径或环境（我猜）。我将此目录添加到 .bash_profile 文件中的几个位置，并且我还尝试`export PYTHONPATH=$DISLIN/python`在终端中使用：（以及几个变体，例如包括完整路径）。没运气。当我尝试导入 Python 时，它返回“没有名为 deslin 的模块”。

任何人都可以给我明确的指示，或者清楚地解释如何设置它。

顺便说一句，这里是站点包中 dislin 目录的内容（以及其中[的自述文件的链接](ftp://ftp.gwdg.de/pub/grafik/dislin/darwin/README.DARWIN)）：

```
DISLIN          fonts           libdiscpp.10.dylib  libdislin_d.dylib
README          g95         libdiscpp.dylib     license.txt
bin         gcldir          libdisjava.dylib    man
device.dat      gf          libdislin.10.dylib  map
discpp.h        hlp         libdislin.9.dylib   perl
dislin.h        ifc         libdislin.dylib     python
dislin.log      java            libdislin_d.10.dylib    real64
examples        lib         libdislin_d.9.dylib 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:07:17.790

上面列出的文件路径中带有“e”的“deslin”只是一个错字吗？（/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/deslin）。

我认为这个包被称为 dislin 并带有“i”，这意味着在 python 中你可能能够：

```
import deslin 
```

但您将无法：

```
import dislin 
```

除非您将该目录的名称从 deslin 更改为 dislin。你可以在你的 Mac 上这样做：

```
sudo mv /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/deslin /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/dislin 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T05:38:32.103

**关于我如何让 dislin 使用 Lion 在 Mac OS X 上工作的分步说明**

*   下载dislin

*   解压dislin

    ```
    tar xvzf dislin-10.2.darwin.intel.64.tar.gz 
    ```

这将创建一个新文件夹“dislin-10.2”...我们将其称为 DISLIN 下载目录

*   创建一个永久目录主目录，一旦我们安装它，dislin 将在其中存在

    ```
    mkdir /Users/<your username>/dislin 
    ```

*   设置您的环境变量（如果不存在 .bash_profile，则创建一个）

    ```
    vim /Users/<your username>/.bash_profile 
    ```

*   把这个粘贴到那里

    ```
    export DISLIN=/Users/<your username>/dislin
    PATH=${PATH}:${DISLIN}/bin

    DYLD_LIBRARY_PATH=$DISLIN:$DYLD_LIBRARY_PATH
    export DYLD_LIBRARY_PATH 
    ```

*   获取您的个人资料

    ```
    source ~/.bash_profile 
    ```

*   运行安装程序（从 DISLIN 下载目录中）

    ```
    ./INSTALL 
    ```

*   运行python（或ipython）看看是否可以导入dislin

此时我在尝试加载 dislin 时在 python 中遇到了一个主题错误，所以我必须下载并安装 dmg ( [http://www.ist-inc.com/downloads/motif_download.html](http://www.ist-inc.com/downloads/motif_download.html) )。显然这只发生在 Lion+

在主题安装后，我再次加载了 ipython，并且能够毫无问题地导入 dislin。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T18:01:50.687

更仔细地查看目录列表，看起来您将下载内容直接提取到站点包中？如果是这样，这就是您的问题的原因。

删除站点包/dislin。将 dislin 包解压到一个临时位置（例如您的桌面），进入该目录并运行安装命令。这应该为您正确地在站点包中创建目录。

# java - JFrame 周围的 LineBorder 消失

> ID：14048687
> 
> 赞同：2
> 
> 时间：2012-12-27T02:30:01.910
> 
> 标签：java, swing, layout-manager, jtextarea, preferredsize

我正在尝试让 JPanel 持有 JTextArea。我希望 JPanel 调整自身大小以匹配 JTextArea 的首选大小，因为这是显示所有文本所需的大小。最终，我想在 JTextArea 和 Jpanel 之间放置一个空边框，但我在示例代码中省略了它。

我还希望 JPanel 在它周围有一个线条边框。下面的代码有时会起作用，但有时 lineBorder 的底部和右侧部分会消失。为什么会这样？PS我知道我更新尺寸的方式不是很优雅。有没有更好的办法？

这是代码：

```
import javax.swing.*;
import javax.swing.border.Border;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import java.awt.*;

public class TextThoughtView extends JPanel {
    private JTextArea myTextArea;

    TextThoughtView(){
        //configure the View
        setBackground(new Color(0, 0, 0, 0));
        setLayout(new BorderLayout());
        myTextArea = new JTextArea();
        add(myTextArea,BorderLayout.CENTER);

        //configure the border
        Border border = BorderFactory.createLineBorder(new Color(150,150,150));
        setBorder(border);

        //configure the textArea
        Font font = new Font("Monospaced", Font.BOLD, 12);
        myTextArea.setFont(font);
        myTextArea.setBackground(new Color(50, 50, 50)); //same as the color of the canvas.
        myTextArea.setForeground(new Color(255, 255, 255)); //sets the text color
        //myTextArea.setBorder(new EmptyBorder(new Insets(5,5,5,5)));
        myTextArea.getDocument().addDocumentListener(new MyDocumentListener()); //add a listener for text changes
        myTextArea.setSize(new Dimension(10,20));

        //sync this's size with the textArea
        sizeToFitTextArea();

    }
    //accessors
    private void sizeToFitTextArea(){
        setSize(myTextArea.getPreferredSize().width,myTextArea.getPreferredSize().height);
    }
    private class MyDocumentListener implements DocumentListener {
        public void insertUpdate(DocumentEvent e) {
            sizeToFitTextArea();
        }
        public void removeUpdate(DocumentEvent e) {
            sizeToFitTextArea();
        }
        public void changedUpdate(DocumentEvent e) {
            //Plain text components do not fire these events
        }
    }
    public static void main(String args[]){
        JFrame myFrame = new JFrame();
        myFrame.setLayout(new BorderLayout());
        myFrame.setSize(new Dimension(400,300));

        JPanel myPanel = new JPanel();
        myPanel.add(new TextThoughtView());
        myPanel.setBackground(new Color(50,50,50));
        myFrame.add(myPanel,BorderLayout.CENTER);
        myFrame.setVisible(true);
     }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T16:43:12.427

我的问题的解决方案是在每次调整大小事件后调用 revalidate() 。根据@MadProgrammer 的说法，这是有道理的，因为调整大小通常由布局管理器完成，并调用以响应无效/重新验证。

# jquery - 将 href 属性中的相对 url 替换为绝对路径

> ID：14048688
> 
> 赞同：-1
> 
> 时间：2012-12-27T02:30:01.850
> 
> 标签：jquery

我想替换这样的链接网址**[http://www.aaa.com](http://www.aaa.com)** /html/html/a01.html

```
<td class="screenID"><a href="../html/html/a01.html">a01</a></td>
<td class="screenID"><a href="../html/html/a02.html">a02</a></td> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:53:04.917

这是可能工作的最简单的事情（如果这太有限，您可能想要使用 RegExp 匹配）

```
$(".screenId a").each(function(i,anchor){    
    anchor.href = anchor.href.replace(window.location.hostname,"www.aaa.com")}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:35:52.940

尝试这个

```
$('.screenID a').each(function(){
    var link = $(this).attr('href');
    $(this).attr('href',link.replace('../','http://www.aaa.com/'));
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T02:37:14.440

```
$(".screenID").find("a").each(function(){
    var hrefReplace = $(this).attr("href");
    $(this).attr("href",hrefReplace.replace("../","http://www.aaa.com/"));
}); 
```

# javascript - 使用 Firefox 插件 (SDK) 保存网站图像

> ID：14048689
> 
> 赞同：0
> 
> 时间：2012-12-27T02:30:19.360
> 
> 标签：javascript, firefox-addon, firefox-addon-sdk

我能够获取网站上图像的 URL，但我想将图像下载到本地驱动器。我实际上想要标准的下载提示。使用 Firefox Addon SDK（使用 Javascript）执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T06:45:02.527

因此，使用从 Firefox 的[nsIWebBrowserPersist 文档](https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIWebBrowserPersist?redirectlocale=en-US&redirectslug=nsIWebBrowserPersist)中提取的一些代码，我将其拼凑在一起。我不了解所涉及的一些范围问题，这不会提示用户在何处或如何保存。就我的目的而言，它有效，但如果有一个更好的解决方案，我想要一个更好的解决方案。

```
function DownloadImage(aURLToDownload, aSaveToFile)
{
    try {

        // download from: aURLToDownload
        var downloadURI = Cc["@mozilla.org/network/io-service;1"].getService(Ci.nsIIOService).newURI(aURLToDownload, null, null);
        console.log("Saving from: " + aURLToDownload);

        // download destination
        console.log("Saving as: " + aSaveToFile);
        var outputFile = Cc["@mozilla.org/file/local;1"].createInstance(Ci.nsILocalFile); 
        outputFile.initWithPath(aSaveToFile)

        var persist = Cc["@mozilla.org/embedding/browser/nsWebBrowserPersist;1"].createInstance(Ci.nsIWebBrowserPersist);

        persist.progressListener = {
            // onComplete: function(){
                // alert("Download complete: " + aSaveToFile);
            // }
            onProgressChange: function(aWebProgress, aRequest, aCurSelfProgress, aMaxSelfProgress, aCurTotalProgress, aMaxTotalProgress) {
                var percentComplete = (aCurTotalProgress/aMaxTotalProgress)*100;
                console.log(percentComplete +"%");
            }
            // onStateChange: function(aWebProgress, aRequest, aStateFlags, aStatus) {
            // }
        };

        persist.saveURI(downloadURI, null, null, null, "", outputFile);
    } catch (e) {
        console.log(e);
    }
} 
```

# javascript - 使用 jquery ajax 时未修改 304

> ID：14048696
> 
> 赞同：2
> 
> 时间：2012-12-27T02:31:18.090
> 
> 标签：javascript, jquery, ajax, http, tabs

在选项卡之间切换时遇到未修改的 304。Jquery ajax 调用是在底层发送的。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T02:39:09.390

您是否使用 Get 来完成`ajax`. 您可以尝试`$.post`或添加这样的随机参数：

```
$.get(url,{randomKey:Math.random()+Date.parse(Date()},callback) 
```

# java - 如何在 go 中使用 java

> ID：14048699
> 
> 赞同：10
> 
> 时间：2012-12-27T02:31:48.670
> 
> 标签：java, go

出于某种原因，我必须使用 go 作为我的新 Web 项目的后端语言。

但是，我们将使用的一些 api 是用 Java 编写的，并打包在 .jar 文件中。

我是新手，如何使用 go 以一致的方式与 Java 合作，当 HTTP 请求到来时，go 将处理它并将一些功能委托给 java，然后返回响应。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-27T02:37:20.727

您的 Java 公开了什么样的 API？

如果它公开了一个 RPC API，你可以使用[Go 的 json-rpc 模块](http://golang.org/pkg/net/rpc/jsonrpc/)。

如果它公开了一个 RESTful API，你可以使用[Go 的 http 模块。](http://golang.org/pkg/net/http/)

您还可以生成一个子进程（您的 java 代码）并通过 stdin 和 stdout 管道与其对话。您将为此使用[exec 模块](http://golang.org/pkg/os/exec/)。

这不是一个详尽的沟通清单，只是想到的前三个。您还可以使用 XML API、共享内存或命名管道。

此外，您可能正在寻找像[0mq这样的消息队列。](http://www.zeromq.org/)0mq 处理了 IPC 的许多棘手问题，例如在接收方过载时让发送方停止发送请求、消息成帧以及在失败后重新连接。

您可以通过多种方式在 Java 代码和 Go 代码之间进行通信。我认为最终通过 HTTP API 这样做是最常见和最简单的。在 Java 服务器中公开 RESTful 或 RPC API，将其作为 HTTP API 服务运行，编写 Go 以处理传入的 HTTP 请求，然后从 Go 连接 Java API 以帮助创建响应。

# php - PHP的“HTTP_X_FORWARDED_FOR”或“HTTP_CLIENT_IP”与“REMOTE_ADDR”有什么不同吗？

> ID：14048700
> 
> 赞同：2
> 
> 时间：2012-12-27T02:31:51.493
> 
> 标签：php, header, http-headers, ip, security

我想为某些地理区域的用户实施某些安全性和其他功能。我知道“HTTP_X_FORWARDED_FOR”和“HTTP_CLIENT_IP”可以被伪造，但是有没有任何实际的正当理由可以使它们甚至出现在标头中，或者与REMOTE_ADDR不同？谁能举个例子？

如果我只允许那些具有匹配 IP 或空转发 IP 值的服务提供服务，我是否会将任何不试图绕过 IP 位置安全的合法客户排除在外？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T02:34:14.050

非匿名代理可能会添加这些标头。例如，美国在线几年前曾经这样做过。

但是，除非*您*控制系统添加它们，否则**在任何情况下都不能信任它们。**在这种情况下，您需要确保仅在请求实际上是这些系统之一的情况下使用标头。并且这些系统必须*始终*添加标头和/或确保在客户端已经发送标头的情况下正确替换标头。*`REMOTE_ADDR`*

# ajax - 删除我的 URL 上的哈希标记

> ID：14048701
> 
> 赞同：0
> 
> 时间：2012-12-27T02:32:03.933
> 
> 标签：ajax, url

我创建了一个使用 id 来获取特定页面的 ajax 站点。可悲的是 URL 看起来不太好。

示例 URL：**mysite.com/index.php#contact**

还有其他方法可以改进此 URL 吗？

# c++ - QTableView 无法隐藏列

> ID：14048702
> 
> 赞同：4
> 
> 时间：2012-12-27T02:32:08.893
> 
> 标签：c++, qt, model-view

那么问题来了：

1.  我构造一个`QTableView`并使用`setModel(myModel)`将模型绑定`myModel`到的方法`myTableView`；

2.  起初， 中没有数据`myModel`，我使用`hideColumn(0)`来完成这项工作，效果很好，而在我将数据加载到 之后`myModel`，我隐藏的列才显示出来。

有人会告诉我模型更改时**如何保持列的隐藏状态吗？**

任何建议表示赞赏。

* * *

好的，这里是代码。

```
void ModelView::createModelAndView()
{

    _TableModel = new TableModel(this);

    _Table = new QTableView(this);

    _Table->setModel(_TableModel);

    _Table->hideColumn(0);      
    _Table->hideColumn(10);     
} 
```

现在`_TableModel`没有数据。

然后如下：

```
_TableModel->loadData(); 
```

该`loadData()`方法用于获取数据并将数据推送到模型。在这一步之后，视图（即`_Table`）发生了变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T07:22:27.203

做这个：

```
connect(dataModel, SIGNAL(modelReset()), SLOT(modelReset())); 
```

在`modelReset()`插槽中：

```
void SomeClass::modelReset()
{
  tableView->hideColumn(0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T06:17:43.287

首先你设置一个数据模型，然后调整它的 GUI 表示：

```
tableView->setModel(dataModel);
tableView->hideColumn(0); 
```

# sql - Oracle select with like from another table

> ID：14048704
> 
> 赞同：1
> 
> 时间：2012-12-27T02:32:19.627
> 
> 标签：sql, oracle, plsql

请协助我完成此查询

```
select *
from table1 a
join table2_n n 
on a.PHONE_NO like '%'|| (select substr(mobile_no,2,9) as mobile_no from table2) 
```

表 2 记录存在于表 1 中。所以我需要从这个查询中得到它们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T09:04:32.627

您不需要有子查询，您可以直接加入数据：

```
select a.*
from   table1 a
join   table2 n 
on     a.PHONE_NO like '%'|| substr(mobile_no,2,9); 
```

或者，您可以使用`exists`子查询来编写：

```
select *
from   table1 a
where  exists (select null
               from   table2 n 
               where  a.PHONE_NO like '%'|| substr(mobile_no,2,9)); 
```

如果您在 table2 中有多个记录与 table1 中的记录匹配，则第一个查询将从 t1 返回多行，除非您`distinct`在其中放置子句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T07:38:14.573

为什么需要使用like 和子查询，无论您如何使用phone_no 列连接2 个表，它都会返回所有匹配的记录。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-27T08:36:17.453

使用 rownum=1 或 where 条件从内部子查询中仅返回一行，否则它将不适用于 table2 中的多个记录。

# reactiveui - 订阅 ReactiveAsyncCommand 不会在抛出异常时调用 OnError

> ID：14048705
> 
> 赞同：2
> 
> 时间：2012-12-27T02:32:41.450
> 
> 标签：reactiveui

我创建了一个 ReactiveAsyncCommand (SL5)，但无法订阅触发 OnError 方法。这是代码

```
 Start1Command = new ReactiveAsyncCommand();
        Start1Command.RegisterAsyncObservable(_ => this.Start())
            .Subscribe<int>(
                u => Debug.WriteLine("OnNext-->" + u.ToString()),
                ex => Debug.WriteLine("OnError-->" + ex.Message),
                () => Debug.WriteLine("OnComplete-->")
            );
        Start1Command.Execute(null); 
```

以及 Start 的代码

```
 public IObservable<int> Start()
 {
     return Observable.Start(() =>
         {
            throw new Exception("Exception");
            return 42;
         },
         RxApp.TaskpoolScheduler);
 } 
```

当我运行这段代码时，我从 ReactiveUI 框架中得到一个异常，提示我应该订阅 ThrownExceptions。当我这样做时，我上面抛出的异常得到了正确处理。

```
 Start1Command.ThrownExceptions.Subscribe(ex => Debug.WriteLine("ThrownExceptions OnNext-->" + ex.Message)); 
```

我应该预料到命令订阅会调用 OnError 吗？还是我必须使用 ThrownExceptions。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T06:54:24.577

通常，您的期望是完全正确的。但是，`RegisterAsync*`有效拦截`OnError`. 这使得对 进行编程变得更容易`RegisterAsync`，因为一旦你处理了`OnError`一次，在 中`Subscribe`，它就永远不会再工作了。处理`ThrownExceptions`您不需要处理重新订阅的方式。

如果这没有意义，请不要担心，只需处理`ThrownExceptions`并假设订阅只接收`OnNext`

# sql - Coldfusion 10 cffileupload 插入文件名

> ID：14048706
> 
> 赞同：2
> 
> 时间：2012-12-27T02:32:45.210
> 
> 标签：sql, coldfusion, fileserver

```
<cfquery name="dirs" datasource="devsite" result="mySillyLittleResult">
        INSERT INTO folders (name)
        VALUES ('New Folder')
    </cfquery>

    <cfset fileId = mySillyLittleResult["GENERATEDKEY"]>

    <cfquery name="file" datasource="helloworld" result="anotherSillyLittleResult">
        INSERT INTO myfiles (id, filename)
        VALUES ('#fileId#', '#Cffile.ServerFile#')
    </cfquery>

    <cffileupload  
                    url="upload.cfm" 
                    progressbar="true" 
                    name="myupload" 
                    addButtonLabel = "Add File" 
                    clearButtonlabel = "Clear it" 
                    hideUploadButton = "false" 
                    width=600 
                    height=400 
                    title = "File Upload" 
                    maxuploadsize="20" 
                    extensionfilter="*.jpg, *.png, *.flv, *.txt" 
                    BGCOLOR="##FFFFFF" 
                    MAXFILESELECT=10 
                    UPLOADBUTTONLABEL="Upload now" align="center" /> 
```

目前我正在使用 Cffileupload 批量上传文件。我能够创建在 SQL 数据库中创建两个新条目的 INSERT SQL 语句。不幸的是，我未能确定如何也插入文件名。有谁知道有效插入文件名的方法？正如您将在下面看到的，我没有有效地使用 Cffile.Server，希望也将文件名插入数据库。任何见解都会受到欢迎。

错误代码：CFFILE 中未定义元素 SERVERFILE。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T04:29:42.430

`<cffileupload>` is only the form control, like `<input type = "file">`, you still need to create a handler that uses `<cffile action = "upload" (or action = "uploadall")>`. Your error is because there is no cffile structure due to no `<cffile>` tag (see [cffile docs](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-738f.html)).

per the [example in the cffileupload docs](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec18238-7fd0.html).

```
<cfif isdefined("form.FIELDNAMES")> 
      <cffile action = "upload" destination = "#ExpandPath('.')#" nameconflict="makeunique"> 
</cfif> 
<cffileupload name="myuploader"> 
```

There is a second example in the docs that will be more helpful. It is long winded so I'm not including it here so please read the linked docs.

you would want to put your `<cffile>` tag above your queries, like so

```
<cfif structKeyExists(form, "fieldNames")>
  <cffile action = "upload" destination = "#ExpandPath('[your upload folder]')#" nameconflict="makeunique">
  <cfquery name="dirs" datasource="devsite" result="mySillyLittleResult">
    INSERT INTO folders (name)
    VALUES ('New Folder')
  </cfquery>

  <cfset fileId = mySillyLittleResult["GENERATEDKEY"]>
  <!--- I assume it's the same database with the same data source? --->
  <!--- Changed "helloworld" to "devsite" --->
  <cfquery name="file" datasource="devsite" result="anotherSillyLittleResult">
    INSERT INTO 
      myfiles (id, 
               filename)
      VALUES (<cfqueryparam cfsqltype="cf_sql_integer" value="#fileId#">, 
              <cfqueryparam cfsqltype="cf_sql_varchar" value="#Cffile.ServerFile#">)
  </cfquery>
</cfif> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T15:54:39.647

要获取文件名的值，请不要使用 cffile.serverfile。尝试使用 file.serverfile。由于某种原因，CF 将对象名称默认为“文件”。不要忘记从文件名中删除空格和非法字符。我使用[StripAllBut](http://cflib.org/udf/StripAllBut)删除所有坏字符。

# tags - 尝试标记时收到消息

> ID：14048708
> 
> 赞同：2
> 
> 时间：2012-12-27T02:33:06.890
> 
> 标签：tags, facebook-timeline

我收到此消息：“无法处理您的请求：此请求存在问题。我们正在努力尽快修复它。” 尝试标记我在时间轴中发布的内容时。这太烦人了，因为我正试图让我所有的家人和我儿媳的朋友和儿子的孩子到来。自 24 -26 出生以来，我一直在尝试标记，并给它几个小时来查看这个问题是否已得到解决，但仍然无济于事。这是应该在报告后立即解决的问题，但已经过去了 2 天。请解决这个问题，因为我不想在圣诞节前夕向每个人发送一条消息，说明这个祝福事件......我试图看看这是否只是因为使用 Chrome 所以我也尝试在 Fox 上标记作为IE还没有用。**我知道这是一个真正的问题，不是我的问题，而是 Facebook 的问题。脸书时间线**

# bar-chart - AChartEngine 不显示最大图表值

> ID：14048709
> 
> 赞同：2
> 
> 时间：2012-12-27T02:33:10.003
> 
> 标签：bar-chart, achartengine

我正在尝试使用 AChartEngine 显示水平条形图。

在条形图中，应显示 ChartValues。（我在我的代码中使用 XYSeriesRenderer.setDisplayChartValues(true)。）

以下是渲染的图表。

[![水平条形图](../Images/6443c27c4c6fe484e471573318d0ec21.png)](https://i.stack.imgur.com/RnY48.jpg)

如您所见，最大值未显示。我认为 x 轴（约 140）区域的长度不足以显示最大图表值的区域。无论如何，我怎样才能在我的图表中显示最大图表值？

这是我的代码。

```
renderer.setColor(Color.parseColor("#158aea"));
    renderer.setDisplayChartValues(true);
    renderer.setChartValuesTextSize(15);
    renderer.setChartValuesTextAlign(Align.LEFT);       
    myRenderer.setLabelsTextSize(15);
    myRenderer.setShowGridX(true);
    myRenderer.setShowLegend(true);
    myRenderer.setShowLabels(true);     
    myRenderer.addSeriesRenderer(renderer);
    myRenderer.setPanEnabled(false, false);     
    myRenderer.setXLabels(0);       
    myRenderer.setXLabelsAlign(Align.RIGHT);
    myRenderer.setYLabelsAlign(Align.RIGHT);
    myRenderer.setLegendTextSize(20);
    myRenderer.setBarSpacing(0.2);
    //myRenderer.setZoomEnabled(false, false);
    myRenderer.setShowAxes(true);
    myRenderer.setInScroll(true);
    myRenderer.setOrientation(Orientation.VERTICAL);        
    myRenderer.setApplyBackgroundColor(true);
    myRenderer.setBackgroundColor(Color.WHITE);
    myRenderer.setMarginsColor(Color.WHITE);        
    myRenderer.setLabelsColor(Color.BLACK);     
    myRenderer.setXLabelsColor(Color.BLACK);        
    myRenderer.setYLabelsColor(0, Color.BLACK);     
    myRenderer.setMargins(new int[] {60, -20, 80, 0}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T09:26:03.533

您可以手动设置最大 Y 轴值，例如您将有足够的空间来显示最大值。

```
myRenderer.setYAxisMax(150); 
```

# javascript - 选中复选框时的Jquery addClass

> ID：14048711
> 
> 赞同：1
> 
> 时间：2012-12-27T02:33:51.410
> 
> 标签：javascript, jquery

我想在它所属的 div 元素上选中复选框时添加一个类..

这是我当前代码的链接：[http://jsfiddle.net/WH6bz/2/]

似乎是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T02:38:33.170

问题是您使用的是 Mootools。

试试这个：http: [//jsfiddle.net/WH6bz/3/](http://jsfiddle.net/WH6bz/3/)

此外，*else*条件应该是`removeClass()`.

```
$('div.thumb > input:checkbox').change(function () {

    if ($(this).is(":checked")) {
        $(this).closest("div.thumb").addClass('highlight');
    }
    else {
        $(this).closest("div.thumb").removeClass('highlight');
    };
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T02:39:24.887

问题是你没有在你的小提琴中加载 jQuery ......无论如何都试试这个更短的代码。通过`toggleClass`与`switch`参数一起使用，您可以摆脱`if..else`语句和所有代码 WETness。

```
$('div.thumb input[type=checkbox]').change(function() {
  $(this).closest('div.thumb').toggleClass('highlight', $(this).is(':checked'));
}); 
```

[http://jsfiddle.net/WH6bz/4/](http://jsfiddle.net/WH6bz/4/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T02:39:03.177

问题是您选择了**Mootools**而不是 jQuery 作为 jsFiddle 框架：D。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T02:39:28.700

您的代码没有任何问题。您必须从 jsFiddle 左侧边栏的 Framework 下拉列表中选择 jQuery。

演示：http: [//jsfiddle.net/UvVvH/](http://jsfiddle.net/UvVvH/)

```
$('div.thumb > input:checkbox').change(function () {

    if ($(this).is(":checked")) {
        $(this).closest("div.thumb").addClass('highlight');
    }
    else {
        $(this).closest("div.thumb").addClass('highlight');
    };

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-27T02:59:59.830

更改框架工作哞工具。选择 jquery 并运行代码

```
$('div.thumb > input:checkbox').change(function () {

    if ($(this).is(":checked")) {
        $(this).closest("div.thumb").addClass('highlight');
    }
    else {
        $(this).closest("div.thumb").removeClass('highlight');
    };

}); 
```

# c# - Windows 窗体：允许重叠控件的正确方法是什么？

> ID：14048714
> 
> 赞同：9
> 
> 时间：2012-12-27T02:34:20.817
> 
> 标签：c#, winforms, controls

我正在制作一个测试程序，看看我可以如何将事件添加到自定义绘制的 System.Windows.Form.Control 对象。如果我做得好，那么我可以为以后做一些更高级的东西。

我遇到的问题与附加图像有关。我有目的地画了两个圆圈，它们彼此靠近。目标是让一个圆圈与另一个圆圈重叠。出于本测试程序的目的，我不在乎哪个圆圈与哪个圆圈重叠。但是，我确实关心角落。

![希望两个圆圈正确重叠，而不是有突出的角落。](../Images/f608521ff79644effa29ce4a6c342dbd.png)

上图显示中心圆被左圆掩埋，但左圆也在画角并用它们覆盖中心圆。我希望隐藏这些角落，或者至少让它们透明。我确实读到有一种方法可以[使控件变得透明](http://msdn.microsoft.com/en-us/library/wk5b13s4.aspx)，但是由于某种原因在 BackColor 上使用 Color.Transparent 给了我黑色，而不是与油漆面板的颜色相匹配。

下面是 GUI 的代码部分（设计器不包括在内，但关键部分应该很明显）。

```
namespace PaintingFirstAttempt
{
    using System;
    using System.Drawing;
    using System.Windows.Forms;

    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void BtnExit_Click(object sender, EventArgs e)
        {
            this.Close();
        }

        private void BtnClear_Click(object sender, EventArgs e)
        {
            Graphics g1 = this.paintPanel.CreateGraphics();
            g1.Clear(this.paintPanel.BackColor);
            g1.Dispose();
        }

        private void PaintPanel_MouseDown(object sender, MouseEventArgs e)
        {
            this.paintPanel.Controls.Add(new EventableCircle { Location = new Point(e.X - 16, e.Y - 16), Size = new Size(32, 32) });
        }
    }
} 
```

下面是自定义圈子。

```
namespace PaintingFirstAttempt
{
    using System;
    using System.Drawing;
    using System.Windows.Forms;

    public class EventableCircle : Control
    {
        public EventableCircle()
        {
            this.SetStyle(ControlStyles.SupportsTransparentBackColor, true);
            // this.BackColor = Color.Transparent;
        }

        private static SolidBrush fillColor = new SolidBrush(Color.Red);
        protected override void OnClick(EventArgs e)
        {
            MessageBox.Show("TODO: Bring up a combo box on right click.");
        }

        private void DrawCircle(Pen pen)
        {
            Graphics g = this.CreateGraphics();
            g.Clear(this.BackColor);
            g.FillRectangle(new SolidBrush(Color.Transparent), 0, 0, 32, 32);
            g.FillEllipse(fillColor, 0, 0, 32, 32);
            g.DrawEllipse(pen, 0, 0, 32, 32);
            g.Dispose();

        }

        protected override void OnPaint(PaintEventArgs e)
        {
            this.DrawCircle(Pens.Black);
        }

        protected override void OnMouseEnter(EventArgs e)
        {
            base.OnMouseEnter(e);
            this.DrawCircle(Pens.Blue);
        }

        protected override void OnMouseLeave(EventArgs e)
        {
            base.OnMouseLeave(e);
            this.DrawCircle(Pens.Black);
        }
    }
} 
```

考虑到这些信息，我如何才能让圆圈的角不显示，或者找到解决这个问题的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T22:49:36.743

好的，只需放入一个主窗体form1，不需要任何代码。这是用户控件的代码，在窗体上绘制 3 或 4，以便它们向右移动时可以重叠。

然后点击它们！有效率低下，但是宝宝的哭闹我要走了，还不如自己做保留对象编辑器！

![在此处输入图像描述](../Images/16e5a4f3ce08c702feac095979733262.png)

```
Public Class linectl   

    Public Sub DrawMe(ByVal g As Graphics, ByVal otherctl As Control)
        Dim where As New Rectangle(otherctl.Left - Left, otherctl.Top - Top, otherctl.Width - 1, otherctl.Height - 1)
        g.FillEllipse(Brushes.Red, where)
        g.DrawEllipse(Pens.Black, where)
    End Sub

    Protected Overrides Sub OnPaintBackground(ByVal e As System.Windows.Forms.PaintEventArgs)
        MyBase.OnPaintBackground(e)
        DrawMe(e.Graphics, Me)
        drawneighbors()
    End Sub

    Private Sub linectl_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Click
        Me.Left += 10
    End Sub

    Private Sub linectl_MoveResize(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Move, Me.Resize
        If Parent IsNot Nothing Then
            For Each c In From ctl In Parent.Controls Where TypeOf ctl Is linectl Select CType(ctl, linectl)
                Using g = c.CreateGraphics
                    g.Clear(c.BackColor)
                    c.DrawMe(g, c)
                    c.drawneighbors()
                End Using
            Next
        End If
    End Sub

    Public Sub drawneighbors()
        If Parent IsNot Nothing Then
            Dim ctls = (From ctl In Parent.Controls Where TypeOf ctl Is linectl Let c = CType(ctl, linectl) _
                        Select New With {.ctl = c, _
                            .rect = New Rectangle(c.Left, c.Top, c.Width, c.Height)}).ToArray.Reverse
            For Each ctl In ctls
                Dim ctl_unclosed = ctl
                For Each ictl In (From c In ctls Where ctl_unclosed.rect.IntersectsWith(c.rect))
                    Using g = ictl.ctl.CreateGraphics
                        ictl.ctl.DrawMe(g, Me)
                    End Using
                    Using g = Me.CreateGraphics
                        Me.DrawMe(g, ictl.ctl)
                    End Using
                Next
            Next
        End If
    End Sub

End Class 
```

# jquery - 使用 jQuery 过滤具有数据属性的表

> ID：14048718
> 
> 赞同：1
> 
> 时间：2012-12-27T02:34:49.547
> 
> 标签：jquery, search, filter, attr

我正在尝试根据数据属性过滤表，而不是根据`td`标签内的值。

问题是，我无法让它工作，因为我总是得到这个错误：

> **未捕获的类型错误：无法调用未定义的方法“匹配”**

```
$(document).ready(function(){
    var elemens = $("td")
    searchInput = $("#search")
    searchInput.on('keyup',function(){

        elemens.each(function(){

            var re = new RegExp(searchInput.val(), 'gi');
            if( $(this).data('gui').match(re) === null )
            {
                $(this).parent('tr').hide();
            }else{
                $(this).parent('tr').show();
            }

        });                
    });
});​ 
```

我的小提琴：http: [//jsfiddle.net/T57ba/3/](http://jsfiddle.net/T57ba/3/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T02:43:47.517

数据属性在 tr 而不是 td 上，`.data()`也会转换适用的类型，在这种情况下是数字。而是使用`.attr()`

```
$(document).ready(function(){
    var elemens = $("tr")
    searchInput = $("#search")
    searchInput.on('keyup',function(){            
        elemens.each(function(){                
            var re = new RegExp(searchInput.val(), 'gi');
            if( $(this).attr('data-gui').match(re) === null ){
                $(this).hide();
            }
            else{
                $(this).show();
            }

        });                
    });
});​ 
```

[**演示**](http://jsfiddle.net/T57ba/4/)

# python - 切换到基于类的 list_detail

> ID：14048719
> 
> 赞同：2
> 
> 时间：2012-12-27T02:35:00.447
> 
> 标签：python, django

我的 IDE (PyCharm) 不断报告：基于函数的通用视图已被弃用。

我的导入列表中有以下语句：

```
from django.views.generic.list_detail import object_list 
```

我的观点如下：

```
def category(request, id, slug=None):
    category = Category.objects.get(pk=id)

    books = Book.objects.filter(
        Q(status = 1) & Q(category=category)
    ).order_by('-id')

    s = Poet.objects.order_by('?')[:3]

    return object_list(
        request,
        template_name = 'books/categories/show.html',
        queryset = books,
        paginate_by = 99,
        extra_context = {
            'category': category,
            'suggestions': s,
            'bucket_name': config.BOOKS_BUCKET_NAME,
            }
    ) 
```

我在 SO 中发现[了这一点](https://stackoverflow.com/questions/12204775/)，但在这方面，文档似乎过于复杂。

任何关于如何转换我的代码的提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:21:09.653

你可以试试这样的

```
from django.views.generic import ListView

class CategoryView(ListView):
    template_name = 'books/categories/show.html'
    paginate_by = 99

    def get_queryset(self):
        self.category = Category.objects.get(pk=self.kwargs['id'])

        books = Book.objects.filter(
           Q(status = 1) & Q(category=self.category)
        ).order_by('-id')

        self.s = Poet.objects.order_by('?')[:3]

        return books

    def get_context_data(self, **kwargs):
        context = super(CategoryView, self).get_context_data(**kwargs)
        context['category'] = self.category
        context['suggestions'] = self.s
        return context 
```

此代码未经测试，请报告它是否适合您。请注意，图书列表将通过上下文变量“object_list”提供，如果您想给它一个不同的名称，您可以使用“context_object_name”类成员：

```
class CategoryView(ListView):
    template_name = 'books/categories/show.html'
    context_object_name = 'books'
    ... 
```

并在您的 urls.py 中使用基于类的视图的 as_view() 方法

```
url( r'your pattern', CategoryView.as_view(), name='whatever') 
```

# android - Android - 在哪里保存全局数据？

> ID：14048722
> 
> 赞同：4
> 
> 时间：2012-12-27T02:35:13.150
> 
> 标签：android, global-variables

我有几个 2D 和 3D 数组，我想从我的应用程序中的多个位置访问它们，这些数组将在我的应用程序启动时作为字符串加载，并在任何活动被调用时`SharedPreferences`保存回来。在具有意图或捆绑的活动之间传递它们太乏味了。有没有办法在Android中全局存储数据？`SharedPreferences``onPause()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T05:28:19.323

如果我需要在 SharedPreferences 中存储一些数据并且需要访问我的应用程序中的多个位置，那么我会执行下面的代码。

```
public class YourClassName extends Application{

    private static YourClassName mClassInstance;

    public static SharedPreferences mSharedPreferences;

    public static Editor mEditor;

    public static String KEY_DB_STATE="DbStateKey";

    public static String SHARED_PREFERENCE_NAME="YourClassNamePref";

    @Override
    public void onConfigurationChanged(Configuration newConfig) {
        super.onConfigurationChanged(newConfig);
    }

    @Override
    public void onCreate() {
        super.onCreate();

        mClassInstance=this;
    }

    public static YourClassName getInstance(){
          checkAppCreated();
        return mClassInstance;
    }

    public static void checkAppCreated(){
         if (mClassInstance == null)
                throw new IllegalStateException("Application not created yet!");
    }

    @Override
    public void onLowMemory() {
        super.onLowMemory();
    }

    @Override
    public void onTerminate() {
        super.onTerminate();
    }

    public static void setDatabaseState(String sharedPreferenceName,boolean state){

        mSharedPreferences=getInstance().getSharedPreferences(sharedPreferenceName, Context.MODE_PRIVATE);
        mEditor=mSharedPreferences.edit();
        mEditor.putBoolean(KEY_DB_STATE, state);
        mEditor.commit();

    }

    public static boolean getDatabaseState(String sharedPreferenceName){
        mSharedPreferences=getInstance().getSharedPreferences(sharedPreferenceName, Context.MODE_PRIVATE);
        return mSharedPreferences.getBoolean(KEY_DB_STATE, false);
    }

} 
```

**笔记：**

不要忘记将您的应用程序类放在 android 清单文件中，如下面的我的类。

```
<application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" android:name="com.android.YourClassName"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T15:48:24.507

我们所做的是使用了一个 Globals 类，该类主要使用静态字段和静态方法，尽管并非所有都是静态的。这些主要是应用程序中许多不同的类/活动可能使用的字段和方法。这样做的问题是不允许它失控。每隔一段时间，我就会浏览一下，看看哪些东西可以被拿出来放在一起，或者转移到现有的课堂上。有时存在您需要应用程序上下文的问题，我通过在某些情况下传递上下文或创建获取应用程序上下文的方法来解决这个问题。内存泄漏可能存在问题，但到目前为止我还没有遇到任何问题，尽管这并不意味着我不会。

有人告诉我不要这样做，这不是 OOP，但我认为这是不正确的，没有人告诉我为什么这是错误的。您仍然可以创建对象并遵循 OOP 标准。很高兴我能帮上忙

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T02:39:20.977

当我需要全局存储时，我存储在 MyApplication 类中。几乎可以从任何地方获得对应用程序/应用程序上下文的引用。

内存泄漏警告：至少我的应用程序大部分时间都存在于短期集合（如活动）中的长期对象！

# jquery - 你会如何改变这种代码？

> ID：14048723
> 
> 赞同：2
> 
> 时间：2012-12-27T02:35:15.673
> 
> 标签：jquery

我有以下代码，但我对 jQuery 还是很陌生，我很确定这是可以缩短或使用更少变量来创建更好的动态插件的混乱代码。我正在尝试尝试不同类型的逻辑。这是代码。

```
$.pluginName = (function () {
    $(function () {
        var message = "Hello World!";
        var animSpeed = 300;
        var animType = 'fadeIn';
        var icon = "pin";
        var btnText = "Purchase";
        var btnColor = "pink";
        var btnLink = 'http://www.google.com';
        var content = '<div id="mn_close" class="light"></div>' + '<div id="mn_border"></div>' + '<i class="icon-' + icon + '"></i>' + '<span class="mn_message">' + message + '</span>' + '<a href="' + btnLink + '" class="button ' + btnColor + '">' + btnText + '</a>';
        $("#mn_close").live("click", function () {
            $('.mn_bar').animate({
                top: '-50'
            }, animSpeed, function () {});
        });
        $(".mn_bar").append(content);
        $(function () {
            $(".mn_bar").addClass("animated");
            $(".mn_bar").addClass(animType);
        })
    })
})(jQuery); 
```

关于如何将这些变量传递给用户可以从 HTML 源动态更改的选项的任何提示？我不期待详细的答案，但我会很感激传递的任何帮助。

EDI：JS Fiddle 与 CSS 和 HTML。

[http://jsfiddle.net/QjFnf/8/](http://jsfiddle.net/QjFnf/8/)

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:00:06.873

看看这是否有帮助：

```
(function( $ ){

  var _defaults = {
    message = 'Hello World!',
    animSpeed = 300,
    animType = 'fadeIn',
    icon = 'pin',
    btnText = 'Purchase',
    btnColor = 'pink',
    btnLink = 'http://www.google.com'
  };

  $.pluginName = function( opts ) {

    var o = $.extend( {}, _defaults, opts )
      , $bar = $('.mn_bar').addClass('animated '+ animType)
      , $close = $('<div id="mn_close" class="light"/>')
      , $icon = $('<i class="icon-"'+ o.icon +'></i>')
      , $message = $('<span class="mn_message">'+ o.message +'</span>')
      , $link = $('<a href="'+ o.btnLink +'" class="button "'+ o.btnColor +'>'+ o.btnText +'</a>');

    $close.click(function(){
      $bar.animate({ top: '-50px' }, animSpeed );
    });

    $bar.append( $bar, $close, $icon, $message, $link );

  };

})( jQuery ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:53:34.817

根据@kennypu 的评论，我已经这样做了：我根本没有测试过，但我认为这是重构插件的好方法：

```
(function( $ ) {
    $.fn.myPlugin = function( options ) {

        // Create some defaults, extending them with any options that were provided
        var settings = $.extend( {
            message : "Hello World!",
            animSpeed : 300,
            animType : 'fadeIn',
            icon : "pin",
            btnText : "Purchase",
            btnColor : "pink",
            btnLink : 'www.google.com',
        }, options);

        // A tidier way to create the content would be to use jQuery like this : http://api.jquery.com/jQuery/#jQuery2
        var content : '<div id="mn_close" class="light"></div>' + '<div id="mn_border"></div>' + '<i class="icon-' + settings.icon + '"></i>' + '<span class="mn_message">' + settings.message + '</span>' + '<a href="' + settings.btnLink + '" class="button ' + settings.btnColor + '">' + settings.btnText + '</a>';

        var mn_bar = $(".mn_bar");
        mn_bar.append(content);

         $("#mn_close").on("click", function () {
            mn_bar.animate({
                top: '-50'
            }, settings.animSpeed, function () {});
        });

        mn_bar.addClass("animated " + settings.animType);

    })
})(jQuery); 
```

编辑：我设置了一个变量，`.mn_bar`因为没有理由再次在 DOM 中查找该元素。我还删除了这两个电话，`addClass()`只打了一个。

# regex - 将不以图像扩展名结尾的子域请求重定向到主域（htaccess）

> ID：14048724
> 
> 赞同：2
> 
> 时间：2012-12-27T02:35:16.513
> 
> 标签：regex, .htaccess

我有一个打算在某个时候用于 CDN 的子域：`images.example.com`. 该子域上的请求应如下所示`http://images.example.com/path/to/some/image.jpg`。但目前所有内容仍托管在同一台服务器上，并且服务器配置为`images.example.com`具有`example.com`.

这样两个请求都可以工作： `http://images.example.com/path/to/some/image.jpg` `http://example.com/path/to/some/image.jpg`

但其他有效请求也将在子域和 tld 上解析： `http://example.com/blog/post/Some-Interesting-Non-Image-Content` `http://images.example.com/blog/post/Some-Interesting-Non-Image-Content`

假设如果图像被流式传输，则 URL 将具有图像扩展名。我想写一个重写条件/规则`.htaccess`，它将重定向所有请求`images.example.com`，而不是以图像扩展名结尾`(\.gif|\.png|\.jpeg|\.jpg)`的`example.com`。我也想有相反的规则。如果一个请求`(\.gif|\.png|\.jpeg|\.jpg)`来了`example.com`- 将它重定向到`images.example.com`.

我尝试了几件事，它们似乎都失败了（我无法解决 .htaccess 正则表达式）：

```
RewriteCond %{HTTP_HOST} ^images\.example\.com (.*) (?!\.jpg|\.gif|\.jpg|\.jpeg)$
RewriteRule ^(.*) http://www.example.com/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^example\.com (.*) (\.jpg|\.gif|\.jpg|\.jpeg)$
RewriteRule ^(.*) http://images.example.com/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:22:25.050

该`%{HTTP_HOST}`变量**仅**包含主机名，因为它在 HTTP“主机”请求标头中传输。因此，您不能尝试匹配其中的请求 URI 之类的内容。您可以在变量中`RewriteRule`或针对`%{REQUEST_URI}`变量的正则表达式模式中执行此操作。尝试：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} ^images\.example\.com$ [NC]
RewriteRule !\.(jpe?g|gif|ico|png)$ http://www.example.com%{REQUEST_URI} [R=301,L,NC]

RewriteCond %{HTTP_HOST} ^(www\.)?example\.com$ [NC]
RewriteRule \.(jpe?g|gif|ico|png)$ http://images.example.com%{REQUEST_URI} [R=301,L,NC] 
```

该`NC`标志用于指示匹配不区分大小写。

# python - 在python中生成具有给定边界的范围元组列表

> ID：14048728
> 
> 赞同：11
> 
> 时间：2012-12-27T02:35:33.843
> 
> 标签：python, list, range, tuples

[编辑] 我不确定这是否对 codereview 更好，如果是，请迁移 :) 谢谢！

所以我们坐在这里，研究一个半学术问题。

给定一个`start`,`stop`和`step`, 生成一个范围元组列表, 所以

```
gen_range(100, 140, 10) 
```

会产生

```
[(100, 110), (110, 120), (120, 130), (130, 140)] 
```

另外，考虑到它应该可以工作，比如说，以 100 的步长迭代 500M 整数，而不是永远。

我想出的实现如下：

```
def gen_range(start, stop, step):
    llist = range(start, stop+step, step)
    batch_list = []

    if llist[-1] > stop:
        llist[-1] = stop

    for a, b in enumerate(llist[:-1]):
        batch_list.append((llist[a], llist[a+1]))

    print batch_list

gen_range(100000000,600000000,100) 
```

但我不能停止认为它可以以一种更有效（也是代码长度方面）的方式来完成。有什么建议么？

[编辑]

我忘了指出一件事。如果范围边界不等于步长，即您有以下情况：

```
gen_range(100, 143, 10) 
```

上限应该是 143，而不是 150，因为这里的一些答案会产生，由于`range()`内部。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T02:43:15.553

### 一个非常短的方法：

```
ranges = [(n, min(n+step, stop)) for n in xrange(start, stop, step)] 
```

### 更详细的方法：

也许通过发电机？

```
def gen_range(start, stop, step):
    current = start
    while current < stop:
        next_current = current + step
        if next_current < stop:
            yield (current, next_current)
        else:
            yield (current, stop)
        current = next_current 
```

调用此函数会为您提供一个生成器对象，该对象将按顺序生成每个元组。你会像这样使用它：

```
for block in gen_range(100000000,600000000,100):
    print block 
```

这将输出...

```
(100000000,100000100)
(100000100,100000200)
(100000200,100000300)
...
(599999900,600000000) 
```

如果您始终确定它`stop-start`是 的偶数倍，则可以使用生成器表达式更简单地执行此操作`step`：

```
ranges = ((n, n+step) for n in xrange(start, stop, step))

# Usage
for block in ranges:
    print block 
```

还要注意，如果你想把一个生成器变成一个列表，把整个结果保存在内存中，你可以简单地将它传递给`list()`：

```
all_ranges = list(gen_range(100000000,600000000,100)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T02:44:54.667

如果`(b - a) % c == 0`：

```
def gen_range(a, b, c):
    return [(i, i + c) for i in range(a, b, c)] 
```

或者

```
def gen_range_2(a, b, c):
    s = range(a, b + c, c)
    return zip(s, s[1:]) 
```

见[http://ideone.com/VhY215](http://ideone.com/VhY215)

如果`(b - a) % c != 0`：

```
def gen_range(a, b, c):
    return [(i, i + c) for i in range(a, b - ((b - a) % c), c)] 
```

或者

```
def gen_range_2(a, b, c):
    s = range(a, b - ((b - a) % c) + c, c)
    return zip(s, s[1:]) 
```

见[http://ideone.com/i3Pq69](http://ideone.com/i3Pq69)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T04:34:53.153

我认为生成器是一个很好的尝试：

```
def gen_range(start, stop, step):
    while start < stop:
        yield (start, min(start + step, stop))
        start = start + step

if __name__ == '__main__':
    print [x for x in gen_range(100, 143, 10)] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T03:24:26.613

我会使用生成器方法，但是如果您要将事物解压缩到显式列表中，另一种看待它的方式是您的元组元素之间的关系非常简单，并且所有你需要做的是适当地调整长度。

```
def gen_range(start, stop, step):
   items = ((stop-start) // step)
   return [(start+(n*step), start+(n+1)*step) for n in range(items)] 
```

我认为值得发布此内容的*唯一*原因是我的第一个想法（以及评论查询）是否可以只要求列表中的第 n 个元组而无需生成批次。如果你不能，那么我不会从这个角度走下去。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-27T02:44:12.063

像这样的东西：

```
In [48]: it=iter(xrange(100,200,10))

In [49]: it1=iter(xrange(110,210,10))

In [50]: [(next(it),next(it1)) for _ in range(10)]
Out[50]: 
[(100, 110),
 (110, 120),
 (120, 130),
 (130, 140),
 (140, 150),
 (150, 160),
 (160, 170),
 (170, 180),
 (180, 190),
 (190, 200)] 
```

或使用`zip()`：

```
In [55]: it=iter(xrange(100,200,10))

In [56]: it1=iter(xrange(110,210,10))

In [57]: [(x,y) for x,y in zip(it,it1)]
Out[57]: 
[(100, 110),
 (110, 120),
 (120, 130),
 (130, 140),
 (140, 150),
 (150, 160),
 (160, 170),
 (170, 180),
 (180, 190),
 (190, 200)] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-27T02:45:04.597

我不确定我是否正确理解了这个问题，但这可以通过列表理解简单地完成：

```
start = 100
stop = 140
step = 10
[ range(s,s+step+1,step) for s in range(start,stop,step)] 
```

如果您一次只需要迭代一个列表元素，我强烈建议您改用生成器理解：

```
res = ( range(s,s+step+1,step) for s in range(start,stop,step)) 
```

您可以循环遍历它：

```
for range_piece in res:
    do_something with it 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-12-27T02:49:09.383

我会把它做成一个发电机，这样它就可以处理很大的范围。

```
def gen_range(start, stop, step):
    a, b = start, start+step
    while b <= stop:
        yield a, b
        a, b = b, b+step

print list(gen_range(100, 140, 10)) 
```

# visual-studio-2012 - 在 Visual Studio 2012 中设置 Windows Phone 8 图标的位置

> ID：14048729
> 
> 赞同：11
> 
> 时间：2012-12-27T02:35:44.423
> 
> 标签：visual-studio-2012, windows-phone-8

我已将 Windows Phone 7 应用程序升级到 Windows Phone 8/VS2012，但现在找不到设置应用程序图标的位置。很奇怪，网络上几乎没有关于在发布之前为我的应用程序设置应用程序图标的位置的资源。在 VS2010/WP7 中，这是微不足道的。现在，我几乎到处搜索，找不到与图标相关的任何内容。我唯一可以设置的是商店图标（300x300），通过右键单击并打开市场测试套件。要么我太笨，找不到它，要么它真的隐藏在 Visual Studio 2012 中的某个地方。如何在 Visual Studio 2012 中编辑我的 Windows Phone 8 应用程序的图标？

谢谢，

能。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-27T03:12:07.010

在解决方案资源管理器中的项目的“属性”节点下查找“WMAppManifest.xml”文件并双击它。这应该会打开一个可视化编辑器，允许您选择各种应用程序和磁贴图标以及更改清单中的其他属性。

# php - 使用一个 php 文件来处理两个 mysql 查询？

> ID：14048732
> 
> 赞同：0
> 
> 时间：2012-12-27T02:35:51.440
> 
> 标签：php, mysql

有没有一种方法可以在每次访问时使用相同的 php 文件“favorite.php”来执行两个单独的 mysql 查询。

基本上，我在用户个人资料页面上有一个链接，称为添加到收藏夹，它链接到 favorite.php 并运行查询以将用户添加到会话用户收藏夹列表中。我想在文件中添加另一个查询以在单独的场合运行，所以下次单击链接时说表中是否存在收藏夹 ID 以删除它，从会话用户收藏夹列表中删除该用户？

在这里，我将插入到查询中，现在我只需要找到一种方法来说删除最喜欢的 id 是否存在第二次单击链接？

```
<?php

require_once('includes/session.php');
require_once('includes/functions.php');
require('includes/_config/connection.php');

session_start();

    confirm_logged_in();

    if (isset ($_GET['to'])) {
    $user_to_id = $_GET['to'];

}

if (!isset($_GET['to']))
    exit('No user specified.');

$user_id = $_GET['to'];

$result = mysql_query("INSERT INTO ptb_favorites (user_id, favorite_id) VALUES (".$_SESSION['user_id'].", ".$user_to_id.")") 
or die(mysql_error()); 

if($result = mysql_query($query))

$result = mysql_query("DELETE FROM ptb_favorites (user_id, favorite_id) VALUES (".$_SESSION['user_id'].", ".$user_to_id.")") 
or die(mysql_error()); 

header("Location: profile.php?id=" . $user_to_id['user_id']);

?> 
```

希望这是有道理的谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:43:46.633

假设您拥有 PHP 5.3 或更高版本，以下是我编写脚本以避免 SQL 注入的方法。我倾向于使用[闭包/匿名函数](http://php.net/manual/en/functions.anonymous.php)进行数据库查询，但您可以将它们与其他所有内容一起使用。

但是最后一行我很困惑，除非`$_GET['to']`是一个数组。

```
<?php

require_once('includes/session.php');
require_once('includes/functions.php');

$connection = new PDO('mysql:host=example.com;dbname=you_database_name', 'mysql_username', 'mysql_pass');

session_start();
confirm_logged_in();

$user_to_id = isset($_GET['to']) ? $_GET['to'] : null;

if (is_null($user_to_id)) {
    exit('No user specified.');
}

$user_id = $_GET['to'];

$insert = (function () use ($connection, $user_to_id) {
    $sql = "INSERT INTO ptb_favorites (user_id, favorite_id) VALUES (?, ?)";
    $statement = $connection->prepare($sql);

    $result = $statement->execute(array(
        $_SESSION['user_id'],
        $user_to_id
    ));

    return $result;
});

if ($insert() === true) {
    $delete = (function () use ($connection, $user_to_id) {
        $sql = "DELETE FROM ptb_favorites WHERE user_id = ? AND favorite_id = ?";
        $statement = $connection->prepare($sql);

        $result = $statement->execute(array(
            $_SESSION['user_id'],
            $user_to_id
        ));

        return $result;
    });

    $delete();
}

// Not sure about this line if $user_to_id is not an array
header("Location: profile.php?id=" . $user_to_id['user_id']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:04:57.013

构建`DELETE`语句时，不应该`VALUES`涉及关键字，

```
DELETE 
FROM ptb_favorites 
WHERE user_id = val1 AND
      favorite_id = val2 
```

所以在`PHP`

```
$delQuery = "    DELETE 
                 FROM ptb_favorites 
                 WHERE user_id = '" . $_SESSION['user_id'] . "' AND
                       favorite_id = '" . $user_to_id . "'"
$result = mysql_query($delQuery) or die(mysql_error()); 
```

作为旁注，查询很容易受到`SQL Injection`. 请看下面的文章，了解如何预防。通过使用 PreparedStatements，您可以摆脱在值周围使用单引号。

*   [如何*防止*PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

# python - 是否可以在 Python 中处理任意大的字符串？（通过 * 运算符创建）

> ID：14048733
> 
> 赞同：6
> 
> 时间：2012-12-27T02:35:52.900
> 
> 标签：python, string

我们可以使用 * 运算符构建固定结构但任意长度的字符串，如下所示：

```
length = 10
print "0" * length 
```

这将返回预期的结果，`0000000000`。当长度过大时会出现问题，导致溢出错误：

```
length = 10000000000000000000000000000000000000000000000
print "0" * length 
```

这导致`OverflowError: cannot fit 'long' into an index-sized integer`.

我很好奇，这样的公式可以以某种方式用于任意长度的尺寸吗？`length`或者，处理未知且可能具有如此大价值的场景的正确方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T02:40:53.393

不，您不能在*任何*编程语言中创建像示例中那样的大字符串。字符串单独包含每个字符。10 ^(46)字节很可能比任何人存储的数据都多。您可以使用超过一万亿个 Google 数据中心（假设 Google 有 1 YiB 的存储空间，这肯定还不是这样。）并且*磁盘空间**仍然*少得多，更不用说 RAM 了，这将是您对这样一个字符串所需要的.

 *要存储一个像您的示例中那样的巨大字符串，您必须创建自己`str`的类，该类`__mul__`以存储重复次数而不实际将整个字符串存储在内存中的方式进行处理。显然，一旦您允许对该字符串进行修改，此实现就会变得非常复杂。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T03:01:31.390

你可以在 python 中编写类似字符串生成器的东西。例如：

```
import sys

def stringWithArbitraryLength(stringLength):
    n = 0
    while n < stringLength:
        # pattern here
        if n % 2 == 0:
            yield "0"
        else:
            yield "1"
        n += 1

Infinity = float('inf')

# Usage 1: print the long string
# for c in stringWithArbitraryLength(Infinity):
#   sys.stdout.write(c)

# Usage 2: instantiate the long string
soLong = stringWithArbitraryLength(100000)  # output 01010101....
print ''.join(soLong)

# Usage 3: transform the long string
def transformString(longLongString):
    for c in longLongString:
        if c == "1":
            yield "X"
        else:
            yield c
soLong2 = stringWithArbitraryLength(100000)  # output 0X0X0X0X....
print ''.join(transformString(soLong2)) 
```

它有几个限制：

1.  它只允许顺序访问，不允许随机访问。所以你必须使用for循环来遍历字符串。
2.  每个字符不能依赖于具有较大索引的字符。
3.  如果长度很大，实例化很困难。但是您可以在实例化后进行随机访问。

在许多情况下，您不必实例化整个字符串。因为您可以使用 IO 流进行输入/输出。并使用生成器处理字符串。所以每次你只处理部分数据。

如果你想了解更多关于长或无限长的字符串，你可以学习一些非严格的函数式语言，例如 Haskell。它懒惰地评估表达式。这些语言中经常使用无穷大列表/字符串。*

# java - Struts2中设置cookie值的正确方法

> ID：14048735
> 
> 赞同：4
> 
> 时间：2012-12-27T02:36:51.740
> 
> 标签：java, jakarta-ee, struts2

我从一本Struts2教科书上拿了下面的代码示例，代码的目的是在Action类中设置一个cookie，然后jsp页面应该从cookie中取出内容然后显示。

登录动作类：

```
 public class LoginAction implements Action,ServletResponseAware{
    private HttpServletResponse response;
        ...
   public void setServletResponse(HttpServletResponse response)
   {
      this.response=response;
   }

   public String execute() throws Exception
   { 
      Cookie c= new Cookie("user",getUsername());
      c.setMaxAge(60*60);

      response.addCookie(c);
      return SUCCESS;
   } 
```

JSP 页面：

```
 <html>
  <head>

  <title>Cookie Success Page</title>
  </head>
  <body>
   <br/>Welcome ${cookie.user.value}, thanks for logging in.
  </body>
 </html> 
```

我现在遇到的问题是，`${cookie.user.value}`无论我提供什么用户名，它都将始终显示为空白。

也许这不是在 Struts2 中设置 cookie 值的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:08:44.380

`cookie`只是一个`Map`幕后。要从 EL 访问 Map 接口，请使用`${cookie["user"].value}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T01:12:57.280

为了创建 cookie，`HttpServletResponse`必须工作。它使用`servletConfig`拦截器并为`HttpServletRespose`.

# java - 杰克逊异常的序列化和反序列化

> ID：14048738
> 
> 赞同：5
> 
> 时间：2012-12-27T02:37:21.033
> 
> 标签：java, json, jackson

[JSON嵌套类数据绑定](https://stackoverflow.com/questions/14038084/json-nest-class-data-binding) 作为答案，当我对容器进行序列化和反序列化时，我得到了这个异常：

```
Caused by: org.codehaus.jackson.map.JsonMappingException: Can not find a Value deserializer for abstract type [simple type, class com.xiaonei.wap.ps.model.Container]
at org.codehaus.jackson.map.deser.StdDeserializerProvider._handleUnknownValueDeserializer(StdDeserializerProvider.java:321)
at org.codehaus.jackson.map.deser.StdDeserializerProvider.findValueDeserializer(StdDeserializerProvider.java:116)
at org.codehaus.jackson.map.deser.StdDeserializer.findDeserializer(StdDeserializer.java:260)
at 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T09:19:56.230

只需删除或重命名`type`字段 的 setter/getter

```
public class Container 
{
   private AAnimal animal;

   public AAnimal getAnimal()
   {
      return animal;
   }

   @JsonTypeInfo(use=JsonTypeInfo.Id.NAME, include=JsonTypeInfo.As.EXTERNAL_PROPERTY, property="type")
   @JsonSubTypes({ @Type(value = Cat.class, name = "cat"), @Type(value = Dog.class, name = "dog") })
   public void setAnimal(AAnimal animal)
   {
      this.animal = animal;
   }
}    

public abstract class AAnimal 
{
   public String name;
} 
```

测试

```
 String json = "{\"type\":\"cat\", \"animal\" : {\"name\":\"cat-mew\" }}";
  Container val = o.readValue(json, Container.class);
  System.out.println(o.writeValueAsString(val)); 
```

输出是

```
{"animal":{"name":"cat-mew"},"type":"cat"} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-08T12:25:57.103

正如您提供的链接的答案中提到的，您需要明确提及`type`对象作为外部属性，因为该类型不属于父类。这`JsonTypeInfo.As.EXTERNAL_PROPERTY`会将 type 属性添加到上层层次结构中。

因此，这`type`作为外部属性应该存在于转换后的部分中。因此，当您`type`从 json 中删除它时，该属性没有明确的默认实现。这就是为什么你需要`defaultImpl`在注解的参数中添加一个默认的实现类。

因此，要解决此问题，您可以将其添加`AAnimal.class`为`defaultImpl`：

```
@JsonTypeInfo(
        use = JsonTypeInfo.Id.NAME,
        include = JsonTypeInfo.As.EXTERNAL_PROPERTY,
        property = "type",
        defaultImpl = AAnimal.class
)
@JsonSubTypes({ 
    @Type(value = Cat.class, name = "cat"), 
    @Type(value = Dog.class, name = "dog") 
})
public void setAnimal(Animal animal) {
    this.animal = animal;
} 
```

现在，如果您`type`从输入 json 中省略 ，并使用以下命令进行测试：

```
String json = "{\"animal\" : {\"name\":\"cat-mew\" }}"; 
```

你会得到：

```
{"animal":{"name":"cat-mew"},"type":"AAnimal"} 
```

# r - R 使用 ddply 或聚合

> ID：14048739
> 
> 赞同：11
> 
> 时间：2012-12-27T02:37:31.143
> 
> 标签：r, aggregate, plyr

我有一个包含 3 列的数据框：custId、saleDate、DelivDateTime。

```
> head(events22)
     custId            saleDate      DelivDate
1 280356593 2012-11-14 14:04:59 11/14/12 17:29
2 280367076 2012-11-14 17:04:44 11/14/12 20:48
3 280380097 2012-11-14 17:38:34 11/14/12 20:45
4 280380095 2012-11-14 20:45:44 11/14/12 23:59
5 280380095 2012-11-14 20:31:39 11/14/12 23:49
6 280380095 2012-11-14 19:58:32 11/15/12 00:10 
```

这是输出：

```
> dput(events22)
structure(list(custId = c(280356593L, 280367076L, 280380097L, 
280380095L, 280380095L, 280380095L, 280364279L, 280364279L, 280398506L, 
280336395L, 280364376L, 280368458L, 280368458L, 280368456L, 280368456L, 
280364225L, 280391721L, 280353458L, 280387607L, 280387607L), 
    saleDate = structure(c(1352901899.215, 1352912684.484, 1352914714.971, 
    1352925944.429, 1352925099.247, 1352923112.636, 1352922476.55, 
    1352920666.968, 1352915226.534, 1352911135.077, 1352921349.592, 
    1352911494.975, 1352910529.86, 1352924755.295, 1352907511.476, 
    1352920108.577, 1352906160.883, 1352905925.134, 1352916810.309, 
    1352916025.673), class = c("POSIXct", "POSIXt"), tzone = "UTC"), 
    DelivDate = c("11/14/12 17:29", "11/14/12 20:48", "11/14/12 20:45", 
    "11/14/12 23:59", "11/14/12 23:49", "11/15/12 00:10", "11/14/12 23:35", 
    "11/14/12 22:59", "11/14/12 20:53", "11/14/12 19:52", "11/14/12 23:01", 
    "11/14/12 19:47", "11/14/12 19:42", "11/14/12 23:31", "11/14/12 23:33", 
    "11/14/12 22:45", "11/14/12 18:11", "11/14/12 18:12", "11/14/12 19:17", 
    "11/14/12 19:19")), .Names = c("custId", "saleDate", "DelivDate"
), row.names = c("1", "2", "3", "4", "5", "6", "7", "8", "9", 
"10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"
), class = "data.frame") 
```

我正在尝试`DelivDate`为`saleDate`每个`custId`.

我可以像这样使用 plyr::ddply 做到这一点：

```
dd1 <-ddply(events22, .(custId),.inform = T, function(x){
x[x$saleDate == max(x$saleDate),"DelivDate"]
}) 
```

我的问题是是否有更快的方法来执行此操作，因为 ddply 方法有点耗时（完整的数据集约为 400k 行）。我看过使用`aggregate()`但不知道如何获得除我排序的值之外的值。

有什么建议么？

编辑：

这是 10k 行 @ 10 次迭代的基准测试结果：

```
 test replications elapsed relative user.self
2   AGG2()           10    5.96    1.000      5.93
1   AGG1()           10   20.87    3.502     20.75
5 DATATABLE()        10   61.32        1     60.31
3  DDPLY()           10   80.04   13.430     79.63
4 DOCALL()           10   90.43   15.173     88.39 
```

EDIT2：虽然最快 AGG2() 没有给出正确的答案。

```
 > head(agg2)
     custId            saleDate      DelivDate
1 280336395 2012-11-14 16:38:55 11/14/12 19:52
2 280353458 2012-11-14 15:12:05 11/14/12 18:12
3 280356593 2012-11-14 14:04:59 11/14/12 17:29
4 280364225 2012-11-14 19:08:28 11/14/12 22:45
5 280364279 2012-11-14 19:47:56 11/14/12 23:35
6 280364376 2012-11-14 19:29:09 11/14/12 23:01
> agg2 <- AGG2()
> head(agg2)
     custId      DelivDate
1 280336395 11/14/12 17:29
2 280353458 11/14/12 17:29
3 280356593 11/14/12 17:29
4 280364225 11/14/12 17:29
5 280364279 11/14/12 17:29
6 280364376 11/14/12 17:29
> agg2 <- DDPLY()
> head(agg2)
     custId             V1
1 280336395 11/14/12 19:52
2 280353458 11/14/12 18:12
3 280356593 11/14/12 17:29
4 280364225 11/14/12 22:45
5 280364279 11/14/12 23:35
6 280364376 11/14/12 23:01 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-27T04:27:53.330

I, too, would recommend `data.table` here, but since you asked for an `aggregate` solution, here is one which combines `aggregate` and `merge` to get all the columns:

```
merge(events22, aggregate(saleDate ~ custId, events22, max)) 
```

Or just `aggregate` if you only want the "custId" and "DelivDate" columns:

```
aggregate(list(DelivDate = events22$saleDate), 
          list(custId = events22$custId),
          function(x) events22[["DelivDate"]][which.max(x)]) 
```

Finally, here's an option using `sqldf`:

```
library(sqldf)
sqldf("select custId, DelivDate, max(saleDate) `saleDate` 
      from events22 group by custId") 
```

* * *

### Benchmarks

I'm not a benchmarking or `data.table` expert, but it surprised me that `data.table` is not faster here. *My suspicion is that the results would be quite different on a larger dataset*, say for instance, your 400k lines one. Anyway, here's some benchmarking code [modeled after @mnel's answer here](https://stackoverflow.com/a/13713220/1270695) so you can do some tests on your actual dataset for future reference.

```
library(rbenchmark) 
```

First, set up your functions for what you want to benchmark.

```
DDPLY <- function() { 
  x <- ddply(events22, .(custId), .inform = T, 
             function(x) {
               x[x$saleDate == max(x$saleDate),"DelivDate"]}) 
}
DATATABLE <- function() { x <- dt[, .SD[which.max(saleDate), ], by = custId] }
AGG1 <- function() { 
  x <- merge(events22, aggregate(saleDate ~ custId, events22, max)) }
AGG2 <- function() { 
  x <- aggregate(list(DelivDate = events22$saleDate), 
                 list(custId = events22$custId),
                 function(x) events22[["DelivDate"]][which.max(x)]) }
SQLDF <- function() { 
  x <- sqldf("select custId, DelivDate, max(saleDate) `saleDate` 
             from events22 group by custId") }
DOCALL <- function() {
  do.call(rbind, 
          lapply(split(events22, events22$custId), function(x){
            x[which.max(x$saleDate), ]
          })
  )
} 
```

Second, do the benchmarking.

```
benchmark(DDPLY(), DATATABLE(), AGG1(), AGG2(), SQLDF(), DOCALL(), 
          order = "elapsed")[1:5]
#          test replications elapsed relative user.self
# 4      AGG2()          100   0.285    1.000     0.284
# 3      AGG1()          100   0.891    3.126     0.896
# 6    DOCALL()          100   1.202    4.218     1.204
# 2 DATATABLE()          100   1.251    4.389     1.248
# 1     DDPLY()          100   1.254    4.400     1.252
# 5     SQLDF()          100   2.109    7.400     2.108 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-27T02:58:06.997

`ddply`和之间最快的`aggregate`，我想是`aggregate`，尤其是在你拥有的大量数据上。但是，最快的应该是`data.table`.

```
require(data.table)
dt <- data.table(events22)
dt[, .SD[which.max(saleDate),], by=custId] 
```

From `?data.table`:`.SD`是`data.table`包含每个组的 x 数据的子集，不包括组列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-27T04:42:38.913

这应该很快，但`data.table`可能更快：

```
do.call(rbind, 
    lapply(split(events22, events22$custId), function(x){
        x[which.max(x$saleDate), ]
    })
) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-28T15:15:11.387

这是一个更快的`data.table`功能：

```
DATATABLE <- function() { 
  dt <- data.table(events, key=c('custId', 'saleDate'))
  dt[, maxrow := 1:.N==.N, by = custId]
  return(dt[maxrow==TRUE, list(custId, DelivDate)])
} 
```

请注意，此函数创建 a`data.table`并对数据进行排序，这是您只需执行一次的步骤。如果你去掉这一步（也许你有一个多步骤的数据处理管道，并创建`data.table`一次，作为第一步），这个函数的速度是原来的两倍多。

我还修改了之前的所有函数以返回结果，以便于比较：

```
DDPLY <- function() { 
  return(ddply(events, .(custId), .inform = T, 
               function(x) {
                 x[x$saleDate == max(x$saleDate),"DelivDate"]}))
}
AGG1 <- function() { 
  return(merge(events, aggregate(saleDate ~ custId, events, max)))}

SQLDF <- function() { 
  return(sqldf("select custId, DelivDate, max(saleDate) `saleDate` 
             from events group by custId"))}
DOCALL <- function() {
  return(do.call(rbind, 
                 lapply(split(events, events$custId), function(x){
                   x[which.max(x$saleDate), ]
                 })
  ))
} 
```

这是 10k 行的结果，重复 10 次：

```
library(rbenchmark)
library(plyr)
library(data.table)
library(sqldf)
events <- do.call(rbind, lapply(1:500, function(x) events22))
events$custId <- sample(1:nrow(events), nrow(events))

benchmark(a <- DDPLY(), b <- DATATABLE(), c <- AGG1(), d <- SQLDF(),
 e <- DOCALL(), order = "elapsed", replications=10)[1:5]

              test replications elapsed relative user.self
2 b <- DATATABLE()           10    0.13    1.000      0.13
4     d <- SQLDF()           10    0.42    3.231      0.41
3      c <- AGG1()           10   12.11   93.154     12.03
1     a <- DDPLY()           10   32.17  247.462     32.01
5    e <- DOCALL()           10   56.05  431.154     55.85 
```

由于所有函数都返回它们的结果，我们可以验证它们都返回相同的答案：

```
c <- c[order(c$custId),]
dim(a); dim(b); dim(c); dim(d); dim(e)
all(a$V1==b$DelivDate)
all(a$V1==c$DelivDate)
all(a$V1==d$DelivDate)
all(a$V1==e$DelivDate) 
```

/Edit：在较小的 20 行数据集上，`data.table`仍然是最快的，但幅度较小：

```
 test replications elapsed relative user.self
2 b <- DATATABLE()          100    0.22    1.000      0.22
3      c <- AGG1()          100    0.42    1.909      0.42
5    e <- DOCALL()          100    0.48    2.182      0.49
1     a <- DDPLY()          100    0.55    2.500      0.55
4     d <- SQLDF()          100    1.00    4.545      0.98 
```

/Edit2：如果我们`data.table`从函数中删除创建，我们会得到以下结果：

```
dt <- data.table(events, key=c('custId', 'saleDate'))
DATATABLE2 <- function() { 
  dt[, maxrow := 1:.N==.N, by = custId]
  return(dt[maxrow==TRUE, list(custId, DelivDate)])
}
benchmark(a <- DDPLY(), b <- DATATABLE2(), c <- AGG1(), d <- SQLDF(),
           e <- DOCALL(), order = "elapsed", replications=10)[1:5]
              test replications elapsed relative user.self
2 b <- DATATABLE()           10    0.09    1.000      0.08
4     d <- SQLDF()           10    0.41    4.556      0.39
3      c <- AGG1()           10   11.73  130.333     11.67
1     a <- DDPLY()           10   31.59  351.000     31.50
5    e <- DOCALL()           10   55.05  611.667     54.91 
```

# postgresql - PostGIS：找到最接近给定点的几何图形

> ID：14048744
> 
> 赞同：7
> 
> 时间：2012-12-27T02:38:26.720
> 
> 标签：postgresql, geolocation, openlayers, geospatial, postgis

假设我的数据库中有许多几何图形。我想在 PostgreSQL 中创建一个函数，借此我可以传入一个纬度/经度，并让它返回给定半径的距离（线性和道路）最近的几何图形。

我是这方面的新手，所以任何建议都值得赞赏。

我正在运行以下版本：

*   PostgreSQL：9.2
*   地理信息系统：2.0

这是架构：

```
-- ----------------------------
--  Table structure for "cities-usa"
-- ----------------------------
DROP TABLE IF EXISTS "cities-usa";
CREATE TABLE "cities-usa" (
"gid" int4 NOT NULL DEFAULT nextval('"cities-usa_gid_seq"'::regclass),
"st_fips" varchar(4),
"sfips" varchar(2),
"county_fip" varchar(4),
"cfips" varchar(4),
"pl_fips" varchar(7),
"id" varchar(20),
"name" varchar(39),
"elevation" varchar(60),
"pop_1990" numeric,
"population" varchar(30),
"st" varchar(6),
"state" varchar(16),
"warngenlev" varchar(16),
"warngentyp" varchar(16),
"watch_warn" varchar(3),
"zwatch_war" float8,
"prog_disc" int4,
"zprog_disc" float8,
"comboflag" float8,
"land_water" varchar(16),
"recnum" float8,
"lon" float8,
"lat" float8,
"geom" "geometry"
)
WITH (OIDS=FALSE);
ALTER TABLE "cities-usa" OWNER TO "postgres";

-- ----------------------------
--  Primary key structure for table "cities-usa"
-- ----------------------------
ALTER TABLE "cities-usa" ADD CONSTRAINT "cities-usa_pkey" PRIMARY KEY ("gid") NOT DEFERRABLE INITIALLY IMMEDIATE; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-02T22:34:28.087

逻辑可以包装到一个函数中，但我建议使用查询来测试逻辑。您将遇到的困难是线性距离（英里）与角坐标（纬度和经度）相结合。此外，上面指定的几何类型没有 SRID 或几何类型。我猜应该`geometry(Point,4326)`是

您可以尝试一些策略，例如使用`geography`类型，它会自动使用计量器来执行`ST_Distance`, 或`ST_DWithin`. 下面的示例仅使用`ST_Distance_Sphere`从英里到米的转换来帮助您前进。或者，如果您需要性能，您可以尝试[索引最近邻搜索](http://blog.opengeo.org/2011/09/28/indexed-nearest-neighbour-search-in-postgis/)`<->`的功能。

您可以尝试以下方法：

```
CREATE OR REPLACE FUNCTION WhatAmINear(lat float8, lon float8,
                                       radius_mi float8, num int DEFAULT 10)
    RETURNS SETOF "cities-usa" AS
$body$
SELECT *
FROM "cities-usa"
WHERE ST_Distance_Sphere(geom, ST_MakePoint(lon, lat)) <= radius_mi * 1609.34
LIMIT num;
$body$
LANGUAGE sql VOLATILE; 
```

接着：

```
SELECT WhatAmINear(44.9, -93.1, 100); 
```

# crystal-reports - 如何使用水晶报表中的公式将数据存储在数组中？

> ID：14048748
> 
> 赞同：1
> 
> 时间：2012-12-27T02:38:54.253
> 
> 标签：crystal-reports, crystal-reports-2008, crystal-reports-xi, crystal-reports-2010, crystal-reports-8.5

我正在尝试使用水晶报表中的公式字段存储在此代码块中评估的数据，

```
if "TOP" in {materialDescription} or 
   "Top" in {materialDescription}
then 
   //Storing the data into a TOP array here.
else
   //Storing the data into a BOTTOM array here. 
```

来人帮帮我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T01:57:32.977

我没有继续使用存储到数组来解决我的问题。我只是在水晶报表中使用条件 if-then-else 将我的顶部和底部与公式分组。

# wordpress - 列出所有类别，但只锚定孙子（Wordpress）

> ID：14048753
> 
> 赞同：8
> 
> 时间：2012-12-27T02:39:22.137
> 
> 标签：wordpress, categories, wp-list-categories

我目前正在使用它来列出所有类别：

```
<?php 
    $args = array (
    'menu' => 'secondary-navigation',
    'sort_column' => 'menu_order',
    'container' => 'false', 
    'title_li' => 0,
    'hide_empty' => 0
    );
    wp_list_categories($args);
?> 
```

这将简单地列出层次结构中的所有类别并锚定每个项目。

我的类别实际上是这样设置的：

```
Parent
    -> Child
        -> Grandchild
            -> Great Grandchild 
```

我的问题是我只希望曾孙有主播。我不希望父母、孩子或孙子有锚。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T14:19:45.197

正如 Lleo Holmes 在评论中提到的，最好的方法是创建一个自定义的[Walker 类](http://codex.wordpress.org/Function_Reference/Walker_Class)来实现这个功能。我试了一下，得出以下结论：

```
class Depth_Category_Walker extends Walker_Category {
    private $allowed_depths;

    function __construct( $depths_to_link = array() ) {
        $this->allowed_depths = !is_array($depths_to_link) ? array($depths_to_link) : $depths_to_link;
    }

    function start_el( &$output, $category, $current_depth = 0, $args = array(), $id = 0 ) {
        extract($args);
        if( in_array( $current_depth, $this->allowed_depths ) ) {
            parent::start_el( $output, $category, $current_depth, $args, $id );
        } else {
            $cat_name = esc_attr( $category->name );
            $cat_name = apply_filters( 'list_cats', $cat_name, $category );
            if ( !empty($show_count) )
                $cat_name .= ' (' . intval($category->count) . ')';

            if ( 'list' == $args['style'] ) {
                $output .= "\t<li";
                $class = 'cat-item cat-item-' . $category->term_id;
                if ( !empty($current_category) ) {
                    $_current_category = get_term( $current_category, $category->taxonomy );
                    if ( $category->term_id == $current_category )
                        $class .=  ' current-cat';
                    elseif ( $category->term_id == $_current_category->parent )
                        $class .=  ' current-cat-parent';
                }
                $output .=  ' class="' . $class . '"';
                $output .= ">$cat_name\n";
            } else {
                $output .= "\t$cat_name<br />\n";
            }
        }
    }
} 
```

这扩展了`Walker_Category`类，以便我们可以调用`parent::start_el()`以在适当的深度生成链接。构造函数接受包含您希望显示链接的级别的深度数组。超出该数组的任何深度都将呈现为纯文本。请注意，`else`代码取自`Walker_Category::start_el`，因此如果基类被修改过，这可能会在未来的版本中中断。

上面的类可以通过调用来使用`wp_list_categories`：

```
<?php
   $args = array(
       'orderby' => 'menu_order',
       'title_li' => 0,
       'hide_empty' => 0,
       'walker' => new Depth_Category_Walker(2)
   );
?>
<ul>
   <?php wp_list_categories( $args ); ?>
</ul> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T00:16:18.087

您可以简单地使用纯 CSS 禁用链接，而无需更改任何 php 代码。检查以下代码，它会改变鼠标光标，禁用链接功能，隐藏下划线样式：

```
.cat-item a, .cat-item .cat-item .cat-item .cat-item a {
      cursor: default;
      pointer-events: none;
      text-decoration: none;
}
.cat-item .cat-item .cat-item a {
      cursor: pointer;
      pointer-events: auto;
      text-decoration: underline;
      /* also add here any special style for grandchildren categories */
} 
```

结果将完全符合您的要求，只有孙类别似乎被锚定。

希望这能回答你的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-02T05:55:09.973

请使用此代码

```
$categories = get_categories(array(
        'child_of' => 9,
        'hide_empty' => false
    ));
foreach($categories as $cat){
    echo $cat->name;
    echo '<br />';
} 
```

此代码仅针对二级类别进行测试。

将 9 替换为您的类别 ID，例如“孙子”类别 ID。此代码未经测试，但这是工作

希望这对你有帮助

# qt - Qt - GLWidget - 在 2 个 QMainWindow 之间获得焦点跟随鼠标

> ID：14048763
> 
> 赞同：1
> 
> 时间：2012-12-27T02:40:50.297
> 
> 标签：qt, focus, qmainwindow

我从 Qt/OpenGL 应用程序开始。我有一个包含`widget_2`QGLWidget 的 GLWidget 子类（“”）的第一个 QMainWindow。此 GLWidget 呈现图形动画。

从这个 QMainWindow 的菜单中，我调用了第二个 QMainWindow，我在其中设置了动画的参数`widget_2`。

除了焦点之外，一切都很好。当我将鼠标从 QWindow 移动到另一个时，我希望焦点跟随鼠标。

我尝试`widget_2->setMouseTracking(true)`在第一个 QMainWindow 的构造函数中使用，但问题是我使用鼠标进行旋转`widget_2`。因此，当我从第二个 QMainWindow 移动到第一个时，鼠标在第一个中被很好地捕获，但它会自动旋转 3D 场景而无需按下左键。

我也尝试过`enterEvent`这种方式（Ui_MainWindow 是第一个 QMainWindow 的 QObject）：

```
void Ui_MainWindow::enterEvent(QEvent *event)
{
widget_2->setFocus(Qt::OtherFocusReason);
} 
```

完成的旋转`widget_2`以这种方式在另一个文件（GLWidget.cpp）中实现：

```
void GLWidget::mousePressEvent(QMouseEvent *event)
{
  if (event->buttons() & Qt::LeftButton)
  {
    xdiff = event->x();
    ydiff = -event->y();
  }
}

void GLWidget::mouseMoveEvent(QMouseEvent *event)
{
  yrot = (event->x() - xdiff) / 10.0f;
  xrot = (event->y() + ydiff) / 10.0f;
} 
```

目前，当我在第二个 QMainWindow 并加载参数然后移动到第一个时，我必须单击左键来旋转 3D 场景并能够按下按钮。

我希望焦点跟随鼠标，即当我结束时`widget_2`，焦点在`widget_2`不与已经实现的鼠标旋转功能冲突，并且当我在菜单上时，我不需要单击两次按钮。

我怎么能得到它？

# visual-studio-2012 - VS 设置项目

> ID：14048764
> 
> 赞同：6
> 
> 时间：2012-12-27T02:40:50.710
> 
> 标签：visual-studio-2012, windows-installer, setup-project

我正在创建一个 Visual Studio 安装项目。我想从我的组件安装中卸载系统中的另一个组件。另一个组件是从我自己使用 Visual Studio 创建的设置中安装的。

目前，当我从组件的安装操作中调用其他组件的卸载时，我收到错误代码：1618（另一个 MSI 已经在运行）。

任何人都可以提出解决此问题的替代方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T08:25:06.957

您不需要自定义操作，您可以使用 Windows Installer 的内置支持： [我可以配置 msi 安装程序以在安装前删除具有不同产品代码但相同升级代码的任何其他安装吗？](https://stackoverflow.com/questions/10541903/can-i-configure-an-msi-installer-to-remove-any-other-installation-with-a-differe)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T10:04:08.887

you may add custom action but do remember add custom action in commit folder only .so that only after installation uninstall start

# vb.net - Split Characters and Numbers

> ID：14048766
> 
> 赞同：2
> 
> 时间：2012-12-27T02:40:54.363
> 
> 标签：vb.net, split, format, currency

I have this problem in split

I want to convert the numeric into formatcurrency but it contains a Character

For example:

```
POC 1900
output :
POC $1,900.00 
```

Or

```
 1900 POC 
    output :
    $1,900.00 POC 
```

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:30:31.403

Use Regular Expression to match and replace values.

```
Dim str = "1900 POC" //Or "POC 1900"
Dim reg = New Regex("\d+")

Dim match = reg.Match(str)
If match.Success Then
  str = reg.Replace(str, Decimal.Parse(match.Value).ToString("C"))
  Console.WriteLine(str)
End If 
```

EDIT:

If string contains comma (,) between numbers then replace it with :

```
Dim str = "1,900 POC".Replace(",", "") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:58:05.173

```
Dim strValue As String = "POC 1900"
Dim strOutput As String = String.Empty
Dim strNum As String() = strValue .Split(" ")
Dim strDisplay As String = String.Empty
For x As Integer = 0 To strNum.Length - 1
   strDisplay = String.Concat(strDisplay, " ", IIf(IsNumeric(strNum(x)), FormatCurrency(Val(strNum(x)), 2), strNum(x)))
Next

strOutput = strDisplay 
```

# javascript - jqueryUI - 将项目拖动到多个列表

> ID：14048767
> 
> 赞同：3
> 
> 时间：2012-12-27T02:41:09.667
> 
> 标签：javascript, jquery-ui

我的场景是我有一个包含作为列表项的人名列表，我希望能够将这些名称拖到框中。我通过 jqueryUI 得到了这部分，但我的问题是，当名称被拖到框中时，我不希望它被移出原始列表，因为一个人可以在多个列表中。

我认为问题在于我使用的是 .appendTo 而不是 .add，但它显然不像将 .appendTo 切换到 .add 那样简单

`$( this ).appendTo( $list ).show( "slow" );`

完整代码：

```
$(function() {
    $( "#sortable1, #sortable2, #sortable3" ).sortable().disableSelection();

    var $tabs = $( "#tabs" ).tabs();

    var $tab_items = $( "ul:first li", $tabs ).droppable({
        accept: ".connectedSortable li",
        hoverClass: "ui-state-hover",
        drop: function( event, ui ) {
            var $item = $( this );
            var $list = $( $item.find( "a" ).attr( "href" ) )
                .find( ".connectedSortable" );

            ui.draggable.hide( "slow", function() {

                $( this ).appendTo( $list ).show( "slow" );

            });
        }
    });
}); 
```

请参阅下面的小提琴以获取工作示例和 HTML 标记。
[http://jsfiddle.net/sXRKd/1/](http://jsfiddle.net/sXRKd/1/)

格拉西亚斯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T12:17:50.287

希望，当您将一个人丢给另一个人时，它必须在两个地方都有效。例如，当您`josh mondie`投入其中时`Close Friends`，必须同时使用`All Friends`和`Close Friends`。

看看这个[fiddle](http://jsfiddle.net/sXRKd/6/)，它工作正常。

代码，

```
drop: function (event, ui) {
      var $droppableId = $("a", this).attr("href");
      var $newList = $(".connectedSortable", $droppableId);

      ui.draggable.hide("slow", function () {
        $newList.append(ui.draggable.clone().show());
      });
      ui.draggable.show("slow");
    } 
```

# java - tcnative-1.dll 无法在 IA 32 位平台上加载 AMD 64 位 .dll

> ID：14048773
> 
> 赞同：34
> 
> 时间：2012-12-27T02:42:24.833
> 
> 标签：java, tomcat, unsatisfiedlinkerror

当我尝试运行 tomcat 时出现此错误：

```
"java.lang.UnsatisfiedLinkError: C:\Program Files (x86)\apache-tomcat-7.0.34\bin\tcnative-1.dll: Can't load AMD 64-bit .dll on a IA 32-bit platform". 
```

但是，我下载了 64 位 JRE，并仔细检查了我的 java 版本：

```
C:\Program Files (x86)\apache-tomcat-7.0.34\bin>java -version
java version "1.7.0_10"
Java(TM) SE Runtime Environment (build 1.7.0_10-b18)
Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode) 
```

我以前在这里看到过这个问题，但是其中一个没有解决方案，另一个是 Eclipse 问题，但是当我直接访问 tomcat 时出现此错误。

如何找出正在检测的“IA 32 位平台”，以及如何将 Tomcat 指向正确的方向？另外，这可能是我的 servlet 通过 Eclipse 得到这个 404 错误的原因吗？

> 类型状态报告
> 
> 消息 /JSPandServlet/控制器
> 
> 描述 请求的资源不可用。

## 日志：

```
C:\Program Files (x86)\apache-tomcat-7.0.34\bin>configtest.bat
Using CATALINA_BASE:   "C:\Program Files (x86)\apache-tomcat-7.0.34"
Using CATALINA_HOME:   "C:\Program Files (x86)\apache-tomcat-7.0.34"
Using CATALINA_TMPDIR: "C:\Program Files (x86)\apache-tomcat-7.0.34\temp"
Using JRE_HOME:        "C:\Program Files (x86)\Java\jre7"
Using CLASSPATH:       "C:\Program Files (x86)\apache-tomcat- 
7.0.34\bin\bootstrap.jar;C:\Program Files (x86)\apache-tomcat- 
7.0.34\bin\tomcat-juli.jar" 
java.lang.UnsatisfiedLinkError: C:\Program Files (x86)\apache-tomcat- 
7.0.34\bin\
tcnative-1.dll: Can't load AMD 64-bit .dll on a IA 32-bit platform
    at java.lang.ClassLoader$NativeLibrary.load(Native Method)
    at java.lang.ClassLoader.loadLibrary1(Unknown Source)
    at java.lang.ClassLoader.loadLibrary0(Unknown Source)
    at java.lang.ClassLoader.loadLibrary(Unknown Source)
    at java.lang.Runtime.loadLibrary0(Unknown Source)
    at java.lang.System.loadLibrary(Unknown Source)
    at org.apache.tomcat.jni.Library.<init>(Library.java:42)
    at org.apache.tomcat.jni.Library.initialize(Library.java:174)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.core.AprLifecycleListener.init(AprLifecycleListener.java:180)
    at org.apache.catalina.core.AprLifecycleListener.isAprAvailable(AprLifecycleListener.java:85)
    at org.apache.catalina.connector.Connector.setProtocol(Connector.java:595)
    at org.apache.catalina.connector.Connector.<init>(Connector.java:69)
    at org.apache.catalina.startup.ConnectorCreateRule.begin(ConnectorCreateRule.java:62)
    at org.apache.tomcat.util.digester.Digester.startElement(Digester.java:1276)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractXMLDocumentParser.emptyElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanStartElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at org.apache.tomcat.util.digester.Digester.parse(Digester.java:1537)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:610)
    at org.apache.catalina.startup.Catalina.load(Catalina.java:658)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.load(Bootstrap.java:281)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:455)
Dec 26, 2012 7:15:47 PM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in production environments was not found on the java.library.path: C:\Program Files (x86)\Java\jre7\bin;C:\windows\Sun\Java\bin;C:\windows\system32;C:\windows;C:\Program Files\Common Files\Microsoft Shared\Microsoft Online Services;C:\Program Files (x86)\Common Files\Microsoft Shared\Microsoft Online Services;C:\Program Files\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\Common Files\Microsoft Shared\Windows Live;C:\Program Files (x86)\PHP\;C:\windows\system32;C:\windows;C:\windows\System32\Wbem;c:\Program Files (x86)\Microsoft SQLServer\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\Tools\Binn\;c:\Program Files\Microsoft SQL Server\100\DTS\Binn\;c:\Program Files (x86)\Microsoft ASP.NET\ASP.NET Web Pages\v1.0\;c:\Program Files (x86)\Microsoft SQL Server\10
0\Tools\Binn\VSShell\Common7\IDE\;c:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;C:\Program Files (x86)\Windows Live\Shared;C:\Program Files\TortoiseSVN\bin;C:\Program Files\Microsoft\Web Platform Installer\;C:\Program Files\SourceGear\Common\DiffMerge\;C:\Ruby193\bin;.
Dec 26, 2012 7:15:47 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["http-bio-8080"]
Dec 26, 2012 7:15:47 PM org.apache.coyote.AbstractProtocol init
INFO: Initializing ProtocolHandler ["ajp-bio-8009"]
Dec 26, 2012 7:15:47 PM org.apache.catalina.startup.Catalina load
INFO: Initialization processed in 448 ms 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-31T04:12:39.093

哦，伙计，我发现了问题。我在一个奇怪的地方有一个旧的 JRE，JRE_HOME 正在访问它。我删除了那个目录，修复了我的环境变量，然后处理了它。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-12T13:07:37.263

我刚刚找到了解决方案。问题是我的 JRE_HOME 指向一个 32 位 JRE，而我的机器是 64 位机器。我安装了 64 位 JRE 并在系统变量中替换它，服务器开始干净

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-10T10:32:45.333

请检查 eclipse 指向的默认版本。**属性->Java 编译器**。将其切换到您安装的 JRE 版本。这对我有用。谢谢。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-18T12:46:55.593

Windows 服务器上的死灵法（2019 年 3 月）。关于堆栈溢出有几个答案，对于“**无法在 IA 32 位平台上加载 AMD 64 位 .dll** ”的问题。所有这些都只是解决方案的一部分。这里是所有内容。

原因：使用了 32 位版本的 Java，而库需要 64 位版本。

(1) 确保设置了 JAVA_HOME 和 CATALINA_HOME。就像是

设置 JAVA_HOME=C:\Program Files\Java\jre1.8.0_201 设置 CATALINA_HOME=C:\Program Files (x86)\tomcat-9.0.16

这些是 2019 年 3 月的默认位置。真实版本无关紧要，重要的是以下命令应该起作用：

```
"%java_home%\bin\java.exe" -version
"%catalina_home%\bin\configtest.bat" 
```

第一个命令应该给你几行。其中一条线应该说类似

```
Java HotSpot(TM) 64-bit Server VM 
```

当然 64 位仅在 64 位 Windows 机器上。（如何检查：`windows - run - system information`。它应该在系统类型中提到是基于 32 还是 54 的系统）

配置测试显示了 TomCat 使用的 java 和 catalina home 值。

如果您的 Java 版本不正确：

*   卸载旧 Java 版本：控制面板 - （主页）程序 - 卸载程序
*   去[下载Java手册下载页面](http://JAVA_HOME=C:%5CProgram%20Files%5CJava%5Cjre1.8.0_201)。（如果链接不再有效，请使用 Google）不要进行自动下载，您可能会获得与您想要的不同的版本，具体取决于您的浏览器。
*   离线下载**64 位 Windows**再次不要在线：它会查看您的浏览器来决定您想要 32 位还是 64 位。
*   运行安装程序。
*   安装 Java 后，检查您的路径和环境变量并进行相应调整（在 windows server 2012 中：控制面板 - 系统和安全 - 系统 - 更改设置 - 高级 - 环境变量） - 重新打开命令提示符。再次检查路径和环境变量并运行上面的测试。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-19T14:53:52.117

请检查 IDE 使用的项目 SDK 版本。

```
在 Intellij IDEA 中：  文件 -> 项目结构 -> 项目。
在 Eclipse 中：        属性 -> Java 编译器。

```

将其切换到已安装的 JDK x64 版本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-14T22:39:30.423

对于相同的消息“无法在 AMD 64 位平台上加载 IA 32 位 .dll”，同时尝试在 64 位 Windows 机器上运行 Jenkins 从站，通过删除指向 32 的 JAVA_TOOL_OPTIONS 和 _JAVA_OPTIONS 环境变量来修复它位 jvmhook。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-11-29T10:28:39.487

我遇到一些类似消息的问题是我已经通过 swig 在 Linux 机器 (libmyLic.so) 上创建了共享本机库，将其复制到 Windows，并且试图运行我的 java 测试。该测试应该使用 System.loadLibrary 或 System.load 接口。它不起作用，因为 swig 为 UNIX 环境创建了我的共享本机库（将 C++ 代码包装到 java）。当我将所有测试复制到 Linux 时，它解决了问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-13T18:29:39.337

如果上述答案不起作用，请检查您的路径变量是否指向 Apache Tomcat 安装文件夹的正确（64 位或 32 位）bin 文件夹。这对我有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-21T19:19:01.777

由于 java 的 32 位和 64 位冲突，才会触发此错误。分析：启动tomcat时查看初始日志。您将了解将是用于 tomcat 的 java。

```
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: Server version name:   Apache Tomcat/8.5.66
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: Server built:          May 8 2021 22:44:01 UTC
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: Server version number: 8.5.66.0
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: OS Name:               Windows 10
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: OS Version:            10.0
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: Architecture:          amd64
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: Java Home:             C:\Program Files\Java\jdk1.8.0_291\jre
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: JVM Version:           1.8.0_291-b10
Jun 21, 2021 2:44:12 PM org.apache.catalina.startup.VersionLoggerListener log
INFO: JVM Vendor:            Oracle Corporation 
```

如果发现不正确的架构或不正确的 java 路径，请尝试修复它。如果由于某种原因你遇到困难。尝试重命名不正确的 JDK 目录。它会在某个地方开始给出错误。就我而言，它抱怨我添加到eclipse中的tomcat服务器的java。我必须删除并再次添加 tomcat，以更正它将用于 tomcat 的正确 JDK。这通过问题解决了。

# sql-server-2008-r2 - 防止 Sync Framework 同步删除

> ID：14048776
> 
> 赞同：2
> 
> 时间：2012-12-27T02:43:21.320
> 
> 标签：sql-server-2008-r2, synchronization, microsoft-sync-framework

我正在使用 MS Sync 框架将记录从分支同步到服务器。我只是将更改下载到主分支服务器。但是，我想防止在从分支服务器删除记录时删除主服务器上的同步记录。我希望只能将记录从分支上传和更新到服务器，即使在分支服务器上被删除也能保留它们。

我搜索了一些技术来做到这一点，但对我来说唯一可行的方法是禁用服务器数据库表上的删除触发器。有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T02:15:41.603

除了禁用删除触发器之外，您还可以拦截 ChangesSelected 事件中的更改并删除已删除的行，这样它们就不会传播到服务器。

请参阅：[在 Sync Fx 中操作更改数据集](http://jtabadero.wordpress.com/2011/03/07/manipulating-the-change-dataset-in-sync-fx/)

# python - 使用 Flask，我如何将 robots.txt 和 sitemap.xml 作为静态文件提供？

> ID：14048779
> 
> 赞同：35
> 
> 时间：2012-12-27T02:44:09.067
> 
> 标签：python, flask, static-files

我已经在安静的几个地方阅读了应该将静态文件服务留给服务器的地方，例如在这个[SO question](https://stackoverflow.com/questions/4239825/static-files-in-flask-robot-txt-sitemap-xml-mod-wsgi)的几个答案中。但我使用 OpenShift PaaS，不知道如何在那里修改 .htaccess 文件。

我遇到了从模板提供站点地图的这段[代码](http://code.google.com/r/lipiridis-skiptrack/source/browse/main/sitemap.py?spec=svn8cd861620861a94f984a5bc2de2fcbda2773296e&r=8cd861620861a94f984a5bc2de2fcbda2773296e)。我在我的应用程序上为站点地图和 robots.txt 都这样做了，就像这样 -

```
@app.route("/sitemap.xml")
def sitemap_xml():
    response= make_response(render_template("sitemap.xml"))
    response.headers['Content-Type'] = 'application/xml'
    return response

@app.route("/robots.txt")
def robots_txt():
    return render_template("robots.txt") 
```

这有什么害处，还是我的方法可以？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-12-27T11:36:36.020

放入您的应用程序目录`robots.txt`并定义此视图：`sitemap.xml``static`

```
from flask import Flask, request, send_from_directory

@app.route('/robots.txt')
@app.route('/sitemap.xml')
def static_from_root():
    return send_from_directory(app.static_folder, request.path[1:]) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-27T03:26:53.103

Flask 内置了对提供静态文件的支持。

创建一个`/static`目录并将文件放在那里。然后，当您实例化时`Flask`，指定`static_url_path`参数：

```
app = Flask(__name__, static_url_path='/') 
```

默认是从`/static/`路径提供静态文件，但您希望它们从那里提供，`/`以便它们在预期的位置。

有关更多信息，请参阅[Flask API 文档](http://flask.readthedocs.org/en/latest/api/)。

除了开销和不必要的代码之外，您的方法的问题是，如果/当您要提供的文件之一包含看起来像模板标签的内容时，`render_template`您可能会导致呈现错误。如果您要将文件读入内存（一次，而不是在方法内部）然后将该字符串用作响应的主体而不调用`render_template`，您至少可以避免该问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-09-03T22:03:37.453

最好的方法是将**static_url_path**设置为根 url

```
from flask import Flask

app = Flask(__name__, static_folder='static', static_url_path='') 
```

# entity-framework - 没有虚拟导航属性的实体框架代码优先实体拆分？

> ID：14048781
> 
> 赞同：0
> 
> 时间：2012-12-27T02:44:23.933
> 
> 标签：entity-framework, entity-framework-6

我整个下午都在尝试解决这个问题，但是一无所获。我们的模式似乎不太正确，但我没有能力改变它。

基本上我需要结合这三个表：

```
dbo.Charity
    Id  (PK, int, not null)
    Name (varchar(100), not null)

dbo.CharityCountry
    CharityId (PK, FK, int, not null)
    CountryId (PK, FK, int, not null)

dbo.Country
    Id  (PK, int, not null)
    Name (varchar(100), not null) 
```

并将它们放入 EF 模型中：

但我完全感到困惑，因为许多文章似乎都忽略了如何使用 Mapping 类来做到这一点：

```
public class CharityMap : EntityTypeConfiguration<Charity>
{
    public CharityMap()
    {
        this.HasKey(t => t.Id);

        this.ToTable("dbo.Charity");

        this.Property(t => t.Id).HasColumnName("Id");
        this.Property(t => t.Name).HasColumnName("Name");
        ...
    }
 } 
```

我需要知道的是要放入...，我不确定如何映射主实体中没有外键的复合实体关联。

慈善对象如下所示：

```
public class Charity
{
    public int? Id { get; set; }
    public string Name { get; set; }
    public Country Country { get; set; }
} 
```

和 Country 对象：

```
public class Country
{      
    public int? Id { get; set; }
    public string Name { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T04:23:36.550

如果您是 safari 图书在线帐户 [http://my.safaribooksonline.com/book/-/9781449317867](http://my.safaribooksonline.com/book/-/9781449317867)，这本书来自 Julie Lerman，非常有用。

这是 Julie 的免费文章，关于在没有导航属性的情况下使用外键，如您的示例所示。这是可能的，但它更难使用。

[http://msdn.microsoft.com/en-us/magazine/ee532098.aspx?sdmr=JulieLerman&sdmi=authors](http://msdn.microsoft.com/en-us/magazine/ee532098.aspx?sdmr=JulieLerman&sdmi=authors) 请参阅使用缺少外键的专栏

# javascript - 不包含时间脚本不起作用

> ID：14048785
> 
> 赞同：-1
> 
> 时间：2012-12-27T02:44:58.667
> 
> 标签：javascript, jquery

这是我的代码：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">

<span class='whocares'><div class='box'><span style='font-size:20px;color: #0BB;'>12/26/2012 is the best</span></div><br></span><span class='whocares'><div class='box'><span style='font-size:20px;color: #0BB;'>12-26-2012</span></div><br></span><span class='whocares'><div class='box'><span style='font-size:20px;color: #0BB;'>messa coockcook</span></div><br></span><script>
$(document).ready(function() {
var currentTime = new Date()
var month = currentTime.getMonth() + 1
var day = currentTime.getDate()
var year = currentTime.getFullYear()
$(".whocares:not(:contains('" + month + "/" + day + "/"+ year+"'))").remove();
});
</script> 
```

它适用于[JSFiddle](http://jsfiddle.net/srKAT/)，但不适用于我的[服务器](http://dumbsearch.com/gus.php)。在我的服务器上，当我运行它时什么都没有出现。为什么会这样？我做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:01:39.000

首先，查看您的来源：

```
<b>Warning</b>:  file_get_contents(http://www.dumbsearch.com/reminded.txt) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found
 in <b>/home/content/76/7290476/html/remindersimportant.php</b> on line <b>4</b><br /> 
```

其次，您需要考虑不同时区的人。例如，我在 IST 时区，所以这里已经是 27/12/2012。

除此之外，您的 HTML 格式不正确。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"> 
```

你需要在`</script>`这里结束。这是您在服务器上看不到错误的原因之一。

它总是有助于保持良好的缩进代码。很容易在关键位置发现此类错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:02:04.360

您的 jQuery 脚本标签未正确关闭。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<span class='whocares'><div class='box'><span style='font-size:20px;color: #0BB;'>12/26/2012 is the best</span></div><br></span><span class='whocares'><div class='box'><span style='font-size:20px;color: #0BB;'>12-26-2012</span></div><br></span><span class='whocares'><div class='box'><span style='font-size:20px;color: #0BB;'>messa coockcook</span></div><br></span>

<script>
$(document).ready(function() {
var currentTime = new Date()
var month = currentTime.getMonth() + 1
var day = currentTime.getDate()
var year = currentTime.getFullYear()
$(".whocares:not(:contains('" + month + "/" + day + "/"+ year+"'))").remove();
});
</script> 
```

# c++ - 如何在 OpenCV 的 cvShowImage() 函数调用的窗口中显示中文文本？

> ID：14048787
> 
> 赞同：0
> 
> 时间：2012-12-27T02:45:05.777
> 
> 标签：c++, xcode, image-processing, opencv

我想在窗口标题中添加一个中文文本，由 OpenCV 的 cvShowImage() 函数调用。但它没有给出正确的结果。

```
#include <iostream>
#include "opencv2/opencv.hpp"

using namespace cv;
using namespace std;

int main(int argc, const char * argv[])
{
  const char *pstrFilename = "EDF001.png";
  const char *pstrWindowTitle = "欢迎来到细胞图像处理的世界！";

  IplImage* img = cvLoadImage(pstrFilename, CV_LOAD_IMAGE_UNCHANGED);

  cvNamedWindow(pstrWindowTitle, CV_WINDOW_NORMAL);
  cvShowImage(pstrWindowTitle, img);

  cvWaitKey();

  cvDestroyWindow(pstrWindowTitle);
  cvReleaseImage(&img);

  return 0;
} 
```

结果窗口： ![窗口标题显示不正确的中文文本](../Images/c99ab95189b7fe2fa419d590311977cc.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:17:13.313

我原来的评论是：

“如果您使用英文/ASCII 名称作为标题，它工作正常吗？OpenCV 可能无法处理窗口标题的非 ASCII 字符。”

但另一个潜在的解决方案是在 Objective C 和 Cocoa 框架中使用*蛮力*方法，例如：

```
NSWindow * openCVWindow = [[NSApplication sharedApplication] mainWindow];
if(openCVWindow)
{
    [openCVWindow setTitle: @"欢迎来到细胞图像处理的世界！"];
} else {
    NSLog( @"openCV's window isn't considered a main window!");
} 
```

# javascript - 使用 jQuery 在每个链接后将 PHP 响应加载到 DIV

> ID：14048804
> 
> 赞同：-2
> 
> 时间：2012-12-27T02:49:32.463
> 
> 标签：javascript, jquery, ajax

我有一个结构如下的表。我希望 PHP 脚本在显示在相应行下方的 DIV 中执行，而不只是链接到外部 PHP 脚本。我想这可以通过插入一个跨越表的行来完成，其中包含一个 DIV，然后在该 DIV 中加载外部脚本。

```
<table width="100%" border="0" cellspacing="0" cellpadding="5">
  <tr class="tableTitle">
    <td></td>
    <td>Category</td>
    <td>Price</td>
    <td>Stock</td>
    <td>Options</td>
  </tr>
  <tr>
    <td><a href="getProduct.php?id=634">007: Quantum of Solace</a></td>
    <td>Gaming > Xbox 360 > Games > Shooter</td>
    <td>$22.00</td>
    <td>0</td>
    <td><a href="productDelete.php?id=634">delete</a></td>
  </tr>
  <tr>
    <td><a href="getProduct.php?id=711">2006 FIFA World Cup Germany</a></td>
    <td>Gaming > Xbox 360 > Games > Sports</td>
    <td>$9.00</td>
    <td>0</td>
    <td><a href="productDelete.php?id=711">delete</a></td>
  </tr>
  <tr>
    <td><a href="getProduct.php?id=148">2010 FIFA World Cup South Africa</a></td>
    <td>Gaming > PlayStation 3</td>
    <td>$15.00</td>
    <td>0</td>
    <td><a href="productDelete.php?id=148">delete</a></td>
  </tr>
</table> 
```

这是我尝试使用的 jQuery 代码：

```
$("a").click( function(event) {
    var clicked = $(this);
    $.get($(this).attr('href'),
    function(data){
        $(clicked).next().find('tr').after(data);
    });
}); 
```

任何帮助表示赞赏:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:12:09.500

我相信你是说你想要 php 在你的 html div 中，这是一个例子，希望这会有所帮助。

```
<?php
$con = mysql_connect("localhost", "cis246", "t@sk93")
or exit(mysql_error());
$db = mysql_select_db("students",$con)
or die(mysql_error());
$sql = mysql_query("select * from CIS110");
echo "<table cellspacing='0' border='1'>";
echo "<tr><th>SID</th><th>FirstName</th><th>LastName</th></tr>";
while($row = mysql_fetch_object($sql)) {
$sid = $row -> SID;
$LastName = $row -> LastName;
$firstName = $row -> FirstName;
echo("<tr><td>$sid</td><td>$LastName</td><td>$FirstName</td></tr>");
}
echo "</table>";
mysql_close($con);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:15:40.157

在文档中按需（使用 javascript）实际执行 PHP 脚本是不可能的。您可以做的是使用 iframe 并使用标签的`target`属性将您的文档加载到其中：`a`

```
<a href=somescript.php target=product123>Link</a>
...
<iframe id=product123 frameborder=0></iframe> 
```

这会将链接的 href 加载到由 target 属性中的 id 指定的 iframe 中，而无需任何 javascript。并记住以某种方式隐藏您的 iframe（css？js？），直到单击所需的链接。您还可以在单​​击链接时动态创建和插入 iframe，但我认为这仅限于同一个域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T07:54:40.437

好吧，我自己使用 Prototype 而不是 jQuery 解决了这个问题。希望这对其他人有帮助。

JavaScript：

```
<script src="js/prototype.js" type="text/javascript"></script> 
<script type="text/javascript">
    function getDetails(targetDiv) {
        new Ajax.Updater(targetDiv, 'productGet.php', { method: 'get', parameters: 'id='+targetDiv });
    }
</script> 
```

HTML：

```
<table width="100%" border="0" cellspacing="0" cellpadding="5">
  <tr class="tableTitle">
    <td></td>
    <td>Category</td>
    <td>Price</td>
    <td>Stock</td>
    <td>Options</td>
  </tr>
    <tr>
    <td><a href="javascript:void(0)" onclick="javascript:getDetails(pid634); return false;">007: Quantum of Solace</a>
      </td>
    <td>Gaming > Xbox 360 > Games > Shooter</td>
    <td>$22.00</td>
    <td>0</td>
    <td><a href="productDelete.php?id=634">delete</a>
      </td>
  </tr>
  <tr>
  <td colspan="5"><div id="pid634"></div></td>
  </tr>
    <tr>
    <td><a href="javascript:void(0)" onclick="javascript:getDetails(pid711); return false;">2006 FIFA World Cup Germany</a>
            <br>
      <span class="offset">2006 FIFA World Cup</span>
      </td>
    <td>Gaming > Xbox 360 > Games > Sports</td>
    <td>$9.00</td>
    <td>0</td>
    <td><a href="productDelete.php?id=711">delete</a>
            <br>
      <a href="productDelete.php?id=711&aliasId=0">delete</a>
      </td>
  </tr>
  <tr>
  <td colspan="5"><div id="pid711"></div></td>
  </tr>
    <tr>
    <td><a href="javascript:void(0)" onclick="javascript:getDetails(pid148); return false;">2010 FIFA World Cup South Africa</a>
      </td>
    <td>Gaming > PlayStation 3</td>
    <td>$15.00</td>
    <td>0</td>
    <td><a href="productDelete.php?id=148">delete</a>
      </td>
  </tr>
  <tr>
  <td colspan="5"><div id="pid148"></div></td>
  </tr>
</table> 
```

如果您使用 jQuery 和 Prototype，请务必避免任何冲突：

```
<script type="text/javascript">
    var $j = jQuery.noConflict();
</script> 
```

# parsing - 解析每条记录超过 1 行的文本文件

> ID：14048807
> 
> 赞同：1
> 
> 时间：2012-12-27T02:50:06.273
> 
> 标签：parsing, concatenation, field, multiline

我需要解析一个文本文件，其中包含数百条记录，每条记录超过 1 行。我是 Python 新手，一直在尝试用 grep 和 awk 以几种复杂的方式做到这一点，但还没有运气。该文件包含如下所示的记录：

**409547095517 911033 00:47:41 C44 00:47:46 D44 00:47:53 00:47:55 (555) 555-1212 00:47 10/31 100 Main Street - NW
Some_City TX 323 WRLS METRO PCS
P# 122 -5217 ALT# 555-555-1212 LEC:MPCSI WIRELESS CALL QUERY CALLER FOR LOCATION QUERY CALLER FOR PHONE #***

如果我可以将这些多行记录压缩为每条记录 1 行，我真的可以做所有我需要做的事情。每条记录将始终以“40”开头，或者我可以让 9110 指示开始，因为这些将始终存在并且是唯一的，前提是 40 位于行首。我使用了十六进制编辑器，发现我可以删除所有换行符（十六进制 0D0A），但这并不比手动编辑文件更好，而且我不需要删除每条记录的最后一个。有些记录将只有 2 行，但大多数将是 5 行，就像这样。

有没有办法python或其他方式将构成记录的行连接成一行，其中 40 或更好的选择，其中 9110 表示记录的开始？

任何想法或指示将不胜感激。我有 python 和一个好的 IDE，我很擅长 grep 和 find 但学习 awk（别笑）......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T03:01:29.250

awk 会做到的。您需要识别开始记录的行。在这种情况下，它是`409547095517` 所以让我们假设如果一行以 8 个数字开头是安全的，它是记录的开始。

```
awk ' NR> 1 && /^[0-9]{8}/ { printf("\n") }  
      {printf("%s", $0) } 
       END{ printf("\n") }'  filename > newfilename 
```

将 更改`{8}`为适合您的任何数字。

# macros - 如何编写宏自动解析符号

> ID：14048811
> 
> 赞同：3
> 
> 时间：2012-12-27T02:51:37.803
> 
> 标签：macros, clojure

我总是喜欢有一种自动解析符号的方法。例如，如果我在“用户”命名空间中并且没有在“clojure.string”命名空间中“使用”符号，而不是：

```
(clojure.string/split "a-b-c" #"-") 
```

我想这样写：

```
(call split "a-b-c" #"-") 
```

我简单地实现了一个“调用”宏，如下所示：

```
(defmacro call [sym & args]
  `(let [fn# (first (distinct (remove nil? (map #(ns-resolve % '~sym) (all-ns)))))]
     (if-not ((meta fn#) :macro) 
       (fn# ~@args)
       (eval (list fn# ~@(map #(list 'quote %) args)))))) 
```

以下测试总是可以的：

```
(call list 'a 'b)
(call apropos "list")
(call doc list)
(call doc clojure.string/split) 
```

当我将宏作为“doc”的参数传递时，就会出现问题：

```
(call doc clojure.repl/doc) 
```

然后，有一个例外：

**CompilerException java.lang.RuntimeException: Can't take value of a macro: #'clojure.repl/doc, compile:(NO_SOURCE_PATH:112)**

所以这就是为什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T07:47:19.657

您可以在编译时在宏中解析符号，如下所示：

```
(defmacro call [sym & args]
  (let [f (first (distinct (remove nil? (map #(ns-resolve % sym) (all-ns)))))]
      `(~f ~@args))) 
```

# reportviewer - 如何在 MS reportviewer/rdlc 中计算计算平均值的平均值？

> ID：14048812
> 
> 赞同：1
> 
> 时间：2012-12-27T02:51:42.353
> 
> 标签：reportviewer, rdlc

我在网上和其他地方搜索过，但没有找到这个确切的问题/解决方案。

我正在使用 MS reportViewer 构建 rdlc 报告 - 我正在创建的报告基于现有电子表格，其中每个月单独计算 6 个月的平均价格，然后将这些价格的平均值计算为 6 个月期间平均价格。我是否同意该方法或者它是否正确无关紧要，我只需要知道如何获得 rdlc 来执行此操作。

例如：

月价格 1 价格 2 增量

5 月至 12 日 $31.54 $30.03 $1.51

12 年 6 月 36.27 美元 34.60 美元 1.67 美元

7 月至 12 日 $44.19 $42.00 $2.19

8 月 12 日 $38.96 $37.06 $1.90

9 月 12 日 $36.89 $35.08 $1.81

10 月 12 日 $35.57 $33.97 $1.60

平均 $37.24 $35.46 $1.78

（抱歉缺少屏幕截图，我是新手，系统不允许我发布图像......）

我创建了一个用于计算每月平均值的 tablix - 我使用表中的一个组按月对 6 个月的数据进行分组（然后隐藏每小时的价格数据，这样你只能看到月份的总行）但我坚持如何计算表格的底行，即每列的平均值。（平均值的平均值与基础数据中所有 6 个月价格的平均值不同——这就是我在这个过程中学到的...... IOW，这是我的第一个解决方案 :-)）

我试图获取平均值的方法是为月份总单元格命名，MonthlyAvgPrice1，然后在底行中使用以下表达式：

Avg(reportitems!MonthlyAvgPrice1.Value)

正如我所预料的那样，这不起作用，当我尝试运行报告时，它得到一个构建错误，说“textrun 'Price1PeriodAvg.Paragraphs[0].TextRuns[0]' 的值表达式使用聚合函数在报表项上。聚合函数只能用于包含在页眉和页脚中的报表项。

希望我已经很好地解释了这一点，有人知道该怎么做吗？

谢谢！-杰格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T10:25:43.307

实际上，从问题中不清楚您是如何将数据特别绑定到报告项目的，但是根据给定的信息，我理解的是您可以

这样尝试：

*   右键单击 tablix 行并在下面插入一行
*   在您想要此**平均值**的单元格中插入以下表达式

    `=Sum(Fields!Price1.Value)/6`

    `=Sum(Fields!Price2.Value)/6`
    并 类似地`=Sum(Fields!Delta.Value)/6`在要显示平均值的其他单元格中插入表达式

当然，您会将字段名称 Price1、Price2 等更改为您从中获取值的字段。

高温高压

# iphone - 另一个滚动视图内的滚动视图内的表格视图

> ID：14048813
> 
> 赞同：2
> 
> 时间：2012-12-27T02:51:47.560
> 
> 标签：iphone, objective-c, ios, uiscrollview

所以我目前有一个问题，我试图将表格视图放在另一个滚动视图内的滚动视图中。这可能吗？

像这样想。我有一个在页面之间左右滚动的父视图，在一个页面上还有另一个滚动视图。在滚动视图（第 1 页）内有 3 个表格视图。

首先，我只想知道这是否可能。

父 Scrollview - 顶视图
Page 1 - scrollview
--Tableview 1
--Tableview 2
--Tableview 3
-Page 2 - scrollview
--Tableview 1
--Tableview 2
--Tableview 3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:05:04.763

一切皆有可能，您只需要对哪个滚动视图/表格视图应该接收滚动进行高级检测。

查看[Apple 官方文档](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/UIScrollView_pg/NestedScrollViews/NestedScrollViews.html)以获取有关如何执行此操作的更多信息。

# iphone - 滚动不适用于标签栏应用程序内的视图

> ID：14048816
> 
> 赞同：1
> 
> 时间：2012-12-27T02:52:25.147
> 
> 标签：iphone, ios, uiscrollview, uitabbarcontroller, uitabbaritem

我创建了一个`tabBar`应用程序，它有两个选项卡，一个`tableView`带有详细信息项，另一个`UIView`带有`UILabel`. 我添加`scrollView`并`detailViewController`放置了所有 UI 项目`scrollView`以进行滚动。我将`scrollView`使用连接`outlet`到我的详细视图并在`detailViewController`

```
[scrollView setScrollEnabled:YES];
    scrollView.contentSize = CGSizeMake(scrollView.frame.size.width,scrollView.frame.size.height); 
```

但是详细视图没有滚动，它的屏幕被锁定。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:04:19.807

对于 UIScrollView，您希望框架为您希望它出现在屏幕上的大小，而内容大小为其能够滚动的大小。因此，要使滚动正常工作，您必须将内容大小设置为大于视图在一个维度或另一个维度上的大小。

# c++ - 将不同类型的数据传递给 void 指针函数以添加到网络数据包（我认为？）

> ID：14048818
> 
> 赞同：0
> 
> 时间：2012-12-27T02:53:23.027
> 
> 标签：c++, networking, void-pointers

**编辑**代码当我最初发布时，我对下面的代码感到非常糟糕。最后我遇到的问题是我得到了我已经传递给函数的大小值的“sizeof”。因此我总是写 4bytes 而不是实际大小。基本上我做了这样的事情：

```
size = sizeof(valueIWantToSend);
finalSizeToWrite = sizeof(size); //derpderpderp 
```

我已经修复了下面的示例代码。

* * *

在创建要发送的网络数据包时，尝试做一些更复杂的事情来尝试清理我的代码。

这个想法是有一个功能，如：

**AppendPacket(dataToBeSent, sizeOfData)**

我坚持的部分是让 dataToBeSent 通过此功能正确复制。

以前我会有几行凌乱的“memcopy”，它们会将数据填充到指定位置的缓冲区中。这种方式有效，经过尝试和测试。尽管有下面的示例，但它的杂乱无章并且需要维护。

```
memcpy((char*)GetBufferPositionIndex(), (char*)&dataToBeSent, sizeof(sizeof(dataToBeSent)));
StepBufferPositionForward(sizeof(dataToBeSent)); 
```

所以，是的，这是我目前在整个游戏代码的各个地方使用的更易于理解的版本，用于打包我需要发送给多人游戏客户端的数据。

我不想在所有地方复制这些行，而是使用我的 AppendPacket() 函数。最初它看起来与此类似：

```
//How I tend to use the function in my code
double playerVelocity = 22.34;
AppendPacket( &playerVelocity, sizeof(playerVelocity) );

//Definition
AppendPacket( void* dataToBeSent, size_t sizeOfData )
{
     memcpy( (char*)GetBufferPositionIndex(), dataToBeSent, sizeof(sizeOfData) );
     StepBufferPositionForward( sizeof(sizeOfData) );
} 
```

从我通过调试可以看出，我实际上是在发送数据的地址，而不是它自己的实际数据。

我已经通过函数和“dataToBeSent”部分尝试了指针符号和地址符号的各种组合，但我没有运气:(

以上需要处理各种数据格式，例如结构、字符数组、单字节、双精度、整数、浮点数等。

关于我应该如何做的任何想法？整个晚上和早上都在绞尽脑汁:(

* * *

对于好奇的：**GetBufferPositionIndex()**本质上返回缓冲区中下一个开始写入的位置。

```
unsigned char packetToBeSentBuffer[PACKET_SIZE];
unsigned char* bufferIndexCurrent;
unsigned char* bufferIndexStartPosition;

unsigned char* GetBufferPositionIndex();
void StepBufferPositionForward(int sizeOfVar);

unsigned char* GetBufferPositionIndex()
{
     return bufferIndexCurrent;
}

void PlayerObj::StepBufferPositionForward(int sizeOfVar)
{
     bufferIndexCurrent += sizeOfVar;
     if (messageToSendIndex > (( bufferIndexStartPosition + PACKET_SIZE) - 200))
     {
           cout << "WARNING: Packet for this tick has less than 200 bytes left until full\n";
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:05:45.187

在不知道代码最终如何进入套接字读取/写入以及缓冲区如何工作的情况下，我不完全确定现在确切的问题出在哪里，但这里有一个建议，以进一步简化您的代码。

该代码仍然容易出错，因为您需要确保您传递的数据大小是正确的。新功能的一个错误的复制粘贴错误的大小，你又遇到了错误。对于这些情况，我总是建议一个简单的模板：

```
template <typename T>
AppendPacket( T& data )
{
    std::size_t size = sizeof(T);
    memcpy( some_destination, &data, size );
    StepBufferPositionForward( size );
}

struct whatever a;
AppendPacket(a);

double b;
AppendPacket(b);

int c[5] = {1, 2, 3, 4, 5};
AppendPacket(c); 
```

这样，编译器每次都会为您计算出数据的大小。

关于缓冲区，固定大小会出现问题，因为目前 AppendPacket 不处理超过数据包大小的情况。有两种解决方案：

*   获取要写入缓冲区的位置时抛出异常
*   有一个可动态调整大小的缓冲区

我将举例说明如何处理第二种情况：

```
class Client
{
    std::vector<char> nextPacket;

public:

    template <typename T>
    AppendToPacket( T& data )
    {
        // figure out the size
        std::size_t size = sizeof(T);

        // expand vector to accomodate more space
        nextPacket.reserve(size);

        // append the data to the vector
        std::copy_n( static_cast<char const*>(&data),
                     size,
                     std::back_inserter(nextPacket) );
    }

} 
```

# css - 这个下拉菜单如何显示 ^？

> ID：14048819
> 
> 赞同：4
> 
> 时间：2012-12-27T02:53:29.660
> 
> 标签：css

我刚刚找到了一个不错的脚本，你可以在这里看到

[http://demo.tutorialzine.com/2012/10/css3-dropdown-menu/](http://demo.tutorialzine.com/2012/10/css3-dropdown-menu/)

我看到下拉列表顶部有一个小^。在css上我可以找到这个：

```
#colorNav li ul li:first-child:before{ 
    content:none;
    position:absolute;
    width:1px;
    height:1px;
    border:5px solid transparent;
    border-bottom-color:#313131;
    left:50%;
    top:-10px;
    margin-left:-5px;
} 
```

只有我不明白这是如何工作的；和边界有关系吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-27T03:12:34.460

此 CSS 对以下标记进行操作（为简单起见已简化）：

```
<nav id="colorNav">
    <ul>
        <li class="green">
            <a href="#" class="icon-home"></a>
            <ul>
                <li><a href="#">Back to the tutorial</a></li>
                <li><a href="#">Get help</a></li>
            </ul>
        </li>
        <li class="red">
            <a href="#" class="icon-cogs"></a>
            <ul>
                <li><a href="#">Payment</a></li>
                <li><a href="#">Notifications</a></li>
            </ul>
        </li>
    </ul>
</nav> 
```

选择器的目标是`:before`最内层元素上的伪元素，这些`li`元素也是其父元素中的第一个元素：

```
#colorNav li ul li:first-child:before 
```

此处的代码中缺少但在原始教程中存在的以下注释：

```
/* the pointer tip */ 
```

这组特殊的规则用于创建出现在下拉菜单顶部的小三角形，指向其关联的块（如下图，用红色圆圈强调）：

![在此处输入图像描述](../Images/f6d4ed9a2682375d8fdd695ef78b050a.png)

然后创建这个三角形的样式如下：

```
content: none;                  /* Pseudo-element has no content    */
position: absolute;             /* It's positioned absolutely       */
width: 1px;                     /* It has a width of 1 pixel        */
height: 1px;                    /* And a height of 1 pixel too      */
border: 5px solid transparent;  /* Applies initial border style     */
border-bottom-color: #313131;   /* Overrides bottom border color    */
left: 50%;                      /* Moves it half-way from the left  */
top: -10px;                     /* And 10px up above the element    */
margin-left: -5px;              /* Margin, half of width, to center */ 
```

最终结果是一个纯粹用 CSS 中的边框创建的三角形。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T03:00:15.783

`#colorNav li ul li:first-child`它在with的前面创建一个假区域，`content:'';`并使用其他 css 样式管理该区域。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T03:03:16.233

```
#colorNav li ul li:first-child:before { ... } 
```

:first-child 选择器用于选择指定的选择器，仅当它是其父项的第一个子项时。

```
content:''; 
```

content 属性与 :before 和 :after 伪元素一起使用，以插入生成的内容。

希望对你有帮助？

# html - 是否有一种确定的方法来衡量性能的“绘制时间”？

> ID：14048825
> 
> 赞同：4
> 
> 时间：2012-12-27T02:54:19.987
> 
> 标签：html, performance

我正在为一个大型网站测试各种性能调整，我需要量化从初始加载到出现文档元素的时间（即绘制时间）。有没有使用 Chrome 的开发分析器的好方法？

为了澄清，我需要知道从加载到绘制页面的总时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T19:18:26.990

您可以做以下两件事之一：1）使用丹市长的方法。您可以简单地`new Date().getTime`在绘画脚本之前和之后使用并减去它们，以找出脚本完成所需的时间。但是，如果整个代码滞后，这可能会滞后。这不一定是最准确的方法，但它可以完成工作。（但是，您可以创建一个单独的函数来独立于其他脚本计算时间。见下文：）

```
function findTime(done){
if (done==false){var time1 = new Date.getTime();}
if (done==true) {var time2 = new Date.getTime(); window.alert(time2-time1);}
} 
```

`done`脚本完成后要添加的布尔参数在哪里。

2) Chrome has a nice developer's console with a timeline capability. Basically, open your Chrome browser and hit command+Shift+C (control+shift+C for windows), and click the timeline button. Then, click the little dot at the bottom of the console, and it should turn red. Refresh the page, and the timeline will start collecting all kinds of timing data for your scripts. Painting events are shown in green. Unfortunately, this is a third party solution.

In the end, there is no way to directly measure this time, due to different amounts of lag, different internet connectivity speeds, processor speeds, etc. However, these 2 methods come pretty close to the actual answer. You may want to test the scripts on different browsers and computers.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T02:58:06.637

对于初学者，我肯定会熟悉 Firebug 中的“网络面板”：

*   [http://getfirebug.com/network](http://getfirebug.com/network)

我知道 Chrome 有一个类似的工具：点击“F12”（或使用“扳手”图标）：

*   [https://developers.google.com/chrome-developer-tools/](https://developers.google.com/chrome-developer-tools/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T03:08:29.647

您可能想查看“DOMContentLoaded”事件，这是 jQuery 绑定到的以提供它的 .ready() 方法。基本思想是您将要使用 Date.getTime() 记录毫秒值，第一行应该是文档的最后一行（用于 html 下载标记）。在 onload、DOMContentLoaded、loaded 和其他 DOM 就绪状态事件之后要调用的第二个。

快速示例（您的 html 输出结束）：

```
<script type="text/javascript">
    window.downloadComplete = new Date().getTime();
    document.onload = function() { window.domParseComplete = new Date().getTime(); }
    window.onload = function { window.renderComplete = new Date().getTime(); }
    window.paintTime = window.renderComplete - window.downloadComplete;
</script> 
```

在此示例中，window.downloadComplete 将是 DOM 完成下载的毫秒数，window.domParseComplete 是 DOM 已解析的毫秒数，window.renderComplete 是窗口报告其渲染完成的毫秒数。window.paintTime 只是从这些毫秒时间计算的毫秒数。

# symfony - 尝试部署时“/app/config/parameters.ini 文件无效”

> ID：14048828
> 
> 赞同：0
> 
> 时间：2012-12-27T02:54:47.927
> 
> 标签：symfony

当我尝试使用 Capifony 部署 Symfony2 应用程序时出现以下错误：

> “/path/cap/myapp/releases/20121227024938/app/config/parameters.ini”文件无效。

这就是parameters.ini对我的样子：

```
; These parameters can be imported into other config files
; by enclosing the key with % (like %database_user%)
; Comments start with ';', as in php.ini
[parameters]
    database_driver   = pdo_mysql
    database_host     = localhost
    database_name     = symfony
    database_user     = root
    mailer_transport  = smtp
    mailer_host       = localhost
    locale            = en
    secret            = ThisTokenIsNotSoSecretChangeIt 
```

直到最近，我才能正常部署。parameters.ini 文件只是从示例中复制而来。可能是什么交易？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T02:57:32.987

您必须更改“秘密”令牌。将“ThisTokenIsNotSoSecretChangeIt”更改为密码短语或字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T21:38:15.283

由于 Symfony 2.1 使用`parameters.yml`and not `parameters.ini`，所以我决定放弃`parameters.ini`对它的任何引用。这解决了问题。

# gradle - 从 Gradle 中的自定义测试任务中过滤资源，目标是拥有一个用于测试的属性文件和一个用于生产的不同属性文件

> ID：14048830
> 
> 赞同：0
> 
> 时间：2012-12-27T02:55:16.587
> 
> 标签：gradle

因此，我设置了一种使用此配置运行集成测试的方法：

```
test {
    exclude "**/*IntegrationTest*.class"
}

task integrationTest(type: Test, dependsOn: testClasses) {
    include "**/*IntegrationTest*.class"
}

check.dependsOn integrationTest 
```

效果很好。但是为了登录我的集成测试，我想使用来自特定目录的 log4j.properties 文件，而不是位于`src/main/resoures`用于生产的目录中的文件。

我试过这个但没有用：

```
 integrationTest.classpath = files("$rootDir/test/src/main/resources/log4j.properties") + integrationTest.classpath 
```

我还试图看看我是否可以排除该文件，但找不到方法。试过这个：

```
 processTestResources.exclude "**/*log4j.properties" 
```

关于在生产中包含一个属性文件并在测试中包含另一个属性文件的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T09:08:09.827

如果您将“测试”log4j.properties 放在`src/test/resources`目录中，它实际上会出现在`src/main/resources`测试/集成测试的类路径中的任何内容之前。

另一种解决方案是设置您的捆绑，以便生产的 log4j.properties 不在 src/main/resources 中，而是从不同的目录添加到 jar...

```
jar {
  from('production') {
    include('log4j.properties')
  }
} 
```

如果您想将`log4j.properties`文件保留在其当前位置，那么您几乎已经完成了尝试。在类路径上，您可以拥有 jar 文件或包含资源的目录。所以尝试这样做：

```
integrationTest.classpath = files("$rootDir/test/src/main/resources") + integrationTest.classpath 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T16:02:49.863

似乎您也可以这样做，以便 .jar 任务稍后包含它：

```
sourceSets {
  main {
    java {
      srcDir 'src/main/java'
      output.classesDir   = 'build/classes/main'      
    }
    resources {
      srcDir 'src/main/resources'
      include 'logback.xml'
      output.resourcesDir = 'build/resources/main'
    }
  }
} 
```

# python - 如何从字典中的每个值列表中选择一个项目的所有排列？

> ID：14048832
> 
> 赞同：1
> 
> 时间：2012-12-27T02:55:52.973
> 
> 标签：python, list, dictionary, permutation

朋友们，基本上，我想听听：

```
fruit_dict = {'oranges':['big','small'],'apples':['green','yellow','red']} 
```

并通过在不同键的所有值之间进行所有可能的排列来获得以下字典列表：

```
output_list = 
[
{'oranges':'big','apples':'green'},
{'oranges':'big','apples':'yellow'},
{'oranges':'big','apples':'red'},
{'oranges':'small','apples':'green'},
{'oranges':'small','apples':'yellow'},
{'oranges':'small','apples':'red'}
] 
```

怎么做？太感谢了！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-27T03:04:22.350

您要寻找的不是排列，而是[笛卡尔积](http://docs.python.org/2/library/itertools.html#itertools.product)。把它想象成一个嵌套循环。

```
from itertools import product

fruit_dict = {'oranges':['big','small'],'apples':['green','yellow','red']}    

keys, values = zip(*fruit_dict.items())
print [dict(zip(keys, value_list)) for value_list in product(*values)] 
```

然后，您只需使用现有密钥和产品中的每个项目创建一个新字典。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:15:31.063

使用`itertools.product()`：

```
In [94]: dic = {'oranges':['big','small'],'apples':['green','yellow','red']}

In [95]: sort_values=[x[1] for x in sorted(dic.items())]  #sorted values based on keys

In [96]: [dict(zip(sorted(dic.keys()),x)) for x in product(*sort_values)]
Out[96]: 
[{'apples': 'green', 'oranges': 'big'},
 {'apples': 'green', 'oranges': 'small'},
 {'apples': 'yellow', 'oranges': 'big'},
 {'apples': 'yellow', 'oranges': 'small'},
 {'apples': 'red', 'oranges': 'big'},
 {'apples': 'red', 'oranges': 'small'}] 
```

# webgl - 如何处理多个collada场景？

> ID：14048834
> 
> 赞同：1
> 
> 时间：2012-12-27T02:56:03.173
> 
> 标签：webgl, three.js

我想通过以下方式使用 Three.js 处理多个 collada 文件：

1.  加载并显示“01.dae”。过一会儿就毁掉这一幕。
2.  成功销毁“01.dae”后，加载并显示“02.dae”。过一会儿也毁掉这个场景。
3.  ...

我怎么能这样做？谢谢！

# jsf - 可以使用 java 代码停止 VMware vFabric 服务器中的应用程序

> ID：14048840
> 
> 赞同：0
> 
> 时间：2012-12-27T02:56:54.950
> 
> 标签：jsf, web-applications, vmware

我正在使用`vfabric-tc-server-standard-2.8.1`. 我在 vFabric 中创建了实例“项目”，例如：

```
C:/../../vfabric-tc-server-standard-2.8.1/project/ 
```

我创建了两个 Web 应用程序“Demo1”和“Demo2”。
我将“Demo1.war”和“Demo2.war”都部署到该项目中：

```
C:/../../vfabric-tc-server-standard-2.8.1/project/webapps/Demo1.war
C:/../../vfabric-tc-server-standard-2.8.1/project/webapps/Demo2.war 
```

我的“Demo2”项目有一个简单的 JSP 页面。该页面包含 2 个按钮“停止 Demo1 应用程序”和“启动 Demo1 应用程序”。

当我按下“停止 Demo1 应用程序”时，我需要停止“Demo1”应用程序。当我按下“Start Demo1 Apps”时，我需要启动“Demo1”应用程序。是否可以使用 Java 代码启动和停止 vFabric 中的特定应用程序？

# c# - 如何在滑块等自定义控件中使用 RangeBaseValueChangedEventArgs 事件参数

> ID：14048844
> 
> 赞同：0
> 
> 时间：2012-12-27T02:58:01.973
> 
> 标签：c#, events, windows-8, slider, windows-store-apps

现在我自定义了一个像滑块这样的控件，我想自定义一个 ValueChanged 事件句柄，比如滑块的 ValueChanged 事件句柄。

事件如下：

```
public delegate void ValueChangedEventHandle(object sender, RangeBaseValueChangedEventArgs e);
public event ValueChangedEventHandle ValueChanged; 
```

当值改变时，我调用事件ValueChanged，像这样

```
 private void Changed(double value)
    {
      `enter code here`if (ValueChanged != null)
      {
           rangeBaseValueChangedEventArgs.NewValue = newValue;
           rangeBaseValueChangedEventArgs.OldValue = oldValue;
           ValueChanged(this, RangeBaseValueChangedEventArgs);
      }
} 
```

但是 RangeBaseValueChangedEventArgs 类是密封类，没有构造函数，所以我无法创建新实例。

任何人都知道怎么做，我只想定义一个事件参数，比如滑块的 RangeBaseValueChangedEventArgs ，这样我就可以像滑块一样使用它。

预先感谢您。

-艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:13:22.927

只需创建您自己的 EventArgs 类继承自`RoutedEventArgs`并使其具有相同的属性。

# visual-studio-2012 - Intellisense，在 Visual Studio 2012 中使用 RequireJS 自动完成

> ID：14048851
> 
> 赞同：3
> 
> 时间：2012-12-27T02:58:25.343
> 
> 标签：visual-studio-2012, requirejs

我知道 javascript intellisense 在 vs2012 中通过 _referencs.js 支持。目前，我在前端使用 RequireJS，但我认为自从我开始使用 RequireJS 以来，我失去了对 javascript 的自动完成支持。

[我从这里](https://github.com/jrburke/requirejs-intellisense)找到了 require.intellisense.js ，但不幸的是，经过几个小时的尝试，它失败了。

有没有人成功在 vs2012 中使用 RequireJS（版本 2.1.2）自动完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T14:16:31.627

通过遵循此代码项目文章，我让 Intellisense 在 RequireJS 定义的模块中工作：http: [//www.codeproject.com/Articles/460836/Making-the-most-out-of-JavaScript-Intellisense-in](http://www.codeproject.com/Articles/460836/Making-the-most-out-of-JavaScript-Intellisense-in)

下载代码位于此链接： [https](https://github.com/chrisprice/PropertyFinder-HTML5/zipball/master) ://github.com/chrisprice/PropertyFinder-HTML5/zipball/master 具有有效 Intellisense 的解决方案是 iPhone 解决方案。

您需要下载文章中引用的代码并尝试一下。在下载代码和那篇文章之间，您应该能够从那里获取它以在您自己的项目中实现 Intellisense。

文章的源代码中有一个 require.intellisense.js 文件，该文件对正确操作至关重要。我不确定是谁写的，但它与您从 jrburke 引用的不同。

如果您有任何后续问题，我很乐意为您提供帮助。

# php - DomPDF - Cached_PDF_Decorator 声明错误

> ID：14048855
> 
> 赞同：0
> 
> 时间：2012-12-27T02:59:23.300
> 
> 标签：php, interface, implementation, dompdf, construct

致命错误：Cached_PDF_Decorator::_ *construct() 的声明必须与*第 22 行 /my/path/to/cached_pdf_decorator.cls.php中的 Canvas::_construct() 的声明兼容

Cached_PDF_Decorator 中的相关代码：

```
class Cached_PDF_Decorator extends CPDF_Adapter implements Canvas {
...
function __construct($cache_id, CPDF_Adapter $pdf) {
  $this->_pdf = $pdf;
  $this->_cache_id = $cache_id;
  $this->_fonts = array();

  $this->_current_page_id = $this->_pdf->open_object();
} 
```

接口Canvas中的相关代码：

```
interface Canvas {
function __construct($paper = "letter", $orientation = "portrait", DOMPDF $dompdf); 
```

Cached_PDF_Decorator 的 __construct 中的参数不应该与 Canvas 中的参数匹配吗？谢谢！

# django - 尝试上传 ImageField 时 CSRF 失败

> ID：14048856
> 
> 赞同：1
> 
> 时间：2012-12-27T02:59:23.053
> 
> 标签：django

我有一个带有 ImageField 表单的 django 模板，允许用户在网站上上传图片。

1) 表单包含 {% csfr_token %} 2) 我用渲染变量渲染模板。

另外，我在模板的表单中设置了 enctype="multipart/form-data" 吗？

我仍然得到一个CSFR验证。失败。任何人都可以帮忙吗？

来自 template.html 的代码

```
<form enctype="multipart/form-data" action='{% url photo username %}' method="post">
            {% csrf_token %}
              <p>{{ form.non_field_errors }}</p>
              <p>{{ form.profile_picture.label_tag }} {{ form.profile_picture.help_text }}</p>
              <p>
              {{ form.profile_picture.errors }}
              {{ form.profile_picture }}
              </p>
              <p><input type="submit" value="Upload" /></p>
            </form> 
```

风景：

```
def upload_photo(request, nick):
#c = {}
#c.update(csrf(request))
if request.method == 'POST':
    form = PictureForm(request.POST, request.FILES)
    if form.is_valid():
        newpic = Picture(profile_picture = request.FILES['profile_picture'])
        newpic.save()

        # Redirect to the document list after POST
        return HttpResponseRedirect(reverse('profiles.views.upload_photo', args=[nick]))
else:
    form = PictureForm() # A empty, unbound form

# Load documents for the list page
pictures = Picture.objects.all()

# Render list page with the documents and the form
return render_to_response(
    'profile.html',
             #various render variables here
             }) 
```

更新：追溯

```
Environment:

Request Method: POST
Request URL: localhost/hello/john/

Django Version: 1.4.2
Python Version: 2.7.2
Installed Applications:
('django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'django.contrib.admindocs',
 'friendship',
 'search',
 'tour',
 'profiles')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/home/mike/Documents/ics/django/ics/profiles/views.py" in upload_photo
  18\.           newpic.save()
File "/usr/local/lib/python2.7/dist-packages/django/db/models/base.py" in save
  463\.         self.save_base(using=using, force_insert=force_insert, force_update=force_update)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/base.py" in save_base
  551\.                 result = manager._insert([self], fields=fields, return_id=update_pk, using=using, raw=raw)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/manager.py" in _insert
  203\.         return insert_query(self.model, objs, fields, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/query.py" in insert_query
  1593\.     return query.get_compiler(using=using).execute_sql(return_id)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/sql/compiler.py" in execute_sql
  909\.         for sql, params in self.as_sql():
File "/usr/local/lib/python2.7/dist-packages/django/db/models/sql/compiler.py" in as_sql
  872\.                 for obj in self.query.objs
File "/usr/local/lib/python2.7/dist-packages/django/db/models/fields/files.py" in pre_save
  249\.             file.save(file.name, file, save=False)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/fields/files.py" in save
  85\.         name = self.field.generate_filename(self.instance, name)
File "/home/mike/Documents/ics/django/ics/profiles/models.py" in get_image_name
  8\.    name =  str(instance.user_id) + ".jpg"
File "/usr/local/lib/python2.7/dist-packages/django/db/models/fields/related.py" in __get__
  343\.                 raise self.field.rel.to.DoesNotExist 
```

我发现错误在这里（models.py）：

```
def get_image_name(instance, filename):
    return  str(instance.user_id) + ".jpg"
    #str(____) + ".jpg" causes the exception

class Picture(models.Model):
    user_id = models.ForeignKey(User)
    profile_picture = models.ImageField(storage=OverwriteStorage(), upload_to=get_image_name) 
```

任何想法为什么会发生这种情况？

我想要做的是保存用户上传的图片和他们的用户名。但是如何在models.py 中获取用户的用户名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:36:20.603

由于您没有使用 csrf 令牌手动更新上下文，因此您必须在渲染到响应方法中使用 RequestContext

```
return render_to_response('profile.html', { 
   ..your data dict.. }, context_instance=RequestContext(request)) 
```

请参阅[https://docs.djangoproject.com/en/1.2/ref/templates/api/#subclassing-context-requestcontext](https://docs.djangoproject.com/en/1.2/ref/templates/api/#subclassing-context-requestcontext)（我链接到旧版本的 django，因为您仍然使用函数样式视图）

编辑：

现在 csrf 问题已解决，您正在处理一个单独的新错误。尝试在您的图片模型中将“user_id”更改为“用户”（以保持一致性）并`str(instance.user.username)`在您的 get_image_name 中使用。即使这不起作用（它通常应该），请在原始请求已得到回答时发布一个新问题。人们可以搜索 csrf 并在这里结束，阅读一个不相关的问题。

# java - 使用 mysql 和 Java

> ID：14048858
> 
> 赞同：1
> 
> 时间：2012-12-27T02:59:31.773
> 
> 标签：java, mysql, prepared-statement

所以我正在使用 Java 在 SQL 中创建一个数据库，但我一直遇到一个我无法解决的问题。非常感谢一些帮助。我正在使用以下代码将数据读入数据库。我目前将数据库命名为 newTestTable2，它有 4 列：stockID (INT)、millisFromMid (INT)、bidPrice (DOUBLE) 和 askPrice (DOUBLE)。我正在尝试使用准备好的语句向数据库添加新信息，使用 stockID 作为主键，但我遇到了很多麻烦。这是代码：

```
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.PreparedStatement;
import java.util.zip.GZIPInputStream;

public class ReadGZippedTAQQuotesFile {

    // Header fields

    protected int _secsFromEpoch;
    protected int _nRecs;

    // Record fields

    protected int   [] _millisecondsFromMidnight;
    protected int   [] _bidSize;
    protected float [] _bidPrice;
    protected int   [] _askSize;
    protected float [] _askPrice;

    public int getSecsFromEpoch () { return _secsFromEpoch; }
    public int getNRecs         () { return _nRecs;         }

    public int   getMillisecondsFromMidnight ( int index ) { return _millisecondsFromMidnight[ index ]; }
public int   getBidSize                  ( int index ) { return _bidSize[ index ];                  }
public float getBidPrice                 ( int index ) { return _bidPrice[ index ];                 }
public int   getAskSize                  ( int index ) { return _askSize[ index ];                  }
public float getAskPrice                 ( int index ) { return _askPrice[ index ];                 }

public static Connection connect = null;
public static PreparedStatement pst = null;
public static PreparedStatement pst1 = null;
public static PreparedStatement pst2 = null;
public static PreparedStatement pst3 = null;
public static ResultSet resultSet = null;

/**
 * Constructor - Opens a gzipped TAQ quotes file and reads entire contents into memory.
 * 
 * @param filePathName Name of gzipped TAQ quotes file to read
 * @throws IOException 
 */
public ReadGZippedTAQQuotesFile( File filePathName ) throws IOException {

    // Open file 

        InputStream in = new GZIPInputStream( new FileInputStream( filePathName ) );
        DataInputStream dataInputStream = new DataInputStream( in );

    // Read and save header info

        _secsFromEpoch = dataInputStream.readInt();
        _nRecs = dataInputStream.readInt();

    // Allocate space for data

        _millisecondsFromMidnight = new int   [ _nRecs ];
        _bidSize                  = new int   [ _nRecs ];
        _bidPrice                 = new float [ _nRecs ];
        _askSize                  = new int   [ _nRecs ];
        _askPrice                 = new float [ _nRecs ];

    // Read all records into memory

        for( int i = 0; i < _nRecs; i++ )
            _millisecondsFromMidnight[ i ] = dataInputStream.readInt();

        for( int i = 0; i < _nRecs; i++ )
            _bidSize[ i ] = dataInputStream.readInt();

        for( int i = 0; i < _nRecs; i++ )
            _bidPrice[ i ] = dataInputStream.readFloat();

        for( int i = 0; i < _nRecs; i++ )
            _askSize[ i ] = dataInputStream.readInt();

        for( int i = 0; i < _nRecs; i++ )
            _askPrice[ i ] = dataInputStream.readFloat();

    // Finished reading - close the stream

        dataInputStream.close();

}

/**
 * Example of using this class to read a TAQ quotes file and access
 * individual records.
 * @throws ClassNotFoundException 
 * @throws SQLException 
 */
public static void quotesReader() throws ClassNotFoundException, SQLException {
    File f = new File("/Users/Adam/Desktop/SQL Folder/20070620/20070620");
    File[] files = f.listFiles();

    try {

        // This will load the MySQL driver
        Class.forName("com.mysql.jdbc.Driver");

        // Setup the connection with the DB
        connect = DriverManager.getConnection( 
                "jdbc:mysql://localhost:3306/newTest", "root", "Kariya"
                );

        // Statements allow us to issue SQL queries to the database
        pst = connect.prepareStatement("INSERT INTO newTestTable2(stockID) VALUES(?)");
        pst1 = connect.prepareStatement("INSERT INTO newTestTable2(millisFromMid) VALUES(?)");
        pst2 = connect.prepareStatement("INSERT INTO newTestTable2(bidPrice) VALUES(?)");
        pst3 = connect.prepareStatement("INSERT INTO newTestTable2(askPrice) VALUES(?)");

        // Read entire TAQ quotes file into memory

        pst.setInt(1, 0);
        pst.executeUpdate();

        for( int i=0; i < files.length; i++) {
            ReadGZippedTAQQuotesFile taqQuotes = new ReadGZippedTAQQuotesFile( files[i] );

            pst.setInt(1, i+1);
            pst.executeUpdate();

            // Iterate over all records, writing the contents of each to the console

            int nRecs = taqQuotes.getNRecs();
            for( int j = 0; j < nRecs; j++ ) {

                pst1.setInt(1, taqQuotes.getMillisecondsFromMidnight( j ));
                pst1.executeUpdate();
                pst2.setDouble(1, taqQuotes.getBidPrice( j ));
                pst2.executeUpdate();
                pst3.setDouble(1, taqQuotes.getAskPrice( j ));
                pst3.executeUpdate();

                /*

                System.out.println(
                        taqQuotes.getMillisecondsFromMidnight( j )
                        + ","
                        + taqQuotes.getBidSize( j )
                        + ","
                        + taqQuotes.getBidPrice( j )
                        + ","
                        + taqQuotes.getAskSize( j )
                        + ","
                        + taqQuotes.getAskPrice( j )
                        );

                */
            }
        }
    } catch (IOException e1) {
        e1.printStackTrace();
    } finally {
        try {
            if (pst != null) {
                pst.close();
            }
            if (pst1 != null) {
                pst1.close();
            }

            if (pst2 != null) {
                pst2.close();
            }

            if (pst3 != null) {
                pst3.close();
            }

            if (connect != null) {
                connect.close();
            }
        } catch (Exception e) {

        }
    }
}

public static void main( String[] args ) throws ClassNotFoundException, SQLException {
    quotesReader();
}

} 
```

我得到以下异常

```
 Exception in thread "main"
  com.mysql.jdbc.exceptions.jdbc4.MySQLIntegrityConstraintViolationException:
  Duplicate entry '0' for key 'PRIMARY'" 
```

所以我知道它告诉我我使用同一个股票 ID 的次数太多了，但是如果我不使用以下行：

```
pst.setInt(1, 0);
pst.executeUpdate(); 
```

然后它返回`stockID`没有默认值，这看起来也很奇怪，因为 INT 应该有一个默认值 0 对吗？看起来这段代码应该在正确的附近，但我看不出是什么导致了这个错误。任何人都可以分享一些见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:09:56.383

你真的需要4个准备好的陈述吗？您是否需要为每个 taqQuotes 插入 1 行数据？如果是这样，那么我会这样做：

```
public static void quotesReader() throws ClassNotFoundException, SQLException {
  File f = new File("/Users/Adam/Desktop/SQL Folder/20070620/20070620");
  File[] files = f.listFiles();

  try {
    Class.forName("com.mysql.jdbc.Driver");
    connect = DriverManager.getConnection( 
            "jdbc:mysql://localhost:3306/newTest", "root", "Kariya"
            );
    long counter = 1; // place this before the for(int i=0...) loop
    pst = connect.prepareStatement("INSERT INTO newTestTable2(stockID, millisFromMid, bidPrice, askPrice) VALUES(?,?,?,?)");

    for( int i=0; i < files.length; i++) {
      ReadGZippedTAQQuotesFile taqQuotes = new ReadGZippedTAQQuotesFile( files[i] );
      int nRecs = taqQuotes.getNRecs();
      for( int j = 0; j < nRecs; j++ ) {
        pst.setInt(1, counter++);
        pst.setInt(2, taqQuotes.getMillisecondsFromMidnight( j ));
        pst.setDouble(3, taqQuotes.getBidPrice( j ));
        pst.setDouble(4, taqQuotes.getAskPrice( j ));
        pst.executeUpdate();
      }
    }
  } catch (IOException e1) {
    e1.printStackTrace();
  } finally {
    try {
        if (pst != null) {
            pst.close();
        }
        if (connect != null) {
            connect.close();
        }
    } catch (Exception e) {

    }
  }
} 
```

这将为每个 taqQuotes 插入 1 条记录，而不是 4 条记录，每条记录仅填充一列

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:13:23.080

你好朋友你需要改变你的代码。

在您正在执行的第一个 for 循环中`pst.executeUpdate()`，其中包含查询`"INSERT INTO newTestTable2(stockID) VALUES(?)"`。在内部循环中，您也在执行不包含主键的准备好的语句。由于股票 id 不是自动递增字段，您需要在插入记录时显式传递它.顺便说一下，你不需要两个循环来完成这项任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T18:54:39.707

这里的问题是我想使用 stockID 作为主键，同时使用 stockID 来识别每只股票。这行不通，因为我每只股票有数百行数据，所以我需要 stockID 才能重复。正如上面的每个人都指出的那样，主键应该是唯一的。我尝试了 JScoobyCed 建议的方向，它确实有助于清理代码，但仍然存在唯一性问题。所以我找到的解决方案是不要将 stockID 作为主键，而是将行计数器作为主键。

顺便说一句，我的代码可能不是解决这类问题的最佳方法，因为它非常慢，但它确实有效。学习更快的方法将大量数据输入 SQL 会很有趣。

# git - 将 HTML5 样板合并为 Git 子模块，还是有更好的选择？

> ID：14048862
> 
> 赞同：2
> 
> 时间：2012-12-27T03:00:17.177
> 
> 标签：git, git-submodules, html5boilerplate

我正在构建一个 Pythonic Web 应用程序框架，理想情况下，我希望静态文件（应用程序框架的一小部分）基于[HTML5 样板](https://github.com/h5bp/html5-boilerplate)，因为 h5bp 在跨浏览器合规性等方面投入了大量精力。复制样板文件不允许我提取 h5bp 所做的上游更改，但是 html5 样板文件也不会导致自己用作 Git 子模块，除非我决定将我的应用程序的所有静态文件放在 html5 样板文件中并处理它作为一个子模块。

```
README.md
runserver.py
app_pkg/
  config/
  templates/
  controllers/
  models
  static/       <-- Make this html5-boilerplate submodule? 
```

然后我所有的静态文件都进入 html5-boilerplate repo，因此不再单独跟踪 html5-boilerplate 源代码。:(

这里有两个更大的问题。Git 不能*很好地*处理一些源文件是我自己的并且其他源文件跟踪远程存储库（如 html5-boilerplate）的项目。你可以有多个远程仓库，但你不能单独跟踪更改。或者，如果来自其他存储库的源文件足够模块化，可以用作 Git 子模块，则它们可以包含在项目中。然而，对于这个用例，html5-boilerplate 似乎不够模块化。

其他人如何设法将 html5-boilerplate 合并到更大系统的源代码中并重新排列目录，同时仍然单独跟踪 html5-boilerplate 更改？目前可能没有完美的解决方案来解决这个问题，但我想确保我不会错过一些出色的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:15:38.467

一种选择是使用[`git-subtree`](https://github.com/apenwarr/git-subtree)进行子树合并，将 h5bp 存储库引入您选择的目录。然后，您可以`git-subtree`用最小的努力在以后合并上游更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T06:03:21.363

您可以跟踪软链接，它可能是您正在寻找的。

# php - 网站上的记录集导航问题

> ID：14048867
> 
> 赞同：0
> 
> 时间：2012-12-27T03:01:25.330
> 
> 标签：php, html, sql, navigation, recordset

我正在制作一个动态博客，它从 SQL 数据库中提取帖子，我尝试添加一些记录集导航，但是当我按“下一步”时它不会翻阅帖子。这是此页面的 SQL 部分的编码：

```
mysql_select_db($database_blog, $blog);
$query_getArchives = "SELECT DISTINCT DATE_FORMAT(news.updated, '%M %Y') AS archive, DATE_FORMAT(news.updated, '%Y-%m') AS link FROM news ORDER BY news.updated DESC";
$getArchives = mysql_query($query_getArchives, $blog) or die(mysql_error());
$row_getArchives = mysql_fetch_assoc($getArchives);
$totalRows_getArchives = mysql_num_rows($getArchives);

mysql_select_db($database_blog, $blog);
$query_getRecent = "SELECT news.post_id, news.title FROM news ORDER BY news.updated DESC LIMIT 10";
$getRecent = mysql_query($query_getRecent, $blog) or die(mysql_error());
$row_getRecent = mysql_fetch_assoc($getRecent);
$totalRows_getRecent = mysql_num_rows($getRecent);

$maxRows_getDisplay = 10;
$pageNum_getDisplay = 0;
if (isset($_GET['pageNum_getDisplay'])) {
  $pageNum_getDisplay = $_GET['pageNum_getDisplay'];
}
$startRow_getDisplay = $pageNum_getDisplay * $maxRows_getDisplay;

mysql_select_db($database_blog, $blog);
$query_getDisplay = "SELECT news.title, news.pre,  DATE_FORMAT(news.updated, '%M %e, %Y') AS formatted FROM news ORDER BY news.updated DESC";
$query_limit_getDisplay = sprintf("%s LIMIT %d, %d", $query_getDisplay, $startRow_getDisplay, $maxRows_getDisplay);
$getDisplay = mysql_query($query_limit_getDisplay, $blog) or die(mysql_error());
$row_getDisplay = mysql_fetch_assoc($getDisplay);

if (isset($_GET['totalRows_getDisplay'])) {
  $totalRows_getDisplay = $_GET['totalRows_getDisplay'];
} else {
  $all_getDisplay = mysql_query($query_getDisplay);
  $totalRows_getDisplay = mysql_num_rows($all_getDisplay);
}
$totalPages_getDisplay = ceil($totalRows_getDisplay/$maxRows_getDisplay)-1;

$queryString_getDisplay = "";
if (!empty($_SERVER['QUERY_STRING'])) {
  $params = explode("&", $_SERVER['QUERY_STRING']);
  $newParams = array();
  foreach ($params as $param) {
    if (stristr($param, "pageNum_getDisplay") == false && 
        stristr($param, "totalRows_getDisplay") == false) {
      array_push($newParams, $param);
    }
  }
  if (count($newParams) != 0) {
    $queryString_getDisplay = "&" . htmlentities(implode("&", $newParams));
  }
}
$queryString_getDisplay = sprintf("&totalRows_getDisplay=%d%s", $totalRows_getDisplay, $queryString_getDisplay);

$var1_getDisplay2 = "-1";
if (isset($_GET['archive'])) {
  $var1_getDisplay2 = $_GET['archive'];
  $query_getDisplay = sprintf("SELECT news.title, news.blog_entry, DATE_FORMAT(news.updated, '%%M %%e, %%Y') AS formatted FROM news WHERE DATE_FORMAT(news.updated, '%%Y-%%m') = %s ORDER BY news.updated DESC", GetSQLValueString($var1_getDisplay2, "text"));
} elseif (isset($_GET['post_id'])) {
  $var2_getDisplay3 = $_GET['post_id'];
  $query_getDisplay = sprintf("SELECT news.title, news.blog_entry, DATE_FORMAT(news.updated, '%%M %%e, %%Y') AS formatted FROM news WHERE news.post_id = %s", GetSQLValueString($var2_getDisplay3, "int"));
} else {
  $query_getDisplay = "SELECT news.title, news.blog_entry, DATE_FORMAT(news.updated, '%M %e, %Y') AS formatted FROM news ORDER BY news.updated DESC LIMIT 2";
}
$getDisplay = mysql_query($query_getDisplay, $blog) or die(mysql_error());
$row_getDisplay = mysql_fetch_assoc($getDisplay);
$totalRows_getDisplay = mysql_num_rows($getDisplay); 
```

这是记录集代码：

```
 <div id="blog_posts_container">
  <h3><?php echo $row_getDisplay['title']; ?></h3>
  <p class="update">Posted on <?php echo $row_getDisplay['formatted']; ?></p>
  <div class="blog_entry" id="blog_posts">
    <p><?php echo nl2br($row_getDisplay['blog_entry']); ?></p>
  </div></div>
  <?php } while ($row_getDisplay = mysql_fetch_assoc($getDisplay)); ?>
  <div id="blog_posts_container">
    <table border="0">
      <tr>
        <td><?php if ($pageNum_getDisplay > 0) { // Show if not first page ?>
            <a href="<?php printf("%s?pageNum_getDisplay=%d%s", $currentPage, 0, $queryString_getDisplay); ?>">First</a>
            <?php } // Show if not first page ?></td>
        <td><?php if ($pageNum_getDisplay > 0) { // Show if not first page ?>
            <a href="<?php printf("%s?pageNum_getDisplay=%d%s", $currentPage, max(0, $pageNum_getDisplay - 1), $queryString_getDisplay); ?>">Previous</a>
            <?php } // Show if not first page ?></td>
        <td><?php if ($pageNum_getDisplay < $totalPages_getDisplay) { // Show if not last page ?>
            <a href="<?php printf("%s?pageNum_getDisplay=%d%s", $currentPage, min($totalPages_getDisplay, $pageNum_getDisplay + 1), $queryString_getDisplay); ?>">Next</a>
            <?php } // Show if not last page ?></td>
        <td><?php if ($pageNum_getDisplay < $totalPages_getDisplay) { // Show if not last page ?>
            <a href="<?php printf("%s?pageNum_getDisplay=%d%s", $currentPage, $totalPages_getDisplay, $queryString_getDisplay); ?>">Last</a>
            <?php } // Show if not last page ?></td>
      </tr>
    </table>
  </div> 
```

它看起来与记录集导航栏工作的旧页面相同，但由于某种原因它现在无法正常工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T04:55:14.273

如果每次单击链接时都获得相同的 2 篇博文，那是因为您没有`M`更改[`LIMIT [M,] N`](http://dev.mysql.com/doc/refman/5.6/en/limit-optimization.html). 尝试将其更改为 -

```
} else {
$query_getDisplay = "SELECT news.title, news.blog_entry, DATE_FORMAT(news.updated, '%M %e, %Y') AS formatted FROM news ORDER BY news.updated DESC LIMIT ".$pageNum_getDisplay.", 2";
} 
```

# node.js - 如何使用 socket.io 存储来自特定用户的套接字资源？

> ID：14048873
> 
> 赞同：4
> 
> 时间：2012-12-27T03:02:12.847
> 
> 标签：node.js, socket.io

我正在设计一个聊天脚本，我使用不同的浏览器在我的机器上进行测试。我正在尝试使用 socket.io 向特定用户发送消息，所以这里是：

```
client:

socket.on('msgFromServer', function (data) {
     message = data['message'],
     from = data['from'],
     to = data['to'];               

    if($('#chatbox.'+from).dialog("isOpen") === true){
        $('#chatbox.'+from+' #messageOutput textarea.readOnly').text(message);      
    }   
    else if(($('#chatbox.'+from).dialog("isOpen") !== true)){
        createChatbox(from,to,message);
    }
});

server:

var users = {};
io.sockets.on('connection', function (socket) {
    if( ( users.hasOwnProperty(req.session.name) === false))
            users[req.session.name] = socket;

    socket.on('msgToServer', function (data) {
         for (var u in users){
              console.log("%s | %s",u,users[u]);
         }      

     });
}); 
```

好了，我来说说服务器相关的代码结构。它负责将用户存储在“连接”事件中。当我重新加载页面时问题开始了：它将浏览器 A 中的用户存储在用户对象中，如果我重新加载并重新连接再次存储它，但是当我询问浏览器 B 中用户对象的内容是什么时......信息已过时并且与我询问broser A中对象的内容时显示的结果不同，即使我正在尝试对nullity进行一些检查以存储vals如果用户为空-> if（（用户.hasOwnProperty(req.session.name) === false))。基本上，我需要的是一种将每个套接字资源存储在**具有**标识符（**req.session.name****) 并让所有浏览器中的所有会话都可以使用这样的容器，因此当服务器从浏览器 A 接收到浏览器 B 的消息时，它可以识别它并向浏览器 B 发出响应。**

 **[我从https://github.com/generalhenry/specificUser/blob/master/app.js](https://github.com/generalhenry/specificUser/blob/master/app.js) 和[http://chrissilich.com/blog/socket-io-0-7-sending-](http://chrissilich.com/blog/socket-io-0-7-sending-messages-to-individual-clients/)了解到我想要什么[给个人客户的消息/](http://chrissilich.com/blog/socket-io-0-7-sending-messages-to-individual-clients/)

如果您仔细查看代码......在 chrissilich.com 中，作者声明我们需要存储“socket.id”（users[incoming.phonenumber] = socket.id），而在 git generalhenry 中我们必须存储 'socket'(users[myName] = socket) 资源。后者是正确的，因为 socket.id 的值在两个浏览器中往往相同...并且该值会自动更改，我不知道为什么存在...我想在节点的早期版本中它那样工作。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-28T11:53:53.473

问题是socket.id标识的是sockets，而不是用户，所以如果一个用户同时打开了几个标签，每个标签都会有不同的socket.id，所以如果你只为一个用户存储一个socket.id，每次你分配它，你覆盖以前的socketid。

所以，除了其他可能的问题，至少你需要这样做，否则它不会起作用。我敢打赌，您所说的所有浏览器的 1 个套接字是您每次都覆盖 id（当我开始使用 Socket.IO 时发生在我身上）

作为一般规则，**请记住您管理 CONNECTIONS 而不是 USERS** ...一个用户可以拥有多个连接！

连接时

```
function onConnection( socket ) {
    var arr = users[incoming.phonenumber] || null;
    if( !arr ) 
        users[incoming.phonenumber] = arr = [];
    if( arr.indexOf( socket.id ) === -1 )
        arr.push( socket.id ); // Assigns socket id to user
} 
```

断开连接时

```
function onDisconnect( socket ) {
    var arr = users[incoming.phonenumber] || null;
    if( !arr ) return; // Should not happen since an user must connect before being disconnected
    var index = arr.indexOf( socket.id );
    if( index !== -1 )
        arr.splice( index, 1 ); // Removes socket id from user
} 
```**

# java - 在未知索引处搜索某些字符之间的子字符串

> ID：14048875
> 
> 赞同：3
> 
> 时间：2012-12-27T03:02:42.917
> 
> 标签：java, android, regex, string, replace

我有一个字符串，例如：

```
<div class="photo-box biz-photo-box pb-60s">
    <a href="/biz/the-kerry-piper-willowbrook">
        <img class="photo-img" alt="" height="60" src="http://s3-media3.ak.yelpcdn.com/bphoto/rCz-uF_qwqyb5Nnq74JeVQ/60s.jpg" width="60">
    </a> 
```

如何检索网址

```
http://s3-media3.ak.yelpcdn.com/bphoto/rCz-uF_qwqyb5Nnq74JeVQ/60s.jpg 
```

从这个字符串？

我考虑过**string.indexOf()**但是 url 之前和之后的字符数可能会有所不同，因此我不知道这个子字符串从哪个索引开始，这可能会很混乱。有什么最好的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T03:21:36.297

使用[Jsoup](http://jsoup.org)从*URL*、*文件*或*字符串*中抓取/解析 HTML，并使用其 jQuery*类*选择器语法。

```
String htmlStr="<div class=\"photo-box biz-photo-box pb-60s\">"
                      + "<a href=\"/biz/the-kerry-piper-willowbrook\">"
                      + "<img class=\"photo-img\" alt=\"\" height=\"60\" src=\"http://s3-media3.ak.yelpcdn.com/bphoto/rCz-uF_qwqyb5Nnq74JeVQ/60s.jpg\" width=\"60\">"
                      + "</a>";

org.jsoup.nodes.Document doc=org.jsoup.Jsoup.parse(htmlStr);
String src=doc.select("img").attr("src");
System.out.println(src); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T03:32:45.900

如果您不想使用 HTML 解析器，您可以构造一个正则表达式并使用[regex 包](http://developer.android.com/reference/java/util/regex/package-summary.html)来匹配您需要的唯一数据。

就像是，

```
Pattern pattern = Pattern.compile("<img.*?src=\"([^\"]+)\"",Pattern.CASE_INSENSITIVE);
Matcher m = pattern.matcher(data);
while(m.find()) {
    srcUrl = m.group(1));
} 
```

# php - PHP date() 不带前导零的小时、分钟和秒

> ID：14048879
> 
> 赞同：6
> 
> 时间：2012-12-27T03:03:39.540
> 
> 标签：php, date, time

> **可能重复：**
> [将秒转换为时：分：秒](https://stackoverflow.com/questions/3172332/convert-seconds-to-hourminutesecond)

我一直在互联网上搜索，以找到一种将秒转换为分钟的好方法：没有前导零的秒。我已经检查了[这个问题](https://stackoverflow.com/questions/4639047/php-date-minutes-without-leading-zeros)，这是我唯一能找到的问题，但是这些答案看起来都不是很好。也许它们是实现这一目标的唯一和最好的方法，但我希望不是。

我已经这样做了，它给了我没有前导零的分钟数，但是我无法获得秒数。我能想到这样做的唯一方法是做几行数学等，但对于像这样简单的事情来说，这似乎是一项非常多的工作......我不知道为什么 PHP 没有无论如何，它都没有内置几分钟和几秒钟......

```
intval(gmdate("i:s", $duration)); 
```

**编辑** 我要做的就是将视频中的秒数转换为 H:M:S 格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:12:38.073

```
implode(
    ':',
    array_map(
        function($i) { return intval($i, 10); },
        explode(':', gmdate('H:i:s', $duration))
    )
) 
```

> 但是如果 hour==0 那么不打印 0: 而只有 m:s

```
preg_replace(
    '~^0:~',
    '', 
    implode(
        ':',
        array_map(
            function($i) { return intval($i, 10); },
            explode(':', gmdate('H:i:s', $duration))
        )
    )
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T03:32:13.967

我只是迭代地写它：

```
function duration_to_timestring($duration)
{
        $s = [];
        if ($duration > 3600) {
                $s[] = floor($duration / 3600);
                $duration %= 3600;
        }
        $s[] = floor($duration / 60);
        $s[] = floor($duration % 60);

        return join(':', $s);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T03:09:01.127

gmdate 将时间戳作为第二个参数。你应该这样做：

```
echo gmdate("H:i:s", mktime(0, 0, 0, 1, 1, 1998) + $duration); 
```

intval 不应该在那里，因为您正在获取一个字符串并将其再次转换为 int 。使用 H:i:s 你有 10:40:05。
但是，如果您的持续时间 > 然后 24 小时，这将不起作用。

# java - 关于JAVA编码识别

> ID：14048887
> 
> 赞同：-1
> 
> 时间：2012-12-27T03:05:13.860
> 
> 标签：java, encoding, utf-8

我有一个像“%E6%B1%82%E5%8A%A9”这样的字符串。

我的问题是我怎么知道它是否由“UTF-8”编码。它也似乎是 GBK（或 GB2312）编码。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-27T03:13:13.697

这不是 UTF-8 编码，它被称为[Percent 或 URL Encoding](http://en.wikipedia.org/wiki/Percent-encoding)。

[您可以使用URLDecoder](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLDecoder.html) API在 Java 中对其进行解码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T03:17:57.697

没有办法以 100% 的准确度检测字节流的编码，但仍有一些库能够做出非常有效的有根据的猜测。其中我会推荐[juniversalchardet](http://code.google.com/p/juniversalchardet/)。

# python - 在没有 yum 的情况下安装 python 开发包

> ID：14048889
> 
> 赞同：0
> 
> 时间：2012-12-27T03:05:43.933
> 
> 标签：python, sybase, virtualenv

我目前正在尝试通过 安装一些模块，我目前已经启动了这些模块，并且`virtualenv`到目前为止工作正常。我现在正在尝试安装[Sybase](http://python-sybase.sourceforge.net/index.html)模块；但是，似乎我需要安装它，因为我得到以下输出：`pip``easy_install``gcc`

```
running build
running build_py
creating build
creating build/lib.linux-x86_64-2.6
copying Sybase.py -> build/lib.linux-x86_64-2.6
running build_ext
building 'sybasect' extension
creating build/temp.linux-x86_64-2.6
gcc ...
unable to execute gcc: No such file or directory

error: command 'gcc' failed with exit status 1

---------------------------------------- 
```

我现在正在尝试安装我认为可以解决我的问题的 python 开发包；但是，我没有从命令行访问网络的权限，也无法使用`yum install`. 有没有办法通过`tar.gz`其他方法安装 python 开发包？还是只是 `gcc`为了`virtualenv`？我的机器也没有本机`gcc`，现阶段我无法获得它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:54:05.477

安装`python-dev`不会解决您的问题，因为您错过了系统上的 GNU C 编译器。安装那个，可能会解决你的问题。`python-dev`是次要的，缺少它会导致不同类型的错误（即在编译过程中缺少标头）。

而且..如果您无法获得本机 gcc，恐怕您此时不走运。

# c# - 使用 C# 运行 Phantomjs 以获取网页快照

> ID：14048895
> 
> 赞同：17
> 
> 时间：2012-12-27T03:07:26.747
> 
> 标签：c#, asp.net, phantomjs

我正在尝试使用 phantomjs 获取我自己网站的快照——基本上，这是为了创建用户提交内容的“预览图像”。

我已经在服务器上安装了 phantomjs，并确认从命令行针对相应页面运行它可以正常工作。但是，当我尝试从网站运行它时，它似乎没有做任何事情。我已经确认代码正在被调用，幻象实际上正在运行（我已经监视了进程，并且在我调用它时可以看到它出现在进程列表中） - 但是，没有生成图像。

我不确定我应该在哪里找出为什么它不会创建图像 - 有什么建议吗？相关代码块如下：

```
string arguments = "/c rasterize.js http://www.mysite.com/viewcontent.aspx?id=123";
string imagefilename = @"C:\inetpub\vhosts\mysite.com\httpdocs\Uploads\img123.png";

Process p = new Process();
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.CreateNoWindow = false;
p.StartInfo.FileName = @"C:\phantomjs.exe";
p.StartInfo.Arguments = arguments + " " + imagefilename;

p.Start();
string output = p.StandardOutput.ReadToEnd();
p.WaitForExit(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-28T08:00:59.797

我检查了 phantomjs 在其过程中抛出的错误。您可以从 Process.StandardError 中读取它们。

```
var startInfo = new ProcessStartInfo();
//some other parameters here
...
startInfo.RedirectStandardError = true;
var p = new Process();
p.StartInfo = startInfo;
p.Start();
p.WaitForExit(timeToExit);
//Read the Error:
string error = p.StandardError.ReadToEnd(); 
```

它会让你知道发生了什么

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-04-05T12:15:25.327

从 C# 代码执行 phantomjs 的最简单方法是使用[NReco.PhantomJS 之](https://www.nuget.org/packages/NReco.PhantomJS/)类的包装器。以下示例说明了如何将其用于 rasterize.js：

```
var phantomJS = new PhantomJS();
phantomJS.Run( "rasterize.js", new[] { "https://www.google.com", outFile} ); 
```

Wrapper API 有 stdout 和 stderr 的事件；它还可以提供来自 C# Stream 的输入并将标准输出结果读入 C# 流。

# c# - asp.net mvc中url中的参数

> ID：14048900
> 
> 赞同：1
> 
> 时间：2012-12-27T03:08:24.800
> 
> 标签：c#, asp.net-mvc, routing

我知道这可以做到，但甚至不知道从谷歌那里找到一个好的教程叫什么。我正在使用 ASP.Net MVC4 并且我有一个名为 ePage 的控制器，现在我可以从这样的 URL 访问我想要的内容

```
 http://www.myUrl.com/ePage/{ACTION}/{PARAMETER as "id"} 
```

如何更改路由以便（如果可能，仅针对此控制器）读取如下

```
 http://www.myUrl.com/ePage/{PARAMETER} 
```

我现在将始终使用“索引”作为操作。

如果有一个简单的答案，那就太棒了，如果不仅仅是指向正确的方向让我阅读和弄清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T03:34:10.270

在您`Global.asax.cs`的`RegisterRoutes`方法下，您可以尝试添加：

```
routes.MapRoute("MyNewRoute", "ePage/{param}", new { 
    controller = "ePage",
    action = "Index",
}); 
```

您的`Index`方法必须有一个名为的参数`param`，以便路由匹配。

# ruby - 使用命令“mongrel_rails start -d”启动ROR项目，但出现一些错误

> ID：14048903
> 
> 赞同：1
> 
> 时间：2012-12-27T03:08:30.960
> 
> 标签：ruby, ruby-on-rails-3, mongrel, mongrel-cluster

我昨天开始学习 Ruby。我使用该命令`mongrel_rails start -d`启动了我的 Ruby on Rails 项目，但它失败了：

```
> F:\PlayRuby\hello>mongrel_rails start -d
C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require':
126: not found path   - C:/Ruby193/lib/ruby/gems/1.9.1/gems/mongrel-1.1.5-x8
6-mingw32/lib/http11.so (LoadError)
        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mongrel-1.1.5-x86-mingw32/lib/mongrel.rb:12:in `<top (required)>'
        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from C:/Ruby193/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
        from C:/Ruby193/lib/ruby/gems/1.9.1/gems/mongrel-1.1.5-x86-mingw32/bin/mongrel_rails:11:in `<top (required)>'
        from C:/Ruby193/bin/mongrel_rails:23:in `load'
        from C:/Ruby193/bin/mongrel_rails:23:in `<main>' 
```

我用谷歌搜索了它，但我没有找到答案。

# javascript - jQuery ul 中的手风琴

> ID：14048904
> 
> 赞同：0
> 
> 时间：2012-12-27T03:08:39.287
> 
> 标签：javascript, jquery

我正在尝试将一个标题和一个内容面板转换为手风琴。

```
<div id="accordion-two">
    <h3>Header</h3>
    <div>Content panel</div>
</div> 
```

这是 jQuery 代码

```
$('#accordion-two').accordion({
    header: 'h3',
    event: 'click',
    animated: 'swing',
    duration: 800, 
    active: false
}); 
```

我的问题是我需要将点击事件应用于标题以打开内容面板并折叠内容面板..

谢谢你..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:16:59.287

设置[可折叠](http://jqueryui.com/accordion/#collapsible)属性非常简单。

```
$('#accordion-two').accordion(
    {
    header: 'h3', 
    event: 'click',  
    animated: 'swing', 
    duration: 800, 
    active: false,  
    collapsible: true 
    }
);​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T03:17:09.800

您需要在代码中引用 jQuery UI：

```
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js" type="text/javascript"></script> 
```

`collapsible`同样如另一个答案中所述，默认情况下应该始终有一个展开的面板，因此如果您只有一个面板，除非您切换选项，否则它不能折叠。`collapsible: true`

# symfony - 使用 CRUD 生成的 Symfony2 表单 - 我可以自动将 Sonata Admin 与现有表单一起使用吗？

> ID：14048905
> 
> 赞同：0
> 
> 时间：2012-12-27T03:08:41.147
> 
> 标签：symfony, crud, symfony-sonata, sonata-admin

我有用 生成的表格`generate:doctrine:crud`，它们工作得很好，但看起来不太好。在寻找不同的东西时，我发现了 Sonata Admin 模块。

它具有不同的功能、按钮和非常漂亮的布局，真的很酷。

我的问题是，我怎样才能将它应用到我现有的表格中？它们可以像`generate:doctrine:crud`那样自动创建吗？

我的理解是我必须重新创建所有表单，手动使用奏鸣曲方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T08:32:09.897

Soanata Admin is backoffice generator. It's useful to fastly create administration pages and as you said, it uses its own system of Form generation.

What you like in Sonata design is the use of [Twitter Bootstrap](http://twitter.github.com/bootstrap/) that is a frontend framework (CSS+JavaScript). You can use it in your own project, without using Sonata.

By overriding native Symfony form rendering with Bootstrap `controls` elements, you will render nice looking forms too !

# android - 使用 IF 条件更改图像视图

> ID：14048907
> 
> 赞同：1
> 
> 时间：2012-12-27T03:08:51.063
> 
> 标签：android, json, string, imageview, android-adapter

这个应用程序将从服务器获取儿子。我要使用的值是`categoryid`. 您在下面的代码中清楚地知道。

我如何使用`categoryid`json 中的它来改变 imageview 的条件？

提示：我的 ImageView 在`ImageAdapter`课堂上

我想使用条件，

```
 if(catetgoryid == 1){
       imageview.setImageResource(R.drawable.image1)
    } elseif (categoryid == 2 {
        imageview.setImageResource(R.drawable.image2)
    } else {
     imageview.setImageResorce(R.drawable.image3)
    } 
```

JSON

```
{
"count": 54,
"data": [
    {
        "userid": "24",
        "cardid": "114",
        "title": "meeting now!",
        "carddate": "2012-12-26",
        "categoryid": "2",
        "cardimage": "http://xxx.xxx/data/card/thum/9589266f7983dbe72ff8481800f51ef9.jpg",
        "public": "1",
        "user": {
            "user_id": "24",
            "firstname": "kong",
            "lastname": "kea",
            "email": "xxx",
            "picture": "http://xxx.xxx/data/profiles/thum/default.png",
            "friend_status": "NOT_FRIEND"
        }
    }
] 
```

}

主要活动。这是获取 json 的 MainActivity`categoryid`

```
@Override
    protected Void doInBackground(String... params) {

        String url = "http://xxx.xxx.xxx/card/all/30/0/?token=57LzEsmBeykLbDCD04wTgK9WWV2XjJY0XBdqVU0HQvjIdu5EtTWOT1IQ1AYNwxt6Q5bG6FG73uvzLQSDGAIezwc8VcopEp0s63uzbdVgLSfts0TLmuVDOgyfn4lX";
        JSONArray data = null;

        try {

            JSONObject jsonObject = new JSONObject(getJSONUrl(url));

            MyArrList = new ArrayList<HashMap<String, Object>>();
            HashMap<String, Object> map;
            data = jsonObject.getJSONArray("data");
            for (int i = 0; i < data.length(); i++) {
                JSONObject c = data.getJSONObject(i);
                map = new HashMap<String, Object>();

                // Thumbnail Get ImageBitmap To Object
                map.put("cardimage", (String) c.getString("cardimage"));
                map.put("ImageThumBitmap",(Bitmap) loadBitmap(c.getString("cardimage")));

                map.put("categoryid",(String)c.getString("categoryid"));  // use it for condition 

                MyArrList.add(map);
            }

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return null;
    } 
```

此处使用条件

```
public class ImageAdapter extends BaseAdapter {
    private Context context;
    private ArrayList<HashMap<String, Object>> MyArr = new ArrayList<HashMap<String, Object>>();

    public ImageAdapter(Context c,ArrayList<HashMap<String, Object>> myArrList) {
        context = c;
        MyArr = myArrList;
    }

    public int getCount() {
        return MyArr.size();
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder viewHolder;
        viewHolder = new ViewHolder();

        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        if (convertView == null) {
            convertView = inflater.inflate(R.layout.grid_item, null);
        }
            viewHolder.categoryCard = (ImageView) convertView.findViewById(R.id.category_card);

            // ====================== use codition here ===============
            viewHolder.categoryCard.setImageResource(R.drawable.card_beauty);  
            viewHolder.imageView = (ImageView) convertView.findViewById(R.id.imageView1);

        try {
            viewHolder.imageView.setImageBitmap((Bitmap) MyArr.get(position).get("ImageThumBitmap"));
        } catch (Exception e) {
            viewHolder.imageView.setImageResource(android.R.drawable.ic_menu_report_image);
        }

        return convertView;

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T03:44:14.583

您将“catetgoryid”设置为字符串，然后进行整数比较。添加整数转换或将 if 更改为字符串比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T03:44:44.460

在你的**getView()**方法中，尝试这样的事情。在下面的方法中，您将图像视图与 categoryid 一起发送： // 使用 Integer.parseInt(categoryId) 将类别 id 从 String 转换为整数；或者您可以在您的 if 条件中与字符串本身进行比较，例如 categoryId.equals("1"); 等等...

```
public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder viewHolder;
        viewHolder = new ViewHolder();
........................
...........................

viewHolder.imageView = (ImageView) convertView.findViewById(R.id.imageView1);
putDefaultImage(categoryid, viewHolder.imageView);
.............................
}

 private void putDefaultImage(int categoryid, ImageView imageview)
    {
         if(catetgoryid == 1){
       imageview.setImageResource(R.drawable.image1)
    } elseif (categoryid == 2) {
        imageview.setImageResource(R.drawable.image2)
    } else {
     imageview.setImageResource(R.drawable.image3)
    } 
```

希望这可以帮助。

# c# - Microsoft.Phone.Maps.Services 可以在 Windows 应用商店应用中使用吗？

> ID：14048908
> 
> 赞同：0
> 
> 时间：2012-12-27T03:08:51.613
> 
> 标签：c#, geolocation, windows-phone-8, windows-store-apps

命名空间可以`Microsoft.Phone.Maps.Services`在 Windows 应用商店应用程序中使用吗？

如果没有，是否有合适的替代方案可用？

我被定向到[这个](http://www.developer.nokia.com/Community/Wiki/What%27s_new_in_Windows_Phone_8#Apps_Tracking_GeoLocation_in_the_background)，它显示了一些代码，这些代码正是非医生为了根据诸如地址之类的搜索词获取地理定位数据而订购的。

然而

该片段中使用的类（在`Maps_GeoCoding`事件和`QueryCompleted`回调中）来自 Microsoft.Phone.Maps.Services 命名空间，我需要这个或类似的代码用于 Windows 商店应用程序应用程序（我知道“Windows 商店应用程序”命名法会导致一些尴尬）。

有人知道一组类似的功能吗？或者，是否有可能，尽管听起来违反直觉，但实际上可以`Microsoft.Phone.Maps.Services`在 Windows 应用商店应用程序中使用命名空间？

## 更新

这就是我所做的（广告 [a,o] 选自 Justin "Teen" Angel 下面的代码，未显示 appId 和 appCode）：

```
private async static Task<string> GetCoordinatesForAddress(string address) // AKA Geocoding (reverse geocoding is getting address for coordinates)
{
    // build URL for Here.net REST service
    string currentgeoLoc = "0.0,0.0";
    string queryString = address; //"Ferry Building, San-Francisco";
    string appID = "<appId>"; // MAKE SURE TO GET YOUR OWN from developers.here.net
    object appCode = "<appCode>"; // MAKE SURE TO GET YOUR OWN from developers.here.net
    var hereNetUrl = string.Format(
        "http://demo.places.nlp.nokia.com/places/v1/discover/search?at={0}&q={1}&app_id={2}&app_code={3}&accept=application/json",
            currentgeoLoc, queryString, appID, appCode);

    // get data from HERE.net REST API
    var httpClient = new HttpClient();
    var hereNetResponse = await httpClient.GetStringAsync(hereNetUrl);

    // deseralize JSON from Here.net 
    using (var tr = new StringReader(hereNetResponse))
    using (var jr = new JsonTextReader(tr))
    {
        var rootObjectResponse = new JsonSerializer().Deserialize<JsonDOTNetHelperClasses.RootObject>(jr);
        var firstplace = rootObjectResponse.results.items.First();
        return string.Format("{0};{1}", firstplace.position[0], firstplace.position[1]);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T05:49:19.307

WP8 Nokia`<Maps />`控件及其相关服务（路由、地理编码等）目前在 Win8 SDK 中不可用。Win8 应用程序应使用必应地图 API。

但是，如果您确实想在 Win8 应用程序中使用诺基亚地图功能，那绝对是可能的。[Here.net](http://developers.nokia.com)（诺基亚的位置门户）公开了公开记录的 Web API。您可以使用[“核心计划”](http://developer.here.net/plans)，该计划每天允许来自 here.net REST API 的最多 2,500 个免费查询。这些 REST API 包括地理编码、反向地理编码、行人路线、驾驶路线等。

[您可以在@http: //developer.here.net/javascript_api_explorer](http://developer.here.net/javascript_api_explorer)看到这些 REST API 的示例（单击右上角的“REST API Explorer”，因为此视图默认为 javascript API 浏览器）。地理编码 API 将在“地点”下提供。

例如，以下是在 Win8 上使用 REST API复制[WP8 Maps GeoCoding 示例的方法：](http://www.developer.nokia.com/Community/Wiki/What%27s_new_in_Windows_Phone_8#Maps)

```
private async void GeocodingWin8Query()
{
    // build URL for Here.net REST service
    string currentgeoLoc = "0.0,0.0";
    string queryString = "Ferry Building, San-Francisco";
    string appID = "<appId>"; // MAKE SURE TO GET YOUR OWN from developers.here.net
    object appCode = "<appCode>"; // MAKE SURE TO GET YOUR OWN from developers.here.net
    var hereNetUrl = string.Format(
        "http://demo.places.nlp.nokia.com/places/v1/discover/search?at={0}&q={1}&app_id={2}&app_code={3}&accept=application/json",
            currentgeoLoc, queryString, appID, appCode);

    // get data from HERE.net REST API
    var httpClient = new HttpClient();
    var hereNetResponse = await httpClient.GetStringAsync(hereNetUrl);

    // deseralize JSON from Here.net 
    using (var tr = new StringReader(hereNetResponse))
    using (var jr = new JsonTextReader(tr))
    {
        var rootObjectResponse = new JsonSerializer().Deserialize<RootObject>(jr);

        // print the details of the first geocoding result 
        var firstplace = rootObjectResponse.results.items.First();
        await new MessageDialog("Name: " + firstplace.title + Environment.NewLine +
                          "Geolocation: " + firstplace.position[0] + ", " + firstplace.position[1] + Environment.NewLine +
                          "Address: " + HtmlUtilities.ConvertToText(firstplace.vicinity) + Environment.NewLine +
                          "Type: " + firstplace.type + Environment.NewLine,
                          "Win8 Nokia Maps Geocoding").ShowAsync();
    }
} 
```

当我们运行这个代码片段时，我们可以看到 Win8 可以访问与 WP8 相同的地理编码数据：

![来自 REST API 的 Win8 GeoCoding 数据](../Images/ae0a598b0a92a435d39dbcc47a9d874f.png)

这个 API 还可以做更多的事情，比如反向地理编码、路由等。正如我提到的，您可以在[Here.net REST API](http://developer.here.net/javascript_api_explorer)上探索这些功能（单击右上角的“REST API 资源管理器”）。另外，登录后不要忘记注册一个 AppID 和 AppCode。

为了使上面的代码正常工作，我使用了 JSON.Net。您需要[从 NuGet 安装 JSON.net 并从 json2csharp](http://nuget.org/packages/newtonsoft.json)[复制](http://json2csharp.com/#)一些强类型生成的类。以下是安装 JSON.net 的方法：

![NuGet 安装 Json.net](../Images/1239a20516c33f941c64656b04a90d76.png)

以下是生成的 C# JSON.net 类：

```
public class Category
{
    public string id { get; set; }
    public string title { get; set; }
    public string href { get; set; }
    public string type { get; set; }
}

public class Item
{
    public List<double> position { get; set; }
    public int distance { get; set; }
    public string title { get; set; }
    public Category category { get; set; }
    public string icon { get; set; }
    public string vicinity { get; set; }
    public List<object> having { get; set; }
    public string type { get; set; }
    public string href { get; set; }
    public string id { get; set; }
    public double? averageRating { get; set; }
}

public class Results
{
    public List<Item> items { get; set; }
}

public class Location
{
    public List<double> position { get; set; }
}

public class Context
{
    public Location location { get; set; }
    public string type { get; set; }
}

public class Search
{
    public Context context { get; set; }
}

public class RootObject
{
    public Results results { get; set; }
    public Search search { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T03:13:34.803

虽然有可能，但我认为它不可靠。

当内置 Maps SDK（在 Bing Maps 上运行）时，为什么要这样做

[这是](http://www.codeproject.com/Articles/408457/Using-Bing-Maps-For-Windows-8-Metro-Apps-Csharp-Ja)一个我认为你应该看的教程

# c++ - 即使在构建之后仍然出现“找不到二进制文件”错误（Eclipse OSX Mtn. Lion）

> ID：14048910
> 
> 赞同：1
> 
> 时间：2012-12-27T03:09:00.413
> 
> 标签：c++, c, eclipse, macos, osx-mountain-lion

我最近在我的 Mac 上安装了 Eclipse for C/C++。无论我是在编译 C 还是 C++，我仍然每次都能得到：`Binary Not Found`即使在我构建没有错误之后也是如此。我用命令行工具安装了 Xcode，GCC 和 G++ 在 mac 终端上工作得很好。至少据我所知，在 Eclipse 中编译很好，但运行它不起作用。然而，eclipse 在我项目的 Debug 文件夹下创建的可执行文件也运行良好。这是 Eclipse 在构建时放在控制台中的内容

`make all Building file: ../test1.c Invoking: Cross GCC Compiler gcc -O0 -g3 -Wall -c -fmessage-length=0 -MMD -MP -MF"test1.d" -MT"test1.d" -o "test1.o" "../test1.c" 完成构建：../test1.c

构建目标：test1 调用：Cross GCC Linker gcc -o "test1" ./test1.o
完成构建目标：test1`

我将我的工件设置为可执行文件，并尝试了我能想到的一切。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-09T15:57:11.443

Preferences > c/c++ > new c/c++ project wizard 点击 Cross GCC 或 MacOSX GCC 然后点击 make toolchain(s) Preferred

# android - AutoCompleteTextView 在不同版本的android中表现不同

> ID：14048913
> 
> 赞同：2
> 
> 时间：2012-12-27T03:10:16.990
> 
> 标签：android, android-imageview, textview, autocompletetextview

我不清楚这是否是不同版本的 Android 或不同屏幕尺寸的问题，但我得到了一些不可预测的行为。

我正在测试正在打开的`MultiAutoCompleteTextView`a下拉列表的 UI，并且正在测试正在打开的a 。`Nexus S``Android v4.1.2``Nexus 4``Android v4.2.1`

当我开始在其中输入文本时，`MultiAutoCompleteTextView`它会返回一些结果。我创建了一个自定义视图，其中`ImageView`包含`TextView`. 当 a 行首次显示时，`ImageView`将具有一定的高度和宽度（左图）。

![](../Images/47394cd0abfc717240de6e5e7addf74b.png) ![](../Images/68de105a535f335af6049eae425ef2c4.png)

但是，一旦您滚动浏览结果列表并返回到原来的第一行，就会发生两件事。要么`ImageView`保持相同的尺寸，要么尺寸`ImageView`将改变（右图）。

这种特定行为以及提供的屏幕截图`Nexus 4`是`Nexus S`.

我正在加载`Bitmaps`，`ImageViews`就像在开发人员培训[Loading Large Bitmaps Efficiently](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)中所做的一样。

这是联系人行的布局资源：

**contact_entry2.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/contactPic"
        android:layout_width="wrap_content"
        vandroid:layout_height="fill_parent"
        android:contentDescription="@string/contact_pic_desc"
        android:focusable="false"
        android:focusableInTouchMode="false"
        android:src="@drawable/ic_contact_picture" />

    <CheckedTextView
        android:id="@+id/contactInfo"
        style="@style/CheckedTextViewStyle" >
    </CheckedTextView>

</LinearLayout> 
```

**样式.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:android="http://schemas.android.com/apk/res/android">

    <style name="CheckedTextViewStyle">
        <item name="android:layout_width">fill_parent</item>
        <item name="android:layout_height">match_parent</item>
        <item name="android:textColor">@color/black</item>
        <item name="android:background">@color/white</item>
        <item name="android:gravity">center_vertical</item>
        <item name="android:paddingLeft">10dp</item>
    </style>

</resources> 
```

RecipientsCursorAdapter 是`SimpleCursorAdapter`（BaseContactsAdapter extends `SimpleCursorAdapter`）的孙类：

**RecipientsCursorAdapter**

```
package com.sendit.adapters;

import android.app.Activity;
import android.content.Context;
import android.database.Cursor;
import android.provider.ContactsContract;
import android.view.View;
import android.view.ViewGroup;
import android.widget.CheckedTextView;
import android.widget.ImageView;

import com.sendit.Contact;
import com.sendit.R;
import com.sendit.util.ContactsUtils;
import com.sendit.util.ImageFetcher;

public class RecipientsCursorAdapter extends BaseContactsAdapter {

    private final String DEBUG_TAG = getClass().getSimpleName().toString();
    private Cursor mCursor;
    private ImageFetcher mImageFetcher;

    public RecipientsCursorAdapter(Context context, int layout, Cursor c,
        String[] from, int[] to, Activity a, int flags, ImageFetcher imageFetcher) {
            super(context, layout, c, from, to, a, flags);
            mImageFetcher = imageFetcher;
    }

    public View getView(final int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.contact_entry2, null);
            // Creates a ViewHolder and store references to the children views
            // we want to bind data to.
            holder = new ViewHolder();
            holder.contactInfo = (CheckedTextView) convertView
                .findViewById(R.id.contactInfo);
            holder.contactPic = (ImageView) convertView
                .findViewById(R.id.contactPic);

            convertView.setTag(holder);

        } else {
            // Get the ViewHolder back to get fast access to the TextView
            // and the ImageView.
            holder = (ViewHolder) convertView.getTag();
        }

        holder.position = position;

        mCursor = getCursor();

        mCursor.moveToPosition(position);

        int contactId = mCursor.getInt(mCursor
            .getColumnIndex(ContactsContract.Contacts._ID));

        if (mContactCache.get(contactId) == null) {
            String name = mCursor.getString(mCursor.getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
            String number = ContactsUtils.getPhoneNumber(mContext, contactId);
            mContactCache.put(contactId, new Contact(name, number));
        }

        Contact c = mContactCache.get(contactId);

        CharSequence contactInfo = getContactInfoSpan(c.getName(), c.getPhoneNumber());

        holder.contactInfo.setText(contactInfo);

        mImageFetcher.loadImage(contactId, holder.contactPic);

        return convertView;
    }

} 
```

至于要研究什么，谁能指出我正确的方向？这是屏幕分辨率问题，还是最新版本的 Android 处理这种情况的方式与以前的版本不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T10:12:25.890

我会大胆猜测这与视图回收有关....当您从列表中向下然后备份时，您的原始图像显示在一个回收视图中，该视图的宽度/高度在初始加载时设置不同大小的图像。

如果是这样，则可能是Android版本中的错误。无论哪种方式，您都必须处理它。

也许当您回收视图时，您应该再次明确设置/重置图像视图大小，或者基于重新加载到其中的图像，或者如果您希望它们都具有相同的高度，则高度具有常数。

您可能还想使用一些 ImageView 参数，例如 adjustViewBounds 或 Fit/Scale 设置。

最近，我在 Android 4.0.6 和 4.1.2 （内存中的数字......）之间遇到了一些完全不同的行为（是 EditTextView），而且这种废话似乎正在发生......甚至在最近和非常接近的版本之间安卓:-(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T09:05:26.147

感谢@Andrew 的建议。这是我解决图像大小调整问题的方法。我在实例化引用时调用了`ImageView` `setScaleType()`and方法。`setLayoutParams()``ViewHolder`

```
public class RecipientsCursorAdapter extends BaseContactsAdapter {

    private final String DEBUG_TAG = getClass().getSimpleName().toString();
    private Cursor mCursor;
    private ImageFetcher mImageFetcher;
    private final Drawable mDefaultContactPic;
    private LinearLayout.LayoutParams mImageViewLayoutParams;

    public RecipientsCursorAdapter(Context context, int layout, Cursor c,
        String[] from, int[] to, Activity a, int flags, ImageFetcher imageFetcher) {

        super(context, layout, c, from, to, a, flags);
        mImageFetcher = imageFetcher;
        mDefaultContactPic = context.getResources().getDrawable(R.drawable.ic_contact_picture);
        mImageViewLayoutParams = new LinearLayout.LayoutParams(mDefaultContactPic.getIntrinsicWidth(), mDefaultContactPic.getIntrinsicHeight());
    }

    public View getView(final int position, View convertView, ViewGroup parent) {
        ViewHolder holder;
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.contact_entry2, null);
            // Creates a ViewHolder and store references to the children views
            // we want to bind data to.
            holder = new ViewHolder();
            holder.contactInfo = (CheckedTextView) convertView.findViewById(R.id.contactInfo);
            holder.contactPic = (ImageView) convertView.findViewById(R.id.contactPic);

            holder.contactPic.setScaleType(ImageView.ScaleType.CENTER_CROP);
            holder.contactPic.setLayoutParams(mImageViewLayoutParams);

            convertView.setTag(holder);

        } else {
            // Get the ViewHolder back to get fast access to the TextView
            // and the ImageView.
            holder = (ViewHolder) convertView.getTag();
        }

        holder.position = position;

        mCursor = getCursor();

        mCursor.moveToPosition(position);

        int contactId = mCursor.getInt(mCursor.getColumnIndex(ContactsContract.Contacts._ID));

        /*...*/

        mImageFetcher.loadImage(contactId, holder.contactPic);

        return convertView;
    }

} 
```

# android - 如何找到回答我意图的内容提供者的类名？

> ID：14048914
> 
> 赞同：1
> 
> 时间：2012-12-27T03:10:26.713
> 
> 标签：android, android-intent

我发送了隐式意图（使用 startActivityForResult），我收到了答案（使用 onActivityResult），在这个答案中，我收到了内容提供商发送给我的数据的 uri - 但我很感兴趣是谁回答了我并向我发送了这些数据。我可以以某种方式以编程方式找到回答我隐含意图的内容提供者的类名吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T04:45:29.797

我不确定从隐式意图中获取提供者的方法，但您始终可以使用[resolveActivity](http://developer.android.com/reference/android/content/Intent.html#resolveActivity%28android.content.pm.PackageManager%29)自己解决意图。它是在幕后用来解决隐含意图的东西。要获得意图解析的类，您可以执行类似的操作

```
 ComponentName cName = intent.resolveActivity(getPackageManager());
   Log.d("resolve","class = " + cName.getClassName()); 
```

理论上，如果你再做一个`startActivity...(intent)`相同的组件应该被选中。如果你想确定，你可以随时更新你的意图

```
 intent.setComponent(cName); 
```

本质上，这是将隐式意图解析为显式意图，以便在启动意图之前知道要发送到哪个组件。

# locking - MySQL InnoDB 锁定

> ID：14048917
> 
> 赞同：1
> 
> 时间：2012-12-27T03:10:36.730
> 
> 标签：locking, innodb, myisam

我有 2 个连接。第一个连接进行查询：

```
UPDATE table1 SET column1 = 5; 
```

第二种连接：

```
SELECT t1.column1, t2.column2
FROM table2 t2
JOIN table1 t1 
     ON t1.column1 = t2.column1 
```

表 1 - InnoDB，表 2 - MyISAM

MySQL 服务器在获得第一个查询后立即获得第二个查询。第二个连接中的查询会等到更新完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T14:05:47.117

假设隔离级别不是`SERIALIZABLE`（默认为`REPEATABLE READ`），第二个查询不会等待第一个，而是从回滚日志中读取数据。

您可以通过启动事务、执行更新然后在一个线程中休眠几秒钟并在第一个线程在另一个线程中休眠时执行第二个查询来验证这一点

# c++ - 旋转控制不起作用

> ID：14048918
> 
> 赞同：1
> 
> 时间：2012-12-27T03:10:38.050
> 
> 标签：c++, mfc

我在 MFC、C++ 中使用自旋控制来更改数字的值。

这是我的代码：

```
void CHello_worldDlg::OnDeltaposSpin1(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMUPDOWN pNMUpDown = reinterpret_cast<LPNMUPDOWN>(pNMHDR);
    // TODO: Add your control notification handler code here
    m_fSpinIncrement = m_fScalingFactor;
    if(pNMUpDown->iDelta == -1) // Increment the value
    {
    IncrementData(m_fSpinIncrement);
    }
    else // Decrement the value
    {
    DecrementData(m_fSpinIncrement);
    }
    SetDlgItemText(IDC_TEXT3, IDC_SPIN1);
    *pResult = 0;
} 
```

里面有没有错误？并且数字变化将在另一个静态文本框中~

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T08:11:17.660

你做的工作太多了。[通过简单地设置旋转控件](http://msdn.microsoft.com/en-us/library/bd91377e%28v=VS.80%29.aspx)的适当属性，您尝试做的所有事情都可以做得更好：

1.  [`Auto Buddy`](http://msdn.microsoft.com/en-us/library/aa276380%28v=vs.60%29.aspx)将旋转控件连接到它前面的编辑​​框。
2.  `Set Buddy Integer`使编辑框自动处理整数。
3.  `Alignment`设置为“右”将使旋转控件整齐地停靠在编辑框上。

`SetRange()`您需要的唯一代码是在 OnInitDialog中调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T05:21:02.103

Did you call the `SpinButtonCtrl::SetRange()` method in any part of your code? From your code, I don't think it is getting the range you want.

# c++ - 为什么“可变”是 lambda 函数属性，而不是捕获类型？

> ID：14048919
> 
> 赞同：41
> 
> 时间：2012-12-27T03:10:54.527
> 
> 标签：c++, c++11

为什么c++11要求我们写：

```
[a,b]() mutable { a=7; } // b is needlessly mutable, potential source of bugs 
```

代替：

```
[mutable a,b]() { a=7; } // no problems here 
```

这是一个疏忽，被认为不够重要，还是有特定的技术原因？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-27T04:23:55.213

在[n2651](http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2651.pdf)中提到了您的建议：

> 可以扩展 lambda 表达式的语法以允许声明闭包成员是否应声明为可变的。
> 
> **这种方法可能会让程序员感到困惑，因为可变性不是闭包对象的属性，而是存储在闭包中的变量。**

我不知道这是否是唯一的原因，但似乎确实考虑过。然而，在[Herb Sutter 的提议](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3424.pdf)中，他建议去掉`mutable`而不是隐式地制作捕获副本`const`，因此我们可能会再次看到变化。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-27T03:36:10.917

可能是某种疏忽（与不能使用右值引用相同的方式）和 lambda 在概念上实现方式的产物。

```
int   a;
int*  b;
float c;

auto lambda1 = [&a, b, c](int d) mutable -> void {};

class lambda1 {
public:
    void operator()(int d) {}
private:
    int&  a_;
    int*  b_;
    float c_;
};

auto lambda2 = [&a, b, c](int d) -> void {};

class lambda2 {
public:
    void operator()(int d) const {}
private:
    int&  a_;
    int*  b_;
    float c_;
}; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-27T03:38:25.723

该`mutable`关键字适用于由 lambda 表达式生成的对象，而不适用于单独捕获的项目，以便编译器可以使用标准第 5.1.2 节第 5 段中描述`const`的方法上的修饰符来实现它。`operator()`

> 当且仅当 lambda 表达式的 parameter-declaration-clause 后面没有 mutable 时，此函数调用运算符才被声明为 const (9.3.1)。

在您的示例中，由 lambda 表达式生成的类可能如下所示：

```
class lambda
{
  int a, b;

public:

  lambda( int a, int b ) : a( a ), b( b ) {}

  void operator()() // non-const due to mutable keyword
  {
    a = 7;
  }
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T06:42:31.090

`mutable`关键字不像`mutable`通常使用的关键字那样使用：它在这种情况下是相反的，`const`适用于函数调用运算符的常量性隐式函数对象。但是，默认情况下隐式函数对象的函数调用运算符是有意的，`const`而通常成员函数是非`const`（“可变”）但默认的。lambda 函数的引入早于上下文关键字 ( `override`and `final`) 的使用，并且`mutable`关键字似乎是比`not const`.

# php - php 在提交按钮被点击之前执行

> ID：14048921
> 
> 赞同：-1
> 
> 时间：2012-12-27T03:11:56.193
> 
> 标签：php, mysql, syntax-error

我正在尝试像我的任何其他页面一样通过 PDO 连接到我的数据库，所以我只是从我的其他页面复制并粘贴了相同的代码，没有任何改变（相同的数据库和用户等），现在我收到了这个错误：

> [Wed Dec 26 22:51:49 2012] [error] [client 127.0.0.1] PHP Notice: Undefined index: anum in /var/www/signinpage.php on line 69 [Wed Dec
> 
> 26 22:51:49 2012] [error] [client 127.0.0.1] PHP Notice: Undefined index: first in /var/www/signinpage.php on line 70 [Wed Dec 26
> 
> 2012 年 22:51:49] [错误] [客户端 127.0.0.1] PHP 通知：未定义索引：最后在 /var/www/signinpage.php 第 71 行 [2012 年 12 月 26 日星期三 22:51:49]
> 
> [错误] [客户端 127.0.0.1] PHP 通知：未定义索引：为什么在第 72 行的 /var/www/signinpage.php [2012 年 12 月 26 日星期三 22:51:49] [错误]
> 
> [client 127.0.0.1] PHP 注意：未定义索引：第 73 行 /var/www/signinpage.php 中的注释 [2012 年 12 月 26 日星期三 22:51:49] [错误]
> 
> [客户端 127.0.0.1] SQLSTATE [23000]：违反完整性约束：1048 列 'anum' 不能为空

我认为脚本是在提交按钮之前开始的，我不希望发生这种情况，因为脚本是插入和表单验证脚本。

这些是连接线（导致错误的地方）

```
$host="localhost"; // Host name
$username="root"; // Mysql username
$password="testdbpass"; // Mysql password
$db_name="test"; // Database name

// Connect to server via PHP Data Object
$dbh = new PDO("mysql:host=localhost;dbname=test;", $username, $password);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

这是完整的代码：

```
<?php 
//Starting session
session_start();

$host="localhost"; // Host name
$username="root"; // Mysql username
$password="testdbpass"; // Mysql password
$db_name="test"; // Database name

// Connect to server via PHP Data Object
$dbh = new PDO("mysql:host=localhost;dbname=test;", $username, $password);
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

// Validation starts here  

    if(empty($_POST) === false) {
    $errors = array();
        $anum       =   $_POST['anum'];
        $first      =   $_POST['first'];
        $last       =   $_POST['last'];
        $why        =   $_POST['why'];
        $comments   =   $_POST['comments'];

    if (empty($anum) === true || empty($first) === true || empty($last) === true){  
        $errors[] = 'Form is incomplete please revise it!';
} 
    else {

    if(ctype_alnum($anum) === false) {
        $errors[] = 'A number can only consist of alphanumeric characters!';
}
    if(strlen($anum) > 9) {
        $errors[] = 'A number is incorrect!';
}
    if(strlen($anum) < 9) {
        $errors[] = 'A number is incorrect!';
}
    if(ctype_alpha($first) === false) {
        $errors[] = 'First mame must only contain alphabetical characters!';
}
    if(ctype_alpha($last) === false) {
        $errors[] = 'Last name must only contain alphabetical characters!';
}
    if(empty($why)) {
        $errors[] = 'Please make sure to select the proper reasoning for your vistit today!';
} 
    elseif ($why ==='Other' && empty($comments)) {
        $errors[] = 'Please explain the nature of your visit in the comments box!';
}
    if (strlen($comments) < 15) {
        $errors[] = 'Your explaination is short, please revise!';
}
    if(strlen($comments) > 45) {
        $errors[] = 'Your explaintion is to long, please revise!';
}
}
    if (empty($errors) === true) {
        header('location: signedin.php');
            exit(); 
}
} // Validations ends here

// We start our insert statement here!

try {
        $query = $dbh->prepare("INSERT INTO `students` (anum, first, last, why, comments) 
                               VALUES (:anum, :first, :last, :why, :comments)");

        $query->execute(
                        array(
                                'anum'  => $_POST['anum'],
                                'first'     => $_POST['first'],
                                'last'      => $_POST['last'],
                                'why'       => $_POST['why'],
                                'comments'  => $_POST['comments']
                                )); 
    }
            catch (PDOException $e) 
    {
            error_log($e->getMessage());
            die($e->getMessage());
    }
$dbh = null;

?>
<html> 
<body>
<title>Student Signin Form</title>
<table width="300" align="center" cellpadding="0"
cellspacing="1" bgcolor="#CCCCCC">
<tr>
<?php 
    if(empty($errors) === false) {
        echo '<h3>';
        foreach ($errors as $error) {
            echo '<center><li>' , $error, '</li></center>';
        }

        echo '<h3>';
}
?>
<form action="" method="post">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr> 

<tr colspan="3"><center></center><strong>Student Signin Form</strong></tr>
    <p>Student ID Number: <input type="text" name="anum" <?php if (isset($_POST['anum']) === true) {echo 'value="' ,$_POST['anum'], '"';} ?> />
    <p>First Name: <input type="text" name="first" <?php if (isset($_POST['first']) === true) {echo 'value="' ,$_POST['first'], '"';} ?> />
    <p>Last Name: <input type="text" name="last" <?php if (isset($_POST['last']) === true) {echo 'value="' ,$_POST['last'], '"';} ?> />
    <p>How may we help you? <select name="why" />
                <option value=""></option> 
                <option value="Appeal">Appeal</option>
                <option value="Other">Other: Please specify the nature of your visit bellow</option>
                </select>
</tr>

<br>

<P>If other please describe the issue you are having.</P>
<textarea rows="10" cols="50" name="comments" <?php if (isset($_POST['comments']) === true) {echo 'value="' ,$_POST['comments'], '"';} ?>></textarea>

<input type="submit" name="submit" value="Send"/>

</form>

</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T04:20:48.333

扩展您的

```
if(empty($_POST) === false) { 
```

阻塞到数据库操作结束。`}`把它放在行后关闭`$dbh = null;`。

# android - fwidth() tegra 3 glsl

> ID：14048927
> 
> 赞同：2
> 
> 时间：2012-12-27T03:12:41.933
> 
> 标签：android, opengl-es-2.0, glsl, tegra

![在此处输入图像描述](../Images/ef1f8b678f6c8b3f18aac53b05bf67a1.png)

这是该程序在 Tegra 3 设备上渲染几个四边形的结果：

```
#extension GL_OES_standard_derivatives : enable
precision mediump float;

uniform sampler2D sampler2d;                                                                            
varying vec2 textureCoord;          

void main() 
{                                                                                           

    vec4 texColor = texture2D(sampler2d,textureCoord);
    gl_FragColor = vec4(fwidth(texColor.a),0.0,0.0,1.0);
} 
```

我使用的纹理是一个空的、透明的 png，但无论我在这个纹理中放什么，这些线框总是可见的。

Mali-400 设备上的相同代码可以正常工作。谁能告诉我 Tegra fwidth 实现是否正确或我的代码有问题？上面的代码只是一个例子，只显示了着色器的错误部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-08T11:29:24.560

我遇到了一个非常相似的问题，仅在 Tegra 3 设备上应用抗锯齿后，我们的字体上会出现三角形线框伪影。我将问题缩小到 fwidth() 函数返回的结果。不幸的是，我找不到问题的根源（我希望这与三角形边缘处的导数不正确有关？）。

但是，我确实找到了解决方法。我使用颜色更改来确定当 fwidth 返回的宽度大于 0.2 时出现伪影。然后我忽略了大于 0.2 的值，并用更合理的硬编码 fwidth 值替换它们——你可能需要做一些摆弄才能找到适合你用例的值，对我来说 0.025 就足够了。

为了避免在我的着色器代码中出现分支，我在需要时使用了 mix 和 step 的组合来替换 fwidth 值：

```
mediump float dist = texture2D(Texture, TexCoordOut).a;
mediump float width = fwidth(dist);
width = mix(width, 0.025, step(0.2, width)); // if (width > 0.2) width = 0.025 
```

虽然远非理想，但在应用平滑步长抗锯齿时使用此宽度而不是原始 fwidth 允许我显示我的文本而没有伪影。

# c# - 如何在主窗口中显示不同的窗口？

> ID：14048928
> 
> 赞同：0
> 
> 时间：2012-12-27T03:12:55.220
> 
> 标签：c#, wpf, wpf-controls

*   在我的 c# Wpf 独立应用程序中，我创建了主窗口并在我的项目中添加了另外 5 个窗口
*   我在主窗口中按这 5 个窗口中每个窗口的名称放置了一个按钮。
*   我的问题是：当我按下主窗口中的任何按钮时..如何在主窗口的（Windows 区域）中显示其相关窗口？例如，如果我按下历史按钮..如何在主窗口的那个（Windows 区域）中显示历史窗口？
*   注意：我不想在我的应用程序中使用带有导航控件的页面或导航窗口。

![在此处输入图像描述](../Images/5a7c73ea426749eeb7b891acb50873e3.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T03:26:23.217

当您单击按钮时，只需使用 UserControl 并将它们添加到您的容器控件中。

这是一个简单的例子：

**主窗口.xaml**

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">
    <Grid>
        <Button Content="History" Height="53" HorizontalAlignment="Left" Margin="12,12,0,0" Name="button1" VerticalAlignment="Top" Width="75" Click="button1_Click" />
        <Button Content="Precaution" Height="53" HorizontalAlignment="Left" Margin="109,12,0,0" Name="button2" VerticalAlignment="Top" Width="75" Click="button2_Click" />
        <Button Content="Uses" Height="53" HorizontalAlignment="Left" Margin="208,12,0,0" Name="button3" VerticalAlignment="Top" Width="75" Click="button3_Click" />
        <Button Content="Side Effects" Height="53" HorizontalAlignment="Left" Margin="314,12,0,0" Name="button4" VerticalAlignment="Top" Width="75" Click="button4_Click" />
        <Button Content="New Item" Height="53" HorizontalAlignment="Left" Margin="405,12,0,0" Name="button5" VerticalAlignment="Top" Width="75" Click="button5_Click" />
        <Viewbox Height="209" HorizontalAlignment="Left" Margin="12,90,0,0" Name="Container" VerticalAlignment="Top" Width="479" />
    </Grid>
</Window> 
```

**主窗口.xaml.cs**

```
public partial class MainWindow : Window
{
    History use1 = new History();
    Precaution use2 = new Precaution();
    Uses use3 = new Uses();
    SideEffect use4 = new SideEffect();
    NewItem use5 = new NewItem();

    public MainWindow()
    {
        InitializeComponent();
    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {
        Container.Child = use1;
    }

    private void button2_Click(object sender, RoutedEventArgs e)
    {
        Container.Child = use2;
    }

    private void button3_Click(object sender, RoutedEventArgs e)
    {
        Container.Child = use3;
    }

    private void button4_Click(object sender, RoutedEventArgs e)
    {
        Container.Child = use4;
    }

    private void button5_Click(object sender, RoutedEventArgs e)
    {
        Container.Child = use5;
    }
} 
```

**虚拟用户控件**

```
<UserControl x:Class="WpfApplication1.History"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="209" d:DesignWidth="479" Background="AliceBlue">
    <Grid Width="479" Height="209">

    </Grid>
</UserControl>

<UserControl x:Class="WpfApplication1.Precaution"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="209" d:DesignWidth="479" Background="LightCoral" >
    <Grid Width="479" Height="209">

    </Grid>
</UserControl>

<UserControl x:Class="WpfApplication1.Uses"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="209" d:DesignWidth="479" Background="LightGreen" >
    <Grid Width="479" Height="209">

    </Grid>
</UserControl>

<UserControl x:Class="WpfApplication1.SideEffect"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="209" d:DesignWidth="479" Background="PapayaWhip" >
    <Grid Height="209" Width="479">

    </Grid>
</UserControl>

<UserControl x:Class="WpfApplication1.NewItem"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d" 
         d:DesignHeight="209" d:DesignWidth="479" Background="LightGoldenrodYellow">
    <Grid Height="209" Width="479">

    </Grid>
</UserControl> 
```

# spring - Spring MVC:noHandlerFound

> ID：14048929
> 
> 赞同：1
> 
> 时间：2012-12-27T03:13:05.630
> 
> 标签：spring, spring-mvc

我正在用 Mybatis+Spring 3+Tomcat+Eclipse Indigo 做示例 Spring mvc 我遇到了这个问题 怎么了？任何关于成功运行这个项目的建议。以前的问题很清楚并运行此错误消息

```
 org.springframework.web.servlet.DispatcherServlet noHandlerFound
WARNING: No mapping found for HTTP request with URI [/SpringMVC/] in DispatcherServlet with name 'spring' 
```

我的 web.xml 在这里

```
 <servlet>
    <servlet-name>spring</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>
                    /WEB-INF/servlet.xml
                    /WEB-INF/app.xml
            </param-value>
    </init-param>
  </servlet>

  <servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>
  </servlet-mapping>
</web-app> 
```

我的 servlet.xml 是

```
 <context:annotation-config />
    <context:component-scan base-package="logen.board.controller" />    

   <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
        <property name="prefix" value="/jsp/" />
        <property name="suffix" value=".jsp" />
   </bean> 
```

app.xml 在这里

```
<bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
      <property name="dataSource" ref="dataSource" />
      <property name="mapperLocations" value="classpath:logen/board/dao/BoardDao.xml" />
</bean>

<bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate">
    <constructor-arg index="0" ref="sqlSessionFactory" />
</bean> 

<bean id="BoardDao" class="logen.board.entity.BoardEntity"></bean> 
```

和我的控制器

```
@Controller
public class Boardcontroller {
    @Autowired
    private SqlSession sql;
    @Autowired
    private BoardEntity bn;
    @RequestMapping("/list.do")
    private ModelAndView list(){
        BoardDao dao = sql.getMapper(BoardDao.class);
        ModelAndView mv = new ModelAndView();
        mv.setViewName("jsp/index");
        mv.addObject("list", dao.getList());
        return mv;
    }
} 
```

# ruby-on-rails - 使用 prawn 生成 PDF 有时会导致 PDF 损坏

> ID：14048934
> 
> 赞同：2
> 
> 时间：2012-12-27T03:13:30.587
> 
> 标签：ruby-on-rails, pdf-generation, prawn

我正在创建一个包含 7 列表格的多页 PDF。

当我在我的开发计算机（Mac OS X 10.8、ruby 1.9.2、Rails 3.2.6）上创建 PDF 时，它会正确下载和呈现。

如果我在暂存服务器上创建 PDF，当我尝试在预览中查看它时收到以下错误消息“它可能已损坏或使用预览无法识别的文件格式。”

如果我在生产服务器上创建 PDF，它可以正常工作。

我尝试删除表中的所有列，然后一次将它们添加回来，看看是哪个导致了问题，但这并没有明显的原因。

认为这可能是表格宽度问题，我尝试将其更改为横向并减小字体大小，但仍然没有区别。

即使它在生产服务器上工作，我也想深入了解它，以防它也开始在那里发生。此外，如果无法在暂存时对其进行测试，我的客户将无法签署更新。

这是代码

```
@locations.each do |location|
    modules_marked = 10 # this is calculated in the actual code
    exams_marked = 10 # this is calculated in the actual code

    total_delegates += CourseDelegate.for_location(location).count
    total_modules += modules_marked
    total_exams += exams_marked

    entry = []
    entry << location.name[0..5]
    entry << location.division.name
    entry << location.operating_unit_number
    entry << location.purchase_order
    entry << CourseDelegate.for_location(location).count
    entry << modules_marked
    entry << exams_marked

    entries << entry
end

table(entries, :header => true, :width => bounds.width) do 
    row(0).font_style = :bold
    row(entries.count - 1).font_style = :bold

    cells.border_width = 0.1
    cells.border_color = "808080"

    cells.size = 8
    column(1).width = 60
    column(2).width = 60
    column(3).width = 50
    column(4).width = 50
    column(5).width = 50
    column(6).width = 50
    column(0).align = :left
    column(1).align = :left
    column(4).align = :center
    column(5).align = :center
    column(6).align = :center
end 
```

即使用硬编码的单个字母替换所有条目仍然会导致崩溃发生。

更新：我应该提到，当我在文本查看器中查看损坏的 PDF 文件时，它看起来好像文件只是在中途停止并且缺少结尾，这就是它没有在任何 PDF 查看器中显示的原因。

# intellij-idea - IDEA：如何抑制拼写错误的警告？

> ID：14048936
> 
> 赞同：29
> 
> 时间：2012-12-27T03:13:39.027
> 
> 标签：intellij-idea

我的一个函数加密一个字符串，我的一个测试验证它发生了。自然，像这样`sldjf982389`的字符串不会被识别为有效的英语单词，所以`IntelliJ`抱怨。

如果有办法在不向字典中添加垃圾的情况下抑制这些警告？

![在此处输入图像描述](../Images/66735d909b9f2027d09989ceda96e4d8.png)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2015-05-21T10:08:02.087

您可以使用以下@SuppressWarnings

例如，idea 抱怨“contentid”根据他应该是“contentId”

```
@SuppressWarnings("SpellCheckingInspection")
public static final String ARG_CONTENT_ID = "contentid"; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-12-27T03:31:54.250

您可以在“**检查**”菜单中禁用它。单击源代码顶部的绿色小框，或导航到“项目设置”分隔符下的“文件”>“设置”>“检查”。然后，您可以取消选中下面显示的框。

![Linux Mint 上 IntelliJ 中检查的屏幕截图](../Images/9891bc92bc9c1040d4fdaab5395bb3a0.png)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-01-11T16:41:16.810

任何检查的抑制设施内置于：![拼写抑制示例](../Images/761b6ee267ab6f7e7f03938027328858.png)

注意菜单上的右箭头。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-07-12T06:45:04.430

For Intellij IDEA 2020, the path to uncheck typos is `File > Settings > Editor > Inspections > Proofreading > Typo`

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-08-02T18:36:32.820

对于它的价值，在 intelliJ v2019.2 上转到`File > Settings > Editor > Color Scheme > General > Errors and Warnings > Typo`并取消`Effects`选中复选框。鳍！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-06T18:27:45.723

如果你想永远关闭拼写检查（对于所有项目）——我刚刚发现了快速而肮脏的 hack。

转到*文件*/*设置*，然后*编辑器*/*颜色和字体*/*常规*。查找拼写错误的设置并将下划线的颜色设置为背景颜色。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-04-28T23:46:11.137

JetBrains 显然是在引导人们远离内联代码拼写检查抑制的复杂性，转而将单词添加到适当的字典中。

起初，我也在寻求内联代码抑制，但是，我可以看到字典哲学在完成工作的更大范围内更容易，并且不会陷入内联代码抑制及其混乱，例如对于可能的单词通常在项目的其他地方或几个项目中使用。可以使用按项目或应用范围使用字典的选项。

# javascript - 使用 .split() 将字符串分解为数组

> ID：14048938
> 
> 赞同：2
> 
> 时间：2012-12-27T03:14:42.690
> 
> 标签：javascript, jquery, json

我正在尝试将字符串分解为数组。下面的代码确实做到了，但我现在需要将其分解为一个子数组。

这是字符串和代码：

```
$(document).ready(function() {
var content='Image{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}Button{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}Button{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}';

var result = content.split('}');
result.pop();// removing the last empty element
console.log(result);
for(var i=0;i<result.length;i++)
{
    result[i]+='}';
    console.log(result);
        $('div').append('<li>' + result[i] + '</li>');
}
}) 
```

这表明：

```
<li>Image{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}</li>
<li>Button{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}</li>
<li>Button{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}</li>
<li>Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}</li> 
```

我现在需要做的是进一步分解它，以便我在 {} 之前有这个词，即第一个的图像

理想情况下，我希望输出是这样的键/值对象

```
 {
        "Controls": [{ "Image":"{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}", 
    "Button":"{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}", 
"Button":"{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}", 
    "Label":"{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}", }],
    } 
```

我的主要目标是能够在此结束时定位 Key 或 Value。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T03:49:42.937

尝试这个。如果您想要键值定位，您可以将其解析为 JSON。但我认为这不是有效的 JSON。

```
var content='Image{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}' +
'Button{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}' +
'Button2{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}' +
'Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}';

// add colons after the keys
content = content.replace(/([\w]+){/g, '"$1":{');

// wrap all {} in quotes
content = content.replace(/({[^}]+})/g, '"$1",');

// remove trailing comma
content = content.slice(0, -1);

content = '{"Controls": [{' + content + '}]}';

console.log(content); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:32:45.960

使用正则表达式可能会更好

```
// the regexp
var re = /(.+?)(\{.*?\})/g,
    group;

var content='Image{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}Button{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}Button{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}';

var ret = {};

while(group = re.exec(content)) {
    var k = group[1],
        v = group[2];

    ret[k] = ret[k] ? ret[k].substring(0, ret[k].length - 1) + v.substring(1, v.length) : v;
}

// output
console.log(ret);   // => {'Button': '{xxx}', 'Image': '{xxxx}', 'Label': '{xxxx}'} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T03:49:14.393

**这应该产生你想要的输出：**

```
$(document).ready(function() {
    var content='Image{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}Button{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}Button{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}';

    var result = content.split('}');
    result.pop();// removing the last empty element
    var obj = {Controls:{}};

    $.each(result, function (i, v) {
        var key = v.split('{');
        var value = v.replace(key[0], '') + '}';

        if (key[0] !== 'Button') {
            obj.Controls[key[0]] = value;
        } else {
            if (!obj.Controls.hasOwnProperty('Buttons')) {
                obj.Controls['Buttons'] = [];
            }   
            obj.Controls.Buttons.push(value);
        }
    });

    console.log(obj);
});​ 
```

**工作演示：http:** [//jsfiddle.net/fewds/TuNTV/2/](http://jsfiddle.net/fewds/TuNTV/2/)

**输出示例：**

```
{
    "Controls": {
        "Image": "{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}",
        "Buttons": [
            "{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}",
            "{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}"
        ],
        "Label": "{Position: 106, 91;Width: 96;Height: 34;Text: \"Button\";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}"
    }
} 
```

**如果您只想增加多个键的出现次数，可以使用：**

```
$(document).ready(function() {
    var content='Image{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}Image{BackgroundImage: Image2.gif;Position: 0, 0;Width: 320;Height: 480;}Button{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}Button{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}Button{BackgroundImage: Button3.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}Label{Position: 106, 91;Width: 96;Height: 34;Text: "Button";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}';

    var result = content.split('}');
    result.pop();// removing the last empty element
    var obj = {Controls:{}};

    function nextProp(key) {
        if(obj.Controls.hasOwnProperty(key)) {
            var num = key.match(/\d+$/);
            if (num) {
                return nextProp(key.replace(num[0], '') + (parseInt(num[0], 10) + 1));
            } else {
                return nextProp(key + '1');
            }
        }

        return key;
    }

    for (var i = 0; i < result.length; i++) {
        var key = result[i].split('{');
        var value = result[i].replace(key[0], '') + '}';
        obj.Controls[nextProp(key[0])] = value;
    }

    console.log(obj);
});​ 
```

**工作演示：http:** [//jsfiddle.net/fewds/TuNTV/5/](http://jsfiddle.net/fewds/TuNTV/5/)

**输出示例：**

```
{
    "Controls": {
        "Image": "{BackgroundImage: Image.gif;Position: 0, 0;Width: 320;Height: 480;}",
        "Image1": "{BackgroundImage: Image2.gif;Position: 0, 0;Width: 320;Height: 480;}",
        "Button": "{BackgroundImage: Button.gif;Position: 49, 80;Width: 216;Height: 71;}",
        "Button1": "{BackgroundImage: Button2.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}",
        "Button2": "{BackgroundImage: Button3.gif;Transition: View2;Position: 65, 217;Width: 188;Height: 134;}",
        "Label": "{Position: 106, 91;Width: 96;Height: 34;Text: \"Button\";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}",
        "Label1": "{Position: 106, 91;Width: 96;Height: 34;Text: \"Button\";FontSize: 32;Color: 0.12549, 0.298039, 0.364706, 1;}"
    }
} 
```

# javascript - 如何在 $.ajax({ url : " "}); 的 URL 中添加变量

> ID：14048939
> 
> 赞同：8
> 
> 时间：2012-12-27T03:14:51.697
> 
> 标签：javascript, jquery, ajax, url, input

我希望用户能够将部分 URL 地址更改为他们的邮政编码。我有一个文本框和按钮，我希望将值提交给 URL。

jQuery：

```
jQuery(document).ready(function($) {
    $.ajax({ 
        url : "http://SomeAddress.com/" + PostCode + ".json",
        dataType : "jsonp",
        success : function(parsed_json) { 
```

HTML：

```
<input type="text" id="GetPostCode" />
<button id="SetPostCode">Set This Post Code</button> 
```

jQuery：

```
$("#SetPostCode").click(function() {
    var PostCode = document.getElementById("GetPostCode").value;
    $("#GetPostCode").val(" ");
    return false;
}); 
```

我明白这条线

```
$.ajax({ 
    url : "http://api.wunderground.com/api/2508132ae0c7601a/geolookup/conditions/q/UK/" + PostCode + ".json", 
```

那样不行，但我不知道还能做什么。有人可以告诉我我需要做什么才能让它工作吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-27T03:22:23.440

```
jQuery(document).ready(function($) {

   var PostCode=1;
   $.ajax({ url : "http://SomeAddress.com/"+PostCode +".json",
   dataType : "jsonp"
   //.... more stuff
  });

  $("#SetPostCode").click(function() {
     PostCode = document.getElementById("GetPostCode").value;
     $("#GetPostCode").val(" ");
     return false; 
  });

}); 
```

上面可以工作，因为 PostCode 现在对 jQuery 来说是全局的，并且可以在任何地方访问

# javascript - 遇到第一个字母“x”时拆分段落中的内容？

> ID：14048941
> 
> 赞同：2
> 
> 时间：2012-12-27T03:15:07.093
> 
> 标签：javascript

例子：`Alex is my name!`

我不想为第一个以字母“x”结尾的单词分配变量。

使用什么 jquery 代码？您的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T03:22:23.100

以下正则表达式将匹配以“x”结尾的单词：

```
var firstX = /\b\w*x/; 
```

如果您在某些文本上运行它，结果将包含以下单词：

```
var match = firstX.exec(someText);
var word = match ? match[0] : null; 
```

如果你想要那个词，然后是它后面的其余字符串：

```
var firstX = /\b(\w*x)\b(.*)$/;
var match = firstX.exec(someText);
var word = match ? match[1] : null;
var theRest = match ? match[2] : null; 
```

# javascript - 如何简单地显示来自 YQL 的 xml 输出或将 JSON 输出到 html

> ID：14048943
> 
> 赞同：2
> 
> 时间：2012-12-27T03:15:29.543
> 
> 标签：javascript, jquery, html, json, yql

所以我一直在研究一种从页面中抓取数据并显示它的方法（与源的格式大致相同）。我找到了 YQL，我发现它很棒，除了我不知道如何只显示整个输出而没有什么特别的（除了基本格式）

YQL 输入代码为：

```
select * from html where url="http://directory.vancouver.wsu.edu/anthropology" and xpath="//div[@id='facdir']" 
```

使用它返回 JSON：

```
http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fdirectory.vancouver.wsu.edu%2Fanthropology%22%20and%20xpath%3D%22%2F%2Fdiv%5B%40id%3D'facdir'%5D%22&format=json&callback=anthropology 
```

我遵循了 yahoo 教程，并创建了新闻小部件等，但没有一个教程涵盖基本视图（也不需要链接，只需要段落设置）。

**像这样：**

```
Name
Title
Phone:(###)###-####
Location: Building and Room #
email@vancouver.wsu.edu 
```

这是我从[http://christianheilmann.com](http://christianheilmann.com)获得的输出，但它什么也没做（显然她的教程都不起作用，每个教程都试过了）：

```
<html>
<head>
<script src="http://code.jquery.com/jquery-latest.js"></script>  
</head>
<body>
<p>
<b>Copied:</b>
</p>
<div>
<script>
function anthropology (0) {
// get the DIV with the ID $
var info = document.getElementById('facdir');
// add a class for styling
info.className = 'js';
// if it exists
if(info){
// get the info data returned from YQL
var data = o.query.results.span;
var link = info.getElementsByTagName('a')[0];
link.innerHTML = '(see all info)';
// to the main container DIV
var out = document.createElement('span');
out.className = 'info';
info.insertBefore(out,link.parentNode);
}
}
</script>
<script src='http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fdirectory.vancouver.wsu.edu%2Fanthropology%22%20and%20xpath%3D%22%2F%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%22&format=json&callback=anthropology'></script>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T18:23:48.960

我最近完成了一个包含几个 jsFiddles 的教程，并解释了如何使用`YQL`、`XPATH`和 jQuery`.ajax()`来解决不同的 SO 问题，这将为您的方向提供一些启示。你可以在这里看到[***SO Answer***](https://stackoverflow.com/a/14042902/1195891)。

为了满足您问题的可接受答案，我整理了一个工作演示，向您展示从您请求的网页中抓取数据是多么容易。

jsFiddle Demo 包含大量评论和`console.log()`消息，以了解工作流程。确保您激活浏览器控制台并使用[**Firebug**](http://getfirebug.com/enable)。用于构建*教职员工框*的`HTML`和模仿原始网站中的那些框，包括图像、名称、电子邮件和网页主题中的链接。`CSS`

 ***演示：**

[**jsFiddle 数据抓取 XML：动态网页构建**](http://jsfiddle.net/mtZ37/1/)

***修改！！！*** *除了上面修改的jsFiddle，见相关*

[**jsFiddle 教程：创建动态 Div（*现已改进！*）**](http://jsfiddle.net/C5xWL/1/)

**HTML：**

```
<div id="results"></div> 
```

**jQuery：**

```
var directoryName = 'child-development-program';

$.ajax({
    type: 'GET',
    url: "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fdirectory.vancouver.wsu.edu%2F" + directoryName + "%22%20and%20xpath%3D%22%2F%2Fdiv%5B%40id%3D'content-inner'%5D%2Fdiv%2Fdiv%2Fdiv%2Fdiv%2Fdiv%5B2%5D%22",
    dataType: 'xml',
    success: function(data) {

        if (data) {

            // Show in console the jQuery Object.
            console.info('Here is the returned query');
            console.log( $(data).find('query') );

            // Show in console the results in inner-html text.
            var textResults = $(data).find('results').text();
            console.log( textResults );

            // Parse the list of faculty members. Variable indexFM is not used for indexed faculty member.
            $(data).find('results').find('.views-row').each(function(indexFM){

                // This variable will store the current faculty member.
                var facultyMember = this;
                console.info('Faculty jQuery DIV Object shown on next lines.');
                console.log( facultyMember );

                // Parse the contents of each faculty member. Variable indexFC is not used for indexed faculty content.
                $(facultyMember).each(function(indexFC){

                    // Get Thumbnail Image of Faculty Member
                    var facultyMemberImage = $(this).find('.views-field-field-profile-image-fid #directoryimage a img').attr('src');
                    console.log( facultyMemberImage );

                    // Get Title (Name) of Faculty Member
                    var facultyMemberTitle = $(this).find('.views-field-field-professional-title-value #largetitle').text();
                    console.log( facultyMemberTitle );
                    // Get relative URL fragment.

                    //
                    // Stackoverflow Edit: Much more extraction in this section, see jsFiddle link above.
                    // 

                    // Get Email of Faculty Member
                    var facultyMemberEmail = $(this).find('.views-field-field-email-value span').text();

                    // Simple dashed line to separate faculty members as seen in browser console.
                    console.log('--------');

                    var divObject = '<div class="dynamicResults"><div class="dynamicThumb"><a href="' + facultyMemberUrl + '"><img src="' + facultyMemberImage + '" alt=""></a></div><div class="dynamicInfo"><div class="dynamicText"><a href="' + facultyMemberUrl + '" class="dynamicName">' + facultyMemberTitle + '</a></div><div class="dynamicText">' + facultyMemberPosition + '</div><div class="dynamicText">Phone: ' + facultyMemberPhone + '</div><div class="dynamicText">Location: ' + facultyMemberBuilding + ' <span>' + facultyMemberRoom + '</span></div><div class="dynamicText"><a href="' + facultyMemberEmailUrl + '" class="dynamicEmail">' + facultyMemberEmail + '</a><span class="dynamicEmailpic"></span></div></div></div><div class="clear"></div>';

                    // Build webpage with dynamic data.
                    $('#results').append( divObject );

                });

            });

        }
    }
}); 
```

**截图：** *照片中的缩略图是 100px x 100px修改后的 jsFiddle**照片！***

![](../Images/846a4d00a22197b93a711ee85613a41b.png)

* * *

但是在真正查看您的问题时，我想尝试一些新的简单的东西……但是结果是可以接受的。这一次，数据抓取技术是使用网页原生`CSS`文件作为 jsFiddle 中的资产，同时也将返回的数据直接使用到`DOM`.

此方法使用与上述相同的原理，只是它`html`用作原始网页`.ajax()` `dataType`的*近克隆*。唯一的缺点是需要整个 CSS 文件，但您可以解析原始文件以删除多余的样式和不需要的选择器（*重要的是不要打破 IE 中的 4096 CSS 选择器障碍*）。

**演示：**

[**jsFiddle 数据抓取 HTML：克隆该网页**](http://jsfiddle.net/UuRSG/)

**HTML**

```
<link type="text/css" rel="stylesheet" media="all" href="http://directory.vancouver.wsu.edu/sites/directory.vancouver.wsu.edu/files/css/css_f9f00e4e3fa0bf34a1cb2b226a5d8344.css" />

<div id="facultyAnthropology"></div> 
```

**jQuery：**

```
var directoryName = 'anthropology';

    $.ajax({
        type: 'GET',
        url: "http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fdirectory.vancouver.wsu.edu%2F"+directoryName+"%22%20and%20xpath%3D%22%2F%2Fdiv%5B%40id%3D'content-area'%5D%22",
        dataType: 'html',
        success: function(data) {
            $('#facultyAnthropology').append($(data).find('results'));
        }
    }); 
```

**截图：** *如上，照片中的缩略图为 100px x 100px*

![](../Images/74ce20264cdfee2767dbf50a95a7719c.png)*

# objective-c - 带有更多...文本的 UILabel

> ID：14048944
> 
> 赞同：2
> 
> 时间：2012-12-27T03:15:37.350
> 
> 标签：objective-c, ios, xcode, uilabel

我有一个包含多行的文本，但最后我想添加短语“更多...”，如果用户按下更多...单词而不是它应该显示段落其余部分的系统。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:21:31.067

一种方法是：使用 UILabel 显示短文本 将 UIButton 放在“显示更多”的下方 将按钮设置为看起来像 UILabel 捕捉按钮的动作，然后删除按钮并显示多文本并更改UILabel 的大小。

对于新手程序员来说，这不是正确的方法，我希望我对一个想法有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T04:04:09.240

没有特别简单的方法，内置的方法可以做到这一点。如果您想自己实现它，最好的办法是使用 a`UITextView`而不是 a `UILabel`。 `UITextView`符合`UITextInput`协议，因此当您检测到文本视图上的点击时，您可以使用`closestPositionToPoint:`相关消息来确定字符串的哪一部分被点击。

[`TTTAttributedLabel`](https://github.com/mattt/TTTAttributedLabel)您可以使用or代替自己做[`OHAttributedLabel`](https://github.com/AliSoftware/OHAttributedLabel)。这两个都内置支持检测链接上的点击。我也没有用过，所以我不能告诉你哪个更好。可能还有其他免费的解决方案可用，但很容易找到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-27T03:25:19.443

您可以使用包含有限文本的 UITextView 并添加一个 UITapGestureRecognizer，当点击它时，会删除手势​​并将文本添加到 textview。

# python - 如何按键查找特定的 JSON 值？

> ID：14048948
> 
> 赞同：34
> 
> 时间：2012-12-27T03:15:58.657
> 
> 标签：python, json, search

有一个这样的 JSON：

```
{
  "P1": "ss",
  "Id": 1234,
  "P2": {
      "P1": "cccc"
  },
  "P3": [
      {
          "P1": "aaa"
      }
  ]
} 
```

如何在`P1`不迭代所有 JSON 的情况下找到 all 的值？

PS：`P1`可以在 JSON 中的*任何位置。*

如果没有方法可以做到这一点，你能告诉我如何遍历 JSON 吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-27T18:46:59.090

正如我在[另一个答案](https://stackoverflow.com/a/14055129/355230)中所说，我认为没有一种方法可以在`"P1"`不迭代整个结构的情况下找到与键关联的所有值。但是，在查看@Mike Brennan对另一个与 JSON 相关的问题的[回答](https://stackoverflow.com/a/6633651/355230)时，我想出了更好的方法来做到这一点。[如何从 JSON 中获取字符串对象而不是 Unicode？](https://stackoverflow.com/questions/956867/how-to-get-string-objects-instead-of-unicode-from-json)

基本思想是使用仅接受的`object_hook`参数[`json.loads()`](https://docs.python.org/3/library/json.html#json.loads)来观察正在解码的内容并检查需要的值。

**注意：**这仅在表示为 JSON [`object`](https://www.json.org)（即用[花括号括](https://en.wikipedia.org/wiki/Bracket#Curly_brackets) `{}`起来的内容）时才有效，如您的示例中所示。

```
from __future__ import print_function
import json

def find_values(id, json_repr):
    results = []

    def _decode_dict(a_dict):
        try:
            results.append(a_dict[id])
        except KeyError:
            pass
        return a_dict

    json.loads(json_repr, object_hook=_decode_dict) # Return value ignored.
    return results

json_repr = '{"P1": "ss", "Id": 1234, "P2": {"P1": "cccc"}, "P3": [{"P1": "aaa"}]}'
print(find_values('P1', json_repr)) 
```

(Python 3) 输出：

```
['cccc', 'aaa', 'ss'] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-27T03:53:19.160

前几天我也遇到了同样的问题。我最终只是搜索了整个对象并考虑了列表和字典。以下片段允许您搜索多个键的*第一次*出现。

```
import json

def deep_search(needles, haystack):
    found = {}
    if type(needles) != type([]):
        needles = [needles]

    if type(haystack) == type(dict()):
        for needle in needles:
            if needle in haystack.keys():
                found[needle] = haystack[needle]
            elif len(haystack.keys()) > 0:
                for key in haystack.keys():
                    result = deep_search(needle, haystack[key])
                    if result:
                        for k, v in result.items():
                            found[k] = v
    elif type(haystack) == type([]):
        for node in haystack:
            result = deep_search(needles, node)
            if result:
                for k, v in result.items():
                    found[k] = v
    return found

deep_search(["P1", "P3"], json.loads(json_string)) 
```

它返回一个字典，其中的键是搜索的键。Haystack 应该已经是一个 Python 对象了，所以你必须在将它传递给 deep_search 之前执行 json.loads。

欢迎大家提出优化意见！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-12-27T06:08:56.710

我解决这个问题的方法会有所不同。

由于 JSON 不允许深度优先搜索，因此将 json 转换为 Python 对象，将其提供给 XML 解码器，然后提取您要搜索的节点

```
from xml.dom.minidom import parseString
import json        
def bar(somejson, key):
    def val(node):
        # Searches for the next Element Node containing Value
        e = node.nextSibling
        while e and e.nodeType != e.ELEMENT_NODE:
            e = e.nextSibling
        return (e.getElementsByTagName('string')[0].firstChild.nodeValue if e 
                else None)
    # parse the JSON as XML
    foo_dom = parseString(xmlrpclib.dumps((json.loads(somejson),)))
    # and then search all the name tags which are P1's
    # and use the val user function to get the value
    return [val(node) for node in foo_dom.getElementsByTagName('name') 
            if node.firstChild.nodeValue in key]

bar(foo, 'P1')
[u'cccc', u'aaa', u'ss']
bar(foo, ('P1','P2'))
[u'cccc', u'cccc', u'aaa', u'ss'] 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-12-27T03:47:40.420

使用`json`将 json 转换为 Python 对象，然后递归处理效果最好。这个例子*确实*包括遍历列表。

```
import json
def get_all(myjson, key):
    if type(myjson) == str:
        myjson = json.loads(myjson)
    if type(myjson) is dict:
        for jsonkey in myjson:
            if type(myjson[jsonkey]) in (list, dict):
                get_all(myjson[jsonkey], key)
            elif jsonkey == key:
                print myjson[jsonkey]
    elif type(myjson) is list:
        for item in myjson:
            if type(item) in (list, dict):
                get_all(item, key) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-27T03:25:46.210

将 JSON 转换为 Python 并递归搜索是迄今为止最简单的：

```
def findall(v, k):
  if type(v) == type({}):
     for k1 in v:
         if k1 == k:
            print v[k1]
         findall(v[k1], k)

findall(json.loads(a), 'P1') 
```

（其中 a 是字符串）

示例代码忽略数组。添加它作为练习。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-02-12T02:17:43.163

记住 json 只是一个字符串，使用带有前瞻和后视的正则表达式可以非常快速地完成这项任务。

通常情况下，json 会从对外部 api 的请求中提取，因此显示其工作方式的代码已包含但已注释掉。

```
import re
#import requests
#import json

#r1 = requests.get( ... url to some api ...)
#JSON = str(json.loads(r1.text))
JSON = """
 {
  "P1": "ss",
  "Id": 1234,
  "P2": {
      "P1": "cccc"
  },
  "P3": [
     {
          "P1": "aaa"
     }
  ]
 }
"""
rex1  = re.compile('(?<=\"P1\": \")[a-zA-Z_\- ]+(?=\")')
rex2 = rex1.findall(JSON)  
print(rex2)

#['ss', 'cccc', 'aaa'] 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-12-27T12:58:47.490

我认为没有任何方法可以在不遍历整个结构的情况下找到与 P1 相关的所有值。这是一种递归方式，首先将 JSON 对象反序列化为等效的 Python 对象。为了简化事情，大部分工作都是通过递归私有嵌套函数完成的。

```
import json

try:
    STRING_TYPE = basestring
except NameError:
    STRING_TYPE = str  # Python 3

def find_values(id, obj):
    results = []

    def _find_values(id, obj):
        try:
            for key, value in obj.items():  # dict?
                if key == id:
                    results.append(value)
                elif not isinstance(value, STRING_TYPE):
                    _find_values(id, value)
        except AttributeError:
            pass

        try:
            for item in obj:  # iterable?
                if not isinstance(item, STRING_TYPE):
                    _find_values(id, item)
        except TypeError:
            pass

    if not isinstance(obj, STRING_TYPE):
        _find_values(id, obj)
    return results

json_repr = '{"P1": "ss", "Id": 1234, "P2": {"P1": "cccc"}, "P3": [{"P1": "aaa"}]}'

obj = json.loads(json_repr)
print(find_values('P1', obj)) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-18T11:39:17.907

您还可以使用生成器在 json.load() 之后搜索对象。

我在这里回答的代码示例：[https ://stackoverflow.com/a/39016088/5250939](https://stackoverflow.com/a/39016088/5250939)

```
def item_generator(json_input, lookup_key):
    if isinstance(json_input, dict):
        for k, v in json_input.iteritems():
            if k == lookup_key:
                yield v
            else:
                for child_val in item_generator(v, lookup_key):
                    yield child_val
    elif isinstance(json_input, list):
        for item in json_input:
            for item_val in item_generator(item, lookup_key):
                yield item_val 
```

# weka - 测试/训练对分类结果的影响

> ID：14048950
> 
> 赞同：-2
> 
> 时间：2012-12-27T03:16:11.743
> 
> 标签：weka

我正在努力理解训练/测试数据对我正确分类的实例结果的影响。

一个朴素贝叶斯的例子，如果我在百分比分割中应用更多的测试数据，算法变得更可靠？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T05:14:39.553

将整个数据集拆分为训练和测试的要点是，您想要学习的模型（朴素贝叶斯或其他）应该反映因果关系（特征和预测）之间的真实关系，而不仅仅是数据。例如，您始终可以将曲线完美地拟合到多个数据点，但这样做可能会使其对您试图做出的预测毫无用处。

通过使用单独的测试集，学习模型在*看不见*的数据上进行测试。理想情况下，训练集和测试集上的误差（或您要测量的任何东西）大致相同，这表明您的模型相当普遍，并且不会*过度拟合*训练数据。

如果在您的情况下，减小训练集的大小会提高测试集的性能，则表明学习的模型过于具体，无法泛化。但是，您应该调整学习器的参数，而不是更改训练/测试拆分。您可能还想考虑使用[交叉验证](http://en.wikipedia.org/wiki/Cross-validation_%28statistics%29)而不是简单的训练/测试拆分，因为它将提供更可靠的性能估计。

# mysql - 在 MySQL 中捕获具有特定值的条目

> ID：14048957
> 
> 赞同：-1
> 
> 时间：2012-12-27T03:17:42.790
> 
> 标签：mysql, sql, select

可以说我有桌子：

```
user   |online
-------|------
frash--|--1---
hoo----|--0---
pree---|--1--- 
```

我只想 fectc frash 和 pree 以显示在 html 文件中，我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:35:12.330

直接回答你的问题，这应该很简单，

```
SELECT *
FROM   tableName
WHERE  online = 1 
```

 ~~要了解有关联接的更多信息，请参阅下面的链接

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

 ~~* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T03:22:55.373

你能更具体一点吗？听起来您想使用外部数据库键将两个表关联在一起。最简单的方法是确保两个表中的每条记录都有一个唯一的 id 字段，然后您可以通过它们的唯一 ID 一起引用记录。

例如，给用户表一个“user_id”字段。为在线表提供一个“user_id”字段，该字段将与用户表中的 user_id 匹配。

然后你可以做类似的事情......

SELECT user.name FROM user, online WHERE user.user_id = online.user_id

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-27T03:28:30.080

您必须阅读以下`where`条款：

[http://www.tutorialspoint.com/mysql/mysql-where-clause.htm](http://www.tutorialspoint.com/mysql/mysql-where-clause.htm)~~~~

# c# - 带有枚举的 Protobuf-net 反序列化异常

> ID：14048958
> 
> 赞同：4
> 
> 时间：2012-12-27T03:17:43.423
> 
> 标签：c#, protocol-buffers, protobuf-net

我有一个带有标志的枚举，我用序列化的 [ProtoMember] 属性装饰~~并反序列化~~在我运行 Win7 x64 的本地机器上很好。

~~但是，我的用例涉及在运行 Windows Server 2008 R2 Enterprise 64 位的服务器上序列化并在我的本地机器上反序列化。~~当我反序列化时，出现异常：“溢出异常未处理；算术运算导致溢出”。它似乎是从 ProtoBuf.Serializers.CompiledSerializer.ProtoBuf.Serializers.IProtoSerializer.Read(Object value, ProtoReader source) 抛出的。

我尝试将枚举更改为 int 并序列化~~在服务器上~~/反序列化本地工作。我想使用枚举而不是int。我究竟做错了什么？

~~不确定这是否是相关信息，但我在服务器上运行的可执行文件是在我的本地机器上构建的。~~

枚举来自引用的外部 dll。当我在我的解决方案中复制枚举代码时，反序列化工作。仅当我使用来自外部 dll 的枚举（我怀疑源代码未知）并且枚举值大于（似乎）128 时才会引发异常。在我的情况下，Status.Zeta 和 Status。全部抛出异常；其他枚举值正确反序列化。枚举定义如下：

```
[Flags]
public enum Status
{
    None = 0,
    Alpha = 1,
    Beta = 8,
    Gamma = 16,
    Delta = 32,
    Epsilon = 64,
    Zeta = 132,
    All = 255,
} 
```

我无法更改 dll 中的代码。我怎样才能使这项工作？我需要一个 .proto 文件吗？如果可能的话，我会尽量避免这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T08:23:12.013

这只会影响枚举`: byte`

哦！发现脑死错误：

```
case ProtoTypeCode.SByte: Emit(OpCodes.Conv_Ovf_U1); break;
case ProtoTypeCode.Byte: Emit(OpCodes.Conv_Ovf_I1); break; 
```

这将在今天晚些时候被逆转和部署。谢谢。

正确解释：`byte`是无符号的（0到255），`sbyte`是有符号的（-128到127）；`Conv_Ovf_U1`基本上是“转换为`byte`，检查溢出”的 IL（就像`checked`C# 中的关键字如何工作），并且`Conv_Ovf_I1`是“转换为`sbyte`，检查溢出”。因此，任何超过 127 的值都会触发溢出标志，从而导致异常。这已在 r614 中修复，现已部署。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T04:20:51.833

这确实有点奇怪。CLR 中可能存在影响 ProtoBuf 的差异（例如，CLR 附带许多不同的 GC）。比较两台机器的 Machine.config 文件可能会发现一些差异。

至于解决问题，您可以尝试使用 ProtoContract 标记枚举本身，并使用 ProtoMember 标记每个枚举成员。后者允许您设置一个 Value 属性供 ProtoBuf 使用。您还可以将 DataFormat 设置为 Fixed 并查看它是否比默认设置更好。

您可以在此处找到一些[示例](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/EnumTests.cs)。

# c - xcode中makefile项目的C代码中的“符号未找到”

> ID：14048960
> 
> 赞同：4
> 
> 时间：2012-12-27T03:18:05.507
> 
> 标签：c, makefile, xcode4.5

我在 xcode4.5（OSX -> 其他 -> 外部构建系统）中创建了一个 makefile 项目，并向其中添加了一些`c`文件。我可以`make`成功地完成项目。

但是`"symbol not found"`当我尝试跳转到函数的定义时，它会告诉我。

我尝试了google的一些方法，例如删除xcworkspace和xcuserdata文件夹以及删除项目的派生数据等。但他们都失败了。有什么解决办法吗？

顺便说一句，我的项目非常简单，位于[此处](https://github.com/changchang/helloworld)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-02T02:56:45.177

*   Makefile 和代码在命令行下工作正常。
*   在 xcode 中设置一个快速项目（5.1.1 btw，这是我安装的）
*   OSX->其他->外部构建系统
*   在项目创建向导中将项目目录设置为 git checkout。
*   在 External Build Tool Configuration->Info 中，将 Directory 设置为 git checkout 目录。
*   产品->构建
*   构建良好，运行良好。

如果我采取的步骤中没有任何帮助，则无能为力，必须查看您的 xcode 项目的 dmg。

# javascript - 根据用户从下拉菜单中的选择将用户引导至 url

> ID：14048963
> 
> 赞同：0
> 
> 时间：2012-12-27T03:18:46.137
> 
> 标签：javascript, drop-down-menu, menu

我找到了一个可以满足我需要的脚本（下拉菜单），但我希望它根据他从下拉菜单中的选择将用户带到外部/内部 url，例如，如果他选择 USA，然后选择 NY，他们会转到 url#1如果选择美国和新泽西去 url#2，这就是我想要的

剧本：

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript">
        var citiesByState = {
            USA: ["NY","NJ"],
            Singapore: ["taas","naas"]
        }
        function makeSubmenu(value) {
            if(value.length==0) document.getElementById("citySelect").innerHTML = "<option></option>";
            else {
                var citiesOptions = "";
                for(cityId in citiesByState[value]) {
                    citiesOptions+="<option>"+citiesByState[value][cityId]+"</option>";
                }
                document.getElementById("citySelect").innerHTML = citiesOptions;
            }
        }
        function displaySelected() {
            var country = document.getElementById("countrySelect").value;
            var city = document.getElementById("citySelect").value;
            alert(country+"\n"+city);
        }
        function resetSelection() {
            document.getElementById("countrySelect").selectedIndex = 0;
            document.getElementById("citySelect").selectedIndex = 0;
        }
    </script>
</head>
<body onload="resetSelection()">
    <select id="countrySelect" size="1" onchange="makeSubmenu(this.value)">
        <option></option>
        <option>USA</option>
        <option>Singapore</option>
    </select>
    <select id="citySelect" size="1">
        <option></option>
    </select>
    <button onclick="displaySelected()">show selected</button>
</body>
</html> 
```

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T03:37:15.667

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript">
        var citiesByState = {
            "USA": ["NY","NJ"],
            "Singapore": ["taas","naas"]
        }
        var navURLs = {
            "USA": {"NY": "http://www.yahoo.com","NJ": "http://www.google.com"},
            "Singapore": {"taas": "http://www.bing.com","naas": "http://www.ibm.com"}
        }
        function makeSubmenu(value) {
            if(value.length==0) document.getElementById("citySelect").innerHTML = "<option></option>";
            else {
                var citiesOptions = "";
                for(cityId in citiesByState[value]) {
                    citiesOptions+="<option>"+citiesByState[value][cityId]+"</option>";
                }
                document.getElementById("citySelect").innerHTML = citiesOptions;
            }
        }
        function displaySelected() {
            var country = document.getElementById("countrySelect").value;
            var city = document.getElementById("citySelect").value;
            alert(country+"\n"+city);
            navURL = navURLs[country][city];
            if(navURL){
                alert(navURL);                    
                window.location.href = navURL;
            }
        }
        function resetSelection() {
            document.getElementById("countrySelect").selectedIndex = 0;
            document.getElementById("citySelect").selectedIndex = 0;
        }
    </script>
</head>
<body onload="resetSelection()">
    <select id="countrySelect" size="1" onchange="makeSubmenu(this.value)">
        <option></option>
        <option>USA</option>
        <option>Singapore</option>
    </select>
    <select id="citySelect" size="1">
        <option></option>
    </select>
    <button onclick="displaySelected()">show selected</button>
</body>
</html>​ 
```

# lvm - 如何在 LVM 卷中挂载 LVM 分区？

> ID：14048965
> 
> 赞同：3
> 
> 时间：2012-12-27T03:18:53.297
> 
> 标签：lvm

我已经建立了一个名为 cinder-volumes 的 VG。在这个 VG 中，我创建了一个名为 leader-volume 的 PV。然后我将这个 PV 挂载为 KVM Ubuntu 安装的根文件系统。在安装过程中，我选择了LVM分区。最后，我为 PV 领导卷创建了一个快照。现在我想在我的 Ubuntu 安装中读取一些文件......我该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-20T20:06:13.047

看一下`kpartx`- 它对于管理整个文件系统通常打包到单个卷中的 VM 特别有用。 `kpartx`可以为嵌套在块设备或磁盘映像上的分区创建设备节点。

挂载（以下之一）：

```
kpartx -av your_vm_disk.img 
```

```
kpartx -av /dev/mapper/your_device 
```

哪里`your_device`可能是 LVM 分区。该`-v`选项会导致`kpartx`显示它为嵌套分区创建的设备。

挂载适当的 /dev/mapper/loopXpX：

```
mount /dev/mapper/loop0p1 /mnt 
```

卸载（卸载循环设备后）：

```
umount -d /dev/mapper/loop0 
```

```
umount -d diskimage.img 
```

删除设备映射：

```
kpartx -dv your_vm_disk.img 
```

```
kpartx -dv /dev/mapper/your_device 
```

# javascript - Javascript 与 onclick 和 onmouseout 冲突

> ID：14048967
> 
> 赞同：0
> 
> 时间：2012-12-27T03:19:16.530
> 
> 标签：javascript, events

您好，感谢您查看我的帖子。我对脚本很陌生，我遇到了一个我无法弄清楚的简单问题。所以...

我有一个按钮，当我按下它时它会冻结，并且它的“onclick”功能不会被触发。有一个“onmouseout”功能导致了这种情况，但我不知道为什么。

我希望将“onmouseout”和“onclick”功能应用于一个按钮，但它不起作用。请看我的代码：

Javascript：

```
function popup() 
{
    alert("Hello World")
}

function pop2() 
{
    alert("Good job")
}

function pop3() 
{
    alert("CLICK ME!")
} 
```

HTML：

```
<input type="button" onclick="popup()" value="Hello World">
<input type="button" onclick="pop2()" onmouseout="pop3()" value="click me"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T04:02:24.433

调整您的代码以隔离并提供正在发生的事情的详细信息，我准备了以下内容：

**[http://jsfiddle.net/238Nz/8/](http://jsfiddle.net/238Nz/8/)**

* * *

> # ^([^([**跳过这部分下面的答案。这是为马克准备的。**])])
> 
> ^(让我们忽略使用`on*`属性添加处理程序是好是坏^$。另外，让我们使用一些日志记录来检查订单。我`console.log()`用来向浏览器的 Javascript 控制台发送消息。在 Firefox 中，我使用 Firebug，而 Chrome 有一个内置控制台。在两者中，右键单击页面和`Inspect Element`，然后选择`Console`这些测试的选项卡。)
> 
> ^(还有一件事：jsFiddle 一开始可能有点复杂。底部左侧窗格中的 Javascript 实际上放在源*中*（和标记）*上方*的`head`块中。右键单击底部右侧 ( ) 窗格，您将看到浏览器正在使用什么。它就像您自己的示例 HTML 文档一样，只是为 jsFiddle 重新排序。不过，尽量不要被它的工作原理所迷惑。*`input``body``View Source``Result`*)

 ** * *

我用来测试您的问题的标记如下：

```
<input type="button" onclick="doclick()" onmouseout="domouseout()" value="Click"> 
```

请注意，我清楚地标记了我的函数并使用描述性错误消息。*这有助于我通过在代码*和*消息日志信息*中嵌入该详细信息来跟踪正在发生的事情。始终尝试在标签（、、日志信息等）中进行描述`function`，而不是像or`var`之类的东西。一旦你的脚本变得更长、更复杂，就很难理解了。`yay!``what happened`

接下来，我使用以下函数来缩小范围并一致地复制相同的操作：

```
function popup(msg) {
    // Note, console.log is first here. This is so that the
    // alert does not "steal" focus before I get any result.
    console.log(msg);

    // Now, let's try the alert. Notice, the same msg is used.
    alert(msg);
} 
```

`console.log` *这允许我从两个事件处理程序中* `alert`以特定顺序调用两者。接下来，我建立我的两个事件处理函数：

```
function doclick() {
    popup('onclick fired');
}

function domouseout() {
    popup('onmouseout fired');
} 
```

看，他们所做的只是调用`popup()`一个*特定于操作的*日志消息，*说明应该发生的事情*。由于`alert`s 旨在“聚焦”用户并阻止交互，这似乎是“冻结”浏览器框架的可能原因。

我接下来要做的是在不同的浏览器中尝试这个。*始终*尝试在不同的浏览器之间进行复制和测试^#。在这种情况下，我注意到两者之间有很大的不同......

*   **Chrome**：不阻止处理；两者都`alert`开火，并且`onmouseout`-fired直到我点击**and***之后*`alert`才会运行，然后我将鼠标指针从元素上移开。这似乎是我们想要的结果。正确的？`console.log`*`Ok``alert` **`input`***

****   **Firefox (17.0.1)**：Firefox 确实显示了您所描述的行为。请注意，当我单击按钮时，我会同时得到*两者*`doclick` ***并被*** `domouseout()`调用。因此 Firefox 检测到将鼠标指针从按钮上移开，然后您就会得到“冻结”。如果您观看，您会立即看到两者都启动，并且您似乎无法与之交互（通过单击）。*`onclick``console``log``alert``Ok`*

    **   **IE (7-9, 9 Compatibility View)**：IE当然提供了一个有趣的例子。例如，当我单击 IE9 中的按钮时，我看到：

    ![onmouseout 警报在 onclick 警报之上？？？](../Images/24537ba4c007f45ed517f119810ff60c.png)

    [http://i.imgur.com/sWXWm.png](https://i.imgur.com/sWXWm.png)

    当然，这*似乎与 Firefox 具有相同的效果*......但由于 Firefox 的某些原因，`onmouseout`-fired`alert`并不专注于`onclick`-fired 之上`alert`。IE 7-9 plus Compatibility View 都表现出这种特殊的行为，只是略有不同。

    *   **Opera (12.02)** ：直到-fired和 log 消息之后，Opera 才会触发 -fired 或消息，*并且*您移动`onmouseout`鼠标`alert`（***假设***您在单击后将其从 button 元素中移开）。这看起来很奇怪，但比 Firefox 和 IE 的行为更可口。不过，也许我错了。`console.log`*`onclick``alert`*`input`****** 

 *****那么发生了什么？我不太确定，但我认为这`onmouseout`阻止了`onclick`'s`alert`对用户的关注。如果你`[Enter]`在它被冻结的时候打它，你会得到`onclick`警报，但不会`onmouseout`。Chrome 在这里似乎是正确的；Firefox 的“popunder”警报似乎有点可疑。

总之，至少这两个事件在这种情况下的*行为*不仅是 Firefox*特有的。**似乎*特定于 Firefox（至少 17.0.1）的事实是-fired`onmouseout`没有`alert`正确聚焦，并且页面“似乎冻结”。这似乎是一个错误。我想知道有没有被举报？

* * *

> [^(**$使用内联属性事件处理程序（如 ）**)] ^([*通常*])^([不是一个好主意，但让我们忽略这里无关紧要的内容。请参阅 MDN 的[文档](https://developer.mozilla.org/en-US/docs/DOM/event)，特别是[HTML 属性部分](https://developer.mozilla.org/en-US/docs/DOM/event#HTML_attribute)，并意识到这比这里值得介绍的要复杂和详细。*`<input onclick="doclick()"...>`[`DOM Event`](https://developer.mozilla.org/en-US/docs/DOM/event)*])
> 
>  *[^(**#**)] ^([如果你继续在浏览器中使用 Javascript，你会发现 IE 是……特别的。它在历史上占有特殊的地位，因此在使用 IE 版本检查代码时，奇怪或“异常”的行为并不少见。就个人而言，我建议在 Firefox 或 Chrome 中学习和工作，然后在 IE 和其他浏览器中检查它是否有效。])*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T03:50:34.017

Javascript：

```
var clicked = false;
function popup() 
{
    alert("Hello World")
}

function pop2(ev) 
{
    alert("Good job");
    clicked=true;
}

function pop3() 
{
    if(clicked == false)
    {
        alert("CLICK ME!");
    }
    clicked=false;
} 
```

HTML：

```
<input type="button" onclick="popup()" value="Hello World">
<input type="button" onclick="return pop2(event)" onmouseout="pop3()" value="click me"> 
```

​<a href="http://jsfiddle.net/bLuuQ/5/" rel="nofollow">演示链接

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-05-04T08:34:33.953

由于在单击事件期间聚焦不佳，单击和 mouseout/mouseleave 事件在 FireFox 上紧随其后发生，我们可以为将在 mouseout/mouseleave 事件期间处理的代码添加一种延迟。以下对我有用：

```
//Bind the element with classname to a function on click event
$(".rej").bind("click", showData);
//Bind the same element with classname to another function on mouseout event.
$(".rej").bind("mouseout", hideData); 
```

然后你可以继续使用你的 showData 函数。但是在 hideData 函数中，您需要在处理该函数中的代码之前添加几秒钟的延迟，如下所示：

```
function showData() { 
//Do something
}

function hideData() {
var delay = 1000;
setTimeout(function(){
//Do something
}, delay);
} 
```

你可以走了。mouseout 事件不再压倒 Firefox 中的 click 事件。:) :)*******

# visual-studio-2010 - 升级到 MVC4 Targeting 4.0 和 VS2010，但 MS Build 仍在寻找 v11.0

> ID：14048968
> 
> 赞同：3
> 
> 时间：2012-12-27T03:19:23.223
> 
> 标签：visual-studio-2010, asp.net-mvc-4

我们已经将我们的 MVC3 项目升级到在 VS2010 中运行的 MVC4，仍然针对 4.0 框架（还没有为 4.5 做好准备）。这一切在开发中都可以正常工作，但是在构建服务器上构建失败（遗憾的是使用 Jenkins/Hudson），并显示以下消息：

错误 MSB4019：找不到导入的项目“C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\WebApplications\Microsoft.WebApplication.targets”。确认声明中的路径正确，并且该文件存在于磁盘上。

我在项目文件中查找了与此匹配的语句，但没有。csproj 中的第二行（如下）明确针对 v10.0：

```
<Import Project="$(VSToolsPath)\WebApplications\Microsoft.WebApplication.targets" Condition="'$(VSToolsPath)' != ''" />
  <Import Project="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v10.0\WebApplications\Microsoft.WebApplication.targets" Condition="false" /> 
```

我想第一个可能会以某种方式解析为 v11.0，但我不确定它来自哪里。该解决方案已在 VS 2012 中至少打开一次，所以我假设它在某处插入了一些东西，但不确定是什么。

在我的开发环境中，我重命名了 VS 2012 路径，并且仍然可以在 VS 2010 中加载和构建我的项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T17:52:08.737

找到它 - 答案或多或少在这里：http: [//blogs.msdn.com/b/webdev/archive/2012/08/22/visual-studio-project-compatability-and-visualstudioversion.aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/22/visual-studio-project-compatability-and-visualstudioversion.aspx)

基本上，如果您在 VS2012 中打开 MVC4 项目，它会更改项目文件以动态检测 VS 版本，如果未找到该值，则默认为 v10.0。

我不能 100% 确定 v11.0 来自构建服务器的何处。恢复 .sln 文件似乎没有什么不同。但是，在将特定更改还原到 .csproj 文件后，它会成功构建。

具体来说，我评论了添加的行，如下所示：

```
<!--
      <PropertyGroup>
        <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
        <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
      </PropertyGroup>
-->
      <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
<!--
      <Import Project="$(VSToolsPath)\WebApplications\Microsoft.WebApplication.targets" Condition="'$(VSToolsPath)' != ''" />
-->
      <Import Project="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v10.0\WebApplications\Microsoft.WebApplication.targets" /> 
```

# joomla2.5 - 如何在 Joomla 2.5 中从 URL 中删除 ID

> ID：14048974
> 
> 赞同：2
> 
> 时间：2012-12-27T03:20:48.243
> 
> 标签：joomla2.5

我正在尝试从 Joomla2.5.8 中的 url 中删除 id。
所以我尝试设置对以下 URL 的引用。

[http://developernote.com/2012/05/how-to-remove-id-from-url-in-joomla-2-5/](http://developernote.com/2012/05/how-to-remove-id-from-url-in-joomla-2-5/)

我成功删除了 id 如下所示。

joomla/index.php/aaaa/bbbb.html ≫ joomla/index.php/aaaa/bbbb/105-cccc.html

但只显示一个“空白页”。
我不知道出了什么问题。

你能给我一些建议吗？

-程序开发环境-
・joomla!2.5.8

・SEO 设置 Search Engine Friendly URL Yes
使用 URL rewriting No
给 URL 添加后缀 Yes（add .html)
UNICODE Aliases No

・htaccess
无设置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T14:58:22.710

问题是您尝试链接的文章很可能没有与之关联的相应菜单项。问题来自 itemID 继承。当您没有文章的特定菜单项时，它会从其父类别继承 itemID。通过注释掉 router.php 中的行，您可以阻止这种情况的发生，因此文章将没有 itemID 并导致 404 错误。您需要直接为该项目创建一个菜单项（这将消除 itemID 开头），或者您需要为父类别创建一个菜单项。在任何一种情况下，您都可以将其放入任何模块中都不显示的新菜单中。

# node.js - 将 Mongoose 文档中的 JSON 数据返回到客户端 Javascript

> ID：14048983
> 
> 赞同：3
> 
> 时间：2012-12-27T03:22:30.190
> 
> 标签：node.js, angularjs, mongoose

我正在尝试在猫鼬文档中返回 JSON 数据，然后使用 Angular 显示它。使用此代码时页面上没有错误。Angular IndexCtrl 中的 $http.get 方法从未成功，这让我相信问题在于我如何实现 API get 方法。任何帮助重写该方法以正确返回非常感谢！

澄清一下：我想要的是能够像 JSON 对象一样访问文档，这样我就可以向客户端显示数据。

**更新：它确实产生了错误：**

```
GET http://localhost:3000/api/tracks 
```

**该错误需要一段时间才能在控制台中显示**

**api方法**

```
app.get("/api/tracks", function(req, res) {
return Track.find({}, function (err, tracks) {
  if (err) {
    res.send(500);
    return;
  }
   return res.json({
  tracks: tracks
    });
  });
}); 
```

**猫鼬数据库**

```
var mongoose = require('mongoose');

var uristring = 
  process.env.MONGOLAB_URI || 
  'mongodb://localhost/HelloMongoose';

var mongoOptions = { db: { safe: true }};

var db = mongoose.createConnection(uristring, mongoOptions, function (err, res) {
      if (err) { 
        console.log ('ERROR connecting to: ' + uristring + '. ' + err);
      } else {
        console.log ('Succeeded connected to: ' + uristring);
      }
  });

//a Schema for a track
var Schema = new mongoose.Schema({
  name: String,
  location: String,
  description: String
});

var Track = mongoose.model('Track', Schema);

var spot = new Track({name: 'zildjian'});
spot.save(function (err) {
  console.log('saved');
  if (err) // ...
  console.log('meow');
}); 
```

**角控制器**

```
function IndexCtrl($scope, $http) {
  $http.get('/api/tracks').
    success(function(data, status, headers, config) {
      $scope.tracks = data.tracks;
      console.log($scope.tracks + "scope tracks data");  //This does not log! it never makes it this far
    });

} 
```

**显示 $scope.tracks 的 Jade 模板**

```
p There are {{tracks.length}} posts

div(ng-repeat='track in tracks')
  h3 {{track.name}}
  div {{track.description}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T08:06:57.063

我没有正确地从模型中提取条目。这是我修复它的方法：

```
app.get("/api/tracks", function (req, res) {
var track = [];

var Track = mongoose.model('Track', trackSchema);
  Track.find({}, function (err, records) {
    records.forEach(function (post, i) {
      track.push({
        id: i,
        title: post.title,
        text: post.text.substr(0, 50) + '...'
      });
    });
    res.json({
      track: track
    });
  });
};
} 
```

# php - PHP session_start(); 已经开始挂服务器

> ID：14048984
> 
> 赞同：1
> 
> 时间：2012-12-27T03:22:36.290
> 
> 标签：php, session, ubuntu-11.04

我有一个带有 Web 服务器和应用程序服务器的 DMZ，它们都在 gnome 下运行 Ubuntu（Web 服务器上的 v11.04 和应用程序服务器上的 v11.10）。 `session_start()`已开始挂在应用服务器上。该代码位于应用程序服务器上，当我访问我的网站并访问带有`session_start()`调用的页面时，它不会挂起。似乎每个`session_start()`都开始挂在应用程序服务器上，尽管当我从其他计算机或通过网络访问相关页面时，我对相关页面没有任何问题。此外，我刚刚开始在应用程序服务器上遇到此问题，而没有对我的 php 代码进行任何更改。可能是某些缓冲区已填满并需要清除吗？

我尝试编辑`/etc/php5/apache2/php.ini`和设置

```
session.save_path = "/tmp" 
```

`/tmp`存在。

但我仍然有问题。我可以通过前面`session_start()`的 with来停止它挂起，`session_end()`但它不会执行文件中剩余的 PHP 或 html 代码。

`/var/log/apache2/error.log`包括以下消息：

```
PHP Notice:  A session had already been started - ignoring session_start() in
/var/www/DraculaPgm.php on line 101, referer: 
http://MyWebSite.com/ApplicationServer/Dracula.php 
```

彼得，对此的任何帮助将不胜感激。

2012 年 12 月 29 日更新

感谢所有回答这个问题的人。不幸的是，我尝试了所有建议，但“session_start()”仍然挂起。但是，如果我将其放置几分钟，它会中断并显示以下错误消息。

```
Proxy Error

The proxy server received an invalid response from an upstream server.
The proxy server could not handle the request GET /ApplicationServer/Dracula.php.

Reason: Error reading from remote server

Apache/2.2.17 (Ubuntu) Server at MyWebSite.com Port 80 
```

我在网络服务器上安装了 squid。这会是个问题吗？

谢谢，
彼得

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T03:41:26.040

这听起来像一个配置问题。确保 PHP 报告所有错误，即 error_reporting(E_ALL) 并显示或记录所有错误。（您甚至可能想在您的 php.ini 中启用 display_startup_errors）——报告所有错误可能会阐明正在发生的事情。*（如果您需要帮助，您可以发布从中获得的任何错误作为编辑）*您可能还需要查看以下内容以解决会话问题：

*   [**使用 /dev/random 作为会话熵文件时**](http://de3.php.net/manual/en/function.session-start.php#78394)

*   [**当页面在同一个会话中调用自己时**](http://de3.php.net/manual/en/function.session-start.php#69630)

或者，如果这些都没有显示任何内容，您可能想阅读[https://bugs.php.net/bug.php?id=28856&edit=1](https://bugs.php.net/bug.php?id=28856&edit=1)上的错误报告，具体取决于您运行的 PHP 版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T02:00:47.423

我将 'session_start()' 更改为以下块。

```
if(!isset($_SESSION))
{
    session_destroy();
    session_start();
} 
```

我现在没有问题。我不敢说它解决了这个问题，因为它似乎没有立即解决它。

谢谢大家的帮助，
彼得。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T03:39:16.040

```
if(!isset($_SESSION)) 
{ 
    session_start(); 
} 
```

在 PHP 文件的顶部使用它！

并供您参考：`session_destroy()`用于结束会话。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-27T03:51:13.760

尝试通过更改`/tmp`文件夹的权限`chmod 777 /tmp`并检查其是否工作。如果工作，则更改权限模式以使其更安全

尝试检查这个问题[我调用 session_start() 脚本挂起并且没有任何反应](https://stackoverflow.com/questions/2902595/i-call-session-start-the-script-hangs-and-nothing-happens)

而这个[http://www.projectpier.org/node/1934](http://www.projectpier.org/node/1934)

> “似乎会话文件是专门打开的。在某些情况下（Windows）我发现文件锁定由于任何原因都没有正确释放，因此导致 session_start() 在任何未来的脚本执行中无限挂起。我的方式围绕这个问题是使用 session_set_save_handler() 并确保写入函数使用 fopen($file, 'w') 而不是 fopen($file, 'x')"

[如果您通过http://php.net/manual/en/function.session-start.php](http://php.net/manual/en/function.session-start.php)，您可以找到许多其他有相同问题的人及其解决方法

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-15T12:01:49.113

> 首先 - 尝试其他浏览器！

我刚刚遇到了这个 session_start 问题。我检查了我的 tmp 文件夹和所有内容，我正要打电话给我的托管服务提供商，直到我认为我应该先尝试**另一个浏览器**，因为它可能与会话 cookie 有关。

我使用 chrome，所以我在 IE 中进行了测试，发现确实如此：**它在另一个浏览器中工作**！

我关闭了 IE ;) - 回到 chrome，寻找 cookie (PHP_SESS_ID)，删除它，一切都恢复正常了！

好吧，好的部分是 - 就像你们一样，我必须复习我对 -jay- session 的了解！;)

# javascript - 如何在jQuery中以标签开头的单词添加类？

> ID：14048986
> 
> 赞同：2
> 
> 时间：2012-12-27T03:23:00.820
> 
> 标签：javascript, jquery, string

所以假设我在 jQuery 中有一个字符串，看起来像

```
 result.text = "I tweeted something #one #two #three"; 
```

有没有办法用一个名为“tweet-hash”的跨度类来包装所有以标签开头的单词？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T03:27:47.087

您可能希望使用一些正则表达式来查找符号/单词组合，并将其替换并用样式标签和 CSS 类包装。不幸的是，CSS 没有像这样的值的选择器。

```
$("#phrase").html($("#phrase").html().replace(/#([^ ]+)/, "<span class='hashtag'>$1</span>") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T13:23:36.813

值得注意的是，上面的示例只会替换它找到的第一个主题标签。如果将`g`全局添加到正则表达式，它将针对与表达式匹配的所有实例：

```
$("#phrase").html($("#phrase").html().replace(/#([^ ]+)/g, "<span class='hashtag'>$1</span>"); 
```

我在 jsFiddle 上举了一个例子，所以你可以看到不同之处：http: [//jsfiddle.net/c26r9/](http://jsfiddle.net/c26r9/)

# windows-7-x64 - 如何将 httpd.conf 中的 DocumentRoot 设置为 windows 环境变量

> ID：14048987
> 
> 赞同：1
> 
> 时间：2012-12-27T03:23:47.847
> 
> 标签：windows-7-x64, wampserver, httpd.conf, apache2.2

首先，我要感谢社区为我过去在这里找到的所有答案。我想将 http.conf 文件中的 DocumentRoot 行设置为当前 Windows 用户的保管箱文件夹。我以为您可以通过执行类似... DocumentRoot "C:/Users/${USERNAME}/Dropbox/" & 之类的操作来做到这一点，但这不起作用。有没有办法将配置文件设置为 Windows 环境变量？

# android - 检查 ImageView 是否已分配位图的快速方法是什么？

> ID：14048988
> 
> 赞同：4
> 
> 时间：2012-12-27T03:23:50.490
> 
> 标签：android

我需要快速安全地检查 android.widget.ImageView 当前是否附加了一个非零值的位图。什么是快速的方法来做到这一点。

更新我的图像视图最初设置为可绘制设置为“logo.png”，所以如果我知道它当前设置为 logo.png，那么我知道位图尚未设置。那么如何检查背景可绘制对象当前是否为 logo.png

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-27T05:18:05.200

使用 getDrawable() 方法，如果它返回 null 则没有分配

```
if( mImageView.getDrawable() != null){

  //Image Assigned

}else{
  //nothing assigned

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-22T20:51:02.650

Kotlin 扩展解决方案：

添加此项以简化检查并使其更具可读性

```
fun ImageView.hasDrawable() = drawable != null 
```

然后打电话

```
myView.hasDrawable() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-30T17:41:20.800

分配`ImageView`给变量 in `onCreate`：

```
someImage = (ImageView) findViewById(R.id.imageView); 
```

然后是一个简单的 if-else 语句：

```
Bitmap bm = ((BitmapDrawable) someImage.getDrawable()).getBitmap();

                boolean hasDrawable = (bm != null);
                if(hasDrawable) 
                {
                    hasImage();
                }
                else 
                {
                    Toast.makeText(AppSettings.this, "No Bitmap", Toast.LENGTH_SHORT).show();
                } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T04:14:04.730

[获取附加到 ImageView 的位图](https://stackoverflow.com/questions/8306623/get-bitmap-attached-to-imageview)

看一下这个。

看起来你必须从创建一个位图`ImageView`并检查它是否是`null`.

```
imageView.setDrawingCacheEnabled(true);    
imageView.buildDrawingCache(true);
Bitmap bitmap = Bitmap.createBitmap(imageView.getDrawingCache());
imageView.setDrawingCacheEnabled(false); 
```

# performance - 关于 'while + read' .vs 的性能问题。AWK

> ID：14048990
> 
> 赞同：4
> 
> 时间：2012-12-27T03:24:08.677
> 
> 标签：performance, bash, awk, while-loop

我遇到了一个奇怪的问题。我有一个大文件（可能超过 1,000,000,000 行），其中仅包含一个代表文件大小的列。看起来像

```
55568
9700
7243
9692
63
5508
1679
14072
..... 
```

我想计算每个值的出现次数。我使用两个不同的脚本

注意：：下面使用的文件被剪切，仅包含 10,000 行！！！

```
bob@bob-ruby:~$ cat 1.sh
#!/bin/bash

while read size ; do

      set -- $size

     ((count[$1]++))

done < file-size.txt
bob@bob-ruby:~$

bob@bob-ruby:~$ cat 2.sh
#!/bin/bash

awk '{count[$1]++}' file-size.txt
bob@bob-ruby:~$ 
```

我发现 1.sh （纯 shell 脚本）比 2.sh （awk-script）慢得多

```
bob@bob-ruby:~$ time bash 2.sh

real    0m0.045s
user    0m0.012s
sys     0m0.032s
bob@bob-ruby:~$ time bash 1.sh

real    0m0.618s
user    0m0.508s
sys     0m0.112s
bob@bob-ruby:~$ 
```

通过'strace'命令，我发现1.sh产生了很多syscall，而'2.sh'却少得多，这是为什么呢？

那是“awk”在里面做一些“魔术”吗？

```
bob@bob-ruby:~$ strace -c bash 1.sh
% time     seconds  usecs/call     calls    errors syscall
------ ----------- ----------- --------- --------- ----------------
 38.62    0.042011           1     30320           rt_sigprocmask
 29.97    0.032597           2     20212           _llseek
 15.33    0.016674           2     10115           read
 12.57    0.013675           1     10106     10106 ioctl

 (cut)

 bob@bob-ruby:~$ strace -c bash 2.sh
 % time     seconds  usecs/call     calls    errors syscall
 ------ ----------- ----------- --------- --------- ----------------
  95.52    0.008000        4000         2         1 waitpid
   3.20    0.000268          21        13         5 access
   1.28    0.000107           5        21           fstat64
   0.00    0.000000           0         9           read 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-01T10:06:06.223

Chet Ramey 的回答(chet.ramey@case.edu)

2012 年 12 月 21 日晚上 9:59，boblin 写道：

> 嗨，切特：
> 
> ```
> I had meet a strange problem . I have a large file (maybe more than 
> ```
> 
> 10,000 行），其中仅包含表示文件大小的单列。看起来像
> 
> ```
> 55568
> 9700
> 7243
> 9692
> 63
> 5508
> 1679
> 14072
> ..... 
> ```
> 
> 我想计算每个值的出现次数。我使用两种不同的方法
> 
> ```
> bob@bob-ruby:~$ cat 1.sh
> #!/bin/bash
> 
> while read size ; do
> 
>       set -- $size
> 
>      ((count[$1]++))
> 
> done < file-size.txt
> bob@bob-ruby:~$ 
> ```

这确实是一种低效的方法，但不会产生巨大的影响。没有必要仅仅出于美观的原因使用“set”。你可以做

同时读取大小；do ((count[$size]++)) done < file-size.txt

> ```
> bob@bob-ruby:~$ cat 2.sh
> #!/bin/bash
> 
> awk '{count[$1]++}' file-size.txt
> bob@bob-ruby:~$ 
> ```
> 
> 我发现 1.sh （纯 shell 脚本）比 2.sh （awk-script）慢得多
> 
> ```
> bob@bob-ruby:~$ time bash 2.sh
> 
> real    0m0.045s
> user    0m0.012s
> sys     0m0.032s
> bob@bob-ruby:~$ time bash 1.sh
> 
> real    0m0.618s
> user    0m0.508s
> sys     0m0.112s
> bob@bob-ruby:~$ 
> ```
> 
> 通过 strace 命令，我发现 1.sh 产生了很多 syscall，而 '2.sh' 则少得多，这是为什么呢？

因为你没有追踪awk。您跟踪了 bash 调用和等待 awk。这就是为什么 `waitpid' 支配了执行时间。

> 那是 awk 在里面做了什么“魔法”工作吗？

awk 对其操作的限制要少得多，如下所述。

> ```
> bob@bob-ruby:~$ strace -c bash 1.sh
> % time     seconds  usecs/call     calls    errors syscall
> ------ ----------- ----------- --------- --------- ----------------
>  38.62    0.042011           1     30320           rt_sigprocmask
>  29.97    0.032597           2     20212           _llseek
>  15.33    0.016674           2     10115           read
>  12.57    0.013675           1     10106     10106 ioctl 
> ```

bash 经常调用 sigprocmask 存在问题，因为它以 setjmp 保存和恢复信号掩码的方式调用 setjmp。我对信号和陷阱做了一些工作，这些工作将允许下一个版本避免恢复信号掩码。

lseeks 和 reads 必须保留。我想 awk 可以将尽可能多的数据读取到内部缓冲区中并从内存中处理它。shell 需要在每次读取后将文件偏移量重置回它所使用的值，因此它调用的程序可以获得预期的标准输入——它不允许在 read 内置调用之间提前读取。这意味着 shell 必须测试它正在读取的文件描述符，以便每次运行 read 内置函数时都能够进行查找——终端和管道不能在数据流中向后查找，因此 shell 必须读取一个字符从那些时间。shell 的 read 内置函数做了一些最小的缓冲，所以即使对于 shell 可以向后搜索的常规文件，它也必须在 read 内置函数返回一行之前调用 lseek 来调整文件指针。

ioctl 用于判断输入 fd 是否连接到终端；除了无缓冲读取之外，还有几个选项仅在使用终端时可用。每次调用 read 内置函数至少有一个 lseek ，以判断输入 fd 是否是管道。

这说明了您在 strace 输出中列出的系统调用。

## 切特

`The lyf so short, the craft so long to lerne.'' - Chaucer` Ars longa, vita brevis'' - Hippocrates Chet Ramey, ITS, CWRU chet@case.edu [http://cnswww.cns.cwru.edu/~chet/](http://cnswww.cns.cwru.edu/~chet/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-27T03:49:09.660

最大的不同是`while`循环版本需要一次读取一行文件，并`awk`读取*输入* ~~整个文件~~并在内存中解析。你很幸运，它`read`是内置的，否则效率会大大降低。shell 脚本的常见情况是每次`while`循环迭代都会产生多个子进程来处理一行。它们可能会相当慢 - 考虑使用以下方法将一行解析为字段：

```
while
  read line
do
  field1=`echo $line | cut -f 1 -d '|'`
  field2=`echo $line | cut -f 2 -d '|'`
  ...
done 
```

我继承了一个以这种方式处理数据库输出的 shell 脚本。当我用一个简单的`awk`.

**编辑**
我挖掘了[awk 源代码](http://www.cs.princeton.edu/~bwk/btl.mirror/index.html)，因为我对此感到好奇。看起来这是标准 IO 缓冲的简单用法，隐藏在对`getc`. C 标准库在输入流上实现了有效的缓冲。我`dtruss`使用以下非常简单的 shell 脚本运行

```
#!/bin/zsh
while
    read line
do
    echo "$line"
done < blah.c 
```

输入*blah.c*是一个 191349 字节的 C 文件，包含 7219 行。

输出包含 4266次`dtruss`调用，`read`shell 脚本的缓冲区大小为 1 字节。看起来`zsh`根本没有缓冲它的输入。我使用它进行了相同的测试`bash`，它包含完全相同的`read`调用序列。另一个重要的注意事项是`zsh`生成了 6074 个系统调用和`bash`生成了 6604 个系统调用。

等效`awk '{print}' blah.c`命令显示了 56 次调用，`read_nocancel`缓冲区大小为 4096。它总共有 160 次系统调用。

* * *

考虑这一点的最简单方法是，它`awk`是一个以解析文本为生的程序，而 shell 则关注进程管理、管道连接以及通常为用户交互运行的程序。您应该为手头的工作使用适当的工具。如果您正在处理来自大文件的数据，请避开通用的 shell 命令——这不是 shell 的本意，而且它不会非常有效地执行此操作。如果您正在编写背靠背执行 shell 实用程序的脚本，那么您不希望用 perl 或 python 编写它，因为处理子进程的退出状态和它们之间的流水线会很痛苦。

# php - 使用 Google Analytics 跟踪 PHP API 的使用情况

> ID：14048998
> 
> 赞同：6
> 
> 时间：2012-12-27T03:25:29.893
> 
> 标签：php, google-analytics, google-analytics-api

我的网络服务器上有一个 API，可以访问网站数据库中的数据。我试图弄清楚如何使用谷歌分析来跟踪 API 使用情况。访问 API 响应的客户端将无法执行 javascript。

我已经尝试[https://developers.google.com/analytics/devguides/collection/other/mobileWebsites](https://developers.google.com/analytics/devguides/collection/other/mobileWebsites)做服务器端，但由于我的 API 无法打开任何图像，它不会工作。有什么想法吗？

API 示例是[http://www.serviidb.com/api/video](http://www.serviidb.com/api/video)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-10T12:03:17.010

如果您已更新到 Universal Analytics（新的 Google Analytics），您可以直接从 PHP 生成事件或综合浏览量。

Google 创建了[Measurement 协议](https://developers.google.com/analytics/devguides/collection/protocol/v1/)，该协议基本上是一组 http 请求，其中包含一些包含您要跟踪的内容的参数。我将在此处粘贴我在自己的站点中用于跟踪下载的代码。

要跟踪任何内容，您只需使用自己的参数调用 AnalyticsDoHit()：

```
// Create a page view directly from PHP. No javascript.
function AnalyticsDoHit($tid, $slug, $title)
{
// Standard params
$v   = 1;
$cid = ParseOrCreateAnalyticsCookie();

// Send PageView hit
$data = array(
    'v' => $v,
    'tid' => $tid,
    'cid' => $cid,
    't' => 'pageview',
    'dt' => $title,
    'dp' => $slug
);

$getString = 'https://ssl.google-analytics.com/collect';
$getString .= '?payload_data&';
$getString .= http_build_query($data);
file_get_contents($getString); // do the https request
}

// Gets the current Analytics session identifier or create a new one
// if it does not exist
function ParseOrCreateAnalyticsCookie()
{
if (isset($_COOKIE['_ga']))
    {
    // An analytics cookie is found
    list($version, $domainDepth, $cid1, $cid2) = preg_split('[\.]', $_COOKIE["_ga"], 4);
    $contents = array(
        'version' => $version,
        'domainDepth' => $domainDepth,
        'cid' => $cid1 . '.' . $cid2
    );
    $cid      = $contents['cid'];
    }
else
    {
    // no analytics cookie is found. Create a new one
    $cid1 = mt_rand(0, 2147483647);
    $cid2 = mt_rand(0, 2147483647);

    $cid = $cid1 . '.' . $cid2;
    setcookie('_ga', 'GA1.2.' . $cid, time() + 60 * 60 * 24 * 365 * 2, '/');
    }
return $cid;
} 
```

按如下方式使用它：

```
AnalyticsDoHit("UA-XXXXXX-X", "http://www.AutomatedEmailParser.com/EmailAndParser_setup.msi", "EmailAndParser_setup.msi"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T17:07:45.437

查看 Universal Analytics [https://developers.google.com/analytics/devguides/collection/protocol/v1/](https://developers.google.com/analytics/devguides/collection/protocol/v1/) 或[http://code.google.com/p/php-ga/](http://code.google.com/p/php-ga/)以在 PHP 中模拟 ga.js 服务器端

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-11T20:07:05.557

我使用的是[用于 PHP 的 Google Analytics Measurement Protocol 库](https://github.com/theiconic/php-ga-measurement-protocol)，它包含 Laravel、Yii 等许多框架的包装器。

您可以衡量 API 使用情况、电子商务事件或任何您需要的东西。您还可以发送异步请求。