# StackOverflow 问答 16071000-16071999

# selenium-webdriver - 在新窗口中输入登录名和密码

> ID：16071004
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:00:03.460
> 
> 标签：selenium-webdriver

我正在测试创建电影并使用 selenium webdriver 在 facebook 上共享它。facebook登录窗口打开后我被卡住了。你能告诉我如何输入电子邮件和密码以完成我的测试。我是硒新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:15:25.367

首先，你需要上网查一下。其次，在发布这样的问题之前尝试一些技巧。

因此，您需要捕获您的输入字段，例如：

```
WebElement inputName = driver.findElement(By.id("id of the input"));
inputName.sendKeys("freezer123@hotmail.com");

WebElement inputPassword = driver.findElement(By.id("id of the input"));
inputPassword.sendKeys("pass1234");

WebElement btnOk = driver.findElement(By.id("id of the button"));
btnOk.click(); 
```

看看[这里](http://docs.seleniumhq.org/docs/03_webdriver.jsp)

# c++ - 斐波那契数列，二分查找

> ID：16071005
> 
> 赞同：0
> 
> 时间：2013-04-17T22:00:07.457
> 
> 标签：c++, search, binary, numbers, fibonacci

我正在尝试解决以下问题：

F 是整数的无限序列，对于任何整数 i 都满足斐波那契条件 F(i + 2) = F(i + 1) + F(i)。编写一个程序，根据给定的 F(i) 和 F(j) 值计算 F(n) 的值。

输入：输入包含按以下顺序排列的五个整数：i、F(i)、j、F(j)、n。-1000 ≤ i, j, n ≤ 1000, i ≠ j, -2·10^9 ≤ F(k) ≤ 2·10^9 (k = min(i, j, n), ..., max(i, j, n))。

输出：输出由一个整数组成，即 F(n) 的值。

我试图通过找到 F(min(i,j)+1) 然后使用这两个邻居来找到 F(n) 来解决这个问题。有人告诉我这可以通过在区间 (-2*10^9,2*10^9) 上实现二进制搜索来完成，但我不明白如何在这里使用二进制搜索。可以给我一个提示或解释算法简略。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:18:35.403

我能想到的一种方法是这样的：假设 i < j 和 F(i) < F(j) 所以我们想要找到 F(i+1)。我们知道 F(i) < F(i+1) < F(j) 所以我们可以在 [F(i),F(j)] 之间进行二分搜索 - 每次我们猜测 F(i+1) 并检查如果它合适（我认为没有简单的方法），直到你得到正确的值。

复杂性 - 每次迭代可能需要 2000 步（最坏的情况），最坏的情况是 log(4*10^9) 迭代，大约是 32，所以这似乎是合理的。

# java - 试图弄清楚为什么拆分方法没有正确打印出来

> ID：16071012
> 
> 赞同：0
> 
> 时间：2013-04-17T22:00:42.277
> 
> 标签：java

在 split 命令之后打印出来的单词不是按升序打印出来的。我认为我没有将它放置在代码的正确位置，但我不确定到底要放置它。它根据需要逐字打印整个文本段落，没有任何标点符号，但不会按升序（字母）顺序打印。任何帮助都会很棒。

```
public static void main(String[] args) throws 
        FileNotFoundException, IOException 
{
    Scanner ci = new Scanner(System.in);
    System.out.print("Please enter a text file to open: ");
    String filename = ci.next();
    System.out.println("");

    File file = new File(filename);
    BufferedReader br = new BufferedReader(new FileReader(file));

    StringBuilder sb = new StringBuilder();
    String str;

    while((str = br.readLine())!= null)
    {
        String sp[] = str.split("[\\s\\.,;:\\?!]+");
        for (String sr : sp )
        {
            System.out.println(sr);
        }            

        sb.append(str);
        sb.append(" ");
        // System.out.println(str);            
    }

    ArrayList<String> text = new ArrayList<>();
    StringTokenizer st = new StringTokenizer(sb.toString().toLowerCase());
    while(st.hasMoreTokens()) 
    {
        String s = st.nextToken();
        text.add(s);
    }

    System.out.println("\n" + "Words Printed out in Ascending "
                            + "(alphabetical) order: " + "\n");

    List<String> arrayList = new ArrayList<>(text);
    Collections.sort(arrayList);
    for (Object ob : arrayList)
    {
        System.out.println("\t" + ob.toString());
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:16:24.547

您要打印两次单词，一次是在标点符号上拆分文本之后，然后是在将其粘在一起后再次打印，再次拆分并最终对其进行排序。

但是，在行阅读中`while`，您正在拆分每一行，但是您随后忽略了该拆分的结果（除了打印它），并且您继续将原始行添加到`sb`.

您可能想`sb`变成一个`ArrayList`，然后将每个单词（`sr`从循环`sp`中）添加到并对其进行排序。`for(sr : sp)``sb`

然后，您可以删除整个部分`StringTokenizer`并立即对其进行排序`ArrayList`。像这样：

```
ArrayList<String> sb = new ArrayList<String>();
String str;

while((str = br.readLine())!= null)
{
    String sp[] = str.split("[^\\w]+");
    for (String sr : sp )
    {
        sb.add(sr);
        // System.out.println(sr);
    }          
}
sb = Collections.sort(sb); 
```

# c# - 在一段时间内使用 DateTime，例如 45:00

> ID：16071020
> 
> 赞同：2
> 
> 时间：2013-04-17T22:01:13.323
> 
> 标签：c#

我只想知道是否可以将 DateTime 类型用于 45:00（45 分钟）或 120:00（120 分钟）等持续时间。这些值也需要存储到本地 Sql Server 数据库中。如果可能的话，任何人都可以暗示如何使用日期时间来完成，或者如果不是让我知道一种可以使用不同类型完成的方法。

提前谢谢你，杰米

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T22:03:35.800

您应该使用[TimeSpan](http://msdn.microsoft.com/en-us/library/system.timespan.aspx)结构

```
TimeSpan interval = new TimeSpan(0, 45, 0);
Console.WriteLine(interval.ToString()); 
```

对于数据库存储部分，您可以存储属性[Ticks](http://msdn.microsoft.com/en-us/library/system.timespan.ticks.aspx)，因为 TimeSpan 结构的特定构造函数允许实例​​化一个传递 Ticks 值的新 TimeSpan

```
long ticks = GetTimeSpanValueFromDb();
TimeSpan interval = new TimeSpan(ticks); 
```

我还想补充一点，您需要一个`BIGINT T-SQL`数据类型字段来存储`long NET`数据类型

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:03:48.987

我将持续时间以秒为单位存储在数据库中，然后在显示数据时转换为 HH:MM:SS 格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:04:03.643

你为什么不`TimeSpan`改用？您可以将它们转换为`Ticks`(int)，将它们存储在数据库中，并在需要该值时反转过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T23:28:24.637

这只是一个解释问题。SQL Server 将日期时间存储为两个四字节整数。一个是从参考日期算起的有符号整数天数，另一个是无符号时间，因此 32 位精确映射 24 小时。如果没有隐式纪元，这不是日期时间，而是持续时间。没有什么能阻止你以这种方式解释它。

当然，选择一个单位并简单地使用浮点数会更方便。这就是 Windows 所做的，将日期时间存储为从参考日期算起的天数，以 8 字节浮点数（双精度）表示。

就我个人而言，我不喜欢将“天”作为时间单位。我们这个星球的自转周期*不是*恒定的，为了维持每天有86400秒的假象，就必须搞乱闰秒。更好的选择是 SI 单位，第二个单位是根据可重复的、不变的物理常数定义的。

更好的是皮秒，因为我们可以转储双精度并使用 int64，具有所有伴随的算术和比较性能优势。以混合人体尺度单位 (yyyy mmm d HH:mm:ss) 进行描述已经是一种试验。当前使用小数天的映射函数可以轻松地缩放到微秒，尽管必须重写闰秒和闰日的补偿。

我说皮秒是因为这是适合 64 位同时包含有用的时间跨度（50,000 年）的最佳划分。Femto 适合，但 50 年还不够宽。我知道最终会出现 5 万年的问题，但坦率地说，我怀疑除了考古学家之外的任何人都会关心 5 万年前的记录。

# javascript - slickgrid - 如何遍历画布外的行？

> ID：16071025
> 
> 赞同：0
> 
> 时间：2013-04-17T22:01:50.607
> 
> 标签：javascript, slickgrid

我在地图上有一些标记，在 slickgrid 中有相同数量的行？

我想要的是当单击标记时，标记的 id 与所有行匹配，并且应该选择相应的行。

这是我的代码：

```
var $canvas = $(grid.getCanvasNode());
var $allRows = $canvas.find('.slick-row');

    $($allRows).each(function() {
        if ($(this).rowID == selectedMarker) {
            $(this).addClass("active-row"); 
            grid.scrollRowIntoView($(this).index());
        }
    }); 
```

仅当网格中存在我想要的行但网格 DOM 一次仅包含 8 行（网格有 30 行）时，它才能正常工作。

如何遍历所有数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:20:21.583

您根本不应该修改 SlickGrid 的 DOM。SlickGrid 将覆盖任何更改，因为它仅呈现视图中的行（带有一些缓冲区）。当您滚动经过该缓冲区时，您对 DOM 所做的任何更改都会丢失。

您必须更改行的数据并允许 SlickGrid 在渲染时将适当的类添加到 DOM。

**编辑**：

SlickGrid 设置：

```
dataView.getItemMetadata = metadata(dataView.getItemMetadata);

function metadata(metadataProvider) {
  return function(row) {
    var item = this.getItem(row),
        ret = metadataProvider(row);

    if (item && item.isActive) {
      ret = ret || {};
      ret.cssClasses = (ret.cssClasses || '') + ' active-row';
    }

    return ret;
  };
} 
```

然后，当您单击标记时：

```
var item = dataView.getItemById(selectedMarker);
var row  = dataView.getRowById(selectedMarker);
item.isActive = true;
dataView.updateItem(item.id, item);
grid.scrollRowIntoView(row); 
```

# neo4j - Neo4j 服务器无缘无故关闭？

> ID：16071032
> 
> 赞同：0
> 
> 时间：2013-04-17T22:02:09.363
> 
> 标签：neo4j

我有一个小型数据库，一天前还可以正常工作，但是现在，当我尝试启动它时，控制台声称它已成功打开，但 Web 服务器挂起。

```
lsof -i | grep 7474 
```

表示 neo4j 正在侦听端口，并且我被告知的“close_wait”-ing 意味着服务器端将其关闭。

我得到的唯一新错误是缺少 logback.groovy 以及 logback-test.xml，这很奇怪，因为我在 neo4j 配置文件中将日志记录设置为 false。

知道会发生什么吗？还有其他人遇到这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:09:26.683

检查`messages.log`有关关机原因的更多详细信息。

# ios - UITableView dataSource 必须从 tableView:cellForRowAtIndexPath: 返回一个单元格：但我这样做

> ID：16071037
> 
> 赞同：0
> 
> 时间：2013-04-17T22:02:51.187
> 
> 标签：ios, exception, uitableview, assertion

我不明白这一点：我的 cellForRowAtIndexPath: indexPath: 返回一个正确的 UITableViewCell。（我有一个断言，大意是它不是 nil 并且有痕迹来证明它）

但我仍然得到这个零星的例外？

这就是我分配/重用单元格的方式：

```
...
{
  UITableViewCell *cell = [tv dequeueReusableCellWithIdentifier: cellIdentifier];
  if (cell == nil)
  {
      cell = [[[UITableViewCell alloc] initWithStyle: UITableViewCellStyleDefault
                                     reuseIdentifier:  cellIdentifier] autorelease];
      cell.selectionStyle = UITableViewCellSelectionStyleNone;
  }
  assert(cell);
  // (code to populate cell)
  // ...
  assert( cell != nil);
  NSLog(@"returning cell %@ type %@", cell, NSStringFromClass([cell class]));
  // edit: showing actual return value
  return cell;
} 
```

崩溃在日志中如下所示：

```
2013-04-17 16:46:05.323 .. -[SomeEditViewController tableView:cellForRowAtIndexPath:] returning cell <UITableViewCell: 0x20d1a2e0; frame = (0 351; 320 43); hidden = YES; autoresize = W; layer = <CALayer: 0x20d1a410>> type UITableViewCell
2013-04-17 16:46:15.296 ... *** Assertion failure in -[UITableView _configureCellForDisplay:forIndexPath:], /SourceCache/UIKit/UIKit-2380.17/UITableView.m:5471
2013-04-17 16:46:15.301 ... *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:' 
```

我查看了许多其他具有类似问题的条目。我难住了！我做了功课，确保我返回的单元格不为零，但我仍然得到这个断言！

任何人都可以帮助解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T00:12:50.593

事实证明，我确实返回了单元格（就 cellForRowAtIndexPath: 而言）

通过在 dealloc 中将 tableView.datasource 和 tableView.delegate 分配给 nil 解决了这个问题。

当容器视图控制器被释放时，表视图很可能仍在等待释放，并且它无法调用我的 cellForRowAtIndexPath 实现。至少，我能够重现问题（和修复）。

# java - 将字符串转换为双精度时在java中检查错误

> ID：16071040
> 
> 赞同：0
> 
> 时间：2013-04-17T22:02:57.330
> 
> 标签：java, jsp, exception, error-handling

我尝试将字符串数组转换为双精度数组，具体取决于从数据库中选择的气象站 - 有些气象站没有数据，所以整个字符串数组都填充了空值（实际上是 12 个）所以很明显如果一个其中车站被选择我得到一个例外。我真的没有时间写很多代码来解决它，因为我必须很快提交我的工作......有什么解决方案可以捕捉它并向用户显示错误消息，其中包含解释错误的行和行? 谢谢！

这是将字符串数组转换为双精度数组的循环

```
for(int i = 0; i<12; i++)
{   
avMaxTempOptimised[i] = Double.parseDouble(avMaxTempSplit[i]);
avMinTempOptimised[i] = Double.parseDouble(avMinTempSplit[i]);
meanTempOptimised[i] = Double.parseDouble(meanTempSplit[i]);
highestTempOptimised[i] = Double.parseDouble(highestTempSplit[i]);
lowestTempOptimised[i] = Double.parseDouble(lowestTempSplit[i]);
maxWindOptimised[i] = Double.parseDouble(maxWindSplit[i]);
totalRainfallOptimised[i] = Double.parseDouble(totalRainfallSplit[i]);
maxDayRainfallOptimised[i] = Double.parseDouble(maxDayRainfallSplit[i]);
rainDaysOptimised[i] = Double.parseDouble(rainDaysSplit[i]);
totalSunshineOptimised[i] = Double.parseDouble(totalSunshineSplit[i]);
mostSunshineDayOptimised[i] = Double.parseDouble(mostSunshineDaySplit[i]);

avMaxTemp2Optimised[i] = Double.parseDouble(avMaxTemp2Split[i]);
avMinTemp2Optimised[i] = Double.parseDouble(avMinTemp2Split[i]);
meanTemp2Optimised[i] = Double.parseDouble(meanTemp2Split[i]);
highestTemp2Optimised[i] = Double.parseDouble(highestTemp2Split[i]);
lowestTemp2Optimised[i] = Double.parseDouble(lowestTemp2Split[i]);
maxWind2Optimised[i] = Double.parseDouble(maxWind2Split[i]);
totalRainfall2Optimised[i] = Double.parseDouble(totalRainfall2Split[i]);
maxDayRainfall2Optimised[i] = Double.parseDouble(maxDayRainfall2Split[i]);
rainDays2Optimised[i] = Double.parseDouble(rainDays2Split[i]);
totalSunshine2Optimised[i] = Double.parseDouble(totalSunshine2Split[i]);
mostSunshineDay2Optimised[i] = Double.parseDouble(mostSunshineDay2Split[i]);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T00:02:53.560

如果您在 for 循环之外尝试/捕获，您将停止处理循环的其余部分。只要您不介意数组中留下未分配的值，for 循环中的 Try/catch 可能更接近。像这样的东西可能是最好的，将优化数组更改为 Double[] 类型：

```
for(int i = 0; i<12; i++)
{   
avMaxTempOptimised[i] = safeDouble(avMaxTempSplit[i]);
avMinTempOptimised[i] = safeDouble(avMinTempSplit[i]);
meanTempOptimised[i] = safeDouble(meanTempSplit[i]);
highestTempOptimised[i] = safeDouble(highestTempSplit[i]);
lowestTempOptimised[i] = safeDouble(lowestTempSplit[i]);
maxWindOptimised[i] = safeDouble(maxWindSplit[i]);
totalRainfallOptimised[i] = safeDouble(totalRainfallSplit[i]);
maxDayRainfallOptimised[i] = safeDouble(maxDayRainfallSplit[i]);
rainDaysOptimised[i] = safeDouble(rainDaysSplit[i]);
totalSunshineOptimised[i] = safeDouble(totalSunshineSplit[i]);
mostSunshineDayOptimised[i] = safeDouble(mostSunshineDaySplit[i]);

avMaxTemp2Optimised[i] = safeDouble(avMaxTemp2Split[i]);
avMinTemp2Optimised[i] = safeDouble(avMinTemp2Split[i]);
meanTemp2Optimised[i] = safeDouble(meanTemp2Split[i]);
highestTemp2Optimised[i] = safeDouble(highestTemp2Split[i]);
lowestTemp2Optimised[i] = safeDouble(lowestTemp2Split[i]);
maxWind2Optimised[i] = safeDouble(maxWind2Split[i]);
totalRainfall2Optimised[i] = safeDouble(totalRainfall2Split[i]);
maxDayRainfall2Optimised[i] = safeDouble(maxDayRainfall2Split[i]);
rainDays2Optimised[i] = safeDouble(rainDays2Split[i]);
totalSunshine2Optimised[i] = safeDouble(totalSunshine2Split[i]);
mostSunshineDay2Optimised[i] = safeDouble(mostSunshineDay2Split[i]);
}

...

safeDouble( String str){
return str== null ? null : Double.parseDouble(str);
} 
```

在您阅读优化数组的地方添加快速空检查，您就可以了。

# java - java - 碰撞检测不起作用？

> ID：16071048
> 
> 赞同：0
> 
> 时间：2013-04-17T22:03:26.093
> 
> 标签：java, collision

我对java很陌生。我正在努力做到这一点，以便我可以用箭头键控制一个球，然后如果你与另一个球碰撞，它会在控制台中打印一条线，说“你输了”或类似的东西。

我已经完成了移动，但我在如何让两个球相撞方面有点挣扎。到目前为止，我已经尝试过这个（我想我在球周围放了一个矩形，但我真的不知道！）：

```
public void collision() {
    Rectangle rectP = new Rectangle(player.x, player.y, player.WIDTH, player.HEIGHT);       
    Rectangle rectE = new Rectangle(Enemy.ex, Enemy.ey, Enemy.WIDTH, Enemy.HEIGHT);

    if(rectP.intersects(rectE))
    {

    System.out.println("game over");
    }
} 
```

有人可以帮我解释一下我做错了什么。

附言。请不要只给我代码，我确实想尝试学习！！！。

谢谢。

```
public void actionPerformed(ActionEvent e) {
    repaint();
    x += velx;
    y += vely;
}

public void up() {
    vely = -1.5;
    velx = 0;
}

public void down() {
    vely = 1.5;
    velx = 0;
}

public void left() {
    vely = 0;
    velx = -1.5;
}

public void right() {
    vely = 0;
    velx = 1.5;
}

public void keyPressed(KeyEvent e) {
    int code = e.getKeyCode();
    if (code == KeyEvent.VK_UP) {
        up();
    }
    if (code == KeyEvent.VK_DOWN) {
        down();
    }
    if (code == KeyEvent.VK_LEFT) {
        left();
    }
    if (code == KeyEvent.VK_RIGHT) {
        right();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:25:57.547

如果你有两个球中心的坐标 X 和 Y 并且你知道球的半径 - 这应该是一个简单的任务。

只需计算球中心之间的距离并将其与球半径之和进行比较。

你要求跳过公式，就是这样:)

PS在您的代码中看起来很奇怪的`player`是小写但`Enemy`大写..它是一个类还是一个对象？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T20:24:14.250

好吧，我不认为有什么问题是碰撞检测。我认为错误在于计算机认为对象在其他地方而不是它们实际所在的地方。就像有一次我尝试制作破砖桨时，当程序真的认为桨在对面时，我遇到了碰撞检测问题！你应该做的是你应该把矩形的位置绘制到游戏上。这样，您可以看到计算机认为对象在哪里。也许他们完全不在了？

# java - 从 Java 中的 SOAP 消息中获取值

> ID：16071050
> 
> 赞同：3
> 
> 时间：2013-04-17T22:03:32.113
> 
> 标签：java, parsing, soap

调用 Web 服务后，我收到一个字符串形式的 SOAP 消息。

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <PassOracleXMLDataResponse xmlns="http://tempuri.org/">
            <PassOracleXMLDataResult>
                <gesystem xmlns="">
                    <return_code>0</return_code>
                    <message>PRS User does not exists in GETS</message>
                    <invoiceid>TESTADDTLINFO2</invoiceid>
                    <datetime>Apr 17 2013  4:19PM</datetime>
                </gesystem>
            </PassOracleXMLDataResult>
        </PassOracleXMLDataResponse>
    </soap:Body>
</soap:Envelope> 
```

我需要检索值和元素。当我尝试使用简单的 SAXBuilder 来构建 Document 并遍历它时，在尝试 getChild on "soap: Body" 后出现异常

```
getChild("soap:Body") - returns null. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:25:42.150

假设您使用的是 JDOM：

soap:Body 实际上是两部分：命名空间和元素名称。在检索信息时，您需要使用 Namespace 类来包含该信息。

尝试做类似的事情：

```
envelopeNode.getChild("Body",envelopeNode.getNamespace()); 
```

这将使它查找名称为“Body”的子元素，并且与信封节点具有相同的命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T15:19:26.070

谢谢彼得，它奏效了。只有一件奇怪的事情。当我获得“PassOracleXMLDataResult”的子元素时，它还需要提供命名空间作为第二个参数

```
 Namespace nmspc = Namespace.getNamespace("http://tempuri.org/");    
            Element parseResponse = bodyEm.getChild("PassOracleXMLDataResponse", nmspc);            
            Element passResult = parseResponse.getChild("PassOracleXMLDataResult", nmspc); 
```

# javascript - 使文本在表 格的灰色行上可见？

> ID：16071051
> 
> 赞同：0
> 
> 时间：2013-04-17T22:03:35.370
> 
> 标签：javascript, html, webkit

我们基本上在表格中有单选按钮的这个 html 代码：

```
<div class="graytitle">Wie oft nutzen Sie WhatsApp?</div>
<ul class="pageitem">
    <li class="radiobutton"><span class="name">Sehr oft</span>
    <input name="frage10" type="radio" value="sehr oft" /></li>
    <li class="radiobutton"><span class="name">Mittelmäßig</span>
    <input name="frage10" type="radio" value="mittel" /></li>
    <li class="radiobutton"><span class="name">Ehr selten</span>
    <input name="frage10" type="radio" value="ehr selten" /></li>
</ul> 
```

我们想让行变灰而不使文本不可见，我们搜索了很多，但找不到解决方案。这是我们使用的：

```
for (var i = 0; i < document.UmfrageForm.frage10.length; i++) {
document.UmfrageForm.frage10[i].style.backgroundColor = "gray"; } 
```

它使所有行变灰，包括文本。我们希望文本在将行设为灰色后仍然可见。我们怎么能做到这一点？

灾难截图：

![在此处输入图像描述](https://i.stack.imgur.com/xwPEH.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:44:48.443

根据您的 jsfiddle：您的样式表将您的跨度标签定位在您的输入标签后面，这就是为什么您在删除输入透明度后看不到跨度的原因。

您需要做的是将背景颜色应用于跨度标签，而不是输入标签。

[更新] 正如评论中提到的@alicelieutier，如果您只需要支持最近的浏览器，您还可以选择对输入应用半透明背景：

```
for (var i = 0; i < document.UmfrageForm.frage10.length; i++) {
  document.UmfrageForm.frage10[i].style.backgroundColor = "rgba(0,0,0,0.7)";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:07:52.973

不知道这是否可能，但您可以`id`为每个`li`或`span`元素添加属性。

假设您提供以下 id：`frage10_opt1`, `frage10_opt2`, `frage10_opt3`. 然后，您可以使用以下代码更改文本颜色：

```
for (var i = 0; i < document.UmfrageForm.frage10.length; i++) {
    document.UmfrageForm.frage10[i].style.backgroundColor = "gray";
    document.getElementById("frage10_opt" + (i + 1)).style.color = "black";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:28:14.897

我有点困惑。您想在某个事件触发时将行“灰显”还是希望它们始终“灰显”？

我认为 Michal 代码的问题在于您正在为表单的单选元素运行循环，并且您的文本位于元素之前的 span 标签中。您可以尝试获取 radio 元素的父元素（li 元素）并设置样式颜色：

```
for (var i = 0; i < document.UmfrageForm.frage10.length; i++) {
    var radioElm = document.UmfrageForm.frage10[i].parentNode;
    radioElm.style.backgroundColor = "gray";
    radioElm.style.color = "black";
} 
```

如果您总是希望单选按钮具有某种颜色，我建议修改“单选按钮”和“名称”的 CSS 类

# android - 我可以在 onPreviewFrame 回调中使用 lockCanvas() 吗？

> ID：16071053
> 
> 赞同：4
> 
> 时间：2013-04-17T22:03:42.433
> 
> 标签：android, camera, surfaceview, augmented-reality

在 onPreviewFrame 中使用 lockCanvas() 时，我正在与 IllegalArgumentException 作斗争。

基本上我想要实现的是抓取框架，处理它，然后直接将它绘制到SurfacePreview的表面。

这是我的 onPreviewFrame 代码

```
@Override
public void onPreviewFrame(byte[] data, Camera camera) {
    Canvas canvas = null;

    if (mHolder == null) {
        return;
    }

    int mImgFormat = mCamera.getParameters().getPreviewFormat();

    try {
        canvas = mHolder.lockCanvas();
        canvas.drawColor(0, android.graphics.PorterDuff.Mode.CLEAR);
        mHolder.unlockCanvasAndPost(canvas);
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
        if (canvas != null)
        {
            mHolder.unlockCanvasAndPost(canvas);
        }
    }
} 
```

我已经阅读了很多关于 android 中相机的文档和主题，我认为锁定绘制框架的表面是不可能的，因为它超出了应用程序控制的范围。这是真的吗？

一种可能的解决方案是在表面视图的顶部绘制另一个视图，但我想保持我处理的帧（会有一些精巧的边缘检测和颜色校正，这可能很耗时）与预览同步绘制。当相机继续以良好的 fps 吐帧时，我的计算将很难赶上，在最坏的情况下，会绘制一个落后数十帧的叠加层。

我研究了 openCV 源代码，对我来说，他们似乎已经在 CameraBridgeViewBase.java 中做到了这一点：

```
protected void deliverAndDrawFrame(CvCameraViewFrame frame) {
    Mat modified;

    if (mListener != null) {
        modified = mListener.onCameraFrame(frame);
    } else {
        modified = frame.rgba();
    }

    boolean bmpValid = true;
    if (modified != null) {
        try {
            Utils.matToBitmap(modified, mCacheBitmap);
        } catch(Exception e) {
            Log.e(TAG, "Mat type: " + modified);
            Log.e(TAG, "Bitmap type: " + mCacheBitmap.getWidth() + "*" + mCacheBitmap.getHeight());
            Log.e(TAG, "Utils.matToBitmap() throws an exception: " + e.getMessage());
            bmpValid = false;
        }
    }

    if (bmpValid && mCacheBitmap != null) {
        Canvas canvas = getHolder().lockCanvas();
        if (canvas != null) {
            canvas.drawColor(0, android.graphics.PorterDuff.Mode.CLEAR);
            canvas.drawBitmap(mCacheBitmap, (canvas.getWidth() - mCacheBitmap.getWidth()) / 2, (canvas.getHeight() - mCacheBitmap.getHeight()) / 2, null);
            if (mFpsMeter != null) {
                mFpsMeter.measure();
                mFpsMeter.draw(canvas, 20, 30);
            }
            getHolder().unlockCanvasAndPost(canvas);
        }
    }
} 
```

我要么错过了一些东西，要么我太老了：）

另外，这是我在这里的第一篇文章，大家好：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T14:26:37.737

实际上，openCV 的摄像头玩了个小把戏。在 CameraBridgeViewBase.java 和 JavaCameraView.java 文件中。我发现 SurfaceTexture 类（来自 api 11）用于接收来自相机的帧。SurfaceTexture 的优点是您不需要总是在屏幕上绘制它（它可以包含在内存中）。然后一个 SurfaceView 类负责从 onPreviewFrame 函数中绘制处理后的帧。请注意，此 SurfaceView 未绑定到相机。希望这能有所帮助。

# paypal - Paypal IPN 广播到多个网站

> ID：16071064
> 
> 赞同：0
> 
> 时间：2013-04-17T22:04:23.070
> 
> 标签：paypal, paypal-ipn

几个月来我一直在努力寻找解决方案，但我无法...

Paypal 只允许我输入一个 IPN 地址，但我需要多个 IPN 地址才能让我的会员网站和其他脚本正常工作。

如何将 Paypal IPN 消息即时广播到多个位置？

请以新手的方式告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:39:36.143

您如何处理贝宝付款？

使用 PayPal Payments Standard，您可以为每个会员网站提供不同的 notify_url，该网站将用作这些交易通知的 IPN 端点。

# php - 通过 CURL 从 API 返回的 xml 表格式

> ID：16071068
> 
> 赞同：0
> 
> 时间：2013-04-17T22:04:34.103
> 
> 标签：php, xml, curl, html-table

我正在使用另一家公司的 API 从他们的数据库中检索信息，它以 XML 格式返回给我。我正在尝试完成两件事-但遇到了几个问题。

**第一**，我想将原始 XML 数据格式化为表格格式，这样更容易通过浏览器查看。

**第二**，我收到的数据是 ID/用户名/密码/电子邮件。我希望能够将该数据导入我的数据库，以便每个用户 ID 都是插入数据库的一行（我可以做数据库工作，我只是不知道如何单独处理每个用户）

API 格式是这样`<API> <message> <user> <id> </id> <login> </login> <password> </password> <message> </message> </API>`的，只有数百个用户而不是一个。

每当我只打印 $array 时，我都会按预期将数据作为一个大块来获取。但是，当我使用更新后的代码时，（如下）我收到一个错误，即用户不是有效索引。我还收到了看起来是我的表格的开头的东西，其中没有任何数据（只有边框）。

如果有人能帮我弄清楚为什么表没有接收数据（或者给我建议更好的方法），我将不胜感激。

任何可以帮助我找出第二名的人都可以加分。

错误是`Notice: Undefined index: user in /home/public_html/new/test.php on line 36` **代码中注释了第 36 行**

这是我的代码的底部：

```
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
// Method execution
$result = curl_exec($ch);
// Close CURL session

$array = json_decode(json_encode((array)simplexml_load_string($result)),1);

$array_user=$array['user']; //line 36

$tab='<table border="1" width="400">';
for ($j=1; $j< count($array_user) ; $j++) {

  $tab.='<tr>';
  $tab.='<td>'.$array_user[$j]['id'].'</td>';
  $tab.='<td>'.$array_user[$j]['login'].'</td>';
  $tab.='<td>'.$array_user[$j]['mail'].'</td>';
 $tab.='<td>'.$array_user[$j]['date'].'</td>';
 $tab.='</tr>';
}

$tab.='</table>';

echo $tab;

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:26:22.760

这就是您使用`simplexml`.
您可以从中构建表或查询。

```
$xml = simplexml_load_string($x); // XML is in $x

foreach ($xml->user as $user) {

    echo $user->id . ': ' . $user->login . ' : '
    echo $user->password . ' : ' . $user->message . '<br />;
} 
```

看到它工作：[http ://codepad.viper-7.com/KhWsla](http://codepad.viper-7.com/KhWsla)

顺便说一句：您的 xml 需要修复：

```
<API>
    <user>
        <id>1</id>
        <login>michi</login>
        <password>12345</password>
        <message>hi!</message>
    </user>
</API> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:03:16.023

```
$sxe = simplexml_load_string('<API><message><user><id>10</id><login>a</login><password>abc</password></user><user><id>11</id><login>456</login><password>def</password></user></message></API>');

// or $sxe = simplexml_load_file($xml_url);

function tabulate(SimpleXMLElement $sxe) {
    if (!count($sxe)) return '';
    $table = "<table border='1' width='400'>\n";
    $header = false;
    foreach($sxe as $row) {
        if (!$header) {
            $table .= "<thead>\n<tr>\n\t";
            foreach ($row as $field) {
                $table .= "<th>";
                $table .= htmlspecialchars($field->getName(), ENT_NOQUOTES, 'UTF-8');
                $table .= "</th>";
            }
            $table .= "\n</tr>\n</thead>\n<tbody>\n";
            $header = true;
        }
        $table .= "<tr>\n\t";
        foreach ($row as $field) {
            $table .= "<td>";
            $table .= htmlspecialchars((string) $field, ENT_NOQUOTES, 'UTF-8');
            $table .= "</td>";
        }
        $table .= "\n</tr>\n";

    }
    $table .= "</tbody>\n</table>";
    return $table;
}

function insert_users(PDO $db, SimpleXMLElement $users) {
    $ins = $db->prepare('INSERT INTO users (id, login, password) VALUES (?,?,?)');
    foreach ($users as $user) {
        $userdata = array((string) $user->id, (string) $user->login, (string) $user->password);
        $ins->execute($userdata);
    }
}

insert_users($db, $sxe->message->user);

echo tabulate($sxe->message->user); 
```

[`SimpleXMLElement`备忘单](https://stackoverflow.com/a/14421571/1002469)

# spring-mvc - 在 Spring Security 中传播 AccessDeniedException

> ID：16071069
> 
> 赞同：4
> 
> 时间：2013-04-17T22:04:35.227
> 
> 标签：spring-mvc, exception-handling, spring-security

在我的 Web 应用程序中，我使用 Spring Security 和 Spring MVC。我已经使用注释保护了几个方法`@Secured`并配置了 Spring Security，当其中一个方法在没有适当角色的情况下被访问时，用户会被带到登录页面。但是，当违规请求来自 Ajax 时，我不希望出现这种行为，因此我实现了自定义带`@ExceptionHandler`注释的方法来确定请求的上下文。

这是我的异常处理程序：

```
@ExceptionHandler(AccessDeniedException.class)
public void handleAccessDeniedException(AccessDeniedException ex, HttpServletRequest request, HttpServletResponse response) throws Exception {

    if (isAjax(request)) {
        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);
    } else {
        throw ex;
    }
} 
```

这样我就可以自己处理异常（例如，记录访问该`@Secured`方法的尝试），然后让 Spring 完成它的工作并通过重新抛出 AccessDeniedException 将用户重定向到登录页面。此外，当请求来自 Ajax 时，我将响应状态设置为`SC_UNAUTHORIZED`并在客户端处理错误。现在，这*似乎*工作正常，但每次我从`handleAccessDeniedException`方法中重新抛出异常时都会收到以下错误：

```
ERROR org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Failed to invoke @ExceptionHandler method: public void app.controller.BaseController.handleAccessDeniedException(org.springframework.security.access.AccessDeniedException,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse) throws java.lang.Exception
org.springframework.security.access.AccessDeniedException: 
    at app.controller.BaseController.handleAccessDeniedException(BaseController.java:23)
    at app.controller.BaseController$$FastClassByCGLIB$$8f052058.invoke(<generated>)
    at net.sf.cglib.proxy.MethodProxy.invoke(MethodProxy.java:191)
    (...) 
```

我没有向 spring xml 配置文件添加任何异常处理细节。

我没有看到应用程序本身有任何问题，但是存在错误，而且由于我对 Spring MVC 和 Spring Security 很陌生，我猜我没有正确执行此操作。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:38:28.077

您的异常处理程序不应该抛出另一个异常。它应该处理它并发送响应。如果您从某个类中收到错误以查看其行为方式，最好检查[代码。](https://github.com/SpringSource/spring-framework/blob/0758e7246578c766bbd76e56aa39ecd1144c13e1/spring-webmvc/src/main/java/org/springframework/web/servlet/mvc/method/annotation/ExceptionHandlerExceptionResolver.java#L324)

对于非 ajax 情况，最好将响应重定向到登录页面，如果这是您想要的。或者，您可以自定义`AuthenticationEntryPoint`Spring Security 使用的，并`AccessDeniedExceptions`从 MVC 处理中省略。该行为本质上与默认行为相同，`LoginUrlAuthenticationEntryPoint`但您可以将其扩展为在检测到 ajax 请求时返回 403。

# php - 如何使用 psql 数据库中的数据创建分层 json？

> ID：16071070
> 
> 赞同：0
> 
> 时间：2013-04-17T22:04:37.153
> 
> 标签：php, json, hierarchical-data, psql

我正在使用 php 连接到我的 psql 数据库，并有一些初始代码来连接到数据库、访问表并将列设置为数组等。但是，我一直在努力将我的数据转换为我想要的格式代码已经在运行。我的输入是 Json 分层数据形式，如下所示。

```
function getData() {
    return {
 "name": "data",
 "children": [
  {
   "name": "America",
   "children": [
    {
     "name": "MA",
     "children": [
      {"name": "Westborough", "order": 30},
      {"name": "Southborough", "order":20}
     ]
    },
    {
     "name": "NH",
     "children": [
      {"name": "Nashua", "order": 12}
     ]
    },
    {
     "name": "CA",
     "children": [
      {"name": "SanFransico", "order": 17}
     ]
    }
   ]
}
]
}; 
```

这是我目前使用 php 的代码：

```
<?php

   // attempt a connection
 $dbh = pg_connect("host=localhost dbname=sample user=postgres");
 if (!$dbh) {
     die("Error in connection: " . pg_last_error());
 }       

 // execute query
 $sql = "SELECT * FROM dataset";
 $result = pg_query($dbh, $sql);
 if (!$result) {
     die("Error in SQL query: " . pg_last_error());
 }       

//Sets the column at 1 to an array
 $arr = pg_fetch_all_columns($result, 1);

 // free memory
 pg_free_result($result);       

 // close connection
 pg_close($dbh);

?> 
```

这是数据库表的格式

![数据库表](https://i.stack.imgur.com/fQPTX.png)

提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T01:21:24.637

我只是为你编码一个圆顶。你需要检查你自己

```
$dbh = pg_connect("host=localhost dbname=sample user=postgres");

$ret = array();
$ret['name'] = 'data';
$ret['children'] = get_chilren($dbh,0);

return  json_encode($ret);

while ($line = pg_fetch_array($result)) {

}

function get_chilren($dbh,$parentid){
  var $cret = array();
  $sql = "select * from database where parentid=".$parentid
  $cresult = pg_query($dbh, $sql);
  if (!$cresult) {
    echo "An error occured.\n";
    exit;
  }
  while($chil = pg_fetch_array($cresult)){ // fetch each row
    $cret['name'] = $chil['name'];
    $cc = get_chilren($dbh,$chil['id']);
    if(is_array($cc)) 
    {//when it hava a child
      $cret['children'] = $cc;
    }else{ //not hava
      $cret['order'] = $chil['order'];
    }
  }
  return $cret;
} 
```

# php - PHP 与第二个 mysql_query 中断

> ID：16071071
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:04:37.917
> 
> 标签：php, mysql, sql

运行一个包含两个查询的程序。当我单独运行任一查询时，它可以工作，但是当两个查询都存在于代码中时，它会中断。

```
$qry = "SELECT * FROM temp_user WHERE email='$email' AND pin='$pin'";
$result = mysql_query($qry);
$num_rows = mysql_num_rows($result);

$qry2 = "SELECT * FROM email WHERE email='$email'";
$result2 = mysql_query($qry2);
$num_rows2 = mysql_num_rows($result2); 
```

我怎样才能解决这个问题？

***编辑：***

对于那些询问我所说的中断是什么意思的人，这里有一张图片。

![在此处输入图像描述](https://i.stack.imgur.com/dBstb.png)

来自日志的错误。

**PHP Parse 错误：语法错误，第 30 行 /Users/philipkirkbride/Documents/apps/Today_test/confirm.php 中的意外“}”**

页面的完整代码是

```
<?php
include 'connect.php';

$pin = $_GET['pin'];
$email = $_GET['email'];

$qry = "SELECT * FROM temp_user WHERE email='$email' AND pin='$pin'";
$result = mysql_query($qry);
$num_rows = mysql_num_rows($result);
if ($num_rows!=0){
    print "create user and delete temp";
    $sql = "INSERT INTO pin VALUES (DEFAULT, '$pin', '$email')";
    $result = mysqli_query($con,$sql);
    if ( false===$result ) {
      printf("error: %s\n", mysqli_error($con));
    } else {
        // Delete user from temp table
        $sql2 = "DELETE FROM temp_user WHERE email='$email' AND pin='$pin'";
        $delete = mysqli_query($con,$sql2);
        // Make query to see if user is new or existing
        $qry2 = "SELECT * FROM email WHERE email='$email'";
        $result2 = mysql_query($qry2);
        $num_rows2 = mysql_num_rows($result2);
        // Need to add a snippet to add a row to the email table, make sure to check user doesn't have an email already in table
        if($num_rows2==0){
            print "email doesn't exist, create new user."
            // $date = new DateTime;
            // $sql = "INSERT INTO email VALUES ('$email', '$date')";
            // $result = mysqli_query($con,$sql);
        }else{
            print "email exists already";
        }
    }
}else{
    print "Account request not found";
}
// End connection
mysqli_close($con);
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:17:53.340

在调用第二个查询之前尝试调用 $result->close() 以释放连接。您的 PHP 脚本尚未完成执行，而您之前的结果是保持该连接处于打开状态。一般来说，明确清理这些类型的资源而不是将其留给运行时是一种很好的做法。

**编辑：**我相信@eis 是正确的，因为这是较旧的（顺便说一下已弃用）mysql_ api，因此正确的调用实际上是 mysql_free_result($result)。

**另一个编辑：** 我将此评论放在@eis 的答案下，但我认为它的类型更大胆，因为@eis 的答案是绝对正确的，不应该被否决：

只是为了详细说明整个缓冲与无缓冲的东西；这个*概念*是**缓冲**查询会将所有结果从数据库读回缓冲区，然后自动释放连接（这将同步发生，以便在缓冲调用返回后立即释放连接以进行另一个调用）。无**缓冲**查询实质上将打开连接并返回对数据库服务器游标的引用，然后您需要从中获取记录。只要还有东西要获取，游标仍然是打开的，你不会使用底层连接做*任何事情*别的。或者您可以调用 mysql_free_result() 并“提前”释放连接（无需先从游标读取所有行）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T22:09:26.920

您实际上应该 1) 读取您检索到的结果或 2) 释放它 (mysql_free_result)...

您有两个不同的查询。如果您不阅读结果或在两者之间关闭它，它可能不会让您运行一个新的。

（如果您实际上不需要实际项目，我看不出进行查询的意义。如果您对实际项目不感兴趣，请使用 SELECT COUNT(*) ，并且只是计数。）

# jquery - 获取 span 的当前值

> ID：16071073
> 
> 赞同：0
> 
> 时间：2013-04-17T22:04:45.620
> 
> 标签：jquery

现在，在选择复选框时，它会添加指定的价格，但在取消选择时不会减去。如何正确检查数量，`$('.amount')`然后进行正确的数学运算？

我在这里做了一个[小提琴](http://jsfiddle.net/XSCZ3/13/)来展示我正在使用的东西。

```
$(':checkbox').change(function(){
    var amount = $('.amount').html();
    sum = Number(amount.replace(/[^0-9\.]+/g,""));
    var names = $(':checked').map(function(){
        sum += (this.value - 0);
        return this.name;
    }).get().join(',');
    $('span.amount').text('$' + sum);
    spans[1].innerHTML = sum;
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:13:38.953

如何跟踪原始金额，然后始终从该金额开始，如下所示：

```
var originalAmount = Number($('.amount').html().replace(/[^0-9\.]+/g,""));

$(':checkbox').change(function(){
    var sum = originalAmount;
    // The rest of the code stays the same. 
```

[**更新了 jsfiddle**](http://jsfiddle.net/john_s/XSCZ3/14/)

编辑：我忘了指出我在“sum”前面添加了“var”，所以它是一个局部变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:19:56.343

我不确定为什么每次都需要遍历所有复选框。
使用您现有的逻辑，您将继续添加已添加的金额。

在您当前的代码中，当单击它添加的第一个复选框时，`99.99`正如预期的那样，但是当单击之后的第二个复选框时，它会添加`199.98`. `99.99`从第一个`99.99`到第二个，导致总数不正确。

我认为您可以通过仅使用当前单击的值来简化此操作。这也将通过不重新评估已处理的复选框来节省冗余，类似于：

```
$(':checkbox').change(function(){
    var sum = $('.amount').html();
    sum = Number(sum.replace(/[^0-9\.]+/g,""));

    if(this.checked){
        sum += Number(this.value);
    } else {
        sum -= Number(this.value);
    }

    $('span.amount').text('$' + sum);
    spans[1].innerHTML = sum;
}); 
```

* * *

[**演示**](http://jsfiddle.net/367A2/)- 每次点击使用单笔金额扣除/添加

* * *

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:21:56.997

它可以很简单，我希望这可以帮助

**吻** `Keep It Simple Silly`

```
$(':checkbox').change(function(){
var amount = $('.amount').html();

amount = amount.substring(1);
var pre = parseFloat(amount); 

if ($(this).is(':checked')) {

   pre += parseFloat($(this).val()); 

} else {
    pre -= parseFloat($(this).val()); 
}
amount = pre; 

$('span.amount').text('$' + amount);
}); 
```

[http://jsfiddle.net/XSCZ3/15/](http://jsfiddle.net/XSCZ3/15/)

我希望这可以帮助

# html - 单击 Windows 位置时未添加到表单操作

> ID：16071081
> 
> 赞同：0
> 
> 时间：2013-04-17T22:05:36.830
> 
> 标签：html, forms, internet-explorer, onclick, action

我正在查看一个可以在除 IE 之外的所有其他浏览器中运行的网站。

像下面这样的链接在 IE 中不起作用是有原因的吗？

**代码：**

```
<form action="<?php echo base_url(); ?>shop/cart/add/<?php echo base64_url_encode(url_req()); ?>/" method="post">
                <div style="height: 150px;"><a href="<?php echo base_url(); ?>shop/product/details/<?php echo $c->getId(); ?>/"><?php if($im = Shop_image::retrieveByPk($c->getCover_image_id())) echo '<img src="',base_url(),$im->getMedium_path(),'" alt="click to read more" style="max-height: 120px; max-width: 120px;" />'; ?></a></div>
                <p style="height: 30px;"><a class="products_name" href="<?php echo base_url(); ?>shop/product/details/<?php echo $c->getId(); ?>/"><?php echo $c->getName(); ?></a></p>
                <p><span class="price"><?php if($s=Shop_special::retrieveByCatalogId($c->getId())): echo '<small><del>$', number_format($c->getPrice_net()*1.15,2),'</del></small> '; ?>$<?php echo number_format($s->getNew_price()*1.15,2); ?><?php else: ?><?php if(count($cheap=Shop_quantity_price::retrieveByCatalogIdCheapest($c->getId()))!=0): ?>From $<?php echo number_format($cheap[0]->getPrice_per_item()*1.15,2); else: ?>$<?php echo number_format($c->getPrice_net()*1.15,2); ?><?php endif; ?><?php endif; ?></span><span class="currency">&nbsp;NZD</span></p>
                <p><a style="text-decoration: none;" href="<?php echo base_url(); ?>shop/product/details/<?php echo $c->getId(); ?>/"><img src="<?php echo base_url(); ?>assets/images/button_more.jpg" > &nbsp;</a>

                    <input type="hidden" name="catalog" value="<?php echo base64_url_encode($c->getId()); ?>" /><input type="image" src="<?php echo base_url(); ?>assets/images/button_buynow.jpg" onclick="location.href='<?php echo base_url(); ?>shop/product/details/<?php echo $c->getId(); ?>/'" value="Buy Now" /></p>
            </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:13:15.000

我不是 JavaScript 专家，所以我不知道您的链接在 IE 中失败的确切原因。但我可以提供一个修复程序，让您的网站在没有 JavaScript 的情况下运行（这也可能解决您的问题）：

```
<a href="http://www.domain.com.au/shop/product/details/31/">
  <img src="http://www.domain.com.au/assets/images/button_buynow.jpg" alt="Buy Now" />
</a> 
```

请注意标准`<a>`链接和其中的图像。这确实有效 - 单击图像会激活链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:17:45.863

因为您的 IE 正在阻止您的文件内容。检查您的 IE 状态栏。您需要单击它以允许您的内容运行。

1个永久解决方案是这个>> [http://www3.bpmmicro.com/web/helpandsupport.nsf/WebKeys/BPM-8NUMQD](http://www3.bpmmicro.com/web/helpandsupport.nsf/WebKeys/BPM-8NUMQD)

问候，

# jquery - 当标题向上滑动时，如何使图像向上滑动？

> ID：16071086
> 
> 赞同：1
> 
> 时间：2013-04-17T22:05:53.410
> 
> 标签：jquery, html, css

我创建了下一个 html 片段： http: [//jsfiddle.net/4gDMK/](http://jsfiddle.net/4gDMK/) 这很好用，但我找不到同时向上移动标题和图像的方法，因此图像不是完全可见了。

这是基本的html：

```
<figure>
    <img src="http://4.bp.blogspot.com/_1vc-O2P4PHQ/S1bI97AgDoI/AAAAAAAACxs/MOo533hzeSw/s200/technical_stockphoto2.jpg" alt="Stockphoto 1" />
    <figcaption>Caption text</figcaption>
</figure> 
```

看看这个网站的例子：[http](http://etchapps.com/) ://etchapps.com/ 在某些块上，您可以单击，然后显示标题并上升图像。这是我需要的，但随后悬停。

有人知道怎么做吗？

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:42:20.307

好的，有很多变化，所以请耐心等待。

CSS 已被精简到此（因为我们将使用 JQuery 完成所有效果）：

```
figure {
    display: block;
    position: relative;
    float: left;
    width:200px;
    height: 200px;
    overflow: hidden;
    margin: 20px;
}
figure img {
    display: block;
    max-width:200px;
}
figcaption {
    position: absolute;
    background: black;
    background: rgba(0, 0, 0, 0.75);
    color: white;
    padding: 10px 20px;
    width:160px;
} 
```

这将导致标题隐藏在图像下方的站点之外，直到我们准备好显示它。

现在对于javascript：

```
//Thanks roXon
$(function(){
    $('figure').on('mouseenter mouseleave', function( e ){
        var toPos = e.type=="mouseenter" ? $('figcaption',this).innerHeight() : 0 ;
        $('img', this).stop().animate({marginTop: -toPos}, 200);
    });
}); 
```

这会导致任何图形在悬停时提高其下方标题的高度，从而显示标题并隐藏图像的顶部。当鼠标离开时，我们将边距设置回默认值 0。

更新小提琴：http: [//jsfiddle.net/NkXCd/1/](http://jsfiddle.net/NkXCd/1/)

使用 CSS3 而不是 JQuery（再次按照 roXon 的建议）

```
figure {
    display: block;
    position: relative;
    float: left;
    width:200px;
    height: 200px;
    overflow: hidden;
    margin: 20px;
}
figure img {
    display:block;
    max-width:200px;
    margin-top:0;
       -webkit-transition: 0.3s;
           transition: 0.3s;  
}
figcaption {
    position: absolute;
    background: black;
    background: rgba(0, 0, 0, 1);
    color: white;
    padding: 10px 20px;
    width:160px;
}

figure:hover img{
    margin-top:-40px;
} 
```

CSS3 小提琴：http: [//jsfiddle.net/NkXCd/2/](http://jsfiddle.net/NkXCd/2/)

# sql - 在 sqlite 中使用单个选择更新一行中的多个列

> ID：16071087
> 
> 赞同：10
> 
> 时间：2013-04-17T22:05:55.120
> 
> 标签：sql, sqlite

在 SQLite 中，我需要更新相关表的行数。

下面的查询可以满足我的要求，但它会多次遍历表格以获取计数：

```
UPDATE overallCounts SET
  total = (count(*) FROM widgets WHERE joinId=1234),
  totalC = (count(*) FROM widgets WHERE joinId=1234 AND source=0),
  totalL = (count(*) FROM widgets WHERE joinId=1234 AND source=2),
  iic = (SELECT CASE WHEN COUNT(*)>0 THEN 1 ELSE 0 END FROM widgets WHERE joinId=1234 AND widgets.source=0),
  il = (SELECT CASE WHEN COUNT(*)>0 THEN 1 ELSE 0 END FROM widgets WHERE joinId=1234 AND widgets.source=2)
WHERE id=1234 
```

此查询可以快速准确地检索到我想要的内容，但我需要将其输出转换为更新语句：

```
SELECT
  count(*) as total,
  sum(case when source=0 then 1 else 0 end) as totalC,
  sum(case when source=2 then 1 else 0 end) as totalL,
  case when source=0 then 1 else 0 end as iic,
  case when source=2 then 1 else 0 end as il
FROM widgets
WHERE joinId=1234 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T02:06:42.763

SQLite 不支持 UPDATE 查询中的 JOIN。这是 SQLIte 设计的限制。但是，您仍然可以在 SQLite 中使用其强大的 INSERT OR REPLACE 语法来执行此操作。这样做的唯一缺点是您将始终在您的overallCounts 中有一个条目（如果您没有条目，它将被插入）。语法将是：

```
INSERT OR REPLACE INTO overallCounts (total, totalC, totalL, iic, il)
SELECT
  count(*) as total,
  sum(case when source=0 then 1 else 0 end) as totalC,
  sum(case when source=2 then 1 else 0 end) as totalL,
  case when source=0 then 1 else 0 end as iic,
  case when source=2 then 1 else 0 end as il
FROM widgets
WHERE joinId=1234
ON CONFLICT REPLACE 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-07-07T07:44:40.757

在给定的语句中，ItemName 和 ItemCategoryName 在单个语句中使用 UPDATE 进行更新。它在我的 SQLite 中工作。

```
UPDATE Item SET ItemName='Tea powder', ItemCategoryName='Food' WHERE ItemId='1'; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-01-23T09:14:47.170

```
UPDATE overallCounts SET (total, totalC, totalL, iic, il) =
  (SELECT
    count(*) as total,
    sum(case when source=0 then 1 else 0 end) as totalC,
    sum(case when source=2 then 1 else 0 end) as totalL,
    case when source=0 then 1 else 0 end as iic,
    case when source=2 then 1 else 0 end as il
  FROM widgets
  WHERE joinId=1234)
WHERE joinId=1234; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-09T00:52:09.530

@cha 为什么不检查是否存在？

```
INSERT OR REPLACE INTO overallCounts (total, totalC, totalL, iic, il)
SELECT
  count(*) as total,
  sum(case when source=0 then 1 else 0 end) as totalC,
  sum(case when source=2 then 1 else 0 end) as totalL,
  case when source=0 then 1 else 0 end as iic,
  case when source=2 then 1 else 0 end as il
FROM widgets
WHERE joinId=1234
AND EXISTS (SELECT joinId FROM overallCounts WHERE joinId=1234)
ON CONFLICT REPLACE 
```

# c++ - 未正确检测输入

> ID：16071094
> 
> 赞同：1
> 
> 时间：2013-04-17T22:06:32.947
> 
> 标签：c++

我今天刚开始使用 C++，并且正在开发一个基于文本的高级计算器。无论如何，我正在研究指数，但是当我启动程序并输入启动指数模式的字符串时，它不会进入指数模式，只会进入常规计算器模式。这是我的代码：

```
//
//  main.cpp
//  C++ Calculator
//  This is just a basic Calculator Application to be run through the command line.
//  v.0.02 - Second version of calculator, basic text, command line interface, loop.
//  Created by Johnny Carveth on 2013-04-17.
//  Copyright (c) 2013 Johnny Carveth. All rights reserved.
//
#include <math.h>
#include <iostream>
int int1, int2, answer;
bool bValue(true);
std::string oper;
std::string cont;
using namespace std;
std::string typeOfMath;
double a;
double b;
int answerExponent;

int main(int argc, const char * argv[])
{

    // Taking user input, the first number of the calculator, the operator, and second number.   Addition, Substraction, Multiplication, Division
    cout<<"______________________________________________\n";
    cout<<"|Welcome to The ExpCalc! Do you want to do   |\n";
    cout<<"|Exponent Math, or Basic Math(+, -, X, %)    |\n";
    cout<<"|Type in 'B' for basic Math, and'E' for      |\n";
    cout<<"|Exponential Math! Enjoy! (C) John L. Carveth|\n";
    cout<<"|____________________________________________|\n";
    cin>> typeOfMath;
    if(typeOfMath == "Basic" || "basic" || "b" || "B")
    {
        cout << "Hello! Please Type in your first integer!\n";
        cin>> int1;
        cout<<"Great! Now Enter your Operation: ex. *, /, +, -...\n";
        cin>> oper;
        cout<<"Now all we need is the last int!\n";
        cin>> int2;

        if (oper == "+") {
            answer = int1 + int2;
        }
        if (oper == "-") {
            answer = int1 - int2;

        }if (oper == "*") {
            answer = int1 * int2;
        }if (oper == "/") {
            answer = int1 / int2;
        }
        cout<<answer << "\n";
        cout<<"Thanks for Using The ExpCalc!\n";

    }else if(typeOfMath == "Exp" || "E" || "e" || "Exponent"){
        cout<<"Enter the desired Base. Example: 2^3, where 2 is the base.\n";
        cin>> a;
        cout<<"Now what is the desired exponent/power of the base? Ex. 2^3 where 3 is the exponent!\n";
        cin>>b;
        answerExponent = double (pow(a,b));
    } else(cout<<"Wrong String!");
} 
```

仅提供有用的提示，请记住这是我使用 C++ 的第一天。另外，如果有任何帮助，我正在使用 XCode 4！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:10:34.950

你可能想看看你的 if 表达式

`if(typeOfMath == "Basic" || "basic" || "b" || "B")`

|| 之间的每一件事 被评估为条件。所以尝试类似：

```
if(typeOfMath == "Basic" || 
   typeOfMath == "basic" ||
   typeOfMath == "b" || 
   typeOfMath =="B") { 
// do basic 
```

进行相同的修改`else if(typeOfMath == "Exp" || "E" || "e" || "Exponent")`

# c++ - CreateProcess 处理

> ID：16071095
> 
> 赞同：1
> 
> 时间：2013-04-17T22:06:46.030
> 
> 标签：c++, windows

我使用 Windows API`CreateProcess`函数。在它的msdn手册中，我发现

> 如果函数成功，请务必在完成处理后调用 CloseHandle 函数来关闭 hProcess 和 hThread 句柄。否则，当子进程退出时，系统无法清理子进程的进程结构，因为父进程仍有打开子进程的句柄。

那么我应该在哪里做呢？

情况是进程开始了，他的生活没有踪迹。它是否迫使我创建一个线程，将在其中创建进程，然后线程将等待使用，例如`WaitForSingleObject`，直到进程死亡，因此可以释放句柄？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:08:23.980

您不必等待子进程完成，您只**需要**在不再需要句柄`CloseHandle`时等待。

 **这样做的原因是，即使在进程完成后，您也可能希望保留进程的句柄。例如，您可能想要检查其返回状态。只要你有一个句柄，Windows 就无法在它之后进行清理。

但是，如果您不再关心孩子做了什么，请关闭把手并继续前进。

如果你真的在乎，打电话`WaitForSingleObject`给它你从那里得到的句柄`CreateProcess`。或者调用`RegisterWaitForSingleObject`（再次将进程句柄传递给它）使用将在进程结束时调用的回调函数。**

# php - xcode ios 将 nsarray 对象拆分为两个单独的对象

> ID：16071099
> 
> 赞同：3
> 
> 时间：2013-04-17T22:07:01.717
> 
> 标签：php, mysql, ios, xcode

嗨，我正在制作 mysql 数据库，用户可以在其中搜索其他用户，搜索时我希望它返回用户“id”和“name”，因为可能有同名的用户，所以我包括 id。这是我的 .php

**编辑**：因为我没有得到我想要的答案，我以为我说得不够清楚，现在我正在考虑以另一种方式尝试。假设**ID**将位于索引 0 中，**NAME** 位于索引 1 中，依此类推。请参阅我的 php 编辑评论。

```
 $result = mysql_query("SELECT `id`,`name` FROM `user` WHERE `name` LIKE '$search%'");

    mysql_close($con);

    $numrows = mysql_num_rows($result);

    if ($numrows!=0){
     while ($row = mysql_fetch_assoc ($result)){

  $id = $row['id'];

  $name = $row['name'];

            echo ("$id,$name///"); 
```

上面是我的第一次尝试，注意：编辑是一个例子，我在想的是让 id 和 name 分开，然后在 Xcode 中将它们再次分成两个不同的数组可以说，所有的 ID 都将通过有点跳跃在 ID 数组中每次“跳过名称”时超过一个索引，并且名称数组中的 NAMES 再次跳过 ids。

```
 // EDIT: echo "%id///";
    // EDIT: echo "%name///";

  }

 }else{
   echo "fail";   
 } 
```

然后在 Xcode

```
 - (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText
   {
   if ([searchUsers.text length] != 0) {

   NSString *FindURL = [NSString stringWithFormat:@"http://localhost/search.php?search=%@",searchUsers.text];
    // to execute php code
    NSData  *URLData = [NSData dataWithContentsOfURL:[NSURL URLWithString:FindURL]];

    // to receive the returend value

    NSString *DataResult = [[NSString alloc] initWithData:URLData encoding:NSUTF8StringEncoding];

    NSArray *FriendsArray = [DataResult componentsSeparatedByString:@"///"];

    userlist = [[NSMutableArray alloc] initWithArray:FriendsArray];
    //[self searchDidSearch];
    [self.tableView reloadData];
   }

   } 
```

结果就像 "1,somename" "2,somename" 等等。我想要的是拆分对象，以便**NAME**将在 tableviewcell 标题中，**ID**在 tableviewcell 子标题中，我想为每一行应用它。

有没有更简单的方法，或者我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:11:53.010

您可以尝试使 PHP 输出看起来更像[NSDictionary](https://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDictionary_Class/) Ex：

```
{      
  {
     "id" = 1;
     "name" = name1;
  },
   {
      "id" = 1;
      "name" = name2;
   },
} 
```

然后您可以像这样访问“名称”的值（通过使用[快速枚举](http://iosdevelopertips.com/objective-c/fast-enumeration-on-the-iphone.html)创建名称数组）：

```
 NSMutableArray *namesArray = [[NSMutableArray alloc]init];
      for(NSDictionary *dict in dataArray) //dataArray NSArray of data from PHP output
      { 
          [result addObject:[dict objectForKey:@"name"]];
      } 
```

然后在 tableViewCell 字幕中显示名称，并使用以下代码（在 cellForRowAtIndexPath 方法中）：

```
cell.textLabel.text = [NSString stringWithFormat:@"%@",[result objectAtIndex:indexpathRow]]; 
```

这不是最好的方法，但我认为将来使用这样的数组会更容易。快乐编码！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:06:09.600

你没有做错任何事，我想你还有一步要走。遍历所有结果并像这样拆分字符串：

```
NSString * tempItem = [FriendsArray objectAtIndex:i]; //where i is each index, possibly in a loop
NSArray * splitObject = [tempItem componentsSeparatedByString:@","]; 
```

现在，splitObject 的第一个对象是 id，第二个对象是名称。你可以把它变成一个循环并得到你需要的东西。有许多不同的方法可以传递这些数据，我将把那个留给你。

# java - 这是 DAO 管理器模式吗？适当的类和接口名称是什么？

> ID：16071103
> 
> 赞同：2
> 
> 时间：2013-04-17T22:07:35.627
> 
> 标签：java, oop, design-patterns

我有一个接口，`SomethingDao`和一个实现类，`SomethingDaoImpl`。该接口仅包含 11 个方法，但每个方法都需要一个或多个复杂的 SQL 查询。

我将实现类分成几个更小的类，我们称它们为`Helper1`, `Helper2`, `Helper3`, ...`HelperN`因为没有更好的名称。有每个的`SomethingDaoImpl`实例，并将方法调用路由到每个。

```
public class SomethingDaoImpl implements SomethingDao {
    private Helper1 helper1;
    private Helper2 helper2;
    private Helper3 helper3;
    // ...
    private Helper8 helper8;

    public List<X> getX(...) {
        return helper1.getX();
    }

    public List<Y> getY(...) {
        return helper2.getY();
    }

    public List<X> getDetailedX(...) {
        List<X> ds = getX(...); 

        helper6.addTo(ds);
        helper7.addTo(ds);
        helper8.addTo(ds);

        return ds;
    }
} 
```

这种技术有名字吗？一个复杂的 DAO 有几个“工蜂”为它做所有的工作，而它只是管理它们？

是不是简单的 DAO 管理器模式，其中 Helper1、Helper2、Helper3 是 DAO 对象？我对正确的命名约定感兴趣，所以在这种情况下，我将重命名`SomethingDaoImpl`为`SomethingDaoManager`，并且`Helper`将变为`HelperDao`.

我还看到在它的位置使用了名称“服务”，在这种情况下，`SomethingDao`接口将被重命名`SomethingService`，并且工蜂类将`DAO`在其名称的末尾带有。

谢谢...我想我只是在寻找与这种情况相关的命名约定和设计模式。我希望实现尽可能清晰，并且具有暗示我正在使用的模式的名称会非常有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:44:02.057

如果你的 DAO 类中只有 11 个方法，你需要这么多帮助类来实现它们，这很奇怪。

问题是，为什么您的 SQL 查询如此复杂？

请务必为您的数据库/数据源中的每个实体/表创建一个不同的 DAO 接口/类。这将帮助您拥有更简单的 DAO 类并减少紧密耦合。

**更新**

正如您在评论中所写，我认为将您`SomethingDao`视为复杂逻辑的外观接口更为正确。（[这篇文章](http://javapapers.com/design-patterns/facade-design-pattern/)说得很清楚）。

因此，您可以为每个实体创建不同的 DAO，并在您的 中使用这些类`SomethingDaoImpl`，实现外观接口。

如果你想遵循某种命名约定，你可以简单地用`SomethingFacade`and重命名你的类`SomethingFacadeImpl`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T07:45:37.067

IMO 该代码是“坏代码”模式，更确切地说是紧耦合代码。8 个帮手很多，这显然是一个设计糟糕的对象。我知道这是 java，可能你没有像 c# 扩展方法这样非常适合帮助者的东西，所以我认为正确的方法是通过 DI 容器使用依赖注入。

每个需要 DAO 或 Service 的对象都会将它们作为抽象依赖项，主要是作为构造函数参数。

```
public class MyObject
{
    public MyObject(ISomeService serv,IRepository repo){}
} 
```

关键是，只使用与上下文相关的对象，代码会将这些对象作为依赖项。我非常怀疑你可能需要 8 个帮手来做任何事情。如果是这种情况，那么该代码确实需要重新设计。

# jquery-mobile - jQuery Mobile changePage in pagebeforeshow 闪烁

> ID：16071106
> 
> 赞同：4
> 
> 时间：2013-04-17T22:07:44.747
> 
> 标签：jquery-mobile

在我的几个 jQuery Mobile 页面中，我需要确保在允许页面显示之前设置了某些变量。因此，我在`pagebeforeshow`事件中检查这些变量，如果它们不存在或不正确，我调用事件`$.mobile.changePage(...)`内部`pagebeforeshow`，然后立即返回。

在 jQuery Mobile 1.2.1 中，这似乎工作得很好。然而，现在我使用的是 jQuery Mobile 1.3.1，我注意到了一个奇怪的渲染问题。现在，当我在事件中调用 changePage 时`pagebeforeshow`，它​​会导致 jQuery Mobile 转换到我请求的页面，然后回到原始页面，触发`pageshow`事件，最后转换回我执行 changePage 的页面。

虽然不是主要问题，但它会带来不便并导致不必要的转换。有没有其他人遇到过这个问题，如果是这样，您是否能够防止不必要的转换和事件触发？谢谢！

示例代码：

```
$('#ConditionalPage').on('pagebeforeshow', function () {
    if (!someScopedVariable) {
        $.mobile.changePage('#RegularPage');
        return;
    }
}

$('#ConditionalPage').on('pageshow', function () {
    ... \\ Code that gets fired even though pagebeforeshow called changePage.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T08:15:23.930

我有同样的问题。当我将页面从一页更改为另一页时，一切正常。但是当我改回来时：

```
$.mobile.changePage("#frontPage"); 
```

页面在两页之间移动了几次。

通过移动我定义的一些功能解决了这个问题：

```
$(document).on('pagebeforeshow', '[data-role=page]', function () {...}) 
```

进入：

```
$(document).on('pageinit', '[data-role=page]', function () {...}) 
```

# facebook - Facebook 分数被“只有我”可见度屏蔽

> ID：16071117
> 
> 赞同：1
> 
> 时间：2013-04-17T22:09:15.083
> 
> 标签：facebook, facebook-graph-api, permissions, privacy, leaderboard

我有一个高分游戏，我使用 fb-score api 生成朋友排行榜。但是有一个问题……要为 fb 用户保存分数，应用程序必须“为用户发布数据”……在这种情况下，就是分数数据。但是用户可以选择将此“发帖”权限标记为对“只有我”可见，而不是对全局或朋友可见。这是很多用户会做的事情，因为这听起来像是有助于他们隐私的事情。

然而，这意味着……的分数让我们说用户 A……永远不会出现在朋友（用户 B）的排行榜中，因为它是应用程序为用户 A 发布的东西，现在无意中不可见他所有的朋友。但是用户 A 并没有真正找到这个错误的方法，而且他的朋友都看不到他的高分，因为他可以毫无问题地看到他的高分。

这让我想到了一个问题：我怎样才能以任何方式解决甚至解决这个问题？有没有办法为用户获取分数数据，即使他将“应用程序帖子”标记为仅对他自己可见？那是访问令牌，用户还是应用程序？或者我可以以某种方式检查用户是否做了这样的事情并提醒他更改权限后的可见性？据我所知，我只能检查是否给予许可，但不能检查其可见性。我真的很想通过设置自己的服务器来处理这些数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-22T15:45:35.277

是的，不幸的是，这似乎是设计的行为。用户 A 已通过其可见性偏好声明他只想与自己共享有关此游戏的信息（例如他的分数），因此其他用户看不到他的分数是有道理的。为了实现您的目标，需要一个额外的数据库。

# python - 获取程序运行的时间（Python）

> ID：16071118
> 
> 赞同：2
> 
> 时间：2013-04-17T22:09:19.180
> 
> 标签：python, string, time, python-imaging-library

我正在编写一个 Python 脚本，我要让它说上次更新：然后是它上次更新的时间，但我不确定如何

这是示例代码

```
from PIL import ImageDraw
import ctypes, time
import urllib
import manipulate
import datetime

font_size = 50
font_color = "red"

font = ImageFont.load_default() 
img = Image.open('bg.bmp')
draw = ImageDraw.Draw(img)

time = datetime.datetime.now()

draw.text((650, 450),'                      CURRENT GRADES' )
draw.text((650, 500), 'Period 1: Geography -----------------------------')
draw.text((650, 550), 'Period 2: Francais-------------------------------')
draw.text((650, 600), 'Period 3: Science--------------------------------')
draw.text((650, 650), 'Period 4: P.E------------------------------------')
draw.text((650, 700), 'Period 5: Algebra 9------------------------------')
draw.text((650, 750), 'Period 6: LA-------------------------------------')
draw.text((650, 800), 'Last Updated:'(time))
draw = ImageDraw.Draw(img)
draw = ImageDraw.Draw(img)
img.save('mod_bg.bmp')

pathToBmp = "C:\Python27\mod_bg.bmp"
SPI_SETDESKWALLPAPER = 20  
ctypes.windll.user32.SystemParametersInfoA(SPI_SETDESKWALLPAPER, 0, pathToBmp ,
                                       0) 
```

最后更新的地方是我需要时间来

当我尝试它时，我得到了这个错误

```
Traceback (most recent call last):
File "C:\Python27\Project.py", line 28, in <module>
draw.text((650, 800), 'Last Updated:'(time))
TypeError: 'str' object is not callable 
```

如果有人可以帮忙，请做！谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T22:10:57.473

采用[`datetime`](http://docs.python.org/2/library/datetime.html)

```
import datetime
now = datetime.datetime.now()
draw.text((650, 800), 'Last Updated: {0}'.format(now)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:36:21.043

问题是`'Last Updated:'(time)`部分。您在字符串后面加上括号，因此将其视为一个函数。你应该这样做`'Last Updated: %s' % time`。

# input - While循环和if语句的麻烦

> ID：16071122
> 
> 赞同：0
> 
> 时间：2013-04-17T22:09:32.560
> 
> 标签：input, while-loop, try-catch

当我在终端窗口中输入帐号时，出现此错误

我输入的数据是正确的，我输入了一个诸如“ste251”之类的字符串，并输入了一个诸如500之类的int。

此外，当我尝试在抛出不匹配异常时停止循环时，我得到：

> ```
> Java.util.inputMismatchException: null (in Java.util.scanner)
> 
> java.util.InputMismatchException
> at java.util.Scanner.throwFor(Scanner.java:909)
> at java.util.Scanner.next(Scanner.java:1530)
> at java.util.Scanner.nextInt(Scanner.java:2160)
> at java.util.Scanner.nextInt(Scanner.java:2119)
> at WriteAccountBalances.writeToFile(WriteAccountBalances.java:58) 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:23:49.277

由于您的整个代码似乎不可用，因此像我这样的第三方进来并重建整个示例会很烦人。相反，由于这是一个微不足道的案例，我将为您提供一个类似的、完整且易于理解的示例，我已经碰巧拥有了。此代码以类似于您需要的方式输入；您应该能够根据您的具体要求对其进行修改。

```
//Filename: "Hotel.java"
import java.util.*;

class Customer
{
    private String name;
    private int room;

    public void setName(String name)
    {
        this.name=name;
    }

    public String getName()
    {
        return this.name;
    }

    public void setRoom(int room)
    {
        this.room=room;
    }

    public int getRoom()
    {
        return this.room;
    }
}

class Hotel
{
    public static void initialize(Customer RoomList[])
    {
        for(int i=0; i<RoomList.length; i++)
        {
            RoomList[i]=new Customer();
            RoomList[i].setName("EMPTY");
            RoomList[i].setRoom(i+1);
        }
    }

    public static void viewList(Customer RoomList[])
    {
        for(int i=0; i<RoomList.length; i++)
        {
            if(RoomList[i].getName()=="EMPTY")
                System.out.println("Room number "+RoomList[i].getRoom()+" is vacant.");
            else
                System.out.println("Room number "+RoomList[i].getRoom()+" is ocupied by "+RoomList[i].getName()+".");
        }
        System.out.println();
    }

    public static boolean addCustomer(Customer RoomList[], String name)
    {
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName().equals("EMPTY"))
            {
                RoomList[i].setName(name);
                return true;
            }
        return false;
    }

    public static void showEmptyRooms(Customer RoomList[])
    {
        System.out.println("Available rooms are:");
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName()=="EMPTY")
                System.out.println(RoomList[i].getRoom());
        System.out.println();
    }

    public static boolean deleteCustomer(Customer RoomList[], String name)
    {
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName().equals(name))
            {
                RoomList[i].setName("EMPTY");
                System.out.println("Deletion successful.\n");
                return true;
            }
        return false;
    }

    public static int getIndex(Customer RoomList[], String name)
    {
        for(int i=0; i<RoomList.length; i++)
            if(RoomList[i].getName().equals(name))
                return i;
        return -1;
    }

    public static void main(String[] args)
    {
        Customer[] RoomList = new Customer[12];
        String name;
        initialize(RoomList);
        Scanner input = new Scanner(System.in);
        int option=0;

        do
        {
            System.out.println("        Hotel Booking Options");
            System.out.println("=====================================");
            System.out.println("1: To View all rooms");
            System.out.println("2: To Add customer to a room");
            System.out.println("3: To Display empty rooms");
            System.out.println("4: To Delete customer from a room");
            System.out.println("5: Find room from customer name");
            System.out.println("0: Exit");

            System.out.print("\nEnter your choice: ");
            option = input.nextInt();
            System.out.println();

            switch(option)
            {
                case 1:
                {
                    viewList(RoomList);
                    break;
                }
                case 2:
                {
                    System.out.print("Customer's name: ");
                    name=input.next();
                    System.out.println();
                    if(!addCustomer(RoomList, name))
                        System.out.println("No rooms available!");
                    break;
                }
                case 3:
                {
                    showEmptyRooms(RoomList);
                    break;
                }
                case 4:
                {
                    System.out.print("Customer's name: ");
                    name=input.next();
                    System.out.println();
                    deleteCustomer(RoomList, name);
                    break;
                }
                case 5:
                {
                    System.out.print("Customer's name: ");
                    name=input.next();
                    System.out.println();
                    System.out.println("Customer's room: "+RoomList[getIndex(RoomList, name)].getRoom()+"\n");
                    break;
                }
                case 0:
                {
                    System.out.println("\nThank you!\n");
                    break;
                }
                default:
                {
                    System.out.println("Invalid option!\n");
                    break;
                }
            }

        }while(option!=0);
    }
} 
```

## 编辑

我试过你的代码；我不确定问题是什么，因为这对我来说似乎工作正常：

```
//Filename: "myPrg.java"
import java.util.*;

class myPrg {
    static Scanner myScanner = new Scanner(System.in);
    static int count = 0;

    public static void writeToFile(String account, int balance) {
        while (!account.equals("X")) {
            System.out.print("Enter account balance: ");
            balance = myScanner.nextInt();
            try {
                System.out.println(account + " " + balance);
            } catch (NullPointerException e) {
                System.out.println("PrintWriter is not assigned");
            }
            count++;
            System.out.print("Enter account number: ");
            account = myScanner.next();
        }
    }

    public static void main(String[] args) {
        System.out.print("Enter account number: ");
        String account = myScanner.next();
        writeToFile(account, 0);
        System.out.println("Code terminated successfully!");
    }
} 
```

这在终端中给了我以下信息：

```
Enter account number: qwerty
Enter account balance: 123
qwerty 123
Enter account number: asdfgh
Enter account balance: 456
asdfgh 456
Enter account number: X
Code terminated successfully! 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:13:39.557

调用这些 nextInt() 或 next() 方法之一时会出现此错误，因为输入值与 next*() 方法的模式不匹配。尝试通过放置断点来调试您的代码，您会很容易发现。

> 它应该继续询问帐号和余额，直到用户输入大写 X

写这样的东西：

```
 while(true){
    //....
    //...
       System.out.print("Enter account number or X for exit: ");
        String option= myScanner.nextLine();
        if("X".equals(option)){
          break;
        }
        //....
       //...
    } 
```

PS：永远不要使用这种`try/catch`：

```
 try {
        output.println(account + " " + balance);
    }
    catch (NullPointerException e)
    {
        System.out.println("PrintWriter is not assigned");
    } 
```

而是使用 if 语句检查它：

```
if(output!=null){
        output.println(account + " " + balance);
    }else{
        System.out.println("PrintWriter is not assigned");
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:14:34.943

来自[InputMismatchException 的文档](http://docs.oracle.com/javase/6/docs/api/java/util/InputMismatchException.html)：

> 由 Scanner 抛出以指示检索到的令牌与预期类型的​​模式不匹配，或者令牌超出预期类型的​​范围。

这几乎说明了所有需要说的。检查意外输入。

# python - ZeroMQ + Django & uwsgi 问题

> ID：16071125
> 
> 赞同：0
> 
> 时间：2013-04-17T22:09:38.330
> 
> 标签：python, django, nginx, zeromq, uwsgi

使用 django，我们需要向另一个单独的 python 程序发送消息。Zeromq 似乎是轻量级的，应该适合这个。

然而，试图让它工作，当将套接字设置为 zmq.PUSH（或其他任何东西）时，它总是以 ZeroMQ: Bad Address 错误结束。这是回溯：

```
Exception Type:     ZMQError
Exception Value:    Bad address
...
...
sock = context.socket(zmq.PUSH)
/usr/local/lib/python2.7/dist-packages/zmq/sugar/context.py in socket
s = self._socket_class(self, socket_type)
self <zmq.sugar.context.Context object at 0x200dc80>
socket_type 8 
```

上下文是在 models.py 中的调用函数中创建的，并且只是：

```
context = zmq.Context()
sock = context.socket(zmq.PUSH)
< ^ crash here>
sock.bind('tcp://127.0.0.1:8921')
... 
```

它是通过

```
exec uwsgi_python \
    --master --pidfile=/tmp/blah.pid \
    --chdir=/path/to/site \
    --module=program.wsgi:application \
    --env DJANGO_SETTINGS_MODULE=program.settings \
    --uid user --gid 1000 \
    --socket=/tmp/uwsgi_program.sock \
    --chmod-socket \
    --vacuum \
    --harakiri=20 \
    --processes=2 \
    --max-requests=5000 \
    --die-on-term 
```

还尝试将 --lazy 添加到启动脚本中，但没有帮助，同样的错误。

wsgi.py 文件有

```
import django.core.handlers.wsgi
from raven.contrib.django.middleware.wsgi import Sentry
application = Sentry(django.core.handlers.wsgi.WSGIHandler()) 
```

当然，在 runserver 或另一台不使用 uWSGI 的服务器上一切正常。

因此，它创建的 zeromq 上下文似乎在某种程度上是无效的。尝试修改 wsgi.py 文件以在那里生成 zeromq 上下文，使用 @postfork 仍然不能解决这个问题，完全相同的错误。但是，我也不喜欢使用@postfork，因为这将需要单独的代码路径，具体取决于我们是否使用 uWSGI 或其他东西，并且如果可能的话，更简洁地执行此操作。

我在俯瞰什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T13:46:52.993

我尝试了所有不同的选项，最后决定 python uwsgi 选项最适合我们的设置。可以在以下[站点找到安装说明](http://www.julianbez.com/blog/2013/07/23/update-uwsgi-to-the-latest-version-on-ubuntu-12-04-lts-precise-pangolin/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T05:28:49.987

您已经尝试了所有正确的方法（@postfork、--lazy-apps、--lazy...），所以除非您使用的是真正过时的 uWSGI 版本，否则我只能假设（正如我在地方）你需要--enable-threads在uWSGI选项中（但这将是第一次看到它）。

出现问题是因为 zmq 上下文创建了一个后台线程，并且该线程在 fork() 之后没有被继承。

如果情况好转，您是否尝试过删除主进程并使用单个进程（因此删除了 fork() 的存在）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T07:58:41.883

我在 Ubuntu 13.10 存储库的 uWSGI 1.9.13 上也遇到了这样的问题。但是本地构建的 1.9.19 工作正常。

# java - 经度和纬度的arraylists在php中传递它们并将它们插入mysql，如何？

> ID：16071126
> 
> 赞同：1
> 
> 时间：2013-04-17T22:09:52.800
> 
> 标签：java, php, android, mysql

我有两个数组列表（经度元素和纬度元素），我想将它们传递给 php 脚本，然后传递给 mysql(wamp)。

```
for (int i = 0; i < Latitude_mysql.size(); i++)
{
    nameValuePairs.add(new BasicNameValuePair("Latitude_mysql",Latitude_mysql.get(i)));
    nameValuePairs.add(new BasicNameValuePair("Longitude_mysql",Longitude_mysql.get(i)));
}//by this way I send them in php script,but I m not sure if it is the appropriate 
```

在php中我正在写这样的东西，但我不知道如何继续：

```
 if ($stmt = $mysqli->prepare("INSERT INTO route(latitude,longitude,trek_id_r)
    values (?, ? , ? )"))
    {
    /* Set our params */

   $lati[] = $_POST['Latitude_mysql[]'];
   $longi[] = $_POST['Longitude_mysql[]']; 
```

接着？？？

我需要分别插入纬度和经度，即：如果值为：

```
Longitude_mysql: 30.24 , 50.24
Latitude_mysql: 23.43 , 24.56
trek_id_r= 2 
```

在表中的mysql中`route`我需要这个结果：

```
Longitude | Latitude | Trek_id_r
30,24     | 23,43    | 2
50,24     | 24,56    | 2 
```

我已经阅读了关于将数组列表转换为 json 或 implode 和多个 mysqli 插入的内容，因此相关的内容将是有用且易于理解的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T05:20:48.763

您需要迭代坐标列表并将每个插入到mysql中。在这种情况下，您将有两个插入

# string - 用第二个文件中的字符串替换一个文件中的字符串

> ID：16071128
> 
> 赞同：1
> 
> 时间：2013-04-17T22:10:03.583
> 
> 标签：string, bash, search, replace

我一直在寻找几天，但我没有得到正确的答案

我有两个看起来像这样的文件：

文件1：

```
>contig-100_23331 length_200 read_count_4043 
TCAG...
>contig-100_23332 length_200 read_count_4508 
TTCA...
>contig-100_23333 length_200 read_count_184 
TTCC... 
```

文件2：

```
>contig-100_23331_Cov:_30.9135
>contig-100_23332_Cov:_125.591
>contig-100_23333_Cov:_5.97537 
```

我想用 File2 中的名称替换 File1 中名称 (>contig...length...) 的行。请注意，File2 仅包含 contig 名称（无序列）。

我想有办法`sed`，但我找不到解决方案

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:26:14.413

一种可能性是使用`sed`创建一个`sed`脚本`File2`，然后使用它`File1`：

```
sed 's/^\(>contig-[0-9]*_[0-9]*\)_.*/s%^\1 %& %/' File2 > sed.script
sed -f sed.script File1 > File.Out
rm -f sed.script 
```

对于 sample `File2`，`sed.script`将包含：

```
s%^>contig-100_23331 %>contig-100_23331_Cov:_30.9135 %
s%^>contig-100_23332 %>contig-100_23332_Cov:_125.591 %
s%^>contig-100_23333 %>contig-100_23333_Cov:_5.97537 % 
```

对于 sample `File1`，`sed`处理的输出将是：

```
>contig-100_23331_Cov:_30.9135 length_200 read_count_4043 
TCAG...
>contig-100_23332_Cov:_125.591 length_200 read_count_4508 
TTCA...
>contig-100_23333_Cov:_5.97537 length_200 read_count_184 
TTCC... 
```

某些版本的脚本中`sed`可能存在 23k 行的问题。`sed`如果这对您来说是个问题，那么您可以生成`sed.script`然后将其 ( [`split`](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/split.html)) 拆分成更小的块（例如，每个 1000 行），然后`sed -f chunk`为每个块运行。这很痛苦，但很有必要。从历史上看，HP-UX（过时的版本，如 HP-UX 9 或 10）的版本相当有限`sed`，只能处理`sed`脚本中的几百个命令。

鉴于您正在使用，您可以使用[进程替换](http://www.gnu.org/software/bash/manual/bash.html#Process-Substitution)`bash`来避免显式中间文件：

```
sed -f <(sed 's/^\(>contig-[0-9]*_[0-9]*\)_.*/s%^\1 %& %/' File2) File1 > File.Out 
```

但是，您应该在使用该符号之前验证脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:19:50.720

免责声明：从来没有这样做过......

您可能想使用 join 命令来合并文件[合并文件](https://stackoverflow.com/questions/6408635/merging-two-files)

您可能必须为 FILE2 生成一个中间文件或流，其中有一个额外的空行，以便两个文件中的两行匹配。

希望这可以帮助。

# ios - CCSpriteBatchNode 在 15k 左右停止添加子节点

> ID：16071130
> 
> 赞同：0
> 
> 时间：2013-04-17T22:10:11.353
> 
> 标签：ios, cocos2d-iphone, ccspritebatchnode

我正在使用 CCSpriteBatchNode 基本上一次画一条线（使用 1x1 样本）。我需要这样做，因为用户正在实时控制线条的位置（它不是绘图应用程序，但我认为我正在做的事情是可比的）。

事实证明，当我向 batchNode 添加 15-16k 个孩子时，它会停止注册新的孩子。基本上，好像笔用完了墨水！

我在 cocos2d 代码中浏览了一下，但似乎没有任何问题。它只是停止注册新的子节点。有人知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:22:43.123

首先，让我以一种非常轻描淡写的方式说：

**哎哟!**

其次，技术原因。一旦批处理了 16.384 个精灵，您的精灵将无法渲染。由于每个精灵使用四边形（4 个顶点）在屏幕上渲染精灵，因此您达到了每个批处理操作 65.536 个顶点的顶点限制。

每个批处理操作不会绘制更多顶点（[VBO 缓冲区限制](http://sarofax.wordpress.com/2011/07/10/vbo-vertex-buffer-object-limitations-on-ios-devices/)）。这是一个技术限制。您可以尝试使用另一个 CCSpriteBatchNode 来获取其他精灵 - 但严重的是，您正在走上一条无路可走的道路。

如果你只需要画线，这可能是我能想象到的最糟糕的方法。考虑使用线条绘制 (ccDrawLine)、单个像素（我相信 ccDrawPixel 也存在，但 15k 像素会非常慢）或着色器来完成相同或相似的效果。您甚至可以使用 CCDrawNode 使用 cocos2d 2.1 批量绘制图元。

我在[YETIPIPI](http://www.yetipipi.de)中成功使用的另一种解决方案是使用有限数量的精灵，比如 20 到 200 个，并将它们绘制到 CCRenderTexture。每次添加新精灵时，都会重新使用最近最少使用的精灵。通过不清除渲染纹理，您可以使用更少的精灵继续在其上绘制，而之前绘制的所有内容都保留下来。通过以低不透明度绘制精灵，您甚至可以获得在同一位置绘制较长时间的效果，以使该区域更加不透明。

# python - 为什么我的方法返回无？

> ID：16071137
> 
> 赞同：0
> 
> 时间：2013-04-17T22:10:53.633
> 
> 标签：python

我有以下方法调用：

```
NCOLS = 3        
NPEGS = 4 

first_guess = []

print("calling first guess method")
first_guess = firstGuess(NCOLS, NPEGS, first_guess)
print("after method call: " + str(first_guess)) 
```

第一种猜测方法：

```
def firstGuess(NCOLS, NPEGS, first_guess):
"""Used for setting up the first guess of the game"""
  print("in firstGuess method")
  for c in range(1, NCOLS + 1):
     if len(first_guess) == NPEGS:
         print("about to return first guess: " + str(first_guess))
         return first_guess
     else:
         first_guess.append(c)

  print("out of for loop, first_guess len is " + str(len(first_guess)) + ", " + str(first_guess))
  if len(first_guess) <= NPEGS: #there were less color options than pegs
     firstGuess(NCOLS, NPEGS, first_guess) 
```

`None`由于我无法弄清楚的原因，这似乎又回来了。

这是我的输出：

```
calling first guess method
in firstGuess method
out of for loop, first_guess len is 3, [1, 2, 3]
in firstGuess method
about to return first guess: [1, 2, 3, 1]
after method call: None
Traceback (most recent call last):
File "mastermind.py", line 323, in <module>
sys.exit(main())
File "mastermind.py", line 318, in main
playOnce()
File "mastermind.py", line 160, in playOnce
first_guess = first_guess + str(g[0][i])
TypeError: 'NoneType' object is not subscriptable 
```

为什么它返回`None`而不是返回`[1, 2, 3, 1]`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:14:33.497

您遇到的问题是您的递归调用不返回其结果。

因此，它打印“out of for loop……”，然后进行递归调用。然后，该递归调用成功地返回了一些东西……但外部调用忽略了这一点并落在了最后，这意味着你得到了`None`.

`return`只需在调用之前添加一个`firstGuess`：

```
print("out of for loop, first_guess len is " + str(len(first_guess)) + ", " + str(first_guess))
if len(first_guess) <= NPEGS: #there were less color options than pegs
   return firstGuess(NCOLS, NPEGS, first_guess) 
```

这仍然会留下一条您不返回任何内容的路径（如果您“退出 for 循环”，然后`len(first_guess) > NPEGS`）......但是您没有任何逻辑可以在那里做任何有用的事情。您可能想要添加某种，`assert`或者`raise`如果您认为这永远不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:12:31.330

这是因为通过您的代码的路径不会以您显式返回任何内容而结束。

你在哪里`firstGuess`递归调用，你应该做什么`return firstGuess(...)`？但是，仍然存在您失败并且不返回任何东西的情况。您应该在最终`return first_guess`声明之后添加最终`if`声明。

尝试这个：

```
def firstGuess(NCOLS, NPEGS, first_guess):
  """Used for setting up the first guess of the game"""
  print("in firstGuess method")
  for c in range(1, NCOLS + 1):
     if len(first_guess) == NPEGS:
         print("about to return first guess: " + str(first_guess))
         return first_guess
     else:
         first_guess.append(c)

  print("out of for loop, first_guess len is " + str(len(first_guess)) + ", " + str(first_guess))
  if len(first_guess) <= NPEGS: #there were less color options than pegs
     return firstGuess(NCOLS, NPEGS, first_guess)
  return first_guess 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:12:56.113

将最后两行更改为

```
if len(first_guess) <= NPEGS: #there were less color options than pegs
    return firstGuess(NCOLS, NPEGS, first_guess)
else:
    # what do you do here?  return something
    return first_guess 
```

您不会在所有分支机构返回

# javascript - 无法在 Parse Cloud Code 中更改用户安装

> ID：16071142
> 
> 赞同：1
> 
> 时间：2013-04-17T22:11:18.180
> 
> 标签：javascript, android, cloud

我正在尝试使用解析云将新通道添加到其他用户的解析安装中。这是解析云代码：

```
 Parse.Cloud.define("subscribeToChannel", function(request, response) {
  var channelName = request.params.channel;
  var ids = request.params.ids;//this is an array of ids to change
  var _ = require("underscore");
  _.each(ids, function(id) {
  // Create a Pointer to this user based on their object id
    var user = new Parse.User();
    user.id = id;
    // Need the Master Key to update Installations
    Parse.Cloud.useMasterKey(); 
    // A user might have more than one Installation
    var query = new Parse.Query(Parse.Installation);
    query.equalTo("User", user); // Match Installations with a pointer to this User
    query.find({
      success: function(installations){
    for (var i = 0; i < installations.length; i++){
      // Add the channel to all the installations for this user
      installations[i].addUnique("channels", channelName);
    }
    // Save all the installations
    Parse.Object.saveAll(installations, {
      success: function(installations) {
      },
      error: function(error) {
        // An error occurred while saving one of the objects.
        console.error(error);
      }
    });
      },
      error: function(error) {
    console.error(error);
      }
    });
  }); 
```

这就是我为每个用户设置第一次安装的方式：

```
ParseInstallation inst = ParseInstallation.getCurrentInstallation();
inst.put("User", ParseUser.getCurrentUser()); 
```

我发送的 id 数组是一个 JSONArray，其中包含一个字符串 id 列表。JSONArray 正确获取和迭代。但无论我尝试了多少次，它似乎都不起作用。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-25T08:36:38.220

我的错误是我没有以正确的方式保存频道。在与 Parse 的开发团队进行了长时间的交谈后，我得以实现。这是代码：

```
Parse.Cloud.define("subscribeToChannel", function(request, response) {
var channelName = request.params.channel; //Channel the user will be subscribed to
var ids = request.params.ids; //Id of the users
var completed = true;
var size = 0;
var pased = 0;
var loops = 0;
var idStrings = "";
var _ = require("underscore");
if (!channelName) {
response.error("Missing parameter: channel");
return;
}
if (!ids) {
response.error("Missing parameter: ids");
return;
}
var query = new Parse.Query(Parse.Installation);
var user = new Parse.User();
var changedObjects = [];
var pointerArray = [];
_.each(ids, function(id){
pointerArray.push({"__type":"Pointer","className":"_User","objectId":id});
});

// Need the Master Key to update Installations
Parse.Cloud.useMasterKey();
query.containedIn("User",pointerArray);
query.find({
success: function(installations){
for (var i = 0; i < installations.length; i++){
// Add the channel to all the installations for this user
installations[i].addUnique("channels", channelName); //Add the channel to the installation
changedObjects.push(installations[i]); //Add the installation to be saved later on!
}

//Saving all the installations
Parse.Object.saveAll(changedObjects, { 
success: function(installations) {
response.success();
},
error: function(error) {
// An error occurred while saving one of the objects.
response.error(error);
}
});
},
error: function(error) {
response.error(error);
}
});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-24T07:32:06.927

我刚刚找到了您的问题，因为我正在尝试使用 CloudCode 进行相同的操作，但至少目前看来是不可能的。Parse 团队表示：“JavaScript SDK 目前不支持修改安装对象。请查看 iOS、Android 或 REST 推送指南”。下面是链接：

[parse.com/docs/push_guide#setup/JavaScript](https://parse.com/docs/push_guide#setup/JavaScript)

除此之外，还有一些 JavaScript SDK 不能做的操作：

1.  JavaScript SDK 目前不支持订阅频道以发送/接收推送通知
2.  JavaScript SDK 目前不支持接收推送

但另一方面，您可以发送推送通知。然后，当我正在开发一个 Android 原生应用程序时，我被迫“混合” ParseClode 和“Android 代码”以完成通知推送功能。

我希望它会帮助你

问候

# php - Magento 修改客户群的客户激活模块

> ID：16071143
> 
> 赞同：0
> 
> 时间：2013-04-17T22:11:40.090
> 
> 标签：php, magento

我正在尝试修改[Netzarbeiter 的客户激活](https://github.com/Vinai/customer-activation/blob/master/app/code/community/Netzarbeiter/CustomerActivation/Model/Observer.php)模块，以便扩展只标记某个客户组以供管理员批准。以下是我一直在修改的代码块。

```
/**
 * Flag new accounts as such
 *
 * @param Varien_Event_Observer $observer
 */
public function customerSaveBefore($observer)
{

    $customer = $observer->getEvent()->getCustomer();
    //$customer_group_id=$customer->getCustomerGroupId();
    $customer_group_id = Mage::getSingleton('customer/session')->getCustomerGroupId(); 

    Mage::log('The customer group id is'. $customer_group_id , null, 'caitlin.log');

    if ($customer_group_id=1)
        Mage::log('I have a General group ID \n',null,'caitlin.log');
    else if ($customer_group_id=5)
        Mage::log('I have a Test group ID \n',null,'caitlin.log');
    else
        Mage::log('I dont understand! \n',null,'caitlin.log');

    $storeId = Mage::helper('customeractivation')->getCustomerStoreId($customer);

    if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED, $storeId))
    {
        return;
    }

    if (!$customer->getId())
    {
        if ($customer_group_id =5){
            $defaultStatus = Mage::getStoreConfig(self::XML_PATH_DEFAULT_STATUS, $storeId);
            $customer->setCustomerActivated($defaultStatus);
            $customer->setCustomerActivationNewAccount(true);
        }
        else{
            $customer->setCustomerActivated('Yes');
            $customer->setCustomerActivationNewAccount(false);
            Mage::log('This block initiated',null,'caitlin.log');
        }
    }
} 
```

到目前为止，客户 ID 已正确记录，但在注册客户组 ID 为“1”的客户时，程序没有进入带有“此块已启动”日志的 else 语句。谁能看到我做错了什么，或者有另一个想法让程序自动标记特定客户组以供批准？

整个模型如下：

```
<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * package    Netzarbeiter_CustomerActivation
 * copyright  Copyright (c) 2012 Vinai Kopp http://netzarbeiter.com/
 * license    http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */

class Netzarbeiter_CustomerActivation_Model_Observer extends Mage_Core_Model_Abstract
{
    const XML_PATH_MODULE_DISABLED = 'customer/customeractivation/disable_ext';

    const XML_PATH_DEFAULT_STATUS = 'customer/customeractivation/activation_status_default';

    const XML_PATH_ALWAYS_NOTIFY_ADMIN = 'customer/customeractivation/always_send_admin_email';

    /**
     * Fired on customer_login event
     * Check if the customer has been activated (via adminhtml)
     * If not, through login error
     *
     * @param Varien_Event_Observer $observer
     */
    public function customerLogin($observer)
    {
        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED))
        {
            return;
        }

        if ($this->_isApiRequest())
        {
            return;
        }

        $customer = $observer->getEvent()->getCustomer();
        $session = Mage::getSingleton('customer/session');

        if (!$customer->getCustomerActivated())
        {
            /*
             * Fake the old logout() method without deleting the session and all messages
             */
            $session->setCustomer(Mage::getModel('customer/customer'))->setId(null);

            if ($this->_checkRequestRoute('customer', 'account', 'createpost'))
            {
                /*
                 * If this is a regular registration, simply display message
                 */
                $message = Mage::helper('customeractivation')->__('Please wait for your account to be activated');

                $session->addSuccess($message);
            }
            else
            {
                /*
                 * All other types of login
                 */
                Mage::throwException(Mage::helper('customeractivation')->__('This account is not activated.'));
            }
        }
    }

    /**
     * Flag new accounts as such
     *
     * @param Varien_Event_Observer $observer
     */
    public function customerSaveBefore($observer)
    {

        $customer = $observer->getEvent()->getCustomer();
        //$customer_group_id=$customer->getCustomerGroupId();
        $customer_group_id = Mage::getSingleton('customer/session')->getCustomerGroupId(); 

        Mage::log('The customer group id is'. $customer_group_id , null, 'caitlin.log');

        if ($customer_group_id=1)
            Mage::log('I have a General group ID \n',null,'caitlin.log');
        else if ($customer_group_id=5)
            Mage::log('I have a Test group ID \n',null,'caitlin.log');
        else
            Mage::log('I dont understand! \n',null,'caitlin.log');

        $storeId = Mage::helper('customeractivation')->getCustomerStoreId($customer);

        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED, $storeId))
        {
            return;
        }

        if (!$customer->getId())
        {
            if ($customer_group_id =5){
                $defaultStatus = Mage::getStoreConfig(self::XML_PATH_DEFAULT_STATUS, $storeId);
                $customer->setCustomerActivated($defaultStatus);
                $customer->setCustomerActivationNewAccount(true);
            }
            else{
                $customer->setCustomerActivated('Yes');
                $customer->setCustomerActivationNewAccount(false);
                Mage::log('This block initiated',null,'caitlin.log');
            }
        }
    }

    /**
     * Send out emails
     *
     * @param Varien_Event_Observer $observer
     */
    public function customerSaveAfter($observer)
    {
        $customer = $observer->getEvent()->getCustomer();

        $storeId = Mage::helper('customeractivation')->getCustomerStoreId($customer);

        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED, $storeId))
        {
            return;
        }

        $defaultStatus = Mage::getStoreConfig(self::XML_PATH_DEFAULT_STATUS, $storeId);

        try
        {
            if (Mage::app()->getStore()->isAdmin())
            {
                if (!$customer->getOrigData('customer_activated') && $customer->getCustomerActivated())
                {
                    // Send customer email only if it isn't a new account and it isn't activated by default
                    if (!($customer->getCustomerActivationNewAccount() && $defaultStatus))
                    {
                        Mage::helper('customeractivation')->sendCustomerNotificationEmail($customer);
                    }
                }
            }
            else
            {
                if ($customer->getCustomerActivationNewAccount())
                {
                    // Only notify the admin if the default is deactivated or the "always notify" flag is configured
                    $alwaysNotify = Mage::getStoreConfig(self::XML_PATH_ALWAYS_NOTIFY_ADMIN, $storeId);
                    if (!$defaultStatus || $alwaysNotify)
                    {
                        Mage::helper('customeractivation')->sendAdminNotificationEmail($customer);
                    }
                }
                $customer->setCustomerActivationNewAccount(false);
            }
        }
        catch (Exception $e)
        {
            Mage::throwException($e->getMessage());
        }
    }

    public function salesCovertQuoteAddressToOrder(Varien_Event_Observer $observer)
    {
        /** @var $address Mage_Sales_Model_Quote_Address */
        $address = $observer->getEvent()->getAddress();
        $this->_abortCheckoutRegistration($address->getQuote());
    }

    /**
     * Abort registration during checkout if default activation status is false.
     *
     * Should work with: onepage checkout, multishipping checkout and custom
     * checkout types, as long as they use the standard converter model
     * Mage_Sales_Model_Convert_Quote.
     *
     * Expected state after checkout:
     * - Customer saved
     * - No order placed
     * - Guest quote still contains items
     * - Customer quote contains no items
     * - Customer redirected to login page
     * - Customer sees message
     *
     * @param Varien_Event_Observer $observer
     */
    protected function _abortCheckoutRegistration(Mage_Sales_Model_Quote $quote)
    {
        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED, $quote->getStoreId()))
        {
            return;
        }

        if ($this->_isApiRequest())
        {
            return;
        }

        if (!Mage::getSingleton('customer/session')->isLoggedIn() && !$quote->getCustomerIsGuest())
        {
            // Order is being created by non-activated customer
            $customer = $quote->getCustomer()->save();
            if (! $customer->getCustomerActivated()) {
                // Abort order placement
                // Exception handling can not be assumed to be useful

                // Todo: merge guest quote to customer quote and save customer quote, but don't log customer in

                // Add message
                $message = Mage::helper('customeractivation')->__(
                    'Please wait for your account to be activated, then log in and continue with the checkout'
                );
                Mage::getSingleton('core/session')->addSuccess($message);

                // Handle redirect to login page
                $targetUrl = Mage::getUrl('customer/account/login');
                $response = Mage::app()->getResponse();

                if (Mage::app()->getRequest()->isAjax()) {
                    // Assume one page checkout
                    $result = array('redirect' => $targetUrl);
                    $response->setBody(Mage::helper('core')->jsonEncode($result));
                } else if ($response->canSendHeaders(true)) {
                    // Assume multishipping checkout
                    $response->clearHeader('location')
                        ->setRedirect($targetUrl);
                }
                $response->sendResponse();
                /* ugly, but we need to stop the further order processing */
                exit();
            }
        }
    }

    /**
     * Return true if the reqest is made via the api
     *
     * @return boolean
     */
    protected function _isApiRequest()
    {
        return Mage::app()->getRequest()->getModuleName() === 'api';
    }

    /**
     * Check the current module, controller and action against the given values.
     *
     * @param string $module
     * @param string $controller
     * @param string $action
     * @return bool
     */
    protected function _checkRequestRoute($module, $controller, $action)
    {
        $req = Mage::app()->getRequest();
        if (strtolower($req->getModuleName()) == $module
            && strtolower($req->getControllerName()) == $controller
            && strtolower($req->getActionName()) == $action
        )
        {
            return true;
        }
        return false;
    }

    /**
     * Add customer_activated attribute to grid.
     *
     * Thanks to Rouven Alexander Rieker <rouven.rieker@itabs.de> for the base code.
     *
     * @param Varien_Event_Observer $observer
     */
    public function coreBlockAbstractToHtmlBefore(Varien_Event_Observer $observer)
    {
        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED))
        {
            return;
        }

        /** @var $block Mage_Core_Block_Abstract */
        $block = $observer->getEvent()->getBlock();
        if ($block->getId() == 'customerGrid')
        {
            /** @var $helper Netzarbeiter_CustomerActivation_Helper_Data */
            $helper = Mage::helper('customeractivation');

            // Add the attribute as a column to the grid
            $block->addColumnAfter(
                'customer_activated',
                array(
                    'header' => $helper->__('Customer Activated'),
                    'align' => 'center',
                    'width' => '80px',
                    'type' => 'options',
                    'options' => array(
                        '0' => $helper->__('No'),
                        '1' => $helper->__('Yes')
                    ),
                    'default' => '0',
                    'index' => 'customer_activated',
                    'renderer' => 'customeractivation/adminhtml_widget_grid_column_renderer_boolean'
                ),
                'customer_since'
            );

            // Set the new columns order.. otherwise our column would be the last one
            $block->sortColumnsByOrder();

        }

    }

    /**
     * Add customer activation option to the mass action block.
     *
     * This can't be done during the block abstract e
     *
     * @param Varien_Event_Observer $observer
     */
    public function adminhtmlBlockHtmlBefore(Varien_Event_Observer $observer)
    {
        // Check the grid is the customer grid
        if ($observer->getBlock()->getId() != 'customerGrid')
        {
            return;
        }

        // Check if there is a massaction block and if yes, add the massaction for customeractivation
        $massBlock = $observer->getBlock()->getMassactionBlock();
        if ($massBlock)
        {
            /** @var $helper Netzarbeiter_CustomerActivation_Helper_Data */
            $helper = Mage::helper('customeractivation');

            $massBlock->addItem(
                'customer_activated',
                array(
                    'label' => $helper->__('Customer Activated'),
                    'url' => Mage::getUrl('customeractivation/admin/massActivation'),
                    'additional' => array(
                        'status' => array(
                            'name' => 'customer_activated',
                            'type' => 'select',
                            'class' => 'required-entry',
                            'label' => $helper->__('Customer Activated'),
                            'values' => array(
                                '1' => $helper->__('Yes'),
                                '0' => $helper->__('No')
                            )
                        )
                    )
                )
            );
        }
    }

    /**
     * Add the customer_activated attribute to the customer grid collection
     *
     * @param Varien_Event_Observer $observer
     */
    public function eavCollectionAbstractLoadBefore(Varien_Event_Observer $observer)
    {
        if (Mage::getStoreConfig(self::XML_PATH_MODULE_DISABLED))
        {
            return;
        }

        // Cheap check to reduce overhead on product and category collections
        if (Mage::app()->getRequest()->getControllerName() !== 'customer')
        {
            return;
        }

        /** @var $collection Mage_Customer_Model_Resource_Customer_Collection */
        $collection = $observer->getEvent()->getCollection();

        // Only add attribute to customer collections
        $customerTypeId = Mage::getSingleton('eav/config')->getEntityType('customer')->getId();
        $collectionTypeId = $collection->getEntity()->getTypeId();
        if ($customerTypeId == $collectionTypeId)
        {
            $collection->addAttributeToSelect('customer_activated');
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:34:45.747

简单的错误。您使用的是赋值运算符`=`而不是比较运算符`==`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T13:11:47.723

嗨，我尝试使用您的代码，但无法获取客户组 ID。

我试过了

```
$customer_group_id = Mage::getSingleton('customer/session')->getCustomerGroupId(); 
```

最后通过使用它得到了它

```
$customer = $observer->getEvent()->getCustomer();

$customer_group = $customer->getGroupId(); 
```

# ruby - 无法在 Windows 中安装 json gem

> ID：16071144
> 
> 赞同：0
> 
> 时间：2013-04-17T22:11:41.603
> 
> 标签：ruby, json, gem, devkit

我试图在 Windows 上安装 json gem。我安装了 DevKit。我在下面收到以下错误。有什么建议么？这个问题

[JSON Gem 不会安装 (Windows)](https://stackoverflow.com/questions/8840804/json-gem-will-not-install-windows)

建议安装 DevKit 并尝试使用 json_pure。我都做了。问题是我的 bundle install 正在尝试安装 json 并且在安装 json 之前不会继续。这是一个 Rails 项目的捆绑安装。

```
d:\source\my_project>gem install json -v '1.6.3'
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing json:
        ERROR: Failed to build gem native extension.

    C:/Ruby200/bin/ruby.exe extconf.rb
creating Makefile

make
generating parser-i386-mingw32.def
compiling parser.c
In file included from parser.rl:1:0:
../fbuffer/fbuffer.h:129:13: warning: 'fbuffer_append_long' defined but not used [-Wunused-function]
../fbuffer/fbuffer.h:136:17: warning: 'fbuffer_dup' defined but not used [-Wunused-function]
../fbuffer/fbuffer.h:149:14: warning: 'fbuffer_to_s' defined but not used [-Wunused-function]
../fbuffer/fbuffer.h:90:13: warning: 'fbuffer_append_str' defined but not used [-Wunused-function]
linking shared-object json/ext/parser.so

make install
/usr/bin/install -c -m 0755 parser.so C:/Ruby200/lib/ruby/gems/2.0.0/gems/json-1.6.3/ext/json/ext/json/ext
/usr/bin/install: cannot create regular file `C:/Ruby200/lib/ruby/gems/2.0.0/gems/json-1.6.3/ext/json/ext/json/ext': No such file or directory
make: *** [install-so] Error 1

Gem files will remain installed in C:/Ruby200/lib/ruby/gems/2.0.0/gems/json-1.6.3 for inspection.
Results logged to C:/Ruby200/lib/ruby/gems/2.0.0/gems/json-1.6.3/ext/json/ext/parser/gem_make.out 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-06T10:47:51.293

我也有这个问题，通过这样做解决了这个问题：

使用*Ruby 版本 - 2.2.2*

*Gem 版本 - 2.3.0*（如果您安装了最新的 gem 版本，您可以使用命令降级 - `gem update --system 2.3.0`）

请注意，即使您是 64 位 windows 系统，请从[此处下载并解压 32 位 devkit (](http://rubyinstaller.org/downloads/) *DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe* )

解压后，将 devkit 和 mingw\bin 的路径添加到路径变量中导航到 devkit 目录并运行以下命令

```
ruby dk.rb init

ruby dk.rb install 
```

最后，重新启动命令提示符并尝试

```
gem install json 
```

这对我有用。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-06T08:43:15.290

在我的情况下，我下载了错误版本的 Ruby（32 位），但我使用 64 位 Windows => 发生错误。您需要做的第一件事是检查开发工具包是否正常工作。

```
gem install json --platform=ruby 
```

如果它不能工作，你应该按照下面的教程让它工作。 [https://github.com/oneclick/rubyinstaller/wiki/Development-Kit](https://github.com/oneclick/rubyinstaller/wiki/Development-Kit)

在此之后，您可以正常安装 json gem。我认为。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T19:30:21.713

我不得不使用 1.7.7 版本。我不知道为什么，但它似乎与您的 ruby​​ 版本兼容。做： gem install json -v '1.7.7'

# java - Java构造函数未定义

> ID：16071149
> 
> 赞同：2
> 
> 时间：2013-04-17T22:12:18.490
> 
> 标签：java

基本上，我在一本书中做一个 Java 练习，这个源代码是它对练习的答案。但是，eclipse 说倒数第三行有一个错误，说“- 构造函数 PhoneNumber() 未定义”。但据我了解，该特定构造函数定义正确，那么问题是什么？

```
public class PhoneNumber {
    // Only the relevant source codes are posted here.
    // I removed other bits cause I'm sure they are not responsible for the
    // error

    private char[] country;
    private char[] area;
    private char[] subscriber;

    public PhoneNumber(final String country, final String area, final String subscriber) {
        this.country = new char[country.length()];
        country.getChars(0, country.length(), this.country, 0);
        this.area = new char[area.length()];
        area.getChars(0, area.length(), this.area, 0);
        this.subscriber = new char[subscriber.length()];
        subscriber.getChars(0, subscriber.length(), this.subscriber, 0);
        checkCorrectness();
    }

    private void runTest() {
        // method body
    }

    public static void main(final String[] args) {
        (new PhoneNumber()).runTest(); // error here saying :
                                        // "The constructor PhoneNumber() is undefined"
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T22:14:13.070

日食是正确的。您的代码没有定义没有参数的构造函数，这是您`new PhoneNumber()`在方法内部调用的`main`。

您只有一个构造函数，即：

```
public PhoneNumber (final String country, final String area, final String subscriber) 
```

如果您不指定任何其他构造函数，则会自动为您创建所谓的*默认构造函数，即没有参数的构造函数。*由于您使用 3 个参数指定一个，因此您没有默认构造函数。

有两种方法可以解决这个问题：

1.  声明无参数构造函数；或者
2.  使用您已有的构造函数。

要实现第一个选项，您可以执行以下操作：

```
class PhoneNumber {
  ...
  public PhoneNumber() {
    this("no country", "no area", "no subscriber");
  }
} 
```

这将创建一个无参数构造函数，它只需使用一组默认参数调用您已有的构造函数。这可能是也可能不是您想要的

要实施第二个选项，请更改您的`main`方法。代替

```
(new PhoneNumber ()).runTest(); 
```

使用类似的东西：

```
(new PhoneNumber("the country", "the area", "the subscriber")).runTest(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:15:16.700

只有在您未定义任何其他构造函数时，才会为您自动定义默认（无参数）构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:14:02.617

你的错误说的是没有

```
PhoneNumber() 
```

定义了构造函数（没有参数）。默认情况下，如果您不声明任何其他构造函数，这是您在 Java 中可用的构造函数。但是您通过实施来覆盖它

```
PhoneNumber (final String country, final String area, final String subscriber) 
```

# c - 二维数组引用整个索引，而不是 C 中的单个单元格

> ID：16071150
> 
> 赞同：0
> 
> 时间：2013-04-17T22:12:19.187
> 
> 标签：c, debugging, multidimensional-array

我似乎无法弄清楚我的问题是什么。我正在编写 2D 随机游走模拟，我的想法是使用 2D 数组来模拟它所在的网格。但是，在我的代码中，当我尝试引用数组中的特定单元格来增加它的值时，比如 bin[3][4]，它会增加整个索引的值，即 bin[1][4],bin[ 2][4]、bin[3][4]等 关于如何解决这个问题或我做错了什么的任何想法？谢谢。

```
#include <stdio.h>
#include <math.h>

#define total 10\.  /*total iterations*/
#define walk 5  /*total # of steps in a walk*/
#define lambda 1.0 /*step size*/
#define binsize 0.1
/*current chosen values are for bug checking simplicity*/

main()
{
  float range = walk*lambda*2.; /*2 times max range, all positive*/
  int n,prob,i,k,j,placex,placey,bins;
  double valuex,valuey, a; /*value starts at half range so all values are +*/
  bins=(range/binsize);

  int bin[bins][bins];
  for(i=0;i<=bins;i++) /*zero out bin*/
  {
    for(j=0;j<=bins;j++)
    {
      bin[i][j]=0;
    }
  }

  for(k=0;k<total;k++)
  {
    valuex=range/2.;
    valuey=range/2.;

    for(n=1;n<=walk;n++)
    {
      prob= rand(4) % 100+1;
      if(prob<=25)
      {
        valuex=valuex+pow(lambda,n);
      }
      else if(prob>25 && prob<=50)
      {
        valuex=valuex-pow(lambda,n);
      }
      else if(prob>50 && prob<=75)
      {
        valuey=valuey+pow(lambda,n);
      }
      else if(prob>75)
      {
        valuey=valuey-pow(lambda,n);
      }
    }   

    placex=floor(valuex/binsize+0.5);
    placey=floor(valuey/binsize+0.5);

    bin[placex][placey]=++bin[placex][placey];

    printf("%d %d %d\n",placex,placey,bin[placex][placey]); /* for bug checking. it prints the bin numbers where the value should go and then the value of that element.*/
  }

  for(i=0;i<=bins;i++)
  {
    for(j=0;j<=bins;j++)
    {
      a=bin[i][j]/total;
      //printf("%lf %lf %lf\n",i*binsize-range/2.,j*binsize-range/2.,a); /*format for input into IGOR*/
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:56:11.827

弄清楚了。您将超出数组范围。您的 for 循环上升到 bins，但数组的索引从 0 到 bins -1。一旦我在 for 循环中从 <= 中取出 =，它就起作用了。我的最终代码看起来像这样。通常，超出数组范围具有不可预测的行为。

```
#include <stdio.h>
#include <math.h>

#define total 10\.  /*total iterations*/
#define walk 5  /*total # of steps in a walk*/
#define lambda 1.0 /*step size*/
#define binsize 0.1
/*current chosen values are for bug checking simplicity*/

main()     {
   float range = walk * lambda * 2.; /*2 times max range, all positive*/
   int n, prob, i, k, j, placex, placey, bins;
   double valuex, valuey, a; /*value starts at half range so all values are +*/

   bins = (range / binsize);

   int bin[bins][bins];

   /*zero out bin*/
   for(i = 0; i < bins; i++) {
      for(j = 0; j < bins; j++) 
         bin[i][j] = 0;
   }

   for(k = 0; k < total; k++) {
      valuex = range / 2\. - 1;
      valuey = range / 2\. - 1;

      for(n = 1; n <= walk; n++) {
         prob = rand(4) % 100 + 1;
         if(prob<=25)
            valuex += pow(lambda, n);
         else if(prob <= 50)
            valuex -= pow(lambda, n);
         else if(prob <= 75)
            valuey += pow(lambda, n);
         else 
            valuey -= pow(lambda, n);
      }   

      placex = floor(valuex / binsize + 0.5); 
      placey = floor(valuey / binsize + 0.5); 
      bin[placex][placey] += 1;

      printf("%d %d %d\n", placex, placey, bin[placex][placey]); /* for bug checking. it prints the bin numbers where the value should go and then the value of that element.*/
   }

   for(i = 0; i < bins; i++) {
    printf("\n");
      for(j = 0 ;j < bins; j++) {
        if (bin[i][j] == 0)
        printf("  ");
        else
        printf("%d ", bin[i][j]);
         a = bin[i][j] / total;

       }
    }
} 
```

我在底部添加的 for 循环只是输出模式。

# c++ - 在静态变量定义中捕获的引用

> ID：16071154
> 
> 赞同：8
> 
> 时间：2013-04-17T22:12:34.103
> 
> 标签：c++, c++11

```
#include <iostream>

void foo(int k) {
    static auto bar = [&]{
        std::cout << k << std::endl;
    };
    bar();
}

int main () {
    foo(1); foo(2); foo(3); // output is correct: 1, 2, 3
} 
```

检查函数*foo* ，静态 lambda 如何通过引用捕获*k 。*这似乎有效，更复杂的数据类型而不是*int*也是如此。

这是预期的吗？是否可以保证每次调用*foo的**k*的地址都相同，或者这是**UB**？

 ***在此先感谢，如果以前回答过这个问题，我很抱歉（我确实试图找到类似的问题但没有成功）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:18:43.003

**这是未定义的行为**。

根据 C++11 标准的第 5.2.2/4 段关于函数调用表达式及其参数的初始化：

> [...]**参数的生命周期在定义它的函数返回时结束**。每个参数的初始化和销毁​​发生在调用函数的上下文中。[...]

因此，您的 lambda 将存储一个引用，该引用会在函数调用返回时立即悬空。

在这种情况下，实现可以自由（并且可能）为每个函数调用在同一地址创建函数参数，这可能是您观察预期输出的原因。

但是，此行为不是标准强制要求的 - 因此，您不应依赖它（如果是这种情况，您的代码将是合法的，因为 3.8/7）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:24:06.063

在您的示例中它可能“工作”的原因是调用堆栈总是以相同的方式排列。试试这个，看看你是否仍然得到“预期”的输出。

```
#include <iostream>

void foo(int k) {
    static auto bar = [&]{
        std::cout << k << std::endl;
    };
    bar();
}

void baz(int k) {
    std::cout << "baz: ";
    foo(k);
}

int main () {
    foo(1); baz(2); foo(3);
} 
```***

# ios - NavigationBar 的标题仅显示半顶

> ID：16071156
> 
> 赞同：0
> 
> 时间：2013-04-17T22:12:47.900
> 
> 标签：ios, objective-c, navigationbar

长话短说，这就是我得到的：

[http://img839.imageshack.us/img839/9461/capturedcran20130418000x.png](http://img839.imageshack.us/img839/9461/capturedcran20130418000x.png)

这是我的 AppDelegate 中的一些代码：

```
[[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"main_bar.png"] forBarMetrics:UIBarMetricsDefault];
[[UINavigationBar appearance] setTitleTextAttributes:
 [NSDictionary dictionaryWithObjectsAndKeys:
  //[UIColor colorWithRed:125.0/255.0 green:111.0/255.0 blue:100.0/255.0 alpha:1.0],
  //UITextAttributeTextColor,
  //[UIColor colorWithRed:0.0 green:0.0 blue:0.0 alpha:0.8],
  //UITextAttributeTextShadowColor,
  //[NSValue valueWithUIOffset:UIOffsetMake(0, 0)],
  //UITextAttributeTextShadowOffset,
  [UIFont fontWithName:@"Pacifico" size:25],
  UITextAttributeFont,
  nil]];
[[UINavigationBar appearance] setTitleVerticalPositionAdjustment:-10 forBarMetrics:UIBarMetricsDefault]; 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:10:27.963

我遇到过类似的问题，并使用以下方法将它们整理出来：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        self.title = @"Home";
        self.tabBarItem.image = [UIImage imageNamed:@"main_bar.png"];
        CGRect frame = CGRectMake(0, 0, 400, 44);
        UILabel *label = [[UILabel alloc] initWithFrame:frame];
        label.backgroundColor = [UIColor clearColor];
        label.font = [UIFont boldSystemFontOfSize:20.0];
        label.shadowColor = [UIFont fontWithName:@"Pacifico" size:25];
        label.textAlignment = UITextAlignmentCenter;
        label.textColor = [UIColor whiteColor];
        self.navigationItem.titleView = label;
        label.text = NSLocalizedString(@"Remindbox", @"");
    }
    return self;
} 
```

您需要稍微调整一下才能使其与您的字体一起使用。希望它有所帮助。

# jquery - 使用单选按钮控制文本框（启用/禁用） - jQuery

> ID：16071157
> 
> 赞同：-2
> 
> 时间：2013-04-17T22:12:50.000
> 
> 标签：jquery, textbox, radio-button

我想获得控制文本框的帮助，启用/禁用，具体取决于所选的单选按钮 - jQuery 会更好。

如果选择了单选按钮，则将启用关联的文本框 - 其他文本框将被禁用。所有场景都一样。将预先选择一个单选按钮。

这是我的标记：

> ```
>  <div>
>             <h1>Control fields</h1>
>             <div id="Div1">
>                 <div id="first">
>                     <input type="radio" name="radio" id="radio3" checked="checked" />First</br>
>         <input type="text" id="txt_one" /></br>
>         <input type="text" id="txt_two" /></br>
>                 </div>
>                 <div id="second">
>                     <input type="radio" name="radio" id="radio4" />Second</br>
>                     <input type="text" id="three" /></br>
>       <input type="text" id="txt_four" /></br>
>                 </div>
> 
>                 <div id="third">
>                     <input type="radio" name="radio" id="radio5" checked="checked" />First</br>
>         <input type="text" id="txt_five" /></br>
>         <input type="text" id="txt_six" /></br>
>         <input type="text" id="txt_seven" /></br>
>                 </div>
>             </div>
>         </div> 
> ```

这是一个链接：http: [//jsfiddle.net/9CDcH/1/](http://jsfiddle.net/9CDcH/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:23:41.907

我想我可能有你要找的东西。这是jQuery：

```
$('.RadioExample').not('.First').siblings().prop('disabled',true);

$('.RadioExample').on('click',function(){
    $('.RadioExample')
        .siblings()
        .prop('disabled',true);

    $(this)
        .siblings()
        .prop('disabled',false);
}); 
```

为此，您`RadioExample`向每个单选和`First`第一个单选按钮添加一个类。这会在页面加载时禁用第一个单选按钮（默认选中）之后的所有同级单选按钮，然后在每次单击时重新禁用所有单选按钮并启用所单击单选按钮的同级。

[我也更新了你的 jsFiddle](http://jsfiddle.net/9CDcH/2/)。

有几种方法可以做到这一点（另一种方法是添加或删除类），但这是首先想到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:27:29.453

无需使用自定义类，您的实际标记就可以了，所以，试一试：

```
$(document).ready(function() {
    $('input:radio').change(function() {
        $("#content").find("input:text").attr("disabled",true);
        if($(this).is(":checked")) 
            $(this).parent().find("input:text").attr("disabled",false);
    });
}); 
```

该功能将在收音机更改时更新输入，因此所有输入都将被禁用，然后如果实际收音机被检查，它将启用同一容器中的所有输入。

看看你的 jsfiddle：http: [//jsfiddle.net/hyunkeln/9CDcH/3/](http://jsfiddle.net/hyunkeln/9CDcH/3/)

# intellij-idea - 在 WebStorm/IntelliJ 中检查 Git 修订的快捷方式？

> ID：16071159
> 
> 赞同：0
> 
> 时间：2013-04-17T22:13:00.770
> 
> 标签：intellij-idea, webstorm

我发现我可以使用 Alt-9 快速打开提交日志并使用箭头键浏览提交。但是，我找不到日志菜单的任何其他键盘快捷键。特别是选择了一个版本，如何使用键盘快捷键检查它？

# javascript - Wordpress 滑块未显示/透明文本/并且缺少下拉菜单

> ID：16071164
> 
> 赞同：0
> 
> 时间：2013-04-17T22:13:28.720
> 
> 标签：javascript, wordpress

我在其他帖子上看到过这个问题，但似乎找不到解决我特定网站问题的答案。

站点运行良好，直到它被转移到另一个主机 - 必须编辑大量的 wordpress php 代码才能让它再次运行，但没有对模板做任何事情。www.tnapothecary.com

无论出于何种原因，wordpress 页面编辑器上的可视化编辑器按钮都消失了。我已更新到最新的 wordpress，但仍然没有任何效果。关于如何让文本再次出现的任何想法？

我遇到的另一个问题是滑块现在没有显示并且下拉菜单不起作用。我当时认为这是一个 js 问题，但是在替换了所有主题 js 和 tinymce 文件之后 - 没有任何效果。任何想法将不胜感激。

谢谢本

# wordpress - the_post_thumbnail（数组（x，y））；

> ID：16071165
> 
> 赞同：1
> 
> 时间：2013-04-17T22:13:37.333
> 
> 标签：wordpress, resize

我正在尝试使用 WP 函数 the_post_thumbnail(array(x,y)); 但图像无法正确调整大小。它只是无法正常工作。

特别是在我正在构建的 page-template.php 文件中，我正在尝试使用：

```
the_post_thumbnail( array(200,200) ); 
```

然而生成的图像是 200 x 150。我在这里缺少什么？

我尝试将缩略图大小显式添加到functions.php，如下所示：

```
add_image_size( 'news-feature-thumb', 200, 200, true ); 
```

但这并没有什么不同。

我查看了整个 StackOverflow，但我没有看到任何可以解决我的问题的东西。我正在使用 WP 3.3.1。这种方法是否已弃用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:45:37.537

添加后`add_image_size( 'news-feature-thumb', 200, 200, true );`尝试这样调用`the_post_thumbnail`：

```
the_post_thumbnail( 'news-feature-thumb' ); 
```

# ruby-on-rails - btw const_get 和qualified_const_get 有什么区别？

> ID：16071168
> 
> 赞同：3
> 
> 时间：2013-04-17T22:13:43.787
> 
> 标签：ruby-on-rails, activesupport

标准 ruby​​ 库中有一系列方法，即 const_defined?、const_get 或 const_set。

`const_defined?, const_get, const_set`

而且，在 Rails 的 Active Support Core Extensions 中，存在这些人的“合格_”对应物。

`qualified_const_defined?, qualified_const_get, qualifeid_const_set`

有没有人可以明确解释这些方法的裸形式和合格形式之间的区别？

先感谢您。

孝

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:27:59.203

const 助手支持与任意深度的`qualified_`常量交互（不仅仅是主题的孩子）。

我认为一个例子是解释这一点的最简单方法。假设`Foo::Bar::Baz`存在：

```
 > Object::const_get "Foo::Bar::Baz"
NameError: wrong constant name Foo::Bar::Baz
 > Object::const_get "Foo"
=> Foo
 > Foo.const_get "Bar"
=> Foo::Bar
 > Foo::Bar.const_get "Baz"
=> Foo::Bar::Baz 
```

这些`qualified_`方法允许您避免直接遍历模块层次结构：

```
 > Object::qualified_const_get "Foo::Bar::Baz"
=> Foo::Bar::Baz
 > Foo.qualified_const_set "Bar::Fizz", 123
=> 123
 > Foo::Bar::Fizz
=> 123 
```

[我也建议在源头上四处寻找](https://github.com/rails/rails/blob/11f6795b238172c4a13176062bd38b83285799b7/activesupport/lib/active_support/core_ext/module/qualified_const.rb)。它很干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:29:04.160

你可能会觉得这很有趣：

[http://redcorundum.blogspot.com/2006/05/kernelqualifiedconstget.html](http://redcorundum.blogspot.com/2006/05/kernelqualifiedconstget.html)

# android - 适用于 Android 的 Google Map API：TOS 报告要求

> ID：16071169
> 
> 赞同：1
> 
> 时间：2013-04-17T22:13:48.267
> 
> 标签：android, google-maps

我有一个 Android 应用程序，目前正在使用 v1 版本的 Maps API。我希望升级到 v2，但在阅读服务条款时，我遇到了以下规定：

> 9.2 报告。您必须实施 Google 在这些条款和 Maps API 文档中规定并可能不时更新的报告机制。例如，根据 Maps API 文档中的规定，如果您的 Maps API 实施使设备能够通过使用传感器（包括但不限于 GPS、小区三角测量、WiFi 或类似设备）检测自己的位置，您同意向 Google 提供报告功能）在地图上显示设备的位置或计算路线。

我想知道这是否意味着我需要实现其他配置或功能。我知道[这个问题](https://stackoverflow.com/questions/6243133/what-do-the-google-maps-terms-of-service-mean-in-practice-for-an-ios-app-develop)是在一年前针对 iPhone 提出的，答案是“什么都没有”，但我在任何地方都找不到任何关于它如何应用于 Android 端的讨论，因为（我相信）v1 API 不需要您同意这些条款。

作为记录，此问题的常见问题解答（可在[此处](https://developers.google.com/maps/faq#tos_reporting)找到）仅提供指向 javascript、flash 和静态 API 版本的指南链接，不适用于 Android。它也没有明确声明 Android API 的使用是豁免的。

我希望答案仍然是“什么都没有”，主要是因为我在 v2 API 中找不到任何可以让我以编程方式提供这些数据的东西，即使我愿意提供它（我就是这样，只是说明一点）。但我不得不问，因为 TOS 语言对于适用于 Android 来说不够模糊，而且 v2 API 仍然相对较新，所以可能还没有人打扰它。我知道这不是一个编程问题，而是一个法律问题，但如果实际上在实现中需要做一些事情，那么这使得它在编程方面具有相关性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:59:09.993

关于报告仍然“没有” - 这是自动的，但您需要考虑[Attribution Requirements](https://developers.google.com/maps/documentation/android/intro#attribution_requirements)。

# google-chrome - 使用 XHR 进行跨域重定向

> ID：16071170
> 
> 赞同：1
> 
> 时间：2013-04-17T22:13:58.880
> 
> 标签：google-chrome, firefox, redirect, xmlhttprequest, cross-domain

我尝试实现以下场景：

*   从 origin A.com 加载页面
*   从该页面上的脚本向同源 A.com 上的资源启动同步 XHR 请求
*   然后通过 302 重定向到另一个来源 B.com 上的资源来回答此请求

我希望这个跨域重定向被处理，但是 XHR-send 方法返回一个错误并且没有请求或预检请求被触发。

*   Chrome (26)：错误消息“NETWORK_ERR: XMLHttpRequest Exception 101”
*   Firefox (20)：错误消息 [异常...“失败”nsresult：“0x80004005 (NS_ERROR_FAILURE)”...
*   IE9：没有错误消息，但 XHR send() 返回状态 = 12017

根据[XHR 规范](http://www.w3.org/TR/XMLHttpRequest/#infrastructure-for-the-send%28%29-method)，我预计重定向也可以跨域工作。

知道如何让这个跨域重定向运行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:42:34.657

这是行不通的，因为重定向是由浏览器处理的，而 XHR 只能看到浏览器重定向到的页面——这意味着它**是**跨域的——这意味着除非 B.com 明确允许您的 A.com 域，否则它将失败访问它。

您还可以让您在 A.com 上的其他页面充当代理并在 B.com 本身上下载内容，然后输出它返回的响应。

# jquery - Firefox 和 Chrome 上的 jQuery 严重滞后，但不是 IE

> ID：16071171
> 
> 赞同：1
> 
> 时间：2013-04-17T22:14:00.630
> 
> 标签：jquery, google-chrome, firefox, lag

如标题所述，这个只有 jQuery 的单页网站在 Chrome 和 Firefox 上出现了疯狂的延迟，但在 IE10 上却**没有。**我确实意识到 MS 用 10 加强了他们的游戏，但看在甜蜜的上帝的份上，有什么关系？

我读过，有时 Chrome 在 div hide()s 和 show()s 上比较滞后，但我使用了 fadeIn() 和 fadeOut()，似乎我缺少一些东西。

我已经为它创建了一个 JSFiddle，以防我以某种方式做了一些可怕的错误。

[http://jsfiddle.net/g2avityhitz/ZdqEd/1/](http://jsfiddle.net/g2avityhitz/ZdqEd/1/)

```
(function($){
    $(document).ready( function () {
        $("#picbox .tiny img").click( function () {
            $("#picbox .tiny img").removeClass('selected');
            $(this).addClass('selected');
            imgSrc = $(this).attr('src');
            $("#picbox .main").css({
                'background-image'  : 'url(' + imgSrc + ')'
            });
            $("#picbox .main a").attr('href',imgSrc);
        });

        $("#picbox .main a").click( function (e) {
            e.preventDefault();
            imgSrc = $(this).attr('href');
            $("#lightbox .frame img").remove();
            $("#lightbox .frame").append('<img src="' + imgSrc + '" />');
            $("#lightbox").fadeIn(500, function () {
                $('#lightbox .frame .close').click( function () {
                    $("#lightbox").fadeOut(200);
                });
            });
        });
    });
})(jQuery); 
```

谢谢，麻烦您了。

**编辑：**很好的回应，但再次指出 - **IE**中没有滞后，仅在 Chrome 和 Firefox 中。这背后可能是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:36:47.647

***[这是一个可以优化您拥有的缓存的示例。](http://jsfiddle.net/ZdqEd/9/)***

它会解决一切吗？不确定，但它肯定会有所帮助。

**缓存代码：**

```
var $images = $("#picbox .tiny img"),
    $main = $("#picbox .main"),
    $mainLinks = $main.find("a"),
    $lightbox = $("#lightbox"),
    $frame = $lightbox.find(".frame"),
    $frameImages = $frame.find("img");

    $images.on("click", function () 
    {
        var $this = $(this);

        $images.removeClass('selected');
        $this.addClass('selected');
        imgSrc = $this.attr('src');
        $main.css({ 'background-image': 'url(' + imgSrc + ')' });
        $mainLinks.attr('href', imgSrc);
    });

    $mainLinks.on("click", function (e) 
    {   
        e.preventDefault();

        imgSrc = $(this).attr('href');
        $frameImages.remove();
        $frame.append('<img src="' + imgSrc + '" />');
        $lightbox.fadeIn(500, function () 
        {
            $frame.find(".close").on("click", function () 
            {
                $lightbox.fadeOut(200);
            });     
        });
    }); 
}); 
```

# c# - C# Windows 应用程序（不是 wpf）将文本框中的信用卡号屏蔽为输入，然后验证和处理信用卡号

> ID：16071172
> 
> 赞同：2
> 
> 时间：2013-04-17T22:14:02.443
> 
> 标签：c#, winforms, credit-card, pci-compliance

我支持接受和处理信用卡的 C# windows 应用程序。但是由于新规则，我需要在输入信用卡号时对其进行屏蔽。因此，如果第一个数字是 4，则在输入下一个数字（例如 9）之前它是可见的，然后文本框显示 *9。

我曾想过使用 maskedtextbox，但字符都是“*”，但我需要显示最后输入的字符。

有没有这样做的最佳实践？请记住，我需要这些数字并在处理信用卡之前运行验证，然后处理信用卡并将其存储在数据库中。我已经在数据库中加密了 CC 字段。

任何建议/帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:33:17.213

简单的方法是有两个文本框。用户实际输入数字的一个，另一个显示该输入的屏蔽版本。将屏蔽控件放在入口控件上。

使用`TextChanged`或`KeyUp`事件来跟踪更改和更新。

例如

```
if (textBoxEntry.Text.Length <= 1)
{
    textBoxMasked.Text = textBoxEntry.Text;
}
else
{
    string lastChar = textBoxEntry.Text.Substring(textBoxEntry.Text.Length-1, 1);
    textBoxMasked.Text = lastChar.PadLeft(textBoxEntry.Text.Length, '*');
} 
```

除此之外，您可能还会遇到 PCI 合规性问题。仅将这些值加密到数据库中是不够的，您需要密钥管理策略、密钥轮换计划和更多堆。希望您已经知道所有这些，但如果您不知道，请仅提及它。

# couchdb - 如何在一个视图中链接更多文档

> ID：16071174
> 
> 赞同：1
> 
> 时间：2013-04-17T22:14:10.443
> 
> 标签：couchdb

有 3 种 CouchDB 文档类型：

用户

```
{ "_id: "user/author1", "type: "user", "name" : "Joe Doe"} 
```

审查

```
{ "_id: "review/review1", "type" : "review", "content" : "..." } 
```

产品

```
{ "_id": "product/awesomeproduct", "type" : "product", "reviews": [
   {
       "author": "author1",
       "review_id": "review/review1"
   },
   {
       "author": "author2",
       "review_id": "review/review2"
   }
  ]
} 
```

如何从具有单一视图的文档中获取所有数据？

我尝试使用链接文档，但每次发射只能使用一个（使用 include_docs=true）：

（咖啡稿）

```
(doc) ->
  if doc.type is "product"
    for review in doc.reviews
       emit [doc._id, review.author],{_id: "user/" + review.author}
       emit [doc._id, review.author],{_id: review.review_id} 
```

但我想要这样的东西（在单次​​发射中获取用户和审查文档）：

```
 (doc) ->
  if doc.type is "product"
    for review in doc.reviews
       key = [doc._id, review.author]
       value = {"user:" {_id: "user/" + review.author},"review" :{_id: review.review_id}}
       emit key, value 
```

有没有可能的方法来实现它？如何在单一视图中加入这些类型的文档？

我想得到这样的结果：

```
[
  key : ["product/awesomeproduct", "author1"], 
  value : {user: {_id: "user/author1"},review :{_id: "review/review1"}}
  doc: 
     {user: {"_id: "user/author1", "type: "user", "name" : "Joe Doe"},
      review: {"_id: "review/review1", "type" : "review", "content" : "..."}
     }

] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:01:23.607

似乎是 reduce 函数的经典案例（对不起，我没有咖啡 :)）：

**地图**

```
function(doc) {
    if(doc.type == "product") {
        for(review_i in doc.reviews) {
            var review = doc.reviews[review_i];
            emit([doc._id, review.author],{user: "user/" + review.author, review: review.review_id});
        }
    }
} 
```

**减少**

```
function(keys, values) {
    return(values);
} 
```

结果（?reduce=true[&group=exact]）：

```
key                                      value
["product/awesomeproduct", "author2"]    [{user: "user/author2", review: "review/review1"}]
["product/awesomeproduct", "author1"]    [{user: "user/author1", review: "review/review1"}] 
```

您究竟希望发出的数据是什么样的？

**对上述评论的回应** 应该是可能的，除了您希望在视图返回的文档中显示数据的方式。include_docs 表示按原样返回整个文档。似乎您希望在视图和返回的文档中表示相同的数据，因此可以将文档的结构更改为：

```
_id : ...
data : 
    {
        user: {"_id: "user/author1", "type: "user", "name" : "Joe Doe"},
        review: {"_id: "review/review1", "type" : "review", "content" : "..."}
    } 
```

否则，如果您只希望视图键、值是上述结构，而不关心返回的文档的结构：

**地图**

```
function(doc) {
    if(doc.type == "product") {
        for(review_i in doc.reviews) {
            var review = doc.reviews[review_i];
            emit([doc._id, review.author],{
                            user: {_id: "user/" + review.author}, 
                            review: {_id: review.review_id}
                            });
        }
    }
} 
```

这应该导致：

```
curl -X GET http://localhost:5984/testdb2/_design/test/_view/test?include_docs=true\&reduce=false

{
    "offset": 0,
    "rows": [
        {
            "doc": {
                "_id": "product/awesomeproduct",
                "_rev": "2-20f0c6cc663e03ab93f8646f09d87db2",
                "reviews": [
                    {
                        "author": "author1",
                        "review_id": "review/review1"
                    },
                    {
                        "author": "author2",
                        "review_id": "review/review1"
                    }
                ],
                "type": "product"
            },
            "id": "product/awesomeproduct",
            "key": [
                "product/awesomeproduct",
                "author1"
            ],
            "value": {
                "review": {
                    "_id": "review/review1"
                },
                "user": {
                    "_id": "user/author1"
                }
            }
        },
        {
            "doc": {
                "_id": "product/awesomeproduct",
                "_rev": "2-20f0c6cc663e03ab93f8646f09d87db2",
                "reviews": [
                    {
                        "author": "author1",
                        "review_id": "review/review1"
                    },
                    {
                        "author": "author2",
                        "review_id": "review/review1"
                    }
                ],
                "type": "product"
            },
            "id": "product/awesomeproduct",
            "key": [
                "product/awesomeproduct",
                "author2"
            ],
            "value": {
                "review": {
                    "_id": "review/review1"
                },
                "user": {
                    "_id": "user/author2"
                }
            }
        }
    ],
    "total_rows": 2
} 
```

这并不像你想要的那样，但这是我最好的猜测。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T16:22:26.403

简短的回答……你不能。Couchdb 只允许您一次发出一个文档。

有两种方法可以获取您需要的数据。

1.  保持结构不变，并在您的客户端代码中手动执行连接。
2.  非规范化您的数据。此处的非规范化就像将评论放在产品文档中一样。

[数据建模注意事项](http://docs.mongodb.org/manual/core/data-modeling/)适用于 Mongodb，但有关如何在 NoSQL 环境中构建数据的概念与适用于 CouchDB 的概念相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-08T04:36:08.373

你可以在下面做这样的事情，

```
function (doc) {
  if(doc.type is "product" && doc.reviews.length > 0){

    for(x=0; x<doc.reviews.length; x++){
       key = [doc._id, review.author]
       value = {"user:" {_id: "user/" + review.author},"review" :{_id: review.review_id}}
       emit ([key, value])
    }
  }
} 
```

这将在您的相关视图中发出两个文档。

# haskell - Haskell - 类型匹配

> ID：16071180
> 
> 赞同：1
> 
> 时间：2013-04-17T22:14:37.743
> 
> 标签：haskell, types, matching

我无法从辅助函数获取输出以匹配我正在使用以下代码的函数的输出：

```
getSemiDiag :: [[Maybe Player]] -> Int -> Int -> [Maybe Player]
getSemiDiag [] _ _ = []
getSemiDiag (x:xs) start size = if start > (size -1)
                            then []
                            else (x !! start) : (getSemiDiag xs (start+1) size)

semiRight :: [[Maybe Player]] -> Int -> Int -> [[Maybe Player]]
semiRight [] _ _ = []
semiRight (x:xs) start size = if start > (size -1)
                          then []
                          else (getSemiDiag x start size) : (semiRight xs (start+1) size) 
```

尽管我尽了最大努力，函数 semiRight 仍无法匹配。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T10:01:04.040

仅从类型判断，`x`匹配到类型为 的元素`[Maybe Player]`，

您显然应该将 [x] 而不是 x 传递给 getSemiDiag。此外，有些括号是多余的。

```
semiRight :: [[Maybe Player]] -> Int -> Int -> [[Maybe Player]]
semiRight [] _ _ = []
semiRight (x:xs) start size = if start > (size -1)
                          then []
                          else getSemiDiag [x] start size : semiRight xs (start+1) size 
```

为什么不只使用 zipWith

```
semiRight players start size = zipWith (\p i -> [p !! i]) players [start .. size] 
```

# c# - 使用附加模型自动上传文件

> ID：16071194
> 
> 赞同：2
> 
> 时间：2013-04-17T22:15:58.873
> 
> 标签：c#, automation, httpwebrequest

我有以下 MVC 4 动作

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult SendAttachment(SomeViewModel model, HttpPostedFileBase attachment)
{
    // implementation goes here
} 
```

现在我想通过使用 HttpWebRequest API 将文件从控制台应用程序上传到此控制器操作，但我无法弄清楚如何在我的帖子中设置模型和文件数据，以便与控制器匹配。

有什么提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T09:29:48.107

我对您的问题进行了一些更改（[使用 HTTPWebrequest (multipart/form-data) 上传文件](https://stackoverflow.com/questions/566462/upload-files-with-httpwebrequest-multipart-form-data)）。它对我有用。试试这样：

**服务器端**

```
 [HttpPost]
    public ActionResult SendAttachment(SomeViewModel model, HttpPostedFileBase attachment)
    {
        return View();
    }

    public class SomeViewModel  
    {
        public int Id { get; set; }
        public string Name { get; set; }
    } 
```

**在控制台应用程序中**：

```
static void Main(string[] args)
    {
        UploadData(
            "http://dissertation.lan/Home/SendAttachment",
            new NameValueCollection()
            { 
                {"attachment", @"C:\Users\_____\Desktop\YourFile.xltx"}
            },
            new NameValueCollection() 
            {
                {"Id", "2"},
                {"Name","Man"}
            });
    }

    public static void UploadData(string url, NameValueCollection files, NameValueCollection nvc)
    {
        string boundary = "----------------------------" + DateTime.Now.Ticks.ToString("x");

        HttpWebRequest httpWebRequest2 = (HttpWebRequest)WebRequest.Create(url);
        httpWebRequest2.ContentType = "multipart/form-data; boundary=" + boundary;
        httpWebRequest2.Method = "POST";
        httpWebRequest2.KeepAlive = true;
        httpWebRequest2.Credentials = System.Net.CredentialCache.DefaultCredentials;

        Stream memStream = new System.IO.MemoryStream();

        byte[] boundarybytes = System.Text.Encoding.ASCII.GetBytes("\r\n--" +
        boundary + "\r\n");

        string formdataTemplate = "\r\n--" + boundary +
        "\r\nContent-Disposition: form-data; name=\"{0}\";\r\n\r\n{1}";

        foreach (string key in nvc.Keys)
        {
            string formitem = string.Format(formdataTemplate, key, nvc[key]);
            byte[] formitembytes = System.Text.Encoding.UTF8.GetBytes(formitem);
            memStream.Write(formitembytes, 0, formitembytes.Length);
        }

        memStream.Write(boundarybytes, 0, boundarybytes.Length);

        string headerTemplate = "Content-Disposition: form-data; name=\"{0}\"; filename=\"{1}\"\r\n Content-Type: application/octet-stream\r\n\r\n";

        foreach (string key in files.Keys)
        {
            string header = string.Format(headerTemplate, key, files[key]);
            byte[] headerbytes = System.Text.Encoding.UTF8.GetBytes(header);
            memStream.Write(headerbytes, 0, headerbytes.Length);

            FileStream fileStream = new FileStream(files[key], FileMode.Open,
            FileAccess.Read);
            byte[] buffer = new byte[1024];
            int bytesRead = 0;

            while ((bytesRead = fileStream.Read(buffer, 0, buffer.Length)) != 0)
            {
                memStream.Write(buffer, 0, bytesRead);
            }

            memStream.Write(boundarybytes, 0, boundarybytes.Length);

            fileStream.Close();
        }

        httpWebRequest2.ContentLength = memStream.Length;

        Stream requestStream = httpWebRequest2.GetRequestStream();

        memStream.Position = 0;
        byte[] tempBuffer = new byte[memStream.Length];
        memStream.Read(tempBuffer, 0, tempBuffer.Length);
        memStream.Close();
        requestStream.Write(tempBuffer, 0, tempBuffer.Length);
        requestStream.Close();

        WebResponse webResponse2 = httpWebRequest2.GetResponse();

        Stream stream2 = webResponse2.GetResponseStream();
        StreamReader reader2 = new StreamReader(stream2);

        Console.Write(reader2.ReadToEnd());

        webResponse2.Close();
        httpWebRequest2 = null;
        webResponse2 = null;
    } 
```

**结果** ![在此处输入图像描述](https://i.stack.imgur.com/Y8HgC.png)

![在此处输入图像描述](https://i.stack.imgur.com/7n3Cv.png)

# java - 用其各自的字段 Swing 排列标签

> ID：16071196
> 
> 赞同：3
> 
> 时间：2013-04-17T22:16:06.767
> 
> 标签：java, swing, user-interface

我需要将所有字段与各自的标签对齐，

![在此处输入图像描述](https://i.stack.imgur.com/4pJkM.png)

这是我的代码：

```
 public class Progress extends JPanel implements ActionListener {

 public JLabel ClientIP; JTextField ip;
 JLabel ClientPassword; JTextField pass;
 JLabel Videoname; JTextField vname;
 JLabel perccomplete; JTextField percent;
 JLabel PacketsSent; JTextField pacsent;
 JLabel Connectiontype; JTextField conntype;
 JLabel noofvideossent; JTextField videosend;
 JButton disconnect; JButton refresh;
 JButton ok;

 public Progress() {
 ClientIP = new JLabel("Client's IP:");
 ClientPassword = new JLabel("Clients Password:");
 Videoname = new JLabel("Video being Transfered:");
 perccomplete = new JLabel("% of transfer Complete:");
 PacketsSent = new JLabel("No of Packets sent:");
 Connectiontype = new JLabel("Connection Type:");
 noofvideossent = new JLabel("No of Videos Sent:");
 String Ipad,Ipass,Iselvid;
 if(ClientIPAddr==null || ClientIPAddr.equals("")){
     Ipad="Not Connected";
 }else Ipad=ClientIPAddr.toString();
 if(vFilePassword ==null || vFilePassword.equals("")){
     Ipass="No Password";
 }else Ipass=vFilePassword;
 if(selected_video==null || selected_video.equals("")){
     Iselvid="Not Selected";
 }else Iselvid=selected_video;

 ip = new JTextField(Ipad);
 ip.setColumns(20);
 pass = new JTextField(Ipass);
 pass.setColumns(20);
 vname = new JTextField(Iselvid);
 vname.setColumns(20);
 percent = new JTextField("10%");
 percent.setColumns(20);
 pacsent =new JTextField(String.valueOf(RTSPSeqNb));
 pacsent.setColumns(20);
 String c;
 if(clientConnected==true)
     c="TCP";
 else c="not Connected";
 conntype = new JTextField(c);
 conntype.setColumns(20);
 videosend = new JTextField(String.valueOf(videocount));
 videosend.setColumns(20);

     //Tell accessibility tools about label/textfield pairs.
 ClientIP.setLabelFor(ip);
 ClientPassword.setLabelFor(pass);
 Videoname.setLabelFor(vname);
 perccomplete.setLabelFor(percent);
 PacketsSent.setLabelFor(pacsent);
 Connectiontype.setLabelFor(conntype);
 noofvideossent.setLabelFor(videosend);

 //Lay out the labels in a panel.
    JPanel labelPane = new JPanel(new GridLayout(0,1));
    labelPane.add(ClientIP);
    labelPane.add(ClientPassword);
    labelPane.add(Videoname);
    labelPane.add(perccomplete);
    labelPane.add(PacketsSent);
    labelPane.add(Connectiontype);
    labelPane.add(noofvideossent);

     //Layout the text fields in a panel.
    JPanel fieldPane = new JPanel(new GridLayout(0,1));
    fieldPane.add(ip);
    fieldPane.add(pass);
    fieldPane.add(vname);
    fieldPane.add(percent);
    fieldPane.add(pacsent);
    fieldPane.add(conntype);
    fieldPane.add(videosend);
    //Put the panels in this panel, labels on left,
    //text fields on right.
    //setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));

    JPanel buttonPane = new JPanel(new GridLayout(0,1));
    disconnect = new JButton("Disconnect Client");
    disconnect.setActionCommand("Disconnect");
    disconnect.addActionListener(this);
    refresh = new JButton("Refresh Details");
    refresh.setActionCommand("refresh");
    refresh.addActionListener(this);
    ok = new JButton("OK");
    ok.setActionCommand("ok");
    ok.addActionListener(this);
    buttonPane.add(refresh);
    buttonPane.add(disconnect);
    buttonPane.add(ok);
    add(labelPane, BorderLayout.CENTER);
    add(fieldPane, BorderLayout.LINE_END);
    add(buttonPane, BorderLayout.AFTER_LAST_LINE);
 }

  private void createAndShowGUI() {
    //Create and set up the window.
    frame = new JFrame("Connected Client's Details");
    //frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    //Add contents to the window.
    frame.add(new Progress());
    //Display the window.
    frame.pack();
    frame.setVisible(true);
} 
```

我尝试通过引用它来实现它，但它不起作用，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:23:48.343

查看给出的示例[`GroupLayout`](http://docs.oracle.com/javase/6/docs/api/javax/swing/GroupLayout.html)（来自链接的图片）：

![在此处输入图像描述](https://i.stack.imgur.com/hWThx.png)

您的代码应该与链接中的代码非常相似。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:27:19.943

根据经验，**永远不要**扩展`JPanel`/`JFrame`除非你**真的**在扩展它们的功能，总是 [倾向于组合而不是继承](http://en.wikipedia.org/wiki/Composition_over_inheritance)。

对于一个 swing 布局管理器，我强烈推荐[miglayout](http://www.miglayout.com/)，简单[易上手](http://www.migcalendar.com/miglayout/mavensite/docs/whitepaper.html)，你必须下载**[jar](http://www.migcalendar.com/miglayout/versions/4.0/miglayout-4.0-swing.jar)**并将其添加到你的`CLASSPATH`.

**制作此GUI**原型的完整代码

 **![在此处输入图像描述](https://i.stack.imgur.com/QFVYE.png)

将很简单：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import net.miginfocom.swing.MigLayout;

/**
 * Hello world!
 *
 */
public class App {

    private JPanel panel;

    private JLabel cilentIPLabel= new JLabel();
    private JLabel clientPWLabel= new JLabel();
    private JTextField clientIPTextField= new JTextField();
    private JTextField clientPWTextField= new JTextField();
    private JButton printButton = new JButton();

    public App() {
        initComponents();
    }

    private void initComponents() {
        cilentIPLabel.setText("Client IP :");
        clientPWLabel.setText("Client Password :");
        printButton.setText("print");
        printButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {        
                System.out.println("The ID of the clinet is " + clientIPTextField.getText());
            }
        });
    }

    public JPanel getPanel() {

        if (panel == null) {
            panel= new JPanel(new MigLayout("gap 10","[100]10[100, left, fill, grow]","[][]20[]"));
            panel.add(cilentIPLabel);
            panel.add(clientIPTextField, "wrap");
            panel.add(clientPWLabel);
            panel.add(clientPWTextField, "wrap");
            panel.add(printButton, "skip, tag apply");
        }
        return panel;       
    }

    public static void main(String[] args) {
        JFrame frame= new JFrame("SO demo");
        frame.setSize(400, 150);
        frame.setContentPane(new App().getPanel());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T08:56:32.207

几个选项：

*   `GroupLayout`，[这里](https://stackoverflow.com/a/14858272/230513)和[这里都有](https://stackoverflow.com/a/16071284/230513)说明。

*   `BoxLayout`，显示[在这里](https://stackoverflow.com/a/3175280/230513)。

*   `JTable`，在[这里](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)讨论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-31T22:56:15.767

使标签及其相应字段正确排列的唯一可靠方法是将它们放在同一个面板中并使用布局管理器的单个实例来排列它们。

**网格布局**

最简单的方法是使用两列网格布局：

```
JPanel fieldPane = new JPanel(new GridLayout(0, 2));
fieldPane.add(ClientIP);
fieldPane.add(ip);
fieldPane.add(ClientPassword);
fieldPane.add(pass);
fieldPane.add(Videoname);
fieldPane.add(vname);
fieldPane.add(perccomplete);
fieldPane.add(percent);
fieldPane.add(PacketsSent);
fieldPane.add(pacsent);
fieldPane.add(Connectiontype);
fieldPane.add(conntype);
fieldPane.add(noofvideossent);
fieldPane.add(videosend); 
```

这具有一个缺点，即所有单元的大小都相同。具体来说，所有标签单元格将与字段单元格具有相同的宽度。在这种特定情况下，这可能无关紧要，但在更一般的情况下，您可能希望使用不同的布局，允许第一列保持窄，并将所有剩余宽度提供给第二列。

**网格包布局**

这是我使用 GridBagLayout 的方法：

```
JPanel fieldPane = new JPanel(new GridBagLayout());
Insets insets = new Insets(2, 2, 2, 2);
GridBagConstraints label = new GridBagConstraints(
    0, 0, 1, 1, 0.0, 0.0,
    GridBagConstraints.BASELINE_LEADING, GridBagConstraints.NONE,
    insets, 2, 2);
GridBagConstraints value = new GridBagConstraints(
    1, 0, 1, 1, 0.0, 0.0,
    GridBagConstraints.BASELINE_LEADING, GridBagConstraints.HORIZONTAL,
    insets, 2, 2);
fieldPane.add(ClientIP, label);
fieldPane.add(ip, value);
label.gridy++;
value.gridy++;
fieldPane.add(ClientPassword, label);
fieldPane.add(pass, value);
label.gridy++;
value.gridy++;
fieldPane.add(Videoname, label);
fieldPane.add(vname, value);
label.gridy++;
value.gridy++;
fieldPane.add(perccomplete, label);
fieldPane.add(percent, value);
label.gridy++;
value.gridy++;
fieldPane.add(PacketsSent, label);
fieldPane.add(pacsent, value);
label.gridy++;
value.gridy++;
fieldPane.add(Connectiontype, label);
fieldPane.add(conntype, value);
label.gridy++;
value.gridy++;
fieldPane.add(noofvideossent, label);
fieldPane.add(videosend, value); 
```

因为我经常使用 GridBagLayout，所以我将 GridBagConstraints 子类化以使我的生活更轻松一些。我的子类除其他外具有以下方法：

```
public SuperGBC at(int x, int y) {
    gridx = x;
    gridy = y;
    return this;
} 
```

它具有类似的方法`anchor()`，`fill()`并且`insets()`无需指定所有值即可进行自身初始化。这使得上面的代码更加紧凑：

```
JPanel fieldPane = new JPanel(new GridBagLayout());
Insets insets = new Insets(2, 2, 2, 2);
SuperGBC label = new SuperGBC()
    .anchor(SuperGBC.BASELINE_LEADING)
    .insets(insets);
SuperGBC value = new SuperGBC()
    .anchor(SuperGBC.BASELINE_LEADING)
    .insets(insets)
    .fill(GridBagConstraints.HORIZONTAL, 0.0, 0.0);
fieldPane.add(ClientIP, label.at(0, 0));
fieldPane.add(ip, value.at(1, 0));
fieldPane.add(ClientPassword, label.at(0, 1));
fieldPane.add(pass, value.at(1, 1));
fieldPane.add(Videoname, label.at(0, 2));
fieldPane.add(vname, value.at(1, 2));
fieldPane.add(perccomplete, label.at(0, 3));
fieldPane.add(percent, value.at(1, 3));
fieldPane.add(PacketsSent, label.at(0, 4));
fieldPane.add(pacsent, value.at(1, 4));
fieldPane.add(Connectiontype, label.at(0, 5));
fieldPane.add(conntype, value.at(1, 5));
fieldPane.add(noofvideossent, label.at(0, 6));
fieldPane.add(videosend, value.at(1, 6)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T10:51:25.067

非常感谢你的帮助。我修改了代码如下，它工作..

```
GroupLayout layout = new GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setAutoCreateGaps(true);
         layout.setAutoCreateContainerGaps(true);

         // Turn on automatically creating gaps between components that touch
         // the edge of the container and the container.
         layout.setAutoCreateContainerGaps(true);

         GroupLayout.SequentialGroup hGroup = layout.createSequentialGroup();
         hGroup.addGroup(layout.createParallelGroup(Alignment.LEADING).
                 addComponent(ClientIP).addComponent(ClientPassword).addComponent(Videoname).addComponent(perccomplete).addComponent(PacketsSent).addComponent(Connectiontype).addComponent(noofvideossent));

         hGroup.addGroup(layout.createParallelGroup(Alignment.LEADING).
                 addComponent(ip).addComponent(pass).addComponent(vname).addComponent(percent).
                 addComponent(pacsent).addComponent(conntype).addComponent(videosend).addComponent(disconnect).addComponent(refresh).addComponent(ok));
         layout.setHorizontalGroup(hGroup);

         GroupLayout.SequentialGroup vGroup = layout.createSequentialGroup();

         vGroup.addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(ClientIP).addComponent(ip)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(ClientPassword).addComponent(pass)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(Videoname).addComponent(vname)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(perccomplete).addComponent(percent)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(PacketsSent).addComponent(pacsent)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(Connectiontype).addComponent(conntype)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(noofvideossent).addComponent(videosend));

         vGroup.addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(disconnect)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(refresh)).addGroup(layout.createParallelGroup(Alignment.LEADING).addComponent(ok));
         layout.setVerticalGroup(vGroup); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-05T11:27:14.910

经过一些发现 - MigLayout 看起来是我的最佳选择

代码如下：

```
JPanel parentPanel = new JPanel(new MigLayout("wrap 2")); //Autowrap after each 2 elements
parentPanel.add(label1);
parentPanel.add(field1);
parentPanel.add(label2);
parentPanel.add(field2);
... 
```

无需手动指定索引或创建一些巨大的布局基础设施 - 简单的代码即可获得概念上简单的结果。请参阅快速入门指南： http: [//www.miglayout.com/QuickStart.pdf](http://www.miglayout.com/QuickStart.pdf)

您可以将其插入或直接从 Maven 下载：[https ://mvnrepository.com/artifact/com.miglayout/miglayout](https://mvnrepository.com/artifact/com.miglayout/miglayout)**

# javascript - 为什么javascript在添加时会将对象更改为其他东西？

> ID：16071197
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:16:06.943
> 
> 标签：javascript

有人向我指出了在 javascript 中添加空数组的一些有趣的事情，但我不知道为什么它会以这种方式工作。

添加空数组会生成一个字符串。

换句话说，`[] + []`回报`""`

我启动了我的控制台来测试它，果然，它可以工作。我进一步发现，这种行为不仅限于空数组。数字、字符串、数组和对象的数组在添加到任何其他数组时都会变成字符串。一些例子是：

```
[1] + [] //returns "1"
[1] + [2] //returns "12"
[1,2,3] + [2] //returns "1,2,32"
[{foo:'bar'},'foo','bar'] + [] //returns "[object Object],foo,bar" 
```

当添加到任何其他对象时，它也会与其他对象一起发生，但前提是该对象位于右侧。如果它在左侧，则对象变为 0。

```
'foo' + {foo:'bar'} //returns "foo[object Object]"
1 + {foo:'bar'} //returns "1[object Object]"
{foo:'bar'} + 1 //returns 1
{foo:'bar'} + 'foo' //returns NaN 
```

除非我将对象分配给变量，否则会发生这种情况。如果我使用`X = {foo:'bar'}`，

```
X + 'foo' //returns "[object Object]foo" 
```

物体又变回了字符串。

我可以理解为什么这种类型的转换可能会发生在`==`运算符中，但是为什么加法会这样做呢？为什么加法会将数组和对象（是的，我知道数组也是对象）变成其他东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T22:22:09.097

该运算符仅用于添加数字或连接字符串，如果您将其与其他类型一起使用，它们将根据情况转换为数字或字符串（这部分实际上有点复杂......）。

从[语言规范](http://www.ecma-international.org/ecma-262/5.1/#sec-11.6.1)：

> 加法运算符执行字符串连接或数字加法。

至于*为什么要*这样设计语言，我们只能猜测，但 Shadow Creeper 在他的回答中给出了一个合理的理由：它在每种不同类型上的行为都有多种可能性，因此可能会令人困惑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:20:32.447

这称为类型强制，这就是 JavaScript 的编写方式。我建议您阅读以下内容，以获得清晰的图片：[http ://blog.jeremymartin.name/2008/03/understanding-loose-typing-in.html](http://blog.jeremymartin.name/2008/03/understanding-loose-typing-in.html)

因此，您应避免使用非类型安全的等式运算符，即`==`and `!=`。您应尽可能使用`===`和`!==`强制类型转换（`parseInt()`等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T22:23:57.310

尝试执行（ [1,2,3] + [1,2,3] ）是模棱两可的。它应该导致 [1,2,3,1,2,3] 或 [2,4,6] 还是字符串值“[1,2,3][1,2,3]”？

Javascript 尝试以它认为有意义的方式转换事物。有关这方面的一些解释，请参见[http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/](http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/)

# ruby-on-rails - Rails 生产模式“结束”错误？

> ID：16071202
> 
> 赞同：0
> 
> 时间：2013-04-17T22:16:41.883
> 
> 标签：ruby-on-rails, cloud-foundry, production-environment

我一直在尝试将我的项目放在 Cloud Foundry 上一段时间，最终将我的问题缩小到这个项目进入生产模式。在从开发模式切换到生产模式时出现的所有错误中，我设法得到了一个“意外结束”错误。罪魁祸首在控制器中，如下所示：

```
 companiesController < ApplicationController
  skip_before_filter :require_login
  end
   #def new 
```

在这部分代码下面有很多注释，但没有别的。skip_before_filter 指的是应用程序控制器中的前置过滤器，如下所示：

```
 class ApplicationController < ActionController::Base
  protect_from_forgery
  include SessionsHelper    

  before_filter :require_login

 def current_company
   Company.find_by_subdomain! request.subdomain
 end
 helper_method :current_company

 def scope_current_company
   Company.current_id = current_company.id
   yield
 ensure
   Company.current_id = nil
 end

def require_login
  if current_user == nil
    flash[:failure] = "You must log in to access that resource"
     redirect_to signin_path
   end
 end
end 
```

为了完整起见，我还应该提到这个应用程序还包括基于子域的多租户。子域基于数据库中的租户表。我这样说只是为了消除对我的代码的任何困惑，但如果它以某种方式有助于阐明这个问题，那也很棒！目前我已经删除了对多租户和子域的所有引用，只是想让这个项目进入生产模式，所以不应该影响它。

确切的错误状态是您在显示的代码中的平均“意外关键字_end，在公司控制器中期望$end”的单端。但这对我来说没有任何意义，我的意思是它需要在那里结束。为什么它会抱怨超出我的范围......

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:41:54.023

这真的是代码`CompaniesController`吗？你知道这个类应该这样定义吗？

```
class CompaniesController < ApplicationController
  skip_before_filter :require_login
end 
```

此外，如果您正在使用 Rails 进行多租户操作，您可能需要查看我的相关书籍：[Multitenancy with Rails](https://leanpub.com/multi-tenancy-rails)。

# c++ - 意外的垃圾值

> ID：16071204
> 
> 赞同：1
> 
> 时间：2013-04-17T22:17:13.243
> 
> 标签：c++, variables, memory

出于某种原因，我在分配了初始化的变量上得到了意外的垃圾值。

```
#include <curses.h>
#include <sys/time.h>
#include <time.h>
#include "fmttime.h"                    // Include for formattime interface
#include <strstream>
#include <iostream>
#include <iomanip>

static int monthindex;                  // Lookup table index
static const int milli = 1000;          // Constant value for ms conversion
static const int epochyear = 1970;      // Epoch year 1970
static const int leapy = 4;             // Number of years for a leapyear
using namespace std;

struct Monthpairs                       // Fields for month & day lookup table
{
    const char* mon;                    // Months
    int day;                            // Days
};

Monthpairs months[] =                   // Lookup table for months & days
{
    {"Jan", 31},
    {"Feb", 28},
    {"Mar", 31},
    {"Apr", 30},
    {"May", 31},
    {"Jun", 30},
    {"Jul", 31},
    {"Aug", 31},
    {"Sep", 30},
    {"Oct", 31},
    {"Nov", 30},
    {"Dec", 31},
};

// Structure which will contain the human readable local
// time values
struct ExpandedTime
{
    int et_usec;        // Number of Milliseconds local time
    int et_sec;         // Number of Seconds local time
    int et_min;         // Number of minutes local time
    int et_hour;        // Number of hours local time
    int et_day;         // Day of the month local time
    int et_mon;         // Month of the year local time
    int et_year;        // Our current year (2013 present)
};

// Function prototype for Expanded time function
ExpandedTime* localTime(struct timeval* tv, ExpandedTime* etime);

// Expanded time will take the Epoch time and convert into days,
// months years, hours, minutes etc and then store this back into
// the Expanded Structure

ExpandedTime* localTime(
                        struct timeval* tv,     // Pointer to timeval struct
                        ExpandedTime* etime     // '' '' to expandedtime strct
                        )
{
    tzset();                                    // Corrects for timezone

    int epochT = (tv->tv_sec) - timezone;       // Epoch seconds with
    int epochUT = tv->tv_usec;                  // epochtime microseconds
    int edays;                                  // Days since epochtime
    int days4years = 1460;                      // Number of days in 4 years
    int fouryears;                              // Number of 4 year periods
    int remaindays;                             // Number of days leftover
    int tempdays;                               // Holds value of remaindays

    int monthtracker = 0;                       // Number of TOTAL months passed
                                                // since current 4 year period
    int daysgoneby = 0;                         // Number of days passed
                                                // since current 4 year period

    etime->et_usec = (epochUT/milli) % milli;   // Find the milliseconds
    etime->et_sec = epochT % 60;
    epochT /= 60;                               // Turn into minutes

    etime->et_min = epochT % 60;
    epochT /= 60;                               // Turn into hours

    if (localtime(&tv->tv_sec)->tm_isdst !=0)
        etime->et_hour = (epochT % 24) + 1;     // Hours with DST correction
    else
        etime->et_hour = (epochT % 24);

    edays = tv->tv_sec / 86400;                 // Turn into days since epoch

    fouryears = edays / days4years;
    remaindays = edays % days4years;            // Determines which 4 year perio
    tempdays = remaindays;

    for (monthindex = 0 ; tempdays >= 0 ; ++monthindex)
    {
        daysgoneby += months[monthindex].day;   // Keeps track of days passed

        tempdays -= months[monthindex].day;

        if (monthindex >= 11)                   // Resets counter for 12 months
        {
            monthindex = 0;
        }
        ++monthtracker;
    }

    etime->et_day = monthindex; // (tempdays + months[monthindex].day);

    // This will take the number of months passed in current 4 year period
    // and add it to the epoch year of 1970 to find the current year

    etime->et_year = (monthtracker / 12)  + (fouryears * 4) + epochyear;

    return etime;
}

// Formats epoch time passed from a main function to a
// human readable string
char* formatTime(
                 struct timeval* tv,     // Pointer to timeval struct
                 char* buf,              // Pointer to char buf
                 size_t len              // size of buffer
                 )
{
    struct ExpandedTime etime2;         // Struct object declaration

    if (len > 0)                        // Will only print to valid sized buffer
    {
        localTime(tv, &etime2);
        ostrstream oss(buf, len);

        // Prints the time and date into a human readable string and
        // places it in the supplied buffer from plot.cc

        oss << etime2.et_year << " " <<  months[monthindex].mon << " " <<
        etime2.et_day << " " << setw(2) << etime2.et_hour << ":"
        << setfill('0') << setw(2) << etime2.et_min << ":" << setfill('0')
        << setw(2) << etime2.et_sec << ":" << setfill('0') << setw(3) <<
         etime2.et_usec << ends;
    }

    else if (len <= 0)
    {
        cout << "Sorry the length of the buffer is too small cannot write" << en
    }

    return buf;
} 
```

例如，基本上 tempday 正在评估一些较大的负值 -185338583。即使将其分配给初始值 1212，也没有理由将 tempdays 置于这个数量级范围内。我假设我必须对程序的内存分配做了什么？这是我无法弄清楚的事情。

我会说最初我有这段代码，然后将 for 循环更改为 while 循环。然后我将它改回完全相同的 for 循环，这就是 tempdays 开始变得奇怪的时候。我的假设是 tempdays 正在输出某种垃圾值……我不知道为什么。

# forms - 带参数的 JSP 表单提交 URL

> ID：16071205
> 
> 赞同：0
> 
> 时间：2013-04-17T22:17:24.380
> 
> 标签：forms, jsp, servlets, redirect

我正在 Web 应用程序上使用纯 JSP（JSF 不是一个选项）。在 JSP 文件中，我有一个表格，在每一行中我显示每个学生。此外，在每一行中，我都希望有一个“编辑”按钮，它将重定向到我们可以编辑该学生并将其删除的页面。

到目前为止，我认为最好的办法是在每行中放置一个只有一个按钮的可提交表单。

```
<table border="1">
    <tr>
        <th>Name</th>
        <th>LastName</th>
        <th>Send Message</th>
        <th>Erase</th>
    </tr>
    <c:forEach items="${students}" var="bean">
        <tr>
            <td>${bean.name }</td>
            <td>${bean.lastName }</td>
            <td><input type="button" name="edit" value="Do!"
                onclick="foo();" /></td>
            <td><form action="<%="EditStudent?studentid=6" %>"><input type="submit" value="Edit" /></form></td>
        </tr>
    </c:forEach>
</table> 
```

表单提交 URL 仅用于测试，因此硬编码的“6”参数作为学生 ID。但是，当我按下按钮时，我会被重定向到带有 URL 的页面`"http://localhost:8080/JSPProj/EditStudent?"`，在那里我可以清楚地看到问号后面的任何文本都被忽略了！如果我删除问号，则 URL 重定向有效（但无法将我想要的参数传递给下一个 servlet）。

谁能告诉我为什么会发生这种情况？

PS。我也试过EL，同样的事情发生了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:36:43.030

首先，您应该指定您的 method=get 或 method=post。但这只是我的吹毛求疵。问题是这样的：不要把你的 ? 和操作 url 中的参数。将您的参数放在输入标签中。

```
<form action='EditStudent'>
<input type='hidden' name='studentid' id='studentid' value='6' />
<input type='submit' value='Edit' />
</form> 
```

编辑：实际上 GET 与 POST 并没有挑剔。我这么说有点轻率。这很重要。默认情况下，浏览器会将其视为 GET，这意味着参数将在地址栏中可见，并且可以由最简单的用户轻松更改。使用 POST 至少需要更复杂的操作。尽管很明显，您不应该依赖可公开查看的 HTML 来确保您的安全。

Input Type='Hidden' 并不意味着用户在查看源代码时看不到它，显然，只是没有文本框放在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:27:57.357

**1）**首先，您不应该在给定的上下文中使用表单操作，因为在这种情况下使用 POST 方法是不合逻辑的。

**2）**你不应该在jsp表达式语言中使用静态内容。`ie: action="<%="EditStudent?studentid=6" %>"`

**3)**在给定的情况下，您需要`<a>`为每个列出的学生使用并根据他们的 ID 将他们重定向到一个 servlet。而这种方法将使用`GET`方法。

**这是你应该做的** `<a href="EditStudent?studentid=${bean.studentID}"> click me </a>`

问候，

# awk - 根据公共行前缀将文件拆分为多个文件

> ID：16071207
> 
> 赞同：0
> 
> 时间：2013-04-17T22:17:37.147
> 
> 标签：awk

假设我有一个格式如下的文件。

```
prefix1: line 1
prefix1: line 2
prefix1: line 3
prefix2: line 4

prefix2: line 5
prefix3: line 6

prefix3: line 7
prefix3: line 8
prefix3: line 9
prefix3: line 10 
```

我想将其拆分为三个文件，名称分别为`prefix1`, `prefix2`, `prefix3`, 换行符作为完全包含它们的文件的一部分。

**在真实文件中，可能有`n`前缀，而不仅仅是 3。**

我可以编写一个 python 脚本来直接实现该功能，但我想知道在`awk`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:24:17.177

这个单线适用于这项工作：

```
 awk -F: '{f=$1?$1:f; print > f}' file 
```

用你的例子：

```
kent$  cat file
prefix1: line 1
prefix1: line 2
prefix1: line 3
prefix2: line 4

prefix2: line 5
prefix3: line 6

prefix3: line 7
prefix3: line 8
prefix3: line 9
prefix3: line 10

kent$  awk -F: '{f=$1?$1:f; print > f}' file

kent$  head prefix*
==> prefix1 <==
prefix1: line 1
prefix1: line 2
prefix1: line 3

==> prefix2 <==
prefix2: line 4

prefix2: line 5

==> prefix3 <==
prefix3: line 6

prefix3: line 7
prefix3: line 8
prefix3: line 9
prefix3: line 10 
```

你提到了**n 个**前缀。如果 N 足够大，上面的 awk 行可能会失败，例如“打开了太多文件”。为了解决这个问题，我们可以在写入/追加文本后关闭文件。

也就是说，该行可能是：

```
awk -F: '{f=$1?$1:f; print >> f; close(f)}' file 
```

无论您的输入文件是否按前缀排序，此行都有效。

# ruby-on-rails - 一个简单的 Rails 应用程序的 Heroku “我们很抱歉，但出了点问题”

> ID：16071208
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:17:40.100
> 
> 标签：ruby-on-rails, heroku

这是我第一次使用 Heroku，所以我真的不知道错误是什么意思。我基本上使用 rails 和 bootstrap 来创建一个站点（只有链接，没有动态特性）。

```
 ←[36m2013-04-17T21:47:59.413491+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
 ←[36m2013-04-17T21:47:59.413491+00:00 app[web.1]:←[0m   from script/rails:6:in `require'
 ←[36m2013-04-17T21:47:59.413491+00:00 app[web.1]:←[0m   from script/rails:6:in `<main>'
 ←[36m2013-04-17T21:47:59.413199+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands/server.rb:59:in `start'
 ←[36m2013-04-17T21:47:59.419753+00:00 app[web.1]:←[0m Exiting
 ←[36m2013-04-17T21:48:00.637162+00:00 heroku[web.1]:←[0m Process exited with status 1
 ←[36m2013-04-17T21:48:00.653135+00:00 heroku[web.1]:←[0m State changed from starting to crashed
 ←[36m2013-04-17T21:48:04.188831+00:00 heroku[web.1]:←[0m Error R12 (Exit timeout) -> At least one process failed to exit within 10 seconds of SIGTERM
 ←[36m2013-04-17T21:48:04.188831+00:00 heroku[web.1]:←[0m Stopping remaining processes with SIGKILL
 ←[36m2013-04-17T21:48:06.652384+00:00 heroku[web.1]:←[0m Process exited with status 137
 ←[33m2013-04-17T21:49:24.968073+00:00 heroku[router]:←[0m at=error code=H10 desc="App crashed" method=GET path=/ host=nameless-peak-6062.herokuapp.com fwd="142.151.192.92" dyno= connect= service= status=503 bytes=
 ←[33m2013-04-17T21:49:25.931067+00:00 heroku[router]:←[0m at=error code=H10 desc="App crashed" method=GET path=/favicon.ico host=nameless-peak-6062.herokuapp.com fwd="142.151.192.92" dyno= connect= service= status=503 bytes=
 ←[33m2013-04-17T21:49:26.628879+00:00 heroku[router]:←[0m at=error code=H10 desc="App crashed" method=GET path=/favicon.ico host=nameless-peak-6062.herokuapp.com fwd="142.151.192.92" dyno= connect= service= status=503 bytes=
 ←[33m2013-04-17T21:49:27.165454+00:00 heroku[router]:←[0m at=error code=H10 desc="App crashed" method=GET path=/favicon.ico host=nameless-peak-6062.herokuapp.com fwd="142.151.192.92" dyno= connect= service= status=503 bytes=
 ←[33m2013-04-17T21:49:27.135930+00:00 heroku[router]:←[0m at=error code=H10 desc="App crashed" method=GET path=/favicon.ico host=nameless-peak-6062.herokuapp.com fwd="142.151.192.92" dyno= connect= service= status=503 bytes=
 ←[33m2013-04-17T21:49:30.949503+00:00 heroku[router]:←[0m at=error code=H10 desc="App crashed" method=GET path=/favicon.ico host=nameless-peak-6062.herokuapp.com fwd="142.151.192.92" dyno= connect= service= status=503 bytes=
 ←[32m2013-04-17T21:56:36.018416+00:00 heroku[slugc]:←[0m Slug compilation started
 ←[35m2013-04-17T21:57:33.471063+00:00 heroku[api]:←[0m Release v10 created by john.yeung628@gmail.com
 ←[35m2013-04-17T21:57:33.549837+00:00 heroku[api]:←[0m Deploy bf28903 by john.yeung628@gmail.com
 ←[36m2013-04-17T21:57:33.644790+00:00 heroku[web.1]:←[0m State changed from crashed to starting
 ←[32m2013-04-17T21:57:34.367363+00:00 heroku[slugc]:←[0m Slug compilation finished
 ←[36m2013-04-17T21:57:35.689891+00:00 heroku[web.1]:←[0m Starting process with command `bundle exec rails server thin -p 16004 -e $RACK_ENV`
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler/thin.rb:1:in `require': cannot load such file -- thin (LoadError)
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:20:in `const_get'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/server.rb:272:in `server'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands/server.rb:59:in `start'
 ←[36m2013-04-17T21:57:37.504825+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `tap'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler/thin.rb:1:in `<top (required)>'
 ←[36m2013-04-17T21:57:37.504825+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:50:in `<top (required)>'
 ←[36m2013-04-17T21:57:37.504825+00:00 app[web.1]:←[0m   from script/rails:6:in `<main>'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:20:in `block in get'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:20:in `get'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/railties-3.2.1/lib/rails/commands.rb:55:in `block in <top (required)>'
 ←[36m2013-04-17T21:57:37.504825+00:00 app[web.1]:←[0m   from script/rails:6:in `require'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:20:in `each'
 ←[36m2013-04-17T21:57:37.504415+00:00 app[web.1]:←[0m   from /app/vendor/bundle/ruby/1.9.1/gems/rack-1.4.5/lib/rack/handler.rb:20:in `inject'
 ←[36m2013-04-17T21:57:37.509475+00:00 app[web.1]:←[0m Exiting 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:26:54.610

那是相当难以理解的混乱。但据我所知，真正说明问题的行似乎是这样的：

```
9.1/gems/rack-1.4.5/lib/rack/handler/thin.rb:1:in `require': cannot load such fi
le -- thin (LoadError) 
```

您是否已添加`thin`到您的`:production`组中`Gemfile`？

```
group :production do
  gem 'thin'
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:27:57.337

所以在安装 gem 'thin' 之后，还是有问题。显然我`config.assets.compile`在 config/environments/production.rb 中设置为 false 现在它正在工作:) 非常感谢大家！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:26:29.900

添加到您的 Gemfile：

```
gem 'thin' 
```

# java - 如何在 Java Singleton 中维护可变状态

> ID：16071209
> 
> 赞同：3
> 
> 时间：2013-04-17T22:17:42.927
> 
> 标签：java, synchronization, singleton, osgi

我有一个 Java 中的 Singelton（在 OSGi 服务中），并希望在其中维护一些状态（计数器）。

这个变量应该是静态的吗？或同步？或两者？

或者我应该将动作包装在同步方法中？（这与仅使 var 同步有什么不同吗？）

我希望服务操作的消费者增加这个计数器。

```
public MyServiceImpl implements MyService {
    private int count = 0; // static? syncronized?

    public String helloWorld() { count++; return "Hello World"; }
    public int getHelloCount() { return count; }
} 
```

更新：我怎么会像地图或列表这样的东西？是否也更喜欢使用这些的原子版本？或者同步更好？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T07:02:05.827

单例的问题是它们需要一个*范围*。如果您在 OSGi 中注册服务，那么这是框架中的单例。然而，由于 OSGi 避免了像瘟疫这样的静态问题，人们可以在同一个 VM 中启动多个框架（嵌套或作为兄弟），这可能意味着您的服务在不同的框架中被多次注册。一般来说，这正是您想要的。如果这还不够单例，那么范围应该是什么？虚拟机、进程、机器、网络、世界？人们为您提供的创建单例的所有技巧都忘记告诉您它们的范围仅适用于您碰巧所在的类加载器。

在 OSGi 中，假设您的范围是框架。所以只需注册一个服务并使用实例变量。由于 OSGi 在并发环境中运行，因此正如所有其他帖子所指出的那样，您必须使用同步方法或更好的 AtomicLong/AtomicInteger。

如果您有多个服务需要共享一个单例，只需创建一个额外的服务来表示单例。

永远不要使用静态变量，因为它们会显着降低代码的可重用性，它们具有全局变量的所有弊端。纯 OSGi 的优点之一是它允许您几乎完全使用实例进行编程，而不必使用静态和类名（它们遭受相同的全局变量问题）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T22:58:02.643

这是使用 Atomics 的绝佳机会：

```
public class MyServiceImpl {
  private AtomicInteger helloCount = new AtomicInteger(0);

  public String helloWorld() {
    helloCount.incrementAndGet();
    return "Hello World";
  }

  public int getHelloCount() {
    return helloCount.get();
  }
} 
```

这是无锁的，因此通常更快、更有效。

这种机制同样适用于单例或非单例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T00:45:10.323

**如果您只注册一次普通的 OSGi 服务，那么它就是该框架中的单例。** 如果您使用的是声明式服务，那么默认情况下会发生这种情况。

正常我的意思是不是由服务工厂创建的。框架位也很重要，一些供应商在单个 JVM 中支持多个框架。

不要使用静态 - 这不是*OSGi 方式*:-)

您关心的只是并发访问，因此正如其他人所评论的那样，类似的东西`AtomicLong`是合适的。

注意溢出 - 你希望你的计数器达到`Long.MAX_VALUE`（> 9,223,372,036,854,775,807）吗？否则你最终会看到负数。

# javascript - 使用来自 Web Worker 的可传输对象

> ID：16071211
> 
> 赞同：37
> 
> 时间：2013-04-17T22:17:50.617
> 
> 标签：javascript, web-worker, transferable

我目前有这个代码来创建一个 Web Worker：

```
w = new Worker("webwork.js");
w.onmessage = function(event) { alert(event.data); } 
```

然后`webwork.js`是 Web Worker 的代码：

```
self.onmessage = function(event) {
    //var ss=r;  //Causes error because of undefined
    var ss="";
    for(var currProp in event) {
        ss+=("event."+currProp+"="+event[currProp]+"\n");
    }
    postMessage(ss);
} 
```

现在我想`ArrayBuffer`使用以下代码传输 128 兆字节：

```
var r = new ArrayBuffer(1048576*128);
w.postMessage(0, [r]); 
```

* * *

现在我应该已经转移了变量`r`，我如何从 Web Worker 本身访问它。我已经尝试过, `event.r`just和其他方法，例如尝试为 的数组添加第二个函数参数，但没有任何效果。`r``self.r``ArrayBuffers`

如何从 Web Worker 访问传输的变量？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-05-27T05:24:08.543

sbr 给出的答案有效，但它会导致在发送给工作人员之前制作数据副本。对于大量数据，这可能会很慢。
要使用“可转让对象”，您实际上将对象的所有权转移到网络工作者或从网络工作者转移。这就像在没有复制的地方通过引用传递。它与普通的 pass-by-reference 的区别在于传输数据的一方不能再访问它。

我相信您应该在示例中发送数据的方式是：

```
w.postMessage(r,[r]);  // first arg is r, not 0 as in the question 
```

以及您在网络工作者中访问它的方式：

```
addEventListener('message', function(event) {
    var r = event.data;
}); 
```

* * *

在我自己的应用程序中，我需要将一个大型类型的 Float64Array 从 web worker 发送到主线程，而不会影响副本的性能。它需要大量的反复试验和搜索，所以我认为我应该在此处为遇到类似问题的其他人提供该示例。
这是在工作人员端工作的代码（arr 是我的 Float64Array）：

```
self.postMessage(arr.buffer, [arr.buffer]); 
```

在接收主线程上，我有：

```
theWorker.addEventListener('message', function(ev) {
    var arr = new Float64Array(ev.data);  // just cast it to the desired type - no copy made
    // ...
}); 
```

请注意，这在 Chrome 中有效，但到目前为止可能不适用于大多数其他浏览器（尚未尝试过。）

此外，如果您想发送除大数组之外的其他信息，您可以这样做：

```
self.postMessage({foo:"foo", bar:arr.buffer}, [arr.buffer]); 
```

在接收（在本例中为主）线程上：

```
theWorker.addEventListener('message', function(event) {
    var foo = event.data.foo;
    var arr = new Float64Array(event.data.bar);  // cast it to the desired type
    // ...
}); 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2013-06-01T17:50:10.420

```
PostMesage(aMessage, transferList) 
```

在`transferList`您必须指定可转移对象，其中包含`aMessage`：

```
var objData =
{
    str: "string",
    ab: new ArrayBuffer(100),
    i8: new Int8Array(200)
};
objWorker.postMessage(objData, [objData.ab, objData.i8.buffer]); 
```

另一方面：

```
self.onmessage = function(objEvent)
{
    var strText = objEvent.data.str;
    var objTypedArray = objEvent.data.ab;
    var objTypedArrayView = objEvent.data.i8;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-12T15:46:33.057

试试 w.postMessage([0,r])。要使用可转移对象，需要将数组缓冲区作为数组的第二项传递。看到[这个](http://www.w3.org/TR/workers/#communicating-with-a-dedicated-worker)

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2013-05-22T21:40:24.370

这对我有用：

//在主

```
var x = new ArrayBuffer(1048576*128);
w.postMessage({buffer: x}); 
```

// 在工作线程中，在消息处理程序中，

```
processMessage: function(ev){
    var buffer = ev.data.buffer,
    // other stuff . buffer is referenced correctly here. 
} 
```

# android - Android Java 服务和定时器/线程休眠

> ID：16071214
> 
> 赞同：1
> 
> 时间：2013-04-17T22:18:22.293
> 
> 标签：android, service, timer, sleep, intentservice

基本上，我需要编写的代码很简单，但由于我是初学者，我仍然对 Service、IntentService、创建与主 Activity/UI 线程分开的新线程等感到困惑。我将首先解释 Task 和那么，我认为这可能是最好的实现方式。

**任务**

Main Activity/UI 有两个按钮，Start 和 Stop。应用程序应该循环两个任务，TaskA 和 TaskB。当按下开始时，循环被执行。这个循环里面有这些步骤——

1.  Main Activity 的 UI 上的更新状态：“TaskA execution in 60 seconds”
2.  等待 60 秒
3.  更新状态...：“TaskA Executing”
4.  执行任务A
5.  更新状态...：“TaskB 在 120 秒内执行”
6.  等待 120 秒
7.  更新状态...：“TaskB 正在执行”
8.  执行任务B

完成后，循环重复。这个循环必须一直持续到用户按下停止。如果 Main Activity/UI 为 onPause、onStop 或 onDestroy，则此循环不得停止、中断或销毁。Main Activity/UI 应该与循环线程完全分开。

停止按钮：停止循环内所有步骤的执行，无论它是哪个步骤。取消所有计划任务并停止服务。App 现在应该处于的状态必须与 App 第一次启动时一样（与按下 Start 之前的状态相同）。

**问题**

我不确定 Service 和 IntentService 的全部功能。我知道 Service 可以执行多线程，而 IntentService 执行任务队列并一一执行。

**潜在解决方案**

我上面的循环需要以确切的顺序执行这 8 个步骤，因此 IntentService 将是理想的解决方案。

但我的问题是：我能否创建一个完全独立于主活动/UI 线程的 IntentService，使其不依赖于主活动的生命周期或线程？

如果不是，那么实现这一目标的理想选择是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T00:10:03.063

> 我上面的循环需要以确切的顺序执行这 8 个步骤，因此 IntentService 将是理想的解决方案。

并不真地。`IntentService`专为事务性工作而设计：做几秒钟或几分钟的工作，然后离开。您需要的是可以更无限期地运行的东西。

> 我可以创建一个完全独立于 Main Activity/UI 线程的 IntentService，以便它不依赖于 Main Activity 的生命周期或线程吗？

通常与您的`IntentService`进程的主应用程序线程几乎没有关系。

更好的解决方案是常规的`Service`. 使用标准 Java`ScheduledExecutorService`来处理事件的计时并在后台线程上触发它们的工作。启动该服务的工作，由您的活动调用`onStartCommand()`触发。`startService()`停止您的服务中的这项工作，由您的活动调用`onDestroy()`触发。`stopService()`在 和 之间`startService()`，`stopService()`您的服务将运行......至少一段时间。

更好的是，如果您的投票周期更长，可以使用`AlarmManager`它并让您及时控制此事件点。这样，您`Service`就不会一直阻塞内存。就目前而言，如果用户不重视您的服务，他们将倾向于杀死您的应用程序。

# javascript - 关于用 javascript 测量带宽

> ID：16071216
> 
> 赞同：0
> 
> 时间：2013-04-17T22:18:25.347
> 
> 标签：javascript, bandwidth

我正在尝试将 java 脚本片段注入网页。在 java 脚本中，我尝试测量为此网页下载的数据总量，然后将数据大小除以页面加载时间来计算带宽。

有谁知道如何测量在 java 脚本的完整事件中下载了多少数据？

测量带宽的最建议方法是特意下载一个文件来测量我不想使用的文件。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:30:05.763

获得带宽（上传和下载）的最建议方法是下载/上传一个已知大小的文件，取开始时间和结束时间的差，然后将大小除以下载/上传它所花费的时间.

*最推荐的方法也是最简单的*方法，因为：

1.  你知道文件的大小
2.  您可以获得下载所需的时间
3.  你可以控制它开始和结束的时间

通常你可以。但是使用当前页面上加载的资源来衡量速度的问题是您需要挂钩到每个资源，其中包括（但不限于）：

*   图片
*   脚本
*   样式表
*   框架
*   XHR (AJAX)
*   插座
*   页面本身
*   和其他我错过的东西。

页面以顺序和并行请求的组合加载资源，这些请求在不同的时间点开始和结束。有些甚至可能使用加载器脚本延迟加载，在您尝试检查时，可能还没有响应。

此外，如果您使用此脚本，则此脚本必须在所有内容之前加载，以连接到页面上的所有内容。这里的另一个问题是并非所有资源都有可靠的`onload`事件，尤其是`link`元素。

我建议你坚持简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:36:15.750

您可以查看[Navigation Timing API](https://developer.mozilla.org/en-US/docs/Navigation_timing)以获取页面加载时间并计算页面中的字符以给出以字节为单位的大小，这当然不会为您提供真正使用的带宽，因为它不包括开销tcp 流量标头。当然，您必须考虑其他对象的大小，例如图像等。只是我脑海中的一些想法。

之前在 stackexchange 上提出了类似的问题：

[如何仅使用 javascript 获取以 KB 为单位的当前页面大小？](https://stackoverflow.com/questions/890221/how-to-get-current-page-size-in-kb-using-just-javascript)

# css - css：同一行上有许多兄弟选择器

> ID：16071221
> 
> 赞同：0
> 
> 时间：2013-04-17T22:18:43.123
> 
> 标签：css, stylesheet, css-selectors, siblings

在我的 stilesheet 中，我有类似以下内容：

```
h2.foo1 ~ p.bar1 {
...
} 
h2.foo2 ~ p.bar2 {
...
} 
h2.foo3 ~ p.bar3 {
...
} 
```

由于括号中定义的属性对所有人都是相同的，我可以将以上几行合并为一个吗？如何？也就是说，类似于：

```
h2.foo1 ~ p.bar1 (?) h2.foo2 ~ p.bar2 (?) h2.foo3 ~ p.bar3(?) {
... 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:22:03.793

```
h2.foo1 ~ p.bar1, h2.foo2 ~ p.bar2, h2.foo3 ~ p.bar3 {
... 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:22:49.587

逗号。

```
h2.foo1 ~ p.bar1, h2.foo2 ~ p.bar2, h2.foo3 ~ p.bar3 {
...
} 
```

# java - 需要多大的图才能触发斐波那契堆的最坏情况复杂性？

> ID：16071225
> 
> 赞同：1
> 
> 时间：2013-04-17T22:19:09.070
> 
> 标签：java, data-structures, dijkstra, fibonacci

我一直试图通过将它与 Dijkstra 算法一起使用来触发斐波那契堆的最坏情况复杂性，但显然没有运气。我有第二个使用香草二进制堆的 Dijkstra 实现，它似乎总是赢。我被告知要使用更大的数据集进行测试，如图所示（直接从我的程序复制粘贴）：

```
Running Dijkstra's algorithm with 3354 nodes and 8870 links...
Source node: ALL
Time using binary heap = 2167698339 ns (2167.70 ms) 
```

相对...

```
Running Dijkstra's algorithm with 3354 nodes and 8870 links...
Source node: ALL
Time using Fibonacci heap = 11863138070 ns (11863.14 ms) 
```

2 秒，约 12 秒。差别很大好吧。

现在，我有另一个图表，其中包含高达 264,000 个节点和 733,000 条边。我还没有机会测试它，但这足以让斐波那契堆的理论优势大放异彩吗？

我希望我不需要超过一百万个节点的东西。我的意思是这不是世界上最大的问题，但很高兴能看到一次行动的不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T08:43:04.547

首先，您的问题的标题不正确。输入的大小不会影响最坏情况的复杂性。您需要的是图的大小，其中斐波那契堆的渐近计算复杂度弥补了它的常数因子。还记得旧日的美好`O(n)`吗？这`O(n)`意味着对于足够大的数据集，您的算法将执行近似`k*n`运算，其中 k 是一个固定数字。这`k`是我所指的常数。现在，如果你有一个复杂的算法`O(n)`和另一个复杂的算法`O(n*log(n))`，这仍然不意味着第一个总是比第二个快。想象一下，第一个执行 k [1] *n 操作，第二个执行 k [2] n*log(n) 操作。现在如果 k [1]= k [2] * 1000，只有当 n > 21000 时，第一个算法才会比第二个算法快，这是**相当大**的。重要的是，如果您有一个值，第一个算法将超过第二个算法。

根据给定数据结构的实现，常数可能会有所不同，因此您可能需要几倍大的数据集来弥补它。我已经看到了一些结果，其中斐波那契堆在大约 500 000 个边（和大约 5000 个节点）处比普通的旧二进制堆更快，但这些仅适用于该特定实现。在您的实现中，差异可能会更早或更晚显示，具体取决于您实现这两种结构的效率。可以肯定的是，如果您以正确的复杂性实现数据结构，则差异会在某些 n 中显示出来（但可能没有现有的计算机可以处理那么大的图）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:08:33.750

我认为你的斐波那契堆对于大图不一定更快。您需要增加的是 reductionKey 操作的数量。如果节点的平均度数增加（因此是高维图），您应该获得更多这样的操作。或者可以说图形是否变得更完整（高度互连）。

# jquery - 是否可以将 jQuery 的 .when() 与 forEach ajax 调用循环一起使用？

> ID：16071226
> 
> 赞同：1
> 
> 时间：2013-04-17T22:19:18.870
> 
> 标签：jquery, ajax

我有几个表格我想一次发布到我的服务器。然后，我想听他们所有人完成。如果我听到它们都成功完成，我将采取一项行动，如果我看到一项失败，我将采取不同的行动。

我相信我应该使用 jQuery 的 .when()：[http ://api.jquery.com/jQuery.when/](http://api.jquery.com/jQuery.when/)

StackOverflow 上的这篇文章展示了一个示例，说明当您明确定义了所有 ajaxRequests 时如何做到这一点：[等到所有 jQuery Ajax 请求都完成？](https://stackoverflow.com/questions/3709597/wait-until-all-jquery-ajax-request-are-done)我想知道是否有可能以某种方式通过循环达到相同的效果？

我目前有这段代码，但它不会等待全部完成：

```
_.each($('form'), function (form) {
            var $form = $(form);

            if ($form.valid()) {
                //  Post form data
                $.ajax({
                    url: $form.attr('action'),
                    type: $form.attr('method'),
                    data: getFormData($form),
                    success: function () {}
                    error: function(){}
                });
            }
        }); 
```

编辑：虽然我接受了一个答案.. 值得注意的是，正确的“答案”正在改变设计要求。我们意识到，如果另一笔交易失败，撤销一笔交易将非常困难，但我们必须将所有交易保持在同一状态。这使我们走上了 Beetroot 建议的道路，创建了一个巨大的模型，但这增加了许多其他复杂性。因此，我们现在只需在选项卡之间切换之前让用户保存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:43:03.403

你可以[`jQuery.when`](http://api.jquery.com/jQuery.when)这样使用；

```
jQuery.when.apply(jQuery, $('form').map(function () {
    var $form = $(form);

    if ($form.valid()) {
        //  Post form data
        $.ajax({
            url: $form.attr('action'),
            type: $form.attr('method'),
            data: getFormData($form),
            success: function () {}
            error: function () {}
        });
    }

    // Otherwise don't do anything.
})).done(function (form1Ajax, form2Ajax, formNAjax) {
    // All complete    
}).fail(function (form1Ajax, form2Ajax, formNAjax) {
    // One failed
}); 
```

不幸的是，`jQuery.when`期望每个参数都`Deferred`作为单独的参数给出，而不是 ; 的数组`Deferreds`。这就是为什么我们要通过[`apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply).

还要注意[`map()`](http://api.jquery.com/map);的行为 `undefined`如果返回或返回，它不会将元素添加到结果数组`null`中。

# css - CSS dropshadow 没有到达页面底部？

> ID：16071229
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:19:32.017
> 
> 标签：css, dropshadow

我想在主要内容的两边都使用阴影，但它没有到达页面底部。它在结束前将它切断了大约 100 像素。一直想不通为什么。将不胜感激任何帮助！

HTML 文件：[http](http://db.tt/0z0cNVIt) ://db.tt/0z0cNVIt 样式表： http: [//db.tt/1cJDzbJ0](http://db.tt/1cJDzbJ0)

**HTML**

```
<div id="container">
    <div id="sidebar">
        <img name="logo" src="" width="280" height="150" alt="" />
        <br />
        <br />Babylon Citizens Council of the Arts is a not-for-profit arts organization bringing theatre, music, fine arts and cultural events to the residents of the Town of Babylon.
        <br />
        <br />
        <ul id="nav">
            <li><a href="about.html">About</a>
            </li>
            <li><a href="events.html">Events</a>
            </li>
            <li><a href="programs.html">Programs</a>
            </li>
            <li><a href="comp.html">Competitions</a>
            </li>
            <li><a href="photos.html">Photos</a>
            </li>
            <li><a href="membership.html">Membership</a>
            </li>
            <li><a href="contact.html">Contact</a>
            </li>
        </ul>
        <br />Follow us on social networks!
        <br />
        <br />
<a href="#"><img src="images/fb.png" /></a>  <a href="#"><img src="images/twitter.png" /></a>

    </div>
    <div class="content">
         <h3>Welcome to the Babylon Citizens Council on the Arts!</h3>

        <p><a href="#">link test</a>
        </p>
        <div id="slider">SLIDER WILL BE HERE</div>
        <!-- end .content -->
    </div>
    <!-- end .container -->
</div> 
```

**CSS**

```
@charset"UTF-8";
 html, body {
    height: 100%;
}
body {
    font: 12px Verdana, Arial, Helvetica, sans-serif;
    line-height: 22px;
    background: url(images/bg.png);
    margin: 0;
    padding: 0;
    color: #666;
}
/* ~~ Element/tag selectors ~~ */
 ul, ol, dl {
    /* Due to variations between browsers, it's best practices to zero padding and margin on lists. For consistency, you can either specify the amounts you want here, or on the list items (LI, DT, DD) they contain. Remember that what you do here will cascade to the .nav list unless you write a more specific selector. */
    padding: 0;
    margin: 0;
}
h1, h2, h3, h4, h5, h6, p {
    margin-top: 0;
    /* removing the top margin gets around an issue where margins can escape from their containing div. The remaining bottom margin will hold it away from any elements that follow. */
    padding-right: 15px;
    padding-left: 15px;
    /* adding the padding to the sides of the elements within the divs, instead of the divs themselves, gets rid of any box model math. A nested div with side padding can also be used as an alternate method. */
}
a img {
    /* this selector removes the default blue border displayed in some browsers around an image when it is surrounded by a link */
    border: none;
}
/* ~~ Styling for your site's links must remain in this order - including the group of selectors that create the hover effect. ~~ */
 a:link {
    color: #42413C;
    text-decoration: underline;
    /* unless you style your links to look extremely unique, it's best to provide underlines for quick visual identification */
}
a:visited {
    color: #6E6C64;
    text-decoration: underline;
}
a:hover, a:active, a:focus {
    /* this group of selectors will give a keyboard navigator the same hover experience as the person using a mouse. */
    text-decoration: none;
}
/* ~~ this fixed width container surrounds all other elements ~~ */
 #container {
    width: 960px;
    height: 100%;
    background: #FFF;
    display: block;
    margin: 0 auto;
    /* the auto value on the sides, coupled with the width, centers the layout */
    -moz-box-shadow: 10px 0 5px -10px #cab7aa, -10px 0 5px -10px #cab7aa;
    -webkit-box-shadow: 10px 0 5px -10px #cab7aa, -10px 0 5px -10px #cab7aa;
    box-shadow: 10px 0 10px -10px #cab7aa, -10px 0 10px -10px #cab7aa;
    /* For IE 8 */
    -ms-filter:"progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#cab7aa')";
    /* For IE 5.5 - 7 */
    filter: progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#cab7aa');
}
/* ~~ This is the layout information. ~~ 

1) Padding is only placed on the top and/or bottom of the div. The elements within this div have padding on their sides. This saves you from any "box model math". Keep in mind, if you add any side padding or border to the div itself, it will be added to the width you define to create the *total* width. You may also choose to remove the padding on the element in the div and place a second div within it with no width and the padding necessary for your design.

*/
 #sidebar {
    width: 280px;
    height: 100%;
    float: left;
    background-color: #f5e9e0;
    padding: 40px;
}
#nav {
    list-style-type: none;
    line-height: 32px;
}
#nav a, #nav a:link, #nav a:visited, #nav a:active {
    text-decoration: none;
    border-bottom: 1px dotted #784e33;
    display: block;
}
#nav a:hover {
    text-decoration: none;
    border-bottom: 1px dotted #784e33;
    background-color: #fcf5f0;
}
.content {
    width: 560px;
    height: 100%;
    float: right;
    background-color: #FFF;
    padding: 40px 20px 40px 20px;
}
/* ~~ miscellaneous float/clear classes ~~ */
 .fltrt {
    /* this class can be used to float an element right in your page. The floated element must precede the element it should be next to on the page. */
    float: right;
    margin-left: 8px;
}
.fltlft {
    /* this class can be used to float an element left in your page. The floated element must precede the element it should be next to on the page. */
    float: left;
    margin-right: 8px;
}
.clearfloat {
    /* this class can be placed on a <br /> or empty div as the final element following the last floated div (within the #container) if the overflow:hidden on the .container is removed */
    clear:both;
    height:0;
    font-size: 1px;
    line-height: 0px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:27:12.980

您需要删除您的`body`和`html`高度（100% 仅使用浏览器高度）并在关闭 div 之前放置一个清除`container`div。

清除 div：`<div style="clear: both;"></div>`

在这里看到它：http: [//jsfiddle.net/7mJMx/1/](http://jsfiddle.net/7mJMx/1/)

感谢@Allendar 制作了原始的 jsfiddle！

# ruby - 红宝石宝石有问题

> ID：16071230
> 
> 赞同：1
> 
> 时间：2013-04-17T22:19:35.393
> 
> 标签：ruby, gem

因此，当尝试通过 MtGox Ruby gem 取回我的余额时，会发生以下情况：

```
MtGox.configure do |config|
  config.key = "XXXXX"
  config.secret = "XXXXXXX"
end

puts MtGox.balance 
```

该代码返回对象的内存位置：

```
#< MtGox::Balance:0xXXXXX >
#< MtGox::Balance:0xXXXXXX > 
```

我该如何解决？

当我放`MtGox.balance.to_s`：

```
[#< MtGox::Balance:0x00xxxxxxxx @currency="BTC", @amount=1>, #< MtGox::Balance:0xxxxxx @currency="USD", @amount=1>] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:22:30.260

查看[MtGox API 文档](http://rubydoc.info/gems/mtgox/0.9.0/frames)

尝试

```
 MtGox.balance.amount

 MtGox.balance.currency 
```

# directshow - win 7下使用媒体基础更改分辨率

> ID：16071235
> 
> 赞同：3
> 
> 时间：2013-04-17T22:20:05.427
> 
> 标签：directshow, resolution, ms-media-foundation

我正在 win 7 下在顶级媒体基础上编写应用程序，我使用 IMFMediaSource 来查询相机接口以获取帧和其他属性。这很奇怪，但我找不到改变分辨率的方法。似乎如果我使用 IMFCaptureSource 我可以使用 SetCurrentDeviceMediaType 来更改分辨率，但它仅在 Windows 8 中受支持。所以我们不能在 win 7 下使用媒体基础更改分辨率？有没有办法使用直接显示与 IMFMediaSource 来改变分辨率？如果是这样，任何人都可以提供一些代码示例吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T18:33:54.173

好的，所以我最终发现了。我正在使用 IMFSourceReader 从 MFMediaSource 获取样本，因此在配置 SourceReader 后，您可以迭代相机支持的本机媒体类型，如下所示：

```
HRESULT nativeTypeErrorCode = S_OK;
DWORD count = 0;
UINT32 streamIndex = 0;
UINT32 requiredWidth = 1600;
UINT32 requiredheight = 900;
while (nativeTypeErrorCode == S_OK)
{
    IMFMediaType * nativeType = NULL;    
    nativeTypeErrorCode = m_pReader->GetNativeMediaType(streamIndex, count, &nativeType);
    if(nativeTypeErrorCode != S_OK) continue;

    // get the media type 
    GUID nativeGuid = {0};
    hr = nativeType->GetGUID(MF_MT_SUBTYPE, &nativeGuid);

    if (FAILED(hr)) return hr;

    UINT32 width, height;
    hr = ::MFGetAttributeSize(nativeType, MF_MT_FRAME_SIZE, &width, &height);

    if (FAILED(hr)) return hr;

    if(nativeGuid == <my type guid> && width == requiredWidth && height == requiredheight)
    {
        // found native config, set it
        hr = m_pReader->SetCurrentMediaType(streamIndex, NULL, nativeType);
        if (FAILED(hr)) return hr;
        break;
    }

    SafeRelease(&nativeType);
    count++;
} 
```

这意味着我没有创建具有所需分辨率的新媒体类型，我获得了具有所需配置的本机媒体类型，并将其设置在 SourceReader 上。

希望它对未来的媒体基金会旅行者有所帮助...... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:50:25.530

您可以从 IMediaSource 查询可以更改分辨率的 directshow 接口。

例如：对于相机控制属性，我喜欢这样。

```
IAMCameraControl* m_pCameraControl = NULL;
HRESULT hr = S_OK;

hr = pMediaSource->QueryInterface(IID_PPV_ARGS(&m_pCameraControl));
if (m_pCameraControl == NULL)
{
    return E_FAIL;
} 
```

同样，在您的情况下，我不确定界面，但我想它将采用以下方式。

```
 IAMStreamConfig * m_pStreamConfig = NULL;
HRESULT hr = S_OK;

hr = pMediaSource->QueryInterface(IID_PPV_ARGS(&m_pStreamConfig ));
if (m_pCameraControl == NULL)
{
    return E_FAIL;
} 
```

# .net - 需要帮助将 MVVM 命令逻辑转换为 Caliburn.Micro

> ID：16071239
> 
> 赞同：0
> 
> 时间：2013-04-17T22:20:53.583
> 
> 标签：.net, mvvm, caliburn

我有一个行为是为了与普通的 MVVM 一起工作而创建的，我想要一些关于如何使它与 Caliburn.Micro 一起工作的指导。

我的行为如下：

```
public class DropEventBehavior : Behavior<DragSource>
{
    protected override void OnAttached()
    {
        base.OnAttached();
        this.AssociatedObject.Drop += AssociatedObject_Drop;    
    }

    protected override void OnDetaching()
    {
        this.AssociatedObject.Drop -= AssociatedObject_Drop;
        base.OnDetaching();
    }

    void AssociatedObject_Drop(object sender, DropEventArgs e)
    {
        if (DropEventCommand != null)
            DropEventCommand.Execute(e);
    }

    #region Command

    public ICommand DropEventCommand
    {
        get { return (ICommand)GetValue(DropEventCommandProperty); }
        set { SetValue(DropEventCommandProperty, value); }
    }

    // Using a DependencyProperty as the backing store for DropEventCommand.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty DropEventCommandProperty =
        DependencyProperty.Register("DropEventCommand", typeof(ICommand), typeof    (DropEventBehavior), new PropertyMetadata(null));

    #endregion
} 
```

这是中继命令：

```
public class RelayCommand<T> : ICommand
{

    #region Declarations

    readonly Predicate<T> _canExecute;
    readonly Action<T> _execute;

    #endregion

    #region Constructors

    /// <summary>
    /// Initializes a new instance of the <see cref="RelayCommand&lt;T&gt;"/> class and the command can always be executed.
    /// </summary>
    /// <param name="execute">The execution logic.</param>
    public RelayCommand(Action<T> execute)
        : this(execute, null)
    {
    }

    /// <summary>
    /// Initializes a new instance of the <see cref="RelayCommand&lt;T&gt;"/> class.
    /// </summary>
    /// <param name="execute">The execution logic.</param>
    /// <param name="canExecute">The execution status logic.</param>
    public RelayCommand(Action<T> execute, Predicate<T> canExecute)
    {

        if (execute == null)
            throw new ArgumentNullException("execute");
        _execute = execute;
        _canExecute = canExecute;
    }

    #endregion

    #region ICommand Members

    public event EventHandler CanExecuteChanged;

    public virtual Boolean CanExecute(Object parameter)
    {
        return _canExecute == null ? true : _canExecute((T)parameter);
    }

    public virtual void Execute(Object parameter)
    {
        _execute((T)parameter);
    }

    #endregion
} 
```

这是 XAML：

```
 <Grid.Resources>
      <local:MainPageViewModel x:Key="MainPageViewModel"/>
    </Grid.Resources>  

   <ListBox Name="listBox1" ItemsSource="{Binding Source1}">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <sdk:Label Content="{Binding Name}">
                        <ig:DragDropManager.DragSource>
                            <ig:DragSource IsDraggable="True">
                                <i:Interaction.Behaviors>
                                    <local:DropEventBehavior
                                        DropEventCommand="{Binding Source={StaticResource MainPageViewModel}, Path=DropCommand}"/>
                                </i:Interaction.Behaviors>
                            </ig:DragSource>
                        </ig:DragDropManager.DragSource>
                    </sdk:Label>
                </DataTemplate>
            </ListBox.ItemTemplate>
            <ig:DragDropManager.DropTarget>
                <ig:DropTarget IsDropTarget="True"/>
            </ig:DragDropManager.DropTarget>
   </ListBox> 
```

这是在视图模型中处理命令的方式：

```
public class DragDropEventCommands
{
    public ICommand DropCommand
    {
        get
        {
            return new RelayCommand<DragDropEventArgs>(
                new Action<DragDropEventArgs>(
                    (e) =>
                    {
                        Data dragData = (e.DragSource as Label).DataContext as Data;
                        ObservableCollection<Data> dropSource = (e.DropTarget as ListBox).ItemsSource as ObservableCollection<Data>;

                        if (dragData != null && dropSource != null)
                            dropSource.Add(dragData);
                    }));
        }
    }
} 
```

我想了解以下内容：

```
<i:Interaction.Behaviors>
   <local:DropEventBehavior cal:Message.Attach="[Event DropEventCommand] = [Action HandleDropEvents($source, $eventArgs)]"/>
</i:Interaction.Behaviors> 
```

我不反对使用触发器。在这种情况下没有成功，因为 DropEvent 不是路由事件。

如果有人能让我弄清楚这一点，我将不胜感激。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-19T11:07:37.833

你有没有找到这些，它有帮助吗？我确定我记得读过一些东西，但记不太清了。

做了这些快速搜索，看看我是否记得，并认为这就是它。

*   [我可以使用 Caliburn 绑定到 RoutedCommands 吗？](https://stackoverflow.com/questions/3364919/can-i-use-caliburn-to-bind-to-routedcommands)
*   [https://gist.github.com/GraemeF/500370](https://gist.github.com/GraemeF/500370)
*   [如何在 Caliburn.Micro 中绑定按键手势？](https://stackoverflow.com/questions/4181310/how-can-i-bind-key-gestures-in-caliburn-micro)
*   [如何使用 caliburn.micro 绑定到命令属性？](https://stackoverflow.com/questions/6680828/how-do-you-bind-to-a-command-property-with-caliburn-micro)
*   [http://caliburnmicro.codeplex.com/discussions/222164](http://caliburnmicro.codeplex.com/discussions/222164)
*   [http://caliburnmicro.codeplex.com/discussions/250844](http://caliburnmicro.codeplex.com/discussions/250844)
*   [http://caliburnmicro.codeplex.com/discussions/247535](http://caliburnmicro.codeplex.com/discussions/247535)
*   [http://calmicrofce.codeplex.com/](http://calmicrofce.codeplex.com/)

# javascript - Extjs 显示/隐藏的正确方法

> ID：16071241
> 
> 赞同：0
> 
> 时间：2013-04-17T22:21:00.380
> 
> 标签：javascript, extjs, extjs4

我对 Extjs 有点陌生，我正在尝试找出显示/隐藏元素的正确方法。

我有以下元素：

```
layout: 'card',
items: 
[
 {
  xtype: 'Panel1'
 },
 {
  xtype: 'Panel2'
 }
] 
```

在我的控制器中，我有这些参考设置：

```
refs: [
{
 ref: 'p1',
 selector: 'Panel1'
},
{
 ref: 'p2',
 selector: 'Panel2'
}
], 
```

每个面板底部都有一个表单和两个按钮。面板 2 一开始是隐藏的。现在我想显示面板 2 并隐藏面板 1。首先我尝试了：

```
this.getp1().hide();
this.getp2().show(); 
```

……那什么也没做。然后，我发现[了这个 SO question](https://stackoverflow.com/questions/4074673/how-to-show-hide-toggle-element-with-extjs)并尝试了以下内容：

```
this.getp1().getEl().hide();
this.getp2().getEl().show(); 
```

这部分有效，只是它未能在 Panel2 中显示按钮。我应该得到每一个元素和`show()`它们中的每一个吗？我肯定错过了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T15:30:37.500

尝试：

```
this.getP1().hide(); //the first letter should be uppercase
this.getP2().show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:40:30.397

我的两个问题项目的父面板是`layout: 'card'`. 根据[卡片布局上的 sencha 文档，](http://docs.sencha.com/extjs/4.1.3/#!/api/Ext.layout.container.Card)一次只会显示一个面板。因此，显示其他项目的正确方法不是通过显示/隐藏函数，而是调用 `PARENT_PANEL.getLayout().setActiveItem(n);` That 导致我的 p2 面板始终被隐藏并且不受该`show()`方法的影响。

# nginx - Nginx密码保护403禁止

> ID：16071251
> 
> 赞同：1
> 
> 时间：2013-04-17T22:21:47.507
> 
> 标签：nginx

我正在使用 Nginx 运行 CentOS 6。它目前运行良好，我正在尝试密码保护我的管理目录。我可以成功登录。但是，当我尝试查看目录中的主索引页面 (index.php) 时，我得到了 403 Forbbiden。

```
2013/04/18 02:10:17 [error] 17166#0: *24 directory index of "/usr/share/ngin/html /somedir/" is forbidden, client: XXX, server: mysite.com, request: "GET /somedir/ HTTP/1.1",  host: "mysite.com" 
```

我已经仔细检查了“.htpasswd”文件的权限。它属于 chmod 640 的“root:root”。我也尝试将 owner ship 设置为“nginx:nginx”，但错误仍然存​​在。

这就是我让 htpasswd 工作的方式：

```
location ~ ^/([^/]*)/(.*) {
    if (-f $document_root/$1/.htpasswd) {
            error_page 599 = @auth;
            return 599;
    }
}

location @auth {
    auth_basic "Password-protected";
    auth_basic_user_file $document_root/$1/.htpasswd;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-02-12T09:17:23.053

虽然这个问题已经很老了，但我必须把我的解决方案放在这里来帮助别人。这个问题就像我在某个地方的痛苦。

我可能已经阅读（并实现/尝试了）几乎所有可能的在线可用线程（直到日期），但没有一个能一起解决这个“403 Forbidden”nginx 问题：

我将从头写下步骤：（阻止我的站点访问）：

1> 我们将在 /etc/nginx 中创建一个名为 .htpasswd 的隐藏文件

```
sudo sh -c "echo -n 'usernamee:' >> /etc/nginx/.htpasswd" 
```

2> 现在将加密密码添加到给定的用户名

```
sudo sh -c "openssl passwd -apr1 >> /etc/nginx/.htpasswd" 
```

这将要求您输入密码并确认。

3> 现在我们需要设置 nginx 以在提供任何内容之前检查我们新创建的 .htpasswd。

```
location / {
        try_files $uri $uri/ /index.php?$query_string; # as per my configuration

        auth_basic "Authorized access only";
        auth_basic_user_file .htpasswd;
} 
```

4> 最后重启服务器生效

```
sudo service nginx restart 
```

现在浏览网址：

> 请注意：我没有对权限进行任何更改。默认情况下，**htpasswd**的文件权限将在创建时设置，如下所示：

`-rw-r--r-- 1 root root 42 Feb 12 12:22 .htpasswd`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:51:04.763

仔细阅读错误。您缺少 index.html 或类似内容。

# wordpress - 如何在 TYPO3 中包含来自 Wordpress 的 sitemap.xml

> ID：16071255
> 
> 赞同：0
> 
> 时间：2013-04-17T22:22:15.837
> 
> 标签：wordpress, typo3, sitemap

我安装了 TYPO3 和 Wordpress，并希望为搜索引擎提供一个 sitemap.xml，其中包括来自两个系统的网站。

目前 TYPO3 安装的站点地图是用打字稿生成的（我基本上使用[这个生成器](http://www.oliver-thiele.de/cms-typo3/tutorials/google-sitemap-mit-typoscript.html)）。在 Wordpress 中，还没有安装扩展程序来生成站点地图。

编辑：TYPO3 安装在 domain.tld/ 中，而 Wordpress 安装在子目录 domain.tld/blog 中。

我愿意使用任何方式将两个系统中的站点合并到一个站点地图中。这可以是一个或两个 CMS 的扩展，也可以是单独运行的脚本。或者也许有一种方法可以在打字稿中从 Wordpress 解析 sitemap.xml。

有谁知道合并站点地图的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:54:54.883

没有直接的方法来处理这个问题。Typoscript 无法解析外部文件。获得合并的唯一方法是创建一个新的简单扩展，它为您提供两个站点地图合并的输出。

# c++ - 来自 QML 的 C++ 对象数据的简单访问

> ID：16071256
> 
> 赞同：1
> 
> 时间：2013-04-17T22:22:17.637
> 
> 标签：c++, qml

我正在使用 qml 在 Qt/C++ 中制作棋盘游戏。所有重要的游戏数据都在一个类中表示。我的意图是让 qml 表访问这个对象并根据数据绘制游戏板。

将 C++ 数据成员暴露给 QML 的最简单方法是什么？

现在我知道这个问题已经被问过了，我已经看到了答案和 Qt 文档。然而，我并不满意。我所看到的，这样做的方法似乎是将 Q_PROPERTY 从我想从 QML 访问的每个变量中取出。这在我看来是乏味和不必要的，更不用说它会将代码拉伸到原始长度的 3 倍，从而使阅读变得更糟。此外，例如，在大多数情况下，我不需要向数据成员写入函数。

当我可以只为我需要的情况编写 Q_INVOKABLE getter 时，为什么还要为 Q_PROPERTY 开销而烦恼呢？

这是我在阅读 Qt 项目文档时希望它是多么简单的一个示例：*“这使得 C++ 数据和函数可以直接从 QML 访问，通常只需很少或不需要修改。”*

```
class game : public QObject
{
    Q_OBJECT
public:
    explicit game(QObject *parent = 0);
    colors NPC[3]; // colors being an enum declared elsewhere
    player players[4]; // player is a non-QObject class containing player stats
}
...
game gMain;
QDeclarativeContext *context = viewer.rootContext();
context->setContextProperty("Game",&gMain); 
```

我理想世界中的 QML：

```
Image {
    id : Image1
    source: { if (Game.NPC[0] === 0) {
                  if (Game.players[1].LifeCount > 0) {
                      return "pics/FigG.png"
                  }
                  else {
                      return "pics/StoneG.png"
                  }
             } 
```

现在，我实际上可以使用 QML 有多接近这一点，我该如何去做呢？我对处理简单的 C++ 风格的数组和枚举特别感兴趣（游戏中有很多）——我是否需要编写辅助函数，例如，`int Game.GetNPCAt(int i)`而不是只使用`Game.NPC[i]`?

我意识到我不想这样做的方式是久经考验和值得信赖的，并且有充分的理由......但是在我的情况下（小型单人项目）似乎使用大炮杀死苍蝇（尽管qml 中的 GUI 构建部分非常简单并且使用起来非常愉快） - 还必须围绕每个数据成员，包括最简单的 int 似乎......太荒谬了。

也许我在某个地方遗漏了什么，在这种情况下，我谦虚地道歉。感谢您对此事的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T02:21:42.260

为了：

**`Q_PROPERTY`**：当您查看[引用的页面时](http://qt-project.org/doc/qt-5.0/qtqml/qtqml-cppintegration-exposecppattributes.html)，他们讨论了使用该`Q_PROPERTY`方法将属性公开给 QML。如果你不使用`Q_PROPERTY`，我的理解是你的变量不会被 QMLViewer 注册（或者你有什么）。`Q_PROPERTY`需要`Q_INVOKABLE`获取/设置您的变量。但是，如果您不使用`Q_PROPERTY`，您的类属性将不会出现在 QML 中。

**设置图像源**：如果您可能还记得，QML 是 CSS 和 JavaScript 之间的熔炉。如果您只是希望根据`Image`元素外部的条件更改图像的源，您可以创建一个 JavaScript 函数来实现您引用的内容：

```
Image {
    id: Image1

    function getImage()
    {
        if (Game.NPC[0] === 0)
        {

            if (Game.players[1].LifeCount > 0) {
                      Image1.source="pics/FigG.png";
                  }
                  else {
                      Image1.source="pics/StoneG.png";
                  }
        }
    } 
```

但是，该函数不会自行运行：您必须将它与我将在您的 C++ 类中创建的信号相关联（将函数放在名为`signals:`(NOT within `public`- 请参阅[此处](http://qt-project.org/doc/qt-5.0/qtcore/signalsandslots.html)了解如何编写信号））。根据您的示例，我猜您的 C++ 对象被称为`Game`.

```
Game {
    id: gameKeeper //or whatever you want to name it
    onUpdate: Image1.getImage() //replace onUpdate with your signal
}

Image {
    id: Image1

    function getImage()
    {
        if (gameKeeper.NPC[0] === 0)
        {

            if (gameKeeper.players[1].LifeCount > 0) {
                      Image1.source="pics/FigG.png";
                  }
                  else {
                      Image1.source="pics/StoneG.png";
                  }
        }
    } 
```

理论上，您应该能够使用 JavaScript 以这种方式引用数组（我自己对 JS 并不熟悉）。

**数组处理**：在 C++ 方面，看起来最好的方法是通过 QList。幸运的是，QList 的迭代与普通数组非常相似。我发现[了这个](https://stackoverflow.com/a/15960171/2384510)，这应该会有所帮助——只需忽略第二个维度。

希望这可以帮助。

# ember.js - 初始路线不在历史记录中——ember.js 位置：“历史记录”

> ID：16071257
> 
> 赞同：0
> 
> 时间：2013-04-17T22:22:19.447
> 
> 标签：ember.js, ember-router

我正在使用带有位置的 ember.js：“历史”。我的站点加载的第一条路由（即我在 URL 中键入的）呈现良好。我可以单击一个链接到锚点以到达第二条路线，但是当我单击后退按钮返回到第一条路线（最初加载的路线）时，它没有被路由。

我能做些什么来将最初的路线推向历史吗？我应该这样做吗？

我的路线映射如下所示：

```
App.Router.reopen({
  location: "history"
});

App.Router.map(function() {
  this.resource("foods", function(){
    this.route("index", {path: "/"});
  });
  this.route("fourOhFour", { path: "*:"});
}); 
```

[注意：我是从http://mysite.example/](http://mysite.example/)还是[http://mysite.example/foods](http://mysite.example/foods)开始似乎并不重要。在任何一种情况下，尝试回到最初加载的路线都没有效果。

我相信也许我应该将某些东西推向历史，但不知道该怎么做，也不知道为什么需要这样做。“fourOhFour”只是我未定义路由的处理程序，顺便说一句。我不认为这与这个问题有关。

欢迎任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:50:23.857

很好地抓住了这一点。我刚刚遇到了同样的问题并开始深入研究 Ember.HistoryLocation。我在 github 上发现了这个对 ember.js 的分支的提交，它为我解决了这个问题：

[https://github.com/teddyzeenny/ember.js/commit/c2c483dc592bb926c210e2c4c174dba7314d18dd](https://github.com/teddyzeenny/ember.js/commit/c2c483dc592bb926c210e2c4c174dba7314d18dd)

...我实际上只是将来自这个提交的差异合并到我的本地 ember.js 副本中，现在正在运行历史路由，这对开发人员来说很好，这足以让我继续前进，直到这将重新楔入主项目.

# verilog - 使用 SystemVerilog 参数来决定要实例化哪个模块

> ID：16071258
> 
> 赞同：2
> 
> 时间：2013-04-17T22:22:20.743
> 
> 标签：verilog, system-verilog

有没有办法使用传递给父模块的参数值来选择我想要实例化的模块？下面的例子

```
module parent ();

 parameter WORD = 1; 

 child_`WORD child (); // obviously does not work

endmodule 
```

如果`WORD == 1`，我想实例化 child_1 模块，对于`WORD == 2`，child_2 模块等等。当然，以前有人需要这样做吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T19:56:20.360

如果你想有条件地实例化一个模块，你需要使用一个`generate`块。

```
generate
  if (WORD == 1) begin
    child_1 child();
  end
  if (WORD == 2) begin
    child_2 child();
  end
endgenerate 
```

下面是一个完整的工作示例。请注意，它仅说明 child_1 和 child_2 的存在。您不能将该参数用作您正在实例化的模块类型名称的一部分。如果您有 N 个子模块并且您不想在生成块中显式枚举它们，您可能需要创建一个辅助宏。

顺便说一句，这是有效的 Verilog 代码；它不使用任何 SystemVerilog 功能。

```
module child_1();
  initial begin
    $display("child_1 %m");
  end
endmodule

module child_2();
  initial begin
    $display("child_2 %m");
  end
endmodule

module parent();
  parameter WORD = 1;

  // Conditionally instantiate child_1 or child_2 depending 
  // depending on value of WORD parameter.
  generate
    if (WORD == 1) begin
      child_1 child();
    end
    if (WORD == 2) begin
      child_2 child();
    end
  endgenerate

endmodule

module top();
  parent #(.WORD(1)) p1();
  parent #(.WORD(2)) p2();
endmodule 
```

Incisive 的输出：

```
child_1 top.p1.genblk1.child
child_2 top.p2.genblk2.child 
```

# c++ - 我的 DoubleLinkedList 中的打印功能会创建重复项。C++

> ID：16071259
> 
> 赞同：0
> 
> 时间：2013-04-17T22:22:26.077
> 
> 标签：c++, printing, doubly-linked-list

基本上，当我只有一个 Player 对象插入我的列表时，我的打印功能将打印出内容。但是当我插入另一个对象时，它会添加它，但插入的第一个元素已被覆盖。我已经测试了我的插入和附加功能，我不相信这与这些功能有关。我认为打印功能是按列表中的节点数打印最后输入的名字、姓氏、级别和 exp。这是我的代码：

***统计.cpp***

```
#include "Stats.h"
#include <iostream>
#include "Validators.h"
using namespace std;

Validators validators2;

Stats::Stats()
{
    firstName = "";
    secondName = "";
    level = 0;
    experience = 0;
}
Stats::Stats(string firstName,string secondName, int level, int experience)
{
    firstName = firstName;
    secondName = secondName;
    level = level;
    experience = experience;

}
    string Stats :: getFirstName()
    {
        return firstName;
    }
    string Stats :: getSecondName()
    {
        return secondName;
    }
    int Stats :: getLevel()
    {
        return level;
    }
    int Stats :: getExperience()
    {
        return experience;
    }
    Stats Stats :: input()
    {
        string inputfirstName = "Please enter the First Name: ";
        firstName = validators2.getString(inputfirstName);
        string inputSecondName = "Please enter the Second Name: ";
        secondName = validators2.getString(inputSecondName);
        cout<< "Please enter the level: ";
        level = validators2.getNum();
        cout<< "Please enter the experience: ";
        experience = validators2.getNum();

        Stats s1(firstName,secondName,level,experience);
        return s1;

    } 
```

***主要的***

```
int main ()
{
//-------------------------------------------------------------------------------------------
//  Set up a linkedList and a iterator. 
//-------------------------------------------------------------------------------------------
    DoublyLinkedList<Stats> list;
    DoublyLinkedListIterator<Stats> itr = list.getIterator();
        list.Insert(itr,stats.input());
        list.print(itr);
}
//--------------------------------------------------------------------------------------------
//  Name:           DoublyLinkedList.h.
//  Description:    Header file for the use in DoublyLinkedList.cpp.
//                  A DoublyLinkedList is a dynamically growing datastructure and use's
//                  nodes and pointers in its structure.
//--------------------------------------------------------------------------------------------
#ifndef DOUBLYLINKEDLIST_H
#define DOUBLYLINKEDLIST_H

#include <iostream>
#include "Validators.h"
#include "Stats.h"

using namespace std;

Validators validators;
Stats stats;

//-------------------------------------------------------------------------------------------
//  Class Declarations.
//-------------------------------------------------------------------------------------------
template<class Datatype> class DoublyLinkedList;
template<class Datatype> class DoublyLinkedListNode; 
template<class Datatype> class DoublyLinkedListIterator;
//-------------------------------------------------------------------------------------------
//  Class:  DoublyLinkedList.
//-------------------------------------------------------------------------------------------
template <class Datatype>
class DoublyLinkedList
{   
public:
//-------------------------------------------------------------------------------------------
//  Member Vairables.
//-------------------------------------------------------------------------------------------
DoublyLinkedListNode<Datatype>* m_head;
DoublyLinkedListNode<Datatype>* m_tail;
int m_count;
//-------------------------------------------------------------------------------------------
//  Name:           Constructor.
//  Description:    Constructs the DoublyLinkedList.
//-------------------------------------------------------------------------------------------
DoublyLinkedList()
{
    //Sets m_head to a default value of 0\.  m_head is the first node in the linkedList.
    m_head = 0;
    //Sets m_tail to a default value of 0\.  m_tail is the last node in the linkedList.
    m_tail = 0;
    //Sets m_count to a default value of 0\.  m_count is to count the elements in the linkedList.
    m_count = 0;
}
//-------------------------------------------------------------------------------------------
//  Name:           Destructor.
//  Description:    Deletes the DoublyLinkedList.
//-------------------------------------------------------------------------------------------
~DoublyLinkedList()
{
    //Temporary node pointer.
    DoublyLinkedListNode<Datatype>* itr = m_head;
    DoublyLinkedListNode<Datatype>* next = 0;

    while(itr != 0)
    {
        //Save the pointer to next node. 
        next = itr->m_next;
        //Delete the current node.
        delete itr;
        //Make the next node the current node.
        itr = next;
    }
}
int getCount()
{
return m_count;
}
// -------------------------------------------------------------------------------------
//  Name:           Append
//  Description:    This adds a node to the end of the list, then points to the newNode
//  Arguments:      p_data - The data to store in the new node.
//                  m_count is increased.
//  Return Value:   None.
// -------------------------------------------------------------------------------------
    void Append(Datatype p_data)
    {
        if(m_head == 0)
        {
            // create a new head node.
            m_head= m_tail= new DoublyLinkedListNode<Datatype>;
            m_head->m_data= p_data;
            m_head->m_next= 0;
            m_head->m_prev= 0;
        }
        else
        {
            // insert a new node after the tail and reset the tail.
            m_tail->InsertAfter(p_data);
            m_tail= m_tail->m_next;
        }
        m_count++;
    }

//-------------------------------------------------------------------------------------------
//  Name:           Print.
//  Description:    Prints the elements from the list along with its index.
//-------------------------------------------------------------------------------------------
    void Print(DoublyLinkedListIterator<Datatype> m_itr)
    {
        for(m_itr.Start();m_itr.Valid();m_itr.Forth())
        {
            cout << "------------------Player------------------\n";
            cout << "First Name:\t\t" << stats.getFirstName() << "\n";
            cout << "Second Name:\t\t" << stats.getSecondName() << "\n";
            cout << "Level:\t\t\t" << stats.getLevel() << "\n";
            cout << "Experience:\t\t" << stats.getExperience() << "\n";
            cout << "------------------------------------------\n";
        }
    }
// ----------------------------------------------------------------------------------------------------------------
//  Name:           Insert
//  Description:    Inserts data before the iterator, this works whether the iterator is backwards of forwards
//                  through the list.Inserts at the end of the list if iterator is invalid.
//  Arguments:      p_iterator: The iterator to insert before
//                  p_data: the data to insert
//  Return Value:   None.
// ----------------------------------------------------------------------------------------------------------------
    void Insert(DoublyLinkedListIterator<Datatype>& p_itr, Datatype p_data)
    {
        if(p_itr.m_node != 0)
        {
            // insert the data before the iterator
            p_itr.m_node->InsertBefore(p_data);

            //if the iterator was at the head of the list,
            //reset the head pointer
            if(p_itr.m_node == m_head)
            {
                m_head = m_head->m_prev;
            }
            // increment the count
            m_count++;
        }
        else
        {
            Append(p_data);
        }
    }

//-------------------------------------------------------------------------------------------
//  Name:           GetIterator
//  Description:    Generates an iterator pointing towards the current head node
//  Arguments:      None.
//  Return Value:   <Datatype> Iterator
//-------------------------------------------------------------------------------------------
    DoublyLinkedListIterator<Datatype> getIterator()
    {
        return DoublyLinkedListIterator<Datatype>(this, m_head);
    }
};
//-------------------------------------------------------------------------------------------
//  Class:  DoublyLinkedNode.
//-------------------------------------------------------------------------------------------
template<class Datatype>
class DoublyLinkedListNode
{
public:
//-------------------------------------------------------------------------------------------
//  Member Vairables.
//-------------------------------------------------------------------------------------------
    DoublyLinkedListNode<Datatype>* m_next;
    DoublyLinkedListNode<Datatype>* m_prev;
    Datatype m_data;

// ----------------------------------------------------------------
//  Name:           InsertAfter
//  Description:    This adds a node after the current node.
//  Arguments:      p_data - The data to store in the new node.
//  Return Value:   None.
// ----------------------------------------------------------------
    void InsertAfter(Datatype p_data)
    {
        //Create the new node.
        DoublyLinkedListNode<Datatype>* newNode= new DoublyLinkedListNode<Datatype>;
        newNode->m_data = p_data;
        // make the new node point to the next node.
        newNode->m_next = m_next;
        newNode->m_prev = this;

        // make the node before it, point to the new node.
        //if(m_next != 0)
        //m_next->m_prev= newNode;
        m_next = newNode;
    }
// ----------------------------------------------------------------
//  Name:           InsertBefore
//  Description:    This adds a node before the current node.
//  Arguments:      p_data - The data to store in the new node.
//  Return Value:   None.
// ----------------------------------------------------------------
    void InsertBefore(Datatype p_data)
    {
        //Create new Node
        DoublyLinkedListNode<Datatype>* newNode = new DoublyLinkedListNode<Datatype>;
        newNode->m_data = p_data;
        //Set up new Node Pointers
        newNode->m_next = this;
        newNode->m_prev = m_prev;
        //if theres a node before it, make it point to new node
        if(m_prev != 0)
        m_prev = newNode;
    }
};
//-------------------------------------------------------------------------------------------
//  Class:  DoublyLinkedIterator.
//-------------------------------------------------------------------------------------------
template <class Datatype>
class DoublyLinkedListIterator
{
public:
//-------------------------------------------------------------------------------------------
//  Member Vairables.
//-------------------------------------------------------------------------------------------
    DoublyLinkedListNode<Datatype>* m_node;
    DoublyLinkedList<Datatype>* m_list;
    DoublyLinkedListIterator(DoublyLinkedList<Datatype>* p_list= 0, DoublyLinkedListNode<Datatype>* p_node= 0)
    {
        m_list= p_list;
        m_node= p_node;
    }

// ------------------------------------------------------------------
//  Name:           Start
//  Description:    Resets the iterator to the beginning of the list.
//  Arguments:      None.
//  Return Value:   None.
// ------------------------------------------------------------------
    void Start()
    {
        if(m_list!= 0)
            m_node= m_list -> m_head;
    }

// ----------------------------------------------------------------
//  Name:           End
//  Description:    Resets the iterator to the end of the list
//  Arguments:      None.
//  Return Value:   None.
// ----------------------------------------------------------------
    void End()
    {
        if(m_list!= 0)
            m_node = m_list->m_tail;
    }

// ----------------------------------------------------------------
//  Name:           Forth
//  Description:    Moves the iterator forward by one position
//  Arguments:      None.
//  Return Value:   None.
// ----------------------------------------------------------------
    void Forth()
    {
        if(m_node != 0)
        {
        m_node = m_node ->m_next;
        }
    }

// ----------------------------------------------------------------
//  Name:           Back
//  Description:    Moves the iterator backward by one position.
//  Arguments:      None.
//  Return Value:   None.
// ----------------------------------------------------------------
    void Back()
    {
        if(m_node!= 0)
            m_node = m_node->m_prev;
    }

// ----------------------------------------------------------------
//  Name:           Item
//  Description:    Gets the item that the iterator is pointing to.
//  Arguments:      None.
//  Return Value:   Reference to the data in the node.
// ----------------------------------------------------------------
    Datatype& Item()
    {
        return m_node->m_data;
    }
//-----------------------------------------------------------------
//  Name:           Valid
//  Description:    Determines if the node is valid.
//  Arguments:      None.
//  Return Value:   true if valid
// ----------------------------------------------------------------
    bool Valid()
    {
        return (m_node!= 0);
    }
};

#endif 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:53:38.787

你的打印循环应该是这样的

```
 for(m_itr.Start();m_itr.Valid();m_itr.Forth())
    {
        cout << "------------------Player------------------\n";
        cout << "First Name:\t\t" << m_itr.Item().getFirstName() << "\n";
        cout << "Second Name:\t\t" << m_itr.Item().getSecondName() << "\n";
        cout << "Level:\t\t\t" << m_itr.Item().getLevel() << "\n";
        cout << "Experience:\t\t" << m_itr.Item().getExperience() << "\n";
        cout << "------------------------------------------\n";
    } 
```

看看它如何*使用迭代器*来获取要打印的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:30:05.020

这真的是代码吗？

```
Stats::Stats(string firstName,string secondName, int level, int experience)
{
    firstName = firstName;
    secondName = secondName;
    level = level;
    experience = experience;
} 
```

这简直是​​大错特错，大错特错。您正在为自己分配变量！您尝试构建的对象没有任何反应！

这会起作用

```
Stats::Stats(string firstName,string secondName, int level, int experience)
{
    this->firstName = firstName;
    this->secondName = secondName;
    this->level = level;
    this->experience = experience;
} 
```

但通常您选择的参数名称与您的成员变量名称*不同，例如*

```
Stats::Stats(string fn, string sn, int lvl, int ex)
{
    firstName = fn;
    secondName = sn;
    level = lvl;
    experience = ex;
} 
```

我对你变得怪异并不感到惊讶，你编写了一个不起作用的构造函数，这是一个非常基本的错误。

# javascript - 缩小尺寸的图像在 Chrome 中很慢

> ID：16071260
> 
> 赞同：1
> 
> 时间：2013-04-17T22:22:26.353
> 
> 标签：javascript, ajax, image, google-chrome, load

我正在编写一个脚本，但 Chrome 有问题。

这就是我正在做的事情： 1\. 将大图像加载到 DIV 中。2\. 缩放图像以适合 DIV 的大小。3\. 浏览器调整大小时，图片随浏览器放大缩小。

*在除 Chrome 之外的所有浏览器中，一切都 100% 运行。*

我检查了 Chrome 中的分析器，没有发现任何异常。这些是大图像，但是在所有其他浏览器中都可以正常工作（甚至是实时图像）。

在 Chrome 中使用缩小尺寸的图像时，我读过很多地方都注意到了这个问题……但不是解决方案。

没什么特别的，只是使用

```
var img=new Image();
$(img).load(function(){ .... {); 
```

有谁知道可以在 Chrome 中使用的解决方法或解决方案？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-23T10:48:13.097

我有完全相同的问题，但最近解决了它。巨大的性能占用了 chrome 的抗锯齿功能，因为它会在您调整图像大小时重新计算整个图像。

因此，要解决它，您只需将此行添加到 css 中，如果您的图像：

```
#myImage
{
     image-rendering: -webkit-optimize-contrast;
} 
```

当图像静止时，您可以通过 javascript 将其关闭。

有关抗锯齿的更多信息：[缩放图像时禁用抗锯齿](https://stackoverflow.com/questions/14068103/disable-antialising-when-scaling-images)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T16:11:31.380

因此，Chrome 在处理大图像甚至不是大但只是按比例缩小的图像时似乎很糟糕。我无休止地四处搜索，只是为了找到没有解决方案的类似问题。

仍然不确定为什么所有其他浏览器（甚至 IE 7 和 8）都可以处理大图像（使用 7mb 缩小的 PNG 进行测试），但 Chrome 甚至无法在不滞后的情况下制作 700kb 的缩小 JPG。

所以，我要回答这个问题：在这种情况下，Chrome 很烂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T00:14:22.773

你是如何调整图像大小的？使用高度/宽度或 CSS 转换？后者可能会带来更好的性能。

一些信息： [提高 HTML5 应用程序的性能](http://www.html5rocks.com/en/tutorials/speed/html5/ "提高 HTML5 应用程序的性能")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-01T19:54:32.967

当您在 Chrome 中分析图像大小调整和解码问题时，最好使用开发者工具时间线，因为它可以为您提供相对准确的统计数据，准确了解需要很长时间才能解码的内容。

缩小（或重新调整大小）涉及 Chrome 必须解码您发送的图像（JPEG/PNG/GIF），然后做额外的工作来将该图像调整到您想要显示的容器（div）中在可能的情况下，Chrome 团队的建议是将您的图像预缩放到所需的正确宽度/高度。

现在您可能想知道：嗯，这个问题肯定只是桌面 Chrome 很烂，对吧？它没有那么明确。特别是在浏览器无法访问强大的 GPU/CPU 的移动设备上，在那里执行这些调整大小操作的成本也会很高。简而言之：是的，有时在 Chrome 中重新缩放大图像可能会很慢。尝试在可能的情况下进行预缩放，这些性能瓶颈应该会消失。

# google-maps - 使用下拉菜单在谷歌地图上切换位置

> ID：16071262
> 
> 赞同：0
> 
> 时间：2013-04-17T22:22:29.120
> 
> 标签：google-maps

我是谷歌地图的新手，我有一张带有多个标记的地图，我想使用下拉菜单在它们之间切换。

我正在使用此代码来填充带有标记标题的下拉菜单：

```
// select a marker from dropdown menu
$("select#mySelect").change(function(){ 
      gotoMarker($(this).val()); 
});

function makeMarkerList() {
        var options = "";
        $("select#mySelect").empty();
        for (var i in markers) {
            options += "<option value='" + i + "'>" + markers[i].map.title + "</option>";
        }
        $("select#mySelect").html(options);
} 
```

这就是我到目前为止所拥有的[jsfiddle](http://jsfiddle.net/ymLvv/157/)

这在地图上方显示了一个下拉菜单，但我不知道如何在下拉菜单中获取标记标题。

我感谢您的帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T05:20:39.667

关于您的第二个问题：您的原始代码（如下所示）试图将下拉列表中所选项目的值传递给该`panTo()`方法。但是，由于您设置它的方式，该值只是`markers`数组中标记的索引，而不是`LatLng`对象。将该索引传递给该`panTo()`方法会产生错误。

```
$("select#mySelect").change(function(){ 
      //gotoMarker($(this).val());
    map.panTo($(this).val().getPosition());
}); 
```

要解决此问题，请获取索引，然后使用`markers`数组中的相应标记：

```
$("select#mySelect").change(function(){ 
    var index = $(this).val();
    map.panTo(markers[index].position);
}); 
```

# php - 使用锚标记将值传递给另一个 php 页面

> ID：16071264
> 
> 赞同：2
> 
> 时间：2013-04-17T22:22:38.500
> 
> 标签：php, anchor

我尝试将 PersonID 的值从 list.php 传递给 Delete.php。使用锚标签

这是我的代码：

```
<A HREF = "Delete.php?PID = <?php echo $row['PersonID']; ?>"> Delete </A> 
```

该值已正确传递，但不知何故我没有被重定向到 Delete.php 任何人都可以注意到上述行中的问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T22:24:01.997

去掉 URL 中的空格：

```
<a href="Delete.php?PID=<?php echo $row['PersonID']; ?>"> Delete </a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T22:24:45.597

删除“=”前后的空格：

```
<A HREF="Delete.php?PID=<?php echo $row['PersonID']; ?>"> Delete </A> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-22T06:26:30.510

Code is very well written. I don't know about your database fields and your php file naming conventions but this might help you.

```
<a href="Delete.php?PID=<?=$row['PersonID']?>">Delete</a> 
```

It is same as above but might be it'll helpful. Check your file name delete.php as same in your directory. check your database field name. Is it same you are using ?

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T22:38:28.937

如果你有这个：

```
<a href="Delete.php?PID=<?php echo $row['PersonID']; ?>">Delete</a> 
```

线路不再有问题。您应该检查其他代码。

# java - 用ajax调用一个Bean的函数

> ID：16071267
> 
> 赞同：-2
> 
> 时间：2013-04-17T22:22:43.963
> 
> 标签：java, email, jsf

好吧，伙计们，我需要调用 CorreoController，它是一个 bean，我正在使用 JSF，使用 ajax，因为我需要发送电子邮件，并且我需要创建收件箱。

```
 public Message[] refrescar(String correo, String password, int tipoMail)
{
    Properties prop = new Properties();
    prop.setProperty("mail.pop3.starttls.enable", "false");
    prop.setProperty(
        "mail.pop3.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
    prop.setProperty("mail.pop3.socketFactory.fallback", "false");
    prop.setProperty("mail.pop3.port", "995");
    prop.setProperty("mail.pop3.socketFactory.port", "995");
    Session sesion = Session.getInstance(prop);

    switch(tipoMail)
    {
        case 1:try
    {
      // Se obtiene el Store y el Folder, para poder leer el
      // correo.
        Store store = sesion.getStore("pop3");
        store.connect(
            "pop.gmail.com", correo, password);
        Folder folder = store.getFolder("INBOX");
        folder.open(Folder.READ_ONLY);

        // Se obtienen los mensajes.
        Message[] mensajes = folder.getMessages();

        folder.close(false);
        store.close();
        return mensajes;
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
            break;

        case 2:try
    {
      // Se obtiene el Store y el Folder, para poder leer el
      // correo.
        Store store = sesion.getStore("pop3");
        store.connect(
            "pop3.live.com", correo, password);
        Folder folder = store.getFolder("INBOX");
        folder.open(Folder.READ_ONLY);

        // Se obtienen los mensajes.
        Message[] mensajes = folder.getMessages();

        // Se escribe from y subject de cada mensaje
        /*for (int i = 0; i < mensajes.length; i++)
        {
            System.out.println(
                "From:" + mensajes[i].getFrom()[0].toString());
            System.out.println("Subject:" + mensajes[i].getSubject());

            // Se visualiza, si se sabe como, el contenido de cada mensaje
            analizaParteDeMensaje(mensajes[i]);
        }*/

        folder.close(false);
        store.close();            
        return mensajes;
    }
    catch (Exception e)
    {
        e.printStackTrace();
    }
            break;
        default:break;

    }

    return null;

} 
```

任何人都可以帮我如何提取这些元素mensajes，以及如何在javascript中制作一种dinamyc方式来制作一个表格以添加收集到的信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:36:45.023

要在 JSF 中进行 AJAX 调用，您不需要使用 JavaScript。您可以尝试以下方法。

. 豆子：

```
@ManagedBean
@ViewScope
public class CorreoController {
    private List<Message> mensajes;

    public void refrescar(String correo, String password, int tipoMail) {
        // Your logic

        // Update the mensajes list at the end of this method
        this.mensajes = ...;
    }

    // Getters and Setters
} 
```

. `xhtml`页面：

```
<h:dataTable id="mensajeTable" value="#{correoController.mensajes}" >
    ...
</h:dataTable>

<h:commandButton value="Get mensajes" actionListener="#{correoController.refrescar}" >
    <f:ajax render="mensajeTable" />
</h:commandButton> 
```

# php - 在本地html中加载php

> ID：16071271
> 
> 赞同：-2
> 
> 时间：2013-04-17T22:23:13.673
> 
> 标签：php, javascript, jquery, load

我的本地文件有问题，我不知道是否可能，但我想知道它是否...

我在本地 HTML 中的代码是：

```
$(document).ready(function(){
$("#load").load("http://localhost/prueba.php",{estado:"ok"});}); 
```

而网上的php是：

```
<?php
echo '<script>alert("' . $_POST["estado"] . '");</script>';?> 
```

如果我像“http://localhost /prueba.htm”这样运行我的本地 HTML 运行良好！但是，如果我尝试运行像“C:\documents\prueba.htm”这样的本地文件，则不要运行 php 代码，这就是我所需要的。

这只是一个例子，我真的想在 php 中运行一个查询并将我的信息返回到我的 HTML 文件中。

谁能帮我？抱歉，我的英语不好，但我别无选择……知道该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:32:59.737

主要问题是由于浏览器的**[同源策略](https://developer.mozilla.org/fr/docs/JavaScript/Same_origin_policy_for_JavaScript)****，您的请求将不被允许。**请查看[来自本地文件系统的 jQuery Ajax 请求（Windows 文件：///）](https://stackoverflow.com/questions/5469440/jquery-ajax-request-from-local-filesystem-windows-file)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:47:08.177

Where did you place php code?

Make sure you put it in same folder.

# python - 如何将 url 值传递给 Scrapy 爬网中的所有后续项目？

> ID：16071273
> 
> 赞同：5
> 
> 时间：2013-04-17T22:23:18.163
> 
> 标签：python, web-scraping, scrapy

我正在创建一个 CrawlSpider 来抓取产品网站。从第 1 页，我提取了 www.domain.com/color（简化）形式的类别 URL。在类别页面上，我按照第一个链接到产品详细信息页面，解析产品详细信息页面并通过下一个链接爬到下一个链接。因此，每个颜色类别都有一个独特的爬行路径。

困难在于颜色变量不在产品详细信息页面上。我可以通过解析链接从类别页面中提取它，如下所示：

```
def parse_item(self, response):
        l = XPathItemLoader(item=Greenhouse(), response=response)
        l.default_output_processor = Join()
        l.add_value('color', response.url.split("/")[-1])
        return l.load_item() 
```

但是，我想将此颜色值添加到从产品详细信息页面解析的项目中，以便从特定颜色类别页面开始爬网的产品。产品 url 是通过跟随 Next 链接抓取的，因此在第一个链接之后会丢失参考类别页面。Scrapy 文档中有一些关于 request.meta 的内容，它可以在解析器之间传递数据，但我不确定这是否适用于此。任何帮助，将不胜感激。

我的规则是：

```
Rule(SgmlLinkExtractor(restrict_xpaths=('//table[@id="ctl18_ctlFacetList_dlFacetList"]/tr[2]/td',)),),
Rule(SgmlLinkExtractor(restrict_xpaths=('//table[@id="ctl18_dlProductList"]/tr[1]/td[@class="ProductListItem"][1]',)),callback='parse_item', follow=True,),
Rule(SgmlLinkExtractor(restrict_xpaths=('//a[@id="ctl18_ctl00_lbNext"]',)),callback='parse_item', follow=True, ), 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:10:59.257

您可以使用[`process_request`](http://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.contrib.spiders.Rule)规则的参数：

```
class MySPider(CrawlSpider):
    ...
    rules = [...
        Rule(SgmlLinkExtractor(), process_request='add_color'),
    ]

    def add_color(self, request):
        meta = dict(color=request.url.split("/")[-1])
        return request.replace(meta=meta) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-08T15:22:44.330

我会采用[Steven 的方法](https://stackoverflow.com/a/16071823/939364)，但要编辑原始请求的元数据：

```
class MySPider(CrawlSpider):

    rules = [Rule(SgmlLinkExtractor(), process_request='add_color')]

    def add_color(self, request):
        request.meta['color'] = request.url.split("/")[-1]
        return request 
```

# css - 如何内联显示字符串？

> ID：16071275
> 
> 赞同：0
> 
> 时间：2013-04-17T22:23:22.263
> 
> 标签：css, twitter-bootstrap

如何强制在 twitter bootstrap 中显示文本内联`overflow`？例如，在[http://jsfiddle.net/nonamez/jJdX4/](http://jsfiddle.net/nonamez/jJdX4/) `overflow`中，除了内联词外正在工作。在我的代码中没有任何作用。

![在此处输入图像描述](https://i.stack.imgur.com/1gyp8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:28:33.970

使用`white-space`并将其设置为`nowrap`将使文本进入一行直到到达中断。

```
li {white-space:nowrap;} 
```

[http://jsfiddle.net/jJdX4/1/](http://jsfiddle.net/jJdX4/1/)

# javascript - 主干中的嵌套视图和事件

> ID：16071281
> 
> 赞同：2
> 
> 时间：2013-04-17T22:23:43.703
> 
> 标签：javascript, backbone.js, coffeescript

所以我有两种看法。一个绑定到集合的“父”视图和多个绑定到集合中各个模型的子视图。

```
class ResultTable extends Backbone.View
    el:"body"
    initialize:()->
       @collection.bind "add", @add

    add:(model)->
       new ModelView({model:model})

class ModelView extends Backbone.View
    el: "#resultsTableList"
    initialize:()=>
       @model.on "selected",@select
       @render()

    render:()=>
       #append template 

    select:(e)=>
       e.preventDefault()
       console.log(@model)

    events:
       'click' : 'select' 
```

因此，当我单击列表元素之一时，所有模型视图的选择功能都会被触发。我以为我构建这个的方式只有被点击的特定模型才会出现。这是怎么回事？

模板 HTML-

```
<div id="resultsTableContainer" class="resultsContainer">
    <ul id="resultsTableList">
    </ul> 
```

这适用于每个型号-

```
<li class="result">
{{ ipAddress }}

  </li> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:44:05.643

你所有的 ModelView 都绑定到同一个 DOM 元素：

```
class ModelView extends Backbone.View
    el: "#resultsTableList" 
```

然后每个实例将绑定到点击`#resultsTableList`：

```
events:
   'click' : 'select' 
```

请注意，在[没有选择器的情况下](http://backbonejs.org/#View-delegateEvents)[指定事件`events`](http://backbonejs.org/#View-delegateEvents)会将其绑定到视图的`el`：

> 省略`selector`会导致事件绑定到视图的根元素 ( `this.el`)。

结果是您有多个视图绑定到完全相同的 DOM 元素上的点击。

我想你想`el`从你的 ModelView 中删除 and 让 Backbone`<li>`像这样构建：

```
class ModelView extends Backbone.View
    tagName: 'li'
    className: 'result'
    #... 
```

然后，`el`for`ModelView`将是 an`<li class="result">`并且点击处理程序将附加到`<li>`. 您必须调整渲染以将`el`s 也放入`<ul id="resultsTableList">`调用者中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:45:47.553

我答应我会在答案中解释我的评论，虽然*mu 太短*了得到了正确的答案，但希望它对你也有价值

我的意思是，在绑定时，我更喜欢使用`listenTo`而不是`on`（以避免僵尸侦听器），但是如果您确实使用，`on`那么请确保您在需要时传递上下文，例如

```
this.model.on("selected", this.select); 
```

对比

```
this.model.on("selected", this.select, this); 
```

第一个将`this`对象绑定到`model` 第二个`this`在您调用它时将其绑定到（视图）

所以这一切都取决于你希望你的`this`对象在`select`函数体中是什么

（抱歉，它不在 CoffeeScript 中，我只是不太了解）

# c# - 当 CPU 配置从 AnyCPU 更改为 x86 时，ASP.NET 应用程序崩溃

> ID：16071282
> 
> 赞同：1
> 
> 时间：2013-04-17T22:23:43.953
> 
> 标签：c#, asp.net, iis, build

我有一个带有 2 个模块的 ASP.Net 应用程序：

1.  服务器模块，作为 Windows 服务运行。
2.  安装在 IIS 上的 Web 模块。

在过去的几年里，上述工作完美（一直在工作）。当我必须将应用程序移动到新的 Windows 2008 服务器时，问题刚刚发生。

我所做的是：

1.  将服务器模块上的目标从 AnyCPU 更改为 x86，然后在 BP 机器上对其进行测试，一切正常。
2.  将服务器和 Web 模块移至 Win 2008 服务器。
3.  安装服务并运行它，到目前为止一切顺利。
4.  从网站上，我运行了一个查询，该查询因空指针异常而失败，如下所示：

> 在 System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage（IMessage reqMsg，IMessage retMsg）

这就是我开始旋转的地方。我与服务交谈的代码与此类似：

```
<application name="SHR">
    <client url="tcp://localhost:8039">
        <wellknown type="Package.dal.MyDAO, MyPackage" url="tcp://localhost:8039/SHR/MyDAO.rem"/>           
    </client>
    <channels>
        <channel ref="tcp client">
            <clientProviders>
                <formatter ref="binary" includeVersions="false"/>
                <provider type="server, server"/>
            </clientProviders>
        </channel>
    </channels>
</application> 
```

我运行了 sql profiler，我可以看到我试图调用的类方法确实完全执行，但由于某些原因，它没有返回任何内容。该类本身正确实例化，并且我在插入/删除的地方运行了查询并且一切正常，但是当我需要返回数据集时，即使我知道它不为 null，它也会返回 null）。

当我将 CPU 更改为 x86 时，仅在 Win 2008 中出现此问题。如果我尝试在不将 AnyCPU 更改为 x86 的情况下运行该服务，则会出现另一组错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:43:23.633

好的，就是这样，原来是数据库用户权限。问题是我从 .net 框架得到的错误绝对是垃圾，并且没有指针表明这是由于某种类型的用户权限。感谢每一位尝试过的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:03:50.443

您是否将 web.config 复制到新的 IIS？它可能只是服务器和客户端之间的最大大小消息不匹配

# python - 在 python 中使用二进制文件

> ID：16071286
> 
> 赞同：0
> 
> 时间：2013-04-17T22:23:50.537
> 
> 标签：python, search, binary

有没有一种简单的方法可以使用 Python 处理二进制文件？

我有一个正在接收的数据文件（以 1 和 0 的形式）并且想扫描它并查找二进制中的某些模式。它必须是二进制的，因为由于我的系统，我可能会偏离 1 位左右，这会在转换为十六进制或 ascii 时抛出所有问题。

例如，我想打开文件，然后搜索“0001101010111100110”或一些二进制字符串，让它告诉我它是否存在于文件中，它在哪里等。

这是可行的还是我最好使用另一种语言？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:32:47.240

要将字节字符串转换为 '0' 和 '1' 的字符串，可以使用以下单行：

```
bin_str = ''.join(bin(0x100 + ord(b))[-8:] for b in byte_str) 
```

将其与打开和读取文件相结合：

```
with open(filename, 'rb') as f:
    byte_str = f.read() 
```

现在它只是一个简单的字符串搜索：

```
if '0001101010111100110' in bin_str: 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:31:22.100

您最好使用另一种语言。Python 可以做到（例如，如果你使用 file = open("file", "wb")

（附加 b 以二进制形式打开它），然后使用简单的搜索，但老实说，使用 C 等低级语言更容易、更快捷。

# coldfusion - 在字符串中查找非ASCII字符

> ID：16071289
> 
> 赞同：0
> 
> 时间：2013-04-17T22:24:00.127
> 
> 标签：coldfusion, coldfusion-8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:58:30.590

根据[文档](http://livedocs.adobe.com/coldfusion/8/htmldocs/regexp_08.html)，ColdFusion 的正则表达式实现不支持 \u 转义序列（事实上，我相当肯定它完全不知道 unicode 的概念）。

要在这里做你想做的事，你将不得不使用[Java regexes](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/regex/Pattern.html)。

# javascript - 向下多行填充一个范围（多列） - google-apps-script

> ID：16071297
> 
> 赞同：2
> 
> 时间：2013-04-17T22:24:25.080
> 
> 标签：javascript, google-apps-script, google-sheets

我成功地用范围 A1 中的值填充了单个列 (A) ...

```
 var ss = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var lastRow = ss.getDataRange().getNumRows();  
  var rngVal = ss.getRange("A1").getValue()
  ss.getRange("A2:A"+lastRow).setValue(rngVal) 
```

所以后来我以为我在easy-street上，我试图通过用C1：H1范围内的值填充多列范围来修改/应用到更大的范围......

```
 var ss = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var lastRow = ss.getDataRange().getNumRows();  
  var rngVal = ss.getRange("C1:H1").getValues()
  ss.getRange("C2:H"+lastRow).setValues(rngVal) 
```

显然，这不仅仅是在“Value”这个词的末尾加上一个“S”。

错误如下：

> 范围高度不正确，为 1 但应为 10

（仅供参考：var lastRow = 11）

顺便说一句，如果我使用 Value 而不是 Value ***s***，我不会收到任何错误，尽管我最终得到的单元格中充满了仅在范围 C1 中找到的值。

所以我很接近......或者很远。其中的一个。

帮助？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:52:19.477

错误消息非常明确...数组的大小必须适合 getValues 和 setValues 的范围。试试这样：

```
function myFunction() {
  var ss = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var lastRow = ss.getLastRow()  
  var rngVal = ss.getRange("C1:H"+lastRow).getValues();// get an array of 10 "rows" and 6 "columns"
  ss.getRange("C2:H"+(lastRow+1)).setValues(rngVal);//write back this array to a range that has the same size. (starting from Row2 it must ends on lastRow+1 to keep the same number of "rows"
} 
```

此函数会将范围 C1:H last Row 转换为 C2:H lastRow+1，不确定它是否非常有用，但这不是重点 ;-)

* * *

编辑：对不起，我没有完全理解你的要求......这是一个从 C1:H1 复制数据的代码在下面的所有行中

```
function myFunction() {
  var ss = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var lastRow = ss.getLastRow()  
  var rngVal = ss.getRange("C1:H1").getValues();// get an array of the first row
  var rowData = rngVal[0]
  var newData = []
  for(n=1;n<lastRow;++n){newData.push(rowData)}
  ss.getRange("C2:H"+lastRow).setValues(newData);//write back this array to a range that has the same size. (starting from Row2 it must ends on lastRow+1 to keep the same number of "rows"
} 
```

**EDIT2 在您的评论之后：**

*一句话解释：*

使用时，`range.getValues()`我们得到一个二维数组，这意味着可以表示如下的数组数组：`[[data1,data2,data3],[data4,data5,data6]]`data1、2 和 3 是第一个数组的值（索引 0），数据 4,5 和 6 是第二个数组的值数组（索引 1）。因此，如果您想获取第一个数组中的值，则必须这样编写：`value = arrayName[0]`这将返回一个一维数组`[data1,data2,data3]`，这就是我用来获取 rowData 的方法。

现在我们需要再次获取一个二维数组，以便能够将新数据写回电子表格中的某个范围。因此，我们创建了一个新数组（`var newData=[]`或`var newData = new Array()`完全相同），在 for 循环中，我们将 rowData 数组添加到这个新数组中......结果将是一个数组数组，这实际上是我们正在寻找的，我们可以在一个`setValues`语句中直接将其写入工作表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:33:13.827

好吧，这似乎做到了......

```
 var ss = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Sheet1");
  var lastRow = ss.getLastRow()  
  var rngVal = ss.getRange("C1:H1").getValues()
  for (var x=1; x<=lastRow; x++) {
  ss.getRange("C"+x+":H"+x).setValues(rngVal); 
```

# json - 当JSonToObject时消失的SubDetail TObjectList

> ID：16071298
> 
> 赞同：2
> 
> 时间：2013-04-17T22:24:34.957
> 
> 标签：json, delphi, converter, tobjectlist, tobject

这是我的第一个问题。对不起我的英语。

我有这样的课程：

```
TSFis_S = class(TPersistent)
private
  _SFis_MID  : Integer;
public
  property SFis_MID : Integer read _SFis_MID write _SFis_MID;
end;

TSFis_D = class(TPersistent)
private
  _SFis_MID    : Integer;
  _SFis_S      : TObjectList<TSFis_S>;
public
  property SFis_MID    : Integer read _SFis_MID write _SFis_MID;
  property SFis_S : TObjectList<TSFis_S> read _SFis_S write _SFis_S;
end;

TSFis_M = class(TPersistent)
private
  _SFis_MID : Integer;
  _SFis_D : TObjectList<TSFis_D>;
public
  property SFis_MID    : Integer read _SFis_MID write _SFis_MID;
  property SFis_D      : TObjectList<TSFis_D> read _SFis_D write _SFis_D;
  function ToJSON:TJSONValue;
  destructor Destroy;
end; 
```

我尝试将 TSFis_M 对象转换为 JSon 并为我的 datasnap 应用程序恢复为对象。我对我的数据类型（TObjectList 和 TObjectList）使用转换和恢复器

```
{ TSFis_M }

function JSonToSFis_M(json: TJSONValue): TSFis_M;
var
  UnMarshaller: TJSONUnMarshal;
begin
  if json is TJSONNull then
    exit(nil);
  UnMarshaller := TJSONUnMarshal.Create;
  try
    UnMarshaller.RegisterReverter(TSFis_M, '_FisTar',
      procedure(Data: TObject; Field: string; Arg: string)
      var
        ctx: TRttiContext;
        datetime :
        TDateTime;
      begin
        datetime := EncodeDateTime(StrToInt(Copy(Arg, 7, 4)), StrToInt(Copy(Arg, 4, 2)), StrToInt(Copy(Arg, 1, 2)), StrToInt
            (Copy(Arg, 12, 2)), StrToInt(Copy(Arg, 15, 2)), StrToInt(Copy(Arg, 18, 2)), 0);
        ctx.GetType(Data.ClassType).GetField(Field).SetValue(Data, datetime);
      end
    );
    UnMarshaller.RegisterReverter(TSFis_D, '_SFis_S',
      procedure(Data: TObject; Field: String; Args: TListOfObjects)
      var
        obj: TObject;
        SFisS: TObjectList<TSFis_S>;
        SFis, SFisNew: TSFis_S;
      begin
        if TSFis_D(Data)._SFis_S=Nil
          then TSFis_D(Data)._SFis_S := TObjectList<TSFis_S>.Create(True);
        SFisS := TSFis_D(Data)._SFis_S;
        SFisS.Clear;
        for obj in Args do
        begin
          SFis := obj as TSFis_S;
          SFisNew := TSFis_S.Create;
          SFisS.Add(SFisNew);
          SFisNew._SFis_MID := SFis._SFis_MID;
        end;
      end
    );
    UnMarshaller.RegisterReverter(TSFis_M, '_SFis_D',
      procedure(Data: TObject; Field: String; Args: TListOfObjects)
      var
        obj: TObject;
        SFisD: TObjectList<TSFis_D>;
        SFis, SFisNew: TSFis_D;
        i: integer;
      begin
        if TSFis_M(Data)._SFis_D=Nil then
          TSFis_M(Data)._SFis_D := TObjectList<TSFis_D>.Create(True);
        SFisD := TSFis_M(Data)._SFis_D;
        SFisD.Clear;
        for obj in Args do
        begin
          SFis := obj as TSFis_D;
          SFisNew := TSFis_D.Create;
          SFisD.Add(SFisNew);
          SFisNew._SFis_MID := SFis._SFis_MID;
        end;
      end
    );
    exit(Unmarshaller.Unmarshal(json) as TSFis_M)
  finally
    UnMarshaller.Free;
  end;
end;

function TSFis_M.ToJSON: TJSONValue;
var
  Marshaller: TJSONMarshal;
begin
  if Assigned(Self) then
  begin
    Marshaller := TJSONMarshal.Create(TJSONConverter.Create);
    try
      Marshaller.RegisterConverter(TSFis_M, '_SFis_D',
                            function(Data: TObject; Field: String): TListOfObjects
                            var
                              FisD: TObjectList<TSFis_D>;
                              i: integer;
                            begin
                              FisD := TSFis_M(Data)._SFis_D;
                              SetLength(Result, FisD.Count);
                              if FisD.Count > 0 then
                                for I := 0 to FisD.Count - 1 do
                                  Result[I] := FisD[i];
                            end);
      Marshaller.RegisterConverter(TSFis_M, '_FisTar',
                            function(Data: TObject; Field: string): string
                            var
                              ctx: TRttiContext; date : TDateTime;
                            begin
                              date := ctx.GetType(Data.ClassType).GetField(Field).GetValue(Data).AsType<TDateTime>;
                              Result := FormatDateTime('dd.mm.yyyy hh:nn:ss', date);
                            end);
      Marshaller.RegisterConverter(TSFis_D, '_SFis_S',
                            function(Data: TObject; Field: String): TListOfObjects
                            var
                              FisD: TObjectList<TSFis_S>;
                              i: integer;
                            begin
                              FisD := TSFis_D(Data)._SFis_S;
                              SetLength(Result, FisD.Count);
                              if FisD.Count > 0 then
                                for I := 0 to FisD.Count - 1 do
                                  Result[I] := FisD[i];
                            end);

      exit(Marshaller.Marshal(Self))
    finally
      Marshaller.Free;
    end;
  end
  else
    exit(TJSONNull.Create);
end; 
```

最后，例如，我在表格上放了 1 个按钮和 2 个备忘录。我尝试将我创建的对象转换为 Json，将 Json.ToString 转换为 Memo1。并将该 JSONValue 转换为 Object。

```
procedure TForm1.Button1Click(Sender: TObject);
var
  MainFis : TSFis_M;
  MainFis2 : TSFis_M;
  DFis    : TSFis_D;
  SFis    : TSFis_S;
begin
  MainFis := TSFis_M.Create;
  MainFis.SFis_D := TObjectList<TSFis_D>.Create(True);
  DFis := TSFis_D.Create;
  DFis._SFis_MID := 1;
  MainFis.SFis_D.Add(DFis);
  SFis := TSFis_S.Create;
  SFis._SFis_MID := 1;
  DFis.SFis_S := TObjectList<TSFis_S>.Create(True);
  DFis.SFis_S.Add(SFis);
  Memo1.Text := MainFis.ToJSON.ToString;
  Edit1.Text := IntToStr(MainFis.SFis_D[0].SFis_S.Count);
  MainFis2 := JSonToSFis_M(MainFis.ToJSON);
  Edit2.Text := IntToStr(MainFis2.SFis_D[0].SFis_S.Count); // Access violation. Because MainFis2.SFis_D[0].SFis_S = Nil Now (That's the my problem. Why?)
  Memo2.Text := MainFis2.ToJSon.ToString;
end; 
```

但是当我这样做时。TSFis_S 正在消失。在第一步（ObjectToJSon）没有问题。

```
{"type":"Unit1.TSFis_M","id":1,"fields": 
    {"_SFis_MID":0,"_SFis_D":
      [ {"type":"Unit1‌​.TSFis_D","id":2,"fields":
            {"_SFis_MID":1,"_SFis_S":
                [ {"type":"Unit1.TSFis_S","id":‌​3,"fields":{"_SFis_MID":1} } ] 
            }
      } ]
    }
} 
```

但是当我尝试恢复到对象时，恢复器出错了。

我找不到问题。我有什么错。

谢谢

PS：如果我没有解释，这里的示例代码：http: [//goo.gl/3QnSw](http://goo.gl/3QnSw)

# c++ - 在 C++ 中通过常量引用传递指向对象的指针

> ID：16071305
> 
> 赞同：4
> 
> 时间：2013-04-17T22:25:21.370
> 
> 标签：c++, pointers, parameters, reference, constants

我正在为大学做一个实际作业，我遇到了一个问题。我有一个声明这个方法的类：

```
bool graficarTablero(const Tablero *&tablero, const string &nombreArchivo); 
```

我想通过常量引用传递一个指向对象 Tablero 的指针。如果我调用该函数，例如：

```
ArchivoGrafico *grafico = new ArchivoGrafico;
if(grafico->graficarTablero(tablero, ARCHIVO_GRAFICO)){ ... 
```

...我得到编译错误。好的，我不会详细说明我得到的错误，因为我认为我已经找到了解决方案，方法是将方法头替换为：

```
bool graficarTablero(Tablero* const& tablero, const string &nombreArchivo); 
```

现在似乎可以工作（至少现在可以编译），但我想知道的是第一个声明不起作用而第二个声明不起作用的原因。好吧，更重要的是，我真正想知道它们是否真的意味着同一件事（通过常量引用指向对象的指针）。

嗯，谢谢你的回答。

* * *

编辑1：我想做的是避免按值传递。好吧，我知道这并不是一个真正昂贵的操作，但是真的没有办法使用同一个指针并承诺不会以任何方式修改它吗？

谢谢。

* * *

编辑 2：对不起，我没有仔细阅读 Jerry Coffin 的回答。是的，这就是我要找的。并不是说我真的必须这样做，但有一天我可能会发现这个小小的优化很有用。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T22:31:35.997

`&`使用“reference to” for和“pointer to” for阅读声明从右到左`*`。

1.  `const Tablero *&tablero`=> tablero 是对指向 const Tablero 的指针的引用
2.  `Tablero* const& tablero`=> tablero 是对指向 Tablero 的 const 指针的引用

我很难弄清楚后者是否有用——如果你要传递一个 const 引用，你也可以只传递一个指针本身的副本。const 引用通常主要用作按值传递的替代方法，但要避免复制值，因此它主要在您的值较大（例如，较大`std::vector`或按该顺序）时很有用。在指针的情况下，您最好按值传递它（因为复制指针通常非常便宜）。通常，如果您通过引用传递指针，那么您可以修改指针 - 但在这种情况下会`const`阻止这种情况。

# python - “math.floor(x)”和“int(x)”对 Python 中的正实数产生不同的结果吗？

> ID：16071306
> 
> 赞同：1
> 
> 时间：2013-04-17T22:25:23.463
> 
> 标签：python, random, int, floor

我检查了 Python shell 上的一些示例，它们似乎吐出了相同的数字。但是在一个应该对大量数字进行近似的程序中，它们显然会产生不同的结果。

我正在尝试编写一个小程序来模拟对象在矩形平面上的运动。为此，我必须编写一个名为“RectangularRoom”的类，它接受宽度和高度并创建一个网格：

```
class RectangularRoom(object):
"""
A RectangularRoom represents a rectangular region containing clean or dirty
tiles.

A room has a width and a height and contains (width * height) tiles. At any
particular time, each of these tiles is either clean or dirty.
"""
def __init__(self, width, height):
    """
    Initializes a rectangular room with the specified width and height.

    Initially, no tiles in the room have been cleaned.

    width: an integer > 0
    height: an integer > 0
    """
    self.width = width
    self.height = height
    self.room_coordinates = []
    for m in range(self.width):
        for n in range(self.height):
            self.room_coordinates.append((m,n))
    self.cleaned = []
def cleanTileAtPosition(self, pos):
    """
    Mark the tile under the position POS as cleaned.

    Assumes that POS represents a valid position inside this room.

    pos: a Position
    """
    self.cleaned.append((int(pos.getX()), int(pos.getY())))

def isTileCleaned(self, m, n):
    """
    Return True if the tile (m, n) has been cleaned.

    Assumes that (m, n) represents a valid tile inside the room.

    m: an integer
    n: an integer
    returns: True if (m, n) is cleaned, False otherwise
    """
    assert type (m)== int and type (n) == int
    return (m,n) in self.cleaned

def getNumTiles(self):
    """
    Return the total number of tiles in the room.

    returns: an integer
    """
    return self.width*self.height

def getNumCleanedTiles(self):
    """
    Return the total number of clean tiles in the room.

    returns: an integer
    """
    return len(self.cleaned)

def getRandomPosition(self):
    """ 
    Return a random position inside the room.

    returns: a Position object.
    """
    return Position (random.randrange(0 , self.width), random.randrange(0 , self.height))

def isPositionInRoom(self, pos):
    """
    Return True if pos is inside the room.

    pos: a Position object.
    returns: True if pos is in the room, False otherwise.
    """
    return (int(pos.getX()), int(pos.getY())) in self.room_coordinates 
```

如您所见，我使用 int() 方法和随机生成器“random.randrange”实现了它。

在解决方案中，老师使用 math.floor() 函数和随机生成器 random.random() 实现了这个类：

```
class RectangularRoom(object):
"""
A RectangularRoom represents a rectangular region containing clean or dirty
tiles.

A room has a width and a height and contains (width * height) tiles. At any
particular time, each of these tiles is either clean or dirty.
"""
def __init__(self, width, height):
    """
    Initializes a rectangular room with the specified width and height.

    Initially, no tiles in the room have been cleaned.

    width: an integer > 0
    height: an integer > 0
    """
    self.width = width
    self.height = height
    self.tiles = {}
    for x in range(self.width):
        for y in range(self.height):
            self.tiles[(x, y)] = False

def cleanTileAtPosition(self, pos):
    """
    Mark the tile under the position POS as cleaned.

    Assumes that POS represents a valid position inside this room.

    pos: a Position
    """
    x = math.floor(pos.getX())
    y = math.floor(pos.getY())
    self.tiles[(x, y)] = True

def isTileCleaned(self, m, n):
    """
    Return True if the tile (m, n) has been cleaned.

    Assumes that (m, n) represents a valid tile inside the room.

    m: an integer
    n: an integer
    returns: True if (m, n) is cleaned, False otherwise
    """
    return self.tiles[(m, n)]

def getNumTiles(self):
    """
    Return the total number of tiles in the room.

    returns: an integer
    """
    return self.width * self.height

def getNumCleanedTiles(self):
    """
    Return the total number of clean tiles in the room.

    returns: an integer
    """
    return sum(self.tiles.values())

def getRandomPosition(self):
    """
    Return a random position inside the room.

    returns: a Position object.
    """
    return Position(random.random() * self.width,
                    random.random() * self.height)

def isPositionInRoom(self, pos):
    """
    Return True if pos is inside the room.

    pos: a Position object.
    returns: True if pos is in the room, False otherwise.
    """
    return ((0 <= pos.getX() < self.width)
            and (0 <= pos.getY() < self.height)) 
```

令人惊讶的是，这两段代码产生了完全不同的结果。我想知道为什么会这样。int() 和 floor() 应该对正数具有相同的效果，并且两个随机函数似乎产生相似的数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T22:51:34.637

好吧，我不知道你的问题的答案——我怀疑他们返回的东西完全相同。但是，我认为您的解决方案存在可能解释输出的问题：

在'cleanTileAtPosition'

```
self.cleaned.append((int(pos.getX()), int(pos.getY()))) 
```

在“getNumCleanedTiles”中

```
return len(self.cleaned) 
```

此代码似乎允许多次清洁瓷砖。这不是您的教师代码所做的，因为磁贴只能设置为“真”一次。

（顺便说一句，因为 random.randrange 返回一个整数.. 整数转换应该什么都不做！）

编辑：另外 - 我认为类型差异值得考虑。但是你所有的类型都是“整数”，所以它不应该是一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T22:49:37.767

你的方法有一个很大的不同。`random.randrange`返回一个整数，然后调用`int()`位置。您正在使用整数。同时，`random.random() * something`返回一个浮点数，`math.floor`也返回一个浮点数。你的老师一直在使用花车。

这至少是 和 之间的区别`int`，`math.floor`但我不知道为什么会产生完全不同的结果。你能更具体一点吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T22:50:50.940

考虑以下示例：

```
>>> a = 1.2
>>> b = int(a)
>>> c = math.floor(a)
>>> b
1
>>> c
1.0
>>> type(c)
<type 'float'>
>>> type(a)
<type 'float'>
>>> type(b)
<type 'int'> 
```

即使 int() 和 floor() 对正整数做“同样的事情”，结果却是不同的类型。这可能会导致各种不同的交互，具体取决于您稍后对它们执行的操作。Python 会从它的角度弄清楚如何让它“工作”，尽管它不一定会给你想要的结果。

通常，在编程中进行任何类型的数学运算时，您都希望使用的类型保持一致，这样您就不必担心类型转换和提升以及所有那些讨厌的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T22:49:15.857

Using "integers" instead of math.floor terhe would be better - still, Python has enough black magic in float <-> integer comparisons that this difference alone should be no problem in the code above. The code however, in both versions has a distinct Java or C++ "accent" making it much more complictaed than simple Python code can be. It is likely the difference arises in some other point of the code - not on this rounding. For example - try using `random.randint` instead of getting a float and later rounding it, to start with.

# python - 添加自定义信息以进行日志记录的最佳方式

> ID：16071309
> 
> 赞同：1
> 
> 时间：2013-04-17T22:25:39.647
> 
> 标签：python, logging

我一直在阅读 Python[日志记录](http://docs.python.org/3.1/library/logging.html)文档，它当然有很多功能……适用于所有内容。

我面临的问题是我不是荷兰人，所以我不确定这样做的正确方法是什么。

我在模拟器中运行事件，我想在每条日志消息前加上*模拟*时间的时间戳（可能也有一个长度格式化程序，只是为了让它看起来不错）。我可以在`Logger`or的子类中更改它`Handler`，但我认为这不是正确的方法。

我认为正确的方法是使用 a`LoggerAdapter`或 a `Filter`。这是正确的，如果是这样，我应该更喜欢哪一个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:12:16.037

当然，如果您只需要在每条日志消息前加上时间戳，您需要做的就是为格式化程序提供适当的格式字符串？如文档中所述[。](http://docs.python.org/3/howto/logging.html#displaying-the-date-time-in-messages)

**更新：** A`LoggerAdapter`更适合上下文信息存在时间较长的情况。例如，在处理多个客户端连接的网络服务器应用程序中，连接详细信息（例如客户端 IP 地址）可能是有用的上下文，因此您将在创建`LoggerAdapter`新客户端连接时创建一个实例。这听起来不像您的模拟场景。

`Filter`另一方面，如果您可以使用A来获取模拟时间，则可以使用它，例如

```
class SimulationFilter(logging.Filter):
    def __init__(self, context):
        """
        Set up with context passed in which allows access
        to simulation times.
        """
        self.context = context

    def filter(self, record):
        "Add sim_time field to record, formatted as you wish"
        record.sim_time = '%s' % self.context.get_sim_time()
        return True 
```

然后添加`%(sim_time)s`你`Formatter`的格式字符串。

或者，如果您在进行日志调用时知道模拟时间，则可以执行例如

```
logger.debug('Message with %s', arguments, extra={'sim_time': sim_time}) 
```

并且同样有`%(sim_time)s`你`Formatter`的格式字符串。

# python - 错误或意味着：numpy 为重复的布尔索引引发“ValueError：太多布尔索引”

> ID：16071310
> 
> 赞同：7
> 
> 时间：2013-04-17T22:25:39.687
> 
> 标签：python, numpy, multidimensional-array

我在实验宇宙学中做一些模拟，在使用 numpy 数组时遇到了这个问题。我是 numpy 的新手，所以我不确定我做错了还是错误。我跑：

```
Enthought Python Distribution -- www.enthought.com
Version: 7.3-1 (32-bit)

Python 2.7.3 |EPD 7.3-1 (32-bit)| (default, Apr 12 2012, 11:28:34) 
[GCC 4.0.1 (Apple Inc. build 5493)] on darwin
Type "credits", "demo" or "enthought" for more information.
>>> import numpy as np
>>> t = np.arange(10)
>>> t[t < 8][t < 5]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: too many boolean indices
>>> 
```

我希望它会返回：

```
array([0, 1, 2, 3, 4]) 
```

因为 t[t < 8] 大概应该被视为另一个ndarray？

numpy 文档（[http://docs.scipy.org/doc/numpy/user/basics.indexing.html](http://docs.scipy.org/doc/numpy/user/basics.indexing.html)）说布尔数组作为索引：

> 与索引数组一样，返回的是数据的副本，而不是切片时的视图。

running`type(t[t < 8])`也给出了`ndarray`，我猜它应该具有 numpy 数组的所有属性。我应该用列表表达式做得更好吗？我还没有进行定时比较，但我想这对于大型二维数组来说是个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T22:38:54.870

`t[ t < 8 ]`确实给你一个数组，但是，它没有给你一个与你开始时大小相同的数组。 `t < 8`将给出一个与 . 形状相同的布尔数组`t`。当您使用它来索引`t`时，您只提取布尔数组为`True`您留下较短数组的元素。当你再次这样做时：

```
result = t[t<8]
result[t<5] 
```

然后布尔索引数组的形状`t`再次相同，但是您使用它来索引一个较小的数组，这就是导致错误的原因。

该文档是完全正确的。您的新数组不是`view`原始数组...它是数据的副本，但这并不意味着新数组的形状或大小与原始数组相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:39:20.520

这是注定的。当您到达第二个布尔语句时，对“t”的引用已经毫无意义。在第一个语句中，您将 t 分段为小于 8 的值。在第二个语句中，您仍在分段“t”，但在一个临时数组上（称为“s”）。's' 上的索引请求不能始终正确映射到 't'。因此它抛出一个异常。

如果你想做多个布尔语句。将它们组合起来，使其显示为：

```
s = t[t < 8]
s[s < 5] 
```

或者来自@mgilson：

```
t[np.logical_and(t < 8, t < 5)] 
```

# jquery - 编辑模式下的jQuery数据表列宽

> ID：16071313
> 
> 赞同：1
> 
> 时间：2013-04-17T22:25:54.510
> 
> 标签：jquery, jquery-datatables

我正在使用具有内联编辑功能的 jQuery 数据表。我成功地为表格定义了所有自定义宽度，但是，一旦我进入编辑模式，列宽就会扩大，表格会不断来回跳跃。似乎视图“sWidth”工作正常，并且我得到了所需的列宽，但是一旦用户按下双击进入编辑模式，列大小就会扩大并挤压所有其他列。这是实际 js 代码中挥之不去的问题还是我做错了什么？

这是我的脚本：

```
$(document).ready(function(){
                oTable = $("#datatables").dataTable({
                            "aoColumns" : [
                                {
                                    "sName" : "fullName",
                                    "sWidth" : "15%"
                                },
                                {
                                    "sName" : "location",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "lengthOfStay",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "codeStatus",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "dvt",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "catheter",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "lae",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "lace",
                                    "sClass": "alignCenter"
                                },
                                {
                                    "sName" : "comments",
                                    "sWidth" : "25%"
                                },
                                {
                                    "sName" : "discharge",
                                    "sClass": "alignCenter"
                                }
                             ],
                            "aaSorting":[[1, "desc"]],
                            "bPaginate": false,
                            "bLengthChange": false,
                            "bFilter": false,
                            "bSort": true,
                            "bInfo": false,
                            "bAutoWidth": false,
                            "sAjaxSource" : 'checklistdataallteam',
                            "sServerMethod": "GET",
                            "fnDrawCallback" : function(oSettings) {
                                //The call to makeEditable is set here to make sure all the data are loaded 
                                this.makeEditable({
                                    oEditableSettings: { event: 'dblclick' },
                                    sUpdateURL : 'UpdateChecklistData',
                                    aoColumns : [
                                         null,  //patient name; no editing
                                         null,  //location; no editing  
                                         null,  //stay length; no editing
                                         {      //code status; default edit
                                            placeholder: '-'
                                         }, 
                                         {      //dvt; default edit
                                            placeholder: '-',
                                         }, 
                                         {      //catheter, default edit
                                            placeholder: '-',
                                         },
                                         null,  //lae; no editing
                                         null,  //lace; no editing
                                         {      //comment; default editing
                                            placeholder: '-',
                                         }, 
                                         null   //discharge; no editing                                          
                                     ]
                                });
                            }
                   });
        }); 
```

我正在使用 Jeditable 1.7.1 版、Datatables 1.9.4 版和 jquery.dataTables.editable.js 1.1.5 版

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-31T23:00:01.947

我相信您的问题可以通过在初始化数据表的 jeditable 函数时将 width 属性设置为 100% 来解决。请参见此处： [DataTable Column 在编辑时调整大小](http://datatables.net/forums/discussion/7950/an-editable-column-via-jeditable-resizes-gets-wider-on-clicking-in-another-cell-in-the-same-column/p1)

该链接指的是可编辑的演示，当您查看[该页面上](http://datatables.net/beta/1.9/examples/api/editable.html)的代码时，您可以看到宽度属性是如何使用的。

# php - 从while循环中获取特定变量以提交表单

> ID：16071320
> 
> 赞同：0
> 
> 时间：2013-04-17T22:26:26.323
> 
> 标签：php, mysql

我有一个带有复选框的while循环生成信息，我想用新的“完成”值更新数据库。如何选择生成的特定复选框。请帮助向我展示如何获取复选框和任务名称的特定值。

谢谢，瑞安

```
 while ($row = mysql_fetch_array($query)){
        $task_name = $row['task_name'] ;
        $task_description = $row['task_description'];
        $task_completed = $row['completed'];
        $tasks .= '<div id="tasksBody">
                    <form action="" method="post">Completed? <input name="completed" type="checkbox" '.
                    ($task_completed == 1?'checked="checked"':'').
                    ' /><input type="submit" value="Update"><br /><br />
                    <b>'.$task_name.'</b><br /><br />'.$task_description.'<hr><br /></form></div>';
        }
}
echo $tasks; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:30:10.837

您需要使用行的唯一名称来命名您的输入，例如 task_name，或者更好的是数据库记录 ID。

然后当用户提交表单时，您将使用 $_POST["YourTaskNameOrIDHere"] 来检查值。

您当前所拥有的所有复选框都称为同一件事。

* * *

编辑：对不起，您以自己的形式隔离了所有这些，我刚刚意识到这一点。您可以添加一个`<input type="hidden" value="$task_name" name="TaskName" />`到表单中，因此您可以查看复选框对应的内容。然后，当用户提交表单时，使用 $_POST["TaskName"] 找出任务的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:38:50.107

向每个包含以下内容的表单添加一个隐藏字段`task_id`

```
<form action="" method="post">
    Completed? 
    <input name="completed" type="checkbox" <?=($task_completed == 1?'checked="checked"':'')?> value="1" />
    ...
    <input name="task_id" value="<?=$task_id"?> type="hidden" />**strong text**
</form> 
```

提交后：

```
if (isset($_POST['task_id']) { // form has been submitted

    $task_id = $_POST['task_id'];
    $completed = $_POST['completed'];

    $sql = "UPDATE task SET task_completed=$completed WHERE task_id=$task_id LIMIT 1";
    // code for updating database
    // better use PDO or mysqli-* instead of old and deprecated mysql_*
} 
```

# ant - 如何从 phing/ant FileSet 中排除基目录

> ID：16071324
> 
> 赞同：0
> 
> 时间：2013-04-17T22:27:01.543
> 
> 标签：ant, phing, fileset, build-tools

我有一个 phing 构建目标，我想直接在我的项目库下的每个目录上运行。我正在使用带有文件集的 foreach 任务在每个目录上运行目标。我遇到的问题是包含基本目录，文件名为“”。

这是目录结构的示例：

```
One
Two
build.xml 
```

这是一个简单的构建文件来测试：

```
<?xml version="1.0" encoding="UTF-8"?>

<project name="Test" default="test">

    <target name="test">
        <foreach param="filename" absparam="absfilename" target="echo-file">
            <fileset dir="${project.basedir}">
                <include name="*" />
                <exclude name="*.*" />
            </fileset>
        </foreach>
    </target>

    <target name="echo-file">
        <echo message="filename: ${filename}" />
        <echo message="absfilename: ${absfilename}" />
    </target>

</project> 
```

这是构建的结果（注意第一个条目为空文件名）：

```
Buildfile: /Users/dmertl/test/build.xml

Test > test:

  [foreach] Calling Buildfile '/Users/dmertl/test/build.xml' with target 'echo-file'

Test > echo-file:

     [echo] filename: 
     [echo] absfilename: /Users/dmertl/test/
  [foreach] Calling Buildfile '/Users/dmertl/test/build.xml' with target 'echo-file'

Test > echo-file:

     [echo] filename: One
     [echo] absfilename: /Users/dmertl/test/One
  [foreach] Calling Buildfile '/Users/dmertl/test/build.xml' with target 'echo-file'

Test > echo-file:

     [echo] filename: Two
     [echo] absfilename: /Users/dmertl/test/Two 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T00:05:37.073

不知道我第一次怎么没弄明白，但这是解决方案：

```
<foreach param="filename" absparam="absfilename" target="echo-file">
    <fileset dir="${project.basedir}">
        <include name="*" />
        <exclude name="/" />
        <exclude name="*.*" />
    </fileset>
</foreach> 
```

在文件集中排除“/”会删除根目录。

# javascript - 脚本适用于 Chrome 但不适用于 IE

> ID：16071326
> 
> 赞同：1
> 
> 时间：2013-04-17T22:27:19.983
> 
> 标签：javascript, internet-explorer, google-chrome, cross-browser

这很简单，但我不知道为什么 IE 不做我的 innerHTML 更改和其他事情。

```
 function changeele2() {
        document.getElementById("eleme2");
        document.getElementById("workout");
        document.getElementById("workoutweek");

        if(workout.value == "Yes") { 
            eleme2.style.display = "inline-block";
            workoutweek.className += " requiredField";
        }

    } 
```

如果我更改下拉列表的值，它会调用：

```
 <select id="workout" onchange="changeele2()">
      <option>No</option>
      <option>Yes</option>
  </select> 
```

两者都不适用于带有文本的按钮

我就是找不到。有人有想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T22:29:37.720

当您这样做时，`document.getElementById("eleme2")`您必须保存该操作的结果并将其用于后续访问该元素。

```
function changeele2() {
    var eleme2 = document.getElementById("eleme2");
    var workout = document.getElementById("workout");
    var workoutweek = document.getElementById("workoutweek");

    if (workout.value == "Yes") { 
        eleme2.style.display = "inline-block";
        workoutweek.className += " requiredField";
    }
} 
```

有一些浏览器使用与元素 id 相同的名称来创建一个全局变量，因此这可能是它有时工作的原因，但你不应该依赖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:30:38.650

这个脚本根本不应该工作，chrome通过ID查找元素来挽救它。

你应该像这样改变它：

```
function changeele2()
    {
        var eleme2 = document.getElementById("eleme2");
        var workout = document.getElementById("workout");
        var workoutweek = document.getElementById("workoutweek");

        if(workout.value == "Yes") { 
        eleme2.style.display = "inline-block";
        workoutweek.className += " requiredField";

        }
} 
```

# ruby-on-rails - 使用弹性搜索在多边形内搜索多边形

> ID：16071328
> 
> 赞同：2
> 
> 时间：2013-04-17T22:27:33.030
> 
> 标签：ruby-on-rails, elasticsearch

有没有办法使用弹性搜索搜索位于另一个多边形内的多边形？

如果没有，是否可以使用 Solr 或其他系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-14T14:30:28.300

在 Elasticsearch 上完全可以：

[http://elasticsearch-users.115913.n3.nabble.com/Can-I-use-geo-polygon-filter-to-retrieve-hits-based-on-polygon-fields-td4044079.html](http://elasticsearch-users.115913.n3.nabble.com/Can-I-use-geo-polygon-filter-to-retrieve-hits-based-on-polygon-fields-td4044079.html)

我只是在考虑自己实现它，我唯一担心的是在高流量站点上的性能，所以我们会看看会发生什么。

由于这篇文章是不久前发布的，因此知道您最终做了什么会很有趣...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:46:26.213

很确定这是不可能的 ES。

使用 Solr + 一些插件，我认为这是可能的，但我自己没有尝试过。看看[https://github.com/spatial4j/spatial4j](https://github.com/spatial4j/spatial4j)

> 地理空间感知的形状类形状：点、矩形、圆形、多边形（通过 JTS）形状相交逻辑，产生：不相交、包含、在、相交边界框面积计算

Solr 中似乎已经包含了 spatial4J。请参阅以下链接中的 David Smiley 的回复（Spatial4J 的作者和 Solr 的提交者） [How to install spatial4j into solr4](https://stackoverflow.com/questions/13282014/how-to-install-spatial4j-into-solr4)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T17:39:30.617

有了 Solr 4.3，这才成为可能；几周前我刚刚完成了这项工作，我对此感到非常兴奋。要了解如何使用新的 Solr 4 空间字段，请参阅： [http](http://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4) : //wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4 新功能是您现在可以使用“IsWithin”和“Contains”谓词；还有“IsDisjointTo”。根据您的问题，我不清楚您想要哪些。想象一个由 3 部分组成的句子，其中第一/左部分是您的索引数据，然后是空间谓词，然后是您的查询形状。因此，如果要搜索查询形状内的索引形状，请使用“IsWithin”。我正要更新 wiki 以显示这些谓词。

# php - Apache mod_rewrite 用于同一目录下的特定域

> ID：16071330
> 
> 赞同：0
> 
> 时间：2013-04-17T22:27:41.110
> 
> 标签：php, apache, mod-rewrite, yii

我已经使用 PHP & Yii 框架编写了一个网站，并且我的`.htaccess`文件中包含`mod_rewrite`使用干净 URL 的声明：

```
Options +FollowSymLinks
IndexIgnore */*

RewriteEngine on

RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d

RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

例如，我使用这个域：`www.example.com`& `popstan.net`，这些域的 URL 重写**就像在梦中一样！**

然而，我现在正在创建一个博客，并且使用我的 Yii 控制器，我有这样的结构来访问博客文章、博客类别和单个博客文章：

*   [http://example.com/blog/](http://example.com/blog/) - 列出所有新文章
*   [http://example.com/blog/category/some-category](http://example.com/blog/category/some-category) - 列出特定类别的文章
*   [http://example.com/blog/article/some-alias-path](http://example.com/blog/article/some-alias-path) - 预览单个博客文章

现在，我希望在 domain: 下使用这个博客，`[http://blog.example.com/](http://blog.example.com/)`并维护这些 URL 结构，并且我不希望将我的网站复制到两个单独的目录（即博客目录）上。

是否可以使用`mod_rewrite`重写域的 URL，但要从父目录中获取 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T06:50:24.737

你应该简单地：

1）创建一个指向同一目录的`blog.example.com` [虚拟主机，](http://httpd.apache.org/docs/2.2/en/vhosts/examples.html)

2) 在 Yii config 中定义相应的 url 规则，例如：

```
'http://blog.example.com/<action:\w+>/<param:\w+>'=>'/blog/<action>',
'http://blog.example.com/'=>'/blog/index', 
```

你不需要修改你的`.htaccess`.

# sql-server-2008 - 在 SQL Server 中的 case 语句中寻找解决方案

> ID：16071331
> 
> 赞同：0
> 
> 时间：2013-04-17T22:27:51.690
> 
> 标签：sql-server-2008, case

我正在尝试在 case 语句中编写以下语句。尝试为特定列更新不同 TableB 中的值。

在我做之后

```
Update a 
set DISMMR = 
```

然后尝试在 case 语句中检查以下条件

```
'H01' Is not NULL 
  and
('H02','H03','HR04','S07','S08','S09') Is NULL
 Then 'Unknown' 
```

这里这个值来自表名：`TableA`和列名`Code`。

这个特定的列被设计为`NOT NULL`

这里我说`Is NULL`的意思是我想说的是，这个特定的值`('H02','H03','HR04','S07','S08','S09')`不存在或不存在于`TableA`.

当我`H01`在`TableA`for column中说这个特定值时`Code`---- `Is not NULL`-- 表示该列的这个特定值`Code`存在/存在于来自 的列中`TableA`。

我需要在 case 语句中执行此操作，因为一旦我检查完这个条件，我正在编写以**WHEN**开头的其他 case 语句来检查另一个条件并使用不同的值进行更新

我正在使用 SQL Server 2008 R2。现在我写了下面的查询。它在 SSMS 中运行良好，但是当我在 SSIS 包中使用此存储过程时。我的包裹因错误而失败。

[执行 SQL 任务] 错误：执行查询“执行 [dbo].[usp_GetMRF_CHP] ?,?,?” 失败并出现以下错误：“当子查询没有与 EXISTS 一起引入时，选择列表中只能指定一个表达式。”。可能的失败原因：查询有问题，“ResultSet”属性设置不正确，参数设置不正确

```
CASE WHEN EXISTS(SELECT 1 FROM dbo.TableA WHERE Code = 'H01')
  AND NOT EXISTS(SELECT 1 FROM dbo.TableA 
                 WHERE Code IN ('H02','H03','HR04','S07','S08','S09')
                )
 THEN 'Unknown'
when ---- I have another case here. 
```

任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T01:57:13.450

如果我理解你是正确的，你想知道是否存在 Code = 'H01' 的记录，而没有其他代码的记录。案例声明如下所示：

```
CASE WHEN EXISTS(SELECT 1 FROM dbo.TableA WHERE Code = 'H01')
      AND NOT EXISTS(SELECT 1 FROM dbo.TableA 
                     WHERE Code IN ('H02','H03','HR04','S07','S08','S09')
                    )
     THEN 'Unknown'
END 
```

# php - php mysql查询在页面加载时循环太多次？？

> ID：16071335
> 
> 赞同：1
> 
> 时间：2013-04-17T22:28:14.767
> 
> 标签：php, mysql, loops

我正在运行查询以在下面的 mysql 中获取“经理”的“名字”和“姓氏” - 当我测试它时，该查询在 mysql 中运行良好（它返回一个结果）但是当页面在我的浏览器上加载时出现超过 10,000 次！我不确定我做错了什么 - 任何帮助将不胜感激，谢谢。

```
 <div id="">
        <?
            $query3 = "SELECT * FROM  `lf`.`weekly_report` INNER JOIN `lf`.`user_account` ON `lf`.`weekly_report`.`manager` = `lf`.`user_account`.`user_id` WHERE (DATE >= CURDATE( ) - INTERVAL DAYOFWEEK( CURDATE( ) ) +6 DAY) AND (DATE < CURDATE( ) - INTERVAL DAYOFWEEK( CURDATE( ) ) -1 DAY) AND  `p_code` = '" . $pCode . "'";
            echo "<table border=1 cellpadding=5 width=30% style='border-collapse:collapse; height:auto; font-size:small; float:left;'>";
            echo "<tr>";
            echo "<th style='background-color:#FFFFCC;'>Project Manager</th>";
            while ($row2 = mysql_fetch_assoc(mysql_query($query3))) {
                echo "<td style='background-color:#FFFFFF;text-align:left;'>" . $row2['forename'] . " " . $row2['surname'] . "</td>";
            }

            echo "</tr>";
            echo "</table>";
        ?>
        </div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:30:37.353

尝试将查询移出循环。

```
$result3 = mysql_query($query3);
while ($row2 = mysql_fetch_assoc($result3)) { 
```

您还需要查看[PDO](http://php.net/manual/en/book.pdo.php)，因为不推荐使用 mysql_* 函数。

# html - ASP.NET MVC 3 - 我如何允许在 html textarea 中输入

> ID：16071337
> 
> 赞同：0
> 
> 时间：2013-04-17T22:28:21.100
> 
> 标签：html, asp.net-mvc, asp.net-mvc-3, validation, editor

我想使用粒度数据验证。`[AllowHtml]`属性不适用于`FormCollection`. 除了使用之外还有其他选择`ValidateInput(false)`吗？

在元数据中：

```
[AllowHtml]
[DataType(DataType.MultilineText)]
[Display(Name = "Content")]
public string Content { get; set; }

in edit action:

[HttpPost]
public virtual ActionResult Edit(int id, FormCollection formCollection)
{
    var obj = service.Get(id);

    if (ModelState.IsValid)
    {
        UpdateModel(obj, formCollection);
        service.Update(obj);

        return OnEdited(obj);
    }

    return View(obj);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T05:42:38.287

您不能将 AllowHtml 与 FormCollection 一起使用。您可以使用该`[ValidateInput]`属性，但显然这禁用了所有值的验证：

```
[HttpPost]
[ValidateInput(false)]
public ActionResult Edit(FormCollection collection, int id)
{
    var myEntity = _myRepo.Get(id);
    TryUpdateModel(objective);
    return DoSave(objective);
} 
```

话虽这么说，我将使用以下内容：

```
[HttpPost]
public ActionResult Edit(MyEntity entity)
{
    if (ModelState.IsValid)
    {
        _myRepo.Save(entity);
        return RedirectToAction("Success");
    }
    return View(entity);
} 
```

绑定 FormCollection 时它不起作用的一个简化原因是，没有任何东西可以将您在某个类的某些属性上定义的 AllowHtml 与当前执行的请求相关联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T22:38:52.953

```
[HttpPost]
public virtual ActionResult Edit(T obj)
{
    if (ModelState.IsValid)
    {
        if (TryUpdateModel(obj))
        {
            T old = service.Get(obj.ID);
            UpdateModel(old);
            service.Update(old); // EntityModelObject.SaveChanges();

            return OnEdited(obj);
        }
    }

    return View(obj);
} 
```

# php - 如何检查zip存档中是否存在文件

> ID：16071339
> 
> 赞同：6
> 
> 时间：2013-04-17T22:28:29.563
> 
> 标签：php, zip

我有 zip 存档，解压缩后我需要检查 moduleConfig.xml 是否存在于 zip 存档中。我怎么能做到这一点。

我试试这个

```
$zip = new ZipArchive();
if($zip->open('test.zip') === TRUE )
{
    if(file_exists($zip->getFromName('moduleConfig.xml')))
    {
        echo "Config exists";
        // Do somthing
    }
}
else {
    echo 'Failed code:'. $res;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-17T22:41:55.660

它应该是这样的：

```
$zip = new ZipArchive();
if($zip->open('test.zip') === TRUE )
{
    if ($zip->locateName('moduleConfig.xml') !== false)
    {
    echo "Config exists";
    }
}
else {
    echo 'Failed code:'. $res;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T22:34:32.503

尝试：

```
if ($zip->locateName('moduleConfig.xml') !== false)
{
    echo "Config exists";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-31T05:38:25.387

您可以使用`getFromName`

```
 $zip = new ZipArchive();

        if($zip->open('test.zip') === TRUE )
        {
            if($zip->getFromName('moduleConfig.xml') != false)
            {
                echo "Config exists";
                // Do somthing
            }
        }
        else {
            echo 'Failed code:'. $res;
        } 
```

# mongodb - 在 shell 中重新分配 MongoDB _id

> ID：16071342
> 
> 赞同：2
> 
> 时间：2013-04-17T22:28:34.627
> 
> 标签：mongodb, mongodb-shell

我正在尝试使用 MongoDB 重新分配 ID。但是，它没有将 ID 设置为等于我分配的值，而是创建了一个新的 ObjectId。如何分配自己的 ID？

```
> db.pGitHub.find();
{ "_id" : ObjectId("516f202da1faf201daa15635"), 
     "url" : { "raw" : "https://github.com/Quatlus", 
     "domain" : "github.com", "canonical" : "https://github.com/quatlus" } }
{ "_id" : ObjectId("516f202da1faf201daa15636"), 
      "url" : { "raw" : "https://github.com/Quasii", 
      "domain" : "github.com", "canonical" : "https://github.com/quasii" } }

> db.pGitHub.find().forEach(function(myProfile) {   
       var oldId = myProfile._id;   
       myProfile._id = 'exampleid';   
       db.pGitHub.save(myProfile);   
       db.pGitHub.remove({_id: oldId}); 
  });

> db.pGitHub.find();
{ "_id" : ObjectId("516f204da1faf201daa15637"), 
      "url" : { "raw" : "https://github.com/Quatlus", 
      "domain" : "github.com", "canonical" : "https://github.com/quatlus" } }
{ "_id" : ObjectId("516f204da1faf201daa15638"),  
      "url" : { "raw" : "https://github.com/Quasii", 
      "domain" : "github.com", "canonical" : "https://github.com/quasii" } } 
```

我正在使用 Mongo 2.4.2

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T23:59:21.343

本，你的说法是正确的。它只是 mongo shell 2.4.2 的行为与其他的有所不同（服务器不受影响）。您可以出于您的目的使用 2.4.1 中的 mongo shell 二进制文件。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-17T23:24:13.653

您只能在创建对象 ID*之前*设置它们。事后，他们无法改变。当您像这样更改 ID 时，您可能正在做的是创建新对象。

[MongoDB 文档](http://docs.mongodb.org/manual/reference/object-id/)中有更多信息

# php - 在电子邮件模板中使用 TextBox 获取用户输入

> ID：16071343
> 
> 赞同：0
> 
> 时间：2013-04-17T22:28:46.710
> 
> 标签：php, html, html-email, newsletter, mailchimp

我正在编写 Mailchimp 模板，我要做的是在电子邮件模板中添加一个文本框，接收电子邮件的人将在文本框中输入一些值，然后按电子邮件中的发送按钮，输入的值将发送到我的电子邮件地址电子邮件，我非常了解如何编写 mailchimp 模板，但真的不知道添加文本框并获取其值并发送到我的电子邮件帐户请指导我如何去做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:46:52.457

You will need to create a HTML form with a POST or GET action that sends the data to a server, then from there you can email the value to yourself. You cannot rely on the viewer's computer to send the email.

# python - Django 休息框架

> ID：16071344
> 
> 赞同：2
> 
> 时间：2013-04-17T22:28:48.990
> 
> 标签：python, django, restful-architecture, django-rest-framework

我有一种方法可以获取格式为 json 格式的 POST 数据，如下所示

```
[{"UserName": "alexgv", "Password": "secretpassword"}] 
```

这是方法

```
def Login(request, *args):
    data = request.DATA
    return Response(data)
"""
try:
    m = User.objects.get(UserName=request.DATA['UserName'])
    if m.password == request.DATA['Password']:
        request.session['member_id'] = m.id
        return HttpResponse("Testing")
except User.DoesNotExist:
    return HttpResponse("Your username and password didn't match.")
""" 
```

我希望能够从该 json POST 中仅获取一个变量。例如，也许我只想获取用户名或密码。我该怎么做？我尝试了很多方法，但似乎无法让它工作，我不想使用 request.POST.get 因为那意味着我必须发送 POST 变量。顺便说一句，我正在使用这个[http://django-rest-framework.org/](http://django-rest-framework.org/)。我已通读文档，但似乎无法在其中找到任何内容。任何帮助表示赞赏。它现在返回的就是一切。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T09:11:39.693

像这样...

```
username = request.DATA['UserName'] 
```

顺便说一句，您可能不应该自己编写基于会话的 API 登录视图，因为这很容易出错。

对于提供 AJAX 风格功能的 API，您有两个不错的选择：

*   使用标准 Django 登录，由*用户*执行，而不是由 API 客户端执行。
*   使用基于凭据的身份验证方案，而不是基于会话，并使用 AJAX 执行登录。例如 Djoser 第三方包是一个很棒的库，包括基于令牌的登录和其他类似的视图...... [https://github.com/sunscrapers/djoser](https://github.com/sunscrapers/djoser)

**更新**还发现了[https://github.com/JamesRitchie/django-rest-framework-sav](https://github.com/JamesRitchie/django-rest-framework-sav)这可能值得一看基于 AJAX 会话的身份验证。

# c# - WebBrowser 控件不下载图像

> ID：16071348
> 
> 赞同：0
> 
> 时间：2013-04-17T22:29:20.180
> 
> 标签：c#, winforms, automation, browser, fiddler

我正在自动化下载我的银行对账单的过程。我这样做的方法是使用 win forms WebBrowser 控件。我导航到[https://www.bankofamerica.com/](https://www.bankofamerica.com/)然后我在 dom 中找到用户名和密码文本框，用 c# 将点击事件发送到提交按钮等填写它们。最终我得到了我想要下载的语句准备好我只是解析页面源。

该过程有效，但速度很慢。**总之，我想提高这个过程的性能**这些是我正在考虑的事情：

1.  使用[fiddler](http://en.wikipedia.org/wiki/Fiddler_%28software%29)查看请求和响应，希望我可以自动化相同的过程。（这种方法的问题是连接是加密的，我还必须设置 cookie，我相信这样做会很复杂）。

2.  防止 WebBrowser Control 下载图像和 css。这样 page.Ready 事件将更早触发，并且该过程可以更快。

我会选择 2 号选项，因为我对 fiddler 知之甚少，只知道 http 的基础知识。我怎样才能加快这个过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:02:46.160

使用 Fiddler 捕获加密流量是微不足道的；只需启用解密 HTTPS 连接选项。

使用“Ambient DLControl”标志禁用从 Web 浏览器控件下载图像也很容易。有关示例，请参见[http://www.tech-archive.net/Archive/InetSDK/microsoft.public.inetsdk.programming.webbrowser_ctl/2009-01/msg00035.html 。](http://www.tech-archive.net/Archive/InetSDK/microsoft.public.inetsdk.programming.webbrowser_ctl/2009-01/msg00035.html)

# batch-file - 批量提取除第一个字符之外的所有字符？

> ID：16071350
> 
> 赞同：0
> 
> 时间：2013-04-17T22:29:38.960
> 
> 标签：batch-file

要仅提取第一个字符，我会使用：

```
%var:~0,1% 
```

要仅提取最后一个字符，我会使用：

```
%var:~0,-1% 
```

那么我将如何提取除第一个字符之外的所有字符？

我尝试查看“设置/？” 在 cmd 提示下，但这没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:52:00.417

要从特定字符提取到字符串的末尾，只需指定起始索引：

```
%var:~1% 
```

这被覆盖了，`set /?`但它被埋在一个段落中，绝对不容易找到：

* * *

也可以为扩展指定子字符串。

```
%PATH:~10,5% 
```

将扩展 PATH 环境变量，然后仅使用从扩展结果的第 11 个（偏移量 10）字符开始的 5 个字符。 **如果未指定长度，则默认为变量值的剩余部分。** 如果任一数字（偏移量或长度）为负数，则使用的数字是添加到指定偏移量或长度的环境变量值的长度。

* * *

# perl - 强制从自定义 Perl 安装中排除 /usr/lib64/perl5 库目录

> ID：16071351
> 
> 赞同：1
> 
> 时间：2013-04-17T22:29:51.377
> 
> 标签：perl, gcc, compilation, shared-libraries

我需要在 CentOS 机器上创建自定义系统范围的 perl 安装。我不想使用 perlbrew，因为我想自己更改配置变量，而且我遇到了同样的链接问题。

本质上，我无法弄清楚如何编译 perl，以便 /usr/lib64/perl5 不包含在链接器或 @INC 中。那是旧的centos版本，很烂。不管我如何编译，`perl -V`都会产生这样的结果：

```
@INC:
/usr/local/lib64/perl5
/usr/lib64/perl5/vendor_perl
/usr/local/perl5/lib/site_perl/5.16.3/x86_64-linux-thread-multi-ld
/usr/local/perl5/lib/site_perl/5.16.3
/usr/local/perl5/lib/5.16.3/x86_64-linux-thread-multi-ld
/usr/local/perl5/lib/5.16.3 
```

然后当我运行时，我得到了像这样的疯狂库错误：`undefined symbol: Perl_Gthr_key_ptr`来自 /usr/lib64/perl5 中的库。

注意 PERL5LIB 对此没有影响，它是编译进去的。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T07:19:47.990

要从中删除目录`@INC`，您可以使用`no lib`. 例如，

```
no lib "/usr/lib64/perl5/"; 
```

将从中删除`/usr/lib64/perl5/`目录`@INC`。

如需更多信息，请尝试`perldoc lib`。

# objective-c - 限制 UIDatePicker 中的可见日期

> ID：16071352
> 
> 赞同：0
> 
> 时间：2013-04-17T22:29:56.527
> 
> 标签：objective-c, xcode, nsdate, uipickerview

有没有办法限制 UIDatePicker 中的日期范围？我知道 maximumdate 和 minimumdate 属性，但我想将可见的最小年份限制为 2010 年。我不希望用户能够看到 2010 年之前的任何年份。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:20:55.637

我不相信使用 UIDatePicker 是不可能的，但您可以使用自己的 UIPickerView 实现这一点，确保实现 UIPickerViewDelegate 方法，`pickerView:didSelectRow:inComponent:`以处理糟糕的日期，例如 2 月 30 日（模仿 UIDatePicker 的行为） .

# java - 从另一个 Java 应用程序中查找并终止特定的 Java 进程

> ID：16071354
> 
> 赞同：2
> 
> 时间：2013-04-17T22:30:02.903
> 
> 标签：java, windows, taskmanager

我有几个在 Windows 机器上运行的 java 进程。我有一个 Java 进程，它应该监视其他进程并定期终止或重新启动新进程。

如果我有一个运行 com.foo.Main1 的 java 进程和一个运行 com.foo.Main2 的 java 进程 - 我的监控进程如何才能找到并杀死 Main2 进程？

更新：我有一些代码可以执行命令行 tasklist.exe 并解析它，但无论我做什么，我只看到 java.exe 进程，而不是执行哪个类

更新 2：我没有能力安装非 java 程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T04:52:39.577

使用特定于操作系统的工具并用于运行它们可能会简单得多`Runtime.exec()`，但我会尝试给出一个独立于平台的答案：

* * *

可以使用[Attach API](http://docs.oracle.com/javase/6/docs/technotes/guides/attach/)独立地执行此平台。这是 JDK 自带的，所以要使用它，只需`tools.jar`将 JDK 包含在程序的类路径中即可。

要获取系统上的虚拟机列表，请使用[VirtualMachine.list()](http://docs.oracle.com/javase/6/docs/jdk/api/attach/spec/com/sun/tools/attach/VirtualMachine.html#list%28%29)。您可以从由此返回的虚拟机描述符对象中获取/解析参数。

附加 API 还允许您将代理加载到已经运行的 Java 进程中。由于您想杀死一个 Java 进程，您可以编写一个 Java 代理，它在代理加载时只运行[System.exit()](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#exit%28int%29)（或者如果您*真的*希望它停止运行，请使用[Runtime.halt()代替）。](http://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html#halt%28int%29)

一旦您确定了要杀死的那个，[附加](http://docs.oracle.com/javase/6/docs/jdk/api/attach/spec/com/sun/tools/attach/VirtualMachine.html#attach%28com.sun.tools.attach.VirtualMachineDescriptor%29)到它并加载杀手代理（代理必须构建为 JAR 文件，可供需要加载的 Java 进程访问）。附加代理后不久，该进程应该终止。

这些链接也可能有帮助：

[关于附加 API 的 Oracle 博客](https://blogs.oracle.com/CoreJavaTechTips/entry/the_attach_api)

[java.lang.instrument 的包文档](http://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html)（有关于如何构建代理 JAR 的详细说明）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-08T10:16:36.670

这是特定于 Windows 的。我遇到了同样的问题，我必须使用 taskkill 杀死特定的 java 程序。当我运行 java 程序时，tasklist 显示图像名称设置为 java.exe 的相同程序。但是使用 taskkill /F java.exe 杀死它会停止所有其他 Java 应用程序，而不是不需要的预期应用程序。

所以我使用以下方法运行相同的 java 程序：

启动“MyProgramName”java java-program..

这里的启动命令将打开一个新窗口并运行窗口标题设置为 MyProgramName 的 java 程序。

现在要杀死这个 java 程序，请使用以下 taskkill 命令：

taskkill /fi "我的程序名"

您的 Java 程序只会被杀死。休息不受影响。

# firefox - 为什么 pdftk 生成的 pdf 文件不会在 Firefox 中呈现？

> ID：16071360
> 
> 赞同：2
> 
> 时间：2013-04-17T22:30:24.480
> 
> 标签：firefox, pdf-generation, pdftk, pdf.js

我有一个网站 - www.jcrocetta.com。在这个网站上，我有 2 个 pdf 文件。一个文件数据模糊，另一个文件清晰，两个文件都是用 pdftk 创建的。

为了模糊 pdf 中的一些个人数据，我使用了 Inkscape。但 Inkscape 一次只能打开/编辑一个 PDF 页面。在 Inkscape 中进行编辑后，我将文件保存为 .pdf 格式的文件。那时我有三个单独的 pdf 文件，第 1 页到第 3 页。然后我使用 pdftk 将 3 个文件连接成一个。

由 pdftk 生成的最终文件位于 www.jcrocetta.com。只需单击公共信息按钮。

在 Chrome 中查看内联工作正常。从 Firefox 下载文件也可以正常工作。但是在 Firefox 上查看内联会呈现空白页面。我怎样才能解决这个问题？

另外，我知道**不是用 pdftk 生成的**pdf 文件将在 Chrome 和 Firefox 上正确呈现。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:02:26.163

FireFox 有一个可爱的新功能：它现在使用 PDF.js 库来呈现 PDF 文件，而不是调用 Adob​​e Reader 插件，或者强迫您将文件保存到磁盘。不幸的是，PDF.js 似乎还不是很完美。[快速搜索显示其他人也有同样的问题，但我看到的唯一“解决方案”归结为“在https://github.com/mozilla/pdf.js/issues](https://github.com/mozilla/pdf.js/issues)或[https](https://bugzilla.mozilla.org/enter_bug.cgi?product=Firefox&component=PDF+Viewer)提交错误报告： [//bugzilla.mozilla.org/enter_bug.cgi?product=Firefox&component=PDF+Viewer](https://bugzilla.mozilla.org/enter_bug.cgi?product=Firefox&component=PDF+Viewer) ".

另外：在使用 pdftk 连接它们之前，三个单独的 PDF 文件是否在 FireFox 中呈现？

# python - 制作自定义概率分布以从 SciPy 中抽取随机样本

> ID：16071365
> 
> 赞同：8
> 
> 时间：2013-04-17T22:30:34.920
> 
> 标签：python, statistics, scipy, montecarlo

我正在寻找使用蒙特卡罗类型模拟来总结任意数量的事物概率分布。我想随机抽取某些东西的连续分布并将它们添加到其他连续分布的其他随机样本中，最终得到它们组合的概率分布。分布本身是经验性的 - 它们不是函数，而是 P99 = 2.4、P90 = 7.12、P50 = 24.53、P10 = 82.14 等形式（实际上有很多这些点）。这些分布或多或少是对数正态分布，因此如果有必要，将它们近似为对数正态分布可能会很好。但是我怎么能把它输入到 SciPy 的[lognorm 函数](http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.lognorm.html#scipy.stats.lognorm)中呢？或者在 SciPy 或一般的 python 中以其他方式做它？

我希望很清楚我想要做什么。非常感谢，亚历克斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T08:28:59.513

看起来你所拥有的本质上是概率密度的直方图。然后您可以做的一件事是将[逆变换采样](http://en.wikipedia.org/wiki/Inverse_transform_sampling)与您的经验分布一起使用。

作为替代方案，如果您期望某个分布的函数形式（对数范数或其他某种形式），您可以尝试使用相应的函数形式拟合数据。

# sql - 如何在我的结果中列出另一个表格中的部门名称？

> ID：16071370
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:30:41.103
> 
> 标签：sql, sql-server, sql-server-2008, subquery

以下是我的 EMPLOYEES 表：

```
create table EMPLOYEES
    (EmpID    char(4)         unique Not null,
     Ename    varchar(10),
     Job      varchar(9),
     MGR      char(4),
     Hiredate date,
     Salary   decimal(7,2),
     Comm     decimal(7,2),
     DeptNo   char(2)         not null,
         Primary key(EmpID),
         Foreign key(DeptNo) REFERENCES DEPARTMENTS(DeptNo));

insert into EMPLOYEES values (7839,'King','President',null,'17-Nov-11',5000,null,10);
insert into EMPLOYEES values (7698,'Blake','Manager',7839,'01-May-11',2850,null,30);
insert into EMPLOYEES values (7782,'Clark','Manager',7839,'02-Jun-11',2450,null,10);
insert into EMPLOYEES values (7566,'Jones','Manager',7839,'02-Apr-11',2975,null,20);
insert into EMPLOYEES values (7654,'Martin','Salesman',7698,'28-Feb-12',1250,1400,30);
insert into EMPLOYEES values (7499,'Allen','Salesman',7698,'20-Feb-11',1600,300,30);
insert into EMPLOYEES values (7844,'Turner','Salesman',7698,'08-Sep-11',1500,0,30);
insert into EMPLOYEES values (7900,'James','Clerk',7698,'22-Feb-12',950,null,30);
insert into EMPLOYEES values (7521,'Ward','Salesman',7698,'22-Feb-12',1250,500,30);
insert into EMPLOYEES values (7902,'Ford','Analyst',7566,'03-Dec-11',3000,null,20);
insert into EMPLOYEES values (7369,'Smith','Clerk',7902,'17-Dec-10',800,null,20);
insert into EMPLOYEES values (7788,'Scott','Analyst',7566,'09-Dec-12',3000,null,20);
insert into EMPLOYEES values (7876,'Adams','Clerk',7788,'12-Jan-10',1100,null,20);
insert into EMPLOYEES values (7934,'Miller','Clerk',7782,'23-Jan-12',1300,null,10); 
```

以下是我的 DEPARTMENTS 表：

```
create table DEPARTMENTS
(DeptNo   char(2)  unique Not null,
DName    varchar(14),
Location varchar(13),
Primary key(DeptNo));

insert into DEPARTMENTS values (10,'Accounting','New York');
insert into DEPARTMENTS values (20,'Research','Dallas');
insert into DEPARTMENTS Values (30,'Sales','Chicago');
insert into DEPARTMENTS values (40,'Operations','Boston'); 
```

以下是我的查询：

```
select ename, salary
from EMPLOYEES
where Salary >
(select AVG(salary)
from EMPLOYEES); 
```

Sql 小提琴演示：[http ://www.sqlfiddle.com/#!3/61ca4/1](http://www.sqlfiddle.com/#!3/61ca4/1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:32:04.480

```
select e.ename,
       e.salary,
       d.DName
  from EMPLOYEES as e
      inner join DEPARTMENTS as d on e.DeptNo = d.DeptNo
where e.Salary > (select AVG(salary) from EMPLOYEES); 
```

Sql 小提琴演示：[http ://www.sqlfiddle.com/#!3/61ca4/2](http://www.sqlfiddle.com/#!3/61ca4/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T08:12:48.953

```
select E.ename, E.salary, D.DName

from Employees E, Departments D

where E.Deptno = D.Deptno

And Salary > (select AVG(salary) from EMPLOYEES); 
```

# c# - C# WPF 从 exe 文件夹加载图像

> ID：16071371
> 
> 赞同：3
> 
> 时间：2013-04-17T22:30:59.540
> 
> 标签：c#, wpf, image, bitmap, load

我想将我的程序从一台电脑移动到另一台电脑，但问题是图像没有加载到任何其他电脑上（源问题）。所以我想知道我是否可以创建一个放置 exe 的文件夹并将其命名为 Resources 并从那里加载每个图像。

```
image2.Source = new BitmapImage(new Uri(@"Res\startoh.png")); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T06:22:17.767

您可以将图像作为资源添加到您的 Visual Studio 项目中。然后它们将被打包到可执行文件的程序集中，您不需要单独复制它们。

在您的项目中创建一个文件夹（假设称为**Images**）并将您的图像添加到该文件夹​​中。

![在此处输入图像描述](https://i.stack.imgur.com/m37q6.png)

确保图像的[构建操作](https://stackoverflow.com/a/145769/1136211)设置为`Resource`。

![在此处输入图像描述](https://i.stack.imgur.com/furlX.png)

现在，您可以通过适当的[Pack URI](http://msdn.microsoft.com/en-us/library/aa970069.aspx)从此类资源中简单地创建 BitmapImage ：

```
var uri = new Uri("pack://application:,,,/Images/SomeImage.png");
image.Source = new BitmapImage(uri); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:47:57.653

你可以这样做：

```
Source="pack://siteoforigin:,,,/Images/someimage.png" 
```

并使用您的 bin/app 文件夹中的图像。请查看此链接以获取更多信息...

[WPF应用程序中的自定义图形？](https://stackoverflow.com/questions/15636502/custom-graphic-in-wpf-application)

[什么是应用程序的原始站点以及何时使用它](https://stackoverflow.com/questions/6043138/what-is-applications-site-of-origin-and-when-to-use-it)

# mysql - SQL 按日期检查选择可用房间

> ID：16071372
> 
> 赞同：0
> 
> 时间：2013-04-17T22:31:04.153
> 
> 标签：mysql, sql, sqlite

我的数据库中有一个名为 rooms 的表，其中包含房间信息和属性，还有另一个名为 reservation 表的表，其中包含 Room Reserved、FromDate 和 ToDate。

我想要做的是让用户选择他想要预订的房间大小并选择预订房间的日期，然后我根据房间预订表为他提供可用的房间。

我在这里做了什么：

```
SELECT  * FROM Rooms,Reservations WHERE 
Rooms.R_Size = 'roomSize' AND ('4/19/2013' NOT 
BETWEEN Reservation.FromDate AND Reservation.ToDate  AND '4/19/2013'
NOT BETWEEN Reservation.FromDate AND Reservation.ToDate) 
```

问题是它返回给我重复的房间，即使它在特定预订的预订日期之间但不是在另一个预订的预订日期之间，它仍然会将它退还给我。

我想要的是检查房间是在同一日期还是在特定日期之间预订，如果是，我根本不希望它被选中并归还。

谢谢..对不起我糟糕的英语

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:48:36.230

What you are doing here is a cross join. Every row from table a (Rooms) is joined with every row in table b (Reservations).

In order to make your query work, you need to specify that Rooms.Rooms_Key = Reservations.Rooms_ForignKey in your where clause (or an explicit join [inner,left,right] and specify the ON fields as they are easier to read in my opinion - [explicit-vs-implicit](http://social.msdn.microsoft.com/Forums/en-US/databasedesign/thread/df27b6ba-3bd3-4a60-b2ab-b72a5f3e28b8/) for more info).

Once you have converted the join type, the where clause will start to give you better results, and you should be able to modify it if you still need to at that point.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:49:32.937

您的查询有两个问题。一是房间和预订之间的连接没有条件，这样对于满足日期测试的每个预订，将返回一次正确大小的房间。另一个问题是您的日期测试是错误的，因为它不会检测到完全在新预订日期间隔内的现有预订。

像这样的查询应该会给你你想要的结果：

```
SELECT * FROM Rooms
LEFT JOIN Reservations 
ON Reservations.R_Number = Rooms.Number
AND Reservations.ToDate > '4/19/2013'
AND Reservations.FromDate < '4/20/2013'
WHERE Rooms.R_Size = 'roomSize' 
AND Reservations.R_Number IS NULL 
```

它的工作原理是将房间加入到该房间的预订中，然后选择没有与新预订冲突的预订的房间。（旧预订在新预订开始之前结束，或者在新预订之后开始一端没问题）。

# c - 为什么地址运算符 (&) 对于通过函数传递的数组很重要？

> ID：16071376
> 
> 赞同：0
> 
> 时间：2013-04-17T22:31:13.427
> 
> 标签：c, arrays, pointers, operators

我无法理解`&`操作员的工作方式及其重要性。

我在网上找到了这个例子：

```
 #include <stdio.h>

void main()
{
  int a = 10;
  printf("\nValue of n is : %d" ,n);
  printf("\nValue of &n is : %u", &n);
} 
```

输出 ：

```
Value of  n is : 10
Value of &n is : 1002 
```

首先，为什么`&n`打印出这两个额外的数字？

其次，为什么这很重要？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:14:12.817

运算符的地址`&`，返回以下变量的内存地址。这很重要，因为：

1.  它允许使用轻量级句柄引用大内存块（结构、数组、动态分配的非结构化内存区域）

2.  它提供了访问数据结构内部表示的方法

3.  它允许我们通过同一个接口处理不同类型的数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:51:39.697

要在 C 中打印出地址，通常应该`%p`使用`%u`.

注意`%p`以十六进制数字打印出地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:35:10.277

运算符是运算符的`&`“地址”。so`&a`表示`address of a`，而不仅仅是 a 的值。

这告诉你的是 a 的地址是`1002`（或者正如 dreamlax 所指出的，由于 printf 的使用方式很奇怪，很可能不是真正的地址），即使值是`10`. 请注意，这两个值之间没有严格的相关性，您可以很容易地拥有`a=121765`和`&a=494260`。

知道变量的地址允许您操纵变量“引用”或“指向”的特定值/对象。如果您希望函数操作该特定值/对象而不是操作副本，则应传递变量的地址。

取以下代码（不一定是完整代码）：

```
int main(void)
{
    int a = 10;
    doIt(a);
    printf("after doIt: %d", a);
    doItByReference(&a);
    printf("after doItByReference: %d", a);
}

void doIt(int val)
{
    val = 13;
}

void doItByReference(int *val)
{
    *val = 15;
} 
```

调用`doIt`传递由 保存的值`a`，并且不同地址的新整数变量将该值复制到其中。该函数可以自由地对此复制副本进行任何更改，并且不会在原始`a`变量中看到任何修改。

但是，调用`doItByReference`会传递 的地址`a`。对给定地址的值所做的任何更改都将反映为对 的更改`a`。

如果您想对给定对象进行更改并将这些更改反映在原始副本中，这本身就很有用。但是，即使您不想修改原始副本中的值，这在性能方面也很有用，因为您避免了复制任何值。对于一个可能是 4 个字节（确切值不重要）的简单 int，这无关紧要。

但是，假设您有一个数千或数百万字节的结构：

```
struct LargeStruct
{
    int buffer[134217728];
};

void doIt(LargeStruct buffer)
{
    // ... do something
}

void doItByReference(LargeStruct *buffer)
{
    // ... do something
} 
```

这一次，每次调用`doIt`都必须复制`LargeStruct`数百万字节的整个对象，而对 doItByReference 的调用只使用现有对象，不需要复制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T22:36:30.090

n 是一个变量。它代表一个值。
&n 是对 n 的引用。它表示存储 n 的内存地址。

至于为什么重要：

当您在 C 中传递一个数组时，该函数通常需要一个指针。（即：int* 而不是 int）。
如果你将'n'传递给函数，它会在编译时报错，因为类型不匹配（n=int，函数需要int*）。
如果您传入 &n，那么您将传入一个地址到“n”，这是函数所期望的。

# vb.net - 标签中文本的随机数

> ID：16071380
> 
> 赞同：-2
> 
> 时间：2013-04-17T22:31:22.650
> 
> 标签：vb.net

```
Public Class MainForm

Private Sub exitButton_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles exitButton.Click
    Me.Close()
End Sub

Private Sub guestsTextBox_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles guestsTextBox.KeyPress
    ' allows only numbers and the Backspace key

    If (e.KeyChar < "0" OrElse e.KeyChar > "9") AndAlso
        e.KeyChar <> ControlChars.Back Then
        e.Handled = True
    End If
End Sub

Private Sub MainForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    'fills the list box and selects the first item

    typeListBox.Items.Add("Kid's Birthday")
    typeListBox.Items.Add("21st Birthday")
    typeListBox.Items.Add("40th Birthday")
    typeListBox.Items.Add("Other Birthday")
    typeListBox.SelectedIndex = 0
End Sub

Private Sub calcButton_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles calcButton.Click
    'displays the total charge

    Dim guests As Integer
    Dim typeIndex As Integer
    Dim guestPrice As Integer
    Dim totalCharge As Integer

    Integer.TryParse(guestsTextBox.Text, guests)
    typeIndex = typeListBox.SelectedIndex

    'determine the price per guest
    Select Case typeIndex
        Case 0 'Kid's Birthday
            guestPrice = 11
        Case 1 '21st Birthday
            guestPrice = 20
        Case 2 '40th Birthday
            guestPrice = 25
        Case Else 'other birthdays
            guestPrice = 15
    End Select

    'calculate and display the total charge
    totalCharge = guests * guestPrice
    totalLabel.Text = totalCharge.ToString("C0")
End Sub

Private Sub testDataButton_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles testDataButton.Click
    Dim guests As Integer
    Dim typeIndex As Integer
    Dim guestPrice As Integer
    Dim totalCharge As Integer
    Dim randomGen As New Random
    Dim setCounter As Integer = 1

    testDataLabel.Text = String.Empty

    Do
        guests = randomGen.Next(1, 51)
        typeIndex = randomGen.Next(0, 4)

        For Each I As Object In typeListBox.SelectedItems
            testDataLabel.Text += I.ToString() & ControlChars.NewLine
        Next

        'determine the price per guest
        Select Case typeListBox.SelectedIndex
            Case 0
                guestPrice = 11
            Case 1
                guestPrice = 20
            Case 2
                guestPrice = 25
            Case Else
                guestPrice = 15
        End Select

        'calculate and display the total charge
        totalCharge = guests * guestPrice
        testDataLabel.Text = testDataLabel.Text &
            typeIndex.ToString & "    " &
            guests.ToString & "    " &
            totalCharge.ToString("C0") &
            ControlChars.NewLine
        setCounter += 1

    Loop Until setCounter > 10

End Sub

Private Sub typeListBox_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles typeListBox.SelectedIndexChanged

End Sub
End Class 
```

当我单击一个名为“生成测试数据”的按钮时，它会在标签中生成一个随机数列表。我希望这些数字说明生日的类型而不是数字。

0 是“孩子的生日”

1 是“21 岁生日”

2是“40岁生日”

和 3 是“其他生日”

我该怎么做呢？

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T14:53:10.207

如果我正确理解了您的问题，您可以声明一个枚举并将该枚举的字典转换为 String。

Enum 负责处理代码中的数字，而是使用人类可读的结构。字典将确保您的用户也将看到人类可读的结构。

请看下面的代码（需要一个全新的 WinForms 项目和一个`ListBox1`在主窗体上调用的 ListBox）：

```
Option Strict On

Public Class Form1
  'Declare this enum to avoid dealing with naked numbers in code
  Enum BirthdayTypes
    btKids = 0
    bt21st = 1
    bt40th = 2
    btOther = 3
  End Enum

  Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) _
                                                     Handles MyBase.Load
    'Suppose your input value is a number,
    'but you don't want to deal with numbers
    Dim typeIndex As Integer = 2

    'You can convert your number to BirthdayTypes,
    'making your input "correct"
    Dim typeIndexBt As BirthdayTypes = ConvertBirthdayIndexToType(typeIndex)

    'Calculation of guest price is now "human readable"
    Dim guestPrice As Integer = CalculateGuestPrice(typeIndexBt)

    'You can create a dictionary for diplaying the values
    Dim displayDictionary As New Dictionary(Of BirthdayTypes, String)
    With displayDictionary
      .Add(BirthdayTypes.btKids, "Kid's Birthday")
      .Add(BirthdayTypes.bt21st, "21st Birthday")
      .Add(BirthdayTypes.bt40th, "40th Birthday")
      .Add(BirthdayTypes.btOther, "Other Birthday")
    End With

    'Here is how you would those values into a ListBox
    With ListBox1
      .DataSource = displayDictionary.ToList
      .ValueMember = "Key"
      .DisplayMember = "Value"
    End With

    'Now your ListBox displays strings, 
    'but SelectedValue would return an object of type BirthdayTypes

    'You can extract random values from the above dictionary by index,
    'and create a new list from it

    Debug.WriteLine(ListBox1.SelectedValue) 'outputs btKids
  End Sub

  Private Function CalculateGuestPrice(bt As BirthdayTypes) As Integer
    Select Case bt
      Case BirthdayTypes.btKids : Return 11
      Case BirthdayTypes.bt21st : Return 20
      Case BirthdayTypes.bt40th : Return 25
      Case BirthdayTypes.btOther : Return 15
    End Select
    'should never here
    Throw New Exception("Unknown birthday type")
  End Function

  Private Function ConvertBirthdayIndexToType(index As Integer) As BirthdayTypes
    If index < 3 Then Return CType(index, BirthdayTypes)
    Return BirthdayTypes.btOther
  End Function
End Class 
```

**免责声明：**此代码只是可以做的演示，并不意味着用作完整的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:54:24.693

我会使用一个字符串。

```
Dim thestring() As String = {"Kid's Birthday", _ 
                             "21st Birthday",  _
                             "40th Birthday",  _
                             "Other Birthday"} 
```

现在这些数字中的每一个都将代表字符串中的文本。

```
thestring(0) = kids birthday
thestring(1) = 21 birthday
thestring(2) = 40th birthday
thestring(3) = other birthday 
```

说得通？我会进一步提供帮助，但我不太明白你想要做什么。

# .htaccess - 将选择页面重定向到 https

> ID：16071381
> 
> 赞同：1
> 
> 时间：2013-04-17T22:31:33.863
> 
> 标签：.htaccess, mod-rewrite, ssl

我有一个非常简单的问题，由于某种原因我无法弄清楚，而且数小时的搜索也没有帮助。使用 .htaccess 文件，如何仅重定向`/login.php`到`/index.php`https，然后将任何其他页面重定向到 http？我目前使用此代码重定向到 https，但它重定向每个页面：

```
RewriteCond %{SERVER_PORT} !443
RewriteRule ^(.*) https://www.ruxim.com/$1 [R] 
```

非常感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:48:21.900

The `%{SERVER_PORT}` variable depends on the [UseCanonicalPhysicalPort](http://httpd.apache.org/docs/2.2/mod/core.html#usecanonicalphysicalport) in your config. If it's not setup, then you may not be able to match against that variable, easier to use `%{HTTPS}` instead.

```
RewriteCond %{HTTPS} off
RewriteRule ^/?(login|index)\.php https://www.ruxim.com%{REQUEST_URI} [L,R]

RewriteCond %{HTTPS} on
RewriteRule !^/?(login|index)\.php http://www.ruxim.com%{REQUEST_URI} [L,R] 
```

If you don't need the redirect to non-https, then you don't need the second rule.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T09:03:44.310

请应用以下条件以仅保护 /login.php 和 /index.php 页面。其他页面将在 HTTP 路径上工作（非安全页面）。

```
RewriteEngine On
RewriteBase /
# force https for /login.php and /index.php
RewriteCond %{HTTPS} =off
RewriteRule ^(index|login)\.php$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# don't do anything for images/css/js (leave protocol as is)
RewriteRule \.(gif|jpe?g|png|css|js)$ - [NC,L]

# force http for all other URLs
RewriteCond %{HTTPS} =on
RewriteCond %{REQUEST_URI} !^/(index|login)\.php$
RewriteRule .* http://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:41:29.147

尝试这样的事情；

```
RewriteCond %{SERVER_PORT} !^443$
RewriteCond %{REQUEST_FILENAME} =index.php [OR]
RewriteCond %{REQUEST_FILENAME} =login.php
RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

我注意到 100% 肯定`[OR]`会在中间突然遵守。

# facebook - Facebook 分数因权限被删除而无法删除？

> ID：16071382
> 
> 赞同：1
> 
> 时间：2013-04-17T22:31:34.873
> 
> 标签：facebook, facebook-graph-api, permissions

考虑到 Facebook 分数，又是一个小问题。作为应用程序管理员，我可以使用应用程序访问令牌为某些用户设置和删除分数，让我们说以防作弊。我尝试了一下并注意到，一旦用户删除了“publish_actions”权限，他似乎能够阻止我，即应用管理员的任何访问。当我尝试使用 app-accesstoken 发布/删除分数时，考虑到缺少权限，它只会返回错误。

我一定在这里做错了什么，对吧？！一个骗子不可能逃脱那么简单还是他？！？！作弊到排行榜的顶部，然后通过应用设置删除“publish_actions”权限？XD

# django - Django 创建自定义表单渲染器，如 .as_ul 或 .as_p

> ID：16071385
> 
> 赞同：0
> 
> 时间：2013-04-17T22:32:03.840
> 
> 标签：django, django-forms

我知道关于如何为 Django 做一个自定义表单渲染器有很多问题，而且我知道最好的方法之一是创建一个包含我们需要的所有东西的 form_snippet 模板。

但问题是我想在后端做，我需要创建一个自定义表单渲染器，我可以在模板中做类似 {{ form.as_bootstrap }} 的事情。

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:48:55.153

您可以在表单中创建 as_bootstrap 方法，但我强烈建议您自己创建[templatetag](https://docs.djangoproject.com/en/1.5/howto/custom-template-tags/)。另一方面，这个问题是广泛开放的，你有什么尝试？请扩展您的问题，否则，社区可以关闭它。

# c# - 从 MainView 与 ViewModel 通信

> ID：16071388
> 
> 赞同：0
> 
> 时间：2013-04-17T22:32:13.523
> 
> 标签：c#, listview, mvvm

我是 MVVM 的新手，但仍在尝试掌握它，所以如果我设置错误，请告诉我。我所拥有的是一个带有 ListView 的 UserControl。我使用来自 ViewModel 的数据填充此 ListView，然后将控件添加到我的 MainView。在我的 MainView 上，我有一个按钮，我想用它来向 ListView 添加一个项目。这是我所拥有的：

模型

```
public class Item
{
    public string Name { get; set; }

    public Item(string name)
    {
        Name = name;
    }
} 
```

视图模型

```
public class ViewModel : INotifyPropertyChanged
{

    #region INotifyPropertyChanged Members

    public event PropertyChangedEventHandler PropertyChanged;

    private void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    #endregion

    private ObservableCollection<Item> _itemCollection;

    public ViewModel()
    {
        ItemCollection = new ObservableCollection<Item>()
        {
            new Item("One"),
            new Item("Two"),
            new Item("Three"),
            new Item("Four"),
            new Item("Five"),
            new Item("Six"),
            new Item("Seven")
        };
    }

    public ObservableCollection<Item> ItemCollection
    {
        get
        {
            return _itemCollection;
        }
        set
        {
            _itemCollection = value;
            OnPropertyChanged("ItemCollection");
        }
    }
} 
```

查看 (XAML)

```
<UserControl.Resources>
    <DataTemplate x:Key="ItemTemplate">
        <StackPanel Orientation="Vertical">
            <Label Content="{Binding Name}" />
        </StackPanel>
    </DataTemplate>
</UserControl.Resources>

<UserControl.DataContext>
    <local:ViewModel />
</UserControl.DataContext>

<Grid>
    <ListView ItemTemplate="{StaticResource ItemTemplate}" ItemsSource="{Binding ItemCollection}">

    </ListView>
</Grid> 
```

主窗口

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        this.mainContentControl.Content = new ListControl();
    }

    private void Button_Add(object sender, RoutedEventArgs e)
    {

    }
} 
```

主窗口 (XAML)

```
<Grid>
    <DockPanel>
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <Button Width="100" Height="30" Content="Add" Click="Button_Add" />

        </StackPanel>
        <ContentControl x:Name="mainContentControl" />
    </DockPanel>
</Grid> 
```

现在，据我了解，我应该能够将一个项目添加到 ItemCollection 中，它将在视图中更新。如何从 Button_Add 事件执行此操作？

同样，如果我做错了，请告诉我并指出正确的方向。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:35:18.227

您不应直接与控件交互。

你需要做的是定义一个命令（一个实现 ICommand 接口的类）并在你的 ViewModel 上定义这个命令。

然后将 Button 的 command 属性绑定到 ViewModel 的此属性。在 ViewModel 中，您可以执行命令并将项目直接添加到列表中（因此列表视图将通过自动数据绑定得到更新）。

此链接应提供更多信息：

[http://msdn.microsoft.com/en-us/library/gg405484(v=pandp.40).aspx#sec11](http://msdn.microsoft.com/en-us/library/gg405484(v=pandp.40).aspx#sec11)

# php - JavaScript VS PHP：相同的计算返回不同的结果

> ID：16071390
> 
> 赞同：4
> 
> 时间：2013-04-17T22:32:21.523
> 
> 标签：php, javascript

我正在尝试在 JavaScript 中做一些简单的数学运算（？）：

```
( 1023 * 2 ) + 76561197960265728; 
```

我已经在 PHP 中进行了相同的计算，但结果不同：

JavaScript: **76561197960267780**

PHP：**76561197960267774**（正确结果）

然后我尝试了以下方法：http: [//jsfiddle.net/YxBa4/](http://jsfiddle.net/YxBa4/)

JavaScript 中是否对计算中的大量数字有“限制”？

**//编辑：**

感谢您的回答，我现在使用[BigNumber](http://jsfromhell.com/classes/bignumber)一。

我现在的完整工作代码：

[在 JSFiddle 上](http://jsfiddle.net/U96HJ/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:49:33.407

值`76561197960265730`id 大于 javascript 中允许的最大数字大小。请注意，Javascript 中没有真正的整数，只有`Number`始终为 64 位浮点值且与平台无关的类型。但是最大可能的*整*数值只是 2^53，因为至少为逗号和标志位之后的数字保留了 11 位。

在您的示例中，您只需执行以下操作即可看到这一点：

```
alert(76561197960265728); 
```

即使没有任何计算，什么会给您带来错误。（输出：'76561197960265730'）

在 php 中，最大整数值取决于您的系统。如果您使用的是 64 位系统，则 MAX 整数值为 2^64，大于 (2 * 1023) + 76561197960265728。这就是 PHP 在 64 位系统上计算成功的原因

在 PHP 中，您可以通过读取常量[`PHP_INT_MAX`](http://www.php.net/manual/en/language.types.integer.php)和 `来检测系统上的最大整数大小

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T22:58:48.997

在 Javascript 中，数字是 64 位浮点值。最大整数（大小）为 253，或 Math.pow(2,53)，或 9007199254740992。取自：[http ://notepad2.blogspot.ca/2012/04/maximum-integer-in-javascript.html](http://notepad2.blogspot.ca/2012/04/maximum-integer-in-javascript.html)

您超过了限制 1351079458714420。

整数的大小取决于平台，尽管通常值约为 20 亿的最大值（即 32 位有符号）。64 位平台的最大值通常约为 9E18。PHP 不支持无符号整数。自 PHP 4.4.0 和 PHP 5.0.5 起，可以使用常量 PHP_INT_SIZE 确定整数大小，使用常量 PHP_INT_MAX 确定最大值。取自[http://php.net/manual/en/language.types.integer.php](http://php.net/manual/en/language.types.integer.php)

所以基本上 PHP 允许您根据 PHP 配置为整数值提供更多容量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T23:11:21.087

您可以使用 PHP 的 bcmath 扩展和它的 JS 转换来在 2 种语言中获得一致的结果：

```
bcadd('76561197960267774', '76561197960267774');
// 153122395920535548 
```

[http://jsfiddle.net/zELmm/](http://jsfiddle.net/zELmm/)

[http://phpjs.org/functions/bcadd/](http://phpjs.org/functions/bcadd/)

[http://php.net/manual/en/function.bcadd.php](http://php.net/manual/en/function.bcadd.php)

# xml - 如何使用 xslt 1.0 逐行输出文本节点值？

> ID：16071392
> 
> 赞同：3
> 
> 时间：2013-04-17T22:32:26.923
> 
> 标签：xml, xpath, xslt-1.0

我有一个 xml 文件，如下所示：

```
<Messages>
   error message 1

   error message 2 
</Messages> 
```

我希望输出为：

```
Error 1: 
error message 1

Error 2:
error message 2 
```

我正在使用 xslt 1.0，我尝试过：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<xsl:output method="html" omit-xml-declaration="yes"/>

<xsl:template match="Messages">
    <h3>Error 1:</h3>
    <xsl:value-of select="substring-before(./text(), '&#10;')"/>
    <h3>Error 2:</h3>
    <xsl:value-of select="substring-after(./text(), '&#10;')"/>
</xsl:template>
</xsl:stylesheet> 
```

但它没有给我任何回报......有人可以帮我解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T04:24:16.670

**如果我必须使用 XSLT 1.0，我会写一个这样的两遍转换：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common">
 <xsl:output method="text"/>

 <xsl:template match="/*">
  <xsl:variable name="vrtfPass1">
      <xsl:copy><xsl:apply-templates/></xsl:copy>
  </xsl:variable>

  <xsl:apply-templates select=
  "ext:node-set($vrtfPass1)/*/line
       [preceding-sibling::node()[1][self::text() and normalize-space()]]"/>
 </xsl:template>

 <xsl:template match="/*/text()" name="markUp">
  <xsl:param name="pText" select="."/>

  <xsl:if test="normalize-space($pText)">
      <xsl:value-of select="substring-before(concat($pText,'&#xA;'), '&#xA;')"/>
      <line/>
      <xsl:call-template name="markUp">
        <xsl:with-param name="pText" select="substring-after($pText,'&#xA;')"/>
      </xsl:call-template>
  </xsl:if>
 </xsl:template>

 <xsl:template match="line">
Error: <xsl:value-of select="concat(position(), '&#xA;')"/>
  <xsl:value-of select="normalize-space(preceding-sibling::node()[1])"/>
  <xsl:text>&#xA;</xsl:text>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<Messages>
   error message 1

   error message 2
</Messages> 
```

**产生了想要的正确结果：**

```
Error: 1
error message 1

Error: 2
error message 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T15:52:05.557

您可以使用此递归模板来实现此目的：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="html" omit-xml-declaration="yes"/>

  <xsl:template match="Messages" name="outputError">
    <xsl:param name="index" select="1"/>
    <xsl:param name="source" select="text()"/>
    <xsl:variable name="thisLine" select="normalize-space(substring-before($source, '&#10;'))"/>
    <xsl:variable name="theRest" select="substring-after($source, '&#10;')"/>
    <xsl:choose>
      <xsl:when test="$thisLine">
        <h3>Error <xsl:value-of select="$index"/>:</h3>
        <span><xsl:value-of select="$thisLine"/></span>
        <xsl:call-template name="outputError">
          <xsl:with-param name="index" select="$index + 1"/>
          <xsl:with-param name="source" select="$theRest"/>
        </xsl:call-template>
      </xsl:when>
      <xsl:when test="$theRest">
        <xsl:call-template name="outputError">
          <xsl:with-param name="index" select="$index"/>
          <xsl:with-param name="source" select="$theRest"/>
        </xsl:call-template>
      </xsl:when>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet> 
```

我将实际错误包装在一个`<span>`元素中只是为了清楚地将它们与空白区分开来，如果您愿意，您当然可以使用 a `<p>`，`<div>`或者根本没有元素。

# python - 无法使功能正常工作

> ID：16071394
> 
> 赞同：0
> 
> 时间：2013-04-17T22:32:43.697
> 
> 标签：python, function

我正在尝试创建一个函数，该函数将通过一条消息倒计时结束我的游戏，并且我不得不在我的文本冒险游戏中重复这个代码块，所以我决定为它制作一个函数为了整洁和效率。但我不知道如何定义和调用这样的函数。这是我试图执行的代码：

```
print "That\'s a real shame..."
time.sleep(1)
print 'Exiting program in 5 seconds:'
time.sleep(1)
print '5'
time.sleep(1)
print '4'
time.sleep(1)
print '3'
time.sleep(1)
print '2'
time.sleep(1)
print '1'
time.sleep(1)
sys.exit('Exiting Game...')
break 
```

所以我这样定义函数：

```
def exit():
    print "That\'s a real shame..."
    time.sleep(1)
    print 'Exiting program in 5 seconds:'
    time.sleep(1)
    print '5'
    time.sleep(1)
    print '4'
    time.sleep(1)
    print '3'
    time.sleep(1)
    print '2'
    time.sleep(1)
    print '1'
    time.sleep(1)
    sys.exit('Exiting Game...')
    break 
```

我这样调用函数：

```
elif ready == 'n':
    exit 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T22:37:33.333

您可以通过键入来调用该函数`exit()`。我修改了您的倒计时代码并将其转换为我在内部调用的函数，`exit()`以演示如何从一段代码中调用一个函数。

```
def exit():
    print "That\'s a real shame..."
    time.sleep(1)
    print 'Exiting program in 5 seconds:'
    time.sleep(1)
    count_down(5) # Call Countdown clock
    print 'Exiting Game...'
    sys.exit()

def count_down(number):
    for i in reversed(range(number)):
        print i+1
        time.sleep(1)

exit() # <-- This how you call exit, you were missing the parentheses at the end. 
```

输出：

```
That's a real shame...
Exiting program in 5 seconds:
5
4
3
2
1
Exiting Game... 
```

**编辑：** *添加了更深入的解释。*

第一行`def count_down`是一个函数，它接受一个[参数](http://www.tutorialspoint.com/python/python_functions.htm)并且有一个目的，处理倒计时。

```
def count_down(number): 
```

第二行包含我们所说的[for 循环](http://docs.python.org/2/tutorial/controlflow.html#for-statements)。这段代码的目的是循环对象。`4`从那时开始等等。每次循环经过一个数字时，同一行`3,2,1`的变量都会改变，并且只能在循环内部访问。`i`第一次执行打印将是 5，然后是下一次 4，依此类推。

```
 for i in reversed(range(number)): 
```

在这个函数中，我们还使用了两个额外的关键字和一个参数，`reversed`以及`range`参数`number`。

```
reversed(range(number)) 
```

[range](http://docs.python.org/release/1.5.1p1/tut/range.html)用于创建一个数字列表，例如`[0, 1, 2, 3, 4]`，for 语句将从 with 开始循环`0`，然后一直获取下一个数字，直到到达最后一个数字`4`。我将解释为什么它从零开始，只到四，而不是在我的答案结束时五。

[reversed](http://docs.python.org/2/library/functions.html#reversed)用于反转我们使用范围创建的列表。既然我们想从 开始`4`，而不是`0`。

之前`reversed`=>`[0,1,2,3,4]`

之后`reversed]`=>`[4,3,2,1,0]`

`number`是一个参数。参数是我们`exit()`通过在圆括号中包含一个值从您的函数执行函数时提供的值`()`。在本例中，我们指定了 5，因此我们创建的列表 `range`范围为 0 - 4（0、1、2、3、4 = 总共五个数字）。如果您改为在括号内指定 10，它将创建一个从 0 一直到 9 的列表。您的代码将从 10 倒数到 1，而不是从 5 到 1。

当 Python 开始处理 时，`for loop`它将执行内部的代码，从 开始，`print`然后`sleep`，并继续对由 . 创建的列表中的每个数字执行此操作`range`。由于我们在本例中指定了 5 次，因此它总共会执行 5 次代码。

由于 Python 在其中执行代码，`for loop`它将首先调用 print 函数。因为 for 循环将从 开始`4`，而不是`5`，我们需要做一些基本的算术并将我们循环的每个项目的值增加一。我们通过`+ 1`在变量后面键入来做到这一点`i`。

它从 4 而不是 5 开始的原因是因为在编程列表中以数字开头`0`，而不是`1`。[关于列表](http://docs.python.org/release/1.5.1p1/tut/lists.html)以 0 而不是 1（或 4，在这种情况下不是 5，因为我们颠倒了列表）开头的原因，有一个更技术性的[解释](https://stackoverflow.com/questions/7320686/why-does-the-indexing-start-with-zero-in-c)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T22:37:25.100

您应该将其称为`exit()`，而不是`exit`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:46:07.000

很简单。使用`tuple`保存消息和计时器延迟的 a，这样您甚至可以控制每条消息的延迟时间。

```
import time, sys
messages = [
    ("That's a shame", 1),
    ("Exiting program in 5 seconds", 1),
    (None, 5)
]

for k,v in messages:
    if k:
        print(k)
        time.sleep(v)
    else:
        # start countdown timer
        while v:
            print v
            time.sleep(1)
            v -= 1

sys.exit() 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-17T22:47:57.570

A good way to do this code is:

```
def exit():
    timer= 5
    print "That\'s a real shame..."
    time.sleep(1)
    print 'Exiting program in 5 seconds:'
    for i in range (5):
        time.sleep(1)
        print timer
        timer = timer - 1
    sys.exit('Exiting Game...')

##You call the function like this
exit() 
```

# php - 相同的 Zend Navigation 代码在不同环境下呈现不同

> ID：16071398
> 
> 赞同：0
> 
> 时间：2013-04-17T22:32:47.720
> 
> 标签：php, zend-framework, routing

任何人都知道可能导致 Zend Navigation 出现问题的原因。我的环境是通过 chef 配置的，并且是相同的操作系统等，相同的 apache 设置等。在我的本地 Ubuntu VM 上，我的 webapp 正确呈现。SAME 代码无法在我的 TEST VM（在 AWS 上）上呈现导航。当我说同样的话时，我已经检查并仔细检查了（并且全部通过 PHING 部署），包括将 TEST 中的不正确显示的代码 SCPing 回我的盒子，然后它可以正常工作。

我完全被困住了。有谁知道关于 Zend 如何渲染导航的任何低级怪癖？它是否写入临时文件或其他东西（长镜头）。问题是路由一个IMO。菜单不认为它处于活动状态，但使用与我的开发环境相同的 routes.ini 文件，它在哪里很好。

我尝试更改环境设置（开发、测试）等，但没有。它不能是 DATA，因为对路由没有影响。

真的很感激任何见解..

解决方案！

啊哈哈哈。Zend 的修订版似乎破坏了导航。本地看不到的原因，是因为我在本地使用 Vagrant 由 VM 管理。挂载的文件夹当然是一个只读文件系统，所以我到正确的 Zend 供应商的“ln -s -f 符号链接”在我的脚本中默默地失败了，但是在 AWS 上运行 LIVE - 因此他们使用不同的 Zend版本和打破我导航的新版本（！另一个故事）只能在现场看到......！在这里结束对自己的教训。部署脚本中的故障总是停止

# javascript - 使数组不区分大小写

> ID：16071399
> 
> 赞同：0
> 
> 时间：2013-04-17T22:32:58.283
> 
> 标签：javascript, jquery, arrays, string, case-insensitive

我正在尝试删除包含特定单词的 div。

这是示例 jquery 代码：

```
var someArray = [
        'someword',
        'someword2',
        'someword3'
  ];

    for (var i = 0; i < someArray.length; i++) {
        $("div:contains('"+someArray[i]+"').remove();
  } 
```

仅删除包含单词“someword”的div，但不删除“Someword，SOMEWORD，soMeWoRd”等。

如何使数组大小写不敏感，匹配两种组合？

# eclipse - 我想恢复意外删除的断点。（蚀）

> ID：16071401
> 
> 赞同：2
> 
> 时间：2013-04-17T22:33:26.000
> 
> 标签：eclipse

我不小心删除了所有断点，我想知道如何恢复它们。有人可以帮帮我吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T05:48:23.533

如果您没有工作区目录的完整备份，则没有办法。

为了下次避免这种情况，这些是您的选择：

*   使用 File -> Export -> Run/Debug -> Breakpoints 定期导出断点。
*   使用[Mylyn 配置插件](https://github.com/sschmidt/edu.tum.cs.mylyn.provisioning)，它会在使用 Mylyn 时自动将断点存储在任务上下文中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-31T19:29:20.990

通过终止进程重新启动应用程序。它也适用于 IntelliJ

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-01T11:18:06.957

通过终止进程重新启动应用程序。它在视觉工作室工作

# apache - 如何将两个域指向同一个根目录以运行多个 drupal 站点

> ID：16071403
> 
> 赞同：0
> 
> 时间：2013-04-17T22:33:41.140
> 
> 标签：apache, drupal, dns, vhosts

我试图将两个域指向同一个根目录。他们都共享相同的名称服务器和 IP 地址。现在我创建了一个文件：

```
vhost.conf 
```

我把这个文件放在[http://firstdomain.com](http://firstdomain.com)的conf 文件夹下 文件有一行代码：

```
DocumentRoot /var/www/vhosts/seconddomain.com 
```

firstdoman.com 仍然没有选择新的根文件夹。我确实在 /sites 目录中有两个目录，它们以两个域的名称命名，它们都有一个文件和一个 settings.php 文件。并且默认目录没有被修改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:32:20.720

我制作了一个 YouTube 视频来回答我的问题：

```
http://www.youtube.com/watch?list=PL_aBy6EQRuXrysPXkkthzWVmkCBc0x2f9&feature=player_detailpage&v=LWxrC5vivAM 
```

# iphone - iPhone 上的背景图像无法正确显示

> ID：16071406
> 
> 赞同：1
> 
> 时间：2013-04-17T22:33:43.893
> 
> 标签：iphone, css, background

我有一个背景图像，它应该在计算机上显示，但由于某种原因它变得太小（就像在我的 iphone 上查看它时它应该是一半大小。在我一直在工作时，某些事情导致了这种情况发生页面，因为今天早些时候不是这种情况。

这是包含 bg img 的 div 的 css。关于发生了什么的任何想法？

```
#wrapper{
    position:relative;
    width:1000px;
    height:5854px;
    background-image:url(../images/UnearthingBG.jpg);
    background-color:#000;
    margin-top: 75px;
    margin-right: auto;
    margin-bottom: 0px;
    margin-left: auto;
    background-repeat: no-repeat;
    } 
```

这是工作页面[http://www.unearthingfilm.com/Test.html](http://www.unearthingfilm.com/Test.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:28:57.900

我昨晚设法修复了它`background-size: cover.`

谢谢您的回答。非常感激

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:40:23.593

我让它在我的 iPhone 3GS 上工作，并设置`background-size`：

```
#wrapper {
    -webkit-background-size: 1000px 5854px;
} 
```

这很hacky，但在这里完成了工作。我应该说，我的 iPhone 只是用来玩数独游戏，多年来没有得到任何更新，所以它运行的是 iOS 3。;)

这可能是原因： http: [//medialab.zendesk.com/entries/22472177-Large-image-as-browser-background-not-working-on-iPhone-Safari-browser](http://medialab.zendesk.com/entries/22472177-Large-image-as-browser-background-not-working-on-iPhone-Safari-browser)

> 您的问题是由移动 Safari 引起的。它只是缩小所有大于 2Mpx 的图像。

不知道是不是真的，但很有道理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T23:36:43.097

我刚刚在我的 iPhone 上测试了您的网站，背景图像看起来不错。我添加了一个截图打击。您的 iPhone 可能出现错误并在某处缓存文件。

我建议可以尝试去*** 设置 -> Safari -> 清除 Cookies 和数据 ***

![在此处输入图像描述](https://i.stack.imgur.com/aM5mX.jpg)

# qt - 无法在 Qt 项目中使用共享库

> ID：16071409
> 
> 赞同：5
> 
> 时间：2013-04-17T22:33:46.937
> 
> 标签：qt, shared-libraries, qt-creator, ld, dynamic-linking

我在 Qt creator 中创建了一个 C++ 库项目。构建项目后，我有 libMylib.so、.so.1、.so.1.0、.so.1.0.0、Makefile 和 mylib.o 文件。我将库头添加到我的另一个项目中，并将路径添加到我的 .pro 文件中，如下所示：

```
LIBS += "/home/peter/Workspace/build-Libtester-Desktop-Release/libMyLib.so" 
```

在构建应用程序时，我没有收到这样的文件错误，但是在运行它时，我得到了这个：

```
/home/peter/Workspace/build-Libtester-Desktop-Debug/Libtester: error while loading shared libraries: libMyLib.so.1: cannot open shared object file: No such file or directory 
```

我无法理解，因为它就在它似乎找到的 .so 旁边，因为当路径错误时，我在尝试构建项目时收到没有此类文件或目录错误。有人可以解释我在这里缺少什么吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:31:53.310

幸运的是，您的问题与 Qt 和 Qt Creator 无关。该错误简单归结为[LD](http://en.wikipedia.org/wiki/Dynamic_linker)如何在 Unix OS 系列上搜索共享库以进行动态链接。

今天，我已经回答[了类似的问题，请看一下](https://stackoverflow.com/questions/16045885/cmake-build-mac-app/16063632#16063632)。这个问题是关于 Mac OS X 的。但是，Linux 和 Mac OS X 在您的问题的上下文中是相同的。我在底部提供了对Linux的额外解释，请注意。*“它就在”**旁边`.so`*- 如果你做出这个假设，你似乎有 Windows 背景，但对于 Unix OS 系列来说这是错误的（如答案中所述）。如果您还有其他问题，请询问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-10T22:17:22.277

您错误地添加了库。你正在做：

```
LIBS += "/home/peter/Workspace/build-Libtester-Desktop-Release/libMyLib.so" 
```

代替：

```
LIBS += -L"/home/peter/Workspace/build-Libtester-Desktop-Release" -lMyLib 
```

第一个版本适用于 windows，但不适用于 linux。

基本上，您创建一个名为“libMyLib.so”的库，然后指定其文件夹的路径，以“-L”开头，然后在末尾执行“-lMyLib”，注意它不是“- llibMyLib”，但只是“-lMyLib”，尽管 .so 名称是“libMyLib”。

看这里：[https](https://wiki.qt.io/How_to_create_a_library_with_Qt_and_use_it_in_an_application) ://wiki.qt.io/How_to_create_a_library_with_Qt_and_use_it_in_an_application了解更多信息。

# facebook - 错误：无法解密访问令牌

> ID：16071412
> 
> 赞同：0
> 
> 时间：2013-04-17T22:34:09.753
> 
> 标签：facebook, token

几天以来，当我尝试使用令牌从我的应用程序中发布用户墙时，我遇到了这个错误：`The access token could not be decrypted`

这是我第一次收到此错误，我真的不明白为什么。

3 月生成的令牌仍然有效（我使用长期访问和 publish_actions）。所以可以肯定的是，我现在创建了一些新闻令牌（来自同一个应用程序），它们目前可以很好地贴在墙上。（也许他们很快就会得到错误？我暂时不知道）

那么为什么我在本月（4 月）生成的令牌出现此错误，除了现在生成的令牌（用于测试）？

也许 Facebook 这个月在发布代码中改变了一些东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-27T17:52:06.220

我遇到了类似的问题，发现原因是我们只存储的数据库仅限于 200 个字符或更少的访问令牌，因此我们的访问令牌被截断了。我将数据库字段扩大到 512 个字符，一切又对我有用。似乎访问令牌现在有 219 个字符长。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-21T06:33:44.847

是的，这似乎是数据库字段大小问题。更改数据库字段以保存 512 个或更多字符。

就我而言，它有效。

# jakarta-ee - 在 WAR 文件中部署时，ejb-jar.xml 中的 env-entry 未注入 @Resource

> ID：16071416
> 
> 赞同：1
> 
> 时间：2013-04-17T22:34:37.757
> 
> 标签：jakarta-ee, maven-2, glassfish-3, ejb-3.1, ejb-jar.xml

我有一个依赖于 EJB 项目的 Maven Web 应用程序。

```
 <dependency>
        <groupId>${project.groupId}</groupId>
        <artifactId>soar-ejb</artifactId>
        <version>1.0</version>
        <type>jar</type>
    </dependency> 
```

在 EJB 项目中，我添加了`env-entry`一个`ejb-jar.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar xmlns = "http://java.sun.com/xml/ns/javaee" 
     version = "3.1"
         xmlns:xsi = "http://www.w3.org/2001/XMLSchema-instance" 
         xsi:schemaLocation = "http://java.sun.com/xml/ns/javaee     http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd">
    <enterprise-beans>
        <session>
            <env-entry>
                <description>Config file</description>
                <env-entry-name>configFileLocation</env-entry-name>
                <env-entry-type>java.lang.String</env-entry-type>
                <env-entry-value>dropbox-config.properties</env-entry-value>
            </env-entry>
        </session>
    </enterprise-beans>
</ejb-jar> 
```

我已经使用 arquillian 测试了 EJB 项目，并且可以使用以下方法注入此值`@Resource` ：@Resource(name = "configFileLocation") private String configFile;

现在，当我使用 ejb 依赖项构建 .war 时，我会在我的 EJB 项目中获得一个 .war 作为 .jar inside `WEB-INF\lib`。在这个 EJB 项目中（即在 .jar 中），该`ejb-jar.xml`文件位于正确的 `META-INF`目录中。

但是现在，当我部署到服务器时，`@Resource`注入永远不会起作用。`String`总是`null`。_ 根据我所阅读的内容，我`ejb-jar.xml`在 EJB 项目和 maven 生成的 .war 中都有正确的位置。

有人会知道我的配置不正确吗？

谢谢！

编辑：

将会话元素修改为

```
<session>
        <description>An EJB that loads configuration from a file</description>
        <display-name>ConfigurationProducer</display-name>
        <ejb-name>ConfigurationProducer</ejb-name>
        <ejb-class>com.trf.util.DropboxConfigFileProducer</ejb-class>
        <session-type>Stateless</session-type>
        <env-entry>
            <description>Location of the config file</description>
            <env-entry-name>configFileLocation</env-entry-name>
            <env-entry-type>java.lang.String</env-entry-type>
            <env-entry-value>dropbox-config.properties</env-entry-value>
        </env-entry>
    </session> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T19:43:12.380

我通过修改`ejb`项目的依赖项来解决这个问题，然后将和项目包装`pom.xml`到一个项目中。Web 存档的现在看起来像这样：`provided``war``ejb``ear``pom.xml`

```
 <dependency>
        <groupId>${project.groupId}</groupId>
        <artifactId>soar-ejb</artifactId>
        <version>1.0</version>
        <scope>provided</scope>
    </dependency> 
```

然后在`ear`项目中`pom.xml`我们有这个：

```
 <dependencies>
    <dependency>
        <groupId>${project.groupId}</groupId>
        <artifactId>soar-ejb</artifactId>
        <version>1.0</version>
        <type>ejb</type>
    </dependency>
    <dependency>
        <groupId>${project.groupId}</groupId>
        <artifactId>soar-war</artifactId>
        <version>1.0</version>
        <type>war</type>
    </dependency>
</dependencies> 
```

`@Resource`当我从项目部署到服务器时，注入现在正在进行`env-entries`中`ejb`！`ejb-jar.xml``ear`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:44:53.777

*您的ejb-jar.xml*的*session*元素不包含*ejb-name*属性，尝试使用与 bean 接口名称匹配的名称。我已经编辑了您的答案，向您展示了一个示例。

# algorithm - 寻找唯一的（如只发生一次）元素haskell

> ID：16071417
> 
> 赞同：8
> 
> 时间：2013-04-17T22:34:42.400
> 
> 标签：algorithm, haskell, functional-programming

我需要一个函数，它接受一个列表，如果存在则返回唯一元素，如果不存在则返回 []。如果存在许多独特的元素，它应该返回第一个（不要浪费时间去寻找其他元素）。此外，我知道列表中的所有元素都来自（小且已知的）集合 A。例如，此函数为 Ints 完成工作：

```
unique :: Ord a => [a] -> [a]
unique li = first $ filter ((==1).length) ((group.sort) li)
    where first [] = []
          first (x:xs) = x

ghci> unique [3,5,6,8,3,9,3,5,6,9,3,5,6,9,1,5,6,8,9,5,6,8,9]
ghci> [1] 
```

然而，这还不够好，因为它涉及排序（n log n），而它可以在线性时间内完成（因为 A 很小）。此外，它要求列表元素的类型是 Ord，而所有应该需要的是 Eq。如果比较的数量越少越好（即，如果我们遍历一个列表并遇到元素 el 两次，我们不会测试后续元素是否与 el 相等）

这就是为什么例如：[计算列表中的唯一元素](https://stackoverflow.com/questions/3710976/counting-unique-elements-in-a-list/3713886#3713886)并不能解决问题 - 所有答案都涉及排序或遍历整个列表以查找所有元素的计数。

问题是：如何在 Haskell 中正确有效地做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-18T08:37:31.587

好的，线性时间，来自有限域。运行时间将为*O((m + d) log d)*，其中*m*是列表的大小，*d是域的大小，当**d*固定时，它是线性的。我的计划是使用集合的元素作为[trie](http://hackage.haskell.org/package/data-inttrie)的键，计数作为值，然后在 trie 中查找计数为 1 的元素。

```
import qualified Data.IntTrie as IntTrie
import Data.List (foldl')
import Control.Applicative 
```

计算每个元素。*这将遍历列表一次，使用结果（ O(m log d)* ）构建一个 trie ，然后返回一个在 trie 中查找结果的函数（运行时间为*O(log d)*）。

```
counts :: (Enum a) => [a] -> (a -> Int)
counts xs = IntTrie.apply (foldl' insert (pure 0) xs) . fromEnum
    where
    insert t x = IntTrie.modify' (fromEnum x) (+1) t 
```

我们使用`Enum`约束将类型的值转换`a`为整数，以便在 trie 中对它们进行索引。一个`Enum`实例是您假设的见证的一部分，它`a`是一个小的有限集（`Bounded`将是另一部分，但见下文）。

然后寻找那些独一无二的。

```
uniques :: (Eq a, Enum a) => [a] -> [a] -> [a]
uniques dom xs = filter (\x -> cts x == 1) dom
    where
    cts = counts xs 
```

该函数将整个域的枚举作为其第一个参数。我们本可以需要一个`Bounded a`约束并`[minBound..maxBound]`改为使用它，这在语义上对我很有吸引力，因为有限本质上是`Enum`+ `Bounded`，但是非常不灵活，因为现在需要在编译时知道域。所以我会选择这个稍微难看但更灵活的变体。

`uniques`遍历域一次（懒惰，所以`head . uniques dom`只会遍历它需要找到第一个唯一元素 - 不是在列表中，而是在 中`dom`），对于运行我们建立的查找函数的每个元素是*O(log d )*，所以过滤器需要*O(d log d)*，构建计数表需要*O(m log d)*。所以`uniques`在*O((m + d) log d)中运行，当**d*固定时它是线性的。至少需要*Ω(m log d)*才能从中获取任何信息，因为它必须遍历整个列表才能构建表格（您必须一直到列表末尾才能查看元素是否为重复，所以你不能做得比这更好）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T22:42:30.780

真的没有任何方法可以有效地做到这一点`Eq`。您需要使用一些效率低得多的方法来构建相等元素的组，并且如果不扫描整个列表，您将无法知道仅存在一个特定元素。

另外，请注意，为了避免无用的比较，您需要一种方法来检查之前是否遇到过某个元素，而唯一的方法是拥有一个已知多次出现的元素列表，并且唯一的检查当前元素是否在该列表中的方法是...将其与每个元素进行比较。

如果您希望它比 O（非常可怕的东西）更快地工作，您需要该`Ord`约束。

* * *

好的，根据评论中的澄清，这是我*认为*您正在寻找的一个快速而肮脏的示例：

```
unique [] _ _ = Nothing
unique _ [] [] = Nothing
unique _ (r:_) [] = Just r
unique candidates results (x:xs)
    | x `notElem` candidates = unique candidates results xs
    | x `elem` results       = unique (delete x candidates) (delete x results) xs
    | otherwise              = unique candidates (x:results) xs 
```

第一个参数是候选列表，最初应该是所有可能的元素。第二个参数是可能的结果列表，最初应该是空的。第三个参数是要检查的列表。

如果它用完了候选者，或者到达列表末尾但没有结果，则返回`Nothing`. 如果它到达结果列表的末尾，则返回结果列表前面的那个。

否则，它会检查下一个输入元素：如果它不是候选元素，则忽略它并继续。如果它在结果列表中我们已经看到了两次，那么将其从结果和候选列表中删除并继续。否则，将其添加到结果中并继续。

不幸的是，这仍然必须扫描整个列表以获取单个结果，因为这是确保它实际上是唯一的唯一方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T22:58:37.317

首先，如果您的函数旨在最多返回一个元素，则几乎可以肯定使用`Maybe a`而不是`[a]`返回结果。

其次，至少，您别无选择，只能遍历整个列表：在查看所有其他元素之前，您无法确定任何给定元素是否真的是唯一的。

如果您的元素没有`Ord`经过验证，但只能进行质量测试`Eq`，那么您确实没有比以下更好的选择：

```
firstUnique (x:xs)
  | elem x xs = firstUnique (filter (/= x) xs)
  | otherwise = Just x
firstUnique [] = Nothing 
```

请注意，如果您不想，则不需要过滤掉重复的元素——最坏的情况是二次的。

* * *

编辑：

由于上述小/已知的一组可能元素，上述内容错过了提前退出的可能性。但是，请注意，最坏​​的情况仍然需要遍历整个列表：所需要的只是使这些可能元素中的至少一个从列表中*丢失*......

但是，在集合耗尽的情况下提供早期退出的实现：

```
firstUnique = f [] [<small/known set of possible elements>] where
  f [] [] _ = Nothing  -- early out
  f uniques noshows (x:xs)
    | elem x uniques = f (delete x uniques) noshows xs
    | elem x noshows = f (x:uniques) (delete x noshows) xs
    | otherwise      = f uniques noshows xs
  f []    _ [] = Nothing
  f (u:_) _ [] = Just u 
```

请注意，如果您的列表包含不应该存在的元素（因为它们不在小/已知集合中），它们将被上面的代码明确忽略......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T07:52:02.260

正如其他人所说，没有任何额外的约束，你不能在小于二次的时间内做到这一点，因为如果不了解元素，你就无法将它们保存在某种合理的数据结构中。

如果我们能够比较元素，一个明显的*O(n log n)*解决方案首先计算元素的计数，然后找到第一个计数等于 1 的元素：

```
import Data.List (foldl', find)
import Data.Map (Map)
import qualified Data.Map as Map
import Data.Maybe (fromMaybe)

count :: (Ord a) => Map a Int -> a -> Int
count m x = fromMaybe 0 $ Map.lookup x m

add :: (Ord a) => Map a Int -> a -> Map a Int
add m x = Map.insertWith (+) x 1 m

uniq :: (Ord a) => [a] -> Maybe a
uniq xs = find (\x -> count cs x == 1) xs
  where
    cs = foldl' add Map.empty xs 
```

请注意，*log n*因子来自我们需要对`Map`大小为*n*的 a 进行操作的事实。如果列表只有*k*个唯一元素，那么我们的地图大小最多为*k*，因此整体复杂度仅为*O(n log k)*。

但是，我们可以做得更好——我们可以使用[哈希表](http://hackage.haskell.org/packages/archive/hashtables/1.1.0.2/doc/html/Data-HashTable-ST-Basic.html)而不是映射来获得***O(n)*解决方案**。为此，我们需要`ST`monad 在哈希映射上执行可变操作，并且我们的元素必须是[Hashable](http://hackage.haskell.org/packages/archive/hashable/1.2.0.4/doc/html/Data-Hashable.html#t%3aHashable)。`ST`解决方案与以前基本相同，只是由于在monad中工作而稍微复杂一点：

```
import Control.Monad
import Control.Monad.ST
import Data.Hashable
import qualified Data.HashTable.ST.Basic as HT
import Data.Maybe (fromMaybe)

count :: (Eq a, Hashable a) => HT.HashTable s a Int -> a -> ST s Int
count ht x = liftM (fromMaybe 0) (HT.lookup ht x)

add :: (Eq a, Hashable a) => HT.HashTable s a Int -> a -> ST s ()
add ht x = count ht x >>= HT.insert ht x . (+ 1)

uniq :: (Eq a, Hashable a) => [a] -> Maybe a
uniq xs = runST $ do
    -- Count all elements into a hash table:
    ht <- HT.newSized (length xs)
    forM_ xs (add ht)
    -- Find the first one with count 1
    first (\x -> liftM (== 1) (count ht x)) xs

-- Monadic variant of find which exists once an element is found.
first :: (Monad m) => (a -> m Bool) -> [a] -> m (Maybe a)
first p = f
  where
    f []        = return Nothing
    f (x:xs')   = do
        b <- p x
        if b then return (Just x)
             else f xs' 
```

**笔记：**

*   如果您知道列表中只有少量不同的元素，您可以使用`HT.new`代替`HT.newSized (length xs)`. 这将为您节省一些内存和一次通过，`xs`但在许多不同元素的情况下，哈希表将不得不调整几次。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T03:10:21.150

这是一个可以解决问题的版本：

```
unique :: Eq a => [a] -> [a]
unique =  select . collect []
  where
    collect acc []              = acc
    collect acc (x : xs)        = collect (insert x acc) xs

    insert x []                 = [[x]]
    insert x (ys@(y : _) : yss) 
      | x == y                  = (x : ys) : yss
      | otherwise               = ys : insert x yss

    select []                   = []
    select ([x] : _)            = [x]
    select ((_ : _) : xss)      = select xss 
```

因此，首先我们遍历输入列表 ( `collect`)，同时维护我们更新的相等元素的桶列表`insert`。然后我们只需选择出现在单例桶 ( `select`) 中的第一个元素。

坏消息是这需要二次时间：对于每个访问过`collect`的元素，我们需要遍历桶列表。恐怕这是您必须为只能将元素类型限制为 in 所付出的代价`Eq`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T22:58:04.983

像这样的东西看起来很不错。

```
unique = fst . foldl' (\(a, b) c -> if (c `elem` b) 
                                    then (a, b) 
                                    else if (c `elem` a) 
                                         then (delete c a, c:b) 
                                         else (c:a, b)) ([],[]) 
```

折叠的结果元组的第一个元素包含您所期望的，一个包含唯一元素的列表。元组的第二个元素是一个元素是否已经被丢弃时所记住的进程的内存。

**关于空间表现。**
由于您的问题是设计，因此在显示结果之前，应至少遍历列表的所有元素一次。并且内部算法除了对好的值外，还必须对丢弃的值进行跟踪，但丢弃的值只会出现一次。那么在最坏的情况下，所需的内存量等于输入列表的大小。正如你所说的这种声音商品预期的投入很小。

**关于时间表现。**
由于预期输入很小且默认未排序，因此尝试将列表排序到算法中是无用的，或者在应用之前是无用的。事实上，我们几乎可以静态地说，将元素放置在其有序位置（放入子列表`a`和`b`元组中`(a,b)`）的额外操作将花费与检查该元素是否出现在列表中相同的时间。

* * *

下面是一个更好、更明确的 foldl' 版本。

```
import Data.List (foldl', delete, elem)

unique :: Eq a => [a] -> [a]
unique = fst . foldl' algorithm ([], []) 
  where 
    algorithm (result0, memory0) current = 
         if (current `elem` memory0)
         then (result0, memory0)
         else if (current`elem` result0)
              then (delete current result0, memory) 
              else (result, memory0) 
            where
                result = current : result0
                memory = current : memory0 
```

在嵌套`if ... then ... else ...`指令中，列表`result`在最坏的情况下被遍历两次，这可以避免使用以下辅助函数。

```
unique' :: Eq a => [a] -> [a]
unique' = fst . foldl' algorithm ([], []) 
  where 
    algorithm (result, memory) current = 
         if (current `elem` memory)
         then (result, memory)
         else helper current result memory []
            where
               helper current [] [] acc = ([current], [])
               helper current [] memory acc = (acc, memory)
               helper current (r:rs) memory acc 
                   | current == r    = (acc ++ rs, current:memory) 
                   | otherwise = helper current rs memory (r:acc) 
```

但是可以使用 fold 重写助手，如下所示，这绝对更好。

```
helper current [] _ = ([current],[])
helper current memory result = 
    foldl' (\(r, m) x -> if x==current 
                         then (r, current:m) 
                         else (current:r, m)) ([], memory) $ result 
```

# c - C 函数的平均执行时间不稳定

> ID：16071419
> 
> 赞同：0
> 
> 时间：2013-04-17T22:34:45.880
> 
> 标签：c, linux, time, execution-time

我正在尝试优化朋友给我的一段代码，但我的平均执行时间基准非常不稳定，我不知道为什么/如何修复它。

代码：

```
#include <sys/time.h>
#include <time.h>
#include <stdio.h>
#include "wall.h" /* Where his code is */

int main()
{
    int average;
    struct timeval tv;
    int i;

    for(i = 0; i < 1000; i++) /* Running his code 1,000 times */
    {
        gettimeofday(&tv, NULL); /* Starting time */ 

        start(); /* Launching his code */ 

        int ret = tv.tv_usec; /* Finishing time */ 
        ret /= 1000; /* Converting to milliseconds */ 
        average += ret; /* Adding to the average */ 
    }
    printf("Average execution time: %d milliseconds\n", average/1000);  
    return 0;
} 
```

5 次不同运行的输出：

*   804 毫秒
*   702 毫秒
*   394 毫秒
*   642 毫秒
*   705 毫秒

我尝试了多种不同的方法来获取平均执行时间，但每种方法要么没有给我足够精确的答案，要么给我一个完全不稳定的答案。我不知道现在该做什么，任何帮助将不胜感激！

我知道这些类型的基准测试非常依赖于系统，所以我在下面列出了我的系统规格：

*   Ubuntu 12.10 x64
*   7.8 GiB 内存
*   英特尔酷睿 i7-3770 CPU @ 3.40GHz x 8
*   GeForce GT 620/PCIe/SSE2

**编辑**

谢谢大家的意见，但我决定使用 gprof 而不是自己构建。再一次感谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T22:40:38.373

您的线路`int ret = tv.tv_usec; /* Finishing time */`没有给您完成时间，它仍然是开始时间。你应该做第二个`struct timeval`，用那个打电话`gettimeofday`并比较两者。

但是，使用[clock()](http://www.cplusplus.com/reference/ctime/clock/)可能更容易。当然，如果您想真正分析代码的性能，请使用[分析器](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:41:52.433

这里有几个问题，包括关于您正在执行基准测试的代码的零细节，以及您错误地使用了“gettimeofday()”（也许是不恰当的）。

建议：

1）不要使用“gettimeofday（）”：

[http://blog.habets.pp.se/2010/09/gettimeofday-should-never-be-used-to-measure-time](http://blog.habets.pp.se/2010/09/gettimeofday-should-never-be-used-to-measure-time)

2）用gprof补充你的“时间流逝”：

[http://www.cs.duke.edu/~ola/courses/programming/gprof.html](http://www.cs.duke.edu/~ola/courses/programming/gprof.html)

# regex - 正则表达式替换电子邮件地址域？

> ID：16071421
> 
> 赞同：1
> 
> 时间：2013-04-17T22:35:11.013
> 
> 标签：regex, email, replace

我需要一个正则表达式来混淆我拥有的数据库转储文件中的电子邮件。我想用一个设置的域替换所有域，`@fake.com`这样我就不会冒险在开发过程中向真实的人发送电子邮件。电子邮件必须是唯一的才能匹配数据库约束，所以我只想替换域并保留用户名。

我目前有这个正则表达式来查找电子邮件

```
\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b 
```

如何将此搜索正则表达式转换为可用于 Sublime Text 或 SED 或 Vim 中的查找和替换操作的正则表达式？

**编辑：**

请注意，我刚刚意识到我可以替换`@[A-Z0-9.-]+\.[A-Z]{2,4}\b`在这种情况下找到的所有字符串，但在学术上我仍然对如何将电子邮件正则表达式的每个部分视为令牌并独立替换用户名/域感兴趣。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T22:53:21.580

**崇高文本**

[SublimeText](http://docs.sublimetext.info/en/latest/search_and_replace/search_and_replace_overview.html)使用[Boost 语法](http://www.boost.org/doc/libs/1_47_0/libs/regex/doc/html/boost_regex/syntax/perl_syntax.html)，它支持 Perl 正则表达式中相当大的功能子集。但是对于这项任务，您不需要所有这些高级构造。

以下是两种可能的方法：

1.  如果您可以假设它`@`不会出现在任何其他上下文中（这对于普通文本来说是一个相当公平的假设），那么您可以只搜索域部分`@[A-Z0-9.-]+\.[A-Z]{2,4}\b`并替换它。

2.  如果您`(pattern)`在替换字符串中使用捕获组和反向引用。

    **找什么**

    ```
    \b([A-Z0-9._%-]+)@[A-Z0-9.-]+\.[A-Z]{2,4}\b 
    ```

    `([A-Z0-9._%-]+)`是正则表达式中的第一个（也是唯一一个）捕获组。

    **用。。。来代替**

    ```
    $1@fake.com 
    ```

    `$1`指第一个捕获组捕获的文本。

请注意，对于上述两种方法，您需要关闭区分大小写（表示为左下角的第二个按钮），除非您特别想删除以全部大写字母编写的电子邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:52:51.047

你可以对 Vim 使用以下命令：

```
:%s/\(\<[A-Za-z0-9._%-]\+@\)[A-Za-z0-9.-]\+\.[A-Za-z]\{2,4}\>/\1fake.com/g 
```

`\(`和之间的所有内容都`\)`将成为一个组，该组将被组的转义数字替换（`\1`在这种情况下）。我还修改了正则表达式以匹配小写字母并具有与 Vim 兼容的语法。

`\c`您也可以通过在您的正则表达式中的任何位置来关闭区分大小写，如下所示：

```
:%s/\c\(\<[A-Z0-9._%-]\+@\)[A-Z0-9.-]\+\.[A-Z]\{2,4}\>/\1fake.com/g 
```

另请注意，`%`在行的开头要求 Vim 在整个文件`g`中进行替换，最后在同一行中进行多次替换。

另一种方法是使用零宽度匹配 ( `\@<=`)：

```
:%s/\c\(\<[A-Z0-9._%-]\+@\)\@<=[A-Z0-9.-]\+\.[A-Z]\{2,4}\>/fake.com/g 
```

# python - Scipy.loadmat() ---- SystemError: ../Objects/stringobject.c:3899: bad argument to internal function

> ID：16071423
> 
> 赞同：0
> 
> 时间：2013-04-17T22:35:15.573
> 
> 标签：python, scipy

我正在尝试将 .mat 文件加载到非常大（>75MB）的 python 中，但出现以下错误。这可以帮助吗？

```
Traceback (most recent call last):
  File "prop_keys.py", line 34, in <module>
    prop_d = scipy.io.loadmat(prop)
  File "/usr/lib/python2.7/dist-packages/scipy/io/matlab/mio.py", line 175, in loadmat
    matfile_dict = MR.get_variables(variable_names)
  File "/usr/lib/python2.7/dist-packages/scipy/io/matlab/mio5.py", line 272, in get_variables
    hdr, next_position = self.read_var_header()
  File "/usr/lib/python2.7/dist-packages/scipy/io/matlab/mio5.py", line 224, in read_var_header
    stream = BytesIO(dcor.decompress(data))
SystemError: ../Objects/stringobject.c:3899: bad argument to internal function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T23:54:04.907

如此处所述：[http ://projects.scipy.org/scipy/ticket/1894](http://projects.scipy.org/scipy/ticket/1894)

该文件包含压缩数据，未压缩时高达 1.1GB。该错误消息是您的计算机没有足够的可用内存来存储此数据的症状。除此之外，文件的后半部分似乎也已损坏，Matlab 也无法正确加载。

（如果数据被压缩，Scipy 的 mat 文件加载例程实际上需要 2x 内存；但是，这将在 Scipy 0.13.0 中修复。）

# sql-server - 数据仓库设计 - 在 OLTP 中处理 NULL 和空值

> ID：16071427
> 
> 赞同：1
> 
> 时间：2013-04-17T22:35:42.143
> 
> 标签：sql-server, ssis, data-warehouse, business-intelligence

我正在为有点吱吱作响的 OLTP 创建一个 DW。

我面临的一个问题是 OLTP 数据库中没有太多的数据完整性。一个例子是郊区字段。

这个郊区字段是 OLTP UI 上的一个自由文本字段，这意味着我们在该字段中有值，此外还有空字符串和 NULL 值。

我们通常会如何处理这个问题？我想出的场景是：

1.  按原样导入数据（不理想）
2.  在我的 ETL 过程中，将任何空字符串视为 NULL，并将其替换为 DW 中的单词“Unknown”
3.  在 DW 中将空字符串和 NULL 作为空字符串导入

仅供参考，我正在使用 Microsoft BI 堆栈（SQL Server、SSIS、SSAS、SSRS）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T14:23:13.537

The short answer is, it depends on what `NULL` and empty strings mean in the source system.

This general question (handling `NULL`) has been discussed a lot, e.g. [here](https://stackoverflow.com/questions/16035761/nulls-in-dimension-table-for-numeric-attributes), [here](https://dba.stackexchange.com/questions/5222/why-shouldnt-we-allow-nulls), [here](https://stackoverflow.com/questions/8300953/why-null-values-are-mapped-as-0-in-fact-tables/8310891#8310891) etc. I think the most important point to remember is that a data warehouse is just a database; it may have a very specific type of schema and be designed for one purpose, but it's still just a database and any general advice on `NULL` still applies.

(As a side note, I sometimes prefer to talk about a "reporting database" rather than a "data warehouse", because it keeps things in perspective. Some DBAs and developers start making plans for huge server farms and multi-year ETL projects as soon as they hear the words "data warehouse", but in the end it's just a reporting database.)

Anyway, it isn't completely clear where you want to use `NULL` but it looks like it may be an attribute on a dimension.

I (probably) wouldn't use any of your three approaches, but it depends on the meaning of your data. Importing the data as-is is not useful because part of the value of a data warehouse is that the data has been cleaned and is consistent, which makes querying and comparing data along other dimensions much easier.

Replacing empty strings with 'Unknown' may or may not be correct: what does an empty string mean in the source system? There's a big difference between "it means there's no suburb" and "it means we don't know if there's a suburb". Assuming that an empty string means "no suburb" and `NULL` means "unknown" then I would import the empty strings as they are, but replace `NULL` with 'Unknown'. The main reason for doing that is that if the Suburb field will be used as a filter condition in a report, it's easier for users (and possibly your reporting tool) to work with a non-`NULL` value like 'UNKNOWN'. And if there is no consistency in the source system and you don't know what empty strings and NULLs mean, then you need to clarify that first and ideally fix the source system too (another benefit of a DWH is that it helps to identify inconsistencies and data handling errors in source systems).

Your last idea to convert `NULL`s to empty strings is the same issue: what does a `NULL` actually mean in the source system? If it means "no suburb" then replacing it with an empty string is probably a good idea, but if it means something else then you should handle it as something else.

So to summarize, my preference would be to import empty strings as-is, and convert `NULL` to 'UNKNOWN', but I can't be sure that this actually makes sense in your case. There's no single answer to this question because it all depends on your specific data and what it means. But there's no problem with using `NULL` in a data warehouse (or any other database) as long as you do it consistently and with a clear understanding of how the source systems handle data.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T03:22:27.627

从语义上讲，NULL 通常意味着未定义/未知。而“”空字符串意味着该值已知为空。在您的郊区示例中，NULL 可能意味着不知道给定记录是否存在郊区，而“”可能意味着给定记录肯定没有郊区。

如果在您的情况下 NULL 和 "" 的含义相同，最好在导入 DW 之前将这两个值标准化为相同的值（例如 ""），以便以后更容易进行报告（以免 NULL = 50 和 "" = 34 并且必须将它们加在一起）。

# security - 偶尔的 Oauth 异常 - 用户尚未授权该应用程序

> ID：16071436
> 
> 赞同：0
> 
> 时间：2013-04-17T22:36:37.180
> 
> 标签：security, facebook-oauth

我相当确定我的应用程序在 88-92% 的时间内都能正常处理大多数事情，但我经常收到以下错误：(OAuthException - #200) (#200) 用户尚未授权执行此操作的应用程序

我不明白这怎么可能。当请求用户授权应用程序时，我看不到他们接受所需权限子集的任何方式（全部或全部）。如果他们继续，并且我获得了身份验证令牌，这是否意味着我的应用程序具有所需的访问权限？如果没有，用户是如何做到的，我该如何预防或至少检测到它？

在背景方面，我的应用程序是一个信息亭应用程序，它拍摄用户的照片并允许他们在他们的 Facebook 时间线上发布（或者更准确地说，是一个链接）。信息亭获得用户的授权，然后将令牌和所有其他数据传递到中央网络服务，然后与 Facebook 通信。在过去的一周中，这在 88-92% 的时间内一直有效。尽管没有代码更改或应用程序配置更改，但在过去一周之前，在此之前的几周内，它的工作时间为 93-96%，比这早了大约 98%。

有什么方法可以向 facebook 提供一些详细信息（用户名和身份验证令牌）以进行更多分析？请帮忙！

# javascript - 复制非常旧的日期时，IE 中的 Javascript 日期“无效日期”

> ID：16071442
> 
> 赞同：0
> 
> 时间：2013-04-17T22:37:10.333
> 
> 标签：javascript, date

代码：

```
var x = new Date(Date.UTC(0, 0, 0));
x.setUTCFullYear(0);

// in Firefox, writes "Date {Sat Dec 30 0000 16:00:00 GMT-0800 (Pacific Standard Time)}"
// in IE, writes "LOG: Sat Dec 30 16:00:00 PST 1 B.C."
console.log(x);  

// Create a copy of x
var y = new Date(x);

// in Firefox, writes "Date {Sat Dec 30 0000 16:00:00 GMT-0800 (Pacific Standard Time)}"
// in IE, writes "LOG: Invalid Date"

console.log(y); 
```

这似乎发生在任何非常古老的日期

**我的问题**：这里到底什么是无效的，为什么只有 IE？我怎样才能解决这个问题并实际创建日期的副本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T22:49:10.153

It seems that when a date object is passed to the Date constructor in IE, it's evaluated as something other than the time value (probably calls `toString`).

To force it to evaluate to the time value, you can do:

```
new Date(x.getTime()); 
```

or

```
new Date(+x); 
```

or any expression that makes the date return its time value rather than a string.

When a single value is passed to the [Date constructor](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.3.2), it's converted to a primitive. The specification doesn't say whether it should be converted to a string or number. So IE isn't non–compliant, it's just behaving differently.

It is unusual though that IE doesn't seem to correctly parse it's own string representation of a date in this case. It seems to fail for any date before 70-01-01, which may be moot since the Gregorian calendar was only introduced in 1582\. The time value itself can cover dates from 283458 BC to 287396 AD.

Anyway, the fix is simple.

### Edit 2016

In [ES5](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.3.2), passing a Date to the Date constructor called *Date.prototype.toString* so the constructor then had to parse it's own string version of the date. [ECMAScript 2015](http://www.ecma-international.org/ecma-262/6.0/#sec-date-value) fixed that so the time value is used directly instead.

However, not all browsers support ECMAScript 2015 yet so even though the chance of `new Date(date)` returning an incorrect value are small and becoming smaller by the day, it's still safer to use `+date` (until IE 8 is completely gone).

# java - 如何在 Jenkins 中执行 Selenium 2 测试

> ID：16071443
> 
> 赞同：12
> 
> 时间：2013-04-17T22:37:11.687
> 
> 标签：java, ant, jenkins, selenium-webdriver, junit

*   我希望能够将 Selenium 2 与 Jenkins 一起使用。

*   我都是新手，所以请原谅我的无知。

*   我注意到 jenkins [HERE](https://wiki.jenkins-ci.org/display/JENKINS/Selenium+Plugin)的以下插件，并安装了它。

*   我有一个基类如下：

    ```
    public class BaseTestClass {

    protected Properties myprops;
    protected String baseurl;
    protected WebDriver driver;
    protected boolean acceptNextAlert = true;
    protected StringBuffer verificationErrors = new StringBuffer();

    public BaseTestClass()
    {
        try
        {
            myprops = TestUtil.readProps("src/MyProps.properties");
            baseurl = myprops.getProperty("baseurl");

            driver = new RemoteWebDriver(new URL("http://localhost:4444/wd/hub"), DesiredCapabilities.fireFox());
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }       
    }

    @Before
    public void setUp() throws Exception {
        driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
    }

    @After
    public void tearDown() throws Exception {
        driver.quit();
        String verificationErrorString = verificationErrors.toString();
        if (!"".equals(verificationErrorString)) {
            fail(verificationErrorString);
        }
    }

    protected boolean isElementPresent(By by) {
        try {
          driver.findElement(by);
          return true;
        } catch (NoSuchElementException e) {
          return false;
        }
      }

      protected String closeAlertAndGetItsText() {
        try {
          Alert alert = driver.switchTo().alert();
          if (acceptNextAlert) {
            alert.accept();
          } else {
            alert.dismiss();
          }
          return alert.getText();
        } finally {
          acceptNextAlert = true;
        }
      } 
    ```

**我在Jenkins的****Selenium 插件**上有以下配置：

 **![在此处输入图像描述](https://i.stack.imgur.com/zY38k.png)

..

![在此处输入图像描述](https://i.stack.imgur.com/jdXmV.png)

一旦我尝试构建项目并在 Jenkins 中运行 Junit selenium 测试，它就会成功构建，但它自身的测试失败。（从命令行使用 ant 运行时工作正常 - 并将其更改`WebDriver`为 : `driver = new FirefoxDriver();`） - 使用 selenium RC

这是 Jenkins 中的控制台输出： ![在此处输入图像描述](https://i.stack.imgur.com/JNBaJ.png)

**编辑**：我刚刚注意到您可以在 Jenkins 中构建后归档 Junit .xml 输出文件。我得到一个类未找到异常？`ant`这很奇怪，因为就像我说的那样，从命令行使用时它构建得很好。

错误如下：

```
<error message="com.loggedin.CCBreadCrumb" type="java.lang.ClassNotFoundException">
java.lang.ClassNotFoundException: com.loggedin.CCBreadCrumb at
java.net.URLClassLoader$1.run(URLClassLoader.java:366) at 
java.net.URLClassLoader$1.run(URLClassLoader.java:355) at
java.security.AccessController.doPrivileged(Native Method) at
java.net.URLClassLoader.findClass(URLClassLoader.java:354) at
java.lang.ClassLoader.loadClass(ClassLoader.java:423) at
sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308) at
java.lang.ClassLoader.loadClass(ClassLoader.java:356) at java.lang.Class.forName0(Native
Method) at java.lang.Class.forName(Class.java:186)
</error> 
```

提前感谢您提供的任何指导或帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T00:23:54.790

我想我犯了几个错误。为了解决这个问题，`Class Not Found Exception`我在 ant 中添加了以下内容`build.xml`- （记住我是新 Ant）

```
<target name="compile" depends="init" description="compile the source " >       
    <javac srcdir="src/" destdir="bin" classpathref="SeleniumCC.classpath"/>
</target> 
```

这让我的java类编译。

然后我不得不将 selenium 独立服务器更新到最新版本（`selenium-server-standalone-2.xx.x.jar`）它位于：

`jenkins_home_directory\plugins\selenium\WEB-INF\lib`

最后我试图在 selenium 插件中使用错误的配置（我试图使用自定义 RC 节点配置，我需要的是自定义 Web 驱动程序节点配置。）

![在此处输入图像描述](https://i.stack.imgur.com/YM2aV.png)

另请注意：在 Red Hat 上运行 Selenium Server 时，我必须使用 Jenkins Xvfb 插件设置和安装 XVFB。

我希望这对以后的其他人有帮助！祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T02:10:02.797

好吧，如果您的意图是在没有 Selenium Grid 的情况下简单地运行 selenium 脚本。然后你不需要任何插件。您只需要远程 webdriver。

要从 Jenkins 启动 Selenium 2，最好的方法是将测试过程包装在 pom.xml 中（如果您使用的是 Maven），然后使用 Jenkins 中的“构建 maven2/3 项目”在 Maven 中简单地创建一个新作业。**

# scikit-learn - 如何在 scikit-learn 中为 OneVsRestClassifier 设置类权重？

> ID：16071449
> 
> 赞同：4
> 
> 时间：2013-04-17T22:37:45.400
> 
> 标签：scikit-learn

我需要一个 SVM 作为多标签分类器，所以我决定使用 OneVsRestClassifier 包装器。然而问题出现了，训练集变得高度不平衡：对于给定的类，负样本比正样本多得多。这可以通过 class_weight 参数来解决，但如果我在封装在 OneVsRestClassifier 中的分类器中使用它，则会出现错误：

```
from sklearn.svm import LinearSVC
from sklearn.multiclass import OneVsRestClassifier

weights = {'ham': 1, 'eggs': 2}
svm = OneVsRestClassifier(LinearSVC(class_weight=weights))

X = [[1, 2], [3, 4], [5, 6], [7, 8], [9, 0]]
Y = [['ham'], [], ['eggs', 'spam'], ['spam'], ['eggs']]

svm.fit(X, Y) 
```

```
Traceback (most recent call last):
  File "", line 1, in 
  File "/usr/local/lib/python2.7/site-packages/sklearn/multiclass.py", line 197, in fit
    n_jobs=self.n_jobs)
  File "/usr/local/lib/python2.7/site-packages/sklearn/multiclass.py", line 87, in fit_ovr
    for i in range(Y.shape[1]))
  File "/usr/local/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py", line 514, in __call__
    self.dispatch(function, args, kwargs)
  File "/usr/local/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py", line 311, in dispatch
    job = ImmediateApply(func, args, kwargs)
  File "/usr/local/lib/python2.7/site-packages/sklearn/externals/joblib/parallel.py", line 135, in __init__
    self.results = func(*args, **kwargs)
  File "/usr/local/lib/python2.7/site-packages/sklearn/multiclass.py", line 56, in _fit_binary
    estimator.fit(X, y)
  File "/usr/local/lib/python2.7/site-packages/sklearn/svm/base.py", line 681, in fit
    self.classes_, y)
  File "/usr/local/lib/python2.7/site-packages/sklearn/utils/class_weight.py", line 49, in compute_class_weight
    if classes[i] != c:
IndexError: index 2 is out of bounds for axis 0 with size 2
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T07:59:03.237

问题是 LinearSVC 需要二进制类 [0, 1]。因此，为非二进制类（'ham'、'egg' 甚至 [0,1,2]）赋予权重会失败。但是您可以改用“自动”权重，它会通过选择适当的权重来自动“平衡”您的课程。然后它也适用于您的多类 OneVsRest 分类器。

```
svm = OneVsRestClassifier(LinearSVC(class_weight='auto'))

X = [[1, 2], [3, 4], [5, 4]]
Y = [0,1,2]

svm.fit(X, Y) 
```

# c - 有没有办法修改这个函数，以便它删除数组中的前一个元素 - C

> ID：16071452
> 
> 赞同：1
> 
> 时间：2013-04-17T22:37:48.720
> 
> 标签：c, arrays, list

因此，我被赋予了修改先前代码（模拟一副纸牌）的任务，以便通过在绘制后将数组中的纸牌移除来更准确地执行此操作。

我知道有一些方法可以使用链表来做到这一点，但我对使用链表还是很陌生，并且希望得到帮助，因为我处于严格的时间表上，更不用说按照我被教导的方式去做了完全改变我使用数组的代码、结构和指针，这将花费我没有的时间。

```
void draw(int deck[SIZE])
{
    int numCards = 10;
    int i; 
    int hand[numCards];
    int card;
    for(i = 0; i < numCards; i++)
    {
        card = deck[i];     
        hand[i] = card;     
        cards(card); 
    }
} 
```

这是我需要修改的当前功能，以便当将卡片添加到手 [i] 时，卡片会从卡片组 [i] 中移除，因此我不会重复。

卡片是打印卡片的功能，可以忽略

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#define SIZE 52

enum faces{Ace = 0, Jack = 10, Queen, King};
char * facecheck(int d); 
void shuffle( int deck[]);
void draw(int deck[SIZE]); 
void cards(int hand); 
int i;
int main() 
{ 
    int deck[SIZE], i, n;
    char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"
    };

    srand( time( NULL ) ) ;

    for(i = 0; i<SIZE; i++)
    {
        deck[i] = i;
    };

    shuffle(deck);
    draw(deck);
    shuffle(deck); 
    draw(deck);

    return 0; 
} 
```

这是当前的主要功能， shuffle 会按照您的想法进行，而 draw 是我需要修改的功能，因为即使它随机循环卡牌，如果运行足够多的话，两张卡也会出现在同一手牌中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:48:00.783

You can create a remove function which moves all next elements to the previous index and sets the last index to `-1`.

Though, it is not possible to **really** remove an element from an array in C, because it has a static allocated size which can not be modified, all you can do is something like this.

```
void remove_from_array(int index, int* array, int size)
{
    int i = 0;

    while (i < size)
      {
        if (i >= index && i == (size - 1))
          array[i] = -1;
        else if (i >= index)
          array[i] = array[i + 1];
        i++;
      }
}

remove_from_array(i, deck, SIZE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:41:28.513

您可以使用表示删除的特殊卡片 (-1)。因此：

```
card = deck[i];     
hand[i] = card;
deck[i] = -1; // deleted  
cards(card); 
```

# php - php PDO 错误的行数

> ID：16071454
> 
> 赞同：1
> 
> 时间：2013-04-17T22:37:56.250
> 
> 标签：php, pdo, count, row, prepared-statement

当我回显 $rows_affected 变量时，有人可以解释一下，为什么根据我的数据库记录我应该得到 2 时我只得到 1？半个多小时试图弄清楚这一点，但仍然无法解决它.. PDO 仍然是菜鸟。

欢迎任何其他建议。

```
$sql1 = "SELECT title FROM page WHERE id=?";
        $stm = $db->prepare($sql1);
        $stm->execute(array($id));
        $row1 = $stm->fetch(PDO::FETCH_ASSOC);

        $sql2 = "SELECT id,title,pg_title FROM page WHERE title=? ORDER BY id ASC";
        $stm = $db->prepare($sql2);
        $stm->execute(array($row1['title']));

        $rows_affected = $stm->fetchColumn();

        if (count($rows_affected) > 0) {
            for($i=0; $i <= $rows_affected; $i++) {

                $row2 = $stm->fetch(PDO::FETCH_ASSOC);

                if($row2['id']==$id){
                    echo '<a href="javascript: void(0)"><b>'.$row2['pg_title'].'</b></a>&nbsp;&nbsp;';
                }else{
                    echo '<a href="page.php?id='.$row2['id'].'';?><?php if(isset($_GET['edit']) && $_GET['edit']==1){ echo '&edit=1';}?><?php echo'">'.$row2['pg_title'].'</a>&nbsp;&nbsp;';

                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:50:43.833

[`fetchColumn()`](http://php.net/manual/en/pdostatement.fetchcolumn.php)：

> **从结果集的下一行**返回单个列，如果没有更多行，则返回 FALSE。

我想你想用[`fetchAll()`](http://www.php.net/manual/en/pdostatement.fetchall.php). `PDO::FETCH_COLUMN`用作如果`$fetch_style`您只想要第一列。例如

```
$rows_affected = $stm->fetchAll(PDO::FETCH_COLUMN, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:50:51.990

如果您使用的是 MySql，则可以使用`rowCount`方法。

或者更好地直接迭代：

```
$stm->execute(array($row1['title']));
$stm->setFetchMode(\PDO::FETCH_ASSOC);
foreach ($stm as $row2) {
    if($row2['id']==$id){
        // do your stuff
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T20:57:41.087

某些数据库可能会返回 SELECT 语句返回的行数。但是，不能保证所有数据库都可以使用此行为，因此不应依赖 . [**手动**](http://php.net/manual/en/pdostatement.rowcount.php)您可以使用`COUNT(*)`and`fetchColumn()`如下查询来模拟`rowCount()`.

```
 $sql2 = "SELECT COUNT(*) FROM page WHERE title=?";
    $stm = $db->prepare($sql2);
    $stm->execute(array($row1['title']));

// Check the number of rows that match the SELECT statement 
if($sql2->fetchColumn() == 0) {
    echo "No records found";//For Testing
 }else{
     $sql3 = "SELECT id,title,pg_title FROM page WHERE title=? ORDER BY id ASC";
     //Etc
} 
```

# sharepoint - 获取用户在 SharePoint 上的上次登录时间？

> ID：16071458
> 
> 赞同：0
> 
> 时间：2013-04-17T22:38:08.563
> 
> 标签：sharepoint, sharepoint-2010

有没有办法检查过去 30 天内哪些用户登录了 sharepoint 站点？最后登录时间是什么时候？

根据我的搜索，我们可以为站点的“文档视图”启用审核，然后查询审核日志。但是，这可能会占用大量资源。

有没有更好的方法直接使用sharepoint powershell而不创建额外的webpart？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T08:52:27.333

据我所知，SharePoint 不存储此内容。我建议您创建一个 HTTPModule 并将所有请求记录在您自己的数据库中。通过这样做，您可以轻松创建所需的所有报告。

编辑：如果是 SharePoint 2010，您可以启用网站使用情况统计。在此之后，您可以访问 SharePoint 数据库并收回您想要的数据。虽然数据不会是最新的，但这是一项填充数据的计时器作业，因此您无法真正知道作业运行后发生了什么。但如果你只想创建一个夜间报告，我想这没关系。

计时器作业是我们必须创建 http 模块以始终拥有正确的实时数据的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T13:20:25.247

正如 Joakim 所说，您可以根据您的要求创建自定义 HttpModule 或查询 WSS_Logging db。然而，还有其他方法。

1.  如果您只需要有关通过浏览器访问的数据，您可以创建委托控制并制作自己的日志。
2.  根据您的身份验证设置，您可以创建处理身份验证事件的代码。
3.  使用第 3 方分析解决方案（Google、Piwik 等）。

# python - 在 python 列表中替换 \x00 的最佳方法？

> ID：16071461
> 
> 赞同：9
> 
> 时间：2013-04-17T22:38:23.820
> 
> 标签：python, regex, replace

我有一个解析后的 PE 文件中的值列表，每个部分的末尾都包含 /x00 空字节。我希望能够从字符串中删除 /x00 字节，而无需从文件中删除所有“x”。我试过做 .replace 和 re.sub，但没有多大成功。

使用 Python 2.6.6

例子。

```
import re

List = [['.text\x00\x00\x00'], ['.data\x00\x00\x00'], ['.rsrc\x00\x00\x00']]

while count < len(List):
    test = re.sub('\\\\x00', '', str(list[count])
    print test
    count += 1

>>>test  (removes x, but I want to keep it) #changed from tet to test
>>>data
>>>rsrc 
```

我想得到以下输出

文本数据 rsrc

关于解决此问题的最佳方法的任何想法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-17T22:40:12.310

```
>>> L = [['.text\x00\x00\x00'], ['.data\x00\x00\x00'], ['.rsrc\x00\x00\x00']]
>>> [[x[0]] for x in L]
[['.text\x00\x00\x00'], ['.data\x00\x00\x00'], ['.rsrc\x00\x00\x00']]
>>> [[x[0].replace('\x00', '')] for x in L]
[['.text'], ['.data'], ['.rsrc']] 
```

或者修改列表而不是创建一个新列表：

```
for x in L:
    x[0] = x[0].replace('\x00', '') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T22:59:06.553

```
lst = (i[0].rstrip('\x00') for i in List)
for j in lst: 
   print j, 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T22:52:59.877

尝试使用 unicode 模式，如下所示：

```
re.sub(u'\x00', '', s) 
```

它应该给出以下结果：

```
l = [['.text\x00\x00\x00'], ['.data\x00\x00\x00'], ['.rsrc\x00\x00\x00']]
for x in l:
    for s in l:
        print re.sub(u'\x00', '', s)
        count += 1

.text
.data
.rsrc 
```

或者，使用列表推导：

```
[[re.sub(u'\x00', '', s) for s in x] for x in l] 
```

实际上，应该在字符串前面没有“u”的情况下工作。只需删除前 3 个斜杠，并将其用作您的正则表达式模式：

```
'\x00' 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T00:55:40.670

您真正想要做的是替换列表中*字符串*`'\x00'`中的字符。

 *为了实现这个目标，人们经常忽略这样一个事实，即在 Python 2 中，非 Unicode 字符串[`translate()`](http://docs.python.org/2/library/stdtypes.html?highlight=translate#str.translate)方法也将可选（或仅）删除 8 位字符，如下所示。（它在 Python 3 中不接受此参数，因为默认情况下字符串是 Unicode 对象。）

您的`List`数据结构似乎有点奇怪，因为它是一个由单个字符串组成的单元素列表的列表。无论如何，在下面的代码中，我已经重命名了它，因为根据[PEP 8 - Python 代码的样式指南，](http://www.python.org/dev/peps/pep-0008/)`sections`大写单词只能用于类的名称。

```
sections = [['.text\x00\x00\x00'], ['.data\x00\x00\x00'], ['.rsrc\x00\x00\x00']]

for section in sections:
    test = section[0].translate(None, '\x00')
    print test 
```

输出：

```
.text
.data
.rsrc 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-08T22:54:30.957

我认为解决此特定问题的更好方法是使用以下功能：

```
import string

for item  in List:
  filter(lambda x: x in string.printable, str(item)) 
```

这不仅会删除 \x00 ，还会删除附加到字符串的任何其他此类十六进制值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T22:43:36.847

```
from itertools import chain

List = [['.text\x00\x00\x00'], ['.data\x00\x00\x00'], ['.rsrc\x00\x00\x00']]    
new_list = [x.replace("\x00", "") for x in chain(*List)]
#['.text', '.data', '.rsrc'] 
```*

# c# - 有条件地使用输出参数创建新集合

> ID：16071463
> 
> 赞同：0
> 
> 时间：2013-04-17T22:38:34.733
> 
> 标签：c#, collections

该程序仅用于说明目的。我想将一个整数作为输入，如果它大于零，则在 ArrayList 中使用该整数创建一个 ArrayList。我尝试了很多（不正确的）方法，最终确定了您在下面看到的内容。但是，我真的不喜欢它的外观。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

    class Program
    {
        static void Main(string[] args)
        {
            Console.Write("Enter in a number of the size of the ArrayList that you want: ");
            int arraySize = int.Parse(Console.ReadLine());
            if (arraySize > 0)
            {
                ArrayList newList = CreateList(arraySize,out newList);
                newList.Add(arraySize);
                Console.WriteLine("the size of the array is {0}",newList.Count);
                Console.ReadLine();
            }
            else
            {
                Console.WriteLine("You did not create an ArrayList");
            }
            Console.WriteLine("here you can't access the array");
            Console.ReadLine();

        }
        public static ArrayList CreateList(int x,out ArrayList outList)
        {
            ArrayList al = new ArrayList(x);
            outList= al;
            return outList;

        }
    } 
```

我的思考过程是，如果用户决定执行某个操作，那么程序将不会创建 ArrayList 来节省资源（考虑到示例的愚蠢示例，我知道）。但是，我仍然必须在 main 方法中初始化一个 ArrayList，如果我取出该行`newList.Add(arraySize)`，如果用户输入一个大于 0 的数字，程序将以 0 的输出运行。有没有什么办法可以让任何输入大于 0 会导致 ArrayList 准备好添加元素？因此，如果我们注释掉该行`newList.Add(arraySize)`，程序仍会将 ArrayList 的大小打印为 1（前提是该数字大于 0）

在此示例中，元素的数量最多为 1，而不是用户可能输入的数量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:53:51.517

一条评论：您不必为函数添加返回类型，试试这个：

```
ArrayList newList =null;
CreateList(arraySize,out newList);

public static void CreateList(int x,out ArrayList outList)
{
   outList = new ArrayList(x);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:04:08.737

这里有很多问题。

首先，您不能*添加*列表的大小。它在构造函数中初始化，然后随着您添加和删除元素而增长和缩小。

所以这一行：

```
newList.Add(arraySize); 
```

具有误导性，几乎可以肯定不是您想要的。您要么想要添加一个元素（在这种情况下，变量名称会产生误导），要么您想要设置数组的大小或容量，在这种情况下，代码没有按照您的意愿行事。

您可能应该知道列表的*大小*和*容量*之间的差异：

*   **大小**是数组中元素的数量。
*   **容量**是列表底层数组的大小，在任何时间点都将等于或大于列表的*大小。*

**这就是为什么当您将列表初始化为其他值时对*Count的调用返回 0 的原因。**计数*是指列表中的项目数，而不是内部数组的长度。您想改为调用*容量*属性：**

```
Console.WriteLine("the size of the array is {0}", newList.Capacity); 
```

列表（*ArrayList*和*List*）在内部使用数组，它们的大小是固定的。所以容量是指该数组的长度。当你将一个新元素添加到一个数组已满的列表中时，该列表的*Add*方法会创建一个新数组，该数组的长度是旧数组的两倍，将所有元素复制到更大的数组中，并在末尾附加新值，并丢弃旧数组。

简而言之，功能：

```
public static ArrayList CreateList(int x,out ArrayList outList) {
    ArrayList al = new ArrayList(x);
    outList= al;
    return outList;
} 
```

大部分都可以，虽然有点多余，因为它应该使用 out 参数或返回列表，而不是两者。对于您的情况，我会执行以下操作：

```
public static void CreateList<T>(int capacity, out List<T> list) {
    list = new List<T>(capacity);
} 
```

尽管就目前而言，这是一种毫无意义的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T22:49:56.017

`ArrayList` [构造函数](http://msdn.microsoft.com/en-us/library/aa317761%28v=vs.71%29.aspx)中的int 参数是“初始容量”，这是一个性能特性（在添加项目时列表不会调整大小，直到达到最大容量），因此它不会影响列表的实际大小。如果您想返回一个包含一个项目的列表，请在您的`CreateList`函数中添加该项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T23:05:52.830

因为，从你的解释中很难理解问题是什么，所以我将在黑暗中开枪。这是你所追求的：

```
using System;
using System.Collections;

namespace SO16071463
{
    class Program
    {
        static void Main()
        {
            Console.Write("Enter in a number of the size of the ArrayList that you want: ");
            int arraySize = int.Parse(Console.ReadLine());
            if (arraySize > 0)
            {
                ArrayList newList = new ArrayList { arraySize };
                Console.WriteLine("the size of the array is {0}", newList.Count);
                Console.ReadLine();
            }
            else
            {
                Console.WriteLine("You did not create an ArrayList");
            }
            Console.WriteLine("here you can't access the array");
            Console.ReadLine();
        }
    }
} 
```

# .htaccess - 通过 maindomain.com/addondomainfolder 禁用对插件域的访问

> ID：16071464
> 
> 赞同：3
> 
> 时间：2013-04-17T22:38:36.710
> 
> 标签：.htaccess, subdirectory, addon-domain

我想使用 .htaccess 禁用对我的插件域文件夹的访问，但我似乎无法弄清楚。

我的文件夹结构是这样的：

```
root/maindomain (www.maindomain.com/maindomain)
root/addondomain (www.addondomain.com) 
```

我想通过*www.maindomain.com/addondomain* url 禁用对我的插件域的访问。

我该怎么做？

我在根目录中的 htaccess 文件：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?swen\.me.uk$ [NC]
RewriteRule ^/?creepypastaindex http://www.creepypastaindex.com/ [L,R]

RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?swen.me.uk$
RewriteCond %{REQUEST_URI} !^/swen/
RewriteRule ^(.*)$ /swen/$1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-24T16:16:26.990

这应该做。你必须逃避这两个点。

```
RewriteEngine On
            RewriteCond %{HTTP_HOST} ^(www.)?swen\.me\.uk$ [NC]
            RewriteCond %{REQUEST_URI} ^/creepypastaindex/(.*)$
            RewriteRule ^(.*)$ - [L,R=404] 
```

[资源](https://my.bluehost.com/cgi/help/498)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:52:32.150

尝试将其添加到主域文档根目录中的 htaccess 文件中：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?maindomain\.com$ [NC]
RewriteRule ^/?addondomain - [L,F] 
```

如果您想将其重定向到某处而不是返回 403 禁止，请将最后一行更改为：

```
RewriteRule ^/?addondomain http://www.maindomain.com/ [L,R] 
```

# image - 包含像素和体素的词

> ID：16071467
> 
> 赞同：4
> 
> 时间：2013-04-17T22:38:45.273
> 
> 标签：image, image-processing, video-processing, terminology

有没有一个词可以将像素和体素的概念推广到任何维度？同样，对于超像素/超体素。

引用“超像素或超体素”来表示可以在两者上运行的方法并不是很好。特别是如果我不依赖于维度，它可能是“voxel+time”或“supervoxel+time”等。任何普遍接受的术语？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-03-23T02:45:37.320

Superpixel 在常规使用中已经有了意义，并不是你想要的： [http ://www.csd.uwo.ca/~olga/Projects/superpixels.html](http://www.csd.uwo.ca/~olga/Projects/superpixels.html)

我不想在办公室里使用“n-xel”这个词。我需要为 4D 元素使用一个术语，但它不会是“doxel”——在嘈杂的通信线路上，它听起来太像“voxel”了。“n-xel”并不是一件容易脱口而出的事情，甚至可能会对同事产生一些不幸的喷雾。

如果您不介意将无量纲点与具有空间范围的元素混淆，“4D 点”可以工作。在这种情况下，您可能会将“4D”视为“四个自由度”而不是“四个空间维度”。

“Hypervoxel”并不漂亮，但考虑到我们有立方体和超立方体，它可能会起作用。

我有点喜欢“fourxel”发音为“FORKS-ull”。

消除“图片元素”->“像素”（有些人曾经也称为“像素”）中的“x”，你可能会有“四个D元素”等等：

*   富德尔
*   菲德尔
*   西克德尔
*   ...
*   恩德尔？

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-16T20:09:27.570

下一个维度的正确答案是“doxel”。它出现在关于体素的维基百科文章的最后。谷歌认为它是一种狗和一种药物，但如果你在搜索中包含“4d”，它确实有学术期刊的用途。

至于任意高的维度，似乎除了 n-xel 与 n 是任意数字之外没有共识。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-17T22:44:29.107

看词源：像素=图片元素，体素=体积元素。鉴于图片是 2D 空间而体积是 3D 空间，我认为最好的术语是“空间元素”或“空间元素”。我只是现场编造的。

有趣的是，经过 5 秒的 Google 搜索，维基词典实际上支持这个定义：[http ://en.wiktionary.org/wiki/spaxel](http://en.wiktionary.org/wiki/spaxel)

> 空间和像素的融合，在 2012 年的论文 Spaxels, Pixels in Space: A new mode of spatial display (Horst Hörtner, Matthew Gardiner, Roland Haring, Christopher Lindinger, Florian Berger) 中介绍。

# javascript - 如何让我的菜单扩展所有子项？

> ID：16071471
> 
> 赞同：1
> 
> 时间：2013-04-17T22:39:00.770
> 
> 标签：javascript, jquery, html, css, menu

我有一个列表菜单，其中包含一些 JavaScript 代码，可以使其折叠和展开`.onClick`。

虽然我只能让它显示 1 个项目，因为每次我尝试像`for`循环这样的新解决方案时，或者`case`我无法让它工作。

这是我当前的代码：

```
<ul id="navigation">
    <li class="main"><a>Diagonóstico</a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_di1"> › Grátis (na compra de qualquer serviço) </a></li>
    <li class="main"><a>Hardware</a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ha1"> › Instalação/Configuração de Componentes</a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ha2"> › Instalação/Configuração de Periféricos </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ha3"> › Limpeza interna/externa </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ha4"> › Cooling Pack </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ha5"> › Performance Pack </a></li>
    <li class="main"><a>Software</a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_so1"> › Actualização de Sistema Operativo </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_so2"> › Instalação de Sistema Operativo </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_so3"> › Instalação de Drivers e Aplicações </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_so4"> › Configurações de internet e redes wireless </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_so5"> › Legalize o seu PC </a></li>
    <li class="main"><a>Backup</a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ba1"> › Backup de dados até 4GB </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ba2"> › Backup and Go </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ba3"> › Suportes Danificados </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_ba4"> › Recuperação de dados sem intervenção física </a></li>
    <li class="main"><a>Segurança</a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_se1"> › Remoção de Vírus e Spyware </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_se2"> › Instalação de anti-vírus </a></li>
    <li class="sub"><a href="javascript:void(0);" class="sub_se3"> › Configurações de Controlo Parental </a></li>
</ul> 
```

```
$(function () {
    $("li.sub:not(:first)").hide();
    $("li.main a").click(function () {
        $("li.sub").slideUp("fast");
        $(this).parent("li.main").next("li.sub").slideDown("slow");
    });
}); 
```

这是它的**[jsFiddle](http://jsfiddle.net/fDYMz/2/ "jsFiddle")**。

我正在考虑一个`for`循环，该循环一直贯穿每个子菜单类别，例如：

```
for(var i=1; i<5; i++) {
    $(this).parent("li.main").next("li.sub_ha" + i).slideDown("slow");
} 
```

然后为每个主菜单执行此操作，为每个主菜单提供一个类`menu1,menu2,menu3`等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:41:53.453

这应该这样做：

```
$(this).parent().parent().find("li.sub").slideDown("slow"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:55:57.327

`next`只选择被选元素的下一个兄弟，可以使用`nextUntil`mehod.

```
$(this).parent().nextUntil("li.main").slideDown("slow"); 
```

[http://jsfiddle.net/ruf6z/](http://jsfiddle.net/ruf6z/)

```
$(function() {
    var $subitems = $("li.sub");
    $subitems.not(':first').hide();

    $("li.main a").click(function() {
        var $targets = $(this).parent().nextUntil("li.main").slideDown("slow");
        $subitems.not($targets).slideUp("fast");
    });
}); 
```

[http://jsfiddle.net/ruf6z/1/](http://jsfiddle.net/ruf6z/1/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T22:56:01.603

在语义上这样做会更好。如果你想说课程，我建议给每组孩子自己的班级。您可以搜索子项的类，然后使用该类查找子组中的所有内容，然后`.slideDown()`在该组上运行该方法。

我制作了[你的小提琴的修改版本](http://jsfiddle.net/fDYMz/4/)，展示了如何做到这一点。

# angularjs - 同一文件系统上的两个单独的 angularJS 应用程序

> ID：16071474
> 
> 赞同：0
> 
> 时间：2013-04-17T22:39:11.730
> 
> 标签：angularjs, routing, directory-structure

我的路线看起来像这样：

```
/create-company/index.html#/part-one
/dashboard/index.html#/view1
/auth/ 
```

现在`create-company`最初使用该应用程序，然后使用分支`dashboard`应用程序。

目前我使用种子项目`app, config, logs, scripts & test folders`在我的主目录中为一个应用程序制作。

要添加第二个应用程序，我应该创建两个`app1 & app2`各自包含自己的文件夹`app, config, logs, scripts & test folders`吗？

然后我可以`/dashboard/`指向并`/app1/app`指向`/create-company/``/app2/app`

还是坚持使用单个 angularJS 应用程序并`/app/`同时指向同一个文件夹会更好吗？`/create-company/``/dashboard/``/app/`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:54:29.470

尽管在某些用例中，拥有多个完全分离的应用程序会有所帮助和/或适当，但根据您的描述，您描述的两个“应用程序”似乎是一个较大应用程序的不同子部分。

考虑在您的使用中，是否有任何重叠的组件，例如共享指令、模板或服务？如果是这样，最好避免重复。

此外，在两个不同的页面上加载相同的应用程序没有限制，使用不同的标记 - 控制器等，这将导致完全不同的功能。

例如，以下内容在不同页面上非常好：

```
<body>
    <div ng-app="my-app">
        <div ng-controller="createCompany">
            <!-- Section specific content here, directives etc -->
        </div>
    </div>
</body>

<body>
    <div ng-app="my-app">
        <div ng-controller="dashboard">
            <!-- Section specific content here, directives etc -->
        </div>
    </div>
</body> 
```

# matlab - 在矩阵中查找索引位置

> ID：16071481
> 
> 赞同：2
> 
> 时间：2013-04-17T22:40:01.987
> 
> 标签：matlab, search, matrix

在这个例子中，我有一个矩阵 (a)

```
a = 1       2       3       7
    0.9     0.6     0.2    0.2
    0.8     17      72     15 
```

我的目标是搜索矩阵 a 并找到不 >= 72 的最大值的索引位置。该矩阵仅用于说明，但我想知道如何对任何维度的矩阵执行此操作，其中行和列相等（2x2 3x3 4x4 ...）

在这种情况下，我想计算约束内的最高数字是

行 = 3 列 = 2

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T22:56:01.837

第 1 步：确定您感兴趣的值。

```
val = max(a(a<72)); 
```

步骤2：找到与该值对应的元素的索引：

```
[r,c] = find(a==val,1,'first'); #%only take first element (this can be changed)
#r is the row index, c is the column index 
```

您还可以使用线性索引和`ind2sub`：

```
l = find(a==val); #%this time, find all elements that meet the criteria
[r,c] = ind2sub(size(a),l); 
```

以下是[find](http://www.mathworks.com/help/matlab/ref/find.html)和[ind2sub](http://www.mathworks.com/help/matlab/ref/ind2sub.html)文档的链接。您也不必存储`val`感兴趣的值 ( )，您可以轻松地将其全部放在一行中。

# java - 克隆或不可修改的集合

> ID：16071482
> 
> 赞同：2
> 
> 时间：2013-04-17T22:40:06.180
> 
> 标签：java, clone, immutability, private-members

在我的 Java 大学课程中，我了解了隐私泄露的概念，其中公共 getter 返回对私有可变对象的引用。

他们给出的示例如下：（如果语法不太正确，请原谅我，我正在记忆中工作）

```
private HashSet<*> priv = new HashSet<*>

public Collection<*> getPriv () {
    return this.priv;
} 
```

现在的问题是对象的客户端现在有机会故意或以其他方式破坏私有 HashSet。

在课程中，建议的解决方案是使用以下内容：

```
public Collection<*> getPriv () {
    return Collections.unmodifiableCollection (this.priv);
} 
```

这对我来说似乎是一个很好的解决方案，因为不仅对象的内部状态不受外部修改的影响，任何修改返回的 unmodifiableCollection 的尝试都会触发异常。但是，问题在于它仅适用于集合。似乎没有其他可变 Java 类的等价物。

从那以后，我读过的大多数 Java 书籍都建议以下内容：

```
public Collection<*> getPriv () {
    return this.priv.clone ();
} 
```

这适用于任何可克隆对象，但返回的对象可以修改为客户端对象的内容。对象的内部状态仍然受到保护，但现在如果我尝试修改无法真正修改的数据，我不会得到异常。这意味着我可能会在获取私有集合并对其进行修改时出错，并且对为什么我的更改没有反映在对象中感到困惑，因此我将一类错误（修改私有状态）换成了另一类（修改应该是不可变的克隆）。

是否有一种更通用的方法`return Collections.unmodifiableCollection (this.priv);`可以与任何类（或至少任何满足某些先决条件的类，例如实现可克隆）一起使用，或者是我唯一的选择来实现我可能想要的所有私有类的可变和不可变版本通过吸气剂公开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:57:39.573

恐怕答案是肯定的。

请注意， Collections.unmodifiableCollection 仅返回一个视图。本质上，Collections 包含一个*适配器*类，它接收任何`Collection`并将某些方法调用转发给它。对于“危险”方法，它会引发异常。当然，这依赖于传入的底层集合以理智的方式实现事物。如果`getSize()`改变了对象，那么`getSize()`对适配器的调用仍会将其转发给基础类，然后对其进行修改。

您可以通过限制返回给客户端的不同类（或接口）的数量来减少工作量。您还可以默认使更多类不可变，这是函数式语言中的一种常见范例，它使事情变得更加简单。不幸的是，Java 使处理不可变对象变得不必要地难看。

还有一些可能性，比如自动生成不可变视图，但这很复杂，并且需要您有一种方法来决定无论如何要转发哪些方法。

最后，这些都不能保护您免受`setAccessible`或类似的伤害。但在这种情况下，他们故意违反标准 VM 约束，所以这不是你真正应该担心的事情。如果您担心安全性，无论如何您都需要在 SecurityManager 中运行所有不受信任的代码。

# c# - ServiceStack REST API 设计

> ID：16071484
> 
> 赞同：2
> 
> 时间：2013-04-17T22:40:11.333
> 
> 标签：c#, web-services, rest, servicestack

我开始使用 ServiceStack，到目前为止我很享受它，但我认为我的设计从一开始就有缺陷。本质上，我有一个通过 NHibernate 访问的 MSSQL 数据库。我的困惑是由于我的请求/响应 DTO 和服务应该采用什么结构。

我在 MyProject.Common.Models 下的一个单独项目中有我的 NHibernate 映射，其中包含一个“客户端”类，如下所示：

```
namespace MyProject.Common.Models
{
    public class Client
    {
        public virtual int ClientID { get; set; }
        public virtual string Name { get; set; }
        public virtual string Acronym { get; set; }
        public virtual string Website { get; set; }
    }

    public class ClientMap : ClassMap<Client>
    {   
        public ClientMap()
        {
            Id(x => x.ClientID, "ClientID").GeneratedBy.Identity();

            Map(x => x.Name, "Name");
            Map(x => x.Acronym, "Acronym");
            Map(x => x.Website, "Website");
        }
    }
} 
```

我想为客户端提供对单个客户端进行 CRUD 的能力，以及显示所有客户端的列表。到目前为止，我已经像这样设计了我的单个客户端请求：

```
[Route("/clients/{Id}", "GET")]
public class ClientRequest : IReturn<ClientResponse>
{
    public string Id { get; set; }
}

public class ClientResponse : IHasResponseStatus
{
    public MyProject.Common.Models.Client Client { get; set; }
    public ResponseStatus ResponseStatus { get; set; }

    public ClientResponse()
    {
        this.ResponseStatus = new ResponseStatus();
    }
} 
```

如您所见，这只是将我的模型类返回给客户端。使用这种设计，我完全不知道如何正确发布新客户端或更新现有客户端。此外，如果我想返回所有客户端的列表，我目前正在使用以下请求/响应 DTO：

```
[Route("/clients", "GET")]
public class ClientsRequest : IReturn<ClientsResponse>
{

}
public class ClientsResponse : IHasResponseStatus
{
    public List<MyProject.Common.Models.Client> Clients { get; set; }
    public ResponseStatus ResponseStatus { get; set; }

    public ClientsResponse()
    {
        this.ResponseStatus = new ResponseStatus();
    }
} 
```

使用这样的服务：

```
public ClientsResponse Get(ClientsRequest request)
{
    var result = currentSession.Query<Chronologic.Eve.Common.Models.Client>().ToList();

    if (result == null)
        throw new HttpError(HttpStatusCode.NotFound, new ArgumentException("No clients exist"));

    return new ClientsResponse
    {
        Clients = result
    };
} 
```

哪个有效，尽管我觉得这也不是实现我想要做的事情的最佳方式，并且给了我一个丑陋的元数据页面，如下所示：

![丑陋的 ServiceStack 元数据](https://i.stack.imgur.com/ceCtK.png)

我觉得我忽略了这个设计非常简单，如果有人可以向我建议如何简化设计，我将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T23:13:47.487

您应该查看这些有助于使用 ServiceStack 进行 API 设计的早期文章：

*   [使用 ServiceStack 设计 REST API](https://stackoverflow.com/a/15235822/85785)
*   [如何设计基于消息的 API](https://stackoverflow.com/a/15941229/85785)
*   [DTO 的重要性](https://stackoverflow.com/a/15369736/85785)

而不是重新散列上面包含的任何内容，我只是重写它我会怎么做。

您不需要`ResponseStatus`属性，因此您的服务可以返回干净的 DTO。

```
[Route("/clients", "GET")]
public class AllClients : IReturn<List<Client>> {}

[Route("/clients/{Id}", "GET")]
public class GetClient : IReturn<Client>
{
    public string Id { get; set; }
} 
```

服务实现应该基于上述请求 DTO 直接进行。

使用上面的 API，您的 C# 客户端调用站点现在看起来像：

```
List<Client> clients = service.Get(new AllClients());

Client client = service.Get(new GetClient { Id = id }); 
```

# python - numpy fromfile(count = -1) 在 Mac OS 上为大文件返回零数组

> ID：16071486
> 
> 赞同：13
> 
> 时间：2013-04-17T22:40:18.143
> 
> 标签：python, arrays, python-2.7, numpy

我正在使用 numpy.fromfile 读取文件：

```
mat1=numpy.fromfile("path/to/file", numpy.uint8, 40000, "") 
```

这会按我的预期读取文件。

但是当我阅读整个文件时：

```
mat1=numpy.fromfile("path/to/file", numpy.uint8, -1, "") 
```

这给了我一个零数组。`[0,0,0,...,0,0,0]`

我累了： `numpy.count_nonzeros(mat1)`这给了 0

`size(mat1)`以字节为单位给出文件的确切大小。所以它制作了一个预期大小的数组，但它充满了零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-29T15:25:11.587

OS X 升级显然缓解了这种情况。@MichaelJCox 指出的[原始问题已关闭，但从未应用补丁：](https://github.com/numpy/numpy/pull/2931)

> 关闭。修复是升级到小牛队。

# android - Android：在活动之间保持远程服务器上的会话活动

> ID：16071487
> 
> 赞同：1
> 
> 时间：2013-04-17T22:40:26.693
> 
> 标签：android, session

我在 iOS 中构建了另一个应用程序，当用户登录该应用程序时，服务器将他们登录到该会话中。在 iOS 应用程序中，只要正常会话和来自应用程序的所有请求看到该人仍然登录，会话就会保持活动状态。

我认为这与 Android 应用程序相同，但登录后我切换到下一个活动，然后向服务器发送请求以填充页面。我回来的结果是说用户没有登录。

这里有什么我不明白的区别是不是让我的服务器上的会话保持活动状态？

我有一个我的所有活动都扩展的基类，在基类中我有这个受保护的类。我用它来发送所有请求。

```
protected class API extends AsyncTask <Void, Void, String>
{
    public String RequestName;
    public String RequestType;
    public String RequestUrl;
    public List<NameValuePair> RequestParameters;

    public API(String Name, String Type, String Url, List<NameValuePair> params)
    {
        RequestName = Name;
        RequestType = Type;
        RequestUrl = Url;
        RequestParameters = params;
    }

    protected String getASCIIContentFromEntity(HttpEntity entity) throws IllegalStateException, IOException 
    {
        InputStream in = entity.getContent();
        StringBuffer out = new StringBuffer();
        int n = 1;
        while (n>0) 
        {
            byte[] b = new byte[4096];
            n =  in.read(b);
            if (n>0) 
                out.append(new String(b, 0, n));
        }
        return out.toString();
    }

    @Override
    protected String doInBackground(Void... params) 
    {

        HttpClient httpClient = new DefaultHttpClient();
        HttpContext localContext = new BasicHttpContext();

        String text = null;

        if(RequestType == "post")
        {
            HttpPost p = new HttpPost("http://www.ehrx.com/api/" + RequestUrl);

            try 
            {
                p.setEntity(new UrlEncodedFormEntity(RequestParameters));
                HttpResponse response = httpClient.execute(p, localContext);
                HttpEntity entity = response.getEntity();
                text = getASCIIContentFromEntity(entity);
            } 
            catch (Exception e) 
            {
                return e.getLocalizedMessage();
            }
        }
        else
        {
            HttpGet httpGet = new HttpGet("http://www.ehrx.com/api/" + RequestUrl);

            try 
            {
                HttpResponse response = httpClient.execute(httpGet, localContext);
                HttpEntity entity = response.getEntity();
                text = getASCIIContentFromEntity(entity);
            } 
            catch (Exception e) 
            {
                return e.getLocalizedMessage();
            }
        }

        return text;
    }

    protected void onPostExecute(String results) 
    {
        HandleResult(results, RequestName);

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T22:59:38.583

我猜会话在服务器上仍然存在，但是您在 android 应用程序中丢失了会话 cookie。看起来您正在为每个请求创建一个新客户端和一个新上下文。您需要为上下文设置 cookie 存储，以便它可以使用您之前已验证的请求中的会话 cookie。[如何在 Android 和/或 Java 中使用 HttpClient 管理 cookie](https://stackoverflow.com/questions/3587254/how-do-i-manage-cookies-with-httpclient-in-android-and-or-java)的答案？应该给你更多的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T23:48:02.530

这可以使用单例类轻松解决（您应该在所有 http 请求中使用相同的 HTTP 客户端）。

# spring - 打开/关闭 JMS 侦听器会导致侦听器挂起

> ID：16071489
> 
> 赞同：2
> 
> 时间：2013-04-17T22:40:33.190
> 
> 标签：spring, jms, listener, freeze

我们有一个监听 JMS 队列（WebSphere 7）的 Spring 项目（3.0.5）。我们需要能够打开/关闭队列监听器。我们目前正在通过我们自己的 RESTful 端点以编程方式调用 DefaultMessageListenerContainer.start() 和 stop() 来打开/关闭监听器。

我们观察到，在两次或三次（开/关/开或开/关/开/关/开）切换侦听器后，侦听器进入挂起状态，我们无法将其关闭。

为了调试正在发生的事情，我们将日志级别设置为 Trace。成功打开侦听器后，我们会在日志中看到以下消息：

XXXX-XX-XX [myListenerContainer-1] TRACE cgcrcmMessageListenerContainer - doReceiveAndExecute - 会话 [com.ibm.mq.jms.MQQueueSession@1872c950] 的使用者 [com.ibm.mq.jms.MQQueueReceiver@45486b51] 未收到消息

但是，我们最后一次在监听器挂起之前打开它，我们在日志中没有看到这条消息。

额外细节：

*   无论消息是否进入队列，都可以重现挂起状态。
*   上次我们在监听器挂起之前打开它，我们可以通过将消息放入队列来“纠正”挂起状态。收到消息后，我们会在日志中看到运行状况良好的跟踪消息，并且可以关闭侦听器。

# qsub - 使用 qsub 静默向 SGE 提交作业

> ID：16071493
> 
> 赞同：0
> 
> 时间：2013-04-17T22:40:47.993
> 
> 标签：qsub, sungridengine

我有一个 bash 脚本，它使用一个缓慢响应的 SGE 队列提交数百个作业`qsub`（每个作业 ID 需要一秒钟才能显示出来）。

为了绕过这个耗时的过程并且在我退出 shell 时不杀死我的脚本，我通过附加`&`. 虽然这有时可以为我节省半个小时，但作业 ID 仍然会出现并与命令提示符混淆。

我想知道是否可以禁止显示作业 ID 或以某种方式将作业静默提交到队列。虽然，这个[链接](http://www.vub.ac.be/BFUCC/LSF/man/qsub.1.html)谈到了一个`-z`论点，但它不起作用，`qsub`手册页上也没有提到它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:43:14.560

更好的解决方案：而不是使用 '&' 使用 gnu screen 创建会话，提交您的工作并离开会话：[http](http://www.gnu.org/software/screen/) ://www.gnu.org/software/screen/ 。

> 然后，您可以随时创建新的（全屏）窗口，其中包含其他程序（包括更多的 shell），杀死当前窗口，查看活动窗口列表，打开和关闭输出日志，复制文本窗口，查看回滚历史，在窗口之间切换等。所有窗口完全独立地运行它们的程序。当程序的窗口当前不可见时，即使整个屏幕会话与用户终端分离，程序也会继续运行。

# android - Proguard 混淆了合并库清单中的 Activity 名称

> ID：16071498
> 
> 赞同：6
> 
> 时间：2013-04-17T22:41:08.520
> 
> 标签：android, proguard

我有几个使用公共库项目的应用程序项目。`manifestmerger.enabled=true`我最近尝试将每个应用程序项目的 AndroidManifest.xml 中的一些常见 Activity 声明移动到库的清单中，并启用清单与in合并`project.properties`。

在调试版本中一切正常，但发布版本（由 Proguard 混淆）失败并显示`ActivityNotFoundException`. 这是因为 Proguard 混淆了在库清单中声明的​​活动名称，而不是在应用程序清单中声明的​​活动名称。

我检查了`bin/AndroidManifest.xml`应用程序项目的合并文件，它正确地列出了活动名称。

有人可以建议一个解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T00:49:30.653

标准的 Ant 构建过程调用 aapt 工具来创建一个 ProGuard 配置 (bin/proguard.txt)，该配置保留了必要的类（例如，它认为使用的所有活动）。如果这对您的项目结构不起作用（可能是错误或不受支持的情况），您可以自己在 proguard-project.txt 中保留这些类：

```
-keep public class * extends android.app.Activity
-keep public class * extends android.app.Application
-keep public class * extends android.app.Service
-keep public class * extends android.content.BroadcastReceiver
-keep public class * extends android.content.ContentProvider 
```

如果生成的应用程序仍然缺少其他类，您可以在 ProGuard 手册 > 示例 >[完整的 Android 应用程序](http://proguard.sourceforge.net/manual/examples.html#androidapplication)中找到更多手动配置。

# java - 单击中性按钮后是否可以保持对话框打开？

> ID：16071500
> 
> 赞同：0
> 
> 时间：2013-04-17T22:41:26.117
> 
> 标签：java, android, dialog

我有一个包含 3 个 EditText 的对话框，用于获取 ftp 地址、用户名和密码。我使用 .setNeutralButton 创建了一个“测试连接”按钮。我让它连接到 ftp 并显示一个带有结果的 Toast，但我不希望测试按钮关闭对话框。如何在连接测试期间保持对话框打开？

```
livePreviewChk.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        LinearLayout lila1 = new LinearLayout(NewSite.this);
        lila1.setOrientation(1); // 1 is for vertical orientation

        final EditText serverName = new EditText(NewSite.this);
        serverName.setHint("Server name");

        final EditText serverAddress = new EditText(NewSite.this);
        serverAddress.setHint("Server Address");

        final EditText username = new EditText(NewSite.this);
        username.setHint("Username:");

        final EditText password = new EditText(NewSite.this);
        password.setHint("Password");

        AlertDialog.Builder alt_bld = new AlertDialog.Builder(
                NewSite.this);
        alt_bld.setIcon(R.drawable.ftpicon);
        alt_bld.setTitle("Enter the login details for the host FTP")
                .setCancelable(true)
                .setPositiveButton("Save",
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                }
                            }
                        })
                .setNeutralButton("Test Connection",
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                FTPConnector testConnection = new FTPConnector();
                                boolean status = testConnection
                                        .ftpConnect(host, user, pass,
                                                port);
                                if (status == true) {
                                    connectionSuccessfull = true;
                                } else {
                                    connectionSuccessfull = false;
                                }
                            }
                        })
                .setNegativeButton("Cancel",
                        new DialogInterface.OnClickListener() {
                            public void onClick(DialogInterface dialog,
                                    int id) {
                                // if this button is clicked, just close
                                // the dialog box and do nothing
                                dialog.cancel();
                            }
                        });

        lila1.addView(serverName);
        lila1.addView(serverAddress);
        lila1.addView(username);
        lila1.addView(password);

        AlertDialog alert = alt_bld.create();
        alert.setView(lila1);
        alert.show();
    }
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:56:18.033

据我所知，不扩展课程是不可能的`Dialog`。但是，使用您拥有的功能，将其单独放入`Activity`并使用`Dialog theme`. 您所要做的就是将您的代码放入一个新`Activity`的，并在您`manifest`使用`dialog theme`

```
<activity
        android:name="com.your.package.YourClassName"
        android:label="YOurLabel"
        android:theme="@android:style/Theme.Dialog" >
</activity> 
```

这将给人一种`Dialog`被包含在其自身中的外观和感觉`Activity`

这是[关于扩展 Dialog 的 SO 答案](https://stackoverflow.com/questions/2620444/how-to-prevent-a-dialog-from-closing-when-a-button-is-clicked/9523257#9523257)。我还没有看透这一切，但看起来如果你选择这个选项，它可能会给你你需要的东西。

# objective-c - 如何判断 UITableView 何时完成 ReloadData？

> ID：16071503
> 
> 赞同：208
> 
> 时间：2013-04-17T22:41:34.417
> 
> 标签：objective-c, uitableview, reloaddata

我正在尝试在 UITableView 完成执行后滚动到它的底部`[self.tableView reloadData]`

我原本有

```
 [self.tableView reloadData]
 NSIndexPath* indexPath = [NSIndexPath indexPathForRow: ([self.tableView numberOfRowsInSection:([self.tableView numberOfSections]-1)]-1) inSection: ([self.tableView numberOfSections]-1)];

[self.tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionBottom animated:YES]; 
```

但后来我读到 reloadData 是异步的，所以滚动不会发生，因为`self.tableView`,`[self.tableView numberOfSections]`并且`[self.tableView numberOfRowsinSection`都是 0。

谢谢！

奇怪的是我正在使用：

```
[self.tableView reloadData];
NSLog(@"Number of Sections %d", [self.tableView numberOfSections]);
NSLog(@"Number of Rows %d", [self.tableView numberOfRowsInSection:([self.tableView numberOfSections]-1)]-1); 
```

在控制台中它返回 Sections = 1, Row = -1;

当我在中执行完全相同的 NSLogs 时，`cellForRowAtIndexPath`我得到 Sections = 1 和 Row = 8; （8 对）

* * *

## 回答 #1

> 赞同：305
> 
> 时间：2013-04-17T22:49:48.343

重新加载发生在下一次布局传递期间，这通常发生在您将控制权返回到运行循环时（例如，在您的按钮操作或任何返回之后）。

因此，在表视图重新加载后运行某些东西的一种方法是简单地强制表视图立即执行布局：

```
[self.tableView reloadData];
[self.tableView layoutIfNeeded];
 NSIndexPath* indexPath = [NSIndexPath indexPathForRow: ([self.tableView numberOfRowsInSection:([self.tableView numberOfSections]-1)]-1) inSection: ([self.tableView numberOfSections]-1)];
[self.tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionBottom animated:YES]; 
```

另一种方法是安排您的布局后代码稍后运行`dispatch_async`：

```
[self.tableView reloadData];

dispatch_async(dispatch_get_main_queue(), ^{
     NSIndexPath* indexPath = [NSIndexPath indexPathForRow: ([self.tableView numberOfRowsInSection:([self.tableView numberOfSections]-1)]-1) inSection:([self.tableView numberOfSections]-1)];

    [self.tableView scrollToRowAtIndexPath:indexPath atScrollPosition:UITableViewScrollPositionBottom animated:YES];
}); 
```

### 更新

`tableView:numberOfSections:`经过进一步调查，我发现表视图`tableView:numberOfRowsInSection:`在从`reloadData`. 如果委托实现`tableView:heightForRowAtIndexPath:`，则表视图也会在从`reloadData`.

但是，表格视图不会发送`tableView:cellForRowAtIndexPath:`或`tableView:headerViewForSection`直到布局阶段，当您将控制权返回给运行循环时，默认情况下会发生这种情况。

我还发现在一个小型测试程序中，您问题中的代码可以正确滚动到表格视图的底部，**而无需**我做任何特别的事情（例如发送`layoutIfNeeded`或使用`dispatch_async`）。

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2013-09-15T13:17:08.833

**迅速：**

```
extension UITableView {
    func reloadData(completion:@escaping ()->()) {
        UIView.animate(withDuration: 0, animations: reloadData)
            { _ in completion() }
    } 
}

// ...somewhere later...

tableView.reloadData {
    print("done")
} 
```

**目标-C：**

```
[UIView animateWithDuration:0 animations:^{
    [myTableView reloadData];
} completion:^(BOOL finished) {
    //Do something after that...
}]; 
```

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2017-04-01T21:29:48.510

从 Xcode 8.2.1、iOS 10 和 swift 3 开始，

`tableView.reloadData()`您可以使用 CATransaction 块轻松确定结束：

```
CATransaction.begin()
CATransaction.setCompletionBlock({
    print("reload completed")
    //Your completion code here
})
print("reloading")
tableView.reloadData()
CATransaction.commit() 
```

以上也适用于确定 UICollectionView 的 reloadData() 和 UIPickerView 的 reloadAllComponents() 的结束。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2016-09-22T20:49:20.610

上述`dispatch_async(dispatch_get_main_queue())`方法**不保证有效**。我看到它的非确定性行为，有时系统在完成块之前完成了 layoutSubviews 和单元格渲染，有时在完成块之后。

这是一个在 iOS 10 上对我来说 100% 有效的解决方案。它需要能够将 UITableView 或 UICollectionView 实例化为自定义子类。这是 UICollectionView 的解决方案，但对于 UITableView 来说完全一样：

CustomCollectionView.h：

```
#import <UIKit/UIKit.h>

@interface CustomCollectionView: UICollectionView

- (void)reloadDataWithCompletion:(void (^)(void))completionBlock;

@end 
```

CustomCollectionView.m：

```
#import "CustomCollectionView.h"

@interface CustomCollectionView ()

@property (nonatomic, copy) void (^reloadDataCompletionBlock)(void);

@end

@implementation CustomCollectionView

- (void)reloadDataWithCompletion:(void (^)(void))completionBlock
{
    self.reloadDataCompletionBlock = completionBlock;
    [self reloadData];
}

- (void)layoutSubviews
{
    [super layoutSubviews];

    if (self.reloadDataCompletionBlock) {
        self.reloadDataCompletionBlock();
        self.reloadDataCompletionBlock = nil;
    }
}

@end 
```

示例用法：

```
[self.collectionView reloadDataWithCompletion:^{
    // reloadData is guaranteed to have completed
}]; 
```

有关此答案的 Swift 版本，请参见[此处](https://stackoverflow.com/a/39798079)

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2016-09-30T18:40:55.337

我和 Tyler Sheaffer 有同样的问题。

我用 Swift实现[了他的解决方案，它解决了我的问题。](https://stackoverflow.com/a/39648633/789447)

**斯威夫特 3.0：**

```
final class UITableViewWithReloadCompletion: UITableView {
  private var reloadDataCompletionBlock: (() -> Void)?

  override func layoutSubviews() {
    super.layoutSubviews()

    reloadDataCompletionBlock?()
    reloadDataCompletionBlock = nil
  }

  func reloadDataWithCompletion(completion: @escaping () -> Void) {
    reloadDataCompletionBlock = completion
    self.reloadData()
  }
} 
```

**斯威夫特 2：**

```
class UITableViewWithReloadCompletion: UITableView {

  var reloadDataCompletionBlock: (() -> Void)?

  override func layoutSubviews() {
    super.layoutSubviews()

    self.reloadDataCompletionBlock?()
    self.reloadDataCompletionBlock = nil
  }

  func reloadDataWithCompletion(completion:() -> Void) {
      reloadDataCompletionBlock = completion
      self.reloadData()
  }
} 
```

示例用法：

```
tableView.reloadDataWithCompletion() {
 // reloadData is guaranteed to have completed
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-11-13T02:29:03.903

还有一个`UICollectionView`版本，基于 kolaworld 的回答：

[https://stackoverflow.com/a/43162226/1452758](https://stackoverflow.com/a/43162226/1452758)

需要测试。目前在 iOS 9.2、Xcode 9.2 beta 2 上工作，将 collectionView 滚动到索引，作为闭包。

```
extension UICollectionView
{
    /// Calls reloadsData() on self, and ensures that the given closure is
    /// called after reloadData() has been completed.
    ///
    /// Discussion: reloadData() appears to be asynchronous. i.e. the
    /// reloading actually happens during the next layout pass. So, doing
    /// things like scrolling the collectionView immediately after a
    /// call to reloadData() can cause trouble.
    ///
    /// This method uses CATransaction to schedule the closure.

    func reloadDataThenPerform(_ closure: @escaping (() -> Void))
    {       
        CATransaction.begin()
            CATransaction.setCompletionBlock(closure)
            self.reloadData()
        CATransaction.commit()
    }
} 
```

**用法：**

```
myCollectionView.reloadDataThenPerform {
    myCollectionView.scrollToItem(at: indexPath,
            at: .centeredVertically,
            animated: true)
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-04-17T23:40:10.007

看来人们仍在阅读这个问题和答案。其中的 B/c，我正在编辑我的答案以删除与此无关的*Synchronous一词。*

`When [tableView reloadData]`返回，tableView 背后的内部数据结构已经更新。因此，当该方法完成时，您可以安全地滚动到底部。我在自己的应用程序中验证了这一点。@rob-mayoff 被广泛接受的答案，虽然在术语上也令人困惑，但在他的最后一次更新中也承认了这一点。

如果您`tableView`没有滚动到底部，则您未发布的其他代码可能存在问题。也许您在滚动完成后更改数据并且您没有重新加载和/或滚动到底部？

如下添加一些日志来验证表数据是否正确`reloadData`。我在示例应用程序中有以下代码，它运行良好。

```
// change the data source

NSLog(@"Before reload / sections = %d, last row = %d",
      [self.tableView numberOfSections],
      [self.tableView numberOfRowsInSection:[self.tableView numberOfSections]-1]);

[self.tableView reloadData];

NSLog(@"After reload / sections = %d, last row = %d",
      [self.tableView numberOfSections],
      [self.tableView numberOfRowsInSection:[self.tableView numberOfSections]-1]);

[self.tableView scrollToRowAtIndexPath:[NSIndexPath indexPathForRow:[self.tableView numberOfRowsInSection:[self.tableView numberOfSections]-1]-1
                                                          inSection:[self.tableView numberOfSections] - 1]
                      atScrollPosition:UITableViewScrollPositionBottom
                              animated:YES]; 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2016-10-18T18:17:03.933

我使用这个技巧，很确定我已经将它发布到这个问题的副本：

```
-(void)tableViewDidLoadRows:(UITableView *)tableView{
    // do something after loading, e.g. select a cell.
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // trick to detect when table view has finished loading.
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(tableViewDidLoadRows:) object:tableView];
    [self performSelector:@selector(tableViewDidLoadRows:) withObject:tableView afterDelay:0];

    // specific to your controller
    return self.objects.count;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-06-02T13:20:12.457

其实这个解决了我的问题：

```
-(void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {

NSSet *visibleSections = [NSSet setWithArray:[[tableView indexPathsForVisibleRows] valueForKey:@"section"]];
if (visibleSections) {
    // hide the activityIndicator/Loader
}} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-10-02T15:14:33.873

试试这个方法会奏效

```
[tblViewTerms performSelectorOnMainThread:@selector(dataLoadDoneWithLastTermIndex:) withObject:lastTermIndex waitUntilDone:YES];waitUntilDone:YES];

@interface UITableView (TableViewCompletion)

-(void)dataLoadDoneWithLastTermIndex:(NSNumber*)lastTermIndex;

@end

@implementation UITableView(TableViewCompletion)

-(void)dataLoadDoneWithLastTermIndex:(NSNumber*)lastTermIndex
{
    NSLog(@"dataLoadDone");

NSIndexPath* indexPath = [NSIndexPath indexPathForRow: [lastTermIndex integerValue] inSection: 0];

[self selectRowAtIndexPath:indexPath animated:YES scrollPosition:UITableViewScrollPositionNone];

}
@end 
```

我将在表完全加载时执行

其他解决方案是你可以继承 UITableView

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-04-08T18:58:53.540

我最终使用了 Shawn 解决方案的变体：

使用委托创建自定义 UITableView 类：

```
protocol CustomTableViewDelegate {
    func CustomTableViewDidLayoutSubviews()
}

class CustomTableView: UITableView {

    var customDelegate: CustomTableViewDelegate?

    override func layoutSubviews() {
        super.layoutSubviews()
        self.customDelegate?.CustomTableViewDidLayoutSubviews()
    }
} 
```

然后在我的代码中，我使用

```
class SomeClass: UIViewController, CustomTableViewDelegate {

    @IBOutlet weak var myTableView: CustomTableView!

    override func viewDidLoad() {
        super.viewDidLoad()

        self.myTableView.customDelegate = self
    }

    func CustomTableViewDidLayoutSubviews() {
        print("didlayoutsubviews")
        // DO other cool things here!!
    }
} 
```

还要确保在界面构建器中将表格视图设置为 CustomTableView：

[![在此处输入图像描述](https://i.stack.imgur.com/S3IG5.png)](https://i.stack.imgur.com/S3IG5.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-28T19:40:53.987

## 细节

*   Xcode 版本 10.2.1 (10E1001)，Swift 5

## 解决方案

```
import UIKit

// MARK: - UITableView reloading functions

protocol ReloadCompletable: class { func reloadData() }

extension ReloadCompletable {
    func run(transaction closure: (() -> Void)?, completion: (() -> Void)?) {
        guard let closure = closure else { return }
        CATransaction.begin()
        CATransaction.setCompletionBlock(completion)
        closure()
        CATransaction.commit()
    }

    func run(transaction closure: (() -> Void)?, completion: ((Self) -> Void)?) {
        run(transaction: closure) { [weak self] in
            guard let self = self else { return }
            completion?(self)
        }
    }

    func reloadData(completion closure: ((Self) -> Void)?) {
        run(transaction: { [weak self] in self?.reloadData() }, completion: closure)
    }
}

// MARK: - UITableView reloading functions

extension ReloadCompletable where Self: UITableView {
    func reloadRows(at indexPaths: [IndexPath], with animation: UITableView.RowAnimation, completion closure: ((Self) -> Void)?) {
        run(transaction: { [weak self] in self?.reloadRows(at: indexPaths, with: animation) }, completion: closure)
    }

    func reloadSections(_ sections: IndexSet, with animation: UITableView.RowAnimation, completion closure: ((Self) -> Void)?) {
        run(transaction: { [weak self] in self?.reloadSections(sections, with: animation) }, completion: closure)
    }
}

// MARK: - UICollectionView reloading functions

extension ReloadCompletable where Self: UICollectionView {

    func reloadSections(_ sections: IndexSet, completion closure: ((Self) -> Void)?) {
        run(transaction: { [weak self] in self?.reloadSections(sections) }, completion: closure)
    }

    func reloadItems(at indexPaths: [IndexPath], completion closure: ((Self) -> Void)?) {
        run(transaction: { [weak self] in self?.reloadItems(at: indexPaths) }, completion: closure)
    }
} 
```

## 用法

> UITableView

```
// Activate
extension UITableView: ReloadCompletable { }

// ......
let tableView = UICollectionView()

// reload data
tableView.reloadData { tableView in print(collectionView) }

// or
tableView.reloadRows(at: indexPathsToReload, with: rowAnimation) { tableView in print(tableView) }

// or
tableView.reloadSections(IndexSet(integer: 0), with: rowAnimation) { _tableView in print(tableView) } 
```

> UICollectionView

```
// Activate
extension UICollectionView: ReloadCompletable { }

// ......
let collectionView = UICollectionView()

// reload data
collectionView.reloadData { collectionView in print(collectionView) }

// or
collectionView.reloadItems(at: indexPathsToReload) { collectionView in print(collectionView) }

// or
collectionView.reloadSections(IndexSet(integer: 0)) { collectionView in print(collectionView) } 
```

## 完整样本

> 不要忘记在**此处添加解决方案代码**

```
import UIKit

class ViewController: UIViewController {

    private weak var navigationBar: UINavigationBar?
    private weak var tableView: UITableView?

    override func viewDidLoad() {
        super.viewDidLoad()
        setupNavigationItem()
        setupTableView()
    }
}
// MARK: - Activate UITableView reloadData with completion functions

extension UITableView: ReloadCompletable { }

// MARK: - Setup(init) subviews

extension ViewController {

    private func setupTableView() {
        guard let navigationBar = navigationBar else { return }
        let tableView = UITableView()
        view.addSubview(tableView)
        tableView.translatesAutoresizingMaskIntoConstraints = false
        tableView.topAnchor.constraint(equalTo: navigationBar.bottomAnchor).isActive = true
        tableView.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = true
        tableView.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = true
        tableView.bottomAnchor.constraint(equalTo: view.bottomAnchor).isActive = true
        tableView.dataSource = self
        self.tableView = tableView
    }

    private func setupNavigationItem() {
        let navigationBar = UINavigationBar()
        view.addSubview(navigationBar)
        self.navigationBar = navigationBar
        navigationBar.translatesAutoresizingMaskIntoConstraints = false
        navigationBar.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor).isActive = true
        navigationBar.leftAnchor.constraint(equalTo: view.leftAnchor).isActive = true
        navigationBar.rightAnchor.constraint(equalTo: view.rightAnchor).isActive = true
        let navigationItem = UINavigationItem()
        navigationItem.rightBarButtonItem = UIBarButtonItem(title: "all", style: .plain, target: self, action: #selector(reloadAllCellsButtonTouchedUpInside(source:)))
        let buttons: [UIBarButtonItem] = [
                                            .init(title: "row", style: .plain, target: self,
                                                  action: #selector(reloadRowButtonTouchedUpInside(source:))),
                                            .init(title: "section", style: .plain, target: self,
                                                  action: #selector(reloadSectionButtonTouchedUpInside(source:)))
                                            ]
        navigationItem.leftBarButtonItems = buttons
        navigationBar.items = [navigationItem]
    }
}

// MARK: - Buttons actions

extension ViewController {

    @objc func reloadAllCellsButtonTouchedUpInside(source: UIBarButtonItem) {
        let elementsName = "Data"
        print("-- Reloading \(elementsName) started")
        tableView?.reloadData { taleView in
            print("-- Reloading \(elementsName) stopped \(taleView)")
        }
    }

    private var randomRowAnimation: UITableView.RowAnimation {
        return UITableView.RowAnimation(rawValue: (0...6).randomElement() ?? 0) ?? UITableView.RowAnimation.automatic
    }

    @objc func reloadRowButtonTouchedUpInside(source: UIBarButtonItem) {
        guard let tableView = tableView else { return }
        let elementsName = "Rows"
        print("-- Reloading \(elementsName) started")
        let indexPathToReload = tableView.indexPathsForVisibleRows?.randomElement() ?? IndexPath(row: 0, section: 0)
        tableView.reloadRows(at: [indexPathToReload], with: randomRowAnimation) { _tableView in
            //print("-- \(taleView)")
            print("-- Reloading \(elementsName) stopped in \(_tableView)")
        }
    }

    @objc func reloadSectionButtonTouchedUpInside(source: UIBarButtonItem) {
        guard let tableView = tableView else { return }
        let elementsName = "Sections"
        print("-- Reloading \(elementsName) started")
        tableView.reloadSections(IndexSet(integer: 0), with: randomRowAnimation) { _tableView in
            //print("-- \(taleView)")
            print("-- Reloading \(elementsName) stopped in \(_tableView)")
        }
    }
}

extension ViewController: UITableViewDataSource {
    func numberOfSections(in tableView: UITableView) -> Int { return 1 }
    func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int { return 20 }
    func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {
        let cell = UITableViewCell()
        cell.textLabel?.text = "\(Date())"
        return cell
    }
} 
```

## 结果

[![在此处输入图像描述](https://i.stack.imgur.com/RaKrJ.png)](https://i.stack.imgur.com/RaKrJ.png)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-01-08T15:53:57.363

只是提供另一种方法，基于完成是要发送到的“最后可见”单元格的想法`cellForRow`。

```
// Will be set when reload is called
var lastIndexPathToDisplay: IndexPath?

typealias ReloadCompletion = ()->Void

var reloadCompletion: ReloadCompletion?

func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {

    // Setup cell

    if indexPath == self.lastIndexPathToDisplay {

        self.lastIndexPathToDisplay = nil

        self.reloadCompletion?()
        self.reloadCompletion = nil
    }

    // Return cell
...

func reloadData(completion: @escaping ReloadCompletion) {

    self.reloadCompletion = completion

    self.mainTable.reloadData()

    self.lastIndexPathToDisplay = self.mainTable.indexPathsForVisibleRows?.last
} 
```

* * *

一个可能的问题是：如果在设置`reloadData()`之前完成，则`lastIndexPathToDisplay`在设置之前将显示“最后可见”单元格`lastIndexPathToDisplay`，并且不会调用完成（并且将处于“等待”状态）：

```
self.mainTable.reloadData()

// cellForRowAt could be finished here, before setting `lastIndexPathToDisplay`

self.lastIndexPathToDisplay = self.mainTable.indexPathsForVisibleRows?.last 
```

如果我们反转，我们最终可能会通过滚动 before 来触发完成`reloadData()`。

```
self.lastIndexPathToDisplay = self.mainTable.indexPathsForVisibleRows?.last

// cellForRowAt could trigger the completion by scrolling here since we arm 'lastIndexPathToDisplay' before 'reloadData()'

self.mainTable.reloadData() 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-18T07:55:34.460

如果你重新加载数据时`viewDidLoad`，你可以把你的代码放入`viewDidLayoutSubviews`方法中。但是你应该小心，`viewDidLayoutSubviews`可能会被多次调用。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2019-04-14T05:47:10.333

尝试这个：

```
tableView.backgroundColor = .black

tableView.reloadData()

DispatchQueue.main.async(execute: {

    tableView.backgroundColor = .green

}) 
```

`reloadData()`只有在函数完成后，tableView 的颜色才会从黑色变为绿色。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2020-06-17T18:31:43.673

创建 CATransaction 的可重用扩展：

```
public extension CATransaction {
    static func perform(method: () -> Void, completion: @escaping () -> Void) {
        begin()
        setCompletionBlock {
            completion()
        }
        method()
        commit()
    }
} 
```

现在创建一个 UITableView 的扩展，它将使用 CATransaction 的扩展方法：

```
public extension UITableView {
    func reloadData(completion: @escaping (() -> Void)) {
       CATransaction.perform(method: {
           reloadData()
       }, completion: completion)
    }
} 
```

用法：

```
tableView.reloadData(completion: {
    //Do the stuff
}) 
```

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2015-10-29T13:58:52.860

您可以在重新加载数据后使用它来做一些事情：

```
[UIView animateWithDuration:0 animations:^{
    [self.contentTableView reloadData];
} completion:^(BOOL finished) {
    _isUnderwritingUpdate = NO;
}]; 
```

* * *

## 回答 #18

> 赞同：-20
> 
> 时间：2014-05-18T20:49:52.473

尝试设置延迟：

```
[_tableView performSelector:@selector(reloadData) withObject:nil afterDelay:0.2];
[_activityIndicator performSelector:@selector(stopAnimating) withObject:nil afterDelay:0.2]; 
```

# php - 在 Code Igniter 中嵌套控制器

> ID：16071510
> 
> 赞同：0
> 
> 时间：2013-04-17T22:42:07.217
> 
> 标签：php, codeigniter

我正在使用一个 CI 类，它扩展了核心 CI_LOADER 允许我在模板中加载模板：

```
$this->load->view('wrapper','category',$data); 
```

这会将类别模板加载到主模板包装器中。

这意味着在控制器中，我必须确保始终填充需要馈入包装视图和内部视图的任何数据。因此，我的所有类都包括提取动态导航和显示在包装视图中的类别等内容所需的方法......然后在生成内部视图的控制器中，我必须调用这些方法并将它们分配为输出。

我的控制器最终可能看起来像这样：

```
public function product_listing($store,$category,$product_slug) {
    //These are all needed to populate the wrapper view
    $data['categories'] = $this->get_categories();
    $data['navigation'] = $this->navigation();
    $data['cart'] = $this->get_cart();
    $data['store'] = $store;
    //Then this is needed for the inner view        
    $data['products'] = $this->model_products>get_product($store,$category,$product_slug);
    $data['title'] = $data['products'][0]->product_name;
} 
```

我的问题是，有没有办法在某种包装类中加载这些东西，以避免用包装视图所需的方法（以及从上述其他方法中调用这些方法）污染我的每个类。

# matlab - matlab上许多文件的平均值

> ID：16071511
> 
> 赞同：0
> 
> 时间：2013-04-17T22:42:15.790
> 
> 标签：matlab

我想知道我是否可以得到帮助。我有许多 .mat 文件，每个文件都有一个数组，我想单独平均每个单元格（平均所有 (1,1)s、所有 (1,2)s、... (2,1)s 等）和存储它们。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:50:09.227

我不太确定您的数据是如何组织的，但是您可以执行以下操作：

```
% Assume you know the size of the arrays and that the variables r and c
% hold the numbers of rows and columns respectively.

xTotals = zeros(r, c);
xCount = 0;

% for each file: assume the data is loaded into a variable called x, which is
% r rows by c columns
for ...
  xTotals = xTotals + x;
  xCount = xCount + 1;
end

xAvg = xTotals / xCount; 
```

并将`xAvg`包含每个数组单元格的平均值。请注意，您可能`xCount`无需每次循环计算就知道，但这取决于您从哪里获取数据。希望你明白这一点！

# html - 描边 rect svg 的左侧和右侧

> ID：16071515
> 
> 赞同：6
> 
> 时间：2013-04-17T22:42:32.820
> 
> 标签：html, svg, d3.js

我已经使用 d3 在 svg 中绘制了一个矩形，并且只想描边左侧和右侧。

```
<rect class="extent" x="578" width="356" height="250"
      style="cursor: move; opacity: 0.2; fill: #FF9000;" ></rect> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T04:17:40.753

这是另一种技巧，但您可以为您的形状添加一个过滤器，并通过您的笔画宽度剪辑顶部和底部 - 我假设这里是 1 个单位。

```
<defs>
   <filter id="clippy" x="0" y="1" height="248" width="356">
     <feColorMatrix type="identity"/>
   </filter>
</defs>
<rect filter="url(#clippy)" class="extent" width="356" height="250"
      style="cursor: move;opacity: 0.2; fill: #FF9000;" x="578"></rect> 
```

**更新：**

这是 Christopher Chiche 创建的答案的 d3.js 版本（请参阅下面的原始版本）：

```
svg.append("defs").append("filter")
    .attr("id", "clippy")
    .attr("x", "0")
    .attr("y", "1")
    .attr("height", "248")
    .attr("width" "356")
    .append("feColorMatrix")
    .attr("type", "identity")

svg.append("rect")
    .attr("filter", "url(#clippy)")
    .attr("class", "extent") 
    .attr("style", "cursor:move; opacity:0.2; fill: #FF9000")
    .attr("x", "578")
    .attr("height", "250")
    .attr("width" "356") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T06:40:27.280

这是`d3.js`Michael Mullany 发布的答案版本。如果您想接受我的回答，请改为接受他的回答。我只是将其作为一个练习来获得乐趣：

```
svg.append("defs").append("filter")
    .attr("id", "clippy")
    .attr("x", "0")
    .attr("y", "1")
    .attr("height", "248")
    .attr("width" "356")
    .append("feColorMatrix")
    .attr("type", "identity")

svg.append("rect")
    .attr("filter", "url(#clippy)")
    .attr("class", "extent") 
    .attr("style", "cursor:move; opacity:0.2; fill: #FF9000")
    .attr("x", "578")
    .attr("height", "250")
    .attr("width" "356") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-01-16T16:24:16.637

[Codepen]（[https://codepen.io/shaswatatripathy/pen/oNgPpyd](https://codepen.io/shaswatatripathy/pen/oNgPpyd)）

HTML

```
 <rect x="0.5" y="0.5" width="50" height="50" class="topBottom"/>

    <rect x="70.5" y="0.5" width="50" height="50" class="left"/>
    <rect x="140.5" y="0.5" width="50" height="50" class="topRight"/>
    <rect x="200.5" y="0.5" width="50" height="50" class="top"/>
  <rect x="260.5" y="0.5" width="50" height="50" class="bottomLeft"/>
  <rect x="320.5" y="0.5" width="50" height="50" class="bottomRight"/>

  <rect x="380.5" y="0.5" width="50" height="50" class="topLeft"/>

   <rect x="440.5" y="0.5" width="50" height="50" class="right"/>
  <rect x="500.5" y="0.5" width="50" height="50" class="bottom"/>

  <rect x="560.5" y="0.5" width="50" height="50" class="leftRight"/>

</svg> 
```

CSS

```
rect { fill: none; stroke: black; }
.topBottom { stroke-dasharray: 50 }
.leftRight { stroke-dasharray: 0,50,50,0 }

.bottomLeft { stroke-dasharray: 0,100,150 }
.bottomRight { stroke-dasharray: 0,50,50 }
.topRight { stroke-dasharray: 100 }
.topLeft { stroke-dasharray: 50,100 }

.left { stroke-dasharray: 0,150,50 }
.top { stroke-dasharray: 50,150 }
.bottom { stroke-dasharray: 0,100,50,100 }
.right { stroke-dasharray: 0,50, 50,50 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T22:48:45.203

你似乎不能这样做。

您可能需要在两边画一条线，然后从矩形的当前宽度中减去这些线宽。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T17:58:20.890

我的示例是使用 d3.js 和画笔工具时。

```
# Brush object
brush.x(core.xScale()).on("brush", onBrush)         

# Call the brush object
container.call(brush).selectAll("rect").attr("height", core.height())

# Method on brush
onBrush = () ->
  extent = brush.extent()
  extent = if brush.empty() then core.xScale().domain() else extent 
```

无论如何，作为画笔工具的一部分，添加了 2 个矩形作为画笔的左右边界。您可以简单地使用 css 选择这些并重新设置它们的样式。这就是我最终要做的，这是我在 .less 中的解决方案

```
.resize {
    rect { 
        visibility: visible !important;
        fill: #444444;
    }
} 
```

# python - ckanext-harvest 2.0：自动将收获的记录添加到组织中

> ID：16071519
> 
> 赞同：1
> 
> 时间：2013-04-17T22:42:57.683
> 
> 标签：python, organization, ckan, harvest

[https://github.com/okfn/ckanext-harvest/blob/release-v2.0/README.rst#the-ckan-harvester](https://github.com/okfn/ckanext-harvest/blob/release-v2.0/README.rst#the-ckan-harvester)提到您可以指定“default_groups”配置选项以添加所有收获的记录到一组。

这在 CKAN 2.0 中仍然有效吗？是否有类似的“default_organizations”配置参数？

我尝试通过将 JSON 对象放入 /harvest/edit/my-source 的表单中来使用“default_groups”参数

```
{ "default_groups": ["my-group"] } 
```

存在一个名为“my-group”的组，但是我只是更新收获的包，而不是创建新的包。

fetch_consumer 日志：

```
2013-04-17 15:34:07,707 DEBUG [ckanext.spatial.harvesters.base.import] Import stage for harvest object: 66b01129-bcce-4bc8-9a67-1d7ece67b998
2013-04-17 15:34:07,708 DEBUG [ckanext.spatial.harvesters.base] Using config: {u'default_groups': [u'my-group']}
2013-04-17 15:34:07,713 DEBUG [ckanext.spatial.validation.validation] Starting validation against profile(s) iso19139
2013-04-17 15:34:07,770 DEBUG [ckanext.spatial.validation.validation] Validated against "ISO19139 XSD Schema"
2013-04-17 15:34:07,770 INFO  [ckanext.spatial.validation.validation] Validation passed
2013-04-17 15:34:07,898 DEBUG [ckanext.spatial.plugin] Received: u'{"type": "Polygon", "coordinates": [[[-116.016, 30.5461], [-116.016, 37.5297], [-108.281, 37.5297], [-108.281, 30.5461], [-116.016, 30.5461]]]}'
2013-04-17 15:34:07,902 DEBUG [ckanext.spatial.lib] Extent for package 7c5646d5-6689-49f6-94fb-0eaf54f84959 unchanged
2013-04-17 15:34:08,149 INFO  [ckanext.spatial.harvesters.base.import] Updated package 7c5646d5-6689-49f6-94fb-0eaf54f84959 with guid 4e6b8f72f7d6c3856f092c6b8501195f 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T10:01:29.847

从您的日志中，我假设您正在使用空间收割机（例如 CSW）。您指向的文档是指 CKAN-to-CKAN 收割机（即收割其他 CKAN 实例）。我们将改进文档以避免混淆。

好消息是空间采集器会自动将任何新数据集分配给采集源所属的同一组织，因此无需使用任何配置设置（这仍然需要在 CKAN 采集器上实现）。只需确保在创建或编辑收获源时为其定义一个组织。请注意，只有当您登录的用户属于某个组织时，您才会看到此字段。

![收获源表单中的组织字段](https://i.stack.imgur.com/kpsHk.jpg)

# regex - Perl 搜索和替换不起作用

> ID：16071522
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:43:08.427
> 
> 标签：regex, windows, perl

我正在尝试替换文件中的字符串，但我的程序似乎正在删除字符串而不是用我想要的替换它

例子

```
perl -ne 'print unless s/ServerIp=${Solid.host}/ads/;' needsToBeReplaced.prp > blah.txt 
```

将删除

"ServerIp=${Solid.host}" 并将该行留空，而不是在其位置打印“广告”

顺便说一句，我在 Windows 中运行。另外我在正则表达式中没有第三个参数，因为我只想更改第一次出现。我也试过

```
perl -pi -e 's/ServerPort=${Solid.port}/ads/;' needsToBeReplaced.txt 
```

但是我得到了权限错误，所以就地编辑是不行的

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T22:46:21.723

You print the line only if the substitution is not successful. If you want to print always, do not use `unless`:

```
perl -pe "s/ServerIp=\${Solid.host}/ads/;" needsToBeReplaced.prp > blah.txt 
```

You should also escape the dollar sign to prevent its interpretation by Perl.

Also note that double quotes must be used on MS Windows.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:48:54.600

With what you've got now, if the substitute succeeds, it will return a true value, which means `unless` will be true, which means nothing will be printed. You could do it like this:

```
perl -ne 's/ServerIp=${Solid.host}/ads/; print;' needsToBeReplaced.prp > blah.txt 
```

# sql - 使用多个左外连接的 Sql 查询需要更多时间才能完成

> ID：16071524
> 
> 赞同：0
> 
> 时间：2013-04-17T22:43:33.020
> 
> 标签：sql, oracle

```
create materialized view MV_SD_SIPL_BOMLEVELSALT_5 refresh force on demand as 
(
select 'id-' || rownum id, 
                t1.L1 l0, t1.L0 l1, t1.alternateitem l1ai, t1.effstartdate l1sd, t1.effenddate l1ed, t1.qtyper l1q, t1.siteid l1s, t1.transittime l1tt,
                t2.l0 l2,  t2.alternateitem l2ai, t2.effstartdate l2sd, t2.effenddate l2ed, t2.qtyper l2q, t2.siteid l2s, t2.transittime l2tt,
                t3.l0 l3,  t3.alternateitem l3ai, t3.effstartdate l3sd, t3.effenddate l3ed, t3.qtyper l3q, t3.siteid l3s,t3.transittime l3tt,
                t4.l0 l4, t4.alternateitem l4ai, t4.effstartdate l4sd, t4.effenddate l4ed, t4.qtyper l4q, t4.siteid l4s,t4.transittime l4tt,
                t5.l0 l5, t5.alternateitem l5ai, t5.effstartdate l5sd, t5.effenddate l5ed, t5.qtyper l5q, t5.siteid l5s,t5.transittime l5tt,
                t6.l0 l6, t6.alternateitem l6ai, t6.effstartdate l6sd, t6.effenddate l6ed, t6.qtyper l6q, t6.siteid l6s,t6.transittime l6tt,
                t7.l0 l7, t7.alternateitem l7ai, t7.effstartdate l7sd, t7.effenddate l7ed, t7.qtyper l7q, t7.siteid l7s,t7.transittime l7tt,
                t8.l0 l8, t8.alternateitem l8ai, t8.effstartdate l8sd, t8.effenddate l8ed, t8.qtyper l8q, t8.siteid l8s,t8.transittime l8tt,
                t9.l0 l9, t9.alternateitem l9ai, t9.effstartdate l9sd, t9.effenddate l9ed, t9.qtyper l9q, t9.siteid l9s,t9.transittime l9tt,
                t10.l0 l10, t10.alternateitem l10ai, t10.effstartdate l10sd, t10.effenddate l10ed, t10.qtyper l10q, t10.siteid l10s,t10.transittime l10tt,
                t11.l0 l11, t11.alternateitem l11ai, t11.effstartdate l11sd, t11.effenddate l11ed, t11.qtyper l11q, t11.siteid l11s,t11.transittime l11tt,
                nvl2(t1.L0, 1, 0) + nvl2(t1.L0, 1, 0) + nvl2(t2.l0, 1, 0) +
                nvl2(t3.l0, 1, 0) + nvl2(t4.l0, 1, 0) + nvl2(t5.l0, 1, 0) +
                nvl2(t6.l0, 1, 0) + nvl2(t7.l0, 1, 0) + nvl2(t8.l0, 1, 0) +
                nvl2(t9.l0, 1, 0) + nvl2(t10.l0, 1, 0) + nvl2(t11.l0, 1, 0) cnt,
                t1.l1 sku,
                t1.bomid
  from (select L1, L0, alternateitem,effstartdate,effenddate, qtyper,siteid,fromsiteid,bomid,
   transittime  from MV_SD_SIPL_BOMLEVELSALT55 where l1 like 'SD%') t1
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t2 on t1.alternateitem = t2.l1 and t1.fromsiteid = t2.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t3 on t2.alternateitem = t3.l1 and t2.fromsiteid = t3.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t4 on t3.alternateitem = t4.l1 and t3.fromsiteid = t4.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t5 on t4.alternateitem = t5.l1 and t4.fromsiteid = t5.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t6 on t5.alternateitem = t6.l1 and t5.fromsiteid = t6.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t7 on t6.alternateitem = t7.l1 and t6.fromsiteid = t7.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t8 on t7.alternateitem = t8.l1 and t7.fromsiteid = t8.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t9 on t8.alternateitem = t9.l1 and t8.fromsiteid = t9.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t10 on t9.alternateitem = t10.l1 and t9.fromsiteid = t10.siteid
  left outer join MV_SD_SIPL_BOMLEVELSALT55 t11 on t10.alternateitem = t11.l1 and t10.fromsiteid = t11.siteid
); 
```

我有上面的查询来创建物化视图，大约需要 50 分钟才能完成。请帮我减少时间。我尝试创建普通索引，甚至尝试重写查询，但没有帮助。附上解释计划，请帮我调整查询。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T09:02:01.010

**第一点**

当你说

> 我试图创建普通索引

你什么意思？你能告诉我们你创建的索引吗？我很确定你忘记了一个索引。您需要索引的列列表：

```
l1, alternateitem, fromsiteid, and siteid 
```

**第二点**

这是不好的：

```
from 
(
    select L1, L0, alternateitem,effstartdate,effenddate, qtyper,siteid,fromsiteid,bomid, transittime  
    from MV_SD_SIPL_BOMLEVELSALT55 
    where l1 like 'SD%'
) t1 
```

你为什么在这里做一个子查询？只需过滤子句：

```
select  bablabla
from MV_SD_SIPL_BOMLEVELSALT55 as t1
    left outer join blablabla
where t1.l1 like 'SD%' 
```

# javascript - 如何在jsp页面中的复选框上使用onClick（）

> ID：16071530
> 
> 赞同：-2
> 
> 时间：2013-04-17T22:44:15.050
> 
> 标签：javascript, jsp

如何在复选框上的 jsp 页面中使用 onClick() 事件。这是我的代码，当我在代码中有 onClick() 事件时，它一直给我错误。

JS：

```
function toggleDiv(tokenCheckBox) {     
  if (tokenCheckBox.checked == true) { 
    document.getElementById("CardNo").style.display = "none";
    document.getElementById("Token").style.display = "block";
  } else {
    document.getElementById("CardNo").style.display = "block";
    document.getElementById("Token").style.display = "none";
  }
} 
```

JSP：

```
html:checkbox property="returnToken" onClick="toggleDiv(this)" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:02:08.393

应该是这样的>>`<input type="checkbox" onClick="toggleDiv(this)">`

这是错误的>>`<html:checkbox property="returnToken" onClick="toggleDiv(this)">`

即使是 JSP，你声明 HTML 的方式也是一样的。

你能解释一下你如何使用 like`<html:checkbox>`吗？

问候，

# c# - MVC4 C#从数据库中填充视图模型中的数据

> ID：16071531
> 
> 赞同：5
> 
> 时间：2013-04-17T22:44:20.477
> 
> 标签：c#, asp.net-mvc-4, viewmodel

我有一个视图模型，它需要来自两个模型人员和地址的数据：

楷模：

```
public class Person
{
   public int Id { get; set; }
   public string Name { get; set; }
   public int Age { get; set; }
   public int Gender { get; set; }
}

public class Address
{
   public int Id { get; set; }
   public string Street { get; set; }
   public int Zip { get; set; }
   public int PersonId {get; set; }
} 
```

Viewmodel 就是这样

```
public class PersonAddViewModel
{
    public int Id { get; set; }
    public string Name { get; set; }
    public string Street { get; set; }
} 
```

我尝试了几种方法将数据放入视图模型并将其传递给视图。将有多个记录返回显示。

我的最新方法是这样填充视图模型：

```
private AppContexts db = new AppContexts();
public ActionResult ListPeople()
{
    var model = new PersonAddViewModel();
    var people = db.Persons;
    foreach(Person p in people)
    {
        Address address = db.Addresses.SingleOrDefault(a => a.PersonId == p.Id)
        model.Id = p.Id;
        model.Name = p.Name;
        model.Street = address.Street;
    }
    return View(model.ToList());
} 
```

我在 Address address = db... 行“EntityCommandExecutionException 未被用户代码处理。

如何用多条记录填充视图模型并传递给视图？

最终解决方案：

```
private AppContexts db = new AppContexts();
private AppContexts dbt = new AppContexts();
public ActionResult ListPeople()
{
    List<PersonAddViewModel> list = new List<PersonAddViewModel>();
    var people = db.Persons;
    foreach(Person p in people)
    {
        PersonAddViewModel model = new PersonAddViewModel();
        Address address = dbt.Addresses.SingleOrDefault(a => a.PersonId == p.Id)
        model.Id = p.Id;
        model.Name = p.Name;
        model.Street = address.Street;
    }
    return View(list);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T05:50:08.253

首先，EntityCommandExecutionException 错误表明您的实体上下文或实体本身的定义中存在错误。这会引发异常，因为它发现数据库与您告诉它的方式不同。你需要弄清楚这个问题。

其次，关于执行此操作的正确方法，如果您的上下文配置正确，您显示的代码应该可以工作。但是，更好的方法是使用 Navigational 属性，只要您想要获取所有相关记录并且不指定其他 Where 子句参数。导航属性可能如下所示：

```
public class Person
{
   public int Id { get; set; }
   public string Name { get; set; }
   public int Age { get; set; }
   public int Gender { get; set; }

   public virtual Address Address { get; set; }
   // or possibly, if you want more than one address per person
   public virtual ICollection<Address> Addresses { get; set; }
}

public class Address
{
   public int Id { get; set; }
   public string Street { get; set; }
   public int Zip { get; set; }
   public int PersonId { get; set; }

   public virtual Person Person { get; set; }
} 
```

然后你会简单地说：

```
public ActionResult ListPeople()
{
    var model = (from p in db.Persons // .Includes("Addresses") here?
                select new PersonAddViewModel() {
                    Id = p.Id,
                    Name = p.Name,
                    Street = p.Address.Street,
                    // or if collection
                    Street2 = p.Addresses.Select(a => a.Street).FirstOrDefault()
                });

    return View(model.ToList());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:05:17.167

为了显示对象列表，您可以使用具有通用列表的通用视图模型：

```
public class GenericViewModel<T>
{
    public List<T> Results { get; set; }

    public GenericViewModel()
    {
        this.Results = new List<T>();
    }
} 
```

有一个返回的控制器操作，比如说你数据库中的所有人：

```
[HttpGet]
public ActionResult GetAllPeople(GenericViewModel<People> viewModel)
{
    var query = (from x in db.People select x); // Select all people
    viewModel.Results = query.ToList();

    return View("_MyView", viewModel);
} 
```

然后使您的视图具有强类型，并采用您的通用视图模型：

```
@model NameSpace.ViewModels.GenericViewModel<NameSpace.Models.People> 
```

# mysql - MySQL：返回当前月份和前 3 个月的记录

> ID：16071535
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:45:07.637
> 
> 标签：mysql, date, filter

我正在使用 PHP/MySQL 预订系统，并且正在使用 Google 折线图来尝试显示当月以及前 3 个月的总销售额。

每个预订都有一个标准 phpmyadmin“日期”格式的日期，即 yyyy:mm:dd。

因此，我希望从 4 个查询中获得 4 个结果，每个查询过滤掉某个月份并获取该月每个预订的总和。

我的问题是，如何区分查询中的月份？我将如何构建查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T22:50:57.490

根据标题：

```
select * from bookings where MONTH(CURDATE())=MONTH(booking_date);
select * from bookings where MONTH(booking_date) > MONTH(CURDATE()-INTERVAL 3 MONTH) and < MONTH(CURDATE() + INTERVAL 1 MONTH); 
```

对于简单的每月搜索，您可以使用以下内容：

```
Select * from bookings where MONTHNAME(booking_date)='July' and YEAR(booking_date)=2013; 
```

或者：

```
Select * from bookings where MONTH(booking_date)=7 and YEAR(booking_date)=2013; 
```

此外，由于您已经有了月份，您可以这样做（此方法要求您维护每个月的结束日期表以补偿闰年）：

```
select * from bookings where booking_date>'2013-06-30' AND booking_date<'2013-08-01'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-20T16:31:48.140

首先，请原谅我的英语......

我知道这是旧线程并且不能发表评论，但是，@AbsoluteƵERØ，该答案适用于当前月份，例如，如果我在 2013-2014-2015 年获得 7 月的记录，则查询将返回那些年当月的记录....为避免这种情况并使用您发布的代码：

```
SELECT * FROM bookings WHERE MONTH(CURDATE()) = MONTH(booking_date) AND YEAR(CURDATE()) = YEAR(booking_date); 
```

注意：如果使用“名称形式”并指定年份没有问题，如下所示：

```
SELECT * FROM bookings WHERE MONTH(CURDATE()) = MONTH(booking_date) AND YEAR(booking_date) = 2013; 
```

# c# - 如何查询实体中某个属性的平均值并将其返回到 LINQ 中的对象列表列表中？

> ID：16071538
> 
> 赞同：1
> 
> 时间：2013-04-17T22:45:35.090
> 
> 标签：c#, linq, linq-to-sql, average

我在 Entity Framework 中设计的实体如下所示：

事件

*   事件 ID
*   日期
*   加速
*   强度
*   设备编号
*   区块标识
*   设备
*   堵塞

堵塞

*   区块标识
*   开始日期
*   日期结束
*   活动

设备

*   设备编号
*   别名
*   集群 ID
*   簇
*   活动

簇

*   集群 ID
*   姓名
*   设备
*   区域 ID

地区

*   区域 ID
*   姓名
*   集群

一个 Event 属于一个 Block，由一个 Device 注册。一个设备属于一个集群，一个集群属于一个区域。

我想要做的是获得一个块中事件的平均加速度和平均强度，组织在一个列表中的对象中，这些对象必须根据我是否想获得一个块的事件的平均值来组织被每个集群或每个区域中的设备检测到。

我应该使用 LINQ 中的哪种查询？

为了更清楚，这些是代表我要执行的操作的 SQL 字符串

```
select avg(e.Intensity) as average from blocks b, events e, devices d, clusters c, regions r where b.blockid = 1 and b.blockid = e.blockid and e.uniqueid= d.uniqueid and d.clusterid  = c.clusterid group by c.clusterid;

select avg(e.Intensity) as average from blocks b, events e, devices d, clusters c, regions r where b.blockid = 1 and b.blockid = e.blockid and e.uniqueid= d.uniqueid and d.clusterid  = c.clusterid and c.regionid = r.regionid group by c.regionid; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T02:12:37.160

也许是这样的（linq to entity）......

```
from ev in db.Events
where ev.Block.BlockID == 1
group ev by ev.Device.Cluster.Region.ID into g
// group ev by ev.Device.Cluster.ClusterID into g
select new
{
    RegionID = g.Key, // ClusterID = g.Key,
    AverageIntensity = g.Average(x => x.Intensity),
    AverageAcceleration = g.Average(x => x.Acceleration),
}; 
```

要添加其他字段，例如名称：

```
group ev by new { ID = ev.Device.Cluster.ClusterID, Name = ev.Device.Cluster.Name } 
into g 
```

或者

```
group ev by ev.Device.Cluster into g  
// ...
ClusterName = g.Key.Name, 
```

（两者的 SQL 相同）

> 您有效地“按”许多字段“分组” - 但由于所有字段都相同（即如果 ID 相同，则名称相同） - 您不会更改分组的性质 - 您只需附加额外的字段。

通常（不带聚合）您还可以将“分组”添加到选择中`Group = g,`，然后展平并返回所有记录等。

# php - 保护面向外部的网站数据库配置

> ID：16071542
> 
> 赞同：1
> 
> 时间：2013-04-17T22:45:38.637
> 
> 标签：php, mysql, apache

我正在向一个面向公众的站点添加一些数据库使用，并且我想输入关于存储 mysql 连接信息的最安全方式可能是什么。我想出了几个选择：

首先，我可以将配置存储在另一个目录中，然后设置 PHP 包含路径以查找该目录。其次，我知道有些文件 apache 不会提供给浏览器，我可以使用其中一种类型的文件。第三，我可以将加密文件存储在服务器上，并用 PHP 解密它们。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:47:09.097

必须将配置存储在 apache 的文档根目录之外

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T22:48:03.863

您可以配置 apache 以禁止任何带有 htaccess 的文件。

在 config 文件夹中添加`.htaccess`以下内容

```
order allow,deny
deny from all 
```

如果您不想将 .htaccess 用作@johua k，请提及，而不是添加

```
<Directory /home/www/public/config>
    order allow,deny
    deny from all
</Directory> 
```

到您的 apache 配置。

这将拒绝将该文件夹中的任何文件提供给任何人，这很好，因为 php 不关心 htaccess 你可以

`include('config/db.php')`

如果你正确配置了你的 php 脚本，它们永远不会以纯文本形式出现。

所以像这样的文件

```
define('mysql_password', 'pass') 
```

永远不会显示该文本。

如果您担心共享主机环境和其他用户有权读取此文件，那么您应该评估 linux 安装和主机的安全性。其他用户应该对您的文件有任何浏览权限。从标记为 php 的 web 文件中永远不应返回源代码。

您可以明确告诉 apache 永远不要提供文件，因此它们只能是 include() 或 require() 能够的。

# c# - 您将如何定义代理类型？

> ID：16071546
> 
> 赞同：-2
> 
> 时间：2013-04-17T22:46:00.310
> 
> 标签：c#, types, definition

我从概念上理解它们，但很难为它们想出一个简单的英文定义。

这是我认为迄今为止我想出的最接近的拟合：

> 代理类型是在别处定义的数据模型的表示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:13:44.720

我在编程中知道，当我们说代理时，我们指的是代理模式。

如果您想或多或少地用文字说明它是什么，请点击此处：[ProxyPattern](http://en.wikipedia.org/wiki/Proxy_pattern)。

句子“代理，在其最一般的形式中，是一个类，作为其他事物的接口。” 我认为归结为代理的概念

# iphone - CLLocationManager initialization and call on button

> ID：16071550
> 
> 赞同：0
> 
> 时间：2013-04-17T22:46:12.633
> 
> 标签：iphone, ios, geolocation, core-location, cllocationmanager

I want my app to get current location when user taps a button. I initialize `locationManager` object in init method.

First question: is this good if I'm going to need currentlocation every time I press button? Or should I initialize it even in `viewDidLoad`?

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];

    if (self)
    {
        // Create location manager object
        locationManager = [[CLLocationManager alloc] init];
        locationManager.delegate = self;

        // Best accuracy as posibble
        [locationManager setDesiredAccuracy:kCLLocationAccuracyBest];
    }
    return self;
} 
```

In my delegate method I `stopUpdatingLocation` as soon as I got my `currentLocation`.

```
// Delegate method
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray        
*)locations   
{
    CLLocation *currentLocation = [locations lastObject];

    [locationManager stopUpdatingLocation];
} 
```

Here I `startUpdatingLocation` with button:

```
- (IBAction)getCurrentLocation:(id)sender
{
    [locationManager startUpdatingLocation];
} 
```

Second question is: when I press button 1st time, I get right location, but when I change location in simulator and press again it shows the 1st one. Again, when I press the button, then it shows the right one. I have tried to initialize `locationManager` every time button is pressed but it doesn't work that way neither.

I read on other post that its because of location cache or something like that. How do I remove that cache ? Because I'm going to store that location somewhere else in DB anyways so I don't need old one..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:03:44.340

## `init`问题 1：我应该在 in还是 in初始化我的位置管理器`viewDidLoad`

我会选择`viewDidLoad`，只是因为这样可以确保所有依赖项都已加载。

## 问题2：用户位置没有被更新。

用户位置没有改变，因为您在第一次收到位置信息后停止收听位置更新：

```
[locationManager stopUpdatingLocation]; 
```

但是当用户按下`getCurrentLocation`按钮时，您会再次开始收听。如果您愿意，您仍然可以使用这种方法，但我会在`getCurrentLocation`操作中设置一个标志，以便在找到新位置时更新 UI。

例子：

```
// Delegate method
- (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray        
*)locations   
 {
     CLLocation *currentLocation = [locations lastObject];

     [locationManager stopUpdatingLocation];

     if (self.updateUIOnNextLocation) {
         [self updateUIWithLocation:currentLocation];
         self.updateUIOnNextLocation = NO;
     }
}

...

- (IBAction)getCurrentLocation:(id)sender
{
     self.updateUIOnNextLocation = YES;
     [locationManager startUpdatingLocation];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-29T16:44:56.613

如果每次按下按钮只需要更新当前位置，为什么不创建一个单例类（*下面显示基于 iOS 8 的示例*），并缓存当前位置，然后添加一个在用户按下时调用的“重新触发”方法一个按钮，告诉位置管理器再次开始更新位置，缓存结果，然后关闭更新（再次）？这样，您就不会浪费资源来获取不必要的更新。您仍然必须以某种方式同步演示文稿，以便在位置尚不可用或当前不可用时显示或处理。

```
import Foundation
import CoreLocation

class CurrentLocation : NSObject, CLLocationManagerDelegate {

    enum InitPhase {
        case RequestingAuthorization, StartUpdatingLocation, ReverseGeocoding
    }

    var locationManager : CLLocationManager?
    var placemark : CLPlacemark?
    var initializationPhase : InitPhase = .RequestingAuthorization

    override init() {
        super.init()
        placemark = nil
        locationManager = CLLocationManager()
        locationManager!.delegate = self
        locationManager!.requestWhenInUseAuthorization()
    }

    func nonull(s : String?) -> String {
        if (s == nil) {
            return ""
        }
        return s!
    }

    // Handle all NSErrors here (not just from location manager)
    func locationManager(manager: CLLocationManager!, didFailWithError error: NSError!) {
        switch(initializationPhase) {
        case .RequestingAuthorization:
            println("CurrentLocation class - App not authorized by user to use location services")
        case .StartUpdatingLocation:
            println("CurrentLocation class - StartUpdatingLocation\n   ClLocationManager reported error to delegate:\n      \(error.localizedDescription)")
        case .ReverseGeocoding:
            println("CurrentLocation class - ReverseGeocoding\n   CLGeocoder().reverseGeocodeLocation() error:\n      \(error.localizedDescription)")
        default:
            println("CurrentLocation class - Unknown basis\n   ClLocationManager reported error to delegate:\n      \(error.localizedDescription)")

        }
    }

    func locationManager(manager: CLLocationManager!, didChangeAuthorizationStatus status: CLAuthorizationStatus) {
        if (status == .AuthorizedAlways || status == .AuthorizedWhenInUse) {
            println("CurrentLocation class - App authorized to use location services")
            initializationPhase = .StartUpdatingLocation
            locationManager!.startUpdatingLocation()
        } else {
            println("CurrentLocation class - App not authorized by user to use location services")

        }
    }

    func locationManager(manager: CLLocationManager!, didUpdateLocations locations: [AnyObject]!) {
        var location = locations.last as CLLocation
        println("CurrentLocation class - CLLocation delagate received loocation update\n")
        locationManager?.stopUpdatingLocation()
        CLGeocoder().reverseGeocodeLocation(location, completionHandler: { (placemarks, error) in
            if (error == nil) {
                println("   Latitude/Longitude: \(location.coordinate.latitude) \(location.coordinate.longitude)")
                if placemarks.count > 0 {
                    self.placemark = CLPlacemark(placemark: placemarks[0] as CLPlacemark)
                    println(String(format:"   subThoroughfare:    %@\n   thoroughfare:       %@\n   locality:           %@\n   postalCode:         %@\n   administrativeArea: %@\n   country:            %@",
                                self.nonull(self.placemark!.subThoroughfare),
                                self.nonull(self.placemark!.thoroughfare),
                                self.nonull(self.placemark!.locality),
                                self.nonull(self.placemark!.postalCode),
                                self.nonull(self.placemark!.administrativeArea),
                                self.nonull(self.placemark!.country)))
                } else {
                    println("No placemarks located")
                }

            } else {
                self.locationManager(manager, didFailWithError: error)
            }
        })
    }
} 
```

# popup - 通过弹出子表单 (2) 添加新子表单 (1) 记录后重新查询子表单 (1) - Access 2007

> ID：16071557
> 
> 赞同：2
> 
> 时间：2013-04-17T22:47:16.333
> 
> 标签：popup, ms-access-2007, runtime-error, multiple-forms, subforms

我有一个包含两个子表单（1 和 2）的表单。子表格 1 连续存储帐户细分的数据。使用弹出子表单（子表单 2），用户输入数据以更改或更新存储在子表单 1 上的帐户明细。提交时，信息存储在链接到子表单 1 的子表中，但数据不会刷新并在子表单 1 的新记录中添加新信息，除非我手动单击主页选项卡中的全部刷新按钮。

到目前为止，我已经在子表单 2 的 form_afterupdate 上尝试了以下代码，它会自动重新查询子表单 1，但在主表单关闭时会创建运行时错误 (2450)：

```
Private Sub Form_AfterUpdate()

On Error GoTo Err_Form_AfterUpdate

Forms!frmSpendPlan!frmSpendPlanSub.Form.Requery

Exit_Form_AfterUpdate:

Exit Sub

Err_Form_AfterUpdate:

MsgBox Err.Description

Resume Exit_Form_AfterUpdate

End Sub 
```

如果有人有办法在提交子表单 2 后自动重新查询子表单 1 数据而不会产生错误，请告诉我，感谢您提供的任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:40:07.967

我有时和你有同样的问题！表单无法正确刷新。

**方法一**

试试这行代码而不是当前的重新查询代码。它不应该给你一个错误，但由于错误可能仍然无法工作......

```
Form_frmSpendPlanSub.Requery 
```

我使用这种格式来跨表单引用，并且通常效果很好。

**方法二**

**1）**您可以尝试在设计视图中单击正在执行“ **After_Update** ”的表单

**2)**右击表单，点击“ **BUILD EVENT** ..” 并选择“**表达式生成器**”

在表达式生成器中，您可以准确地看到您在表单中的链接到您想要访问的表单以及您想要做什么......

因此，您可以通过转到**FORMS** --> **Loaded Forms** --> **frmSpendPlanSub**来导航自己，然后从列表中双击“**“这会让你引用你想要影响的表单。然后你所要做的就是将上面框中给你的代码复制到你的 VBA 代码中，然后引用你想要做的事情......**

 **例如

```
Forms![frmMainForm]![frmSecondForm].Form![frmThirdForm].Form.Requery 
```

无论如何希望这会有所帮助......**

# ruby - 使用 Ruby 正则表达式扫描字符串

> ID：16071559
> 
> 赞同：0
> 
> 时间：2013-04-17T22:47:19.223
> 
> 标签：ruby, regex, pattern-matching, scanf

我正在尝试使用以下正则表达式扫描以下字符串：

```
 text = %q{akdce ALASKA DISTRICT COURT CM/ECFalmdce 
           ALABAMA MIDDLE DISTRICT COURTalndce
          }

 p courts = text.scan(/(ECF\w+)|(COURT\w+)/) 
```

理想情况下，我想要做的是扫描文本并提取文本“ECFalmdce”和“COURTalndce”使用我正在使用的正则表达式，我想说我想要一个以 COURT 或 ECF 开头的字符串，后跟一个随机字符串的字符。

返回的数组是：

```
 [["ECFalmdce", nil], [nil, "COURTalndce"]] 
```

与 nil 有什么关系，是否有人有更有效的方式来编写正则表达式，是否有人有指向匹配组的进一步文档的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:58:39.773

`ECF`您的正则表达式对和的捕获方式不同`COURT`。您可以使用创建非捕获组`?:`

```
text.scan(/(?:ECF|COURT)\w+/)
# => ["ECFalmdce", "COURTalndce"] 
```

**编辑**

关于非捕获组：您可以使用它们通过括号创建模式而不捕获模式。

它们是诸如`(?:pattern)`

[您可以在http://www.regular-expressions.info/refadv.html](http://www.regular-expressions.info/refadv.html)找到有关正则表达式的更多信息

# azure - Error associating Azure SQL database with Azure website: System.NullReferenceException: Object reference not set to an instance of an object

> ID：16071560
> 
> 赞同：0
> 
> 时间：2013-04-17T22:47:38.657
> 
> 标签：azure

I am having a strange error with publishing my website to Azure. I published it to the service using VS 2010 but then have run into this error in connecting my database to the website. The login page works, as do most of the pages on the site, even those that rely on the very same database. The page with the issue comes up with the following text:

```
Server Error in '/' Application.
Object reference not set to an instance of an object.
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.

Exception Details: System.NullReferenceException: Object reference not set to an  instance of an object.

Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[NullReferenceException: Object reference not set to an instance of an object.]
   MAO.Controllers.ReviewController.Index() +603
   lambda_method(Closure , ControllerBase , Object[] ) +62
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[]     parameters) +14
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +214
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +27
   System.Web.Mvc.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12() +55
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +253
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +21
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +253
   System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +21
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +191
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +324
   System.Web.Mvc.Controller.ExecuteCore() +106
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +91
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
   System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +34
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +19
   System.Web.Mvc.Async.<>c__DisplayClass8`1.<BeginSynchronous>b__7(IAsyncResult _) +10
   System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62
   System.Web.Mvc.<>c__DisplayClasse.<EndProcessRequest>b__d() +48
   System.Web.Mvc.SecurityUtil.<GetCallInAppTrustThunk>b__0(Action f) +7
   System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +22
   System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
   System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) +9
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +9629708
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +155 
```

The error occurs within the following section of code:

```
public ActionResult ShortDateResponse(int reviewId, int questionId, string response) {
        if (string.IsNullOrEmpty(response)) {
            var answer = repository.GetAnswerByQuestionId(reviewId, questionId);
            if (answer != null) {
                repository.DeleteAnswerById(answer.Id);
            }
        } else {
            try {
                DateTime date = DateTime.ParseExact(response, "MM/yyyy", CultureInfo.InvariantCulture);
                repository.ShortDateResponse(reviewId, questionId, date);
            } catch (Exception fe) {
                throw new ArgumentException("Date format should be MM/yyyy", fe);
            }
        }
        return Json(new {
            success = true,
            error = "none"
        });
    } 
```

on this line:

```
DateTime date = DateTime.ParseExact(response, "MM/yyyy", CultureInfo.InvariantCulture); 
```

As such, it seems to me the code is not responsible.

I have tried uploading the database to Azure multiple different ways, and according to the various Microsoft tutorials, and have reviewed others who have presented very similar questions on SO and other places. At this point I am not sure how to move forward, so I'm asking.

Initially, I used SQL Management Studio 2008R's "Extract Data-Tier Application" and "Import Data-Tier Application" to load the schema for the database, then "Export Data" and "Import Data" to load up the data onto the server. I ensured that the commandtimeout variable was sat to 0 for all tables so nothing would get lost along the way, and sure enough, everything showed up on the Azure database. When this presented the aforementioned error, I attempted to use the "Generate scripts" to upload the schema, in case there had been some error with my previous process. I then used Export/Import Data to put the data on the website. I received the same error.

This website does work properly on internal servers, an has been deployed successfully elsewhere, but I'd like to migrate to Azure if possible. Also, I have checked the uploaded website linked to local SQL servers and it has worked properly, so the issue lies in the upload of the SQL database to Azure servers.

I am aware that many people with this error have been able to solve it by editing their connection strings within web.config. I have looked into this, and have manually edited my connection string via Filezilla to the format put forth on various websites, to no avail.

I would really appreciate any insights you have, and let me know if you need more details. Thank you!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:53:24.427

一种想法是它可能是 SQL Azure 实例上的防火墙规则。在 Windows Azure 管理门户中，转到该 SQL Azure 服务器的“配置”页面。是否设置为“是”以允许 Windows azure 服务？

您还可以发布控制器操作 MAO.Controllers.ReviewController.Index() 的代码，以便我们可以看到发生空引用异常的位置吗？

# c++ - Variable sized packet

> ID：16071561
> 
> 赞同：1
> 
> 时间：2013-04-17T22:47:40.833
> 
> 标签：c++, networking, simulation, ns-3

I am trying to define a packet whose length is determined during an ns-3 simulation (think of it as a packet sent on the downlink containing schedule information whose length depends on the number of nodes in the network which can join/leave the network during simulation). Does anyone have any idea how I could approach this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:16:29.680

关于如何做到这一点的最简单的介绍是[http://www.nsnam.org/support/faq/miscellaneous/#table](http://www.nsnam.org/support/faq/miscellaneous/#table)

实际上，如果您想扩展此代码以存储可变大小的数据结构，您可以这样做：

```
class MyHeader : public Header
{
public:
  // new methods
  void AppendData (uint16_t data);
  std::vector<uint16_t> GetData (void) const;

  static TypeId GetTypeId (void);
  // overridden from Header
  virtual uint32_t GetSerializedSize (void) const;
  virtual void Serialize (Buffer::Iterator start) const;
  virtual uint32_t Deserialize (Buffer::Iterator start);
  virtual void Print (std::ostream &os) const;
private:
  std::vector<uint16_t> m_data;
}; 
```

我将跳过明显的 GetData/AppendData 方法。相反，我们可以专注于 Serialize/Deserialize 方法：

```
uint32_t 
MyHeader::GetSerializedSize (void) const
{
  // two bytes of data to store
  return m_data.size() * 2;
}
void 
MyHeader::Serialize (Buffer::Iterator start) const
{
  start.WriteHtonU32(GetSerializedSize());
  for (std::vector<uint16_t>::const_iterator i = m_data.begin(); i != m_data.end(); i++) 
    {
      start.WriteHtonU16 (*i);
    }
}
uint32_t 
MyHeader::Deserialize (Buffer::Iterator start)
{
  uint32_t len = start.ReadNtohU32 ();
  for (uint32_t i = 0; i < len; i++) {
    m_data.append(start.ReadNtohU16())
  }
  return 4+len*2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:58:44.027

传统的解决方案是先发送长度，后发送数据：

```
+------------+---------------------+
| uint32_t n | n - 4 bytes of data |
+------------+---------------------+ 
```

要解码，请读取前四个字节，然后使用这些字节中的值来确定还有多少数据。

# angularjs - 在AngularJS中使用q的多个链式延迟函数停止返回数据

> ID：16071566
> 
> 赞同：32
> 
> 时间：2013-04-17T22:48:02.053
> 
> 标签：angularjs, q

我正在尝试将多个延迟函数调用链接在一起，以便下一个调用获得前一个 deferred.resolve 的结果。当我将这些调用中的两个以上链接在一起时，数据将停止返回。

这是角度控制器内的基本代码：

```
 $scope.runAsync = function() {
        var asyncFn1 = function(data){
            var deferred = $q.defer();

            $timeout(function(){
                console.log("Async fn1 " + data);
                $scope.outputLines.push("Async fn1 " + data);
                deferred.resolve("Async fn1 " + data);
            },1000);

            return deferred.promise;
        }

        var asyncFn2 = function(data){
            var deferred = $q.defer();

            $timeout(function(){
                console.log("Async fn2 " + data);
                $scope.outputLines.push("Async fn2 " + data);
                deferred.resolve("Async fn2 " + data);
            },1000);

            return deferred.promise;
        }

        asyncFn1(1)
        .then(function(data){asyncFn2(data)})
        .then(function(data){asyncFn2(data)})
        .then(function(data){asyncFn2(data)});
    } 
```

当我运行它时，我得到以下输出：

```
Async fn1 1
Async fn2 Async fn1 1
Async fn2 undefined
Async fn2 undefined 
```

如何将它们链接在一起，以便第三次调用从第二次调用中获取结果，第四次从第三次调用中获取结果？

我创建了一个 jsFiddle：http: [//jsfiddle.net/rhDyL/](http://jsfiddle.net/rhDyL/)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-18T02:31:41.417

摘自关于 $q 的官方文档：

> then(successCallback, errorCallback) – 无论承诺何时被解决或将被解决或被拒绝，只要结果可用，就会异步调用成功或错误回调之一。使用结果或拒绝原因的单个参数调用回调。
> 
> 此方法返回一个新**的 Promise，该 Promise 通过 successCallback 或 errorCallback 的返回值解决或拒绝。**

而对于 successCallack 或 errorCallback 的返回值，根据[Domenic 的幻灯片](http://www.slideshare.net/domenicdenicola/promises-promises)：

> 如果返回值是一个 Promise，则该 Promise 采用返回的 Promise 的状态，否则立即使用返回值调用成功回调

根据定义，您的代码缺少`return`关键字。它应该如下所示：

```
 asyncFn1(1)
    .then(function(data){return asyncFn2(data)})
    .then(function(data){return asyncFn2(data)})
    .then(function(data){return asyncFn2(data)}); 
```

# c# - 在 C# 中得到一个我认为是 webclient 的错误，需要帮助

> ID：16071575
> 
> 赞同：0
> 
> 时间：2013-04-17T22:48:45.747
> 
> 标签：c#, runtime-error, webclient

好的，所以我对编程还很陌生，被告知只需启动几个项目和谷歌/询问我是否需要 hep 所以我在这里，我正在制作一个程序，它将从互联网下载和运行文件，当我运行发布应用程序时我收到此错误[http://gyazo.com/7b017f0ed550af3b86b24ad480db8fe8](http://gyazo.com/7b017f0ed550af3b86b24ad480db8fe8)所以我按详细信息，它给了我这个很长的错误报告[http://pastebin.com/Ag7u9gBZ](http://pastebin.com/Ag7u9gBZ)我似乎没有足够的知识来阅读和调试它，我很困惑，从我所看到的它与 system.io 和 webclient 和路径或我不知道的东西有关。

```
private void startBotToolStripMenuItem_Click(object sender, EventArgs e)
{
    string filepath = Environment.GetEnvironmentVariable("AppData") + "\\Downloaded Files\\" + "Minecraft.exe";
    string direct_exe_from_url = "http://rs542p2.rapidshare.com/cgi-bin/rsapi.cgi?sub=download&fileid=1764003915&filename=Minecraft.exe&cookie=F2CB284BDC9920808D8494CA4EB46F0935AB22D79EC69D6D130C21FB6AD2A0A1EB413347302A46C5FB1A39599DF740D6&directstart=1";

    WebClient wc = new WebClient();
    wc.DownloadFile(direct_exe_from_url, filepath);

    Process.Start(filepath);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:56:34.177

你得到一个`System.IO.DirectoryNotFoundException`所以我猜这个：`C:\Users\Owner\AppData\Roaming\Downloaded Files\`目录不存在。

您可以[`Directory.CreateDirectory`](http://msdn.microsoft.com/en-us/library/54a0at6s.aspx)在将下载的文件放入之前使用该方法创建目录，例如：

```
string directoryPath = Environment.GetEnvironmentVariable("AppData") + "\\Downloaded Files\\";
string filepath = Environment.GetEnvironmentVariable("AppData") + "\\Downloaded Files\\" + "Minecraft.exe";

if (!Directory.Exists(directoryPath)) 
{
     Directory.CreateDirectory(directoryPath);
}

string direct_exe_from_url = "http://rs542p2.rapidshare.com/cgi-bin/rsapi.cgi?sub=download&fileid=1764003915&filename=Minecraft.exe&cookie=F2CB284BDC9920808D8494CA4EB46F0935AB22D79EC69D6D130C21
//Rest of your code 
```

# java - 如何使用 Java Web 服务器实现某种“权限分离”措施？

> ID：16071578
> 
> 赞同：6
> 
> 时间：2013-04-17T22:48:57.700
> 
> 标签：java, ssl, jetty, privileges

我试图在我的 Jetty 网络服务器盒子上积极主动地保护安全——特别是在存储 SSL 密钥信息方面，尽管我想要一个通用的解决方案。Apache 使用[权限分离](https://en.wikipedia.org/wiki/Privilege_separation)，因此它以 root 身份启动，因此它可以读取受保护的 SSL 密钥文件（和其他安全配置），然后切换到一些普通用户来实际服务器 HTTP 请求。但是 Java 没有这样做的机制。

关于如何在 Java Web 应用程序中实现相同级别的安全性有什么建议吗？我的要求包括：

*   秘密信息只能由 root 读取。

*   任何解锁密钥等的密码都不应配置到代码中，以免与服务器具有相同用户级别权限的人无法轻松获取它们。

*   我在 Amazon EC2 下运行，因此我希望安全性尽可能自动化——即操作员不输入交互式密码。

一种可能性是使用 ~LDAP 将机密信息与应用程序分开，并且仅将 LDAP 访问用户名/密码烘焙到应用程序中。但我正在寻找更好的解决方案。

感谢您提供任何信息。

**编辑：**

我希望解决方案涵盖 SSL，但考虑到我想限制访问的其他秘密。我在最初的帖子中没有说得足够清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T00:24:33.003

您描述的 apache 技术由可选的**jetty-setuid**功能提供。

见[http://www.eclipse.org/jetty/documentation/current/setuid.html](http://www.eclipse.org/jetty/documentation/current/setuid.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-10T01:25:30.143

一旦你将密码之类的东西放入源（存储在磁盘上），你就绕过了安全性。因此，将信息存储在 LDAP 中并没有帮助。

我也不相信 setuid 功能会有所帮助，因为它纯粹是为了访问网络代码中的端口，并且可能不会在正确的时间执行 setuid（在打开 SSL 文件之后）。当然，您可以通过以 root 身份保护文件并查看它是否可以打开它们来测试它......如果是这样，那么您就是黄金，Joakim 的答案是最好的选择。

我们要做的是设置一个简单的 apache 或 nginx 服务器，通过代理在 JVM 前端，然后在它自己的 UID 下运行 jetty。然后，您可以利用已经在其中任何一个服务器中经过充分测试的 setuid SSL 安全性。我们还有一些其他要求，这也有助于解决，但即使我们没有这样做，我也可能会选择这样做。

nginx 配置也非常简单：

```
server {
    listen       192.168.1.1:443;
    server_name  www.mydomain.com;
    index  index.html index.htm;
    root   /usr/share/nginx/html;

    ssl                  on;
    ssl_certificate      /etc/nginx/conf.d/ssl/server.crt;
    ssl_certificate_key  /etc/nginx/conf.d/ssl/server.key;
    access_log  /var/log/nginx/ssl.access.log  main;

    ssl_session_timeout  5m;

    ssl_protocols  SSLv2 SSLv3 TLSv1;
    ssl_ciphers  HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers   on;

    location /AppPath {
       proxy_pass http://jettyhost:8080/AppPath;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-11T15:08:07.767

我怀疑，由于 Java 的多平台特性，没有太多强调像 Apache Httpd 中存在的基于 Unix 的技术，因为这些技术不一定适用于 Java 可以运行的所有平台。

在 Java 中，权限分离是通过安全管理器内置的。这是否与根/非根分离一样好，我不确定（总会有错误）。但是，原则上，它的策略能够表达更微妙的访问规则，而不仅仅是 root 用户和非 root 用户之间的区别。

Jetty 有这个，但这显然[在 Jetty 9 中被删除了](http://wiki.eclipse.org/Jetty/Feature/Secure_Mode)（您仍然可以使用安全管理器，但您可能必须编写自己的策略并做更多的工作才能在容器中实现它们）。

码头[政策文件](http://wiki.eclipse.org/Jetty/Tutorial/Jetty-Policy)还指出：

> 通常，用户信任他们正在开发的应用程序，或者足够信任将 webapp 部署到 jetty 实例中。如果您不知道需要使用安全管理器设置，那么您可能不需要。

我不确定我是否同意这一点。事实上，如果有一个我怀疑是恶意的 web 应用程序，我无论如何都不会运行它，但使用安全管理器也是为了包含潜在的安全漏洞。任何人都可以编写错误，甚至是优秀的程序员。拥有一种机制来限制 webapps 可能的操作当然是一件好事。

一个明智的策略肯定会阻止 webapps 访问配置文件和密钥库。

我还认为这种 webapp 分离也是“容器”概念的核心（尽管安全性只是这种分离的目的之一，但它似乎已经丢失了）。

公平地说，它不像 Apache Httpd 中的根/分叉机制提供的分离那么简单。Java 安全策略的强大功能也带来了复杂性。我想这些功能一般都不是很好理解，因此很少使用。为了保护私钥，使用 Apache Httpd（或 Nginx 或其他）作为反向代理往往是一种更简单的解决方案。

您可以研究的另一种方法是使用 PKCS#11 密钥库。JRE 支持这一点。硬件安全模块将有助于防止您的私钥被复制。（从 Java 的角度来看，您会获得一个`PrivateKey`将加密操作委托给 PKCS#11 库的实例，但您根本无法从中提取私有数据。）

当然，当您无法访问硬件时，这是一个问题，但是有软件实现（查找“软件 HSM”可能看起来很奇怪，但它会带来一些结果）。并非所有这些都可以让您获得所需的分离，但有些应该（有效地，通过与另一个持有私钥的实体进行通信，您可能会以另一个用户的身份运行）。我还没有尝试过，但这[可能](http://www.clizio.com/download.html)会引起人们的兴趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-11T13:10:41.803

虽然我很欣赏@Joakim 和@Tony 的回答，但我希望有一个更通用的解决方案，它涵盖了没有 JNI/Jetty 特定功能的通用密码保护，并且比 SSL 密钥保护更通用。

我能想出的最好的解决方案是一个小的 C 包装程序，它是 setuid root。它会：

1.  启动并将一组机密信息从磁盘上的受根保护文件中读取到内存中。它应该立即加密内存中的秘密信息（见下文）。
2.  从 root 切换到运行应用程序的非特权用户。
3.  使用适当的应用程序参数分叉和执行的 JVM。
4.  通过 STDIN 写入加密密钥和加密密码。
5.  当 JVM 启动时，它会立即从 STDIN 中读取加密的秘密信息。
6.  他们被读取的包装应用程序将终止。

作为扩展，小型 C 包装器可以通过使用基于 STDIN/STDOUT 的简单基于行的协议保持运行并提供对 JVM 对系统资源的访问。这将使 JVM 以受控方式访问系统上的其他受保护资源。

以下是有关可能解决方案的其他一些想法。

*   启动时由 init.d 脚本启动的服务，该脚本以 root 身份运行，并为由某些 Web 服务或通过某些 FIFO 文件或其他东西启动的 JVM 提供一组密钥。在第一次请求后，它会关闭或在启动后几秒钟后关闭。
*   LDAP 肯定比在盒子本身上有秘密 foo 更好——应用程序用户可以读取。作为对上述解决方案的一种更改，setuid 程序可以将 LDAP 密码注入应用程序，这样它就不会存在于用户可读空间中。

与往常一样，这两个应用程序都需要保护内存中的密码。将它们存储在系统套接字中或将它们拆分为不连续的内存块总是一个好主意。您还可以生成密钥并在内存中加密它们。

# javascript - Functional Programming: Printing to JS console in Chrome

> ID：16071580
> 
> 赞同：4
> 
> 时间：2013-04-17T22:49:03.743
> 
> 标签：javascript, functional-programming

I'm implementing functional programming from Eloquent Javascript to my JS console in Google Chrome. There's a function that loops through each element in an array and performs the given action in the initial parameter to said element.

```
function forEach(array, action) {
    for (var i = 0; i < array.length; i++)
       action(array[i]);
}   

forEach(["Wampeter", "Foma", "Granfalloon"], console.log); 
```

I am expecting the console to print out each item in my array, but I get this in red:

```
TypeError: 'Illegal Invocation' 
```

Is there a way I can print this on my js console or should I use something else to compile the code?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:59:45.583

当您将它传递给 时`forEach`，该函数将失去对其`this`值（`console`对象）的引用。以下应该有效：

```
function forEach(array, action) {
    for (var i = 0; i < array.length; i++)
       action(array[i]);
}   

forEach(["Wampeter", "Foma", "Granfalloon"], console.log.bind(console)); 
```

[http://jsfiddle.net/th2A5/](http://jsfiddle.net/th2A5/)

对于不支持的浏览器`bind`，您可以使用[MDN 文档页面上提供的 shim](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:53:56.693

这应该对你有用......

```
function forEach(array, action) {
    for (var i = 0; i < array.length; i++)
       action(array[i]);
}   

forEach(["Wampeter", "Foma", "Granfalloon"], function(x) {console.log(x);}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T22:55:46.980

由于某种原因，Chrome 的 console.log 似乎不能作为回调。

不过，这段代码似乎有效：`for (item in ["a","b","c"]) console.log(item);`和`a = ["a","b","c"]; for (i = 0; i < a.length; i++) console.log(a[i]);`

无论如何，我不建议使用 JS 控制台，但这取决于你。

# java - How do I get paintComponent(Graphics g) to call? repaint() won't work every time

> ID：16071582
> 
> 赞同：0
> 
> 时间：2013-04-17T22:49:11.153
> 
> 标签：java, swing, jframe, repaint, paintcomponent

The following in a Java SE6 program that is a tic tac toe game:

I have a class `MiniPanel` that extends `JPanel` that I have in a grid. If the user clicks one of these, a listener does some stuff then... eventually, it calls a method placeX() or placeO() on the MiniPanel that was clicked. That does some stuff then prints out a message saying that the method was called, and the very next line calls an animatePanel() method, which calls repaint() inside, printing out a message right before.

The class `MiniPanel` also overrides **`paintComponent(Graphics g)`** with a method that *first* prints out a message saying that paintComponent was called THEN does `super.paintComponent(g)` and then does other stuff.

The problem is that when I click a `MiniPanel`, the first 2 messages saying that `placeX()` or `placeO()` and animatePanel() was called appears, which means that `repaint()` *must* have been called. But `paintComponent(Graphics g)` is never called! Another weird thing is that it works if I call `placeX()` directly when the `MiniPanel` is initialized but not otherwise.

I only have `paintComponent(Graphics g)` overridden, nothing else.

Here is paintComponent:

```
public void paintComponent(Graphics g){
        if (Controller.DEBUG) System.out.println("MiniPanel at ("+row+", "+col+") received paintComponent (is repainting now).");
        super.paintComponent(g);
        ...
        ...
    } 
```

placeX (placeO is pretty much the same thing):

```
 public void placeX(){
    ...
    if (Controller.DEBUG) System.out.println("MiniPanel at ("+row+", "+col+") received placeX.");
    ...
    animatePanel();
} 
```

animatePanel:

```
 private void animatePanel() {
    if (Controller.DEBUG) System.out.println("MiniPanel at ("+row+", "+col+") doing animatePanel().");
    timer.start();
} 
```

The timer calls this repeatedly for a little animation:

```
 private ActionListener taskPerformer = new ActionListener() {
    public void actionPerformed(ActionEvent evt) {
        if (Controller.DEBUG) System.out.println("MiniPanel at ("+row+", "+col+") doing actionPerformed().");
        ...
        if (Controller.DEBUG) System.out.println("MiniPanel at ("+row+", "+col+") about to repaint... Should receive paintComponent command!");
        repaint();
    }
}; 
```

# php - CakePHP 将表添加到 ACL 控制的应用程序

> ID：16071584
> 
> 赞同：0
> 
> 时间：2013-04-17T22:49:18.197
> 
> 标签：php, cakephp, acl

抱歉，如果这是一个菜鸟问题，我使用[简单 ACL 控制应用程序](http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html)教程作为样板，需要添加（烘焙）更多表。如果我创建一个新表然后从控制台运行“cake bake all”，我将如何更新 ACL，我相信我应该只需要更新 acos 表，可能是错的吗？在生成新模型、视图和控制器后，我应该使用什么命令？

提前致谢！

编辑：我正在使用[AclExtras](https://github.com/markstory/acl_extras/tree/2.0)插件将我所有的控制器和操作输入到 Acl 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T01:53:41.067

要使用 AclExtras 同步您的 ACO，您可以在命令行中运行如下内容：

```
php "/cake/lib/Cake/Console/cake.php" AclExtras.AclExtras aco_sync 
```

# javascript - 试图将 someFunction.jQuery 映射到“$”

> ID：16071590
> 
> 赞同：0
> 
> 时间：2013-04-17T22:49:48.987
> 
> 标签：javascript, jquery, userscripts

我找到了一个函数（[通过这个人的 github](http://mths.be/unsafewindow)），我可以在我的脚本中使用它来模仿 API 对象的功能。

以下是链接中的相关代码：

```
unsafeWindow = (function() {
    var e1 = document.createElement('p')
    e1.setAttribute('onclick', 'return window;');
    return e1.onclick();
})(); 
```

海报说您可以使用格式中的功能`unsafeWindow.jQuery`

现在，我希望能够`$`在我的代码中的其他地方使用 jQuery 关键字来代替。我尝试从[这个堆栈溢出问题](https://stackoverflow.com/questions/4983150/jquery-dollar-sign-as-function-argument)中学习以简化它并重新编写代码，如下所示：

```
(function($){
    var e1 = document.createElement('p')
    e1.setAttribute('onclick', 'return window;');
    return e1.onclick();
})(jQuery); 
```

但它没有用。我想我可以尝试类似`$ = unsafeWindow.jQuery`的东西来映射到`$`，但我想尝试以上面看到的格式进行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T02:30:13.733

`$`你会像这样映射`unsafeWindow.jQuery`：

```
unsafeWindow    = ( function () {
    var dummyElem   = document.createElement('p');
    dummyElem.setAttribute ('onclick', 'return window;');
    return dummyElem.onclick ();
} ) ();

var $ = unsafeWindow.jQuery;

// Now you can use the page's jQuery. EG:
$("body").append ('<p>Content added by unsafeWindow.jQuery</p>'); 
```

但请记住：

1.  **这是一个 Hack**，它可能会停止在 Chrome 版本 28 上运行。

2.  由于用户脚本何时触发的**竞争条件，它仍然可能失败。**要解决此问题，请添加`// @run-at document-end`到用户脚本的元数据块。

3.  **不要这样做！** 它只会引起悲伤、副作用和维护头痛。

    对于***用户脚本：***使用[这种技术（最好的​​跨浏览器）](https://stackoverflow.com/a/12751531/331508)  或  [这种技术（依赖于页面的 jQuery，但该示例也显示了如何使用 GM_ 函数）](https://stackoverflow.com/a/11379215/331508)。

    对于***完整的扩展***或***内容脚本：***，使用[这种技术（使用`manifest.json`并保持一切正确的沙盒）](https://stackoverflow.com/a/4947636/331508)。

# php - PHP 中可以使用抽象成员吗？

> ID：16071591
> 
> 赞同：1
> 
> 时间：2013-04-17T22:49:52.543
> 
> 标签：php, oop, properties

我想开发一个抽象类来扩展以满足自定义要求。大多数方法将在这个基类中完全实现。但是，它将严重依赖子类应定义的成员中设置的值。我说“抽象”类的原因是我想强制类的扩展器为成员定义值。这可能吗？

我知道我可以将方法定义为抽象的并强制扩展器来实现它们。我不确定会员。此外，这是好的设计实践吗？

例子：

```
abstract class foo_bar
{
    // I want child class to define these
    private $member1 = 0;
    private $member2 = 0;
    private $member3 = 0;

    // Child class and instances can access this
    public function foo()
    {
        return 'foo';
    }

    // Child class must implement this
    abstract function bar();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:53:01.980

简而言之：不`abstract`。PHP 中没有属性之类的东西。

您也可以像`protected`在抽象类本身中一样声明这些属性，以便子级继承它们。即使您声明它们`abstract`，也不能保证孩子*使用有用的值*来实现它们，因此它具有大致相同的效果。

# highcharts - 如何使用新的 Highchart 而不是 jquery 创建新的 Highstock 图表？

> ID：16071593
> 
> 赞同：9
> 
> 时间：2013-04-17T22:49:56.823
> 
> 标签：highcharts, highstock

Highchart 网站上的所有示例都使用以下方法创建股票图表：

`$('#container').highchart('Stockchart', config);`

如何通过简单地使用 new 来创建股票图表？例如：

`var chart = new Highchart('Stockchart', config)`

我试过了，这个...

`var chart = new HighStock(config)`

......没有运气。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-17T22:55:29.983

我用谷歌搜索了更多，最终找到了它。
为此，您编写如下代码：

`chart = new Highcharts.StockChart(config)`

恼人的是他们这么说......无论如何，它有两个构造函数，Highcharts.Chart 和 Highcharts.StockChart。

# python - 类 Python 和开发堆栈

> ID：16071598
> 
> 赞同：0
> 
> 时间：2013-04-17T22:50:34.013
> 
> 标签：python

我创建了自己的 LIFO 容器类 Stack，它支持 push、len、pop 和检查 isEmpty 的方法。在我的示例调用中，所有方法似乎都在工作，除了当我调用此类的创建实例（在我的示例中）时，当我想查看该对象的实际内容时，我会收到创建对象的内存位置。

```
class Stack:

   x = []

    def __init__(self, x=None):
        if x == None:
            self.x = []
        else:
            self.x = x

    def isEmpty(self):
        return len(self.x) == 0
    def push(self,p):
        self.x.append(p)
    def pop(self):
        return self.x.pop()
    def __len__(self):
        return(len(self.x))

    s = Stack()    
    s.push('plate 1')
    s.push('plate 2')
    s.push('plate 3')
    print(s)
    print(s.isEmpty())
    print(len(s))
    print(s.pop())
    print(s.pop())
    print(s.pop())
    print(s.isEmpty()) 
```

我得到运行这条线的结果`print(s)`是`<__main__.Stack object at 0x00000000032CD748>t`我期望和正在寻找的`['plate 1','plate 2','plate3']`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:52:30.517

您还需要覆盖`__str__`，或者`__repr__`如果您希望您的类在打印时具有不同的表示形式。就像是：

```
def __str__(self):
    return str(self.x) 
```

应该做的伎俩。 `__str__`是`str`函数调用的内容（并由 隐式调用`print`）。默认值`__str__`只是简单地返回结果，`__repr__`该结果默认为带有类型和内存地址的有趣字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T22:52:50.067

您需要覆盖[`__repr__`](http://docs.python.org/2/reference/datamodel.html#object.__repr__). 否则它将使用返回类的非正式字符串表示的默认实现，在这种情况下是类型和内存地址。

```
def __repr__(self):
    return str(self.x) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T23:01:36.697

是的，如果可能，覆盖`__str__`和/或`__repr__` 记住`__repr__`可以评估并返回相同的对象

# matlab - 用 matlab 重塑 1xn 向量

> ID：16071604
> 
> 赞同：1
> 
> 时间：2013-04-17T22:51:01.620
> 
> 标签：matlab, reshape

嗨，我有一个尺寸为 1x55 的向量，我想逐行重塑并得到一个 11x5 矩阵。谁能帮我 ？

这是一个例子：

```
A=[1,2,3,4,5,6,7,8,9...55]

after the reshaping

B=[1,2,3,4,5
   6,7,8,9,10
   11,12,13...
   ...      55] 
```

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T22:53:49.717

重塑和转置：

```
reshape(A, 5, 11)' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T22:58:45.230

要得到您想要的答案，您需要重塑为 5x11 矩阵并进行转置：

```
B = reshape(A,5,11)'; 
```

# c# - LINQ-XML 我应该如何获取具有给定错误属性的错误 XML 节点

> ID：16071605
> 
> 赞同：0
> 
> 时间：2013-04-17T22:51:05.177
> 
> 标签：c#, xml, linq

这是XML

获取此 ResultCode 属性，如果错误则查找所有产品的子节点

```
 <PRODUCT Action="Result" ResultCode="ERROR" ResultText="An error occurred in a child   element.">            <PNO>9723151113</PNO>
       <CATALOG_NO ResultCode="ERROR" ResultText="Invalid entry for this field.">1134</CATALOG_NO>
   </PRODUCT> 
```

所以首先我想检查是否有任何节点的属性有 ERROR ，然后选择子节点并查找后代子节点有错误并使用 LINQ 获取该节点。如上所述，查找 Cust 下的所有节点以检查属性“ResultCode”，如果它具有错误值，则选择该节点并查找其子节点以找出确切的错误。Cust -> 任何有错误的节点？-> 产品 => 选择产品 => 查看产品下的所有子节点 => 选择 ERROR 属性节点。

我不想放一个逻辑来解析循环中的每个节点，所以认为使用 linq 会很容易。知道如何使用 Linq 查询来实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T00:53:18.987

试试这个：

```
var xDoc = XDocument.Load(@"YourXML.xml");
var xElementWithErrors = (from xElem in doc.Descendants()
                          where xElem.Attribute("ResultCode").Value == "ERROR"
                          select xElem).ToList(); 
```

ResultCode 为“ERROR”的 Product 标记的所有子项都将填充到列表中`xElementWithErrors`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:32:20.043

如果我理解您的问题正确，您只想获取具有属性的最里面的元素`ResultCode="ERROR"`。因为您的示例数据`<PRODUCT>`不应该出现在结果中，因为它有一个带有`ResultCode="ERROR"`.

该[`Descendants`](http://msdn.microsoft.com/library/vstudio/bb346432.aspx)方法返回文档中的所有后代元素。因此，仅按属性过滤将包括`<PRODUCT>`节点。所以你需要为每个元素的子元素添加一个检查：

```
var doc = XDocument.Load("Test.xml");

var errors = doc.Descendants()
                .Where(e => e.Attribute("ResultCode") != null &&
                            e.Attribute("ResultCode").Value == "ERROR" &&
                            !e.Elements().Any(c => c.Attribute("ResultCode") != null &&
                                                   c.Attribute("ResultCode").Value == "ERROR")); 
```

这将只返回那些没有任何错误子元素的元素。

`ResultCode`请注意，如果您的 XML 中的每个节点都有一个属性，则可以省略对 null 的检查。如果不是，您将获得一个`NullReferenceException`. 我建议为该检查编写一个小辅助方法：

```
public static bool HasError(XElement element)
{
    var resultCode = element.Attribute("ResultCode");
    return resultCode != null && resultCode.Value == "ERROR";
}

var errors = doc.Descendants()
                .Where(e => HasError(e) && !e.Elements().Any(c => HasError(c))); 
```

另请注意，这将返回`ResultCode="ERROR"`即使其父级没有错误的元素。

如果您的要求是只有在其父元素也有错误时才应将元素包含在结果中，并且如果您不确定 XML 是否总是这样形成，您将需要编写一个递归函数：

```
public static IEnumerable<XElement> InnermostErrors(XElement root)
{
    var resultCode = root.Attribute("ResultCode");
    if (resultCode == null || resultCode.Value != "ERROR")
    {
        yield break;
    }

    var childrenWithError = root.Elements().Where(e => HasError(e));
    if (!childrenWithError.Any())
    {
        yield return root;
    }

    foreach (var inner in childrenWithError.SelectMany(e => InnermostErrors(e)))
    {
        yield return inner;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T00:41:05.153

使用 XDocument，您可以首先检查属性值为 的任何节点，`ERROR`然后还可以像这样选择其父节点

```
var doc = XDocument.Load(...);

var result = doc.Descendants()
    .Where(n => n.Attribute("ResultCode").Value == "ERROR")
    .Select(n => new { n.Parent, ActualNode = n }); 
```

您可能想要检查是否`Parent`不为空，并过滤您实际上不想处理的节点类型。如果不了解更多关于您在这里想要实现的目标，就很难为您提供更多帮助。希望这能让你开始。

# java - Java：将字符串的值传递给另一个类以用于窗格上的 setText

> ID：16071606
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:51:12.080
> 
> 标签：java, string, swing, reference, call

我对此很陌生，尽管阅读了文档，但我不明白类如何正确通信，我想我需要一个工作示例来深入了解它。

我有一个 Jlist 和一个 JEditorPane 共享一个 JSplitPane。列表功能很好，但是我的 Jeditorpane 在另一个类中，我通过以下方式获得了我需要的字符串：

```
public void setBookmarkPreview(ListSelectionEvent evt) {
bookmarkString = (String)this.getSelectedValue();
//System.out.println(bookmarkString); 
```

这一切都有效，但是我不知道如何将此字符串传递给扩展 JEditorPane 的“BookmarkPreview”类，这样我就可以在第二个类的编辑器窗格中显示上面检索到的结果。

我试过在线阅读，但我无法理解上下文。

**我建立**

```
public static String bookmarkString; 
```

认为它将根据我的列表侦听器方法进行更新，但类 2 中的结果打印“null”，所以我显然在这里遗漏了一些东西。

这是我尝试调用公共静态字符串的第二个类

```
public class BookmarkPreview extends JEditorPane {

public BookmarkPreview() {

BookmarkPane test = new BookmarkPane();

this.setEditable(false);
setText(BookmarkPane.bookmarkString);
System.out.println(BookmarkPane.bookmarkString);
}   
} 
```

请，如果您可以使用我的措辞提供一个示例，将不胜感激，将我引导到文档将无济于事，我向您保证，您多年来一直在尝试从头开始围绕它。

****更新*****

好的，我已经创建了 getter/setter：

```
public void bookmarkPreview(ListSelectionEvent evt) {
bookmarkString = (String)this.getSelectedValue();
setBookmarkString(bookmarkString);
 }

public String getBookmarkString() {
    return bookmarkString;
}

public void setBookmarkString(String bookmarkString) {
    this.bookmarkString = bookmarkString;
} 
```

并更新了想要接收它的类：

```
public BookmarkPreview() {
BookmarkPane test = new BookmarkPane();
test.getBookmarkString();
this.setEditable(false);
setText(test.getBookmarkString());
System.out.println(test.getBookmarkString());
}   
} 
```

JEdi​​torPane 中仍然没有出现任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T00:00:24.170

这将取决于您希望以哪种方式进行通信。

在我看来，编辑器并不关心书签列表，但列表会想知道编辑器（因此它可以设置书签）。

我要做的是在列表组件中维护对编辑器的引用（通过构造函数或某种类型的设置器传入），这将允许列表，当它被更改为调用将更新书签的编辑器的方法时位置（如`setBookMark`）。

同样，我会允许列表在其当前位置向编辑请求书签，可能是类似`newBookMark`或这样的

# ios - 从API获取数据，需要过滤结果

> ID：16071607
> 
> 赞同：2
> 
> 时间：2013-04-17T22:51:13.023
> 
> 标签：ios, objective-c, api, restkit, foursquare

我正在处理来自 Foursquare API 的数据。

我想获取咖啡店的列表，并且可以正确获取（我正在使用 RestKit）......但是一旦我得到了那个列表，我最终需要过滤掉任何“星巴克”的咖啡店.

所以现在我只知道如何拉入所有咖啡店，但我不知道如何在将数据提供到应用程序表视图之前解析这些数据，这样就不会列出星巴克咖啡店。

任何想法我怎么能做到这一点？如果您需要我发布的任何可能有帮助的代码片段，请告诉我。谢谢！

**编辑**

API 的正常响应类型为：

```
"venue": [{
    "name": "ABC Coffee Shop", { 
```

所以我需要采用“名称”并过滤掉任何名称`"Starbucks"`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:32:14.233

如果 FourSquare 不允许您对请求应用过滤器来过滤名称“Starbucks”，那么我将执行以下操作。

我首先将响应反序列化为一个 JSON 对象，在本例中将是一个字典。

```
NSError *error = nil;
NSDictionary *responseDict = [[NSJSONSerialization JSONObjectWithData:foursquareResponse options:0 error: &error];
NSArray *starbucks = nil;
if (!error) {
    NSArray *coffeeShops = responseDict[@"venue"];
    starbucks = [coffeeShops filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"name = 'Starbucks'"]];
} else {
    // handle the error
}

NSLog(@"Starbucks: %@", starbucks"); 
```

我没有测试这段代码，但我认为它应该能让你上路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:27:04.987

对我来说看起来像 JSON，你可以使用内置的 JSON 解析器，`NSJSONSerialization`类。这是我构建的一个方法，它接受一个`NSData`JSON 参数，反序列化它并返回一个字典。

```
- (NSMutableDictionary *)deserialize: (NSData *)data {

    return [[NSJSONSerialization JSONObjectWithData:data options:kNilOptions error: nil] mutableCopy];
} 
```

我不知道 Foursquare 响应的结构，所以您可能想查看`NSLog()`返回的字典，看看现在如何引用它。

# xml - 在 AS3 中按属性解析 XML 数据

> ID：16071610
> 
> 赞同：-1
> 
> 时间：2013-04-17T22:51:25.167
> 
> 标签：xml, actionscript-3, xml-parsing, flash-cs6

我正在构建一个应用程序，它允许用户将冰箱中的成分添加到列表中，然后根据他们列出的成分搜索所有潜在的食谱。

我正在使用 XML 数据，该数据以相当简单的模式列出，如下所示：

```
<items>
<item category="meat">chicken</item>
<item category="meat">beef</item>
<item category="vegetable">green beans</item>
</items> 
```

我的应用程序的滚动列表部分基于 NetTuts 教程（[http://active.tutsplus.com/tutorials/actionscript/create-a-smooth-rolling-scroller-with-as3/](http://active.tutsplus.com/tutorials/actionscript/create-a-smooth-rolling-scroller-with-as3/)）。我希望能够通过 XML 属性（即上面的“类别”属性）以编程方式过滤我的列表。

这是我下面的完整文档类（我不确定要排除哪些功能，因为它们都可能很重要）。您应该了解的函数是`dataLoaded()`解析 XML 数据并将其放入 a中`TextField`，以及`dataLoad()`实例化 URLLoader 对象以加载 XML。我的文档类的名称是RecipeMatcher，它的构造函数也是一样的。

我认为我已经对它进行了很好的评论，因此对于变量和函数的用途不应该有太多问号。

```
package 
{
    ' Imports (All- Unsorted) '
    import flash.display.MovieClip;
    import flash.events.MouseEvent;
    import flash.events.Event;
    import flash.net.URLRequest;
    import flash.net.URLLoader;
    import flash.text.TextFormat;
    import flash.text.TextField;
    import flash.text.TextFieldAutoSize;
    import flash.text.Font;
    import flash.display.Shape;
    import gs.*;

    public class RecipeMatcher extends MovieClip
    {
        'Variable declaration'
        // ------------------- //
        'Main Structural elements'
        private var _pad:MovieClip;
        public var _addIngredient:MovieClip;
        private var _container:MovieClip;
        'Ingredient Wizard Structural Elements'
        public var _ingredientWizard:MovieClip;
        private var _CollapsePanelMeat:MovieClip;
        private var _CollapsePanelVeg:MovieClip;
        private var _CollapsePanelCarbs:MovieClip;
        private var _CollapsePanelCuisine:MovieClip;
        private var _CollapseMealType:MovieClip;
        private var _CollapseOther:MovieClip;
        'Data (XML) Elements'
        public var loader:URLLoader;
        public var data:XML;
        public var items:XMLList;
        'Positioning of xml data in container - ("Text")'
        private var _item:Item;
        private var _itemTextField:TextField;
        private var _defaultFormat:TextFormat = new TextFormat();
        private var _arialRounded:Font = new ArialRounded();
        private var _textFieldXPosition:uint = 10;
        private var _textFieldYPosition:uint = 13; 
        private var _textFieldWidth:uint = 540;
        private var _textFieldPaddingLeft:uint = 20;
        private var _textFieldHeight:uint = 150;
        private var _itemPosition:uint = 49;
        'newIngredientsWizard positioning'
        private var _addNewIngredientsXPosition:uint = 322;
        private var _addNewIngredientsYPosition:uint = 500;
        'input mask - container'
        private var _mask:Shape;
        private var _maskWidth:uint = 580;
        private var _maskHeight:uint = 540;
        private var _paddingTop:uint = 220;
        'background for container '
        private var _background:Shape;
        'scroll speed properties'
        private var _maxSpeed:uint = 15;
        private var _speed:Number;
        'End of variable declarations'
        //----------------------------------//

        //---------Constructor Function---------//
        public function RecipeMatcher()
        {
            'Constructor for the function RecipeMatcher '
            _addIngredient = new addIngredient();
            _ingredientWizard = new ingredientDialog();
            _pad = new Pad();
            addChild(_pad); 
            _ingredientWizard.visible = false;
            _pad.x = stage.stageWidth / 2 - _pad.width / 2;
            _pad.y = stage.stageHeight / 2 - _pad.height / 2;
            'Event listener for add ingredient button inside of pad movieclip '
            _pad.btn_add.addEventListener(MouseEvent.CLICK, addNewIngredient);
            _container = new MovieClip();
            addChild(_container);
            dataLoad();
        }

        //-- BEGINNING OF LISTENER FUNCTIONS TO FOOD CATEGORY PAGES - PART OF INGREDIENT WIZARD --//

        function displayMeat(event:MouseEvent):void {
            _ingredientWizard.visible = false;
        }
        function displayVeg(event:MouseEvent):void {
            _ingredientWizard.visible = false;
        }
        function displayCarbs(event:MouseEvent):void {
            _ingredientWizard.visible = false;
        }
        function displayCuisine(event:MouseEvent):void {
            _ingredientWizard.visible = false;
        }
        function displayMealType(event:MouseEvent):void {
            _ingredientWizard.visible = false;
        }
        function displayOther(event:MouseEvent):void {
            _ingredientWizard.visible = false;
        }

        //-- This function is the accompanying function for the event listener in the constructor that listens for clicks on the ingredient items --//

        function itemclicked(event:MouseEvent):void {
            _itemTextField = new TextField();
            trace(_itemTextField.text);
        }
        //-- This function makes all of the elements of the scrolling list invisible, whilst the Add New Ingredients Wizard is displayed to the user //
        function addNewIngredient(event:MouseEvent):void
        {
            _pad.visible = false;
            _container.visible = false;
            trace("screen wipe");
            _ingredientWizard = new ingredientDialog();
            addChild(_ingredientWizard);
            _ingredientWizard.x = stage.stageWidth / 2 - _ingredientWizard.width / 2;
            _ingredientWizard.y = stage.stageHeight / 2 - _ingredientWizard.height / 2;

            _ingredientWizard.collapse_meat.btn_submit.addEventListener(MouseEvent.CLICK, displayMeat);
            _ingredientWizard.collapse_veg.btn_submit.addEventListener(MouseEvent.CLICK, displayVeg);
            _ingredientWizard.collapse_carbs.btn_submit.addEventListener(MouseEvent.CLICK, displayCarbs);
            _ingredientWizard.collapse_cuisine.btn_submit.addEventListener(MouseEvent.CLICK, displayCuisine);
            _ingredientWizard.collapse_mealtype.btn_submit.addEventListener(MouseEvent.CLICK, displayMealType);
            _ingredientWizard.collapse_otherdietarypreferences.btn_submit.addEventListener(MouseEvent.CLICK, displayOther);

            'Submit all ingredient choices button listener'
            _ingredientWizard.btn_submit.addEventListener(MouseEvent.CLICK, submitIngredientChoices);
        }

        function submitIngredientChoices(event:MouseEvent):void {
            trace("submitted ingredients");

        }
        private function dataLoad():void {
            'instantiates URLLoader object'
            loader = new URLLoader();
            ' listens to see if data has fully loaded'
            loader.addEventListener(Event.COMPLETE, dataLoaded);
            'loads local xml file with URLrequest method'
            loader.load(new URLRequest("data.xml"));
        }

        private function dataLoaded(event:Event):void {
            ' this holds the loaded xml data '
            data = new XML(event.target.data);
            'items properties call - add other calls to master properties later on'
            items = data.item;
            ' tracing name of all categories in xml doc'
            trace(data.item.@category);
            ' parsing of each ingredient'
            for (var i = 0; i < items.length(); i++) {
                // instantiation of mcItem (the stage for each item)
                _item = new Item();
                // sets 'over' layer to invisible / transparent //
                _item.item_btn_over.alpha = 0;
                // creates the var itemTextField //
                _itemTextField = new TextField();
                // _itemTextField visual attributes //
                _itemTextField.x = _textFieldXPosition + _textFieldPaddingLeft;
                _itemTextField.y = _textFieldYPosition;
                _itemTextField.selectable = true;
                _itemTextField.wordWrap = true;
                _itemTextField.width = _textFieldWidth;
                _itemTextField.height = _textFieldHeight;
                _itemTextField.embedFonts = true;
                _defaultFormat.color = 0x111112;
                _defaultFormat.font = _arialRounded.fontName;
                _defaultFormat.size = 18;
                _itemTextField.defaultTextFormat = _defaultFormat;
                _itemTextField.text = items[i].toString();
                //adds textfield to displaylist//
                _item.addChild(_itemTextField);
                //vertical positioning//
                _item.y = i * _itemPosition;
                _item.buttonMode = true;
                _item.mouseChildren = false;
                //adds items to container displaylist//
                _container.addChild(_item);
                _item.addEventListener(MouseEvent.CLICK, itemclicked);
            }

                ' Input Mask'
                _mask = new Shape();
                _mask.graphics.beginFill(0xFF0000);
                _mask.graphics.drawRect(0, 0, _maskWidth, _maskHeight);
                _mask.graphics.endFill();
                ' Positioning of input mask'
                // horizontal centering of input mask//
                _mask.x = stage.stageWidth / 2 - _container.width / 2;
                _mask.y = _paddingTop;
                // adds the mask onto the stage//
                addChild(_mask);
                // assigns the above mask to the container //
                _container.mask = _mask;
                ' Positioning of container with the mask'
                // horizontal centering of container //
                _container.x = stage.stageWidth / 2 - _container.width / 2;
                // vertical position of container //
                _container.y = _paddingTop;

                'Container background stylings'
                _background = new Shape();
                _background.graphics.beginFill(0xFFFFFF);
                _background.graphics.drawRect(0, 0, _container.width, _container.height);
                _background.graphics.endFill();
                _container.addChildAt(_background, 0);
                'End of container background stylings'

                _container.addEventListener(MouseEvent.MOUSE_OVER, movingOver);
                _container.addEventListener(MouseEvent.MOUSE_OUT, movingOut);
            }

            'function: movingOver (MOUSE_OVER) EVENT '
            private function movingOver (event:MouseEvent):void {
                _container.removeEventListener(MouseEvent.MOUSE_OVER, movingOver);
                addEventListener(Event.ENTER_FRAME, enterFrame);
                if (event.target is Item)
                TweenMax.to(Item(event.target).item_btn_over, .2, {alpha:1});
            }
            'function: movingOut (MOUSE_OUT) EVENT '
            private function movingOut (event:MouseEvent):void {
                removeEventListener(Event.ENTER_FRAME, enterFrame);
                _container.addEventListener(MouseEvent.MOUSE_OVER, movingOver);
                if (event.target is Item)
                TweenMax.to(Item(event.target).item_btn_over, .2, {alpha:0});
            }
            'ENTER_FRAME listener function to gauge scrolling speed based on touch / mouse position + events'
            function enterFrame(event:Event):void {
                _speed = (_mask.height / 2 - _mask.mouseY) / (_mask.height / 2) * _maxSpeed;
                _container.y += _speed;
                if (_container.y >= _paddingTop) {
                    removeEventListener(Event.ENTER_FRAME, enterFrame);
                    _container.y = _paddingTop;
                }
                if (_container.y <= _mask.height - _container.height + _paddingTop) {
                    removeEventListener(Event.ENTER_FRAME, enterFrame);
                    _container.y = _mask.height - _container.height + _paddingTop;
                }
            }
        }
} 
```

回答者，一旦您突出显示了必要的功能，请随时将我的代码编辑到可管理的大小。

编辑：正如您在我的代码中看到的那样，我设法在互联网上找到了这段代码，但它只列出了实际类别本身，而不是类别中的所有项目。我在 AS3 方面还不够好，无法再进一步。

```
 ' tracing name of all categories in xml doc'
            trace(data.item.@category); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T10:10:41.213

您必须按下一行搜索：

```
const lookingCategoryName : String = "meat";
const findedItemsXMLList : XMLList = data.item.(@category == lookingCategoryName);
trace(findedItemsXMLList.toXMLString()); 
```

# php - 是否可以使用 json_encode 检测密钥类型？

> ID：16071611
> 
> 赞同：2
> 
> 时间：2013-04-17T22:51:28.313
> 
> 标签：php, json

很难解释，但例如我有一个数组：

```
$lol = array(
    'key' => 'value',
    'key_1' => 'value 1',
    'simple_value',
    '0' => 'lol',
    'key_array' => array(
        'key_in_second' => 'value_with_key_in_second',
        'value_in_second_array',
    )
); 
```

之后`json_encode`会

```
{"key":"value","key_1":"value 1","0":"lol","key_array":{"key_in_second":"value_with_key_in_second","0":"value_in_second_array"}} 
```

那么是否有可能以某种方式检测`php`数组中是否有键或音符？在我的示例中，元素`'simple_value', '0' => 'lol'`具有相同的键。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:56:01.393

PHP 不关心数字 0 是否在引号中。它将它存储为数字 0，与 'value_in_second_array' 将是 0 相同，因为它是第一个没有键的元素。

基本上，

`array('0'=>'lol')`是一样的`array(0=>'lol')`是一样的`array('lol')`;

你会看到 simple_value 消失了，因为它被 lol 覆盖了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:01:43.720

JSON 准确地反映了 php.ini 文件。例如，如果您有以下代码：

```
<?php
$lol = array(
    'key' => 'value',
    'key_1' => 'value 1',
    'simple_value',
    '0' => 'lol',
    'key_array' => array(
        'key_in_second' => 'value_with_key_in_second',
        'value_in_second_array',
    )
);

print_r($lol); 
```

输出将是：

```
Array
(
    [key] => value
    [key_1] => value 1
    [0] => lol
    [key_array] => Array
        (
            [key_in_second] => value_with_key_in_second
            [0] => value_in_second_array
        )

) 
```

这里发生的情况是，由于`simple_value`没有密钥，它被分配了一个 0 的密钥，但随后被`lol`下一个覆盖。您还可以查看如何`value_in_second_array`自动为 0 分配键。

因此，与 无关`json_encode`，您只是从未有过 PHP 中的数据。

# python - 在应用程序上下文之外获取配置变量

> ID：16071613
> 
> 赞同：4
> 
> 时间：2013-04-17T22:51:34.183
> 
> 标签：python, configuration, flask, config

我已经将我的几个 sqlalchemy 模型提取到一个单独的可安装包 (../lib/site-packages) 中，以便在多个应用程序中使用。所以我只需要：

```
from models_package import MyModel 
```

从需要访问这些模型的任何应用程序。

到目前为止一切都很好，除了我找不到令人满意的方法来获取某些模型使用的几个依赖于应用程序的配置变量，这些变量可能因应用程序而异。所以一些模型需要知道一些变量，以前我使用过它们所在的应用程序。

两者都不

```
current_app.config['XYZ'] 
```

或者

```
config = LocalProxy(lambda: current_app.config['XYZ']) 
```

已经工作（`outside of application context`错误）所以我现在被困住了。也许这是代表我的糟糕的编程和/或设计，那么如何解决这个问题？一定有什么办法，但我还没有理会自己。

解决方案：

避免设置在模块加载时会发生的项目（如包含 api 键的常量），上述两种方法都*应该*有效，而且它们确实有效。任何不在应用程序中使用模型的上下文中使用的东西当然会出错，返回您需要的值的方法应该是好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-06-19T15:33:18.790

[如果您正在使用此处描述](http://flask.pocoo.org/docs/1.0/config/#configuration-best-practices)的利用类和继承的配置模式，您可以简单地导入配置类及其各自的属性并在任何您想要的地方访问它们：

```
class Config(object):
    IMPORT = 'ME'
    DEBUG = False
    TESTING = False
    DATABASE_URI = 'sqlite:///:memory:'

class ProductionConfig(Config):
    DATABASE_URI = 'mysql://user@localhost/foo'

class DevelopmentConfig(Config):
    DEBUG = True

class TestingConfig(Config):
    TESTING = True 
```

现在，在你的`foo.py`：

```
from config import Config

print(Config.IMPORT) # prints 'ME' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T01:09:27.043

好吧，因为`current_app`在注册蓝图时可以成为烧瓶程序的代理，并且是在运行时完成的，所以您不能在`models_package`模块中使用它。（应用程序尝试导入`models_package`，并且`models_package`需要应用程序的配置来初始化事物 - 因此导入失败）

一种选择是进行循环导入：

假设一切都在“App”模块中：

**__init__.py**

```
import flask

application = flask.Flask(__name__)
application.config = #load configs

import models_package 
```

**模型包.py**

```
from App import application
config = application.config 
```

或创建自己的`config`对象，但这会以某种方式使复杂性加倍：

**模型包.py**

```
import flask

config = flask.config.Config(defaults=flask.Flask.default_config)

#pick one of those and apply the same config initialization as you do in 
#your __init__.py
config.from_pyfile(..) #or
config.from_object(..) #or
config.from_envvar(..) 
```

# c++ - C++：从头开始实现归并排序

> ID：16071617
> 
> 赞同：0
> 
> 时间：2013-04-17T22:51:50.510
> 
> 标签：c++, algorithm, sorting, implementation, mergesort

我试图测试我自己并想编写合并排序，而不是实际在网上查找任何代码，并在特定时间段内完成。我被困在这一点上，我不能简单地理解我做错了什么，因为据我所知，合并排序是将字符串划分到字符串只有 1 个字符的点，然后将它们重新合并在一起。我在下面编写的代码**试图**做同样的事情。我想知道我的**概念**是错误的，还是只是**我的实现**？

```
string merge(string str1, string str2) {
  string final = "";
  int i = 0, j = 0;
  bool fromStr1 = false;

  while(true) {
    if(str1[i] < str2[j]) {
      final += str1[i];
      i++;
      if(i == str1.size()) {
        break;
      }
    }
    else {
      final += str2[j];
      j++;
      if(j == str2.size()) {
        break;
        fromStr1 = true;
      }
    }
  }

  if(fromStr1) {
    for(int t = i; t < str1.size(); t++) {
      final += str1[t];
    }
  }
  else {
    for(int t = j; t < str2.size(); t++) {
      final += str2[t];
    }
  }

  return final;
}

string mergeSort(string str1, int start, int end) {
  if(end - start == 1)
    return str1;
  else {
    int pivot = (end - start) / 2;
    string newStr1 = mergeSort(str1, start, pivot);
    string newStr2 = mergeSort(str1, pivot + 1, end);
    return merge(newStr1, newStr2);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:26:41.323

这看起来不对：

```
int pivot = (end - start) / 2;
string newStr1 = mergeSort(str1, start, pivot);
string newStr2 = mergeSort(str1, pivot + 1, end); 
```

你不是说`pivot=(end+start)/2`吗？否则`mergeSort(str1, start, start+pivot)`和`mergeSort(str1, start+pivot+1, end)`？

**编辑：**

而且你`merge`不能很好地处理空字符串。在将它连接到`mergeSort`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T06:21:38.757

注意变化：

```
#include <iostream>
#include <string>

using namespace std;

string merge(string str1, string str2) {
  string final = "";
  int i = 0, j = 0;
  bool fromStr1 = false;

  while (true) {
    if (i >= (int)str1.size()) {
      break;
    }
    if (j >= (int)str2.size()) {
      fromStr1 = true; // changed the order of this with break!
      break;
    }

    if (str1[i] < str2[j]) {
      final += str1[i];
      i++;
    }
    else {
      final += str2[j];
      j++;
    }
  }

  if (fromStr1) {
    for (int t = i; t < (int)str1.size(); t++) {
      final += str1[t];
    }
  }
  else {
    for(int t = j; t < (int)str2.size(); t++) {
      final += str2[t];
    }
  }

  return final;
}

string mergeSort(string str1) {
  int len = str1.size();
  if (len <= 1)
    return str1;
  else {
    string newStr1 = mergeSort(str1.substr(0, len / 2));
    string newStr2 = mergeSort(str1.substr(len / 2, len - len / 2));
    return merge(newStr1, newStr2);
  }
}

int main()
{
  cout << '"' << mergeSort("") << '"' << endl;
  cout << '"' << mergeSort("a") << '"' << endl;
  cout << '"' << mergeSort("ba") << '"' << endl;
  cout << '"' << mergeSort("132") << '"' << endl;
  cout << '"' << mergeSort("4321") << '"' << endl;
  cout << '"' << mergeSort("54321") << '"' << endl;
  return 0;
} 
```

输出（[ideone](http://ideone.com/I09QtP)）：

```
""
"a"
"ab"
"123"
"1234"
"12345" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T23:09:30.990

自从我使用 C++ 以来已经很久了，但没有`break`立即退出循环？因为`fromStr1 = true;`在那种情况下永远不会达到。

# python - Python - How to transform counts in to m/s using the obspy module

> ID：16071620
> 
> 赞同：3
> 
> 时间：2013-04-17T22:52:14.177
> 
> 标签：python, obspy

I have a miniseed file with a singlechannel trace and I assume the data is in counts (how can i check the units of the trace?). I need to transform this in to m/s. I already checked the obspy tutorial and my main problem is that i dont know how to access the poles and zeros and amplification factor from the miniseed file. Also, do I need the calibration file for this?

Here is my code:

```
from obspy.core import *
st=read('/Users/guilhermew/Documents/Projecto/Dados sismicos 1 dia/2012_130_DOC01.mseed')
st.plot() 
```

Thanks in advance, Guilherme

EDIT: I finally understood how to convert the data. Obspy has different ways to achieve this, but it all comes down to removing the instrument response from the waveform data. Like @Robert Barsch said, I needed another file to get the instrument response metadata. So I came up with the following code:

```
parser=Parser("dir/parser/file")
for tr in stream_aux:
    stream_id=tr.stats.network+'.'+tr.stats.station+ '..' + tr.stats.channel
    paz=parser.getPAZ(stream_id, tr.stats.starttime)
    df = tr.stats.sampling_rate
    tr.data = seisSim(tr.data, df, paz_remove=paz) 
```

Im using the seisSim function to convert the data. My problem now is that the output dosen't look right (but i cant seem to post the image)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T16:32:06.543

这显然是应该向地震学界而不是 StackOverflow 提出的问题！你写信给[ObsPy 用户邮件列表](http://lists.obspy.org/cgi-bin/mailman/listinfo/obspy-users)怎么样？

**更新：**我仍然觉得答案是他/她应该直接在 ObsPy 邮件列表中询问。但是，为了对实际问题给出正确答案：MiniSEED 是一种纯数据格式，不包含任何元信息，例如极点和零点或使用的单位。所以是的，您将需要另一个文件，例如 RESP、SAC PAZ、Dataless SEED、Full SEED 等，以获取站点特定的元数据。要应用您的地震仪校正，请阅读[http://docs.obspy.org/tutorial/code_snippets/seismometer_correction_simulation.html](http://docs.obspy.org/tutorial/code_snippets/seismometer_correction_simulation.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-16T16:36:25.987

要获得真实单位而不是计数，您需要删除仪器响应。我使用以下代码删除仪器响应：

```
# Define math defaults
from __future__ import division #allows real devision without rounding

# Retrieve modules needed
from obspy.core import read
import numpy as np
import matplotlib.pyplot as plt

#%% Choose and import data
str1 = read(fileloc)
print(str1) #show imported data
print(str1[0].stats) #show stats for trace

#%% Remove instrument response

# create dictionary of poles and zeros
TrillC = {'gain': 800.0,
        'poles': [complex(-3.691000e-02,3.712000e-02),
                  complex(-3.691000e-02,-3.712000e-02),
                  complex(-3.739000e+02,4.755000e+02),
                  complex(-3.739000e+02,-4.755000e+02),
                  complex(-5.884000e+02,1.508000e+03),
                  complex(-5.884000e+02,-1.508000e+03)],
        'sensitivity': 8.184000E+11,
        'zeros': [0 -4.341E+02]}
str1_remres = str1.copy() #make a copy of data, so original isn't changed
str1_remres.simulate(paz_remove=TrillC, paz_simulate=None, water_level=60.0)
print("Instrument Response Removed")

plt.figure()
str1_remres_m = str1_remres.merge()
plt.plot(str1_remres_m[0].data) #only will plot first trace of the stream 
```

如您所见，我已经手动定义了极点和零点。可能有一种方法可以自动输入它，但这是我发现的有效方式。

请记住，每种仪器都有不同的极点和零点。

您使用的零的数量取决于您希望输出的内容。地震仪通常是速度（2 个零）

*   3 个零 = 位移
*   2 个零 = 速度
*   1 零 = 加速度

# django - Django user.is_authenticated 在视图中有效，但在模板中无效

> ID：16071626
> 
> 赞同：3
> 
> 时间：2013-04-17T22:52:38.283
> 
> 标签：django, django-templates

我有一个视图并登录了一个用户：

```
def login_user(request):
c = {}
c.update(csrf(request))

username = password = ''
if request.POST:
    username = request.POST.get('username')
    password = request.POST.get('password')

    user = authenticate(username=username, password=password)
    if user is not None:
        if user.is_active:
            login(request, user)
            c.update(user(request))
            return redirect('/module/')
        else:
            return redirect('/inactive/')
    else:
        return redirect('/failure/')

return render_to_response('core/auth.html',c) 
```

这正确地登录了一个用户，因为如果我是我的超级用户，我可以访问 django 管理页面。

登录并被重定向后，我想在屏幕上显示用户名，目前我正在使用

```
 {% if user.is_authenticated %}
            <p class="navbar-text pull-right">Welcome, {{ user.username }}. Thanks for logging in.</p>
          {% else %}
            <p class="navbar-text pull-right">Welcome, new user. Please log in.</p>
          {% endif %} 
```

但它似乎总是相信用户没有登录。任何帮助将不胜感激。

编辑：这是我的模板上下文处理器

```
TEMPLATE_CONTEXT_PROCESSORS = (
 "django.contrib.auth.context_processors.auth",
 "django.core.context_processors.debug",
 "django.core.context_processors.i18n",
 "django.core.context_processors.media",
 "django.core.context_processors.static",
 "django.core.context_processors.tz",
 "django.contrib.messages.context_processors.messages",
 "django.core.context_processors.request",
) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T23:00:22.323

您是否尝试将 RequestContext 对象发送到您的模板？

```
return render_to_response('core/auth.html', c, context_instance=RequestContext(request)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-15T14:24:11.403

我建议使用快捷功能[`render()`](https://docs.djangoproject.com/en/1.7/topics/http/shortcuts/#render)来完成您的视图：

这将允许您将`request`对象传递给模板：

```
return render(request, 'core/auth.html', c) 
```

# facebook - 在 Unity 中通过 WebView 的 Facebook 提要对话框是空白的

> ID：16071628
> 
> 赞同：0
> 
> 时间：2013-04-17T22:52:43.283
> 
> 标签：facebook, webview, dialog, feed

我一直在使用放入 Unity 的 WebView（在此处找到：[https](https://github.com/gree/unity-webview) ://github.com/gree/unity-webview ）来实现 Facebook 连接。WebView 在 OAuth 对话框中对用户的授权工作得很好，但是当我尝试访问要发布给朋友的提要对话框时，我最终得到了一个空白的白色屏幕。放入浏览器时生成的相同 URL 可以正常工作。

我生成的提要对话框 URL 如下所示： [http://m.facebook.com/dialog/feed?access_token=](http://m.facebook.com/dialog/feed?access_token=) {Access Token}&app_id={App ID}&from={Authroized User}&to={Selected Friend ID}&link ={帖子链接}&name={帖子名称}& description={帖子说明}&redirect_uri={我的重定向页面.aspx}

我生成的有效身份验证对话框 URL 示例如下所示： [http](http://m.facebook.com/dialog/oauth?client_id=) : //m.facebook.com/dialog/oauth?client_id= {App ID}&redirect_uri={My Auth Redirect.aspx}&scope=publish_stream,publish_actions&response_type=token

想知道是否有人知道此特定 WebView 可能导致此问题的原因。

提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:00:19.877

正在为此撕毁我的头发，但已经深入到它的底部。我曾尝试转义 URL，但前几天它没有工作 - 但后来我尝试只转义今天早上发送的一些有空格的参数的值。这似乎解决了它。简单的错误，但如果有人遇到这种情况，请不要忘记转义就是一切！通常，您在更高级别（至少我是）中工作，其中 URL 和参数会自动转义，我猜这是吸取的教训：D

# javascript - jquery验证表单逻辑

> ID：16071640
> 
> 赞同：0
> 
> 时间：2013-04-17T22:53:33.050
> 
> 标签：javascript, jquery, validation, logic

我还有另一个我遇到的逻辑问题。我需要这个表格来只允许一个或另一个。文本输入或复选框，而不是两者！

```
}else if(question_pos==7){
        if(!($('#test_check').prop('checked')) && $("#test").val()!="0" &&  ($("#test").val() =="" || 
                !Number($("#test").val()) ||  Number($("#test").val())<0 || Number($("#test").val())>20 )){
          alert("placeholder?");
          return false; 
```

输入：

```
 <table class="screening" width="100%" cellspacing="5px">
    <tr>
        <td width="8%" align="right"><input name="test" id="test" type="text" pattern="\d*" size="3" maxlength="2"  value="<%=session.getAttribute("test")==null?"":session.getAttribute("test")%>"/>
     </td>
     <td>day(s)</td>
</tr>
      <tr>
        <td width="8%" align="right" valign="top"><input name="test_check" id="test_check" type="checkbox" value="1" <%=(session.getAttribute("test_check")!=null && session.getAttribute("test_check").equals("1"))?"checked":""%>/></td>
        <td width="92%"><label for="test_check">My baby is still in the hospital</label></td>
    </tr>
    </table> 
```

如果选中复选框，则验证需要确保没有文本输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:11:06.587

基本上，您想检查该`checked`属性是否为真以及该字段是否包含某些字符。如果两个条件都满足，则表示表单的状态无效。

这是一个示例[http://jsfiddle.net/g4q34/](http://jsfiddle.net/g4q34/)

*您应该避免`$("#test")`一遍又一遍地调用，它会降低代码的可读性并且在性能方面非常低效。将引用存储在变量中并重用该变量。*

```
var checked = $('#test_check').prop('checked'),
    val = $("#test").val();

if (checked && val.length) {
    //invalid
} else {
    //the checkbox is checked OR the input contains text, but not BOTH
} 
```

这是您自己的代码的示例：

```
} else if (question_pos==7) {
        if($('#test_check').prop('checked') && $("#test").val().length) {
            alert("placeholder?");
            return false;
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T15:56:54.930

这就是我最终需要的工作方式。我只需要喝点咖啡就醒了！

```
}else if(question_pos==7){
    if(!$('#example_check').prop('checked') && $("#example").val()!="0" &&  ($("#example").val() =="" || !Number($("#example").val()) ||  Number($("#example").val())<0 || Number($("#example").val())>20 )){
    alert("How long did your baby stay in the hospital?");
    return false;
    }else if($('#example_check').prop('checked') && $("#example").val().length) {
    alert("Have you taken your baby home or is your baby still in the hospital?");
    return false; 
```

我将“测试”更改为“示例”

# python - 为什么递归序列不能正常工作？

> ID：16071646
> 
> 赞同：0
> 
> 时间：2013-04-17T22:54:00.833
> 
> 标签：python, recursion, python-2.7

我对 Python 完全陌生，我正在尝试打印递归序列的解决方案：

```
#Input sequence variables

a = float(raw_input("type in a = "))
n0 = int(raw_input("type in n_0 = "))
n1 = int(raw_input("type in n_1 = "))
y0 = float(raw_input("type in y_0 = "))

#Define function y_n (forward iteration)

def yn(n):
   if (n==0):
       return y0
   else:
       return (1/n)-a*yn(n-1)

#backward iteration

def yn_back(n):
       return (1/a)*((1/n)-yn(n-1))

if(n1>=n0):
   for i in range(n0,n1+1):   
       print(yn(i))

else:
   for i in range(n0,n1+1):
       print(yn_back(i)) 
```

但是，如果我使用,运行此脚本`a=5`，并且解决方案非常高（从到），并且即使 n 的值也是负数。该解决方案适合. 对于 other ，的定义中的似乎被忽略了。`n0=1``n1=30``y0=log(5/6)=0.182322``0.08839``3.29e+18``n=1``n``(1/n)``yn(n)`

有人能帮我吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:56:39.920

`n`可能是一个整数，所以返回`1/n`大于1：`0``n`

```
>>> 1/1
1
>>> 1/2
0
>>> 1.0/2
0.5 
```

为确保您使用的是浮点除法，请更改`1`为`1.0`您计算的位置`1/n`：

```
(1.0/n) 
```

或转换`n`为`float`.

# kendo-ui - Kendo UI ASP.NET MVC 是开源的吗？

> ID：16071647
> 
> 赞同：1
> 
> 时间：2013-04-17T22:54:02.143
> 
> 标签：kendo-ui

我正在尝试重现 Kendo UI 的 DataSourceResponse 类和 ServiceStack.Text Json Serializer 之间不兼容的问题。我只能找到客户端 Javascript 的源代码。

有谁知道 Kendo UI 的 ASP.NET MVC 的 C# 源代码是否可用？

我想我可以反映它，但我无法在问题报告中分享任何代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:17:58.493

这包含在 Kendo 许可协议中：[https ://www.kendoui.c​​om/purchase/license-agreement/kendo-ui-complete-mvc.aspx](https://www.kendoui.com/purchase/license-agreement/kendo-ui-complete-mvc.aspx)

> 1.3 源代码。本软件的源代码提供给您，以便您可以根据本协议的条款进行修改。
> 1.3.3 您承认该软件的源代码是机密的，并且包含 Telerik 的宝贵和专有商业机密。除本协议第 2.2 条规定外，**在任何情况下，不得向任何第三方分发、披露或以其他方式提供本软件源代码的任何部分或源代码的任何修改版本**。

但是，如果您直接向 Telerik 提交票证，那么他们是第一方，因此您应该与他们分享您发现的任何内容。

# c++ - 在单独的线程中读取和写入 Windows 管道

> ID：16071648
> 
> 赞同：0
> 
> 时间：2013-04-17T22:54:03.640
> 
> 标签：c++, windows

在我的程序中，我启动线程以将输出重定向到控制台：

```
 while(TRUE)
  {
     if (!ReadFile(hPipeRead,lpBuffer,sizeof(lpBuffer),
                                      &nBytesRead,NULL) || !nBytesRead)
     {
        if (GetLastError() == ERROR_BROKEN_PIPE)
           break; // pipe done - normal exit path.
        else
           DisplayError("ReadFile"); // Something bad happened.
     }

     // Display the character read on the screen.
     if (!WriteConsole(GetStdHandle(STD_OUTPUT_HANDLE),lpBuffer,
                       nBytesRead,&nCharsWritten,NULL))
        DisplayError("WriteConsole");
  } 
```

问题是它是一个循环。是否可以通过使线程等待管道中出现某些内容来避免循环运行？

当有类似的写作线索时，问题变得更加严重。

# asp.net - JSON + SOAP - 是否需要 DataContract？

> ID：16071653
> 
> 赞同：0
> 
> 时间：2013-04-17T22:54:21.493
> 
> 标签：asp.net, json, soap, datacontract

这是我的问题。我正在使用 SOAP 从第三方 Web 服务中检索信息。响应时间太长，所以我打算改用 JSON，至少在几种方法中。

为此，我正在使用`DataContractJsonSerializer`，但我似乎遇到了一些麻烦。例如，在 SOAP 中有一个名为 getAvailablePublic 的方法，它返回一个类型为 的对象`getAvailablePublicResponse`。

这个方法在 JSON 中有一个等价物，它也返回一个类型为 的对象`getAvailablePublicResponse`。

为了反序列化我需要创建几个数据合约的信息，以下是我的担忧：

我真的需要创建 DataContract 吗？为什么我不能使用`getAvailablePublicResponse`asmx 中的对象？

问题是，如果我创建一个 DataContract，我需要使用除 getAvailablePublicResponse 之外的其他名称，因为我将有两个具有相同名称的对象（一个由我创建，一个来自 SOAP），这需要我的解决方案有几个变化。

希望这是有道理的。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:04:16.437

您可以发布调用 Web 服务的客户端代码吗？我不知道你现在在用什么，但我喜欢使用[RestSharp](http://www.nuget.org/packages/RestSharp/)进行远程调用并将 JSON 序列化为 C# 类。像这样的东西：

```
 RestClient client = new RestClient("http://some.domain.com/someservice?someparam=yes");
    var results = client.Execute<MyGreatDTOClass>(new RestRequest(Method.GET)); 
```

# javascript - 最后一个孩子点击没有改变

> ID：16071657
> 
> 赞同：1
> 
> 时间：2013-04-17T22:54:37.010
> 
> 标签：javascript, jquery

当我选择 box`2`时，我希望边框变为黑色。
再次单击它应该回到黄色。

第一次单击正确，但第二次单击保持黑色。我可以通过添加另一个类来解决这个问题，但我不想这样做。

我还能怎么做？

这是我的代码：

```
<div class="aa">
    <div class="bb">1</div>
    <div class="cc"></div>
</div>
<div class="aa">
    <div class="bb">2</div>
    <div class="cc"></div>
</div> 
```

```
$('.bb:last').addClass('yellow');

$('.bb').click(function () {
    $(this).next('.cc').fadeToggle();

    if (!$('.cc:last').is(':hidden')) {
        $('.bb:last').addClass('black');
    } else {
        $('.bb:last').removeClass('black');
        $('.bb:last').addClass('yellow');
    }
}); 
```

```
.bb {
    background:red;
    width:90px;
    height:30px
}

.cc {
    background:blue;
    width:90px;
    height:30px;
    display:none;
}

.yellow {
    border:3px solid yellow;
}
.black {
    border:3px solid black;
} 
```

样品[**小提琴**](http://jsfiddle.net/M5BdH/1)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:10:40.060

简单得多：

`**[LIVE DEMO](http://jsfiddle.net/M5BdH/5/)**`

```
$('.bb:last').addClass('yellow');
$('.bb').click(function( e ) {   
    $(this).next('.cc').fadeToggle();
    if(e.target == $('.bb:last')[0])
        $(this).toggleClass('yellow black');
}); 
```

[http://api.jquery.com/hasClass/](http://api.jquery.com/hasClass/)
[http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:01:44.103

检查这个[小提琴](http://jsfiddle.net/M5BdH/2/)

如果它有它，你基本上需要删除它。

```
$('.bb:last').addClass('yellow');

$('.bb').click(function () {
    $(this).next('.cc').fadeToggle();
    if (!$('.cc:last').is(':hidden')) {
        if ($('.bb:last').hasClass('black')) {
            $('.bb:last').removeClass('black');
        } else {
            $('.bb:last').addClass('black');
        }
    } else {
        $('.bb:last').addClass('yellow');
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T23:25:11.280

非常简单的解决方案。只需使用`.toggleClass('yellow black')`. `toggleClass()`会为你处理好一切。设置的空格分隔列表中的任何类都将被清除，反之亦然。要仅影响最后一个`.bb`，您可以将其放入它自己的处理程序中：

```
$('.bb:last').addClass('yellow').click(function() {
    $(this).toggleClass('yellow black');
});
$('.bb').click(function () {
    $(this).next('.cc').fadeToggle();
}); 
```

`**[DEMO](http://jsfiddle.net/jtbowden/8MbKU/1/)**`

# actionscript-3 - 如何确定 AS3 中的主要滑动方向（使用 MultiTouch）？

> ID：16071660
> 
> 赞同：0
> 
> 时间：2013-04-17T22:54:52.927
> 
> 标签：actionscript-3, multi-touch, swipe

我正在尝试使用 AS3 在触摸屏上实现非常简单的滑动识别。我只需要知道滑动是向左、向右、顶部还是底部。

第一个问题：使用简单的 MOUSE_DOWN 和 MOUSE_UP 并简单地计算移动的距离会更容易吗？

或者使用 MultiTouch 会更容易吗？

我看到 MultiTouch 的代码显示了如何实现滑动检测并获得方向：

```
 if (e.offsetY == 1) { 
    //User swiped towards bottom
    square_mc.y += 100; 
    }
    if (e.offsetY == -1) { 
    //User swiped towards top
    square_mc.y -= 100;
    }
            if (e.offsetX == 1) { 
    //User swiped towards right
    square_mc.x += 100; 
    }
    if (e.offsetX == -1) { 
    //User swiped towards left
    square_mc.x -= 100;
    } 
```

但是如果您需要解决一个方向（即左或上、右或下等），您如何做到这一点（如果 offsetX 和 offsetY 是真正的偏移，为什么它们只检查 +1 和 -1？或者这是一个在滑动过程中经常调用的函数？我正在尝试完成一次滑动）。

我认为跳过 MultiTouch 可能更简单，但欢迎提供反馈。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T01:07:00.400

你可以通过做两件事来回答你自己的问题......

1重新阅读您的代码来自的教程..尤其是标题为“编码手势”的部分[http://www.republicofcode.com/tutorials/flash/as3swipegesture/](http://www.republicofcode.com/tutorials/flash/as3swipegesture/)

2 只是实验并从观察结果中学习。例如...

> 但是如果您需要解决一个方向（即左或....您如何做到这一点？

那么您提供的代码中的这一行有什么问题`if (e.offsetX == -1) { square_mc.x -= 100; }`。你测试了吗？当您向左滑动时，square_mc 是否没有向左移动 100 像素？如果它有效，我猜你已经成功地“解决”了一个方向。您可以`If`根据需要为其他方向添加其他语句。

# database - 使用 Visual Studio 将图像添加到数据库（访问）

> ID：16071667
> 
> 赞同：0
> 
> 时间：2013-04-17T22:55:46.890
> 
> 标签：database, image

我正在做一个网站来销售电脑零件。我正在尝试从数据库中的表中显示图片以及其他一些信息。图片列是 OLE 对象数据类型。

有人提到将图像存储在服务器中，并将图像的 url 存储在数据库中。我将如何实现这一目标？谢谢

# javascript - AngularJS中指令函数的执行顺序

> ID：16071676
> 
> 赞同：15
> 
> 时间：2013-04-17T22:56:38.783
> 
> 标签：javascript, angularjs, angularjs-directive

指令函数的执行顺序是什么？该[文档](http://docs.angularjs.org/guide/directive)似乎没有解决这个问题。

前任

1.  模板/模板Url（被评估）
2.  控制器Fn
3.  编译Fn
4.  链接Fn

# 回答

从下面的[答案：](https://stackoverflow.com/questions/16071676#21410877/80714) [http](http://plnkr.co/edit/79iyKSbfxgkzk2Pivuak) ://plnkr.co/edit/79iyKSbfxgkzk2Pivuak（plunker 显示嵌套和兄弟指令）

1.  模板被解析
2.  `compile()`（在编译中对模板所做的更改会扩散到链接功能）
3.  `controller()`
4.  `preLink()`
5.  `postLink()`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-01-28T16:11:20.600

在相关说明中，这里是我对跨 DOM 执行顺序的理解。

[这是一个演示（打开浏览器JS控制台）](http://plnkr.co/edit/EBQhjx6Z03NInCyDJ5xv?p=preview)

给定这个 DOM using 指令`foo`：

```
 <div id="1" foo>
    one
    <div id="1_1" foo>one.one</div>
  </div>

  <div id="2" foo>two</div> 
```

...AngularJS 将以深度优先顺序遍历 DOM - 两次：

**第一遍 foo.compile()**

1）编译：1

2）编译：1_1

3）编译：2

**第二遍： foo.controller() 向下遍历；回溯时的 foo.link()**

控制器：1

控制器：1_1

链接：1_1

链接：1

控制器：2

链接：2

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T01:10:09.210

> 预链接功能：在子元素链接之前执行。进行 DOM 转换是不安全的，因为编译器链接函数将无法找到正确的链接元素。
> 
> 链接后功能：在子元素链接后执行。在 post-linking 函数中进行 DOM 转换是安全的。

以上摘录摘自关于[指令](http://docs.angularjs.org/guide/directive)的官方文档。

因此，为了回答您的问题，*Post-linking/Link 功能*是您可以安全操作 element.children() 的时间/地点。

# vbscript - VBS 中 CopyFile 的权限被拒绝

> ID：16071679
> 
> 赞同：35
> 
> 时间：2013-04-17T22:56:47.667
> 
> 标签：vbscript, permission-denied, file-copying

我正在尝试自动将文件推送到用户的主目录中，但我遇到了“Permission Denied”错误——在这里第 6 行抛出了 CopyFile 调用。

脚本的其他部分（未显示）使用相同的源目录和目标目录创建和复制文件夹内容，它们运行良好。只有当我使用 CopyFile 时它才会失败。

```
Dim fso

Set fso = CreateObject("Scripting.FileSystemObject")

If Not fso.FileExists("H:\Minecraft\.minecraft\options.txt") Then
    fso.CopyFile "C:\Minecraft\options.txt", "H:\Minecraft\.minecraft\"
End If

Set fso = Nothing 
```

`H:`是一个网络主目录，当前用户对其拥有完整的读/写权限。

我已经尝试从路径中添加/删除尾部斜杠，添加`"options.txt"`到目标路径，删除`false`参数......不知道还有什么可以尝试的。有什么想法吗？

仅供参考，这段代码紧接在上面容易出错的位之前，每次都能完美执行：

```
If Not fso.FolderExists("H:\Minecraft\.minecraft\bin\") Then
    If Not fso.FolderExists("H:\Minecraft\.minecraft\") Then
        fso.CreateFolder("H:\Minecraft\.minecraft\")
    End If
    fso.GetFolder("C:\Minecraft\bin\").Copy "H:\Minecraft\.minecraft\"
End If 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-04-18T16:48:01.417

我只见过[`CopyFile`](https://msdn.microsoft.com/en-us/library/e1wf9e7w.aspx)在以下三种情况之一中出现“权限被拒绝”错误的失败：

*   源或目标的实际权限问题。
*   目标路径是一个文件夹，但没有尾部反斜杠。
*   源文件被应用程序锁定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-01-12T06:49:17.337

对我来说，添加`/`工作在文件夹位置的末尾。因此，如果您要复制到文件夹中，请不要忘记将`/`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-23T16:00:21.993

要检查的另一件事是是否有任何应用程序仍保留该文件。

MoveFile 有一些问题。我的权限问题的一部分是我的脚本打开文件（在本例中为 Excel），进行修改，关闭它，然后将其移动到“已处理”文件夹。

在调试几件事时，脚本崩溃了几次。深入研究权限被拒绝错误，我发现我有 4 个 Excel 实例在后台运行，因为脚本由于上述崩溃而无法正确终止应用程序。显然他们中的一个人仍然持有该文件，因此，“许可被拒绝”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T08:39:18.153

根据您的源变量（`sourcePath = "C:\Minecraft\bin\"`），我怀疑您的硬代码指向错误的位置

```
fso.CopyFile "C:\Minecraft\options.txt", destinationPath, false 
```

应该

```
fso.CopyFile "C:\Minecraft\bin\options.txt", destinationPath 
```

或者

```
fso.CopyFile sourcePath & "options.txt", destinationPath 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-06-08T19:39:08.467

值得检查任务管理器是否有任何卡住的杂散 wscript.exe 任务。它可能是阻止访问文件的因素之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-12T17:49:53.920

你可以这样做：

```
fso.CopyFile "C:\Minecraft\options.txt", "H:\Minecraft\.minecraft\options.txt" 
```

在您复制到的文件夹中包含文件名。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-13T14:11:07.043

我已经阅读了你的问题，我也遇到了同样的问题。但是在我改变了一些之后，我的问题“权限被拒绝”就解决了。

```
Private Sub Addi_Click()
'On Error Resume Next
'call ds
browsers ("false")
Call makeAdir
ffgg = "C:\Users\Backups\user\" & User & "1\data\"
Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.Getfolder("c:\users\Backups\user\" & User & "1\data")
    f.Attributes = 0
Set fso = VBA.CreateObject("Scripting.FileSystemObject")
Call fso.Copyfile(filetarget, ffgg, True) 
```

看 `ffgg = "C:\Users\Backups\user\" & User & "1\data\"`，在我改变之前，`ffgg = "C:\Users\Backups\user\" & User & "1\data"`当我在之后添加反斜杠时`"\data\"`，我的问题就解决了。尝试添加反斜杠。也许解决了你的问题。祝你好运。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-06-28T11:46:42.673

您的**防病毒软件**可能会阻止脚本的活动。我在 AVG Antivirus 在静默模式下运行时遇到了这种情况（这意味着它不会提醒您采取的每个保护步骤，因此您会收到权限错误而没有意识到 AVG 正在阻止该操作）。在我的例子中，我调用了详细模式（关闭了静音模式），执行了脚本，AVG 提出了一个拦截警告，允许我训练 AVG 以允许该脚本运行。

# google-chrome-app - 从 chrome 应用程序访问 cookie

> ID：16071681
> 
> 赞同：8
> 
> 时间：2013-04-17T22:56:55.257
> 
> 标签：google-chrome-app

我可以看到，当我从我的 chrome 应用程序发出 xhr 时，它会发送一些 cookie，并且这些 cookie 在应用程序中被跟踪。发送 set-cookie 标头的服务器正在正确更新它们。不过，我需要读取一个 cookie，并且我尝试使用“cookies”权限，但 chrome 对我大喊大叫……还有其他我可以使用的 api 吗？

编辑：我正在使用新的打包应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-19T17:21:01.313

Cookies 显然是 Chrome 打包应用程序的一个黑暗区域。

使用扩展，扩展与正常浏览活动共享 cookie jar。对于打包应用程序，每个应用程序都有一个单独的 jar。

当前的行为似乎是对权限部分清单中指定的站点的 XHR 请求确实在此 jar 中设置了 cookie，但除了重新安装应用程序之外，没有办法摆脱它们。打包应用程序没有 API 来管理 cookie，并且它们的 cookie 不会显示在开发人员工具或 about://settings/cookies 页面中。

crbugs 包括

[https://code.google.com/p/chromium/issues/detail?id=70391](https://code.google.com/p/chromium/issues/detail?id=70391) [https://code.google.com/p/chromium/issues/detail?id=152758](https://code.google.com/p/chromium/issues/detail?id=152758) [https://code.google。 com/p/chromium/issues/detail?id=157474](https://code.google.com/p/chromium/issues/detail?id=157474)

这两个问题是为了回答这个 SO question

[https://code.google.com/p/chromium/issues/detail?id=236585](https://code.google.com/p/chromium/issues/detail?id=236585) [https://code.google.com/p/chromium/issues/detail?id=335934](https://code.google.com/p/chromium/issues/detail?id=335934)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-17T15:42:20.583

我有一个类似的问题，在具有 chrome.socket api 权限的打包应用程序中对 XHR 的安全限制似乎很霸道。请参阅[在打包的应用程序 XHR 中设置“不安全”标头](https://stackoverflow.com/questions/21105471/setting-unsafe-headers-in-packaged-app-xhr)

我最终为我的用例创建了一个“shim”xhr 对象，尽管它不处理例如分块编码。您可能会发现它很有用：[https ://github.com/kzahel/jstorrent/blob/fresh/js/chromesocketxhr.js](https://github.com/kzahel/jstorrent/blob/fresh/js/chromesocketxhr.js)

我最终在 crbug 上提交了一个错误：[https ://code.google.com/p/chromium/issues/detail?id=335934](https://code.google.com/p/chromium/issues/detail?id=335934)

# multithreading - 英特尔 SFENCE 是否具有发布语义？

> ID：16071682
> 
> 赞同：15
> 
> 时间：2013-04-17T22:57:07.020
> 
> 标签：multithreading, concurrency, memory-barriers

获取和释放语义的公认定义似乎是这样的：（引自[http://msdn.microsoft.com/en-us/library/windows/hardware/ff540496(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540496(v=vs.85).aspx)）

> 如果其他处理器总是在任何后续操作的效果之前看到它的效果，则该操作具有获取语义。如果其他处理器将在操作本身的效果之前看到每个先前操作的效果，则该操作具有释放语义。

我已经简要了解了半内存屏障的存在，并且据说它们具有遵循上述相同语义的获取屏障和释放屏障的味道。

查找我遇到 SFENCE 的硬件指令的真实示例。这个博客（[http://peeterjoot.wordpress.com/2009/12/04/intel-memory-ordering-fence-instructions-and-atomic-operations/](http://peeterjoot.wordpress.com/2009/12/04/intel-memory-ordering-fence-instructions-and-atomic-operations/)）说这是一种释放栅栏/屏障：

> Intel 提供双向栅栏指令 MFENCE、获取栅栏 LFENCE 和释放栅栏 SFENCE。

但是阅读 SFENCE 的定义，它似乎没有提供释放语义，因为它根本不与负载同步？而据我了解，发布语义定义了所有内存操作（加载和存储）的顺序。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-18T22:12:20.157

LFENCE 没有获取语义；SFENCE 没有发布语义。这样做有一个很好的理由：拥有具有获取语义或释放语义的独立栅栏指令几乎完全没有用。为了使获取/释放有任何好处，它必须与内存操作相关联。

例如，考虑在两个线程之间发送数据的常见习语：

1.  处理器 A 写入缓冲区。
2.  处理器 A 将“真”写入标志。
3.  处理器 B 一直等到标志为真。
4.  处理器 B 读取缓冲区。

请注意，处理器 A 必须确保在写入缓冲区*后才能看到其对标志的写入。*现在假设我们有一个“RFENCE”指令，它是一个释放栅栏。如果我们将指令紧跟在第 (1) 步之后，它就没有好处，因为第 2 步中的写入被允许出现在 RFENCE 上向上迁移并在第 1 步上向上迁移。

一个类似的论点表明，执行获取的“AFENCE”指令对于确保步骤 3 中标志的读取不会出现在步骤 4 中向下迁移同样无用。

Itanium 通过提供 write-with-release 和 load-with-acquire 指令优雅地解决了这个问题，这些指令将栅栏与内存操作联系起来。

回到 IA-32 和 Intel64：**如果**程序不使用“非临时”指令，那么其余指令的行为就好像每次加载都执行“获取”并且每个存储执行“释放”一样。[请参阅英特尔® 64 和 IA-32 架构开发人员手册：](http://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-vol-3a-part-1-manual.html)第 8.2.3 节（和小节） 。[3A](http://www.intel.com/content/www/us/en/architecture-and-technology/64-ia-32-architectures-software-developer-vol-3a-part-1-manual.html)。如果涉及“非临时”存储，您有几种方法可以强制执行围栏：

*   使用 SFENCE
*   使用 MFENCE - 有点矫枉过正
*   使用 LOCK 前缀指令（例如“LOCK INC”）写入标志。带有 LOCK 前缀的指令隐含地具有 MFENCE。
*   使用 XCHG 来写入标志，它就像它具有隐式 LOCK 前缀一样。

例如，如果在前面的习语中，缓冲区是使用非临时存储写入的，则让处理器 A 在步骤 1 和 2 之间发出 SFENCE 或 MFENCE。或者使用 XCHG 写入标志。

以上所有说明均适用于硬件。使用高级语言时，请确保编译器不会破坏事件的关键顺序。存在 C++11 原子操作库，以便您可以告诉编译器*和*硬件您的意图。

# php - 将数组的非关联列表转换为数组的关联数组

> ID：16071683
> 
> 赞同：0
> 
> 时间：2013-04-17T22:57:11.363
> 
> 标签：php, arrays, associative-array

我有一个数组列表（或对象，它们通过`PDO` `fetchAll()`函数来​​自数据库，所以这两个选项对我来说都可以）。我希望将数组列表转换为数组的关联数组，每个数组的键都是它的列之一。

我显然可以做一个循环，但我想知道是否有一些 PHP 函数已经这样做了，也许是以更有效的方式。

为了说明这一点，假设我有一个数组（非关联），里面有数组：

```
[0] => {'name' : 'Joe', 'surname' : 'Bloggs', 'id' : '12345'}
[1] => {'name' : 'Sandy', 'surname' : 'Smith', 'id' : '54321'} 
```

我希望将其转换为：

```
['12345'] => {'name' : 'Joe', 'surname' : 'Bloggs', 'id' : '12345'}
['54321'] => {'name' : 'Sandy', 'surname' : 'Smith', 'id' : '54321'} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T23:00:43.747

一个简单的循环就可以了，但这太无聊了，无法发布答案，所以你去吧：

```
$array = array_combine(array_map(function (array $row) { return $row['id']; }, $array),
                       $array); 
```

如果您偏爱[功能性 PHP](https://github.com/lstrojny/functional-php)：

```
$array = array_combine(F\pluck($array, 'id'), $array); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T23:01:32.277

```
$rows = $stmt->fetch(PDO::FETCH_ASSOC); 
```

或者

```
$rows = $stmt->fetchall(PDO::FETCH_ASSOC); 
```

让我们看看[HashPHP](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)是怎么说的：

> 注意上面 fetch() 和 fetchAll() 代码中 PDO::FETCH_ASSOC 的使用。这告诉 PDO 将行作为关联数组返回，其中字段名称作为键。其他获取模式（如 PDO::FETCH_NUM）将行作为数字数组返回。默认是使用 PDO::FETCH_BOTH 获取，它使用数字键和关联键复制数据。建议您指定一个或另一个，这样您就没有两倍大小的数组！PDO 也可以使用 PDO::FETCH_OBJ 获取对象，并且可以使用 PDO::FETCH_CLASS 获取现有类。它还可以使用 PDO::FETCH_BOUND 和 bindColumn 方法绑定到特定变量。

# ruby - STDIN.getch 作为非阻塞事件（有可能吗？）

> ID：16071685
> 
> 赞同：0
> 
> 时间：2013-04-17T22:57:27.040
> 
> 标签：ruby, io, console, errno

我试图在不使用 Enter 的情况下立即从命令行读取字符。我正在使用的 ruby​​ (ruby 1.9.3p374) 代码如下：

```
require 'io/console'

ch = STDIN.getch
puts ch 
```

直到现在一切都很好，但现在我想把这段代码放在一个无限循环中做一些其他的事情，比如

```
loop do
  puts "..doing stuff.."
  ch = STDIN.getch
  if ch == 'q'
    break
  end
end 
```

但是这段代码总是强制我们在每次打印之间按下一个键。我想要一种类似于**STDIN.read_nonblock**方法的行为，但无需在按下一个字符后按下回车键。

基本上我想打印“..doing stuff..”，直到我按下键盘上的某个键，但我不想使用 enter。

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T01:57:25.270

您始终可以使用内置[`curses`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/curses/rdoc/Curses.html)库来处理您的交互。它非常强大，用于构建键盘驱动的工具，例如文本编辑器。

另一种方法是用于`select`轮询 STDIN 是否可读。您的终端可能处于行缓冲状态，因此您需要在收到单次击键之前对其进行调整。这是 Curses 可以为您处理的事情。

# c# - 从 SQL 视图到 gridview 的聚合结果

> ID：16071686
> 
> 赞同：0
> 
> 时间：2013-04-17T22:57:30.820
> 
> 标签：c#, sql, linq, linq-to-sql, gridview

我有这个来自多表的视图

account_name.......奖金.............价值

客户1............A............14000

客户1............B............500

客户1............C............14500

客户2............A............20000

客户2............B............200

客户2............C............20200

[http://im33.gulfup.com/Nt0mM.png](http://im33.gulfup.com/Nt0mM.png)

如何使用 LINQ 检索此视图并在 GridView 上显示此视图

....................A........B........C

客户1.......14000.......500.......14500

客户2.......20000......200.......20200

![在此处输入图像描述](https://i.stack.imgur.com/ah2bS.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:59:16.667

```
SELECT account_name, 
SUM(CASE WHEN bonus = 'A' THEN value ELSE 0 END) AS A,
SUM(CASE WHEN bonus = 'B' THEN value ELSE 0 END) AS B,
SUM(CASE WHEN bonus = 'C' THEN value ELSE 0 END) AS C
FROM YouView
GROUP BY account_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T20:56:08.457

我使用 realnumber3012 推荐的动态 Pivots 解决了我的问题...

表格的演示和此链接上的结果

![在此处输入图像描述](https://i.stack.imgur.com/sAHUv.png)

* * *

```
DECLARE @cols NVARCHAR(2000)
SELECT  @cols = COALESCE(@cols + ',[' + bounse_name+ ']','[' + bounse_name + ']')
FROM    dbo.tbl_bounse
DECLARE @query NVARCHAR(4000)
SET @query = N'SELECT account_name , '+ @cols +'
FROM
(SELECT     tbl_account.account_name, tbl_account.account_career,     
            tbl_bounse.bounse_name, tbl_detail.detail_value
FROM         tbl_account INNER JOIN
tbl_detail ON tbl_account.account_id = tbl_detail.detail_accound_id 
INNER JOIN
tbl_bounse ON tbl_detail.detail_bounce_id = tbl_bounse.bounse_id                     
                   )  p
PIVOT
(
MAX([detail_value])
FOR bounse_name IN
( '+
@cols +' )
) AS pvt;'

EXECUTE(@query) 
```

# linux - 可以使用环境变量指定 .emacs 位置吗？

> ID：16071694
> 
> 赞同：2
> 
> 时间：2013-04-17T22:58:29.050
> 
> 标签：linux, emacs

我在一个我们都以自己身份登录的环境中工作，然后 sudo 到一个普通用户。（布莱）。我开始使用 emacs 并想在启动时指定我自己的 .emacs 文件。我想我想要的是使用环境变量指定 .emacs 的位置，但我在 emacs 文档中看不到任何方法。有吗？

作为替代方案，也许我需要学习 elisp 并有条件地从位于 /home/common_user/.emacs 的常见 .emacs 文件中加载我自己的文件？就我而言，我已经将环境变量 SUDO_USER 设置为我的名字“lcuff”，并将环境变量 MY_CONF 设置为 /foo/bar/blah/lcuff，我想在其中存储我自己的 .emacs 文件。我该怎么做？

想法和建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:03:42.977

看：
`C-h``i``g` `(emacs) Find Init` `RET`

如果其他任何事情都失败，您可以使用以下命令指定`$HOME`命令`env`：

```
env HOME=/foo/bar/blah/lcuff emacs 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T00:25:55.090

使用 -u 选项调用 emacs 将查找给定用户的 init 文件，因此

```
emacs -u Leonard 
```

即使您以其他用户身份登录，也会使用您的 emacs 初始化文件运行 emacs。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T05:37:48.153

您可以通过以下方式告诉 emacs 加载您选择的 init 文件：

```
emacs -q -l /path/to/my/preferred/.emacs 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T06:57:26.927

弄清楚 emacs 认为你是谁有点棘手。来自信息：

更准确地说，Emacs 首先确定要使用哪个用户的 init 文件。它从环境变量 LOGNAME 和 USER 中获取您的用户名；如果这些都不存在，则它使用有效的用户 ID。如果该用户名与真实用户 ID 匹配，则 Emacs 使用 `HOME'；否则，它会在系统的用户数据库中查找与该用户名对应的主目录。

所以我首先要找出 emacs 认为你是谁，通过在不加载任何 init 文件的情况下启动 emacs：

```
emacs -q 
```

然后找出emacs认为你的init文件在哪里：

```
(locate-user-emacs-file "yourrealusername") 
```

我认为在新的家庭环境中，它将默认为 ~/.emacs.d/yourusername，但这应该有助于您确定最好的位置放置 init 文件。

*重要的一点是拥有一个 emacs用户目录*而不仅仅是一个启动文件是一个很好的做法。emacs 需要跟踪大量额外的信息（包管理、自定义设置、备份文件、字典、手动插入的 lisp 代码等），我发现将所有这些东西放在一个位置非常有用。如果 Emacs 在系统上看不到 ~/.emacs 或 ~/.emacs.el，它会查找 ~/.emacs.d/init.el。确保您仍然没有 ~/.emacs。

创建一个名为 ~/.emacs.d/init.el 的新文件

把这个放进去：

```
(setq user-emacs-directory "~/.emacs.d/")
(message "This is my init.el file and noone elses!!!")
(inhibit-default-init) ;; there might be a default.el lurking somewhere 
```

如果 emacs 获得了您的用户名和主页，您可以使用以下命令重新启动：

```
emacs -u therealme 
```

或者，如果它填满了环境变量

```
env HOME=/this/is/my/home USER=blah emacs 
```

可能有一个 site-start.el 可能会在您的 init.el 之前加载。如果您怀疑这一点，使用 --no-site-file 选项加载 emacs 会解决这个问题。

# c++ - LLDB 错误与 C++ 上的指数

> ID：16071696
> 
> 赞同：0
> 
> 时间：2013-04-17T22:58:33.490
> 
> 标签：c++

我更新了我的计算器代码，并添加了一个指数函数。然而，当我试图得到等式的答案时，我得到了这个错误：（lldb）任何帮助将不胜感激，因为这是我使用 C++ 的第一天！是的，仅此而已！这是我的代码！

```
#include <math.h>
#include <iostream>
int int1, int2, answer;
bool bValue(true);
std::string oper;
std::string cont;
using namespace std;
std::string typeOfMath;
int a;
int b;
int answerExponent;

int main(int argc, const char * argv[]){

// Taking user input, the first number of the calculator, the operator, and second number. Addition, Substraction, Multiplication, Division
    cout<<"______________________________________________\n";
    cout<<"|Welcome to The ExpCalc! Do you want to do   |\n";
    cout<<"|Exponent Math, or Basic Math(+, -, X, %)    |\n";
    cout<<"|Type in 'B' for basic Math, and'E' for      |\n";
    cout<<"|Exponential Math! Enjoy! (C) John L. Carveth|\n";
    cout<<"|____________________________________________|\n";
    cin>> typeOfMath;
    if(typeOfMath == "Basic" ||
       typeOfMath == "basic" ||
       typeOfMath == "b" ||
       typeOfMath =="B")
    {
        cout << "Hello! Please Type in your first integer!\n";
        cin>> int1;
        cout<<"Great! Now Enter your Operation: ex. *, /, +, -...\n";
        cin>> oper;
        cout<<"Now all we need is the last int!\n";
        cin>> int2;

        if (oper == "+") {
            answer = int1 + int2;
        }
        if (oper == "-") {
            answer = int1 - int2;

        }if (oper == "*") {
            answer = int1 * int2;
        }if (oper == "/") {
            answer = int1 / int2;
        }
        cout<<answer << "\n";
        cout<<"Thanks for Using The ExpCalc!\n";

    }else if(typeOfMath == "Exp" ||typeOfMath == "E" ||typeOfMath == "e" ||typeOfMath == "Exponent"){
        cout<<"Enter the desired Base. Example: 2^3, where 2 is the base.\n";
        cin>> a;
        cout<<"Now what is the desired exponent/power of the base? Ex. 2^3 where 3 is the exponent!\n";
        cin>>b;
        answerExponent = (pow(a,b));
        cout<< answerExponent;
    } else(cout<<"Wrong String!");
} 
```

请帮忙！我可能也会问很多问题，所以请不要生气！我也在使用 Xcode 4 的 Mac 上！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:16:11.360

将此行添加到您的包含：

`#include <string>`

完成后，我可以在 Visual Studio 和 GCC 4.7.2 中使用 ideone.com 编译和运行 2^3 的正确输出的代码（[单击此处](http://ideone.com/RLQTpo)查看输出）。但是，我的编译器仍然会发出警告，因为您可能应该通过转换来处理转换`double`。`int`改变这个：

`answerExponent = (pow(a,b));`

对此：

`answerExponent = static_cast<int>(pow(a,b));`

话虽如此，编译器发出该警告是有原因的，通过强制转换，您基本上只是在告诉编译器“闭嘴，无论如何都要这样做”。更好的方法是避免需要演员表。不要进行上述更改，而是更改此行：

`int answerExponent;`

对此：

`double answerExponent;`

这更有意义，因为如果您之后要丢弃数字的小数部分，那么`pow`使用s 作为参数调用就没有什么意义了。`double`

# android - 如何强制画廊以横向打开？

> ID：16071705
> 
> 赞同：2
> 
> 时间：2013-04-17T22:59:03.700
> 
> 标签：android, android-intent, android-gallery, android-orientation

我的应用程序以横向模式运行。我已经`android:screenOrientation="landscape"`在 AndroidManifest.xml 文件中设置了。如果设备的屏幕方向锁定为纵向模式，那么我的应用程序仍以横向模式运行。但是从应用程序内部开始的画廊活动以纵向模式运行。
有什么方法可以强制画廊活动始终以横向模式运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:09:04.020

只要将设备锁定为纵向模式，就没有办法实现这一点。

当然，您可以尝试将*设备*方向更改为横向（在您的应用程序中），以便图库以横向运行，但这会给用户造成混淆。

# ios - 旋转 UIImage 导致某些 iPhone 崩溃

> ID：16071708
> 
> 赞同：0
> 
> 时间：2013-04-17T22:59:20.687
> 
> 标签：ios, xcode, rotation, uiimage

在我的应用程序上，我构建了一个 PDF。我将图像添加到 PDF 文件。当我使用 UIImagePickerController 并选择一张肖像照片时，它会自动将其向左旋转 90 度。所以，为了解决这个问题，以及在图像周围添加边框，我使用了这段代码。但是，在 iPhone 3GS 上，当添加较大的照片时，应用程序会崩溃。关于这段代码在哪里导致问题的任何想法？

```
- (UIImage *)scaleAndRotateImage:(UIImage *)image {
    int kMaxResolution = 640; // Or whatever

    CGImageRef imgRef = image.CGImage;

    CGFloat width = CGImageGetWidth(imgRef);
    CGFloat height = CGImageGetHeight(imgRef);

    CGAffineTransform transform = CGAffineTransformIdentity;
    CGRect bounds = CGRectMake(0, 0, width, height);
    if (width > kMaxResolution || height > kMaxResolution) {
        CGFloat ratio = width/height;
        if (ratio > 1) {
            bounds.size.width = kMaxResolution;
            bounds.size.height = roundf(bounds.size.width / ratio);
        }
        else {
            bounds.size.height = kMaxResolution;
            bounds.size.width = roundf(bounds.size.height * ratio);
        }
    }

    CGFloat scaleRatio = bounds.size.width / width;
    CGSize imageSize = CGSizeMake(CGImageGetWidth(imgRef), CGImageGetHeight(imgRef));
    CGFloat boundHeight;
    UIImageOrientation orient = image.imageOrientation;
    switch(orient) {

        case UIImageOrientationUp: //EXIF = 1
            transform = CGAffineTransformIdentity;
            break;

        case UIImageOrientationUpMirrored: //EXIF = 2
            transform = CGAffineTransformMakeTranslation(imageSize.width, 0.0);
            transform = CGAffineTransformScale(transform, -1.0, 1.0);
            break;

        case UIImageOrientationDown: //EXIF = 3
            transform = CGAffineTransformMakeTranslation(imageSize.width, imageSize.height);
            transform = CGAffineTransformRotate(transform, M_PI);
            break;

        case UIImageOrientationDownMirrored: //EXIF = 4
            transform = CGAffineTransformMakeTranslation(0.0, imageSize.height);
            transform = CGAffineTransformScale(transform, 1.0, -1.0);
            break;

        case UIImageOrientationLeftMirrored: //EXIF = 5
            boundHeight = bounds.size.height;
            bounds.size.height = bounds.size.width;
            bounds.size.width = boundHeight;
            transform = CGAffineTransformMakeTranslation(imageSize.height, imageSize.width);
            transform = CGAffineTransformScale(transform, -1.0, 1.0);
            transform = CGAffineTransformRotate(transform, 3.0 * M_PI / 2.0);
            break;

        case UIImageOrientationLeft: //EXIF = 6
            boundHeight = bounds.size.height;
            bounds.size.height = bounds.size.width;
            bounds.size.width = boundHeight;
            transform = CGAffineTransformMakeTranslation(0.0, imageSize.width);
            transform = CGAffineTransformRotate(transform, 3.0 * M_PI / 2.0);
            break;

        case UIImageOrientationRightMirrored: //EXIF = 7
            boundHeight = bounds.size.height;
            bounds.size.height = bounds.size.width;
            bounds.size.width = boundHeight;
            transform = CGAffineTransformMakeScale(-1.0, 1.0);
            transform = CGAffineTransformRotate(transform, M_PI / 2.0);
            break;

        case UIImageOrientationRight: //EXIF = 8
            boundHeight = bounds.size.height;
            bounds.size.height = bounds.size.width;
            bounds.size.width = boundHeight;
            transform = CGAffineTransformMakeTranslation(imageSize.height, 0.0);
            transform = CGAffineTransformRotate(transform, M_PI / 2.0);
            break;

        default:
            [NSException raise:NSInternalInconsistencyException format:@"Invalid image orientation"];

    }

    UIGraphicsBeginImageContext(bounds.size);

    CGContextRef context = UIGraphicsGetCurrentContext();

    if (orient == UIImageOrientationRight || orient == UIImageOrientationLeft) {
        CGContextScaleCTM(context, -scaleRatio, scaleRatio);
        CGContextTranslateCTM(context, -height, 0);
    }
    else {
        CGContextScaleCTM(context, scaleRatio, -scaleRatio);
        CGContextTranslateCTM(context, 0, -height);
    }

    CGContextConcatCTM(context, transform);

    CGContextDrawImage(UIGraphicsGetCurrentContext(), CGRectMake(0, 0, width, height), imgRef);
    self.imageCopy = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    [self buildwithpic];
    return self.imageCopy;

} 
```

# mysql - 为用户和活动加入 city_name

> ID：16071709
> 
> 赞同：0
> 
> 时间：2013-04-17T22:59:23.627
> 
> 标签：mysql, join

我正在尝试获取事件的城市名称和用户居住地的城市名称。它们都有一个邮政编码，对应于表中的 city_name `cities`。

到目前为止我的查询：

```
SELECT
    meetups.meetup_name,
    meetups.meetup_text,
    users.username,
    cities.city_name
FROM
    meetups, users, cities
WHERE
    meetups.url_meetup = ? and users.id = meetups.author_id and cities.postalcode = meetups.postalcode 
```

我仍然需要得到用户的城市名称。

我的表格如下所示：

```
meetups =>
    id
    meetup_url
    meetup_name
    meetup_text
    author_id
    postalcode

users =>
    id
    username
    postalcode

cities =>
    postalcode
    city_name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:44:54.650

试试这个：

```
SELECT
meetups.meetup_name,
meetups.meetup_text,
users.username,
meetups.postalcode as mPC,
(select cities.city_name from cities where cities.postalcode = mPC) as mCity,
users.postalcode as uPC,
(select cities.city_name from cities where cities.postalcode = uPC) as uCity,
FROM
meetups, users, cities
WHERE
meetups.url_meetup = ?
AND users.id = meetups.author_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:54:59.270

```
SELECT
    meetups.meetup_name,
    meetups.url_meetup,
    meetups.meetup_text,
    users.username,
    c1.city_name as meetup_city,
    c2.city_name as user_city   
FROM
meetups, users, cities c1, cities c2   
WHERE
url_meetup = ? 
and users.id = meetups.author_id 
and c1.postalcode = meetups.postalcode
and c2.postalcode = users.postalcode 
```

这也应该让你得到用户城市的名称。

# javascript - Angularjs 数据绑定与数据属性对象

> ID：16071711
> 
> 赞同：0
> 
> 时间：2013-04-17T22:59:25.180
> 
> 标签：javascript, angularjs, coffeescript

我有一些 json 附加到页面上的数据属性。json数据用于在angularjs中建表。我正在使用咖啡脚本和haml。

```
 app = angular.module("myApp", [])

    app.controller "TableCtrl", ($scope) ->
      $scope.table =  $("#mydata").data("myjson")

    #table{"ng-app"=>"myApp","ng-controller" =>"TableCtrl"}
      %table
        %tbody
          %tr{"ng-repeat"=>"(i,item) in table" }}"}
            %td {{item.name}} 
```

该页面将数据加载到表中。在页面的其他地方，用户可以使用 jquery 更改数据属性上的 json。如何在 json 数据和表之间进行 2 路绑定？即我希望表在数据属性上的json在本地更改时更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:39:58.480

您需要告诉 AngularJS 观察`$("#mydata").data("myjson")`任何变化，然后`$scope.table`在发生变化时更新。尝试将以下代码添加到您的控制器（对不起，我不知道 coffeescript）。

```
$scope.$watch(
    function () { return $("#mydata").data("myjson");}, 
    function(newJson) {
        $scope.table = newJson;
    },
    true
); 
```

# javascript - 在流星助手中发出 ajax 请求

> ID：16071714
> 
> 赞同：6
> 
> 时间：2013-04-17T22:59:45.653
> 
> 标签：javascript, ajax, meteor

将数据返回到流星助手方法时，我如何才能等到 ajax 请求完成。

例如，

```
Template.item.helpers({

        itemName:function () {
            var user = Meteor.user();

            $.when(reallyLongAjaxRequest()).done(function (a1) {
               //tried using jquery when
                return "Item Name should have this because it waited";
            });

            return " Doesnt wait at all";
        }
    }); 
```

我`reallyLongAjaxRequest()`正在跑步，我希望它在继续使用我的 itemName 助手之前完成。控制台的日志语句始终显示未定义，但那是因为 ajax 请求尚未完成。我在没有运气的情况下尝试使用 jquery。有任何想法吗

编辑：

我应该提到我在辅助函数中是有原因的。我需要渲染项目“id”，以便我可以使用该参数运行 ajax 请求。使用反应式会话将是完美的，但我不知道有一种方法可以让当前呈现的项目超出辅助方法定义吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T00:35:10.120

未命名的集合是`null`传递名称的集合。它是内存中的数据结构，不保存到数据库中。（[http://docs.meteor.com/#meteor_collection](http://docs.meteor.com/#meteor_collection)）

好的，给定一个名为“items”的 Meteor 集合，并希望根据 item _id 为每个项目执行 ajax 请求，然后能够在模板中引用 ajax 结果，这就是我要做的：

（大致）

```
var Items = new Meteor.Collection('items');
var Results = new Meteor.Collection(null);

Items.find().observeChanges({
  added: function (id) {
    $.get(url, {id: id}, function (data) {
      if (Results.findOne(id))
        Results.update(id, {$set: {result: data}});
      else
        Results.insert({_id: id, result: data});
    });
  }
});

Template.item.itemName = function (id) {
  var doc = Results.findOne(id);
  if (doc)
    return doc.result;
  else
    return "";
}; 
```

在您的 html 中，您需要将 id 传递给帮助程序：

```
{{itemName _id}} 
```

*在定义帮助程序时有没有办法只超时几秒钟，以便我的 ajax 请求完成而不立即返回。*

不，通过反应式编程，事情会立即发生，但是当你有新东西时你会更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:29:18.110

单独提出您的 ajax 请求，并在完成后将结果存储在 Session 变量中。然后让您的模板助手返回 Session 变量的值。大致...

```
$.get(url, function (data) {
  Session.set('result', data);
});

Template.item.itemName = function () {
  return Session.get('result');
}; 
```

Session是一个响应式数据源，所以当ajax调用的结果进来时，你的模板会自动更新。（当然你可以选择调用任何你喜欢的Session变量，我只是以“result”为例）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-06-29T18:12:16.050

这在 MeteorJS > 1.3.x 中有效并经过测试

从控制台添加 http 包`meteor add http`

示例 POST 调用，其中数据元素被发送到服务器并带有自定义标头。

```
HTTP.call('POST', tokenUri, {
    data: {
        "type": 'authorization_code',
        //"client_id": clientId,
        "code": code,
        "redirect_uri" : redirectUri,

    },
    headers: {
        "Access-Control-Allow-Origin" : "*",
        "Access-Control-Allow-Credentials" : "true",
        "Access-Control-Allow-Methods" : "GET,HEAD,OPTIONS,POST,PUT",
        "Access-Control-Allow-Headers" : "Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers",
    }
},function(error, response) {
    if ( error ) {
        console.log( error );
    } else {
        console.log( response );
    }
}); 
```

# php - 仅返回与 strstr() 匹配的匹配项

> ID：16071718
> 
> 赞同：-1
> 
> 时间：2013-04-17T23:00:32.670
> 
> 标签：php

假设我有以下字符串：

> $string = '很棒的@jason，我想@sally 也会喜欢的。'

我在用着：

```
$mentions = strstr($string, '@');
echo $mentions 
```

**哪个输出**

```
@jason I think @sally would love it too. 
```

**期望的输出**

```
@jason @sally 
```

我只是不知道如何在 php 中做到这一点，在 js 中我只是这样做：

```
hashtags = /\@\w+/g;
var matches = string.match(hashtags);
alert(matches); 
```

php 中的 preg_match() 返回一个布尔值，所以我能得到的最接近的是 strstr()... 但在第一次匹配后返回整个字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:03:59.710

您可以使用`preg_match_all`相同的正则表达式：

```
<?php

$string = 'Great @jason I think @sally would love it too.';
preg_match_all("/@\w+/", $string, $matches);

var_dump($matches);

?> 
```

**演示：http: [//ideone.com/NgrRvH](http://ideone.com/NgrRvH)**

# git - 获取 git stash 父提交

> ID：16071720
> 
> 赞同：4
> 
> 时间：2013-04-17T23:00:39.493
> 
> 标签：git, git-stash

有没有办法检索最初创建存储的提交？

使用默认命令创建存储时，`git stash`原始提交保存在存储消息中，因此通常如下所示：

```
stash@{0}: WIP on master: abc123 This is the message of some commit. 
```

但是，如果`git stash save 'a stash message'`使用，则提交不会出现在存储列表中：

```
stash@{1}: On master: my own message 
```

那么如何找回呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:04:13.663

我会说

```
git log -1 commitish^ 
```

例如

```
git log -1 stash@{0}^ 
```

否则，

```
git log -g --no-walk --parents refs/stash 
```

# c# - 在 Azure 上调整大小/缓存 JPEG 图像

> ID：16071723
> 
> 赞同：4
> 
> 时间：2013-04-17T23:00:46.563
> 
> 标签：c#, asp.net-mvc, azure

我有一个用 .NET 4.5 / MVC 4 编写的网站，允许用户上传图片等。这些图像可以以各种尺寸显示在整个站点中。目前，其工作方式如下：

*   图像被上传并在内存中重新调整大小，最大宽度为 640 像素（站点将显示的最大宽度）。
*   调整大小的图像保存到磁盘的 /assets/photos/source/{id}-{timestampash}.jpg。
*   当请求各种尺寸的图像时，我通过组合 {id}-{hash} 来获取文件名，其中 {hash} 是 id、高度、宽度和我需要获取的其他一些信息的组合的哈希值图片。
*   如果该图像存在于 /assets/photos/cache 中，我只需将其返回，否则我使用源图像在内存中创建它，然后将其保存到缓存目录中。

我喜欢这种方法，因为它发生得很快，而且这一切都发生在内存中或通过磁盘检索。

我想最终将我的网站移动到 Azure。考虑到我的所有图像都将存储为 blob，这样的工作流将如何在 Azure 中发生？使用这样的调整大小/缓存策略是否仍然有效，还是有其他选择？当图像从今天的服务器上传到 Azure 时，您不会产生网络延迟，它只是被保存到磁盘，这显然要快得多？

只是寻找一些关于如何将这样的工作流迁移到 Azure 的可行和可扩展的方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T01:38:55.117

鉴于您在上面的评论，为什么不创建一个后台任务，在上传时将大小调整为所有可接受的大小，并将每个任务存储到 Azure blob 存储中。你是对的，如果你根据请求调整大小，你会遇到一些延迟和滞后，因为你需要下载源图像，调整大小，然后上传到 blob 存储，然后将用户重定向到你的 blob 存储 url。鉴于 blob 存储的“便宜”，我认为多花几毛钱购买额外的存储将超过上述场景的潜在缓慢性。

伪代码如下：

```
[HttpPost]
public ActionResult FileUpload(HttpPostedBaseFile file){
   if(ValidateFile(file)){
      //fire off a background tasks that resizes and stores each file size to the azure
      //blog storage.  You could use a naming scheme such as id_size.imageTypeExtension
   } 
} 
```

现在，当被要求提供文件时，您仍然可以使用相同的例程，但不是返回文件结果，而是返回重定向结果

```
public ActionResult GetImage(string hash){
    //do stuff to get image details
    return Redirect("http://yourAzureBlobStorageDomain.com/Assets/Images/Cache/" + imageDetails")
} 
```

这很酷，因为您不需要将图像下载到 Web 服务器然后提供它，而只需将请求直接重定向到 blob 存储！这会影响如下的图像标签

`<img src="@Url.RouteUrl("GetImage", "Images" new {hash = hash})"/>` 会影响您的 Web 应用程序，强制重定向到 Blob 存储中的实际图像位置。

您不想在 Azure Web 角色上永久存储任何内容是正确的，因为 Web 角色可以随时移动，从而丢失任何本地存储的数据。

这只是一种简单的方法，可以让您的代码库保持现在的状态，只需进行最少的更改。您可以修改它以使其行为更像您现在所拥有的，因为如果图像存在，您可以查询 blob 存储，如果存在，则重定向，如果不存在，则生成，存储和重定向，但我相信您会发现您会鉴于您需要下载源图像，完成您的工作，然后重新上传图像，然后再指示用户的浏览器去哪里找到它，此时还有更多延迟问题。

但是，这将由您决定是否值得花费额外的时间来按需调整大小与存储每个图像的多个大小的成本。附带说明一下，当从我们的 web/worker 角色使用 blob 存储时，我们没有注意到明显的延迟问题。显然它高于从磁盘中检索，但它并没有真正构成我们能够看到的显着增加。

# java - Ant Javac 任务删除方法

> ID：16071724
> 
> 赞同：0
> 
> 时间：2013-04-17T23:00:48.167
> 
> 标签：java, eclipse, compiler-errors, javac

我在 Java 项目中遇到了一些非常奇怪的行为。情况`javac`似乎是在编译期间从类中删除了一个方法。

该类看起来像这样：

```
public class MessedUp extends X {
    //a bunch of variables here
    //a bunch of methods here

    public void thisDisappears(String arg){

    }

    //a bunch more methods here

} 
```

还有另一个类实例化并调用此方法：

```
public class WontCompile {

    public void doSomething(){
        MessedUp mu = new MessedUp();
        mu.thisDisappears("something");
    }
} 
```

第一个类编译得很好，但第二个没有。`javac`输出如下内容：

```
[javac] C:\mypath\WontCompile.java:251: error: cannot find symbol
[javac]                     mu.thisDisappears("something");
[javac]                       ^
[javac]   symbol:   method thisDisappears(String)
[javac]   location: variable mu of type MessedUp 
```

我知道代码很好，因为我已经在 Eclipse 中使用它几年了（当我尝试使用`ant`Eclipse 生成的文件时，我正在追踪这个问题）。但是，有时 Eclipse 会突出显示对 的调用`thisDisappears`，说它不存在，并提供创建它。如果接受这个提议，那么 Eclipse 会抱怨有两个同名的方法。经过一些明显导致重建或其他事情的处理后，错误消失了。

在被驱动了一段时间后，我决定检查 MessedUp.java 的实际类文件。使用[Java Decompiler GUI](http://java.decompiler.free.fr/?q=jdgui)，我发现`thisDisappears`类文件中不存在它！

下面是我的蚂蚁文件：

```
<project basedir="." default="build" name="MyProject">
    <property name="LIB_HOME" value="C:\dev\LibSuite-9.3.1"/>
    <property environment="env"/>
    <property name="debuglevel" value="source,lines,vars"/>
    <property name="target" value="1.7"/>
    <property name="source" value="1.7"/>
    <path id="MyProject.classpath">
        <pathelement location="bin"/>
        <pathelement location="lib/edu.mit.jwi_2.1.4.jar"/>
        <pathelement location="lib/edu.sussex.nlp.jws.beta.11.jar"/>
        <pathelement location="lib/jaws-bin.jar"/>
        <pathelement location="lib/junit-4.11.jar"/>
        <!--External Jars-->
        <pathelement location="${LIB_HOME}/share/java/abc.jar"/>
        <pathelement location="${LIB_HOME}/share/java/def-9.3.1.jar"/>
    </path>
    <target name="init">
        <mkdir dir="bin"/>
        <copy includeemptydirs="false" todir="bin">
            <fileset dir="main/src">
                <exclude name="**/*.launch"/>
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
        <copy includeemptydirs="false" todir="bin">
            <fileset dir="main/test">
                <exclude name="**/*.launch"/>
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
    </target>
    <target name="clean">
        <delete dir="bin"/>
    </target>

    <target depends="init" name="build">
        <echo message="${ant.project.name}: ${ant.file}"/>
        <javac debug="true" debuglevel="${debuglevel}" destdir="bin" includeantruntime="false" source="${source}" target="${target}">
            <classpath refid="MyProject.classpath"/>
            <src path="main/src"/>
            <src path="main/test"/>
            <compilerarg value="-Xlint"/>
        </javac>
    </target>

    <!--Test the app-->
    <target depends="build" name="regression">
        <junit>
            <classpath refid="MyProject.classpath"/>
            <test name="uni.my.app.TestSuite"/>
        </junit>
    </target>

    <!--Run the app-->
    <target depends="build" name="run">
        <java classname="uni.my.app.Application">
            <classpath refid="MyProject.classpath"/>
            <arg value="sentences.txt"/>
        </java>
    </target>
</project> 
```

不幸的是，我无法整理出一个最小的破坏示例。我正在编写的代码还没有向公众发布，所以我还不能全部分享。它引用了几个 jars（没有冲突的命名空间），其中一些带有本地方法。我不知道类和罐子的确切组合会导致错误。我在使用 jdk 1.6.0_25 和 1.7.21 时遇到了同样的问题。

有没有人对如何解决这个问题有任何经验或想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:54:36.680

这是一个猜测。

Ant 在 eclipse 之外运行，因此它所做的任何更改都不会反映在 eclipse 的大量缓存的世界视图中。据我所知，eclipse 的更改也不会反映在 ant 使用的文件中。

我会做一个项目清理，然后是项目构建，然后是项目刷新。我会看看你是否在 Eclipse 中遇到了这个问题。然后我会运行 ant（如果必须的话），再次刷新，然后看看问题是否存在。

每当您在 eclipse 或 ant 中执行任何操作时，在使用其他程序之前，请刷新 eclipse 项目。

让我们知道怎么回事。

ps 相信 java 编译器不会删除任何方法。我同意你发生了一些奇怪的事情，但事实并非如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T03:20:10.370

问题是，无论出于何种原因，另一个用户已经将项目转换为 VCS，所有类文件都位于与其相应源相同的文件夹中。在我的机器上，Eclipse 将二进制文件放入`bin`文件夹中，所以我不知道为什么将它们与其他用户机器上的源一起放置。

Eclipse 生成的`init`目标旨在复制代码使用的资源。它从源目录复制除文件之外`java`的任何内容。`launch`但是，由于类文件位于源目录中，因此它也将它们复制了过来。然后，当`build`目标被执行时，它不会编译任何东西，因为似乎已经存在新的类文件（但它们实际上只是旧代码的新副本）。

解决方案是 1) 从源文件夹中删除所有类文件，以及 2) 为`**/*.class`资源复制代码添加排除规则，这是一个很好的衡量标准。

# java - 如何让程序显示可被 5 整除的值的总和，而不是仅显示值本身？

> ID：16071725
> 
> 赞同：0
> 
> 时间：2013-04-17T23:01:00.877
> 
> 标签：java, loops, methods

程序要求创建一个方法。该方法有两个参数：开始和结束，都是整数。该方法必须将 start 和 end 之间可被 5 整除的所有数字相加。例如，如果 start 为 1，end 为 30，则答案必须为 105，因为 5 + 10 + 15 + 20 + 25 + 30 = 105是能被 5 整除的数，属于 1 和 5 的范围。

```
import java.util.*;

public class Divisor{

  public static void main(String[] args){

    Scanner input = new Scanner(System.in);

    System.out.print("Enter a start: ");
    int start = input.nextInt();

    System.out.print("Enter an end: ");
    int end = input.nextInt();

    int result6 = sumDivisor(start, end); 
    System.out.println(result6);

}

 public static int sumDivisor (int start, int end){
    int value = end;
    for(int i = 5;i <= end;i = i + 5){
      value = i;
      System.out.print(i + " ");      
    }
    return value;
  }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:36:24.200

您还必须考虑 start 参数不能被 5 整除的情况：

```
public static int sumDivisor (int start, int end){
int value = 0;
    while (start % 5 != 0) {            
        start++;
    }
for(int i = start;i <= end;i += 5){
  value += i;    
}
return value; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:02:43.190

不要返回最后一个数字，而是从它开始`0`并将满足您条件的每个数字添加到它。

# xml - XML Schema 中使用 ID+IDREF 和直接类型的区别？

> ID：16071726
> 
> 赞同：1
> 
> 时间：2013-04-17T23:01:07.890
> 
> 标签：xml, xsd, idref

我是 XSD 的新手，对以下两种模式之间的区别有疑问？

1）直接使用 IDREF 和 ID 将选择限制为文件中的另一个元素：

```
<xsd:element name="policy" >
  <xsd:complexType>
    <xsd:sequence>
      <xsd:element name="actor-def" 
                   type="tns:actor-def"/>                        
      <xsd:element name="actor-system-def" 
                   type="tns:actor-system-def"/>           
    </xsd:sequence>
  </xsd:complexType>
</xsd:element>

<xsd:complexType name="actor-def">
  <xsd:sequence>
    <xsd:element name="actor-system" 
                 type="tns:actor-system-type"/>
  </xsd:sequence>
  <xsd:attribute name="name" 
                 type="xsd:ID" 
                 use="required" />
</xsd:complexType>
<xsd:complexType name="actor-system-type">
  <xsd:attribute name="name" 
                 type="xsd:IDREF" 
                 use="required" />
</xsd:complexType>

<xsd:complexType name="actor-system-def">
  <xsd:attribute name="name" type="xsd:ID" use="required" />
  <xsd:attribute name="url" type="xsd:anyURI" use="required" />
</xsd:complexType> 
```

2）直接将元素的类型设置为其他元素类型：

```
<xsd:element name="policy">
  <xsd:complexType>
    <xsd:sequence>
      <xsd:element name="actor-def" 
                   type="tns:actor-def"/>
      <xsd:element name="actor-system-def" 
                   type="tns:actor-system-def"/>
    </xsd:sequence>
  </xsd:complexType>
</xsd:element>

<xsd:complexType name="actor-def">
  <xsd:sequence>
    <xsd:element name="actor-system" 
                 type="tns:actor-system-def"/>
  </xsd:sequence>
    <xsd:attribute name="name" 
                   type="xsd:ID" 
                   use="required" />
</xsd:complexType>

<xsd:complexType name="actor-system-def">
  <xsd:attribute name="name" 
                 type="xsd:ID" 
                 use="required" />
  <xsd:attribute name="url" 
                 type="xsd:anyURI" 
                 use="required" />
</xsd:complexType> 
```

在翻译的java类中将第一种方法与JAXB结合使用时，我遇到了一些问题，有人建议使用第二种方法回应我的另一篇文章。但是，我不确定这两种模式之间的主要区别是什么，哪一种适合我的应用程序？

# c#-4.0 - 我正在寻找一种特定的插入算法，但我想不出名字

> ID：16071727
> 
> 赞同：1
> 
> 时间：2013-04-17T23:01:12.503
> 
> 标签：c#-4.0, sorting

基本上我有一个方法，它将采用任何一组具有选定值的数字，并按升序对它们重新排序，以跟踪新的选定值。

所以 {21, 2, 9, 13} selectedVal = 9 变成 { 1, 2, 3, 4 } selectedVal = 2

我现在需要做的是能够交换 2 个号码并保持订单不变。如果我想用 4 交换 2，我需要 3->2 和 4->3，但也需要反过来，比如用 1 交换 3，所以 1->2 和 2->3。

我确信有一个经过验证的算法，明天我可能会创建自己的有趣的算法，但我希望在我的实际应用程序中使用最快的解决方案。

算法的名称或任何有用的链接将不胜感激。如果这很重要，我正在使用 C# 4.0。

编辑 - 我想出了我自己的解决方案，我相信它在纸上有效，但如果有人知道更好的解决方案，我仍然希望得到答复。

假设有序列表总是从 1 开始，这在我的情况下......

```
if (newpos < currpos)
   for (int i = newpos-1; i < currpos-1; i++)
   {
       array[i] += 1;
       array[currpos-1] = newpos;
   }     
else if (newpos > currpos)
   for (int i = newpos-1; i >= currpos-1; i--)
   {
       array[i] -= 1;
       array[currpos-1] = newpos;
   }  
else // do nothing since they are trying to swap to the same place 
```

# model-view-controller - CustomErrors 不重定向到自定义页面但 MVC 默认错误页面

> ID：16071734
> 
> 赞同：1
> 
> 时间：2013-04-17T23:01:38.517
> 
> 标签：model-view-controller, web-config, custom-errors

我有一个使用 VS2012 web express 和 IIS Express 从头开始​​创建的新 MVC 4.0 解决方案。正如瓷砖所说，我更改了 web.config 并在中添加了以下内容：

```
<customErrors defaultRedirect="Errors/GenericError.html" mode="On">
    <error statusCode="404" redirect="Errors/Error404.html"/>
</customErrors> 
```

基本上，当我在控制器中遇到异常时，默认的 MVC error.cshtml 会显示错误，而不是我的自定义页面 GenericError.html。

如果我转到一个不存在的 URL，我的 Error404.html 会正确显示，但不适用于一般场景。

有什么想法可以改变这种行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:13:16.157

听起来您的全局过滤器中没有错误属性。在 MVC 4 项目中，您应该能够搜索为`FilterConfig`您生成的类：

```
public class FilterConfig
{
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute());
    }
} 
```

**更新：**

全局过滤器用于 MVC 管道中发生的`HandleErrorAttribute`错误，例如您提到的控制器中的错误。

中的`customErrors`元素适用于`web.config`其他所有内容。`HandleErrorAttribute`不会尊重您在 的`defaultRedirect`属性中输入的值`customErrors`。

过滤器将`HandleError`寻找您应该在生成的项目中拥有的共享视图`shared\Error.cshtml`。您可以通过在属性上设置属性将其指向不同的视图。

例如，假设我们在 下创建一个新视图`Shared\Errors\CustomError.cshtml`，那么您可以像这样注册过滤器：

```
filters.Add(new HandleErrorAttribute(){View = "Errors/CustomError"}); 
```

# ruby-on-rails-3.2 - 不使用 id 的 Active Record 关联

> ID：16071735
> 
> 赞同：1
> 
> 时间：2013-04-17T23:01:42.897
> 
> 标签：ruby-on-rails-3.2, associations

我不确定这是否没有得到回答，但我不确定要搜索什么，所以如果我要问的问题已经得到回答，请指出正确的方向。

我有 2 个模型：

stock_symbol 和 weight_symbol

stock_symbol中包含与weight_symbol 模型`symbol`匹配的内容`commodity`

我怎样才能让关联起作用，所以当我做 stock_symbol.weight_symbol 时，我会找回 weight_symbol。

我知道如何在 SQL 中做到这一点，但如果它不是标准`id`，`this_id`那么我大多迷失了。

编辑：

```
class StockSymbol < ActiveRecord::Base
  has_many :weight_symbols, primary_key: :symbol

  def commodity
    "LC" # This is just an example to simplify it, there is much more to this.
  end
end

class WeightSymbol < ActiveRecord::Base
  belongs_to :stock_symbol, foreign_key: :commodity
end 
```

来自 stock_symbol 的示例对象：

```
StockSymbol.last
<#StockSymbol id: 729, symbol: "LCJ13C12500", created_at: "2013-03-15 21:50:49", updated_at: "2013-03-15 21:50:49"> 
```

来自 weight_symbol 的示例对象：

```
WeightSymbol.first
<#WeightSymbol id:1, weight_group_id: 1, symbol: "LC", created_at: "2010-01-05 21:13:28", updated_at: "2010-01-05 21:13:28"> 
```

设置并运行后，`StockSymbol.last.weight_symbols.to_sql` 我得到：

```
"SELECT `weight_symbols`.* FROM `weight_symbols` WHERE `weight_symbols`.`stock_symbol_id` = 'LCJ13C12500'" 
```

编辑2：

查询它应该做什么（我认为）：

```
SELECT * FROM `weight_symbols` WHERE `weight_symbols`.`symbol` = 'LC'; 
```

查询以获取我想要的信息。

```
SELECT * FROM `weight_symbols` a
JOIN `stock_symbols` b
ON a.symbol = b.commodity
WHERE b.symbol = 'LCJ13C12500'; 
```

新的股票代码对象

```
<#StockSymbol id: 729, symbol: "LCJ13C12500", created_at: "2013-03-15 21:50:49", updated_at: "2013-03-15 21:50:49", commodity: "LC"> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:39:34.900

rails 关联方法带有覆盖关系中使用的默认键的选项。`StockSymbol`如果它是和之间的一对多关联`WeightSymbol`，则使用以下内容：

```
# stock_symbol.rb
has_many :weight_symbols, primary_key: :symbol

# weight_symbol.rb
belongs_to :stock_symbol, foreign_key: :commodity 
```

（不确定我是否以正确的方式获得了关联，但您应该明白这一点。）

[关联基础](http://guides.rubyonrails.org/association_basics.html)指南中的[详细关联参考](http://guides.rubyonrails.org/association_basics.html#detailed-association-reference)详细列出了属于每种关联类型的所有选项和方法。

* * *

**编辑**：基于您更新的问题的一些额外内容。

我对您的关联应该如何工作感到有些困惑——`WeightSymbol`似乎没有`commodity`属性。当? `WeightSymbol`_ `StockSymbol`_ `weight_symbol.symbol == stock_symbol.commodity`在这种情况下，您需要相应地设置键：

```
# stock_symbol.rb
has_many :weight_symbols, primary_key: :commodity
# :primary_key is the field on this model whose value associated models will store in their foreign_key

# weight_symbol.rb
belongs_to :stock_symbol, foreign_key: :symbol
# :foreign_key is the column on this model that should match the primary_key field in the associated model 
```

其次，您只能使用数据库列设置 Rails 关联，不能使用方法。如果您绝对必须使用一种方法，您可能会伪造关联，例如使用以下内容：

```
# stock_symbol.rb
def weight_symbol
  WeightSymbol.find_by_symbol(self.commodity)
end 
```

这样做的缺点是效率极低，并且会涉及大量的重新发明轮子。

如果您可以选择创建`commodity`一个数据库字段，那可能是最好的解决方案，具体取决于它可能更改的频率。例如，如果它是从模型的当前状态派生的，您可以在`before_save`模型上设置一个过滤器来执行需要发生的任何处理并将适当的值写入该字段：

```
# stock_symbol.rb
before_save :set_commodity

def set_commodity
  commodity = "LC" # arrived at through whatever processing you do
  self.commodity = commodity
end 
```

# java - 与 Java 服务器和 Javascript 客户端建立 WebSocket 连接

> ID：16071745
> 
> 赞同：3
> 
> 时间：2013-04-17T23:02:44.503
> 
> 标签：java, javascript, websocket, client

我正在尝试使用基于 Javascript 的客户端和基于 Java 的服务器来实现 WebSockets。我想我已经完成了所有正确的步骤，但由于未知原因，我无法与两者建立联系。

当服务端socket接收到一个连接时，它会处理形成一个websocket-accept响应，并返回给客户端，但是客户端socket中的连接立即关闭，奇怪的是没有握手问题。

有谁知道可能是什么问题？

这是我用java实现的服务器代码：

```
package server;

import java.io.IOException;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.ArrayList;
import java.util.List;

import server.message.Message;
import server.message.SpeakMessage;

public class Server implements ConnectionListener {
    private static final int PORT = 1509;
    private MessageDispatcher dispatcher = new MessageDispatcher();
    private List<ConnectionManager> clients = new ArrayList<>();

    public void listen() {
        try (ServerSocket server = new ServerSocket(PORT)) {
            System.out.printf("Listening on port %d...%n", PORT);
            while (true) {
                System.out.println("Waiting for connection...");
                Socket client = server.accept();
                System.out.println("Incoming connection - Attempting to establish connection...");
                ConnectionManager manager = new ConnectionManager(client, dispatcher, this);
                manager.start();
            }
        } catch (IOException e) {
            System.out.println("Unable to start server");
            e.printStackTrace();
        }
        System.exit(0);
    }

    public void execute() {
        try {
            while (true) {
                if (dispatcher.isEmpty()) {
                    Thread.sleep(100);
                    continue;
                }
                Message msg = dispatcher.read();
                if (msg instanceof SpeakMessage)
                    broadcast(MessageEncoder.spoke(((SpeakMessage) msg).getText()));
            }
        } catch (Exception e) {
            e.printStackTrace();
            System.exit(1);
        }
    }

    public static void main(String[] args) {
        final Server server = new Server();
        new Thread(new Runnable() {
            @Override
            public void run() {
                server.listen();
            }
        }).start();
        server.execute();
    }

    public synchronized void broadcast(byte[] message) {
        for (ConnectionManager client : clients) {
            client.send(message);
        }
    }

    @Override
    public synchronized void clientConnected(ConnectionManager who) {
        clients.add(who);
        System.out.println("Connected client " + clients.size());
    }

    @Override
    public synchronized void clientDisconnected(ConnectionManager who) {
        clients.remove(who);
    }
} 
```

下面是服务器的子类 ConnectionManager：

```
package server;

import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.lang.reflect.InvocationTargetException;
import java.net.Socket;
import java.security.MessageDigest;
import java.util.Properties;

import server.message.HandshakeMessage;
import server.message.Message;

public class ConnectionManager {
    private static final int CLIENT_VERSION = 1;
    private Socket socket;
    private MessageDecoder decoder = new MessageDecoder();
    private MessageDispatcher dispatcher;
    private ConnectionListener listener;

    public ConnectionManager(Socket connection, MessageDispatcher dispatcher, ConnectionListener listener) {
        socket = connection;
        this.dispatcher = dispatcher;
        this.listener = listener;
    }

    public void start() {
        Thread t = new Thread(new ChannelReader());
        t.setName("Client thread");
        t.setDaemon(true);
        t.start();
    }

    public void send(byte[] data) {
        if (socket == null)
            return;

        try {
            DataOutputStream dos = new DataOutputStream(socket.getOutputStream());
            dos.write(data);
            dos.flush();
        } catch (IOException e) {
            disconnect("Client closed the connection");
        }
    }

    private class ChannelReader implements Runnable {
        private boolean accepted = false;
        private String ret = null;

        @Override
        public void run() {
            try {
                DataInputStream in = new DataInputStream(socket.getInputStream());
                while (socket != null && socket.isConnected()) {
                    int len = in.readShort();
                    if (len < 0) {
                        disconnect("Invalid message length.");
                    }

                    String s;
                    readLine(in);
                    Properties props = new Properties();
                    while((s=readLine(in)) != null && !s.equals("")) {
                        String[] q = s.split(": ");
                        props.put(q[0], q[1]);
                    }

                    if(props.get("Upgrade").equals("websocket") && props.get("Sec-WebSocket-Version").equals("13")) { // check if is websocket 8
                        String key = (String) props.get("Sec-WebSocket-Key");
                        String r = key + "" + "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"; // magic key
                        MessageDigest md = MessageDigest.getInstance("SHA-1");
                        md.reset();
                        md.update(r.getBytes());
                        byte[] sha1hash = md.digest();

                        String returnBase = base64(sha1hash);

                        ret = "HTTP/1.1 101 Switching Protocols\r\n";
                            ret+="Upgrade: websocket\r\n";
                            ret+="Connection: Upgrade\r\n";
                            ret+="Sec-WebSocket-Accept: "+returnBase;

                    } else {
                        disconnect("Client got wrong version of websocket");
                    }

                    Message msg = decoder.decode((String) props.get("Sec-WebSocket-Protocol"));

                    if (!accepted) {
                        doHandshake(msg);
                    } else if (dispatcher != null) {
                        dispatcher.dispatch(msg);
                    }
                }
            } catch (Exception e) {
                disconnect(e.getMessage());
                e.printStackTrace();
            }
        }

        private void doHandshake(Message msg) {
            if (!(msg instanceof HandshakeMessage)) {
                disconnect("Missing handshake message");
                return;
            }
            HandshakeMessage handshake = (HandshakeMessage) msg;
            if (handshake.getVersion() != CLIENT_VERSION) {
                disconnect("Client failed in handshake.");
                return;
            }
            send(ret.getBytes());
            accepted = true;
            listener.clientConnected(ConnectionManager.this);
        }   

        private String base64(byte[] input) throws ClassNotFoundException, 
        SecurityException, NoSuchMethodException, IllegalArgumentException, 
        IllegalAccessException, InvocationTargetException, InstantiationException {
            Class<?> c = Class.forName("sun.misc.BASE64Encoder");
            java.lang.reflect.Method m = c.getMethod("encode", new Class<?>[]{byte[].class});
            String s = (String) m.invoke(c.newInstance(), input);
            return s;
        }

        private String readLine(InputStream in) {
            try{
                String line = "";
                int pread;
                int read = 0;
                while(true) {
                    pread = read;
                    read = in.read();
                    if(read!=13&&read!=10)
                        line += (char) read;
                    if(pread==13&&read==10) break;
                }
                return line;
            }catch(IOException ex){

            }
            return null;
        }

    }

    public synchronized void disconnect(String message) {
        System.err.println(message);
        if (socket != null) {
            try {
                socket.close();
            } catch (IOException e) {

            }
        }
        socket = null;
        listener.clientDisconnected(ConnectionManager.this);
    }
} 
```

和 MessageDispatcher：

```
package server;

import java.util.Queue;
import java.util.concurrent.LinkedBlockingDeque;

import server.message.Message;

public class MessageDispatcher {
    Queue<Message> messageQueue = new LinkedBlockingDeque<>();

    public void dispatch(Message message) {
        messageQueue.offer(message);
    }

    public Message read() {
        return messageQueue.poll();
    }

    public boolean isEmpty() {
        return messageQueue.isEmpty();
    }
} 
```

这是我用 javascript 实现的客户端代码：

```
var canvas, // Canvas DOM element
    ctx,    // Canvas rendering context
    socket; // Socket connection

function init() {
    // Initialise the canvas
    canvas = document.getElementById("gameCanvas");
    ctx = canvas.getContext("2d");
    // Maximise the canvas
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Initialise socket connection
    if (window.WebSocket) { 
        socket = new WebSocket("ws://localhost:1509/", ["1", "YURI"]);
        socket.onopen = onSocketConnected();
        socket.onclose = onSocketDisconnect();
        socket.onmessage = onSocketMessage();
        socket.onerror = onSocketError();
    } else {
        alert("The browser does not support websocket.");
    }

};

// Socket message
function onSocketMessage(message) {
    console.log('Message: ' + message.data);
};

// Socket error
function onSocketError(error) {
    console.log('Error: ' + error.data);
};

// Socket connected
function onSocketConnected() {
    console.log("Connected to socket server");
};

// Socket disconnected
function onSocketDisconnect() {
    console.log("Disconnected from socket server");
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-04T21:20:03.887

我认为，这是因为您使用的是 Java 服务器端的 Socket 包和客户端的 WebSocket API。您的想法确实很好，但技术错误。将 WebSocket 保留在客户端（Javascript），因为您没有很多其他可能性，但请尝试在服务器端（Java）使用 JWebSocket。事实上，WebSocket 使用 TCP/IP，但它自己的 TCP/IP 通信协议。Java Socket 包是纯粹的 TCP/IP。使用 JWebSocket 重新编写您的服务器，有关 JWebSocket 的所有详细信息都可以在以下位置找到：http: [//jwebsocket.org/](http://jwebsocket.org/)。希望我的回答对你有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-22T05:48:08.753

您必须使用**“\r\n\r\n”指定返回数据包的结尾**

```
 ret = "HTTP/1.1 101 Switching Protocols\r\n";
   ret+="Upgrade: websocket\r\n";
   ret+="Connection: Upgrade\r\n";
   ret+="Sec-WebSocket-Accept: "+returnBase + "\r\n\r\n"; 
```

**并为创建我使用的接受密钥**

```
public class WSKeyGenerator {
    private final static String MAGIC_KEY =
            "258EAFA5-E914-47DA-95CA-C5AB0DC85B11";
    public static String getKey(String strWebSocketKey) throws
            NoSuchAlgorithmException {
        strWebSocketKey += MAGIC_KEY;
        MessageDigest shaMD = MessageDigest.getInstance("SHA-1");
        shaMD.reset();
        shaMD.update(strWebSocketKey.getBytes());
        byte messageDigest[] = shaMD.digest();
        BASE64Encoder b64 = new BASE64Encoder();
        return b64.encode(messageDigest);
    }
} 
```

我建议使用[http://websocket.org/echo.html](http://websocket.org/echo.html)来检查服务器的 websocket 功能

# c# - 如何为 Windows 表单中每个可能的枚举值创建一个复选框？

> ID：16071747
> 
> 赞同：1
> 
> 时间：2013-04-17T23:02:48.367
> 
> 标签：c#, .net, winforms, reflection, dialog

假设我们有一个`enum Identifier {Name, Id, Number}`并且我们想为用户提供一个消息，如对话框，每个可能的`Identifier`值只有复选框和 Ok 按钮。在对话框确认中得到一个`List<Identifier>`（如果没有选中任何复选框，则为空）。如何用winforms做这么简单的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T23:20:58.637

您可以通过以下方式在枚举中获取一组值：

```
var valuesArray = Enum.GetValues(typeof (Identifier)); 
```

要显示复选框：

```
foreach (var val in valuesArray)
{
    //create checkbox
    var cb = new CheckBox();
    cb.Name = string.Format("cb_{0}", val);
    cb.Text = val; //set your properties

    //add to your form controls
    this.Controls.Add(cb);
} 
```

要获取列表，只需获取表单上的所有复选框：

```
var checkedIdentifiers = new List<Identifier>();
foreach (var val in valuesArray)
{
    //find checkbox
    var cb = this.Controls[string.Format("cb_{0}", val)];
    if (cb != null && cb.Checked)
        checkedIdentifiers.Add((Identifier)Enum.Parse(typeof(Identifier), val));
} 
```

您可以对上述内容进行额外的错误检查，但这就是要点。

# python - SQLite 与 Python 2.X 的关系

> ID：16071753
> 
> 赞同：0
> 
> 时间：2013-04-17T23:03:54.507
> 
> 标签：python, python-2.7, sqlite

我对sqlite3和python 2.x的关系有点疑惑

这是输出：

```
$ python
Python 2.7.2+ (default, Jul 20 2012, 22:12:53) 
[GCC 4.6.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sqlite3
>>> sqlite3.version
'2.6.0'
>>> sqlite3.sqlite_version
'3.7.7' 
```

'3.7.7' 应该是我的 Ubuntu 操作系统上的 sqlite 版本。

但是，当我尝试

```
sqlite3 test.db 
bash: sqlite3: command not found 
```

这意味着这台机器上没有安装 sqlite3。

那么如何使用 PRAGMA 语句，例如“PRAGMA encoding = “UTF-8”；” 在python中创建数据库时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:21:34.743

第一的：

> '3.7.7' 应该是我的 Ubuntu 操作系统上的 sqlite 版本。

不，这是构建 Python 的 sqlite 库的版本。

如果 Python 是针对静态库构建的，则没有理由期望它以任何方式与系统上的其他任何东西相关联。即使它是针对共享库构建的，它也不必*与*发行版的默认`sqlite`包使用的共享库相同（尽管通常是这样）。

而且，即使 Python*是*针对作为发行版默认共享库的相同共享库构建的：Ubuntu 与许多发行版一样，允许您在不安装命令行工具`libfoo.so`的情况下安装大多数共享库。`foo`

特别是，如果您查看 Ubuntu 软件包（至少对于最近的版本），软件包中有 sqlite 共享库`libsqlite3`，并且两者都`python`依赖`sqlite3`于该`libsqlite3`软件包。

所以，如果你想要`sqlite3`命令行工具，你必须安装它；您不会通过安装 Python 自动获得它。

* * *

同时：

> 有没有办法在 python 代码中使用 PRAGMA encoding = "UTF-8" ？

当然。A`PRAGMA`只是影响会话其余部分的 SQL 语句。无论您是在命令行工具中执行它，还是在 Python`execute`命令中，或者通过加载 SQL 脚本等方式执行它都没有关系。只需执行它。

但是，正如您在评论中指出的那样，根据[文档](http://www.sqlite.org/pragma.html#pragma_encoding)，除非您可以在连接到数据库*之前*运行它，否则这个特定的编译指示不会产生任何影响。因为 DB-API 2.0（Python`sqlite3`模块和大多数其他 Python 数据库模块都构建到的 API）没有任何方式在未连接状态下执行语句，所以没有简单的方法解决这个问题。

当然，您可以查看 Python 的各种替代（通常没有经过很好的测试，而且速度较慢）sqlite3 实现，或者 fork 并将[源代码](https://code.google.com/p/pysqlite/source/browse/)修改为`pysqlite`（定期包含在 stdlib 中的模块`sqlite3`）。

如果你想这样做，要看的地方`pysqlite_connection_init`是[`connection.c`](https://code.google.com/p/pysqlite/source/browse/src/connection.c#64). 您可能不想添加通用的 pre-connect pragma 支持，而是通过另一个参数来控制编码的方法`connect`。请参阅[`open`](http://www.sqlite.org/c3ref/open.html)文档`sqlite3`以了解您可以在此处进行哪些有用的操作。（然后你可能想提交一个错误并提交一个补丁。它永远不会进入 Python 2.x，但任何在 pysqlite 中被接受的东西最终都会在 Python 3.x 中结束。）

但是做你想做的更简单的方法正是你想要做的：在 Python 之外创建数据库。只需`sqlite3`以您最喜欢的方式安装软件包（`apt-get`GUI 包装器之一，等等）并使用它。

* * *

最后一件事：据我所知，根据您的版本，Python 的模块将明确使用 UTF-8，或者使用默认编码，即 UTF-8。所以，你不需要在这里做任何事情。

# java - 有没有一种安全的方法来区分 SendFailedExceptions 和 JavaMail 的类型

> ID：16071756
> 
> 赞同：0
> 
> 时间：2013-04-17T23:04:09.403
> 
> 标签：java, jakarta-mail, sendmail, blacklist

我目前正在收到，`SendFailedException`因为我的 sendmail 实例有一些电子邮件地址被列入黑名单（在测试期间过滤掉所有发给非开发人员的电子邮件）。但`SendFailedException`也可能表明无法连接到 SMTP 服务器或其他原因。当由于电子邮件被列入黑名单而发生此异常时，我需要忽略该消息并继续，但应允许任何其他异常传播到我的方法之外。当我查看 JavaMail API 时，它似乎`SendFailedException`是我能得到的最低级别的异常（`javax.mail`包中的最后一个）。我真正需要的是底层的[SMTPSendFailedException](http://javamail.kenai.com/nonav/javadocs/com/sun/mail/smtp/SMTPSendFailedException.html)，但那是在`com.sun.mail`包，据我所知，这意味着它是特定于实现的，不应使用。但是，该类实际上有一个`getReturnCode()`方法可以用来区分`SendFailedException`s. 有一个更好的方法吗？使用`com.sun.mail`类安全吗？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:36:58.470

您可以使用 javadocs 中描述的 com.sun.mail 类。与我们努力保持稳定和兼容的标准 javax.mail 类不同，com.sun.mail 类在未来的版本中出现不兼容的可能性很小。我们知道很多人使用这些类，所以我们不会轻易做出这样的改变，但如果需要改进 JavaMail 实现或支持新的标准 API 类，它们可能会改变。

请注意，还有很多 com.sun.mail 类**没有**在 javadocs 中描述。使用这些风险更高；即使在较小的版本中，它们也更有可能发生不兼容的变化。

# c++ - 访问冲突是什么意思？

> ID：16071757
> 
> 赞同：1
> 
> 时间：2013-04-17T23:04:11.013
> 
> 标签：c++, access-violation

我是 C++ 新手，不明白为什么会收到错误“访问冲突读取位置”。这是我的代码：

```
gdiscreen();
int startX = 1823 - minusX;
int startY = 915 - minusY;
for (int i = startX; i < startX + 61; i++)
{
    for (int j = startY; j < startY + 70; j++)
    {
        Color pixelColor;
        bitmap->GetPixel(i, j, &pixelColor);
        cout << pixelColor.GetValue() << " ";
    }
    cout << endl;
} 
```

gdiscreen() 可以在这里找到： [http ://forums.codeguru.com/showthread.php?476912-GDI-screenshot-save-to-JPG](http://forums.codeguru.com/showthread.php?476912-GDI-screenshot-save-to-JPG)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:05:09.157

*访问冲突*或*分段错误*意味着您的程序试图访问未在范围内保留的内存。
有几个例子如何实现这一点：

### 离开数组的边界：

```
int arr[10];
for(unsigned char i=0; i<=10; i++)  //Will throw this error at i=10
    arr[i]=0; 
```

^(**注意：** *在上面的代码中，我使用`unsigned char`迭代。Char 是一个字节，`unsigned char`0-255 也是。对于较大的数字，您可能需要`unsigned short`（2 个字节）或`unsigned int`（4 个字节）。*)

### 不小心用指针而不是整数计算

```
int ah = 10;
int *pointer = &ah;   //For some reason, we need pointer
pointer++;   //We should've written this: (*pointer)++ to iterate value, not the pointer
std::cout<<"My number:"<<*pointer<<'\n';  //Error - accessing ints address+1 
```

**我故意**从广泛的解释开始。您首先想知道什么是访问冲突。在您的特定代码中，我非常确定您搞砸了`i`边界`j`。做一些`std::cout`调试。

# android - 测试可绘制对象和背景等资源

> ID：16071763
> 
> 赞同：2
> 
> 时间：2013-04-17T23:05:06.887
> 
> 标签：android, conditional, android-resources

我需要看看是否有一种方法可以测试 a 的背景`button`。例如，这是我的伪代码：

```
if (button background is `R.drawable.black`) {
  button.setBackground(to R.drawable.white)
} 
```

有没有办法`if`可以做到这一点？我知道如何设置背景，只是对测试部分感到好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:23:28.233

有一种`getBackgroud`方法

```
Drawable buttonBackground = button.getBackground(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:30:39.967

就您而言，我相信**标签**会很有用。试试这个：

```
//When you set the button:
btn.setBackgroundResource(R.drawable.black);
btn.setTag(R.drawable.black);

//When you re-set the button:
if(btn.getTag().equals(R.drawable.black)) {
    btn.setBackgroundResource(R.drawable.white);
    btn.setTag(R.drawable.white);
} 
```

# c# - 使用 amazon ses 从 Windows 应用程序发送电子邮件时调用 SSPI 失败

> ID：16071766
> 
> 赞同：4
> 
> 时间：2013-04-17T23:05:24.123
> 
> 标签：c#, asp.net, security, smtp, amazon-ses

我正在使用 amazon ses 发送电子邮件，并且在网站和 Windows 应用程序中使用相同的配置。
该网站正在正常发送电子邮件，但 Windows 应用程序给了我这个错误，而不是发送的电子邮件：![在此处输入图像描述](https://i.stack.imgur.com/bGWLk.png)

请注意，当我将 windows 应用程序中的 smtp 配置更改为 gmail 之类的东西时，它工作正常，问题发生在亚马逊 ses 上，并且就在今天开始发生，在 ses 在 windows 应用程序上正常工作之前。
另请注意，网站和 Windows 应用程序现在都在本地运行。

堆栈跟踪：

```
 at System.Net.Security.SslState.StartSendAuthResetSignal(ProtocolToken message, AsyncProtocolRequest asyncRequest, Exception exception)
   at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.CheckCompletionBeforeNextReceive(ProtocolToken message, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ForceAuthentication(Boolean receiveFirst, Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Net.TlsStream.CallProcessAuthentication(Object state)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Net.TlsStream.ProcessAuthentication(LazyAsyncResult result)
   at System.Net.TlsStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.PooledStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.Mail.SmtpConnection.Flush()
   at System.Net.Mail.ReadLinesCommand.Send(SmtpConnection conn)
   at System.Net.Mail.EHelloCommand.Send(SmtpConnection conn, String domain)
   at System.Net.Mail.SmtpConnection.GetConnection(ServicePoint servicePoint)
   at System.Net.Mail.SmtpTransport.GetConnection(ServicePoint servicePoint)
   at System.Net.Mail.SmtpClient.GetConnection()
   at System.Net.Mail.SmtpClient.Send(MailMessage message)
   at Mail.EmailSender.SendMail(MailMessage mail) in e:\Mail\EmailSender.cs:line 175 
```

内部异常：

```
{"The message received was unexpected or badly formatted"} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-25T13:11:16.133

我遇到了同样的问题，最终归结为尝试连接时生效的 SecurityProtocol。

添加

```
ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls; 
```

在 client.Send 为我解决它之前（我们将它更改为 Ssl3 在其他地方与不同的服务通信）如果.Net 团队中的任何人正在阅读，如果这个（和 ServerCertificateValidationCallback）不是全球性的，那就太好了。

我不知道这是 SES 的“功能”还是我只是假设魔法应该起作用，但您可以在这里看到一些历史： [https ://forums.aws.amazon.com/thread.jspa?messageID=472516](https://forums.aws.amazon.com/thread.jspa?messageID=472516 "历史")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T09:55:36.407

看看[这个 SO 帖子](https://stackoverflow.com/questions/13697230/ssl-stream-failed-to-authenticate-as-client-in-apns-sharp)，从网上阅读很多人指出证书是问题所在，我想知道您使用的“验证”文件是否实际上是错误的；他们通过用 .p12 替换“.pem 文件”解决了这个问题

还要看看这个听起来很像你的问题的[MS 修补程序。](http://support.microsoft.com/kb/933430)

也正如 FeliceM 所暗示的，这可能是一个帐户问题：（取自）

" Aspnet 在不同的帐户下运行，因此您必须使用 WinHttpCertCfg.exe 工具来允许以下帐户访问您应该安装在本地计算机个人/受信任文件夹中的证书。

ASPNET 网络服务认证用户

例如

winhttpcertcfg -g -c LOCAL_MACHINE\MY -s "CertificateName" -a "ASPNET"

其中证书名称是您的证书的友好名称。

您可以从以下链接获取工具和信息：

[http://msdn.microsoft.com/en-us/library/aa384088%28VS.85%29.aspx#%5Fusing](http://msdn.microsoft.com/en-us/library/aa384088%28VS.85%29.aspx#%5Fusing)

"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-08T07:02:16.073

尝试检查您的 SPN (ServicePrincipalName) 配置。这个问题听起来像是在您的配置中某处发生了损坏或修改。如果服务实例的登录帐户发生变化，则必须在新帐户下重新注册 SPN。

# objective-c - 如何使用另一个数组过滤对象数组以定义要过滤掉的对象

> ID：16071768
> 
> 赞同：2
> 
> 时间：2013-04-17T23:05:37.020
> 
> 标签：objective-c, sql, xcode, nsarray, nsdictionary

在 xcode 中，我有一个从在线 sql 数据库请求的数据库，它可以存储到数组或 NSDictionary 或其他类型中。另外，在应用程序中生成一个数字数组，它们对应于数据库的一个列。

我想过滤数据库以仅显示与生成的数组有关的对象。过滤后，我想在字符串中列出结果。如果需要，来自在线服务器的数据库可以存储在 NSArray 或 NSDictionary 中，可能还有其他我不知道的格式。

该过程将如下所示：

数据库数组：生成的数组：过滤数据库后的结果数组：

```
ID    |    Name          ID                        FilteredNames
      |
1A    |   Hannah         1A                          Hannah
2A    |   John           1B                          Steve
3A    |   Peter          2B                          Zara
1B    |   Steve
2B    |   Zara
3B    |   Kyle 
```

将生成的数组“FilteredNames”转换为字符串列表，如下所示：

```
NamesString = @"Hannah, Steve, Zara" 
```

然后我计划将 NamesString 传递给标签，如下所示：

```
label.text=NamesString; 
```

所以视图中的标签只显示：

```
 Hannah, Steve, Zara 
```

在整个过程中，我非常需要帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T00:19:03.967

**编辑**根据 Martin 的评论，将谓词格式更改为更合适的格式。

```
- (NSArray *)filterObjects:(NSArray *)objects withNames:(NSArray *)names {
  return [objects filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"name IN %@", names]];
}

// given that the 'objects' array is what you get from server
  NSArray *objects = @[
                       @{@"id" : @"1A", @"name" : @"Hannah"},
                       @{@"id" : @"2A", @"name" : @"John"},
                       @{@"id" : @"3A", @"name" : @"Peter"},
                       @{@"id" : @"1B", @"name" : @"Steve"},
                       @{@"id" : @"2B", @"name" : @"Zara"},
                       @{@"id" : @"3B", @"name" : @"Kyle"}
                       ];

  NSArray *filteredObjects = [self filterObjects:objects withNames:@[@"Hannah", @"John", @"Zara"]];
  NSLog(@"filteredObjects: %@", filteredObjects); // prints them out as dictionaries

  NSString *unitedNames = [[filteredObjects valueForKeyPath:@"@unionOfObjects.name"] componentsJoinedByString:@", "];
  NSLog(@"unitedNames: %@", unitedNames); // comma separated array of names 
```

# ruby - 无法使用 Ruby 的 Framework Padrino 读取上传的文件

> ID：16071770
> 
> 赞同：0
> 
> 时间：2013-04-17T23:05:44.857
> 
> 标签：ruby, file-upload, padrino, net-ftp

我有这个表格用于上传文件：

```
-# coding: utf-8
- content_for(:body_classes, "body3")
.content
  - form_tag url(:images, :create), :method => :post, :multipart => true do
    = file_field_tag :file
    = submit_tag "Upload" 
```

而这个控制器来处理它：

```
Fbapp.controllers :images do

  get :new do
    render 'images/new'
  end

  post :create do
    require 'net/ftp'
    file = params[:file]
    ftp = Net::FTP.new('xxx.xxx.xxx.xxx')
    ftp.passive = true
    ftp.login('user','pass')
    ftp.storbinary("STOR " + "original_filename", StringIO.new(file.read), Net::FTP::DEFAULT_BLOCKSIZE)
    ftp.quit
  end
end 
```

每次我尝试上传文件时，我都会收到“内部服务器错误”。我的日志有这个：

```
NoMethodError - undefined method `read' for #<Hash:0x00000003697780>: 
```

顺便说一下，我正在 Heroku 上尝试这个。我不知道出了什么问题......它似乎对很多人有用，但我除外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:30:53.980

你应该使用：

```
file = params[:file][:tempfile] 
```

我建议检索文件名

```
name = params[:file][:filename] 
```

# mysql - 什么是 MySQL 中的“活动”语句？

> ID：16071772
> 
> 赞同：0
> 
> 时间：2013-04-17T23:05:55.050
> 
> 标签：mysql, database, relational-database

一位面试官刚刚问了我这个问题，如果我熟悉“主动”陈述。

然后我问她是否指的是准备好的陈述，她说没有，我别无选择，只能回答“对不起，但我不熟悉它们”。

似乎这根本不重要，我仍然接受了第二次面试。

但是，在谷歌搜索问题后，我无法找到对“活动”语句的引用。

我应该要求答案，但又一次，因为这是一次采访，所以这不是一个合适的问题。

附近有人有线索吗？

非常感谢！

PS如果这对社区来说不是一个好问题，请随时关闭或删除线程！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:09:16.610

他们可能是指“活动记录”吗？这是一种对象关系映射技术，用于将模型层代码与数据代码相匹配，并使用自动生成的 SQL 语句。

# php - 在 PHP 函数中查询数据库

> ID：16071774
> 
> 赞同：2
> 
> 时间：2013-04-17T23:06:13.533
> 
> 标签：php, mysql

我正在尝试使用 PHP 从数据库中加载一些数据，但由于某种原因，当我将其放入函数中时它不起作用。如果我尝试没有函数的代码，它可以正常工作：

```
//$dbc connection
$call1 = 0;
$output = '';
$query = "select * from artists order by lname limit $call1, 15";
$result = mysqli_query($dbc, $query);
while($row = mysqli_fetch_array($result)){
    $output .= "<ul>";
    $output .= "<li>" . $row['name'] . "</li>";
    $output .= "</ul>";
} 
```

但是，当我将代码更改为函数内部时，我没有从数据库中得到任何东西（或者至少它不会返回任何东西）：

```
//$dbc connection
$call1 = 0;
$output = '';
function loadArtists($call){
    $query = "select * from artists order by lname limit $call, 15";
    $result = mysqli_query($dbc, $query);
    while($row = mysqli_fetch_array($result)){
        $output .= "<ul>";
        $output .= "<li>" . $row['name'] . "</li>";
        $output .= "</ul>";
    }
}
loadArtists($call1); 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T23:09:10.160

你不能`$dbc`在你的函数中使用，因为它是一个`global`变量。

你可以使用

```
function loadArtists($call){
    global $dbc;
    ...
} 
```

告知`$dbc`或`loadArtists()`作为第二个参数传递

```
function loadArtists($dbc, $call){
...
} 
```

并将其称为

```
loadArtists($dbc, $call1); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T23:16:48.547

正如我在其中一条评论中提到的，使用`global`来修复连接范围[是不好的做法](https://stackoverflow.com/a/5166527/679449)。传递连接的*正确*方法如下：

```
$dbc = mysqli_connect("localhost", "my_user", "my_password", "world");

$call1 = 0;
$output = '';
function loadArtists($call, $dbc){
    $query = "select * from artists order by lname limit $call, 15";
    $result = mysqli_query($dbc, $query);
    while($row = mysqli_fetch_array($result)){
        $output .= "<ul>";
        $output .= "<li>" . $row['name'] . "</li>";
        $output .= "</ul>";
    }
}
loadArtists($call1, $dbc); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T23:17:27.037

问题是[变量范围](http://php.net/manual/en/language.variables.scope.php)。*该变量在*您的函数中不存在。

有三种方法可以处理它：

1.  使其成为全局变量，这意味着可以从函数内部读取外部变量。（请注意，使用全局变量通常被认为是一个安全问题。）

    ```
    global $dbc; 
    ```

2.  您可以将该变量作为参数传递给函数

    ```
    function loadArtists($connection, $call) { ... } 
    ```

3.  您可以创建一个类，该类变量现在可以在类函数中使用：

    ```
    class Artists {
        public $dbc;
        public function __construct() {
            $this->dbc = open_the_db_connection(); //etc?
        }
        public function loadArtists($call) {
            $query = "select * from artists order by lname limit $call, 15";
            $result = mysqli_query($this->dbc, $query);
            while($row = mysqli_fetch_array($result)){
                $output .= "<ul>";
                $output .= "<li>" . $row['name'] . "</li>";
                $output .= "</ul>";
            }
            return $output;
        }
    } 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T23:16:30.550

每次要建立数据库连接时，在与您正在执行的代码相同的页面上声明您的用户名和密码是不好的做法，因为：

1.  如果您移动到与开发环境不同的主机或环境，则可能有多个页面要编辑。
2.  如果您在 root 之外声明它，您可以限制从 FTP 帐户访问数据库密码。

我喜欢为连接使用一个函数，因此如果连接关闭，您可以随意重新打开它（减少服务器开销）。此外，您不必将其设置为函数内的全局变量（[由于多种原因，这不是一个好主意](https://stackoverflow.com/questions/5166087/php-global-in-functions/5166527#5166527)）。

所以出于这些原因，这个连接应该在根之外（下面）。

**/../safe/connection.php**

```
function openSQL() {
  $conn = mysqli('localhost', 'my_user', 'my_password', 'my_db');
  return $conn;
} 
```

**函数.php**

```
require_once($_SERVER['DOCUMENT_ROOT'].'/../safe/connection.php');
function loadArtists($call){
   $dbc = openSQL();
   $query = "select * from artists order by lname limit $call, 15";
   $result = mysqli_query($dbc, $query);
   while($row = mysqli_fetch_array($result)){
      $output .= "<ul>";
      $output .= "<li>" . $row['name'] . "</li>";
      $output .= "</ul>";
   }
   mysqli_close($dbc);
   return $output;
}

$myOutput = loadArtists(4); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T23:12:57.183

对我来说，这似乎是一个范围界定问题。您在函数中引用的 $output 与您在函数外部定义的 $output 不同。

您应该将您的功能更改为以下内容：

```
function loadArtists($call){
$output = "";
$query = "select * from artists order by lname limit $call, 15";
$result = mysqli_query($dbc, $query);
while($row = mysqli_fetch_array($result)){
    $output .= "<ul>";
    $output .= "<li>" . $row['name'] . "</li>";
    $output .= "</ul>";
}

return $output; 
```

}

$output = loadArtists($call1);

# iphone - 如何从单视图应用程序启动 cocos2D 游戏

> ID：16071776
> 
> 赞同：1
> 
> 时间：2013-04-17T23:06:21.927
> 
> 标签：iphone, ios, objective-c, xcode, cocos2d-iphone

我用一个按钮创建了一个普通的简单 iOS 应用程序（单视图应用程序），我想从 iOS 应用程序启动一个 cocos2D 游戏。换句话说，当我按下 myapp.xib 中的按钮时，我想启动 cocos2D 游戏。我不想使用 URL 方案来启动游戏，因为这将需要用户下载我的应用程序以及下载游戏。我希望用户能够从我的应用程序内部启动游戏。这是我想从我的应用程序启动的游戏：

[http://www.raywenderlich.com/14439/how-to-make-a-game-like-fruit-ninja-with-box2d-and-cocos2d-part-3](http://www.raywenderlich.com/14439/how-to-make-a-game-like-fruit-ninja-with-box2d-and-cocos2d-part-3)

我能够成功地将这个游戏添加为我的 xcode 项目中的依赖项。但是，我不确定如何从应用程序启动游戏。

这是我的一些想法，但它们并没有真正为我工作。有什么办法可以：

*   从我的应用程序中的 IBAction 调用游戏的应用程序代理（而不是我的应用程序的应用程序代理）来启动游戏？
*   从我的应用程序的 IBAction 调用游戏的 didFinishLaunchingWithOptions 方法（不是我的应用程序的 didFinishLaunchingWithOptions）来启动游戏？
*   从我的应用程序中的 IBAction 调用游戏的 main.m 文件（不是我的应用程序的 main.m）来启动游戏？

据我了解，这是启动 iOS 应用程序的三种不同方式。请记住，我正在开发一个应用程序（不是游戏），它允许用户通过应用程序在内部启动上面的游戏。理想情况下，如果我可以简单地从我的应用程序到游戏执行 pushviewcontroller 会很好（也很容易），但我不确定是否有一种简单的方法来解决这个问题。

无论如何我可以通过我的应用程序在内部启动这个游戏吗？任何意见、建议、示例源代码将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:14:33.243

简短的回答：**是的**

您只需要一个`AppDelegate`（您的 iOS 应用程序之一），然后将所有`cocos2D`初始化内容移到那里。然后，您可以`IBAction`使用类似这样的方式从您的游戏中启动游戏。-

```
CCDirector *director = [CCDirector sharedDirector];
[director pushScene:[YourFirstGameScene node]]; 
[director resume];
[self presentModalViewController:director animated:YES]; 
```

请以下一个片段为例`cocos2d`从您的初始化/结束`appDelegate`

```
- (void) initCocos {
    // Create an CCGLView with a RGB565 color buffer, and a depth buffer of 0-bits
    CCGLView *glView = [CCGLView viewWithFrame:[self.window bounds]
                                   pixelFormat:kEAGLColorFormatRGBA8    //kEAGLColorFormatRGBA8
                                   depthFormat:0    //GL_DEPTH_COMPONENT24_OES
                            preserveBackbuffer:NO
                                    sharegroup:nil
                                 multiSampling:NO
                               numberOfSamples:0];

    self.director = (CCDirectorIOS*) [CCDirector sharedDirector];

    self.director.wantsFullScreenLayout = YES;

    // Display FSP and SPF
    [self.director setDisplayStats:NO];

    // set FPS at 60
    [self.director setAnimationInterval:1.0/60];

    // attach the openglView to the director
    [self.director setView:glView];

    // for rotation and other messages
    [self.director setDelegate:self];

    // 2D projection
    [self.director setProjection:kCCDirectorProjection2D];
    //  [director setProjection:kCCDirectorProjection3D];

    // Enables High Res mode (Retina Display) on iPhone 4 and maintains low res on all other devices
    if( ! [self.director enableRetinaDisplay:NO] )
        CCLOG(@"Retina Display Not supported");

    // Default texture format for PNG/BMP/TIFF/JPEG/GIF images
    // It can be RGBA8888, RGBA4444, RGB5_A1, RGB565
    // You can change anytime.
    [CCTexture2D setDefaultAlphaPixelFormat:kCCTexture2DPixelFormat_RGBA8888];

    // When in iPhone RetinaDisplay, iPad, iPad RetinaDisplay mode, CCFileUtils will append the "-hd", "-ipad", "-ipadhd" to all loaded files
    // If the -hd, -ipad, -ipadhd files are not found, it will load the non-suffixed version
    //[CCFileUtils setiPhoneRetinaDisplaySuffix:@"-hd"];        // Default on iPhone RetinaDisplay is "-hd"
    [CCFileUtils setiPadSuffix:@""];                    // Default on iPad is "" (empty string)
    //[CCFileUtils setiPadRetinaDisplaySuffix:@"-ipadhd"];  // Default on iPad RetinaDisplay is "-ipadhd"

    // Assume that PVR images have premultiplied alpha
    [CCTexture2D PVRImagesHavePremultipliedAlpha:YES];
}

- (void) endCocos {
    CC_DIRECTOR_END();
    self.director = nil;
} 
```

实际上，我所做的`initCocos`只是在推送我的之前`director`和`endCocos`关闭游戏之后调用，比如

```
AppDelegate *appDelegate = (AppDelegate *) [[UIApplication sharedApplication] delegate];
[[CCDirector sharedDirector] dismissModalViewControllerAnimated:YES];
[appDelegate endCocos]; 
```

希望能帮助到你。

# svn - composer 删除 web/bundles 中的目录

> ID：16071778
> 
> 赞同：0
> 
> 时间：2013-04-17T23:06:29.803
> 
> 标签：svn, symfony, composer-php

我是 Symfony2 和作曲家的新手。我通常通过将框架代码也提交到 svn 或使用链接存储库来管理 svn 中的所有项目代码。我知道大多数 Symfony 包都使用 git 进行版本控制。

使用 composer 安装新捆绑包时发生了一个奇怪的问题。例如要安装 FOSUserBundle，我在 composer.json 中添加：

```
"friendsofsymfony/user-bundle": "*" 
```

然后我跑

```
php composer.phar update friendsofsymfony/user-bundle 
```

这很好用，但它会从 web/bundles 中删除所有文件夹，例如

```
~       web/bundles/framework
~       web/bundles/sensiodistribution 
```

这是composer中的配置问题还是与svn不兼容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T06:35:29.467

在更新期间重新生成这些文件夹是完全正常的。这是更新后/安装脚本的一部分。

推荐的 .gitignore-file 包含 web/bundles，所以我想你也应该将文件夹添加到你的 .svnignore 中。或者，您可以从 composer.json 中删除 post-post-update/-install 挂钩。但是由于资产是从捆绑包 Resources/public/ 复制到 web/ 文件夹以便它们可以访问，所以你必须在你的虚拟主机或其他东西中为它们起别名......

简而言之，只需将 web/bundles 添加到您的 .svnignore

# c# - 有理由两次抛出异常吗？

> ID：16071780
> 
> 赞同：2
> 
> 时间：2013-04-17T23:06:30.860
> 
> 标签：c#, exception-handling, try-catch, throw

调试生产代码我遇到了一些我以前从未见过的东西，并且不知道它的有效用途。在我们的一个控制器的几种方法中，我们有 try-catch 块。有趣的部分是其中一个 catch 中有 2 个 throw 语句。

有任何理由有 2 个 throw 语句吗？如果是这样，在什么情况下这有意义？

```
 try
        {
           //statements
        }
        catch (SoapException se)
        {
            //Log statement
            return null;
        }
        catch (Exception ex)
        {
            //Log statement
            throw;
            throw;
        } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-17T23:09:17.423

不，没有理由要`throw`两次。第二个`throw`永远也达不到。

它也类似于拥有

```
public int GetNumber()
{
    return 1;
    return 2; // Never reached
} 
```

**更新**

[Resharper](http://www.jetbrains.com/resharper/)是一个很好的工具来检查这样的事情。

在这种情况下，它会使第二个变灰`throw`并告诉您它无法访问。

![在此处输入图像描述](https://i.stack.imgur.com/r7GKC.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T23:11:43.917

连续两次抛出异常绝对没有任何目的。第二个`throw`永远无法到达，它很可能是一个错字，或者是被编辑但从未完成并且被遗忘的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-17T23:17:37.847

在您展示的示例中，两个 throw 语句没有任何意义。一旦第一个被击中，它就会开始返回调用堆栈，直到它被捕获。两个人做出任何区别的唯一方法是，如果第一个是有条件的，或者在第二个被击中之前被抓住。

```
 try
    {
       //statements
    }
    catch (SoapException se)
    {
        //Log statement
        return null;
    }
    catch (Exception ex)
    {
        //Log statement
        if (condition)
            throw;
        throw;
    } 
```

或者

```
 try
    {
       //statements
    }
    catch (SoapException se)
    {
        //Log statement
        return null;
    }
    catch (Exception ex)
    {
        //Log statement
        try
        {
             throw;
        }
        catch (Exception)
        {
             //Handle first thrown exception.
        }
        throw;
    } 
```

# c# - 为自定义工具包装 .exe 的廉价方法？

> ID：16071782
> 
> 赞同：1
> 
> 时间：2013-04-17T23:06:46.590
> 
> 标签：c#, visual-studio, com

我有一个自定义脚本语言和一个编译器（一个用 C 编写的 EXE），可以将该语言转换为 C# 代码。我想将脚本编译器作为自定义工具连接到解决方案中的脚本文件上，并让它在后面生成 C# 代码。

[我在网上](http://www.codeproject.com/Articles/31257/Custom-Tools-Explained)看过文章和教程，它们都让你生成 COM 接口，并用注册表和 GAC 注册你的自定义 DLL，我真的不想处理所有这些。

是否有包装器或黑客或 3rd 方插件可以使这更容易？就像如果有一种方法可以将批处理脚本作为自定义工具运行，并从其标准输出生成文件背后的代码，我可以将文件从我的编译器通过管道传输到标准输出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T03:31:47.190

首先，我知道您说您不想通过 MSFT 方式注册，但我建议您重新考虑。详细信息在这里：http: [//msdn.microsoft.com/en-us/library/vstudio/bb166527.aspx](http://msdn.microsoft.com/en-us/library/vstudio/bb166527.aspx)

既然我们已经解决了这个问题，我给你的建议是：

1.  将您的 exe 放在一个固定的位置（最好的位置可能就在您的解决方案或存储库的根目录中）。接下来，手动运行您的工具一次，这样您就有了 .cs 文件或您正在生成的任何文件，以便您可以将它们添加到您的解决方案中。这样 C# 编译器就知道它们在那里，您只需点击构建按钮，它就会有要构建的文件。

2.  接下来，创建一个预构建事件（在项目属性，构建事件选项卡下），使用适当的命令行参数调用您的 exe 以使其完成任务（生成新的 cs 文件）。我建议您编辑您的 exe 以一次获取多个文件，以使您的预构建命令更简单。（这是将您的文件放在 sln 或 repo 目录中很有帮助的地方，因为您可以使用 VS 宏来获取您的 exe 和要读入的文件的绝对路径。）

3.  现在发生的事情是在调用 msbuild 之前（但在您点击 build 之后）您的脚本（或 exe）将运行以生成新的输出文件。由于 msbuild 尚未开始，您可以将任何解决方案文件更改为您心中的内容，并且 msbuild 和最终（可能在构建完成后）VS 都会获取这些更改。

注意：我从来没有能够让构建事件在第一次尝试时工作，它通常会引发一个错误，该错误将显示在 VS 错误/警告窗口中。我通常将整个错误复制到记事本（或 scite）中，然后将其编辑为带有参数的实际命令行。然后我打开一个命令外壳并尝试执行它。这里的错误通常更有帮助，您可以调整直到正确并将更改复制回 VS。

# batch-file - 从完整或相对路径获取文件名，知道这不是批处理的参数

> ID：16071783
> 
> 赞同：-1
> 
> 时间：2013-04-17T23:06:54.713
> 
> 标签：batch-file, filenames

当文件以及相对路径或完整路径...作为批处理的参数给出时，我知道如何扩展 %1 以获取文件名

```
 %~n1 
```

这很容易！

不过，我想从批处理中正确处理的相对/完整路径中获取文件名。

请看我的代码。我想扩展 %%x （在我的例子中是相对路径）以仅考虑其文件名。请问你有什么想法吗？谢谢

```
 @echo off
 SETLOCAL EnableDelayedExpansion
 set currDir=%CD%
 for /f "tokens=*" %%x in (Lists.out) do (
 echo %%x
 set filetxt=%%x) 
```

这是一个示例“Lists.out”文件，其中包含一些不同的文件内置相对路径。“Lists.out”可以由

```
 Temp\my file1_X
   Temp\my file2_X
   ............... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:41:14.817

```
...
 echo %%~nx
 set filetxt=%%~nx) 
```

应该可以解决您的问题。

或者`~nxx`如果您也想要扩展名，请使用。

# rally - Rally Java Rest API 302 临时移动错误

> ID：16071784
> 
> 赞同：0
> 
> 时间：2013-04-17T23:07:04.683
> 
> 标签：rally

我正在为 TeamCity 创建一个用于 Rally 的集成工具，并使用 Java REST API。当我尝试创建类型为“build”的对象时，我得到了一个由 restAPI 引发的异常，并出现 302“临时移动”错误。

我该如何处理？我在 Rally RestAPI 中看不到任何打开或关闭重定向的设置，并且 API 未处理重定向。

有什么建议么？

这是正在发布的代码。对 restAPI 的 create 调用会引发异常。**对def.getWorkspace().getRef**和**def.getRef()**的两次调用返回工作空间的 URL 和与此构建记录关联的构建定义条目（字符串是来自这些实体的**“_ref”属性）。**

```
try {
    JsonObject obj = new JsonObject();
    obj.addProperty("workspace", def.getWorkspace().getRef());
    obj.addProperty("buildDefinition",def.getRef());
    obj.addProperty("duration",1.05);
    obj.addProperty("message", "Message for the build");
    obj.addProperty("number","TEST0000");
    obj.addProperty("start", isoFormat.format(new Date()));
    obj.addProperty("status","Passed");
    obj.addProperty("uri", "http://teamcity.com");

    CreateRequest request = new CreateRequest("build", obj);
    request.setFetch(new Fetch("FormattedID,Name"));
    CreateResponse response = restAPI.create(request);
} catch (Exception e) {
    LOG.error("Could not create object of type: " + type, e);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:49:26.807

您是否成功地创建了其他对象/工件？你知道你有没有代理服务器吗？302 可能来自中间代理而不是拉力赛。如果您有代理，您可以执行以下操作：

`restAPI.setProxy("https://myproxy","myproxyuser","myproxypassword");`

为您的 REST 连接设置代理。除此之外，还有一些评论：

1.  “状态”的有效值为 [SUCCESS, FAILURE, INCOMPLETE, UNKNOWN, NO BUILDS]
2.  无需对 CreateRequest 执行 setFetch - Fetch 参数仅用于查询。

我希望这有帮助。

# mysql - 修复缺少 mdy 和 mdi 文件的 mysql 数据库表的任何方法

> ID：16071790
> 
> 赞同：-1
> 
> 时间：2013-04-17T23:07:19.667
> 
> 标签：mysql, .net

我们在两台不同的服务器上有 mysql 数据库：一台在开发中，一台在生产中。

今天大约在同一时间，我们在查询时遇到了错误：在命令执行期间遇到了致命错误。

db 管理员查看了文件，并说数据库中的表没有 MDY 或 MDI 文件，并认为因此，数据库没有索引并且出现问题。针对数据库运行的应用程序已经运行了大约一个月。我们查看我们的夜间备份，文件从未存在（或者可能没有标记为备份？）

这些数据库曾经位于 mySQL 4.1.14-nt 上，并通过使用 mysqldump --add-drop=table 命令转移到具有 mySQL 5.2 的服务器上

这个问题对任何人来说都很熟悉吗？有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:35:00.413

原来，当我们迁移数据库时，mysqldump 生成的 SQL 会在模式中创建表时设置 INNO 数据引擎。

INNO 显然不使用这些 MDY 和 MDI 文件。

# c# - 以编程方式重新加载 Excel 插件

> ID：16071792
> 
> 赞同：1
> 
> 时间：2013-04-17T23:07:25.970
> 
> 标签：c#, excel, vsto, excel-addins

我有一个具有许多功能的 excel 插件。我在功能区上有一个名为“配置设置”的按钮，允许用户选择是否允许某些选项（是否包括右键单击菜单，或者在我的功能区上显示某些按钮）。

我知道定义右键菜单或设计功能区的唯一方法是启动 excel 插件。

我有一个在加载时会检查的配置文件，但如果用户使用我的功能区按钮更改配置，则在重新打开 excel 或用户手动重新加载插件之前它没有效果。有没有办法以编程方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T13:31:13.320

可能你可以有两个插件。(Addin1, Addin2)

第一个插件 (Addin1) 没有任何功能区但读取配置，然后启用另一个插件 (Addin2)。

要启用插件，请使用以下代码。

```
foreach (COMAddIn addin in Application.COMAddIns)
{
   if (addin.ProgId.ToLower().Contains("addin2") && addin.Connect != true)
   {
      addin.Connect = true;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-04T13:23:10.160

我认为您不能从同一个加载项中重新加载加载项。我自己试过了——只是卸载对我有用。

但是自定义功能区（例如名为“Ribbon1”）的按钮可以在运行时通过“全局”对象访问其属性来更改：

```
Globals.Ribbons.Ribbon1.myRibbonButton.Visible = false; 
```

希望它有帮助，约尔格

# java - 其中一个类没有编译，想要一些关于如何让它工作的指导

> ID：16071803
> 
> 赞同：1
> 
> 时间：2013-04-17T23:08:52.870
> 
> 标签：java

得到了以下分配的一些规范，其中一些尚未完成，知道我将如何做“完成后，应将一条消息写入终端窗口，说明程序已成功完成，并提供帐户数量阅读和总余额"

先感谢您

```
 import java.util.*;
 import java.io.*;

 public class TotalOccountBalances
 {
     // instance variables - replace the example below with your own
private int count;
private inFile file;    
private Scanner input;

/**
 * Method
 */
public void closeLink()
{      
    input.close();
}

/**
 * Method
 */
public void processFiles()
{
    while(input.hasNext())
    {
        string line=input.nextLine();

    }
    Count++;
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:13:10.230

我认为这就是您的班级打算做的事情：

`private inFile file;`

应该

```
private File inFile; 

private outFile File; 
```

应该

```
private File outFile; 
```

然后在其余代码中使用 inFile 和 outFile 变量。您必须记住，对于变量，访问修饰符（private、public 等）之后的第一件事应该是数据类型——类或原语——inFile 和 outFile 都不是数据类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:14:13.957

你的变量名弄错了

```
private outFile File; 
```

应该

```
private File outFile; 
```

这同样适用于`inFile file`;

Java 也*区分大小写*。

```
Count++; 
```

应该

```
count++; 
```

最后一点解释了大量其他编译错误。[Java 命名约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-135099.html#367)表明变量名以*小写*字母开头，所以

```
private int Total; 
```

将会

```
private int total; 
```

# objective-c - How to initialize a NSMutable array in a UIView subclass

> ID：16071808
> 
> 赞同：0
> 
> 时间：2013-04-17T23:09:10.057
> 
> 标签：objective-c, nsmutablearray

I create an NSMutableArray and fill it with a bunch coordinates.

I assign the array to the property of another array like this:

```
draw.shapeCoords = [shapes shapeCoords]; 
```

Where draw is a class and shapes is a class and shapeCoords are properties in both of them.

When I get to my drawRect method, the array of coordinates is empty. I'm did a little research and found that the @synthesize does not *fully* instantiate an NSMutableArray, how then in my draw class (which implements UIView) do I initialize the array? Basically, I need access to the data in the array, how do I get it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:25:09.773

`@synthesize`根本不实例化一个对象——它只是创建一个变量（初始化为 nil）和访问器方法。您需要实际创建数组。在你的`initWithFrame:`，你会想要类似的东西`_shapeCoords = [[NSMutableArray alloc] init]`。

# php - PHP/MySQL update statement inserting a 0?

> ID：16071814
> 
> 赞同：0
> 
> 时间：2013-04-17T23:09:36.237
> 
> 标签：php, mysql, sql-update

I am creating an "edit" page for some content on my website that is stored in a MySQL database. I can usually do this easily without any problems but for some reason I am having a really annoying problem here with it.

I have the title and message boxes that I wish to update in the database and when the update query is sent, the title is saved correctly, however the message just seems to add a single "0" into the field?

Here is my PHP with validation removed (the problem still occurs without it):

```
if(isset($_POST['saveChanges'])){

$title = mysql_real_escape_string(stripslashes($_POST['message']));
$message = mysql_real_escape_string(stripslashes($_POST['title']));

$savequery = "UPDATE messages SET message = '$message' AND title = '$title' WHERE id = '$postid'";
$saveresult = mysql_query($savequery);

if($saveresult){
//do something
} else if(!$saveresult){
//do something
}
} 
```

HTML form:

```
<form action="edit.php" method="post">
   <input name="title" type="text">
    <textarea name="message"></textarea>
    <button type="submit" name="saveChanges"> Save Changes </button>
</form> 
```

Was just hoping someone had came across this problem before, there are no errors when I've tried to debug, it has ran my success messages on completion and the data does add correctly for the title as i've said, however for the message it adds a "0".

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:11:55.900

您的更新语句应该使用逗号而不是 AND：

[http://dev.mysql.com/doc/refman/5.0/en/update.html](http://dev.mysql.com/doc/refman/5.0/en/update.html)

```
$savequery = "UPDATE messages SET message = '$message', title = '$title' WHERE id = '$postid'"; 
```

# performance - Actively tracking oracle query performance

> ID：16071815
> 
> 赞同：3
> 
> 时间：2013-04-17T23:09:43.703
> 
> 标签：performance, oracle, oracle10g, query-optimization

**Background:**

We have a database environment where views are calling views which are calling views... the logic has become complex and now changes to underlying views can have significant impact on the top view being called by the client application.

Now while we are documenting all the logic and figuring out how to unwind everything development continues on and performance continues to degrade.

Currently I would manually run an explain plan on a client query and dig into tuning it. This is a slow and tedious process and changes may not be examined for ages.

**Problem:**

I want to generate a report that lists SQL ID and lists changes in actual time/discrepancy between estimated rows and actual rows/changes in buffers/changes in reads in comparison to the average computed over the last month.

I would generally run the following script manually and examine it based just on that day's response.

```
ALTER SESSION SET statistics_level=all;
set linesize 256;
set pagesize 0;
set serveroutput off;

-- QUERY

SELECT
    *
FROM
    table (DBMS_XPLAN.display_cursor (NULL, NULL, 'ALLSTATS LAST')); 
```

What I am trying to do is see about automating the explain plan query and inserting the statistics into a table. From there I can run a regression report to detect changes in the performance which can then alert the developers.

I was thinking something like this would be common enough without having to resorting to the OEM. I can't find anything so I wonder if there is a more common approach to this?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T06:27:22.207

Oracle 通过自动工作负载信息库为此提供了功能。[http://docs.oracle.com/cd/E11882_01/server.112/e16638/autostat.htm](http://docs.oracle.com/cd/E11882_01/server.112/e16638/autostat.htm)

不过，我相信这是企业版之上的额外许可。它应该可以在非生产环境中使用而无需额外费用，但请咨询您的 Oracle 销售代表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T09:21:32.617

听起来您正在重新发明 STATSPACK。Oracle 仍然将它包含在他们的数据库中，但不再记录它，大概是因为它是免费的，不像 AWR 和 ASH。您仍然可以在[9i 手册](http://docs.oracle.com/cd/B10500_01/server.920/a96533/statspac.htm)中找到文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T08:38:03.307

活动会话历史 (ASH) 是您正在寻找的

```
select * from v$active_session_history where sql_id = :yoursqlid 
```

# javascript - Case of names of built-in JavaScript types

> ID：16071826
> 
> 赞同：0
> 
> 时间：2013-04-17T23:11:13.683
> 
> 标签：javascript, naming, built-in-types

In JavaScript, `typeof 0` gives `'number'` not `'Number'`, but `instanceof 0 Number`.

Would it be accurate to say the canonical names of the built-in types are capitalized, and the lowercase return value of `typeof` is a quirk/inconsistency that can't be changed for historical reasons, but would be changed if it could be? Or am I missing something?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:14:42.627

不，

实际上 number 是内置值类型，其中 Number 是一个对象。

如果您说 typeof，则无需临时将 0 转换为 Object。

如果使用 instanceof，它会暂时将 0 转换为对象。

这类似于您对字符串执行的操作：

`"sometest"`=> 这是一个字符串

但是，如果您愿意`"sometest".toLowerCase()`，它将首先（临时）将字符串转换为字符串对象，然后调用该对象上的方法（因为值类型不能有方法）。

简而言之，小写表示值类型，大写表示对象

# sql-server - SQL Server : Join Two Tables and Return With Null Records

> ID：16071829
> 
> 赞同：1
> 
> 时间：2013-04-17T23:11:36.047
> 
> 标签：sql-server

I couldn't figure out how to join these two tables and get the result with NULL value that I want. I played around with `LEFT JOIN`, `RIGHT JOIN`, `FULL OUTER JOIN`..., but couldn't get it to work. Please see this below.

**Table1**:

```
NameID  Name
1       N1
2       N2
3       N3
4       N4
5       N5 
```

**Table2**:

```
NameID  AnotherID   Value
1       AID-111     1000
2       AID-222     2000
2       AID-222     3000
3       AID-333     4000
4       AID-444     5000

Select ...
JOIN Table1 and Table2
WHERE AnotherID = 'AID-222' 
```

This is the result I want:

```
NameID  Name    AnotherID   VALUE
1       N1      NULL        NULL
2       N2      AID-222     2000
3       N3      AID-222     3000    
4       N4      NULL        NULL    
5       N5      NULL        NULL 
```

Please help. Thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T23:18:39.350

您没有解释为什么要返回值`2000`而不是，`3000`但您可以使用`LEFT JOIN` 带有子查询的 a 来获取结果：

```
select t1.nameid,
  t1.name,
  t2.anotherid,
  t2.value
from table1 t1
left join
(
  select nameid, anotherid, min(value) value
  from table2
  where anotherid = 'AID-222'
  group by nameid, anotherid
) t2
  on t1.nameid = t2.nameid; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/17e5a/5)。这给出了结果：

```
| NAMEID | NAME | ANOTHERID |  VALUE |
--------------------------------------
|      1 |   N1 |    (null) | (null) |
|      2 |   N2 |   AID-222 |   2000 |
|      3 |   N3 |    (null) | (null) |
|      4 |   N4 |    (null) | (null) |
|      5 |   N5 |    (null) | (null) | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-19T05:10:00.090

我们也可以使用全连接，它也会给你答案：

`tableA`从t1中选择 t1.nameid,t1.name,t2.anotherid,t2.value

```
full outer join
(
    select nameid,anotherid,value from tableB 
    where anotherid IN ('AID-222','AID-333') 

) t2 
on t1.nameid = t2.nameid; 
```

# database - Key point to keep in mind when writing database interaction layer (DAL)

> ID：16071835
> 
> 赞同：0
> 
> 时间：2013-04-17T23:12:00.987
> 
> 标签：database, database-design, relational-database, data-access-layer

What are key aspects or points when writing a Data Access Layer (DAL).

Do you allow higher layers to pass "unique" queries to the DAL, ie not just standard update, insert and delete...?

How does one allow for scalability in such a layer?

Any comments would be great

Aiden

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:39:46.613

根据我的经验，编写 DAL 时有几个关键方面。

1.  使 DAL 成为接口
2.  选择正确的抽象级别
3.  记住缓存

(1) 确保你的 DAL 是一个接口。这允许您模拟可能调用数据库进行测试的方法。如果您`getItems()`在接口中有一个函数，那么您可以实现一个输出到您的数据库的类*和*一个模拟数据以进行快速单元测试的类。

(2) 在执行 (1) 时，请确保您选择了正确的抽象级别。例如，我在当前的公司看到了一个糟糕的 DAL，它对每个调用都使用了抽象查询语言。

例如，我们 DAL 中的一个调用是：

`getItems(List filters, int limit, int skip)`.

相反，我希望看到：

`getItems(List ids, int pageSize, int page)`.

我们让底层数据源（在本例中为 Mongo）的细节通过接口流出。我们在界面中公开了 Mongo 的特定功能。小心不要那样做！

如果你做得好这一步，你可以将你的支持数据存储从关系到文档交换到任何东西。

(3) 牢记缓存。非常简单，但请确保您考虑如何缓存您的 DAL 调用。这将有助于解决可扩展性问题。您可能会研究将与 DAL 调用一起使用的 AOP（面向方面​​的编程）。

您的具体问题：

1.  我会允许高层传递独特的查询。请记住选择正确的抽象，以便您可以在需要时交换持久性存储。
2.  使用大量缓存（可能是分布式缓存）来提供可伸缩性。就那么简单。=)

# javascript - Spotify App Preview API 访问 model.player 属性

> ID：16071836
> 
> 赞同：1
> 
> 时间：2013-04-17T23:12:11.967
> 
> 标签：javascript, html, spotify

我一直在玩最新的 spotify 预览 api，但在访问播放器属性时遇到问题。我正在尝试播放当前曲目。这是我下面的测试片段。

```
require([
   '$api/models',
   '$api/search#Search',
   '$views/image#Image'
], function(models,s, Image) {
      'use strict';
       console.log(models.player.track)
}); 
```

但是我在 console.log 中未定义它看到我只能访问这些方法。请查看链接以供参考 [http://developer.spotify.com/technologies/apps/docs/preview/api/api-models-player.html](http://developer.spotify.com/technologies/apps/docs/preview/api/api-models-player.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:48:11.087

找到了

因此，在您可以访问播放器属性之前，您必须调用 load 方法

```
require([
   '$api/models',
   '$api/search#Search',
   '$views/image#Image'
], function(models,s, Image) {
     'use strict';

     models.player.load('track').done(function(prop) {
           console.log(prop.track.name);
      });

}); 
```

# javascript - hs.htmlExpand to the open popup on image click

> ID：16071838
> 
> 赞同：0
> 
> 时间：2013-04-17T23:12:17.140
> 
> 标签：javascript, highslide

I would like, when the user click on image in the open popup, the content will changed with url in iframe (not close/open, but crossfade)

I have a gallery with hs.transitions = ['expand', 'crossfade'].

Next construction will close old popup window and open new one (and break the slideshow), but i want the same effect (crossfade), like a user click next image.

```
hs.allowMultipleInstances = false;
hs.Expander.prototype.onImageClick = function()
{
    return hs.htmlExpand(null, { objectType: 'iframe', src: 'url' });
}; 
```

How to make it?

Sample - [http://jsfiddle.net/xCnfE/4/](http://jsfiddle.net/xCnfE/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T13:12:03.973

如果 HTML 弹出窗口不是图库的一部分，则不能从图像交叉淡入淡出到 HTML 弹出窗口。相反，您可以使用 jQuery 创建一个覆盖图像的常规 iframe，并仅在单击图像 ( `onImageClick`) 时显示此 iframe。请参阅[http://jsfiddle.net/roadrash/B7sDG/](http://jsfiddle.net/roadrash/B7sDG/)

```
hs.Expander.prototype.onImageClick = function (sender) {
    $('<iframe src="'+this.custom.url+'" frameborder="0"></iframe>').css({
        position: 'absolute',
        top: '0',
        height: '100%',
        width: '100%',
        background: '#fff',
        zIndex: 20
    }).appendTo(sender.wrapper);
    return false;
}; 
```

使用hs.custom[传递](http://highslide.com/ref/hs.Expander.prototype.custom)`url`给iframe ：`src``onclick`

```
<a href="large-image.jpg" class="highslide" onclick="return hs.expand(this, galleryOptions, {url: 'http://highslide.com/'})">
    <img src="thumbnail.jpg" alt="Caption Text" />
</a> 
```

# javascript - Node.js server/client module confusion, EventEmitter woes

> ID：16071842
> 
> 赞同：0
> 
> 时间：2013-04-17T23:13:02.690
> 
> 标签：javascript, node.js, backbone.js, coffeescript, eventemitter

I'm trying to write a library which can be used in Node.js *or* on the client-side.

I'm running into *two* issues:

1.  I can't seem to export it correctly. I'm using [this doc](http://coffeescriptcookbook.com/chapters/syntax/code_reuse_on_client_and_server). `MyClass = exports? and exports or @MyClass = {}` doesn't seem to work, so I split up the files for now.

2.  The library emits events; I'm hoping someone can clarify my confusion on how to do this more simply. Follow with me below :)

**Node.js:**

*Library:*

```
 {EventEmitter} = require 'events'

    class MyClass extends EventEmitter

      emitSomething: (key, data) ->

        @emit key, data

module.exports = MyClass 
```

*Required:*

```
MyClass = require 'myclass'
myClass = new MyClass()

myClass.on 'someevent', (data) ->
  console.log data 

# Bare with not using `emit` directly.
data = 
  key: 'value'

myClass.emitSomething 'someevent', data 
```

**Client-side**

[EventEmitter](https://github.com/Wolfy87/EventEmitter) is included.

```
class MyClass extends EventEmitter

  emitSomething: (key, data) ->

    @trigger key, [ data ] # That's stupid. 
```

The library file is included in a script and somewhere I do:

```
myClass = new MyClass()

myClass.on 'someevent', (data) ->
  console.log data 

data = 
  key: 'value'

myClass.emitSomething 'someevent', data 
```

**Client-side**

Backbone.js/Underscore.js are included (not the EventEmitter library above).

```
class MyClass

  constructor: () ->

    _.extend @, Backbone.Events

  emitSomething: (key, data) ->

    @trigger key, data # Notice the difference. 
```

The library file is included in a script and somewhere I do:

```
myClass = new MyClass()

myClass.on 'someevent', (data) ->
  console.log data 

data = 
  key: 'value'

myClass.emitSomething 'someevent', data 
```

So, uh, what's the best way to write a library that emits events for both Node and the browser? The EventEmitter library seemed to conflict with Backbone when I had them both included (it needs to work on Node, and with or without Backbone). There's got to be a simpler solution!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:42:26.653

您应该考虑使用 browserify，它可以让您简单地使用 MyClass 模块客户端，因为它包含一个版本的 nodecore 事件。

所以客户端：

```
MyClass = require('./myclass')
myClass = new MyClass() 
```

[http://browserify.org/](http://browserify.org/)

[https://github.com/substack/coffeeify](https://github.com/substack/coffeeify)

# php - Posting several vars via JavaScript

> ID：16071850
> 
> 赞同：0
> 
> 时间：2013-04-17T23:14:09.943
> 
> 标签：php, javascript

I want to post via JavaScript several vars but I can't, it doesn't do anything.

After a script is done running, I want to send the vars via POST so I can read them with "$_POST" and use them in a PHP script

Here is an example of my Script

```
function finish()
{
 var cnt1 = 50;
 var tim = 60;
 var hecho = 1;

$.post("index.php", { t:tim }, { m:cnt1 }, { e:hecho } );
} 
```

I could do this:

```
top.location.href="index.php?e="+hecho+"&t="+tim+"&m="+cnt1; 
```

But I don't want to use GET because users will see the Variables, I want to use POST so is a bit harder to hack.

What I am doing wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:17:39.623

You just put all the variables into a single object:

```
$.post("index.php", { t:tim, m:cnt1, e:hecho } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:19:39.077

Each of the commas in your `$.post()` function assign that value to different arguments. In order to pass all of those values, at once, you'll want to use one object:

```
function finish() {
  var cnt1 = 50;
  var tim = 60;
  var hecho = 1;

  $.post("index.php", { t:tim, m:cnt1, e:hecho } );
} 
```

# asp.net-mvc - 更改不显眼的 jquery 验证的默认行为以在 onkeyup 上进行验证？

> ID：16071854
> 
> 赞同：1
> 
> 时间：2013-04-17T23:14:28.273
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4, jquery-validate, unobtrusive-validation

我正在使用带有MVC4 / razor的微软不显眼的jquery验证，默认行为似乎是首先验证点击提交，然后验证onkeyup。

我想更改它，以便它开始验证 onblur，然后在第一次提交后继续正常验证 keyup。

有没有办法可以更改它以开始验证所有表单的模糊？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T09:07:48.297

这是直接使用 jquery validate 或通过 Microsoft 不显眼验证时的默认行为。如果您在字段中输入无效条目，则该字段将在模糊时验证，甚至在该字段提交之前。如果您在未输入任何内容的情况下聚焦然后模糊某个字段，则该字段将仅在提交表单时进行验证。

从文档页面部分[“玩演示时要寻找的一些东西”](http://docs.jquery.com/Plugins/Validation#A_few_things_to_look_for_when_playing_around_with_the_demo)

> 在字段被标记为无效之前，验证是惰性的 [但是] 如果用户在未标记的字段中输入内容，并且标签/点击远离它（模糊字段），它会被验证

我已经在评论中分叉了小提琴，以使用不显眼的插件和一些呈现的 html 来演示这一点。 [http://jsfiddle.net/8wkS2/](http://jsfiddle.net/8wkS2/)

“到 jsfiddle.net 的链接必须附有代码。” 所以这是服务器生成的渲染标记

```
<input type="text" name="field1" id="field1" 
data-val="true" 
data-val-required="This field is required"
data-val-length="The field LastName must be a string with a minimum length of 5." 
data-val-length-min="5" /> 
```

# php - PHP warning array to string conversion loop inside array key

> ID：16071858
> 
> 赞同：1
> 
> 时间：2013-04-17T23:14:46.800
> 
> 标签：php, arrays, loops, key

```
<?php  $student = array(
     1 => array(
         "firstname" => "first",
         "name" => "first",
         "group" => "grp01",
         "score" => array(
             "ASP" => 86,
             "PHP" => 79,
             "JAVA" => 72,
             "HTML" => 96,
             "JAVASCRIPT" => 98,
             "VBNET" => 66
         )
     ),
     2 => array(
         "firstname" => "second",
         "name" => "second",
         "group" => "grp01",
         "score" => array(
             "ASP" => 80,
             "PHP" => 70,
             "JAVA" => 71,
             "HTML" => 92,
             "JAVASCRIPT" => 90,
             "VBNET" => 78
         )
     ),
     3 => array(
         "firstname" => "third",
         "name" => "third",
         "group" => "grp02",
         "score" => array(
             "ASP" => 88,
             "PHP" => 88,
             "JAVA" => 89,
             "HTML" => 96,
             "JAVASCRIPT" => 98,
             "VBNET" => 71
         )
     )  ); ?>

<?php

foreach($student as $std) {
    foreach($std as $key => $p){
        echo $std[$key];
    } } ?> 
```

i am trying to print in echo each student with they average score but right now i am stuck i got a warning about array to string convertion can someone give me some hint how i am suppose to do my loop.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:33:51.027

使用 PHP 函数计算每个学生的平均值，四舍五入为两位数：

```
foreach($student as $std) {

    $avg = round(array_sum($std['score']) / count($std['score']), 2);
    echo $std['name']. ": $avg <br />";
} 
```

看到它工作：[http ://codepad.viper-7.com/RBINCd](http://codepad.viper-7.com/RBINCd)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:20:59.097

您正在迭代错误的数组，一旦在每个学生内部，您必须遍历“分数”，如果不是，您试图将分数数组转换为字符串：

```
foreach($student as $std) {
    foreach($std["score"] as $language => $score) {
        echo $score;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T23:23:25.410

当您尝试回显数组的“分数”部分时，您会遇到错误。由于它本身就是一个数组，因此不能以这种方式回显。您将需要另一个循环来将分数相加，然后得到它之外的平均值。

类似于以下内容：

```
foreach($student as $std) {
    foreach($std as $key => $p){

        if ( $key === 'score'){

            $avg = 0;

            foreach( $p as $score){
              $avg += $score;
            }

            $avg = ($avg/size_of($p));
         }

    } 
} 
```

# jquery - using HtmlHelper in javascript with MVC and DataAnnotations jqGrid

> ID：16071860
> 
> 赞同：0
> 
> 时间：2013-04-17T23:14:48.523
> 
> 标签：jquery, asp.net-mvc-4, jqgrid, data-annotations

I created an extension method that works when it is not included in a java script tag.

```
public static class ExtensionMethods
{
    public static string TickWrap(this HtmlHelper source, MvcHtmlString mvcHtmlString)
    {
        return "'" + mvcHtmlString.ToHtmlString().Replace("'", "''") + "'";
    }
} 
```

usage in my view is as follows

```
@Html.TickWrap(Html.DisplayNameFor(m => Model.SampleDateTime)) 
```

All it's doing is grabbing the Display Name attribute of the Data Annotation listed below and displaying it as 'Date and Time' with the ticks around it.

```
[Display(Name = "Date and Time")]
public DateTime SampleDateTime {get; set;} 
```

I can't seem to get this to work in a script tag however. I am getting a JavaScript critical error syntax error. Below is the script that is included in my view.

```
<script type="text/javascript">
    $(function () {
        var displayName = @Html.TickWrap(Html.DisplayNameFor(m => Model.SampleDateTime))
        alert(displayName);
    });
</script> 
```

**I'm guesing it has to do with the usage of the HtmlHelper in the script section? If so how can I use in the script section?**

That is a simplified version of what I have going on but what I'm really trying to do is to populate the colNames for a jqGrid without having to hard code them in the javascript. I'd like to use the Data Annotations so I only have to change in one spot. The colNames for the jqGrid gets defined as

```
colNames: ['ParameterId','Location', 'Parameter Name', 'Date and Time', 'Parameter Value'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T11:00:46.337

在@Html.TickWrap(Html.DisplayNameFor(m => Model.SampleDateTime)) 周围加上''（引号）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T19:21:04.490

如果您想使用数据注释，您应该创建从属性类扩展的类。然后使用 PropertyInfo 反射获取值。

如果您想使用数据注释填充 jqGrid 的 colNames，我已经升级了我的 jq.grid 插件以支持数据注释，请查看此[jq.grid](http://aiskahendra.wordpress.com/2013/04/25/asp-net-mvc-jqgrid-nuget-v-1-1-0/)以获取更多信息

# .net - Why does HttpWorkerRequest fail during HttpRuntime.ProcessRequest after a .NET 2.0 to .NET 4.0 upgrade?

> ID：16071861
> 
> 赞同：8
> 
> 时间：2013-04-17T23:15:13.293
> 
> 标签：.net, httpruntime

I am upgrading our application, which has an internal webserver, from .NET 2.0 to .NET 4.0.

I am handling a request with an object `HttpListenerWorkerRequest`, that extends the `HttpWorkerRequest` class, and creates a request which `GetRawUrl()` returns a Url in the format of `http://localhost:82/Default.aspx`.

In .NET 2.0, sending this to `HttpRuntime.ProcessRequest(httpListenerWorkerRequest)` works without issue, however in .NET 4.0, I get a web page with the nothing but the text "Bad Request" on it.

Cracking open `HttpRuntime`, I can see that Bad Requests are thrown from `ProcessRequestInternal(HttpWorkerRequest wr)`, a private method that tries to build an HttpContext.

I tried this myself:

```
try
{
    //what's going on?
    hcontext = new HttpContext(workerRequest);
}
catch(Exception e)
{
    //Debugging break point here
} 
```

Pre-update (.NET 2.0), it builds fine, post-update (.NET 4.0), I get a System.ArgumentException stating that

`The relative virtual path 'http:/localhost:82/Default.aspx' is not allowed here`, thrown at

```
at System.Web.VirtualPath.Create(String virtualPath, VirtualPathOptions options)
   at System.Web.HttpRequest.get_ClientFilePath()
   at System.Web.Security.CookielessHelperClass.RemoveCookielessValuesFromPath()
   at System.Web.HttpContext.Init(HttpRequest request, HttpResponse response)
   at System.Web.HttpContext..ctor(HttpWorkerRequest wr)
   at Talcasoft.Web.Hosting.HttpWorkerThread.Run(Object request) in      
   C:\[OurLibrary].Web\Hosting\HttpWorkerThread.cs:line 51 
```

What has changed in .NET to cause this, and what can I do to get around it?

**EDIT** I have just noticed that the disallowed http: is followed by a single slash, not a double, although the GetRawUrl() in the request certainly returns a double.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T01:36:41.797

I'm not a 100% certain that this is the 'exact answer' but looks pretty close to me - and there is some more to write...

There seems to be a `breaking change` of a sort inside the `VirtualPath` class - and it's substantiated with how they are checking for `illegal characters`. (btw. you can google the 'VirtualPath source' for what seems a .NET 4 version of it).

Inside `VirtualPath.Create` a check is invoked for 'illegal virtual path characters'.

It first goes into registry ("**HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET**", "**VerificationCompatibility**") - to see if the `compatibility` mode 'illegal chars' should be used.

> Based on that - I'm guessing (I don't have a way of checking this right now) - that **if you set the above registry value (int) to `1`** - **you should get your methods working `the old way`** and w/o any additional effort. Note: a IIS (or host process) **restart may be required** as suggested in one of the links

And then based on that registry flag it used either of these two...

```
':', '?', '*', '\0' // .NET 4.0 - the default
'\0' // the 'compatibility' mode 
```

That seems to actually describe your story quite well as your path with the 'port' designation is actually `illegal` per the new default.

* * *

### FINAL EDIT / EXPLANATION:

**(update based on comments and the solution that solved it)**
This is my understanding of what's going on inside:

1) Solution for prior to .NET 4.0 was the `VerificationCompatibility` key (see above).

2) With .NET 4.0 internal handling and fixing of url paths is made more robust. And works fine in most cases. In short, **all paths are fixed and normalized before entering** the `VirtualPath.Create` - and your `http://...` becomes an expected absolute path `/Default.aspx`.

However when you supply the `HttpWorkerRequest` (instead of Request/Response etc.) - the `raw Url` is taken directly from the `worker` - **and the responsibility for supplying the correct and normalized paths is down to your worker request**. (this is still a bit iffy, and looks like a bug or bad handling internally).

**To reproduce the issue:**

```
internal class MyRequest : SimpleWorkerRequest
{
    public MyRequest() : base("", "", String.Empty, String.Empty, null) { }
    public override String GetRawUrl() { return "http://localhost:82/Default.aspx"; }
}
// ...
var wr = new MyRequest();
var context1 = new HttpContext(wr); 
```

Gives the error `The relative virtual path 'http:/localhost:82/Default.aspx' is not allowed here.`

**The FIX:**

```
public override String GetRawUrl() 
{ return new Uri(url, UriKind.RelativeOrAbsolute).AbsolutePath; } 
```

* * *

And some of the research on the subject based on that `VerificationCompatibility` keyword in the registry which seems to be the key to it.

[Ampersand in URL filename = bad request](http://forums.asp.net/t/1371764.aspx/2/10)

[Configure IIS to accept URL with Special Characters...](http://adorr.net/2010/01/configure-iis-to-accept-url-with-special-characters.html)

[For 32 vs 64 difference in Registry](https://stackoverflow.com/questions/3543850/bad-request-error-400-on-iis7-net-3-5/3545091#3545091)

And here is a similar thing from Microsoft - but what seems to be a 'hotfix' for '2.0', i.e. doesn't apply to you - but just attaching it as something official in this line.

[FIX: "HTTP 400 - Bad request" error message in the .NET Framework 1.1](http://support.microsoft.com/default.aspx?scid=kb;EN-US;826437)
[FIX: Error message when you try to visit an ASP.NET 2.0-based Web page: "HttpException (0x80004005): '/HandlerTest/WebForm1.aspx/a:b' is not a valid virtual path"](http://support.microsoft.com/kb/932552)
[ASP.NET 2.0 x64 – You may get HTTP 400 Bad Request or Error as mentioned in KB 932552 or 826437](http://blogs.iis.net/rakkimk/archive/2008/10/10/asp-net-2-0-x64-you-may-get-http-400-bad-request-or-error-as-mentioned-in-kb-932552-or-826437.aspx)

> HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET
> 
> DWord Value Name: VerificationCompatibility  Value Data: 1

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-22T09:37:54.737

这是我的看法。它仍然包含一些猜测，但我将包含一个测试，您可以进行测试以证明或反驳这个假设。

堆栈跟踪显示`ClientFilePath.get`为异常的起源。它看起来像这样：

```
 if (this._clientFilePath == null)
    {
        string rawUrl = this.RawUrl;
        int index = rawUrl.IndexOf('?');
        if (index > -1)
        {
            rawUrl = rawUrl.Substring(0, index);
        }
        this._clientFilePath
     = VirtualPath.Create(rawUrl, VirtualPathOptions.AllowAbsolutePath); //here!
    }
    return this._clientFilePath; 
```

它创建一个`VirtualPath`并且只允许绝对值。`http://localhost:82/Default.aspx`是相对路径，因为它不以斜杠开头。在这种情况下，它*不是*一个 URL，因为它没有被解释为这样。

所以`VirtualPath.Create`可以理解地否认这条道路。我不知道为什么 .NET 2.0 允许这样做，但 .NET 4.0 需要绝对路径，并且根据代码，这是不可配置的。

实际上，我以前从未见过`HttpRequest.RawUrl`返回 URL。以我的经验，它应该返回一个绝对路径，例如`/Default.aspx`. 如果你想设置主机和端口，你必须找到其他方法来做到这一点。

所以解决方法是不使用`http://localhost:82/Default.aspx`but `/Default.aspx`。这对你有用吗？

# jquery - 带有新 ID 的音频标签的 jQuery .clone() 不在 .click() 内的 IE 或 FF 上播放

> ID：16071863
> 
> 赞同：0
> 
> 时间：2013-04-17T23:15:29.987
> 
> 标签：jquery

带有新 ID 的音频标签的 jQuery .clone() 不在 .click() 内的 IE 或 FF 上播放

我的页面正文中有一个非常简单的音频标签

```
<audio preload="auto" id="badclick">
<source src="audio/button-4.ogg"/>
<source src="audio/button-4.mp3"/>
<source src="audio/button-4.wav"/>
<source src="audio/button-4.m4a"/>
</audio> 
```

我使用一些代码来克隆它并分配一个 ID 'badclick_1_1'

```
var gclk = 'badclick_1_1';
sounds[1] = $('#badclick');  
$(sounds[1]).clone(true).attr('id', gclk).insertAfter(sounds[1]); 
```

我尝试从 .click() 处理程序中播放声音，但虽然它在 Chrome 中播放，但它不在 IE 和 FF 上

```
var vol = .05;
var xclk = 'badclick_1_1';
var audiobad = $('#' + xclk)[0];
audiobad.volume=vol;
audiobad.play(); 
```

关于为什么的任何想法？

# html - 如何从列数据而不是 HTML 中的行数据创建表格？

> ID：16071864
> 
> 赞同：49
> 
> 时间：2013-04-17T23:15:35.163
> 
> 标签：html, html-table

根据[W3 Schools](http://www.w3schools.com/html/html_tables.asp)上的这篇文章，可以像这样在 HTML 中创建一个基本表格：

```
<table border="1">
    <tr>
        <td>row 1, cell 1</td>
        <td>row 1, cell 2</td>
    </tr>
    <tr>
        <td>row 2, cell 1</td>
        <td>row 2, cell 2</td>
    </tr>
</table> 
```

从上面看，似乎是按行输入数据。

我有一种情况，我需要按列输入所有数据。这样的事情可能吗？

```
<table border="1">
    <tc>
        <td>row 1, cell 1</td>
        <td>row 2, cell 1</td>
    </tc>
    <tc>
        <td>row 1, cell 2</td>
        <td>row 2, cell 2</td>
    </tc>
</table> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2018-08-22T19:51:39.620

在现代浏览器中，您可以通过在 CSS 中重新定义 TR 和 TD 标签行为来实现这一点。鉴于您问题中的 HTML，请附加下一个 CSS 样式：

```
table {
	display: table;
}
table tr {
	display: table-cell;
}
table tr td {
	display: block;
}
```

```
<table border="1">
    <tr>
        <td>row 1, cell 1</td>
        <td>row 2, cell 1</td>
    </tr>
    <tr>
        <td>row 1, cell 2</td>
        <td>row 2, cell 2</td>
    </tr>
</table>
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2015-12-17T11:39:57.607

您可以通过使用表中的表来呈现列中的表...

```
<table>
<tr>
<td>
    <table>
        <thead>
            <tr>
                <td>column 1 header 1</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>column 1 row 1</td>
            </tr>
            <tr>
                <td>column 1 row 2</td>
            </tr>
        </tbody>
    </table>
</td>
<td>
    <table>
        <thead>
            <tr>
                <td>column 2 header 1</td>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>column 2 row 1</td>
            </tr>
            <tr>
                <td>column 2 row 2</td>
            </tr>
        </tbody>
    </table>
</td>
</tr>
</table> 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-04-21T01:19:19.450

最好的办法是逐行呈现表格，然后使用 javascript 反转表格

[http://jsfiddle.net/CsgK9/2/](http://jsfiddle.net/CsgK9/2/)

以下代码将反转一个表（此示例代码使用 jquery）

```
 $("table").each(function() {
        var $this = $(this);
        var newrows = [];

        $this.find("tr").each(function(){
            var i = 0;

            $(this).find("td").each(function(){
                i++;
                if(newrows[i] === undefined) { newrows[i] = $(""); }
                newrows[i].append($(this));
            });
        });

        $this.find("tr").remove();
        $.each(newrows, function(){
            $this.append(this);
        });
    }); 
```

更新：

这是一个也适用于 th 元素的版本：http: [//jsfiddle.net/zwdLj/](http://jsfiddle.net/zwdLj/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-11-17T18:59:27.500

只是通过使用一堆充满 lis 的 uls 来做到这一点，看起来比我能找到的任何东西都要干净。您必须执行一些操作，例如向所有 uls 添加一个类并将其样式设置为显示：inline-table。

```
@* pseudo html/razor *@
@foreach(var col in columns){
    <ul class='tableColumn'>
        foreach(var data in col){
            <li>data</li>
        }
    </ul>    
} 
```

和一些造型

```
.tableColumn {
    border: 1px solid;
    display: inline-table;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-28T15:21:01.173

您始终可以创建一个父元素（表格），然后在表格内您可以创建宽度有限的内联块元素作为您的列，这样您添加到这些子列的任何内容都将遵循向下模式，然后要制作类似网格的图案，只需确保设置列内元素的高度，就像这样使用列表显示内容：

```
<div id="your_table">
    <span style="width: 25%" id="fist_column"> <ul></ul></span>
    <span style="width: 25%" id="second_column"><ul></ul></span>
    <span style="width: 25%" id="third_column"><ul></ul></span>
    <span style="width: 25%" id="fourth_column"><ul></ul></span>
</div> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-09-13T10:50:47.180

我处于同样的情况，我必须按列添加数据。但是，这个问题可以通过简单的方法解决。我在这个例子中使用了 twig，但你会很容易得到它。

```
<table>
<tr>
    <th>id</th>
    <th>title</th>
    <th>ISBN</th>
    <th>author_id</th>
    <th>publisher_id</th>
</tr>

{% for book in books %}   //for loop is used before the <tr> tag
    <tr>
        <td>{{ book.id }}</td>
        <td>{{ book.title }}</td>
        <td>{{ book.isbn }}</td>
        <td>{{ book.publisher.id }}</td>
        <td>{{ book.author.id }}</td>
    {% endfor %}
    </tr> 
```

注意：{{这是要打印的数据}}

# python - 非阻塞 subprocess.call

> ID：16071866
> 
> 赞同：62
> 
> 时间：2013-04-17T23:15:41.530
> 
> 标签：python, subprocess

我正在尝试进行非阻塞子进程调用以从我的 main.py 程序运行 slave.py 脚本。我需要将 args 从 main.py 传递给 slave.py 一次，当它（slave.py）第一次通过 subprocess.call 启动时，这个 slave.py 运行一段时间然后退出。

```
main.py
for insert, (list) in enumerate(list, start =1):

    sys.args = [list]
    subprocess.call(["python", "slave.py", sys.args], shell = True)

{loop through program and do more stuff..} 
```

还有我的奴隶脚本

```
slave.py
print sys.args
while True:
    {do stuff with args in loop till finished}
    time.sleep(30) 
```

目前，slave.py 阻止 main.py 运行其其余任务，我只是希望 slave.py 独立于 main.py，一旦我将 args 传递给它。这两个脚本不再需要通信。

我在网上找到了一些关于非阻塞 subprocess.call 的帖子，但其中大部分都集中在需要与 slave.py 进行通信的某个点上，而我目前不需要。有谁知道如何以简单的方式实现这个......？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-04-17T23:17:03.547

您应该使用`subprocess.Popen`而不是`subprocess.call`.

就像是：

```
subprocess.Popen(["python", "slave.py"] + sys.argv[1:]) 
```

从上的[文档`subprocess.call`](http://docs.python.org/2/library/subprocess.html#subprocess.call)：

> 运行 args 描述的命令。**等待命令完成**，然后返回 returncode 属性。

（如果您要使用 ，也不要使用列表来传递参数`shell = True`）。

* * *

这是一个演示非阻塞 suprocess 调用的 MCVE ^(1示例：)

```
import subprocess
import time

p = subprocess.Popen(['sleep', '5'])

while p.poll() is None:
    print('Still sleeping')
    time.sleep(1)

print('Not sleeping any longer.  Exited with returncode %d' % p.returncode) 
```

另一种依赖于 python 语言的最新更改以允许基于协同程序的并行性的替代方法是：

```
# python3.5 required but could be modified to work with python3.4.
import asyncio

async def do_subprocess():
    print('Subprocess sleeping')
    proc = await asyncio.create_subprocess_exec('sleep', '5')
    returncode = await proc.wait()
    print('Subprocess done sleeping.  Return code = %d' % returncode)

async def sleep_report(number):
    for i in range(number + 1):
        print('Slept for %d seconds' % i)
        await asyncio.sleep(1)

loop = asyncio.get_event_loop()

tasks = [
    asyncio.ensure_future(do_subprocess()),
    asyncio.ensure_future(sleep_report(5)),
]

loop.run_until_complete(asyncio.gather(*tasks))
loop.close() 
```

^(¹使用 python2.7 & python3.6 在 OS-X 上测试)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-04-17T23:21:29.620

这里有三个层次的彻底性。

正如 mgilson 所说，如果您只是换掉`subprocess.call`，`subprocess.Popen`保持其他所有内容相同，那么 main.py 将不会等待 slave.py 完成后再继续。这本身可能就足够了。如果您关心挂起的[僵尸进程](http://en.wikipedia.org/wiki/Zombie_process)`subprocess.Popen`，您应该保存从返回的对象，并在稍后调用它的`wait`方法。（当 main.py 退出时僵尸会自动消失，所以如果 main.py 运行很长时间和/或可能创建许多子进程，这只是一个严重的问题。）最后，如果你不想要僵尸但是您也不想决定在哪里进行等待（如果两个进程随后运行了很长时间且不可预测的时间，这可能是合适的），请使用[python-daemon](https://pypi.python.org/pypi/python-daemon)库让从站与主站解除关联——在这种情况下，您可以继续`subprocess.call`在主站中使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-09-30T20:39:24.427

对于 Python 3.8.x

```
import shlex
import subprocess

cmd = "<full filepath plus arguments of child process>"
cmds = shlex.split(cmd)
p = subprocess.Popen(cmds, start_new_session=True) 
```

这将允许父进程退出，而子进程继续运行。不确定僵尸。

在 macOS 10.15.5 上的 Python 3.8.1 上测试

# wpf - Custom WPF ComboBox doesn't show grouping

> ID：16071867
> 
> 赞同：2
> 
> 时间：2013-04-17T23:15:55.833
> 
> 标签：wpf, xaml, combobox, grouping

I have created a custom ComboBox in WPF

```
<!-- Combobox template -->
    <ControlTemplate x:Key="CustomComboBoxToggleButton" TargetType="ToggleButton">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="20"/>
            </Grid.ColumnDefinitions>
            <Border x:Name="Border" Grid.ColumnSpan="2" CornerRadius="3" Background="{StaticResource CustomDarkBlue}" BorderBrush="{StaticResource CustomWhite}" BorderThickness="2"/>
            <Border x:Name="Border2" Grid.Column="0" CornerRadius="3,0,0,3" Margin="1" Background="{StaticResource CustomBackground}" BorderBrush="{StaticResource CustomWhite}" BorderThickness="1,1,2,1"/>
            <Path x:Name="Arrow" Grid.Column="1" Fill="{StaticResource CustomGlyph}" HorizontalAlignment="Center" VerticalAlignment="Center" Data="M 0 0 L 4 4 L 8 0 Z"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="ToggleButton.IsMouseOver" Value="True">
                <Setter TargetName="Border" Property="Background" Value="{StaticResource CustomDarkBlue}"/>
            </Trigger>
            <Trigger Property="ToggleButton.IsChecked" Value="True">
                <Setter TargetName="Border" Property="Background" Value="{StaticResource CustomDarkBlue}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">                    
                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource CustomGray}"/>
                <Setter TargetName="Border2" Property="BorderBrush" Value="{StaticResource CustomGray}"/>
                <Setter Property="Foreground" Value="{StaticResource CustomGray}"/>
                <Setter TargetName="Arrow" Property="Fill" Value="{StaticResource CustomGray}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Combobox -->
    <Style x:Key="RoundedComboBox" TargetType="{x:Type ComboBox}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="True"/>
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
        <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>            
        <Setter Property="Foreground" Value="{StaticResource CustomWhite}"/>
        <Setter Property="Background" Value="{StaticResource CustomBackground}"/>
        <Setter Property="Height" Value="21"/>
        <Setter Property="FontSize" Value="14"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ComboBox">
                    <Grid>
                        <ToggleButton Name="ToggleButton" Template="{StaticResource CustomComboBoxToggleButton}" Grid.Column="2" Focusable="False" IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press"/>
                        <ContentPresenter Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}" Margin="3,1,23,1" VerticalAlignment="Center" HorizontalAlignment="Left"/>                            
                        <Popup Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False" PopupAnimation="Slide">
                            <Grid Name="DropDown" SnapsToDevicePixels="True" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                <Border x:Name="DropDownBorder" Background="{StaticResource CustomBackground}" BorderThickness="2" BorderBrush="{StaticResource CustomWhite}"/>
                                <ScrollViewer Margin="4,6,4,6" SnapsToDevicePixels="True">
                                    <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                </ScrollViewer>
                            </Grid>
                        </Popup>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasItems" Value="False">
                            <Setter TargetName="DropDownBorder" Property="MinHeight" Value="95"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Foreground" Value="{StaticResource CustomGray}"/>                                
                        </Trigger>
                        <Trigger Property="IsGrouping" Value="True">
                            <Setter Property="ScrollViewer.CanContentScroll" Value="False"/>
                        </Trigger>
                        <Trigger SourceName="Popup" Property="Popup.AllowsTransparency" Value="True">
                            <Setter TargetName="DropDownBorder" Property="CornerRadius" Value="4"/>
                            <Setter TargetName="DropDownBorder" Property="Margin" Value="0,2,0,0"/>
                        </Trigger>                            
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

This is then applied to a ComboBox

```
<ComboBox Grid.Column="0" x:Name="cboChild" Margin="140,65,0,0"  ItemsSource="{Binding Source={StaticResource GroupedData}}" ItemTemplate="{StaticResource AccountTemplate}" SelectedValue="{Binding Source={StaticResource Item}, Path=child}" SelectedValuePath="ID" Width="150" Style="{StaticResource RoundedComboBox}" HorizontalAlignment="Left" VerticalAlignment="Top">                        
                        <ComboBox.GroupStyle>
                            <GroupStyle HeaderTemplate="{StaticResource GroupHeader}"/>                                
                        </ComboBox.GroupStyle>
                    </ComboBox> 
```

The following is found in Window.Resources

```
<Window.Resources>
    <CollectionViewSource Source="{Binding ChildAccounts}" x:Key="GroupedData">
        <CollectionViewSource.GroupDescriptions>
            <PropertyGroupDescription PropertyName="group"/>
        </CollectionViewSource.GroupDescriptions>
    </CollectionViewSource>

    <DataTemplate x:Key="GroupHeader">
        <TextBlock Text="{Binding group}" Margin="0" Foreground="{StaticResource CustomWhite}"/>
    </DataTemplate>
    <DataTemplate x:Key="AccountTemplate">
        <TextBlock Text="{Binding comment}" Margin="0" Foreground="{StaticResource CustomWhite}"/>
    </DataTemplate>        
</Window.Resources> 
```

Basically grouping works as it should when the RoundedComboBox style is NOT applied (ie. to the default ComboBox) but whenever the style is applied the drop-down popup is empty

Help!!

Thanks Andy

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T08:22:16.287

找到了答案.....使用`<ItemsPresenter ...>`而不是`<StackPanel ...>`

感谢 sa_ddam213 就绑定问题提供的有用建议。

# vb.net - Operator '=' is not defined for type 'DBNull' and type 'Integer'

> ID：16071869
> 
> 赞同：10
> 
> 时间：2013-04-17T23:16:23.317
> 
> 标签：vb.net

I've been struggling for the past few hours and still can't get my head round this one . The issue I am having is when someone has been admitted the database updates giving them BedID , when I then try and discharge them I can't seem to set the BedID (In the database) to nothing . This is an issue as I need to be able to admit and discharge as many people as I can.

```
Sub Dis1_Click(ByVal s As Object, ByVal e As EventArgs) Handles Dis1.ServerClick

    Dim time As String = Now().ToString("dd-MM-yyyy hh:mm:ss")

    sql = "UPDATE Allocation  SET BedID = NULL , DischargeDate =" + "'" + time + "'" + " WHERE BedID = 1 "
    cmd = New OdbcCommand(sql, cn)
    cmd.ExecuteNonQuery()
End Sub

Sub BedCheck1()
    If r("BedID") = "" Then
    Else
        If r("BedID") = 1 Then
            ba = s & "<tr><td>" & r("Surname") & "</td>" & "<td>" & r("Forename") & "/<td>" & "<td>" & r("AdmitDate") & "</td>" & "<td>" & r("DischargeDate") & "</td>" & "<td>" & r("comments") & "</td></tr>"
        End If
    End If
End Sub 
```

Thanks!

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-17T23:20:27.663

在读取值之前，您需要进行 DbNull 检查：

```
If Not IsDbNull(r("BedID")) Then

    If r("BedID") = "" Then
    Else If r("BedID") = 1 Then
        ba = s & "<tr><td>" & r("Surname") & "</td>" & "<td>" & r("Forename") & "/<td>" & "<td>" & r("AdmitDate") & "</td>" & "<td>" & r("DischargeDate") & "</td>" & "<td>" & r("comments") & "</td></tr>"
    End If
End If 
```

请注意，DbNull 是一种特殊情况，您需要使用 IsDbNull 函数来防止此错误

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-11-28T11:54:22.023

试试这个：如果 r("BedID").ToString = " " 那么

万一

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-08T10:46:30.543

好吧，在检查数据验证之前，您需要检查它是否为 DB null。

```
If Not IsDbNull(r("BedID")) Then
your code
End if 
```

# mysql - MYSQL query using Left Join and Where IN clause

> ID：16071871
> 
> 赞同：2
> 
> 时间：2013-04-17T23:16:32.493
> 
> 标签：mysql, join, left-join

I have three tables A B C and i'm trying to retrieve information from all three.

A has the columnns userid avatar username and B has the column postid, dateshared and C has the column commenter postid datecommented.

I'm trying to run the query

```
Select  C.comment, C.commenter,  C.datecommented, B.postid, B.dateshared A.username A.avatar from B Left Join C  Left join A on C.postid = B.postid AND A.userid = C.commenter where B.postid IN ('1','2','3') order by  C.dateshared desc 
```

but it gives the following error:

```
 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'where B.postid IN ('1', '2', '3') order by C.dateshared ' 
```

Can anyone point out what I'm doing wrong or suggest how to go about it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:21:08.837

每个都`LEFT JOIN`需要自己的`ON`条件：

```
SELECT  C.comment, C.commenter, C.datecommented, B.postid, B.dateshared, A.username A.avatar
FROM    B
LEFT JOIN
        C
ON      C.postid = B.postid
LEFT JOIN
        A
ON      A.userid = C.commenter
WHERE   B.postid IN ('1','2','3')
ORDER BY
        C.dateshared desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:00:37.740

这应该对您有用，您的查询有一些语法错误：

```
Select  C.comment,C.commenter,C.datecommented,B.postid,B.dateshared,A.username,A.avatar
from B
Left Join C on C.postid = B.postid
Left join A on A.userid = C.commenter
where B.postid IN ('1','2','3')
order by  C.dateshared desc 
```

# php - Check If User Subscription Is In Date - Not Working

> ID：16071872
> 
> 赞同：0
> 
> 时间：2013-04-17T23:16:43.770
> 
> 标签：php, mysql

I currently have this code in my login script to check if the users subscription is in date:

```
// get the current date
$now = date("Y-m-d");
    if ($user_id['enddate'] < $now) {
      ?>
      <p>your Licence is out of date</p>
      <?php
      }
else
      {
      ?>
      <p>your licence is in date</p>
      <?php
      } 
```

The value storing the expiry date is 'enddate'.

It just goes straight to the out of date message, whether the user has a subscription in date or not. I can't get my head around it.

The MYSQL field for enddate is just type 'date', and is generated from the registration script:

```
$enddate = date("Y-m-d", strtotime("+ 365 day")); 
```

Any ideas? I know i'm working in depreciated MYSQL, but I need to for this project.

Cheers

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:44:11.793

仅供参考：解决了以下问题：

```
$expirydate = mysql_query("SELECT enddate FROM users WHERE user_id = '".$_SESSION["user_id"]."'"); echo $query;
$expirydate2 = mysql_result($end, 0);
$now = strtotime(date("Y-m-d"));
if (strtotime($expirydate2) < $now) { 
```

希望这对你们中的一些人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:25:53.887

您需要转换为时间，日期只是一个字符串......

```
$now = strtotime(date("Y-m-d"));
if (strtotime($user_id['enddate']) < $now) {
  ?>
  <p>your Licence is out of date</p>
  <?php
  }
else
  {
  ?>
  <p>your licence is in date</p>
  <?php
  } 
```

# c++ - remove an element from a singly sorted linked list C++

> ID：16071876
> 
> 赞同：0
> 
> 时间：2013-04-17T23:16:56.190
> 
> 标签：c++

I have a sorted linked list and im trying to create a function to delete whatever the user passes to nameToSearch. but i keep geting an error. Below is what i have so far

```
void deleteProduct(NodePtr head, char* nameToSearch)
    {
        NodePtr nodeUnderEdit = findNodeByName(head, nameToSearch);
        if (nodeUnderEdit == NULL) 
        {
            cout<<"\n ERROR: Product not found \n";
        }
        else
        {

            delete nodeUnderEdit;
            nodeUnderEdit = nodeUnderEdit->next;

        }   

    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T23:19:05.247

```
 delete nodeUnderEdit;
  nodeUnderEdit = nodeUnderEdit->next; 
```

如果您`nodeUnderEdit`先删除，`nodeUnderEdit->next`则将丢失。您需要首先确保在nodeUnderEdit的next之前连接到的节点`nodeUnderEdit->next`，然后您才能进行删除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:21:08.577

这始终是单链表的问题。

出现问题是因为从链表中删除当前节点需要修改*前一个*节点中的指针——您无法直接访问该指针。

处理此问题的一种方法是使用带有哨兵的列表（包含您识别为列表末尾的值的最终节点）。在这种情况下，您可以将值从*下一个*节点复制到当前节点，然后从列表中删除下一个节点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T23:22:03.760

要删除单链表中的项目，您必须将指针从上一条记录更改为指向下一条记录。您的“findNodeByName”仅仅找到具有匹配名称的节点是不够的。它必须按照排序顺序找到它的Previous节点，然后将要删除的记录的Next点设置为该记录的Next指针。只有在您更新了上一条记录的下一条指针后，您才能删除您搜索的记录。

# python - Python - 总结 try-except 语句

> ID：16071885
> 
> 赞同：2
> 
> 时间：2013-04-17T23:17:40.837
> 
> 标签：python, except

我想总结以下代码。它应该做的是检查计算中的变量是否已分配。如果不是，那么结果将为零。因为我有数百个这样的计算，所以我不想重复尝试，除了每个计算。

我怎么能那样做？

```
a = 1
b = 2
d = 3
f = 2

try:
    ab = a + b
except:
    ab = 0

try:    
    ac = a - c
except:
    ac = 0

try:    
    bg = b / g
except:
    ac = 0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T23:19:15.077

编写一个函数来执行此操作，使用`lambda`（单行函数）推迟对变量的评估，以防其中一个不存在：

```
def call_with_default(func, default):
    try:
        return func()
    except NameError:   # for names that don't exist
        return default

ab = call_with_default(lambda: a+b, 0)
# etc. 
```

您可能会受益于使用某种数据结构（例如列表或字典）来包含您的值，而不是将它们存储在单个变量中；然后您可以使用循环来完成所有这些计算，而不是单独编写它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T00:04:48.520

如果您有一堆甚至可能没有定义的变量，那么您可能实际上并没有一堆变量。

例如，如果您正在尝试构建一个交互式解释器，用户可以在其中创建新变量，请不要尝试将每个用户变量保存为同名的全局变量（如果除了安全之外没有其他原因 - 会发生什么如果用户尝试创建一个名为`main`并删除您的`main`函数的变量？）。存储用户变量的字典。

一旦你这样做了，Alexey 和 kindall 建议的解决方案将起作用：

```
def add_default(first, second, default):
    try:
        return variables[first] + variables[second]
    except KeyError:
        return default

    variables['ab'] = add_default('a', 'b', 0) 
```

如果您确实需要在同一级别混合您的代码和用户代码，您*可以*使用`globals()`它自己作为您的字典：

```
def add_default(first, second, default):
    try:
        return globals()[first] + globals()[second]
    except KeyError:
        return default

ab = add_default('a', 'b', 0) 
```

但是，使用`globals`这种方式几乎总是表明您之前犯了重大设计错误，正确的做法是备份，直到您发现该错误......</p>

* * *

同时，来自评论：

> 我创建了所有变量的列表，并在它们是否分配了值时遍历它们。如果他们没有，我会将它们设置为浮动（'nan'）。

没有办法创建变量列表（当然，通过 name off 引用它们除外`globals()`）。您可以创建一个*值*列表，但这对您没有任何好处，因为未定义的变量没有值。

这是另一个迹象，表明您在这里可能想要的不是一堆单独的变量，而是一本字典。

特别是，您可能想要一个[`defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)：

```
variables = collections.defaultdict(lambda: float('nan')) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T23:31:14.163

对于更通用的情况，您可以使用 lambdas（虽然不是太优雅的解决方案）：

```
def lambda_default(func, default, *args):
    try:
        return func(*args)
    except:
        return default

abc = lambda_default(lambda x, y: x + y * z, 0, a, b, c) 
```

如果你有一些常用的函数，你可以将它们包装成另外一个`def`，当然：

```
def add_default(first, second, default):
    return lambda_default(operator.add, 0, first, second)

ab = add_default(a, b, 0) 
```

# r - 安装 R 包会导致错误消息

> ID：16071892
> 
> 赞同：1
> 
> 时间：2013-04-17T23:18:49.253
> 
> 标签：r, package

我尝试安装 R 包 crypticIBD 检查，但是当我尝试使用它时出现以下错误

```
> library("CrypticIBDcheck")
load package : rJPSGCS
load package : rJava
Error : .onLoad in loadNamespace() für 'rJava' error, details:
  command: fun(libname, pkgname)
  error: JAVA_HOME cannot be determined from the Registry
error: Paket ‘rJava’ can't be found
> 
```

有人能指点我一个方向吗？

然后我成功安装了 rJava 包并再次运行该包

```
 : .onLoad in loadNamespace() error for rJava
  command: fun(libname, pkgname)
  error: JAVA_HOME cannot be determined from the Registry
error: Paket ‘rJava’ can't be found
> 
```

# actionscript-3 - How do you detect multiple objects going offscreen?

> ID：16071896
> 
> 赞同：1
> 
> 时间：2013-04-17T23:19:09.077
> 
> 标签：actionscript-3, flash

I am making a game in AS3, and I want to have a "health bar". When one of my "alien" objects hits the Earth, I would like my health to go down. I just do not know how to make the stage register that an object gone offscreen, or "hit the ground". Any help would be great!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:41:34.890

```
var aliens = [new Alien(), new Alien(), new Alien()];
var health = 10;

// Check position of aliens on each frame
this.addEventListener(Event.ENTER_FRAME, enterFrameHandler);

function enterFrameHandler(event:Event):void
{
    for (var i:int = 0; i < aliens.length; i ++)
    {
        // If the alien's y position is equal to or greater than
        // the stage height, he's hit the deck
        if (aliens[i].y <= this.stage.stageHeight) 
        {
            health --;
        }
    }
} 
```

# python - python中的异常字符串列表行为

> ID：16071899
> 
> 赞同：0
> 
> 时间：2013-04-17T23:19:25.320
> 
> 标签：python, string, list, startswith

```
 print difflist
    for line in difflist:
        if ((line.startswith('<'))or (line.startswith('>')) or (line.startswith('---'))):
            difflist.remove(line)
    print difflist 
```

在这里，最初，

```
difflist = ['1a2', '> ', '3c4,5', '< staring', '---', '> starring', '> ', '5c7', '< at ', '---', '> add ', ''] 
```

我对代码的期望是打印

```
['1a2', '3c4,5', '5c7', ''] 
```

但我得到的是

```
difflist= ['1a2', '3c4,5', '---', '> ', '5c7', '---', ''] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:24:36.480

当迭代一个列表时，python 会保留它指向的数组元素的整数索引。但是，当您*删除*当前元素时，所有后面的元素都会转移到较低的索引。然后位置索引会在您“看到”移动以取代您删除的元素的元素之前递增。

最终，最好通过列表理解来完成：

```
difflist = [ line for line in difflist if not line.startswith(('<','>','---'))] 
```

如果您真的需要就地执行操作，只需在左侧使用切片分配：

```
difflist[:] = [ line for line in difflist if not line.startswith(('<','>','---'))] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:21:36.820

我认为您可能会使迭代器无效；换句话说，您不应该尝试删除您正在循环的列表中的项目。

您可能想要创建一个仅包含您关心的项目的新列表。

例如：

```
newdifflist = []
for line in difflist:
    if not ((line.startswith('<'))or (line.startswith('>')) or (line.startswith('---'))):
        newdifflist.append(line) 
```

更 Pythonic，使用列表推导和多个参数`startswith()`：

```
newdifflist = [line for line in difflist if not line.startswith(('<', '>', '---')) ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T23:24:29.693

```
result = []
for line in difflist:
    if not line.startswith(('<', '>', '---')):
        result += [line] 
```

或使用列表推导：

```
[line for line in difflist if not line.startswith(('<', '>', '---'))] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T23:25:09.883

改为这样做：

```
>>> difflist = [i for i in difflist if not i.startswith(('<','>','---'))]
>>> difflist
['1a2', '3c4,5', '5c7', ''] 
```

这样做`.remove()`会改变顺序，因此（有点）弄乱了 for 循环。查看 mgilson 的答案以获取更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T23:25:25.203

而不是试图从列表中删除该项目，让它什么都不做，并用你想要的东西创建另一个列表。

```
array = []
for line in difflist:
    if ((line.startswith('<'))or (line.startswith('>')) or (line.startswith('---'))):
        pass
    else:
        array.append(line) 
```

现在数组将是您正在寻找的数组！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T23:25:57.180

发生的事情并没有什么“异常”。事实上，这很正常。这是正在发生的事情：

1.  循环正在查看项目*i*。
2.  *我*的项目符合你的测试，所以你删除它。以前的项目*i+1*现在是项目*i*。
3.  您的循环再次开始，迭代器前进以指向项目*i+1*，但*新*项目*i*从未经过测试。

有几种可能的解决方案：

1.  制作一个只包含您想要的项目的新列表，而不是从现有列表中删除项目。这具有更好的算法复杂性，并且在 Python 中也更高效，但它可以使用更多的内存。
2.  以相反的顺序迭代列表。这样，您只需要移动您已经查看过的项目。
3.  遍历列表的副本。
4.  使用内部`while`循环而不是`if`.

对于这个问题，解决方案 #4 可能如下所示：

```
for i, line in enumerate(difflist):
    while line.startswith(('<', '>', '---')):
        difflist.pop(i)
        line = difflist[i] 
```

这样，您将一直查看相同的索引，直到它未通过测试，然后才允许迭代器继续进行下一个。

（我冒昧地删除了您条件中过多的不必要的括号，并将您的更改`remove`为`pop`-`remove`每次都需要从列表的开头进行搜索，使您的循环成为[Schlemiel the Painter 的算法](http://en.wikipedia.org/wiki/Schlemiel_the_Painter%27s_algorithm)）。

您可以研究的另一件事是使用`deque`（来自`collections`模块）；这是一个链表（普通的 Python`list`实际上是一个可调整大小的数组），从中删除元素会更快一些。

# c++ - 编译器无关类型

> ID：16071904
> 
> 赞同：0
> 
> 时间：2013-04-17T23:20:07.090
> 
> 标签：c++

我见过几个库和一些提供编译器独立类型的 C++ 头文件，但我不太明白为什么它们独立于编译器。

例如：

```
int Number; // Not compiler Independent

typedef unsigned int U32;
U32 Number2; // Now this is compiler independent 
```

以上是真的吗？如果是这样，为什么？我不太明白为什么使用 typedef 意味着 Number2 的大小在编译器中是相同的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:28:11.563

我假设您的意思是类型与`unsigned int Number`.

但是不，这些是完全一样的。两个声明`Number`和`Number2`具有相同的类型。两者都不比另一个更独立于编译器。

但是，使用`typedef`这样的点是为了使库的开发人员可以轻松更改所有使用`U32`. 例如，如果它们位于 an`unsigned int`不是 32 位而是 an 的`unsigned long`系统上，则可以将其更改`typedef`为：

```
typedef unsigned long U32; 
```

事实上，可以使用构建系统`typedef`根据目标平台有条件地更改。

但是，如果您想要一种很好的标准化方法来确保该类型是 32 位无符号整数类型，我建议`std::uint32_t`从`<cstdint>`标头中使用。但是，如果您使用的机器没有 32 位整数类型，则不保证存在此类型。相反，您可以使用`std::uint_least32_t`，它将为您提供至少 32 位的最小整数类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:28:34.477

细化评论，

建议：使用 typedef 来实现编译器独立性。

理由：平台独立是一件好事

*实施*：

```
#ifdef _MSC_VER
    #if _MSC_VER < 1400
    typedef int bar;
    #elif _MSC_VER < 1600
    typedef char bar;
    #else
    typedef bool bar;
#else
#error "Unknown compiler"
#endif 
```

预处理器宏链是重要的部分，而不是 typedef。

免责声明：我没有编译它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T23:28:31.643

如评论中所述，显示的 typedef 不是独立于编译器的。

如果您想要一种独立于编译器的方式来获得固定大小，您可能需要使用[cstdint](http://www.cplusplus.com/reference/cstdint/)。这个头文件实际上随您的编译器一起提供，并确保您有一个最小大小，但对于更大的类型（64 位、128 位）没有最大值。

如果您想完全确定您的类型的所有尺寸，您需要检查它。

# sql - 将表从 SQL 服务器导入 XML

> ID：16071908
> 
> 赞同：0
> 
> 时间：2013-04-17T23:20:28.803
> 
> 标签：sql, sql-server, sql-server-2008

我正在尝试将信息从 SQL 服务器导入 XML，并尝试在 E 驱动器中创建一个 .xml 文件。但是，下面显示的代码不起作用：

```
 CREATE PROC x
    AS
    DECLARE @xmlOutput xml,
            @myFile varchar(8000)

    SET @xmlOutput= ( SELECT TOP 1000 [tmc_code]
                                ,[measurement_tstamp]
                                ,[speed]
                                ,[average_speed]
                                ,[reference_speed]
                                ,[travel_time_minutes]
                                ,[confidence_score]
                                ,[cvalue]
                                 FROM [INRIX_DATA].[dbo].[Sample]
                                 FOR XML AUTO)

    SET @myFile='E:\britain.xml'

    EXEC x 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:23:45.527

您可以使用[xp_cmdshell](http://msdn.microsoft.com/en-us/library/ms175046.aspx)和[bcp 实用程序](http://msdn.microsoft.com/en-us/library/ms162802.aspx)来实现这一点

```
EXEC xp_cmdshell 'bcp "SELECT * FROM MyTable FOR XML AUTO, ELEMENTS" queryout "E:\mytableFile.xml" -c -T' 
```

# javascript - jquery 表单结果未显示。我的代码错了吗？

> ID：16071912
> 
> 赞同：0
> 
> 时间：2013-04-17T23:20:56.337
> 
> 标签：javascript, jquery, css, ajax, output

我的表格有困难。在我的一个页面上是一个表格。您输入信息，单击提交，它会返回一些结果。好吧，它应该返回一个结果。目前，它似乎什么也没做。但是，如果我在开发人员工具中检查标题响应，它确实会显示结果。所以我知道他们被正确地调用了，他们只是没有出现在网页上。

这是调用代码：

```
 $content .= '
    <script type="text/javascript">
        var $j = jQuery.noConflict();
        $j(window).load(function(){
            $j("#pubverify-form").submit(function() {
                var str = $j(this).serialize();
                   $j.ajax({
                   type: "POST",
                   url: "' . $cs_base_dir . 'verify.php",
                   data: str,
                   success: function(msg){
                        $j("#note").ajaxComplete(function(event, request, settings)
                        {
                            $j(this).html(msg);
                        });
                    }
                 });
                return false;
            });
        });
    </script>'; 
```

这是我认为应该显示结果的代码：

```
 $content .= '<div id="verify-a-rec" class="clear">';
        $content .= '<div id="fields">';
        $content .= '<h4>Verify A Recommendation</h4>';
        $content .= '<div class="verify_search">';
            $content .= '<form id="pubverify-form" action="">';
                    $content .= '<div class="label_wrap_verify"><label class="error" for="search_last_name">Last Name </label>';
                    $content .= '<div class="input_wrap_verify"><input name="search_last_name" type="text" id="search_last_name"/></div></div>'; 
                    $content .= '<div class="label_wrap_verify"><label class="error" for="search_dob">Birthdate (mm-dd-yyyy) </label>';
                    $content .= '<div class="input_wrap_verify"><input name="search_dob" type="text" id="search_dob"/></div></div>'; 
                    $content .= '<div class="label_wrap_verify"><label class="error" for="search_issue_date">Issue Date (mm-dd-yyyy)</label>';
                    $content .= '<div class="input_wrap_verify"><input name="search_issue_date" type="text" id="search_issue_date"/></div></div>'; 
                $content .= '<div class="button_wrap"><input type="submit" value="Verify" class="button" id="pubverify-submit" /></div>';
            $content .= '</form>';
        $content .= '</div>';
        $content .= '</div>';
        $content .= '<div style="clear:both"></div>';
        $content .= '<div id="note">';
        $content .= '<p>Enter a Recommendation ID and click Verify!</p>';
            $content .= '<div class="patient_wrapper">';
                $content .= '<div class="results_label">First Name </div>';
                $content .= '<div class="results_label">Last Name </div>';
                $content .= '<div class="results_label">Date of Birth </div>';
                $content .= '<div class="results_label">Issue Date </div>';
                $content .= '<div class="results_label">Expiration Date </div>';
                $content .= '<div class="results_label">Dr. Information </div>';
            $content .= '</div>';
        $content .= '</div>';
    $content .= '</div>';
return $content; 
```

有人可以帮忙吗！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:31:08.360

这部分是错误的。

```
$j("#note").ajaxComplete(function(event, request, settings)
{
    $j(this).html(msg);
}); 
```

您需要删除 ajaxComplete 代码。

```
$j.ajax({
   type: "POST",
   url: "' . $cs_base_dir . 'verify.php",
   data: str,
   success: function(msg){
       $j("#note").html(msg);
    }
 }); 
```

# jquery - Jquery 未加载到第二页

> ID：16071916
> 
> 赞同：0
> 
> 时间：2013-04-17T23:21:06.927
> 
> 标签：jquery

感谢马特解决了！

所以这是我在重做我的新网站时遇到的一个奇怪的错误。我在一页上添加了第二个推荐，它似乎已经“破坏”了我工作的平滑滚动 Jquery。

Beta 站点在这里... www.anim-house.co.uk 您可以看到滚动运行良好。在 www.anim-house.co.uk/portfolio.html 上滚动不起作用 - 添加

```
$(document).ready(function(){
    $('#fade').list_ticker({
        speed:14000,
        effect:'fade'
    });     
}); 
```

好像坏掉了？如果有人可以查看并找出错误 ID，我对 Jquery 很业余，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:24:02.440

您的portfolio.html 中有错误：

这是我从 Chrome 开发工具中得到的：

未捕获的类型错误：无法在第 66 行读取未定义的属性“顶部”

受影响的线路是：

var targetOffset = $target.offset().top;

收到该错误后，浏览器将停止处理，并且您的插件可能未加载。修复此错误也应该修复其余错误（前提是没有其他错误）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T23:37:06.303

```
$('a[href*=#]').each(function() { console.log(this.hash)})
#contact
#cgi
#web-design
#graphic-design
#motion-graphics
#photography
#home
#cgi
#web-design
#graphic-design
#motion-graphics
#photography
#home
null
null
null 
```

导致错误的是最后三个。它们与带有 href="#" 的链接相关。而不是检查

```
if(target) { 
```

检查

```
if ($target  && target) { 
```

**编辑**： OP 得到它的工作： http: [//paulund.co.uk/smooth-scroll-to-internal-links-with-jquery](http://paulund.co.uk/smooth-scroll-to-internal-links-with-jquery)

顺便说一句，该网站看起来很不错。

# c - 创建固定长度字符串的二维数组（字符数组）

> ID：16071921
> 
> 赞同：0
> 
> 时间：2013-04-17T23:21:23.730
> 
> 标签：c, arrays, char

所以我一直试图在 C 中创建一个对象，它本质上是两列空字符数组。它的内容类似于

```
char * strings[3][2]
{
  {"thing1", "value1"}
  {"thing2", "value2"}
  {"thing3", "value3"}
} 
```

...除了实际的 char *s 将是具有固定长度的空数组，而不是初始化的字符串，即每个字符串实际上都类似于“char string[6]”。

我一直在寻找一段时间，但我正在干涸。有人会碰巧知道创建这样一个对象的语法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:23:00.173

也许是这样的：

```
typedef char sixchars[7];

sixchars strings[3][2] = { { "thing1", "value1" }
                         , { "thing2", "value2" }
                         , { "thing3", "value3" }
                         }; 
```

# c# - JSP 的 ASP.NET 等价物包括

> ID：16071925
> 
> 赞同：2
> 
> 时间：2013-04-17T23:21:35.987
> 
> 标签：c#, asp.net, jsp, webforms

在 JSP 中，我可以使用 include 共享 HTML 代码：

```
<jsp:include page="subsection.jsp" > 
```

在我的一生中，我不知道应该如何在 ASP.NET 中包含共享 HTML。我可以使用模板控件，但这确实不是一回事。我可以使用站点母版页和内容占位符，但这也不一样，需要不同的方法来开发我的页面。

是我运气不好还是在 ASP.NET 中有类似于 JSP 包含的功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T05:37:11.760

您必须从服务器启用它，然后才能使用包含 html 文件。

```
<!-- #include file="Static/Menu.html" --> 
```

在 IIS7 中启用 SSI 的说明可在[http://tech.mikeal.com/获得](http://tech.mikeal.com/blog1.php/2008/08/05/server-side-includes-for-html-in-iis7)

对于动态内容，有一个称为 MasterPages 的内置模板方法，应该使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T23:35:22.147

我认为您想要的可以通过[User Controls](http://msdn.microsoft.com/en-us/library/y6wb1a0e.aspx)在 Asp.Net 中完成。如果你在 Asp.Net MVC 中，你会想要使用[Partial Views](http://msdn.microsoft.com/en-us/library/dd410123%28v=vs.98%29.aspx)。

# linq - 获取多列的总和并从列表中汇总相同 id 的值

> ID：16071929
> 
> 赞同：1
> 
> 时间：2013-04-17T23:22:03.290
> 
> 标签：linq, c#-4.0, asp.net-4.0

我有一个返回的列表。

```
Grade Col1 Col2  Col3  Col4
 t1   2    1      3     2
 t2   2    5      1     5
 t1   2    6      4     4 
```

首先，我需要在每一行中添加相应等级的值，这样我就有

```
Grade  Sum(Sum of the 4 columns)     
t1     8
t2     13
t1     16 
```

最后我的结果应该是这样的：

```
Grade   Total
t1      8+16 = 24
t2       13 
```

我是 Linq 的新手，有人可以建议我使用 Linq 的方法来返回这个结果吗？？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:26:35.483

以下 LINQ 查询将按等级对所有行进行分组，然后为每个等级生成列总和：

```
var query = from r in list
            group r by r.Grade into g
            select new {
               Grade = g.Key,
               Total = g.Sum(x => x.Col1 + x.Col2 + x.Col3 + x.Col4)
            }; 
```

# php - Crontab 未向正确的人发送 php 提醒电子邮件

> ID：16071933
> 
> 赞同：0
> 
> 时间：2013-04-17T23:22:34.363
> 
> 标签：php, email, cron

我尝试开发一项新功能，系统可以在用户预订到期前一天向用户发送电子邮件。我写了一个php脚本，每天早上用crontab触发php文件的执行。现在的问题是，如果我编译 php 文件，一切正常，并且电子邮件会发送给用户。当我检查邮件日志时，它告诉

```
to=<useremail@email.com>, ctladdr=<blablala> (0/0), delay=00:04:12, xdelay=00:04:12, mailer=esmtp, pri=120371, relay=XXXXXXX., stat=Sent (r3HMoisd031604 Message accepted for delivery) 
```

但是如果我使用 crontab 执行相同的 php 文件，邮件将发送到服务器的根目录，而不是我在 php 文件中写的“useremail@email.com”。

```
to=<root@myserver.com>, ctladdr=<blablabla> (0/0), delay=00:00:00, xdelay=00:00:00, mailer=local, pri=30958, dsn=2.0.0, stat=Sent 
```

它可能有什么问题？为什么 crontab 中的 php 文件不能按预期工作？任何人都可以帮忙吗？

我的 php 文件——“demo.php”

```
require_once "defaultincludes.inc";
global $tbl_entry, $tbl_users;

$current =  mktime(date("H"),date("i"),0,date("m"),date("d"),date("Y"));
$start = $current + 12*3600;
$end = $current + 40*3600;

$query="SELECT U.email, U.fullname, E.name  FROM $tbl_entry E, $tbl_users U "
       ." WHERE U.name = E.create_by "
       ." AND E.end_time >= $start "
       ." AND E.end_time <= $end ";
$result= sql_query($query);
$mail_list=array();
for ($i=0; ($row=sql_row_keyed($result,$i));$i++)
{
    $temp=array();
    $temp[]=$row['fullname'];
    $temp[]=$row['email'];
    $temp[]=$row['name'];
    $mail_list[]=$temp;
}

for ($i=0; $i<count($mail_list); $i++) {
    $to = $mail_list[$i][1];
    $subject= "Reminder of ".$mail_list[$i][2];
    $body = "Hi ".$mail_list[$i][0].",\n"
             ." Your reservation ".$mail_list[$i][2]." will expire in one day";
    mail($to,$subject,$body);
} 
```

crontab 文件——“reminder.txt”

```
30 7 * * * /var/www/html/qars-vm90/demo.php 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:33:32.843

```
/var/www/html/qars-vm90/demo.php 
```

仅当脚本被标记为可执行时才有效。此外，您需要在文件顶部有一个 shebang 来告诉 shell 如何处理该文件（如果它使用 perl、php、python 执行它...）

我怀疑发送的电子邮件是来自 cron 的错误消息，指出该文件不可执行。如果您以 root 身份登录，您应该能够阅读该消息。

最简单的可能更改可能是将您的 crontab 更改为

```
30 7 * * * php /var/www/html/qars-vm90/demo.php 
```

还值得记住的是，cron 的环境通常与您在命令行中获得的环境略有不同（登录 shell 等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:24:14.980

没有足够的信息来回答你的问题。php 脚本从哪里获取电子邮件地址？它以什么用户正常运行，它以什么用户身份从 cron 运行？

# mysql - MYSQL 选择本周

> ID：16071934
> 
> 赞同：0
> 
> 时间：2013-04-17T23:22:43.520
> 
> 标签：mysql

我希望用户可以在本周之前看到他们上传的图片。

这个对吗？

```
"SELECT * 
FROM images 
WHERE userid = '$userid' 
  AND uploadeddate >= DATEPART(week, uploadeddate) = DATEPART(week, GETDATE()) 
ORDER BY uploadeddate DESC"; 
```

我收到错误。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:28:18.447

```
SELECT  *
FROM    images
WHERE   userid = $userid
        AND uploadeddate >= CURDATE() - INTERVAL WEEKDAY(day) DAY
        AND uploadeddate < CURDATE() - INTERVAL WEEKDAY(day) DAY + INTERVAL 7 DAY 
```

为此创建一个索引以`(userid, uploadeddate)`使其快速工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:25:32.830

以下查询将返回*本周*的记录。在`SELECT`.

如果您使用的是 SQL Server：

```
SELECT ... WHERE DATEPART(week, uploadeddate) = DATEPART(week, GETDATE()) 
```

如果您使用的是 MySQL：

```
SELECT ... WHERE WEEK(uploadeddate) = WEEK(CURDATE()) 
```

# android - 自定义视图在不在视图中时会丢失背景资源

> ID：16071936
> 
> 赞同：2
> 
> 时间：2013-04-17T23:22:47.450
> 
> 标签：android

因此，我要添加来自 AdMob 或 MAds 的广告，**或者**我有 MAds 插页式广告出现，然后在退出时，**或者**我触摸其中一个列表项，开始一个新活动，然后在活动结束时，有时候是这样的：

[http://i.imgur.com/Zq7vvkQ.png](http://i.imgur.com/Zq7vvkQ.png)

顶部项目没有正在绘制的背景资源，底部与此类似。这种情况有时会发生在中间的人身上（随着广告，他们都消失了）。

我想知道为什么会发生这种情况以及如何防止它......我在其他问题上能找到的最多的是在 ListView 上使用以下代码：

```
android:cacheColorHint="#00000000" 
```

或者

```
android:scrollingCache="false" 
```

背景资源正在自定义 ListAdapter 的 getView(int, View, ViewGroup) 方法中绘制。

任何帮助表示赞赏，

贾斯汀·W。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:29:12.553

要验证您的问题，请尝试运行`hierarchyviewer`，分析您的视图树并尝试找到潜在的解决方案。你用过层次结构查看器吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T01:29:15.283

所以，我有一些代码：

```
public View getView(int position, View convertView, ViewGroup parent) {
    if (convertView == null) {
        item = inflater.inflate(R.layout.griddler_menu_choice_item, parent, false);
    } else {

        item = convertView;
    }
            return item;

} 
```

基本上这是为了让它更高效，所以它不必继续创建视图，因为它的成本很高，但这以某种方式影响了最终结果......所以现在它可以工作了=）。

忘记添加如何解决这个问题......删除else部分和if一般，只需留下代码行：

```
 item = inflater.inflate(R.layout.griddler_menu_choice_item, parent, false); 
```

那为我修好了。

# java - 无法弄清楚 Java 字符串？

> ID：16071944
> 
> 赞同：1
> 
> 时间：2013-04-17T23:23:35.217
> 
> 标签：java

我现在是学生，所以我还在学习。我很快就学会了 VB，但另一方面，我很困惑它是简单的 Java。

这次给我的作业让我很困惑“写一个方法来确定两个字符串不同的位置数。例如，”Peace”和“Piece”在两个位置上不同。方法声明为int compare（String word1, String word2); 如果字符串相同，则该方法返回 0。如果两个字符串的长度不同，则返回 -1。"

附加“编写一个主要方法来测试该方法。主要方法应该告诉字符串有多少，位置不同，或者它们是相同的，或者如果它们是不同的长度，则说明长度。从控制台获取字符串。到目前为止这就是我所在的地方，如果可以的话，我正在寻找可以帮助我用 DUMDUM 术语解决这个问题的人，我不需要解决方案，只需要帮助理解它。

```
package arraysandstrings;
import java.util.Scanner;

public class differStrings {
    public static void main (String agrs[]){
        Scanner scanner = new Scanner (System.in);
        System.out.print("Enter a word");
        String word1;
        String word2;
        word1 = scanner.next();
        System.out.print("Enter another word");
        word2 = scanner.next();
        int count = 0;
        int length = word1.length();

        for(int x = 0; x >= length; x = x+1) {
            if (word1.charAt(x) == word2.charAt(x)) {
                count = count + 1;
                System.out.print (count);
            }
        }
    }
} 
```

附加问题

```
 package arraysandstrings;
   import java.util.Scanner;

 public class differStrings {
 public static void main (String agrs[]){
 Scanner scanner = new Scanner (System.in);
 System.out.println("Enter a word");
 String word1 = scanner.next();

System.out.println("Enter another word");
String word2 = scanner.next();
int count = 0;
int word1Length = word1.length();
int word2Length = word2.length();

if (word1Length != word2Length) {
      System.out.println ("Words are a diffrent length");
      System.out.println (word1 + "Has" + word1.length() + " chars");
      System.out.println (word2 + "Has" + word2.length() + " chars");
}

for(int x = 0; x < word1Length; x = x+1) {

       if (word1.charAt(x) != word2.charAt(x)) {
        count = count + 1;
       }}}

 System.out.println (count+" different chars"); 
```

}

在实施了从您的回复中获得的知识后，我遇到了最后一行的问题：

```
 System.out.println (count+" different chars"); 
```

它说错误预期但是在我添加我的作业的下一部分之前它起作用了：

```
 if (word1Length != word2Length) {
      System.out.println ("Words are a diffrent length");
      System.out.println (word1 + "Has" + word1.length() + " chars");
      System.out.println (word2 + "Has" + word2.length() + " chars");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:24:54.507

```
for(int x = 0; x >= length; x = x+1) { 
```

你大概是说

```
for(int x = 0; x < length; x = x+1) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:39:20.750

您需要的是一个循环，它比较两个字符串并计算它们不相等的位置。

您的逻辑计算两个字符相同的位置的数量。每次两个字符相等时，您也会打印计数。

听起来您需要的是一个循环，该循环遍历两个字符串中的字符，比较每个字符并增加不匹配或不同字符的计数。然后通过比较所有字符获得不同字符的计数后，您将打印出不同字符的计数。

所以基础是：（1）读取每个字符串，（2）检查长度是否相同，（3）如果长度相同，则遍历字符串比较每个字符并增加每个不匹配字符的计数时间有差异，（4）打印出计数。如果字符串长度不同，则只需将计数设置为负一 (-1)，无需费心比较两个字符串。

最好的做法是创建一个下划线和星号组成的字符串，其中每个匹配的字符位置用下划线表示，每个不匹配的字符位置用星号表示，或者字符串可能包含所有匹配的字符和不匹配的字符将被星号替换。

**编辑：添加示例程序**

下面的示例是您的程序的注释重写。我所做的一项更改是使用一个函数来执行不匹配字符的计数。该函数`countNonMatchChars ()`是一个静态函数，以解决 Java 的面向对象特性。此函数是实用程序类型函数，并不是真正的类的一部分。任何想要使用它的人都应该可以使用它。

此外，不是使用 I 的语法递增变量，`var = var + 1;`而是使用 ++ 的后递增运算符，如 in `var++;`。

```
package arraysandstrings;
import java.util.Scanner;

public class so_strings_main {

    // function to compare two strings and count the number
    // of characters that do not match.
    //
    // this function returns an integer indicating the number
    // of characters that did not match or a negative one if the
    // strings are not equal in length.
    //
    // "john"  "john"   returns 0
    // "john1" "john2"  returns 1
    // "mary1" "john1"  returns 4
    // "john"  "john1"  returns -1 (lengths are not equal)
    public static int countNonMatchChars (String s1, String s2)
    {
        // initialize the count to negative one indicating strings unequal in length
        // get the lengths of the two strings to see if any comparison is needed
        int count = -1;
        int word1Length = s1.length();
        int word2Length = s2.length();

        if (word1Length == word2Length) {
            // the lengths of the two strings are equal so we now do our comparison
            // we start count off at zero.  as we find unmatched characters, we
            // will increment our count.  if no unmatched characters found then
            // we will return a count of zero.
            count = 0;
            for(int iLoop = 0; iLoop < word1Length; iLoop++) {
                if (s1.charAt(iLoop) != s2.charAt(iLoop)) {
                    // the characters at this position in the string do not match
                    // increment our count of non-matching characters
                    count++;
                }
            }
        }
        // return the count of non-matching characters we have found.
        return count;
    }

    public static void main (String agrs[]){
        Scanner scanner = new Scanner (System.in);
        System.out.println("Count non-matching characters in two strings.");
        System.out.println("Enter first word");
        String word1 = scanner.next();

        System.out.println("Enter second word");
        String word2 = scanner.next();
        int count = countNonMatchChars (word1, word2);

        if (count < 0) {
            System.out.println ("Words are a diffrent length");
            System.out.println ("   " + word1 + " Has " + word1.length() + " chars");
            System.out.println ("   " + word2 + " Has " + word2.length() + " chars");
        } else {
            System.out.println (count + " different chars");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T23:39:38.630

移动一些代码，添加一些换行符并对逻辑进行 2 次小调整，从而生成一个更接近您要构建的程序的程序。

```
package arraysandstrings;
import java.util.Scanner;

public class differStrings {
  public static void main (String agrs[]){
    Scanner scanner = new Scanner (System.in);
    System.out.println("Enter a word");
    String word1 = scanner.next();
    System.out.println("Enter another word");
    String word2 = scanner.next();
    int count = 0;
    int length = word1.length();

    for(int x = 0; x < length; x = x+1) {
        if (word1.charAt(x) != word2.charAt(x)) {
            count = count + 1;
        }
    }
    System.out.println (count+" different chars");
  }
} 
```

除了@LouisWasserman 指出的 for 循环之外，您还有试图查找相同字符的代码。

# android - 为什么我的应用程序的 Android 更新会删除信息？

> ID：16071948
> 
> 赞同：2
> 
> 时间：2013-04-17T23:23:48.493
> 
> 标签：android, storage

在我的应用程序中，我在下面的代码中有一个与 FileOutputStream 一起存储的对象列表。此外，我的应用程序中的任何设置都与 SharedPreferences 一起存储。每当我第一次在 Google Play 商店上更新我的应用程序时（对于那些不熟悉该过程的人，我会上传新的 APK），所有使用该应用程序的人都会删除所有对象，并且所有设置都设置为默认值。为什么这样做？我怎样才能将对象存储在更新后不会消失的地方？

```
public ObjectStorage readListFromFile()
{
    ObjectStorage temp = null;
    String filename = "storefileobj";
    FileInputStream fis;
    try {
        fis = getActivity().openFileInput(filename);
        ObjectInputStream is = new ObjectInputStream(fis);
        temp = (ObjectStorage) is.readObject();
        is.close();
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (StreamCorruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (ClassNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return temp;
}

public void updateStorage()
{

    String filename = "storefileobj";
    FileOutputStream fos;
    try {
        fos = getActivity().openFileOutput(filename, Context.MODE_PRIVATE);
        ObjectOutputStream os = new ObjectOutputStream(fos);
        os.writeObject(mainObjectList);
        os.close();
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:46:08.110

对于正常更新，您的用户不会丢失这些值。

我相信每个丢失存储`SharedPreference`和保存文件数据的用户都被迫删除他们的旧应用程序，以便从 Play 商店安装新应用程序。否则，您的某些密钥或文件格式必须已更改。

**签名**：

您当然使用了 Android 的[Signing Your Applications](http://developer.android.com/tools/publishing/app-signing.html)文档以便在 Play 商店进行更新，但可能有问题的用户使用的是使用您单独交付给他们的不同签名（例如调试模式签名）签名的应用程序。这可以解释为什么他们在 Play 商店更新之前被迫卸载，从而删除了所有保存的信息。

**数据格式**：

另一种选择可能是`Keys`用于更改的`SharedPreference`值*或*更改的文件格式或类结构`ObjectStorage`，从而无法读取旧值。这对用户来说似乎旧值消失了。然后，随着用户以新格式保存值，您的应用程序将继续为他们正常工作。

**摘要**：

必须发生以下情况之一：

1.  您的用户在重新安装之前已删除。或者，
2.  您存储的数据格式在版本之间发生了变化。

# java - 在类之间传递一个数组......卡住了

> ID：16071957
> 
> 赞同：0
> 
> 时间：2013-04-17T23:24:19.333
> 
> 标签：java, arrays

我有三个正在使用的 java 文件，我似乎无法打印我的数组。我尝试了各种各样的事情，似乎我在绕圈子。我对如何使用不同类的数组感到困惑。预先感谢您的任何帮助。

这里是主要的：

```
 public class Main {

/**
 * @param args
 */
public static void main(String[] args) {
     TestInteger TI = new TestInteger();
     TestDouble TD = new TestDouble();
     Distance TDist = new Distance();
     mainMenu();
}
     public static void mainMenu() {
            int option;
            Scanner sc = new Scanner(System.in);

            while(true){
                System.out.println("Please choose what type of numbers will be stored in the Array");
                System.out.println();
                System.out.println("******* MAIN MENU ********");
                System.out.println("** 1\. Integers          **");
                System.out.println("** 2\. Double            **");
                System.out.println("** 3\. Distance          **");
                System.out.println("** 4\. Exit              **");
                System.out.println("**************************");

                try{
                    option = sc.nextInt();

                    switch (option) {
                    case 1: {

                        TestInteger.arrayMenu();
                    }
                    case 2: {

                        TestDouble.arrayMenu();
                    }
                    case 3: {

                        Distance.arrayMenu();
                    }

                    case 4: {
                        System.out.println("Exiting Program");
                        System.exit(0);
                    }

                    default: {
                        System.out.println();
                        System.out.println("Invalid option. Please select option" + " 1 - 4");
                        System.out.println();

                        mainMenu();
                    }
                    }
                }catch(InputMismatchException e){
                    System.out.println("Enter only 1-4");
                    sc.nextLine();
                }
            }
        }

} 
```

SortedArray 类应该包含一个已排序的对象数组以及与 SortedArray 一起使用的所有方法。

```
 import java.util.Arrays;

   public class SortedArray implements Comparable {

//private int[] sa;

//public SortedArray(int i, int j) {
    // TODO Auto-generated constructor stub
//}

public void constructor() {
    final int initialSize = 5;
    int incrementAmount = 3;
    int top = -1;

    Comparable [] sa = new Comparable[initialSize];
    //for(int i=0; i<5;++i){
    //  SortedArray sa = new SortedArray();
    //}
    top = -1; //shows the last item of the array
}

public int appropriatePosition(){
    int ap = 0;
    return ap;
}

public int smallest(){
    int smallest = 0;
    System.out.println("The smallest is ");
    return smallest;
}

public int largest(){
    int largest = 0;
    System.out.println("The largest is ");
    return largest;

}

public void insert(int i){
    int pos = 0;

    pos++;
}

public void find(){

}

public void delete(){

}

public Comparable[] print(){
    Comparable[] sa = {2,3,4,5};
    System.out.println(sa);
    return sa;
}

public void clear(){
    System.out.println("Now Clearing the Array....................................");
    // Arrays.fill(sa, null);

}

public boolean full(){
    boolean full = false;
    return full;
}

public boolean empty(){
    boolean empty = false;
    return empty;
}

@Override
public int compareTo(Object arg0) {
    // TODO Auto-generated method stub
    return 0;
} 
```

TestInteger 类仅用于将整数插入数组，然后以不同的方式操作数组。

```
 import java.util.Arrays;
 import java.util.InputMismatchException;
 import java.util.Scanner;

public class TestInteger implements Comparable{

/**
 * This is the User Interface for manipulating the sorted array
 */

    static SortedArray sa = new SortedArray (5,3);

    public static void arrayMenu() {

        int option;

        while(true){
            System.out.println();
            System.out.println("**** Integer Array Menu ****");
            System.out.println("****************************");
            System.out.println("** 1\. Insert              **");
            System.out.println("** 2\. Delete              **");
            System.out.println("** 3\. Clear               **");
            System.out.println("** 4\. Smallest            **");
            System.out.println("** 5\. Largest             **");
            System.out.println("** 6\. Return to Main Menu **");
            System.out.println("****************************");

            Scanner sc = new Scanner(System.in);
        try{

            option = sc.nextInt();
            switch (option){
            case 1:{
                try{
                    System.out.println("Type an integer to insert: ");
                    int x = sc.nextInt();
                    int index = 0;
                    sa.insert(x);
                    sa.print();
                }catch(InputMismatchException e){
                    System.out.println("Enter only integers");
                    sc.nextLine();
                }
                arrayMenu();
            }
            case 2:{
                try{
                    System.out.println("Type the index of the item you wish to delete:");
                    int d = sc.nextInt();
                }catch(InputMismatchException e){
                    System.out.println("Enter only integers");
                    sc.nextLine();
                }
                arrayMenu();
            }
            case 3:{
                System.out.println("Before clearing");
                sa.print();
                sa.clear();
                System.out.println("After clearing");

                sa.print();
                arrayMenu();
            }
            case 4:{
                sa.smallest();
                arrayMenu();
            }
            case 5:{
                sa.largest();
                arrayMenu();
            }
            case 6:{
                Main.mainMenu();
            }
            default: {
                System.out.println();
                System.out.println("Invalid option. Please select option 1 - 6");
                System.out.println();

                arrayMenu();
            }
            }
        }catch(InputMismatchException e){
            System.out.println("Enter only 1-6");
            sc.nextLine();
            }

        }
}

    @Override
    public int compareTo(Object o) {
        // TODO Auto-generated method stub
        return 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:35:34.850

请注意，您的 SortedArray 类没有实际状态。java中的东西只存在于包围它们的大括号内。我假设你的意思是你的构造函数是：

```
public void SortedArray(int initialSize, int incrementAmount) {
    final int initialSize = 5;
    int incrementAmount = 3;
    int top = -1;
    Comparable [] sa = new Comparable[initialSize];
    top = -1; //shows the last item of the array
} 
```

构造函数总是共享类的名称。您的代码默认为无参数的空构造函数。

但它应该更像这样：

```
private int incrementAmount;
private int top;
private Comparable[] sa;
public void SortedArray(int initialSize, int incrementAmount){
  this.initialSize = initialSize;
  this.incrementAmount = incrementAmount;
  this.top = -1
  this.sa = new Comparable[initialSize];
} 
```

将类视为“事物”的一种“蓝图”。字段是那个“东西”的属性和数据。构造函数是该“事物”的实例化，它实际上是根据某些参数烹饪作为类的配方的构造函数。

# opengl - 意外的投影

> ID：16071963
> 
> 赞同：0
> 
> 时间：2013-04-17T23:24:41.727
> 
> 标签：opengl

它应该是矩形的，它将占据整个窗口的宽度。我期待这一点，因为截锥体宽度为 -5 到 5，矩形大小为 10x10，矩形位于同一 z 轴位置，如截锥体平面附近。结果非常小，看起来不像一个矩形，我不知道为什么？

```
void GLWidget::initializeGL() {

    glClearColor(1.0f, 1.0f, 1.0f, 0.0f);
}

void GLWidget::resizeGL(int w, int h) {

    glViewport(0,0, w, h);
    glMatrixMode(GL_PROJECTION);
    double ratio = (double)w/(double)h;
    double size = ((10.0/ratio)/2.0);
    glFrustum(-5.0, 5.0, -size, size, 10.0, 50.0);

}

void GLWidget::paintGL() {

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glTranslatef(0.0f, 0.0f, -10.0f);

    glColor3f(0.0f, 0.0f, 0.0f);
    glBegin(GL_QUADS);
    glVertex3f(5.0f, -5.0f, 0.0f);
    glVertex3f(5.0f, 5.0f, 0.0f);
    glVertex3f(-5.0f, 5.0f, 0.0f);
    glVertex3f(-5.0f, -5.0f, 0.0f);
    glEnd();

    glFlush();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T09:51:04.880

> 它应该是矩形的，它将占据整个窗口的宽度。

好吧，然后将您的投影切换到更适合的投影，即正射投影，以完成绘制矩形时的任务。此外，您必须在应用平截头体或正交之前将投影矩阵重置为恒等。

提示：你的所有代码都`resizeGL`应该进入`paintGL`方法。我看到您正在使用 Qt，因此您可以使用`width`和`height`getter 函数方便地获取小部件的宽度和高度。也`glClearColor`进入`painGL`：

```
void GLWidget::initializeGL() {
}

void GLWidget::resizeGL(int w, int h) {

}

void GLWidget::paintGL()
{
    double const ratio = (double)width()/(double)height();
    double const size = ((10.0/ratio)/2.0);

    glClearColor(1.0f, 1.0f, 1.0f, 0.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glViewport(0,0, width(), height());
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glFrustum(-5.0, 5.0, -size, size, 10.0, 50.0);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glTranslatef(0.0f, 0.0f, -10.0f);

    draw_perspective_stuff();

    glViewport(0,0, width(), height());
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    // using identity projection, this fills the viewport
    glColor3f(0.0f, 0.0f, 0.0f);
    glBegin(GL_QUADS);
    glVertex3f(-1.f, -1.f, 0.0f);
    glVertex3f( 1.f, -1.f, 0.0f);
    glVertex3f( 1.f,  1.f, 0.0f);
    glVertex3f(-1.f,  1.f, 0.0f);
    glEnd();

    glFlush();
} 
```

# c - 在文件的不同行上附加字符串？

> ID：16071964
> 
> 赞同：1
> 
> 时间：2013-04-17T23:24:48.303
> 
> 标签：c, file, printf

我正在学习C，我有一个问题。我正在尝试将字符串附加到文件中。但是，每次附加一个字符串时，它都必须在下一行（有点像 println 而不是 print）。

我无法将函数追加到下一行。相反，它只是不断地追加在同一行。我该怎么做呢？

```
void FileWriter(char *cmmd)
 {
    FILE *fp;
    fp = fopen("xxx.txt", "a");

    fprintf(fp, "%s", cmmd);
    fclose(fp);
 } 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:25:47.420

说这个：

```
fprintf(fp, "%s\n", cmmd);
//             ^^ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:27:53.597

对不起，我很笨。我在 %s 之后放了一个 \n 并且它起作用了。也许有更好的方法？

# jquery - jQuery 循环插件在 ASP.NET MVC 4 中不起作用

> ID：16071966
> 
> 赞同：-1
> 
> 时间：2013-04-17T23:25:00.727
> 
> 标签：jquery, asp.net-mvc-4, jquery-cycle

我刚刚默认创建了 ASP .NET MVC4 项目，并从[这个](http://jquery.malsup.com/cycle/basic.html)示例中放置了一些代码，但它根本不工作。

有什么线索吗？

错误：

> Uncaught ReferenceError: jQuery is not defined jquery.cycle.all.latest.js:918 Uncaught ReferenceError: $ is not defined

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title - My ASP.NET MVC Application</title>
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta name="viewport" content="width=device-width" />
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")

    <style type="text/css">
        .slideshow {
            height: 232px;
            width: 232px;
            margin: auto;
        }

            .slideshow img {
                padding: 15px;
                border: 1px solid #ccc;
                background-color: #eee;
            }
    </style>

    <script type="text/javascript" src="http://cloud.github.com/downloads/malsup/cycle/jquery.cycle.all.latest.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $('.slideshow').cycle({
                fx: 'fade' // choose your transition type, ex: fade, scrollUp, shuffle, etc...
            });
        });
    </script>

</head>
<body>
    <header>
        <div class="content-wrapper">
            <div class="float-left">
                <p class="site-title">@Html.ActionLink("your logo here", "Index", "Home")</p>
            </div>
            <div class="float-right">
                <section id="login">
                    @Html.Partial("_LoginPartial")
                </section>
                <nav>
                    <ul id="menu">
                        <li>@Html.ActionLink("Home", "Index", "Home")</li>
                        <li>@Html.ActionLink("About", "About", "Home")</li>
                        <li>@Html.ActionLink("Contact", "Contact", "Home")</li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    <div id="body">
        @RenderSection("featured", required: false)
        <section class="content-wrapper main-content clear-fix">
            @RenderBody()
        </section>
    </div>
    <footer>
        <div class="content-wrapper">
            <div class="float-left">
                <p>&copy; @DateTime.Now.Year - My ASP.NET MVC Application</p>
            </div>
        </div>
    </footer>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:28:55.697

看起来您没有包含 jQuery 库。您需要将此添加到您的`<head>`部分：

```
<!-- include jQuery library -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script> 
```

# php - 如何使用 CakePHP 从外部源接收 GET 请求

> ID：16071972
> 
> 赞同：0
> 
> 时间：2013-04-17T23:25:11.203
> 
> 标签：php, cakephp

我正在开发一个项目，该项目允许外部用户（来自其他来源，而不仅仅是我的服务器）向我服务器上的页面发出 GET 请求，然后返回一些 JSON 编码数据。

例如，假设数据（不使用 Cake，只是标准 PHP）将被发送到

```
wwww.example.com/handlerequest.php 
```

我只是有类似的东西

```
if(isset($_GET['userRequest'])){
    //do some stuff
    echo $json_encoded_stuff;
} 
```

使用 CakePHP，我只需将数据发布到类似

```
www.example.com/HandleRequest 
```

但是，我**不想**/不需要对此的看法，因为没有什么可看的。此页面纯粹用于数据交换。考虑到这一点，我需要做些什么特别的事情才能让 Cake 不会因为期待相应的视图而引发错误？这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:28:17.080

通过在控制器操作中添加以下行，可以很容易地禁用 CakePHP 中的布局和视图：

```
$this->autoRender = false; 
```

如果您只想禁用布局，请在控制器操作中使用以下行：

```
$this->layout = false; 
```

如果您只想禁用此操作的视图，请在控制器中使用以下行：

```
$this->render(false); 
```

请注意，在您的控制器操作中使用`$this->layout = false;`和`$this->render(false);`一起将给您相同的结果`$this->autoRender = false;`

# mysql - 从 csv 导入 MySQL 时缺少 int 值

> ID：16071976
> 
> 赞同：0
> 
> 时间：2013-04-17T23:25:32.587
> 
> 标签：mysql, sql, database, csv

我目前正在构建一个数据库，用于帮助学生制定课程表。我已经“成功”地使用 csv 文件导入了三列中的两列，但是在导入这些类所在字段的 ID 号时遇到了问题。我认为这与作为 int 文件的 ID 有关，因为其他两列是 varchar。但是将列设置为 int 使我的项目的其余部分变得非常容易......

csv 文件的一小部分内容如下：

```
1,AFAM,2000
1,AFAM,3150
1,PSYC,3150
1,AFAM,3880
1,AFAM,4200
2,POLS,4200
2,AFAM,4490
2,AFAM,6490
2,DRAM,4490
2,DRAM,6490
2,AFAM,4500 
```

然后我在 MySQL 中使用它：

```
LOAD DATA local INFILE 'Course_Requirements.csv' INTO TABLE Courses
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'; 
```

当我去`SELECT * FROM COURSES;`查看我的表时，它显示如下：

```
ID  |  ClassName  |  ClassNumber
    |  AFAM       |  2000
    |  AFAM       |  3150
    |  PSYC       |  3150
    |  AFAM       |  3880
    |  AFAM       |  4200
    |  POLS       |  4200
    |  AFAM       |  4490
    |  AFAM       |  6490
    |  DRAM       |  4490
    |  DRAM       |  6490
 2  |  AFAM       |  4500 
```

老实说，我不知道为什么没有显示ID...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:34:38.977

确保课程中的 ID 列不是主键或唯一的。如果不是，则不能有重复项。执行：

```
SHOW CREATE TABLE Courses 
```

并查看 ID 列的属性

# java - 是否有 Sonar、Findbugs 或 PMD 规则来检测 CodePro 检测到的这种可能的 NPE？

> ID：16071978
> 
> 赞同：2
> 
> 时间：2013-04-17T23:25:34.053
> 
> 标签：java, sonarqube, findbugs, pmd, codepro

假设我有一个这样的代码块：

```
Map<String, Object> mappy = 
    (Map<String, Object>)pExtraParameters.get(ServiceClientConstants.EXTRA_PARAMETERS);

if (pSSResponseBean!=null) {
    mappy.put(AddressResearchContext.CSI_RESPONSE_BEAN, (AddressNotFoundResponseBean)pSSResponseBean); // this line may  throw null pointer
} 
```

是否存在将“mappy”标记为可能为空的 Sonar、Findbugs 或 PMD 规则？显然 CodePro 标记了这一点，如果可能的话，我需要提供类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T05:32:18.803

问题是 FindBugs 将未注释的项目视为已注释，`@Nullable`这导致它忽略对它们的空性检查。您可以创建一个使用自定义注释 (modify ) 注释的空`java.util`包，但它将应用于该包中*每个*类中的*每个*方法。`@ReturnValuesAreCheckForNullByDefault`[`@ReturnValuesAreNonnullByDefault`](http://findbugs.sourceforge.net/api/edu/umd/cs/findbugs/annotations/ReturnValuesAreNonnullByDefault.html)

 **```
@ReturnValuesAreCheckForNullByDefault
package java.util;

import edu.umd.cs.findbugs.annotations.ReturnValuesAreCheckForNullByDefault; 
```

另一种选择是创建`Map`使用`@CheckForNull`注释的外观。

```
public class AnnotatedMap<K, E> implements Map<K, E>
{
    private final Map<K, E> wrapped;

    @CheckForNull
    public E get(K key) {
        return wrapped.get(key);
    }
    ...
} 
```

**更新：**有关实施此建议的完整详细信息，请参阅我[之前](https://stackoverflow.com/a/14206379/285873)对类似问题的回答。**

# c++ - 用于桌面 VR 的 OpenGL 非对称截锥体

> ID：16071984
> 
> 赞同：4
> 
> 时间：2013-04-17T23:26:00.530
> 
> 标签：c++, opengl, frustum, virtual-reality

我正在制作一个 OpenGL c++ 应用程序来跟踪用户相对于屏幕的位置，然后将渲染场景更新为用户的视角。这被称为“桌面 VR”，或者您可以将屏幕视为立体模型或鱼缸。我对 OpenGL 相当陌生，到目前为止只定义了一个非常简单的场景，只是一个立方体，并且最初是正确渲染的。

问题是当我开始移动并想要重新渲染立方体场景时，投影平面似乎被平移了，我看不到我认为我应该看到的内容。我想把这架飞机修好。如果我正在编写光线追踪器，我的窗口将始终是固定的，但我的眼睛可以随意移动。有人可以向我解释如何在让我的相机/眼睛在非原点坐标处徘徊的同时达到我想要的效果（固定观察窗）吗？

我发现的所有示例都要求相机/眼睛位于原点，但这在概念上对我来说并不方便。另外，因为这是一个“鱼缸”，我将我的 d_near 设置为 xy 平面，其中 z = 0。

在屏幕/世界空间中，我将屏幕中心分配给 (0,0,0) 并将其 4 个角分配给：TL(-44.25, 25, 0) TR( 44.25, 25, 0) BR( 44.25,-25 , 0) BL(-44.25,-25, 0) 对于 16x9 显示器，这些值以厘米为单位。

然后，我使用 POSIT 计算用户的眼睛（实际上是我脸上的网络摄像头），通常在 (+/-40, +/-40, 40-250) 的范围内。我的 POSIT 方法是准确的。

我正在为透视和查看变换以及使用着色器定义自己的矩阵。

我初始化如下：

```
float right = 44.25;
float left = -44.25;
float top = 25.00;
float bottom = -25.00; 

vec3 eye = vec3(0.0, 0.0, 100.0);
vec3 view_dir = vec3(0.0, 0.0, -1.0);
vec3 up = vec3(0.0, 1.0, 0.0);
vec3 n = normalize(-view_dir);
vec3 u = normalize(cross(up, n)); 
vec3 v = normalize(cross(n, u));

float d_x = -(dot(eye, u));
float d_y = -(dot(eye, v));
float d_z = -(dot(eye, n));

float d_near = eye.z;
float d_far = d_near + 50;

// perspective transform matrix
mat4 P = mat4((2.0*d_near)/(right-left ), 0, (right+left)/(right-left), 0, 
            0, (2.0*d_near)/(top-bottom), (top+bottom)/(top-bottom), 0,
            0, 0, -(d_far+d_near)/(d_far-d_near), -(2.0*d_far*d_near)/(d_far-d_near),
            0, 0, -1.0, 0);

// viewing transform matrix
mat4 V = mat4(u.x, u.y, u.z, d_x,
              v.x, v.y, v.z, d_y,
              n.x, n.y, n.z, d_z,
              0.0, 0.0, 0.0, 1.0);

mat4 MV = C * V;
//MV = V; 
```

根据我在网上收集的信息，我的 view_dir 及以上内容将保持不变。这意味着我只需要更新 d_near 和 d_far 以及 d_x、d_y 和 d_y？我在我的 glutIdleFunc(idle);

```
void idle (void) {  

    hBuffer->getFrame(hFrame);
    if (hFrame->goodH && hFrame->timeStamp != timeStamp) {
        timeStamp = hFrame->timeStamp;
        std::cout << "(" << hFrame->eye.x << ", " <<
                    hFrame->eye.y << ", " <<
                    hFrame->eye.z << ") \n";

        eye = vec3(hFrame->eye.x, hFrame->eye.y, hFrame->eye.z);

        d_near = eye.z;
        d_far = eye.z + 50;

        P = mat4((2.0*d_near)/(right-left), 0, (right+left)/(right-left), 0, 
                 0, (2.0*d_near)/(top-bottom), (top+bottom)/(top-bottom), 0,
                 0, 0, -(d_far+d_near)/(d_far-d_near), -(2.0*d_far*d_near)/(d_far-d_near),
                 0, 0, -1.0, 0);

        d_x = -(dot(eye, u));
        d_y = -(dot(eye, v));
        d_z = -(dot(eye, n));

        C = mat4(1.0, 0.0, 0.0, eye.x,
                 0.0, 1.0, 0.0, eye.y,
                 0.0, 0.0, 1.0, 0.0,
                 0.0, 0.0, 0.0, 1.0);

        V = mat4(u.x, u.y, u.z, d_x,
                 v.x, v.y, v.z, d_y,
                 n.x, n.y, n.z, d_z,
                 0.0, 0.0, 0.0, 1.0);

        MV = C * V;
        //MV = V;

        glutPostRedisplay();
    }
} 
```

这是我的着色器代码：

```
#version 150

uniform mat4 MV;
uniform mat4 P;
in vec4 vPosition;
in vec4 vColor;
out vec4 color;

void 
main() 
{ 
    gl_Position = P * MV * vPosition;
    color = vColor;
} 
```

好的，我对代码进行了一些更改，但没有成功。当我在顶点着色器中使用 V 代替 MV 时，一切看起来都如我所愿，透视正确且对象大小合适，但是，场景是通过相机的位移来平移的。

当使用 C 和 V 获得 MV 时，我的场景是从观察者的角度直接渲染的，渲染的场景会按应有的方式填充窗口，但眼睛/相机的视角会丢失。

真的，我想要的是通过眼睛/相机的适当 x 和 y 值来平移 2D 像素，投影平面，以便将对象的中心（其 xy 中心为（0,0））保持在渲染图像的中心。我以教科书“交互式计算机图形学：基于着色器的 OpenGL（第 6 版）的自顶向下方法”中的示例为指导。使用网络上免费提供的与本书配对的文件，我将继续使用行主要方法。

以下图像是在不使用矩阵 C 创建 MV 时拍摄的。当我确实使用 C 创建 MV 时，所有场景看起来都像下面的第一张图片。我不希望在 z 中进行翻译，所以我将其保留为 0。

因为投影平面和我的相机平面是平行的，所以从一个坐标系到另一个坐标系的转换只是简单的平移和inv(T) ~ -T。

这是我在 (0,0,50) 处的眼睛图像： ![这是我在 (0,0,50) 处的眼睛图像：](https://i.stack.imgur.com/bXQaS.png)

这是我在 (56,-16,50) 的眼睛图像： ![这是我在 (56,-16,50) 的眼睛图像：](https://i.stack.imgur.com/uLHgd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-21T19:33:19.903

解决方案是更新 d_x、d_y 和 d_z，考虑新的眼睛位置，但永远不要改变 u、v 或 n。此外，必须用左、右、上和下的新值更新矩阵 P，因为它们与相机/眼睛的新位置有关。

我用这个初始化：

```
float screen_right = 44.25;
float screen_left = -44.25;
float screen_top = 25.00;
float screen_bottom = -25.00; 
float screen_front = 0.0;
float screen_back = -150; 
```

现在我的空闲函数看起来像这样，注意顶部、底部、右侧和左侧的计算：

```
void idle (void) {  

hBuffer->getFrame(&hFrame);
if (hFrame.goodH && hFrame.timeStamp != timeStamp) {
    timeStamp = hFrame.timeStamp;
    //std::cout << "(" << hFrame.eye.x << ", " <<
    //                  hFrame.eye.y << ", " <<
    //                  hFrame.eye.z << ") \n";

    eye = vec3(hFrame.eye.x, hFrame.eye.y, hFrame.eye.z);

    d_near = eye.z;
    d_far = eye.z + abs(screen_back) + 1;

    float top = screen_top - eye.y;
    float bottom = top - 2*screen_top;
    float right = screen_right - eye.x;
    float left = right - 2*screen_right;

    P = mat4((2.0 * d_near)/(right - left ), 0.0, (right + left)/(right - left), 0.0, 
             0.0, (2.0 * d_near)/(top - bottom), (top + bottom)/(top - bottom), 0.0,
             0.0, 0.0, -(d_far + d_near)/(d_far - d_near), -(2.0 * d_far * d_near)/(d_far - d_near),
             0.0, 0.0, -1.0, 0.0);

    d_x = -(dot(eye, u));
    d_y = -(dot(eye, v));
    d_z = -(dot(eye, n));

    V = mat4(u.x, u.y, u.z, d_x,
             v.x, v.y, v.z, d_y,
             n.x, n.y, n.z, d_z,
             0.0, 0.0, 0.0, 1.0);

    glutPostRedisplay();
} 
```

}

透视矩阵的这种重新定义使渲染图像无法平移。我仍然有相机捕捉和屏幕抓取同步问题，但我能够创建如下图像，为用户的位置实时更新：

![在此处输入图像描述](https://i.stack.imgur.com/Bopu6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T09:18:03.737

> 我发现的所有示例都要求相机/眼睛位于原点

这不是要求。OpenGL 没有定义相机，这一切都归结为转换。这些通常称为投影和模型视图（模型和视图变换相结合）。相机，即视图变换只是相机在世界空间中的定位的倒数。所以说你为你的相机建立了一个矩阵`C`，然后你会在模型视图上预乘它的逆矩阵。

```
mat4 MV = inv(C) * V 
```

附带说明一下，您的着色器代码是错误的：

```
gl_Position = P * ( (V * vPosition ) / vPosition.w );
                                    ^^^^^^^^^^^^^^ 
```

同质划分*不是*在着色器中完成的，因为它是硬连线到渲染管道中的。

# python - 为什么当我尝试添加字段时 Django 会抛出“不存在”错误

> ID：16071985
> 
> 赞同：0
> 
> 时间：2013-04-17T23:26:05.807
> 
> 标签：python, django

目前我正在使用运行良好的默认管理门户。然后在models.py中我尝试添加一个字段，如下所示：

```
class MyModel(models.Model):
    # new field is 'info'
    info = models.CharField(max_length=100) 
```

MyModel 已经在上面的代码中成功定义和使用了，我只想添加一个字段。我重新运行同步

```
python manage.py syncdb
Creating tables ...
Installing custom SQL ...
Installing indexes ...
Installed 0 object(s) from 0 fixture(s) 
```

但是，当我尝试使用该界面时，Django 会引发错误

```
column myproject_mymodel.info does not exist 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:32:29.043

`manage.py syncdb`只会创建不存在的表，它不适用于添加或删除列，或修改列。

我建议阅读 Django Book（在线免费）的以下章节：
[第 10 章：高级模型](http://www.djangobook.com/en/2.0/chapter10.html)

以下是该章中给出的添加字段的步骤：

> 首先，在开发环境中执行这些步骤（即，不在生产服务器上）：
> 
> 1.  将该字段添加到您的模型中。
> 2.  运行`manage.py sqlall [yourapp]`以查看模型的新`CREATE TABLE`语句。请注意新字段的列定义。
> 3.  启动数据库的交互式外壳（例如，`psql`或`mysql`，或者您可以使用`manage.py dbshell`）。执行`ALTER TABLE`添加新列的语句。
> 4.  启动 Python 交互式 shell，`manage.py shell`并通过导入模型并从表中选择来验证新字段是否已正确添加（例如，`MyModel.objects.all()[:5]`）。如果您正确更新了数据库，则该语句应该可以正常工作。
> 
> 然后在生产服务器上执行以下步骤：
> 
> 1.  启动数据库的交互式 shell。
> 2.  执行`ALTER TABLE`您在开发环境步骤的第 3 步中使用的语句。
> 3.  将该字段添加到您的模型中。如果您正在使用源代码修订控制并且您在开发环境的第 1 步中签入了您的更改，那么现在是时候更新`svn update`生产服务器上的代码（例如，使用 Subversion）了。
> 4.  重新启动 Web 服务器以使代码更改生效。

# php - PHP preg_match 使用“或”分隔符

> ID：16071987
> 
> 赞同：0
> 
> 时间：2013-04-17T23:26:23.937
> 
> 标签：php, preg-match, delimiter

我正在尝试使用匹配某个 URL 字符串，`preg_match`但我需要匹配一个或另一个字符串，但我找不到正确的语法。

我现在使用的是：

```
$is_url_en = preg_match ("/\b95\b/i", $iframeurl); 
```

这将在 url 中搜索数字“95”。但是我也想匹配“en”，但我不知道如何使用“或”分隔符。我在某处看到了以下内容：

```
$is_url_en = preg_match ("/\b95\b/i|/\ben\b/i", $iframeurl); 
```

...但它不起作用。请问有什么提示吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T23:29:12.987

不要重复`/`and `/i`。那些分隔正则表达式，所以它们应该只存在一次。

```
$is_url_en = preg_match ("/\b95\b|\ben\b/i", $iframeurl); 
```

然后，您可以将其简化为：

```
$is_url_en = preg_match ("/\b(95|en)\b/i", $iframeurl); 
```

# sql - SQL Server 有没有办法绕过重复的条件行

> ID：16071993
> 
> 赞同：3
> 
> 时间：2013-04-17T23:27:08.640
> 
> 标签：sql, sql-server-2008

您好，我正在尝试清理查询，并且有一行重复了六次。有没有办法在 SQL 中设置类似常量的东西？

这是该问题的一个示例：

```
select Distinct DSF.CityName, 
( Select count (Distinct DSF1.IncdtKey)
  from dbo.IncidentFile DSF1 
  Where DSF1.IncidentMostSevere in ('1', '2', '4', '5', '6')
  and DSF1.CategoryKey in ('15', '01', '02', '03', '04', '05', '06')<-----
  and DSF1.CityName = DSF.CityName)  as 'Weapons Possession 11-12',
( Select count (Distinct DSF2.IncdtKey)
  from dbo.IncidentFile DSF2 
  Where DSF2.IncidentMostSevere in ('7', '8', '9', '10', '11', '12')
  and DSF2.CategoryKey in ('15', '01', '02', '03', '04', '05', '06') <-----
  and DSF2.CityName = DSF.CityName)  as 'Drugs Related 11-12',
( Select count (Distinct DSF3.IncdtKey)
  from dbo.IncidentFile DSF3 
  Where DSF3.IncidentMostSevere in ('14', '15', '17', '20', '21', '22', '26') 
  and DSF3.CategoryKey in ('15', '01', '02', '03', '04', '05', '06') <-----
  and DSF3.CityName = DSF.CityName)  as 'Incident with Injury 11-12',
( Select count (Distinct DSF4.IncdtKey)
  from dbo.IncidentFile DSF4 
  Where DSF4.IncidentMostSevere in ('16', '18', '19', '23', '24', '25')
  and DSF4.CategoryKey in ('15', '01', '02', '03', '04', '05', '06') <-----
  and DSF4.CityName = DSF.CityName)  as 'Incident no Injury 11-12',
( Select count (Distinct DSF5.IncdtKey)
  from dbo.IncidentFile DSF5 
  Where DSF5.IncidentMostSevere in ('3', '13', '29', '31', '32', '33')
 and DSF5.CategoryKey in ('15', '01', '02', '03', '04', '05', '06') <-----
 and DSF5.CityName = DSF.CityName)  as 'Other reason for 11-12',
( Select count (Distinct DSF6.IncdtKey)
  from dbo.IncidentFile DSF6 
  Where DSF6.CategoryKey in ('15', '01', '02', '03', '04', '05', '06') <-----
  and DSF6.CityName = DSF.CityName)  as 'Total Incidents'
  from dbo.IncidentFile DSF
group by DSF.CityName
Order by DSF.CityName 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T23:37:41.593

您应该能够使用 CTE，然后使用带有`CASE`表达式的聚合函数：

```
;with cte as
(
  select distinct CityName,
    IncidentMostSevere,
     IncdtKey
  from dbo.IncidentFile
  where CategoryKey in ('15', '01', '02', '03', '04', '05', '06')
)
select CityName,
  count(case 
        when IncidentMostSevere in ('1', '2', '4', '5', '6')
        then IncdtKey end) as 'Weapons Possession 11-12',
  count(case 
        when IncidentMostSevere in ('7', '8', '9', '10', '11', '12')
        then IncdtKey end) as 'Drugs Related 11-12',
  count(case 
        when IncidentMostSevere in ('14', '15', '17', '20', '21', '22', '26')
        then IncdtKey end) as 'Incident with Injury 11-12',
  count(case 
        when IncidentMostSevere in ('16', '18', '19', '23', '24', '25')
        then IncdtKey end) as 'Incident no Injury 11-12',
  count(case 
        when IncidentMostSevere in ('3', '13', '29', '31', '32', '33')
        then IncdtKey end) as 'Other reason for 11-12',
  count(case 
        when IncidentMostSevere in ('15', '01', '02', '03', '04', '05', '06')
        then IncdtKey end) as 'Total Incidents'
from cte
group by CityName
order by CityName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T23:50:44.207

这种方法通过将子查询移动到 from 子句并在 where 子句中添加一次类别列表来工作。

```
select 
  DSF.CityName, 
  Dsf1.cnt as 'Weapons Possession 11-12',
  Dsf2.cnt as 'Drugs Related 11-12',
  ...
  Dfsn.cnt as 'Total Incidents'

From
  dbo.IncidentFile DSF

  Inner join
  (
     Select 
       DSF.CategoryKey,
       DSF.CityName,
       count (Distinct DSF.IncdtKey) as cnt
     from 
       dbo.IncidentFile DSF
     Where
       DSF.IncidentMostSevere in ('1', '2', '4', '5', '6').  
     group by
       1, 2
   ) DSF1
   On  DSF1.CityName = DSF.CityName

   Inner join
   ( 
     Select 
       DSF.CategoryKey,
       DSF.CityName,
       count (Distinct DSF.IncdtKey) as cnt
     from 
       dbo.IncidentFile DSF
     Where
       DSF.IncidentMostSevere in ('7', '8', '9', '10', '11', '12') 
     group by
       1, 2
   ) DSF2
   On DSF2.CityName = DSF.CityName 

   ...

   Inner join
   ( 
     Select 
       DSF.CategoryKey,
       DSF.CityName,
       count (Distinct DSF.IncdtKey) as cnt
     from 
       dbo.IncidentFile DSF
     Where
       DSF.IncidentMostSevere in ('7', '8', '9', '10', '11', '12') 
     group by
       1, 2
   ) DSFn
   On dfsn.CityName = DSF.CityName   

 Where 
   dfsn.CategoryKey in ('15','01','02,'03','04','05','06')

 Order by DSF.CityName 
```

# sql - 如何通过关联记录的属性对 Rails 集合进行排序？

> ID：16071995
> 
> 赞同：0
> 
> 时间：2013-04-17T23:27:27.417
> 
> 标签：sql, ruby-on-rails, rails-activerecord, active-record-query

我有三个模型：教师、学生和作业

```
class Teacher < ActiveRecord::Base
  has_many :assignments
  has_many :students, through: assignments, uniq: true
end 
```

对于任何给定的老师，我想检索一个独特的学生列表 - 很简单，我只需调用：

```
teacher.students 
```

但是，我想根据最近提交作业的学生列表来排序。具体来说，我希望最近更新作业的学生首先出现，依此类推。

我被困在以下代码上，该代码不起作用：

```
teacher.students.group("assignments.student_id").order("MAX(assignments.updated_at) DESC") 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:19:20.203

看来我原来的查询是正确的：

```
teacher.students.group("assignments.student_id").order("MAX(assignments.updated_at) DESC") 
```

我曾认为它不起作用，因为我编写了一个糟糕的 RSpec 测试失败了，因为我没有很好地处理时间戳。一旦我使用[Timecop](https://github.com/travisjeffery/timecop)正确处理时间戳，测试就通过了。

对于那个很抱歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T04:26:33.037

没有真正测试过，但我相信

```
teacher.students.includes(:assignments).order('assignments.updated_at') 
```

应该管用

# php - 将填充`select`元素的函数与预先选择匹配db值的选项的函数结合起来

> ID：16071997
> 
> 赞同：0
> 
> 时间：2013-04-17T23:27:35.110
> 
> 标签：php, arrays

我想修改函数*checkSelectedOption*以便不必在每次调用数组时都对其进行硬编码。

第一个函数预先选择与数据库中的信息匹配的选项，但它使用硬编码数组来填充`select`元素。第二个函数从 db 值创建数组并动态填充`select`元素。如何将这两个功能结合起来，以便`select`动态填充元素，然后预先选择与数据库中的信息匹配的选项？

*函数 checkSelectedOption*使用数组“$options”中指定的值填充元素，然后预先选择与 db 的“customer_info”表中的信息匹配的选项。此函数当前需要对数组进行硬编码，我想用*函数 printSelectOptions*中的方法替换函数的这一部分，该方法使用从 db 值创建的数组。

*函数 printSelectOptions*`select`根据从数据库中获取的值填充元素。它通过使用从“form_fields”表中提取的列中的值创建一个数组来做到这一点。

*函数 checkSelectedOption*

```
function checkSelectedOption($dataArray, $currentSelection) {
    foreach ($dataArray as $key => $value) {
        echo '<option ' . (($key == $currentSelection) ? 'selected="selected"' : '') . ' value="' . $key . '">' . $value . '</option>';
    }
}
try {  
$stmt = $conn->prepare("SELECT * FROM customer_info WHERE user_id = :user_id");  
$stmt->bindValue(':user_id', $user_id); 
$stmt->execute();
} catch(PDOException $e) {
    echo $e->getMessage();
} 
$row = $stmt->fetch(); 
```

*调用函数*

```
<select name="first_name">
    <?php
    // Populates the element with values from array $options         
    $options = array("John"=>"John", "Robert"=>"Robert");
    $selected = $row['first_name'];
    echo checkSelectedOption($options, $selected);
    ?>
</select> 
```

*函数 printSelectOptions*

```
function printSelectOptions($dataArray, $currentSelection, $fieldname) {
    $output = '';
    foreach ($dataArray as $key => $value) {
    // Only add to array if row has value
    if ($value[$fieldname] !="" && $value[$fieldname] !="Null") {
            $output .= '<option ' . (($key == $currentSelection)) . ' value="' . $key . '">' . str_replace('_', ' ', $value[$fieldname]) . '</option>';
        }
    }
    return $output;
}
try {  
    $stmt = $conn->prepare("SELECT * FROM form_fields");  
    $stmt->execute();
} catch(PDOException $e) {
    echo $e->getMessage();
} 
$rows = $stmt->fetchAll(); 
```

*调用函数*

```
<select name="first_name">
    <?php 
    // Dynamically populates element with array created from column first_name
    echo printSelectOptions($rows, $currentSelection, 'first_name');
    ?>
</select> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T03:16:46.953

> @metal_fan，我不确定你指的是什么，你能详细说明一下吗？

我猜 600 个字符是不够的。

> 如何结合这两个功能，以便我可以动态填充选择元素，然后预先选择与数据库中的信息匹配的选项？

您必须获取所需的数据，然后将其与循环内的“内部”选择框的值进行比较（否则将是地狱）。

PHP 本身旨在用作模板引擎。这意味着，人们应该将它用作模板引擎——不要使用`print/echo`html 标签，而是注入 php “事物”。

你现在所做的一切都毫无意义。常见的解决方案是创建一个进行计算的辅助函数。

请记住，一个功能应该只执行一项任务。如果您有多个，请为每个创建一个函数。

**更新**
好吧，在您编辑之后，我现在更加困惑了。

```
// Assume that array we got from the table looks like:
$array = array('John' => 'John', 'Dave' => 'Dave', 'Jason' => 'Jason');

$__AGAINST__ = 'Jason'; // <-- VERY IMPORTANT

function is_selected($expected, $actual){

    if ( $expected === $actual ){

        print 'selected="selected"';
    }
}

?>

<select>

    <?php foreach($array as $key => $val):?>

    <option value="<?php echo $key; ?>" <?php is_selected($key, $__AGAINST__); ?>><?php echo $val; ?></option>

    <?php endforeach; ?>

</select> 
```

`$__AGAINST__`你会从配置或类似的东西中获取。这就是你要比较的东西。

现在替换`$__AGAINST__ = 'Jason';`为`$__AGAINST__ = 'Dave';`你看看它是如何工作的？核心思想是迭代`$array`并`$key`与某些东西进行比较。而已。

**更新 2**

我想你知道“选择反对”是如何工作的。但是您根本不明白我告诉您的内容:( 看看这个：

```
$output .= '<option ' . is_selected($key, $__AGAINST__) . ' value="' . $key . '">' . str_replace('_', ' ', $value[$fieldname]) . '</option>'; 
```

你一次又一次地犯同样的错误。**PHP 本身旨在用作模板引擎**。您应该避免`printing/echoing` *使用 HTML 标签*。为什么？如果您决定`select`用另一个元素（比如 Jquery ComboBox 插件）替换它怎么办。那会发生什么？您将不得不重新考虑“生成”逻辑本身以及演示文稿。听起来很糟糕。为什么听起来很糟糕？这是因为表示应该与应用程序/生成逻辑完全分离。为什么要解耦？灵活性，可维护性会回答这个问题，我猜。

**让你的模板尽可能的愚蠢**他们不应该**直接**做任何计算。如果您想在 HTML 模板中计算某些内容，请在*bootstrap.php*（或类似文件）中的某处定义一个函数，而不是在标记本身中定义一个函数。

*PHP 旨在用作模板引擎*。**但它的真正含义是什么？**

这意味着（我们不在 Perl/Python 中），您应该始终避免使用这样的代码：

```
$ouptut = '<option>' . $foo . '</option>';
echo '<table>';
echo '<tr>';
echo '<td>' . $bad . '</td>';
echo '</tr>'; 
```

但改为这样写：

```
<select>
  <option><?php echo $foo; ?></option>
</select> 
```

牢记这一点，您将使您的 HTML 内容与 PHP 解析器完全分离。这对未来的维护非常有用。