# StackOverflow 问答 12976000-12976999

# c# - {“无法从程序集 'Pipeline, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' 加载类型 'VBR.Pipeline.Domain.ExpertGuide'。”

> ID：12976001
> 
> 赞同：0
> 
> 时间：2012-10-19T14:06:21.327
> 
> 标签：c#, nhibernate

我有一个使用 NHibernate 的应用程序，我的所有类和映射都可以正常工作，并且我可以毫无问题地检索数据，直到我决定在数据库中添加一个新表（以及新类，代码中的映射）。

我不断收到在程序集中找不到我的班级的错误。

My Class 叫做 ExpertGuide，映射文件 ExpertGuide.hbm.xml（已经是嵌入式资源）

我对项目进行了清理、重建等工作，但什么也没有。

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T14:07:13.603

问题是我班级的命名空间，我有 Pipeline.Domain 而不是 VBR.Pipeline.Domain 所以找不到我的班级

# mysql - Mysql：如果另一行上的数据等于当前行上的数据，则为上一行数据

> ID：12976002
> 
> 赞同：0
> 
> 时间：2012-10-19T14:06:23.277
> 
> 标签：mysql

所以我有以下会员历史表

```
User_ID  |  Start date  |  End Date  |  Type(0-7) |  
--------------------------------------------------
    2    |   date1      |  date2     |    0       |  
--------------------------------------------------
    2    |   date3      |  date4     |    3       |  
--------------------------------------------------
    2    |   date5      |  date6     |    3       |  
--------------------------------------------------
    2    |   date7      |  date8     |    1       |  
--------------------------------------------------
    3    |   date9      |  date10    |    6       |  
--------------------------------------------------
    3    |   date11     |  date12    |    0       |  
-------------------------------------------------- 
```

我正在尝试使用结果创建 mysql 查询：

```
 User_ID  |  Start date  |  End Date  |  Type(0-7) |PrevEnd-CurStart| Prevtype    
    ----------------------------------------------------------------------------------
        2    |   date1      |  date2     |    0       |  null OR 0     | null OR 0
    ----------------------------------------------------------------------------------
        2    |   date3      |  date4     |    3       |  Date3-Date2   |  0
    ----------------------------------------------------------------------------------
        2    |   date5      |  date6     |    3       |  Date5-Date4   |  3
    ----------------------------------------------------------------------------------
        2    |   date7      |  date8     |    1       |  Date7-Date6   |  3
    ----------------------------------------------------------------------------------
        3    |   date9      |  date10    |    6       |  null Or 0     |  null OR 0
    ----------------------------------------------------------------------------------
        3    |   date11     |  date12    |    0       |  Date11-Date10 |  6
    ---------------------------------------------------------------------------------- 
```

我输入 Null 或 0 因为从那时起我可以使用它

我将如何为此编写 mysql 查询？这只是我需要的报告的子查询，昨天，昨晚和今天，我整天都被困在上面。非常感谢您的帮助。运行时间无关紧要，因为我每月只需要运行一次。

编辑：要获得我当前的输出，我使用以下内容。'group by 1,2,3,4' 是因为我需要删除很多重复项

```
select 
 mh.account_id, 
 mh.start_date, 
 mh.end_date, 
 mh.`type`
from tbl_membership_history mh join tbl_membership m on mh.account_id=m.account_id
group by 1,2,3,4
order by 1,2,3,4
limit 100 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:41:43.280

您可以使用较早的记录在表上进行自联接，然后聚合以查找这些较早记录的最新结束日期（给出前一个结束日期）。然后必须再次将该结果连接到表中，以便找到`Type`前一条记录的：

```
SELECT   res.*, prv.Type AS prvType
FROM (
  SELECT   cur.*, MAX(bef.endDate) AS prvEnd
  FROM     history AS cur LEFT JOIN history AS bef
        ON bef.User_ID = cur.User_ID AND bef.endDate <= cur.startDate
  GROUP BY cur.User_ID, cur.startDate, cur.endDate, cur.Type
) res LEFT JOIN history AS prv
        ON prv.User_ID = res.User_ID AND prv.endDate = res.prvEnd 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/4b15d/1/0)上查看。

# python - 在 Sublime Text 2 插件中访问快速面板

> ID：12976008
> 
> 赞同：6
> 
> 时间：2012-10-19T14:06:37.910
> 
> 标签：python, sublimetext2

我正在学习如何创建 Sublime Text 2 插件。我想做的一件事是获取任何突出显示的文本，检查网站是否会在该地址返回 200，然后将一些信息放入快速面板（是的，我知道我应该做 url在线程中查找，以免阻塞主 UI）。目前我有：

```
import sublime
import sublime_plugin
import urllib2

class CheckUrlPanel(sublime_plugin.WindowCommand):

def quick_panel(self, messages, flags):
    self.window.show_quick_panel(messages, None, flags)

class CheckUrlsCommand(sublime_plugin.TextCommand):

def run(self, edit):
    urls = []
    selections = self.view.sel()
    for selection in selections:
        urls.append(self.view.substr(selection))

    messages = self.validate_urls(urls)
    panel = CheckUrlPanel()
    panel.quick_panel(messages, sublime.MONOSPACE_FONT)

def validate_urls(self, urls):
    messages = []
    for url in urls:
        try:
            request = urllib2.Request(url, headers={ "User-Agent" : "Sublime URL Checker" }) 
            response = urllib2.urlopen(request, timeout=3)
            message = '"%s" is a valid URL.' % url
        except Exception as (e):
            message = '"%s" is an invalid URL.' % url

        messages.append(message)

    return messages 
```

我得到的错误是：

```
Traceback (most recent call last):
File "./sublime_plugin.py", line 362, in run_
File "./CheckUrls.py", line 19, in run
  panel = CheckUrlPanel()
  TypeError: __init__() takes exactly 2 arguments (1 given) 
```

问题是我不知道如何正确初始化 WindowCommand 类，而且我似乎找不到任何文档。任何帮助或提示将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-22T14:01:08.127

您不需要创建另一个实例`WindowCommand`来完成此操作。顺便说一句，您通常会编写命令，但不会在插件中创建它们的实例。它们通过键绑定或`run_command`View/Window/sublime 的方法实例化和调用。

您可以在`check_urls`命令处理程序中获取当前活动窗口并显示一个快速面板。

```
window = sublime.active_window()
window.show_quick_panel(messages, None, sublime.MONOSPACE_FONT) 
```

这是一个完整的来源：

```
import sublime
import sublime_plugin
import urllib
from urllib.request import urlopen

class CheckUrlsCommand(sublime_plugin.TextCommand):

   def run(self, edit):
      urls = []
      selections = self.view.sel()
      for selection in selections:
         urls.append(self.view.substr(selection))

      messages = self.validate_urls(urls)
      window = sublime.active_window()
      window.show_quick_panel(messages, None, sublime.MONOSPACE_FONT)

   def validate_urls(self, urls):
      messages = []
      for url in urls:
         try:                
            response = urlopen(request, timeout=3)
            message = '"%s" is a valid URL.' % url
         except Exception as e:
            message = '"%s" is an invalid URL.' % url

         messages.append(message)

      return messages 
```

# xml - Postgresql - XML 到字符串的转换问题

> ID：12976010
> 
> 赞同：0
> 
> 时间：2012-10-19T14:06:41.793
> 
> 标签：xml, postgresql

这是我的查询：

```
select XMLSERIALIZE(query_to_xml('select * from foo order by field1, field2 offset 1 limit 2', true, false,'') as character varying) 
```

我收到此错误：

```
ERREUR:  erreur de syntaxe sur ou près de « query_to_xml »
LINE 1: select XMLSERIALIZE(query_to_xml('select * from foo ord...
                        ^

********** Erreur **********

ERREUR: erreur de syntaxe sur ou près de « query_to_xml »
État SQL :42601
Caractère : 21 
```

从法语翻译成英语：
`erreur de syntaxe sur ou près de(...)`相当于`syntax error near(...)`

我究竟做错了什么 ？

**编辑：**
我也尝试了这两种语法，但没有运气：

> select XMLSERIALIZE(DOCUMENT query_to_xml('select * from foo ord
> select XMLSERIALIZE(CONTENT query_to_xml('select * from foo ord

**PostgreSQL 8.3**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T14:45:59.767

这是我如何解决我的问题。我没有说明铸造类型。

两种语法都有效：

> select XMLSERIALIZE(DOCUMENT query_to_xml('select * from foo order by 1', false, false,'') as **text** )
> 
> select XMLSERIALIZE(DOCUMENT query_to_xml('select * from foo order by 1', false, false,'') as **varchar** )

注意：我可以用 CONTENT 替换 DOCUMENT，它就像一个魅力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T16:48:27.397

```
select XMLSERIALIZE({ DOCUMENT | CONTENT } query_to_xml( 
```

# wcf-binding - wsDualHttpBinding 绑定 = 新的 wsDualHttpBinding()？

> ID：12976011
> 
> 赞同：0
> 
> 时间：2012-10-19T14:06:45.680
> 
> 标签：wcf-binding

我没有 Visual Studio，但我想托管一个带有代码的 wsDualHttpBinding 绑定。问题是我在编译时遇到错误：

> 错误 cs0246：找不到类型或命名空间名称 wsdualhttovinding（您是否缺少 using 指令或 assemvly 引用？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:09:29.283

您需要参考`System.ServiceModel`，如果这确实是确切的错误，您需要检查您的拼写`WSDualHttpBinding`

[WSDualHttpBinding 类](http://msdn.microsoft.com/en-us/library/system.servicemodel.wsdualhttpbinding.aspx)

# r - 如何在R中的列表组件上应用函数

> ID：12976012
> 
> 赞同：1
> 
> 时间：2012-10-19T14:06:49.890
> 
> 标签：r

我以为这将是微不足道的...

这是我列表的前两个组成部分：

```
foo <- structure(list(vv = structure(list(`0` = c("C RR", "G RR", "nil",
"C AA", "G AA", "nil", "C RV", "G RV", "nil", "C VB", "G VB",
"nil", "C RV", "C AA", "G AA", "nil", "G AA", "nil", "C VB",
"G VB", "nil", "C RJ"), `1` = c("G RJ", "nil", "G RJ", "nil",
"G RJ", "C RV", "G RV", "nil", "C AJ", "G AJ", "nil", "C BB",
"G BB", "C BB", "G BB", "nil", "C BV", "G BV", "nil", "C JA",
"G JA", "nil", "C AJ", "G AJ", "C AJ", "G AJ", "nil", "C RJ",
"G RJ", "nil", "C RJ", "G RJ", "nil"), `2` = c("nil", "C JA",
"G JA", "C JR", "G JR", "nil", "C JR", "G JR", "nil", "C BB",
"G BB", "nil", "C VV", "nil", "C AJ", "G AJ", "nil", "C AJ",
"G AJ", "nil", "C AJ", "nil", "C BV", "G BV", "nil", "C BV",
"nil", "C BV", "G BV", "nil"), `3` = c("nil", "C RJ", "G RJ",
"C RJ", "G RJ", "nil", "C JA", "G JA", "nil", "C VR", "G VR",
"nil", "C BV", "G BV", "nil", "C BV", "G BV", "nil", "C AA",
"G AA", "C AA", "G AA", "nil", "C AA", "G AA", "nil", "C AJ",
"G AJ", "nil", "C AJ", "G AJ", "nil", "C JA", "G JA", "nil",
"C JA", "G JA", "nil", "C BV", "nil"), `4` = c("nil", "C VB",
"G VB", "nil", "C VB", "G VB", "nil", "C BV", "G BV", "nil",
"C RJ", "G RJ", "nil", "C RJ", "G RJ", "nil", "C RR", "G RR",
"nil", "C RV", "nil", "C JA", "G JA", "nil", "C AA", "C JA",
"nil", "C RV", "G RV", "nil", "C RV", "nil", "C VV", "C BB",
"G BB", "nil", "C RV", "G RV", "nil", "C VB", "nil", "C JA",
"G JA", "nil", "C BB", "nil", "C RR", "nil", "C RR", "nil", "C JA",
"nil", "C RR", "nil", "C RR", "nil", "C JA", "nil"), `5` = c("nil",
"C BB", "G BB", "nil", "C RR", "nil", "C VB", "nil", "C AA",
"nil", "C VB", "nil", "C VB", "nil", "C VB", "nil", "C VB", "nil",
"C VB", "nil", "C JA", "nil", "C VB", "G VB", "nil", "C AJ",
"nil", "C VB", "C BB", "nil", "C AJ", "G AJ", "nil", "C RR",
"nil", "C AJ", "nil", "C AJ", "nil", "C JA", "G JA", "nil"),
    `6` = c("nil", "C BB", "nil", "C AA", "nil", "C AA", "nil",
    "C AA", "nil", "C RR", "nil", "C VB", "G VB", "C RV", "G RV",
    "nil", "C VB", "G VB", "nil", "C BB", "nil", "C BB", "nil",
    "C BV", "nil", "C RV", "nil", "C BV", "nil", "C BV", "nil",
    "C JA", "nil")), .Names = c("0", "1", "2", "3", "4", "5",
"6")), rv = structure(list(`0` = c("nil", "C VB", "G VB", "nil",
"G VB", "nil", "C RR", "G RR", "nil", "C RV", "C AA", "G AA",
"nil", "G RR", "C RR", "G RR", "C RR", "G RR"), `1` = c("nil",
"C RV", "G RV", "C RV", "G RV", "nil", "G JR", "nil", "C AJ",
"G AJ", "C AJ", "G AJ", "C AJ", "G AJ", "nil", "C AJ", "nil",
"C JA", "G JA", "C RV", "G RV", "C RV", "G RV", "C RV", "G RV",
"nil"), `2` = c("nil", "C JR", "G JR", "nil", "C BB", "G BB",
"nil", "C BV", "G BV", "nil", "C VV", "G VV", "C VV", "G VV",
"nil"), `3` = c("nil", "C AA", "G AA", "C AA", "G AA", "nil",
"C JA", "nil", "C BV", "G BV", "C BV", "G BV", "nil", "C BV",
"G BV", "nil", "C RJ", "G RJ"), `4` = c("nil", "C VV", "G VV",
"nil", "C VR", "G VR", "nil", "C RJ", "G RJ", "C RJ", "G RJ",
"nil", "C VB", "G VB", "nil", "C JA", "G JA", "C JA", "G JA",
"nil", "C VB", "G VB", "C VB", "G VB"), `5` = c("nil", "C RR",
"G RR", "nil", "C BB", "G BB", "nil", "G BB", "nil", "C JA",
"G JA", "nil"), `6` = c("nil", "C BV", "G BV", "nil", "G BV",
"nil", "C RJ", "nil", "C BB", "nil", "C BB", "nil", "C AJ", "nil",
"C BB", "G BB", "nil", "C RV", "nil")), .Names = c("0", "1",
"2", "3", "4", "5", "6"))), .Names = c("vv", "rv"), class = "data.frame", row.names = c(NA,
-7L)) 
```

我可以映射到特定组件：

```
 > mapply(function(x) sum(substr(x,1,1)=="C"),foo[[1]])
 0  1  2  3  4  5  6
 8 10 11 14 24 19 15 
```

或者

```
> mapply(function(x) sum(substr(x,1,1)=="C"),foo[[2]])
 0  1  2  3  4  5  6
 6 10  5  7  9  3  7 
```

这是预期的输出。但是如何将此功能应用于列表的每个组件？我似乎无法找到解决方案。我不明白为什么似乎没有办法一次映射每个组件。也许我的清单可以有不同的结构？这个列表看起来很奇怪，但其中的信息是正确的。

理想情况下，预期的输出将是一个矩阵，具有组件的名称，例如：

```
structure(c(8L, 10L, 11L, 14L, 24L, 19L, 15L, 6L, 10L, 5L, 7L,
9L, 3L, 7L), .Dim = c(7L, 2L), .Dimnames = list(c("0", "1", "2",
"3", "4", "5", "6"), c("vv", "rv"))) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:12:43.457

你快到了。

```
FUN <- function(x) sum(substr(x,1,1)=="C")
sapply(foo,function(x) mapply(FUN,x))

  vv rv
0  8  6
1 10 10
2 11  5
3 14  7
4 24  9
5 19  3
6 15  7 
```

原则上我认为`sapply(foo,mapply,FUN=FUN)`应该有效，但它没有（只是在评估论点时有点太聪明了）。

# zend-framework2 - 我可以将自己的验证器添加到 ValidatorPluginManager 吗？

> ID：12976013
> 
> 赞同：0
> 
> 时间：2012-10-19T14:06:50.517
> 
> 标签：zend-framework2

我有自己的验证器，它使用实体管理器工作。

是否可以将此验证器添加到 ValidatorPluginManager （并将实体管理器设置为它），然后像这样调用它：

```
$factory = new InputFactory();
    $factory->createInput(
        array(
            'name' => 'username',
            'required' => true,
            'filters' => array(),
            'validators' => array(
                array(
                    'name' => 'MyValidator', 
                    'options' => array(//options for validator))
            ),
        )
    )
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:27:21.397

Zend\InputFilter\Factory 允许你设置默认的验证器链。当您这样做时，将为每个输入克隆该验证器链。这允许您设置默认值，例如要使用的插件管理器实例。

```
$pluginManager = new ValidatorPluginManager();
// do some work with it
$validatorChain = new ValidatorChain();
$validatorChain->setPluginManager($pluginManager);
$factory = new InputFilterFactory();
$factory->setDefaultValidatorChain($validatorChain); 
```

# c++ - 解决 SPOJ DIEHARD 的正确方法是什么？

> ID：12976016
> 
> 赞同：7
> 
> 时间：2012-10-19T14:07:03.753
> 
> 标签：c++, algorithm, recursion, dynamic-programming, greedy

我试图解决关于 SPOJ [https://www.spoj.pl/problems/DIEHARD/](https://www.spoj.pl/problems/DIEHARD/)的练习题。然而，我的贪婪方法都导致了错误的答案，并且递归对于最坏的情况来说太慢了。谁能告诉如何解决这个问题？我正在寻找可以为我指明正确方向的人。

> 游戏很简单。你最初有“H”的生命值和“A”的护甲。在任何时候，你都可以生活在三个地方——火、水和空气中的任何一个。在每单位时间之后，你必须改变你的居住地。例如，如果您目前生活在火灾中，您可以踏入水中或空气中。
> 
> *   如果你踏入空中，你的健康增加 3 点，你的护甲增加 2 点
> *   如果你踏入水中，你的生命值减少 5，你的护甲减少 10
>     如果你踏入火中，你的生命值减少 20，你的护甲增加 5
> 
> 如果您的生命值或护甲变为 <=0，您将立即死亡
> 
> 找到你可以生存的最长时间。
> 
> 输入：
> 
> 第一行包含一个整数 t，即测试用例的数量。对于每个测试用例，将有两个正整数表示初始健康 H 和初始护甲 A。
> 
> 输出：
> 
> 对于每个测试用例，找到您可以生存的最长时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-05-01T06:40:33.663

好的，首先尝试通过贪婪的方法解决它。很明显，空气是最好的选择，因为它可以增加护甲和生命值，但你只能交替使用空气。所以每一个奇数（即 1,3,5...）的移动都将是空的。现在我们必须决定如何处理偶数移动？

所以我们有两个选择火或水？我们必须合理并选择这样一个让 H 和 A 都保持在 0 以上的动作。现在跳火会消耗 -20 生命值，即使它会增加 5 点护甲，但是，等等，如果你不这样做，增加护甲有什么用？ t 让你的健康 >0 。因此，如果 H>5 且 A>10，则选择水。

现在，如果我们缺少盔甲但有足够的健康怎么办？在这种情况下，我们别无选择，只能跳火。

所以现在我们有一个贪婪的方法：

所以，如果我们有足够的 H 和 A，我们就会去水。否则，如果 H 足够而 A 不够，那就开火吧。否则，就结束了！

这里是ideone实现的链接：http: [//ideone.com/rkobNK](http://ideone.com/rkobNK)

```
#include<stdio.h>
int main(){
    long long int x,i,a,b,t,h,arm;
    scanf("%lld",&x);
    for(i=0;i<x;i++){
        scanf("%lld %lld",&a,&b);
        if(a==0||b==0)
         printf("0\n");
        else{
            t=1;
            h=a+3;
            arm=b+2;
            while(1){
                if(h>5&&arm>10){
                    h=h-2;
                    arm=arm-8;
                    t=t+2;
                }else if(h>20&&arm<=10){
                    h=h-17;
                    arm=arm+7;
                    t=t+2;
                }else {
                    printf("%lld\n",t);
                    break;
                }
            }
     }
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-10T10:12:39.967

我通过使用动态编程做到了。Dp[health][armour][air/fire/water]- 是你可以活的最长时间，如果你从这个条件开始，那么反复出现的条件就变成 Dp[health][armour][air/fire/water]=1 +max of next states you can go to Obviousy 基本情况是他无处可去，因此答案为零。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:26:24.003

这是另一种分析方法：

```
a = number of times visiting air state
F = number of times visiting fire state
W = number of times visiting water state

M = a + F + W  // total moves

// positive
a >= 0
F >= 0
W >= 0

// because of the restriction of moving between states...
a <= F + W + 1
F <= W + a + 1
W <= a + F + 1

// the effect of armor and health...
H < -3a + 5H + 20F
A < -2a + 10W - 5F 
```

最大化 M。您可以通过对 M 进行二进制搜索来做到这一点，也可以使用线性规划。

二分查找循环：

```
int ok = 0;
int impossible = 1000000000;
while (impossible - ok > 1)
{
    int candidate = ok + (impossible-ok) / 2;

    if (check(candidate))
        ok = candidate;
    else
        impossible = candidate;
}
return ok; 
```

在任何一种情况下，都使用基本的高中代数来简化不等式/方程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:41:29.967

你试过 DFS 吗？状态是（空气，H，A）的元组。这有：

```
3 * 1000 * 1000 = 3,000,000 game states 
```

对其进行 DFS 并找到最高的移动。（即设置一切为-1，初始状态为0，然后DFS从0状态到所有可达位置）

# ios - 截图/分享 MapView 发送邮件-iOS

> ID：12976017
> 
> 赞同：2
> 
> 时间：2012-10-19T14:07:17.363
> 
> 标签：ios, ios5, ios6, android-mapview

我一直在研究天气应用程序。我想知道如何附加/捕获现有地图以通过电子邮件发送？

任何想法或任何有用的链接。提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-29T16:42:41.217

您可以使用 UIGraphicsGetImageFromCurrentContext 进行屏幕截图。然后您可以使用此屏幕截图附加到电子邮件。

```
- (void)twitterButtonPressed {

    NSString *post=[[NSString alloc]initWithFormat:@"I've burned so far %d Calories today -  update from iPhone app Run Burn Calories!", self.userActivityTotalCount];
    NSURL *url=[NSURL URLWithString:@"www.xxx.uh.edu"];
    UIImage *iconImage2=[self imageWithImage:iconImage scaledToSize:CGSizeMake(73.0, 73.0)];
    if([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter])
    {
        SLComposeViewController *twitterSheet=[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];
        [twitterSheet setInitialText:post];
        [twitterSheet addURL:url];
        [twitterSheet addImage:iconImage2];
        [self presentViewController:twitterSheet animated:YES completion:nil];
        SLComposeViewControllerCompletionHandler completion=^(SLComposeViewControllerResult result){
            switch (result) {
                case SLComposeViewControllerResultDone:
                    NSLog(@"posted successfully!");
                    break;
                case SLComposeViewControllerResultCancelled:
                    NSLog(@" could not posted!");
                    break;

                default:
                    break;
            }
            [twitterSheet dismissViewControllerAnimated:YES completion:nil];

        };
        twitterSheet.completionHandler=completion;

    }
    else{
        UIAlertView *alertView=[[UIAlertView alloc]initWithTitle:@"Sorry" message:@"You can't send a tweet right now, make sure your device has an internet connection and you have at least one Twitter account set up" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [alertView show];
    }

}

-(UIImage*)imageWithImage:(UIImage*)image scaledToSize:(CGSize)newSize
{
    UIGraphicsBeginImageContextWithOptions(newSize, NO, 0.0);
    [image drawInRect:CGRectMake(0, 0, newSize.width, newSize.height)];
    UIImage *newImage =UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return newImage;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T17:34:12.213

首先，如果现有地图尚未采用这种格式，我会将其转换为图像。完成此操作后，发送电子邮件非常简单。这是我的应用程序中用于发送电子邮件的一段代码。

```
- (void) emailPhoto {

    MFMailComposeViewController *picker = [[MFMailComposeViewController alloc] init];
    picker.mailComposeDelegate = self;

    // Set the subject of email
    [picker setSubject:@"Subject of the Email"];

    // Add email addresses
    // Notice three sections: "to" "cc" and "bcc"
    //[picker setToRecipients:[NSArray arrayWithObjects:@"emailaddress1@domainName.com", @"emailaddress2@domainName.com", nil]];
    //[picker setCcRecipients:[NSArray arrayWithObject:@"emailaddress3@domainName.com"]];
    //[picker setBccRecipients:[NSArray arrayWithObject:@"emailaddress4@domainName.com"]];

    // Fill out the email body text
    NSString *emailBody = @"Text to appear in the email."; 

    // This is an HTML formatted email
    [picker setMessageBody:emailBody isHTML:NO];

    // Create NSData object as PNG image data from camera image
    // This is where I take my self.workingImage object and convert to data object
    NSData *data = UIImagePNGRepresentation(self.workingImage);

    // Attach image *data* object to the email
    [picker addAttachmentData:data mimeType:@"image/png" fileName:@"Image"];

    // Show email view
    [self presentModalViewController:picker animated:YES];

    // Now the user can send or cancel the email as they please

} 
```

# java - java中如何释放内存

> ID：12976023
> 
> 赞同：-5
> 
> 时间：2012-10-19T14:07:33.807
> 
> 标签：java

我创建了 A 类的对象。当时 java 占用了 A 类的内存。但是当我在 A 类的对象中分配 null 时，它可以释放该对象的内存

```
class A{
    public long num = 28115733;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:09:01.343

如果将 A 类引用的 Object 分配给 null，则 Object A 有**资格**进行 GC（它可能不会立即释放内存）。

何时释放内存取决于所使用的 JVM 和垃圾收集器 (GC) 算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:08:50.360

你不能确定这一点。当您分配`null`给 an`object reference`时，`object`该引用指向的是`eligible`for `Garbage Collection`。

但这完全取决于它被`JVM`它占据的时候。`releases``memory``object`

可能是当`JVM`看到`memory`越来越低，然后它可以`kick off`释放`garbage collector`一些内存。但这完全是一个后台进程。你不必担心这一点。此外，如果您想明确告诉`JVM`回忆内存，那么您可以添加对`System.gc()`. 但同样 JVM 不会立即启动该`Garbage Collection`进程。那只会开启`JVM`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:10:07.613

Java 中的内存由垃圾收集器（一个查找无法访问的对象并返回其内存以供使用的进程）回收，您无需显式将对象设置为 null 即可发生这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:09:15.117

> 当我在 A 类的对象中分配 null 时，它可以释放该对象的内存

是的，它可以，但它不会释放内存，直到它必须。

# php - 更改 JSON 输出

> ID：12976030
> 
> 赞同：1
> 
> 时间：2012-10-19T14:07:51.123
> 
> 标签：php, mysql, json, mysqli

我使用以下代码从我的表中获取内容。但我需要稍微改变一下 JSON 的输出。

```
$rows = array();
if(isset($_GET['fruitName'])) {
$stmt = $pdo->prepare("SELECT variety FROM fruit WHERE name = ? ORDER BY variety");
$stmt->execute(array($_GET['fruitName']));
$rows = $stmt->fetchAll(PDO::FETCH_ASSOC);
}
echo json_encode($rows); 
```

使用上面的代码，它显示如下：

```
[{"variety":"Apple"},{"variety":"Banana"},{"variety":"Orange"},{"variety":"Pear"}] 
```

但我希望它是这样的：

```
[{"optionValue": "Apple", "optionDisplay": "Apple"}, {"optionValue": "Banana", "optionDisplay": "Banana"}, {"optionValue": "Orange", "optionDisplay": "Orange"}, {"optionValue": "Pear", "optionDisplay": "Pear"}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:18:38.800

一种解决方案可能是像这样调整 SQL 查询：

```
SELECT variety AS optionValue, variety AS optionDisplay FROM fruit WHERE name = ? ORDER BY variety 
```

另一种方法是单独解析每一行并手动构建您的数组。所以而不是

```
$rows = $stmt->fetchAll(PDO::FETCH_ASSOC); 
```

你可以使用

```
$rows = array();
while( $row = $stmt->fetch(PDO::FETCH_ASSOC) ) {
  $rows[] = array( 'optionValue' => $row['variety'], 'optionDisplay' => $row['variety'] );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:16:09.160

将您的选择语句更改为

```
"SELECT variety as `optionValue`,variety as `optionDisplay` FROM fruit WHERE name = ? ORDER BY variety" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:16:24.027

```
$data = '[{"variety":"Apple"},{"variety":"Banana"},{"variety":"Orange"},{"variety":"Pear"}]';

$arr = new array();
// loop through the data
foreach($data as $k => $v){
  // build an array of values formatted as you want
  $arr[] = '{"optionValue": "'.$v.'", "optionDisplay": "'.$v.'"}}';
}
// join all the values togetger, and pass through json parser
$obj = json_decode(',', "[" . implode($arr) . "]");
// should return in your desired format... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:17:51.790

不完全确定，因为我无法对此进行测试，但您不能将您的 SQL 语句更改为：

```
$stmt = $pdo->prepare("SELECT variety as optionValue, variety as optionDisplay FROM fruit WHERE name = ? ORDER BY optionDisplay"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T14:20:08.923

我不明白你为什么要这样做，但无论如何，这就是：

```
$new_array=array();
foreach ($rows as $row) {
array_push($new_array,array("optionValue"=>$row['variety'],"optionDisplay"=>$row['variety']));
}
echo json_encode($new_array); 
```

# ruby-on-rails - Ruby/Rails 中的 FTP 服务器功能

> ID：12976031
> 
> 赞同：1
> 
> 时间：2012-10-19T14:07:55.973
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我需要能够从桌面应用程序接收用户的 ftp 文件，并且想知道 Rails 是否有办法处理这些请求，尽管它是基于 HTTP 的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:53:52.547

通常，您会让主机使用 FTP 守护程序处理请求。

如果你有相当多的用户通过 FTP 发送文件，你不想浪费 Rails 的 CPU 时间来处理它们。

此外，还要考虑安全和管理问题。您必须在 Rails 中编写自己的实现。使用内置的 FTPd 将允许您搭载它。

不要重新发明轮子，重复使用经过充分测试的轮子。

# r - 如何在 R 包命名空间文件中正确使用 useDynLib()

> ID：12976036
> 
> 赞同：14
> 
> 时间：2012-10-19T14:08:06.570
> 
> 标签：r, namespaces, makefile, package, shared-libraries

尽管互联网上有一些解决方案，但我发现没有一个适合我当前面临的问题（尽管也许我太笨了）：

我正在尝试构建一个 R 包，它广泛使用由 Makefile 编译的共享对象（是的，不好的做法，我知道，但是不能告诉 Makevars 文件将 C 和 Fortran 代码编译成一个共享对象) 来自包`src`目录中的代码。无论我将 .so 编译到哪里（我尝试了`src`,`libs`和 package 基本文件夹）或者我如何命名它（正如上面提到的解决方案之一，它必须像它所包含的包一样命名），`R CMD check`退出

```
** testing if installed package can be loaded
Error in library.dynam(lib, package, package.lib) : 
shared object ‘SoMNibEN.R.so’ not found 
```

由于`useDynLib(SoMNibEN.R)`我的 NAMESPACE 文件中的说明（`SoMNibEN.R`我的包的名称在哪里，但它也不适用于原始名称）

我的假设是我要么使用错误的`useDynLib()`命令，要么我的 Makefile 做错了什么（尽管编译工作得很好，并且共享对象是在我的项目文件夹中创建的 - 我只是不知道它是否被复制成功到包安装目录）。

所以，如果有人知道我在这里可能做错了什么，请告诉我！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T18:02:11.857

您希望*包的名称*作为参数，因为这是R 构建*的共享对象的名称*，例如`useDynLib("chron")`. 引号是可选的（因为它们用于`library()`等）。

我还建议*不要*使用 Makefile，而只是将 C 和 Fortran 文件放到`src/`目录中。R 通常足够聪明，知道要做什么。如果你需要`-I`等开关，你可以在那里设置它们。

最后，使用 CRAN。有数百个带有编译源的软件包，其中一些肯定在结构上与您的问题相似。

# sql - 从 SQL Server 中的 Select * 语句中取消选择列

> ID：12976038
> 
> 赞同：1
> 
> 时间：2012-10-19T14:08:11.780
> 
> 标签：sql, sql-server, select

我想选择所有列，但给出的列名`DISTINCT`重复了两次。
例如，

```
SELECT DISTICT emp_name,* FROM EMPLOYEE 
```

在上述情况下，列`emp_name`被选中两次。我怎样才能避免它？

**更新**：
如何`DISTINCT`在返回多列时应用于选定列？例如：

```
SELECT DISTINCT(emp_name), emp_address, doj FROM EMPLOYEE 
```

在上面的例子`DISTINCT`中必须应用在`emp_name`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:09:49.087

消除`emp_name`

```
SELECT DISTINCT * FROM EMPLOYEE 
```

或替换`*`为所有列：

```
SELECT DISTINCT emp_name, col1, col2 ... FROM EMPLOYEE 
```

您还可以使用：

```
SELECT max(emp_name), emp_address, doj 
FROM EMPLOYEE
GROUP BY emp_address,doj 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:09:37.893

您不能在查询中两次包含它：

```
SELECT DISTINCT * FROM EMPLOYEE 
```

# nokia - 使用 JavaME 检索 IMSI 的代码是什么？

> ID：12976042
> 
> 赞同：1
> 
> 时间：2012-10-19T14:08:29.220
> 
> 标签：nokia, samsung-mobile, motorola

我需要一个能够检索 IMSI 的 JavaME 代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T05:47:11.213

`com.nokia.mid.imsi` [在诺基亚设备上，您可以使用系统属性](http://www.developer.nokia.com/Resources/Library/Java/#!developers-guides/application-framework/system-properties/nokia-specific-system-properties.html)访问 IMSI 。但是，对该属性的访问仅限于制造商/运营商安全域

# android - 在启动时运行代码一次

> ID：12976043
> 
> 赞同：2
> 
> 时间：2012-10-19T14:08:31.577
> 
> 标签：android

我想在应用程序每次启动时运行一小段代码。我尝试了以下方法：

*   在 Activity.onCreate() 中。但这不起作用，因为例如可以在轮换时重新创建活动。
*   创建 Application 的子类并在那里运行 onCreate() 。这似乎也不起作用。它会在安装应用程序时执行，但不会在您退出应用程序并再次进入时执行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:15:21.670

在您的主要活动中，声明您`true`在运行启动代码时设置的静态布尔标志。在`onCreate`中，仅当标志为 时才运行启动代码`false`。在`onDestroy`（或在任何关闭生命周期方法中，就此而言），如果活动正在完成，则清除标志：

```
protected void onDestroy() {
    super.onDestroy();
    if (isFinishing()) {
        startedFlag = false;
    }
} 
```

这将在活动完成时清除标志，但如果活动因配置更改而被销毁，则保持不变。

仍然有一个问题：活动的进程可能会在暂停时被终止，并且应用程序处于后台。`false`在这种情况下，当用户尝试将应用程序带回前台时，系统重新创建 Activity 时会出现该标志。如果这是一个问题，那么您将不得不使标志持久化。我建议为此使用共享首选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-08T20:28:47.260

这是[我如何在每个应用程序启动时只执行一次的副本？](https://stackoverflow.com/questions/7360846/how-can-i-execute-something-just-once-per-application-start)

> *   创建 Application 的子类并在那里运行 onCreate() 。这似乎也不起作用。它会在安装应用程序时执行，但不会在您退出应用程序并再次进入时执行

您需要将代码放在构造函数中，而不是放在 onCreate() 方法中。检查这个答案：[https ://stackoverflow.com/a/13809300/2005891](https://stackoverflow.com/a/13809300/2005891)

# c# - webclient 下载字符串（URI），URI 有 10 mb 文件。我可以下载一定大小的这个文件吗？

> ID：12976047
> 
> 赞同：0
> 
> 时间：2012-10-19T14:08:45.087
> 
> 标签：c#, webclient

我在 URI 上有一个 10 mb 的文件，我使用以下代码下载它。

WebClient wc = new WebClient(); 字符串文件 = wc.DownloadString(http://www......com);

我可以下载此文件的某些大小，例如 1 mb、5 mb。不是整个 10 mb。? 然后停止下载？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:16:51.603

在您的请求中添加 HTTP Range 标头。请注意，这仅在服务器支持时才有效。

有关它的更多信息，请参见[http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:42:52.260

您可以使用 httpwebrequest 来获取响应。加载你想要的任何行。检查：http: [//msdn.microsoft.com/en-us/library/system.net.httpwebrequest.getresponse%28v=vs.71%29.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.getresponse%28v=vs.71%29.aspx)

该示例使用 ReadToEnd。您可以使用其他方法来读取其中的一部分。

# javascript - 仅当来自 ajax 调用的数据已更改时才更新内容

> ID：12976049
> 
> 赞同：1
> 
> 时间：2012-10-19T14:08:48.577
> 
> 标签：javascript, jquery, ajax

我有一个 HTML 表，其中填充了通过 AJAX 调用收集的数据。

此 ajax 调用每 X 秒触发一次。

如果从 AJAX 调用接收到的数据与表中的现有数据***不同***，我***只想更新表。***

 *有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:12:38.410

您必须在每个 AJAX 回调中存储数据并进行比较。

如果您的比较计算量很大，则在服务器端生成**哈希**并将其与有效负载一起发送到客户端。您只需要存储和比较哈希。

与其敲打您的服务器，不如使用**[SignalR](http://signalr.net/)**并在更改发生时推送您的更改（如果您是 .NET）。您可以为其他平台找到类似的框架。*

# wpf - HierarchicalDataTemplate 中的固定项

> ID：12976054
> 
> 赞同：2
> 
> 时间：2012-10-19T14:09:09.573
> 
> 标签：wpf, hierarchicaldatatemplate

我需要在 WPF 中创建一个看起来像这样的 TreeView：

*   管理员*（组）*
    *   **用户** *（固定节点）*
        *   爱丽丝亚当斯*（用户）*
        *   鲍勃·布朗*（用户）*
    *   **权限** *（固定节点）*
        *   删除*（权限）*
        *   更新*（许可）*
*   嘉宾*（组）*
    *   **用户** *（固定节点）*
        *   查理克拉克*（用户）*
    *   **权限** *（固定节点）*
        *   查看*（权限）*

我有一个组列表，每个组有 3 个属性：

*   名称（字符串）
*   用户（列表）
*   权限（列表）

只显示用户或权限很容易：

```
 <TreeView ItemsSource="{Binding Groups}">
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Users}">
                    <TextBlock Text="{Binding GroupName}" />

                    <HierarchicalDataTemplate.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding UserName}" />
                        </DataTemplate>
                    </HierarchicalDataTemplate.ItemTemplate>
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView> 
```

但我需要添加 2 个节点（用户和权限），它们展开以显示 2 个列表。

任何建议都非常感谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T18:03:45.190

您可以使用带有转换器的 MultiBinding 来执行以下操作：

```
<HierarchicalDataTemplate DataType="{x:Type local:GroupClass}">
        <HierarchicalDataTemplate.ItemsSource>
            <MultiBinding Converter="{StaticResource converter-that-returns-lists-as-is}">
                <Binding Path="Users"/>
                <Binding Path="Permissions"/>
            </MultiBinding>
        </HierarchicalDataTemplate.ItemsSource>
        <TextBlock Text="{Binding Path=Name}"/>
    </HierarchicalDataTemplate>

    <HierarchicalDataTemplate x:Key="IEnumerable[UserClass]" ItemsSource="{Binding Path=.}">
        <TextBlock Text="Users"/>
    </HierarchicalDataTemplate>

    <DataTemplate DataType="{x:Type local:UserClass}">
        <TextBlock Text="{Binding Path=Name}"/>
    </DataTemplate>

    <HierarchicalDataTemplate x:Key="IEnumerable[PermissionClass]" ItemsSource="{Binding Path=.}">
        <TextBlock Text="Permissions"/>
    </HierarchicalDataTemplate>

    <DataTemplate DataType="{x:Type local:PermissionClass}">
        <TextBlock Text="{Binding Path=Name}"/>
    </DataTemplate> 
```

转换器只会将未修改的列表返回为`IEnumerable<T>`.

# jquery - Jquery 加载不起作用，我的代码中是否存在语法错误？

> ID：12976057
> 
> 赞同：1
> 
> 时间：2012-10-19T14:09:15.460
> 
> 标签：jquery, ajax, wordpress, syntax

我正在研究一个 wordpress 投资组合，我正在尝试使用 ajax/jquery 将帖子内容加载到滑动抽屉中`.load()`。在@techfoobar 的帮助下，当我单击页面的选定元素（缩略图）时，我已经能够打开抽屉了。但是现在我很难找到为什么我的 ajax 内容没有加载到这个 div 中......

当我点击缩略图时，抽屉被打开，然后浏览器继续到 url，而不是加载这个 url抽屉。如果我按 Esc 停止浏览器，我可以读取“正在加载...”，因此 jQuery 一直工作到那时。

**有人可以检查这个小提琴** [http://jsfiddle.net/RF6df/14/](http://jsfiddle.net/RF6df/14/)并告诉我是否放错了加载功能，或者是否存在严重的语法问题阻止我的内容正确加载？（我假设负载不会在 jsfiddle 上工作，但至少你可以检查代码）

仅供参考，在第一次尝试 ajax 时，我使用它来加载我的内容，它工作正常，但我的 div 已经在我的 php 页面中就位（检测到点击时未加载）。
哦，请记住，我是 jquery 的新手，如果您可以评论/解释您所看到或所做的，那将是无价的！

```
$(document).ready(function(){
    $.ajaxSetup({cache:false});
    $(".ProjectWrap,.mosaic-overlay,.mosaic-backdrop").click(function(){
        var post_link = $(this).attr("href");
        //$('#DrawerContainer').slideToggle(500);
        $("#DrawerContainer").html("loading...");
        $("#DrawerContainer").load(post_link + " #container > * ");
    return false;
    });
});
$(document).ajaxSuccess(function() {  // refresh heading in ajax called element
Cufon('h1'); 
}); 
```

**编辑：**
我刚刚注意到，当我写`.load("http://localhost/youpiemonday_New/test4 #container > * ")`抽屉时，获取 test4 帖子的内容。我仍然必须按 Esc 来停止浏览器，否则它太快了。
如果我写`.load(post_link + " #container > * ")`了唯一显示的是“正在加载...”。所以我假设负载正在工作，但问题来自`post_link`部件。奇怪的是，当我的功能严格限制为负载时，它就可以正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:57:59.420

我想我看到了你的问题。`.ProjectWrap`你`li`是吗？如果是这样，您要做的是从没有 href 属性的 LI 获取 href。

试试这个：

```
var post_link = $(this)
                 .parentsUntil(".ProjectWrap")
                 .parent()
                 .find(".mosaic-backdrop")
                 .attr("href"); 
```

这是在说：为此（.ProjectWrapper）找到`<a />`并获取href。

# iphone - 重新定义宏

> ID：12976059
> 
> 赞同：1
> 
> 时间：2012-10-19T14:09:36.520
> 
> 标签：iphone, objective-c, macros

在我的应用程序中，我必须重新定义一个宏。我确实喜欢这个。

```
-(void)viewDidLoad{

#undef kMacro
#define kMacro @"New Value"

} 
```

它在此功能中运行良好。当我放入`NSLog`这个函数时，我得到“新值”。但是，我无法在这个函数之外或在其他类中获得这个新值。（我得到旧值）。是否可以将宏重新定义为全局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:39:40.740

当您在文件中重新定义宏时，它仅对该文件有效，因为所有文件都被视为单独的编译单元。

要让它在其他类中工作，您需要放入一个头文件并将其#import 到您想要使用它的所有文件中。

更好的是，不要使用宏并使用正确的 C：

```
const NSString* kMyString = @"New Value"; 
```

然后您可以将其作为其他 .m 文件中的普通外部变量进行访问。

# c# - 在代码中使用 Char(22) 是否有风险

> ID：12976062
> 
> 赞同：0
> 
> 时间：2012-10-19T14:09:39.840
> 
> 标签：c#, winforms

C# WinForms：如果这个软件人们也将使用非英语语言，那么将是一个编写这样的代码，还是可以吗？有没有更好的.NET 方式来编写它？

```
if (eventArgs.KeyChar == (char)22) 
```

**由 RB 编辑**：`char(22)`是[Synchronous Idle](http://en.wikipedia.org/wiki/Control-V)，但更广为人知的是“Ctrl+V”或“Paste”。他在问如何在 WinForms 中检测“粘贴”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:18:15.860

如果您的问题是关于代码的可读性，那么您可以将其编写得更简洁。哪个字符是 22？我不知道，必须查一下。我不应该这样做，因此代码可能更具可读性。您可以通过以下方式重新考虑这一点

*   简单地使用你需要的字符，即。`eventArgs.KeyChar == 'e'`
*   使用一些枚举，例如，`eventArgs.KeyChar == Keys.E`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:22:02.807

由于`Keys`枚举没有定义 SYN 键，这应该可以工作。

但也许你应该在某个地方声明一个

```
public static readonly char SynChar = (char)22; 
```

# ios - 是否可以让 iPhone 应用程序从外部来源触发方法

> ID：12976063
> 
> 赞同：0
> 
> 时间：2012-10-19T14:09:43.120
> 
> 标签：ios

有没有办法从服务器向 iPhone 发送信号以使其执行某些操作（例如触发特定方法）？

我正在考虑推送通知，但用户必须单击以接受并从那里触发该方法。如果我想让手机在用户不在时做某事怎么办？

例如：如果有人丢失了手机，我们想从中获取一些信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:42:53.413

是的你可以。您可以打开一个到您的服务器的套接字（请参阅[CFSocket](https://developer.apple.com/library/ios/#documentation/CoreFOundation/Reference/CFSocketRef/Reference/reference.html)）并根据套接字接收到的内容触发方法。但是，您需要后台权限，并且您的应用可能会被 App Store 拒绝。

根据文档，只允许特定的应用程序类型在后台运行：

*   在后台向用户播放有声内容的应用程序，例如音乐播放器应用程序
*   让用户随时了解其位置的应用程序，例如导航应用程序
*   支持互联网协议语音 (VoIP) 的应用程序
*   需要下载和处理新内容的报亭应用
*   从外部配件接收定期更新的应用程序

请参阅[iPhone Programming Guide中的](http://developer.apple.com/library/ios/documentation/iphone/conceptual/iphoneosprogrammingguide/iphoneappprogrammingguide.pdf)*实现长时间运行的后台任务*（第 58 页）。

# android - 自动关闭/关闭自定义对话框

> ID：12976065
> 
> 赞同：0
> 
> 时间：2012-10-19T14:09:46.460
> 
> 标签：android, dialog, android-progressbar

我有这个自定义对话框：

```
public class MyProgressDialog extends Dialog {

    public MyProgressDialog(Context context) {
        super(context);
    }

    public static MyProgressDialog show(Context context) {
        MyProgressDialog dialog = new MyProgressDialog(context);

        dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
        dialog.setContentView(R.layout.progress);
        dialog.getWindow().setBackgroundDrawableResource(
                android.R.color.transparent);
        dialog.show();
        return dialog;
    }

    public static void dismiss(Context context) {
        MyProgressDialog dialog = new MyProgressDialog(context);
        dialog.dismiss();
    }

} 
```

它会显示

```
 protected void onPreExecute() {
        MyProgressDialog.show(ItemsActivity.this);
        } 
```

但不会解雇：

```
MyProgressDialog.dismiss(ItemsActivity.this); 
```

有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:16:49.357

您正在创建一个新对话框并关闭它，而不是您在`show()`. 您可以保留对创建的最新对话框的引用，如果愿意，可以将其关闭。例如：

```
public static MyProgressDialog show(Context context) {
    MyProgressDialog dialog = new MyProgressDialog(context);

    dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
    dialog.setContentView(R.layout.progress);
    dialog.getWindow().setBackgroundDrawableResource(
            android.R.color.transparent);
    dialog.show();
    staticVariable = dialog;
    return staticVariable;
}

public static void dismiss(Context context) {
    staticVariable.dismiss();
} 
```

然而，这似乎不是一个理想的设计。

# google-chrome - Chrome 液体布局问题

> ID：12976067
> 
> 赞同：2
> 
> 时间：2012-10-19T14:09:49.330
> 
> 标签：google-chrome, webkit, percentage, liquid-layout

我有这个类的 div：

```
 .header {
    width: 100%;
    height: 10%;
} 
```

如果您使用 Web 开发人员工具检查它，您可以看到浏览器如何计算元素的宽度和高度：

IE 9 --> 854.24 x 26.05

火狐 15.01 --> 854 x 28

Safari 5.1.7 --> 843 x 27

铬 22.0.1229.94 m --> 951 x 36

现在，正如您在上面看到的，Chrome 以不同的方式计算 %。我该如何解决这个问题？这是一个错误吗？Safari 也使用 webkit，但没有这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:24:50.943

您看到的是基于视口、html 和 body 标签大小的计算。如果视口（您在窗口中看到的区域）发生变化，那么 html->body->div 的大小也会发生变化。只需添加另一个工具栏就会改变这些大小。

这是“响应式网页设计”的目的之一，内容决定了元素的大小，我们不应再根据设备上的像素数进行布局。但这真的会变得深入和离题。

# r - 为什么我找不到 LAB 颜色立方体？

> ID：12976069
> 
> 赞同：3
> 
> 时间：2012-10-19T14:09:52.293
> 
> 标签：r, colors

我使用 R`colorspace`包将三维点转换为 LAB 颜色。LAB 颜色由三个坐标定义，第一个范围从 0 到 100，另外两个范围从 -100 到 100。

但是用谷歌搜索我没有找到 LAB 颜色空间的长方体表示。为什么 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:48:49.513

### 简短的回答

LAB 颜色空间，又名色域，包含无法在自然界或屏幕上再现的颜色（根据[此页面](http://photo.net/learn/digital-photography-workflow/advanced-photoshop-tutorials/using-lab-color-adjustments/)）。

### RGB转LAB详解

我想你问的原因是你想制作某种印刷材料并想确保颜色正确。我只是这个领域的狂热爱好者，但认为[维基百科关于实验室色彩空间](http://en.wikipedia.org/wiki/Lab_color_space#RGB_and_CMYK_conversions)的文章中的这一段解释了一些复杂性。

> RGB 或 CMYK 值与 L*a*b* 之间的转换没有简单的公式，因为 RGB 和 CMYK 颜色模型取决于设备。RGB 或 CMYK 值首先需要转换为特定的绝对色彩空间，例如 sRGB 或 Adob​​e RGB。此调整将取决于设备，但转换的结果数据将与设备无关，允许将数据转换为 CIE 1931 颜色空间，然后转换为 L*a*b*。

也就是说，为了创建实验室颜色立方体，您必须首先找到从显示器特定颜色空间到绝对颜色空间的转换。这是非常困难的，因为映射不是线性的或任何其他简单的形式。转换也不太可能是完美的，因为 RGB 和 LAB 空间不跨越相同的子空间（在这里推测）。我曾经和一位版画家谈过这个问题，他说虽然人眼只有 4 种颜色感受器（RGB + 光强度），但您需要大约 17 种颜色成分才能在纸上生成全光谱的可见颜色。RGB 和 LAB 都在这方面做出了妥协，针对不同的目的进行了优化。

### 底线

您可以校准屏幕以设置将屏幕的 RGB 转换为人眼的 LAB 颜色所需的转换，然后继续制作颜色立方体。但是，它仅适用于您的显示器，并不完美。您最好测试打印不同的颜色配置文件并选择您最喜欢的一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-30T23:12:11.903

因为没有这样的东西。CIELAB 色彩空间具有笛卡尔表示（无限大小），但我们能感知的（有限）色域不是立方的，它具有复杂的形状。在预定义的范围内独立地改变两个坐标 a* 和 b* 似乎很方便，但这根本不是人类感知的工作方式。

# android - 如何在android中增加特定应用程序的CPU使用率

> ID：12976074
> 
> 赞同：1
> 
> 时间：2012-10-19T14:10:03.687
> 
> 标签：android, cpu-usage

在我的应用程序中，我想将应用程序的 CPU 使用率增加到用户的期望值并使其稳定直到用户感兴趣。
我正在使用 top 命令使用以下方法计算总 CPU 使用率。

示例代码：

```
private long getCpuUsageStatistic() {
           usage =0;
          String tempString = executeTop(); // executeTop is method where I fire top command.

           tempString = tempString.replaceAll(",", "");
           tempString = tempString.replaceAll("User", "");
           tempString = tempString.replaceAll("System", "");
           tempString = tempString.replaceAll("IOW", "");
           tempString = tempString.replaceAll("IRQ", "");
           tempString = tempString.replaceAll("%", "");
           for (int i = 0; i < 10; i++) {
                tempString = tempString.replaceAll("  ", " ");
           }
           tempString  = tempString.replaceAll("  ", " ");
           tempString = tempString.trim();
           String[] myString = tempString.split(" ");
           int[] cpuUsageAsInt = new int[myString.length]; 
           for (int i = 0; i < 2; i++) {
                myString[i] = myString[i].trim();
                cpuUsageAsInt[i] = Integer.parseInt(myString[i]);
                //System.out.println("getCpuUsageStatistic-----"+cpuUsageAsInt[i]);
           }
           usage = cpuUsageAsInt[0]+cpuUsageAsInt[1];
           System.out.println("getCpuUsageStatistic-----"+usage); 
           return usage;
     }

And trying to incrase CPU usage by reducing sleeping time of running thread.

but, application COU usage is not increased.

My run method is like following::

public void run() {

           while (true) {
                try {

                     Thread.sleep(READ_INTERVAL);
                     totalUsage += cpuUpdate();
                     count++;
                     float cpuUsage = totalUsage / count;

                     if (count >= 10) {
                           if (cpuUsage >= desiredCpuUsage) {
                                System.out.println("cpu usage::%" + cpuUsage);

                                break;
                           } else {

                                System.out.println("cpu usage::%" + cpuUsage);
                         if(READ_INTERVAL / reducingFactor < 190)
                         {
                             if(cpuUsage / desiredCpuUsage< 0.2)
                             {
                                 reducingFactor = reducingFactor / 1.2;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.5)
                             {
                                 reducingFactor = reducingFactor / 1.5;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.6)
                             {
                                 reducingFactor = reducingFactor / 3.0;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.7)
                             {
                                 reducingFactor = reducingFactor / 4.0;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.75)
                             {
                                 reducingFactor = reducingFactor / 5.0;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.8)
                             {
                                 reducingFactor = reducingFactor / 6.0;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.85)
                             {
                                 reducingFactor = reducingFactor / 7.0;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.9)
                             {
                                 reducingFactor = reducingFactor / 9.0;
                             }
                             else if(cpuUsage / desiredCpuUsage < 0.95)
                             {
                                 reducingFactor = reducingFactor / 12.0;
                             }
                             else
                             {
                                 reducingFactor = reducingFactor / 15.0;
                             }
                         }
                         READ_INTERVAL-= reducingFactor;
                     }
                           cpuUsage=0;
                           count=0;
                           System.out.println("Read_interval" + READ_INTERVAL
                                     + "::cpu usage::%::" + cpuUsage);

                 }          

                           }

                catch (Exception e) {
                     e.printStackTrace();
                }  
           }
     } 
```

请提供解决方案和任何技术来增加或减少 CPU 的使用率。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-22T07:54:31.320

我建议在带有 Thread.sleep 的 while 循环中使用一些数学函数来限制它。

我不确定是否可以强制 Dalvik VM 接受负载，或者它是否会优化其运行时计划以平衡负载。

我只知道很多 sin/cos 函数会创建一个相当稳定的负载，理论上，通过简单地添加或多或少的计算，应该很容易按比例放大和缩小。

我只是不知道虚拟机如何在多核 cpu 上处理这个问题，因为如果它突然将负载转移到另一个核心上，第一个核心上的负载下降或更糟，一直在变化。

但我认为它值得一试

# c# - 在 windows phone c# 上使用 JSON.net 解析 json

> ID：12976076
> 
> 赞同：0
> 
> 时间：2012-10-19T14:10:12.073
> 
> 标签：c#, wpf, windows-phone-7, json.net

我是 WP 的新手开发人员。我在解析 json 数据时遇到了一些问题。我从服务器获取它并用 JSON.Net 解析。

JSON 数据示例

```
{"response":
     {"ad6a95dd8f90fad7e281994cb5a8cacd":
           {"status":"offline", "name": "Test Name",
            "id":"ad6a95dd8f90fad7e281994cb5a8cacd"}
     }
 "success":true
} 
```

“响应”的第一个选项随对服务器的每个请求而变化。如何提取“名称”字段的值？！预先感谢您的回复。

我在 Page.xaml.cs 中尝试

```
var o = JObject.Parse(result);
        var id = o["response"].First;
        ServerList.ItemsSource = id; 
```

并在 Page.xaml

```
<ScrollViewer Foreground="White">
                        <ListBox Margin="0,0,-12,0" Name="ServerList" Height="508" Width="415">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Margin="0,0,0,20" Width="300">
                                        <TextBlock Text="{Binding Path=name}" />
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </ScrollViewer> 
```

我是通过例子做到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T06:53:28.323

为了`name`从那个 Json 中获取价值，我这样做了：

```
var o = JObject.Parse(result);
var id = o["response"].First.First["name"];
string name = id.Value<string>(); 
```

如果您实际上是在尝试对一系列响应执行此操作，例如：

```
{"responses":
    [
        {"response":
            {"ad6a95dd8f90fad7e281994cb5a8cacd":
                {"status":"offline", "name": "Test Name","id":"ad6a95dd8f90fad7e281994cb5a8cacd"} },"success":true },
        {"response":
            {"ad6a95dd8f90fad7e281994cb5a8cacd":
                {"status":"offline", "name": "Test Name2","id":"ad6a95dd8f90fad7e281994cb5a8cacd"} }, "success":true }
    ]
} 
```

然后你的代码需要看起来像：

```
var o = JObject.Parse(result);
var ids = from c in o["responses"].Children() select c["response"].First.First;
var names = ids.Select(t => t.SelectToken("name").Value<string>()); 
```

# php - 在php中将unix时间转换为w3时间

> ID：12976077
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:10:13.977
> 
> 标签：php, date, datetime, unix-timestamp, data-conversion

数据库具有以 Unix 时间存储的字段，即。1328202426

我有一个需要 w3 时间的开源标准的 api 调用，即。2010-01-01T00:00:00Z

a) 将 w3 时间转换为 unix 时间

b) 将 unix 时间转换回 w3 时间

在 PHP 中

这将如何完成？有没有人有这方面的资源或者我们会发明轮子

我确实看过php附带的一些日期转换功能

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:15:25.273

a.) 将 w3 时间转换为 unix 时间

```
$date = "2010-01-01T00:00:00Z";
strtotime($date); 
```

b.) 将 unix 时间转换回 w3 时间

```
date(DATE_W3C, $timestamp); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:17:50.840

因为这是来自数据库，所以我假设 mysql 这里有可以操作时间戳的函数，FROM_UNIXTIME 转换为您可以指定的格式。要么使用 php date 函数。

看看这个页面 [mysql手册](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)

# javascript - requirejs 导出在 Firefox 15 中不起作用

> ID：12976080
> 
> 赞同：0
> 
> 时间：2012-10-19T14:10:20.827
> 
> 标签：javascript, requirejs, adobe-brackets

我使用了一个使用 requirejs 的外部库我不知道它是如何工作的，但是 FileError 在其他浏览器或 FF8 的全局范围内，但在 FF 14/15 中说`FileError not defined.`

```
define(function (require, exports, module) {   
   "use strict";
    var Async = require("utils/Async");
    var NativeFileSystem = {
    /**
     * LOT OF CODE HERE
     * ...
     * ...
     * ...
    */       
    /** class: FileError
     *
     * Implementation of HTML file API error code return class. Note that we don't
     * actually define the error codes here--we rely on the browser's built-in FileError
     * class's constants. In other words, external clients of this API should always
     * use FileError.<constant-name>, not NativeFileSystem.FileError.<constant-name>.
     *
     * @constructor
     * @param {number} code The error code to return with this FileError. Must be
     * one of the codes defined in the FileError class.
     */
    NativeFileSystem.FileError = function (code) {
        this.code = code || 0;
    };
    /**
     *THIS FIX THE PROBLEM BUT IT A HACK
     *window.FileError = NativeFileSystem.FileError;
     */
    // Define public API
    exports.NativeFileSystem    = NativeFileSystem;
}); 
```

当然，如果我 `window.FileError = NativeFileSystem.FileError;` 在函数定义之后添加它就可以正常工作。但我不想破解库 [文件的完整来源在这里](https://github.com/adobe/brackets/blob/master/src/file/NativeFileSystem.js)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:22:42.933

括号仅对错误代码常量依赖 FileError 类。

FileAPI 仍然是一个草案规范[http://www.w3.org/TR/FileAPI/](http://www.w3.org/TR/FileAPI/)并且似乎在我们最初编写 NativeFileSystem 的时候他们已经将 FileError 更改为 DOMError。我们可以删除这个依赖并定义我们自己的等效 FileError 常量来删除依赖。我们试图在 FileAPI 之后对我们的 API 进行建模，但它一直是一个移动的目标。

# awk - 使用期望发送此命令的终端命令出现问题

> ID：12976083
> 
> 赞同：0
> 
> 时间：2012-10-19T14:10:28.080
> 
> 标签：awk, grep, send, expect

我在期望脚本中发送命令时遇到问题。我以前从未使用过expect，所以它有很多我不知道的特殊性，主要是关于语法。

实际上它捕获了cpu使用btw。

> 顶部 -n 10 -d 0.01 | awk 'BEGIN{FS="[,%]"; printf "(" }/^Cpu/{ gsub(/[^0-9.,]+/,"",$7); gsub(/^3949/,"",$7); printf $7" + "} END {打印 0") / 10"}' | 公元前

我想做的是：期望，使用命令发送。我想通过脚本传递那个字符串。

我正在尝试这种方式：

```
#!/bin/expect
set timeout 20
set user [lindex $argv 0]
set password [lindex $argv 1]
set host [lindex $argv 2]
set prompt "$ "

;

proc gestat { } {
        ;
        send -- "echo -n 'MEMORY_FREE: ' && free -t | grep 'buffers/cache' | awk '{print \$4/(\$3+\$4) * 100}'\r"
        send -- "top -n 10 -d 0.01 | awk \'BEGIN{FS='[,%]'; printf '(' }/^Cpu/{ gsub(/[^0-9.,]+/,'',\$7); gsub(/^3949/,'',\$7); printf \$7' + '} END{print 0') / 10'}\' | bc\r"

        return
}

;

spawn ssh $user@$host

while (1) {
        expect {
                "(yes/no)? " {
                        send -- "yes\r"
                }

                "password: " {
                        send -- "$password\r"
                }

                "$prompt" {
                        gestat
                        break
                }
        }
}

expect "$prompt"
        send -- "exit\r"

expect eof 
```

但是发送不起作用。错误是：

> 执行“,%”时命令名称“,%”无效（过程“gestat”第 4 行）

我想这将是因为期望“解析器”。但我真的不知道。对不起我糟糕的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T17:47:26.750

由于 expect 是 Tcl 的扩展，所以`[]`字符在双引号字符串中是特殊的。你需要保护他们。

此外，您将在第二次调用 awk 时遇到麻烦——您不能在单引号字符串中嵌入单引号。

您需要使用 Tcl 的`{}`引用 - Tcl 引用字符串中的大括号，例如 shell 使用单引号：

```
send -- {echo -n 'MEMORY_FREE: ' && free -t | grep 'buffers/cache' | awk '{print $4/($3+$4) * 100}'}
send -- \r
send -- {top -n 10 -d 0.01 | awk 'BEGIN{FS="[,%]"; printf "(" }/^Cpu/{ gsub(/[^0-9.,]+/,"",$7); gsub(/^3949/,"",$7); printf $7 " + "} END{print 0 ") / 10"}' | bc}
send -- \r 
```

# jqplot - jqplot - 如何制作 2 条线来缩放相同的基础

> ID：12976085
> 
> 赞同：0
> 
> 时间：2012-10-19T14:10:37.707
> 
> 标签：jqplot

假设我有两组数据：

1) 10 11 15 20 2) 1000 1200 1400 1500

现在我想让它们从同一点开始（就像它们被转换为相同的基础百分比）

所以：1）10 11 15 20 2）10 12 14 15 我可以在 php 中做到这一点，但是悬停框中的值是错误的......

所以总结一下 - 我想从完全相同的点开始制作两条线（就像它们被缩放到基地一样）但是在悬停或标记上以显示两者上的真实数字（想法是比较数据 A 与数据 B 的增长 - 哪一个在百分比值上做得更好，不是绝对的）

感谢您的任何提示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:07:14.037

好的，我想我找到了一个非常好的解决方案：

我隐藏第二组的实际值，添加额外的数据集（现在它的[日期，值（缩放到第一行的基值），real_value（我想在工具提示上显示的那个）]。

但问题是 - 当你想使用工具提示时，它总是包含数据集中的第二个值（在我的情况下是缩放值），所以我想唯一的解决方案是让它在 css xx 中不可见

标记为已回答 - 它已经足够好，找不到更好的了

# hibernate - JBoss arjuna TransactionReaper 不会在超时时回滚

> ID：12976089
> 
> 赞同：2
> 
> 时间：2012-10-19T14:10:52.090
> 
> 标签：hibernate, jboss, transactions, timeout, locks

我正在使用访问 oracle 数据库的应用程序。有时，该数据库上的对象（行）被我的应用程序外部的进程锁定。

我遇到的问题是，当事务达到事务超时时，arjuna 协调器尝试回滚事务但没有成功

堆栈跟踪如下

```
09:15:42,494 WARN  [InterceptorsFactory] EJBTHREE-1246: Do not use InterceptorsF
actory with a ManagedObjectAdvisor, InterceptorRegistry should be used via the b
ean container
09:16:12,287 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio
nReaper_18] - TransactionReaper::check timeout for TX -7ffd9392:a9b:507ff0a4:97
in state  RUN
09:16:12,292 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.BasicActio
n_58] - Abort of action id -7ffd9392:a9b:507ff0a4:97 invoked while multiple thre
ads active within it.
09:16:12,294 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.CheckedAct
ion_2] - CheckedAction::check - atomic action -7ffd9392:a9b:507ff0a4:97 aborting
 with 1 threads active!
09:16:12,789 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio
nReaper_18] - TransactionReaper::check timeout for TX -7ffd9392:a9b:507ff0a4:97
in state  CANCEL
09:16:13,291 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio
nReaper_18] - TransactionReaper::check timeout for TX -7ffd9392:a9b:507ff0a4:97
in state  CANCEL_INTERRUPTED
09:16:13,293 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio
nReaper_6] - TransactionReaper::check worker Thread[Thread-11,5,jboss] not respo
nding to interrupt when cancelling TX -7ffd9392:a9b:507ff0a4:97 -- worker marked
 as zombie and TX scheduled for mark-as-rollback
09:16:13,297 WARN  [arjLoggerI18N] [com.arjuna.ats.arjuna.coordinator.Transactio
nReaper_11] - TransactionReaper::check failed to mark TX -7ffd9392:a9b:507ff0a4:
97  as rollback only 
```

我正在使用 jboss-5.1.0.GA、Hibernate 3.3.1.GA 和 Oracle 9.2.08。

我已经做了几个测试，当行被锁定时，回滚不起作用。自事务超时以来经过的时间无关紧要。如果我在事务超时后解锁该行，则回滚从那一刻开始。

我在网上做了一些研究，但没有发现完全相同的错误。

谢谢。

迭戈。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T12:43:58.093

最后我找到了答案（在stackoverflow上）。它不能解决我的问题（因为正在发生的事情是预期的行为），但可以解释正在发生的事情。

[Transaction TimeOut EJB 对线程的影响](https://stackoverflow.com/questions/6623278/transaction-timeout-ejb-impact-on-the-thread)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T17:51:47.360

在这里，我找到了如何在 jboss 上启用 arjuna 日志记录：

[http://germanogiudici.wordpress.com/2011/09/02/how-to-log-transaction-informations-in-jboss-4-2-3-ga/](http://germanogiudici.wordpress.com/2011/09/02/how-to-log-transaction-informations-in-jboss-4-2-3-ga/)

我希望这有助于获得有关正在发生的事情的更多信息。

直到今天我发现，持有事务的 workerThread 没有在 cancel() 方法上完成。但是根据我当前的日志级别，我看不到发生了什么。

我会在调试后发布更多消息。

注意：jboss 5.1 中 Transactions 的 xml 配置是 jbossts-properties.xml 而不是 jbossjta-properties.xml。

# javascript - 如何清除画布？

> ID：12976092
> 
> 赞同：1
> 
> 时间：2012-10-19T14:10:57.003
> 
> 标签：javascript, html, canvas

嗨，我正在使用画布做一个绘图应用程序，但我不知道如何清除画布。我已经尝试过 clearRect 和其他功能，但它们不起作用。脚本的最后两个函数应该清除画布，但它们不起作用......（对不起我的英语不好）这里的代码：

```
 function clear_canvas_width ()
      {
            var s = document.getElementById ("scribbler");
            var w = s.width;
            s.width = 10;
            s.width = w;
        }

        function clear_canvas_rectangle ()
        {
               var canvas = $('#canvas')[0]; // or document.getElementById('canvas');
               canvas.width = canvas.width;
         } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:25:32.177

需要更多代码才能真正了解问题所在。这是一些*非常*简单的事情，您可以将其缩小范围。同样出于性能原因，最好使用`clearRect`重置画布的宽度。[如何清理画布很重要](http://simonsarris.com/blog/346-how-you-clear-your-canvas-matters)

**[现场演示](http://jsfiddle.net/loktar/u5sDT/)**

```
var clearBut = document.getElementById("clearCan"),
    canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d");

canvas.width = canvas.height = 300;
ctx.fillRect(10,10,280,280);

function clearCanvas(){
    ctx.clearRect(0,0,canvas.width, canvas.height);        
}

clearBut.addEventListener("click", clearCanvas); 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-18T00:21:52.550

从;

[如何清除画布以进行重绘](https://stackoverflow.com/questions/2142535/how-to-clear-the-canvas-for-redrawing)

```
// Store the current transformation matrix
ctx.save();

// Use the identity matrix while clearing the canvas
ctx.setTransform(1, 0, 0, 1, 0, 0);
ctx.clearRect(0, 0, canvas.width, canvas.height);

// Restore the transform
ctx.restore(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-20T16:45:36.940

您是否检查过您是否正在清除正确的画布？也许如果您向我们提供更多代码，我们可以进一步帮助您。

还要确保在清除它后不要在它上面画。

然而，当谈到清理画布时，这是我所知道的最简单的方法。

```
function clear_canvas( canvas ){
    canvas.width = canvas.width;
} 
```

但你也可以使用

```
function clear_canvas (ctx, canvas){
    ctx.clearRect(0, 0, canvas.width, canvas.height); 
} 
```

# javascript - 为什么我的弹窗立即关闭？

> ID：12976093
> 
> 赞同：0
> 
> 时间：2012-10-19T14:10:59.580
> 
> 标签：javascript, jquery, css, jquery-ui

我使用 Jquery UI 在单击时打开一个弹出窗口，但此弹出窗口立即关闭。我不明白为什么？这是我的代码：

```
function openPopUp() {
    //  alert("Handler for .click() called.");
        $("#dialog:ui-dialog").dialog("destroy");
        $("#select-method").dialog({
            modal : true,
            height: 573,
            width: 766 ,
            buttons : {
                Exporter : function() {
                    //$(this).dialog("close");
                     alert("Exporter");
                    // close the dialog
                },
                'Etat de surveillance' : function() {
                    //$(this).dialog("close");
                     alert("Etat de surveillance");
                    // close the dialog
                },
                Annuler : function() {
                    //$(this).dialog("close");
                     alert("Annuler");
                    // close the dialog
                }
            }
        });
    }; 
```

代码html是：

```
<div id="other" class="popLink">This is text
        <a href="" class="popLink" onClick="openPopUp();">
        Click to open pop up
        </a>
</div>

<div class="noDisplay">
        <div id="select-method" title="selection des méthodes et calcul des provisions">My pop upis opened
            </div>
 </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:17:35.737

就像一条评论说的那样，尝试这样的事情：

```
onclick="openPopUp();return false;" 
```

虽然这很有意义，因为您已经在使用 jQuery，将事件与 jQuery 绑定，而不是内联 HTML。而不是指定`onclick`属性，试试这个`$(document).ready`：

```
$(".popLink").click(function (e) {
    e.preventDefault();
    // Either call openPopUp or copy/paste the code from that function into here - depends on how you actually use openPopUp throughout your whole site
}); 
```

但与此同时，您的 HTML 中有一些奇怪的东西 - 具有相同类“popLink”的嵌套 div。这意味着如果您使用我上面的代码，当您单击内部代码时，`showPopUp`将执行两次（因为传播）。所以我想我会在技术上使用这个绑定：

```
$("#other").on("click", ".popLink", function (e) {
    e.preventDefault();
    // Other code
}); 
```

这在技术上将`click`事件绑定到 element `#other`，但仅在由其中具有类“popLink”的元素引起时才执行。还有其他几种方法可以定位`<a>`您想要的，因此这取决于您提供的代码是示例还是真实的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:20:40.357

尝试这个 ：）

```
$('.popLink').click(function(e) {
  e.preventDefault();
  openPopUp();
}); 
```

# javascript - IFrame 导致后退按钮问题

> ID：12976094
> 
> 赞同：4
> 
> 时间：2012-10-19T14:11:06.630
> 
> 标签：javascript, iframe, internet-explorer-8, internet-explorer-7

我目前遇到 IE8/7 问题（我别无选择，我必须在任何人抱怨之前添加对这些的支持），其中带有 youtube 视频的 IFrame 导致在历史记录中添加额外 URL 时出现问题，所以当我回击时在实际返回之前必须执行 2-3 次，我当前的解决方案似乎适用于较新的浏览器，但不是我遇到的两个问题，当前的解决方案是：

```
<script type="text/javascript">
$(document).ready(function () {
    $("iframe").each(function () {
        var ifr_source = $(this).attr('src');
        if (ifr_source.indexOf("youtube") != -1) {
            var parent = $(this).parent();
            var ifr = $(this).detach();
            var wmode = "wmode=transparent";
            if (ifr_source.indexOf('?') != -1) {
                var getQString = ifr_source.split('?');
                var oldString = getQString[1];
                var newString = getQString[0];
                $(this).attr('src', newString + '?' + wmode + '&' + oldString);
            }
            else $(this).attr('src', ifr_source + '?' + wmode);
            ifr.appendTo($(parent));
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:24:47.350

每次更改 iFrame 的`src`属性时，iFrame 都会在窗口的历史记录中注册一个新条目。

有一种方法可以防止这种情况。而不是`.attr('src'...`使用：

```
$("iframe").each(function () {
    (this.contentWindow || this.documentWindow).location.replace('your new url');
}); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:45:43.367

只是在这里回答我自己的问题......

只需将其添加到混合物中

```
 var frame.src = 'javascript:parent.getFrameHTML()' 
```

已解决问题！

# android - 为什么我在工作目录中看不到任何 android 源文件？

> ID：12976095
> 
> 赞同：1
> 
> 时间：2012-10-19T14:11:06.537
> 
> 标签：android, git, version-control, repository, android-source

我正在使用以下命令下载 Android 源代码。

```
repo init -u https://android.googlesource.com/platform/manifest -b Android-4.1.2_r1
repo sync 
```

我几乎下载了大约 1.4 GB 的文件，但工作目录中没有源代码。工作目录只有一个文件夹“.repo”（大约 1.4 GB，似乎不包括源代码）。

这是下载android源代码的正确方法吗？如果没有，我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T17:42:28.327

终于得到了答案。这是应该的！

首先它会填满 .repo 文件夹，该文件夹可能很大（10 GB）。只有在该 repo 脚本下载 android 源代码之后。

参考：

1 [、Repo同步后目录下没有文件](https://stackoverflow.com/questions/4506024/after-repo-sync-there-are-no-files-in-the-directory)

2\. [Android repo 脚本创建的.repo/projects/ 中的裸git 存储库的用途是什么？](https://stackoverflow.com/questions/6151712/what-are-the-purpose-of-the-bare-git-repositories-in-repo-projects-created-by)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:02:34.640

如果您想使用 android，您将需要安装 Android SDK。本页说明如何：

[http://developer.android.com/sdk/installing/index.html](http://developer.android.com/sdk/installing/index.html)

从工具目录中的 SDK 管理器中，您可以下载您想要的任何版本的 Android 源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-07T16:03:00.320

Android 源代码实际上有一个空`master`分支。

除非您指定要回购的特定分支，否则它将始终拉动该`master`分支。

Android 的许多存储库都有一个空`master`分支的原因是，用户应该使用特定版本的 Android 源代码，而不是最新版本。（最新的通常也是一个分支..但不是`master`）

尝试这样的事情
`repo init -u https://android.googlesource.com/platform/manifest -b android-4.0.1_r1`
你应该看到除了 .repo 文件夹以外的文件

# c# - 参数“@xxx”已经定义

> ID：12976100
> 
> 赞同：0
> 
> 时间：2012-10-19T14:11:20.367
> 
> 标签：c#, mysql

我有下面的代码，当它进入 ForEach 循环时，错误就发生了。

我读了这个

[堆栈溢出](https://stackoverflow.com/questions/2925258/sql-error-c-sharp-parameter-already-defined)

但没有成功=\我需要知道我必须改变什么。我试图移动 MySqlCommand，但没有解决问题...谢谢我有 3 种不同的方法（选择、插入、更新）但我必须使用“事务”所以我把 3 种方法放在了同一...第一次它工作正常，但是第二个循环通过错误发生在**INSERT QUERY**

```
#region Querys
        string Select = @"SELECT id_convidado, nome, cod_dependente, dt_insercao, matricula FROM convidado_acesso WHERE debpag = 0 AND status <> 'Devolvido'";

        string Insert = @"INSERT INTO debpag (
                     numero_int,
                     parcela,
                     tipo_pessoa,
                     matricula,
                     cod_dependente,
                     ev_financeiro,
                     quantidade,
                     valor_unitario,
                     valor_total,
                     dt_lancamento,
                     dt_vencimento,
                     dt_pagamento,
                     dt_insercao,
                     dt_insercao_pagamento,
                     referencia,
                     cobrador_lancto,
                     cobrador_pagto,
                     usr_lancto,
                     forma_pagto)
                     VALUES (
                     @numero_int,
                     @parcela,
                     @tipo_pessoa,
                     @matricula,
                     @cod_dependente,
                     @ev_financeiro,
                     @quantidade,
                     @valor_unitario,
                     @valor_total,
                     @dt_lancamento,
                     @dt_vencimento,
                     @dt_pagamento,
                     @dt_insercao,
                     @dt_insercao_pagamento,
                     @referencia,
                     @cobrador_lancto,
                     @cobrador_pagto,
                     @usr_lancto,
                     @forma_pagto)";

        string Update = "UPDATE convidado_acesso SET dt_saida = @dt_saida, usr_saida= @usr_saida, status= @status, debpag = @deb WHERE nome = @nome AND debpag = 0";
        #endregion

        #region MySql
        MySqlConnection conexao = conexao = new MySqlConnection("Server= localhost; Database = crdores; Uid= root;Pwd = ik9rru2j;Allow Zero Datetime = true");
        MySqlCommand cmd = new MySqlCommand();
        cmd.Connection = conexao;
        cmd.CommandType = CommandType.Text;
        cmd.CommandText = Select;
        MySqlDataAdapter da = new MySqlDataAdapter(cmd);
        DataSet ds = new DataSet();
        da.Fill(ds);
        conexao.Open();
        ta = conexao.BeginTransaction();

        #endregion

        try
        {
            #region TratamentoSelect

            List<Convidado> convidado = null;
            Convidado retorno = null;
            if ((ds.Tables.Count > 0) && (ds.Tables[0].Rows.Count > 0))
            {
                convidado = new List<Convidado>();
                foreach (DataRow row in ds.Tables[0].Rows)
                {

                    string status = "";
                    int deb = 0;

                    retorno = new Convidado();
                    try
                    {
                        retorno.Nome = row["nome"].ToString();
                    }
                    catch { }
                    try
                    {
                        retorno.Cod_Dep = Convert.ToInt32(row["cod_dependente"]);
                    }
                    catch { }
                    try
                    {
                        retorno.Dt_Insercao = Convert.ToDateTime(row["dt_insercao"]);
                    }
                    catch { }
                    try
                    {
                        retorno.Matricula = Convert.ToInt32(row["matricula"]);
                    }
                    catch { }
                    try
                    {
                        retorno.Id_Convidado = Convert.ToInt32(row["id_convidado"]);
                    }
                    catch { }

                    #region Variaveis

                    string tmp = BuscaTempoLimite();
                    int z = tmp.Length;
                    string h = tmp.Remove(1, z - 1);
                    string m = tmp.Remove(0, 2);

                    string saida = BuscaHoraServidor();
                    retorno.Dt_Insercao = retorno.Dt_Insercao.AddMinutes(15);
                    string entrada = retorno.Dt_Insercao.ToString("HH:mm");
                    DateTime insercao = Convert.ToDateTime(retorno.Dt_Insercao);
                    DateTime left = Convert.ToDateTime(saida);
                    saida = left.ToString("HH:mm");

                    int horaEntrada = Convert.ToInt32(entrada.Remove(2, 3));
                    int minutosEntrada = Convert.ToInt32(entrada.Remove(0, 3));
                    int horaSaida = Convert.ToInt32(saida.Remove(2, 3));
                    int minutosSaida = Convert.ToInt32(saida.Remove(0, 3));
                    TimeSpan first = new TimeSpan(horaEntrada, minutosEntrada, 0);
                    TimeSpan last = new TimeSpan(horaSaida, minutosSaida, 0);
                    TimeSpan result = last - first;
                    TimeSpan limite = new TimeSpan(Convert.ToInt32(h), Convert.ToInt32(m), 59);

                    int hora = last.Hours - first.Hours;
                    int minutosss = last.Minutes - first.Minutes;

                    result = new TimeSpan(hora, minutosss, 0);
                    #endregion

                    if (left.Day <= insercao.Day)
                    {
                        if (result > limite)
                        {
                            status = "Pago";
                            deb = 0;
                        }
                        else
                        {
                            status = "Devolvido";
                            deb = 2;
                        }
                    }
                    else
                    {
                        status = "Pago";
                    }

            #endregion

                    #region TratamentoInsert

                    cmd.CommandText = Insert;

                    #region váriaveis
                    int cash = 0;
                    string eventoF = "", usre = "", cobrador = "", tmpLimite = "";
                    int ide = 0;
                    ide = PegaMaxID();
                    string insercao_pagto;
                    string dt_lancamento = BuscaHoraServidor();
                    string saidaa = VerificaSaida(Convert.ToInt32(retorno.Id_Convidado));
                    string referencia = retorno.Dt_Insercao.ToString("MM/yyyy");
                    if (saida != "")
                    {
                        insercao_pagto = saida;
                    }
                    else
                    {
                        insercao_pagto = BuscaHoraServidor();
                    }

                    int tipo_pessoa;
                    if (retorno.Cod_Dep > 0)
                    {
                        tipo_pessoa = 3;
                    }
                    else
                    {
                        tipo_pessoa = 1;
                    }

                    retorno.Dt_Insercao = retorno.Dt_Insercao.AddHours(1);
                    retorno.Dt_Insercao = retorno.Dt_Insercao.AddMinutes(15);
                    retorno.Dt_Insercao = retorno.Dt_Insercao.AddSeconds(59);
                    string ent = retorno.Dt_Insercao.ToString("dd/MM/yyyy");
                    #endregion

                    DataSet confg = pag.BuscaConfigs();
                    foreach (DataRow roww in confg.Tables[0].Rows)
                    {
                        eventoF = roww["ev_financeiro"].ToString();
                        cash = Convert.ToInt32(roww["valor"]);
                        usre = roww["usr_insercao"].ToString();
                        tmpLimite = roww["tempo_permanencia"].ToString();
                        cobrador = roww["cod_cobrador"].ToString();
                    }

                    cmd.Parameters.Add(new MySqlParameter("@numero_int", MySqlDbType.Int32)).Value = ide + 1; **//HERE THE ERROR STARTS**
                    cmd.Parameters.Add(new MySqlParameter("@parcela", MySqlDbType.VarChar)).Value = "1/1";
                    cmd.Parameters.Add(new MySqlParameter("@tipo_pessoa", MySqlDbType.Int32)).Value = tipo_pessoa;
                    cmd.Parameters.Add(new MySqlParameter("@matricula", MySqlDbType.Int32)).Value = retorno.Matricula;
                    cmd.Parameters.Add(new MySqlParameter("@cod_dependente", MySqlDbType.Int32)).Value = retorno.Cod_Dep;
                    cmd.Parameters.Add(new MySqlParameter("@ev_financeiro", MySqlDbType.Int32)).Value = eventoF;
                    cmd.Parameters.Add(new MySqlParameter("@quantidade", MySqlDbType.Int32)).Value = 1;
                    cmd.Parameters.Add(new MySqlParameter("@valor_unitario", MySqlDbType.Double)).Value = Convert.ToDouble(cash);
                    cmd.Parameters.Add(new MySqlParameter("@valor_total", MySqlDbType.Double)).Value = Convert.ToDouble(cash);
                    cmd.Parameters.Add(new MySqlParameter("@dt_lancamento", MySqlDbType.Date)).Value = Convert.ToDateTime(dt_lancamento); //  X
                    cmd.Parameters.Add(new MySqlParameter("@dt_vencimento", MySqlDbType.Date)).Value = ent; // X
                    cmd.Parameters.Add(new MySqlParameter("@dt_pagamento", MySqlDbType.Date)).Value = saida; //  X
                    cmd.Parameters.Add(new MySqlParameter("@dt_insercao", MySqlDbType.DateTime)).Value = saida; //  X
                    cmd.Parameters.Add(new MySqlParameter("@dt_insercao_pagamento", MySqlDbType.DateTime)).Value = insercao_pagto; // X
                    cmd.Parameters.Add(new MySqlParameter("@referencia", MySqlDbType.Date)).Value = referencia;
                    cmd.Parameters.Add(new MySqlParameter("@cobrador_lancto", MySqlDbType.VarChar)).Value = cobrador;
                    cmd.Parameters.Add(new MySqlParameter("@cobrador_pagto", MySqlDbType.VarChar)).Value = cobrador;
                    cmd.Parameters.Add(new MySqlParameter("@usr_lancto", MySqlDbType.VarChar)).Value = usre;
                    cmd.Parameters.Add(new MySqlParameter("@forma_pagto", MySqlDbType.Int32)).Value = 1;
                    cmd.ExecuteNonQuery();

                    #endregion

                    #region TratamentoUpdate

                    cmd.CommandText = Update;
                    cmd.Parameters.Add(new MySqlParameter("@dt_saida", MySqlDbType.DateTime)).Value = conv.Dt_Saida;
                    cmd.Parameters.Add(new MySqlParameter("@usr_saida", MySqlDbType.VarChar)).Value = usuario;
                    cmd.Parameters.Add(new MySqlParameter("@status", MySqlDbType.VarChar)).Value = status;
                    cmd.Parameters.Add(new MySqlParameter("@deb", MySqlDbType.Int32)).Value = deb;
                    cmd.Parameters.Add(new MySqlParameter("@nome", MySqlDbType.VarChar)).Value = retorno.Nome;
                    cmd.ExecuteNonQuery();

                    #endregion

                    ta.Commit();

                }
            }
        } 
```

`Cmd.Parameter.Clear()`不是一个好习惯。这是答案。

在 ForEachLoop 之外：

```
Cmd.Parameter.Add(new MySqlParameter("@Hellow", MySqlDataType)); 
```

ForEachLoop 内部

```
Cmd.Parameter["@Hellow"].Value = anyValueOrVariable; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-19T14:18:57.780

您在循环中一遍又一遍地向命令添加相同的参数。例外是告诉你问题。

要么将参数存储在循环之外并重置值，要么每次通过循环清除参数。

最快的解决方案是这样的：

```
 #region TratamentoInsert
                    cmd.Parameters.Clear();//<--clear all the parameters.
                    cmd.CommandText = Insert; 
```

不确定这是否是清除参数集合的确切代码，但我的航班迟到了，无法检查。会是这样的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T14:18:10.073

您正在为`cmd`每个循环添加参数。在您初始化的同一点创建参数`cmd`，或在再次添加之前清除它们。

# unit-testing - Resteasy，用 RestEasy 的服务器端 Mock 框架做一个 Http-Put 或 Http-Post

> ID：12976102
> 
> 赞同：3
> 
> 时间：2012-10-19T14:11:24.823
> 
> 标签：unit-testing, http, rest, jax-rs, resteasy

我写了一个我想测试的 Rest-Service。我想在不运行服务器的情况下运行 JUnit 测试。为此，我使用的是 RestEasy 的服务器端 Mock 框架。

我的问题是，如何使用此框架在 Http-Body 中使用编组的 Java 对象发出 Http-Put 或 Http-Post 请求？

下面的代码对于 Http-Get 运行良好，但是如何进行 Put 或 Post，也许有人得到了一些示例代码？

```
@Test
public void testClient() throws Exception {

    Dispatcher dispatcher = MockDispatcherFactory.createDispatcher();

    POJOResourceFactory noDefaults = new POJOResourceFactory(
            MyClass.class);
    dispatcher.getRegistry().addResourceFactory(noDefaults);

    {
        MockHttpRequest request = MockHttpRequest.get("/message/test/"
                + requestParam);
        MockHttpResponse response = new MockHttpResponse();

        dispatcher.invoke(request, response);
        assertEquals(HttpServletResponse.SC_OK, response.getStatus());

    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-07T13:48:25.160

回复有点晚，但是，可能对某人有一些用处。这就是我通常测试我的 PUT 请求的方式。希望能帮助到你

```
@Test
public void testPUT() throws Exception {      
      POJOResourceFactory noDefaults = new POJOResourceFactory(REST.class);

      Dispatcher dispatcher = MockDispatcherFactory.createDispatcher();
      dispatcher.getRegistry().addResourceFactory(noDefaults);

      String url = "your_url_here";   

      MockHttpRequest request = MockHttpRequest.put(url);
      request.accept(MediaType.APPLICATION_JSON);
      request.contentType(MediaType.APPLICATION_JSON_TYPE);
      // res being your resource object
      request.content(res.toJSONString().getBytes());

      MockHttpResponse response = new MockHttpResponse();
      dispatcher.invoke(request, response);

    Assert.assertEquals( HttpStatus.SC_CREATED,response.getStatus());

} 
```

# python - 任务完成后队列未完成

> ID：12976103
> 
> 赞同：0
> 
> 时间：2012-10-19T14:11:26.070
> 
> 标签：python, multithreading, task-queue

这是我用来测试`Queue`模块的脚本：

```
from Queue import Queue
from threading import Thread

def worker(fruit_queue):

    while True:
        fruit = fruit_queue.get()
        print 'A fruit: ' + fruit
        fruit_queue.task_done()

def main():

    fruits = ['apple', 'orange', 'kiwi', 'banana', 'plum',
              'grape', 'mango', 'cherry', 'lime', 'lemon']

    fruit_queue = Queue()

    print 'Printing fruits...'

    for fruit in fruits:
        fruit_queue.put(fruit)

    for i in range(2):
        t = Thread(target=worker(fruit_queue))
        t.daemon = True
        t.start()

    fruit_queue.join()
    print 'Finished!'

if __name__ == '__main__':
    main() 
```

它工作并创建两个线程，打印每个`fruits`项目一次，但`fruit_queue.join()`似乎永远不会继续，因为`Finished!`永远不会打印结束消息：

```
$ python fruit.py
Printing fruits...
A fruit: apple
A fruit: orange
A fruit: kiwi
A fruit: banana
A fruit: plum
A fruit: grape
A fruit: mango
A fruit: cherry
A fruit: lime
A fruit: lemon 
```

起初我不确定并添加`global fruit_queue`到该`worker()`功能中，但是`SyntaxError: name 'fruit_queue' is local and global`当我运行它时它给了我。

有没有人看到我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:34:59.903

试试看：

```
from Queue import Queue
from threading import Thread

def worker():
    while True:
        fruit = fruit_queue.get()
        print 'A fruit: ' + fruit
        fruit_queue.task_done()

def main():
    fruits = ['apple', 'orange', 'kiwi', 'banana', 'plum',
              'grape', 'mango', 'cherry', 'lime', 'lemon']

    print 'Printing fruits...'

    for i in range(2):
        t = Thread(target=worker)
        t.daemon = True
        t.start()

    for fruit in fruits:
        fruit_queue.put(fruit)

    fruit_queue.join()
    print 'Finished!'

if __name__ == '__main__':
    fruit_queue = Queue()   
    main() 
```

# java - Glassfish 上启用 OSGi 的 Web 应用程序中的 Servlet 过滤器

> ID：12976107
> 
> 赞同：2
> 
> 时间：2012-10-19T14:11:41.090
> 
> 标签：java, servlets, osgi, servlet-filters, wab

我正在 Glassfish Jersey 上创建一些 REST Web 服务。我设法为我的服务创建了 Web 应用程序包。但我需要向它添加一些 Servlet 过滤器。基于 Glassfish，我找不到有关此问题的任何信息。我见过一些使用 Apache Felix Osgi Web Container 的例子，但 Glassfish 根本不使用这个包。对于 osgi web conainer，我使用默认的 Glassfish Fighterfish。

那么我应该如何在 Web 应用程序包上应用 Servlet Filer 呢？

谢谢你的回答:)

PS我不想使用SPRING。但我使用 Apache Aries 蓝图功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T07:41:23.207

您只需将普通的 web.xml 与过滤器和过滤器映射元素一起使用，就像在普通的 servlet 容器中一样。他们应该在 wab 项目中工作。

# ajax - 是否可以在 javascript 中向 Ajax Modal Popup Extender 添加动画？

> ID：12976114
> 
> 赞同：1
> 
> 时间：2012-10-19T14:12:02.870
> 
> 标签：ajax, internet-explorer-8, modalpopupextender

我有一个 ajax 模式弹出窗口，可以为弹出面板设置动画。

在 Firefox 等中一切正常，但在 IE8 中存在一些问题。

1）文本看起来有颗粒感（根据您使用带有文本的过滤器时）。2) 按钮上的悬停状态不起作用。

我试图找到一个解决方案，但努力想出一个答案。也许一种解决方案是尝试从 javascript 调用动画，而不是将其放在 aspx 页面中。

有任何想法吗？

# c# - 将 NativeWindow 用于 ComboBox 会导致 Dispose 方法出现异常

> ID：12976115
> 
> 赞同：3
> 
> 时间：2012-10-19T14:12:04.853
> 
> 标签：c#, dispose, invalidoperationexception, nativewindow

在 C# Windows.Forms 中，我想拦截组合框的粘贴窗口消息。由于这不能通过覆盖组合框的 WndProc 方法来实现，因为我需要覆盖组合框内文本框的 WndProc，所以我决定创建一个 NativeWindow 类型的自定义类来覆盖 WndProc。当组合框句柄被破坏时，我分配句柄并释放它。但是，当调用组合框的 Dispose 时，问题是我得到一个 InvalidOperationException 表示发生了无效的跨线程操作，并且组合框是从创建它的线程以外的线程访问的。任何想法这里出了什么问题？

在下文中，您将看到我的课程的外观：

```
public class MyCustomComboBox : ComboBox
{
    private WinHook hook = null;

    public MyCustomComboBox()
        : base()
    {
        this.hook = new WinHook(this);
    }

    private class WinHook : NativeWindow
    {
        public WinHook(MyCustomComboBox parent)
        {
            parent.HandleCreated += new EventHandler(this.Parent_HandleCreated);
            parent.HandleDestroyed += new EventHandler(this.Parent_HandleDestroyed);
        }

        protected override void WndProc(ref Message m)
        {
            // do something

            base.WndProc(ref m);
        }

        private void Parent_HandleCreated(object sender, EventArgs e)
        {
            MyCustomComboBox cbx = (MyCustomComboBox)sender;

            this.AssignHandle(cbx.Handle);
        }

        private void Parent_HandleDestroyed(object sender, EventArgs e)
        {
            this.ReleaseHandle();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:14:34.987

根据 Hans 的建议，我修改了代码以使用他自己的一个示例中的[CB_GETCOMBOBOXINFO](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/e234c4a7-0cf7-4284-a072-8152f7593002)。

```
public class PastelessComboBox : ComboBox {

    private class TextWindow : NativeWindow {
      [StructLayout(LayoutKind.Sequential)]
      private struct RECT {
        public int Left;
        public int Top;
        public int Right;
        public int Bottom;
      }

      private struct COMBOBOXINFO {
        public Int32 cbSize;
        public RECT rcItem;
        public RECT rcButton;
        public int buttonState;
        public IntPtr hwndCombo;
        public IntPtr hwndEdit;
        public IntPtr hwndList;
      }

      [DllImport("user32.dll", EntryPoint = "SendMessageW", CharSet = CharSet.Unicode)]
      private static extern IntPtr SendMessageCb(IntPtr hWnd, int msg, IntPtr wp, out COMBOBOXINFO lp);

      public TextWindow(ComboBox cb) {
        COMBOBOXINFO info = new COMBOBOXINFO();
        info.cbSize = Marshal.SizeOf(info);
        SendMessageCb(cb.Handle, 0x164, IntPtr.Zero, out info);
        this.AssignHandle(info.hwndEdit);
      }

      protected override void WndProc(ref Message m) {
        if (m.Msg == (0x0302)) {
          MessageBox.Show("No pasting allowed!");
          return;
        }
        base.WndProc(ref m);
      }
    }

    private TextWindow textWindow;

    protected override void OnHandleCreated(EventArgs e) {
      textWindow = new TextWindow(this);
      base.OnHandleCreated(e);
    }

    protected override void OnHandleDestroyed(EventArgs e) {
      textWindow.ReleaseHandle();
      base.OnHandleDestroyed(e);
    }

  } 
```

# c# - 在 Linq 中执行父子排序

> ID：12976118
> 
> 赞同：8
> 
> 时间：2012-10-19T14:12:15.650
> 
> 标签：c#, .net, linq, linq-to-sql

目的是按父项排序列表，然后是子项（只有一个子项）。

```
Example Set:
ID  ParentId Type   Unit
1   NULL    Energy  kJ
2   1       Cal
3   NULL    Protein g
4   NULL    Fat, total  g
5   4       Saturated   g
6   NULL    Carbohydrate    g
7   6       Sugars  g
8   NULL    Dietary fibre   g
10  NULL    Sodium  mg
11  NULL    Potassium   mg 
```

因此，例如，如果我按类型（字母顺序）排序，它会出现

1.  糖类
2.  糖（父母 = 1。）
3.  膳食纤维
4.  活力
5.  卡尔（父母 = 4。）
6.  总脂肪
7.  饱和（父级 = 6。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:32:50.800

尝试这个：

```
return myData.Select(x => new { key = (x.Parent ?? x).Type, item = x})
             .OrderBy(x => x.key)
             .ThenBy(x => x.item.Parent != null)
             .Select(x => x.item); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:37:14.297

这可以分两步完成。首先 - 建立父子层次结构（并对其进行排序）：

```
var query = from parent in data
            where parent.ParentId == null
            orderby parent.Type
            join child in data on parent.ID equals child.ParentId into g
            select new { Parent = parent, Children = g }; 
```

第二——讨人喜欢的层次结构

```
var result = query.Flatten(x => x.Parent, x => x.Children); 
```

为了讨人喜欢，我使用了扩展方法：

```
public static IEnumerable<TResult> Flatten<T, TResult>(
    this IEnumerable<T> sequence, 
    Func<T, TResult> parentSelector,
    Func<T, IEnumerable<TResult>> childrenSelector)
{
    foreach (var element in sequence)
    {
        yield return parentSelector(element);

        foreach (var child in childrenSelector(element))
            yield return child;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:42:58.907

这应该工作

```
var query = from p in context.Table
            from c in context.Table.Where(x => p.ID == x.ParentId)
                                   .DefaultIfEmpty()
            let hasNoParent = c == null
            orderby hasNoParent ? p.Type : c.Type, hasNoParent ? 0 : 1
            select hasNoParent ? p.Type : c.Type; 
```

# java - 在 JSP 中未正确读取 Cookie

> ID：12976119
> 
> 赞同：2
> 
> 时间：2012-10-19T14:12:16.053
> 
> 标签：java, jsp, servlets, cookies

第一次在这里发帖，我希望这是一个有效的问题。我一直在构建一个基本的 Java servlet，它从页面上的表单中接受 3 个名称/值对，将它们设置为 1\. 请求属性 2\. 会话属性和 3\. cookie 属性。然后将 Cookie 添加到响应中，然后转发视图 (AccountSettings.jsp)。AccountSettings 页面应该使用 request.getCookies() 将它们转储到数组中，然后从数组中读取值。每次我使用此表格时，所有这些都应该发生。

我的问题是 cookie 值仅在我第一次使用表单时正确，然后每次我再次使用表单时，cookie 都会显示页面加载时输入的最后一个值。但是，如果我刷新页面，cookie 值将正确显示。我尝试手动删除 Logout servlet 中的 cookie（setMaxAge(0) 然后重新添加到响应），但这只会在索引 1 处产生一个常量 ArrayOutOfBoundsException，所以我将这部分注释掉并单独留下 cookie。

显示页面后，我在 Chrome 中检查了与 localhost 关联的 cookie，并且值设置正确，因此在我看来，JSP 是在实际正确设置 cookie 之前绘制的。

任何有关如何解决此问题的帮助将不胜感激。这是我的代码。

小服务程序：

```
public class Login extends HttpServlet {
private static final long serialVersionUID = 1L;

public Login() {

    super();

}

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    login(request, response);

}

protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    login(request, response);

}

private void login(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException{

    // get a new or existing session
    HttpSession session = request.getSession();

    // Instantiate user and populate values
    User user = new User();
    user.setUser(request.getParameter("user"));
    user.setPass(request.getParameter("pass"));

    // Get last page
    String referringUrl = request.getParameter("referringPage");

    session.setAttribute("user", user.getUser());
    session.setAttribute("pass", user.getPass());
    session.setAttribute("lastPage", referringUrl);

    Cookie cookie1 = new Cookie("user", user.getUser());
    Cookie cookie2 = new Cookie("pass", user.getPass());
    Cookie cookie3 = new Cookie("lastPage", referringUrl);

    response.addCookie(cookie1);
    response.addCookie(cookie2);
    response.addCookie(cookie3);

    request.setAttribute("user", user.getUser());
    request.setAttribute("pass", user.getPass());
    request.setAttribute("lastPage", referringUrl);

    try{

        if (user.authorize()){

            session.setAttribute("name", user.getName());
            session.setAttribute("authorized", "1");

        }else{

            session.setAttribute("authorized", "0");

        }
    }
    catch(Exception e){
        e.printStackTrace();
    }

    RequestDispatcher view = request.getRequestDispatcher("AccountSettings.jsp");
    view.forward(request, response);

    user.destroy();

}

} 
```

看法：

```
<div id="content">
        <div class="padding">

            <%
                if (!loggedIn){
                    out.print(
                        "Oops! I'm not sure how you got here..."
                    );
                }else{
                    Cookie[] cookies = request.getCookies();

                    out.print(
                        "<h2>Account Settings</h2><br><br>" +
                        "<table>" +
                            "<tr>" +
                                "<th>Source</th>" +
                                "<th>Username</th>" +
                                "<th>Password</th>" +
                                "<th>Last Page Visted</th>" +
                            "</tr>" +
                            "<tr>" +
                                "<th>Request</th>" +
                                "<td>" + request.getAttribute("user") + "</td>" +
                                "<td>" + request.getAttribute("pass") + "</td>" +
                                "<td>" + request.getAttribute("lastPage") + "</td>" +
                            "</tr>" +
                            "<tr>" +
                                "<th>Session</th>" +
                                "<td>" + session.getAttribute("user") + "</td>" +
                                "<td>" + session.getAttribute("pass") + "</td>" +
                                "<td>" + session.getAttribute("lastPage") + "</td>" +
                            "</tr>" +
                            "<tr>" +
                                "<th>Cookies</th>" +
                                "<td>" + cookies[1].getValue() + "</td>" +
                                "<td>" + cookies[2].getValue() + "</td>" +
                                "<td>" + cookies[3].getValue() + "</td>" +
                            "</tr>" +
                        "</table>"
                    );

                }
            %>

        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:15:51.730

> *所以在我看来，JSP 是在 cookie 实际设置正确之前绘制的*

这是正确的。您正在向响应中添加新的 cookie（因此它们仅在相同域和路径上的*后续*请求中可用），但您的 JSP 正在尝试从*当前*请求中读取 cookie。

您需要*通过*替换发送重定向而不是转发

```
RequestDispatcher view = request.getRequestDispatcher("AccountSettings.jsp");
view.forward(request, response); 
```

经过

```
response.sendRedirect("AccountSettings.jsp"); 
```

*或者*将 cookie 值复制为请求属性，以便 JSP 可以将它们作为请求属性获取（您已经知道如何做到这一点）。

* * *

**与具体问题无关**，在 cookie 中传递密码是一个非常糟糕的主意。这是一个巨大的安全漏洞。对于您的具体功能要求，您最好将登录用户存储为会话属性。

# c# - 将“数据切换”与 Html.ActionLink 一起使用

> ID：12976120
> 
> 赞同：39
> 
> 时间：2012-10-19T14:12:20.457
> 
> 标签：c#, asp.net-mvc-4, html.actionlink

我想使用带有 actionLink 的“数据切换”。像这样;

```
 Html.ActionLink("Delete", "Users", "Admin", new { item.UserId , strRole = strRole }, new { id = "cmdDelete", href="#myAlert",  data-toggle="modal" }) 
```

可惜，不接受。我如何使用标准链接之类的“数据切换”？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-01-28T14:48:36.080

你不能。但是有一个简单的解决方法。您所做的是，将 - 替换为 _。在运行时，它将被转换为破折号 (-)。所以;

```
Html.ActionLink("Delete", "Users", "Admin", new { item.UserId , strRole = strRole }, new { id = "cmdDelete", href="#myAlert",  data_toggle="modal" }) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-07-28T18:11:07.057

```
 @Html.ActionLink("TextLink", "ActionName", new { id = id }, new { @class = "btn btn-primary", data_toggle = "modal", data_target="#exampleModal" }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-21T14:23:50.533

简单地添加动作链接如下：

```
Html.ActionLink("Delete", "Users", "Admin", new { item.UserId , strRole = strRole }, new { id = "cmdDelete" }) 
```

然后使用 Jquery 如下：

```
$(document).ready(function () {
    $('#cmdDelete').attr('data-target', '#myAlert');
    $('#cmdDelete').attr('data-toggle', 'modal');
}); 
```

# google-app-engine - 带有 Google Eclipse 插件的 Eclipse 中的行为与 Google App Engine 不同

> ID：12976121
> 
> 赞同：0
> 
> 时间：2012-10-19T14:12:34.713
> 
> 标签：google-app-engine, eclipse-plugin

我有一个使用 Google Eclipse 插件在 Eclipse 中创建的 Google App Engine 项目。

当我使用 GAE SDK 在本地运行它的一些服务时，它们工作正常，但是当我在“真正的”Google App Engine 上部署应用程序并尝试访问这些服务中的任何一个时，chrome 会抛出以下错误：

```
Error: Server Error

The server encountered an error and could not complete your request.
If the problem persists, please report your problem and mention this error message and the query that caused it. 
```

另一方面，我在尝试调用上传方法时也在本地收到[**此错误。**](https://docs.google.com/file/d/0B1Lg8GzZGJyLU2VMeXc0ckZfekE/edit)

所有这些都是其他人的项目，它应该可以工作，此外我认为错误与代码无关，因此，我认为将其发布在这里不值得。

# jquery - jQuery ajaxComplete：有没有办法判断哪个 Javascript 函数执行了 ajax 调用？

> ID：12976130
> 
> 赞同：1
> 
> 时间：2012-10-19T14:13:01.293
> 
> 标签：jquery, ajax

我将 .ajaxComplete 事件连接到如下几个元素：

`$("#ElementId").ajaxComplete(function (a, b, c) { });`

问题是`$.ajax`我的脚本中有多个由各种函数调用的调用。我不希望为每个 ajax 调用的每个控件触发 .ajaxComplete 事件。从概念上讲，我正在寻找这样的东西：

`if (a.function == SearchCustomers) { do this }`

有什么办法可以在这里实现我想要的吗？

**编辑：** 我意识到我可以检查我正在调用的服务的 URL，但我不想在我的脚本中多次硬编码 URL 字符串。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T14:35:09.110

**更新**

检查这个演示：http: [//jsfiddle.net/Z6Z5e/4/](http://jsfiddle.net/Z6Z5e/4/)

* * *

您可以在调用的自定义属性中指定函数标识符，并在回调`.ajax()`中使用它的值。`ajaxComplete()`

例如，`'func'`在拨打电话时添加一个属性`.ajax()`：

```
function foo() {
    $.ajax({
        url: '/someurl',
        ...
        func: 'foo',
        ...
    });
} 
```

然后，使用您的价值`ajaxComplete()`

```
$('#someElement').ajaxComplete(function(e, xhr, settings) {
    if (settings.func == 'foo') {
        // ... 
    }
    else if (settings.func == 'bar') {
        // ...
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T14:27:41.393

你必须这样做：

```
$.ajax({
    url: "servicecall.html",
    success: function(html){
        //if success
    };
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T14:28:06.573

就个人而言，我喜欢将我的模块组织在 JS 对象中，而不是出于各种原因将我的 Ajax 调用抽象为函数：

```
​var YourModule = {
    Ajax: {        
        AjaxCallOne: function()
        {
            return $.ajax({
                // your options for the call    
            }).promise();
        },
        AjaxCallTwo: function()
        {
            return $.ajax({
                // your options for the call    
            }).promise();
        }
    },
    Events: {
        OnButtonOneClick: function()
        {
            YourModule.Ajax.AjaxCallOne().then(YourModule.Events.OnAjaxCallOneReceived);
        },
        OnButtonOneClick: function()
        {
            YourModule.Ajax.AjaxCallTwo().then(YourModule.Events.OnAjaxCallTwoReceived);
        },
        OnAjaxCallOneReceived:function(data)
        {
            // your code            
        },
        OnAjaxCallTwoReceived: function(data)
        {
            // your code    
        }
    }            
};​​​ 
```

.then() 正在工作，因为 $.ajax 实现了延迟的“接口”。请参阅此参考： [http ://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

此外，考虑让代码用户能够更改传递给 $.ajax 调用的选项。为此，我使用 $.extend。请参阅此参考： [http ://api.jquery.com/jQuery.extend/](http://api.jquery.com/jQuery.extend/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T14:29:56.627

阿贾克斯调用一：

```
$.ajax({
    // set all your properties as needed
    url: myUrl,
    success: function(data) {
        // handle the result from THIS .ajax call
    }
}); 
```

Ajax 调用二：

```
$.ajax({
    // set all your properties as needed
    url: myotherURL,
    success: function(data) {
        // handle the result from THIS .ajax call
    }
}); 
```

如果你有很多 .ajax 调用需要做同样的事情，那么你可以使用 $.ajaxSetup 来设置一个默认的成功函数

# sql - T-SQL 模式的动态使用

> ID：12976131
> 
> 赞同：3
> 
> 时间：2012-10-19T14:13:03.603
> 
> 标签：sql, sql-server, database, tsql, stored-procedures

有没有一种方法可以省略存储过程中使用的对象的模式，这些对象不绑定到存储过程的模式，而是以相同的存储过程为不同的用户产生不同结果的方式使用的记录模式模式？

为了更好地理解我正在尝试做的事情，下面我将尝试更好地解释。

假设以下数据库：

```
CREATE TABLE [dbo].[SampleTable01] (...)

CREATE TABLE [dbo].[SampleTable02] (...)

CREATE TABLE [dbo].[SampleTable03] (...)

CREATE TABLE [dbo].[SampleTable04] (...) 
```

在这个数据库中，表名后面的数字代表表的所有者（它是一个遗留系统，我无法更改）。

为了将其集成到 .net 实体框架中，我提供了在不同模式中创建同义词的解决方案，因此更改连接字符串我可以更改使用的对象，而无需更改我的数据库上下文或我的编程逻辑。

像这样。

```
CREATE SCHEMA [s01]
CREATE SYNONYM [s01].[SampleTable] FOR [dbo].[SampleTable01]

...

CREATE SCHEMA [s04]
CREATE SYNONYM [s04].[SampleTable] FOR [dbo].[SampleTable04] 
```

此解决方案运行良好，但我需要复制所有使用的存储过程，因为存储过程绑定到特定对象。

当我创建以下存储过程时：

```
CREATE PROCEDURE [dbo].[usp_SampleProc] AS
SELECT * FROM [SampleTable] 
```

存储过程将产生错误，因为`[SampleTable]`schema 中不存在`[dbo]`。

我正在做的是复制存储过程以匹配登录用户的架构。

所以我这样做：

```
CREATE PROCEDURE [s01].[usp_SampleProc] AS
SELECT * FROM [s01].[SampleTable]

...

CREATE PROCEDURE [s04].[usp_SampleProc] AS
SELECT * FROM [s04].[SampleTable] 
```

在不指定架构的情况下执行时，架构中的用户`[s01]`将从`[s01].[SampleTable]`中获取值，架构中的用户将从中`[s04]`获取值，这是我的预期结果。`[s04].[SampleTable]``[usp_SampleProc]`

到目前为止一切顺利，这在我的真实场景中并不高效。我有数千个表、数百个程序和十几个模式（我知道这很难看，但我将遗留系统与 .net 集成，到目前为止，这是我来的最佳解决方案）。

那么，问题又来了：

有没有一种方法可以省略存储过程中使用的对象的模式，这些对象不绑定到存储过程的模式，而是登录用户的模式，相同的存储过程产生不同的结果不同模式的用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T17:29:37.003

这是我知道做我想做的事情的两种方法。

这两种方式对开发人员来说都是透明的，因此他们不需要了解解决方案的复杂性。

下面我创建了一个每个人都可以使用的示例：

**原始遗留数据库创建：**保持不变，因为遗留应用程序仍在使用数据库。

```
CREATE TABLE [dbo].[SampleTable01] (
    value varchar(100)
)
INSERT INTO [dbo].[SampleTable01] VALUES ('[dbo].[SampleTable01]')

CREATE TABLE [dbo].[SampleTable02] (
    value varchar(100)
)
INSERT INTO [dbo].[SampleTable02] VALUES ('[dbo].[SampleTable02]')

CREATE TABLE [dbo].[SampleTable03] (
    value varchar(100)
)
INSERT INTO [dbo].[SampleTable03] VALUES ('[dbo].[SampleTable03]')

CREATE TABLE [dbo].[SampleTable04] (
    value varchar(100)
)
INSERT INTO [dbo].[SampleTable04] VALUES ('[dbo].[SampleTable04]')
GO 
```

**我的应用程序使用的用户和模式分离：**这些是很多重复的代码，但将由应用程序设置生成。

```
CREATE SCHEMA [S01]
GO

CREATE SCHEMA [S02]
GO

CREATE SCHEMA [S03]
GO

CREATE SCHEMA [S04]
GO

CREATE USER USER_S01 WITHOUT LOGIN WITH DEFAULT_SCHEMA = S01
GO

CREATE USER USER_S02 WITHOUT LOGIN WITH DEFAULT_SCHEMA = S02
GO

CREATE USER USER_S03 WITHOUT LOGIN WITH DEFAULT_SCHEMA = S03
GO

CREATE USER USER_S04 WITHOUT LOGIN WITH DEFAULT_SCHEMA = S04
GO

CREATE SYNONYM [S01].[SampleTable] FOR [dbo].[SampleTable01]
CREATE SYNONYM [S02].[SampleTable] FOR [dbo].[SampleTable02]
CREATE SYNONYM [S03].[SampleTable] FOR [dbo].[SampleTable03]
CREATE SYNONYM [S04].[SampleTable] FOR [dbo].[SampleTable04]
GO

GRANT DELETE     ON SCHEMA::[S01] TO [USER_S01]
GRANT EXECUTE    ON SCHEMA::[S01] TO [USER_S01]
GRANT INSERT     ON SCHEMA::[S01] TO [USER_S01]
GRANT REFERENCES ON SCHEMA::[S01] TO [USER_S01]
GRANT SELECT     ON SCHEMA::[S01] TO [USER_S01]
GRANT UPDATE     ON SCHEMA::[S01] TO [USER_S01]
GRANT EXECUTE    ON SCHEMA::[S01] TO [USER_S01]
GO

GRANT DELETE     ON SCHEMA::[S02] TO [USER_S02]
GRANT EXECUTE    ON SCHEMA::[S02] TO [USER_S02]
GRANT INSERT     ON SCHEMA::[S02] TO [USER_S02]
GRANT REFERENCES ON SCHEMA::[S02] TO [USER_S02]
GRANT SELECT     ON SCHEMA::[S02] TO [USER_S02]
GRANT UPDATE     ON SCHEMA::[S02] TO [USER_S02]
GRANT EXECUTE    ON SCHEMA::[S02] TO [USER_S02]
GO

GRANT DELETE     ON SCHEMA::[S03] TO [USER_S03]
GRANT EXECUTE    ON SCHEMA::[S03] TO [USER_S03]
GRANT INSERT     ON SCHEMA::[S03] TO [USER_S03]
GRANT REFERENCES ON SCHEMA::[S03] TO [USER_S03]
GRANT SELECT     ON SCHEMA::[S03] TO [USER_S03]
GRANT UPDATE     ON SCHEMA::[S03] TO [USER_S03]
GRANT EXECUTE    ON SCHEMA::[S03] TO [USER_S03]
GO

GRANT DELETE     ON SCHEMA::[S04] TO [USER_S04]
GRANT EXECUTE    ON SCHEMA::[S04] TO [USER_S04]
GRANT INSERT     ON SCHEMA::[S04] TO [USER_S04]
GRANT REFERENCES ON SCHEMA::[S04] TO [USER_S04]
GRANT SELECT     ON SCHEMA::[S04] TO [USER_S04]
GRANT UPDATE     ON SCHEMA::[S04] TO [USER_S04]
GRANT EXECUTE    ON SCHEMA::[S04] TO [USER_S04]
GO 
```

**解决方案 1（我的选择）：**包括在不同模式中使用相同的过程名称。每个用户一个程序（有自己的模式）。

```
CREATE PROCEDURE [S01].[usp_SampleProc]
AS
SELECT * FROM [SampleTable]
GO

CREATE PROCEDURE [S02].[usp_SampleProc]
AS
SELECT * FROM [SampleTable]
GO

CREATE PROCEDURE [S03].[usp_SampleProc]
AS
SELECT * FROM [SampleTable]
GO

CREATE PROCEDURE [S04].[usp_SampleProc]
AS
SELECT * FROM [SampleTable]
GO 
```

**解决方案 2：**使用动态创建，因为在执行时，表引用将被解析为用户模式内的同义词。

```
GRANT EXECUTE    ON SCHEMA::[dbo] TO [USER_S01]
GRANT EXECUTE    ON SCHEMA::[dbo] TO [USER_S02]
GRANT EXECUTE    ON SCHEMA::[dbo] TO [USER_S03]
GRANT EXECUTE    ON SCHEMA::[dbo] TO [USER_S04]
GO

CREATE PROCEDURE [dbo].[usp_SampleProc]
AS
    exec(N'SELECT * FROM [SampleTable]')
GO 
```

**执行：**两种解决方案完全相同。

```
EXECUTE AS USER = 'USER_S01'
EXEC [usp_SampleProc]
REVERT;

EXECUTE AS USER = 'USER_S02'
EXEC [usp_SampleProc]
REVERT;

EXECUTE AS USER = 'USER_S03'
EXEC [usp_SampleProc]
REVERT;

EXECUTE AS USER = 'USER_S04'
EXEC [usp_SampleProc]
REVERT; 
```

**选择的原因：**我不希望开发人员简化程序的创建和测试。并解决生产中发生的错误。以我决定使用的方式，该过程对于所有模式都是完全相同的。因此，只需使用该模式记录并解决所有模式的问题，就可以轻松测试该模式中发生的问题。

该解决方案的缺点是我不能将模式放在过程中的表中。所以这将是轻微的性能损失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:29:31.560

在某些情况下，您实际上不必选择依赖动态 SQL。

不要创建越来越多的对象，而是尝试动态调用您的表。

它可能看起来像这样：

```
CREATE PROCEDURE [dbo].[usp_SampleProc]
AS
BEGIN
    DECLARE @SQL varchar(MAX)
    set @SQL = 'SELECT col1, col2, ... FROM [SampleTable'+ SUSER_SNAME() +']'
    exec(@SQL)
END 
```

您可能必须转换用户名以适应您的命名约定。

此外，您不应该在这种情况下使用“select *”，因为它没有被编译，如果表结构中有任何修改，您最终可能会感到惊讶。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:18:44.223

如果我是你，我会非常熟悉 SqlCmd.exe（命令行实用程序）和使用变量。

我将尝试将 5 个文件的代码放在下面。我将在代码（文件的内容）之前放置一个标签，文件名如下：

||||||||||||||||||MyFileName.txt||||||||||||||||||

你不会把它放在文件的内容中，但是这个“标记”行下面的所有东西都是文件的内容。您需要完全按照我的方式命名文件。您会将所有文件放在同一目录中。

创建完所有文件后，您需要编辑（一个）.bat 文件并更新一些信息。（主要是您的机器上存在 sqlcmd.exe 的位置，以及您有权使用集成身份验证创建数据库的 sqlserver/实例的名称。

以下是常见的位置：

```
%ProgramFiles%\Microsoft SQL Server\100\Tools\Binn\sqlcmd.exe
%ProgramFiles%\Microsoft SQL Server\90\Tools\Binn\sqlcmd.exe
%ProgramFiles% (x86)\Microsoft SQL Server\90\Tools\Binn\sqlcmd.exe 
```

我们走吧！

||||||||||||||||||MasterRunMeBatFile.bat|||||||||||||||||||

```
REM Find the location of your SQLCMD.EXE
set __sqlCmdLocation=c:\Program Files (x86)\Microsoft SQL Server\90\Tools\binn\SQLCMD.EXE

REM Set your servername/instancename here
set __sqlServerNameAndInstance=MyServerName\MyInstanceName

REM Create the database
"%__sqlCmdLocation%" -i .\DatabaseCreate.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_DatabaseCreateOutput.txt" -v DBName="MyFirstCommandLineDB"

REM Create the multiple Schemas
"%__sqlCmdLocation%" -i .\SchemasCreate.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_SchemasCreate_01.txt" -v DBName="MyFirstCommandLineDB" SchemaName="Schema01"
"%__sqlCmdLocation%" -i .\SchemasCreate.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_SchemasCreate_02.txt" -v DBName="MyFirstCommandLineDB" SchemaName="Schema02"
"%__sqlCmdLocation%" -i .\SchemasCreate.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_SchemasCreate_03.txt" -v DBName="MyFirstCommandLineDB" SchemaName="Schema03"

REM Create the DDL (tables)
"%__sqlCmdLocation%" -i .\OrganizationDDL.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_OrganizationDDL_01.txt" -v DBName="MyFirstCommandLineDB" MySchemaVariable="Schema01" MyUniqueNumber="01" DBUSERNAME="public"
"%__sqlCmdLocation%" -i .\OrganizationDDL.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_OrganizationDDL_02.txt" -v DBName="MyFirstCommandLineDB" MySchemaVariable="Schema02" MyUniqueNumber="02" DBUSERNAME="public"
"%__sqlCmdLocation%" -i .\OrganizationDDL.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_OrganizationDDL_03.txt" -v DBName="MyFirstCommandLineDB" MySchemaVariable="Schema03" MyUniqueNumber="03" DBUSERNAME="public"

REM Create some stored procedures against the multiple schemas
"%__sqlCmdLocation%" -i .\TSQL_USP_UDF_TRG.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_TSQL_USP_UDF_TRG_01.txt" -v DBName="MyFirstCommandLineDB" MySchemaVariable="Schema01" MyUniqueNumber="01" DBUSERNAME="public"
"%__sqlCmdLocation%" -i .\TSQL_USP_UDF_TRG.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_TSQL_USP_UDF_TRG_02.txt" -v DBName="MyFirstCommandLineDB" MySchemaVariable="Schema02" MyUniqueNumber="02" DBUSERNAME="public"
"%__sqlCmdLocation%" -i .\TSQL_USP_UDF_TRG.sql -b -S "%__sqlServerNameAndInstance%"  -E -o ".\ZZZ_TSQL_USP_UDF_TRG_03.txt" -v DBName="MyFirstCommandLineDB" MySchemaVariable="Schema03" MyUniqueNumber="03" DBUSERNAME="public"

set __sqlCmdLocation=
set __sqlServerNameAndInstance= 
```

|||||||||||||||||||DatabaseCreate.sql||||||||||||||||||

```
Use [master];
GO

if exists (select * from sysdatabases where name='$(DBName)')
BEGIN
        DROP DATABASE [$(DBName)];
END

GO

Create Database $(DBName)
GO 
```

||||||||||||||||||SchemasCreate.sql||||||||||||||||||

```
Use [$(DBName)]
GO

IF NOT EXISTS (SELECT 1 FROM sys.schemas WHERE name = '$(SchemaName)')
    BEGIN
        -- The schema must be run in its own batch!
        EXEC( 'CREATE SCHEMA $(SchemaName)' );
    END

IF EXISTS (SELECT 1 FROM sys.schemas WHERE name = '$(SchemaName)')
    BEGIN
            PRINT 'SCHEMA $(SchemaName) Exists!' ;
    END
ELSE
    BEGIN
        PRINT 'Oh My : SCHEMA $(SchemaName) does not exist.' ;
    END

GO 
```

||||||||||||||||||组织DDL.sql||||||||||||||||||

```
Use [$(DBName)]
GO

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'[$(MySchemaVariable)].[Employee$(MyUniqueNumber)]') and OBJECTPROPERTY(id, N'IsUserTable') = 1)
    BEGIN
        DROP TABLE [$(MySchemaVariable)].[Employee$(MyUniqueNumber)]
    END
GO

CREATE TABLE [$(MySchemaVariable)].[Employee$(MyUniqueNumber)]
(
    EmployeeUUID [UNIQUEIDENTIFIER] NOT NULL DEFAULT NEWSEQUENTIALID() , 
    SSN varchar(11) , 
    LastName varchar(24) , 
    FirstName varchar(24) , 
    DateOfBirth smalldatetime 

)

ALTER TABLE [$(MySchemaVariable)].[Employee$(MyUniqueNumber)] ADD CONSTRAINT PK_Employee$(MyUniqueNumber)
PRIMARY KEY NONCLUSTERED (EmployeeUUID)

ALTER TABLE [$(MySchemaVariable)].[Employee$(MyUniqueNumber)] ADD CONSTRAINT CK_Employee$(MyUniqueNumber)_SSN_Unique
UNIQUE (SSN)

GRANT SELECT , INSERT, UPDATE, DELETE ON [$(MySchemaVariable)].[Employee$(MyUniqueNumber)] TO $(DBUSERNAME)
GO

PRINT 'Select * from [$(MySchemaVariable)].[Employee$(MyUniqueNumber)]'
Select * from [$(MySchemaVariable)].[Employee$(MyUniqueNumber)] 
```

||||||||||||||||||TSQL_USP_UDF_TRG.sql||||||||||||||||||

```
Use [$(DBName)]
GO

GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[$(MySchemaVariable)].[uspEmployeeGetAll]') AND type in (N'P', N'PC'))
    DROP PROCEDURE [$(MySchemaVariable)].[uspEmployeeGetAll]
GO

CREATE PROCEDURE [$(MySchemaVariable)].[uspEmployeeGetAll]

AS

SET NOCOUNT ON

SELECT 
    EmployeeUUID , 
    SSN , 
    LastName , 
    FirstName , 
    DateOfBirth
FROM 
    [$(MySchemaVariable)].[Employee$(MyUniqueNumber)] e

SET NOCOUNT OFF

GO

GRANT EXECUTE ON $(MySchemaVariable).[uspEmployeeGetAll] TO $(DBUSERNAME)
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[$(MySchemaVariable)].[uspEmployeeGetAll]') AND type in (N'P', N'PC'))
    PRINT '[$(MySchemaVariable)].[uspEmployeeGetAll] has been created!'
GO

GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[$(MySchemaVariable)].[uspEmployeeGetByUUID]') AND type in (N'P', N'PC'))
    DROP PROCEDURE [$(MySchemaVariable)].[uspEmployeeGetByUUID]
GO

/*
declare @EmployeeUUID uniqueidentifier
select @EmployeeUUID = NEWID() 
exec [$(MySchemaVariable)].[uspEmployeeGetByUUID] @EmployeeUUID
*/

CREATE PROCEDURE [$(MySchemaVariable)].[uspEmployeeGetByUUID]
@EmployeeUUID uniqueidentifier

AS

SET NOCOUNT ON

SELECT 
    EmployeeUUID , 
    SSN , 
    LastName , 
    FirstName , 
    DateOfBirth
FROM 
    [$(MySchemaVariable)].[Employee$(MyUniqueNumber)] e
WHERE 
    e.EmployeeUUID = @EmployeeUUID 

SET NOCOUNT OFF

GO

GRANT EXECUTE ON $(MySchemaVariable).[uspEmployeeGetByUUID] TO $(DBUSERNAME)
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[$(MySchemaVariable)].[uspEmployeeGetByUUID]') AND type in (N'P', N'PC'))
    PRINT '[$(MySchemaVariable)].[uspEmployeeGetByUUID] has been created!'
GO 
```

=============== 结束文件和文件内容======================

行。

在这个练习结束时......你应该有这样的东西。

三表：（在同一个数据库内）

```
[Schema01].[Employee01] , 
[Schema02].[Employee02] , 
[Schema03].[Employee03] 
```

并且存储过程类似于下面的一个。（注意，存储过程的模式名称和它从中提取的表。）

```
ALTER PROCEDURE [Schema01].[uspEmployeeGetAll]

AS

SET NOCOUNT ON

SELECT 
    EmployeeUUID , 
    SSN , 
    LastName , 
    FirstName , 
    DateOfBirth
FROM 
    [Schema01].[Employee01] e 
```

恕我直言。使用带变量的 sqlcmd.exe 是确保不同环境之间完美可重复性的最佳方式。

另一个人的想法：

[http://blogs.msdn.com/tomholl/archive/2008/04/29/thoughts-on-being-a-solution-architect.aspx](http://blogs.msdn.com/tomholl/archive/2008/04/29/thoughts-on-being-a-solution-architect.aspx)

最大限度地减少开发人员需要编写的代码量 开发人员编写代码是有报酬的，而且他们通常都很擅长。但是，一旦为开发人员分配了一大堆需求或故事，他们就需要着手处理这些特定需求，而且他们很难在任何细节级别上跟上其他人正在做的事情。

这可以包括发现不同需求之间的协同作用或宏观级代码重用和重构的机会。架构师工作的很大一部分是在这些机会出现时抓住它们，并确保开发人员不会在他们自己的世界中重新发明轮子。

理想情况下，这应该导致模式、组件和框架允许开发人员通过专注于那些独特的部分来用更少的代码完成他们的需求。

***额外的：***

[http://www.yaldex.com/sql_server_tutorial_3/ch06lev1sec5.html](http://www.yaldex.com/sql_server_tutorial_3/ch06lev1sec5.html)

这就是您开发脚本的方式。但不要忘记注释掉变量设置（在 .sql 文件中），因为文件内容中的变量优先于通过命令行传入的变量。

请就这个问题投票！

[http://connect.microsoft.com/sqlserver/feedback/details/382007/in-sqlcmd](http://connect.microsoft.com/sqlserver/feedback/details/382007/in-sqlcmd)

# c# - 在 .NET (C#) 应用程序中禁用延迟的 DLL 加载功能

> ID：12976133
> 
> 赞同：1
> 
> 时间：2012-10-19T14:13:15.163
> 
> 标签：c#, .net, load, delay

我有一个 .net windows 服务应用程序，它调用我们自己创建的一堆其他 dll。但是，所有这些 dll 都是为 x86 创建的，并且我们已经转移到 Any CPU（在 x64 环境中）。遗憾的是，由于 .NET 的延迟加载功能，除非我们使用一些罕见且有些复杂的代码路径，否则这些 dll 中的许多都不会加载。最终结果？我们在部署代码几天或几周后收到不正确的格式异常。

我想知道是否有一种方法可以强制 .NET 完全加载它直接引用的所有程序集，这样我就可以看到这种不兼容性，而无需手动查看创建这些依赖 dll 的数十个项目，或者更糟糕的是，进行完全回归测试以强制加载所有程序集。

附录：即使有更简单的方法来解决我的特定 x86-dlls-in-a-x64-environment 问题，我仍然有兴趣看看是否有办法强制环境加载其所有依赖项。你永远不知道它什么时候会派上用场！:)

**编辑**：这些都是托管的 DLLS，实际上我已经使用反射来对生产中的问题进行分类。但是，在开发环境中，它遇到了与其他选项相同的问题：以一种或另一种方式手动遍历所有 DLL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:16:54.113

一种方法是使用 ILMerge 静态链接库以将它们合并到可执行文件本身中。否则 DLL 的全部意义在于它们在被用于代码之前不会被评估。请参阅[静态库的 .NET 等效项？](https://stackoverflow.com/questions/1508344/the-net-equivalent-of-static-libraries)

当然，您可以在应用程序加载时运行一个诊断序列，该序列涉及您所有 dll 的某些方面，因此至少您知道加载时哪些内容存在，哪些内容不起作用。

# c# - 如何使用 C# 将消息从 Windows 服务传递到 Windows 桌面应用程序？

> ID：12976140
> 
> 赞同：4
> 
> 时间：2012-10-19T14:13:34.587
> 
> 标签：c#, process, windows-services, windows-process

我想将消息从 Windows 服务传递到已经运行的 Windows 桌面应用程序。我已经在 Windows 服务上实现了一个计时器。一段时间后，服务会向 Windows 应用程序发送一条消息。

服务或发件人代码如下：

```
System.Diagnostics.Process[] lProcs = System.Diagnostics.Process.GetProcessesByName("TestProcess2");

        if (lProcs.Length > 0)
        {
            IntPtr handle = lProcs[0].MainWindowHandle;

            if (handle != IntPtr.Zero)
                SendMessage(handle, 232, IntPtr.Zero, IntPtr.Zero);
        } 
```

和windows桌面应用程序（接收器）代码如下：

```
protected override void WndProc(ref Message m)
    {
        if (m.Msg == 232)
        {
            MessageBox.Show("Received");
        }
        else
        {
            base.WndProc(ref m);
        }
    } 
```

当两个进程都是 Windows 桌面应用程序时，上面的代码工作正常。当我使用 Windows 服务作为发件人时，Windows 桌面应用程序进程无法接收该消息。你能帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T17:33:51.230

该服务和桌面应用程序在两个不同的窗口站中运行。出于安全原因，不可能在不同窗口站中运行的应用程序之间发送窗口消息。

为了在服务和桌面应用程序之间进行通信，您必须使用某种进程间通信方法（很好的可能性是套接字、命名管道、DCOM 等）或在其中一种之上运行的某些框架，例如远程处理或 WCF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:20:22.427

我怀疑这是因为这两个进程在不同的用户帐户下运行。

我认为您需要使用更改消息过滤器功能才能接收到它，请参见此处：

[ChangeWindowMessageFilterEx 函数](http://msdn.microsoft.com/en-us/library/dd388202%28v=vs.85%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:36:13.290

一种方法是在您的服务中托管 WCF 接口。然后，这允许（可能）任何应用程序和服务之间进行通信。

查看这些链接以获取详细示例：

[http://www.codeproject.com/Articles/38160/WCF-Service-Library-with-Windows-Service-Hosting](http://www.codeproject.com/Articles/38160/WCF-Service-Library-with-Windows-Service-Hosting) http://msdn.microsoft.com/en-us/library/ms733069.aspx

# c++ - 如何摆脱 temp 并使用一次转换来完成工作？

> ID：12976141
> 
> 赞同：2
> 
> 时间：2012-10-19T14:13:49.283
> 
> 标签：c++

```
 vector<double> result(vectorOfClassA.size());
 vector<classB> temp(vectorOfClassA.size());
 std::transform(vectorOfClassA.begin(), vectorOfClassA.end(), back_inserter(temp),
                std::tr1::bind(&A::memberVariableOfClassB, std::tr1::placeholders::_1));
 std::transform(temp.begin(), temp.end(), back_inserter(result),
                 std::tr1::bind(&B::getValue, std::tr1::placeholders::_1)); 
```

我喜欢使用一种转换，但它无法编译

```
std::transform(vectorOfClassA.begin(), vectorOfClassA.end(), back_inserter(result),
               std::tr1::bind(&B::getValue,
                              std::tr1::bind(&A::memberVariableOfClassB,
                                             std::tr1::placeholders::_1))); 
```

这`double getValue()`是B类成员函数。怎么做或我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:20:01.747

如果您的编译器支持 C++11，则可以使用 lambda：

```
std::transform(vectorOfClassA.begin(), vectorOfClassA.end(), 
  back_inserter(result),
  [] (const A& a)
  {
  return a.memberVariableOfClassB.GetValue();
  }); 
```

# php - 在值文件上传器上添加水印

> ID：12976143
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:13:51.997
> 
> 标签：php

嗨，我在我的网站[http://fineuploader.com/上使用了这个上传脚本](http://fineuploader.com/)

```
<?php

 /**
 * Handle file uploads via XMLHttpRequest
 */
 class qqUploadedFileXhr {
/**
 * Save the file to the specified path
 * @return boolean TRUE on success
 */
function save($path) {    
    $input = fopen("php://input", "r");
    $temp = tmpfile();
    $realSize = stream_copy_to_stream($input, $temp);
    fclose($input);

    if ($realSize != $this->getSize()){            
        return false;
    }

    $target = fopen($path, "w");        
    fseek($temp, 0, SEEK_SET);
    stream_copy_to_stream($temp, $target);
    fclose($target);

    return true;
}
function getName() {
    return $_GET['qqfile'];
}
function getSize() {
    if (isset($_SERVER["CONTENT_LENGTH"])){
        return (int)$_SERVER["CONTENT_LENGTH"];            
    } else {
        throw new Exception('Getting content length is not supported.');
    }      
}   
}

   /**
   * Handle file uploads via regular form post (uses the $_FILES array)
    */
      class qqUploadedFileForm {  
/**
 * Save the file to the specified path
 * @return boolean TRUE on success
 */
function save($path) {
    if(!move_uploaded_file($_FILES['qqfile']['tmp_name'], $path)){
        return false;
    }
    return true;
}
function getName() {
    return $_FILES['qqfile']['name'];
}
function getSize() {
    return $_FILES['qqfile']['size'];
}
 }

 class qqFileUploader {
private $allowedExtensions = array();
private $sizeLimit = 10485760;
private $file;

function __construct(array $allowedExtensions = array(), $sizeLimit = 10485760){        
    $allowedExtensions = array_map("strtolower", $allowedExtensions);

    $this->allowedExtensions = $allowedExtensions;        
    $this->sizeLimit = $sizeLimit;

    $this->checkServerSettings();       

    if (isset($_GET['qqfile'])) {
        $this->file = new qqUploadedFileXhr();
    } elseif (isset($_FILES['qqfile'])) {
        $this->file = new qqUploadedFileForm();
    } else {
        $this->file = false; 
    }
}

private function checkServerSettings(){        
    $postSize = $this->toBytes(ini_get('post_max_size'));
    $uploadSize = $this->toBytes(ini_get('upload_max_filesize'));        

    if ($postSize < $this->sizeLimit || $uploadSize < $this->sizeLimit){
        $size = max(1, $this->sizeLimit / 1024 / 1024) . 'M';             
        die("{'error':'increase post_max_size and upload_max_filesize to $size'}");    
    }        
}

private function toBytes($str){
    $val = trim($str);
    $last = strtolower($str[strlen($str)-1]);
    switch($last) {
        case 'g': $val *= 1024;
        case 'm': $val *= 1024;
        case 'k': $val *= 1024;        
    }
    return $val;
}

/**
 * Returns array('success'=>true) or array('error'=>'error message')
 */
function handleUpload($uploadDirectory, $replaceOldFile = FALSE){
    if (!is_writable($uploadDirectory)){
        return array('error' => "Server error. Upload directory isn't writable.");
    }

    if (!$this->file){
        return array('error' => 'No files were uploaded.');
    }

    $size = $this->file->getSize();

    if ($size == 0) {
        return array('error' => 'File is empty');
    }

    if ($size > $this->sizeLimit) {
        return array('error' => 'File is too large');
    }

    $pathinfo = pathinfo($this->file->getName());
    $filename = $pathinfo['filename'];  
    $filename = date("Ymdhis").md5($pathinfo['filename']);
    $ext = $pathinfo['extension'];

    if($this->allowedExtensions && !in_array(strtolower($ext), $this->allowedExtensions)){
        $these = implode(', ', $this->allowedExtensions);
        return array('error' => 'File has an invalid extension, it should be one of '. $these . '.');
    }

    if(!$replaceOldFile){
        /// don't overwrite previous files that were uploaded
        while (file_exists($uploadDirectory . $filename . '.' . $ext)) {
            $filename .= rand(10, 99);
        }
    }

    if ($this->file->save($uploadDirectory . $filename . '.' . $ext)){
        return array('success'=>true, 'filename'=>$filename . '.' . $ext, 'filethumb'=>'/img/Garotas/'.$filename . '.' . $ext);
    } else {
        return array('error'=> 'Could not save uploaded file.' .
            'The upload was cancelled, or server error encountered');
    }

}    
 }

    // list of valid extensions, ex. array("jpeg", "xml", "bmp")
   $allowedExtensions = array();
    // max file size in bytes
      $sizeLimit = 10 * 1024 * 1024;

   $uploader = new qqFileUploader($allowedExtensions, $sizeLimit);
    $result = $uploader->handleUpload('../../img/Garotas/');
    // to pass data through iframe you will need to encode all html tags
       echo htmlspecialchars(json_encode($result), ENT_NOQUOTES); 
```

所以我想在将图像保存到目标文件夹之前在图像上添加水印，任何人都可以帮我解决这个问题，我尝试使用几个脚本，但我肯定不知道如何实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:43:15.957

看，类中的`save`方法`qqUploadedFileForm`，将上传的文件移动到`$path`，
所以，如果我决定简单地解释一下，在语句结束后，您可以使用以下教程`if`获取上传的文件并添加水印：`$path`

*   [文字水印](http://www.phpjabbers.com/put-watermark-on-images-using-php-php20.html)
*   [图像水印](http://www.php.net/manual/en/image.examples.merged-watermark.php)

**注意：**
查看 to`imagepng()`或`imagejpeg()`语法以了解如何**替换**准备好的图像。
您还可以使用 替换`watermark-image`为`source-image``copy('/address/to/watermark-image', '/address/to/source-image');`

您可能还需要考虑：[watermark-all-your-uploaded-images](http://dolcepixel.com/how-to-watermark-all-your-uploaded-images/) 教程。

# json - 没有 _id 字段的 mongoexport

> ID：12976145
> 
> 赞同：29
> 
> 时间：2012-10-19T14:13:58.863
> 
> 标签：json, mongodb

我正在使用 mongoexport 将一些数据导出到 .json 格式的文件中，但是该文档具有由 _id:IDVALUE 元组引入的大尺寸开销。

我发现了一个类似的帖子[Is there a way to retrieve data from MongoDB without the _id field?](https://stackoverflow.com/questions/5594436/is-there-a-way-to-retrieve-data-from-mongodb-without-the-id-field) 关于如何在从 mongo 检索数据时省略 _id 字段，但不导出。建议使用：`.Exclude("_id")`。我试图 reqrite mongoexport 的 --query 参数以某种方式包含该`.Exclude("_id")`参数，但到目前为止所有尝试都失败了。

请建议这样做的正确方法是什么，或者我应该恢复使用一些导出后技术吗？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-05-07T18:17:49.650

似乎没有办法`_id`使用 mongoexport 排除字段（例如 ）。

这是一个在中等大小的数据库上对我有用的替代方案：

```
mongo myserver/mydb --quiet --eval "db.mycoll.find({}, {_id:0}).forEach(printjson);" > out.txt 
```

在大型数据库（数百万条记录）上，它可能需要一段时间，运行它会影响人们尝试在系统上执行的其他操作：

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-04-18T09:05:33.333

这有效：

```
mongoexport --db db_name --collection collection_name | sed '/"_id":/s/"_id":[^,]*,//' > file_name.json 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-08-31T15:35:52.543

我知道您指定要以 JSON 格式导出，但如果您可以替换 CSV 数据，则本机 mongo 导出将起作用，并且比上述解决方案快很多

```
mongoexport --db <dbName> --collection <collectionName> --csv --fields "<fieldOne>,<fieldTwo>,<fieldThree>" > mongoex.csv 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-10-09T11:05:53.343

将输出管道输入`mongoexport`并`jq`删除`_id`那里的字段。

```
mongoexport --uri=mongodb://localhost/mydb --collection=my_collection \
  | jq 'del(._id)' 
```

**更新**：添加[到 jq 的链接](https://stedolan.github.io/jq/)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-06-01T17:53:49.077

`mongoexport`似乎没有这样的选择。

使用[ramda-cli](https://github.com/raine/ramda-cli)剥离`_id`将如下所示：

```
mongoexport --db mydb --collection mycoll -f name,age | ramda 'omit ["_id"]' 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-08-27T15:42:03.517

我应用了 quux00 的解决方案，但在输出中`forEach(printjson)`打印了[MongoDB 扩展 JSON](http://docs.mongodb.org/manual/reference/mongodb-extended-json/)表示法（例如`"last_update" : NumberLong("1384715001000")`.

最好使用以下行：

```
db.mycoll.find({}, {_id:0}).forEach(function (doc) {

    print( JSON.stringify(doc) );
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-20T03:06:14.803

```
mongo <server>/<database> --quiet --eval "db.<collection>.find({}, {_id:0,<field>:1}).forEach(printjson);" > out.txt 
```

如果您有一些查询要执行更改`""`并将您的`''`条件写入like 。`find``""``find("age":13)`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-28T06:38:16.080

排除“_id”等子文档信息最简单的方法就是将其导出为csv，然后使用工具将csv转换为json。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-10-30T04:09:12.580

只需在 mongoexport 命令中使用**--type=csv选项。**

```
mongoexport --db=<db_name> --collection=<collection_name> --type=csv --field=<fields> --out=<Outfilename>.csv 
```

对于 MongoDb 3.4 版，您也可以在 mongoexport 命令中使用**--noHeaderLine**选项来排除 csv 导出中的字段标题。

详情：[https ://docs.mongodb.com/manual/reference/program/mongoexport/](https://docs.mongodb.com/manual/reference/program/mongoexport/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-25T21:28:08.090

在我的情况下，导出到文件中并使用正则表达式替换空值

```
"_id": "f5dc48e1-ed04-4ef9-943b-b1194a088b95" 
```

我用过`"_id": "(\w|-)*"`，

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-04-13T02:28:45.887

**mongoexport**不能省略“_id”

**sed**是一个强大的命令：

```
mongoexport --db mydb --collection mycoll -f name,age | sed '/"_id":/s/"_id":[^,]*,//' 
```

原始答案来自[使用 MongoExport 命令的 Exclude _id 字段](https://groups.google.com/forum/#!topic/mongodb-user/HwM2ccw5dW4)

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2012-10-19T14:33:42.390

您是否尝试过使用`--fields`标志指定字段？未提及的所有字段都从[导出](http://docs.mongodb.org/manual/reference/mongoexport/)中排除。

为了可维护性，您还可以将字段写入单独的文件并使用`--fieldFile`.

# php - 与 Eclipse RSE 的连续 SSH 连接

> ID：12976147
> 
> 赞同：2
> 
> 时间：2012-10-19T14:14:04.773
> 
> 标签：php, eclipse

我想在开发服务器上用 PHP 进行远程开发。Eclipse RSE 非常适合这一点。但访问我的开发服务器的唯一方法是建立与防火墙的 SSH 连接，然后与虚拟服务器建立连接。无论如何设置 Eclipse RSE 来做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-25T11:20:09.140

我通过 SFTP 使用 netbeans 远程选项做同样的事情，你也可以 coos ftp 对我来说很好。

# parsing - 解析以太网帧

> ID：12976149
> 
> 赞同：1
> 
> 时间：2012-10-19T14:14:18.040
> 
> 标签：parsing, frame, ethernet

我有以太网帧，我想从这些帧中获取特定端口上的 TCP 有效负载。

我该怎么办？是否有可用于解析帧和 tcp 的库？

平台是Linux。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:25:40.003

也许尝试查看 libpcap/winpcap/jpcap 的库或获得一些想法。

或者假设帧是最简单的形式（没有加密，没有 802.1Q，没有......等），它们看起来像这样：

dmac(6)+smac(6)+etype(2)+IP_hdr(20)+TCP_src_port(2)+TCP_dst_port(2)

您可以在帧偏移处相应地匹配您的 tcp dst 端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:18:40.420

基本上，您需要首先删除以太网标头。接下来，删除 IP 标头，最后删除 TCP 标头。但是，可以在 MAC 或 IP 层进行加密。在这种情况下，您需要先解密数据，然后才能删除标头并提取有效负载。无论如何，这是一个非常广泛的问题；您应该熟悉[http://en.wikipedia.org/wiki/OSI_model](http://en.wikipedia.org/wiki/OSI_model) 我确信 Linux 中已经准备好可以满足您要求的库（前提是没有加密或您可以解密）

# microsoft-metro - 获取静态 PropertyInfo .Net “Core” 4.5

> ID：12976150
> 
> 赞同：0
> 
> 时间：2012-10-19T14:14:29.143
> 
> 标签：microsoft-metro, windows-runtime

如何在新的 for-apps .Net 配置文件中使用 FlattenHierachy 获取所有静态属性的 PropertyInfo？

我想要这段代码，但对于 App-.Net：

```
const BindingFlags bindingFlags = BindingFlags.Public | BindingFlags.Static | BindingFlags.FlattenHierarchy;
return type.GetProperties(bindingFlags); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:16:07.143

所有这些测试都在 Win8 RTM/.Net Core 4.5 上通过。

```
namespace Automatonymous.Tests
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using NUnit.Framework;
    using System.Reflection;

    class SuperTarget
    {
        public static string StaticProp { get; set; }
        public string InstanceProp { get; set; }
    }

    class SubTarget
        : SuperTarget
    {
        public string AnotherProp { get; private set; }
    }

    class PrivateStatics
        : SuperTarget
    {
        static string CanWeGetPrivates { get; set; }
    }

    class StaticsNoGetter
        : SuperTarget
    {
        public static string ZupMan { set; private get; }
    }

    [TestFixture]
    public class when_getting_static_properties
    {
        [Test]
        public void can_get_property_on_stand_alone_class()
        {
            var props = GetAllStaticProperties(typeof(SuperTarget));
            Assert.That(props.Count(), Is.EqualTo(1));
            Assert.That(props.First().Name, Is.EqualTo("StaticProp"));
        }

        [Test]
        public void can_get_single_property_on_super_from_sub()
        {
            var props = GetAllStaticProperties(typeof(SubTarget));
            Assert.That(props.Count(), Is.EqualTo(1));
            Assert.That(props.First().Name, Is.EqualTo("StaticProp"));
        }

        [Test]
        public void can_get_private_static_properties()
        {
            var props = GetAllStaticProperties(typeof(PrivateStatics));
            Assert.That(props.Count(), Is.EqualTo(2));
            var names = props.Select(x => x.Name);
            CollectionAssert.Contains(names, "CanWeGetPrivates");
            CollectionAssert.Contains(names, "StaticProp");
        }

        [Test]
        public void can_get_even_with_private_getter()
        {
            var props = GetAllStaticProperties(typeof(StaticsNoGetter));
            Assert.That(props.Count(), Is.EqualTo(2));
            var names = props.Select(x => x.Name);
            CollectionAssert.Contains(names, "ZupMan");
            CollectionAssert.Contains(names, "StaticProp");
        }

        [Test]
        public void can_get_with_no_hierarchy()
        {
            var props = GetAllStaticProperties(typeof(StaticsNoGetter), false);
            Assert.That(props.Count(), Is.EqualTo(1));
            Assert.That(props.First().Name, Is.EqualTo("ZupMan"));
        }

        static IEnumerable<PropertyInfo> GetAllStaticProperties(Type type, 
            bool flattenHierachy = true)
        {
            var info = type.GetTypeInfo();

            if (info.BaseType != null && flattenHierachy)
                foreach (var prop in GetAllStaticProperties(info.BaseType, true))
                    yield return prop;

            var props = info.DeclaredMethods
                            .Where(x => x.IsSpecialName && x.Name.StartsWith("get_") && x.IsStatic)
                            .Select(x => info.GetDeclaredProperty(x.Name.Substring("get_".Length)));

            foreach (var propertyInfo in props)
                yield return propertyInfo;
        }
    }
} 
```

# objective-c - NSTableView.clickedRow 更改时收到通知？

> ID：12976158
> 
> 赞同：2
> 
> 时间：2012-10-19T14:14:48.020
> 
> 标签：objective-c, nstableview, right-click

我正在为 NSTableView 寻找类似的东西，但是它无法正常工作。我想我会在显示行之前使用此信息来修改 NSMenu。

```
[self addObserver:self forKeyPath:@"tableview.selectedRow" options:NSKeyValueObservingOptionNew context:NULL]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T16:44:21.713

我也在寻找一种更好的方法来做到这一点，但是你可以做的一件事可能比你提出的解决方案更好一点，那就是继承 NSTableView。然后，您可以从您的子类中使用`[self setAction:@selector(clickedTableView)]`该方法，然后以这种方式`[[NSNotificationCenter defaultCenter] postNotification...];`发送通知。`self.clickedRow`然后，您可以传入`userInfo`通知。

# java - Java 接口的实现应该驻留在哪个包中？

> ID：12976159
> 
> 赞同：5
> 
> 时间：2012-10-19T14:14:49.970
> 
> 标签：java, interface, package

假设我有一个界面：

```
package org.my.dicom.CEchoSCU;

public interface CEchoSCU {
    // stuff here...
} 
```

我还将有一个接口的实现：

```
public class SimpleCEchoSCU implements CEchoSCU {
    // stuff here...
} 
```

我的问题是，哪个包应该包含实现？我见过其他开发人员将实现与接口放在同一个包中（`org.my.dicom`在本例中为 ），以及使用单独包的情况（通常类似于`org.my.dicom.impl`）。除了个人喜好之外，还有什么理由更喜欢其中一个吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:18:46.787

好吧，关于您将`implementation`班级和`interface`. 您可以将它们放在任何包中，只要它们可以在应有的位置访问即可。

但是，当然，您也希望将您`related classes`的所有内容合而为一`package`，而`class`这`not related`对您`set of classes`来说是`different package`。

**大多数时候，我的方法是**： - 我将我`interfaces`的 in a`different package`和`implementing classes`in保存起来`different package`。这样，如果我想将我的接口提供给其他人，那么我可以直接放弃包含我所有接口的包。

但同样，这完全取决于您的要求，以及您在代码中遵循的设计实践。

所以我选择的包名一般是：-

*   `com.someName.api` -> 对于接口
*   `com.someName.impl`-> 用于实现类。

这样我就可以轻松地将 my`api`与`implementation`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T14:27:36.520

一个类实现了一个接口，**等等。**我会将类放在与类的其余部分所做/包含的内容相关的包中，而不是反映它实现的一个接口的包中。例如，如果我有 200 个实现 Printable 的类，我不会将它们全部放在一个包 com.mycompany.impl.printable 中。实现 printable 的 Airplane 类将与其他飞机的东西放在一个包中。船类将与其他船的东西放在一个包中。实现 Printable 的 Car 类将与其他汽车材料放在一个包中。

如果所有 SimpleCEchoSCU（以及任何其他未来类）都实现了 CEchoSCU，那么您应该考虑将 CEchoSCU 设为抽象基类并派生不同的实现。无论哪种方式，（接口或抽象基类）事物都是完全相关的，我会将它们放在同一个包中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T14:49:00.933

我通常遵循以下规则：

*   如果要提供通用实现，请将它们放在同一个包中（例如 List 和 ArrayList）
*   如果您有可重用的实现，但例如针对不同的技术或不同的业务功能，请将它们放在单独的包中
*   如果您有私有实现，其他人不应直接实例化，请将它们放在 *.impl 或 *.internal 包中。这对于 OSGi 包来说很常见。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T14:17:38.720

我更喜欢将实现放在具有这样名称的包中：

```
path.to.package.of.interface.impl 
```

然而，我不认为这是一个普遍的惯例，我猜它是特定于开发软件的组织的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-19T14:17:42.043

包通常是一个偏好和组织问题。有些地方会使用构建脚本来过滤掉 API 接口，例如，如果它们位于实现的单独包中，这可能更容易做到。真的，我认为主要的事情是保持一致，这样人们就知道会发生什么（除非您使用的工具或脚本会对您施加限制）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-19T14:23:13.277

将实现类放在任何包中都没有错。不会有任何编译错误。但是，这取决于项目代码设置放置 impl 类的位置。在大多数情况下，实现类将与接口在同一个包中。

但是，接口可以由不同种类的类实现，因此在这种情况下，实现类和接口将位于不同的包中。

例子是一个接口`Bounceable`可以被实现`Ball`，`Jelly`甚至是一个`Car`！

# regex - Notepad ++中的正则表达式在字符串之前查找缺失的单词

> ID：12976161
> 
> 赞同：0
> 
> 时间：2012-10-19T14:15:11.780
> 
> 标签：regex, notepad++, replace

我有一些 html 文件，我想在这些词中找到它们：

```
id="s" 
```

在他们面前没有这个标签

```
<div 
```

如果没有，正则表达式会添加它，所以结果是：

```
<div id="s" 
```

并保留 div 之前或 id="s" 之后的所有内容。

鉴于：

*   id="s" 前面可以有空格或制表符
*   它后面有一些词
*   缺少的 "< div" 可能在它之前的一行或在 id="s" 之前的同一行中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:39:08.377

最简单的方法可能是搜索所有出现的任何一个`<div id="s"`或`id="s"`后面的任何空格，并将其中一个替换为`<div id="s"`. （也就是说，与其先查找`id="s"`然后再向后查找，不如将其`<div`包含`<div`在搜索中。）

查找内容：`<div\s*id="s"|\s*id="s"`
替换为：`<div id="s"`

前：

```
test
test <div
id="s"
test
id="s"
test <div id="s"
test    id="s"
<div    id="s"
test   id="s"
<div  id="s" 
```

全部替换后：

```
test
test <div id="s"
test<div id="s"
test <div id="s"
test<div id="s"
<div id="s"
test<div id="s"
<div id="s" 
```

您可以在搜索和替换字段中添加前导空格，也可以再通过一次将所需的空间放回`test<div id="s"`.

# mysql - 使用复杂查询的排名系统：更精确的过滤器

> ID：12976162
> 
> 赞同：2
> 
> 时间：2012-10-19T14:15:16.303
> 
> 标签：mysql, sql, subquery, ranking

为了在我的游戏服务器上实现排名系统，我将每个玩家的一些信息存储在 MySQL 数据库中。我有以下数据库表。

`players`带有示例数据的表格：

```
id | steamId | deaths
---+---------+-------
1  | asdja   | 2
2  | kfjsl   | 5 
```

`weapons`带有示例数据的表格：

```
playerId | weaponId | kills
---------+----------+------
1        | 5        | 8
1        | 9        | 7
2        | 3        | 3
2        | 6        | 10
2        | 7        | 2 
```

您会看到我没有将每个玩家的击杀数存储在`players`-table 中，因为我可以简单地从`weapons`-table 计算它。我对 SQL 查询不是很熟悉，但我完成了创建以下查询以选择具有以下字段的简单数据集：

```
kills,
deaths,
kill-death-rate (kdrate),
count (maximum number of players),
rank (current ranking position, sorted by kills) 
```

查询：

```
SELECT
    SUM(weapons.kills) AS `kills`,
    `deaths`,
    (SUM(kills) / IF(deaths, deaths, 1)) AS `kdrate`,
    (SELECT COUNT(*) FROM `players`) AS `count`,
    (
        SELECT
            COUNT(*)
        FROM
            (
                SELECT
                    p.id AS id2,
                    SUM(w.kills) AS kills2,
                    p.deaths AS deaths2,
                    p.steamId AS steamId2
                FROM
                    weapons AS w,
                    players AS p
                WHERE
                    p.id = w.playerId
                GROUP BY
                    p.id
            ) AS temp
        WHERE
            temp.kills2 >= (
                SELECT
                    SUM(weapons.kills) AS `kills`
                FROM
                    `players`,
                    `weapons`
                WHERE
                    players.id = weapons.playerId AND
                    `id` = 1
                GROUP BY
                  `id`
            )
        ORDER BY
            temp.kills2 DESC,
            temp.deaths2 ASC,
            temp.steamId2 ASC
    ) AS `rank`
FROM
    `players`
INNER JOIN
    `weapons`
ON
    players.id = weapons.playerId
WHERE
    `id` = 1
GROUP BY
    `id` 
```

有两个问题：

1.) 查询很糟糕。

2.) 使用给定的示例数据执行此查询会导致“相同排名”。我的意思是，两个玩家的排名相同，因为我的两个玩家的击杀数量相同。但是相反，玩家 1 应该排在 1 位，因为他的死亡人数比玩家 2 少。我不知道我怎么能意识到这一点。

提前致谢！

编辑：@Manueru_mx 给了我一个基本的想法：根据他的回答，我得到了以下代码：

```
SELECT
    id,
    kills,
    deaths,
    kdrate,
    COUNT(*) AS rank,
    (SELECT COUNT(*) FROM players) AS `count`
FROM
    (
        SELECT
            pys.id AS id,
            SUM(wps.kills) AS kills,
            pys.deaths AS deaths,
            (SUM(wps.kills) / pys.deaths) as kdrate
        FROM
            players pys
        INNER JOIN
            weapons wps
        ON
            pys.id = wps.playerid
        GROUP BY
            pys.id
        ORDER BY
            2 DESC,
            3,
            4 ASC
    ) AS tmp
WHERE
    id = 1 
```

剩下的唯一问题是，`rank`在这两种情况下都是 1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:38:14.320

这是我的“解决方案”。这个查询更简单，但得到你正在寻找的结果

```
select 
pys.steamID, SUM(wps.kills) as Kills,
SUM(pys.deaths) as Deaths,
(sum(wps.kills)/sum(pys.deaths)) as kdratio
--,COUNT(pys.steamID) as PlayersC
from players pys
inner join  weapons wps on pys.id = wps.playerid
group by pys.steamID
order by 2 DESC, 3, 4 ASC 
```

添加排名。

```
SELECT
    id,
    kills,
    deaths,
    kdrate,
    ranking_usr as rank,
    (SELECT COUNT(*) FROM players) AS `count`
FROM
    (
        SELECT
            @row := @row + 1 AS ranking_usr
            pys.id AS id,
            SUM(wps.kills) AS kills,
            pys.deaths AS deaths,
            (SUM(wps.kills) / pys.deaths) as kdrate
        FROM
            players pys
        INNER JOIN
            weapons wps
        ON
            pys.id = wps.playerid
        GROUP BY
            pys.id
        ORDER BY
            2 DESC,
            3,
            4 ASC
    ) AS tmp
WHERE
    id = 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:19:31.293

基于 Manueru_mx 答案，这里是解决方案：

```
SELECT
    *
FROM
    (
    SELECT
        id,
        kills,
        deaths,
        kdrate,
        @rownum := @rownum + 1 AS rank,
        (SELECT COUNT(*) FROM players) AS `count`
    FROM
        (
            SELECT
                pys.id AS id,
                SUM(wps.kills) AS kills,
                pys.deaths AS deaths,
                (SUM(wps.kills) / pys.deaths) as kdrate
            FROM
                players pys
            INNER JOIN
                weapons wps
            ON
                pys.id = wps.playerid
            GROUP BY
                pys.id
            ORDER BY
                2 DESC,
                3,
                4 ASC
        ) AS tmp,
        (SELECT @rownum:= 0) r
    ) AS tmp2
WHERE
    id = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:24:02.963

你期待的结果是什么？您可以通过运行简单地知道玩家完成了多少杀戮：

```
select id, (select sum (kills) from weapons where playerid = p.id)
from  players p 
```

# c# - C# 中的 Outlook 插件：转发和打开事件之间会发生什么？

> ID：12976170
> 
> 赞同：5
> 
> 时间：2012-10-19T14:15:49.703
> 
> 标签：c#, outlook, vsto, outlook-addin

1.  在 Outlook 插件中，我注册了两个事件处理程序，用于`MailItem.Forward`和`MailItem.Open`
2.  当我收到**Forward**时，我得到一个引用`MailItem`为新消息创建的新对象的对象参数。
3.  当我查看`object.HTMLBody`（*或 Body*）时，它引用了与原始邮件项目相同的对象（*转发之前*）。此对象包含原始消息的未修改值。
4.  当我收到**Open**事件（*与之前的 Forward 事件相同的对象*）时，该事件引用与 forward 相同的对象，但它已经包含一个新的`HTMLBody`（*和 Body*） - 它包括添加到原始消息中的转发标题等。

**问题：**

如果我尝试在步骤 3) 中设置**一个新的 HTMLBody**对象（*在 Forward 事件处理程序中*），它没有任何效果。

从事件处理程序返回后，我在 4)（*在 Open 事件处理程序中*）得到的是经过转换的原始消息，在我替换`HTMLBody`.

因此，在 Forward 和 Open 事件之间发生了一些事情，它替换了`HTMLBody`新对象的 ，但基于其旧值（*或原始消息的值*）。

那是怎么回事？

如何替换`HTMLBody`转发的消息，而不影响原始消息的正文，但在它根据转发过程进行转换之前？

# sas - 带有管道的 SAS 中的 utf-8 编码

> ID：12976172
> 
> 赞同：2
> 
> 时间：2012-10-19T14:15:52.323
> 
> 标签：sas

有没有办法在 SAS 中结合管道 infile 和 utf-8 编码？

例如，这有效：

```
data wordlist;
    infile 'wordlist.txt' dlm='|' encoding='utf-8';
    input polar $3\. word :$30.;
run; 
```

但这不是：

```
filename inf pipe 'perl fix.pl';

data wordlist;
    infile inf dlm='|' encoding='utf-8';
    input polar $3\. word :$30.;
run; 
```

错误是：

> 错误 23-2：无效的选项名称编码。

我试过把`encoding`语句放在`filename`语句和`infile`语句中，但都不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T17:42:38.290

SAS for Windows 中的 PIPE“设备”当前不支持 ENCODING 选项。但是，我的理解是可以在 UNIX 上工作。

正如另一位回应的那样，如果您将会话编码设置为 UTF-8（使用 -ENCODING 系统选项），这可能对您有用。但是设置会话编码可能会对您的处理产生其他副作用，因此您需要格外小心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:01:05.440

不知道为什么管道文件会有所不同，但是如果将会话编码更改为 UTF-8 会怎样？

或者，您当然可以通过将 perl 脚本输出写入文件，然后通过普通输入法读取该文件来解决它。

这一点之前在 SAS-L 上讨论过，我认为没有找到更好的解决方案（参见[http://listserv.uga.edu/cgi-bin/wa?A2=ind1203b&L=sas-l&D=0&P= 9728](http://listserv.uga.edu/cgi-bin/wa?A2=ind1203b&L=sas-l&D=0&P=9728) )

# c# - 从 URL 中获取用户 ID/用户名以在页面上显示内容

> ID：12976175
> 
> 赞同：0
> 
> 时间：2012-10-19T14:16:14.957
> 
> 标签：c#, asp.net, .net

> **可能重复：**
> [如何使用 C# 读取从 asp.net 页面传递的参数？](https://stackoverflow.com/questions/1078171/how-to-read-parameter-passed-from-asp-net-page-using-c)

我想根据显示在 URL 末尾的用户 ID 在 ASP.NET 网页上显示配置文件内容，就像在 facebook 页面中一样。

我希望能够从 URL 派生 id，以便我可以搜索数据库以匹配 Id。

如果有人可以帮助我导出作为 URL 的最后一位的 Id，我可以将其转换为字符串并完成剩下的工作。非常感谢您的帮助。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:19:57.003

这将取决于您的编程方式和 URL 的结构。

例子; 如果 URL 类似于[http://mydomain.com/page.aspx?id=1](http://mydomain.com/page.aspx?id=1)您可以通过执行以下操作来读取查询字符串。

```
strID = Request.QueryString("ID"); 
```

在这种情况下，strID 的值为 1。

您使用的是 URL 重写模块还是简单的 Web 表单？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:26:13.013

如果要检索当前页面的名称，请尝试：

```
Path.GetFileName(Request.Url.AbsolutePath); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:51:16.530

我对已经解决方案的补充：

```
 string url = HttpContext.Current.Request.Url.AbsoluteUri; 
```

此代码将为您提供 URL，但在 url 中存储 UserId 和敏感数据并不是一个好习惯。我的建议是对查询字符串使用编码技术。

# mysql - 有什么方法可以相对快速地使用 WHERE 部分中的函数进行查询？

> ID：12976176
> 
> 赞同：0
> 
> 时间：2012-10-19T14:16:15.680
> 
> 标签：mysql

让我们看一个包含列 id、name 和 UCId 的表 Companies。我正在尝试查找其 UCId 的数字部分与某些数字字符串匹配的公司。

UCId 通常看起来像 XY123456，但它们是用户输入，用户似乎真的很喜欢在其中留下随机空间，有时甚至根本不输入 XY，他们希望保持这种状态。我的意思是我不能强制执行标准模式。他们想以自己的方式进入它，并以自己的方式阅读它。所以我不得不在 where 部分中使用函数。

有没有办法让这些查询在 mysql 中不会花费太长时间？我知道要使用哪些功能以及所有这些，我只需要一种方法来使搜索至少相对较快。我可以以某种方式使用已应用于 UCId 的函数创建自定义索引吗？

仅供参考我想使用的查询示例

```
SELECT * 
FROM Companies 
WHERE digits_only(UCId) = 'some_digits.' 
```

我将补充一点，Company 表通常有数万行，在某些情况下查询需要重复运行，这就是我需要快速解决方案的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:20:47.497

不幸的是，MySQL 没有基于函数（一般来说，表达式）的索引（如[Oracle](http://www.oracle-base.com/articles/8i/function-based-indexes.php)或[PostgreSQL](http://www.postgresql.org/docs/9.2/interactive/indexes-expressional.html)中的索引）。一种可能的解决方法是向`Companies`表中添加另一列，该列实际上将由标准化值（即`digits_only(UCId)`）填充。可以在您的代码中或通过在 INSERT/UPDATE 上设置的 DB 触发器管理此列。

# c++ - 如何将 char* 分配给 char 数组？

> ID：12976184
> 
> 赞同：1
> 
> 时间：2012-10-19T14:16:47.597
> 
> 标签：c++, char

编译器告诉我“将 char* 分配给 char[32] 的类型不兼容”这是我的代码：

```
char* generalOperations[2]={"Off","On"};

 void test(){
   char value[32];
    switch(swapVariable){
     case 0:
      value=generalOperations[0]; //<==Error HERE!
     break;
    }

 } 
```

[解决了]：

```
 strcpy(value,generalOperations[0]); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T14:25:00.490

使用`std::string`代替`char*`和`std::array<T, N>`代替`T[N]`。两者都是类型安全的（与 相对`memcpy`），都采用现代 C++ 风格，并且都可以使用赋值运算符直接赋值。

```
#include <array>
#include <string>

std::array<std::string, 2> generalOperations{"Off", "On"};

void test() {
    std::string value;
    switch(swapVariable) {
        case 0: value = generalOperations[0]; break;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T14:18:26.567

您不能分配数组。您可以将 的类型更改`value`为 a`char*`或将 的内容复制`generalOptions[0]`到`value`。如果要复制内容，则需要确保`value`有足够的空间来容纳`generalOperations`.

修改字符串文字是未定义的行为，通过将类型更改`const char*`为编译器可以检测到任何修改其中一个条目的尝试，`generalOperations`而不是在运行时遇到奇怪的行为：

```
const char* generalOperations [2]={"Off","On"};

const char* value; 
```

请注意，如果要对其进行初始化，则不必指定数组中的元素数：

```
const char* generalOperations [] = {"Off","On"}; 
```

或者，如果这真的是 C++，你可以改为创建`value`一个`std::string`并分配给它，它将复制`generalOperations`元素。

* * *

由于 C++ 似乎真的是语言，并且允许使用 C++11 功能而不是使用 a`switch`您可以创建将值与`std::map`相关联的a ：`int``std::string`

```
#include <iostream>
#include <string>
#include <map>

const std::map<int, std::string> generalOperations{ {17, "Off"},
                                                    {29, "On" } };
int main()
{
    auto e = generalOperations.find(17);
    if (e != generalOperations.end())
    {
        // Do something with e->second.
        std::cout << e->second << "\n";
    }
    return 0;
} 
```

演示：http: [//ideone.com/rvFxH](http://ideone.com/rvFxH)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:17:48.017

```
#include <string.h>

...
strcpy(value, generalOptions[0]); 
```

您不能在 C/C++ 中分配数组。有一些功能可以为您完成。如果您的 char 数组表示 C 风格的字符串（即以空字符结尾的字符序列），那么还有更多专门的函数。`strcpy`是这些功能之一。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-19T14:38:16.567

您的分配是错误的，因为您不能将 char * 分配给 char 数组而不是使用此分配，您可以使用 strcpy()。

# objective-c - 创建具有 OpenGLCompatibility 的 CVPixelBufferRef

> ID：12976188
> 
> 赞同：1
> 
> 时间：2012-10-19T14:16:54.067
> 
> 标签：objective-c, ios, ios5, opengl-es

我正在尝试创建一个 CVPixelBuffer 以在其中分配位图并将其绑定到 IOS 5 下的 OpenGL 纹理，但我遇到了一些问题。我可以生成像素缓冲区，但 IOSurface 始终为空，所以我不能将它与 CVOpenGLESTextureCacheCreateTextureFromImage 一起使用。由于我没有使用相机或视频，而是使用自行生成的位图，因此我无法使用 CVSampleBufferRef 从中获取像素缓冲区。

我让你我的代码，以防你们中的一些人知道如何解决这个问题。

```
CVPixelBufferRef renderTarget = nil;
CFDictionaryRef empty; // empty value for attr value.
CFMutableDictionaryRef attrs;
empty = CFDictionaryCreate(kCFAllocatorDefault, // our empty IOSurface properties dictionary
                           NULL,
                           NULL,
                           0,
                           &kCFTypeDictionaryKeyCallBacks,
                           &kCFTypeDictionaryValueCallBacks);
attrs = CFDictionaryCreateMutable(kCFAllocatorDefault,
                                  2,
                                  &kCFTypeDictionaryKeyCallBacks,
                                  &kCFTypeDictionaryValueCallBacks);

CFDictionarySetValue(attrs,
                     kCVPixelBufferIOSurfacePropertiesKey,
                     empty);
CFDictionarySetValue(attrs, kCVPixelBufferOpenGLCompatibilityKey, [NSNumber numberWithBool:YES]);

CVReturn err = CVPixelBufferCreateWithBytes(kCFAllocatorDefault, tmpSize.width, tmpSize.height, kCVPixelFormatType_32ARGB, imageData, tmpSize.width*4, 0, 0, attrs, &renderTarget); 
```

如果我转储新的 PixelBufferRef 我得到：

```
1 : <CFString 0x3e43024c [0x3f8f8650]>{contents = "OpenGLCompatibility"} = <CFBoolean 0x3f8f8a10 [0x3f8f8650]>{value = true}
2 : <CFString 0x3e43026c [0x3f8f8650]>{contents = "IOSurfaceProperties"} = <CFBasicHash 0xa655750 [0x3f8f8650]>{type = immutable dict, count = 0,
entries =>
}

} 
```

如果我尝试将它与 TextureCache 一起使用，我会得到 -6683 错误（kCVReturnPixelBufferNotOpenGLCompatible），这样：

```
CVOpenGLESTextureCacheCreateTextureFromImage (
                                              kCFAllocatorDefault,
                                              self.eagViewController.textureCache,
                                              renderTarget,
                                              nil, // texture attributes
                                              GL_TEXTURE_2D,
                                              GL_RGBA, // opengl format
                                              tmpSize.width,
                                              tmpSize.height,
                                              GL_BGRA, // native iOS format 
                                              GL_UNSIGNED_BYTE,
                                              0,
                                              &renderTextureTemp); 
```

# wcf - 每次调用服务应用程序后在客户端关闭通道

> ID：12976193
> 
> 赞同：2
> 
> 时间：2012-10-19T14:17:14.847
> 
> 标签：wcf, wcf-client, duplex-channel

我已经开始使用 WCF 开发客户端-服务器分布式应用程序。客户端也应该向服务器发送请求，因此我选择使用 NetTcpBinding 实现双工操作，因为所有客户端都将在同一个 Intranet 上。

在服务器端，对于实现服务器契约的服务类，我使用这些设置

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Single, InstanceContextMode = InstanceContextMode.Single, UseSynchronizationContext = false)] 
```

每次初始化客户端时，我都会创建通过`'Add service reference'`在 Visual Studio 中添加服务使用选项生成的代理类的实例。代理初始化后，我向`Connect`服务器发送一条消息：

```
 _proxy.InnerChannel.Faulted += new EventHandler(InnerChannel_Faulted);
 _proxy.InnerChannel.Closing += new EventHandler(InnerChannel_Closing);
 //send a connect message to the server
 _proxy.ClientConnected(ClientHostName, Version, ClientID, ClientIP); 
```

现在服务器有一个对连接客户端的引用，通过使用

```
OperationContext.Current.GetCallbackChannel<IClientEvents>() 
```

这很简单，没什么特别的。但是，在服务器上线后让客户端重新连接到服务器时，我遇到了一些麻烦。在我的场景中，我将有多达 50-100 个客户端连接到服务器，它们很少与服务器通信，假设平均每小时 1 个请求。

我想要实现的是让客户端在离线时“挂起”，为此我尝试在每次通道结束时重新初始化客户端的通信通道`Faulted`，这可以正常工作。但是当我尝试关闭服务器时，我收到以下消息

```
This could be because a client failed to close a sessionful channel within the required time. 
```

我现在正在努力为我的场景找到最合适的实现：

1.  **服务调用后不关闭通道**。这样，一旦与服务器的连接断开（例如 1 分钟的间隔），客户端将始终尝试重新创建通道。不过，一直保持频道打开没有多大意义，所以我不太确定这种方法。
2.  **每次调用后关闭通道**并在对服务器进行新调用时重新创建。这在进行服务调用时可以正常工作，但是如果服务器想要向客户端发送通知会发生什么？服务器端的回调引用将不再有效，我必须等待客户端发送新的连接消息才能获取新的回调引用，对吗？在这种情况下，我是否应该定期对服务器进行类似于 Ping() 的不同调用，以确保服务器始终可以联系客户端？

我仍在阅读有关 WCF 双工操作的材料，只是无法确定哪种方法更好，以免以后遇到问题。

谢谢你的建议！

# mysql - 总和值（同一列）

> ID：12976196
> 
> 赞同：1
> 
> 时间：2012-10-19T14:17:21.763
> 
> 标签：mysql, sql

我有这张桌子

```
user_id     time_completed
    4           86.30887
    5           57.81364
    5           35.50281
    5           10.00000
    5           74.19355
    5           31.91489
    6           15.00000
    6           20.50000 
```

我需要一直为每个用户求和，如下所示：

```
user_id     time_completed
4           86.30887
5           209.42489
6           35.50000 
```

这就是我获得第一张桌子的方式：

```
$result = mysql_query ("SELECT user_id,time_completed FROM `mytable` ORDER BY  `mytable`.`user_id` ASC;" ) 
```

任何的想法？

**编辑：** 如果我需要将 user_id 替换为下表 (db_users) 中的名称怎么办？

```
id          username
1           admin
2           peter
3           tom
4           user
5           joey
6           helen 
```

**EDIT2：** 我已经修改了这个表（db_users），我希望国家也出现在查询中。

```
id          username        country
1           admin           ES
2           peter           IT
3           tom             US
4           user            GB
5           joey            GE
6           helen           FR 
```

像这样：

```
user_id     time_completed      country
4           86.30887            GB
5           209.42489           GE
6           35.50000            FR 
```

看看这里：[http ://sqlfiddle.com/#!2/24d1b/11](http://sqlfiddle.com/#!2/24d1b/11)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T14:18:41.747

您需要使用`SUM()`which 是一个聚合函数，并按它们对它们进行分组`user_id`

 ~~~~```
SELECT user_ID, SUM(time_COmpleted) totalTime
FROM tableName
GROUP BY user_ID 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/25aed/1)~~  ~~**更新 1**

```
SELECT b.username, SUM(time_COmpleted) totalTime
FROM tableName a 
      INNER JOIN  db_users b
        ON a.user_id = b.id
GROUP BY b.username 
```

# [SQLFiddle 演示](http://sqlfiddle.com/#!2/e7510/1)~~~~

# python - 接受所有内容，直到“超过 1 个空格”，使用 pyparsing

> ID：12976199
> 
> 赞同：3
> 
> 时间：2012-10-19T14:17:37.640
> 
> 标签：python, python-2.7, pyparsing

我有一个文件，它的一部分看起来像这样：

```
string                     0            1           10
string with white space    0            10          30
string9 with number 9      10           20          50
string_ with underline     10           50          1
(string with parentese)    50           20          100 
```

我需要将每一行解析为：

```
[[string, 0 ,1 ,10], ....] 
```

正如您在上面看到的，第一部分几乎可以是任何东西，我能想到的解析它的唯一方法是接受任何东西，直到我有 2 个空白字符，然后它只是数字。

**但我在pyparsing** doc中找不到这个“UNTIL”功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:05:48.460

以下代码示例实现了您想要的（与@PaulMcGuire 建议的先前版本相比有所改进）：

```
from __future__ import print_function

from pyparsing import CharsNotIn, Group, LineEnd, OneOrMore, Word, ZeroOrMore
from pyparsing import delimitedList, nums 

SPACE_CHARS = ' \t'
word = CharsNotIn(SPACE_CHARS)
space = Word(SPACE_CHARS, exact=1)
label = delimitedList(word, delim=space, combine=True)
# an alternative contruction for 'label' could be:
# label = Combine(word + ZeroOrMore(space + word))
value = Word(nums)
line = label('label') + Group(OneOrMore(value))('values') + LineEnd().suppress()

text = """
string                     0            1           10
string with white space    0            10          30
string9 with number 9      10           20          50
string_ with underline     10           50          1
(string with parentese)    50           20          100
""".strip()

print('input text:\n', text, '\nparsed text:\n', sep='\n')
for line_tokens, start_location, end_location in line.scanString(text):
    print(line_tokens.dump()) 
```

给出以下输出：

```
input text:

string                     0            1           10
string with white space    0            10          30
string9 with number 9      10           20          50
string_ with underline     10           50          1
(string with parentese)    50           20          100

parsed text:

['string', ['0', '1', '10']]
- label: string
- values: ['0', '1', '10']
['string with white space', ['0', '10', '30']]
- label: string with white space
- values: ['0', '10', '30']
['string9 with number 9', ['10', '20', '50']]
- label: string9 with number 9
- values: ['10', '20', '50']
['string_ with underline', ['10', '50', '1']]
- label: string_ with underline
- values: ['10', '50', '1']
['(string with parentese)', ['50', '20', '100']]
- label: (string with parentese)
- values: ['50', '20', '100'] 
```

解析后的值可以作为字典获得，其中第一列（`label`在上面的示例中命名）作为键，其余列的列表（`values`上面命名）作为值，具有以下`dict`理解：

```
{label: values.asList() for label, values in line.searchString(text)} 
```

其中`line`和`text`是上面示例中的变量，生成以下结果：

```
{'(string with parentese)': ['50', '20', '100'],
 'string': ['0', '1', '10'],
 'string with white space': ['0', '10', '30'],
 'string9 with number 9': ['10', '20', '50'],
 'string_ with underline': ['10', '50', '1']} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-20T14:16:28.090

为了完整起见，这个不使用`pyparsing`.

```
import re
lines   = re.compile("\r?\n").split(text)
pattern = re.compile("\s\s+")
for line in lines:
  print pattern.split(line)
#['string', '0', '1', '10']
#['string with white space', '0', '10', '30']
#['string9 with number 9', '10', '20', '50']
#['string_ with underline', '10', '50', '1']
#['(string with parentese)', '50', '20', '100'] 
```

# c# - 处理表单之间传递 Control.Checked 状态的最佳方式

> ID：12976205
> 
> 赞同：1
> 
> 时间：2012-10-19T14:17:49.027
> 
> 标签：c#, .net, winforms

自从我使用 Windows 窗体应用程序以来已经有一段时间了。我在主窗体上有一个复选框，并且根据特定条件，如果需要打开第二个窗体以向用户请求其他数据，我应该如何将消息从第二个传递（或获取）回主窗体表格以便我可以判断是否可以选中或取消选中复选框？

据我所知，我可以使用 Pass by 之类的东西`ref`。还是有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:29:37.053

由于您将子表单显示为对话框，并且父表单在表单关闭之前不需要它，您需要做的就是向子表单添加一个带有公共 getter 和私有 setter 的属性，设置值在适当的时候在子窗体中，然后在调用`ShowDialog`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:11:25.220

一种方法是使用事件。

在您的子表单中，声明一个在特定用户交互时引发的事件，并在您的主表单中简单地“订阅”该事件。

当您实例化并称您为子表单时，您会这样做：

```
private void button1_Click(object sender, EventArgs e)
{
    Form2 frm = new Form2();
    frm.MyEvent += frm_MyEvent;
    frm.ShowDialog();
    frm.MyEvent -= frm_MyEvent;
}

private void frm_MyEvent(object sender, EventArgs e)
{
    textBox1.Text = "whatever"; //just for demo purposes
} 
```

在您的子表单中，您声明事件并引发它：

```
public event EventHandler MyEvent;

private void button1_Click(object sender, EventArgs e)
{
    if (MyEvent!= null)
        MyEvent(this, EventArgs.Empty);
} 
```

希望这可以帮助

# java - 手动编辑 Android 项目的 .classpath 文件

ID：12976212

赞同：1

时间：2012-10-19T14:18:17.207

标签：java, android, noclassdeffounderror

# ajax - 如何在没有 JSF 标记库（h:datatable 或 ui:repeat）的情况下编写标记，但仍使用 JSF 来控制页面流 我有以下大小的各种表格：12 列和最多 1800 行。将其呈现给用户需要 8 秒。我目前使用h:dataTable. 我试图ui:repeat从由 JSF 管理的 Java List 对象中获取行数据。虽然这工作正常，但 8 秒渲染表格是不可接受的。我正在尝试寻找其他方法来做到这一点，但需要在页面 问问题 问问题 2012-10-19T14:18:36.630 296 次 This question shows research effort; it is useful and clear 4 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我有以下大小的各种表格：12 列和最多 1800 行。将其呈现给用户需要 8 秒。我目前使用h:dataTable. 我试图ui:repeat从由 JSF 管理的 Java List 对象中获取行数据。虽然这工作正常，但 8 秒渲染表格是不可接受的。我正在尝试寻找其他方法来做到这一点，但需要在页面上保留JSF我controller的操作按钮。换句话说，我想自己为托管 bean 方法创建“表标记to send to the页面h:commandButtons”。and then still associate actions on有没有办法做到这一点？ 我能想到的唯一方法是使用jquery或ajax创建表格标记，尽管我对用于 UI 开发的 JSF 以外的技术不熟悉。也许我会以某种方式将其传递给客户端进行渲染。唯一的问题是我不知道如何从我的列表中生成标记，其次我将如何h:commandButtons在我的XHTML文件中注入它。 有谁知道我如何解决这个问题而不必完全撕掉 JSF？我遇到的一个主要问题是 业务需求说我们不能对数据表进行分页（例如：Next / Back 按钮一次显示 100 个）。所以，可能我在想我可以通过 Ajax 调用服务器来做到这一点，并在页面准备好后一次获得 100 行，并在幕后将新行附加给用户。这将是“感知”的加载速度，但我根本不知道该怎么做。 基本上，您需要首先删除以太网标头。接下来，删除 IP 标头，最后删除 TCP 标头。但是，可以在 MAC 或 IP 层进行加密。在这种情况下，您需要先解密数据，然后才能删除标头并提取有效负载。无论如何，这是一个非常广泛的问题；您应该熟悉http://en.wikipedia.org/wiki/OSI_model 我确信 Linux 中已经准备好可以满足您要求的库（前提是没有加密或您可以解密） ajaxperformancejsfjquerydatatable 4 1 回答 1 This answer is useful 0 8 秒对于 12 列的 1800 行来说还不错。10~100 行在不到一秒的时间内完成，对吧？ 在继续此之前，您是否绝对肯定所有这 1800 行都应该立即显示？这不是对用户很不友好吗？用户不需要 Ctrl+F 来查找它正在寻找的信息吗？那不是很烦人吗？您为什么不引入过滤（搜索字段）和分页，就像 Google 所做的那样，以理智和用户友好的方式呈现无数结果？ 无论如何，您可以考虑使用PrimeFaces 的“按需数据”选项<p:datatable>，其中数据在滚动过程中由 ajax 加载<p:datatable livescroll="true">。另请参见展示示例。不需要自制代码，也不需要手动摆弄 jQuery。PrimeFaces 在幕后完成了这一切。 如果您出于某种原因不想使用 PrimeFaces，那么您可以考虑将OmniFaces <o:componentidparam>与一些 jQuery“实时滚动”插件结合使用。另请参阅其（快照）展示页面中的最后一个示例以获取启动示例（应该很容易适应通过点击滚动底部而不是单击来触发）。 于 2012-10-19T14:49:42.307 回答 Related 2 function - 如何创建一个返回布尔值的 xsl:function 1 iphone - 无法将 NSMutableArray 写入 NSFileManager iOS Sdk 2 javascript - 如何使用 JavaScript 截取 HTML5 视频的不同屏幕截图？ 1 c# - 在转发器中重新绑定下拉列表 3 php - 使用 php 为 html 创建自定义标签 1 wordpress - 具有自定义帖子类型和自定义分类的 WordPress 永久链接 1 c# - System.IO.IOException：客户端和服务器之间存在时间和/或日期差异 3 c# - 在开发模块化应用程序时使用快速失败的方法 2 jquery-ui - JQuery UI Datepicker - 如何删除“完成”按钮 3 javascript - 无法隐藏我的部分页面，但相同的代码适用于 JSFiddle Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</o:componentidparam></p:datatable></p:datatable>

> ID：12976215
> 
> 赞同：4
> 
> 时间：
> 
> 标签：ajax, performance, jsf, jquery, datatable

我有以下大小的各种表格：12 列和最多 1800 行。将其呈现给用户需要 8 秒。我目前使用`h:dataTable`. 我试图`ui:repeat`从由 JSF 管理的 Java List 对象中获取行数据。虽然这工作正常，但 8 秒渲染表格是不可接受的。我正在尝试寻找其他方法来做到这一点，但需要在页面上保留`JSF`我`controller`的操作按钮。换句话说，我想自己为托管 bean 方法创建“表标记`to send to the`页面h:commandButtons”。`and then still associate actions on`有没有办法做到这一点？

我能想到的唯一方法是使用`jquery`或`ajax`创建表格标记，尽管我对用于 UI 开发的 JSF 以外的技术不熟悉。也许我会以某种方式将其传递给客户端进行渲染。唯一的问题是我不知道如何从我的列表中生成标记，其次我将如何`h:commandButtons`在我的`XHTML`文件中注入它。

有谁知道我如何解决这个问题而不必完全撕掉 JSF？我遇到的一个主要问题是 **业务需求说我们不能对数据表进行分页（例如：Next / Back 按钮一次显示 100 个）**。所以，可能我在想我可以通过 Ajax 调用服务器来做到这一点，并在页面准备好后一次获得 100 行，并在幕后将新行附加给用户。这将是“感知”的加载速度，但我根本不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:49:42.307

8 秒对于 12 列的 1800 行来说还不错。10~100 行在不到一秒的时间内完成，对吧？

在继续此之前，您是否绝对肯定所有这 1800 行都应该立即显示？这不是对用户很不友好吗？用户不需要 Ctrl+F 来查找它正在寻找的信息吗？那不是很烦人吗？您为什么不引入过滤（搜索字段）和分页，就像 Google 所做的那样，以理智和用户友好的方式呈现无数结果？

[无论如何，您可以考虑使用PrimeFaces](http://primefaces.org) 的“按需数据”选项`<p:dataTable>`，其中数据在滚动过程中由 ajax 加载`<p:dataTable liveScroll="true">`。另请参见[展示示例](http://www.primefaces.org/showcase/ui/data/datatable/scroll.xhtml)。不需要自制代码，也不需要手动摆弄 jQuery。PrimeFaces 在幕后完成了这一切。

如果您出于某种原因不想使用 PrimeFaces，那么您可以考虑将[OmniFaces](http://omnifaces.org) `<o:componentIdParam>`与一些 jQuery“实时滚动”插件结合使用。另请参阅[其（快照）展示页面](http://showcase.omnifaces.org/components/componentIdParam)中的最后一个示例以获取启动示例（应该很容易适应通过点击滚动底部而不是单击来触发）。

# android - 滚动期间未选中带有选中的简单光标适配器项目的列表视图

> ID：12976218
> 
> 赞同：1
> 
> 时间：2012-10-19T14:18:40.400
> 
> 标签：android, listview, cursor, adapter

我有一个问题，我无法在 SO 上找到答案 - 所有问题都在 SO 上解决，其中有太多不同的问题并且不起作用。问题是 -
**1\. ListView 中单击的行（单击后它们被标记为蓝色冷色背景，并且选中的框）在滚动后失去了被单击的标记（选中的复选框和颜色）。**
**2\. 更多 - 滚动期间标记其他行，即使未点击。**
ListView 绑定到我的自定义简单光标适配器，它从 SQLite 数据库获取数据。listview 的每一行都有许多带有文本框和一个复选框的列 - 因此 ListView 中的默认多项选择模式选择在我的情况下不起作用 - 我使用 onItemClick 来获取选定的项目。在 ListView Activity 中，我在列表中自行处理选中的项目。ListView 也在一个 Horizo​​ntalScrollView 中。

所以这些是我的课程和布局：

我的列表活动

```
public class MyListActivity extends ListActivity
    { .....
    public void initComponents()
    {
        baza = dbMan.openDB(true);
        cursorListaFaktur = wyswietlWszystkieTowary();
        startManagingCursor(cursorListaFaktur);
                fakturyLista = this.getListView();
        fakturyLista.setScrollContainer(true);
        fakturyLista.setScrollingCacheEnabled(true);

        fakturyLista.setItemsCanFocus(false);
        fakturyLista.setTextFilterEnabled(true);
        fakturyLista.setItemChecked(0, true);

        String[] columns = new String[] { "NRDOK", "NAZWADOK", "ANULOWANY",
                "NAZWASKR", "DATA", "SUMA", "MIEJSCOWOSC", "TERMIN",
                "WYEKSPORTOWANY", "MSPRZ_DOKUMENT.UWAGI" };

        int[] kontrolki = new int[] { R.id.ID_FakturyRow_NrFakt,
                R.id.ID_FakturyRow_Typ, R.id.ID_FakturyRow_Anulowany,
                R.id.ID_FakturyRow_DataSprzed,  
                                R.id.ID_FakturyRow_Kontrahent,
                R.id.ID_FakturyRow_Suma, R.id.ID_FakturyRow_Miejscowosc,
                R.id.ID_FakturyRow_Termin, R.id.ID_FakturyRow_Wyeksp,
                R.id.ID_FakturyRow_Uwagi };

        String[] columnsRaportKasowy = new String[] { "NRDOK", "NAZWADOK",
                "GOTOWKA", "GOTOWKA", "NAZWASKR", "DATA", "UWAGI" };

        int[] kontrolkiRaportKasowy = new int[] {
                R.id.ID_RaportKasowyRow_NrFakt,
                                R.id.ID_RaportKasowyRow_Typ,
                R.id.ID_RaportKasowyRow_Wplata,
                R.id.ID_RaportKasowyRow_Wyplata,
                R.id.ID_RaportKasowyRow_Kontrahent,
                R.id.ID_RaportKasowyRow_DataSprzed,
                R.id.ID_RaportKasowyRow_Uwagi };

        if (raportKasowy)
        {
            adapterFaktury = new MSprzedazRaportKasowyAdapter(this,
                  R.layout.raportkasowy_row, cursorListaFaktur,  
                  columnsRaportKasowy,   kontrolkiRaportKasowy);
        }
        else
        {
            adapterFaktury = new 
                        MSprzedazListViewAdapter(this,R.layout.faktury_row,
                         cursorListaFaktur, columns, kontrolki);
        }
            fakturyLista.setOnItemClickListener(new OnItemClickListener() {

                public void onItemClick(AdapterView<?> arg0, View arg1,
                        int arg2, long arg3)
                {
                    LinearLayout linLay = (LinearLayout) arg1;
                    ArrayList<View> kontrolki = arg1.getTouchables();
                    CheckBox chBox = (CheckBox) kontrolki.get(0);
                    chBox.setChecked(!chBox.isChecked());
                    Cursor cursor = adapterFaktury.getCursor();
                    cursor.moveToPosition(arg2);
                    String tekstKom = "";
                              if(MSprzedazUtils.znajdzIdWliscieZazn(
                              cursor.getInt(cursor.getColumnIndex("_id"))
                              , listaZaznaczonych) == null)
                    {

            listaZaznaczonych.add(cursor.getInt(cursor.getColumnIndex("_id")));

            linLay.setBackgroundColor(Color.rgb(110, 151, 186));

                        MSprzedazUtils.wpisDoLoga(tekstKom);

                    }
                    else
                    {
                        try
                        {
                        listaZaznaczonych.remove((int)  
                                            MSprzedazUtils.znajdzIdWliscieZazn(
                                          cursor.getInt(cursor.getColumnIndex("_id")),
                                           listaZaznaczonych));
                        MSprzedazUtils.wpisDoLoga(tekstKom);
                        }
                        catch(IndexOutOfBoundsException ex)
                        {

                        MSprzedazUtils.wpisDoLoga("Błąd"+tekstKom);
                        }
                    }
                }
            }); 
```

MySimpleCursorAdapter

```
public class MySimpleCursorAdapter extends SimpleCursorAdapter
        {
            class ViewHolder
        {
            CheckBox chckBoxZazn;
            LinearLayout linLay;
            TextView nrDok;
            TextView typDok;
            boolean isSelected;
            TextView txtData;
            TextView txtKontrahent;
            TextView txtSuma;
            TextView txtAnulowany;
            TextView txtMiejscowosc;
            TextView txtTermin;
            TextView txtWyeksp;
            TextView txtUwagi;
        }

        @Override
        public void bindView(View convertView, Context context, Cursor cursor)
        {
            if (convertView.getTag() != null)
                holder = (ViewHolder) convertView.getTag();
            {
                // holder.linLay = (LinearLayout)convertView;
                holder.chckBoxZazn = (CheckBox) convertView.findViewById(R.id.ID_FakturyRow_ChckBoxFakturyWybor);
                holder.nrDok = (TextView) convertView.findViewById(R.id.ID_FakturyRow_NrFakt);
                holder.typDok = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Typ);
                holder.txtAnulowany = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Anulowany);
                holder.txtData = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Kontrahent);
                holder.txtKontrahent = (TextView) convertView.findViewById(R.id.ID_FakturyRow_DataSprzed);
                holder.txtMiejscowosc = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Miejscowosc);
                holder.txtSuma = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Suma);
                holder.txtTermin = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Termin);
                holder.txtWyeksp = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Wyeksp);
                holder.txtUwagi = (TextView) convertView.findViewById(R.id.ID_FakturyRow_Uwagi);

            }

            holder.chckBoxZazn.setTag(cursor.getPosition());

            holder.nrDok.setText(cursor.getString(cursor.getColumnIndex("NRDOK")));
            holder.typDok.setText(cursor.getString(cursor.getColumnIndex("NAZWADOK")));
            if (cursor.getString(cursor.getColumnIndex("DATA")) != null)
                holder.txtData.setText(cursor.getString(cursor.getColumnIndex("DATA")).substring(0, 10));
            else
                holder.txtData.setText("-");
            if (cursor.getInt(cursor.getColumnIndex("ANULOWANY")) == 0)
                holder.txtAnulowany.setText("NIE");
            else
                holder.txtAnulowany.setText("TAK");

            if (cursor.getString(cursor.getColumnIndex("NAZWASKR")) != null)
                holder.txtKontrahent.setText(cursor.getString(cursor.getColumnIndex("NAZWASKR")));
            else
                holder.txtKontrahent.setText("-");
            if (cursor.getString(cursor.getColumnIndex("MIEJSCOWOSC")) != null)
                holder.txtMiejscowosc.setText(cursor.getString(cursor.getColumnIndex("MIEJSCOWOSC")));
            else
                holder.txtMiejscowosc.setText("-");
            holder.txtSuma.setText(cursor.getString(cursor.getColumnIndex("SUMA")));
            if (cursor.getInt(cursor.getColumnIndex("WYEKSPORTOWANY")) == 0)
            {
                holder.txtWyeksp.setText("NIE");
                holder.txtWyeksp.setBackgroundColor(Color.BLACK);
            }
            else
            {
                holder.txtWyeksp.setText("TAK");
                convertView.setBackgroundColor(Color.DKGRAY);
            }
            if (cursor.getString(cursor.getColumnIndex("TERMIN")) != null)
                holder.txtTermin.setText(cursor.getString(cursor.getColumnIndex("TERMIN")).substring(0, 10));
            else
                holder.txtTermin.setText("-");
            holder.txtUwagi.setText(cursor.getString(cursor.getColumnIndex("UWAGI")));

            if (cursor.getCount() > 0 && cursor.getPosition() < cursor.getColumnCount())
                holder.chckBoxZazn.setChecked(jestZaznaczony[cursor.getPosition()]);

        }

        @Override
        public void onClick(View v)
        {
            if (v.isFocusable())
            {
                jestZaznaczony[cursor.getPosition()] = !jestZaznaczony[cursor.getPosition()];
                holder.chckBoxZazn.setChecked(jestZaznaczony[cursor.getPosition()]);

            }
    }

} 
```

listview_row.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/ID_FakturyRow_KontrRow"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
>

<CheckBox
    android:id="@+id/ID_FakturyRow_ChckBoxFakturyWybor"
    android:layout_width="30dp"
    android:layout_height="30dp"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:text=""
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textSize="10dp"
    true="" />

<TextView
    android:id="@+id/ID_FakturyRow_NrFakt"
    android:layout_width="120dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="0dp"
    android:layout_marginRight="5dp"
    android:focusable="false"
    android:maxLength="10"
    android:maxLines="1"
    android:text="NrFakt"
    android:textAppearance="?android:attr/textAppearanceSmall"
    true="" />

<TextView
    android:id="@+id/ID_FakturyRow_Typ"
    android:layout_width="40dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="0dp"
    android:layout_marginRight="5dp"
    android:focusable="false"
    android:maxLength="4"
    android:maxLines="1"
    android:text="Typ"
    android:textAppearance="?android:attr/textAppearanceSmall"
    true="" />

<TextView
    android:id="@+id/ID_FakturyRow_Anulowany"
    android:layout_width="46dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="20dp"
    android:maxLength="8"
    android:maxLines="1"
    android:text="Anulowany"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:focusable="false" />

<TextView
    android:id="@+id/ID_FakturyRow_Kontrahent"
    android:layout_width="80dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="0dp"
    android:layout_marginRight="10dp"
    android:maxLength="14"
    android:maxLines="1"
    android:text="Kontrahent"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<TextView
    android:id="@+id/ID_FakturyRow_DataSprzed"
    android:layout_width="120dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="0dp"
    android:layout_marginRight="10dp"
    android:text="Data"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<TextView
    android:id="@+id/ID_FakturyRow_Suma"
    android:layout_width="65dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="0dp"
    android:maxLines="1"
    android:text="Suma"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<TextView
    android:id="@+id/ID_FakturyRow_Miejscowosc"
    android:layout_width="80dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="0dp"
    android:text="Miejscowosc"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<TextView
    android:id="@+id/ID_FakturyRow_Termin"
    android:layout_width="75dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="35dp"
    android:layout_marginRight="25dp"
    android:maxLength="18"
    android:maxLines="1"
    android:text="Termin"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<TextView
    android:id="@+id/ID_FakturyRow_Wyeksp"
    android:layout_width="70dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="35dp"
    android:layout_marginRight="0dp"
    android:maxLength="16"
    android:maxLines="1"
    android:text="Wyeksp"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<TextView
    android:id="@+id/ID_FakturyRow_Uwagi"
    android:layout_width="40dp"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:layout_marginRight="0dp"
    android:text="Termin"
    android:focusable="false"
    android:textAppearance="?android:attr/textAppearanceSmall" /> 
```

listview_layout.xml

```
<HorizontalScrollView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/scroller"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_marginBottom="10dp"
        android:fillViewport="true" >

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/ID_FakturyListaButtons_HeaderLayoutWrapper"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="25dp" 
            android:orientation="vertical" >

            ....... // Text Views as Listview header
         </LinearLayout>
         <RelativeLayout
                android:id="@+id/ID_FakturyListaButtons_TabListaLayout"
                android:layout_width="fill_parent"
                android:layout_height="match_parent"
                android:orientation="vertical" 

                >

                <ListView
                    xmlns:android="http://schemas.android.com/apk/res/android"
                    android:id="@android:id/android:list"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent"

                   >
                </ListView>
            </RelativeLayout>
        </LinearLayout>
 </HorizontalScrollView> 
```

我怎样才能使 ListView 有很多列来显示我点击的所有和唯一的项目？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:36:44.027

这是因为 Android 会回收 listView 中的行。为了克服这个问题，您需要将行状态（选中或未选中）保存在某个列表或其他内容中，并使用它来设置选中或未选中的行。在您的 getView() 函数中，您可以进行以下检查。这里 enabledItems 是一个列表

```
if (enabledItems.contains(eventTime)) {
viewHolder.getCheckBox().setChecked(true);
} else {
viewHolder.getCheckBox().setChecked(false);
} 
```

另外，请查看以下有关回收的文章。 [http://mobile.cs.fsu.edu/the-nuance-of-android-listview-recycling-for-n00bs/](http://mobile.cs.fsu.edu/the-nuance-of-android-listview-recycling-for-n00bs/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:49:56.800

您必须自己存储检查状态，并通过您的 onItemClicked 方法对其进行修改。

适配器在检查状态数组中的外观的简短示例：

```
public class ButtonCursorAdapter extends SimpleCursorAdapter {

    private Cursor c;
    private Context context;
    private Activity activity;
    public static int[] chkState;
    private int layout;

    public ButtonCursorAdapter(Context context, int layout, Cursor c,
            String[] from, int[] to) {
        super(context, layout, c, from, to);

        this.c = c;
        this.context = context;
        this.activity = (Activity) context;
        this.layout = layout;
        // create an array to hold checked state, use zero for un-checked and 1 for checked
        chkState = new int[c.getCount()];      // Set array size to # of elements in cursor
        for(int i=1; i<c.getCount(); i++){     // loop through array
            chkState[i] = 0;                   // set initial state to 0 - not checked
        }
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        if (convertView == null)
            convertView = View.inflate(context, layout, null);
        final int pos = position;
        View row = convertView;

        c.moveToPosition(position);

        //  do your data assignement stuff here

        //  set the state of your checkbox
        if (chkState[position] == 0) {
            //  set the checkbox to checked
        } else {
            //  set the checkbox to unchecked
        }
    return (row);       
    }
} 
```

# .htaccess - 执行此 htaccess 重写规则的更好方法

> ID：12976230
> 
> 赞同：0
> 
> 时间：2012-10-19T14:19:19.937
> 
> 标签：.htaccess, url-rewriting

我有这个重写规则，它检查 url 中的国家代码并相应地获取内容。

问题是有60多个国家。这可以以不同的方式完成，而不是在规则中输入所有国家/地区的代码吗？

```
RewriteRule ^/?(us|uk|ca)/p([0-9]+)/?$ 
```

注意 (us|uk|ca) 部分？更多的东西需要进去。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:22:47.030

```
RewriteRule ^/?([a-z][a-z])/p([0-9]+)/?$ 
```

但它不会检查语言是否有效（如果存在这样的东西，我不知道您是否期望语言代码超过 2 个字符）

**编辑：**这个正则表达式更短：

```
RewriteRule ^([a-z]{2})/p\d+/?$ 
```

第一个斜杠没用，\d+ 表示一个或多个数字，请参阅@TerryE 的评论

# magento - Magento 中的 getHtml() 是什么

> ID：12976231
> 
> 赞同：5
> 
> 时间：2012-10-19T14:19:20.260
> 
> 标签：magento

在产品过滤器 phtml 文件中 Magento 调用函数 getHtml()。

Magento 中的 getHtml() 是什么以及 getHtml() 和 getChildHtml() 之间的区别。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-19T14:44:59.043

以编程`getHtml()`方式是调用受保护渲染方法的公共方法`Mage_Core_Block_Template::_toHtml()`，同时`getChildHtml()`尝试从调用块的数组中查找块实例并使用更常见的方法`_children`返回其渲染的值。`Mage_Core_Block_Abstract::toHtml()`

在架构上，除了为这些过滤器块实例减少微小的处理开销、内联翻译和缓存写入之外，我还不是 100% 清楚任何意图。

# windows-7 - How to clear cache in IE9 Windows7 using vbscript

> ID：12976235
> 
> 赞同：0
> 
> 时间：2012-10-19T14:19:23.213
> 
> 标签：windows-7, vbscript, internet-explorer-9, clear-cache

I am trying to write the script to clear the cache on IE9 Windows7 (64 Bit). So far I have written below code. This code works fine on IE8 and Windows XP, but when I am trying to run same code on WIndows7 (IE9) it gives error by saying "Permission denied Line (39): "fso.DeleteFile (strWinFolder & "\Temp*.*"), True : fso.DeleteFolder (strWinFolder & "\Temp*.*"), True". "

Please check my script and correct me where I am doing wrong. Pardon me if I am wrong some where.

```
Dim methodName, fso, WshNetwork, WshShell, strVer, OSver, strWinFolder, strTempFolder, GetOS, strProfile, WindowsFolder, TemporaryFolder, NewFolder

Set fso = CreateObject("Scripting.FileSystemObject") : Set WshNetwork = CreateObject("Wscript.Network") 
set WshShell = createobject("wscript.shell") : set strVer = WshShell.exec("cmd /c ver") 
OSver = strVer.stdout.readall 

If InStr(OSver, "XP") Then GetOS = "WXP" : If InStr(OSver, "2000") Then GetOS = "W2K"
If InStr(OSver, "NT") Then GetOS = "NT4" : If InStr(OSver, "98") Then GetOS = "W98" 
If InStr(OSver, "Millennium") Then GetOS = "W98"

strWinFolder =  fso.GetSpecialFolder(WindowsFolder)
'strTempFolder =  fso.GetSpecialFolder(TemporaryFolder)

If GetOS = "WXP" OR GetOS = "W2K" Then
    Flag1 = True
    strProfile = "c:\Documents and Settings\"
Else
    Flag1 = False
End If

If GetOS = "NT4" Then
    Flag2 = True
    strProfile = "c:\winnt\profiles\"
Else
    Flag2 = False
End If

If Flag1 = False and Flag2 = False Then
    GetOS = "W7"
    Flag3 = True
    strProfile = "C:\Users\"
Else
    Flag3 = False
End If

'Delete the Temp files in the C:\Users folder. 
    If fso.FolderExists(strWinFolder & "\Temp\") Then 
        fso.DeleteFile (strWinFolder & "\Temp\*.*"), True : fso.DeleteFolder (strWinFolder & "\Temp\*.*"), True 
    End If 
    If  Not fso.FolderExists(strWinFolder & "\Temp\") Then NewFolder = fso.CreateFolder (strWinFolder & "\Temp\") End If

If Flag1 = True And Flag2 = True Then   
'Delete the recently viewed document links in the C:\Documents and Settings\"USERNAME"\Recent folder. 
    If fso.FolderExists(strProfile & WshNetwork.username & "\Recent\") Then fso.DeleteFile  (strProfile & WshNetwork.username & "\Recent\*.*"), True End If 
'Delete the Temp files in the C:\Documents and Settings\"USERNAME"\Local Settings\Temp folder. 
    If fso.FolderExists(strProfile & WshNetwork.username & "\Local Settings\Temp\") Then 
        'fso.DeleteFile (strProfile & WshNetwork.username & "\Local Settings\Temp\*.*"), True 
        'fso.DeleteFolder (strProfile & WshNetwork.username & "\Local Settings\Temp\*.*"), True 
    End If 

'Delete the Temporary Internet files and folders in the C:\Documents and Settings\"USERNAME"\Local Settings\Temporary Internet Files folder. 
    'wshShell.run "cmd /c del " & strprofile & WshNetwork.Username & "\Tempor~1\*.* /q", 1, True 
    'fso.DeleteFile (strProfile & WshNetwork.username & "\Tempor~1\*.*"), True 
    If fso.FolderExists(strProfile & WshNetwork.username & "\Local Settings\Temporary Internet Files\") Then 
        fso.DeleteFile (strProfile & WshNetwork.username & "\Local Settings\Temporary Internet Files\*.*"), True 
        'fso.DeleteFile (strProfile & WshNetwork.username & "\Local Settings\Temporary Internet Files\Content.IE5\*.*"), True 
    End If 
End If

If Flag3 = True Then
'Delete the Recent files on WIndows7    C:\Users\AA24800\AppData\Roaming\Microsoft\Windows\Recent
    If fso.FolderExists(strProfile & WshNetwork.username & "\AppData\Roaming\Microsoft\Windows\Recent") Then
        fso.DeleteFile (strProfile & WshNetwork.username & "\AppData\Roaming\Microsoft\Windows\Recent\*.*"), True 
    End If

'Delete Temporary Internet Files on WIndows7
    If fso.FolderExists(strProfile & WshNetwork.username & "\AppData\Local\Microsoft\Windows\Temporary Internet Files") Then
        fso.DeleteFile (strProfile & WshNetwork.username & "\AppData\Local\Microsoft\Windows\Temporary Internet Files\*.*"), True
    End If
End If
set fso = Nothing : set wshshell = Nothing : set WshNetwork = Nothing : set NewFolder = Nothing 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-29T20:22:58.710

```
' This script clears the cache of Internet Explorer
' Tested  on windows 7 workstation (IE9)

on error resume next
Dim objShell
Set objShell = CreateObject("WScript.Shell")
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 2")
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 255") ' ALl
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 1") 'History
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 2") ' Cookies
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8") ' Temp Internet Files
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 16") ' Form Data
objShell.Run ("RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 32") ' Passwords
'objShell.Run ("rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 4351")' All
Wscript.Quit

If err.number <> 0 Then
    WScript.Echo ("Script Check Failed") 
    Wscript.Quit (1001)
Else
    WScript.Echo ("Successfully Passed")
    WScript.Quit(0) 
End If 
```

# visual-studio-2012 - 当我打开任何其他源文件时，Visual Studio 2012 正在关闭其他代码文件

> ID：12976238
> 
> 赞同：0
> 
> 时间：2012-10-19T14:19:50.327
> 
> 标签：visual-studio-2012

所以我们刚刚切换到 VS 2012，这让我发疯了，因为它决定每当我双击一个文件打开它时，它都会关闭我正在查看的另一个打开的文件。起初我认为这只是一个更清晰的东西（使用 Ctrl + T）但事实并非如此，即使我打开 classA.cs 然后点击 classB.cs 它会关闭 classA.cs - 我从未见过或听说过这之前尝试了几个不同的谷歌查询，但没有运气。

反正知道是怎么回事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T15:22:55.830

关闭预览模式解决了这个问题。请参阅以下内容，stackoverflow.com/questions/10952185/...

# javascript - 如何在 IE7 的不可见框架中获取对象的 .height()？

> ID：12976246
> 
> 赞同：1
> 
> 时间：2012-10-19T14:20:07.097
> 
> 标签：javascript, jquery, internet-explorer, iframe, internet-explorer-7

我有一个 IFrame，它具有动态内容，具体取决于用户单击的链接。

我显示 IFrame 的实际代码如下所示：

```
var frame = $('#ContentFrame');
frame.attr('src', url);

// Wait until frame content finishes loading before positioning and showing
frame.load(function () {
    SizeAndPositionFrame(variables);
    frame.show();
}); 
```

如您所见，直到内容加载后，框架才真正显示出来。这是因为框架的大小可能会有所不同，并且我不希望以前的内容在新内容加载之前因框架调整大小而失真。

我的问题是某些内容框架的页面包含`$(document).ready()`需要某些对象的函数中的代码`.height()`，在 IE7 中，此高度为 0，直到框架完成加载 iframe 变得可见。

由于显示内容的框架不可见，我该怎么做才能获取`.height()`不可见的不可见对象？

注意：这是针对嵌入式 IE7 网络浏览器的，因此该解决方案*必须*与 IE7 兼容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:29:01.090

使 iFrame 可见，但不在视口内。

```
frame.css({
    position: 'absolute',
    left: '9000px'
}); 
```

但是，最好对类执行此操作，以便您可以简单地删除该类。

# javascript - 浏览器宽度和高度

> ID：12976251
> 
> 赞同：5
> 
> 时间：2012-10-19T14:20:43.493
> 
> 标签：javascript, jquery, html

我有显示视口宽度和高度的代码，但没有显示实际窗口大小。

知道如何获得窗口大小吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:38:17.547

不，您无法获得浏览器面板的大小。

您可以获得的最接近的结果是，如果用户最大化了窗口，您可以取屏幕大小并减去窗口大小，这样您就可以得到工具栏的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:25:24.547

我不确定，但我认为你想要什么文件`width`和`height`

尝试使用`$(document).height()`and`$(document).width()`获取页面宽度和高度。

**演示：http:** [//jsfiddle.net/JvGZr/2/](http://jsfiddle.net/JvGZr/2/)

# .htaccess - Mod重写相同的格式，不同的来源

> ID：12976252
> 
> 赞同：1
> 
> 时间：2012-10-19T14:20:45.440
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

目前正在为一家公司进行一些 URL 重写，我正在努力让新的 URL 指向正确的文件。

我无权访问 CMS - 页面以两种格式生成：

*   website.com/pressReleases.php?lang=EN
*   website.com/page.php?pagename=关于&lang=EN

我对每种格式都使用了重写，以使它们成为相同的所需格式（website.com/language/pagename）：

**格式 1 (website.com/pressReleases.php)**

```
RewriteCond %{QUERY_STRING} ^lang=(.*)$
RewriteRule ^(.*).php$ /%1/$1? [L] 
```

**格式 2 (website.com/page.php?pagename=About&lang=EN)**

```
RewriteCond %{THE_REQUEST} ^(GET|HEAD)\ /page.php
RewriteCond %{QUERY_STRING} pagename=([^&]+)&lang=([^&]+)
RewriteRule ^page.php$ /%2/%1? [R=301,L] 
```

问题是两种格式重写的输出相同，但源文件/路径不同。当我创建另一个重定向以将漂亮的 URL 转发到实际源时，它适用于两者：

```
RewriteRule ^([A-Za-z]+)/([0-9]+)/([a-zA-Z0-9_-]+)$ productSelection.php?    groupid=$2&lang=$1 [L] 
```

有什么方法可以对两种 URL 类型使用相同的格式，但转发到它们的原始路径？我是否错误地构造了我的重写以防止这种情况发生？

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T22:43:18.620

您可以尝试先`-f`检查 php 文件，如果失败，请使用第二种格式：

```
# format 1
RewriteCond %{REQUEST_URI} ^/([^/]+)/(.*)$
RewriteCond %{DOCUMENT_ROOT}/%2.php -f
RewriteRule ^/?([^/]+)/(.*)/?$ /$2.php?lang=$1 [L,QSA]

# format 2
RewriteCond %{REQUEST_URI} ^/([^/]+)/(.*)$
RewriteCond %{DOCUMENT_ROOT}/%2.php !-f
RewriteRule ^/?([^/]+)/(.*)/?$ /page.php?pagename=$2&lang=$1 [L,QSA] 
```

此外，您需要检查第一个 format1 规则中的实际请求：

```
RewriteCond %{THE_REQUEST} ^(GET|HEAD)\ /([^\ \?\.]+)\.php\?lang=
RewriteCond %{QUERY_STRING} ^lang=(.*)$
RewriteRule ^(.*).php$ /%1/$1? [L] 
```

# php - PHP eval(array_as_string) 返回 null

> ID：12976254
> 
> 赞同：2
> 
> 时间：2012-10-19T14:20:54.290
> 
> 标签：php, eval

```
$arr = eval("array('foo'=>'bar');");

// returns null
var_dump($arr); 
```

有人可以解释为什么我得到 null 而不是数组吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-19T14:23:03.743

你需要`return`数组。

从[文档](http://php.net/eval)：

> `eval()`返回`NULL`除非`return`在评估代码中调用，在这种情况下`return`返回传递给的值。

所以你需要这样做：

```
$arr = eval("return array('foo'=>'bar');"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:22:38.633

你的意思是

```
eval("\$arr = array('foo'=>'bar');"); 

var_dump($arr); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:24:17.123

首先，如[手册](http://php.net/manual/en/function.eval.php)`eval`中所述，强烈建议不要这样做。

另外，你应该做类似`$arr = eval("return array('foo'=>'bar');");`ie 的事情。`$arr`使用 eval 函数进行初始化。[在此处](http://codepad.org/liRuHaai)查看实际操作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:28:22.577

eval 函数执行给它的 php 代码。由于您的代码不返回任何内容，因此它给出了 null。您需要返回数组并将其存储在一个变量中，例如，

```
$arr = eval("return array('foo'=>'bar');"); 
```

# c++ - DirectX 11 中未解析的外部符号“_D3DX10CreateFontIndirectA@12”

> ID：12976256
> 
> 赞同：0
> 
> 时间：2012-10-19T14:20:58.327
> 
> 标签：c++, directx-11

我目前正在尝试编写一些代码来使用 DirectX 11 显示一些文本，但是在构建它时，我收到了以下错误：

```
1>Source.obj : error LNK2019: unresolved external symbol _D3DX10CreateFontIndirectA@12 referenced in function "bool __cdecl InitScene(void)" (?InitScene@@YA_NXZ) 
```

作为参考，这是我得到的代码，包括我认为可能导致问题的行：

```
bool InitScene()
{
D3DX10_FONT_DESC fd;
fd.Height = 175;
fd.Width = 0;
fd.Weight = 0;
fd.MipLevels = 1;
fd.Italic = false;
fd.CharSet = OUT_DEFAULT_PRECIS;
fd.Quality = DEFAULT_QUALITY;
fd.PitchAndFamily = DEFAULT_PITCH | FF_DONTCARE;
strcpy_s(fd.FaceName, "Impact"); //Need to find out how to fix this.

D3DX10CreateFontIndirect(d3dDevice, &fd, &Font);

return true;
} 
```

有谁知道为什么会发生这种情况，如果是这样，如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:41:35.223

您需要与 D3DX10.lib 链接。

假设您使用的是 Visual Studio，请右键单击您的项目并打开属性。在左侧部分，展开并选择配置属性->链接器->输入。然后在右侧部分，在“Addition Dependencies”中将库名称添加为 D3DX10.lib，使用分号将其与任何其他列出的库分隔。

为了确保在构建过程中实际使用这些“附加依赖项”，还需要验证两件事。在 Configuration Properties->Linked->General 1) 确保为“Link Library Dependencies”选择“Yes”。2）确保为“使用库依赖输入”选择“是”。

此外，将来，对于任何显示“未解析的外部符号”的此类错误，请找出未解析的函数/符号属于哪个库，并将该库添加到“附加依赖项”中，如上所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:32:33.493

这个函数 D3DX10CreateFontIndirect 需要链接 D3DX10.lib。顺便说一句，如果要在DX11中渲染字体，推荐使用DirectWrite，这是DirectX中渲染字体的新技术。

[D3DX10CreateFontIndirect](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172665%28v=vs.85%29.aspx)

[直写](http://msdn.microsoft.com/en-us/library/windows/desktop/dd368038%28v=vs.85%29.aspx)

# jquery - 如何在 ASP.NET MVC 中制作可编辑的 DropDownList 以获得正确的值？

> ID：12976258
> 
> 赞同：2
> 
> 时间：2012-10-19T14:20:59.173
> 
> 标签：jquery, asp.net-mvc-4

我在 MVC 4 中使用这个插件来获得一个可编辑的下拉列表：

[http://coffeescripter.com/code/editable-select/](http://coffeescripter.com/code/editable-select/)

我所做的是：
1- 在脚本文件夹下包含脚本。
2- 在我的 css 文件的最后部分添加 css 部分。
3-将图像添加到我的内容文件夹。
5-将该功能添加到我的局部视图中。

功能：

```
$(function () {

        $('#lugar').editableselect(
          {
              bg_iframe: true,

              onselect: function (list_item) {
                  alert('list item text: ' + list_item.text());
                  // 'this' is a reference to the instance of editableselect
                  // object, so you have full access to everything there
                  alert('input value: ' + this.text.val());
              },
              case_sensitive: false, // if set to true, the user has to type in an exact
              // match for the item to get highlighted
              items_then_scroll: 10 // if there are more than 10 items, display a scrollbar
          }
        );
        var select = $('#lugar:first');
        var instances = select.editableselectinstances();
        instances[5].addoption('germany, value added programmatically');
    }); 
```

6-将课程添加到我的领域。

```
<div class="editor-field editableSelect">
    @Html.EditorFor(model => model.Lugar)
    @Html.ValidationMessageFor(model => model.Lugar)
</div> 
```

**问题**
1- 我得到了列表（没有图像），但其中的值有误。我不知道它从哪里得到这些值。
2-我看不到将我想要的值传递给列表的位置，你能以正确的方式指导我吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-08T23:50:43.697

我能够在 ASP.NET MVC 4 和 twitter 引导程序中使用咖啡脚本显示可编辑的选择。

请看下面的详细信息，

在您的 MVC 项目中，添加对必要的 coffeescript 和 jquery（我使用 jquery-1.9.1.js）文件的引用。

1.  在视图中，添加以下代码，

> ```
> <select id="user_name_ddl" class="editable-select"> 
> </select> 
> ```

2.  在您的项目中打开“jquery.editable-select.css”并更新正确的图像位置，

> ```
> input.editable-select {
>   background: #FFF url(images/arrow-down.gif) right center no-repeat;
>   padding-right: 13px;
>   cursor:pointer;
> } 
> ```

注意：我将向下箭头的图像复制到我的 MVC 项目中的图像文件夹中。

3.  在您的自定义 .js 文件（如果没有，请创建一个）中添加以下代码行，

> ```
> $(function () {
>   $('.editable-select').editableSelect({
>     bg_iframe: true,
>     onSelect: function (list_item) {
>       $('#results').html('List item text: ' + list_item.text() + '<br/> \
>         Input value: ' + this.text.val());
>       }
>     });
>     var select = $('.editable-select:first');
>     var instances = select.editableSelectInstances();    
>     if (instances != null
>         && instances != undefined
>         && instances.length > 0) instances[0].addOption("Item 1");
> }); 
> ```

而已。现在，您将能够看到可编辑的选择。

# vba - 如何在 FormulaR1C1 中使用变量？

> ID：12976259
> 
> 赞同：1
> 
> 时间：2012-10-19T14:21:02.480
> 
> 标签：vba, excel

我有一个公式可以得到最接近给定值的值，即

```
=SMALL(R1C1:R1C144,COUNTIF(R1C1:R1C144,""<"" &8)+1 ) 
```

将给出最接近 8 的值。

我想使用变量而不是直接数字“（8）”

请帮我。这是我当前的代码

```
Private Sub CommandButton1_Click() 
Dim col As Integer 
col = Me.TextBox1.Value
ActiveCell.FormulaR1C1 = "=SMALL($A$1:$EN$1,COUNTIF($A$1:$EN$1," < "&col)+1)"
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T16:06:03.527

```
Private Sub CommandButton1_Click() 
Dim col As Integer 
col = Me.TextBox1.Value
 'EDIT: .FormulaR1C1 should be .Formula   
ActiveCell.Formula = "=SMALL($A$1:$EN$1,COUNTIF($A$1:$EN$1,""<" & col & """)+1)"
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:48:31.630

如果您想在与 VBA 分开的 excel 中执行此操作，那么您实际上并不需要变量。您应该将所需的任何值放在一个单独的单元格中（在此示例单元格 A5 中），然后在您的公式中引用该单元格，如下所示：

```
=SMALL(R1C1:R1C144,COUNTIF(R1C1:R1C144,""<"" & A5)+1 ) 
```

我不相信你会想要一个 VBA 解决方案，因为到目前为止你的算法都是 Excel 语法。但是，如果您确实想在 VBA 中执行此操作，则需要在 VBA 语法中找到算法并声明如下变量：

```
Dim myNumber As Integer

myNumber = 5          'put whatever number you want here 
```

# javascript - 这些 JS 代码片段是如何工作的？

> ID：12976261
> 
> 赞同：2
> 
> 时间：2012-10-19T14:21:10.610
> 
> 标签：javascript

我正在阅读有关闭包的信息，但我很难理解这两个代码片段之间的区别：

```
var myElements = [ /* DOM Collection */ ];

for (var i = 0; i < 100; ++i) {
    myElements[i].onclick = function() {
        alert( 'You clicked on: ' + i );
    };
} 
```

上面的代码应该只`i`在每次点击时显示为 99

```
function getHandler(n) {
    return function() {
        alert( 'You clicked on: ' + n );
    };
}

for (var i = 0; i < 100; ++i) {
    myElements[i].onclick = getHandler(i);
} 
```

上面的代码为每个元素点击事件显示了正确的“i”值！

我不明白为什么第一个不显示正确的值`i`。如果不是，为什么第二个显示正确的值？

它们取自[此链接](http://james.padolsey.com/javascript/closures-in-javascript/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:24:21.600

> 我不明白为什么第一个不显示正确的值`i`。

这是因为闭包没有捕获 的*值*，`i`而是实际的局部变量`i`。当您继续更改 的值时`i`，闭包会看到这些更改，因为它仍在使用相同的变量。

> 如果不是，为什么第二个显示正确的值？

因为在第二个中，闭包正在捕获局部变量`n`，此后该变量永远不会改变。（后来调用`getHandler`有一个全新的局部变量`n`；这很重要，不仅对闭包，而且对递归的支持。否则对函数的不同调用可能会意外地混淆彼此的变量！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:23:51.777

当点击发生时，它们都显示值。

在第一个中，只有一个`i`，它是`99`点击发生的时候。

在第二个中，`n`每次`getHandler`调用都有一个新的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:23:48.590

第一个为每个显示 99，因为在调用函数时， 的值为`i`99。

第二个显示正确的值，因为您关闭了`i`（通过参数`n`）。这意味着 while`i`将继续更改，`n`保留调用函数时的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:25:18.517

在第一个示例中，在循环中创建了 onclick 函数，并引用了`i`，但在单击发生之前它不会执行。当点击被触发时，函数执行并读取`i`，现在设置为 99。

在第二个示例中，`getHandler(i)`立即执行，返回一个引用 的函数`n`。（这就是返回函数被称为闭包的原因：它已经“关闭”了传入的值）。在这个新的函数作用域中，`n`等于传入的值——你正在寻找的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T14:25:47.247

`onclick`函数注定会在以后被触发。

在第一种情况下， i 的值会丢失，直到事件被触发，

但在第二种情况下， i 的值被复制并保存以备后用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T14:26:25.803

第二个示例有效而第一个示例无效的原因与范围有关。在第一个示例中，变量`i`存储在全局范围内，并在您单击按钮时读取。当你完成循环时，`i`是 99。如果你在循环中能够点击按钮 1，你会得到当前的值`i`。（顺便说一句，这是不可能的）。

在第二个示例中， 的副本`i`存储在 function中，当您在循环中更改时，该副本`getHandler`不会更改。是您返回的（未命名的）函数的范围，因此这就是它读取的变量。`i``getHandler`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-19T14:46:39.950

“i”变量绑定到范围，您可以使用在“i”具有正确值时评估的函数创建一个新范围

您可以实现此行为：

```
var myElements = [{}, {}];

for (var i = 0; i < 2; ++i) {
    myElements[i].onclick =
        function(i) {
            return function() {
                alert( 'You clicked on: ' + i );
            }
        }(i); // <- This behavior is the important one
} 
```

问候

# wordpress - 没有插件和黑客就无法处理不同页面上的小部件的背后是什么？（wordpress）

> ID：12976265
> 
> 赞同：1
> 
> 时间：2012-10-19T14:21:38.157
> 
> 标签：wordpress

基本问题：有没有办法在没有插件和自定义编码的情况下处理页面上小部件的可见性？如果不是，为什么不呢？这不是每个用户在开发新网站时都会遇到的主要问题吗？（例如，仅在左侧边栏中的事件页面上显示最近的事件）

我知道有几个插件，实际上我正在使用 Woo Sidebars 和 Widget Logic。而且效果很好，但是...

为什么我需要一个插件来处理这种行为，99% 的网站需要处理不同的（侧面）内容。只有我认为这应该是默认功能吗？

我问是因为我通常使用（企业）cms，我可以直接在每个页面上管理小部件，而不必在全局管理页面上管理小部件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T21:17:25.693

嗯...作为一个 CMS，不是定制的，与商业替代品相比，Wordpress 似乎缺乏。无需在主题中或通过插件进行自定义，它只是一个简单的博客平台。

用作开发者的平台时，它真的很性感。它的简单性使我们的开发人员能够将它变成我们需要的任何东西。

如果举行投票，我会投票不让每个页面上都有独立的侧边栏。我的大多数客户不需要每个页面上都有不同的侧边栏内容。我最终不得不在数百页上配置重复的侧边栏。为需要它自己的侧边栏内容的稀有页面创建一个新的页面模板要容易得多，或者创建一个在侧边栏中显示同级页面的简单小部件。实际上，使用 Wordpress 有几种不同的方法可以解决这个问题：自定义页面模板、自定义小部件、自定义字段等。

# java - 安卓分钟：秒

> ID：12976268
> 
> 赞同：0
> 
> 时间：2012-10-19T14:21:42.060
> 
> 标签：java, android

我正在寻找一种解决方案来显示 `minutes:seconds`持续时间`1785.16 string android device`

在 php 中它很简单：

```
<?php
$seconds = '1785.16';
$minutes = floor($seconds/60);
$secondsleft = $seconds%60;
if($minutes<10)
$minutes = "0" . $minutes;
if($secondsleft<10)
 $secondsleft = "0" . $secondsleft;
echo "$minutes:$secondsleft";
?>

This will display: 29:45 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:33:18.047

所以，我假设你有一个`String seconds = "1785.16"`. 然后你可以这样做：

```
String seconds = "1785.16";
int sec = (int)Float.parseFloat(seconds);
System.out.format("%02d:%02d", sec / 60, sec % 60); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:31:45.390

另一种方法是这样的：

```
float seconds = Float.parseFloat("1785.16");
Date date = new Date((long)(seconds * 1000));
SimpleDateFormat formater = new SimpleDateFormat("mm:ss");
String formatedDate = formater.format(date);
android.util.Log.d("This will display:", formatedDate); 
```

它对对象更友好^^而且您可以轻松更改格式！

# php - 将多维数组的路径表示为字符串（例如表单输入名称数组）

> ID：12976270
> 
> 赞同：2
> 
> 时间：2012-10-19T14:21:49.563
> 
> 标签：php, arrays, forms, input, multidimensional-array

假设有使用数组样式名称发布的表单输入：

```
<input type="text" name="user[name]" value="John" />
<input type="text" name="user[email]" value="foo@example.org" />
<input type="checkbox" name="user[prefs][]" value="1" checked="checked" />
<input type="checkbox" name="user[prefs][]" value="2" checked="checked" />
<input type="text" name="other[example][var]" value="foo" /> 
```

然后`$_POST`会像这样回来，`print_r()`'d：

```
Array
(
    [user] => Array
        (
            [name] => John
            [email] => foo@example.org
            [prefs] => Array
                (
                    [0] => 1
                    [1] => 2
                )

        )

    [other] => Array
        (
            [example] => Array
                (
                    [var] => foo
                )

        )

) 
```

目标是能够调用一个函数，如下所示：

```
$form_values = form_values($_POST); 
```

这将返回一个关联数组，其键类似于原始输入名称的样式：

```
Array
(
    [user[name]] => John
    [user[email]] => foo@example.org
    [user[prefs][]] => Array
        (
            [0] => 1
            [1] => 2
        )

    [other[example][var]] => foo
) 
```

这非常具有挑战性，此时我的“车轮在泥泞中旋转”。:-[

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:51:45.727

我不确定你为什么需要这样做，但如果下面的代码可以给你一个提示：

```
$testArray = array ( 'user' => array ( 'name' => 'John', 'email' => 'test@example.org', 'prefs' => array ( 0 => '1', ), ), 'other' => array ( 'example' => array ( 'var' => 'foo', ), ), );

function toPlain($in,$track=null)
{
    $ret = array();
    foreach ($in as $k => $v) {
        $encappedKey = $track ? "[$k]" : $k; /* If it's a root */

        if (is_array($v)) {
            $ret = array_merge($ret,toPlain($v,$track.$encappedKey));
        } else {
            $ret = array_merge($ret,array($track.$encappedKey => $v));
        }
    }
    return $ret;
}
print_r(toPlain($testArray)); 
```

[http://codepad.org/UAo9qNwo](http://codepad.org/UAo9qNwo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:11:19.417

好吧，如果您想测试它，我尝试了自己的疯狂方式。

```
<?php
function buildArray($input, &$output, $inputkey='')
{
    foreach($input as $key => $value)
    {
        if(is_array($value))
        {
            if($inputkey != "")
            {
                $inputkey .= "[$key]";
                buildArray($value, $output, $inputkey);
            }
            else
            {
                buildArray($value, $output, $key);
            }

        }
        else
        {
             $output[$inputkey."[$key]"] = $value;
        }
    }
 }

 $output = array();
 $input = array("user"=>array("name"=>"John","Email"=>"test.com","prefs"=>array(1,2)), "other"=>array("example"=>array("var"=>"foo")));
 buildArray($input, $output);
 print_r($output);
?> 
```

我不知道大多数内置 PHP 函数的强大功能，因为我还没有学习它们，所以我想出了自己的递归方式。

# xml - 在 AS3 中从外部 URL 加载 XML

> ID：12976274
> 
> 赞同：0
> 
> 时间：2012-10-19T14:22:03.870
> 
> 标签：xml, actionscript-3

我没有经验，所以请耐心等待我的错误。我以前从未使用过 XML。在我的 Air 应用程序中，我试图加载一个测试 XML 并在我的应用程序中显示一些数据。

xml很简单：

```
<player>
<highscore>Over9000</highscore>
</player> 
```

我的代码是：

```
var myXML:XML;
var myLoader:URLLoader = new URLLoader();
myLoader.load(new URLRequest("https://www.dropbox.com/s/0lx69pd73cmboh9/Leaderboard.xml"));
myLoader.addEventListener(Event.COMPLETE, processXML);
function processXML(e:Event):void {
   myXML = new XML(e.target.data);
   trace(myXML.highscore);
} 
```

当我只是从项目的源文件夹中加载 XML 时，这很好用，但是一旦我尝试使用 URL，我就会收到此错误：

> 错误 #1083：元素“error”的前缀“form”未绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:28:21.497

据我所知，[https:](https://www.dropbox.com/s/0lx69pd73cmboh9/Leaderboard.xml) //www.dropbox.com/s/0lx69pd73cmboh9/Leaderboard.xml 没有链接到 XML，而是链接到包含其内容的 HTML 页面。您在加载程序中获得的不是您要查找的 XML，而是保管箱包装器的源代码。

# css - 使用css在一行中显示字符串

> ID：12976276
> 
> 赞同：0
> 
> 时间：2012-10-19T14:22:08.313
> 
> 标签：css, html

我需要在一行中显示字符串“field1 field2 field3”，field1、field2 和 field3 将是 N 个字符。

我怎样才能显示字符串？

```
<style>
#div1{
    width:1000px;
    border:1px solid;
}           
.field1{
    display:inline;
    width:auto;
}
.field2{
    display:inline;
    width:auto;
}
.field3{

    width:auto;
}
        </style>

        <div id="div1">
            <div class="field1">Field1(with N number of characters)</div>
            <div class="field2">Field2(with N number of characters)</div>
            <div class="field3">Field3(with N number of characters)</div>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:30:38.237

除了将*所有*块级子项（包括 last `div`）转换为内联布局外，您可能还需要防止换行。在最简单的情况下，您可以将样式表替换为：

```
#div1 {
  white-space: nowrap;
  border: 1px solid;
}           
#div1 div {
  display: inline;
} 
```

如果您有其他原因，您可以在元素上设置宽度，但上面的代码也可以在没有此类设置的情况下工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:26:50.047

我想这是你想要的

```
<style>
#div1{
width:auto;
border:1px solid;
 }           
.field1{
display:inline;
width:auto;
}
 .field2{
display:inline;
width:auto;
}
.field3{
display:inline;
width:auto;
 }
    </style>

    <div id="div1">
        <div class="field1">Field1(with N number of characters)</div>
        <div class="field2">Field2(with N number of characters)</div>
        <div class="field3">Field3(with N number of characters)</div>
    </div>​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:29:28.890

正如[Sven](https://stackoverflow.com/users/1133145/sven-bieder)指出的，您可以使用跨度。没有任何 CSS 更改，您的所有项目将彼此相邻显示。

您的另一个选择是浮动 div，如下所示：

```
 <div id="div1">
        <div class="field1 fl">Field1(with N number of characters)</div>
        <div class="field2 fl">Field2(with N number of characters)</div>
        <div class="field3 fl">Field3(with N number of characters)</div>
        <div class="clear"></div><!-- This makes sure you don't float unintended elements in older browsers -->
    </div> 
```

并将其添加到您的 css 中（另外，删除您的`display: inline;`规则）：

```
.fl {
  float: left;
}

.clear {
  clear: both;
} 
```

`field1`如果,`field2`或的内容`field3`是动态的（例如使用 javascript 将文本替换为其他内容），则您可能希望使用 div ；但是如果您确定要放入元素中的只是文本，那么使用 span 就可以了（示例）：

```
 <div id="div1">
        <span class="field1">Field1(with N number of characters)</span>
        <span class="field2">Field2(with N number of characters)</span>
        <span class="field3">Field3(with N number of characters)</span>
    </div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:33:38.850

您不应该为每个项目需要单独的类，如果它们都将排成一行，您可以只使用一个可以完成这项工作的类（除非您稍后要引用特定的类）。:after 将确保该行之后的任何内容都不会出现在同一行上。

```
<style>
    .field {
        display: inline-block;
    }
    .field:after{
        display:block;
        height: 0;
        content: '';
        clear: both;
    }
</style>

<div id="div1">
    <div class="field">Field1(with N number of characters)</div>
    <div class="field">Field2(with N number of characters)</div>
    <div class="field">Field3(with N number of characters)</div>
</div> 
```

# c# - txt文件放在哪里

> ID：12976278
> 
> 赞同：0
> 
> 时间：2012-10-19T14:22:20.110
> 
> 标签：c#, file, text-files

我正在开发一个应用程序，在应用程序的主文件夹中，我有一个包含站点列表的文本文件。
我在处理文件时遇到了一些麻烦。

我想用应用程序发送带有他内部信息的文本文件，并在应用程序中为用户提供一个可以更改内容的地方。保存并显示更改。

我的问题是：

1.  我应该把这样的文件放在哪里？

2.  从应用程序中获取它的最佳方法是什么？

3.  为什么当我将文件放在文件夹中时，当我从 Visual Studio 运行应用程序时可以获得，但是当我释放应用程序并安装它时，应用程序找不到文件，我需要创建它（并且丢失数据)?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:29:43.250

找到正确位置的正确方法是使用[Environment.GetFolderPath](http://msdn.microsoft.com/en-us/library/14tx8hby.aspx)然后传入类似`SpecialFolder.LocalApplicationData`.

不过，您需要查看 SpecialFolder 枚举的[文档](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)，因为用户数据位置有很多细微的变化。

您的安装程序工具可能具有查找相同“特殊位置”的功能，因此您可以希望该文件将位于您期望的位置。当然，如果一个用户运行安装程序而另一个用户使用该应用程序，这可能无济于事，但在简单的情况下你可能没问题。

**尝试澄清**：

这里有两个问题：

1.  安装程序应该把文件放在哪里？
2.  当安装程序将文件放在那里时，我的应用程序将如何找到该文件？

这两个问题都可以通过 Windows 定义的各种“特殊文件夹”来解决——你不应该关心它们的确切位置，但是当你需要它们时，有办法找到它们。

要解决问题“1”，您需要查看安装程序文档，并了解它如何处理特殊文件夹 - 几乎总是有宏或一些类似的机制将文件的目标设置为特殊文件夹。要解决问题“2”，您需要使用 Environment.GetFolderPath()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:33:14.703

如果文件特定于单个用户，则应将其读/写到应用程序数据目录。

```
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData); 
```

如果文件在所有用户之间共享，请使用 Shared Application Data 目录：

```
string folderPath = Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData); 
```

# javascript - 使用jquery调用带有变量的id textarea

> ID：12976279
> 
> 赞同：0
> 
> 时间：2012-10-19T14:22:19.897
> 
> 标签：javascript, jquery, forms, dialog, jquery-ui-dialog

嗨，我有这个表单打开窗口的对话框：

```
<form method="GET" id="formparam">
<table><tbody><tr><td>
<label>ID</label></td>
<td><textarea style="height: 21px; overflow: hidden; padding-top: 0px; padding-bottom: 0px;" class="expand" id="inputp8_id"></textarea>
</td>
</tr>
</tbody></table></form> 
```

但是当我按下按钮名称的 Add.Function 的代码脚本时：

```
$("#wnd_Addparam").dialog({
    autoOpen: false,
    height: 'auto',
    width: 350,
    modal: true,
    resizable: false,
    buttons: {
        "Add": function() {
            contapara = (parseInt(contapara) + 1);
            var rok = $(#'inputp' + i + '_id').value;
            document.getElementById("sorpara").innerHTML += "<li id=\"inputp" + contapara + "_id\" class=\"ui-state-default\"><span class=\"ui-icon ui-icon-arrowthick-2-n-s\"></span>" + rok + "</li>";

            $(this).dialog("close");
        },
        Cancel: function() {
            $(this).dialog("close");
        }
    },
    close: function() {
        $(this).dialog("close");
    }
});

$("#btn_Addpar").click(function() {
    $("#wnd_Addparam").dialog("open");
});​ 
```

变量的 contapara 是 5。但是为什么值的变量是未定义的或什么都没有或代码的 html（带有 .text）？我查看变量 i 和 contapara 的值是否正确。我在哪里错了`var rok =$(#'inputp'+i+'_id').value;`？如何调用id的textarea inputp6_id并打印内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:25:08.053

在下面试试这个。这将从 textarea 中获取值。

```
var contapara =(parseInt($(contapara).val())+1); 
```

**编辑：**

```
var rok =$('#inputp'+i+'_id').val(); 
```

哈希也放错了地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:29:58.987

改变

```
var rok = $(#'inputp' + i + '_id').value; 
```

至 -

```
var rok = $('#inputp' + i + '_id').val(); 
```

实际上我什至不知道你从哪里得到`i`- 但只要`i`定义它就应该有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:26:07.197

`contapara`您首先在哪里定义？您需要在使用它的值之前定义一个变量。

IE

```
var contapara = 0; 
```

同样适用`i`- 我看不到这是在哪里定义的。

正如评论中指出的，正确的语法是：

```
$('#inputp' + i + '_id').val(); 
```

如果您仍然遇到问题，请将其插入并查看结果：

```
alert('#inputp' + i + '_id'); // is this what you expect?
$('#inputp' + i + '_id').val(); 
```

我希望你会发现这`i`不是你所期望的。

# php - 在 PHP 中合并两个图像

> ID：12976284
> 
> 赞同：1
> 
> 时间：2012-10-19T14:22:38.237
> 
> 标签：php, image, image-processing, gd

我正在构建一个 Web 应用程序，您可以在其中设计一些东西，在过程结束时它会输出两个图像。一个是gif，另一个是jpeg。我希望拍摄两张图像并将它们合并为一张图像。然而，在尝试了一些技术之后，似乎都没有奏效。

我的脚本如下：

```
$imgl = $_GET['img1'];
$img2 = $_GET['img2'];

$dest = imagecreatefromjpeg('$imgl');
$src = imagecreatefromgif('$img2');

// Copy and merge
imagecopymerge($dest, $src, 10, 10, 0, 0, 100, 47, 75);

// Output and free from memory
header('Content-Type: image/gif');
imagegif($dest);

imagedestroy($dest);
imagedestroy($src); 
```

然而，显示的图像只是显示一个非图像图标。变量 $img1 和 $img2 包含图像路径，指向图像所在的文件夹。我知道这一点，因为当我在 html img 标签中回显这两个变量时，两个图像都会显示。谁能告诉我我的脚本哪里出错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:31:33.193

您应该删除单引号。它们阻止 PHP 在字符串中查找变量。有关 PHP 中引号用法的更多信息，请查看[此处](http://www.untwistedvortex.com/php-programming-beginners-quotation-marks/)。

方法：

```
$dest = imagecreatefromjpeg($imgl);
$src = imagecreatefromgif($img2); 
```

此外，您应该检查是否要允许对图像进行操作。您允许每个知道 GET 参数名称的人将可能的恶意文件路径放入其中。你不阻止这一点。

有用的函数是[realpath](http://php.net/manual/en/function.realpath.php)、[basename](http://php.net/manual/en/function.basename.php)和[file_exists](http://php.net/file_exists)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:36:37.420

我知道您的示例直接适用于[PHP DOC](http://php.net/manual/en/function.imagecopymerge.php)，但我也对其进行了测试，但它对我不起作用.. 稍微解决一下它应该可以工作

```
$imgl = "a.jpg";
$img2 = "f.gif";

$dest = imagecreatefromjpeg($imgl);
$src = imagecreatefromgif($img2);
imagecolortransparent($src, imagecolorat($src, 0, 0));

$src_x = imagesx($src);
$src_y = imagesy($src);
imagecopymerge($dest, $src, 0, 0, 0, 0, $src_x, $src_y, 100);

// Output and free from memory
header('Content-Type: image/gif');
imagegif($dest);

imagedestroy($dest);
imagedestroy($src); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:31:37.377

不是 100% 确定这会解决您的问题，但这肯定是语法错误。这：

```
$dest = imagecreatefromjpeg('$imgl');
$src = imagecreatefromgif('$img2'); 
```

应该：

```
$dest = imagecreatefromjpeg($imgl);
$src = imagecreatefromgif($img2); 
```

您想传递 $img1 和 $img2 的值，而不是文字字符串`'$img1'`和`'$img2'`.

# jquery - 不需要的验证 - jquery datepicker mvc 4

> ID：12976287
> 
> 赞同：0
> 
> 时间：2012-10-19T14:22:44.600
> 
> 标签：jquery, jquery-ui, asp.net-mvc-4

我正在使用 stock 函数在 MVC 4 Razor 视图中显示日期范围。开始/结束日期是我的模型类中过滤器的一部分。我希望开始/结束日期是可选的。

当我提交没有填写开始/结束的表单时，它会触发“必填字段”验证检查，显示这些可爱的消息：

*   安装日期字段是必需的。
*   InstalledDateEnd 字段是必需的。

然而表单确实提交并且我的过滤器运行并返回结果。

```
 <script>
    $(function () {
        $("#InstalledDateStart").datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
            onSelect: function (selectedDate) {
                $("#InstalledDateEnd").datepicker("option", "minDate", selectedDate);
            }
        });
        $("#InstalledDateEnd").datepicker({
            defaultDate: "+1w",
            changeMonth: true,
            numberOfMonths: 3,
            onSelect: function (selectedDate) {
                $("#InstalledDateStart").datepicker("option", "maxDate", selectedDate);
            }
        });
    });
</script> 
```

我尝试告诉模型不需要这些字段，但没有帮助：

```
 [Display(Name = "Installed Date")]
    [Required(AllowEmptyStrings = true)]        
    public DateTime InstalledDateStart { get; set; }
    [Required(AllowEmptyStrings = true)]
    public DateTime InstalledDateEnd { get; set; } 
```

这是视图中的标记：

```
@using (Html.BeginForm("Filter", "Search"))
{

    <div class="divSearchBlock">
        <br style="clear:left;" />
        <div>
            <b>@Html.DisplayNameFor(model => model.ConstraintModel.InstalledDateStart)</b>                
            @Html.TextBox("InstalledDateStart", null, new { @class = "divCellContent" })                
            <b>-</b>                
            @Html.TextBox("InstalledDateEnd", null, new { @class = "divCellContent" })                
        </div>

        <input type="submit" value="Submit"/> 
    </div>
} 
```

到底是什么导致需要这些字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:31:59.870

`DateTime`s 不是字符串。所以`AllowEmptyString=true`没有意义。如果您希望您`DateTime`的 s 可以为空，请将您的模型声明为：

```
[Display(Name = "Installed Date")]
public DateTime? InstalledDateStart { get; set; }
public DateTime? InstalledDateEnd { get; set; } 
```

你需要`?`很重要，因为没有这个，`DateTime`意志最终会成为`DateTime.MinValue`

# components - Tridion：放置在页面内的组件模板

> ID：12976290
> 
> 赞同：-2
> 
> 时间：2012-10-19T14:22:46.903
> 
> 标签：components, tridion

我想就如何在页面的不同部分放置相同的组件演示文稿而不创建新的组件模板或组件获得专家建议。所以我们遇到的问题是我们有一个组件模板，我们希望灵活地将它放置在多个页面上的多个位置，因为它的物理表示是相同的，内容是相同的。

有没有办法在不创建 4 个不同 CT 的情况下实现这一目标？ [http://i.stack.imgur.com/cmkUB.jpg](http://i.stack.imgur.com/cmkUB.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T07:35:01.390

目前尚不清楚您要实现什么，但是，以一种非常通用的方式，如果您想：

1.  *在同一*页面的不同位置显示相同的**组件表示。**

     **   您可以在您的**页面模板上管理它*** 
**   **在不同**页面的不同位置显示相同的**组件表示。**

     ***   只需使用不同的页面模板

    *   通过更改组件呈现的顺序。（并在您的页面模板上管理它）*** 

 **** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T11:07:39.150

如果您想将相同的组件表示放置在不同页面的不同位置，那么我首先想到的是“*这些应该是不同的页面模板吗？* ”。这将使您能够根据使用的组件模板或组件的模式轻松控制组件表示的位置。

当您说它们需要位于不同的位置时，这是在页面上的相同“内容区域”（并且相对于其他组件）内还是实际上在页面的另一个区域中？如果它只是相对于页面上的其他组件（该类型），那么您可以按照它们在 Tridion 中添加到页面的顺序输出这些（可能通过创建一个 TBB 将所有该类型的组件分组到首先是一个数组）。

这实际上取决于组件应该放置在哪里的规则以及为什么！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T12:39:54.877

如果我理解正确，这是在 LHS/RHS 区域拥有“小部件”的古老问题，这些小部件具有相同的 HTML 输出，但 PT 无法知道将它们放置在哪里（除了通过组件中的字段值）或通过 CT 的名称/tcmuri）。

这本质上是在组件表示级别具有元数据的情况（并不真正属于组件或 CT，因为即使具有相同的组件和 CT，不同页面的位置也可能不同）。

对于这个问题，我使用了以下解决方案：

*   创建 1 个 CT 并复制 4 次（您将拥有完全相同的 DWT、参数设置等，只是名称不同）
*   创建 1 个 CT 并“滥用”tridion 的目标组机制（创建一个目标组 LHS 和一个目标组 RHS 并在这些位置“定位”CT；在您的 PT 中过滤所选目标组上的 CP）

第二种解决方案有其好处，但有潜在的成本；如果您将来想使用 Tridion 的分析和个性化，会发生什么？它可能不会产生任何后果，但由于我没有将两者结合的经验（“黑客”和 P&P 应该用于什么），我无法做出任何保证......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:58:09.663

不幸的是，这是不可能的，您需要为页面的每个部分创建不同的 CT，因为 Tridion 不会在页面上存储 CT 的位置。***

# c# - 按钮不会触发 Click 事件

> ID：12976292
> 
> 赞同：2
> 
> 时间：2012-10-19T14:22:56.707
> 
> 标签：c#, wpf, events, button, click

我有一个`Button`内部`UserControl`：

```
<UserControl.Resources>
    <ControlTemplate x:Key="ButtonTemplate" TargetType="{x:Type Button}">
        <ContentPresenter />
    </ControlTemplate>
</UserControl.Resources>    
<Button Template="{StaticResource ButtonTemplate}" Click="Button_Click" /> 
```

但是，如果我指定 a `Template`，则此 Button 不会触发`Click`事件。
为什么？我怎么解决这个问题？

代码隐藏：

```
public event RoutedEventHandler Click;

private void Button_Click(object sender, RoutedEventArgs e)
{
    if (Click != null)
        Click(sender, e);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:38:40.793

您的按钮模板是一个简单的 ContentPresenter。在您给我们的代码中，您没有在按钮中添加任何内容，因此它不会有任何大小。将无法点击。

```
<Window x:Class="StackOverflow.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    Title="MainWindow">

<Window.Resources>
    <ControlTemplate x:Key="ButtonTemplate" TargetType="{x:Type Button}">
        <ContentPresenter />
    </ControlTemplate>
</Window.Resources>

<Button Template="{StaticResource ButtonTemplate}" Click="Button_Click">
    <TextBlock Text="test" />
</Button>

</Window> 
```

此代码有效，如果您单击“测试”，则会正确触发 Button 的 Click 事件。我是在窗口中完成的，但在 UserControl 中是一样的。

如果您正在谈论您的自定义 Click 事件，则只有在您附加处理程序时才会触发它。

# android - 将特定覆盖项移动到顶部

> ID：12976295
> 
> 赞同：0
> 
> 时间：2012-10-19T14:23:12.320
> 
> 标签：android, android-mapview

我有一个类可以扩展`ItemizedOverlay<OverlayItem>`为将 200 个标记放在`MapView`. 现在我希望 1 个特定标记始终位于其他标记之上。

我该怎么做？

这就是我将标记添加到叠加层的方式：

```
boolean isTopMarker;
for (Location location : locationList) {
    isTopMarker = location.getTitle().equals("MyMarker");
    markerOverlay.addOverlayItem(location.getLatitude(), location.getLongitude(), location.getTitle(), isTopMarker);
}
markerOverlay.moveTopMarkerToTop(); 
```

类中的方法`MarkerOverlay`：

```
@Override
protected OverlayItem createItem(int i) {
    return mOverlays.get(i);
}

@Override
public int size() {
    return mOverlays.size();
}

public void addOverlayItem(OverlayItem overlayItem, boolean isTopMarker) {
    if (isTopMarker) {
        Drawable markerDrawable = getResources().getDrawable(R.drawable.marker_top);
        boundCenterBottom(markerDrawable);
        overlayItem.setMarker(markerDrawable);
        topMarkerOverlayItem = overlayItem;
    }
    mOverlays.add(overlayItem);
    populate();
}

public void addOverlayItem(double latitude, double longitude, String title, boolean isTopMarker) {
    GeoPoint point = new GeoPoint((int) (latitude * 1000000), (int) (longitude * 1000000));
    OverlayItem overlayItem = new OverlayItem(point, title, null);
    addOverlayItem(overlayItem, isTopMarker);
}

public void moveTopMarkerToTop(){
    if(topMarkerOverlayItem != null){
        //What to do here?
    }
} 
```

我试图将标记重新评估为`Drawable`，`topMarkerOverlayItem`但没有成功。我还尝试删除并将其添加`topMarkerOverlayItem`到 s 列表中`OverlayItem`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:40:14.820

尝试`ItemizedOverlay`为您的特殊标记做一个额外的，并将其添加到列表`ItemizedOverlay`的末尾。将遍历所有从 0 开始到 Overlays.count()。这样，您的特殊叠加层应该被绘制为最后一个，因此始终位于顶部！`MapView.getOverlays()``MapView``Overlays`

# javascript - 如果变量定义了陷阱，则为 true 或 false

> ID：12976296
> 
> 赞同：-4
> 
> 时间：2012-10-19T14:23:20.403
> 
> 标签：javascript

如果必须将一个值定义为 true 或 false，则基于检查另一个值，是否有任何陷阱：

```
!!someValue 
```

只需快速运行 chrome 的引擎即可：

```
boolCheck=function(someValue){
    return !! someValue;
}

console.log(boolCheck());           //false
console.log(boolCheck(undefined));  //false
console.log(boolCheck(null));       //false
console.log(boolCheck(1));          //true
console.log(boolCheck({va:1}));     //true
console.log(boolCheck("someTS"));   //true
console.log(boolCheck(boolCheck));  //true 
```

哪个似乎有效....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:27:35.177

`!`运算符总是返回`true`or ，因此`false`假设评估`x`正常完成，`!!x`是一个布尔值，相当于EcmaScript 内置函数`Boolean(x)`where is。`Boolean`

[http://es5.github.com/#x11.4.9](http://es5.github.com/#x11.4.9)说

> # 11.4.9 逻辑非运算符 ( `!`)
> 
> 产生*式 UnaryExpression* : `!` *UnaryExpression*的评估如下：
> 
> 1.  令 expr 为计算 UnaryExpression 的结果。
> 2.  让 oldValue 为 ToBoolean(GetValue(expr))。
> 3.  如果 oldValue 是`true`，则返回`false`。
> 4.  返回`true`。

[http://es5.github.com/#x9.2](http://es5.github.com/#x9.2)解释了*ToBoolean 的*工作原理

> # 9.2 ToBoolean
> 
> 根据表 11，抽象操作 ToBoolean 将其参数转换为布尔类型的值：
> 
> 表 11 - ToBoolean 转换
> 
> ```
> Argument Type    Result 
> Undefined        false
> Null             false
> Boolean          The result equals the input argument (no conversion).
> Number           The result is false if the argument is +0, −0, or NaN; otherwise the result is true.
> String           The result is false if the argument is the empty String (its length is zero); otherwise the result is true.
> Object           true 
> ```

* * *

上表解释了您的大部分示例，但原因可能并不明显

> ```
>  console.log(boolCheck()); 
> ```

是`false`。当你调用一个实际参数比形式参数少的函数时，额外的参数有值`undefined`，如上表`!!undefined`所示`false`。

* * *

> 这样做有什么问题吗：`!!someValue`？

其意图不如 清晰`Boolean(someValue)`，但它可以跨平台始终如一地工作，并且大多数有经验的 Javascript 开发人员都会认出它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:01:03.453

这基本上意味着如果它是 0、null、undefined 或 false，则评估为 false，其他任何内容都评估为 true。

顺便说一句，如果在自动转换为布尔值的情况下使用它与仅评估变量本身完全相同。"if(someValue){}" 将与 "if(!!someValue){}" 相同，因为 if 语句会自动将内容评估为布尔值，而 !! 只是在做同样的事情（在那种情况下是多余的）。但显而易见的事实是，当您使用任何类型的布尔值时，99.9999% 的时间最终都会以这种方式进行评估，这就是为什么！除了冗余之外，在代码中确实没有什么位置。

但最后，您对“陷阱”的定义过于模糊，无法在这里理解。我不知道“null”评估为“false”是否会破坏您的预期用途！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:27:14.227

Javascript 不是强类型的，所以如果你**没有**一些值，它会根据传入的类型产生不同的结果。所以是的，有很多陷阱！

# php - SQL 报告颜色

> ID：12976297
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:23:23.407
> 
> 标签：php, sql, popup, report, admin

我们有以下用于报告代理数据库的 sql 代码..

```
<?php
$sql=mysql_query("SELECT Name, sum( Points )AS Total_Points
FROM`allagentper`
GROUP BY Name
ORDER BY Points DESC ");
print"<table >";
print"<tr><th>Name</th><th>Points</th></tr>";
while($row=mysql_fetch_assoc($sql))
{
print"<tr>";
foreach($row as $value)
{

print"<td>";
echo $value ;
print "</td>";
}

print"</tr>";

}

print"</table>";

mysql_close($con);

?> 
```

结束报告显示为以下类型：

```
Name  points
abc     78
dks     65
sge     64
sdf     62    <= Blue
ssr     62    <= Blue
eew     60    <= Blue
asw     60    <= Blue 
```

我需要为 sql 中的每 3 行着色行表。前 3 行将是红色的。第二个 3 行将是蓝色的。但条件是如果点相同，它应该只采用相同的颜色。如果你看到上面的报告示例，sdf、ssr、eew 是蓝色的。但 asw 也与 eew 相同，所以最后 4 行应该是蓝色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:34:34.937

我会做这样的事情

```
<?php
$sql=mysql_query("SELECT name, sum( Points )AS total_points
FROM`allagentper`
GROUP BY Name
ORDER BY Points DESC ");
print"<table >";
print"<tr><th>Name</th><th>Points</th></tr>";
$rowCounter = 0;
$previousTotal = -9999999;
while($row=mysql_fetch_assoc($sql))
{

if($rowCounter % 6 > 3)
{
$color = "#FF0000";
}
else
{
$color = "#0000FF";
}

print"<tr>";
print"<td>".$row->name."</td>";
print"<td style='color:".$color."'>".$row->total_points."</td>";
print"</tr>";

if($row->total_points != $previousTotal)
{
rowCounter++;
}
$previousTotal = $row->total_points;
}

print"</table>";
mysql_close($con);
?> 
```

# shell - su -c 的 ANT SSHEXEC 密码提示问题

> ID：12976300
> 
> 赞同：3
> 
> 时间：2012-10-19T14:23:31.933
> 
> 标签：shell, ant, ssh, automation, build-automation

我试图绕过并发出 ANT / SSHEXEC 命令。

设置：

Solaris 服务器使用 NIS 和基于角色的用户进行运行时活动。

您不能直接登录到 RBAC 帐户，您必须以个人用户身份连接并将 su 连接到该用户 - 我已被告知在此环境中不能选择 SUDO。

所以场景是我正在构建一些 ANT 脚本来构建、部署然后在远程服务器上运行一组脚本。

构建和部署很好，因为这是作为我的用户执行的，但是当尝试使用 SSHEXEC 连接到 su -c $user 时，我遇到了一个问题，shell 以密码提示响应，但我无法输入任何内容。

所以在这里我要么想要一个让我输入密码并继续的解决方案，要么想要一种将密码作为我输入的变量传递给提示的方法。

这是我目前正在使用的代码：

```
<target name="install-products">
  <sshexec host="${remote.host1}" 
    username="${remote.user}" 
    password="${remote.pwd}"
    command="/usr/bin/su - $user -c cd ${remote.install.dir}/OracleSunJDK;./installJAVA.sh -p project -e 935"
    usepty="true"
    trust="true"
    failonerror="true"/>
</target> 
```

所以我以我的用户身份连接，例如 ssh -t cambolie@${remote.host1}... 用户和密码如上所述传递，它的 su -c 然后导致提示出现。

这是目前发生的情况：

```
install-products:
[sshexec] Connecting to ${remote.host1}:22
[sshexec] cmd : /usr/bin/su - ${su-user}  -c cd /var/tmp/weblogic/RP_WEBLOGIC_J2EE_1.0.0.0/install/OracleSunJDK;./installJAVA.sh -p project -e 935
[sshexec] Password: 
```

它只是在这个阶段挂起。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T18:18:23.420

以下是可能的解决方案之一。

1.  `scp`从您的主机到目标机器的基于密钥的设置 。
2.  将构建脚本修改`scp`为标记文件（即`begin.install`零字节文件）
3.  在目标机器上设置一个 cron 来查找标记文件，一旦找到，就启动要在该服务器上执行的一组步骤。完成后，删除标记文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-21T06:49:35.003

这对我有用：

```
 <property name="password" value="MYPASS"/>

    <!-- Keep the closing property tag on the new line as su needs the CR/LF-->
    <property name="password.crlf">${password}<!-- do not remove the CR/LF-->
    </property>
    <!-- Keep the closing property tag on the new line as su needs the CR/LF-->

  <sshexec host="${server}"
                 username="${username1}"
                 password="${password1}"
                 trust="yes"
                 verbose="yes"
                 usepty="true"
                 inputproperty="password.crlf"
                 command="su - otheruser -c ls"
        /> 
```

# php - CRUD HTML 模板在哪里？（在敏捷工具包中）

> ID：12976301
> 
> 赞同：0
> 
> 时间：2012-10-19T14:23:33.667
> 
> 标签：php, frameworks, agile, atk4, agiletoolkit

CRUD HTML 模板在哪里？我在“共享”目录中找不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:46:20.947

CRUD 使用网格和表单模板。

# c++ - 自定义绘图 Listview 项目不改变文本颜色

> ID：12976302
> 
> 赞同：1
> 
> 时间：2012-10-19T14:23:34.883
> 
> 标签：c++, winapi, mfc, wtl

我正在尝试在 WTL 中实现自定义绘制的列表视图，这是列表视图的代码：

```
class CTaskListCtrl:  public CWindowImpl<CTaskListCtrl, CListViewCtrl>,
                   public CCustomDraw<CTaskListCtrl>   
{
public:
    BOOL SubclassWindow(HWND hWnd)
    {
        ATLASSERT(m_hWnd==NULL);
        ATLASSERT(::IsWindow(hWnd));
        BOOL bRet = CWindowImpl<CTaskListCtrl, CListViewCtrl>::SubclassWindow(hWnd);
          return bRet;
   }
   BEGIN_MSG_MAP(CTaskListCtrl)
      CHAIN_MSG_MAP(CCustomDraw<CTaskListCtrl>)
   END_MSG_MAP()

   DWORD OnPrePaint(int /*idCtrl*/, LPNMCUSTOMDRAW /*lpNMCustomDraw*/)
   {        
      return  CDRF_NOTIFYITEMDRAW;
   }

   DWORD OnItemPrePaint(int /*idCtrl*/, LPNMCUSTOMDRAW lpNMCustomDraw)
   {
      NMLVCUSTOMDRAW* pLVCD = reinterpret_cast<NMLVCUSTOMDRAW*>( lpNMCustomDraw );

      COLORREF crText;

      if ( (pLVCD->nmcd.dwItemSpec % 2) == 0 )
         crText = RGB(200,200,255);
      else 
         crText = RGB(255,255,255);   

      pLVCD->clrTextBk = crText;

      return CDRF_DODEFAULT;
    }
}; 
```

这就是我使用它的方式：IDC_LIST_TASKS 是我在资源向导中创建的 ListVieew 资源。

```
CTaskListCtrl m_taskList;
m_taskList.SubclassWindow(GetDlgItem(IDC_LIST_TASKS));

m_taskList.AddColumn( TEXT("Name"),0);
m_taskList.SetColumnWidth(0,100);

m_taskList.AddColumn( TEXT("Algorithm"), 1);
m_taskList.SetColumnWidth(1,100);

m_taskList.AddColumn( TEXT("Status"), 2);
m_taskList.SetColumnWidth(2,100);

m_taskList.AddItem(0,0,L"ASDASD");
m_taskList.AddItem(0,1,L"ASDASD");
m_taskList.AddItem(0,2,L"ASDASD"); 
```

并且项目文本的颜色不会改变。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T11:57:00.993

如果不整理[以前的问题](https://stackoverflow.com/questions/12971062/custom-draw-cprogressbarctrl-win32)，您就会继续发布具有相同问题的新问题。

这段代码没有什么可修复的，太多的东西是错误的。

您可以从工作示例[Lazy Grid WTL 实现](http://www.codeproject.com/Articles/1737/Lazy-Grid-WTL-implementation)、[使用 WTL 的自定义绘制控件](http://www.codeproject.com/Articles/853/Custom-Drawn-Controls-using-WTL)开始，并弄清楚事情是如何工作的。

*   您不需要子类化到自定义绘图
*   自定义绘制通知到达控件的父级，而不是控制自身 - 您需要在父窗口上处理它们，或者`REFLECT_NOTIFICATIONS`在这种情况下，您可以选择在控件上处理它们（并且子类化是有意义的）

# c# - MySQL 的哪种列类型将在 C# 中返回为 System.Guid

> ID：12976303
> 
> 赞同：8
> 
> 时间：2012-10-19T14:23:43.493
> 
> 标签：c#, mysql

> **可能重复：**
> [我应该如何在 MySQL 表中存储 GUID？](https://stackoverflow.com/questions/412341/how-should-i-store-guid-in-mysql-tables)

**VARCHAR**将返回，因为`string`
**BLOB**将返回，`byte[]`
但是，MySQL 的哪种列类型将在 C# 中返回为**System.Guid**
， 谢谢。 编辑：感谢 DaveHogan，

**我找到了答案**，它为我提供了有关 ORM（对象关系映射）的线索， 我开始寻找有关 Connector/NET 进行的数据类型转换（映射）的信息。我正在使用 MySQL Dot Net Connector (Connector/NET) ，Connector/NET 执行不同的 3 种情况。 以下是我发现的：**第一种情况：**从连接器 /NET 6.1.1 开始，**CHAR(36)**将在 C# 和**BINARY(16)中自动转换为 System.GUID**

 ******将被视为 System.Byte[]。

**第二种情况：**
如果您使用较旧的连接器/NET，当值传递到 C# 时， **BINARY(16)**将自动转换为 System.GUID，而**CHAR(36)**将被视为 System.String。

**第三种情况：**
如果您使用较新的 Connector/NET（比 6.1.1 更新），并且如果您想使用**BINARY(16)** AS System.GUID（默认情况下不是），则必须添加连接选项**Old Guids=**在连接字符串中为**真。**
例子：****** 

 ****```
服务器=本地主机；用户=root；密码=qwerty；数据库=测试；旧 guids=true；
```

这样，**CHAR(36)**将被转换为 System.String 和**BINARY(16)** = System.GUID

阅读更多关于**旧 Guid**的连接选项的信息：
[​​MySQL 5.6 参考手册：21.2.6。连接器/网络连接字符串选项参考](http://dev.mysql.com/doc/refman/5.6/en/connector-net-connection-options.html)

------------------------------------------- ---------------
额外信息：
**如何将 System.GUID 插入 MySql 数据库**
----------- -------------------------------------------------- ---------
这是一个示例表，我们将插入 System.GUID：

```
创建表`testdata`（
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `binary` binary(16) 默认为 NULL，
  `char` char(36) 默认为空，
  主键（`id`）
) 引擎=InnoDB AUTO_INCREMENT=1 默认字符集=utf8

```

将 System.GUID 插入 MySQL

```
string constr = "server=localhost;user=root;pwd=qwerty;database=test;";
使用 (MySqlConnection conn = new MySqlConnection(constr))
{
    conn.Open();

    // 创建一个 System.GUID
    字节[] ba = 新字节[16]；
    随机 rd = new Random();
    rd.NextBytes(ba);
    System.Guid guid = new Guid(ba);

    // 以 SQL 格式准备 GUID 值
    字符串 guidForChar36 = guid.ToString();
    字符串十六进制字符串 = BitConverter.ToString(guid.ToByteArray());
    字符串 guidForBinary16 = "0x" + hexstring.Replace("-", string.Empty);

    string sql = "插入测试数据(`binary`,`char`)"
               + "值(" + guidForBinary16 + ","
               + "'" + guidForChar36 + "');";

    MySqlCommand cmd = new MySqlCommand(sql, conn);
    cmd.ExecuteNonQuery();

    conn.Close();
}
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:25:17.163

编辑：

对不起，我误解了你的问题。你应该使用

```
BINARY(16) 
```

如何将其转换为 System.Guid 取决于您是否使用 ORM 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:28:30.000

`CHAR(16)` 如果您想最优化地利用存储空间，您可以将 guid 用作二进制文件。或使用`char(36)`****

# android - 我可以将一个片段放入 FragmentActivity 中的另一个片段中吗

> ID：12976310
> 
> 赞同：2
> 
> 时间：2012-10-19T14:24:05.417
> 
> 标签：android, android-fragments

我有一个 FragmentActivity 这个活动有一个 Fragment 这个 Fragment 由 xml 中定义的小部件和片段组成。

当我开始活动时它崩溃了

```
10-19 13:27:57.470: E/AndroidRuntime(16701): android.view.InflateException: Binary XML file line #43: Error inflating class fragment 
```

是否可以嵌套片段，或者我只能将片段放在 FragmentActivity 中？

编辑：这是位于 FragmentActivity ViewPager 中的片段 xml

膨胀时程序在此文件中崩溃

```
 <com.ssbs.sw.SWE.widget.SeekBarWidget
            android:id="@+id/pa_outlet_characteristics_trading_stocks"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:max="999999"
            android:text="@string/label_outlet_characteristics_trading_stocks" />

        <fragment
            android:id="@+id/pa_outlet_characteristics_spinners"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            class="com.ssbs.sw.SWE.pure.outlet.pages.characteristics.view.components.SpinnersFragment"
            tools:layout="@layout/pf_characteristics_custperday_spinner" />

        <com.ssbs.sw.SWE.widget.SpinnerWidget
            android:id="@+id/pa_outlet_characteristics_proximity_factor"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="?spinerBackground"
            widget:label="@string/label_outlet_characteristics_proximity_factor"
            widget:popupDialogTheme="@style/ActivityDialog"
            widget:spinnerTemplate="@layout/widget_spinner" /> 
```

**更新**

从 11 版本开始在支持库中添加了对嵌套片段的支持

> 支持包，修订版 11（2012 年 11 月）
> v4 支持库的更改：
> 用户界面
> 添加了对嵌套片段类的支持。
> 添加了对 FragmentManager 调试的改进。
> …………

[嵌套片段文档](http://developer.android.com/about/versions/android-4.2.html#NestedFragments)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:27:04.810

使用我不知道的支持 API，但通常无法创建嵌套片段：您可以从另一个片段创建片段，但该片段将仅与创建原始片段的 Activity 通信（如果不清楚，请告诉我)

**编辑 ：**

至于为什么会崩溃，如果不是嵌套的fragment，我就不知道了。也许您应该尝试创建它并以编程方式将其添加到您的布局中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:30:03.947

不允许嵌套片段。（取决于版本）。

**编辑**- 以前不支持它，但它是从版本 11 添加的，如上面的帖子中所述：[https ://developer.android.com/about/versions/android-4.2.html#NestedFragments](https://developer.android.com/about/versions/android-4.2.html#NestedFragments)

# google-apps-script - 如何在谷歌电子表格中修改或复制共享屏幕

> ID：12976311
> 
> 赞同：1
> 
> 时间：2012-10-19T14:24:10.007
> 
> 标签：google-apps-script, google-sheets

我有一个表格，我希望我的员工每天填写。为此，我在电子表格中添加了一个脚本，以自动通过电子邮件将表单链接发送给与电子表格共享的每个人。每周还会有一封电子邮件回复他们的回复。我已将所有共享用户存储在 ScriptDb 中。我想做的是编写一个允许设置用户首选项的 UiApp，以便可以禁用每日/每周电子邮件。我还希望能够在这里添加没有与他们共享工作表的新用户（对于那些只有链接的人）。我的整个公司都使用谷歌，所以我不必担心有人没有登录或没有访问权限。

起初，我尝试创建一个简单的 UiApp 表单，该表单仅显示现有共享用户以及电子邮件首选项复选框。我的 doPost 从未被调用，我仍然不确定为什么。但是，我真正想要的是一个看起来就像共享设置屏幕但没有编辑/查看访问权限的屏幕，我将拥有用户首选项。将用户添加到我的自定义屏幕版本不会将他们添加为协作者或查看者。

关于如何使用 UiApp 重新创建共享屏幕的任何想法？

如果这是不可能的，那么我在当前的简单偏好屏幕中做错了什么？

```
function editUserPreferences() {
var ss = SpreadsheetApp.getActiveSpreadsheet();

updateUserPreferences();
var db = ScriptDb.getMyDb();
var results = db.query({});
var saveUserRow = [];

//define form
var app = UiApp.createApplication().setTitle("Edit User's Email Preferences");
app.setHeight(550).setWidth(800);
var form = app.createFormPanel().setId('frm');
var formContent = app.createGrid(results.getSize()+5,3);
formContent.setWidget(0, 0, app.createLabel('Email Address'));
formContent.setWidget(0, 1, app.createLabel('Receive Daily'));
formContent.setWidget(0, 2, app.createLabel('Receive Weekly'));
formContent.setWidget(1, 1, app.createLabel('Reminder'));
formContent.setWidget(1, 2, app.createLabel('Entries'));

var row = 2;  
while (results.hasNext()) {
var obj = results.next();
row = row+1;
formContent.setWidget(row, 0, app.createTextBox().setValue(obj.email).setReadOnly(true));
formContent.setWidget(row, 1, app.createCheckBox().setValue(obj.preferences.dailyEmail).setName('daily' + row));
formContent.setWidget(row, 2, app.createCheckBox().setValue(obj.preferences.weeklyEmail).setName('weekly' + row));
obj.row = row;
saveUserRow.push(obj);
}

// file changes
var results = db.saveBatch(saveUserRow, false);
if (db.allOk(results)) {
// everything went swimmingly, proceed
} 
else {  // partial or no success
for (var i = 0 ; i < results.length; i++) {
var item = results[i];
if ((typeof item.success) == 'function' && !item.success()) {
MailApp.sendEmail(Session.getActiveUser().getEmail(), "Error Updating Script Database", Logger.getLog());
}
}
}

row = row + 2;
formContent.setWidget(row, 1, app.createSubmitButton('Submit'));

form.add(formContent);
app.add(form);
ss.show(app);
}

function doPost(e) {
var ss = SpreadsheetApp.getActiveSpreadsheet();
var app = UiApp.getActiveApplication();
var db = ScriptDb.getMyDb();
var results = db.query({});
var editedUserData = [];

Logger.log("in doPost");
while (results.hasNext()) {
var obj = results.next();
var dailyParam = "daily" + obj.row;
var weeklyParam = "weekly" + obj.row;
Logger.log("test");
Logger.log(obj.email);
Logger.log(dailyParam);
Logger.log(weeklyParam);
obj.preferences.dailyEmail = e.parameter.dailyParam;
obj.preferences.weeklyEmail = e.parameter.weeklyParam;
Logger.log(Utilities.jsonStringify(obj));
editedUserData.push(obj);
}

app.close();
return app;
} 
```

doPost 没有记录任何内容，执行事务中的最后一个条目是：

```
FormPanel.getId()
FormPanel.getId()
UiInstance.isStandardsMode() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T18:44:25.917

Kmt - 无法以编程方式控制共享屏幕。你必须像在这里一样重建它。

关于您与 doPost 的问题 - 我认为它有效。我认为在 doPost 中生成的日志存在记录器问题（异步不起作用）。尝试在 doPost 中创建文件或附加到电子表格中，这将起作用。

# python - py2exe 找不到目标脚本

> ID：12976312
> 
> 赞同：1
> 
> 时间：2012-10-19T14:24:12.223
> 
> 标签：python, py2exe

这是我的 setup.py：

```
from distutils.core import setup
import py2exe, sys, os

sys.argv.append('py2exe')

setup(
    options = {'py2exe': {'bundle_files': 1}},
    console = [{'script': "target.py"}],
    zipfile = None,
) 
```

target.py 与 setup.py 位于同一目录中，当我运行命令时（必须使用完整路径，否则它甚至没有得到此响应）：

```
C:\Python\app\python.exe C:\Final\setup.py py2exe 
```

命令的响应是：

```
running py2exe
*** searching for required modules ***
error: target.py: No such file or directory 
```

我不确定我做错了什么，这可能很愚蠢。如果有人有任何想法，我将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T00:41:56.797

只需将您当前的工作目录更改为`C:\Final\`使用`cd`命令并运行： `C:\Python\app\python.exe setup.py py2exe`

# csv - 在 GO 错误中写入 csv

> ID：12976318
> 
> 赞同：3
> 
> 时间：2012-10-19T14:24:24.710
> 
> 标签：csv, go

我正在尝试使用 GO 附带的标准库“encoding/csv”写入 GO 中的 csv 文件。但是，没有任何内容被写入文件，也没有返回错误。下面是编写代码。地图中的值是字符串数组。感谢您提前提供任何帮助。

```
func writeErrors() {

    file, error := os.OpenFile("output.csv", os.O_APPEND|os.O_CREATE, 0666 )

    if error != nil {panic(error)}
    defer file.Close()

    // New Csv writer
    writer := csv.NewWriter(file)

    // Headers
    var new_headers = []string { "group_id", "account_id", "location_id", "payment_rating", "records_with_error" }
    returnError := writer.Write(new_headers)
    if returnError != nil {
        fmt.Println(returnError)
    }

    for key, value := range errors {
        returnError := writer.Write(value)
        if returnError != nil {
            fmt.Println(returnError)
        }
        fmt.Println("Writing: ", key, value)
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T15:14:56.860

还有一个附加标志，因为您直接调用 os.OpenFile 而不是通过 os.Create 为您传递 O_RDWR。您需要将 O_RDWR 或 O_WRONLY 与您的 O_APPEND | 一起传递。O_CREATE 标志。

O_APPEND 仅用于表示写入时应将写入内容附加到文件末尾，它本身并未指定打开模式。

附加说明：您使用“error”作为变量名，这实际上是Go中的一种类型，通常用于命名错误返回变量的成语是“err”

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-26T14:47:14.627

你需要打电话`writer.Flush()`后`writer.Write()`

```
//from package documentation

func (w *Writer) Flush()
Flush writes any buffered data to the underlying io.Writer. 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T14:44:07.923

`os.Create`打开一个可写文件，可以从[源代码](http://golang.org/src/pkg/os/file.go?s=7058:7106#L228)和[文档中了解到](http://golang.org/pkg/os/#Create)

# c# - xUnit.net：全局设置 + 拆卸？

> ID：12976319
> 
> 赞同：137
> 
> 时间：2012-10-19T14:22:30.533
> 
> 标签：c#, .net, xunit.net

这个问题是关于单元测试框架[xUnit.net](https://xunit.net/)的。

我需要在执行任何测试之前运行一些代码，以及在所有测试完成后运行一些代码。我认为应该有某种属性或标记接口来指示全局初始化和终止代码，但找不到它们。

或者，如果我以编程方式调用 xUnit，我也可以使用以下代码实现我想要的：

```
static void Main()
{
    try
    {
        MyGlobalSetup();
        RunAllTests();  // What goes into this method?
    }
    finally
    {
        MyGlobalTeardown();
    }
} 
```

谁能给我一个关于如何以声明方式或编程方式运行一些全局设置/拆卸代码的提示？

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2013-05-16T14:48:16.560

据我所知，xUnit 没有全局初始化/拆卸扩展点。但是，创建一个很容易。只需创建一个基测试类，该类`IDisposable`在构造函数中实现并进行初始化，并在`IDisposable.Dispose`方法中进行拆卸。这看起来像这样：

```
public abstract class TestsBase : IDisposable
{
    protected TestsBase()
    {
        // Do "global" initialization here; Called before every test method.
    }

    public void Dispose()
    {
        // Do "global" teardown here; Called after every test method.
    }
}

public class DummyTests : TestsBase
{
    // Add test methods
} 
```

但是，每次调用都会执行基类设置和拆卸代码。这可能不是您想要的，因为它不是很有效。更优化的版本将使用该`IClassFixture<T>`接口来确保全局初始化/拆卸功能仅被调用一次。对于此版本，您不会从测试类扩展基类，而是实现引用您的夹具类的`IClassFixture<T>`接口：`T`

```
using Xunit;

public class TestsFixture : IDisposable
{
    public TestsFixture ()
    {
        // Do "global" initialization here; Only called once.
    }

    public void Dispose()
    {
        // Do "global" teardown here; Only called once.
    }
}

public class DummyTests : IClassFixture<TestsFixture>
{
    public DummyTests(TestsFixture data)
    {
    }
} 
```

这*将*导致构造函数`TestsFixture`只为每个被测类运行一次。因此，这取决于您想要在两种方法之间进行选择。

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2017-02-01T17:22:17.253

我一直在寻找相同的答案，此时 xUnit 文档对于如何实现类夹具和集合夹具非常有帮助，它们为开发人员提供了类或类组级别的广泛设置/拆卸功能。这与 Geir Sagberg 的回答一致，并提供了良好的框架实现来说明它应该是什么样子。

[https://xunit.net/docs/shared-context](https://xunit.net/docs/shared-context)

> Collection Fixtures 何时使用：当你想创建一个单独的测试上下文并在多个测试类中的测试之间共享它，并在测试类中的所有测试完成后清理它。

> 有时您会希望在多个测试类之间共享一个夹具对象。用于类夹具的数据库示例是一个很好的示例：您可能希望使用一组测试数据初始化数据库，然后将该测试数据保留在适当的位置以供多个测试类使用。您可以使用 xUnit.net 的集合夹具功能在多个测试类中的测试之间共享单个对象实例。

> 要使用集合夹具，您需要执行以下步骤：

> 创建夹具类，并将启动代码放入夹具类构造函数中。如果fixture类需要进行清理，在fixture类上实现IDisposable，将清理代码放在Dispose()方法中。创建集合定义类，用 [CollectionDefinition] 属性装饰它，给它一个唯一的名称来标识测试集合。将 ICollectionFixture<> 添加到集合定义类。使用您提供给测试集合定义类的 [CollectionDefinition] 属性的唯一名称，将 [Collection] 属性添加到将成为集合一部分的所有测试类。如果测试类需要访问夹具实例，请将其添加为构造函数参数，它将自动提供。这是一个简单的例子：

```
public class DatabaseFixture : IDisposable
{
    public DatabaseFixture()
    {
        Db = new SqlConnection("MyConnectionString");

        // ... initialize data in the test database ...
    }

    public void Dispose()
    {
        // ... clean up test data from the database ...
    }

    public SqlConnection Db { get; private set; }
}

[CollectionDefinition("Database collection")]
public class DatabaseCollection : ICollectionFixture<DatabaseFixture>
{
    // This class has no code, and is never created. Its purpose is simply
    // to be the place to apply [CollectionDefinition] and all the
    // ICollectionFixture<> interfaces.
}

[Collection("Database collection")]
public class DatabaseTestClass1
{
    DatabaseFixture fixture;

    public DatabaseTestClass1(DatabaseFixture fixture)
    {
        this.fixture = fixture;
    }
}

[Collection("Database collection")]
public class DatabaseTestClass2
{
    // ...
} 
```

> xUnit.net 对待集合夹具的方式与类夹具非常相似，只是集合夹具对象的生命周期更长：它是在集合中的任何测试类中运行任何测试之前创建的，并且不会被清理直到集合中的所有测试类都完成运行。

> 测试集合也可以用 IClassFixture<> 装饰。xUnit.net 将其视为测试集合中的每个单独的测试类都用类固定装置装饰。

> 测试集合也会影响 xUnit.net 在并行运行测试时的运行方式。有关更多信息，请参阅并行运行测试。

> 重要提示：fixtures 必须与使用它们的测试在同一个程序集中。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-03-26T12:10:58.107

有一个简单易行的解决方案。使用 Fody.ModuleInit 插件

[https://github.com/Fody/ModuleInit](https://github.com/Fody/ModuleInit)

这是一个 nuget 包，当您安装它时，它会添加一个名为`ModuleInitializer.cs`项目的新文件。这里有一个静态方法，它在构建之后被编织到程序集中，并在加载程序集和运行任何东西之前立即运行。

我用它来解锁我购买的库的软件许可证。我总是忘记在每个测试中解锁许可证，甚至忘记从可以解锁它的基类派生测试。编写这个库的明亮火花，而不是告诉你它是许可证锁定的，而是引入了细微的数字错误，导致测试在不应该的情况下失败或通过。你永远不会知道你是否正确地解锁了图书馆。所以现在我的模块初始化看起来像

```
/// <summary>
/// Used by the ModuleInit. All code inside the Initialize method is ran as soon as the assembly is loaded.
/// </summary>
public static class ModuleInitializer
{
    /// <summary>
    /// Initializes the module.
    /// </summary>
    public static void Initialize()
    {
            SomeLibrary.LicenceUtility.Unlock("XXXX-XXXX-XXXX-XXXX-XXXX");
    }
} 
```

并且放入此程序集中的所有测试都将为它们正确解锁许可证。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-11-04T07:40:38.787

要在多个类之间共享 SetUp/TearDown-code，您可以使用 xUnit 的[CollectionFixture](https://xunit.net/docs/shared-context#collection-fixture)。

引用：

> 要使用集合夹具，您需要执行以下步骤：
> 
> *   创建夹具类，并将启动代码放入夹具类构造函数中。
> *   如果fixture类需要进行清理，在fixture类上实现IDisposable，将清理代码放在Dispose()方法中。
> *   创建集合定义类，用 [CollectionDefinition] 属性装饰它，给它一个唯一的名称来标识测试集合。
> *   将 ICollectionFixture<> 添加到集合定义类。
> *   使用您提供给测试集合定义类的 [CollectionDefinition] 属性的唯一名称，将 [Collection] 属性添加到将成为集合一部分的所有测试类。
> *   如果测试类需要访问夹具实例，请将其添加为构造函数参数，它将自动提供。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-11-26T13:50:45.613

如果你有一个全局初始化和全局清理函数，你可以这样写类：

```
[CollectionDefinition("TestEngine")]
public class TestEngineInitializer: IDisposable, ICollectionFixture<TestEngineInitializer>
{
    public TestEngineInitializer()
    {
        MyOwnTestEngine.Init();
    }

    public void Dispose()
    {
        MyOwnTestEngine.Cleanup();
    }
} 
```

对于每个需要执行此初始化的测试类，您需要添加额外的属性：

```
[Collection("TestEngine")]
public class MyTests
{ 
```

重要提示：`Collection`和`CollectionDefinition`-attributes 中使用的名称必须匹配。

您还可以在构造函数中使用提供 TestEngine 类实例，例如：

```
[Collection("TestEngine")]
public class MyTests
{
     public MyTests(TestEngineInitializer initializer)
     {
     } 
```

但这不是强制性的。

有关问题的完整文档位于此处：

[https://xunit.net/docs/shared-context](https://xunit.net/docs/shared-context)

# scala - 是否可以将 Akka 配置为使用阻塞或非阻塞 i/o？

> ID：12976323
> 
> 赞同：0
> 
> 时间：2012-10-19T14:24:41.677
> 
> 标签：scala, blocking, akka, actor, nonblocking

是否可以将 Akka 配置为使用阻塞或非阻塞 i/o？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-21T11:37:15.457

Akka IO 是非阻塞的，请参考文档：[http ://doc.akka.io/docs/akka/2.0.3/scala/io.html](http://doc.akka.io/docs/akka/2.0.3/scala/io.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T06:49:27.857

Akka 是一个用于并发和并行执行的参与者系统。因此，您将基于事件的消息传递给参与者以使他们执行操作。当您发送消息时，它会进入参与者的输入队列，让发送者去做其他事情。但是发送者可以持有一个未来，然后在它想要收集结果时阻止。

Actor 本身可能会使用阻塞 i/o，但这不会阻塞 Actor 的客户端。

# mongodb - 如何选择 NoSQL 数据库引擎？

> ID：12976327
> 
> 赞同：4
> 
> 时间：2012-10-19T14:24:52.387
> 
> 标签：mongodb, cassandra, redis, high-load, nosql

我们有一个包含以下参数的数据库：

*   30k 条记录，7mb 大小
*   20 次插入/秒
*   1000 次更新/秒
*   1000 范围选择/秒，按二级索引，每个大约 10 行
*   至少需要一个二级索引
*   如果密钥在 75 秒内未更新，则需要某种机制来使密钥过期（可以通过编程垃圾收集器完成，但需要额外的“last_update”索引并增加一些负载）
*   不需要一致性
*   不需要耐久性
*   db 应该存储在内存中

目前我们使用 Redis，但它没有二级索引，而且`keys index:foo:*`速度太慢。Membase 也没有二级索引（据我所知）。MongoDB 和 MySQL 内存引擎都有表级锁。什么引擎适合我们的用例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:03:32.393

我认为 Redis 确实支持二级索引，但它们不是隐含的：你必须明确地维护它们。排序集可用于范围扫描，但不如 MongoDB 或关系数据库中的方便。

如果您正在寻找对范围扫描提供更好支持的类似 Redis 的服务器，我建议您查看已停产的 AlchemyDB 项目或 Aerospike 3（商业）产品（其中包含 AlchemyDB 的部分功能）。

*   [http://code.google.com/p/alchemydatabase/](http://code.google.com/p/alchemydatabase/)

*   [http://www.aerospike.com/](http://www.aerospike.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T09:43:05.680

尝试使用[http://tarantool.org/](http://tarantool.org/) 它有二级索引并且完全在内存中。它还使用快速异步 IProto 协议。

事实证明它稳定且速度惊人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T21:28:27.990

我在想他的意思是 7mb / 记录。另一种选择是在 Cassandra 之上使用 Scalable-SQL 的 PlayOrm ......更多的机器可以带来更好的性能，因为磁盘将在范围扫描等上并行工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-20T05:30:43.233

我认为，如果您可以达到您指定的性能要求，那么数据库是否在内存中的事实将是无关紧要的。

您的性能目标完全在单个、非复制和非分片 MongoDB 实例的能力范围内。Mongo 使用内存映射文件，因此所有数据都将在内存中，但数据库将不断刷新到磁盘。默认情况下，Mongo 使用“不安全”模式，这消除了磁盘 I/O 的大部分负担。对于您的用例值得考虑，而不是尝试在应用程序代码中执行数据库应该为您执行的操作。

添加副本（Mongo 的集群术语）和/或分片将使您有机会在需要时轻松提高性能。多个索引（包括复合索引）、灵活的查询、批量插入和原子更新是有助于提高性能并减轻应用程序代码负担的好功能。

# hibernate - 测试 Hibernate JPA 时出错

> ID：12976328
> 
> 赞同：4
> 
> 时间：2012-10-19T14:24:54.637
> 
> 标签：hibernate, jpa

我创建了一个 jUnit 测试来测试我的代码，当我尝试实例化我的对象时，我收到了这个错误

```
java.lang.IllegalAccessError: tried to access method org.hibernate.cfg.Configuration.<init>(Lorg/hibernate/cfg/SettingsFactory;)V from class org.hibernate.ejb.Ejb3Configuration
    at org.hibernate.ejb.Ejb3Configuration.<init>(Ejb3Configuration.java:134)
    at org.hibernate.ejb.HibernatePersistence.createEntityManagerFactory(HibernatePersistence.java:124)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:63)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:47)
    at gov.ic.isso.sentry.rest.data.CeReportDaoImpl.init(CeReportDaoImpl.java:41)
    at gov.ic.isso.sentry.rest.data.DaoBase.<init>(DaoBase.java:20)
    at gov.ic.isso.sentry.rest.data.CeReportDaoImpl.<init>(CeReportDaoImpl.java:33)
    at gov.ic.isso.sentry.rest.AppTest.testApp(AppTest.java:41)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at junit.framework.TestCase.runTest(TestCase.java:168)
    at junit.framework.TestCase.runBare(TestCase.java:134)
    at junit.framework.TestResult$1.protect(TestResult.java:110)
    at junit.framework.TestResult.runProtected(TestResult.java:128)
    at junit.framework.TestResult.run(TestResult.java:113)
    at junit.framework.TestCase.run(TestCase.java:124)
    at junit.framework.TestSuite.runTest(TestSuite.java:243)
    at junit.framework.TestSuite.run(TestSuite.java:238)
    at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:83) 
```

我的 init 方法的代码是

```
protected void init() {
        emf = Persistence.createEntityManagerFactory("ceDataSessionData");

        em = emf.createEntityManager();
    } 
```

我的 jUnit 测试是

```
 public void testApp()
    {
        CeReportDao reportDao = new CeReportDaoImpl();
        try {
            reportDao.getMoneyTransferReportJson(100, "TESTUSER1", "NS", null);
        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-08T20:12:25.167

我意识到这是一个旧线程，但我只是想添加一些额外的信息。我在我们的`Java 1.7`项目中使用`maven 3.3.3`.

在我将依赖项添加到我们的一个工件之前，我们使用的集成测试`Spring 3.1.4`运行良好。`hibernate-annotations (ver. 3.5.4)`然后下游工件开始具有上述相同`IllegalAccessError`内容。

在花了几个小时试图找出问题的原因之后，我能够通过更改我之前添加到`hibernate-entitymanager`依赖项中的 hibernate-annotations 依赖项来修复它。这解决了下游集成测试问题。

我提到这一点的唯一一点是要注意，我从来没有在`classpath`. Maven 将所有休眠版本显示为 3.5.4，除了一些应该具有不同版本的 jar（例如，`hibernate-common-annotations 3.2.0`）。所以，我相信上面关于拥有不同 Hibernate jar 的评论不是我的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:46:22.717

@Vikdor 已回答问题：

> 似乎是类路径中不兼容的休眠 jar。您能否列出与休眠相关的 jar 及其版本？

这就是问题所在。我有一个依赖项目，它正在为休眠提取旧版本的实体类，因此该项目正在提取最新版本。

# networking - 如果您通过自己的 IP 连接到您的计算机，流量是否会离开您的 NIC，然后又回来？

> ID：12976333
> 
> 赞同：10
> 
> 时间：2012-10-19T14:25:06.147
> 
> 标签：networking, tcp, network-protocols

我相信如果您使用 127.0.0.1 流量永远不会离开 NIC，但我想知道当您使用计算机的实际 IP 地址时是否也是如此。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T15:18:05.410

不，不是的。即使该地址绑定到物理网络端口，您的操作系统也会将其识别为本地地址并在内部环回。

作为一个简单的测试，拉网线。您仍然可以在本地进行通信。（请注意，如果操作系统检测到电缆已被移除，则 DHCP 提供的地址可能会被撤销；您可能必须在尝试此测试之前配置静态 IP 地址。）

此外，集线器（可能还有许多/大多数交换机）不会将传出的数据包传回线路，因此“在线路上传输”也不适用于大多数网络设备。

# java - 配置调度程序 Servlet 以连接到其他主机

> ID：12976334
> 
> 赞同：-2
> 
> 时间：2012-10-19T14:25:07.340
> 
> 标签：java, file, unix, upload, dispatcher

我有一个上传程序，它上传文件并将其保存到部署此应用程序的指定主机。

我想将此文件保存到其他主机。有人可以指导我必须对相同或任何其他替代的调度程序 servlet 进行哪些更改吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-19T14:31:05.380

我建议在 Servlet 中打开与其他主机的新连接，并使用该连接上传文件。

```
 int contentChar = null;
 FileInputStream inputStream = new FileInputStream(getfileRootDir()+ "/"+fileId));

 URL oracle = new URL("other server url");
 HttpURLConnection connection = (HttpURLConnection)url.openConnection();
 OutputStream outPutStream = connection.getOutputStrea()
 while ((contentChar = inputStream.read()) != -1) {
      outPutStream.write(contentLine );
 }
 inputStream .close();
 outPutStream.close(); 
 connection.close(); 
```

如果您想从效率的角度使用 BufferredReader/Writer，您可能需要编写如下：

```
 String contentLine = null;
   BufferedReader reader = new BufferedReader(
                                    new FileReader(getfileRootDir()+ "/"+fileId));

   URL oracle = new URL("other server url");
   HttpURLConnection connection = (HttpURLConnection)url.openConnection();
   OutputStream outPutStream = connection.getOutputStrea()
   Writer streamWriter = new BufferedWriter(new OutputStreamWriter(outPutStream ));
   while ((contentLine = reader.readLine()) != null) {
        streamWriter.write(contentLine );
   }
   reader.close();       
   streamWriter.close();
   outPutStream .close(); 
   connection.close(); 
```

# jetty - Basex servlet 看不到现有数据库

> ID：12976335
> 
> 赞同：2
> 
> 时间：2012-10-19T14:25:07.643
> 
> 标签：jetty, centos, war, basex

我有一个在 linux 机器上运行的现有 basex 安装。安装运行良好，我可以编辑 .basex 文件以将任何执行指向主数据库，并且可以从任何地方运行客户端并进行连接。

我还让 jetty6 与 basex war 包一起运行，该包也可以运行、可访问并返回有效的休息响应。

我的问题是其余响应显示没有可用资源，据我所知，这意味着它没有连接到我现有的数据库，而是创建（或创建）它自己的。我已将 web.xml 的 dbpath 变量更改为我在 .basex 文件中使用的 BaseXData 路径，重新打包了 .war，然后重新启动了 jetty，但没有成功。

我需要更改什么才能使 basex 的 servlet 看到已经可用的数据库文件夹？

更新：每次我运行 servlet 时，它似乎都指向战争中的数据文件夹，无论我在 web.xml 中的 dbpath 参数中放了什么。我假设 /myfolder/BaseXData 将被视为绝对路径，但战争似乎默认为它的数据文件夹而没有给我一个错误，它没有看到我告诉它去。

我可以通过用符号链接替换数据文件夹来将我的数据构建到战争中，但这不会让更改持续存在，因此它不是一个完整的解决方案。

似乎最新版本的 Basex 应该通过构建它的其余组件来解决这个问题，但它似乎还没有在 CentOS 上可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T20:54:30.077

升级到 7.5（在撰写本文时是稳定的开发），其中包含 http 服务而无需战争打包。更改 .basex 配置以匹配现有数据库，因为在 7.3 下工作以进行本地访问，一切都很好。

感谢 Christian Grün 通过 basex 邮件列表提供的帮助。

# django-templates - 使用两种 django 酥脆形式

> ID：12976341
> 
> 赞同：4
> 
> 时间：2012-10-19T14:25:25.927
> 
> 标签：django-templates, django-crispy-forms

我很难同时使用两种 django 酥脆的形式。我有一个表单可以将新数据输入到我的应用程序中，另一个表单显示在引导模式中供用户提供反馈。下面，我已经将我的模板剥离到了最基本的部分。

我有一个小组表格：

```
class Crispy_Group_Form(forms.ModelForm):

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        # self.helper.form_tag = False
        self.helper.form_class = 'form-horizontal'
        self.helper.layout = Layout(
            Fieldset(
                'New Group',
                Field('name', placeholder='Group Name'),
                Field('notes', placeholder='Group Notes', rows='10', css_class='input-xxlarge'),
            ),
            FormActions(
                Submit('save_changes', 'Save changes', css_class="btn-primary"),
                HTML(' | '),
                Submit('cancel', 'Cancel'),
            )
        )
        self.helper.form_id = 'id-Crispy_Group_Form'
        self.helper.form_method = 'post'

        super(Crispy_Group_Form, self).__init__(*args, **kwargs)        

    class Meta:
        model = Group
        exclude = ['slug'] 
```

和联系表格

```
class Crispy_ContactForm(forms.ModelForm):

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_class = 'form ajax'
        self.helper.form_action = 'feedback'
        self.helper.form_tag = False
        self.helper.layout = Layout(
            Fieldset(
                'Contact Form',
                Field('topic', placeholder='Topic', css_class='input-medium'),
                Field('subject', placeholder='Subject', css_class='input-xlarge'),
                Field('message', placeholder='Message', rows='5', css_class='input-xlarge'),
                Field('sender', placeholder='Sender', css_class='input-xlarge'),
            ),
        )
        self.helper.form_id = 'id-Crispy_ContactForm'
        self.helper.form_method = 'post'

        super(Crispy_ContactForm, self).__init__(*args, **kwargs)

    class Meta:
        model = Feedback
        exclude = ['creation_date'] 
```

我的观点：

```
def bootstrap_test(request):

    return render_to_response(
        "bootstrap_test.html", {
            'feedback_form' : Crispy_ContactForm,
            'form' : Crispy_Group_Form,
        },
        context_instance=RequestContext(request)) 
```

还有我非常基本的模板：

```
{% load crispy_forms_tags %}

<form action="{% url feedback %}" method="post" id="id-Crispy_ContactForm" class="form">
    {% crispy feedback_form %}
</form>

{% crispy form %} 
```

feedback_form 显示两次。好像两种形式都是同一种形式。如果我从模板中删除 feedback_form，那么它会显示 Group 表单。如果我重新排列两者，使 {% crispy form %} 在 feedback_from 上方，它会正确显示两种不同的形式。

[我阅读了文档](http://django-crispy-forms.readthedocs.org/en/d-0/tags.html#rendering-several-forms-with-helpers)，但找不到有效的方法。

为什么会发生这种情况，我需要调整什么才能正确显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T18:35:07.310

好，我知道了。看起来酥脆的表格覆盖了“表格”变量。这就是为什么它返回相同的两种形式：

```
<form action="{% url feedback %}" method="post" id="id-Crispy_ContactForm" class="form">
    {% crispy feedback_form %}
</form>

{% crispy form %} 
```

但这会返回两种不同的形式：

```
{% crispy form %}

<form action="{% url feedback %}" method="post" id="id-Crispy_ContactForm" class="form">
    {% crispy feedback_form %}
</form> 
```

第一个示例在第二个表单调用可以获取变量“form”之前覆盖它。

我只是想确认这不是我做错了什么。所以我只是颠倒了调用这两个表单的顺序，以便首先出现 {% crispy form %} 的实例。我不能为表单使用不同的变量，因为我正在使用 create/update_object 函数。

# .htaccess - 使用 .htaccess 清理 URL

> ID：12976342
> 
> 赞同：2
> 
> 时间：2012-10-19T14:25:28.620
> 
> 标签：.htaccess, mod-rewrite, clean-urls

我正在尝试重定向我域上的链接。我想要实现的是：当用户点击链接到

`mydomain.com/index.php?dir=myfolder`

我希望他被重定向到这个 URL，但浏览器栏应该显示这个 URL：

`mydomain.com/myfolder`

由于我无权访问链接的建立方式（它是一个 php 站点），因此我试图仅使用 .htaccess 文件来执行此操作。

这就是我所拥有的：

```
RewriteEngine on
RewriteBase /
RewriteCond %{HTTP_HOST} subdomain.mydomain.com
RewriteCond %{REQUEST_URI} (.*)/style.css [OR]
RewriteCond %{REQUEST_URI} (.*)/script.js [OR]
RewriteCond %{REQUEST_URI} (.*)/logo.png
RewriteRule (.*) http://www.subdomain.com%{REQUEST_URI} [R=301,NC,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?dir=$1 [L] 
```

所以当我进入`"mydomain.com/myfolder"`浏览器时它工作正常，地址栏中的 URL 保持这样。但是当我输入`"mydomain.com/index.php?dir=myfolder"`它时它也可以工作，但 URL 也保持不变（这不是我想要的）。我假设我需要以某种方式使用 .htaccess 文件更改 URL，然后（正如我已经拥有的那样）将其重写为然后 php-scheme。我现在做了几种方法，但我不知道该怎么做。我希望你能理解我的问题并能帮助我！

谢谢！

```
EDIT: 
```

解决方案（感谢@anubhava）：

```
RewriteEngine on
RewriteBase /

RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+index\.php\?dir=([^\s]+) [NC]
RewriteRule ^ %1? [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?dir=/$1 [L] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:55:14.677

只需将此规则附加到现有 .htaccess 文件的末尾：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+index\.php\?dir=([^\s]+) [NC]
RewriteRule ^ %1? [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:41:48.443

我认为您的问题是关于`/index.php?dir=example`重定向到`/example`. 以下示例发出永久重定向：

```
RewriteRule ^index\.php\?dir=?$ /$1 [NC,R=301,L] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:34:20.340

要将格式的 URL 美化`mydomain.com/index.php?dir=myfolder`为`mydomain.com/myfolder`，请在文件中尝试以下重写规则`.htaccess`：

```
RewriteEngine on
RewriteRule ^([^/\.]+)/?$ /index.php?dir=$1 [L] 
```

# c - C：如何摆脱转换错误？

> ID：12976343
> 
> 赞同：4
> 
> 时间：2012-10-19T14:25:28.133
> 
> 标签：c, gcc, casting

我有一个使用 gcc 版本 4.6.3 的项目，我被迫使用“-Wall -Werror -Wconversion”进行编译。以下简单示例显示了一个我无法摆脱的错误：

```
#include <stdint.h>

int main(void) {
  uint32_t u = 0;
  char c = 1;

  u += c;
  return (int)u;
} 
```

使用上述标志编译它会给出：

```
test.c:7:8: error: conversion to ‘uint32_t’ from ‘char’ may change the sign of the result [-Werror=sign-conversion] 
```

好的。只需添加一个类型转换，对吗？没有。将第 7 行更改为`u += (uint32_t)c`不会使错误消失。即使将其更改为`u = u + (uint32_t)c`也不会使其消失。

有可能解决这个问题吗？

请注意，“char”来自一个字符串，所以我没有选择更改其类型的选项。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T14:30:46.223

问题在于有符号（负）字符。你可以试试

```
 u += (unsigned) (c&0xff); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:19:46.530

这在这里编译得很好：

```
u += (unsigned char)c; 
```

然而，这只*会使警告静音*`c`——不像 Basile 的提议，在运行时不对每个警告做任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:44:44.727

问题是您想要哪种转换。如果您想要标准定义的转换，您显然需要分配`c`给（临时）`uint32_t`变量。

```
uint32_t temp = (uint32_t)c;
u += temp; 
```

按预期工作（至少在我的 gcc-4.6.2 中）。

如果这不是预期的转换 - 但你为什么要明确要求它使用`(uint32_t)c`？- Basile Starynkevich 或 Mikhail T. 建议的解决方案，否则`-funsigned-char`标志将消除警告。

IMO 这是 gcc 中的一个（可怕的）错误，并且 clang 似乎同意，`u += (uint32_t)c;`在那里按预期工作。

# indexing - SAS：如何基于字符串变量创建索引变量？

> ID：12976346
> 
> 赞同：1
> 
> 时间：2012-10-19T14:25:47.443
> 
> 标签：indexing, sas

我想创建一个顺序索引变量。例如，我在网站中有独特的网站和部分：

站点 1 1 2 2 3 3

ABABAB 节

站点-部分组合是独一无二的。我想要一个唯一的顺序索引变量，以便站点 1、部分 A=1 和站点 1、部分 B=2 和站点 2 部分 A=3，依此类推。

站点 1 1 2 2 3 3

ABABAB 节

索引 1 2 3 4 5 6

我试过先用。最后。带有do循环的函数，我就是想不通。无论如何，我对do循环不是很好。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:15:37.967

您的解决方案是完全合理的，特别是如果您不确定是否只有站点部分的唯一值。如果您确定它们是唯一的（因此，NODUPRECS 不会删除任何内容），那么您可以简化它并删除合并：

```
data final;
set dataset;
sectionIndex+1;
run; 
```

如果您希望它们以正确的顺序排列，可以选择在数据步之前进行排序。

如果您想避免合并（如果数据集非常大）并且您不确定它们是唯一的，那么您可以这样做：

```
proc sort data=dataset; 
by site section; 
run;

data final;
set dataset;
by site section;
if first.section then sectionIndex+1;
run; 
```

这不需要 NODUPRECS 或 NODUPKEY，并且节省了一些处理时间。

我认为 DO 循环不会有帮助，除非您正在做一些更复杂的事情（需要 DoW 循环或类似的东西）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:50:09.457

我不知道如何使用 do 循环来执行此操作，但显然可以使用 proc 排序和数据合并来完成。创建仅保留用于创建索引的分类变量的数据集，然后使用 noduprescs 进行排序以删除重复项。用 +1 添加索引变量。然后合并回原始数据集。

```
data sitesections;
set dataset;
keep site section;

proc sort data=sitesections out=sitesections2 noduprecs;
by site section;

data sitesections_final;
set sitesections2;
sectionindex +1;

data final;
merge sitesections_final dataset;
by site section;
run; 
```

# windows - 为批处理文件转义括号内的括号

> ID：12976351
> 
> 赞同：49
> 
> 时间：2012-10-19T14:26:08.547
> 
> 标签：windows, batch-file, cmd, escaping, parentheses

这就是我想要做的：

```
(
@echo This is some code that is
@echo Important to echo exactly as-is
@echo Even if I use parenthesis
@echo for something (like this)
)|clip 
```

因此，将其复制到剪贴板中。我尝试了以下方法：

```
(
@echo This is some code that is
@echo Important to echo exactly as-is
@echo Even if I use parenthesis
@echo for something ^(like this^)
)|clip 
```

但这似乎也影响了我的 WANTED 括号，因为我收到了一个错误。为了测试这一点，我简单地做了：

```
(
@echo This is some code that is
@echo Important to echo exactly as-is
@echo Even if I use parenthesis
@echo for something ^(like this^)
FFF
)|clip 
```

嘿！这几乎可行，文本一直复制到“this”中的“s”。它不复制最后的括号，或者显然是 F。有任何想法吗？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-10-19T14:52:17.453

很明显你需要三个插入符号:-)

```
(
@echo This is some code that is
@echo Important to echo exactly as-is
@echo Even if I use parenthesis
@echo for something (like this^^^)
)|clip 
```

为什么？这有点棘手……

首先解析器解析块并将部分转义`this^^^)`为`this^)`，括号第一次在这里转义。

但是当您使用管道时，完整的块将被转换并传输到新的 cmd.exe 实例。
`C:\Windows\system32\cmd.exe /S /D /c" ( @ echo This is some code is ... & @ echo for something (like this^) )"`

在新的例子中，有必要再次转义右括号。
就这样！

有关更多信息，您可以阅读类似的问题
[SO：为什么在管道代码块内延迟扩展失败](https://stackoverflow.com/questions/8192318/why-does-delayed-expansion-fail-when-inside-a-piped-block-of-code)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-06-01T19:41:25.753

如果您对插入符号计数感到困惑，请记住它始终*是 2 减去 1 的幂*。或者，请记住，第一次加 2，第二次加 4，第三次加 8，...

例如，（在 XP 上测试）

```
(
for /f "tokens=* delims=" %%S in (
'echo X^^^^^^^^^^^^^^^& ^^^^^^^^^^^^^^^| ^^^| find " "'
) do @echo %%S
) | find "X" 
```

echo 语句首先在 DOS 解析批处理文件时正常读取 (1)，其次是因为它是管道内部命令（DOS 似乎想要管道中的程序，而内部命令不是程序）(3)，第三是因为它在'for /f' 命令驱动的单词列表（参见 for /?）（7），第四次，原因已在本线程（15）中给出。

I may also note that personally, I consider it sloppy coding to leave proper escaping of hot characters away just because DOS happens to ignore the missing escaping in that particular case. So if I wanted to echo a literal pair of parentheses in the above example, I would give each 15 carets, even if the opening parenthesis does not need it. Then anyone reading my code does not have to wonder why one parenthesis is quoted and the other is not. And how to modify the quoting under code modification.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-22T23:35:45.173

三重插入符号并非在所有情况下都有效。采取以下措施：

```
IF EXIST file.txt (
ECHO ...OK
) ELSE (
ECHO TEST THIS: (SOME WORDING! ^^^)   > file.txt
) 
```

file.txt 的内容是：

```
TEST THIS: (SOME WORDING! ^) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-12-04T03:45:25.313

当我需要在封装的回声中使用右括号时，我的解决方案是在脚本开头创建一个名为 %endPar% 的变量，如下所示：

```
@set "endPar=)"
@echo This is some code that is>tmp
@echo Important to echo exactly as-is>>tmp
@echo Even if I use parenthesis>>tmp
@echo for something (like this%endPar%>>tmp
@type tmp|clip
@del tmp 
```

我稍微改了一下，测试了两次。

该代码只是将回显输出到一个名为 tmp 的文件，然后您将文件的内容通过管道传输到剪辑，然后您就可以将其粘贴到您想要的任何位置。

# asp.net-web-api - ASP.NET Web API - 模型绑定不适用于 POST 上的 XML 数据

> ID：12976352
> 
> 赞同：11
> 
> 时间：2012-10-19T14:26:10.827
> 
> 标签：asp.net-web-api

在使用带有 ASP.NET Web API 的 XML 数据进行 POST 时，我无法让模型绑定工作。JSON 数据工作正常。

使用全新的 Web API 项目，这是我的模型类：

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
}

public class PostResponse
{
    public string ResponseText { get; set; }
} 
```

这是我在控制器中的 post 方法：

```
 public PostResponse Post([FromBody]Person aPerson)
    {
        var responseObj = new PostResponse();
        if (aPerson == null)
        {
            responseObj.ResponseText = "aPerson is null";
            return responseObj;
        }

        if (aPerson.FirstName == null)
        {
            responseObj.ResponseText = "First Name is null";
            return responseObj;
        }

        responseObj.ResponseText = string.Format("The first name is {0}", aPerson.FirstName);
        return responseObj;
    } 
```

我可以使用 Fiddler 的 JSON 成功运行它：

> **请求标头：**
> 用户代理：提琴手
> 主机：localhost：49188
> 内容类型：应用程序/json；charset=utf-8
> 内容长度：38
> 
> **请求正文：**
> {"FirstName":"Tom","LastName":"Jones"}
> 
> **结果：**
> {"ResponseText":"名字是汤姆"}

传入 XML 时，Person 对象未正确水合：

> **请求标头：**
> 用户代理：提琴手
> 主机：localhost：49188
> 内容类型：文本/xml
> 内容长度：79
> 
> **请求正文：**
> <Person>
>     <FirstName>Tom</FirstName>
>     <LastName>Jones</LastName>
> </Person>
> 
> **结果：**
> <ResponseText>aPerson 为空</ResponseText>

据我了解，XML 应该类似于 JSON。关于我在这里缺少什么的任何建议？

谢谢，
跳过

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-10-19T14:39:05.837

将此添加到您的`WebApiConfig.cs`：

```
config.Formatters.XmlFormatter.UseXmlSerializer = true; 
```

这迫使 Web API 使用 XMLSerializer 而不是 DataContractSerializer，并允许您传递原始 XML。

否则，您必须通过完全合格的数据合同 XML，即：

```
<Person xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/Test.WebAPI.Controllers">
<FirstName>a</FirstName>
<LastName>b</LastName>
</Person> 
```

# asp-classic - ASP DSN-Less 连接问题

> ID：12976358
> 
> 赞同：0
> 
> 时间：2012-10-19T14:26:37.833
> 
> 标签：asp-classic, connection, dsn

抱歉，如果这不是提出这个问题的合适地方，但我是论坛的新手。

我的问题与 ASP 和无 DSN 连接有关。我有一个网站，该网站是很久以前使用 DSN 连接到 Access 数据库建立的，该数据库在 2003 服务器上运行。我必须复制这个站点，但是我们的服务器（通过 Fasthosts 托管）现在是 2008 服务器，并且不支持 ODBC。

我已经建立了无 DSN 连接，但显然我仍然没有得到正确的结果，因为我不断收到 Object required: 'object' on each page。我对 ASP 不是很了解，所以如果有人能提供一些答案，那就太好了！

我原来的代码是这样的：

```
//Get the 5 newest news items
Dim objRec2, sql2, 
newstext sql2="SELECT TOP 5 news_date, news_text FROM news ORDER BY news_date DESC" 
set objRec2=Server.CreateObject("ADODB.Recordset") 
objRec2.Open sql2,     "dsn=database" 
```

然后我改为：

```
//Get the 5 newest news items
set conob2 = Server.CreateObject("ADODB.Connection")
conob2.Provider="Microsoft.Jet.OLEDB.4.0" 
conob2.Open "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & server.MapPath("database.mdb") Set rsuni2 = Server.CreateObject("ADODB.Recordset")  
sql2="SELECT TOP 5 news_date, news_text FROM news ORDER BY news_date DESC" 
objRec2.Open sql, conob 
```

然后我得到错误：

```
Microsoft VBScript runtime error '800a01a8'
Object required: 'objRec2'
index.asp, line 20 
```

我正在运行“WhileNot”语句来获取 news_text 和 news_date，如下所示：

```
<%While Not objRec2.EOF
            newstext = Replace(objRec2("news_text"), vbCrLf, "<br />")
            %>
            <p><span class="bold">Date: <%=objRec2("news_date")%></span><br />
            <%=newstext%></p> 
```

请问有人可以帮忙吗？？？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:31:16.690

更改后，您似乎丢失了：

`set objRec2=Server.CreateObject("ADODB.Recordset")`

这将导致您遇到的确切错误（并且与连接无关）。

# apache - 从外部访问 xampp/htdocs

> ID：12976361
> 
> 赞同：6
> 
> 时间：2012-10-19T14:26:51.720
> 
> 标签：apache

我在服务器中安装了 xampp 服务器，我想不仅从 (http://localhost/folder/file.php) 打开 htdocs 中的项目，还希望通过其 ip 从其他计算机打开项目。示例：（192.168.1.210/folder/file.php）我该怎么做？我确实编辑了 httd.conf

```
<Directory/>
  Options FollowSymLinks
  AllowOverride None
  Order deny,allow
  Deny from all
  Allow from all
</Directory> 
```

允许访问 xampp/htdocs 的所有子目录.. 但仍然没有！除非我登录服务器，否则我无法打开我的项目登录文件。提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T14:43:15.037

您需要 Apache 中的虚拟主机，它至少侦听给定的 IP ( `192.168.1.210:80`) 或任何 IP ( `*:80`)：

```
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot /var/www/some_app
</VirtualHost> 
```

见：[http ://httpd.apache.org/docs/2.2/vhosts/examples.html](http://httpd.apache.org/docs/2.2/vhosts/examples.html)

请不要编辑`httpd.conf`，因为更改可能会在下一次软件更新时丢失。`site-available`您需要在 den XAMPP/Apache 文件夹中创建一个 vHost 。

# macos - NSMetadataQuery 的搜索范围

> ID：12976362
> 
> 赞同：0
> 
> 时间：2012-10-19T14:26:57.783
> 
> 标签：macos, cocoa, nsmetadataquery

有没有办法从 NSMetadataQuery 的搜索范围中排除 /Users/username/Library （默认隐藏）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T05:10:09.213

NSMetadataQuery 提供了设置搜索范围（setSearchScope）的可行性，最好通过设置所需的搜索路径来尝试。

# c# - 使用带有内存流的 c# 在控制台应用程序中保存图像时，GDI + 中发生一般错误

> ID：12976363
> 
> 赞同：3
> 
> 时间：2012-10-19T14:27:01.560
> 
> 标签：c#, image, save

当我尝试在 c# 中使用 memorystream 保存图像时，出现下面提到的错误。仅当字节数组 byteImageData 长度等于 24000 时才会引发错误，否则代码工作正常。下面是代码片段：

```
string strDbConn = string.Empty;
string strImageFileName = string.Empty;
string strImageData = string.Empty;
DataSet imageDS = new DataSet();
Byte[] byteImageData = new Byte[0];
Image saveImage;
string strImgSavePath = string.Empty;
try
{
    //---open the database connection
    strDbConn = ConfigurationSettings.AppSettings["DBConnection"].ToString().Trim();
    SqlConnection dbcon = new SqlConnection(strDbConn);
    dbcon.Open();
    SqlDataAdapter imageSqlDataAdapter = new SqlDataAdapter("select * from image_data", dbcon);
    imageSqlDataAdapter.Fill(imageDS);
    dbcon.Close();
    for (int i = 0; i < imageDS.Tables[0].Rows.Count; i++)
    {
        strImageFileName = imageDS.Tables[0].Rows[i]["name"].ToString().Trim();
        strImageData = imageDS.Tables[0].Rows[i]["signature_vod__c"].ToString().Trim();
        //converting string to byte array
        byteImageData = Convert.FromBase64String(strImageData);
        //---create Memory stremm from the Image Byte data
        MemoryStream stmImageData = new MemoryStream(byteImageData);
        //--saving the image
        saveImage = Image.FromStream(stmImageData);
        strImgSavePath = ConfigurationSettings.AppSettings["ImageSavePath"].ToString().Trim();
        saveImage.Save(strImgSavePath + strImageFileName + ".jpeg"); // error comes here
        //stmImageData.Close();
    }
}
catch (Exception ex)
{

} 
```

抛出的错误是：

```
Messgae = A generic error occurred in GDI+. 
Inner Exception = null 
```

堆栈跟踪：

```
at System.Drawing.Image.Save(String filename, ImageCodecInfo encoder, EncoderParameters encoderParams)
   at System.Drawing.Image.Save(String filename, ImageFormat format)
   at System.Drawing.Image.Save(String filename)
   at VeevaImageApp.Program.CreateAndSaveImageusingDataSet2() in Program.cs:line 141 
```

仅当字节数组 byteImageData 长度为 24000 时才会出现错误，否则代码工作文件 - 可能是什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T16:08:05.550

图像数据是什么格式的？如果它已经是 JPG，你应该只使用`File.WriteAllBytes(path, byteImageData)`. 如果你真的需要转换，你应该使用更新的图像编码器/解码器类：在网上搜索 JpegBitmapEncoder 或 PngBitmapEncoder 的信息。（如果这些是照片或扫描我们的JPEG，否则使用PNG。）

# jsf - 将 ManagedBean 注入另一个 bean 失败

> ID：12976368
> 
> 赞同：1
> 
> 时间：2012-10-19T14:27:15.537
> 
> 标签：jsf, primefaces

我尝试将托管 Bean 注入另一个 bean，但失败了。这是第一个 bean：

```
@ManagedBean(name = "sucBean")
@SessionScoped
public class SucBean implements Serializable {

private static final long serialVersionUID = 1L;

private MapModel advancedModel;

private MapModel advancedModel2;

private Marker marker;

private Suc suc;

private List<Suc> sucDefteri;

private List<Suc> searchResult;

private Suc[] selectedSuc;

private SucService sucService;

private String aramaKriteri;

private String arananKelime;

private SucDataModel sucModel;

    // other getters/setters methods 
```

当我运行 Web 应用程序时，我得到了

```
Caused by: java.lang.NullPointerException
at org.primefaces.component.chart.CartesianChart.getCategories(CartesianChart.java:32)
at org.primefaces.component.chart.bar.BarChartRenderer.encodeData(BarChartRenderer.java:121)
at org.primefaces.component.chart.bar.BarChartRenderer.encodeScript(BarChartRenderer.java:51)
at org.primefaces.component.chart.bar.BarChartRenderer.encodeEnd(BarChartRenderer.java:36)
at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875)
at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1786)
at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1782) 
```

第二个bean如下：

```
@ManagedBean(name="chartBean")
@SessionScoped
public class ChartBean implements Serializable {

/**
 * 
 */
private static final long serialVersionUID = 1L;

private CartesianChartModel categoryModel;

@ManagedProperty("#{sucBean}")
private SucBean sucBean;

private int[] sucSayilari=new int[9];

public ChartBean()
{
    createCategoryModel();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:36:57.910

我认为这是问题所在：

```
public ChartBean()
{
    createCategoryModel();
} 
```

此时尚未设置您的依赖项，因为 JSF 实现首先实例化您的 bean（这意味着构造函数必须完成）然后注入其依赖项，因此如果您在其中使用注入的 bean，`createCategoryModel()`它将是一个空引用。

如果您需要在设置依赖项之后对 bean 执行某些操作，请使用带有注释的方法`@PostConstruct`：

```
public ChartBean(){
}

@PostConstruct
public void init(){
   createCategoryModel();
} 
```

# c# - String 对象如何在没有 new 关键字或构造函数的情况下分配内存？

> ID：12976371
> 
> 赞同：6
> 
> 时间：2012-10-19T14:27:34.587
> 
> 标签：c#

在 C# 中，如果我们想创建一个类型的变量，`string`我们可以使用：

```
string str="samplestring"; // this will allocate the space to hold the string 
```

在C#中，`string`是类类型，所以如果我们要创建一个对象，通常我们必须使用`new`关键字。那么如果没有`new`or ，分配是如何发生的`constructors`呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T15:44:13.777

当你写

```
string str="samplestring"; 
```

编译器会生成两条指令：

1.  首先，[`ldstr`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldstr.aspx)从元数据中获取字符串文字；分配必要的内存量；创建一个新`String`对象并将对它的引用压入堆栈。
2.  然后[`stloc`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.stloc.aspx)（或其中一种简短形式，例如[`stloc.0`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.stloc_0.aspx)）将该引用存储在局部变量`str`中。

请注意，这`ldstr`将为每个字符序列分配一次内存。

因此，在下面的示例中，两个变量都将指向内存中的同一个对象：

```
// CLR will allocate memory and create a new String object
// from the string literal stored in the metadata
string a = "abc";

// CLR won't create a new String object. Instead, it will look up for an existing
// reference pointing to the String object created from "abc" literal
string b = "abc"; 
```

这个过程称为[*字符串实习*](http://en.wikipedia.org/wiki/String_interning)。

此外，如您所知，在 .NET 中字符串是*不可变*的。所以对象的内容`String`在对象创建之后就不能再改变了。也就是说，每次连接字符串时，CLR 都会创建一个新`String`对象。

例如，以下代码行：

```
string a = "abc";
string b = a + "xyz"; 
```

将被编译成以下 IL（当然不完全是）：

1.  `ldstr`将分配内存并从字面量创建一个新`String`对象`"abc"`
2.  `stloc`将对该对象的引用存储在局部变量中`a`
3.  `ldloc`将该引用推入堆栈
4.  `ldstr`将分配内存并从字面量创建一个新`String`对象`"xyz"`
5.  `call`将调用堆栈[`System.String::Concat`](http://msdn.microsoft.com/en-us/library/a6d350wd.aspx)上的这些对象`String`
6.  一个调用`System.String::Concat`会分解成几十条IL指令和内部调用。简而言之，它将检查两个字符串的长度并分配必要的内存量来存储连接结果，然后将这些字符串复制到新分配的内存中。
7.  `stloc`将对新创建的字符串的引用存储在局部变量中`b`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-19T14:35:26.273

这只是 C# 编译器通过允许字符串文字为您提供快捷方式。

如果您愿意，您可以通过任意数量的不同[构造函数](http://msdn.microsoft.com/en-us/library/system.string.string.aspx)来实例化一个字符串。例如：

```
 char[] chars = { 'w', 'o', 'r', 'd' };
 string myStr = new String(chars); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T14:34:40.933

根据 MS 文档，您不需要使用 new 命令来使用默认字符串构造函数。

然而，这确实有效。

```
char[] letters = { 'A', 'B', 'C' };
string alphabet = new string(letters); 
```

[c# 字符串（来自 MSDN 编程指南）](http://msdn.microsoft.com/en-us/library/ms228362.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-19T14:40:36.097

字符串实际上是引用类型。该变量保存对内存中值的引用。因此，您只是将引用而不是值分配给对象。我建议你看一下 Pluralsight 的这个视频（你可以获得 14 天的免费试用期）

[Pluralsight C# 基础 - 字符串](http://pluralsight.com/training/Player?author=scott-allen&name=csharp-types&mode=live&clip=8&course=csharp-fundamentals)

免责声明：我与 Pluralsight 没有任何关系。我是订阅者，我喜欢那里的视频

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-19T14:33:04.590

尽管 .net 中的一切都是对象，但仍有一些不需要实例化的原始类型（int、bool 等）。正如你[在这里](http://condor.depaul.edu/sjost/ndp/notes/cs1/CSDatatypes.htm)看到的，一个字符串是一个 4 字节的地址引用，指向一个可以扩展到 2GB 的向量/数组结构。请记住字符串是不可变类型，因此当您更改字符串时，您不会编辑现有变量，而是为文字值分配新内存，然后更改字符串指针以指向新的内存结构。希望有帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T15:00:56.797

当您在内部使用文字创建字符串时，取决于您的程序集是否标有 NoStringInterning 标志，它看起来像：

```
String str = new String("samplestring");
// or with NoStringInterning
String str = String.Intern("samplestring"); 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2012-10-19T14:38:48.267

在java中，如果你写这样的东西：

```
String s1 = "abc";
String s2 = "abc"; 
```

内存将在所谓的字符串池中为“abc”分配，s1 和 s2 都将引用该内存。并且 s1 == s2 将返回 true （“==”比较引用）。但是如果你写：

```
String s1 = new String("abc");
String s1 = new String("abc"); 
```

s1 == s2 将返回 false。我猜在c#中它会是一样的。

# sharepoint-2010 - 通过 SharePoint 表单和列表项事件接收器更新字段

> ID：12976375
> 
> 赞同：1
> 
> 时间：2012-10-19T14:27:49.520
> 
> 标签：sharepoint-2010

我很困惑，似乎无法找到这个问题的正确答案：

当我在事件接收器中使用 ItemUpdating 方法更新字段标题时，如下面的代码所示，它可以工作，但我通过“编辑表单”更改的其他字段不会更改。它们保持原样。

```
public override void ItemUpdating(SPItemEventProperties properties)
{
    SPListitem item = properties.ListItem;
    item["Title"] = "title has been changed";
    item.Update();
} 
```

如果我将上面的代码放入`ItemUpdated`它不起作用，但通过 UI（编辑表单）完成的更改会生效。

谁能帮我解决这个问题？

谢谢你

## 编辑

让我简单地这样说：

谁能告诉我如何通过事件接收器更新一个或多个字段，并通过列表的编辑表单更新其他字段？

我希望这更清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T18:18:41.540

使用 ItemUpdating 事件时，请检查参数的`AfterProperties`属性`properties`。它是一个字典，包含该项目将具有的所有新值。但是，它包含原始值，所有这些值都作为字符串，在被处理为您在获取项目属性时将看到的实际值之前。

当您在`ItemUpdating`事件中执行代码时，会发生以下情况：

*   用户点击保存；
*   `ItemUpdating`被触发并执行到您调用`Update()`.
*   此时，您的调用会`Update()`触发该项目的另一个`ItemUpdating`事件。在它运行的上下文中，除了`Title`.
*   控制权返回到您覆盖的方法。将保留在项目上的更改不再适用。

这就是您丢失用户所做更改的原因。

当您改为使用时，用户所做的更改将保留，因为它们在您执行任何操作**之前**`ItemUpdated`已保存。然后你在一个事件中调用它。那个要么默默地抛出**堆栈溢出**异常，要么做一些完全疯狂的事情，因为你在那里创建了一个**无限递归循环**——这就是为什么你看不到它改变标题的原因。**`Update()``ItemUpdated`**

 ******如果要对 UI 保存的项目添加额外的更改，请修改`AfterProperties`属性`properties`而不是直接在项目中更改它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:52:02.897

最好在事件接收器中使用 ItemUpdated 来更新列表中的字段。而且您还必须注意，使用更新事件接收器中的字段

项目.更新（）；

启动工作流时可能会导致一些问题。您可以使用以下方式更新多个字段。

```
 base.EventFiringEnabled = false;
               try
               {
                   item.SystemUpdate(false);
               }
               finally
               {
                   base.EventFiringEnabled = true;
               }
               break; 
```******

# python - openpyxl 将 CSV 转换为 EXCEL

> ID：12976378
> 
> 赞同：10
> 
> 时间：2012-10-19T14:28:02.067
> 
> 标签：python, linux, openpyxl

如何`:`使用模块将带分隔符的 CSV 文件转换为 XLS（Excel 工作表）`openpyxl`？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2016-09-04T13:30:58.373

一个更简单，极简的解决方案：

```
import csv
import openpyxl

wb = openpyxl.Workbook()
ws = wb.active

with open('file.csv') as f:
    reader = csv.reader(f, delimiter=':')
    for row in reader:
        ws.append(row)

wb.save('file.xlsx') 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-10-22T17:23:58.713

```
import csv
from openpyxl import Workbook
from openpyxl.cell import get_column_letter

f = open(r'C:\Users\Asus\Desktop\herp.csv')

csv.register_dialect('colons', delimiter=':')

reader = csv.reader(f, dialect='colons')

wb = Workbook()
dest_filename = r"C:\Users\Asus\Desktop\herp.xlsx"

ws = wb.worksheets[0]
ws.title = "A Snazzy Title"

for row_index, row in enumerate(reader):
    for column_index, cell in enumerate(row):
        column_letter = get_column_letter((column_index + 1))
        ws.cell('%s%s'%(column_letter, (row_index + 1))).value = cell

wb.save(filename = dest_filename) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-12T20:53:37.427

这是 Adam 的解决方案，扩展后删除了 openpyxl 认为非法的字符，并将抛出异常：

```
import re
from openpyxl.cell.cell import ILLEGAL_CHARACTERS_RE
...
##ws.append(row) - Replace with the code below
for i in row:
    ws.append([ILLEGAL_CHARACTERS_RE.sub('',i)]) 
```

ILLEGAL_CHARACTERS_RE 是一个编译的正则表达式，包含 openpyxl 认为“非法”的字符。该代码只是用空字符串替换这些字符。

来源：[Bitbucket openpyxl issue #873 - 删除非法字符而不是抛出异常](https://bitbucket.org/openpyxl/openpyxl/issues/873/remove-illegal-characters-instead-of "来源")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-15T06:48:29.090

在 John 的建议之上，我使用函数稍微修改了我的脚本，以删除所有原始数据的字符串撇号。这样，我设法检查了所有原始数据（字符串和数字），它们也放置在相应的单元格中。最后，我从第 20 行开始将数值数据分配给浮点类型。这是因为所有数字数据从第 20 行开始就存在，而上面的所有数据都只是文本。

**cell_value = cell.replace('"', '')**

下面是我的脚本：

```
import csv
from openpyxl import Workbook

wb = Workbook()
ws = wb.active

with open(filepath1_csv) as f:
reader = csv.reader(f)
for row_index, row in enumerate(reader):
    for column_index, cell in enumerate(row):
        column_letter = column_index + 1
        cell_value = cell.replace('"', '')
        ws.cell(row = row_index + 1, column = column_letter).value = cell_value

for row in ws.iter_rows(min_row=20, min_col=1, max_col=5, 
max_row=ws.max_row):
for cell in row:
    if cell.value is None:
        break
    else:
        cell.value = float(cell.value)

wb.save(filename = filepath1_xlsx) 
```

# flash - 增加 BitmapData 中的每个像素

> ID：12976382
> 
> 赞同：0
> 
> 时间：2012-10-19T14:28:10.100
> 
> 标签：flash, colors, bitmap

让我解释一下我想要实现的目标。我想创建一种图像的“年龄图”。这意味着每一帧

*   每个像素的值都增加 1。
*   修改后的像素设置为 0。

有没有一种方法可以有效地做到这一点，而无需遍历所有像素并调用`getPixel`/ `setPixel`？

为了重置我正在考虑使用的修改过的像素`bitmapData.draw()`，结合使用 blendModes/colorTransform; 例如，使用 0 colorTransform 在年龄图上绘制形状，保留形状但使形状变黑，即`0x000000`。

但是，将每个像素增加 1 可能更棘手。我可以创建一个具有所有`0x000001`值的图像，并使用`.draw()`它在每一帧中添加它，但使用`BlendMode.ADD`每个通道的剪辑`0xFF`，只允许 255 个不同的年龄值。

有什么建议可以有效地解决这个问题吗？我可以应用 a `ColorTransform`or`ColorMatrixFilter`到整个图像吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:57:13.080

编写一个自定义 PixelBender 过滤器，这将比迭代像素快得多：

如果您以前从未使用过，这可能会有一些用处：

[http://tv.adobe.com/watch/adc-presents/pixel-bender-custom-filters/](http://tv.adobe.com/watch/adc-presents/pixel-bender-custom-filters/)

我自己对 PB 有点生疏，抱歉我不能提供更具体的建议，但我知道这是可能的，而且 GPU 支持意味着它足够快可以使用。

# c# - 如何在 ASP.NET Web API 中记录原始 HTTP 请求，无论它是否路由到控制器？

> ID：12976390
> 
> 赞同：9
> 
> 时间：2012-10-19T14:28:35.163
> 
> 标签：c#, asp.net, asp.net-web-api, httpwebrequest

是否可以记录对 ASP.NET Web API 发出的每个 HTTP 请求，即使请求格式不正确，或者由于某些其他原因无法路由到其中一个控制器。

例如，如果一个 POST 方法有一个 Order 模型作为它的参数，一个不正确的请求会阻止它到达控制器的 POST 方法。我想提醒某人，以便采取措施防止将来出现故障。

有没有办法从控制器进一步向上游捕获这些请求？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T06:14:35.027

无论是使用Tracing，都需要实现ITraceWriter，如下图

[http://www.asp.net/web-api/overview/testing-and-debugging/tracing-in-aspnet-web-api](http://www.asp.net/web-api/overview/testing-and-debugging/tracing-in-aspnet-web-api)

或者实现消息处理程序

[http://www.strathweb.com/2012/05/implementing-message-handlers-to-track-your-asp-net-web-api-usage/](http://www.strathweb.com/2012/05/implementing-message-handlers-to-track-your-asp-net-web-api-usage/)

[http://www.asp.net/web-api/overview/working-with-http/http-message-handlers](http://www.asp.net/web-api/overview/working-with-http/http-message-handlers)

消息处理程序允许您在消息到达 HttpControllerDispatcher 之前更改消息，因此您可以处理路由和操作方法选择的常见问题。

但是，当您在 IIS 上托管时，请不要犹豫使用 AppFabric 日志记录，因为它可以在请求到达您的 Web 应用程序之前在出现问题时为您提供信息。它处理 Web 应用程序中存在全局错误的场景，例如 web.config 错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T17:00:25.443

如果您在 ASP.NET Web API 中按[Tracing in ASP.NET Web API](http://www.asp.net/web-api/overview/testing-and-debugging/tracing-in-aspnet-web-api)启用跟踪，则内置跟踪基础结构将记录您所追求的信息。

在内容协商失败的格式错误的请求的情况下，您将看到 DefaultContentNegotiator 中发生 HttpError。

以下是此类错误的简单跟踪示例：

> DefaultContentNegotiator;Negotiate;Type='HttpError', formatters=[JsonMediaTypeFormatterTracer, XmlMediaTypeFormatterTracer, FormUrlEncodedMediaTypeFormatterTracer, FormUrlEncodedMediaTypeFormatterTracer]

跟踪编写器被赋予一个[TraceRecord](http://msdn.microsoft.com/en-us/library/system.web.http.tracing.tracerecord%28v=vs.108%29.aspx)作为其输入，它将包含请求信息以及您可能想要使用的任何自定义信息（可选）。

Web API 将使用您配置的跟踪编写器在请求的整个生命周期中跟踪信息。您可以使用跟踪编写器来跟踪生命周期事件以及您自己的控制器代码。

# android - Android：列表视图中的 Json 解析

> ID：12976391
> 
> 赞同：0
> 
> 时间：2012-10-19T14:28:37.993
> 
> 标签：android, json, listview, android-listview, android-asynctask

我试图解析列表视图中的一些项目，当我向下滚动时，我想获取更多产品并将它们添加到列表中。但是我的代码没有这样做，它要么刷新它，要么崩溃。有什么帮助吗？添加页脚也不起作用，我得到一个classcastexception

JSON解析器：

```
 package com.lars.json;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import com.lars.R.drawable;

import android.R;
import android.util.Log;

/** A class to parse json data */
public class JSONParser {

    // Receives a JSONObject and returns a list
    public List<HashMap<String,Object>> parse(JSONObject jObject){      

        JSONArray jProducts = null;
        try {       
            // Retrieves all the elements in the 'countries' array 
            jProducts = jObject.getJSONArray("products");
        } catch (JSONException e) {
            e.printStackTrace();
        }

         // Invoking getCountries with the array of json object
         // where each json object represent a country
        return getProducts(jProducts);
    }

    private List<HashMap<String, Object>> getProducts(JSONArray jProducts){
        int productsCount = jProducts.length();
        List<HashMap<String, Object>> productList = new ArrayList<HashMap<String,Object>>();
        HashMap<String, Object> product = null; 

        // Taking each country, parses and adds to list object 
        for(int i=0; i<productsCount;i++){
            try {
                // Call getCountry with country JSON object to parse the country 
                product = getJSON((JSONObject)jProducts.get(i));
                productList.add(product);

            } catch (JSONException e) {
                e.printStackTrace();
            }
        }

        return productList;
    }

    // Parsing the Country JSON object 
    private HashMap<String, Object> getJSON(JSONObject f){

        HashMap<String, Object> country = new HashMap<String, Object>();

        String id = "";
        String naam = "";
        String status = "";
        String prijs = "";
        String productnum = "";

        try {
            String priceone = f.getString("prijsex");

            id = f.getString("id");
            naam = f.getString("naam");
            status = f.getString("status");
            prijs = "€" + priceone;
            productnum = f.getString("productnum");

            country.put("id", id);
            country.put("naam", naam);
            country.put("img", com.lars.R.drawable.tlogotrans);
            country.put("prijs", prijs);
            country.put("img_path", "http://www.lars.com/images/" + productnum + ".jpg");

            if(Integer.parseInt(status) > 0){
            country.put("status", com.lars.R.drawable.stock);
            }else{
            country.put("status", com.lars.R.drawable.nostock);
            }

        } catch (JSONException e) {         
            e.printStackTrace();
        }       
        return country;
    }
} 
```

下载任务和 Listview 加载器：

```
/** A method to download json data from url */
    private String downloadUrl(String strUrl) throws IOException{
        String data = "";
        InputStream iStream = null;
        try{
                URL url = new URL(strUrl);

                // Creating an http connection to communicate with url 
                HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();

                // Connecting to url 
                urlConnection.connect();

                // Reading data from url 
                iStream = urlConnection.getInputStream();

                BufferedReader br = new BufferedReader(new InputStreamReader(iStream));

                StringBuffer sb  = new StringBuffer();

                String line = "";
                while( ( line = br.readLine())  != null){
                    sb.append(line);
                }

                data = sb.toString();

                br.close();

        }catch(Exception e){
                Log.d("Exception while downloading url", e.toString());
        }finally{
                iStream.close();
        }

        return data;
    }

    /** AsyncTask to download json data */
    private class DownloadTask extends AsyncTask<String, Integer, String>{
        String data = null;

                @Override
                protected String doInBackground(String... url) {

                        try{

                            data = downloadUrl(url[0]);

                        }catch(Exception e){
                            Log.d("Background Task",e.toString());
                        }
                        return data;
                }

                @Override
                protected void onPostExecute(String result) {

                        // The parsing of the xml data is done in a non-ui thread 
                        ListViewLoaderTask listViewLoaderTask = new ListViewLoaderTask();
                        Log.i("Result", result);

                        if(result.equals(" ")){
                            Log.i("No img", "No Img");
                        }else{

                                listViewLoaderTask.execute(result);

                        }
                        // Start parsing xml data

                }
    }

    /** AsyncTask to parse json data and load ListView */
    private class ListViewLoaderTask extends AsyncTask<String, Void, SimpleAdapter>{

        JSONObject jObject;
        private List<HashMap<String, Object>> products;
        // Doing the parsing of xml data in a non-ui thread 
        @Override
        protected SimpleAdapter doInBackground(String... strJson) {
            try{

                jObject = new JSONObject(strJson[0]);
                JSONParser jsonpars = new JSONParser();
                jsonpars.parse(jObject);
            }catch(Exception e){
                Log.d("JSON Exception1",e.toString());
            }

            // Instantiating json parser class
            JSONParser jsonpars = new JSONParser();

            // A list object to store the parsed countries list

            try{
                // Getting the parsed data as a List construct
                if(set == 0){
                products = jsonpars.parse(jObject);
                }else{
                    products.addAll(jsonpars.parse(jObject));

                }

            }catch(Exception e){
                Log.d("Exception",e.toString());
            }          

            // Keys used in Hashmap 
            String[] from = { "img","naam","status","prijs"};
            // Ids of views in listview_layout
            int[] to = { R.id.imPThumb,R.id.tvPRName,R.id.imstock,R.id.tvPRPrijs};

            // Instantiating an adapter to store each items
            // R.layout.listview_layout defines the layout of each item         
            SimpleAdapter adapter = new SimpleAdapter(getBaseContext(), products, R.layout.productlijstrow, from, to);  

            return adapter;
        }

        @Override
        protected void onProgressUpdate(Void... values) {
            // TODO Auto-generated method stub
             publishProgress();
             Log.i("ListView Loader Task", "Update");
            super.onProgressUpdate(values);
        }

        /** Invoked by the Android on "doInBackground" is executed */
        @SuppressWarnings("unchecked")
        @Override
        protected void onPostExecute(SimpleAdapter adapter) {

            // View v = getLayoutInflater().inflate(R.layout.footerview, null);
            //list.addFooterView(v);
            // Setting adapter for the listview

            list.setAdapter(adapter);

            if(set == 0){
            list.setOnScrollListener(onAnswersScrolled);
            set++;
            }
            list.setOnItemClickListener(onAnswerClicked);

               list.setTextFilterEnabled(true);
           /*    list.setOnItemClickListener(new OnItemClickListener() {
                public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                    @SuppressWarnings("unchecked")
                    HashMap<String, String> o = (HashMap<String, String>) lv.getItemAtPosition(position);

                    Bundle extra = new Bundle();
                    Intent i = new Intent("com.lars.productdescription");
                    extra.putString("id", o.get("id"));
                    i.putExtras(extra);
                    startActivity(i);

                    }
                });*/

            for(int i=0;i<adapter.getCount();i++){
                HashMap<String, Object> hm = (HashMap<String, Object>) adapter.getItem(i);
                String imgUrl = (String) hm.get("img_path");
                Log.i("imgurlonPost", imgUrl);
                ImageLoaderTask imageLoaderTask = new ImageLoaderTask();

                HashMap<String, Object> hmDownload = new HashMap<String, Object>();
                hmDownload.put("img_path",imgUrl);

                hmDownload.put("position", i);

                // Starting ImageLoaderTask to download and populate image in the listview 
                imageLoaderTask.execute(hmDownload);
                adapter.notifyDataSetChanged();
            }

         /*   list.setOnScrollListener(new OnScrollListener(){

            });*/

        }       
    }

    /** AsyncTask to download and load an image in ListView */
    private class ImageLoaderTask extends AsyncTask<HashMap<String, Object>, Void, HashMap<String, Object>>{

        @Override
        protected HashMap<String, Object> doInBackground(HashMap<String, Object>... hm) {

            InputStream iStream=null;
            String imgUrl = (String) hm[0].get("img_path");
            int position = (Integer) hm[0].get("position");
            HashMap<String, Object> hmBitmap = new HashMap<String, Object>();
            URL url;
            try {
                url = new URL(imgUrl);

                // Creating an http connection to communicate with url
                HttpURLConnection urlConnection = (HttpURLConnection) url.openConnection();
                Log.i("imgUrl", imgUrl);
                // Connecting to url                
                urlConnection.connect();
          //      Log.i("Response", urlConnection.getResponseMessage());
                // Reading data from url 

                if(urlConnection.getResponseMessage().contains("OK")){
                iStream = urlConnection.getInputStream();

                // Getting Caching directory 
                File cacheDirectory = getBaseContext().getCacheDir();
                cacheDirectory.delete();
                // Temporary file to store the downloaded image 
                File tmpFile = new File(cacheDirectory.getPath() + "/wpta_"+position+".png");               

                // The FileOutputStream to the temporary file
                FileOutputStream fOutStream = new FileOutputStream(tmpFile);

                // Creating a bitmap from the downloaded inputstream
                Bitmap b = BitmapFactory.decodeStream(iStream);             

                // Writing the bitmap to the temporary file as png file
                b.compress(Bitmap.CompressFormat.PNG,100, fOutStream);              

                // Flush the FileOutputStream
                fOutStream.flush();

                //Close the FileOutputStream
                fOutStream.close();             

                // Create a hashmap object to store image path and its position in the listview

                // Storing the path to the temporary image file
                hmBitmap.put("img",tmpFile.getPath());

                // Storing the position of the image in the listview
                hmBitmap.put("position",position);              

                // Returning the HashMap object containing the image path and position
                return hmBitmap;

               }else{
                    Log.i("nope", "nb");
                    String uriStr = "android.resource://" + "com.lars" + "/" + R.drawable.ic_launcher;
                    hmBitmap.put("img", uriStr);

                    hmBitmap.put("position",position);
                    return hmBitmap;
                }

            }catch (Exception e) {              
                e.printStackTrace();
            }
            return null;
        }

        @SuppressWarnings("unchecked")
        @Override
        protected void onPostExecute(HashMap<String, Object> result) {
            // Getting the path to the downloaded image

            String path = (String) result.get("img");           

            // Getting the position of the downloaded image
            int position = (Integer) result.get("position");

            // Getting adapter of the listview

            adapter = (SimpleAdapter ) list.getAdapter();

            // Getting the hashmap object at the specified position of the listview
            HashMap<String, Object> hm = (HashMap<String, Object>) adapter.getItem(position);   

            // Overwriting the existing path in the adapter 
            hm.put("img",path);

            // Noticing listview about the dataset changes
            adapter.notifyDataSetChanged();

        }

        @Override
        protected void onProgressUpdate(Void... values) {
            // TODO Auto-generated method stub
             publishProgress();

             adapter.notifyDataSetChanged();
             Log.i("Image Task", "Update");

            super.onProgressUpdate(values);
        }
    }

    private OnItemClickListener onAnswerClicked = new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view, int position,
                long id) {
            @SuppressWarnings("unchecked")
            HashMap<String, String> o = (HashMap<String, String>) parent.getItemAtPosition(position);

            Bundle extra = new Bundle();
            Intent i = new Intent("com.lars.productdescription");
            extra.putString("id", o.get("id"));
            i.putExtras(extra);
            startActivity(i);
        }

    };

    private OnScrollListener onAnswersScrolled = new OnScrollListener() {

        public void onScroll(AbsListView view, int first, int visibleitems, int totalitemcount) {
            // TODO Auto-generated method stub
            int lastInScreen = first + visibleitems;  
            if(lastInScreen == totalitemcount){
            if(kf == 0){
                Log.i("onScroll", ""  + c);
                Log.i("kf", "0");
                String filfinal = keuze.replace(" ", "thisisaspace");
                String strUrl = "http://www.lars.nl/getName.php?name=" + filfinal + "&page=" + c ;
                DownloadTask downloadTask = new DownloadTask();
                    downloadTask.execute(strUrl);
                    c = c + o;
                    Log.i("After Scroll", "" + c);
            }else{
                Log.i("onScroll", "" + c);
                Log.i("kf", "1");
                 String strUrl = "http://www.lars.nl/get.php?id=" + filter + "&page=" + c ;
                    DownloadTask downloadTask = new DownloadTask();
                        downloadTask.execute(strUrl);
                        c = c + o;
                        Log.i("After Scroll", "" + c);
            }
            }
        }

        public void onScrollStateChanged(AbsListView view, int scrollstate) {
            // TODO Auto-generated method stub

        }
    };

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:49:19.653

我想向您介绍[CWAC-ENDLESS](https://github.com/commonsguy/cwac-endless)，只有出色的马克·墨菲（commonsware）。它不仅是将适配器放入另一个适配器的强大示例，它还为您处理所有后台任务以及滚动，以便您可以按照[演示轻松添加数据列表](https://github.com/commonsguy/cwac-endless/tree/master/demo)

我真诚地希望这对您有帮助，就像它对我有帮助一样。

# c# - 按下按钮时如何在 C# 中加载新布局？

> ID：12976392
> 
> 赞同：0
> 
> 时间：2012-10-19T14:28:37.773
> 
> 标签：c#, winforms, layout

当按下按钮时，我想在 C# 中加载一个新的布局（就像我们在 Android 编程中做的 layout1.loadLayout() 一样）？

调用方法时如何执行此操作？

如果我的问题不清楚，我希望在单击按钮时加载一组新控件并将当前控件暂时隐藏在窗口窗体上（虽然它们应该保留其当前属性，这样如果我返回它们应该与我离开它们的方式相同）。

如何在不完全删除和一次又一次创建它们的情况下在不同布局之间跳转？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:31:35.193

如果这是用于桌面应用程序，请查看用户控件。

[信息在这里](http://msdn.microsoft.com/en-us/library/a6h7e207%28v=vs.71%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:36:01.417

您可以创建面板来对控件进行分组并切换其可见性。在组件中查找面板控件，然后向其添加控件，调整其可见性。

# jquery - 如何将 jQuery UI 图标添加到动态生成的按钮？

> ID：12976396
> 
> 赞同：2
> 
> 时间：2012-10-19T14:29:24.193
> 
> 标签：jquery, jquery-ui, jqgrid, icons

下载 jQuery UI 时，您会得到一个样式表，用于选择任何主题，以及几个包含图标的图像文件。我已经想出了如何将图标添加到单个`<button>`元素，但我有一种情况，我在网格 (jqGrid) 中动态生成按钮并想要使用这些图标。所以，假设我想使用 CSS 文件中的这个图标：

```
.ui-icon-trash { background-position: -176px -96px; } 
```

`gridComplete`然后，我通过处理事件将按钮添加到网格中：

```
gridComplete: function () {
    var ids = $("#myGrid").jqGrid('getDataIDs');
    for (var i = 0; i < ids.length; i++) {
        var deleteButton = "<button type='button' style='height: 22px;width: 20px;' title='Delete' onclick=deleteRow(" + ids[i] + ")></button>";
        $("#myGrid").jqGrid('setRowData', ids[i], { DeleteButton: deleteButton });
    }
} 
```

我试过在按钮标签中使用一个类，例如，`deleteRowButton`然后像这样使用 jQuery：

```
$(".deleteRowButton").button({
    icons: {
        primary: 'ui-icon-trash'
    },
    text: false
}); 
```

但这不起作用。我该怎么做才能让我的按钮有这个图标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T16:03:08.540

我想你的代码`$(".deleteRowButton").button({icons: {primary: 'ui-icon-trash'}, text: false});`没有工作，因为你把它放在了错误的地方。如果您创建`<button class='deleteRowButton' ...>`内部，`gridComplete`您应该在您发布的代码之后直接在`$(".deleteRowButton").button(...)`内部**进行调用：`gridComplete`**

```
gridComplete: function () {
    var $this = $(this), ids = $this.jqGrid('getDataIDs'), l = ids.length,
        i, deleteButton;
    for (i = 0; i < l; i++) {
        deleteButton = "<button type='button' style='height:22px;width:20px;'" +
            " class='deleteRowButton' title='Delete' onclick=deleteRow(" +
            ids[i] + ")></button>";
        $this.jqGrid('setRowData', ids[i], { DeleteButton: deleteButton });
    }
    $(".deleteRowButton").button({
        icons: {
            primary: 'ui-icon-trash'
        },
        text: false
    });
} 
```

见[第一个演示](http://www.ok-soft-gmbh.com/jqGrid/trashicon.htm)。

上述方法的性能存在一个小问题。使用`setRowData`您在页面上进行更改。页面上的每一次更改都会重新计算页面上**所有其他元素**的位置。因此，为了提高性能，建议减少网格上的更改次数。所以更好的方法是使用[自定义 formattrer](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3acustom_formatter)。新版本的代码实际上将与前一个版本一样简单。您只需要定义`formatter`为函数：

```
{ name: 'DeleteButton', width: 20,
    formatter: function (cellvalue, options) {
        return "<button type='button' class='deleteRowButton' " +
            "style='height: 22px;width: 20px;' title='Delete'></button>";
    }}, 
```

并减少`gridComplete`or`loadComplete`的代码

```
gridComplete: function () {
    $(".deleteRowButton").button({
        icons: {
            primary: 'ui-icon-trash'
        },
        text: false
    }).click(function (e) {
        var $tr = $(e.target).closest("tr.jqgrow");
        alert("the row with id=" + $tr.attr("id") + " need be deleted");
    });
} 
```

在您的原始代码中，该方法`deleteRow`必须是*全局*的（它应该在顶层定义）。新代码可以只使用`click`事件处理程序。请参阅[下一个演示](http://www.ok-soft-gmbh.com/jqGrid/trashicon1.htm)。

顺便说一句，您实际上并不需要将每个绑定`<button>`到`click`事件处理程序。众所周知，如果`click`按钮上没有事件处理程序，则会发生[事件冒泡](http://en.wikipedia.org/wiki/DOM_events#Event_flow)。`click`因此，不必每次在加载和重新加载网格时绑定事件处理程序，只需在整个网格体上定义**一次相应的事件处理程序即可。**换句话说，您可以使用`onCellSelect`回调。使用起来很舒服，因为`rowid`点击单元格的列的和索引已经计算过了。此外，根据回调的第 4 个参数`e`，`onCellSelect`您可以访问事件处理程序，其中`e.tagret`是 clicked 的 DOM 元素`<button>`。所以你可以替换上面的代码`gridComplete`到以下代码：

```
onCellSelect: function (rowid, iCol, cellcontent, e) {
    if ($(e.target).closest("button.deleteRowButton").length > 0) {
        alert("the row with id=" + rowid + " need be deleted");
    }
},
gridComplete: function () {
    $(".deleteRowButton").button({
        icons: {
            primary: 'ui-icon-trash'
        },
        text: false
    });
} 
```

在这种方式下，您可以进一步提高性能并减少页面使用的内存。[该演示](http://www.ok-soft-gmbh.com/jqGrid/trashicon2.htm)显示了最后的代码。在大多数情况下，您不需要使用`$(e.target).closest("button.deleteRowButton").length > 0`. 取而代之的是，您只需验证列 index `iCol`。如果需要，您可以改为测试列名。您可以使用

```
$(this).jqGrid("getGridParam", "colModel")[iCol].name 
```

将 转换`iCol`为相应的列名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:50:39.070

我建议从 'button' 切换到 'input type="button"' 您应该能够使用 CSS 中的背景图像来设置图标。您的网格完成功能将如下所示：

```
gridComplete: function () {    
var ids = $("#myGrid").jqGrid('getDataIDs');    
for (var i = 0; i < ids.length; i++) {    
    var deleteButton = "<input type='button' class='HasIcon' style='height: 22px;width: 20px;' title='Delete' onclick=deleteRow(" + ids[i] + ")/>";    
    $("#myGrid").jqGrid('setRowData', ids[i], { DeleteButton: deleteButton });    
} 
```

}

你的 CSS 看起来像这样：

```
#myGrid input[type=button].HasIcon
{
    background-image: url(/* icon location */);
    background-repeat: no-repeat;
    text-align: center;
    padding-left: 20px; /* slightly longer than your icon */
} 
```

您不需要使用 jquery 来应用图标，因为 CSS 会为您执行此操作。CSS 的魔力再次大获全胜！:-)

# visual-studio-2010 - 如何在 TFS 2010 查询中使用 and & or

> ID：12976404
> 
> 赞同：0
> 
> 时间：2012-10-19T14:29:36.970
> 
> 标签：visual-studio-2010, tfs

我创建了以下查询：

```
AndOr Field           Operator   Value
-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
      Team Project    =          @Project
And   Area Path       Under      MyProject 
And   Iteration Path  Under      MyProject\Iteration 5
And   Work Item Type  =          User Story
Or    Work Item Type  =          Task 
```

运行查询后，我会看到结果中的所有工作项，即使它们在迭代 4、迭代 3 等之下。

我只希望在 MyProject\Iteration5 下看到所有用户故事和任务项。

我添加迭代 5 的方式是转到区域和迭代并创建它。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:06:21.120

为了只查看用户故事和任务，您需要在查询编辑器中将这些子句组合在一起。

在 Visual Studio IDE 中，编辑您的查询，确保引用工作项类型的两行彼此相邻并且在子句列表中的最后一个，例如

*   1 个团队项目 = @Project
*   2 和 \MyIteration 下的迭代
*   3 工作项类型 = 用户故事
*   4 或工作项类型 = 任务

突出显示工作项类型子句（第 3 项和第 4 项）并右键单击并选择“组子句”。执行您的查询。

# c++ - 一个解决方案，两个项目：如何从 Windows 应用程序调用控制台项目？C++

> ID：12976405
> 
> 赞同：1
> 
> 时间：2012-10-19T14:29:39.317
> 
> 标签：c++, visual-studio-2010, console-application, projects-and-solutions, windows-applications

使用 Visual Studio 2010，使用 C++ 编码：

所以我有一个解决方案和两个项目：项目 1 是一个 Windows 应用程序，旨在充当程序的 GUI，而项目 2 是一个控制台应用程序，旨在与一些外部应用程序交互。

我想在项目 1 中创建一个按钮，按下该按钮会执行项目 2。最简单的方法是什么？我正在考虑通过命令提示符使用“system(”Project2.exe“);”运行项目 2。一种方法，但我不知道如何引用项目可执行文件而不是外部的、已经存在的可执行文件。

一般来说，我对 C++ 和 Visual Studio 还是很陌生，所以我可能在这里遗漏了一些明显的东西，抱歉。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:57:54.130

如果您想运行另一个程序（甚至是您的其他项目或您上次登月时获得的一些不相关的执行人员），您现在应该以绝对或相对形式显示其他项目的路径，或者它应该在路径中。

因此，在您知道路径的系统中，您可以在源文件中对其进行硬编码，例如`system( "C:\\path\\to\\my\\application.exe" )`或`system( "..\\project2\\output.exe")`.

在另一个系统中，您有 3 个选项：

*   通过将其路径添加到系统或`project2.exe`将其复制到已经在路径中的文件夹中，例如文件夹`PATH``PATH``system`

*   通过使用设置将其复制到预定义文件夹（通常相对于`project1.exe`）中，例如在同一文件夹中或`..\\server\\project2.exe`

*   创建一个配置文件，用户可以在其中放置可执行文件的`project2.exe`路径

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:33:32.697

您可以将项目 2 更改为构建为类库，这样您就可以在项目 1 中使用该 dll 了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:36:07.470

我认为迈克所说的是更好的方法，但我想你会在这里遇到同样的问题。您必须定义“项目依赖关系”。右键单击项目 1 -> 项目依赖项 -> 选择项目 2。现在项目 2 在项目 1 之前编译。（如果你决定这样做，你必须对库做同样的事情）。

如果要在编译后移动文件，可以在属性中定义构建后事件。（配置属性->构建事件->构建后事件）在那里您可以通过定义例如命令来复制文件`xcopy /y "$(ProjectDir)Release/myexe.exe" "Some path"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:39:28.750

除了 Mike Corcoran 提到的，你也可以使用任何外部程序，如果你把它放到系统的 PATH 变量中，然后让它通过`system(const char *)`函数执行

以这种方式驾驶它是可以通过的，但它不是正确的方式。例如，如果您的程序是交互式的，它会立即失败或出现 UB（**未定义行为**）。为避免这种情况，请将程序的逻辑与输入/输出分开，并在代码中解决它。

一些成功的 Linux 程序已经设法获得控制台应用程序的输出并将其显示在 GUI 上（让您在内部与之交互）。甚至 Visual Studio 也会这样做 - 您在编译应用程序时看到的输出（例如“成功构建”等）在命令行中执行，然后重定向它的输出。

祝你好运。

# java - 您是否应该返回传递的参数只是为了表示 Java 中的可变性

> ID：12976411
> 
> 赞同：2
> 
> 时间：2012-10-19T14:30:03.993
> 
> 标签：java

我相信这更像是一个主观问题，但我很好奇人们的意见......

今天上班看到下面这个方法....

```
public T execute(T dto){...return dto;} 
```

这对我来说似乎是多余的，在我看来这更好......

```
public void execute(T dto) 
```

现在，在这种方法中，可以说以下调用....

```
dto.setProperty(something); 
```

但是一位同事（以及一些 StackOverflow 帖子）认为这很糟糕，因为它并不表明该方法可能正在改变 T 对象。但是，这应该反映在堆栈中的对象上，所以我为什么需要返回。

这是一个正当的理由吗，在我看来，这必须导致开销增加（尽管平心而论，我们在这里使用 Java）

关于哪个更好的任何见解？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T14:37:45.693

这取决于什么`T`是，T 是否是不可变的，以及什么是不可变的`execute`。这个问题真的很笼统，而且细节很重要。

```
void addPerson(Club clubFullOfPeople, Person person);

T clone(T t); 
```

既有效又让我觉得设计很好。

要回答您的确切问题-您是否应该返回信号可变性？这绝对让我感到震惊，因为如果有的话，它会表明 IM 可变性，不，绝对不是，但你需要更清晰的变量名称、文档等来传达这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:36:12.377

这不是一种*不合理*的风格，它只是一个应该做出的决定（逐个项目） - 与工作环境中使用的风格保持一致。下一个项目/工作可能会有不同的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:04:15.970

这两种风格都暗示 DTO 可以或不能更改。事实上，如果有的话，第一种形式宁愿建议参数化的​​ DTO*没有*被更改，但如果正在进行更改，它们将在返回的对象中进行。

返回 DTO 的优点：

1.  可以链接调用（这可能是好是坏，取决于编码风格和实际方法/对象的使用）。例如，jQuery 的构建使得几乎每个调用都可以链接起来。
2.  您可以返回空值或 DTO 的其他对象/形式，以表示某些类型的失败

在您的“首选”表示法中，表示失败的唯一方法是通过运行时异常。在不知道该`execute`方法应该完成什么的情况下，这可能没问题，或者可能表明一个更大的问题，即异常被用于处理流控制（一件坏事）。

净结果？我认为没有“更好”的解决方案 - 只是更符合您当前在现有代码库中所做的事情。

# xpages - 您自己的托管 bean 并提前输入

> ID：12976413
> 
> 赞同：1
> 
> 时间：2012-10-19T14:30:08.493
> 
> 标签：xpages

如果我创建自己的托管 bean，是否可以使用我自己的 Bean/Java 代码在 Domino Designer 中使用该类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:58:08.540

我有一个 MB DebugHelper。正如您从屏幕截图中看到的那样，只要我键入点，它就会显示 bean 方法 debugPrint()。这是你要求的吗？ ![在此处输入图像描述](../Images/e2a9152346d2a5bdee1ef28af7c881f2.png)

# linq - 实体框架/ Linq - groupby 和 having 子句

> ID：12976414
> 
> 赞同：2
> 
> 时间：2012-10-19T14:30:15.490
> 
> 标签：linq, entity-framework

鉴于以下查询

```
 public TrainingListViewModel(List<int> employeeIdList)
        {
            this.EmployeeOtherLeaveItemList =
                CacheObjects.AllEmployeeOtherLeaves
                .Where(x => x.OtherLeaveDate >= Utility.GetToday() &&
                    x.CancelDate.HasValue == false &&
                    x.OtherLeaveId == Constants.TrainingId)
                .OrderBy(x => x.OtherLeaveDate)
                .Select(x => new EmployeeOtherLeaveItem
                {
                    EmployeeOtherLeave = x,
                    SelectedFlag = false
                }).ToList();
        } 
```

我想将employeeIdList 放入查询中。我想检索所有 x.OtherLeaveDate 值，其中每个连接都存在相同的 x.OtherLeaveDate 其中 x.EmployeeId = (int employeeId in employeeIdList)

例如，如果在 employeeIdList 和 CacheObjects.AllEmployeeOtherLeaves 集合中有 EmployeeIds 1、2、3，则所有 3 名员工的日期都是 2001 年 1 月 1 日，然后检索该日期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-21T15:20:23.413

如果我读得很好，应该是这样的

```
var grp = this.EmployeeOtherLeaveItemList =
    CacheObjects.AllEmployeeOtherLeaves
    .Where(x => x.OtherLeaveDate >= Utility.GetToday()
             && x.CancelDate.HasValue == false
             && x.OtherLeaveId == Constants.TrainingId
             && employeeIdList.Contains(x.EmployeeId)) // courtesy @IronMan84
    .GroupBy(x => x.OtherLeaveDate);

if (grp.Count() == 1)
{
    var result = g.First().Select(x => new EmployeeOtherLeaveItem
    {
        EmployeeOtherLeave = x,
        SelectedFlag = false
    })
} 
```

首先，数据按 分组`OtherLeaveDate`。如果分组结果恰好是一个组，则采用第一个（也是唯一的）`IGrouping`实例（它是一个`Leave`对象列表）并将其内容投影到`EmployeeOtherLeaveItem`s。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:51:58.873

在 where 语句中添加“&& employeeIdList.Contains(x.EmployeeId)”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T15:02:52.770

我需要感谢@IronMan84 和@GertArnold 帮助我，我将不得不告诫自己在问题上没有更清楚。这是我想出的答案。毫无疑问，它可以改进，但没有人回答说为什么我现在要勾选这个答案。

```
 var numberOfEmployees = employeeIdList.Count;

var grp = CacheObjects.AllEmployeeOtherLeaves.Where(
                    x =>
                    x.OtherLeaveDate >= Utility.GetToday() 
                    && x.CancelDate.HasValue == false
                    && x.OtherLeaveId == Constants.TrainingId 
                    && employeeIdList.Contains(x.EmployeeId))
                    .GroupBy(x => x.OtherLeaveDate)
                    .Select(x => new { NumberOf = x.Count(), Item = x });

            var list =
                grp.Where(item => item.NumberOf == numberOfEmployees).Select(item => item.Item.Key).ToList(); 
```

# c# - 在 C# 中更改 IIS7 绑定的 IP

> ID：12976415
> 
> 赞同：2
> 
> 时间：2012-10-19T14:30:18.047
> 
> 标签：c#, iis-7

我有一个 IIS7 Web 服务器，它运行大量站点，每个站点都有多个绑定。每个站点都使用主机标头和自己的 IP。

使用 C# 我需要将所有绑定的 IP 更改为 0.0.0.0，以便它们侦听所有 IP。

我当前的代码不会添加新绑定，而是清除旧绑定。任何想法我做错了什么？

我的代码：

```
using (ServerManager iisServerManager = new ServerManager())
        {
            foreach (Site site in iisServerManager.Sites)
            {
                List<Microsoft.Web.Administration.Binding> bindings = new List<Microsoft.Web.Administration.Binding>();

                foreach (Microsoft.Web.Administration.Binding binding in site.Bindings)
                {
                    String protocol = binding.Protocol;

                    String hostHeader = binding.Host;

                    String ipAddress = "0.0.0.0";

                    Int32 port = binding.EndPoint.Port;

                    String bind = ipAddress + ":" + port + ":" + hostHeader;

                    binding.BindingInformation = bind;

                    bindings.Add(binding);
                }

                //Clear existing site bindings
                site.Bindings.Clear();

                Int32 bindingCount = site.Bindings.Count();

                foreach (Microsoft.Web.Administration.Binding binding in bindings)
                {
                    site.Bindings.Add(binding);

                    bindingCount = site.Bindings.Count();
                }

                bindingCount = site.Bindings.Count();

                iisServerManager.CommitChanges();
            }
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T19:23:20.537

您无需删除然后重新添加相同的绑定。您可以就地修改它们，然后提交您的更改。此外，当您想监听所有 IP 地址时，您想使用 '*' 而不是 '0.0.0.0' 的 IP 地址。

这对我有用...

```
using (ServerManager iisServerManager = new ServerManager())
{
    foreach (Site site in iisServerManager.Sites)
    {
        foreach (Binding binding in site.Bindings)
        {
            string ipAddress = "*";
            int port = binding.EndPoint.Port;
            string hostHeader = binding.Host;

            binding.BindingInformation = string.Format("{0}:{1}:{2}", ipAddress, port, hostHeader);
        }

        iisServerManager.CommitChanges();
    }
} 
```

# django - 带有 Django 表单的 Twitter Bootstrap 的“.input-prepend”

> ID：12976420
> 
> 赞同：0
> 
> 时间：2012-10-19T14:30:42.807
> 
> 标签：django, forms, twitter-bootstrap

我是 Django 新手，一直在使用[django-bootstrap-form](https://github.com/tzangms/django-bootstrap-form)。我对它很满意，但我不相信它提供了一种方法来格式化“.input-prepend”的输出，如[Twitter Bootstrap 的文档](http://twitter.github.com/bootstrap/base-css.html#prependedInput)中所述。

我猜我将不得不为这个特定字段覆盖我的输入字段的小部件。不过，我不确定执行此操作的最佳方法。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:46:02.183

您必须编辑模板，添加一个 if 子句用于前置，可能还有两个用于附加或同时添加两种情况，或者使用模板标签（甚至更好，小部件[渲染](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#django.forms.Widget.render)方法）处理此问题。

看看有什么[可以](https://github.com/tzangms/django-bootstrap-form/blob/master/bootstrapform/templatetags/bootstrap.py)掌握它的窍门。

对于字段本身，要么创建自定义[表单](https://docs.djangoproject.com/en/dev/ref/forms/fields/#creating-custom-fields)域，要么通过[包装](https://docs.djangoproject.com/en/dev/ref/forms/widgets/#multiwidget)基本小部件来创建小部件。

# unicode - 如何从字体文件中删除字符？

> ID：12976424
> 
> 赞同：19
> 
> 时间：2012-10-19T14:30:56.503
> 
> 标签：unicode, font-face, webfonts

我已经下载了[DejaVu 开源字体](http://sourceforge.net/projects/dejavu/)并想使用它作为 WebFont，但即使在转换它时，我也会得到一个大文件，而且因为我将使用的网站只有几种语言（阿拉伯语、法语、amazigh ) 那么，我不需要一些字符。

那么有没有办法浏览字体文件并删除我不需要的不必要的 unicode 字符范围？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-05-15T16:53:49.047

使用[FontForge](https://fontforge.org/en-US/)，您可以打开`Element`-> `Font Info`-> `Unicode Ranges`。您将看到所有可用的范围，并且只需单击一下即可选择整个 Unicode 范围。`Encoding`然后，您可以使用->调整您的选择和删除`Detach & Remove Glyphs`。

此外，您可以使用`Edit`-> `Select`-> `Select by Script`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-01-28T22:27:38.260

我发现最简单的方法是使用[FontTools](https://pypi.python.org/pypi/FontTools)`pyftsubset`中的工具。这是一个例子：

```
$ pyftsubset NotoSans-Regular.ttf \
      --unicodes=U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116 \
      --output-file=NotoSans-Regular.cyrillic.woff2 \
      --flavor=woff2 
```

注意：`woff2`输出需要[Brotli](https://pypi.python.org/pypi/Brotli)。

我围绕它编写了一个简单的脚本，它可以自动执行整个过程，包括在拆分字体文件后生成 CSS 文件。你可以在这里找到它：[https ://github.com/johncf/ttf2web](https://github.com/johncf/ttf2web)

# routes - Symfony 上的条件路由

> ID：12976429
> 
> 赞同：1
> 
> 时间：2012-10-19T14:31:15.610
> 
> 标签：routes, symfony-1.4

我们已经部署了一个 Symfony 应用程序，我们决定在其中使用 URL like`organization.app-name-domain.com`来显示有关我们数据库中列出的组织的信息。为此，我们像这样编写 routing.yml：

```
homepage:
     url:   /
     class: sfDomainRoute
     param: { module: home, action: index }
     requirements:
          sf_host: [<?php echo sfConfig::get('app_urlapp') ?>, www.<?php echo sfConfig::get('app_urlapp')."]\n" ?>

homepage_org:
     url:   /
     class: sfDomainRoute
     param: { module: org, action: show } 
```

现在我们正在另一个域中部署完全相同的应用程序，即第三方合作伙伴的子域。新的应用 URL 类似于`app-name.partner-domain.com`.

因此，我们不能让组织成为子域，而不是像以前那样。

这不是一个大问题，我们可以`routing.yml`将新应用程序更改为更常见的 URL，`app-name.partner-domain.com/organization`但这对我来说不够流畅，因为我们希望让两个应用程序都依赖于同一个存储库等......

`frontendConfiguration.class.php`我想到的可能的解决方案是根据定义的应用程序名称手动进行路由`app.yml`。但我无法访问路由应用程序实例。`sfContext::getRoutes()`返回`null`。

我从 Symfony 1.0 [HERE](http://www.symfony-project.org/book/1_0/09-Links-and-the-Routing-System#chapter_09_sub_creating_rules_without_routing_yml)得到了制作条件路由的想法。

关于我们如何在 Symfony 1.4 上重现该代码的任何想法？

# ruby - 测试 $? ruby rspec中的全局变量

> ID：12976432
> 
> 赞同：1
> 
> 时间：2012-10-19T14:31:23.540
> 
> 标签：ruby, tdd, rspec2

我有一段代码，如：

```
output = `shell-command-to-run`
unless $?.success?
  raise "Failure running shell command!"
end 
```

我已经模拟了反引号方法以防止外部 shell 命令在我的规范期间运行，但我还没有找到一种方法来设置`$?`全局变量来行使规范的失败方面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:34:16.253

也许您应该有一个脚本来返回您期望发现的各种错误，以便您可以测试各种条件。例如：

```
#!/usr/bin/env ruby

exit(ARGV[0].to_i) 
```

然后，您可以传入要捕获的退出代码。

无需模拟调用，您只需完全运行一个不同的脚本来验证它是否正确处理错误。

# c - KERN_INVALID_ADDRESS 让我难过

> ID：12976439
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:31:49.120
> 
> 标签：c, vigenere, cs50

我在尝试运行调试器时不断收到此错误：

```
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x0000000000000000
0x00007fff8c2414f0 in strlen () 
```

这是我的代码：

```
#include <stdio.h>
#include <cs50.h>
#include <string.h>
#include <ctype.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
    char s2[25];
    strcpy(s2, argv[1]);
    int keyLen = strlen(s2);
    printf("Please enter a string of text to be encrypted!\n");
    string p = GetString();
    for (int i = 0, n = strlen(p); i < n; i++)
    {
        if (isupper(p[i])){
        int sum = (p[i] - 'A') + (s2[i % keyLen] - 'A');
        char c = 'A' + sum%26;
        printf("%c", c);
        }
    }
    printf("\n");
    printf("%d\n", keyLen);

} 
```

我可以毫无错误地编译代码，并且它可以正常工作。我正在运行调试器以进入`for`循环并查看数学在做什么以更好地理解它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:37:10.100

如果`GetString()`返回`null`，则调用`strlen(null)`将给出此错误。部分的其他错误`GetString()`也可能导致此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:44:08.283

什么是 C 中的“字符串”类型？Strlen() 需要 C 类型的数组，而不是一些自定义的“字符串”类型。（+如上所述，有可能出现空输入）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:42:11.340

多亏了hmjd，我终于得到了它我运行不正确我会启动程序

```
gdb vignere HHHHH 
```

这是不正确的 我跑了

```
gdb vignere
run HHHHHH 
```

效果很好！

# javascript - OpenLayers：修改功能不起作用

> ID：12976441
> 
> 赞同：1
> 
> 时间：2012-10-19T14:31:57.650
> 
> 标签：javascript, openlayers

我只是希望我可以修改我的台词。但是虽然 onModificationStart 被触发，模式被设置为 RESHAPE，正确的层被设置并且 createVertices 被设置为 true，它看起来就像一个正常的选择，没有任何用于修改的圆圈。

我已经停用了任何其他控件（大量的 SelectFeatures 和 DrawFeatures、HighlightFeature 等），但什么也没有！我还查找了 OpenLayers-Example。

有什么特别要注意的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T18:37:43.330

一种可能的解释：您的图层可能具有样式，其中点符号不可见。演示：http: [//jsfiddle.net/jSQrj/11/](http://jsfiddle.net/jSQrj/11/)

注释掉一行

```
pointRadius: 6 
```

结果，点对象的样式将不正确，并且所选功能的处理程序将不可见（通常最好使用 OpenLayers.Util.extend 扩展默认样式，而不是解决方案，例如示例）。

# extjs - extjs网格引用图标不显示

> ID：12976445
> 
> 赞同：2
> 
> 时间：2012-10-19T14:32:01.807
> 
> 标签：extjs, grid, icons, html-editor

我正在使用 Extjs 4.0.7 版本。Html 编辑器图标图像、网格刷新和分页按钮图像未显示。

我检查了另一个工作设置，在那里我找到了网格刷新图标的 x-tbar-loading 类，但是在我在我的系统上使用的设置中，找不到上面的 calss。但是 css 和 js 文件与工作设置相同。

![在此处输入图像描述](../Images/d7327002eff938020e72b87828a003e5.png)

![在此处输入图像描述](../Images/065e9b78a6768dda0eecc09ca74bb1f5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T21:01:06.317

检查以确保您包含随发行版提供的资源。也确实没有必要挂回 4.0.7 - 4.1.1 中已经修复了很多问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T05:59:32.863

I was having the same issue using Ext JS 4.2.1\. My application skeleton was created using Sencha CMD. In order to get things working again, I need to rebuild the application using the following commands. It seemed to need both:

```
sencha app build
sencha app refresh 
```

Not sure of the exact order, but after doing that, I was able to get things working properly.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-29T06:40:11.133

你需要添加

Ext.tip.QuickTipManager.init();

# mysql - LEFT JOIN 或 INNER JOIN 从一个表中查找第二个表中的项目

> ID：12976446
> 
> 赞同：0
> 
> 时间：2012-10-19T14:32:01.120
> 
> 标签：mysql, join, left-join, inner-join

我有一个关于 JOINS 的快速问题。

如果我想从 table1 中查找 table2 中使用了多少项目，我会使用 INNER JOIN 还是 LEFT JOIN（见下文）。

INNER JOIN 会告诉我两个表中的“ID”在哪里，因此应该表示 table1 中的 ID 何时在 table2 中使用，但随后列出 ID 与 table1 ID 相同的所有 table2 ID（LEFT JOIN）应该带回相同的？

但结果不同：

INNER JOIN 带回 252,222 LEFT JOIN 带回 258,637

*PS：table2 是 table1 的子项，因此 table2 ID 只能来自 table1（table1 是产品列表，table2 是所选产品列表）所以要查找 table1 中所有在 table2 中选择的产品（已选择）*

```
SELECT DISTINCT 
t1.name, t1.details
FROM 
table1 AS t1
INNER JOIN 
table2 AS t2 ON t1.id = t2.t1_id

SELECT DISTINCT 
t1.name, t1.details
FROM 
table1 AS t1
LEFT JOIN 
table2 AS t2 ON t1.id = t2.t1_id 
```

这将是正确的 SQL，我猜是 INNER JOIN。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:34:49.310

`LEFT JOIN`不一样`INNER JOIN`。使用 a `LEFT JOIN`，也会返回第二个表中不存在的那些行！如果您想要那些在第二个表中也有 ID 的记录，请使用**`INNER JOIN`**.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:36:05.923

> INNER JOIN 会告诉我两个表中的“ID”在哪里，因此应该表示 table1 中的 ID 何时在 table2 中使用，但随后列出 ID 与 table1 ID 相同的所有 table2 ID（LEFT JOIN）应该带回相同的？

在这种情况下，INNER JOIN 非常有意义，因为它会提供 table1 和 table2 共有的记录。

> table2 是 table1 的子项，因此 table2 ID 只能来自 table1（table1 是产品列表，table2 是所选产品列表），因此从 table1 中查找所有在 table2 中选择的产品（已选中）

这要求您`FOREIGN KEY`在 TABLE2 中强制执行约束，即 ID 只能在它们出现在 TABLE1 中之后出现。一旦你这样做了，那就有意义了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:49:33.280

对于left join，如果结果不满足join则从table1和table2返回null的结果。在内部连接的情况下，将只返回满足条件的结果。

# data-annotations - 编写 DataAnnotations 的最佳方法

> ID：12976447
> 
> 赞同：0
> 
> 时间：2012-10-19T14:32:05.890
> 
> 标签：data-annotations, wcf-ria-services, silverlight-5.0

当必须重新生成域服务时，编写 DataAnnotations 并且不会丢失它们的最佳方法是什么？

我要做的是拥有 DomainServise.matadata.cs 文件的副本，然后如果我重新生成域服务，我会从副本中取回这些注释。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T14:03:20.630

DataAnnotations 属性通常从您的实体定义的服务器端复制到实体生成的客户端。（也可以通过自定义元数据提供程序注入这些属性，这样您就不会向模型添加依赖项，在我的博客中[我已经使用 nhibernate 完成了它](http://mcasamento.blogspot.it/2010/06/wcf-ria-services-e-nhibernate-un-passo.html)）

看看[这个教程](http://www.silverlightshow.net/items/WCF-RIA-Services-Part-5-Metadata-and-Shared-Classes.aspx)，看看它是否适合你需要。
Microsoft 还提供了有关如何基于 xml 文件创建自定义 WCF Metadataprovider 的示例，我已在他的地址添加了书签：[http ://code.msdn.microsoft.com/RiaServices/Release/ProjectReleases.aspx?ReleaseId= 2659](http://code.msdn.microsoft.com/RiaServices/Release/ProjectReleases.aspx?ReleaseId=2659)，但链接似乎不再活动，如果这是您需要的，我可以尝试在我的备份硬盘上找到它；）

最后，还看一下[WCF RIA services domain service metadata](https://stackoverflow.com/questions/5285851/wcf-ria-services-domain-service-metadata)，有一个使用部分类的示例，wcf ria services 默认方式（尽管您必须为某些属性添加对 system.servicemodel 程序集的依赖）

# php - 自定义文件中的 Joomla 登录模块

> ID：12976448
> 
> 赞同：1
> 
> 时间：2012-10-19T14:32:08.267
> 
> 标签：php, joomla

我们已经安装并运行了 Joomla，但是登录模块不是我们想要的。我们使用的主题有一个内置的“样式面板”，可以在页面右侧滑入和滑出。我们用它来显示一些用户数据，但它实际上并不是龙门框架中定义的位置。

因此，我们无法将登录模块分配给该区域...有谁知道如何从模块中调用元素，以便它们也可以显示在我们想要的位置并具有相同的功能？

编辑：[http ://demo.rockettheme.com/?template=voxel](http://demo.rockettheme.com/?template=voxel)

左侧的面板。我们已经编辑了那个（php 文件）来显示我们想要的一些信息，但是我们也想要那里的登录框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:54:22.743

您将需要从登录模块文件夹中包含文件，因此如下：

```
include (JURI::root() . "modules/mod_login/mod_login.php");

include (JURI::root() . "modules/mod_login/helper.php");

include (JURI::root() . "modules/mod_login/tmpl/default.php"); 
```

完成此操作后，请告诉我它是否有效，如果无效，我将相应地更新我的答案。

# debugging - 在 Visual Studio 2005 的调试模式下，文本框被禁用（不可编辑）

> ID：12976451
> 
> 赞同：1
> 
> 时间：2012-10-19T14:32:25.770
> 
> 标签：debugging, textbox, visual-studio-2005, disabled-input

它一直工作正常，没有任何问题，只是突然注意到如果我处于调试模式，我无法编辑任何文本框，在运行模式下没有问题我的 Visual Studio 是 2005，以前从未遇到过这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T21:29:43.290

将IE升级到8后问题消失了

# excel - 总和（A1：A2）<> A1 + A2？

> ID：12976452
> 
> 赞同：3
> 
> 时间：2012-10-19T14:32:32.853
> 
> 标签：excel

我注意到 SUM(A1:A2) <> A1 + A2 当 A1 和 A2 为布尔值时返回 true（例如 A1=TRUE 和 A2=FALSE）。这同样适用于 PRODUCT 和“*”运算符。这种奇怪行为背后的理由（如果有的话）是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:10:11.760

Excel 将 True 和 False 存储为逻辑值，当在公式中使用时，它们的数值转换为 1 表示 True，0 表示 False。但是，要将它们的值计入数组公式中，它们必须手动输入，而不是通过引用添加，见下文。

根据this [MSDN for SUM](http://msdn.microsoft.com/en-us/library/office/bb239771%28v=office.12%29.aspx)（我添加的重点）：

> •**直接输入参数列表的数字、****逻辑值**和数字的文本表示将被计算在内。请参阅下面的第一个和第二个示例。
> 
>  **•**如果参数是数组或引用**，则仅计算该数组或引用中的数字。**数组或引用中的**空单元格、**逻辑值**或文本将被忽略。请参见下面的第三个示例。**

 ****例如，如果您这样做`=SUM(TRUE,FALSE)`将等于 1。但是正如您所指出的，当您使用实际的单元格引用时，这些值将被忽略。****

# telerik-reporting - 在 Telerik 报告中设置条形码标签行之间的不同间距

> ID：12976454
> 
> 赞同：1
> 
> 时间：2012-10-19T14:32:34.023
> 
> 标签：telerik-reporting

我的 Telerik 条码报告有 3 行 2 列，意味着一页上有 6 个条码标签。通常报告在所有行之间放置相同的间距，但我希望报告上的行之间的间距不同。例如，假设第一行和第二行之间有 0.5 个空格，第二行和第三行之间有 1.5 个空格。

请问我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:59:55.047

使用 Telerik 的报表设计器应该非常简单，只需单击字段并设置填充量。您是否有某些原因无法使用报表设计器？

[http://www.telerik.com/help/reporting/ui-report-designer.html](http://www.telerik.com/help/reporting/ui-report-designer.html)

# mysql - SQL在R值中插入多对数组类型的数组？

> ID：12976455
> 
> 赞同：0
> 
> 时间：2012-10-19T14:32:35.350
> 
> 标签：mysql, sql, plsql

我想知道是否可以在`INSERT`语句中插入多个值，如下所示：

```
INSERT INTO myTable VALUES ( constant , ARRAY(multipleValues) ); 
```

如果这不可能，我将使用存储过程。我的问题更多是出于好奇而不是出于真正的目的，因为我正在使用一个工作循环，它一次插入一次记录并且可以完成这项工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:44:30.310

MySQL 没有数组数据类型。为了将应用程序代码中的数组传递到 MySQL 查询中，您需要将其分解为字符串。

然后你可以这样做：

```
INSERT INTO myTable
VALUES
  (constant, value1),
  (constant, value2),
  (constant, value3),
  -- etc. 
```

或者：

```
INSERT INTO myTable
SELECT constant, t.value
FROM (
  SELECT value1 AS value
UNION ALL
  SELECT value2
UNION ALL
  SELECT value3
-- etc.
) AS t 
```

通常第一种形式更简洁，但是如果有大量常量列，第二种形式可能更有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:43:26.193

您可以在 VALUES 部分中插入多条记录，如下所示

```
 INSERT INTO example (example_id, name, value, other_value)
 VALUES
 (100, 'Name 1', 'Value 1', 'Other 1'),
 (101, 'Name 2', 'Value 2', 'Other 2'),
 (102, 'Name 3', 'Value 3', 'Other 3'),
 (103, 'Name 4', 'Value 4', 'Other 4'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T09:51:29.143

[正如我在对@eggyal 的评论中所说，](https://stackoverflow.com/questions/12976455/sql-insert-multiple-couples-with-kind-of-array-in-r-value#comment17623944_12976681) 我找到了解决方案：

```
INSERT INTO
    t1
SELECT
    "theConstant",
    subValue
FROM
    subTable
; 
```

感谢@eggyal 的主要想法。

# localhost - 本地主机上 URL 中的 PHP 会话 ID

> ID：12976457
> 
> 赞同：2
> 
> 时间：2012-10-19T14:32:43.177
> 
> 标签：localhost, osx-mountain-lion, php, sessionid

出于某种原因，我正在处理的项目的本地安装正在将 PHP 会话 ID 添加到 URL。这不会发生在任何其他服务器上。有没有我可以改变的设置来改变这个？我在 Mac OS 10.8.2 上使用 PHP 5.4

示例网址：`http://localhost/project/subfolder/index.php/admin/game?PHPSESSID=mhnpc0g2c8rijqpkf8lhpfshh7`

应该：`http://localhost/project/subfolder/index.php/admin/game`

**更新：**我检查了我的 PHP.ini 文件并且我的以下设置正确，但我仍然在 URL 中获取会话 ID。

```
session.use_cookies = 1
session.use_only_cookies = 1
session.use_trans_sid = 0 
```

哦，为了更好的衡量，我在每次更改 PHP.ini 后重新启动 Apache :-)

**第二次更新：**我的 Mac 上还有什么地方可以隐藏 ini 文件？PEAR 可能在搞砸这个吗？谢谢大家！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:34:44.477

检查您的 php.ini 文件，更具体地说是有关会话内容的部分。确保设置使用 cookie 而不是 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:39:57.707

你应该在你的设置`php.ini`如下：

```
session.use_cookies = 1
session.use_only_cookies = 1
session.use_trans_sid = 0 
```

**编辑：**

这可以由 php 本身使用`ini_set`函数覆盖，也可以在`.htaccess`文件中或在 apache 虚拟主机的描述中使用`php_flag`.

定位问题的一个好工具是`grep`实用程序。尝试像这样使用它：

```
egrep -ir 'php_falg|ini_set' /etc/httpd/ 
```

在 apache 的配置中搜索失败，并且再次使用相同的命令，但指向您的项目（如果它在`.htaccess`文件中并且在其他服务器上配置了`AllowOverride None`该`.htaccess`文件的虚拟主机将无法在那里工作）

```
egrep -ir 'php_falg|ini_set' ~/Sites/ # or in whathever path your site is. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T07:38:56.470

```
session.use_cookies = 1 session.use_only_cookies = 0 session.use_trans_sid = 1 
```

# c++ - 使用 fstream 读取

> ID：12976463
> 
> 赞同：0
> 
> 时间：2012-10-19T14:33:03.010
> 
> 标签：c++, fstream

我正在使用 fstream 读取二进制文件，但奇怪的是，每次执行代码时，同一个输入文件都会得到不同的值。

```
if(fs->is_open())
  {
    while (!fs->eof())
    {
      fs->seekg( pos );
      fs->read( (char *)&mdfHeader, sizeof(mdfHeader_t) );
      pos += mdfHeader.length;
      fs->read( (char *)&eventHeader, sizeof(eventHeader_t) );
      fs->read( (char *)&rawHeader, sizeof(rawHeader_t) );

      fs->read( (char *)&ingressHeader, sizeof(ingressHeader_t) );

      fs->read( (char *)&l1Header_xc0, sizeof(l1Header_xc0_t) );

      fs->read(data, dataLength);
      printf("Data=%#x\n",data);

      std::cout << "counter: " << c << "\n";
      c++;
    }

    fs->close();

  } 
```

如您所见，我打印出数据，每次都应该相同，但会产生不同的值。mdfHeader.length 是一个数据块的长度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:50:24.830

首先要改变的是：

1.  该条件`eof()`仅对确定读取数据失败的原因非常有用，但对于循环来说不是有用的条件。
2.  您需要在阅读**后**检查您是否成功读取了您感兴趣的数据。

那，循环看起来像这样：

```
while (*fs) {
    // read data from fs
    if (*fs) {
        // do something with the data
    }
    else if (!fs->eof()) {
        std::cout << "ERROR: failed to read record\n";
    }
} 
```

我还猜想您不需要搜索，摆脱它们是个好主意：搜索相对昂贵，因为它会丢失任何缓冲区。您没有显示整个代码，但 的初始值`pos`有公平的机会提供某种程度的随机性。此外，您假设您正在读取的字节序列与数据在计算机中的布局方式相匹配。通常情况并非如此，您通常需要调整二进制格式，例如，以适应不同大小的单词、不同的字节序、填充等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:51:02.633

计算机就像数学，每一件事都是确定的（即使对于像`rand`输入相同的函数，输出也和以前一样）所以如果你以相同的输入和状态运行代码一百次，你肯定会得到相同的输出，除非输入或运行状态改变。

你说每次执行代码时输入都是相同的，所以唯一改变的是运行状态（例如`malloc`，每次运行程序时可能返回 2 个不同的值，因为它可能在不同的状态下工作，因为它的状态会由操作系统指示）。

在您的代码中，您用于`printf("Data=%#x\n",data);`输出数据，但实际上它只是将数据地址打印为十六进制值，因此在程序的多次运行中，该地址可能会更改，因为操作系统将您的执行程序映射到不同的位置或其他任何东西，这是很自然的。您应该输出 的内容，`data`您会看到它与之前的运行相同

# objective-c - 是否可以将 UILabel 添加到已经将 UIButton 作为子视图的 UITableView 单元？

> ID：12976465
> 
> 赞同：0
> 
> 时间：2012-10-19T14:33:07.667
> 
> 标签：objective-c, xcode, uitableview

Hii 可以将 UILabel 添加到具有 UIButton 作为子视图的 UITableView 单元中。我的意思是这个 UILabel 必须作为 DetailLabel 添加到 UIButton 中，即在按钮标题下方？

前我的编码是

```
 UIButton *button=[[UIButton alloc]initWithFrame:CGRectMake(0, 0, 320, 44)];
    [button setImage:[UIImage imageNamed:@"launchpad.png"]forState:UIControlStateNormal];
    [button setTag:001];
    [button addTarget:self action:@selector(buttonPressed:)forControlEvents:UIControlEventTouchUpInside];
    [cell addSubview:button]; 
```

在标题文本下方，我希望标签作为子视图在运行时加载动态文本。

希望我解释清楚。请帮助我编写代码和添加 UILabel 的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:11:47.520

您可以将此标签添加到 UIButton 作为子视图：

```
UIButton *button=[[UIButton alloc]initWithFrame:CGRectMake(0, 0, 320, 44)];
[button setImage:[UIImage imageNamed:@"launchpad.png"]forState:UIControlStateNormal];
[button setTag:001];
[button addTarget:self action:@selector(buttonPressed:)forControlEvents:UIControlEventTouchUpInside];

UILabel *label=[[UILabel alloc]initWithFrame:CGRectMake(0,24, 320, 20)];
label.text = @"Some text"
[button addSubview:label];

[cell addSubview:button]; 
```

# messagebroker - 无法启动代理

> ID：12976471
> 
> 赞同：1
> 
> 时间：2012-10-19T14:33:16.987
> 
> 标签：messagebroker

我在 AIX 6.1 上安装了 Websphere 消息代理 8.0.0.0。当我尝试通过发出 mqsistart 命令启动代理时，我得到：

BIP8875W: 'NSPZPAI1' 的组件验证已完成，但一项或多项检查失败。一项或多项组件验证检查失败。检查错误日志以获取先前的错误消息。

为了诊断这一点，当我运行 mqsicvp 时，我得到以下描述：

BIP8873I: 正在启动组件“NSPZPAI1”的组件验证。BIP8876I：启动组件“NSPZPAI1”的环境验证。BIP8894I: 对“注册表”的验证已通过。BIP8892E: 验证失败。已安装的 Java 级别 'sh: java: not found。BIP8894I: 对“MQSI_FILEPATH”的验证已通过。BIP8877W: 组件“NSPZPAI1”的环境验证已完成，但一项或多项检查失败。BIP8882I: 正在启动组件“NSPZPAI1”的 WebSphere MQ 验证。BIP8886I: 对队列管理器“NSPZPAI1”上的队列“SYSTEM.BROKER.ADMIN.QUEUE”的验证已通过。BIP8886I: 对队列管理器“NSPZPAI1”上的队列“SYSTEM.BROKER.EXECUTIONGROUP.QUEUE”的验证已通过。BIP8886I: 队列“SYSTEM.BROKER”的验证已通过。队列管理器“NSPZPAI1”上的 EXECUTIONGROUP.REPLY。BIP8884I: 组件“NSPZPAI1”的 WebSphere MQ 验证已成功完成。BIP8875W: 'NSPZPAI1' 的组件验证已完成，但一项或多项检查失败。

有人可以告诉我如何解决“BIP8892E：验证失败。安装的Java级别'sh：java：未找到。” 错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-22T16:23:51.983

这条信息：

已安装的 Java 级别 'sh: java: not found

表示执行 mqsistart 时 Java 不在您的路径上。由于 mqsiprofile 脚本为您设置了 java，我怀疑您在运行 mqsistart 之前在此 shell 环境中运行配置文件脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T10:55:34.620

这似乎是您的 java 环境的问题。验证您的安装/java 版本并在 ibm.com 上打开 PMR（问题管理记录）。

# php - 检查来自哪个脚本需要

> ID：12976474
> 
> 赞同：0
> 
> 时间：2012-10-19T14:33:19.373
> 
> 标签：php

我有几个脚本，用于`require`相同的脚本（它是主要的配置脚本）。我可以以某种方式确定使用了哪个脚本`require`，并且取决于它从主文件加载特定配置吗？我认为它不能完成，但值得一试！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:35:48.343

好吧，您可以在`require`调用之前设置一些参数，然后读取它们以确定要加载的内容。

或者你可以使用`$_SERVER['PHP_SELF']`，但它是一个混乱的变量。

# c# - 如何通过事件处理程序传递发件人

> ID：12976475
> 
> 赞同：0
> 
> 时间：2012-10-19T14:33:20.530
> 
> 标签：c#, .net, wpf, events, xaml

我正在使用[http://wpfmdi.codeplex.com/](http://wpfmdi.codeplex.com/)库来处理我的 WPF 应用程序中的 MDI。

我有一个包含子容器的 Canvas，该子容器又包含许多小窗口。我想在其中一个小窗口关闭时执行一项操作，因此我尝试执行以下操作：

```
MdiChild child = new MdiChild();
child.Closing += new RoutedEventHandler(DatabaseTableWindow_Closing); 

private void DatabaseTableWindow_Closing(object sender, RoutedEventArgs e)
        {
            object s = e.Source;
        } 
```

而当窗口关闭时方法成功进入，`e.Source`为null。我也检查了`sender`and 那也是空的。我想要的只是一种找出哪个窗口触发了事件的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:37:37.300

如果`sender`是`null`，那么这听起来像是您正在使用的 MDI 框架中的疏忽/错误。既然你有源，你可以修复它：找到`Closing`引发事件的地方，并添加`this`为发件人。这应该为您提供`MdiChild`处理事件时的参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:45:06.520

您可能可以使用 LINQ 来规避该问题：

```
child.Closing += (o,e) => { DatabaseTableWindow_Closing(this, e); }; 
```

**编辑**：实际上在这种情况下你不应该使用“this”，而是“child”（它会指向你的 MdiChild）：

```
MdiChild child = new MdiChild();
child.Closing += (o,e) => { DatabaseTableWindow_Closing(child, e); }; 
```

# iis-7 - 空 request_query 字段，页面查询字词报告中没有记录

> ID：12976478
> 
> 赞同：0
> 
> 时间：2012-10-19T14:33:34.273
> 
> 标签：iis-7, sharepoint-2010, statistics, iis-7.5, urchin

我有一个问题，我找不到解决方案，即使在谷歌搜索数小时后也是如此。我在 SharePoint 2010 应用程序上安装了 IIS 7.5 和 Urchin 6。我有一个自定义通讯机制，它在消息中创建链接，如下所示：

```
http://somesite/newsletter/pages/newsletter17-20121018164411?NewsletterID=1&userLogin=USER&newslettersrc=http://site-to-redirect/site/pages/page.aspx 
```

（当用户输入 url 被重定向到 url 'newslettersrc'）

我想我可以通过分析“页面查询条款”报告来追踪点击时事通讯中的链接并打开网页的人数。但是对于名称为“newsletter”的页面，我在那里找不到任何结果。此外，当我使用 Urchin 表单进行 API 测试检查时，指定 request_stem 的字段 request_query 中的值为空。我还查看了 IIS 日志，发现 URL 正确分为 cs-uri-stem 和 cs-uri-query，如下：

*   cs-uri-stem:

    ```
    http://mysite/newsletter/pages/newsletter17-20121018164411 
    ```

*   cs-uri-查询：

    ```
    NewsletterID=1&userLogin=USER&newslettersrc=http://site-to-redirect/site/pages/page.aspx 
    ```

有什么问题？其他查询，一般是一些短变量和数值被正确存储，那么为什么来自时事通讯的查询没有存储在 urchin 数据库中？为什么，对于这个 request_stems request_queries 是空的？有没有人遇到过这样的问题？

先感谢您！

最好的问候，汤姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:38:37.807

对于那些将来会阅读这个问题的人 - 解决方案很简单 - 作为另一个 url 字符串中的参数的 URL 字符串需要被编码。完成此操作后，Urchin 将毫不费力地记录下来。

# jquery - 在 on() 内取消绑定点击；

> ID：12976480
> 
> 赞同：0
> 
> 时间：2012-10-19T14:33:37.097
> 
> 标签：jquery

我在取消绑定特定元素上的单击事件时遇到问题。这是我的 JS 代码。

```
 $(document).on('click','.likecomment', function(e){
        e.preventDefault();
        var commentid = $(this).data('commentid');
        $.ajax({
            type: 'POST',
            url: '?category=likecomment',
            data: {
                "commentid" : commentid
            },
            success: function(){
                $(this).unbind('click');
                var likes = $('#'+commentid+'-likes').text();
                likes++;
                $('#'+commentid+'-likes').html(likes);
            }
        });
    return false;
}); 
```

单击后，元素的功能将保持不变。第一次点击后如何防止它被点击？如果代码正确，我可能会自己找出问题，但我只想确保代码正确与否。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:36:36.347

使用匹配的 .off 语法。

```
$(document).off('click','.likecomment'); 
```

或使当前元素不再匹配`.likecomment`

```
$(this).removeClass("likecomment"); 
```

或者

```
$(this).removeClass("delegated");
// with this change to binding method:
$(document).on('click','.likecomment.delegated', function(e){ 
```

但是请记住，`this`成功调用的内部与`this`外部不同，您需要添加此 ajax 选项：`context: this,`以便`this`ajax 内部与 ajax 外部相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:36:01.203

这可能是因为您在成功处理程序中解除绑定。如果您的 ajax 调用需要一段时间，那么您的解除绑定也需要一段时间。所以在你的 $.ajax 尝试之后：

```
$(this).prop({disabled: true}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:41:20.340

因为您将事件委托给`document`对象，所以处理程序绑定在 上`document`，而不是每个单独的`.likecomment`元素上。

如果委托事件匹配多个元素，您不希望取消绑定该事件，并且您可能不希望删除`likecomment`该类，因为它可能与样式相关联。

相反，请使用在添加另一个类时强制不匹配的选择器。`done`本示例使用的是`finished`,`liked`或您喜欢的其他类名：

```
$(document).on('click', '.likecomment:not(.done)', function () {...}); 
```

当你想阻止元素引起点击事件时，将`done`类添加到元素中：

```
$(this).addClass('done'); 
```

添加新类还提供了一个钩子，用于更改 的样式`likecomment`，使其看起来不再可点击。

# vb.net - If Else 语句未正确触发

> ID：12976482
> 
> 赞同：1
> 
> 时间：2012-10-19T14:33:41.220
> 
> 标签：vb.net, visual-studio-2010, if-statement

好的，我正在阅读文本文件中的以下代码并在一行中搜索特定字符串。如果找到字符串，我不想做任何事情，如果没有找到，我想做其他事情。现在我对每个条件都有一个 msgbox。

我遇到的问题是，当找不到字符串时，它不会触发 msgbox。另一个 msgbox 会在找到字符串时触发。

有任何想法吗？

```
 Dim logfile() As String = System.IO.File.ReadAllLines("C:\Temp\Transfer_Log.txt")
    Dim searchstring As String = "Test_" + DateTimePicker2.Value.ToString("yyyyMMdd") + ".csv"

    For Each line As String In Filter(logfile, searchstring)
        If line.Contains("Test_" + DateTimePicker2.Value.ToString("yyyyMMdd") + ".csv") Then
            MsgBox("Do Nothing") 'THIS WORKS
        Else
            MsgBox("Append") 'THIS DOES NOT WORK
        End If
    Next 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:46:09.717

如果我正确地解释了您的代码，`Filter`则它是一个过滤功能，它正在返回与 text 匹配的所有行`"Test_" + DateTimePicker2.Value.ToString("yyyyMMdd") + ".csv"`。然后你遍历每一行并再次比较它以查看它是否匹配`"Test_" + DateTimePicker2.Value.ToString("yyyyMMdd") + ".csv"`。所以你的第二个消息框永远不会被调用。我会建议这个，

```
 IF Filter(logFile, searchstring).Count > 0 Then 
      MsgBox("Do Nothing")
 Else
      MsgBox("Append")
 EndIf 
```

根据问题，您想知道文件中是否存在字符串，这会告诉您是否存在。

# sql - SQL Server 在使用窗口函数并且谓词包含变量时使用扫描而不是查找

> ID：12976486
> 
> 赞同：7
> 
> 时间：2012-10-19T14:33:51.203
> 
> 标签：sql, sql-server, performance

看看这个小提琴：[http ://sqlfiddle.com/#!6/18324/2](http://sqlfiddle.com/#!6/18324/2)

展开第一个执行计划，用于针对 view 的查询`B`。
请注意，第一个查询使用索引查找执行，而第二个查询使用索引扫描。在我的实际设置中，有数千行，这会产生相当大的性能影响。

怎么回事？？？

查询是等效的，不是吗？为什么文字会产生搜索和变量扫描？
但更重要的是：**我该如何解决这个问题**？

[这篇文章](https://stackoverflow.com/questions/4459425/sql-server-query-fast-with-literal-but-slow-with-variable)最接近问题，并且从那里有效的解决方案是使用`option(recompile)`（谢谢你，马丁史密斯）。但是，这对我不起作用，因为我的查询是由我的 ORM 库（即实体框架）生成的，我无法手动修改它们。
相反，我正在寻找的是一种重新制定`B`视图的方法，这样问题就不会发生。

在摆弄这个问题时，我注意到丢失谓词的总是执行计划中的“段”块。为了验证这一点，我根据带有函数的子查询重新构造了查询`min`（参见视图`D`）。瞧！- 针对`D`视图的两个查询都会产生相同的计划。

然而，坏消息是我不能使用这个`min`-powered 技巧，因为在我的实际设置中，该列`Y`实际上是**几个 columns**，所以我可以按它们排序，但我不能接受`min()`它们。
所以第二个问题是：**任何人都可以想出一个类似于 min-powered 子查询但适用于多个列的技巧吗？**

**注意 1**：这绝对与临界点无关，因为表中只有 2 条记录。
**注意 2**：它也与视图的存在无关。查看一个带有 view 的示例`C`：在这种情况下，服务器很乐意使用 seek 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T16:12:29.197

可能这个会起作用

```
select a.X, a.Y from A a
    cross apply
        (select top 1 * from A t where t.X = a.X order by t.Y asc) as idx 
```

SQLFiddle [http://sqlfiddle.com/#!6/a3362/2](http://sqlfiddle.com/#!6/a3362/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:00:39.157

查询确实会产生相同的输出，但[在 sql 优化器看来，它们是不同的。](http://www.practicalsqldba.com/2012/06/how-local-variable-or-optimize-for.html)本文建议查看[OPTION 子句（不幸的是，在 SQL 2005 之前不包括在内）。](http://msdn.microsoft.com/en-us/library/ms190322.aspx)

您可以[在 Entity Framework 之上 Brew Your Own Query](http://blogs.u2u.be/diederik/post/2010/12/16/Some-Entity-Framework-40-Tips.aspx)，这可能是实现所需性能的最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T14:34:28.207

这是我自己的答案。

最终，我使用了-powered 技巧，通过将这些列转换为恒定长度的字符串表示形式（仔细调整以进行排序）并将这些字符串连接成一个字符串`min`，我绕过了实际上是几列的事实。`Y`完成后，我可以使用该连接字符串作为`min()`.

我仍然想知道这样做的正确方法。如果有人碰巧知道，我将不胜感激。

# c# - mvc4 动作链接图像

> ID：12976488
> 
> 赞同：9
> 
> 时间：2012-10-19T14:33:54.147
> 
> 标签：c#, asp.net-mvc-4

我正在尝试为 ASP.NET MVC4 Web 应用程序替换 _Layout.cshtml 中臭名昭著的“您的徽标”。以下作品（显示图像中的作品）适用于主页（主页视图），但不适用于联系人视图（无图像，但操作有效）。我需要它在开发环境和生产环境中工作。

```
< p class="site-title">@Html.ActionLink(" ", "Index", "Home", new
  {
  style = "background: url('./Images/login_sm.bmp') no-repeat center right;
          display:block; height:84px; width:264px;"
  })
</ p> 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-19T15:34:26.700

图像总是相对于当前 CSS 的位置。

如果你使用内联 CSS，你应该使用 url helpers：

```
@Html.ActionLink(
    " ", 
    "Index", 
    "Home", 
    null , 
    new { 
        style = "background: url('" + Url.Content("~/images/login_sm.bmp") + "') no-repeat center right; display:block; height:84px; width:264px;" 
    }
) 
```

或者如果您决定定义一个 CSS 类：

```
@Html.ActionLink(
    " ", 
    "Index", 
    "Home",  
    null , 
    new { 
        @class = "mylink" 
    }
) 
```

您在以下位置定义了`.mylink`规则`~/content/Site.css`：

```
.mylink {
    background: url('../images/login_sm.bmp') no-repeat center right; 
    display: block; 
    height: 84px; 
    width: 264px;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-10-17T11:13:44.470

您可以执行以下操作的最佳方法

```
@Html.Raw(@Html.ActionLink("[replacetext]", "Index", "Home").ToHtmlString().Replace("[replacetext]", "<img src=\"/assets/img/logo.png\" ... />")) 
```

完美的工作

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-29T07:13:46.497

你可以用这个

```
<a href='@Url.Action("action", "Controller")'>
<img src='@Url.Content("~/images/imageName.png")' /></a> 
```

这工作正常，它的工作原理类似于`@Html.ActionLink("linkName","action","Controller")`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-23T11:39:37.397

我稍微编辑了 Dilip0165 解决方案

```
@Html.Raw(@Html.ActionLink("[replacetext]", "Index", "Home").ToHtmlString().Replace("[replacetext]", "<img src=\"" + @Url.Content("~/Content/assets/img/logo.png") + "\" alt=\"Link description\" title=\"Link description\" />")) 
```

如果您希望它没有默认边框，请将其添加到您的 css

```
img {border: 0px;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-23T15:27:16.297

我发现当需要高级别的`<a>`标签定制（例如锚内的其他标签）时，最好自己做。

我使用 UrlHelper.GenerateUrl 方法生成 URL，然后我手动创建`<a>`标签并使用生成的 URL。

# javascript - 使用 Angular JS 和脚本加载器 Modernizr

> ID：12976489
> 
> 赞同：2
> 
> 时间：2012-10-19T14:33:54.997
> 
> 标签：javascript, jquery, angularjs, modernizr, yepnope

我的应用程序以前大量使用 Modernizr 来加载脚本和 shim，我在加载 Angular JS 时遇到了一段时间的问题。在 JQuery 之后立即使用 Modernizr 加载会产生错误；没有模块：（模块名称）；

但是，当我在脚本加载之前将 JQuery 和 Angular 移到顶部时，使用 JQuery（内部角度控制器脚本）的行将失败，尽管它已在角度脚本之前加载。我正在使用下面的脚本在加载modernizr 后延迟内联脚本，它将在modenizr 完成加载所有脚本后执行。当我评论关闭脚本加载行时，一切都很好，但当前页面上的内联脚本将失败。

```
docready=[],$=function(){return{ready:function(fn){docready.push(fn)}}}, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-20T07:40:57.293

我通过创建一个简单的延迟函数将其推送到数组来解决这个问题。

```
var _a = {ready: function(fn){ _as.push(fn);}} 
```

将正常的 $(document).ready 替换为以下语法。

```
_a.ready(function(){ 
```

然后在modernizr完成加载所有需要的JS之后调用这个函数。

```
for(n in _as) _as[n](); 
```

就这样。

# c# - 更新后刷新gridview

> ID：12976491
> 
> 赞同：0
> 
> 时间：2012-10-19T14:34:16.220
> 
> 标签：c#, asp.net

我在更新后尝试刷新我的 gridview 时遇到问题。数据库获取更新，当我手动刷新页面时我可以在那里看到它们，但当我单击更新链接提交更改时看不到它们。

我试图调用填充网格的函数，我收到一个 js 错误“Microsoft JScript 运行时错误：无法获取属性‘firstChild’的值：对象为空或未定义”。它运行该方法并且在退出之前不会抛出该错误。

更新后我可以采取另一种方法来刷新我的网格吗？

这是代码：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            BindCustodiansByProjectID();
            BindCustodianMedia(EditMediaClass.outRequestMediaID);
        }
    }

        private void BindCustodianMedia(string MediaID)
    {
        DataTable dt = new DataTable();
        SqlConnection conn = new SqlConnection(GetConnString());
        DataSet ds = new DataSet();
        try
        {
            conn.Open();
            SqlCommand cmd = new SqlCommand("usps_displayEditMedia_CustodianMedia", conn);
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Parameters.Add(new SqlParameter("@aspMediaID", SqlDbType.Int)).Value = int.Parse(MediaID);
            cmd.ExecuteNonQuery();

            SqlDataAdapter da = new SqlDataAdapter(cmd);

            da.Fill(ds);

            grd_custodianMedia.DataSource = ds;
            grd_custodianMedia.DataBind();
        }

        protected void updateCustodianMedia_OnUpdateCommand(object sender, GridRecordEventArgs e)
    {
        SqlConnection conn = new SqlConnection(GetConnString());
        conn.Open();
        try
        {
            SqlCommand cmd = new SqlCommand("usps_updateCustodianMedia_EditMedia", conn);
            cmd.CommandType = CommandType.StoredProcedure;

            cmd.Parameters.Add(new SqlParameter("@aspCustodianMediaID", SqlDbType.Int)).Value = int.Parse(e.Record["CustodianMediaID"].ToString());
            cmd.Parameters.Add(new SqlParameter("@aspMediaID", SqlDbType.Int)).Value = int.Parse(EditMediaClass.outRequestMediaID.ToString());
            cmd.Parameters.Add(new SqlParameter("@aspCustodianID", SqlDbType.Int)).Value = int.Parse(e.Record["CustodianID"].ToString());
            cmd.Parameters.Add(new SqlParameter("@aspUploadPath", SqlDbType.VarChar)).Value = e.Record["UploadPath"];
            cmd.Parameters.Add(new SqlParameter("@aspDataSize", SqlDbType.VarChar)).Value = e.Record["DataSize"];
            cmd.Parameters.Add(new SqlParameter("@aspDataDesc", SqlDbType.VarChar)).Value = e.Record["DataDescription"];

            cmd.ExecuteNonQuery();
            //BindCustodianMedia(EditMediaClass.outRequestMediaID);    

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:59:53.860

对于 Javascript 错误，请尝试使用`Firebug`IE 开发人员工具进行调试，并准确找出导致问题的行。您正在尝试从为空的对象访问属性“firstchild”。有了这些信息，很难判断哪个可能是确切的问题。

# c# - c# 使用 For 循环列出添加项目

> ID：12976492
> 
> 赞同：0
> 
> 时间：2012-10-19T14:34:16.727
> 
> 标签：c#, mongodb, mongodb-.net-driver

我在使用 c# 列表时遇到问题，不确定在向 Managepagesid 列表添加新对象时我错过了重点！

```
 public class Clients
    {
        [BsonId]
        public string Id { get; set; } //Object ID managed by MongoDb

        public string Name { get; set; } //Client Name

        public string Phone { get; set; } //Client Phone

        public string Email { get; set; } //Client E-mail

        public string Username { get; set; } //Client Username

        public DateTime LastModified { get; set; } //Client Last Login

        public string FB_User_Id { get; set; } //Client FB User ID

        public AccessToken UserAccessToken { get; set; } //AccessToken which is stored while user is logged in.

        public List<ManagePages> Manage_Pages_id { get; set; } //The pages maintained by the specific client
     } 
```

* * *

我正在尝试访问将新项目添加到 ManagePage_id 列表中，但它会引发一些空异常..帮助！

```
Clients client = new Clients();

            client.FB_User_Id = FBData.id;
            client.Name = FBData.name;
            client.Email = FBData.email;
            client.Username = FBData.username;

            for (int index = 0; index < FBData.accounts["data"].Count; index++)
            {
                ManagePages pagedetails = new ManagePages()
                {
                    page_id = FBData.accounts["data"][index].id,
                    page_name = FBData.accounts["data"][index].name,
                    ManagePages_AccessTokens = new AccessToken()
                    {
                        AccessToken_accessToken = FBData.accounts["data"][index].access_token,
                        AccessToken_expiryDate = DateTime.Now
                    },
                    ManagePages_category = FBData.accounts["data"][index].category
                };

                var category = pagedetails.ManagePages_category;

                client.Manage_Pages_id.Add(pagedetails);
            } 
```

添加了堆栈跟踪！

Exception>System.NullReferenceExceptionObject 引用未设置为对象的实例。在 G:\Development\Vega_MongoDB\Vega_MongoDB\FBDataAccess\ClientFBRepository.cs 中的 Vega_MongoDB.FBDataAccess.ClientFBRepository.ClientsData(String accessToken) 处：G:\Development\Vega_MongoDB 中 Vega_MongoDB.Models.ClientRepository..ctor(String connection) 的第 48 行\Vega_MongoDB\Models\Clients\ClientRepository.cs：G:\Development\Vega_MongoDB\Vega_MongoDB\Models\Clients\ClientRepository.cs 中 Vega_MongoDB.Models.ClientRepository..ctor() 的第 47 行：Vega_MongoDB.Controllers.ClientsController 的第 23 行..cctor() 在 g:\Development\Vega_MongoDB\Vega_MongoDB\Controllers\ClientsController.cs:line 18

我检查了 pagedetails 对象，它包含所有数据..

谢谢

毗湿奴

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:37:08.347

您应该在添加项目之前创建列表的实例：

```
client.Manage_Pages_id = new List<ManagePages>();
for (int index = 0; index < FBData.accounts["data"].Count; index++)
{
    ManagePages pagedetails = new ManagePages()
    {
        page_id = FBData.accounts["data"][index].id,
        page_name = FBData.accounts["data"][index].name,
        ManagePages_AccessTokens = new AccessToken()
        {
            AccessToken_accessToken = FBData.accounts["data"][index].access_token,
            AccessToken_expiryDate = DateTime.Now
        },
        ManagePages_category = FBData.accounts["data"][index].category
    };

    var category = pagedetails.ManagePages_category;

    client.Manage_Pages_id.Add(pagedetails);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:38:45.467

尝试将此添加到您的课程中：

```
public Clients()
{
  this.Manage_Pages_id = new List<ManagePages>();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:39:21.547

您需要在添加任何内容之前初始化您的列表。您可以在`Clients`类的构造函数或调用代码中执行此操作（如 Artem 建议的那样）。

```
public class Clients
{
    //properties

    public Clients()
    {
         Manage_Pages_id = new List<ManagePages>();
    }
} 
```

# html - 为什么我的父 Div 容器中的 2 个 Div 没有彼此对齐？

> ID：12976500
> 
> 赞同：1
> 
> 时间：2012-10-19T14:34:35.177
> 
> 标签：html, css

我已经尝试了各种各样的方法来尝试让它工作，我对 html 标记有点过时了，所以请原谅我，但我相信我的问题很容易解决。我有 2 个 div（1 个图像**徽标**和 1 个闪光对象**火焰**) 我想在一个容器 div 中居中，我希望以任何浏览器屏幕分辨率为中心。我还希望水平滚动条仅在浏览器窗口宽度低于 800px 时出现，因此容器 div 上的 min-width:800px （这工作正常）。我的孩子 div 不断出现在彼此的上方和下方，当我将它们设置为绝对定位时，它们只会出现在彼此顶部的左侧.....我只希望所有内容都居中对齐，并且两个 div 都位于屏幕顶部，有人可以帮助并指出我正确的方向。

谢谢安迪

```
.container {
margin-left: 0 auto;
margin-right: 0 auto;
min-width:800px;
width: 100%;
height: 500px;
background-color:#F00;
}
.logo {
margin: 0 auto;
position:absolute;
vertical-align:top;
display:inline-block;
width:1059px;
height:136px;   
}
.flame {
margin: 0 auto;
vertical-align:top;
position:absolute;
display:inline-block;
width:861px;
height:134px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T18:49:04.763

HTML：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<style type="text/css">
.container {
margin:auto;
width:800px;
height: 500px;
background-color:#F00;
}
.logo {
margin:auto;
float:left;
width:450px;
height:136px;   
background-color:#096;
}
.flame {

margin:auto;
float:left;
width:350px;
height:134px;
background-color:#099;
}
</style>
</head>

<body>

    <div class="container">
        <div class="logo">LOGO GOES HERE</div>
        <div class="flame">FLASH CONTENT GOES HERE</div>
    </div>
</body>
</html> 
```

使用浮动，您可以使您的 div 彼此相邻堆叠。但是div的宽度之和必须小于等于容器的宽度，否则第二个div会出现在第一个div的下方。您的容器也将始终以浏览器为中心。此外，如果浏览器的宽度低于 800px（容器的宽度），则会出现水平滚动条。最后一件事，如果浮动元素的宽度总和小于容器的宽度，则此代码使容器居中，但不会使您的 div 居中。您也可以通过此[链接](http://dev.opera.com/articles/view/35-floats-and-clearing/#centeringfloats)了解如何执行此操作。

编辑：或者，如果您知道徽标和 Flash 横幅的宽度之和，我认为您知道，您可以创建一个宽度等于总和的 div 并对其应用 margin:auto 属性。涉及使用额外的 div 和有关徽标和 Flash 横幅宽度的先验知识，但我认为这将适合您的目的。希望这可以帮助。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:40:02.610

**最终版本**

总结一下 - 任务基本上是这样的：

*   有两个宽度不同的元素在一行中并排对齐
*   该行应始终作为标题居中
*   只有当屏幕小于 800px 时才会出现水平滚动条
*   不可见的边缘在左侧和右侧被修剪

**这是一个可能的解决方案：**

[在 jsfillde.net 上购买前先试用](http://jsfiddle.net/zLWbd/)

还有一点解释：

**HTML 标记**

```
<div class="wrapper">
    <div class="center">
        <img src="" alt="">
        <object></object>    
    </div>
</div> 
```

**CSS**

```
body, html {
    width: 100%;
    min-width: 800px;
    height: 100%;
    margin: 0;
    padding: 0;
}

div.wrapper {
    width: 100%;
    height: 134px;
    overflow: hidden;
}

div.center {
    position: relative;
    margin:0 auto;
    width: 800px;
    height: 100%;
}

div.center > img {
    position: absolute;
    top: 0;
    left: -499px;
}

div.center > object {
    position: absolute;
    top: 0;
    left: 560px;
} 
```

**关于“如何运作”**

第一个 div`wrapper`跨越从左侧到右侧的区域。这是始终可见的空间。切断我`overflow: hidden;`在该元素上使用的边缘。因此，所有突出的东西都将是隐形的。

第二个 div`center`使用 . 放置在视口的中间`margin: 0 auto`。它有一个固定的宽度。我使用`800px`是因为这是问题中所需的最小宽度。它也适用于任何其他范围。

现在是时候对齐两个标题元素了。两者都有固定的宽度。在这种情况下，图像是*1059px*，对象是*861px*，总共是**1920px**。这些元素的中间在*960px*处会很明显。我们的容器`center`实际上是*400px*，因为页面的最小宽度是*800px*。所以这两个元素的实际交汇点在这个容器内的*560px*处，因为我们有一个*160px*的移位。所以对于对象来说很简单：简单的 set `left: 560px;`。但是必须放置左容器，它在这一点上结束。我们有一个 1059px 的宽度*并从 560px**中*减去它*并得到 的最终值`left: -499px;`。*

 *由于中间的容器居中，因此两个元素也将居中。并且由于`wrapper`' 的溢出被隐藏，两个边缘都将在视口的末端被切断。没有任何可见的滚动条。

最后，只剩下一件事：`min-width:800px`在`<body>`-tag 上设置，以便滚动条在窗口小于*800px*时立即可见。

**第一个答案**

`position: absolute`将元素从父母流中取出，除非您`position`明确设置父母：

```
.container {
    position: relative;
} 
```

这应该可以解决问题，但它没有使用您的标记对其进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:42:20.840

```
.container {
margin-left: 0 auto;
margin-right: 0 auto;
min-width:800px;
width: 100%;
height: 500px;
background-color:#F00;
**position:relative;**
}

@media only screen and (max-width: 800px){
html{
  overflow: auto;
  overflow-y: hidden;
}
} 
```*

# java - 速度 - 调用 init() 时的 NPE

> ID：12976501
> 
> 赞同：0
> 
> 时间：2012-10-19T14:34:36.743
> 
> 标签：java, velocity

我使用 Velocity 已经有一段时间了，从来没有遇到过问题。但是，最近，我遇到了一个问题。

我正在使用速度生成 HTML 代码并将生成的 HTML 作为电子邮件发送。这个过程有 50% 的时间有效。当它失败时，我收到此错误：

```
Caused by: java.lang.NullPointerException
        at java.io.Reader.<init>(Reader.java:61)
        at java.io.InputStreamReader.<init>(InputStreamReader.java:80)
        at org.apache.commons.collections.ExtendedProperties.load(ExtendedProperties.java:542)
        at org.apache.commons.collections.ExtendedProperties.load(ExtendedProperties.java:519)
        at org.apache.velocity.runtime.RuntimeInstance.setDefaultProperties(RuntimeInstance.java:397)
        at org.apache.velocity.runtime.RuntimeInstance.initializeProperties(RuntimeInstance.java:570)
        at org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:250)
        at org.apache.velocity.runtime.RuntimeInstance.init(RuntimeInstance.java:590)
        at org.apache.velocity.app.VelocityEngine.init(VelocityEngine.java:136)
        at testapp.webapp.utility.velocity.VelocitySettings.<init>(VelocitySettings.java:48)
        ... 26 more 
```

我的代码如下：

```
VelocityEngine ve = null;
try
{
Properties props = new Properties();
props.put("resource.loader", "file");
props.put("file.resource.loader.class", "org.apache.velocity.runtime.resource.loader.FileResourceLoader");
props.put("file.resource.loader.path", Settings.getVelocityTemplatesPath());
props.put("file.resource.loader.cache", "true");
props.put("runtime.log.logsystem.class","org.apache.velocity.runtime.log.NullLogSystem");

ve = new VelocityEngine();
ve.init(props); //THE ERROR IS TAKING PLACE HERE
}
catch (Exception e)
{
  throw new Exception ("Error while instantiating the velocity engine", e);
} 
```

我仍然无法解释为什么它会随机发生。我对此进行了一些研究，但还没有找到任何线索。外面有人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T10:39:50.600

看来我可能已经解决了这个问题。

不幸的是，在上面的问题陈述中，我忘了提到一个非常重要的细节。上面的代码被多次执行。我有 10 或 100 个石英作业正在运行，每个作业最终都会执行上面的代码。这意味着，每个触发的作业都将重新初始化 VelocityEngine。为什么这种行为导致上述错误仍然超出我的范围。为了克服这个问题，上面的代码驻留在一个普通的 JAVA 类中。我必须将该类转换为 Singleton，以便 VelcoityEngine 的启动始终完成一次。在这些更改之后，错误停止了流式传输。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-12T10:32:17.537

我遇到了同样的问题。在我的情况下，根本原因是测试机器上无效的詹金斯缓存。删除它后，速度再次开始工作。

# objective-c - 以编程方式发现 .DMG 的名称

> ID：12976503
> 
> 赞同：0
> 
> 时间：2012-10-19T14:34:42.623
> 
> 标签：objective-c

说我有一个 .DMG 我点击它打开它里面有一个应用程序。我运行应用程序（我开发的）

可执行文件是否有一种编程方式来找出它在运行时运行的 .DMG 的名称（如果有）？也许是一个“获取完整路径”，其中将包含该 DMG 的名称？该 .DMG 名称上可能存在某些关键字，如果存在，我需要对它们采取行动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:36:44.050

```
[[NSBundle mainBundle] bundlePath]; //Or Bundle URL, depends if you prefer NSString or NSURL. 
```

# c# - 暴露给 VBA (COM) 的 C# 属性：运行时错误“424”：需要对象

> ID：12976506
> 
> 赞同：2
> 
> 时间：2012-10-19T14:34:49.220
> 
> 标签：c#, .net, vba, com, interop

此 C# 代码位于 .NET 4.5`ComVisible`程序集中：

# C# 代码

```
[InterfaceType(ComInterfaceType.InterfaceIsDual)]
[Guid("22341123-9264-12AB-C1A4-B4F112014C31")]
public interface IComExposed
{
    double[] DoubleArray { get; set; }
    object[] ObjectArray { get; set; }
    object PlainObject { get; set; }
    double ScalarDouble { get; set; }
}

[ClassInterface(ClassInterfaceType.None)]
[Guid("E4F27EA4-1932-2186-1234-111CF2722C42")]
[ProgId("ComExposed")]
public class ComExposed : IComExposed
{
    public double[] DoubleArray { get; set; }
    public object[] ObjectArray { get; set; }
    public object PlainObject { get; set; }
    public double ScalarDouble { get; set; }
} 
```

从 Excel 2010 32bit VBA，我有以下行为：

# VBA 代码

```
Dim VBArray(1 To 3) As Double
VBArray(1) = 1
VBArray(2) = 2
VBArray(3) = 3

Dim oComExposedEarlyBinding As New ComExposed

' Works
oComExposedEarlyBinding.ScalarDouble = 5

' Compile Error: Function or interface marked as restricted,
' or the function uses an Automation type not supported in Visual Basic
oComExposedEarlyBinding.DoubleArray = VBArray

' Compile Error: Function or interface marked as restricted,
' or the function uses an Automation type not supported in Visual Basic
oComExposedEarlyBinding.ObjectArray = VBArray

' Run-time error '424': Object required
oComExposedEarlyBinding.PlainObject = VBArray

' Run-time error '424': Object required
oComExposedEarlyBinding.PlainObject = 5

Dim oComExposedLateBinding As Variant
Set oComExposedLateBinding = New ComExposed

' Works
oComExposedLateBinding.ScalarDouble = 5

' Run-time error '5': Invalid procedure call or argument
oComExposedLateBinding.DoubleArray = VBArray

' Run-time error '13':  Type mismatch
oComExposedLateBinding.ObjectArray = VBArray

' Works
oComExposedLateBinding.PlainObject = VBArray

' Works
oComExposedLateBinding.PlainObject = 5 
```

正如您已经注意到的那样，`PlainObject`它在后期绑定模式下工作，但显然是以丢失输入为代价的，因此在 VBA 中丢失了自动完成（智能感知），这在我的场景中是不可接受的。

我在示例中关心的行是以下行：

```
oComExposedEarlyBinding.DoubleArray = VBArray
oComExposedEarlyBinding.ObjectArray = VBArray
oComExposedEarlyBinding.PlainObject = VBArray 
```

让上述三行中的任何一行都可以满足我的需求，那么您是否有任何解决方法或解决方案可以使这项工作（请注意，我对将数组作为参数传递给函数不感兴趣）？

**更新：** 将此问题提交给 Microsoft 的支持并等待近三周后。他们确认这是一个错误，这是 KB： http: [//support.microsoft.com/kb/327084，C#](http://support.microsoft.com/kb/327084)中唯一的解决方法是标记为下面的解决方案。但是，如果用 C++/CLI 编写，我可以确认此代码可以按预期工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:46:02.697

VBA 数组必须从零开始，并且在 c# 中使用 ref 参数，示例：

```
Option Explicit

Sub test()
    Dim VBArray(0 To 2) As Double
    VBArray(0) = 1
    VBArray(1) = 2
    VBArray(2) = 3

    Dim oComExposedEarlyBinding As New ComExposed
    oComExposedEarlyBinding.SetDoubleArray VBArray

End Sub 
```

* * *

```
using System.Runtime.InteropServices;

namespace COMVisibleTest
{
    [InterfaceType(ComInterfaceType.InterfaceIsDual)]
    [Guid("22341123-9264-12AB-C1A4-B4F112014C31")]
    public interface IComExposed
    {
        void SetDoubleArray(ref double[] doubleArray);
    }

    [ClassInterface(ClassInterfaceType.None)]
    [Guid("E4F27EA4-1932-2186-1234-111CF2722C42")]
    [ProgId("ComExposed")]
    public class ComExposed : IComExposed
    {
        private double[] _doubleArray;

        public void SetDoubleArray(ref double[] doubleArray)
        {
            _doubleArray = doubleArray;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:55:15.487

VBA 总是通过引用（VT_VARIANT | VT_BYREF）传递包含在变体中的数组，其中包含实际数组的另一个变体，因此在指定元素类型时不能在属性中使用数组，您需要使用一种方法，以便您可以指定参数为“通过引用”。

```
[InterfaceType(ComInterfaceType.InterfaceIsIDispatch)] 
[Guid("22341123-9264-12AB-C1A4-B4F112014C31")] 
public interface IComExposed
{ 
     void setDoubleArray(ref double[] myArray); 
     //(...) 
} 
```

一个类似的问题：
[Pass an array from vba to c# using com-interop](https://stackoverflow.com/questions/2027758/pass-an-array-from-vba-to-c-sharp-using-com-interop)

该问题的答案提到了使用用户定义的集合而不是原始类型数组的选项，也许这也可以解决您的问题。

文档中的相关参考：

[编组 ByRef 变体](http://msdn.microsoft.com/en-us/library/2x07fbw8(v=vs.71).aspx#cpcondefaultmarshalingforobjectsanchor6)

[WinAPI 中的 VARIANT 和 VARIANTARG](http://msdn.microsoft.com/en-us/library/aa908601.aspx#remarks)

[.Net 中的 MarshalAsAttribute 类](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)

[在 .Net 中将数组传递给 COM](http://msdn.microsoft.com/en-us/library/z6cfh6e6%28v=vs.71%29.aspx#cpcondefaultmarshalingforarraysanchor4)

# mvcsitemapprovider - mvc 站点地图提供程序：菜单消失

> ID：12976517
> 
> 赞同：2
> 
> 时间：2012-10-19T14:35:32.033
> 
> 标签：mvcsitemapprovider

我正在使用 mvcsitemap 为我正在开发的 web 应用程序创建菜单、子菜单和面包屑。我在 xml 配置中使用 preserveroutevalues 以便在呈现链接时移动我的（许多）参数。当用户开始使用查询参数时，菜单/子菜单/面包屑会在某些页面加载后消失。这并不一致，我不能一直重现它，但它发生得太频繁了。

我的路线

```
routes.MapRoute(
                    name: "ForwardCurveDefault",
                    url: "forward-curve/{commoditycode}/{selectedyear}-{selectedmonth}-{selectedday}",
                    defaults: new {
                        controller = "ForwardCurve", action = "index",
                        selectedyear = default(DateTime).Year,
                        selectedmonth = default(DateTime).Month,
                        selectedday = default(DateTime).Day,
                        commoditycode = "none"
                    }
                );
routes.MapRoute(
                    name: "Consumption",
                    url: "consumption/{commoditycode}/{managedcompanyid}/{entityid}/{startyear}-{startmonth}-{startday}/{endyear}-{endmonth}-{endday}",
                    defaults: new {
                        controller = "Consumption", action = "Index",
                        // begining of current month.
                        startyear = default(DateTime).Year,
                        startmonth = default(DateTime).Month,
                        startday = default(DateTime).Day,
                        // end of current month.
                        endyear = default(DateTime).Year,
                        endmonth = default(DateTime).Month,
                        endday = default(DateTime).Day,
                        commoditycode = "none",
                        managedcompanyid = 0,
                        entityid = 0,
                    }
                );

 routes.MapRoute(
                    name: "Budget",
                    url: "budget/{commoditycode}/{managedcompanyid}/{entityid}/{startyear}-{startmonth}-{startday}/{endyear}-{endmonth}-{endday}",
                    defaults: new {
                        controller = "Budget", action = "Index",
                        // begining of current month.
                        startyear = default(DateTime).Year,
                        startmonth = default(DateTime).Month,
                        startday = default(DateTime).Day,
                        // end of current month.
                        endyear = default(DateTime).Year,
                        endmonth = default(DateTime).Month,
                        endday = default(DateTime).Day,
                        commoditycode = "none",
                        managedcompanyid = 0,
                        entityid = 0,
                    }
                ); 
```

我的站点地图

```
<mvcSiteMapNode title="Data Management" controller="ForwardCurve" action="Index" key="DataManagement" preservedRouteParameters="commoditycode,selectedyear,selectedmonth,selectedday">
  <mvcSiteMapNode title="Forward curves" controller="ForwardCurve" action="Index" key="forwardcurve" preservedRouteParameters="commoditycode,selectedyear,selectedmonth,selectedday"/>
  <mvcSiteMapNode title="Consumption" controller="Consumption" action="Index" key="consumption" preservedRouteParameters="commoditycode,managedcompanyid,entityid,startyear,startmonth,startday,endyear,endmonth,endday"/>
  <mvcSiteMapNode title="Budget" controller="Budget" action="Index" key="budget" preservedRouteParameters="commoditycode,managedcompanyid,entityid,startyear,startmonth,startday,endyear,endmonth,endday"/>
</mvcSiteMapNode> 
```

我得到了一份不错的菜单。在来回访问不同的查询值之后，我最终进入了一个具有有效 URL 且没有菜单的页面。我可以看到我的 currentNode 为空。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T14:54:14.743

你用[4.0 版](http://www.nuget.org/packages?q=mvcsitemapprovider&prerelease=&sortOrder=package-download-count)检查过吗？节点匹配逻辑有了一些重大改进。

# php - 调用 php 函数并在按钮单击时重定向

> ID：12976519
> 
> 赞同：0
> 
> 时间：2012-10-19T14:35:33.523
> 
> 标签：php, javascript, onclick

我有一个 php 函数，其中正在创建一些 pdf。我有一个按钮，我想在单击按钮时调用该函数，然后重定向到一个 url。最简单的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:37:38.177

如果您需要调用 PHP 方法，我会使用 AJAX。像这样的东西：

```
var btn = document.getElementById("button_id");

btn.onclick = function () {
    // Make AJAX request
    // On success, do this:
    window.location.href = "url to redirect to";
}; 
```

“发出 AJAX 请求”的代码可以很容易地用谷歌搜索，我会在一分钟内提供它:)

更新：

```
function ajaxFunction() {
    var ajaxRequest; // The variable that makes Ajax possible!

    try {
        // Firefox, Chrome, Opera 8.0+, Safari
        ajaxRequest = new XMLHttpRequest();
    } catch (e) {
        // Internet Explorer Browsers
        try {
            ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
        } catch (e) {
            try {
                ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
            } catch (e) {
                try {
                    ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP.6.0");
                } catch (e) {
                    try {
                        ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP.3.0");
                    } catch (e) {
                        throw new Error("This browser does not support XMLHttpRequest.");
                    }
                }
            }
        }
    }
    return ajaxRequest;
} 
```

AJAX 代码 -

```
var req = ajaxFunction();
req.onreadystatechange = function (response) {
    if (response.status == 200 && response.readyState == 4) {
        window.location.href = "url to redirect to";
    }
}
req.open("POST", "your PHP file's URL", true);
req.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
req.send(null);    // Or send any `key=value&` pairs as a string 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:49:00.680

有多种方法可以做到这一点。我会在 ajax 中调用 PHP 函数并根据函数返回值进行重定向。以下示例使用 jQuery：

jQuery：

```
$.ajax({
  url: 'createpdf.php',
  success: function(data) {
    if (data) window.location = 'link/to/new/path'; 
  }
}); 
```

PHP：

```
function create_pdf(){
    //Create PDF
    //If PDF was created successfully, return true
    return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:40:16.910

```
<form name="input" action="whatever.php" method="get">
...
<input type="submit" value="Submit">
</form> 
```

# intellij-idea - 如何在 IntelliJ IDEA 中从 CoffeeScript 生成 JavaScript 文件？

> ID：12976522
> 
> 赞同：2
> 
> 时间：2012-10-19T14:35:45.380
> 
> 标签：intellij-idea, coffeescript

我正在 IntelliJ 中尝试 CoffeeScript 支持，虽然突出显示/完成/重构支持看起来很棒，但我无法想出一种方法来自动将我的 .coffee 文件编译为它们的 .js 对应文件以便在网页中使用它们, 单元测试等

文档提到为此目的使用 Node，但我主要对编写客户端代码感兴趣。我可能能够创建一个运行配置，使用 Cake 创建我的 JS 文件，但这不会与 IDEA 的集成单元测试支持等很好地集成。

那么……有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-06T17:10:39.223

使用 IntelliJ IDEA 插件：[File Watchers](http://plugins.jetbrains.com/plugin?pr=idea&pluginId=7177)。

您需要在全局目录中安装 coffee-script 包。( `npm install -g coffee-script`)。

在 IntelliJ 编辑器中编辑 CoffeeScript 文件时，顶部会显示一条通知。

![通知](../Images/6726a8e5deb8ae9b8f009b6fc3e5d692.png)

单击“添加观察程序”，IDE 将即时为您编译代码。

可以通过`Project Settings`/访问更高级的选项`File Watchers`。

另见[官方文档](http://www.jetbrains.com/idea/webhelp/transpiling-coffeescript-to-javascript.html#d96136e7112)。

# asp.net - Gridview 保留宽度，不管 Asp.net

> ID：12976532
> 
> 赞同：0
> 
> 时间：2012-10-19T14:36:35.400
> 
> 标签：asp.net, vb.net, gridview, column-width

我有一个gridview，无论它显示什么数据，我都想保留它的宽度。例如，如果有一个长度为 900 的单词（例如 abbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb）我希望 gridview 在新行中显示而不是加宽其宽度（girdview 宽度为 700）。例如，像 stackoverfolw 一样，它很好地显示了我的示例词。这个文本框没有超出它应该的范围，不是吗？

我当前的代码无法完成这项工作。谢谢。有什么帮助吗？

我的代码。

```
 <asp:GridView ID="gv" runat="server" CssClass="gv" AutoGenerateColumns="False" Width="700px">
    <Columns>
        <asp:BoundField DataField="" HeaderText="" 
            dataformatstring="{0:dd-MM-yyyy}" HtmlEncode="false" SortExpression="" >
    <ControlStyle Width="100" />
    <HeaderStyle Width="100" />
    <ItemStyle Width="100" />
    </asp:BoundField>

    .gv th
    {
        width: 100px;   
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:42:40.000

以像素而不是百分比给出包含网格的 div 的宽度

```
<div id="divGrid" style='position:absolute; width:800px;'>

<!-- your grid here -->

</div> 
```

此外，您可以以像素为单位获取屏幕宽度并以百分比计算像素。假设屏幕宽度为 1000 像素，由 screen.width 返回，那么您的 90% 将是 900 像素。

在 javascript 中：

```
<script language="javascript" type="text/javascript">
   document.getElementById('divGrid').style.width = screen.width + "px";
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:37:30.490

这对我有用

```
.my-text
{
    float:left;
    overflow-y:auto;
    overflow-x:auto;
    word-break:break-all;
} 
```

在您的模板字段中

```
 <asp:TemplateField>
 <ItemTemplate>
     <asp:Label ID="Label1" runat="server" CssClass="my-text"
                Text='<%# Bind("YourColumnName")' 
                ></asp:Label>

 </ItemTemplate>
</asp:TemplateField> 
```

![样本](../Images/92ff70796ec99ddb8de15c7b4563a46f.png)

# data-structures - 找到合适的数据结构 c++

> ID：12976535
> 
> 赞同：7
> 
> 时间：2012-10-19T14:36:41.607
> 
> 标签：data-structures

我正在寻找一些简单的实现数据结构，可以在最短的时间内满足我的需求（**在最坏的情况下**）：-

（1）**弹出第n个元素**（我必须保持元素的相对顺序不变）
（2）**访问第n个元素**。

我不能使用*数组*，因为它不能弹出，我不想在删除第 i 个元素后有间隙。我试图通过将第 n 个元素与 next 再次与 next 直到 last 交换来消除差距，但这证明了时间效率低下，尽管数组的 O(1) 是无与伦比的。

我尝试使用 vector 并使用 'erase' 进行弹出窗口和 '.at()' 进行访问，但即使这对于时间效率来说并不便宜，尽管它比 array 更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:47:58.857

您可以尝试的是[跳过列表](http://en.wikipedia.org/wiki/Skip_list)- 它支持您在 O(log(n)) 中请求的操作。另一种选择是[分层向量](http://www.cs.brown.edu/cgc/jdsl/papers/tiered-vector.pdf)，它更容易实现并且需要 O(sqrt(n))。两种结构都很酷，但可惜不是很受欢迎。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-03T04:59:31.047

好吧，**我认为在数组上实现的分层向量最适合您的目的**。虽然分层向量的概念一开始可能是知道的并且有点难以理解，但是一旦你得到它，它就会打开很多问题，你会得到一个方便的武器来非常有效地处理许多问题的数据结构部分。**所以建议你掌握分层向量的实现**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T14:46:57.533

数组将为您提供`O(1)`查找但`O(n)`删除元素。列表将为您提供元素的`O(n)`查找错误`O(1)`删除。

二叉搜索树将为您提供删除元素的`O(log n)`查找。`O(1)`但它不保留相对顺序。

与列表结合使用的二叉搜索树将为您提供两全其美的效果。将节点插入列表（以保持顺序）和树（快速查找）。删除将`O(1)`。

```
struct node {
   node* list_next;
   node* list_prev;
   node* tree_right;
   node* tree_left;

   // node data;
}; 
```

请注意，如果使用索引作为排序值将节点插入树中，您最终会得到另一个链表假装是一棵树。但是，一旦构建了[树，就可以及时平衡树`O(n)`](http://krypton.mnsu.edu/~kelled/public/students/ArtiomNeguraF10/CACM86.pdf)，而您只需承担一次。

**更新**

考虑更多这可能不是您的最佳方法。我习惯于查找数据本身而不是它在集合中的相对位置。这是一种以数据为中心的方法。一旦删除节点，使用索引作为排序值就会中断，因为“更高”的索引需要更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T19:38:12.247

警告：不要认真对待这个答案。

理论上，您可以在 O(1) 中同时完成这两项操作。假设这是您要优化的唯一操作。以下解决方案将需要大量空间（并且会泄漏空间），并且创建数据结构需要很长时间：

使用数组。在数组的每个条目中，指向另一个相同的数组，但删除了该条目。

# sql-server - 从 SQL Server 的结果集中删除重复的组合

> ID：12976538
> 
> 赞同：2
> 
> 时间：2012-10-19T14:36:46.290
> 
> 标签：sql-server, sql-server-2008

我有一个包含两列数据的表，如下所示：

```
1,2
1,3
1,4
2,1
2,2
3,1 
```

我只想选择独特的组合，所以我最终会得到：

```
1,2
1,3
1,4
2,2 
```

因为 1,2 与 2,1 等的组合相同

我将如何在 SQL 语句中进行处理？

实际上，我的表有第三列，我想添加一个基于第三列的 where 子句，以便只考虑这些行

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T14:50:23.443

```
SELECT * FROM (
    SELECT
        CASE WHEN Col1 <= Col2 THEN Col1 ELSE Col2 END AS Col1,
        CASE WHEN Col1 <= Col2 THEN Col2 ELSE Col1 END AS Col2
    FROM
        MyTable
) Ordered
GROUP BY
    Col1, Col2 
```

`GROUP`您可以通过对表达式进行 ing 来在没有子查询的情况下执行此操作`CASE`，但阅读时间更长。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-19T15:10:40.620

实现相同目的的另一种方法：

```
SELECT a, b
FROM tableX
WHERE a <= b
  AND (other conditions)

UNION 

SELECT b, a
FROM tableX 
WHERE a > b 
  AND (other conditions) ; 
```

这种变化可能会有所不同（关于效率），具体取决于您拥有的索引：

```
SELECT *
FROM
  ( SELECT a, b
    FROM tableX
    WHERE (other conditions)
  UNION 
    SELECT b, a
    FROM tableX 
    WHERE (other conditions)
  ) AS tmp
WHERE a <= b ; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-19T14:49:56.313

您可以尝试以下方法：

```
select distinct col1, col2 from table
where col2 + '-' + col1 not in (select col1 + '-' + col2 from your_table) 
```

请注意，您必须连接字段，这取决于列类型（col1 + '-' + col2 适用于 char 和 varchar 类型）

* * *

## 回答 #4

> 赞同：-9
> 
> 时间：2012-10-19T14:43:33.863

怎么样：

```
SELECT
      COL1, COL2, COUNT(*)
FROM
     Your_Table
GROUP BY
      COL1, COL2 
```

# android - 如何使用 ARM NEON 优化循环 4D 矩阵向量乘法？

> ID：12976539
> 
> 赞同：7
> 
> 时间：2012-10-19T14:36:47.173
> 
> 标签：android, c, android-ndk, arm, neon

我正在使用 ARM NEON Assembler 优化 4D（128 位）矩阵向量乘法。

如果我将矩阵和向量加载到 NEON 寄存器中并对其进行转换，我不会获得很大的性能提升，因为切换到 NEON 寄存器需要 20 个周期。此外，我为每个乘法重新加载矩阵，尽管它没有改变。

有足够的寄存器空间一次对更多向量执行转换。这是提高性能。

但..

我想知道如果我在汇编程序中对所有顶点（增加指针）进行循环，这个操作会有多快。但我处于 Neon 汇编程序的最开始，虽然不知道如何做到这一点。有人可以帮帮我吗？

我想要达到的目标：

1.  加载矩阵和第一个向量
2.  存储循环计数“计数”和..
3.  -- 循环开始 --
4.  执行乘加（进行转换）
5.  将 q0 写入 vOut
6.  将指针 vIn 和 vOut 增加 4（128 位）
7.  将 vIn 加载到 q5。
8.  -- LOOP_END --

现有的 C 版本循环：

```
void TransformVertices(ESMatrix* m, GLfloat* vertices, GLfloat* normals, int count)
{
    GLfloat* pVertex = vertices;
    int i;  

    // iterate trough vertices only one at a time
    for (i = 0; i < count ; i ++)
    {
        Matrix4Vector4Mul( (float *)m, (float *)pVertex, (float *)pVertex);
        pVertex += 4;
    }

    //LoadMatrix( (const float*) m);

    //// two at a time
    //for (i = 0; i < count ; i += 2)
    //{
    //    Matrix4Vector4Mul2( (float *)m, (float *)pVertex, (float *)(pVertex + 4));
    //      pVertex += 8;
    //}
} 
```

以下 NEON-Version 代码仅进行一次转换：

```
void Matrix4Vector4Mul (const float* m, const float* vIn, float* vOut)
{    
    asm volatile
    (

    "vldmia %1, {q1-q4 }     \n\t"
    "vldmia %2, {q5}         \n\t"

    "vmul.f32 q0, q1, d10[0] \n\t"        
    "vmla.f32 q0, q2, d10[1] \n\t"      
    "vmla.f32 q0, q3, d11[0] \n\t"        
    "vmla.f32 q0, q4, d11[1] \n\t"

    "vstmia %0, {q0}"

    : // no output
    : "r" (vOut), "r" (m), "r" (vIn)       
    : "memory", "q0", "q1", "q2", "q3", "q4", "q5" 
    );

} 
```

C版转换：

```
void Matrix4Vector4Mul (const float* m, const float* vIn, float* vOut)
{
    Vertex4D* v1 =    (Vertex4D*)vIn;
    Vertex4D vOut1;
    Vertex4D* l0;
    Vertex4D* l1;
    Vertex4D* l2;
    Vertex4D* l3;

    // 4x4 Matrix with members m00 - m33 
    ESMatrix* m1 = (ESMatrix*)m;

    l0 = (Vertex4D*)&m1->m00;
    vOut1.x = l0->x * v1->x;
    vOut1.y = l0->y * v1->x;
    vOut1.z = l0->z * v1->x;
    vOut1.w = l0->w * v1->x;

    l1 = (Vertex4D*)&m1->m10;
    vOut1.x += l1->x * v1->y;
    vOut1.y += l1->y * v1->y;
    vOut1.z += l1->z * v1->y;
    vOut1.w += l1->w * v1->y;

    l2 = (Vertex4D*)&m1->m20;
    vOut1.x += l2->x * v1->z;
    vOut1.y += l2->y * v1->z;
    vOut1.z += l2->z * v1->z;
    vOut1.w += l2->w * v1->z;

    l3 = (Vertex4D*)&m1->m30;
    vOut1.x += l3->x * v1->w;
    vOut1.y += l3->y * v1->w;
    vOut1.z += l3->z * v1->w;
    vOut1.w += l3->w * v1->w;

    *(vOut) = vOut1.x;
    *(vOut + 1) = vOut1.y;
    *(vOut + 2) = vOut1.z;
    *(vOut + 3) = vOut1.w;
} 
```

性能：（变换 > 90 000 个顶点 | Android 4.0.4 SGS II）

```
C-Version:    190 FPS 
NEON-Version: 162 FPS ( .. slower -.- )

--- LOAD Matrix only ONCE (seperate ASM) and then perform two V's at a time ---

NEON-Version: 217 FPS ( + 33 % NEON | + 14 % C-Code ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T00:15:56.697

您是否尝试过使用编译器标志？

```
-mcpu=cortex-a9 -mtune=cortex-a9 -mfloat-abi=softfp -mfpu=neon -O3 
```

在这种情况下对我来说做得很好（gcc 4.4.3，随 Android NDK 8b 一起分发）。尝试通过定义内部函数 static 和 inline 以及将矩阵（m[X][0] 东西）移动到静态全局变量来获得紧凑的源代码，或者只是将 Matrix4Vector4Mul 合并到循环中并制作矩阵局部变量而不是继续在函数中传递它- gcc 在那里并不聪明。

当我这样做时，我得到了主循环的下方。

```
 a4:   ed567a03    vldr    s15, [r6, #-12]
  a8:   ee276aa0    vmul.f32    s12, s15, s1
  ac:   ee676aa8    vmul.f32    s13, s15, s17
  b0:   ed564a04    vldr    s9, [r6, #-16]
  b4:   ee277a88    vmul.f32    s14, s15, s16
  b8:   ed165a02    vldr    s10, [r6, #-8]
  bc:   ee677a80    vmul.f32    s15, s15, s0
  c0:   ed565a01    vldr    s11, [r6, #-4]
  c4:   e2833001    add r3, r3, #1
  c8:   ee046a89    vmla.f32    s12, s9, s18
  cc:   e1530004    cmp r3, r4
  d0:   ee446aaa    vmla.f32    s13, s9, s21
  d4:   ee047a8a    vmla.f32    s14, s9, s20
  d8:   ee447aa9    vmla.f32    s15, s9, s19
  dc:   ee056a22    vmla.f32    s12, s10, s5
  e0:   ee456a01    vmla.f32    s13, s10, s2
  e4:   ee057a21    vmla.f32    s14, s10, s3
  e8:   ee457a02    vmla.f32    s15, s10, s4
  ec:   ee056a8b    vmla.f32    s12, s11, s22
  f0:   ee456a83    vmla.f32    s13, s11, s6
  f4:   ee057aa3    vmla.f32    s14, s11, s7
  f8:   ee457a84    vmla.f32    s15, s11, s8
  fc:   ed066a01    vstr    s12, [r6, #-4]
 100:   ed466a04    vstr    s13, [r6, #-16]
 104:   ed067a03    vstr    s14, [r6, #-12]
 108:   ed467a02    vstr    s15, [r6, #-8]
 10c:   e2866010    add r6, r6, #16
 110:   1affffe3    bne a4 <TransformVertices+0xa4> 
```

有 4 次加载、4 次乘法、12 次乘法和累加以及 4 次存储，这与您在 Matrix4Vector4Mul 中所做的相匹配。

如果您仍然对编译器生成的代码不满意，请传递编译器“-S”以获取汇编输出并将其用作进一步改进的起点，而不是从头开始。

您还应该检查`vertices`缓存线大小是否对齐（Cortex-A9 为 32 字节）以获得良好的数据流。

对于矢量化，有 gcc 选项`-ftree-vectorizer-verbose=9`，例如打印矢量化的信息。还可以在 gcc 文档中搜索[此](http://gcc.gnu.org/onlinedocs/gcc/Vector-Extensions.html)文档，以了解如何指导 gcc 或需要修改哪些内容以使乘法向量化。这听起来可能需要深入研究，但从长远来看，它比“手动矢量化”更有成效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:32:21.927

手动调整的 neon 版本存在所有操作之间的依赖关系，而 gcc 能够为 c 版本进行乱序调度。您应该能够通过并行计算两个或多个独立线程来改进 NEON 版本：

NEON 中的指针增量（后增量）是用感叹号完成的。然后这些寄存器应包含在输出寄存器列表“=r”（vOut）中

```
vld1.32 {d0,d1}, [%2]!   ; // next round %2=%2 + 16 
vst1.32 {d0},    [%3]!   ; // next round %3=%3 + 8 
```

另一种寻址模式允许按另一个臂寄存器中定义的“跨度”后递增。该选项仅在某些加载命令上可用（因为有多种交错选项以及加载到 d1[1] （上部）的选定元素）。

```
vld1.16 d0, [%2], %3    ; // increment by register %3 
```

计数器增量随序列发生

```
1: subs %3, %3, #1      ; // with "=r" (count) as fourth argument
bne 1b                  ; // create a local label 
```

使用本地标签，因为同一文件中的两个“bne loop”语句会导致错误

通过计算向量而不是单个元素的融合乘加，应该能够将并行度提高四倍。

在这种情况下，提前执行矩阵转置是值得的（在调用例程之前或使用特殊寻址模式）。

```
asm(
   "vld1.32 {d0[0],d2[0],d4[0],d6[0]}, [%0]! \n\t"
   "vld1.32 {d0[1],d2[1],d4[1],d6[1]}, [%0]! \n\t"
   "vld1.32 {d1[0],d3[0],d5[0],d7[0]}, [%0]! \n\t"
   "vld1.32 {d1[1],d3[1],d5[1],d7[1]}, [%0]! \n\t"

   "vld1.32 {q8}, [%2:128]! \n\t"
   "vld1.32 {q9}, [%2:128]! \n\t"
   "vld1.32 {q10}, [%2:128]! \n\t"
   "vld1.32 {q11}, [%2:128]! \n\t"

   "subs %0, %0, %0 \n\t"   // set zero flag

   "1: \n\t"
   "vst1.32 {q4}, [%1:128]! \n\t"
   "vmul.f32 q4, q8, q0 \n\t"
   "vst1.32 {q5}, [%1:128]! \n\t"
   "vmul.f32 q5, q9, q0 \n\t"
   "vst1.32 {q6}, [%1:128]! \n\t"
   "vmul.f32 q6, q10, q0 \n\t"
   "vst1.32 {q7}, [%1:128]!  \n\t"
   "vmul.f32 q7, q11, q0 \n\t"

   "subne %1,%1, #64    \n\t"    // revert writing pointer in 1st iteration 

   "vmla.f32 q4, q8, q1 \n\t"
   "vmla.f32 q5, q9, q1 \n\t"
   "vmla.f32 q6, q10, q1 \n\t"
   "vmla.f32 q7, q11, q1 \n\t"
   "subs %2, %2, #1 \n\t"
   "vmla.f32 q4, q8, q2 \n\t"
   "vmla.f32 q5, q9, q2 \n\t"
   "vmla.f32 q6, q10, q2 \n\t"
   "vmla.f32 q7, q11, q2 \n\t"

   "vmla.f32 q4, q8, q3 \n\t"
   "vld1.32 {q8}, [%2:128]! \n\t"  // start loading vectors immediately
   "vmla.f32 q5, q9, q3 \n\t"
   "vld1.32 {q9}, [%2:128]! \n\t"  // when all arithmetic is done
   "vmla.f32 q6, q10, q3 \n\t"
   "vld1.32 {q10}, [%2:128]! \n\t"
   "vmla.f32 q7, q11, q3 \n\t"
   "vld1.32 {q11}, [%2:128]! \n\t"
   "jnz b1 \n\t"
   "vst1.32 {q4,q5}, [%1:128]! \n\t"  // write after first loop
   "vst1.32 {q6,q7}, [%1:128]! \n\t"
 : "=r" (m), "=r" (vOut), "=r" (vIn), "=r" ( N ), 
 :
 : "d0","d1","q0", ... ); // marking q0 isn't enough for some gcc version 
```

读取和写入 128 位对齐块（确保数据 ptr 也对齐）
有一个带有对齐的 malloc，或者只是手动调整`ptr=((int)ptr + 15) & ~15`。

正如有一个后循环块写入结果一样，人们可以编写一个类似的前循环块，跳过对 vOut 的第一次无意义写入（这也可以通过条件写入来克服）。不幸的是，只能有条件地写入 64 位寄存器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-29T07:56:10.640

到目前为止，这是一个将近一整年的话题，但我认为给你一个“正确”的答案很重要，因为这里有些东西很可疑，到目前为止还没有人指出这一点：

1.  如果可能，您应该避免使用 q4-q7，因为它们必须在使用前保存

2.  如果我在这方面错了，请纠正我，但如果我的记忆没有让我失望，那么只有 d0~d3（或 d0~d7）可以保存标量。我真的很想知道为什么 gcc 容忍 d10 和 d11 作为标量操作数。由于这种方式在物理上是不可能的，我猜 gcc 又在用你的内联汇编做一些疯狂的事情。检查您的内联汇编代码的反汇编。

诚然，您的内联汇编代码存在两个互锁（加载后 2 个周期和存储前 9 个周期），但我无法想象 NEON 代码的运行速度比 C 代码慢。

从我的角度来看，这是一个非常强烈的猜测，即 gcc 会进行一些繁重的寄存器来回传输，而不是吐出一条错误消息。在这种情况下，它并没有完全帮上忙。

# .net - 如何在不更新任何 dll/exe 的情况下更新 .Net 4.x 应用程序？

> ID：12976540
> 
> 赞同：0
> 
> 时间：2012-10-19T14:36:51.667
> 
> 标签：.net, dll, desktop-application, auto-update

我需要为使用 .Net 4.0 或 4.5 构建的桌面应用程序开发自动更新机制。它不应下载或更新任何 dll 或 exe 文件。这是公司的政策，我不能改变。

但是，允许下载任何类型的脚本、c# 代码、xml、json、xaml 等，这些脚本可以存储在此应用程序正在使用的 SQL 数据库中。

任何想法如何构建这种更新程序？有什么标准的方法或框架吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:11:23.780

由于不要求“下载二进制文件”，您将需要使用[CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx)将您的 .cs 文件转换为程序集，然后可以按照我在原始答案中的描述进行加载。[这是一个关于代码项目的很好的教程](http://www.codeproject.com/Articles/9019/Compiling-and-Executing-Code-at-Runtime)，关于如何在运行时使用该类来编译你的 .cs 代码。

* * *

**原答案：**

扩展[杰西的评论](https://stackoverflow.com/questions/12976540/how-to-update-net-4-x-application-without-updating-any-dlls-exe#comment17598189_12976540)。您的主程序需要是一个简单的加载程序，可以查询包含真实文件的“程序数据库”。

加载过程有 2 个阶段：引导 AppDomin、加载程序集

* * *

要引导您的应用程序域，您需要创建一个新的 AppDomain，将其限制为仅加载签名文件，然后加载加载其余 DLL 的加载程序

在您的代码中，您需要[创建一个新的 AppDomain](http://msdn.microsoft.com/en-us/library/ms130766%28v=vs.100%29.aspx)以将文件加载到其中。在该应用程序域中，您将希望创建一个仅允许加载[由您的私钥签名的程序集的](http://msdn.microsoft.com/en-us/library/system.security.policy.publisher.publisher%28v=vs.100%29.aspx)[证据。](http://msdn.microsoft.com/en-us/library/system.security.policy.evidence%28v=vs.100%29.aspx)

```
//Assumes you have your X509Certificate (the version that only has the public key)
// stored in Settings.Resources.
var onlySignedByMe = new Publisher(Settings.Resources.MyCompanyCertificate);

var evidence = new Evidence();
evedence.(onlySignedByMe);

var adi = new AppDomainInitializer(AppDomainInit);

var appDomainSetup = new AppDomainSetup();
appDomainSetup.AppDomainInitializer = adi;
appDomainSetup.ApplicationBase = System.Environment.CurrentDirectory;

var programAppDomain = AppDomain.CreateDomain("programAppDomain", evidence, appDomainSetup, PermissionSet(PermissionState.Unrestricted)); 
```

当 AppDomian 初始化时，它将从新域调用 AppDomainInit。从那里查询数据库以获取它需要加载的任何程序集。将这些文件加载​​到`byte[]`然后`byte[]`使用[AppDomain 上的 Load 方法加载](http://msdn.microsoft.com/en-us/library/7hcs6az6%28v=vs.100%29.aspx)

```
private static void AppDomainInit(string[] args)
{
    List<Byte[]> assemblies;

    //Snip, populating the list;

    Asesembly entryAssembly;
    foreach(var assembly in assemblies)
    {
         var loadedAssembly = Assembly.Load(assembly);
         if(TestForKnownEntryPointAssembly(loadedAssembly)
             entryAssembly = loadedAssembly;
    }
    if(entryAssembly != null)
    {
        Type type = entryAssembly.GetType("MyNamespace.EntryClass");
        MethodInfo method = type.GetMethod("Main");
        method.Invoke(null, null);
    }

} 
```

* * *

这都是凭记忆写的，所以可能会有一些错误。

# r - 如何在R中的年，月，日和日期之间双向转换？

> ID：12976542
> 
> 赞同：16
> 
> 时间：2012-10-19T14:37:01.983
> 
> 标签：r, datetime, type-conversion

如何在R中的年，月，日和日期之间转换？

我知道可以通过字符串来做到这一点，但我宁愿避免转换为字符串，部分原因可能是性能受到影响？部分原因是我担心区域化问题，其中一些世界使用“年-月-日” ”，有些使用“年-日-月”。

看起来 ISODate 提供了方向 year,month,day -> DateTime ，尽管它确实首先将数字转换为字符串，所以如果有一种方法不通过字符串，那么我更喜欢。

从日期时间到数值，我找不到任何相反的东西？我宁愿不需要使用 strsplit 或类似的东西。

编辑：为了清楚起见，我所拥有的是一个数据框，它看起来像：

```
year month day hour somevalue
2004 1     1   1   1515353
2004 1     1   2   3513535
.... 
```

我希望能够自由转换成这种格式：

```
time(hour units) somevalue
1             1515353
2             3513535
.... 
```

...并且还能够再次返回。

编辑：为了消除对“时间”（小时单位）含义的一些混淆，最终我所做的是，并使用[如何在 R 中找到两个日期之间的差异的信息？](https://stackoverflow.com/questions/12977073/how-to-find-the-difference-between-two-dates-in-hours-in-r)：

**前进方向：**

```
lh$time <- as.numeric( difftime(ISOdate(lh$year,lh$month,lh$day,lh$hour), ISOdate(2004,1,1,0), units="hours"))
lh$year <- NULL; lh$month <- NULL; lh$day <- NULL; lh$hour <- NULL 
```

**向后方向：**

...好吧，我还没有倒退，但我想像：

*   从 lh$time 创建 difftime 对象（不知何故...）
*   将 ISOdate(2004,1,1,0) 添加到 difftime 对象
*   使用以下解决方案之一来获取年、月、日、小时

我想在未来，我可以问我要解决的确切问题，但我试图将我的具体问题分解为通用的可重用问题，但也许这是一个错误？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-19T15:29:20.797

因为有很多方法可以从文件、数据库等中传递日期，并且由于您提到只是以不同的顺序或使用不同的分隔符编写的原因，将*输入*的日期表示为字符串是一种方便且有用的方法解决方案。R 不将实际日期保存为字符串，您无需将它们作为字符串处理即可使用它们。

R 在内部使用操作系统以标准方式执行这些操作。你根本不需要操作字符串——也许只是将一些东西从字符转换为它们的数字等价物。例如，很容易将两个操作（向前和向后）封装在您可以部署的简单函数中。

```
toDate <- function(year, month, day) {
    ISOdate(year, month, day)
}

toNumerics <- function(Date) {
    stopifnot(inherits(Date, c("Date", "POSIXt")))
    day <- as.numeric(strftime(Date, format = "%d"))
    month <- as.numeric(strftime(Date, format = "%m"))
    year <- as.numeric(strftime(Date, format = "%Y"))
    list(year = year, month = month, day = day)
} 
```

我放弃了对分隔字符的单个调用`strptime()`和随后的拆分，因为您不喜欢这种操作。

```
> toDate(2004, 12, 21)
[1] "2004-12-21 12:00:00 GMT"
> toNumerics(toDate(2004, 12, 21))
$year
[1] 2004

$month
[1] 12

$day
[1] 21 
```

在内部，R 的日期时间代码运行良好，并且如果由于时区问题等原因在某些地方有点复杂，则经过良好测试和鲁棒性。我发现使用的习惯用法`toNumerics()`比将日期时间作为列表并记住哪些元素是基于 0 的更直观。建立在提供的功能上似乎比试图避免字符串转换等更容易。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-04-11T09:38:54.603

我参加聚会有点晚了，但是从整数转换为日期的另一种方法是`lubridate::make_date`函数。请参阅以下来自 R for Data Science 的示例：

```
library(lubridate)
library(nycflights13)
library(tidyverse)

a <- flights %>%
  mutate(date = make_date(year, month, day)) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-19T14:47:12.953

找到了一种从日期到年、月、日的解决方案。

假设我们有一个日期对象，我们将在这里使用 ISOdate 创建它：

```
somedate <- ISOdate(2004,12,21) 
```

然后，我们可以得到 this 的数值成分如下：

```
unclass(as.POSIXlt(somedate)) 
```

给出：

```
$sec
[1] 0

$min
[1] 0

$hour
[1] 12

$mday
[1] 21

$mon
[1] 11

$year
[1] 104 
```

然后可以得到想要的东西，例如：

```
unclass(as.POSIXlt(somedate))$mon 
```

注意 $year 是 [实际年份] - 1900，month 从 0 开始，mday 从 1 开始（根据 POSIX 标准）

# entity-framework-4.1 - 无法使用实体框架强制转换类型为 nullable(of object) 的对象

> ID：12976545
> 
> 赞同：0
> 
> 时间：2012-10-19T14:37:08.540
> 
> 标签：entity-framework-4.1, asp.net-mvc-4, asp.net-web-api

我目前正在使用 MVC 4 WebAPI w Entity Framework 数据库首先建模的场景。在我的 apicontroller 中，它给了我一个错误：

> 发生了错误。无法将类型为“WhereSelectEnumerableIterator `2[VB$AnonymousType_4`2[System.Nullable `1[System.Guid],System.Collections.Generic.IEnumerable`1[CK5.Airline]]，VB$AnonymousType_5 `1[System.Nullable`1[System.Guid]]]”的对象转换为类型“System.Collections.Generic.IEnumerable `1[CK5.Airline]'. </ExceptionMessage> <ExceptionType>System.InvalidCastException</ExceptionType> <StackTrace> at lambda_method(Closure , Object , Object[] ) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.<>c__DisplayClass13.<GetExecutor>b__c(Object instance, Object[] methodParameters) at System.Web.Http.Controllers.ReflectedHttpActionDescriptor.ActionExecutor.Execute(Object instance, Object[] arguments) at System.Threading.Tasks.TaskHelpers.RunSynchronously[TResult](Func`1 func，CancellationToken cancelToken）

```
 Public Class AirlineController
            Inherits ApiController

            ' GET api/Airline
            Function GetAirlines() As IEnumerable(Of Airline)
                Using db As New DefaultEntities
                    Return From p In db.Airlines.AsEnumerable Order By {p.Name} Group By ParentID = p.ParentID Into parentIDGroup = Group Select New With {.ParentID = ParentID}
                End Using
            End Function
End Class 
```

在我的实体模型对象中，ParentID 是一个可以为空的（guid）类型，我相信会导致问题。在使用 Linq2Sql 场景之前，我已经完成了这项工作，但是随着更新，这给了我一个问题。我不认为这是 web api 结构的问题，只是 w 实体框架。我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-23T02:49:29.590

我修好了它。1）由于某种原因，EF不喜欢使用语句Using db as New DBContext，我认为它会在使用前关闭连接。2）我也不知道为什么，但它也不喜欢使用 lambda 语句。所以它不喜欢 Order By 或 Group By 语句。我得调查一下。3）问题有点不相关，但由于这是一个数据库第一个 EF，我还在 globabl.asax 中放入了这个语句：Database.SetInitializer(New DropCreateDatabaseIfModelChanges(Of DefaultEntities)())。认为它会根据更改更新模型或数据库。它骗了我。=/

# mysql - SQL：在 JOIN 之后进行 GROUP BY 而不覆盖行？

> ID：12976550
> 
> 赞同：3
> 
> 时间：2012-10-19T14:37:15.757
> 
> 标签：mysql, sql, join, group-by

我有一张篮球联赛表、一张球队表和一张这样的球员表：

```
LEAGUES
ID   |   NAME    |
------------------
1    |   NBA     |
2    |   ABA     |

TEAMS:
ID   |   NAME    |  LEAGUE_ID
------------------------------
20   |   BULLS   |    1
21   |   KNICKS  |    2

PLAYERS:
ID   |   TEAM_ID  |  FIRST_NAME | LAST_NAME | 
---------------------------------------------
1    |      21    |   John      |  Starks   |    
2    |      21    |   Patrick   |  Ewing    | 
```

给定一个联赛 ID，我想从该联赛的所有球队中检索所有球员的姓名和他们的球队 ID，所以我这样做：

```
SELECT t.id AS team_id, p.id AS player_id, p.first_name, p.last_name
FROM teams AS t
JOIN players AS p ON p.team_id = t.id
WHERE t.league_id =  1 
```

返回：

```
[0] => stdClass Object
    (
        [team_id] => 21
        [player_id] => 1
        [first_name] => John
        [last_name] => Starks
    )

[1] => stdClass Object
    (
        [team_id] => 21
        [player_id] => 2
        [first_name] => Patrick
        [last_name] => Ewing
    )

+ around 500 more objects... 
```

由于我将使用此结果为每个团队填充包含每个团队的球员列表的下拉菜单，我想按团队 ID 对结果进行分组，因此创建这些下拉列表的循环只需循环遍历每个团队 ID 而不是每次所有 500 多名玩家。

但是当我像这样使用 GROUP BY 时：

```
SELECT t.id AS team_id, p.id AS player_id, p.first_name, p.last_name
FROM teams AS t
JOIN players AS p ON p.team_id = t.id
WHERE t.league_id =  1
GROUP BY t.id 
```

它只返回每个团队的一名球员，因为使用相同的列名，会覆盖同一球队的所有其他球员。

```
[0] => stdClass Object
    (
        [team_id] => 21
        [player_id] => 2
        [first_name] => Patrick
        [last_name] => Ewing
    )
[1] => stdClass Object
    (
        [team_id] => 22
        [player_id] => 31
        [first_name] => Shawn
        [last_name] => Kemp
    )
etc... 
```

我想返回这样的东西：

```
[0] => stdClass Object
    (
        [team_id] => 2

        [player_id1] => 1
        [first_name1] => John
        [last_name1] => Starks
        [player_id2] => 2
        [first_name2] => Patrick
        [last_name2] => Ewing

        +10 more players from this team...
    )

    +25 more teams... 
```

有可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:45:57.330

您无法在 SQL 中执行此操作，因为您无法以数据集的形式表示该结果。你想返回复杂的对象。您可以做的是在代码中处理这个问题，并通过返回一个按 team_id 排序的数据集来帮助自己。每当您的 team_id 更改时，就该在您的代码中创建新对象并用新的玩家列表填充它。

它会是这样的（语法可能不正确）：

返回结果集：

```
team_id|player_id|first|last
1|1|f1|l1
1|2|f2|l2
1|3|f3|l3
2|5|f5|l5
2|6|f6|l6 
```

当这在您的代码中返回时

```
$lastTeamId=0;
$output=array();
foreach($results as $row){
  if($lastTeamId != $row["team_id"]){
    $lastTeamId = $row["team_id"];
    $output[$lastTeamId] = array();
  }

  $newPlayer = null;
  $newPlayer->id = $row["player_id"];
  $newPlayer->first = $row["first"];
  $newPlayer->last = $row["last"];
  $output[$lastTeamId][] = $newPlayer;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:50:51.200

在 MySQL 中，您可以 GROUP BY team_id 然后 SELECT GROUP_CONCAT(player detail ...)。但这会受到限制，并且不是典型的关系方法。

# jquery - jQuery scrolltop if/else/and 从不同的页面？

> ID：12976551
> 
> 赞同：0
> 
> 时间：2012-10-19T14:37:19.550
> 
> 标签：jquery

我在我的网站上使用以下 jquery 脚本在博客条目页面上从顶部的评论链接向下滚动到底部的实际评论：

```
 jQuery(document).ready(function(){      
       var TopPosition = jQuery('#comments').offset().top;     
       jQuery('.comments-link').click(function(){        
           jQuery('html, body').animate({scrollTop:TopPosition}, 2000, 'swing');
           return false;
       });   
   }); 
```

当'#comments'不存在时，我还希望页面向下滚动到“#respond”。这是否可能在jquery中使用if/else/and？

此外，是否可以从带有评论链接的不同页面（即我的博客的索引页面）链接到单个博客条目的评论，并且还可以向下滚动动画？

希望这是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:41:21.013

如果您想滚动到`#respond`何时`#comments`不存在，只需检查选择器返回的对象的长度......如果它是 0 则它不在页面上，您可以使用`offset().top`of`#respond`代替。

```
jQuery(document).ready(function(){
   var comments = jQuery('#comments');
   var TopPosition = (comments.length==0)? 
       jQuery('#respond').offset().top :
       comments.offset().top;     
   jQuery('.comments-link').click(function(){        
       jQuery('html, body').animate({scrollTop:TopPosition}, 2000, 'swing');
       return false;
   });   
}); 
```

要在页面加载时向下滚动，您需要使用哈希（例如`page.php#comments`），但是传统上您将有一个锚标记 ( `<a name="comments'></a>`)，并且页面会跳转到它。如果你想有一个流畅的滚动，你可以看看`location.hash`然后触发滚动。由于它实际上与`onClick`我将其分解为一个您可以同时调用两者的函数相同：

```
jQuery(document).ready(function(){
    // Set up the onClick() event
    jQuery('.comments-link').click(scrollToComments);

    // If the page is page.php#comments scroll to the comments/response
    if (location.hash=='#comments') scrollToComments();
});

// This function handles the scrolling on page load and onclick
function scrollToComments(){
    var comments = jQuery('#comments');
    // this can be moved outside the function, or recalculate in case the page redraws
    var scrollTopPosition = (comments.length==0)? 
       jQuery('#respond').offset().top :
       comments.offset().top;
    jQuery('html, body').animate({scrollTop:scrollTopPosition}, 2000, 'swing');
    return false;
} 
```

# scala - 垂直制表符的字符文字？

> ID：12976559
> 
> 赞同：9
> 
> 时间：2012-10-19T14:38:02.263
> 
> 标签：scala

如何在 Scala 中为垂直制表符（'\v'，ASCII 11）编写字符文字？

`'\v'`不起作用。（无效的转义字符） `'\11'`应该是它，但是......

```
scala> '\11'.toInt
res13: Int = 9 
```

但 9 是普通制表符 ('\t') 的 ASCII 码。那里发生了什么？

编辑：这有效并产生正确的字符，但我仍然想知道文字的语法。

```
val c:Char = 11 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-19T14:41:23.213

你需要使用`'\13'`. 它是八进制的。

有关更多信息，请参阅[Scala 语言规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)。

> 1.3.4 字符文字
> 
> 句法：
> 
> characterLiteral ::= '\'' printableChar '\'' | '\'' charEscapeSeq '\''</p>
> 
> 字符文字是用引号括起来的单个字符。该字符要么是可打印的 unicode 字符，要么由转义序列（第 1.3.6 节）描述。
> 
> 示例 1.3.4 以下是一些字符文字： 'a' '\u0041' '\n' '\t' 请注意，'\u000A' 不是有效的字符文字，因为 Unicode 转换是在文字解析和 Unicode 字符 \ 之前完成的u000A（换行）不是可打印字符。可以使用转义序列 '\n' 或八进制转义符 '\12' （第 1.3.6 节）。

# c# - 枚举和值类型

> ID：12976565
> 
> 赞同：0
> 
> 时间：2012-10-19T14:38:18.330
> 
> 标签：c#, enums

> **可能重复：**
> [为什么枚举需要显式转换为 int 类型？](https://stackoverflow.com/questions/4728295/why-enums-require-an-explicit-cast-to-int-type)

我定义了这个枚举：

```
public enum GroupTypes : int
{
    gt_table0 = 0
    gt_table1 = gt_table0 + 1,
    gt_table2 = gt_table1 + 1,
    gt_table3 = gt_table2 + 1,
    gt_table4 = gt_table3 + 1,
    gt_table5 = gt_table4 + 1,
    gt_table6 = gt_table5 + 1,
    gt_table7 = gt_table6 + 1,
    gt_table8 = gt_table7 + 1
} 
```

然后我使用这个枚举如下：

```
for (int i = 0; i < NbrTables; i++)
{
    // Compute starting table
    int StartGroup = GroupTypes.gt_table0 + i;

    // Some more code here        
} 
```

我感到困惑的是，当我使用枚举来计算我的 StartGroup 时，我收到错误“无法将类型 'GroupTypes' 隐式转换为 'int'。存在显式转换”。

我认为我会避免这个错误，因为我将 GroupTypes 枚举声明为 int。

我的误解在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:41:32.540

> 我认为我会避免这个错误，因为我将 GroupTypes 枚举声明为 int。

由于您的枚举是一个 int，因此*如果您明确指定*强制转换，则可以这样做：

```
int StartGroup = (int)GroupTypes.gt_table0 + i; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:43:06.443

:int 的使用只影响枚举的存储类，而不影响它的任何行为

# installation - 在 NSIS 安装程序中向 instfiles 页面添加文本

> ID：12976567
> 
> 赞同：1
> 
> 时间：2012-10-19T14:38:27.883
> 
> 标签：installation, nsis

我正在编写一个 NSIS 安装程序，并希望在后台进程静默运行时向 instfiles 页面添加一些文本。例如：

```
SetOutPath $INSTDIR\Temp
File "C:\InstallationFiles\IIS_Configure.cmd" 
OUTPUTTEXT "Configuring IIS..."
nsExec::Exec '"$INSTDIR\Temp\IIS_Configure.cmd"' 
```

（其中 OUTPUTTEXT 目前是伪代码）

然后，我希望用户在屏幕上的输出为：

```
Output folder: C:\Program Files\Install Folder\Temp
Extract: IIS_Configure.cmd
Configuring IIS... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:22:13.770

如果您想在日志窗口中添加一行，请使用[DetailPrint](http://anders_k.users.sourceforge.net/public/NSIS/2.46/Manual.html#detailprint)`SetDetailsPrint` ，如果您愿意，您可以使用它来关闭来自其他命令的消息...

# r - 可变长度核心名称标识

> ID：12976569
> 
> 赞同：0
> 
> 时间：2012-10-19T14:38:41.947
> 
> 标签：r

我有一个具有以下行命名方案的数据集：

```
a.X.V
where:
a is a fixed-length core ID
X is a variable-length string that subsets a, which means I should keep X
V is a variable-length ID which specifies the individual elements of a.X to be averaged
. is one of {-,_} 
```

我想要做的是对所有`a.X's`. 一个样品：

```
sampleList <- list("a.12.1"=c(1,2,3,4,5), "b.1.23"=c(3,4,1,4,5), "a.12.21"=c(5,7,2,8,9), "b.1.555"=c(6,8,9,0,6))
sampleList
$a.12.1
[1] 1 2 3 4 5

$b.1.23
[1] 3 4 1 4 5

$a.12.21
[1] 5 7 2 8 9

$b.1.555
[1] 6 8 9 0 6 
```

目前我正在手动 gsubbing`.Vs`以获取一般列表：

```
sampleList <- t(as.data.frame(sampleList))
y <- rowNames(sampleList)
y <- gsub("(\\w\\.\\d+)\\.d+", "\\1", y) 
```

有没有更快的方法来做到这一点？

这是我在工作流程中遇到的 2 个问题的一半。[另一半在这里](https://stackoverflow.com/questions/12975794/easy-way-to-get-averages-based-on-names-in-list)得到了回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:43:58.597

您可以使用模式向量来查找要分组的列的位置。我包含了一个我知道不会匹配任何东西的模式，以表明该解决方案对于这种情况是稳健的。

```
# A *named* vector of patterns you want to group by
patterns <- c(a.12="^a.12",b.12="^b.12",c.12="^c.12")
# Find the locations of those patterns in your list
inds <- lapply(patterns, grep, x=names(sampleList))
# Calculate the mean of each list element that matches the pattern
out <- lapply(inds, function(i) 
  if(l <- length(i)) Reduce("+",sampleList[i])/l else NULL)
# Set the names of the output
names(out) <- names(patterns) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T14:47:12.633

也许您可以考虑弄乱您的数据结构，以便更轻松地应用一些标准工具：

```
sampleList <- list("a.12.1"=c(1,2,3,4,5), 
  "b.1.23"=c(3,4,1,4,5), "a.12.21"=c(5,7,2,8,9), 
   "b.1.555"=c(6,8,9,0,6))
library(reshape2)
m1 <- melt(do.call(cbind,sampleList))
m2 <- cbind(m1,colsplit(m1$Var2,"\\.",c("coreID","val1","val2"))) 
```

结果如下所示：

```
head(m2)
  Var1    Var2 value coreID val1 val2
1     1  a.12.1     1      a   12    1
2     2  a.12.1     2      a   12    1
3     3  a.12.1     3      a   12    1 
```

Then you can more easily do something like this:

```
aggregate(value~val1,mean,data=subset(m2,coreID=="a")) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:52:36.193

`R` is poised to do this stuff if you would just move to `data.frame`s instead of `list`s. Make Your 'a', 'X', and 'V' into their own columns. Then you can use `ave`, `by`, `aggregate`, `subset`, etc.

```
data.frame(do.call(rbind, sampleList), 
           do.call(rbind, strsplit(names(sampleList), '\\.')))

#         X1 X2 X3 X4 X5 X1.1 X2.1 X3.1
# a.12.1   1  2  3  4  5    a   12    1
# b.1.23   3  4  1  4  5    b    1   23
# a.12.21  5  7  2  8  9    a   12   21
# b.1.555  6  8  9  0  6    b    1  555 
```

# .net-4.0 - .NET Framework 作为安装 Inno-Setup 的先决条件

> ID：12976576
> 
> 赞同：7
> 
> 时间：2012-10-19T14:38:56.830
> 
> 标签：.net-4.0, .net-3.5, inno-setup

我有一个应用程序，我必须检查是否已经安装了 .NET FW 3.5。如果已经安装，我想打开一个消息框，要求用户从 Microsoft 网站下载并停止安装。

我找到了以下代码。你能告诉我吗：

a) 我应该从哪里调用这个函数？b) 我是否应该检查是否已安装.NET FW 3.5**或更高版本？**例如，如果安装了 FW 4.0 - 是否需要安装 3.5？

谢谢

```
function IsDotNET35Detected(): Boolean;
var
  ErrorCode: Integer;
  netFrameWorkInstalled : Boolean;
  isInstalled: Cardinal;
begin
  result := true;

  // Check for the .Net 3.5 framework
  isInstalled := 0;
  netFrameworkInstalled := RegQueryDWordValue(HKLM, 'SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5', 'Install', isInstalled);
  if ((netFrameworkInstalled)  and (isInstalled <> 1)) then netFrameworkInstalled := false;

  if netFrameworkInstalled = false then
  begin
    if (MsgBox(ExpandConstant('{cm:dotnetmissing}'), mbConfirmation, MB_YESNO) = idYes) then
    begin
      ShellExec('open',
      'http://www.microsoft.com/downloads/details.aspx?FamilyID=333325fd-ae52-4e35-b531-508d977d32a6&DisplayLang=en',
      '','',SW_SHOWNORMAL,ewNoWait,ErrorCode);
    end;
    result := false;
  end;

end; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T15:00:37.243

如果您想在安装开始时但在显示向导表单之前执行检查，请使用[`InitializeSetup`](http://www.jrsoftware.org/ishelp/index.php?topic=scriptevents&anchor=InitializeSetup)事件处理程序。当您向该处理程序返回 False 时，安装程​​序将中止，当您返回 True 时，安装程​​序将开始。这是您发布的一些优化脚本：

```
[Setup]
AppName=My Program
AppVersion=1.5
DefaultDirName={pf}\My Program

[CustomMessages]
DotNetMissing=.NET Framework 3.5 is missing. Do you want to download it ? Setup will now exit!

[Code]
function IsDotNET35Detected: Boolean;
var
  ErrorCode: Integer;
  InstallValue: Cardinal;  
begin
  Result := True;
  if not RegQueryDWordValue(HKLM, 'SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5', 
    'Install', InstallValue) or (InstallValue <> 1) then
  begin
    Result := False;
    if MsgBox(ExpandConstant('{cm:DotNetMissing}'), mbConfirmation, MB_YESNO) = IDYES then
      ShellExec('', 'http://www.microsoft.com/downloads/details.aspx?FamilyID=333325fd-ae52-4e35-b531-508d977d32a6&DisplayLang=en',
        '', '', SW_SHOWNORMAL, ewNoWait, ErrorCode);
  end;
end;

function InitializeSetup: Boolean;
begin
  Result := IsDotNET35Detected;
end; 
```

# css - 如何使用 CSS 在一个元素上重复多个图像

> ID：12976579
> 
> 赞同：0
> 
> 时间：2012-10-19T14:39:09.280
> 
> 标签：css

如何使用 CSS 垂直和水平重复第一个背景图像，并仅水平重复第二个背景图像？我希望它不依赖于 CSS3。

我尝试了以下，但没有成功。

```
body {
    font-family:Verdana, Geneva, sans-serif;
    position:relative;
    z-index:1;
}
body:before,
body:after {
    position:absolute;
    z-index:-1;
    top:0;
    left:0;
    right:0;
    bottom:0;
}
body:after {
    background-image:url('../images/bg.png');
    background-repeat:repeat;
}
body:before {
    background-image:url('../images/top-bg.png');
    background-repeat:repeat-x;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:42:25.490

```
mydiv
{
background-image:url('myimage.jpg');
background-repeat:repeat;
} 
```

...将在两个轴上进行

```
mydiv
{
background-image:url('myimage.jpg');
background-repeat:repeat-x;
} 
```

...将横向进行。

我假设这就是您所追求的，您的问题并不过分具体，您能否更清楚地说明您要达到的目标？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:52:58.667

看看[CSS3 多背景](http://www.css3.info/preview/multiple-backgrounds/)。自 Firefox 3.6、Safari 1.3、Chrome 10、Opera 10.50 和 Internet Explorer 9.0 起受支持。

如果您必须支持 IE8 或更早版本（请注意[Google 从下个月开始不再支持 IE8](http://www.theregister.co.uk/2012/09/17/ie8_ditched_by_google/)），请将图像合并为 1，或叠加多个元素。

```
<!doctype html>
<html>
 <head>
    <style type="text/css">
    #tile, #logo { 
       padding:0; 
       margin:0; 
       border:0; 
       position:absolute; 
       top:0; 
       left:0; 
       right:0; 
       bottom:0;
    }
    #tile{ 
       background-image:url('http://upload.wikimedia.org/wikipedia/commons/e/e7/Procedural_Texture.jpg'); 
       background-repeat:repeat;
    }
    #logo{ 
       background-image:url('http://upload.wikimedia.org/wikipedia/en/9/95/Stack_Overflow_website_logo.png'); 
       background-repeat:repeat-x;
    }
    </style>
 </head>
 <body>
<div id="tile"></div>
<div id="logo"></div>
 </body>
</html> 
```

这可能是可用的[各种解决方案](http://nicolasgallagher.com/multiple-backgrounds-and-borders-with-css2/)[之一](http://thasha-in-wonderland.blogspot.co.uk/2009/03/multiple-background-images-css3-and.html)。

# android - 上下文菜单无法显示

> ID：12976588
> 
> 赞同：0
> 
> 时间：2012-10-19T14:39:54.583
> 
> 标签：android, listview, contextmenu, android-sqlite

在我的代码中，我想添加一个上下文菜单。我有一个来自我的数据库的列表。我有一个名为*MONEY*的表，它有四个字段：*ID*、*FIRSTNAME*、*MONEY*和*DESCRIPTION*。我的列表视图工作正常，但上下文菜单不起作用。问题出在`onContextItemSelected()`方法上。当我长按列表项时，它不显示上下文菜单。

## 上下文菜单.xml

```
<?xml version="1.0" encoding="utf-8"?>
<Menu xmlns:android="http://schemas.android.com/apk/res/android" >

<item
    android:id="@+id/Delete"
    android:title="Delete"/>

</Menu> 
```

## 钱.java

```
package com.anurag.main;

public class Money extends Activity {
ArrayList list1, list2, list3, list4;
TextView text1, text2, text3, text4;
ImageView iv;
ListView mList;
SQLiteDatabase db;
private static String DBNAME = "MainDB.db";

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.money);
    mList = (ListView) findViewById(R.id.mList);
    list1 = new ArrayList();
    list2 = new ArrayList();
    list3 = new ArrayList();
    list4 = new ArrayList();
    try {
        db = openOrCreateDatabase(DBNAME, MODE_WORLD_READABLE, null);
        Cursor c = db.rawQuery("select * from MONEY", null);
        while (c.moveToNext()) {
            list1.add(c.getString(1));
            list2.add(c.getString(3));
            list3.add(c.getString(5));
            list4.add(c.getString(4));
        }
    } catch (Exception e) {
        // TODO: handle exception
    }
//Problem in this code 
    mList.setAdapter(new MyArrayAdapter(getApplicationContext()));

    mList.setOnCreateContextMenuListener(new OnCreateContextMenuListener() {

        @Override
        public void onCreateContextMenu(ContextMenu menu, View v,
                ContextMenuInfo menuInfo) {
            // TODO Auto-generated method stub
            MenuInflater inflater = getMenuInflater();
            inflater.inflate(R.menu.contextmenu, menu);

        }
    });

    //end here
}
//problem in this code
@Override
public boolean onContextItemSelected(MenuItem item) {
    // TODO Auto-generated method stub
    AdapterContextMenuInfo menuInfo = (AdapterContextMenuInfo) item 
            .getMenuInfo(); 
    switch (item.getItemId()) {
    case R.id.Delete:
        Toast.makeText(getApplicationContext(), "Deleted",    Toast.LENGTH_LONG).show();
        return true;

    default:
        Toast.makeText(getApplicationContext(), "HI", Toast.LENGTH_LONG).show();
    }
    return super.onContextItemSelected(item);
}
//End Here
class MyArrayAdapter extends BaseAdapter {
    Context context;

    public MyArrayAdapter(Context c) {
        context = c;
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        // return 0;
        return list1.size();
    }

    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
        // View v = inflater.inflate(R.layout.custom1, null);
        convertView = inflater.inflate(R.layout.custom1, null);
        text1 = (TextView) convertView.findViewById(R.id.text1);
        // text1.setText(list1[position]);
        text1.setText(list1.get(position).toString());
        text2 = (TextView) convertView.findViewById(R.id.text2);
        text2.setText(list2.get(position).toString());
        text3 = (TextView) convertView.findViewById(R.id.text3);
        text3.setText(list3.get(position).toString());
        text4 = (TextView) convertView.findViewById(R.id.text4);
        text4.setText(list4.get(position).toString());
        return convertView;
    }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:41:08.383

我*敢打赌*，错误是在解析 .xml 文件时，它是“期待菜单，得到菜单”。去资本化`<Menu></Menu>`，`contextmenu.xml`看看是否能解决它。

# php - 将 PDF 或 Word Doc 转换为可编辑的在线表单的 PHP 代码

> ID：12976593
> 
> 赞同：2
> 
> 时间：2012-10-19T14:40:02.810
> 
> 标签：php, forms, pdf, ms-word, doc

是否有预先存在的脚本/类/库来实现 PDF 到 WORD DOC 的转换？

我正在寻找可以传递包含“填写空白”字段的 PDF 或 Word Doc 的东西，该字段由一串*_*字符定义。

例如，PDF 或 Word Doc 可能包含： 这是一个测试测验。在我们的讲座中，我们讨论了***_***。1812 年，***_***购买了***_* _**。

在此示例中，我可以通过解析器运行此文件，该解析器将识别*__*字段是可编辑的，并将通过 HTML 前端或 PDF 表单等将这些字段显示为可编辑字段。

有没有人见过这个？谢谢你的帮助。

# javascript - Disqus 2012 Safari 和 Chrome 上的“未捕获的 TypeError：无法调用 null 的方法 'getPropertyValue'”

> ID：12976594
> 
> 赞同：6
> 
> 时间：2012-10-19T14:40:03.807
> 
> 标签：javascript, jquery, backbone.js, requirejs, disqus

在我的公司，我们正在努力使用令人惊叹的 Disqus 小部件提供良好的评论体验。

我们的网站完全基于 AJAX，最多使用 requirejs、jquery 和骨干网。

我们已经在需要它的页面上添加了 Disqus 小部件。在页面更改期间，我们当然会破坏 Disqus 小部件所在的 div 并再次实例化所有内容。

每个浏览器上的旧小部件一切都很好。问题发生在激活 Disqus 2012 的小部件时，在 Safari 和 Chrome 上没有出现错误“Uncaught TypeError: Cannot call method 'postMessage' of null”。火狐很好用。

这是涉及的代码：

```
define([
  'underscore',
  'backbone',
  'models/config',
  'models/book'
], function(_, Backbone, config) {

    App.Models.Disqus = Backbone.Model.extend({
        bookObj: null,

        initialize: function(options){
            console.log("discus.initialize()");
            var _this=this;

            _this.bookObj= new App.Models.Book({id: options.id});
            _this.bookObj.fetch({
                dataType: 'jsonp',
                success: function(model,response){
                    (typeof DISQUS == 'undefined')?_this.initDisqus():_this.resetDisqus();              }
            });

        },

        initDisqus: function(){
            console.log("discus.init()");
            disqus_shortname=config.get('DISQUS_ID');
            disqus_title = this.bookObj.get('content').title; 
            disqus_config = function (){
                // this.page.identifier = _this.id;
                // this.page.url = document.URL;
                this.language = config.get('LANG');
            };
            require(['http://'+disqus_shortname+'.disqus.com/embed.js'], function(){});
        },

        resetDisqus: function(){
            console.log("discus.reset()");
            var _this=this;
            DISQUS.reset({
                reload: true,
                config: function(){
                    this.page.identifier = _this.id;
                    this.page.url = document.URL;
                    this.page.title = _this.bookObj.get('content').title;
                    this.language = config.get('LANG');
                }
            });
        }

    });

    return App.Models.Disqus;
}); 
```

如果您需要更多信息，请随时询问。

在此先感谢，乔治

好的，伙计们，以这种方式解决：

```
define([
  'underscore',
  'backbone',
  'models/config',
  'models/book'
], function(_, Backbone, config) {

    App.Models.Disqus = Backbone.Model.extend({
        bookObj: null,

        initialize: function(options){
            console.log("discus.initialize()");
            var _this=this;
            _this.bookObj= new App.Models.Book({id: options.id});
            _this.bookObj.fetch({
                dataType: 'jsonp',
                success: function(model,response){
                    //(typeof DISQUS == 'undefined')?_this.initDisqus():_this.resetDisqus();

                    delete DISQUS;

                    disqus_shortname = config.get('DISQUS_ID');
                    disqus_identifier = _this.id;
                    disqus_url = document.URL;         
                    disqus_title = _this.bookObj.get('content').title;

                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();

                }
            });
        },
    });

    return App.Models.Disqus;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T22:35:14.010

正如[DISQUS.reset 文档](http://help.disqus.com/customer/portal/articles/472107)所述，您需要重置 Disqus 线程的标识符和 URL。这是通过文档中提供的两个变量完成的：`this.page.identifier`和`this.page.url`. 现在，您正在 Disqus 中重置页面标题和语言。请尝试重置标识符和 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T09:17:59.220

我也遇到了这个问题，但是上面的解决方案（删除 DISQUS 并在页面上重新加载脚本）在严格模式下不起作用。尝试删除 DISQUS 会导致错误“Delete of an unqualified identifier in strict mode”。

我通过确保我永远不会删除 Disqus 附加到的容器来解决这个问题，这是我在用通过 ajax 新加载的帖子交换帖子时所做的。奇怪的是它在没有这个修复的情况下在 Firefox 中工作，但现在它在任何地方都可以工作。

# ios - UITableView 在不可见时不重新加载数据？

> ID：12976598
> 
> 赞同：0
> 
> 时间：2012-10-19T14:40:16.883
> 
> 标签：ios, uitableview, uiscrollview

我对此感到困惑。我有一个 UIScrollView，里面放了 4 个 tableView。

整个东西用于允许水平滚动和切换 tableViews，如 Groupon 应用程序。

一旦您开始滚动第 4 个（左或右）tableView，就会在 scrollView 中移动，并在该 tableView 上启动 reloadData，因此它将从该类别的数据源加载数据。

但是，当我滚动到该 tableView 时，它仍然具有上一个类别的数据，这意味着单元格没有被刷新。

任何人都可以解释为什么会这样吗？

我只是猜测，因为当我调用 reloadData 命令时 tableView 不在可见框架中，tableView 中没有发生实际绘图（数据源方法正在正常调用，但没有绘图发生）。

任何想法或提示？

# c# - 从外部服务引用日期格式时，有没有办法转换日期格式？

> ID：12976600
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:40:22.370
> 
> 标签：c#, asp.net-mvc, wcf, date-formatting

我正在尝试将日期从 转换`19/10/2012 00:00:00`为`19/10/2012`。我不能像[这里](https://stackoverflow.com/questions/4679352/converting-datetime-format-using-razor)一样在视图模型中声明日期类型，因为代码如下：

视图模型：

```
public Appointment Appointment {get; set;} 
```

我知道映射是一个选项，但想看看是否有替代选项可用，因为这将使重用代码更容易，如果服务发生变化，那么映射会使事情复杂化。

模拟服务示例：

```
public class Appointment
    {
        [DataMember]
        public DateTime AppointmentDate { get; set; }  
        [DataMember]
        public Identifier AppointmentIdentifier { get; set; }
        [DataMember]
        public string Location { get; set; }
        [DataMember]

    ...etc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:44:46.223

我的解决方案是您定义一个像 _AppointmentDate 这样的字段，然后在其属性中返回您想要的任何日期格式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:57:11.413

您是否尝试过将其`AppointmentDate`作为字符串返回，然后将其转换回`DateTime`？

# sql - 如何运行从表单传递信息的查询？

> ID：12976605
> 
> 赞同：0
> 
> 时间：2012-10-19T14:40:44.013
> 
> 标签：sql, ms-access, vba

我想这是一个愚蠢的问题，但我在解决这个问题时遇到了问题。

我有两张表，其中包含用于制作报告的大量信息。

我有一个连接这两个表的查询。

相同的查询添加了两个简单的过滤器：日期范围和 ID 检查器。

报告应该使用具有特定 ID 的日期范围打印。

每次我需要更改查询数据范围时，我都需要手动编辑它并更改参数。

如何制作表单并将此信息传递给查询，这样我就不必每周手动更新查询？

我制作了一个带有两个日期字段的新表单，我需要一些代码在打开查询之前将此信息传递给查询，但[`DoCmd.OpenQuery Method`](http://msdn.microsoft.com/en-us/library/office/bb238028%28v=office.12%29.aspx)不允许我传递任何信息。

理想情况下，我更喜欢使用 SQL 命令来设置查询然后打开它，这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:00:03.600

实际上，我经常使用这种方法：
在模块中声明变量并为每个简单地返回值的函数编写一个函数。然后您可以在查询设计器中使用函数调用（例如条件 = `Between getMyValue1() AND getMyValue2()`）然后您可以在打开查询之前设置全局变量。（这对我来说比查询参数或直接引用查询中的表单字段效果更好。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:46:57.233

使用过滤器打开报告：

```
Dim sWhere as String
sWhere = "Tbl_Swift.Data >= #10/01/2012# AND Tbl_Swift.Data <= #10/10/2012#"
DoCmd.OpenReport "rptMyReportName", acViewPreview, ,sWhere 
```

（我不确定“BETWEEN”是否会起作用，尽管我认为如果你写得正确的话它应该会起作用。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:52:34.607

您还可以在查询中放置一个引用表单中字段的条件：

```
SELECT ... WHERE ID = [Forms]![FormName]![TextField] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:47:35.113

你有两个选择。

1.  不要将参数的值放在查询中。Access 将始终在每次执行查询时询问这些值。

2.  使用 DATE() 函数获取当前日期并相应地计算周的开始和结束。这样，您将永远不必提供日期。

# c# - 如何为外部应用程序窗口设置自定义鼠标光标？

> ID：12976607
> 
> 赞同：0
> 
> 时间：2012-10-19T14:40:46.083
> 
> 标签：c#, .net, windows, cursor, unity3d

我有“process_name.exe”并想为该进程的主窗口设置一个自定义光标（这不是一个 .net 托管应用程序）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:55:34.880

您不能更改其他应用程序的光标。每个应用程序都控制其光标。想象一下，如果有人四处更改您的应用程序的光标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T20:59:11.393

Unity 4 将支持硬件光标（现在在 Unity 4 beta 中可用），所以如果您可以等待，不要太担心 3.5 软件光标问题。

来自[http://unity3d.com/unity/beta/notes](http://unity3d.com/unity/beta/notes)：

> *   引入了新的 Cursor API：
>     *   游标 API 支持软件和硬件游标。
>     *   支持以下平台上的硬件光标：Windows、Mac OS X、Linux、Flash。
>     *   在项目的播放器设置中配置默认​​光标。

或者，如果您立即需要解决方案，我相信 Unity Asset Store 目前正在出售硬件光标脚本。

# java - 使用连接构造函数创建的套接字的连接超时是多少？

> ID：12976608
> 
> 赞同：4
> 
> 时间：2012-10-19T14:40:50.013
> 
> 标签：java, sockets, ambiguity

使用连接构造函数创建的套接字的连接超时是多少？

在 Java SE 6 中，以下 Socket 构造函数将立即连接套接字，而不必在构造后对其调用 connect：

*   `Socket(InetAddress address, int port)`
*   `Socket(InetAddress host, int port, boolean stream)`
*   `Socket(InetAddress address, int port, InetAddress localAddr, int localPort)`
*   `Socket(String host, int port)`
*   `Socket(String host, int port, boolean stream)`
*   `Socket(String host, int port, InetAddress localAddr, int localPort)`

尽管 Java SE 人员创建了 500 种构造套接字的方法既方便又好用，因此您只需浏览 500 种方法即可找到符合您要求的方法（而不是调用`new Socket()`后跟`Socket#connect()`），但没有一个这些构造函数的文档说明了连接超时是什么或它们是否/如何调用`connect(SocketAddress endpoint, int timeout)`。

也许构造函数文档中谈论的内容`createSocketImpl`暗示了超时，或者其他地方的一些文档说了什么？

任何人都知道这些构造函数的实际连接超时是多少？

* * *

背景：好的，假设规范确实模棱两可（我认为 Java 是可移植的？），我试图弄清楚为什么客户的代码在看似随机的时间冻结。我有一些代码调用了一些调用这些构造函数之一的开源库。我想知道调用这些构造函数之一是否会使超时无限或很长。我不知道客户使用的是什么版本的 JDK，所以如果规范在某处说超时，那就太好了。我想我可能可以从我的客户那里获得 JDK 版本，但它可能是闭源 JDK。在那种情况下，我可以对他们版本的 SE 库中的代码进行逆向工程以找出答案吗？难吗？我会进监狱吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:28:28.207

Java 规范是假的。它没有说明任何这些构造函数的超时时间，因此实现可以将超时设置为 0.000000000001 纳秒并且仍然是正确的。此外：非有限超时甚至不受 vm 实现的尊重（如此处所示），因此看起来规范甚至无关紧要，因为没有人遵循它。

结论：您必须阅读客户 JVM 的封闭源代码二进制文件（可能是非法的，但您必须做您必须做的事情），还有 OS 套接字文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:37:03.563

尽管 Java 文档说超时是无限的，但这实际上意味着 JVM 不会对连接操作施加任何超时，但是操作系统可以自由地对任何套接字操作施加超时设置。

因此，实际超时将取决于您的操作系统的 TCP/IP 层设置。

一个好的编程习惯是为所有套接字操作设置超时，最好通过配置文件进行配置。使其可配置的优势在于，根据部署环境的网络负载，可以调整超时，而无需重新构建/重新测试/重新发布整个软件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T15:00:43.313

根据消息来源（我在这里查看 1.5_13，但应该没有区别），不同的 Socket 构造函数都调用`Socket(SocketAddress, SocketAddress, boolean)`，定义为：

```
private Socket(SocketAddress address, SocketAddress localAddr,
           boolean stream) throws IOException {
    setImpl();

    // backward compatibility
    if (address == null)
        throw new NullPointerException();

    try {
        createImpl(stream);
        if (localAddr == null)
        localAddr = new InetSocketAddress(0);
        bind(localAddr);
        if (address != null)
        connect(address);
    } catch (IOException e) {
        close();
        throw e;
    }
} 
```

`connect(SocketAddress)`定义为

```
public void connect(SocketAddress endpoint) throws IOException {
    connect(endpoint, 0);
} 
```

因此，无限超时（正如@Keppil 已经说过的那样）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-19T14:52:50.760

查看[`code of Socket in OpenJDK 6-b14`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/net/Socket.java)，可以看到这些构造函数调用`connect(socketAddress, 0)`，这意味着一个无限的超时值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-19T20:58:45.100

它取决于平台，但大约需要一分钟。connect() 的 Javadoc 声明它是无限的是不正确的。另请注意，connect() 超时参数只能用于减少默认值，而不能增加它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-19T15:44:41.217

Socket 类从 Java 1.0 开始就存在，但当时只能创建套接字，这些套接字会立即连接，并且无法指定连接超时。从 Java 1.4 开始，可以创建未连接的套接字，然后使用 connect 方法指定超时。我假设有人只是忘记澄清“旧”构造函数的文档，指定它们仍然在没有明确超时的情况下运行。

带有超时参数的连接方法的文档显示“超时为零被解释为无限超时”。这实际上也是不正确的，因为它只意味着 Java VM 没有暗示超时。即使超时为 0，连接操作仍可能在操作系统的 TCP/IP 堆栈中超时。

# arrays - 算法 - 找到中心索引

> ID：12976612
> 
> 赞同：2
> 
> 时间：2012-10-19T14:41:13.743
> 
> 标签：arrays, algorithm, sum, big-o

给定一个大小为 int 的数组`t`，需要找到中心索引。中心索引`x`是整数（0 到 x-1）之和等于和（x+1 到 t-1）的索引。

我能想到的最好的算法是 O(n)。

我将有一个临时数组，其中包含之前所有整数的总和（不包括索引 x 处的整数）：因此在索引 1 处它将是 1，在 2 处它将是 2 和 1 的总和，依此类推。

另一个 int 将是所有 int 的总和。

我会在数组中循环两次，第一次是临时数组，另一个是查找两个部分是否相等。

有没有更好的算法 O(logn)？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:07:39.577

由于您必须计算数组的一半的总和，因此无法在小于`O(n)`. 因为您必须至少检查每个元素一次（以计算总和）。只有当我们可以根据某些条件跳过检查数组中的某些元素时，任何算法都可以`logn`，这在此处是不可能的。

# java - 线程“main”中的异常 java.lang.NoClassDefFoundError: org/apache/log4j/Layout - While Runnig JAR from Command Prompt

> ID：12976618
> 
> 赞同：0
> 
> 时间：2012-10-19T14:41:29.467
> 
> 标签：java, command-line, jar, log4j

我正在尝试从命令提示符运行一个 jar 文件。对于我尝试过的所有以下组合，我不断收到上述错误。

```
java -jar Mater.jar
java -cp ".:log4j-1.2.16.jar" -jar Mater.jar
java -cp log4j-1.2.16.jar -jar Mater.jar 
```

我提取了 log4j-1.2.16.jar 以查看 Layout 是否在我引用的 jar 中并且它在那里。

我已经使用 Eclipse IDE“导出 jar 选项”创建了 jar，这是我的清单文件。

```
Manifest-Version: 1.0
Main-Class: TestController

Class-Path: apache-mime4j-0.6.jar bsh-1.3.0.jar cglib-nodep-2.1_3.jar commons-beanutils-1.8.0.jar commons-codec-1.6.jar 

Class-Path: commons-collections-3.2.1.jar commons-exec-1.1.jar commons-io-2.0.1.jar commons-jxpath-1.3.jar commons-logging-1.1.1.jar 

Class-Path: cssparser-0.9.5.jar derbyclient.jar dom4j-1.1.jar eclipselink-2.0.0.jar flash-selenium.jar guava-12.0.jar hamcrest-core-1.1.jar 

Class-Path: htmlunit-2.9.jar htmlunit-core-js-2.9.jar httpclient-4.1.3.jar httpcore-4.1.3.jar httpmime-4.1.3.jar ini4j-0.5.2.jar 

Class-Path: javax.persistence-2.0.0.jar jcommander-1.13.jar jna-3.4.0.jar jna-platform-3.4.0.jar 

Class-Path: json-20080701.jar junit-dep-4.10.jar logging-selenium-1.2.jar mail.jar mysql-connector-java-5.0.7-bin(2).jar 

Class-Path: nekohtml-1.9.15.jar netty-3.2.7.Final.jar operadriver-0.14.jar 
poi-3.6-20091214.jar poi-ooxml-3.6-20091214.jar poi-ooxml-schemas-3.6-20091214.jar 

Class-Path: protobuf-java-2.4.1.jar sac-1.3.jar saxon-8.7.jar SaxonLiaison.jar selenium-java-2.25.0.jar selenium-java-2.25.0-srcs.jar 

Class-Path: selenium-java-client-driver.jar selenium-java-client-driver-sources.jar selenium-java-client-driver-tests.jar 

Class-Path: selenium-java-client-driver-test-sources.jar selenium-server.jar selenium-server-coreless.jar 

Class-Path: selenium-server-sources.jar serializer-2.7.1.jar testng.jar testng-6.0.1-nobsh-noguice.jar testng-xslt-maven-plugin-test-0.0.jar 

Class-Path: validation-api-1.0.0.GA.jar webbit-0.4.8-SNAPSHOT.jar xalan-2.7.1.jar xercesImpl-2.9.1.jar xml-apis-1.3.04.jar xmlbeans-2.3.0.jar log4j-1.2.8.jar 
```

我已经交叉检查了类路径是否在 jar 中使用正确设置

**jar tf Mater.jar**

它在命令提示符下正确显示 jar 中的所有文件..

任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T13:32:05.900

我有一个类似的问题，同样的 NoClassDefFoundError，在这里：[NoClassDefFoundError after update to Java 7](https://stackoverflow.com/questions/12371014/noclassdeffounderror-after-updating-to-java-7)

我无法解释原因，但我发现的唯一可行的解​​决方案是使用 Eclipse 导出为可运行的 JAR

# shell - 批量读取部分xml文件

> ID：12976621
> 
> 赞同：0
> 
> 时间：2012-10-19T14:41:37.890
> 
> 标签：shell, scripting, batch-file, command

我正在尝试制作一个批处理文件以从文件中提取数据并将其设置为变量。

棘手的部分是我需要读取一个 XML 文件，我只需要下一行引号之间的数据......

```
narrative="I only need this text here" 
```

该行中的文本还可以包含空格、括号、斜杠、破折号和冒号。

**示例 XML 文件**：

```
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
    <cadcall>
        <call callnumber="123456" jurisdiction="abcd" department="dept 1" complaint="cost" priority="M" calltencode="" callername="Persons Name" phonenumber="Cell Number HERE" narrative="[10/02/2012 14:56:27 : pos9 : PERSON] Fairly long narrative here describing issue of dispatch, but sometimes these can be short." alarmtype="" ocanumber="0000000000" disposition1="TRAN" />
    </cadcall> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:43:53.307

执行此操作的正确工具是`xmllint`，`libxml`请提供一个更完整的 XML 示例，我将告诉您如何`Xpath`在您的`XML`.

**编辑**：

这里有一个使用 Xpath 的解决方案（有点 hack : `contains`）：

```
xmllint --xpath '/cadcall/call/@narrative[contains(.,'.')]' file.xml 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:52:45.393

仅根据您的示例行，没有看到完整的输入。grep 为你工作。

```
kent$  echo 'narrative="I only need this text here"'|grep -Po '(?<=narrative=")[^"]*'
I only need this text here 
```

# android - 将试用版升级到完整版

> ID：12976622
> 
> 赞同：3
> 
> 时间：2012-10-19T14:41:40.160
> 
> 标签：android, sharedpreferences, trial

我想发布我的应用程序的试用版。在这个应用程序中，用户必须在 sharedPreferences 中保存很多值。如果他决定购买完整版，是否会卸载试用版，并且将 sheredPreferences 也删除？有人知道吗？

如果sharedPreferences不被删除，那就太好了，这样完整版就可以访问试用版的值，因此用户不必再次保存所有值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:45:27.497

是的，SharedPreferences 在卸载试用版并安装完整版时会被删除。

我看到一些您可以使用的选项，要么对两者使用相同的应用程序，要么使用解锁方式购买，要么通过应用程序内购买，要么通过销售单独的“解锁”应用程序。

您可以将他们的设置保存到远程服务器，并让完整的应用程序从那里下载它们。这个的优点是允许跨多个设备同步设置，缺点是您必须制作和维护服务器。

您可以将它们保存到设备上的其他一些永久文件中，但我个人讨厌当我卸载它时应用程序留下一些东西时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:02:21.693

是否可以将具有较低版本代码的试用版发布为完整版，因此只会更新试用版并且不会删除 sharedPreferences？

# bash - 带有管道的Bash for循环语法错误

> ID：12976625
> 
> 赞同：4
> 
> 时间：2012-10-19T14:41:46.410
> 
> 标签：bash

我正在尝试这个命令

```
for x in qstat -u '*' | grep Eqw | awk {'print $1'}; do qmod -cj $x; done 
```

并最终出现此错误：

```
-bash: syntax error near unexpected token `|' 
```

我尝试将 qstat 命令用各种引号和方括号括起来，但无济于事，我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T14:45:06.950

由于您似乎想遍历结果，因此将其更改为：

```
for x in `qstat -u '*' | grep Eqw | awk {'print $1'}`; do qmod -cj $x; done 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T14:46:19.233

优化版本将是：

```
for x in $(qstat -u '*' | awk '/Eqw/{print $1}'); do qmod -cj "$x"; done 
```

*   反引号 (`) 用于旧式命令替换。建议使用 foo=$(command) 语法。$() 内的反斜杠处理不那么令人惊讶，并且 $() 更容易嵌套。见[http://mywiki.wooledge.org/BashFAQ/082](http://mywiki.wooledge.org/BashFAQ/082)
*   `awk`可以自己 grep

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:46:34.710

请改用此脚本：

```
for x in $(qstat -u * | awk '/Eqw/ {print $1}')
do
    qmod -cj $x
done 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:46:47.610

它应该是：

```
for x in $(qstat -u '*' | grep Eqw | awk '{print $1}'); do qmod -cj $x; done 
```

# php - 无法将数据插入数据库（PHP MVC）

> ID：12976634
> 
> 赞同：0
> 
> 时间：2012-10-19T14:42:29.107
> 
> 标签：php, codeigniter

我想允许人们通过将其输入到一个字段来提交他们的联系人，它最终会将其发送到数据库，但已经尝试了很长一段时间并且无法找出它有什么问题，如果可能的话，请让我知道如何返回当它在数据库中时，一个回声说“SENT”。如果可能的话，重定向到同一页面，甚至不需要刷新即可将该 SENT 显示给人们。

这是我的控制器

```
 $this->config->db_config_fetch();
$this->load->model('skills_model');

//Get Form Data    
$this->input->post('submitsms')  ;
//GEt phone number from field
$type = $this->input->post('phonenumber');
//Call model
$this->skills_model->addsms($type);
} 
```

这是我的观点@主页

```
 <form method="post" action="<?php echo site_url(''); ?>" name="form"  enctype="multipart/form-data">
  <label>SMS Subscription</label>
  <input type="text" name="phonenumber" placeholder="Phone Number here">      
  <button class="btn btn-info" name="submitsms"  type="submit">Subscribe</button>
  </form> 
```

这是我的模特

```
function addsms($type){
     $this->db->set('number', $type); 
     $this->db->insert('subscribers');
 } 
```

我还尝试了以下

```
function addsms($type){     
    $sql = "INSERT INTO 'subscribers' ('number') VALUES ($type)";
    $this->db->query($sql);
    echo $this->db->affected_rows();
 } 
```

你的建议会有很大帮助！谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:49:52.463

一个小例子............

查看文件

```
<form action="<?php echo ROOT_FOLDER ?>/add_price" method="post">

<input type="text" class="text" name="amount" value="<?php echo set_value('amount'); ?>" />

<input type="submit" class="submit" value="Approve" /> 
</form> 
```

控制器...........

```
public function post_add_price()
{
  $data = array(
'amount'=>$this->input->post('amount'),
 );
$this->model->add_amount($data);  //sending amount to model to insert in dataabse
echo "Amount added to database";
} 
```

模型................

```
public function add_amount($data)
{
    $this->insert_helper('order_amount_table',$data);
}

public function insert_helper($table_name, $data_array){
    $this->db->insert($table_name,$data_array);
    return $this->db->insert_id();

} 
```

我希望这个例子对你有帮助......如果你有任何疑问，问

# sql - 重命名包含空格的列

> ID：12976637
> 
> 赞同：2
> 
> 时间：2012-10-19T14:42:42.513
> 
> 标签：sql, postgresql

有人错误地创建了一个表，其中所有列名都有一个前导空格。例如：“accountid”现在是“accountid”。

我将编写一条 SQL 语句来重命名这些列。我写的是：

```
ALTER TABLE mytable RENAME COLUMN ' accountid' TO 'accountid'; 
```

但是，我收到以下错误：

```
Error : ERROR:  syntax error at or near "' accountid'" 
```

有人可以指导我如何重命名这些吗？如何更改我的语句以使其可运行？我使用 PostgreSQL。

非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-19T14:46:39.497

在 PostgreSQL 中，您使用双引号作为标识符（如果需要）：`"`

```
ALTER TABLE mytable RENAME COLUMN " accountid" TO "accountid"; 
```

[请参阅此处并浏览至 4.1.1](http://www.postgresql.org/docs/current/interactive/sql-syntax-lexical.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-10T19:51:30.657

您甚至可以放置其他字符：

```
select c.comment "actor.comment"  from post p join comment c on p.id = c.post_id; 
```

# javascript - 我如何知道 Lat、Lng 点是否有街景？

> ID：12976638
> 
> 赞同：1
> 
> 时间：2012-10-19T14:42:46.907
> 
> 标签：javascript, google-maps

这是我的 JavaScript 代码

```
Description += "<br><span class='descr'>Coordinate:</span> <span class='cont'><a href=\"" + mapsLink + "\" onclick=\"window.open('" + mapsLink + "')\">" + picRecords[index].getCoords() + "</span></a>"; 
```

和

```
var mapsLink = "https://maps.google.it/maps?q=" + picRecords[index].getLatitude() + "," + picRecords[index].getLongitude(); 
```

我希望如果一个点（getLatitude，getLongitude）打开街景，onClick 上的另一个链接。

我必须为此使用一些 Google Maps API 吗？哪一个 ？

谢谢回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:06:13.787

是的，您必须为此使用 Google Maps API

[https://developers.google.com/maps/documentation/javascript/streetview#StreetViewService](https://developers.google.com/maps/documentation/javascript/streetview#StreetViewService)

getPanoramaByLocation() 函数会告诉您附近是否有全景图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-20T10:23:39.977

什么barryhunter说。这是我的做法。我有一个空的 div 已经可以看到街道地图进入。然后，如果街道地图不可用，我会隐藏 div：

```
function createStreetMap(strMapCanvasID, intLat, intLong) {
    var streetViewLocation = new google.maps.LatLng(intLat, intLong);
    var panorama;
    var sv = new google.maps.StreetViewService();
    sv.getPanoramaByLocation(streetViewLocation, 50, function (data, status) {
        if (status == 'OK') {
            var panoramaOptions = {
                pano: data.location.pano,
                addressControl: false,
                navigationControl: true,
                navigationControlOptions: {
                    style: google.maps.NavigationControlStyle.SMALL
                }
            };
            var panorama = new google.maps.StreetViewPanorama(document.getElementById(strMapCanvasID), panoramaOptions);
        } else {
            $('#' + strMapCanvasID).parent().hide();
        }
    });
    return panorama;
} 
```

然后我做：

```
$(document).ready(function() {
    var myPano = createStreetMap('streetView', 41.3884810185, 2.13370800018);
}); 
```

# c# - XmlWriter 使命名空间不正确

> ID：12976643
> 
> 赞同：1
> 
> 时间：2012-10-19T14:42:54.833
> 
> 标签：c#, xml

我有个问题。我编写了一个程序，可以将大量数据转换为`VML-GML`格式。问题是我需要使用`XmlWriter`......现在我的方法有问题：

```
private void StartDocument()
{
    _writer.WriteStartDocument();
    _writer.WriteStartElement("osgb", "FeatureCollection", "osgb");
    _writer.WriteAttributeString("osgb", "xmlns", "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1");
    _writer.WriteAttributeString("gml", "xmlns", "http://www.opengis.net/gml");
    _writer.WriteAttributeString("xsi", "xmlns", "http://www.w3.org/2001/XMLSchema-instance");
    _writer.WriteAttributeString("schemaLocation", "xsi",
                                 "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1 http://www.ordnancesurvey.co.uk/oswebsite/xml/cmdschema/local/V1.1/CMDFeatures.xsd");
    _writer.WriteAttributeString("fid", ""); // TODO: set fid here

    _writer.WriteStartElement("gml", "description", "gml");
    _writer.WriteValue("Ordnance Survey, (c) Crown Copyright. All rights reserved, 2011-03-02");
    _writer.WriteEndElement(); // description

    _writer.WriteElementString("osgb", "creationDate", "osgb", DateTime.Today.ToString("yyyy-MM-dd"));
} 
```

如何正确写入命名空间？我这样做了，输出是：

```
<?xml version="1.0" encoding="utf-8"?>
<osgb:FeatureCollection p1:osgb="http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1" 
p1:gml="http://www.opengis.net/gml"
p1:xsi="http://www.w3.org/2001/XMLSchema-instance" 
p2:schemaLocation="http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1 http://www.ordnancesurvey.co.uk/oswebsite/xml/cmdschema/local/V1.1/CMDFeatures.xsd"
fid="" xmlns:p2="xsi" xmlns:p1="xmlns" xmlns:osgb="osgb"> 
```

这就是我需要的：

```
<osgb:FeatureCollection xmlns:osgb="http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1"
xmlns:gml="http://www.opengis.net/gml"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1 http://www.ordnancesurvey.co.uk/oswebsite/xml/cmdschema/local/V1.1/CMDFeatures.xsd"
fid=""> 
```

为什么那个愚蠢的人会`XmlWriter`创造像`p1`,`p2`等这样的东西？

顺便提一句。我试图在使用这些`VML-GML`文件的程序中打开我的输出文件，它告诉我文件格式错误。当我手动将命名空间更改为正确的命名空间时，一切都很好。

如何纠正它？提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T14:45:15.303

> 为什么那个愚蠢的 XmlWriter 会创建像 p1、p2 等这样的东西？

你的属性值是错误的，你还需要指定另一个参数：

这个：

```
_writer.WriteAttributeString("gml", "xmlns", "http://www.opengis.net/gml"); 
```

应该是这样的：

```
_writer.WriteAttributeString("xmlns", "gml", null, "http://www.opengis.net/gml"); 
```

此外，您的元素编写代码不正确。当您应该指定命名空间 URI 时，您正在指定前缀。

我相信这可以满足您的需求：

```
_writer.WriteStartDocument();
// The first argument here isn't really needed, but is changes whether a
// prefix is used or not
_writer.WriteStartElement("osgb", "FeatureCollection", "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1");
_writer.WriteAttributeString("xmlns", "osgb", null, "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1");
_writer.WriteAttributeString("xmlns", "gml", null, "http://www.opengis.net/gml");
_writer.WriteAttributeString("xmlns", "xsi", null, "http://www.w3.org/2001/XMLSchema-instance");
_writer.WriteAttributeString("schemaLocation", "http://www.w3.org/2001/XMLSchema-instance",
                             "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1 http://www.ordnancesurvey.co.uk/oswebsite/xml/cmdschema/local/V1.1/CMDFeatures.xsd");
_writer.WriteAttributeString("fid", ""); // TODO: set fid here

_writer.WriteStartElement("description", "http://www.opengis.net/gml");
_writer.WriteValue("Ordnance Survey, (c) Crown Copyright. All rights reserved, 2011-03-02");
_writer.WriteEndElement(); // description

_writer.WriteElementString("creationDate", "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1", DateTime.Today.ToString("yyyy-MM-dd"));
_writer.WriteEndElement(); 
```

（我个人会使用 LINQ to XML，这让这一切*变得*更简单，但是嘿......）

作为提示，始终假设*您的*代码是错误的，而不是框架代码，作为起点。将框架类视为“愚蠢”可能会导致您没有足够小心地查看自己的代码。

编辑：这是工作 LINQ to XML 代码：

```
using System;
using System.Xml.Linq;

static class Test
{
    static void Main()
    {
        XNamespace osgb = "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1";
        XNamespace gml = "http://www.opengis.net/gml";
        XNamespace xsi = "http://www.w3.org/2001/XMLSchema-instance";

        var doc = new XDocument(
            new XElement(osgb + "FeatureCollection",
               new XAttribute(XNamespace.Xmlns + "osgb", osgb),
               new XAttribute(XNamespace.Xmlns + "gml", gml),
               new XAttribute(XNamespace.Xmlns + "xsi", xsi),
               new XAttribute(xsi + "schemaLocation", "http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1 http://www.ordnancesurvey.co.uk/oswebsite/xml/cmdschema/local/V1.1/CMDFeatures.xsd"),
               new XAttribute("fid", ""),
               new XElement(gml + "description", "Ordnance Survey ..."),
               new XElement(osgb + "creationDate",
                            // TODO: Find a better way of doing this
                            DateTime.Today.ToString("yyyy-MM-dd"))));
        Console.WriteLine(doc);
   }
} 
```

输出：

```
<osgb:FeatureCollection
    xmlns:osgb="http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1" 
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://namespaces.ordnancesurvey.co.uk/cmd/local/v1.1 http://www.ordnancesurvey.co.uk/oswebsite/xml/cmdschema/local/V1.1/CMDFeatures.xsd"
    fid="">
  <gml:description>Ordnance Survey ...</gml:description>
  <osgb:creationDate>2012-10-19</osgb:creationDate>
</osgb:FeatureCollection> 
```

# bash - Linux 守护进程等待套接字连接

> ID：12976645
> 
> 赞同：1
> 
> 时间：2012-10-19T14:42:58.753
> 
> 标签：bash, sockets, daemon

我想创建一个简单的 Linux 守护进程，它将...

*   在 localhost 和指定端口上打开一个 tcp/ip 服务器套接字
*   等待连接
*   有人连接后，它将从客户端的套接字中读取第一行（以 结尾`\n`）
*   如果该行是`foo`，它将运行命令`bar`
*   命令完成后`bar`（或者如果该行不是`foo`），守护程序将等待另一个连接并执行相同的操作（在无限循环中）...

可以用bash写这个吗？（如何？）

另外，我希望能够`service my-foobar-daemon start / stop`（在 Ubuntu 上）启动和停止脚本，我该怎么做？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:34:57.243

以下代码段使用`bash`and`nc`来实现要求：

```
#! /bin/bash
while true; do
    coproc nc -l -p 8080
    if read -u "${COPROC[0]}" line; then
        case "$line" in
            foo)
                bar
                ;;
            *)
                echo "$line: unknown command" >&2
                ;;
        esac
    fi
    kill "$COPROC_PID"
    wait "$COPROC_PID"
done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-08T07:48:12.583

```
#! /bin/bash
coproc nc -l -p 8080
while true; do
    if read -u "${COPROC[0]}" line; then
        case "$line" in
            foo)
                bar
                break
                ;;
            *)
                echo "$line: unknown command" >&2
                ;;
        esac
    fi
done
kill "$COPROC_PID" 
```

# python - 在 Google App Engine 中进行大型 IN 查询的有效方法？

> ID：12976652
> 
> 赞同：3
> 
> 时间：2012-10-19T14:43:08.363
> 
> 标签：python, google-app-engine

用户在他的移动设备上访问他的联系人。我想将所有电话号码（比如 250）发回服务器，然后查询任何具有匹配电话号码的用户实体。

用户有一个被索引的电话字段。所以我这样做`User.query(User.phone.IN(phone_list))`了，但我只是看了 AppStats，这该死的贵吗？这一次操作花费了我 250 次读取，这是我希望用户经常做的事情。

有哪些替代方案？我想我可以将 User 实体的 id 值设置为他的电话号码（即在创建用户时我会这样做`user = User(id = phone_number)`），然后通过键直接获取`ndb.get_multi(phones)`，但我也想对电子邮件执行相同的查询。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:37:00.100

您可以像这样创建一个 PhoneUser 模型：

```
from google.appengine.ext import ndb

class PhoneUser(ndb.Model):
  number = ndb.StringProperty()
  user = ndb.KeyProperty()

class User(ndb.Model):
  pass

u = User()
u.put()

p = PhoneUser(id='123-456-7890', number='123-456-7890', user=u.key)
p.put()

u2 = User()
u2.put()

p2 = PhoneUser(id='555-555-5555', number='555-555-5555', user=u2.key)

result =  ndb.get_multi([ndb.Key(PhoneUser, '123-456-7890'), ndb.Key(PhoneUser, '555-555-5555')]) 
```

我认为这在这种情况下会起作用。每当您更新用户时，您只需添加/删除您的 PhoneUser 模型。您可以使用 post hooks 做到这一点：[https ://developers.google.com/appengine/docs/python/ndb/modelclass#Model__post_delete_hook](https://developers.google.com/appengine/docs/python/ndb/modelclass#Model__post_delete_hook)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T18:32:24.017

我误解了你的问题的一部分，我以为你发出的查询是给你 250 个实体。

我知道现在的问题是什么，您正在发出一个包含 250 个电话号码列表的 IN 查询，在幕后，数据存储实际上正在执行 250 个单独的查询，这就是您获得 250 个读取操作的原因。

我想不出办法来避免这种情况。我建议避免搜索一长串电话号码。这似乎是您只需要做一次的事情，即用户第一次使用该手机登录时。尝试找到一些方法来存储结果并避免再次查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-28T01:05:03.147

没有有效的方法来进行 IN 查询。因此，请避免一起使用。

如何？

反转查询，而不是查找属于*此*人电话列表的所有人。

尝试

*查找所有在他们的*列表中有此用户 phoneid 的人。

然而，这并非没有一些额外的费用。每个用户的电话清单都可以存储和索引。

```
class User(ndb.Model):
  phoneList = ndb.PropertyList()
  phone_id= ndb.StringProperty()

select from where User.phoneList = :this_phone_number 
```

# android - PhoneGap Android + jQuery 移动应用不向下滚动

> ID：12976657
> 
> 赞同：0
> 
> 时间：2012-10-19T14:43:20.077
> 
> 标签：android, ios, css, cordova, jquery-mobile

我有一个在触摸时展开的 div，但是当它展开时它不会滚动到展开的部分。我注意到运行 2.3.3 的 Android 设备存在此问题，这也发生在较旧的 Iphone 上。我很确定这是一个 CSS 问题。

有谁有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T21:12:34.843

老款安卓手机和老款IOS不支持在div中滚动：使用这个函数来滚动你想要滚动的元素：

```
function TouchScroll(elem){ 
```

// 警报（“正在听”）；

```
var scrollStartPos=0;

elem.addEventListener("touchstart", function(event) {

                      scrollStartPos=this.scrollTop+event.touches[0].pageY;

                      // event.preventDefault();

                      },false);

elem.addEventListener("touchmove", function(event) {

                      this.scrollTop=scrollStartPos-event.touches[0].pageY;

                       event.preventDefault();

                      },false); 
```

}

# actionscript-3 - 如何根据变量更改 TextArea 的 htmlText？

> ID：12976658
> 
> 赞同：0
> 
> 时间：2012-10-19T14:43:19.733
> 
> 标签：actionscript-3, flash, textarea, mxml

假设您想使用单个标签，其文本根据变量的值实时变化，这在 AS3 中很容易做到。但是，假设您希望部分文本采用常规字体粗细，而您希望另一部分采用粗体。我假设一个带有 htmlText 值的 TextArea 是必要的，以维护单个标签中的粗体/非粗体部分，但我不知道如何根据变量使那里的数据发生变化，就像你可以用一个普通的文本属性。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:28:50.743

```
var firstPart:String = "someText";
var boldPart:String = "this is bold";
text.htmlText = firstPart + "<b>" + boldPart + "</b>"; 
```

您还可以使用[setTextFormat](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html#setTextFormat%28%29)使文本字段中的部分文本变为粗体：

```
var tf:TextFormat = new TextFormat();
tf.bold = true;
textField.setTextFormat(tf,10,20); // makes chars from 10 to 20 bold 
```

# java - SpringBatch CommandLineJobRunner -next 使用旧的 run.id

> ID：12976662
> 
> 赞同：1
> 
> 时间：2012-10-19T14:43:29.607
> 
> 标签：java, spring, spring-batch

我们正在使用 CommandLineJobRunner 来执行 Spring Batch 作业。我们在命令行上使用 -next：

```
java -Dlog4j.configuration=file:./prop/log4j.properties -Dlogfile=logfile_load_data -jar EtlLoadData.jar loaddata_etl_config.xml loaddata_etl_job -next 
```

我们开始出现错误：

```
Job Terminated in error: A job instance already exists and is complete for parameters={run.id=10}.  If you want to run this job again, change the parameters. 

org.springframework.batch.core.repository.JobInstanceAlreadyCompleteException: A job instance already exists and is complete for parameters={run.id=10}.  If you want to run this job again, change the parameters.
    at  org.springframework.batch.core.repository.support.SimpleJobRepository.createJobExecution(SimpleJobRepository.java:122)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.batch.core.repository.support.AbstractJobRepositoryFactoryBean$1.invoke(AbstractJobRepositoryFactoryBean.java:168)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
at $Proxy14.createJobExecution(Unknown Source)
at org.springframework.batch.core.launch.support.SimpleJobLauncher.run(SimpleJobLauncher.java:111)
at org.springframework.batch.core.launch.support.CommandLineJobRunner.start(CommandLineJobRunner.java:349)
at org.springframework.batch.core.launch.support.CommandLineJobRunner.main(CommandLineJobRunner.java:574) 
```

我认为如果您使用该`-next`选项运行，这应该不是问题。有任何想法吗？

作为临时解决方法，我清理了数据库中的 SpringBatch 表，但我不希望这种情况再次发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:31:34.780

不知道 -next 选项。

最快的方法是将当前时间戳作为参数传递给您的工作。这样它将是独一无二的，并且不会真正干扰您的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-17T19:36:10.153

使用 de -next 选项，您应该设置 JobParametersIncrementer 实现，

在此示例中，我使用 -> new RunIdIncrementer 来避免消息：作业实例已存在并且参数已完成

```
@Autowired
private JobBuilderFactory jobs;
...
@Bean(name=JOB_NAME)
public Job job() {        

    return jobs.get(JOB_NAME)
               .start(this.login())
               .next(this.launchDuke())
               .incrementer(new RunIdIncrementer())
               .build();
} 
```

# html - Outlook 2007 的 HTML 电子邮件：添加图像

> ID：12976665
> 
> 赞同：0
> 
> 时间：2012-10-19T14:43:45.380
> 
> 标签：html, image, email, outlook-2007

我正在设计使用 Outlook 2007 阅读的 html 电子邮件。

我想添加一个图像，一个标志，定位在电子邮件的第一件事。

如何包含图像？我觉得我需要一条路径来做通常的事情：

```
<img src=”mypath/image.gif”&gt; 
```

但我不认为我可以包含任何东西的路径。我应该怎么办？

万分感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:47:13.163

[`cid:`您可以使用该方案](https://www.rfc-editor.org/rfc/rfc2392)引用附加的图像。

一般来说，你会让一个工具为你处理这个。上次我有理由这样做，我用[Perl](http://www.perl.org/)编写了发送邮件的程序并使用了[`Email::MIME::CreateHTML`模块](https://metacpan.org/module/Email::MIME::CreateHTML)。

# iphone - FMDB lastinsertRowID 始终为 0

> ID：12976670
> 
> 赞同：3
> 
> 时间：2012-10-19T14:43:58.250
> 
> 标签：iphone, ios, ipad, sqlite, fmdb

喂。

我已经在我的应用程序中实现了 FMDB。我正在尝试使用这个从我的一个数据库中获取最后一行 id

```
FMDatabase *bdb=[FMDatabase databaseWithPath:databasePath];
    NSString *str;
    if([bdb open]){
        int lastId=[bdb lastInsertRowId];
        FMResultSet *s = [bdb executeQuery:[NSString stringWithFormat:@"SELECT budget FROM data WHERE ROWID='%d'",lastId]];
        if([s next])
        {
            str= [s stringForColumnIndex:0];
        }
    } 
```

我遇到的问题是 lastId 始终为 0 ，尽管数据库中当前有 3 个条目。Any1 知道为什么会这样吗？

编辑：数据库是这样创建的：

```
NSFileManager *filemgr = [NSFileManager defaultManager];
    if ([filemgr fileExistsAtPath: databasePath ] == NO)
    {
        const char *dbpath = [databasePath UTF8String];

        if (sqlite3_open(dbpath, &basicDB) == SQLITE_OK)
        {
            char *errMsg;
            const char *sql_stmt = "CREATE TABLE IF NOT EXISTS DATA (ROWID INTEGER PRIMARY KEY AUTOINCREMENT, NAME TEXT, BUDGET INTEGER)";

            if (sqlite3_exec(basicDB, sql_stmt, NULL, NULL, &errMsg) != SQLITE_OK)
            {
               DLog(@"Failed to create table");
            }
           sqlite3_close(basicDB);

        } else {
           DLog(@"Failed to open/create database");
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:36:33.113

`lastInsertRowId`适用于特定连接。您正在使用的连接刚刚打开，因此没有插入行 ID。

（目的`lastInsertRowId`是让您的应用程序知道刚刚`INSERT`编辑的记录的 ID。）

要从最后一条记录中读取数据，请使用以下内容：

```
SELECT budget FROM data WHERE rowid = (SELECT max(rowid) FROM data) 
```

# java - 是否可以在 Class.forName 中使用动态值？

> ID：12976674
> 
> 赞同：1
> 
> 时间：2012-10-19T14:44:15.207
> 
> 标签：java, dynamic, testng

我有一个 testNG 框架，我被要求通过命令行使其可运行。我已经添加了执行测试的代码，但是命令行执行的一部分是传入要执行的测试类。Java 似乎不喜欢这样。

我的代码：

```
 TestListenerAdapter tla = new TestListenerAdapter();
    TestNG testng = new TestNG();

    try
    {
        Class cl = Class.forName(myClass);
        testng.setTestClasses(new Class[] { cl.class });
        testng.addListener(tla);
        testng.run();
    }
    catch (Exception ex)
    {
    ...
    } 
```

变量 myClass 是传递给 Main 的参数之一。

我收到关于“未知类”的“cl.class”代码的错误。

这样做的正确方法是什么？

编辑：

实际构建项目时，返回的错误是“error: cannot find symbol class cl”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T14:50:34.850

问题可能是您将 cl.class 放入 Class 数组中。cl 是一个类对象。尝试

```
testng.setTestClasses(new Class[] { cl }); 
```

您可以在此处阅读有关 Class 类的更多信息[http://docs.oracle.com/javase/tutorial/reflect/class/classNew.html](http://docs.oracle.com/javase/tutorial/reflect/class/classNew.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T14:51:34.740

将您的行更改为：

`testng.setTestClasses(new Class[] { cl });`

语法是从硬编码`X.class`的类名中获取对象。`Class`在这种情况下，您已经拥有 Class 实例，所以只需使用它。

# c++ - 我可以通过增加指针来移动数组吗？Qt

> ID：12976675
> 
> 赞同：1
> 
> 时间：2012-10-19T14:44:18.043
> 
> 标签：c++, arrays, qt, pointers

假设我有一个 QString 数组和一个 QString 指针。我想用指针遍历整个数组；我可以这样做吗？

```
QString * strPointer;
QString data[100];
strPointer = & data[0]; //address to first element

strPointer ++; //address to second element 
```

这是有效的还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:47:49.497

你在正确的路线上。这是一种方法

```
QString data[100];
for (QString* strPointer = &data[0]; strPointer != &data[100]; ++strPointer)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:14:35.417

是的，只要指针的类型与数组中实际指向的类型相匹配就可以了。通过递增指针，您正在执行指针算术。

值得注意的是，由于标准库中的迭代器在许多方面都被编写成看起来和感觉像指针，并且所有标准库算法都将迭代器指定为模板参数，因此使用这些算法是合法且定义明确的原始指针也是如此。例如，这是完全合法的，即使有你的指针：

```
const size_t num_data = sizeof(data)/sizeof(data[0]);
std::copy( &data[0], &data[num_data], ostream_iterator<QString>(cout,"\n") ); 
```

...当然假设您已经`operator<<`为一个`QString`对象实现了。

现在，说了这么多，看看这个：

```
QString data[100]; 
```

这`100`就是所谓的[幻数](http://en.wikipedia.org/wiki/Magic_number_%28programming%29)。幻数的使用被广泛认为是一种[反模式](http://en.wikipedia.org/wiki/Anti-pattern)，或者是一种不好的做法。问自己几个问题：

1.  你怎么知道 100 个元素就足够了？
2.  如果你不需要 100 个元素，你是不是很浪费？
3.  如果你需要超过 100 个元素，你的程序会崩溃吗？

最好尽可能避免使用幻数。您在`100`这里的选择是任意的。最好使用随着您添加和删除对象而增长和缩小的集合类型。 `std::vector`是一个很好的起点：

```
std::vector<QString> data; 
```

现在您可以添加项目：

```
data.push_back( ... ); 
```

...删除它们，并使用迭代器轻松迭代：

```
std::copy( data.begin(), data.end(), ostream_iterator<QString>(cout,"\n") ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:16:49.510

是的，增加指向数组元素的指针将产生指向下一个元素或指向数组末尾后一个位置的指针。

> 当具有整数类型的表达式被添加到指针或从指针中减去时，结果具有指针操作数的类型。如果指针操作数指向数组对象的元素，并且数组足够大，则结果指向与原始元素偏移的元素，使得结果和原始数组元素的下标之差等于积分表达式。换句话说，如果表达式 P 指向数组对象的第 i 个元素，则表达式 (P)+N（等价于 N+(P)）和 (P)-N（其中 N 的值 n）指向，分别是数组对象的第 i + n 个和第 i - n 个元素，前提是它们存在。此外，如果表达式 P 指向数组对象的最后一个元素，则表达式 (P)+1 指向数组对象的最后一个元素，如果表达式 Q 指向数组对象的最后一个元素，则表达式 (Q)-1 指向数组对象的最后一个元素。如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则计算不应产生溢出；否则，行为未定义。
> *                                                                                                                            — [expr.add] 5.7 /5*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:46:40.060

是的。请记住检查索引 - operator++ 可能会“走得太远” - 超出数组。

# excel - Excel 宏日期提示当前日期并提前 1 天更改下一个单元格

> ID：12976677
> 
> 赞同：0
> 
> 时间：2012-10-19T14:44:19.127
> 
> 标签：excel, vba

我将如何创建一个宏来提示当前日期并提前 1 天更改下一个单元格？我有一个到目前为止的样本。让我知道我是否关闭。

```
Sub Change_dates()
    Dim dtDate As Date
    dtDate = InputBox("Date", , Date)
    For Each cell In Intersect(Range("B " & dblRow).Value = dtDate, ActiveSheet.UsedRange)
        cell.Offset(0, 1).Select = cell.Offset(0, 1).Select + 1
    Next cell
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:54:40.227

此代码将提示当前日期，写入活动单元格，然后将日期 + 1 写入下一列的单元格。

```
Sub Change_dates()
Dim dtDate As Date
dtDate = InputBox("Date", , Date)

ActiveCell.Value = dtDate
ActiveCell.Offset(0, 1).Value = dtDate + 1

End Sub 
```

这将从提示中获取日期，将其写入范围内选定的行中，然后将日期 + 1 放在所选范围右侧一列的行中。

```
Sub Change_dates_range()
Dim dtDate As Date
dtDate = InputBox("Date", , Date)

Set SelRange = Selection

For Each b In SelRange.Rows
    b.Value = dtDate
    b.Offset(0, 1).Value = dtDate + 1
Next

End Sub 
```

如果您希望范围内的每一行都是前一行的 + 1 天，那么我将在循环结束时在 Next 语句之前增加 dtDate。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:14:10.970

这应该完全符合您的要求：

```
Sub Change_dates()
Dim dtDate As Date
Dim rng As Range
Dim FirstRow As Integer
   dtDate = InputBox("Date", , Date)
   Set rng = ActiveSheet.Columns("B:B").Find(What:=dtDate, LookIn:=xlFormulas, SearchOrder:=xlByRows, SearchDirection:=xlNext)
   FirstRow = rng.Row
Do
   rng.Offset(0, 1).Value = rng.Offset(0, 1).Value + 1
   Set rng = ActiveSheet.Columns("B:B").FindNext(After:=rng)
Loop Until rng.Row = FirstRow

End Sub 
```

# php - Magento 中的第二个数据库连接

> ID：12976678
> 
> 赞同：0
> 
> 时间：2012-10-19T14:44:20.497
> 
> 标签：php, mysql, magento

在付款请求期间，我想将附加信息插入 Magento 数据库。**无论**主数据库连接的事务结果 如何，我都希望插入这些附加信息。

我相信这样做的唯一方法是创建到数据库的**第二个**连接，因为 MySQL 不允许嵌套事务。如何在 Magento 中创建第二个数据库连接，或者是否有另一种方法可以解决我的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:09:45.503

$table = Mage::getSingleton('core/resource')->getTableName($name); Mage::getSingleton('core/resource')->getConnection('core_write')->insert($table, $array);

# regex - Oracle CHECK 对两个日期字符串变体的约束

> ID：12976680
> 
> 赞同：0
> 
> 时间：2012-10-19T14:44:26.597
> 
> 标签：regex, oracle, validation, date, check-constraints

我正在使用一个遗留的 Oracle 数据库，该数据库的列包含格式如下的日期字符串：

```
30-Apr-03

30-Apr-2003 
```

列数据类型是`VARCHAR2(12)`（尽管`11`就足够了）。这两种表示都可以出现在单个列中。

**问题：**如何编写一个*仅*`CHECK`允许列中的这两个日期字符串变体的约束？

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:46:25.723

这是`CHECK`验证表单`19-Oct-12`或`19-Oct-2012`. 对于具有两位数年份的日期字符串，请使用**RegEx**为年份添加前缀`19`以避免 Oracle 错误`ORA-02436 - date or system variable wrongly specified in CHECK constraint`。

```
ALTER TABLE table1
    MODIFY col_date1 CONSTRAINT col_date1_ck
        CHECK ((TO_DATE(
                 REGEXP_REPLACE(col_date1, '^(......-)(..)$', '\119\2'),
                 'DD-Mon-YYYY') > TO_DATE('31-Dec-1899'))); 
```

从长远来看，如果可以接受对模式进行更改，则使用[DATE](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements001.htm#sthref151)数据类型（11g Release 2 (11.2)）会更合适。

* * *

**更新：**不幸的是，这不是一个有效的解决方案。首先，这是这种`CHECK`约束按预期工作的情况：

```
Value:  '05/Nov/12'
Result: ORA-02290: check constraint (TABLE1.COL_DATE1_CK) violated 
```

但是，此日期字符串被约束接受：

```
Value:  '05/Nov/2012' 
```

这是不想要的，因为目的是`'-'`用作字段分隔符，而不是`'/'`. 最后，考虑这个日期字符串及其结果：

```
Value:  '05/Foo/2012'
Result:  ORA-01843: not a valid month 
```

在这里，约束也不允许这个值进入受保护的列。但是，结果异常中没有任何迹象表明这是违反约束的。（想要的是`ORA-02290`如第一个示例中所示。但是`TO_DATE()`返回异常而不是`CHECK`返回约束`False`。）

**替代方案：**出于这些原因，我最终决定通过**触发器**来解决这个问题。但我当然欢迎有关修改此`CHECK`约束以使其真正实现目标的想法。*

# javascript - 从 json 编码返回许多数组

> ID：12976683
> 
> 赞同：-2
> 
> 时间：2012-10-19T14:44:39.890
> 
> 标签：javascript, json

在我的 php 代码中，我想返回两个数组

```
$array_result[]+= $temp_score_by_weight;
$array_name[] .= $alter->name;
}
$return["result"] = $array_result;
$return["name"] = $array_name;

echo json_encode($return); 
```

在 javascript ajax 函数中

```
function requestData() {
    $.ajax({
        url: 'result_calculation.php',
        success: function(data) {
            // call it again after one second
            alert(data);
        },
        cache: false
    });
} 
```

alert(data) 的结果格式如下：

```
{"result":[1265,765],"name":["rmit","svu"]} 
```

我想获取这些信息并将它们放在两个单独的 javascript 数组中（结果数组包含两个值和相同的名称数组）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:46:01.013

```
var result = data.result;
var name = data.name; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:48:37.933

为您的 ajax 调用指定 json 格式

```
$.ajax({
  url: 'result_calculation.php',
  success: function(data) {
    // call it again after one second
    alert(data["result"]);//first array
    alert(data["name"]);//second array
  },
  cache: false,
  dataType: "json"
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:46:53.907

只需将它们分配给您的数组：

```
var result = data.result;
var name = data.name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:46:58.603

JSON 要求最外层实体是单个对象或数组，因此如果要发送多个数组（数组数组不是最佳选择），您确实需要从服务器返回一个对象。

但是，转换为两个数组很简单

```
var result = data.result;
var name   = data.name; 
```

# c# - 如何在 C# 中更新 XML 文件

> ID：12976685
> 
> 赞同：0
> 
> 时间：2012-10-19T14:44:56.673
> 
> 标签：c#, xmldocument

我有一个 XML 文件。我想创建一个新节点并将其附加到 XML 文件的末尾并将其保存回内存。

```
<IntCal>
  <User>
    <Date>12/09/2012</Date>
    <Client>abcd</Client>
    <Jewellery>Others</Jewellery>
    <ROI>7.5</ROI>
    <Description>Some Description</Description>
  </User>
<IntCal> 
```

我想创建一个新`<User>`元素。任何想法如何做到这一点。

```
 XmlDocument xmlDoc = new XmlDocument();
 xmlDoc.Load(xmlFile);
XmlNode root_node;

//XmlNodeList nodeList = xmlDoc.SelectNodes("/IntCal/User");

XmlDocument new_node = new XmlDocument();
root_node = xmlDoc.CreateElement("IntCal");
xmlDoc.AppendChild(root_node); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:48:57.890

参考： http: [//msdn.microsoft.com/en-us/library/fw1ys7w6 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/fw1ys7w6%28v=vs.100%29.aspx)

```
 XmlElement elem = xmlDoc.CreateElement("User");
    xmlDoc.DocumentElement.AppendChild(elem); 
```

如果你想走 LINQ 路线，你可以这样做：

```
XDocument xDoc = XDocument.Load(xmlFile);
xDoc.Element("IntCal")
    .Add(new XElement("User")); 
```

就个人而言，我会选择 XDocument 并使用 LINQ，但无论哪种方式都可以。
参考：http: [//msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:06:35.190

*XmlDocument*是一个老派，你为什么不使用*XDocument*，简单易行：

```
XDocument xDoc = XDocument.Load(xmlFile);
xDoc.Root.Add(new XElement("User", 
                  new XElement("Client", "John"), 
                  new XElement("Jewellery", "Others")));
xDoc.Save(xmlFile); 
```

参考：

1.  [XDocument 或 XmlDocument](https://stackoverflow.com/questions/1542073/xdocument-or-xmldocument)
2.  [性能：XDocument 与 XmlDocument](https://stackoverflow.com/questions/4383919/xdocument-versus-xmldocument)

# apache - 通过“即时编译”从源代码在 Apache 下运行 .go 文件

> ID：12976688
> 
> 赞同：1
> 
> 时间：2012-10-19T14:45:04.033
> 
> 标签：apache, go

我可以使用以下代码通过 Apache 将 Go 应用程序作为网站运行。

**你好.go**：

```
package main

import (
    "os"
)

func main() {
    os.Stdout.WriteString("Content-Type: text/html; charset=UTF-8\n\n")
    os.Stdout.WriteString("Hello!\n")
} 
```

**.htaccess**：

```
AddHandler cgi-script .exe 
```

`go build hello.go`我使用并按`http://localhost/hello.exe`预期工作来编译应用程序。

但是现在我必须在每次更改源代码后重新编译。

访问时是否可以以某种方式告诉 Apache 运行`hello.go`（Apache 应该运行`go run hello.go`）`http://localhost/hello.go`？

*顺便说一句，这只是为了加快开发速度，而不是为了生产！*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:38:23.753

Go 是一种编译语言，你需要先编译它。目前没有任何 Go 的解释器/VM。

最好的办法是只使用一个进程/cron 作业来检查 .go 文件是否比二进制文件更新，并在发现文件更改时重新构建它。

[https://github.com/howeyc/fsnotify](https://github.com/howeyc/fsnotify)是一个允许您监视文件更改的包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T19:18:08.550

您可以使用[gorun](https://wiki.ubuntu.com/gorun)`#!/usr/bin/gorun` ，它使您能够在文件顶部放置一行，使其像脚本一样运行。gorun 将即时编译它然后运行它。我已经用它来制作 golang 脚本了，我希望它也适用于 CGI。

您必须将脚本标记为可执行 ( `chmod +x`) 并告诉 apache 该`.go`扩展是可执行的。

不确定我是否会推荐它用于生产，但它应该像`gorun`缓存一样有效地工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T17:51:05.333

一个简单的解决方案是使用一个工具来重新编译源文件更改的代码。例如[`GoWatch`](https://bitbucket.org/gotamer/gowatch).

`fsnotify`或者按照 Erik 已经说明的方式自己尝试一下。示例：[简单编译守护进程](https://github.com/githubnemo/CompileDaemon)。

您也可以`go run`在您的 CGI 脚本中调用。

# jquery - jquery dt 类依赖于 dd ol css 样式

> ID：12976691
> 
> 赞同：1
> 
> 时间：2012-10-19T14:45:06.737
> 
> 标签：jquery, html, css

我有一个 dlist，如果下一个“dd ol”被隐藏，我想在其中添加一个类到“dt”。

在下面的示例中，您看到 dd.dd2 ol 是隐藏的，所以我希望上面的 dt 折叠（添加一个类）

我在 Stackoverflow 上找到了这个：[Delete <dt> without <dd> with jquery](https://stackoverflow.com/questions/1957675/delete-dt-without-dd-with-jquery)

```
$('dt').filter(function(){
                     return !($(this).next().is('dd'));
               }).remove(); 
```

并尝试了类似的东西：

```
$('#someID dt').filter(function(){
                     return ($(this).next().is('dd ol').css('display') == 'none');
               }).addClass('collapsed'); 
```

HTML：

```
<dl id="someID">
<dt class="dt1">List1<span>&nbsp;</span></dt>
<dd class="dd1" >
<ol>
<li class="listitem1"><a href="#" title="listitem1">listitem1</a></li>
<li class="listitem2"><a href="#" title="listitem2"><span class="txt">listitem2</span></a></li>
<li class="listitem3"><a href="#" title="listitem3"><span class="icon">&nbsp;</span><span class="txt">listitem3</span></a></li>
</ol>
</dd>

<dt class="dt2">List2<span>&nbsp;</span></dt>
<dd class="dd2" >
<ol style="display: none;">
<li class="listitem1"><a href="#" title="listitem1">listitem1</a></li>
<li class="listitem2"><a href="#" title="listitem2"><span class="txt">listitem2</span></a></li>
<li class="listitem3"><a href="#" title="listitem3"><span class="icon">&nbsp;</span><span class="txt">listitem3</span></a></li>
</ol>
</dd>

<dt class="dt3">List3<span>&nbsp;</span></dt>
<dd class="dd3" >
<ol>
<li class="listitem1"><a href="#" title="listitem1">listitem1</a></li>
<li class="listitem2"><a href="#" title="listitem2"><span class="txt">listitem2</span></a></li>
<li class="listitem3"><a href="#" title="listitem3"><span class="icon">&nbsp;</span><span class="txt">listitem3</span></a></li>
</ol>
</dd>
</dl> 
```

但它没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:01:34.967

最简单的方法是使用[`:hidden`选择器](http://api.jquery.com/hidden-selector/)：

```
$('dl#someID dd ol:hidden').parent().prev('dt').addClass('collapsed'); 
```

[http://jsfiddle.net/mblase75/mULNu/](http://jsfiddle.net/mblase75/mULNu/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:02:06.143

在您的过滤器功能中试试这个：

```
return $(this).next().is('dd').has('ol:hidden').length > 0; 
```

# mod-rewrite - 如何保留URL的最后一段并进行301重定向呢 ？

> ID：12976695
> 
> 赞同：0
> 
> 时间：2012-10-19T14:45:22.773
> 
> 标签：mod-rewrite

我有这个 URL = **domain.com/art-articles/arts/biography/2375-elias-**

我想 301 重定向它，因为我最近将我的 Joomla 网站更改为类似**domain.com/articles/art-articles/bios/item/2375-elias-**

我尝试过这样的事情，但没有奏效。

```
RewriteRule ^art-articles/arts/biography/(.*) /articles/art-articles/bios/item/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:07:08.550

代码是这样的。我的 Firefox 缓存是问题所在。

```
RewriteRule ^art-articles/arts/biography/(.*)$ /articles/art-articles/bios/item/$1 [R=301,L] 
```

# c++ - 由于错误转换导致的错误重载/特化

> ID：12976696
> 
> 赞同：4
> 
> 时间：2012-10-19T14:45:26.110
> 
> 标签：c++

在我自己的代码中出现错误之后，（在我看来）编译器选择了错误的重载，我一直在寻找解释，但找不到一个简单的解释。我确实找到了处理专业化问题的[Herb Sutter 的 GOTW 49](http://www.gotw.ca/gotw/049.htm)。我还在stackoverflow上发现了一些问题，但没有一个能真正向我解释原因，也不能为我提供好的解决方案。

我有一个类 Foo，它可以从布尔值构造。我发现（很难）std::string 也可以从 bool （假）构造。

我有三个具有不同参数的（模板）方法，如下所示。一个方法接受“任何”模板参数，两个特化，接受一个struct Foo，另一个接受一个字符串。

```
#include <string>
#include <iostream>

struct Foo
{
    Foo() : value( false ){ };
    Foo( bool v ) : value ( v ) { } 
    Foo( const bool& v ) : value( v ) { }

    bool value;
};

template< typename T >
void bar( const T& value )
{
    std::cerr << "template bar" <<  std::endl;
}

template< >
void bar< Foo >( const Foo& )
{
    std::cerr << "template bar with Foo" << std::endl;
}

template< typename T >
void bar( const std::string& )
{
    std::cerr << "template bar with string" << std::endl;
}

int main( int argc, char* argv[] )
{
    bar( false ); // Succeeds and calls 1st bar( const T& )
    bar< Foo >( false ); // Crashes, because 2nd bar( const std::string& )
                         // is called with false promoted to null pointer.

    return 0;
} 
```

我已经使用 Visual Studio 2010 和 MinGW (gcc 4.7.0) 对此进行了测试。GCC 很好地给出了编译警告，但 msvc 没有：

```
main.cpp:34:20: warning: converting 'false' to pointer type for argument 1 of 'std::basic_string< ... ' [-Wconversion-null] 
```

小更新（在代码中）：即使是 Foo 的显式特化也不起作用。\

小更新 2：编译器不会抱怨“模棱两可的重载”。

小更新 3：有人回答说 Foo 的两个构造函数接受 a `bool`，“使”Foo 的选择“无效”。我只用一个转换构造函数测试了类似的版本。这些也不起作用。

问题：

1.  为什么编译器会尝试调用字符串参数版本？
2.  以及为什么添加`<Foo>`bar() 调用很重要。
3.  我怎样才能防止这种情况发生。例如，我可以强制编译器在`bar( const Foo& )`输入布尔值时进行选择吗？
4.  或者，当有人调用时，我可以强制执行编译错误`bar< Foo >( false )`吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T15:06:58.147

以下是四个问题的答案：

1.  为什么编译器会尝试调用字符串参数版本？您的类`Foo`有两个构造函数，`bool`它们采用模棱两可的 a，因此不考虑转换`bool`为`Foo`（如果您想检测是否传入了临时值或左值，您可以在 C++ 中使用`bool&&`和`bool const&`作为参数类型重载）。`std::string`可以从 a 构造`char const*`并且`false`可以提升为空指针常量。空指针常量在语法上是有效的`char const*`，但它是非法值，传递它会导致未定义的行为。
2.  为什么在 bar() 调用中的添加很重要？指定模板参数时，您禁止模板参数推导并告诉编译器使用哪个参数。显式指定模板参数是可以选择`bar()`采用 a的重载的唯一方法，因为无法为此模板推导。`std::string``T`
3.  我怎样才能防止这种情况发生。例如，当输入 bool 时，我可以强制编译器选择 bar( const Foo& ) 吗？最简单的方法是让编译器推断模板参数：`bar()`编译器永远不会自动选择 s 的版本，因为编译器无法推断模板参数。或者，如果您想显式指定模板参数并且只是`bool`一个问题，您可以添加一个重载`bool`，并使推导的版本和`bool`版本委托给相同的内部函数。
4.  或者，当有人调用 bar< Foo >( false ) 时，我可以强制执行编译错误吗？通过删除重载（见下文），这将很容易使用 C++ 2011。

`bool`要在使用显式指定的模板参数时创建编译时错误，您可以添加此重载：

```
template <typename T> void bar(bool) = delete; 
```

删除功能在 C++ 2011 中可用。

主要问题似乎是：如果`Foo`和`std::string`都可以从 转换`bool`，为什么`std::string`选择转换 if`bar<Foo>(bool)`被调用并且以下重载可用？

```
template <typename T> void bar(T const&);
template <>           void bar<Foo>(Foo const&);
template <typename T> void bar(std::string const&); 
```

首先，重载决议选择主模板，忽略任何特化）。由于`bar(std::string const&)`作为比推导模板参数的版本更专业的接口，因此选择了此版本。在这个阶段忽略第一个模板的特化。要使用也`Foo`适用，您可以添加

```
template <typename T> void bar(Foo const&); 
```

和调用`bar<Foo>(false)`将是`std::string`和`Foo`版本之间的歧义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:01:30.260

第一个示例`bar( false );`调用 ，`template<typename T> void bar( const T& value )`因为它与 T = bool 完全匹配。

当您指定 T = Foo 时，这两个重载都不再是完全匹配的，因此您将进入关于应用哪些隐式转换的相当复杂的规则。大多数 C++ 程序员并不完全理解这些，所以最好避免隐式转换。

在这种情况下，最简单的解决方法是为 bool 添加另一个重载。

```
template<typename T>
void bar( bool )
{
    std::cerr << "bool" << std::endl;
} 
```

然后在该重载中，您可以显式应用转换并调用所需的版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:58:50.760

这条线

```
bar< Foo >( false ); 
```

可以匹配以下两个函数中的任何一个：

```
void bar<Foo>(const Foo&);
void bar<Foo>(const std::string&); 
```

现在，如果两个 UDT 都有来自 的隐式转换构造函数`bool`，它应该选择哪一个？它们都具有相同的优先级，因为它们都是相同类型的转换。

至少......大概就是这样，尽管它真的*不应该*选择提升+构建而不是仅构建序列。

# php - pdo 捕获并输出 mysql 错误

> ID：12976697
> 
> 赞同：16
> 
> 时间：2012-10-19T14:45:26.270
> 
> 标签：php, pdo, try-catch

我有一个使用 PDO 执行的插入语句。插入效果很好，但是如果出现错误，我希望它显示给用户。

我有下面的 try-catch 块。

```
try{ 
    $insertuser = $db->prepare('INSERT INTO `she_she`.`Persons` (`idnumber`,`addedby`,`firstname`, `middlename`, `surname`, `fullname`, `gender`, `birthdate`, `homelanguage`, `department`, `employeetype`, `employeestatus`) VALUES  (?,?,?,?,?,?,?,?,?,?,?,?)'); 
    $insertuser->execute(array($idnumber,$user,$firstname, $middlename, $surname, $fullname, $gender, $birthdate, $language, $department, $employmenttype, $personstatus));  
} 
catch(PDOException $exception){ 
    return $exception; 
} 
```

如果查询失败，或者假设是重复的 IDNumber，我希望将其显示给用户。

如果我只是尝试回显变量 $exception 它不起作用。

我想将 MySQL 错误返回给用户。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-19T18:20:13.597

默认情况下，PDO 不处于会显示错误的状态。您需要在数据库连接中提供以下内容

```
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

更多信息可以在[这里看到](http://us2.php.net/manual/en/pdo.setattribute.php)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-03-06T07:55:43.693

1.在您的数据库连接后添加 ERRMODE_EXCEPTION 模式：

```
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

2.而且您必须对所有 mysql 查询使用 try{} catch{} 方法。像这样：

```
try {
    $SQL = "DELETE FROM items WHERE item_id=:item_id";
    $m = $dbh->prepare($SQL);
    $m->bindParam(':item_id', $item_id, PDO::PARAM_INT);
    $m->execute();
    //success
    $return = "Your success message.";
}
catch (PDOException $e) {
    //error
    $return = "Your fail message: " . $e->getMessage();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:49:04.163

你应该使用这个：

```
return $exception->getMessage(); 
```

请参阅异常类的文档页面：

[http://www.php.net/manual/en/exception.getmessage.php](http://www.php.net/manual/en/exception.getmessage.php)

# javascript - 在较大的 div 中打开缩略图

> ID：12976706
> 
> 赞同：0
> 
> 时间：2012-10-19T14:46:05.083
> 
> 标签：javascript, css, html, photo-gallery

hej 那里，我有一个关于 javascript 和 css 功能的问题。

我正在尝试创建一个 css 照片库，但我发现仅在 css 中几乎不可能有一个带有缩略图等的好画廊。所以我想，当我点击缩略图时，图片在另一个 div 中打开得更大。

我希望像这样足够清楚。

我很抱歉英语不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:53:57.780

html

```
<a.some>
   <img.thumb>
   <span.popup>
      <img.big>
   </span>
</a> 
```

css

```
a.some{position:relative}
a.some .popup{display: none;}
a.some:focus .popup{
   display:block;
} 
```

像这样的东西。

# watin - 如何在具有多个 iframe 和表格的嵌套 HTML (Watin) 中查找文本字段，而不知道框架上的名称？

> ID：12976707
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:46:05.567
> 
> 标签：watin

如何在不知道名称的情况下在 iframe 和表格的深处按名称查找文本字段，我什至不知道它有多少帧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T22:32:37.257

通过引用浏览器对象的 Frames 属性遍历帧，在每个结果帧中搜索您要查找的文本框。

**更新**：

您需要按源找到正确的帧或遍历它们或其他任何东西。每个框架都被视为自己独特的控件容器；下面的代码显示了这一点。
使用：IE9、Win7、Watin2.1、NUnit 2.5

示例代码

```
IE browser = new IE();
browser.GoTo("http://nunzioweb.com/iframes-example.htm");
Console.WriteLine("exists base: " + browser.Link(Find.ByText("Slick City")).Exists);
Console.WriteLine("in iframe: " + browser.Frame(Find.BySrc("lyrics/455Rocket.html")).Link(Find.ByText("Slick City")).Exists); 
```

输出

```
exists base: False
in iframe: True 
```

# c# - WPF - 因值更改而触发的公共事件

> ID：12976712
> 
> 赞同：5
> 
> 时间：2012-10-19T14:46:16.673
> 
> 标签：c#, wpf, events, editing

好的。这似乎是一个非常基本的用例，但由于某种原因，我在寻找跨控件类型的通用解决方案时遇到了问题。

这是用例：

带有任何可编辑控件的表单会呈现给用户。（文本框、组合、网格等）。

用户编辑控件中的值并跳出。
期望是我可以连接到诸如 Lost Focus 之类的事件并使用更改的值执行“foo”。

然后，用户将焦点返回给控件，并在不进行编辑的情况下跳出标签。期望是，无论我连接到什么事件，我都可以检查值是否已更改。

控件中是否有一个常见事件仅在用户完成编辑时触发（例如 tab out 或 enter ）并允许我检查先前状态与当前状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T14:54:08.000

Jason，您可能希望查看 WPF 中的 Binding 和 DependencyProperties，而不是跟踪表单中的事件。您可以将一个类绑定到您的表单，该表单公开要更改的属性。使用 DependancyProperties 会触发一个名为“PropertyChanged”的事件。

不幸的是，这是一个广泛的主题，但您将真正获得 WPF 编程模型的全部好处。搜索“wpf 中的依赖属性”会给你一些很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:28:34.537

正如前面的答案所建议的那样，您最好实现一个视图 - 视图模型结构，您的视图模型已经实现了 INotifyPropertyChanged，从而允许您绑定到将宣布它们对 UI 的更改的属性。

如果您不想这样做，您最终可以在您的输入元素上订阅 PreviewKeyUp 事件，检查是否已按下 Tab 键并从那里继续。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-22T11:45:13.993

您可能感兴趣的是实现 INotifyPropertyChanging（不仅仅是 INotifyPropertyChanged）。

[正如这个问题的答案所指出的](https://stackoverflow.com/questions/7995893/why-doesnt-anyone-use-the-inotifypropertychanging)，INotifyPropertyChang **ING**不会阻止您更改值，而是检测何时发生更改，以及新值将是什么。

希望它有助于您的解决方案需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T15:18:57.050

我想这可能是焦点问题。存在两种不同的焦点类型：键盘焦点和逻辑焦点。具有键盘焦点的控件是具有插入符号的控件，在用户按键的和输入的控件过程中。a 控件可能具有逻辑焦点但没有键盘焦点。请在 MSDN 文章“输入概述”中检查这一点。关于另一个问题，也许您可​​以处理 TabControl.SelectedItemChanged 以在选项卡项选择更改时进行事件。希望这对你有帮助...

# asp.net - 在 nodejs 中模拟 ASP.NET TempData

> ID：12976716
> 
> 赞同：1
> 
> 时间：2012-10-19T14:46:26.177
> 
> 标签：asp.net, node.js, session, tempdata

如何在 nodejs 中创建像 TempData 这样的对象？我想也许我可以将标志“IsTempData”设置为会话，并在应用程序结束时清除选择了该标志的会话。但是有一个问题：我有很多使用 tempdata 的异步函数，所以应用程序可能会在我使用 tempdata 之前结束。我希望你明白我所说的结束申请是什么意思：

```
connect()
.use(connect.bodyParser())
.use(connect.query())
.use(connect.favicon())
.use(connect.cookieParser())
.use(connect.session({ secret: 'your secret here' }))
.use(function (req, res) {
    somefunction();

    // end of application, here I will clear sessions which have tempdata flag selected
}).listen(1234); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T05:15:36.817

我看到你的帖子寻找同样的行为。由于找不到任何东西，我决定自己实现一些东西，希望也能对你有所帮助：**[NodeJS TempData Provider](https://github.com/MKxDev/TempData)**

请记住，这是相当快的，所以如果您有任何问题，我会很感激您的反馈。

# javascript - 在 PhoneGap 中检查相机访问权限

> ID：12976725
> 
> 赞同：1
> 
> 时间：2012-10-19T14:46:51.620
> 
> 标签：javascript, cordova

有没有办法检查有问题的设备是否支持摄像头访问（如果它确实有摄像头！）。

我需要根据设备是否可以实际拍照来显示不同的内容，并且我正在努力寻找要检查的变量或对象。

对此的任何帮助将不胜感激。

请注意，我使用 PhoneGap Build 来构建应用程序，所以这需要在 JavaScript 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:01:06.557

你在什么地方使用Phonegap？安卓还是iOS？如果是安卓你可以试试这个：

```
PackageManager pm = context.getPackageManager(); 
if (pm.hasSystemFeature(PackageManager.FEATURE_CAMERA)) { 
    // Yay, we have a camera. 
} 
```

您基本上是在创建一个数据包管理器来检测该平台是否有摄像头。[资源。](https://groups.google.com/forum/?fromgroups=#!topic/phonegap/S7YDBeoWKSk)

如果您在谈论 iOS，[这里](https://stackoverflow.com/questions/7736973/check-camera-existence-in-ios-phonegap)已经有一个问题。

希望这可以帮助。

# c - 如何从 c 目录中仅获取 txt 文件？

> ID：12976733
> 
> 赞同：4
> 
> 时间：2012-10-19T14:47:08.233
> 
> 标签：c, unix, char, dirent.h

我想在给定目录中仅获取 *.txt 文件的名称，如下所示：

```
#include <stdio.h>
#include <fcntl.h>
#include <unistd.h>
#include <stdlib.h>
#include <dirent.h>

int main(int argc, char **argv)
{
    char *dirFilename = "dir";

    DIR *directory = NULL;

    directory = opendir (dirFilename);
    if(directory == NULL)
        return -1;

    struct dirent *ent;

     while ((ent = readdir (directory)) != NULL)
     {
         if(ent->d_name.extension == "txt")
            printf ("%s\n", ent->d_name);
     }

    if(closedir(directory) < 0)
        return -1;

    return 0;
} 
```

我怎样才能在纯unixs c中做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-19T14:54:22.157

首先，Unix 没有文件扩展名的概念，`extension`所以`struct dirent`. 其次，您不能将字符串与`==`. 你可以使用类似的东西

```
bool has_txt_extension(char const *name)
{
    size_t len = strlen(name);
    return len > 4 && strcmp(name + len - 4, ".txt") == 0;
} 
```

该`> 4`部分确保文件名`.txt`不匹配。

（`bool`从获得`<stdbool.h>`。）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-19T14:51:36.163

您可以`glob()`为此使用函数调用。使用您最喜欢的搜索引擎、Linux 手册页或[此处](http://linux.die.net/man/3/glob)获取更多信息。

```
#include <glob.h>
#include <stdio.h>

int main(int argc, char **argv) {
  const char *pattern = "./*.txt";
  glob_t pglob; 

  glob(pattern, GLOB_ERR, NULL, &pglob);      

  printf("Found %d matches\n", pglob.gl_pathc);
  printf("First match: %s\n", pglob.gl_pathv[0]);

  globfree(&pglob);

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-19T14:53:50.993

可能性：

```
while ((ent = readdir (directory)) != NULL)
{
    const size_t len = strlen(ent->d_name);
    if (len > 4                     &&
        ent->d_name[len - 4] == '.' &&
        ent->d_name[len - 3] == 't' &&
        ent->d_name[len - 2] == 'x' &&
        ent->d_name[len - 1] == 't')
    {
        printf ("%s\n", ent->d_name);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-19T14:55:07.187

你快到了，你只需要检查文件名是否以`.txt`. 一种方法是使用`strcmp`,`strcasecmp`或`memcmp`:

```
while ((ent = readdir (directory)) != NULL)
{
    int len = strlen(ent->d_name);
    if(len > 4 && memcmp(ent->d_name + len - 4, ".txt", 4) == 0)  // only checks lowercase
    {
        // It's a .txt file - now check that it's a regular file
        char filename[PATH_MAX];
        snprintf(filename, sizeof(filename), "%s/%s", dirFilename, ent->d_name);
        struct stat st;
        if(stat(filename, &st) == 0 && S_ISREG(st.st_mode))
        {
            // It's a regular file - process it
        }
    }
} 
```

[`stat(2)`](http://linux.die.net/man/2/stat)通过调用完整文件路径并使用宏检查`st_mode`字段来验证它是一个常规文件（而不是目录或其他类型的特殊文件）是一个好主意。`S_ISxxx`请注意，返回`d_type`的结构成员并不总是受支持，因此依赖它不是一个好主意。`DIR``readdir`

或者，您可以使用以下函数，而不是使用`opendir`、`readdir`和：`closedir`[`glob(3)`](http://linux.die.net/man/3/glob)

```
glob_t globbuf;
if(glob("/path/to/dir/*.txt", 0, NULL, &globbuf) == 0)
{
  int i;
  for(i = 0; i < globbuf.gl_pathc; i++)
    process_filename(globbuf.gl_pathv[i]);
}
globfree(&globbuf); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-19T15:11:18.777

@BartFriedrich 指出了该`glob()`功能，但他没有给出它的使用示例。非常简短（并且完全未经测试）您可能会尝试这样的事情

```
#include <glob.h>
#include <stdio.h>

void glob_example() {
    glob_t g;
    int i;
    glob("*.txt", 0, NULL, &g);
    for (i = 0; i < g.gl_pathc) 
        printf("matched: %s\n", g.pathv[i]);
    globfree(&g)
} 
```

`glob()`实际上是一个相当复杂的功能，对于更一般的文件匹配要求我可能不会使用它，但它确实可以有效地处理您的问题。有关更多信息，请查看`man glob`您的 linux 机器或在线查看[手册页](http://linux.die.net/man/3/glob)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T14:57:01.007

你可以写一个endswith函数：

```
int endswith (const char *name, const char *suffix) 
```

只需通过后缀进行反向循环（从末尾开始）并检查每个字符是否相同。

# ruby - 在 WSH（Windows 脚本宿主）中使用 ruby

> ID：12976734
> 
> 赞同：3
> 
> 时间：2012-10-19T14:47:10.200
> 
> 标签：ruby, windows, wsh

有没有人在 WSH（Windows 脚本主机）中使用 ruby​​ 的经验？以下不起作用，系统上安装了 Ruby。

```
<package id = "hello_world">  
<job>
<script language="VBScript">
  MsgBox "hello world (from vb)"
</script>
<script language="JScript">
  WSH.echo("hello world (from js)");
</script>
<script language="RubyScript">
  puts "hello world (from ruby)"
</script>
</job>
</package> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T12:37:44.480

标准 ruby​​ 不包含/安装 ActiveScript 引擎。你可以试试：

[ActiveScriptRuby](http://www.artonx.org/data/asr/index.html)

我进行了测试安装（Windows XP）并且基础“确实有效” - YMMV。

# android - 使用 BIXOLON SPP-R300 的 Android 打印图像

> ID：12976740
> 
> 赞同：0
> 
> 时间：2012-10-19T14:47:25.830
> 
> 标签：android, bluetooth, android-2.3-gingerbread, bixolon-printer

我正在开发通过蓝牙使用 Bixolon SPP-R300 移动打印机打印图像的应用程序。我的问题是我无法在整个纸张宽度上打印图像。打印机减小了很多尺寸，但在 Android 中保存的图片尺寸很好。我想在整个宽度上打印图像。我查看了 Bixolon 的用户手册 for android 但没有帮助。在互联网上也没有关于它的信息。所以，我不知道该怎么办。这是我的项目中打印图像的代码片段：

```
mBxlService = new BxlService(); 
mBxlService.Connect();
if (mBxlService.GetStatus() == BxlService.BXL_SUCCESS) {
    returnValue = mBxlService.PrintImage(mypath.getPath(), 
                                         384, 
                                         BxlService.BXL_ALIGNMENT_CENTER, 
                                         40);
    if (returnValue == BxlService.BXL_SUCCESS) {
        returnValue = mBxlService.LineFeed(2);                          
    } 
} 
```

在用户手册中，“设置为 384 的值，图像适合全尺寸纸张”没有帮助。这是打印的图像。

![我也附上了，打印的图像](../Images/b42aad8c1c397a266ea9b91a75998564.png) 这是手册 ![在此处输入图像描述](../Images/17c7287505da1fe2d7c03aab03ee892f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T12:12:22.187

您使用的打印机每行有 576 个点。SPP200 有 384 个点。

# python - 为 DATETIME 创建 cx_Oracle arrayvar

> ID：12976745
> 
> 赞同：1
> 
> 时间：2012-10-19T14:47:40.027
> 
> 标签：python, datetime, cx-oracle

我想为 datetime 创建一个 cx_Oracle arrayvar，然后我可以使用它来提供 callproc。所以我期望的代码是这样的：

```
dt1 = datetime.datetime.strptime('2012/07/30 10:42:09', '%Y/%m/%d %H:%M:%S')
dt2 = ...(another datetime value)...
av1 = cursor.arrayvar(cx_Oracle.DATETIME, [dt1, dt2])
av2 = ...(another arrayvar)...
cursor.callproc('my_db_procedure', (av1, av2)) 
```

但是我不断收到此错误：

```
PLS-00306: wrong number or types of arguments in call to 'my_db_procedure' 
```

有人可以指出我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T17:33:26.490

好的，最后我发现了问题所在。在我的 PL/SQL 代码中，我将输入参数类型定义为：

```
TYPE id IS TABLE OF varchar2(16); 
```

实际上应该是：

```
TYPE id IS TABLE OF varchar2(16) INDEX BY BINARY_INTEGER; 
```

我希望这可以帮助有类似问题的人。

# centos - SELinux 和多个 httpd 服务上下文

> ID：12976746
> 
> 赞同：2
> 
> 时间：2012-10-19T14:47:41.590
> 
> 标签：centos, apache, redhat, centos6, selinux

使用 CentOS 6

我有 2 个 Apache httpd 服务正在运行。第一个提供 REST 接口和 UI 来管理操作系统（启动/停止服务、使用 suid 执行系统命令、修改系统设置等）。此 httpd 服务（在端口 5555 上运行）只能从特定 IP 范围（防火墙）访问，因为它将用于管理目的。

第二个 httpd 服务（端口 80 和 443）将在 Internet 上可见。它将为外部客户提供 Web 应用程序。

第一个 httpd 需要 selinux 策略，使其能够更多地访问操作系统文件/进程。第二个需要 selinux 策略，严格限制它在其上下文中被允许做的事情。第二个需要以这种方式实现更好的 Web 应用程序安全性，并防止任何 Web 应用程序漏洞甚至能够触及操作系统。

两个 httpd 进程都以不同的用户身份运行。

1.  selinux 可以与同一 httpd 可执行文件的 2 组不同策略一起使用吗？
2.  我/是否可以设置 httpd 进程上下文以在 httpd 启动时切换到另一组策略？
3.  是否只是制作 httpd 二进制文件的副本并更改其使用所有新策略的 selinux 上下文（重新标记 httpd 二进制文件，但我相信它会花费更多）？
4.  将现有的 httpd selinux 设置复制到新名称的步骤是什么？

我认为这归结为需要 httpdpublic 和 httpdprivate selinux 上下文。在此之前有人做过类似的事情可以提供一些指导或建议替代解决方案吗？谢谢

# azure - 天蓝色云成本

> ID：12976750
> 
> 赞同：0
> 
> 时间：2012-10-19T14:47:50.323
> 
> 标签：azure

我正在寻找一个简单网站的任何基本费用。本网站接受客户的意见。该字段是一个产品编号，很像 ISBN 或 UCC。

我们有一个数据库，其中包含此编号以及名称和价格。我们有一个 C# 程序，它显示价格和名称。

我的问题是，在 Azure 云中拥有这个数据库以及我描述的小应用程序的成本是多少。还有一个用户表和一些较小的表。数据库表和应用程序代码的成本计算如何工作？

每个数据条目只有一次查找，直接输入代码，如果存在，显示价格和名称。

我不知道这是不是不清楚或模棱两可的问题，如果是，我很抱歉，但我正在尝试确定使用交流电的成本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:53:38.360

你应该看看[计算器](https://www.windowsazure.com/en-us/pricing/calculator/?scenario=web)。

*   100MB SQL 数据库：**5.00 美元/月**（如果将其转换为表存储，这会便宜得多）。
*   网站
    *   免费（您不能使用自定义 DNS）：**0.00 美元**
    *   共享（允许您使用自定义 DNS）：**9.36 美元/月**
*   出口带宽（10GB/月到美国/欧盟）：**0.60 美元/月**

# php - 使用 PHP 上传文件

> ID：12976751
> 
> 赞同：4
> 
> 时间：2012-10-19T14:47:50.700
> 
> 标签：php, html

我正在使用一个表单让用户将文件上传到我的网站。我想让他们一次上传多张照片，所以我使用了 HTML5 的“multiple”属性。

我的 HTML：

```
<form method="post" action="save.php">
    <input type="file" name="uploads[]" multiple="multiple" />
    <input type="submit" name="submit" value="submit"/>
</form> 
```

保存.php：

```
<?php
  foreach ($_FILES['uploads']['name'] as $file) {
    echo $file . "<br/>";
    $file= time() . $_FILES['uploads']['name'];
    $target= UPLOADPATH . $file;
    move_uploaded_file($_FILES['uploads']['tmp_name'], $target)
    or die('error with query 2');
   } 
```

但是，由于某种原因，当我运行脚本时，我收到一条错误消息，提示未定义索引：上传。还有一个错误说我为 foreach() 提供了一个无效的参数。我怎么可能错了？

谢谢

**更新**

好的，设置`enctype="mulitpart/form-data"`工作。现在，我在移动文件时遇到了麻烦。我收到错误消息`move_uploaded_file() expects parameter 1 to be string, array given`。我在这里做错了什么？

再次感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T14:49:26.003

您需要适当`enctype`的权限才能上传文件。

```
<form method="post" enctype="multipart/form-data" action="save.php"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:58:16.160

为了首先上传文件，您需要`enctype="multipart/form-data"`在`<form>`标签上。

但是，当您上传多个文件时，每个键`$_FILES['uploads']`都是一个数组（就像`$_FILES['uploads']['name']`）。

循环时需要获取数组键，这样就可以处理每个文件。有关更多详细信息，请参阅[文档`move_uploaded_file`](http://php.net/manual/en/function.move-uploaded-file.php)。

```
<?php
  foreach ($_FILES['uploads']['name'] as $key=>$file) {
    echo $file."<br/>";
    $file = time().$file;
    $target = UPLOADPATH.$file;
    move_uploaded_file($_FILES['uploads']['tmp_name'][$key], $target)
    or die('error with query 2');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:50:26.460

试试这个 html 代码： `<form method="post" action="save.php" enctype="multipart/form-data">` 然后在 PHP 中：

```
if(isset($_FILES['uploads'])){
foreach ($_FILES['uploads']['name'] as $file) {
    echo $file . "<br/>";
    $file= time() . $_FILES['uploads']['name'];
    $target= UPLOADPATH . $file;
    move_uploaded_file($_FILES['uploads']['tmp_name'], $target)
    or die('error with query 2');
   }
} else {
   echo 'some error message!';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-18T08:03:30.223

索引.html

```
<form method="post" action="save.php" enctype="multipart/form-data">
    <input type="file" name="uploads[]" multiple="multiple" />
    <input type="submit" name="submit" value="Upload Image"/>
</form> 
```

保存.php

```
<?php    
  $file_dir  = "uploads";    
  if (isset($_POST["submit"])) {

    for ($x = 0; $x < count($_FILES['uploads']['name']); $x++) {                

      $file_name   = time() . $_FILES['uploads']['name'][$x];
      $file_tmp    = $_FILES['uploads']['tmp_name'][$x];

      /* location file save */
      $file_target = $file_dir . DIRECTORY_SEPARATOR . $file_name;

      if (move_uploaded_file($file_tmp, $file_target)) {                        
        echo "{$file_name} has been uploaded. <br />";                      
      } else {                      
        echo "Sorry, there was an error uploading {$file_name}.";   
      }                 

    }               
  }    
?> 
```

# apache - 将第一个子域的规则库重写到目录

> ID：12976752
> 
> 赞同：1
> 
> 时间：2012-10-19T14:47:52.797
> 
> 标签：apache, .htaccess, rewrite

我需要将任何域名的第一个子域重定向到该 Web 服务器的根文件夹到一个子文件夹。

*   它需要保留传入端口（阻塞端口 80 和 443 的愚蠢 isp）。
*   它需要能够同时处理 http 和 https。
*   它需要忽略 www.whateverthedomain.ext

前任。

*   dom1 : mydummy.com
*   dom2 : toberedirected.net
*   dom3 : putanydomainhere.ca

可能的传入 url

1.  http(s)://firstsub.mydummy.com:8082
2.  http(s)://whateveryoutypehere.thegoodsub.toberedirected.net
3.  http(s)://firstsub.mydummy.com/firstsub/
4.  http(s)://www.mydummy.com/

3个传入url的结果应该是

1.  http(s)://firstsub.mydummy.com:8082/firstsub/
2.  http(s)://thegoodsub.toberedirected.net/thegoodsub/ （我不在乎第一个子前面是什么）
3.  http(s)://firstsub.mydummy.com/firstsub/ （不要重写，它不是根文件夹）
4.  http(s)://www.mydummy.com/ （不要重写，忽略 www 并给出域的默认网页）

写起来可能很容易，但今天早上我想不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T20:59:58.973

尝试将此添加到文档根目录中的 htaccess 文件中

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteCond %{HTTP_HOST} ^(.+)\.
RewriteRule ^/?$ /%1/ [L,R=301] 
```

这应该在重定向时保留主机名和端口。它只会重定向对 web 根的请求，并将重定向到子域的名称，尾随`/`.

# jquery - 文本作为制表符对齐

> ID：12976753
> 
> 赞同：0
> 
> 时间：2012-10-19T14:47:54.537
> 
> 标签：jquery, html, css

文本对齐为 <li> 中的选项卡，读取***(i) 文章***等。

您会在每个 < li > 上看到需要对齐的**文章？**

我如何在 CSS3 中做到这一点？

我正在使用 jQuery 1.8.1 它适用于 iPhone。

[对齐顶部 http://www.kerrydeaf.com/align.png](http://www.kerrydeaf.com/align.png "工具提示")

**更新：**

而不是这样：

[对齐顶部 http://www.kerrydeaf.com/this.png](http://www.kerrydeaf.com/this.png "工具提示")

我看到它超出了页面的边缘：

[对齐顶部 http://www.kerrydeaf.com/this2.png](http://www.kerrydeaf.com/this2.png "工具提示")

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:53:01.760

您可以使用列表样式类型：lower-roman

例如

```
<ul>
    <li style="list-style-type: lower-roman">Article</li>
    <li style="list-style-type: lower-roman">Article</li>
</ul> 
```

这将产生：

```
 i. Article
ii. Article 
```

然而，这不包含括号 - 不确定这些有多重要？

# c# - 有人可以提供一个简单的 C# 编码示例来捕获单个文件的 SharePoint 详细信息吗？

> ID：12976756
> 
> 赞同：1
> 
> 时间：2012-10-19T14:47:58.793
> 
> 标签：c#, visual-studio-2008, sharepoint

我正在使用 VS 2008 并且能够应用 Microsoft.SharePoint.DLL 文件作为代码中的参考。整个 SharePoint 文件夹中有许多可用于批处理文件的示例，但我正在寻找一个简单的 C# 示例来捕获以下属性，为 SharePoint 上的单个文件提供以下属性。

给定以下内容：
- URL 文件夹路径 ("http://community.xx.com/yada/blah/AllItems.aspx")
- 文件名 ("MyFile.xls")
- UNC ("\community.xx.com\yada \blah\MyFile.xls")

以下属性所需的结果：
- 修改
者 - TimeLastModified
- UniqueID
- FileType
- Title

我猜 SPFile 和 SPUser 需要应用，但不清楚如何应用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:19:44.503

这实际上比你想象的要容易得多......

```
string fullItemUri = "http://community.xx.com/yada/blah/MyFile.xls";

using (SPSite site = new SPSite(fullItemUri))
using (SPWeb web = site.OpenWeb())
{
   SPListItem item = web.GetListItem(fullItemUri);

   string modifiedBy = item[SPBuiltInFieldId.Modified_x0020_By] as string;
   DateTime timeLastModified = item[SPBuiltInFieldId.Last_x0020_Modified] as DateTime;
   int uniqueID = item.ID;
   string fileType = item[SPBuiltInFieldId.FileType] as string;
   string title = item[SPBuiltInFieldId.Title] as string;
} 
```

有关更多信息，请参阅[SPBuiltInFieldId](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.spbuiltinfieldid_members.aspx)和[SPListItem](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.splistitem_members.aspx)的 MSDN 文章。

# python - python中的re.sub并不总是替换字符串

> ID：12976757
> 
> 赞同：0
> 
> 时间：2012-10-19T14:48:01.300
> 
> 标签：python, regex, python-2.7

当我尝试用另一个字符串替换一个字符串时，re.sub 方法并不总是发生这种情况。

```
sentence = '<date>2004/12/01</date>T09:38:27+01:00'+
           'Wed, <date>2012/9/05</date> 10:55:17 UTC %3C%3C%3C'

time_identifier = u'(?<=[\s\.,T])([\d]{2}[:]{1}[\d]{2}([:]{1}[\d]{2})*[\s\.,+]*(UTC|GMT|CEST|EDT|IST|BST)*(\d\d:\d\d)*)(?=[\s\.,T]|\Z)|'\
                  u'(?<=\A)([\d]{2}[:]{1}[\d]{2}([:]{1}[\d]{2})*[\s\.,+]*(UTC|GMT|CEST|EDT|IST|BST)*(\d\d:\d\d)*)(?=[\s\.,T]|\Z)'
time = re.search(time_identifier, sentence, flags=re.U|re.I)
    if time:
        try:
            sentence = re.sub(time.groups()[0], '<time>%s</time>'%time.groups()[0], sentence, flags=re.U|re.I)
        except:
            sentence = re.sub(time.groups()[4], '<time>%s</time>'%time.groups()[4], sentence, flags=re.U|re.I) 
```

对于上面提供的示例，我希望句子的输出是

```
<date>2004/12/01</date>T<time>09:38:27+01:00<time>
Wed, <date>2012/9/05</date> <time>10:55:17 UTC</time> %3C%3C%3C 
```

但是 re.sub 方法不会将原句中的“09:38:27+01:00”替换为

```
"<time>09:38:27+01:00</time>" 
```

任何人都可以请澄清原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:14:11.650

你的表达方式非常复杂。以下是匹配完全相同模式的简化：

```
time_identifier = u'(?:(?<=[\s\.,T])|\A)(\d\d:\d\d(:\d\d)*[\s\.,+]*(UTC|GMT|CEST|EDT|IST|BST)*(\d\d:\d\d)*)(?=[\s\.,T]|\Z)' 
```

由于前瞻断言（`(?=[\s\.,T]|\Z)`部分），您的时间字符串不匹配；它将匹配限制为后面跟空格、句号、逗号、字母`T`或字符串结尾的任何内容。您的第一个字符串紧跟`Wed`在句子中；没有空格。

以下`sentence`值*确实*匹配：

```
sentence = ('<date>2004/12/01</date>T09:38:27+01:00 '
            'Wed, <date>2012/9/05</date> 10:55:17 UTC %3C%3C%3C') 
```

请注意时区后的额外空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T16:39:08.910

你在这里有几个问题。首先，您的模式非常复杂。其次，您不能执行以下操作：

```
re.sub('09:38:27+01', "<time>'09:38:27+01'</time>, s) 
```

因为由于加号，字符串`s`与模式不匹配（我假设您的组包含正确的时间），因此不会标记字符串的一部分。这回答了你的问题。

以下适用于您的示例数据（尽管我可能过度简化了初始模式）：

```
p = '((?:\\d{2}:\\d{2}:\\d{2}\\+\\d{2}:\\d{2})|(?:\\d{2}:\\d{2}:\\d{2} UTC|GMT|CEST|EDT|IST|BST))'
result = re.findall(p, s)
print result
['09:38:27+01:00', '10:55:17 UTC']
r0 = result[0]
r0 = re.sub('\+', r'\+', r0)
s = re.sub(r0, "<time>%s</time>" % result[0], s)
s = re.sub(result[1], "<time>%s</time>" % result[1], s)
print s
'<date>2004/12/01</date>T<time>09:38:27+01:00</time>Wed, <date>2012/9/05</date> <time>10:55:17 UTC</time> %3C%3C%3C' 
```

希望能帮助到你。

# c# - 向属性访问器添加扩展方法

> ID：12976758
> 
> 赞同：6
> 
> 时间：2012-10-19T14:48:05.580
> 
> 标签：c#, extension-methods, accessor

我们在视图模型中执行了很多 INotifyPropertyChanged 实现，坦率地说，由于不便和美观的原因，我们已经厌倦了不得不在我们的代码中显式地触发属性更改事件。

我想在我们的属性的设置器上添加一个扩展，使生成的代码看起来像：

```
public string LazyAccessor
{
  get;
  set.notify();
} 
```

有没有办法做到这一点？如果没有，我们能发明一个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:54:22.960

查看[NotifyPropertyWeaver](https://github.com/SimonCropp/NotifyPropertyWeaver)。这将在构建过程中修改您的代码，以使您的属性实现该`INotifyPropertyChanged`模式。

这可作为[Visual Studio 扩展使用](http://visualstudiogallery.msdn.microsoft.com/bd351303-db8c-4771-9b22-5e51524fccd3)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T14:52:15.563

面向方面的编程可以解决您的问题。

请参阅[C# 中的面向方面编程](https://stackoverflow.com/questions/1416880/aspect-oriented-programming-in-c-sharp)。还有一些例子：http: [//www.codeproject.com/Articles/337564/Aspect-Oriented-Programming-Using-Csharp-and-PostS](http://www.codeproject.com/Articles/337564/Aspect-Oriented-Programming-Using-Csharp-and-PostS)

您的“set.notify()”可以与一些反射一起使用，但我认为这不是一个好的解决方案，您仍然需要实现 getter 和 setter。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-19T14:52:28.230

[扩展方法](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)只能添加到*类型*。自动属性上的 getter 和 setter 被编译器转换为带有支持变量的*方法*，因此无法在它们上放置扩展方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-19T14:53:48.620

> 有没有办法做到这一点？

不，没有，不像你发布的那样。扩展方法对*类型*进行操作，而不是 getter 或 setter。

> 如果没有，我们能发明一个吗？

这将需要更改 C# 规范——这不太可能发生。

您可以采取其他方法来缓解这种情况 - 例如，使用带有方法的基类，该方法将为您调用样板。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T14:57:34.813

你不能在片场本身做到这一点。那是一个动作。但是，您可能可以这样做：

```
public static class extensions()
{
  public static NotifyAccessorSet(this string value) { some code }
}

public class SomeClass()
{
  .....
  private string mAccessor;

  public string LazyAccessor{
     get { return mAccessor; }
     set { mAccessor = value; mAccessor.NotifyAccessorSet(); }
  }

} 
```

这有点出乎我的意料，请记住扩展方法将适用于所有类型的字符串，因此您可能希望实现自己的返回类型并将扩展方法应用于它。然后从lazyaccessor 返回该类型。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-19T14:54:13.357

他们没有进入 4.0，但传闻将包含在 5.0 中。

我发现[这种](http://www.codeproject.com/Articles/386911/Csharp-Easy-Extension-Properties)方法很有帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-08T07:36:25.357

您可以通过覆盖自定义通用结构的转换运算符来模拟“类似属性”的行为，而无需手动调用事件。以下是我的解决方案：

```
public struct column<TType>
{
    private TType _value;

    private column(TType value) : this()
    {
        _value = value;
    }

    private void Set(TType value)
    {
        // Implement your custom set-behavior...
    }

    private TType Get()
    {
        // Implement your custom get-behavior...
        return _value;
    }

    public override string ToString()
    {
        return _value.ToString();
    }

    public static implicit operator column<TType>(TType p)
    {
        column<TType> column = new column<TType>(p);
        column.Set(p);
        return column;
    }

    public static implicit operator TType(column<TType> p)
    {
        return p.Get();
    }
} 
```

我用泛型参数声明结构以避免转换错误。你可以像这样使用它：

```
public class Test
{
    public column<int> kKey;

    public column<float> dMoney;

    public column<string> cValue;

    public Test()
    {
        kKey   = 42;
        dMoney = 3.1415926f;
        cValue = "May the force be with you!";
    }
} 
```

...我知道，这个问题已经过时了，但它可能会在未来帮助某人。

# java - 从java中的文件读取错误

> ID：12976760
> 
> 赞同：0
> 
> 时间：2012-10-19T14:48:16.780
> 
> 标签：java, eclipse, file, jakarta-ee, compiler-errors

我编写了以下程序从文本фалйа中读取计算机数量，其中包含一个素数

```
import java.io.*;

public class ReadFromFile {

    /**
     * @param args
     * @throws IOException 
     */
    public static void main(String[] args) throws IOException {
        // TODO Auto-generated method stub

        int CountComputers=0;
        try {
        DataInputStream ConfigFile = new DataInputStream( new 
         FileInputStream("D:\\HadoopFolder\\ReadFromFile\\src\\countcomputers.txt"));
        CountComputers=ConfigFile.readInt();
        ConfigFile.close(); 
        } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
        }
        //CountComputers=ConfigFile.readInt();
        System.out.println("Количество компьютеров равно "+CountComputers);
    }

} 
```

结果我收到以下错误

```
Exception in thread "main" java.io.EOFException
    at java.io.DataInputStream.readInt(Unknown Source)
    at ReadFromFile.main(ReadFromFile.java:16) 
```

我是否也有一个问题，是否有必要在 try...expect 中结束从文件中读取（在一个项目中强调红色，而在其他项目中也强调了 java（它是其他类型的）否）。我是Java的初学者，因此请求理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:30:22.473

我没有发现您的代码有任何问题（只要您的输入文件包含数据）。无论如何，Java 都有很好的 AP ( `java.util.Scanner`) 来从文件中读取数据（从 JDK1.5 开始）。

```
Scanner scanner = new Scanner(new File("countcomputers.txt"));
if(scanner.hasNext()){
    data= scanner.nextInt();
}
else{
        System.out.println(" No Data found");
} 
```

这个逻辑也照顾`EOFException`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:56:18.870

java.io.EOFException - 此异常主要由数据输入流用来表示流结束。请注意，许多其他输入操作在流结束时返回一个特殊值，而不是引发异常。

我相信您正在阅读的文件中没有 int 试试这个 `CountComputers=Integer.valueOf(ConfigFile.readLine());`

# css - css 偶数列长度

> ID：12976761
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:48:19.153
> 
> 标签：css

> **可能重复：**
> [CSS 2 列布局：列高](https://stackoverflow.com/questions/6749706/css-2-column-layout-column-height)

我正在尝试创建 2 个长度均匀的列。我让它工作到一个扩展，但想知道如何将外部 div 的大小限制为内部内容。这样，外部 div 的重新大小取决于任一列所需的长度来显示其中的所有内容。

现在我的代码增加了很多额外的高度。

提前致谢！

这是我的代码的jsfiddle：

```
http://jsfiddle.net/Bk77A/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:02:46.937

我不会重复你所有的代码，但基本上你需要一个clearfix，然后设置容器高度：auto; 位置：相对。另外，为什么你的主要内容有太多的填充和负边距？摆脱它。

```
<div id="wrapper">
    <div.... innner divisions that are floated>
    </div... end of all inner divs>
    <div class="clearfix></div> (clearing our floats)
</div> (closing our wrapper)

css:

#wrapper {
    height:auto;
    position:relative;
    additional styling
}
.clearfix {
    clear:both;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:55:23.863

`padding-bottom: 9999px`为你的两个专栏摆脱这个

# android - Android sdk 活动流程

> ID：12976765
> 
> 赞同：1
> 
> 时间：2012-10-19T14:48:31.680
> 
> 标签：android, android-activity, sdk, exit, back

有人可以帮我复制以下场景：

我有一个活动 A，其中包含一些特定任务，应用程序从这些特定任务转到活动 B。当用户转到 B 并按下应用程序时，应用程序应该关闭（可能意味着活动 A 执行了完成（））。但在某些情况下，应用程序（不在用户操作上）返回到活动 A，状态保留到它转到 B 时的状态。问题是应用程序永远不知道它是否应该保留活动 A 以重新显示以后与否。希望我说清楚了。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T14:56:57.437

您可以使用 startActivityForResult() 启动 Activity B，并根据结果的功能，当我们回到 Activity A 时，Activity A 自己完成（）或不完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T14:54:18.823

您可以每次在其 onResume() 中填充您的 Activity A。对于持久性，您可以使用 SharedPreferences。

您可以在 Activity A 中设置一个 BroadcastReceiver，它会在收到消息时为 Activity A 调用 finish()。在关闭之前的活动 B 中，然后将该消息发送到活动 A 的广播接收器。

# installation - 在 NetBeans 安装程序中包含（捆绑）一个 JRE？

> ID：12976767
> 
> 赞同：1
> 
> 时间：2012-10-19T14:48:45.207
> 
> 标签：installation, bundle, netbeans-7, java

我在 NetBeans 平台 (RCP) 上开发了一个 Java Swing 应用程序。我想将 Windows JRE 包含在 NetBeans 生成的安装程序中，以防 PC 未安装 JRE，但我不知道如何执行此操作。我尝试按照以下说明进行操作，但失败了（我发现这些说明假定您完全了解 JDK 和 JRE 上的所有内容，例如，我会收到消息“pack200”不被识别为内部或外部命令......似乎有些路径是错误的或过时的）：

[如何在安装程序包中捆绑 JVM（JRE/JDK）？](http://wiki.netbeans.org/NBIBundledJVM)

[在 NetBeans 平台安装程序中包含 JRE](http://netbeans.dzone.com/including-jre-in-nbi)

[通过 Windows 的应用程序安装程序安装 JRE](https://blogs.oracle.com/geertjan/entry/installing_the_jre_via_an)

我正在尝试打包 JRE 版本 7u7

我的 JDK 文件夹结构如下：C:\Program Files\Java\

在这里我有以下两个文件夹： **jdk1.7.0_07**和**jre7**

请帮助我...非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T09:52:10.250

我在您的链接中按照“**通过 Windows 的应用程序安装程序安装 JRE** ”为我的 Netbeans 平台应用程序成功创建了一个 Windows 安装程序。你遇到了什么问题？

“ *'pack200' 不被识别为内部或外部命令*”是因为 %JAVA_HOME%/bin 不在您的 PATH（环境变量）中。您可以使用 "C:\Program Files\Java\jdk1.7.0_07\bin\pack200" -J-Xmx1024m rt.jar.pack.gz rt.jar 运行 pack200

顺便说一句，文章中的“app.conf=nbproject/my.conf”部分似乎已经过时了。我必须在我的项目中直接修改文件“build/launcher/etc/ *app_name.conf* ”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T17:30:48.910

也许本指南可以帮助您：

自包含应用程序：打包非 JavaFX 应用程序 [https://blogs.oracle.com/talkingjavadeployment/entry/packaging_improvements_in_jdk_7#3](https://blogs.oracle.com/talkingjavadeployment/entry/packaging_improvements_in_jdk_7#3)

*人们对自包含应用程序提出的常见问题之一——我可以将我的 Java 应用程序打包为自包含应用程序吗？绝对地。即使对于 JDK 7 更新 6 附带的工具也是如此。只需按照步骤为[具有集成 JavaFX 内容的 Swing 应用程序创建包，](https://blogs.oracle.com/talkingjavadeployment/entry/packaging_swing_apps_with_integrated)即使您的应用程序不使用 JavaFX，它们也可以工作。*

# android - 异常内存不足“Thread-451”prio=5 tid=11 RUNNABLE

> ID：12976768
> 
> 赞同：0
> 
> 时间：2012-10-19T14:48:45.907
> 
> 标签：android

我不是要下载图像。我正在尝试从服务器获取 json 响应。当反应很小时，一切顺利。但是当我有一个巨大的反应时，我得到了一个例外。

```
10-19 16:32:12.226: E/dalvikvm-heap(5504): Out of memory on a 33554448-byte allocation.
10-19 16:32:12.230: I/dalvikvm(5504): "Thread-451" prio=5 tid=11 RUNNABLE
10-19 16:32:12.230: I/dalvikvm(5504):   | group="main" sCount=0 dsCount=0 obj=0x418c44d0 self=0x50ecd140
10-19 16:32:12.230: I/dalvikvm(5504):   | sysTid=5723 nice=0 sched=0/0 cgrp=apps handle=1361164216
10-19 16:32:12.230: I/dalvikvm(5504):   | schedstat=( 0 0 0 ) utm=176 stm=69 core=0
10-19 16:32:12.258: I/dalvikvm(5504):   at org.apache.http.util.CharArrayBuffer.expand(CharArrayBuffer.java:~59)
10-19 16:32:12.258: I/dalvikvm(5504):   at org.apache.http.util.CharArrayBuffer.append(CharArrayBuffer.java:77)
10-19 16:32:12.258: I/dalvikvm(5504):   at org.apache.http.util.EntityUtils.toString(EntityUtils.java:136)
10-19 16:32:12.258: I/dalvikvm(5504):   at org.apache.http.util.EntityUtils.toString(EntityUtils.java:146)
10-19 16:32:12.265: I/dalvikvm(5504):   at fr.haploid.webservices.parsers.WebServiceJSONObjectParser$MyNetworkThread.work(WebServiceJSONObjectParser.java:198)
10-19 16:32:12.265: I/dalvikvm(5504):   at fr.haploid.webservices.parsers.WebServiceParser$NetworkThread.run(WebServiceParser.java:653)
10-19 16:32:12.273: W/dalvikvm(5504): threadid=11: thread exiting with uncaught exception (group=0x40fb4300)
10-19 16:32:12.297: E/AndroidRuntime(5504): FATAL EXCEPTION: Thread-451
10-19 16:32:12.297: E/AndroidRuntime(5504): java.lang.OutOfMemoryError
10-19 16:32:12.297: E/AndroidRuntime(5504):     at org.apache.http.util.CharArrayBuffer.expand(CharArrayBuffer.java:59)
10-19 16:32:12.297: E/AndroidRuntime(5504):     at org.apache.http.util.CharArrayBuffer.append(CharArrayBuffer.java:77)
10-19 16:32:12.297: E/AndroidRuntime(5504):     at org.apache.http.util.EntityUtils.toString(EntityUtils.java:136)
10-19 16:32:12.297: E/AndroidRuntime(5504):     at org.apache.http.util.EntityUtils.toString(EntityUtils.java:146)
10-19 16:32:12.297: E/AndroidRuntime(5504):     at fr.haploid.webservices.parsers.WebServiceJSONObjectParser$MyNetworkThread.work(WebServiceJSONObjectParser.java:198)
10-19 16:32:12.297: E/AndroidRuntime(5504):     at fr.haploid.webservices.parsers.WebServiceParser$NetworkThread.run(WebServiceParser.java:653)
10-19 16:37:12.367: I/Process(5504): Sending signal. PID: 5504 SIG: 9 
```

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:14:52.100

不幸的是，没有什么魔法可做！您需要更改 Web 服务以更轻松地发送 json 文件。我相信你可以将你的 json 文件分成几个部分。如果它是一个很长的列表，你可以考虑例如分页。

# php - 语法错误：意外的 EOF

> ID：12976772
> 
> 赞同：1
> 
> 时间：2012-10-19T14:48:54.117
> 
> 标签：php, javascript, syntax-error, line-breaks

我将此代码添加到我的`php`页脚中：当我在 HTML 文档中使用相同的语法时，一切对我来说都很好。

```
 <body>
    ...

        <script type="text/javascript">     

        // Browser detection
        function checkBrowserName(name){ 
        var agent = navigator.userAgent.toLowerCase();  
        if (agent.indexOf(name.toLowerCase())>-1) {  
        return true;  
        }  
        return false;  
        }  

        if(checkBrowserName('opera')){
        /* load nothing */
        }

        else if(checkBrowserName('')) {
        /* else if(checkBrowserName('firefox') || ('msie') || ('safari') || ('konqueror') || ('omniweb') || ('webtv') || ('icab') || ('compatible')) { */

        // Insert script
        document.write('<script src="assets/javascripts/hyphenate.min.js" type="text/javascript"></script>');
        document.write('<\/script>');

        // Script options
        document.write('<script type="text/javascript">');
        document.write('Hyphenator.config({');
        document.write('displaytogglebox : false,');
        document.write('minwordlength : 4');
        document.write('});');
        document.write('Hyphenator.run();');
        document.write('<\/script>');

        }
        </script>
    ...
    </body> 
```

我的换行符有问题吗？

当我编写这样的代码时，它将为我工作：

```
<script type="text/javascript" src="assets/javascripts/hyphenate.min.js"></script>
<script type="text/javascript">

Hyphenator.config({
    displaytogglebox : false,
    minwordlength : 4
});
Hyphenator.run();

</script> 
```

感谢您的
帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T14:51:29.717

您不能写入`</script>`字符串，因为此时解析结束。
只是逃避它：

```
document.write('<script src="assets/javascripts/hyphenate.min.js" type="text/javascript"><\/script>'); 
```

（就像你其他时候做的那样......）

# android - 从资产中打开 TXT 文件并读取字符串的最佳方法是什么？

> ID：12976773
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:48:55.613
> 
> 标签：android, inputstream, assets

我需要检查资产文件夹中是否存在 txt 文件，如果存在，我需要读取它的文本并将其放入字符串中。

我在 Google 上看到了一些从资产中打开文件的方法，但我找不到可以让您检查文件是否存在然后从中读取字符串的方法（因为是文本资源）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:10:25.610

当找不到这样的文件时，您可以正确处理异常：

```
try {

    InputStream is = SplashscreenActivity.this.getAssets().open("yourTextFile.txt");

} catch (IOException e) {
    // catch your exception properly when the file isn't found
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-19T14:53:07.033

简而言之，您必须已经假设知道文件是否存在于**资产**中。因为一旦您构建了 .apk 文件，assets 文件夹就会被文件打包，并且永远无法更改。

因此，验证文件是否存在是相当蹩脚的。它只会包含您自己添加的那些文件。

此外，如果您想使用`R`file 来帮助您找到文件名，那么只需将您的文件放在一个名为**raw**的文件夹中。**它是资产**的替代品，但保存在此文件夹中的文件在`R`类文件中被引用 - 使其更容易获取资源。

# linux - 为什么 Nexus 的垃圾文件夹永远不会清空？

> ID：12976774
> 
> 赞同：9
> 
> 时间：2012-10-19T14:48:56.360
> 
> 标签：linux, maven, nexus

对于我的 maven 企业存储库，我使用 Sonatype Nexus，部署为 Tomcat6 webapp。

我已经配置了默认快照清理任务。不幸的是，每个星期（或每对星期，不知道确切），那台机器达到 100% 磁盘占用，我必须进入`/usr/share/tocmat6/sonatype-work/nexus/storage/snapshots/.nexus/trash`文件夹执行`rm -rf`.

这真是太愚蠢了！而且我很确定这是我自己的愚蠢。那么，我该怎么做才能让垃圾清空任务真正清理该文件夹？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-19T14:53:53.663

您需要配置一个任务来清理垃圾

*   前往联结
*   以管理员身份登录
*   转到管理 -> 计划任务
*   添加任务类型`Empty trash`

这些说明应该适用于 nexus 1.8 及更高版本。它们可能适用于以前的版本，但我没有安装任何版本。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-19T14:57:09.793

原来“空垃圾”的默认配置是删除超过`180`几天的项目！这显然不适合持续集成服务器！我将该值更改为`5`天。

# joomla - Joomla 2.5：在共享模块中显示列表中的单篇文章

> ID：12976778
> 
> 赞同：2
> 
> 时间：2012-10-19T14:49:00.183
> 
> 标签：joomla

我有一个带有菜单项的主菜单，单击这些菜单项时会根据类别动态显示内容。

在同一页面上，我有一个包含新闻文章列表（与任何菜单无关）的部分，其中显示了介绍文本，每篇文章都有一个阅读更多按钮。

我想单击阅读更多按钮并加载加载主菜单内容的完整文本（共享同一模块）。

现在，它只是加载新闻文章列表。

1.只显示我点击的文章和2.显示完整的文本，我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T21:31:35.590

每次我在主页上使用包含任何类别内容的模块时都会遇到这个问题。当我单击阅读更多时，将出现主页而不是文章。

解决方案很简单：我总是使用菜单管理器创建一个“隐藏菜单”，并创建一个菜单元素作为与此类别相关的类别博客布局。此解决方案意味着隐藏菜单模块不会出现在网站上，但文章将包含来自网站上使用的任何模块的全文。

# objective-c - insertNewObjectForEntityForName 返回 nil

> ID：12976780
> 
> 赞同：5
> 
> 时间：2012-10-19T14:49:01.650
> 
> 标签：objective-c, ios, core-data, insert

自从它为 iOS 发布以来，我一直在使用 Core Data，但我无法弄清楚我的一个实体的 insertNewObjectForEntityForName 方法调用发生了什么。当该方法被调用时，它只返回一个*nil*对象并且不会抛出异常。

这是代码：

```
@try {
    self.observation = [NSEntityDescription insertNewObjectForEntityForName:@"Observation" inManagedObjectContext:moc];
    NSLog(@"No exception on insert");
}
    @catch (NSException *exception) {
    NSLog(@"Insert exception - %@", exception.description);
}
NSLog(@"observation: %@", self.observation ? self.observation.description : @"nil"); 
```

这是输出：

```
2012-10-19 10:16:08.749 Track[63779:c07] No exception on insert
2012-10-19 10:16:08.750 Track[63779:c07] observation: nil 
```

我可以在我的 ERD 中的所有其他实体上执行插入。正是这个在嘲笑（*双关语*）我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-21T18:48:19.683

（Xcode 7.2 Swift 项目）重命名实体后，我的数据模型变得混乱并在执行时开始返回 nil 对象`insertNewObjectForEntityForName`。以下是我为解决此问题所做的三件事：

1.  我首先使用了@PhillipMills 的建议：`po mainQueueContext.persistentStoreCoordinator?.managedObjectModel` 在输出中我看到“managedObjectClassName”是带有项目前缀的旧实体/类名称。

    > ... NewEntityName = "(< NSEntityDescription: 0x7f9773783440>) 名称 DetectedData, managedObjectClassName MyProject.OldEntityName, ...

2.  为了解决这个问题，我删除并重新创建了实体。但这在插入时也返回了 nil 对象。我查看了界面生成器，发现 Class 字段是空白的。我设置了类名来解决这个问题。 [![Xcode 数据模型检查器](../Images/42067f58ce72b4e5e53217bbbb1d8e02.png)](https://i.stack.imgur.com/C09mT.png)

3.  在此过程中的某个时刻，Xcode 生成的 Swift 文件存在第三个问题：

缺少 objc() 声明：

```
import Foundation
import CoreData

class NewEntityName: NSManagedObject {
    // Insert code here to add functionality to your managed object subclass
} 
```

固定版本：

```
import Foundation
import CoreData

@objc(NewEntityName) //THIS WAS MISSING
class NewEntityName: NSManagedObject {
    // Insert code here to add functionality to your managed object subclass
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T17:15:35.567

看不到任何错误，除非您在某些或所有情况下覆盖 -description 以返回 @"nil" - 我会怀疑.... :) ps，如果您在 try 块中记录 observation.description 会怎样？

**编辑** 将此评论作为答案发布，以便您接受。不会打印出 nil 对象（null）吗？因此，事实上，您必须在 NSManagedObject 的描述方法中逐字记录 @"nil"。不？;)

或者，这可能是一些故障问题吗？在三元子句中记录不同的文字而不是 .description (log @"Yes" : @"No") 以检查它是否是属性问题。

# .net - 如何为布尔创建编辑器模板？(.EditorFor<>)

> ID：12976784
> 
> 赞同：4
> 
> 时间：2012-10-19T14:49:11.087
> 
> 标签：.net, asp.net-mvc, razor

我正在尝试使用以下代码定义一个 Boolean.cshtml 以与 EditorFor 一起使用：

```
@{
   var o = ViewData.ModelMetadata;
}

<div class="editor-for">
    @Html.CheckBox(o.PropertyName,
                   ViewData.Model,
                   new { @class="tickbox-single-line" })
</div> 
```

不幸的是，模型为空，我收到以下非描述性错误：

> CS1973：“System.Web.Mvc.HtmlHelper”没有名为“CheckBox”的适用方法，但似乎具有该名称的扩展方法。扩展方法不能动态调度。考虑强制转换动态参数或在没有扩展方法语法的情况下调用扩展方法。

阅读本文后，我尝试了以下方法：

```
@Html.CheckBox(o.PropertyName,
               ViewData.Model ?? false,
               new { @class="tickbox-single-line" }) 
```

但我得到完全相同的错误。查看代码很简单：

```
@Html.EditorFor(m => m.RememberMe) 
```

我在 Boolean.cshtml 中做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-19T14:55:59.667

不确定这是最好的方法，但我认为你只是有一个问题`ViewData.Model`，即（如果我没记错的话），动态有问题的事情。

所以...投吧！

```
@{
   var o = ViewData.ModelMetadata;
   bool model = (bool)ViewData.Model;
}

<div class="editor-for">
    @Html.CheckBox(o.PropertyName,
                   model,
                   new { @class="tickbox-single-line" })
</div> 
```

但如果我没记错的话，`EditorTemplate`宁愿看起来像

```
@model bool

<div class="editor-for">
   @Html.CheckBox("", Model, new{@class="tickbox-single-line"})
<div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T17:54:56.323

这有点晚了，但您也可以使用 CheckBoxFor 来简化它。

我的 EditorTemplate 很简单：

```
@model bool

@Html.CheckBoxFor(m => m) 
```

# javascript - JSON - 在 Internet Explorer 8 中不起作用

> ID：12976801
> 
> 赞同：1
> 
> 时间：2012-10-19T14:50:03.693
> 
> 标签：javascript, jquery, json

我尝试了几件事来修复，没有任何帮助。

在服务器端脚本中，

```
 $array['content'] = "test";
 echo json_encode($array); 
```

这是在javascript中工作的。但

```
 $array['content'] = "<p>test</p>";
 echo json_encode($array); 
```

不工作。如果我添加任何 html 标签，它就不起作用。但他们都在 Firefox 和 chrome 中工作。

这是处理返回值的js。

```
 function showResponse(responseText)  {
     $('.form_result').html(responseText.formData);
      alert(responseText.formData);
 }

 function submitButton1() {

    var options = {
        beforeSubmit:  showRequest,  // pre-submit callback
        success:       showResponse,  // post-submit callback
        dataType: 'json',
        cache: false
    };

    // bind form using 'ajaxForm'
    $('#form').ajaxSubmit(options);
 }

     header("Cache-Control: no-cache, must-revalidate");
header("Expires: 0"); 
```

在 php 文件中添加了上述两行。

```
 <meta http-equiv="X-UA-Compatible" content="IE=8" /> 
```

在处理 js 的 html 文件中添加了上述内容。还是没用。

可能是什么问题呢？另外，我在 IE 中没有看到任何错误或警告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:52:07.127

Internet Explorer 8 不支持 jQuery 使用的 XMLHttpRequest 对象中的 CORS ie8 使用 XDomainRequest 对象

jQuery 默认不支持 XDomainRequest。

检查此[更新可用于 Internet Explorer 8 中的本机 JSON 功能](http://support.microsoft.com/kb/976662)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-16T15:11:45.997

我不知道是什么问题，但如果禁用`enctype="multipart/form-data"`所有工作正常。
我猜这是ajax表单插件问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-16T15:37:00.693

我还没有尝试过，但是如果您搜索现有的 XMLHttpRequest 对象，但它不存在，那么请实现您自己的 ajax 调用。

还要检查 JSON 是否存在，如果不包含 json.js，只需从 github 下载并动态添加即可。

# algorithm - 从给定的二叉树创建祖先矩阵

> ID：12976809
> 
> 赞同：-1
> 
> 时间：2012-10-19T14:50:24.897
> 
> 标签：algorithm, data-structures, binary-tree

问题是，给定一个祖先矩阵，作为 1 和 0 的位图，构造相应的二叉树。谁能给我一个关于如何做的想法？我在[Stackoverflow](https://stackoverflow.com/questions/12664257/create-ancestor-matrix-for-binary-tree)找到了一个解决方案，但是这行`a[root->data][temp[i]]=1`似乎是错误的，没有绑定节点将包含数据 1 到 n。它可能包含，比如 2000，在这种情况下，将没有`a[2000][some_column]`，因为只有 7 个节点，因此矩阵中有 7 行和列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:20:08.950

两种方式：

1.  标准化您的节点值，使它们都从 1 到`n`. `1, 2, 5000`例如，如果您有节点，请将它们设为`1, 2, 3`. 您可以通过对标签进行排序或散列并保留类似`normalized[i] = normalized value of node i`. `normalized`如果您有非常大的标签甚至是文本标签，则可以是地图/哈希表。

2.  您可能可以为此使用[稀疏矩阵](http://en.wikipedia.org/wiki/Sparse_matrix)，可通过哈希表或集合实现：保留哈希表的哈希表。存储另一个存储您的值`H[x]`的哈希表。`y`因此，如果在一个简单的矩阵解决方案中`a[2000][5000] = 1`，您将使用=> 返回存储在第 2000 行的值`H.get(2000)`的哈希表=> => 返回您想要的值。`H'``H'.get(5000)`

# entity-framework - 实体框架，从断开区域更新实体时违反参照完整性约束发生错误

> ID：12976813
> 
> 赞同：2
> 
> 时间：2012-10-19T14:50:48.430
> 
> 标签：entity-framework, entity-framework-5

我有以下型号

```
public class Order
{
    [Key]
    public virtual string OrderNo {get;set;}
    public virtual IList<OrderItem> Items {get;set;}
}

public class OrderItem
{
    [Key]
    public virtual string ItemNo {get; set;}
    public virtual string ParentItemNo {get;set;}
    public virtual string OrderNo {get;set;}

    public virtual OrderItem ParentItem {get;set;}
    public virtual IList<OrderItem> ChildItems {get;set;}
    public virtual IList<ItemProperty> ItemProperties {get;set;}
    public virtual Order Order {get;set;}
}

public class ItemProperty
{
    [Key]
    public virtual string PropertyNo {get; set;}
    public virtual string ParentPropertyNo {get;set;}
    public virtual string OrderItemNo {get;set;}

    public virtual ItemProperty ParentProperty {get;set;}
    public virtual IList<ItemProperty> ChildProperties {get;set;}
    public virtual OrderItem OrderItem {get;set;}
} 
```

我在断开连接的区域运行（服务与实体框架上下文断开连接）

1.  我创建一个订单并保存到数据库

客户：

```
service.CreateOrder(new Order() { OrderN="fksjdf1" }); 
```

服务器：

```
using(EfDbContext context = new EfDbContext())
{
    context.Orders.Add(order);
    context.SaveChanges();
} 
```

1.  我需要在之前添加的订单中添加一个或多个 OrderItem

客户：

```
var order = service.GetOrder("fksjdf1");

var item1 = new OrderItem();
item1.ItemNo="i1";
item1.Order=order;
item1.OrderNo=order.OrderNo;
item1.ItemProperties.Add(new ItemProperty()
    PropertyNo="p1",
    OrderItem = item1
})
order.Items.Add(item1);

var item2 = new OrderItem();
item2.ItemNo="i2";
item2.Order=order;
item2.OrderNo=order.OrderNo;
item2.ItemProperties.Add(new ItemProperty()
    PropertyNo="p2",
    OrderItem = item2
});
item2.ItemProperties.Add(new ItemProperty()
    PropertyNo="p3",
    OrderItem = item2
})
order.Items.Add(item2);
service.UpdateOrder(order); 
```

服务器：

```
using(EfDbContext context = new EfDbContext())
{
    DbEntityEntry dbEntityEntry = context.Entry(order);
    if (dbEntityEntry.State == EntityState.Detached)
    {
        // ERROR
        context.Set<Order>().Attach(order);
    }

    dbEntityEntry.State = EntityState.Modified;
    context.SaveChanges();
} 
```

错误：发生引用完整性约束冲突：定义引用约束的属性值在关系中的主体对象和依赖对象之间不一致。

为什么我看到这个错误？为什么我不更新这个实体？

如何从断开连接的区域使用实体框架？

编辑1：

```
public Order GetOrder(string orderNo)
{
using (EfDbContext context = new EfDbContext())
            {
                context.Configuration.ProxyCreationEnabled = false;
                var order = context.Orders
                    .Include(o => o.OrderItems
                                      .Select(z => z.ItemProperties
                                                       .Select(y => y.ChildProperties)))
                                                       .Where(o => o.OrderNo == orderNo)
                    .FirstOrDefault();
            }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:43:17.443

你可能有这个错误，因为你没有设置`OrderItemNo`，`ItemProperty`像这样：

```
var item1 = new OrderItem();
item1.ItemNo="i1";
item1.Order=order;
item1.OrderNo=order.OrderNo;
item1.ItemProperties.Add(new ItemProperty {
    PropertyNo="p1",
    OrderItem = item1,
    OrderItemNo = item1.ItemNo // = "i1"
});
order.Items.Add(item1);

// and the same for item2 
```

当订单附加到上下文时，相关的订单项目和项目属性也会附加。的导航属性引用具有您提供的键 ( ) 的实体`OrderItem`，但外键没有此键值。这就是异常抱怨的不一致。`ItemProperty``"i1"``OrderItemNo`

**编辑**

不幸的是，更新数据库中的分离对象图并不容易。将实体的状态设置为`Modified`仅将此实体标记为`Modified`不相关实体。

您的`GetOrder`方法使事情变得复杂，因为您急切地向客户端加载已经存在的项目和更多相关的东西，然后`OrderItem`在客户端添加新的 s 并将这个新的修改后的对象图发送回服务器。在服务器端，您现在遇到的问题是您必须以不同的方式处理已经存在的项目（不要将它们插入数据库）而不是新项目（将它们插入数据库）。为此，您需要检测哪些项目是旧的，哪些是新的。如果您不在实体本身中传输一些指示实体是否为新实体的标志，则必须再次查询数据库并将从数据库加载的对象图与从客户端发送的分离对象图进行比较。如何完成的一般草图如下：[https://stackoverflow.com/a/5540956/270591](https://stackoverflow.com/a/5540956/270591)（这仅适用于有子收藏的父母。如果涉及孙子收藏 - 就像在您的模型中一样 - 它会变得更加复杂。）

在我看来，你可以简化整个过程，如果你不仅有这个全局`service.UpdateOrder(order)`方法来尝试处理对象图中所有可能的变化，而且还有一些专门的方法可以利用你对图形变化的了解——在这种情况下一种将新`OrderItem`的 s 添加到现有订单的特殊方法。它可能看起来像这样：

```
var order = service.GetOrder("fksjdf1");

var newOrderItems = new List<OrderItem>();

var item1 = new OrderItem();
item1.ItemNo="i1";
item1.OrderNo=order.OrderNo; // leave the Order property null
item1.ItemProperties.Add(new ItemProperty { PropertyNo="p1" });
newOrderItems.Add(item1);

// the same for item2
newOrderItems.Add(item2);

service.AddNewOrderItems(newOrderItems); 
```

服务方法是：

```
public void AddNewOrderItems(List<OrderItem> newOrderItems)
{
    using(EfDbContext context = new EfDbContext())
    {
        foreach (var newOrderItem in newOrderItems)
            context.Set<OrderItem>().Add(newOrderItem);

        context.SaveChanges();
    }
} 
```

# ios - 在 UITabbar 上方使用 UIToolbar - 有可能吗？

> ID：12976816
> 
> 赞同：2
> 
> 时间：2012-10-19T14:51:00.387
> 
> 标签：ios, uitabbar, uitoolbar

[我的](https://stackoverflow.com/questions/9350421/adding-a-uitoolbar-above-a-uitabbar-logic-issue)问题与此类似，但在那里没有完全回答。

我想要做的，是将一个现有的基于导航的应用程序`UIToolbars`在个人的底部有不同的`UITableViews`转换成一个有`UITabbar`界面的应用程序。其中一个选项卡应显示与现有应用程序相同的 UITableView 数据层次结构（显示某种层次结构数据），而其他选项卡将分配其他无关紧要的内容（例如：设置、帮助...）这里。这个想法是允许用户从导航堆栈的任何阶段快速切换到“帮助”屏幕 - 并返回。

例如，使用 3 个选项卡：

```
 1\. Database root (UIToolbar) - folder 1 (UIToolbar) - file 1.1
                                                     - file 1.2
                              - folder 2 (UIToolbar) - file 2.1
                                                     - file 2.2
 2\. Help (no UIToolbar)
 3\. Settings (no UIToolbar) 
```

我从未在任何现有应用程序中看到过这样的设计，尽管[上面引用的问题](https://stackoverflow.com/questions/9350421/adding-a-uitoolbar-above-a-uitabbar-logic-issue)表明实际上可以将现有 UIToolbars 从旧应用程序中保留下来，并将它们简单地放在标签栏上方。

这是

*   技术上可行（没有问题，例如设备旋转）？
*   接口指南允许吗？

尽管示例代码将不胜感激，但我主要想知道是否值得尝试构建这样的应用程序 - 或者这样的设计首先是否是一个坏主意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:55:37.350

你可以在任何地方拥有一个 UITabBar，你只是不会使用它的控制器。您必须编写自己的控制器并处理设备旋转期间发生的事情（或使用 iOS 6 的自动布局功能）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T13:34:51.790

我试过了，现在我可以回答我自己的问题了：

*   如果您确保每个选项卡的视图都可以旋转，这是可能的，并且设备旋转没有问题。
*   虽然它看起来有点不寻常，但我觉得它非常有用。当然，它需要一些垂直空间。

至于实现，我发现它非常简单：我所要做的就是使用 Interface Builder 插入 a`UITabBarController`代替我原来的 main`UIViewController`并将后者移动到前者的第一个选项卡。然后用 inside 创建更多选项卡，`UIViewControllers`并将它们的类重命名为我其他现有的`UIViewControllers`. 最后，在相关的界面构建器检查器窗格中手动为所有这些控制器设置关联的 NIB 文件（因为它们现在不再由我的代码实例化）并更改一行代码以制作`UITabBarController`控制器`root`。

结果：`UIToolbar`出现在`UITabbar`第一个选项卡的上方，但不显示其他选项卡。它的位置是固定的（当滚动列表或类似时），但它会与标签栏和其他所有内容一起自动旋转。

# iphone - UIImagePickerController 在拍摄和选择图像时会导致内存警告

> ID：12976818
> 
> 赞同：3
> 
> 时间：2012-10-19T14:51:03.163
> 
> 标签：iphone, ios, uikit, uiimagepickercontroller

我正在使用简单的“UIImagePickerController”解决内存问题。我收到两个内存警告：一个在我拍摄图像时，一个在我触摸“使用”按钮时......最好的是，这只会附加在 4S 上（恰好是我老板的电话）。我什至无法在其他型号的 iPhone 上重现此错误（在 3G、3GS、4 和 5 上测试）。

我尝试了不同的东西，这是能够重现问题的最简单的例子：

```
UIImagePickerController *picker = [[UIImagePickerController alloc] init];

picker.sourceType = UIImagePickerControllerSourceTypeCamera;

picker.delegate = self;

[self presentModalViewController:picker animated:YES];

[picker release]; 
```

我实现了委托方法：

```
- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker
{
    [picker dismissModalViewControllerAnimated:YES];
}

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{

// should do something with the [[info objectForKey:UIImagePickerControllerOriginalImage] retain];

    if (picker.sourceType == UIImagePickerControllerSourceTypeCamera)
        UIImageWriteToSavedPhotosAlbum(selectedImage, nil, NULL, nil);

    [picker dismissModalViewControllerAnimated:YES];

} 
```

有谁知道这个问题并希望有解决方案？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T10:39:22.247

这是很常见的。只要您处理内存警告而不会崩溃并且有足够的空间继续运行，就不要让它驱动...

# android - Google Play 显示隐含的 READ_EXTERNAL_STORAGE 权限

> ID：12976822
> 
> 赞同：12
> 
> 时间：2012-10-19T14:51:24.223
> 
> 标签：android, permissions, google-play

在 Google I/O 上宣布 Android 4.1 JellyBean (API 16) 时，它引入了以下权限：

> READ_EXTERNAL_STORAGE
> 
> 提供对外部存储的受保护读取访问。默认情况下，在 Android 4.1 中，所有应用程序仍然具有读取权限。这将在未来的版本中进行更改，以要求应用程序使用此权限明确请求读取访问权限。如果您的应用程序已经请求写入权限，它也会自动获得读取权限。有一个新的开发人员选项可以打开读取访问限制，以便开发人员根据 Android 未来的行为来测试他们的应用程序。

[http://developer.android.com/about/versions/android-4.1.html#Permissions](http://developer.android.com/about/versions/android-4.1.html#Permissions)

我有一个应用程序标记 API 16 并需要 WRITE_EXTERNAL_STORAGE 权限。我正准备部署更新，并注意到 READ_EXTERNAL_STORAGE 权限现在在开发人员门户中列为必需权限。对于上周部署的更新，它未在 Google Play 中列为必需的权限。此应用程序未明确请求 READ_EXTERNAL_STORAGE 权限。

已授予此应用程序的 WRITE_EXTERNAL_STORAGE 权限的用户在更新应用程序时是否会被提示授予额外的、隐式的 READ_EXTERNAL_STORAGE 权限？

**更新：**

我们已经发布了应用程序，JellyBean 设备会自动更新，无需请求 READ_EXTERNAL_STORAGE 权限。在未来的版本中，当我明确声明对 READ_EXTERNAL_STORAGE 的要求时，是否会要求已经授予 WRITE_EXTERNAL_STORAGE 权限的用户授予 READ_EXTERNAL_STORAGE 权限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T23:41:28.193

只要`READ_EXTERNAL_STORAGE`您有`WRITE_EXTERNAL_STORAGE`. 以前，操作系统没有强制对外部存储进行只读访问，这种情况正在发生变化，您现在必须请求它。但是，如果您具有写访问权限，您将隐式获得读访问权限。

来自[http://developer.android.com/training/basics/data-storage/files.html](http://developer.android.com/training/basics/data-storage/files.html)

> 如果您的应用需要读取外部存储（但不写入），那么您需要声明 READ_EXTERNAL_STORAGE 权限...
> 
> 但是，如果您的应用程序使用 WRITE_EXTERNAL_STORAGE 权限，那么它也隐式地拥有读取外部存储的权限。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-17T21:03:11.430

从 API 19 (Android 4.4) 开始，您必须明确指定`READ_EXTERNAL_STORAGE`权限。是的，如果您有`WRITE_EXTERNAL_STORAGE`权限，您将被隐式授予`READ_EXTERNAL_STORAGE`，但如果您需要对外部存储的只读访问权限，则必须指定`READ_EXTERNAL_STORAGE`.

证明链接：http : [//developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE](http://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE)

# android - 支持多屏的最佳方式？- 安卓

> ID：12976831
> 
> 赞同：2
> 
> 时间：2012-10-19T14:51:52.603
> 
> 标签：android, android-layout, android-screen-support

我已经在我的应用程序上工作了几个月，它即将发布。我还有一件事要做，就是让它支持多屏。我已多次阅读 android 开发人员文档，但我仍然对实现此功能的最佳方法感到困惑。

我应该为我想要支持的每种屏幕类型和分辨率创建多个布局文件吗？如果我这样做了，那么我将不得不为每个分辨率渲染多张图片，这对于某人下载来说会很麻烦。

感谢您在高级的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T14:57:29.963

如果您想为不同的屏幕设置不同的布局，那么是的，您需要为每个屏幕设置单独的布局。如果您希望相同的布局只是缩放，那么您需要做的就是确保所有尺寸都在 dp 或 sp，不要在任何地方使用 px。Android 将负责其余的工作。

就图像而言，即使您没有单独的布局，您也应该使它们具有不同的分辨率，以便它们在不同的屏幕密度下看起来更好。我会说至少每个图像都有 mdpi 和 hdpi 分辨率。

# jquery - jquery 我如何隐藏 50% 的元素？

> ID：12976836
> 
> 赞同：0
> 
> 时间：2012-10-19T14:52:09.530
> 
> 标签：jquery

好的，我找不到这个的答案....并希望得到帮助....

我想隐藏一个元素的 50%，或者如果元素超出 X 个子级，则隐藏。

```
<ul>
  <li>
    <div></div>
    <div></div>
    <div></div>
   </li>
<ul> 
```

如果此列表中有超过 3 个 div - 隐藏它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:00:24.113

您可以通过编程方式获取孩子并决定在您的代码中对哪些孩子进行操作：

```
function hideChildrenAbove(n) {
    var items = $("#list li").children();
    for (i = n; i < items.length; i++) {
        items.eq(i).hide();
    }
}

hideChildrenAbove(3);​ 
```

工作示例：http: [//jsfiddle.net/jfriend00/SmVfA/](http://jsfiddle.net/jfriend00/SmVfA/)

* * *

`:gt(n)`或者您可以使用并让选择器完成工作来动态构建选择器字符串：

```
function hideChildrenAbove(n) {
    $("#list li div:gt(" + (n - 1) + ")").hide();
}

hideChildrenAbove(3);​ 
```

工作示例：http: [//jsfiddle.net/jfriend00/pAdqn/](http://jsfiddle.net/jfriend00/pAdqn/)

* * *

这是一个示例，其中单击孩子会导致任何超过 3 岁的孩子切换：

```
function toggleChildrenAbove(parent, n) {
    var items = $(parent).children();
    for (i = n; i < items.length; i++) {
        items.eq(i).toggle();
    }
}

$("#list li").click(function() {
    toggleChildrenAbove(this, 3);
}); 
```

工作示例：http: [//jsfiddle.net/jfriend00/9nQPL/](http://jsfiddle.net/jfriend00/9nQPL/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:58:00.587

**CSS：**

```
ul li div{
   display:none;
} 
```

**JavaScript：**

```
$('ul li div:lt(3)').show(); 
```

这使用“小于”的 JQuery 选择器。这样做可能有一种更简洁的方法，但是如果您知道您只想显示第一个 3 个 div，那么这应该可以工作。

[http://api.jquery.com/lt-selector/](http://api.jquery.com/lt-selector/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T14:58:48.873

首先，您需要计算元素。在这种情况下会。

```
var elementCount = $("li").children("div").length; 
```

然后你躲起来

```
$("li").children("div").css("display", "none"); 
```

如果您可以在标签中添加一个ID，那就太好了

# iphone - 有人可以将从应用商店下载的 ipa 重新分发给越狱用户吗？

> ID：12976837
> 
> 赞同：0
> 
> 时间：2012-10-19T14:52:12.883
> 
> 标签：iphone, ios, app-store, jailbreak

也就是说，从app store下载的ipa可以直接安装在越狱的iPhone上吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:08:39.660

不，不幸的是，您必须先破解 .ipa 文件。

这可以在像 Crackulous 这样的应用程序中完成。[在这里的疯狂信息](http://hackulo.us/wiki/Crackulous)

# javascript - 车把模板中的新行

> ID：12976842
> 
> 赞同：2
> 
> 时间：2012-10-19T14:52:23.163
> 
> 标签：javascript, jquery, handlebars.js, mustache

使用 Handlebar/Mustache，我想显示地址如下（使用新行）：

```
{{FirstName}}{{LastName}}
{{Address1}}{{Address2}}
{{City}}
{{State}}
{{Zip}} 
```

但是上面的内容总是呈现在一行中。我尝试使用 \n 但它不起作用。是否可以在模板中处理新行（\n）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:56:26.907

在模板中添加 HTML 换行符：

```
{{FirstName}}{{LastName}}<br/>
{{Address1}}{{Address2}}<br/>
{{City}}<br/>
{{State}}<br/>
{{Zip}} 
```

# jquery - json字符串解析错误

> ID：12976847
> 
> 赞同：0
> 
> 时间：2012-10-19T14:52:30.643
> 
> 标签：jquery, json

我有一个 Json 字符串作为-

```
var RetailerData = {};

// The object that the JSON string should represent, can use this as it is if you want.

RetailerData.webSites = [
{
    id: 1,
    text: 'J.Crew',
    image: 'images/retailer-logo/jcrew.png',
    extra: 'www.jcrew.com'
},
{
    id: 2,
    text: 'GAP',
    image: 'images/retailer-logo/gap.png',
    extra: 'www.gap.com'
}]; 
```

我想使用 jquery 解析它 `$.parseJSON` 以获取每个值。我已经尝试过使用

```
var obj = $.parseJSON(RetailerData.webSites);

$.each(obj, function() {
    console.log(this['id']);
}); 
```

但是每次尝试都会出现连续错误。谁能告诉一个正确的方法来做到这一点。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:57:27.033

您用于`parseJSON`将 jsonString 解析为 json 对象。

但在你的情况下`RetailerData.webSites`已经是一个 json 对象，不需要解析它。

```
var obj = RetailerData.webSites;

$.each(obj, function() {
    console.log(this['id']);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:56:23.527

您正在尝试将 JavaScript 对象转换为 JavaScript 对象，这没有任何意义！你能做的是

```
var str = JSON.stringify(RetailerData.webSites); 
```

并用于`str`将您的数据传输到其他地方。然后使用

```
var obj = JSON.parse(str); 
```

在从其他来源修改（或不修改）原始对象后取回原始对象。

# batch-file - 排除批处理复制脚本中的文件夹

> ID：12976848
> 
> 赞同：8
> 
> 时间：2012-10-19T14:52:31.930
> 
> 标签：batch-file, file-copying

我正在使用 U 盘上的批处理文件来备份我的图片。我使用以下命令：

```
for /r C:\ %%x in (*.jpg *.png *.gif) do @copy /y %%x . 
```

我想排除邮件文件夹 WINDOWS 和 PROGRAM FILES 中的文件。

有谁知道我如何使用批处理文件来做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-19T14:55:40.807

存在于 Windows Vista+ 中的Drop `COPY`and use可用于先前版本的下载。[`ROBOCOPY`](http://ss64.com/nt/robocopy.html)

它支持在命令行`/XD`排除特定目录和`/XF`排除文件掩码。

例如

```
robocopy.exe c:\ c:\destination\ *.jpg *.png *.gif /xd "Program files" "windows" /S 
```

（注意这将重新创建 c:\destination\ 中的目录结构，考虑它可能不是你想要的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-19T15:00:45.440

`copy`变成`xcopy`然后你就可以使用它的`/EXCLUDE`开关了

```
@xcopy %%x /y /EXCLUDE:\WINDOWS\ 
```

详情请参阅`xcopy /?`。

# android - 是否可以从 sdCard 上的 jar 库动态加载 Activity 类并实际使用它？

> ID：12976854
> 
> 赞同：14
> 
> 时间：2012-10-19T14:52:40.650
> 
> 标签：android, classloader, dex

我在 sdCard 上有 1 个 .jar 文件（我使用 dx 工具将通常的 .jar 编译为 dex .. 否则 android 会在运行时抱怨）

我想使用的课程实际上是一个活动，“使用”我的意思是充气！

~~A）我注意到，如果我像这样加载类，加载的类将作为包 parrent 的包 parrent 类（我在其中运行代码的包：示例：jar 库中类的真实包：“com .something" & my-app-package: "com.wonderfull" -> 加载的类在 "com.wonderfull.com.something" :) )~~ -> 重新测试：它保留原始包，就像在库中一样

B）在“最佳”情况下，我收到此错误：

> 无法实例化活动 ComponentInfo{com.appno2/com.appno1.futureLib.LibActivity}：java.lang.ClassNotFoundException：com.appno1.futureLib.LibActivity 在加载器 dalvik.system.PathClassLoader[/data/app/com.appno2-1 .apk]

C）在清单中，我已经像这样放置了 Activity （要动态加载的那个）：

活动 android:name="com.appno1.futureLib.LibActivity" android:label="@string/app_name" > /activity>

所以我重复标题中的问题：是否可以从 sdCard 上的 jar 库动态加载 Activity 类并实际使用它？

如果是“你为什么要这个？” - 只是古玩！+ 作为一个概念：在用户输入有效许可证后立即下载应用程序的实际代码（以某种罐子的形式）的可能性

更新： - 这个想法适用于片段（意味着要导入的类是片段）

**目前的结论：** - 可能有：蹩脚的java类甚至android UI相关的外部.jar（例如在sdCard上，或从互联网下载..等）并在需要时动态加载它们。哦，是的：你不能以这种方式工作这些活动:( .. 可能甚至没有服务..

更多信息 #1：[是否可以在运行时从 Android 应用程序动态加载库？](https://stackoverflow.com/questions/6857807/is-it-possible-to-dynamically-load-a-library-at-runtime-from-an-android-applicat)

更多信息#2：[http ://android-developers.blogspot.ro/2011/07/custom-class-loading-in-dalvik.html](http://android-developers.blogspot.ro/2011/07/custom-class-loading-in-dalvik.html)

关于**URLClassLoader**：这有效（不涉及 DalvikClassLoader - ClassNotFoundException && obviosly：仍然不能膨胀像这样加载的活动）

```
File file = new File("/sdcard/myLib.jar");
File tmpDir = getDir("dex", 0);
ClassLoader loader = new URLClassLoader(new URL[]{file.toURI().toURL()}, this.getClass().getClassLoader());
DexClassLoader classloader = new DexClassLoader(file.getAbsolutePath(), tmpDir.getAbsolutePath(), null, loader);
Class<Object> classref = (Class<Object>) classloader.loadClass("packageInLib.ClassName");
Object myInstance = classref.getConstructor().newInstance();

Or instead of "loadClass"
Class<?> classref = Class.forName("packageInLib.ClassName", true, dalvikClassLoader); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-21T09:36:54.770

我有类似的场景。

如果你不把下面的代码放在 AndroidManifest.xml

```
<activity android:name="com.appno1.futureLib.LibActivity" android:label="@string/app_name" > </activity> 
```

你会得到以下错误。

```
10-21 17:04:25.860: E/AndroidRuntime(11050): Caused by: android.content.ActivityNotFoundException: Unable to find explicit activity class {... ...}; have you declared this activity in your AndroidManifest.xml? 
```

但是，如果您在客户端应用程序中注册活动，则会得到 java.lang.ClassNotFoundException。

加载程序尝试在 [/data/app/com.appno2-1.apk] 中搜索 com.appno1.futureLib.LibActivity。显然这不是预期的。我相信 com.appno.futureLib.LibActivity 位于 .jar 文件中。

如果有办法让加载器在.jar文件中搜索LibActivity，问题可能就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T16:51:05.423

您可以扫描 JAR 文件的内容并使用 URLClassloader 加载类。它是标准的 Java（如果你想看一下，我有一个 JavaSE 实现），但它包含在 Android API 中，所以我认为它应该可以正常工作。

[developer.android.com 上的 URLClassloader](http://developer.android.com/reference/java/net/URLClassLoader.html)

基本上你会得到一个 ClassLoader（脏代码警告！）：

```
File file = new File("/sdcard/jars/myDynamicLib.jar");
ClassLoader loader = new URLClassLoader(new URL[]{file.toURI().toURL()}, this.getClass().getClassLoader()); 
```

您需要元数据 XML 或任何描述要加载的内容：

```
jar.getInputStream(jar.getEntry("myMetaData.xml")); 
```

你加载信息（你解析它的方式取决于你使用的格式：你也可以让它已经加载到你的应用程序中）——现在你有了类名。

现在您只需尝试加载：

```
Class<?> classref = Class.forName(className, true, loader);
instance = (MyType) classref.getConstructor().newInstance(); 
```

同样，虽然我没有在 Droid 上尝试过这样的事情，但我认为这应该可以正常工作。

这就弥补了。您需要 JAR 文件的路径以及要加载的类的名称。类加载器将为您将类从 JAR 中拉出。

# php - PHP - call_user_function_array 或反射类通过引用传递？

> ID：12976855
> 
> 赞同：2
> 
> 时间：2012-10-19T14:52:40.730
> 
> 标签：php, oop, model-view-controller, dispatcher, router

我正在尝试在 MVC 框架中发送请求。我有一个将当前 URI 与定义的路由匹配的路由对象。如果匹配，则返回 Route 对象的实例。通过该 Route 对象，我可以访问匹配的控制器、方法和方法参数。

我可以这样使用它：

```
$route->getClass(); name of controller class to instantiate
$route->getMethod(); name of method to call
$route->getArgs(); array holding arguments that should be passed to method 
```

如果需要，我还可以添加新参数。例如，我可以将依赖注入容器和当前 HTTP 请求对象实例添加到 args 中，如下所示：

```
$route->addArg('container', $container);
$route->addArg('request', $request); 
```

现在 $route->getArgs 包含从 URI 获取的所有参数，还有一个 $container 实例和 $request 实例。$container 是我写的依赖注入容器。$request 是代表当前 HTTP 请求的对象。

所以想法是实例化路由器，获取当前路由，然后在每个方法/动作控制器中添加我想使用的对象。然后将该 Route 对象传递给 Dispatcher，当请求被分派时，我将能够在每个方法/动作控制器中使用 $container、$request 和其他参数。

我遇到的问题是，当我使用让我们说博客控制器和发布方法时。默认情况下，并且总是，它应该有 $container 和 $request 的实例（因为我将它们推送到 Route::$args 中，以及在路由定义中定义或从 URI 获取的任何其他参数/​​变量。

因此，当我在我的博客控制器中，发布方法时，我希望它的行为如下：

```
public function post($container, $request)
{
if($request->isAjax) {
// -- Its ajax request
}

$twig = $container->getService("Twig");
} 
```

我发送请求是这样的：

我使用 call_user_function_array 使其工作：

```
$app = new $controller();
call_user_function_array(array($app, $method), $args); 
```

现在这一切都可以正常工作，但我有一个问题。当我使用那个后控制器时，我必须小心后方法参数的顺序。

所以我可以这样做：

```
public function post($id, $url, $container, $request) {
// -- SNIP --
} 
```

但我不能这样使用它：

```
public function post($container, $url, $request, $id) {
/-- SNIP --
} 
```

所以你得到了问题，我不能按照我想要的方式在我的方法中混合参数，我需要注意这些参数在 Route:$args 数组中定义的顺序。

每个方法/动作控制器都应该有 $request 和 $container 实例以及通过 URI 获取或在路由定义中定义的参数。

有没有办法让它工作而不必考虑 post 方法获取参数的顺序是什么？这与通过引用传递有关吗？由于php按值传递变量？

我正在使用 call_user_function_array，我想找到 call_user_function_array 的解决方案。这可能吗？

如果没有，可以使用反射类来完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T21:23:39.283

这是我的问题的解决方案：

所以，我拥有发送请求所需的一切：

```
$class = "\\Application\\Controller\\Blog";
$method = "post";
$args = array('id' => 1, 'url' => 'some-url', 'container' => DICOBJ, 'request' => RQSTOBJ); 
```

现在我需要发送该请求，以便用户可以按任何顺序插入参数，如果他愿意的话。

这是应该做的：

```
$app = new $class();

$rm = new \ReflectionMethod($app, $method);
$params = $rm->getParameters();

$argsOrdered = array();
foreach($params as $param) {
    $argsOrdered[$param->getName()] = $args[$param->getName()];
}

call_user_func_array(array($app, $method), $argsOrdered); 
```

哒哒哒！！！

因此，它的作用是获取用户定义的参数，并按照用户编写它们的顺序将它们作为数组返回。然后我们创建另一个 $argsOrdered 数组，它只包含用户想要的参数，按照他想要的方式排序:)

我使用 ReflectionMethod 来检查方法。最后调用_user_func_array 来调度请求，但你也可以使用反射类来获取控制器实例。

而已。你觉得这个解决方案优雅吗？这可以更快地完成吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:13:08.420

使用反射类，您可以获取要调用的函数的每个参数的参数名称，并以这种方式很容易地检查它们的顺序是否正确。你不能简单地用`call_user_function_array`.

特别是您可以[在`getParameters() method`](http://www.php.net/manual/en/reflectionfunctionabstract.getparameters.php)[ReflectionMethod 类](http://www.php.net/manual/en/class.reflectionmethod.php)中使用。

从那里开始，我认为您知道该怎么做（检查参数数组的每个键和传递的参数键，然后就可以了）。

# sharethis - 我是否正确使用了 sharethis API？

> ID：12976856
> 
> 赞同：1
> 
> 时间：2012-10-19T14:52:43.110
> 
> 标签：sharethis

我在网站上有图标（自定义品牌的 facebook、twitter、pinterest 等），我希望访问者可以轻松地在这些各种社交媒体上谈论博客帖子。

为此，我创建了一个服务器端函数，该函数输出如下所示的链接：

```
<a target="_blank" href=http://rest.sharethis.com/share/sharer.php?destination=facebook&amp;url=http%3A%2F%2Fsite.mydevelopmentserver.com&amp;title=postname&amp;pub_key=123456&amp;access_key=123456"/>FACEBOOK LINK</a> 
```

与其他社交媒体链接的等效链接。

我没有在我的网站上加载任何 sharethis 脚本或以任何其他方式与 sharethis api 交互，而且这种方法似乎工作正常（陪审团仍在分析中）

我的问题是：

一个。以这种方式使用 sharethis 有什么问题吗？

b.有没有更好的方法来做到这一点，不需要我在我的链接中看到我的访问密钥？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-19T23:15:47.693

我认为我的问题的答案是：

一个。是的，以这种方式使用 sharethis 有问题。您的访问密钥将对所有人可见。

湾。是的，有更好的方法来做到这一点。完全不需要直接访问 API 来自定义您的 sharethis 按钮。只需插入您可以在此处生成的普通 sharethis 脚本：http: [//sharethis.com/publishers/get-sharing-tools](http://sharethis.com/publishers/get-sharing-tools)，然后将按钮的类更改为 st_[service]_custom（其中 service 是您想要的服务使用权）。

也就是说，把它放在我的标题中：

```
<script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
<script type="text/javascript">stLight.options({publisher: "1234"});</script> 
```

这在体内：

```
<span class="st_pinterest_custom">Pinterest</span>
<span class="st_twitter_custom">Twitter</span>
<span class="st_facebook_custom">Facebook</span>
<span class="st_googleplus_custom">Google</span>
<span class="st_stumbleupon_custom">Stumble</span> 
```

然后我只使用我自己的 CSS 设置按钮样式。

像魅力一样工作，谢谢分享！

此外，如果有人需要一般帮助，使事情变得比他们需要的更复杂，问我——我可以马上为你做！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-20T00:32:42.160

我认为我的问题的答案是：

一个。是的，以这种方式使用 sharethis 有问题。每个人都可以看到我的访问密钥。

湾。是的，有更好的方法来做到这一点。完全不需要直接访问 API 来自定义您的 sharethis 按钮。只需插入您可以在此处生成的普通 sharethis 脚本：http: [//sharethis.com/publishers/get-sharing-tools](http://sharethis.com/publishers/get-sharing-tools)，然后将按钮的类更改为 st_[service]_custom（其中 service 是您想要的服务使用权）。

也就是说，把它放在我的标题中： stLight.options({publisher: "1234"});

这在体内：Pinterest Twitter Facebook Google Stumble

# c# - 查找字符串中最长的数字序列

> ID：12976860
> 
> 赞同：1
> 
> 时间：2012-10-19T14:52:53.303
> 
> 标签：c#, string

我正在尝试清除质量差的 OCR 读取的结果，尝试删除我可以安全认为是错误的所有内容。

所需的结果是一个 6 位数字字符串，因此我可以从结果中排除任何不是数字的字符。我也知道这些数字是按顺序出现的，所以任何乱序的数字也很可能是不正确的。

（是的，修复质量是最好的，但不是......他们不会/不能更改他们的文件）

我立即`Trim()`删除空格，因为这些最终会成为文件名，所以我也删除了所有非法字符。

我找出了哪些字符是数字，并将它们添加到字典中，对照它们所在的数组位置。这让我对数字序列有一个清晰的视觉指示，但我在如何让我的程序识别这一点的逻辑上苦苦挣扎。

使用字符串“ **Oct', 2$3622** ”（实际读取错误）进行测试，理想的输出是“ **3662** ” ![对人类很明显](../Images/46996b6c198660d39c8ef9f9a821892d.png)

```
 public String FindLongest(string OcrText)
    {
        try
        {
            Char[] text = OcrText.ToCharArray();
            List<char> numbers = new List<char>();

            Dictionary<int, char> consec = new Dictionary<int, char>();

            for (int a = 0; a < text.Length; a++)
            {
                if (Char.IsDigit(text[a]))
                {
                    consec.Add(a, text[a]);

                    // Won't allow duplicates?
                    //consec.Add(text[a].ToString(), true);
                }
            }

            foreach (var item in consec.Keys)
            {
                #region Idea that didn't work
                // Combine values with consecutive keys into new list
                // With most consecutive?
                for (int i = 0; i < consec.Count; i++)
                {
                    // if index key doesn't match loop, value was not consecutive
                    // Ah... falsely assuming it will start at 1\. Won't work.
                    if (item == i)
                        numbers.Add(consec[item]);
                    else
                        numbers.Add(Convert.ToChar("#")); //string split value
                }
                #endregion
            }

            return null;
        }
        catch (Exception ex)
        {
            string message;

            if (ex.InnerException != null)
                message =
                    "Exception: " + ex.Message +
                    "\r\n" +
                    "Inner: " + ex.InnerException.Message;
            else
                message = "Exception: " + ex.Message;
            MessageBox.Show(message);

            return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-19T15:19:11.187

获得最长数字序列的一种快速而肮脏的方法是使用这样的正则表达式：

```
var t = "sfas234sdfsdf55323sdfasdf23";

var longest = Regex.Matches(t, @"\d+").Cast<Match>().OrderByDescending(m => m.Length).First();

Console.WriteLine(longest); 
```

这实际上将获得所有序列，显然您可以使用 LINQ 选择其中最长的序列。

这不处理相同长度的多个序列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:22:40.540

由于您严格想要数字匹配，我建议使用匹配的正则表达式`(\d+)`。

```
MatchCollection matches = Regex.Matches(input, @"(\d+)");
string longest = string.Empty;
foreach (Match match in matches) {
    if (match.Success) {
        if (match.Value.Length > longest.Length) longest = match.Value;
    }
} 
```

这将为您提供最长长度的数字。如果您想实际比较值（这也适用于“最长长度”，但可以解决相同长度匹配的问题）：

```
MatchCollection matches = Regex.Matches(input, @"(\d+)");
int biggest = 0;
foreach (Match match in matches) {
    if (match.Success) {
        int current = 0;
        int.TryParse(match.Value, out current);
        if (current > biggest) biggest = current;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:21:29.760

所以你只需要找到最长的#序列？为什么不使用正则表达式？

```
 Regex reg = new Regex("\d+");
  Matches mc = reg.Matches(input);
  foreach (Match mt in mc)
  {
     // mt.Groups[0].Value.Length is the len of the sequence
     // just find the longest
  } 
```

只是一个想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-19T15:25:39.057

```
var split = Regex.Split(OcrText, @"\D+").ToList();

var longest = (from s in split
               orderby s.Length descending
               select s).FirstOrDefault(); 
```

我建议使用 Regex.Split 使用 \D （代码中的@"\D+" ）来查找所有非数字字符。然后，我将执行 Linq 查询以通过 .Length 查找最长的字符串。

如您所见，它既简单又非常易读。

# css - 使用 CSS 悬停动画触发的动画

> ID：12976866
> 
> 赞同：3
> 
> 时间：2012-10-19T14:53:12.273
> 
> 标签：css, animation, button

我正在尝试触发其他一些按钮（项目）以`object7:hover`从“添加”按钮 ( `object7`) 滚动，但它似乎无论如何都不会触发它。我试图避免使用 JavaScript，只使用 HTML 和 CSS。我得到的代码可以在[这里找到](http://jsfiddle.net/Dann/udENV/)

有什么建议么？

**编辑**：也许我不够清楚，这应该是这样的：

用户悬停“设置”=>所有项目从“设置”后面滑动=>用户悬停“添加”=>

=> 项目从“添加”按钮后面向下滑动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:03:46.467

我相信您的问题是按钮不会响应悬停事件。

如果您改用跨度，它似乎可以工作。这是一个演示的[小提琴](http://jsfiddle.net/udENV/3/ "小提琴")。我没有费心将所有元素正确排列，但是当您将鼠标悬停在“添加”跨度上时，您可以看到“新”跨度移动，我相信这就是您正在努力实现的目标。

```
<div class="container">
<span class="set">
    <span class="object1">Start</span >
    <span class="object2">Stop</span >
    <span class="object3">Play</span >
    <span class="object4">Pause</span >
    <span class="object5">More</span >
    <span class="object6">Info</span >
    <span class="object7">Add
         <span class="object8">New</span >       
    </span >
    <span class="default">Settings</span >
    </span>
</div> 
```

编辑： div 元素也可以工作，可能其他人也可以。似乎按钮元素可能是问题所在？不确定，因为谷歌搜索意味着任何元素对于悬停伪选择器都是有效的，但该按钮在我的 Chrome 版本中肯定不起作用。

# excel - 使用键盘快捷键后取消保护方法失败

> ID：12976867
> 
> 赞同：0
> 
> 时间：2012-10-19T14:53:20.650
> 
> 标签：excel, vba

我有以下一段代码，它调用了几个不同的子：

```
Sub DropDown2_Change()
 'Packtype/Brand-packtype change
  Sheets("planning interface").unprotect
  Application.ScreenUpdating = False
  Call clear_data
  If Sheets("load").range("Q1") = True Then
    packtypeform.Show
  End If
  If Sheets("load").range("Q1") = False Then
    brandpacktypeform.Show
  End If
  Call formatting
  With Sheets("planning interface")
    .Protect
    .EnableSelection = xlUnlockedCells
  End With
  application.screenupdating = true
End Sub 
```

除非我按下`ctrl+shift+pageup`（或向下翻页）在我正在查看的工作表之间切换并使用下拉菜单返回工作表，否则它会很好用。

我得到一个`Run-time error '1004': Unprotect method of worksheet class failed` 已知的原因为什么使用切换工作表`ctrl+shift+pageup`会破坏我拥有的不受保护的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:02:32.517

CTRL+SHIFT+PGUP 用于选择工作表，而不是它们之间的选项卡 - 因此，尽管您实际上是在选择多个工作表，但您使用选项卡。

当您运行代码时，您选择了多张工作表，这会阻止您保护一张。

您可以使用 CTRL+PGUP 在工作表之间切换

# php - 将大文件上传到服务器（非阻塞）

> ID：12976869
> 
> 赞同：4
> 
> 时间：2012-10-19T14:53:24.847
> 
> 标签：php, web-services, soap, upload, 4d-database

所以我正在开发一个需要与 4d 应用程序通信的 php 应用程序。4d 应用程序使用 SOAP Web 服务进行外部通信。

SOAP Web 服务具有启用文件上传到 4d 应用程序的功能。由于 4d 应用程序的 web 服务的文件上传功能的破坏性，我们实现了一个进度条来将文件上传到 web 服务器，然后在成功之后尝试将文件发送到 4d 应用程序服务器。但是对于客户端来说，这并不好，因为人们需要等待初始文件上传到服务器，然后在执行文件上传功能时再次将文件从 Web 服务器传输到 4d 应用程序的服务器。

我的问题是，有没有办法以非阻塞方式处理文件上传？甚至可能一起绕过 SOAP 功能。

更新：我在想也许可以使用 RabbitMQ 之类的东西来对每个文件上传项目进行排队，然后使用脚本或与应用程序分离的东西进行处理，这样它就不会阻塞应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-22T13:54:26.773

您建议的解决方案将是解决它的正确方法；使用 HTML5 文件上传或 swfupload 通过常规 Web 应用程序接受上传，以允许显示上传进度条，然后将其存储在本地并排队等待工作人员处理的 Gearman 或 RabbitMQ 任务。

工作人员将在本地获取文件并将其上传到远程服务（4d / SOAP），然后在完成后在数据库中设置适当的状态，以便用户知道文件何时被处理并添加到实际服务器。

# asp.net - 在代码中设置文档背景图片

> ID：12976874
> 
> 赞同：0
> 
> 时间：2012-10-19T14:53:34.740
> 
> 标签：asp.net, .net, image, background

我可以使用 VS 设计器打开文档属性并更改背景属性。但是我似乎找不到在页面加载时动态更改它的方法。这可以在代码隐藏中完成还是只能在 JavaScript 中完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T14:56:45.563

您可以使用CSS 属性`background`，更具体地说，可以使用`background-image`CSS 属性。

[http://www.w3schools.com/cssref/pr_background-image.asp](http://www.w3schools.com/cssref/pr_background-image.asp)

您可以在服务器上（使用 ASP.NET 代码）或在浏览器中使用 JavaScript 生成相关的 HTML 输出。您的 HTML 将如下所示：

```
...
<body style="background-image:url('...')">
...
</body>
... 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-19T15:00:54.177

你可以在标记上试试这个：

```
<head runat="server">
   <title></title>
    <asp:Literal ID="Literal1" runat="server"></asp:Literal>
</head>

<body class="bodyStyle"> 
```

这在代码隐藏中：

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            String ImgUrl = "/Images/image.png";
            Literal1.Text = "<style>.bodyStyle {background-image: url('" + ImgUrl + "');}</style>";
        }
    } 
```

您可以根据需要以编程方式更改图像 url

# actionscript-3 - 在 Adob e Air 3.4 Actionscript 3 应用程序中处理来自本地 swf 文件的外部接口调用

> ID：12976877
> 
> 赞同：0
> 
> 时间：2012-10-19T14:53:35.597
> 
> 标签：actionscript-3, air, externalinterface

所以我们得到了一个包含各种 swf 文件的播放列表，一些旧的 as2 动画，一些新的。我们将它们下载到本地文件夹，并且可以全屏播放。只需一个 AIR (actionscript) 应用程序即可。现在我们知道在较新的文件中有 ExternalInterface.Call(some arguments) 调用。我们需要在托管 AIR 应用程序中处理它们。到目前为止，我们有一个继承自 MovieClip 的类，具有以下构造函数：

```
public function FlashClip()
    {
        ExternalInterface.addCallback("FlashPlayerControl1FlashCall",FlashPlayerControl1FlashCall);
    } 
```

当我们运行应用程序时，出现以下错误：

> 错误：错误 #2067：此容器中的 ExternalInterface 不可用。ExternalInterface 需要 Internet Explorer ActiveX、Firefox、Mozilla 1.7.5 和更高版本，或其他支持 NPRuntime 的浏览器。在 Error$/throwError() at flash.external::ExternalInterface$/addCallback() at Video::FlashClip()[C:\Users\Daan\Adobe Flash Builder 4.6\TINS-v2-1\TINSV2\src\Video \FlashClip.as:12] 在 Video::FlashPlayer/BestandOpend()[C:\Users\Daan\Adobe Flash Builder 4.6\TINS-v2-1\TINSV2\src\Video\FlashPlayer.as:43]

在以下行：（FlashPlayer.as:43）

```
 var clip:FlashClip = new FlashClip(); 
```

所以，我的问题是这个。是我们正在尝试做的甚至可能的事情。还是我们需要在 actionscript AIR 应用程序中嵌入一个 javascript 容器？或者有谁知道我们将如何让它发挥作用？注意：我们无法更改现有的 swf 文件。我们甚至没有原始的.fla

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:55:26.117

该[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/external/ExternalInterface.html)说您尝试做的事情是不可能的：

> 在 Adob​​e AIR 中，`ExternalInterface`该类可用于在[HTMLLoader](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/html/HTMLLoader.html)控件中加载的 HTML 页面中的 JavaScript 与嵌入在该 HTML 页面中的 SWF 内容中的 ActionScript 之间进行通信。

为了`ExternalInterface`工作，它需要与浏览器提供的 Javascript“层”进行通信。您不会在 AIR 中获得此功能，除非您加载其中嵌入了 SWF 内容的 HTML 页面。

我已经链接到 HTMLLoader 的文档，这将允许您执行此操作。

**[编辑]**

附加一个加载网页的简单 AIR 应用程序（注意它是 Flex 3.6，抱歉这是我的客户使用的），以防万一。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:WindowedApplication xmlns:mx="http://www.adobe.com/2006/mxml"
                        layout="absolute"
                        width="800" height="600"
                        creationComplete="onCreationComplete()">

    <mx:Script>
        <![CDATA[
            import mx.core.UIComponent;

            private function onCreationComplete():void
            {
                var loader:HTMLLoader = new HTMLLoader();
                var request:URLRequest = new URLRequest("http://www.adobe.com");
                loader.width = 800;
                loader.height = 600;
                loader.load(request);
                var uic:UIComponent = new UIComponent();
                uic.addChild(loader);
                addChild(uic);
            }
        ]]>
    </mx:Script>
</mx:WindowedApplication> 
```

# javascript - 在 Windows 上的 Ruby 中运行 javascript

> ID：12976881
> 
> 赞同：0
> 
> 时间：2012-10-19T14:53:46.947
> 
> 标签：javascript, ruby, v8, execjs, therubyracer

有人知道如何在 Windows 机器上的 Ruby 中运行 javascript（jscript 也可以）吗？execjs、V8 和 therubyracer 似乎不适用于 Windows。我知道如何在 Ruby 之外运行 javascript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T16:50:38.643

根据他们的[Github](https://github.com/sstephenson/execjs/)，ExecJS 实际上可用于 Microsoft Windows。它使用 Microsoft Windows 脚本宿主 (JScript)。

# java - 批量查询爬虫操作的模式

> ID：12976888
> 
> 赞同：2
> 
> 时间：2012-10-19T14:53:57.617
> 
> 标签：java, jdbc, batch-file, jta

我正在尝试为批量查询爬虫操作创建一个抽象。这个想法是执行查询，获得结果集，并为每一行执行提交或回滚的操作。要求是所有行的处理与是否有故障无关，并且结果集没有预先加载到内存中。

问题归结为这样一个事实，即在回滚后无法维护打开的结果集。根据规范，游标可保持性在提交时可维护（使用 ResultSet.HOLD_CURSORS_OVER_COMMIT），但在回滚时不可维护。

一个带有 JTA/JDBC 语义的简单实现，提供两个扩展点，一个用于指定查询，一个用于指定每一行的实际操作，如下所示：

```
UserTransaction tx = getUserTransaction();
tx.begin();
ResultSet rs = executeQuery(); //extension point
tx.commit();
while(rs.next()) {
    tx.begin();
    try {
        performOperationOnCurrentRow(ResultSet rs); //extension point
        tx.commit();
        logSuccess();
    }catch(Exception e) {
        tx.rollback();
        logFailure(e);
    }
} 
```

这似乎不是一个牵强的场景，但是我在网上发现的相关信息很少。问题是，任何流行的框架都优雅地解决了这个问题吗？我不一定需要开箱即用的解决方案，我只是想知道是否有一种已知的良好/普遍接受的方法来处理这种情况。

一种解决方案是跟踪失败的行并在该点之后重新打开游标，这通常需要强制执行一些扩展规则（例如，有序结果集、在 where 子句中使用最后失败的行 ID 进行查询等）。

另一种方法是使用两个不同的线程进行查询和行操作。

你会怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-01T12:14:29.043

由于这已经有几年没有回答了，我将继续自己回答。

我们制定的解决方案围绕着流程（称为`BatchProcess`）执行`Query`（不限于 SQL，请注意）并将其结果添加到并发的想法`Queue`。`BatchProcess`生成许多`QueueProcessor`​​对象（在新线程上运行），这些对象使用条目并`Queue`执行`Operation`使用条目作为输入的条目。每次`Operation`执行都作为单个工作单元执行。底层事务管理器是一个 JTA 实现。

有点过时了，但在某些时候实施是这样的[https://bo2.googlecode.com/svn/trunk/Bo2ImplOpen/main/gr/interamerican/bo2/impl/open/runtime/concurrent/BatchProcess.java](https://bo2.googlecode.com/svn/trunk/Bo2ImplOpen/main/gr/interamerican/bo2/impl/open/runtime/concurrent/BatchProcess.java)

该仓库中的某处甚至还有一个用于 BatchProcess 监视和管理的 GUI；）

**免责声明：**这个人与这个设计和实现有很多关系[https://stackoverflow.com/users/2362356/nakosspy](https://stackoverflow.com/users/2362356/nakosspy)

![批处理对象的 UML 图](../Images/22cd52a636ce8975ccc0ab90a84da4d1.png)

# perl - 在 perl 脚本中使用 grep 并将输出通过管道传输到不同的文件

> ID：12976895
> 
> 赞同：-3
> 
> 时间：2012-10-19T14:54:18.403
> 
> 标签：perl, grep

我想打开一个标识符列表并在另一个文件中查找匹配项。为此，我使用 grep 作为每个脚本的系统函数。但我不确定我哪里出错了。你能帮我看看语法吗？感谢您的时间！

```
open F, "$ARGV[0]" or die;
while(<F>)
{
    `grep -A1 "$_" CAM_PROJ_BATS.read.fa > $_.txt`;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:03:13.570

如果您期待输出，您将看不到任何输出，因为您没有打印任何内容。添加打印语句以查看输出。（您可能不需要查看输出，但至少它会帮助您查看 grep 命令的错误）。

此外，输入文件的行末尾将有换行符。您可能不想将其传递给 grep。事实上，添加换行符甚至可能会打乱您在 shell 上的命令执行。用于`chomp`删除换行符。

```
use strict;
use warnings;

open F, "$ARGV[0]" or die "Can't open file: $!";
while(<F>)
{
    chomp;
    print `grep -A1 "$_" CAM_PROJ_BATS.read.fa > $_.txt`;
} 
```

（未测试，因为我没有 grep）。

# powershell - 如何更改 Add-Blob Azure cmdlet 的超时值？

> ID：12976896
> 
> 赞同：0
> 
> 时间：2012-10-19T14:54:18.373
> 
> 标签：powershell, azure, azure-storage, cmdlets

我正在尝试调用`Add-Blob`Azure cmdlet

```
Add-Blob -BlobType Block -FilePath $packagePath -ContainerName $blobContainerName 
```

直到最近它一直工作得很好，但现在它失败了

```
Operation could not be completed within the specified time. 
```

信息。我怀疑无论出于何种原因，上传速度都变得非常低，因此它无法足够快地上传文件。

是否可以增加该操作的超时值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-20T07:41:14.873

[您是否使用来自http://wappowershell.codeplex.com](http://wappowershell.codeplex.com)的 Cmdlet ？请注意，这些 cmdlet 现在（有点）已弃用，并已被 Windows Azure 管理 Cmdlet ( [http://msdn.microsoft.com/en-us/library/windowsazure/jj554330.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/jj554330.aspx) ) 取代。不幸的是，新的 cmdlet 中没有用于添加 blob 的 cmdlet。

回到您的问题，我认为无法使用此 Cmdlet 指定请求超时，并且 CodePlex 网站上没有可供您修改的源代码。您可以做的是直接通过 PowerShell 调用存储客户端库。我冒昧地修改了这篇博客文章中的代码（[http://www.fsmpi.uni-bayreuth.de/~dun3/archives/uploading-a-file-to-azure-blob-storage-from-powershell/ 528.html](http://www.fsmpi.uni-bayreuth.de/~dun3/archives/uploading-a-file-to-azure-blob-storage-from-powershell/528.html) ) 并包含对 Timeout 参数的支持：

```
 Add-Type -Path "C:\Program Files\Microsoft SDKs\Windows Azure\.NET SDK\2012-06\ref\Microsoft.WindowsAzure.StorageClient.dll"

    $accountName = "<your account name>";

    $accountKey = "<your account key>";

    $blobContainerName = "<your blob container name>";

    $fullFilePath = "<Full path of the file you wish to upload>";

    $requestTimeoutInSeconds = 600;

    $cloudStorageAccountNameAndKey = new-object Microsoft.WindowsAzure.StorageCredentialsAccountAndKey($accountName, $accountKey);

    $cloudStorageAccount = new-object Microsoft.WindowsAzure.CloudStorageAccount($cloudStorageAccountNameAndKey, $true);

    $cloudBlobClient = [Microsoft.WindowsAzure.StorageClient.CloudStorageAccountStorageClientExtensions]::CreateCloudBlobClient($cloudStorageAccount)

    $blobContainer = $cloudBlobClient.GetContainerReference($blobContainerName);

$blobContainer.CreateIfNotExist();

    $blockBlob = $blobContainer.GetBlockBlobReference("<blob name>");

    $blobRequestOptions = new-object Microsoft.WindowsAzure.StorageClient.BlobRequestOptions;

    $blobRequestOptions.Timeout = [TimeSpan]::FromSeconds($requestTimeoutInSeconds);

    $blockBlob.UploadFile($fullFilePath, $blobRequestOptions); 
```

如果您正在寻找 Microsoft 的 PowerShell Cmdlet 的替代品，我建议您看看[Cerebrata Azure Management Cmdlets](http://www.cerebrata.com/Products/AzureManagementCmdlets) [我是该产品的开发人员之一]。它具有用于完整存储管理和服务管理的 cmdlet。

希望这可以帮助。

# php - 如何在循环中访问特定方法？

> ID：12976900
> 
> 赞同：1
> 
> 时间：2012-10-19T14:54:23.273
> 
> 标签：php, model-view-controller, symfony, tree, twig

假设我有一个 Category 实体，一个 Person 实体，这两个实体通过 Contract Entity 相关联。
在我看来，我需要显示一个类别及其所有子类别以及人数

例如：当用户在页面上查看“A 类”时，我希望他/她看到：

```
Category A                  10 persons
  subcategory a.1            4 persons
  subcategory a.2            6 persons 
```

所以在我的 show.html.twig 中，我会写：

```
{{ category.title }}  {{ nb_persons }}
{% for child in children %}
   {{ child.title }} //{{ child.getNbPersons() }}??, how to get the number of persons for each child ?
{% endfor %} 
```

这是我的 CategoryController.php

```
public function showAction($id_category)
{
    $em=$this->getDoctrine()->getEntityManager();
    $repo = $em->getRepository('MyBundle:Category');
    $this->param['category']= $repo->find($id);
    $this->param['nb_persons'] = $repo->getNbPersonsByCategory($id_category);
    $this->param['children'] = $repo->children($this->param['category'], true, 'title');

return $this->render('MyBundle:Category:show.html.twig', $this->param);
} 
```

但是要显示每个子类别（孩子）的人数，我需要使用 child.getNbPersons() 之类的方法，但这会迫使我在实体 Category.php 中使用存储库函数，我认为这是一个不好的做法. 我能做些什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T17:47:05.580

我倾向于将模型与其他一切完全隔离。也就是说，模型不知道控制器、存储库等。

关于您的问题，我宁愿`array`在控制器中构造一个适当的对象（以及一个）并将其传递给`Twig`它，它`array`应该包含预先计算所需的所有信息。这样，如果您有很多类别（和/或子类别），您只需执行一次数据库查询，而不是从模型方法调用存储库，每次调用都需要一个查询。

希望这可以帮助... ;）

# xslt - 在 xslt 中循环 xml 节点时，标题不应重复

> ID：12976903
> 
> 赞同：1
> 
> 时间：2012-10-19T14:54:49.783
> 
> 标签：xslt

我有以下xml数据：

```
<data>
<item column="left" value="1" />
<item column="left" value="2" />
<item column="right" value="3" />
<item column="left" value="4" />
<item column="right" value="5" />
<item column="right" value="6" />
<item column="right" value="7" />
<item column="left" value="8" />
<item column="right" value="9" />
<item column="right" value="10" />
</data> 
```

我想`DATA`在列正确时打印一个标题，我只需要一次。谁能帮我吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:08:37.780

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*" name="identity">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*[item[@column='right']]">
  <Heading>Data</Heading>
  <xsl:call-template name="identity"/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<data>
    <item column="left" value="1" />
    <item column="left" value="2" />
    <item column="right" value="3" />
    <item column="left" value="4" />
    <item column="right" value="5" />
    <item column="right" value="6" />
    <item column="right" value="7" />
    <item column="left" value="8" />
    <item column="right" value="9" />
    <item column="right" value="10" />
</data> 
```

**产生**（我*猜*是想要的结果，因为没有指定想要的结果！！！）：

```
<Heading>Data</Heading>
<data>
   <item column="left" value="1"/>
   <item column="left" value="2"/>
   <item column="right" value="3"/>
   <item column="left" value="4"/>
   <item column="right" value="5"/>
   <item column="right" value="6"/>
   <item column="right" value="7"/>
   <item column="left" value="8"/>
   <item column="right" value="9"/>
   <item column="right" value="10"/>
</data> 
```

**如果您想失去使用恒等规则的灵活性，则可以将上述转换简化为：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

 <xsl:template match="/*" name="top">
  <xsl:copy-of select="."/>
 </xsl:template>
 <xsl:template match="/*[item[@column='right']]">
  <Heading>Data</Heading>
  <xsl:call-template name="top"/>
 </xsl:template>
</xsl:stylesheet> 
```

# android - 如何在Android中播放一系列短小的mp3文件，它们之间没有间隙？

> ID：12976905
> 
> 赞同：3
> 
> 时间：2012-10-19T14:54:57.623
> 
> 标签：android, android-mediaplayer

我有很多简短的 .mp3 文件，我想一个接一个地播放。我尝试使用 onCompletion 事件并开始下一个 mp3，尽管这会导致 2 个 mp3 之间出现短暂的间隙。

这是代码：

```
void StartSound() {
    mediaplayer = MediaPlayer.create(this, Uri.parse(FILE_PATH + counter + ".mp3"));

    try {
        mediaplayer.start();
        mediaplayer.setOnCompletionListener(new OnCompletionListener() {
            @Override
            public void onCompletion(MediaPlayer mp) {

                                     counter++;
                 try {
                  mp.reset();
                  mp.setDataSource(FILE_PATH + counter + ".mp3");
                  mp.prepare();

                 } catch (Exception e) {
                 e.printStackTrace();
                 }
                 mp.start();
            }
        });

    } catch (Exception e) {

    }
} 
```

有解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:01:47.827

有一种解决方法，但是否值得麻烦取决于您。

基本思想是将 MP3 文件解码为 PCM 缓冲区，将它们拼接成一个字节数组，然后使用`AudioTrack`. 无缝 MP3 播放并不真正存在于`MediaPlayer`. 不过，这可能会让人头疼，而且如果您正在谈论完整的歌曲，则可能会出现记忆问题。对于短片，它可能有效，但`SoundPool`可能是更好的选择。

如果你只是想把差距缩小一点，你可以尝试在`MediaPlayer`之前准备以下对象`onCompletionListener`。与其等待完成，不如准备接下来的两个，这样您就可以更快地开始播放。然后当你点击时`onCompletion`，你可以翻转你正在使用的对象和`start()`。在某种程度上，粗略的双重缓冲。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T07:13:16.230

尝试这个：

```
public class MainActivity extends Activity 
{
    private int[] tracks = {R.raw.explosion,R.raw.pianothingy_one,R.raw.car_horn_x};
    int mCompleted = 0;

 public void onCreate(Bundle savedInstanceState) 
 {
 super.onCreate(savedInstanceState);
 setContentView(R.layout.activity_main);

 MediaPlayer mp = MediaPlayer.create(this, tracks[0]);
 mp.setOnCompletionListener(new OnCompletionListener() 
 {
     @Override
     public void onCompletion(MediaPlayer mp)
     {
         mCompleted++;
         mp.reset();
         if (mCompleted < tracks.length) 
         {
             try
             {
                 AssetFileDescriptor afd = getResources().openRawResourceFd(tracks[mCompleted]);
                 if (afd != null) 
                 {
                     mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
                     afd.close();
                     mp.prepare();
                     mp.start();
                 }
             }
             catch (Exception ex) 
             {
                ex.printStackTrace();
             }

         } 
         else if (mCompleted>=tracks.length) 
         {
             mCompleted =0;
             try
             {
                 AssetFileDescriptor afd = getResources().openRawResourceFd(tracks[mCompleted]);
                 if (afd != null) 
                 {
                     mp.setDataSource(afd.getFileDescriptor(), afd.getStartOffset(), afd.getLength());
                     afd.close();
                     mp.prepare();
                     mp.start();
                 }
             }
             catch (Exception ex) 
             {
                ex.printStackTrace();
             }
         }
         else
         {
             mCompleted=0;
              mp.release();
              mp = null;
         }

     }
 });

 mp.start(); 
```

# multithreading - QThread 使程序崩溃？

> ID：12976907
> 
> 赞同：0
> 
> 时间：2012-10-19T14:55:09.793
> 
> 标签：multithreading, qt, crash, mutex, qthread

我像这样实现 QThread，但是当它运行时程序崩溃了。
我搜索并看到帖子说**这不是使用 QThread 的正确方法。**
但是我找不到程序崩溃的任何原因，我所做的只是触发'on_Create_triggered()'，并且我保证互斥锁被正确锁定和解锁。
我已经对该程序进行了两天的测试（仅通过 'std::cerr << ...;' 打印结果进行测试），但仍然找不到原因。`What I guess is that the thread may wait for the lock too long and cause program to crash.` *（听起来不合理......）* :)

**我的代码：**

背景.h

```
class Background : public QThread
{
    Q_OBJECT

public:
    Background(int& val,DEVMAP& map, QQueue<LogInfoItem*>& queue, QList<DEV*>& devlist, QList<IconLabel*>& icllist,QMutex& m)
        :val_i(val),DevMap(map), LogInfoQueue(queue), DevInfoList(devlist), IconLabelList(icllist),mutex(m)
    {}

     ~Background();

protected:
    void run(void);

private:
    DEVMAP& DevMap;
    QQueue<LogInfoItem*>&LogInfoQueue;
    QList<DEV*>& DevInfoList;
    QList<IconLabel*>& IconLabelList;
    int& val_i;
    QMutex& mutex;

    void rcv();

}; 
```

背景.cpp

```
#include "background.h"

Background::~Background()
{
    LogFile->close();
}

void Background::run(void)
{
    initFile();

    while(1)
    {
        msleep(5);
        rcv();
    }

}

void Background::rcv()
{
    mutex.lock();
    ...
    ...//access DevMap, LogInfoQueue, DevInfoList, IconLabelList and val_i;
    ...
    mutex.unlock();
} 
```

MainWindow:(MainWindow 有 Background* 作为属性)

```
void MainWindow::initThread()
{
    back = new Background(val_i, dev_map, logDisplayQueue, devInfoList, iconLabelList, mutex);
    back->start();
}

void MainWindow::on_Create_triggered()
{
    mutex.lock();
    ...
    ...//access DevMap, LogInfoQueue, DevInfoList, IconLabelList and val_i;
    ...
    mutex.unlock();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-20T02:40:18.563

我找到了原因，这更微妙。
（我使用其他人编写的一些代码，但相信它没有损坏，我完全错了！:)）
损坏的代码：

```
#define   DATABUFLEN    96

typedef struct Para//totally  100bytes
{
    UINT8 type;
    UINT8 len;
    UINT8 inType;
    UINT8 inLen;
    UINT8 value[DATABUFLEN];//96 bytes here
}ERRORTLV;

class BitState
{

public:
    UINT8                           dataBuf[DATABUFLEN];
    ......

}; 
```

以及使用它的功能：

```
bool    BitState::rcvData()               //the function crosses bound of array
{

    UINT8 data[12] = 
        {
            0x72, 0x0A, 0x97, 0x08,
            0x06, 0x0A, 0x0C, 0x0F,
            0x1E, 0x2A, 0x50, 0x5F,
        };                                //only 12 bytes

    UINT32 dataLen = 110;

    memcpy(this->dataBuf, data, dataLen); //copy 110 bytes to dataBuf //but no error or warning from compiler, and no runtime error indicates the cross
}

bool    BitState::parseData(BitLog* bitLog)//pass pointer of dataBuf to para_tmp, but only use  0x08 + 4 = 12 bytes of dataBuf
{

    Para* para_tmp;
    if(*(this->dataBuf) == 0x77)
    {
        para_tmp = (ERRORTLV*)this->dataBuf;
    }

    if(para_tmp->type != 0x72 || para_tmp->inType != 0x97 || (para_tmp->len - para_tmp->inLen) != 2)                                                        // inLen == 0x08
    {
        return false;
    }
    else
    {
        //parse dataBuf according to Para's structure

        this->bitState.reset();

        for(int i = 0; i < para_tmp->inLen; i++)          // inLen == 0x08 only !!!
        {
            this->bitState[para_tmp->value[i]-6] = 1;
        }

        if(this->bitState.none())
            this->setState(NORMAL);
        else
            this->setState(FAULT);

         QString currentTime = (QDateTime::currentDateTime()).toString("yyyy.MM.dd hh:mm:ss.zzz");

         string sysTime = string((const char *)currentTime.toLocal8Bit());

         this->setCurTime(sysTime);

        this->addLog(sysTime, bitLog);

    }

    return true;
}

bool    BitState::addLog(std::string sysTime, BitLog* bitLog)// this function is right
{

        bitLog->basicInfo = this->basicInfo;//not in data Buf, already allocated and initialized, (right)
        bitLog->bitState = this->bitState;  //state is set by setState(..)

        bitLog->rcvTime = sysTime;          //time 

        return true;
} 
```

**一般来说，程序分配 96 个字节给一个字节数组，但是使用 'memcpy(...)' 将 110 个字节复制到数组中，以后只使用数组的 12 个字节。**
各种崩溃出现，令人困惑和沮丧...... :( :( :(

# ruby-on-rails - 为什么 database_cleaner 会破坏我的测试（minitest / capybara / factory girl）？

> ID：12976908
> 
> 赞同：2
> 
> 时间：2012-10-19T14:55:10.807
> 
> 标签：ruby-on-rails, testing, capybara, factory-bot, minitest

我正在尝试`database_cleaner`使用我的测试套件，但在网上找不到有关此错误的任何信息：

`ERROR Couldn't find User with id=1`

测试运行良好，直到我添加`database_cleaner`. 这就是我在`test_helper.rb`文件中使用它的方式：

```
# Database cleaner.
DatabaseCleaner.strategy = :truncation
class MiniTest::Spec
  before :each do
    DatabaseCleaner.clean
  end
end 
```

如果我的策略是 . 它也不起作用`:transaction`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-04T20:56:43.733

根据[文档](https://github.com/DatabaseCleaner/database_cleaner#minitest-example)，调用`DatabaseCleaner.clean`应该在后钩子和`DatabaseCleaner.start`前钩子中（截断策略可能不需要开始调用。

这里很可能发生的是，数据库清理器正在清除您在实际测试运行之前在其他钩子中设置的任何数据。这将取决于 before 钩子运行的顺序。

# ruby - 过期后无法刷新令牌

> ID：12976912
> 
> 赞同：5
> 
> 时间：2012-10-19T14:55:15.097
> 
> 标签：ruby, oauth, soundcloud

我可以很好地验证和获取 access_token 和相应的 refresh_token（后续 API 交互也很好）。

但是，我似乎只能在实际过期*之前*`POST`刷新令牌（ to `/oauth/token`with `grant_type=refresh_token`） 。到期后，相同的刷新代码（与文档中提供的完全相同）返回错误.*`access_token``invalid_grant`*

 *我正在使用 soundcloud-ruby SDK，FWIW，但我可以通过 curl 重现它。

顺便说一句，我发现一些来自 Google Group 的旧消息提到我可以请求一个不会过期的令牌，但我在文档中的任何地方都没有看到这一点。这仍然是一个可行的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T15:50:17.477

那是对的。访问令牌过期后无法使用刷新令牌。

`scope=non-expiring`您可以通过在构造授权 URL 时指定来请求未过期的访问令牌。要使用 Ruby SDK 执行此操作，只需将附加参数传递给`authorize_url`方法：

```
require 'soundcloud'

client = Soundcloud.new(
  :client_id => 'YOUR_CLIENT_ID',
  :client_secret => 'YOUR_CLIENT_SECRET',
  :redirect_uri => 'REDIRECT_URI'
)

client.authorize_url(:scope => 'non-expiring') 
```

流程的其余部分应该完全相同（从查询字符串中获取 'code' 参数并向 发出`POST`请求`/oauth2/token`）。*

# javascript - 单选按钮值的标识符

> ID：12976913
> 
> 赞同：1
> 
> 时间：2012-10-19T14:55:15.873
> 
> 标签：javascript, jquery

我有

```
<form name="send">
<input type="radio" name="schoose" value="24">
<input type="radio" name="schoose" value="25">
<input type="radio" name="schoose" value="26"> 
```

我试图找到我认为是的选定单选按钮的值

```
document.send.schoose.value 
```

显然我错了，有人能告诉我吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:59:32.647

另外的选择...

```
$('input[name=schoose]:checked').val() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:00:51.650

试试`$("input[name='schoose']:checked").val();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T14:59:10.370

尝试这个

```
document.getElementsByName('schoose')[1].value; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-19T14:59:28.633

```
document.getElementsByName('schoose')[1] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-19T14:58:34.037

在纯 JavaScript 中，您可以通过以下方式获取第二个单选按钮的值：

```
document.getElementsByName('schoose')[1].value; 
```

在 jQuery 中：

```
$('input[name="schoose"]:eq(1)').val(); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/NZAJh/)**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-13T05:08:41.300

仅使用 javascript：

```
 var radio=document.getElementsByName('schoose');

    var radioValue="";
    var length=radio.length;

    for(var i=0;i<length;i++)
    {
       if(radio[i].checked==true) radioValue=radio[i].value;
    }
    alert(radioValue); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-19T14:56:47.593

你可以这样做

用 javascript

```
 document.getElementsByName('schoose')[1].value; 
```

和像下面这样的jquery

```
$("[name=schoose]").each(function (i) {
    $(this).click(function () {
        var selection = $(this).val();
        if (selection == 'default') {
            // Do something
        }
        else {
            // Do something else
        }             
    });
}); 
```

或者

```
$("input:radio[name=schoose]").click(function() {
    var value = $(this).val();
  //or
  var val = $('input:radio[name=schoose]:checked').val();
}); 
```

# alloy - 集合并集的累积

> ID：12976917
> 
> 赞同：1
> 
> 时间：2012-10-19T14:55:27.457
> 
> 标签：alloy

我有两个类`A`，`B`并且与它们的额外类数据有关系`R`。

因此，`A`和`B`通过 相互关联`R`。

```
sig A {}
sig B {}

sig R {
    a : A,
    b : B,
    data : Bool
} 
```

这里，Bool 定义为：

```
sig Bool {}
sig True, False extends Bool {} 
```

现在，我这样扩展`A`：

```
sig A{
    allb : some B
} 
```

其中包含 this和 that`B`之间存在关系以及数据类型为 的所有实例。`A``B``True`

我想将以下逻辑陈述表达为合金事实：

[![上述文本的正式版本](../Images/fa37ce06ee101566c0796edad60a0201.png)](https://i.stack.imgur.com/MC2WI.png)
[（来源：[dropproxy.com](http://dropproxy.com/f/3B)）]

我在这里假设`True == 1`and`False != 1`集合`A`和分别`R`包含 and 的所有`A`实例`R`。

到目前为止，我尝试的是定义 a `fun trueR(a : A)`which 应该返回所有`R`'s for which`R.a = a and r.data = True`和 a `fact allbIsRTrue`which 声明 for each`A` `allb`应该是`R.b`'s 返回的总和 by `trueR`。

但是，这就是我卡住的地方，我找不到正确的构造来对引用中的集合求和，并尝试`sum`导致语法错误。

我如何将我的正式约束指定为合金事实？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T16:33:22.880

我认为您想使用集合理解。在 Alloy 中，这是集合理解的语法

```
{x: X | f(x)} 
```

上面的表达式计算为一组`X`'s`f(x)`成立。

在您的示例中，为了表达`allB`您可以编写类似的事实

```
fact fAllB {
    all a: A | 
        a.allB = {b: B | 
            some r: R | r.ra = a and r.rb = b and r.data = True}
} 
```

在英语中，这个事实读作“对于所有`a`的集合`A`，`a.allB`是一个所有集合的集合`B`，因此存在一些`r`“连接”那些精确的`a`和`b`和`r.data`的`True`。

请注意我对模型的其余部分所做的以下修改：

*   我做了`Bool`sig 抽象因为你可能不想要既不是`True`也不是的布尔值`False`

*   我制作了`True`and `False`sigs 单例 sigs（即`one sig`），因为您可能希望它们中的每一个都只有一个原子

*   我重命名了关系`a`和`b`to`ra`和`rb`以避免名称别名和潜在的混淆

这是我用于此示例的模型的其余部分

```
abstract sig Bool {}
one sig True, False extends Bool {}

sig A {
  allB: set B
} 
sig B {}
sig R {
  ra : A,
  rb : B,
  data : Bool
} 
```

# msbuild - 将多个解决方案/项目转换为单个 msdeploy 包的建议？

> ID：12976923
> 
> 赞同：4
> 
> 时间：2012-10-19T14:55:42.600
> 
> 标签：msbuild, continuous-integration, teamcity, msdeploy, webdeploy

我们的主网站是 10 个独立的 ASP.NET 项目和应用程序的集合。目前，在新服务器上进行完整部署需要运行十个单独的 msdeploy 作业；每个应用程序都被构建、配置（使用配置转换）和打包，但我们没有任何解决方案可以将所有包部署为单个操作。

我可以看到几种可能*在*这种情况下起作用的可能性，但我很想听听任何成功或失败的人在设置类似的东西方面的​​意见：

1.  一个包含包和 deploy.cmd 脚本的文件夹，其中包含一个“主脚本”，它将依次调用每个单独的应用程序脚本并将该应用程序部署到目标服务器。

2.  使用暂存服务器，我们使用生产配置从 TeamCity 部署每个包的最新版本，然后使用 msdeploy 将该服务器捕获到一个巨大的 msdeploy ZIP 包中，然后将其作为单个 msdeploy 步骤部署到每个生产服务器上。

3.  创建一个单一的、巨大的 Visual Studio 解决方案，它引用我们代码库中的每个项目（可能通过 svn:externals？），编译和交叉引用它们，因此支持使用单个 msbuild 作业来创建包含我们整个代码库的巨大单体包，从源代码管理中的最新版本构建并针对目标环境进行配置。

我研究了[Troy Hunt 的优秀“你部署错了”系列](http://www.troyhunt.com/2010/11/you-deploying-it-wrong-teamcity.html)，以及[Scott Hanselman 的“Web 部署变得很棒”](http://www.hanselman.com/blog/WebDeploymentMadeAwesomeIfYoureUsingXCopyYoureDoingItWrong.aspx)文章，但我认为我正在寻找一种超越这两种方法的方法，它包含多个项目和应用程序不必一步从源代码构建它们 - 有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-19T15:32:43.410

我们公司有一个非常相似的场景，我们使用[WIX](http://wixtoolset.org/)创建了一个安装包。我们的配置转换发生在安装时，所以现在我们创建一个构建，然后通过 MSI 安装包将其部署到每个服务器。WIX 非常灵活，但学习曲线也很陡峭。我们使用自己的自定义操作修改配置，但也可以通过其他方式完成。

我们使用 Team Foundation Server 和[MSBuild](http://msdn.microsoft.com/en-us/library/vstudio/dd393574.aspx)进行构建。这很简单，但确实需要一些工作才能正确设置尽可能多的项目和解决方案。

我们研究甚至尝试过的其他选项是：

*   InstallShield - 不够灵活。
*   编写我们自己的 C# 安装 - WIX 已经想到了我们想要完成的所有事情，那么为什么要重新发明轮子呢？
*   只是说要搞定这一切并手动安装 - 在 WIX 和 MSBuild 中花费 2 或 3 个月的开发时间很容易支付我们去年手动完成工作所花费的时间。

我认为 Visual Studio 中内置的部署工具是为只有几个部署的单个应用程序而设计的。听起来您需要外部工具和开发工作来更快地进行部署，并消除手动操作的需要。这就是我们投资上述解决方案的原因，它确实得到了回报。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-13T20:09:44.220

我会选择Installshield。

*   Installshield 最新版本支持创建 webdeploy 包。
*   如果您想为所有 Web 应用程序单独或一个版本创建包，您可以为单个项目中的所有应用程序定义 IIS 配置并创建版本。
*   Installshield 项目有一个对象模型，您可以在其中基本上自动化构建脚本中的每项任务，这些项目也是简单的 xml 文件，如果需要，您还可以在自动化脚本中进行修改
*   开发人员可以单独修改更新 WixXML 项目，您可以通过构建脚本将这些项目构建作为合并模块添加到您的 installshield 项目中，并对 installshield 项目 xml 进行一些小调整（至少在 2011 版本中，这部分不受 installshield 支持，但是可以做到）
*   您甚至不需要为遵循相同模式的 Web 应用程序组修改 Visual Studio 项目，也不需要手动修改 installshield 项目来为这些情况添加新的 Web 应用程序，您可以为新的 Web 应用程序创建包而无需干预设置一次基于根 VS 构建输出的 installshield 项目自动化任务的构建脚本

# html - 是否可以让 UIWebView 加载一个 html 字符串但像 UILabel 一样

> ID：12976924
> 
> 赞同：0
> 
> 时间：2012-10-19T14:55:46.847
> 
> 标签：html, ios, uiwebview, uilabel, ttstyledtextlabel

`TTStyledTextLabel`正是我想要的，但我不想只为这一个功能添加所有 Three20 项目。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:12:40.480

如果您可以将应用程序限制为 iOS 6+，则所有标准渲染控件都可以使用属性字符串支持，否则，还有许多其他可用的 3rd 方解决方案（包括我最喜欢的[OHAttributedLabel](https://github.com/AliSoftware/OHAttributedLabel)）。只是不要将 WebView 用于这么简单的事情，它们真的很重。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T14:59:51.260

是的，您可以使用[– stringByEvaluatingJavaScriptFromString：](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html#//apple_ref/occ/instm/UIWebView/stringByEvaluatingJavaScriptFromString%3a)

假设您将此字符串加载到 webView：

```
<div id="msg">
    Super inner html with <b>bold</b>
</div> 
```

然后你可能会得到`msg`这样的内部 html：

```
NSString* value = [webView stringByEvaluatingJavaScriptFromString:@"document.getElementById('msg').innerHTML"]; 
```

set`msg`的内部 html 是这样的：

```
[webView stringByEvaluatingJavaScriptFromString:
    [NSString stringWithFormat:@"document.getElementById('msg').innerHTML = '%@'", newValue]]; 
```

# dijkstra - Dijkstra 算法与统一成本搜索（时间复杂性）

> ID：12976926
> 
> 赞同：6
> 
> 时间：2012-10-19T14:56:03.897
> 
> 标签：dijkstra, ucs

我的问题如下：根据不同的消息来源，Dijkstra 的算法只不过是统一成本搜索的一种变体。我们知道 Dijkstra 的算法会找到源和所有目的地（单源）之间的最短路径。但是，我们总是可以修改 Dijkstra 以找到 START 和 GOAL 状态之间的最短路径（当目标从优先级队列中弹出时，我们只需停止）；但是这样做，最坏的情况仍然是找到从 START 到所有其他节点的最短路径（假设目标是图中最远的节点）。

如果我们使用最小优先级堆实现 Dijkstra 算法，运行时间将为 O(V log V +E) ，其中 E 是边数，V 是顶点数。

既然 Uniform Cost Search 和 Dijkstra 一样（实现方式略有不同），那么 UCS 的运行时间应该和 Dijkstra 差不多吧？然而，根据我的 AI 课程，统一成本搜索在最坏的情况下是指数级的，它需要 O(b ^(1 + [C*/ε]) )，其中 C* 是最优解决方案的成本。( b 是分支因子)

两种算法如何在运行时间不同的情况下相同？运行时间是一样的，但我们看待它的方式不同吗？

我会很感激你的帮助:):) 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:04:09.460

> 运行时间是一样的，但我们看待它的方式不同吗？

是的。统一成本搜索可用于无限大的图，Dijkstra 的原始算法永远不会终止。*在这种情况下，用V*和*E*来定义复杂性是没有用的，因为两者都可能是无限的，并且由此产生的大 O 数字毫无意义。

# python - 获取python列表的所有元素，包括子列表

> ID：12976927
> 
> 赞同：2
> 
> 时间：2012-10-19T14:56:14.430
> 
> 标签：python, list

> **可能重复：**
> [在 Python 中展平（不规则）列表列表](https://stackoverflow.com/questions/2158395/flatten-an-irregular-list-of-lists-in-python)

我有一个 python 列表，其元素可以是字母或字母列表。我想编写一个函数来提取所有元素，如下所示

认为

```
l=['a',['b',['c']] ]

The output need to be ['a','b','c'] 
```

我认为递归将是做到这一点的正确方法。基本情况可能是列表仅包含一个元素。我试图对此进行编码..但输出是

```
['a', 'b', ['c']] 
```

有人可以告诉我这里出了什么问题吗？

```
def get_all_elements(mylist):
    if len(mylist)==1:
        return mylist[0]
    else:
        output=[mylist[0]]
        output+=get_all_elements(mylist[1:])
        return output 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:03:47.360

这似乎工作正常：

```
def flatten(iterable):
   out = []
   for i in iterable:
      if hasattr(i,'__iter__'):
         out.extend(flatten(i))
      else:
         out.append(i)
   return out

l=['a',['b',['c']] ]   
print flatten(l) 
```

您出错的地方在于，在您的解决方案中，`mylist[0]`它本身可以是一个列表（长度为 1），其中包含另一个列表（任意长度）。在这种情况下，您只是退回了它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-19T15:01:29.370

当您检查`mylist`长度是否为 1 时，您不会检查其内容是列表的情况。这是一个突出您的问题的示例。

```
get_all_elements([1, [2, [3, 4]]]) 
```

如果您想要一个完整的解决方案，[Flattening a shallow list in Python](https://stackoverflow.com/questions/406121/flattening-a-shallow-list-in-python) and [Comprehension for flattening a sequence?](https://stackoverflow.com/questions/457215/comprehension-for-flattening-a-sequence-of-sequences) 是看的好地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T15:03:02.913

这将适用于多达 3 个级别的深度，如果深度是任意的，我认为您将无法使用列表理解。

```
[grandchild for parent in l for child in parent for grandchild in child] 
```

# ios - 如何将 CIFilter 应用到 CALayer

> ID：12976929
> 
> 赞同：2
> 
> 时间：2012-10-19T14:56:18.623
> 
> 标签：ios, core-image

我试图了解如何使用过滤器数组属性在 CALayer 上应用 CIFilter。根据文档，这应该可以从 iOS5 获得。

到目前为止，这是我的代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    CIFilter *gradientFilter = [CIFilter filterWithName:@"CILinearGradient"];
    [gradientFilter setValue:[CIColor colorWithRed:0 green:0 blue:0] forKey:@"inputColor0"];
    [gradientFilter setValue:[CIVector vectorWithX:0 Y:0] forKey:@"inputPoint0"];
    [gradientFilter setValue:[CIColor colorWithRed:1 green:1 blue:1] forKey:@"inputColor1"];
    [gradientFilter setValue:[CIVector vectorWithX:0 Y:200] forKey:@"inputPoint1"];

    self.view.layer.filters = @[gradientFilter];
    [self.view setNeedsDisplay];
} 
```

self.view 只是一个空的 UIView，背景颜色设置为绿色。

我知道我可以通过其他方式创建渐变，但如果可行，我将应用更多过滤器，因此这仅用于测试系统。

我发现的所有示例都是在 UIImage 上应用过滤器，但我无法让它们为我工作......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-01-14T14:40:14.153

您需要将图层渲染为图像，然后将图像设置为过滤器，然后在图层中`inputImage`绘制。`outputImage`

# android - 带有 Google Cloud Messaging 的 Android - 当我尝试获取其 ID 时，设备由于某种原因未注册

> ID：12976930
> 
> 赞同：0
> 
> 时间：2012-10-19T14:56:20.370
> 
> 标签：android

我有这个标准代码在用户第一次运行应用程序时运行：

```
 GCMRegistrar.checkDevice(this);
    GCMRegistrar.checkManifest(this);

    final String regId = GCMRegistrar.getRegistrationId(this);
    if (regId.equals("")) 
    {
        GCMRegistrar.register(this, SENDER_ID);
    } 
    else 
    {
        Log.v(TAG, "Already registered");
    } 
```

并且 regId 始终为空，据我了解，这意味着设备未注册。

但是如何确保设备已注册？

谢谢！

编辑：

这是我关于云消息传递的清单部分：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.problemio"
    android:versionCode="82"
    android:versionName="2.2.82" >

    <supports-screens  android:largeScreens="true"   android:normalScreens="true"  android:smallScreens="true"/> 

    <uses-sdk android:minSdkVersion="4" android:targetSdkVersion="16"/>
    <!-- <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="xx"/>  -->

    <uses-permission android:name="android.permission.INTERNET" />

    <!-- Required permission to use in-app billing. -->
    <uses-permission android:name="com.android.vending.BILLING" />

    <permission android:name="com.problemio.permission.C2D_MESSAGE" 
        android:protectionLevel="signature" />
    <uses-permission android:name="com.problemio.permission.C2D_MESSAGE" />

    <!-- App receives GCM messages. -->
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" /> 
    <!-- GCM requires a Google account. -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <!-- Keeps the processor from sleeping when a message is received. -->
    <uses-permission android:name="android.permission.WAKE_LOCK" /> 

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" 
        android:theme="@style/CustomTheme" 
        android:name="MyApplication"
        android:debuggable="true"
                >

        <!--  For Google Cloud Messaging -->
        <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >
          <intent-filter>
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
                <category android:name="com.problemio" />
          </intent-filter>
        </receiver>   

        <service android:name=".GCMIntentService" />
        <!--  End of Google Cloud Messaging --> 
```

# javascript - 在 HTML 文件之间传递变量

> ID：12976931
> 
> 赞同：1
> 
> 时间：2012-10-19T14:56:22.737
> 
> 标签：javascript, html

假设我有两个 HTML 文件：a.html 和 b.html。我在打开的 b 中有一个链接

如何在文件 a 中创建一个 JavaScript 函数，以便当我单击链接时，它将一个字符串发送到 b，打开 b，然后 b 中的一个变量将存储该字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T14:57:47.110

如果你在做这个客户端，那么你必须在第二页的 URI 的查询字符串中传递第一页的数据。然后你可以从第二页的[`location`对象](https://developer.mozilla.org/en-US/docs/DOM/window.location)中解析出来。

# php - 单个多维数组键突然消失？

> ID：12976936
> 
> 赞同：2
> 
> 时间：2012-10-19T14:56:30.117
> 
> 标签：php, serialization, multidimensional-array, deserialization

我正在使用多维数组在脚本中存储一些信息。有数百个额外的密钥，但这是前三个的样子（私人信息被审查）：

```
Array
(
    [0] => Array
        (
            [last_name] => LAST NAME
            [first_name] => COLLEEN
            [middle_name] => F
            [dob] => 00/00/87
            [sex] => F
            [race] => W
            [city] => SOME CITY
        )

    [1] => Array
        (
            [last_name] => LAST NAME
            [first_name] => COLLEEN
            [middle_name] => F
            [dob] => 00/00/87
            [sex] => F
            [race] => W
            [city] => SOME CITY
        )

    [2] => Array
        (
            [last_name] => LAST NAME
            [first_name] => STEPHANIE
            [middle_name] => L
            [dob] => 00/00/74
            [sex] => F
            [race] => W
            [city] => SOME CITY
        )
) 
```

`$array[1]`我想消除重复的键值，例如`$array[0]`. 为此，我这样做：

```
function multi_array_unique($array)
{
  $result = array_map("unserialize", array_unique(array_map("serialize", $array)));

  foreach ($result as $key => $value) {
    if (is_array($value)) {
      $result[$key] = multi_array_unique($value);
    }
  }

  return $result;
}

$unique_array = multi_array_unique($array);
$unique_array = array_values($unique_array); 
```

现在，这完成了删除数组中所有重复项的出色工作......除了我无法弄清楚的一件小事。这是数组现在的样子：

```
Array
(
    [0] => Array
        (
            [last_name] => LAST NAME
            [first_name] => COLLEEN
            [middle_name] => F
            [dob] => 00/00/87
            [race] => W
            [city] => SOME CITY
        )

    [1] => Array
        (
            [last_name] => LAST NAME
            [first_name] => STEPHANIE
            [middle_name] => L
            [dob] => 00/00/74
            [sex] => F
            [race] => W
            [city] => SOME CITY
        )

    [2] => Array
        (
            [last_name] => LAST NAME
            [first_name] => ASIA
            [middle_name] => ALIA
            [dob] => 00/00/88
            [sex] => F
            [race] => B
            [city] => SOME CITY
        )
) 
```

到底`$array[0]["sex"]`去哪儿了？？？这是唯一缺少的一个，我检查了这个数据集中的 93 个键中的每一个。只是`$array[0]`缺少`["sex"]`钥匙。我完全被难住了。你们有什么想法吗？

**编辑：**

Ray 能够提供一个可行的解决方案来实现我想要的结果，但**我仍然想知道导致原始错误的原因。**

这是 Ray 的工作代码（改编成函数）：

```
function multi_array_unique($multi_array)
{
    $newArray = array();
    foreach($multi_array as $subArray) {
        if(!in_array($subArray, $newArray)) {
            $newArray[] = $subArray;
        }
    }

  return $newArray;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:07:03.600

试试这个来摆脱重复的成员：

```
$newArray = new array();
 foreach($originalArray as $subArray){
     if(!in_array($subArray, $newArray){
         $newArray[] = $subArray;
      }
  } 
```

数组 $newArray 应该只有原始数组的唯一成员。

# sql-server - 存储过程参数的日志？

> ID：12976938
> 
> 赞同：0
> 
> 时间：2012-10-19T14:56:32.883
> 
> 标签：sql-server, sql-server-2008, logging, stored-procedures

> **可能重复：**
> [跟踪存储过程的参数处理](https://stackoverflow.com/questions/10279470/tracing-a-stored-procedures-parameters-handling)

SQL Server 2008 中是否有任何开箱即用的功能可以让我查看执行的过程日志和传递的参数？

我们有一个存储过程，其返回用于确定用户是否可以登录到我们的应用程序，并且存储过程返回了一些意外结果。我试图通过查看用户 ID 在传递给存储过程时是否出现乱码来进行故障排除，但我似乎无法找到可以去哪里检查。

这样的日志/查看器是否存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:15:27.603

您可以使用 SQL Trace 或 SQL 分析器，它本质上是同一工具的 GUI。

SQL Trace 的详细信息在这里 msdn.microsoft.com/en-us/library/ms191006(v=sql.105).aspx

探查器在这里 msdn.microsoft.com/en-us/library/ms181091.aspx

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T16:27:00.470

如果您需要跟踪正在运行的所有内容，Pete 有正确的答案，但是如果您可以自己修改过程，则可以将日志记录功能（例如插入具有相关详细信息的表中）直接添加到过程中。这避免了分析器潜在的巨大性能影响。

# sql - 在 SQL Server 2008 R2 中传输数据

> ID：12976940
> 
> 赞同：0
> 
> 时间：2012-10-19T14:56:36.253
> 
> 标签：sql, sql-server, sql-server-2008-r2

我在不同的服务器（开发和生产）上有两个数据库我需要将我的数据从多个表从开发移动到生产，而不影响生产中预先存在的数据。知道 SQL Manager 是否支持这样的东西，还是我必须为它编写一个脚本？

我的详细情况：

我有一个工具可以让我为我的公司创建调查。该工具位于开发和生产中。因为我不想在我的生产数据库中添加测试数据，所以我使用该工具的开发版本来创建我的调查并在本地测试它们。该工具与我数据库中的几个表相关联，例如调查、问题、答案、结果等。

我当前的设置：当我完成调查并准备启动时，我必须使用该工具的生产版本来手动重做我之前在生产中所做的所有工作。这一点都不理想，不仅因为我必须花时间去做，而且在手动复制过程中也有出错的风险。

我需要做的：我上面提到的那些表，里面已经有生产数据，可供我公司使用。当我创建一个新调查时，我只需要将新调查的特定记录（来自所有表）从开发转移到生产，而不会影响我以前在那里的任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T15:03:07.640

利用[`Import and Export Data`](http://algconsultings.wordpress.com/2010/10/05/import-data-into-sql-server/)

或者将 DEV 服务器作为链接服务器添加到您的 PROD 服务器中，然后使用 INSERT/SELECT 语句

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-19T15:06:11.947

您可以使用数据库比较工具，对于 SQL Server，我使用 SQL Delta，它允许您自动创建脚本以在您希望的数据库中运行，[http://www.sqldelta.com/](http://www.sqldelta.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-19T15:16:05.770

您不会为此找到任何开箱即用的解决方案，但是一旦您清楚地了解了您要完成的任务（*详细信息*），就有一些工具可以提供帮助。在这一点上花一点时间来确保你真的清楚你期望发生的事情会在你投入生产时带来巨大的回报。

您所描述的场景听起来就像您的数据库中有一些配置类型的数据以及您的事务或域数据。换句话说，您需要将更改从开发环境升级到生产环境，以使您的应用程序正常工作。这并不罕见，但是当您为这样的场景设置促销计划时，您必须非常谨慎和非常小心——毕竟，您不想将测试数据推送到您的生产系统中您的配置更改。因此，确定您将要从 dev 推送到 prod 的表并确保这些表是您正在朝该方向推送的唯一表是至关重要的。

您还提到了“不影响生产中预先存在的数据”。你能告诉我们更多关于这个（也许是一个例子）吗？通常，您希望保持特定表（按照惯例）设置为仅将更改移动到一个方向——即，从开发到产品。如果您有需要包含合并更改的表，您将不得不更加注意正确处理这一点，因为您需要处理合并错误——当您有数据要推送时会发生什么例如，它已经存在于目标数据库中？

一旦你制定了你真正想要移动的计划，其他答案中提到的一些工具可能会起作用，或者查看 Redgate 的工具（如[SQL Data Compare](http://www.red-gate.com/products/sql-development/sql-data-compare/)）——它们制作了一些非常好的产品来帮助 DB管理任务。

---- 附录 ----

根据对问题的编辑，这里有一些额外的想法：

(1) 允许您的生产调查具有“禁用”或“测试”模式，因此您不必在另一个环境中更改数据。这允许您仅在存在实际开发更改时才能将内容从开发转移到生产。

(2) 定义一个“包”机制以将调查从一个环境移动到另一个环境。这将允许您通用且可靠地处理合并冲突、ID 更改等。作为奖励，这还允许您将生产调查移回开发人员以进行调试和测试。

# java - 如何在两个容器中运行 Jade 代理（来自两个控制台）

> ID：12976946
> 
> 赞同：1
> 
> 时间：2012-10-19T14:57:04.677
> 
> 标签：java, containers, agents-jade

我是 Jade 新手，正在学习[Jade Primer](http://www.iro.umontreal.ca/~vaucher/Agents/Jade/primer4.html#6)。我正在使用最新版本的 Jade v4.2。我正在尝试设置两种行为，每种行为都编码为接收消息。我应该在两个分开的窗口中运行它们，但这对我不起作用。

我在 WinXp 上使用 Eclipse。我已进入 Jade 的类路径

```
c:\jade\lib\jade.jar;C:\jade\lib\commons-codec\commons-codec-1.3.jar;C:\Program Files\Java\jre7\bin 
```

和包含我的项目的文件夹

```
C:\Users\me\workspace\jadeProject\src 
```

有文件夹**primer4**（添加到Java 代码的包），我将Java 文件放在其中。我从控制台通过**javac**编译了 Java 文件。

然后我尝试从控制台（从**primar4**文件夹）运行：

```
%java jade.Boot -agents a1:primer4.Responder;a2:primer4.Responder 
```

第一个命令正在工作。然后我运行第二个控制台窗口并输入：

`%java jade.Boot -container main:primer4.Template`

```
INFO: Service jade.core.event.Notification initialized
pač 19, 2012 4:35:57 PM jade.core.AgentContainerImpl startBootstrapAgents
SEVERE: Cannot create agent main: Class primer4.Template for agent ( agent identifier 

:name main@10.0.2.15:1099/JADE ) not found [nested java.lang.ClassNotFoundException: primer4.Template]
pač 19, 2012 4:35:57 PM jade.core.AgentContainerImpl joinPlatform
INFO: Agent container Container-2@10.0.2.15 is ready. 
```

我收到了这个错误，谁能告诉我：

1.  我该如何解决？
2.  是否可以从控制台中的一行（在一个控制台中，同时）在两个容器中运行代理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-10-29T16:33:12.650

尝试`-agents`第二个命令中的选项：

```
java jade.Boot -container -agents main:primer4.Template 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T20:26:02.033

这是由 Classpath 问题引起的。因此，请确保在类路径中包含您的 .class 文件的目录。

您可以通过以下方式为每个容器创建一个代理

`-container`选项。

或者您可以通过以下方式创建代理

```
jade.core.Runtime runtime = jade.core.Runtime.instance();

jade.wrapper.AgentContainer home = runtime.createAgentContainer(new ProfileImpl());

home.createNewAgent(getName(), Agent.class.getName(), args); 
```

像这样，您可以创建代理并动态添加。

# mongodb - 如何对 mongoDb 请求进行分组以获得更好的性能？

> ID：12976951
> 
> 赞同：0
> 
> 时间：2012-10-19T14:57:20.713
> 
> 标签：mongodb

有没有办法对 MongoDb 的请求进行分组？

例如，我有一个来自 C# 代码的 collection.find 和三个 collection.aggregate 请求。

我想知道有没有办法将它们组合起来并通过网络只发送一个请求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T19:23:21.083

MongoDB 的[有线协议](http://www.mongodb.org/display/DOCS/Mongo+Wire+Protocol)设计用于每条消息的单个操作，因此不支持将多个操作分组到单个请求中。唯一接近这一点的是[批量插入](http://www.mongodb.org/display/DOCS/Inserting#Inserting-Bulkinserts)，但这实际上是一个需要多个文档的操作。

在非分片 MongoDB 系统上，您可以想象通过单个[eval](http://docs.mongodb.org/manual/reference/command/eval/)命令执行多个服务器端操作。这将需要向 MongoDB 发送一个 JavaScript 函数，该函数运行多个操作，然后将它们的结果填充到要返回的单个结果中。但是，我很难想到一种现实情况，在这种情况下，这比通过驱动程序发送多个请求更可取（JS 性能较差，存在并发问题等）。

# android - 通过 openGL 设置 contentView 工作非常缓慢

> ID：12976952
> 
> 赞同：1
> 
> 时间：2012-10-19T14:57:22.930
> 
> 标签：android, image, opengl-es, bitmap

在我的应用程序中，我从相机获取数据，创建`bitmap`对象，我必须使用它来显示它`openGL`，因此我有`Square`类和 `GlRenderer`类。问题是它的工作速度非常慢，每次它显示一些图像，然后黑屏，以及另一个图像等等。下面是我的课

```
Square class

package com.example.videochat;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;

import javax.microedition.khronos.opengles.GL10;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.opengl.GLUtils;

public class Square {

    private FloatBuffer vertexBuffer;   // buffer holding the vertices
    private float vertices[] = {
            -1.0f, -1.0f,  0.0f,        // V1 - bottom left
            -1.0f,  1.0f,  0.0f,        // V2 - top left
             1.0f, -1.0f,  0.0f,        // V3 - bottom right
             1.0f,  1.0f,  0.0f         // V4 - top right
    };

    private Bitmap m_bitmap;

    private FloatBuffer textureBuffer;  // buffer holding the texture coordinates
    private float texture[] = {         
            // Mapping coordinates for the vertices
            0.0f, 1.0f,     // top left     (V2)
            0.0f, 0.0f,     // bottom left  (V1)
            1.0f, 1.0f,     // top right    (V4)
            1.0f, 0.0f      // bottom right (V3)
    };

    /** The texture pointer */
    private int[] textures = new int[1];

    public Square(Bitmap bitmap) {
        // a float has 4 bytes so we allocate for each coordinate 4 bytes

        m_bitmap = bitmap;
        ByteBuffer byteBuffer = ByteBuffer.allocateDirect(vertices.length * 4);
        byteBuffer.order(ByteOrder.nativeOrder());

        // allocates the memory from the byte buffer
        vertexBuffer = byteBuffer.asFloatBuffer();

        // fill the vertexBuffer with the vertices
        vertexBuffer.put(vertices);

        // set the cursor position to the beginning of the buffer
        vertexBuffer.position(0);

        byteBuffer = ByteBuffer.allocateDirect(texture.length * 4);
        byteBuffer.order(ByteOrder.nativeOrder());
        textureBuffer = byteBuffer.asFloatBuffer();
        textureBuffer.put(texture);
        textureBuffer.position(0);
    }

    public void loadGLTexture(GL10 gl, Context context) {

        // generate one texture pointer
        gl.glGenTextures(1, textures, 0);
        // ...and bind it to our array
        gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);

        // create nearest filtered texture
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MIN_FILTER, GL10.GL_NEAREST);
        gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_MAG_FILTER, GL10.GL_LINEAR);

        //Different possible texture parameters, e.g. GL10.GL_CLAMP_TO_EDGE
//      gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_S, GL10.GL_REPEAT);
//      gl.glTexParameterf(GL10.GL_TEXTURE_2D, GL10.GL_TEXTURE_WRAP_T, GL10.GL_REPEAT);

        // Use Android GLUtils to specify a two-dimensional texture image from our bitmap 
        GLUtils.texImage2D(GL10.GL_TEXTURE_2D, 0, m_bitmap, 0);

        // Clean up
        m_bitmap.recycle();
    }

    /** The draw method for the square with the GL context */
    public void draw(GL10 gl) {
        // bind the previously generated texture
        gl.glBindTexture(GL10.GL_TEXTURE_2D, textures[0]);

        // Point to our buffers
        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glEnableClientState(GL10.GL_TEXTURE_COORD_ARRAY);

        // Set the face rotation
        gl.glFrontFace(GL10.GL_CW);

        // Point to our vertex buffer
        gl.glVertexPointer(3, GL10.GL_FLOAT, 0, vertexBuffer);
        gl.glTexCoordPointer(2, GL10.GL_FLOAT, 0, textureBuffer);

        // Draw the vertices as triangle strip
        gl.glDrawArrays(GL10.GL_TRIANGLE_STRIP, 0, vertices.length / 3);

        //Disable the client state before leaving
        gl.glDisableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glDisableClientState(GL10.GL_TEXTURE_COORD_ARRAY);
    }
} 
```

GlRenderer 类

```
package com.example.videochat;

import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;

import android.content.Context;
import android.graphics.Bitmap;
import android.opengl.GLU;
import android.opengl.GLSurfaceView.Renderer;

public class GlRenderer implements Renderer {

    private Square      square;     // the square
    private Context     context;

    /** Constructor to set the handed over context */
    public GlRenderer(Context context, Bitmap bitmap) {
        this.context = context;
        // initialise the square
        this.square = new Square(bitmap);
    }

    @Override
    public void onDrawFrame(GL10 gl) {
        // clear Screen and Depth Buffer
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);

        // Reset the Modelview Matrix
        gl.glLoadIdentity();

        // Drawing
        gl.glTranslatef(0.0f, 0.0f, -5.0f);     // move 5 units INTO the screen
                                                // is the same as moving the camera 5 units away
//      gl.glScalef(0.5f, 0.5f, 0.5f);          // scale the square to 50% 
                                                // otherwise it will be too large
        square.draw(gl);                        // Draw the triangle

    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) {
        if(height == 0) {                       //Prevent A Divide By Zero By
            height = 1;                         //Making Height Equal One
        }

        gl.glViewport(0, 0, width, height);     //Reset The Current Viewport
        gl.glMatrixMode(GL10.GL_PROJECTION);    //Select The Projection Matrix
        gl.glLoadIdentity();                    //Reset The Projection Matrix

        //Calculate The Aspect Ratio Of The Window
        GLU.gluPerspective(gl, 45.0f, (float)width / (float)height, 0.1f, 100.0f);

        gl.glMatrixMode(GL10.GL_MODELVIEW);     //Select The Modelview Matrix
        gl.glLoadIdentity();                    //Reset The Modelview Matrix
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig config) {
        // Load the texture for the square
        square.loadGLTexture(gl, this.context);

        gl.glEnable(GL10.GL_TEXTURE_2D);            //Enable Texture Mapping ( NEW )
        gl.glShadeModel(GL10.GL_SMOOTH);            //Enable Smooth Shading
        gl.glClearColor(0.0f, 0.0f, 0.0f, 0.5f);    //Black Background
        gl.glClearDepthf(1.0f);                     //Depth Buffer Setup
        gl.glEnable(GL10.GL_DEPTH_TEST);            //Enables Depth Testing
        gl.glDepthFunc(GL10.GL_LEQUAL);             //The Type Of Depth Testing To Do

        //Really Nice Perspective Calculations
        gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_NICEST); 

    }

} 
```

`main`和那类的一部分

```
public void initGlSurfaceView (Bitmap bmp, SurfaceView VideoCaptureBitmap) {
        glSurfaceView = new GLSurfaceView(this);
        glSurfaceView.setRenderer(new GlRenderer(this,bmp));
        setContentView(glSurfaceView);
    }

    private void startVideo() {
        if(m_Camera != null) return;
        SurfaceHolder videoCaptureViewHolder = null;
        try {
            m_Camera = Camera.open();
        } catch (RuntimeException e) {
            Log.e("CameraTest", "Camera Open filed");
            return;
        }
        m_Camera.setErrorCallback(new ErrorCallback() {
            public void onError(int error, Camera camera) {
            }
        }); 
        Camera.Parameters parameters = m_Camera.getParameters();
        //parameters.setPreviewFrameRate(30);

        List<Size> supportedPreviewSizes=parameters.getSupportedPreviewSizes();
        Iterator<Size> supportedPreviewSizesIterator=supportedPreviewSizes.iterator();
        while(supportedPreviewSizesIterator.hasNext()){
            Size tmpSize=supportedPreviewSizesIterator.next();
            Log.v("CameraTest","supportedPreviewSize.width = "+tmpSize.width+"supportedPreviewSize.height = "+tmpSize.height);
        }

        m_Camera.setParameters(parameters);
        if (null != m_VideoCaptureView)
            videoCaptureViewHolder = m_VideoCaptureView.getHolder();
        try {
            m_Camera.setPreviewDisplay(videoCaptureViewHolder);
        } catch (Throwable t) {
        }
        Log.v("CameraTest","Camera PreviewFrameRate = "+m_Camera.getParameters().getPreviewFrameRate());
        Size previewSize=m_Camera.getParameters().getPreviewSize();
        int dataBufferSize=(int)(previewSize.height*previewSize.width*
                               (ImageFormat.getBitsPerPixel(m_Camera.getParameters().getPreviewFormat())/8.0));
        m_Camera.addCallbackBuffer(new byte[dataBufferSize]);
        m_Camera.addCallbackBuffer(new byte[dataBufferSize]);
        m_Camera.addCallbackBuffer(new byte[dataBufferSize]);
        m_Camera.setPreviewCallbackWithBuffer(new Camera.PreviewCallback() {

            private long timestamp=0;
            public synchronized void onPreviewFrame(byte[] data, Camera camera) {
                //Log.v("CameraTest","Time Gap = "+(System.currentTimeMillis()-timestamp));
                //int size = data.length;

                //Bitmap btmp = BitmapFactory.decodeByteArray(data, 0, size);
                //m_VideCaptureBitmap.setImageBitmap(btmp);

                Size previewSize = camera.getParameters().getPreviewSize(); 
                YuvImage yuvimage=new YuvImage(data, ImageFormat.NV21, previewSize.width, previewSize.height, null);
                ByteArrayOutputStream baos = new ByteArrayOutputStream();
                yuvimage.compressToJpeg(new Rect(0, 0, previewSize.width, previewSize.height), 80, baos);
                byte[] jdata = baos.toByteArray();

                // Convert to Bitmap
                Bitmap bmp = BitmapFactory.decodeByteArray(jdata, 0, jdata.length);
                //m_VideCaptureBitmap.setImageBitmap(bmp);

                initGlSurfaceView(bmp, m_VideCaptureBitmap);
                // set our renderer to be the main renderer with
                // the current activity context

                //setContentView(glSurfaceView);

                Log.v("CameraTest","Frame size = "+ data.length);
                timestamp=System.currentTimeMillis();
                try{
                    camera.addCallbackBuffer(data);
                }catch (Exception e) {
                    Log.e("CameraTest", "addCallbackBuffer error");
                    return;
                }
                return;
            }
        });

        try {
            m_Camera.startPreview();
        } catch (Throwable e) {
            m_Camera.release();
            m_Camera = null;
            return;
        }
    } 
```

有人可以帮助我吗？感谢和问候

# .net - 从 Visual Studio 项目和 TFS 中删除文件列表

> ID：12976959
> 
> 赞同：0
> 
> 时间：2012-10-19T14:57:39.340
> 
> 标签：.net, visual-studio, tfs

我想从 asp.net 项目中删除所有未使用的图像。我找到了 85 个未使用的文件。是否有任何自动方法可以从项目和 TFS 源代码控制中删除所有这些文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:00:33.157

您可以编写一个插件，它可能会让您有一个文件作为输入，列出要删除的文件，然后执行这些操作。

与手动删除它们相比，编写它们可能需要更长的时间。

是星期五。冷静下来并单击/确认鼠标 85 次。

# java - 使用struts2从jsp页面的隐藏字段获取arraylist到动作类

> ID：12976963
> 
> 赞同：2
> 
> 时间：2012-10-19T14:57:57.657
> 
> 标签：java, list, jsp, struts2, hidden-field

我有一个数组列表，我已将它设置到 jsp 的 hiddenField 中。现在我必须在我的操作类中访问这个列表。下面，代码片段如下

我的行动课

```
private ArrayList<TXT_File_Action> statusResult_list=new ArrayList<TXT_File_Action>();
    private ArrayList<TXT_Beans> regenerateTXTList=new ArrayList<TXT_Beans>();
    private ArrayList<TXT_Beans> pagingList=new ArrayList<TXT_Beans>();
    private ArrayList<TXT_Beans> serverList=new ArrayList<TXT_Beans>();

public String getGenerateList()
    {

          for(int j=0;j<customers_accountList.size();j++)
               {

               dataList=txt_managerInstance.regenerateListData(id_no);  
               regenerateTXTList.add(dataList.get(0));
           }

               pagingList=getRegenerateTXTList();
               setRegenerateTXTList(getRegenerateTXTList());
               setPagingList(getPagingList());

        return SUCCESS;
      }

  getters..n setters 
```

我的 JSP 代码是

```
 <s:iterator value="pagingList">
<tr>
     <td align="center"><s:property value="customerId" /></td>  
     <td align="center"><s:property value="cspId" /></td>    
     <td align="center"><s:property value="branchCode" /></td>
     <td align="center" id="bcID"><s:property value="bcCode"/></td>
 </tr>

</s:iterator> 
```

下面我在jsp隐藏字段中设置列表，如下所示：

```
 <input type="hidden" name="serverList" id="serverList"  value="<s:property value="pagingList"/>"/> 
```

现在，当我单击某个事件时，我希望在我的操作类中使用此列表。每当我尝试在操作中打印此列表**serverList**的大小时，都会出现以下错误：

```
java.lang.ArrayIndexOutOfBoundsException: -1
    java.util.ArrayList.get(Unknown Source)
    com.alw.action.TXT_File_Action.setPaginationList(TXT_File_Action.java:424)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    java.lang.reflect.Method.invoke(Unknown Source)
        .
        .
        . 
```

但我确定我在这个隐藏字段中获得了所有 Arrayllist 数据，因为我已经在我的页面上检查了这个

```
**<input type="hidden" name="serverList" id="serverList"  value="<s:property value="pagingList"/>"/>** 
```

这是怎么回事，如何在我的行动课上得到这个列表。任何帮助都会非常有帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T15:28:04.510

您不能将 a `List`or any`Object`直接放入 a `input`or `s:hidden`，这里是[DOCUMENT](http://struts.apache.org/2.3.3/docs/hidden.html)，属性`value`应该是一个字符串。如果你打算这样做，你应该使用[Struts2 Type Conversion](http://struts.apache.org/2.x/docs/type-conversion.html)。

解决问题的最简单方法是将列表放入会话中。这是链接[SessionAware](http://www.splinter.com.au/how-to-use-sessions-with-struts-2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-19T15:38:43.203

出于缓存/存储的目的，您不应该将 java 变量添加到 html 字段。由于您使用的是 Struts，因此您可以将此 ArrayList 变量存储为表单 bean 的一部分。

# ios - iOS 图像滚动动画行为

> ID：12976972
> 
> 赞同：1
> 
> 时间：2012-10-19T14:58:25.317
> 
> 标签：ios, xcode, animation, uiscrollview, behavior

我正在构建一个图像滑块/滚动组件。到目前为止，我使用 UIScrollView 并打开了分页，每个视图都有自己的图像，一切都很好:)

但是......当图像从主视图“滑开”时，它并没有像它应该的那样很好地消失（就像默认行为一样），它只是消失了。

如何更改滚动视图动画行为？

谢谢！

# arrays - 在一行上打印数组元素

> ID：12976982
> 
> 赞同：11
> 
> 时间：2012-10-19T14:59:06.143
> 
> 标签：arrays, powershell

我`$array`在代码中的某个位置填充了一个数组变量，例如下面

```
this

is

an

array

varaible 
```

如果，我想打印出数组变量，就像`thisisanarrayvariable`一个衬里一样

我采用了以下方法，但是在程序挂起时我没有得到任何结果

`for ($i=0;$i -le $array.length; $i++)` `{ $array[$i] }`

显然，我不想像把它们粘在一起`$array[0]+$array[1]+$array[2]..`

希望我能得到更好的答案。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-19T15:01:36.000

使用[`-join`运算符](http://technet.microsoft.com/library/hh847757.aspx)：

```
$array -join ''; 
```

您也可以调用该[`String.Join`方法](http://msdn.microsoft.com/library/dd988350.aspx)：

```
[String]::Join('', $array); 
```

在任何一种情况下，结果都将是一个新`String`实例，其中每个元素`$array`连接在一起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-19T15:00:22.587

只需使用

```
-join $array 
```

这会将所有元素粘合在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-03T19:49:59.257

#我无法将数据输入到数组中，然后作为文件输出...我不断收到多行： `$Output+= "$Name,",($IPV4.IPV4Address).IPAddressToString # Fills the array with the #true response`

# mysql - 使用 MySQL 在多个数据库上运行相同的查询

> ID：12976984
> 
> 赞同：0
> 
> 时间：2012-10-19T14:59:07.233
> 
> 标签：mysql

我们在同一台服务器上有 100 多个具有相同架构的数据库。我需要在所有数据库上运行相同的 select 语句并返回结果。我查看了几篇关于更改许多数据库的帖子并尝试了这个：

```
SELECT CONCAT
    ('SELECT * FROM ', a.table_schema,  '.tableIwant
    GROUP BY CONCAT(emp_id, "-", other_id)
    HAVING count(CONCAT(emp_id, "-", other_id)) >1')
FROM information_schema.tables a 
WHERE a.table_schema LIKE 'table_prefix_%'
GROUP BY a.table_schema; 
```

但是所有这些返回的是一个查询列表。我知道我可以使用 PHP 来做到这一点 - 用一个查询构建所有 dbs 的列表，然后在结果集上进行 WHILE 循环等。但我想从 MySQL 做到这一点，有没有办法？

更新：

感谢@KayakJim，我尝试创建一个存储过程来解决这个问题：

```
DELIMITER //
CREATE PROCEDURE checkDuplicates()
BEGIN

DECLARE bDone INT;
DECLARE dbname VARCHAR(20);
DECLARE count1, count2 INT;
DECLARE curs CURSOR FOR SELECT table_schema FROM INFORMATION_SCHEMA.TABLES WHERE table_schema like 'table_%' GROUP BY table_schema;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET bDone = 1;

CREATE TEMPORARY TABLE IF NOT EXISTS db1.tblResults  (
name VARCHAR(20),
countDupes INT,
countDupesAll INT
) ENGINE = MEMORY
;

OPEN curs;

SET bDone = 0;

REPEAT
FETCH curs INTO dbname;

SELECT SQL_CALC_FOUND_ROWS * FROM dbname.table
GROUP BY CONCAT(emp_id, "-", other_id) 
HAVING count(CONCAT(emp_id, "-", other_id)) >1;

SET count1 =  FOUND_ROWS();

SELECT SQL_CALC_FOUND_ROWS * FROM dbname.table
GROUP BY CONCAT(emp_id, "-", other_id, "-", param) 
HAVING count(CONCAT(emp_id, "-", other_id, "-", param)) >1;

SET count2 = FOUND_ROWS();

UNTIL bDone END REPEAT;

  CLOSE curs;
  SELECT * FROM db1.tblResults;
END;
//

CALL checkDuplicates(); 
```

现在的问题是，当我执行时，它返回错误 1049: Unknown database 'information_schema'。当我接受该查询并单独运行它时，我没有收到任何错误，并且它返回与 WHERE 子句匹配的数据库列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T15:01:27.250

您使用 PHP 发布的解决方案可以在存储过程中完成，这将按照您的要求将逻辑保留在 MySQL 中。

# user-interface - 在另一个内部使用快捷方式的软件创建者

> ID：12976985
> 
> 赞同：-3
> 
> 时间：2012-10-19T14:59:08.483
> 
> 标签：user-interface, ide, open-source

我想知道是否有任何软件可以在另一个软件中创建带有快捷方式的软件？

就像如果你想做一个网络编辑器，你会冷冷地说，如果你按下那个按钮，它会写：

```
<html></html> 
```

并使用浏览器进行渲染？

如果没有这样的软件，是否可以制作？也许我错了，但我认为这将是开源开发的一个突破口。

我不是一个熟练的开发人员，所以我不会设法做这样的事情，但我想成立一​​个小组来做这件事，为它做一个网站。你认为有人想帮助我还是你们中的一个？

我在网上搜索过类似的东西，但没有找到任何东西。

**编辑：**

* * *

我知道这是很糟糕的表述，我将再次解释这一点。我的意思不是网络编辑器，而是软件开发者应用程序。网页设计师只是一个例子。

想象一下自己，您有一个 UI 设计师，您可以在其中导入其他软件，然后将一个按钮拖入屏幕，并在设置中说，当您单击该按钮时，该软件将进入您想要的软件之一导入并做一些事情。

我要的软件是这个软件开发者软件。

**再次编辑：**

* * *

我将再次尝试澄清：

你知道机器人吗？那些在网上飞来飞去，疯狂的事情，如厚颜无耻的酒店奖品玩扑克。

我只是想知道您是否冷制作了一个像 QT 或 GTK 这样的新 GUI，它会在单击按钮时模拟某个键盘事件或鼠标手势。并在这样做时开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:57:46.280

[http://www.linuxquestions.org/questions/linux-newbie-8/kompozer-problems-733285/#post3580690](http://www.linuxquestions.org/questions/linux-newbie-8/kompozer-problems-733285/#post3580690)

由那里的某人组成的列表中有几个强大的网络编辑器。它包括具有所见即所得的编辑器。

我使用的 Aptana studio 可以使用不同的浏览器进行渲染。它还有一个内置的 Web 服务器，以便您可以测试 AJAX 请求和 php 渲染。

# svn - How to have Jenkins automatically clone a maven job when a SVN branch is created?

> ID：12976996
> 
> 赞同：1
> 
> 时间：2012-10-19T14:59:50.853
> 
> 标签：svn, maven, jenkins

Our project uses maven to build, Subversion as code repository, and Jenkins for continuous integration. When a new branch is created (typically during a release), we have to create a new job in Jenkins by hand.

Is it possible to tell Jenkins to automatically create job for newly created branches (and not legacy ones) ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-20T20:47:08.093

Yes, it is doable. You would have to create a SVN hook, and then using Jenkins CLI (you could use groovy) or Jenkins REST API you could have to create the job for the project.

Here's an example using [Sinatra + GitHub](https://github.com/versapay/hudson-github-autobranch) Another using [Groovy + GitHub](http://entagen.github.com/jenkins-build-per-branch/)

# sdl - 防止等轴测艺术中的过度绘制

> ID：12976999
> 
> 赞同：2
> 
> 时间：2012-10-19T14:59:55.283
> 
> 标签：sdl, game-engine, isometric

**背景：**

我正在创建一个以等距视角呈现世界的游戏，通过绘制等距瓷砖来实现。我目前的实现是幼稚的，使用画家的方法，从后到前，从下到上，使用平铺图像中的表面块。

**问题：**

我担心透支（可能是过度的，如果是这种情况，请告诉我）。这是单层瓷砖的小快照：

![透支](../Images/2ff06c0a23807bfb71555a9df5c800fd.png)

以粉红色高亮显示的区域是从后到前、从下到上的方法不止一次将像素传送到画布上的区域。这是一个小而人为的例子，但在实践中我希望完成更多的事情：

![信用 eBoy](../Images/31a54991ce5a73e7aa7c0e321dba6668.png)

（图片[来源 eBoy](http://hello.eboy.com/eboy/2012/10/19/amv-street-12t-png/ "男孩")）

对于如此复杂的图像，以及基于 tile 的实现，在合成最终图像之前，每个屏幕像素都会被绘制多次，感觉效率非常低。由于这些只是 2D 图像，最终带有一位 alpha 蒙版，因此没有 3D 的担忧（例如，没有浪费的照明或变换数学），但似乎仍然应该有一个更优雅根据最终合成中是否会被遮挡来确定是否应绘制像素的方法。

**解决方案？**

到目前为止，我提出的最佳解决方案是：

*   颠倒绘制顺序，从前到后，从上到下绘制。
*   每个像素保留一位假 z 缓冲区，用于记录像素是否已被绘制。
*   仅在其覆盖的某些像素尚未绘制时才绘制图块。

有一个更好的方法吗？blit 操作是否超级高效，我在这里对风车倾斜？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T15:36:36.530

风车。 *特别是*如果您使用的是 OpenGL 加速的 SDL2 blits。