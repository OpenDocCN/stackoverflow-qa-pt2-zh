# StackOverflow 问答 14573000-14573999

# c - 使用写入或异步安全函数从信号处理程序打印 int

> ID：14573000
> 
> 赞同：20
> 
> 时间：2013-01-28T23:13:11.543
> 
> 标签：c, signals, async-safe

`write`我想在信号处理程序中使用（或任何异步安全函数）将数字打印到日志或终端。我宁愿不使用缓冲 I/O。

有没有一种简单且推荐的方法来做到这一点？

例如代替`printf`, 下面我更喜欢`write`（或任何异步安全功能）。

```
void signal_handler(int sig)
{
  pid_t pid;
  int stat;
  int old_errno = errno;

  while((pid = waitpid(-1, &stat, WNOHANG)) > 0)
    printf("child %d terminated\n", pid);

  errno = old_errno;
  return;
} 
```

打印字符串很容易。代替`printf`上面我可以使用（不打印`pid`）：

```
write(STDOUT_FILENO, "child terminated", 16); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T23:22:58.900

如果您真的坚持从信号处理程序进行打印，您基本上有 2 个选择：

1.  阻止信号，除非在您为处理信号而创建的专用线程中。这个特殊的线程可以简单地执行`for (;;) pause();`，并且由于`pause`是异步信号安全的，因此允许信号处理程序使用它想要的任何功能；它不仅限于异步信号安全功能。另一方面，它确实必须以线程安全的方式访问共享资源，因为您现在正在处理线程。

2.  编写自己的代码将整数转换为十进制字符串。这只是一个简单的循环，使用`%10`和`/10`剥离最后一个数字并将它们存储到一个短数组中。

但是，我强烈建议使用[自管道技巧](http://cr.yp.to/docs/selfpipe.html)或类似方法将此操作从信号处理程序中取出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-31T08:28:29.150

**实现您自己的异步信号安全`snprintf("%d`并使用`write`**

它没有我想象的那么糟糕，[如何在 C 中将 int 转换为字符串？](https://stackoverflow.com/questions/8257714/how-to-convert-an-int-to-string-in-c)有几个实现。

下面的 POSIX 程序将迄今为止接收到 SIGINT 的次数计入标准输出，您可以使用`Ctrl + C`.

`Ctrl + \`您可以使用(SIGQUIT)退出程序。

主.c：

```
#define _XOPEN_SOURCE 700
#include <assert.h>
#include <limits.h>
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <unistd.h>

/* Calculate the minimal buffer size for a given type.
 *
 * Here we overestimate and reserve 8 chars per byte.
 *
 * With this size we could even print a binary string.
 *
 * - +1 for NULL terminator
 * - +1 for '-' sign
 *
 * A tight limit for base 10 can be found at:
 * https://stackoverflow.com/questions/8257714/how-to-convert-an-int-to-string-in-c/32871108#32871108
 *
 * TODO: get tight limits for all bases, possibly by looking into
 * glibc's atoi: https://stackoverflow.com/questions/190229/where-is-the-itoa-function-in-linux/52127877#52127877
 */
#define ITOA_SAFE_STRLEN(type) sizeof(type) * CHAR_BIT + 2

/* async-signal-safe implementation of integer to string conversion.
 *
 * Null terminates the output string.
 *
 * The input buffer size must be large enough to contain the output,
 * the caller must calculate it properly.
 *
 * @param[out] value  Input integer value to convert.
 * @param[out] result Buffer to output to.
 * @param[in]  base   Base to convert to.
 * @return     Pointer to the end of the written string.
 */
char *itoa_safe(intmax_t value, char *result, int base) {
    intmax_t tmp_value;
    char *ptr, *ptr2, tmp_char;
    if (base < 2 || base > 36) {
        return NULL;
    }

    ptr = result;
    do {
        tmp_value = value;
        value /= base;
        *ptr++ = "ZYXWVUTSRQPONMLKJIHGFEDCBA9876543210123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[35 + (tmp_value - value * base)];
    } while (value);
    if (tmp_value < 0)
        *ptr++ = '-';
    ptr2 = result;
    result = ptr;
    *ptr-- = '\0';
    while (ptr2 < ptr) {
        tmp_char = *ptr;
        *ptr--= *ptr2;
        *ptr2++ = tmp_char;
    }
    return result;
}

volatile sig_atomic_t global = 0;

void signal_handler(int sig) {
    char buf[ITOA_SAFE_STRLEN(sig_atomic_t)];
    enum { base = 10 };
    char *end;
    end = itoa_safe(global, buf, base);
    *end = '\n';
    write(STDOUT_FILENO, buf, end - buf + 1);
    global += 1;
    signal(sig, signal_handler);
}

int main(int argc, char **argv) {
    /* Unit test itoa_safe. */
    {
        typedef struct {
            intmax_t n;
            int base;
            char out[1024];
        } InOut;
        char result[1024];
        size_t i;
        InOut io;
        InOut ios[] = {
            /* Base 10\. */
            {0, 10, "0"},
            {1, 10, "1"},
            {9, 10, "9"},
            {10, 10, "10"},
            {100, 10, "100"},
            {-1, 10, "-1"},
            {-9, 10, "-9"},
            {-10, 10, "-10"},
            {-100, 10, "-100"},

            /* Base 2\. */
            {0, 2, "0"},
            {1, 2, "1"},
            {10, 2, "1010"},
            {100, 2, "1100100"},
            {-1, 2, "-1"},
            {-100, 2, "-1100100"},

            /* Base 35\. */
            {0, 35, "0"},
            {1, 35, "1"},
            {34, 35, "Y"},
            {35, 35, "10"},
            {100, 35, "2U"},
            {-1, 35, "-1"},
            {-34, 35, "-Y"},
            {-35, 35, "-10"},
            {-100, 35, "-2U"},
        };
        for (i = 0; i < sizeof(ios)/sizeof(ios[0]); ++i) {
            io = ios[i];
            itoa_safe(io.n, result, io.base);
            if (strcmp(result, io.out)) {
                printf("%ju %d %s\n", io.n, io.base, io.out);
                assert(0);
            }
        }
    }

    /* Handle the signals. */
    if (argc > 1 && !strcmp(argv[1], "1")) {
        signal(SIGINT, signal_handler);
        while(1);
    }

    return EXIT_SUCCESS;
} 
```

编译并运行：

```
gcc -std=c99 -Wall -Wextra -o main main.c
./main 1 
```

按 Ctrl + C 十五次后，终端显示：

```
^C0
^C1
^C2
^C3
^C4
^C5
^C6
^C7
^C8
^C9
^C10
^C11
^C12
^C13
^C14 
```

这是一个创建更复杂格式字符串的相关程序：[如何避免在信号处理程序中使用 printf？](https://stackoverflow.com/questions/16891019/how-to-avoid-using-printf-in-a-signal-handler/52145149#52145149)

在 Ubuntu 18.04 上测试。[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/blob/3ce92f93fede767a3f5613b621678781c624c4b8/posix/signal_write_safe.c).

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-28T23:35:34.253

如果您坚持在信号处理程序中使用 xprintf() ，您始终可以滚动您自己的不依赖缓冲 I/O 的版本：

```
#include <stdarg.h> /* vsnprintf() */

void myprintf(FILE *fp, char *fmt, ...)
{
char buff[512];
int rc,fd;
va_list argh;
va_start (argh, fmt);

rc = vsnprintf(buff, sizeof buff, fmt, argh);
if (rc < 0  || rc >= sizeof buff) {
        rc = sprintf(buff, "Argh!: %d:\n", rc);
        }

if (!fp) fp = stderr;
fd = fileno(fp);
if (fd < 0) return;
if (rc > 0)  write(fd, buff, rc);
return;
} 
```

# node.js - NodeJS：如何将base64编码的字符串解码回二进制？

> ID：14573001
> 
> 赞同：328
> 
> 时间：2013-01-28T23:13:16.213
> 
> 标签：node.js, encoding, base64, decoding

我正在使用盐实现密码散列，所以我将盐生成为二进制，对密码进行散列，base64 对密码和盐进行编码，然后将它们存储到数据库中。

现在，当我检查密码时，我应该将盐解码回二进制数据，使用它来散列提供的密码，base64 编码结果并检查结果是否与数据库中的匹配。

问题是，我找不到将盐解码回二进制数据的方法。我使用 Buffer.toString 方法对它们进行了编码，但似乎没有反向功能。

* * *

## 回答 #1

> 赞同：716
> 
> 时间：2013-01-28T23:17:22.160

**从 Node.js v6.0.0 开始，**使用[构造函数方法已被弃用](https://nodejs.org/dist/v6.0.0/docs/api/buffer.html#buffer_new_buffer_str_encoding)，应使用以下方法从 base64 编码字符串构造新缓冲区：

```
var b64string = /* whatever */;
var buf = Buffer.from(b64string, 'base64'); // Ta-da 
```

**对于 Node.js v5.11.1 及以下版本**

构造一个 new`Buffer`并[作为第二个参数](https://stackoverflow.com/a/6182519/139010)[传递：`'base64'`](https://stackoverflow.com/a/6182519/139010)

```
var b64string = /* whatever */;
var buf = new Buffer(b64string, 'base64'); // Ta-da 
```

如果要干净，可以检查是否`from`存在：

```
if (typeof Buffer.from === "function") {
    // Node 5.10+
    buf = Buffer.from(b64string, 'base64'); // Ta-da
} else {
    // older Node versions, now deprecated
    buf = new Buffer(b64string, 'base64'); // Ta-da
} 
```

# linux - 当我使用 MTR 时，为什么更远的节点值更低？

> ID：14573004
> 
> 赞同：0
> 
> 时间：2013-01-28T23:13:39.337
> 
> 标签：linux, networking

mtr 报告如下：

```
shell> mtr --report ec2-122-248-229-83.ap-southeast-1.compute.amazonaws.com
HOST: macserver.local             Loss%   Snt   Last   Avg  Best  Wrst StDev
  1.|-- 192.168.12.1               0.0%    10    1.2   2.9   0.9   7.4   2.3
  2.|-- 101.36.89.49               0.0%    10    6.8   5.7   2.1  16.6   4.3
  3.|-- 192.168.17.37              0.0%    10   53.8 164.9   4.9 904.4 304.0
  4.|-- 220.181.105.25             0.0%    10    5.1  11.1   5.1  26.9   7.1
  5.|-- 220.181.0.5                0.0%    10   68.5  15.1   4.9  68.5  19.4
  6.|-- 220.181.0.41               0.0%    10   12.6  10.2   5.0  27.1   6.5
  7.|-- 202.97.53.82               0.0%    10    7.2   9.9   4.9  28.1   6.7
  8.|-- 202.97.58.94               0.0%    10   16.5  10.0   5.2  16.5   3.9
  9.|-- 202.97.61.98               0.0%    10   49.2  46.4  39.0  76.7  11.2
 10.|-- 202.97.121.98              0.0%    10   41.1  43.5  41.1  46.3   1.6
 11.|-- 63-218-213-206.static.pcc  0.0%    10   87.2  77.6  70.3  92.2   7.4
 12.|-- 203.83.223.62              0.0%    10   71.9  74.8  69.9  87.2   5.1
 13.|-- 203.83.223.77              0.0%    10   73.6  73.8  70.2  80.9   3.0
 14.|-- ec2-175-41-128-238.ap-sou  0.0%    10   70.4  73.9  70.4  84.1   4.0
 15.|-- ???                       100.0    10    0.0   0.0   0.0   0.0   0.0
 16.|-- ec2-122-248-229-83.ap-sou 10.0%    10   82.3  76.0  70.6  88.7   6.1 
```

为什么 16 行的平均值低于 11 行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:18:14.670

路由器旨在尽可能快地路由数据包。它们的设计目的不是尽可能快地生成和传输 ICMP 错误。显然，第 11 行的机器生成 ICMP 错误的速度非常慢。

当您看到经过一个跃点的时间比该跃点的时间短时，您就知道该路由器很可能花费了大量时间来生成 ICMP 错误并将其返回给您。

而且，当然，您必须忽略第 15 行。您没有收到该路由器的任何回复。

# c# - update progress control not working in asp.net

> ID：14573005
> 
> 赞同：0
> 
> 时间：2013-01-28T23:13:48.920
> 
> 标签：c#, asp.net, asp.net-ajax

I have defined an `<asp:UpdatePanel>` with an `<asp:UpdateProgress>` as

```
 <asp:ScriptManager ID="sm1" runat="server"></asp:ScriptManager>
    <asp:UpdatePanel ID="update1" runat="server">
        <ContentTemplate>
            <asp:Label id="lblresult" runat="server"></asp:Label><br /><br />
            <asp:Button ID="btn1" runat="server" Text="Refresh" OnClick="btn1_Click" />    <br />

      </ContentTemplate>
    </asp:UpdatePanel>
     <asp:UpdateProgress ID="up1" runat="server" AssociatedUpdatePanelID="update1">
                <ProgressTemplate>
                        <span style="color:green; font-style:italic;">Loading, please wait...</span>    
                </ProgressTemplate>
    </asp:UpdateProgress> 
```

The button event is defined as

```
protected void btn1_Click(object sender, EventArgs e)
{
    lblresult.Text = "<span style='color:red;'>"+ DateTime.Now.ToString() +"</span>";
} 
```

However, I do not get the `Loading, please wait...`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-25T17:29:38.140

```
<script type="text/javascript">
    var updateProgress = null;

    function postbackButtonClick() {
        updateProgress = $find("<%= uprMaster.ClientID %>");
        window.setTimeout("updateProgress.set_visible(true)", updateProgress.get_displayAfter());
        return true;
    }
</script>

<asp:Button runat="server" Text="Search" ID="btnSearch" OnClick="btnSearch_Click" ClientIDMode="Static" OnClientClick="return postbackButtonClick();"   /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T04:59:48.713

像这样把更新进度放在里面

```
<asp:ScriptManager ID="sm1" runat="server"></asp:ScriptManager>
    <asp:UpdatePanel ID="update1" runat="server">
        <ContentTemplate>

          <asp:UpdateProgress ID="up1" runat="server" AssociatedUpdatePanelID="update1">
            <ProgressTemplate>
                    <span style="color:green; font-style:italic;">Loading, please wait...</span>    
            </ProgressTemplate>

        <asp:Label id="lblresult" runat="server"></asp:Label><br /><br />
        <asp:Button ID="btn1" runat="server" Text="Refresh" OnClick="btn1_Click" />    <br />

  </ContentTemplate>
</asp:UpdatePanel>

</asp:UpdateProgress> 
```

# grails - 在 Grails 中的应用程序启动时添加管理员用户

> ID：14573006
> 
> 赞同：0
> 
> 时间：2013-01-28T23:13:53.933
> 
> 标签：grails, deployment, bootstrapping

我想知道如何在启动时将管理员用户添加到 Grails 应用程序。

**场景：**我开发了 Grails 应用程序并拥有适当的用户权限（在 Grails 中实现）。现在，一旦我在服务器上部署应用程序，它应该做的第一件事就是创建管理员用户。我的问题是怎么做？我现在不需要精心的“安装”。

**我的想法：**我想把检查和管理创建代码放在引导程序中，这是一个示例代码：

```
def admin = User.findByLogin("admin")
if (!admin) {
   admin = new User(login:"admin", name:"Administrator", password:"password")
   admin.save()
} 
```

但是，每次我在 Eclipse 中运行应用程序时，它都无法执行任何操作。我的意思是没有错误，根本没有动作。应用程序运行良好，但似乎完全跳过了引导程序。

问题是如何在首次运行或启动时通过 Grails 应用程序添加管理员用户？如果我需要使用引导程序，我上面的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:17:40.423

最有可能的情况是`save()`调用无法验证。替换`admin.save()`为

```
if (!admin.save()) {
    println "Failed to save admin due to errors: $admin.errors"
} 
```

或类似的东西来了解正在发生的事情。还要在此代码之前添加另一个 println 以确保代码甚至正在运行 - 您可能在代码中有更严重的错误。

一般来说，最好在`grails clean`应该工作的代码不工作时运行。它强制进行完全重新编译，并且经常使奇怪的行为消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T08:52:38.000

试试这个代码：

```
def admin = User.findByLogin("admin")
if (!admin) {
   admin = new User(login:"admin", name:"Administrator", password:"password")
   admin.save(failOnError:true)
} 
```

如果由于验证错误导致保存不成功，标志**failOnError 会强制 grails 抛出异常，如果没有此标志，grails 将不会静默保存实例。**

# html - CSS - 不需要的中断

> ID：14573009
> 
> 赞同：0
> 
> 时间：2013-01-28T23:14:07.893
> 
> 标签：html, css, break

我不想在我的网站上显示尽可能多的视频列表。在左侧，我想要一个导航区域。在导航旁边，我想放置第一个视频。

不幸的是，视频将放置在导航下方。我已经尝试过 display: inline-block; 等等，但还没有解决方案。

我做错什么了？ ![在此处输入图像描述](../Images/0a4a5fd154ab9e6d655a7fa7e233c56a.png)

```
<div id="content_wrapper">
    <div id="navigation_area"></div><!-- div end video area -->

    <div id="video_area">
        <div class="video_container">
            <div class="video_thumb"></div>
            <div class="video_info_container">
                <div class="video_name">Video Name 1</div>
                <div class="rating_container">
                    <div class="rating"></div>
                </div>
            </div>
        </div><!-- video_container -->

        <div class ="video_container">
            <div class="video_thumb"></div>
            <div class="video_info_container">
                <div class="video_name">Video Name 2</div>
                <div class="rating_container">
                    <div class="rating"></div>
                </div>
            </div>
        </div><!-- video_container -->

    </div> <!--div end video area-->
</div><!--div end content_wrapper--> 
```

CSS：

```
navigation_area{
    height:500px;
    width:100px;
    background-color:#ffffff;
    border-radius: 15px;
    -moz-border-radius: 15px;
    margin:2px;
}

#video_area{
    float: left;
}

.video_container{
    width: 400px;
    height: 300px;
    background-color: #ffffff;
    margin-left: 20px;
    margin-top: 20px;
    border-radius: 15px;
    -moz-border-radius: 15px;
    float: left;
    display: inline;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:18:52.180

尝试将您的 navigation_area 也向左浮动。

不要忘记样式ID前的#

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:01:11.930

删除`float: left`from `#video_area`and`.video_container`并添加`float: left`to`#navigation_area`代替。更改`display: inline`为`display: inline-block`

```
#navigation_area{
    ...
    float: left;
}

.video_container{
    ...
    display: inline-block;
} 
```

完整[的 JSFiddle](http://jsfiddle.net/9AJZh/2/)

如果您想保留 的`video_area`右侧`navigation_area`，无论如何，您都可`min-width`以为`content_area`

```
#content_wrapper {
    min-width: 400px;
} 
```

查看修改后[的 JSFiddle](http://jsfiddle.net/9AJZh/3/)

# r - cross hatching in maps using R

> ID：14573010
> 
> 赞同：1
> 
> 时间：2013-01-28T23:14:09.247
> 
> 标签：r, maps

I'd like to make a map in R of the continental U.S. (using the maps package), where one state is filled in in black (CA) and one state (TX) is filled in with cross-hatches or some other pattern. The rest of the states should have black borders with no fill. I'm sure there's a simple solution, but I haven't found it yet.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-29T19:06:19.403

我最近遇到了同样的问题，但是有太多的状态无法用多边形手动孵化。似乎只需在特定状态的地图中添加密度 = 10 就会用阴影条填充它。

因此，对于此处的示例，请尝试：

```
map("state")     
map("state", add = TRUE, region = c("texas"), density=10, fill=TRUE)
map("state", add = TRUE, region = c("california"),  fill=TRUE) 
```

我的想法是： [Fill Geospatial polygons with pattern - R](https://stackoverflow.com/questions/21677489/fill-geospatial-polygons-with-pattern-r)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T00:52:21.477

我可以通过保存状态数据并重新绘制来使其工作。需要进行一些`polygon`调整，以便状态多边形的轮廓以正确的顺序绘制，而不会加倍自身。需要多少摆弄可能取决于您想要的状态多边形。在这种情况下，我只需要颠倒德克萨斯/新墨西哥的边界。

```
library(maps)
map("state")     
tempplot <- map("state", add = TRUE, region = c("texas"),plot=FALSE)

# fix the border with new mexico to draw it in the correct order
tempplot$x[829:861] <- tempplot$x[861:829]
tempplot$y[829:861] <- tempplot$y[861:829]

polygon(
  na.omit(tempplot$x),
  na.omit(tempplot$y),
  border=1,
  density=10
)

map("state", add = TRUE, region = c("california"), fill=TRUE, col="black") 
```

![耶！ 我都在德克萨斯州孵化了！](../Images/30590b59177cd80f3df427fc8f6d1be3.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T00:23:25.763

这应该是一个好的开始。

```
library(maps)
map('state')     
map("state", col = "black", fill = TRUE, add = TRUE, region = c('california'))
map("state", col = "red", fill = TRUE, add = TRUE, region = c('texas')) 
```

PS：交叉影线填充图案通常不被认可。所以我在这里用红色填充德克萨斯。

**编辑**

一种选择是使用**lty**和**lwd**来区分状态。它看起来很棘手，但结果很清楚。

```
map("state", lty = 3)
map("state", col = "black", fill = TRUE, add = TRUE, region = c('california'))
map("state", lty=1,lwd = 3, fill = FALSE, add = TRUE, region = c('texas')) 
```

![在此处输入图像描述](../Images/368016c9a08434b005844a09080913b2.png)

# python - python使用另一个文件中的变量

> ID：14573021
> 
> 赞同：33
> 
> 时间：2013-01-28T23:14:53.657
> 
> 标签：python

我是新手，正在尝试制作一个简单的随机句子生成器-如何从存储在另一个 .py 文档中的列表中提取随机项目？我正在使用

```
random.choice(verb_list) 
```

从列表中拉出。如何告诉 python verb_list 在另一个文档中？

此外，了解解决方案背后的原理是什么也很有帮助。我想这类似于“文件引用”“文件桥接”等。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2013-01-28T23:30:30.880

您可以从文件中导入变量：

**变量数据.py**

```
verb_list = [x, y, z]
other_list = [1, 2, 3]
something_else = False 
```

**主文件.py**

```
from vardata import verb_list, other_list
import random

print random.choice(verb_list) 
```

你也可以这样做：

```
from vardata import * 
```

从该文件导入所有内容。不过要小心。您不想发生名称冲突。

或者，您可以只导入文件并通过其命名空间访问变量：

```
import vardata
print vardata.something_else 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-28T23:18:16.947

这叫做导入。

如果这是`data.py`：

```
verb_list = [
    'run',
    'walk',
    'skip',
] 
```

这是`foo.py`：

```
#!/usr/bin/env python2.7

import data
print data.verb_list 
```

然后运行`foo.py`将从`verb_list`.`data.py`

* * *

您可能需要完成[Python 教程的模块部分](http://docs.python.org/2/tutorial/modules.html)。

* * *

如果`verb_list`存储在您也想做其他事情的脚本中，那么当您只想导入其变量时，您将遇到脚本运行的问题。在这种情况下，标准做法是将所有脚本功能保留在一个名为 的函数中`main()`，然后使用魔法咒语：

```
verb_list = [
    'run',
    'walk',
    'skip',
]

def main():
    print 'The verbs are', verb_list

if __name__ == '__main__':
    main() 
```

现在，`main()`如果您所做的只是`import data`. 如果您有兴趣，Python 的创建者 Guido van Rossum 写了一篇关于编写更复杂的[Python`main()`函数](http://www.artima.com/weblogs/viewpost.jsp?thread=4829)的文章。

# javascript - Is binding objects to angular's $rootScope in a service bad?

> ID：14573023
> 
> 赞同：32
> 
> 时间：2013-01-28T23:15:02.663
> 
> 标签：javascript, angularjs, angularjs-rootscope

In angular, I have an object that will be exposed across my application via a service.

Some of the fields on that object are dynamic, and will be updated as normal by bindings in the controllers that use the service. But some of the fields are computed properties, that depend on the other fields, and need to be dynamically updated.

Here's a simple example (which is working on jsbin [here](http://jsbin.com/erudis/21/edit)). My service model exposes fields `a`, `b` and `c` where `c` is calculated from `a + B` in `calcC()`. Note, in my real application the calculations are a lot more complex, but the essence is here.

The only way I can think to get this to work, is to bind my service model to the `$rootScope`, and then use `$rootScope.$watch` to watch for any of the controllers changing `a` or `b` and when they do, recalculating `c`. But that seems ugly. **Is there a better way of doing this?**

* * *

A second concern is performance. In my full application `a` and `b` are big lists of objects, which get aggregated down to `c`. This means that the `$rootScope.$watch` functions will be doing a lot of deep array checking, which sounds like it will hurt performance.

I have this all working with an evented approach in BackBone, which cuts down the recalculation as much as possible, but angular doesn't seem to play well with an evented approach. **Any thoughts on that would be great too.**

* * *

Here's the example application.

```
var myModule = angular.module('myModule', []);

//A service providing a model available to multiple controllers
myModule.factory('aModel', function($rootScope) {
  var myModel = {
    a: 10,
    b: 10,
    c: null
  };

  //compute c from a and b
  calcC = function() {
    myModel.c = parseInt(myModel.a, 10) * parseInt(myModel.b, 10);
  };

  $rootScope.myModel = myModel;
  $rootScope.$watch('myModel.a', calcC);
  $rootScope.$watch('myModel.b', calcC);

  return myModel;
});

myModule.controller('oneCtrl', function($scope, aModel) {
  $scope.aModel = aModel;
});

myModule.controller('twoCtrl', function($scope, aModel) {
  $scope.anotherModel = aModel;
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T21:57:18.980

尽管从高层次上看，我同意 bmleite 的回答（存在要使用的 $rootScope，并且使用 $watch 似乎适用于您的用例），但我想提出一种替代方法。

用于`$rootScope.$broadcast`将更改推送到`$rootScope.$on`侦听器，然后它会重新计算您的`c`值。

这可以手动完成 - 即当您主动更改`a`或`b`值时，或者甚至可能在短暂的超时时间来限制更新频率。更进一步的步骤是在您的服务上创建一个“脏”标志，以便`c`仅在需要时计算。

显然，这种方法意味着更多地参与重新计算您的控制器、指令等 - 但如果您不想将更新绑定到`a`or的每个可能更改`b`，那么问题就变成了“在哪里画线”的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T16:11:26.917

我必须承认，当我第一次阅读您的问题并看到您的示例时，我对自己认为*“这是错误的”*，但是，在再次查看之后，我意识到它并没有我想象的那么糟糕。

让我们面对事实，`$rootScope`如果你想在应用程序范围内共享任何东西，那是可以使用的，这是放置它的最佳位置。当然，您需要小心，它是在所有范围之间共享的，因此您不想无意中更改它。但是让我们面对现实吧，这不是真正的问题，在使用嵌套控制器（因为子作用域继承父作用域属性）和非隔离作用域指令时，您已经必须小心了。“问题”已经存在，我们不应该以此为借口不遵循这种方法。

使用`$watch`似乎也是一个好主意。这是框架已经免费为您提供的东西，并且完全符合您的需要。那么，为什么要重新发明轮子呢？这个想法基本上与“改变”事件方法相同。

在性能级别上，您的方法实际上可能很“繁重”，但它始终取决于您更新`a`和`b`属性的频率。例如，如果您将`a`or设置`b`为`ng-model`输入框（例如在您的 jsbin 示例中），`c` 则每次用户键入内容时都会重新计算……这显然是过度处理。如果您使用软方法并更新`a`和/或`b`仅在必要时进行更新，那么您不应该遇到性能问题。`c`这与使用“更改”事件或 setter&getter 方法重新计算相同。`c`但是，如果您确实需要实时重新计算（即：`$rootScope``$watch`这将有助于改进它。

恢复，**在我看来**，你的方法还不错（一点也不！），只需小心`$rootScope`属性并避免“实时”处理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-02T15:35:41.997

我意识到这是一年半之后的事，但由于我最近做出了同样的决定，我想我会提供一个“对我有用”的替代答案，而不会污染`$rootScope`任何新的价值观。

它确实如此，但仍然*依赖*. `$rootScope`然而，它不是广播消息，而是简单地调用`$rootScope.$digest`.

基本方法是在您的角度服务中提供单个复杂模型对象作为字段。您可以提供比您认为合适的更多，只需遵循相同的基本方法，并确保每个字段承载一个其引用不变的复杂对象，即不要用新的复杂对象重新分配字段。相反，只修改此模型对象的字段。

```
var myModule = angular.module('myModule', []);

//A service providing a model available to multiple controllers
myModule.service('aModel', function($rootScope, $timeout) {
  var myModel = {
    a: 10,
    b: 10,
    c: null
  };

  //compute c from a and b
  calcC = function() {
    myModel.c = parseInt(myModel.a, 10) * parseInt(myModel.b, 10);
  };
  calcC();

  this.myModel = myModel;

  // simulate an asynchronous method that frequently changes the value of myModel. Note that
  // not appending false to the end of the $timeout would simply call $digest on $rootScope anyway
  // but we want to explicitly not do this for the example, since most asynchronous processes wouldn't 
  // be operating in the context of a $digest or $apply call. 
  var delay = 2000; // 2 second delay
  var func = function() {
    myModel.a = myModel.a + 10;
    myModel.b = myModel.b + 5;
    calcC();
    $rootScope.$digest();
    $timeout(func, delay, false);
  };
  $timeout(func, delay, false);
}); 
```

然后希望依赖服务模型的控制器可以自由地将模型注入其范围。例如：

```
$scope.theServiceModel = aModel.myModel; 
```

并直接绑定到字段：

```
<div>A: {{theServiceModel.a}}</div>
<div>B: {{theServiceModel.b}}</div>
<div>C: {{theServiceModel.c}}</div> 
```

每当服务中的值更新时，一切都会自动更新。

请注意，这仅在您将继承自 Object 的类型（例如数组、自定义对象）直接注入作用域时才有效。如果您将原始值（如字符串或数字）直接注入范围（例如`$scope.a = aModel.myModel.a`），您将获得一个副本放入范围，因此在更新时永远不会收到新值。通常，最佳实践是将整个模型对象注入范围，就像我在示例中所做的那样。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-29T00:54:40.603

一般来说，这可能不是一个好主意。如果没有其他原因，重构变得更加困难和繁重，将模型实现公开给所有调用者也是（通常）不好的做法。我们可以轻松解决这两个问题：

```
myModule.factory( 'aModel', function () {
  var myModel = { a: 10, b: 10 };

  return {
    get_a: function () { return myModel.a; },
    get_b: function () { return myModel.a; },
    get_c: function () { return myModel.a + myModel.b; }
  };
}); 
```

这是最佳实践方法。它可以很好地扩展，仅在需要时才被调用，并且不会污染`$rootScope`.

PS：您也可以在设置或`c`时进行更新，以避免每次调用时重新计算；哪个最好取决于您的实施细节。`a``b``get_c`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-29T09:48:13.820

从我对您的结构的了解来看，拥有`a`并`b`作为吸气剂可能不是一个好主意，但`c`应该是一个功能......

所以我可以建议

```
myModule.factory( 'aModel', function () {
  return {
    a: 10,
    b: 10,
    c: function () { return this.a + this.b; }
  };
}); 
```

使用这种方法，您当然不能 2 路绑定`c`到输入变量。但是双向绑定`c`也没有任何意义，因为如果您设置 的值`c`，您将如何拆分 和 之间的`a`值`b`？

# wpf - Scrolling a FlowDocument inside a TabControl

> ID：14573024
> 
> 赞同：0
> 
> 时间：2013-01-28T23:15:04.660
> 
> 标签：wpf, scroll, tabcontrol, flowdocument

I have this XAML fragment:

```
<!-- ... -->
<TabControl>
    <TabItem>
        <!-- ... -->
    </TabItem>

    <TabItem Header="Source" ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.CanContentScroll="True">
        <FlowDocumentScrollViewer>
            <FlowDocument>
                <Paragraph>
                    <TextBlock
                        Text="{Binding Path=CurrentObject.Source}"
                        FontFamily="Consolas,Courier,Segoe UI"
                        FontSize="12" 
                        />
                </Paragraph>

            </FlowDocument>
        </FlowDocumentScrollViewer>
    </TabItem>
</TabControl>
<!-- ... --> 
```

The problem is that the flow document does not scroll horizontally. I've been unable to enable that.

Any clues?

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T20:38:55.803

这里有几件事。第一个是在段落中使用控件的功能不同于将包装以适合您的 FlowDocument 的运行。

第二个是 FlowDocument 将适合您的 FlowDocumentScrollViewer。如果您像以前一样向其中添加控件，它将适合 FlowDocument 和查看器的宽度，并且文本将超出 TextBlock 边界。这意味着您的文档不需要滚动条；你的 TextBlock 会。您可以通过将 TextBlock 的 TextWrapping 属性设置为 Wrap 来查看这一点。

要解决此问题，请将 PageWidth 设置为超出查看器宽度限制的值，如下所示：

```
 <FlowDocumentScrollViewer>
        <FlowDocument PageHeight="1056"
                      PageWidth="816">
            <Paragraph>
                <TextBlock
                    Text="{Binding Path=CurrentObject.Source}"
                    FontFamily="Consolas,Courier,Segoe UI"
                    FontSize="12" 
                    />
            </Paragraph>

        </FlowDocument>
    </FlowDocumentScrollViewer> 
```

或绑定到您的 TextBlock：

```
 <FlowDocumentScrollViewer>
        <FlowDocument PageHeight="1056"
                      PageWidth="{Binding ElementName=Part, Path=ActualWidth}">
            <Paragraph>
                <TextBlock
                    Text="{Binding Path=CurrentObject.Source}"
                    FontFamily="Consolas,Courier,Segoe UI"
                    FontSize="12" 
                    />
            </Paragraph>

        </FlowDocument>
    </FlowDocumentScrollViewer> 
```

最后一件事是 FlowDocumentScrollViewer 有它自己的 Horizo​​ntalScrollBarVisibility 属性，您可以使用它（除非某些样式问题阻止它）。

# sql-server - 带小数和浮点数的 SQL Server AVG

> ID：14573026
> 
> 赞同：1
> 
> 时间：2013-01-28T23:15:11.133
> 
> 标签：sql-server, tsql, sql-server-2012

基本上，进行类似平均的两个查询给了我不同的结果；预期的“实际”值是 81.25，因此通过正常舍入，您会认为将其转换为 DECIMAL(10,1) 会导致 81.3，但其中一个查询（第一个）给出 81.2

以下是示例：

```
CAST( AVG( t1.NumCorrect / 7.0 * 100.0 ) AS decimal(10,1)) 
```

对比

```
CAST( AVG( t2.PercentCorrect ) AS decimal(10,1)) 
```

据我所知，唯一的区别是 PercentCorrect 是 REAL 类型，而 NumCorrect 是 FLOAT 类型。但它们都是浮点类型，那么为什么转换它们的行为会有所不同呢？

在第一行中，NumCorrect 就像“在 7 个可能中正确”，所以我正在计算一个“百分比”，然后是 AVG'd；而在第二个示例中，百分比是预先计算的，我只需要它 AVG'd。同样，第一行是给出 81.2 而不是 81.3

如果我需要为周围的查询或源数据提供更多上下文，我可以尝试……让我知道。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T23:10:46.643

在 SQL 上执行此操作，您将得到答案。

```
select 1425554.3/5457.251

select convert(real, (1425554.3/5457.251)) 
```

基本上， t2.PercentCorrect 已经被转换/转换为截断小数点值的实数。t1.NumCorrect 动态除法，所有小数点都在 avg 函数上处理。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-15T02:43:45.757

最简单的方法是除以 1.0，它将产生 6 位精度。

例子：

```
select avg(incomeamount/1.0),vendorid from dailyincome group by vendorid 
```

# jquery - 基于 ASP.NET 模型的表单重置

> ID：14573029
> 
> 赞同：0
> 
> 时间：2013-01-28T23:15:21.927
> 
> 标签：jquery, ajax, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我有一个使用模型填充某些字段的表单。

我有一个复选框列表，我想要一个重置按钮，将所有复选框重置为页面加载时的状态。如何使用当前模型刷新该表单，有效地删除所做的任何更改？

例如，有三个复选框，框 1 被选中，框 2 和 3 未被选中。用户检查了 2 和 3，但不记得他更改了什么并且不想更改任何不好的东西，因此他想点击重置按钮，将复选标记恢复为默认值，同时仍保留在表单上。

我确定会涉及一些 ajax，但我看不到如何使用当前模型重新加载页面。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:23:48.400

您可以将原始值存储在数据属性中。见[例子](http://jsfiddle.net/ErqsS/1/)。这样您就不必返回服务器（并显示加载指示器、处理错误情况等），因为您在更改之前拥有原始值的副本。

**HTML**

```
<input type="checkbox" checked data-was-checked="checked">Option 1</input>
<input type="checkbox">Option 2</input>
<input type="checkbox" checked data-was-checked="checked">Option 3</input>
<input type="checkbox">Option 4</input>
<button id="reset">Reset</button> 
```

**JAVASCRIPT**

```
$("#reset").click(function () {
    $("[type=checkbox]").each(function (index, cb) {
        cb.checked = !!cb.getAttribute("data-was-checked");
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:26:02.340

一种方法是使用 Action Partial 呈现您的复选框。Action Partial 是对 ActionResult 方法的调用，该方法将（可选）模型或 Viewbag 返回到 Partial View。Partial View 可以使用传递的逻辑来决定如何设置和呈​​现复选框。

```
<div id='divchkbox'>
    @Html.Action("/Tools/checkboxes/{id}")
</div> 
```

链接和事件处理程序

```
 $(document).ready(function () {

          $('#resetbtn').click(function(){
               $('divchkbox').load("/Tools/checkboxes/{id}");
          }
   }); 
```

# machine-learning - 对 TF 和 TF*IDF 向量执行 Chi-2 特征选择

> ID：14573030
> 
> 赞同：12
> 
> 时间：2013-01-28T23:15:24.707
> 
> 标签：machine-learning, scikit-learn, feature-selection

我正在试验一些文本分类任务的 Chi-2 特征选择。我知道 Chi-2 测试检查依赖关系 B/T 两个**分类**变量，所以如果我们对具有二进制 BOW 向量表示的二进制文本分类问题执行 Chi-2 特征选择，每个 (feature,class) 上的每个 Chi-2 测试对将是一个非常简单的 Chi-2 测试，具有 1 个自由度。

引用文档：[http](http://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html#sklearn.feature_selection.chi2) ://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html#sklearn.feature_selection.chi2 ，

> 该分数可用于从 X 中选择具有最高 χ²（卡方）统计值的 n_features 特征，其中必须包含相对于类的布尔值或频率（例如，文档分类中的术语计数）。

在我看来，我们还可以在 DF（字数）向量表示上执行 Chi-2 特征选择。我的第一个问题是：sklearn 如何将整数值特征离散化为分类？

我的第二个问题与第一个类似。从这里的演示代码：http: [//scikit-learn.sourceforge.net/dev/auto_examples/document_classification_20newsgroups.html](http://scikit-learn.sourceforge.net/dev/auto_examples/document_classification_20newsgroups.html)

在我看来，我们也可以在 TF*IDF 向量表示上执行 Chi-2 特征选择。sklearn 如何对实值特征进行 Chi-2 特征选择？

提前感谢您的友好建议！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-30T10:39:39.687

χ² 特征选择代码根据其输入（特征值）和 （类标签）构建[列联表。](https://en.wikipedia.org/wiki/Contingency_table)每个条目*i*，*j*对应于某个特征*i*和某个类别*j*，并保存属于类别*j*的所有样本的第*i*个特征值的总和。然后，它根据类的经验分布（只是它们在 中的相对频率）和特征值的均匀分布产生的预期频率计算 χ² 检验统计量。`X``y`******`y`******

 ***这在特征值是频率（例如，术语）时有效，因为总和将是该类中特征（术语）的总频率。没有进行离散化。

当值是 tf-idf 值时，它在实践中也很有效，因为这些只是加权/缩放频率。***

# mysql - MySQL为唯一ID生成器调用存储函数

> ID：14573031
> 
> 赞同：0
> 
> 时间：2013-01-28T23:15:25.610
> 
> 标签：mysql

我是 MySQL 功能领域的新手，但我似乎无法让它正常工作。基本上，每次我从这个特定的表运行 SELECT 查询时，都应该显示下一个递增的值。

这是我的桌子：

```
CREATE TABLE testdb.id_generator(
  invoice_id INT(11) NOT NULL,
  PRIMARY KEY (invoice_id)
)
ENGINE = INNODB
AVG_ROW_LENGTH = 16384
CHARACTER SET latin1
COLLATE latin1_swedish_ci; 
```

这是功能：

```
CREATE 
FUNCTION testdb.f_id_test()
  RETURNS INT(11)

BEGIN
  DECLARE v_val INT;
  DECLARE c_select CURSOR FOR SELECT invoice_id
                              FROM
                                id_generator;

  OPEN c_select;

  FETCH c_select INTO v_val;
  CLOSE c_select;

  UPDATE id_generator
SET
  invoice_id = invoice_id + 1;
  RETURN v_val;
END 
```

每当我尝试运行查询

```
 SELECT f_id_test()
  FROM
  id_generator 
```

它说“无法更新存储函数/触发器中的表'id_generator'，因为它已被调用此存储函数/触发器的语句使用。” 我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:55:19.260

当您运行语句时，请尝试不使用“FROM id_generator”，基本上只是：

```
SELECT f_id_test() 
```

您的函数已经从 id_generator 表中提取数据（因此 FROM 子句不会改变它），并且错误是说您的 SELECT 语句正在使用该函数试图更新的同一个表。

# r - 如何阻止 ggplot2 将矩阵旋转 90 度？

> ID：14573036
> 
> 赞同：5
> 
> 时间：2013-01-28T23:15:54.503
> 
> 标签：r, ggplot2, heatmap

我正在尝试使用 ggplot2 创建一个热图，但我注意到当我绘制它时它似乎将矩阵向左旋转 90 度。这很奇怪，使用`coord_flip()`和`t()`不工作，因为他们将其旋转到左边，而不是右边（所以他们没有纠正，而是创建了一个旋转 180 度的热图）。是否有任何选项或技巧可以防止这种情况发生？以下是相关代码：

```
#this is needed to run custHeat
zeroInterval <- function(mat, colors){
  #modified version of findInterval such that zero is given its own category
  #This function takes intervals as left exclusive, right inclusive.
  #This is mostly so that intervals consisting of a single value will still be represented.
  intervalMat <- matrix(0, nrow=nrow(mat), ncol=ncol(mat))
  j <- 1
  for(i in 1:(length(colors) - 1)){
    if(colors[i] != colors[i+1]){
      intervalMat[mat>colors[i] & mat<=colors[i+1]] <- j
      j <- j + 1
    } else {
      intervalMat[mat==colors[i]] <- j
      j <- j + 1
    }
  }
  return(intervalMat)
}

#this actually plots the heatmap
custHeat <- function(M){

  #create color bins/ranges for skewed matrix
  color_bins <- c(-5, -4, -3, -2, -1, 0, 0, 1)
  colors <- c('#67001F', '#B2182B', '#D6604D', '#F4A582', '#FDDBC7', "#FFFFFF", '#C6DBEF')

  #create complete color palette
  color_palette <- colorRampPalette(colors)(length(color_bins) - 1)

  #This function assigns a number to each matrix value, so that it is colored correctly
  mod_mat <- zeroInterval(random_matrix, color_bins)

  ## remove background and axis from plot
  theme_change <- theme(
    plot.background = element_blank(),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.border = element_blank(),
    axis.line = element_blank(),
    axis.ticks = element_blank(),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.title.x = element_blank(),
    axis.title.y = element_blank()
  )

  ## output the graphics
  ggplot(melt(mod_mat), aes(x = X1, y = X2, fill = factor(value))) +
    geom_tile(color = "black") +
    scale_fill_manual(values = color_palette, name = "") +
    theme_change
}

##create random matrix, skewed toward negative values
random_matrix <- matrix(runif(100, min = -5, max = 1), nrow = 10)
random_matrix[1,] <- 0 #zeros should be at the top row of the heatmap
custHeat(random_matrix) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:00:05.403

您可以通过将矩阵在另一个方向上预旋转 90 度来抵消绘图功能的 90 度逆时针旋转：

```
## An example matrix
(m <- matrix(1:9, ncol=3))
#      [,1] [,2] [,3]
# [1,]    1    4    7
# [2,]    2    5    8
# [3,]    3    6    9

## The same matrix rotated 90 degrees clockwise
t(m)[,nrow(m):1]
#      [,1] [,2] [,3]
# [1,]    3    2    1
# [2,]    6    5    4
# [3,]    9    8    7 
```

* * *

**后来补充：**

一些 R 绘图函数使用与 相同的约定`image()`，而另一些则不使用。（请随时添加到此列表中。）

```
m <- matrix(1:9, ncol=3)

## ------- These plotting functions DO rotate a matrix --------

## image()
image(m, col=blues9)

## levelplot() -- a lattice equivalent of image()
library(lattice)    
levelplot(m, at=(1:10)-0.5, col.regions=blues9)

## Others
contour(m)
filled.contour(m, color=colorRampPalette(blues9))
persp(m) 
lattice::contourplot(m)
lattice::wireframe(m)  ## Nicely illustrates the logic of the indexing it uses

## ------- These plotting functions DO NOT --------

## imageRaster() -- a graphical primitive used by image(), among other functions 
plot(0:1, 0:1, type="n", xlab="", ylab="")
rasterImage(matrix(blues9, ncol=3), 0,0,1,1, interpolate=FALSE)

## grid.raster() -- imageRaster()'s counterpart in the grid graphical system
library(grid)
grid.raster(matrix(blues9, ncol=3), interpolate=FALSE)

## plot(raster()) in raster package
library(raster)
plot(raster(m), col=blues9) 
```

# jquery - 从 excel 或文本文件中读取链接并在 iFrame 中显示它们

> ID：14573037
> 
> 赞同：2
> 
> 时间：2013-01-28T23:15:55.080
> 
> 标签：jquery, excel, iframe

希望有解决方案。我要做的是从 excel 电子表格或 txt 文件中提取数据，特别是链接，并在 iFrame 中显示该链接。我还需要有一个下一个和上一个按钮，单击时可以转到下一个单元格或行。

# twitter-bootstrap - bootbox js 对话框的图标

> ID：14573038
> 
> 赞同：3
> 
> 时间：2013-01-28T23:15:56.463
> 
> 标签：twitter-bootstrap

有没有人知道如何在 bootbox.js 对话框中的按钮上添加图标？我想在此功能的“否”和“是”按钮上添加图标：

```
$(function () {
    $(".confirm-delete").click(function(e) {
        e.preventDefault();
        var id = $(this).data('id')
        bootbox.confirm("Remove this product?", "No", "Yes", function(confirmed) {
            if(confirmed) {
                deleteRecord(id);
            }
        });
    });     
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T00:42:24.730

您需要创建一个自定义对话框并使用[2.1.0 中添加](https://github.com/makeusabrew/bootbox#210)`icon`的配置选项。

例如：

```
$(function () {
    $(".confirm-delete").click(function(e) {
        e.preventDefault();
        var id = $(this).data('id')
        bootbox.dialog("Remove this product?", [{
            "label" : "No",
            "icon"  : "icon-remove"
        }, {
            "label" : "Yes",
            "icon"  : "icon-ok icon-white",
            "callback": function() {
                deleteRecord(id);
            }
        }]);
    });     
}); 
```

[自定义对话框示例](http://bootboxjs.com/#gist4340421)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-01T13:21:45.627

```
bootbox.confirm({
    title: "Destroy planet?",
    message: "Do you want to activate the Deathstar now? This cannot be undone.",
    buttons: {
        cancel: {
            label: '<i class="fa fa-times"></i> Cancel'
        },
        confirm: {
            label: '<i class="fa fa-check"></i> Confirm'
        }
    },
    callback: function (result) {
        console.log('This was logged in the callback: ' + result);
    }
}); 
```

# javascript - 从文本框中提取用户条目并将其存储在javascript中的变量中

> ID：14573039
> 
> 赞同：0
> 
> 时间：2013-01-28T23:15:57.900
> 
> 标签：javascript, asp.net

```
// text Box
        &nbsp;&nbsp;<asp:TextBox ID="TextBox3"  runat="server" BackColor="Silver" 
            BorderColor="Silver" ontextchanged="TextBox3_TextChanged" 
            style="margin-left: 6px" Width="154px"></asp:TextBox>

// Submit button
        &nbsp;<asp:Button ID="Button6" runat="server" BackColor="Silver" 
            onClientclick='store_memID()' style="margin-left: 20px" Text="Submit" 
            Width="102px" Font-Bold="True" Height="28px" />

    <script type = "text/javascript">
        // Function to caputure client-input- Member_ID.
        function store_memID() {

            var mem_ID = document.getElementById('TextBox3').value;

            return confirm('TimeLine is displayed for: ' + mem_ID);
        }

    </script> 
```

当我运行代码并在文本框中输入一个值然后按下提交按钮时：-“Microsoft JScript 运行时错误：无法获取属性‘值’的值：对象为空或未定义”。

否则，如果我删除“.value”：-

```
<script type = "text/javascript">
    // Function to caputure client-input- Member_ID.
    function store_memID() {

        var mem_ID = document.getElementById('TextBox3');

        return confirm('TimeLine is displayed for: ' + mem_ID);
    }

</script> 
```

然后运行程序，在文本框中输入值并按提交然后我得到：-

“时间线显示为：空”

我一直在研究解决这个问题。不知道出了什么问题...

***编辑（修复）：- 我的文本框的服务器端 ID 是“TextBox3”，但这不一定与客户端 ID 匹配。获取客户端 ID：- '<%=TextBox3.ClientID%>'***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:19:38.300

自从我编写 asp 表单以来已经有一段时间了，但客户端（在您的浏览器中）的 id 可能不是您认为的那样。在我看来，这是/曾经是 Web 表单的主要缺陷之一（这可能在 4.0 版中变得更简单，您必须检查一下）。您可以使用 css 类（并使用 jQuery 或类似方法来查找您的元素）或将客户端 id 注入 java 脚本，例如；

```
<script type = "text/javascript">
    // Function to caputure client-input- Member_ID.
    function store_memID() {
        var mem_ID = document.getElementById('<%=TextBox3.ClientID%>').value;
        return confirm('TimeLine is displayed for: ' + mem_ID);
    }
</script> 
```

**更新：如评论中指出的，修复了 ClientID 中的大小写错误**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:23:10.397

您正在使用主要用于服务器端代码的 asp 文本框。您放置在标签中的 ID 不保证与呈现的元素的 ID 匹配。

您将需要在浏览器中检查您的 html 以找到呈现的 id。（可能看起来像：ct100_TextBox3）并改用它。或者，如果您不进行任何服务器端编码，最好将文本框转换为`<input />`字段，或`<textarea />`.

# jquery - 为每个列表项添加不同的类

> ID：14573042
> 
> 赞同：1
> 
> 时间：2013-01-28T23:16:22.733
> 
> 标签：jquery

我创建了一个列表，并尝试为每个列表添加一个不同的类名。目前，我正在使用这种方法：

HTML：

```
<ul class="sd-list">
   <li><a href="#">List Item 1</a></li>
   <li><a href="#">List Item 2</a></li>
   <li><a href="#">List Item 3</a></li>
</ul> 
```

jQuery：

```
$('.sd-list:nth-child(1)').addClass('green');
$('.sd-list:nth-child(2)').addClass('red');
$('.sd-list:nth-child(3)').addClass('purple'); 
```

这很好用，但我想知道是否有比我目前使用的更好的方法。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T23:19:15.993

您可以将类放在一个数组中：

```
var colors = ['green', 'red', 'purple'];

$('.sd-list').each(function() {
    var index = $(this).index();
    if (index < colors.length) {
        $(this).addClass(colors[index]);
    }
}); 
```

如果列表都是同一个父级的所有子级，并且您曾经`:nth-child(X)`在位置获取元素`X`（而不是真正将其用作*“父级的第 n 个子级”*），并且每个位置都有一个类，您还可以简化它到：

```
$('.sd-list').addClass(function(index) {
    return colors[index];
}); 
```

* * *

但我同意 Vlad 的观点，你可以很容易地直接用 CSS 编写：

```
.sd-list:nth-child(1) {
    /* rules */
}
/* etc */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:19:15.027

```
$(function () {

      $(".sd-list li").each(function(index) {
            $(this).attr("class", "color" + index);
      });

}); 
```

# php - 按升序获取最后 10 行

> ID：14573045
> 
> 赞同：-2
> 
> 时间：2013-01-28T23:16:45.903
> 
> 标签：php, mysql, sql, mysqli

我已经通过嵌套在另一个 SELECT 中，然后使用 ASC 使用标准选择查询尝试了所有现有尝试，但是由于某种原因它无法在我的 JSCharts 中加载。我的代码工作正常，减去顺序：

```
SELECT `$tableName`.`$patient_idField` , `$tableDataName`.`$patient_idField` , `$tableDataName`.`$resultField` , `$tableName`.`$login_idField`
FROM `$tableName`
JOIN `$tableDataName` ON `$tableName`.`$patient_idField` = `$tableDataName`.`$patient_idField`
COLLATE utf8_general_ci
WHERE `$tableName`.`$login_idField` = $usssName
ORDER BY `$tableDataName`.id DESC LIMIT 10 
```

这是重新订购的尝试，但未能加载：

```
SELECT * FROM (
SELECT `$tableName`.`$patient_idField` , `$tableDataName`.`$patient_idField` , `$tableDataName`.`$resultField` , `$tableName`.`$login_idField`
FROM `$tableName`
JOIN `$tableDataName` ON `$tableName`.`$patient_idField` = `$tableDataName`.`$patient_idField`
COLLATE utf8_general_ci
WHERE `$tableName`.`$login_idField` = $usssName
ORDER BY `$tableDataName`.id DESC LIMIT 10 ) AS `$tableName` JOIN `$tableDataName` ORDER by `$tableDataName`.id ASC 
```

在没有 PHP 的情况下更新...

```
SELECT userlist.patient_id, results.patient_id, results.result, userlist.login_id
FROM userlist
JOIN results ON userlist.patient_id = results.patient_id
COLLATE utf8_general_ci
WHERE userlist.login_id = ####
ORDER BY results.id DESC
LIMIT 10 
```

现在，如果我对 ASC 执行此操作之外的任何操作，它会在`patient_id`.

## 有效的代码，供将来参考

```
SELECT  *
FROM (
SELECT userlist.patient_id, results.result, userlist.login_id, results.id
FROM userlist
  JOIN results ON userlist.patient_id = results.patient_id
COLLATE utf8_general_ci
WHERE userlist.login_id = ####
ORDER BY results.id DESC
LIMIT 10 ) temp
ORDER BY id 
```

它涉及删除其中一个`.patient_id`on SELECT。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:38:30.167

嵌套在另一个选择中应该可以工作；它是怎么失败的？

就像是：

```
select tablenamepatientidfield, tabledatanamepatientidfield, resultfield, loginidfield from (
    SELECT
        `$tableDataName`.id,
        `$tableName`.`$patient_idField` AS tablenamepatientidfield,
        `$tableDataName`.`$patient_idField` AS tabledatanamepatientidfield,
        `$tableDataName`.`$resultField` AS resultfield,
        `$tableName`.`$login_idField` AS loginidfield,
    FROM `$tableName`
    JOIN `$tableDataName` ON `$tableName`.`$patient_idField` = `$tableDataName`.`$patient_idField`
    COLLATE utf8_general_ci
    WHERE `$tableName`.`$login_idField` = $usssName
    ORDER BY `$tableDataName`.id DESC LIMIT 10
) AS descending_select ORDER BY id; 
```

（列名都是可变的并且可能发生冲突（并且不包括 id 本身），这有点尴尬。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:37:31.090

你能做到这一点吗

```
select * from (
    SELECT `$tableName`.`$patient_idField` 
         , `$tableDataName`.`$patient_idField` 
         , `$tableDataName`.`$resultField` 
         , `$tableName`.`$login_idField`
         ,`$tableDataName`.id
    FROM `$tableName`
      JOIN `$tableDataName` ON `$tableName`.`$patient_idField` 
                             = `$tableDataName`.`$patient_idField`
    COLLATE utf8_general_ci
    WHERE `$tableName`.`$login_idField` = $usssName
    ORDER BY `$tableDataName`.id DESC LIMIT 10 ) t
order by id 
```

试试这个，我已经编辑以更好地反映你实际在做什么

```
select  *
from (
    SELECT userlist.patient_id, results.result, userlist.login_id
    FROM userlist
      JOIN results ON userlist.patient_id = results.patient_id
    COLLATE utf8_general_ci
    WHERE userlist.login_id = ####
    ORDER BY results.id DESC
    LIMIT 10 ) temp
order by patient_id 
```

# java - 如何在 Java 的线程中捕获 InterruptedException？

> ID：14573047
> 
> 赞同：-4
> 
> 时间：2013-01-28T23:17:01.740
> 
> 标签：java, multithreading, exception

好的，在我的一个课程中，我想抛出一个 InterruptedException。我通过调用来做到这一点

```
thread.interrupt(); 
```

据我所知，这将引发 InterruptedException。我想知道的是如何在我的线程中捕获这个异常。这显然行不通：

```
public void run() throws InterruptedException // This results in an error 
```

编辑：如果我在我的线程中使用 try/catch 块，如果我从不声明它被抛出，我怎么能捕捉到一个中断的异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T23:31:06.150

调用`thread.interrupt`不会自动抛出`InterruptedException`. 您需要定期检查中断状态。例如：

```
if(Thread.currentThread().isInterrupted()) {
    throw new InterruptedException(); // or handle here.
} 
```

有些方法会为您执行此操作，例如`Thread.sleep`，否则不会抛出异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T23:19:41.263

要回答您的直接问题，您会像任何其他异常一样捕获它。通常，这将响应睡眠命令而完成，该命令确实会引发异常。如果你抓住了它，就没有必要把它扔到 run 语句之外。这应该有效，例如：

```
void run()
{
    try
    {
        Thread.sleep(500);
    }
    catch (InterruptedException ex)
    {
        //Do stuff here
    }
} 
```

但是，我怀疑[InterruptedException](http://docs.oracle.com/javase/6/docs/api/java/lang/InterruptedException.html)可能并不像您认为的那样。它只是在诸如 Thread.sleep() 之类的方法中抛出，与 无关`thread.interrupt()`，尽管名称相似。如果您想测试来自不同线程的 thread.interrupt()，您需要执行以下操作：

```
public void run()
{
  while (true)
  {
    if (Thread.interrupted())  // Clears interrupted status!
    {
        //Stop
        break;
    }
  }
} 
```

给定的代码将永远运行一个线程，直到它被中断（被另一个线程调用`interrupt()`它），它将停止。随意提出一个更复杂的例子。

# asp.net - 如何将html表格提取到XML文件中？

> ID：14573052
> 
> 赞同：1
> 
> 时间：2013-01-28T23:17:37.740
> 
> 标签：asp.net

我有一个存储在字符串中的 HTML 表

```
string tbl  = "<table calls='report'><tr><th>head</th><th>name</th></tr><tr><td>Department name</td><td>Mike</th></tr></table>"; 
```

我怎样才能遍历这个字符串，然后将其写入 XML 文件？

我想我将能够将文件写入 XML，但问题是如何或循环遍历字符串并识别 t 中的内容以及如何解析它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:23:08.827

由于 HTML 已经是 XML，您可以保持原样并满足您的目标。但我假设您想要语义上有意义的标签名称。

你可以试试[HTML Agility Pack](http://htmlagilitypack.codeplex.com/)。这允许您编写针对对象模型的查询，类似于使用 XDocument 和 Linq-to-XML 执行此操作的方式。我引用：

> 这是一个敏捷的 HTML 解析器，它构建一个读/写 DOM 并支持普通的 XPATH 或 XSLT（实际上你不必了解 XPATH 或 XSLT 就可以使用它，不用担心......）。它是一个 .NET 代码库，允许您解析“网络之外”的 HTML 文件。解析器对“真实世界”格式错误的 HTML 非常宽容。对象模型与 System.Xml 的提议非常相似，但用于 HTML 文档（或流）。

如果您不熟悉 XPATH 等，它还支持 Linq。

# csv - 如何通过实现 getSplits 增加 hadoop map 任务

> ID：14573054
> 
> 赞同：0
> 
> 时间：2013-01-28T23:17:41.017
> 
> 标签：csv, hadoop, amazon-emr, hadoop-partitioning

我想处理多行 CSV 文件，为此我编写了一个[自定义 CSVInputFormat](https://github.com/mvallebr/CSVInputFormat/blob/master/src/main/java/org/apache/hadoop/mapreduce/lib/input/CSVNLineInputFormat.java)。

我希望在每个 hadoop 节点上有大约 40 个线程处理 CSV 行。但是，当我在 Amazon EMR 上创建一个包含 5 台机器（1 个主设备和 4 个核心）的集群时，我可以看到我只运行了 2 个映射任务，即使有 6 个可用的映射槽：

![EMR 上的仪表板显示地图任务数量和可用插槽](../Images/204d07b605c0a9adc293ef21c14581d7.png)

我在 inputFormat 中实现了 getSplits，因此它的行为类似于 NLineInputFormat。我期待这样我会得到更多并行运行的东西，但没有任何效果。另外，我尝试设置 arguments `-s,mapred.tasktracker.map.tasks.maximum=10 --args -jobconf,mapred.map.tasks=10`，但没有效果。

我该怎么做才能并行处理行？hadoop 的运行方式，它不可扩展，因为无论我分配给集群多少实例，最多只能运行两个 map 任务。

更新：当我使用非压缩文件 (zip) 作为源时，它会创建更多的地图任务，大约 17 个用于 130 万行。即便如此，我想知道为什么它不应该更多以及为什么在压缩数据时没有创建更多的映射器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T21:44:55.690

更改拆分大小以进行更多拆分。

```
Configuration conf= new Cofiguration();
//set the value that increases your number of splits.
conf.set("mapred.max.split.size", "1020");
Job job = new Job(conf, "My job name"); 
```

# google-apps-script - 我可以从谷歌应用脚 本生成的 URL 链接下载文件吗

> ID：14573055
> 
> 赞同：8
> 
> 时间：2013-01-28T23:17:41.777
> 
> 标签：google-apps-script, google-sheets, google-apps

请帮助我在短时间内学习 google-apps-script。我想通过从存储在我的电子表格中的数据生成的 url 从远程站点下载文件。

例如，我有 2 个参数：

```
Cell1 = val1, val2, ... valN
Cell2 = val21, val22, ...  val2N 
```

我将字符串从单元格数据拆分为数组，然后生成 URL。例如：`http://mysite.com/files/file.val1.val22.zip` 比我需要从此链接下载文件...

我可以自动执行此过程吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T01:28:27.803

此示例函数将检索您的 zip 文件，并将其放入您的 Google Drive 文件夹中的“StackOverflow”文件夹中。[您也可以从此gist](https://gist.github.com/4660978)下载更完整的版本。

```
function getFile(fileURL) {
  // see https://developers.google.com/apps-script/class_urlfetchapp
  var response = UrlFetchApp.fetch(fileURL);
  var fileBlob = response.getBlob()
  var folder = DocsList.getFolder('StackOverflow');
  var result = folder.createFile(fileBlob);
  debugger;  // Stop to observe if in debugger
} 
```

例如：

```
getFile( "http://mysite.com/files/file.val1.val22.zip" ); 
```

请注意，您本身无法*下载*，因为您无法从应用程序脚本访问 PC 的资源（例如文件系统）。该文件仍在“云”中......在这种情况下，它已从它所在的网站复制到 Google Drive。但是，如果您正在运行 Drive 应用程序，该文件现在将同步到您的 PC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-18T19:33:39.203

是的你可以。
希望下面的代码可以解决您的问题：

```
//Declare function
function downloadFile() {
  //Getting url,existing name and new name for image from the sheet in 
  //variable url, name and new_name respectively
  var sh = SpreadsheetApp.getActiveSheet();
  var row = sh.getLastRow();
  Logger.log(row);
  for (var i = 2; i <= row; i++) {

    var url = sh.getRange(i, 10).getValue();
    Logger.log(url);
    var name = sh.getRange(i, 13).getValue();
    var new_name = sh.getRange(i, 4).getValue();
    //Creating authentication token for downloading image, it may not be //required if image can be downloaded without login into
    var user = "***************";
    var password = "************";
    var headers = {
      "Accept": "application/xml",
      "Content-Type": "application/xml",
      "Authorization": "Basic " + Utilities.base64Encode(user + ":" + password)
    };
    //defining method to download file
    var options = {
      "method": "get",
      "headers": headers
    };
    //Getting folder name where to store downloaded image
    var folders = DriveApp.getFoldersByName('test');
    while (folders.hasNext()) {
      var folder = folders.next();
      Logger.log(folder.getName());
    }
    //Getting response on hit of url using downloading method defined //earlier storing in Blob
    var response = UrlFetchApp.fetch(url, options).getBlob();
    //Creating image in folder defined with response in blob and logging same file //in log to check, if required
    var file = folder.createFile(response);
    Logger.log(file);

    //renaming image
    var images = folder.getFiles();
    while (images.hasNext()) {
      var image = images.next();
      file.setName(new_name);
      Logger.log(image.getName());
    }
  }
}
//Hope you get it now 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-18T07:25:22.030

它对我有用。

```
function downloadFile() {
  var url = "https://raw.githubusercontent.com/hoat23/VisionArtificialAndImageProcessing/master/bin/utils_imgprocessing.py"
  Logger.log(url);
  var response = UrlFetchApp.fetch(url);
  var text = response.getContentText()
  var newFile = DriveApp.createFile('testfilegoogle.txt',text);
  debugger;  // Stop to observe if in debugger
}
//Hope you get it now 
```

# c++ - 使用 OpenCV 2.4.3 进行双线性插值的 VideoCapture 旋转

> ID：14573059
> 
> 赞同：1
> 
> 时间：2013-01-28T23:18:10.330
> 
> 标签：c++, opencv, visual-studio-2012, interpolation, rotatetransform

**我正在使用双线性插值实现视频捕获旋转，如 OpenCV 库中的 warpAffine()。但到目前为止，我遇到了一些问题：**

**1.我在旋转过程中得到了一些伪影。这是边框、90 度旋转和 360 度伪影的示例**

[https://www.dropbox.com/sh/oe51ty0cy695i3o/hcAzwmAk6z](https://www.dropbox.com/sh/oe51ty0cy695i3o/hcAzwmAk6z)

![在此处输入图像描述](../Images/4c0d268b3f34cdafa6ba836fa2cacfa1.png)

![在此处输入图像描述](../Images/abfad79b34c8950e5b713327f8121614.png)

![在此处输入图像描述](../Images/d46d776c5d268b3986fa5e99755f9a4f.png)

**2.我不能改变我的捕捉分辨率使用**

```
capture.set(CV_CAP_PROP_FRAME_WIDTH, 1280 )
capture.set(CV_CAP_PROP_FRAME_HEIGHT, 720 ) 
```

它们都返回错误值。

我使用 LifeCam 影院。

**这是我的代码：**

```
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/imgproc/imgproc.hpp>

#include <cmath>
#include <ctime>

#include <iostream>
#include <cstdlib>

using namespace cv;
using namespace std;

const double M_PI = 3.14159265359;

void print_help( const char* prg );
Mat rotate( Mat& in, int angle , Point2f rotationCenter );

inline uchar int2uchar( int color  ) {
    return (uchar)( color < 0 ? 0 : color > 255 ? 255 : color );
}

void print_help( const char* prg ) {
    cout << "Report:" << endl;
    cout << "Application : " << prg << endl;
    cout << "Can't access capture device" << endl;
}

// rotation with bilinear interpolation
Mat rotate( Mat& in, int angle , Point2f rotationCenter ) {

    // Note : added Scalar(0) for unused pixels to be black
    Mat out( in.size(), in.type(), Scalar(0) );

    float in_radians    = (float)( angle * M_PI / 180 );
    float sinAngle      = (float)( sin( in_radians ) );
    float cosAngle      = (float)( cos( in_radians ) );

    for ( int col(0); col < in.cols; ++col ) {
        for ( int row(0); row < in.rows; ++row ) {

            // already around rotationCenter
            // x' = x * cos(angle) - y * sin(angle)
            float temp_columns( ( col    - rotationCenter.x ) * (cosAngle) -
                                ( row    - rotationCenter.y ) * (sinAngle) +
                                rotationCenter.x );
            // y' = x * sin(angle) + y * cos(angle)
            float temp_rows   ( ( col    - rotationCenter.x ) * (sinAngle) +
                                ( row    - rotationCenter.y ) * (cosAngle) +
                                rotationCenter.y );

            float max_col( ceil (temp_columns) );
            float min_col( floor(temp_columns) );
            float max_row( ceil (temp_rows)  );
            float min_row( floor(temp_rows)  );

            // clip all irrelevant parts
            if ( max_col >= in.cols || max_row >= in.rows ||
                        min_col < 0 || min_row < 0 ) {
                // don't draw
                continue;
            }

            float deltaCol( temp_columns - min_col );
            float deltaRow( temp_rows     - min_row );

            // left top, right top, left bottom and right bottom
            Vec3b q12( in.at < Vec3b >( (int)min_row, (int)min_col ) );
            Vec3b q22( in.at < Vec3b >( (int)min_row, (int)max_col ) );
            Vec3b q11( in.at < Vec3b >( (int)max_row, (int)min_col ) );
            Vec3b q21( in.at < Vec3b >( (int)max_row, (int)max_col ) );

            // R1 - linear interpolation of bottom neighborhoods
            double blueR1   ( ( 1 - deltaCol ) * q11[0] + deltaCol * q21[0] );
            double greenR1  ( ( 1 - deltaCol ) * q11[1] + deltaCol * q21[1] );
            double redR1    ( ( 1 - deltaCol ) * q11[2] + deltaCol * q21[2] );

            // R2 - linear interpolation of top neighborhoods
            double blueR2   ( ( 1 - deltaCol ) * q12[0] + deltaCol * q22[0] );
            double greenR2  ( ( 1 - deltaCol ) * q12[1] + deltaCol * q22[1] );
            double redR2    ( ( 1 - deltaCol ) * q12[2] + deltaCol * q22[2] );

            // P - linear interpolation of R1 and R2
            int blue ( (int)ceil( ( 1 - deltaRow ) * blueR2 + deltaRow * blueR1   ) );
            int green( (int)ceil( ( 1 - deltaRow ) * greenR2 + deltaRow * greenR1 ) );
            int red  ( (int)ceil( ( 1 - deltaRow ) * redR2  + deltaRow * redR1    ) );

            // Vec3b stands for 3-channel value, each channel is a byte
            out.at < Vec3b >( row, col )[ 0 ] = int2uchar(blue);
            out.at < Vec3b >( row, col )[ 1 ] = int2uchar(green);
            out.at < Vec3b >( row, col )[ 2 ] = int2uchar(red);
        }
    }

    return out;
}

int main( int ac, char ** av ) {
   if ( ac < 2 ) {
      print_help( av[ 0 ] );
      return -1;
   }

   // In degrees
   int step = 1, angle = 90;

   VideoCapture capture;

   // doesn't work properly
   if ( capture.set(CV_CAP_PROP_FRAME_WIDTH, 1280 ) &&
        capture.set(CV_CAP_PROP_FRAME_HEIGHT, 720 ) ) {
       cout << "Resolution : "
            << capture.get(CV_CAP_PROP_FRAME_WIDTH )
            << " x "
            << capture.get(CV_CAP_PROP_FRAME_HEIGHT )
            << endl;
   } else {
       cout << "There's some problem with VideoCapture::set()" << endl;
   }

   capture.open( atoi( av[ 1 ] ) );

   while ( !capture.isOpened( ) ) {
       print_help( av[ 0 ] );
       cout << "Capture device " << atoi( av[ 1 ] ) << " failed to open!" << endl;
       cout << "Connect capture device to PC\a" << endl;
       system("pause");
       cout << endl;
       capture.open( atoi( av[ 1 ] ) );
   }

   cout << "Device " << atoi( av[ 1 ] ) << " is connected" << endl;

   string original("Original");
   string withInterpolation("With Bilinear Interpolation");

   namedWindow( original, CV_WINDOW_AUTOSIZE );
   namedWindow( withInterpolation, CV_WINDOW_AUTOSIZE);

   Mat frame;

   for ( ;; ) {
      capture >> frame;
      if ( frame.empty( ) )
         break;

      createTrackbar("Rotate", withInterpolation, &angle, 360, 0);

      imshow( original, frame );

      char key = ( char ) waitKey( 2 );
      switch ( key ) {
      case '+':
         angle += step;
         break;
      case '-':
         angle -= step;
         break;
      case 27:
      case 'q':
         return 0;
         break;
      }

      Mat result;

      Point2f rotationCenter( (float)( frame.cols / 2.0 ),
                              (float)( frame.rows / 2.0 ) );

      result = rotate( frame, angle, rotationCenter );

      // Note : mirror effect
      // 1 says, that given frame will be flipped horizontally
      flip(result,result, 1);

      imshow( withInterpolation, result );

      // test to compare my bilinear interpolation and of OpenCV
      Mat temp;
      warpAffine( frame, temp,
                  getRotationMatrix2D( rotationCenter, angle, (double)(1.0) ),
                  frame.size(), 1, 0 );
      string openCVInterpolation("OpenCV Bilinear Interpolation");
      namedWindow( openCVInterpolation, CV_WINDOW_AUTOSIZE );
      createTrackbar("Rotate", openCVInterpolation, &angle, 360, 0);
      flip(temp,temp, 1);
      imshow( openCVInterpolation, temp );
   }

   return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-12T14:53:03.347

## 解决您的第二个问题 - 使用 OpenCV 设置 Lifecam 分辨率

我发现 Lifecam 仪表板可能会干扰 OpenCV Videocapture 调用。如果您使用控制面板中的*程序和功能***卸载 Lifecam**，调用

 *```
capture.set(CV_CAP_PROP_FRAME_WIDTH, 1280)
capture.set(CV_CAP_PROP_FRAME_HEIGHT, 720) 
```

会正常工作。*

# arduino - Ardiuno：连接到按钮的伺服

> ID：14573062
> 
> 赞同：-1
> 
> 时间：2013-01-28T23:18:31.470
> 
> 标签：arduino

我是 Arduino 的新手，并试图创建一个简单的应用程序，因此当按下按钮（不连续）时伺服会前进 50 度，而松开按钮时会返回 50 度。出于某种原因，我的伺服系统一直在运行。我应该怎么做才能调试这个。

```
#include <Servo.h>

Servo myservo; // creating myservo object
int buttonPin = 2;
int servoPin = 3;
int buttonState = 0; // set buttonState 

void setup()
{
myservo.attach(servoPin); 
pinMode(buttonPin, INPUT); 
}

void loop()
{ buttonState = digitalRead(buttonPin); // read and save to the variable "buttonState" the actual state of button
if (buttonState == HIGH)
myservo.write(50); else
myservo.write(0);

} 
```

![在此处输入图像描述](../Images/f2c72e0dc900b089f6c6f2cdce790b29.png)![在此处输入图像描述](../Images/b6a3b2bf60b205cc9178af2e197b0552.png)![在此处输入图像描述](../Images/9ffdaaf6e4750db614483e1c444204ed.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-20T19:37:43.867

```
myServo.writeMicroseconds(1500); 
```

如果它没有损坏并且它是一个连续的数字伺服，这将使它停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:51:19.850

您应该使用[Bounce 库](http://www.arduino.cc/playground/Code/Bounce)来捕捉您正在寻找的边缘。您编写的脚本不断将 PWM 更新为 50 或 0。它永远没有机会真正做到这一点。因此，您只想在更改时更新它；要么按下要么释放。

我没有测试以下。它确实可以编译，并且是来自示例和您上面的简单破解。

```
#include <Servo.h>
#include <Bounce.h>

#define BUTTON 2
#define servoPin 3
#define LED 13

Servo myservo;  // create servo object to control a servo
Bounce bouncer = Bounce( BUTTON, 5 );

void setup() {
  pinMode(BUTTON,INPUT);
  pinMode(LED,OUTPUT);
  digitalWrite(LED, HIGH);
  myservo.attach(servoPin);
}

void loop() {

  if ( bouncer.update() ) {
    if ( bouncer.fallingEdge()) {
      myservo.write(50);
      digitalWrite(LED, LOW);
    } else if ( bouncer.risingEdge()) {
      myservo.write(0);
      digitalWrite(LED, HIGH);
    }
  }
  // foo bar...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T04:57:21.053

我会大胆猜测你有一个连续旋转伺服。这些伺服器的电位器的位置反馈被移除/断开，因此当您对伺服器施加任何旋转时，它会持续旋转，认为它尚未处于所需位置。这些舵机具有三个控制位置：关闭（可能是 90 度）顺时针（大于 90 度）和逆时针（小于 90 度）。有些确实允许您控制速度（我认为您引用的 VEX 可能是一个 - 查看规格表）。

我的无运动值可能是错误的（可能不是 90）并且我的逆时针/顺时针方向反转，但我几乎可以肯定这是你的问题。基本上你的电机不是你想象的那样:)

# php - 尽管获得许可，但无法访问 facebook sdk 中的邮件值

> ID：14573064
> 
> 赞同：0
> 
> 时间：2013-01-28T23:18:41.540
> 
> 标签：php, facebook-graph-api

嗨，我的 Facebook API 有问题，虽然我要求获得获取电子邮件的权限，但我无法获取邮件值，我做错了什么？这是我的代码：

```
 $facebook = new Facebook(array(
  'appId'  => 'xxxxxxxx',
  'secret' => 'xxxxxxxxxx',
  'cookie' => false
));

// See if there is a user from a cookie
$fbuser = $facebook->getUser();

if ($fbuser) {
  try {
    // Proceed knowing you have a logged in user who's authenticated.
    $FBUSER = $facebook->api('/me');
    $FBUSER1 = $facebook->api('/me');
    print_r($FBUSER1);
  } catch (FacebookApiException $e) {
    print_r($e);
    $USER=false;
  }
}
    $loginUrl = $facebook->getLoginUrl(array("scope"=>"email, publish_actions")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:30:05.747

几天前，我正在编写我的应用程序的类似登录/授权位，在我正确订购流程步骤之前，我得到了类似的结果。

从您的代码段来看，您似乎在用户实际授予您的应用程序扩展权限之前打印了 $fbuser 数组。假设您正在使用自己的帐户登录 facebook 进行一些测试：您可能已经使用基本权限授权了一次应用程序，现在它从您的帐户返回这些基本数据（没有“电子邮件”，因为它属于扩展烫发）。

更多代码可能有助于更好地理解，但我仍然会仔细检查： 1\. 显示来自 FB getLoginURL() 方法的页面/弹出窗口，并且用户接受登录（如果没有）和授权扩展权限（如果需要） . 2\. 您网站上的 return_uri 代码已准备好捕获来自上一步的任何数据（例如，打印用户详细信息）。

请注意，我从您的代码中看到 return_uri 未定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:32:37.367

如果您在没有 access_token 的情况下发送请求，您将获得没有电子邮件和一些不同字段的短字段集。

# jquery - HTML5 文件上传表单数据与 jquery ajax

> ID：14573068
> 
> 赞同：2
> 
> 时间：2013-01-28T23:18:58.480
> 
> 标签：jquery, ajax, html, file-upload

我想使用 html5 formData 和 jquery ajax 来执行 ajax 文件上传（单个文件），但这不起作用。下面是我的js代码

```
//I tried this but return Cannot read property '0' of undefined
  var file = $folderID.find('.add-file').files[0];  

//I also tried this no error return, no file uploaded, no data inserted to db.
var file = $folderID.find('.add-file')[0].files[0];
  var formData = new FormData();
  formData.append("file", file);

var tag = $folderID.find('.hidden-tag').val();

$.ajax({
    type: 'POST',
    contentType:false,
    processData:false,
    url: baseUrl + 'folder/post',
    data: {'file':formData ,'tag':tag},
    error: function (request, status, error) {
        alert(request.responseText);
      }
  }); 
```

注意： php 文件在不使用 ajax 的情况下可以完美运行。

更新标头返回 302 not found 并请求有效负载`[object] [object]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:17:36.493

已修复，我将所有 jquery .val() 移至 formdata。

例子

```
formData.append("file", file);
formData.append("tag", tag); 
```

# c++ - FFTW - 计算真正的 2D FFT，特殊要求

> ID：14573070
> 
> 赞同：5
> 
> 时间：2013-01-28T23:19:02.647
> 
> 标签：c++, fft, fftw

我正在使用 FFTW3 在 C++ 中计算 2D 真实 FFT。我已经阅读了手册，但有一些问题。来自手册：[http ://www.fftw.org/fftw3_doc/One_002dDimensional-DFTs-of-Real-Data.html#One_002dDimensional-DFTs-of-Real-Data](http://www.fftw.org/fftw3_doc/One_002dDimensional-DFTs-of-Real-Data.html#One_002dDimensional-DFTs-of-Real-Data)

> 为了换取这些速度和空间优势，用户牺牲了 FFTW 复杂变换的一些简单性。首先，输入和输出数组的大小和类型不同：输入是n个实数，而输出是n/2+1个复数（非冗余输出）；这也需要对输入数组进行轻微的“填充”以进行就地转换。其次，默认情况下，逆变换（复数到实数）具有覆盖其输入数组的副作用。这些不便都不应该给用户带来严重的问题，但重要的是要意识到它们。

1.  我知道我需要将输入的 2D 矩阵转换为行顺序的 1D 向量。但是输出是什么样子的？n/2 + 1 个数字是什么意思？换句话说，我如何重新排序输出以获得二维矩阵？

2.  我具体要做什么来创建这个“填充”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:31:26.517

1.  如果您的输入已经在一个普通的 C++ 2D 数组中，那么您需要做的就是对它进行类型转换：

    ```
    double twoDarray[10][10];
    double *oneDarrayPointer = (double *)twoDarray; 
    ```

    如果你的输入是 100（就像上面的例子一样），你的输出数组将是 51 个复数。这些数字的格式应由您的库描述，但可能是 102 `doubles`- 51 个条目乘以 2（实部/虚部）的数组。

    编辑：确认 -`fftw_complex`定义为：

    ```
    typedef double fftw_complex[2]; 
    ```

    所以它们只是`doubles`表示复数实部和虚部的连续对。

2.  如果您不想就地执行此操作，则无需填充任何内容 - 只需分配适当大小的输出数组。如果您*确实*需要就地执行此操作，则输入缓冲区必须有空间容纳 2 个额外的双打与输入大小。假设上面的声明，你会想要这样的：

    ```
    double *inPlaceFFTPointer = malloc(sizeof twoDarray + 2*sizeof(double));
    memcpy(inPlaceFFTPointer, oneDarrayPointer, sizeof twoDarray); 
    ```

    我不确定您是否需要确保`0.0`在最后两个条目中包含，但这很容易添加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-17T07:46:41.227

你可以看看 FFTW3 中的真实到真实的转换，这正是你所要求的。这些不需要填充，并考虑到波数 0 和代表奈奎斯特频率的波数都只有一个实分量。看看这里：

[FFTW3 实到实转换](http://www.fftw.org/doc/Real_002dto_002dReal-Transforms.html)

对于内存中的布局：

[FFTW3 实到实转换种类](http://www.fftw.org/doc/Real_002dto_002dReal-Transform-Kinds.html#Real_002dto_002dReal-Transform-Kinds)

# html - 与单个 HTML 属性一起使用的多个 EL 值和字符串

> ID：14573075
> 
> 赞同：1
> 
> 时间：2013-01-28T23:19:16.453
> 
> 标签：html, jsf, el

在我的 JSF 2.0 应用程序的 .xhtml 页面中，我试图找到一种方法，让多个 EL 值和字符串与单个 HTML 属性一起使用。以下错误语法将为您提供思路：

```
<h:outputText value=" 'Welcome' + #{myBean.loggedInUser} + ' '  "/> 
```

所以我想知道正确的做法是什么。我不需要解决方法（因为 h:outputText 只是一个示例）。

也让我知道您的建议是否适用于 JSP/JSF1.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:42:10.890

您不需要任何特殊的运算符。您可以在文本中内联 EL。

```
<h:outputText value="Welcome #{myBean.loggedInUser}" /> 
```

或者

```
Welcome <h:outputText value="#{myBean.loggedInUser}" /> 
```

甚至在模板文本中

```
Welcome #{myBean.loggedInUser} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-28T23:27:25.207

`<h:outputFormat>`组件？

[http://www.jsftoolbox.com/documentation/help/12-TagReference/html/h_outputFormat.html](http://www.jsftoolbox.com/documentation/help/12-TagReference/html/h_outputFormat.html)

我相信这是 JSF 1.2 或 2

# php - 在非对象上调用成员函数 query()

> ID：14573076
> 
> 赞同：3
> 
> 时间：2013-01-28T23:19:28.563
> 
> 标签：php, mysqli

我收到此错误：

> 在非对象上调用成员函数 query()。

此外，当我使用其他 MySQLi 函数时，它会给我同样的错误，但对于该函数。

我的`connection.php`：

```
<?php
$mysqli = new mysqli("localhost","user","pass","db");
if(mysqli_connect_errno()){
  trigger_error('Connection failed: '.$mysqli->error);
}

?> 
```

我的功能：

```
function form_year($find, $value, $from, $vehicletype){
    //Query setup
    $autoquery = "SELECT    
                        Year, 
                        Vehicle, 
                        Brand, 
                        Model, 
                        Type, 
                    FROM 
                        vehicle_tbl
                    WHERE
                        Vehicle = '".$vehicletype."'
                    GROUP BY
                        Year";
    $autoresult = $mysqli->query($autoquery);

    $search = array("%value%", "%options%");
    $rows = file_get_contents("tpl/options.html");
    while($row = $autoresult->fetch_assoc()){
        $replace = array($row[$value], $row[$value]);
        $tr .= str_replace($search, $replace, $rows);
    }
    return str_replace($find, $tr, $from);
} 
```

函数和连接包含在调用函数的地方

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T23:21:43.617

快速/肮脏的修复：

```
 function form_year($find, $value, $from, $vehicletype){
    //Query setup
    global $mysqli;
    $autoquery = "SELECT  [...] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:23:57.303

您可能想尝试删除后面的逗号，`Type`因为这可能是 MySQL 字符串的语法错误。也尝试回应`$mysqli->error`并查看它所说的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T23:27:16.040

您的`$mysqli`对象在全局范围内，而不是在函数范围内。您应该将`mysqli`对象作为参数传递给函数，以便您可以访问它。所以是这样的：

```
function form_year($find, $value, $from, $vehicletype, $db){
    ...
    $autoresult = $db->query($autoquery);
    ...
} 
```

注意我还将在函数中添加一些验证以确保传递了正确的 mysqli 对象，但未显示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-28T23:27:14.160

您必须确保您的 $mysqli 在范围内可用（在您的函数中不是这种情况）。一些可用的解决方案：全局、传入参数、单例。Personnaly 我通常为我的数据库连接做单例，像这样：

```
class DB {
private static $_instance;

public static function get() {
    if(!isset(self::$_instance)) {
        self::$_instance = new mysqli("localhost","user","pass","db");
        if(mysqli_connect_errno()) {
            trigger_error('Connection failed: '.self::$_instance->error);
        }
    }
    return self::$_instance;
}
}

//Calling

$autoresult = DB::get()->query($autoquery); 
```

# c++ - 片段着色器莫名其妙的行为

> ID：14573079
> 
> 赞同：0
> 
> 时间：2013-01-28T23:19:39.447
> 
> 标签：c++, opengl, glsl, glew, fragment-shader

我编写了一个 C++ 程序，我在其中画了一个茶壶并应用了照明。它本身很简单，但我也使用着色器。简单我是 GLSL 新手，我只是尝试了一个简单的片段着色器，但屏幕输出莫名其妙。

在这个文件中，我在 init 方法中初始化 glew，在这里我还编译了顶点和片段着色器。它们位于“vertex_shader”和“fragment_shader”文件中。

你可能不知道什么是光和物质。它们只是一些包含有关灯光的所有信息的结构。我已经测试了这些结构，所以我确信工作符合预期。当我声明 material=BlackPlastic 时，我只是将其设置为使用 define 指令定义的默认值。如果您认为问题存在，我也可以发布此代码。

```
#include <GL/glew.h>
#include <GL/glut.h>
#include <iostream>
#include <fstream>
#include <vector>
#include "utility.hpp"

#define MAX_DIM 1000

GLfloat width=600, height=800;
GLuint vertex_shader, fragment_shader;
GLuint program;
const char* vertex_shader_filename= "vertex_shader";
const char* fragment_shader_filename= "fragment_shader";
Light light;
Material material;

void init()
{    
    // Inizializzazione di GLEW
    glewInit();
    if(GLEW_ARB_vertex_shader && GLEW_ARB_fragment_shader)
    {
    cout << "Supporto GLSL" << endl;
    }

    // Lettura e compilazione del vertex shader
    GLchar* buffer= new GLchar[MAX_DIM];
    ifstream stream;
    streamsize count;
    stream.open(vertex_shader_filename);
    stream.read(buffer,MAX_DIM);
    count= stream.gcount();
    stream.close();
    vertex_shader= glCreateShader(GL_VERTEX_SHADER);
    glShaderSource(vertex_shader, 1, (const GLchar**)&buffer, &count);
    glCompileShader(vertex_shader);

    // Lettura, inizializzazione ed esecuzione del fragment shader
    stream.open(fragment_shader_filename);
    stream.read(buffer,MAX_DIM);
    count= stream.gcount();
    stream.close();
    fragment_shader= glCreateShader(GL_FRAGMENT_SHADER);
    glShaderSource(fragment_shader, 1, (const GLchar**)&buffer, &count);
    glCompileShader(fragment_shader);
    delete[] buffer;

    // Creazione del programma

    program= glCreateProgram();
    glAttachShader(program, vertex_shader);
    glAttachShader(program, fragment_shader);
    glLinkProgram(program);
    glUseProgram(program);

    // Inizializzazione materiale e luce
    material= BlackPlastic;
    light= {vector<GLfloat>{-2,2,2,1} ,vector<GLfloat>{1,1,1,1},vector<GLfloat>{1,1,1,1},vector<GLfloat>{1,1,1,1} };
}

void display()
{
    glEnable(GL_DEPTH_TEST);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluPerspective(45,width/height,1,1000);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    gluLookAt(0,0,-100,0,0,0,0,1,0);

    // Illuminazione
    glShadeModel(GL_SMOOTH);
    material.apply(); // This just causes glMaterialfv to be called for the ambient, diffuse, specular and shininess values.
    light.apply(); // This just causes glLightfv to be called for the ambient, diffuse and specular values
    glEnable(GL_LIGHT0);
    glEnable(GL_LIGHTING);

    // Rendering
    glClearColor(0.8,0.8,0.8,1.0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glutSolidTeapot(10);
    glutSwapBuffers();
}

void reshape(int w, int h)
{
    width=w;
    height=h;
    glutPostRedisplay();
}

int main(int argc, char** argv)
{
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGB | GLUT_DOUBLE | GLUT_DEPTH);
    glutInitWindowPosition(100,100);
    glutInitWindowSize(500,500);
    glutCreateWindow("test");
    glutDisplayFunc(display);
    glutReshapeFunc(reshape);
    init();
    glutMainLoop();
    return 0;
} 
```

我不认为顶点着色器会导致任何问题，它只是正确地分配颜色并计算位置。片段着色器也显然是正确的，这是唯一执行的指令：

```
gl_FragColor = gl_Color; 
```

如果我这样做，我只会看到一个白色的茶壶。相反，如果我将此值更改为任何颜色：

```
gl_FragColor = vec4{0,0,1,1}; 
```

我得到了正确颜色的茶壶：黑色塑料。而且我不知道为什么，我这里没有应用光照，我应该计算一下。

我准确地说我执行了相同的程序，但没有应用着色器，我让茶壶有正确的颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:44:51.080

首先，您将固定功能管道与“较新的东西”混合在一起。这是一个非常糟糕的做法，因为它可能会引起很多问题，因为您并不真正知道后台发生了什么。

如果你想用漫反射着色器获得真实的光照，你必须自己计算漫反射颜色。很久以前我上次使用 ffp 所以我搜索了一些使用它的着色器：

**顶点着色器**

```
varying vec3 normal;
varying vec3 v;
varying vec3 lightvec;
void main(void)
{
    normal      = normalize(gl_NormalMatrix * gl_Normal);
    v           = vec3(gl_ModelViewMatrix * gl_Vertex);
    lightvec    = normalize(gl_LightSource[0].position.xyz - v);
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
} 
```

**片段着色器**

```
varying vec3 normal;
varying vec3 v;
varying vec3 lightvec;

void main(void)
{
   vec3 Eye          = normalize(-v);
   vec3 Reflected    = normalize( reflect( -lightvec, normal )); 
   vec4 IAmbient     = gl_LightSource[0].ambient * gl_FrontMaterial.ambient;
   vec4 IDiffuse     = gl_LightSource[0].diffuse * gl_FrontMaterial.diffuse * max(dot(normal, lightvec), 0.0);
   vec4 ISpecular    = gl_LightSource[0].specular * gl_FrontMaterial.specular * pow(max(dot(Reflected, Eye), 0.0), gl_FrontMaterial.shininess);
   gl_FragColor      = gl_FrontLightModelProduct.sceneColor + IAmbient + IDiffuse + ISpecular;
} 
```

# python - 我可以腌制一个没有任何转储的字符串吗？

> ID：14573082
> 
> 赞同：1
> 
> 时间：2013-01-28T23:19:54.307
> 
> 标签：python, pickle

假设我有一个字符串“[A,B,C]”，我想将它转换成一个列表 [A,B,C]，我用谷歌搜索了一下，我知道我应该使用 pickle，但似乎在我`pickle.loads`之前似乎有 `pickle.dumps`对象，是真的吗？如果是的话，我怎么能绕过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:27:33.177

`pickle.dumps`是将 Python 对象序列化为 Pickle 字符串，`pickle.loads`并将序列化的 Pickle 字符串转换为 Python 对象的函数。您基本上是在询问如何反序列化未序列化的对象。答案是你不能。

但是，bikeshredder 是正确的——您的字符串已经是 JSON 的序列化格式，因此您可以使用`json.loads`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:25:34.540

字符串 "[A,B,C]" 既不是 pickle 格式，也不是我所知的任何其他序列化格式。它也不是 Python 代码。

如果您只想反序列化一些数据（例如从文件中读取），我建议使用[JSON](http://json.org/)。它易于编写，解析速度快，是一个完善的标准。

```
>>> import json
>>> data_json = '["A", "B", "C"]'
>>> data = json.loads(data_json)
>>> data
[u'A', u'B', u'C']
>>> data_json = json.dumps(data)
>>> data_json
'["A", "B", "C"]' 
```

# c# - 拍摄快照 HtmlCapture.Net 时出现“程序无法显示网页”错误

> ID：14573084
> 
> 赞同：-1
> 
> 时间：2013-01-28T23:20:05.127
> 
> 标签：c#, asp.net, visual-studio-2008, windows-server-2008, webclient

我开发了一个`ASP.NET`Web 应用程序，`Visual Studio 2008`其中使用`HtmlCapture.Net`(www.polestarsoft.com/products/htmlcapture-net/) 拍摄某些页面的快照。

例如，应用程序必须拍摄此页面的快照： [http ://www.yillikfabrikasi.com/KullaniciYillikSayfasiVersion2ResimlerArkaPlan.aspx?username=bolatug@gmail.com&yillikId=ab05ab4c-138b-4332-b4ca-78484bae5b3e&refresher=31b8ff91-00a0-4122 -bea8-87efd879ad83](http://www.yillikfabrikasi.com/KullaniciYillikSayfasiVersion2ResimlerArkaPlan.aspx?username=bolatug@gmail.com&yillikId=ab05ab4c-138b-4332-b4ca-78484bae5b3e&refresher=31b8ff91-00a0-4122-bea8-87efd879ad83)

在我将应用程序从移动`Windows Server 2003`到`Windows Server 2008 (64 bit)`. 现在程序拍摄的所有图像都包含错误消息“此程序无法显示网页”而不是实际页面。您可以在上面的链接中看到它应该如何。[这是应用程序拍摄的照片](http://www.yillikfabrikasi.com/errortr.jpg)

我尝试将身份设置为本地系统帐户和具有相同身份的经典`app pool`帐户。两种配置都无法拍摄快照。`DefaultAppPool``app Pool`

我已经记录了`URL`用于拍摄快照的信息，我可以在浏览器中看到正确的页面并使用`HtmlCapture.Net`应用程序拍摄快照。所以我确信这`URL`是正确的。

这个问题的原因可能是什么？我认为某些配置或安全问题会阻止`HtmlCapture.Net`dll 打开 URL。但我不知道如何解决它。因此，任何意见都值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:52:56.007

该组件似乎通过 ActiveX 或类似的方式使用已安装的网络浏览器 (IE)。

Windows Server 2008（与 Windows Server 2003 相比）在多个级别上增强了安全性……包括：

*   [IE增强安全配置](http://support.microsoft.com/kb/815141/en-us)
*   IIS 的不同安全模型
*   Windows 服务的不同安全模型（IIS 恰好是）
*   等等

以上任何一种情况都可能导致您看到的行为...恕我直言，最好就系统配置与组件供应商联系...

另一种方法是使用不受上述方面影响的组件 - 即不使用 IE 或 ActiveX 来实现该功能......那里有一些组件（主要是商业组件）......如果这是让我知道-我可以发布一些链接...

# c# - 使用 DateTime 属性附加和更新

> ID：14573085
> 
> 赞同：1
> 
> 时间：2013-01-28T23:20:07.753
> 
> 标签：c#, .net, datetime, entity-framework-5, dbcontext

我正在使用带有 DbContext 的实体框架 5。

在我的场景中，我正在尝试更新现有实体并将更改持久保存到数据库中。在其他属性中，实体有一个“LastUpdated”属性，它是一个 DateTime。

我的实体是 POCO 实体，我的上下文继承自 DbContext。

这是我的代码：

```
public void Update(Location location)
{
    using (var context = new EfContext())
    {
        context.Locations.Attach(location);
        context.Entry(location).State = EntityState.Modified;
        context.SaveChanges();
    }
} 
```

我的应用程序的要求要求我将修改后的实体附加到新上下文，而不是先从同一上下文中检索实体。

这实际上适用于实体上的所有字段，除了 LastUpdated 字段。这是一个日期时间，不保存。

我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:23:18.403

尝试在 Update 方法中将位置 LastUpdated 属性值作为参数传递

```
public void Update(Location location, DateTime locationLastUpdated)
{
    using (var context = new EfContext())
    {
        location.LastUpdated = locationLastUpdated;
        context.Locations.Attach(location);
        context.Entry(location).State = EntityState.Modified;
        context.SaveChanges();
    }
} 
```

# ruby-on-rails - Rspec/Guard/FactoryGirl 返回错误的“未定义方法”错误

> ID：14573088
> 
> 赞同：3
> 
> 时间：2013-01-28T23:20:34.897
> 
> 标签：ruby-on-rails, rspec, factory-bot, guard, spork

首先，我有一个有效的工厂/模型，并且这个特定的测试通过控制台运行良好。

## 模型

```
validate :some_condition

def some_condition
  errors.add(:attribute, "cannot be less than 5") if self.attribute < 5
end 
```

## 测试

```
it "should not allow values above 5" do
  model = FactoryGirl.create(:model) # creates valid model
  model.attribute = 10
  model.valid?.should be_false
end 
```

### 在控制台中：

```
model = FactoryGirl.create(:model)
model.attribute = 10
model.valid? # => false 
```

### 在 rspec

```
undefined method `<' for nil:NilClass 
```

我无法理解为什么会这样。这显然与`self.attribute`，但为什么它会在控制台中工作，而不是在测试中？`attribute`单独也返回相同的错误，我已经检查过 - self 被定义为模型实例。无论如何，这并不能解释这种不一致。它在控制台中工作，具有完全相同的模型和属性。

注意：我已经重新启动了所有环境，这是基于重新加载。

### 更新

无奈之下，我`attribute`在这个条件之前的几个上下文中输出了，然后`exit`。这带来了更奇怪的结果。解决这个问题：

```
def some_condition
  puts self.attribute # => returns blank in test, attribute value otherwise
  puts "#{self.attribute}" # => returns attribute value in test!!!
  exit

  errors.add(:attribute, "cannot be less than 5") if self.attribute < 5
end 
```

以上让我无比紧张。我现在需要测试来测试我的测试吗？真的希望在 ruby​​ 或上述工具方面更有经验的人对这个烂摊子有一些合乎逻辑的解释，因为我完全迷路了。

它导致了这种可憎：

```
errors.add(:attribute, "cannot be less than 5") if self.attribute < 5
# => IN TESTS self.attribute returns nil

errors.add(:attribute, "cannot be less than 5") if "#{self.attribute}".to_i < 5
# => IN TESTS self.attribute returns value! This works!? 
```

你甚至转向哪里？是 ruby​​、rails、factory girl、rspec 吗？

### 使固定

在一个问题的大量破坏之后，事实证明我`rake db:test:prepare`在一次小的迁移之后忘记了。我仍然对它如何导致这样的问题感到困惑。学过的知识。跨环境运行迁移，并找到更好的调试器！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:37:49.207

RSpec 语法从版本 1 到版本 2 发生了一些变化，这可能会使事情变得混乱。

你能告诉我如果你完全像这样写你的测试会发生什么吗？

```
it "should not allow values above 5" do
  model = build(:model, :attribute => 10)
  model.should_not be_valid
  model.should have(1).error_on(:attribute)
end 
```

我使用`build`而不是`create`这样的原因是您可以在不访问数据库的情况下测试您的验证。

# youtube - Youtube API 是否会返回观看过我视频的用户列表？

> ID：14573090
> 
> 赞同：2
> 
> 时间：2013-01-28T23:20:57.813
> 
> 标签：youtube, youtube-api, youtube-channels

我想创建一个[Youtube 应用程序](https://developers.google.com/youtube/registering_an_application)，在用户观看了一定数量的我的 Youtube 频道的视频后奖励他们 - 或者根据观看我的频道所花费的时间奖励“经验点数”。

***我可以查询 Youtube API 以查看经过身份验证的用户是否观看了与该应用相关的特定视频？***

似乎我可以查询“喜欢”和“不喜欢” - 但好奇是否有人跟踪“观看时间”或只是“观看”一般。

我的犹豫是我不想访问用户的完整历史记录——我想要一种非常不显眼的方法来将经过身份验证的用户连接到特定的视频内容。

我没有看到用于查询或通知是否已看到关联的 Youtube 视频的 API 端点。您可以提供的任何帮助都会非常有帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:38:06.267

考虑到用户隐私，我认为您无法访问此信息。如果您通过 API 进行搜索，您会发现 Youtube 确实提供了见解，例如观看次数甚至[人口统计信息](https://developers.google.com/youtube/2.0/developers_guide_protocol_insight)。

将视频嵌入到应用中，然后跟踪哪些用户在应用中观看该特定视频可能是一种解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T12:42:17.703

在您的应用程序中捕获 onStateChange 事件以记录用户观看了视频。它仅适用于他们从您的应用程序内部查看的视频。

# python - 您可以将对象实例直接分配给 Python 中的列表吗？

> ID：14573092
> 
> 赞同：0
> 
> 时间：2013-01-28T23:21:00.620
> 
> 标签：python, list, class, instance

我定义了一个名为 Space 的类，用于表示 9x9 板上的空间。我想在程序开始时生成 81 个实例，方法是将它们分配给我打算用作二维数组的列表元素。

这是课程：

```
class Space:
    def __init__(self, x_coord, y_coord):
        self.row = x_coord
        self.column = y_coord 
```

这是我将实例分配给列表（也称为空间）的尝试之一：

```
for i in xrange(1,9):
   for j in xrange(1,9):
        space[i][j] = Space(i,j) 
```

我的目标是能够使用列表索引引用实例，就好像它们是坐标一样，即`space[1][2].value = 3`

我正在尝试做的事情可能吗？有没有更好的方法来批量生成实例？谢谢！

编辑：（我在下面的回复以更易读的形式）

脚本运行，但是当我尝试在命令提示符中访问它时，我的列表似乎没有定义

```
>>> space[1][2].value = 3
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
NameError: name 'space' is not defined
>>> space[1][1]
Traceback (most recent call last):
  File "<interactive input>", line 1, in <module>
NameError: name 'space' is not defined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:04:45.437

听起来您永远不会创建`space`要用来保存`Space`对象的列表。这是一种方法，从一个空列表开始，然后将值附加到列表中：

```
space = [] # initially empty list
for i in range(9):
    column = [] # create an empty list to hold a column of values
    for j in range(9):
        column.append(Space(i, j)) # add the object to the column
    space.append(column) # add the column to the outer list 
```

一个更干净、更“Pythonic”的解决方案是使用嵌套[列表](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)推导，如 isedev 的回答：

```
space = [[Space(i, j) for j in range(9)] for i in range(9)] 
```

最后一点，在代码中对不同的事物使用相同的词，只是大小写不同可能是个坏主意。可以使用一个名为的变量`foo`来保存单个`Foo`实例，但更好的名称将表明该实例的用途，例如`foo_for_frobbing`. 在您的情况下，`board`可能是比`space`您的`Space`实例列表更好的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:31:02.577

您必须使用基于 0 的索引，但这将实现您想要的：

```
space = [[Space(i,j) for j in range(9)] for i in range(9)] 
```

# java - 填充肥皂信封

> ID：14573093
> 
> 赞同：0
> 
> 时间：2013-01-28T23:21:03.010
> 
> 标签：java, soap

我有一个肥皂体，我需要根据这个 wsdl 定义填充正确的元素。

```
<wsdl:types>
<s:schema elementFormDefault="qualified" targetNamespace="http://DEA.Web.Service.MasterCalendar.API/">
<s:element name="GetEvents">
 <s:complexType>
  <s:sequence>
    <s:element minOccurs="0" maxOccurs="1" name="userName" type="s:string"/>
    <s:element minOccurs="0" maxOccurs="1" name="password" type="s:string"/>
    <s:element minOccurs="1" maxOccurs="1" name="startDate" type="s:dateTime"/>
    <s:element minOccurs="1" maxOccurs="1" name="endDate" type="s:dateTime"/>
    <s:element minOccurs="0" maxOccurs="1" name="eventName" type="s:string"/>
    <s:element minOccurs="0" maxOccurs="1" name="location" type="s:string"/>
    <s:element minOccurs="0" maxOccurs="1" name="calendars" type="tns:ArrayOfInt"/>
    <s:element minOccurs="0" maxOccurs="1" name="eventTypes" type="tns:ArrayOfInt"/>
    <s:element minOccurs="0" maxOccurs="1" name="udqAnswer" type="s:string"/>
  </s:sequence>
 </s:complexType>
</s:element>
<s:complexType name="ArrayOfInt">
  <s:sequence>
    <s:element minOccurs="0" maxOccurs="unbounded" name="int" type="s:int"/>
  </s:sequence>
</s:complexType>
</s:schema>
</wsdl:types> 
```

填充元素的代码是：

```
SOAPElement username  = bodyElement.addChildElement(sf.createName("userName","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
username.addTextNode("username");
SOAPElement password  = bodyElement.addChildElement(sf.createName("password","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
password.addTextNode("password");

SOAPElement startdate  = bodyElement.addChildElement(sf.createName("StartDate","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
SOAPElement endate  = bodyElement.addChildElement(sf.createName("EndDate","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
startdate.addTextNode("2013-02-01");
endate.addTextNode("2013-02-10");
SOAPElement eventName  = bodyElement.addChildElement(sf.createName("EventName","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
eventName.addTextNode("rock");
SOAPElement location  = bodyElement.addChildElement(sf.createName("location","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
location.addTextNode("The Well");

SOAPElement calendars  = bodyElement.addChildElement(sf.createName("calendars","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
SOAPElement calendarId  = calendars.addChildElement(sf.createName("int","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
calendarId.addTextNode("47");

SOAPElement eventTypes  = bodyElement.addChildElement(sf.createName("eventTypes","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
SOAPElement eventId  = eventTypes.addChildElement(sf.createName("int","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
eventId.addTextNode("37");
//SOAPElement eventId2  = eventTypes.addChildElement(sf.createName("int","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));

SOAPElement udqAnswer  = bodyElement.addChildElement(sf.createName("udqAnswer","SOAP-ENV","http://DEA.Web.Service.MasterCalendar.API/"));
udqAnswer.addTextNode(""); 
```

发送前的请求如下所示：

```
<env:Envelope xmlns:env="http://www.w3.org/2003/05/soap-envelope">
<env:Header/><env:Body>
<SOAP-ENV:GetEvents xmlns:SOAP-ENV="http://DEA.Web.Service.MasterCalendar.API/">
  <SOAP-ENV:userName>username</SOAP-ENV:userName>
  <SOAP-ENV:password>password</SOAP-ENV:password>
  <SOAP-ENV:StartDate>2013-02-01</SOAP-ENV:StartDate>
  <SOAP-ENV:EndDate>2013-02-10</SOAP-ENV:EndDate>
  <SOAP-ENV:EventName>rock</SOAP-ENV:EventName>
  <SOAP-ENV:location>The Well</SOAP-ENV:location>
  <SOAP-ENV:calendars>
     <SOAP-ENV:int>47</SOAP-ENV:int>
  </SOAP-ENV:calendars>
  <SOAP-ENV:eventTypes>
    <SOAP-ENV:int>37</SOAP-ENV:int>
  </SOAP-ENV:eventTypes>
  <SOAP-ENV:udqAnswer/>
  </SOAP-ENV:GetEvents>
 </env:Body></env:Envelope> 
```

不幸的是，服务器的响应很模糊，只是说尝试对数据库执行命令时发生错误。我可以查询对服务器的其他调用，而不是这个，我认为这与 udqAnswer 未正确关闭有关？

底线是我缺乏使用肥皂的经验来发现元素的填充与 wsdl 定义不同的地方。哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:27:34.367

尝试使用 SoapUI 只发送几条 xml 消息，看看是否可以生成消息，您会得到正确的响应。

[http://www.soapui.org](http://www.soapui.org)

第二次尝试删除 udqAnswer。我在发送空标签时遇到了 Web 服务问题，因为它被翻译为 null 并且存在相关问题：|

# java - 签名小程序 - 文件对话框无法在本地客户端以外的任何客户端上打开

> ID：14573095
> 
> 赞同：1
> 
> 时间：2013-01-28T23:21:18.467
> 
> 标签：java, javascript, security, applet, signed

> **可能重复：**
> [从 javascript 调用的小程序方法](https://stackoverflow.com/questions/12361369/applet-method-calling-from-javascript)

这对我来说是一个持续存在的问题。我已经在允许本地文件访问的 Tomcat 部署中本地测试了一个签名的小程序。我可以打开文件对话框并在将应用程序和客户端部署到应用程序的同一框上本地创建文件。这可能是我的问题，但我认为，到目前为止，在任何其他客户端上它都无法打开对话框，即使这些客户端已完全接受证书并授予所有权利，并且禁用了验证（只是为了让它工作得更紧之后）。

为什么连接的客户端无法打开本地文件对话框？是否需要该本地 PC 上的安全策略？（运行 Java6）。我认为使用签名的小程序本地策略文件是不必要的。这甚至可以通过 TC 部署实现吗？我非常需要这个回答和教育。谢谢你。

# profiling - 在分析我的 fortran 程序时，Acxtrnal.dll 是占用大部分 CPU 时间的部分！那个dll是什么？

> ID：14573101
> 
> 赞同：1
> 
> 时间：2013-01-28T23:22:04.160
> 
> 标签：profiling, fortran

嗨，我正在使用 VTUNE（英特尔视觉工作室扩展）分析我为研究编写的 2D 数值模型，以加快速度。我已经以这种方式加速了我的一维模型（即识别我的模型的“热点”）。不过这一次，在运行分析器后，我发现最耗时的部分不是我编写的 fortran 子例程（因为它发生在我的一维模型中），而是一个名为 Acxtrnal.dll 的 dll。我用谷歌搜索了这个 dll 的名称，但找不到更好的信息。有谁知道为什么这个 dll 需要这么多以及它需要什么？谢谢。

编辑：所以我能够从 Microsoft 网站添加 DLL 的下载符号，所以现在在调试时显示 CPU 时间在这里丢失了。NS_FaultTolerantHeap::APIHook_RtlFreeHeap。如果我展开它显示（大写子程序是我的）：

free<-for__free_vm
for_write_int_fmt_xmit<-for_write_int_fmt<-LIMITERSUBR<-RECMUSCL<-MAIN__<-main<-_tmainCRTStartup<-BaseThreadInitThunk<- **RtlUserThreadStart<- *RtlUserThreadStart
for* _release_lun<-for_write_int_fmt_xmit<-for_write_int_fmt<-LIMITER<SUBR<-RECMUSCL<** M -main< - *tmainCRTStartup<-BaseThreadInitThunk<-* _RtlUserThreadStart<-_RtlUserThreadStart

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:04:57.773

很好，你拿了几个堆栈样本，显示在这里。您的 RECMUSCL 正在调用 LIMITERSUBR，它正在调用`for_write_int_fmt`，它正在做很多事情。

```
free
for__free_vm
for_write_int_fmt_xmit
for_write_int_fmt
LIMITERSUBR   <------ Look at the line in LIMITERSUBR that prints integers
RECMUSCL              because it appears on both stack samples
MAIN__
main
_tmainCRTStartup
BaseThreadInitThunk
__RtlUserThreadStart
_RtlUserThreadStart  

for__release_lun
for_write_int_fmt_xmit
for_write_int_fmt
LIMITERSUBR
RECMUSCL
MAIN__
main
_tmainCRTStartup
BaseThreadInitThunk
__RtlUserThreadStart
_RtlUserThreadStart 
```

您可以查看 LIMITERSUBR 中您正在编写整数的代码行中的堆栈示例，看看您是否需要这样做。

（你看，你并不真的需要系统 dll 中的符号 :)

你拿了两个堆栈样本很好，这样你就可以看到问题两次。只看到一个问题是不够的，除非您事先知道您的速度非常严重。在这么少的样本中看到两次意味着它占了很大一部分时间，比如超过 50% 并且可能接近 100，因此值得尝试修复。（实际上它是一个 Beta 分布，其最可能的值为 2/2 = 100%。）

# python - 如何使用 Django Rest Framework 包含相关模型字段？

> ID：14573102
> 
> 赞同：178
> 
> 时间：2013-01-28T23:22:19.513
> 
> 标签：python, django, django-rest-framework

假设我们有以下模型：

```
class Classroom(models.Model):
    room_number = [...]

class Teacher(models.Model):
    name = [...]
    tenure = [...]
    classroom = models.ForeignKey(Classroom) 
```

假设不是根据 ManyRelatedPrimaryKeyField 函数得到这样的结果：

```
{
    "room_number": "42", 
    "teachers": [
        27, 
        24, 
        7
    ]
}, 
```

让它返回包含完整相关模型表示的内容，例如：

```
{
    "room_number": "42", 
    "teachers": [
        {
           'id': 27,
           'name': 'John',
           'tenure': True
        }, 
        {
           'id': 24,
           'name': 'Sally',
           'tenure': False
        }, 
    ]
}, 
```

这可能吗？如果是这样，怎么做？这是一个坏主意吗？

* * *

## 回答 #1

> 赞同：275
> 
> 时间：2013-01-29T11:27:15.303

最简单的方法是使用[深度参数](http://django-rest-framework.org/api-guide/serializers#specifying-nested-serialization)

```
class ClassroomSerializer(serializers.ModelSerializer):
    class Meta:
        model = Classroom
        depth = 1 
```

但是，这将只包括正向关系的关系，在这种情况下，这并不是您所需要的，因为教师字段是反向关系。

如果您有更复杂的要求（例如，包括反向关系、嵌套一些字段，但不嵌套其他字段，或者只嵌套特定的字段子集），您可以[嵌套序列化](http://django-rest-framework.org/api-guide/serializers#dealing-with-nested-objects)程序，例如...

```
class TeacherSerializer(serializers.ModelSerializer):
    class Meta:
        model = Teacher
        fields = ('id', 'name', 'tenure')

class ClassroomSerializer(serializers.ModelSerializer):
    teachers = TeacherSerializer(source='teacher_set')

    class Meta:
        model = Classroom 
```

请注意，我们在序列化器字段上使用 source 参数来指定要用作字段源的属性。[我们可以通过使用模型上的related_name](https://docs.djangoproject.com/en/dev/topics/db/queries/#following-relationships-backward)选项`source`来确保`teachers`属性存在来删除参数，即。`Teacher``classroom = models.ForeignKey(Classroom, related_name='teachers')`

要记住的一件事是嵌套序列化程序当前不支持写入操作。对于可写表示，您应该使用常规的平面表示，例如 pk 或超链接。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2016-09-21T17:24:51.277

谢谢@TomChristie！！！你帮了我很多！我想稍微更新一下（因为我遇到了一个错误）

```
class TeacherSerializer(serializers.ModelSerializer):
    class Meta:
        model = Teacher
        fields = ('id', 'name', 'tenure')

class ClassroomSerializer(serializers.ModelSerializer):
    teachers = TeacherSerializer(source='teacher_set', many=True)

    class Meta:
        model = Classroom
        field = ("teachers",) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-07-16T12:01:14.993

这也可以通过使用名为[drf-flex-fields](https://github.com/rsinger86/drf-flex-fields)的非常方便的 dandy django 来完成。我们使用它，它非常棒。您只需安装它`pip install drf-flex-fields`，通过序列化程序传递它，添加`expandable_fields`和宾果游戏（下面的示例）。它还允许您使用点表示法指定深层嵌套关系。

```
from rest_flex_fields import FlexFieldsModelSerializer

class ClassroomSerializer(FlexFieldsModelSerializer):
    class Meta:
        model = Model
        fields = ("teacher_set",)
        expandable_fields = {"teacher_set": (TeacherSerializer, {"source": "teacher_set"})} 
```

然后你添加`?expand=teacher_set`到你的 URL 并返回一个扩展的响应。希望有一天这对某人有所帮助。干杯!

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-14T07:58:31.507

# 感谢@TomChristie 和@Paolo

> 我想澄清一下，下面的代码可以正常工作，但人们必须记住将**related_name="teacher_set"**属性添加到模型教师。在这种情况下，这是完整的代码：

## 模型.py

```
class Classroom(models.Model):
    room_number = [...]

class Teacher(models.Model):
    name = [...]
    tenure = [...]
    classroom = models.ForeignKey(Classroom, related_name='teacher_set') 
```

注意：*related_name='teacher_set'*到*教室*字段。

## 序列化程序.py

```
class TeacherSerializer(serializers.ModelSerializer):
    class Meta:
        model = Teacher
        fields = ('id', 'name', 'tenure')

class ClassroomSerializer(serializers.ModelSerializer):
    teachers = TeacherSerializer(source='teacher_set', many=True)

    class Meta:
        model = Classroom
        field = ("teachers",) 
```

# html - IE 8 上带有背景颜色的超链接（锚点）按钮不起作用

> ID：14573103
> 
> 赞同：0
> 
> 时间：2013-01-28T23:22:30.587
> 
> 标签：html, css

我试图设置超链接按钮“”的背景颜色，它在除 IE 8 之外的 Chrome、IE9、Firefox 等上运行良好。经过进一步调查，我发现 IE8 不支持类似 button:not(.t-button) 的 CSS 并且它会中断

我想知道我是否需要在不同的文件上为 IE 8 添加不同的 css，或者我可以更新语法，使其不会因 IE 8 而中断。

```
button:not(.t-button), .btn, a.btn, input[type="button"], input[type="submit"] {
    display: inline-block;
    padding: 0px 10px;
    border: none;
    margin: 6px 0 0;
    height: 24px;
    background-color: rgb(64,141,198);
    font-family: 'Arial' ,sans-serif;
    font-weight: bold;
    font-size: 1em; /* 12 */
    line-height: 2em;
    color: rgb(255,255,255);
    cursor: pointer;
    box-shadow: none;
    -webkit-appearance: none;
} 
```

这是 jsFiddle 之类的[http://jsfiddle.net/786wF/](http://jsfiddle.net/786wF/)

任何帮助将不胜感激。

问候巴韦什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:25:39.860

首先 :not 伪选择器不受支持

更多信息 ：

*   [http://kimblim.dk/css-tests/selectors/](http://kimblim.dk/css-tests/selectors/)
*   [http://caniuse.com/#search=%3Anot](http://caniuse.com/#search=%3Anot)

其次，您的 html 无效，将 div 放入锚点

用 SPAN 替换你的内部 DIV

IE 将欣赏

第三：jsfiddle 不支持 IE < 8

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:04:03.547

您的代码结构在 w3c 验证器中无效，因为您将 div 放入元素中。尝试将 div 更改为其他元素，如 span。不要使用：not 伪元素

# javascript - 创建订单“队列”列表

> ID：14573108
> 
> 赞同：0
> 
> 时间：2013-01-28T23:22:39.553
> 
> 标签：javascript, jquery

我对 Jquery 很陌生，需要一点指导来开始设置订单“队列”系统。简短的例子会有所帮助，但我正在寻找更多的总体大纲，并且知道我想要做的事情是否可能：

1）有一个“主” div，您可以在其中选择项目并输入项目的数量并选择所有修饰符（我可以使用文本和复选框来完成所有这些操作）。然后单击“添加”按钮，它将订单摘要（可能是数量和商品总价）添加到另一个“排队”到一边的 div。

2）点击“添加”后，“主” div 将清除所有框并允许我添加另一个项目。

3）有能力点击小div中的“汇总”，重新显示订单项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:47:54.230

这是您所要求的简化版本，它应该向您展示使用 jQuery 从页面获取值的基础知识：

HTML：

```
Select a Product: <select id="product">
    <option>Photoshop CS6</option>
    <option>Photoshop Elements</option>
    <option>iPhoto</option>
</select><br>
Digital Download <input id="digitalDownload" class="options" type="checkbox"><br>
Student Discount <input id="studentDiscount" class="options" type="checkbox"><br>
<br>
<button id="add">Add to Order</button><br>
<br>
<div id="summary"></div> 
```

Javascript：

```
$("#add").click(function() {
    // gather current order info
    var order = [];
    order.push($("#product").val());
    order.push("Digital Download: " + $("#digitalDownload").prop("checked"));
    order.push("Student Discount: " + $("#studentDiscount").prop("checked"));
    // put order info into summary
    $("#summary").append("<div>" + order.join(", ") + "</div>");
    // clear previous checked values
    $(".options").prop("checked", false);
}); 
```

在这里工作演示：http: [//jsfiddle.net/jfriend00/Rjmbx/](http://jsfiddle.net/jfriend00/Rjmbx/)

# bluetooth - 蓝牙不使用 HCI 进行写入扫描

> ID：14573110
> 
> 赞同：1
> 
> 时间：2013-01-28T23:22:45.107
> 
> 标签：bluetooth, embedded, stack

我正在尝试在现有的嵌入式设备上实现蓝牙。我使用的控制器是 LS Research TiWi-uB2，它使用 Ti CC2564 双模 IC。主机是 LPC2378 微控制器。该设备需要被其他设备（目前是 Android 设备和 PC）发现。该设备没有适合我需要的现成 BT 堆栈（成本、静态内存分配、内存大小），所以我正在编写自己的堆栈。

通过规范的第 2 卷 E 部分，我最终在 HCI 上获得了有意义的交流，但该设备似乎永远不会被其他任何东西“发现”。此时我只使用 BR/EDR 功能而不是 LE 功能。

这是 HCI 接口的调试转储（包括 UART 数据包类型）：

```
BT_Reset
Tx: 0x01 0x03 0x0C 0x00
Rx: 0x04 0x0E 0x04 0x01 0x03 0x0C 0x00
Device info
Tx: 0x01 0x01 0x10 0x00
Rx: 0x04 0x0E 0x0C 0x01 0x01 0x10 0x00 0x06 0x00 0x00 0x06 0x0D 0x00 0x0F 0x1B
Local supported commands
Tx: 0x01 0x02 0x10 0x00
Rx: 0x04 0x0E 0x44 0x01 0x02 0x10 0x00 0xFF 0xFF 0xFF 0x03 0xCE 0xFF 0xFF 0xFF 0xFF
Local supported features
Tx: 0x01 0x03 0x10 0x00
Rx: 0x04 0x0E 0x0C 0x01 0x03 0x10 0x00 0xFF 0xFE 0x2D 0xFE 0xDB 0xFF 0x7B 0x87
Get device address
Tx: 0x01 0x09 0x10 0x00
Rx: 0x04 0x0E 0x0A 0x01 0x09 0x10 0x00 0x81 0xA6 0xD3 0x2F 0x18 0x00
Address: 00 18 2F D3 A6 81
Read buffer size
Tx: 0x01 0x05 0x10 0x00
Rx: 0x04 0x0E 0x0B 0x01 0x05 0x10 0x00 0xFD 0x03 0xB4 0x04 0x00 0x04 0x00
ACL len = 1021
Write buffer size
Tx: 0x01 0x33 0x0C 0x07 0xFC 0x00 0x00 0x00 0x00 0x00 0x00
Rx: 0x04 0x0E 0x04 0x01 0x33 0x0C 0x00
Write local name
Tx: 0x01 0x13 0x0C 0x08 0x42 0x54 0x5F 0x54 0x65 0x73 0x74 0x00
Rx: 0x04 0x0E 0x04 0x01 0x13 0x0C 0x00
Read class of device
Tx: 0x01 0x23 0x0C 0x00
Rx: 0x04 0x0E 0x07 0x01 0x23 0x0C 0x00 0x14 0x01 0x08
Write class of device
Tx: 0x01 0x24 0x0C 0x03 0x14 0x01 0x08
Rx: 0x04 0x0E 0x04 0x01 0x24 0x0C 0x00
Write scan enabled
Tx: 0x01 0x1A 0x0C 0x01 0x03
Rx: 0x04 0x0E 0x04 0x01 0x1A 0x0C 0x00
Finished 
```

我也可以做链接查询：

```
Tx: 0x01 0x01 0x04 0x05 0x33 0x8B 0x9E 0x0A 0x0A
Rx: 0x04 0x0F 0x04 0x00 0x01 0x01 0x04
…
Rx: 0x04 0x01 0x01 0x00 
```

但它没有找到任何设备。

我确定我遗漏了一些相当明显的东西，但看不出它可能是什么。我看不到 CC2564 需要特殊处理才能在 BR/EDR 模式下运行，并且所有默认值似乎都是合理的。

# 更新

该模块需要一个初始化脚本（又名“服务包”）。请参阅“初始化脚本”下的[https://code.google.com/p/btstack/wiki/MSP430GettingStarted 。](https://code.google.com/p/btstack/wiki/MSP430GettingStarted)好消息是，现在可以通过脚本发现模块。坏消息是，根据 LS Research 的说法，我自己的堆栈不会被蓝牙 SIG 投诉——我必须使用 Bluetopia 堆栈。似乎一切都非常适合使用 Ti 处理器。
此时，我将不得不等到具有更高级别接口的 BR/EDR/BLE 模块上线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T13:27:50.200

仅当您使用公共配置文件（例如 SPP），或者当您以可连接的方式公开您的设备以供其他设备（如耳机或键盘）使用时，才需要蓝牙合规性。不久，只有当您在全球市场上将您的设备作为“蓝牙”设备销售时才需要资格认证（这样您就可以使用徽标）......至少在我的理解中......

并且服务包不包含堆栈的任何部分，因此完全免费。

并且在根据本文档加载服务包之前不允许进行蓝牙特定操作（甚至发现）： [cc256x 指南](http://processors.wiki.ti.com/index.php/CC256x_Testing_Guide)

# ruby-on-rails - 工厂女孩与三个对象的关联

> ID：14573116
> 
> 赞同：0
> 
> 时间：2013-01-28T23:23:23.083
> 
> 标签：ruby-on-rails, factory-bot

我有一个具有表单字段的表单对象（通过外键 form_id）

一个表单有很多form_fields。

还有与form_fields关联的form_field_labels（通过外键field_id）

一个 form_field 有一个 form_field_label。

我正在尝试构建一些基本工厂，以便测试我的表单、方法和验证。

这是我到目前为止所拥有的：

```
FactoryGirl.define do
factory :default_form , class: Form do
    form_name "Default Form"
    form_url "default"
    enctype "multipart/form-data"
    form_type ""
    form_layout "1_column" 
    group_id 0
    response_fields "photo,first_name,last_name"
    default_form 0 
    language "en"
    submit_button_text "Submit" 
    reset_button_text "Reset" 
    default_dropdown_text "Please Select" 
    sort 0 
    default_status "NEW"
    apply_flag false
    require_advisory false
    add_button_text "Add Another Applicant"
    follows_group_default false

    factory :default_form_with_fields do
      ignore do
                form_fields_count 5
                form_field_labels_count 5
      end

      after(:create) do |form, evaluator|
                FactoryGirl.create_list(:form_field, evaluator.form_fields_count, form: form)
              end
    end
end 
end 
```

我从 FactoryGirl github 页面复制了 create_list 函数，但不知道我的测试用例是否需要它，我只想为基本的 Form->form_fields->form_field_label 关系建立一个工厂。

after createblock 似乎正确设置了我的默认表单字段。问题是我需要每个 form_field 都有一个关联的 form_field_label。

在我们的模式中，没有 form_field_label 就没有 form_field 这样的东西。

我是工厂女孩的新手，并且希望至少建立这些基本关联，以便每当我有一个表单时，它会自动创建一些测试 form_fields（通过工厂女孩）和一些测试 form_field_labels。

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:17:13.303

如果您只需要新创建的表单在与 a 的`form_fields`关联中有一条记录`field_label`，那么您实际上不需要使用`create_list`. 您可以`FactoryGirl.create`在`after(:create)`回调中使用法线。

我建议为所有三个对象创建工厂：表单、表单域和表单域标签。然后您可以使用回调将各个部分组合在一起：

```
FactoryGirl.define do
  factory :form_field_label do
    # set form field label attributes (if any)
  end

  factory :form_field do
    # set form field attributes (if any)
    after(:create) do |form_field|
      FactoryGirl.create(:form_field_label, :form_field => form_field)
    end
  end

  factory :form do
    # set base attributes: form_name, etc.

    factory :form_with_fields do
      after(:create) do |form|
        FactoryGirl.create(:form_field, :form => form)
      end
    end
  end
end 
```

这是未经测试的，但我认为它应该工作。如果您有任何问题，请告诉我。另请注意，如果您在这些关联上有任何存在验证器，您需要使用稍微不同的方法`FactoryGirl.build`，让我知道，我会解释。

参考：[FactoryGirl 和 has_many 关联](http://icelab.com.au/articles/factorygirl-and-has-many-associations/)

# cmake - .clang_complete 和 CMake？

> ID：14573117
> 
> 赞同：5
> 
> 时间：2013-01-28T23:23:26.423
> 
> 标签：cmake, clang-complete

我正在使用 CMake 生成我的 Makefile，但是我无法使用标准生成 .clang_complete

```
make CC='~/.vim/bin/cc_args.py gcc' CXX='~/.vim/bin/cc_args.py g++' -B 
```

什么都没有生成...

树结构看起来像这样

```
Root
 |
 |_core
 |  |_src
 |  |  |_main.cpp
 |  |  |_CMakeLists.txt (1)
 |  |_inc
 |  |_CMakeLists.txt (2)
 |
 |_lib
 |  |_rtaudio
 |
 |_CMakeLists.txt (3) 
```

CMakeLists.txt (1) 文件：

```
 include_directories("${Dunkel_SOURCE_DIR}/core/inc")

include_directories("${Dunkel_SOURCE_DIR}/lib/")
link_directories("${Dunkel_SOURCE_DIR}/lib/rtaudio")

add_executable(Dunkel main.cpp)

target_link_libraries(Dunkel rtaudio) 
```

CMakeLists.txt (2) 文件：

```
subdirs(src) 
```

CMakeLists.txt (3) 文件：

```
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

PROJECT(Dunkel)
SUBDIRS(core)

set(CMAKE_CXX_FLAGS "-g") 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T18:57:33.307

看起来与`make` `cmake`不扩展波浪号相反，因此它将 is 视为路径的一部分。要使其按预期工作，请使用`cc_args.py`脚本的绝对路径或在命令中进行两个简单的更改：

1.  用 替换波浪号`$HOME`。
2.  用双引号替换单引号。

更改后，您的命令应如下所示：

```
CXX="$HOME/.vim/bin/cc_args.py g++" cmake .. 
```

它应该工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T20:22:34.737

您应该运行（在您的构建目录中）

```
CXX='~/.vim/bin/cc_args.py g++' cmake .. 
```

然后`make`像往常一样运行。请注意，这将在您每次构建项目时运行 cc_args.py 脚本`make`，如果您想禁用它，请再次重新运行`cmake`。

该文件`.clang_complete`将在构建目录中创建，如果需要移动它。

另请参阅[Vim：使用 CMake 创建 .clang_complete](http://www.guyrutenberg.com/2013/01/29/vim-creating-clang_complete-using-cmake/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-06T12:32:11.097

`$HOME/.vim/bin/cc_args.py`使用and not很重要`~/.vim/bin/cc_args.py`，因为`~`引用时可能不会扩展。

此外，使用以下命令验证 python 脚本是否存在：

```
$ ls -l $HOME/.vim/bin/cc_args.py
-rwxr-xr-x  1 myself  staff  2270 Sep 19 16:11 /home/myself/.vim/bin/cc_args.py 
```

如果未找到，请根据需要调整 python 脚本路径。

~~`make clean`在构建目录中运行。~~

正如@xaizek 所建议的，**从一个空**的构建目录开始（假设构建目录是源目录的子目录）：

```
CXX="$HOME/.vim/bin/cc_args.py g++" cmake .. 
```

其次是：

```
make 
```

此时，make 将构建项目，但调用`cc_args.py`（它将调用`g++`），而不是直接调用`g++`.

~~但是，这部分对我来说无法正常工作，并且`.clang_complete`在构建目录或其他任何地方都没有创建任何文件。~~

~~事实上，在生成的 CMakeCache.txt/Makefile 中没有出现“cc_args”，所以我怀疑`CXX`传递给 cmake 的变量名不是正确的。~~

**完成后，复制`.clang_complete`到父目录。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-13T09:42:36.407

这对我有用

```
sudo chmod a+x $HOME/.vim/bin/cc_args.py
CXX="$HOME/.vim/bin/cc_args.py  g++"  sudo cmake ..
sudo make 
```

然后 ls -a 显示我的 .clang_complete 文件，但仍然是 emtyp。

# google-maps-api-3 - 谷歌地图地理编码并在 2 个循环地理编码中附加一个 div

> ID：14573119
> 
> 赞同：1
> 
> 时间：2013-01-28T23:23:30.180
> 
> 标签：google-maps-api-3, maps, geocode, google-geocoder

我完全迷路了。我有我的 html 表单，我可以在其中写一个城市。发送表单时，会在每个循环中发送一个数据数组，代码如下：

```
geocoder = new google.maps.Geocoder();

$.each(data['list'],function(i,el)
{
    var address = el.address1+','+el.city+' '+el.zipcode;

    geocoder.geocode( { 'address': address}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var getZipCode = $("#zipcode").val();
            var getCity = $("#city").val();

            geocoder.geocode( { 'address': getCity+' '+getZipCode }, function(resultsTwo, statusTwo) {
                if (status == google.maps.GeocoderStatus.OK) {
                    var distanceKm = google.maps.geometry.spherical.computeDistanceBetween(results[0].geometry.location, resultsTwo[0].geometry.location);
                    var distanceMiles = distanceKm/1000*0.621371;
                    str = str +'<article><div class="leftDesc"><header><h3><span class="letter">'+alphabet[i]+'.</span><a href="#" onclick="OpenWindowOnMap(\''+address+'\',\''+el.store_name+'\',\''+el.description+'\');">'+el.store_name+'</a></h3></header>';
                    str = str +'<div class="addressEnonce">Address:</div><div class="addressBig"><p class="address">'+el.address1+'</p>';
                    /*str = str +'<p>'+el.address2+'</p>';*/
                    str = str +'<br /><p class="city">'+el.city+'</p>';
                    str = str +' <p class="zipcode">'+el.zipcode+'</p>';
                    str = str +' <p class="state">'+el.state+'</p></div></div>';
                    str = str +'<div class="rightDesc"><p class="distance">Distance: '+distanceMiles+' Miles</p>';
                    str = str +'<p>'+el.description+'</p></div>';

                    str = str + '<p><a href="#" onclick="OpenWindowOnMap(\''+address+'\',\''+el.store_name+'\',\''+el.description+'\');">Show on Map</a></p>';

                    if((i+1) < data['list'].length){
                        switch(i % 4){
                            case 0:
                                str = str +'<img src="img/line.png" >';
                                break;
                            case 1:
                                str = str +'<img src="img/line.png" >';
                                break;
                            case 2:
                                str = str +'<img src="img/line.png" >';
                                break;
                        }
                    }

                    str = str +'</article>';
                    tweets.append(str);
                }
            });
        }
    });
})                              }) 
```

所以代码很好，以华盛顿为例，我将展示 3 个项目，我也想要 2 个！第一项是双一 =7

我认为问题是我必须放置一个回调函数，因为这是地理编码循环中的异步方法，会导致麻烦......但是如何呢？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:11:57.023

它是异步的事实是问题所在。您需要使用闭包。这是一个例子：

```
$.each(data['list'],function(i,el) {
  var address = el.address1+','+el.city+' '+el.zipcode;
  geocoder.geocode( { 'address': address}, (function(address1, city, zipcode) {
      return function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          geocoder.geocode( { 'address': city+' '+zipcode },
              function(resultsTwo, statusTwo) {
                 // ...                     
          });
        }
      };
  })(el.address1, el.city, el.zipcode));
}); 
```

# mysql - 如果行存在，MySQL删除？

> ID：14573120
> 
> 赞同：1
> 
> 时间：2013-01-28T23:23:36.573
> 
> 标签：mysql, sql

我想从多个表中删除数据，这些数据肯定位于**ad_master**中，但子表会不时变化。我尝试了以下查询，但它至少不会删除一条记录并保持沉默。如果它们存在于我的任何给定表中，我想删除与给定数字（$delete_no）关联的每条记录。

```
DELETE am,sub1,sub2,sub3
FROM ad_master am
INNER JOIN ad_vehicles sub1
ON sub1.Ad_no=am.Ad_no
INNER JOIN ad_properties sub2
ON sub2.Ad_no=am.Ad_no
INNER JOIN ad_electronics sub3
ON sub3.Ad_no=am.Ad_no
WHERE am.Ad_no=$delete_no 
```

请指导我解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T23:36:23.897

尝试 LEFT JOIN 而不是 INNER。使用 INNER JOIN 可以使两个表相交，如果 $delete_no 在 ad_vehicles 中不存在，则结果为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:47:35.070

您正在尝试实现参照完整性。让数据库去做吧，它比你做的要好得多。Ad_no 应该是除 master 之外的所有表中的外键，在每种情况下都引用 master，并定义为删除级联。然后您所要做的就是删除主行。

# ckeditor - 向 ckeditor 内联工具栏添加选项不起作用

> ID：14573123
> 
> 赞同：0
> 
> 时间：2013-01-28T23:23:58.147
> 
> 标签：ckeditor

我在将工具栏选项添加到 CKEditor4 内联工具栏选项时遇到了一些问题。我一直在阅读文档，但仍然无法弄清楚我的问题出在哪里。

我正在动态创建一个 div，然后将 CKEditor 添加到该 div 中。一切正常，但我想删除一些工具栏选项并添加一些其他选项。当我向 inline() 调用添加参数时，没有任何变化？

这是我动态创建实例的方法：

```
.on('dblclick', function(e){

    e.preventDefault();
    e.stopPropagation();
    ed.ck_restore();
    ed.ck_active_block = $(this).attr("id");
    ed.ck_block_data = $(this).html();
    var block_width = $(this).css("width"); 
    var block_height = $(this).css("height")+20;
    var block_padding_top = $(this).css("padding-top");
    var block_padding_right = $(this).css("padding-right");
    var block_padding_bottom = $(this).css("padding-bottom");
    var block_padding_left = $(this).css("padding-left");
    var padding = 'padding-top: '+block_padding_top+';padding-right: '+block_padding_right+';padding-bottom: '+block_padding_bottom+';padding-left: '+block_padding_left+';';

    var editor = '<div id="edit" contenteditable="true" style="margin-top: -'+block_padding_top+'; margin-left: -'+block_padding_left+';'+padding+' width: '+block_width+'; height: '+block_height+';background-color: #fff;position: absolute;">'+ed.ck_block_data+'</div>';

    $("#"+ed.ck_active_block).prepend(editor);

    if(CKEDITOR.instances.edit)
    {
        CKEDITOR.instances.edit.destroy(); //remove any previously created instances 
    }

    CKEDITOR.inline("edit",
                    [CKEDITOR.config.fontSize_style = {
                        element: 'span',
                        styles: { 'font-size': '#(size)' },
                        overrides: [ {
                            element: 'font', attributes: { 'size': null }
                        }]
                    }]
                    );

    $("#edit").click(function(e){e.stopPropagation();}).focus();
    $("w_save").text("1");
}); 
```

[http://docs.ckeditor.com/#!/api/CKEDITOR-method-inline](http://docs.ckeditor.com/#!/api/CKEDITOR-method-inline)

文档暗示我可以传递配置参数来更改选项，但我遗漏了一些东西，经过 3 小时的尝试，我需要一些帮助。

任何帮助表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T09:03:36.930

我不知道那是什么意思：

```
 CKEDITOR.inline("edit",
                [CKEDITOR.config.fontSize_style = {
                    element: 'span',
                    styles: { 'font-size': '#(size)' },
                    overrides: [ {
                        element: 'font', attributes: { 'size': null }
                    }]
                }]
                ); 
```

它是无效的 JavaScript 代码。你检查过你的 JS 控制台吗？

无论如何，`CKEDITOR.inline`接受两个参数 - name 和 config **object**。

```
CKEDITOR.inline( 'edit', {
    fontSize_style: {
        element: 'span',
        styles: { 'font-size': '#(size)' },
        overrides: [
            { element: 'font', attributes: { 'size': null } }
        ]
    },
    language: 'pl',
    removeButtons: 'Bold,Italic' // or set toolbar or toolbarGroups.
} ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T19:53:11.300

感谢您的回复 Reinmar。我能够找到另一个解决方案。这是其他人的代码：

CKEDITOR.inline("edit",{customConfig : "mycustomConfig.js"});

这引用了一个自定义配置文件，我只是从 CKEditor 站点上的示例配置中提取它并更改了一些选项。现在工作。

# javascript - 时区：用户偏好与客户端 Javascript

> ID：14573125
> 
> 赞同：0
> 
> 时间：2013-01-28T23:24:14.087
> 
> 标签：javascript, web, localization, timezone

在 Javascript 中，使用对象的方法在当前用户的本地时区呈现和操作日期是相当简单的`Date`。例如，用于输出和用于输入的构造函数`toLocaleString()`的 7 参数形式。`Date`所以到目前为止，我什至没有费心将时区设置为用户偏好。在内部，所有内容都使用 UTC 存储、计算和来回发送给客户端，我们在客户端进行输入和输出的翻译。

例如，假设用户将其本地计算机的时区设置为美国东部。查看我的网页时，发生在 Unix 时间戳的事件`1359416775000`将呈现为“2013 年 1 月 28 日星期一 18:46:15”，其代码不比

```
new Date(1359416775000).toLocaleString(); 
```

但假设我需要向该用户发送一封有关此事件的电子邮件。我应该使用哪个时区来呈现这封电子邮件中的时间戳？显而易见的答案是让用户选择他们的时区。现在假设我这样做并且该用户选择`US/Eastern`. 伟大的。现在假设用户下次登录我的网站时，他们的本地计算机是美国中部时间。同一段 Javascript 代码现在将导致时间戳呈现为“Mon Jan 28 **17** :46:15 2013”​​。

这真的是正确的行为吗？用户在我的应用程序中选择了一个时区，但它只适用于电子邮件？

这似乎是一个足够常见的问题，我觉得应该有一个常见的最佳实践，我只是想知道那是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T13:07:00.823

默认情况下，您应该始终以用户本地时区显示时间。在您使用另一个时区显示时间的任何时候，都应该通过打印时区来明确这一点。

因此，如果用户时区是美国/东部，您将在您的示例中显示 hos 时区的时间“Mon Jan 28 18:46:15 2013”​​，而如果您向他展示在美国实际发生的事件/Central，您应该显示“Mon Jan 28 17:46:15 2013 US/Central”。

现在，如果用户移动到时区为美国/中部的计算机，那么是的，默认情况下，您现在应该向他显示美国/中部的时间。因此，在这两种情况下，您都将日期显示为“Mon Jan 28 18:46:15 2013”​​，不需要时区。他们会将计算机的当前时间显示在屏幕的角落，因此不会造成太大的混乱。

如果您让用户选择他的时区，这在时间显示不是由客户端时区设置决定的网站中很常见，那么默认情况下，您应该始终显示该时区的时间，无论是哪个时区计算机在。请记住，由用户来确保他的计算机处于正确的时区。大多数携带笔记本电脑旅行的人在移动时不会更改时区。

理论上，您可以通过从 IP 获取地理位置来警告用户他选择了另一个时区，而不是他似乎所在的时区。但除非你正在编写一个日历应用程序，否则我认为这让人们烦恼的多于它对他们的帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:28:20.453

不幸的是，您无法设置非 UTC 日期方法使用的用户时区。

您只能通过在输出/读取日期时添加/减去自定义时区偏移量来解决这个问题，就像在[这个例子](https://stackoverflow.com/a/14992195/1048572)中一样。

# java - Java：如何用大量谓词过滤大量对象？

> ID：14573126
> 
> 赞同：6
> 
> 时间：2013-01-28T23:24:33.230
> 
> 标签：java, collections, predicate

在 Java 中，我有**一大堆对象（大约 10,000 个对象）**，比如说`Set<Person> cityInhabitants`。我还有**一大堆谓词（约 1,000 个谓词）**，可用于**过滤掉**与这些谓词中的任何一个`Person`匹配的任何谓词。谓词可以是例如

*   `person.getName().equals("ugly name1")`
*   `person.getName().equals("ugly name2")`
*   `person.getAge() < 18`.

这一要求提出了以下挑战：

*   过滤应该很快
*   谓词是“业务定义的”，因此应该很容易添加和删除谓词。这意味着谓词可能不应该在源代码中硬编码，而最好在数据库中维护（？）

这些挑战的解决方案是什么？有什么图书馆可以在这里提供帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:30:01.657

我建议您按照执行速度对谓词进行排序。然后，您可以按速度顺序执行您的谓词，首先使用最快的谓词，这通常意味着较慢的谓词将不得不在较小的集合上运行。

然而，这个假设并不完全正确，您需要计算出删除谓词的百分比与执行速度。然后我们可以看到哪个是删除最高百分比对象的最快谓词。然后我们可以按照对我来说最优化的顺序执行谓词。

您可以轻松实现自己的谓词`interface`

```
public interface Predicate<T> {

    boolean filter(T object);

} 
```

然后，您需要为每个规则创建谓词对象。您可以为年龄和姓名检查创建一些更动态的类，这也将减少您需要的代码量。

```
public class AgeCheck<T> implements Predicate<T> {

    private final int min;
    private final int max;
    public AgeCheck(int min, int max) {
        this.min = min;
        this.max = max;
    }

    @Override
    public boolean filter(T object) {
        // if( t.age() < max && t.age > min) ...
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T23:30:58.850

在这种情况下，对于操作本身的复杂性，您无能为力。如果条目很多，谓词很多并且谓词很昂贵，那么您可以尽可能快地优化，但您肯定不会超过某个阈值，因为这里的单个操作可能很昂贵。

您应该测试不同的方法并查看在您的特定情况下表现更好的方法：

*   通过首先检查应该更宽的谓词对谓词进行排序（这样第一个谓词将过滤掉尽可能多的条目）
*   根据谓词的复杂性对谓词进行排序（以便首先执行速度更快，条目越少则越慢）
*   不要更新原始数据结构，而是保留一个包含过滤元素的并行集合 vs
*   总是更新数据结构，这样你每次都会循环更少的人

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-14T17:37:27.603

这里有一个替代方案：识别一个类的实例可能具有的所有可能的属性。在您的示例中，您有一个`person`具有两个属性的类；姓名和年龄。因为您有这些属性的吸气剂，所以 a`person`最多可能有两个属性（除非还有其他您没有提到的吸气剂）。您可以实现`person`将属性保存在一个集合中，这样您实际上对属性的数量没有限制。不管它是如何实现的，确定所有的属性。

现在对于每个属性，关联一个唯一的素数，然后为每个实例`person`维护与分配给它的那些属性对应的那些素数的乘积`person`。例如，假设一个人可以是年轻或年老、男性或女性、长相好或长相不佳。这是 6 个属性，让我们按如下方式分配质数：

```
02: young
03: old
05: male
07: female
11: good looking
13: bad looking 
```

继续这个例子，假设一个人是一个漂亮的年轻女性。素数的乘积将是 2 X 7 X 11 或 154。

现在你想找到所有好看的年轻人，不分性别。与此谓词相关的素数的乘积是 2 X 11 或 22。

因此，您现在可以遍历所有的`people`，如果与每个相关的素数乘积`people`可以除以 22 而没有任何余数（在`person`素数乘积为 154 的情况下可以），那么您就有了匹配项。

您可能希望使用 BigNumber 类来执行素数乘积的乘法、除法和存储。

如果给定 a 并询问它是否匹配所有谓词，则此解决方案非常快`person`（同样，谓词已简化为唯一的素数，并且谓词的集合现在由这些素数的乘积表示）。

如果您必须遍历整个`people`查找匹配项的集合，此解决方案可能不会那么快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-14T18:55:36.840

（*我没有意识到这个问题已经 2 岁了。我参加这个聚会太晚了！很高兴知道作者最终使用了什么解决方案。*）

有什么图书馆可以在这里提供帮助吗？嗯，当然有！

您的数据收集不是很大，但您有大量不成比例的谓词。另外，您希望这些谓词由您的用户管理，并集中存储等。这听起来很适合[Drools](http://drools.org)，它是一个规则引擎，并带有额外的工具来编写、验证和存储这些规则。

但是 Drools 可能很大并且涉及。也许您需要更简单的东西？您的代码示例以及您对速度的第一个要求让我想到了[CQEngine](https://code.google.com/p/cqengine)，它是一个用于索引对象的库。它索引字段（例如您的“名称”字段），并且可以以各种方式（等于、开头、包含等）搜索这些字段。它速度快而且简单，但它只能索引。您必须自己提出规则定义等。另一方面，CQEngine 支持逻辑谓词，因此您可以将谓词与和/或链接在一起。

还有其他用于规则引擎或对象索引的库。我相信其他人会在他们的答案中列出它们。

# python - 如何使用python在可调用装饰器对象中引用对象实例？

> ID：14573127
> 
> 赞同：2
> 
> 时间：2013-01-28T23:24:35.783
> 
> 标签：python, python-2.7, decorator, scoping

## 语境：

我希望能够装饰函数，以便我可以跟踪它们的统计信息。使用[这篇](http://www.lorieau.com/methods-and-reference/research-and-computer-methods/42-mods-method-object-decorators.html)文章作为参考，我开始尝试制作我自己的可调用装饰器对象。

这是我最终得到的结果：

```
def Stats(fn):
    Class StatsObject(object):
        def __init__(self, fn):
            self.fn = fn
            self.stats = {}

        def __call__(self, obj, *args, **kwargs):
            self.stats['times_called'] = self.stats.get('times_called', 0) + 1
            return self.fn(obj, *args, **kwargs)

    function = StatsObject(fn)
    def wrapper(self, *args **kwargs):
        return function(self, *args, **kwargs)
    return wrapper

Class MockClass(object):
    @Stats
    def mock_fn(self, *args, **kwargs):
        # do things 
```

## 问题：

这实际上正确调用了 mock_fn 函数，但我没有对包装函数之外的 stats 对象的引用。即我不能这样做：

```
mc = MockClass()
mc.mock_fn()
mc.mock_fn.stats
# HasNoAttribute Exception 
```

然后我尝试更改以下代码，认识到这是一个范围问题：

从：

```
 function = StatsObject(fn)
    def wrapper(self, *args **kwargs):
        return function(self, *args, **kwargs)
    return wrapper 
```

至：

```
 function = StatsObject(fn)
    return function 
```

但是我当然丢失了自引用（self 成为 StatsObject 实例，obj 成为第一个 arg，MockClass 对象自引用丢失）。

所以我明白为什么会发生第一个问题，但不是第二个。有什么方法可以将 MockClass 的自引用传递给 StatsObject`__call__`函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:32:46.447

函数本身实际上可以在 Python 中具有属性。

```
def Stats(fn):
    class StatsObject(object):
        def __init__(self, fn):
            self.fn = fn
            self.stats = {}

        def __call__(self, obj, *args, **kwargs):
            self.stats['times_called'] = self.stats.get('times_called', 0) + 1
            return self.fn(obj, *args, **kwargs)

    function = StatsObject(fn)
    def wrapper(self, *args **kwargs):
        return function(self, *args, **kwargs)

    # KEY LINE BELOW: make the StatsObject available outside as "stats_fn"
    wrapper.stats_fn = function

    return wrapper

class MockClass(object):
    @Stats
    def mock_fn(self, *args, **kwargs):
        # do things 
```

关键线是将`StatsObject`实例（您可能会误导地，本地命名）分配为*您从 decorator 返回*`function`的函数的属性。

 *一旦你这样做，`self.mock_fn.stats_fn.stats`（不是`self.mock_fn()`！属性在函数上，而不是它的返回值）将在 的实例中工作`MockClass`，并且`MockClass.mock_fn.stats_fn.stats`在外部可用。统计信息将在所有实例中是全局的`MockClass`（因为装饰器被调用一次，而不是每个实例一次），这可能是也可能不是您想要的。*

# php - mysqli : mysqli_result 无法转换为字符串

> ID：14573134
> 
> 赞同：0
> 
> 时间：2013-01-28T23:25:46.433
> 
> 标签：php, mysqli

我知道有人问过很多类似的问题，但我无法将其转化为我的问题，所以这就是我再次问的原因。以前的代码可以正常工作，但由于 mysql 将被弃用，我想翻译成 mysqli。

尝试从数据库读取内容时收到以下错误：可捕获的致命错误：无法将类 mysqli_result 的对象转换为字符串。它指的是第 12 行，即

```
 echo $result; 
```

完整代码：

```
$previd ="10";
$query="SELECT * FROM contacts WHERE id='$previd'";
$result = $mysqli->query($query);

echo $result;

$num=$result->num_rows;

$mysqli->close();

echo "<b><center>Database Output</center></b><br><br>";

$i=0;
while ($i < $num) {
$id=mysql_result($result,$i,"id");
$first=mysql_result($result,$i,"first");
$last=mysql_result($result,$i,"last");
$phone=mysql_result($result,$i,"phone");
$mobile=mysql_result($result,$i,"mobile");
$fax=mysql_result($result,$i,"fax");
$email=mysql_result($result,$i,"email");
$web=mysql_result($result,$i,"web");
$content=mysql_result($result,$i,"content");

echo "<u>$id</u><b>$first $last</b><br>Phone: $phone<br>Mobile: $mobile<br>Fax:     $fax<br>E-mail: $email<br>Web: $web<br><hr><br>$content";

$i++;
 } 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:30:47.500

```
$num=$result->num_rows;

echo "<b><center>Database Output</center></b><br><br>";

while ($row = $result->fetch_assoc()) {  

   echo "<u>".$row['id']."</u><b>".$row['first']."</b>"; //etc...
 } 
```

容易得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:30:44.533

那是因为`mysqli_result`是一个结果集。我不知道你会期望从中获得什么`echo`，就像你不会从使用.`echo``mysql_query``SELECT`

您需要使用各种类方法来访问结果集中的数据。

[http://php.net/manual/en/class.mysqli-result.php](http://php.net/manual/en/class.mysqli-result.php)

# iphone - RESTful iOS 应用程序 - 何时更新模型 - 最佳实践

> ID：14573136
> 
> 赞同：6
> 
> 时间：2013-01-28T23:25:56.813
> 
> 标签：iphone, ios, api, model-view-controller, rest

让我们看一个典型的 RESTful iOS 应用程序，比如说一个联系人应用程序，主屏幕是联系人列表，当点击联系人时，您会进入联系人详细信息屏幕。

联系人列表通过 REST API 获取，联系人详细信息通过另一个 API 获取。

您将使用哪个事件来触发对这些 API 的调用：

*   两个视图控制器上的 viewDidAppear
*   viewWillAppear 在两个视图控制器上
*   在主视图控制器中，在调用 pushViewController:detailViewController 之前调用联系人详细信息 API
*   还有其他活动吗？

目前，我主要将 viewWillAppear 用于这种场景，或者在某些特定情况下使用 viewDidAppear，但为了标准化我的编码实践，我肯定会确定这些不同方法的优缺点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T23:32:43.350

这部分是偏好问题。由于 API 调用会产生未知的延迟，因此应用程序应显示指示其忙碌的 UI。我的偏好是让 UI 在请求之前尽可能多地完成。（我的幼稚认知模型是，在获取数据的同时查看新 VC 的 UI 会瞬间占据用户的大脑，使延迟看起来更短）。

因此，我更喜欢描述请求的 VC 的参数 - 例如要在详细信息 VC 上获取的联系人 ID，并在 viewDidAppear 上执行请求（如果数据尚未缓存或需要刷新）。在该方法中，放置一些 UI 以指示正在发生提取，因此它具有以下形式：

```
- (void)viewDidAppear:(BOOL)animated {

    [super viewDidAppear:animated];

    if (/* i don't have my model or it's out of date */) {
        // put up 'i am busy' UI
        MyRequestClass *request = // form a request that fetches my model
        [request runWithBlock:^(id result, NSError *error) {
            // i build my request classes to run with blocks simplifying the caller side
            // if it's a json request, then pass a parsed result back to this block
            // remove 'i am busy' UI
            if (!error) {
                // init my model from result
                // other parts of this class observe that the model changes and updates the UI
            } else {
                // present error UI
            }
        }];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:37:16.563

首先，确保您的 API 接口和数据访问发生在视图控制器之外的单独数据访问类（或数据控制器 - 如果您已经这样做，那么道歉并忽略这一段）是一个很好的做法。您希望*避免*将网络代码直接放入您的视图控制器中，因为如果您想创建一个 iPad 特定的视图或需要在以后以某种方式修改您的 UI，这将使您的生活变得非常困难）。

有了这个，你有几个选择。从*用户的*角度来看，就性能而言，最好尽可能多地从您的 RESTful API 中预取。这就是诸如`AFIncrementalStore`将您的 API 映射到 Core Data 之类的库尝试做的事情。但是，如果您有成千上万的联系人，速率受到严重限制，或者带宽受到限制，这将是一个问题。

绝对可以肯定的是，您希望尽快调用您的网络 API *，*以便用户体验到最小的延迟。在这种情况下，您可能会发现使用`viewDidLoad`而不是`viewWillAppear`或`viewDidAppear`可能会更好：您可以使用加载/保持图形或动画设置您的视图，触发您的异步网络调用，然后在完成后显示所需的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:32:05.573

我通常这样做：

在 viewWillAppear 上加载联系人，如果您有下拉刷新功能，何时发生。

当用户点击一个单元格时，在处理该事件的方法中，加载事件详细信息，并将该对象传递给联系人详细信息控制器的构造函数，然后推送它。

# java - jsp显示图片出错

> ID：14573141
> 
> 赞同：0
> 
> 时间：2013-01-28T23:26:13.513
> 
> 标签：java, jsp, tomcat

我知道有一些相关的问题，但没有一个涵盖我的主题。

所以，我有一个使用 jsp、java、postgresl 和 apache tomcat 7.0.27.0 嵌入在 NetBeans（作为插件）中的 Web 应用程序，并且在项目的 web 目录中我有一个 116.jpg 图像

当我这样显示此图像时：`< img src='116.jpg' alt='title' />`

它正在正确显示。现在，我想显示一张我刚刚上传的图像，它进入了一个与之相关的目录：一个目录向上，然后是文件夹“data”，最后是文件夹“img”。因此，从技术上讲，`< img src='../data/img/117.jpg' alt='title' />` 这并没有被显示。而且...

我想自动完成。在这里，`<%= sUploadFName %>`我有用户上传的图像的名称（例如 865.jpg ）。

所以，我想要这样的东西才能工作： `< img src='../data/img"<%= sUploadFName %>"' alt='title' />`并且图像应该正常显示。

谁能解释我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:37:51.203

只有`web`（WEB-INF 和 META-INF 除外）文件夹的内容可以通过 url 公开访问，因此您上传的图像必须位于`web`其中或其子文件夹中。

如果您将图像存储在另一个目录中，那么您将必须创建一个扩展的类`HttpServlet`并将其映射到一个 URL，例如`/myapp/uploads/*`（`/myapp`是 ContextPath）每当访问该 url 时，例如`/myapp/uploads/119.jpg`使用方法获取文件名`request.getPathInfo()`并执行所需的验证（文件存在、权限等），然后读取文件并通过`HttpServletResponse`的输出流提供它。

或者，如果不需要权限验证，您可以将 tomcats [Default Servlet](https://tomcat.apache.org/tomcat-7.0-doc/default-servlet.html)映射到url 模式。`/uploads/*`

您的图像标签的来源是`<img src="/myapp/uploads/119.jpg" alt="Image" />`

这是一个示例 servlet：

```
package servlets;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.*;

public class StreamServlet extends HttpServlet {
    private static final String WINDOWS_UPLOAD_DIR = "C:\\Projects\\Data\\img";

    /**
     * Serve the images from the specified dir.
     *
     * @param req
     * @param resp
     * @throws ServletException
     * @throws IOException
     */
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp)
              throws ServletException, IOException {

        String fileName = req.getPathInfo().substring(1);
        File imageFile = new File(WINDOWS_UPLOAD_DIR, fileName);

        OutputStream os = resp.getOutputStream();
        InputStream is = new FileInputStream(imageFile);

        IOBridge(is, os);
        os.flush();
        Close(is, os);
    }

    /**
     * Bridge data between an input and output stream.
     *
     * @param in  The input stream.
     * @param out The output stream
     * @throws IOException if there's an error.
     */
     private static void IOBridge(InputStream in, OutputStream out) 
             throws IOException {

         byte data[] = new byte[1024];
         int readCount = 0;
         while ((readCount = in.read(data, 0, readCount)) != -1) {
             out.write(data);
         }
      }

     /**
      * Close some closeables
      *
      * @param closeables The closeables to be closed.
      */
     private static void Close(Closeable... closeables) {
          for (Closeable c : closeables)
              if (c != null)
                  try {
                      c.close();
                  } catch (IOException ioe) {
                      try {
                          c.close();
                      } catch (Exception e) {
                          e.printStackTrace();
                      }

                  } finally {
                        try { 
                             c.close();
                        } catch (Exception e) {
                             e.printStackTrace();
                        }
                 }
         }
    } 
```

然后在你的`web.xml`，你会添加：

```
<servlet>
    <servlet-name>StreamServlet</servlet-name>
    <servlet-class>servlets.StreamServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>StreamServlet</servlet-name>
    <url-pattern>/uploads/*</url-pattern>
</servlet-mapping> 
```

* * *

[Java Servlet 规范 3.0](http://download.oracle.com/otn-pub/jcp/servlet-3.0-fr-oth-JSpec/servlet-3_0-final-spec.pdf?AuthParam=1359476655_e0cf0f58b07658640e2d1c705a6b86a8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:37:43.303

您的问题不在于 jsp，而是图像的 url 错误。

如果没有显示图像

```
< img src='../data/img/117.jpg' alt='title' /> 
```

这意味着您对图片到页面的位置有误，或者有一些拦截器。也许图像像您写的那样在文件系统中组织，但这并不意味着 url 也以这种方式组织。如果有图像的 servlet 映射或类似的东西，请检查 web.xml。底线是，如果平面 img 不起作用，请不要修复 jsp :) 首先，您需要找到正确的图像 url，之后它会很容易

# ruby-on-rails - 获取 Rails 响应开始时间的最简单方法？

> ID：14573153
> 
> 赞同：1
> 
> 时间：2013-01-28T23:27:25.923
> 
> 标签：ruby-on-rails, ruby, rack

我正在尝试将响应的开始时间与代码中的各个位置进行比较。Rails 是否有任何魔力可以让您响应开始时间，还是我必须编写自己的中间件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:16:13.130

我认为最简单的方法是使用客户中间件

Railscast：[http ://asciicasts.com/episodes/151-rack-middleware](http://asciicasts.com/episodes/151-rack-middleware)

未测试示例

```
 class TimestampMiddleware
    def initialize(app)
      @app = app
    end

    def call(env)
      env[:timestamp] = Time.now
      @app.call(env)
    end
  end 
```

注册中间件

```
Rails::Initializer.run do |config|  
  config.middleware.use "TimestampMiddleware"  
end 
```

# vb.net - 如何将 ItemSpec 传递给 GetBranchHistory()？

> ID：14573160
> 
> 赞同：1
> 
> 时间：2013-01-28T23:28:35.473
> 
> 标签：vb.net, tfs, tfs-sdk

我正在尝试获取有关 TFS 中特定分支的信息，因此首先，我正在尝试创建一个变量以分配为 BranchHistoryTreeItem。但是，当我传入 ItemSpec 时，我在 Spec 上遇到错误（不是定义，而是传入 GetBranchHistory 的位置）：

> “Microsoft.TeamFoundation.VersionControl.Client.ItemSpec”类型的值无法转换为“Microsoft.TeamFoundation.VersionControl.Client.ItemSpec 的一维数组”

我理解这个错误，但我不完全确定它为什么会抛出它。这种数据类型不正是它正在寻找的吗？我相信我已经正确声明了 ItemSpec，但我在这里有点迷失了。任何人都可以就我为什么得到这个提供一些建议吗？代码：

```
Sub GetBranchInfo()
    Dim tfs As New TfsTeamProjectCollection(Common.BuildServerURI)
    Dim Version = tfs.GetService(Of VersionControlServer)()
    Dim Spec As New ItemSpec("$/Project1", RecursionType.None)
    Dim BranchHistory As New BranchHistoryTreeItem(Version.GetBranchHistory(Spec, VersionSpec.Latest))
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:19:22.793

`GetBranchHistory`需要一个 [s](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.versioncontrolserver.getbranchhistory%28v=vs.100%29.aspx)[*数组*。`ItemSpec`](http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.versioncontrol.client.versioncontrolserver.getbranchhistory%28v=vs.100%29.aspx)

我的 VB 有点生疏，但我想你想要这样的东西：

```
Dim Spec As New ItemSpec("$/Project1", RecursionType.None)
Dim Specs(1) = new ItemSpec() {Spec}
Dim BranchHistory As New BranchHistoryTreeItem(Version.GetBranchHistory(Specs, VersionSpec.Latest)) 
```

# .net - 我可以确保这个 lambda 函数在每个时间间隔只为多个订阅者调用一次吗？

> ID：14573161
> 
> 赞同：0
> 
> 时间：2013-01-28T23:28:36.530
> 
> 标签：.net, xna, system.reactive

我正在将基于 XNA 轮询的输入转换为基于 Observable 的输入。在这里，GetPressedKeys() 方法每 20 毫秒返回一个可枚举的枚举键：

```
Observable.Generate(
    Enumerable.Empty<Keys>(),
    pressed => true,
    pressed => Keyboard.GetState().GetPressedKeys(),
    pressed => pressed,
    pressed => TimeSpan.FromMilliseconds(20),
    scheduler
).DistinctUntilChanged(); 
```

我的问题是这是为每个订阅者完成的。我知道 Rx 使用惰性求值，但我想以某种方式限制这个 hot observable 在每个间隔只执行一次 GetPressedKeys() 函数，即使有多个订阅者也是如此。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:01:30.580

是的，您可以通过 Publish 执行此操作：

```
thatObservable = thatObservable.Publish().Refcount(); 
```

# ruby-on-rails - ActiveModel::Serializer：如何从分层 Rails 模型中收集验证错误？

> ID：14573163
> 
> 赞同：3
> 
> 时间：2013-01-28T23:28:48.057
> 
> 标签：ruby-on-rails, active-model-serializers

我有一个分层的 Rails 模型。验证后，**模型的每个实例都有一个`errors`属性，该属性是验证后的错误数组。这些错误需要序列化为与生成错误的主模型的层次结构相匹配的 JSON 对象**。有没有办法利用`ActiveModel::Serializer`代码，以便我可以使用已在`ActiveModel::Serializer`子类中配置的关联，以便我可以遍历层次模型并将错误提取到对象中以作为 JSON 发送给客户端？

这是我的分层模型：

```
class Submission < ActiveRecord::Base
  has_one :precipitation 
end

class Precipitation < ActiveRecord::Base
  has_one :precipitation_solid 
  belongs_to :submission
end

class PrecipitationSolid < ActiveRecord::Base
  has_many :precipitation_solid_samples
  belongs_to :precipitation
end

class PrecipitationSolidSample < ActiveRecord::Base
  belongs_to :precipitation_solid
end 
```

当样本值超出范围时，我想生成以下 JSON

```
{"submission": {
  "precipitation": {
    "precipitation_solid": {
      "precipitation_solid_samples": [
        "accumulation out of range",
        "accumulation out of range"
      ]
    }
  }
} 
```

也许`ActiveModel::Serializer`子类可以直接做到这一点。但如果没有，**当我创建错误对象时，是否有某种方法可以检查序列化程序中定义的关联？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:32:09.680

这个问题的最初动机是寻找错误序列化的属性。相反，通过查看上面 Deefour 指出的 GitHub 问题没有找到解决此问题的方法后，我们切换到[ActiveRecord::Reflection](http://api.rubyonrails.org/classes/ActiveRecord/Reflection/ClassMethods.html#method-i-reflect_on_all_associations "Rails 反射 API")来查找错误以搜索和序列化错误。

# c# - 天蓝色中的人类可读 URL

> ID：14573165
> 
> 赞同：0
> 
> 时间：2013-01-28T23:28:50.343
> 
> 标签：c#, asp.net, wcf, azure

我有一个带有几个辅助角色、一个 WCF Web 角色和一个包含几个 aspx 页面的普通 Web 角色的天蓝色云服务。两个角色都设置为使用 https 端点。

在使用 IIS 在 Visual Studio 中进行本地测试时，default.aspx 页面和 servicename.svc 页面都在浏览器中打开。但是，当我发布到 azure 时，带有随机字符串的 URL 会打开包含服务定义的目录，但我无法从该 URL 访问 default.aspx 页面。

例如，如果发布后我的 URL 是 randomstring.cloudapp.net，则 randomstring.cloudapp.net/wcfservice.svc 有效，但 randomstring.cloudapp.net/default.aspx 无效。我可以使用 azure 中给出的 IP 地址访问其他页面，但这并不是我真正需要的。此外，云服务 URL 根本不起作用。mycloudservice.cloudapp.net 导致找不到网页。

我是否需要做一些特别的事情才能让服务和 aspx 页面显示在 mycloudservice.cloudapp.net 下？如果需要，我可以发布配置文件，但截至目前，我认为与问题无关。

**编辑：**

澄清一下，我现在已经发布到生产环境，并且该服务正在运行 [mycloudservice].cloudapp.net/[mywcfservice] 如果我输入像 [mycloudservice].cloudapp 这样的端口，我可以在没有 404 错误的情况下访问该网站。净：8081/default.aspx 。有没有办法让所有内容都显示在 [mycloudservice].cloudapp.net/ 下而不输入端口号，所以我只需输入 [mycloudservice].cloudapp.net/[mywcfservice] 和 [mycloudservice].cloudapp.net/default .aspx 进入浏览器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:50:16.280

首先，我猜您已将项目发布到云服务的阶段槽。它是 [部署 ID].cloudapp.net。如果您将其部署到生产槽，您将使用您指定的 URL。

参考问题，'[randomstring].cloudapp.net/default.aspx' 不起作用，我不确定你所说的'不起作用'是什么意思。是404错误吗？或者一些 asp.net 运行时错误。更多信息可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T02:32:41.877

检查端口号。每个端点（wcf 端点和 Web 端点）都需要位于不同的端口号上。将它们发布到 Azure 时，你需要按原样访问它们。

正如@Shaun 所指出的，随机名称问题是从发布到Staging vs Production。

# javascript - 尝试替换部分字符串时出现“找不到函数替换”错误

> ID：14573168
> 
> 赞同：5
> 
> 时间：2013-01-28T23:29:01.253
> 
> 标签：javascript, google-apps-script, triggers

我需要一种使用 Google Apps 脚本将字符串的一部分替换为另一个字符串的方法。我测试了以下内容并且它有效：

```
function test(){
  var value = 'https://plus.google.com/117520727894266469000';
  var googleimageURL = googlePlus(value);
  Logger.log('Returned Result: ' + googleimageURL);
}

function googlePlus(value){
    var apiKey = ScriptProperties.getProperty('apiKey');
    var re = 'http://'
    var theURL = value;
    Logger.log('Google+ is called: ' + value);
    var replacingItem = 'https://';
    var theURL = theURL.replace(re, replacingItem);
    Logger.log('Google+ Values 2: ' + value + ' : ' + theURL + ' after ' + replacingItem);
    return imageURL;
} 
```

但是，当我嵌入以下代码时，它不起作用。任何想法？

```
 //If a Google+ column was not specified,put a flag.
  if (googleColumn && column == googleColumn) {
    if (value == ""){
      columns.push(nogoogleColumn);
      values.push(flag);
      var googleimageURL="";
    } else {
      var googleimageURL = googlePlus(value);
      Logger.log('Returned Result: ' + googleimageURL);
    }
  } 
```

该脚本没有按我的意愿工作。它似乎停在以下行：

```
var theURL = theURL.replace(re, replacingItem); 
```

附加信息：Google 通过以下消息通知我

> onForm提交
> 
> [TypeError：在对象https://plus.google.com/117520727894266469000](https://plus.google.com/117520727894266469000)中找不到函数替换。（第 536 行）表单提交

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-01T02:24:24.130

我发现了错误。这是类型错误。`value`第二个块不是“字符串”，而第一个块是“字符串”。因此，要修复第二个块，我需要使用：

```
var value = value.toString(); 
```

在传递给之前`googlePlus(value)`

# iis-7 - URL redirect for all branches under one tree but excluding certain file extensions

> ID：14573169
> 
> 赞同：1
> 
> 时间：2013-01-28T23:29:01.480
> 
> 标签：iis-7, url-rewriting, web-config, .net-2.0

.Net 2.0/IIS-7

I want to redirect

abc.com\GroupRequests\FirstGroup

to a handler abc.com\GroupRequests\grouprequesthandler.ashx but I want all *.aspx files in abc.com\GroupRequests\FirstGroup to be accessed using their original URL.

prefer config solution instead of code

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T02:34:37.333

This solution uses URLRewriter which is available in IIS7\. It is independent of your .net version.

```
<rewrite>
      <rules>
        <rule name="RewritePartner">
          <match url="^Partner/([A-Za-z]+)/(.+)" ignoreCase="false"/>
          <conditions>
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true"/>
          </conditions>
          <action type="Rewrite" url="Handler/Partner.aspx?partner={R:1}&amp;query={R:2}"/>
        </rule>
      </rules>
    </rewrite> 
```

# api - Vimeo API 用虚 url 获取视频？

> ID：14573171
> 
> 赞同：1
> 
> 时间：2013-01-28T23:29:10.517
> 
> 标签：api, vimeo

有谁知道如何从 Vimeo 的 api 中获得对虚荣/自定义 url 的响应，如下所示：

[http://vimeo.com/jarominne/regarde-moi](http://vimeo.com/jarominne/regarde-moi)或[http://vimeo.com/davidfield/caterpillar](http://vimeo.com/davidfield/caterpillar)

视频 ID 的标准 Api 请求不起作用。

**不起作用：** [https ://vimeo.com/api/v2/video/regarde-moi.json](https://vimeo.com/api/v2/video/regarde-moi.json)

**作品：** [https ://vimeo.com/api/v2/video/58086788.json](https://vimeo.com/api/v2/video/58086788.json)

我在他们的文档中看不到任何有意义或明确的解决方案。我不在乎语言。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:35:13.080

FWIW，这是一个糟糕的 php 解决方案，我在提出这个问题后不久就想到了。

非常欢迎改进！

本质上，如果我们没有视频 id（一个数值），假设我们的 id 是视频标题。使用 URL 中的用户名获取我们的用户数据并获取他们所有的视频。循环播放这些视频并尝试将标题与我们的“视频 ID”（在上面的例子中实际上是视频标题）匹配。

** 假设 $this->id = 您的视频 ID 或视频用户名 ** 假设 $this->user = 您的 vimeo 用户名

```
public $apis = array(
    'vimeo_image' => 'http://vimeo.com/api/v2/video/%s.json',
    'vimeo_user' => 'http://vimeo.com/api/v2/user/%s/videos.json'
);

public function vimeoThumbnail($size = 'small')
{
    if(preg_match('/[0-9]+/', $this->id)) {
        $video_id = $this->id;
    } else {
        $videos = file_get_contents(sprintf($this->apis['vimeo_user'], $this->video->user));
        if($videos !== false) {
            $videos = json_decode($videos);
            foreach($videos as $video) {
                if(stristr($video->title, $this->id)) {
                    $video_id = $video->id;
                    break;
                }
            }
        }
    }

    $contents = file_get_contents(sprintf($this->apis['vimeo_image'], $video_id));

    if($contents !== false) {
        $contents = json_decode($contents);

        if(is_array($contents)) $contents = array_shift($contents);
        if(!is_object($contents)) return false;

        $image_url = $contents->{'thumbnail_' . $size};

        return $image_url;
    }

    return false;
} 
```

# java - Thread.join 在我的代码中似乎不起作用；我用对了吗？

> ID：14573172
> 
> 赞同：0
> 
> 时间：2013-01-28T23:29:25.350
> 
> 标签：java, multithreading

我有一个可以自动化用户的类 Automator。我在 Windows 中设置系统剪贴板时特别遇到问题。Automator 类使用 ClipSetThread 类，这是一个设置系统剪贴板的线程。ClipSetThread 的一个实例将一个线程作为输入，如果为空，它会加入（等待它完成）。

我觉得我没有正确调用 ClipSetThread，因为我在它的可靠性方面仍然存在我以前遇到的错误；在 ClipSetThread 之前。此代码在运行时不会抛出任何错误，但它的工作时间约为 2/3。其他时候它会打印 1134、_234 等。似乎线程没有加入（等待）彼此，或者被跳过。

代码：

```
import java.awt.AWTException;
import java.awt.Robot;
import java.awt.event.KeyEvent;

import org.jnativehook.GlobalScreen;
import org.jnativehook.NativeHookException;
import org.jnativehook.mouse.NativeMouseEvent;
import org.jnativehook.mouse.NativeMouseInputListener;

public class Automator extends Thread implements NativeMouseInputListener 
{
Robot rob = null;
TheAppClass theApp = null;
ClipSetThread lastClipSet = null; 
boolean doit = false;
boolean settingClip = false;

public void run()
{
    try // to make the Global hook
    {
        GlobalScreen.registerNativeHook();
    }
    catch (NativeHookException ex){theApp.updateOutput("No Global Keyboard or Mouse Hook");return;}
    try // to create a robot (can simulate user input such as mouse and keyboard input)
    {
        rob = new Robot();
    } 
    catch (AWTException e1) {theApp.updateOutput("The Robot could not be created");return;}

    while(true) {}
}

public void setApp(TheAppClass app)
{
    theApp = app;
    theApp.updateOutput("Succesfully started automator");
}

public void setClip(String arg)
{
    ClipSetThread set = new ClipSetThread(theApp, lastClipSet);
    lastClipSet = set;
    set.setClip(arg);
}

public void DOit()
{
    theApp.updateOutput("Starting");
    pasteAtCursorLocation("1");
    tab(1);
    pasteAtCursorLocation("2");
    tab(1);
    pasteAtCursorLocation("3");
    tab(1);
    pasteAtCursorLocation("4");
    tab(1);
    theApp.updateOutput("Complete");
}

public void nativeMouseReleased(NativeMouseEvent e) 
{
    //System.out.println("Mouse Released: " + e.getButton());
    if(doit)
    {
        DOit();
        doit = false;
    }
}

public void pasteAtCursorLocation(String text)
{
    setClip(text);
    rob.keyPress(KeyEvent.VK_CONTROL);
    rob.keyPress(KeyEvent.VK_V);
    rob.keyRelease(KeyEvent.VK_V);
    rob.keyRelease(KeyEvent.VK_CONTROL);
    theApp.updateOutput("Simulated Paste");
}
public void tab(int numTimes)
{
    while(numTimes > 0)
    {
        rob.keyPress(KeyEvent.VK_TAB);
        rob.keyRelease(KeyEvent.VK_TAB);
        numTimes--;
        theApp.updateOutput("Simulated Tab");
    }
}
// Unimplemented
public void nativeMouseClicked(NativeMouseEvent arg0) {}
public void nativeMousePressed(NativeMouseEvent arg0) {}
public void nativeMouseDragged(NativeMouseEvent arg0) {}
public void nativeMouseMoved(NativeMouseEvent arg0) {}
} 
```

剪辑集线程：

```
import java.awt.Toolkit;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;

public class ClipSetThread extends Thread 
{
Clipboard sysClip = null;
TheAppClass  theApp = null;

public ClipSetThread(TheAppClass  app, Thread waitFor)
{
    theApp = app;
    sysClip = Toolkit.getDefaultToolkit().getSystemClipboard();
    if(waitFor != null)
        {try {waitFor.join();}catch (InterruptedException e) {}}
}
public void setClip(String arg)
{
    // Two strings that will hopefully never be on the clipboard
    String checkStr1 = "9999999999999";
    String checkStr2 = "99999999999999";
    // When we read in the clipboard we want to see if we change these strings from the ones they
    // will never be, if they do change we read the clipboard successfully
    String clipBoardTextBefore = checkStr1;
    String clipBoardTextAfter = checkStr2;

    // First get a copy of the current system clipboard text
    while(true)
    {
        try 
        {
            Transferable contents = sysClip.getContents(null);
            clipBoardTextBefore = (String)contents.getTransferData(DataFlavor.stringFlavor);
        }
        catch(Exception e)
        {
            try {Thread.sleep(20);} catch (InterruptedException e1) {}
            continue;
        }
        break;
    }
    // If we failed to change the string it means we failed to read the text
    if(clipBoardTextBefore.equals(checkStr1)) 
        theApp.updateOutput("Could NOT get sysClip text");
    else
    {
        // If we didn't failed to get the current text try to change it
        while(true) 
        {
            try{sysClip.setContents(new StringSelection(arg), null);}
            catch(Exception e)
            {
                try {Thread.sleep(20);} catch (InterruptedException e1) {}
                continue;
            }
            break;
        }

        // Now again check to see the clipboard text
        while(true)
        {
            try 
            {
                Transferable contents = sysClip.getContents(null);
                clipBoardTextAfter = (String)contents.getTransferData(DataFlavor.stringFlavor);
            }
            catch(Exception e)
            {
                try {Thread.sleep(20);} catch (InterruptedException e1) {}
                continue;
            }
            break;
        }
        // If we failed to read the clipboard text
        if(clipBoardTextAfter.equals(checkStr2)) 
            theApp.updateOutput("Could NOT check if sysClip update was successful");
        else
        { // We re-read the clipboard text, see if it changed from the original clipboard text 
            if(clipBoardTextAfter.equals(checkStr1)) 
                theApp.updateOutput("Could NOT successfully set clipboard text");
            else
                theApp.updateOutput("Set Clipboard Text:" + arg + "\n");
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:00:14.087

所以，首先，你永远不要调用`start`. `ClipSetThread`您还应该在加入之前检查线程是否还活着。

```
public class ClipSetThread extends Thread {

    Clipboard sysClip = null;
    TheAppClass theApp = null;

    private String toClipboard;

    public ClipSetThread(TheAppClass app, Thread waitFor, String toClipBoard) {
        theApp = app;
        sysClip = Toolkit.getDefaultToolkit().getSystemClipboard();
        this.toClipboard = toClipBoard;
        // !! Check to see if the thread is also alive before trying to join with it...
        if (waitFor != null && waitFor.isAlive()) {
            try {
                waitFor.join();
            } catch (InterruptedException e) {
            }
        }
    }

    // You should really put your logic into the `run` method in order to allow
    // the code to actually run in a separate thread...otherwise there is no
    // point in using a thread....
    @Override
    public void run() {
        // Two strings that will hopefully never be on the clipboard
        String checkStr1 = "9999999999999";
        String checkStr2 = "99999999999999";
        // When we read in the clipboard we want to see if we change these strings from the ones they
        // will never be, if they do change we read the clipboard successfully
        String clipBoardTextBefore = checkStr1;
        String clipBoardTextAfter = checkStr2;

        // First get a copy of the current system clipboard text
        while (true) {
            try {
                Transferable contents = sysClip.getContents(null);
                clipBoardTextBefore = (String) contents.getTransferData(DataFlavor.stringFlavor);
            } catch (Exception e) {
                try {
                    Thread.sleep(20);
                } catch (InterruptedException e1) {
                }
                continue;
            }
            break;
        }
        // If we failed to change the string it means we failed to read the text
        if (clipBoardTextBefore.equals(checkStr1)) {
            theApp.updateOutput("Could NOT get sysClip text");
        } else {
            // If we didn't failed to get the current text try to change it
            while (true) {
                try {
                    sysClip.setContents(new StringSelection(toClipboard), null);
                } catch (Exception e) {
                    try {
                        Thread.sleep(20);
                    } catch (InterruptedException e1) {
                    }
                    continue;
                }
                break;
            }

            // Now again check to see the clipboard text
            while (true) {
                try {
                    Transferable contents = sysClip.getContents(null);
                    clipBoardTextAfter = (String) contents.getTransferData(DataFlavor.stringFlavor);
                } catch (Exception e) {
                    try {
                        Thread.sleep(20);
                    } catch (InterruptedException e1) {
                    }
                    continue;
                }
                break;
            }
            // If we failed to read the clipboard text
            if (clipBoardTextAfter.equals(checkStr2)) {
                theApp.updateOutput("Could NOT check if sysClip update was successful");
            } else { // We re-read the clipboard text, see if it changed from the original clipboard text 
                if (clipBoardTextAfter.equals(checkStr1)) {
                    theApp.updateOutput("Could NOT successfully set clipboard text");
                } else {
                    theApp.updateOutput("Set Clipboard Text:" + toClipboard + "\n");
                }
            }
        }
    }

} 
```

根据我们之前的说法，使用它很危险`while (true) {}`，也很浪费，因为它会不必要地消耗 CPU 周期......

```
public class Automator extends Thread implements NativeMouseInputListener {

    // A "locking" object...
    private static final Object WAIT_LOCK = new Object();

    Robot rob = null;
    TheAppClass theApp = null;
    ClipSetThread lastClipSet = null;
    boolean doit = false;
    boolean settingClip = false;

    public void run() {
        try // to make the Global hook
        {
            GlobalScreen.registerNativeHook();
        } catch (NativeHookException ex) {
            theApp.updateOutput("No Global Keyboard or Mouse Hook");
            return;
        }
        try // to create a robot (can simulate user input such as mouse and keyboard input)
        {
            rob = new Robot();
        } catch (AWTException e1) {
            theApp.updateOutput("The Robot could not be created");
            return;
        }

        // This is wasteful...
//        while (true) {
//        }
        // Locks do not consume CPU cycles while in the wait state...
        synchronized (WAIT_LOCK) {
            try {
                WAIT_LOCK.wait();
            } catch (Exception exp) {
            }
        }
    }

    public void dispose() {

        // Tell the thread it can terminate...
        synchronized (WAIT_LOCK) {
            WAIT_LOCK.notify();
        }
        // This will STOP the current thread (which called this method)
        // while the lastClipSet finishes...
        if (lastClipSet != null && lastClipSet.isAlive()) {
            lastClipSet.join();
        }

    }

    public void setClip(String arg) {
        ClipSetThread set = new ClipSetThread(theApp, lastClipSet, arg);
        lastClipSet = set;
        // You MUST START the thread...
        set.start();
    }

    /*...*/
} 
```

**更新**

此代码可能会产生无限循环。如果剪贴板不包含`String`值会怎样？

```
while(true)
{
    try 
    {
        Transferable contents = sysClip.getContents(null);
        clipBoardTextBefore = (String)contents.getTransferData(DataFlavor.stringFlavor);
    }
    catch(Exception e)
    {
        try {Thread.sleep(20);} catch (InterruptedException e1) {}
        continue;
    }
    break;
} 
```

你经常这样做。我可能会建议您提供某种“转义”机制，以使其在多次重试后失败...

```
boolean successful = false;
int retries = 0;
while (!successful && retries < 20) {
{
    try 
    {
        Transferable contents = sysClip.getContents(null);
        clipBoardTextBefore = (String)contents.getTransferData(DataFlavor.stringFlavor);
        successful = true;
    }
    catch(Exception e)
    {
        retries++;
        try {Thread.sleep(20);} catch (InterruptedException e1) {}
    }
} 
```

**更新了工作示例**

好吧，那很有趣。我整理了一个（简单的）工作示例。您将需要打开某种文本编辑器。当您运行程序时，您有 5 秒的时间使其处于活动状态；）

我所做的唯一基本更改是我设置了在 250 毫秒的事件之间添加了一个自动延迟（请参阅`rob.setAutoDelay(250)`.

现在，您也可以在每个关键事件之间设置延迟，使用`Robot#delay`，但这取决于您

```
public class Engine extends Thread {

    private Robot rob = null;
    private PasteThread lastClipSet = null;

    public void setClip(String arg) {
        if (lastClipSet != null && lastClipSet.isAlive()) {
            try {
                lastClipSet.join();
            } catch (InterruptedException ex) {
                ex.printStackTrace();
            }
        }
        PasteThread set = new PasteThread(arg);
        lastClipSet = set;
        lastClipSet.start();
    }

    public void pasteAtCursorLocation(String text) {
        System.out.println("Paste " + text);
        setClip(text);
        rob.keyPress(KeyEvent.VK_CONTROL);
        rob.keyPress(KeyEvent.VK_V);
        rob.keyRelease(KeyEvent.VK_V);
        rob.keyRelease(KeyEvent.VK_CONTROL);
    }

    public Engine() throws AWTException {
        rob = new Robot();
        rob.setAutoDelay(250);
        try {
            Thread.sleep(5000);
        } catch (InterruptedException ex) {
        }
        pasteAtCursorLocation("This is a simple test, thanks for watching!");
    }

    public static void main(String[] args) {
        try {
            new Engine();
        } catch (AWTException ex) {
            Logger.getLogger(Engine.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    public class PasteThread extends Thread {

        private String toPaste;

        public PasteThread(String value) {

            toPaste = value;

        }

        @Override
        public void run() {
            Clipboard sysClip = Toolkit.getDefaultToolkit().getSystemClipboard();
            System.out.println("Current clipboard contents = " + getClipboardContents(sysClip));
            sysClip.setContents(new StringSelection(toPaste), null);
            System.out.println("New clipboard contents = " + getClipboardContents(sysClip));
        }

        public String getClipboardContents(Clipboard clipboard) {
            String value = null;
            boolean successful = false;
            int retries = 0;
            while (!successful && retries < 20) {
                Transferable contents = clipboard.getContents(null);
                if (contents.isDataFlavorSupported(DataFlavor.stringFlavor)) {
                    try {
                        value = (String) contents.getTransferData(DataFlavor.stringFlavor);
                        successful = true;
                    } catch (Exception exp) {
                        retries++;
                        exp.printStackTrace();
                    }
                } else {
                    retries++;
                }
            }
            System.out.println(successful + "/" + retries);
            return value;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:54:24.433

您能否尝试重复粘贴操作，并在其间休眠 1 秒

```
public void pasteAtCursorLocation(String text)
{
setClip(text);
rob.keyPress(KeyEvent.VK_CONTROL);
rob.keyPress(KeyEvent.VK_V);
rob.keyRelease(KeyEvent.VK_V);
rob.keyRelease(KeyEvent.VK_CONTROL);
theApp.updateOutput("Simulated Paste");

// put in a sleep 1 second here

rob.keyPress(KeyEvent.VK_CONTROL);
rob.keyPress(KeyEvent.VK_V);
rob.keyRelease(KeyEvent.VK_V);
rob.keyRelease(KeyEvent.VK_CONTROL);
theApp.updateOutput("Simulated Paste");
} 
```

粘贴 2x 可能会产生不同的结果。这种奇怪行为的原因可能是 Windows 管理剪贴板的方式。如果粘贴 2x 剪贴板会给出不同的结果，那么您知道这种奇怪行为的根本原因不是在您的代码中找到，而是 Java 和 Windows 如何协同工作。

# python - matplotlib - 运行时添加多行而不事先知道

> ID：14573173
> 
> 赞同：1
> 
> 时间：2013-01-28T23:29:38.990
> 
> 标签：python, pointers, reference, matplotlib

我试图在一个图形上添加多行而不事先知道行数。我目前有一个类，它具有用于单个会话中的行的 x 和 y 值。

我不确定如何为同一图中的每个新会话添加新行。创建该关联是具体的。

在我的主要功能中，我有以下代码。

```
fig = plt.figure()
ax = fig.add_subplot(111)
line,= plt.figure().plot(0,0) 
```

在我的课上。我有以下代码。

```
class Session:
x = []
y = []
# I think I should add a line here... but I am not sure 
# how to make this association to the main. 
```

对于每个会话，它存储 x 和 y 值，我可以通过方法检索这些值。这部分很简单，但是将每条线与同一个图表相关联是我遇到的麻烦。我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:55:18.260

您可以`.plot()`多次调用。我添加了一个如何更改线条颜色的示例。我会把造型留给你。

```
import matplotlib.pyplot as plt

fig = plt.Figure()
ax = fig.add_subplot(111)

colors = ('b','g','r','c','m','y','k','w',)
sessions = (sess1, sess2, sess3)
for sess, color in zip(sessions, colors):
    ax.plot(sess.x, sess.y, color=color) 
```

* * *

如果您想使用和/或重复使用所有线条的一组特定颜色，[`itertools.cycle`](http://docs.python.org/2/library/itertools.html#itertools.cycle)则可以轻松完成：

```
import itertools as it

colors = ('b','g','r',)
sessions = (sess1, sess2, sess3, sess4, sess5, sess6)
for sess, color in zip(sessions, it.cycle(colors)):
    ax.plot(sess.x, sess.y, color=color) 
```

# lua - 检查 Lua C 中的保护模式

> ID：14573174
> 
> 赞同：2
> 
> 时间：2013-01-28T23:29:43.960
> 
> 标签：lua

在 Lua C 处理程序中，我在抛出错误之前在注册表中设置了一个标志。如果从 Lua 使用`pcall`. 以下是更多详细信息：

我有一个`handle`从 C 调用的基本 Lua 函数，使用`lua_pcall`：

```
function handle()
  c_handle()
end 
```

C 中的句柄具有以下基本结构，我们希望在抛出错误之前设置一个标志，以区分错误与其他错误。

```
int c_handle(lua_State *L)
{
  if (condition) {
    set a flag in registry
    throw error with lua_error
} 
```

我遇到的问题是，如果 Lua 使用 pcall 调用处理程序，我不想设置注册表标志或清除它：

```
function handle()
  pcall(c_handle)
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:18:54.187

您可以将脚本沙箱化并替换`pcall`为您自己的可以回调的版本`c_handle()`，如下所示：

```
local newenv = {
    pcall = function(f, arg1, arg2, ...)
        if pcall(f, arg1, arg2, ...) then
            c_handle(true) -- no error, pass true to c_handle
        else
            c_handle(false) -- error, pass false to c_handle
        end if
    end
}
setmetatable(newenv, {__index = _G})
setfenv(1, newenv) 
```

因此，现在当您进行受保护的呼叫时，它将通过`c_handle`.

**编辑**

不太确定将参数传递给 C 函数的语法，但我想这将是它的基本要点。

# python - 从 (ID, number) 对中只保留那些包含最大数字的对

> ID：14573182
> 
> 赞同：0
> 
> 时间：2013-01-28T23:30:36.900
> 
> 标签：python, regex

我是 python 新手，我想为一个小问题提供一些帮助。我有一个文件，其每一行都有一个 ID 和一个关联的数字。同一个 ID 可以关联多个号码。如何在 python 中只获取 ID 加上与之关联的最大数字？

例子：

输入：ID_file.txt

ENSG00000133246 2013
ENSG00000133246 540
ENSG00000133246 2010
ENSG00000253626 465
ENSG00000211829 464
ENSG00000158458 2577
ENSG00000158458 2553

我想要的是以下内容：

ENSG00000133246 2013
ENSG00000253626 465
ENSG00000211829 464
ENSG00000158458 2577

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:37:10.140

我认为有很多方法可以做到这一点，尽管我会使用字典

```
from collections import defaultdict

id_value_dict = defaultdict()
for line in open(idfile.txt).readlines():
    id, value = line.strip().split()
    if id not in id_value_dict:
        id_value_dict[id] = int(value)
    else:
        if id_value_dict[id] < int(value):
            id_value_dict[id] = int(value) 
```

下一步是写出字典

```
out_ref = open(outputfile.txt,'w')
for key, value in id_value_dict:
    outref.write(key + '\t' + str(value)

outref.close() 
```

有更巧妙的方法可以做到这一点，我认为字典可以使用 lamda 或列表理解以单行方式编写，但我喜欢从简单开始

以防万一您需要对结果进行排序，有很多方法可以做到这一点，但我认为理解在 python 中使用列表和字典至关重要，因为我发现学习思考正确的数据容器通常是关键解决了我的许多问题，但我还是个新手。无论如何，如果您需要排序结果，一个简单的方法就是

```
 id_value_dict.keys().sort() 
```

所以这是关于 python id_value__dict.keys() 的巧妙之处之一是排序的字典键列表

```
 out_ref = open(outputfile.txt,'w')
 for key in id_value_dict.keys():
     outref.write(key + '\t' + str(id_value_dict[key])

 outref.close() 
```

它真的很棘手，因为你可能想要（我知道我一直想要）编码

```
 my_sorted_list = id_value_dict.keys().sort() 
```

但是你会发现 my_sorted_list 不存在（NoneType）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:59:01.177

鉴于您的输入只包含每个 ID 的连续运行（也就是说，一旦您看到另一个 ID，就再也看不到前一个 ID），您可以这样做：

```
import itertools
import operator

with open('ID_file.txt') as idfile, open('max_ID_file.txt', 'w') as maxidfile:
    keyvalpairs = (line.strip().split(None, 1) for line in idfile)
    for key, group in itertools.groupby(keyvalpairs, operator.itemgetter(0)):
        maxval = max(int(keyval[1]) for keyval in group)
        maxidfile.write('{} {}\n'.format(key, maxval)) 
```

要了解它的作用，让我们逐行查看它。

文件只是一个充满行的可迭代文件，因此`for line in idfile`正是您所期望的。对于每一行，我们都调用`strip`去除多余的空格，然后`split(None, 1)`在第一个空格上拆分它，所以我们最终得到一个可迭代的字符串对。

接下来，我们将[`groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby)其更改为充满（键，组）对的可迭代对象。试着打印出来`list(keyvalpairs)`看看它是什么样子的。

然后我们对其进行迭代，并仅用于`max`获得每个组中的最大值。

最后，我们打印出组的键和最大值。

# android - Android ProgressDialog 不适用于移动网络

> ID：14573189
> 
> 赞同：4
> 
> 时间：2013-01-28T23:31:10.083
> 
> 标签：android, android-asynctask, progressdialog

我开发了一个简单的异步任务，它从网站下载文件并显示它。
有一个奇怪的行为：

### 当我使用无线连接时

ProgressDialog 在下载开始时正确显示当下载完成时
ProgressDialog 从 0% 正确更新到 100%
，它会消失并打开 PDF 文件。

### 当我使用 3G/移动连接时

ProgressDialog 在下载开始时正确显示当下载完成时
ProgressDialog 保持为 0%
它消失并且 PDF 文件正确打开。

可能是什么问题呢？（我使用的是 Android 2.3.7）
谢谢！

```
public class TamTam extends Activity {
    public ProgressDialog mProgressDialog;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mProgressDialog = new ProgressDialog(TamTam.this);
        mProgressDialog.setIndeterminate(false);
        mProgressDialog.setMax(100);
        mProgressDialog.setProgressStyle(ProgressDialog.STYLE_HORIZONTAL);
        new DownloadFileAsync().execute("http://www.*******.com/file.pdf");
    }

    class DownloadFileAsync extends AsyncTask<String, Integer, String> {

        String fileName;

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            mProgressDialog.show();
        }

        @Override
        protected String doInBackground(String... aurl) {
            int count;

            try {
                URL url = new URL(aurl[0]);
                URLConnection conexion = url.openConnection();

                conexion.connect();

                int lenghtOfFile = conexion.getContentLength();

                fileName="output.pdf";
                InputStream input = new BufferedInputStream(url.openStream());
                OutputStream output = new FileOutputStream(new File(
                        Environment.getExternalStorageDirectory()
                            + "/" + fileName));

                byte data[] = new byte[1024];
                count = 0;
                long total = 0;

                while ((count = input.read(data)) > 0) {
                    total += count;
                    publishProgress((int) ((total * 100) / lenghtOfFile));
                output.write(data, 0, count);
                }

                output.flush();
                output.close();
                input.close();
            } catch (Exception e) {
            }
            return null;

        }

        protected void onProgressUpdate(Integer... progress) {
            mProgressDialog.setProgress(progress[0]);
        }

        @Override
        protected void onPostExecute(String unused) {
            mProgressDialog.dismiss();
                    showPdf(fileName);
        }
    }
    public void showPdf(String fileName)
    {
       ....
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-11T09:59:33.893

正如迈克所说，问题出在这一行：

```
int lenghtOfFile = conexion.getContentLength(); 
```

问题是服务器没有提供内容长度标头。使用 HEAD 请求，我让服务器回复正确的内容长度字段，否则该字段为空。要指定请求方法，我必须使用 HttpURLConnection，而不是 URLConnection。

所以我改变了这个块

```
URLConnection conexion = url.openConnection();
conexion.connect();
int lenghtOfFile = conexion.getContentLength(); 
```

有了这个

```
HttpURLConnection conexion2 = (HttpURLConnection) url.openConnection();
conexion2.setRequestMethod("HEAD");
int lenghtOfFile = conexion2.getContentLength();

URLConnection conexion = url.openConnection();
conexion.setDoOutput(true);
conexion.connect(); 
```

资料来源：

[http://en.wikipedia.org/wiki/Chunked_transfer_encoding](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)

[Java URLConnection ：我怎样才能找出网络文件的大小？](https://stackoverflow.com/questions/263013/java-urlconnection-how-could-i-find-out-a-files-size)

# java - 如何在java中制作二维LinkedList？

> ID：14573190
> 
> 赞同：-2
> 
> 时间：2013-01-28T23:31:11.410
> 
> 标签：java, list, linked-list

例如：

```
public static LinkedList<String, Double> ll = new LinkedList<String, Double>; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:41:45.340

根据您的问题，我认为（不是 100% 确定）您正在寻找 `java.util.LinkedHashMap<K, V>`

在你的情况下，它会是`LinkedHashMap<String, Double>`

来自java文档：

> Map 接口的哈希表和链表实现，具有可预测的迭代顺序。此实现与 HashMap 的不同之处在于它维护一个双向链表，该列表贯穿其所有条目。

如果您确实想通过以下方式获取元素`list.get(5)`，则可以：

```
LinkedList<Entry<String, Double>> 
```

所以你可以通过 获得Entry 元素`Entry entry = list.get(5)`，然后`entry.getKey()`给你STRing，`entry.getValue()`给你Double。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:50:53.347

阅读您的所有评论，我建议您执行以下操作：

```
public class StringAndDouble {
    private String str;
    private double dbl;
    // add constructor
    // add getters, setters and other methods as needed.
    // override equals() and hashCode()
} 
```

现在您可以使用：

```
List<StringAndDouble> list = new LinkedList<>(); // or
List<StringAndDouble> list = new ArrayList<>();  // better in most cases 
```

现在您可以通过索引访问您的对象。

这个答案创建了一个新类，以满足您的需求。该类有两个字段，一个`String`，一个`double`。这不会使类成为二维的。我认为你有一个误解。当有`n`维度时，您需要`n`索引来访问元素。您说的是按索引访问，所以我假设您正在寻找一个包含多个字段的对象的一维列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:37:11.877

你的意思是这样吗？

```
HashMap<String, Double> hm = new HashMap<String, Double>(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:01:44.037

由于 OP 在对@Kent 的评论中说他希望能够按索引获取项目......

请注意， a `LinkedList`(and `LinkedHashMap`) 在这方面*效率低下*。他可能更喜欢`ArrayList`. 所以我建议他的“2D”实现是

```
ArrayList<Map.Entry<String, Double>> 
```

这将有效地支持按索引获取。

至于 normal `get(String key)`，您必须对所有条目进行线性搜索，这将是低效的。

因此，您有一个决定：哪种访问方式（通过键或通过索引）更重要？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-23T03:10:13.350

您实际上可以在彼此之间使用链接列表...例如：

```
public LinkedList<LinkedList<Integer>> twoDimLinkedList = new LinkedList<LinkedList<Integer>>(); 
```

然后：

```
////////////////

int value = twoDimLinkedList.get(3).get(4);

///////////////// 
```

或（如果您打算将其用于迭代目的）：

```
/////////////////

for (int i = 0; i < twoDimLinkedList.size(); i++) {
    LinkedList<Integer> twoDimLinkedListRow = new LinkedList<Integer>();
    for (int m = 0; m < twoDimLinkedList.get(i).size(); m++) {
        twoDimLinkedListRow.add(value);
    }
    twoDimLinkedList.add(twoDimLinkedListRow);
}
//////////////// 
```

# java - Python中优先级队列的优先级函数

> ID：14573195
> 
> 赞同：1
> 
> 时间：2013-01-28T23:32:04.520
> 
> 标签：java, python-2.7, priority-queue

我将如何在 Python 中编写以下 Java PriorityQueue？

```
PriorityQueue<Integer[]> pq = new PriorityQueue<Integer[]>(11,
        new Comparator<Integer[]>() {
          public int compare(Integer[] A, Integer[] B) {
            return A[0] < B[0] ? -1 : 1;
          }
        }); 
```

我做到了

```
from Queue import PriorityQueue
def my_method(self):
  pq = # I got stuck here since I need to include "comparator" 
```

我查看了许多示例，例如[创建 python 优先级队列](https://stackoverflow.com/questions/3311480/creating-a-python-priority-queue)，但它们似乎没有定义 a`priorty function`或`comparator`某种类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:35:30.243

一种选择是将`(A.pulp, A)`值作为优先级队列中的值。这样，它将`pulp`首先使用元组比较来比较值。

另一种选择是在您的类上实现`__cmp__`（或定义`__lt__`和`__eq__`使用`functools.total_ordering`）以进行必要的比较。这假设您还没有其他比较功能。

# html - 这个套接字错误是什么意思？

> ID：14573206
> 
> 赞同：1
> 
> 时间：2013-01-28T23:32:53.973
> 
> 标签：html, http, sockets

首先感谢所有在这里回答问题的人。我将此论坛用作Java圣经。这是一个家庭作业问题，这是作业：

> 用 Java 编写一个程序，使用套接字连接到端口 80 上的 Web 服务器，使用 HTTP 协议的 GET 请求网页，并显示生成的 HTML

不知道我这样做是否正确。我对java的了解非常有限。其中大部分来自我经历过的教程。任何网站链接将不胜感激。

这是我的错误信息：

```
Exception in thread "main" java.lang.Error: Unresolved compilation problems: 
Type mismatch: cannot convert from java.net.Socket to Socket
The method getInputStream() is undefined for the type Socket 
```

这是我的代码：

```
import java.io.*;
import java.net.*;
public class Server
{

    public static void main(String[] args) throws Exception
    {
        Server SERVER = new Server();
        SERVER.run();
    }

    public void run() throws Exception
    {
        ServerSocket one = new ServerSocket(80);

        //these are the two lines of code it is warning about

        Socket myskt = one.accept();
        InputStreamReader IR = new InputStreamReader(myskt.getInputStream());

        //end of warnings

        BufferedReader BR = new BufferedReader(IR);

        String message = BR.readLine();
        System.out.println(message);

        if (message != null)
        {
            PrintStream PS = new PrintStream(System.out);
            PS.println("Message Received");
        }

        URL website = new URL("www.dogs.com");
        URLConnection yc = website.openConnection();
        BufferedReader in = new BufferedReader(new InputStreamReader(
        yc.getInputStream()));
        String inputLine;
        while ((inputLine = in .readLine()) != null)
        System.out.println(inputLine);

        one.close();
    }
    // TODO Auto-generated method stub
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T04:31:36.190

问题是我们的代码格式不正确——你有一个编译错误。我的猜测是你有一个`Socket`与你正在编译的类在同一个包中的类，或者类路径上有一个剩余的类文件（Socket.class）。当编译器运行时，它使用 Socket 的包本地版本，它的类型与`java.net.Socket`- 因此异常。

要解决此问题，请在声明时使用完全限定名称 java.net.Socket`myskt`

# java - 如何填写方法 public boolean checkAnswer(String response)？

> ID：14573208
> 
> 赞同：0
> 
> 时间：2013-01-28T23:33:21.460
> 
> 标签：java, oop, boolean, return

我需要帮助看看我在这里做错了什么。说明是：

1.  在 getAnswer 上使用 StringTokenizer ；
2.  虽然它有MoreTokens；
3.  检查响应是否与 nextToken 匹配；
4.  如果是，则返回 true ；
5.  如果没有，则返回 false。

这是我编码的：

```
public boolean checkAnswer{
 StringTokenizer str = new StringTokenizer(getAnswer());
    while (str.hasMoreTokens()){
        if(response.matches(str.nextToken())) return true;
    }
   return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:35:41.140

您的代码将被解析为

```
public boolean checkAnswer {
 StringTokenizer str = new StringTokenizer(getAnswer());
    while (str.hasMoreTokens()) {
        if(response.equals(str.nextToken())) return true;
    }

    if(!response.equals(str.nextToken()))return false;
} 
```

根据您的规范，这不是您需要做的（可能也不是您在编写它时打算做的事情）并且它既不会在每个分支上返回布尔值（因为 Javac 不会查看分支是否详尽无遗案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:38:29.530

`false`如果没有任何标记等于，您想返回`response`。当且仅当您的`while`循环退出时才会出现这种情况。另请参阅@Jack 的回答。

# java - 在映射器中逐行从 HDFS 读取文本文件

> ID：14573209
> 
> 赞同：9
> 
> 时间：2013-01-28T23:33:22.520
> 
> 标签：java, hadoop, hdfs

Mappers 的以下代码是从 HDFS 读取文本文件吗？如果是：

1.  如果不同节点的两个映射器几乎同时打开文件会发生什么？
2.  不需要关闭`InputStreamReader`吗？如果是这样，如何在不关闭文件系统的情况下做到这一点？

我的代码是：

```
Path pt=new Path("hdfs://pathTofile");
FileSystem fs = FileSystem.get(context.getConfiguration());
BufferedReader br=new BufferedReader(new InputStreamReader(fs.open(pt)));
String line;
line=br.readLine();
while (line != null){
System.out.println(line); 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-29T01:38:57.427

这将起作用，并进行一些修改 - 我假设您粘贴的代码只是被截断：

```
Path pt=new Path("hdfs://pathTofile");
FileSystem fs = FileSystem.get(context.getConfiguration());
BufferedReader br=new BufferedReader(new InputStreamReader(fs.open(pt)));
try {
  String line;
  line=br.readLine();
  while (line != null){
    System.out.println(line);

    // be sure to read the next line otherwise you'll get an infinite loop
    line = br.readLine();
  }
} finally {
  // you should close out the BufferedReader
  br.close();
} 
```

您可以让多个映射器读取同一个文件，但是使用分布式缓存更有意义是有限制的（不仅减少了托管文件块的数据节点上的负载，而且效率更高如果您的工作任务数量多于任务节点）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-19T15:43:01.177

```
import java.io.{BufferedReader, InputStreamReader}

def load_file(path:String)={
    val pt=new Path(path)
    val fs = FileSystem.get(new Configuration())
    val br=new BufferedReader(new InputStreamReader(fs.open(pt)))
    var res:List[String]=  List()
    try {

      var line=br.readLine()
      while (line != null){
        System.out.println(line);

        res= res :+ line
        line=br.readLine()
      }
    } finally {
      // you should close out the BufferedReader
      br.close();
    }

    res
  } 
```

# iphone - 没有 Google 地图的 iOS 上的 Panoramio 图片

> ID：14573213
> 
> 赞同：3
> 
> 时间：2013-01-28T23:33:51.867
> 
> 标签：iphone, ios, maps, mapkit, panoramio

我正在开发一个小的 iOS 应用程序，它在标准 MKMapKit 地图（来自 Apple）上显示 POI。当用户选择一个 POI 时，应用程序会向 Panoramio 发送请求，以获取经纬度的照片，如下所示：

```
http://www.panoramio.com/map/get_panoramas.php?order=popularity&set=public&from=0&to=2&minx=XXXXXXXX&miny=XXXXXXXX... etc... 
```

问题是我今天在 Panoramio ToS 上看到的：

```
http://www.panoramio.com/api/terms.html 
```

> 第 2 节：API 客户端限制 您不得在使用 Google 地图或任何照片共享网站以外的地图技术的 API 客户端中使用 API。

我没有使用适用于 iOS 的 Google Maps API，所以问题是：我可以使用 Apple 的标准 MKMapKit 并在同一个应用程序中显示 Panoramio 的照片吗？

如果没有，是否有从 GPS 坐标获取照片的替代解决方案？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T03:33:50.660

首先，我不是律师，这不是法律建议。

撇开免责声明不谈，使用苹果的 CoreLocation 类来生成纬度/经度信息，而且你永远不会接触地图软件。

地理定位和地图绘制是两个互补的功能，不一定会相互作用。

从我在那里读到的内容来看，我认为通过 CoreLocation 框架检索您的位置并随后使用该信息从 Panoramio 请求地图信息没有问题。

祝你好运！

# python - 上传 ImageField form.is_valid 无效

> ID：14573214
> 
> 赞同：0
> 
> 时间：2013-01-28T23:33:51.960
> 
> 标签：python, django

通过 ImageField 上传图像时，表单无效。我知道我需要正确绑定到文件，但我看不到我缺少什么/出了什么问题。真的很感激 Django 对此的一些智慧。

**模型.py**

```
class New_User(models.Model):
        user = models.OneToOneField(User, unique = True)
        birthday = models.DateField(null=True)
        name = models.CharField(max_length=100)
        image = models.ManyToManyField(Image)
        album = models.ManyToManyField(Album)
        avatar = models.ImageField("Profile Pic", upload_to='images/', blank =True, null=True)

        def __unicode__(self):
            return unicode (self.user)

    **forms.py**

    class Upload(ModelForm):
        class Meta: 
            model = New_User

    **Views.py**

    @login_required
    def Profile(request):
            #if not logged in, we send them to the log in page
        if not request.user.is_authenticated():
            return HttpResponseRedirect('/login')
        user_reg = request.user.get_profile()
        '''Saving the profile pic'''
        if request.method =="POST":
            picture_form = Upload(request.POST, request.FILES, instance = user_reg)
            if picture_form.is_valid():
                avatar = form.cleaned_data['avatar']
                a = New_User(avatar = avatar)
                a.save()
                #resize and save image under same filename
                #save_file(request.FILES['avatar'])
                return HttpResponse('Thanks for uploading the image')#just to test if the image is valid
            else:
                return HttpResponse('Fail')#just to test if the image is not valid
        else:
            picture_form = Upload(instance = user_reg)

        if user_reg.avatar:
            image = "/media/" + user_reg.avatar.name
        context = {"user_reg" : user_reg, "picture_form" : picture_form, "image":image, "media_url": MEDIA_URL}
        return render_to_response("profile.html", context, context_instance= RequestContext(request))

    def save_file(file, path =''):
        '''Save file function'''
        filename = file._get_name()
        fd = open("%s/ %s" % (MEDIA_ROOT, str(path) + 'images/' + str(filename)), 'wb')
        for chunk in file.chunks():
            fd.write(chunk)
        fd.close()

    **Profile.html**

    <div class='row'>
        <div class="span">
            <form enctype="multipart/form-data" action="/profile" method="POST">
            {% csrf_token %}
            <div style='float:left;'>

         <p>{{ picture_form.avatar }}</p>
            <input type="submit" value="Submit" id="submit" />
            </form> 
```

# javascript - 如何使用棘轮启用 push.js ajax 内容加载器

> ID：14573215
> 
> 赞同：10
> 
> 时间：2013-01-28T23:33:54.667
> 
> 标签：javascript, ios, ratchet-bootstrap, push.js

我正在尝试从棘轮实现 push.js 引擎：

[http://maker.github.com/ratchet/#push](http://maker.github.com/ratchet/#push)

我从这里下载了棘轮文件：

[http://maker.github.com/ratchet/ratchet.zip](http://maker.github.com/ratchet/ratchet.zip)

并且正在使用 apache 来提供所有 js、css 和 html。所有文件都在同一个目录中。

这是我的 one.html 文件：

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ratchet template page</title>

    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- Include the compiled Ratchet CSS -->
    <link rel="stylesheet" href="ratchet.css">

    <!-- Include the compiled Ratchet JS -->
    <script src="ratchet.js"></script>

  </head>
  <body>

  <!-- Make sure all your bars are the first things in your <body> -->
  <header class="bar-title">
    <h1 class="title">one.html</h1>
  </header>

  <!-- Wrap all non-bar HTML in the .content div (this is actually what scrolls) -->
  <div class="content">

    <ul class="list">
      <li>
        <a href="two.html">
          <strong>two</strong>
          <span class="chevron"></span>
        </a>
      </li>
    </ul>

  </div>

  </body>
</html> 
```

这是我的 two.html 文件：

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ratchet template page</title>

    <!-- Sets initial viewport load and disables zooming  -->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">

    <!-- Include the compiled Ratchet CSS -->
    <link rel="stylesheet" href="ratchet.css">

    <!-- Include the compiled Ratchet JS -->
    <script src="ratchet.js"></script>

  </head>
  <body>

  <!-- Make sure all your bars are the first things in your <body> -->
  <header class="bar-title">
    <h1 class="title">two.html</h1>
  </header>

  <!-- Wrap all non-bar HTML in the .content div (this is actually what scrolls) -->
  <div class="content">

    <ul class="list">
      <li>
        <a href="one.html">
          <strong>one</strong>
        </a>
      </li>
    </ul>

  </div>

  </body>
</html> 
```

我如何将这两个文件链接在一起？

看起来 push.js 包含在内，但是当我单击 a href 时什么也没做。

我觉得我错过了关于这个实现的一些明显的东西。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-31T08:13:16.043

Ratchet 依靠触摸事件工作，这在您的浏览器中不可用。在 Chrome 中，转到 chrome://flags/ 并启用“强制启用触摸事件”。这应该对浏览器开发有用。如果你想在没有标志的桌面上进行这项工作，你将需要一个 js 框架来将触摸事件转换为指针事件。像[https://github.com/maker/ratchet/blob/master/docs/js/fingerblast.js](https://github.com/maker/ratchet/blob/master/docs/js/fingerblast.js)这样的东西应该可以解决问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-19T23:17:04.393

Ratchet 在移动设备上使用的触摸事件与桌面浏览器中使用的指针事件不同。

您可以使用前面答案中提到的 Chrome 标志，也可以使用 @fat 的 fingerblast.js 将触摸事件转换为指针事件。

fingerblaster.js 文件可以在这里找到： [https ://github.com/stephanebachelier/fingerblast.js](https://github.com/stephanebachelier/fingerblast.js)

重要提示：为了启用 fingerblaster.js，您需要在 body 元素的末尾包含如下脚本（一旦您的 html 内容已加载）：

```
<script type='text/javascript'>
    var fb = new FingerBlast ('body');
</script> 
```

这将创建一个新的 FingerBlast 对象并在 html 文档的主体上设置侦听器（您可以将任何 css 选择器字符串放在“body”的位置）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-30T21:43:44.823

我问了同样的问题。似乎它只适用于 ios / 手机，而不适用于网络浏览器。

见：[https ://github.com/maker/ratchet/issues/148](https://github.com/maker/ratchet/issues/148)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-15T12:51:46.727

我发现[**Ripple Emulator**](http://ripple.incubator.apache.org) 很好地解决了这个“问题”（我认为只有在 Chrome 上可用）

很好，因为你不需要添加另一个 js 库

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-15T12:19:35.827

现代 Firefox 浏览器具有称为“响应式设计视图”的 Web 开发人员功能。它允许您在较小的视口中查看网页，以模拟在手机/平板电脑上的使用。它还允许您模拟触摸事件。在 Web 应用程序上使用 Ratchet 时，我发现它特别有用。

在 Firefox 中，您可以通过转到工具 -> Web 开发人员 -> 响应式设计视图或使用热键“option + command + m”来启用响应式设计视图。

有关响应式设计视图的更多信息，请参见[此处](https://developer.mozilla.org/en-US/docs/Tools/Responsive_Design_View)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-29T20:59:40.570

您可以下载 Chrome Canary 并使用开发人员工具单击电话图标（第一个），然后选择要模拟的手机，您甚至可以使用[Responsinator.com](http://responsinator.com)。

PushJS 嵌入到 ratchet.js 中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-07T22:09:30.373

使用 FingerBlast。试过 Chrome、Safari 和它的工作。

> [https://github.com/stephanebachelier/fingerblast.js/blob/master/lib/fingerblast.js](https://github.com/stephanebachelier/fingerblast.js/blob/master/lib/fingerblast.js)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-24T11:19:11.050

在 Google Chrome 上，您可以使用开发者控制台并通过触摸事件模拟移动设备 [https://developer.chrome.com/devtools/docs/device-mode#emulate-touch-events](https://developer.chrome.com/devtools/docs/device-mode#emulate-touch-events)

# solr - solrj 的超时异常

> ID：14573218
> 
> 赞同：1
> 
> 时间：2013-01-28T23:34:04.137
> 
> 标签：solr, solrj

我正在使用 solr (v4) - 我偶尔会遇到以下异常：

```
Timeout occured while waiting response from server at: http://localhost:8983/solr 
```

我假设我可以通过配置文件或通过我在 solr 中的代码更改超时参数（我相信几周前我已经减少了）。除了更改配置/代码中的超时时间（并检查为什么我的代码或 solr 连接需要这么长时间，我还有什么可以解决这个问题的）？

**更新**：这似乎发生在我尝试向 solr 提交一些文档（定义明确）的时候 - 但是，其中一些可能已经在 solr 中，我不确定这是否会导致任何问题索尔

编辑：我在第一次编辑中提到的似乎是这种情况，尽管我并不完全确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:42:00.353

您是否正在缓存或池化 HttpClient 或连接？如果是这样，您的客户端和 Solr 服务器之间是否有防火墙？

这可能是长时间运行的连接被防火墙关闭的情况，并且所有随后使用该连接的尝试都会丢弃数据包（导致超时）或返回 RST 数据包。

如果您可以复制它，请尝试在客户端上运行 Wireshark 并查看连接发生了什么。但如果是防火墙，通常很难复制（需要创建 X 小时的连接间隙）。

# actionscript-3 - as3 声音流停止

> ID：14573220
> 
> 赞同：0
> 
> 时间：2013-01-28T23:34:12.353
> 
> 标签：actionscript-3, audio, stream

我正在创建一个在线收音机，但我遇到了一个奇怪的问题，代码可以运行 5 次！之后播放按钮将不起作用！

我不确定这是否相关，但我也收到*SecurityError: Error #2000: No active security context。*当我关闭 swf 播放器时。

```
import flash.events.MouseEvent;
var streaming:Boolean;
this.addEventListener(MouseEvent.CLICK, music_on)

function music_on(event:MouseEvent):void
{   

var sndChannel:SoundChannel=new SoundChannel();
var s:Sound = new Sound();

    if (!streaming)
    {   gotoAndStop(2);             
        var req:URLRequest = new URLRequest("http://127.0.0.1:8000/listen.mp3");
        var context:SoundLoaderContext = new SoundLoaderContext(2000,false);
        s.load(req, context);
        sndChannel=s.play();
        streaming=true;         
    }
    else
    {
        gotoAndStop(1);

        streaming=false;
        sndChannel.stop();
        SoundMixer.stopAll();
        trace ("not playing");
    }
}
stop(); 
```

# c - C中的条件逻辑

> ID：14573221
> 
> 赞同：0
> 
> 时间：2013-01-28T23:34:29.610
> 
> 标签：c, if-statement

我正在为一个统计课做作业，而且我是编程新手。我不想问一个愚蠢的问题，但我已经搜索并找不到答案。

这是我的代码：

```
#include "stdio.h"
#include "math.h"
#include "stdlib.h"

double pareto(double x, double alpha, double beta)  
{
    double val = beta * pow(alpha, beta) / pow(x, beta+1);

    if( alpha <= 0 ) printf("error");
    else if( beta <= 0 ) printf("error");
    else if( alpha >= x) return(0);
    else return(val);
}

int main()
{
    double x;
    double alpha;
    double beta;
    scanf("%lf", &x);
    scanf("%lf", &alpha);
    scanf("%lf", &beta);
    printf("%f\n", pareto(x,alpha,beta));
    return 0;
} 
```

当我测试代码如下：

```
echo 3 -2 1 | ./paretodens 
```

我得到输出：

```
error0.000000 
```

我希望它只是“错误”。我希望我的问题是有道理的。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T23:36:51.287

如果出现错误，你可以让你的程序死掉：

```
if (alpha <= 0)
{ 
    printf("error\n");
    exit(EXIT_FAILURE);
} 
```

这样该函数将永远不会返回，并且您根本不会调用最终的 print 语句。

否则请注意，`pareto`它没有向调用者发出错误信号的方法！如果您想在发生错误后继续执行，则必须重新设计函数以允许发生错误状态并进行通信。

* * *

由于您是新手：还请注意，您的代码可以缩短很多，因为您不需要`else`在 a`return`或之后`exit`：

```
double pareto(double x, double alpha, double beta)
{
    if (alpha <= 0 || beta <= 0) { printf("Error\n"); exit(EXIT_FAILURE); }

    return alpha >= 0 ? 0 : beta * pow(alpha, beta) / pow(x, beta + 1);
} 
```

请注意，除非您知道自己需要它，否则您不需要执行计算！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:39:44.703

这总是被执行：

```
printf("%f\n", pareto(x,alpha,beta)); 
```

你根本没有这个条件。此外，您的 pareto() 函数有时不会返回指定值。你应该解决这个问题并让它总是返回一些特定的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:53:55.370

如果我对您的理解正确，您想从函数中打印“错误”或正确的返回值，但不能同时打印两者。问题是您`pareto`从对`printf`. 该`pareto`函数本身调用了 printf，这就是您的代码同时打印“错误”和返回值的原因。

就个人而言，我会按如下方式清理它：

```
double pareto(double x, double alpha, double beta)  
{
    if (alpha <= 0 || beta <= 0)
        return -1;

    if (alpha >= x)
        return 0;

    return beta*pow(alpha,beta)/pow(x,beta+1);
}

int main()
{
    double x;
    double alpha;
    double beta;
    double val;

    scanf("%lf", &x);
    scanf("%lf", &alpha);
    scanf("%lf", &beta);

    val = pareto(x,alpha,beta);

    if (val < 0)
        printf("error");
    else
        printf("%f\n", val);

    return 0;
} 
```

# javascript - 使用 JavaScript 设置 cookie 和获取 cookie

> ID：14573223
> 
> 赞同：659
> 
> 时间：2013-01-28T23:34:38.200
> 
> 标签：javascript, html, css, cookies

我正在尝试根据我在 HTML 中选择的 CSS 文件来设置 cookie。我有一个带有选项列表的表单，以及不同的 CSS 文件作为值。当我选择一个文件时，它应该被保存到一个 cookie 中大约一个星期。下次打开 HTML 文件时，它应该是您之前选择的文件。

JavaScript 代码：

```
function cssLayout() {
    document.getElementById("css").href = this.value;
}

function setCookie(){
    var date = new Date("Februari 10, 2013");
    var dateString = date.toGMTString();
    var cookieString = "Css=document.getElementById("css").href" + dateString;
    document.cookie = cookieString;
}

function getCookie(){
    alert(document.cookie);
} 
```

HTML 代码：

```
<form>
    Select your css layout:<br>
    <select id="myList">
        <option value="style-1.css">CSS1</option>
        <option value="style-2.css">CSS2</option>  
        <option value="style-3.css">CSS3</option>
        <option value="style-4.css">CSS4</option>
    </select>
</form> 
```

* * *

## 回答 #1

> 赞同：1018
> 
> 时间：2014-06-08T06:28:28.573

我发现以下代码比其他任何代码都简单得多：

```
function setCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + (value || "")  + expires + "; path=/";
}
function getCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}
function eraseCookie(name) {   
    document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
} 
```

**现在，调用函数**

```
setCookie('ppkcookie','testcookie',7);

var x = getCookie('ppkcookie');
if (x) {
    [do something with x]
} 
```

来源 - [http://www.quirksmode.org/js/cookies.html](http://www.quirksmode.org/js/cookies.html)

他们今天更新了页面，因此页面中的所有内容都应该是最新的。

* * *

## 回答 #2

> 赞同：414
> 
> 时间：2013-07-08T08:18:27.397

这些是*比*w3schools 更好的参考（有史以来最糟糕的网络参考）：

*   [cookie 的工作原理 (quirksmode.org)](http://www.quirksmode.org/js/cookies.html)
*   [MDN 文档.cookie](https://developer.mozilla.org/en-US/docs/Web/API/document.cookie)

来自这些参考的示例：

```
// sets the cookie cookie1
document.cookie = 'cookie1=test; expires=Sun, 1 Jan 2023 00:00:00 UTC; path=/'

// sets the cookie cookie2 (cookie1 is *not* overwritten)
document.cookie = 'cookie2=test; expires=Sun, 1 Jan 2023 00:00:00 UTC; path=/'

// remove cookie2
document.cookie = 'cookie2=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/' 
```

Mozilla 参考甚至有一个不错的 cookie 库可供您使用。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2013-01-29T00:20:54.677

检查[W3Schools.com 上的 JavaScript Cookies 以](http://www.w3schools.com/js/js_cookies.asp)通过 JS 设置和获取 cookie 值。

只需使用那里提到的 setCookie 和 getCookie 方法。

因此，代码将类似于：

```
<script>
function setCookie(c_name, value, exdays) {
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + exdays);
    var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString());
    document.cookie = c_name + "=" + c_value;
}

function getCookie(c_name) {
    var i, x, y, ARRcookies = document.cookie.split(";");
    for (i = 0; i < ARRcookies.length; i++) {
        x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
        y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
        x = x.replace(/^\s+|\s+$/g, "");
        if (x == c_name) {
            return unescape(y);
        }
    }
}

function cssSelected() {
    var cssSelected = $('#myList')[0].value;
    if (cssSelected !== "select") {
        setCookie("selectedCSS", cssSelected, 3);
    }
}

$(document).ready(function() {
    $('#myList')[0].value = getCookie("selectedCSS");
})
</script>
<select id="myList" onchange="cssSelected();">
    <option value="select">--Select--</option>
    <option value="style-1.css">CSS1</option>
    <option value="style-2.css">CSS2</option>
    <option value="style-3.css">CSS3</option>
    <option value="style-4.css">CSS4</option>
</select> 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2014-06-04T11:09:51.703

我确信这个问题应该有一个更通用的答案，其中包含一些可重用的代码，这些代码与 cookie 作为键值对一起使用。

此片段取自[MDN](https://developer.mozilla.org/en-US/docs/Web/API/document.cookie)，可能是可信赖的。这是使用 cookie 的 UTF 安全对象：

```
var docCookies = {
  getItem: function (sKey) {
    return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
  },
  setItem: function (sKey, sValue, vEnd, sPath, sDomain, bSecure) {
    if (!sKey || /^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)) { return false; }
    var sExpires = "";
    if (vEnd) {
      switch (vEnd.constructor) {
        case Number:
          sExpires = vEnd === Infinity ? "; expires=Fri, 31 Dec 9999 23:59:59 GMT" : "; max-age=" + vEnd;
          break;
        case String:
          sExpires = "; expires=" + vEnd;
          break;
        case Date:
          sExpires = "; expires=" + vEnd.toUTCString();
          break;
      }
    }
    document.cookie = encodeURIComponent(sKey) + "=" + encodeURIComponent(sValue) + sExpires + (sDomain ? "; domain=" + sDomain : "") + (sPath ? "; path=" + sPath : "") + (bSecure ? "; secure" : "");
    return true;
  },
  removeItem: function (sKey, sPath, sDomain) {
    if (!sKey || !this.hasItem(sKey)) { return false; }
    document.cookie = encodeURIComponent(sKey) + "=; expires=Thu, 01 Jan 1970 00:00:00 GMT" + ( sDomain ? "; domain=" + sDomain : "") + ( sPath ? "; path=" + sPath : "");
    return true;
  },
  hasItem: function (sKey) {
    return (new RegExp("(?:^|;\\s*)" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=")).test(document.cookie);
  },
  keys: /* optional method: you can safely remove it! */ function () {
    var aKeys = document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g, "").split(/\s*(?:\=[^;]*)?;\s*/);
    for (var nIdx = 0; nIdx < aKeys.length; nIdx++) { aKeys[nIdx] = decodeURIComponent(aKeys[nIdx]); }
    return aKeys;
  }
}; 
```

Mozilla 进行了一些测试来证明这在所有情况下都有效。

[这里](http://mdn.beonex.com/en/DOM/document.cookie.html)有一个替代片段：

# android - Android：如何在控件之间创建绘图区域

> ID：14573227
> 
> 赞同：1
> 
> 时间：2013-01-28T23:34:59.800
> 
> 标签：android, drawing, android-canvas

我有一个应用程序需要在一些控件之间有某些定义的区域，我可以在其中绘制原始形状（主要是矩形）。

是否有一个简单的控件只定义了我可以在页面上的其他控件之间绘制的区域？

我原本以为我可以只在 ImageView 上绘图，但是当我这样做时，图像视图会移动到布局中完全不同的位置，并且大小似乎都搞砸了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:49:30.890

您应该使用扩展 View 的内部类，并将绘图内容放在 onDraw() 方法中：

```
public void onDraw(Canvas canvas) {
     super.onDraw(canvas);   
} 
```

从那里你可以把这个视图放在一个LinearLayout或RelativeLayout中。

如果您的绘图视图与控件混合的方式很复杂，那么您也可以在 onDraw 中添加您的控件，并监听 onTouch 事件以确定它们何时被按下。

# ms-word - 防止 Word 2010 保存 o:gfxdata base64 或 uuencoded VML？

> ID：14573228
> 
> 赞同：3
> 
> 时间：2013-01-28T23:35:03.010
> 
> 标签：ms-word, vml, wordprocessingml, opentbs, drawingml

我正在使用 .docx 文件，其中包含多个插入图像的绘图画布以及在 Word 2010 中绘制的一些线条和箭头。我使用的是 2010 格式，没有兼容模式。

Word`o:gfxdata`在每个元素中插入一个属性`v:shape`，`v:group`并用 ascii 编码的东西填充它。从我读过的内容来看，它可能是描述`v:shape`or的 VML 的副本`v:group`。我不知道我是否只是不知道要查找什么，但我无法确定这些数据的用途，因为删除它对我在 Word 2003、2007 或 2010 中阅读或编辑文档的能力没有明显影响.

它确实将 document.xml 膨胀到几乎是（明显）必要大小的两倍。这**大大**减慢了 OpenTBS 的处理速度，所以如果可能的话，我想删除它。有谁知道告诉 Word 2010 停止保存这些额外数据的方法？或者它是干什么用的？[除了这篇文章](http://answers.microsoft.com/en-us/office/forum/office_2010-word/word-2010-file-bloat/80f77059-10fa-4cb7-8bd2-ffd67e260761)之外，我真的很难找到任何关于它的文档。

**编辑：**

这是一个[示例 .docx](http://www.sarahkempdesigns.com/now/wp-content/uploads/2013/01/ogee_washer_example.docx)。document.xml 约为 141KB，OpenTBS 平均需要 10.35 秒来创建一个将其作为子模板包含 21 次的文件。如果我删除所有 o:ogfxdata 属性，文件大小会减少到 ~37KB，OpenTBS 只需 2.99 秒即可生成相同的文件。

**编辑2：**

经过进一步调查，似乎删除 o:gfxdata 可能会导致安装了旧兼容包的 Word 2003 反对该文件并出现以下错误：

> “这是兼容包的预发布版本，只能打开预发布的 Office 2007 文件。您要检查兼容包的更新版本吗？”

我已经能够通过安装更新​​的兼容性包来打开文件——尽管它会提示用户不兼容并转换文件以打开它。这不会损坏我的文件，但需要注意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T23:46:40.873

属性`o:ogfxdata`在网络中的记录很差。根据您的调查，这是某种兼容性额外信息。

您可以使用 OpenTBS 删除模板中的这些属性。可以在您的模板上进行一次清理，无需任何合并，然后将清理后的模板另存为新模板。或者您可以在每次打开模板时执行清理。

清理 DOCX 文件：

```
while ($x = clsTbsXmlLoc::FindStartTagHavingAtt($TBS->Source, 'o:gfxdata', 0) ) {
  $x->ReplaceAtt('o:gfxdata', '');
  $TBS->Source = str_replace(' o:gfxdata=""', '', $TBS->Source);
} 
```

请注意，该类`clsTbsXmlLoc`是随 OpenTBS 提供的，并且没有记录。该代码应该从 OpenTBS 1.8.0 开始工作。（目前是稳定的测试版）。

我注意到由于属性`o:gfxdata`被删除，当您编辑 docx 时它们不会立即返回。

# python - Python的字符串模板在变量未设置时更改括号

> ID：14573230
> 
> 赞同：1
> 
> 时间：2013-01-28T23:35:19.860
> 
> 标签：python, string, templates

我有 Python 代码，它尝试使用特殊语法 $[VARIABLE]（注意方括号）和 string.template.safe_substitute() 替换变量。这工作正常，除了一个例外，当引用未定义的变量时，而不是单独留下引用，因为 safe_substitute() 记录了它用大括号替换方括号。模板中 RE 的高级使用没有详细记录（[http://docs.python.org/2/library/string.html#template-strings](http://docs.python.org/2/library/string.html#template-strings)），所以可能我只是用错了。想法？

这是测试用例的示例运行；请注意，定义 var 后一切正常：

```
% python tmpl.py
===$[UNDEFINED]===
===${UNDEFINED}===

% UNDEFINED=Hello python tmpl.py
===$[UNDEFINED]===
===Hello=== 
```

这是测试用例本身：

```
import os
from string import Template

# The strategy here is to replace $[FOO] but leave traditional
# shell-type expansions $FOO and ${FOO} alone.
# The '(?!)' below is a guaranteed-not-to-match RE.
class _Replace(Template):
    pattern = r"""
        \$(?:
        (?P<escaped>(?!))               | # no escape char
        (?P<named>(?!))                 | # do not match $FOO, ${FOO}
        \[(?P<braced>[A-Z_][A-Z_\d]+)\] | # do match $[FOO]
        (?P<invalid>)
    )
    """

if '__main__' == __name__:
    text = '===$[UNDEFINED]==='
    tmpl = _Replace(text)
    result = tmpl.safe_substitute(os.environ)
    print text
    print result 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:58:46.687

`Template`假设大括号字符实际上是一个大括号：

`string.py:194`：

```
 if braced is not None:
            try:
                return '%s' % (mapping[braced],)
            except KeyError:
                return self.delimiter + '{' + braced + '}' 
```

如果您认为这是一个错误，请将其发布在[http://bugs.python.org](http://bugs.python.org)上。否则，如果可能，我建议仅使用`{}`作为分隔符。

# javascript - 使用 javascript 滚动浏览多个 HTML 页面

> ID：14573240
> 
> 赞同：0
> 
> 时间：2013-01-28T23:35:52.770
> 
> 标签：javascript, html

我有以下 HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
<title>Dashboard Example</title>
<style type="text/css">
body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
iframe { border: none; }
</style>
<script type="text/javascript">
var Dash = {
    nextIndex: 0,

    dashboards: [
        {url: "C:\CarPositionBrisbane.HTML", time: 5},
        {url: "C:\CarPositionCaboolture.HTML", time: 5},
        {url: "C:\CarPositionLogan.HTML", time: 5},
        {url: "C:\CarPositionWarwick.HTML", time: 5},
        {url: "C:\CarPositionHobart.HTML", time: 5},
        {url: "C:\CarPositionToowoomba.HTML", time: 5},
        {url: "C:\CarPositionIpswich.HTML", time: 5},
        {url: "C:\CarPositionYeppoon.HTML", time: 5},

    ],

    display: function()
    {
        var dashboard = Dash.dashboards[Dash.nextIndex];
        frames["displayArea"].location.href = dashboard.url;
        Dash.nextIndex = (Dash.nextIndex + 1) % Dash.dashboards.length;
        setTimeout(Dash.display, dashboard.time * 1000);
    }
};

window.onload = Dash.display;
</script>
</head>
<body>
<iframe name="displayArea" width="100%" height="100%"></iframe>
</body>
</html> 
```

它在谷歌浏览器中运行良好，但我需要让它在 IE8 中运行，因为它需要在 XP 机器上运行。

当我在 IE 中运行以下代码时，我只是得到一个空白屏幕。

有什么建议么？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:37:53.857

您的仪表板列表中有一个尾随逗号。所有 IE 版本都非常严格地解析 JavaScript，并且不允许在列表和对象中使用尾随逗号。

检查 JavaScript 源代码的一种非常有效的方法是使用[JSHint](http://www.jshint.com/)，它会报告此类错误。

您需要修复以下代码部分：

```
// quoting of the "\" in the URLs fixed.
dashboards: [
    {url: "C:\\CarPositionBrisbane.HTML", time: 5},
    {url: "C:\\CarPositionCaboolture.HTML", time: 5},
    {url: "C:\\CarPositionLogan.HTML", time: 5},
    {url: "C:\\CarPositionWarwick.HTML", time: 5},
    {url: "C:\\CarPositionHobart.HTML", time: 5},
    {url: "C:\\CarPositionToowoomba.HTML", time: 5},
    {url: "C:\\CarPositionIpswich.HTML", time: 5},
    {url: "C:\\CarPositionYeppoon.HTML", time: 5} // <--- comma removed
], 
```

window.onload 在 IE8 中不起作用：在 IE8 中[不起作用 window.onload](https://stackoverflow.com/questions/7058343/does-not-work-window-onload-in-ie8)

我建议您使用 jQuery 或任何其他处理此类浏览器差异的 JavaScript 库。使用 jQuery 就像编写一样简单。

```
$(function() {
    // insert code here that should be run when the document is ready.
}); 
```

# javascript - 用于更改元素上的 css 的 Javascript 是什么？

> ID：14573248
> 
> 赞同：1
> 
> 时间：2013-01-28T23:36:54.073
> 
> 标签：javascript, jquery, html, css

我有一个无法工作的 JSFiddle 示例：http: [//jsfiddle.net/bjacobs/KDVvN/28/](http://jsfiddle.net/bjacobs/KDVvN/28/)

我希望元素在鼠标悬停时有一只张开的手（这有效），当鼠标点击它时有一只闭合的手（我无法开始工作）。

我知道我在 javascript 中做错了什么。任何人都可以帮忙吗？

Javascript：

```
 $(function () {
    $(".dragbox h2").on("mousedown", function (evt) {
        $(this).addClass('grabbing');
    }).on("mouseup", function (evt) {
        $(this).removeClass('grabbing');
    });
  }); 
```

CSS：

```
.dragbox {
    margin:0px 2px 2px;
    background:#fff;
    position:relative;
}
.dragbox h2 {
    font-size:15px;
    cursor: grab;
    cursor:-webkit-grab;
    cursor:-moz-grab;
    cursor: url(https://mail.google.com/mail/images/2/openhand.cur), default !important;
}
.dragbox h2.grabbing {
    cursor: grabbing;
    cursor:-webkit-grabbing;
    cursor:-moz-grabbing;
    cursor: url(https://mail.google.com/mail/images/2/closedhand.cur), default !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:45:56.540

阅读这篇文章：
[http](http://www.sitepoint.com/css3-cursor-styles/)

://www.sitepoint.com/css3-cursor-styles/也许你错过了一些“，”在'.column .dragbox h2.grabbing'

只有webkit 浏览器将支持抓取手。但是当我尝试以类似的方式使用它时，我注意到在抓取时我无法制作闭合的手形光标，因为浏览器会覆盖它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:43:37.630

它可能不适用于文本元素。尝试按钮（但显然你必须开始拖动才能使其工作）：

**你可以只用 html/css**

**在这里演示：http: [//jsfiddle.net/KDVvN/37/](http://jsfiddle.net/KDVvN/37/)**

HTML

```
<button>Test Grab!</button> 
```

CSS

```
button {
    font-size:15px;
    cursor: grab;
    cursor:-webkit-grab;
    cursor:-moz-grab;
    cursor: url(https://mail.google.com/mail/images/2/openhand.cur), default !important;
}
button:active {
    cursor: grabbing;
    cursor:-webkit-grabbing;
    cursor:-moz-grabbing;
    cursor: url(https://mail.google.com/mail/images/2/closedhand.cur), default !important;
} 
```

**或者 JS**

**在这里演示：（[http://jsfiddle.net/KDVvN/36/](http://jsfiddle.net/KDVvN/36/)）**

HTML

```
<button>Test Grab!</button> 
```

CSS

```
button {
    font-size:15px;
    cursor: grab;
    cursor:-webkit-grab;
    cursor:-moz-grab;
    cursor: url(https://mail.google.com/mail/images/2/openhand.cur), default !important;
}
button.grabbing {
    cursor: grabbing;
    cursor:-webkit-grabbing;
    cursor:-moz-grabbing;
    cursor: url(https://mail.google.com/mail/images/2/closedhand.cur), default !important;
} 
```

JS

```
$("button").on("mousedown", function (evt) {
    $(this).addClass('grabbing');
}).on("mouseup", function (evt) {
    $(this).removeClass('grabbing');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:24:31.067

问题不在于您的 JavaScript。

如果我完全复制您的代码并创建自己的测试页面，它就可以工作。

从我的元素中添加和删除样式“ *grabbing ”。*`<h2>`

我可以看到在 FireBug 中添加和删除的样式。

问题是，光标没有改变。

这让我认为两件事之一是正确的：

1.  你的CSS不正确
2.  这些光标样式不能应用于`<h2>`元素（或者当鼠标悬停在文本上时它们不能应用）

尝试打开调试器，您可能会看到同样的情况。

我的猜测是某些游标只在某些浏览器的某些地方工作......

也许您会在其中一篇文章中找到解释您所看到内容的内容：

*   [当用户将鼠标悬停在链接上时，更改 Chrome 中的光标样式失败](https://stackoverflow.com/questions/6046935/changing-cursor-style-in-chrome-fails-when-user-is-hovering-over-a-link)

*   [http://www.quirksmode.org/css/cursor.html](http://www.quirksmode.org/css/cursor.html)

*   [http://code.google.com/p/chromium/issues/detail?id=26723](http://code.google.com/p/chromium/issues/detail?id=26723)

# linux - 将 ls 输出转换为 csv

> ID：14573262
> 
> 赞同：13
> 
> 时间：2013-01-28T23:38:19.857
> 
> 标签：linux, unix, csv, find

我将如何转换：

```
$ find . -ls > /tmp/files.txt 
```

这给了我类似的东西：

```
908715       40 -rwxrwxr-x    1 david            staff               16542 Nov 15 14:12 ./dump_info.py
908723        0 drwxr-xr-x    2 david            staff                  68 Nov 20 17:35 ./metadata 
```

进入 csv 输出？它看起来像：

```
908715,40,-rwxrwxr-x,1,david,staff,16542,Nov 15 14:12,./dump_info.py
908723,0,drwxr-xr-x,2,david,staff,68,Nov 20 17:35,./metadata 
```

以下是文件名中带有空格的示例标题：

```
652640,80,-rw-rw-r--,1,david,staff,40036,Nov,6,15:32,./v_all_titles/V Catalog Report 11.5.xlsx 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T00:10:32.503

在命令行中输入有点长，但它正确地保留了文件名中的空格（并引用它！）

```
find . -ls | python -c '
import sys
for line in sys.stdin:
    r = line.strip("\n").split(None, 10)
    fn = r.pop()
    print ",".join(r) + ",\"" + fn.replace("\"", "\"\"") + "\""
' 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-28T23:40:42.860

如果您不关心日期中的空格：

```
$ find . -ls | tr -s ' ' , 
```

如果您确实关心这些空间：

```
$ find . -ls | awk '{printf( "%s,%s,%s,%s,%s,%s,%s,%s %s %s,%s\n", $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11 )}' 
```

如果您的文件名包含任何空格，则这些都不起作用。作为处理文件名中空格的技巧，您可以尝试：

```
 ... | sed 's/,/ /8g' 
```

摆脱除前 8 个逗号之外的所有逗号（假设您像 gnu sed 那样`sed`支持非标准选项）。`8g`当然，这不会处理文件名中的逗号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-18T13:57:29.563

还有另一个变体。[请参阅find](http://manpages.ubuntu.com/manpages/trusty/en/man1/find.1.html)手册页中的“-printf 格式”部分进行自定义。

```
$ find . -type f -fprintf /tmp/files.txt "%i,%b,%M,%n,%u,%g,%s,%CY-%Cm-%Cd %CT,%p\n" 
```

示例输出：

```
$ less /tmp/files.txt

3414558,40,-rw-rw-r--,1,webwurst,webwurst,16542,2014-09-18 15:54:36.9232917780,./dump_info.py
3414559,8,-rw-rw-r--,1,webwurst,webwurst,68,2014-09-18 15:54:51.1752922580,./metadata 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-05T06:46:24.950

这是我起草的python脚本......

```
#!/opt/app/python/bin/python
# Convert ls output to clean csv    Paolo Villaflores 2015-03-16
#
# Sample usage: ls -l | ls2csv.py
#
# Features:
#   accepts -d argument to change dates to yyyy-mm-dd_hhmm format
#   input is via stdin
#   separate file/directory field
#   handle -dils type input (find -ls) versus -l
#   handle space in filename, by applying quotes around filename
#   handle date - format into something excel can handle correctly, whether it is from current year or not.
#   adds a header
#   handle symlinks - type l

import sys
from datetime import datetime

b0=True

def is_f(s):
  if s == '-':
    return 'f'
  return s

for line in sys.stdin:
    if len(line) < 40:
      continue
    if b0:
      b1=line[0] in ['-', 'd', 'c', 'l'] # c is for devices e.g. /devices/pseudo/pts@0:5, l is for symbolic link
      b0=False
      if b1:  # true when shorter ls -l style 8/9 columns. 9 for symlink
        cols=7
        print "d,perms,#links,owner,group,size,modtime,name,symlink"
      else:
        cols=9
        print "inode,bsize,d,perms,#links,owner,group,size,modtime,name,symlink"
    r = line.strip("\n").split(None, cols+1)
    if len(r) < cols+1:
      continue
    if r[cols-7][0] == 'c':
       continue  # ignore c records: devices
    fn = r.pop()
    if b1:
      c = ''
    else:
      c = ",".join(r[0:2]) + ","
    z = 0
    z = r[cols].find(':')
    if z < 0:
      d = r[cols - 1] + "/" + r[cols - 2] + "/" + r[cols]
    else:
      n = str(datetime.now()  )
      d = ''
      # handle the case where the timestamp has no year field
      tm=datetime.strptime(r[cols-2]+ " " + r[cols-1]+ " " + n[:4] +" " + r[cols], "%b %d %Y %H:%M")
      if (tm-datetime.now()).days > 0:
        d = r[cols - 1] + "/" + r[cols - 2] + "/" + str((datetime.now().year-1)) + " " + r[cols]
        tm=datetime.strptime(r[cols-2]+ " " + r[cols-1]+ " " + str(int(n[:4])-1) +" " + r[cols], "%b %d %Y %H:%M")
      else:
        d = r[cols - 1] + "/" + r[cols - 2] + "/" + " ".join([n[:4], r[cols] ] )
      if len(sys.argv) > 1 and sys.argv[1] == '-d':
        d=tm.strftime("%Y-%m-%d_%H%M")

    y = fn.find(">")
    symlink=''
    if y > 0:
       symlink = ',\"' + fn[y+2:] + '"'
       fn = fn[:y-2]
    if  fn.find( " ") <0:
      if fn.find('"') <0:
        fn2=fn
      else:
        fn2="'" + fn + "'"
    else:
      fn2="'" + fn + "'"
    print c+ is_f(r[cols-7][0]) + ",\"" + r[cols-7][1:] + "\"," + ",".join(
      r[cols-6:cols-2]) + "," + d + "," + fn2 + symlink 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-28T23:49:52.907

这应该做的工作

```
 find . -ls|awk 'BEGIN{OFS=","}$1=$1' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-17T14:44:44.710

```
ls target 

boto3-1.11.3-py2.py3-none-any.whl
engagment-states-batch-rds-loader-0.1.27.whl
mypy_extensions-0.4.3-py2.py3-none-any.whl
mysql_connector_python-8.0.15-cp36-cp36m-macosx_10_13_x86_64.whl
pandas-0.25.3-cp36-cp36m-macosx_10_9_x86_64.whl
retrying-1.3.3-py3-none-any.whl
structlog-19.2.0-py2.py3-none-any.whl
typing-3.7.4.1-py3-none-any.whl

echo $(ls target) | tr ' ' ,

boto3-1.11.3-py2.py3-none-any.whl,engagment-states-batch-rds-loader-0.1.27.whl,mypy_extensions-0.4.3-py2.py3-none-any.whl,mysql_connector_python-8.0.15-cp36-cp36m-macosx_10_13_x86_64.whl,pandas-0.25.3-cp36-cp36m-macosx_10_9_x86_64.whl,retrying-1.3.3-py3-none-any.whl,structlog-19.2.0-py2.py3-none-any.whl,typing-3.7.4.1-py3-none-any.whl 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-05-19T12:07:06.090

你可以使用`sed -r`

```
(
_space_="\ *";
type=".";
perm="[^\ ]*";
hlinks=$perm;
user=$perm;
group=$perm;
size="[0-9]*";
modified=".{12}";
name=".*";
ls -l /etc | sed -r s/"^($type)($perm)$_space_($hlinks)$_space_($user)$_space_($group)$_space_($size)$_space_($modified)$_space_($name)"/'"\1","\2","\3","\4","\5","\6","\7","\8"'/g
) 
```

# http - HTTP 客户端错误请求 400

> ID：14573264
> 
> 赞同：2
> 
> 时间：2013-01-28T23:38:26.277
> 
> 标签：http, netbeans, get, httpclient, bad-request

我正在尝试了解 HTTP 客户端如何在 Java 中工作。我正在尝试构建自己的客户端，该客户端将向 Web 服务器请求 php 文件。

目前，当我发出请求时，服务器会给我以下错误：

**HTTP/1.1 400 错误请求**

但是，我可以从浏览器中访问该文件没问题。我不知道我可能做错了什么，但我无法弄清楚。下面是我的 HTTP 客户端类的代码：

```
public class MyHttpClient {

MyHttpRequest request;
String host;

public MyHttpResponse execute(MyHttpRequest request) throws IOException {

    //Creating the response object
    MyHttpResponse response = new MyHttpResponse();

    //Get web server host and port from request.
    String host = request.getHost();
    int port = request.getPort();

    //Check 1: HOST AND PORT NAME CORRECT!
    System.out.println("host: " + host + " port: " + String.valueOf(port));

    //Get resource path on web server from requests.
    String path = request.getPath();

    //Check 2: ENSURE PATH IS CORRECT!
    System.out.println("path: " + path);

    //Open connection to the web server
    Socket s = new Socket(host, port);

    //Get Socket input stream and wrap it in Buffered Reader so it can be read line by line.
    BufferedReader inFromServer = new BufferedReader(new InputStreamReader(s.getInputStream()));

    //Get Socket output stream and wrap it in a Buffered Writer so it can be written to line by line.
    PrintWriter outToServer = new PrintWriter(s.getOutputStream(),true);

    //Get request method
    String method = request.getMethod();

    //Check 3: ENSURE REQUEST IS CORRECT GET/POST!
    System.out.println("Method: " + method);

    //GET REQUEST
    if(method.equalsIgnoreCase("GET")){
        //Send request to server
        outToServer.println("GET " + path + " HTTP/1.1 " + "\r\n");
        String line = inFromServer.readLine();
        System.out.println("Line: " + line);
    }

    //Returning the response
    return response;
} 
```

}

如果有人能对这个问题有所了解，我将不胜感激！谢谢。

对服务器的新请求：

```
outToServer.print("GET " + path+ " HTTP/1.1" + "\r\n");
outToServer.print("Host: " + host + "\r\n");
outToServer.print("\r\n"); 
```

回复：

方法：获取

```
line: <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
line: <html><head>
line: <title>400 Bad Request</title>
line: </head><body>
line: <h1>Bad Request</h1>
line: <p>Your browser sent a request that this server could not understand.<br />
line: </p>
line: <hr>
line: <address>Apache Server at default.secureserver.net Port 80</address>
line: </body></html>
line: null 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:14:59.573

不要使用 PrintWriter。你必须写 ascii 字符。

```
 s.getOutputStream().write(("GET " + path + " HTTP/1.1\r\n\r\n").getBytes("ASCII")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:43:46.310

我认为您至少需要在`Host`请求中添加标头。

示例取自[http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)

```
GET /index.html HTTP/1.1
Host: www.example.com 
```

标头完成后，您还需要传输额外`\r\n`的，以便服务器知道请求已完成。

不要使用`println`但是`print`。`println`为每一行添加另一个`\n`，导致行以 . 结尾`\r\n\n`。

# javascript - 使用 Jquery 将鼠标悬停在元素的前 24 个子元素上

> ID：14573269
> 
> 赞同：2
> 
> 时间：2013-01-28T23:38:40.177
> 
> 标签：javascript, jquery, jquery-selectors

我想在前 24 个子元素上添加悬停，在另一个元素的 24 个单独元素上添加填充。

像这样：

```
$('tr td:nth-child(1)').mouseover(function(){
  $('rect:nth-of-type(1)').css("fill", "black" );
});

$('tr td:nth-child(2)').mouseover(function(){  
  $('rect:nth-of-type(2)').css("fill", "black" );
});

$('tr td:nth-child(3)').mouseover(function(){
  $('rect:nth-of-type(3)').css("fill", "black" );
}); 
```

但我不想重复自己24次。处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T23:41:31.917

看一下`lt`选择器：

```
$('tr td:lt(24)') 
```

[http://api.jquery.com/lt-selector/](http://api.jquery.com/lt-selector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:40:24.587

```
$('tr td:lt(24)').mouseenter(function(){

   var index = $(this).index();
   $('rect').eq( index ).css("fill","black");

}); 
```

如果您没有超过 24 个元素，则不需要`:lt()`选择器

[圣经](http://api.jquery.com/category/selectors/)

您还可以使用 JS 方法`.slice()`，例如：

```
$('tr td').slice(0,24) 
```

您还可以使用`.eq()`( 或`:eq()-selector`) 定位所需的元素，而不是使用之前的元素集合`.prevAll()`

```
$('tr td:eq(24)').prevAll() 
```

使用目标元素选择器始终尽可能具体 `#ID`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:53:08.690

在封闭表上使用事件委托会更好地执行：

```
$('#mytable').on('mouseover', 'td:lt(24)', function() {
    var n = $(this).index();
    $('rect').eq(n).css('fill', 'black');
}); 
```

这比将相同的函数绑定到每个匹配元素更有效。

# entity-framework - 实体框架和代码优先生成的更改表

> ID：14573270
> 
> 赞同：0
> 
> 时间：2013-01-28T23:38:49.317
> 
> 标签：entity-framework, ef-code-first, code-first, t4

我知道如果您使用 Model First，您可以更改用于使用 Entity Framework 5.0 生成类的 T4 模板。当您首先使用代码时，您将如何更改用于生成表格的模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T04:27:26.063

使用 Code First 时，没有用于生成表格的模板。要设置表名，您可以使用[TableAttribute](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.tableattribute)或在[OnModelCreating](http://msdn.microsoft.com/en-us/library/gg679267%28v=VS.103%29.aspx)覆盖中使用[ToTable 方法](http://msdn.microsoft.com/en-us/library/gg679488%28v=VS.103%29.aspx)为给定实体配置表。

# gwt - CellTable GWT 没有以正确的高度显示

> ID：14573272
> 
> 赞同：0
> 
> 时间：2013-01-28T23:39:13.470
> 
> 标签：gwt, gwt-2.5

我已经创建了一个 CellTable 并且工作正常，但是当我尝试插入一个没有元素或空格的新行时，看起来像这样。

![在此处输入图像描述](../Images/fe0bef606400f1d3364a55255fcf8697.png)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T05:53:20.593

如果只插入空行，高度将小于其他行。使用 CSSResource 并设置`tr`适当高度的样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T07:30:27.290

当您插入一个空行时，请尝试在其中插入一个 HTML 空间来初始化高度。像`&nbsp;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T09:27:17.850

是的，感谢 Abhijith Nagaraja。这就是我的css现在的样子。

```
 .cellTable tbody td{
        height: 13px;
    } 
```

非常感谢。

# string - 替换字符串的前 N 个点

> ID：14573274
> 
> 赞同：6
> 
> 时间：2013-01-28T23:39:32.000
> 
> 标签：string, r

我希望`my.string`在`region = 2`. 所有其他点应保持原样。

```
df.1 = read.table(text = "
  city  county  state region                        my.string reg1 reg2
   1      1        1      1    123456789012345678901234567890   1    0
   1      2        1      1    ...................34567890098   1    0
   1      1        2      1    112233..............0099887766   1    0
   1      2        2      1    ..............2020202020202020   1    0
   1      1        1      2    ..............00..............   0    1
   1      2        1      2    ..............0987654321123456   0    1
   1      1        2      2    ..............9999988888777776   0    1
   1      2        2      2    ..................555555555555   0    1
", sep = "", header = TRUE, stringsAsFactors = FALSE)

df.1 
```

我认为这里没有问过这个问题。抱歉，如果有。也很抱歉没有花更多时间寻找解决方案。快速的谷歌搜索没有找到答案。我之前确实在这里问过一个类似的问题：[R：从字符串中删除最后三个点](https://stackoverflow.com/questions/11127010/r-removing-the-last-three-dots-from-a-string) 谢谢您的帮助。

我应该澄清一下，我只想删除字符串最左侧的 14 个连续点。如果字符串以数字开头，后跟 14 个点，那么这 14 个点应该保持原样。

以下是`my.string`外观：

```
123456789012345678901234567890
...................34567890098
112233..............0099887766
..............2020202020202020
0000000000000000..............
000000000000000987654321123456
000000000000009999988888777776
00000000000000....555555555555 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-28T23:56:32.360

你有没有尝试过：

```
sub("^\\.{14}", "00000000000000", df.1$my.string ) 
```

对于有条件的替换尝试：

```
> df.1[ df.1$region ==2, "mystring"] <- 
               sub("^\\.{14}", "00000000000000", df.1$my.string[ df.1$region==2] )
> df.1
  city county state region                      my.string reg1 reg2
1    1      1     1      1 123456789012345678901234567890    1    0
2    1      2     1      1 ...................34567890098    1    0
3    1      1     2      1 112233..............0099887766    1    0
4    1      2     2      1 ..............2020202020202020    1    0
5    1      1     1      2 ..............00..............    0    1
6    1      2     1      2 ..............0987654321123456    0    1
7    1      1     2      2 ..............9999988888777776    0    1
8    1      2     2      2 ..................555555555555    0    1
                        mystring
1                           <NA>
2                           <NA>
3                           <NA>
4                           <NA>
5 0000000000000000..............
6 000000000000000987654321123456
7 000000000000009999988888777776
8 00000000000000....555555555555 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-28T23:57:54.980

```
 gsub('^[.]{14,14}',paste(rep(0,14),collapse=''),df.1$my.string)
"123456789012345678901234567890" "00000000000000.....34567890098" "112233..............0099887766"
[4] "000000000000002020202020202020" "0000000000000000.............." "000000000000000987654321123456"
[7] "000000000000009999988888777776" "00000000000000....555555555555" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-29T00:01:59.093

dwin 的回答很棒。这是一个很容易理解但几乎没有那么漂亮的

```
# restrict the substitution to only region == 2..
# then replace the 'my.string' column with..
df.1[ df.1$region == 2 , 'my.string' ] <- 

    # substitute.. (only the first instance!)
    # (use gsub for multiple instances)
    sub( 
        # fourteen dots
        '..............' , 
        # with fourteen zeroes
        '00000000000000' , 
        # in the same object (also restricted to region == 2
        df.1[ df.1$region == 2 , 'my.string' ] , 
        # and don't use regex or anything special.
        # just exactly 14 dots.
        fixed = TRUE 
    ) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-29T00:09:54.407

一个`data.table`解决方案：

```
require(data.table)
dt <- data.table(df.1)

# solution:
dt[, mystring := ifelse(region == 2, sub("^[.]{14}", 
                   paste(rep(0,14), collapse=""), my.string), 
                   my.string), by=1:nrow(dt)]

#    city county state region                      my.string reg1 reg2                       mystring
# 1:    1      1     1      1 123456789012345678901234567890    1    0 123456789012345678901234567890
# 2:    1      2     1      1 ...................34567890098    1    0 ...................34567890098
# 3:    1      1     2      1 112233..............0099887766    1    0 112233..............0099887766
# 4:    1      2     2      1 ..............2020202020202020    1    0 ..............2020202020202020
# 5:    1      1     1      2 ..............00..............    0    1 0000000000000000..............
# 6:    1      2     1      2 ..............0987654321123456    0    1 000000000000000987654321123456
# 7:    1      1     2      2 ..............9999988888777776    0    1 000000000000009999988888777776
# 8:    1      2     2      2 ..................555555555555    0    1 00000000000000....555555555555 
```

# c# - Xml 记录 EF 代码优先表

> ID：14573288
> 
> 赞同：0
> 
> 时间：2013-01-28T23:40:45.980
> 
> 标签：c#, visual-studio, entity-framework, ef-code-first

我知道我可以使用如下语法记录我的表格：

```
/// <summary>
/// Insert table description here.
/// </summary>
public class SomeTable
{
    public int someNumber { get; set; }
    public string someString { get; set; }
} 
```

当我像这样使用表时，它将显示适当的摘要：`IQueryable<SomeTable> query;`但是，如果我要在 LINQ 中使用表：

```
var query = from p in db.SomeTable
            select p; 
```

我不会得到该表的任何智能感知描述。显然，解决方案是`public DbSet<SomeTable> SomeTable { get; set; }`在我的 DbContext 中使用相同的描述记录该行，但从长远来看，这似乎不太容易维护。有没有一种方法可以让我得到我想要的东西，而不必为每一张桌子重复自己？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:15:50.113

XML 文档对 IntelliSense 没有多大作用（如果您只讨论代码完成 - 我知道如果您记录您的方法/属性，您会得到一个包含该信息的额外弹出窗口）。

但是顺序真的很重要。例如，如果您说：

```
var invoices = from inv in db.Invoices
               join cust in db.Customers on inv.CustomerId equals cust.CustomerId
               where cust.CustomerId == myCustId
               select inv; 
```

那么您将获得整个 IntelliSense。但是，如果您颠倒了联接的条件（cust.CustomerId 等于 inv.CustomerId），那么您将不会获得该条件的任何 IntelliSense。

编辑：刚刚注意到 OP 主要对 IntelliSense **description**感兴趣。没有自动化的方法可以做到这一点，因为您基本上希望在另一个类的属性上查看您的类的描述。

属性和类应该有单独的描述。如果酒店不仅仅归还餐桌怎么办？

# ruby-on-rails - 带有图像的简单表单关联标签

> ID：14573289
> 
> 赞同：2
> 
> 时间：2013-01-28T23:40:49.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3, simple-form

我想在简单的表单关联上显示礼物上的图像

我尝试使用此代码，`label_method`但它不起作用：

```
<%=f.association :gift, :collection=> Gift.all, :label_method=>lambda { |gift| "#{gift.name}  #{image_tag 'gift.photo.url(:small)'}" }, :value_method=> :id, :as=>:radio_buttons%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2020-03-19T02:12:39.293

此代码可以帮助您，显示带有图像的复选框

```
<%= f.association :gift,
             :as => :check_boxes,
             item_wrapper_tag: :div,
             item_wrapper_class: "image-select",
             :collection => Gift.all,
             :label => false,
             :inline_label => false,
             :include_blank => false,
             :input_html => {multiple: true},
             :label_method => lambda { |b| image_tag(b.photo.url) },
             value_method: :id
           %> 
```

如果您正在使用字符串，请不要忘记使用 html_safe

# c# - 类型是什么？

> ID：14573292
> 
> 赞同：-1
> 
> 时间：2013-01-28T23:41:05.680
> 
> 标签：c#, types

我有一个问题要`Type`在我的代码中定义。让我们从 Abc 开始。

```
public partial class Abc {
    public static String AbcName="wtf";

    public String Name {
        get;
        set;
    }
} 
```

好的，***`Abc`完成了***。之后是测试课。而且我需要返回带有 的实例的对象或类型`MyClass`，这里是

```
 public partial class MyClass {
        public const BindingFlags
            Universal=BindingFlags.NonPublic|BindingFlags.Public,
            WithObject=Universal|BindingFlags.Instance,
            WithClass=WithObject|BindingFlags.Static,
            ForGive=Universal|BindingFlags.SetProperty|BindingFlags.SetField,
            ForGet=Universal|BindingFlags.GetProperty|BindingFlags.GetField,
            ForDo=BindingFlags.InvokeMethod|WithObject|WithClass;

        public MyClass GetTypeImpl() {
            if(null!=target)
#if TARGET_AS_TYPE
                return new MyClass(target as Type??target.GetType());
#else
                return new MyClass(target.GetType());
#endif
            else
                return new MyClass(typeof(object));
        }

        public object GetValue(String name) {
            var invokeAttr=ForGet|WithClass;
            var type=(Type)this.GetTypeImpl().target;
            return type.InvokeMember(name, invokeAttr, default(Binder), target, default(object[]));
        }

        public MyClass(object x) {
            this.target=x;
        }

        public object target;
    } 
```

请注意，代码用于代表我的班级。`GetValue`真正的代码是在内部调用的，消费代码永远不会得到除了`MyClass`. 也就是说，***在实际代码中，每个方法`MyClass`实际上都是返回一个`MyClass`***. 在这里，我们看到条件编译，带有`TARGET_AS_TYPE`，这就是这个问题的重点。

考虑以下测试代码

```
 public partial class TestClass {
        public static void TestMethod() {
            var abc=
                new Abc {
                    Name="xyz"
                };

            var x=new MyClass(abc);
            var abcName=x.GetValue("Name");
            var y=new MyClass(x.GetTypeImpl().target);

#if TARGET_AS_TYPE
            var wtf=y.GetValue("AbcName");
            var fullName=y.GetValue("FullName"); // exception thrown
#else
            var fullName=y.GetValue("FullName"); 
            var wtf=y.GetValue("AbcName"); // exception thrown
#endif
        }
    } 
```

无论我们是否定义`TARGET_AS_TYPE`，***测试总是在第二行用`#if`or`#elseif`块***抛出异常。我认为这是因为`Type`or `RuntimeType`，但我无法定义它。那么，***如何纠正它（在 GetTypeImpl 中）并让它在没有条件编译的情况下始终工作***？

以下方式受到限制，或者我已经完成了没有效果。

*   使用`BindingFlags.FlattenHierarchy`- 不工作
*   泛型声明`MyClass<T>`- 不起作用
*   不要用实例扭曲类型或对象`MyClass`- 你一定是在开玩笑......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:19:17.420

考虑以下代码：

```
Abc a = new Abc { Name = "a" };

Type t = a.GetType();

BindingFlags staticField = BindingFlags.Static | 
                           BindingFlags.Public | 
                           BindingFlags.GetField;
BindingFlags instanceProperty = BindingFlags.Instance | 
                                BindingFlags.Public | 
                                BindingFlags.GetProperty;

//prints a
t.InvokeMember("Name", instanceProperty, default(Binder), a, null);
//prints wtf
t.InvokeMember("AbcName", staticField, default(Binder), a, null);
//throws an exception as there is no member FullName in MyClass
t.InvokeMember("FullName", instanceProperty, default(Binder), a, null);

Type tt = t.GetType();
//prints t.FullName, that is YourNamespace.Abc
tt.InvokeMember("FullName", instanceProperty, default(Binder), t, null); 
```

它显示了您在 IMO 遇到的问题。您不能通过反射描述类`Type`的类型的对象访问类的成员，因为没有这些成员。`Type``MyClass``MyClass`

您需要使用`Type`描述类的对象`Type`（即）通过反射`a.GetType().GetType()`访问其成员（此处）并将描述类类型的对象传递给。`FullName``Type``MyClass``InvokeMember`

* * *

根据评论，我想在 type 对象上发布相同的示例`System.Object`：

```
object o = new object();
Type ot = o.GetType();

BindingFlags instanceMethod = BindingFlags.Instance | 
                                BindingFlags.Public | 
                                BindingFlags.InvokeMethod;

//prints System.Object
ot.InvokeMember("ToString", instanceMethod, default(Binder), o, null);
//throws an exception, 
//as there is obviously also no FullName in class System.Object
ot.InvokeMember("FullName", instanceProperty, default(Binder), o, null); 
```

# mysql - 将我的 MySQL SQL 语句更改为 MS SQL

> ID：14573294
> 
> 赞同：0
> 
> 时间：2013-01-28T23:41:19.223
> 
> 标签：mysql, sql-server

谁能帮我将此 MySQL 语句转换为 MS SQL 以在 SQL 2008 R2 上运行？

```
SELECT UNIX_TIMESTAMP(summary.date) as epoch_date,
round(SUM(CASE WHEN meters.group != '' THEN kWh ELSE 0 END),2) as total,
round(SUM(CASE WHEN meters.group = 'eastern' THEN kWh ELSE 0 END),2) as eastern,
round(SUM(CASE WHEN meters.group = 'western' THEN kWh ELSE 0 END),2) as western,
round(SUM(CASE WHEN meters.group = 'central' THEN kWh ELSE 0 END),2) as central
FROM summary, meters
WHERE summary.webmeterID = meters.webmeterID
AND date BETWEEN
DATE_SUB(CURRENT_DATE, INTERVAL 3 YEAR) 
AND DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
GROUP by date 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:26:32.457

```
SELECT

CASE

WHEN DATEDIFF(second,'1970-01-01 00:00:00',summary.[date])>0

THEN DATEDIFF(second,'1970-01-01 00:00:00',summary.[date])

ELSE

0

END as epoch_date,

round(SUM(CASE WHEN meters.[group] != '' THEN kWh ELSE 0 END),2) as total,

round(SUM(CASE WHEN meters.[group] = 'eastern' THEN kWh ELSE 0 END),2) as eastern,

round(SUM(CASE WHEN meters.[group] = 'western' THEN kWh ELSE 0 END),2) as western,

round(SUM(CASE WHEN meters.[group] = 'central' THEN kWh ELSE 0 END),2) as central

FROM summary, meters

WHERE summary.webmeterID = meters.webmeterID

AND [date] BETWEEN

DATEADD(year,-3,GETDATE())

AND DATEADD(day,-1,GETDATE())

GROUP by [date] 
```

# python - Python脚本在crontab下不起作用

> ID：14573295
> 
> 赞同：1
> 
> 时间：2013-01-28T23:41:27.490
> 
> 标签：python, linux, ubuntu, cron

我有一个非常基本的 python 脚本，每分钟通过 crontab 运行一次。

剧本

```
filed = open('test.txt','a') 
```

crontab

```
* * * * * /to path the file/job.py 
```

它应该可以工作，但我无法看到结果。那么，可能是什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-28T23:42:55.983

需要`text.txt`使用绝对路径打开；crondaemon 可能正在使用与您期望的不同的路径：

```
filed = open('/home/john/Desktop/test.txt','a') 
```

# asp.net - MVC4不正确的模型错误

> ID：14573301
> 
> 赞同：1
> 
> 时间：2013-01-28T23:42:13.553
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4, asp.net-mvc-5

您好我收到此错误： **传入字典的模型项的类型为“System.Collections.Generic.List`1[DBModel.Telemarketing]”，但该字典需要“TWeb.Models.LoginModel”类型的模型项**

在 _Layout.cshtml 文件中我有

```
@Html.Partial("_LoginPartial") 
```

此部分登录视图在 _layout 页面上的 div 中呈现（它使用 javaScripts 隐藏/显示）

```
@model TWeb.Models.LoginModel 
```

然后我有“电话营销”控制器有视图：

```
public class TelemarketingController : Controller
{
    private Entities db = new Entities();

    //
    // GET: /Telemarketing/

    public ActionResult Index()
    {
        return View(db.Telemarketings.ToList());
    } 
```

当我单击 _Layout 页面中的链接时

```
@Html.ActionLink("Telemarketingas", "Index", "Telemarketing", new{area="" },new{ }) 
```

它会抛出一个写在帖子顶部的错误。

我是MVC的新手，请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:49:47.950

您的“_LoginPartial”需要“LoginModel”模型，但由于您没有提供任何模型，Razor 引擎将其模型设置为当前视图模型（“db.Telemarketings.ToList()”）。

你所要做的就是以某种方式设置它的模型，可能是这样的：

```
@Html.Partial("_LoginPartial", new LoginModel()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-28T23:52:24.883

**问题 1）**您的 Partial 需要一个模型，而您没有通过一个模型。正确的语法：`@Html.Partial("_LoginPartial", Model.LoginModel)`

**问题2）** _layout，据我所知，不能通过模型

**解决方案 1：** 使用 ActionPartial。AcionPartials 的调用方式类似，

```
@Html.Action("/Tools/_LoginPartial"). 
```

不同之处在于它们有一个 ActionMethod Associated 可以返回一个模型

```
 public ActionResult _LoginPartial()
    {

          LoginModel Model= new LoginModel();
          //populate Model from whatever

         return View(Model);

    } 
```

**选项 2：** 将 LoginModel 对象传递给 Viewbag

```
Viewbag.LoginModel = new LoginModel(); 
```

并在 _layout 的 Partial 中引用 Viewbag

```
@Html.Partial("_LoginPartial", Viewbag.LoginModel) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T05:55:13.963

最简单的方法是从 Login Div 中删除模型声明 :)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T06:07:26.203

您可以使用此代码

```
 @Html.Partial("Partial page", new ModelFroLogin()) 
```

# javascript - javascript 不工作-> 选中

> ID：14573303
> 
> 赞同：0
> 
> 时间：2013-01-28T23:42:31.623
> 
> 标签：javascript, jquery, html, forms, input

在帮助下，我制作了这个函数，可以在我的 html 表单中发布所选选项的值。

在这个 jsfiddle 你可以看到代码和 html。

任何人都知道为什么这不起作用？: [http://jsfiddle.net/qqcAT/1/](http://jsfiddle.net/qqcAT/1/)

```
$(document).ready(function() {
    $("#catid").change(function() {
        var src = $(this).val();
        $(".test").html($(this).val());
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:46:58.673

`}`下次您缺少, 缩进您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:26:22.530

通过查看您的 Fiddle，您将需要这样的东西。我没有测试，但应该在它下面的分区中显示选择文本：

```
 $(function () {
$("#catid").change(function () {
  var str = "";
  $("select option:selected").each(function () {
        str += $(this).text() + " ";
      });
  $("div.test").text(str);
})
.trigger('change');
  }); 
```

# html - 样式通常以相同的组合出现：创建单个类还是组合元素？

> ID：14573306
> 
> 赞同：1
> 
> 时间：2013-01-28T23:42:42.740
> 
> 标签：html, css, coding-style, stylesheet

在我最近的一个项目中，我注意到某些样式重复出现在相同的组合中。根据 DRY 原则，我应该将这些样式结合起来。关于一个好的 CSS 样式，哪个选项更好/最好？

**选项 1**
创建一个包含这些样式的类，然后简单地将其添加到 HTML 中的相应元素中。

例子

在 HTML 中：

```
<a href='#' class="myClass">Link</a> 
```

或者

```
<ul class="myClass">
  <li>Item</li>
<ul> 
```

在 CSS 中：

```
.myClass {
  font-weight: bold;
  font-size: 14px;
  color: grey;
} 
```

**选项 2**
只需在我的 CSS 中组合所有需要该样式的元素，如下例所示。

```
a,
ul {
  font-weight: bold;
  font-size: 14px;
  color: grey;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:50:50.093

```
.myClass {
  font-weight: bold;
  font-size: 14px;
  color: grey;
} 
```

是最好的 ...

```
.myclass {
  font-weight: bold;
  font-size: 14px;
  color: grey;
} 
```

更好**（小写）**

这样，DOM 引擎将无需在文档中堆叠所有 a 和所有 ul 标记即可访问元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:09:06.407

我经常遇到同样的问题，并且已经学会了**选择 Option 2**。

首先，你需要问自己为什么这两种风格是相互关联的：你设计的这两个元素是要*始终*以相同的方式设计，**还是**只是巧合，它们的风格相同？

例如，如果你决定你的链接不应该是灰色的，而是蓝色的，你可以让你的 ul 列表也变成蓝色吗？我的意思是：链接*和*列表是否相关？他们必须看起来总是一样的吗？或者只是*发生*在这种特殊情况下，它们是相同的？

此外，您需要注意班级的**名称**。

*   如果您将其称为，则说明`.boldGrey`您做错了，因为您的类名描述的是样式，而不是内容。
*   如果您将其称为`.secondary`，则说明您做得很好，因为您描述的是内容，而不是样式。在这种情况下，使用选项 1*可以*。

但最后，**我总是选择 Option 2**。尽管您将相同的样式连接到多个元素，但如果您改变主意，之后仍然可以轻松对其进行修改。我通常将共享相同属性的元素列表放在我的 CSS 顶部（就在重置下方）。然后，我为每个元素添加特定样式。

我的网站上的示例：

```
time, code, figcaption {
  background:#f5f5f5;
  border:1px solid #e9e9e9;
  border-radius:2px;
  color:#93a1a1;
  font-size:11px;
  padding:0 4px 1px;
  white-space:nowrap;
} 
```

然后，在下面，我有一些额外的样式`code`：

```
code {
  font-size:12px;
  position:relative;
  top:-2px;
} 
```

在我设计这 3 个元素的样式时，我注意到我希望它们看起来一样。但不*完全*一样。所以我重新组合了他们所有的*共同点*，然后具体说明了他们的*特别之处*。

我可以为此使用一个课程吗？也许。但是我怎么称呼它呢？.greySmallBordered？.littleBlocks？.tag在看吗？很难想出一个**只***描述*内容而不描述样式的名称。

所以我通常在我的选择器中列出多个元素，因为：

*   这是将 HTML 中的内容与 CSS 中的样式分开的最佳方式
*   它有助于为每个元素指定额外的样式

# artificial-intelligence - 哪些是可接受的启发式方法，为什么？

> ID：14573309
> 
> 赞同：-1
> 
> 时间：2013-01-28T23:42:57.280
> 
> 标签：artificial-intelligence, computer-science, heuristics

在 nxn 网格上有 n 辆车。开始时，它们被排在第一排。车辆必须到达底排，这样 (1,n) 处的车辆必须到达 (n, n - i + 1)。在每个时间步长上，每辆车都可以向上、向下、向左或向右移动一个方格，也可以保持原地不动。如果车辆保持不动，一辆相邻的车辆（但不超过一辆）可以跳过它。两辆车不能占据同一个广场。对于将所有车辆移动到目的地的问题，以下哪些启发式是可接受的？

一世。从 1 到 n (h1 ... hn) 的总和

ii. 最大值（h1 ... hn）

iii. 分钟（h1 ...hn）

我认为 iii 是唯一正确的，但我不确定如何制定我的推理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T23:52:09.940

我相信有人会给出一个非常详细的答案，但作为对那些喜欢我的人的帮助可能会被所有人工智能所淹没，一个可接受的启发式非常简单：

***永远不会*高估实现目标的真实成本的启发式方法**

不要听起来太无情，但听起来好像您发布的问题可能来自家庭作业或作业。我不想破坏你的乐趣，弄清楚这三个启发式中的哪一个是可接受的，哪些是不可接受的——但希望一个句子的定义能帮助你。

如果您感到困惑，请记住：如果您的车辆都达到了它们的目标，您发现*实际成本*低于启发式认为的成本，那么它是*不可接受*的。

# asp.net-mvc - 在 DropDownList (MVC) 中以强类型形式显示复合文本

> ID：14573311
> 
> 赞同：1
> 
> 时间：2013-01-28T23:43:02.350
> 
> 标签：asp.net-mvc, drop-down-menu

我有类似的东西：

```
public class employee
{
    Int id;
    String Name;
    String FamilyName;
    String SecondFamilyName;
}  

public class orders
{
    Int id;
    Int employeeid;
    Int amount;
} 
```

（一个员工可以有很多订单，订单和员工通过“employeeid”属性关联）

MVC 中的强类型“创建订单”表单：

*   DropDownList 允许我在创建订单时选择合适的员工。

*   DropDownList 应该以第三种方法定义的方式显示员工姓名，它为 SecondFamilyName 不为空的员工连接“FamilyName SecondFamilyName, Name”，为另一个连接“FamilyName, Name”。

我该怎么办？使用默认的 VS 2010 模板，运行时选择“名称”以显示在 DropDownList 中。我需要复合名称，但我不知道如何...

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T15:02:58.607

我为 DropDownList 创建了一个自定义编辑模板：

```
<select id="employeeid" name="employeeid">
    <option value="">Pick an employee</option>
    @foreach (SelectListItem sli in ViewBag.Employees)
    {
        <option value="@sli.Value">@sli.Text</option>
    }
</select> 
```

它显示了我需要的字符串，并且绑定到了employeeid 字段。我能够创建新对象并根据需要显示员工姓名。

相当简单，当像我这样的人缺乏这项基本任务的技能时，这很难。MVC 是一个完全不同的新世界......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T20:25:07.517

更新 2，

工作了几个小时后，我注意到，默认情况下，VS 2010 会生成一个模板，该模板在 Create 方法中填充，其中包含员工 ID 和单个姓名......

所以，

创建方法：

*   添加 ViewBag.employeeid 和（ids，复合名称）列表

创建视图：

*   将服务器端代码替换为

    @Html.DropDownList("employeeid", String.Empty)

就这样。以前没有看到这么明显的东西，我觉得很愚蠢...

你怎么看，戴夫A？

编辑

只需添加用于构建列表的代码和复合名称：

**--> Employee html helper, 生成 SelectList (with selected item)**

```
public static class employeeHelper
{
    public static IEnumerable<SelectListItem> toSelectListItems(this IEnumerable<employee> Employees, Nullable<Int32> selectedID)
    {
        List<SelectListItem> lEmployees = new List<SelectListItem>();

        foreach (employee ee in Employees)
            lEmployees.Add(new SelectListItem
            {
                Selected = selectedID != null && ee.id == selectedID.Value,
                Text = employeeExtender.getEmployeeNames(pp),
                Value = pp.id.ToString()         
            });

        lEmployees = lEmployees.OrderBy(p => p.Text).ToList();

        return lEmployees;
    }
} 
```

**--> Employee 扩展器，获取复合名称** 使用 Stringbuilder 提高性能

```
public class employeeExtender
{
    public static String getEmployeeNames(employee e)
    {
        if (e == null)
            return null;

        StringBuilder sb = new StringBuilder();

        sb.Append(e.FamilyName.ToLower());

        if (!String.IsNullOrEmpty(e.SecondFamilyName) && e.SecondFamilyName.Trim() != String.Empty)
            sb.Append(" " + e.SecondFamilyName.ToLower());

        sb.Append(", ");
        sb.Append(e.Name.ToLower());

        //Capitalize String
        return Thread.CurrentThread.CurrentCulture.TextInfo.ToTitleCase(sb.ToString());
    }
} 
```

# macos - 日志记录不起作用。Mac 上的 Yii 框架

> ID：14573313
> 
> 赞同：0
> 
> 时间：2013-01-28T23:43:04.477
> 
> 标签：macos, logging, yii

我有一个在 Yii 框架上开发的应用程序，它完全可以在 Linux 上的 Ubuntu 11.04 上运行。我最近不得不把它移到 Mac Os 上。目前大部分时间都在工作，但日志记录功能却没有。它不是写在`/protected/runtime/application.log`. 我授予了该`/runtime`文件夹的正确权限，但仍然没有登录错误消息`application.log`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:45:27.350

首先，我会仔细检查您是否已将记录器配置为在适当的级别进行记录（例如是否启用了跟踪记录？）。

一旦我这样做并确认我的设置是正确的，但仍然没有发生日志记录，我将再次检查目录权限和所有权，以获得受保护/运行时。这是一种糟糕的做法，但您可以将 runtime/ 设置为 777 以确保它是全局可写的。如果将其更改为 777 有效，那么这是一个权限问题，您需要通过确保 Web 服务器（通常是 OSX 上的 _www/_www）可以写入目录并且您可以读取目录和其中的文件来对它们进行排序.

我在 localhost 上处理这个问题的方法是将我的用户添加到 _www 组，`chgrp -R _www`然后添加到`chmod g+rwx`我的 Yii 目录。这允许我和 apache 拥有所有访问权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T13:24:13.947

你有没有将日志记录到你的 main.php 文件中：

```
'components' => array(   
      'log' => array(
        'class' => 'CLogRouter',
        'routes'=>array(
            array(
                'class'=>'CFileLogRoute',
                'levels'=>'error, warning, info',
            ),
       ), 
```

# jquery - Jquery循环功能从孩子复制并跨页面插入到父相邻div

> ID：14573314
> 
> 赞同：1
> 
> 时间：2013-01-28T23:43:09.400
> 
> 标签：jquery, loops, blogs

我是使用 Jquery 编码的新手，并且在尝试获得以下内容时遇到了障碍 - 这是为了博客/新闻网站 - 工作 -

## HTML

```
 <div id="dog"></div>
  <div id="cat">
  <h1 id="food">text1</h1>
  </div> 
```

```
 <div id="dog"></div>
  <div id="cat">
  <h1 id="food">text2</h1>
  </div> 
```

etc / ID 重复以模拟 html 在博客前端的显示方式

* * *

## 查询

因为我只知道一点，所以我能用 jsfiddle

```
var a = $('#food').html();
var b = $('#dog').html(a); 
```

* * *

使用它，我可以从 cat 内部获取文本（“text1”）并将其复制粘贴到其父相邻元素 dog 中。

因为这适用于博客/新闻类型的网站，所以我需要在房子的每个实例上都发生这种情况，并且理想情况下也不会弄乱类，唯一可能的类例外是 h1 类。

其次，这需要能够从“cat”的h1 id中复制任何文本，但是将某些css应用于某些文本值，例如'news''column title 2'等的唯一css - 我熟悉css所以我不需要它在 jquery 中执行 css，并且如果它将文本的某些唯一值定向到适当的 css 值，我会更喜欢。

请帮忙，因为我已经坚持了好几天了，还有更多的 jquery 东西可以应用于该网站:(。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:49:50.987

您需要清理您的标记，以便元素具有唯一的 ID（最好使用类）。但是，如果绝对必要，您仍然可以使用 id 属性选择器执行此操作：

```
$("[id=food]").each(function () {
   $(this).parent().prev('[id=dog]').html($(this).html());
}); 
```

# php - 使用关联数组创建循环

> ID：14573317
> 
> 赞同：0
> 
> 时间：2013-01-28T23:43:25.747
> 
> 标签：php, variables, loops, associative-array

我想把它放在一个循环中，因为它需要重复 6 次，使用变量变量是不是一种不好的做法？我需要关联数组吗？

基本上，变量内的'c1'需要逐渐变为'c2'，'c3'......等

```
<?php if ($pm_c1_djwd !== '') { ?>

<div>
   <span style="width:<?php echo $pm_width_c1;?>%"></span>
   <span><?php echo $pm_description_c1; ?></span>
</div>

<?php } ?> 
```

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:58:53.523

为什么不尝试常规数组？

```
<?php
// Warning: Typed raw in the textarea
$pm_width = array(100, 100, 100, 100, 100, 100);

$pm_description = array(
  "Gizmo",
  "Doodad",
  "Widget",
  "Dohicky",
  "Thing-me-a-bob",
  "Marvelous toy my father gave to me."
);

$pm_c1_djwd = "Snod";

if ($pm_c1_djwd !== '') {

  for ($i = 0; $i < count($pm_description); $i++) {
    $width = $pm_width[$i];
    $desc = $pm_description[$i];

    echo "<div>";    
    echo "<span style='width:${width}%'>$desc</span>";     
    echo '</div>';
    echo PHP_EOL;
  }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:07:25.273

而不是每个字段都有一个变量`$pm_description_c1`，`..c2`等等，把它们放在一个关联数组中：

```
$pms = array(
    array('description' => 'your description', 'width' => '123px', 'djwd' = 'what'),
    array('description' => 'Second item', 'width' => '123px', 'djwd' = '')
); 
```

然后遍历它们：

```
<?php
foreach ($pms as $pm) {
    if ($pm['djwd' !== '') {
    ?>
        <div>
            <span style="width:<?php echo $pm['width'];?>%"></span>
            <span><?php echo $pm['description']; ?></span>
        </div>
    <?php
    }
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:55:34.393

您可以将变量变量用于您要询问的内容...

```
<?php
$i = 0;
while( $i < 6 ){
$i ++;

$variable = "pm_c".$i."_djwd";
$variable2 = "pm_description_c".$i."";

 if (isset($$variable) && $$variable != '') { ?>

<div>
   <span style="width:<?php echo $$variable;?>%"></span>
   <span><?php echo $$variable2; ?></span>
</div>

<?php } 
} 
```

# jquery - 从jQuery中的选择元素中按值获取选项

> ID：14573318
> 
> 赞同：4
> 
> 时间：2013-01-28T23:43:33.387
> 
> 标签：jquery, jquery-selectors, option

我想像这样访问选择选项 jQuery 对象：

```
var $options = $('select').children();
var $someOption = $('[value="some_value"]', $options);
var $anotherOption = $('[value="another_value"]', $options); 
```

但两者都不`$someOption`或`$anotherOption`看起来像`$('select')`.

我相信我知道如何编写单行选择器，但由于我要访问各种选项，因此我想使用`$options`句柄来提高可读性和性能。

代码和/或基本原理有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T23:51:12.087

你必须使用jQuery的[`filter`](http://api.jquery.com/filter/)方法：

```
var $options = $('select').children();
var $someOption = $options.filter('[value="some_value"]');
var $anotherOption = $options.filter('[value="another_value"]'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:15:04.157

为了使用上下文参数，不要调用`.children()`.

```
var $select = $('select');
var $someOption = $('[value="some_value"]', $select);
var $anotherOption = $('[value="another_value"]', $select); 
```

# php - PHP 会话函数调试辅助

> ID：14573325
> 
> 赞同：-2
> 
> 时间：2013-01-28T23:44:08.940
> 
> 标签：php, function, session

我知道如何包含外部 PHP 页面以及如何启动会话等，但我认为我的工作逻辑有些混乱。希望有人可以看看...

我有一个 html 页面，它是一个表单，它使用它发送给它的信息拉出一个 PHP 视图页面。我想将我的函数与使用会话一起放在外部页面中，但我不断收到语法错误。

当我发送我的表格时，它转到以下内容：

```
<?php
session_start();
include 'functs.php'; 
if ($_POST && !empty($_POST['name'])) {
$_SESSION['name'] = $_POST['name'];
$_SESSION['time'] = $_POST['time'];
confirmed();
}
else {
print unconfirmed();
}
?> 
```

我的外部页面是这样的：

```
<?php
function confirmed() {
echo "<head>";
echo "<title>Confirmation Page</title>";
echo '</head>";
echo "<body>";

PRINT <<<HERE

if (isset($_SESSION['name'])) {
echo 'Thank you, '.$_SESSION['name']. ' your reservation is confirmed for ' . $_SESSION['time'] ;
}
else {
echo 'There seems to have been an error processing your reservation. Please ensure that  you have cookies enabled and try your request again' ;
}

HERE;

echo "</body></html>";
?> 
```

我得到的错误是 Parse error: syntax error, unexpected 'name' (T_STRING), expecting ',' or ';' 在第 10 行的 E:\Program Files\xampp\htdocs\cis\w2\functs.php 中。如果我在内部插入函数，它可以工作，所以我知道它与我如何格式化包含页面有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:47:49.930

通过突出显示此处错误的语法非常明显：

```
echo '</head>";
//-----------^ 
```

此行有不正确的引号，因此您永远不会终止字符串，它会继续运行。

**编辑**：

但这不是唯一的问题。你也永远不会用右花括号关闭你的函数：`}`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:47:12.293

主要问题是您在此行的引号不匹配：

```
echo '</head>"; 
```

但是，我不得不说我对您为什么拥有 HEREDOC 感到困惑。当然，您只需要`if`声明吗？

# mysql - Rails MySQL 子查询计数

> ID：14573328
> 
> 赞同：1
> 
> 时间：2013-01-28T23:44:19.577
> 
> 标签：mysql, ruby-on-rails, count, subquery

我有两个模型：

1.  产品
2.  点击

我想获得所有点击次数超过 x 的产品。

表格如下所示：

```
Products

id 
```

,

```
Clicks

id | product_id 
```

在 ruby​​ 中，代码可能看起来像`products.select {|p| p.clicks.size > x}`. 如何为 mysql 编写类似的查询？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:53:48.013

为了有效地做到这一点，您可能需要考虑使用计数器缓存。ActiveRecord 内置了对这个概念的支持，它可以让你不必做一个子查询。

一些链接：

*   [博客教程](http://hiteshrawal.blogspot.com/2011/12/rails-counter-cache.html)
*   [RailsCast](http://railscasts.com/episodes/23-counter-cache-column?view=asciicast)
*   [Rails 文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:48:00.677

试试这个：

```
SELECT *
FROM Products
WHERE Id IN
(
    SELECT 
        P.Id
    FROM Products P
       JOIN Clicks C
          ON P.Id = C.Product_ID
    GROUP BY P.ID
    HAVING COUNT(1) > x
) A 
```

或者这个，如果你只需要产品 ID

```
 SELECT 
        P.Id
    FROM Products P
       JOIN Clicks C
          ON P.Id = C.Product_ID
    GROUP BY P.ID
    HAVING COUNT(1) > x 
```

# android - 需要一个准确且可以暂停的 CountdownTimer android

> ID：14573330
> 
> 赞同：3
> 
> 时间：2013-01-28T23:44:48.613
> 
> 标签：android, countdowntimer

我有一个倒数计时器，可以从 60 秒倒计时到 0 秒。我一直很开心（不是！）试图让 CountDownTimer 暂停工作并在计时方面保持准确。

[android CountDownTimer - 滴答之间的额外毫秒延迟](https://stackoverflow.com/questions/12762272/android-countdowntimer-additional-milliseconds-delay-between-ticks/12762416#12762416)

上面的链接在一定程度上修复了不准确之处，但显示有时会从 60 秒开始，有时会从 59 秒开始。

此外，我需要能够暂停计时器。我尝试使用此实现来暂停，但此实现基于 Android 的 CountDownTimer 并且在第一个链接中讨论了不准确之处：

[http://www.java2s.com/Open-Source/Android/Timer/multitimer-android/com/cycleindex/multitimer/CountDownTimerWithPause.java.htm](http://www.java2s.com/Open-Source/Android/Timer/multitimer-android/com/cycleindex/multitimer/CountDownTimerWithPause.java.htm)

任何人都对如何使用准确的暂停实现 CountDownTimer 有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-08T15:12:08.683

只需看看 Sam [here](https://stackoverflow.com/questions/12762272/android-countdowntimer-additional-milliseconds-delay-between-ticks)的答案，这是我找到的最准确的答案！

# c++ - C++ 嵌套模板

> ID：14573332
> 
> 赞同：3
> 
> 时间：2013-01-28T23:45:26.033
> 
> 标签：c++, visual-c++-2010

> **可能重复：**
> [奇怪的 VC++ 编译错误，C2244](https://stackoverflow.com/questions/1484885/strange-vc-compile-error-c2244)

我有以下带有模板结构和模板成员函数的 C++ 代码。模板函数在其声明中使用模板参数。代码无法编译。

```
template<typename MyType>
struct Network
{
    template<typename MyOtherType>
    void Do_Stuff(char param[MyOtherType::size]);
};

template<typename MyType>
template<typename MyOtherType>
void Network<MyType>::Do_Stuff(char param[MyOtherType::size])
{
};

struct Array_Size
{
    static const int size;
};

const int Array_Size::size=3;

int main()
{
} 
```

Visual Studio 2010 生成以下错误：

```
error C2244: 'Network<MyType>::Do_Stuff' : unable to match function definition to an existing declaration
    definition
    'void Network<MyType>::Do_Stuff(char [MyOtherType::size])'
    existing declarations
    'void Network<MyType>::Do_Stuff(char [MyOtherType::size])' 
```

我不明白为什么即使定义和声明相同，编译器也找不到匹配项。

# android - 如果它说它是自动生成的，我该如何编辑 project.properties？

> ID：14573335
> 
> 赞同：3
> 
> 时间：2013-01-28T23:45:57.087
> 
> 标签：android, adt

我想说：

```
manifestmerger.enabled=true 
```

在我的`project.properties`文件中（[请参见此处了解原因](https://stackoverflow.com/questions/4457219/library-project-does-the-manifest-file-merge)；从谷歌搜索看来，应该将这一行添加到`project.properties`）。但是，在我的`project.properties`文件顶部，它说：

```
# This file is automatically generated by Android Tools.
# Do not modify this file -- YOUR CHANGES WILL BE ERASED! 
```

如果我的`project.properties`文件是自动生成的并且我不应该编辑它，我应该把我的`manifestmerger.enabled=true`声明放在哪里？我一直在环顾四周，但找不到应该去的明显位置或如何编辑`project.properties`，以便在自动生成文件时不会替换我的编辑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:58:42.987

您可以将设置添加到`ant.properties`文件中。ant.properties 文件可以由您创建。它仅由编辑编辑

根据`build.xml`：

```
 The ant.properties file can be created by you. It is only edited by the
     'android' tool to add properties to it.
     This is the place to change some Ant specific build properties.
     Here are some properties you may want to change/update:

     source.dir
         The name of the source directory. Default is 'src'.
     out.dir
         The name of the output directory. Default is 'bin'.

     For other overridable properties, look at the beginning of the rules
     files in the SDK, at tools/ant/build.xml

     Properties related to the SDK location or the project target should
     be updated using the 'android' tool with the 'update' action.

     This file is an integral part of the build system for your
     application and should be checked into Version Control Systems. 
```

`manifestmerger.enabled`并列`tools/ant/build.xml`在.

# android - 摇晃后停止 Android 加速度计

> ID：14573337
> 
> 赞同：3
> 
> 时间：2013-01-28T23:45:58.263
> 
> 标签：android, listener, accelerometer, shake

我想听一下震动，然后完全停止加速度计并进行另一项活动。可悲的是，我没有找到任何方法来做到这一点。即使我计算一个变量并用一个简单的“如果”检查，每次检测到震动时它总是再次加载新活动。

请帮助我理解我的缺乏。

```
@Override
  protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(mSensorListener, mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER), SensorManager.SENSOR_DELAY_NORMAL);
  }

  @Override
  protected void onPause() {
    mSensorManager.unregisterListener(mSensorListener);
    super.onPause();

  }

  @Override
  protected void onStop() {
    mSensorManager.unregisterListener(mSensorListener);
    super.onStop();
  }

private SensorManager mSensorManager;

  private final SensorEventListener mSensorListener = new SensorEventListener() {

@Override
public void onAccuracyChanged(Sensor arg0, int arg1) {
    // TODO Auto-generated method stub

}

@Override
public void onSensorChanged(SensorEvent event) {

    float[] value = event.values;

    if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER) {
            float x = value[0];
            float y = value[1];
            float z = value[2];

            //in G Umrechnung
            float gX = x / gravityEarth;
            float gY = y / gravityEarth;
            float gZ = z / gravityEarth;

          //G-Force will be 1 when there is no movement. (gravity)
             gForce = FloatMath.sqrt(gX * gX + gY * gY + gZ * gZ);

             double gForce2 = Math.round(gForce * 100) / 100.0;

             String g = String.format("" + gForce2 + " G");
             TextViewG.setTextColor(0xffff0000);
             TextViewG.setTextSize(35);
             TextViewG.setText(g);

    }

    Intent nextScreen = new Intent(getApplicationContext(), Send.class);

    if (gForce > shakeThresholdInGForce ){

        final long now = System.currentTimeMillis();

        // ignore shake events too close to each other (500ms)
        if (mShakeTimestamp + SHAKE_SLOP_TIME_MS > now ) {

            mShakeTimestamp = now;

                   mSensorManager.unregisterListener(mSensorListener);
            onStop();

            startActivity(nextScreen);

        }

    } 
```

# ruby-on-rails - RVM MultiUser 安装不安全？

> ID：14573338
> 
> 赞同：3
> 
> 时间：2013-01-28T23:45:58.663
> 
> 标签：ruby-on-rails, ruby, linux, rvm

我想设置一个安装了 RVM 的小型开发服务器（linux），以便一些开发人员可以使用它。目标是确保每个人都安装了 Rails 和 Ruby，并且可以使用它们。我正在阅读 MultiUser 安装的 RVM 指南，它说“在不了解 umask 工作原理的情况下使用这种类型的安装是一个很大的安全风险。”

我只是想知道这到底有什么不安全的？只是开发人员可以随意切换 ruby​​ 版本并安装/删除 gems 吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:24:38.023

这主要取决于您对开发人员的信任程度——主要是他们是团队还是随机人员。

第二件事是托管应用程序 - 这是额外的安全问题，最好为每个应用程序使用新用户和混合模式 rvm。

如果开发人员要托管应用程序，那么也为开发人员使用混合模式——他们只会共享 ruby​​——但它更安全。

有关详细信息，请参阅[rvm 站点上的安装说明](https://rvm.io/rvm/install)。

# android - IDEA，Android UI 渲染错误，空指针

> ID：14573343
> 
> 赞同：1
> 
> 时间：2013-01-28T23:46:57.803
> 
> 标签：android, user-interface

我在创建自定义视图时遇到问题。这是代码：

```
package com.example.App;

    import android.content.Context;
    import android.util.AttributeSet;
    import android.view.View;

    public class v extends View {

        public v(Context context) {
            super(context);
        }

        public v(Context context, AttributeSet attrs) {
            super(context, attrs);
        }

        public v(Context context, AttributeSet attrs, int defStyle) {
            super(context, attrs, defStyle);
        }
    } 
```

我正在尝试在布局中使用它并获得渲染错误（`NullPointerException`），这是 IDEA 在布局代码中生成的内容：

```
 <view android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           class="com.example.App.v" android:id="@+id/view" android:layout_gravity="center"/> 
```

我做错了什么？如何解决？

# c# - 每种标识符的正确术语是什么？

> ID：14573347
> 
> 赞同：7
> 
> 时间：2013-01-28T23:47:31.333
> 
> 标签：c#, oop, terminology

采取以下代码：

```
IFoo foo = new FooImplementation(); 
```

标识符`foo`有两种类型：

1.  `IFoo`- 这是编译器将强制执行的类型。我将只能调用属于`IFoo`合同一部分的方法，否则会出现编译器错误。
2.  `FooImplementation`- 这是运行时已知的类型。我可以在运行时向下转换`foo`为 a `FooImplementation`，然后调用`FooImplementation`.

**我的问题：**这两种类型的正确术语是什么。我可以在学校*发誓*，我们被教导这`IFoo`是标识符的静态*类型*和*动态类型*，但在谷歌上进行大量搜索后，我似乎找不到任何对此的参考。`FooImplementation`

 ** * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-28T23:55:28.340

我会分别调用编译时和运行时类型`IFoo`。`FooImplementation`C# 规范使用这种语言，例如，在谈论虚拟方法时（第 1.6.6.4 节）：

> 调用虚拟方法时，发生该调用的实例的**运行时类型**决定了要调用的实际方法实现。在非虚拟方法调用中，实例的**编译时类型**是决定因素。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-29T01:24:38.163

我同意 Mike Z 的观点。C# 中的常用术语是“编译时类型”和“运行时类型”。

“静态类型”和“动态类型”是完全合理的术语，但我会在 C# 的上下文中避免使用它们。“静态类型”很容易与“静态类”混淆，“静态类”是一个只能包含静态方法的类。而且“动态类型”很容易与 C# 4 中添加的动态类型特性相混淆。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-28T23:49:52.017

第一个是声明类型。第二个是具体类型。

……至少我是这么称呼他们的。*

# mongodb - 如何查看排序信息system.profile（mongodb）？

> ID：14573354
> 
> 赞同：1
> 
> 时间：2013-01-28T23:48:13.583
> 
> 标签：mongodb, node-mongodb-native

我启用了分析模式 2（所有事件）。我的想法是编写一个脚本，它将遍历所有查询并执行解释计划，并查看是否有任何查询不使用索引。但是这是不可能的，因为我在 system.profile 中看不到任何排序信息。为什么这样？

谢谢

更新：

想象一下，您有一个用户集合。你已经在这个集合上创建了一个索引：user(name, createdAt)。现在我想找出一些按时间排序的用户。在 system.profile 中，查询的第二部分（排序/分页）不会被保存，但是了解使用了哪些排序操作非常重要，因为它会影响性能和索引选择。所以我的目的是创建一个脚本，它将遍历 system.profile 中的所有语句并执行解释计划并查看是否使用索引。如果没有，我可以在执行集成测试时自动捕获所有新的/不可靠的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T16:36:57.403

您可以使用聚合框架对例如最慢的操作进行排序 `db.system.profile.aggregate( { $sort : { millis : -1 }})`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T21:01:01.277

对不起大家。我找到了那个问题的答案。实际上 mongo 有它。它在查询元素中称为 orderby。我的错 ：-）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:26:41.353

为什么 10gen 选择不在 system.profile 中包含排序信息？

我建议如果您对该功能感兴趣，请在[此处](https://jira.mongodb.org/secure/Dashboard.jspa)提出请求。（我找不到此功能的现有建议）。您可能会获得更多关于为什么它没有被包括在内的详细信息。

我可以看到它有时是多么有价值，尽管建议您[比较](http://docs.mongodb.org/manual/reference/database-profiler/)nscanned 与 nreturned 以了解是否正在使用索引（更重要的是，确保扫描尽可能少的文档）。

因此，虽然并不完美，但它为您提供了一种快速评估性能和检测索引使用情况的方法。

# ruby-on-rails - 如果数量为 0，则删除项目

> ID：14573367
> 
> 赞同：0
> 
> 时间：2013-01-28T23:50:12.450
> 
> 标签：ruby-on-rails, ruby

如果用户更新了商品的数量，我想保存购物车（以便我可以重定向到它）并销毁该商品。如果他们要增加数量，我还想检查以确保该项目的库存也有足够的库存。所以我的更新函数看起来像这样（相信响应函数可以正常工作，就像它们看起来那样。它将代码削减了一半，因此更容易查看）：

```
 def update
    @line_item = LineItem.find(params[:id])
    @line_item_new_qty = params[:item][:qty]
    unless LineItem.get_inventory_check?( @line_item.id , params[:item][:qty] )
      respond 'Insufficient Inventory'
    else
      if @line_item_new_qty == 0
        @line_item_cart = @line_item.cart
        @line_item.destroy
          respond 'Item Deleted'
      else    
        respond 'Quantity Updated'
      end
    end
  end 
```

get_inventory_check 似乎在工作，如果有足够的，它会更改并保存 line_item 的数量，并返回 true。否则，它严格返回 false。

我已经尝试将 if == 0 语句放在每个可能的位置，我唯一可以开始工作的是如果我有@line_item.qty == 0，那么它将首先将其删除，然后将其更新为 0，然后如果您尝试从他们的删除中更新它。我认为这意味着它无法判断 line_item 已在 get_inventory_check 方法中更新，但在 if 语句中使用 params 也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T23:55:05.030

很可能`params[:item][:qty]`是 a `String`，因此`@line_item_new_qty == 0`会返回`false`。一种可能解决此问题的方法是转换`@line_item_new_qty`为整数：

```
if @line_item_new_qty.to_i == 0 
```

或者，您可以将其与 进行比较`"0"`，但总的来说，问题可能是比较不同类型的问题之一。

# javascript - 谷歌地图图标颜色

> ID：14573368
> 
> 赞同：-1
> 
> 时间：2013-01-28T23:50:24.730
> 
> 标签：javascript, google-maps-api-3, google-maps-markers

目前您可以使用 googles chart api 加载具有不同颜色的自定义标记

见这里：[https ://developers.google.com/chart/image/docs/gallery/dynamic_icons](https://developers.google.com/chart/image/docs/gallery/dynamic_icons)

但这已被弃用。因此，为了确保我的网站将来可以正常工作，我应该使用什么？

还是有一些简单的方法可以使用 css 或其他东西来定义标记的颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:10:33.770

而不是使用已弃用的库，我发现[http://code.google.com/p/google-maps-utility-library-v3/wiki/Libraries#StyledMarker](http://code.google.com/p/google-maps-utility-library-v3/wiki/Libraries#StyledMarker)完美运行:)

# java - 由 MouseListener 触发的多个弹跳球

> ID：14573369
> 
> 赞同：1
> 
> 时间：2013-01-28T23:50:28.980
> 
> 标签：java, awt, mouselistener

我想在java中做一个弹跳球应用程序。每个球都应该通过鼠标点击发生，每个球都应该有随机的速度、颜色、半径和起始位置。除了发生鼠标侦听器的部分之外，我设法做了所有事情。无论我在 mousePressed 方法中做什么都不起作用。我应该怎么做才能让用户在按下鼠标时创建一个随机球？

**编辑：**这是我的代码的最后一个版本。现在的问题是我不能创造一个以上的球。当我点击屏幕时，同一个球只是保持超速。

*弹跳球类*

```
public class BouncingBalls extends JPanel implements MouseListener{

private Ball ball;
protected List<Ball> balls = new ArrayList<Ball>(20);
private Container container;
private DrawCanvas canvas;
private int canvasWidth;
private int canvasHeight;
public static final int UPDATE_RATE = 30;

int x = random(480);
int y = random(480);
int speedX = random(30);
int speedY = random(30);
int radius = random(20);
int red = random(255);
int green = random(255);
int blue = random(255);
int count = 0;

public static int random(int maxRange) {
    return (int) Math.round((Math.random() * maxRange));
}

public BouncingBalls(int width, int height){

    canvasWidth = width;
    canvasHeight = height;

    ball = new Ball(x, y, speedX, speedY, radius, red, green, blue);
    container = new Container();

    canvas = new DrawCanvas();
    this.setLayout(new BorderLayout());
    this.add(canvas, BorderLayout.CENTER);
    this.addMouseListener(this);

}

public void start(){

    Thread t = new Thread(){

        public void run(){

            while(true){

                update();
                repaint();
                try {
                    Thread.sleep(1000 / UPDATE_RATE);
                } catch (InterruptedException e) {}
            }
        }
    };
    t.start();
}

public void update(){

    ball.move(container);
}

class DrawCanvas extends JPanel{

    public void paintComponent(Graphics g){

        super.paintComponent(g);
        container.draw(g);
        ball.draw(g);
    }

    public Dimension getPreferredSize(){

        return(new Dimension(canvasWidth, canvasHeight));
    }
}

public static void main(String[] args){

    javax.swing.SwingUtilities.invokeLater(new Runnable(){

        public void run(){

            JFrame f = new JFrame("Bouncing Balls");
            f.setDefaultCloseOperation(f.EXIT_ON_CLOSE);
            f.setContentPane(new BouncingBalls(500, 500));
            f.pack();
            f.setVisible(true);
        }
    });
}

@Override
public void mouseClicked(MouseEvent e) {
    // TODO Auto-generated method stub

}

@Override
public void mouseEntered(MouseEvent e) {
    // TODO Auto-generated method stub

}

@Override
public void mouseExited(MouseEvent e) {
    // TODO Auto-generated method stub

}

@Override
public void mousePressed(MouseEvent e) {

    balls.add(new Ball(x, y, speedX, speedY, radius, red, green, blue));
    start();
}

@Override
public void mouseReleased(MouseEvent e) {
    // TODO Auto-generated method stub

}
} 
```

*球类*

```
import java.awt.Color;
import java.awt.Graphics;

public class Ball{

public static int random(int maxRange) {
    return (int) Math.round((Math.random() * maxRange));
}

private BouncingBalls balls;
int x = random(480);
int y = random(480);
int speedX = random(30);
int speedY = random(30);
int radius = random(20);
int red = random(255);
int green = random(255);
int blue = random(255);
int i = 0;

public Ball(int x, int y, int speedX, int speedY, int radius, int red, int green, int blue){

    this.x = x;
    this.y = y;
    this.speedX = speedX;
    this.speedY = speedY;
    this.radius = radius;
    this.red = red;
    this.green = green;
    this.blue = blue;
}

public void draw(Graphics g){

    for(Ball ball : balls){

        g.setColor(new Color(red, green, blue));
        g.fillOval((int)(x - radius), (int)(y - radius), (int)(2 * radius), (int)(2 * radius));
    }
}

public void move(Container container){

    x += speedX;
    y += speedY;

    if(x - radius < 0){

        speedX = -speedX;
        x = radius;
    }
    else if(x + radius > 500){

        speedX = -speedX;
        x = 500 - radius;
    }

    if(y - radius < 0){

        speedY = -speedY;
        y = radius;
    }
    else if(y + radius > 500){

        speedY = -speedY;
        y = 500 - radius;
    }
}
} 
```

*容器类*

```
import java.awt.Color;
import java.awt.Graphics;

public class Container {

private static final int HEIGHT = 500;
private static final int WIDTH = 500;
private static final Color COLOR = Color.WHITE;

public void draw(Graphics g){

    g.setColor(COLOR);
    g.fillRect(0, 0, WIDTH, HEIGHT);
}
 } 
```

**错误：**在这部分代码中出现“只能迭代数组或 java.lang.Iterable 的实例”错误：

```
public void draw(Graphics g){

    for(Ball ball : balls){

        g.setColor(new Color(red, green, blue));
        g.fillOval((int)(x - radius), (int)(y - radius), (int)(2 * radius), (int)(2 * radius));
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T23:58:19.157

首先，如果你想渲染多个球，你应该创建另一个类来包含绘制一个球所需的所有属性（甚至可能是一个`draw (Graphics g)`委托绘图的方法）。然后你会在你的`BouncingBalls`类上有一个球列表，应该迭代并在`paintComponent`方法上绘制。

也就是说，您的`mouseClicked`处理程序只会创建一个新`Ball`实例并将其添加到列表中。

**编辑：** 绘图过程将如何在您的`DrawCanvas`班级中的示例：

```
class DrawCanvas {
    public void paintComponent(Graphics g){
        super.paintComponent(g);
        container.draw(g);

        for (Ball ball : balls)
            //the draw method should only care of the specific ball instance 
            //you are calling it from
            ball.draw(g);
    }
... 
```

我认为您在将问题分成类并使它们的实例合作做您想做的事情时遇到了问题。如果您确实对此有疑问，我建议您阅读一些有关该主题的文章/书籍，以更好地了解类和对象的概念以及它们的工作原理；它肯定会帮助您轻松进行编程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:54:28.900

您需要将 MouseListener 添加到组件中：

```
public BouncingBalls() {
  this.addMouseListener(this); // <-- Add this object as a MouseListener.
  this.setPreferredSize(new Dimension(BOX_WIDTH, BOX_HEIGHT)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:55:21.823

尝试在您的`main`方法中使用此代码：

```
frame.addMouseListener(this); 
```

您需要将鼠标侦听器添加到框架/面板。

（由您回复[此](https://stackoverflow.com/questions/14573369/multiple-bouncing-balls-triggered-by-mouselistener/14573417#comment20337713_14573369)评论）或者，如果您想将侦听器添加到面板，首先您必须调用

```
setFocusable(true);
requestFocusInWindow(); 
```

在你的`BouncingBalls`构造函数中。然后，您可以使用以下命令将鼠标侦听器添加到面板：

```
addMouseListener(this); 
```

这是因为面板最初没有焦点。

但是，最简单的方法是将鼠标侦听器添加到框架中。

# android - Android MonkeyRunner 脚本未在 Ubuntu 10.04 上运行

> ID：14573373
> 
> 赞同：0
> 
> 时间：2013-01-28T23:50:54.917
> 
> 标签：android, eclipse, unix, monkeyrunner

我没有输出。

我为 Eclipse 设置了 monkeyrunner，如下：[http](http://dtmilano.blogspot.com/2011/03/using-android-monkeyrunner-from-eclipse.html) ://dtmilano.blogspot.com/2011/03/using-android-monkeyrunner-from-eclipse.html方向。我设法让我的代码在 Eclipse 中干净地“运行”——没有错误。

从命令行我尝试了两种方法：

```
monkeyrunner [path]/MonkeyTest.py
monkeyrunner -v ALL [path]/MonkeyTest.py 
```

光标消失了几秒钟，然后我得到了提示，没有任何反应。'monkeyrunner' 本身会产生信息 + 提示：

```
Jython 2.5.0 (Release_2_5_0:6476, Jun 16 2009, 13:33:26) 
[Java HotSpot(TM) 64-Bit Server VM (Sun Microsystems Inc.)] on java1.6.0_35
>>> 
```

我连接到 PC 的电话正在注册，因为当我进入时我得到它的列表：

> 亚行设备

我唯一能想到的是它不会执行，因为我没有安装 *apk??

我只是想用它来自动化 CTS 的设置。（即打开wi-fi，确保所有CTS-Verifiers 有权限，设置手机不锁定等）。如果有更好的方法，我很想听听。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T22:14:23.447

尝试在 MonkeyTest.py 中添加一些内容：

```
#! /usr/bin/env monkeyrunner

print "This is MonkeyTest.py" 
```

然后

```
$ chmod +x MonkeyRunner.py 
```

如果你的monkeyrunner在你的PATH中，你就可以做到

```
$ ./MonkeyTest.py 
```

或者

```
$ monkeyrunner MonkeyTest.py 
```

或者

```
$ /path/to/monkeyrunner MonkeyTest.py 
```

或者

```
$ /path/to/monkeyrunner /path/to/MonkeyTest/py 
```

您将能够看到该消息。如果您不这样做，则有其他问题。

# servicestack - 不指定 URL 的单元测试休息服务

> ID：14573378
> 
> 赞同：1
> 
> 时间：2013-01-28T23:51:25.227
> 
> 标签：servicestack

使用servicestack，有使用类型等进行单元测试的例子，这里有一个例子： [GetFactorial](https://github.com/ServiceStack/ServiceStack.Examples/blob/master/tests/ServiceStack.Examples.Tests/GetFactorialTests.cs)

我想通过与上述类似的测试来测试我的 REST 样式服务。

这是一个示例 REST 单元测试[FileService](https://github.com/ServiceStack/ServiceStack.Examples/blob/master/src/RestFiles/RestFiles.Tests/SyncRestClientTests.cs#L118)

请注意，在 PUT 单元测试中，必须在 URL 文本中而不是在类参数中指定 Path 参数。另一个例子是[在这里](https://github.com/ServiceStack/ServiceStack.Examples/blob/master/src/RestIntro/RestIntro.IntegrationTests/IntegrationTests.cs)，我们有非常好的请求模型，必须被翻译成 URL。对于测试，我想避免在 url 中构建参数并使用类似于上面这样的系统：

```
var response = restClient.Put<FilesResponse>(new Files { TextContents = ReplacedFileContents, Path = "README.txt" }); 
```

或者

```
var singleCustomer = restClient.Get<Customer>(new Customer {Id=1}; 
```

这可能吗？

然后是[DirectServiceClient](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.WebHost.IntegrationTests/Tests/WebServicesTests.cs)。那会有帮助吗？最后，使用 servicestack，我们可以编写服务，并且可以从许多不同类型的客户端调用它们——我想这样编写我的单元测试。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T14:42:04.267

如果你用路由变量装饰你的 DTO 并使用 ServiceStack 的“新 API”，那么它可以自动发现路由。您可以通过编写非常少的代码而摆脱困境，并且仍然可以获得强大的类型化 rest API。

您的代码可能如下所示：

```
Customer singleCustomer = restClient.Get(new Customer {Id=1}); 
```

见[https://github.com/ServiceStack/ServiceStack/wiki/New-Api](https://github.com/ServiceStack/ServiceStack/wiki/New-Api)

为了回应您的评论，您的 DTO 需要遵守 IReturn 接口：

```
[Route("/customer/{Id}")]
public Customer : IReturn<Customer> {
   public int Id {get;set;}
} 
```

下面的 IRestClient 接口现在可以在不指定类型的情况下使用您的 DTO，因为它需要一个 IReturn 对象。

```
public interface IRestClient 
{
   TResponse Get<TResponse>(IReturn<TResponse> request);
   ...
} 
```

# php - 在 Symfony2 页面中使用 Datatransformer 自定义字段的最佳方式

> ID：14573382
> 
> 赞同：1
> 
> 时间：2013-01-28T23:51:37.990
> 
> 标签：php, symfony, doctrine-orm

我有一个自定义字段类型“customnum”，有一个 DataTransformer。当像这样提供给 Builder 时，一切都以一种形式正常工作：

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder
        ->add('name')
        ->add('number','customnum')
        ->add('active') 
```

我如何使用从典型的 indexAction 页面开始的自定义字段（DataTransformer），由学说 CRUD 构建？

```
public function indexAction()
{
    $em = $this->getDoctrine()->getManager();
    $entities = $em->getRepository('TwarSoz3Bundle:Organization')->findAll();
    return array(
        'entities' => $entities,
    );
} 
```

有没有办法让框架自动猜测该字段上的 customnum 类型（也在表单中？）

# backbone.js - 未调用主干成功回调

> ID：14573384
> 
> 赞同：0
> 
> 时间：2013-01-28T23:51:50.463
> 
> 标签：backbone.js, backbone-relational

`success`我在获取集合后尝试调用回调时遇到问题。这是集合中的代码，问题正在执行`executeLongPolling`

```
(function() {
window.StatusCollection = Backbone.Collection.extend({
    longPolling : false,
    intervalSeconds : 20,
    model: Status,
    url: function(){
        return this.project.id + 'statuses/';
    },
    initialize : function(){
        _.bindAll(this);
    },
    startLongPolling : function(invervalSeconds){
        this.longPolling = true;
        if( invervalSeconds ){
            this.invervalSeconds = invervalSeconds;
        }
        this.executeLongPolling();
    },
    stopLongPolling : function(){
        this.longPolling = false;
    },
    executeLongPolling : function(){
        var that = this;
        this.fetch({
            success : function(collection, response, options) {
                that.onFetch();
            }
        });
    },
    onFetch : function () {
        if( this.longPolling ){
            setTimeout(this.executeLongPolling, 1000 * this.intervalSeconds);
        }
    }
}); })(); 
```

令人惊讶的是，当我添加更新选项时，它可以工作并且该行`that.onFetch()`被调用：

```
executeLongPolling : function(){
        var that = this;
        this.fetch({ update: true,
            success : function(collection, response, options) {
                that.onFetch();
            }
        });
    }, 
```

我正在使用主干-0.9.10。和骨干关系-0.7.0

有什么想法有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:28:48.177

在寻找我的问题的解决方案时遇到了您的问题，在从 0.9.2 Anywho 升级到 0.9.10 后似乎只是添加到我的收藏（我不使用 fetch）似乎被破坏了，只要看看你的问题，可能会有一些东西与 0.9.10 中的 fetch 发生变化有关看这些：

[骨干投掷集合[方法] 函数错误](https://stackoverflow.com/questions/14562615/backbone-throwing-collectionmethod-function-error) [https://github.com/addyosmani/backbone.paginator/issues/134](https://github.com/addyosmani/backbone.paginator/issues/134)

或者也许是 Backbone-relational 在 0.9.10 中还没有完全发挥作用的事实 [https://github.com/PaulUithol/backbone-tastypie/pull/25](https://github.com/PaulUithol/backbone-tastypie/pull/25)

# asp.net-mvc - 在视图或控制器中生成路由 url

> ID：14573390
> 
> 赞同：0
> 
> 时间：2013-01-28T23:52:28.953
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我目前正在使用 mvc4 并且对最佳实践有疑问。

我回到我的观点，一些基于产品信息的链接，例如。产品/1234 等

什么是最佳实践，使用控制器中的路由引擎创建链接并将 url 作为模型对象的属性返回，或者将信息返回到视图并在那里生成链接？我使用`automapper`将我的 DTO 对象映射到模型对象，还考虑在映射期间创建链接。

最好的做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:58:09.433

您总是在视图上创建链接。

视图中的 HTML 帮助器可用于确保链接符合您的路由规则。

[您可以在许多官方 ASP.NET MVC 4 教程](http://www.asp.net/mvc/tutorials/mvc-4)中看到这一点。

**为什么不在控制器或模型中？**

视图中的 HTML 帮助器不仅用于创建 URL，而且还用于将 URL 包装在完全形成的锚标记等中。在模型或控制器中包含 HTML 是不合适的，因为它们不应该关心如何显示数据。

例如，`Html.ActionLink`助手返回一个`a`元素。

# xml - 将 XML 导入 InDesign

> ID：14573391
> 
> 赞同：12
> 
> 时间：2013-01-28T23:52:37.687
> 
> 标签：xml, adobe-indesign

我正在尝试使用 InDesign 为 XML 数据创建模板。基本结构是：

```
<page>
<section1>
<product><title></title></product>
<product><title></title></product>
...
</section1>
<section2>
.... 
```

每个部分都有可变数量的产品。将使用正确数量的部分创建每个模板（尽管使用子产品重复部分也可以）。

使用导入 XML 功能是否支持此方案？谁能指出一个教程来展示如何设置它？

我已经尝试了一些示例，但在添加占位符并按照所有教程的建议重新导入文件后，InDesign 甚至无法重复产品。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-23T09:07:26.947

将 XML 转换为 HTML 或 DocBook XML 后，您可以使用 Pandoc 将其导入 InDesign。

[Pandoc](http://johnmacfarlane.net/pandoc/)有很多导入器（例如从 HTML 或 DocBook XML），现在可以导出为 Adob​​e InCopy 的 ICML 格式。然后可以将生成的文件像任何其他外部依赖项一样放置在 InDesign 中。

```
pandoc --standalone -t ICML -o output.icml input.html 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-08T12:40:20.783

## 通过批处理的一种解决方案（很多文章）

...我今天（2013 年）可以使用的唯一方法是这个（半自动）程序：

1.  [*手册，准备*]**检查**我的InDesign“模板”文件，该文件将用作“导入器”：必须定义**具有*****清晰名称的******样式。****它们在 HTML+CSS 导出中都是可见的（列出）。*
**   [*手册，准备*]**调整一个 XSLT**将您的 XML 文件转换为 XHTML 文件，用属性*类*和一致（与第 1 项）类*名*表示所有相关样式；*   [*自动、批处理*] **XSLT自动将所有 XML****转换**为 XHTML ；***   [*自动，批处理*]使用[Python OpenDocument Converter自动将所有 XHTML 文件](https://github.com/mirkonasato/pyodconverter)**转换**为 DOC 。*   [ *InDesign 辅助的最终处理*]从 InDesign 的“模板”（第 1 项）文件克隆**导入每个 DOC 。**InDesign 样式将自动转换*类*（第 2 项）。***

 ***此过程优于 IDML，因为**直接使用 XHTML 作为 InDesign 的内容源**。它并不适合所有应用程序，但避免使用 IDML 的非标准转换*，*避免**学习 IDML，避免 IDML 限制**，并避免 IDML 错误的风险......所以，我认为比尝试和尝试 IDML 程序更快。

* * *

另一个过程——**更好**，因为它允许表达脚注之类的东西——是通过将 XML 转换为[DOCX](http://en.wikipedia.org/wiki/Office_Open_XML)或[RFT](http://en.wikipedia.org/wiki/Rich_Text_Format)的 XSLT 准备从 XML 到 MS-Word 的直接转换......你有这种链接或线索吗？程序？

* * *

显现

Adobe 产品对于通用标准 (!) 导入**是“封闭的”**，例如导入[XHTML](http://www.w3.org/TR/xhtml1/)。

**如何抗议 Adob​​e？！**

当我们有很多文件时，就会出现最大的问题......***

# c - c读取字符串输入错误

> ID：14573392
> 
> 赞同：0
> 
> 时间：2013-01-28T23:52:45.097
> 
> 标签：c, arrays, string, pointers

```
struct employee {
        int employeeId;
        double payrate;
        char *inputname;
    };

    int main (void){

        //remember the struct before employee

        struct employee davidB;
        fgets(davidB.inputname, 20, stdin);
        davidB.employeeId = 1;
        davidB.payrate = 45020.50;

        printf("The employees name is %s\n The employees id num is  %d\n The employees payrate is %f\n", davidB.inputname, davidB.employeeId, davidB.payrate);

        struct employee ericG;

        printf("Please enter employee name, id number, and payrate\n");

        scanf("%s", ericG.inputname);
        scanf("%d", &ericG.employeeId);
        scanf("%lf", &ericG.payrate);

        printf("The employees name is %s\n The employees id num is  %d\n The employees payrate is %f\n", ericG.inputname, ericG.employeeId, ericG.payrate);

        return 0;
    } 
```

我的问题包括：

```
 fgets(davidB.inputname, 20, stdin);  
                          scanf("%s", ericG.inputname); 
```

为什么第一个有效，为什么第二个会导致堆栈溢出？此外，何时可以直接将“字符串”分配给指针，何时需要为预定义的 char 数组？

例如：

```
 const char *string = "Hey"; //works? so can't I do the same with the scanf above? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T23:56:34.587

您需要分配内存才能使用这些函数，否则会出现堆栈溢出，因为该指针 ( `davidB.inputname`) 指向垃圾。

一种选择是定义它，`char inputname[21];`但这仅适用于该`fgets`函数，因为您可以限制读取的字符数。但是，`scanf`除非您可以 100% 了解您要阅读的字符串的大小，否则您无能为力，因此最好避免使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T23:57:27.870

您还没有为``inputname`. 所以两者都会调用未定义的行为。所以两者都不起作用，无论如何都不是合法的C。

但是当你像这样直接分配时：

```
const char *string = "Hey"; 
```

`string`仅指向字符串文字。所以那里不需要内存分配。

所以通过这种方式，可以直接赋值给`struct`成员：

```
 struct employee davidB;
    davidB.inputname = "Eric"; // Thiis is valid.
    davidB.employeeId = 1;
    davidB.payrate = 45020.50; 
```

否则，您必须为以下内容动态分配内存`inputname`：

```
 struct employee davidB;
    davidB.inputname = malloc(256);
    fgets(davidB.inputname, 256, stdin); 
    davidB.employeeId = 1;
    davidB.payrate = 45020.50; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-28T23:58:03.510

一种方法有效，但另一种方法无效，这只是随机的运气。这两种方法都不正确，因为您没有为 inputname 分配任何内存来指向。因此，这些函数只是将数据输入到某个随机内存位置。

const char *string = "Hey" 之所以有效，是因为这是静态数据，编译器在某处为其分配空间。

# forms - 表单序列化在 Firefox 中不起作用

> ID：14573393
> 
> 赞同：0
> 
> 时间：2013-01-28T23:52:51.743
> 
> 标签：forms, jquery, serialization

表单是通过 ajax 动态加载的。加载表单后，我调用我的小表单插件的初始化。
序列化仅在第一次工作，但如果表单具有必填字段错误，则触发第二次提交，但序列化给出空字符串。此问题仅在 Firefox 中出现。在 Chrome、IE、Safari 中运行正常

我的小表单插件：

```
App.Forms = (function (parent, $) {

// Default config
var config = {
    form            : '.ajax-form',
    control         : null,
    successCallback : function () {},
    errorCallback   : function () {}

}, _submitForm = function ($form) {

    console.log('--------------- FORM DATA STRING -----------------');
    console.log($form.serialize());
    console.log('--------------------------------------------------');

    $.ajax({
        type    : $form.attr('method'),
        url     : $form.attr('action'),
        data    : $form.serialize(),
        cache   : false,
        success : function (response) {

            if (config.control === null) {
                $form.hide().html(response).fadeIn(800);

            } else {
                $(config.control).hide().html(response).fadeIn(800);
                //                    console.log(response);
            }

            if ($(response).find('.field-validation-error')) {
                App.Placeholder.init();  // Generate placeholder if browser not support
                config.errorCallback.call();
            } else {
                config.successCallback.call();
            }

        }
    });
};

parent.init = function (options) {

    $.extend(config, options);

    var $form = $(config.form);

    if (!$form.length) {
        return false;
    }

    App.Placeholder.init();  // Generate placeholder if browser not support

    $form.on('click', ':submit', function (e) {
        e.preventDefault();
        _submitForm($form);
    });

    return parent;
};

return parent;  }) (App.Forms || {}, jQuery); 
```

形式：

```
@using N2Project @model N2Project._Essence.Models.RegisterModel  @using (Html.BeginForm("Register", "LoyaltyLogin", FormMethod.Post, new { @id = "register-form" })) {
<p>
    <span class="error">@ViewBag.Error</span>
    <span class="success">@ViewBag.Success</span>
</p>

<p>
    @Html.TextBoxFor(m=>m.Loyaltycard,new{@placeholder="Card Number", @class="size100"})
    @Html.ValidationMessageFor(m=>m.Loyaltycard)
</p>

<p>
    @Html.TextBoxFor(m=>m.FirstName,new{@placeholder="First Name", @class="size100"})
    @Html.ValidationMessageFor(m=>m.FirstName)
</p>

<p>
    @Html.TextBoxFor(m=>m.LastName,new{@placeholder="Last Name", @class="size100"})
    @Html.ValidationMessageFor(m=>m.LastName)
</p>

<p>
    @Html.TextBoxFor(m=>m.DOB,new{@placeholder="Date of birth", @class="size100", @id="dob"})
    @Html.ValidationMessageFor(m=>m.DOB)
</p>

<p>
    @Html.TextBoxFor(m=>m.Email,new{@placeholder="Email", @class="size100"})
    @Html.ValidationMessageFor(m=>m.Email)
</p>

<p>
    @Html.PasswordFor(m=>m.Password,new{@placeholder="Password", @class="size100"})
    @Html.ValidationMessageFor(m=>m.Password)
</p>

<p class="checkbox">
    <input type="checkbox" id="subscribe" name="Subscribe" value="true" />
    <label for="subscribe">
        By registering you agree to recieve news and promotions from Essence via email
    </label>
</p>

<p>
    <button href="#" type="submit" class="btn size100">Send</button>
</p> } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:21:51.947

解决了这个问题：_submitForm($(this).closest('form'));

当我调用 submitForm 私有方法时，我传递了最接近的表单，并且它正在工作。

有人可以解释它为什么起作用吗？为什么我们在第一种情况下不在 Firefox 中工作？

# iphone - 通过编码发送普通的 Siri 命令

> ID：14573399
> 
> 赞同：0
> 
> 时间：2013-01-28T23:53:12.403
> 
> 标签：iphone

我对此完全陌生，但无论如何都可以。我一直在阅读 Siri 无法通过 API 访问。我的问题可能有点不同。

我想做的是向 Siri 发送这条消息 今天天气怎么样

就是这样，没什么新鲜的。我不想让 Siri 做一些它还没有做的事情。我只是想在我自己的代码中发送该消息，而不是点击按钮并说出它。

有什么想法吗？？？谢谢 ！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T04:36:50.677

不，你不能那样做。Apple 尚未向开发人员提供任何用于 Siri 编程的公共 API。您在其中一条评论中提供的链接也是针对越狱设备的。他们一定使用了私有 API。

# java - 用文本框 JAVA/ANDROID 中的内容替换文件中的字符串

> ID：14573403
> 
> 赞同：2
> 
> 时间：2013-01-28T23:54:00.690
> 
> 标签：java, android, textbox, replace

我一直在用“replaceall”功能做一些实验来改变文件的内容。但我想知道是否可以用从文本框中获取的文本替换字符串。

例子：

```
File:

NAME: JOHN DOE
GRADES:BLAH BLAH BLAH BLAH

NAME: JOHN DOE
GRADES2: BLAH BLAH BLAH

NAME: JOHN DOE
GRADES3:BLAH BLAH BLAH 
```

然后我想在文本框中输入另一个“NAME”来替换**所有“JOHN DOE's”**，例如：**“HULK HOGAN”**

```
EXPECTED RESULT: 
```

文件：

```
NAME: HULK HOGAN
GRADES:BLAH BLAH BLAH BLAH

NAME: HULK HOGAN
GRADES2: BLAH BLAH BLAH

NAME: HULK HOGAN
GRADES3:BLAH BLAH BLAH 
```

这可能吗？？？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T23:56:43.107

当然，只需获取旧字符串，并将其放入新字符串中。

```
TextView tv; //Get the pointer to the textbox, included for definition
String text=tv.getText();
tv.setText(text.replaceAll(....)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T23:56:56.167

是的。

例如（假设你有一个`TextView`id `textView`）

```
TextView t = (TextView) findViewById (R.id.textView);
String text = t.getText().toString();
String replaced = text.replaceAll (/*your implementation*/);
t.setText (replaced); 
```

`EditText`s 的方法相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-28T23:58:30.830

你可以这样做：

```
String myName = myEditText.getText().toString();
myText.replaceAll("John Doe", myName); 
```

# struts2 - struts jasperreports 插件和 jasper 结果类型出错

> ID：14573404
> 
> 赞同：0
> 
> 时间：2013-01-28T23:54:02.417
> 
> 标签：struts2, jasper-reports

我正在尝试使用 struts2-jasperreports 插件，但类型结果出现错误：

> 严重：调度程序初始化失败无法加载配置。- [未知位置] 在 org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:390) 在 org.apache.struts2 的 com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:69)。 dispatcher.Dispatcher.init(Dispatcher.java:437) at org.apache.struts2.dispatcher.FilterDispatcher.init(FilterDispatcher.java:193) at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:264)在 org.apache.catalina.core.ApplicationFilterConfig.(ApplicationFilterConfig.java:120) 在 org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4685) 在 org.apache.catalina.core.StandardContext.start( StandardContext.java:5377) 在 com.sun.enterprise.web.WebModule。

我用谷歌搜索了如何解决它，但没有，我想有正确的配置，但也许有人可以看到我的错误，请帮助我！

我正在使用 struts2 jasperreports 和注释。我的 struts.xml

```
 <package name="default" extends="struts-default, jasperreports-default">
            <result-types> 
           <result-type name="jasper" class="org.apache.struts2.views.jasperreports.JasperReportsResult" /> 
   </result-types>  
   </package> 
```

动作文件

```
import com.opensymphony.xwork2.ActionSupport;

import java.net.URL;
import java.util.HashMap;
import java.util.Map;
import net.sf.jasperreports.engine.JasperCompileManager;
import org.apache.struts2.convention.annotation.Action;
import org.apache.struts2.convention.annotation.Result;

public class GenerarReportesAction extends ActionSupport {
private Map<String,Object> params;
private int numsol;

       @Action(value = "imprimirVale", results = {
        @Result(name = "success", type="jasper", 
            params={"location","/Reportes/ValeAlmacen.jasper"," format", "PDF", "reportParameters","%{params}","documentName","vale_almacen.pdf"})})
    @Override
    public String execute() throws Exception {

        try {
            JasperCompileManager.compileReportToFile(
                    "Reportes/ValeAlmacen.jrxml",
                    "Reportes/ValeAlmacen.jasper");
            params = new HashMap<String,Object>();
            URL img = getClass().getClassLoader().getResource("../../img/IQFALOGO.jpg");
            params.put("img",img.toString() );

           params.put("numsol",numsol);

        } catch (Exception e) {
            e.printStackTrace();
            return ERROR;
        }

        return SUCCESS;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T08:03:10.857

这就是答案：

> 类 [class Actions.GenerarReportesAction] 上的结果注释或由文件扩展名确定，或者是操作的 PackageConfig 的默认结果类型，找不到为 Struts/XWork 包定义的结果类型 [Actions#convention -默认＃]

要使用您自己的包（默认），您可以：

*   使用[ParentPackage 注释](http://struts.apache.org/2.x/docs/convention-plugin.html#ConventionPlugin-ParentPackageannotation)
*   在 struts.xml 中定义 struts.convention.default.parent.package

# php - PHP图像调整最小宽度高度

> ID：14573405
> 
> 赞同：-1
> 
> 时间：2013-01-28T23:54:08.837
> 
> 标签：php, image-resizing

有人可以帮我算一个方程式吗？我想缩小图像的大小，使其最小宽度或高度为 200 像素。所以，如果原件是 500 x 300，它最终会是 333 x 200，如果原件是 500 x 900，它最终会是 200 x 360，依此类推。如果任一原始尺寸小于 200 像素，则不会调整大小。

我很感激对此的任何意见。我确信它很简单，我似乎无法解决它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-28T23:59:41.817

你只需要计算出现有的图像比例并从中进行数学计算。该比率是图像宽度与高度的比较，反之亦然（通常较长的除以较短的，得到的比率 >= 1）。例如，宽度 450 和高度 300 的宽度比为 1.5。这意味着图像的宽度是其高度的 1.5 倍。然后，您可以将“最小”值乘以比率以获得其他尺寸，或者如示例中所示，如果您的身高为 200，则另一侧将是最小 * 比率或 200 * 1.5，这使得尺寸为 300 宽和 200 高。

```
$height = 500;
$width = 300;
$min = 200;
if($width > $height){
    $ratio = $width/$height;
    $height = $min;
    $width = round($min * $ratio);
} else  {
    $ratio = $height/$width;
    $width = $min;
    $height = round($min * $ratio);
}

echo "Width: $width<br>";
echo "Height: $height<br>"; 
```

[http://codepad.viper-7.com/RsxAsC](http://codepad.viper-7.com/RsxAsC)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:06:53.970

显然，您希望最小的一面适合 200 像素，但不要放大。我会做这样的事情

```
if ($width > 200 || $height > 200) {
     if ($width > $height) {
          $ratio = (200 / $height);
     } else {
          $ratio = (200 / $width);
     }

     $resizedWidth = $ratio * $width;
     $resizedHeight = $ratio * $height;
} 
```

代码不完整，只是一个起点，希望对您有所帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T05:38:22.527

如果你的服务器安装了 php imagick 扩展，你可以使用函数cropThumbnailImage()

[http://php.net/manual/en/imagick.cropthumbnailimage.php](http://php.net/manual/en/imagick.cropthumbnailimage.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-04-16T10:55:13.977

我将[Jonahtan](https://stackoverflow.com/a/14573464/8970591)的答案改得更短一些，并且您只计算一次比率：

```
// Set image dimensions for testing
$imgWidth = 100;
$imgHeight = 250;

// Minimal dimension requirements 
$minDim = 300;

if ($imgWidth < $minDim || $imgHeight < $minDim) {
    $ratio = $imgWidth / $imgHeight;
    if( $ratio > 1) {   // Width is greater
        $imgHeight = $minDim;
        $imgWidth = round($minDim * $ratio);
    }
    else {  // Height is greater
        $imgWidth = $minDim;
        $imgHeight = round($minDim / $ratio);
    }
}

echo "Width: $imgWidth<br>";
echo "Height: $imgHeight<br>"; 
```

# javascript - 使用 popcorn.js 迭代 cue 方法

> ID：14573407
> 
> 赞同：3
> 
> 时间：2013-01-28T23:54:16.233
> 
> 标签：javascript, oop, javascript-objects, popcornjs

我正在尝试在视频中设置多个提示点。我不想将每个提示都写出来，而是想遍历一个包含我需要的数据的对象，例如提示的时间以及有关如何处理回调的一些信息。

问题是当我尝试迭代对象时，它会覆盖除最后一个之外的所有提示。

```
var products = myVideo.products;
var video = Popcorn('#mainVideo');

    for (product in products){
        var obj   = products[product],
            start = obj.start,
            img   = obj.image,
            $targetDiv  = $("#"+obj.targetDiv);

        video.cue( start, function(){
            $('<img>', {
            class : "isImage",
            src : 'images/' + img
            }).prependTo( $targetDiv );
        })

    } 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T15:27:14.807

在这段代码中，每个 cue 都有自己的回调函数，但每个函数都引用同一个变量`img`和同一个`$targetDiv`. 到它们运行时，这些变量将被设置为它们各自的值，用于`products`.

如果您曾经通过[jslint](http://www.jslint.com/)运行代码并看到警告，请不要在循环中创建函数，这就是原因。做你想做的事情的一个好方法是将这些变量放在一个函数中，该函数会立即被调用并返回另一个函数，这是你的回调。像这样：

```
function makeCallback(obj) {
    return function() {
        $('<img>', {
        class : "isImage",
        src : 'images/' + obj.img
        }).prependTo( $("#"+obj.targetDiv) );
    };
}

for (var product in products) {
    var obj = products[product];
    video.cue( obj.start, makeCallback( obj ) );
} 
```

或者，您可以使用[forEach](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/forEach)，它在引擎盖下做同样的事情。（Popcorn 提供[了自己的版本](http://popcornjs.org/popcorn-docs/utility-methods/#Popcorn.forEach)，它同时处理数组和对象。）

```
Popcorn.forEach(products, function(obj) {
    video.cue( start, function(){
        $('<img>', {
        class : "isImage",
        src : 'images/' + obj.img
        }).prependTo( $("#"+obj.targetDiv) );
    });
}); 
```

我应该注意到，这段代码还有另一个问题，即每次通过提示点时，爆米花都会创建一个新图像。因此，如果用户跳回回放某些视频，图像就会开始堆积。此外，图像直到它们变得可见时才会开始加载，因此如果网络连接速度较慢，图像可能不会显示，直到为时已晚。

处理这些问题的最佳方法通常是提前创建图像，但使用 CSS 使它们不可见，然后让 Popcorn 事件在正确的时间使它们可见。您可能会考虑使用[图像](http://popcornjs.org/popcorn-docs/plugins/#Image)插件，它将为您完成大部分繁重的工作。

# c++ - Visual Studio 2012 项目文件“”已重命名或不再在解决方案中

> ID：14573411
> 
> 赞同：46
> 
> 时间：2013-01-28T23:54:44.893
> 
> 标签：c++, visual-studio, visual-studio-2012

我最近升级了我的 IDE，但没有将我的编译器从 VS2010 升级到 VS2012，现在我的解决方案之一遇到了问题。当我尝试构建它时，我收到以下消息。

> 项目文件已重命名或不再在解决方案中

当我尝试构建单个项目时，我收到以下消息

> 构建已经在进行中

我已经尝试删除并重新添加所有项目，但这没有帮助。我什至用所有相同的项目创建了一个全新的解决方案，但是当我尝试构建时，我遇到了与原始解决方案相同的错误。

我读过很多人有类似的问题，但到目前为止，他们的解决方案都没有帮助我。

一个建议是看看是否有任何项目缺少参考，但我不完全确定如何去做。

我尝试删除引用并重新添加它们，但每次我尝试重新添加它们时，我都会收到相同的错误“项目文件''已被重命名或不再在解决方案中”

任何帮助或建议都会很棒！

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-02-06T06:13:43.097

我有同样的问题，并通过确保其他项目引用的每个项目都包含在解决方案中来解决它。

右键单击第一个项目，选择 References... 并确保包含 References 下列出的每个项目。转到下一个并执行相同的操作。

这解决了我的“项目文件''已重命名或不再在解决方案中”的问题。不确定“构建已在进行中”的问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-07-11T18:00:06.010

我可以确认 the_mantrill 的情况。（作为答案发布，因为这不适合评论。）

在我的解决方案中，项目 A 引用了项目 B。出于某种原因，项目 B 的项目 GUID 发生了变化。（我知道这可能会发生，我没有调查在我们的案例中是什么原因造成的。）解决方案文件具有项目 B 的正确新 GUID，但在项目 A 的项目文件中，对项目 B 的引用仍然具有旧 GUID。

通过在解决方案资源管理器中卸载和重新加载项目，我发现项目 A 导致“*项目文件已被重命名或不再在解决方案中。* ”一旦发现，手动更新项目 B 在项目 A 的项目文件中的 GUID 修复了问题。

细节：

*项目B.vcxproj*

```
<PropertyGroup Label="Globals">
    <Keyword>Win32Proj</Keyword>
    <ProjectGuid>{9CF2493A-0C79-88E7-12ED-7DFAEBA8535B}</ProjectGuid>
</PropertyGroup> 
```

在过去的某个时候，ProjectB 的 ProjectGuid 曾经是`{d6f1934a-905f-77ca-49c0-164b2171a0f6}`. 现在是`{9CF2493A-0C79-88E7-12ED-7DFAEBA8535B}`。

*ProjectA.vcxproj* – 之前，导致“*项目文件 '' 已重命名或不再在解决方案中。* ”

```
<ItemGroup>
    <ProjectReference Include="..\ProjectB\ProjectB.vcxproj">
        <Project>{d6f1934a-905f-77ca-49c0-164b2171a0f6}</Project>
    </ProjectReference>
    :
</ItemGroup> 
```

*ProjectA.vcxproj* – 手动编辑后，现在可以使用：

```
<ItemGroup>
    <ProjectReference Include="..\ProjectB\ProjectB.vcxproj">
        <Project>{9CF2493A-0C79-88E7-12ED-7DFAEBA8535B}</Project>
    </ProjectReference>
    :
</ItemGroup> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-08T21:37:03.003

从 VSO 迁移到现场 TFS 后，删除 .suo 并重新加载对我有用有一些问题

[项目文件已被移动重命名或不在您的计算机上](https://stackoverflow.com/questions/2002088/the-project-file-has-been-moved-renamed-or-not-on-your-computer)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-06T09:20:34.813

当我有两个针对不同产品的解决方案文件时，我似乎出现了这个问题，但它们有几个共同的项目。这些是我在 VS2012 中第一次打开的 VS2010 项目。打开第一个时，所有项目都已转换。然后在加载第二个时出现问题，因为一些项目已经转换。似乎项目引用在第一个解决方案中已更新，但对于第二个解决方案，它必须处理更新一些项目但使用公共项目的已更新版本。

最后，为了解决它，我不得不删除然后重新添加几个项目（以及项目引用），这似乎解决了问题。删除构建文件夹和其他临时文件（例如 .suo）也是值得的，因为其中一些文件的状态会影响项目引用问题（我真的没想到）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-06T01:46:45.863

此问题通常是由项目版本转换器引起的。

交易是**解决方案中的项目中的引用项目不再在解决方案中**（正如我所说，原因是转换或手动删除中的问题）。

因此**，您必须查看所有项目引用**( `Right click on the project -> "References..."`) 并**检查解决方案中是否存在每个引用的项目 - 否则将缺少的项目添加到解决方案或删除无效修饰符。**

此遮阳篷基于现有的遮阳篷： [https ://stackoverflow.com/a/14722733/1107020](https://stackoverflow.com/a/14722733/1107020)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-19T05:51:12.833

Exactly once, at first I did not believe the measures "make sure all the references there" was successful.

Finally I try to check all projects, especially web project in solution I, Seriously there are unavailable. I delete the reference and voila, it works!

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-11T07:24:47.683

将项目复制到另一个文件夹并重新打开时遇到问题最后我通过以下方式解决了问题：1.右键单击项目2.打开引用选项3.删除页面中的引用项目

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-21T17:07:03.220

我有同样的症状，但是一个非常不同的原因，因此，解决方案。

在从 VS 2003 => 2005> => 2008 => 2010 => 2012 迁移时，在最后一步中，**Resources.resx**文件消失了。因此消息

> “项目文件 '' 已重命名或不再在解决方案中。”

对我来说，它不是“*项目*文件”，而是“*项目*文件”。（有些人说语法不重要。）

我找到了丢失的**Resources.resx**文件，对我来说一切都很好。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-10-11T09:09:42.323

确保解决方案中的所有项目文件 (*.vcxproj) 都在其中定义了匹配的 GUID，如下所示：

```
<PropertyGroup Label="Globals">
    <ProjectGuid>{B4D8DE30-8DCC-85FC-ABFE-3ED6S9F873C0}</ProjectGuid>
</PropertyGroup> 
```

由于某些奇怪的原因，从 VS2008 转换的项目没有那个，并且 VS2010每次加载解决方案时都坚持在*解决方案文件中替换所有项目的 GUID，***但从未真正将它们添加到项目文件**中。

# amazon-web-services - 多个 EC2 工作人员可以“使用”同一个 IP 地址吗？

> ID：14573418
> 
> 赞同：2
> 
> 时间：2013-01-28T23:55:23.017
> 
> 标签：amazon-web-services, amazon-ec2

设置：

*   用于排队作业的 SQL
*   用于运行作业的 EC2 工作人员（通过 CloudWatch 自动扩展）

问题：

随着作业的运行，它们中的许多都需要连接到具有非常严格的安全策略的第三方系统。因此，访问这些系统的唯一方法是提前将我们员工的 IP 地址列入白名单。但是，随着新 EC2 实例的启动，它们（显然）将具有不同的 IP 地址。

怎样才能让所有工作人员的请求都来自一个单一的静态 IP 地址？我在 AWS 中没有看到任何涵盖此内容的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:46:14.443

您可能需要在带有 VPC 路由器的虚拟私有云中运行您的实例，以便您可以控制机器的 NAT 转换。在此处查看文档作为起点：

[http://aws.amazon.com/vpc/](http://aws.amazon.com/vpc/)

# jquery - 在隐藏的 iframe 中时，jquery 高度和宽度函数在 Internet Explorer 9 中不起作用

> ID：14573420
> 
> 赞同：0
> 
> 时间：2013-01-28T23:55:28.550
> 
> 标签：jquery, internet-explorer

当我的代码嵌入到一个 iframe 中时，该 iframe 开始时隐藏在父页面中，无论 css 设置为什么， jquery 都会运行`$(window).width()`并返回 0。`$(window).height()`然后，一旦 iframe 设置为可见，则不会引发 resize 事件，因此无法判断父页面已使其可见。

这是一个简单的问题示例[http://www.mapdevelopers.com/test_large.html](http://www.mapdevelopers.com/test_large.html)

现在我能想出的唯一解决方案是检查一个时间间隔，看看`$(window).width()`它的值是否超过 0，并在它完成后相应地加载页面，但我认为必须有更好的方法来做到这一点。

有任何想法吗？

# c++ - C++：cout 语句是否会使代码变慢

> ID：14573424
> 
> 赞同：8
> 
> 时间：2013-01-28T23:55:33.687
> 
> 标签：c++

我正在从一个文件中读取大约 300 万行并将它们插入到 STL 映射中。因此，在我从文件中读取每一行的 while 循环中，我还通过一个简单的 cout 语句打印以控制台它是什么行号。我的一位朋友最近指出，这会使代码变慢。我想知道这是不是真的，如果是为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T00:10:56.160

如前所述，写入终端几乎肯定会变慢。为什么？

*   缓冲：

写入终端`line buffering`默认使用 *。*这意味着每次*遇到换行符时都会传输缓冲区的内容。写入文件时，仅当缓冲区已满或手动刷新流时才会刷新缓冲区。这是造成差异的主要原因，因为 I/O 操作的数量显着不同。

*：这对于 Unix 实现是正确的，但其他实现可能是无缓冲的（参见评论中的讨论）。

*   渲染：

当您写入终端时，这涉及在屏幕上呈现，并且取决于终端可能涉及可能减慢程序速度的其他操作（并非所有终端都相同，您可能会通过切换到不同的）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-29T01:30:48.693

> 如前所述，写入终端几乎肯定会变慢。为什么？

*   根据您的操作系统，`std::cout`可能会使用行缓冲 - 这意味着每行可以单独发送到终端程序。当您使用`std::endl`而不是 '\n' 时，它肯定会刷新缓冲区。以较小的块写入数据意味着额外的系统调用和渲染工作会显着减慢速度。

*   一些操作系统/编译器甚至更慢 - 例如，Visual C++：[https ://connect.microsoft.com/VisualStudio/feedback/details/642876/std-wcout-is-ten-times-slower-than-wprintf-performance -c 库中的错误](https://connect.microsoft.com/VisualStudio/feedback/details/642876/std-wcout-is-ten-times-slower-than-wprintf-performance-bug-in-c-library)

*   显示输出的终端需要调用以清除现有屏幕内容、渲染字体、更新滚动条、将行复制到历史记录/缓冲区中。尤其是当他们获得小块的新内容时，他们无法可靠地猜测他们需要等待多长时间，并且可能会尝试更新他们收到的一小部分内容：这是昂贵的，而且过度刷新或无缓冲输出缓慢的原因。

    *   一些终端提供“跳转滚动”选项，这意味着如果他们发现他们说落后 10 页，他们会立即呈现最后一页，而前 9 页的内容永远不会出现在屏幕上：这既好又快。尽管如此，“跳转滚动”并不总是被使用或想要，因为它意味着输出永远不会呈现给最终用户的眼睛：也许程序在某些情况下会打印一个巨大的红色错误消息 - 跳转滚动甚至不会闪烁一下就可以引起用户的注意，但是如果没有跳转滚动，您可能会注意到它。

    *   当我在彭博工作时，我们有一个持续不断的日志文件更新流，占用了几个监视器——有时显示的输出会落后几分钟；从默认的 Solaris xterm 切换到 rxvt 确保它始终保持同步

*   redirecting output to /dev/null is a good way to see how much your particular terminal is slowing things down

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-28T23:56:57.947

这几乎可以肯定是真的。向终端写入以减慢速度而臭名昭著。运行你的程序并将输出重定向到一个文件，看看它有多快。然后将输出语句全部取出，再次测量。您将立即看到该行为。

这是一个脑残的例子：

```
#include <stdio.h>

int main(void)
{
    int i;

    for (i = 0; i < 10000; i++)
    {
        printf("Hello, world!\n");
    }
    return 0;
} 
```

我构建了这个未优化的程序并运行它，一次输出到终端，一次输出到文件。终端输出的结果：

```
real 0m0.026s
user 0m0.003s
sys  0m0.007s 
```

重定向 I/O 的结果：

```
real 0m0.003s
user 0m0.001s
sys  0m0.001s 
```

就这样，速度快了约 8 倍。那是为了极少数的印刷品！

# ios - 在弹出窗口可见并且我的 UITableView 移动时旋转 iPad

> ID：14573426
> 
> 赞同：1
> 
> 时间：2013-01-28T23:55:54.063
> 
> 标签：ios, ipad, uisplitviewcontroller

这真的很奇怪，我不确定到底发生了什么。

我的 iPad 应用程序上有一个 UISplitViewController。我可以一遍又一遍地从纵向旋转到横向，并且完全按预期工作。但是，如果我处于纵向并且我点击按钮以显示包含 UISplitViewController 左侧的弹出框，然后在可见时旋转，则当旋转完成时，左侧表格现在被推送向下在它和导航栏之间留下一个黑色的间隙。

到底是什么原因造成的？

我已经注释掉了我的`-willRotateToInterfaceOrientation:duration`和`-didRotateFromInterfaceOrientation:`方法，问题仍然存在，所以它不是由我的轮换代码引起的。（该代码只是明确地取消了该弹出窗口）。

在导致问题的旋转之后，我递归地打印出左侧的视图层次结构以及帧大小：

```
UILayoutContainerView ({{0, 0}, {320, 748}})
     UINavigationBar ({{0, 0}, {320, 44}})
     UILayoutContainerView ({{0, 37}, {320, 711}})
         UINavigationTransitionView ({{0, 0}, {320, 711}})
             UIViewControllerWrapperView ({{0, 44}, {320, 667}})
                 UIView ({{0, 0}, {320, 667}})
                     UITableView ({{0, 0}, {320, 667}}) 
```

它显示导航栏高 44 像素，包含我的左侧视图控制器的视图容器从 0,44 开始，我的表格视图从 0,0 开始，但更短....我不明白为什么无法正确显示。

这是横向方向的外观。在左侧，您会看到表格部分标题“您想知道什么？” 它位于导航栏的正下方，带有“切换到计算器”按钮。

![在此处输入图像描述](../Images/2bebc55a91aadf3038cadfd58f2d561d.png)

当我切换到纵向并点击“你想知道什么？” 按钮，弹出框显示其中包含带有 UITableViewController 的左侧导航控制器。

![在此处输入图像描述](../Images/aad850d0c33c270d21b90194bc76887f.png)

现在，当我旋转回横向时，导航栏和 UITableView 之间会出现黑色间隙。

![在此处输入图像描述](../Images/620fb8f5df2a264f9adf06aea077eb9a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T01:02:38.537

我记得去年在开发这个应用程序时遇到了一个与此非常相似的问题，但我找不到任何关于它的旧 StackOverflow 帖子。但是，我记得在纵向模式下我在弹出框内包含导航栏（或者更确切地说，使其可见）是有原因的。出于美学目的，我宁愿让它在横向中可见，但在纵向弹出窗口中不可见.. 然后我记得我包含它的原因是因为它似乎解决了这个问题。

这似乎是 iOS 中的一个奇怪的错误，但显示导航栏两种情况似乎都可以解决它。所以，我决定把它改回我真正想要的样子：横向可见，纵向不可见……还有 BAM。黑色的缝隙消失了。所以，奇怪的错误似乎仍然存在，但它现在正在反向工作。

```
- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
        UIDeviceOrientation deviceOrientation = [UIApplication sharedApplication].statusBarOrientation;
        BOOL isPortrait = UIDeviceOrientationIsPortrait(deviceOrientation);

        if (isPortrait) {
            self.navigationController.navigationBarHidden = YES;
        } else {
            self.navigationController.navigationBarHidden = NO;
        }
    }
} 
```

# asp.net-mvc - html 标记中的西里尔字符不正确，但视觉上正确

> ID：14573429
> 
> 赞同：0
> 
> 时间：2013-01-28T23:56:13.717
> 
> 标签：asp.net-mvc, character-encoding, url-encoding

我正在 mvc4 中开发一个站点，该站点的内容包括拉丁字符和西里尔字符。两者都包含在标记中，并且都在屏幕上正确显示。

但是，在标记中，我看到了西里尔字母的问题，例如 url 如下所示：

/%d1%81%d0%bf%d0%b8%d1%81%d0%be%d0%ba%20%d0%bf%d0%be%d0%b6%d0%b5%d0%bb%d0% b0%d0%bd%d0%b8%d0%b9

单击时 url 导航正确，但在 html 标记中不正确。我在元标记中将元字符集设置为 utf-8。

有什么想法是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T05:52:21.347

您看到的是正确的[%-encoded](https://www.rfc-editor.org/rfc/rfc3986#section-2.1)（又名 URL-encoded）形式的 URL “/список пожеланий”（正如您使用[解码器](http://www.albionresearch.com/misc/urlencode.php)看到的那样）。浏览器可能会在其地址栏中将 URL 显示为 % 编码或解码为字符。HTML 创作软件，或者在 HTML 代码的手动编辑中，作者应该注意对任何需要在 HTTP 协议级别进行 % 编码的内容进行 % 编码，例如`href`属性值。

# if-statement - if语句后如何批量使用括号？

> ID：14573430
> 
> 赞同：0
> 
> 时间：2013-01-28T23:56:26.747
> 
> 标签：if-statement, batch-file

我正在尝试用批处理创建一个简单的猜数游戏。但是，我从来没有能够正确使用括号。代码是：

```
@echo off
::This is a game that has you guess a random number.
Title Random Number Game
set number=%random%
:guess
set /p guess1= Guess the number I'm thinking of!
if %guess1%LSS%number% (
echo Higher!
goto guess
)
if %guess1%GTR%number% (
echo Lower!
goto guess
)
echo You got it! Awesome Job! 
```

无论我的猜测是高于还是低于数字，输入后，cmd返回，“（此时不是预期的。”我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:23:30.353

你几乎把一切都说对了。您只需要在比较运算符周围留一个空格

```
if %guess1% LSS %number% (
  echo Higher!
  goto guess
)
if %guess1% GTR %number% (
  echo Lower!
  goto guess
) 
```

# iphone - Monotouch.Dialog：添加没有“飞入”动画的部分

> ID：14573438
> 
> 赞同：0
> 
> 时间：2013-01-28T23:56:58.810
> 
> 标签：iphone, ios, uitableview, xamarin.ios, monotouch.dialog

制作并显示根元素后，我有时需要添加一个新部分：

```
this.Root.Add(MyNewPopulatedsection); 
```

问题是新的部分在动画中从右侧“飞入”。

如何添加一个部分，但没有动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T09:50:47.880

很可能这是非常低效的，但是您可以只使用新旧部分创建新的 Root 元素，然后将 DialogViewController.Root 重新分配给它。

# java - 将 X509 值传递给 LDAP 服务器

> ID：14573439
> 
> 赞同：1
> 
> 时间：2013-01-28T23:57:11.033
> 
> 标签：java, spring, spring-security, ldap, x509

我正在努力在我的项目中实施 Spring Security。我需要使用 Spring Security 从证书 CN 中提取的用户名作为`uid`LDAP 服务器上的用户名。我不确定解决这个问题的正确方法。我不确定如何将 CN 值从 x509 传递到 LDAP 身份验证器。有人以前做过这个或有任何想法吗？

注意：我不需要将整个证书传递给 LDAP 服务器，因为它们没有存储在那里，只有来自 CN 的用户名。

编辑：这是我的 spring security xml 文件中的一些配置：

```
<http>
    <intercept-url pattern="/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <anonymous />
    <x509 subject-principal-regex="CN=(.*?)," /> <!-- user-service-ref needed? -->
</http>

<ldap-server id="ldapServer" url="ldap://localhost:389/dc=example,dc=com" manager-dn="cn=manager,dc=example,dc=com" manager-password="myPassword" />

<authentication-manager>
    <ldap-authentication-provider
       user-dn-pattern="uid={0},ou=people"
       user-search-filter="(uid={0})"
       user-search-base="ou=people,dc=example,dc=com"
       group-search-filter="(member={0})"
       group-search-base="ou=groups"
       group-role-attribute="cn" />        
</authentication-manager> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:25:33.623

你应该使用一个[`ldap-user-service`](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-ldap-user-service). 这是来自 Spring Security 测试套件[的示例配置。](https://github.com/SpringSource/spring-security/blob/master/itest/web/src/main/webapp/WEB-INF/ldap-provider.xml#L20)然后 Spring Security 应该自动替换它从证书 CN 中提取的用户名来代替`{0}`LDAP 搜索过滤器中的标记。

该`ldap-authentication-provider`元素用于使用用户名和密码对用户进行身份验证，这不是 X.509 想要的，其中容器对证书的验证被视为执行身份验证。

Spring Security 的 X.509 身份验证过滤器需要一个`UserDetailsService`为用户加载信息，因此您需要在配置中使用一个。如[手册中所述](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#x509)`user-service-ref`，如果只有一个属性，则不需要使用该属性，因此只需添加`ldap-user-service`声明就足够了。

# jquery - jQuery DateTimePicker 不显示时间选择器

> ID：14573442
> 
> 赞同：1
> 
> 时间：2013-01-28T23:57:22.737
> 
> 标签：jquery, jquery-ui, datetimepicker

使用 Rails 3.2（jQuery 已作为 gem 安装）

实际的日期选择器部分有效，但我没有看到时间选择器部分的滑块。它甚至没有出现在 HTML 中——`<div class="ui-timepicker-div">`没有出现在任何地方！

在我的脑子里：

```
<%= javascript_include_tag "jquery-ui.min.js" %>
<%= javascript_include_tag "jquery-ui-timepicker-addon.js" %>
<%= stylesheet_link_tag    "jquery-ui.css" %> 
```

在我看来：

```
$("#event_start_time,#event_end_time").each(function(index){
    $(this).datetimepicker({
    duration: 'fast',
    dateFormat: 'yy-m-dd',
    timeFormat: 'hh:mm tt',
    defaultTimezone: '-0500',
    stepMinute: 5,
    ampm: true
    });
}); 
```

timepicker-addon.css

```
/* css for timepicker */
.ui-timepicker-div .ui-widget-header { margin-bottom: 8px; }
.ui-timepicker-div dl { text-align: left; }
.ui-timepicker-div dl dt { height: 25px; margin-bottom: -25px; }
.ui-timepicker-div dl dd { margin: 0 10px 10px 65px; }
.ui-timepicker-div td { font-size: 90%; }
.ui-tpicker-grid-label { background: none; border: none; margin: 0; padding: 0; }

.ui-timepicker-rtl{ direction: rtl; }
.ui-timepicker-rtl dl { text-align: right; }
.ui-timepicker-rtl dl dd { margin: 0 65px 10px 10px; } 
```

在呈现的 HTML 中，除了 timepicker 添加的内容外，输入上没有类名。我有最新的 jquery-ui.js 文件和 timepicker-addon.js 文件。我也尝试过将 jquery-ui-sliderAccess.js 添加到头部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:36:33.693

jQuery 1.9 显然不支持您使用的 datetimepicker 版本。您应该使用`jquery-ui-rails`包含能够支持 datetimepicker 插件的早期静态 jQuery 版本的 gem，而不是总是针对最新版本的 jQuery。

# c# - 构造 JSON 有效负载

> ID：14573444
> 
> 赞同：0
> 
> 时间：2013-01-28T23:57:28.347
> 
> 标签：c#, asp.net, json

我有下表：

![桌子](../Images/4a31d08442feeb491ceef5787869ac13.png)

我想执行一个序列化的 LINQ 查询：

**JSON：**

```
{
  "product-list": {
    "products": [
        {
          "P_Flavor": [
            "Berry",
            "Cedar",
            "Cherry",
            "Coffee"
          ],
          "P_Winery": [
            "Lyeth"
          ],
          "P_Body": [
            "Elegant",
            "Firm",
            "Firm Tannins",
            "Polished",
            "Supple",
            "Tannins"
          ],
          "P_Name": "A Red Blend",
          "P_DateReviewed": "08/31/95",
          "P_WineID": 34699,
          "P_Score": 5,
        }
    ]
  }
} 
```

我通常`JavaScriptSerializer`会这样做，但是我想构建自己的 JSON 有效负载。

```
IList<record_property> recList = (from c in entities.record_property
                                    select c).ToList();

var json = new JavaScriptSerializer().Serialize(recList); 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:45:38.163

可能有一种更快/更简洁的方法来做到这一点，但我是通过将 a[`JavaScriptConverter`](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptconverter.aspx)与辅助类型结合来实现的。

转换器（比看起来简单，灵感来自[这里](https://stackoverflow.com/questions/1100191/javascriptserializer-deserialize-how-to-change-field-names)）：

```
private class RecordPropertyJavaScriptConverter : JavaScriptConverter
{
    private static readonly Type[] _supportedTypes = new[]
    {
        typeof(record_group)
    };

    public override IEnumerable<Type> SupportedTypes
    {
        get { return _supportedTypes; }
    }

    public override object Deserialize(IDictionary<string, object> dictionary, Type type, JavaScriptSerializer serializer)
    {
        if (type == typeof(record_group))
        {
            record_group obj = new record_group();

            var kvp = dictionary.Single();

            obj.Key = kvp.Key;
            obj.Values = serializer.ConvertToType<IEnumerable<object>>(kvp.Value);

            return obj;
        }

        return null;
    }

    public override IDictionary<string, object> Serialize(object obj, JavaScriptSerializer serializer)
    {
        var dataObj = obj as record_group;
        if (dataObj != null)
        {
            return new Dictionary<string, object>
            {
                {dataObj.Key,  dataObj.Values}
            };
        }
        return new Dictionary<string, object>();
    }
} 
```

助手类型：

```
private class record_group
{
    public string Key;
    public IEnumerable<object> Values;
} 
```

序列化代码：

```
var groups = recList.GroupBy(r => r.Key)
                    .Select(g => new record_group { Key = g.Key, Values = g.Select(r => r.Value) });

JavaScriptSerializer serializer = new JavaScriptSerializer();
serializer.RegisterConverters(new [] {new RecordPropertyJavaScriptConverter()});
string json = serializer.Serialize(groups); 
```

输出（带有一些标签，我添加了换行符）：

```
[{"P_Flavor":["Berry","Cedar","Cherry","Coffee"]},
 {"P_Winery":["Lyeth"]},
 {"P_Body":["Elegant","Firm","Firm Tannins","Polished","Supple","Tannins"]},
 {"P_Name":["A Red Blend"]},
 {"P_DateReviewed":["08/31/95"]},
 {"P_WineID":[34699]},
 {"P_Score":[5]}] 
```

然后可以进行反序列化（使用与上面相同的序列化程序实例），如下所示：

```
var deserialized = serializer.Deserialize<IEnumerable<record_group>>(json);
var properties = deserialized.SelectMany(g => g.Values.Select(v => new record_property { Key = g.Key, Value = v })); 
```

# css - 为什么 Firefox 对待 Helvetica 和 Chrome 的方式不同？

> ID：14573445
> 
> 赞同：14
> 
> 时间：2013-01-28T23:57:53.293
> 
> 标签：css, fonts, cross-browser, graphics2d, postscript

在 Helvetica 中呈现的文本的垂直位置及其内容区域的大小在 Firefox 和 Mac 版 Chrome 中有所不同。例如，在 Chrome 中，如果 line-height 与 font-size 相同，则会剪裁下降线。

![浏览器之间不同垂直字符位置的演示](../Images/1b7cbf6e942e78835b6690043803cc81.png)

（我已经调整了这张图片中块元素的位置——保持基线一致——以说明大小和文本位置的差异）。[如果你有 Mac，你可以在这个 JS Bin](http://jsbin.com/ubivul/1/edit)中看到我在说什么。

现在，我对如何解决这个特定的差异并不直接感兴趣。我意识到有一些[手动调整的重置样式表](https://stackoverflow.com/questions/10370323/css-font-differences-between-browsers)试图消除或掩盖差异，但我特别感兴趣的是导致这些浏览器首先呈现不同的因素。

我在这里做一些假设：

*   标准盒子模型中字体的渲染和字形的大小和位置都有标准，但在它们如何交互方面可能没有指定。

*   浏览器制造商对上述标准的解释中存在错误，这可能会影响文本的大小、定位和呈现方式。

*   对于这些*特定*的浏览器，大部分设计讨论和实际实现都以某种形式公开。因此，如果一个人知道去哪里寻找，就有可能了解这种差异的来源。

*   两种浏览器都从同一个地方开始——它们之间的标记、样式和字体定义是一致的。在某些时候，他们在如何使用这些来产生最终输出方面存在分歧。

因此，我的具体问题是：**这种分歧发生在过程中的什么地方，*****是**什么*原因造成的？**

我觉得，有了这些知识，我可以更好地理解如何纠正这种差异。特别是在这种情况下，以及我将来可能遇到的类似情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T22:57:14.043

Unfortunately, re: rendering of the content area based on the font, [CSS2.1 does not say much at all](http://www.w3.org/TR/CSS21/visudet.html#inline-non-replaced):

> The height of the content area should be based on the font, but this specification does not specify how. A UA may, e.g., use the em-box or the maximum ascender and descender of the font. (The latter would ensure that glyphs with parts above or below the em-box still fall within the content area, but leads to differently sized boxes for different fonts; the former would ensure authors can control background styling relative to the 'line-height', but leads to glyphs painting outside their content area.)

In other words, typesetting, and how exactly to draw and position the content area of a line box, is left up to the browser's own implementation, at least in CSS2.1\. This may however be better defined in a future specification (likely the [Fonts module](http://www.w3.org/TR/css3-fonts), if not a separate module¹).

[Section 10.8.1](http://www.w3.org/TR/CSS21/visudet.html#leading) contains some details on how the `line-height` property affects the rendering of the content area around text that flows inline, but again it depends on the height of the content area itself, which as stated above is undefined in CSS2.1.

Note that `auto` is not a valid value for `line-height`; you probably meant to use `normal`, which incidentally is also its initial value (but not necessarily the browser default). Also, this is what the spec says about the value `normal`:

> **normal**
> Tells user agents to set the used value to a "reasonable" value based on the font of the element. The value has the same meaning as . We recommend a used value for 'normal' between 1.0 to 1.2\. The computed value is 'normal'.

As you can see, there's not much to go on, even with regards to comparing `line-height: normal` and `line-height: 1` (or `1em` or `100%`), because what constitutes a "normal" line height is up to the browser to decide as well. However, it looks like Chrome and Firefox do a good job of keeping glyphs within reasonable boundaries when asked to use a normal line height.

By the way, Chrome does not *clip* the descenders. It does render them outside of the content box, but it should never clip them to the bounds of the box unless you set `overflow: hidden`.

* * *

¹ [A CSS3 definition of the `line-height` property currently resides in [this module](http://www.w3.org/TR/css3-linebox), but it's immediately obvious that it's been long abandoned, or at least pending a rewrite. The module in its current state is *extremely* detailed, but suffice it to say that it's been largely ignored by both browser vendors and the working group.]

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-01T23:27:40.273

*   '行高是自动的' => 浏览器可以选择。
*   '行高 = 字体大小' => 用户错误：文本将难以辨认，再次对浏览器进行一些调整是合理的，确实是必要的。

你必须使用一些前导。例如，书籍可以在 12pt 行距上设置为 10pt。

# mysql - MySQL - 整数列的大小限制

> ID：14573451
> 
> 赞同：29
> 
> 时间：2013-01-28T23:58:34.807
> 
> 标签：mysql, phpmyadmin, integer

我正在使用 phpMyAdmin 创建我的表结构。

我可以从 MySQL 的文档页面中阅读有关整数类型的大小限制： [MySQL 整数类型参考](http://dev.mysql.com/doc/refman/4.1/en/integer-types.html)

* * *

所以这里是我对创建列有点困惑的地方。

我想在表中创建一列：`tbl_note_categories`称为`notescounter`

我没有预见到自己会在`tbl_notes`任何特定的`categoryid`. 但我相信我会为每个类别创建数百个注释。

我正在选择：tinyint、smallint、mediumint。根据上面的文档链接，我猜 smallint 是我最好的选择。

所以这是我的困惑。PhpMyAdmin 要求指定**长度/值**参数。我要确保这个新列 ( `notescounter`) 是无符号的，最多给我 65536。这是否意味着我需要长度/值是 (5)？

我猜长度是字符长度，但我不确定。（与 varchar 相比）

![PhpMyadmin 中新列的快照](../Images/f9be46c9c85ffdc7bc76e5b736f42a87.png)

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-01-29T00:01:44.817

不，这是对 MySQL 的常见误解。事实上，“长度”对整数的大小或它可以存储的值的范围没有影响。

*   `TINYINT`始终为 8 位，可以存储 2 ⁸个不同的值。
*   `SMALLINT`始终为 16 位，可以存储 2 ^(16 个)不同的值。
*   `INT`始终为 32 位，可以存储 2 ^(32 个)不同的值。
*   `BIGINT`始终为 64 位，可以存储 2 ^(64 个)不同的值。

还有一个 MEDIUMINT，但是从事 MySQL 工作的工程师告诉我，MEDIUMINT 总是在内部被提升为 32 位 INT，因此使用 MEDIUMINT 实际上没有任何好处。

长度*仅*用于显示，仅当您使用该`ZEROFILL`选项时才重要。

[请参阅我对 INT(10) 和 INT(12) 之间有什么区别（应用于我的代码时）的](https://stackoverflow.com/questions/1632403/what-is-the-difference-when-being-applied-to-my-code-between-int10-and-int1/1632567#1632567)回答中的示例？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-29T14:47:44.510

是的，您想指定长度为 5。

在 MySQL 中，整数类型的“长度”属性是可选的。这是一个非标准的 MySQL 扩展）。

当列声明中省略它时，MySQL 提供一个默认值。对于 SMALLINT UNSIGNED，默认值为 5。

该值对整数类型可以存储的值范围没有任何影响。它指定了一个“显示长度”，它在结果集元数据中返回，客户端可以选择使用或忽略它。

[http://dev.mysql.com/doc/refman/5.5/en/numeric-type-attributes.html](http://dev.mysql.com/doc/refman/5.5/en/numeric-type-attributes.html)

# python - 重新排列python pandas数据框

> ID：14573453
> 
> 赞同：2
> 
> 时间：2013-01-28T23:58:44.400
> 
> 标签：python, dataframe, pandas

我有一个熊猫数据框，如下所示

```
 mp  me        rt                                                         
0  0   1   1.987366                                                         
1  1   1   1.769593                                                         
2  2   1   1.416274                                                         
3  3   1   1.650428                                                         
4  4   1   1.882780                                                         
5  0   2   1.955086                                                         
6  1   2   1.729387                                                         
7  2   2   1.490797                                                         
8  3   2   1.546333                                                         
9  4   2   1.933006 
```

我想生成一个新的数据框如下

```
 mp    me=1       me=2                                                    
0  0   1.987366    1.955086                                                 
1  1   1.769593    1.729387                                                 
2  2   1.416274    1.490797                                                 
3  3   1.650428    1.546333                                                 
4  4   1.882780    1.933006 
```

我尝试使用 for 循环但不成功。

```
for j in range(1,3):
    f[str(j)] = pd.DataFrame(a[a['me']==j]['rt']) 
```

知道如何有效地做到这一点吗？

谢谢。担

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T00:10:14.503

```
In [6]: df.pivot_table(values='rt', rows='mp', cols='me', aggfunc=sum)
Out[6]: 
me         1         2
mp                    
0   1.987366  1.955086
1   1.769593  1.729387
2   1.416274  1.490797
3   1.650428  1.546333
4   1.882780  1.933006 
```

# qt - 控制框架及其组件的边框

> ID：14573455
> 
> 赞同：0
> 
> 时间：2013-01-28T23:58:50.257
> 
> 标签：qt, stylesheet

我在 qt qith 中有一个框架，其中包含一些组件。当我更改样式表时，其中的组件也会更改，但我不希望这样，因为我只更改框架的边框。

```
border-width: 1px; 
border-style: inset; 
border-color: #515c84
border-radius: 9px; 
```

边框也有两种颜色，我不知道为什么。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T05:51:37.990

子小部件继承父框架样式表。如果您只想更改框架的视图，请使用此样式表：

```
#frameObjectName {
    border: 1px solid #515c84;
    border-radius: 9px;
} 
```

`frameObjectName`框架的名称在哪里。

边框有两种颜色，因为它是`inset`样式。使用`solid`边框样式获取一种颜色的边框线。

# ios - Rails Devise Api + Facebook iOS SDK，安全问题

> ID：14573456
> 
> 赞同：2
> 
> 时间：2013-01-28T23:58:51.933
> 
> 标签：ios, ruby-on-rails, facebook-graph-api, devise

我目前正在开发一个应用程序，它将使用 FB SDK（第一次）将用户登录到应用程序。我认为流程是典型的。用户点击“使用 facebook 登录”，facebook graph 进行身份验证，然后我们调用我们的 api 并通过我们存档的他们的 facebook 电子邮件（仅）让用户登录。

但是，让我感到害怕的是，理论上，如果有人知道我们的 api_token，并且知道仅使用有效的现有电子邮件将 POST 调用到登录 url 来登录，这不是安全问题，因为他们实际上可以登录作为别人。我是不是想太多了？可以理解的是，他们必须了解 API 的各个方面才能造成任何损害。但是，我仍然对这种流程感到不舒服。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:57:49.083

这不应该是你必须担心的事情。Facebook 首先通过要求用户登录 Facebook 来保护您。接下来，用户的 UID（任何人都可以使用）和您的 API 密钥是不够的。他们仍然需要您的 API 密钥（如果有人拥有它是一件坏事）来像您一样签署请求。

您真正使用的是 OAuth（尽管通过 OmniAuth 设计）。我不是专家，但您可以在这里阅读更多信息：http: [//hueniverse.com/oauth/guide/security/](http://hueniverse.com/oauth/guide/security/)

当用户通过 OAuth 注册时，您不会为他们设置密码，这并不是什么大问题，因为他们还必须先登录 Facebook。如果他们曾经编辑过他们的帐户，要求他们设置密码可能是一个好主意，这也意味着如果他们想要/删除 Facebook/等，他们可以以旧方式登录。

# hadoop - 通过 API 获取 Hbase 区域大小

> ID：14573466
> 
> 赞同：2
> 
> 时间：2013-01-28T23:59:54.287
> 
> 标签：hadoop, hbase

我正在尝试为 Hbase 编写一个平衡器工具，它可以通过区域计数和/或区域大小（storeFile 大小的总和）来平衡整个 regionServers 的区域。我找不到任何返回区域大小或相关信息的 Hbase API 类。我已经检查了一些可用于获取其他表/区域信息的类，例如 org.apache.hadoop.hbase.client.HTable 和 HBaseAdmin。

我在想，另一种实现方式是使用一个 Hadoop 类，它返回文件系统中目录的大小，例如 org.apache.hadoop.fs.FileSystem 列出特定 HDFS 路径下的文件。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T17:58:24.643

我使用它来进行区域的托管拆分，但是，您可以利用它自己进行负载平衡。我还对自己进行负载平衡，以将区域（给定表的）均匀分布在我们的节点上，以便 MR 作业均匀分布。

也许下面的代码片段有用？

```
final HBaseAdmin admin = new HBaseAdmin(conf);
final ClusterStatus clusterStatus = admin.getClusterStatus();

for (ServerName serverName : clusterStatus.getServers()) {
  final HServerLoad serverLoad = clusterStatus.getLoad(serverName);

  for (Map.Entry<byte[], HServerLoad.RegionLoad> entry : serverLoad.getRegionsLoad().entrySet()) {
    final String region = Bytes.toString(entry.getKey());
    final HServerLoad.RegionLoad regionLoad = entry.getValue();
    long storeFileSize = regionLoad.getStorefileSizeMB();
    // other useful thing in regionLoad if you like
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T08:01:21.187

What's wrong with the default [Load Balancer](http://hbase.apache.org/book/master.html#master.processes.loadbalancer)?

From the Wiki:

*The balancer is a periodic operation which is run on the master to redistribute regions on the cluster. It is configured via `hbase.balancer.period` and defaults to 300000 (5 minutes).*

If you really want to do it yourself you could indeed use the [Hadoop API](http://hadoop.apache.org/docs/stable/api/index.html) and more specifally, the `FileStatus` class. This class acts as an interface to represent the client side information for a file.

# ruby - 配置 Jenkins 时遇到问题

> ID：14573468
> 
> 赞同：3
> 
> 时间：2013-01-29T00:00:00.723
> 
> 标签：ruby, jenkins

当我将 ruby​​ 脚本作为构建任务运行时，这是我得到的错误。
我不确定设置有什么问题。

```
my RUBY_HOME "/home/bitnami/.rvm/rubies/ruby-1.9.3-p374" 
```

有任何想法吗？

```
Started by user User Name
Building in workspace /opt/bitnami/apps/jenkins/jenkins_home/workspace/Test
[Test] $ ruby -v /opt/bitnami/apache-tomcat/temp/hudson7369076924945073821.rb
FATAL: command execution failed
java.io.IOException: Cannot run program "ruby" (in directory    "/opt/bitnami/apps/jenkins/jenkins_home/workspace/Test"): error=2, No such file or directory 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-11T02:35:42.393

要在 Jenkins 作业中使用 RVM 管理的 ruby​​，您必须在构建步骤中获取 rvm，例如 . /路径/到/rvm/脚本/rvm。然后你需要设置哪个 ruby​​ 与 rvm 一起使用。我广泛使用它，没有错误。

# mongodb - MongoDB聚合框架按数组长度排序

> ID：14573471
> 
> 赞同：2
> 
> 时间：2013-01-29T00:00:14.820
> 
> 标签：mongodb, pymongo, aggregation-framework

给定以下数据集：

```
{ "_id" : ObjectId("510458b188ce1d16e616129b"), "codes" : [ "oxtbyr", "xstute" ], "name" : "Ciao Mambo", "permalink" : "ciaomambo", "visits" : 1 }
{ "_id" : ObjectId("510458b188ce1d16e6161296"), "codes" : [ "zpngwh", "odszfy", "vbvlgr" ], "name" : "Anthony's at Spokane Falls", "permalink" : "anthonysatspokanefalls", "visits" : 0 } 
```

如何将此 python/pymongo 排序转换为可与 MongoDB 聚合框架一起使用的东西？我正在根据`codes`数组中的代码数量对结果进行排序。

```
z = [(x['name'], len(x['codes'])) for x in restaurants]
sorted_by_second = sorted(z, key=lambda tup: tup[1], reverse=True)
for x in sorted_by_second:
    print x[0], x[1] 
```

这*在*python 中有效，我只想知道如何在 MongoDB 查询端实现相同的目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:20:41.203

```
> db.z.aggregate({ $unwind:'$codes'}, 
                 { $group : {_id:'$_id', count:{$sum:1}}}, 
                 { $sort :{ count: 1}}) 
```

# e-commerce - ActiveMerchant - 我可以将商家 ID 号与 Authorize.net 集成吗？

> ID：14573472
> 
> 赞同：3
> 
> 时间：2013-01-29T00:00:15.740
> 
> 标签：e-commerce, authorize.net, activemerchant

我正在使用 Ruby on Rails 从头开始​​构建电子商务网站。我目前已将 PayPal 集成到该站点中，但客户希望使用更便宜的解决方案（比 PayPal 节省的费用更少。）我没有他们的网站，他们没有集成文档。我得到的只是一个商家识别号 (MID)。支付公司的人说，当购物车网站要求时，我的客户可以使用这个商户识别号。

付款人认为我的客户正在使用像 Volusion 或 Magneto 这样的预打包解决方案。

我可以仅使用商家识别号使用 Authorize.net 支付网关吗？[从这个页面， http://activemerchant.rubyforge.org/classes/ActiveMerchant/Billing/Au​​thorizeNetGateway.html#method-M000393](http://activemerchant.rubyforge.org/classes/ActiveMerchant/Billing/AuthorizeNetGateway.html#method-M000393)看起来，我需要一个 Authorize.Net API 登录 ID 和一个 Authorize.Net 交易密钥。

我错过了付款人的哪些信息？

他说我们可以使用 VeriSign 或 Authorize.net……但是 VeriSign 被 PayPal 收购了，不是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T03:52:50.607

需要商家 ID 以及其他详细信息才能注册 Authorize.Net 帐户。一旦您拥有该帐户，他们将为您提供 API 登录名和交易密钥。然后你。可以将其集成到活跃的商家并接受付款。

# css - Div 没有使用 img 内容获得正确的高度

> ID：14573479
> 
> 赞同：1
> 
> 时间：2013-01-29T00:01:21.197
> 
> 标签：css, html, image

我有一个带有单个 div 的简单页面。在那个 div 里面我有一个尺寸为 [h:58px, w:173px] 的图像。

```
<body>
    <div id="main_header">
        <img src="logo.gif" style="padding: 0; margin: 0;">
    </div>
</body> 
```

它不包含在任何其他标签中。但是，Chrome 将容器 div 的高度计算为 63px。#main_header 没有关联的 css。html 和 body 的 margin 和 padding 都设置为 0。

谁能解释为什么 div 的高度是 63 而不是 58？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:03:59.800

是因为父母的`line-height`。将父级的`line-height`(或) 设置为零，或将图像设置为.`font-size``display: block`

# jquery - 禁用底部工具栏tinymce

> ID：14573484
> 
> 赞同：2
> 
> 时间：2013-01-29T00:02:01.010
> 
> 标签：jquery, mobile, tinymce

我知道这听起来很傻，tinymce 编辑器的全部意义在于有工具栏供用户轻松编辑，但我需要禁用该工具栏以进行移动查看，主要是因为按钮现在太小且难以使用。

我有这段代码，只有当用户在移动设备上时才会调用。

```
tinyMCE.init({
        mode: "textareas",
        theme: "simple",
        width: "800px",
        height: "400px",
        setup: function (e) {
          'validation stuff goes here'          
        }
    }); 
```

任何帮助都会很棒！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:15:15.527

将`theme_advanced_buttons1: ''`（空字符串）添加到`.init`选项（以及按钮 2 和按钮 3）。

# python - Pygments 在 python 脚本中通过管道传输到 less 中断突出显示

> ID：14573485
> 
> 赞同：0
> 
> 时间：2013-01-29T00:02:03.347
> 
> 标签：python, less, pygments

```
from pygments.lexers import RstLexer
from pygments.formatters import TerminalFormatter
from pygments import highlight

output = highlight(source, RstLexer(), TerminalFormatter())

p = subprocess.Popen('less', stdin=subprocess.PIPE)
p.stdin.write(output)
p.stdin.close()
p.wait() 
```

当我只是`print output`- 一切都很好，但管道断裂突出显示......有什么想法吗？

例子：

![例子](../Images/eddba744f2fb258e832b1a67704cf435.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:36:11.750

那`less`是错，不是 Python 的错。`less`使用`-R`开关运行：

> **`-R`或者`--RAW-CONTROL-CHARS`**
> 
> 类似`-r`，但只有 ANSI“颜色”转义序列以“原始”形式输出。与 不同`-r`的是，在大多数情况下，屏幕外观保持正确。ANSI“颜色”转义序列是以下形式的序列：
> 
> ```
> ESC [ ... m 
> ```
> 
> 其中“...”是零个或多个颜色规范字符 为了跟踪屏幕外观，假定 ANSI 颜色转义序列不会移动光标。您可以通过将环境变量 LESSANSIENDCHARS 设置为可以结束颜色转义序列的字符列表来减少“m”以外的字符可以结束 ANSI 颜色转义序列的想法。通过将环境变量 LESSANSIMIDCHARS 设置为可以出现的字符列表，您可以减少在 ESC 和 m 之间出现标准字符以外的字符。

# c# - 带有重复项的 Linq-To-Sql 批量更新

> ID：14573486
> 
> 赞同：2
> 
> 时间：2013-01-29T00:02:08.220
> 
> 标签：c#, .net, sql, linq-to-sql

我正在使用 C# .NET 3.5 中的 LINQ-To-SQL 更新数据库，但我使用的数据并不总是很好。插入的数据和数据库很有可能会重复。

目前，我正在使用它，其中`dataSetOne`和`dataSetTwo`是`dataSetThree`要更新的模型列表：

```
AppDataContext db = new AppDataContext();

db.DatasetOne.InsertAllOnSubmit(dataSetOne);
db.DatasetTwo.InsertAllOnSubmit(dataSetTwo);
db.DatasetThree.InsertAllOnSubmit(dataSetThree);

try
{
    db.SubmitChanges(ConflictMode.ContinueOnConflict);
}

catch (Exception e)
{
    CsvToImsConverter.Log.Error(e.Message);

    foreach (ObjectChangeConflict occ in db.ChangeConflicts)
    {
        MetaTable metatable = db.Mapping.GetTable(occ.Object.GetType());
        Console.WriteLine("Error in Table: {0}", metatable.TableName);
    }
} 
```

这很好用。我遇到的问题是，如果有任何重复，程序不会更新，从而引发主键违规。我想插入没有违反主键的值，并更新那些没有的值。

我可以在数据库中搜索重复项，但由于数据库中可能有数千条记录，而我试图插入数百条记录，这可能会非常昂贵。有什么方法可以捕获主键违规错误，更新此记录并继续？由于不会有很多重复，这将是一个更好的解决方案。使用 LINQ-To-SQL 不是强制性的。

使用循环并使用语句`foreach`将每个对象插入列表中会更好吗？`catch`

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:28:09.473

您担心性能，同时使用 Linq-2-sql 进行批量插入/更新。这不是很一致，因为 linq-2-sql 不适合批处理操作（至少在您需要它们快速的情况下不适合）。

不要被 InsertAllOnSumbit 所迷惑... Linq-2-sql 将为每个插入创建单独的插入语句。这本身就已经很慢了。

您最好将您的 datasetOne/Two/Three 批量插入到临时表中（eq 使用 SqlBulkCopy），然后使用合并语句移动到目标表。

# node.js - 编译 bcrypt 时出错 - node.js

> ID：14573488
> 
> 赞同：24
> 
> 时间：2013-01-29T00:02:26.270
> 
> 标签：node.js, npm, bcrypt

我正在尝试通过`npm install`使用 Windows 7 Ultimate x64 安装 bycrpt。这是我的安装日志：

```
D:\Dropbox\Projekte\RZ\Finance-Man-GUI\node_modules\bcrypt>node "C:\Program File
s\nodejs\node_modules\npm\bin\node-gyp-bin\\..\..\node_modules\node-gyp\bin\node
-gyp.js" rebuild
npm http GET https://registry.npmjs.org/mime/1.2.6
npm http 304 https://registry.npmjs.org/coffee-script
npm http 304 https://registry.npmjs.org/mkdirp
npm http 304 https://registry.npmjs.org/cssom
npm http 304 https://registry.npmjs.org/hooks/0.2.1
npm http 304 https://registry.npmjs.org/mongodb/1.2.8
npm http 304 https://registry.npmjs.org/ms/0.1.0
npm http 304 https://registry.npmjs.org/sliced/0.0.3
npm http 304 https://registry.npmjs.org/muri/0.1.0
npm http 304 https://registry.npmjs.org/mime/1.2.6
npm http GET https://registry.npmjs.org/crc/0.2.0
npm http GET https://registry.npmjs.org/pause/0.0.1
npm http GET https://registry.npmjs.org/bytes/0.1.0
npm http GET https://registry.npmjs.org/formidable/1.0.11
npm http GET https://registry.npmjs.org/qs/0.5.1
npm http GET https://registry.npmjs.org/bson/0.1.5
C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\Microsoft.CppBuild.targets(29
7,5): warning MSB8003: Could not find WindowsSDKDir variable from the registry.
  TargetFrameworkVersion or PlatformToolset may be set to an invalid version nu
mber. [D:\Dropbox\Projekte\RZ\Finance-Man-GUI\node_modules\bcrypt\build\bcrypt_
lib.vcxproj]
  blowfish.cc
  bcrypt.cc
  bcrypt_node.cc
..\src\bcrypt.cc(232): warning C4267: '=' : conversion from 'size_t' to 'unsign
ed char', possible loss of data [D:\Dropbox\Projekte\RZ\Finance-Man-GUI\node_mo
dules\bcrypt\build\bcrypt_lib.vcxproj]
c:\users\timd\.node-gyp\0.8.18\deps\uv\include\ares.h(49): fatal error C1083: C
annot open include file: 'winsock2.h': No such file or directory [D:\Dropbox\Pr
ojekte\RZ\Finance-Man-GUI\node_modules\bcrypt\build\bcrypt_lib.vcxproj]
gyp ERR! build error
gyp ERR! stack Error: `C:\Windows\Microsoft.NET\Framework64\v4.0.30319\msbuild.e
xe` failed with exit code: 1
gyp ERR! stack     at ChildProcess.onExit (C:\Program Files\nodejs\node_modules\
npm\node_modules\node-gyp\lib\build.js:255:23)
gyp ERR! stack     at ChildProcess.EventEmitter.emit (events.js:99:17)
gyp ERR! stack     at Process._handle.onexit (child_process.js:678:10)
gyp ERR! System Windows_NT 6.1.7600
gyp ERR! command "node" "C:\\Program Files\\nodejs\\node_modules\\npm\\node_modu
les\\node-gyp\\bin\\node-gyp.js" "rebuild"
gyp ERR! cwd D:\Dropbox\Projekte\RZ\Finance-Man-GUI\node_modules\bcrypt
gyp ERR! node -v v0.8.18
gyp ERR! node-gyp -v v0.8.2
gyp ERR! not ok
npm ERR! bcrypt@0.7.3 install: `node-gyp rebuild`
npm ERR! `cmd "/c" "node-gyp rebuild"` failed with 1
npm ERR!
npm ERR! Failed at the bcrypt@0.7.3 install script.
npm ERR! This is most likely a problem with the bcrypt package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get their info via:
npm ERR!     npm owner ls bcrypt
npm ERR! There is likely additional logging output above.

npm ERR! System Windows_NT 6.1.7600
npm ERR! command "C:\\Program Files\\nodejs\\\\node.exe" "C:\\Program Files\\nod
ejs\\node_modules\\npm\\bin\\npm-cli.js" "install"
npm ERR! cwd D:\Dropbox\Projekte\RZ\Finance-Man-GUI
npm ERR! node -v v0.8.18
npm ERR! npm -v 1.2.2
npm ERR! code ELIFECYCLE
npm http 304 https://registry.npmjs.org/crc/0.2.0
npm http 304 https://registry.npmjs.org/qs/0.5.1
npm http 304 https://registry.npmjs.org/pause/0.0.1
npm http 304 https://registry.npmjs.org/bson/0.1.5
npm http 304 https://registry.npmjs.org/formidable/1.0.11
npm http 304 https://registry.npmjs.org/bytes/0.1.0

> bson@0.1.5 install D:\Dropbox\Projekte\RZ\Finance-Man-GUI\node_modules\mongoos
e\node_modules\mongodb\node_modules\bson
> node install.js || (exit 0)

================================================================================

=                                                                              =

=  Attempting to build bson c++ extension                                      =

=   Windows: no build will be attempted as binaries are prepackaged            =

=   Unix: on failure the package will still install without the C++ extension  =

=                                                                              =

================================================================================

npm ERR!
npm ERR! Additional logging details can be found in:
npm ERR!     D:\Dropbox\Projekte\RZ\Finance-Man-GUI\npm-debug.log
npm ERR! not ok code 0 
```

我已经安装了 Python < v2.7 和 .NET Framework SDK 2.0。我还下载了一个名为 win7sdkx64.exe 的包，我认为它是 Visual Studio 的 sdk。我喜欢我的所有依赖项，`Path`如下所示：

```
%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\nodejs\;E:\Program Files\Java\jdk1.6.0_38\bin;C:\Program Files (x86)\Heroku\bin;C:\Program Files (x86)\ruby-1.9.2\bin;C:\Program Files (x86)\git\bin;C:\Program Files (x86)\git\cmd;E:\Program Files (x86)\Heroku\bin;C:\mongodb-win32-x86_64-2.2.2\bin;E:\xampp\mysql\bin;E:\xampp\apache\bin;E:\Python27;C:\Program Files (x86)\Microsoft Visual Studio 8\VC\vcpackages;C:\Program Files\Microsoft Windows Performance Toolkit\;E:\Program Files (x86)\openssl-0.9.8k_X64\bin 
```

但我仍然收到这些错误。接下来我可以尝试什么？完全安装 Visual Studio？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-04-09T20:38:34.540

抛弃 bcrypt 模块，改用原生 JavaScript 库。[bcrypt-nodejs](https://github.com/shaneGirish/bcrypt-nodejs)不需要编译，并提供与编译后的 bcrypt 几乎相同的功能。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-07-29T21:15:23.260

**这是在Windows 7/8 x64**上通过 npm安装**bcrypt**的正确方法

 **### 上一篇：

*   安装 Python [http://www.python.org/download/releases/2.7.5/](http://www.python.org/download/releases/2.7.5/)
*   安装 Visual Studio 2012/13 Express（或其他）
*   安装 Windows SDK（适用于 Windows 7 / 8）
*   安装Win64 OpenSSL v1.0.1g

### 邮政：

以管理员身份打开**“VS2012 的开发人员命令提示符”**并测试安装：

```
npm install node-gyp -g
npm install bcrypt -g 
```

ps 我当前的Windows环境：win8 x64，节点0.10.x。一切都很好。

**更新（2016 年）**：Windows 10 x64 的注意事项

Visual Studio Express[桌面版](https://go.microsoft.com/fwlink/?LinkId=691984&clcid=0x409)解决了 node-gyp 问题。只需安装它，它将适用于 node-gyp。

### 链接：

*   [适用于 Windows 桌面的 Microsoft Visual Studio Express 2012](http://www.microsoft.com/en-us/download/confirmation.aspx?id=34673)
*   [Visual Studio Express 2015 桌面版](https://go.microsoft.com/fwlink/?LinkId=691984&clcid=0x409)
*   [视窗 8 SDK](http://msdn.microsoft.com/en-us/library/windows/desktop/hh852363.aspx)
*   [SSL 下载](http://slproweb.com/products/Win32OpenSSL.html)
*   [节点gyp安装](https://github.com/TooTallNate/node-gyp/#installation)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-03T19:55:43.253

我是如何解决这个问题的。

我的环境：Windows 8.1 x64，Node v0.12.2，npm v2.7.5

**安装所有组件：**

1.  安装最新的2.x Python， [下载Python](https://www.python.org/downloads/)（我下载的是2.7.9）
2.  安装 Visual Studio 2012/13 Express（或其他）
3.  安装 Windows SDK（适用于 Windows 7 / 8）
4.  安装Win64 OpenSSL v1.0.1g，从[这里](http://slproweb.com/products/Win32OpenSSL.html)下载 （我最新加载了“Win64 OpenSSL v1.0.2a”）

**安装所有组件后[重要]：**

以管理员身份打开“VS2012 的开发人员命令提示符”

[适用于 VS 2012] 转到

```
C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\Tools 
```

[适用于 VS 2013] 转到

```
C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\Tools 
```

执行命令“VsDevCmd.bat”

然后你可以执行这些cmd：

```
npm install node-gyp -g
npm install bcrypt -g 
```

对我来说它有效（我无法启动，因为从一开始我就没有执行命令“VsDevCmd.bat”）。

**笔记：**

1.  如果仍未执行，请尝试在以管理员身份打开的简单命令提示符中执行命令
2.  或者，如果 bcrypt 安装成功并在您的项目中执行 npm install 它会失败。检查 package.json 中的 bcrypt 版本。在我的情况下，指定了 "bcrypt": "0.7.x" 依赖项，并且我有更新的 bcryot 版本，所以在将其更改为 "bcrypt": "0.8.x" 之后，一切都安装成功。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-11T13:37:54.163

*对于在 2017 年仍然面临安装 bcrypt 错误的任何人。*

Felix Rieseberg 和其他贡献者发布了一个 npm 模块来处理 Window 的本机依赖问题。.NET Framework 4.5.1 是 Windows 7 / Vista 的唯一要求。

使用管理员权限，运行：

```
npm install --g --production windows-build-tools
npm install bcrypt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-27T20:09:00.430

看着我看到的错误

> c:\users\timd.node-gyp\0.8.18\deps\uv\include\ares.h(49)：致命错误 C1083：无法打开包含文件：'winsock2.h'：没有这样的文件或目录

您需要先解决这个问题，然后才能继续前进。据推测，自从一个月以来，您要么已经弄清楚了这一点，要么继续前进。

看看[winsock2.h，没有那个文件或目录](https://stackoverflow.com/questions/3623129/winsock2-h-no-such-file-or-directory)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-11T11:17:14.943

目前，只使用 bcryptjs 库，它更新得更好，并且在 Windows 10 上编译得很好。**

# java - 错误地使用 for 循环

> ID：14573489
> 
> 赞同：0
> 
> 时间：2013-01-29T00:02:28.240
> 
> 标签：java, string, loops, for-loop

在以下代码中，永远不会执行 for 循环。我试图解决断点和手表的问题。返回密文的正确长度，但是 for 循环不会增加 until `int i >= ciphertext.length()`。事实上，“调试”消息似乎没有执行任何操作。

```
private void decrypt_btnActionPerformed(java.awt.event.ActionEvent evt) {                                            

    String alphabet= "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
    String ciphertext="fRcXFBxXTRJ";

    status_label.setText( "Decryption has begun" );

    JOptionPane.showMessageDialog(null,"ciphertext-length: " + ciphertext.length() + "\n" + ciphertext,"Debug", JOptionPane.INFORMATION_MESSAGE);

    for (int i = 0; i>=ciphertext.length(); i--){

        System.out.println("inc:" + i);

        String cipher_current_char = getLetterAtIndex(ciphertext, i);
        int pos_char_in_alphabet = getIndexAtLetter(alphabet, cipher_current_char);

        if(pos_char_in_alphabet-2<0){

            plain_ta.setText(getLetterAtIndex(alphabet, (alphabet.length()+(pos_char_in_alphabet -2)+1 ) ));

            status_label.setText( 100/i + "%");

        }else{

            cipher_current_char = getLetterAtIndex(ciphertext, i);

            pos_char_in_alphabet = getIndexAtLetter(alphabet, cipher_current_char);

            plain_ta.setText(getLetterAtIndex(alphabet, (pos_char_in_alphabet-2)));

            status_label.setText( 100/i + "%");

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-29T00:04:45.500

```
for (int i = ciphertext.length()-1; i>=0; i--){ 
```

你需要向后工作。另请注意`-1`，您需要它来避免越界异常（索引从 开始`0`并转到`length -1`）。

当你被卡住时，总是用纸和铅笔大声地追踪你的循环，它总是有帮助的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-29T00:04:35.907

```
for (int i = ciphertext.length()-1; i > 0; i--){ 
```

你需要反转条件，否则逻辑是错误的..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T00:15:40.023

首先，我强烈建议您学习如何使用 IDE 的调试器。您还应该了解如何将`System.out.println()`调用添加到代码中以进行调试。

话虽如此，让我们看一下 for 循环：

```
for (int i = 0; i>=ciphertext.length(); i--) 
```

假设您已到达 for 循环并且`ciphertext`长度为 10。`i`初始化为零。然后条件检查它是否*大于*或等于 10。不，不是，所以整个 for 循环被跳过。

请注意，for 循环的条件必须为真，循环才能继续。它*不*用于告诉 for 循环何时停止。

所以我们可以解决这个问题：

```
for (int i = 0; i<=ciphertext.length(); i--) 
```

现在 for 循环从`i`0 开始。这小于或等于 10，因此循环执行。`i`递减到 -1，它又小于或等于 10。执行循环并`i`递减到 -2...

我在这里看到了一个模式。循环不会停止。我们需要做另一个改变：

```
for (int i = 0; i<=ciphertext.length(); i++) 
```

现在`i`从 0 增加到 10。但是，当`i`是 10 时，你会得到一个异常。这是因为唯一有效的索引是从 0 到**9**。最后一个修复将改变问题：

```
for (int i = 0; i<ciphertext.length(); i++) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:05:10.313

```
i>=ciphertext.length() 
```

应该

```
i < ciphertext.length() 
```

# ruby-on-rails - 如何解析来自不同语言环境格式的数字？

> ID：14573490
> 
> 赞同：5
> 
> 时间：2013-01-29T00:02:32.423
> 
> 标签：ruby-on-rails, ruby, localization, numbers

是否存在可以解析以下所有数字的现有解决方案？

```
"300.00"
"2.300,00"
"2,300.00" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T00:19:02.020

尝试使用[`money`](https://github.com/RubyMoney/money)宝石：

`$ gem install money`

然后你可以这样做：

```
require 'money'

test1 = Money.parse("300.00")
test2 = Money.parse("2.300,00")
test3 = Money.parse("2,300.00")

test1.currency # #<Money::Currency id: usd, priority: 1, symbol_first: true, thousands_separator: ,, html_entity: $, decimal_mark: ., name: United States Dollar, symbol: $, subunit_to_unit: 100, iso_code: USD, iso_numeric: 840, subunit: Cent>
test1.amount # 300.0
test1.dollars # 300.0
test1.cents # 30000
test1.currency_as_string # USD
test1.separator # .
test1.thousands_separator # ,
test1.delimiter # , 
```

**编辑：**旧`money`宝石分为两部分：`money`和`monetize`. 新类仅处理对象`money`之间的货币创建、操作和转换。`money`

要将对象（包括字符串）解析为`money`对象，**您应该改用[`monetize`](https://github.com/RubyMoney/monetize)gem**：

```
$ gem install monetize

Monetize.parse("USD 100")
Monetize.parse("£100")
Monetize.parse_collection("€80, $100") 
```

# ruby-on-rails - rails 嵌套模型导航

> ID：14573491
> 
> 赞同：0
> 
> 时间：2013-01-29T00:02:32.560
> 
> 标签：ruby-on-rails, ruby

我有一个包含三个模型的应用程序：

客户

```
has_many :papers 
```

纸

```
has_many :pages
belongs_to :client 
```

页

```
belongs_to :paper 
```

我可以在代码中做到这一点：`@paper.client.name`

但我无法做`@paper.page.name`NoMethodError 产生

我做错了什么？这些都是嵌套模型，其中 Client 处于较高级别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T02:00:02.610

虽然 Marc 的解释是绝对正确的，但`for`在 Ruby 中为此目的（实际上几乎是*任何*目的）使用循环并不是惯用的。的用法[`each`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-each)更为常见：

```
@paper.pages.each { |page| puts page.name } 
```

如果您只想要名称列表，可以使用[`map`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-map)：

```
@paper.pages.map(&:name) 
```

`map`将为集合中的每个项目执行一个块并返回结果数组。The`&:name`是以下的简写：

```
@paper.pages.map { |page| page.name } 
```

[`Enumerable`](http://ruby-doc.org/core-1.9.3/Enumerable.html)在惯用的 Ruby 中起着重要作用。

而且，不要**太**混乱，[`pluck`](http://apidock.com/rails/ActiveRecord/Calculations/pluck)Rails 中也有用于获取单个属性的数组，但只有当它是您想要从集合中获得的唯一东西时才应该使用它：

```
@paper.pages.pluck(:name) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:05:17.107

您的`Paper`对象有很多页面，因此没有`page`方法。如果要获取属于某个`Paper`对象的所有页面的名称，则需要遍历`pages`关联：

```
for page in @paper.pages
    puts page.name
end 
```

# kml - 谷歌地球地图标签与地标标签

> ID：14573494
> 
> 赞同：0
> 
> 时间：2013-01-29T00:02:48.697
> 
> 标签：kml, google-earth

我想使用弹出信息气球向我的 GE 地图添加标签，其中包含与整个地图相关的信息，而不会将这些信息与地图上的任何特定点联系起来。我可以创建带有描述的地标，但这会将标签固定到任意地理点。

我更愿意将标签固定在屏幕上的某个点上，因此当用户缩放或平移时，标签会保留在屏幕上但不碍事（例如，右下角）。我最接近的是创建一个地标并将其可见性设置为 0 或删除其坐标。这会将地标名称作为“位置”面板中的链接，并提供弹出信息行为，但地图上根本不会显示标签。

例如，请参阅[https://sites.google.com/site/tuobikes/kml/gloryholetest.kmz](https://sites.google.com/site/tuobikes/kml/gloryholetest.kmz)

或[https://sites.google.com/site/tuobikes/kml/gloryholetest2.kmz](https://sites.google.com/site/tuobikes/kml/gloryholetest2.kmz)

点击阅读！或“位置”面板中的帮助地标。

这可以做到吗？我在任何地方都没有找到任何解决这个问题的方法——感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T18:36:55.970

为什么不考虑使用[screenOverlay](https://developers.google.com/earth/documentation/reference/interface_kml_screen_overlay)

有关使用 screenOverlay 作为打开消息的按钮[的示例](http://earth-api-samples.googlecode.com/svn/trunk/demos/customcontrols/index.html)，请参阅此页面。

# ruby - 杀死rake任务时如何避免僵尸进程？

> ID：14573497
> 
> 赞同：1
> 
> 时间：2013-01-29T00:03:00.123
> 
> 标签：ruby, bash, rake, kill, zombie-process

我有一个 bash 脚本可以连续调用一些 rake 任务。该脚本由持续集成服务器调用。问题是如果集成服务器终止任务（通过向脚本发送 SIGTERM），我无法让整个进程树被终止。例如，如果 Rake 正在使用 Parallel 功能运行一组 rspec 测试，则可以终止脚本和顶级 rake 命令，但不可避免地会有一些线程继续运行。

到目前为止，我已经尝试了许多在 bash 脚本中使用“trap”命令的不同方法。我尝试使用 pstree 查找所有子进程，使用“kill -9 0”杀死当前进程组等。但是，如果脚本在 rake 任务运行时被杀死，它似乎绕过了陷阱。据我所知，Rake 或者 Ruby 的线程库对进程组做了一些奇怪的事情，或者可能会干扰陷阱。

如果脚本不在 rake 任务的中间，它将正确捕获 SIGTERM，回显“Received SIGTERM”，然后杀死所有后代。

Rake 怎么可能干扰父进程（bash 脚本）中的陷阱语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:45:00.313

Bash 假设整个进程组都收到了信号，因此它将等待当前执行的命令完成以确定要做什么（[更多信息](http://www.vidarholen.net/contents/blog/?p=34)）。在命令完成之前，陷阱不会运行。

如果您不想等待命令完成，您可以改用

```
trap 'kill $!' TERM
job &
wait $! 
```

`wait`当 shell 收到 SIGTERM 时将立即退出，导致您的陷阱立即运行。

# php - 我的 joomla 网站重定向到恶意网站

> ID：14573500
> 
> 赞同：0
> 
> 时间：2013-01-29T00:03:54.903
> 
> 标签：php

我的 Joomla 网站重定向到恶意中文网站。我发现index.php文件中写了一个随机的中文代码，所以我删除了，但它总是回来。我能做些什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T00:05:06.770

从轨道上对其进行核弹，这是唯一确定的方法。

（并更改您的 SSH/FTP 密码，并通知您的虚拟主机）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:15:55.753

你可能错过了一些。上周末我遇到了同样的问题——恶意代码不断出现。结果是，当我删除“所有错误代码”时，我错过了一个让我的网站容易受到再次感染的片段。

如果您可以使用 FTP（例如 FileZilla），请在服务器上搜索所有`.php`在发现问题前一两周内编辑过的文件。把它们都修好。一般来说，它们（如果你愿意的话，来自给定“黑客事件”的受影响文件）似乎都过时了，所以应该有助于找到其余的。

我在 Joomla 网站上也安装了一个恶意扩展程序，由一些恶意人员安装，所以我会说在同一时间仔细检查数据库与已知安全的本地副本是否有更新，或者任何不应该存在的东西。

并更改您的密码。他们全部。最少 9 个字符，使用大写字母、小写字母、数字和符号。最好不要使用文字、姓名或个人日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:13:18.603

你的 JS 中可能有一些东西。我有一些网站带有通过 PHP 注入的恶意软件。看看 - 它可能被混淆了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:14:03.933

联系您的房东。他们通常保留每周备份（假设您没有备份）。您可以回滚到干净的版本。更改您的密码，浏览您的日志文件，找出他们从哪里获得访问权限并堵住漏洞。

一旦您确定它已修复且干净，请确保 Joomla 是最新的。然后确保您的插件/模块是最新的。

# httprequest - 如何使用 jmeter 计算失败的请求

> ID：14573502
> 
> 赞同：9
> 
> 时间：2013-01-29T00:04:16.647
> 
> 标签：httprequest, jmeter, stress-testing

我正在运行`JMeter`，我想要计算所有失败的请求，这些请求要么超时，要么完全失败。我看到一些监听器显示有失败，但没有看到有一个字段显示失败请求与成功请求的总数。有谁知道我如何轻松获取这些数据而无需手动计算每次失败？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T06:44:14.970

*   为您的采样器添加超时

*   在代码和响应内容上添加断言

*   使用汇总报告

你应该有这些数字

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-15T11:40:28.917

要检查失败响应的数量，请执行以下步骤：

1)`Add >> Listener >> View result tree >> select the check box of 'Errors'`它只会捕获失败消息的响应，而不是成功通过这个你可以检查响应消息，详细发送请求！[在此处输入图像描述][1]

如果您想了解失败请求的总数和平均时间、最大时间，请执行以下步骤：

2） `Add >> Listener >> Summary Report >> select the check box of 'Errors'`它只会捕获响应失败而不是成功的请求的摘要报告

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-29T07:17:11.850

**将聚合报告添加到线程组。这将为您提供总事务计数和“错误百分比”。这样您就可以了解失败的交易数量**

如果您想了解特定的失败场景，请在请求中添加断言。在断言中只需提及您要检查的场景。

*   *   汇总报告
    *   断言**

# java - Java MigLayout 固定等宽行

> ID：14573505
> 
> 赞同：1
> 
> 时间：2013-01-29T00:04:43.950
> 
> 标签：java, user-interface, resize, miglayout, jtogglebutton

我`JToggleButton`在 MigLayout 中有 8 个。根据按钮的状态，文本会发生变化。问题是一个状态的文本比另一个状态大，当整个列由于增长和缩小而移动时，它看起来很奇怪和不专业。有没有办法让按钮在更改表单大小时填充给它们的空间，但无论文本是什么都保持相同的大小？

按钮的当前参数是：`cell X Y,growx`其中 X 和 Y 指定单元格坐标，列的参数是`[grow,center]`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-05T21:14:20.767

有一个列/行约束：`sg`，或`sizegroup`长格式；它甚至可以使用标签来命名应该共享相同大小的单元格：`sg button`. 现在，将按钮添加到具有约束`grow`（或`growx`或`growy`进一步指定）以适应单元格的列/行，将使它们共享相同的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:13:05.667

添加按钮时，您可以给它一个百分比宽度：

```
panel.add(new JButton("Test Button"), new CC().width("40%")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:22:08.290

我想通了，新的单元格约束如下：

`cell X Y,growx,width 12.5%`其中 X 和 Y 是单元坐标

# java - 尝试从其他方法捕获

> ID：14573507
> 
> 赞同：3
> 
> 时间：2013-01-29T00:04:47.330
> 
> 标签：java, exception, try-catch

从另一种方法尝试 Catch：

```
method1(){
   try {

       method2();

   }catch(Exception e){

   }
}

 method2(){
    try{

       //ERROR FROM HERE

    }catch(Exception e){

    }

 } 
```

如何`method1()`从 中捕获错误`method2()`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-29T00:06:56.280

`method1()`不会捕获错误，除非您`catch`从`method2()`.

```
void method2() {
    try {
        // Error here
    } catch(Exception e) {
        throw e;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T00:06:54.057

如果您在方法 2 的 catch 块中抛出另一个异常。

```
public void method2() {
    try {
        // ...
    } catch(Exception e) {
        throw new NullPointerException();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-29T00:07:50.130

```
 public void method1(){
        try {
            test2();
        } catch (IOException ex) {
            //catch test2() error
        }
    }

    public void method2() throws IOException{

    } 
```

使用投掷

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:07:23.220

直到`catch`您`method2`通过添加`throw e;`.

# html - HTML 和相应的 DOM 树

> ID：14573508
> 
> 赞同：0
> 
> 时间：2013-01-29T00:04:48.380
> 
> 标签：html, dom

我必须为类创建一个 DOM 树，并且只是想知道我在上交之前是否正确执行了它。如果有人可以为我确认它是正确的或指出我做错了什么，我将不胜感激。这是代码：

```
<!DOCTYPE html>
<html lang = "en">
<head>
<title>Lab 2</title>
<link href="lab2.css" type="text/css" rel="stylesheet">
<script src="lab2.js"></script>

</head>
<body>
<h1>Images</h1>
<div id="content">
<img id="display" src="images/blank.gif" alt="Blank Image"><br />
<button onclick="change()" id="changeImage">Display Image</button>
<h2 id="description">The image is blank</h2>
</div>
</body>
</html> 
```

![在此处输入图像描述](../Images/1002408617d048ff86bafd6607672598.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:05:59.453

`img`和是的`h2`子级`div`，而不是兄弟级。

另外，`button`和 发生了`br`什么？

# c# - WCF Rest Webservice - IIS 中的错误请求

> ID：14573509
> 
> 赞同：1
> 
> 时间：2013-01-29T00:04:51.127
> 
> 标签：c#, wcf, rest, iis

将 WCF Rest 服务发布到 IIS 时出现问题。这一切都适用于 VS，但是当通过 IIS 运行时，我不断收到错误请求。

一些示例代码，我的服务就这么简单：

```
[ServiceContract]
[AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall)]
public class Admin
{
    [WebGet(UriTemplate = "Field/GetAll")]
    public IList<EntityFields> GetFields() ... 
```

我已将路线添加到我的 global.asax：

```
RouteTable.Routes.Add(new ServiceRoute("Admin", new WebServiceHostFactory(), typeof(Admin))); 
```

我的 web.config 看起来像这样。我希望这是我做错了什么。请注意，这已经从阅读这里和 MS 论坛等多次改变和变形。

```
<system.web>
  <compilation debug="true" targetFramework="4.0" />
</system.web>

<system.webServer>
  <modules runAllManagedModulesForAllRequests="true">
    <add name="UrlRoutingModule" 
       type="System.Web.Routing.UrlRoutingModule, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
  </modules>
  <handlers>
    <add name="UrlRoutingHandler"
       preCondition="integratedMode"
       verb="*"
       path="UrlRouting.axd"
       type="System.Web.HttpForbiddenHandler, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
  </handlers>
</system.webServer>

<system.serviceModel>
  <serviceHostingEnvironment aspNetCompatibilityEnabled="true"/>
  <standardEndpoints>
    <webHttpEndpoint>
      <standardEndpoint name="" helpEnabled="true" automaticFormatSelectionEnabled="true"/>
    </webHttpEndpoint>
  </standardEndpoints>
</system.serviceModel> 
```

如果它们有用，请注意：

*   IIS 7.5
*   视窗服务器 2008 R2
*   我通过 AJAX 调用使用 JSONP 调用了很多方法。
*   因为我正在使用 JSONP，所以我设法让它工作的唯一方法是将所有必需的方法转换为 GET 并使用流来调用回调
*   当我通过 Visual Studio 启动时，一切正常。当我在 IIS 中托管它时，我的问题就出现了。

非常欢迎任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:19:43.093

我的问题最终与 REST 和我的配置无关。我通过将以下内容添加到配置来启用 WCF Web 服务：

```
<system.diagnostics>
  <sources>
    <source name="System.ServiceModel"
            switchValue="Information, ActivityTracing"
            propagateActivity="true" >
      <listeners>
        <add name="xml"/>
      </listeners>
    </source>
    <source name="System.ServiceModel.MessageLogging">
      <listeners>
        <add name="xml"/>
      </listeners>
    </source>
    <source name="myUserTraceSource"
            switchValue="Information, ActivityTracing">
      <listeners>
        <add name="xml"/>
      </listeners>
    </source>
  </sources>
  <sharedListeners>
    <add name="xml"
         type="System.Diagnostics.XmlWriterTraceListener"
         initializeData="C:\logs\Error.svclog" />
  </sharedListeners>
</system.diagnostics> 
```

再次点击我的 Web 服务以获取错误，并在“SvcTraceViewer.exe”中弹出打开跟踪日志。这突出了我在数据库上使用集成安全性的事实。但是因为我通过浏览器和 IIS 托管站点访问该服务，所以我访问了应用程序池标识下的数据库。这突出显示了 WCF 跟踪中的此错误：

```
System.Data.SqlClient.SqlException: Cannot open database "XYZ" requested by the login. The login failed... 
```

所以，长话短说，我是个傻瓜……

# linux - 仅查找目录中的文件

> ID：14573514
> 
> 赞同：0
> 
> 时间：2013-01-29T00:05:17.520
> 
> 标签：linux, bash, unix

```
find / \ -newer $1 
```

以上是我到目前为止的代码。我试图让 find 找到比参数 1 更新的所有文件，同时只停留在当前目录中。我尝试了各种使用 prune 的方法，但我似乎找不到一种有效的方法。有什么建议么？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:06:54.417

你想要`-maxdepth 1`国旗。`find /`如果要对当前目录进行操作，为什么要使用？它应该是这样的：

```
find . -maxdepth 1 -newer $1 
```

# sql - 在 Teradata 的一列中调整多行

> ID：14573515
> 
> 赞同：0
> 
> 时间：2013-01-29T00:05:32.193
> 
> 标签：sql, teradata

假设我有一个如下所示的表：

> id 属性
> 
> 1 足球
> 
> 1 美国橄榄球联盟
> 
> 1个球
> 
> 2 足球
> 
> 2 亲笔签名
> 
> 2 橄榄球
> 
> 2 废话
> 
> 2 美式橄榄球

我想获得一个不同的 id 列表，其中属性列包含术语“足球”、“NFL”和“球”。所以 1 将被包括在内，但 2 不会。在 Terdata 中执行此操作的最优雅/最有效的方法是什么？

每个 id 的属性数量可能不同，并且术语可以重复。例如，对于 id 2，NFL 出现了两次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:07:43.260

您可以使用以下内容：

```
select id
from yourtable
where attribute in ('football', 'NFL', 'ball')
group by id
having count(distinct attribute) = 3 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/42a77/1)（*fiddle 显示 MySQL，但这应该适用于 TeraData*）

# javascript - 理解 Javascript 中堆喷射的玩具示例？

> ID：14573516
> 
> 赞同：3
> 
> 时间：2013-01-29T00:05:39.637
> 
> 标签：javascript, security

以下代码的一个版本出现在[这个关于堆喷射的演示文稿](http://research.microsoft.com/en-us/projects/nozzle/nozzle-ucsd-2009-3.pptx)中（这个链接会导致一个 powerpoint 下载），以及[Dan Boneh 的这个讲座视频](http://www.cs.berkeley.edu/~dawnsong/teaching/f12-cs161/videos/1-5-ControlhijackingattacksanddefenseII9minDueMonJan30.mp4)。

```
<SCRIPT language="text/javascript">
    shellcode = unescape("%u4343%u4343%...");
    oneblock = unescape("%u0C0C%u0C0C");
    cause-overflow(overflow-string); //overflow buf[]
</SCRIPT> 
```

该`cause-overflow()`函数未在此处实现，但我认为它只会写`shellcode + nop`在整个堆上。

实际上是`shellcode`机器代码`exec(/bin/sh)`，还是某些 shell 代码`shellcode`的*内存位置？*

是`oneblock`NOP 幻灯片吗？

（更一般地说，这段代码在做什么？为什么会导致堆喷射？）

* * *

PS不是作业；我只是 javascript 的菜鸟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:18:16.950

（无法从这台机器打开这两个链接中的任何一个。）

我从来没有玩过 Javascript 中的堆喷射——这个想法真的很可怕。

它与 shell 代码无关（因为它不是在 shell 中运行），而是直接涉及机器语言——CPU 的本机代码。

这是一种相当粗略且不准确的描述事物的方式，但它使基础知识得以传达。

堆没什么特别的。它只是计算机内存。堆栈也没有什么特别的，它只是计算机内存。程序空间也没什么特别的，它只是计算机内存。

通常[*]，正在运行的程序保存在“程序空间”中。程序创建的大东西保存在“堆”中，程序制作的临时东西保存在“堆栈”中。（简化——处理它。）

缓冲区溢出的想法，粉碎堆栈或喷射堆或任何最新的技巧......以某种方式用**精心制作**的坏数据填充计算机内存并迫使计算机停止在程序空间中运行东西，而是在您精心制作的不良数据。

在涉及相当仔细的知识

*   正在运行的程序
*   它正在运行的系统
*   机器语言/代码

[*] 是的，我们正在努力改变这一点，让计算机受到更多保护

# javascript - Javascript/HTML5 fillStyle 不会改变

> ID：14573517
> 
> 赞同：-1
> 
> 时间：2013-01-29T00:05:48.533
> 
> 标签：javascript, html

除了这部分之外，我的所有 Javascript 代码都可以正常工作。问题是即使打印 1、2、3、4 或 5 警报，它也不会改变颜色。关于我可能做错了什么的任何想法？

*   它始终是默认的黑色方块。
*   假设 tile 是随机浮点数。
*   水线等于 50。
*   tile_size 为 4。

    ```
     var tile = Math.round(this.map[y][x]);
            if(tile <= this.waterline) {
                ctx.fillStyle = "rgb(25, 25, tile+75)";
                alert("1");
            }
            else if(tile > this.waterline && tile <= this.waterline + 10) {
                ctx.fillStyle = "rgb(tile+80, tile+80, 100)";
                alert("2");
            }
            else if(tile > this.waterline + 10 && tile <= this.waterline + 40) {
                ctx.fillStyle = "rgb(0, 255-tile, 0)";
                alert("3");
            }
            else if(tile > this.waterline + 40 && tile <= 190) {
                ctx.fillStyle = "rgb(0, 255-tile, 0)";
                alert("4");
            }
            else if(tile > 190) {
                ctx.fillStyle = "rgb(255-tile, 255-tile, 255-tile)";
                alert("5");
            }
            alert(ctx.fillStyle + "   " + tile + "   " + this.waterline);
            ctx.fillRect(x * this.tile_size, y * this.tile_size, this.tile_size, this.tile_size); 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:10:39.917

除非我弄错了，否则不会解析字符串。您需要正确转义`tile`变量：

```
ctx.fillStyle = "rgb("+(255-tile)+", "+(255-tile)+", "+(255-tile)+")"; 
```

# c - MPI 将数组分割成块并发送

> ID：14573521
> 
> 赞同：3
> 
> 时间：2013-01-29T00:06:20.560
> 
> 标签：c, arrays, mpi, hpc, scatter

我正在尝试使用 C 语言中的 MPI 查找数组的最大元素。我必须比较使用 vs MPI_Scatter 函数发送和计算最大值所需的时间。MPI_Send：这里是 MPI_Scatter 函数的代码，它工作得很好：

```
#include "mpi.h"
#include <stdio.h>
#include <math.h>
#include <sys/time.h>
#define lim 20

//returns "a-b" in seconds
double timeval_diff(struct timeval *a, struct timeval *b)
{
  return
    (double)(a->tv_sec + (double)a->tv_usec/1000000) -
    (double)(b->tv_sec + (double)b->tv_usec/1000000);
}

//Array to be divided among the processes
int buf[lim]= 
{27,24,3,8,45,10,50,15,10,11,9,48,69,25,19,29,61,72,93,20};
int buf2[lim];
int buf3[lim];
int max;

int main(int argc, char *argv[])
{    
    struct timeval t_ini, t_fin;
    double secs;            
    int  n, myid, numprocs, i,j;
    int  namelen;
    char processor_name[MPI_MAX_PROCESSOR_NAME];

    MPI_Init(&argc,&argv);
    MPI_Comm_size(MPI_COMM_WORLD,&numprocs);
    MPI_Comm_rank(MPI_COMM_WORLD,&myid);
    MPI_Get_processor_name(processor_name,&namelen);
    fprintf(stderr,"Process %d in %s\n",myid, processor_name);

/*Check Border Conditions */    
    n=lim/numprocs;
    gettimeofday(&t_ini, NULL); //take the time before sending the buffer with Scatter
    MPI_Scatter(buf,n, MPI_INT,buf2,n,MPI_INT, 0, MPI_COMM_WORLD);
    gettimeofday(&t_fin, NULL);//take the time to complete the send routine        
    secs = timeval_diff(&t_fin, &t_ini);      
    MPI_Reduce(buf2,buf3,n, MPI_INT, MPI_MAX, 0,MPI_COMM_WORLD);
    if (myid == 0)
    { max = buf3[0];
      for (i=1; i<n ; i++)
              if (max < buf3[i])  max = buf3[i];
          for (i=0; i<n ; i++)
          printf("Buf3[%d]= %d \n", i, buf3[i]);
          printf("Max number of the array is:  %d \n", max);
     }
     for (i=0; i<n ; i++){
       printf("%d,Buf2[%d]= %d \n",myid, i,buf2[i]);}
       printf("%.16g milliseconds\n", secs * 1000.0);         
    MPI_Finalize();
    return 0;
} 
```

当我尝试对 MPI_Send 函数执行相同的过程时出现问题，因为我计算了最大数组元素，我做错了什么？：

```
#include "mpi.h"
#include <stdio.h>
#include <math.h>
#include <sys/time.h>
#define lim 20

//returns "a-b" in seconds
double timeval_diff(struct timeval *a, struct timeval *b)
{
  return
    (double)(a->tv_sec + (double)a->tv_usec/1000000) -
    (double)(b->tv_sec + (double)b->tv_usec/1000000);
}

//Array to be divided among the processes
int buf[lim]= 
{27,24,3,8,45,10,50,15,10,11,9,48,69,25,19,29,61,72,93,20};
int buf2[lim];
int buf3[lim];
int max;

int main(int argc, char *argv[])
{

    struct timeval t_ini, t_fin;
    double secs;           
    int  n, myid, numprocs, i,j;
    int  namelen;
    char processor_name[MPI_MAX_PROCESSOR_NAME];

    MPI_Init(&argc,&argv);
    MPI_Comm_size(MPI_COMM_WORLD,&numprocs);
    MPI_Comm_rank(MPI_COMM_WORLD,&myid);
    MPI_Get_processor_name(processor_name,&namelen);
    fprintf(stderr,"Process %d in %s\n",myid, processor_name);

/*Check Border Conditions */    
    n=lim/numprocs;
    gettimeofday(&t_ini, NULL); //take the time before sending the buffer with Scatter
    for (j=0;j<n;j++){
    MPI_Send(buf, lim, MPI_INT, 1, 111, MPI_COMM_WORLD);
    }
    gettimeofday(&t_fin, NULL);//take the time to complete the send routine
    secs = timeval_diff(&t_fin, &t_ini);
    if (myid == 0)
    { max = buf3[0];
      for (i=1; i<n ; i++)
              if (max < buf3[i])  max = buf3[i];
          for (i=0; i<n ; i++)
          printf("Buf3[%d]= %d \n", i, buf3[i]);
          printf("Max number of the array is:  %d \n", max);
     }
     for (i=0; i<n ; i++){
       printf("%d,Buf2[%d]= %d \n",myid, i,buf2[i]);}
       printf("%.16g milliseconds\n", secs * 1000.0);   

    MPI_Finalize();
    return 0;
} 
```

我浪费了几个小时看故障在哪里，但我看不到它......有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T03:38:27.233

您错过了`MPI_Recv`通话另一端的`MPI_Send`通话，与集体分散，收集，减少和广播功能相比，这些功能的级别更低

# jquery - 等效于 ajaxSend 和/或 ajaxComplete 与 jsonp？

> ID：14573522
> 
> 赞同：2
> 
> 时间：2013-01-29T00:06:38.470
> 
> 标签：jquery, ajax, jsonp

现在我使用：

```
$("#status")
    .on("ajaxSend", function() { $(this).show(); } )
    .on("ajaxComplete", function() { $(this).hide(); } ); 
```

在 ajax 工作时获取状态。这适用于 json，但不适用于 jsonp。有没有办法让它与 jsonp 一起工作？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:12:06.843

这似乎[是 jQuery 中的一个错误](https://forum.jquery.com/topic/ajaxsend-not-fired-with-jsonp)，或者至少考虑了一个错误。

`beforeSend`不幸的是，除了更新您的 jsonp 请求以在and上使用相同的东西之外，您此时无能为力`complete`：

```
function ajaxSend() { $("#status").show(); }
function ajaxComplete() { $("#status").hide(); }

$.ajaxSend(ajaxSend);
$.ajax({
   dataType: 'jsonp',
   beforeSend: ajaxSend,
   complete: ajaxComplete
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-11T03:53:32.980

作为 jQuery 和 ajax 的相对新手，我不确定这是否能回答您的问题，但我发现内部的事件处理程序`ajaxSetup()`会自动为 jsonp 请求调用，而独立的处理程序（如`$(document).ajaxSend(function(event, jqXHR, settings){});`不会）。正如 Explosion Pills 所说，您还可以在每次通话的基础上手动覆盖这些。

```
$.ajaxSetup({
        beforeSend: function(jqXHR, settings) {
    },
        complete: function(jqXHR, textStatus) {
    }
}); 
```

# intuit-partner-platform - QBO 客户和供应商是否需要姓名？

> ID：14573529
> 
> 赞同：1
> 
> 时间：2013-01-29T00:07:06.943
> 
> 标签：intuit-partner-platform, quickbooks-online

QBO 客户实体的 IPP 文档

[QBO 的在线文档](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0400_QuickBooks_Online/Customer)

表示名称是“必需的”。但是，那些相同的文档说“...如果未指定 FullName，则将 GivenName、MiddleName 和 FamilyName 连接起来并用于该字段的值。” 这是否意味着如果我们查询客户，我们总是可以期望找到一个非空的“名称”字段，或者这是否意味着我们可能会得到一个空的“名称”但应该使用它所提到的串联？供应商也有同样的问题？感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T13:03:37.277

诺曼，
名字将永远被填充。您可以指定姓名，也可以指定 Given 和 Family name，然后它会使用这些值填充 Name 字段。

试试这个例子。在线登录 QuickBooks，输入第一个、中间和最后一个，然后显示名称会自动填充。

这是我只输入名字、姓氏时的 XML 示例

`<Name>Jazz, Hugo</Name> <WebSite/> <Email/> <GivenName>Hugo</GivenName> <MiddleName>J</MiddleName> <FamilyName>Jazz</FamilyName>`

问候，
杰瑞德

# sql - Oracle SQL - 昂贵得离谱的更新语句？

> ID：14573532
> 
> 赞同：1
> 
> 时间：2013-01-29T00:07:17.750
> 
> 标签：sql, oracle, sql-update

我有这样的声明：

```
update new_table t2
set t2.creation_date_utc =
(select creation_date from old_table t1 where t2.id = t1.id)
where exists
(select 1 from old_table t1 where t2.id = t1.id); 
```

根据解释计划的成本是 150959919。解释计划显示了一些全表访问，总成本约为 3000，然后更新具有基本上无限的成本。如果运行，它确实似乎永远持续下去。

仅供参考，这些表每个不超过 300k 行。

另外，这个查询。

```
select 
(select creation_date from old_table t1 where t2.id = t1.id)
from new_table t2; 
```

基本上立即完成。

这可能是什么原因？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T02:36:52.967

如果您有一个您提到的格式的更新语句，那么它意味着 id 字段在 old_table 中是唯一的（否则第一个内部查询会引发错误，返回多个值进行更新，而实际上只能处理一个值）。因此，您可以将第一个查询修改为（删除 where 子句，因为它是多余的）：-

```
update new_table t2
set t2.creation_date_utc =
(select creation_date from old_table t1 where t2.id = t1.id); 
```

由于全表扫描，上述查询可能仍需要很长时间。所以，你有两个选择：-

1.  使用以下命令对 id 字段上的 old_table 表应用索引。

    ```
    Create index index_name on old_table(id); 
    ```

2.  将您的更新查询修改为以下（未经测试）：-

    ```
    update new_table t2
    set t2.creation_date_utc=
    (select creation_date from old_table t1 where t2.id=t1.id and rownum=1); 
    ```

rownum=1 应该指示 oracle 在 old_table 中找到第一个匹配项后不要再进行任何搜索。

我会推荐第一种方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T00:18:22.533

您在 old_table.id 上没有索引，并且嵌套循环连接非常昂贵。old_table(id, creation_date) 上的索引最好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T09:46:38.610

为什么不使用合并语句？我发现它在类似情况下更有效。

```
merge into new_table t2
using old_table t1 
on (t2.id = t1.id)
when matched then
    update set t2.creation_date_utc = t1.creation_date; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:59:57.880

这可能更快且等效：

```
update new_table t2
set t2.creation_date_utc =
(select creation_date from old_table t1 where t2.id = t1.id)
where t2.id in
(select id from old_table t1); 
```

# jquery - 如何将数据列表作为数组获取？

> ID：14573539
> 
> 赞同：1
> 
> 时间：2013-01-29T00:08:08.200
> 
> 标签：jquery

我的 HTML 是一个数据列表，其中包含一些填充内容的建议。

```
<datalist id="estados">
    <option value="Acre" />
    <option value="Alagoas" />
    <option value="Amazonas" />
    ...
  </datalist> 
```

我想把它们作为一个数组，所以当浏览器不支持它并启用 jQuery UI 自动完成时我可以使用它。

```
["Acre", "Alagoas", "Amazonas" ...] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:09:23.680

```
var array = $('#estados option').map(function () {
    return this.value;
}).get(); 
```

这是小提琴：http: [//jsfiddle.net/VzrHg/](http://jsfiddle.net/VzrHg/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:12:28.250

同样在纯 JavaScript 中，您可以这样做：

```
var options = document.getElementById('estados').getElementsByTagName('option');
var optionVals = [], i = 0;

for (i; i < options.length; i += 1) {
  optionVals.push(options[i].value);
}

console.log(optionVals); 
```

# android - 如何允许缩小直到图像填充 Web 视图并且不超过其边界？

> ID：14573540
> 
> 赞同：0
> 
> 时间：2013-01-29T00:08:09.483
> 
> 标签：android, android-webview, android-image

我正在使用一种通用方法以全屏显示图像并支持通过 WebView 进行缩放并在其中启用缩放控件，我的问题是当图像宽度大于屏幕宽度时，例如在 Galaxy S2 屏幕上（480px 宽度）如果我在 Web 视图中显示 600 像素 x 600 像素的图像，最大缩小仍然会裁剪图像并显示水平滚动，并且无法缩小（即小于 100%）。

是否有解决方案可以使缩放达到 50% 等水平，或者是否有比使用 WebView 更好的方法并且仍然支持缩放？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T05:14:02.797

要拉伸/调整图像大小以适应设备屏幕（宽度），您必须在`webview`其中加载包含`<img>`标签的 HTML 代码，我们将其宽度设置为 100%。`loadDataWithBaseURL()`并使用方法在 webview 中加载该代码

尝试这个

```
webView.loadDataWithBaseURL(null,"<!DOCTYPE html><html><body style = \"text-align:center\"><img style=\"border-style:dotted;border-width:5px;border-color:black;\" src= "www.myUrl.com/blahbla.jpg" alt=\"page Not Found\"></body></html>","text/html", "UTF-8",null); 
```

# ios - 如何翻转图像并使其在所有状态下正确显示

> ID：14573546
> 
> 赞同：1
> 
> 时间：2013-01-29T00:08:45.093
> 
> 标签：ios, objective-c, ios6, uiimage

我需要翻转和图像，然后将其添加到按钮。我使用了以下代码

```
UIButton *playButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
playButton.frame = CGRectMake(xing, ying, dx,dy);
[playButton setTitle:text forState:UIControlStateNormal];
[playButton addTarget:self action:function forControlEvents:UIControlEventTouchUpInside];

UIImage *buttonImageNormal = [UIImage imageNamed:@"Begin-Set-Button.png"];
UIImage * other = [UIImage imageWithCGImage:buttonImageNormal.CGImage
                    scale:1.0 orientation: UIImageOrientationUpMirrored];
UIImage * awesome = [other stretchableImageWithLeftCapWidth:12 topCapHeight:0];
[playButton setBackgroundImage:awesome forState:UIControlStateNormal]; 
```

它正确显示图像，但是当我单击它时，按钮显示未翻转的图像。

在我尝试解决这个问题时，我添加了以下代码行

```
[playButton setBackgroundImage:awesome forState:UIControlStateHighlighted]; 
```

然而，当我单击按钮时，它不会像使用未翻转图像创建的按钮那样使颜色变暗。

如何对其进行编码，以便当我使用翻转的图像时，它显示翻转的图像在按下时变暗？我知道如何手动使图像变暗，但我想知道是否有一种方法可以通过简单的函数调用自动完成？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:32:30.633

而不是翻转图像。您是否尝试过翻转 imageView？

```
UIImage *img = [UIImage imageNamed:@"path/to-image.png"];

UIButton * button = [UIButton buttonWithType:UIButtonTypeCustom];
button.imageView.transform = CGAffineTransformMakeRotation(M_PI); // flip the image view
[button setImage:img forState:UIControlStateNormal]; 
```

这是我为保持选择状态突出显示而不必处理图像翻转所做的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T02:00:31.977

我也遇到了同样的问题，所以我搜索了一下这个帖子。我怀疑也许图像没有“固化”，因此镜像操作不是永久性的。

查看“imageWithCGImage：”的文档显示以下内容：

**讨论** *此方法不缓存图像对象。您可以使用 Core Graphics 框架的方法来创建 Quartz 图像参考。*

因此，除非在新上下文中创建新图像，否则图像的镜像不适用于事件。我也一直在研究一种在任意大小的画布上绘制图像以创建具有相同背景的按钮的方法。您可以使用此方法创建维护CG操作的图像，例如镜像：

```
+ (UIImage *)imageWithCanvasSize:(CGSize)canvasSize withImage:(UIImage *)anImage
{
    if (anImage.size.width > canvasSize.width ||
        anImage.size.height > canvasSize.height)
    {
        // scale image first
        anImage = [anImage scaleWithAspectToSize:canvasSize];
    }

    CGRect targetRect = CGRectZero;
    CGFloat xOrigin = (canvasSize.width - anImage.size.width) / 2;
    CGFloat yOrigin = (canvasSize.height - anImage.size.height) / 2;
    targetRect.origin = CGPointMake(xOrigin, yOrigin);
    targetRect.size = anImage.size;

    UIGraphicsBeginImageContextWithOptions(canvasSize, NO, anImage.scale);
    [anImage drawInRect:targetRect];

    UIImage *canvasedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return canvasedImage;    
}

- (UIImage*)scaleWithAspectToSize:(CGSize)newSize
{
    CGSize scaledSize = newSize;

    float scaleFactor = 1.0;

    if (self.size.width > self.size.height)
    {
        scaleFactor = self.size.width / self.size.height;
        scaledSize.width = newSize.width;
        scaledSize.height = newSize.height / scaleFactor;
    }
    else
    {
        scaleFactor = self.size.height / self.size.width;
        scaledSize.height = newSize.height;
        scaledSize.width = newSize.width / scaleFactor;
    }

    UIGraphicsBeginImageContextWithOptions(scaledSize, NO, 0.0);
    CGRect scaledImageRect = CGRectMake(0.0, 0.0, scaledSize.width, scaledSize.height);
    [self drawInRect:scaledImageRect];

    UIImage *scaledImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();    

    return scaledImage;
} 
```

# javascript - 请帮我用这个平滑的浮动滚动

> ID：14573551
> 
> 赞同：0
> 
> 时间：2013-01-29T00:09:29.360
> 
> 标签：javascript, html, css, wordpress, scroll

好吧，我有这个导航菜单是静态的，但我想让它在用户向下或向上滚动页面时顺畅流动......请帮助代码，因为我已经尝试过做某事但一切都变糟了。

代码：

```
<div id="menu">

        <ul>

            <li class="page_item">

                <a href="<?php bloginfo('url'); ?>" title="Go home">Home</a>

            </li>

            <?php wp_list_pages('&title_li=&exclude=6386'); ?>

            <?php

            if(is_user_logged_in() && !current_user_can('subscriber')) :

            ?>

            <li class="page_item">

                <a href="<?php bloginfo('url'); ?>/tasks/" title="Your task list">Tasks</a>

            </li>

            <?php

            endif;

            ?>

            <?php

            if(!is_user_logged_in()) :

            ?>

            <li class="page_item">

                <a href="<?php bloginfo('url'); ?>/wp-admin/">Log in</a>

            </li>

            <?php

            endif;

            ?>

        </ul>

    </div> 
```

我想让这整件事漂浮起来，我该怎么做？

我尝试添加此脚本并提供菜单类 =“scroller”：

```
$(window).load(function(){
$(window).scroll(function(){
    if($(window).scrollTop()>60){
        $('.scroller').css('position', 'fixed');
        $('.scroller').css('top', 0);
    } else {
        $('.scroller').css('position', 'relative');
        $('.scroller').css('top', 60);
    }
}); 
```

});

但没有运气..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:20:59.660

CSS 属性“top”不适用于相对定位。试试绝对的。

```
$(window).scroll(function(){
    if($(window).scrollTop()>60){
        $('.scroller').css('position', 'fixed');
        $('.scroller').css('top', 0);
    } else {
        $('.scroller').css('position', 'absolute');
        $('.scroller').css('top', 60);
    }
}); 
```

编辑：您需要在您希望滚动条出现的元素上方或下方添加一个边距，以便为其创建一个间隙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:33:47.427

首先，因为您使用的是 jQuery，所以您不必绑定`onLoad`事件来执行此操作。只需绑定`onDomReady`伪事件，无需创建任何其他类（您已经拥有 ID）。也就是说，您需要监听`onScroll`文档的事件。试试这个：

```
$(function(){
    $(document).on('scroll',function(){
        var $this = $(this),
            $menu = $('#menu'),
            scrl = $this.scrollTop(),
            menuHeight = $menu.height();

        if( scrl > menuHeight ) {
            $('#menu').css({
                'position': 'fixed',
                'top': 0
            });
        } else {
            $('#menu').css({
                'position': 'relative',
                'top': menuHeight
            });
        }
    });
}); 
```

这应该可以满足您的需求。

这是一个用于测试代码的[jsFiddle 。](http://jsfiddle.net/ragnarokkr/39qrU/)

**编辑**：更新代码以动态处理每个菜单高度。

# php - PHP file_get_contents - 替换所有链接中的所有URL

> ID：14573553
> 
> 赞同：1
> 
> 时间：2013-01-29T00:09:31.433
> 
> 标签：php, arrays, html-email, file-get-contents

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:26:19.440

此代码将从给定字符串中提取所有 HTTP url 并将它们放入数组中，以便您可以执行任何您想要从数组链接的操作：

```
<?php
$string = "Test http://www.google.com test2 http://www.something.com test3 http://abc.com";
preg_match_all('!https?://[\S]+!', $string, $match);

$URLs = array();

foreach ($match as $key => $value)
    foreach ($value as $key2 => $TheUrl)
        $URLs[] = $TheUrl;

for ($i=0;$i<count($URLs);$i++)
    echo $URLs[$i]."\r\n";

?> 
```

现在，您将 $string 变量中给出的字符串中的所有 URL 都放入了 $URLs 数组中。您可以 print_r URLs 数组以查看它的内容或使用 for 循环遍历它（如我的示例所示）。

现在，如果要替换字符串中的所有 URL，可以执行以下操作：

```
for ($i=0;$i<count($URLs);$i++)
    $string = str_replace($URLs[$i], "http://www.mysite.com?newurl=".$URLs[$i], $string); 
```

例如，它将所有 URL 字符串替换为 http://www.mysite.com?newurl=[ACTUAL URL]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T04:05:48.400

这么累？试试这个;

```
$s = preg_replace_callback('~<a\s+href="(.*?)"(.*?)>(.*?)</a>~i', function($m){
    return sprintf('<a href="http://www.MyWebsite.com/?link=%s"%s>%s</a>', urlencode($m[1]), $m[2], $m[3]);
}, $html);
echo $s; 
```

出去;

```
<body>
<p>&nbsp;</p>
<p><a href="http://www.MyWebsite.com/?link=http%3A%2F%2Fwww.CNN.com" target="_blank">Link One</a></p>
<p><a href="http://www.MyWebsite.com/?link=http%3A%2F%2Fwww.ABC.com" target="_blank">Link Two</a></p>
<p><a href="http://www.MyWebsite.com/?link=http%3A%2F%2Fwww.foxnews.com%2Fpolitics%2F2013%2F01%2F28%2Fus-planning-for-new-drone-base-in-northwest-africa-officials-say%2F" target="_blank">Link Three</a></p>
<p><a href="http://www.MyWebsite.com/?link=ObamaMustSee.com" target="_blank">Link Four</a></p>
</body> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:28:52.353

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T03:36:49.230

有效的 PHP 代码

调用文件并替换链接的 PHP 代码

```
<?php

$message = file_get_contents("myHTML.html");

$content = explode("\n", $message);

$URLs = array();

for($i=0;count($content)>$i;$i++)
{
     if(preg_match('/<a href=/', $content[$i]))
      {
    list($Gone,$Keep) = explode("href=\"", trim($content[$i]));
    list($Keep,$Gone) = explode("\">", $Keep);
    $message= strtr($message, array( "$Keep" => "http://www.MyWesite.com/?link=$Keep", ));
      }
}

echo $message;

?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-29T03:57:19.613

您可以逐行读取文件，并使用正则表达式搜索 URL，并将其替换为您自己的。这是我的做法：

```
$src = fopen('myHTMLemail.php', 'r');
$dest = fopen('myHTMLemail_changed.php', 'w');

while(false !== ($line = fgets($src)))
{
    if(preg_match('/href./', $line))
    {   
        fwrite($dest, preg_replace('/href="([^"]*)"/', 'http://www.myWebsite.com?link=${1}', $line));
    }   
    else
    {   
        fwrite($dest, $line);
    }   
}
fclose($dest);
fclose($src); 
```

# asp.net-mvc - 实体框架、存储库层和 Asp.net MVC 4

> ID：14573554
> 
> 赞同：0
> 
> 时间：2013-01-29T00:09:34.133
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, asp.net-mvc-4, repository-pattern

我计划使用 MVC 4 单页应用程序创建一个 Web 应用程序，我将使用数据库优先方法。*我正在使用默认的 Sql Server LocalDB（带有登录/身份验证表）。*

我应该把 edmx 文件放在哪里？在模型文件夹下？如果我想要一个服务层/存储库层怎么办。

顺便说一句，SPA 的默认模板为每个模型创建两个类，例如`TodoList.cs`和`TodoListDto.cs`. 为什么以及是否有更好的设计来避免两个类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:12:59.833

我喜欢从创建一个 {DataLayer}-Project 开始。

1.  将 EDMX 文件添加到您的 {DataLayer}-Project
2.  将主项目中的引用（在引用下）添加到 {DataLayer}-Project
3.  添加`using {DataLayer}-Project;`引用您的实体的每个文件

当我的项目达到最佳成熟度时，我将我的 {DataLayer}-Project 更改为服务。

# php - preg_match 第二场比赛

> ID：14573556
> 
> 赞同：3
> 
> 时间：2013-01-29T00:09:42.480
> 
> 标签：php, preg-match

只是想参加`preg_match`第二场比赛。

```
<?php
$url = "http://domain.com";
preg_match('~<table([^>]*)(class\\s*=\\s*["\']ladder-table["\'])([^>]*)>(.*?)</table>~i', file_get_contents($url), $match);
print $match[0];    
?> 
```

这是我要查找的表：

```
<table class="ladder-table">Content</table>
<table class="ladder-table">Content</table> <-- [This one]
<table class="ladder-table">Content</table> 
```

最后两个表被 java 脚本代码隐藏。对图案有影响吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:16:44.953

如果您想继续使用正则表达式，请使用[preg_match_all](http://php.net/manual/en/function.preg-match-all.php)：

```
$url = "http://domain.com";
preg_match_all('~<table([^>]*)(class\\s*=\\s*["\']ladder-table["\'])([^>]*)>(.*?)</table>~i', file_get_contents($url), $match);
print_r($match[0][1]); 
```

这可能足以满足您的要求。但是，很难让您的代码足够健壮以处理对 HTML 的更改。例如，如果`Content`有任何新行，上述内容将不匹配，因为您正在检查`.*?`没有`PCRE_DOTALL`修饰符。

处理此问题的正确方法是使用适当的 HTML 解析器，例如[DOM](http://php.net/manual/en/book.dom.php)或[其他](https://stackoverflow.com/questions/3577641/how-do-you-parse-and-process-html-xml-in-php)。

# java - .contains() 在对象列表上

> ID：14573557
> 
> 赞同：-6
> 
> 时间：2013-01-29T00:09:46.753
> 
> 标签：java, object, deep-copy

我将一个对象列表深度复制到另一个列表中。问题是使用`.contains()`无效！有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T00:13:36.270

为了使其工作，您需要覆盖列表内容的哈希码和等于。Contains 使用这些方法，默认情况下基于内存引用，因此它仅适用于浅拷贝。

# mysql - 如何获取文件名、文件大小、修改日期并存储

> ID：14573558
> 
> 赞同：1
> 
> 时间：2013-01-29T00:09:52.557
> 
> 标签：mysql, linux, unix, find, ls

我需要获取确切的文件路径、文件大小和修改日期，并将其存储在 mysql 表中。

如果我执行`ls`命令，它会给我一个很难正确解析的输出，以便能够将其加载到 mysql 表中。

什么是修改文件路径、大小和日期并将其存储在 mysql 表中的最佳方法（目前，我正在使用`load data infile`）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:15:26.903

`stat` [你可以用命令](http://linux.die.net/man/1/stat)做所有这些事情。

例如：

```
>$ stat -c "'%x' '%s'" robots.txt
'2013-01-28 16:13:48.000000000 -0800' '25' 
```

然后，您可以将它们格式化为逗号分隔的文件，然后`LOAD DATA INFILE`按照您提到的那样阅读它。例如：

```
LOAD DATA INFILE 'data.txt' INTO TABLE tbl_name
  FIELDS TERMINATED BY ',' ENCLOSED BY '"'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES; 
```

# c# - 如何等待 filesystemwatcher 事件完成

> ID：14573560
> 
> 赞同：2
> 
> 时间：2013-01-29T00:09:58.207
> 
> 标签：c#, multithreading, filesystemwatcher

如果这是多余的，请原谅，但是与此相关的所有问题似乎都指向不同的方向，我也是多线程编程的新手。

我的代码中有一个`FileSystemWatcher`类，它监视创建的事件。看起来文件系统观察程序的创建事件启动了它自己的线程。因此，有时调用线程会在`FileSystemWatcher`创建事件的被调用线程中启动的工作完成之前继续它的工作。我不想要这个。我的工作流程需要是单线程的，所以我想要实现的是在调用线程有机会恢复之前等待创建的事件完成它的工作。

伪代码：

```
main() {
FileSystemWatcher fsw = new FileSystemWatcher()
fsw.Path = ini.location;
fsw.Created += new FileSystemEventHandler(OnFileCreation);
fsw.EnableRaisingEvents = true;
main_engine.processDataToFile();
main_engine.processCreatedFile();
}

void OnFileCreation(object sender, FileSystemEventArgs e) {
// do some file processing
// takes time based on size of file and whether file is locked or not etc.
}

void processDataToFile() {
// do some data processing on received data and output to a file. 
}

void processCreatedFile() {
// do not want this method to be called, unless OnFileCreation() finish it's work.
} 
```

选择使用的原因`FileSystemWatcher`是因为有时直接放置文件进行处理，而不是 main_engine 首先获取数据，并且它可以在多个位置工作，因此不想在`FileSystemWatcher`可用时推出本土解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T04:24:48.437

如果事件在单独的线程中触发，则不能使其成为单线程。因为这不是你的代码。故事结局。

但是等待很简单：

```
...
    me.WaitOne();
    main_engine.processCreatedFile();
}

...

void OnFileCreation(object sender, FileSystemEventArgs e) {
// do some file processing
// takes time based on size of file and whether file is locked or not etc.
...
me.Set();
}

ManualResetEventSlim me = new ManualResetEventSlim(false); 
```

# django - django查询过滤器选择相关

> ID：14573562
> 
> 赞同：2
> 
> 时间：2013-01-29T00:10:18.960
> 
> 标签：django, django-queryset

这里的人是请求返回的一个人对象

```
PersonAddressBook.objects.select_related().get(person = person).client 
```

上面的代码返回客户端对象，我如何重写它以返回多个客户端。一个人对象可能在多个人地址簿中，所以过滤而不是获取是我想要做的，但我想要客户端对象而不使用 for 循环

还有其他型号的外观

```
class Client:
    #stuff here

class Person:
    #stuff here

class PersonAddressBook:
    client = models.ForeignKey(Client)
    person = models.ForeignKey(Person) 
```

这可行，但它会花费更长的时间并使用更多的内存，因为它会加载到我的系统上，我只想使用数据库。

```
clients =[]
adbook = PersonAddressBook.objects.filter(person = person).select_related()
for contact in adbook:
    clients.append(contact.client) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:14:33.047

您可以`related_name`在 Client 模型中使用 PersonAddressBook ：

```
Client.objects.filter(personaddressbook__person=person) 
```

根据[文档](https://docs.djangoproject.com/en/dev/ref/models/relations/#related-objects-reference)，它*应该*是`personaddressbook_set__person`，但由于某种原因，我目前不知道相关名称以不同的方式生成。）

我更喜欢明确指定`related_name`：

```
class Client(models.Model):
    pass

class Person(models.Model):
    pass

class PersonAddressBook(models.Model):
    client = models.ForeignKey(Client, related_name='addressbooks')
    person = models.ForeignKey(Person, related_name='addressbooks') 
```

`addressbooks`现在您可以在查询中使用该字段：

```
Client.objects.filter(addressbooks__person=person) 
```

# mysql - Rails MySQL子查询与算术

> ID：14573563
> 
> 赞同：0
> 
> 时间：2013-01-29T00:10:24.943
> 
> 标签：mysql, ruby-on-rails, math, count, subquery

我有 3 个模型：

1.  产品
2.  每日日志
3.  点击

表格如下所示：

```
Products
id 
```

,

```
Daily Logs
id | product_id | price 
```

,

```
Clicks
id | product_id | daily_log_id 
```

对于报告，我想获取所有累计超过 x 成本（基于每次点击价格）的产品。

在 Ruby 中，代码可能看起来像

```
products.select do | p |
  cost = 0
  p.daily_logs.each do | dlog |
    cost += dlog.clicks.count * dlog.price
  end

  cost > x ? true : false      
end 
```

我如何为 mysql 编写类似的查询？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:18:44.377

我认为这就是你要找的：

```
SELECT dl.product_id AS `product_id`, COUNT(c.id) AS `total_clicks`, SUM(dl.price) AS `total_price`
FROM daily_logs AS dl
INNER JOIN clicks AS c on dl.id = c.daily_log_id
WHERE `total_price` > ?
GROUP BY `product_id` 
```

注意我没有加入 products 表，因为它只有一个 id 字段，该字段在 daily_logs 表中也可用。如果 products 表实际上有更多包含您需要的信息的字段，您也可以加入该表并选择所需的字段。

# c# - 可扩展的 .NET 配置

> ID：14573564
> 
> 赞同：2
> 
> 时间：2013-01-29T00:10:25.803
> 
> 标签：c#, .net, oop, design-patterns

我想分发一个 DLL，`ConfigurationSection`如下所示：

```
public class StandardConfiguration : ConfigurationSection
{
    public static StandardConfiguration GetInstance()
    {
        return (StandardConfiguration)ConfigurationManager.GetSection("customConfigSection");
    }

    [ConfigurationProperty("childConfig")]
    public StandardChildConfig ChildConfig
    {
        get { return (StandardChildConfig)this["childConfig"]; }
        set { this["childConfig"] = value; }
    }
}

public class StandardChildConfig : ConfigurationElement
{
    [ConfigurationProperty("p1")]
    public string P1
    {
        get { return (string)this["p1"]; }
        set { this["p1"] = value; }
    }
} 
```

我想让 the`ConfigurationSection`和它的孩子可以`ConfigElement`继承。这可以使用类型参数来完成，如下所示：

```
public class StandardConfiguration<TChildConfig> : ConfigurationSection
    where TChildConfig : StandardChildConfig
{
    [ConfigurationProperty("childConfig")]
    public TChildConfig ChildConfig
    {
        get { return (TChildConfig)this["childConfig"]; }
        set { this["childConfig"] = value; }
    }
}

public class StandardChildConfig : ConfigurationElement
{
    [ConfigurationProperty("p1")]
    public string P1
    {
        get { return (string)this["p1"]; }
        set { this["p1"] = value; }
    }
} 
```

但是，我认为这会阻止我从`Instance`我的 DLL 中的其他类引用静态，因为我不知道 child 的最终类型`ConfigurationElement`。

欢迎任何关于如何更干净地实施这一点的想法或建议。

谢谢。

**编辑**

假设`<customConfigSection>`应用程序的配置中有一个，我可以在第一个场景中使用`StandardConfiguration.GetInstance().ChildConfig.P1`来访问该值。`P1`在第二种情况下，我将如何访问相同的值？我将如何实施`GetInstance()`？

**编辑 2**

以下是“零编码”场景：

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <section
            name="customConfig"
            type="WebsiteTemplate.Config.StandardConfigruation, WebsiteTemplate"
        />
    </configSections>
    <customConfig baseProp1="a">
        <childConfig baseProp2="b" />
    </customConfig>
</configuration> 
```

这是扩展配置的场景：

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <section
            name="customConfig"
            type="WebsiteTemplate.Extended.Config.ExtendedConfigruation, WebsiteTemplate.Extended"
        />
    </configSections>
    <customConfig baseProp1="a" extendedProp1="c">
        <childConfig baseProp2="b" extendedProp2="d" />
    </customConfig>
</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T20:02:21.900

在第二种情况下`StandardConfiguration.GetInstance()`没有任何意义，因为`StandardConfiguraiton`是通用的。你必须使用`StandardConfiguration<MyChildConfig>.GetInstance().ChildConfig.P1`

您可能可以执行以下操作：

```
public class StandardConfigurationBase : ConfigurationSection
{
    public static StandardConfigurationBase GetInstance()
    {
        return (StandardConfigurationBase) ConfigurationManager.GetSection("customConfigSection");
    }

    [ConfigurationProperty("childConfig")]
    public StandardChildConfig ChildConfig
    {
        get { return (StandardChildConfig) this["childConfig"]; }
        set { this["childConfig"] = value; }
    }
}

public class StandardConfiguration<TChildConfig> : StandardConfigurationBase
where TChildConfig : StandardChildConfig
{
    [ConfigurationProperty("childConfig")]
    public new TChildConfig ChildConfig
    {
        get { return (TChildConfig)this["childConfig"]; }
        set { this["childConfig"] = value; }
    }
}
public class StandardChildConfig : ConfigurationElement
{
    [ConfigurationProperty("p1")]
    public string P1
    {
        get { return (string)this["p1"]; }
        set { this["p1"] = value; }
    }
} 
```

然后在不知道其具体类型时访问子项：

```
 StandardConfigurationBase b = new StandardConfiguration<StandardChildConfig>();
    StandardChildConfig x = StandardConfigurationBase.GetInstance().ChildConfig; 
```

但是，我不清楚这样做的真正价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T22:47:26.083

我的问题的“答案”是将基本配置分解为具有类型参数和接口的抽象类。

下面显示了 BaseLib.dll 中定义的内容。有默认配置和默认子配置。

**接口和抽象类**

```
public interface IAppConfig
{
    string AppProp1 { get; }
    SubConfig SubConfig { get; }
}

public abstract class BaseAppConfig<TSubConfig> : ConfigurationSection, IAppConfig
    where TSubConfig : SubConfig
{
    [ConfigurationProperty("appProp1")]
    public string AppProp1
    {
        get { return (string)this["appProp1"]; }
        set { this["appProp1"] = value; }
    }

    [ConfigurationProperty("subConfig")]
    public TSubConfig SubConfig
    {
        get { return (TSubConfig)this["subConfig"]; }
        set { this["subConfig"] = value; }
    }

    // Implement the interface
    string IAppConfig.AppProp1 { get { return this.AppProp1; } }
    SubConfig IAppConfig.SubConfig { get { return this.SubConfig; } }
} 
```

**默认实现**

```
public class AppConfig : BaseAppConfig<SubConfig>
{
    const string SECTION_KEY = "AppConfig";

    public static IAppConfig Instance
    {
        get { return (IAppConfig)ConfigurationManager.GetSection(SECTION_KEY); }
    }
}

public class SubConfig : ConfigurationElement
{
    [ConfigurationProperty("supProp1")]
    public string SubProp1
    {
        get { return (string)this["supProp1"]; }
        set { this["supProp1"] = value; }
    }
} 
```

**如何从 BaseLib.dll 访问配置**

```
public class ArbitraryClass
{
    void DoSometing()
    {
        Console.Write(AppConfig.Instance.SubConfig.SubProp1);
    }
} 
```

下面显示了 ExtLib.dll 中定义的内容。配置和子配置都被扩展。

**扩展实现**

```
public class ExtAppConfig : BaseAppConfig<ExtSubConfig>
{
    public static ExtAppConfig Instance
    {
        get { return (ExtAppConfig)AppConfig.Instance; }
    }

    [ConfigurationProperty("extAppProp1")]
    public string ExtAppProp1
    {
        get { return (string)this["extAppProp1"]; }
        set { this["extAppProp1"] = value; }
    }
}

public class ExtSubConfig : SubConfig
{
    [ConfigurationProperty("extSubProp1")]
    public string ExtSubProp1
    {
        get { return (string)this["extSubProp1"]; }
        set { this["extSubProp1"] = value; }
    }
} 
```

**如何从 ExtLib.dll 访问配置**

```
public class ExtArbitraryClass
{
    void DoSometing()
    {
        Console.Write(ExtAppConfig.Instance.SubConfig.ExtSubProp1);
    }
} 
```

库中定义了更多内容，但它应该使扩展此配置相对容易。

# file - Sublime Text 2 - 文件不会更新

> ID：14573567
> 
> 赞同：5
> 
> 时间：2013-01-29T00:10:37.917
> 
> 标签：file, editor, sublimetext2

当我通过终端添加文件时，Sublime 似乎没有接受更改。我必须删除该项目并将其重新添加到 sublime 以显示文件。有谁知道解决这个问题？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T14:13:57.263

我遇到过同样的问题。我不完全确定究竟是什么原因造成的，或者这是如何解决的，但我打开了项目并从项目中删除了所有文件夹。我退出 ST2 并重新打开它，然后重新添加了文件夹。从那以后一切正常，文件更新，我再次获得保存的更改以覆盖本地文件系统上的文件（以前也没有这样做）。

我已经将它关闭并反复启动它，并且每次都能确认它正在接收我通过 vim 对某些文件所做的新更改。

# bash - 按文件列出匹配的固定字符串

> ID：14573571
> 
> 赞同：1
> 
> 时间：2013-01-29T00:10:57.930
> 
> 标签：bash, optimization, grep

以下代码有效，但速度很慢：

```
#!/bin/bash
for f in *.xml; do
  for r in $(cat ../reports.txt); do
    grep -q "$r" $f

    if [ $? -eq 0 ]; then
      echo "$r,$f"
    fi
  done
done 
```

这可以通过以下方式加速：

```
for f in *.xml; do
  grep -lif ../reports.txt $f
done 
```

但是，这不会显示`reports.txt`找到与文件 ( `$f`) 匹配的行。

您将如何显示`reports.txt`在每个文件中找到的匹配行以及具有 1 个或多个匹配项的文件的名称`reports.txt`？

例如，如果`reports.txt`包含：

```
aardvark
aardwolf
anteater 
```

其中一个文件（例如，story.txt）包含：

```
This is a story about an aardvark and an aardwolf. 
```

然后我试图产生以下输出：

```
story.txt,aardvark
story.txt,aardwolf 
```

如果有帮助，则其中的行`reports.txt`不是正则表达式：它们是纯文本字符串。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:17:54.363

看看这个，符合你的要求吗？

```
kent$  head report.txt story.txt
==> report.txt <==
aardvark
aardwolf
anteater

==> story.txt <==
is a story about an aardvark and an aardwolf.

kent$  grep -Hof report.txt story.txt
story.txt:aardvark
story.txt:aardwolf 
```

测试是用 grep 完成的：

```
kent$  grep --version|head -1
grep (GNU grep) 2.14 
```

# b-tree - 自顶向下节点分裂插入B+树的缺点

> ID：14573572
> 
> 赞同：1
> 
> 时间：2013-01-29T00:11:02.430
> 
> 标签：b-tree

对于 B+ 树插入，你为什么要遍历树然后向上分裂父母？

[维基百科](http://en.wikipedia.org/wiki/B+_tree#Insertion)建议这种插入方法：

> 执行搜索以确定新记录应进入哪个存储桶。
> 
> *   如果桶未满（插入后最多 b - 1 个条目），则添加记录。
> *   否则，拆分桶。
>     *   分配新叶子并将桶的一半元素移动到新桶。
>     *   将新叶子的最小键和地址插入父节点。
>     *   如果父级已满，也将其拆分。
>         *   将中间键添加到父节点。
>     *   重复直到找到不需要拆分的父级。
> 
> 如果根分裂，则创建一个具有一个键和两个指针的新根。

你为什么要遍历树然后返回执行拆分？为什么不在下行过程中遇到节点时拆分节点？

对我来说，所提出的方法执行了两倍的工作，并且还需要更多的簿记。

谁能解释为什么这是插入的首选方法，而不是向下拆分的方法，以及在遍历期间插入的缺点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:12:53.727

您必须回溯树，因为您实际上不*知道*是否需要在最低级别进行拆分，直到您到达那里。

这一切都在短语“如果桶未满，......”中。

您还应该意识到，它远没有两倍的工作量。由于您在向下的过程中记住了各种各样的东西（节点指针、节点内的索引等等），因此在返回的过程中没有那么多的计算或搜索。

# python - python urllib 只下载一个网页的一部分？

> ID：14573573
> 
> 赞同：1
> 
> 时间：2013-01-29T00:11:05.217
> 
> 标签：python, urllib

我有一个程序，我需要打开许多网页并在其中下载信息。但是，该信息位于页面中间，需要很长时间才能找到它。有没有办法让 urllib 只检索`x`行？或者，如果不出意外，以后不要加载信息？

我在 Mac OS 10.8.2 上使用 Python 2.7.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:14:44.030

返回的对象是一个类似文件的对象，您可以使用它`.readline()`来仅读取部分响应：

```
resp = urllib.urlopen(url)
for i in range(10):
    line = resp.readline() 
```

例如，只会读取 10 行。请注意，这不能保证更快的响应。

# sbt - 为什么 SBT 找不到 Play 2.1 插件？

> ID：14573574
> 
> 赞同：9
> 
> 时间：2013-01-29T00:11:05.910
> 
> 标签：sbt, playframework-2.1

在我的`plugins.sbt`文件中，我有

```
scalaVersion := "2.10.0"

resolvers += "Typesafe repository" at "http://repo.typesafe.com/typesafe/releases/"

addSbtPlugin("play" % "sbt-plugin" % "2.1") 
```

当我尝试跑步时`sbt`，我得到了，除此之外

```
[warn] ==== Typesafe repository: tried
[warn]   http://repo.typesafe.com/typesafe/releases/play/sbt-plugin_2.10_0.12/2.1/sbt-        plugin-2.1.pom
[warn] ==== public: tried
[warn]   http://repo1.maven.org/maven2/play/sbt-plugin_2.10_0.12/2.1/sbt-plugin-2.1.pom
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]  ::          UNRESOLVED DEPENDENCIES         ::
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]  :: play#sbt-plugin;2.1: not found
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]
[warn]  Note: Some unresolved dependencies have extra attributes.  Check that these         dependencies exist with the requested attributes.
[warn]          play:sbt-plugin:2.1 (sbtVersion=0.12, scalaVersion=2.10)
[warn]
sbt.ResolveException: unresolved dependency: play#sbt-plugin;2.1: not found 
```

为什么 SBT 找不到插件？我也尝试`addSbtPlugin("play" % "sbt-plugin" % "2.1-RC1")`过类似的结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T02:33:45.170

问题是在 plugins.sbt 文件中包含 scalaVersion 设置。这会导致 sbt 在实际应该搜索 sbt-plugin_2.9.2_0.12 时在存储库中搜索 sbt-plugin_2.10.0_0.12。

我不确定在 plugins.sbt 文件中指定 scalaVersion 背后的语义，但它可能是在声明 SBT 正在运行的 Scala 版本。

这是 Play 2.1 sbt-plugin 文件的链接：[http ://repo.typesafe.com/typesafe/simple/ivy-releases/play/sbt-plugin/scala_2.9.2/sbt_0.12/2.1-RC1/srcs /](http://repo.typesafe.com/typesafe/simple/ivy-releases/play/sbt-plugin/scala_2.9.2/sbt_0.12/2.1-RC1/srcs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T13:37:09.767

根据文档，将其添加到您的`project/plugins.sbt`：

```
addSbtPlugin("play" % "sbt-plugin" % "2.1.0") 
```

更改`project/build.properties`

```
sbt.version=0.12.2 
```

# asp.net-mvc - 使用自定义段变量设置 ASP.Net MVC 4 路由

> ID：14573579
> 
> 赞同：4
> 
> 时间：2013-01-29T00:11:52.160
> 
> 标签：asp.net-mvc, asp.net-mvc-4, routing, asp.net-mvc-routing

我刚开始研究一个有几个领域的应用程序（基本网格主/细节类型系统..）我正在考虑利用 MVC（特别是 4）中好的路由功能，但我“只是不明白”我相信。

目前唯一定义的路线是基本路线：

```
routes.MapRoute("Default", 
            "{controller}/{action}/{id}", 
            new { controller = "Account", action = "Index", id = UrlParameter.Optional }
        ); 
```

很好，它适用于我们定义的区域，所以我假设它必须知道用户在哪里，并根据用户所在的位置/区域根据上下文路由到适当的控制器......到目前为止很好......

现在，我正在尝试建立一条可以处理的新路线

```
/someController/someAction/{statusName} 
```

特别是：

```
/OrderManager/List/New 
```

**和**

```
/OrderManager/List/Viewed 
```

其中“新”是“新”状态，动作签名如下所示：

```
public ActionResult List(string statusName) 
```

我假设我可以将新路由添加到标识“statusName”而不是 Id 的默认路由下方，但是当然，路由机制如何知道 H 之间的区别：

/controller1/action1/15

/controller2/action2/新

我确实尝试以以下形式添加“静态”路由

```
routes.MapRoute("Default", 
            "ControllerName/ControllerAction/{statusName}", 
            new { statusName = UrlParameter.Optional }
        ); 
```

我以为我可以“hiJack”那条路线并用它做一些特别的事情，但要知道是否有用，路由器会在第一次比赛时停止？我假设无论如何这是解决这个问题的错误方法..

所以现在我正在考虑达到以下目标：

```
/somecustomroutename/somesortValue 
```

前任。/OrderManagerList/viewNew

这些路线基本上是“别名”。我曾认为添加以下路线可以解决问题：

```
 routes.MapRoute("Default_List",
          "OrderManagerList/{statusName}",
          new {controller="OrderManager", action="List", statusName= UrlParameter.Optional }
      ); 
```

与 OrderManager 控制器上的相关操作：

```
public ActionResult List(string statusName) 
```

无论我尝试什么，参数都是空的，或者“找不到资源”

我知道控制器需要有一个相应的视图文件..但这不是这里的问题，问题是我试图理解路由..

所以我的问题..从根本上说，我对 MVC (4) 中的路由缺少什么？甚至一些像我这样的傻瓜能理解的好文章？

我的理解; 定义一条路线，并将其映射为“端点”..但是，我认为我不理解机器所做的假设..

无论如何，如果需要进一步解释/编辑，请告诉我..

提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-29T17:40:48.577

路由的基本原理是自上而下评估，路由系统使用第一个匹配，而不是最佳匹配。

这意味着您必须按照具体的顺序排列路线，最具体的路线在前，最一般的路线在后。

记住这个原则，让我们看看你的情况。最初，您只定义了默认路由：

```
routes.MapRoute("Default", 
        "{controller}/{action}/{id}", 
        new { controller = "Account", action = "Index", id = UrlParameter.Optional }
    ); 
```

URL 模式是“{controller}/{action}/{id}”。就其本身而言，这将匹配任何三段 URL，并且不会匹配任何少于三段的 URL。但是，第三个输入参数是默认参数，它定义了第一段和第二段的默认值，并表示第三段是可选的。这样做的下一个效果是使路由匹配 URL 具有 0、1、2 或 3 个段。

现在您要添加一个路由，其中​​第三个 URL 段映射到“statusName”参数，并且可以处理如下 URL：

```
OrderManager/List/New 
OrderManager/List/Viewed 
```

您可以在此处采用两种基本方法。您可以 1）创建一个仅处理这两个 URL 的非常具体的路由，或者 2）您可以尝试创建一个更通用的路由来处理一般情况。我们先来看第一种情况。您可以按如下方式创建路由：

```
routes.MapRoute("", "OrderManager/List/{statusName}",
              new { Controller = "OrderManager", Action = "List" }); 
```

请注意，由于此路由比默认路由更具体，因此您必须将此路由放在默认路由*之前*。

如果您想要一个更通用的路由，您需要确定此路由与默认路由有何不同，因为它们都将匹配具有三个段的 URL。假设您决定新路由将接受第三段中仅包含字母的任何内容，而让默认路由处理包含数字的任何内容。您可以使用路由约束来执行此操作。例如，您可以编写如下路线：

```
 routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional },
            constraints: new { id = @"^\d+$" });

        routes.MapRoute(
            name: "NewRoute",
            url: "{controller}/{action}/{statusName}",
            defaults: new { Controller = "OrderManager", Action = "List" },
            constraints: new { statusName = "^[A-Za-z]+$" }); 
```

使用这两个路由，任何在第三段中只有字母的三段 URL 都会将第三段放入名为“statusName”的变量中，而在第三段中具有整数的任何 URL 都会将第三段放入名为“ ID”。

在任何真正复杂的应用程序中，路由可能会变得复杂，为您的路由编写单元测试是非常有利的，以确保您在添加或修改路由时不会搞砸。

有关路由的良好参考，请参阅[Scott Sanderson 的书](https://rads.stackoverflow.com/amzn/click/com/1430234040)或参阅[MSDN 文档](http://msdn.microsoft.com/en-us/library/cc668201(v=vs.100).aspx)

# restler - REST 请求在 Explorer 之外不起作用

> ID：14573581
> 
> 赞同：0
> 
> 时间：2013-01-29T00:12:23.413
> 
> 标签：restler, swagger

我正在使用 Restler 的 API Explorer（Swagger UI 的一个分支），当我在那里测试服务调用时它工作正常，但是当我将相同的 URL 剪切并粘贴到 Chrome 的高级 REST 客户端时，我收到“403 Forbidden”错误。这个怎么可能？是否有某种必需的标头参数需要随请求一起传递？

以下是屏幕截图：

![在此处输入图像描述](../Images/1498d22d6e04c23e12aa020a062279be.png)

![在此处输入图像描述](../Images/73704dec07fccaa44cf9e364e5b44593.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T09:41:29.917

您需要正确获取内容类型。确保以 JSON ( `application/json`)格式发送数据

您需要添加标题

```
Content-Type application/json 
```

# javascript - 使用 XPCOM 在网页上上传文件/图像

> ID：14573583
> 
> 赞同：0
> 
> 时间：2013-01-29T00:12:28.410
> 
> 标签：javascript, firefox, xpcom, imacros

我正在使用此处找到的示例。[Mozilla 开发人员](https://developer.mozilla.org/en-US/docs/FileGuide/FileUpDown)

我对这个例子很感兴趣。

```
function upload(postUrl, fieldName, filePath)
{
  var formData = new FormData();
  formData.append(fieldName, new File(filePath));

  var req = new XMLHttpRequest();
  req.open("POST", postUrl);
  req.onload = function(event) { alert(event.target.responseText); };
  req.send(formData);
} 
```

但我不明白这个例子的去向。filePath 是可以理解的，但我可以找到 postUrl 、 fieldName 。我正在处理具有用于图像上传的拖放区域的页面上的图像上传。如何使用此功能将图像上传到我的网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T02:08:31.733

查看[**FormData 文档**](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/FormData)和[**XMLHttpRequest 文档**](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest#open%28%29)。

**`fieldName`** *其数据包含在值中的（表单）字段的名称。**要将请求发送到的 URL。*
**`postUrl`**

 *您应该有一个响应上传请求的服务器端端点。
例如：

```
upload('http://mysite.com/uploader.php', 'fileField', 'path/to/my/file.jpg'); 
```

然后，如果您在服务器端使用 PHP；您可以像这样在服务器端访问该字段值：

```
$my_files = $_FILES['fileField']; 
```*

# firefox - Twitter Bootstrap 无法与 Firefox 配合使用

> ID：14573584
> 
> 赞同：2
> 
> 时间：2013-01-29T00:12:31.073
> 
> 标签：firefox, twitter-bootstrap, firebug

我在 MeteorJS 应用程序上使用 Twitter 引导程序。当我在 Firefox 上运行它时，我遇到了很多错误，例如：

```
Expected declaration but found '*'. Skipped to next declaration.
*margin-left: 62.28677941443899%;
bootstrap...db5283e (line 311, col 6) 
```

在引导程序中，我有：

```
 .row-fluid .offset4 {
margin-left: 36.75213675213675%;
*margin-left: 36.645753773413354%;
} 
```

我想知道为什么会发生这种情况，我可以避免这个警告。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T10:25:20.787

在 CSS 中，以星号开头的行表示对于 IE7 及以下版本使用此规则。

这是一个只有 IE7 及以下版本才能理解的 hack。

我不会担心这个错误，因为它在所有引导程序官方 CSS 文件中都显示为错误，并且不会对 afaik 造成任何伤害。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T22:18:05.320

或者，如果你真的想在大多数主流浏览器中通过 CSS 验证，并且你有一个周末空闲，你可以编写一个单独的 IE 样式表。

我想知道引导程序的人是否已经想到了这一点？

# html - 在背景位置上方的固定区域上链接：覆盖背景图像

> ID：14573585
> 
> 赞同：0
> 
> 时间：2013-01-29T00:12:33.143
> 
> 标签：html, css, map, imagemap

我有[这个](http://goo.gl/XiXWx)登陆页面。我希望该电子邮件成为 mailto:info@domain.tld 的链接。

我尝试在正文上使用地图（usemap="#mail" 然后地图名称="mail">），但它不起作用。我也尝试使用空白透明 png 图像（将 usemap 设置为），但链接不可点击。

如何实现电子邮件区域以在其上添加链接？当然，它应该适用于不同的分辨率。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T01:47:32.313

这就是我直接使用 Inspect 元素修改您的页面的方式，并且链接保持在图像文本的顶部。这是另一种选择，但具有固定的宽度和高度以支持电子邮件的定位。

```
<body>
<div style="
    width: 1430px;
    position: absolute;
    border: 1px solid #000;
    height: 700px;
    background-image: url(home2.jpg);
    background-repeat: no-repeat;
    background-position: top center;
    display: inline-block;
"><a href="#" style="
    position: relative;
    top: 450px;
    right: 294px;
    display: inline-block;
    float: right;
">Info@gioiellidisapone.it</a>
</div>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:16:31.780

为什么不将电子邮件链接呈现为文本？看起来它可以类似于 Open Sans：[http ://www.google.com/webfonts/specimen/Open+Sans](http://www.google.com/webfonts/specimen/Open+Sans)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:11:07.890

你可以这样做：

添加CSS：

```
div#mail {
margin-left: 67%;
margin-top: 31.8%;
overflow: hidden;
width: 16%;
}

a {
color: transparent;
} 
```

添加 HTML：

```
<div id="mail"><a href="mailto:info@gioiellidisapone.it">info@gioiellidisapone.it</a></div> 
```

演示：http: [//jsfiddle.net/fXats/](http://jsfiddle.net/fXats/)

它并不完美，但也许已经足够好了。:)

# ruby-on-rails - 使用 form_for 正确存储日期信息

> ID：14573597
> 
> 赞同：2
> 
> 时间：2013-01-29T00:13:37.420
> 
> 标签：ruby-on-rails, form-for, rails-activerecord

我有一个允许用户创建事件的表单。用户填写的字段之一是日期。目前这是提交日期的代码：

```
<%= u.label :date %> <%= u.text_field :date, :placeholder => 'mm/dd/yyyy' %> 
```

出于某种原因，如果用户输入 2012 年 1 月 2 日，它将存储为 dd/mm/yyyy，认为该事件是在 2 月 1 日而不是 1 月 2 日。我已经将我的初始化程序文件配置为以我希望的方式显示日期/日期时间（如这里的几篇文章所建议的那样）但这仍然是一个问题

更新 - 这是我的完整表格：

```
 <%= form_for(@party_profile) do |u|%>
    <p>
        <%= u.label :name %><%= u.text_field :name %>
    </p>

    <p>
        <%= u.label :location %><%= u.text_field :location %>
    </p>

    <p>
         <%= u.text_field :date, :placeholder => 'dd/mm/yyyy' %>

    </p>

    <p>
        <%= u.label :password %> <%= u.text_field :password %>
    </p>

    <%= u.submit "Let's Party!", :class => "btn btn-primary" %>
    <% end %> 
```

我已尝试将 u.text_field 替换为 select_date，如下所示，但随后出现错误：

```
 undefined method `select_date' for #<ActionView::Helpers::FormBuilder:0x007f9e5e8c69d8> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-11T06:52:08.887

```
<%= u.label :date %> <%= u.date_select(:date, :order => [:month, :day, :year]) %> 
```

是我能想到的最好的 - 仍然没有完全按照我想要的方式格式化

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-21T00:18:51.153

我用它来约会：

```
 <%= u.label :date %>
    <%= u.date_field :date %> 
```

希望它有帮助=)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-29T00:41:30.617

考虑使用 select_date，而不是用户可以输入任何内容的简单文本字段。

```
<%= u.select_date(:date, :order => [:month, :day, :year]) %> 
```

[http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_date](http://api.rubyonrails.org/classes/ActionView/Helpers/DateHelper.html#method-i-select_date)

# c# - ASP.NET 按钮 OnClientClick

> ID：14573600
> 
> 赞同：-4
> 
> 时间：2013-01-29T00:14:05.837
> 
> 标签：c#, asp.net

我有问题，任何帮助将不胜感激。我希望我能清楚地解释这一点，但如果我不只是让我知道，我会持续一段时间。这是用 C# 编写的，我有一个按钮，它在“OnClientClick”部分调用一个名为“JavaScript()”的 JavaScript 函数，在“OnClick”部分我有一个“if 语句”，其中第一部分类似于 OnClientClick 函数和第二部分表示与 OnClientClick 无关的不同代码。

默认页面.aspx：

```
<asp:Button ID="Button1" runat="server" Text="Button" 
 OnClick="Button1_OnClick" 
 OnClientClick="JavaScript()"  /> 
```

DefaultPage.aspx.cs：

```
protected void Button1_OnClick(object sender, EventArgs e)
   {
  String a = getValueofA();

  If (a == "1")
  {
            //OnClientClick code goes here
  }
  else If (a == "2")
  {
     //No OnClientClick code goes here
  }
 } 
```

此 javascript 函数来自我在此“DefaultPage”上加载的不同 Web 控件。这对我来说很完美，直到我在 Button1_OnClick 中添加了“if 语句”。原来我只有“if 语句”的第一部分，现在我需要添加它的第二部分。我怎样才能做到这一点。我试过 button1.OnClientClick，但它只适用于 Page_Load。我需要先确定“a”的值然后继续。对不起，如果我不清楚，但我可以回答任何问题。非常感谢。我的目标是从我的 asp.net 按钮中删除“OnClientClick=JavaScript”，然后在 if 语句中调用该函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:21:37.650

我不确定我是否理解您的问题，您似乎想从后面的代码中执行 javascript 代码。在后面的代码中使用 ScriptManager 并从那里执行 javascript 怎么样？像下面

```
 // write your onclientclick code here
    ScriptManager.RegisterStartupScript(this, typeof(string), "JAVA_SCRIPT", "your javascript() function code here", true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:37:27.830

你遇到了什么错误？如果在 C# 中没有大写。

[http://msdn.microsoft.com/en-us/library/5011f09h(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/5011f09h(v=vs.100).aspx)

编辑：

根据评论，我认为你最好完全去客户端。

```
<script type="text/javascript">
function NewFunction(){
    var a = getValueOfA();
    if (a === "1")
    {
        JavaScript();
    }
    else if ( a==="2" )
    {
        //other code
    }
}
</script>

<asp:Button ID="Button1" runat="server" Text="Button" 
 OnClientClick="NewFunction()"  /> 
```

# r - 将字符向量拆分为数据帧中的新行的最快方法

> ID：14573601
> 
> 赞同：5
> 
> 时间：2013-01-29T00:14:16.137
> 
> 标签：r, split

我不知道在搜索时如何正确表达这个词，如果有一个简单的答案，很抱歉。

我有 58 个数据帧，每个数据帧大约 25,000 行，我从 .csv 获得。它们看起来像这样：

```
Probe.Id     Gene.Id             Score.d
1418126_at   6352                28.52578
145119_a_at  2192                24.87866
1423477_at   NA                  24.43532
1434193_at   100506144///9204    6.22395 
```

理想情况下，我想在“///”处拆分 Id，并将它们放在新行上。像这样：

```
Probe.Id     Gene.Id             Score.d
1418126_at   6352                28.52578
145119_a_at  2192                24.87866
1423477_at   NA                  24.43532
1434193_at   100506144           6.22395
1434193_at   9204                6.22395 
```

使用 strsplit 可以让我获得 Gene.Id 作为字符向量列表，但是一旦我有了它，我不确定最有效的方法是让每个单独的 id 在他们自己的行中使用正确的值来自另一个列。理想情况下，我不想只循环 25,000 行。

如果有人知道这样做的正确方法，我将非常感激。

**编辑：**我应该补充一点，有一个复杂的因素是有些行的 id 如下所示：

```
333932///126961///653604///8350///8354///8355///8356///8968///8352///8358///835‌​1///8353///8357" 
```

而且我不知道连续的最大 ID 数是多少。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T00:31:31.557

**编辑：** OP评论后的新解决方案。使用非常简单`data.table`：

```
df <- structure(list(Probe.Id = c("1418126_at", "145119_a_at", "1423477_at", 
        "1434193_at", "100_at"), Gene.Id = c("6352", "2192", NA, 
        "100506144///9204", "100506144///100506146///100506148///100506150"), 
         Score.d = c(28.52578, 24.87866, 24.43532, 6.22395, 6.22395)), 
        .Names = c("Probe.Id", "Gene.Id", "Score.d"), row.names = c(NA, 5L), 
        class = "data.frame")

require(data.table)
dt <- data.table(df)
dt.out <- dt[, list(Probe.Id = Probe.Id, 
          Gene.Id = unlist(strsplit(Gene.Id, "///")), 
          Score.d = Score.d), by=1:nrow(dt)]

> dt.out

#    nrow    Probe.Id   Gene.Id  Score.d
# 1:    1  1418126_at      6352 28.52578
# 2:    2 145119_a_at      2192 24.87866
# 3:    3  1423477_at        NA 24.43532
# 4:    4  1434193_at 100506144  6.22395
# 5:    4  1434193_at      9204  6.22395
# 6:    5      100_at 100506144  6.22395
# 7:    5      100_at 100506146  6.22395
# 8:    5      100_at 100506148  6.22395
# 9:    5      100_at 100506150  6.22395 
```

如果是固定模式，您可以添加`fixed = TRUE`到`strsplit`表达式以进一步加速。`///`

**替代**再次使用`data.table`. 考虑到这`strsplit`是一个矢量化操作，并且在整个`Gene.Id`列上运行它比一次运行 1 行要快得多（即使`data.table`运行速度非常快，你可以通过拆分前面的代码来获得更多的加速分为2个步骤：

```
# first split using strsplit (data.table can hold list in its columns!!)
dt[, Gene.Id_split := strsplit(dt$Gene.Id, "///", fixed=TRUE)]
# then just unlist them
dt.2 <- dt[, list(Probe.Id = Probe.Id, 
                  Gene.Id = unlist(Gene.Id_split), 
                  Score.d = Score.d), by = 1:nrow(dt)] 
```

`data.table`我只是多次复制此示例中显示的内容，直到获得`295245`行。然后我运行了一个基准测试`rbenchmark`：

```
# first function
DT1 <- function() {
    dt.1 <- dt[, list(Probe.Id = Probe.Id, 
             Gene.Id = unlist(strsplit(Gene.Id, "///", fixed = TRUE)), 
             Score.d = Score.d), by=1:nrow(dt)]
}

# expected to be faster function
DT2 <- function() {
    dt[, Gene.Id_split := strsplit(dt$Gene.Id, "///", fixed=TRUE)]
    # then just unlist them
    dt.2 <- dt[, list(Probe.Id = Probe.Id, Gene.Id = unlist(Gene.Id_split), Score.d = Score.d), by = 1:nrow(dt)]
}

require(rbenchmark)
benchmark(DT1(), DT2(), replications=10, order="elapsed")

#    test replications elapsed relative user.self sys.self
# 2 DT2()           10  15.708    1.000    14.390    0.391
# 1 DT1()           10  24.957    1.589    23.723    0.436 
```

对于此示例，您的速度大约提高了 1.6 倍。但这取决于带有`///`. 希望这可以帮助。

**旧解决方案：（**用于连续性）

一种方法是：1）`find the positions`发生这种`///`情况的地方，2）`extract`，3）`duplicate`，4）`sub`和5）`combine`它们。

```
df <- structure(list(Probe.Id = structure(c(1L, 4L, 2L, 3L), 
         .Label = c("1418126_at", "1423477_at", "1434193_at", "145119_a_at"), 
         class = "factor"), Gene.Id = structure(c(3L, 2L, NA, 1L), 
         .Label = c("100506144///9204", "2192", "6352"), class = "factor"), 
         Score.d = c(28.52578, 24.87866, 24.43532, 6.22395)), 
         .Names = c("Probe.Id", "Gene.Id", "Score.d"), 
         class = "data.frame", row.names = c(NA, -4L))

# 1) get the positions of "///"
idx <- grepl("[/]{3}", df$Gene.Id)

# 2) create 3 data.frames
df1 <- df[!idx, ] # don't touch this.
df2 <- df[idx, ] # we need to work on this

# 3) duplicate
df3 <- df2 # duplicate it.

4) sub    
df2$Gene.Id <- sub("[/]{3}.*$", "", df2$Gene.Id) # replace the end
df3$Gene.Id <- sub("^.*[/]{3}", "", df3$Gene.Id) # replace the beginning

# 5) combine/put them back
df.out <- rbind(df1, df2, df3)

# if necessary sort them here. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T00:52:15.023

这里使用`strsplit`和的解决方案`merge`

```
dat <- read.table(text ='Probe.Id     Gene.Id             Score.d
1418126_at   6352                28.52578
145119_a_at  2192                24.87866
1423477_at   NA                  24.43532
1434193_at   100506144///9204    6.22395',header=T,stringsAsFactors=F)
dat1 <- dat
xx <- do.call(rbind,strsplit(dat$Gene.Id,split='///'))
dat[which(xx[,1]!=xx[,2]),2]  <- xx[which(xx[,1]!=xx[,2]),1]
dat1[which(xx[,1]!=xx[,2]),2]  <- xx[which(xx[,1]!=xx[,2]),2]
  merge(dat,dat1,all.y=T,all.x=T)
     Probe.Id   Gene.Id  Score.d
1  1418126_at      6352 28.52578
2  1423477_at      <NA> 24.43532
3  1434193_at 100506144  6.22395
4  1434193_at      9204  6.22395
5 145119_a_at      2192 24.87866 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-29T01:40:39.537

这是一个使用 for 的构造函数的方法，使用`data.frame`它静默回收输入向量的“功能”：

```
do.call(rbind, 
        apply(dat, 1, function(x) 
                         data.frame(Probe.ID=x['Probe.Id'], 
                                    Gene.Id=strsplit(x['Gene.Id'], '///'),
                                    Score.d=x['Score.d'],
                                    row.names=NULL
                                   )
             )
        )
##      Probe.ID   Gene.Id  Score.d
## 1  1418126_at      6352 28.52578
## 2 145119_a_at      2192 24.87866
## 3  1423477_at      <NA> 24.43532
## 4  1434193_at 100506144  6.22395
## 5  1434193_at      9204  6.22395 
```

# java - 将联系人照片添加到 ImageView 的简单方法？

> ID：14573603
> 
> 赞同：7
> 
> 时间：2013-01-29T00:14:32.103
> 
> 标签：java, android, view

我在获取和设置联系人图像作为视图背景时遇到问题，令人惊讶的是，很少有关于如何做到这一点的示例。我正在尝试构建类似于显示大联系人照片的 People 应用程序的东西。

这就是我现在正在做的事情：

```
Uri uri = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, Long.valueOf(id));
InputStream input = ContactsContract.Contacts.openContactPhotoInputStream(context.getContentResolver(), uri);
Bitmap bm = BitmapFactory.decodeStream(input);
Drawable d = new BitmapDrawable(bm);
button.setBackgroundDrawable(drawable); 
```

这可行，但是它使用的 URI 获取缩略图，因此即使有一张大照片图像在缩放以适合 imageView 时看起来也很糟糕。我知道另一种获取实际获取大照片的 URI 的方法是：

```
final Uri imageUri = Uri.parse(cur.getString(cur.getColumnIndex(ContactsContract.Contacts.PHOTO_URI))); 
```

但是我还没有设法将它放到 imageView 中，也许上面的代码可以适应使用第二个 uri。如果您知道如何使用第二个 uri，或者如果有比通过 URI 更简单的方法来获取联系人图像，请告诉我。任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T00:06:56.340

获取 URI 的工作做得很好。您快到了。首先考虑使用 PHOTO_THUMBNAIL_URI 而不是 PHOTO_URI，因为它可能是您需要的大小。

编辑：仅供参考，PHOTO_THUMBNAIL_URI 从 API 11 开始可用。您仍然可以有条件地使用它。

如果你想使用外部库，' [Android Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader) ' 绝对是你要找的，因为从前几天的 1.7.1 版本开始，它增加了对内容方案的支持，它非常​​聪明，内存明智的。它还有很多自定义选项。

**编辑：这个库已经死了。请改用[Fresco](http://frescolib.org/)。**

如果您希望更好地调整最终包大小并自己编写代码，

您需要获取并解码该内容的输入流；这应该在后台线程上完成。看看这个方便的方法；你用你的图像视图和你得到的 uri 初始化它，并在你想加载 ImageView 时启动它。

```
private class ContactThumbnailTask extends AsyncTask<Void, Void, Bitmap> {

    private WeakReference<ImageView> imageViewWeakReference;
    private Uri uri;
    private String path;
    private Context context;

    public ContactThumbnailTask(ImageView imageView, Uri uri, Context context) {
        this.uri = uri;
        this.imageViewWeakReference = new WeakReference<ImageView>(imageView);
        this.path = (String)imageViewWeakReference.get().getTag(); // to make sure we don't put the wrong image on callback
        this.context = context;
    }

    @Override
    protected Bitmap doInBackground(Void... params) {
        InputStream is = null;
        try {
            is = context.getContentResolver().openInputStream(uri);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

        Bitmap image = null;
        if (null!= is)
            image=  BitmapFactory.decodeStream(is);

        return image;
    }

    @Override
    protected void onPostExecute(Bitmap bitmap) {
        if (imageViewWeakReference != null && imageViewWeakReference.get() != null && ((String)imageViewWeakReference.get().getTag()).equals(path) && null != bitmap)
            imageViewWeakReference.get().setImageBitmap(bitmap);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T13:43:55.897

是建议。首先要知道一件事。

当您设置联系人图像时。首先 Android 显示该图像的裁剪活动。喜欢 ![在此处输入图像描述](../Images/23c67c0629413d86a495028ffb5de611.png)

****仔细看上图。Android 将图像裁剪为方形。并将方形图像作为 Blob 存储在联系人中。（它不是单独的图像。它是 Blob。）
您可以从编码中获得用于图像视图的方形图像。所以顶部和底部只显示黑色。因为你的手机是矩形的。****

如果要显示全屏图像。请以编程方式为联系人设置大图像。互联网上有很多例子。

一切顺利。如果您有任何疑问。请提供意见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:08:11.600

您可以尝试使用 SmartImageView： http: [//loopj.com/android-smart-image-view/](http://loopj.com/android-smart-image-view/) extends imageview 并异步加载图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-31T18:48:16.927

为此，您只需添加最后一个参数 preferHighres = true：

```
openContactPhotoInputStream (ContentResolver cr, Uri contactUri, boolean preferHighres) 
```

如果**preferHighres**为 true 并且联系人有更高分辨率的照片可用，则返回。如果为 false，此函数总是尝试获取缩略图

```
 Uri uri = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, Long.valueOf(id));
     InputStream input = ContactsContract.Contacts.openContactPhotoInputStream(context.getContentResolver(), uri, true); 
```

所有的图像可能会有不同的尺寸。为了调整它们的大小，我使用下一个代码：

```
 Bitmap bm = BitmapFactory.decodeStream(input);
    bm = Bitmap.createScaledBitmap(photo, contactImageWidth, contactImageheight, false);
    Drawable d = new BitmapDrawable(getContext(), bm);
    button.setBackgroundDrawable(d); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T07:46:30.090

可能这会对您有所帮助（联系人由**getId()**标识）：

```
/**
 * @return the photo URI
 */

public Uri getPhotoUri() {
    try {
        Cursor cur = this.ctx.getContentResolver().query(
                ContactsContract.Data.CONTENT_URI,
                null,
                ContactsContract.Data.CONTACT_ID + "=" + this.getId() + " AND "
                        + ContactsContract.Data.MIMETYPE + "='"
                        + ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE + "'", null,
                null);
        if (cur != null) {
            if (!cur.moveToFirst()) {
                return null; // no photo
            }
        } else {
            return null; // error in cursor process
        }
    } catch (Exception e) {
        e.printStackTrace();
        return null;
    }
    Uri person = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, Long
            .parseLong(getId()));
    return Uri.withAppendedPath(person, ContactsContract.Contacts.Photo.CONTENT_DIRECTORY);
} 
```

**用法是：**

```
Uri u = objItem.getPhotoUri();
if (u != null) {
        mPhotoView.setImageURI(u);
} else {
        mPhotoView.setImageResource(R.drawable.ic_contact_picture_2);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-18T15:11:56.653

您可以使用以下方法轻松地将联系人照片设置为图像视图。

```
public String getImageUriString(String phoneNumber)
{
    ContentResolver resolver = context.getContentResolver();
    Cursor names = resolver.query(
            Uri.withAppendedPath(ContactsContract.PhoneLookup.CONTENT_FILTER_URI, Uri.encode(phoneNumber)),
            null, null, null, null);

    names.moveToFirst();
    String name = "";
    if(!names.isAfterLast())
    {
        name = names.getString(names.getColumnIndex(ContactsContract.PhoneLookup.PHOTO_URI));

    }
    else
    {
        name = null;
    }

    names.close();

    return name;
}

public void setImageView(ImageView contactPhoto) {

String photoUriString = di.getImageUriString(contactNumber);
        if(photoUriString != null) {
            Uri photoUri = Uri.parse(photoUriString);
            contactPhoto.setImageURI(photoUri);
        } else {
            contactPhoto.setImageResource(R.drawable.icon_contact);
        }
} 
```

在您的班级中，使用从上述方法获取的 uri 设置图像视图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-06T04:43:02.753

使用外部库为您执行此操作。或者浏览代码并按照自己的方式制作类似的东西。

这是我在自己的几个应用程序中使用的一个：[UrlImageViewHelper](https://github.com/koush/UrlImageViewHelper)

代码如下：

```
Uri uri = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, Long.valueOf(id));  
UrlImageViewHelper.setUrlDrawable(button, uri.toString(), R.drawable.dummy_contact_photo); 
```

# css - 使用引导程序将响应式网站居中

> ID：14573616
> 
> 赞同：2
> 
> 时间：2013-01-29T00:15:39.827
> 
> 标签：css, twitter-bootstrap

我想要的是在我的网站上具有左右边框的居中内容。您从代码中获得的东西类型：

```
.container {
    width: 90%;
    margin: 0 auto;
} 
```

但是我正在使用 twitter bootstrap 并且仍然希望保持网站响应，并且执行上述操作似乎破坏了网格布局。

谁能告诉我正确的方法来做这件事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:22:36.377

使用[流体网格文档](http://twitter.github.com/bootstrap/scaffolding.html#fluidGridSystem)`span12`中给出的，作为根容器将开箱即用地解决它，而不会破坏内置的响应能力。

像这样的东西 - [http://jsbin.com/amovub/5/edit](http://jsbin.com/amovub/5/edit)

**编辑：** 更新了上面的 JSBin 以尝试解决下面的评论。本质是：

CSS：

```
.centeredContent{
  width: 90%;
  margin: 0 auto;
} 
```

HTML：

```
<div class="span12">
  <div class="centeredContent">

  <!-- your content -->

  </div> <!-- /centeredContent -->
</div> <!-- /span12 --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T10:29:59.943

此页面是 Bootstrap 示例页面之一，它也是响应式的：

[http://twitter.github.com/bootstrap/examples/hero.html](http://twitter.github.com/bootstrap/examples/hero.html)

如果你 Firebug 这个页面，你会看到主要的“容器”类只是在使用：

```
.container {
    margin-left: auto;
    margin-right: auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:24:22.573

我没有使用 twitter，但是使用带边距的 css 在 html 中居中对象的标准方法如下：

.container { 宽度：90%; 边距：0 自动 0 自动；}

这应该给出相同的结果：

.container { 宽度：90%; 保证金：0 5% 0 5%；}

和：

.container { 宽度：90%; 左边距：5%；保证金权利：5％；}

# delphi - 德尔福的“现在”时间戳有多准确

> ID：14573617
> 
> 赞同：6
> 
> 时间：2013-01-29T00:15:43.337
> 
> 标签：delphi, timestamp

我将从事一个项目，该项目需要（相当）准确的时间标记来自自定义硬件的传入 RS232 串行和网络数据。由于数据将来自许多独立的硬件来源，我需要对所有数据进行时间戳，以便可以将其校正/插值到标称时间点。

我的直接操作只是使用内置的 Now 命令来设置时间戳，但是快速的 Google 似乎表明这只会精确到大约 50 毫秒左右。

不幸的是，我读得越多，我就越困惑。关于 GetTickCount 和 QueryPerformanceCounter 似乎有很多相互矛盾的建议，由于当今的多核处理器和 CPU 节流而变得复杂。我还看到了推荐使用 Windows 多媒体计时器的帖子，但我似乎找不到任何代码片段来执行此操作。

所以，谁能给我建议：

1）“现在”的准确性如何。

2) 是否有简单、精度更高的替代方案。

注意：我希望将时间戳记在 10 毫秒内，我并不是在寻找这样的计时器，只是一种更好的时间戳方法。这将在 Windows 7 32 位低功耗微型 PC 上运行。如果有什么不同，我将使用 Delphi XE 或 Delphi 2007。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-29T00:54:49.047

根据文档，[Now](http://docwiki.embarcadero.com/Libraries/XE3/en/System.SysUtils.Now)仅精确到最接近的秒数：

> 尽管 TDateTime 值可以表示毫秒，但 Now 仅精确到最接近的秒。

尽管如此，看看当前的实现，Now 与[GetLocalTime](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724338(v=vs.85).aspx) windows API 一样准确。

进行快速测试，它显示 Now 返回时钟中每毫秒的值，例如：

```
begin
  System.SysUtils.FormatSettings.LongTimeFormat := 'hh:mm:ss.zzz';
  for I := 1 to 5000 do
    Writeln(TimeToStr(Now()));
end. 
```

当我从命令行执行此控制台程序时`project1 >times.txt`，在 Windows 7 64 位机器中，我得到了一个持续 29 毫秒的文件（文件中没有丢失任何文件）。

您必须面对这样一个事实，即在 Windows 环境中运行时，您的应用程序/线程可能会在不同的时间获得处理器片，这取决于系统的繁忙程度以及您的应用程序/线程与运行在 Windows 中的所有其他线程的优先级。系统。

# javascript - CSS下拉菜单中的jQuery UX故障

> ID：14573621
> 
> 赞同：1
> 
> 时间：2013-01-29T00:15:55.503
> 
> 标签：javascript, jquery, css, drop-down-menu, user-experience

下面是一个带有一些错误的脚本，我正在尝试解决这些问题。**主要错误是当前**选择（悬停）项目的子菜单和**先前**选择的子菜单之间的混淆或混淆。

```
jQuery(document).ready(function($) {
    $("ul.menu > li").hover(
        function() {
            $(this).find("ul.sub-menu").stop().animate({
                height: 'toggle',
                opacity: 'toggle'
            });
        }
    );
}); 
```

该错误不会出现在每个父项的初始悬停上，但似乎只发生，[从这个小提琴可以看出](http://jsfiddle.net/pF8wZ/4/)，如果悬停在第二个父项上，然后悬停在第一个父项上，然后快速悬停到第一个子项菜单，您将看到所需的子菜单消失，而之前选择的子菜单重新出现。另外，我还应该补充一点，如果将鼠标悬停在第 3 个父项上，然后将鼠标悬停在第 2 个父项上，然后快速悬停到第 2 个子菜单，您将再次看到不希望的效果或错误。

另一个不太详细的错误或故障是，在正确组合或随机悬停数量后，3 个子菜单中的 1 个永久消失。基本上，脚本很不稳定；如何使这个脚本成为坚如磐石的 UI？如何消除这些错误以确保最佳用户体验？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:20:22.760

问题是您正在捕获第二个子菜单，而它仍然可见并且它被视为再次悬停它。

您可以通过更新与悬停元素对应的子菜单的 z-index 来轻松解决此问题：

```
$("ul.sub-menu").css('z-index', 1);
$(this).find("ul.sub-menu").css('z-index', 2).stop()... 
```

[http://jsfiddle.net/pF8wZ/6/](http://jsfiddle.net/pF8wZ/6/)

# ruby - 从 SQL Server 2008 解析 CSV 的语义正确方法是什么？

> ID：14573623
> 
> 赞同：3
> 
> 时间：2013-01-29T00:16:00.597
> 
> 标签：ruby, regex, csv

我从 SQL Server 2008 获得了一个 CSV 转储，其中包含如下行：

```
Plumbing,196222006P,REPLACE LEAD WATER SERVICE W/1" COPPER,1996-08-09 00:00:00
Construction,197133031B,"MORGAN SHOES" ALT,1997-05-13 00:00:00
Electrical,197135021E,"SERVICE, "OUTLETS"",1997-05-15 00:00:00
Electrical,197135021E,"SERVICE, "OUTLETS" FOOBAR",1997-05-15 00:00:00
Construction,198120036B,"""MERITER"",""DO IT CTR"", ""NCR"" AND ""TRACE"" ALTERATION",1998-04-30 00:00:00 
```

`parse_dbenhur`很漂亮，但是可以重写它以支持逗号和引号的存在吗？`parse_ugly`是，嗯，丑陋的。

```
# @dbenhur's excellent answer, which works 100% for what i originally asked for
SEP = /(?:,|\Z)/
QUOTED = /"([^"]*)"/
UNQUOTED = /([^,]*)/
FIELD = /(?:#{QUOTED}|#{UNQUOTED})#{SEP}/
def parse_dbenhur(line)
  line.scan(FIELD)[0...-1].map{ |matches| matches[0] || matches[1] }
end

def parse_ugly(line)
  dumb_fields = line.chomp.split(',').map { |v| v.gsub(/\s+/, ' ') }
  fields = []
  open = false
  dumb_fields.each_with_index do |v, i|
    open ? fields.last.concat(v) : fields.push(v)
    open = (v.start_with?('"') and (v.count('"') % 2 == 1) and dumb_fields[i+1] and dumb_fields[i+1].start_with?(' ')) || (open and !v.end_with?('"'))
  end
  fields.map { |v| (v.start_with?('"') and v.end_with?('"')) ? v[1..-2] : v }
end

lines = []
lines << 'Plumbing,196222006P,REPLACE LEAD WATER SERVICE W/1" COPPER,1996-08-09 00:00:00'
lines << 'Construction,197133031B,"MORGAN SHOES" ALT,1997-05-13 00:00:00'
lines << 'Electrical,197135021E,"SERVICE, "OUTLETS"",1997-05-15 00:00:00'
lines << 'Electrical,197135021E,"SERVICE, "OUTLETS" FOOBAR",1997-05-15 00:00:00'
lines << 'Construction,198120036B,"""MERITER"",""DO IT CTR"", ""NCR"" AND ""TRACE"" ALTERATION",1998-04-30 00:00:00'

require 'csv'
lines.each do |line|
  puts
  puts line
  begin
    c = CSV.parse_line(line)
    puts "#{c.to_csv.chomp} (size #{c.length})"
  rescue
    puts "FasterCSV says: #{$!}"
  end
  a = parse_ugly(line)
  puts "#{a.to_csv.chomp} (size #{a.length})"
  b = parse_dbenhur(line)
  puts "#{b.to_csv.chomp} (size #{b.length})"
end 
```

这是我运行它时的输出：

```
Plumbing,196222006P,REPLACE LEAD WATER SERVICE W/1" COPPER,1996-08-09 00:00:00
FasterCSV says: Illegal quoting in line 1.
Plumbing,196222006P,"REPLACE LEAD WATER SERVICE W/1"" COPPER",1996-08-09 00:00:00 (size 4)
Plumbing,196222006P,"REPLACE LEAD WATER SERVICE W/1"" COPPER",1996-08-09 00:00:00 (size 4)

Construction,197133031B,"MORGAN SHOES" ALT,1997-05-13 00:00:00
FasterCSV says: Unclosed quoted field on line 1.
Construction,197133031B,"""MORGAN SHOES"" ALT",1997-05-13 00:00:00 (size 4)
Construction,197133031B,"""MORGAN SHOES"" ALT",1997-05-13 00:00:00 (size 4)

Electrical,197135021E,"SERVICE, "OUTLETS"",1997-05-15 00:00:00
FasterCSV says: Missing or stray quote in line 1
Electrical,197135021E,"SERVICE ""OUTLETS""",1997-05-15 00:00:00 (size 4)
Electrical,197135021E,"""SERVICE"," ""OUTLETS""""",1997-05-15 00:00:00 (size 5)

Electrical,197135021E,"SERVICE, "OUTLETS" FOOBAR",1997-05-15 00:00:00
FasterCSV says: Missing or stray quote in line 1
Electrical,197135021E,"SERVICE ""OUTLETS"" FOOBAR",1997-05-15 00:00:00 (size 4)
Electrical,197135021E,"""SERVICE"," ""OUTLETS"" FOOBAR""",1997-05-15 00:00:00 (size 5)

Construction,198120036B,"""MERITER"",""DO IT CTR"", ""NCR"" AND ""TRACE"" ALTERATION",1998-04-30 00:00:00
Construction,198120036B,"""MERITER"",""DO IT CTR"", ""NCR"" AND ""TRACE"" ALTERATION",1998-04-30 00:00:00 (size 4)
Construction,198120036B,"""""MERITER""","""DO IT CTR"""," """"NCR"""" AND """"TRACE"""" ALTERATION""",1998-04-30 00:00:00 (size 6)
Construction,198120036B,"""""""MERITER""""","""""DO IT CTR"""""," """"NCR"""" AND """"TRACE"""" ALTERATION""",1998-04-30 00:00:00 (size 6) 
```

**更新**

请注意，当字段包含逗号时，CSV 使用双引号。

**更新 2**

如果逗号被从相关字段中删除，那很好......我的 parse_ugly 方法没有保留它们。

**更新 3**

我从客户那里得知，是 SQL Server 2008 正在[导出这个奇怪的 CSV](https://stackoverflow.com/questions/7382846/exporting-data-from-sql-server-express-to-csv-need-quoting-and-escaping) - 已在[此处](http://connect.microsoft.com/SQLServer/feedback/details/604010/unbalanced-double-quotes-in-csv-generated-from-reporting-services-2008)和[此处向 Microsoft 报告](http://connect.microsoft.com/SQLServer/feedback/details/636080/exporting-csv-cannot-handle-commas-quotes-in-strings)

**更新 4**

@dbenhur 的回答非常适合我最初的要求，但指出我忽略了用逗号和引号显示行。我会接受 d@benhur 的回答 - 但我希望它可以改进以适用于上述所有行。

**希望最终更新**

这段代码有效（我认为它“语义正确”）：

```
QUOTED = /"((?:[^"]|(?:""(?!")))*)"/
SEPQ = /,(?! )/
UNQUOTED = /([^,]*)/
SEPU = /,(?=(?:[^ ]|(?: +[^",]*,)))/
FIELD = /(?:#{QUOTED}#{SEPQ})|(?:#{UNQUOTED}#{SEPU})|\Z/

def parse_sql_server_2008_csv_line(line)
  line.scan(FIELD)[0...-1].map{ |matches| (matches[0] || matches[1]).tr(',', ' ').gsub(/\s+/, ' ') }
end 
```

改编自 @dbenhur 和 @ghostdog74 在[如何处理带有“坏逗号”的 CSV 文件中的答案？](https://stackoverflow.com/questions/3963090/ruby-how-can-i-process-a-csv-file-with-bad-commas/3964386#3964386)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:47:01.640

如果您的 CSV 从未使用双引号作为合法的引用字符，请将选项调整为 CSV 以通过`:quote_char => "\0"`，然后您就可以执行此操作（为清楚起见包装字符串）

```
1.9.3p327 > puts 'Construction,197133031B,"MORGAN SHOES" ALT,
                  1997-05-13 00:00:00'.parse_csv(:quote_char => "\0")
Construction
197133031B
"MORGAN SHOES" ALT
1997-05-13 00:00:00

1.9.3p327 > puts 'Plumbing,196222006P,REPLACE LEAD WATER SERVICE W/1" COPPER,
                  1996-08-09 00:00:00'.parse_csv(:quote_char => "\0")
Plumbing
196222006P
REPLACE LEAD WATER SERVICE W/1" COPPER
1996-08-09 00:00:00 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T03:14:20.783

以下使用正则表达式和[`String#scan`](http://ruby-doc.org/core-1.9.3/String.html#method-i-scan). 我观察到，在您正在处理的损坏的 CSV 格式中，`"`只有在字段的开头*和*结尾才具有引用属性。

扫描遍历与正则表达式连续匹配的字符串，因此正则表达式可以假定其起始匹配点是字段的开头。我们构造正则表达式，以便它可以匹配没有内部引号 ( `QUOTED`)*或非*逗号字符串( ) 的平衡引号字段`UNQUOTED`。当任一替代字段表示匹配时，它必须后跟一个分隔符，该分隔符可以是逗号或字符串结尾 ( `SEP`)

因为`UNQUOTED`可以匹配分隔符之前的零长度字段，所以扫描始终匹配末尾的空字段，我们将其丢弃`[0...-1]`。Scan 产生一个元组数组；每个元组都是一个捕获组的数组，所以我们`map`在每个元素上选择捕获的备用`matches[0] || matches[1]`。

您的示例行都没有显示包含逗号和引号的字段——我不知道它是如何合法表示的，并且这段代码可能无法正确识别这样的字段。

```
SEP = /(?:,|\Z)/
QUOTED = /"([^"]*)"/
UNQUOTED = /([^,]*)/

FIELD = /(?:#{QUOTED}|#{UNQUOTED})#{SEP}/

def ugly_parse line
  line.scan(FIELD)[0...-1].map{ |matches| matches[0] || matches[1] }
end

lines.each do |l|
  puts l
  puts ugly_parse(l).inspect
  puts
end

# Electrical,197135021E,"SERVICE, OUTLETS",1997-05-15 00:00:00
# ["Electrical", "197135021E", "SERVICE, OUTLETS", "1997-05-15 00:00:00"]
# 
# Plumbing,196222006P,REPLACE LEAD WATER SERVICE W/1" COPPER,1996-08-09 00:00:00
# ["Plumbing", "196222006P", "REPLACE LEAD WATER SERVICE W/1\" COPPER", "1996-08-09 00:00:00"]
# 
# Construction,197133031B,"MORGAN SHOES" ALT,1997-05-13 00:00:00
# ["Construction", "197133031B", "MORGAN SHOES\" ALT", "1997-05-13 00:00:00"] 
```

# javascript - KML DOM 行走很慢！如何避免走路的孩子？

> ID：14573627
> 
> 赞同：1
> 
> 时间：2013-01-29T00:16:38.180
> 
> 标签：javascript, kml, google-earth-plugin

我在导航从 Web 服务器上的 KMZ 文件（使用 fetchKml）获得的 KML DOM 时遇到了一些性能问题。我正在使用此处描述和讨论的 gex.dom.walk 方法：

[https://developers.google.com/earth/articles/domtraversal](https://developers.google.com/earth/articles/domtraversal)
[http://code.google.com/p/earth-api-utility-library/wiki/GEarthExtensionsDomReference](http://code.google.com/p/earth-api-utility-library/wiki/GEarthExtensionsDomReference)

本质上，我只是想在文件夹名称与 GUI 点击事件中的某些条件匹配时打开/关闭文件夹的可见性。正如我所说，这可行，但性能不是很好。在应用程序中更新可见性设置可能需要 30 - 60 秒。我在上面的链接中读到，您可以关闭子节点的行走，我尝试使用下面的对象文字方法来做到这一点。我包含的代码不会产生任何 javascript 错误，但不会提高性能。我不确定我是否正确创建了对象文字并正确设置了 walk children 属性。有什么建议吗？使用 gex.dom.walk 关闭 walk children 属性的一个很好的例子将非常有帮助。我在网上找不到示例。

这些文件夹中有许多地标（100 个），我有 25 个文件夹。所以，我想避免走他们，并怀疑这至少是性能问题的罪魁祸首的一部分。KMZ 文件大约 250 Kb，里面的 KML 大约 7.5 Mb。随着时间的推移，这个文件也会有所增长。

我还阅读了有关 Gzip 压缩的信息，并且必须对此进行更多研究。我怀疑这也可能有所帮助。

感谢您的任何直接回复或相关提示！

```
function visibilityKml(context) {

    //this is called by click events on the GUI
    //if a menu item click, traverse the KML DOM to process the visibility request
    //
    //
    var gex = new GEarthExtensions(ge);
    var walkStatus = {
        walkChildren : true
    };
    gex.dom.walk({
        rootObject: ge,
        visitCallback: function(walkStatus) {
            // 'this' is the current DOM node being visited.
            if ('getType' in this && this.getType() == 'KmlFolder') {
                  if ( context.match("AXYZ") && this.getName().match("AXYZ") && this.getVisibility() == false) {
                    this.setVisibility(true);
                  }
                  else if ( context.match("AXYZ") && this.getName().match("BXYZ") && this.getVisibility() == true) {
                    this.setVisibility(false);
                  }
                  else if ( context.match("BXYZ") && this.getName().match("BXYZ") && this.getVisibility() == false) {
                    this.setVisibility(true);
                  }
                  else if ( context.match("BXYZ") && this.getName().match("AXYZ") && this.getVisibility() == true) {
                    this.setVisibility(false);
                  }
                  else if ( context.match("All XYZ") && this.getName().match("XYZ") && this.getVisibility() == false) {
                    this.setVisibility(true);
                  }
                  if ( this.getName().match("XYZ") ) {
                    this.walkChildren = false;
                  }
            }
        } 
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:16:47.893

首先：在您的 KML 文件中，您需要编辑这些行

老的

```
<Folder>
      <name>Name of Folder</name>
      <Placemark>
      ..........
      </Placemark>
 </Folder> 
```

新的

```
<Folder id="unique_id">
      <name>Name of Folder</name>
      <Placemark>
      ..........
      </Placemark>
 </Folder> 
```

第二：当您希望切换此文件夹的可见性时，请使用访问[器](https://developers.google.com/earth/documentation/accessors)

根据您加载 KML 的方式（例如 fetch、parse、networklink），您可以使用不同的访问器。我假设您正在使用`fetchKml()`，所以我建议您考虑使用 [getElementByUrl()](https://developers.google.com/earth/documentation/accessors#getElementByUrl)

所以，你最终会做这样的事情：（你需要 # 符号）

```
var url = 'http://www.domain.com/yourFile.kml';
var folder = ge.getElementByUrl(url + '#' + 'unique_id');
folder.setVisibility(true|false); 
```

希望有帮助！

# jquery - jQuery UI droppable insert with caret to contenteditable

> ID：14573628
> 
> 赞同：0
> 
> 时间：2013-01-29T00:16:40.930
> 
> 标签：jquery, contenteditable, jquery-ui-draggable, caret, jquery-ui-droppable

我的问题非常具体，但我不确定如何做到最好：

我有一个 jQuery 可拖动和可放置的，因此可拖动可以放入特定的放置。我所有的 droppable 都是带有 contenteditable="true" 的 DIV，现在我想在悬停的光标位置插入一些代码（或者为了简单起见：可拖动的）。

因此，当拖动元素时，首先我需要在光标之外显示一个插入符号。（它们是 alpha 透明的，因此您可以看穿插入符号）。但是我如何获得等于实际鼠标光标的插入符号位置？

# php - Node.js：如何破译用 php 加密的文本？

> ID：14573630
> 
> 赞同：3
> 
> 时间：2013-01-29T00:17:01.303
> 
> 标签：php, node.js, cryptography, openssl, mcrypt

我的 PHP 加密看起来像这样：

```
<?
$salt = '…';
$data = '…';

$iv = mcrypt_create_iv(mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CFB), MCRYPT_RAND);
$ciphered = trim(base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, $salt, $data, MCRYPT_MODE_ECB,$iv))); 
```

我试图破译上面代码的结果：

```
ciphered = '…';
crypto = require('crypto');
salt = crypto.createHash('md5').update('…').digest('hex');
iv = '0123456789123455';
decipher = crypto.createDecipheriv('aes-256-cbc', salt, iv);
deciphered = decipher.update(ciphered, 'base64');
deciphered += decipher.final('utf-8'); 
```

此代码导致：`TypeError: DecipherFinal fail`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T05:01:32.097

我看到了几个问题：

1.  操作模式的不匹配。您为 CFB（[密码反馈](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Cipher_feedback_.28CFB.29)）操作模式生成 IV，您在实际加密时使用 ECB（[电子密码本](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Electronic_codebook_.28ECB.29)- 不推荐，只需查看该 wiki 文章中的图像了解原因）作为您的模式，然后尝试使用解密CBC（[密码块链接](http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Cipher-block_chaining_.28CBC.29)）模式。您应该坚持一种模式（可能是 CBC）。为此，请保留解密端`aes-256-cbc`并制作加密端`MCRYPT_MODE_CBC`

2.  [根据其文档](http://nodejs.org/api/crypto.html#crypto_crypto_createcipheriv_algorithm_key_iv)，您将 $salt （实际上是您的密钥）传递给`mcrypt_encrypt`而不对其进行散列，但对其进行散列，并在`crypto.createDecipheriv`需要`binary`编码字符串时返回一个十六进制字符串。两个键必须相同，并且需要遵循正确的编码，以便在传递给函数时它们保持相同。

3.  看起来您在加密端生成了一个 IV，然后在解密端使用一个固定字符串作为 IV。IV（初始化向量）需要与密文一起传递给解密方（可以与密文一起明文传输）。

4.  [根据其文档](http://nodejs.org/api/crypto.html#crypto_decipher_update_data_input_encoding_output_encoding)，您的 decipher 对象上的`update`方法不接受`base64`作为编码。您需要将 base64 文本转换为其他内容（可能是二进制编码），然后使用正确的编码将其传递给更新方法。

5.  PHP 的默认字符集是 ISO-8859-1，但您正试图将密文解密为 UTF-8 字符串。这可能会导致问题，尤其是当您使用标准 ASCII 以外的字符时。你要么需要确保你的 PHP 端在 UTF-8 模式下运行（查看[这个关于如何做到这一点的 SO 答案](https://stackoverflow.com/questions/9351694/setting-php-default-encoding-to-utf-8)），要么确保你的输入只使用 ASCII 字符（ISO-8859-1 是 ASCII 的超集) 并使用 'ascii' 输出编码。

您的大多数问题归结为编码问题。我不太了解 node.js 上的各种编码类型，因此您需要自行研究，但加密原语的问题应该很容易解决。确保阅读我链接的`mcrypt_encrypt` [文档](http://php.net/manual/en/function.mcrypt-encrypt.php)以及文档。

# java - 降低 isPalindrome 解决方案的复杂性？

> ID：14573631
> 
> 赞同：1
> 
> 时间：2013-01-29T00:17:12.480
> 
> 标签：java, time-complexity, palindrome

这是我的 isPalindrome 方法

```
public static boolean isPalindrome(String s){
    for(int i = 0; i < s.length()/2; i++){
        int j = s.length() - 1 - i;
        if(s.charAt(i) != s.charAt(j))
            return false;
    }
    return true;
} 
```

我的老师说我可以降低复杂性，但我不知道如何。我已经只经历了一半的字符串。有没有办法降低这个解决方案的复杂性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:26:50.270

你可以尝试这样的事情：

```
public static boolean isPalindrome (String str) {
    int left = 0;
    int right = str.length() - 1;

    while (left < right) {
        if (str.charAt(left) != str.charAt(right))
            return false;
        left++;
        right--;
    }
    return true;
} 
```

这样做的好处是每次循环都不会计算右手索引，特别是因为它每次都必须访问字符串长度（这是恒定的）。

顺便说一句，我也倾向于比 , 更喜欢更有意义的变量名`s`，`i`并且`j`- 我的基本规则是，如果你不得不求助于`j`，你最好更有表现力地命名你的计数器（`i`如果它是唯一的计数器，那没关系）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:25:05.210

我唯一能想到的就是存储的长度`s`：

```
final int n = s.length();
for(int i=0; i<n/2; i++) {
    int j = n-1-i;
    if(s.charAt(i) != s.charAt(j))
        return false;
}
return true; 
```

除此之外，我看不出如何使它更简单或更高效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T00:28:13.593

如果他的意思是您的代码在美学上的复杂性，那么这里有一个递归解决方案：

```
public static boolean isPalindrome(String s) {
    if (s.charAt(0) != s.charAt(s.length() - 1)
       return false;
    return isPalindrome(s.substring(1, s.length() - 1);
} 
```

如果他指的是算法的复杂性，我不确定你是否可以更快地做到这一点。也许您可以将子字符串移动到不同的核心（使用线程），然后组合结果。

编辑：paxdiablo 建议了更好的代码，我将其重新挂起*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:57:54.067

如果你反转字符串并且它仍然等于它自己，这意味着它是一个回文。以下是我将如何实现它：

```
package com.sandbox;

import org.apache.commons.lang.StringUtils;
import org.junit.Test;

import static junit.framework.Assert.assertFalse;
import static junit.framework.Assert.assertTrue;

public class PalindromeTest {

    @Test
    public void testTheseArePalindromes() {
        assertTrue(isPalindrome("abccba"));
        assertTrue(isPalindrome("121"));
        assertTrue(isPalindrome("Malayalam"));
        assertTrue(isPalindrome("peeweep"));
        assertTrue(isPalindrome("123 321"));
    }

    @Test
    public void testTheseAreNOTPalindromes() {
        assertFalse(isPalindrome("abc"));
        assertFalse(isPalindrome("123"));
        assertFalse(isPalindrome("123 123"));
    }

    private boolean isPalindrome(String input) {
        String lowerIn = input.toLowerCase();
        String reversed = StringUtils.reverse(lowerIn);
        return lowerIn.equals(reversed);
    }

} 
```

[此页面上的短语](http://www.rinkworks.com/words/palindromes.shtml)也是回文。它必须对那些起作用吗？如果是这样，这是一个非常简单的更改：

```
package com.sandbox;

import org.apache.commons.lang.StringUtils;
import org.junit.Test;

import static junit.framework.Assert.assertFalse;
import static junit.framework.Assert.assertTrue;

public class PalindromeTest {

    @Test
    public void testTheseArePalindromes() {
        assertTrue(isPalindrome("abccba"));
        assertTrue(isPalindrome("121"));
        assertTrue(isPalindrome("Malayalam"));
        assertTrue(isPalindrome("peeweep"));
        assertTrue(isPalindrome("123 321"));
        assertTrue(isPalindrome("A dog, a plan, a canal: pagoda."));
        assertTrue(isPalindrome("A man, a plan, a canal: Panama."));
        assertTrue(isPalindrome("A tin mug for a jar of gum, Nita."));
    }

    @Test
    public void testTheseAreNOTPalindromes() {
        assertFalse(isPalindrome("abc"));
        assertFalse(isPalindrome("123"));
        assertFalse(isPalindrome("123 123"));
    }

    private boolean isPalindrome(String input) {
        String removedPunctuation = input.toLowerCase().replaceAll("[.,;: \t]", "");
        String reversed = StringUtils.reverse(removedPunctuation);
        return removedPunctuation.equals(reversed);
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-21T12:54:31.853

这是我的 C# 解决方案，我没有对其进行速度测试。

```
using System;

public class Palindrome
{
    public static bool IsPalindrome(string word)
    {
        var arr = word.ToCharArray();
        Array.Reverse(arr);
        return word.ToLower() == new string(arr).ToLower() ? true : false;
    }

    public static void Main(string[] args)
    {
        Console.WriteLine(Palindrome.IsPalindrome("Deleveled"));
    }
} 
```

# python - Google AppEngine - 如何执行部分数据存储下载

> ID：14573634
> 
> 赞同：0
> 
> 时间：2013-01-29T00:17:29.490
> 
> 标签：python, google-app-engine, google-cloud-datastore

我有一个正在运行的 GAE 应用程序，它已经收集了一段时间的数据。我现在需要对此数据运行一些基本报告，并希望将实时数据的子集下载到我的开发服务器。下载所有类型的实体对于开发服务器来说只是一个太大的数据集。

有谁知道从特定种类下载实体子集的方法？理想情况下，它将基于日期或客户端 ID 等实体属性......但任何方法都可以。当我认为我有足够的数据时，我什至尝试了常规的完整下载然后任意终止该进程，但似乎数据被锁定在bulkloader生成的.sql3文件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-12T22:18:51.297

看起来从/到 GAE 数据存储实用程序的默认下载/上传不支持过滤（[appcfg.py](https://developers.google.com/appengine/docs/python/tools/uploadingdata)和 bulkloader.py）。

做以下两件事之一似乎是合理的：

*   编写一个实用程序（select+export+save-to-local-file）并在本地执行它访问远程[api](https://developers.google.com/appengine/docs/python/tools/remoteapi#Running_Remote_Shell) shell中的远程 GAE 数据存储
*   为 select+export+zip 编写一个管理 Web 功能 - 处理程序中的新 url + 上传到 GAE + call-it-using-http

# android - Android KSOAP2 抛出 SocketTimeoutException

> ID：14573637
> 
> 赞同：1
> 
> 时间：2013-01-29T00:17:42.053
> 
> 标签：android, ksoap2

为了连接到 .NET Web 服务，我在我的 Android 项目中将上述库用于 SOAP 对象。该应用程序运行良好，直到我进行了一些更改并增加/减少了目标 API。它开始抛出 SocketTimeoutException 并且不会消失。

我正在使用**Android 开发者工具构建：v21.0.0-519525**

任何帮助表示赞赏。

```
 private static final String NAMESPACE = "https://monitor.co.uk/";
    private static final String URL = "https://monitor.co.uk/WebService.asmx";

    private static final String GET_ID_METHOD = "GetId";
    private static final String GET_ID_SOAP_ACTION = "https://monitor.co.uk/GetId";
    public static String callGetIdWebService(String pass, String id, Context context)
    {
      String sRes = "";
      try 
      { 

        SoapObject request = new SoapObject(NAMESPACE, GET_ID_METHOD);

            PropertyInfo pi = new PropertyInfo();
            pi.setName("pass");
            pi.setValue(pass.toString());//"pass");// 
            pi.setType(pass.getClass());
            request.addProperty(pi);

            PropertyInfo pi2 = new PropertyInfo();
            pi2.setName("id");
            pi2.setValue(id.toString());
            pi2.setType(id.getClass());
            request.addProperty(pi2);

            SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
            envelope.dotNet = true;
            envelope.setOutputSoapObject(request);  
            envelope.implicitTypes = true;

            HttpTransportSE httpTransport = new HttpTransportSE(URL);

            httpTransport.debug = true;

            httpTransport.call(GET_ID_SOAP_ACTION, envelope);
            Object response = envelope.getResponse();

            httpTransport.debug = true;
            if(response.toString().equals("-1"))
            {
                sRes = "No records";
            }
            else
            {
                sRes = response.toString();
            }
      } 

      catch (Exception e) 
      {
        e.printStackTrace();
        Log.i("EXCEPTION...", e.toString());

      }
      return sRes;
    } 
```

日志猫如下：

```
01-28 17:39:34.213: W/System.err(16378): java.net.SocketTimeoutException
01-28 17:39:34.218: W/System.err(16378):    at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:130)
01-28 17:39:34.218: W/System.err(16378):    at com.example.notificationmanager.CreateNotificationActivity.callGetIdWebService(CreateNotificationActivity.java:94)
01-28 17:39:34.218: W/System.err(16378):    at com.example.notificationmanager.CreateNotificationActivity.createNotification(CreateNotificationActivity.java:37)
01-28 17:39:34.218: W/System.err(16378):    at java.lang.reflect.Method.invokeNative(Native Method)
01-28 17:39:34.218: W/System.err(16378):    at java.lang.reflect.Method.invoke(Method.java:511)
01-28 17:39:34.218: W/System.err(16378):    at android.view.View$1.onClick(View.java:3095)
01-28 17:39:34.218: W/System.err(16378):    at android.view.View.performClick(View.java:3627)
01-28 17:39:34.223: W/System.err(16378):    at android.view.View$PerformClick.run(View.java:14329)
01-28 17:39:34.223: W/System.err(16378):    at android.os.Handler.handleCallback(Handler.java:605)
01-28 17:39:34.223: W/System.err(16378):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-28 17:39:34.223: W/System.err(16378):    at android.os.Looper.loop(Looper.java:137)
01-28 17:39:34.223: W/System.err(16378):    at android.app.ActivityThread.main(ActivityThread.java:4511)
01-28 17:39:34.223: W/System.err(16378):    at java.lang.reflect.Method.invokeNative(Native Method)
01-28 17:39:34.228: W/System.err(16378):    at java.lang.reflect.Method.invoke(Method.java:511)
01-28 17:39:34.228: W/System.err(16378):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
01-28 17:39:34.228: W/System.err(16378):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
01-28 17:39:34.228: W/System.err(16378):    at dalvik.system.NativeStart.main(Native Method) 
```

利亚卡特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T11:52:25.180

在我的应用程序发生了另外几个异常之后，我得到了这个修复，其他一些人在我的另一个问题上回答并建议使用 AsyncTask。一旦让 AsyncTask 工作，这个错误也消失了。因此，假设问题是由在 GUI 活动上进行网络操作的相同问题引起的，猜测这很好。

非常感谢你的协助。利亚卡特。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T11:46:22.877

有趣的是，在增加/减少目标 API 和使用清单时，请确保您拥有 Internet 权限：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# php - 如果图像像 pinterest 那样太小，缩放图像的最佳方法是什么？

> ID：14573640
> 
> 赞同：1
> 
> 时间：2013-01-29T00:17:55.923
> 
> 标签：php, image, pinterest

pinterest 如何重新调整他们的图像？即使您上传一个 16x16 的图标，它也会重新缩放它，但让它看起来很平滑。有谁知道他们的调整大小机制是如何工作的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T13:17:55.900

您提供的示例看起来他们只是将图像的高度设置为容器的高度，即在标签的`height`属性中。`<img>`我不会说它看起来很流畅，而且纵横比显然很差。

但是如果你想自己在 PHP 中调整图像大小，有几个像 GD 这样的图像库。查看[imagecopyresampled](http://php.net/manual/en/function.imagecopyresampled.php)函数（该页面上有一些示例代码）或搜索一些教程。

# php - 为什么 MySQL 在这种情况下需要一个参数

> ID：14573641
> 
> 赞同：0
> 
> 时间：2013-01-29T00:18:05.830
> 
> 标签：php, mysql

我只想从客户表中获取一封电子邮件并将消息发送到该电子邮件。我收到此错误

> “警告：mysql_num_rows() 期望参数 1 是”

我的代码如下：

```
<?php
       $mysql = mysql_connect("localhost", "hname", "passs", "dbname");

       $getusers = mysql_query("SELECT * FROM customer");
       while ($row = mysql_fetch_array($result)) {
       sendMail($row['email']);
       }
       mysql_free_result($result);
       function sendMail($to){
       $subject = 'the subject';
       $message = 'hello';
       $headers = 'From: webmaster@example.com' . "\r\n" .
       'Reply-To: webmaster@example.com' . "\r\n" .
       'X-Mailer: PHP/' . phpversion();
       mail($to, $subject, $message, $headers);
       }
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:19:58.257

您正在建立`myslqi`连接，但随后使用`mysql_*`(no `i`) 功能。你应该使用所有`mysqli`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T05:35:39.910

你可以试试这段代码：

```
while ($row = mysql_fetch_array($result)) { 
```

至

```
while ($row = mysql_fetch_array($getusers)) { 
```

# port - Python Flask 服务器向域添加另一个端口

> ID：14573642
> 
> 赞同：8
> 
> 时间：2013-01-29T00:18:16.017
> 
> 标签：port, flask, multi-user

初始条件：我有一个 Python Flask 服务器在我通过 Linux（OpenSuse）命令行访问的远程机器上运行。服务器工作完美。它为 xyz.com:5000 呈现 html。

问题：我是添加的新用户。我希望服务器读取我的 .py 文件。我该怎么办？我需要一个新的端口号吗？还是 xyz.myusername.com:5000？我必须更改哪些配置？超级用户需要干预吗？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-29T14:55:26.733

Flask 的内置服务器不适合生产使用——或者至少，文档将其称为“本地开发服务器”。

对于生产，您需要使用 Tornado、gunicorn 甚至 Apache 之类的东西。

另请参阅：[Flask 文档，涵盖`Flask.run()`方法](http://flask.pocoo.org/docs/api/#flask.Flask.run)。

也就是说 - 它只是一个 Python 程序。您没有理由不能通过`app.run(port=5001)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T16:44:58.907

你能更具体地谈谈你的问题吗？“您是添加的新用户”是什么意思 - 什么用户，在哪里添加？您所说的“读取 .py 文件的服务器”是什么意思 - 服务器作为您所指的远程机器，或者服务器作为 Flask http 开发服务器，或者其他什么？如果没有准确描述您的环境（例如操作系统类型），您想要实现的目标（而不是询问您应该执行 X 还是 Y）以及您遇到的问题（不知道您的软件，如 Flask 的工作原理不是实际问题）我们将无法为您提供帮助。

# php - 并行执行多个 Hive 查询

> ID：14573647
> 
> 赞同：1
> 
> 时间：2013-01-29T00:18:57.947
> 
> 标签：php, hadoop, hive, hiveql

我正在使用 php、Hadoop/Hive（**单节点 Hadoop 集群-cloudera vm、8 CPU 4 GB RAM**）、Thrift API 开发基于 Web 的分析工具。Hive thrift API 按顺序运行 Hive 查询，这需要大量时间来执行。我正在尝试对这些配置单元查询使用多线程方法，以便它们可以并行执行并节省执行时间。

我已在**conf/mapred-site.xml**文件中将“ **mapred.tasktracker.map.tasks.maximum** ”的默认值更改为**20**，并将“ **mapred.tasktracker.reduce.tasks.maximum** ”的默认值更改为**20 。**我还在 conf/hive-site.xml 中将“ hive.exec.parallel **”****的**默认值更改为**true**。

 ******我可以使用**PHP“curl_multi_exec”**并行运行 4 个 hive 查询，但 5 个并行 hive 查询需要无限的执行时间。在进行了前面提到的更改后，我仍然得到相同的结果。

我能够并行执行 4 个查询，但不能执行 5 个。

那么，在这里我做错了什么？为什么它适用于 4 个并行查询但不适用于 5 个并行查询？我是否需要对配置文件进行任何其他更改？

谢谢，******

# css - CSS 间距危机

> ID：14573648
> 
> 赞同：0
> 
> 时间：2013-01-29T00:18:57.870
> 
> 标签：css, spacing

我浏览了您与此相关的主题，并尝试了您提出的解决方案，但没有一个对我有用。

我正在制作的此页面上的所有内容看起来都很棒，只有单词下方和上方的间距相距甚远。我尝试的任何方法似乎都不起作用。我就是想不通。

下面是它的完整 CSS 代码。我道歉，但我想彻底。也许一双新的眼睛会发现问题。

*我遇到问题的区域是#portcover

```
/* Body / Whole Document */

html, body{
    margin:0px;
    padding:0px;
    width:960px;
    height:auto;
    min-height:100%;
    background-color:#666666;
}

.greeting {
    position:relative;
    margin:50px 0px 0px 200px;
    padding:50px 0px 0px 0px;
    width:500px;
    height:300px;
    background-color:#A30000;
    color:#FFF;
    font-family:agency fb;
    font-size:50px;
    text-align:center;
    border-radius:85px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#click {
    position:absolute;
    top:45px;
    left:200px;
    width:100px;
    height:55px;
    color:#FFF;
    color:#FFF;
    font-family:agency fb;
    font-size:50px;
    text-align:center;
}

#to {
    position:absolute;
    top:125px;
    left:200px;
    width:100px;
    height:55px;
    color:#FFF;
    color:#FFF;
    font-family:agency fb;
    font-size:50px;
    text-align:center;
}

#enter {
    position:absolute;
    top:225px;
    left:200px;
    width:100px;
    height:55px;
    color:#FFF;
    color:#FFF;
    font-family:agency fb;
    font-size:50px;
    text-align:center;
}

.container {
    position:relative;
    margin:0px auto;
    width:864px;
    height:auto;
    background-color:transparent;
}

.clear {
    position:relative;
    clear:both;
    width:960px;
    height:0px;
}

noscript {
    position:absolute;
    padding:10px 0px;
    top:50px;
    left:130px;
    width:60%;
    height:175px;
    background-color:#000;  
    text-align:center;
    line-height:50px;
    color:#FFF;
    font-size:20px;
}

noscript a {
    font-size:23px;
    font-weight:bold;
}

/*=================== Banner =======================*/

.banner {
    position:relative;
    margin:50px 0px 0px 200px;
    padding:0px;
    width:690px;
    height:150px;
    font-family:agency fb;
}

#logo {
    position:relative;
    margin:0px;
    padding:0px;
    width:172.8px;
    height:100%;
    line-height:150px;
    background-color:#D11717;
    color:#FAFAFA;
    font-weight:bold;
    font-size:100px;
    text-align:center;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#fullname {
    position:absolute;
    margin:-50px;
    padding:0px;
    top:100px;
    left:55px;
    width:600px;
    height:50px;
    line-height:50px;
    background-color:#D11717;
    color:#FAFAFA;
    font-weight:normal;
    font-size:40px;
    text-align:center;
    border-radius:20px;

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
}

.topnav {
    position:relative;
    float:right;
    margin:0px 0px 0px 0px;
    padding:0px;
    width:690.3px;
    height:100%;
    background-color:#transparent;
}

/*==================================== Portfolio =============================*/
#portfolio {
    position:relative;
    margin:-200px 0px 0px 175px;
    padding:0px;
    width:172.8px;
    height:100%;
    line-height:150px;
    color:#FAFAFA;
    font-weight:normal;
    font-size:50px;
    text-align:center;  
    background-color:#FFF;
    display:block;
    color:#000;
    text-decoration:none;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#portfolio:hover {
    background-color:#D11717;
    color:white;
    border-radius:20px 20px 0px 0px;
}

#portcover {
    display:none;
    position:relative;
    margin:-50px 0px 0px 0px;
    padding:0px;
    width:525px;
    height:300px;
    background-color:#921010;
    border-radius:0px 20px 20px 20px;

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#portdiv {
    position:absolute;
    margin:10px;
    padding:0px;
    width:515px;
    height:290px;
    background-color:#D11717;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

a:link, a:visited {
    color:#FFF;
}

#portinfo {
    position:relative;
    margin:0px;
    padding:0px;
    width:40%;
    height:auto;
    font-family:verdana;
    font-weight:normal;
    color:white;
    font-size:15px;
}

#portlinks {
    position:relative;
    float:right;
    margin:-50px;
    padding:-50px;
    width:40%;
    height:auto;
    font-family:verdana;
    font-weight:normal;
    color:white;
    font-size:15px;

    outline:2px solid white;
}

#portdiv a {
    position:relative;
    margin:0px;
    padding:0px 100px 0px 100px;
    text-decoration:none;
    width:20px;
    height:50px;
    border-radius:150px;
}

#portdiv a:hover {
    background-color:#000;
    font-size:25px;
}

/*==================================================================*/

#contact {
    position:relative;
    margin:-200px 0px 0px 349px;
    padding:0px;
    width:172.8px;
    height:100%;
    line-height:150px;
    color:#FAFAFA;
    font-weight:normal;
    font-size:50px;
    text-align:center;  
    background-color:#FFF;
    display:block;
    color:#000;
    text-decoration:none;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#contact:hover {
    background-color:#D11717;
    color:white;
    border-radius:20px 20px 0px 0px;
}

#concover {
    display:none;
    position:absolute;
    margin:-50px 0px 0px 0px;
    padding:0px;
    top:150;
    right:200;
    width:525px;
    height:300px;
    background-color:#921010;
    border-radius:20px 0px 20px 20px;

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);

    outline:2px solid yellow;
}

#condiv1 {
    position:absolute;
    margin:10px 5px 0px 0px;
    padding:0px;
    width:515px;
    height:290px;
    background-color:#D11717;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#condiv1a {
    position:relative;
    float:right;
    margin:100px 0px 0px 0px;
    padding:0px;
    width:50%;
    height:25%;
    background-color:transparent;
    font-family:verdana;
    font-weight:normal;
    color:white;
    font-size:15px;

    outline:2px solid white;
}

#condiv1b {
    position:relative;
    margin:0px;
    padding:0px;
    width:50%;
    height:25%;
    background-color:transparent;
    font-family:verdana;
    font-weight:normal;
    color:white;
    font-size:15px;

    outline:2px solid white;
}

#about {
    position:relative;
    margin:-200px 0px 0px 523px;
    padding:0px;
    width:172.8px;
    height:100%;
    line-height:150px;
    color:#FAFAFA;
    font-weight:normal;
    font-size:50px;
    text-align:center;  
    background-color:#FFF;
    display:block;
    color:#000;
    text-decoration:none;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#about:hover {
    background-color:#D11717;
    color:white;
    border-radius:20px 20px 0px 0px;
}

#abcover {
    display:none;
    position:absolute;
    margin:-50px 0px 0px 0px;
    padding:0px;
    top:200px;
    right:0px;
    width:525px;
    height:300px;
    background-color:#921010;
    font-family:verdana;
    font-weight:normal;
    color:white;
    font-size:15px;
    border-radius:20px 0px 20px 20px;

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
}

#abdiv {
    position:absolute;
    margin:10px 10px 0px 0px;
    padding:0px 0px 0px 20px;
    width:495px;
    height:290px;
    background-color:#D11717;
    text-align:left;
    border-radius:20px;

    background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -moz-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -o-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: -ms-linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));
    background-image: linear-gradient(top, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.2));

    -webkit-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    -moz-box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
    box-shadow: 3px 3px 3px rgba(0, 0, 0, 0.5);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:49:37.403

尝试添加：

```
 * {
line-height: 1.2em!important;
} 
```

这将很快向您显示这是否是行高问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:55:13.427

如果您指的是从上到下的文本间距，请尝试使用以 px 为单位的行高。如果您只提供没有 html 标记的 css 代码，我无法弄清楚错误

# c# - String.Format：输入字符串的格式不正确

> ID：14573650
> 
> 赞同：39
> 
> 时间：2013-01-29T00:19:11.227
> 
> 标签：c#, .net, exception-handling, string.format

以下代码不断给我错误提示输入字符串的格式不正确，但我很确定它是正确的，不是吗？

```
int id = 112;

String[] newData = { "1", "2", "21", "reidb", "reidb", "reidb", "reidb", "aa", 
                      "Some description", "11", "2012-02-28", "2012-01-29", "true", "1", "1", 
                      "true", "note note note", "true", "1", "2011-12-03", "45"};

String data = "{ cmd: \"save magellan deal\", data: { id: {0} , AId: {1}, " +
            "CId: {2}, CCId:{3}, LA: \"{4}\", BA: \"{5}\" , " +
            "LSA: \"{6}\" , BSA: \"{7}\" , \"path: \"{8}\"," +
            "dscp: \"{9}\", SI: \"{10}\", CD: \"{11}\", " +
            "period: \"{12}\", IsStatic: {13}, LSD: {14}, LC: {15}, RB: {16},} " +
            "Notes: \"{17}\", IsEE: {18}, RBy: {19}, DPDD: \"{20}\", LId: {21} } }";

String cmd = String.Format(data, id.toString(), newData); 
```

有人有什么想法吗？

=== 编辑 ===

修复大括号后，出现“索引（从零开始）必须大于或等于零且小于参数列表的大小”的新错误。给出。newData 有 21，加上 id.toString()，应该是 22？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2013-01-29T00:21:18.617

转义格式字符串中的“{”、“}”（通过复制它们）：

```
"{{ cmd: \"save magellan deal\", data: {{ id: {0} , AId: {1}, " +
"CId: {2}, CCId:{3}, LA: \"{4}\", BA: \"{5}\" , " +
"LSA: \"{6}\" , BSA: \"{7}\" , \"path: \"{8}\"," +
"dscp: \"{9}\", SI: \"{10}\", CD: \"{11}\", " +
"period: \"{12}\", IsStatic: {13}, LSD: {14}, LC: {15}, RB: {16},}} " +
"Notes: \"{17}\", IsEE: {18}, RBy: {19}, DPDD: \"{20}\", LId: {21} }} }}" 
```

格式字符串中有 22 个元素，数组中有 21 个元素。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-29T00:21:10.563

*newData*中有 21 个元素，但使用了 22 个占位符（编号为 0 到 21）。

此外，您必须在输入数据中转义文字“{”

> 左大括号和右大括号被解释为格式项的开始和结束。因此，您必须使用转义序列来显示文字左大括号或右大括号。在固定文本中指定两个左大括号（“{{”）以显示一个左大括号（“{”），或两个右大括号（“}}”）以显示一个右大括号（“}”）。格式项中的大括号按照遇到的顺序依次解释。不支持解释嵌套大括号。

[http://msdn.microsoft.com/en-us/library/txafckwd.aspx](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-29T10:29:44.420

我在评论中说了很多，但我认为现在值得回答：

**不要使用`string.Format`**（在这种情况下）。它速度较慢，可读性较差。如果您需要复杂的连接，只需使用带有有意义的变量名的普通字符串连接 - 这些将更快且更易于维护。更快，因为对于固定数量的段，由于编译器优化， plain`+`是[最快的选项，并且更易于维护，因为读者可以看到放置变量的字符串中的上下文。](http://blogs.msdn.com/b/ricom/archive/2003/12/15/43628.aspx)

正如 Hans Passant 所指出的，看起来您正在制作一个 javascript 文字。如果是这种情况，请考虑使用 Json 序列化程序，例如[Json.NET](http://james.newtonking.com/projects/json-net.aspx)：

```
JsonConvert.SerializeObject(new {
    cmd = "save magellan deal",
    data = new {
        id = 12345, AId = 1, CId = 2, CCId = 21,
        LA = "reidb", BA = "reidb", LSA = "reidb", BSA = "reidb",
        path = "aa", dscp = "Some description", SI = 11,
        CD = "2012-02-28", period = "2012-01-29",
        IsStatic = true, LSD = 1, LC = 1, RB = true,
    },
    Notes = "note note note",
    IsEE = true, RBy = 1, DPDD = "2011-12-03", LId = 45
}) 
```

虽然`Json.NET`确实支持`DateTime`序列化，但 JS 中的日期没有标准化格式，因此这些日期被序列化为 iso 8601 格式的字符串。这可能不是您需要的，因此本示例中的日期字符串 - 不过，我会先尝试 iso 格式，因为这是最简单的解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-29T00:49:59.477

除了转义花括号外，还尝试将`String[]`定义更改为：

```
int id = 112;

String[] newData = {id.ToString(), "1", "2", "21", "reidb", "reidb", "reidb", "reidb", "aa", 
          "Some description", "11", "2012-02-28", "2012-01-29", "true", "1", "1", 
          "true", "note note note", "true", "1", "2011-12-03", "45"}; 
```

并将您的更改`String.Format`为：

```
String cmd = String.Format(data,newData); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-29T01:00:22.160

什么

```
String cmd = String.Format(data, id.toString(), newData); 
```

做的是：尝试格式化字符串数据，只使用 2 个字符串..不是 22！！
哪些？...1）id.ToString（）和2）newData.ToString（）
这显然是错误 的

你怎么能看出这是问题所在……？在数据字符串中只留下 {0} 和 {1} 并打印它。它编译正常，看看你得到了什么。
当然，您必须在需要字符串文字的地方使用 {{ 而不是 {

完全有效的解决方案：

```
int id = 112;

String[] newData = { id.ToString(),"1", "2", "21", "reidb", "reidb", "reidb", "reidb", "aa", 
                  "Some description", "11", "2012-02-28", "2012-01-29", "true", "1", "1", 
                  "true", "note note note", "true", "1", "2011-12-03", "45"};

String data = "{{ cmd: \"save magellan deal\", data: {{ id: {0} , AId: {1}, " +
                    "CId: {2}, CCId:{3}, LA: \"{4}\", BA: \"{5}\" , " +
                    "LSA: \"{6}\" , BSA: \"{7}\" , \"path: \"{8}\"," +
                    "dscp: \"{9}\", SI: \"{10}\", CD: \"{11}\", " +
                    "period: \"{12}\", IsStatic: {13}, LSD: {14}, LC: {15}, RB: {16},}} " +
                    "Notes: \"{17}\", IsEE: {18}, RBy: {19}, DPDD: \"{20}\", LId: {21} }} }}";

String cmd = String.Format(data, newData); 
```

# knockout.js - 如何将当前项目传递给“if”绑定注释表达式

> ID：14573653
> 
> 赞同：0
> 
> 时间：2013-01-29T00:19:38.567
> 
> 标签：knockout.js

我在我的视图模型上定义了以下函数，用于检查数组中的项目是否是图像以及它是否是数组中的第一项：

```
 self.isCoverImage = function(item) {
        return item.isImage && media.indexOf(item) === 0;
    }; 
```

`if`是否可以使用注释表达式中的绑定在我的项目模板中绑定到 this ？我尝试了以下但没有传递给`isCoverImage`函数。

```
<!-- ko if: $parent.isCoverImage($data) -->
        <i class="img-ribbon-cover-image"></i>
<!-- /ko --> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:08:56.430

我认为这一定是您的外部 foreach 循环或其他任何问题......或者您可能需要添加“self.media”而不仅仅是“media”。

我做了一个 JS 小提琴，它似乎按预期工作：http: [//jsfiddle.net/RYXdA/](http://jsfiddle.net/RYXdA/)

这是HTML：

```
<div data-bind="foreach: media">
    <div>
        <span data-bind="text: id"></span>
        <!-- ko if: $parent.isCoverImage($data) -->
            <i class="img-ribbon-cover-image">Image</i>
        <!-- /ko -->
    </div>
</div> 
```

和 Javascript：

```
var viewModel = {
    media: [
        { id: 1, isImage: true},
        { id: 2, isImage: false },
        { id: 3, isImage: true }
    ]
};    

viewModel.isCoverImage = function(item) {
    return item.isImage && viewModel.media.indexOf(item) === 0;
};

ko.applyBindings(viewModel); 
```

# spring - 登录成功后 Spring Security 重定向到上一页

> ID：14573654
> 
> 赞同：65
> 
> 时间：2013-01-29T00:19:48.960
> 
> 标签：spring, redirect, login, spring-security

我知道以前有人问过这个问题，但是我在这里遇到了一个特殊问题。

我使用弹簧安全 3.1.3。

我的 Web 应用程序中有 3 个可能的登录案例：

1.  通过登录页面登录：好的。
2.  通过受限页面登录：也可以。
3.  通过非限制页面登录：不行……每个人都可以访问“产品”页面，如果用户已登录，则可以发表评论。因此，登录表单包含在同一页面中，以允许用户连接。

案例 3) 的问题是我无法将用户重定向到“产品”页面。无论如何，他们在成功登录后都会被重定向到主页。

请注意，在案例 2) 中，成功登录后重定向到受限页面的功能开箱即用。

这是我的 security.xml 文件的相关部分：

```
<!-- Authentication policy for the restricted page  -->
<http use-expressions="true" auto-config="true" pattern="/restrictedPage/**">
    <form-login login-page="/login/restrictedLogin" authentication-failure-handler-ref="authenticationFailureHandler" />
    <intercept-url pattern="/**" access="isAuthenticated()" />
</http>

<!-- Authentication policy for every page -->
<http use-expressions="true" auto-config="true">
    <form-login login-page="/login" authentication-failure-handler-ref="authenticationFailureHandler" />
    <logout logout-url="/logout" logout-success-url="/" />
</http> 
```

我怀疑“每个页面的身份验证策略”是造成问题的原因。但是，如果我删除它，我将无法再登录... j_spring_security_check 发送 404 错误。

* * *

编辑：

感谢 Ralph，我能够找到解决方案。所以事情是这样的：我使用了这个属性

```
<property name="useReferer" value="true"/> 
```

拉尔夫给我看的。在那之后，我的案例 1) 出现了问题：通过登录页面登录时，用户停留在同一页面中（并且没有像以前那样重定向到主页）。直到这个阶段的代码如下：

```
<!-- Authentication policy for login page -->
<http use-expressions="true" auto-config="true" pattern="/login/**">
    <form-login login-page="/login" authentication-success-handler-ref="authenticationSuccessHandlerWithoutReferer" />
</http>

<!-- Authentication policy for every page -->
<http use-expressions="true" auto-config="true">
    <form-login login-page="/login" authentication-failure-handler-ref="authenticationFailureHandler" />
    <logout logout-url="/logout" logout-success-url="/" authentication-success-handler-ref="authenticationSuccessHandler"/>
</http>

<beans:bean id="authenticationSuccessHandler" class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler">
    <!-- After login, return to the last visited page -->
    <beans:property name="useReferer" value="true" />
</beans:bean>

<beans:bean id="authenticationSuccessHandlerWithoutReferer" class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler">
    <!-- After login, stay to the same page -->
    <beans:property name="useReferer" value="false" />
</beans:bean> 
```

至少在理论上，这应该有效，但事实并非如此。我仍然不知道为什么，所以如果有人对此有答案，我很乐意创建一个新主题来分配他分享他的解决方案。

与此同时，我找到了一个解决方法。不是最好的解决方案，但就像我说的，如果有人有更好的东西要展示，我会全神贯注。所以这是登录页面的新身份验证策略：

```
<http use-expressions="true" auto-config="true" pattern="/login/**" >
    <intercept-url pattern="/**" access="isAnonymous()" />
    <access-denied-handler error-page="/"/>
</http> 
```

这里的解决方案很明显：登录页面只允许匿名用户使用。连接用户后，错误处理程序会将他重定向到主页。

我做了一些测试，一切似乎都运行良好。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-29T06:51:46.173

登录后发生的事情（用户被重定向到哪个 url）由`AuthenticationSuccessHandler`.

该接口（实现它的具体类）由方法中的 ()或其子类之一`SavedRequestAwareAuthenticationSuccessHandler`调用。`AbstractAuthenticationProcessingFilter``UsernamePasswordAuthenticationFilter``successfulAuthentication`

因此，为了在案例 3 中进行其他重定向，您必须进行子类化`SavedRequestAwareAuthenticationSuccessHandler`并使其执行您想要的操作。

* * *

有时（取决于您的确切用例）启用由（超类）调用的`useReferer`标志就足够了。`AbstractAuthenticationTargetUrlRequestHandler``SimpleUrlAuthenticationSuccessHandler``SavedRequestAwareAuthenticationSuccessHandler`

```
<bean id="authenticationFilter"
      class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
    <property name="filterProcessesUrl" value="/login/j_spring_security_check" />
    <property name="authenticationManager" ref="authenticationManager" />
    <property name="authenticationSuccessHandler">
        <bean class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler">
            <property name="useReferer" value="true"/>
        </bean>
    </property>
    <property name="authenticationFailureHandler">
        <bean class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler">
            <property name="defaultFailureUrl" value="/login?login_error=t" />
        </bean>
    </property>
</bean> 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2014-05-22T01:24:10.753

我想扩展**Olcay**的好答案。他的方法很好，您的登录页面控制器应该是这样的，以将引荐来源网址放入会话中：

```
@RequestMapping(value = "/login", method = RequestMethod.GET)
public String loginPage(HttpServletRequest request, Model model) {
    String referrer = request.getHeader("Referer");
    request.getSession().setAttribute("url_prior_login", referrer);
    // some other stuff
    return "login";
} 
```

你应该扩展`SavedRequestAwareAuthenticationSuccessHandler`和覆盖它的`onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication)`方法。像这样的东西：

```
public class MyCustomLoginSuccessHandler extends SavedRequestAwareAuthenticationSuccessHandler {
    public MyCustomLoginSuccessHandler(String defaultTargetUrl) {
        setDefaultTargetUrl(defaultTargetUrl);
    }

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws ServletException, IOException {
        HttpSession session = request.getSession();
        if (session != null) {
            String redirectUrl = (String) session.getAttribute("url_prior_login");
            if (redirectUrl != null) {
                // we do not forget to clean this attribute from session
                session.removeAttribute("url_prior_login");
                // then we redirect
                getRedirectStrategy().sendRedirect(request, response, redirectUrl);
            } else {
                super.onAuthenticationSuccess(request, response, authentication);
            }
        } else {
            super.onAuthenticationSuccess(request, response, authentication);
        }
    }
} 
```

然后，在你的 spring 配置中，你应该将这个自定义类定义为一个 bean，并在你的安全配置中使用它。如果你使用**注解配置**，它应该看起来像这样（你扩展的类`WebSecurityConfigurerAdapter`）：

```
@Bean
public AuthenticationSuccessHandler successHandler() {
    return new MyCustomLoginSuccessHandler("/yourdefaultsuccessurl");
} 
```

在`configure`方法：

```
@Override
protected void configure(HttpSecurity http) throws Exception {
    http
            // bla bla
            .formLogin()
                .loginPage("/login")
                .usernameParameter("username")
                .passwordParameter("password")
                .successHandler(successHandler())
                .permitAll()
            // etc etc
    ;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-07-03T12:47:18.143

我有以下解决方案，它对我有用。

每当请求登录页面时，将引用值写入会话：

```
@RequestMapping(value="/login", method = RequestMethod.GET)
public String login(ModelMap model,HttpServletRequest request) {

    String referrer = request.getHeader("Referer");
    if(referrer!=null){
        request.getSession().setAttribute("url_prior_login", referrer);
    }
    return "user/login";
} 
```

然后，成功登录后自定义实现`SavedRequestAwareAuthenticationSuccessHandler`会将用户重定向到上一页：

```
HttpSession session = request.getSession(false);
if (session != null) {
    url = (String) request.getSession().getAttribute("url_prior_login");
} 
```

重定向用户：

```
if (url != null) {
    response.sendRedirect(url);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-06-03T20:50:51.010

我已经自定义 OAuth2 授权，并且`request.getHeader("Referer")`在决定时不可用。但安全请求已保存在`ExceptionTranslationFilter.sendStartAuthentication`：

```
protected void sendStartAuthentication(HttpServletRequest request,...
    ...
    requestCache.saveRequest(request, response); 
```

所以，我们需要的只是`requestCache`作为 Spring bean 共享：

```
@Bean
public RequestCache requestCache() {
   return new HttpSessionRequestCache();
}

@Override
protected void configure(HttpSecurity http) throws Exception {
   http.authorizeRequests()
   ... 
   .requestCache().requestCache(requestCache()).and()
   ...
} 
```

并在授权完成后使用它：

```
@Autowired
private RequestCache requestCache;

public void authenticate(HttpServletRequest req, HttpServletResponse resp){
    ....
    SavedRequest savedRequest = requestCache.getRequest(req, resp);
    resp.sendRedirect(savedRequest != null && "GET".equals(savedRequest.getMethod()) ?  
    savedRequest.getRedirectUrl() : "defaultURL");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-23T01:45:58.160

以下通用解决方案可与常规登录、Spring Social 登录或大多数其他 Spring Security 过滤器一起使用。

在您的 Spring MVC 控制器中，当加载产品页面时，如果用户尚未登录，则在会话中保存产品页面的路径。在 XML 配置中，设置默认目标 url。例如：

在您的 Spring MVC 控制器中，重定向方法应该从会话中读取路径并返回`redirect:<my_saved_product_path>`。

因此，在用户登录后，他们将被发送到`/redirect`页面，该页面会立即将他们重定向回他们上次访问的产品页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-07T12:03:43.497

成功登录后返回上一页，我们可以使用如下自定义认证管理器，如下：

```
<!-- enable use-expressions -->
    <http auto-config="true" use-expressions="true">
        <!-- src** matches: src/bar.c src/baz.c src/test/bartest.c-->
        <intercept-url pattern="/problemSolution/home/**" access="hasRole('ROLE_ADMIN')"/>
        <intercept-url pattern="favicon.ico" access="permitAll"/>
        <form-login
                authentication-success-handler-ref="authenticationSuccessHandler"
                always-use-default-target="true"
                login-processing-url="/checkUser"
                login-page="/problemSolution/index"

                default-target-url="/problemSolution/home"
                authentication-failure-url="/problemSolution/index?error"
                username-parameter="username"
                password-parameter="password"/>
        <logout logout-url="/problemSolution/logout"
                logout-success-url="/problemSolution/index?logout"/>
        <!-- enable csrf protection -->
        <csrf/>
    </http>

    <beans:bean id="authenticationSuccessHandler"
            class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler">
        <beans:property name="defaultTargetUrl" value="/problemSolution/home"/>
    </beans:bean>

    <!-- Select users and user_roles from database -->
    <authentication-manager>
        <authentication-provider user-service-ref="customUserDetailsService">
            <password-encoder hash="plaintext">
            </password-encoder>
        </authentication-provider>
    </authentication-manager> 
```

CustomUserDetailsS​​ervice 类

```
@Service
public class CustomUserDetailsService implements UserDetailsService {

        @Autowired
        private UserService userService;

        public UserDetails loadUserByUsername(String userName)
                        throws UsernameNotFoundException {
                com.codesenior.telif.local.model.User domainUser = userService.getUser(userName);

                boolean enabled = true;
                boolean accountNonExpired = true;
                boolean credentialsNonExpired = true;
                boolean accountNonLocked = true;

                return new User(
                                domainUser.getUsername(),
                                domainUser.getPassword(),
                                enabled,
                                accountNonExpired,
                                credentialsNonExpired,
                                accountNonLocked,
                                getAuthorities(domainUser.getUserRoleList())
                );
        }

        public Collection<? extends GrantedAuthority> getAuthorities(List<UserRole> userRoleList) {
                return getGrantedAuthorities(getRoles(userRoleList));
        }

        public List<String> getRoles(List<UserRole> userRoleList) {

                List<String> roles = new ArrayList<String>();

                for(UserRole userRole:userRoleList){
                        roles.add(userRole.getRole());
                }
                return roles;
        }

        public static List<GrantedAuthority> getGrantedAuthorities(List<String> roles) {
                List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();

                for (String role : roles) {
                        authorities.add(new SimpleGrantedAuthority(role));
                }
                return authorities;
        }

} 
```

用户类

```
import com.codesenior.telif.local.model.UserRole;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.authority.SimpleGrantedAuthority;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

@Service
public class CustomUserDetailsService implements UserDetailsService {

        @Autowired
        private UserService userService;

        public UserDetails loadUserByUsername(String userName)
                        throws UsernameNotFoundException {
                com.codesenior.telif.local.model.User domainUser = userService.getUser(userName);

                boolean enabled = true;
                boolean accountNonExpired = true;
                boolean credentialsNonExpired = true;
                boolean accountNonLocked = true;

                return new User(
                                domainUser.getUsername(),
                                domainUser.getPassword(),
                                enabled,
                                accountNonExpired,
                                credentialsNonExpired,
                                accountNonLocked,
                                getAuthorities(domainUser.getUserRoleList())
                );
        }

        public Collection<? extends GrantedAuthority> getAuthorities(List<UserRole> userRoleList) {
                return getGrantedAuthorities(getRoles(userRoleList));
        }

        public List<String> getRoles(List<UserRole> userRoleList) {

                List<String> roles = new ArrayList<String>();

                for(UserRole userRole:userRoleList){
                        roles.add(userRole.getRole());
                }
                return roles;
        }

        public static List<GrantedAuthority> getGrantedAuthorities(List<String> roles) {
                List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();

                for (String role : roles) {
                        authorities.add(new SimpleGrantedAuthority(role));
                }
                return authorities;
        }

} 
```

用户角色类

```
@Entity
public class UserRole {
        @Id
        @GeneratedValue
        private Integer userRoleId;

        private String role;

        @ManyToMany(fetch = FetchType.LAZY, mappedBy = "userRoleList")
        @JsonIgnore
        private List<User> userList;

        public Integer getUserRoleId() {
                return userRoleId;
        }

        public void setUserRoleId(Integer userRoleId) {
                this.userRoleId= userRoleId;
        }

        public String getRole() {
                return role;
        }

        public void setRole(String role) {
                this.role= role;
        }

        @Override
        public String toString() {
                return String.valueOf(userRoleId);
        }

        public List<User> getUserList() {
                return userList;
        }

        public void setUserList(List<User> userList) {
                this.userList= userList;
        }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-27T12:01:36.937

无论用户角色是什么，为了重定向到特定页面，只需在 Spring 的配置文件中使用 defaultSucessUrl 即可。

```
@Override
protected void configure(HttpSecurity http) throws Exception {

      http.authorizeRequests() 
      .antMatchers("/admin").hasRole("ADMIN") 
      .and()
      .formLogin() .loginPage("/login") 
                    .defaultSuccessUrl("/admin",true)
      .loginProcessingUrl("/authenticateTheUser")
      .permitAll(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-09-27T09:42:26.423

我发现[Utku Özdemir 的解决方案](https://stackoverflow.com/a/23796392/6448518)在某种程度上有效，但有点违背了保存请求的目的，因为会话属性将优先于它。这意味着重定向到安全页面将无法按预期工作 - 登录后，您将被发送到您所在的页面而不是重定向目标。因此，作为替代方案，您可以使用 SavedRequestAwareAuthenticationSuccessHandler 的修改版本，而不是对其进行扩展。这将使您能够更好地控制何时使用会话属性。

这是一个例子：

```
private static class MyCustomLoginSuccessHandler extends SimpleUrlAuthenticationSuccessHandler {

    private RequestCache requestCache = new HttpSessionRequestCache();

    @Override
    public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,
            Authentication authentication) throws ServletException, IOException {
        SavedRequest savedRequest = requestCache.getRequest(request, response);

        if (savedRequest == null) {
            HttpSession session = request.getSession();
            if (session != null) {
                String redirectUrl = (String) session.getAttribute("url_prior_login");
                if (redirectUrl != null) {
                    session.removeAttribute("url_prior_login");
                    getRedirectStrategy().sendRedirect(request, response, redirectUrl);
                } else {
                    super.onAuthenticationSuccess(request, response, authentication);
                }
            } else {
                super.onAuthenticationSuccess(request, response, authentication);
            }

            return;
        }

        String targetUrlParameter = getTargetUrlParameter();
        if (isAlwaysUseDefaultTargetUrl()
                || (targetUrlParameter != null && StringUtils.hasText(request.getParameter(targetUrlParameter)))) {
            requestCache.removeRequest(request, response);
            super.onAuthenticationSuccess(request, response, authentication);

            return;
        }

        clearAuthenticationAttributes(request);

        // Use the DefaultSavedRequest URL
        String targetUrl = savedRequest.getRedirectUrl();
        logger.debug("Redirecting to DefaultSavedRequest Url: " + targetUrl);
        getRedirectStrategy().sendRedirect(request, response, targetUrl);
    }
} 
```

此外，您不希望在身份验证失败时保存引荐来源网址，因为引荐来源网址将成为登录页面本身。因此，请手动检查错误参数或提供单独的 RequestMapping，如下所示。

```
@RequestMapping(value = "/login", params = "error")
public String loginError() {
    // Don't save referrer here!
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-14T16:38:48.800

您可以使用自定义 SuccessHandler 扩展 SimpleUrlAuthenticationSuccessHandler，以便在登录时根据用户分配的角色将用户重定向到不同的 URL。

CustomSuccessHandler 类提供自定义重定向功能：

```
package com.mycompany.uomrmsweb.configuration;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.springframework.security.core.Authentication;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.web.DefaultRedirectStrategy;
import org.springframework.security.web.RedirectStrategy;
import org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler;
import org.springframework.stereotype.Component;

@Component
public class CustomSuccessHandler extends SimpleUrlAuthenticationSuccessHandler{

    private RedirectStrategy redirectStrategy = new DefaultRedirectStrategy();

    @Override
    protected void handle(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException {
        String targetUrl = determineTargetUrl(authentication);

        if (response.isCommitted()) {
            System.out.println("Can't redirect");
            return;
        }

        redirectStrategy.sendRedirect(request, response, targetUrl);
    }

    protected String determineTargetUrl(Authentication authentication) {
        String url="";

        Collection<? extends GrantedAuthority> authorities =  authentication.getAuthorities();

        List<String> roles = new ArrayList<String>();

        for (GrantedAuthority a : authorities) {
            roles.add(a.getAuthority());
        }

        if (isStaff(roles)) {
            url = "/staff";
        } else if (isAdmin(roles)) {
            url = "/admin";
        } else if (isStudent(roles)) {
            url = "/student";
        }else if (isUser(roles)) {
            url = "/home";
        } else {
            url="/Access_Denied";
        }

        return url;
    }

    public void setRedirectStrategy(RedirectStrategy redirectStrategy) {
        this.redirectStrategy = redirectStrategy;
    }
    protected RedirectStrategy getRedirectStrategy() {
        return redirectStrategy;
    }

    private boolean isUser(List<String> roles) {
        if (roles.contains("ROLE_USER")) {
            return true;
        }
        return false;
    }

    private boolean isStudent(List<String> roles) {
        if (roles.contains("ROLE_Student")) {
            return true;
        }
        return false;
    }

    private boolean isAdmin(List<String> roles) {
        if (roles.contains("ROLE_SystemAdmin") || roles.contains("ROLE_ExaminationsStaff")) {
            return true;
        }
        return false;
    }

    private boolean isStaff(List<String> roles) {
        if (roles.contains("ROLE_AcademicStaff") || roles.contains("ROLE_UniversityAdmin")) {
            return true;
        }
        return false;
    }
} 
```

扩展 Spring SimpleUrlAuthenticationSuccessHandler 类和覆盖 handle() 方法，该方法简单地使用配置的 RedirectStrategy [在这种情况下为默认值] 调用重定向，URL 由用户定义的 determineTargetUrl() 方法返回。此方法从 Authentication 对象中提取当前登录用户的角色，然后根据角色构造适当的 URL。最后 RedirectStrategy ，负责 Spring Security 框架内的所有重定向，将请求重定向到指定的 URL。

使用 SecurityConfiguration 类注册 CustomSuccessHandler：

```
package com.mycompany.uomrmsweb.configuration;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.core.userdetails.UserDetailsService;

@Configuration
@EnableWebSecurity
public class SecurityConfiguration extends WebSecurityConfigurerAdapter {

    @Autowired
    @Qualifier("customUserDetailsService")
    UserDetailsService userDetailsService;

    @Autowired
    CustomSuccessHandler customSuccessHandler;

    @Autowired
    public void configureGlobalSecurity(AuthenticationManagerBuilder auth) throws Exception {
            auth.userDetailsService(userDetailsService);
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.authorizeRequests()
        .antMatchers("/", "/home").access("hasRole('USER')")
        .antMatchers("/admin/**").access("hasRole('SystemAdmin') or hasRole('ExaminationsStaff')")
        .antMatchers("/staff/**").access("hasRole('AcademicStaff') or hasRole('UniversityAdmin')")
        .antMatchers("/student/**").access("hasRole('Student')")  
                    .and().formLogin().loginPage("/login").successHandler(customSuccessHandler)
        .usernameParameter("username").passwordParameter("password")
        .and().csrf()
        .and().exceptionHandling().accessDeniedPage("/Access_Denied");
    }
} 
```

successHandler 是负责基于任何自定义逻辑的最终重定向的类，在这种情况下，它将根据用户的角色 [USER/Student/SystemAdmin/UniversityAdmin/ExaminationsStaff/AcademicStaff] 将用户 [to student/admin/staff] 重定向。

# python - 传递列表时出现类型错误（Python）

> ID：14573655
> 
> 赞同：2
> 
> 时间：2013-01-29T00:19:49.537
> 
> 标签：python, list, list-comprehension

代码：

```
import itertools
import string
import hashlib

def hash_f(x):
    h = hashlib.md5(x)
    return int(h.hexdigest(),base=16)

value = raw_input("Enter a value: ")
oneChar = [map(''.join, itertools.product(string.ascii_lowercase, repeat=1))]
twoChar = [map(''.join, itertools.product(string.ascii_lowercase, repeat=2))]
threeChar = [map(''.join, itertools.product(string.ascii_lowercase, repeat=3))]
possibleValues = oneChar + twoChar + threeChar

hashed_list = [int(hashlib.md5(x).hexdigest(), base=16) for x in possibleValues]

for x in hashed_list:
    if hash_f(value) == x:
        print "MATCH" 
```

我尝试运行此代码时遇到的错误如下：

```
Traceback (most recent call last):
    File "hash.py", line 18, in <module>
        hashed_list = [int(hashlib.md5(x).hexdigest(), base=16) for x in possibleValues]
TypeError: must be string or buffer, not list 
```

在我的脑海中经历了这个，我能看到的唯一问题是 hashlib 的错误，但不应该因为我在可能的值中循环遍历每个单独的值而被否定吗？

非常感谢所有帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:23:22.433

map 的输出已经是一个列表，您是不是要使用：

```
oneChar = map(''.join, itertools.product(string.ascii_lowercase, repeat=1))
twoChar = map(''.join, itertools.product(string.ascii_lowercase, repeat=2))
threeChar = map(''.join, itertools.product(string.ascii_lowercase, repeat=3)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:24:40.800

possibleValues 是列表的列表。删除`[]`周围的地图调用以获得一个字符串列表：

```
oneChar = map(''.join, itertools.product(string.ascii_lowercase, repeat=1))
twoChar = map(''.join, itertools.product(string.ascii_lowercase, repeat=2))
threeChar = map(''.join, itertools.product(string.ascii_lowercase, repeat=3)) 
```

# git - 运行“git-mergetool”后发出的正确“git-add”命令是什么？

> ID：14573656
> 
> 赞同：2
> 
> 时间：2013-01-29T00:19:52.703
> 
> 标签：git, git-merge, git-add

我不清楚完成导致冲突的合并所需的 Git 命令的正确顺序。我知道一种方法是遵循被拒绝的合并，例如

```
git mergetool
# Then once everything has been fixed
git add ??
git commit -m "Some message" 
```

但我不清楚该`git-add`命令究竟应该包含什么，以确保只有我最初为被拒绝的合并暂存的文件最终被提交，并且只有那些文件被提交。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T06:04:04.020

`git-mergetool`通常会在冲突解决后自动暂存文件。您将不需要手动运行`git-add`.

但是，为了使用各种工具，将尝试通过检查修改日期`git-mergetool`来验证文件是否已更新（请参阅[check_unchanged() ）。](https://github.com/git/git/blob/master/git-mergetool--lib.sh)如果文件已被修改，则它将检查来自合并工具的返回码。

一些合并工具可能不会返回正确的退出代码（如果合并“成功”，则返回 0），因此 git 还提供了一个配置选项`mergetool.<tool>.trustExitCode`以防不可信。如果设置为`false`，则 git 将始终询问您合并是否成功。

总之：

1.  即使不需要更改，您的合并工具也应在合并后将文件保存到磁盘（这是不可能的，因为它不会是合并冲突）。
2.  如果您不信任合并工具的退出代码，可以将该`trustExitCode`选项设置为 false。

在实践中，我建议使用 git 现在本机支持的合并实用程序之一。您可以[在此处](https://github.com/git/git/tree/master/mergetools)获取这些列表。如果您使用这些工具之一，除了配置 git 来使用它之外，您不需要任何其他设置，例如：

```
git config --global merge.tool p4merge 
```

**注意：**您可能会在网络上找到很多关于设置这些工具的过时文章。例如，我最喜欢的[合并工具 p4merge](http://www.perforce.com/product/components/perforce_visual_merge_and_diff_tools)最初并不受 git 原生支持，需要进行一些手动配置。对于最新版本的 git，这不再是必需的。

# php - 带有额外过滤器的 Foreach 循环 -> 需要识别最后一个条目

> ID：14573659
> 
> 赞同：1
> 
> 时间：2013-01-29T00:20:16.713
> 
> 标签：php, foreach

我正在尝试获取 foreach 循环中的最后一个条目，但到目前为止一直在挣扎。我最大的问题是，一旦进入 foreach 循环，我需要通过消除每个拥有 0 个帖子的作者来过滤数组。到目前为止，这是我的代码：

```
$authors = get_users('orderby=nicename');

foreach ($authors as $author ) {
      if ( count_user_posts( $author->id ) >= 1 ) { IF LAST {special <li>} else {normal <li> } 
```

谁能阐明如何在这种情况下获得最后一个条目？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:26:31.630

您应该编写一个函数来过滤数组，然后您可以像这样弹出最后一项：

```
// use this section of code in PHP >= 5.3 - utilizes anonymous function
$filtered_array = array_filter($authors, function($author) {
    if(count_user_posts($author->id) >= 1) return true;
    return false;
});

// use this section of code for older versions of PHP - uses regular function
function author_filter($author) {
    if(count_user_posts($author->id) >= 1) return true;
    return false;
}
$filtered_array = array_filter($authors, 'author_filter');

// the rest is the same regardless of PHP version
$last_author = array_pop($filtered_array);

// output
foreach($filtered_array as $author) {
    // regular output
}
// then do special output for $last_author 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:07:31.423

```
<?php
$numItems = count($arr);
echo "<ul>";
for($i = 0; $i < $numItems; $i++) {
    if(as_zero_post){
        //$i++;
        continue;       
    }
    $i == $numItems-1 ? "<li class='last-item'>".$arr[$i]."</li>" : "<li class='normal-item'>".$arr[$i]."</li>";

} 
echo "</ul>"

?> 
```

# ruby-on-rails - 显示 Bootstrap 模式时 Rails 加载数据

> ID：14573671
> 
> 赞同：0
> 
> 时间：2013-01-29T00:21:24.533
> 
> 标签：ruby-on-rails, twitter-bootstrap

我正在使用 Bootstrap 模式。现在，模式中列出的表格会在整个 html 页面加载时加载。我想在模式启动时加载表格的数据。

模态启动时如何加载模态中的数据？

这是我的模式的第一部分 - 它包含几个 Bootstrap 选项卡。

```
 <div class="modal-body">
                  <div class="tabbable">
                    <ul class="nav-tabs">
                      <li class="active"><a href="#tab1_<%= workorder.id %>" data-toggle="tab">Details</a></li>
                      <li><a href="#tab2_<%= workorder.id %>" data-toggle="tab">Materials</a></li>
                      <li><a href="#tab3_<%= workorder.id %>" data-toggle="tab">Labor</a></li>
                      <li><a href="#tab4_<%= workorder.id %>" data-toggle="tab">Tasks</a></li>
                    </ul>
                    <div class="tab-content">
                      <div class="tab-pane active" id="tab1_<%= workorder.id %>">
                        <table border="1" cellpadding="5">
                          <tr>
                            <th>Description</th>
                            <td><%= workorder.description %></td>
                          </tr>
                          <tr>
                            <th>Client</th>
                            <td><%= workorder.client.client_name %></td>
                          </tr>
                          <tr>
                            <th>Type</th>
                            <td><%= workorder.type.typecode %></td>
                          </tr>
                          <tr>
                            <th>Priority</th>
                            <td><%= workorder.wopriority.prioritycode %></td>
                          </tr>
                          <tr>
                            <th>Scheduled Finish</th>
                            <% if workorder.scheduled_finish != nil %>
                                <td>Scheduled Finish = <%= workorder.scheduled_finish %></td>
                                <% else %>
                                 <td></td>
                            <% end %>
                          </tr>
                        </table>
                      </div>
... 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:49:15.860

你有两个选择：

1.  当您的 mondal 启动时，使用 AJAX 填充表格
2.  Mondal 与 iframe

如果您只是简单地显示信息，那么 iframe 是一种快速而肮脏的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T04:17:48.787

使用 Ajax（使用 remote => true 将链接设置为 link_to）并呈现部分内容。然后将 tab-pane 的 innerHTML 设置为通过 Ajax 返回的部分内容。当然，您需要在控制器中添加逻辑以仅解析每个选项卡的数据。

可能有助于阅读： http:
[//guides.rubyonrails.org/ajax_on_rails.html](http://guides.rubyonrails.org/ajax_on_rails.html)

# sql - 查找达到某个总和所需的行数

> ID：14573672
> 
> 赞同：0
> 
> 时间：2013-01-29T00:21:31.763
> 
> 标签：sql, sql-server, tsql

我想找到我需要的排序表列的行数，以便它们的总和达到一定的大小。这是我对代码的（非常低效的）尝试：

```
DECLARE @CURNUM AS INT
DECLARE @CURSUM AS MONEY
SET @CURSUM=0.0
SET @CURNUM=1
WHILE @CURSUM<100000
BEGIN
     SET @CURNUM=@CURNUM+1
     SELECT @CURSUM = SUM(val1) FROM 
     (SELECT top (@CURNUM) val1 from table order by val1) a
END
print @CURNUM 
```

有没有人有更快实施的建议？我不知道如何选择表格的第 i 行，但如果我这样做会更有效率，这是我下一个尝试的方法。

一个不幸的限制：由于缺乏数据库特权，我无法创建过程或函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:24:55.613

假设您使用的是 2012 之前的版本：

```
select count(*)
from (select t.*,
             (select sum(val1) from table t2 where t2.val1 <= t.val1) as cumesum
      from table t
     ) t
where cumesum <= 100000 
```

这使用相关子查询计算累积和。然后它只计算小于或等于阈值的数字。

在 SQL Server 2012 中，表达式为`cumesum`：

```
sum(val1) over (order by val1) as cumesum 
```

# php - CakePHP 和屏蔽电子邮件发件人

> ID：14573675
> 
> 赞同：0
> 
> 时间：2013-01-29T00:21:46.693
> 
> 标签：php, email, cakephp

我目前正在使用一个名为 send 的函数：

```
 public function send(){

     if ( !empty($this->request->data) ) {
    $email = new CakeEmail('default');
    $email->from(array($this->Auth->user('email') => $this->Auth->user('username')))
    ->to(array('helpdesk@example.com'))
    ->subject($this->request->data['Ticket']['subject'])
    ->send(array($this->request->data['Ticket']['issue']));

    $this->Session->setFlash('Email Sent Successfully', 'default', array('class' => 'message update span9'));
    $this->redirect(array('action' => 'index'));

    } 
```

向我们的服务台发送电子邮件并将其存入他们的数据库。一切正常，除了 FROM 始终显示配置选项中的用户名/电子邮件地址。它不是用用户电子邮件掩盖电子邮件。我需要这样做，以便我们知道谁遇到了支持问题。

有没有人有关于做什么的建议？

*添加

这是一个 Intranet 应用程序，因此我们有一个使用 smtp 设置的经过身份验证的 GENERIC USER。这不是垃圾邮件，我们只是想知道在插入数据库时​​帮助台票来自哪个用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:10:22.003

为什么你仍然使用配置`default`？

如果您使用`$email = new CakeEmail();`，发送的电子邮件是否引用 Authenticated User 电子邮件信息。

此外，您应该始终使用`$email->sender('support@yourcompany.com', 'Your Company Support');`. 这样可以确保如果出现问题，问题会被重定向到您而不是用户，您的应用会代表他/她发送电子邮件。

我在我的帐户中有这个设置，它工作得很好。在马克看来，这可能不合法（尽管这似乎不是你的问题），但我知道这是可能的，因为我目前有一个系统设置，可以处理我想要的任何电子邮件。我不使用任何配置，也不使用任何 SMTP

# python - Python - 如何检查文件中的名称是否被使用？

> ID：14573679
> 
> 赞同：0
> 
> 时间：2013-01-29T00:22:22.970
> 
> 标签：python, python-2.7, web-scraping

我有小的抓取脚本。我有 2000 个名称的文件，我使用这些名称在 YouTube 中搜索视频 ID。由于获取所有ID需要很长时间，所以我不能一次完成。我想要的是找到我最后一次刮擦的位置，然后从那个位置开始。做这个的最好方式是什么？我正在考虑将使用过的名称添加到列表中，然后检查它是否在列表中，如果没有 - 开始抓取，但也许有更好的方法来做到这一点？（我希望是的）。

从文件和抓取的 ID 中获取名称的部分。我想要的是当我退出抓取时，下次我启动它时，它不会从头开始运行，而是从上次结束的地方开始运行：

```
index = 0
for name in itertools.islice(f, index, None):
    parameters = {'key': api_key, 'q': name}
    request_url = requests.get('https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=1&type=video&fields=items%2Fid', params = parameters)
    videoid = json.loads(request_url.text)
    if 'error' in videoid:
        pass
    else:
        index += 1
        id_file.write(videoid['items'][0]['id']['videoId'] + '\n')
        print videoid['items'][0]['id']['videoId'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:28:52.380

您可以只记住最后一次抓取的条目的索引号。每次你完成一个条目的抓取，增加一个计数器，然后假设你的文本文件中的条目没有改变顺序，只是再次拿起那个数字？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:33:21.690

这里最简单的答案可能是mitim的答案。只需在每行之后保留一个使用最后处理的索引重写的文件。例如：

```
savepath = os.path.expanduser('~/.myprogram.lines') 
skiplines = 0
try:
    with open(savepath) as f:
        skiplines = int(f.read())
except:
    pass
with open('names.txt') as f:
    for linenumber, line in itertools.islice(enumerate(f), skiplines, None):
        do_stuff(line)
        with open(savepath, 'w') as f:
            f.write(str(linenumber)) 
```

但是，还有其他方法可以执行此操作，这可能对您的用例更有意义。

例如，您可以在处理每个名称后重写“名称”文件以删除第一行。或者，也许更好的是，将列表预处理到`anydbm`（甚至`sqlite3`）数据库中，这样您就可以在完成后更轻松地删除（或标记）名称。

或者，如果您可能针对不同的文件运行，并且需要为每个文件保留一个进度，您可以`.lines`为每个文件存储一个单独的文件（可能在一个`~/.myprogram`目录中，而不是淹没顶级主目录），或者使用`anydbm`映射完成的行的路径名。

# android - 具有唤醒锁问题的接近传感器：无法再次打开屏幕

> ID：14573682
> 
> 赞同：1
> 
> 时间：2013-01-29T00:22:55.903
> 
> 标签：android, sensors, proximity, wakelock

最近几天我一直在环顾四周，所提出的问题的答案都没有帮助我，我正在用一些可能很容易解决的东西撞到我的头......我想使用接近传感器和我正在做的是，如果我将手指放在传感器上，它会关闭屏幕，如果我将手指移开，它会重新回到屏幕上！我成功地关闭了屏幕，当我移开手指时收到“Log.i("info", "trying to turn on!")”消息，但不知何故屏幕无法打开...... .我试过wakelock（评论）和没有成功的标志！如果我移开手指，键盘上的灯会亮，但屏幕不会.. 如果我按两次电源按钮，它会成功打开屏幕！有人可以帮我吗？:(

```
@Override
public void onSensorChanged(SensorEvent event) {
        if(event.sensor.getType()==Sensor.TYPE_PROXIMITY){
    ProximityReading.setText("\nProximity Sensor Reading:" + String.valueOf(event.values[0]));
    }

        if(event.values[0] == 0) {
      WindowManager.LayoutParams params = getWindow().getAttributes();
      getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
          getWindow().addFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);
      getWindow().addFlags(WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON);
      params.screenBrightness = 0f;
      getWindow().setAttributes(params);
            } else {
          WindowManager.LayoutParams params = getWindow().getAttributes();
      params.screenBrightness = 1f;
      getWindow().setAttributes(params);

      /*powermanager = (PowerManager) getSystemService(Context.POWER_SERVICE);
        wakeLock = powermanager.newWakeLock(PowerManager.ACQUIRE_CAUSES_WAKEUP, "TAG");
      wakeLock.acquire();

      Log.i("info", "trying to turn on!");

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T02:12:07.203

如果要开屏，可以使用PowerManager中的“TurnScreenOn”等API，或者使用ACQUIRE_CAUSES_WAKEUP结合FULL_WAKE_LOCK

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-12T10:57:24.137

我使用以下方法解锁手机，将其点亮，然后重新启用键盘锁。

```
public void unlockAndPowerup(){
    KeyguardManager km = (KeyguardManager) mContext.getSystemService(Context.KEYGUARD_SERVICE);
    final KeyguardManager.KeyguardLock kl = km.newKeyguardLock("MyKeyguardLock");
    kl.disableKeyguard();

    PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE); 
    WakeLock wakeLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK
            | PowerManager.ACQUIRE_CAUSES_WAKEUP
            | PowerManager.ON_AFTER_RELEASE, "MyWakeLock");

    wakeLock.acquire();
    wakeLock.release();
    kl.reenableKeyguard();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-26T19:04:10.730

你的程序是错误的。它可能会偶然在某些设备上运行，但这不是这样做的方法。

1.  **FLAG_TURN_SCREEN_ON**应该**应用于活动的 onCreate 方法**。您需要修改您的应用程序逻辑。

2.  您的屏幕关闭技术不正确。您正在修改亮度，这是一种很老套的方式，并且可能根本不会关闭屏幕，并且会耗尽电池电量。您需要通过设备管理员权限来实现它。这是官方的做法

锁定示例代码

```
public static void lockNow(Context c) {
    DevicePolicyManager dpm = (DevicePolicyManager)c.getSystemService(Context.DEVICE_POLICY_SERVICE);
    if(dpm.isAdminActive(new ComponentName(c.getApplicationContext(),DeviceAdmin.class)))
        dpm.lockNow();
} 
```

DeviceAdmin.java

```
import android.app.admin.DeviceAdminReceiver;
public class DeviceAdmin extends DeviceAdminReceiver {
} 
```

在清单中

```
<receiver
        android:name=".admin.DeviceAdmin"
        android:permission="android.permission.BIND_DEVICE_ADMIN" >
        <meta-data
            android:name="android.app.device_admin"
            android:resource="@xml/admin" />

        <intent-filter>
            <action android:name="android.app.action.DEVICE_ADMIN_ENABLED" />
        </intent-filter>
    </receiver> 
```

并请求设备管理员权限

```
private void askAdminPerm(){
    Intent intent = new Intent(DevicePolicyManager.ACTION_ADD_DEVICE_ADMIN);
    intent.putExtra(DevicePolicyManager.EXTRA_DEVICE_ADMIN,
            new ComponentName(root.getContext(), DeviceAdmin.class));
    intent.putExtra(DevicePolicyManager.EXTRA_ADD_EXPLANATION, getString(R.string.lock_msg_big));
    startActivity(intent);
} 
```

# javascript - 如何使用数组进行搜索

> ID：14573685
> 
> 赞同：-2
> 
> 时间：2013-01-29T00:23:12.840
> 
> 标签：javascript, jquery, arrays, filter

如何使用数组 javascript 按姓名和姓氏进行搜索？每次我搜索以 je 开头的内容时，div=result 都会显示所有带有 Je 的姓名和姓氏，在这种情况下是 Jessica 和 Jey；
这将是一个 onkeydown 事件，对吧？

```
<input type='text' id='filter' placeholder='search in array'> 
```

在这里我打印结果：

```
<div id='result'></div> 
```

这是我的数组：

```
var datos = [ ['Jessica','Lyn',3],
         ['Jhon','Cin',5],
         ['Alison','Peage',1],
         ['Thor','zhov',12],
         ['Jey','hov',32]  
        ]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:25:53.840

```
$("#filter").on('keyup', function () {
   var val = $(this).val();
   $("#result").empty();
   $.each(datos, function () {
      if (this[0].indexOf(val) >= 0 || this[1].indexOf(val) >= 0) {
         $("#result").append("<div>" + this[0] + ' ' + this[1] + "</div>");
      }
   });
}); 
```

[http://jsfiddle.net/MqTBm/](http://jsfiddle.net/MqTBm/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:27:35.477

```
var $result = $('#result');

$('#filter').on('keyup', function () {
    var $fragment = $('<div />');
    var val = this.value.toLowerCase();
    $.each(datos, function (i, item) {console.log( item[0].toLowerCase().indexOf(val) );
        if ( item[0].toLowerCase().indexOf(val) == 0 ) {
            $fragment.append('<p>' + item[0] + ' ' + item[1] + '</p>');
        }
    });
    $result.html( $fragment.children() );
}); 
```

这是小提琴：http: [//jsfiddle.net/GkWGk/](http://jsfiddle.net/GkWGk/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T01:07:58.147

简单的答案是在数组上运行一个 for 循环来检查每个元素。但是，如果您有一个大数组，这不是一个好主意。有很多方法可以索引一个数组。想到我可能会构建第二个数组，它将作为一个字符串连接的字段存储为索引，然后是数组引用。因此，您可以 for 循环遍历引用对象。查找具有字符串比较的条目。获取对真实数组的索引引用。

# vb.net - 使用 vb.net 写入两个文本文件

> ID：14573689
> 
> 赞同：0
> 
> 时间：2013-01-29T00:23:27.993
> 
> 标签：vb.net

我无法将此值写入两个单独的文本文件。它只写一个。

```
Public Class frmIceCream
Dim tw As System.IO.TextWriter 
```

然后在表单加载中我有以下内容：

```
tw = New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\sundae.txt", True)
tw.WriteLine("5")

tw = New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\banana.txt", True)
tw.WriteLine("5") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:26:18.600

对于尽可能短的代码片段，您可以使用[File.WriteAllText](http://msdn.microsoft.com/en-us/library/ms143375.aspx)：

```
File.WriteAllText("C:\Users\F\Documents\Temp junk\sundae.txt", "5")
File.WriteAllText("C:\Users\F\Documents\Temp junk\banana.txt", "5") 
```

如果您想继续使用您的方法，通常最好让您的文件尽可能短地打开。我会将您的文件操作包装成`Using`块，这种方式`StreamWriter`会自动处理（并关闭）：

```
Using tw As New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\sundae.txt", True)
  tw.WriteLine("5")
End Using
Using tw As New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\banana.txt", True)
  tw.WriteLine("5")
End Using 
```

请注意，即使您在技术上使用不同的`tw`对象，您也可以保持相同的名称，如果它使代码对您更具可读性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T00:27:23.427

在关闭另一个文件之前，您不能重用该变量。打开两个文件可能更容易。尝试这个：

```
Dim tw1 as System.IO.TextWriter, tw2 as System.IO.TextWriter

tw1 = New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\sundae.txt", True) 
tw1.WriteLine("5")
tw2 = New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\banana.txt", True)
tw2.WriteLine("5") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:02:16.223

您最有可能处理的问题是第一个文本文件是空的。

写入硬盘驱动器的成本很高，因此 TextWriter 使用一个缓冲区来保存一定数量的文本，然后一次将其全部写入。尝试使用`tw.Flush()`写入缓冲区中剩余的任何内容，然后使用`tw.Close()`释放资源。

这应该有效：

```
tw = New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\sundae.txt", True)
tw.WriteLine("5")
tw.Flush()
tw.Close()

tw = New System.IO.StreamWriter("C:\Users\F\Documents\Temp junk\banana.txt", True)
tw.WriteLine("5")
tw.Flush()
tw.Close() 
```

# ios - SASlideMenu 没有标识符为 null 的 segue

> ID：14573692
> 
> 赞同：2
> 
> 时间：2013-01-29T00:23:56.153
> 
> 标签：ios, segue, saslidemenu

我正在使用[https://github.com/stefanoa/SASlideMenu](https://github.com/stefanoa/SASlideMenu)在我的应用程序中实现左滑动菜单。我已经按照教程进行操作，并按照示例项目的方式连接了所有内容。但我不断收到此错误：

** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“接收者（）没有标识符为“（null）”的segue

错误来自 SASlideMenuLeftMenuSegue

```
[leftMenu didMoveToParentViewController:rootViewController];
NSString* initiaSegueId = [rootViewController.leftMenu.slideMenuDataSource    initialSegueId];
NSLog(@"initialSegueID->%@",initiaSegueId);
[leftMenu performSegueWithIdentifier:initiaSegueId sender:leftMenu]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T19:31:35.553

我遇到了同样的问题。我通过添加解决了它：

```
-(id) initWithCoder:(NSCoder *)aDecoder{
    if (self = [super initWithCoder:aDecoder]) {
        // Assign self to the slideMenuDataSource because self will implement SASlideMenuDatSource 
        self.slideMenuDataSource = self;
        self.slideMenuDelegate = self;
    }
    return self;
} 
```

我最初忽略了这个并且正在崩溃。添加这个来分配委托和数据源来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T11:24:48.640

我想通了。碰巧我正在编辑一个故事板，而更改没有保存。发生这种情况是因为本地化导致有 2 个不同的故事板：/ 我没有意识到这一点。这就是为什么我使用该 ID 设置 segue 并不断收到该错误

# linux - /bin/sh：语法错误：文件结尾意外

> ID：14573694
> 
> 赞同：6
> 
> 时间：2013-01-29T00:24:01.373
> 
> 标签：linux, makefile

使用以下 makefile 运行时出现错误`make -f makefile2 install`（除了安装其余部分正常）：

```
all:myapp

#which compiler
CC = gcc

#Where to install
INSTDIR = /usr/local/bin

#where are include files kept
INCLUDE = .

#Options for development
CFLAGS = -g -Wall -ansi

#Options for release
# CFLAGS = -O -Wall -ansi

myapp: main.o 2.o 3.o
    $(CC) -o myapp main.o 2.o 3.o

main.o: main.c a.h
    $(CC) -I$(INCLUDE) $(CFLAGS) -c main.c

2.o: 2.c a.h b.h
    $(CC) -I$(INCLUDE) $(CFLAGS) -c 2.c

3.o: 3.c b.h c.h
    $(CC) -I$(INCLUDE) $(CFLAGS) -c 3.c         

clean:
    -rm main.o 2.o 3.o

install: myapp
    @if [ -d $(INSTDIR) ]; \
      then \
      cp myapp $(INSTDIR);\
      chmod a+x $(INSTDIR)/myapp;\
      chmod og-w $(INSTDIR)/myapp;\
      echo "Installed in $(INSTDIR)";\
    else
      echo "Sorry, $(INSTDIR) does not exist";\
    fi 
```

我收到以下错误：

```
error /bin/sh: 7: Syntax error: end of file unexpected
make: *** [install] Error 2 
```

据我了解，这是makefile最后几行中的空格/制表/非unix字符问题（安装后:)。但是，即使尝试删除所有空格并用制表符替换，我也无法正确运行 makefile。该代码直接来自我正在阅读的一本编程书，是一个示例。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-29T00:27:07.637

根据安装规则，您的 else 上缺少斜杠。它应该是：

```
install: myapp
    @if [ -d $(INSTDIR) ]; \
      then \
      cp myapp $(INSTDIR);\
      chmod a+x $(INSTDIR)/myapp;\
      chmod og-w $(INSTDIR)/myapp;\
      echo "Installed in $(INSTDIR)";\
    else\
      echo "Sorry, $(INSTDIR) does not exist";\
    fi 
```

# ruby-on-rails - Rails - 在表单提交时将两个下拉框中的值组合成一个值

> ID：14573699
> 
> 赞同：0
> 
> 时间：2013-01-29T00:24:44.183
> 
> 标签：ruby-on-rails

所有，我有两个下拉框，它们由两个不同的数据库表和一个带有单个提交按钮的表单填充。我的目标是在表单提交时连接这两个值，并将单个值写回数据库到与模型关联的表单中。

更简单地说：两个 Dropbox 允许选择 ['red','green','blue'] 和 ['dog','cat']。用户选择“red”和“cat”，提交按钮创建一个新记录“red-cat”（在 blogname 模型下）。

整个表单（new.html.erb）代码：

```
<%= select("subdomainw1", "blognamew1", Subdomainw1.order("blognamew1 ASC").collect {|p| [ p.blognamew1  ] }, {:prompt => 'Select Adjective'}) %>
<%= select("subdomainw2", "blognamew2", Subdomainw2.order("blognamew2 ASC").collect {|p| [ p.blognamew2  ] }, {:prompt => 'Select Noun'}) %>

<%= simple_form_for (@blogname) do |f| %>
 <%= f.button :submit %>
<% end %> 
```

与关联的控制器*def create*为：

```
 def create
    @blogname = Blogname.new(params[:blogname])
    respond_to do |format|
      @blogname.blogname = ?? THIS SHOULD BE A CONCATENATION OF THE VALUES FROM ABOVE SELECTS
        if @blogname.save
        format.html { redirect_to @blogname, notice: 'Blog was successfully created.' }
      else
        format.html { render action: "new" }
      end
    end
  end 
```

这里有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:46:20.763

有很多方法可以做到这一点，Rails 的方法是在你的模型中做到这一点，并让你的控制器保持苗条。

我认为您会看到完成此操作的 Rails 中最常见的方式是回调。因此，对于此示例，您可以在您的模式中设置一个 before_validation（或者如果您不希望在编辑博客时更改它，则可能是 before_create）回调，并从其他两个属性中分配您的 blogname。

```
model.rb

before_validation :generate_blogname

def generate_blogname
   self.blogname ||= "#{blognamew1}-#{blognamew2}".parameterize
end 
```

然后在你的控制器中：

```
 controller.rb

 def create
    @blogname = Blogname.new(params[:blogname])

    respond_to do |format|
       if @blogname.save
        format.html { redirect_to @blogname, notice: 'Blog was successfully created.' }
      else
        format.html { render action: "new" }
      end
    end
 end 
```

参数化方法将通过取出特殊字符使此工作适用于子域。该模型不应该被称为 blogname，它应该是一个带有 name 属性的表 blog。所以@blog = Blog.new，然后@blog.name = “两个子域值”

# html - 查找分配给元素的 CSS 样式

> ID：14573703
> 
> 赞同：2
> 
> 时间：2013-01-29T00:25:07.323
> 
> 标签：html, css, ruby, nokogiri

***获取元素的渲染样式*** （也应该能够处理内联 CSS）

我一直在学习[Nokogiri](http://nokogiri.org/)并了解如何根据 ID 或类选择节点。但是，我想选择一个节点/元素并取回分配给它的特定 CSS 样式，包括继承的样式。

CSS 样式表：

```
<head>
  <style type="text/css">
    .myfont {font-family: Times New Roman: font-size: 80% }
    .bold {font-weight: bold}
    .50_font_size { font-size:50% }
   </style>
 </head> 
```

HTML：

```
<Body>
   <div id="article1" class="myfont">
      <div id="title1" class="bold">  
          My Title Text
          <div id="author1" class="50_font_size">
             By First Name Last Name
          </div>
      </div>
        General article text. General article text. General article text.        
      </div>
   </div> 
```

在上面的示例中，我想使用...

```
require "nokogiri"
document=Nokogiri.HTML(HTML_String)

#Hoping for something like the following:
author_css = node.css_style("author1") 
puts author_css
#=>  {font-family=>"Times New Roman",
#=>   font-weight=> "bold",
#=>   font-size=> 50%} 
```

如您所见，它应该输出继承的项目，以便我获得元素的正确 CSS。获得此结果的最佳方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T04:32:31.460

你不能单独用 Nokogiri 来做到这一点。使用[CSS_Parser](https://github.com/alexdunae/css_parser)将提供缺失的部分：

```
require 'nokogiri'
require 'css_parser'
include CssParser

html = <<END_HTML
<head>
  <style type="text/css">
    .myfont {font-family: Times New Roman: font-size: 80% }
    .bold {font-weight: bold}
    .50_font_size { font-size:50% }
  </style>
</head>
<body>
  <div id="article1" class="myfont">
      <div id="title1" class="bold">  
          My Title Text
          <div id="author1" class="50_font_size">
            By First Name Last Name
          </div>
      </div>
        General article text. General article text. General article text.        
      </div>
  </div>
</body>
END_HTML

doc = Nokogiri::HTML(html)
css = doc.at('style').text

parser = CssParser::Parser.new
parser.add_block!(css)

author_div = doc.at('div#author1')
puts parser.find_by_selector('.' + author_div['class']) 
```

哪个输出：

```
font-size: 50%; 
```

要获得继承的 CSS，您需要从文档顶部开始并深入到所需的节点，确定哪些父节点的设置会影响您的目标节点。

# python - 如何在python中解析可变数量的命令行参数？

> ID：14573704
> 
> 赞同：1
> 
> 时间：2013-01-29T00:25:09.273
> 
> 标签：python, command-line-arguments

我是 python 新手，想为 python 代码处理可变数量的参数，以便可以处理这样的字符串 -

```
python abc.py -20 input1.txt input2.txt .. output.txt 
```

-20 是可选的。必须至少有一个输入文件，但可以有任意数量的输入文件，最后还有一个必要的输出文件。我查看了 argparse，我可以做固定参数或可选参数，但无法解决这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T01:03:38.340

添加`nargs='+'`可变编号参数。

```
parser.add_argument("input", nargs='+')
parser.add_argument("output")

$ ./test.py input1 input2 input3 output
Namespace(input=['input1', 'input2', 'input3'], output='output') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:39:21.750

使用 argparse。[这是来自argparse 文档](http://docs.python.org/dev/library/argparse.html)的示例：

```
import argparse

parser = argparse.ArgumentParser(description='Process some integers.')
parser.add_argument('integers', metavar='N', type=int, nargs='+',
                   help='an integer for the accumulator')
parser.add_argument('--sum', dest='accumulate', action='store_const',
                   const=sum, default=max,
                   help='sum the integers (default: find the max)')

args = parser.parse_args()
print(args.accumulate(args.integers)) 
```

跑：

```
$ prog.py 1 2 3 4
4

$ prog.py 1 2 3 4 --sum
10 
```

# javascript - 正则表达式删除文本后的空格

> ID：14573706
> 
> 赞同：0
> 
> 时间：2013-01-29T00:25:43.090
> 
> 标签：javascript, regex, replace

从这个正则表达式，

```
text.replace(/^\s+|\s+$/g,"").replace(/  +/g,' ') 
```

如何删除仅用于尾随空格的正则表达式？

我是正则表达式的新手并做了一些研究，但我无法理解这种模式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:31:14.367

`/^\s+|\s+$/g`方法

```
^    // match the beginning of the string
\s+  // match one or more whitespace characters
|    // OR if the previous expression does not match (i.e. alternation)
\s+  // match one or more whitespace characters
$    // match the end of the string 
```

修饰符表示重复匹配，`g`直到找不到匹配为止。

因此，如果要删除匹配字符串末尾的空白字符的部分，请删除该`|\s+$`部分（以及`g`标志，因为`^\s+`无论如何只能在一个位置匹配 - 在字符串的开头）。

* * *

学习正则表达式的有用资源：

*   [http://www.regular-expressions.info/](http://www.regular-expressions.info/)
*   [JavaScript 中的正则表达式](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)（因为这似乎是 JavaScript）。

# cocoa - 将 Social.framework 和 SLRequest 与字段扩展一起使用

> ID：14573711
> 
> 赞同：3
> 
> 时间：2013-01-29T00:26:08.790
> 
> 标签：cocoa, facebook-graph-api, frameworks

到目前为止，OS X 10.8.2 的**Social.Framework**运行良好：

```
NSURL *requestURL = [NSURL URLWithString:@"https://graph.facebook.com/me/friends"];
SLRequest *fbRequest = [SLRequest requestForServiceType:SLServiceTypeFacebook requestMethod:SLRequestMethodGET URL:requestURL parameters:params]; 
```

这正确地传递了`me()`对象的朋友列表。美好的！

但是，一旦我尝试使用[Field Expansion](https://developers.facebook.com/blog/post/2012/08/30/updates-to-the-graph-api/)，如下所示，请求失败并出现错误： *必须使用活动访问令牌来查询有关当前用户的信息*：

```
[NSURL URLWithString:@".../friends?fields=cover,picture"]; 
```

这肯定是因为 access_token 将使用 st 附加到 Social.framework 内部。类似于 "?access_token=%@"，它会与我之前的**?fields=**使用一起失败。

所以我想知道这实际上是框架的一个错误，还是我使用错误？我真的很感谢任何有用的信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T15:22:27.330

直接联系 Apple 后，答案显然是这样的：使用 GET 参数变量添加字段扩展标签，而不是添加到实际 URL：

```
SLRequest *fbRequest = [SLRequest requestForServiceType:SLServiceTypeFacebook
requestMethod:SLRequestMethodGET
URL:requestURL
parameters:@{@"fields":@"cover,picture"}]; 
```

这很明显，但我没有想到:)。如果将来有人可能偶然发现同样的问题，我会让这个线程保持原样！

# jdbc - 优化删除 SQL 数据库中的百万行

> ID：14573712
> 
> 赞同：-1
> 
> 时间：2013-01-29T00:26:12.917
> 
> 标签：jdbc, query-optimization

想象一下，当您有一个包含 200 万行的表并且您想要删除一百万行时。这些行没有聚集在一起。我可能想删除row1，然后是row5，然后可能是row7。但我想删除可能年龄 < 23 的行删除这些行的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:28:54.980

您将需要批量删除它们。[上一个问题](https://stackoverflow.com/questions/5925471/how-can-i-delete-expired-data-from-a-huge-table-without-having-the-log-file-grow)提供了一些有趣的答案。

# actionscript-3 - 为什么这个开关盒不起作用？

> ID：14573723
> 
> 赞同：-1
> 
> 时间：2013-01-29T00:27:23.650
> 
> 标签：actionscript-3, switch-statement

为什么这个开关盒不起作用......即使我在星期一选择按钮，它也会向我显示默认消息..

```
switch (finalsave.weekday) {
    case finalsave.weekday == 1:
    trace ("monday");
    break;

    case finalsave.weekday== 2:
    trace ("tuesday");
    break;

    case finalsave.weekday == 3:
    trace ("wednesday");
    break;

    case finalsave.weekday == 4:
    trace ("thursday");
    break;

    case finalsave.weekday == 5:
    trace ("friday");
    break;

    default:
    trace ("nothingness");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:29:00.847

```
switch (finalsave.weekday) {
    case 1:
    trace ("monday");
    break;

    case 2:
    trace ("tuesday");
    break;

    case 3:
    trace ("wednesday");
    break;

    ... etc.
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T06:55:53.347

或者，如果您想完全放弃那个可怕的开关盒：

```
var weekdays: Array = [
    "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"
]

var index : int = finalsave.weekday -1;
trace( weekdays[ index ] ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T00:35:58.867

在 case 之后，您应该提及变量的可能值，以下是 action script、c/c++、java 和 javascript 的 switch case 的语法：

使用字符串切换大小写。查看源打印？

```
switch("hello world")
{
case "hello":
trace("The man says hello");
break;

case "hello cat":
trace("The man says hello cat");
break;

case "hello world":
trace("The man says hello world");
break;

default:
trace("None of the above were met");
} 
```

在这个例子中，文本“The man says hello world”被追踪。Switch Case 使用整数，很有趣。

```
switch(1)
{
case 1:
trace("The Number 1");
break;

case 2:

case 3:
trace("The Number 2 or 3");
break;

default:
trace("None of the numbers above");
} 
```

来自[http://www.how-to-code.com/as3-actionscript3/as3-conditionals/as3-switch-case.html](http://www.how-to-code.com/as3-actionscript3/as3-conditionals/as3-switch-case.html)

# visual-c++ - 有人可以检查我的逻辑是否正确吗？

> ID：14573724
> 
> 赞同：0
> 
> 时间：2013-01-29T00:27:32.230
> 
> 标签：visual-c++, opengl

刚开始学opengl，先贴一段代码，说明一下我的理解，能不能按照我的说明，指出有什么问题？

```
glMatrixMode(GL_MODELVIEW); 
glLoadIdentity();   //start with an identity matrix

glPushMatrix();  
//push the current identity matrix onto the stack, and start with a new identity matrix as 
  the transformation matrix

    glPushMatrix();  
    //copy the current matrix which is the identity as the new transformation matrix and then push the current transformation matrix onto stack

        glScalef(10, 10, 1.0);
        **Question 1**
        //I feels like the order which the image is built is kinda reversed
        //It's like drawSquare happens first, then color, then scale
        //can anyone clarify?
        //Second, the drawsquare defines the 4 vertices around the origin(+/-0.5,+/-0.5)
        //is the origin located at the center of the window by default?
        //what happen when it is scaled? does point (0.5,0.5) scaled to (5,5)?
        glColor3f(0.0, 1.0, 0.0);
        drawSquare(1.0);
    glPopMatrix(); 
    //forget the current transformation matrix, pop out the one on top of the stack
    //which is the identity matrix

    //In the code below:
    //my understanding is 4 vertices is defined around origin, but is this the same origin?
    //then the unit square is moved just below the X-axis
    //and the 4 vertices are scaled one by one?
    //ex: (0.5,0) -> (1,0)  (0.5,-1) -> (1,-2)
    glScalef(2, 2, 1.0);
    glTranslatef(0.0, -0.5, 0.0);
    glColor3f(1.0, 0.0, 0.0);
    drawSquare(1.0);
    //last question, if I want to make the second square rotate at a point along z-axis
    //do I have to specify it here? 
    //for example: add glRotatef(rotate_degree, 0.0, 0.0, 1.0); above the glScalef(2, 2, 1.0);
    //such that later i can change the value in the rotate_degree?

glPopMatrix(); //forget about the current transformation matrix, pop out the top matrix on the stack. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:20:52.500

运算顺序似乎是倒置的，这是因为矩阵在与列向量相乘时是非交换的和右结合的。假设您在模型空间中有一个位置列向量*↑p 。*要将其带入世界空间，请将其与矩阵**M**相乘，即

*↑p* _world = **M** · *↑p*

请注意，您不能更改操作顺序！列向量像键一样匹配到矩阵中，并且键从右侧匹配到矩阵锁中。

在下一步中，您要使用矩阵**V**转换为视图空间，因此您可以编写

*↑p* _view = **V** · *↑p* _world

但是这个你可以用

*↑p* _view = **V** · **M** · *↑p*

但是当然，如​​果你有很多*↑p* -s 你想节省计算，所以你将这两个矩阵**M**和**V**压缩成一个你称为 modelview 的矩阵。当您使用 OpenGL 构建模型视图时，您可以像这样构建它：

```
MV = 1
MV = MV · V
MV = MV · M 
```

由于列顺序矩阵乘法的右关联性，应用于向量的第一个变换是最后一个乘以到堆栈上的变换。

* * *

请注意，通过使用*行*序矩阵数学，事物变得左关联，即事物按照您编写它们的顺序发生。但是列顺序右关联性非常有用，因为它使构建分支转换层次结构变得更加容易。

# jquery - 将鼠标悬停在表格的 x 列上并填充 x 元素

> ID：14573726
> 
> 赞同：0
> 
> 时间：2013-01-29T00:28:09.393
> 
> 标签：jquery, html-table, jquery-selectors

我有一个表格和一个带有矩形的 svg 图表。

我想将鼠标悬停在表格的第一列并填充图表的第一个矩形，当您将鼠标悬停在表格的第二列时填充第二个矩形。

这是重复的 2

这是有效的：

```
 $('tr td:nth-child(1)').mouseover(function(){
      $('rect:nth-of-type(1)').css("fill", "black" );
    });

    $('tr td:nth-child(2)').mouseover(function(){  
      $('rect:nth-of-type(2)').css("fill", "black" );
    }); 
```

但后来我需要重复自己 24 次。我试过这个解决方案：

```
$('tr td:lt(24)').hover(
  function(){
    var index = $(this).index();
    $('rect').eq( index ).css("fill", "black" );
    },
  function(){
    var index = $(this).index();
    $('rect').eq( index ).css('fill', 'steelblue');
}); 
```

但是现在，当您将鼠标悬停在表格上时，只会选择表格第一行的 td。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:35:07.533

使用`tr:lt(24) td`而不是`td:lt(24)`. 您想要少于第 24*行*，而不是第 24 列。

# python - Python统计包：statsmodel和scipy.stats的区别

> ID：14573728
> 
> 赞同：26
> 
> 时间：2013-01-29T00:28:21.450
> 
> 标签：python, scipy, scikits, statsmodels

我需要一些关于为 Python 选择统计数据包的建议，我已经做了很多搜索，但不确定我是否一切都正确，特别是关于 statsmodels 和 scipy.stats 之间的差异。

我知道的一件事是具有 scikits 命名空间的那些是 scipy 的特定“分支”，而过去的 scikits.statsmodels 现在称为 statsmodels。另一方面，还有 scipy.stats。两者有什么区别，哪个是Python*的*统计包？

谢谢。

- 编辑 -

我更改了标题，因为有些答案与问题并没有真正相关，我想那是因为标题不够清楚。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-29T03:34:59.237

Statsmodels 将 scipy.stats 作为依赖项。Scipy.stats 有所有的概率分布和一些统计测试。它更像是 numpy 和 scipy 的库代码。另一方面，Statsmodels 为统计模型提供了一个类似于 R 的公式框架，并且可以与 pandas DataFrames 一起使用。statsmodels 中还有统计测试、绘图和大量辅助函数。真的这取决于你需要什么，但你绝对不必选择一个。他们有不同的目标和优势。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-29T04:29:59.933

我尝试在日常工作中使用 pandas/statsmodels/scipy，但有时这些软件包有点短（LOESS，有人吗？）。RPy 模块的问题是（至少我上次检查过）它想要一个不是当前版本的特定 R 版本——我的 R 安装是 2.16（我认为）而 RPy 想要 2.14。所以要么你必须有两个 R 的并行安装，要么你必须降级。（如果您没有安装 R，那么您可以安装正确版本的 R 并使用 RPy。）

因此，当我需要不在 pandas/statsmodels/scipy 中的东西时，我会编写 R 脚本，并使用`subprocess`模块运行它们。这让我尽可能少地与 R 交互（我真的不喜欢在其中编程），但我仍然可以利用 R 具有的所有 Python 包所没有的东西。

教训是，任何问题都没有*一个*解决方案——你必须以你理解的方式组装一大堆对你有用的部分（也许你自己写一些），以解决问题。（R 爱好者当然会不同意！）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-29T01:13:26.357

我认为统计包是 numpy/scipy。如果您想使用 matplotlib 绘制数据，它也非常有用。但是，据我所知，matplotlib 尚不适用于 Python 3.x。

# asp.net - 无法安装自己的谷歌浏览器扩展

> ID：14573732
> 
> 赞同：-1
> 
> 时间：2013-01-29T00:28:49.343
> 
> 标签：asp.net, google-chrome-extension

我想在我的 asp.net 服务器上托管我自己的扩展程序（它是免费的网络服务器，所以我无权访问 machine.config 等）。
但我的问题的重点就在这里。我把打包的扩展放到服务器上，我想使用这样的东西：

```
protected void Page_Load(object sender, EventArgs e)
    {
        string file = Request.QueryString["f"];
        if (file != null)
        {            
            Response.Write("");
            if (file == "0")
            {
                Response.ContentType = "application/x-chrome-extension";
                Response.AddHeader("Content-Disposition", "attachment;filename=RemotePlay_extension.crx");
                Response.TransmitFile("~/Extensions/Update/RemotePlay_extension.crx");
            }
            else
            {
                Response.ContentType = "application/x-chrome-extension";
                Response.AddHeader("Content-Disposition", "attachment;filename=RemotePlay_extension.crx");
                Response.TransmitFile("~/Extensions/RemotePlay_extension.crx");
            }
        }
    } 
```

但每次我得到这个错误：
![下载扩展程序后出现错误：包无效：'CRX_SIGNATURE_VERIFICATION_FAILED'](../Images/6160c1ad8a42a259425915c8e3032392.png)

扩展清单的来源：

```
{
 "name": "Remote Play",
 "description": "DJ interface to use RP.",
 "version": "0.0.0.2",
 "update_url": "../Extensions/RemoteChrome_Update.xml",
 "permissions": ["tabs", "http://*/*"],
 "background": { "scripts": ["background.js"] },
 "content_scripts": [{"matches": ["http://*/*"],"js": ["inject.js"]}],
 "page_action": {"default_icon": "playico.png", "default_popup": "popup.html"},
 "manifest_version": 2
} 
```

我做错了什么？那个错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T08:44:26.703

您不能通过`Page_Load`函数和标题触发安装

*   你应该有一个链接标签`<link rel="chrome-webstore-item" href="https://chrome.google.com/webstore/detail/apdfllckaahabafndbhieahigkjlhalf">`
*   您可以通过触发安装`chrome.webstore.install(url, successCallback, failureCallback)`

有关更多信息，请查看[文档](https://developers.google.com/chrome/web-store/docs/inline_installation)。

# sencha-touch - Sencha Touch 模型协会不填充儿童

> ID：14573737
> 
> 赞同：0
> 
> 时间：2013-01-29T00:29:03.403
> 
> 标签：sencha-touch, sencha-touch-2

我在模型中使用 hasMany/belongsTo 语义映射了一个员工-最爱关系。在我的商店中，我只是设置了根并指向根数组，但我没有看到模型的收藏夹部分被填充。有任何想法吗？

我的人模型：

```
Ext.define('People.model.Employee', {
extend: 'Ext.data.Model',
config: {
    fields: [
        { name: 'cn'}
    ],
    hasMany: { model: 'Favorite', name: 'favorites' }
}}); 
```

最喜欢的型号：

```
Ext.define('People.model.Favorite', {
extend: 'Ext.data.Model',
config: {
    fields: [
        { name: 'uid'},
        { name: 'fullName'}
    ],
    belongsTo: 'Employee'
}}); 
```

店铺：

```
Ext.define('People.store.Favorites', {
extend: 'Ext.data.Store',
requires: [
    'People.model.Employee',
    'People.model.Favorite'
],
config: {
    autoLoad: false,
    model: 'People.model.Employee',
    storeId: 'Favorites',
    proxy: {
        type: 'jsonp',
        url: People.app.favSearchUrl,
        reader: {
            type: 'json',
            idProperty: 'cn',
            rootProperty: 'records'
        }
    }
}}); 
```

我尝试使用的 JSON 如下：

```
 {
    "records": [
        {
            "_id": "5106f97bdcb713b818d7f1f1",
            "cn": "lsacco",
            "favorites": [
                {
                    "fullName": "Friend One",
                    "uid": "friend1"
                },
                {
                    "fullName": "Friend Two",
                    "uid": "friend2"
                }
            ]
        }
    ]
} 
```

# ruby-on-rails-3 - Rails 应用程序与带有 redirect_to 错误的乘客一起上线

> ID：14573740
> 
> 赞同：0
> 
> 时间：2013-01-29T00:29:53.667
> 
> 标签：ruby-on-rails-3, passenger

我已经成功地与乘客一起部署了我的 Rails 应用程序。但是，我的 redirect_to 在生产环境中的行为与开发环境不同。

我有这个代码：

```
redirect_to( :page => :signup, :subdomain => false) 
```

在开发应用程序上它工作得很好，所以：

[http://demo.charterbox.com.au](http://demo.charterbox.com.au)重定向到`http://charterbox.com.au/?page=signup`完美！

在我刚刚上传的生产应用程序中，它执行以下操作：

[http://demo.charterbox.com.au](http://demo.charterbox.com.au)重定向到`http://com.au/?page=signup`

它不仅带走了子域，还带走了整个域。不管我是否使用子域，它仍然会重定向到`http://.com.au`

以下是 ApplicationsController 中的完整代码：

```
before_filter :check_domain

def check_domain

  if request.subdomain.blank? == false
     @account = Account.where("site_address = ?", request.subdomain).limit(1)      
     if @account.empty? 
       redirect_to( :page => :signup, :subdomain => false)
     end
  end

end 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:35:05.510

您需要配置 TLD 长度。

```
config.action_dispatch.tld_length sets the TLD (top-level domain) length for the application. Defaults to 1. 
```

[http://guides.rubyonrails.org/configuring.html#configuring-action-dispatch](http://guides.rubyonrails.org/configuring.html#configuring-action-dispatch)

# graph - 引文图工具

> ID：14573741
> 
> 赞同：3
> 
> 时间：2013-01-29T00:30:20.960
> 
> 标签：graph, ieee-754, bibliography, ieee, citations

有谁知道制作引文图的工具/应用程序，或者可以用论文及其参考文献和论文参考书目制作图表的应用程序？

有人告诉我，ieee 有一个，但我没说。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:34:12.053

您可以使用[D3.js使用诸如](http://d3js.org/)[force-directed graph 之](http://bl.ocks.org/4062045)类的东西来构建它。

添加[鱼眼失真](http://bost.ocks.org/mike/fisheye/)可产生出色的视觉效果（不一定有用，但很可爱）。

如果引文图没有连接，使用[Colony](http://hughsk.github.com/colony/)是一个不错的选择。

作为旁注，在寻找可视化工具时，我通常会查看[D3.js Gallery](https://github.com/mbostock/d3/wiki/Gallery)。太奇妙了。

# file - 如何打开和编辑 .obj 文件

> ID：14573744
> 
> 赞同：0
> 
> 时间：2013-01-29T00:30:52.093
> 
> 标签：file, portability

我从一个网站下载了一个便携式数据文件，并希望能够对其进行编辑、了解其结构并自己生成此类文件。

[http://www.fileconvoy.com/dfl.php?id=ga4a4462424e50b70999210576591a13bb562d9009](http://www.fileconvoy.com/dfl.php?id=ga4a4462424e50b70999210576591a13bb562d9009)

有人可以告诉我从哪里开始以及用什么打开它吗？

谢谢！

# php - PHP MYSQL 未在 While 或 For 循环中获取数据

> ID：14573745
> 
> 赞同：0
> 
> 时间：2013-01-29T00:31:11.393
> 
> 标签：php, mysql, for-loop, while-loop

我已经使用 mysql 数据库制作了输入选择选项卡。

使用时：

```
<select name="membership_ID" id="membership" tabindex="1" required="required">
    <option value="">-- Membership Type --</option>
    <?php $get_membership = mysql_query("SELECT * FROM membership");
    while($row_membership = mysql_fetch_array($get_membership, MYSQL_ASSOC)): ?>
        <option value="<?php echo $row_membership['ID']; ?>"> <?php echo $row_membership['name']; ?> </option>
    <?php endwhile; ?>
</select> 
```

使用 For 循环：

```
<?php $get_membership = mysql_query("SELECT * FROM membership");
    $numRows = mysql_num_rows($get_membership);
    for($i=1;  $i<= $numRows; $i++){
        $row_membership = mysql_fetch_array($get_membership, MYSQL_ASSOC) ?>
        <option value="<?php echo $row_membership['membership_ID']; ?>"> <?php echo $row_membership['membership_name']." - ".$row_membership['membership_price']." Rs"; ?> </option>
<?php } ?> 
```

这工作正常，并在没有 while 循环时提供作为选项放置的值。但是当 while/for 循环放置时，不会显示 while/for 循环中的选项。注意：表成员资格包含数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T05:30:51.407

尝试这个 ：

```
$row_membership = mysql_fetch_array($get_membership) ?> 
```

# python - Python NLTK 和 RSS 提要分类？

> ID：14573748
> 
> 赞同：0
> 
> 时间：2013-01-29T00:31:20.347
> 
> 标签：python, rss, nltk

我一直在尝试找到将文章分类到特定类别的库，但一直没有运气，我能找到的最接近的项目是来自 IBM [http://www.ibm.com/developerworks/library/os-的链接pythonnltk/index.html](http://www.ibm.com/developerworks/library/os-pythonnltk/index.html)

这正是我需要做的，但是代码不完整，

是否有提供 RSS 提要分类的库？

# titanium - 钛 - 获取当前窗口

> ID：14573750
> 
> 赞同：1
> 
> 时间：2013-01-29T00:31:56.873
> 
> 标签：titanium

我希望能够向用户显示错误消息（甚至可能是成功消息！）。然而，这将是一个异步事件 - 因此用户可能在发送事件和响应之间跳转到另一个页面。

鉴于这种情况，并且我在初始 app.xml 中使用选项卡组作为“基础”，我打算如何访问当前窗口？Ti.UI.getCurrentWindow() 在我的系统上没有做任何事情 - 没有错误，没有什么。

我正在使用 Titanium 3 api。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T03:03:45.990

由于您使用选项卡组，您可以使用`Titanium.UI.currentTab`. 然后你可以像这样得到标签的窗口：

```
var theWindow = Titanium.UI.currentTab.window; 
```

[具体的文档参考](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.UI-property-currentTab)（以防万一）。

此外，您始终可以使用`Titanium.UI.AlertDialog`，无论您打开哪个窗口，只要它满足您的要求，它都会显示出来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-21T14:00:02.670

是的，您可以使用 Ti.UI.currentTab.window()。并且因为这是函数所以使用“（）”，否则它不会给出正确的输出

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T10:27:16.923

> 获取当前窗口使用 Ti.UI.getCurrentWindow 而不是 Ti.UI.getCurrentWindow()

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-10T09:02:25.553

Ti.UI.currentWindow 仅在已经打开一个窗口时才有效。您遇到的错误来自创建 MasterView 时尚未打开窗口的事实。

查看 ApplicationWindow.js 内部，您会看到您甚至在打开窗口之前就创建了主视图。

如果要设置导航栏项，可以将它们添加到 ApplicationWindow、app.js 中，或者将窗口传递给 MasterView。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-04T15:28:56.570

currentTab 仅在您的应用使用选项卡时才有效。

currentWindow 和 getCurrentWindow() 仅在使用 Ti.UI.createWindow 方法的 url 属性打开窗口时才有效。

如果您处于任何其他情况，当前窗口似乎不可用。

# c# - windows 8 桌面：蓝牙事件监听器

> ID：14573752
> 
> 赞同：0
> 
> 时间：2013-01-29T00:32:13.707
> 
> 标签：c#, c++, windows, bluetooth

我正在为平板电脑编写一个 Windows 8 桌面应用程序，用于跟踪蓝牙无线电状态以监控功耗。基本上，我想找出初始无线电状态，以及在状态变化时接收回调。我浏览了 MSDN 蓝牙功能（[http://msdn.microsoft.com/en-us/library/windows/desktop/aa362927%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa362927%28v=vs.85%29.aspx)）但一直没能找到关于事件回调的任何事情。

有人可以指出我正确的方向吗？有没有办法做到这一点（最好在 C# 中，但 C/C++ 也可以）？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T16:36:09.963

我认为没有关于无线电移除的蓝牙事件。您将能够使用常规硬件事件来查看设备移除，该设备由函数 RegisterDeviceNotification 设置。参见例如 [http://msdn.microsoft.com/en-gb/library/windows/desktop/aa363431.aspx](http://msdn.microsoft.com/en-gb/library/windows/desktop/aa363431.aspx) [http://www.codeproject.com/Articles/14500/Detecting-Hardware-Insertion-and-or-Removal](http://www.codeproject.com/Articles/14500/Detecting-Hardware-Insertion-and-or-Removal)

# python - Python KillProcess 但隐藏 cmd

> ID：14573754
> 
> 赞同：0
> 
> 时间：2013-01-29T00:32:31.060
> 
> 标签：python, python-2.2

> **可能重复：**
> [在不出现 DOS shell 的情况下运行 python 脚本](https://stackoverflow.com/questions/1689015/run-python-script-without-dos-shell-appearing)
> [当我使用 os.system() 或 subprocess.call() 时如何隐藏控制台？](https://stackoverflow.com/questions/7006238/how-do-i-hide-the-console-when-i-use-os-system-or-subprocess-call)

我需要制作一个 Python2.2 程序来关闭一个进程。问题是我不希望用户看到 CMD 窗口。可能吗？

```
import os
os.system("taskkill /im injector* /f")
os.system("taskkill /im *injector /f") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:39:39.933

尝试使用 subprocess 模块，示例在[这里](http://docs.python.org/2/library/subprocess.html)

您需要指定`shell=True` 以下内容：

```
subprocess.call("taskkill.exe /im injector* /f", shell=True) 
```

不会显示控制台窗口。

不要忘记

```
import subprocess 
```

# file - Python Eclipse 输出到外部文本文件

> ID：14573755
> 
> 赞同：0
> 
> 时间：2013-01-29T00:32:30.980
> 
> 标签：file, text, console, output

我有一个长时间运行的代码，每分钟输出一次东西。我将整夜运行它，并在早上检查结果。

有没有办法将所有控制台内容写入外部文本文件。我不想修改代码，只是希望将所有控制台输出定向到外部文件。我在 Eclipse 中工作。我尝试了 Run -> Run Configurations... -> Your Application -> Common tab -> File idea 但输出很糟糕 - 没有换行符。

有没有办法将与控制台完全相同的输出转换为文本文件 - 所有格式都很好？

提前谢谢了。

RS

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-25T16:18:31.507

您可以添加一个文本文件。如果您将代码写入特定目录中的文件，或者如果您知道它的名称，您的程序可以识别它。例如，如果您的变量是单词，您可以编写 words = open("what your file is called") 然后在代码末尾写入文件：file.write(string)

# java - 休眠中的注释异常

> ID：14573756
> 
> 赞同：-1
> 
> 时间：2013-01-29T00:32:34.537
> 
> 标签：java, hibernate, annotations, subclass, superclass

我正在尝试在教授和贷款对象之间建立一对多的关系。教授是用户对象的子类。因此，我创建了一个用户对象，它必然是一个教授对象。

```
private User professor 
```

当我运行程序时，我得到以下注释异常。

> com.csu.library.model.Loan.professor 上的 @OneToOne 或 @ManyToOne 引用了一个未知实体：com.csu.library.model.User

任何人都可以帮助解决问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:10:26.457

您是否在实体类中添加了注释为 @Entity 并在`persistence.xml`

# c# - DisplayAttribute 不在模型中本地化其属性

> ID：14573757
> 
> 赞同：1
> 
> 时间：2013-01-29T00:32:51.243
> 
> 标签：c#, wpf, mvvm, localization, attributes

我在我的 WPF 应用程序中使用 MVVM 模式，并将 DisplayAttribute 与本地化应用于我的模型的属性：

```
class MyModel
{
    [Display(
        ResourceType = typeof(Resources.Strings),
        Name = "MyPropertyName",
        Description = "MyPropertyDescription")]
    public double MyProperty { get; set; }
} 
```

我想显示模型属性的本地化属性。必要的资源文件位于适当的位置，必要的文化设置。我还将 Build Action 设置为 Embedded Resource，并将 Custom Tool 设置为 PublicResXFileCodeGenerator - 根据 DisplayAttribute 的要求。但 DisplayAttribute 为其 Name 参数返回“MyPropertyName”而不是本地化字符串。

下面介绍了我使用 DisplayProperty 的场景。为了显示模型属性的属性属性，我使用了一个带有助手类的转换器，如下所示：

```
namespace MyProject.Converters
{
    // helper class
    public class MetadataParameters
    {
        public Type ModelType { get; set; }
        public string ModelProperty { get; set; }
        public Type AttributeType { get; set; }
        public string AttributeProperty { get; set; }
    }

    public class MetadataConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            var mp = parameter as MetadataParameters;
            var modelPropertyInfo = mp.ModelType.GetProperty(mp.ModelProperty);
            var attribute = modelPropertyInfo
                .GetCustomAttributes(true)
                .Cast<Attribute>()
                .FirstOrDefault(memberInfo => memberInfo.GetType() == mp.AttributeType);
            var attributeProperty = attribute.GetType().GetProperty(mp.AttributeProperty);

            return attributeProperty.GetValue(attribute, null);
        }
    }
} 
```

XAML 资源：

```
xmlns:converters="clr-namespace:MyProject.Converters"
<converters:MetadataConverter x:Key="metadataConverter" /> 
```

XAML：

```
xmlns:converters="clr-namespace:MyProject.Converters"
xmlns:DataAnnotations="clr-namespace:System.ComponentModel.DataAnnotations;assembly=System.ComponentModel.DataAnnotations"
xmlns:Models="clr-namespace:MyProject.Models"

<TextBlock 
    <TextBlock.Text>
        <Binding
            Mode="OneWay"
            Converter="{StaticResource metadataConverter}">
            <Binding.ConverterParameter>
                <converters:MetadataParameters
                    ModelType="{x:Type Models:Model}"
                    ModelProperty="ModelProperty"
                    AttributeType="{x:Type DataAnnotations:DisplayAttribute}"
                    AttributeProperty="Name" />                            
            </Binding.ConverterParameter>
        </Binding>
    </TextBlock.Text>
</TextBlock> 
```

我编写了自己的简单属性，它返回本地化字符串，而不仅仅是属性名称的值（如 DisplayAttribute 所做的那样）：

```
public class LocalizedDisplayAttribute : Attribute
{
    private readonly string name;

    public virtual string Name
    {
        get
        {
            var rm = new System.Resources.ResourceManager(typeof(Resources.Strings));
            return rm.GetString(this.name);
        }
    }

    public LocalizedDisplayAttribute(string name)
        : base()
    {
        this.name = name;
    }
}

class MyModel
{
    [LocalizedDisplay("MyPropertyName")]
    public double MyProperty { get; set; }
} 
```

那么为什么 DisplayAttribute 不本地化它的属性呢？MSDN 说这个属性是为本地化而设计的。在我的 ASP.NET MVC 项目中 DisplayAttribute 工作正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-09T12:17:47.593

DisplayAttribute 上有 Get 方法，还有一些您需要调用的其他方法，它们将为您提供您正在寻找的本地化字符串。您在这里所做的是获取 DisplayAttribute.Name 属性的值，即“MyPropertyName”。

如果调用 DisplayAttribute.GetName()，它将查找由 ResourceType 属性指定的资源类，然后它将使用 Name 属性来反映资源类型上的属性。

我更改了您的代码，假设您请求的 AttributeProperty 将获得 GetXXX() 方法。

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
{
  var mp = parameter as MetadataParameters;
  var modelPropertyInfo = mp.ModelType.GetProperty(mp.ModelProperty);
  var attribute = modelPropertyInfo
      .GetCustomAttributes(true)
      .Cast<Attribute>()
      .FirstOrDefault(memberInfo => memberInfo.GetType() == mp.AttributeType);

  // We have to call the GetXXX methods on the attribute to get a localised result.
  //return ((DisplayAttribute)attribute).GetName();
  var result = attribute
    .GetType()
    .InvokeMember(
      "Get" + mp.AttributeProperty,
      BindingFlags.InvokeMethod | BindingFlags.Instance | BindingFlags.Public,
      null,
      attribute,
      new object[0]); 
  return result;
} 
```

# ruby-on-rails - Rails 在多个子域上分离会话

> ID：14573761
> 
> 赞同：1
> 
> 时间：2013-01-29T00:33:30.167
> 
> 标签：ruby-on-rails, ruby, subdomain

这是 Ruby on Rails 特定的

有没有人有例如 2 个子域 test1.example.com 和 test2.example.com，您可以使用 test1.example.com 上的登录表单登录到 test1.example.com，然后转到 test2.example.com 登录在另一个浏览器中的页面，不要登录，回到1.example.com，刷新页面，然后退出？

我使用域设置为“.example.com”的 active_record_store

```
config.session_store :active_record_store, :key => '_example_session', :domain => ".example.com" 
```

以上是在 development.rb 环境设置中设置的，我对 session_store.rb 文件做了同样的设置，以防万一。

# mongodb - 识别 mongo 集群的陈旧成员

> ID：14573763
> 
> 赞同：4
> 
> 时间：2013-01-29T00:33:59.610
> 
> 标签：mongodb

如果 mongo 节点离线时间过长，并且 oplog 在它恢复之前包装，那么它可能会陷入陈旧状态并需要手动干预。如何从副本集状态文档中识别该状态？它会停留在状态 3，它也被处于维护模式的节点使用，并且可能被可以赶上的节点使用？如果是这样，我该如何区分？

来自[http://docs.mongodb.org/manual/reference/replica-status/](http://docs.mongodb.org/manual/reference/replica-status/)：

```
Number State
0      Starting up, phase 1 (parsing configuration)
1      Primary
2      Secondary
3      Recovering (initial syncing, post-rollback, stale members)
4      Fatal error
5      Starting up, phase 2 (forking threads)
6      Unknown state (the set has never connected to the member)
7      Arbiter
8      Down
9      Rollback
10     Removed 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T01:28:22.200

它将处于状态 3，正在恢复。要特别识别陈旧状态，您需要查找该`errmsg`字段。当陈旧时，有问题的辅助节点将具有这样的 errmsg：

```
"errmsg" : "error RS102 too stale to catch up" 
```

就完整输出而言，它看起来像这样：

```
 rs.status()
{
        "set" : "testReplSet",
        "date" : ISODate("2013-01-29T01:39:38Z"),
        "myState" : 1,
        "members" : [
                {
                        "_id" : 0,
                        "name" : "hostname:31000",
                        "health" : 1,
                        "state" : 1,
                        "stateStr" : "PRIMARY",
                        "uptime" : 507,
                        "optime" : Timestamp(1359423456000, 893),
                        "optimeDate" : ISODate("2013-01-29T01:37:36Z"),
                        "self" : true
                },
                {
                        "_id" : 1,
                        "name" : "hostname:31001",
                        "health" : 1,
                        "state" : 2,
                        "stateStr" : "SECONDARY",
                        "uptime" : 483,
                        "optime" : Timestamp(1359423456000, 893),
                        "optimeDate" : ISODate("2013-01-29T01:37:36Z"),
                        "lastHeartbeat" : ISODate("2013-01-29T01:39:37Z"),
                        "pingMs" : 0
                },
                {
                        "_id" : 2,
                        "name" : "hostname:31002",
                        "health" : 1,
                        "state" : 3,
                        "stateStr" : "RECOVERING",
                        "uptime" : 4,
                        "optime" : Timestamp(1359423087000, 1),
                        "optimeDate" : ISODate("2013-01-29T01:31:27Z"),
                        "lastHeartbeat" : ISODate("2013-01-29T01:39:38Z"),
                        "pingMs" : 0,
                        "errmsg" : "error RS102 too stale to catch up"
                }
        ],
        "ok" : 1
} 
```

最后，一个代码片段仅从 shell 打印出错误（如果存在）：

```
rs.status().members.forEach(function printError(rsmember){if (rsmember.errmsg){print(rsmember.errmsg)}}) 
```

# facebook - Facebook 链接预览

> ID：14573767
> 
> 赞同：0
> 
> 时间：2013-01-29T00:34:50.177
> 
> 标签：facebook, facebook-graph-api

我已经搜索、搜索和搜索，但无法找到一种方法让人们在应用程序的页面上发布链接（当然，作为页面所有者），并进行链接预览。它只是发布链接，而不是像您通过 facebook 发布那样的预览。我想知道是否有办法像这样覆盖链接预览：

```
$x = $facebook->api('/'.$_POST["id"].'/link', 'post', array('message'=> urldecode($_POST["message"]), 'access_token' => $_POST["auth"], 'cb' => '', 'picture' => 'url to pic','description'=>'blah blah')); 
```

请帮忙，真的不知道该怎么办..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-06-29T13:27:11.663

考虑使用允许自定义链接预览的[链接缩短服务。](https://linkfork.co)使用 linkfork.co，您可以自定义图像、标题和描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T18:35:10.467

我做了很多测试并想出了我的答案：

```
$x = $facebook->api('/'.$_POST["id"].'/links', 'post', array('link' => $url,'caption' => $data['description'],'name' => $data['title'],'picture' => $data['thumbnail_url'],'url' => $url, 'message'=> urldecode($_POST["message"]), 'access_token' => $_POST["auth"], 'cb' => '')); 
```

# r - 在 for 循环中运行 sapply 的更快方法

> ID：14573771
> 
> 赞同：2
> 
> 时间：2013-01-29T00:35:06.057
> 
> 标签：r, for-loop, sapply

我试图找到一种更快的方法来运行一个函数，它正在寻找一个时间段内每一天的中值。有没有比在 for 循环中运行 Sapply 更快的方法？

```
for(z in unique(as.factor(df$group))){
all[[z]]<- sapply(period, function(x) median(df[x == df$date & df$group==z, 'y']))
} 
```

样本数据：

```
date<-as.Date("2011-11-01") + 
runif( 1000, 
       max=as.integer( 
           as.Date( "2012-12-31") - 
               as.Date( "2011-11-01")))
period<-as.Date(min(df$date):max(df$date), origin = "1970-01-01")
df <- data.frame(date=date, y = rnorm(1000), group=factor(rep(letters[1:4], each=250))) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T00:40:15.563

如果我理解正确，您想要`split by group`然后计算`median`每个`date`. 这是一个`data.table`解决方案。

**编辑：**问题`date`出在数据集的格式上。它似乎报告了错误的唯一元素数量。所以，我不得不将它重铸为`POSIXct`格式。

```
df$date <- as.POSIXct(as.character(df$date), format="%Y-%m-%d")
require(data.table)
dt <- data.table(df)

setkey(dt, "date")
dt.out <- dt[, lapply(letters[1:4], 
          function(x) median(y[group == x])), by = date] 
```

这与 Victor 的输出相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T01:25:43.997

这是使用基本 R 函数的解决方案[`tapply`](http://www.inside-r.org/r-doc/base/tapply)

```
tapply(df$y, df$date, median) 
```

**更新**。从您上面的评论来看，每个组需要一列吗？这也是一个单行：

```
tapply(df$y, list(df$date, df$group), median) 
```

# xna - XNA 媒体播放器问题

> ID：14573773
> 
> 赞同：0
> 
> 时间：2013-01-29T00:35:40.350
> 
> 标签：xna

我在 Game1 的 Draw() 中有以下代码。但是，只有在我按下程序的关闭按钮时才会播放音乐。如果没有，我应该把 MediaPlayer.Play() 放在哪里？normS、fastS、slowS、playing 都是 Song 类型。如果你需要我澄清什么，尽管问。

```
 if (stateS == "normal")
        {
            if (!MediaPlayer.Equals(playing, normS))
            {
                playing = normS;
            }

            spriteBatch.Draw(norm, pos, Color.White);
        }
        else if (stateS == "fast")
        {
            if (!MediaPlayer.Equals(playing, fastS))
            {
                playing = fastS;
            }
            spriteBatch.Draw(fast, pos, Color.White);
        }
        else if (stateS == "slow")
        {
            if (!MediaPlayer.Equals(playing, slowS))
            {
                playing = slowS;
            }
            spriteBatch.Draw(slow, pos, Color.White);
        }
        MediaPlayer.Play(playing); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T16:01:11.093

是否有特殊原因需要使用 Draw 方法播放歌曲？绘图应该保留用于绘制事物。

就像上面评论中所说的 user1306322 一样，我建议将

```
MediaPlayer.Play(playing); 
```

进入 Update 方法，并将其包装在条件中（这样您就不会在每次更新时都继续播放一首新歌，我*认为*这是您现在正在发生的事情，因为单击并按住 Close Window x 会停止更新。您可以试试这个也可以拖动窗口）：

```
if (!MediaPlayer.IsPlaying)
{
    MediaPlayer.Play(playing);
} 
```

如有必要，您可以将其余代码留在 Draw 中，但很可能整个事情都应该放在 Update 中。

*编辑*我刚刚意识到您可能对此没有条件，因为您希望能够随时更改歌曲。在这种情况下，你应该设置一个变量来保存你的“最后一首歌”，这样你就可以在你的条件中比较它，如下所示：

```
if (MediaPlayer.IsPlaying == false || playing != lastPlaying)
{
    MediaPlayer.Play(playing);
} 
```

# footer - Javascript 中的页脚 HTML

> ID：14573783
> 
> 赞同：0
> 
> 时间：2013-01-29T00:36:45.537
> 
> 标签：footer, innerhtml, getelementbyid

您好，我正在使用以下 javascript 代码，该代码将位于单独的文件中，以便可以在整个站点中全局引用。

它允许我对页脚和菜单等 html 元素进行全局引用，并通过 id 包含它们：

```
<body>

<div id="copyright"></div>

<script>
var copyright = document.getElementById("copyright");
copyright.innerHTML = "<p>&copy; Some Company 2013</p>";
</script>

</body> 
```

只要将 javascript 放在页面底部，就可以正常工作。我想知道我可能需要修改什么才能将脚本移动到标题中？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:38:47.737

[在 DOM ready 上](https://stackoverflow.com/questions/799981/document-ready-equivalent-without-jquery)运行代码。没有像 jQuery 这样的库并不好玩，但我不得不问你为什么要这样做。

重用 HTML有很多*更好*的方法：[**模板。**](https://www.google.com/search?q=html%20templating)

* * *

好的，所以你正在使用 jQuery。然后，您可以使用通常的、普遍的文档就绪处理：

```
$(document).ready(function ()
{
    $('#copyright').html('<p>&copy; Some Company 2013</p>');
});

// or the short-hand version

$(function ()
{
    $('#copyright').html('<p>&copy; Some Company 2013</p>');
}); 
```

也就是说，我**仍然**建议使用模板。[您甚至可以使用 jQuery 在客户端执行此操作。](https://github.com/BorisMoore/jsrender)

# testing - 入站文件轮询的 Mule 测试代码

> ID：14573784
> 
> 赞同：1
> 
> 时间：2013-01-29T00:36:45.210
> 
> 标签：testing, mule

我是 Mule ESB 的新手。

我有以下来自拼写检查器教程的 Mule 配置文件：

```
<file:connector name="FILE" streaming="false" doc:name="File" autoDelete="true" validateConnections="false"/>
<flow name="SpellCheckerFlow1" doc:name="SpellCheckerFlow1">        
    <file:inbound-endpoint connector-ref="FILE" path=".\xmlIn" pollingFrequency="3000" responseTimeout="10000" doc:name="Incoming File" moveToDirectory=".\xmlProcessed"/>
    <http:outbound-endpoint exchange-pattern="request-response" host="www.google.com/tbproxy/spell?lang=en" port="80" doc:name="Invoke API"/>
    <echo-component doc:name="Echo"/>
    <file:outbound-endpoint path=".\xmlOut" outputPattern="#[function:datestamp:dd-MM-yy]_#[function:systime].xml" responseTimeout="10000" doc:name="File"/>
</flow> 
```

我正在尝试扩展`FunctionalTestCase`课程并测试此流程。以下是我用来执行此操作的提取代码：

```
MuleClient client = new MuleClient(muleContext);        
client.dispatch("file://./xmlIn", "<valid_xml />", null);
MuleMessage message = client.request("file://./xmlOut", 1000000000); 
```

当我执行此代码时，它会在 /xmlIn 文件夹中创建一个数据文件。流程的其余部分不会被执行。流程应轮询此文件夹以获取文件。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T02:04:24.540

从端点请求时超时参数无效`file`：Mule 不会等待文件出现。

这意味着您的测试不会阻塞并且总是失败。解决问题的最简单/不太完善的方法是循环 a`{ Thread.wait(); client.request(); }`直到你得到一个非 null `message`，即直到文件 in`xmlOut`被读取。

无需添加重试计数器：Mule's`FunctionalTestCase`将在测试结束后自动失败`getTestTimeoutSecs()`（默认为 60 秒）。

旁注：

*   为了使您的配置在我的环境中工作，我必须在 XML 配置的文件路径中`.\`替换为。`./`

*   出站 HTTP 端点配置错误：`path`混合在 中`host`，请改用：

    ```
    <http:outbound-endpoint exchange-pattern="request-response"
        host="www.google.com" path="tbproxy/spell?lang=en" port="80"
        doc:name="Invoke API" /> 
    ```

*   以这种方式获取 Mule 客户端的效率稍高一些：

    ```
    MuleClient muleClient = muleContext.getClient(); 
    ```

# java - 计算给定 3 个用户定义点的三角形面积 - 初学者

> ID：14573785
> 
> 赞同：4
> 
> 时间：2013-01-29T00:37:11.010
> 
> 标签：java, geometry, area

我可以编译我的代码，但它不会产生所需的区域。我不确定我在哪里绊倒了。

他们希望您让用户为三角形的 3 个点输入 6 个坐标（x 和 y 值）并获取面积。我的代码如下：

```
import java.util.Scanner;

public class AreaTriangle {
    // find the area of a triangle
    public static void main (String [] args) {
        double side1 = 0;
        double side2 = 0;
        double side3 = 0;

        Scanner input = new Scanner(System.in);

        //obtain three points for a triangle
        System.out.print("Enter three points for a triangle (x and y intercept): ");
        double side1x  = input.nextDouble();
        double side1y  = input.nextDouble();
        double side2x  = input.nextDouble();
        double side2y  = input.nextDouble();
        double side3x  = input.nextDouble();
        double side3y  = input.nextDouble();

        //find length of sides of triangle
        side1 = Math.pow(Math.pow((side2x - side1x), 2) + Math.pow((side2y - side1y), 2) * .05, side1);
        side2 = Math.pow(Math.pow((side3x - side2x), 2) + Math.pow((side3y - side2y), 2) * .05, side2);
        side3 = Math.pow(Math.pow((side1x - side3x), 2) + Math.pow((side1y - side3y), 2) * .05, side3);

        double s = (side1 + side2 + side3) / 2;

        double area = Math.sqrt(s * (s - side1) * (s - side2) * (s-side3)) * 0.5;

        System.out.println("area" + area);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T00:44:33.540

你应该尝试实现这个等式。[http://www.mathopenref.com/coordtrianglearea.html](http://www.mathopenref.com/coordtrianglearea.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T01:01:45.243

@Michael 的建议很好。按照您的代码，我会像这样使用毕达哥拉斯定理：

```
side1 = Math.sqrt(
            Math.pow((side2x - side1x), 2)
          + Math.pow((side2y - side1y), 2)); 
```

在您的代码中：

```
side1 = Math.pow(
            Math.pow((side2x - side1x), 2) 
          + Math.pow((side2y - side1y), 2) * .05
       , side1); 
```

`side1`是`0`在计算之前，几乎任何幂`0`都是 1。因此`side1`无论点数如何，都以 1 结束。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:45:10.420

我发现的另一种方法是您可以使用叉积来找到三角形的面积。这对你来说可能会稍微容易一些，因为你已经有了分数。您可以将三个点转换为两个向量并取叉积。

**编辑：** 哎呀，忘了加上三角形的面积将是叉积的一半，因为叉积会给你两个向量形成的平行四边形的面积（三角形是那个的一半）。

# php - 我需要帮助 刷新表单提交

> ID：14573789
> 
> 赞同：0
> 
> 时间：2013-01-29T00:37:47.467
> 
> 标签：php, javascript, jquery, ajax, json

我已经查看了整个堆栈，并用谷歌搜索了其中的废话，但每次我遇到一些东西时，我只遇到片段并且我找不到完整的代码，我怎样才能让一个 div 在表单提交时重新加载？

这是我要刷新的 div

```
 <div id="accsettings">
<?php require_once('￼profileform.php'); ?>
</div> 
```

这是表格

```
<form method="post" action="<?php echo $_SERVER['PHP_SELF'] . '?username=' . $user_name; ?>"> 
```

谢谢

我需要它在提交时刷新，以便显示玩家对其个人资料的影响

（通过显示他们的评论并且他们在网页上增加了他们的代表+1并删除了文本字段/提交表单，所有这些都已经处理好了，我只需要它在提交时刷新）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:56:07.103

你提交按钮的名称是什么？如果是`submit`，您可以执行以下操作：

```
<div id="accsettings">
<?php if (!isset($_POST['submit'])) { require_once('￼profileform.php');} else {echo '&nbsp';} ?>
</div> 
```

这假定表单提交到当前页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:39:31.207

```
$("form").on('submit', function (e) {
   $.post($(this).attr('action'), $(this).serialize() + '&submit=TRUE').done(
      function ()  {
         $("#accsettings").load('profileform.php');
      }
   );

   e.preventDefault();
}); 
```

这将做的是将 ajax 加载`profileform.php`到`#accsettings`div 的内容中。这假设您的表单提交正确更新了 ajax 的输出`profileform.php`并通过 ajax 完成（不过，我目前在您的代码中没有看到这方面的证据）。

# javascript - 从下拉菜单选择jquery添加div

> ID：14573791
> 
> 赞同：0
> 
> 时间：2013-01-29T00:37:49.713
> 
> 标签：javascript, jquery, dom, html, drop-down-menu

我可以使用 dom 添加一行，但是如何根据选择的内容让 div 显示在下拉列表的右侧？

这是我到目前为止的一个例子：http: [//jsbin.com/#/afojid/1/edit](http://jsbin.com/#/afojid/1/edit)

第一个下拉菜单工作正常，但其余的我想在单击按钮时添加，我希望它们的工作方式与原始下拉菜单相同。因此，如果选择了亚洲，则添加部分将出现在右侧，如果选择了其他，则其他添加部分将出现在右侧，以此类推，每次单击添加按钮时。我尝试了克隆，但我不想在单击添加按钮时选择任何内容

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:49:10.020

您使用 ids 而不是类的事实或多或少普遍使这非常具有挑战性。您应该更新代码以使用类并`*Info`在创建新下拉列表时适当地克隆表。

您使用的是旧版本的 jQuery，因此`.on`无法用于委托。相反，使用`.delegate`：

```
$(document).delegate('#typeofEthnicity,[id^=newDDMenu]', 'change', showEthnicity) 
```

这将调用`showEthnicity`原始下拉列表和任何添加的下拉列表的函数，但您还必须克隆所有`*Info`div 并将它们放在表中的适当位置（我想与附加行相同的位置）。如果您使用类，那么只需找到下拉列表的父行，然后找到具有要显示的适当类的相应子行。

# java - 如何在 Java 模式对话框之外拦截鼠标事件，

> ID：14573793
> 
> 赞同：0
> 
> 时间：2013-01-29T00:38:06.517
> 
> 标签：java, swing, dialog, awt, modal-dialog

我在 Java 中有一个模态对话框，想知道用户何时在对话框外（在应用程序的另一个窗口上）单击，而不是让它“blong”并闪烁边框。对于诸如选择颜色等之类的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:43:56.037

使对话框非模态，您仍然可以与应用程序的其余部分进行交互。

# git - 如何在“git-pull”自动合并后更改提交消息？

> ID：14573794
> 
> 赞同：5
> 
> 时间：2013-01-29T00:38:08.743
> 
> 标签：git, git-merge, git-remote, git-reset

有时，当作为结果 a 生成自动合并时，我的合作者会“惊慌” `git-pull`，并且只接受默认的提交消息。在推送此提交之前，我想确保消息得到修复，但`--amend`似乎不起作用。修复在这种情况下生成的消息的最佳方法是什么。我能为他们想出的最好的指示是

```
git reset --soft HEAD~
git merge -m <message> <the tracked remote branch> 
```

但这似乎有点吓人（`reset`）并且容易出错（必须明确输入远程跟踪的分支）。

有没有一种简单的方法来更改刚刚通过与远程跟踪 repo 合并生成的提交消息？为什么不起作用`--amend`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T05:45:31.680

`git commit --amend`应该在这种情况下工作。究竟什么不起作用？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-29T00:48:23.910

您始终可以尝试使用 git pull --rebase 将您的提交放在树的顶部。但是 git 对这种说法提出了警告。

“这是一种潜在危险的操作模式。它会重写历史，当您已经发布该历史时，这并不是一个好兆头。除非您仔细阅读 git-rebase(1)，否则不要使用此选项。” ( [http://git-scm.com/docs/git-pull](http://git-scm.com/docs/git-pull) )

如果您对消除合并历史感到满意，那么这是您的选择。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-29T01:26:19.177

`@{u}`是您的一个很好的替代品`<the tracked remote branch>`，然后您可以将两个步骤粘合在一起。也许您可以分发给他们的 shell 脚本，或者他们可以添加到他们的 shell 中的别名。

# c - 在写入文件之前检查文件是否存在，然后要求用 POSIX 在 C 中覆盖

> ID：14573797
> 
> 赞同：0
> 
> 时间：2013-01-29T00:38:37.583
> 
> 标签：c, file-io, error-handling, posix

好的，我有一个家庭作业，使用 POSIX API 在 C 中编写一个文件，该 API 要求读取一个文件名，一个要写入的文件名，然后将一个文件复制到另一个文件名。我已经这样做了，效果很好！我正在尝试进行一些错误检查，我想检查要写入的文件是否已经存在，如果存在，然后询问用户是否希望覆盖。问题是它总是声明文件存在，即使它不存在。该程序的其余部分工作得很好。我在这里阅读了很多内容，并在 POSIX 上找到了很多有用的东西，但找不到此类问题可供参考。下面是我的代码：

```
#include <fcntl.h>   // POSIX: give access to open
#include <unistd.h>  // POSIX: gives access to read, write, close
#include <stdio.h>   // POSIX: gives access to BUFSIZ

int main() {

int source = -1;
int target;
char sourcefile[50];
char targetfile[50];
char buff[BUFSIZ];
char ow[3];
size_t size;

printf("Please enter the name of the file you wish to read: ");
scanf( "%s", sourcefile );
printf( "\n" );
printf("Please enter the name of the file you wish to write to: ");
scanf( "%s", targetfile );
printf( "\n" );

source = open( sourcefile, O_RDONLY, 0);
//Test for existence of input file
if( source == -1 )
{
    perror( "Cannot find file" );
    return 1;
}
target = open( targetfile, O_WRONLY, 0644 );
//Test for existence of output file
if( target == 0 )
{
    perror( "File already exists" );
    printf( "Do you wish to overwrite? (yes or no): " );
    scanf( "%s", ow );

    if( strcmp( ow, "yes" ) == 0 )
    {
        target = open( targetfile, O_WRONLY | O_CREAT, 0644);   
    }else
    {
        printf( "Program Terminated!\n" );
        return 1;   
    }   
}else if( target == -1 )
{
    target = open( targetfile, O_WRONLY | O_CREAT, 0644);
}

while ((size = read(source, buff, BUFSIZ)) > 0) 
{
    write(target, buff, size);
}

close(source);
close(target);

return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T00:47:21.863

您可以使用`open(2)`with`O_EXCL`创建声称的新文件。如果文件已经存在，这将*失败；*在那种情况下会致命地中止。否则，您可以将所需的文件内容写入其中。

如果你想成为原子的，你可以将文件内容写入一个临时文件（使用`tmpfile`），然后用原子替换创建的文件`rename(2)`。这样，新文件要么是空的，要么是完整的副本。

* * *

另一种选择（由@R. 建议）是不打扰打开目标文件，复制到临时文件中，然后使用`link(2)`而不是`rename`尝试将新文件放在其目标位置。如果目的地已经存在，这将失败。这可能具有（有争议的）好处，如果其他人同时创建目标文件并且*没有像*我们一样小心谨慎，那么在这种情况下你会更温和一些。（但如果其他人想在你的文件系统周围不小心踩踏，你能做的就这么多了。）

# java - 来自 JAVA 的 MySQL：LOAD DATA INFILE 跳过输入文件中的行

> ID：14573798
> 
> 赞同：1
> 
> 时间：2013-01-29T00:38:43.443
> 
> 标签：java, mysql, bulkinsert, load-data-infile

我正在尝试使用 Java 将 1000 万行文本文件输入到 MySQL 表中。该文件有两列由空格字符分隔，我`LOAD DATA INFILE`用来将数据输入到一个有两列的表中。第一列包含一个整数，第二列包含一个 varchar。但是数据库中传入的数据不是1000万而是9981770。表的结构是：

```
st.execute("create table if not exists test 
    (id bigint NOT NULL, word varchar(80)) 
    ENGINE=MYISAM PARTITION BY KEY(word) PARTITIONS 40;"); 
```

我正在对表进行分区以加快插入速度，还因为我想稍后在 word 列上添加一个索引，因为我想检索特定单词的 id。我不认为这会导致问题。`LOAD DATA INFILE`命令是：

```
st.execute("LOAD DATA LOCAL INFILE '"+PATH+
    "' INTO TABLE test FIELDS TERMINATED BY ' ' LINES TERMINATED BY '\n';"); 
```

对于如何解决此问题的任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:43:41.360

我有两个建议给你：

1.  您应该检查错误日志以查找错误。
2.  将输出记录到一个文件中，并将其用于 'err' 字符。

    猫负载.log | grep -i 错误

我敢打赌，您会发现一个错误，解释了为什么没有插入某些行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:01:41.387

我认为可能是这些原因：

*   文本文件中的某些行没有用空格分隔
*   可能是某些行上的文本太长了
*   可能是第一列中的某些不是真正的整数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-11T17:07:21.517

我遇到了同样的问题，但在我的情况下，我在调用 LOAD DATA 之前用 Java 编写了 CSV 文件。但是，我忘记关闭 CSV 文件，因此在 LOAD DATA 开始之前它还没有完全写入磁盘。

# freebase - 在 freebase MQL 中，如何查询可能没有内容的属性？

> ID：14573809
> 
> 赞同：1
> 
> 时间：2013-01-29T00:40:07.033
> 
> 标签：freebase, mql

假设我正在尝试从电影中获取属性。我可以运行以下命令，它将返回一组演员：

```
{"type":"/film/film","id":"/m/05ggnq",
"starring":[{"mid":null,"actor":null,"character":null}]
} 
```

但是，当我尝试查询可能存在或不存在的另一个属性（“story_by”）时，我只会返回一个空的 200 响应。

```
{"type":"/film/film","id":"/m/05ggnq", "story_by":[{"mid":null}], 
"starring":[{"mid":null,"actor":null,"character":null}]
} 
```

我应该如何同时搜索这两个属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T02:25:58.170

您可以使用如下`optional`指令执行此操作：

```
{
  "type": "/film/film",
  "id":   "/m/05ggnq",
  "story_by": [{
    "mid":      null,
    "optional": true
  }],
  "starring": [{
    "mid":       null,
    "actor":     null,
    "character": null
  }]
} 
```

# iphone - 在呼叫输入期间检测电话号码

> ID：14573820
> 
> 赞同：1
> 
> 时间：2013-01-29T00:41:49.017
> 
> 标签：iphone, xcode

我需要在 iOS 上检测响铃期间的传入号码以将其用于操作。在 iPhone 中可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T00:43:15.650

不，Apple 不为此提供 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T03:03:22.107

不，它不可能在 iphone sdk 中跟踪来电。如果您使用一些私有 API 执行此操作，您的应用将被应用商店拒绝。

# java - 序列化 Integer 对象的大规模处理

> ID：14573822
> 
> 赞同：1
> 
> 时间：2013-01-29T00:42:06.650
> 
> 标签：java, c++, lucene, deserialization, large-data

我有以下格式的大型数据集：

总共有 3687 个目标文件。每个包含 2,000,000 条记录。每个文件大小为 42MB。

每条记录包含以下内容：

*   一个 id（整数值）
*   值 1（整数）
*   值 2（整数）
*   值 3（整数）

每个文件的内容不会以任何方式排序或排序，因为它们是在数据收集过程中观察到的。

理想情况下，我想为这些数据建立一个索引。（由 id 索引）这将意味着以下内容：

1.  将一组 id 划分为可管理的块。

2.  扫描文件以获取与当前工作组 id 相关的数据。

3.  建立索引。

4.  遍历下一个块并重复 1,2,3。

对我来说，这听起来不错，但来回加载 152GB 非常耗时，并且想知道最好的方法，甚至 Java 是否真的是用于此类过程的正确语言。

我的机器上有 256GB 的内存和 32 个内核。

* * *

**更新：** 让我修改一下，把 I/O 放在一边，假设文件在内存中的字节数组中。

解码具有 2,000,000 条记录且每条记录包含 4 个序列化的整数的 42MB 对象文件的最快方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:09:20.757

您对文件格式的选择非常糟糕。我会将很多从序列化整数转换为使用 DataOutputStream.writeInt() 编写的二进制整数，并使用 DataInputStream.readInt() 读取它们。在这两种情况下都有缓冲流。您将节省大量磁盘空间，从而也节省了 I/O 时间，并且还节省了所有序列化开销时间。并在将来更改您的收藏软件以使用此格式。转换需要一段时间，但它只发生一次。

或者按照建议使用数据库，再次使用本机整数而不是序列化对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:46:11.797

嗯..似乎更好的方法是使用某种 DBMS。将所有数据加载到数据库中，您可以利用其索引、存储和查询功能。当然，这取决于您的要求——以及现在的 DBMS 解决方案是否适合这个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T01:05:59.227

所以，我要做的只是加载每个文件并将 id 存储到某种排序结构中 - std::map 可能 [或 Java 的等价物，但考虑到读取文件名可能需要大约 10-20 行代码然后将文件的内容读入地图，关闭文件并请求下一个文件，我可能只是编写 C++ 来做到这一点]。

我真的不知道你还能/应该做什么，除非你真的想把它加载到一个 dbms 中——我不认为这是一个不合理的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T00:59:30.130

鉴于您的可用内存大于数据集，并且您想要非常高的性能，您是否考虑过 Redis？它非常适合对简单数据结构的操作，并且性能非常快。

在存储值时，请注意让 java 进行默认序列化。我以前遇到过我的原语在序列化之前自动装箱的问题。

# image - MATLAB中的部分卷积

> ID：14573824
> 
> 赞同：3
> 
> 时间：2013-01-29T00:42:17.287
> 
> 标签：image, matlab, image-processing, signal-processing, convolution

我有大矩阵（图像）和一个小模板。我想将小矩阵与较大的矩阵进行卷积。例如，蓝色区域是我想用于卷积的部分。换句话说，我可以对所有图像使用卷积，但由于 CPU 时间增加，因此，我想只关注所需的蓝色部分。

MATLAB 中是否有任何可用于此卷积的命令？或者，我如何强制卷积函数只使用特定的不规则部分进行卷积。

![在此处输入图像描述](../Images/dd72b6338a23bc7fcf490a9e85158378.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T00:31:24.487

@Nicole 我会选择 fft2(im).*fft(smallIm)，它相当于 conv2(im,smallIm)。
至于识别不规则形状，您可以使用像 canny 这样的边缘检测并找到最多（左、右、上、下）点的值，
因为 canny 返回二进制 (1,0) 图像并准备一个边界框，使用价值。但是，这将需要一些时间来创建。
而且我不确定这会快多少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:44:02.250

我怀疑你可以做一个不规则的形状（快速卷积是用 2D FFT 完成的，这需要一个正方形区域）。您可以通过找到形状的边界框并因此丢弃空边框来优化它。

# orchardcms - 在 OrchardCMS 中使用 Mustache 代替 Razor

> ID：14573826
> 
> 赞同：0
> 
> 时间：2013-01-29T00:42:36.910
> 
> 标签：orchardcms

在主题中使用 Mustache 模板（[http://mustache.github.com](http://mustache.github.com)）而不是默认的 Razor 语法是否可行？

由于我们使用的大多数前端开发人员都在必须使用 Razor 的 Mac 上造成开发瓶颈，我更喜欢使用可以跨平台呈现的模板引擎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T07:22:18.647

原则上，您可以使用与 ASP.NET MVC 兼容的任何视图引擎，但您确实不应该这样做。您将在每一步都与系统作斗争。您将找到的所有主题和模块（并且您将需要它们）以及核心中的所有视图都将使用 Razor。这只是一个非常非常糟糕的主意。

您应该尝试找到一个原生使用 Mustache 作为其默认模板语言的 CMS，或者学习 Razor。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-19T21:30:51.733

如果您愿意编写一些视图引擎服务（有一些陷阱），您可以使用它，并且您可以并排使用多个视图引擎（即您可以保留现有的 Razor 模板并在任何您想要的地方编写自己的模板） .

结果不一定很吸引人，但您可以[像 PHP 那样做](https://orchardscriptingphp.codeplex.com/SourceControl/latest#ViewEngine/PhpView.cs)。

# javascript - 在将函数分配给事件之前将函数存储在变量中是否有任何好处？

> ID：14573827
> 
> 赞同：0
> 
> 时间：2013-01-29T00:42:48.457
> 
> 标签：javascript

# 1

```
document.onkeydown = function(a) {
    //
}; 
```

# 2

```
var a = function(a) {
    //
};
document.onkeydown = a; 
```

我的想法是，可能在第一种情况下，每次事件发生时都需要*重新解析函数（因为没有更好的词），而在第二种情况下，它只是指向已经**解析*的函数。

如果不是这样，也许还有另一个（任何）差异。

**更新**

如果我理解正确的话，这些之间是有区别的，最好使用第二个。

# 1

```
var a = window.onresize = function() {
    //
};
// ...
a(); 
```

# 2

```
var a = function() {
    //
};
window.onresize = a;
// ...
a(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T00:43:18.533

在您当前的形式中，没有区别（匿名函数甚至可能*更快*一点）。单独存储函数的唯一优点是当您在循环中执行它时（或者该函数可能有其他用途）。

* * *

例如：

```
var elements = document.getElementsByTagName('input');

for ( var i = 0; i < elements.length; i++ ) {
    element[i].onkeydown = function () {
        // whatever
    }
} 
```

每个元素都会获得自己的函数副本，这会增加页面的内存使用量。

如果您将函数存储在循环之外：

```
var elements = document.getElementsByTagName('input');
var eventListener = function () {
    // whatever
};

for ( var i = 0; i < elements.length; i++ ) {
    element[i].onkeydown = eventListener;
} 
```

它们都将共享相同的功能。

* * *

**PS**正如@VisioN 所指出的，更好的方法是使用[`addEventListener`](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener). 同样的规则也适用于那里。

# ios - iOS 操作系统进程管理

> ID：14573831
> 
> 赞同：0
> 
> 时间：2013-01-29T00:43:14.497
> 
> 标签：ios, operating-system, core-services

是否有一些资源可以描述 iOS 的低级操作系统信息？查看苹果文档，似乎他们没有详细介绍内核如何管理进程等。

所以，更准确地说，我想我有兴趣了解 iOS 如何处理进程。

我可以去哪里寻找这方面的文件？它甚至在外面吗？或者它是否包含在其他一些信息中（即，由于它是基于 Unix，内核实现了类似的进程管理）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:52:00.317

这几乎是无证的，因为 Apple 希望自由地在低级别调整系统，如果很多应用程序开始使用低级别接口，你就无法做到这一点。

也就是说，由于 iOS 是基于 Mac OS X 的，你可以通过研究[Mac OS X 的开源部分](http://www.opensource.apple.com)学到很多东西。

[Mac OS X Internals](http://osxbook.com)这本书也提供了很多关于 Mac OS X 的系统级深度信息。

# sql - SSRS 中的“后续参数”错误？

> ID：14573832
> 
> 赞同：1
> 
> 时间：2013-01-29T00:43:15.140
> 
> 标签：sql, reporting-services, ssrs-2008

我在 SSRS 中遇到了一个奇怪的错误，在一个带有许多下拉参数的报告（它被放入一个存储过程中）中：

```
Query execution failed for dataset 'DataSet1'.

Must pass parameter number 3 and subsequent parameters as '@name = value'. After the form '@name = value' has been used, all subsequent parameters must be passed in the form '@name = value' 
```

我对这里发生的事情一无所知 - 是什么意思`@name = value`。

我在网上搜索，有人提到你应该改变存储过程？

这是我的存储过程的上半部分的外观：

```
USE [FederatedSample]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[prc_RPT_Select_BI_Completes_Data_View_2]

    @FromDate DATETIME,
    @ToDate DATETIME,

    @AccountIDs VARCHAR(max) = null,
    @ClientIDs VARCHAR(max) = null,
    @SupplierIDs VARCHAR(max) = null,

    @CompleteType INT = NULL,
    /*
     * 0 - Routed
     * 1 - Targeted
     * 2 - Offerwall
     */

    @SourceType BIT = NULL,
    /*
     * Works if @AccountID is not null
     * (should only be used if @AccountID has a single value)
     *
     * 0 - Owned by @AccountID
     * 1 - External (not owned by @AccountID)
     */

    @SurveyStatus INT = NULL,
    /*
     * NULL - All Surveys
     * 0 - Completes Approved Surveys
     * 1 - Invoiced Surveys
     */

    @IsSupplierUser BIT = 0
    /*
     * used to decide whether to display FEDSurveyName or SupplierSurveyName
     */
AS
BEGIN
    SET NOCOUNT ON

    DECLARE @SQL NVARCHAR(MAX) = N'',
            @Params NVARCHAR(MAX)

    IF @AccountIDs is not null
    BEGIN
        SET @SQL += N'DECLARE @AccountIDs VARCHAR(MAX) = @pAccountIDs; '
    END

    IF @ClientIDs is not null
    BEGIN
        SET @SQL += N'DECLARE @ClientIDs VARCHAR(MAX) = @pClientIDs; '
    END

    IF @SupplierIDs is not null
    BEGIN
        SET @SQL += N'DECLARE @SupplierIDs VARCHAR(MAX) = @pSupplierIDs; '
    END

    SET @SQL +=  N'
        SELECT   bi.SupplierID as ''Supplier ID''
                ,bi.SupplierName as ''Supplier Name''

                ,bi.PID as ''PID''
                ,bi.RespondentID as ''Respondent ID''

                ,lk_slt.Name as ''Entry Link Type''

                ,ts.SurveyNumber as ''Initial Survey ID''' 
```

稍后在存储过程中。它会做这样的事情来分割字符串：

```
IF @AccountIDs is not null 
BEGIN
    SET @SQL += CHAR(13) + CHAR(9)
    SET @SQL += N' and bi.AccountID in (SELECT CAST(val as INT) FROM dbo.Split(@AccountIDs, '',' 
```

![在此处输入图像描述](../Images/a811d7b78801793905f6d7e2e93382d6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:53:42.967

调用存储过程时，您可以按位置（不是一个好主意）或按名称（恕我直言，更好的方法）传递参数。

```
EXEC dbo.MyStoredProcedure '12/31/2012', 1;  -- Not a great way to pass parameters 

EXEC dbo.MyStoredProcedure @AsOfDate = '12/31/2012', @AccountID = 1; -- A better way 
```

从您收到的错误消息中，我怀疑 SSRS 正在使用第二种方法，并且在将第三个参数提供给存储过程时遇到了问题。

如果没有更多信息，很难为您提供错误的准确解释（存储过程可能会有所帮助），有根据的猜测是提供参数的方式`Account IDs, Client IDs and Supplier IDs`并不完全正确。具体来说，我认为问题*可能*在于您提供了多个用逗号分隔的标识符。

您可以尝试传递一个帐户 ID、客户 ID 和供应商 ID，以查看您是否仍然收到错误。我还会尝试查看存储过程（或与编写它的 DBA \ Developer 交谈）以确定存储过程的预期用途。

# ruby - 如何在编写 CSV 时跳过标题？

> ID：14573835
> 
> 赞同：4
> 
> 时间：2013-01-29T00:43:24.123
> 
> 标签：ruby, csv

我正在编写一个 CSV 文件并`CSV.dump`输出两个我不想要的标题行。

我尝试设置`:write_headers => false`但它仍然输出一个标题：

```
irb> A = Struct.new(:a, :b)
=> A
irb> a = A.new(1,2)
=> #<struct A a=1, b=2>
irb> require 'csv'
=> true
irb> puts CSV.dump [a], '', :write_headers => false, :headers=>false
class,A
a=,b=
1,2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:51:53.487

我认为您不能使用选项参数来做到这一点。但是你可以通过不使用 generate 方法轻松完成你想要的

```
irb> arr = [a, a]
=> [#<struct A a=1, b=2>, #<struct A a=1, b=2>]
irb> csv_string = CSV.generate do |csv|
irb*   arr.each {|a| csv << a}
irb> end
irb> puts csv_string
1,2
1,2
=> nil 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T03:10:42.960

我认为问题有两个方面：

```
CSV.dump [a] 
```

将结构的一个实例包装`a`在一个数组中，然后 CSV 尝试对其进行编组。虽然有时这可能很有用，但当尝试生成一个 CSV 文件以供其他识别 CSV 的非 Ruby 应用程序使用时，您最终会得到无法使用的值。查看输出，它不是 CSV：

```
类，A
a=,b=
1,2

```

在 IRB 中查看它显示：

```
=> "class,A\na=,b=\n1,2\n" 
```

同样，它不会被电子表格或数据库之类的东西所接受。因此，需要另一种策略。

从中删除数组`a`无济于事：

```
CSV.dump a
=> "class,Fixnum\n\n\n\n" 
```

换一种方式，我研究了一种从数组生成 CSV 的标准方法：

```
puts a.to_a.to_csv
=> 1,2 
```

创建它的另一种方法是：

```
CSV.generate do |csv|
  csv << a.to_a
end
=> "1,2\n" 
```

# android - 防止对 Android 应用中用于 HTTP 请求的 URL 进行逆向工程

> ID：14573844
> 
> 赞同：0
> 
> 时间：2013-01-29T00:44:40.860
> 
> 标签：android, security

我正在设计一个使用 HTTP 连接从我的服务器请求数据的应用程序。

此数据取决于所选项目，因此我的服务器上有与所选项目相对应的不同 URL。

现在我已经对应用程序中的 URL 进行了硬编码，我是 Android 新手，所以我的问题是：

如何防止对这些 URL 进行逆向工程？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T02:12:38.517

如果您要从任何设备（在您的情况下为 android）发送一些敏感数据，则在隐藏的 URL 上进行中继不会给您的应用程序带来任何安全性。

起初你可以使用 SSL 协议，SSL 会加密你和你的服务器之间的数据，所以嗅探器将无法读取任何数据。当您从 android 设备发送数据时，您必须验证 SSL 证书以防止 MITM 攻击。

此外，为了提高安全性，您可以在数据中包含一些对称或非对称加密算法。您可以在使用公钥将数据发送到服务器之前对其进行加密，并且只有您的服务器才有私钥。因此，您可以使用该私钥解密服务器中的数据。PHP中有很多用于openssl API的资源。

如果你不能使用公钥加密算法，你可以使用像 AES 这样的对称算法。它也将是安全的。但是加密密钥应该保持安全，例如您可以使用基本的非对称加密实现密钥交换算法，将加密密钥传输给客户端，然后使用 AES 加密数据。

最好的安全性可能是使用 SSL，也可以使用对称和非对称加密算法加密数据。

这完全取决于您的实施和保护数据的努力。

# python - Python，if 语句和浮点数

> ID：14573849
> 
> 赞同：2
> 
> 时间：2013-01-29T00:45:16.437
> 
> 标签：python, if-statement

我在 Python 中有一个读取 ds18b20 温度传感器的函数。传感器在我读取它的大约 5% 的时间里给我一个错误值 (-0.062)。这不是问题，但我不想记录该值，因为它在我的图表中看起来很难看。

我无法设法“捕获” if 语句中的值以将其替换为“#error”。下面的代码运行良好，但似乎 if 语句有问题并且不起作用 - 它只是运行 else 下的所有内容。

我已经尝试了所有方法，甚至“捕捉”了 1000 到 1500 之间的所有值（除以 1000 之前的当前温度读数），以检查它是否适用于任何温度，但事实并非如此。

有谁知道为什么我的 if 语句不起作用？

```
 def readtwo():
    tfile = open("/sys/bus/w1/devices/28-0000040de8fc/w1_slave")
    text = tfile.read()
    tfile.close()
    secondline = text.split("\n")[1]
    temperaturedata = secondline.split(" ")[9]
    temperature = float(temperaturedata[2:])
    temperature = temperature / 1000
    if temperature  == -0.062:
            return("#error")
    else:
            return(temperature) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T01:01:22.637

测试基数 10`float`的（不）相等性几乎总是错误的做法，因为它们几乎总是不能在二进制系统中精确表示。

从我看到的你的代码片段来看，你应该与字符串进行比较，如果它不是可怕的 -0.062，则转换为浮点数：

```
def readtwo():
    tfile = open("/sys/bus/w1/devices/28-0000040de8fc/w1_slave")
    text = tfile.read()
    tfile.close()
    secondline = text.split("\n")[1]
    temperaturedata = secondline.split(" ")[9]
    temperature = temperaturedata[2:]
    if temperature == '-0062':
            return("#error")
    else:
        temperature = float(temperature) / 1000
        return(temperature) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:57:13.453

不管我对 decimal 模块的评论如何，浮点 arithemitc 都有它的问题（在 python[中也是如此](http://docs.python.org/2/tutorial/floatingpoint.html)）。其中最重要的是，由于表示错误，纸上相等的两个数字在程序比较时将不相等。

绕过它的方法是查看两个数字之间的相对误差，而不是简单地比较它们。

在伪：

```
if abs(num1 - num2)/ abs(num2) < epsilon:
    print "They are close enough" 
```

在你的情况下：

```
if abs(temparture + 0.062)/0.062 < 10**-3:
    return("#error") 
```

基本上，我们检查数字是否“足够接近”以被认为是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:08:15.440

您也许还可以稍微清理一下其余代码：

```
def readtwo():

    with open("/sys/bus/w1/devices/28-0000040de8fc/w1_slave", 'r') as f:
        secondline = f.readlines()[1]
    temp = secondline.split(' ')[9][2:]

    if '-62' in temp:
        return '#error'
    else:
        return float(temp)/1000 
```

# sorting - c/c++ qsort/std::sort 在 freepascal 中等效

> ID：14573857
> 
> 赞同：0
> 
> 时间：2013-01-29T00:46:04.963
> 
> 标签：sorting, pascal, freepascal

是否有任何内置排序函数可以对数组（字符串或整数）进行排序`freepascal`？

在 c/c++ 中有 std::sort(any_arr) 或 qsort(any_arr) 可以做到这一点。

在 Javascript 或 ruby​​ 中有 .sort 方法..

什么是对象帕斯卡？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T09:39:59.337

泛型函数是目前处于规划阶段的主题。目前大多数列表类型（如 benibela 所说）都有自己的排序和自定义排序选项。

一些通用容器类型（如单元 fgl 中的 tfpsmap）可能具有通用排序例程，但通常使用单独的比较函数指针/变量来确定顺序。

# jquery - Jquery 帮助：在 slickquiz 上调用图像行为（自定义）

> ID：14573861
> 
> 赞同：0
> 
> 时间：2013-01-29T00:46:17.383
> 
> 标签：jquery, slickquiz

我在我的一个项目上尝试了 slickquiz，并在每个问题上添加了图像和所有内容。

但是，如果您能指出如何在图像进入下一个问题之前延迟图像，我想寻求帮助。

行为是每次单击“检查答案”时，它都会自动切换到下一个，因为 ID 确实已经更改。

我想要的是仅在加载下一个问题后才更改图像。

完整代码位于：http: [//bin.cakephp.org/saved/87152](http://bin.cakephp.org/saved/87152)

现场样本：[http ://aacenter.com/surveys/index/1](http://aacenter.com/surveys/index/1)

更改图像的代码片段：

```
if (qPos == 'question0') {
                    //console.log('search: ' + qPos + ', found.');
                    $('#progressbar').progressbar('option', 'value', 10);
                    $('.questionImage #qImgSrc').attr('src', '/themed/aac-theme/img/quizzes/s' + surveyId + 'q02.jpg');
                }
                else if (qPos == 'question1') {
                    //onsole.log('search: ' + qPos + ', found.');
                    $('#progressbar').progressbar('option', 'value', 20);
                    $('.questionImage #qImgSrc').attr('src', '/themed/aac-theme/img/quizzes/s' + surveyId + 'q03.jpg');
                } 
```

代码运行良好，但只是提前更改图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T00:34:00.870

能够进行修复。而不是依赖于每次点击的行为。因为，slickquiz 确实加载了 <li>，然后只是显示和隐藏。最初，我还必须加载正确的图像。

修复非常简单。

```
questionHTML.append('<div class="questionImage"><img id="qImgSrc" src="/themed/aac-theme/img/quizzes/s' +surveyId+ 'q0' + count + '.jpg" border="0" width="300" height="120" alt="" />' + '</div>'); 
```

对于任何需要此代码的人，它已被修改为也有一个 jquery ui 进度条。

享受！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-01-18T06:02:24.357

```
'questionHTML.append('' + '');'
```

# sql - 按问题分组

> ID：14573863
> 
> 赞同：1
> 
> 时间：2013-01-29T00:46:37.500
> 
> 标签：sql

以下是个人资料答案表：

```
profile_id | answer_id
----------------------
1                1
1                4
1               10 
```

这是一个表格，其中包含民意调查受访者的回复列表：

```
user_id | answer_id
-------------------
1            1
1            9
2            1
2            4
2           10
3           14
3           29 
```

我想返回答案在 (6,9) 和 (1,10) 中的用户列表，基本上所有与配置文件 1 匹配的答案。

如何编写此选择查询？

我尝试了以下方法，但显然我不太了解 group by 的工作原理：

```
SELECT DISTINCT  [user_id]
FROM             [user_question_answers] a
GROUP BY         a.[user_id]
HAVING           a.[answer_id] IN (6,9)
AND              a.[answer_id] IN (1,10) 
```

编辑：仅返回 user_id 1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:58:36.667

您的查询很接近。. .

```
SELECT           [user_id]
FROM             [user_question_answers] a
GROUP BY         a.[user_id]
HAVING           max(case when a.[answer_id] IN (6,9) then 1 else 0 end) = 1
AND              max(case when a.[answer_id] IN (1,10) then 1 else 0 end) = 1 
```

# c# - InvalidCastException：指定的转换在 LINQ 查询中无效

> ID：14573864
> 
> 赞同：0
> 
> 时间：2013-01-29T00:46:43.123
> 
> 标签：c#, linq, entity-framework, exception-handling, linq-to-entities

我在此方法中收到 Specified cast is not valid 错误

```
public Dictionary<byte, string> getTeamList(int id1, Dictionary<byte, int> myList)
{    
    Dictionary<byte, string> result = new Dictionary<byte, string>();
    var query= _dataContext.usp_getItem();
    foreach(var item in query)
    {
        if (myList.ContainsKey(item.ID)
        {
            int count= _dataContext.usp_getCountPerID(id1, item.ID).FirstOrDefault().Count;
            if (myList[item.ID] > count)
            {
                result.Add(item.ID, item.Name);
            }
        }
        else
        {
            result.Add(item.ID, item.Name);
        }
    }
    return result;
} 
```

我在这一行收到 InvalidCastException 错误：

```
int count = _dataContext.usp_getCountPerID(item.ID).FirstOrDefault().Count; 
```

Count 的类型是 int。当我注释掉这行代码时它起作用了。

**更新**

usp_getCountPerID 如下所示：

```
@ID1 INT,
@ID2 TINYINT
SELECT COUNT(ID) AS Count  //I'm changing this name so it's actually not "Count"
FROM   Table
WHERE  ID1 = @ID1
       AND ID2 = @ID2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:23:36.540

如果您从数据库中返回计数，您可能必须转换为`int`

也许

```
int count = (int)_dataContext.usp_getCountPerID(item.ID).FirstOrDefault().Count; 
```

或者

```
int count = Convert.ToInt32(_dataContext.usp_getCountPerID(item.ID).FirstOrDefault().Count); 
```

如果失败了，你也可以检查`type`对象`Count`是什么，这可能有助于找出发生了什么。

```
var count = _dataContext.usp_getCountPerID(item.ID).FirstOrDefault().Count;
Type t = count.GetType(); 
```

或者也许数据库正在返回`null`，所以试试

```
int? count = (int?)_dataContext.usp_getCountPerID(item.ID).FirstOrDefault().Count; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T18:20:04.777

这可能不是最好的解决方案，但我改变了我的存储过程来计算：

```
@SessionID INT
SELECT ID, COUNT(Member) AS Count
FROM   Table
WHERE  SessionID = @SessionID 
GROUP BY ID 
```

它返回一个包含 ID 和每个 ID 的成员总数的表

因此，我没有在 foreach 循环中获取每个 ID 的计数值，而是在进入 foreach 循环之前检索 ID 和 Count 的列表，这很有效。

我仍然不明白为什么我会收到投射错误，所以如果有人能解释我错过了什么，我会将其标记为答案。

非常感谢您的帮助。

# android - Android Activity 中的变量状态

> ID：14573865
> 
> 赞同：1
> 
> 时间：2013-01-29T00:46:43.990
> 
> 标签：android, global-variables

我在活动中定义了一个全局变量，该变量根据用户按下的按钮而变化。

如果我离开我的应用程序 UI 并通过按住显示最近应用程序列表的主页按钮返回，那么我的变量将保持其状态，但如果我通过按下应用程序 aicon 再次运行我的应用程序，则变量状态消失了。

有没有办法保持变量的状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T00:49:30.440

[`onSaveInstanceState()`](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)您可以在回调期间保存变量的值。然后使用传递给并[`onCreate()`](http://developer.android.com/reference/android/app/Activity.html#onCreate%28android.os.Bundle%29)恢复值的“icicle”参数。您可能有兴趣阅读[管理活动生命周期](http://developer.android.com/training/basics/activity-lifecycle/index.html)。

另请注意，Java 有类变量和成员变量，但没有全局变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:14:27.400

正如@Code-Guru 所说，您可以使用它`onSaveInstanceState()`来保存变量的值。

另一种简单的方法是在静态类中创建一个静态成员来存储变量。只要应用程序在内存中，静态类就存在。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T02:36:54.827

您可以考虑使用[共享首选项](http://developer.android.com/training/basics/data-storage/shared-preferences.html)此类用于存储和检索简单数据。

# makefile - 将目标名称传递给makefile中的依赖项

> ID：14573869
> 
> 赞同：6
> 
> 时间：2013-01-29T00:47:27.490
> 
> 标签：makefile, gnu-make

如果我在生成文件中有以下规则：

```
$(OBJ)/%.o: $(SRC)/%.c
    $(CC) -c -o $@ $< $(CFLAGS) 
```

每个匹配前缀`./obj/`和后缀的文件`.o`都会将其词干传递给`%`，因此我可以根据其名称提供一些依赖项。

但是，假设我有这样的规则，我会一一指定我想要的目标：

```
OBJECTS=abc.o bca.o cba.o
$(OBJECTS): $(SRC)/%.c
    $(CC) -c -o $@ $< $(CFLAGS) 
```

如何使`%`词干真正适用于当前目标名称*make*正在执行？只是使用`%`是行不通的，也不行`$@`。

请注意，我正在尝试将实际目标名称写入它自己的依赖项。例如，当*make*为 执行规则时`abc.o`，它将包含`$(SRC)/abc.c`并且仅包含它（类似于`$(patsubst %.o, $(SRC)/%.c, MAGIC_TARGET_NAME_VARIABLE)`）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-29T01:06:35.607

您可以替换此规则：

```
$(OBJECTS): $(SRC)/%.c 
```

和：

```
$(OBJECTS) : %.o : $(SRC)/%.c 
```

如果您仍然希望它们在那里构建，您将需要将它们添加`$(OBJ)`到`-o`配方的一部分：

```
$(OBJECTS) : %.o : $(SRC)/%.c
     $(CC) -c -o $(OBJ)/$@ $< $(CFLAGS) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T01:02:11.247

我不完全清楚你在问什么，但我认为这完成了你想要做的事情：

```
OBJECTS=abc.o bca.o cba.o

.PHONY: all
all: $(OBJECTS:%=obj/%)

$(OBJ)/%.o: $(SRC)/%.c
    echo $(CC) -c -o $@ $< $(CFLAGS) 
```

所有`.o`文件都已构建；每个`.o`文件仅使用`.c`与其对应的文件构建；如果要在编译`.o`文件的命令中引用所有目标文件或源文件的列表，则可以`${OBJECTS}`直接引用。

* * *

如果这不是您想要做的，您将能够通过列出您拥有的输入文件、您想要制作的输出文件、每个输出文件的输入依赖项以及什么编译来获得更好的答案您要为每个输出文件执行的命令。

# ruby - Ruby 的方法查找路径

> ID：14573871
> 
> 赞同：2
> 
> 时间：2013-01-29T00:47:43.917
> 
> 标签：ruby

我正在阅读“Well Grounded Rubyist”一书，我对方法查找路径有疑问：

```
module M
  def report
    puts "'report' method in module M"
  end
end

module N
  def report
    puts "'report' method in module N"
  end
end

class C
  include M
  include N
  def report
    puts "'report' method in class C"
    puts "About to call super..."
    super
    puts "Back from super..."
  end
end

obj = C.new
obj.report 
```

根据我的理解，obj.report 会输出：

```
'report' method in class C
About to call super...
'report' method in module N
Back from super... 
```

但是，我很好奇是否可以通过在类 C 中绕过 N 的报告来调用 M 的报告方法。我知道如果我在模块 N 中添加“super”，它将调用 N 的报告，然后是 M 的报告，然后再放入“从超级回来......”但是有没有办法直接从 C 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T01:05:42.660

您可以使用祖先反射：

```
class C
  def report
    my_ancestors = self.class.ancestors
    puts "my ancestors are: #{my_ancestors}"
    method = my_ancestors[2].instance_method(:report)
    method.bind(self).call
  end
end

C.new.report
=> my ancestors are: [C, N, M, Object, PP::ObjectMixin, Kernel, BasicObject]
=> 'report' method in module M 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:57:49.833

这可行，但我觉得必须有更好的方法来做到这一点，而无需将其更改为 self：

```
module M
   def self.report
      puts "'report' method in module M"
   end
end

Class C
include M
include N
def report
   puts "'report' method in class C"
   puts "About to call M.report..."
   M.report
   puts "About to call super..."
   super
    puts "Back from super..."
 end
 end 
```

输出将是：

```
'report' method in class C
About to call M.report...
'report' method in module M
About to call super...
'report' method in module N
Back from super... 
```

# function - 如何将对象类型的集合作为 PowerShell 中的参数传递给函数？

> ID：14573875
> 
> 赞同：1
> 
> 时间：2013-01-29T00:48:01.007
> 
> 标签：function, powershell, parameter-passing

这是我的代码：

```
function Get-OSInfo {
    param([string]$Computer)
    $OS = gwmi -class Win32_OperatingSystem -computer $Computer
    $OS | Add-Member –MemberType NoteProperty –Name OSType –Value ""
    $OS.OSType = Get-OSType -Input $OS
    write $OS
}

function Get-OSType {
    param([?]$Input)
    if ($Input.ProductType -eq 1) {
        write "Client OS"
    }
}

$blah = Get-OSInfo -Computer mypc
$blah | fl * 
```

我意识到这可以通过单个函数（或在脚本本身的主体中）来完成，但我已经简化了函数以突出我遇到的麻烦。我想要做的是将 Get-OSInfo 函数中的 gwmi 数据集作为 Get-OSType 中的参数变量传递，这样我就可以在第二个函数中引用它的所有属性，而无需从第一个函数中单独传递它们。清如泥？

我尝试了多种参数加速器类型，`[ref]`, `[array]`,`[object[]]`等，但我没有找到任何可以用作参数的东西。唯一被证明有效的方法是更改`args[0]`​​用于接受输入的第二个函数，但这不像使用参数那样干净，而且由于它有效，我不禁认为有一个参数应该作为出色地。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:08:33.177

避免`$input`在函数中使用 as 具有特殊含义（表示管道输入）。只需将参数重命名为`$OS`.

文档（man about_automatic_variables）`$input`说：

> 包含一个枚举器，它枚举传递给函数的所有输入。$input 变量仅可用于函数和脚本块（它们是未命名的函数）。在函数的 Process 块中，$input 变量枚举当前在管道中的对象。当 Process 块完成时，管道中没有任何对象，因此 $input 变量枚举一个空集合。如果函数没有 Process 块，则在 End 块中，$input 变量枚举该函数的所有输入的集合。

# c - 如何在 C 中使用函数打印二维数组？

> ID：14573876
> 
> 赞同：0
> 
> 时间：2013-01-29T00:48:01.110
> 
> 标签：c, arrays, function, printing, 2d

我正在尝试使用函数打印二维数组，但我不断收到错误消息`"pointer expected"`

我正在尝试制作一个战舰类型的网格。我可以打印出坐标行和列，但我实际上根本无法打印二维数组（每个元素中都包含“.”）。

任何帮助将不胜感激，我对此很陌生。谢谢！:)

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int length;
int width;
int i;
int j;
char invisible_board;

void board_setup(int *rows, int *columns){
    char *invisible_board[*rows][*columns];
char *player_board[*rows][*columns];

for (i = 0; i < *rows; i++){
    for (j = 0; j < *columns; j++){
        invisible_board[i][j] = ".";    //Sets all elements in hidden board to water
    }       
}

for (i = 0; i < *rows; i++){
    for (j = 0; j < *columns; j++){
        player_board[i][j] = ".";
    }
}
}

void display(int *rows, int *columns, char *invisible_board){

printf("   ");
for (i=1; i < *rows +1;i++){
    printf("%d  ",i);
}
printf("\n");                       //Prints top row of co-ordinates

for (i=1; i < *columns+1;i++){
    printf("%d ",i);
    for (j=0;j < *columns;j++){         //Prints left column of co-    ordinates and rows of game board
            printf(" %c ",invisible_board[i-1][j]);
        }
        printf("\n");
        }

}

int main(void){

    printf("Please enter the amount of rows in your board\n");
    scanf("%d",&length);
    printf("Please enter the amount of columns in your board\n");
    scanf("%d",&width);

    board_setup(&length,&width);
    display(&length,&width,&invisible_board);

    return (0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:05:46.563

这是我可以对您的代码进行的最简单的更改，以让您使用工作代码....现在....这还不是好的代码。但让你开始。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

int length;
int width;
int i;
int j;
char invisible_board[100][100];   // dynamically allocate....
char player_board[100][100];   // dynamically allocate....

void board_setup(int *rows, int *columns){  
    for (i = 0; i < *rows; i++){
        for (j = 0; j < *columns; j++){
            invisible_board[i][j] = '.';    //Sets all elements in hidden board to water
        }       
    }

    for (i = 0; i < *rows; i++){
        for (j = 0; j < *columns; j++){
            player_board[i][j] = '.';
        }
    }
}

void display(int *rows, int *columns){

    printf("   ");
    for (i=1; i < *rows +1;i++){
        printf("%d  ",i);
    }
    printf("\n");                       //Prints top row of co-ordinates

    for (i=1; i < *columns+1;i++){
        printf("%d ",i);
        for (j=0;j < *columns;j++){         //Prints left column of co-    ordinates and rows of game board
            printf(" %c ",invisible_board[i-1][j]);
        }
        printf("\n");
    }

}

int main(void){

    printf("Please enter the amount of rows in your board\n");
    scanf("%d",&length);
    printf("Please enter the amount of columns in your board\n");
    scanf("%d",&width);

    board_setup(&length,&width);
    display(&length,&width);

    return (0);
} 
```

# javascript - 为什么 JavaScript navigator.appName 为 Safari、Firefox 和 Chrome 返回 Netscape？

> ID：14573881
> 
> 赞同：52
> 
> 时间：2013-01-29T00:48:59.067
> 
> 标签：javascript, html, firefox, dom, browser

为什么`navigator.appName`Safari、Firefox 和 Chrome 会返回“Netscape”？

他们与旧浏览器网景有什么关系？难道是因为DOM0？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-29T01:00:40.030

是的，那是为了兼容性问题，不能依赖。
**MDN**说：*“这最初是 DOM Level 0 的一部分，但后来被包含在 HTML5 规范中。”*

请参阅此处的[**Mozilla**文档](https://developer.mozilla.org/en-US/docs/DOM/window.navigator.appName)。

顺便提一句; 这就是为什么这不能用于浏览器检测。**浏览器检测是一种不好的做法**，您应该尽可能避免使用它。改为进行**[特征检测](http://jibbering.com/faq/notes/detect-browser/)**。但是，如果有人坚持这一点；他们应该改用该`userAgent`属性。

***更新1****：根据[兼容性更改](http://msdn.microsoft.com/en-us/library/ie/bg182625(v=vs.110).aspx)；**IE11**现在还返回属性，`"Netscape"`以`navigator.appName`反映 HTML5 标准并匹配其他浏览器的行为。[另请参阅此处](http://msdn.microsoft.com/en-us/library/ie/hh869301(v=vs.85).aspx)`userAgent`的字符串更改...更多关于特征检测[的信息](http://msdn.microsoft.com/library/ie/hh273397.aspx)...*

***更新 2****：**Microsoft Edge**也返回`"Netscape"`.`navigator.appName`*

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-29T01:06:16.937

根据 Johnny Stenback 的帖子：

> 这在很久以前在 mozilla 新闻组上进行了辩论，并决定即使在 mozilla 中 navigator.appName 也应该返回“Netscape”，因为如果要更改使用某些浏览器嗅探代码的网络上的每个页面（这是一个巨大的部分）当前网络的）需要识别 mozilla，而这不会发生，也没有理由这样做，因为 mozilla == netscape == mozilla 就内容开发人员而言。

来源[在这里](https://bugzilla.mozilla.org/show_bug.cgi?id=61071)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-12T10:17:16.880

从 IE11 开始，Explorer 现在在调用 navigator.appName 时也会返回“Netscape”；

*更新* 虽然这个答案现在已经过时了，但这里是上述声明的链接：[https ://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/dev-guides /bg182625(v=vs.85)?redirectedfrom=MSDN#legacy-api-additions-changes-and-removals](https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/dev-guides/bg182625(v=vs.85)?redirectedfrom=MSDN#legacy-api-additions-changes-and-removals)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-12T15:34:10.937

现在只需搜索 navigator.userAgent 以查找 IE 11 的浏览器检测，然后查找其布局引擎。根据我的经验，它运作良好。看到这个[帖子](https://stackoverflow.com/questions/20911175/ie-11-browser-recognizes-itself-as-mozilla)。

# python - Scrapy SgmlLinkExtractor

> ID：14573886
> 
> 赞同：1
> 
> 时间：2013-01-29T00:49:42.300
> 
> 标签：python, regex, scrapy

我正在尝试让爬虫工作，但 SgmlLinkExtractor 似乎存在问题。

这是签名：

> SgmlLinkExtractor(allow=(), deny=(), allow_domains=(), deny_domains=(), restrict_xpaths(), tags=('a', 'area'), attrs=('href'), canonicalize=True,唯一=真，过程值=无）

我正在使用 allow() 选项，这是我的代码：

```
start_urls = ['http://bigbangtrans.wordpress.com']
rules = [Rule(SgmlLinkExtractor(allow=[r'series-\d{1}-episode-\d{2}.']), callback='parse_item')] 
```

示例 url 看起来像[http://bigbangtrans.wordpress.com/series-1-episode-11-the-pancake-batter-anomaly/](http://bigbangtrans.wordpress.com/series-1-episode-11-the-pancake-batter-anomaly/)

`scrapy crawl tbbt`包含的输出

> [tbbt] 调试：已爬网（200）http://bigbangtrans.wordpress.com/series-3-episode-17-the-precious-fragmentation/>（参考：[http](http://bigbangtrans.wordpress.com) ://bigbangtrans.wordpress.com ）

但是，没有调用 parse_item 回调，我不知道为什么。

这是整个蜘蛛代码：

```
from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector

class TbbtSpider(CrawlSpider):
    #print '\n TbbtSpider \n'
    name = 'tbbt'
    start_urls = ['http://bigbangtrans.wordpress.com'] # urls from which the spider will start crawling
    rules = [Rule(SgmlLinkExtractor(allow=[r'series-\d{1}-episode-\d{2}.']), callback='parse_item')]

    def parse_item(self, response):
        print '\n parse_blogpost \n'
        hxs = HtmlXPathSelector(response)
        item = TbbtItem()
        # Extract title
        item['title'] = hxs.select('//div[@id="post-5"]/div/p/span/text()').extract() # XPath selector for title
        return item 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:23:35.447

好的，所以这段代码不起作用的原因是因为您的规则的语法不正确。我修复了语法而没有进行任何其他更改，并且我能够点击`parse_item`回调。

```
rules = (
    Rule(SgmlLinkExtractor(allow=(r'series-\d{1}-episode-\d{2}.',),
        ), 
        callback='parse_item'),
    ) 
```

然而，标题都是空白的，这表明其中的`hxs.select`陈述`parse_item`是不正确的。下面的 xpath 可能更合适（我对所需的标题做了一个受过教育的猜测，但我可能完全找错了树）

```
item['title'] = hxs.select('//h2[@class="title"]/text()').extract() 
```

# c# - 如何使用 C# 获取 XML 中特定属性的值？

> ID：14573889
> 
> 赞同：1
> 
> 时间：2013-01-29T00:50:04.230
> 
> 标签：c#, xpath

> **可能重复：**
> [如何使用 selectsinglenode() 访问具有属性和命名空间的 xml 节点](https://stackoverflow.com/questions/1716287/how-to-access-a-xml-node-with-attributes-and-namespace-using-selectsinglenode)

我有一个 XML：

```
<Root xmlns:XXXlocal="XXXX" schemaVersion="2.7" variant="multiterm">
  <Customers>
    <Customer type="Covered">
      <DataItem name="OpCity" value="" />
      <DataItem name="OpAddress1" value="" />
      <DataItem name="OpAddress2" value="" />
      <DataItem name="OpState" value="MI" />
    <Customer>
  </Customers>
</Root> 
```

我需要从上面的 XML 中获取值“MI”。请注意，XML 有许多不同的“客户类型”。

我该怎么做呢？我很难编写 xPath 查询来获取它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T00:59:01.697

在 C# 中，您可以使用 LINQ/XDocument，并`XPathSelectElement()`使用 xpath 进行查询：

```
var document = XDocument.Load(fileName);
var namespaceManager = new XmlNamespaceManager(new NameTable());
namespaceManager.AddNamespace("l", "XXXX");
var val = document.XPathSelectElement("/l:Root/l:Customers/l:Customer[@type='Covered']/l:DataItem[@name='OpState']/@value", namespaceManager).Value; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T00:56:32.457

假设命名空间`XXXX`被定义为 prefix `x`，这应该工作......

```
/x:Root/x:Customers/x:Customer[@type='Covered']/x:DataItem[@name='OpState']/@value 
```

# c# - 微软 WPF 转换器

> ID：14573895
> 
> 赞同：2
> 
> 时间：2013-01-29T00:50:54.193
> 
> 标签：c#, wpf, mvvm, converter

所以我今天在 MSDN 上找到了一个Converters[列表](http://msdn.microsoft.com/en-us/library/vstudio/hh729302.aspx)，现在我想使用其中的一些。但是，经过一番搜索后，我似乎找不到任何关于它们的信息。

我主要想使用[IntToBoolConverter](http://msdn.microsoft.com/en-gb/library/vstudio/microsoft.teamfoundation.controls.wpf.converters.inttoboolconverter.inttoboolconverter?cs-save-lang=1&cs-lang=csharp#code-snippet-1)。但是我不知道如何使用转换，因为没有提供如何操作的信息（或在谷歌上）。

我知道自己制作这个转换器很容易，但我是一名程序员，我的 moto 尽可能地偷懒，制作已经存在的方法（转换器）是多余的工作。

希望有人可以向我解释如何使用这些转换器。

编辑：

尝试回复后，我在加载用户控件时出错：

```
{"Cannot find resource named 'IntToVisibleConverter'. Resource names are case sensitive."} 
```

应用程序.xaml

```
<Application x:Class="Smartp1ck.JungleTimerClient.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:msconv="clr-namespace:Microsoft.TeamFoundation.Controls.WPF.Converters;assembly=Microsoft.TeamFoundation.Controls">
    <Application.Resources>
        <msconv:IntToVisibleConverter x:Key="IntToVisibleConverter" />
    </Application.Resources>
</Application> 
```

在用户控件上

```
<TextBlock Text="{Binding TimeLeft}" HorizontalAlignment="Center" Visibility="{Binding Path=TimeLeft, Converter={StaticResource IntToVisibleConverter}}" /> 
```

编辑2：

将它放在用户控件的资源中使其工作。太糟糕了，由于某种原因我不能使用 app.xaml，我稍后会弄清楚。感谢帮助，已解决！

格言

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T01:03:11.153

您必须`Microsoft.TeamFoundation.Controls.dll`在您的应用程序和 xaml 中添加作为参考，然后您可以在窗口资源中声明转换器并在您的应用程序中使用。

例子：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mstf="clr-namespace:Microsoft.TeamFoundation.Controls.WPF.Converters;assembly=Microsoft.TeamFoundation.Controls"
        Title="MainWindow" Height="350" Width="525">
    <Window.Resources>
        <mstf:IntToBoolConverter x:Key="IntToBoolConverter" />
    </Window.Resources>

    <Grid>
        <CheckBox IsChecked="{Binding Path=MyInt, Converter={StaticResource IntToBoolConverter}}" />
    </Grid>
</Window> 
```

如果您想在整个应用程序（其他窗口/对话框等）中全局使用转换器，您可以在`App.xaml`

例子：

```
<Application x:Class="WpfApplication1.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mstf="clr-namespace:Microsoft.TeamFoundation.Controls.WPF.Converters;assembly=Microsoft.TeamFoundation.Controls"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <mstf:IntToBoolConverter x:Key="IntToBoolConverter" />
    </Application.Resources>
</Application> 
```

您可以像第一个示例一样访问它`Converter={StaticResource IntToBoolConverter}`

# java - 保存对象以备后用，如果我的应用程序被杀死

> ID：14573897
> 
> 赞同：-2
> 
> 时间：2013-01-29T00:51:14.610
> 
> 标签：java, android, object, serialization

> **可能重复：**
> [Android Activity 中的变量状态](https://stackoverflow.com/questions/14573865/state-of-variables-inside-an-android-activity)

如果 android OS 由于内存不足而杀死了我的应用程序（使用 service ），那么它将尝试再次运行它。来自 android.developers 网站：

**请注意，这意味着您的服务大部分时间都在运行，如果内存压力过大，它可能会被系统杀死。如果发生这种情况，系统稍后会尝试重新启动服务。**

如果我在我的主要活动代码中有这样的：

```
public static MainActivity mainAct;
protected void onCreate(Bundle savedInstanceState) 
{mainAct = this;} 
```

当 android OS 杀死我的 mainAct 应用程序值时，它会丢失，因为它仅在活动中初始化 onCreate() 而不是在服务中。

如何“保存”该对象，以便在我的应用程序因内存不足而被终止时保留价值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:50:33.690

`public static MainActivity mainAct`会导致内存泄漏问题，比如经常改变方向。当前的activity实例不能被gc收集到，因为mainAct有它的refrence。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:21:57.990

您可以在服务中实现 onDestroy() 方法，以将某些应用程序状态持久保存到设备。因此，当调用服务 onStartCommand() 方法时，您可以检查您的持久状态（如果存在）并从该点再次启动您的应用程序。

例如，如果您有一个从不同来源提取文章的新闻提要应用程序，您可以在开始下载之前将您的状态写入文件中，例如：

```
download=irishtimes-31_01_2013 
```

因此，如果您的应用程序由于有人拔出电池而完全失败，那么您就有了一个可以恢复的已知状态。同样，如果 Andoid 调用您的 onDestroy() 方法来终止您的服务，您可以以相同的方式将状态保存到设备。然后，当您的服务重新启动时，您将拥有可以从文件中读取并加载到“对象”中以再次使用的状态。

您不仅限于文件。正如@wtstang02 提到的，您还可以使用数据库。

# bash - MD5 进度输出 - BASH

> ID：14573899
> 
> 赞同：2
> 
> 时间：2013-01-29T00:51:20.347
> 
> 标签：bash, md5sum

我正在开发一个简单的 MD5SUM 脚本。除了显示进度的部分（已计算给用户的文件的百分比）之外，它几乎完成了。我正在考虑使用带有虚拟变量的 while 循环来检查 MD5 是否已计算。唯一的问题是 md5sum（在 linux 上）不返回任何反馈，除非计算出实际的 md5sum。因此，很难向用户显示已处理了多少文件。这是脚本的副本。

```
#!/bin/bash

#MD5 verification tool
#1st argument is file name of .iso, and the 2nd argument is the the MD5 hexsum.

echo Checking file $1 .....  
#calc md5 for file
SUM=`md5sum $1`
#insert while loop here?
#compare values
test $SUM = $2 && echo original || echo False 

#8cd98b693ce542b671edecaed48ab06d8c
# GNOME-64.iso

exit 0 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-29T00:55:05.863

使用`pv`，可安装在所有主要发行版上。`SUM=$(pv "$1" | md5sum)`将显示一个包含吞吐量和所有内容的漂亮进度条，例如：

```
bash> pv /media/secondary/backups/2013_01_12/* | md5sum
10.2GB 0:01:32 [ 115MB/s] [====>                 ] 19% ETA 0:06:21 
```

# backbone.js - 如何在模板视图中解析主干集合

> ID：14573900
> 
> 赞同：1
> 
> 时间：2013-01-29T00:51:54.963
> 
> 标签：backbone.js, underscore.js, mustache

我正在使用主干，我想在我看来解析我的第一个集合。

我的第一个问题，`undescore`真的是最好的方法吗？我听说过`mustache.js`

接下来的事情是，我不知道该怎么做：

```
var A = new Model();
var B = new Model();
var Mole = new Collection([A, B]);
var View = View({model: A, collection: Mole });
View.render(); 
```

这是我的渲染方法：

```
render: function(){
  this.template = _.template($('template').html());
  $(this.el).html(this.template(this.collection.models)); //I don't know what to send here
} 
```

这是我的模板

```
<script type="text/template" id="template">
  <% _.each(collection, function(model){ %> //I don't know what to get here
    <% model.name %>
  <% }); %>
</script> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-29T01:41:15.120

首先，`_.template`想要模板中的文本，而不是 jQuery 对象。这意味着：

```
this.template = _.template($('template')); 
```

应该是这样的：

```
this.template = _.template($('template').html()); 
```

然后编译的模板函数将希望查看数据的键/值对；来自[精美手册](http://underscorejs.org/#template)（这适用于 Mustache、Handlebars 和 Underscore BTW）：

> 当您评估模板函数时，传入一个**数据**对象，该对象具有与模板的自由变量对应的属性。

所以你想说：

```
this.$el.html(this.template({
    collection: this.collection.toJSON()
})); 
```

然后你可以在你的模板中这样说：

```
<% _.each(collection, function(model) { %>
  <%= model.name %>
<% }); %> 
```

需要考虑的几点：

1.  Backbone 视图已经包含了一个 jQuery `this.el`，[`this.$el`](http://backbonejs.org/#View-$el)所以不需要`$(this.el)`.
2.  序列化数据通常使用 传递给模板[`toJSON`](http://backbonejs.org/#Collection-toJSON)，这对 Mustache 和 Handlebars 双重适用，因为它们不会理解其他任何内容。
3.  你需要说`<%= ... %>`在你的模板中得到一些输出；`<% ... %>`只需评估一些 JavaScript 代码，它不会留下任何东西，您必须为此使用插值分隔符（`<%=`默认`%>`情况下）。

# android - 在列表视图中查找复选框的位置

> ID：14573903
> 
> 赞同：2
> 
> 时间：2013-01-29T00:52:11.217
> 
> 标签：android, android-listview

我有一个用于列表视图的自定义适配器。行视图是一个复选框。`setOnClickListener()`当用户单击复选框时，我曾经处理过。我想知道是否有办法让我知道单击时列表视图中复选框的位置。

如果有帮助，这是我的适配器的代码。

```
private class TagAdapter extends BaseAdapter 
{
    public TagAdapter(ArrayList<Tag> items) 
    {
        mTagList = items;
    }
    public int getCount() 
    {
        return mTagList.size();
    }
    public Object getItem(int position) 
    {
        return mTagList.get(position);
    }
    public long getItemId(int position) 
    {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent)
    {
        View V = convertView;

        if(V == null) 
        {
            LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            V = vi.inflate(R.layout.tag, null);
        }

        Tag t = (Tag) mTagList.get(position);
        TextView tagName = (TextView)V.findViewById(R.id.checkBox1);
        CheckBox cb = (CheckBox)V.findViewById(R.id.checkBox1);
        cb.setChecked(t.isSelected());
        cb.setOnClickListener(new View.OnClickListener() //the add tag button "+"
        {
            public void onClick(View view) 
            {

            }

       });

        tagName.setText(t.getTagName());
        return V;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:56:40.043

创建复选框时，请使用该`setTag`方法添加所需的任何数据。您甚至可以将列表项存储为标签。

# jquery - .val() 适用于输入，但不适用于 textarea

> ID：14573907
> 
> 赞同：0
> 
> 时间：2013-01-29T00:52:26.500
> 
> 标签：jquery, input, textarea, return-value

我正在尝试获取输入到 textarea 中的值，但它似乎不起作用。我用而不是再次尝试了它，它似乎工作得很好。

编辑：刚刚意识到这与tinyMCE有关。在没有 tinyMCE 的情况下尝试过，效果很好。知道这是为什么吗？

```
 $('.answers').load(url, function() {
             tinyMCE.init({ 
                theme : "advanced", 
                mode : "textareas", 
                plugins : "fullpage", 
                theme_advanced_buttons3_add : "fullpage" 
              });   

        $('#submitAnswer').on('click', function(e){
            var dataString = $("#addAnswer").val();
                    alert(dataString);
            e.preventDefault();
        });   
    }) 
```

不适用于：

```
 <textarea id="addAnswer" name="addAnswer"></textarea> 
```

适用于：

```
 <input id="addAnswer" name="addAnswer"></input> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T03:07:49.083

它不再是文本区域，因此 value 属性将不起作用。

这是您获得对编辑器及其文本的引用的方式：

var text = tinyMCE.get('myeditorid').getContent();

[JavaScript 查找 TinyMCE 富文本编辑器值是否为空](https://stackoverflow.com/questions/2122119/javascript-to-find-tinymce-rich-text-editor-value-is-null-or-not?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:57:22.970

试试这个：

```
var dataString = $("textarea#addAnswer").val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:05:48.717

尝试：

```
var dataString = $('#addAnswer').text(); 
```

如果这不起作用，请尝试：

```
 var dataString = $('#addAnswer').html(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T01:18:04.953

该`.val()`属性适用于 textArea。

例如，您可以查看[文档](http://api.jquery.com/val/)和这个[jsFiddle](http://jsfiddle.net/x6ByK/)。

我认为您的问题与事件的时间有关（准备好和加载）

# opengl - OpenGL：VAO 和 VBO 是否适用于大型多边形渲染任务？

> ID：14573909
> 
> 赞同：2
> 
> 时间：2013-01-29T00:52:50.590
> 
> 标签：opengl, buffer, lwjgl, indices, vertices

如果您想一次在视锥中渲染具有数千个多边形的大型景观，并且用户的视点不断变化，那么使用 VAO 或 VBO 是否可行？

我的意思是，每次玩家的位置或摄像机旋转发生变化时，您都必须重新计算顶点数据，以便正确剔除不再可见的任何顶点或场景，以保持良好的 FPS 计数。但是在这样做时，您的 FPS 计数会下降，因为您会不断地重新打包所有缓冲区。

**那么在立即模式下使用这两种方法是否仍然有益？**

我的猜测是肯定的，因为使用即时模式，您还可以在每一帧重新计算所有顶点，只是方式略有不同。可悲的是，我没有太多的背景知识，而且我很困惑，因为互联网上关于这个话题的信息不一。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-29T01:06:05.247

答案是**肯定**的，VBO 对于大型多边形渲染任务非常实用。不应使用立即模式，因为它是固定功能管道的一部分，并且不推荐使用 FFP。

但是您不应该**重新**计算每一帧的风景并将其再次存储在缓冲区中。有一些方法可以处理这种情况，但您应该避免每帧更新 VBO，因为这可能会导致资源冲突。

*   使用某种LOD。有不同的方法可以做到这一点（[查看此处](https://stackoverflow.com/questions/9140877/calculating-normals-between-2-meshes-ending-up-in-seams)获取图像如何工作，但不必这样做）。通常，当场景与观察者的距离很远时，您会减少多边形。如果您有 2D 地形（无悬垂地形），则非常简单。如果您的地形更复杂，则更难处理，但仍有可能。
*   将所有缓冲区保留在 RAM 中，这些缓冲区可能会在几分钟内可见（但不是必须），与 LOD 方法相比，这非常消耗内存。如果地形段超出视野范围，请将其删除。
*   流式传输数据并使用双缓冲 VBO（这意味着：对于一个段，您有 2 个 VBO，一个正在渲染，一个正在写入）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-29T01:07:23.713

> 我的意思是，每次玩家的位置或摄像机旋转发生变化时，您都必须重新计算顶点数据

不，你没有。在典型的地形渲染器中，数据被细分为瓦片。通常这些图块会再次细分，以实现详细程度。使图块与众不同的是它们引用的顶点。因此，您将拥有一个用于地形数据的大型顶点数组，以及许多用于切片的索引数组。通过使用正确的索引数组调用 glDrawElements，您可以选择在哪个细节级别绘制哪些图块。

# git - 将脚本从 SVN 部署到 GitHub

> ID：14573910
> 
> 赞同：0
> 
> 时间：2013-01-29T00:52:55.033
> 
> 标签：git, svn, github, deployment

我正在将一个站点从 SVN 移动到 Git（在 GitHub 上测试）。我首先导出 SVN 存储库并将其转换为本地 git 存储库，然后将该存储库上传到 GitHub。

接下来是修改部署脚本，使这个特定站点使用 Git/GitHub，不再使用 SVN。服务器上有许多使用此部署脚本的站点，所有这些站点都使用 SVN。除了一个人之外，所有人都需要使用 SVN。

我想知道是否可能建议我从脚本中删除任何涉及该站点的内容，并创建一个新的特定于 git 的部署脚本，该脚本只能用于该特定域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T08:26:58.303

事实上，我建议你从你的 svn 部署脚本中删除你的 site-with-git 并将其放入一个新的 git 部署脚本中，只是为了拥有干净的脚本。然后，如果需要，您可能希望在另一个脚本（deploy-all.sh 或其他）中调用这两个脚本以同时部署。这也确保了如果你的 site-with-git 的旧 SVN 存储库保存在某个地方，它不会被错误地部署。

要使用 git 进行部署，有很多教程（例如，请参阅[使用 Git/Github 部署](https://stackoverflow.com/questions/9619440/deploying-with-git-github)），具体取决于您的情况。

您可能需要一个持续集成系统，或您 rsync 的部署服务器上的 repo 本地副本，或直接从网络服务器拉取，或使用钩子推送到网络服务器......很多选择！

祝你好运 ！

# ios - 将 xml 记录插入 ios 设备时应用程序崩溃

> ID：14573912
> 
> 赞同：0
> 
> 时间：2013-01-29T00:53:21.157
> 
> 标签：ios, xml, parsing, crash, nsmanagedobjectcontext

首先这是我的崩溃日志

```
Thread 1 name:  Dispatch queue: com.apple.root.default-priority
Thread 1 Crashed:
0   CoreFoundation                  0x3b8afc30 __CFBasicHashRehash + 796
1   CoreFoundation                  0x3b8b0e48 __CFBasicHashAddValue + 88
2   CoreFoundation                  0x3b7db194 CFBasicHashAddValue + 3048
3   CoreFoundation                  0x3b7deebc CFSetAddValue + 112
4   CoreData                        0x36ea45b0 -        [NSManagedObjectContext(_NSInternalAdditions) _insertObjectWithGlobalID:globalID:] + 172
5   CoreData                        0x36e9c9bc -[NSManagedObjectContext insertObject:] +     136
6   CoreData                        0x36e8c6d2 -[NSManagedObject     initWithEntity:insertIntoManagedObjectContext:] + 646
7   CoreData                        0x36e78d74 +[NSEntityDescription     insertNewObjectForEntityForName:inManagedObjectContext:] + 176
8   XYZ Orders                      0x000f8182 -[ITMLoginVC traverseElement:] (ITMLoginVC.m:1551)
9   XYZ Orders                      0x000f7eba -[ITMLoginVC traverseElement:] (ITMLoginVC.m:1506)
10  XYZ Orders                      0x000f5970 -[ITMLoginVC getAllCustomerValues]     (ITMLoginVC.m:903)
11  libdispatch.dylib               0x39b8911c _dispatch_call_block_and_release + 8
12  libdispatch.dylib               0x39b8d95c _dispatch_root_queue_drain + 248
13  libdispatch.dylib               0x39b8dabc _dispatch_worker_thread2 + 80
14  libsystem_c.dylib               0x368f2a0e _pthread_wqthread + 358
15  libsystem_c.dylib               0x368f28a0 start_wqthread + 4 
```

第 903 行：

```
if(ttbXML.rootXMLElement)
{
    [self traverseElement:ttbXML.rootXMLElement]; //line 903
} 
```

第 1551 行：

```
ITMAllCustomerAddresses *allCustAddress =(ITMAllCustomerAddresses *)[NSEntityDescription                                                            insertNewObjectForEntityForName:@"ITMAllCustomerAddresses"
                                                                                                                        inManagedObjectContext:self.managedObjectContext]; 
```

第 1506 行：

```
 [self traverseElement:element->firstChild]; 
```

我正在使用 TBXML 进行解析。在 StackOverflow 上，人们建议在大型 XML 的情况下使用 TBXML。我使用了 NSXMLParser，但它很慢而且崩溃了。这也崩溃了，但它的速度很快，每天崩溃一次或两次。这又是一个罕见的案例。这是我今天第二次得到这个。所以我想我可以发布这个。我认为我的 managedobjectcontext 没有正确初始化，所以我现在正在这样做：

```
 if (!self.managedObjectContext)
{
    self.managedObjectContext  = self.appDelegate.managedObjectContext;
} 
```

如果有人对为什么它的行为有任何想法，请告诉我。如果您需要更多信息，请告诉我。谢谢。它在 iOS6 中，我正在测试 iPhone 设备。它是一个内部应用程序。在模拟器上运行良好。

# java - While循环还是线程？

> ID：14573913
> 
> 赞同：0
> 
> 时间：2013-01-29T00:53:30.327
> 
> 标签：java, multithreading, while-loop, nxt, lego

我目前正在`Lego NXT 2.0`使用`leJOS 0.9.1 beta`固件进行编程。

我有几个不同的传感器，比如颜色传感器和超声波传感器。

我正在使用while循环使机器人向前行驶，直到撞到墙上。但是，出于某种原因，我不喜欢这种方法，而是想实现一个监听器。然而，一位 leJOS 开发人员写道，不建议使用侦听器模型，我应该使用线程来轮询超声波传感器的值。

现在我想知道使用 while 循环的实现到底有多糟糕（操作系统方面，如浪费资源）以及线程模型如何更有益（和实现）？

MWE：

```
public class SensorTest {
    static UltrasonicSensor sonic;
    static DifferentialPilot pilot;
    public static final int DISTANCE = 20;

    public static void main(String[] args){
        sonic = new UltrasonicSensor(SensorPort.S1);
        pilot = new DifferentialPilot(8.5, 25, Motor.C, Motor.B);
        int i = 0;      

        while (i < DISTANCE) {
            pilot.forward();
            i = sonic.getDistance();
        }
        pilot.stop();
      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:02:08.593

没有任何乐高积木的经验（我真的很嫉妒）你必须问自己一些严肃的问题。

在简单的情况下，以这种方式使用循环可能不是一个糟糕的解决方案，但是随着您添加更多，处理每个请求所需的时间（检查 n 个传感器，执行 n 个操作），它将变成反应较慢。

线程模型可能允许您处理更多数据，但您可能需要考虑需要多少线程以及它们在做什么。

例如，您可以有一个`Driver`线程，其唯一职责是移动乐高。它会查询多个“传感器”线程以确定它在告诉什么，但每个传感器线程将以自己的速率轮询数据，而不关心其他任何事情。

您还可以反转模型，允许`Driver`继续移动，直到`Sensor`线程发出某种警报并告诉`Driver`它应该改变方向。

我个人会尝试看看我是否可以让线程模型工作（即使对于一个简单的设备），因为它将为将来扩展操作提供更多的灵活性......

归根结底，这将是平衡行为

严重嫉妒！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T00:56:24.270

> 现在我想知道使用 while 循环的实现到底有多糟糕（操作系统方面，如浪费资源）以及线程模型如何更有益（和实现）？

“线程模型”是一个while循环，在主线程以外的某个线程上执行。如果您担心资源消耗，您可以让线程在它再次轮询值之前进入某个固定时间间隔的睡眠。

至于这是如何实现的，您必须通读 . `API`，但是在标准的 java 程序中，如果您使用的是较新的 JDK，您只需创建一个实现该`Runnable`接口的类，并将该对象传递给一个线程执行人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T00:59:35.093

使用线程与轮询取决于您的情况。我想在对微控制器进行编程时，线程更像是一个中断。使用线程（或中断），您可以更好地模块化代码，使其更高效。看到这个线程-

[基于轮询或中断的方法](https://stackoverflow.com/questions/3072815/polling-or-interrupt-based-method)

# ruby-on-rails - 使用 Mongoid 将整个模型设为只读

> ID：14573914
> 
> 赞同：5
> 
> 时间：2013-01-29T00:53:32.867
> 
> 标签：ruby-on-rails, mongodb, mongoid

我看到 Mongoid 支持只读属性。有没有办法将整个文档或整个集合/模型类标记为只读？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-29T01:00:09.283

您可以访问`fields`类属性并针对`attr_readonly`. 例如：

```
class Model
  include Mongoid::Document

  attr_readonly *fields.keys
end 
```

请注意，`fields.keys`将包括`_id`和`_type`。

# c# - 使用 ASP.NET Web API，控制器如何返回使用 DotNetZip 库压缩的流图像集合？

> ID：14573915
> 
> 赞同：15
> 
> 时间：2013-01-29T00:53:39.953
> 
> 标签：c#, .net, asp.net-web-api, dotnetzip

如何创建一个 Web API 控制器，该控制器生成并返回从内存中 JPEG 文件（MemoryStream 对象）集合流式传输的压缩 zip 文件。我正在尝试使用 DotNetZip 库。我找到了这个例子：[http](http://www.4guysfromrolla.com/articles/092910-1.aspx#postadlink) ://www.4guysfromrolla.com/articles/092910-1.aspx#postadlink 。但是 Response.OutputStream 在 Web API 中不可用，因此该技术不太适用。因此，我尝试将 zip 文件保存到新的 MemoryStream；但它扔了。最后，我尝试使用 PushStreamContent。这是我的代码：

```
 public HttpResponseMessage Get(string imageIDsList) {
        var imageIDs = imageIDsList.Split(',').Select(_ => int.Parse(_));
        var any = _dataContext.DeepZoomImages.Select(_ => _.ImageID).Where(_ => imageIDs.Contains(_)).Any();
        if (!any) {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        }
        var dzImages = _dataContext.DeepZoomImages.Where(_ => imageIDs.Contains(_.ImageID));
        using (var zipFile = new ZipFile()) {
            foreach (var dzImage in dzImages) {
                var bitmap = GetFullSizeBitmap(dzImage);
                var memoryStream = new MemoryStream();
                bitmap.Save(memoryStream, ImageFormat.Jpeg);
                var fileName = string.Format("{0}.jpg", dzImage.ImageName);
                zipFile.AddEntry(fileName, memoryStream);
            }
            var response = new HttpResponseMessage(HttpStatusCode.OK);
            var memStream = new MemoryStream();
            zipFile.Save(memStream); //Null Reference Exception
            response.Content = new ByteArrayContent(memStream.ToArray());
            response.Content.Headers.ContentType = new MediaTypeHeaderValue("application/zip");
            response.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment") { FileName = string.Format("{0}_images.zip", dzImages.Count()) };
            return response;
        }
    } 
```

zipFile.Save(memStream) 抛出空引用。但是 zipFile 和 memStream 都不是 null 并且没有内部异常。所以我不确定是什么导致了空引用。我对 Web API、内存流的经验很少，而且我以前从未使用过 DotNetZipLibrary。这是对这个问题的跟进：[想要一个高效的 ASP.NET Web API 控制器，能够可靠地返回 30 到 50 ~3MB JPEG](https://stackoverflow.com/questions/14567497/want-an-efficient-asp-net-web-api-controller-that-can-reliably-return-30-to-50)

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-04-11T15:59:17.743

一个更通用的方法是这样工作的：

```
using Ionic.Zip; // from NUGET-Package "DotNetZip"

public HttpResponseMessage Zipped()
{
    using (var zipFile = new ZipFile())
    {
        // add all files you need from disk, database or memory
        // zipFile.AddEntry(...);

        return ZipContentResult(zipFile);
    }
}

protected HttpResponseMessage ZipContentResult(ZipFile zipFile)
{
    // inspired from http://stackoverflow.com/a/16171977/92756
    var pushStreamContent = new PushStreamContent((stream, content, context) =>
    {
        zipFile.Save(stream);
        stream.Close(); // After save we close the stream to signal that we are done writing.
    }, "application/zip");

    return new HttpResponseMessage(HttpStatusCode.OK) {Content = pushStreamContent};
} 
```

该`ZipContentResult`方法也可以存在于基类中，并在任何 api 控制器中的任何其他操作中使用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-06-24T18:58:18.557

在这种情况下，可以使用[PushStreamContent](http://msdn.microsoft.com/en-us/library/system.net.http.pushstreamcontent(v=vs.118).aspx)类来消除对 MemoryStream 的需求，至少对于整个 zip 文件是这样。它可以这样实现：

```
 public HttpResponseMessage Get(string imageIDsList)
    {
        var imageIDs = imageIDsList.Split(',').Select(_ => int.Parse(_));
        var any = _dataContext.DeepZoomImages.Select(_ => _.ImageID).Where(_ => imageIDs.Contains(_)).Any();
        if (!any)
        {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.NotFound));
        }
        var dzImages = _dataContext.DeepZoomImages.Where(_ => imageIDs.Contains(_.ImageID));
        var streamContent = new PushStreamContent((outputStream, httpContext, transportContent) =>
            {
                try
                {
                    using (var zipFile = new ZipFile())
                    {
                        foreach (var dzImage in dzImages)
                        {
                            var bitmap = GetFullSizeBitmap(dzImage);
                            var memoryStream = new MemoryStream();
                            bitmap.Save(memoryStream, ImageFormat.Jpeg);
                            memoryStream.Position = 0;
                            var fileName = string.Format("{0}.jpg", dzImage.ImageName);
                            zipFile.AddEntry(fileName, memoryStream);
                        }
                        zipFile.Save(outputStream); //Null Reference Exception
                    }
                }
                finally
                {
                    outputStream.Close();
                }
            });
        streamContent.Headers.ContentType = new MediaTypeHeaderValue("application/zip");
        streamContent.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment")
        {
            FileName = string.Format("{0}_images.zip", dzImages.Count()),
        };

        var response = new HttpResponseMessage(HttpStatusCode.OK)
            {
                Content = streamContent
            };

        return response;
    } 
```

[理想情况下，使用ZipOutputStream](http://dotnetzip.herobo.com/DNZHelp/Index.html)类而不是使用 ZipFile 来动态创建 zip可以使其更加动态地创建。在这种情况下，将不需要每个位图的 MemoryStream。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-21T13:46:39.293

```
public HttpResponseMessage GetItemsInZip(int id)
    {           
            var itemsToWrite = // return array of objects based on id;

            // create zip file stream
            MemoryStream archiveStream = new MemoryStream();
            using (ZipArchive archiveFile = new ZipArchive(archiveStream, ZipArchiveMode.Create, true))
            {
                foreach (var item in itemsToWrite)
                {
                    // create file streams
                    // add the stream to zip file

                    var entry = archiveFile.CreateEntry(item.FileName);
                    using (StreamWriter sw = new StreamWriter(entry.Open()))
                    {
                        sw.Write(item.Content);
                    }
                }
            }

            // return the zip file stream to http response content                
            HttpResponseMessage responseMsg = new HttpResponseMessage(HttpStatusCode.OK);                
            responseMsg.Content = new ByteArrayContent(archiveStream.ToArray());
            archiveStream.Dispose();
            responseMsg.Content.Headers.ContentDisposition = new ContentDispositionHeaderValue("attachment") { FileName = "test.zip" };
            responseMsg.Content.Headers.ContentType = new MediaTypeHeaderValue("application/zip");

            return responseMsg;          
    } 
```

使用带有 MVC 5 的 Framework .NET 4.6.1

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-30T12:37:18.303

我刚遇到和你一样的问题。

```
zipFile.Save(outputStream); //I got Null Reference Exception here. 
```

问题是我正在从内存流中添加文件，如下所示：

```
zip.AddEntry(fileName, ms); 
```

您所要做的就是将其更改为：

```
zip.AddEntry(fileName, ms.ToArray()); 
```

似乎当作者决定实际写入文件并尝试读取流时，流被垃圾收集或......

干杯!

# android - Asynctask 仍在阻塞 Android 应用程序中的主线程

> ID：14573917
> 
> 赞同：1
> 
> 时间：2013-01-29T00:53:42.520
> 
> 标签：android, android-asynctask

我正在尝试使用存储在[Parse上的数据库更新应用程序的 SQLite 数据库](http://www.parse.com)

我正在调用该函数以更新 Asynctask 中的数据库，但由于我的应用程序挂起并在执行该函数时显示“未响应”错误，它仍然阻塞主线程。

这是我的代码，它是在 Activity 中的 onCreate() 中编写的。

```
if (Build.VERSION.SDK_INT>=Build.VERSION_CODES.HONEYCOMB){

        new SaveCourses().executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, mDbHelper);
            }
            else {
                new SaveCourses().execute(mDbHelper);

            } 
```

SaveCourses类写在Activity类的最后，

```
class SaveCourses extends AsyncTask<Object, Integer, Object> {
    @Override
    protected Object doInBackground(Object... ctx) {
    System.out.println("in background method - async");
    ((TestAdapter) ctx[0]).SaveCourses_1();
    return null;
    }

    protected void onPostExecute(Object... mDbHelper) {
        ((TestAdapter) mDbHelper[0]).close();   
    }
    @Override
    protected void onProgressUpdate(Integer... values)
    {

    }

} 
```

你们中的任何人都可以指导我了解我的代码有什么问题。提前致谢。

# hadoop - Oozie 工作流程中的多个 JAVA 操作

> ID：14573919
> 
> 赞同：1
> 
> 时间：2013-01-29T00:54:10.063
> 
> 标签：hadoop, oozie

我阅读了无法在工作流中创建循环的文档，但我需要每次使用列表项单独调用 main 方法 - 因此需要创建一个循环。

一种解决方案是使用子工作流再次调用工作流。

有没有其他解决方案？喜欢使用协调员工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:24:18.270

我能想到的一些可能的“黑客”解决方案：

*   如您所说，创建一个自定义 Java 操作，该操作使用 Oozie 客户端 API 运行多个工作流（列表中的每个项目一个）。然后，您可以并行或串行运行这些项目并轮询成功/失败。
*   与上述类似的另一种选择是使用一些模板语言，如 Apache Velocity，并让您的自定义操作采用模板并展开它（动态生成工作流 xml 文件），然后再次使用 Oozie 客户端 API 运行生成的工作流程。

我更喜欢第二种选择，因为您可以制定通用解决方案。

# php - phpunit 与 netbeans

> ID：14573921
> 
> 赞同：1
> 
> 时间：2013-01-29T00:54:18.717
> 
> 标签：php, netbeans, phpunit

我尝试按照[**本教程**](http://netbeans.org/kb/docs/php/phpunit.html)进行操作；我开始执行第 5.5-6 步，但出现此错误

```
PHPUnit 3.7.13 by Sebastian Bergmann.

Fatal error: Class 'Calculator' not found in C:\xampp\htdocs\... on line ... 
```

现在我意识到我可以只包含/要求该文件，但是有没有办法告诉 Netbeans/PHPUnit 始终包含在测试文件中，`phpunit-skelgen`生成的文件是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T07:53:13.543

您可以在测试类中包含要自己测试的类，就像您编写的那样，或者您使用引导文件来处理加载类以通过自动加载进行测试。我认为[本教程](http://jes.st/2011/phpunit-bootstrap-and-autoloading-classes/)将为您提供很多关于为什么以及如何将引导程序与 PHPUnit 一起使用的指导。

就个人而言，我的引导程序设置了测试数据库、一些配置设置、要测试的应用程序的自动加载机制，然后启动我要测试的应用程序。

# c# - .NET MVC C# 枚举绑定器

> ID：14573924
> 
> 赞同：0
> 
> 时间：2013-01-29T00:54:47.400
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, enums

我成功地制作了 Enum 活页夹，从 iv 测试的结果来看，一切正常。但我想在我的控制器中有可为空的枚举参数，当我更改为可为空时，我的活页夹不起作用。

```
 public class EnumBinder<T> : IModelBinder
    {
        private object DefaultValue { get; set; }
        public EnumBinder(object defaultValue)
        {
            DefaultValue = defaultValue;
        }

        public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
        {
            var result = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);

            if(result == null || string.IsNullOrEmpty(result.AttemptedValue))
            {
                return DefaultValue;
            }

            return GetEnumValue<T>(result.AttemptedValue);
        }

        public static object GetEnumValue<T>(string value)
        {
            var enums = Enum.GetValues(typeof (T)).Cast<T>().ToList();

            foreach (var e in enums)
            {
                var _enum = Enum.Parse(typeof (T), e.ToString());
                if (string.Equals(value, _enum.ToString(), StringComparison.InvariantCultureIgnoreCase))
                {
                    return _enum;
                }
            }

            return null;
        }

    } 
```

适用于

```
 public virtual ActionResult ControllerName(Status status)
    {
       return View();
    } 
```

但不工作

```
 public virtual ActionResult ControllerName(Status? status)
    {
       return View();
    } 
```

当然，我已经在申请开始时注册了我的活页夹

```
ModelBinders.Binders.Add(typeof(CallStatus), new EnumBinder<CallStatus>(null)); 
```

我做错了什么，为什么我不能在我的控制器中返回可为空的枚举？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:03:35.743

`CallStatus`并且`CallStatus?`是不同的类型。这 ？是语法糖；`CallStatus?`实际上是 type `System.Nullable<CallStatus>`。

您需要添加另一个活页夹`typeof(Nullable<CallStatus>)`，或使用提供程序，如此[处](https://stackoverflow.com/questions/5533198/custom-model-binder-not-called-when-type-is-nullable)所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T01:14:46.900

模型绑定到 Enums 应该只适用于 MVC 3 或 4 中的默认模型绑定器，无论是普通的还是可以为空的。

您是否尝试过使用默认模型绑定器并发现它不起作用？

IIRC，默认绑定行为取决于枚举值的字符串表示形式。如果您使用的是 html 视图（就像您看起来那样），这应该没问题。如果您使用的是 JSON 或模型的其他表示形式，您可能会遇到枚举在退出时被转换为整数表示的麻烦，并且如果您需要能够在返回时处理整数值您可能需要自定义活页夹。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:15:33.340

你可以`Nullable`为你的枚举设置一个类型，因为它是一个值类型。现在在[asp.net-mvc](/questions/tagged/asp.net-mvc "显示标记为“asp.net-mvc”的问题")中，如果要将其作为可选参数，则必须设置操作的默认值，例如：

```
public virtual ActionResult ControllerName(Status? status = null)
{
   if (status.HasValue) { /* some logic */ }
   return View();
} 
```

或者为您的枚举参数类型使用默认值

```
public virtual ActionResult ControllerName(Status status = Status.OK)
{
   /* some logic */
   return View();
} 
```

# ruby-on-rails - 如何使用 Paperclip 和 Rails 从 Amazon S3 中删除文件？

> ID：14573928
> 
> 赞同：2
> 
> 时间：2013-01-29T00:55:39.963
> 
> 标签：ruby-on-rails, heroku, amazon-s3, paperclip

刚从 Rails 开始。我有一个快速的问题，它使用 Paperclip 和 S3 来构建我正在构建的 Rails 应用程序，托管在 Heroku 上。

我已经同步了所有内容，以便可以上传附件（在生产和环境中），但唯一的问题是从 app/S3 中删除文件。我做了很多搜索，但很多实现都涉及复选框。我还通过文件控制器运行所有内容以限制对管理员的访问。

我正在使用一个简单的项目模型，它有多个附件。

当我单击删除链接时，我从 S3 收到一条错误消息，提示“错误：MethodNotAllowed。指定的方法不允许针对此资源。”

**这是我的看法：**

```
<% @project.assets.each do |asset| %>
 <%= link_to File.basename(asset.asset_file_name), asset.asset.url %>
 <small>(<%= number_to_human_size(asset.asset.size) %>)</small>
 <%= link_to '[X]', asset.asset.url , confirm: 'Are you sure you want to delete this attachment?', method: :destroy %> 
```

**这是我的破坏行动：**

```
def destroy
   @asset = Asset.find(params[:id])
   @asset.destroy
   flash[:notice] = "Attachment has been deleted."
   redirect_to(:back) 
end 
```

**Project 模型非常标准：**

```
class Asset < ActiveRecord::Base
  # attr_accessible :title, :body

  attr_accessible :asset

  belongs_to :project
  has_attached_file :asset, :storage => :s3, :path => (Rails.root + "files/:id").to_s, :url => "/files/:id"
 end 
```

我在这里还缺少什么来删除文件？是模型中的东西吗？当我不使用 S3 并从我的 SQLite 或 PG 数据库中删除时，一切都运行良好。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:11:39.200

MethodNotAllowed 是一个 HTTP 405，这意味着您正在尝试做一些 S3 不喜欢的事情。我认为错误在于您的删除链接：

```
<%= link_to '[X]', asset.asset.url , confirm: 'Are you sure you want to delete this attachment?', method: :destroy %> 
```

基本上，您正在向 S3 上文件的 URL 发送 HTTP 销毁，该文件实际上应该转到您的资产控制器，并且是`:delete`.

尝试：

```
<%= link_to '[X]', asset, confirm: 'Are you sure you want to delete this attachment?', method: :delete %> 
```

然后在您的控制器中，您应该处理删除资产：

```
def destroy
   @asset = Asset.find(params[:id])
   @asset.destroy
   flash[:notice] = "Attachment has been deleted."
   redirect_to(:back) 
end 
```

希望这可以帮助！

# c# - 无法在另一个 Datagrid 的 RowDetailsTemplate 中跟踪 DataGrid 的 SelectedItem

> ID：14573931
> 
> 赞同：6
> 
> 时间：2013-01-29T00:56:06.673
> 
> 标签：c#, wpf, datagrid, observablecollection, rowdetailstemplate

我今天早些时候遇到了这个问题，无法找到解决方案。当我在. `SelectedItem`_ _ _ （很难解释清楚。）`DataGrid``RowDetailsTemplate``DataGrid``DataGrid``RowDetailsTemplate`

绑定对于列表都正常工作。MainViewModel 包含一个对象，这就是外部绑定 `ObservableCollection`的对象。`MyItem``DataGrid`

该`MyItem`对象包含一个`ObservableCollection`对象`MyItem2`，它们被正确绑定到内部`DataGrid`。

该`MyItem`对象还有一个名为的属性`SelectedItem2`，它应该绑定到`SelectedItem`内部`DataGrid`但永远不会被设置。

顺便说一句：我正在使用 VS2012 和 .Net 4.5。

例子：

`MainWindow.xaml`

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:wpfApplication1="clr-namespace:WpfApplication1"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <wpfApplication1:MainWindowViewModel x:Key="MainVm"/>
</Window.Resources>
<Grid DataContext="{StaticResource MainVm}">
    <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding Path=MyItem1s}">
        <DataGrid.Columns>
            <DataGridTextColumn Header="Name" Width="*"
                                   Binding="{Binding Path=Name}"/>
        </DataGrid.Columns>
        <DataGrid.RowDetailsTemplate>         
            <DataTemplate>
                <DataGrid AutoGenerateColumns="False"
                          ItemsSource="{Binding Path=Item2s}"
                          SelectedItem="{Binding Path=SelectedItem2}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Item 2 Name" Width="130"
                                   Binding="{Binding Path=Name}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </DataTemplate>
        </DataGrid.RowDetailsTemplate>
    </DataGrid>
</Grid> 
```

`MainWindowViewModel`

```
 public class MainWindowViewModel : ViewModelBase
{
    public MainWindowViewModel()
    {
        for (int i = 0; i < 10; i++)
        {
            var item1 = new MyItem1();
            item1.Name = i.ToString();
            for (int j = 11; j < 20; j++)
                item1.Item2s.Add(new MyItem2()
                    {
                        Name = j.ToString()
                    });
            MyItem1s.Add(item1);
        }
    }

    private ObservableCollection<MyItem1> _myItem1S = new ObservableCollection<MyItem1>();
    public ObservableCollection<MyItem1> MyItem1s
    {
        get { return _myItem1S; }
        set { _myItem1S = value; }
    }
} 
```

`MyItems ViewModels`

```
 public class MyItem1 : ViewModelBase
{
    private string _name;        
    public string Name
    {
        get { return _name; }
        set
        {
            _name = value;
            OnPropertyChanged("Name");
        }
    }

    private ObservableCollection<MyItem2> _item2S = new ObservableCollection<MyItem2>();        
    public ObservableCollection<MyItem2> Item2s
    {
        get { return _item2S; }
        set
        {
            _item2S = value;
            OnPropertyChanged("Item2s");
        }
    }

    private MyItem2 _selectedItem2;
    public MyItem2 SelectedItem2
    {
        get { return _selectedItem2; }
        set
        {
            _selectedItem2 = value;
            OnPropertyChanged("SelectedItem2");
        }
    }
}

public class MyItem2 : ViewModelBase
{
    private string _name;
    public string Name
    {
        get { return _name; }
        set
        {
            _name = value;
            OnPropertyChanged("Name");
        }
    }

} 
```

`ViewModelBase`

```
public class ViewModelBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    public void OnPropertyChanged(string property)
    {
        if(PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(property));
    }
} 
```

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-07T16:33:07.737

啊，这很简单，你没有利用你的 onpropertychanged

在你的数据模板上试试这个

```
<DataTemplate DataType="{x:Type wpfApplication1:MyItem1}">
    <DataGrid AutoGenerateColumns="False" 
        ItemsSource="{Binding Item2s}" SelectedItem="{Binding Path=SelectedItem2,   
        UpdateSourceTrigger=PropertyChanged}"> 
```

………………

您需要 updatesourcetrigger，我只是为您的一个绑定提供代码，但无论您打算使用 propertychanged 更新值的任何地方，都需要这样做

我通常使用依赖属性，所以你不需要这样做，但是对依赖属性和 notifypropertychanged 做一些研究，你可以找到你想要的。

# iphone - UIView UIImageView 优化到什么程度？

> ID：14573937
> 
> 赞同：0
> 
> 时间：2013-01-29T00:56:38.693
> 
> 标签：iphone, ios, uiview, uiimageview, uikit

在我正在构建的游戏中，我想制作一个表示平铺地图的 UIView。我想知道填充 UIImageViews 网格的 UIView 在屏幕上动画时是否会滞后？我的第一个想法是，如果 UIVIew 真的被优化了，如果它们不在屏幕上，子视图就会知道不绘制自己，但我不知道 UIView 如何优化绘图的细节。

此外，如果这种方法可行，在出现问题之前我可以在一个视图中拥有多少个 64x64 像素图块是否有上限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:48:57.587

如果要表示平铺地图，为什么不使用`CATiledLayer`? 这就是为在例如地图中看到的平铺提供支持的原因。它提供了具有交叉淡入淡出的异步绘制瓷砖，支持不同的缩放级别等。

如果您要遵循最初的想法，我建议您删除屏幕外的图像视图（假设开始时网格足够大）。使用滚动视图委托方法很容易做到这一点。鉴于此，您遇到的任何延迟都可能是由于尝试在主线程上处理一堆图像数据（这是 的一个好处`CATiledLayer`；所有绘图都发生在后台线程上）。

# jsf - JSF/Prime（FileUpload 组件）multipart-form 不加载托管 bean 类参数

> ID：14573938
> 
> 赞同：1
> 
> 时间：2013-01-29T00:57:02.877
> 
> 标签：jsf, primefaces

我正在使用在 glassfifh 3.1 上运行的 NB 7.2.1 来开发 JSF/Primefaces 3.4 Web 应用程序。因此，当提交 multipart-form enctype 时，由“FileUploadListener”触发的事件不允许加载另一个类属性（如其他 JSF inputText 中的名称或年龄）。为什么？

这是视图：

```
 <h:form enctype="multipart/form-data">
    <p:outputLabel value="Nome" for="nome" />
    <p:inputText value="#{controller.nome}" id="nome" />
    <br />
    <p:fileUpload mode="advanced" multiple="true" fileUploadListener="#{controller.doSubmit}" />
  </h:form> 
```

这是豆：

```
@ManagedBean
@SessionScoped
public class Controller {

  private String nome;

  public String getNome() {
    return nome;
  }
  public void setNome(String nome) {
    this.nome = nome;
  }

  public Controller() {
  }

  public void doSubmit(FileUploadEvent event) {
    System.out.println(getNome());
  }
} 
```

在之前的“getName()”调用中，返回了 null。因此，一切都是相同的形式。为什么我可以检索 event.getFile() 而不能检索 getNome() ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-29T00:58:30.863

“上传”按钮不会提交整个表单。它只会上传文件。
为了提交整个表单，您需要一个普通的提交按钮。

在文件上传侦听器方法中，您只需将文件作为变量保存在视图范围的 bean 中，以便您可以在与普通提交按钮关联的操作方法中对其执行必要的业务逻辑，以及所有其他输入值。

例如

```
<h:form enctype="multipart/form-data">
    <p:outputLabel value="Nome" for="nome" />
    <p:inputText value="#{controller.nome}" id="nome" />
    <br />
    <p:fileUpload mode="advanced" multiple="true" fileUploadListener="#{controller.handleUpload}" />
    <p:commandButton value="submit" action="#{controller.doSubmit}" />
</h:form> 
```

和

```
@ManagedBean
@ViewScoped
public class Controller {

    private String nome;
    private List<File> files; // Whatever you need to get hold of all files.

    @PostConstruct
    public void init() {
        files = new ArrayList<File>();
    }

    public void handleUpload(FileUploadEvent event) {
        File file = save(event.getUploadedFile()); // Do your thing to save it.
        files.add(file);
    }

    public void doSubmit() {
        // Look, here you do the business job.
        System.out.println("Entered name: " + nome);
        System.out.println("Saved files: " + files);
    }

    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-28T13:54:53.500

通过使用 PrimeFaces fileupload 元素的 process 属性，我能够解决类似的情况。我在我的表单中列出了我想在文件上传后“提交”的所有组件，并且没有单独的按钮，只有三个。请注意，此解决方案会在文件上传**后**按列出的顺序“提交”进程中列出的组件值。同样，我在文件上传完成后使用 update 属性更新组件。在这种情况下，添加 process="name" 它应该做你需要的事情。

```
 <h:form enctype="multipart/form-data">
    <p:outputLabel value="Name" for="name" />
    <p:inputText value="#{controller.name}" id="name" />
    <br />
    <p:fileUpload process="name" mode="advanced" multiple="true" fileUploadListener="#{controller.handleUpload}" />
  </h:form> 
```

您的托管 bean 将类似于：

```
 @ManagedBean
    @ViewScoped
    public class Controller {

        private String name;
        private List<File> files; // Whatever you need to get hold of all files.

        @PostConstruct
        public void init() {
            files = new ArrayList<File>();
        }

        public void handleUpload(FileUploadEvent event) {
            File file = save(event.getUploadedFile()); // Do your thing to save it.
            files.add(file);
        }

        public void setName(String name) {
            this.name = name;

            if(!files.isEmpty()) {
               // ... do something with name and files ...
            }
        }
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-19T12:06:17.613

我能够使用**partialSubmit="true"**和**process**解决类似的情况。partialSubmit 部分处理的组件到 ajax 请求帖子。

```
<h:outputLabel for="saType" value="Sa Type"/>
                <p:selectOneMenu id="saType" required="true" value="#{saUploadController.saDetails.listType}">
                    <p:ajax event="change" partialSubmit="true"/>
                    <f:selectItem itemLabel="--select Type--"  itemValue=""/>
                    <f:selectItems value="#{saUploadController.saTypes}"/>
                </p:selectOneMenu>
                <h:outputLabel value="*select a file :"/> 
                <p:fileUpload id="uploadedFile1" value="#{saUploadController.uploadedFile}" mode="advanced" fileUploadListener="#{saUploadController.handleFileUpload}" allowTypes="/(\.|\/)(xml)$/" update="add:msgsAdd add:saType" process="saType"/>                      
                <p:message for="uploadedFile1" display="icon"/> 
```

使用`<p:ajax event="change" partialSubmit="true"/>` 我们可以部分提交下拉值，并通过`process="saType"`它将获取handleFileUpload方法的下拉项值

# java - Java中的JARVIS娱乐

> ID：14573944
> 
> 赞同：1
> 
> 时间：2013-01-29T00:58:12.750
> 
> 标签：java, speech, home-automation

如果你看过钢铁侠或钢铁侠 2，你就会知道他有一个可以做很多事情的助手。

这更像是一个意见问题。

Java 会是最好的语言吗，我在想是因为它是一种面向对象的语言，还是应该是其他语言？

我应该对语音识别进行编码还是应该使用像 Google 的 Api 这样的服务？

我应该为家庭自动化使用什么？

我应该使用人脸识别还是 RFID 卡？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:18:00.850

我同意这样的系统需要一种面向对象的语言。但是请记住，仅仅选择一种 OO 语言并不会自动授予您任何东西。在开始实施之前，您需要有一个经过深思熟虑的设计，或者至少准备好随时对整个结构进行大量彻底的修改（如果不是两者都做的话）。

除此之外，我会选择 C# .NET，一方面是因为我发现它更具表现力（因为它的语法更丰富），另一方面是因为它有有趣的库。首先，语音到文本和文本到语音是内置的，并且非常容易立即使用。此外，网络与网络在大多数现代语言中的痛苦一样小，比方说，如果您需要与 LAN 进行任何通信，这将被证明是有用的。如果您想创造性地了解程序如何在您的计算机上自动执行各种操作，该库还可以让您轻松访问文件系统观察器、系统诊断等。此外，可用于 C# 的是 Touchless SDK，这是一个非常直观的库，用于通过网络摄像头跟踪对象，我可以很容易地想象它对您的工作很有用。

无论您选择哪种语言，我都强烈建议您不要重新实现已经存在 API 的东西。对这个程序的核心逻辑进行计算和编码本身就是一项非常艰巨的任务，因此尝试对其（也非常复杂的）部分进行半生不熟的实现真的没有意义——而且无论如何这可能会令人沮丧。

# ios - 在 Interface Builder 中创建工具栏信息按钮

> ID：14573945
> 
> 赞同：3
> 
> 时间：2013-01-29T00:58:21.927
> 
> 标签：ios, button, xcode4.5, toolbar

`UIButton:buttonWithType:`我知道如何使用和`UIBarButtonItem:initWithCustomView:`提供`UIButton:buttonWithType`参数以编程方式创建工具栏按钮`UIButtonTypeInfoLight`。

我真正想做的是将系统按钮拖到通用 barbuttonitem 上以获取信息按钮。在界面生成器中。这是一个人可以做的事情，还是我应该站起来编写代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-19T22:14:31.417

尝试这个...

```
let     infoButton        = UIButton.init( type: .infoLight )
let     infoBarButtonItem = UIBarButtonItem.init( image:  infoButton.image( for: .normal ),
                                                  style: .plain,
                                                  target: self,
                                                  action: #selector( infoBarButtonItemTouched ) ) 
```

# c - 在 C 中生成字符串组合的程序

> ID：14573951
> 
> 赞同：-3
> 
> 时间：2013-01-29T00:59:05.133
> 
> 标签：c, string, combinations

我想用 C 语言编写一个程序，生成一个包含所有可能字符串的文件：

2 个数字（从 0 到 9）和 6 个字母（从 a 到 z）

我该怎么做？

我也不知道有多少组合

你能帮我吗？多谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:01:53.430

1.  设计一种算法，将您想要的输出映射到一系列连续的数字。

2.  在代码中实现该算法。

3.  为系列中的每个数字调用该算法。

对于第一个数字，有 10 种可能性。对于这 10 种可能性中的每一种，第二个数字有 10 种可能性，前两个数字总共有 100 种可能性。对于这 100 种可能性中的每一种，第一个字母有 26 种可能性，前三个数字总共有 2,600 种可能性。等等。

这是另一种方法：

1.  设计一种算法，将所有可能的合法值严格排序，这样就有第一个值，最后一个值，并且每个值都大于或小于其他值。

2.  在代码中实现一种根据步骤 1 中的算法生成“下一个”值的方法。

3.  转到第一个合法值。

4.  输出值。

5.  如果这是最后的合法输出，请停止。

6.  使用步骤 2 中的代码转到下一个值。转到第 4 步。

很清楚你可以使用什么顺序，按字母顺序排列。第一个输出是“00aaaaaa”。最后一个是“99zzzzzz”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T01:24:33.810

至于有多少组合：

*   [0, 9] 范围内的两位数字，表示 10 ²种可能性。

*   [a, z] 范围内的六位数字表示 26 ⁶种可能性。

*   8-choose-2 方法将两个数字放在总共八位数字中。（那是 28。）

现在将所有内容相乘。

# multithreading - 如何避免在我的应用程序中闪烁？

> ID：14573952
> 
> 赞同：3
> 
> 时间：2013-01-29T00:59:05.593
> 
> 标签：multithreading, delphi, user-interface, iteration, flicker

这是每个开发人员不时面临的一个非常常见的问题，当视觉更新可能如此快速和快速以至于导致表单内容闪烁时。我目前正在使用一个线程来搜索文件并触发一个事件到它的调用（主 VCL）线程来报告每个搜索结果。如果您曾经使用过`FindFirst`/ `FindNext`，或者为此执行过非常快速且快速的迭代的任何大型循环，那么您就会知道在每次小迭代上更新 GUI 都非常繁重，并且几乎违背了线程的目的，因为线程随后变得依赖于 GUI 更新的速度（在线程内的每次迭代中）。

我对来自线程的每个事件（1 毫秒内可能有 100 个事件）所做的只是增加一个全局整数，以计算迭代次数。然后，我在主窗体的标签中显示该数字。可以想象，来自线程的快速更新会导致闪烁无法控制。

所以我想知道的是，当线程向它提供事件的速度快于它能够更新的速度时，如何避免 GUI 中的这种快速闪烁？

注意：我使用的是 VCL 样式，所以闪烁变得更糟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T00:59:05.593

这确实是一个常见问题，并不总是由线程引起，而是由任何需要更新 GUI 的循环引起，同时循环的迭代速度比 GUI 能够更新的速度快。快速简便的解决方案是使用计时器来更新您的 GUI。每当循环触发更新时，不要立即更新 GUI。相反，为每个可能需要更新的东西（显示计数的标签）设置一个全局变量（如全局迭代计数），然后让计时器进行 GUI 更新。将计时器的间隔设置为 100-200 毫秒。这样，您可以控制 GUI 更新的频率与您设置的计时器间隔一样频繁。

另一个优点是线程的性能将不再取决于 GUI 更新的速度。线程可以触发它的事件并且只增加这个整数，然后继续它的工作。请记住，您仍然必须确保对 GUI 进行线程保护。这本身就是一门艺术，我不会介绍它，假设你已经知道了。

**注意：您需要执行的 GUI 更新越多，您可能需要调整计时器的间隔就越高。**

# ios - 在 Bg 中下载一堆文件

> ID：14573955
> 
> 赞同：0
> 
> 时间：2013-01-29T00:59:24.577
> 
> 标签：ios, ios5, networking

我需要从 ftp 服务器下载一堆文件（~600mb）。

问题是如何最好地实施它？最简单的解决方案是每次应用程序返回前台时暂停\恢复下载。当然，问题在于用户将无法启动下载、锁定 iPad 并在完成后返回。

iOS 是否允许完全在后台下载这么多文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T01:55:17.053

如果您是报亭应用程序并下载杂志的问题，则仅允许在后台运行以下载内容。请参阅[此文档](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW24)以供参考。我假设您的应用不是报亭应用。

但是，当您的应用程序移至后台时，您也可以要求额外的时间来完成您的任务。的结帐[`beginBackgroundTaskWithExpirationHandler:`](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/beginBackgroundTaskWithExpirationHandler%3a)方法，`UIApplication`看看你如何做到这一点。它会给你大约 10 分钟的时间来完成你的任务。下载所有文件可能还不够，但它可以让您的应用下载其中的一些文件。

我想您也可以在后台执行时间即将结束时向用户发送本地推送通知，让他再次打开应用程序并继续下载。但是，我之前没有发送任何本地通知，所以我不确定是否可以在执行后台任务时发送它们。

# python - 多余的 Django 代码

> ID：14573957
> 
> 赞同：0
> 
> 时间：2013-01-29T00:59:31.330
> 
> 标签：python, django, django-views, django-generic-views

我有一些我写的代码，它可以很好地用于它的目的。

```
from django.shortcuts import get_object_or_404
from django.views.generic import ListView
from cab.models import Language

class LanguageDetail(ListView):

    def get_queryset(self):
        slug = self.kwargs['slug']
        language = get_object_or_404(Language, slug=slug)
        return language.snippet_set.all()

    paginate_by = 20
    template_name = 'cab/language_detail.html'

    def get_context_data(self, **kwargs):
        slug = self.kwargs['slug']
        language = get_object_or_404(Language, slug=slug)
        context = super(LanguageDetail, self).get_context_data(**kwargs)
        context['language'] = language
        return context 
```

我的问题是我在两个函数中重复了两行代码，我不喜欢这样。

```
slug = self.kwargs['slug']
language = get_object_or_404(Language, slug=slug) 
```

我怎么能避免呢？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:23:28.353

你的意思是这样的吗？

```
def get_slug(self, name):   
    slug = self.kwargs[name]
    return get_object_or_404(Language, slug=slug) 
```

可以用作`language = self.get_slug('slug')`

请记住，如果`kwargs`不包含`name`，则会引发错误。为了防止这种情况，您可以执行以下操作：

```
slug = self.kwargs.get(name, None)
if slug is not None:
    ... 
```

# php - 无法让 php exec() 运行

> ID：14573961
> 
> 赞同：2
> 
> 时间：2013-01-29T00:59:59.760
> 
> 标签：php, pdftk

我正在尝试运行以下命令，但据我所知它没有运行，因为没有生成文件。我根本没有收到任何错误消息，当我在我的 linux 机器上测试它时，这个命令运行良好，但我正在将我的网站转移到运行 xampp 的 Windows 机器上，因为我几天都没有互联网连接。所以我正在更改命令以使用 Windows。我认为我的命令中一定有错误，但由于我在 Windows 上使用 apache 和 php 的经验很少，我希望如果有错误，其他人可以发现错误。

```
$command = 'C:\\Program Files (x86)\\PDF Labs\\PDFtk Server\\bin\\pdftk.exe C:\\xampp\\htdocs\\lc712\\pdf\\TimeCard.pdf fill_form C:\\xampp\\htdocs\\lc712\\pdf\\results\\' . $userName . '.fdf' . ' output C:\\xampp\\htdocs\\lc712\\pdf\\results\\' . $userName . '.pdf flatten';
    exec($command); 
```

这是有效的最终代码：

```
$command = '"C:\Program Files (x86)\PDF Labs\PDFtk Server\bin\pdftk.exe" C:\xampp\htdocs\pdf\TimeCard.pdf fill_form C:\xampp\htdocs\pdf\results\\' . $userName . '.fdf' . ' output C:\xampp\htdocs\pdf\results\\' . $userName . '.pdf flatten';
    exec($command); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T01:31:41.113

`C:\Program Files (x86)\PDF Labs\PDFtk Server\bin\pdftk.exe`包含空格，因此 Windows 将尝试`C:\Program`使用参数执行`Files`, `(x86)\PDF`, `Labs\PDFtk`, `Server\bin\pdftk.exe`, ...

尝试用引号转义路径：

```
$command = '"C:\\Program Files (x86)\\PDF Labs\\PDFtk Server\\bin\\pdftk.exe" C:\\xampp\\htdocs\\lc712\\pdf\\TimeCard.pdf fill_form C:\\xampp\\htdocs\\lc712\\pdf\\results\\' . $userName . '.fdf' . ' output C:\\xampp\\htdocs\\lc712\\pdf\\results\\' . $userName . '.pdf flatten';
exec($command); 
```

# java - ForEach 的替代品？

> ID：14573964
> 
> 赞同：0
> 
> 时间：2013-01-29T01:00:12.677
> 
> 标签：java, foreach, while-loop, cycle

我有具有以下属性的类考试：

```
package logic;

import java.util.ArrayList;

public class Exam {

    private int number;
    private Professor professor;
    private ArrayList<Question> questions = new ArrayList<Question>();
    private ArrayList<Test> tests = new ArrayList<Test>();

    ... // getters, setters, etcetera

} 
```

我的问题是关于构造函数：

```
public Exam(Professor professor, ArrayList<Question> questions) {

    this.professor = professor;

    for(Question question : questions) // <---
        this.questions.add(question); // <---

} 
```

为了添加问题，是否有任何替代 foreach 的方法？例如，使用一段时间或另一个循环？怎么会这样？我一直在尝试，但无法使其工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-29T01:01:31.980

简单的怎么样[`List#addAll()`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#addAll%28java.util.Collection%29)？

```
this.questions.addAll(questions); 
```

* * *

请注意，如果您解释*了为什么*您当前的代码不适合您，以及它是*如何*失败的（编译错误？运行时异常？其他什么？），将会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T01:05:37.087

1.  [构造函数](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#ArrayList%28java.util.Collection%29)

    this.questions = new ArrayList(questions);

2.  [列表#addAll](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#addAll%28java.util.Collection%29)

    this.questions.addAll(问题);

3.  任务

    this.questions = 问题；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T01:04:06.830

```
// assign the passed ArrayList to the class attribute
this.questions = questions; 
```

# asp.net-mvc - 在 Kendo Treeview 的 Expand 事件期间传递附加参数

> ID：14573971
> 
> 赞同：3
> 
> 时间：2013-01-29T01:01:10.623
> 
> 标签：asp.net-mvc, razor, kendo-ui, kendo-treeview

我在与 Treeview 相同的页面上有一个 Kendo Gridview。Gridview 包含与当前用户关联的客户端行。当 Gridview 中的一个客户端行被选中时，我触发 Treeview 再次读取 DataSource（selectedClient 是 Gridview 中的一行被选中时设置的 js 变量）：

```
$("#folderTreeView").data("kendoTreeView").dataSource.read({ userId: _selectedClient }) 
```

TreeView 的重新绑定工作完美。问题是当新的 TreeView 具有带有嵌套文件夹的文件夹结构时。单击“展开”图标时，仅传递项目的 id，但我还需要从 GridView 传递当前选择的客户端（存储在 _selectedClient 中）。

那么，有没有办法在“展开”事件期间或以其他方式将附加参数（在这种情况下为 userId/_selectedClient）添加到传递给服务器的“任何内容”？

控制器

```
[HttpPost]
public virtual JsonResult List(int? userId, int? id)
{
 ....
} 
```

剃刀

```
@(Html.Kendo().TreeView()
    .Name("folderTreeView")
    .DataTextField("Name")
    .DataSource(dataSource => dataSource
        .Read(read => read.Action("List", "Folder", new { area = "Portal"           }).Type(HttpVerbs.Post)
        )
    )
    .Events(events => events
        .Expand("onSelect")
        )
) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T19:49:40.997

我今天发现了这个，它适用于网格，但我假设它适用于使用 DataSource 的任何其他东西：

```
@(Html.Kendo().Grid<MvcApplication1.Models.Product>()
.Name("Grid")
.DataSource(dataSource => dataSource
    .Ajax()
    .Read(read => read.Action("Products_Read", "Home")
        .Data("additionalData") // the name of the JavaScript function which will return the additional data
    )
)
.Pageable()
)
<script>
function additionalData() {
    return {
        firstName: "John",
        lastName: "Doe"
    };
}
</script> 
```

阅读更多关于[剑道文档的](http://docs.kendoui.com/getting-started/using-kendo-with/aspnet-mvc/helpers/grid/ajax-binding#pass-additional-data-to-action-method)信息......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-29T01:59:16.700

我终于找到了 ——http: [//docs.kendoui.c​​om /getting-started/using-kendo-with/aspnet-mvc/migration/widgets/treeview](http://docs.kendoui.com/getting-started/using-kendo-with/aspnet-mvc/migration/widgets/treeview)

**DataSource 事件**如下所述...

```
<script>
  function addData(data) {
    return { userId: _selectedClient };
  }
</script>

<div class="demo-section">
  @(Html.Kendo().TreeView()
        .Name("folderTreeView")
        .DataTextField("Name")
        .DataSource(dataSource => dataSource
            .Read(read => read
              .Action("List", "Folder", new { area = "Portal" })
              .Type(HttpVerbs.Post)
              .Data("addData")
            )
        )
    )
</div> 
```

# encryption - 代码分析以提高性能：查看 mscorlib.dll 中的 CPU 周期？

> ID：14573972
> 
> 赞同：4
> 
> 时间：2013-01-29T01:01:15.170
> 
> 标签：encryption, profiling, bouncycastle

我做了一个小型测试基准，比较了 .NET 的`System.Security.Cryptography`AES 实现与 BouncyCastle.Org 的 AES。

GitHub 代码链接：[https ://github.com/sidshetye/BouncyBench](https://github.com/sidshetye/BouncyBench)

我对 AES-GCM 特别感兴趣，因为它是一种“更好”的加密算法，而 .NET 缺少它。我注意到，虽然 .NET 和 BouncyCastle 之间的 AES 实现非常相似，但 GCM 性能却很差（有关更多信息，请参阅下面的*额外背景*）。我怀疑这是由于许多缓冲区副本或其他原因。为了更深入地了解，我尝试分析代码（VS2012 =>`Analyze`菜单栏选项 => `Launch performance wizard`）并注意到 mscorlib.dll 中有很多 CPU 烧伤

![在此处输入图像描述](../Images/ca6b1b939053cef3af73b767d2fa2da1.png)

***问题：在这种情况下，我如何才能弄清楚是什么占用了大部分 CPU？***现在我所知道的是“Init() 中的某些行/调用会在 mscorlib.ni.dll 中消耗 47% 的 CPU” - 但不知道具体的行，我不知道在哪里（尝试和）优化。有什么线索吗？

***额外背景：***

基于David A. McGrew的“ *The Galois/Counter Mode of Operation (GCM) ”论文，我阅读了“**二进制字段中的乘法可以使用各种时间-内存权衡。它可以在不依赖键的内存的情况下实现，在这种情况下，它的运行速度通常比 AES 慢几倍。愿意牺牲适度内存的实现可以轻松实现**比 AES 更高的***速度*。*

如果你看一下结果，基本的 AES-CBC 引擎性能是非常可比的。AES-GCM 添加 GCM 并在 CTR 模式下重用其下方的 AES 引擎（比 CBC 更快）。但是，GCM 除了 CTR 模式外，还在 GF(2^128) 字段中添加了乘法，因此可能存在其他减速区域。无论如何，这就是我尝试分析代码的原因。

对于感兴趣的人，我的快速测试性能基准在哪里。它位于 Windows 8 VM 和 YMMV 中。该测试是可配置的，但目前它是在加密数据库的许多单元格时模拟加密开销（=> 许多但很小的明文输入）

```
Creating initial random bytes ...
Benchmark test is : Encrypt=>Decrypt 10 bytes 100 times

Name               time (ms)    plain(bytes) encypted(bytes)   byte overhead

.NET ciphers
AES128                1.5969              10              32      220 %
AES256                1.4131              10              32      220 %
AES128-HMACSHA256     2.5834              10              64      540 %
AES256-HMACSHA256     2.6029              10              64      540 %

BouncyCastle Ciphers
AES128/CBC            1.3691              10              32      220 %
AES256/CBC            1.5798              10              32      220 %
AES128-GCM           26.5225              10              42      320 %
AES256-GCM           26.3741              10              42      320 %

R - Rerun tests
C - Change size(10) and iterations(100)
Q - Quit 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T06:14:19.337

这是微软的一个相当蹩脚的举动，因为他们显然破坏了在 Windows 8 之前运行良好但不再有效的功能，正如[MSDN 博客文章](http://blogs.msdn.com/b/visualstudioalm/archive/2012/12/10/creating-ngen-pdbs-for-profiling-reports.aspx)中所解释的那样: :

> 在 Windows 8 上，探查器使用的底层技术与在以前版本的 Windows 上使用的不同，这就是为什么在 Windows 8 上的行为有所不同。使用新技术，探查器需要符号文件 (PDB) 来了解函数是什么当前在 NGEN 的图像中执行。

(...)

> 然而，在下一版本的 Visual Studio 中实现它是我们的积压工作。

该帖子提供了自己生成 PDB 文件的说明（谢谢！）。

# ios - 向主视图控制器添加表，但出现内存泄漏？

> ID：14573976
> 
> 赞同：-1
> 
> 时间：2013-01-29T01:01:31.200
> 
> 标签：ios, objective-c, xcode

![我不确定这表明了什么，但任何帮助都会很棒。](../Images/5c182cb12ad5f6ad7734e1a8e4507d1e.png)

这是来自 mainviewcontroller 的代码

```
#import "MainViewController.h"

#import "ECSlidingViewController.h"
#import "MenuViewController.h"

@interface MainViewController ()

@end

@implementation MainViewController
{
    NSArray *toDoList;
}

@synthesize menuBtn;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    // Do any additional setup after loading the view.
    [super viewDidLoad];
    //initialize table data
    toDoList = [NSArray arrayWithObjects:@"Apples", "Bananas", "Soda", nil]; 
```

...

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [toDoList count];

}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *simpleTableIdentifier = @"ToDoList";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:simpleTableIdentifier];
    }

    cell.textLabel.text = [toDoList objectAtIndex:indexPath.row];
    return cell;

} 
```

从滑动视图控制器

```
- (void)setTopViewController:(UIViewController *)theTopViewController
{
  CGRect topViewFrame = _topViewController ? _topViewController.view.frame : self.view.bounds;

  [self removeTopViewSnapshot];
  [_topViewController.view removeFromSuperview];
  [_topViewController willMoveToParentViewController:nil];
  [_topViewController removeFromParentViewController];

  _topViewController = theTopViewController;

  [self addChildViewController:self.topViewController];
  [self.topViewController didMoveToParentViewController:self];

  [_topViewController.view setAutoresizingMask:self.autoResizeToFillScreen];
  [_topViewController.view setFrame:topViewFrame];
  _topViewController.view.layer.shadowOffset = CGSizeZero;
  _topViewController.view.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.view.layer.bounds].CGPath;

  [self.view addSubview:_topViewController.view];
} 
```

初始化视图控制器..

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.topViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"Main"];
  } 
```

和 main.m

```
#import "AppDelegate.h"

int main(int argc, char *argv[])
{
    @autoreleasepool {
        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T01:39:44.230

崩溃是由以下代码行引起的`viewDidLoad`：

```
toDoList = [NSArray arrayWithObjects:@"Apples", "Bananas", "Soda", nil]; 
```

您正在尝试添加一个`NSString`和两个 C 字符串。试试这个：

```
toDoList = [NSArray arrayWithObjects:@"Apples", @"Bananas", @"Soda", nil]; 
```

我很惊讶这行代码没有编译器警告。永远不要忽略编译器警告。

# iphone - 我应该如何将两个具有相同类名的 iPhone 应用程序结合起来？

> ID：14573989
> 
> 赞同：0
> 
> 时间：2013-01-29T01:03:06.073
> 
> 标签：iphone, ios

我有两个应用程序，它们的代码库非常相似，但充满了不同的数据、标签、图像等。

我想在启动时制作一个带有两个按钮的新应用，每个应用一个按钮。

我不能只是将它们组合起来，因为这些应用程序共享许多相同的类名。

做这个的最好方式是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T05:20:47.540

> 有没有办法一次重构每个文件？

不，Xcode 中没有工具可以同时重命名应用程序中的所有标识符。但是，如果您使用重命名工具，您可以一次更改给定标识符的所有用途，这样可以节省大量时间。您可以在一小时或更短的时间内轻松重命名几十个类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T05:32:03.340

您可以使用 Xcode 的“重构”功能。

首先创建一个项目。做你想要的一切。然后，只需重构项目并给出第二个项目名称。

这样，您将拥有 2 个具有不同名称的项目副本，您可以实现您的目标。

快乐编码。

干杯!

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-29T05:40:35.160

您需要重命名所有类！

作为一个项目不包含同名类。

简单地添加一些扩展来区分你的类，比如

LoginViewController_firstapp.h

和

LoginViewController_secondapp.h 等

使用重构工具！它的作用就像一个魅力！

享受编码

![重构视图](../Images/1ab9ed995d76da7a9a6189e41196223a.png)

# ios - 子类 PFLogInViewController 以呈现自定义 UIAlertViews

> ID：14573991
> 
> 赞同：2
> 
> 时间：2013-01-29T01:03:15.173
> 
> 标签：ios, subclass

我使用 Parse 作为我的 iOS 应用程序的后端，并且我还使用本机`PFLogInViewController`&`PFSignUpViewController`来完成登录和注册任务。

**问题？**

我在整个应用程序中自定义了 UIAlertViews 的外观，结果证明 Parse 在其本机 PFLogInViewController 和 PFSignUpViewController 实现中对 UIAlertViews 进行了硬编码调用。此警报视图的一个示例是由于用户名和密码组合不正确而导致登录失败。

我想知道如何继承`PFLogInViewController`&`PFSignUpViewController`并实现我自己的自定义 UIAlertView 类。

编辑——有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-31T19:19:07.347

`PFLogInViewController`不提供改变这种行为的钩子。您可能想要构建自己的自定义`PFLogInViewController`子类并覆盖登录失败时显示警报视图的方法。

由于 PFLogInViewController 的代码[已经开源](https://github.com/ParsePlatform/ParseUI-iOS)，根据它显示警报视图的方法是`_loginDidFailWithError`。

[https://github.com/ParsePlatform/ParseUI-iOS/blob/master/ParseUI/Classes/LogInViewController/PFLogInViewController.m#L382-L390](https://github.com/ParsePlatform/ParseUI-iOS/blob/master/ParseUI/Classes/LogInViewController/PFLogInViewController.m#L382-L390)

> ```
> - (void)_loginDidFailWithError:(NSError *)error {
>     if (_delegateExistingMethods.didFailToLogIn) {
>         [_delegate logInViewController:self didFailToLogInWithError:error];
>     }
>     [[NSNotificationCenter defaultCenter] postNotificationName:PFLogInFailureNotification object:self];
> 
>     NSString *title = NSLocalizedString(@"Login Error", @"Login error alert title in PFLogInViewController");
>     [PFUIAlertView showAlertViewWithTitle:title error:error];
> } 
> ```

例如，如果您喜欢以下内容，则可以在登录失败时不显示警报。定义`MYLogInViewController`为的子类`PFLogInViewController`

```
@interface MYLogInViewController : PFLogInViewController

@end

@implementation MYLogInViewController

- (void)_loginDidFailWithError:(NSError *)error {
    if ([self.delegate respondsToSelector:@selector(logInViewController:didFailToLogInWithError:)]) {
        [self.delegate logInViewController:self didFailToLogInWithError:error];
    }
    [[NSNotificationCenter defaultCenter] postNotificationName:PFLogInFailureNotification object:self];

    NSString *title = NSLocalizedString(@"Login Error", @"Login error alert title in PFLogInViewController");
    //
    // Implement to display your custom alert view
    //
}

@end 
```

并改用它`PFLogInViewController`

```
MYLogInViewController *logInViewController = [[MYLogInViewController alloc] init];
logInViewController.delegate = self;
[self presentViewController:logInViewController animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:35:56.943

请参阅此处：[https](https://parse.com/tutorials/login-and-signup-views) ://parse.com/tutorials/login-and-signup-views在“完全自定义的子类化”下。

# java - 嵌套 SQL 生成器？

> ID：14573994
> 
> 赞同：1
> 
> 时间：2013-01-29T01:03:33.000
> 
> 标签：java, sql

我正在尝试创建一个嵌套的 SELECT SQL 语句。我存储所有值和 id，并希望选择满足多个值的行。如何使用 Java 生成 SELECT 语句？例如，

```
ID VALUE
1  RED
2  BIG
1  SMALL
1  SMOOTH
2  TALL 
```

......

要选择一个既是红色又是小的项目，语句将是：

```
SELECT * 
FROM table 
WHERE table.value = RED AND 
       id IN (SELECT * 
              FROM table 
              WHERE table.value = SMALL AND id IN (...)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T01:07:28.693

这种类型的问题称为`Relational Division`

```
SELECT ID
FROM tableName
WHERE VALUE IN ('SMALL','SMOOTH')
GROUP BY ID
HAVING COUNT(*) = 2 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/42cff/3)

`1`由于 ID 包含**两条**记录，因此将产生上述查询。

如果没有`value`对每个强制执行唯一约束`ID`，`DISTINCT`则需要。

```
SELECT ID
FROM tableName
WHERE VALUE IN ('SMALL','SMOOTH')
GROUP BY ID
HAVING COUNT(DISTINCT VALUE) = 2 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/42cff/5)
*   [SQLFiddle 演示（*有重复*）](http://sqlfiddle.com/#!2/fbd22/1)

其他）

*   [关系划分的SQL](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T01:08:06.710

```
select ID
from MyTable
where VALUE in ('RED', 'SMALL')
group by ID
having count(distinct VALUE) = 2 
```

[SQL 小提琴示例](http://sqlfiddle.com/#!3/9b05e/1)

**结果**：

```
| ID |
------
|  1 | 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-29T01:45:04.417

这是解决此问题的一般方法：

```
select id
from t
group by id
having max(case when value = 'Red' then 1 else 0 end) = 1 and
       max(case when value = 'Small' then 1 else 0 end) = 1 
```

换句话说，集合中的成员资格成为语句中的子句`having`。这些可以是包含和排除（使用`= 0`代替`= 1`）和可选（使用`or`代替`and`）。

# c# - 设计具有相似功能但返回类型不同的方法

> ID：14573998
> 
> 赞同：1
> 
> 时间：2013-01-29T01:04:00.620
> 
> 标签：c#, oop, class-design

我正在编写一个从给定文件中解析文本的类。有几种不同的文本“类型”，每种的解析规则都不同。

例如，一种类型的文本，我们将称之为“纯文本”，是一个简单的字符串，解析器会为其去除额外的空格。因此，例如，如果我有 `"The quick brown fox\r\njumped over the lazy brown dogs\r\n"`，解析器只会返回`"The quick brown fox jumped over the lazy brown dogs"`（换行符转换为单个空格）。

其他文本代表具有给定分隔符的表，因此它可能看起来像`"First Name,Last Name,DOB"`，并且解析器的工作是返回一个包含每个逗号分隔值的数组。

（实际实现比这更复杂，但这是一个很好的简化）。

最初我打算通过创建一个名为类似`TextType`、 值`PlainText`和的枚举来解决这个问题`TableText`。然后我可以有一个看起来像的方法

```
public string ParseText(string textToParse, TextType textType) 
```

我很快意识到这不起作用，因为当 textType 是 PlainText 时，返回值应该是 a `string`，但是当 textType 是 TableText 时，返回值应该是 a `string[]`。

一种选择是始终返回一个字符串 [] 并且将其作为一个给定的，即 PlainText 将始终返回一个大小为 1 的数组。不过我对此并不感到太兴奋，因为它在语义上似乎不正确并且可能是令人困惑。

另一种选择是为每个 TextType 编写一个方法，这样我就可以

```
public string ParsePlainText(string textToParse) 
```

和

```
public string[] ParseTableText(string textToParse) 
```

我不喜欢这种方法的原因是它消除了原始方法与枚举提供的一些灵活性。例如，预计我稍后会添加其他文本类型；将来我可能会有一种客户希望识别为 HeadingText 的文本类型，但会以与纯文本相同的方式进行解析。使用原始方法，包含解析方法的类的公共接口不必更改，因为我只需向`TextType`枚举并修改 ParseText 方法的内部结构。此外，我认为当只有一个方法可以调用时，它只是一个更简洁的界面，客户端只需传递 TextType（他知道），其他一切都为他处理（而不是必须从类似命名的列表中选择）每次添加新文本类型时都会增长的方法）。

最后，我可以只返回一个既可以继承`string`又可以`string[]`继承的对象（因为这是 C#，我可以直接 return `object`），并让客户端转换为适当的类型。我认为这是最糟糕的方法，因为它要求客户端知道应该“实际”返回什么，并且通过更改从 Parse 类返回的类型并且直到运行时才遇到结果错误，有很大的潜力让某人打破每个依赖项（因为基本上没有类型检查开始）。

对于这种情况，是否有“正确”或最佳的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T01:10:00.257

有几种方法..但首先想到的是使用`interfaces`：

```
interface ITextParser {
    string Parse(string text);
}

public class TableTextParser : ITextParser {
    public string Parse(string text) {
        // specific table parsing stuff here
    }
}

public class PlainTextParser : ITextParser {
    public string Parse(string text) {
        // specific plain text parsing stuff here
    }
} 
```

然后，您的主要功能可能会变成某种工厂，如下所示：

```
public ITextParser CreateParserFor(string textToParse) {
    // logic here to determine the sort of parser you require:
    if (typeOfTextIsTable)
        return new TableTextParser();

    if (typeOfTextIsPlain)
        return new PlainTextParser();
} 
```

然后你也许可以这样称呼它：

```
var parser = CreateParserFor(string_here);
var result = parser.Parse(string_here); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-29T03:03:11.420

让我们试着澄清一下这个问题。您有两种类型的文本（至少目前，可能会增长到更多类型），即：

1.  具有相同的输入类型，String。
2.  有不同的输出类型，字符串和数组。
3.  有不同的实现。

未来添加的类型可能需要不同类型的输出/返回。现在的问题是，尝试将这些功能组合成一种方法真的合乎逻辑吗？我看到您的目标是为客户端提供统一/通用接口，但是，如果返回类型不同，我不确定您是否可以提供这样的接口。

我不认为在接口中有许多类似的方法是一件坏事。有很多知名的库都是这样的。

在我看来，你的第二种方法，有类似

```
public string ParsePlainText(string textToParse)
public string[] ParseTableText(string textToParse) 
```

尽管您怀疑，但它比其他建议的方式更清洁。特别是，如果您从客户端视图中查看它（与返回大小为 1 的数组或使用强制转换等的情况相比）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T00:38:21.080

对于建议的任何方法，您可以从表示结果集合`ParseResults`的方法中返回一个对象。`Parse`然后，这可以公开一个`iterator`以迭代`ParseResults`.

这使您的签名保持统一，IMO 不会混淆。

希望这可以帮助。