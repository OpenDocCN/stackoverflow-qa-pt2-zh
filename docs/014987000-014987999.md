# StackOverflow 问答 14987000-14987999

# android - 为本地化 Android 更改语言时出错

> ID：14987000
> 
> 赞同：1
> 
> 时间：2013-02-20T18:12:51.017
> 
> 标签：android, button, localization

目前在做一个安卓项目。我正在尝试实现一个按钮，该按钮允许我将语言从英语更改为西班牙语。这是我的代码：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //As soon as app is started up create an order object.
    order = new Order();
    order.setCovers(2);
    order.setTable(1);
    order.addToOrder(new MenuItem("Item 1", 12.99));
    Toast.makeText(getApplicationContext(), "order size: " + order.getItems().size(), Toast.LENGTH_SHORT).show();

    //reference to button and add listeners
    orderBtn = (Button)findViewById(R.id.orderBtn);
    orderBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            //Create a new intent and start up the sections activity...
            i = new Intent(v.getContext(), SectionsActivity.class);
            i.putExtra("data", order);
            startActivity(i);
        }
    });

spanishBtn = (Button)findViewById(R.id.spanishBtn);
spanishBtn.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v) {
        Locale locale = new Locale("es");
        Locale.setDefault(locale);
        Configuration config = new Configuration();
        config.locale = locale; 
        getBaseContext().getResources().updateConfiguration(config, getBaseContext().getResources().getDisplayMetrics());

    }
});

} 
```

该按钮不会更改语言。它离开它为英语。但是，如果我在活动顶部使用此代码运行我的项目，它会以西班牙语加载文本。

```
Locale locale = new Locale("es");
    Locale.setDefault(locale);
    Configuration config = new Configuration();
    config.locale = locale; 
    getBaseContext().getResources().updateConfiguration(config, getBaseContext().getResources().getDisplayMetrics()); 
```

我究竟做错了什么？任何建议都非常感谢。我希望从上面的代码中实现的是应用程序以英语启动，从 values-en 文件夹中获取字符串值。然后，当我单击按钮时，它会从 values-es 文件夹中加载字符串值。

将侦听器更改为：

```
 spanishBtn = (Button)findViewById(R.id.spanishBtn);
spanishBtn.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v) {
        Locale locale = new Locale("es");
        Locale.setDefault(locale);
        Configuration config = new Configuration();
        config.locale = locale; 
        getBaseContext().getResources().updateConfiguration(config, getBaseContext().getResources().getDisplayMetrics());
        MainActivity.this.setContentView(R.layout.activity_main);

    }
}); 
```

还是行不通...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:42:06.850

最好的办法是在设置默认语言环境后重新加载活动。因此，将您的代码修改为：

```
spanishBtn = (Button)findViewById(R.id.spanishBtn);
spanishBtn.setOnClickListener(new View.OnClickListener() {
@Override
public void onClick(View v) {
    Locale locale = new Locale("es");
    Locale.setDefault(locale);
    Configuration config = new Configuration();
    config.locale = locale; 
    getBaseContext().getResources().updateConfiguration(config, getBaseContext().getResources().getDisplayMetrics());
    Intent i = new Intent(v.getContext(), YourActivityName.class);
   startActivity(i);
}
}); 
```

This will just reload the activity with the default language set to Spanish!

# xml - 复杂 XSLT 指南

> ID：14987003
> 
> 赞同：1
> 
> 时间：2013-02-20T18:13:01.860
> 
> 标签：xml, xslt, xslt-1.0

我正在解析要转换为文本并提交给 FinCEN 的 XML，后者要求它采用非常特定的格式。基本上，我会得到一个 xml 文件，其中的元素全部排列为同级元素，它们之间的关联基于文件中的出现顺序。所以我可能有一个看起来像这样的文件：

```
<bsar:BSAForm xmlns:bsar="http://www.fincen.gov/bsa/bsar/2011-06-01">
<bsar:FilingInstitutionInformation>
    <bsar:PrimaryRegulator>D</bsar:PrimaryRegulator>
    <bsar:FilerName>New Banking Corp.</bsar:FilerName>
    <bsar:TIN>373637383</bsar:TIN>
    <bsar:TINTYPE>A</bsar:TINTYPE>
    <bsar:FIType>
        <ucc:FinInsType xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">C</ucc:FinInsType>
        <ucc:OtherSpecify xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01" />
    </bsar:FIType>
    <bsar:SecuritiesFuturesType>
        <bsar:ClearingBrokerSecurities />
        <bsar:CPOCTA />
        <bsar:FuturesCommissionMerchant />
        <bsar:HoldingCompany />
        <bsar:IntroducingCommodities />
        <bsar:IntroducingSecurities />
        <bsar:InvestmentAdvisor />
        <bsar:InvestmentCompany />
        <bsar:RetailForeign />
        <bsar:SROFutures />
        <bsar:SROSecurities />
        <bsar:Subsidiary />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:SecuritiesFuturesType>
    <bsar:FIIdentification>
        <ucc:FIIDType xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">D</ucc:FIIDType>
        <ucc:FIIDNumber xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">654646321321</ucc:FIIDNumber>
    </bsar:FIIdentification>
    <bsar:FIAddress>
        <ucc:Address xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">Ave X</ucc:Address>
        <ucc:City xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">Brooklyn</ucc:City>
        <ucc:State xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">NY</ucc:State>
        <ucc:ZIP xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">11235</ucc:ZIP>
        <ucc:Country xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01">US</ucc:Country>
    </bsar:FIAddress>
    <bsar:AlternateName>alternate name</bsar:AlternateName>
</bsar:FilingInstitutionInformation> <!--2A-->

<bsar:FinancialInstitutionInformation>
    <bsar:LegalName>Citibank</bsar:LegalName>
</bsar:FinancialInstitutionInformation> <!--2B-->
<bsar:SuspiciousActivityInformation>
    <bsar:FilingType>A</bsar:FilingType>
    <bsar:ContinuingActivity />
    <bsar:JointReport />
    <ucc:DocumentControlNumber xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01" />
    <bsar:ViolationAmount />
    <bsar:AmountUnKnownOrNotInvolved>B</bsar:AmountUnKnownOrNotInvolved>
    <bsar:FromSuspiciousActivityDate>12312012</bsar:FromSuspiciousActivityDate>
    <bsar:ToSuspiciousActivityDate>12312012</bsar:ToSuspiciousActivityDate>
    <bsar:CumulativeAmount />
    <bsar:Structuring>
        <bsar:AltersTransactionBSA>A</bsar:AltersTransactionBSA>
        <bsar:AltersTransactionCTR />
        <bsar:CustomerCancels />
        <bsar:MultipleTransactions />
        <bsar:MultipleTransactionsCTR />
        <bsar:SuspiciousInquiry />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Structuring>
    <bsar:TerroristFinanacing>
        <bsar:KnownTerroristOrg />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:TerroristFinanacing>
    <bsar:Fraud>
        <bsar:ACH />
        <bsar:BusinessLoan />
        <bsar:Check />
        <bsar:ConsumerLoan />
        <bsar:CreditDebitCard />
        <bsar:HealthCare />
        <bsar:Mail />
        <bsar:MassMarketing />
        <bsar:PyramidScheme />
        <bsar:Wire />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Fraud>
    <bsar:Casinos>
        <bsar:InquiryOnEOB />
        <bsar:MinimalGaming />
        <bsar:IntraCasinoFundTransfer />
        <bsar:CounterChecksorMarkers />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Casinos>
    <bsar:MoneyLaundering>
        <bsar:ExchangeSmallBig />
        <bsar:PhysicalCondition />
        <bsar:SourceFund />
        <bsar:Designation />
        <bsar:EftOrWireTransfer />
        <bsar:ExchangeCurrency />
        <bsar:GovernmentPaymentReceipt />
        <bsar:MultipleAccounts />
        <bsar:NonCashMonetaryInstr />
        <bsar:StrawMan />
        <bsar:MoneyLaunderingBlackMarket />
        <bsar:OutOfPatterns />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:MoneyLaundering>
    <bsar:IdentificationDocumentation>
        <bsar:ChangeName />
        <bsar:MultiIndiWithSameSimilarName />
        <bsar:QuestionableOrfalseDoc />
        <bsar:RefusedDoc />
        <bsar:MultipleIdentities />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:IdentificationDocumentation>
    <bsar:OtherSuspicoiusActivities>
        <bsar:AccountTakeOver />
        <bsar:BriberyOrGratuity />
        <bsar:CounterfeitInstr />
        <bsar:ElderFinancial />
        <bsar:Embezzlement />
        <bsar:Forgeries />
        <bsar:IdentifyTheft />
        <bsar:LittleNoConcerns />
        <bsar:MisuseFreeLook />
        <bsar:MisusePosition />
        <bsar:SuspectedDomesticCorruption />
        <bsar:SuspectedForeignCorruption />
        <bsar:SuspiciousUseInformationValueSys />
        <bsar:SuspiciousUseMultiLoc />
        <bsar:NoPurpose />
        <bsar:TwoOrMoreWorkingTogether />
        <bsar:UnAuthorizedEInstrusion />
        <bsar:UnLicensedMSB />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:OtherSuspicoiusActivities>
    <bsar:Insurance>
        <bsar:ExcessiveInsurance>A</bsar:ExcessiveInsurance>
        <bsar:ExcessiveOrUnusalCash />
        <bsar:ProceedsFromUnrelated3rd />
        <bsar:LifeSettlement />
        <bsar:PolicyTermination />
        <bsar:UnclearNoInterest />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Insurance>
    <bsar:SecuritiesFutureOptions>
        <bsar:InsiderTrading />
        <bsar:WashTrading />
        <bsar:Misappropriation />
        <bsar:UnauthorizedPooling />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:SecuritiesFutureOptions>
    <bsar:MortgageFraud>
        <bsar:Appraisal />
        <bsar:Foreclosure />
        <bsar:LoanModification />
        <bsar:ReverseMortgage />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:MortgageFraud>
    <bsar:Product>
        <bsar:BondsNotes>A</bsar:BondsNotes>
        <bsar:CommercialMtgg />
        <bsar:CommercialPaper />
        <bsar:CreditCard />
        <bsar:DebitCard />
        <bsar:ForexTrans />
        <bsar:FutureOptionsOnFu />
        <bsar:HedgeFund />
        <bsar:HomeEquityLoan />
        <bsar:HomeEquityLine />
        <bsar:InsuranceAnuity />
        <bsar:MutualFund />
        <bsar:OptionsOnSec />
        <bsar:PennyStocks />
        <bsar:PrepaidAccess />
        <bsar:ResidentialMtgg />
        <bsar:SecurityFuture />
        <bsar:Stocks />
        <bsar:SwapHybridDer />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Product>
    <bsar:InstrumentOrPayment>
        <bsar:BankCheck />
        <bsar:ForeignCurrency />
        <bsar:FundsTransfer />
        <bsar:GamingInstrm />
        <bsar:GovernmentPayment />
        <bsar:MoneyOrders />
        <bsar:PersonalCheck />
        <bsar:TravelersCheck />
        <bsar:USCurrency />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:InstrumentOrPayment>
    <bsar:InternalControlNumber>654321654321</bsar:InternalControlNumber>
    <bsar:CommodityTypeRecord>
        <bsar:CommodityType>commodity type</bsar:CommodityType>
    </bsar:CommodityTypeRecord>
    <bsar:ProductInstrumentDescRecord>
        <bsar:ProductInstrumentDesc>product description</bsar:ProductInstrumentDesc>
    </bsar:ProductInstrumentDescRecord>
    <bsar:MarketTradedRecord>
        <bsar:MarketTraded>101</bsar:MarketTraded>
    </bsar:MarketTradedRecord>
    <bsar:IPAddressRecord>
        <bsar:IPAddress>255.255.255.255</bsar:IPAddress>
    </bsar:IPAddressRecord>
    <bsar:CUSIPNumberRecord>
        <bsar:CUSIPNumber>3465431654</bsar:CUSIPNumber>
    </bsar:CUSIPNumberRecord>
</bsar:SuspiciousActivityInformation> <!--3A-->

<bsar:FinancialInstitutionInformation>
    <bsar:LegalName>Bank of America</bsar:LegalName>
</bsar:FinancialInstitutionInformation> <!--2B-->
<bsar:SuspiciousActivityInformation>
    <bsar:FilingType>A</bsar:FilingType>
    <bsar:ContinuingActivity />
    <bsar:JointReport />
    <ucc:DocumentControlNumber xmlns:ucc="http://www.fincen.gov/bsa/ucommon-components/2011-06-01" />
    <bsar:ViolationAmount />
    <bsar:AmountUnKnownOrNotInvolved>B</bsar:AmountUnKnownOrNotInvolved>
    <bsar:FromSuspiciousActivityDate>12312012</bsar:FromSuspiciousActivityDate>
    <bsar:ToSuspiciousActivityDate>12312012</bsar:ToSuspiciousActivityDate>
    <bsar:CumulativeAmount />
    <bsar:Structuring>
        <bsar:AltersTransactionBSA>A</bsar:AltersTransactionBSA>
        <bsar:AltersTransactionCTR />
        <bsar:CustomerCancels />
        <bsar:MultipleTransactions />
        <bsar:MultipleTransactionsCTR />
        <bsar:SuspiciousInquiry />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Structuring>
    <bsar:TerroristFinanacing>
        <bsar:KnownTerroristOrg />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:TerroristFinanacing>
    <bsar:Fraud>
        <bsar:ACH />
        <bsar:BusinessLoan />
        <bsar:Check />
        <bsar:ConsumerLoan />
        <bsar:CreditDebitCard />
        <bsar:HealthCare />
        <bsar:Mail />
        <bsar:MassMarketing />
        <bsar:PyramidScheme />
        <bsar:Wire />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Fraud>
    <bsar:Casinos>
        <bsar:InquiryOnEOB />
        <bsar:MinimalGaming />
        <bsar:IntraCasinoFundTransfer />
        <bsar:CounterChecksorMarkers />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Casinos>
    <bsar:MoneyLaundering>
        <bsar:ExchangeSmallBig />
        <bsar:PhysicalCondition />
        <bsar:SourceFund />
        <bsar:Designation />
        <bsar:EftOrWireTransfer />
        <bsar:ExchangeCurrency />
        <bsar:GovernmentPaymentReceipt />
        <bsar:MultipleAccounts />
        <bsar:NonCashMonetaryInstr />
        <bsar:StrawMan />
        <bsar:MoneyLaunderingBlackMarket />
        <bsar:OutOfPatterns />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:MoneyLaundering>
    <bsar:IdentificationDocumentation>
        <bsar:ChangeName />
        <bsar:MultiIndiWithSameSimilarName />
        <bsar:QuestionableOrfalseDoc />
        <bsar:RefusedDoc />
        <bsar:MultipleIdentities />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:IdentificationDocumentation>
    <bsar:OtherSuspicoiusActivities>
        <bsar:AccountTakeOver />
        <bsar:BriberyOrGratuity />
        <bsar:CounterfeitInstr />
        <bsar:ElderFinancial />
        <bsar:Embezzlement />
        <bsar:Forgeries />
        <bsar:IdentifyTheft />
        <bsar:LittleNoConcerns />
        <bsar:MisuseFreeLook />
        <bsar:MisusePosition />
        <bsar:SuspectedDomesticCorruption />
        <bsar:SuspectedForeignCorruption />
        <bsar:SuspiciousUseInformationValueSys />
        <bsar:SuspiciousUseMultiLoc />
        <bsar:NoPurpose />
        <bsar:TwoOrMoreWorkingTogether />
        <bsar:UnAuthorizedEInstrusion />
        <bsar:UnLicensedMSB />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:OtherSuspicoiusActivities>
    <bsar:Insurance>
        <bsar:ExcessiveInsurance>A</bsar:ExcessiveInsurance>
        <bsar:ExcessiveOrUnusalCash />
        <bsar:ProceedsFromUnrelated3rd />
        <bsar:LifeSettlement />
        <bsar:PolicyTermination />
        <bsar:UnclearNoInterest />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Insurance>
    <bsar:SecuritiesFutureOptions>
        <bsar:InsiderTrading />
        <bsar:WashTrading />
        <bsar:Misappropriation />
        <bsar:UnauthorizedPooling />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:SecuritiesFutureOptions>
    <bsar:MortgageFraud>
        <bsar:Appraisal />
        <bsar:Foreclosure />
        <bsar:LoanModification />
        <bsar:ReverseMortgage />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:MortgageFraud>
    <bsar:Product>
        <bsar:BondsNotes>A</bsar:BondsNotes>
        <bsar:CommercialMtgg />
        <bsar:CommercialPaper />
        <bsar:CreditCard />
        <bsar:DebitCard />
        <bsar:ForexTrans />
        <bsar:FutureOptionsOnFu />
        <bsar:HedgeFund />
        <bsar:HomeEquityLoan />
        <bsar:HomeEquityLine />
        <bsar:InsuranceAnuity />
        <bsar:MutualFund />
        <bsar:OptionsOnSec />
        <bsar:PennyStocks />
        <bsar:PrepaidAccess />
        <bsar:ResidentialMtgg />
        <bsar:SecurityFuture />
        <bsar:Stocks />
        <bsar:SwapHybridDer />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:Product>
    <bsar:InstrumentOrPayment>
        <bsar:BankCheck />
        <bsar:ForeignCurrency />
        <bsar:FundsTransfer />
        <bsar:GamingInstrm />
        <bsar:GovernmentPayment />
        <bsar:MoneyOrders />
        <bsar:PersonalCheck />
        <bsar:TravelersCheck />
        <bsar:USCurrency />
        <bsar:Other />
        <bsar:OtherSpecify />
    </bsar:InstrumentOrPayment>
    <bsar:InternalControlNumber>654321654321</bsar:InternalControlNumber>
    <bsar:CommodityTypeRecord>
        <bsar:CommodityType>commodity type</bsar:CommodityType>
    </bsar:CommodityTypeRecord>
    <bsar:ProductInstrumentDescRecord>
        <bsar:ProductInstrumentDesc>product description</bsar:ProductInstrumentDesc>
    </bsar:ProductInstrumentDescRecord>
    <bsar:MarketTradedRecord>
        <bsar:MarketTraded>101</bsar:MarketTraded>
    </bsar:MarketTradedRecord>
    <bsar:IPAddressRecord>
        <bsar:IPAddress>255.255.255.255</bsar:IPAddress>
    </bsar:IPAddressRecord>
    <bsar:CUSIPNumberRecord>
        <bsar:CUSIPNumber>3465431654</bsar:CUSIPNumber>
    </bsar:CUSIPNumberRecord>
</bsar:SuspiciousActivityInformation> <!--3A-->
<bsar:SubjectInformation>
    <bsar:Entity />
    <bsar:SubjectInformationUnavailable />
    <bsar:LastNameOrNameOfEntity>Ceriello</bsar:LastNameOrNameOfEntity>
</bsar:SubjectInformation> <!--4A-->
<bsar:SubjectInformation>
    <bsar:Entity />
    <bsar:SubjectInformationUnavailable>B</bsar:SubjectInformationUnavailable>
    <bsar:LastNameOrNameOfEntity>Gutierrez</bsar:LastNameOrNameOfEntity>
</bsar:SubjectInformation> <!--4A-->
<bsar:SubjectInformation>
    <bsar:Entity />
    <bsar:SubjectInformationUnavailable />
    <bsar:LastNameOrNameOfEntity>Roper</bsar:LastNameOrNameOfEntity>
</bsar:SubjectInformation> <!--4A--> 
```

基本上，伪代码如下所示：

```
Output 1A

For each 2A

    Output 2A

    For each 2B before the next 2A

        Output 2B

        For each 3A before the next 2B

            Output 3A; increment counter

                For each 4A before the next 3A

                    Output 4A with above counter 
```

文本基本上需要按照它在文件中的顺序进行格式化，并带有一些摘要部分（例如，在每个 2B 之后）。我无法弄清楚如何循环遍历 3A 之后的元素，例如不循环遍历文档中的所有 4A 记录。对于每个 3A，我还需要保留一个计数器，以便可以将其与 3A 部分和相关 4A 部分的文本一起输出。

最初，我设计了一系列循环，这些循环将遍历文件中的每个元素并为每个元素调用适当的一次，但我意识到这将挑选出文件中的所有元素，而不仅仅是出现在相关下方的元素我想为该部分查看的（父）元素。

然后，我考虑使用包罗万象的方法，以便所有元素都按照它们在文件中出现的顺序进行处理。但是，如果我这样做，我不知道如何使用任何类型的计数器。（我知道我不能使用实际的计数器，但我的观点是在 for 每个循环中调用一个模板并将 position() 作为参数传递）

如果您对此有任何建议，请告诉我。我有一些 XSL 经验，但这与我习惯的有点不同。

提前致谢。

编辑：

输出应该看起来像这样：

```
1A Transmitter info
2A Filing Institution Info
2B Financial Institution Info
3A Suspicious Activity Info
9A Suspicious Activity Summary Info
2B Financial Institution 2 Info
3A Suspicious Activity 2 Info
4A Subject 1 Info
4A Subject 2 Info
4A Subject 3 Info
9B Filing institution   Summary info 
```

这是我尝试过的一些 XSL，但我确定不会工作，因为循环正在循环整个文档中的所有记录类型，而不仅仅是作为父级的兄弟元素之后的那些：

```
<xsl:template match="/bsar:BSAForm">
    <xsl:for-each select="bsar:FilingInstitutionInformation"> 
        <xsl:call-template name="FileInstInfo"/> <!--2A-->
        <xsl:for-each select="../bsar:FinancialInstitutionInformation"> 
            <xsl:call-template name="FinInstActivity"/> <!--2B-->
            <xsl:for-each select="../bsar:SuspiciousActivityInformation">
                <xsl:call-template name="SuspActivityInfo"/> <!--3A-->
                <xsl:for-each select="../bsar:SubjectInformation">
                    <xsl:call-template name="Subject"/> <!--4A-->
                </xsl:for-each>
                <xsl:for-each select="../bsar:SuspiciousActivityInformationNarrative">
                    <xsl:call-template name="NarrativeDesc"/> <!--5A-->
                </xsl:for-each>
                <xsl:call-template name="SuspActivityInfoSmry"/> <!--9A-->
            </xsl:for-each>
        </xsl:for-each>
        <xsl:call-template name="FileInstSmry"/> <!--9B-->
    </xsl:for-each>
    <xsl:call-template name="FileSmry"/> <!--9Z-->
</xsl:template>

<xsl:template name="FileInstInfo" match="bsar:FilingInstitutionInformation">

    <xsl:variable name="FIType" select="bsar:FIType"/>
    <xsl:variable name="SecFuType" select="bsar:SecuritiesFuturesType"/>
    <xsl:variable name="FIId" select="bsar:FIIdentification"/>
    <xsl:variable name="FIIdType" select="$FIId/ucc:FIIDType"/>
    <xsl:variable name="Addr" select="bsar:FIAddress"/>
    <xsl:variable name="Country" select="$Addr/ucc:Country"/>
    <xsl:variable name="ZIP" select="translate($Addr/ucc:ZIP, translate($Addr/ucc:ZIP, '0123456789', ''), '')"/>
    <xsl:variable name="FinInstType" select="$FIType/ucc:FinInsType"/>

    <!-- 1-2(2) Record Type -->
    <xsl:text xml:space="preserve">2A</xsl:text>

    <!-- 3-4(2) Part IV Primary Federal Regulator -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="bsar:PrimaryRegulator"/>
        <xsl:with-param name="length" select="2"/>
    </xsl:call-template>

    <!-- 5-154(150) Part IV Filer Name -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="bsar:FilerName"/>
        <xsl:with-param name="length" select="150"/>
    </xsl:call-template>

    <!-- 155-179(25) Part IV TIN -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="translate(bsar:TIN, translate(bsar:TIN, '0123456789', ''), '')"/>
        <xsl:with-param name="length" select="25"/>
    </xsl:call-template>

    <!-- 180(1) Part IV TIN Type -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="bsar:TINTYPE"/>
        <xsl:with-param name="length" select="1"/>
    </xsl:call-template>

    <!-- 181(1) Part IV Type of Financial Institution -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$FinInstType"/>
        <xsl:with-param name="length" select="1"/>
    </xsl:call-template>

    <!-- 182-231(50) Part IV Type of Financial Institution - Other -->
    <xsl:variable name="FinInstTypeOther">
        <xsl:choose>
            <xsl:when test="$FinInstType = 'Z'">
                <xsl:value-of select="$FIType/ucc:OtherSpecify"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="''"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$FinInstTypeOther"/>
        <xsl:with-param name="length" select="50"/>
    </xsl:call-template>

    <!-- 232-244(13) Part IV Type of Securities and Futures Institution -->
    <xsl:variable name="SecFuInstType">
        <xsl:choose>
            <xsl:when test="$FinInstType = 'E'">
                <xsl:for-each select="$SecFuType/*">
                    <xsl:if test="position() != last()">
                        <xsl:value-of select="."/>
                    </xsl:if>
                </xsl:for-each>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="''"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$SecFuInstType"/>
        <xsl:with-param name="length" select="13"/>
    </xsl:call-template>

    <!-- 245-294(50) Part IV Type of Securities and Futures Institution - Other -->
    <xsl:variable name="SecFuInstOtherSpecify">
        <xsl:choose>
            <xsl:when test="contains($SecFuInstType,'Z')">
                <xsl:value-of select="$SecFuType/bsar:OtherSpecify"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="''"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$SecFuInstOtherSpecify"/>
        <xsl:with-param name="length" select="50"/>
    </xsl:call-template>

    <!-- 295(1) Part IV Financial Institution Identification Type -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$FIIdType"/>
        <xsl:with-param name="length" select="1"/>
    </xsl:call-template>

    <!-- 296-315(20) Part IV Financial Institution Identification Number -->
    <xsl:variable name="FIIdNumber">
        <xsl:choose>
            <xsl:when test="$FIIdType != ''">
                <xsl:value-of select="$FIId/ucc:FIIDNumber"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="''"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$FIIdNumber"/>
        <xsl:with-param name="length" select="20"/>
    </xsl:call-template>

    <!-- 316-415(100) Part IV Address -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$Addr/ucc:Address"/>
        <xsl:with-param name="length" select="100"/>
    </xsl:call-template>

    <!-- 416-465(50) Part IV City -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$Addr/ucc:City"/>
        <xsl:with-param name="length" select="50"/>
    </xsl:call-template>

    <!-- 466-468(3) Part IV State -->
    <xsl:variable name="State">
        <xsl:choose>
            <xsl:when test="$Country = 'CA' or $Country = 'US' or $Country = 'MX'">
                <xsl:value-of select="$Addr/ucc:State"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="''"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$State"/>
        <xsl:with-param name="length" select="3"/>
    </xsl:call-template>

    <!-- 469-477(9) Part IV Zip / Postal Code -->
    <xsl:variable name="ZipCode">
        <xsl:choose>
            <xsl:when test="$Country = 'US' and (string-length($ZIP) = 9 and (substring($ZIP, 6, 9) = '0000' or substring($ZIP, 6, 9) = '9999'))">
                <xsl:value-of select="substring($ZIP, 1, 5)"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="$ZIP"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:variable>

    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$ZipCode"/>
        <xsl:with-param name="length" select="9"/>
    </xsl:call-template>

    <!-- 478-479(2) Part IV Country -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="$Country"/>
        <xsl:with-param name="length" select="2"/>
    </xsl:call-template>

    <!-- 480-629(150) Part IV Alternate Name -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="./bsar:AlternateName"/>
        <xsl:with-param name="length" select="150"/>
    </xsl:call-template>

    <!-- 630-1190(561) Filler -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="''"/>
        <xsl:with-param name="length" select="561"/>
    </xsl:call-template>

    <!-- 1191-1200(10) User Field -->
    <xsl:call-template name="append-pad">
        <xsl:with-param name="text" select="''"/>
        <xsl:with-param name="length" select="10"/>
    </xsl:call-template>

    <xsl:value-of select="$newline" />

</xsl:template>

<xsl:template name="append-pad">
    <!-- recursive template to left justify and append  -->
    <!-- the value with whatever padding is passed in   -->
    <xsl:param name="padding" xml:space="preserve"> </xsl:param>
    <xsl:param name="text"/>
    <xsl:param name="length"/>
    <xsl:choose>
        <xsl:when test="string-length($text) &lt; $length">
            <xsl:call-template name="append-pad">
                <xsl:with-param name="padding" select="$padding"/>
                <xsl:with-param name="text" select="concat($text,$padding)"/>
                <xsl:with-param name="length" select="$length"/>
            </xsl:call-template>
        </xsl:when>
        <xsl:otherwise>
            <xsl:value-of select="substring($text,1,$length)"/>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template> 
```

第一部分应产生以下输出：（本文省略了间距）

2AD New Banking Corp.373637383ACD654646321321Ave XBrooklynNY11235US别名

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T14:59:12.330

我不确定是否有人真正理解我的问题，但如果有人来到这里遇到类似的问题，我是这样解决的：

```
<xsl:template match="/bsar:BSAForm">
    <xsl:call-template name="Transmitter"/>
    <xsl:apply-templates select="bsar:FilingInstitutionInformation" />
    <xsl:call-template name="FileSmry"/>
</xsl:template>

<xsl:template match="bsar:FilingInstitutionInformation">

    <xsl:variable name="FileInstHeader" select="."/>

    <xsl:call-template name="FileInstInfo"/>

    <!--For each 2B before the next 2A-->
    <xsl:for-each select="following-sibling::bsar:FinancialInstitutionInformation[preceding-sibling::bsar:FilingInstitutionInformation[1] = $FileInstHeader]">
        <!--Output 2B-->
        <xsl:call-template name="FinInstActivity"/>
        <xsl:variable name="FinInstHeader" select="."/>
        <!--For each 3A before the next 2B-->
        <xsl:for-each select="following-sibling::bsar:SuspiciousActivityInformation[preceding-sibling::bsar:FinancialInstitutionInformation[1] = $FinInstHeader]">
            <!--Output 3A; Increment counter-->
            <xsl:variable name="TranSeqNum">
                <xsl:number count="bsar:SuspiciousActivityInformation" />
            </xsl:variable>
            <xsl:call-template name="SuspActivityInfo">
                <xsl:with-param name="TranSeqNum" select="$TranSeqNum"/>
            </xsl:call-template>
            <xsl:variable name="SuspActHeader" select="."/>
            <!--For each 4A before the next 3A-->
            <xsl:for-each select="following-sibling::bsar:SubjectInformation[preceding-sibling::bsar:SuspiciousActivityInformation[1] = $SuspActHeader]">
                <!--Output 4A with above counter-->
                <xsl:call-template name="Subject">
                    <xsl:with-param name="TranSeqNum" select="$TranSeqNum"/>
                </xsl:call-template>
            </xsl:for-each>
            <!--Output 9A-->
            <!--<xsl:call-template name="SuspActivityInfoSmry"/>-->
        </xsl:for-each>
    </xsl:for-each>

    <!--Output 9B-->
    <xsl:call-template name="FileInstSmry"/>

</xsl:template> 
```

“Transmitter”记录需要在开头显示一次（表明该模板无关），FileInstSmry 记录需要在结尾显示一次。其他所有内容均按 2A 记录分组。调用将为文档中找到的每个标签调用模板。对于找到的每一个，都会调用模板的详细信息 ()，然后每次运行 FilingInsitutionInformation 模板时都会运行内部循环。

FileInstHeader 包含父元素，因此每个循环的第一个循环都会运行，直到命中另一个元素。header 变量设置为下一个父级，循环继续。我还没有弄清楚 3A 和 4A 部分的计数器，但如果有人感兴趣，我可以在那时更新。

# c# - 将一个数据表中的列添加到数据集的另一个数据表

> ID：14987006
> 
> 赞同：1
> 
> 时间：2013-02-20T18:13:27.857
> 
> 标签：c#, tsql, sql-server-2005

我正在尝试将两个表合并到一个`DataSet`. 有`DataSet`2 个表，我想添加一列`TypeofDay`from `Tables[1]`to `Tables[0]`like this。但我在这里得到一个错误

> *“由于表达式中的循环引用，无法设置表达式属性。”*

我怎样才能解决这个问题？先感谢您！这是在 VS 2005 中使用 c#。

```
DataSet ds = new BusinessLogic.BizLogic().getMonthlyStandings(RepID);

DataColumn newColumn1;
newColumn1 = new DataColumn("TypeofDay");
newColumn1.Expression = ds.Tables[1].Columns["TypeofDay"].ToString();
ds.Tables[0].Columns.Add(newColumn1);

DataView myDataView = new DataView();
myDataView = ds.Tables[0].DefaultView;
grdMonthlyStandings.DataSource = myDataView;
grdMonthlyStandings.DataBind(); 
```

# qt - QWebView::setHtml 的预期编码是什么？

> ID：14987007
> 
> 赞同：1
> 
> 时间：2013-02-20T18:13:28.350
> 
> 标签：qt, unicode, encoding, utf-8, qwebview

我发现了一个我不理解的奇怪效果：我有一个用 UTF-8 编码的 HTML 文件。它还有一个带有`content="text/html; charset=UTF-8"/>`.

如果我在 QWebView 中加载 HTML 文件，它会正确显示。

如果我在 QByteArray 中加载 HTML 文件（仍然看起来像有效的 UTF-8），将其转换为 QString（仍然看起来像有效的 UTF-8），并通过 QWebView 上的 setHTML 设置它，它显示不正确（好像解释为 ASCII）。

如果我采用相同的 QByteArray，并通过 QWebView 上的 setContent 设置它，将 "text/html; charset=UTF-8" 作为 mime 类型传递，它会再次正确显示。

QWebView::setHtml 的预期编码是什么？该文档仅提到外部 CSS 和脚本文件被解释为 UTF-8。这是使用 Qt 4.8.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:27:04.547

没有预期的编码，因为当您创建`QString`. 是否正确由您决定，但如果您使用`QString(const QByteArray&)`构造函数，那么 Qt 默认会将内容视为 ASCII。

如果要将内容视为 UTF-8，则可以使用`QString::fromUtf8`. 如果您需要做一些更复杂的事情，您可以使用它`QTextCodec`来读取许多不同的编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-25T11:16:47.543

为了解决这个问题，我迭代了很多案例，但真正的情况是：

QTextCodec::setCodecForCStrings(QTextCodec::codecForName("UTF8"));

因为 QtWebKit 在 self 中使用了转换为 std::string 的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-18T00:54:03.560

我使用了 setContent(bytearray, "text/html; charset=utf-8") 并且它有效。“utf-8”应该是小写的。

# shopify - Shopify“测试”模板页面

> ID：14987011
> 
> 赞同：0
> 
> 时间：2013-02-20T18:13:40.313
> 
> 标签：shopify

有没有办法发布测试模板页面？例如，如果我有一个名为“cart-test.liquid”的模板文件，是否可以修改任何内容以便导航到“ [http://shopname.com/cart-test](http://shopname.com/cart-test) ”进行测试？

我目前正在开发一个将包含在 Shopify 购物车页面上的小部件，我的一个客户希望在它发布到他们的真实购物车页面之前对其进行测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T08:23:47.730

在不编辑实时主题的情况下测试主题的最佳方法是复制当前主题并使用预览功能。

从 Shopify 后台（使用 Shopify Admin 2）转到“主题”部分。在这里，您可以“复制”已发布的主题。它将在“未发布的主题”部分中创建主题的副本。在这里您可以对其进行编辑并获得该主题的预览（单击链接预览）。

# jms - 来自集群中分布式队列的所有 JMS 消息

> ID：14987012
> 
> 赞同：3
> 
> 时间：2013-02-20T18:13:43.920
> 
> 标签：jms, weblogic

当前使用 WebLogic 和分布式队列。而且我从文档中知道分布式队列允许您使用全局 JNDI 名称检索到集群中任何队列的连接。似乎分布式队列为您提供的主要功能之一是跨多个托管服务器的负载平衡连接。所以我们有 4 个托管服务器（每个物理服务器上两个，通过多播进行通信），每个托管服务器都有一个单独的 JMS 服务器，该服务器配置为它自己的数据存储。

我有 99% 的把握我已经知道这个问题的答案，但似乎如果你想从队列中消费一条消息，并且集群中的每个 Mgd 服务器上都存在队列，那么从技术上讲，你不能关闭一条消息任何队列（您只能将消息从您连接到的队列中拉出）。因此，如果我在 Mgd Server 4 上有一条消息，并且我连接到 Mgd Server 1，我将看不到来自 Mgd Server 4 的队列中的消息。

那么在 Java EE 或 WLS 中是否有一种方法可以使用来自队列的所有节点（跨集群）的消息。就像查看每个 Mgd 服务器上的每个队列实例一样？事实并非如此，并且文档看起来似乎是不可能的，以及这个视频（大约 5 分钟）：

[http://www.youtube.com/watch?v=HAKixK_wp0Q](http://www.youtube.com/watch?v=HAKixK_wp0Q)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T17:53:34.277

不，当您的客户端连接到同一集群的另一台托管服务器时，您不能使用传递到一个托管服务器的消息。

这是它的工作原理。使用 UDT 时，wls 提供了一个 JNDI 名称，该名称在内部解析为每个托管服务器的 4 个不同的 JNDI 名称，每个托管服务器上的 JMS 服务器都是不同的。当您在发布消息时使用 UDQ JNDI 名称时，它会使用您选择的算法和在您的连接工厂中完成的其他配置到达 4 个托管服务器之一。

当消息使用者侦听 UDQ 时，它被固定到其中一个托管服务器上的 JMS 服务器。它对其他服务器中的消息没有可见性。

通常 UDQ 用于您希望消息由多个托管服务器同时使用的场景。您通常会将 MDB 部署到集群，这意味着 MDB 将部署到每个托管服务器，并且每个托管服务器都能够使用来自其本地 JMS 服务器的消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T00:46:20.590

如果您的消息存储配置为使用数据库，我相信您可以。如果是这样，那么我认为从队列中删除一个项目会将其从共享数据库表中删除。即所有JMS 服务器都指向同一个数据库实例和表。这也应该很容易测试。

# bash - 为什么 virtualenv 没有设置我的终端提示符？

> ID：14987013
> 
> 赞同：11
> 
> 时间：2013-02-20T18:13:47.463
> 
> 标签：bash, virtualenv

我在 Mac OSX (10.8.2) 上运行 virtualenv，虽然它可以工作（我可以设置 venvs，在它们之间切换，激活和停用），但不能工作的一件事（而且很烦人）是终端提示切换。

我的基本提示是`[\u] \w \n\[\033[0;31m\]$\[\e[0m\]`，呈现为：

```
[hugo] /current/directory/path/
$ 
```

即它有一个换行符。

如果我激活一个 virtualenv，我希望：

```
(myproject)[hugo] /current/directory/path/
$ 
```

但事实上我根本没有得到任何改变。

我打开了`/bin/activate`脚本，查看了代码：

```
if [ -z "$VIRTUAL_ENV_DISABLE_PROMPT" ] ; then
    _OLD_VIRTUAL_PS1="$PS1"
    if [ "x" != x ] ; then
        PS1="$PS1"
    else
    if [ "`basename \"$VIRTUAL_ENV\"`" = "__" ] ; then
        # special case for Aspen magic directories
        # see http://www.zetadev.com/software/aspen/
        PS1="[`basename \`dirname \"$VIRTUAL_ENV\"\``] $PS1"
    else
        PS1="(`basename \"$VIRTUAL_ENV\"`)$PS1"
    fi
    fi
    export PS1
fi 
```

如果我在最后加上回声，我可以看到`PS1`var 设置为`(myproject)[\u] \w \n\[\033[0;31m\]$\[\e[0m\]`，但由于某种原因没有坚持，并且没有导出正确的 PS1。

这与我的自定义提示或权限问题有关吗？这显然**不是**virtualenv 的东西，因为我知道它可以工作（实际上它可以在我的 vagrant VM 上工作，而不是在我的 OSX 主机上）。

?

**[更新 1]**

我的错误 - 看起来我有一个 git-aware 提示，它根据目录/repo 状态覆盖提示。这就是杀死 venv 提示符的原因。现在我只需要一个两者兼而有之的人 - 所以，后续问题是：有没有人有一个颜色、git-aware、OSX 提示符，可以很好地与 virtualenv 搭配使用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-20T18:52:34.780

设置 git 感知提示的任何内容都可能是定义`PROMPT_COMMAND`函数。尝试将其添加到`.bashrc`文件的末尾。

```
add_venv_info () {
    if [ -z "$VIRTUAL_ENV_DISABLE_PROMPT" ] ; then
        _OLD_VIRTUAL_PS1="$PS1"

        if [ "`basename \"$VIRTUAL_ENV\"`" = "__" ] ; then
            # special case for Aspen magic directories
            # see http://www.zetadev.com/software/aspen/
            PS1="[`basename \`dirname \"$VIRTUAL_ENV\"\``] $PS1"
        elif [ "$VIRTUAL_ENV" != "" ]; then
            PS1="(`basename \"$VIRTUAL_ENV\"`)$PS1"
        fi
    fi
    export PS1
}
PROMPT_COMMAND=add_venv_info 
```

什么是 Aspen 魔法目录？我不知道; 这是从脚本复制的代码，`activate`用于演示如何将`PROMPT_COMMAND`虚拟环境信息包含到您的道具中。如果它们与您的情况无关，您可以简单地添加`PS1=...`您想要的分配。唯一真正重要的部分是 1) 检查`VIRTUAL_ENV_DISABLE_PROMPT`和 2) 对`PS1`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-01T13:24:37.830

我有同样的问题，但上述解决方案对我不起作用。

我最终这样做了：（ *请注意，还有一个额外的空间可以`(virtenv)`将`$`*

```
# Virtual ENV stuff
add_venv_info () {
    if [ -z "$VIRTUAL_ENV_DISABLE_PROMPT" ] ; then
        VIRT_ENV_TXT=""
        if [ "x" != x ] ; then
            VIRT_ENV_TXT=""
        else
            if [ "`basename \"$VIRTUAL_ENV\"`" = "__" ] ; then
                # special case for Aspen magic directories
                # see http://www.zetadev.com/software/aspen/
                VIRT_ENV_TXT="[`basename \`dirname \"$VIRTUAL_ENV\"\``]"
            elif [ "$VIRTUAL_ENV" != "" ]; then
                VIRT_ENV_TXT="(`basename \"$VIRTUAL_ENV\"`)"
            fi
        fi
        if [ "${VIRT_ENV_TXT}" != "" ]; then
           echo ${VIRT_ENV_TXT}" "
        fi
    fi
}

# Now we construct the prompt.
# in my case a bunch of lines constructing the complete PS1
# somewhere call the add_venv_info function like below

        PS1=${PS1}"\[\$(job_color)\]\n\$(add_venv_info)\$\[${NC}\] " 
```

# ruby-on-rails-3.2 - rack.session.options - 什么时候使用哪个？

> ID：14987014
> 
> 赞同：1
> 
> 时间：2013-02-20T18:13:50.953
> 
> 标签：ruby-on-rails-3.2, session-cookies, rack

:skip 和 :defer 之间有区别吗，除了 :defer 倾向于在旧版本中使用吗？各种选项是否有任何用例，何时应该使用它们？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:42:08.927

我希望查看 [Rack 源代码中的这些注释](https://github.com/rack/rack/blob/deec485/lib/rack/session/abstract/id.rb#L171-L173)可能对您有所帮助。

```
# :skip will not a set a cookie in the response nor update the session state

# :defer will not set a cookie in the response but still update the session
#   state if it is used with a backend 
```

# excel - Vlookup 引用不同工作表中的表数据

> ID：14987017
> 
> 赞同：17
> 
> 时间：2013-02-20T18:14:00.097
> 
> 标签：excel, vlookup

我想使用一个函数来引用放置在与编写函数的`VLOOKUP`表不同的表中的数据表。`VLOOKUP`

示例：在工作表 1 中，单元格 AA3 我想插入`VLOOKUP`函数。我希望该函数检查单元格 M3 中的数字，在工作表 2 范围地址 A2:Q47 第一列中找到相同的数字，并重现该表第 13 列中的值。

我已经编写了这个函数，但它报告`#N/A`了结果：

```
=VLOOKUP(M3,Sheet1!$A$2:$Q$47,13,FALSE) 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-20T19:10:54.880

常见问题之一`VLOOKUP`是“数据不匹配”，`#N/A`因为数字查找值与表中的文本格式值不匹配`VLOOKUP`（反之亦然）

这些版本中的任何一个都有效吗？

`=VLOOKUP(M3&"",Sheet1!$A$2:$Q$47,13,FALSE)`

或者

`=VLOOKUP(M3+0,Sheet1!$A$2:$Q$47,13,FALSE)`

前者将数字查找值转换为文本（假设查找表第一列包含格式化为文本的数字）。后者则相反，将文本格式的查找值更改为数字。

根据哪一个有效（假设一个有效），您可能希望永久更改数据格式，以便该标准`VLOOKUP`有效

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-06T08:38:59.900

我遇到了这个问题，当我开始搜索我发现的重点是，你正在查找的值，即 M3 列应该出现在你想要搜索的表的第一列中 [https://support.office.com/en -us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1](https://support.office.com/en-us/article/VLOOKUP-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1) 签入lookup_value

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-26T13:52:00.417

此查找仅具有完全匹配的特征。如果您在其中一列或类似内容中有额外的空间，它将无法识别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-08T12:15:43.243

如果您从另一张纸上查看，您的公式可能有问题，也许您必须将 Sheet1 更改为 Sheet2 ---> =VLOOKUP(M3, **Sheet2** !$A$2:$Q$47,13,FALSE) --- 其中**Sheet2**是您的表格数组

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T18:18:13.470

你的公式看起来不错。也许您要查找的值不在第二个表的第一列中？

如果第二张工作表在另一个工作簿中，则需要向公式添加工作簿引用：

```
=VLOOKUP(M3,[Book1]Sheet1!$A$2:$Q$47,13,FALSE) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-14T08:42:44.040

我遇到了类似的问题，它正在返回`#N/A`。这意味着存在匹配的数据，但您可能在 M3 列记录中有额外的空间，这可能会阻止它获得准确的值。因为您已将最后一个参数设置为 FALSE，所以它正在寻找“完全匹配”。这个公式是正确的：`=VLOOKUP(M3,Sheet1!$A$2:$Q$47,13,FALSE)`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-09-01T19:25:58.043

复制`=VLOOKUP(M3,A$2:Q$47,13,FALSE)`到其他工作表，然后搜索！用 !$ 替换，搜索：用 :$ 替换所有工作表一次

# php - 剥离 FQL JSON

> ID：14987022
> 
> 赞同：0
> 
> 时间：2013-02-20T18:14:09.543
> 
> 标签：php, facebook, json, facebook-graph-api

我正在使用 FQL 运行此查询

```
"SELECT post_id, actor_id, description, created_time, message, type, attachment FROM stream WHERE source_id = $page_id AND type > 0 LIMIT 0,9" 
```

它返回 10 个项目，其中包含很多未使用的信息，并且需要一些帮助和指导来帮助将其简化为类似

```
 {
    "image" : '...',
    "text" : '...',
    "username" : '...',
    "userurl" : '...',
    "userpic" : '...'
  } 
```

有人可以给我一些关于重新格式化 JSON 对象的提示吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T05:27:48.610

它以这样的方式对我有用：

```
https://graph.facebook.com/fql?q=SELECT%20aid%2C%20owner%2C%20name%2C%20object_id%20FROM%20album%20WHERE%20aid%3D%2220531316728_324257%22 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T15:39:59.367

自己想通了，创建了一个简单的 PHP 类来保存所需的变量，然后将其添加到数组中。

对于任何感兴趣的人，这里是代码的主要部分。

班级：

```
class Item{
    public $image;
    public $link;
    public $text;
    public $username;
    public $userurl;
    public $userpic;
} 
```

正在使用：

```
$feed = json_decode($feed);
        $data = array();
        foreach ($feed->data as $post){
            $item = new Item;
            if ($post->attachment->media){
                if (isset($post->attachment->media[0]->src)){
                    $item->image = $post->attachment->media[0]->src;
                }else if (isset($post->attachment->media[0]->photo->images[1]->src)){
                    $item->image = $post->attachment->media[0]->photo->images[1]->src;
                }else if (isset($post->attachment->media[0]->src)){
                    $item->image = $post->attachment->media[0]->src;
                }
                $item->link = $post->attachment->media[0]->href;
            }

            $reg_exUrl = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";
            $text = $post->message;
            if(preg_match($reg_exUrl, $text, $url)){
                $text = preg_replace($reg_exUrl, "<a href=\"".$url[0]."\" target=\"_blank\">".$url[0]."</a> ", $text);
            }
            $item->text = $text;
            $puser = number_format($post->actor_id,0,'','');
            $url = "https://graph.facebook.com/$puser?fields=picture,name,link&access_token=$at";
            $puser = file_get_contents($url);
            $puser = json_decode($puser);

            $item->userpic = $puser->picture->data->url;
            $item->username = $puser->name;
            $item->userurl = $puser->link;
            $item->platform = "facebook";
            $data[] = $item;
        }
        $this->response($data, 200);
    } 
```

希望这对处于相同情况的其他人有所帮助。

# jmeter - 如何在jmeter中计算标准偏差？

> ID：14987023
> 
> 赞同：1
> 
> 时间：2013-02-20T18:14:10.847
> 
> 标签：jmeter

在jmeter中，如何计算标准差？

例如：

```
Samples: 1000
Average: 305 
```

那么如何计算 Std.Dev 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:20:07.467

添加“摘要报告”类型的侦听器。它为您计算标准偏差并将其作为表格的一列。

# extjs4.1 - 在其中打开窗口时的面板侦听器

> ID：14987025
> 
> 赞同：0
> 
> 时间：2013-02-20T18:14:17.103
> 
> 标签：extjs4.1

我有一个充当桌面的面板。单击按钮时，面板内会打开一个窗口。我在配置中设置了以下内容：

```
var win = Ext.create('window', { 
   renderTo : currentPanel.getLayout().getTarget(),
   constrain : true
});
win.show(); 
```

所以我的窗口在主面板中打开并受到限制。我希望面板在其中打开任何窗口时进行监听，以便我可以监视它。有没有听众会这样做？我尝试了“添加”和“添加”，但必须通过以下方式将窗口添加到面板：

```
panel.add(window); 
```

但在我的情况下，我没有将它添加到容器中，而是打开它并使用 renderTo 将其约束到我的容器中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T03:37:58.350

我要做的是为您的桌面创建一个[面板子类，并为您的](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.panel.Panel)[窗口](http://docs.sencha.com/ext-js/4-0/#!/api/Ext.window.Window)创建一个窗口子类。将“windowOpened”侦听器添加到您的自定义面板，并从您的自定义窗口的“显示”侦听器中触发此事件。

像这样的东西：

**桌面面板.js**

```
Ext.define('App.view.DesktopPanel', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.desktoppanel',

    initComponent: function() {
        this.callParent();
        this.addListener('windowOpened', function(newWindow){
            //Do whatever it is you want to do here
        });
    }
}); 
```

**桌面窗口.js**

```
Ext.define('App.view.DesktopWindow', {
    extend: 'Ext.window.Window',
    alias: 'widget.desktopwindow',

    constrain: true,

    initComponent: function() {
        this.renderTo = this.ownerPanel.getLayout().getTarget();
        this.callParent();
        this.addListener('show', function(){
            this.ownerPanel.fireEvent('windowOpened',this);
        });
    }
}); 
```

那么你的代码将是这样的：

```
var win = Ext.create('App.view.DesktopWindow', { 
   ownerPanel: MyDesktop,  //an instance of 'DesktopPanel'
});
win.show(); 
```

# jquery - 在 asp net mvc 和 iis 7.5 上上传失败并显示一些文件

> ID：14987032
> 
> 赞同：0
> 
> 时间：2013-02-20T18:14:29.830
> 
> 标签：jquery, asp.net-mvc, iis, uploadify

有些文件是上传的，但我认为这是上传大小限制，所以我添加到我的 web.config

```
<security>
  <requestFiltering>
    <requestLimits maxAllowedContentLength="524288000" maxUrl="32768" maxQueryString="32768" />
  </requestFiltering>
</security> 
```

正如您在uploadfy中看到的那样：

```
'fileSizeLimit' : 500000 
```

这就是我接受文件 <= 500MB 所需要的全部 我怎样才能找到此失败的原因？

**错误：**

```
errorCode: 200
errorMsg: 413
errorString: HTTP 413 Error 
```

**上传：**

```
$('#file_upload').uploadify({
        'debug': true,
        'swf': '../../Components/uploadify/uploadify.swf',
        'uploader': '/Operacao/Upload',
        'auto': false,
        'buttonImage': '../../Images/uploadify/importar.jpg',
        'buttonClass': 'uploadifyBtn',
        'width': '210',
        'height': '21',
        'fileSizeLimit' : 500000,
        'onUploadStart' : function(file) {
            //return alert('Starting to upload ' + file.name);
        },
        'onFallback': function () {
            alert('Versão do flash não compativel com o sistema de upload. Favor contactar o administrador do sistema!');
        },
        'onUploadError' : function(file, errorCode, errorMsg, errorString) {
            alert('O arquivo ' + file.name + ' não pode ser importado: ' + errorCode + ' - ' + errorMsg + ' - ' + errorString);
        },
        'onSelectError': function () {
            alert('Você não tem permissão para acessar o arquivo: "' + file.name + '" ou o arquivo está corrompido. Favor contactar o administrador do sistema.');
        },
        'onUploadSuccess': function (file, data, response) {
            //alert(data);
            if (data == 'true') {
                isOk = true;
                success('true');
            } else {
                success('false');
                isOk = true;
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:31:07.993

你试过看看[这个](https://stackoverflow.com/questions/467355/413-http-error-on-image-upload-in-iis6)答案吗？

> 尝试这个：
> 
> `cscript adsutil.vbs set w3svc/1/uploadreadaheadsize 204800`
> 
> 看来，当使用 3rd 方上传控件时，我假设您是，IIS 在将数据传递给 ISAPI 扩展时出现问题。上述命令会将 UploadReadAheadSize 设置为 204800KB。您可能需要调整设置的参数以匹配您所在的网络 ID。希望您可以访问服务器。
> 
> [在此处](http://technet.microsoft.com/en-us/library/cc737382.aspx)阅读更多相关信息 。

# php - jQuery .Post 在 javascript:submit_contact() 之后

> ID：14987037
> 
> 赞同：1
> 
> 时间：2013-02-20T18:14:39.263
> 
> 标签：php, jquery, .post

我正在尝试提交一个小联系表。

这是我要发布的 jquery：

```
 <script>

    $(document).ready(function(){
    function submit_contact()
        {
            $.post("http://www.domain.com/wp-content/themes/toronto/handlers/contact.php", {
            contact_text: $("[name='contact_text']").val(),
            contact_email: $("[name='contact_email']").val(),
            }, function(data){
            console.log( data );
            });

        }
    }); 

</script> 
```

这是我处理表单的html：

```
<form method="post" >

                <textarea id="contact_me_text" name="contact_text">Ask me anything!</textarea>

                <div>

                <input type="text" name="contact_email" value="Email"/><br/><br/>

                <a id="contact_submit" href="javascript:submit_contact()">Submit</a>

                </div>
</form> 
```

一切似乎都很好，但表单没有提交。我已经通过常规提交运行了 .php 文件，它工作正常。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:15:38.517

你需要在外面声明你的函数`$(document).ready()`，然后使用任何东西调用它。

**为什么我不能？**

由于不能从外部访问局部变量，同样也不能访问局部函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:19:08.133

试试这个：

```
<script>

$(document).ready(function(){
    function submit_contact()
    {
        $.post("http://www.domain.com/wp-content/themes/toronto/handlers/contact.php", {
        contact_text: $("[name='contact_text']").val(),
        contact_email: $("[name='contact_email']").val(),
        }, function(data){
        console.log( data );
        });

    }

    $('#contact_submit').on('click', function(){
        submit_contact();
        return false;
    });
}); 

</script> 
```

然后删除 HREF 属性中的 JS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:43:27.360

您需要在 jQuery 的就绪函数之外声明该函数。此外，您可以使用 serializeArray 来确定要发送的数据。通过使用它，您将不需要提及每个控件名称。在服务器端，您可以接收与您在表单中提到的相同名称的输入。

```
 function submit_contact()
{
    var params = $("#formId").serializeArray();
    $.post("http://www.domain.com/wp-content/themes/toronto/handlers/contact.php", params, function(data){
    console.log( data );
    });
} 
```

# java - 将来在 App Engine 上执行某项任务的最有效方法是什么？

> ID：14987039
> 
> 赞同：2
> 
> 时间：2013-02-20T18:14:42.297
> 
> 标签：java, google-app-engine, scheduled-tasks, scheduling

我在 App Engine 上有一个应用程序正在消耗一些数据。在解析了这些数据之后，它会知道它需要在一段时间内执行某些事情——可能不需要几个小时或几周。

在 App Engine 上任意时间后执行一段代码的最佳方法是什么？

我认为使用TaskQueue 中的[Countdown Millis](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/taskqueue/TaskOptions#countdownMillis%28long%29)或[EtaMillis](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/taskqueue/TaskOptions#etaMillis%28long%29)会起作用，但没有看到任何证据表明有人在做同样的事情，尤其是在这么长的时间范围内。

这是最好的方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T00:25:57.737

如果您能够将包含所有相关信息的对象保存在数据存储中以供将来处理（包括何时开始处理对象数据），则可以让 cron 作业定期使用日期/时间范围过滤器查询数据存储并在适当的时候触发处理上述任何对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T17:03:42.927

我们成功使用 TaskQueue 的倒计时参数在客户注册 7 天后向客户发送电子邮件以及满足其他需求。

任务队列是核心/基本 API/服务，并且非常可靠 - 我认为这是使用任务队列 ETA/倒计时的最佳方式，除非您：

*   需要能力以编程方式查看队列中的内容
*   需要能力以编程方式从队列中删除某些任务

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-26T18:48:23.630

我将任务队列用作调度程序。在[QueueConstants](https://cloud.google.com/appengine/docs/java/javadoc/com/google/appengine/api/taskqueue/QueueConstants#getMaxEtaDeltaMillis())中声明并在[QueueImpl](http://googleappengine.googlecode.com/svn-history/r165/trunk/java/src/main/com/google/appengine/api/taskqueue/QueueImpl.java)中应用了 30 天的 max eta 。

```
 //Returns the maximum time into the future that a task may be scheduled.
  private static final long MAX_ETA_DELTA_MILLIS = 2592000000L; 
```

> 1000 毫秒 * 60 秒 * 60 米 * 24 小时 * 30 天 = 2592000000 毫秒

```
 private long determineEta(TaskOptions taskOptions) {
Long etaMillis = taskOptions.getEtaMillis();
Long countdownMillis = taskOptions.getCountdownMillis();
if (etaMillis == null) {
  if (countdownMillis == null) {
    return currentTimeMillis();
  } else {
    if (countdownMillis > QueueConstants.getMaxEtaDeltaMillis()) {
      throw new IllegalArgumentException("ETA too far into the future");
    }
    if (countdownMillis < 0) {
      throw new IllegalArgumentException("Negative countdown is not allowed");
    }
    return currentTimeMillis() + countdownMillis;
  }
} else {
  if (countdownMillis == null) {
    if (etaMillis - currentTimeMillis() > QueueConstants.getMaxEtaDeltaMillis()) {
      throw new IllegalArgumentException("ETA too far into the future");
    }
    if (etaMillis < 0) {
      throw new IllegalArgumentException("Negative ETA is invalid");
    }
    return etaMillis;
  } else {
    throw new IllegalArgumentException(
        "Only one or neither of EtaMillis and CountdownMillis may be specified");
  }
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T13:54:28.677

我执行以下操作：

1.  将具有您提到的延迟配置的任务排入队列。让任务处理以已知方式更改数据存储条目（例如：设置标志）。

2.  有一个落后的低频 cron 作业，以执行任何被排队任务以某种方式遗漏的处理（例如：任务中发生未捕获的异常）。

为此，请确保任务和 cron 作业调用的处理是幂等的。

享受？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-21T00:58:40.973

我认为 taskQueue 是一个很好的策略，但有一个大问题“如果一个推送任务创建成功，它最终会被删除（最多在任务成功执行后 7 天）。” [资源](https://cloud.google.com/appengine/docs/java/taskqueue/)

我会改为使用[datastore](https://cloud.google.com/appengine/docs/java/gettingstarted/usingdatastore#adding_data_post_and_display_ui_to_jsp)。这是您可以采取的一种策略：

1.  完成“解析该数据”后，将记录插入数据存储区。
2.  检查当前日期与创建/插入日期，以查看自您的工作完成/开始等以来已经过去了多少时间（显然，您不想每分钟都做，可能每天或每小时做一次）
3.  一旦第 2 步中的条件超过您想要的“任意时间”，就执行您需要执行的下一个任务。

以下是如何将记录添加到数据存储......让你开始......

```
 Entity parsDataHolder = new Entity("parsing_data_done", guestbookKey);
    parsDataHolder.setProperty("date", date);

DatastoreService datastore = DatastoreServiceFactory.getDatastoreService();
datastore.put(parsDataHolder) 
```

# c++ - 解析 WebDAV propfind 回复

> ID：14987042
> 
> 赞同：0
> 
> 时间：2013-02-20T18:14:56.773
> 
> 标签：c++, xml, parsing, webdav

. 你好，互联网，

我正在开发一个 WebDAV 客户端，需要从 PROPFIND 请求后发送的 XML 回复中提取信息，在 C++ 中我必须承认解析这种 XML 回复的想法根本没有超越我，我没有不想重新发明轮子......那么有谁知道是否有一个 XML 解析器处理 WEBDAV 回复？

提前感谢=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T07:31:11.173

尝试使用 WebDAV API 之类的[WebDAV .NET](http://www.independentsoft.de/webdav)吗？

在 webdav.org 的网站上，我找到了很多指向各种语言的软件和库的链接，但没有找到 C++ 和 .NET 的链接。

# sql - 在 SQL 子查询中使用多列

> ID：14987043
> 
> 赞同：2
> 
> 时间：2013-02-20T18:14:57.980
> 
> 标签：sql, sql-server

我的设置是我有两个表，Study 和 Activity_History。活动以研究为基础，因此存在 1:many 关系。

我希望能够在 Activity_History 表上运行 SQL 查询，这将为我提供活动和之前运行的活动。我目前有这个：

```
SELECT 
        *
FROM Activity_History AS A1
LEFT JOIN Activity_History AS A2
ON A2.Parent_Study_ID =
(
    SELECT TOP 1 Parent_Study_ID
    FROM Activity_History AS A3
    WHERE A3.Parent_Study_ID = A1.Parent_Study_ID 
          AND A3.Activity_Date < A1.Activity_Date
    ORDER BY Activity_Date DESC
) 
```

这是行不通的。发生的事情是它拉查询的 Activity_Date 方没有任何效果，它只返回每行的降序日期顺序的第一个匹配的 Activity_Date。我认为这是因为在我的子查询中我在 where 中使用 Activity_Date，但这不在子查询选择中。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:17:56.963

我假设您使用的是 SQL Server？如果是这样，那么这应该使用 ROW_NUMBER() 工作：

```
WITH CTE AS (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY Parent_Study_Id ORDER BY Activity_Date ) RN
    FROM Activity_History
    )
SELECT * 
FROM CTE T1
    LEFT JOIN CTE T2 ON T1.RN = T2.RN+1 AND T1.Parent_Study_Id  = T2.Parent_Study_Id 
```

这是[SQL Fiddle](http://www.sqlfiddle.com/#!3/fed86/2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:55:51.623

在 SQLServer2005+ 而不是 LEFT JOIN 您需要使用[OUTER APPLY](http://msdn.microsoft.com/en-us/library/ms175156%28v=sql.105%29.aspx)

```
SELECT *
FROM Activity_History AS A1 OUTER APPLY ( 
                                         SELECT TOP 1 Parent_Study_ID
                                         FROM Activity_History AS A2
                                         WHERE A2.Parent_Study_ID = A1.Parent_Study_ID 
                                           AND A2.Activity_Date < A1.Activity_Date
                                         ORDER BY A2.Activity_Date DESC
                                         ) o 
```

# c# - 如何在数据网格视图中选择一列？

> ID：14987045
> 
> 赞同：0
> 
> 时间：2013-02-20T18:15:00.967
> 
> 标签：c#, forms, datagridview, multiple-columns

我现在只能选择行，但我想在数据网格视图中同时选择列和行。我该怎么做？

# python - matplotlib - 使用线条剪辑图像

> ID：14987049
> 
> 赞同：2
> 
> 时间：2013-02-20T18:15:14.770
> 
> 标签：python, matplotlib

是否可以将生成的图像剪辑`imshow()`到一行/多行下的区域？我认为[在 matplotlib 中使用多个补丁来剪辑图像](https://stackoverflow.com/questions/8126151/clip-an-image-using-several-patches-in-matplotlib)可能有解决方案，但我不确定如何在此处应用它。

`imshow()`我只想要此图中线条下 的着色（来自）：![具有 IR/Vis/UV 着色的归一化普朗克定律图](../Images/dbf90c9ce2b0f9658484e856315b0fc2.png)

这是我的绘图代码：

```
from __future__ import division
from matplotlib.pyplot import *
from numpy import *

# wavelength array
lambd = logspace(-3.8, -7.2, 1000)

# temperatures
T_earth = 300
T_sun = 6000

# planck's law constants
h = 6.626069e-34
c = 2.997925e8
k = 1.380648e-23

# compute power using planck's law
power_earth = 2*h*c**2/lambd**5 * 1/(exp(h*c/(lambd*k*T_earth)) - 1)
power_sun = 2*h*c**2/lambd**5 * 1/(exp(h*c/(lambd*k*T_sun)) - 1)

# set up color array based on "spectrum" colormap
colors = zeros((1000,1000))
colors[:,:1000-764] = 0.03
for x,i in enumerate(range(701,765)):
    colors[:,1000-i] = 1-x/(765-701)
colors[:,1000-701:] = 0.98

figure(1,(4,3),dpi=100)
# plot normalized planck's law graphs
semilogx(lambd, power_earth/max(power_earth), 'b-', lw=4, zorder=5); hold(True)
semilogx(lambd, power_sun/max(power_sun), 'r-', lw=4, zorder=5); hold(True)
# remove ticks (for now)
yticks([]); xticks([])
# set axis to contain lines nicely
axis([min(lambd), max(lambd), 0, 1.1])
# plot colors, shift extent to match graph
imshow(colors, cmap="spectral", extent=[min(lambd), max(lambd), 0, 1.1])
# reverse x-axis (longer wavelengths to the left)
ax = gca(); ax.set_xlim(ax.get_xlim()[::-1])

tight_layout()
show() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-14T15:08:05.630

在这种情况下，您可以做的是使用曲线下的区域作为补丁来应用 set_clip_path。您所要做的就是调用 fill_between 并提取相应的路径，如下所示：

```
semilogx(lambd, power_earth/max(power_earth), 'b-', lw=4, zorder=5)
# Area under the curve
fillb_earth = fill_between(lambd, power_earth/max(power_earth), color='none', lw=0)
# Get the path
path_earth, = fillb_earth.get_paths()
# Create a Patch
mask_earth = PathPatch(path_earth, fc='none')
# Add it to the current axes
gca().add_patch(mask_earth)
# Add the image
im_earth = imshow(colors, cmap="spectral", extent=[min(lambd), max(lambd), 0, 1.1])
# Clip the image with the Patch
im_earth.set_clip_path(mask_earth) 
```

然后对太阳重复相同的行。这是结果。![剪切的图像](../Images/3efbe2782d1c1ffc11b1c02c2c5089ac.png)

# java - 休眠缓存：缓存查询返回的对象是否存储在二级缓存中？

> ID：14987050
> 
> 赞同：8
> 
> 时间：2013-02-20T18:15:18.190
> 
> 标签：java, hibernate, ehcache

我们在项目中使用**hibernate4**和**ehcache**。我们主要处理不可变对象，因此缓存是一个非常适合我们应用程序的功能。在尝试启用查询缓存时，我们遇到了以下问题：

假设我们有以下实体：

```
@Entity 
@Table(name = "DOGS")
@Immutable 
@Cache(usage = CacheConcurrencyStrategy.READ_ONLY)
class Dog {
  @Id @Column
  Long id;
  @Column
  String name;
} 
```

和查询：

```
Criteria criteria = session.createCriteria(Dog.class);
criteria.add(Restrictions.in("id", ids));
criteria.setCacheable(true); 
```

查询缓存 timeToLive 设置为 Dog timeToLive 的 3/4 左右。这是场景（如果我做出错误的假设，请纠正我）：

1.  第一次调用查询时（假设缓存为空），它被执行，返回的 Dog 实例存储在二级缓存中。此外，Dog id 存储在查询缓存中。
2.  第二次调用查询（Dog id 在查询缓存中，Dog 对象在 L2 缓存中），一切正常。查询缓存返回 ids 并且从 L2 获取 Dogs。
3.  当查询缓存过期（但二级缓存仍然有效）时，查询重新运行并缓存 Dog id。
4.  现在，Dog 对象的 L2 缓存到期，所有对象都从缓存中逐出。查询缓存仍然缓存了 id，因此 hibernate 会**一个一个**地获取 Dog 对象，这需要很长时间。

第三点困扰着我。查询缓存失效并在数据库上重新运行，获取 Dog 对象，但 Dog 对象未在 L2 缓存中更新。看起来查询只更新了查询缓存中的狗 ID，而不是 L2 缓存。

有没有办法强制查询也更新 L2 缓存？也许这种情况要以不同的方式处理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-25T12:04:25.603

请参阅二级缓存适用于您指定用于缓存的对象/Pojo。但是查询缓存是为特定查询创建的。因此，当您的查询缓存更新时，两者都不相关并且二级缓存不会更新似乎很自然。这就是为什么它们都有不同的配置。您可以参考[Hibernate 文档](http://www.hibernate.org/docs)或[此链接](http://www.coderanch.com/t/526101/ORM/databases/Relation-Hibernate-Query-Cache-Level)，或者[此链接](http://www.javalobby.org/java/forums/t48846.html)可以帮助您理解事物。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-25T09:58:52.627

我尝试过这个并在过去为我工作以清理 L2 缓存

```
//clear the cache entity
sf.getCache().evictEntity(Dog.class,12345); //Entity with 12345 id

//or clear a collection 
sf.getCache().evictCollection("com.package.Dog.getCol",12345); //Collections
//Note: the collection contains the name of the fully qualified class.

//then, run the query 
```

希望能帮助到你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-12T01:43:23.113

在我的例子中，我禁用了休眠中的最小放置设置，然后查询缓存将在每次 SQL 发出时自动更新所有相关的二级缓存。

我认为这是您问题“强制查询也更新 L2 缓存”的解决方案（这也困扰了我很长时间.....）

```
<property name="hibernate.cache.use_minimal_puts" value="false"/> 
```

# c# - 在 xp 中运行 .net 4 应用程序时出错

> ID：14987051
> 
> 赞同：0
> 
> 时间：2013-02-20T18:15:22.153
> 
> 标签：c#, windows, .net-4.0, windows-xp

当我尝试在 Windows XP 中运行 .NET 4 应用程序时出现以下错误

```
event type clr20r3
p1 transfersectorapp.exe
p2 1.0.0.0
p3 51200779
p4 presentationcore
p5 4.0.0.0
p6 4ba1f865
p7 1a53
p8 1d
p9 system.io.filenotfoundexception 
```

我不知道为什么会这样，即使我已经安装了我的先决条件（xp 机器上的.net 4 客户端配置文件）。应用程序在 Windows 7 上运行良好。如果您需要任何额外信息，请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:45:05.547

没有应用程序代码很难猜测，但似乎应用程序正在尝试读取文件但没有找到它，要么是没有设置正确的权限，要么是文件根本不存在

# javascript - 使用 Mozilla Firefox 扩展将字符串对象内容下载为纯文本文件

> ID：14987053
> 
> 赞同：0
> 
> 时间：2013-02-20T18:15:27.620
> 
> 标签：javascript, firefox-addon, download

在我的 FF 扩展中，我创建了一个从 DOM 检索数据的对象（一个字符串）。

现在我需要下载一个带有字符串内容的纯文本文件。结果应该是一个 CSV 文件。

我读到了`addDownload`方法，但我错过了很多……有什么提示吗？

主要是我不知道如何：

1.  在可下载的对象（文件？）中“转换”我的字符串

2.  正确调用`addDownload`方法（nsIURI 等）

非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:28:03.613

这是我的扩展的一部分，它显示了另存为对话框，因此用户可以选择正确的位置（您可以跳过该部分或尝试找出应该自动放置下载的位置）

```
const nsIFilePicker = Components.interfaces.nsIFilePicker;

var fp = Components.classes["@mozilla.org/filepicker;1"]
.createInstance(nsIFilePicker);
fp.init(window, "Save as", nsIFilePicker.modeSave);
fp.appendFilters(nsIFilePicker.filterHTML);
fp.appendFilters(nsIFilePicker.filterAll);

var rv = fp.show();
if (rv == nsIFilePicker.returnOK || rv == nsIFilePicker.returnReplace) {
var file = fp.file;

// work with returned nsILocalFile...
// Check that it has some extension
var name = file.leafName;
if (-1==name.indexOf('.'))
file.leafName = name + '.html' ;

// file is nsIFile, data is a string
var foStream = Components.classes["@mozilla.org/network/file-output-stream;1"]
.createInstance(Components.interfaces.nsIFileOutputStream);

// use 0x02 | 0x10 to open file for appending.
foStream.init(file, 0x02 | 0x08 | 0x20, 0666, 0);
// write, create, truncate

foStream.write(data, data.length);
foStream.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T22:41:30.917

你有很多方法。老式的方法是直接操作`nsIFile`，`nsIFileOutputStream`尽管您不能以这种方式写入空字节。您还可以`nsIStringInputStream`从您的字符串创建一个并将其写入您的输出流，或者您可以使用`nsIAsyncStreamCopier`异步复制它。`FileUtils.jsm`并`NetUtil.jsm`存在试图让这对你更容易。

但是，如果您的目标是足够新的 Firefox 版本，则可以忽略所有这些并改用[`OS.File`](https://developer.mozilla.org/en-US/docs/JavaScript_OS.File)API。

# ios - C4Image 原始像素

> ID：14987056
> 
> 赞同：1
> 
> 时间：2013-02-20T18:15:42.497
> 
> 标签：ios, c4

我正在尝试使用图像的原始像素，但遇到了一些问题。

首先，在 C4Image 上调用 .CGImage 不起作用，所以我必须使用 UIImage 来加载文件。

其次，字节数组似乎是错误的长度，图像似乎没有正确的尺寸或颜色。

我从[这里的讨论中借用了一些代码。](https://stackoverflow.com/questions/1281210/can-i-edit-the-pixels-of-the-uiimages-property-cgimage)

```
UIImage *image      = [UIImage imageNamed:@"C4Table.png"];
CGImageRef imageRef = image.CGImage;
NSData *data        = (__bridge NSData *)CGDataProviderCopyData(CGImageGetDataProvider(imageRef));
unsigned char * pixels        = (unsigned char *)[data bytes];

for(int i = 0; i < [data length]; i += 4) {
    pixels[i] = 0; // red
    pixels[i+1] = pixels[i+1]; // green
    pixels[i+2] = pixels[i+2]; // blue
    pixels[i+3] = pixels[i+3]; // alpha
}

size_t imageWidth                    = CGImageGetWidth(imageRef);
size_t imageHeight                   = CGImageGetHeight(imageRef);
NSLog(@"width:   %d  height: %d  datalength: %d" ,imageWidth ,imageHeight, [data length] );

C4Image *imgimgimg = [[C4Image alloc] initWithRawData:pixels width:imageWidth height:imageHeight];
[self.canvas addImage:imgimgimg]; 
```

有没有更好的方法来做到这一点，还是我错过了一步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T01:00:49.237

Close. There is a `loadPixelData` method on C4Image, and if you check in the main [C4 repo (C4iOS)](https://github.com/C4Framework/C4iOS) you'll be able to see how the image class loads pixels... It can be tricky.

C4Image loadPixelData:

```
-(void)loadPixelData {
    const char *queueName = [@"pixelDataQueue" UTF8String];
    __block dispatch_queue_t pixelDataQueue = dispatch_queue_create(queueName,  DISPATCH_QUEUE_CONCURRENT);

    dispatch_async(pixelDataQueue, ^{
        NSUInteger width = CGImageGetWidth(self.CGImage);
        NSUInteger height = CGImageGetHeight(self.CGImage);
        CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

        bytesPerPixel = 4;
        bytesPerRow = bytesPerPixel * width;
        free(rawData);
        rawData = malloc(height * bytesPerRow);

        NSUInteger bitsPerComponent = 8;
        CGContextRef context = CGBitmapContextCreate(rawData, width, height, bitsPerComponent, bytesPerRow, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
        CGColorSpaceRelease(colorSpace);
        CGContextDrawImage(context, CGRectMake(0, 0, width, height), self.CGImage);
        CGContextRelease(context);
        _pixelDataLoaded = YES;
        [self postNotification:@"pixelDataWasLoaded"];
        pixelDataQueue = nil;
    });
} 
```

To modify this for your question, I have done the following:

```
-(void)getRawPixelsAndCreateImages {
    C4Image *image      = [C4Image imageNamed:@"C4Table.png"];

    NSUInteger width = CGImageGetWidth(image.CGImage);
    NSUInteger height = CGImageGetHeight(image.CGImage);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();

    NSUInteger bytesPerPixel = 4;
    NSUInteger bytesPerRow = bytesPerPixel * width;
    unsigned char *rawData = malloc(height * bytesPerRow);

    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height, bitsPerComponent, bytesPerRow, colorSpace, kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);
    CGContextDrawImage(context, CGRectMake(0, 0, width, height), image.CGImage);
    CGContextRelease(context);

    C4Image *imgimgimg = [[C4Image alloc] initWithRawData:rawData width:width height:height];
    [self.canvas addImage:imgimgimg];

    for(int i = 0; i < height * bytesPerRow; i += 4) {
        rawData[i] = 255;
    }

    C4Image *redImgimgimg = [[C4Image alloc] initWithRawData:rawData width:width height:height];
    redImgimgimg.origin = CGPointMake(0,320);
    [self.canvas addImage:redImgimgimg];
} 
```

It can be quite confusing to learn how to work with pixel data, because you need to know how to work with Core Foundation (which is pretty much a C api). The main line of code, to populate the `rawData` is a call to `CGContextDrawImage` which basically copies the pixels from an image into the data array that you're going to play with.

I have created a gist that you can download to play around with in C4.

[Working with Raw Pixels](https://gist.github.com/C4Code/5001069)

In this gist you'll see that I actually grab the CGImage from a C4Image object, use that to populate an array of raw data, and then use that array to create a copy of the original image. Then, I modify the red component of the pixel data by changing all values to 255, and then use the modified pixel array to create a tinted version of the original image.

# group-by - MySQL选择字段是唯一的还是空的

> ID：14987058
> 
> 赞同：1
> 
> 时间：2013-02-20T18:15:47.160
> 
> 标签：group-by, unique, distinct, no-duplicates, ignore-duplicates

抱歉，我在任何地方都找不到示例，主要是因为我想不出任何不包括 DISTINCT 或 UNIQUE 的其他方式来解释它（我发现它们在 SQL 中具有误导性）。

我需要从一个表中选择唯一值和空值。

```
FLAVOURS:
id  |  name  |  flavour
--------------------------
1   |  mark  |  chocolate
2   |  cindy |  chocolate
3   |  rick  |  
4   |  dave  |  
5   |  jenn  |  vanilla
6   |  sammy |  strawberry
7   |  cindy |  chocolate
8   |  rick  |  
9   |  dave  |  
10  |  jenn  |  caramel
11  |  sammy |  strawberry 
```

我想要有独特风味（香草、焦糖）的孩子和没有任何风味的孩子。

我不希望孩子有重复的口味（巧克力、草莓）。

我的帮助搜索总是返回有关如何对巧克力和草莓进行 GROUP BY、UNIQUE 和 DISTINCT 的答案。那不是我想要的。我不希望某个领域中有任何重复的术语——我想要其他所有内容。

什么是正确的 MySQL 选择语句？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:36:48.117

您可以使用 HAVING 仅选择一些组，因此要选择只有一种风味的组，请使用：

```
SELECT * from my_table GROUP BY flavour HAVING COUNT(*) = 1 
```

如果你想选择那些有 NULL 条目的用户，你可以使用

```
SELECT * FROM my_table WHERE flavour IS NULL 
```

如果将它们结合起来，您将获得所有具有独特风味或 NULL 的条目。

```
SELECT * from my_table GROUP BY flavour HAVING COUNT(*) = 1 AND flavour IS NOT NULL
UNION
SELECT * FROM my_table WHERE flavour IS NULL 
```

我添加了“flavour IS NOT NULL”只是为了确保如果它是单个风味，则不会选择为 NULL 的风味，这会产生重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:38:03.583

您需要一个查找重复项的自联接，然后您需要通过查找不匹配的情况（即 WHERE t2.flavor IS NULL）来否决这些重复项。然后你正在做一些完全不同的事情，在原始表中寻找空值，第二行在 WHERE 子句中（OR t1.flavor IS NULL）

```
SELECT DISTINCT t1.name, t1.flavor 
FROM tablename t1
LEFT JOIN tablename t2
ON t2.flavor = t1.flavor AND t2.ID <> t1.ID
WHERE t2.flavor IS NULL
OR t1.flavor IS NULL 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:24:39.720

我手头没有数据库，但您应该能够使用类似的查询。

> SELECT name from FLAVORS WHERE flavor IN (SELECT flavor, count(Flavour) from FLAVORS where count(Flavour) = 1 GROUP BY flavor) OR flavor IS NULL;

如果这不是很正确，我深表歉意，但希望是一个好的开始。

# ios - 使用 SimpleAudioEngine 按顺序播放声音

> ID：14987061
> 
> 赞同：3
> 
> 时间：2013-02-20T18:15:54.293
> 
> 标签：ios, audio, simpleaudioengine

我正在用 cocos2d 2 构建一个 iOS 应用程序，并且我正在使用 SimpleAudioEngine 来播放一些效果。

有没有办法在前一个声音完成后对要播放的多个声音进行排序？

例如在我的代码中：

```
[[SimpleAudioEngine sharedEngine] playEffect:@"yay.wav"];
[[SimpleAudioEngine sharedEngine] playEffect:@"youDidIt.wav"]; 
```

当此代码运行时，`yay.wav`并`youDidIt.wav`在完全相同的时间播放，彼此重叠。

我`yay.wav`想玩，一旦完成，`youDidIt.wav`就玩。

如果不使用 SimpleAudioEngine，是否有使用 AudioToolbox 或其他方法的方法？

谢谢！

==**更新**==

我想我将使用 AVFoundation 使用这种方法：

```
AVPlayerItem *sound1 = [[AVPlayerItem alloc] initWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"yay" ofType:@"wav"]]];
AVPlayerItem *sound2 = [[AVPlayerItem alloc] initWithURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"YouDidIt" ofType:@"wav"]]];    
AVQueuePlayer *player = [[AVQueuePlayer alloc] initWithItems: [NSArray arrayWithObjects:sound1, sound2,  nil]];
[player play]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:51:57.827

简单的方法是使用获取曲目持续时间`-[CDSoundSource durationInSeconds]`，然后在适当的延迟后安排第二个效果播放：

```
[[SimpleAudioEngine sharedEngine] performSelector:@selector(playEffect:) withObject:@"youDidIt.wav" afterDelay:duration]; 
```

获取音频持续时间的更简单方法是修补 SimpleAudioManager 并添加一个查询其`CDSoundEngine`（静态全局）音频持续时间的方法：

```
- (float)soundDuration {
    return [_engine bufferDurationInSeconds:_soundId];
} 
```

第二种方法是轮询音频引擎的状态并等待它停止播放。

```
 alGetSourcei(sourceId, AL_SOURCE_STATE, &state);
    if (state == AL_PLAYING) {
      ... 
```

`sourceId`是`ALuint`返回的`playEffect`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-16T19:18:15.383

很简单，用 Cocos2D 2.1 测试过：

1.  在 SimpleAudioEngine.h 上创建一个属性 durationInSeconds ：

    ```
    @property (readonly) float durationInSeconds; 
    ```

2.  合成它们：

    ```
    @synthesize durationInSeconds; 
    ```

3.  像这样修改 playEffect ：

    ```
    -(ALuint) playEffect:(NSString*) filePath pitch:(Float32) pitch pan:(Float32) pan gain:(Float32) gain {
        int soundId = [bufferManager bufferForFile:filePath create:YES];
        if (soundId != kCDNoBuffer) {
            durationInSeconds = [soundEngine bufferDurationInSeconds:soundId];
            return [soundEngine playSound:soundId sourceGroupId:0 pitch:pitch pan:pan gain:gain loop:false];
        } else {
            return CD_MUTE;
        }
    } 
    ```

4.  如您所见，我直接从 soundEngine bufferDurationInSeconds 中插入了来自 bufferManager 的结果的 durationInSeconds 值。

5.  现在，只需询问 [SimpleAudioEngine sharedEngine].durationInSeconds 的值，您就可以得到此声音的浮动持续时间（以秒为单位）。

6.  在这几秒钟内放一个计时器，然后播放下一次声音或关闭标志或其他东西。

# scala - 我怎样才能加快扁平化？

> ID：14987065
> 
> 赞同：0
> 
> 时间：2013-02-20T18:16:03.877
> 
> 标签：scala

我有这个方法：

```
val reportsWithCalculatedUsage = time("Calculate USAGE") {
  reportsHavingCalculatedCounter.flatten.flatten.toList.groupBy(_._2.product).mapValues(_.map(_._2)) mapValues { list =>
    list.foldLeft(List[ReportDataHelper]()) {
      case (Nil, head) =>
        List(head)
      case (tail, head) =>
        val previous = tail.head
        val current = head copy (
          usage = if (head.machine == previous.machine) head.counter - previous.counter else head.usage)
        current :: tail
    } reverse
  }
} 
```

哪里`reportsHavingCalculatedCounter`是类型：`val reportsHavingCalculatedCounter: scala.collection.immutable.Iterable[scala.collection.immutable.IndexedSeq[scala.collection.immutable.Map[Strin g,com.agilexs.machinexs.logic.ReportDataHelper]]]`。

此代码完美运行。问题是它`reportsHavingCalculatedCounter`内部有地图，其对象总和`ReportDataHelper`（地图值）约为 50 000 个条目，处理`flatten.flatten`时间约为 15 秒。

我也尝试过使用 2 张平面地图，但这几乎相同（耗时）。有什么办法可以改善这一点吗？（请忽略`foldLeft`or `reverse`；如果我删除该问题仍然存在，最耗时的是那些 2 `flatten`）。

**更新**：我尝试过不同的场景：

```
val reportsHavingCalculatedCounter2: Seq[ReportDataHelper] = time("Counter2") {
  val builder = new ArrayBuffer[ReportDataHelper](50000)
  var c = 0
  reportsHavingCalculatedCounter.foreach { v =>
    v.foreach { v =>
      v.values.foreach { v =>
        c += 1
        builder += v
      }
    }
  }
  println("Count:" + c)
  builder.result
} 
```

它需要：`Counter2 (15.075s)`.

我无法想象 scala 很慢。这是最慢的部分`v.values.foreach`。

# java - 在匿名类线程中使用数组是否安全？

> ID：14987066
> 
> 赞同：1
> 
> 时间：2013-02-20T18:16:14.593
> 
> 标签：java, thread-safety

我正在尝试确定以下 java 方法是否是线程安全的：

```
public Object calledByMultipleThreads() {
    final Object[] item = new Object[1];

    if (!EventQueue.isDispatchThread()) {
        try {
            EventQueue.invokeAndWait(new Runnable() {
                @Override
                public void run() {
                    helperMethod(item)
                }
            });
        } catch (InterruptedException | InvocationTargetException ex) {
            // logging...
        }
    } else {
        helperMethod(item)

    }

    return item[0];
}

private void helperMethod(Object[] item) {
    item[0] = new Object();
} 
```

我知道这`final Object[] item = new Object[1]`是一种解决方法（因为`final Object item`无法在 内部修改之类的东西`Runnable`）。并且由于`invokeAndWait`使用，`item[0]`在它被引用之前设置`return`，但我担心调用者线程（不是EDT）可能看不到对`item`数组的更新，并返回`null`。这可能吗？有什么方法可以测试它的安全性吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:20:31.397

由于如何`invokeAndWait`实现的细节，所有在`Runnable` *发生之前发生的*动作都将控制权返回给调用者`invokeAndWait`：

```
1233  同步（锁定）{ 
1234      工具包。获取事件队列（）。postEvent（事件）；
1235       while (! event.isDispatched ()) { 
1236          锁。等待（）；
1237       } 
1238   }

```

换句话说，你正在做的事情是安全的。另一方面，没有办法通过测试来确保这样的保证:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:20:34.860

`final`与非实例字段相比，数组不会自动成为线程安全的。

但是，这里不存在线程安全问题。在内部分配和该方法返回之间会有一个*happens-before 。*`EventQueueinvokeAndWait`

注意`invokeAndWait`容易导致（有效的）死锁。`EventQueue.invokeLater`使用类似的方法回发到非 EDT 线程要好得多。

# xml - 使用 XML 路径交叉应用（逗号划定） - 如果 > 1 则删除 Max Row

> ID：14987067
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:16:18.347
> 
> 标签：xml, tsql, max, cross-apply

我想要的是如果它返回超过 1 然后删除**MAX([year]) 行**但返回其余的。这意味着如果 Cross Applyselect 返回 4 条记录，则仅返回 3。如果 3，则仅返回 2。如果 2，则仅返回 1。我相信最好的方法是将逗号更改为另一个字符（例如 #）。右搜索 # 删除所有内容 右下。如果我不使用 Cross Apply，我可能会有 3 行 Row(1)18 ----John Smith ---- BA ---- College1 --- 1990 Row(2) 18----John Smith ---MS---- Univ1-----2003 Row(3)18----John Smith ----BA ----Univ2 -----2010....我想删除第 (3) 行，因为它是学生最新/当前的学位信息。我只想要之前的学位、机构、年份而不是当前的。也许是 Right(rtrim(everthing after last comma) 但必须计数 下面是 SQL：

```
SELECT 
DISTINCT 
                      vw_name.personID AS personID,
                       vw_name.FullName AS FullName,
                        (CASE WHEN LEN(commaDegree) <= 2 THEN commaDegree ELSE LEFT(commaDegree, 
                      LEN(commaDegree) - 1) END) AS commaDegree,
                       (CASE WHEN LEN(commaInst) <= 2 THEN commaInst ELSE LEFT(commaInst, LEN(commaInst) - 1) END) 
                      AS commaInst,
                       (CASE WHEN LEN(commaYear) <= 2 THEN commaYear ELSE LEFT(commaYear, LEN(commaYear) - 1) END) 
                      AS commaYear
FROM vw_name LEFT JOIN
                      vw_deg_all ON 
                      vw_deg_all.personID = vw_name.personID                      

CROSS
                       APPLY
                          (SELECT     isnull(degree.degree + N', ', N'')
                            FROM          vw_deg_all LEFT JOIN
                                                   degree ON vw_deg_all.degreeID = degree.id
                            WHERE      vw_deg_all.personID = vw_name.personID
                            ORDER BY vw_deg_all.[year] ASC FOR XML PATH('')) AS t (commaDegree) 

CROSS APPLY
                          (SELECT     isnull(institution.inst + N', ', N'')
                            FROM          vw_deg_all LEFT JOIN
                                                   institution ON vw_deg_all.institutionID = institution.id
                            WHERE      vw_deg_all.personID = vw_name.personID
                            ORDER BY vw_deg_all.[year] ASC FOR XML PATH('')) AS u(commaInst) 

CROSS APPLY
                          (SELECT     isnull(CONVERT(nvarchar, vw_deg_all.[year]) + N', ', N'')
                            FROM          vw_deg_all
                            WHERE      vw_deg_all.personID = vw_name.personID
                            ORDER BY vw_deg_all.[year] ASC FOR XML PATH('')) AS v(commaYear) 
```

**结果查询**

PersonID -- 全名 -- 逗号学位 -- CommInst -- CommYear

18 -- John Smith -- 学士、硕士、博士 -- College1、Univ1、Univ2 -- 1990、2003、2010

45 -- Paul Ryan -- 学士、硕士 -- College15、Univ19 -- 1999、2008

134 -- 辛迪·琼斯 -- 文学学士 -- College56 -- 1978

我只想返回**PRIOR**学位、机构、年份。**不是最新的**。含义 PersonID 18 删除 PHd，Univ2，2010。PersonID 45 删除 MS，Univ19，2008。PersonID 134 保留原样，因为只有 1 条记录。

希望这是有道理的。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:58:49.747

如果我理解得很好，您想删除每个 CSV 列的第一个值。为什么不这样做：

```
DECLARE @Field as nvarchar(MAX)
SET @Field = 'College1, Univ1, Univ2'
SELECT Substring(@Field,PATINDEX('%,%',@Field)+1,LEN(@Field)-PATINDEX('%,%',@Field)) 
```

希望这可以帮助！

# rest - 在 ServiceStack 中组合 URL 和 POST 变量

> ID：14987069
> 
> 赞同：2
> 
> 时间：2013-02-20T18:16:35.397
> 
> 标签：rest, routing, servicestack

我正在尝试将现有的 wcf rest api 转换为 ServiceStack，并且一开始就遇到问题：

```
[Route("foo/{userId}","POST")]
public class MyInputModel : IReturnVoid
{
    public string userId { get; set; }
    public SomeOtherObject properties { get; set; }
} 
```

这里的目的是我将在 url 中提供 userId，并在帖子正文中提供 SomeOtherObject 的实例。我得到的错误是

```
<Message>Could not deserialize 'application/xml' request using MyInputModel'
Error: System.Runtime.Serialization.SerializationException: 
Error in line 1 position 42\. Expecting element 'MyInputModel' 
from namespace 'blahblahblah'.. Encountered 'Element'  with name 
'SomeOtherObject', namespace 'http://blahblahblah'. 
```

我唯一能想到的就是将我的 xml 包装在 a`MyInputModel`中以使序列化程序满意。这并不是向后兼容的真正选择。

我也可以修改`SomeOtherObject`为顶级输入模型，并在其中放置一个`UserId`属性，但这也感觉不是最理想的，因为它是整个 api 中使用的对象，并且实际上与用户 ID 无关。它也已经独立发布，因此在那里进行更改会很痛苦。

有什么方法可以表明发布数据的根元素将是 a 的`SomeOtherObject`insted`MyInputModel`吗？在 WebApi 中，这将是`[FromBody]`属性和诸如此类的东西。servicestack有类似的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:23:16.990

DTO 的目的是自动生成有线格式，这就是为什么[ServiceStack](http://www.servicestack.net/)需要 Request DTO 来匹配传入请求的形状。ServiceStack 如此高效的部分原因在于它是一个代码优先的 Web 服务框架，它鼓励从**C# 开始并向外投射**，即您的客户端应该绑定到您的 Web 服务输出，而不是反过来将代码优先模型映射到现有的模式输入。

话虽如此，[序列化/反序列化 wiki 页面](https://github.com/ServiceStack/ServiceStack/wiki/Serialization-deserialization)列出了用您自己的方法覆盖 ServiceStack 的默认请求绑定的不同方法。

### 在任何服务或过滤器中访问 HTTP 请求变量

并非所有内容都需要映射到 DTO，因为仍然可以从任何服务或过滤器提供的[IHttpRequest访问任何 HTTP 变量，即：](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.Interfaces/ServiceHost/IHttpRequest.cs)

```
base.Request.QueryString
base.Request.FormData
base.Request.Headers[name]
base.Request.PathInfo
base.Request.AbsoluteUri 
```

# mysql - 子查询的 SQL 别名

> ID：14987070
> 
> 赞同：0
> 
> 时间：2013-02-20T18:16:38.770
> 
> 标签：mysql, sql, yii

我对以下查询有疑问：

```
SELECT * FROM (
  (SELECT * FROM Images 
   WHERE create_user_id=:user_id) RIGHT INNER JOIN 
  (SELECT * FROM PhotoGallery) ON id=centity_id
 )
 ORDER BY centity_id; 
```

我收到 1248 - 每个派生表都必须有自己的别名错误，我知道我需要为这些表提供别名，但无论我做什么，我总是会出错。谁能帮我解决这个问题？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:22:32.550

If you are doing a select *, you don't need to do a sub-query.

```
SELECT * FROM Images 
  RIGHT OUTER JOIN PhotoGallery ON id=centity_id
WHERE create_user_id = :user_id
ORDER BY centity_id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:21:06.567

尝试这个

```
SELECT * 
  FROM Images i RIGHT JOIN
       PhotoGallery p ON i.id=p.centity_id
 WHERE i.create_user_id=:user_id
 ORDER BY p.centity_id 
```

根据您的 DDL 和您所需的输出连接可能是`RIGHT`,`INNER`或`LEFT`, 但不是`RIGHT INNER JOIN`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:21:15.530

您的子查询需要别名。就像是：

```
SELECT * FROM (
  (SELECT *
   FROM Images 
   WHERE create_user_id=:user_id
  ) i RIGHT INNER JOIN 
  PhotoGallery pg
  ON i.id=pg.centity_id
 )
 ORDER BY centity_id; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T18:21:19.727

我从未听说过支持“RIGHT INNER JOIN”的 dbms。选择其中之一

*   内连接，或
*   右外连接，或
*   RIGHT JOIN（应该与 RIGHT OUTER JOIN 相同）。

# php - 用于获取最佳答案的自定义 mysql 查询

> ID：14987075
> 
> 赞同：2
> 
> 时间：2013-02-20T18:17:03.860
> 
> 标签：php, mysql

我使用 PHP 和 MySQL 创建了一个自定义论坛。我有两张表，一张用于线程，一张用于线程中的消息。

我正在实施一项功能，管理员可以选择一条消息作为最佳答案。在消息表中，best_answer 有一个 BOOL 列。

在列出线程的页面上，我想指出线程是否选择了最佳答案。

是否可以编写一个查询来选择所有线程，但也可以查看线程的消息，看看是否选择了最佳答案？

我正在尝试类似的东西：

```
SELECT *
FROM `threads`
JOIN `messages` ON `threads`.`id` = `messages`.`thread_id`
WHERE `messages`.`best_answer` = 1 
```

但是，这只会拉出具有最佳答案的线程，我仍然需要它来拉动所有线程并拥有一列，以便我可以检查它是否有最佳答案。

只在线程表中添加一列以标记它是否选择了最佳答案会更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T18:32:55.323

有时，通过在子句中使用子查询更容易“看到”结果`select`：

```
select t.*,
       (select MAX(bestanswer) from messages m where m.thread_id = t.id
       ) as HasBestAnswer
from threads t 
```

不过，这会将结果限制为线程，这似乎是您想要的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T18:28:01.847

如果您正在寻找纯 SQL 解决方案，那么这应该适合您。

```
select * 
from threads
join (
    select threads.id, 
    sum(messages.best_answer) as has_best_answer
    from threads join messages
    on threads.id = messages.thread_id
    group by threads.id
)temp
on threads.id = temp.id 
```

编辑：将查询缩短为

```
select * 
from threads
join (
    select thread_id, 
    sum(messages.best_answer) as has_best_answer
    from messages
    group by thread_id
)temp
on threads.id = temp.thread_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T18:27:30.327

```
SELECT *
FROM `threads`
LEFT JOIN `messages` ON `threads`.`id` = `messages`.`thread_id` AND `messages`.`best_answer` = 1
GROUP BY `threads`.`id` 
```

如果可能，这将为您提供所有线程和最佳答案。 `LEFT JOIN`还用于显示未找到最佳答案的线程 您可以使用`ON`子句中的每个表达式来评估为真或假。

`GROUP BY`用于仅在结果集中为您提供一个具有特定`thread_id`且因此只有一个最佳答案的条目。

但是，您应该将“最佳答案”部分从`messages`表格中移出到`threads`表格中。因为一个线程只能有一个最佳答案，反之则不行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T18:22:01.923

This should pull the data as you are trying to:

```
SELECT threads.*, messages.best_answer
FROM threads
LEFT JOIN messages ON threads.id = messages.thread_id
GROUP BY threads.id
ORDER BY messages.best_answer DESC 
```

And later, with the result set...

```
while ( $row = [...] ){
    if ( $row['best_answer'] > 0 ) { 
        // Best Answer is set, do something
    } else {
        // No best answer, do something else
    }
} 
```

We do not include the `WHERE` clause, which was limiting your results to just those `threads` with a `message` whose `best_answer` column is set to 1\. Now, we get all `threads`, and we can check in the loop whether a `best_answer` is 1 or 0.

# cuda - 将推力设备向量包装在结构中？

> ID：14987083
> 
> 赞同：0
> 
> 时间：2013-02-20T18:17:38.160
> 
> 标签：cuda, thrust

我正在实现一个数学算法，需要保持大约 15 个不同的浮点向量。我想将所有这些设备向量包装到一个结构中

```
typedef struct {
  thrust::device_vector<float> ...
} data; 
```

并将这个结构传递给不同的函数。有可能有这样的包装吗？当我尝试初始化一个这样的结构时

```
data* mydata = (data*) malloc(sizeof(struct data)); 
```

我收到此错误

错误：typedef "data" 不能用在详细的类型说明符中

另外，当内存中没有任何内容驻留在主机内存中时，我怀疑分配一块大小*数据的内存*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:09:28.567

正如评论中提到的，标题中描述的原始错误与推力无关，而是由于使用`struct data`, when`data`已经被 typedef 了。

在回答评论中提出的其他问题时，我只是想说我没有充分考虑`thrust::device_vector<>`在结构中使用的后果。当我说也许考虑`thrust::device_ptr<>`改用时，我想到了这样的东西，这似乎对我有用：

```
#include <stdio.h>
#include <thrust/host_vector.h>
#include <thrust/device_vector.h>
#include <thrust/device_ptr.h>
#include <thrust/sequence.h>
#include <thrust/transform.h>
#include <thrust/functional.h>

#define N 10

typedef struct {
  thrust::device_ptr<float> dp1;
  thrust::device_ptr<float> dp2;
  int i;
} data;

int main(){

  thrust::negate<int> op;

  data *mydata = (data *)malloc(sizeof(data));
  thrust::host_vector<float> h1(N);
  thrust::sequence(h1.begin(), h1.end());
  thrust::device_vector<float> d1=h1;
  mydata->dp1=d1.data();
  mydata->dp1[0]=mydata->dp1[N-1];

  thrust::transform(mydata->dp1, mydata->dp1 + N, mydata->dp1, op); // in-place transformation

  thrust::copy(d1.begin(), d1.end(), h1.begin());
  for (int i=0; i<N; i++)
    printf("h1[%d] = %f\n", i, h1[i]);

  return 0;
} 
```

话虽如此，在结构内部使用的原始方法`device_vector`可能有效，我只是不知道，也没有探索过。

# php - 从查询数组中获取第一个元素

> ID：14987084
> 
> 赞同：0
> 
> 时间：2013-02-20T18:17:44.343
> 
> 标签：php, mysql, parameter-passing

```
 $post= ('SELECT * FROM posts WHERE id = :id LIMIT 1 ', array('id' => $_GET['id']),$conn);
$view_path = 'views/single.view.php';
require'views/layout.php'; 
```

我知道 $post 变量是一个数组，如果我 print_r 在我的 single.view.php?id=1

我可以在下面得到结果。

```
Array
(
    [0] => Array
        (
            [id] => 1
            [0] => 1
            [title] =>  title of
            [1] => first post
            [body] =>  body of first  post
            [2] =>  body of first  post
        )

) 
```

如果我写，那么在 single.view.php

```
echo $post**[0]**['title']; 
```

我可以得到标题。

但是，当我通过编写在我的 single.php 上尝试这个时

```
$post= ('SELECT * FROM posts WHERE id = :id LIMIT 1 ', array('id' => $_GET['id']),$conn)**[0]**; 
```

我明白了

```
Parse error: parse error in /Library/WebServer/www/single.php on line 10 
```

在我看来，**这不是一个数组，你不能得到它的第一个元素。**.

所以我的问题是如何在我的 $post 变量中获取第一个元素。而不是将值发送到 single.view.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:19:34.767

你不能在 PHP < 5.4 的版本中访问这样的数组。你必须走很长的路。

[https://wiki.php.net/rfc/functionarraydereferencing](https://wiki.php.net/rfc/functionarraydereferencing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:21:23.597

在 PHP 5.4 之前，您不能直接从函数中检索数组元素：

```
$val = myArray($params)[0]; // wrong 
```

但是，您可以这样做：

```
$arr = myArray($params);
$val = $arr[0]; 
```

或者

```
$val = current(myArray($params)); 
```

[current() 参考](http://php.net/manual/en/function.current.php)

# mysql - 具有大量连接的 Mysql 慢查询

> ID：14987093
> 
> 赞同：1
> 
> 时间：2013-02-20T18:18:23.410
> 
> 标签：mysql

我已经在相当小的表上运行了查询（每个表最多 4000 行）。查询持续约 4 秒，包含多个连接，但是，所有连接都使用索引。

这是查询：

```
SELECT count(DISTINCT p0_.id) AS sclr0 
FROM promoter p0_ 
LEFT JOIN user u1_ ON p0_.user_id = u1_.id 
LEFT JOIN profile p2_ ON p0_.id = p2_.promoter_id 
LEFT JOIN promoter_city p4_ ON p0_.id = p4_.user_id 
LEFT JOIN city c3_ ON c3_.id = p4_.city_id 
LEFT JOIN promoter_language p6_ ON p0_.id = p6_.user_id 
LEFT JOIN language l5_ ON l5_.id = p6_.language_id 
LEFT JOIN promoter_worker_type p8_ ON p0_.id = p8_.promoter_id 
LEFT JOIN worker_type w7_ ON w7_.id = p8_.workertype_id 
LEFT JOIN practise p9_ ON p0_.id = p9_.promoter_id 
LEFT JOIN contract c11_ ON p0_.id = c11_.promoter_id 
```

这是解释的输出：

```
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        id        |   select_type    |      table       |       type       |  possible_keys   |       key        |     key_len      |       ref        |       rows       |      Extra       |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       p0_        |      index       |                  |UNIQ_BCB929A3A76ED|        5         |                  |       4161       |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       u1_        |      eq_ref      |     PRIMARY      |     PRIMARY      |        4         |promoteri.p0_.user|        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       p2_        |       ref        |type,IDX_8157AA0F4|       type       |        5         | promoteri.p0_.id |        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       p4_        |       ref        |PRIMARY,IDX_183C53|     PRIMARY      |        4         | promoteri.p0_.id |        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       c3_        |      eq_ref      |     PRIMARY      |     PRIMARY      |        4         |promoteri.p4_.city|        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       p6_        |       ref        |PRIMARY,IDX_19EE2A|     PRIMARY      |        4         | promoteri.p0_.id |        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       l5_        |      eq_ref      |     PRIMARY      |     PRIMARY      |        4         |promoteri.p6_.lang|        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       p8_        |       ref        |PRIMARY,IDX_37AC17|     PRIMARY      |        4         | promoteri.p0_.id |        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       w7_        |      eq_ref      |     PRIMARY      |     PRIMARY      |        4         |promoteri.p8_.work|        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       p9_        |       ref        |IDX_352E261F4B84B2|IDX_352E261F4B84B2|        5         | promoteri.p0_.id |        1         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+
|        1         |      SIMPLE      |       c11_       |       ref        |IDX_E98F28594B84B2|IDX_E98F28594B84B2|        5         | promoteri.p0_.id |        6         |   Using index    |
+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+------------------+ 
```

我知道，在这个查询中加入是不必要的，但是我使用了很多类似的查询，这些查询应用了一些 where 语句，这些连接在哪里真的很重要。

有什么解释，为什么这个查询需要这么长时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T21:17:49.560

尝试将所有这些更改`left joins`为`inner joins`. 当您使用 时`left join`，您会强制优化器按照您提供的顺序连接表……当您使用 时`inner join`，优化器可以选择更好的起始位置来连接表。

至于`left join`强制特定读取顺序的参考 - 来自[MySQL Docs](https://dev.mysql.com/doc/refman/5.0/en/left-join-optimization.html)：

> `LEFT JOIN`由连接优化器强制或`STRAIGHT_JOIN`帮助连接优化器更快地完成其工作的表读取顺序，因为要检查的表排列更少。

... 表示`left join`强制读取顺序与`STRAIGHT_JOIN`.

# python - mac上的python乌龟不工作

> ID：14987099
> 
> 赞同：2
> 
> 时间：2013-02-20T18:18:46.380
> 
> 标签：python, macos, turtle-graphics

我正在尝试使用海龟的 python 导入，但出现错误：

```
Traceback (most recent call last):
  File "turtle.py", line 1, in <module>
    import turtle
  File "/turtle.py", line 32, in <module>
    turtle.pensize(2)
AttributeError: 'module' object has no attribute 'pensize' 
```

python 是自带turtle 还是需要单独下载？

我的python是2.7.2

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T18:29:10.647

你调用了你的文件`turtle.py`，所以`import turtle`导入你的程序，而不是你想要的模块。

重命名您的程序并删除所有`turtle.py[co]`文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T09:02:27.240

使用turtle.py 导致了这里的问题。废弃它并改用它

```
import turtle
turtlename = turtle.Turtle()
wn = turtle.Screen() 
```

完成此操作后，请使用基本的海龟命令，例如

```
turtlename.forward(90) 
```

# c# - 带有内部表达式的 OrderBy linq 表达式

> ID：14987101
> 
> 赞同：3
> 
> 时间：2013-02-20T18:18:52.847
> 
> 标签：c#, linq, lambda

我有以下排序表达式：

```
this.Students = this.Students.OrderBy(x => x.ExamData.OrderByDescending(p => p.ExamDate).ThenByDescending(p => p.ExamId).FirstOrDefault().TotalMarks); 
```

虽然我的想法是将表达式抽象为

```
x => x.ExamData.OrderByDescending(p => p.ExamDate).ThenByDescending(
                                  p => p.ExamId).FirstOrDefault().TotalMarks 
```

制作为 lambda 表达式，以便我可以使用 like

```
this.Students = this.Students.OrderBy(sortExpression); 
```

这是因为我有很多排序字段，例如上面定义的 TotalMarks，我只想从排序字段创建表达式，然后调用 OrderBy。

我从这个[链接](https://stackoverflow.com/questions/11474643/building-an-orderby-lambda-expression-based-on-child-entitys-property)知道，我们可以创建一个使用子属性的表达式，但不能使用内部表达式。

目前我已经给出了一个开关盒并在每种情况下都写了相同的东西，比如

```
this.Students = this.Students.OrderBy(x => x.ExamData.OrderByDescending(p => p.ExamDate).ThenByDescending(p => p.ExamId).FirstOrDefault().SubjectName); 
```

所以我的想法是使用静态方法创建 kindof ExpressionBuilder，该方法构建传递 fieldName 的表达式，例如

```
public static Expression BuildSortExpression(string fieldName) {} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:29:16.453

您可以轻松地将大部分逻辑提取到方法中：

```
private int sortExpression(Student x) { 
    return x.ExamData.OrderByDescending(p => p.ExamDate).ThenByDescending(p => p.ExamId).FirstOrDefault().TotalMarks;
} 
```

假设`TotalMarks`是一个`int`.

然后你只需要使用：

```
this.Students.OrderBy(x => sortExpression(x)); 
```

或将其添加为 Student 的属性。

警告：如果您将它与 ORM（linq to SQL、实体框架等）一起使用，它的执行效率将不如前面的代码！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:33:05.447

尝试创建一个可重用的表达式变量最终将比仅仅创建自己的扩展方法来完成整个排序需要更多的工作：

```
public static IQueryable<Student> OrderByMarks(this IQueryable<Student> students)
{
    return students.OrderBy(student => student.ExamData
        .OrderByDescending(exam => exam.ExamDate)
        .ThenBy(exam => exam.ExamId)
        .FirstOrDefault().TotalMarks);
} 
```

然后你可以像这样使用它：

```
this.Students = this.Students.OrderByMarks(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-20T21:11:55.943

使用 Ben 的想法得到了解决方案。创建了一个

```
Dictionary<string, Func<Student, Object>> 
```

以排序字段为键，函数为

```
new Func<Student, object>((Student student) => { return GetLatestExam(student).TotalMarks; }) 
```

而 GetLatestExam 静态方法为

```
private static Study GetLatestExam(Student student)
{
     return student.ExamData.OrderByDescending(p => p.ExamDate).ThenByDescending(p => p.ExamId).FirstOrDefault();
} 
```

然后在实际排序中，我只需要这样调用：

```
public void Sort(string sortField, bool sortAscending)
{
     // based on the sort field, get the sorting expression and execute.
     if(sortAscending)
     {
          this.Students= this.Students.OrderBy(student=>this._customSortColumns[sortField](student));
     }
     else
     {
          this.Patients = this.Patients.OrderByDescending(student=>this._customSortColumns[sortField](student));
     }
} 
```

# python - 从 python-2.5 升级到 2.7 时带有 HTTPS 回归的 urllib2.ProxyHandler

> ID：14987106
> 
> 赞同：2
> 
> 时间：2013-02-20T18:19:13.270
> 
> 标签：python, https, proxy, python-2.7, urllib2

从 python-2.5 升级到 python-2.7 时，以下代码被破坏：

```
>>> import urllib
>>> import urllib2
>>> from django.conf import settings

>>> settings.AUTH_URL
'https://auth.example.net/auth/'
>>> settings.HTTP_PROXY
{'http': 'http://proxy.example.net', 'https': 'https://proxy.example.net'}
>>> cred = urllib.urlencode({'username': 'someuser', 'password': 'somepasswd'})

>>> urllib2.urlopen(settings.AUTH_URL, data=cred).read()
'<?xml version="1.0" encoding="UTF-8"?><auth><username value="someuser">true</username><password>true</password></auth>'

>>> urllib2.build_opener().open(settings.AUTH_URL, data=cred).read()
'<?xml version="1.0" encoding="UTF-8"?><auth><username value="someuser">true</username><password>true</password></auth>'

>>> urllib2.build_opener(urllib2.ProxyHandler(settings.HTTP_PROXY)).open(settings.AUTH_URL, data=cred).read()
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/usr/lib/python2.7/urllib2.py", line 394, in open
    response = self._open(req, data)
  File "/usr/lib/python2.7/urllib2.py", line 412, in _open
    '_open', req)
  File "/usr/lib/python2.7/urllib2.py", line 372, in _call_chain
    result = func(*args)
  File "/usr/lib/python2.7/urllib2.py", line 1207, in https_open
    return self.do_open(httplib.HTTPSConnection, req)
  File "/usr/lib/python2.7/urllib2.py", line 1174, in do_open
    raise URLError(err)
URLError: <urlopen error [Errno 111] Connection refused>

>>> opener = urllib2.build_opener(urllib2.ProxyHandler(settings.HTTP_PROXY))
>>> opener
<urllib2.OpenerDirector instance at 0x1bc39d40>
>>> opener.__dict__
{'addheaders': [('User-agent', 'Python-urllib/2.7')],
 'handle_error': {'http': {301: [<urllib2.HTTPRedirectHandler instance at 0x1bc3f7a0>],
                       302: [<urllib2.HTTPRedirectHandler instance at 0x1bc3f7a0>],
                       303: [<urllib2.HTTPRedirectHandler instance at 0x1bc3f7a0>],
                       307: [<urllib2.HTTPRedirectHandler instance at 0x1bc3f7a0>],
                       'default': [<urllib2.HTTPDefaultErrorHandler instance at 0x1bc3f7e8>]}},
 'handle_open': {'file': [<urllib2.FileHandler instance at 0x1bc43098>],
             'ftp': [<urllib2.FTPHandler instance at 0x1bc3ffc8>],
             'http': [<urllib2.ProxyHandler instance at 0x1bfa0638>,
                      <urllib2.HTTPHandler instance at 0x1bc3f758>],
             'https': [<urllib2.ProxyHandler instance at 0x1bfa0638>,
                       <urllib2.HTTPSHandler instance at 0x1bc43200>],
             'unknown': [<urllib2.UnknownHandler instance at 0x1bc3f830>]},
 'handlers': [<urllib2.ProxyHandler instance at 0x1bfa0638>,
          <urllib2.UnknownHandler instance at 0x1bc3f830>,
          <urllib2.HTTPHandler instance at 0x1bc3f758>,
          <urllib2.HTTPDefaultErrorHandler instance at 0x1bc3f7e8>,
          <urllib2.HTTPRedirectHandler instance at 0x1bc3f7a0>,
          <urllib2.FTPHandler instance at 0x1bc3ffc8>,
          <urllib2.FileHandler instance at 0x1bc43098>,
          <urllib2.HTTPSHandler instance at 0x1bc43200>,
          <urllib2.HTTPErrorProcessor instance at 0x1bc43128>],
 'process_request': {'http': [<urllib2.HTTPHandler instance at 0x1bc3f758>],
                 'https': [<urllib2.HTTPSHandler instance at 0x1bc43200>]},
 'process_response': {'http': [<urllib2.HTTPErrorProcessor instance at 0x1bc43128>],
                  'https': [<urllib2.HTTPErrorProcessor instance at 0x1bc43128>]}}
>>> sock = opener.open(settings.AUTH_URL, data=cred)
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/usr/lib/python2.7/urllib2.py", line 394, in open
    response = self._open(req, data)
  File "/usr/lib/python2.7/urllib2.py", line 412, in _open
    '_open', req)
  File "/usr/lib/python2.7/urllib2.py", line 372, in _call_chain
    result = func(*args)
  File "/usr/lib/python2.7/urllib2.py", line 1207, in https_open
    return self.do_open(httplib.HTTPSConnection, req)
  File "/usr/lib/python2.7/urllib2.py", line 1174, in do_open
    raise URLError(err)
URLError: <urlopen error [Errno 111] Connection refused> 
```

最后一个表达式仍然适用于 python-2.5，但不适用于具有相同代理和 url 设置的同一物理机器上的 2.7。知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T20:07:17.797

通过从 settings.HTTP_PROXY 中删除“https”键来解决，但不知道为什么。URL 仍然是 HTTPS。

# java - eclipse 删除 -javaagent 作为 vm 参数

> ID：14987107
> 
> 赞同：3
> 
> 时间：2013-02-20T18:19:24.577
> 
> 标签：java, eclipse, spring, javaagents, google-plugin-eclipse

我想在 Eclipse 中编辑 Spring 项目的 vm 参数。默认的 vm 参数是：

```
-XX:MaxPermSize=256m -Xmx512m 
```

然后我想像这样添加一个javaagent arg：

```
-XX:MaxPermSize=256m -Xmx512m -javaagent:${settings.localRepository}\org\springframework\spring-instrument\${org.springframework.version}\spring-instrument-${org.springframework.version}.jar 
```

我添加了必要的变量。我单击应用（一切都还可以），然后单击确定，这将关闭对话框。但是当我重新打开相同的运行配置时，-javaagent arg 已经消失了......以及旧的配置

```
-XX:MaxPermSize=256m -Xmx512m 
```

回来了。谁能解释我发生了什么事？我正在使用带有一些 maven 和 spring 插件的 Eclipse 版本：4.2.1，并且配置用于 GWT 项目。

GWT 版本：2.5

谷歌插件版本：3.1.3

Eclipse 版本：4.2.1

也许降级其中之一可能会有所帮助，有什么想法吗？

# android - 如果按下后退按钮，android singleinstance 活动不是单一的

> ID：14987110
> 
> 赞同：8
> 
> 时间：2013-02-20T18:19:34.860
> 
> 标签：android, android-activity, single-instance, launchmode

我遇到了一个有趣的问题，一个 Activity 被创建了多次，即使它在 manifest 中定义为一个 singleTask 或一个 singleInstance Activity。这是如何复制的。说，在主要活动中：

```
@Override
protected void onResume() {
    Intent i = new Intent(MainActivity.class, SingleActivity.class);
    startActivity(i);
} 
```

在我的 SingleActivity 中，我有：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    ...
    Log.i("SingleActivity", "onCreate " + System.identityHashCode(this));
    ...
} 
```

在清单中，我有：

```
 <activity android:name=".SingleActivity"
              android:launchMode="singleInstance"
    /> 
```

现在，如果我启动应用程序，一切似乎都还好，在一种情况下可以预期：如果我`SingleActivity`在前面按下“后退”按钮，它会导航回`MainActivity`，`MainActivity.onResume()`将在其中创建另一个`SingleActivity`实例，而不是把已经存在的那个. 这是我知道的，因为在日志上显示了不同的身份哈希码。

如果启动模式是 singleTask，似乎也是如此。

唯一的解决方法似乎是 override `onBackPressed()`，但这似乎是一个丑陋的解决方案。

我想知道我做错了什么

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-20T22:42:51.697

这是一个问题`taskAffinity`。因为您没有在您的或您`taskAffinity`的清单中指定，所以这两个活动具有相同的（默认）。当您启动一个活动时，Android 会检查您要启动的活动。如果它与您的任务中的根 Activity 相同，那么它将**忽略****或**（因为这些启动模式需要 Android 创建一个新任务来启动该 Activity）并在当前任务中启动该 Activity。`MainActivity``SingleActivity``taskAffinity``taskAffinity``taskAffinity`**`launchMode="singleInstance"``launchMode="singleTask"`**

不幸的是，这没有很好的记录，但`taskAffinity`优先于`launchMode`.

如果你真的想要一个`singleTask`or`singleInstance`活动（这通常不是正确的做法，因为它会带来一大堆其他令人讨厌的事情，你可能会出错），那么你需要确保你的`singleInstance`or`singleTask`活动具有在清单中的`<activity>`定义中如下：

```
android:taskAffinity="" 
```

如果您需要更多信息，请在 StackOverflow 或 Google 中搜索“launchmode taskaffinity”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-20T18:23:03.470

默认情况下，按下 BACK 键会结束（销毁）当前活动并向用户显示上一个活动。

所以，这是不可能的

> 而不是提出已经存在的

因为不存在活动。

# java - 使用 GCM 服务在 2 个应用程序之间进行通信

> ID：14987115
> 
> 赞同：0
> 
> 时间：2013-02-20T18:19:53.313
> 
> 标签：java, google-cloud-messaging

我正在尝试创建 2 个通过 GCM 服务进行通信的应用程序。假设我正在尝试将字符串从应用程序 A 发送到 B，然后从 B 发送到 A。

我对 GCM 服务非常陌生，我有点困惑。每次看到 myApiCode 时，我都会将原始代码中的它替换为 api 代码。这是 A 代码：

```
public class MainActivity extends Activity 
{
    private final String myApiKey = "903137756997";
    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        GCMRegistrar.checkDevice(this);
        GCMRegistrar.checkManifest(this);
        final String regId = GCMRegistrar.getRegistrationId(this);
        if (regId.equals("")) {
          GCMRegistrar.register(this, "myApiCode");
        } else {
          Log.v("INFORMATION", "Already registered");
        }

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

这里是 GCMIntentService：

```
public class GCMIntentService extends GCMBaseIntentService
{
    private final String myApiKey = "903137756997";

    public GCMIntentService()
    {
        super("123");
    }
            ...
    @Override
    protected void onMessage(Context arg0, Intent arg1) 
    {
        Log.d("GCM", "RECIEVED A MESSAGE");
        System.out.println("123123123123");
    }
            ...

} 
```

我附加的代码是应用程序 A，现在我将附加应用程序 B 的代码：

以下代码是从主活动调用的服务：

```
public void onCreate()
{
    super.onCreate();

    Sender sender = new Sender(myApiKey);
    Message message = new Message.Builder().build();
    Result result = null;
    try {
        result = sender.send(message, "123", 5);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    if (result.getMessageId() != null) {
         String canonicalRegId = result.getCanonicalRegistrationId();
         if (canonicalRegId != null) {
           // same device has more than on registration ID: update database
         }
        } else {
         String error = result.getErrorCodeName();
         if (error.equals(Constants.ERROR_NOT_REGISTERED)) {
           // application has been removed from device - unregister database
         }
        }
} 
```

我不得不提一下，这两个应用程序都在毫无例外地运行，但看起来什么都没有发生。我想我的键做错了，因为我仍然无法理解应用程序 B 将如何找到应用程序 A。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T09:16:19.047

您必须覆盖 GCMIntentService 中的 onRegistered 方法。这将在 GCM 服务器返回您调用 GCMRegistrar.register 时提示的注册 ID 时调用。

此方法的实现应将 String 参数上传到您控制的服务器，然后服务器可以发送针对您上传的 ID 的消息。

此外，您不应该以这种方式直接在应用程序之间推送消息，因为它需要您将私有 API 密钥发送到应用程序包中才能发送消息。

# c++ - 如何使我的异常处理机制恢复正常？

> ID：14987116
> 
> 赞同：2
> 
> 时间：2013-02-20T18:19:57.200
> 
> 标签：c++

```
#include <iostream>
#include <vector>

typedef std::vector<int> vector_int;
//My pop exception class!
class cPopOnEnpty{};
//My push exception class!
class cPushOnFull{};

class cStack
{
private:
    vector_int v;
    int m_top, m_cap;
public:
    cStack(int capacity):m_top(0),m_cap(capacity){}
    void pop()
    {
        if(m_top==0)
            throw cPopOnEnpty();
        v.erase(v.begin()+m_top);
        m_top--;
    }
    void push(int const& i)
    {
        if(m_top==m_cap)
            throw cPushOnFull();
        v.push_back(i); m_top++;
    }
};

int main(int argc, char **argv)
{
    cStack c(3);
    try {
        c.pop(); //m_top = 0 So exception should be thrown!
        c.push(2); //m_top = 1
        c.push(10); //m_top =2
        c.push(3);  //m_top =3
        c.push(19); //m_top = 4 Exception should be thrown here!
    }
    catch (cPopOnEnpty&)
    {
        std::cerr<< "Caught: Stack empty!"<<std::endl;
    }
    catch(cPushOnFull&)
    {
        std::cerr<<"Caught: Stack full!"<<std::endl;
    }
    return 0;
} 
```

O/P - 捕获：堆栈为空！

所需的 O/P - 捕获：堆栈为空！抓到：堆满了！

在上面的代码中，我正在处理空向量上的弹出和满（容量受我限制）向量的推送。在这些情况下，当控件到达 main 末尾并且程序退出时，我没有得到我想要的 o/p。我怎样才能使这个恢复，以便在处理一个呼叫的异常后转到下一个呼叫？

`c.pop()`这里应该执行下一个语句。需要帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:22:11.193

为每个方法调用编写一个 Try/Catch 块。

```
try
{
    c.pop(); //m_top = 0 So exception should be thrown!
}
catch(cPopOnEnpty&)
{
    std::cerr<< "Caught: Stack empty!"<<std::endl;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:27:44.703

C++ 不允许在异常后恢复，因为堆栈已经被展开（不像 Lisp 的条件是完全不同的野兽）。

您将不得不以其他方式构建您的代码，例如@RobertHarvey 建议的那样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:40:06.163

```
try {
        c.pop(); //m_top = 0 So exception should be thrown!
    }
    catch (cPopOnEnpty&)
        {
            std::cerr<< "Caught: Stack empty!"<<std::endl;
        }
    try{
        c.push(2); //m_top = 1
        c.push(10); //m_top =2
        c.push(3);  //m_top =3
        c.push(19); //m_top = 4 Exception should be thrown here!
    }
    catch(cPushOnFull&)
    {
        std::cerr<<"Caught: Stack full!"<<std::endl;
    } 
```

问题解决了！谢谢你们！:D

# c++ - 如何使用 ctags 获取 C++ 类实例？

> ID：14987122
> 
> 赞同：1
> 
> 时间：2013-02-20T18:20:14.627
> 
> 标签：c++, ctags, exuberant-ctags

例如，我定义了一个这样的 C++ 类：

```
class cat : public animal
{
  public:
    cat(const char* nameString) : m_name(nameString) {}
    ~cat(){}
    const char* getName() {return m_name.c_str();}

 private:
    std::string m_name;
}; 
```

之后：

```
cat kitty("Garfield");
printf("%s", kitty.getName()); 
```

对于上面的示例代码，[ctags](http://ctags.sourceforge.net/)可以告诉我继承、成员、方法、访问类型（公共、私有）等。

但是我怎样才能知道 kitty 是 cat 的一个实例呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:32:54.717

```
std::cout << "kitty is a: " << typeid(kitty).name() << '\n'; 
```

但是，如您[所见](http://en.cppreference.com/w/cpp/types/type_info/name)，可能并不完全是您想要的。

> 返回包含类型名称的实现定义的以空字符结尾的字符串。不提供任何保证，特别是，返回的字符串对于多种类型可以是相同的，并且在同一程序的调用之间会发生变化。

您可以[将](http://en.cppreference.com/w/cpp/types/type_info/operator_cmp)与`typeid`其他已知类型进行比较，例如`cat`.

您可以按照与对象名称相同的方向/样式进行制作，并在以下内容中包含一个虚函数`Animal`：

```
virtual string whatAnimal()const{return "animal";} 
```

在派生类中：

```
string whatAnimal()const override {return "cat";} 
```

现在您可以完全控制每种类型的字符串，与您在代码中使用的名称约定无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:35:28.883

可以使用 typeid 获取对象的类名。但是，编译器会修改名称，因此您应该在运行时适当地对其进行解组。

一个例子：

```
#include <iostream>
#include <cxxabi.h>

class cls {};

void main(){
    cls obj;
    int status;
    char * demangled_name = abi::__cxa_demangle(typeid(obj).name(),0,0,&status);
    std::cout << demangled_name << std::endl;
    free(demangled_name);
    return;
} 
```

将输出：

```
 cls 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T20:25:38.797

可以通过以下方式直接回答您如何检查 kitty 是否为 cat 实例的问题：

```
if(typeid(cat) == typeid(kitty))
    // do something if kitty is a cat 
```

注意，`typeid(YourClass).name()`返回`nYourClass`，其中 n 是类名的长度。

# git-pull - Git 扩展不再在拉取时自动合并

> ID：14987123
> 
> 赞同：0
> 
> 时间：2013-02-20T18:20:23.223
> 
> 标签：git-pull, git-extensions

[这与GIT 扩展上的 Manual Merge Only](https://stackoverflow.com/questions/11478365/manual-merge-only-on-git-extensions)本质上是相反的问题。

Git 扩展用于在每次拉取时自动为我合并。由于某种原因现在它没有，我必须使用 Git Bash 手动拉到那里（在那种情况下它会自动合并）。

这是怎么回事？我在 repo 中没有看到 .gitattributes 文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T12:15:25.273

在 Pull 对话框中，有三个单选按钮用于设置合并选项。你检查过它们吗？一旦我不小心将它设置为`Do not merge`，也许这也是你的问题。

# counter - 纹波计数器的未定义结果

> ID：14987124
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:20:28.787
> 
> 标签：counter, verilog, hdl

我正在使用 d 触发器为 Ripple 计数器编写测试台。我的程序编译没有错误，但是，我得到了`undefined`结果。我怎么解决这个问题？

这是代码：

```
module RCounter;

reg d,d2,d3,d4,clk;
wire q,q2,q3,q4;

DFlipFlop a(d,q,clk);
DFlipFlop a1(d2,q2,q);
DFlipFlop a2(d3,q3,q2);
DFlipFlop a3(d4,q4,q3);

initial

begin

clk =1;

d=0;d2=0;d3=0;d4=0;

#2 d=1;d2=~q2; d3=~q3; d4=~q4;
#2 d=0;d2=~q2; d3=~q3; d4=~q4;
#2 d=1;d2=~q2; d3=~q3; d4=~q4;
#2 d=0;d2=~q2; d3=~q3; d4=~q4;
#2 d=1;d2=~q2; d3=~q3; d4=~q4;
#2 d=0;d2=~q2; d3=~q3; d4=~q4;
#2 d=1;d2=~q2; d3=~q3; d4=~q4;

end

always 
begin

#2 assign clk = ~ clk;

end

endmodule 
```

我做错了什么，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:43:52.600

您所拥有的不是纹波计数器，而且您似乎并不真正了解测试台和 DUT 之间的边界（被测设计，或者在您的情况下是“纹波计数器”）。

您所拥有的是一个模拟四个独立触发器的测试平台。如果您正在模拟波纹计数器，您应该有一个名为“RCounter”之类的模块，该模块在其他名为“RCounter_TB”的东西中实例化。测试台应该只驱动输入（用于计数器、时钟和复位），它不应该驱动各个触发器的 d 引脚，因为这些触发器之间的连接是您想要测试的。

在纹波计数器模块内，您可以定义触发器之间的有线连接。这个模块内部不应该有任何`#`时间延迟，因为一个模块没有固定时间延迟的概念。如果您希望 d2 引脚从 ~q2 驱动，那么您只需将其分配为：

`assign d2 = ~q2`

因为在硬件中，这只是一条从~q2 的输出返回到 d2 的线路。它一直存在，没有时间的概念。

至于为什么你的输出会出现 X，我猜它来自你在上一个问题中发布的触发器设计。

```
module DFlipFlop(d,q,clk);

input d,clk;
output q;

assign q = clk?( (d==1)? 1:0) : q;

endmodule 
```

这不是触发器，因为这里没有状态保留，它只是一个带有无限反馈循环的分配语句，（你基本上只有一个线驱动本身）。

如果要对触发器建模，则需要使用`always @(posedge clk)`块来暗示您想要一些状态保留。我将留给您查找如何使用 always 块来建模触发器。

# google-chrome - 标签不起作用 Chrome 打包扩展

> ID：14987126
> 
> 赞同：3
> 
> 时间：2013-02-20T18:20:31.117
> 
> 标签：google-chrome, webview

有人对在 Chrome 打包应用中工作有什么建议吗？我已经按照教程中的所有内容进行操作，并且我的 webview 没有加载 URL，但容器会显示出来。我故意使用了可怕的颜色，所以我可以看到框架（提前抱歉）

Manifest.JSON - [http://pastebin.com/dkDx3qUr](http://pastebin.com/dkDx3qUr) Window.html - [http://pastebin.com/RBQZ5MNG](http://pastebin.com/RBQZ5MNG)

你能给的任何建议都会很棒！

谷歌浏览器版本 4.0.1312.57 m

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:47:55.823

可悲的是，您的 pastebin 已过时，但我想问题是您的打包应用程序是旧版打包应用程序。

要解决此问题，请将其转换为：

```
"app": {
  "launch": {
    "local_path": "browser.html"
  }
}, 
```

对此：

```
"app": {
  "background": {
  "scripts": ["main.js"]
  }
}, 
```

main.js 应该包含这个：

```
chrome.app.runtime.onLaunched.addListener(runApp);
chrome.app.runtime.onRestarted.addListener(runApp);

function runApp() {
  window.open("browser.html");
}; 
```

# php - 在 PHP 中合并和组合数组

> ID：14987132
> 
> 赞同：0
> 
> 时间：2013-02-20T18:20:44.080
> 
> 标签：php

我有多个关联数组，类似于以下内容：

```
$arr1 = array(0 => 12, 5 => 10, 19 => 48);
$arr2 = array(0 => 14, 7 => 9, 12 => 11, 19 => 30); 
```

我想合并这些数组，以便我有一组键（0、5、7、12、19），每个键都指向一个包含原始数组值的数组，`null`如果该值不存在于原始数组：

```
$merge = array(
    0 => array(12, 14),
    5 => array(10, null),
    7 => array(null, 9),
    12 => array(null, 11),
    19 => array(48, 30)
); 
```

我需要能够为任意数量的数组执行此操作。我不知道从哪里开始。

我想，我可以遍历每个数组，将它的值附加到结果中 - 但在将当前值附加到该索引之前，我必须检查每个结果数组中是否有必要数量的元素 - 这是效率不是很高。

想法或指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:36:11.467

编辑

```
<?php
$arr1 = array(0 => 12, 5 => 10, 19 => 48);
$arr2 = array(0 => 14, 7 => 9, 12 => 11, 19 => 30);

foreach($arr1 as $k => $v){
 if(array_key_exists($k, $arr2)){
   $newarr[$k][] = $v;
   $newarr[$k][] = $arr2[$k];
 }else{
   $newarr[$k][] = $v;
   $newarr[$k][] = 'NULL';
 }
}

foreach($arr2 as $k => $v){
 if(!array_key_exists($k, $arr1)){
   $newarr[$k][] = 'NULL';
   $newarr[$k][] = $v;
 }
}

ksort($newarr);

echo '<pre>';
print_r($newarr);
?> 
```

输出：

```
 Array
(
    [0] => Array
        (
            [0] => 12
            [1] => 14
        )

    [5] => Array
        (
            [0] => 10
            [1] => NULL
        )

    [7] => Array
        (
            [0] => NULL
            [1] => 9
        )

    [12] => Array
        (
            [0] => NULL
            [1] => 11
        )

    [19] => Array
        (
            [0] => 48
            [1] => 30
        )

) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:59:15.113

我想这就是你要找的。

```
/*Merge function*/
function merge($a1, $a2)
{
    foreach($a1 as $key => $val)
        $a1[$key] = Array($a1[$key], null);
    foreach($a2 as $key => $val)
        $a1[$key] = Array((isset($a1[$key]))? $a1[$key][0]: null, $val);
    return ksort($a1);
}

/*Test*/
$arr1 = array(0 => 12, 5 => 10, 19 => 48);
$arr2 = array(0 => 14, 7 => 9, 12 => 11, 19 => 30);

foreach(merge($arr1, $arr2) as $key => $val){
    echo "<br />$key --";
    print_r($val);
}
/*output*/
0 --Array ( [0] => 12 [1] => 14 )
5 --Array ( [0] => 10 [1] => )
7 --Array ( [0] => [1] => 9 )
12 --Array ( [0] => [1] => 11 ) 
19 --Array ( [0] => 48 [1] => 30 ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T19:05:15.800

```
 $arr1 = array(0 => 12, 5 => 10, 19 => 48);
    $arr2 = array(0 => 14, 7 => 9, 12 => 11, 19 => 30);

    $keys = array_merge(array_keys($arr1), array_keys($arr2));
    $merged = array();
    foreach ($keys as $key) {
        $merged[$key] = array(); 
        $merged[$key][] = isset($arr1[$key]) ? $arr1[$key] : null;
        $merged[$key][] = isset($arr2[$key]) ? $arr2[$key] : null;            
    }
    ksort($merged);
    echo '<pre>', var_dump($merged), '</pre>'; 
```

针对任意数量的数组进行了修改

```
 $arrays = array(
        array(0 => 12, 5 => 10, 19 => 48),
        array(0 => 14, 7 => 9, 12 => 11, 19 => 30),
        // ... more arrays
    );

    $keys = array();
    foreach ($arrays as $arr) {
        $keys = array_merge($keys, array_keys($arr));
    }

    $merged = array();
    foreach ($keys as $key) {
        $merged[$key] = array();
        foreach ($arrays as $arr) {
            $merged[$key][] = isset($arr[$key]) ? $arr[$key] : null;
        }         
    }
    ksort($merged);
    echo '<pre>', var_dump($merged), '</pre>'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T18:41:23.947

试试这个功能：

```
 function multimerge ($array1, $array2) {
      if (is_array($array2) && count($array2)) {
         foreach ($array2 as $k => $v) {
            if (is_array($v) && count($v)) {
                $array1[$k] = multimerge($array1[$k], $v);
            } else {
                $array1[$k] = $v;
            }
         }
       } else {
          $array1 = $array2;
       }

       return $array1;
   } 
```

[http://php.net/manual/en/function.array-merge.php](http://php.net/manual/en/function.array-merge.php)

# magento - Magento 按特定类别（或 .phtml 格式）而不是全局设置“显示所有”产品

> ID：14987136
> 
> 赞同：0
> 
> 时间：2013-02-20T18:20:57.500
> 
> 标签：magento, magento-1.7

我知道管理面板中的设置，用于在类别列表页面上显示的默认产品数量。这似乎是整个商店的全局设置。我正在寻找一种在每个类别的基础上进行设置的方法（例如，大多数类别默认为每页 25 个产品，但一个特定类别默认显示第一页上的所有产品）。理想情况下，如果可能，这将在 admin 或 .phtml 文件中完成。如何为特定类别设置每页的默认产品？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:39:48.127

在管理面板

转到 -> CMS -> 页面 -> 主页

单击左侧的“内容”选项卡

单击右侧的“显示/隐藏编辑器”按钮

复制 - 粘贴此代码：

```
{{block type="catalog/product_list"  category_id="2" template="catalog/product/list.phtml"}} 
```

提供所需类别的类别 ID

要检查任何类别的 Category_id 转到：目录菜单 -> 管理类别

点击category，右侧的TITLE会显示有点像：

“类别名称（ID：5）”

问候。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T06:47:58.863

进去看看

设计/包装/主题/目录/产品/列表/工具栏.phtml

每页的项目选择下拉列表由 for 循环生成：

```
$this->getAvailableLimit() 
```

工具栏的块上有以下方法：

```
public function getLimitUrl($limit)
{
    return $this->getPagerUrl(array(
        $this->getLimitVarName() => $limit,
        $this->getPageVarName() => null
    ));
} 
```

诀窍是执行以下两项之一：

1）利用magento构建正确的url，当它被注入任何指向您想要在查看所有模式下的类别的链接中时。

2）在 /catalog/product/list/toolbar.phtml 块上检查当前类别，如果当前类别是所需的类别，则执行以下代码：

```
if( strtoupper($this->getLimitVarName()) != "ALL" )
{
  $viewAllUrl =  $this->getLimitUrl('All');
  $this->_redirectUrl( $viewAllUrl );
} 
```

# ruby-on-rails - RSpec：存根私有方法

> ID：14987141
> 
> 赞同：31
> 
> 时间：2013-02-20T18:21:13.800
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, rspec2

我尝试使用 RSpec2 测试一个具有一些私有方法的类，这些方法是从一些公共方法调用的。我用

```
@foo.should_receive(:start_training).exactly(2).times 
```

如果他们被调用以及多久调用一次。我的问题是，这种方法不适用于私有方法。那么，有什么方法可以`@foo.send(:private_method)`结合使用 sth like`should_receive`吗？或者任何其他语法？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-20T18:24:38.940

`should_receive(:method)`无论 的可见性`:method`是公开的还是私有的，都可以使用。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2016-07-26T10:25:50.297

您可以使用`allow_any_instance_of`方法来存根或模拟类的任何实例，例如，您有一个带有一些方法的`class`命名，而不是您可以执行类似这样的操作`Foo``private`

```
allow_any_instance_of(Foo).to receive(:private_method) do
  #do something
end 
```

如果你`module`也有，你可以做这样的事情

```
allow_any_instance_of(Module::Foo).to receive(:private_method) do
  #do something
end 
```

您可以在[官方文档](https://relishapp.com/rspec/rspec-mocks/docs/working-with-legacy-code/any-instance#use-%60allow-any-instance-of%60-to-stub-a-method)`allow_any_instance_of()`中找到有关方法的更多详细信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T18:23:37.963

为什么要测试私有方法？他们是私人的是有原因的；以防止来自外部呼叫的访问。测试依赖于私有方法的公共方法就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-09T08:13:09.687

坏消息是：你不能存根私有方法。

好的是：您可以制作自己的方法`protected`，然后以通常的方式对其进行存根；

```
allow_any_instance_of(described_class).to(
  receive(:my_protected_method_name).and_return("foo_bar")
) 
```

# ios - 按月将带有 NSDate 对象的 NSArray 排序到 NSDictionary

> ID：14987147
> 
> 赞同：2
> 
> 时间：2013-02-20T18:21:25.347
> 
> 标签：ios, objective-c, cocoa-touch, nsarray, nsdictionary

我正在构建一个`UITableView`并希望按月分组，以便我可以将这些字符串作为我的部分标题，例如：

```
February 2013
- Item 1
- Item 2

January 2013
- Item 1
- Item 2 
```

我有一个`NSArray`自定义对象，该对象的 pubDate 属性是`NSDate`.

如何使用该`NSDate`对象将我的自定义对象`NSDictionary`按月分组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T18:49:51.373

像这样排序数组

```
NSArray *sortedArray = [yourArrayOfCustomObjects sortedArrayUsingComparator:^NSComparisonResult(id obj1, id obj2) {
        NSDate *firstDate = [(YourCustomObject*)obj1 pubDate];
        NSDate *secondDate = [(YourCustomObject*)obj2 pubDate];
        return [firstDate compare:secondDate];        

    }]; 
```

// 现在是一个简单的迭代，您可以确定所有相同月份的条目。

// 仅出于说明目的，代码并不完整。

// 你也必须处理年份变化。

```
int curMonth = 0;
int prevMonth = 0;
foreach(CustomObject *obj in sortedArray)
{
   NSDateComponents *components = [[NSCalendar currentCalendar] components:NSDayCalendarUnit | NSMonthCalendarUnit | NSYearCalendarUnit fromDate:obj.pubDate];
   prevMonth = curMonth; 
   curMonth = components.month;
   if(prevMonth != 0 && curMonth != prevMonth)
   {
      //Month Changed
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:25:55.653

看看[`NSDateComponents`](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/DatesAndTimes/Articles/dtCalendars.html#//apple_ref/doc/uid/TP40003470)。如果您将日期转换为日期组件：

```
[[NSCalendar currentCalendar] components:(NSMonthCalendarUnit | NSYearCalendarUnit) fromDate:date] 
```

那么您将拥有可以很容易地比较是否相等的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-17T08:38:59.317

我认为，这个问题缺少 Ole Begemann 的答案，但是这是一个链接（我无法发表评论 < repo）我正在回答这个问题，

如果有人仍在寻找一些优雅的解决方案，请检查一下，

[http://oleb.net/blog/2011/12/tutorial-how-to-sort-and-group-uitableview-by-date/](http://oleb.net/blog/2011/12/tutorial-how-to-sort-and-group-uitableview-by-date/)

# mongodb - mongo: 聚合 - $project 之前的 $match

> ID：14987151
> 
> 赞同：4
> 
> 时间：2013-02-20T18:21:31.710
> 
> 标签：mongodb, aggregation-framework

在 $match 表达式中有一个包含大约 100GB 数据和每个字段的 mongodb，我有一个索引（单字段索引）。

现在我尝试了 aggregate() 并将 $project 写为管道的第一部分， $match 后面。

聚合运行并返回正确的结果，但需要几个小时！这真的只处理过滤后的 ($match) 数据，还是 mongo 聚合所有数据并在之后过滤？

在我的测试用例中，$match 过滤了大约 150MB（而不是 100GB 的完整数据大小）。

意外地，我更改了顺序，并在管道定义中的 $project 之前写了 $match。这样，几秒钟内就完成了。

mongodb通常什么时候减少输入数据，是否也处理$match中字段的索引？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:52:45.507

正如您所注意到的，管道操作员的顺序非常重要，尤其是在处理大型集合时。如果操作不正确，您可能会耗尽内存，更不用说该过程需要很长时间了。如[文档中所述](http://docs.mongodb.org/manual/applications/aggregation/#pipeline-operators-and-indexes)：

> 以下管道运算符在管道开始时利用索引：
> 
> ```
> $match 
> $sort 
> $limit 
> $skip. 
> ```

因此，只要`$match`预先提出您的索引就可以使用。[也在文档中](http://docs.mongodb.org/manual/applications/aggregation/#pipelines)注明

> MongoDB 聚合管道将 MongoDB 文档从一个管道运算符流式传输到下一个管道运算符以处理文档。管道运算符可以在管道中重复。

这意味着您`$project`只能看到整个集合的一小部分，如果它前面有一个`$match`.

# php - 在 MYSQL 支持的页面上加载

> ID：14987152
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:21:42.080
> 
> 标签：php, mysql, caching, indexing, load-testing

我有一个页面，每次加载时都会对 2 个不同的 MYSQL 表进行 4 个 SQL 调用（2 个 SELECT、1 个 INSERT 和一个 UPDATE）。

该页面是用 PHP 编码的，没有任何缓存。我预计每个表的大小将增长到大约 30,000 行，并且尚未进行负载测试。SELECT 查询将每个查询最多提取 5 行。

我能做些什么来防止数据库在负载过大的情况下崩溃。将索引添加到与我的查询中引用的列相对应的表有帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:33:52.880

首先，30,000 行并不是很多数据；数据库应该能够轻松处理这么多。

如果`SELECT`s 是重复的，那么您应该启用的查询缓存可能会缓存它们，因此来自这些的负载可以忽略不计。您几乎应该总是在要过滤和排序的列上具有索引，因此请确保您的查询使用索引。

如果您不需要`INSERT`立即从 s 获取数据，则可以使用`INSERT DELAYED`，它将插入队列，直到表未使用并同时插入所有等待的行。除非您期望`INSERT`每秒始终有多个 s，否则使用`INSERT DELAYED`可能不会产生明显的差异。

确保`UPDATE`s 也在使用索引。

更具体地说，我们需要更多信息，例如数据库的结构和代码。

# android - Android Preference.getExtras() 是做什么用的？

> ID：14987153
> 
> 赞同：0
> 
> 时间：2013-02-20T18:21:42.217
> 
> 标签：android, android-intent, preference, extras

Preference 类有一个名为 getExtras() 的方法。
它可能与 Preference 意图相关，也可能不相关，但可以直接使用该意图获取和放置 Extras。
Preference类中没有putExtra/s()方法，那么……
getExtras()的目的是什么？在哪些场景下使用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:27:18.370

> getExtras() 的目的是什么？

它并没有真正做任何有用的事情。严重地。

在[源代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/preference/Preference.java)[中`Preference`](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/preference/Preference.java)，有一个`private`成员变量`mExtras`：

```
private Bundle mExtras; 
```

但是，它永远不会以任何方式改变（并且不能被外部类访问），除了以下情况：

```
public Bundle getExtras() {
    if (mExtras == null) {
        mExtras = new Bundle();
    }
    return mExtras;
}
public Bundle peekExtras() {
    return mExtras;
} 
```

我想它将来可能会用于某些事情，但它是在 API 11 中添加的，并且通过 API 16 仍然无用。

> Preference类中没有putExtra/s()方法，那么……在哪些场景下使用？

我想您可以使用它来将项目与偏好相关联，例如：

```
Bundle extras = myPref.getExtras();
extras.putString("KEY", "Value"); 
```

您不需`putExtra()`要这样做，而是`Bundle`直接访问。但这似乎是它有用的全部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-20T00:14:24.277

文档中没有很好地解释它，但`#getExtras`它适用于通过`#setFragment`. 只要[您](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/preference/PreferenceActivity.java#1433)使用`PreferenceActivity`.

# c# - One Key to multiple values dictionary in C#?

> ID：14987156
> 
> 赞同：16
> 
> 时间：2013-02-20T18:21:50.730
> 
> 标签：c#

I often need one key to multiple vaules dictionary, but in C# most of them are two dimensions like Dictionary and Hashtable.

I want something like this:

```
var d = new Dictionary<key-dt,value1-dt,value2-dt,value3-dt,value4-dt>(); 
```

dt inside<> means data type. Anybody has ideas about this?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-20T18:35:51.813

字典是一个键值对，其中的值是根据键获取的。键都是唯一的。

现在，如果您想要一个`Dictionary`具有 1 个键类型和多个值类型的，您有几个选择：

首先是使用一个`Tuple`

`var dict = new Dictionary<KeyType, Tuple<string, string, bool, int>>()`

另一种是使用（使用 C# 4.0 及更高版本）：

`var dict = new Dictionary<KeyType, dynamic>()`

`System.Dynamic.ExpandoObject`可以具有任何类型的值。

```
using System;
using System.Linq;
using System.Collections.Generic;

public class Test {
   public static void Main(string[] args) {
        dynamic d1 = new System.Dynamic.ExpandoObject();
    var dict = new Dictionary<int, dynamic>();
        dict[1] = d1;
        dict[1].FooBar = "Aniket";
        Console.WriteLine(dict[1].FooBar);
        dict[1].FooBar = new {s1="Hello", s2="World", s3=10};
        Console.WriteLine(dict[1].FooBar.s1);
        Console.WriteLine(dict[1].FooBar.s3);
   }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-20T18:25:34.267

用类描述适当的键字段和适当的值字段**。**并使用这些类型的字典。

```
var dictionary = new Dictionary<TheKeyType, TheValuesType>(); 
```

注意：如果您有多个值作为键，您将定义一个类来封装这些值并提供对 GetHashCode 和 Equals 的适当覆盖，以便字典可以识别它们的相等性。

如果不这样做，您可以使用元组，但您想限制这种模式，因为元组是非自描述的。

```
var dictionary = new Dictionary<Tuple<Key1Type, Key2Type, Etc>, Tuple<Value1Type, Value2Type, Etc>>(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-20T18:26:28.960

我建议不要使用元组，这是一个完全有效的解决方案，而是创建自己的类作为键和/或值。

您可能会意识到元组将成为难以阅读的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T18:24:40.500

使用[元组](http://msdn.microsoft.com/en-us/library/system.tuple.aspx)作为键。

```
var d = new Dictionary<Tuple<string,string,bool,int>,any-data-typs>(); 
```

# magento - Magento 1.7 page.xml use block elements multiple times

> ID：14987157
> 
> 赞同：0
> 
> 时间：2013-02-20T18:21:54.080
> 
> 标签：magento

For layout reasons I needed to have two different header.phtml (header.phtml / header1.phtml). But if I now copy the header block in the page.xml, only the definitions of the latest block seems to work (both of them work independly, but when both blocks are in the page.xml only the latest of both is causing changes).

```
<block type="page/html_header" name="header" as="header">
    <block type="page/template_links" name="top.links" as="topLinks"/>
    <block type="page/html_wrapper" name="top.bar" as="topBar" translate="label">
        <label>Breadcrumbs</label>
        <action method="setElementClass"><value>top-bar</value></action>
    </block>
</block>

<block type="page/html_header1" name="header1" as="header1">
    <block type="page/template_links" name="top.links" as="topLinks"/>
    <block type="page/html_wrapper" name="top.bar" as="topBar" translate="label">
        <label>Breadcrumbs</label>
        <action method="setElementClass"><value>top-bar</value></action>
    </block>
</block> 
```

Can anybody tell me, where my error is?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:32:28.460

您的问题出在 html_header1 的块类型中

尝试这个：

```
<block type="page/html_header" name="header1" as="header1" template="page/html/header1.phtml">
    <block type="page/template_links" name="top.links" as="topLinks"/>
        <block type="page/html_wrapper" name="top.bar" as="topBar" translate="label">
        <label>Breadcrumbs</label>
        <action method="setElementClass"><value>top-bar</value></action>
    </block>
</block> 
```

然后将您的 page/html/header.phtml 复制到 page/html/header1.phtml 并进行您需要进行的更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T20:16:51.103

你做的太多了。

如果您只需要为初始块实例切换模板，则以下*部分*就足够了：

```
<action method="setTemplate" block="header"><tpl>page/html/header1.phtml</tpl></action> 
```

我说“部分足够”是因为该指令显然需要在某些情况下执行。环境（例如特定视图或视图类型）映射到不同的布局更新句柄。例如，如果您想为登录的客户使用不同的标题模板，则完整的布局 XML 将如下所示：

```
<?xml version="1.0"?>
<layout>
    <customer_logged_in>
         <action method="setTemplate" block="header"><tpl>page/html/header1.phtml</tpl></action>
    </customer_logged_in>
</layout> 
```

根据指定的模板路径，您应该创建文件*app/design/frontend/base/default/page/html/header1.phtml*，或者至少在您的自定义主题下创建此文件。

`local.xml`此外，您应该在自定义主题的*布局*文件夹中创建一个文件。

# javascript - Detecting negative numbers using Javascript for developing a calculator

> ID：14987158
> 
> 赞同：1
> 
> 时间：2013-02-20T18:21:57.680
> 
> 标签：javascript, regex, calculator

I am developing a distributed calculator using JavaScript and PHP. The calculator should recognize parenthesis and should change the order of calculations according to parenthesis. All basic mathematical operations (`*`, `/`, `+`, `-`) have the same priority (unlike the common priority). I use the following regex to get user input and put in an array. This regex works well for positive numbers:

```
/\d*\.\d+|\d+|[()/*+-]/g 
```

However, when it comes to **negative numbers**, it crashes because I use a recursive replacement function that replaces each pair of parenthesis (and the contents) with the result of the operations inside those parenthesis. I do this because this is a distributed calculator and I should perform each atomic operation at server side and then return the result back and show it in the history of the operations.

All I want is to detect negative numbers (to save them as only one element in the array). I think it should work in this way: when there are two consecutive operators (with zero or more whitespace characters between them), and the second operator is a minus sign (`-`), the minus sign should be concatenated to the following number (as the sign of the number). In addition, if the first number is preceded by a minus sign, the sign should be concatenated to that number.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T23:35:29.047

因为在 javascript 的正则表达式实现中没有后视，所以这并不像最初看起来那么简单。

这是一种方法。它假定首先删除了空格。

```
var m,
    tokens = [],
    rex = /(^|[(\/*+-])(-(?:\d*\.)?\d+)|[()\/*+-]|(?:\d*\.)?\d+/g,
    str = '-4-(-2*3)--4-2/-0.9-3+(3-4*-4)';

while ( m = rex.exec( str ) ) {
    if ( m[1] ) {
        tokens.push( m[1], m[2] );
    } else {
        tokens.push( m[0] );
    }
}

console.log( tokens );
// [ "-4", "-", "(", "-2", "*", "3", ")", "-", "-4", "-", "2", "/", "-0.9", "-", "3", "+", "(", "3", "-", "4", "*", "-4", ")" ] 
```

在这里，使用捕获组来模拟后视`()`。如果在负数之前有字符串的开头`^`或运算符，则将运算符和负数分别添加到数组中。否则，将任何作为运算符添加到数组中。 `m[1]``m[2]``-`

或者，您可以使用

```
tokens = str.match( /(?:\d*\.)?\d+|[()\/*+-]/g ); 
```

然后遍历数组，如果你找到一个`-`跟随一个运算符，然后将它添加到下面的数字。

无论您采用哪种方式，一个简单的正则表达式都不会单独标记字符串，您需要使用条件语句来确定如何处理每个`-`.

# javascript - Using ddSlick and selecting an item in the list by value rather than index

> ID：14987162
> 
> 赞同：3
> 
> 时间：2013-02-20T18:22:03.273
> 
> 标签：javascript, jquery

I'm using ddSlick to change my drop down menus into prettier ones;

[http://designwithpc.com/Plugins/ddSlick](http://designwithpc.com/Plugins/ddSlick)

But I have a problem. I rely on programatically changing the selected item in a list, but I must do it by value rather than index. So this is the code to select the list item by index;

```
$('#demoSetSelected').ddslick('select', {index: 1 }); 
```

I can't seem to find any way of doing it in the documentation, thought there may be someone who has come across and solved the issue. Or if anyway knows an alternative plugin that does the same job as ddSlick?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:45:31.210

我遇到了这个问题，解决方法很丑 - 基本上，我必须遍历 ddslick 持有的所有项目，匹配值，然后从那里获取索引。我想我得到了[他们演示页面](http://designwithpc.com/Plugins/ddSlick)的源代码来帮助我理解示例 3 和 4。我使用示例 3 来帮助我理解如何遍历其所有数据，因此我可以遍历项目，找到匹配的值，然后抓取它的索引。然后示例 4 让我设置下拉项。抱歉，我找不到我测试过的文件。

DdSlick 看起来不错，但最后我选择了[MsDropDown](http://www.marghoobsuleman.com/jquery-image-dropdown)。我发现它更健壮 - 它有一个 SetIndexByValue 函数。他们在 github 站点和演示站点上都有详细的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T12:47:05.473

以编程方式选择 ddslick 下拉菜单非常简单。

在您的 json 数据中传递 selected:true 您需要显示为选中状态

```
var ddData = [
    {
        text: "Facebook",
        value: 1,
        selected: false,
        description: "Description with Facebook",
        imageSrc: "http://dl.dropbox.com/u/40036711/Images/facebook-icon-32.png"
    },
    {
        text: "Twitter",
        value: 2,
        selected: true,
        description: "Description with Twitter",
        imageSrc: "http://dl.dropbox.com/u/40036711/Images/twitter-icon-32.png"
    }
]; 
```

我希望您了解创建 json 数据的地方只是放置条件（例如，如果数据库中的 id 与您为插件创建的数据中的 id 匹配）make selected:true else selected:false 以上代码将默认选择 twitter。

希望这是有道理的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-31T11:51:16.720

[我在Github](https://github.com/prashantchaudhary/ddslick/issues/14)中看到了这个选项：

```
$('#myDropdown li:has(.dd-option-text:contains("MyValue"))').index(); 
```

或者如果文本不等于值：

```
 $('#myDropdown li:has(input[value="MyValue"])').index(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-02-22T14:52:50.193

丑陋但有效：

```
 var s = 0;
            var ind;
            $('#your_select .dd-option-value').each(function(i) {
                if ($(this).val() == your_value_to_test) {
                    ind = s;
                    return false;
                }
                s++;
            });

            $('#your_select').ddslick('select', {index: ind }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-16T14:59:48.287

您还可以在调用 .ddslick() 之前在格式化下拉列表之前强制选择选项，只需在您的选择中选择一个选项，如下所示

```
 $("#demoSetSelected  option[value='YOURVALUE']").attr('selected', 'selected'); 
```

接着 ：

```
 $("#demoSetSelected").dsslick(); 
```

# ruby-on-rails - Bootstrap 在 Rails 中的弹出窗口 - 没有控制台错误，但它没有呈现

> ID：14987168
> 
> 赞同：0
> 
> 时间：2013-02-20T18:22:20.073
> 
> 标签：ruby-on-rails, twitter-bootstrap-rails

我正在尝试在我的 Rails 3.2 应用程序（bootstrap-sass gem）中使用 Bootstrap 的弹出效果。我在 application.js 中包含了所有 Bootstrap 的脚本，以及应用于我想要的元素的弹出框代码：

```
assets/javascripts/application.js:
//= require bootstrap
$('#elem').popover('show') 
```

在我看来，我有这个测试代码：

```
<a id="elem" href="#" class="btn btn-danger" rel="popover" data-trigger='hover' data-title="Example Popover" data-content="Readymade">hover for popover</a> 
```

当我在浏览器中查看此页面时，我在 Firebug 中看不到任何错误，并且包含所有工具提示/弹出框脚本。为什么没有在这个元素上发生弹出窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-14T03:25:40.443

我偶然发现了同样的问题，并花了很多时间来解决它。这对我有用：

资产/javascripts/application.js

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require_tree . 
```

资产/javascript/your_controller.js.coffee

```
$ ->
  $('#elem').popover('show') 
```

意见/your_controller/your_view.html.haml

```
=link_to "hover for popover", "#", id: :elem, rel: :popover, data:{title: "Example Popover", content: "Readymade", trigger: "hover"} 
```

我怀疑在你的情况下，足够的变化将是

资产/javascript/your_controller.js

```
$(document).ready(function() {
  $('#elem').popover();
}); 
```

# javascript - jQuery Tablesorter cannot detect which header was clicked in a dynamically created table

> ID：14987171
> 
> 赞同：3
> 
> 时间：2013-02-20T18:22:23.737
> 
> 标签：javascript, jquery

I am currently attempting to turn a dynamically created table into a .tablesorter object. When I actually apply $('table').tablesorter, everything works fine (even in debug mode, it properly detects the number of rows and parser for each column).

However, when actually clicking on one of the headers, I get a "Uncaught TypeError: Cannot read property 'type' of undefined." I've traced this back through the tablesorter code, and it turns out that there is an array within the tablesorter code called sortList. Sort list contains two numbers, the first being the number of column that is being sorted by, the second whether the sort is ascending or descending. For whatever reason, the first number always comes up as "undefined" within my code. If I manually set sortList[0][0] (it's actually a 1d matrix) to be some number, the sorting works perfectly on that column.

I have explicitly taken the generated html out of the browser, pasted it into a new document, and the sorting works fine on that version. As a result I'm suspicious that the error comes from the fact that the entire table (the entire document in fact) is created dynamically by javascript.

I've spent days on this now and am totally at wits end. It seems like this guy had a similar problem, but it went unresolved: [How to call jquery table sorter on a table which is getting loaded dynamically](https://stackoverflow.com/questions/13256262/how-to-call-jquery-table-sorter-on-a-table-which-is-getting-loaded-dynamically)

# android - 传递多个点时接收广播 Intent 时出错

> ID：14987173
> 
> 赞同：0
> 
> 时间：2013-02-20T18:22:27.767
> 
> 标签：android, android-intent, android-broadcast

我已经阅读了几乎所有关于 SO 的帖子，并尝试了所有我认为它们是相对的解决方案，但我仍然不知道为什么会发生这种情况。这是日志猫：

```
02-20 18:10:27.959: D/ProximityIntentReceiver(17636): entering receiver
02-20 18:10:27.959: W/dalvikvm(17636): threadid=1: thread exiting with uncaught exception (group=0x40adf9f0)
02-20 18:10:27.959: E/AndroidRuntime(17636): FATAL EXCEPTION: main
02-20 18:10:27.959: E/AndroidRuntime(17636): java.lang.RuntimeException: Error    receiving broadcast Intent { act=com.javacodegeeks.android.lbs.ProximityAlert flg=0x10 (has extras) } in com.example.newmaps.ProximityIntentReceiver@41550140
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:737)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.os.Handler.handleCallback(Handler.java:605)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.os.Looper.loop(Looper.java:137)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.app.ActivityThread.main(ActivityThread.java:4424)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at java.lang.reflect.Method.invokeNative(Native Method)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at java.lang.reflect.Method.invoke(Method.java:511)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:817)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:584)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at dalvik.system.NativeStart.main(Native Method)
02-20 18:10:27.959: E/AndroidRuntime(17636): Caused by: java.lang.NullPointerException
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.app.PendingIntent.getActivity(PendingIntent.java:195)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at com.example.newmaps.ProximityIntentReceiver.onReceive(ProximityIntentReceiver.java:36)
02-20 18:10:27.959: E/AndroidRuntime(17636):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:728)
02-20 18:10:27.959: E/AndroidRuntime(17636):    ... 9 more 
```

这是我的 Map 类中的代码，我在其中创建了一个接近警报以及位置侦听器：

```
 private void addProximityAlert(Double latitude, Double longitude, String poiName) {
     Bundle extras = new Bundle();
     extras.putString("name", poiName);
     extras.putInt("id", requestCode);
    Intent intent = new Intent(PROX_ALERT_INTENT);
    intent.putExtra(PROX_ALERT_INTENT, extras);
    PendingIntent proximityIntent = PendingIntent.getBroadcast(Map.this, requestCode , intent, PendingIntent.FLAG_CANCEL_CURRENT);
    lm.addProximityAlert(
           latitude, // the latitude of the central point of the alert region
           longitude, // the longitude of the central point of the alert region
           POINT_RADIUS, // the radius of the central point of the alert region, in meters
           PROX_ALERT_EXPIRATION, // time for this proximity alert, in milliseconds, or -1 to indicate no                           expiration
           proximityIntent // will be used to generate an Intent to fire when entry to or exit from the alert region is detected
    );

    requestCode++;    
    IntentFilter filter = new IntentFilter(PROX_ALERT_INTENT);
    registerReceiver(new ProximityIntentReceiver(), filter);
    Toast.makeText(getApplicationContext(),"Alert Added"+requestCode,Toast.LENGTH_SHORT).show();
 }

    public class MyLocationListener implements LocationListener {
    public void onLocationChanged(Location location) {

        Toast.makeText(Map.this, "Distance from Point:", Toast.LENGTH_LONG).show();
    }
    public void onStatusChanged(String s, int i, Bundle b) {            
    }
    public void onProviderDisabled(String s) {
    }
    public void onProviderEnabled(String s) {           
    }
    } 
```

这是 Proximity 类：

```
public class ProximityIntentReceiver extends BroadcastReceiver {

private static final int NOTIFICATION_ID = 1000;

@Override
public void onReceive(Context context, Intent intent) {

String key = LocationManager.KEY_PROXIMITY_ENTERING;

Boolean entering = intent.getBooleanExtra(key, false);

if (entering) {
    Log.d(getClass().getSimpleName(), "entering receiver");
}
else {
    Log.d(getClass().getSimpleName(), "exiting");
}

NotificationManager notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);

PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, null, 0);        

Notification notification = createNotification();        
notification.setLatestEventInfo(context, 
    "Proximity Alert!", "You are approaching: " +intent.getBundleExtra("deucalion0.ProximityAlert.").get("name"), pendingIntent);     
                                                                    //here-------------------------------------
notificationManager.notify( intent.getBundleExtra("deucalion0.ProximityAlert.").getInt("id"), notification);

}

private Notification createNotification() {
Notification notification = new Notification();

notification.icon = R.drawable.ic_launcher;
notification.when = System.currentTimeMillis();

notification.flags |= Notification.FLAG_AUTO_CANCEL;
notification.flags |= Notification.FLAG_SHOW_LIGHTS;                

notification.defaults |= Notification.DEFAULT_VIBRATE;
notification.defaults |= Notification.DEFAULT_LIGHTS;
notification.defaults |= Notification.DEFAULT_SOUND;

notification.ledARGB = Color.WHITE;
notification.ledOnMS = 300;
notification.ledOffMS = 1500;

return notification;
}} 
```

当我运行应用程序并打开地图时它很好，但最终在手机坐在那里时崩溃了，我不知道它在做什么，也许它与位置监听器有关？我将非常感谢一些帮助来解决这个问题，因为我现在一无所知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:24:36.567

在 ProximityIntentReceiver - 更改行

```
PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, null, 0); 
```

到

```
PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:38:00.047

来自 LogCat：

```
Caused by: java.lang.NullPointerException
    at android.app.PendingIntent.getActivity(PendingIntent.java:195)
    at com.example.newmaps.ProximityIntentReceiver.onReceive(ProximityIntentReceiver.java:36) 
```

当您致电时，问题似乎与此行有关[`getActivity()`](https://developer.android.com/reference/android/app/PendingIntent.html#getActivity%28android.content.Context,%20int,%20android.content.Intent,%20int%29)：

```
PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, null, 0); 
```

这令人困惑。PendingIntent 的目的是启动一个组件，在本例中是一个 Activity，但您传递的是一个`null`Intent。你想让这行代码做什么？

# ftp - download apache server config

> ID：14987174
> 
> 赞同：2
> 
> 时间：2013-02-20T18:22:27.967
> 
> 标签：ftp, download, debian

How to config apache2 for download server (any file in webroot download by link ) ? No one can build a security problem with file upload and execute file upload ? (limit my user for upload Problematic files) ‌Best Regards.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-18T16:28:22.023

下载部分很简单，只需将您的文件放在 Apache 配置文件中指定的 Apache 文档根目录下您想要的目录中。然后你应该能够只使用一个链接来让人们下载它。

上传部分要困难得多。您需要决定要使用哪种技术，例如 Apache 支持 WebDAV，但您已指定要使用 ftp。如果您想使用 ftp，我建议您使用像 vsftpd 这样的 ftp 服务器，因为您可以使用它的功能来锁定您的上传目录以防止“有问题的”文件。

# java - 如何清除缓冲区以使其有效？

> ID：14987178
> 
> 赞同：0
> 
> 时间：2013-02-20T18:22:32.030
> 
> 标签：java

它在 IF 语句中有效，但在 ELSE 语句中，我必须输入 4 个响应才能打印出来。有任何想法吗？我知道我需要以某种方式清除缓冲区。

```
System.out.println("Would you like to play a game? (Y/N)");
        if(scanInput.next().equalsIgnoreCase("y")||scanInput.next().equalsIgnoreCase("Y")) {

        System.out.println("let's play");
    }

    else if (scanInput.next().equalsIgnoreCase("n") || scanInput.next().equalsIgnoreCase("N")){

        System.out.println("Goodbye");
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:25:43.530

刚读过`InputStream`一次：

```
String query = scanInput.next();
if (query.equalsIgnoreCase("y")) {
    System.out.println("let's play");
} else if (query.equalsIgnoreCase("n")) 
    System.out.println("Goodbye");
} // handle case where not Y or N ... 
```

请注意，不需要多个`String#equalsIgnoreCase`表达式。在这里也`scanInput.nextLine()` *可能*最好使用换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:27:03.363

这是因为您`next()`四次调用扫描仪的方法。此外，重点`equalsIgnoreCase()`是您不需要同时测试`y`和`Y`。

```
System.out.println("Would you like to play a game? (Y/N)");
String x = scanInput.next();
if(x.equalsIgnoreCase("y")) {
    System.out.println("let's play");
}
else if (x.equalsIgnoreCase("N"))    
    System.out.println("Goodbye"); 
```

# android - Android：onCreateOptionsMenu - 删除默认菜单项

> ID：14987180
> 
> 赞同：1
> 
> 时间：2013-02-20T18:22:34.980
> 
> 标签：android, oncreateoptionsmenu

我正在使用`onCreateOptionsMenu`并且有一个我没有编程的默认菜单项。我想删除它，因为我没有用它，它也没有做任何事情。这是它的样子：

![在此处输入图像描述](../Images/5557444d967800783e5b2c0c8e69ca89.png)

我想摆脱“设置”项。

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    menu.add(1, 1, 0, "item1");
    menu.add(1, 2, 1, "item2");

    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_name, menu);
    return true;
} 
```

如您所见，我没有自己手动添加它。我该如何摆脱它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T18:26:43.703

> 如您所见，我自己没有添加

是的，你有。它来自：

```
getMenuInflater().inflate(R.menu.activity_name, menu); 
```

> 我该如何摆脱它？

删除上述行。或者，将您的基于 Java 的`Menu`操作移至`res/menu/activity_name.xml`该文件中并删除“设置”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T18:26:57.697

设置选项是由eclipse在菜单xml中自动生成的。从 xml 菜单中删除它，该选项将不再显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:26:37.060

检查 R.menu.activity_name 的内容或过去此 xml 文件的数据。

# ember.js - Ember data isDeleted marked records still remain in hasMany (embedded always)

> ID：14987182
> 
> 赞同：1
> 
> 时间：2013-02-20T18:22:37.460
> 
> 标签：ember.js, ember-data

We were trying to apply ember data to multiple levels of nested JSON.

```
Model A hasMany Model B
and Model B is embedded always in Model A 
```

In this scenario if we are editing a record of A and delete all B. On calling `deleteRecord` on B, the records are marked isDeleted, but are still present as children of A.

Question 1: Is this a good scenario, say if there are number of records B has and all of them are marked isDeleted. Also, if the user ends of adding more of B and deleting more. Won't deleteRecord, followed by createRecord multiple times, create a long list of records marked isDeleted. Is it good for design of App.

Question 2: For embedded records, on delete of child records, commit is necessary to call to get of isDeleted marked child records ?

# python - 如何在 celery 中安排工作日感知工作

> ID：14987185
> 
> 赞同：8
> 
> 时间：2013-02-20T18:23:03.047
> 
> 标签：python, django, celery, django-celery, celerybeat

是否可以使用 celery beat 配置复杂的时间表？例如，像这样：

周一到周五，用参数 (x1, y1) 做作业 A，然后做作业 B 周六、周日，用参数 (x2, y2) 做作业 A，不做作业 B

我知道我可以实现一个高频“tick”任务来检查这个时间表，但如果已经存在这样的东西，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-20T18:25:23.910

当然，为您的任务使用[crontab 计划](http://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html#crontab-schedules)。

```
from celery.schedules import crontab

CELERYBEAT_SCHEDULE = {
    # Executes every weekday morning at 7:30 A.M
    'weekdays': {
        'task': 'tasks.A',
        'schedule': crontab(hour=7, minute=30, day_of_week='1-5'),
        'args': (x1, y1),
    },
    # Executes saturday morning at 4:00 A.M
    'saturday': {
        'task': 'tasks.B',
        'schedule': crontab(hour=7, minute=30, day_of_week='sat'),
        'args': (x1, y1),
    },
    # Executes sunday morning at 2:15 A.M
    'sunday': {
        'task': 'tasks.A',
        'schedule': crontab(hour=2, minute=15, day_of_week='sun'),
        'args': (x2, y2),
    },
} 
```

# javascript - 通过 js 或 jQuery 按需显示/隐藏表格数据

> ID：14987195
> 
> 赞同：0
> 
> 时间：2013-02-20T18:23:48.327
> 
> 标签：javascript, php, jquery, html-table, hide

我似乎有一点问题，也许有人可以帮助我。

如果没有从数据库中提取的数据，我想用这段代码做的是隐藏表格行/列。我可以使用以下代码在某种程度上做到这一点：

```
<div style="border: 1px solid #ccc;">

  <table class="tableizer-table">
    <tr>
      <td class="first-row" colspan="2"># Of Items in Package: <?php echo $_product->getItemsInPackage(); ?></td>
    </tr>
    <tr>
      <td class="second-row">Size Scale</td>
      <td class="second-row">Quantity</td>
    </tr>
    <tr>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_size_1') ?></td>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_quantity_one') ?></td>
    </tr>
    <tr>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_size_2')  ?></td>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_quantity_two') ?></td>
    </tr>
    <tr>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_size_3')  ?></td>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_quantity_three') ?></td>
    </tr>
      <tr>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_size_4')  ?></td>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_quantity_four') ?></td>
    </tr>
    <tr>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_size_5')  ?></td>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_quantity_five') ?></td>
    </tr>
    <tr>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_size_6')  ?></td>
      <td class="cell" style="empty-cells:hide; border-collapse: separate;"><?php echo $_product->getAttributeText('bundle_quantity_six') ?></td>
    </tr>
  </table>
</div> 
```

基本上， bundle_size_5 和 bundle_size_6 （和其他） - 可能存在也可能不存在，我需要隐藏这些行/列。但我也想用 CSS（边框示例）对其进行样式化，并注意到即使它们被隐藏，保留的空间仍然存在并且边框围绕它。

除非有数据，否则有没有办法通过 js 或 jQuery 完全隐藏这些行/列？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:37:26.983

尝试，

```
$(document).ready(function() {   
$('.tableizer-table tr').each(function() {
   var t =  $(this).find('td');
    if ( t.text() === '' ) {
     t.css('borderLeft','0px'); //or border-left
     t.hide();
    }  
  });
 }); 
```

[演示](http://jsfiddle.net/GjWGp/5/)

财产[手册](http://api.jquery.com/css/)`borderLeft`，而不是“边界”。

# java - SharedPreferences 总是返回默认值而不是实际值

> ID：14987198
> 
> 赞同：0
> 
> 时间：2013-02-20T18:24:12.170
> 
> 标签：java, get, hashmap, themes, settings

我看到了这个主题的一些帖子，并尝试了没有用的解决方案。

我在主要活动中写道：

```
SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);;
setTheme(sharedPreferences.getInt("selectedTheme", 0)); 
```

它总是返回 0 。

我检查了模拟器中的 Setting.xml 文件：

```
<?xml version='1.0' encoding='utf-8' standalone='yes' ?>
<map>
<int name="STheme" value="2131099649" />
<int name="selectedTheme" value="2131099649" />
<string name="SThemeS">R.style.AppTheme</string>
</map> 
```

你可以看到键值“selectedTheme”在那里。

有任何想法吗 ？

另一个问题：我必须创建

```
SharedPreferences sharedPreferences = getPreferences(MODE_PRIVATE);; 
```

对于每个使用 sharedPreferences 的活动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T17:04:31.707

当 SharedPreferences 创建文件的名称是作为创建他的活动。

因此，如果您在设置活动中创建 SharedPreferences 并且想要从其他活动中获取首选项，则必须指定 SharedPreferences 文件的名称。

如果您试图从同一活动中获取偏好，则无需这样做。

示例：**在设置活动中创建的**SharedPreferences并从不同的活动中读取它：

在当前活动中添加这一行 -

```
SharedPreferences preferences = context.getSharedPreferences("Setting",
                MODE_PRIVATE) 
```

现在您可以提取数据....

# java - ELKI 和 RapidMiner 中 LOF 实施的不同结果

> ID：14987200
> 
> 赞同：5
> 
> 时间：2013-02-20T18:24:23.503
> 
> 标签：java, rapidminer, outliers, elki

我已经编写了自己的 LOF 实现，我正在尝试将结果与 ELKI 和 RapidMiner 中的实现进行比较，但所有 3 都给出了不同的结果！我正在努力找出原因。

我的参考数据集是一维的，有 102 个实数值，有很多重复。我会试着把它贴在下面。

首先，RapidMiner 的实现。LOF 分数与 ELKI 和我的结果大不相同；许多人带着无限的LOF回来。这个实现是否被验证为正确的？

我的结果与 ELKI 相似，但我没有得到完全相同的 LOF 值。通过快速浏览 ELKI 源代码中的注释，我认为这可能是因为计算 k 邻域的方式不同。

在 LOF 论文中，MinPts 参数（在其他地方称为 k）指定了最小编号。包含在 k 邻域中的点数。在 ELKI 实现中，我认为他们将 k 邻域定义为精确的 k 点，而不是 k 距离或 k 不同距离内的所有点。谁能确切地确认 ELKI 是如何构建 k 邻域的？还有一个私有变量允许点本身包含在它自己的邻居中，但看起来默认不包含它。

有谁知道带有用于验证目的的 LOF 分数的公共参考数据集？

---更多细节如下---

参考：ELKI源代码在这里：

[http://elki.dbs.ifi.lmu.de/browser/elki/trunk/src/de/lmu/ifi/dbs/elki/algorithm/outlier/lof/LOF.java](http://elki.dbs.ifi.lmu.de/browser/elki/trunk/src/de/lmu/ifi/dbs/elki/algorithm/outlier/lof/LOF.java)

RapidMiner 源代码在这里：

[http://code.google.com/p/rapidminer-anomalydetection/source/browse/trunk/src/de/dfki/madm/anomalydetection/evaluator/nearest_neighbor_based/LOFEvaluator.java](http://code.google.com/p/rapidminer-anomalydetection/source/browse/trunk/src/de/dfki/madm/anomalydetection/evaluator/nearest_neighbor_based/LOFEvaluator.java)

这是我的测试数据集：

4.32323 5.12595 5.12595 5.12595 5.12595 5.7457 5.7457 5.7457 5.7457 5.7457 5.7457 5.97766 5.97766 6.07352 6.07352 6.12015 6.12015 6.12015 6.44797 6.44797 6.48131 6.48131 6.48131 6.48131 6.48131 6.48131 6.6333 6.6333 6.6333 6.70872 6.70872 6.70872 6.70872 6.70872 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 6.77579 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.03654 7.10361 7.10361 7.10361 7.10361 7.10361 7.10361 7.10361 7.10361 7.15651 7.15651 7.15651 7.15651 7.15651 7.15651 7.15651 7.15651 8.22598 8.22598 8.22598 8.22598 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538 8.5538

例如，我得到第一个数字 (4.32323) 的以下 LOF 分数：

*   RapidMiner：无穷大（MinPts 下限/上限设置为 10,100）
*   ELKI：2.6774（k = 10 并且 distfunction/reachdistfunction 设置为默认值）
*   我的实现：1.9531

关于我的实现正在做什么的更多细节：

1.  MinPts 是 10，所以我找到了该点的 10 个不同的邻居。所以 4.32323 的邻域实际上是 48 个点，从 5.12595 到 6.77579。
2.  这给了我 2.45256 的 k-distinct 距离
3.  我正在计算第一个邻居的可达距离为 1.58277
4.  我将样本的 LRD 计算为 1/(99.9103/48)
5.  所有 48 个邻居的 lrd(o)/lrd(p) 之和为 93.748939
6.  除以 48 得到 1.9531 的 LOF

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:51:58.743

我实际上并不惊讶他们不同。您还可以添加 Weka 的 LOF 实现，您可能会得到另一个答案。

这是您要添加到方程式中的另一个区别：据我所知，rapidminer 实现*合并*具有相同坐标的点。但也许，他们在计算最近邻时忘记了考虑这些权重！

在经典数据库上下文中，您**不会将重复的坐标合并**到单个观察值中。它们仍然是有效的数据库记录，应计为完整记录。

我不知道他们中的任何一个是否执行一些自动数据预处理，例如重新调整数据集。

**ELKI 实现已**针对我们用于教学的许多教科书示例进行了验证。

但是，算法中存在并非 100% 固定的极端情况，因此即使在算法的“字面”实现中也存在差异空间。您已经遇到了其中三个：

1.  如何处理重复点：A）聚合，B）丢弃，C）考虑不同

    从数据挖掘的角度来看，C 是正确的，而 A（如果正确实施）是一种优化，可以节省不必要的距离计算。B 是常见的数学视图，但对数据库上下文没有多大意义。如果我有两个“John Doe”，他们是同一个人吗？

2.  k 最近邻和 k 距离的定义。

    k-距离的通常定义是：最小距离，使得至少包含k个观测值。当排除查询点时，这会产生从起点到 5.7457 的反演：在 5.7457 - 4.32323 的半径内还有 10 个其他观测值。

    k个最近邻通常定义为这个距离内的任意一点，可能大于k。但是所有其他对象必须*与第 k 个具有相同的距离*！似乎 rapidminer*正好使用 k*，这与 LOF 出版物不一致（参见 LOF 出版物中的定义 4！）

    它实际上是 k 个最近的邻居（包括关系，但除此之外不超过 k 个对象），**而不是第 k 个最小*的不同*距离**。你从哪里得到“与众不同”的？

    LOF 出版物中的定义 3 和 4 对 LOF 使用的 kNN 集非常清楚。

    因此，您的 48 个对象的邻域是不正确的。

3.  如果有超过 minPts 的重复点该怎么办（文字实现将产生除以零，但由于显而易见的原因，该点应该被赋予 1.0 的 LOF）

    这可能就是 Rapidminer 正在发生的事情。

然后是可达距离：这个**真的很棘手**，因为它不是一个数学距离。它是*不对称*的。

*从*第二个观察到的第一个观察的可达性恰好是第二个的 k 距离，快速查看（没有仔细检查）`reach-dist(x[0], x[1]) = max(5.97766 - 5.12595, 5.12595 - 4.32323) = 0.80272`

有关如何计算 LOF 的逐步演示，请参阅[我关于异常值检测的大量教程幻灯片。](http://www.dbs.ifi.lmu.de/Lehre/KDD/SS12/uebung/Tutorial06Outlier.pdf)据我所知，这是字面的 LOF。它并没有触及所有的极端情况，但它激发了 LOF 算法的设计，并且非常详尽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T14:27:10.830

If you are using the Anomaly Detection Extension for RapidMiner[1] (not the build-in LOF), you will get the correct results. The build-in LOF is broken. These are the same results as ELKI. This implementation is much faster than ELKI because its multi-threated and does use much less memory, too. It also can handle duplicates (even more that k+1), where ELKI throws exceptions. (based on k-distinct)

Best, Hans

[1] [http://marketplace.rapid-i.com/UpdateServer/faces/product_details.xhtml?productId=rmx_anomalydetection](http://marketplace.rapid-i.com/UpdateServer/faces/product_details.xhtml?productId=rmx_anomalydetection)

# node.js - Node.js 购物车

> ID：14987202
> 
> 赞同：8
> 
> 时间：2013-02-20T18:24:30.717
> 
> 标签：node.js

有没有人们与 node.js 集成的好的购物车模块/服务？

我正在努力解决的具体要求是我正在销售照片的印刷品。我的应用程序将包含数千张照片，我不想将每张照片都设置为购物车中的商品。我更喜欢根据不同的打印尺寸有六个项目，然后基本上将图像标识符作为产品的属性。

我最终可能只是自己编写代码，但是当我开始考虑修改购物车、计算税收等时，它开始看起来比必要的要大，所以如果有什么我可以集成而不是构建，那就太好了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T15:47:41.453

由于没有答案，我想我会返回并提供我正在努力的解决方案......

我决定使用 Simplecart.js (simplecartjs.org) 在浏览器上维护一个购物车。我将在 MongoDB 中维护我的产品目录和定价，并将目录推送到客户端，以便我可以在那里使用 Simplecart 的功能。

由于 Simplecart 是基于客户端的，当用户结账时，我将从 MongoDB 重新加载定价（以确保客户端上没有有趣的业务），使用 Swipe.com 或类似网站处理付款，然后参加比赛。也许并不完美，但让我免于做购物车管理和结帐前端。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-07T09:19:29.840

不确定您保护 SimpleCart 的建议是否可行。即使在结账时刷新价格，任何拥有 JS 控制台的人都可以相对轻松地使用他们自己的用户定义价格购买商品。

我还没有看到不涉及在提交订单和付款交易之前创建服务器端流程来验证价格的提议解决方案，这当然使 SimpleCart 不再那么简单了。

请参阅 SimpleCart GitHub 问题跟踪器的评论：

*   [https://github.com/wojodesign/simplecart-js/issues/329](https://github.com/wojodesign/simplecart-js/issues/329)

*   [https://github.com/wojodesign/simplecart-js/issues/150](https://github.com/wojodesign/simplecart-js/issues/150)

# c# - 如何解决 ComboBox 的自动完成问题

> ID：14987209
> 
> 赞同：0
> 
> 时间：2013-02-20T18:24:43.630
> 
> 标签：c#, winforms, visual-studio-2010, combobox

我正在使用`ComboBox`来自数据库表的自动完成功能。并且`Append`工作`Suggest`完美！和`AutoCompleteSource : ListItem`。

但是我有一个问题：当用户单击箭头`ComboBox`并开始输入时，它开始正常自动完成，但是如果我按下`Enter`它并没有选择我想要的值。

我单击`ComboBox`箭头并开始输入名称，当它自动完成`ComboBox`字段中的文本时，我点击了，`Enter`但它只是跳转到下一个控件而没有将该值设置为`combobox`.

如何选择所需的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:46:04.293

你用 Javascript 解决这个问题。您需要绑定到框（可能在按键事件上）并将其设置为保持`var`指向结果集中的第一个值；然后在按键 == 13（回车）上，您要将元素值设置为先前存储的`var`. 它快速且易于编码。您可以通过创建一个自定义控件来包装您的其他控件、包含您的自定义 JS 并扩展诸如此类情况的“必需”之类的属性，从而使其使用起来更加有趣。

# linux - -b 选项在 SFTP 中的作用

> ID：14987210
> 
> 赞同：6
> 
> 时间：2013-02-20T18:24:58.020
> 
> 标签：linux, shell, unix, solaris, sftp

我正在查看一些旧的 shell 脚本，其中有一行我不太明白：

```
~]$ sftp -b /dev/fd/3 dropuser@targetftpserver.company.com 
```

我可以从 man 文件中看到 -b 用于批处理，并且参数应该是批处理文件。

在这种情况下，看起来批处理文件应该位于 /dev/fd/3 - 软盘驱动器上？我似乎无法理解它。

任何想法这应该做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:39:41.493

`/dev/fd`实际上不是软盘驱动器——“fd”代表“文件描述符”。`man fd`在终端中尝试。

此页面概述了正在发生的事情： http: [//lists.apple.com/archives/darwinos-users/2004/Apr/msg00042.html](http://lists.apple.com/archives/darwinos-users/2004/Apr/msg00042.html)。基本上，SFTP 写入的第一个文件（可能是它下载的文件？）作为批处理文件传回自身。

如果没有看到整个脚本或不了解 SFTP 的内部结构，我无法确切知道发生了什么。我猜想脚本连接到的服务器上有一个文件列表，/dev/fd/3 用于让SFTP下载列表，然后下载文件而不重新连接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T19:04:37.950

这些`"/dev/fd*"`文件是特殊设备。这些并没有真正占用您系统上的太多空间。它们允许进程按编号访问文件描述符；`0,1,2`是标准`input`的 ,`standard output`和`standard error`, 其他打开的文件以`3`

在您的情况下`sftp`，使用`-b`从`/dev/fd/3`

例子：

```
[root@04 fd]# exec 3< /etc/resolv.conf
[root@04 fd]# cat /dev/fd/3
search example.com 

nameserver 10.10.10.10
nameserver 20.20.20.20 
```

`read`您可以使用命令读取数据

```
[root@04 fd]# read -u 3 a b
[root@04 fd]# echo $a $b
nameserver 10.10.10.10 
```

`/dev/fd`目录输出

```
[root@04 fd]# ls -l /dev/fd/
total 0
lrwx------ 1 root root 64 Feb 20 14:34 0 -> /dev/pts/0
lrwx------ 1 root root 64 Feb 20 14:34 1 -> /dev/pts/0
lrwx------ 1 root root 64 Feb 20 14:34 2 -> /dev/pts/0
lr-x------ 1 root root 64 Feb 20 14:34 3 -> /etc/resolv.conf 
```

注意：在您的情况下，输入文件可能不同

# asp.net - IE7 DropDownList 呈现问题

> ID：14987213
> 
> 赞同：1
> 
> 时间：2013-02-20T18:25:03.657
> 
> 标签：asp.net, internet-explorer-7

我有一个下拉列表，在 IE7 中呈现如下：

![在此处输入图像描述](../Images/c50f3baaa75ef9f68208ebaabe87451a.png)

相同的下拉列表在 IE8 和 IE9 中呈现如下：

![在此处输入图像描述](../Images/c508bb900cbd1d46a5299e59054d4772.png)

我需要做什么才能让它在 IE7 中呈现与在 ie8 和 ie9 中相同的效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:50:30.483

您可以更改下拉列表的字体。将其设置为 Helveitca，Arial。或者反过来用它来匹配IE7的字体系统来匹配IE8/9。但就按钮或样式而言，您必须使用样式表来格式化下拉列表显示。这是因为 IE7 默认图形与 IE8/9 默认图形不同。您必须编辑样式表以使用 CSS 或主题为您的显示提供通用外观。

# java - 从 Java 执行 sh 文件

> ID：14987214
> 
> 赞同：0
> 
> 时间：2013-02-20T18:25:07.263
> 
> 标签：java, linux, sh, execute, gnu-screen

我正在尝试通过以下代码（CentOS 机器顺便说一句）执行 sh 文件

```
Runtime.getRuntime().exec("sh " + file.getPath()); 
```

我将此代码用于Windows，它工作正常

```
Runtime.getRuntime().exec("cmd /c start " + file.getPath()); 
```

可能是因为我在 .sh 文件中使用了 Screen 吗？我也在使用 java 命令来启动服务器，所以也许我需要包括这些？

这是sh文件的内容

```
#!/bin/sh
BINDIR=$(dirname "$(readlink -fn "$0")")
cd "$BINDIR"
screen -S PrivateServer java -Xms2048M -Xmx2048M -jar somejar.jar -o true 
```

我也在从关闭挂钩运行此代码，这可能是问题吗？这是因为该软件是一个游戏服务器，它的目的是让用户可以使用重启命令或让它自动重启，而无需自己设置任何东西。

编辑：我决定将错误输出到一个文本文件，发现这个“必须连接到终端”。有任何想法吗？我相信这是与使用屏幕有关的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T21:46:52.620

由于您确认该文件具有可执行权限，因此请尝试按如下方式传递参数：

```
Runtime.getRuntime().exec(new String[]{"/bin/sh" ,"-c", file.getPath()}); 
```

所以主要提供完整的路径供`sh`使用`-c`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:59:57.760

哟需要设置操作的权限，通常“sh”文件需要执行权限才能从Java应用程序运行这个脚本。您必须以 root (sudo su) 或 sudo java -jar 身份运行 Java 应用程序。或者设置对您的脚本“sudo chmod 777 ...”的完全访问权限，不是完全访问权限，但对于任何想要执行您的脚本的用户来说至少是 chmod +x。

最好的祝福。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:39:00.487

我建议使用 org.apache.commons.exec.* 来运行此类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T19:51:00.383

好像没有可执行权限，`"chmod +x shell_script_filename"`在执行shell脚本之前尝试执行

# matlab - 基于外部布尔值的带有 if/else 子句的 PARFOR

> ID：14987226
> 
> 赞同：1
> 
> 时间：2013-02-20T18:25:56.987
> 
> 标签：matlab, if-statement, parfor

我编写了一个简单的化学模拟，它可以并行计算大量网格框的属性。因此，我使用并行循环索引 Y 维度：

```
function[outputArray] = stackTest()

numX = 10;
numY = 10;
numZ = 10;
outputArray = zeros(numX,numY,numZ);
for iX = 1:numX
    parfor iY = 1:numY
        coreArray = outputArray(iX,iY,:);
        for iZ = 1:numZ
            tempNum = iX*iY*iZ;
            coreArray(1,1,iZ) = tempNum;
        end
        outputArray(iX,iY,:) = coreArray;
    end
end
end 
```

这工作正常。但是，我使用布尔值来控制是否执行某些操作，如下面的代码所示。`for`这在 Y 上使用简单循环时效果很好，但在使用 时`parfor`，代码失败，声明`optionalArg`未定义：

```
function[outputArray] = stackTest(controlArg)

numX = 10;
numY = 10;
numZ = 10;
outputArray = zeros(numX,numY,numZ);
if (controlArg)
    optionalArg = 10;
end
for iX = 1:numX
    parfor iY = 1:numY
        coreArray = outputArray(iX,iY,:);
        for iZ = 1:numZ
            tempNum = iX*iY*iZ;
            if controlArg
                tempNum = tempNum * optionalArg;
            end
            coreArray(1,1,iZ) = tempNum;
        end
        outputArray(iX,iY,:) = coreArray;
    end
end
end 
```

`stackTest`现在工作正常 if `controlArg = true`，但不是 if `controlArg = false`; 我发现的唯一解决方法是定义`optionalArg`独立于`controlArg`. 不用说这是问题的简化版本，但我会感谢任何可以向我解释的人；我怀疑这是`parfor`循环与全局变量有关的问题的一个子集，但是由于我没有定义全局变量，所以我有点困惑。

问候，

跳过

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:24:02.133

何时`controlArg`为假，`optionalArg`未定义。我猜 MATLAB 不相信你`controlArg`永远是假的（我的意思是说它没有机制来推断它，尽管对于上面的代码，人类可能认为这是显而易见的）。因此，它不能保证此时您的代码不需要`parfor`知道任何迭代：`optionalArg`

```
 if controlArg
            tempNum = tempNum * optionalArg;
        end 
```

为了快速修复，`optionalArg`请在没有周围的 if 子句的情况下进行定义——`controlArg`无论如何在使用它之前再次检查。或者，尝试用`optionalArg`（`10*controlArg`或所有三行替换为将`0`(false) 映射到 1 和`1`(true) 映射到所需值的数学表达式`optionalArg`，例如`tempNum = tempNum * (controlArg*9+1);`）。

顺便说一句：也许您可以更多地了解实际问题（不一定在这个问题中）。上面的输出数组可以由一两行代码生成，我猜想 MATLAB 的优点之一是一次对许多类似操作的矢量化计算（无需显式并行化）也可以应用于您的问题（即您可能不需要三层`for`循环。

# jetty - Jetty 9 Maven 插件和没有合适构造函数的 JNDI

> ID：14987235
> 
> 赞同：1
> 
> 时间：2013-02-20T18:26:36.630
> 
> 标签：jetty, maven-jetty-plugin

我正在尝试让 JNDI 资源创建与 Jetty 9 Maven 插件一起使用。相同的配置在 Jetty 8 上正常工作，但`java.lang.IllegalStateException: No suitable constructor`在 Jetty 9 上产生。以下是相关文件：

pom.xml：

```
<?xml version="1.0"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
  http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.example</groupId>
  <artifactId>jetty-jndi</artifactId>
  <version>1.0</version>
  <build>
    <plugins>
      <plugin>
        <!-- <groupId>org.mortbay.jetty</groupId>
        <version>8.1.9.v20130131</version> -->
        <groupId>org.eclipse.jetty</groupId>
        <version>9.0.0.RC0</version>
        <artifactId>jetty-maven-plugin</artifactId>
        <configuration>
          <webAppConfig>
            <jettyEnvXml>src/test/resources/jetty-ds-dev.xml</jettyEnvXml>
          </webAppConfig>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <dependencies>
    <dependency>
      <groupId>org.hsqldb</groupId>
      <artifactId>hsqldb</artifactId>
      <version>2.2.9</version>
    </dependency>
  </dependencies>
</project> 
```

src/test/resources/jetty-ds-dev.xml：

```
<?xml version="1.0"?>
<Configure id="Server" class="org.eclipse.jetty.webapp.WebAppContext">
  <New id="DSTest" class="org.eclipse.jetty.plus.jndi.Resource">
    <Arg>jdbc/test</Arg>
    <Arg>
      <New class="org.hsqldb.jdbc.JDBCDataSource">
        <Set name="DatabaseName">mem:foo</Set>
        <Set name="User">SA</Set>
      </New>
    </Arg>
  </New>
</Configure> 
```

和实际错误：

```
2013-02-20 10:22:23.464:WARN:oejx.XmlConfiguration:main: Config error at <New id="DSTest" class="org.eclipse.jetty.plus.jndi.Resource">|??<Arg>jdbc/test</Arg>|??<Arg>|???<New class="org.hsqldb.jdbc.JD
BCDataSource">|????<Set name="DatabaseName">mem:foo</Set>|????<Set name="User">SA</Set>|???</New>|??</Arg>|?</New> java.lang.IllegalStateException: No suitable constructor: <New id="DSTest" class="org
.eclipse.jetty.plus.jndi.Resource">
                <Arg>jdbc/test</Arg>
                <Arg>
                        <New class="org.hsqldb.jdbc.JDBCDataSource">
                                <Set name="DatabaseName">mem:foo</Set>
                                <Set name="User">SA</Set>
                        </New>
                </Arg> 
```

将注释向下更改两行（以恢复 Jetty 8），应用程序将正确启动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T22:14:48.257

您需要在 jetty-ds-dev.xml 文件中的以下行作为第二行：

```
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://www.eclipse.org/jetty/configure_9_0.dtd"> 
```

不知道为什么它在没有指定 configure.dtd 的情况下与 8 一起工作，但肯定应该在那里，并且版本 9_0。

问候简

# java - 关于在 Map 中检查 Map 中不应有 null 键

> ID：14987242
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:26:44.920
> 
> 标签：java, collections, map

在一次采访中，有人问哈希 Map 是否可以将 null 作为键存储，我回答是，因为我们可以将 null 作为键存储在 HashMap 中，然后他进一步问，假设创建的 HasMap 由字符串作为键组成，其关联值为在那里，现在他在任何情况下都不希望 null 应该作为键存储，那么需要进行哪些预检查才能实现这一点，请告知.. 下面是 HashMap ..

```
Map map = new HashMap();
map.put("ty" ,"Spring");
map.put(null, "nullkey");
map.put("Anupam", "Hibernate");
map.put("Ravi", ".Net"); 
```

如上所示，在上面的 Map 中存在我们不想要的 null 键，需要进行什么预检查才能使 np 键在 HashMap 中作为 Null 存在。请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:35:09.423

`HashMap`实际上确实允许空键。

如果您尝试添加空键，其他`Map`实现则不会，`Hashtable`并且会抛出 NullPointerException。`ConcurrentHashMap`

如果您想禁止空键，您可以使用这些实现之一，*或者*您自己的 HashMap 子类。

像这样的东西：

```
public class MyHashMap extends HashMap<K,V> {
   @Override
   public V put(K key, V value) {
     if (key == null) { 
       throw new NullPointerException(); 
     }
     return super.put(key, value);
   }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:36:54.693

迭代您的哈希图并查找值：

```
Iterator it = map.entrySet().iterator();

while (it.hasNext()) {
        Map.Entry dataPair = (Map.Entry)it.next();
        System.out.println(dataPair.getKey() + " : " + dataPair.getValue());
} 
```

然后，如果您想删除或使用地图的键进行一些操作，那么，在 while 块内：

```
if (dataPair.getKey() == null) { //Todo: Do something here} 
```

# php - 如何使用 PHP 在内容中查找外来字符？

> ID：14987243
> 
> 赞同：2
> 
> 时间：2013-02-20T18:26:45.827
> 
> 标签：php

我在一张表中有列详细信息。该列以`HTML`格式存储电子邮件内容。列数据类型是 blob 。我要求搜索和查找任何包含非英文字符（即外语）的电子邮件内容。

该表有 51000 条记录。在 51000 条记录中，我只需要过滤非英文字符的电子邮件。它可能是 100 或更大。一旦我过滤了这些记录，我将使用谷歌翻译手动识别语言

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:41:30.637

在[MySQL](http://dev.mysql.com/doc/refman/5.1/en/regexp.html)中，它会是这样的：

```
SELECT foo 
FROM bar
WHERE somecolumn REGEXP '[^\x00-\x80]+' 
```

匹配不在 ASCII 范围 0-128 中的字符。

也可能：

`WHERE NOT HEX(COLUMN) REGEXP '^([0-7][0-9A-F])*$';`

`REGEXP '[^[.NUL.]-[.DEL.]]'`

`REGEXP '[^ -~]'`.

您需要根据需要调整模式。

这里还展示了一种新颖的方法： [如何在 MySQL 中找到非 ASCII 字符？](https://stackoverflow.com/questions/401771/how-can-i-find-non-ascii-characters-in-mysql)

`WHERE columnToCheck <> CONVERT(columnToCheck USING ASCII)`

# ruby-on-rails - 在 Rails 视图中将变量分配给用户输入

> ID：14987244
> 
> 赞同：2
> 
> 时间：2013-02-20T18:26:47.573
> 
> 标签：ruby-on-rails, ruby

在我看来，用户需要使用 collection_select 输入一些数据。

我知道可以`params[]`在控制器中访问数据。

但是我如何访问用户选择了一个值之后的值呢？

这就是我想要做的（不起作用）：

```
<%= f.collection_select :photo_type, Upload::PHOTOTYPE, :to_s, :to_s, :include_blank => false, :id => "phototype"%>
<%= f.hidden_field :photo_id, :value => Photo.find_by_type(params[:photo_type]).id %> 
```

`:photo_type`我的问题是如何访问`collection_select`？

**编辑**

我曾尝试使用 jQuery，但我不知道如何将 js 变量导出到视图：

```
<script type="text/javascript">
    $("#phototype").change(function() {
        var phototype = $('#phototype').val()
    });
 </script> 
```

**更新**

我的数据库中有两个表：

表格1：`photos`

1.  ID
2.  photo_type_id（参考表中`id`）`photo_types`

表 2：`photo_types`

1.  ID
2.  照片类型

用户可以从下拉菜单中选择照片类型，我想通过用户输入`photo_type_id`在`photo_types`表格中找到 ，然后将 插入`photo_type_id`到`photos`表格中

根据codeit，我改变了我的控制器是这样的：

```
def create
    @photo = photo.new(params[:photo])
    photo_type_id = PhotoType.find_by_type(params[:photo_type]).id
    respond_to do |format|
      if @photo.save
        format.html { redirect_to @photo, notice: 'photo was successfully created.' }
        format.json { render json: @photo, status: :created, location: @photo }
      else
        format.html { render action: "new" }
        format.json { render json: @photo.errors, status: :unprocessable_entity }
      end
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:39:47.033

我认为您正在使用`hidden_field`将价值发送给下一个操作。为什么不在控制器动作中做同样的事情：

```
 def create
    @photo = Photo.new(params[:photo])
    @photo.photo_type_id = PhotoType.find_by_type(params[:photo][:photo_type]).id
    respond_to do |format|
      if @photo.save
        format.html { redirect_to @photo, notice: 'photo was successfully created.' }
        format.json { render json: @photo, status: :created, location: @photo }
      else
        format.html { render action: "new" }
        format.json { render json: @photo.errors, status: :unprocessable_entity }
      end
    end
  end 
```

看法：

```
 <%= f.collection_select :photo_type, Upload::PHOTOTYPE, :to_s, :to_s, :include_blank => false, :id => "phototype"%> 
```

**建议**：标准做法是避免在视图中查询。

# regex - Perl - 如何将转义序列放入字符串？

> ID：14987247
> 
> 赞同：1
> 
> 时间：2013-02-20T18:26:54.120
> 
> 标签：regex, perl

我正在将一种形式的正则表达式转换为与 Perl 兼容的正则表达式。我需要替换所有出现的`%s`to `\s`，所以我正在做：

```
$s =~ s/(?<!%)%s/\s/g; 
```

但它给了我错误：`Unrecognized escape \s passed through at ....`. 实际上我知道问题出在哪里，所以我可能无法将一些未知的转义序列转换为字符串。但是我该如何绕过这个东西呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:30:55.950

您只需要转义 \，例如：

```
$s =~ s/(?<!%)%s/\\s/g; 
```

例如

```
my $s = "this is a %s test with two %s sequences, the last one here %%s not changed";
$s =~ s/(?<!%)%s/\\s/g;
print "$s\n"; 
```

印刷

```
this is a \s test with two \s sequences, the last one here %%s not changed 
```

（不确定您是否需要 %%s 最终只是 %s，如果需要，则需要稍作调整或第二个正则表达式来做到这一点）。

# unix - UNIX 共享库可以合并到一个库中吗？

> ID：14987258
> 
> 赞同：2
> 
> 时间：2013-02-20T18:27:26.853
> 
> 标签：unix, shared-libraries

我正在试验我自己的 BSD 或 Linux 发行版。我想以对最终用户有意义的方式组织系统文件。我希望他们能够访问系统，而不会出现 *nixes 留下的所有文件混乱。

有没有办法将多个动态库合并到一个文件中而不会丢失动态链接？我将有权访问所有源文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:10:17.607

它可能与系统相关，但至少对于 ELF（Linux 使用的可执行格式）来说，这是不可能的。使用 ELF，共享库有点像可执行文件：它们是链接过程的最终产品，并非旨在分解或重新链接到不同的排列中。

如果您拥有进入一堆共享库的所有组件的源代码，我想您可以将它们全部链接到一个巨大的共享库中，但您可以使用目标文件 ( `*.o`) 或存档库 ( `*.a`) 作为输入产生这样的图书馆。

正如评论中提到的那样，不太可能有充分的理由想要真正做到这一点。

# git - Git over HTTPS 可以执行 ls-list 但不能通过 HTTP 代理进行克隆

> ID：14987261
> 
> 赞同：1
> 
> 时间：2013-02-20T18:27:33.710
> 
> 标签：git, curl, https, proxy, msysgit

这是一个常见的问题/问题，但是我遇到的问题与其他问题略有不同。我正在尝试通过我的 http 代理在工作中使用 git。我已经在 git 中配置了代理设置：

```
C:\Program Files (x86)\Git\bin>git config --global -l
http.proxy=https://c172635b4:password@p01.proxy.local:8080 
```

当我发出 git ls-remote [https://eric@git.assembla.com/myproj.git](https://eric@git.assembla.com/myproj.git)时，它会要求我输入密码并提供预期的结果。这证实了 git 正在通过代理正确地进行身份验证。

但是，当我尝试执行 git clone 时，出现以下错误。

```
error: RPC failed; result=22, HTTP code = 0
fatal: The remote end hung up unexpectedly 
```

我已经使用 GIT_CURL_VERBOSE=1 运行它来查看日志，并且我能够看到它正确地对 NTLM 代理进行身份验证，直到结束：

```
< HTTP/1.1 407 Proxy Authentication Required
< Proxy-Authenticate: NTLM TlRMTVNTUAACAAAABgAGADgAAAA1goniA432smdf3mwAAAAAAAAAALAAsAA+AAAABgByFwAAAA9SAEUAUwACAAYAUgBFAFMAAQAYAFcAUwBQAEkAQwBCAEMAQQBBAEEAMAAxAAQAHAByAGUAcwAuAGIAbgBnAGYALgBsAG8AYwBhAGwAAwA2AFcAUwBQAEkAQwBCAEMAQQBBAEEAMAAxAC4AcgBlAHMALgBiAG4AZwBmAC4AbABvAGMAYQBsAAUAHAByAGUAcwAuAGIAbgBnAGYALgBsAG8AYwBhAGwABwAIAGq6JY+ND84BAAAAAA==
< Cache-Control: no-cache
< Pragma: no-cache
< Content-Type: text/html; charset=utf-8
< Proxy-Connection: Keep-Alive
< Set-Cookie: BCSI-CS-dcfa3879f83cfd49=2; Path=/
< Connection: Keep-Alive
< Content-Length: 3742
< 
* Ignore 3742 bytes of response-body
* NTLM send, close instead of sending 2531 bytes
* Received HTTP code 407 from proxy after CONNECT
* About to connect() to proxy p01.proxy.local port 8080 (#0)
*   Trying 172.31.132.18... * connected
* Connected to p01.proxy.local (172.31.132.18) port 8080 (#0)
* Establish HTTP proxy tunnel to git.assembla.com:443
* Proxy auth using NTLM with user 'c172635b4'
* Server auth using Basic with user 'eric'
> CONNECT git.assembla.com:443 HTTP/1.1
Host: git.assembla.com:443
Proxy-Authorization: NTLM TlRMTVNTUAADAAAAGAAYAIIAAAAYABgAmgAAAAYABgBYAAAAEAAQAF4AAAAUABQAbgAAABAAEACyAAAANYKI4gYBsR0AAAAPN9Y0OSiIbF7a4dr8yIqv9WwAYgBnAGMANgAxADIANwAxAGIANAAyAFUAQQAxADMAOAAxAEQAUwA1ADKgzMJlkKLlAAAAAAAAAAAAAAAAAAAAAHVtirzD6urrzJLWZ73HGWxFUEd926He985LMc+KepdWBDDgQQBESv8=
User-Agent: git/1.7.10.5997.gaa4aa
Proxy-Connection: Keep-Alive
Content-Type: application/x-git-upload-pack-request
Accept: application/x-git-upload-pack-result
Content-Encoding: gzip

< HTTP/1.1 407 Proxy Authentication Required
< Proxy-Authenticate: NTLM
* Authentication problem. Ignoring this.
< Cache-Control: no-cache
< Pragma: no-cache
< Content-Type: text/html; charset=utf-8
< Proxy-Connection: close
< Set-Cookie: BCSI-CS-dcfa3879f83cfd49=2; Path=/
< Connection: close
< Content-Length: 3742
< 
* Closing connection #0
* HTTP response code said error 
```

我在跑步：

```
git version 1.7.10.msysgit.1

curl 7.21.1 (i686-pc-mingw32) libcurl/7.21.1 OpenSSL/0.9.8r zlib/1.2.3
Protocols: dict file ftp ftps http https imap imaps ldap ldaps pop3 pop3s rtsp smtp smtps telnet tftp
Features: Largefile NTLM SSL SSPI libz 
```

[我确实在SO](https://stackoverflow.com/questions/12979720/git-over-https-can-ls-list-but-cannot-clone)上找到了另一个帖子，这与该问题的重复尽可能接近，但那里没有公认的解决方案，也没有任何适用的建议。

有人对如何进一步调试问题和/或使其正常工作有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T20:35:19.530

在尝试了多个版本的 Curl 和/或 git 之后，我终于安装了一个本地代理服务器并通过那里隧道 git。我最终使用了[cntlm](http://cntlm.sourceforge.net/)，但有一些不同的方法可以工作。

我仍然不知道为什么 curl 我的代理服务器有问题，但是使用 cntlm 作为中间人可以正常工作。

# solr - 我如何进行只能找到名字和姓氏的查询

> ID：14987263
> 
> 赞同：0
> 
> 时间：2013-02-20T18:27:41.730
> 
> 标签：solr

问题是这样的：我有一个列（名为 customername），其中包含示例“JOHN LENARD SMITH”等名称。

所以我想进行一个查询，它将获取所有名字为“JOHN”和姓氏为“SMITH”的名字；第二个名字无关紧要，所以我会放 * 通配符。

还有一个更大的问题：如果用户写“JOHN LENARD SMITH”，我应该能够找到这个确切的人

我尝试过的：

1\. 我输入了字段 text_ws 类型并测试了以下查询： 问题是这样的：我有一个列（命名名称），其中包含示例“Иван Кирилов Петров”、“Нина Семова Мариножа”等名称。

所以我想进行一个查询，它将获取所有名字为“Иван”和姓氏“Петров”的名字；第二个名字无关紧要，所以我会放 * 通配符。

还有一个更大的问题：如果用户写“Иван Кирилов Петров”，我应该能够找到这个确切的人

我尝试过的：

我制作了字段 text_ws 类型并测试了以下查询：

```
q=cust_name:JOHN*SMITH

q=cust_name:/JOHN.*SMITH/ 
```

没有任何效果！我绝望了，我想我永远不会解决这个任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:17:12.067

由于您正在使用该`text_ws`字段，因此您需要在查询中包含空格，以便 Solr 可以将查询拆分为与索引值匹配的术语。对于您的 JOHN SMITH 示例，以下内容应该有效：

```
 q=cust_name:JOHN * SMITH 
```

如果您要查找名称中任何地方出现的 JOHN 或 SMITH，您也可以只使用以下内容。但是根据示例，听起来位置对您很重要。

```
 q=cust_name:JOHN SMITH 
```

此外，在查询中使用保留空格将使对 JOHN LENARD SMITH 的搜索也能正常工作。

```
 q=cust_name:JOHN LENARD SMITH 
```

最后，我建议将[LowerCaseTokenizerFactory](http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters#solr.LowerCaseTokenizerFactory)添加到您的`text_ws`字段中，以便将术语作为小写进行索引和搜索，否则由于大小写差异，搜索`John * Smith`将不匹配。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T18:36:34.560

让用户在三个单独的字段中输入名称。连接结果。如果有任何空格，请用通配符替换。

# shared-libraries - Xcode 4.6 架构 armv7 的未定义符号与静态库相关联

> ID：14987268
> 
> 赞同：2
> 
> 时间：2013-02-20T18:27:56.533
> 
> 标签：shared-libraries, static-libraries, armv7, undefined-symbol, xcode4.6

在我将 xcode 更新到 4.6 后，我目前遇到了一个问题。

一开始，我遇到了很多链接错误。在其他帖子的帮助下，我能够解决它们。但是，每当我解决了前一个问题时，总会出现新的问题。

现在，当我尝试在具有发布模式的设备上构建游戏时，我被困在“架构 armv7 的未定义符号”（发布和调试模式适用于模拟器，而调试模式适用于设备）。我已经在网上研究过这个问题，但是没有一个解决方案可以解决我的情况。这就是为什么我想开始一个新职位。

让我详细解释一下情况：

1.  所有错误都发生在调用库中的方法时。
2.  我的库在之前的架构 armv7 上运行良好（xcode 4.5）
3.  项目文件中架构的当前值为“标准 (armv7, armv7s)
4.  Current Architecture 的当前值为“armv7 armv7s armv6”

这是一个示例错误：

尽管我只显示了与 libReceiptVerification.multi.a 相关的错误，但错误实际上发生在其他库中。

// ***** ** *** ** *** ** *** ** *****从这一行开始***** ** *** ** *** ** *** ******

架构 armv7 的未定义符号：

“_OBJC_CLASS_$_NSMutableOrderedSet”，引用自：libarclite_iphoneos.a(arclite.o) 中的 objc-class-ref

“_CFStringCreateWithBytes”，引用自：libReceiptVerification.multi.a(JSONKit.o) 中的 -[JKSerializer serializeObject:options:encodeOption:block:delegate:selector:error:] libReceiptVerification.multi.a(JSONKit.o) 中的 _jk_cachedObjects

“_CFStringCreateWithBytesNoCopy”，引用自：-[JKSerializer serializeObject:options:encodeOption:block:delegate:selector:error:] in libReceiptVerification.multi.a(JSONKit.o)

“_CFDataSetLength”，引用自：libReceiptVerification.multi.a(JSONKit.o) 中的 __NSStringObjectFromJSONString

// ***** ** *** ** *** ** *** ** *** ****在这里结束***** ** *** ** *** ******

那么，有人对这个问题有任何线索吗？提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-07T06:49:07.680

我有同样的问题通过设置解决

`Implicitly link Objective-C Runtime Support`至`NO`

您可以在 Project->Build Settings->Apple LLVM Compiler 4.2-Language 下找到它。

或者`Implicitly link Objective-C Runtime Support`在 project->Build Settings 中搜索

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:14:49.000

检查 libarclite、JSONKit 和其他所有内容的库目标，并确保它们也具有为其发布版本设置的相同架构值。

此外，对于发布目标，“仅构建活动架构”被选中为否。

# bash - 比较 shell 脚本中各种形式的数字

> ID：14987269
> 
> 赞同：1
> 
> 时间：2013-02-20T18:27:57.073
> 
> 标签：bash

我将把两个数字作为字符串检索到变量 A 和 B 中：

A 将采用以下形式：

> “10”或“0x0A”或“0x0a”

换句话说，A 将是十进制或十六进制数（带有 0x 前缀）。

B 将采用以下形式：

> “image-000A”或“image-000a”

B 将始终是“image-”，后跟 4 个十六进制数字。

我需要比较两个数值并测试 B > A。如何在 shell 脚本中执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:42:12.523

只需将十六进制数乘以 1，即可将其转换为十进制数。

```
rojo@pico:~$ t=0x0a
rojo@pico:~$ echo $t
0x0a
rojo@pico:~$ echo $(( $t * 1 ))
10 
```

从图像中提取十六进制值稍微复杂一些，但仍以相同的方式工作。

```
rojo@pico:~$ t=image-000a
rojo@pico:~$ echo $t
image-000a
rojo@pico:~$ echo $(( 0x${t##image-} * 1 ))
10 
```

`${t##image-}`脱衣舞`image-`，`$t`离开`000a`。_

# wpf - 如何在代码隐藏中为 Storyboard.TargetProperty="OpacityMask.Viewbox" 创建属性路径？

> ID：14987275
> 
> 赞同：0
> 
> 时间：2013-02-20T18:28:05.140
> 
> 标签：wpf, silverlight, wpf-controls

我正在尝试使用 WPF 来学习如何使用 codebehind 为 opacitymask 的 viewbox 的大小设置动画，在 xaml 中是这样的

```
<Storyboard>
    <RectAnimation Storyboard.TargetProperty="OpacityMask.Viewbox"
                   From="-1,-1,3,3" To="0.49,0.49,0.02,0.02" Duration="0:0:0.5"/>
</Storyboard> 
```

它工作得很好。现在我试图在后面的代码中做到这一点，但我不知道为属性路径放什么，我试过了

```
Storyboard.SetTargetProperty(animation, new PropertyPath(OpacityMask.ViewBoxProperty)); 
```

但它给出了错误。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:47:42.403

这是[TileBrush.Viewbox](http://msdn.microsoft.com/en-us/library/system.windows.media.tilebrush.viewbox.aspx)属性：

```
Storyboard.SetTargetProperty(animation, new PropertyPath(TileBrush.ViewboxProperty)); 
```

或者

```
Storyboard.SetTargetProperty(animation, new PropertyPath("Viewbox")); 
```

您还需要设置动画目标对象：

```
Storyboard.SetTarget(animation, element.OpacityMask); 
```

* * *

您当然也可以将元素本身设置为动画目标，并使用与 XAML 中相同的属性路径：

```
Storyboard.SetTarget(animation, element);
Storyboard.SetTargetProperty(animation, new PropertyPath("OpacityMask.Viewbox")); 
```

# javascript - AngularJS重复部分中多次调用的函数

> ID：14987277
> 
> 赞同：7
> 
> 时间：2013-02-20T18:28:07.123
> 
> 标签：javascript, angularjs

我遇到了一个问题，我想绑定到 ng-repeat 循环内的函数的输出。我发现每个项目调用该函数两次，而不是我期望的一次。这是 ng-repeat 部分（注意末尾的 calcRowTotal() 调用）：

```
<tr ng-repeat="row in timesheetRows">
    <td>
        <select ng-model="row.categoryID">
            <option ng-repeat="category in categories" value="{{category.id}}">
                {{category.title}}
            </option>
        </select>
    </td>
    <td ng-repeat="day in row.dayValues">
        <input type="text" ng-model="day.hours" />
    </td>
    <td>{{calcRowTotal($index, row)}}</td>
</tr> 
```

calcRowTotal() 函数如下所示：

```
$scope.calcRowTotal = function (index, row) {
    console.log('calcRowTotal - Index: ' + index);
    var total = 0;
    for (var i = 0; i < row.dayValues.length; i++) {
        var num = parseFloat(row.dayValues[i].hours);
        if (isNaN(num)) {
            num = 0;
            //this.dayValues[i].hours = 0;
        }
        total += num;
    }
    //updateDayTotals();
    return total;
} 
```

下面显示了正在迭代的项目之一的示例：

```
{
    categoryID: 2,
    dayValues: [
                    { day: $scope.days[0], hours: 5 },
                    { day: $scope.days[1], hours: 0 },
                    { day: $scope.days[2], hours: 3 },
                    { day: $scope.days[3], hours: 0 },
                    { day: $scope.days[4], hours: 2 },
                    { day: $scope.days[5], hours: 5 },
                    { day: $scope.days[6], hours: 8 }
    ]
} 
```

我在控制台中看到以下内容（我正在循环的集合中当前有两个项目）：

```
calcRowTotal - Index: 0 
calcRowTotal - Index: 1 
calcRowTotal - Index: 0 
calcRowTotal - Index: 1 
```

我当然可以创建一个“rowTotal”属性，但更愿意绑定到上面显示的函数提供的“实时”数据。希望重复是我所缺少的一些简单的东西，所以我感谢任何关于为什么我看到重复的反馈。附带说明一下，随着其中一个文本框中的数据发生变化，我也需要更新行总计，因此我可能需要一种不同的方法。不过，有兴趣首先了解这种特殊情况....绝对不希望重复，因为可能会有很多行。

这是一个例子：http: [//jsfiddle.net/dwahlin/Y7XbY/2/](http://jsfiddle.net/dwahlin/Y7XbY/2/)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-20T18:31:08.653

这是因为您在这里绑定到一个函数表达式：

```
<td>{{calcRowTotal($index, row)}}</td> 
```

它的作用是什么，它迫使对每个项目、每个摘要重新评估该功能。为了防止这种情况，您需要做的是预先计算该值并将其放入您的数组中。

一种方法是在您的阵列上设置一个手表：

```
$scope.$watch('timesheetRows', function(rows) {
   for(var i = 0; i < value.length; i++) {
     var row = rows[i];
     row.rowTotal = $scope.calcRowTotal(row, i);
   }
}, true); 
```

然后你所要做的就是绑定到那个新值：

```
<td>{{row.rowTotal}}</td> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-09T09:33:37.893

这完全是因为您按照@Ben Lesh 的建议绑定到函数表达式。不知何故，使用 $watch 也让我执行了两次相同的功能。我们使用的避免双重执行的解决方案是使用 ng-init 进行函数调用。只需创建一个以函数返回为值的初始化变量，并在您的表达式中使用它，如下所示：

```
<tr ng-repeat="row in timesheetRows" ng-init="rowTotalValue=calcRowTotal($index, row)">
<td>
    <select ng-model="row.categoryID">
        <option ng-repeat="category in categories" value="{{category.id}}">
            {{category.title}}
        </option>
    </select>
</td>
<td ng-repeat="day in row.dayValues">
    <input type="text" ng-model="day.hours" />
</td>
<td>{{rowTotalValue}}</td> 
```

这对我有用，因为我传递了行的单个属性。虽然没有尝试过 $index 。但我认为它应该工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:34:16.030

我最近实际上遇到了类似的问题。

最终遍历每个子对象并将总数绑定到模型。应该不是问题，尤其是当您仅将总数用于显示目的时。

例如。

```
// Reset to Zero
$scope.rowTotal = 0;

jquery.each($scope.row, function(key, value) {
 $scope.totalRow += value.hours;
}); 
```

并遍历每一行。

# node.js - phantomjs npm install 在代理后面失败

> ID：14987278
> 
> 赞同：2
> 
> 时间：2013-02-20T18:28:15.577
> 
> 标签：node.js, npm, phantomjs

尝试在公司代理后面通过[npm 包装器安装](https://github.com/Obvious/phantomjs)[PhantomJS 。](http://phantomjs.org/)我已经设置了 http_proxy 和 https_proxy 环境变量，以便 npm 本身能够与注册表通信：

```
export http_proxy=my-company-proxy.com:80
export https_proxy=my-company-proxy.com:80 
```

但是当谈到 phantomjs 的 node install.js 阶段时，我得到了一个 Protocol not supported 错误：

```
http.js:1711
    throw new Error('Protocol:' + options.protocol + ' not supported.');
      ^
Error: Protocol:my-company-proxy.com: not supported. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:28:15.577

问题是 phantomjs npm 包装代码假定代理信息是一个完整的 url，而不仅仅是一个主机名。这解决了这个问题：

```
export http_proxy=http://my-company-proxy.com:80
export https_proxy=http://my-company-proxy.com:80 
```

npm、git 等在任何一种格式下都可以正常工作，但对于这个特定的包，它需要 HTTP_PROXY 才能拥有完整的 URL。

更新：[这个相关问题](https://github.com/Obvious/phantomjs/issues/54)已经解决，现在它可以使用与 npm 本身相同的配置系统（例如，如果你使用 npm config 命令）而不是依赖于环境变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-05T09:06:04.543

这对我有用。

1.  以管理员身份打开终端
2.  导航到您的项目文件夹并输入以下命令
3.  `sudo npm config set proxy http://proxy_host:port -g`然后
4.  `sudo npm config set https-proxy http://proxy_host:port -g`

希望这对你有用。祝你好运。

# jquery - Ascensor.js 非常基本的实现

> ID：14987280
> 
> 赞同：0
> 
> 时间：2013-02-20T18:28:19.323
> 
> 标签：jquery, jquery-plugins

为了熟悉 Asensor.js，我开始了这个非常小的项目，但我无法让它工作。

在我的项目目录中，我有一个 html 文件（如下所示）和 5 个应该是相应插件的 javascript 文件（我在这些文件中复制并粘贴了原始代码）。javascript 文件是：JQuery、Ascensor.js、一个 migrate 插件、一个 easing 插件和一个 scrollTo 插件。

这是html文件：

```
<!DOCTYPE html>
<html>
<head><title>Ascensor</title></head>
<script src="http://kirkas.ch/ascensor/js/libs/modernizr-2.5.3.min.js"></script>
<body>

<!-- HTML -->

<nav id="navigationMap">
    <ul>
        <li><a class="ascensorLink ascensorLink1 ascensorLinkActive">floor1</a></li>
        <li><a class="ascensorLink ascensorLink2">floor2</a></li>
    </ul>
</nav>

<div id="ascensorBuilding" style="position: absolute; width: 1436px; height: 100%;">

    <section class="ascensorFloor" id='ascensorFloor1' style="position: absolute; width: 1436px; height: 100%; left: 0px;">
        <p>floor 1 content here</p>
    </section>

    <section class="ascensorFloor" id='ascensorFloor2' style="position: absolute; width: 1436px; height: 100%; left: 1436px;">
        <p>floor 2 content here</p>
    </section>

</div>

<!-- ascensor.js -->

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/ascensor.js"></script>
<script type="text/javascript" src="js/migrate.js"></script>
<script type="text/javascript" src="js/easing.js"></script>
<script type="text/javascript" src="js/scrollTo.js"></script>

<script type="text/javascript">

  $(document).ready(function() {
    $('#ascensorBuilding').ascensor();

</script>

<!-- CSS -->

<style type="text/css">
    #ascensorFloor1 {
        background: red;
    }
    #ascensorFloor2 {
        background: blue;
    }
</style>

</body>
</html> 
```

当我在浏览器中打开 html 文件时，会显示所有静态内容，但是当我单击导航栏链接时，什么都没有。

任何想法如何解决这一问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:02:58.880

您在 js 运行后复制并粘贴到绝对定位的元素中。试试这个

```
 <!DOCTYPE html>
<html>
<head><title>Ascensor</title></head>
<script src="http://kirkas.ch/ascensor/js/libs/modernizr-2.5.3.min.js"></script>
<body>

<!-- HTML -->

<nav id="navigationMap">
    <ul>
        <li><a class="ascensorLink ascensorLink1"></a></li>
        <li><a class="ascensorLink ascensorLink2"></a></li>
    </ul>
</nav>

<div id="ascensorBuilding">
    <section>
       <p>floor 1 content here</p>
    </section>

    <section>
       <p>floor 2 content here</p>
    </section>
</div>

<!-- ascensor.js -->

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/ascensor.js"></script>
<script type="text/javascript" src="js/migrate.js"></script>
<script type="text/javascript" src="js/easing.js"></script>
<script type="text/javascript" src="js/scrollTo.js"></script>

<script type="text/javascript">

  $(document).ready(function() {
    $('#ascensorBuilding').ascensor();
});
</script>

<!-- CSS -->

<style type="text/css">
    #ascensorFloor1 {
        background: red;
    }
    #ascensorFloor2 {
        background: blue;
    }
</style>

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T09:22:39.603

看我仍然有严重的问题，实现这个脚本，但据我所知，我缺少scrollto.js，所以我稍后会这样做，但对你来说，你可能想在括号中添加你的选项`$('#ascensorBuilding').ascensor();`。 ..

意味着如果你想命名你的楼层，你写下一行：

```
$('#ascensorBuilding').ascensor({AscensorFloorName:"Home | Implementation | HTML | Jquery | CSS | Smartphone | End"}); 
```

希望对大家有所帮助，尝试研究一下[Ascensor.js 的 github 页面中的示例页面的代码](https://github.com/kirkas/Ascensor.js/tree/master/examples)

另请注意，我将尝试完全理解代码并写一篇关于它的博客文章:)

祝你好运！

# java - 如何在 Android 中由 ScheduledExecutorService 生成的两个线程之间传递数据？

> ID：14987281
> 
> 赞同：1
> 
> 时间：2013-02-20T18:28:25.827
> 
> 标签：java, android, concurrency, producer-consumer, java.util.concurrent

我正在尝试通过`ScheduledExecutorService`. 因此，我创建了一个从网站加载数据的生产者工作线程和过滤此数据的消费者线程。这是演示我的问题的代码片段：

```
public void RunPeriodicBackgroundTasks() {
  private final ScheduledExecutorService backgroundTaskExecutor_ = Executors.newScheduledThreadPool(2);
backgroundTaskExecutor_.scheduleAtFixedRate(new Runnable() {
    @Override
    public void run() {
   LinkedHashMap<String, Object> result_ = new LinkedHashMap<String, Object>(lowLevelNetworkOperation_.executeServerCommand(DASHBOARD_INBOX_SENT_COMMAND, params)); 
    }
},1 ,3, SECONDS);
    //AND NOW I CREATE ANOTHER THREAD for the second task
   backgroundTaskExecutor_.scheduleAtFixedRate(new Runnable() {

    @Override
    public void run() {
        //HERE I WANT To USE result_

    }
}, 1,3, SECONDS);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:55:32.097

您可以在此处使用 ConcurrentLinkedQueue。

在你的第`run`一种方法中。

```
private final ConcurrentLinkedQueue<Map.Entry<String,Object>> queue = new ConcurrentLinkedQueue<Map.Entry<String,Object>>();
public void run(){
   LinkedHashMap<String, Object> result_ = new LinkedHashMap<String, Object>(lowLevelNetworkOperation_.executeServerCommand(DASHBOARD_INBOX_SENT_COMMAND, params)); 

   for(Map.Entry<String,Object> entry: result_.entrySet()){
      queue.offer(entry);
   }
} 
```

在你的另一场比赛中

```
public void run(){
   List<Map.Entry> currentEntries = new ArrayList<Map.Entry>();
   Map.Entry  entry = null;
   while((entry = queue.poll())!=null){
       currentEntries.add(entry);
   }
   //use it now
} 
```

现在您会注意到这违反了生产者/消费者模式，因为您的两个线程是按固定速率安排的。这意味着它会一遍又一遍地定期唤醒/运行/睡眠。ConcurrentLinkedQueue 不会阻塞，因此如果 Queue 中没有元素，它将返回 null。

如果您希望它成为真正的生产者/消费者，您将改为安排第一个任务，但第二个任务将等待队列信号唤醒。

```
final BlockingQueue<Map.Entry>queue = new LinkedBlockingQueue<Map.Entry>();

//This is your second run
public void run(){
    while(!Thread.currentThread().isInterrupted()){
        Map.Entry current = queue.take(); //suspend here if the queue is empty until it 1 or more elements
        //use current
    }
} 
```

# javascript - Javascript 在本地主机上运行良好，在服务器上不起作用

> ID：14987283
> 
> 赞同：0
> 
> 时间：2013-02-20T18:28:32.510
> 
> 标签：javascript

我很困惑为什么我的脚本可以在我的笔记本电脑上工作，但是当我把它放在服务器上时却不能工作：

```
<HTML>
<HEAD>
    <TITLE>Cubic Feet</TITLE>
    <SCRIPT LANGUAGE="text/javascript">

    function Calculate()
    {
        var qty1 = document.getElementById('q1').value;
        var len1 = document.getElementById('l1').value;
        var width1 = document.getElementById('w1').value;
        var height1 = document.getElementById('h1').value;
        var cube1 = (qty1*(len1*width1*height1))/1728;
        var ss1 = cube1/53.3;

        var qty2 = document.getElementById('q2').value;

        if (qty2 =="") {
            qty2=0
            cube2=0
            ss2=0;
        }

        var len2 = document.getElementById('l2').value;
        var width2 = document.getElementById('w2').value;
        var height2 = document.getElementById('h2').value;
        var cube2 = (qty2*(len2*width2*height2))/1728;
        var ss2 = cube2/53.3;

        var qty3 = document.getElementById('q3').value;

        if (qty3=="") {
            qty3=0;
            cube3=0;
            ss3=0;
        }

        var len3 = document.getElementById('l3').value;
        var width3 = document.getElementById('w3').value;
        var height3 = document.getElementById('h3').value;
        var cube3 = (qty3*(len3*width3*height3))/1728;
        var ss3 = cube3/53.3;  

        var totcube = cube1 + cube2 + cube3;
        var totskid = ss1 + ss2+ss3;
        var tq = parseInt(qty1) + parseInt(qty2)+parseInt(qty3);
        var trlft = totskid * 2;

        var form = document.forms[0];

        form.cuft1.value = cube1.toFixed(2);
        form.sk1.value = ss1.toFixed(1);
        form.cuft2.value = cube2.toFixed(2);
        form.sk2.value = ss2.toFixed(1);
        form.cuft3.value = cube4.toFixed(2);
        form.sk3.value = ss4.toFixed(1);

        form.totalcuft.value = totcube.toFixed(2); 
        form.sktotal.value = totskid.toFixed(1);
        form.totalqty.value = tq.toFixed(1);
        form.feet.value = trlft.toFixed(1);

    }

    function ClearForm(form)
    {
        form.q1.value = "";
        form.l1.value = "";
        form.w1.value = "";
        form.h1.value = "";
        form.cuft1.value = "";
        form.q2.value = "";
        form.l2.value = "";
        form.w2.value = "";
        form.h2.value = "";
        form.cuft2.value = "";
        form.q3.value = "";
        form.l3.value = "";
        form.w3.value = "";
        form.h3.value = "";
        form.cuft3.value = "";
        form.totalcuft.value = "";
        form.sktotal.value = "";
        form.totalqty.value = "";
        form.feet.value = "";
    }

    // end of JavaScript functions -->
    </SCRIPT>
</HEAD>

<BODY>

<FORM NAME="Calculator" METHOD="post">

Enter the quantity (number of pieces, skids, boxes, whatever) and their dimensions (length, width, height) in INCHES, then click Calculate.

<P><INPUT TYPE="button" VALUE="Calculate" name="AddButton"  onClick="Calculate(this.form.q1.value, this.form.h1.value, this.form.w1.value, this.form.l1.value, this.form)">
<INPUT TYPE="button" VALUE="Clear" name="ClearButton" onClick="ClearForm(this.form)">

<p>
<table>
    <tr>
        <td> Container 1 Qty <input type="TEXT" id="q1" value="" size="5"></td>
        <td> Length <input type="TEXT" id="l1" value="" size ="5"></td>
        <td> Width <input type="TEXT" id="w1" value="" size = "5"></td>
        <td> Height <input type="TEXT" id="h1" value="" size = "5"></td>
        <td> Cu.Ft. <input type="TEXT" id="cuft1" value="" size = "5"></td> 
        <td> Skid spots <input type="TEXT" id="sk1" value="" size ="5"></td>
    </tr>
    <tr>
        <td> Container 2 Qty <input type="TEXT" id="q2" value="" size="5"></td>
        <td> Length <input type="TEXT" id="l2" value="" size="5"></td>
        <td> Width <input type="TEXT" id="w2" value="" size="5"></td>
        <td> Height <input type="TEXT" id="h2" value="" size="5"></td>
        <td> Cu.Ft. <input type="TEXT" id="cuft2" value="" size="5"></td>
        <td> Skid spots <input type="TEXT" id="sk2" value="" size="5"></td>
    </tr>
    <tr>
        <td> Container 3 Qty <input type="TEXT" id="q3" value="" size="5"></td>
        <td> Length <input type="TEXT" id="l3" value="" size="5"></td>
        <td> Width <input type="TEXT" id="w3" value="" size="5"></td>
        <td> Height <input type="TEXT" id="h3" value="" size="5"></td>
        <td> Cu.Ft. <input type="TEXT" id="cuft3" value="" size="5"></td>
        <td> Skid spots <input type="TEXT" id="sk3" value="" size="5"></td>
    </tr>
    <tr>

        <td>Totals:</td>
    </tr>
    <tr>
        <td> Total Qty <input type="TEXT" id="totalqty" value="" size="5"></td>
        <td> Cu.Ft. <input type="TEXT" id="totalcuft" value="" size="5"></td>
        <td> Skid spots <input type="TEXT" id="sktotal" value="" size="5"></td>
        <td> Linear Feet <input type="TEXT" id="feet" value="" size="5"></td>
    </tr>
</table>
</FORM>
</BODY>
</HTML> 
```

什么可能导致它无法在服务器上运行？

没有错误消息。当我将其上传到服务器后单击计算时，不会产生答案。在本地完美运行。

谢谢你看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:32:06.767

替换`cube4`为`cube3`, `ss4`with `ss3`, `text/javascript`with`javascript`并放在`<!--`后面`<SCRIPT>`。

以下是这些替换后您应该得到的：

```
<HTML>
<HEAD>
<TITLE>Cubic Feet</TITLE>
<SCRIPT LANGUAGE="javascript">
<!--
function Calculate()
{
var qty1 = document.getElementById('q1').value;
var len1 = document.getElementById('l1').value;
var width1 = document.getElementById('w1').value;
var height1 = document.getElementById('h1').value;
var cube1 = (qty1*(len1*width1*height1))/1728;
var ss1 = cube1/53.3;

var qty2 = document.getElementById('q2').value;

if (qty2 =="") {
   qty2=0
   cube2=0
   ss2=0;
}

var len2 = document.getElementById('l2').value;
var width2 = document.getElementById('w2').value;
var height2 = document.getElementById('h2').value;
var cube2 = (qty2*(len2*width2*height2))/1728;
var ss2 = cube2/53.3;

var qty3 = document.getElementById('q3').value;

if (qty3=="") {
   qty3=0;
   cube3=0;
   ss3=0;
}

var len3 = document.getElementById('l3').value;
var width3 = document.getElementById('w3').value;
var height3 = document.getElementById('h3').value;
var cube3 = (qty3*(len3*width3*height3))/1728;
var ss3 = cube3/53.3;

var totcube = cube1 + cube2 + cube3;
var totskid = ss1 + ss2+ss3;
var tq = parseInt(qty1) + parseInt(qty2)+parseInt(qty3);
var trlft = totskid * 2;

var form = document.forms[0];

form.cuft1.value = cube1.toFixed(2);
form.sk1.value = ss1.toFixed(1);
form.cuft2.value = cube2.toFixed(2);
form.sk2.value = ss2.toFixed(1);
form.cuft3.value = cube3.toFixed(2);
form.sk3.value = ss3.toFixed(1);

form.totalcuft.value = totcube.toFixed(2);
form.sktotal.value = totskid.toFixed(1);
form.totalqty.value = tq.toFixed(1);
form.feet.value = trlft.toFixed(1);

}

function ClearForm(form)
{
form.q1.value = "";
form.l1.value = "";
form.w1.value = "";
form.h1.value = "";
form.cuft1.value = "";
form.q2.value = "";
form.l2.value = "";
form.w2.value = "";
form.h2.value = "";
form.cuft2.value = "";
form.q3.value = "";
form.l3.value = "";
form.w3.value = "";
form.h3.value = "";
form.cuft3.value = "";
form.totalcuft.value = "";
form.sktotal.value = "";
form.totalqty.value = "";
form.feet.value = "";
}

// end of JavaScript functions -->
</SCRIPT>
</HEAD>

<BODY>

<FORM NAME="Calculator" METHOD="post">

Enter the quantity (number of pieces, skids, boxes, whatever) and their dimensions (length, width, height) in INCHES, then click Calculate.

<P><INPUT TYPE="button" VALUE="Calculate" name="AddButton"  onClick="Calculate(this.form.q1.value, this.form.h1.value, this.form.w1.value, this.form.l1.value, this.form)">
<INPUT TYPE="button" VALUE="Clear" name="ClearButton" onClick="ClearForm(this.form)">

<p>
<table>
<tr>
<td> Container 1 Qty <input type="TEXT" id="q1" value="" size="5"></td>
<td> Length <input type="TEXT" id="l1" value="" size ="5"></td>
<td> Width <input type="TEXT" id="w1" value="" size = "5"></td>
<td> Height <input type="TEXT" id="h1" value="" size = "5"></td>
<td> Cu.Ft. <input type="TEXT" id="cuft1" value="" size = "5"></td>
<td> Skid spots <input type="TEXT" id="sk1" value="" size ="5"></td>
</tr>
<tr>
<td> Container 2 Qty <input type="TEXT" id="q2" value="" size="5"></td>
<td> Length <input type="TEXT" id="l2" value="" size="5"></td>
<td> Width <input type="TEXT" id="w2" value="" size="5"></td>
<td> Height <input type="TEXT" id="h2" value="" size="5"></td>
<td> Cu.Ft. <input type="TEXT" id="cuft2" value="" size="5"></td>
<td> Skid spots <input type="TEXT" id="sk2" value="" size="5"></td>
</tr>
<tr>
<td> Container 3 Qty <input type="TEXT" id="q3" value="" size="5"></td>
<td> Length <input type="TEXT" id="l3" value="" size="5"></td>
<td> Width <input type="TEXT" id="w3" value="" size="5"></td>
<td> Height <input type="TEXT" id="h3" value="" size="5"></td>
<td> Cu.Ft. <input type="TEXT" id="cuft3" value="" size="5"></td>
<td> Skid spots <input type="TEXT" id="sk3" value="" size="5"></td>
</tr>
<tr>

<td>Totals:</td>
</tr>
<tr>
<td> Total Qty <input type="TEXT" id="totalqty" value="" size="5"></td>
<td> Cu.Ft. <input type="TEXT" id="totalcuft" value="" size="5"></td>
<td> Skid spots <input type="TEXT" id="sktotal" value="" size="5"></td>
<td> Linear Feet <input type="TEXT" id="feet" value="" size="5"></td>
</tr>
</table>
</FORM>
</BODY>
</HTML> 
```

这在 Firefox 中对我来说很好。

# c++ - 调用结构内的成员函数指针之一

> ID：14987285
> 
> 赞同：3
> 
> 时间：2013-02-20T18:28:43.750
> 
> 标签：c++

我有以下结构

```
typedef struct      s_ins
{
  std::string       item;
  int               extended;
  void              (CPU::*fc)(std::list<std::string> &list>;
}                  t_ins; 
```

然后我声明一个数组，我的令牌需要在一个函数中重定向

```
t_ins     g_ins[] =                                                                                       
{                                                                                                         
  {"push", 1, &CPU::ins_push},                                                                            
  {"pop", 0, &CPU::ins_pop},                                                                              
  {"dump", 0, &CPU::ins_dump},                                                                            
  {"assert", 1, &CPU::ins_assert},                                                                        
  {"add", 0, &CPU::ins_add},                                                                              
  {"sub", 0, &CPU::ins_sub},                                                                              
  {"mul", 0, &CPU::ins_mul},                                                                              
  {"div", 0, &CPU::ins_div},                                                                              
  {"mod", 0, &CPU::ins_mod},                                                                              
  {"print", 0, &CPU::ins_print},                                                                          
  {"exit", 0, &CPU::ins_exit},                                                                           
  {"", 0, 0}                                                                                             
}; 
```

最后这就是我所说的（在 CPU 函数成员中）：

```
(*g_ins[i].fc)(tokens); 
```

我得到的是：

```
cpu.cpp: In member function ‘void CPU::get_instruction(std::list<std::basic_string<char> >&)’:
cpu.cpp:40:16: error: invalid use of unary ‘*’ on pointer to member 
```

我尝试了许多其他方式来调用它，但我仍然有一些错误。我是这样想的：我用 g_ins[i].fc 访问我的函数，告诉他这是一个带 * 的函数成员指针，然后传递我的参数。我在函数成员指针的同一类的函数中使用它，所以我不需要之前有一个对象，因为它是'this'对吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-20T18:31:49.057

成员函数需要一个对象才能被调用。通过指向成员函数的指针调用时，您需要指定该对象，即使您从该类的另一个成员函数调用它也是如此。你想要的是：

```
(this->*g_ins[i].fc)(tokens); 
```

这使用`->*`运算符来调用由`g_ins[i].fc`on表示的 CPU 的成员函数`this`。

或者，如果函数不依赖于任何对象状态，您可以制作它们`static`并使用普通函数指针。`fc`现在将被定义为：

```
void (*fc)(std::list<std::string> &list>); 
```

你会这样称呼它：

```
g_ins[i].fc(tokens); 
```

# coldfusion - 显示问题两次

> ID：14987288
> 
> 赞同：2
> 
> 时间：2013-02-20T18:28:47.167
> 
> 标签：coldfusion, coldfusion-9

任何人都可以查看此代码并告诉我其中有什么问题吗？我不明白为什么它会显示两次问题。

这是根据其问题类型显示问题的代码，我的意思是它将查看问题文件夹以匹配问题类型模板，然后将其与问题一起显示。这是显示调查问题的代码。

```
<cfoutput>
 <cfset step = 0 />
 <form class="form form-horizontal" action="#buildUrl(action='survey.savesurveyresults',querystring='surveyId=#rc.surveyid#')#" method="post">
  <input type="hidden" name="id" value="0">
  <input type="hidden" name="fksurveyid" value="#rc.surveyId#">
  <input type="hidden" name="fkquestionid" value="#rc.questions.id#"> 
  <fieldset> 
   <cfloop query="rc.questions">
    <cfset step ++ />
    <cfset answer = "" />
    <cfmodule template="../question/#rc.questions.template#/display.cfm" step="#step#" question="#rc.questions.question#" template1="#rc.questions.template#"  fkquestionid="#rc.questions.id#" answer="#answer#" required="#rc.questions.required#" result="result#step#"/>
   </cfloop>

   <div class="form-actions">
    <button type="submit" name="submit" class="btn btn-success">Submit answers</button>
   </div>  
  </fieldset>
 </form>
</cfoutput> 
```

这是我的 display.cfm 来查看问题及其问题类型，如 truefalse 或 yes 或 no。

```
<cfparam name="attributes.yesno" default="false">
 <cfoutput>
  <p>#attributes.step#) #attributes.question# <cfif attributes.required EQ 1><strong>*    </strong></cfif></p>
  <div class="answers">
   <cfif attributes.yesno>
    <input type="radio" name="answer" id="answer" value="yes"<cfif attributes.answer is "yes">Checked</cfif>><label for="truefalse">Yes</label><br>
    <input type="radio" name="answer" id="answer" value="no"<cfif attributes.answer is "No">Checked</cfif>><label for="truefalse">No</label>        
   <cfelse>
    <input type="radio" name="answer" id="answer" value="true"<cfif attributes.answer is "true">Checked</cfif>><label for="truefalse">True</label><br>
    <input type="radio" name="answer" id="answer" value="False"<cfif attributes.answer is "False">Checked</cfif>><label for="truefalse">False</label> 
   </cfif>
  </div>
</cfoutput> 
```

这是列出问题记录的查询。

```
<cfquery name="list">
SELECT
questions.id,
questions.question,
questions.rank,
questions.required,
questiontypes.name as questiontype,
questiontypes.template as template,
surveys.name as surveysname,
surveys.thankyoumsg as thankyoumsg
FROM questions
 INNER JOIN questiontypes ON questions.fkquestiontypeid = questiontypes.id
 INNER JOIN surveys ON questions.fksurveyid = surveys.id
WHERE questions.fksurveyid = <cfqueryparam cfsqltype="cf_sql_bigint" value="#arguments.surveyid#">
</cfquery> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:52:21.947

这是让我咬过几次的东西。我一直很重视结束标签。但这是一种会受到伤害的情况。如果您不了解 cfmodule 的行为，则很难调试。正如我上面的帖子所述，如果您关闭 cfmodule 标签，它将执行两次。这是因为它被视为与自定义标签相同。在某些情况下，您可能希望在第一次运行标签时处理它的一部分，而在它完成后处理其余部分。您可以在 cfmodule 页面的 thisTag 范围内访问 ExecutionMode。没有结束标签，它只是在 thisTag.ExecutionMode = Start 模式下运行。如果关闭它，它会在结束模式下再次运行标签。如果您没有对 cfmodule 代码中的 ExecutionMode 做任何事情，那么整个事情将再次运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-20T19:02:44.930

使用`<cfmodule>`标签时，您需要记住，如果您包含结束`</cfmodule>`标签**或**关闭开始标签，ColdFusion 将调用该标签两次`<cfmodule ... />`。

如[cfmodule 文档页面](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec1912c-7fce.html)所述：

> 如果您为 cfmodule 指定结束标记，ColdFusion 将调用您的自定义标记，就好像它同时具有开始和结束标记一样。有关更多信息，请参阅开发 ColdFusion 应用程序中的处理结束标记。

[在开发 ColdFusion 应用程序中处理结束标签](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec0b2e1-7ff0.html#WSc3ff6d0ea77859461172e0811cbec22c24-7d8f)

为了避免此功能，请不要关闭您的`<cfmodule>`标签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:51:43.900

我明白了，我必须不要像`<cfmodule />`.

# c# - 托管 .net 的 C++ 程序将对象从 C++ 公开到 C#

> ID：14987294
> 
> 赞同：1
> 
> 时间：2013-02-20T18:29:06.637
> 
> 标签：c#, c++, scripting

我正在探索使用 .net 作为我的程序的脚本语言的想法。

我在互联网上找到了很多示例，这些示例展示了如何托管 .net，然后从 .net 的 c++ 调用函数。

但我也需要另辟蹊径，从 c# 中的这段代码开始，我需要能够从这个 c# 脚本创建/调用 c++ 的对象，所以我需要公开函数/对象以从 C# 控制它。

我该怎么做？

显示我在说什么的简单示例我将我的 c++ 方法称为“CreateGUI”。它会调用 .net 代码：“InitializeGUI”，这个“InitializeGUI”需要检查一个对象（例如，纹理）是否在 C++ 中实例化。

有人能帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:38:48.110

如果您使用托管 C++，您可以创建一个托管 C++ 组件，该组件可以从您的 C# 代码中调用。如果您使用非托管 C++，您可以创建一个 C++ COM 组件并通过 C# 通过 RCW（运行时可调用包装器）机制使用它，或者您可以创建一个 C++ dll 并通过 PInvoke 从 C# 调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:45:39.967

您还可以研究 Mono，它[明确旨在嵌入](http://www.mono-project.com/Embedding_Mono)并运行任何已编译的 .NET 程序集，这意味着 C#、VB.NET 甚至 F# 的全部功能都将可用。

# oauth - 要遵循哪个 OAuth 流程？（Google Apps 脚本和 Google Fusion Tables API）

> ID：14987295
> 
> 赞同：3
> 
> 时间：2013-02-20T18:29:09.570
> 
> 标签：oauth, google-apps-script, google-fusion-tables

我正在学习如何与 OAuth 交互。我使用融合表作为数据库的后端，然后使用谷歌应用程序脚本与该数据库交互。应用程序脚本的一部分将运行定时触发器，而其他部分将作为 webApp 发布。我遇到了其他一些 OAuth 问题（请参阅下面的线程链接），但这个问题更为基础。在阅读 Google API OAuth 文献时，它描述了不同的 OAuth 流程，我不知道我的程序是哪一个。我的应用程序是“Web 服务器应用程序”、“客户端”、“服务帐户”还是什么。

Google API OAuth 信息：[https](https://developers.google.com/accounts/docs/OAuth2) ://developers.google.com/accounts/docs/OAuth2 其他线程：[Getting Google Apps Script to Authorize Fusion Table API](https://stackoverflow.com/questions/14970059/getting-google-apps-script-to-authorize-fusion-table-api)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-16T04:36:12.287

首先，您安装触发器以在特定时间运行特定功能这一事实与您应该使用哪个 Oauth Flow 无关。
Oauth 用于允许您的应用程序的用户授予您的应用程序访问某些通常只有他们才能访问的资源的权限。
当您在应用脚本中包含某些 API 调用时，Google Apps 会自动向用户显示一个对话框，要求“授权”代表他们使用这些资源。因此，在您将 App 脚本用作 Fusion Table 前端的用例中，您不需要使用 Oauth 来让用户授予权限。您可以发布您的脚本以“充当”用户或脚本所有者。

# c# - 在 C# 中从 SQLite DB 中删除行后，Reader 会抛出“未设置对象引用..”

> ID：14987302
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:29:19.453
> 
> 标签：c#, database, forms, sqlite

目前功能是基本的。我可以相当简单地添加行，当我这样做时我更新了一个列表框，但是如果我删除一行，或者在没有初始行的情况下启动程序（来自插入查询），SQLiteDataReader 会抛出这个异常：

```
Object reference not set to an instance of an object. 
```

它非常奇特，如果我在没有初始行（在创建数据库时添加）的情况下启动程序，就会引发错误。每次我启动程序并且数据库不是新创建的时候，它也会发生。如果我创建数据库，关闭程序，重新打开程序并连接到数据库，阅读器会给出该错误。

这是一些代码。

```
 SQLiteConnection db = new SQLiteConnection("Data Source=test.sqlite;Version=3;");
    SQLiteCommand cmd;
    query = "SELECT * FROM Table";
    db.Open();

    SQLiteDataReader reader = cmd.ExecuteReader(); //This is the line that throws
    while (reader.Read())
    {
       //read and do work. (This section has been tested and works 
    }
    reader.Close()
    db.Close(); 
```

可能值得注意的是，如果表刚刚创建，查询工作正常。只有在删除了一行，或者程序在没有创建新数据库的情况下重新启动时才会弹出此错误。似乎无法理解它为什么这样做。看起来不太合乎逻辑，但我想这是一个愚蠢的错误。

所有帮助表示赞赏。

*参考：使用 System.Data.SQLite.dll*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:31:18.150

你永远不会初始化 cmd。它是空的。

尝试

```
query = "SELECT * FROM Table";
SQLiteCommand cmd = new SQLiteCommand(query, db); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T18:32:18.267

您没有实例化`cmd`.

```
SQLiteConnection db = new SQLiteConnection("Data Source=test.sqlite;Version=3;");
    SQLiteCommand cmd = db.CreateCommand();
    cmd.CommandType = CommandType.Text;
    query = "SELECT * FROM Table";
    command.CommandText = query;
    db.Open();

    SQLiteDataReader reader = cmd.ExecuteReader(); //This is the line that throws
    while (reader.Read())
    {
       //read and do work. (This section has been tested and works 
    }
    reader.Close()
    db.Close(); 
```

# ios6 - iPhone 5 特定的屏幕尺寸问题

> ID：14987303
> 
> 赞同：0
> 
> 时间：2013-02-20T18:29:21.027
> 
> 标签：ios6, iphone-5, xcode4.6

我正在开发应用程序，需要支持 iPhone 5 的 4 英寸屏幕尺寸。我最初设计了该应用程序并通过针对 iPhone 3.5 英寸（视网膜和非视网膜显示器）的 XCode 4.6 模拟器运行，然后从模拟器中切换到 iPhone 5。令我惊讶的是，在我的几个 UIButtons 之外，我在屏幕底部看到了 1 英寸的空间。我必须在 iPhone 5 模拟器上滚动才能查看我的 UIButton。我应该在这里做什么来支持所有屏幕尺寸并使其在所有设备上看起来都一样？此外，我的应用程序仅支持所有设备（包括 iPad 的所有修订版）的纵向模式，我根本不使用情节提要。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:50:49.547

你不能让 3.5 英寸屏幕和 4 英寸屏幕看起来相同，因为它们并不相同。但是你可以让它看起来更好。如果没有看到代码，很难说出你遇到了什么问题。但我会尽我最大的努力来帮助你。

如果此视图是您添加为 rootViewController 的 viewController 的一部分，那么无论屏幕大小如何，它都应该自行扩展以填满整个屏幕。但是，如果这是 viewController 视图中的子视图，则应确保该视图占据全屏。人们通常将视图的框架硬编码为任意数字，如下所示：

```
[view setFrame:CGRectMake(0,0,320,460)]; 
```

但是，这在 3.5 和 4 英寸屏幕之间是不可移植的。你想这样做：

```
[view setFrame:self.view.bounds];
[view setFrame:self.view.window.bounds];  //sometimes i use this instead

//set autoresizing
view.autoresizingMask = UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth; 
```

除此之外，您还可以使用自动调整大小将组件锚定到屏幕底部，或随着屏幕高度调整大小。

请参阅这篇文章，了解[如何使用 Interface Builder 在固定高度的页眉和页脚之间拉伸和锚定中央视图？](https://stackoverflow.com/questions/9352511/how-can-i-stretch-and-anchor-a-central-view-between-a-fixed-height-header-and-fo)

# objective-c - 清除 UITextField 中的文本 - Objective c - Cocoa

> ID：14987304
> 
> 赞同：0
> 
> 时间：2013-02-20T18:29:21.550
> 
> 标签：objective-c, cocoa-touch

谁能让我知道如何在目标 c 的 UITextField 中引入清晰的选项（'X' 符号）？我附上了一张图片供您阅读。我希望图像中显示的“x”符号清除文本。![在此处输入图像描述](../Images/612ac2f13cd13bc692dea00cee7b7ede.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:31:56.470

```
 myUITextField.clearButtonMode = UITextFieldViewModeWhileEditing; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T18:32:21.927

如果您使用的是 Interface Builder，当您选择文本字段时，在属性检查器（右侧）中，应该有一个`Clear Button`. 其中一个选项是“编辑时出现”，以及其他一些选项。

在代码中，请参阅@Shashank 的答案。

# android - Android ActivityInstrumentationTestCase2 NullPointerException 获取上下文

> ID：14987309
> 
> 赞同：1
> 
> 时间：2013-02-20T18:29:28.930
> 
> 标签：android, android-testing

我有一个 ActivityInstrumentationTestCase2 并且我没有运气获得测试的上下文。

```
package com.vsnetworks.vsnmedia.test;

import org.json.JSONObject;

import android.app.Activity;
import android.content.Context;
import android.test.ActivityInstrumentationTestCase2;

import com.vsnetworks.vsnmedia.MainActivity;
import com.vsnetworks.vsnmedia.VSWebViewClient;

public class TestMimeTypes extends ActivityInstrumentationTestCase2<MainActivity> {

Activity activity;
Context context;

public TestMimeTypes() {
    super(MainActivity.class);
}

public void setUp() throws Exception {
    super.setUp();
    activity = getActivity();
    context = activity.getApplicationContext();
}

public void test() {
    String external = context.getExternalFilesDir(null).toString();
} 
```

这是我得到的错误：

```
 [exec] com.vsnetworks.vsnmedia.test.TestMimeTypes:INSTRUMENTATION_RESULT: shortMsg=java.lang.NullPointerException
 [exec] INSTRUMENTATION_RESULT: longMsg=java.lang.NullPointerException: Unable to start activity ComponentInfo{com.vsnetworks.vsnmedia/com.vsnetworks.vsnmedia.MainActivity}: java.lang.NullPointerException
 [exec] INSTRUMENTATION_CODE: 0 
```

我认为这是与上下文相关的，因为如果我执行以下操作：

```
Context context = this.getInstrumentation().getTargetContext(); 
```

我明白了（第 37 行是 context.getExternal 行）

```
 [exec] com.vsnetworks.vsnmedia.test.TestMimeTypes:
 [exec] Error in test:
 [exec] java.lang.NullPointerException
 [exec]     at com.vsnetworks.vsnmedia.test.TestMimeTypes.test(TestMimeTypes.java:37)
 [exec]     at java.lang.reflect.Method.invokeNative(Native Method)
 [exec]     at android.test.InstrumentationTestCase.runMethod(InstrumentationTestCase.java:214)
 [exec]     at android.test.InstrumentationTestCase.runTest(InstrumentationTestCase.java:199)
 [exec]     at android.test.ActivityInstrumentationTestCase2.runTest(ActivityInstrumentationTestCase2.java:192)
 [exec]     at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:190)
 [exec]     at android.test.AndroidTestRunner.runTest(AndroidTestRunner.java:175)
 [exec]     at android.test.InstrumentationTestRunner.onStart(InstrumentationTestRunner.java:555)
 [exec]     at android.app.Instrumentation$InstrumentationThread.run(Instrumentation.java:1584)
 [exec] 
 [exec] Test results for InstrumentationTestRunner=..E
 [exec] Time: 0.292
 [exec] 
 [exec] FAILURES!!!
 [exec] Tests run: 2,  Failures: 0,  Errors: 1 
```

我也尝试了以下所有相同的错误，即使在一些地方也使用 getInstrumentation.waitForIdleSync() （我在另一个线程中看到）。我尝试创建新的 MainActivity() 对象并从那里获取上下文以及 getActivity()，同样的问题。

```
context = getInstrumentation().getContext();
context = getInstrumentation().getTargetContext();
context = activity.getApplicationContext();
context = activity.getBaseContext(); 
```

那么我到底做错了什么？

编辑 1 - 看来这个问题只发生在模拟器上。如果我使用真实设备运行测试，它们都会通过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T23:40:55.657

我想这就是你要找的：

```
public void testExternalFilesDir() {
    Activity activity = getActivity();
    assertNotNull(activity);
    File file = activity.getExternalFilesDir(null);
    assertNotNull("No external storage available", file);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T16:01:05.500

实际上有两个问题我必须解决。首先是我的主项目中包含了一个外部库。运行测试时，未正确添加外部库。创建 main 时，它在尝试使用该库时静默失败。为了解决这个问题，我在这里遵循了各种解决方案：

[当测试项目在 libs 目录中有 jar 时，无法构建和运行使用“ant create test-project”创建的 android 测试项目](https://stackoverflow.com/questions/2472059/cant-build-and-run-an-android-test-project-created-using-ant-create-test-proje)

这让我想到了这个：

[使用带有库项目的 ant 进行 Android 单元测试](https://stackoverflow.com/questions/8595006/android-unit-test-using-ant-with-library-project?lq=1)

[使用带有库项目 R18 的 ant 进行 Android 单元测试](https://stackoverflow.com/questions/10126358/android-unit-test-using-ant-with-library-project-r18)

然而，我的修复略有不同。我没有在这些项目中使用覆盖的 -compile 标记，而是将 /tools/ant 中的 build.xml 编译复制到测试的 build.xml 中并添加

```
 <classpath>
                <!-- steff: we changed one line here !-->
                <fileset dir="${tested.android.library.reference.1}/bin/" includes="*.jar"/>
                <fileset dir="${extensible.libs.classpath}" includes="*.jar" />
            </classpath> 
```

在与第二个答案相同的位置。

第二个问题是模拟器尝试使用的 SD 卡无法正常工作。我不确定确切的原因，但创建一个新的似乎可以解决问题。

```
<sdk>/tools/mksdcard <size> <path>

<sdk>/emulator -avd <name> -sdcard <path.from.above> 
```

# filepicker.io - 文件选择器前端裁剪器

> ID：14987312
> 
> 赞同：0
> 
> 时间：2013-02-20T18:29:43.470
> 
> 标签：filepicker.io

> 为了更轻松地处理用户内容，我们启用了图像后处理。这样，无论用户从云端或其本地设备上传什么类型的文件，您都可以确保它的大小完全正确。要转换图像，请获取文件选择器 url 并附加 /convert，以及指定要更改的查询参数。查看文档»

filepicker.io 在其首页上展示了一个裁剪工具的示例。可以将其内置到选择器本身中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T01:15:22.020

我们已经讨论过将其构建到 iOS 的上传体验中，但认为该功能最好在上传后一步完成。我们首页上的演示是使用[JCrop](http://deepliquid.com/content/Jcrop.html)完成的，在某些时候我们会将演示作为 jquery 插件或类似插件开源。

# ruby-on-rails - 上传视频时缩略图样式的回形针 ffmpeg 错误

> ID：14987314
> 
> 赞同：3
> 
> 时间：2013-02-20T18:29:47.773
> 
> 标签：ruby-on-rails, paperclip

我正在使用 Paperclip 3.4 和 Paperclip-ffmpeg 0.9.4。这是我在 video.rb 中的代码：

```
has_attached_file :file,
                :url => '/:class/:id/:style.:extension', 
                :styles => { :thumb => { :geometry => "100x100#", :format => 'jpg', :time => 10 } }, 
                :processors => [:ffmpeg], :swallow_stderr => false 
```

当我尝试上传视频时，错误是

```
Command 'ffmpeg -ss 10 -i :source -y -vf scale=100:-1,pad=100:100:0:12.5:black -vframes 1 -f image2 :dest' returned 1\. Expected 0 
```

如果我注释掉或删除样式行，则视频已正确上传。我尝试更改宝石的版本，但无济于事。

关于为什么样式哈希会导致问题的任何指针？

**编辑** 用 '>' 替换 '#' 似乎可以解决问题，但我不确定是什么原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T20:57:47.197

在官方回形针 gem[文档](https://github.com/thoughtbot/paperclip/wiki/Thumbnail-Generation)（在“调整大小选项”部分下）中，您可以找到以下描述：

```
Default behavior is to resize the image and maintain aspect ratio (i.e. the :medium version of a 300×150 image will be 200×100). Some commonly used options are:

trailing #, thumbnail will be centrally cropped, ensuring the requested dimensions.
trailing >, thumbnail will only be modified if it is currently larger requested dimensions. (i.e. the :small thumb for a 120×80 original image will be unchanged) 
```

[正如它所指出的那样，您可以在此处](http://www.imagemagick.org/Usage/resize/)查看更多选项。

# sql - 如何在sql中重用子查询？

> ID：14987317
> 
> 赞同：17
> 
> 时间：2013-02-20T18:30:03.827
> 
> 标签：sql, sql-server, tsql, subquery

我有如下查询

```
select columns
from (select columns1
      from result_set
      where condition_common and condition1) as subset1
      join
      (select columns2
       from result_set
       where condition_common and condition2) as subset2 
      on subset1.somekey = subset2.somekey 
```

我想以某种方式重用

```
select columns
from result_set
where condition_common 
```

我把上面的查询过分简化了，但实际上上面的选择是庞大而复杂的。我不想承担确保两者同步的负担

我没有任何以编程方式重用它的方法。排除了 T-SQL。我只能写简单的查询。这是应用程序限制。

有没有办法在单个语句中重用相同的子查询

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-20T18:31:36.793

如果您使用的是 SQL Server 2005+，请使用[公用表表达式(CTE)：](http://technet.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)

```
with cte as (
      select columns
      from result_set
      where condition_common
    )
select columns
from cte  as subset1
      join
      cte as subset2 
         on subset1.somekey = subset2.somekey
where otherconditions 
```

# c++ - 如果我不“删除”会怎样？

> ID：14987318
> 
> 赞同：2
> 
> 时间：2013-02-20T18:30:06.673
> 
> 标签：c++, memory-management

如果我在执行期间分配了一些内存但从不调用`delete`并且程序终止会发生什么？操作系统会释放我分配的所有内存并且不会“浪费”任何内存吗？或者在计算机重新启动之前我会丢失一部分内存吗？

显然，我知道良好的编码习惯是确保删除不需要的内容，所以我不只是问“有什么意义`delete`”；我只是想知道我的 RAM 中发生了什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T18:33:30.603

**从概念上讲，**您会泄漏内存。

**但在实践中**，如果你有一个健全的操作系统，它很可能会在你的过程之后清理干净。但不要依赖它，真的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-20T18:39:22.227

这一切都取决于您的程序做了什么，以及它使用了多少内存——在任何给定时间和整个运行时。

例如，您编写了一个邮件服务器，它分配内存来保存它收到的每封电子邮件。但它实际上并不需要存储通过它的每封电子邮件。因此，在接收和转发电子邮件几天后，邮件服务器无法分配更多内存，它已经消耗了所有可用的内存字节 - 但它实际上并没有对该内存做任何有用的事情，因为不再使用电子邮件- 他们已经被处理了。

另一方面，如果我们编写我们的邮件服务器程序，例如分配 1 MB 的缓冲区来读取一封电子邮件，处理它，当它完成时，内存会被重新用于另一封电子邮件，那么释放它就没有什么意义了那个记忆，永远。

如果我们编写一个程序，只读取一个文件，将整个文件加载到内存中，当它为统计目的计算所有字母时，打印统计信息并退出，这是否分配了大量内存并没有真正的意义事情。

当然，所有这些都假设调用`new`只是简单地分配内存。如果对象的构造函数做了更复杂的事情，比如打开文件、获取锁或其他事情，那么如果不调用析构函数，那么很快就会发生各种坏事。

操作系统将（对于常用的操作系统，如 Linux、macOS、iOS、其他 Unix 系统、Windows、DOS、OS/2 等）释放应用程序使用的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:35:11.653

当进程终止时，操作系统会释放分配给进程的所有内存。因此，一旦程序终止，您的程序分配的内存将被操作系统释放和回收。

# performance - PostgreSQL IN 运算符与子查询性能差

> ID：14987321
> 
> 赞同：35
> 
> 时间：2013-02-20T18:30:34.857
> 
> 标签：performance, postgresql, rdbms, operator-keyword

为什么“IN”运算符与子查询一起使用时这么慢？

```
select * 
from view1 
where id in (1,2,3,4,5,6,7,8,9,10) 
order by somedata; 
```

在 9 毫秒内执行。

```
select * 
from view1 
where id in (select ext_id 
             from aggregate_table 
             order by somedata limit 10) 
order by somedata; 
```

在 25000 毫秒内执行，并且似乎对视图 ( `view1`) 使用顺序扫描，而不是像在第一个查询中那样对子查询返回的主键进行索引扫描。

子查询`select ext_id from aggregate_table order by somedata limit 10`在 0.1ms 内执行

所以第二个查询的缓慢是由顺序扫描引起的，顺序扫描`view1`是一个包含三个 UNION 和每个 UNION 中大约三个 JOINS 的视图。第一个 UNION 包含大约 1M 行，其他行少得多。与大约 100K 行的表连接。不过，这并不是那么相关，我只是想了解 IN 运算符的行为。

我想要完成的是获取子查询的结果（一组主键）并`view1`仅使用它们从复杂视图（）中选择数据。

我也不能用

```
select v1.* 
from view1 v1, 
     aggregate_table at 
where v1.id = at.ext_id 
order by at.somedata 
limit 10 
```

因为我不想对大连接进行排序`somedata`。我只想通过主键从视图中选择 10 个结果，然后只对这些进行排序。

问题是为什么 IN 运算符在我明确列出这些键时执行得很快，而当我使用返回完全相同的一组键的快速子查询时却如此缓慢？

**按要求解释分析**

第一个查询 -`select * from view1 where id in (1,2,3,4,5,6,7,8,9,10) order by somedata;`

```
 Sort  (cost=348.480..348.550 rows=30 width=943) (actual time=14.385..14.399 rows=10 loops=1)
    Sort Key: "india".three
    Sort Method:  quicksort  Memory: 30kB
  ->  Append  (cost=47.650..347.440 rows=30 width=334) (actual time=11.528..14.275 rows=10 loops=1)
        ->  Subquery Scan "*SELECT* 1"  (cost=47.650..172.110 rows=10 width=496) (actual time=11.526..12.301 rows=10 loops=1)
              ->  Nested Loop  (cost=47.650..172.010 rows=10 width=496) (actual time=11.520..12.268 rows=10 loops=1)
                    ->  Hash Join  (cost=47.650..87.710 rows=10 width=371) (actual time=11.054..11.461 rows=10 loops=1)
                            Hash Cond: (hotel.alpha_five = juliet_xray.alpha_five)
                          ->  Bitmap Heap Scan on sierra hotel  (cost=42.890..82.800 rows=10 width=345) (actual time=10.835..11.203 rows=10 loops=1)
                                  Recheck Cond: (four = ANY ('quebec'::integer[]))
                                ->  Bitmap Index Scan on seven  (cost=0.000..42.890 rows=10 width=0) (actual time=0.194..0.194 rows=10 loops=1)
                                        Index Cond: (four = ANY ('quebec'::integer[]))
                          ->  Hash  (cost=4.340..4.340 rows=34 width=30) (actual time=0.184..0.184 rows=34 loops=1)
                                ->  Seq Scan on six juliet_xray  (cost=0.000..4.340 rows=34 width=30) (actual time=0.029..0.124 rows=34 loops=1)
                    ->  Index Scan using charlie on juliet_two zulu  (cost=0.000..8.390 rows=1 width=129) (actual time=0.065..0.067 rows=1 loops=10)
                            Index Cond: (zulu.four = hotel.victor_whiskey)
        ->  Subquery Scan "*SELECT* 2"  (cost=4.760..97.420 rows=10 width=366) (actual time=0.168..0.168 rows=0 loops=1)
              ->  Hash Join  (cost=4.760..97.320 rows=10 width=366) (actual time=0.165..0.165 rows=0 loops=1)
                      Hash Cond: (alpha_xray.alpha_five = juliet_xray2.alpha_five)
                    ->  Nested Loop  (cost=0.000..92.390 rows=10 width=340) (actual time=0.162..0.162 rows=0 loops=1)
                          ->  Seq Scan on lima_echo alpha_xray  (cost=0.000..8.340 rows=10 width=216) (actual time=0.159..0.159 rows=0 loops=1)
                                  Filter: (four = ANY ('quebec'::integer[]))
                          ->  Index Scan using charlie on juliet_two xray  (cost=0.000..8.390 rows=1 width=128) (never executed)
                                  Index Cond: (zulu2.four = alpha_xray.victor_whiskey)
                    ->  Hash  (cost=4.340..4.340 rows=34 width=30) (never executed)
                          ->  Seq Scan on six uniform  (cost=0.000..4.340 rows=34 width=30) (never executed)
        ->  Subquery Scan "*SELECT* 3"  (cost=43.350..77.910 rows=10 width=141) (actual time=1.775..1.775 rows=0 loops=1)
              ->  Hash Join  (cost=43.350..77.810 rows=10 width=141) (actual time=1.771..1.771 rows=0 loops=1)
                      Hash Cond: (golf.alpha_five = juliet_xray3.alpha_five)
                    ->  Bitmap Heap Scan on lima_golf golf  (cost=38.590..72.910 rows=10 width=115) (actual time=0.110..0.110 rows=0 loops=1)
                            Recheck Cond: (four = ANY ('quebec'::integer[]))
                          ->  Bitmap Index Scan on victor_hotel  (cost=0.000..38.590 rows=10 width=0) (actual time=0.105..0.105 rows=0 loops=1)
                                  Index Cond: (four = ANY ('quebec'::integer[]))
                    ->  Hash  (cost=4.340..4.340 rows=34 width=30) (actual time=0.118..0.118 rows=34 loops=1)
                          ->  Seq Scan on six victor_kilo  (cost=0.000..4.340 rows=34 width=30) (actual time=0.007..0.063 rows=34 loops=1)
 Total runtime: 14.728 ms 
```

第二个查询 -`select * from view1 where id in (select ext_id from aggregate_table order by somedata limit 10) order by somedata;`

```
Sort  (cost=254515.780..254654.090 rows=55325 width=943) (actual time=24687.475..24687.488 rows=10 loops=1)
    Sort Key: "five".xray_alpha
    Sort Method:  quicksort  Memory: 30kB
  ->  Hash Semi Join  (cost=54300.820..250157.370 rows=55325 width=943) (actual time=11921.783..24687.308 rows=10 loops=1)
          Hash Cond: ("five".lima = "delta_echo".lima)
        ->  Append  (cost=54298.270..235569.720 rows=1106504 width=494) (actual time=3412.453..23091.938 rows=1106503 loops=1)
              ->  Subquery Scan "*SELECT* 1"  (cost=54298.270..234227.250 rows=1100622 width=496) (actual time=3412.450..20234.122 rows=1100622 loops=1)
                    ->  Hash Join  (cost=54298.270..223221.030 rows=1100622 width=496) (actual time=3412.445..17078.021 rows=1100622 loops=1)
                            Hash Cond: (three_victor.xray_hotel = delta_yankee.xray_hotel)
                          ->  Hash Join  (cost=54293.500..180567.160 rows=1100622 width=470) (actual time=3412.251..12108.676 rows=1100622 loops=1)
                                  Hash Cond: (three_victor.tango_three = quebec_seven.lima)
                                ->  Seq Scan on india three_victor  (cost=0.000..104261.220 rows=1100622 width=345) (actual time=0.015..3437.722 rows=1100622 loops=1)
                                ->  Hash  (cost=44613.780..44613.780 rows=774378 width=129) (actual time=3412.031..3412.031 rows=774603 loops=1)
                                      ->  Seq Scan on oscar quebec_seven  (cost=0.000..44613.780 rows=774378 width=129) (actual time=4.142..1964.036 rows=774603 loops=1)
                          ->  Hash  (cost=4.340..4.340 rows=34 width=30) (actual time=0.149..0.149 rows=34 loops=1)
                                ->  Seq Scan on alpha_kilo delta_yankee  (cost=0.000..4.340 rows=34 width=30) (actual time=0.017..0.095 rows=34 loops=1)
              ->  Subquery Scan "*SELECT* 2"  (cost=4.760..884.690 rows=104 width=366) (actual time=7.846..10.161 rows=104 loops=1)
                    ->  Hash Join  (cost=4.760..883.650 rows=104 width=366) (actual time=7.837..9.804 rows=104 loops=1)
                            Hash Cond: (foxtrot.xray_hotel = delta_yankee2.xray_hotel)
                          ->  Nested Loop  (cost=0.000..877.200 rows=104 width=340) (actual time=7.573..9.156 rows=104 loops=1)
                                ->  Seq Scan on four_india foxtrot  (cost=0.000..7.040 rows=104 width=216) (actual time=0.081..0.311 rows=104 loops=1)
                                ->  Index Scan using three_delta on oscar alpha_victor  (cost=0.000..8.350 rows=1 width=128) (actual time=0.077..0.078 rows=1 loops=104)
                                        Index Cond: (quebec_seven2.lima = foxtrot.tango_three)
                          ->  Hash  (cost=4.340..4.340 rows=34 width=30) (actual time=0.216..0.216 rows=34 loops=1)
                                ->  Seq Scan on alpha_kilo quebec_foxtrot  (cost=0.000..4.340 rows=34 width=30) (actual time=0.035..0.153 rows=34 loops=1)
              ->  Subquery Scan "*SELECT* 3"  (cost=4.760..457.770 rows=5778 width=141) (actual time=0.264..58.353 rows=5777 loops=1)
                    ->  Hash Join  (cost=4.760..399.990 rows=5778 width=141) (actual time=0.253..39.062 rows=5777 loops=1)
                            Hash Cond: (four_uniform.xray_hotel = delta_yankee3.xray_hotel)
                          ->  Seq Scan on whiskey four_uniform  (cost=0.000..315.780 rows=5778 width=115) (actual time=0.112..15.759 rows=5778 loops=1)
                          ->  Hash  (cost=4.340..4.340 rows=34 width=30) (actual time=0.117..0.117 rows=34 loops=1)
                                ->  Seq Scan on alpha_kilo golf  (cost=0.000..4.340 rows=34 width=30) (actual time=0.005..0.059 rows=34 loops=1)
        ->  Hash  (cost=2.430..2.430 rows=10 width=4) (actual time=0.303..0.303 rows=10 loops=1)
              ->  Subquery Scan "ANY_subquery"  (cost=0.000..2.430 rows=10 width=4) (actual time=0.092..0.284 rows=10 loops=1)
                    ->  Limit  (cost=0.000..2.330 rows=10 width=68) (actual time=0.089..0.252 rows=10 loops=1)
                          ->  Index Scan using tango_seven on zulu romeo  (cost=0.000..257535.070 rows=1106504 width=68) (actual time=0.087..0.227 rows=10 loops=1)
 Total runtime: 24687.975 ms 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-02-21T16:18:27.703

似乎我终于找到了解决方案：

```
select * 
  from view1 
  where view1.id = ANY(
                       (select array(select ext_id 
                                     from aggregate_table 
                                     order by somedata limit 10)
                       )::integer[]
                      ) 
  order by view1.somedata; 
```

在详细阐述了@Dukeling 的想法之后：

> 我怀疑 (1,2,3,4,5,6,7,8,9,10) 中的 id 可以优化，而 (select ...) 中的 id 不能优化，原因是 (1, 2,3,4,5,6,7,8,9,10) 是一个常量表达式，而 select 不是。

并将它们定位在更快的查询计划中

```
Recheck Cond: (id = ANY ('{1,2,3,4,5,6,7,8,9,10}'::integer[]))
Index Cond: (id = ANY ('{1,2,3,4,5,6,7,8,9,10}'::integer[])) 
```

这比问题中的第一个查询更快，大约 1.2 毫秒，现在它使用

```
Recheck Cond: (id = ANY ($1))
Index Cond: (id = ANY ($1)) 
```

和计划中的位图扫描。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T18:44:52.790

我怀疑`where id in (1,2,3,4,5,6,7,8,9,10)`可以优化而`where id in (select ...)`不能，原因是那`(1,2,3,4,5,6,7,8,9,10)`是一个常量表达式，而`select`不是。

怎么样：

```
WITH myCTE AS
(
  SELECT ext_id
  FROM aggregate_table
  ORDER BY somedata
  LIMIT 10
)
SELECT *
FROM myCTE
LEFT JOIN table1
  ON myCTE.ext_id = table1.id
ORDER BY somedata 
```

# c++ - 重载转换运算符模板

> ID：14987326
> 
> 赞同：18
> 
> 时间：2013-02-20T18:30:51.197
> 
> 标签：c++

考虑以下简单示例

```
struct C
{
    template <typename T> operator T () {return 0.5;}
    operator int () {return 1;}
    operator bool () {return false;}
};

int main ()
{
    C c;
    double x = c;
    std::cout << x << std::endl;
} 
```

使用 Clang 编译时，会出现以下错误

```
test.cpp:11:12: error: conversion from 'C' to 'double' is ambiguous
    double x = c;
           ^   ~
test.cpp:4:5: note: candidate function
    operator int () {return 1;}
    ^
test.cpp:5:5: note: candidate function
    operator bool () {return false;}
    ^
test.cpp:3:27: note: candidate function [with T = double]
    template <typename T> operator T () {return 0.5;}
                          ^
1 error generated. 
```

其他编译器会产生类似的错误，例如 GCC 和 Intel iclc

如果我删除`operator int`和`operator bool`. 它编译良好并按预期工作。如果只删除其中一个，即保留模板运算符并说`operator int`，则始终选择非模板版本。

我的理解是，只有当模板和非模板重载函数在它们完全匹配或都需要相同的转换顺序的意义上相等时，才会首选非模板版本。但是在这种情况下，编译器似乎没有将运算符模板视为完美匹配。并且当同时存在`bool`和`int`重载时，它自然会认为它们是模棱两可的。

总之，我的问题是，为什么在这种情况下，运算符模板不被认为是完美匹配的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-20T18:52:09.120

让我们将其分解为两个不同的问题：

**1\. 为什么会产生编译错误？**

```
struct C
{
    operator bool () {return false;}
    operator int () {return 1;}
}; 
```

由于`int`和`bool`都可以隐式转换为`double`，编译器无法知道它应该使用哪个函数。它可以使用两个功能，并且没有一个优先于另一个。

**2、为什么模板化的版本不完美？**

```
struct C
{
    template <typename T> operator T () {return 0.5;}
    operator int () {return 1;}
}; 
```

为什么`operator int()`在请求双精度时调用？

> 调用非模板函数是因为非模板函数在重载决议中具有优先权。（[重载函数模板](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/overloading_function_templates.htm)）

**编辑：** 我错了！正如 Yan Zhou 在他的评论中提到的那样，正如我提供的链接中所述，模板化函数中的完美匹配优先于非模板化函数。

我测试了你的代码（用 g++ 4.7.2 编译），它按预期工作：它返回`0.5`了，换句话说，使用了模板函数！

**EDIT2：** 我现在尝试使用clang，我可以重现您描述的行为。由于它在 gcc 中正常工作，这似乎是 clang 中的一个错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-20T21:26:11.230

这很有趣。有两种方法可以阅读第 13.3.3 节的关键部分。原始示例绝对应该调用函数模板，但删除其中一个非模板的版本可能会被认为是模棱两可的。

13.3.3：

> 如果对于所有参数*i*， ICS_i( ) 不是比 ICS_i( ) 更差的转换序列，则一个可行函数`F1`被定义为比另一个可行函数*更好*的函数，然后`F2`*`F1``F2`*
> 
>  **   对于某些参数*j*，ICS_j( `F1`) 是比 ICS_j( `F2`) 更好的转换序列，或者，如果不是，
>     
>     
> *   上下文是通过用户定义的转换（参见 8.5、13.3.1.5 和 13.3.1.6）`F1`进行的初始化，并且从比从返回类型到目标类型的标准转换序列更好的转换序列`F2`，或者，如果不是，
>     
>     
> *   `F1`是一个非模板函数并且`F2`是一个函数模板特化，或者，如果不是，
>     
>     
> *   `F1`和`F2`是函数模板特化，根据 14.5.6.2 中描述的部分排序规则，函数模板 for`F1`比模板 for 更特化。`F2`
>     
>     
> 
> 如果恰好有一个可行函数比所有其他可行函数更好，那么它就是重载决议选择的那个；否则调用格式不正确。*

 *在示例中，clang 正确识别了三个可行的候选函数集：

```
C::operator int()
C::operator bool()
C::operator double<double>() 
```

第三是功能模板专业化。（我不认为上面的语法是合法的，但你明白了：在重载决议的这一点上，它不被视为模板，而是作为具有明确函数类型的特化。）

此处参数的唯一隐式转换序列 (ICS1) 是隐式参数上的“左值`C`”与“ `C&`”完全匹配，因此不会产生影响。

这个例子正是第二个项目中描述的情况，所以返回的函数`double`明显优于其他两个。

这就是它变得奇怪的地方：通过非常字面的阅读，`operator int`也比模板专业化更好，因为第三个项目符号。“等一下，‘比’不应该是反对称的吗？你怎么能说`F1`比`F2`和`F2`比好`F1`？” 不幸的是，该标准没有明确说明任何此类内容。“第二颗子弹不是因为‘如果不是那个’短语而优先于第三颗子弹吗？” 是的，对于常数`F1`和`F2`。但是该标准并没有说满足第二个项目符号`(F1,F2)`会使第三个项目符号`(F2,F1)`不适用。

当然，由于`operator int`不优于`operator bool`，反之亦然，仍然存在“恰好一个可行的功能比所有其他可行的功能更好的功能”。

我并不完全赞同这种奇怪的阅读，除了可能将其报告为标准缺陷。这样做会产生奇怪的后果（比如*删除这个例子中**不是*最好的重载会使程序从格式良好变为模棱两可！）。我认为目的是在考虑第三个项目符号之前从两个方面考虑第二个项目符号。

这意味着应该通过重载决议选择函数模板，这是一个clang错误。*

# java - 如何识别哪些类型可以泛化？

> ID：14987327
> 
> 赞同：2
> 
> 时间：2013-02-20T18:30:54.000
> 
> 标签：java, generics

我知道基于对象的集合是泛型的主要候选者，并且已经在集合库中泛型。除此之外，一个类或接口应该具备哪些属性和行为才能使其成为泛化的候选者？为什么例如 `ThreadLocal`类或`AtomicReference`类被泛化？是什么导致了这个设计决策？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:37:50.623

需要为不同类型重用的类始终是泛型的候选者。例如`class Pair<U,V>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-20T18:38:03.747

如果一个类可以与各种其他类具有相同的关系，那么该类是泛化的一个很好的候选者。集合类是通用的，因为关系“包含”可以应用于任何对象类。`Comparable`和接口是通用的`Comparator`，因为“可以比较”的关系可以应用于许多不同的对象（尽管实际上这仅限于类自己的层次结构中和周围的对象`Comparable`）。

此外，如果您发现自己编写了多个非常相似的类，唯一的区别是您正在操作的对象的类型，那么请考虑编写一个泛型类。

**编辑：**

使用内置类`AtomicReference`和`ThreadLocal`，“包含”关系适用于各种对象类型。一个`AtomicReference`和一个`ThreadLocal`对象仍然包含另一个类型的对象。这允许以类型安全的方式设置和返回特定类型，而无需让“get”和“set”方法返回/获取，`Object`并且在调用“get”时无需转换返回类型“ 方法。该关系适用于*特定类型*，但在类设计时不需要知道确切的类型。

**编辑2：**

我能想到的用于使类泛型的大多数示例都涉及“包含”关系。然而，这只是泛型关系的一个具体示例，尽管 Collections 框架是基于“包含”关系的，并且它提供了许多“包含”泛型类。泛型关系不一定是“包含”，所以我将尝试举例说明可以泛化但关系是“包含”的地方。

想象一个抽象`Shape`类，具有具体的类，如`Line`、`Square`、`Circle`等。现在我们定义`ShapeDrawer`知道如何绘制形状的接口。这里的关系是“平局”。我们可以定义接口：

```
public interface ShapeDrawer {
   public void drawShape(Shape shape);
} 
```

现在我们需要`ShapeDrawer`专门针对特定形状的特定具体实现，例如`CircleDrawer`和`SquareDrawer`。

```
public class CircleDrawer implements ShapeDrawer {
   public void drawShape(Shape shape) {/*...*/}
} 
```

现在`drawShape`方法 in`CircleDrawer`必须在绘制它之前测试它`shape`是否是 a 。`Circle`

现在，使用泛型的解决方案：

```
public interface ShapeDrawer<T extends Shape> {
   public void drawShape(T shape);
} 
```

现在，一个实现可以绘制一个特定的`Shape`：

```
public class CircleDrawer implements ShapeDrawer<Circle> {
    public void drawShape(Circle circle) {/*...*/}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T18:38:58.940

数据结构应该是通用的，因为该结构应该能够处理不止一种类型的输入。

任何可以/应该被一种以上数据类型使用的类都应该以通用方式创建。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T18:39:18.927

不要寻找“泛化”的东西。相反，您应该使用泛型以您认为最合适的方式完成特定任务。泛型只是工具箱中用于完成任务的工具。

如果您的问题是什么类型的东西可能是最好的通用实现，那么您自己的示例就是一个主要示例。当您需要以类似的方式处理不同的结构（如列表）时，泛型是一个很好的解决方案。这包括以类不变的方式处理其他类的大多数类，或者在类的子部分上是不变的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-20T19:48:53.033

每当您发现自己在铸造一个值时，您都应该考虑泛化是否会让您删除该铸造。让我们举个例子，`ThreadLocal`和`AtomicReference`。两次使用返回的值`get()`都需要强制转换（至少在大多数情况下）。

请记住，泛型可能非常嘈杂。权衡成本和收益。尤其要考虑泛型化是否有利于 API 用户或只是你，实施者。

# android - 如何使 DDMS 本机堆选项卡可见？

> ID：14987331
> 
> 赞同：4
> 
> 时间：2013-02-20T18:31:03.647
> 
> 标签：android, ddms

我已经在线阅读了有关本机堆选项卡的信息，但是在我的 DDMS 视图中没有看到该选项卡。我的问题是，如何使这个选项卡可见，以便我可以看到我的应用程序的本机堆使用情况的概述？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-25T13:03:33.353

在 android sdk 修订版 19 或 20 之后，ddms 工具似乎不再支持本机堆调试。

因此，要在 ddms 工具中获取本机堆视图点击，请通过以下方式下载旧工具： [https](https://dl-ssl.google.com/android/repository/tools_r18-windows.zip) : //dl-ssl.google.com/android/repository/tools_r18-windows.zip（其他平台的类似链接）

您应该能够重用当前的 sdk 文件夹（最新版本）。但是将您当前的 sdk/tools 文件夹重命名为 sdk/tools_backup 之类的名称。因此，您可以在调试后切换回它以使用 eclipse 等进行构建。

现在创建一个新的工具文件夹并将下载的 zip 文件的内容复制到其中。

您可以直接从 tools 文件夹启动 ddms 工具。如果您按照 user_directory/android/ 的 ddms.cfg 中的水星 (native=true) 中的步骤操作，您应该能够看到本机堆选项卡。

玩得开心调试:)

PS.：当然，您需要一个将 libc.so 替换为 libc_malloc_debug.so 的设备设置。你可以通过谷歌找到教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T12:28:44.483

打开 ~/.android/ddms.cfg
添加一行“native=true”
重新启动 DDMS 并选择一个进程后，您可以切换到新的本地分配选项卡并使用分配列表填充它。

# java - 在处理中获取默认（在屏幕上）PGraphics 上下文

> ID：14987333
> 
> 赞同：4
> 
> 时间：2013-02-20T18:31:06.860
> 
> 标签：java, graphics, processing, intersection

是否可以在处理中获取在屏幕上呈现的图形上下文？

我有一个函数，我想用它来为屏幕和后缓冲区绘制相同的形状以进行交叉测试。如果我可以使用不同的 PGraphics 上下文作为参数调用它两次，这将删除大量重复的代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T18:29:36.483

[如文档](http://processing.googlecode.com/svn/trunk/processing/build/javadoc/core/processing/core/PApplet.html#g)中所述， 可以在属性中找到`PGraphics`与 a 关联的对象。`PApplet`
`g`

因此，当小程序存储在 中时`this`，您会做**`this.g`或简单`g`**地得到它。

换句话说：

```
noStroke();
g.noStroke();
this.noStroke();
this.g.noStroke(); 
```

以上四种说法**都是等价的**。

**注意：**这在 ProcessingJS 上不起作用，我希望它尽快修复，请参阅[错误](https://processing-js.lighthouseapp.com/projects/41284/tickets/1916-g-variable-feature-of-processingorg-not-available-in-processingjs)。

# java - Java源代码中的泛型编程

> ID：14987338
> 
> 赞同：2
> 
> 时间：2013-02-20T18:31:17.773
> 
> 标签：java, api, generics

数组和集合是所有java程序员都使用的两个基本api类。这两个类都是在 Java 1.2 中添加的

查看 Arrays 类，有**27 个重载的二进制搜索方法**，它没有使用泛型，因为集合被更新为使用泛型。其中 Collections 类有 2 个重载的二进制搜索方法。

有什么理由这样做还是我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:33:17.410

因为 Java 泛型只能在引用类型上进行参数化。 `int`,`long`等是原始类型。

# openstack - CirrOS 基于什么发行版？

> ID：14987339
> 
> 赞同：20
> 
> 时间：2013-02-20T18:31:18.933
> 
> 标签：openstack

[CirrOS](https://launchpad.net/cirros)基于什么发行版？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-01-16T16:24:54.187

cirros 目前使用[buildroot](http://buildroot.uclibc.org/)来构建镜像。构建过程记录在cirros 源代码 ( [lp:cirros](http://code.launchpad.net/cirros) )的[自述文件中。](http://bazaar.launchpad.net/~smoser/cirros/trunk/view/head:/README)

对于内核，cirros 只是重新使用 cirros 发布时最新的 Ubuntu 12.04 内核。未来版本的 cirros 可能会使用 14.04 内核。重新使用内核仅仅意味着我不必处理自己的构建/修补/配置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-21T02:47:23.123

我相信它是一个完全定制的 Linux 发行版，它不是基于现有的发行版。

# xcode5 - Xcode：如何重构/重命名方法并添加（或删除）其参数？

> ID：14987347
> 
> 赞同：16
> 
> 时间：2013-02-20T18:31:46.097
> 
> 标签：xcode5, automated-refactoring

Xcode 5 是否能够更改方法的签名？据我所知，不，但我想被错误地展示。

如果我尝试添加（或删除）方法的参数，我会受到`Needs 1 fewer (more) colon to match original`错误的欢迎。

在这种情况下，我真的必须进行手动重构吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T15:06:44.880

到目前为止，我也无法找到一种方法来做到这一点。一般来说，Xcode 不太适合重构。

因此，我想建议您**寻找其他用于重构的 IDE**。事实上，这几乎是一种常见的方法。虽然我无法指出哪个 IDE 最适合这个，但有一些选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T15:32:43.003

用冒号 ("startRequest:") 标记第一个方法名称，然后单击 Refactor-> Rename

例子：

```
- (void)startRequest:(NSString *)url with:(NSDictionary *)post 
```

[http://developer.apple.com/library/ios/#recipes/xcode_help-source_editor/RefactorRenaming/RefactorRenaming.html](http://developer.apple.com/library/ios/#recipes/xcode_help-source_editor/RefactorRenaming/RefactorRenaming.html)

# mvvm - 在混合表达式中创建示例数据

> ID：14987348
> 
> 赞同：1
> 
> 时间：2013-02-20T18:31:47.617
> 
> 标签：mvvm, mvvm-light, expression-blend, blend, sample-data

我一直在观看[TechDays 2010 了解 MVVM](http://www.galasoft.ch/mvvmvideo1/)，有一次他谈到了混合和创建示例数据，但他没有在混合中生成它，而是在 C# 代码中制作数据。

我想知道您是否创建示例数据（来自示例类、新示例数据等）是否将其保存在项目中的某个位置（即我将我的项目提供给其他人，当他们加载项目时，他们会看到相同的数据吗？ )? 您可以轻松地从样本数据和实时数据切换吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:39:47.903

示例数据只是一个定义对象图的**xaml**（*不仅仅是 xml*）文件，该文件标有构建类型**DesignData**或**DesignDataWithDesignTimeCreatableTypes**。MSDN 上的文档很少，但有关其在 Silverlight 设计器中的使用的[文档](http://msdn.microsoft.com/en-us/library/ff602277%28v=VS.95%29.aspx)在 2012 年的任何 xaml 设计器中基本相同。

使用这些类型的样本时没有“实时数据”。所有值都在 xaml 文件中设置。您不能更改设计器中特定文本框的数据。您也不能轻松地在不同样本之间切换。

有两种方法可以创建示例数据——您可以手动构建它（如果您知道您的类型并且您喜欢编写 xaml），或者您可以启动一个简单的控制台应用程序，构建您的对象图，然后使用[XamlServices](http://msdn.microsoft.com/en-us/library/system.xaml.xamlservices.aspx)类将您的图形序列化为字符串（或者只是重写以将其拖放到流中）。下面是一些 C# 伪代码，它们可能会也可能不会像所写的那样工作：

```
public string Serialize(object toSerialize)
{
    var sb = new StringBuilder();
    var writer = XmlWriter.Create(sb);
    XamlServices.Save(writer, toSerialize);
    writer.Flush();
    writer.Close();
    return sb.ToString();
} 
```

您只需创建一个新文件，为其提供 .xaml 扩展名，将结果放入该文件中，将其保存到您的解决方案中，并将其构建操作设置为 DesignData（设计器模拟您的类型的结构）或 DesignTimeDataWithDesignTimeCreatableTypes（后者如果您的图形可以使用 XamlServices 反序列化，在设计器中使用时不会引发任何异常等）。

# html - 是否可以纯粹在css中制作一个带有1个尖边的1px边框输入字段？

> ID：14987351
> 
> 赞同：4
> 
> 时间：2013-02-20T18:31:54.373
> 
> 标签：html, css, textinput, pseudo-element, pseudo-class

我正在尝试为应用了伪类的搜索框构建一个带边框的`1px`输入字段。问题是边界有 1 个尖边。`:hover``:focus`

![(http://cl.ly/N357)](../Images/5879bb7839b99c499cccad49e84f4be3.png)

`input`是否可以仅在标签上仅使用 CSS 正确执行此操作？（这似乎是应用伪类最直接的途径）。

这是我到目前为止所得到的（虽然`transform`在 Chrome 中不起作用..）[http://jsfiddle.net/robbschiller/pxytz/](http://jsfiddle.net/robbschiller/pxytz/)

```
.search {
    width: 30px;
    height: 32px;
    background: #fff;
    border: 1px solid #7d8082;
    border-left: 0;
    position: relative;
}

.search:before {
    content:"";
    position: absolute;
    transform: rotate(45deg);
    -webkit-transform: rotate(45deg);
    -moz-transform: rotate(45deg);
    width: 23px;
    height: 23px;
    border: 1px solid #7d8082;
    border-right: 0;
    border-top: 0;
    right: 63%;
    top: 4px;
} 
```

这显然没有考虑悬停和焦点状态，这是问题的一部分。我试图避免使用`:before`伪元素，因为我认为您不能将伪类应用于伪元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-21T15:35:10.480

这是完全可能的。你也可以在没有转换的情况下做到这一点，这将使它在每个支持 :before 和 :after 伪类的浏览器中工作。您接近它的方式的一个问题是输入元素不允许使用 :before 和 :after 进行内容注入。它在某些浏览器中工作的事实是一个怪癖而不是标准。因此，您必须将输入包装在 div 或其他内容中。[http://jsfiddle.net/jamesmfriedman/Zmd8y/](http://jsfiddle.net/jamesmfriedman/Zmd8y/)

```
.search {
    display:inline-block;
    height: 32px;
    background: #fff;
    border: 1px solid #7d8082;
    border-left: 0;
    position: relative;
}

.search input {
    width: 30px;
    border:0;
    line-height: 32px;
    height: 32px;
}

.search:before, .search:after {
    content:'';
    position:absolute;
    top:-1px;
    width:0;
    height:0;
    left:-32px;
    border: 17px solid transparent;
}

.search:before {
    left: -34px;
    border-right-color: #7d8082;
}

.search:after {
    border-right-color: white;
    border-width: 16px;
    top:0;
}

.search:hover {
    border-color: #028DC3;
}

.search:hover:before {
    border-right-color:inherit;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T20:08:21.517

[http://jsfiddle.net/jRFNq/](http://jsfiddle.net/jRFNq/)

您可以在输入字段周围包裹一个 div。现在 :before 元素起作用了。

```
<div id=wrapper><input class="search"></input></div>

#wrapper:before {
content:"";
position: absolute;
transform: rotate(45deg);
-webkit-transform: rotate(45deg);
-moz-transform: rotate(45deg);
width: 23px;
height: 23px;
border: 1px solid #7d8082;
border-right: 0;
border-top: 0;
left: 38px;
top: 56px; 
```

}

变换弄乱了它的位置。所以要小心顶部和左侧。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T21:14:26.260

对于一个`input[type="search"]`或文本，您可以使用以下`label`众所周知的技术创建一个三角形：http: [//jsfiddle.net/pxytz/6/](http://jsfiddle.net/pxytz/6/)但在您编辑后，我发现这不是您想要实现的。

由 5 个线性渐变组成的线条呢？:)
仅使用 W3C 语法：http: [//jsfiddle.net/pxytz/8/](http://jsfiddle.net/pxytz/8/)

# python - pyqt4 + 单选按钮

> ID：14987355
> 
> 赞同：1
> 
> 时间：2013-02-20T18:32:00.010
> 
> 标签：python, qt, radio-button, pyqt, pyqt4

我有15个def。我有 15 个单选按钮（p1、p2、p3 .....p15）。我有 1 个 QPush 按钮。当我想使用我的第一个 def 时，我选择“p1”单击我的 QPushButton，然后使用这个 def。为什么我需要它？因为我需要处理文本，所以我在我的 textedit 中打开了一个文本，我需要处理它，但我只想使用单选按钮使用一个 def。我该怎么做？

例如：

```
self.radioButton_1 = QRadioButton(self.Processing)
self.radioButton_1.setGeometry(QRect(520, 200, 50, 22))
self.radioButton_1.setObjectName(_fromUtf8("radioButton_1"))
self.radioButton_1.setText(QApplication.translate("Form", "P1", None, QApplication.UnicodeUTF8))
self.processLineButton = QPushButton(self.Processing)
self.processLineButton.setGeometry(QRect(800, 100, 100, 37))
self.processLineButton.setText(QApplication.translate("None","Process", None, QApplication.UnicodeUTF8)) 
```

和

```
 def example(exampless):     
        example = []
        for exx in exampless:
            es = re.findall("\.{3}!", exx)
            if es:
                example = example + [exx]
            #endif    
        #endfor

            self.TextProcess.setPlainText(example) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T06:54:09.947

首先，您需要找到选中的单选按钮，然后您可以运行分配给该按钮的功能，如下所示：

```
for radioButton in self.findChildren(QtGui.QRadioButton):
    if radioButton.isChecked():
        radioButtonText = radioButton.text()
        print "Radio Button Selected: ", radioButtonText
        if radioButtonText == "example":
            example(args) 
```

# asp.net - 会议 | 购物车 | MVC

> ID：14987361
> 
> 赞同：-2
> 
> 时间：2013-02-20T18:32:13.037
> 
> 标签：asp.net, asp.net-mvc-4

与购物车应用程序一样，我们使用会话来存储用户选择的商品并从购物车中显示它们。

现在在 MVC 中，由于没有会话的概念，每个动作都将是新的控制器调用并相应地生成视图。那么如何存储在 Web 服务器本身中选择的项目列表（我可以通过保存在 DB 中然后检索它来做到这一点）。但想知道是否有其他方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:48:36.070

您可以像在 Webforms 中一样完美地使用 ASP.Net MVC 中的 Session：

```
HttpContext.Current.Session["NAME"] = value;
value = HttpContext.Current.Session["NAME"]; 
```

# ruby - 如何将 STDOUT 捕获到字符串？

> ID：14987362
> 
> 赞同：46
> 
> 时间：2013-02-20T18:32:14.673
> 
> 标签：ruby, stdio

```
puts "hi"
puts "bye" 
```

到目前为止，我想存储代码的 STDOUT（在这种情况下，嗨 \nbye 到变量中说“结果”并打印它）

```
puts result 
```

我这样做的原因是我已将 R 代码集成到我的 Ruby 代码中，在 R 代码运行时将其输出提供给 STDOUT，但无法在代码内部访问输出以进行一些评估。对不起，如果这令人困惑。所以“放置结果”行应该给我打招呼。

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2014-04-01T05:50:29.757

## 一个方便的函数，用于将标准输出捕获到字符串中......

以下方法是一个方便的通用工具，用于捕获标准输出并将其作为字符串返回。（我经常在单元测试中使用它来验证打印到标准输出的内容。）特别注意使用该`ensure`子句来恢复 $stdout （并避免惊讶）：

```
def with_captured_stdout
  original_stdout = $stdout  # capture previous value of $stdout
  $stdout = StringIO.new     # assign a string buffer to $stdout
  yield                      # perform the body of the user code
  $stdout.string             # return the contents of the string buffer
ensure
  $stdout = original_stdout  # restore $stdout to its previous value
end 
```

因此，例如：

```
>> str = with_captured_stdout { puts "hi"; puts "bye"}
=> "hi\nbye\n"
>> print str
hi
bye
=> nil 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2013-02-20T19:25:54.087

## 将标准输出重定向到 StringIO 对象

您当然可以将标准输出重定向到变量。例如：

```
# Set up standard output as a StringIO object.
foo = StringIO.new
$stdout = foo

# Send some text to $stdout.
puts 'hi'
puts 'bye'

# Access the data written to standard output.
$stdout.string
# => "hi\nbye\n"

# Send your captured output to the original output stream.
STDOUT.puts $stdout.string 
```

在实践中，这可能不是一个好主意，但至少现在你知道这是可能的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-07-01T09:05:29.980

如果您的项目中提供了 activesupport，您可以执行以下操作：

```
output = capture(:stdout) do
  run_arbitrary_code
end 
```

更多信息`Kernel.capture`可以在[这里找到](http://apidock.com/rails/Kernel/capture)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-02-20T18:35:39.093

您可以通过在反引号中调用您的 R 脚本来做到这一点，如下所示：

```
result = `./run-your-script`
puts result  # will contain STDOUT from run-your-script 
```

有关在 Ruby 中运行子进程的更多信息，请查看[这个 Stack Overflow 问题](https://stackoverflow.com/questions/7212573/when-to-use-each-method-of-launching-a-subprocess-in-ruby)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-09T12:07:53.230

对于大多数实际目的，您可以将任何`$stdout`响应`write`, `flush`,`sync`和的内容放入`sync=`其中`tty?`。

在此示例中，我使用来自 stdlib的修改后的[队列。](http://ruby-doc.org/core-2.3.1/Queue.html)

```
class Captor < Queue

  alias_method :write, :push

  def method_missing(meth, *args)
    false
  end

  def respond_to_missing?(*args)
    true
  end
end

stream = Captor.new
orig_stdout = $stdout
$stdout = stream

puts_thread = Thread.new do
  loop do
    puts Time.now
    sleep 0.5
  end
end

5.times do
  STDOUT.print ">> #{stream.shift}"
end

puts_thread.kill
$stdout = orig_stdout 
```

如果您想积极地对数据采取行动，而不仅仅是在任务完成后查看它，您需要这样的东西。使用 StringIO 或文件将有多个线程尝试同时同步读取和写入的问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-02T19:49:58.553

`Minitest`版本：

* * *

`assert_output`如果您需要确保是否生成了一些输出：

```
assert_output "Registrars processed: 1\n" do
  puts 'Registrars processed: 1'
end 
```

[断言输出](https://github.com/seattlerb/minitest/blob/master/lib/minitest/assertions.rb#L285)

* * *

或者`capture_io`如果您确实需要捕获它，请使用：

```
out, err = capture_io do
  puts "Some info"
  warn "You did a bad thing"
end

assert_match %r%info%, out
assert_match %r%bad%, err 
```

[捕获_io](https://github.com/seattlerb/minitest/blob/master/lib/minitest/assertions.rb#L433)

`Minitest`它本身在任何 Ruby 版本中都可用，从`1.9.3`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-07T12:47:05.733

## 为 Ruby 代码*和*子进程捕获标准输出（或标准错误）

```
# capture_stream(stream) { block } -> String
#
# Captures output on +stream+ for both Ruby code and subprocesses
# 
# === Example
#
#    capture_stream($stdout) { puts 1; system("echo 2") }
# 
# produces
# 
#    "1\n2\n"
#
def capture_stream(stream)
  raise ArgumentError, 'missing block' unless block_given?
  orig_stream = stream.dup
  IO.pipe do |r, w|
    # system call dup2() replaces the file descriptor 
    stream.reopen(w) 
    # there must be only one write end of the pipe;
    # otherwise the read end does not get an EOF 
    # by the final `reopen`
    w.close 
    t = Thread.new { r.read }
    begin
      yield
    ensure
      stream.reopen orig_stream # restore file descriptor 
    end
    t.value # join and get the result of the thread
  end
end 
```

[我从钟](https://stackoverflow.com/a/21038215/601203)那里得到灵感。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-05T18:24:20.777

对于 RinRuby，请知道 R 有`capture.output`：

```
R.eval <<EOF
captured <- capture.output( ... )
EOF

puts R.captured 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2016-09-28T10:26:43.830

感谢@girasquid 的回答。我将其修改为单个文件版本：

```
def capture_output(string)
  `echo #{string.inspect}`.chomp
end

# example usage
response_body = "https:\\x2F\\x2Faccounts.google.com\\x2Faccounts"
puts response_body #=> https:\x2F\x2Faccounts.google.com\x2Faccounts
capture_output(response_body) #=> https://accounts.google.com/accounts 
```

# networking - 禁用 ICMP 主机不可达

> ID：14987364
> 
> 赞同：5
> 
> 时间：2013-02-20T18:32:18.823
> 
> 标签：networking, icmp, raw-sockets

我正在使用单个原始套接字从具有 1024 个端口的本地测试网络读取 UDP 数据包。每个 UDP src 和 dest 端口都是唯一的，我需要访问 IP 和 UDP 标头字段。我可以在 linux-rt 内核中以 100 mbps 的速度流式传输和处理数据（输入和输出），抖动非常低 < 250 微秒，标称 10 微秒。

我想防止内核将 ICMP 端口不可达错误发回发送主机，但是，由于资源限制，我不想创建 1024 个普通 UDP 套接字并绑定到每个套接字。目前，我正在使用 iptables 删除出站端口不可达消息。有谁知道一种方法（使用 C 代码编程）来防止 ICMP 无法访问的流量？也许是 IOCTL 或套接字选项？我也尝试更改 /proc/sys/net/ipv4/icmp_ratelimit 但这似乎没有效果。默认情况下，ratemask 是为 dest unreachables 设置的，并且各种 ratelimit 值并没有改变我可以看到的任何行为。

# c - 是否需要引导加载程序才能运行固件？

> ID：14987367
> 
> 赞同：1
> 
> 时间：2013-02-20T18:32:29.527
> 
> 标签：c, embedded, microcontroller, bootloader, rtos

我目前正在为 Stellaris ARM 微控制器板开发固件，并且正在运行 SYS/BIOS RTOS。

当我将固件上传到板上时，我想知道板上是否需要引导加载程序。我可以用我的 .bin 文件覆盖闪存上的引导加载程序，还是需要偏移我的起始地址以保留引导加载程序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T19:42:56.820

在一般情况下（即不是特定于 Stellaris），软件是软件，引导加载程序是软件，您的应用程序是软件，处理器无法区分，所以很明显不需要引导加载程序，在复位时运行的软件可以很容易成为你的软件。

然而，引导加载程序的明显好处是能够在不连接特殊设备的情况下应用现场更新；你可能会后悔失去这种能力。

一些芯片（再次通常，检查您的数据表以了解 Stelaris 细节）在掩码 ROM 而不是闪存中具有引导加载程序，您无法删除或覆盖它，但通常可以设置配置引脚以选择引导行为以绕过例如引导加载程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T20:25:43.190

不，您可以使用 jtag 并且不需要运行软件来停止和重新刷新固件。

# symfony - Composer.phar Symfony 清除缓存

> ID：14987368
> 
> 赞同：5
> 
> 时间：2013-02-20T18:32:32.343
> 
> 标签：symfony

每当我执行 composer.phar 安装时，它都会清除 Symfony 的开发缓存。

有什么方法可以清除另一个环境缓存，比如生产？我知道我总是可以运行 app/console cache:clear --env=prod。但我希望 Composer 在获取依赖项后处理它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:07:41.267

在您的 composer.json 中，您会找到一个“脚本”部分，它看起来应该是这样的：

```
"scripts": {
    "post-install-cmd": [
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
    ],
    "post-update-cmd": [
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
    ]
} 
```

如您所见，所有命令都存储在一个文件中，[Sensio\Bundle\DistributionBundle\Composer\ScriptHandler::clearCache()](https://github.com/sensio/SensioDistributionBundle/blob/master/Composer/ScriptHandler.php#L51)就是您要查找的内容。

由于这些脚本旨在在没有用户干预的情况下运行，因此您不打算添加参数。但是，您可以轻松添加自己的脚本或替换现有的脚本。

**编辑：**我应该改写最后一段。你可以有参数，但它们是在你的 composer.json 中静态定义的。在额外部分中定义的值，例如“symfony-web-dir”，是 ScriptHandler 使用的参数。它们可以从作曲家的 CommandEvent 中检索，如[ScriptHandler::getOptions() 所示](https://github.com/sensiolabs/SensioDistributionBundle/blob/master/Composer/ScriptHandler.php#L391)。因此，您可以例如定义一组环境，以便在每次安装/更新时清除，`"extra"`在脚本中检索它，然后为每个指定的环境调用 clear cache-command。可以通过[环境变量提供值](https://getcomposer.org/doc/03-cli.md#environment-variables)这在您的场景中可能更有意义，但这需要深入研究作曲家，因为配置没有解释例如如何覆盖额外部分中的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-28T15:48:07.603

我在寻找如何在作曲家更新后设置资产符号链接选项时找到了这个答案。

您可以在 composer.json 文件的额外节点中添加“symfony-assets-install”条目

```
"extra": {
    "symfony-app-dir": "app",
    "symfony-web-dir": "web",
    "symfony-assets-install": "symlink"
} 
```

src：[更新供应商](http://symfony.com/doc/current/book/installation.html#updating-vendors "更新供应商")

# cordova - 如何让PhoneGap app 进入首页？

> ID：14987369
> 
> 赞同：0
> 
> 时间：2013-02-20T18:32:35.963
> 
> 标签：cordova, webpage

我正在制作一个 PhoneGap 应用程序，并且在某些部分他们重定向到一个实际的网站，而不是本地文件。当我关闭并重新打开应用程序时，它会显示上次查看的页面。当应用程序打开时，我需要它返回主页。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T05:11:34.983

您可以使用 InAppBrowser 启动外部 Web 链接。这样，当您打开外部链接并关闭[InAppBrowser](http://docs.phonegap.com/en/2.4.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser)时，它将返回到您的应用程序。

查看有关如何使用它的官方文档。

[InAppBrowser](http://docs.phonegap.com/en/2.4.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser)

# entity-framework - 如何根据 Castle Windsor 中的泛型类型参数解析服务？

> ID：14987370
> 
> 赞同：0
> 
> 时间：2013-02-20T18:32:38.730
> 
> 标签：entity-framework, generics, inversion-of-control, castle-windsor, repository-pattern

我有一个这样的安装程序：

```
public void Install(IWindsorContainer container, IConfigurationStore store) {

        //Services
        container.Register(
            Classes.FromAssemblyNamed(ASSEMBLY_NAME)
                .BasedOn<IService>()
                .WithServiceFirstInterface()
                .LifestyleTransient());

        //Repository
        container.Register(
            Component.For(typeof(IRepository<>))
                .ImplementedBy(typeof(Repository<>))
                .LifestyleTransient());

        //Contexts
        container.Register(
            Component.For(typeof(Context<IGlobalObject>))
                .ImplementedBy(typeof(GlobalContext<>)).LifestyleTransient());

    } 
```

存储库是一个开放的泛型，它注入了一个 Context 构造函数，它是 EF DbContext 的包装器，但需要一个类型参数来指示它需要连接到的数据库。这个想法是我有几个 DbContext，因为我需要连接到多个数据库，并且我希望 Windsor 根据传递给存储库的类型参数解析适当的 DBcontext。

存储库类型参数受限于以下内容（GlobalObject 和 GlobalContext 指的是与 1 个此类数据库关联的类型）：

```
public interface IGlobalObject : IObject
    {}

    public interface IObject
    {
        int Key { get; set; }
    } 
```

但是，温莎无法解决上下文，我无法弄清楚为什么？它已注册并在容器中，但无法解析。

**编辑：**

GlobalContext 的代码：

```
public class GlobalContext<T> : Context<T>
    where T : IGlobalObject
{
    private const string GLOBAL_CSTR = "Global";

    public GlobalContext() : base(ConfigurationManager.ConnectionStrings[GLOBAL_CSTR].ConnectionString) {}

    public DbSet<Company> Companies { get; set; }
    public DbSet<ConnectionString> ConnectionStrings { get; set; }
    public DbSet<Server> Servers { get; set; }
} 
```

语境：

```
//Wrapper around dbcontext which enforces type
    public abstract class Context<T> : DbContext where T : IObject
    {
        protected Context() {}
        protected Context(string connectionString)  : base(connectionString){}
    } 
```

**编辑2：**

如果我为它工作的每个场景指定具体类型，那么它显然与界面上的匹配有关。

```
//Contexts
        container.Register(
            Component.For(typeof(Context<Server>))
                .ImplementedBy(typeof(GlobalContext<Server>)).LifestyleTransient()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T11:04:34.907

这并不是您问题的直接答案。但我觉得这种方法可能是错误的。

考虑到您的存储库是由通用基础实现的，`Repository<>`我看不到将通用类型与正确上下文相关联的干净方式。我认为您可能需要切换到具有显式上下文注入的“风味”存储库和/或在注册上下文的方式上更加冗长。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T08:22:30.153

这对我来说似乎是个问题：

```
//Contexts
container.Register(
    Component.For(typeof(Context<IGlobalObject>))
        .ImplementedBy(typeof(GlobalContext<>)).LifestyleTransient()); 
```

在这里你说 - 当有人要求 Context 注入 GlobalContext<> - 问题是温莎如何知道 GlobalContext 的通用参数是什么。

如果没有看到您的 GlobalContext 对象，很难看到它，但它应该是：

```
container.Register(
    Component.For(typeof(Context<>))
        .ImplementedBy(typeof(GlobalContext<>)).LifestyleTransient()); 
```

# html - 多余的 20px 是从哪里来的？

> ID：14987373
> 
> 赞同：1
> 
> 时间：2013-02-20T18:32:51.717
> 
> 标签：html, css, localized

我正在从头开始开发一个网站，并且似乎在网页的最底部显示了额外的二十（左右）像素。页面没有在最后一个元素处结束，而是继续并显示`body`背景。我尝试过使用 Firebug 并修改了 css 文件中的每个元素，但找不到导致显示过多像素的原因。

非常感谢任何有关解决此问题的帮助。

**问题截图：**

![帮助！](../Images/56ab9717abe385a4364c2c0711be5411.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:37:16.107

它来自这里：

```
.main-wrap {
    margin-bottom: 20px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:39:24.910

它来自 main-wrap 类风格：

```
.main-wrap {
    margin-bottom: 20px;
} 
```

删除它，你很好:)

顺便说一下，这里引用了它：

```
<div class="main-wrap row">

        <script type="text/javascript" src="//cdn.sublimevideo.net/js/goqhe4ff.js"></script>
            </div> 
```

# animation - 三.js和跳帧动画

> ID：14987384
> 
> 赞同：0
> 
> 时间：2013-02-20T18:33:19.800
> 
> 标签：animation, three.js, frame

我目前正在为我的动画项目使用three.js。我正在使用 morphtargets 并想问为什么我的帧经常被跳过？我的动画有 7 个变形目标，它围绕着它们展开。它从 0 到 6 (output:console.log('frame: ' + lastKeyframe) ) 开始，但有时我的帧从 0 跳到 3 或从 1 跳到 4.. 这里真的发生了什么？顺便说一句，动画代码运行良好

```
[if ( Mesh && playBack ) // exists / is loaded 
{   
    time = new Date().getTime() % duration; //arba Date.now()
    keyframe = Math.floor( time / interpolation ) + animOffset;
    if ( keyframe != currentKeyframe ) 
    {
        Mesh.morphTargetInfluences[ lastKeyframe ] = 0;
        Mesh.morphTargetInfluences[ currentKeyframe ] = 1;
        Mesh.morphTargetInfluences[ keyframe ] = 0;
        //console.log(Mesh.morphTargetInfluences[ 0 ]);
        lastKeyframe = currentKeyframe;
        currentKeyframe = keyframe;

    }
    //The two lines after the if statement interpolate between frames. 
    //The value at currentKeyFrame starts decreasing from 1, and the value at keyFrame starts increasing.
    Mesh.morphTargetInfluences[ keyframe ] = ( time % interpolation ) / interpolation;
    Mesh.morphTargetInfluences[ lastKeyframe ] = 1 - Mesh.morphTargetInfluences[ keyframe ];
    //console.log('current: ' + Mesh.morphTargetInfluences[ keyframe ]);
    console.log('frame: ' + lastKeyframe);

}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-15T14:57:33.720

我认为这是因为您是根据阅读挂钟来选择新帧。所以如果您的帧速率下降，那么您可能会丢失一帧

# c# - C#会议系统

> ID：14987390
> 
> 赞同：0
> 
> 时间：2013-02-20T18:33:45.613
> 
> 标签：c#, forms, user-interface, input

我正在创建一个表格来保存来自“会议”的信息。用户将填写有关`title`、`location`、`startTime`、`endTime`、`notes`和 a 的信息`date`。我目前正在处理的是“保存更改”按钮，它将：

1.  清除所有文本框。
2.  将输入存储在数组中。
3.  仅`title`在 ListBox 中显示。
4.  当在 ListBox 中单击标题时，如果用户希望进行更改，存储在该数组元素中的信息将重新填充到相应的 TextBoxes 中。

我已经完成了#1、#2 和#3，如果对#4 有任何帮助，我将不胜感激。我已经粘贴了下面的代码供您查看。

```
public partial class CalendarForm : Form
{
    int currentIndex;
    int arraySize = 0;
    Meeting[] meetingArray = new Meeting[100];

    public CalendarForm()
    {
        InitializeComponent();
    }

    private void saveChangesButton_Click(object sender, EventArgs e)
    {
        meetingArray[arraySize] = new Meeting();
        meetingArray[arraySize].title = textBoxTitle.Text;
        meetingArray[arraySize].location = textBoxLocation.Text;
        meetingArray[arraySize].startTime = textBoxStartTime.Text;
        meetingArray[arraySize].endTime = textBoxEndTime.Text;
        meetingArray[arraySize].notes = notesTextBox.Text;
        currentIndex = arraySize;
        arraySize++;
        meetingListBox.Enabled = true;
        textBoxTitle.Text = "";
        textBoxLocation.Text = "";
        textBoxStartTime.Text = "";
        textBoxEndTime.Text = "";
        notesTextBox.Text = "";

       *edit* added these two lines which now add the title to the listBox
       meetingListBox.Items.Add(meetingArray[currentIndex].title);
        Controls.Add(meetingListBox);

    }
}

public class Meeting
{
    public string title;
    public string location;
    public string startTime;
    public string endTime;
    public string notes;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:30:17.157

我真的建议您查看数据绑定并学习如何正确执行此操作，但如果您想要一个快速而肮脏的解决方案（尽管最后您会发现它的工作量更大），我会做这样的事情：

```
private void saveChangesButton_Click(object sender, EventArgs e)
{
    Meeting m = new Meeting();
    m.title = textBoxTitle.Text;
    m.location = textBoxLocation.Text;
    m.startTime = textBoxStartTime.Text;
    m.endTime = textBoxEndTime.Text;
    m.notes = notesTextBox.Text;
    meetingArray[arraySize] = m;
    currentIndex = arraySize;
    arraySize++;
    meetingListBox.Enabled = true;
    textBoxTitle.Text = "";
    textBoxLocation.Text = "";
    textBoxStartTime.Text = "";
    textBoxEndTime.Text = "";
    notesTextBox.Text = "";

    meetingListBox.Items.Add(m);
    //Controls.Add(meetingListBox);   // You don't need to keep adding the control every time!

} 
```

现在在你的`Meeting`课堂上，我会重写`ToString()`以返回标题。默认情况下，`ListBox`它将仅使用`ToString()`您添加到其中的任何方法。

为了帮助解决 #4，您希望绑定`SelectedIndexChanged`事件，然后使用该`SelectedItem`属性，将其转换回一个`Meeting`对象（因为它会返回一个`Object`），然后使用它来重新填充您的各种文本框。

就像是：

```
private void meetingListBox_SelectedIndexChanged(object sender, System.EventArgs e)
{
    Meeting m = meetingListBox.SelectedItem as Meeting;
    if (m != null) 
    {
        textBoxTitle.Text = m.title;
        //...etc for all your other text boxes.
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T20:49:23.810

这就是我重构类的方式：

```
public partial class CalendarForm : Form
{
  private List<Meeting> Meetings { get; set; }

  public CalendarForm()
  {
    InitializeComponent();
    Meetings = new List<Meeting>();
  }

  private void saveChangesButton_Click(object sender, EventArgs e)
  {     
    try 
    {       
      Meeting meeting = CreateMeeting();
      Meetings.Add(meeting);
      meetingListBox.Add(meeting);
    }
    catch
    {
      //Add proper error handling here
    }            
  }

  private Meeting CreateMeeting()
  {
    return new Meeting()
    {
      Title = textBoxTitle.Text,
      Location = textBoxLocation.Text
      StartTime = DateTime.Parse(textBoxStartTime.Text),
      EndTime = DateTime.Parse(textBoxEndTime.Text),
      Notes = notesTextBox.Text,
     };
   }
}

//As Matt Burland answered already:
private void meetingListBox_SelectedIndexChanged(object sender, EventArgs e)
{
  Meeting meeting = meetingListBox.SelectedItem as Meeting;
  if (meeting != null) 
  {
    textBoxTitle.Text = meeting.Title;
    //...etc for all your other text boxes.
  }
}

public class Meeting
{
  public string Title { get; set; }
  public string Location  { get; set; }
  public DateTime StartTime  { get; set; }
  public DateTime EndTime  { get; set; }
  public string Notes  { get; set; }

  public override string ToString()
  {
    return Title; 
  }
} 
```

我进行了许多更改，尤其是从 Array 到 List<> 的切换。列表更灵活并提供更好的功能。除非你真的需要使用数组，否则我会远离它们，只是为了更好地防止逻辑错误索引越界类型问题。

另外，我个人认为日期应该以 DateTime 结构格式存储，但这又是一个偏好问题。请注意，在将输入（尤其是日期）分配给 Meeting 对象之前对其进行清理/验证是谨慎的做法。

Meeting 对象现在具有属性而不是公共字段。如果您想更改获取/设置的方式，则首选属性。

希望这可以帮助。

# jquery - 使用AJAX加载方式加载jsp页面

> ID：14987391
> 
> 赞同：7
> 
> 时间：2013-02-20T18:33:51.053
> 
> 标签：jquery, ajax

大家好，我需要一些有关 ajax 加载方法的帮助。基本上，一旦用户检查单选按钮，我需要使用 Ajax load() 在主页中显示一个 jsp。我附上了需要显示jsp的页面图像以及我的jsp代码..请帮忙！![网页](../Images/4e19f8dc0f294ee48045a7e0659a367e.png)

```
 <div id="verification">
    <p align=center class="4f1_title" ><u>Verification Decision</u></p>
     <table border="0" cellpadding="0" cellspacing="0" align=center
width="100%">
<tbody>

    <tr>
        <td width="10%"></td>
        <td width="8%">Passed <input id="passed" type="radio"
            value="P" onclick="()"></td>
        <td colspan="2" width="8%">Pending <input id="pending"
            type="radio" value="H" onclick="()"></td>
        <td width="9%">True Hit <input id="failed" type="radio"
            value="F" onclick="()" disabled></td>
        <td width="13%">Parcel Returned <input id="returned"
            type="radio" value="S" onclick="()"></td>
        <td width="23%">Referred to Law Enforcement <input id="law"
            type="radio" value="L" onclick="()"></td>
        <td width="8%">Retired <input id="retired" type="radio"
            value="R" onclick="()" disabled></td>
              <td width="12%">Return Reason <input id="ac" 
              type="radio" value="C" onclick="()"></td>
         <td width="10%"></td>
    </tr>
         </tbody>
          </table>
         </div>
            <br>

                     <div align=center>
                <a href="javascript:handleClick()"><u>
              <div id='showhidecomment'>Show Comments</div></u></a>
              <div id='chkcomments'>
               </div>
    </div>
     <br> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:26:56.593

尝试

```
$(function() { // when DOM is ready
    $("#showhidecomment").click(function(){ // when #showhidecomment is clicked
        $("#chkcomments").load("sample.jsp"); // load the sample.jsp page in the #chkcomments element
    }); 
}); 
```

并将您的 html （*链接部分*）更改为

```
<div>
    <div id='showhidecomment'>Show Comments</div>
    <div id='chkcomments'></div>
</div> 
```

由于`div`元素在元素内部无效`a`。

* * *

**更新** *评论*

我会`data-url`为这些元素添加一个自定义属性（*以指定要加载的页面*）

```
<input id="passed" type="radio" value="P" data-url="some-page.jsp" />
<input id="law" type="radio" value="L" data-url="some-other-page.jsp" />
<input id="ac" type="radio" value="C" data-url="some-third-page.jsp" /> 
```

然后对它们应用一个处理程序

```
$('#verification').on('change','input[type="radio"][data-url]', function(){
    if (this.checked){
        var url = $(this).data('url');
        $("#chkcomments").load( url );
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T18:49:49.893

如果您只想 ajax 加载页面，您可以使用 jquery 加载：[http ://api.jquery.com/load/](http://api.jquery.com/load/)

还有 jquery 获取：[http ://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

您可以在文档中找到一个简单的示例。

**更新：**

如果还没有，您可能需要添加对 jquery 库的引用。请参考下面的示例代码。

简单页面显示“hello world”：http: [//jsbin.com/ivinuw/1/](http://jsbin.com/ivinuw/1/)

带按钮的页面。当您单击按钮时，它使用 jquery load 将上面的页面加载到 div 容器中：http: [//jsbin.com/ubitat/1/edit](http://jsbin.com/ubitat/1/edit)

# c - 如果两种类型不相同，则导致 C89 中的编译错误

> ID：14987395
> 
> 赞同：19
> 
> 时间：2013-02-20T18:33:56.507
> 
> 标签：c, types, autoconf

仅使用 C89 的功能，给定

```
typedef [unspecified token sequence] T1;
typedef [another unspecified token sequence] T2; 
```

展示一种语言结构，当且仅当 T1 和 T2 是*相同类型*（不仅仅是兼容）时，该语言结构才能正确编译。对 C89 的限制是因为这将进入 autoconf 探测。

**编辑：**我需要一个即使 T1 或 T2 或两者都是不完整类型的解决方案。很抱歉之前没有提到这一点。

**编辑之子：**所有三个当前答案仅检测*兼容*类型。事实证明，这比我记得的更接近“相同类型”，对于我目前的目的来说足够接近，但出于好奇，我仍在寻找检测*相同*类型的答案。以下是一些兼容但不相同的类型：

```
typedef void (*T1)(void);
typedef void (*T2)();

typedef float T1[];
typedef float T2[12];

typedef enum { ONE, TWO, THREE } T1;
typedef /* implementation-defined integer type */ T2; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T19:00:46.203

我认为您应该能够利用`extern`声明的严格类型检查：

```
typedef int T1;
typedef char T2;

extern T1 t1;    
T2 t1; 
```

以上将无法编译。将 T2 更改为 an`int`将允许源正确构建。

这也不会编译：

```
typedef int T1;
typedef unsigned int T2;

extern T1 t1;    
T2 t1; 
```

即使这两种类型都是`int`. 我认为这是你想要的。

但是，这不会触发错误：

```
typedef emum {Foo} T1;
typedef unsigned T2; 
```

所以它不是 100% 防水的。但是，必须记住，没有任何事情可以用 an 做`enum`，也不能用`unsigned`. 它们具有相同的布局，可以互换使用。实际上，它们是同一类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T20:24:08.323

```
T1 t1;
T2 *t2 = &t1; 
```

如果 T1 和 T2 不相同，则这是违反约束的。

或者，

```
T1 f();
T2 f() {} 
```

# java - 编写android应用程序目录

> ID：14987396
> 
> 赞同：0
> 
> 时间：2013-02-20T18:34:08.490
> 
> 标签：java, android, android-launcher

我已经阅读了很多关于编写 android Launcher 的文章，但是启动器是否包含应用程序目录？

我想要实现的是自定义显示已安装应用程序的屏幕（以启动应用程序）。我希望从网格中排除显示某些应用程序。我可以在无需root设备的情况下实现这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:36:24.543

是的。正在使用的启动器负责显示应用程序列表，如果需要，您可以从中省略应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:58:43.340

启动器显示主屏幕和抽屉，它本身也是一个应用程序。存在许多第三方启动器，例如我自己的 Trebuchet，可以安装到您的设备上。但是，我希望这是关于编写启动器，而不仅仅是一般的 android 问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-20T18:58:49.773

Launcher 只不过是一个具有在系统启动时启动并在 home 键上处于前面的特殊特性的应用程序。

您不需要 root 访问权限来编写启动器或在启动器中显示的应用程序列表中排除任何应用程序。您应该能够通过您的业务逻辑来实现它。

# iphone - 使用 AFNetworking 解析 XML 文件

> ID：14987399
> 
> 赞同：1
> 
> 时间：2013-02-20T18:34:33.623
> 
> 标签：iphone, ios, objective-c, xml, afnetworking

我正在使用 Yahoo api 制作一个小天气应用程序。这个 api 给了我一个 XML 文件。我现在的问题是如何解析这个文件？这是我到目前为止的代码。

```
 AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
        NSLog(@"success");
        XMLParser.delegate = self;
        [XMLParser parse];
        NSLog(@"xmlParser is %@",XMLParser);
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, NSXMLParser *XMLParser) {
        NSLog(@"failure with error %@",error);
    }]; 
```

[您可以在此处](http://weather.yahooapis.com/forecastrss?w=2442047&u=c)找到 XML 文件。

希望有人可以帮助我

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T20:26:01.810

如果您希望使用 NSXMLParser 解析 XML，则需要有一个实现 NSXMLParserDelegate 的类。您可以为此使用 ViewController：

```
@interface ViewController : UIViewController <NSXMLParserDelegate> 
```

然后使用此协议提供的 SAX 方法，您可以在运行时解析此 XML `[XMLParser parse]`。这是您的 xml 的示例：

```
- (IBAction) makeRequest:(id)sender
{
    NSLog(@"Making request");
    NSURLRequest *request = [NSURLRequest requestWithURL:[NSURL URLWithString:@"http://weather.yahooapis.com/forecastrss?w=2442047&u=c"]];
    AFXMLRequestOperation *operation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
        XMLParser.delegate = self;
        [XMLParser parse];
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, NSXMLParser *XMLParser) {
       NSLog(@"failure with error %@",error);
   }];
    [operation start];
}

#pragma mark - Parsing lifecycle

- (void)startTheParsingProcess:(NSData *)parserData
{
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:parserData]; //parserData passed to NSXMLParser delegate which starts the parsing process

    [parser setDelegate:self];
    [parser parse]; // starts the event-driven parsing operation.
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict
{
    if ([elementName isEqualToString:@"yweather:astronomy"])
    {
        NSLog(@"Sunrise: %@,  Sunset: %@", [attributeDict valueForKey:@"sunrise"], [attributeDict valueForKey:@"sunset"]);
    }

}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    self.tmpInnerTagText = string; // Make a temp NSString to store the text in-between tags
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if ([elementName isEqualToString:@"title"])
    {
        NSLog(@"%@", self.tmpInnerTagText);
    }
    if ([elementName isEqualToString:@"description"])
    {
        NSLog(@"%@", self.tmpInnerTagText);
    }
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError
{
    NSLog(@"Paser Error = %@", parseError);
    //TODO: Create Alert message error
} 
```

为了让 AFNetworking 支持您正在使用的 RSS xml，我必须按照以下站点的说明将“application/rss+xml”添加到可接受的内容类型中：http: [//www.suushmedia.com/simple-rss-reader-with -af网络/](http://www.suushmedia.com/simple-rss-reader-with-afnetworking/)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T05:36:01.937

更好的解决方案：我在[这里找到](https://stackoverflow.com/questions/6133951/ios-nspropertylistserialization-propertylistwithdata-produces-incompatible-conv)

```
NSPropertyListFormat format;
NSArray *myObjects = [NSPropertyListSerialization propertyListWithData:responseObject options:NSPropertyListMutableContainers format:&format error:NULL];

    //If the root object of the plist is dictionary

NSDictionary *myObjects = [NSPropertyListSerialization propertyListWithData:responseObject options:NSPropertyListMutableContainers format:&format error:NULL]; 
```

# c# - Monodevelop 应用程序无法在 Windows 上运行

> ID：14987402
> 
> 赞同：1
> 
> 时间：2013-02-20T18:34:45.057
> 
> 标签：c#, mono, gtk, monodevelop, gtk#

我正在尝试使用 MonoDevelop 在 Mac 中制作 Windows 应用程序，但是当我尝试在 Windows 上使用它时出现此错误

```
Could not load file or assembly "Mono.posix" 
```

![错误](../Images/152d3b02c56f5cb00833bfc6eef8f8db.png) 有谁知道如何解决这一问题？我已经尝试将文件 mono.posix.dll 放在同一个文件夹中，但这仍然没有解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:12:44.927

看起来您的应用程序依赖于[Mono.Posix](http://docs.go-mono.com/index.aspx?link=N%3aMono.Posix)程序集。

此程序集已弃用，取而代之的是[Mono.Unix](http://docs.go-mono.com/index.aspx?link=N%3aMono.Unix)。由于后者不适用于 Windows 系统，我最好的猜测是前者也不可用。

如果您希望它在 Windows 上运行，则必须删除对该程序集的依赖（可能重写应用程序的某些部分）。

# asp.net - c#使用onrowdatabound从gridview asp.net中的隐藏单元格获取值

> ID：14987403
> 
> 赞同：6
> 
> 时间：2013-02-20T18:34:48.030
> 
> 标签：asp.net, gridview

（例如根据隐藏值设置行颜色）

如果你有一个隐藏单元格的 gridview

```
<asp:GridView ID="Timeevents" runat="server" 
        OnRowDataBound="Timeevents_RowDataBound"
        OnRowCommand = "Timeevents_RowCommand"
        AutoGenerateColumns="False"> 
        <columns>
        <asp:BoundField DataField="CaseID" HeaderText="CaseID" Visible = "False" />
        <asp:BoundField DataField="caseworkerID" HeaderText="CwID" Visible = "False" />
        <asp:BoundField DataField="EventTypeID" HeaderText="EvTypeID" Visible = "False" />
        <asp:BoundField DataField="CaseWorker" HeaderText="Case Worker" />
        <asp:BoundField DataField="EventDate" HeaderText="Event Date" />
        <asp:BoundField DataField="Code" HeaderText="Code" />
        <asp:BoundField DataField="TotalUnits" HeaderText="Total Units" />
        <asp:BoundField DataField="EventType" HeaderText="Event Type" />
        <asp:BoundField DataField="UnitCost" HeaderText="Unit Cost" />
        <asp:BoundField DataField="TotalCost" HeaderText="Total Cost"/>
        <asp:TemplateField HeaderText="ADD">
                <ItemTemplate> 
                    <asp:Button  ID="AddUnit" runat="server" Text=" +1 " 
                    CommandName="AddUnit" 
                    CommandArgument='<%# Eval("CaseID")+ ";" + Eval("CaseworkerID")+ ";" + Eval("EventDate")+ ";" + Eval("EventTypeID")+ ";" + ("1")%>'/>
                </ItemTemplate> 
            </asp:TemplateField> 
        </Columns>
</asp:GridView> 
```

那么似乎不可能使用 (e.Row.Cells[2].Text) 在 onRowDatabound 处理程序中获取这些值

我通过不将任何 BoundFields 设置为 Visible = "False" 来解决这个问题，因此默认情况下它们是可见的 = "true"。在后面的代码中的 onRowDatabound 处理程序中获取我需要的值，然后使它们不可见。像这样。

```
protected void Timeevents_RowDataBound(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {  // just for the datarows
                int a = (int.Parse(e.Row.Cells[2].Text));

                if (a % 2 == 0)
                {
                    e.Row.BackColor = System.Drawing.Color.Gainsboro;
                }
                else
                {
                    e.Row.BackColor = System.Drawing.Color.White;
                }
            }
            // end if so this applies to header and data rows
            e.Row.Cells[0].Visible = false;
            e.Row.Cells[1].Visible = false;
            e.Row.Cells[2].Visible = false;

        } 
```

作为一个相当绿色的人，我花了很多时间在许多论坛上搜索和调试，以找出处理程序看不到隐藏的数据绑定字段，我似乎找不到如何根据隐藏字段设置 rowcolor 的答案，所以我虽然 id把这个贴出来让别人找到

如果任何专家知道更好或替代方法，也许他们还可以添加一些代码/评论欢呼！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:45:43.383

我想你可以像[这里](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewrow.dataitem.aspx)`DataItem`所说的那样使用

```
 // the underlying data item is a DataRowView object. 
  DataRowView rowView = (DataRowView)e.Row.DataItem;

  // Retrieve the EventTypeID value for the current row. 
  int a = Convert.ToInt32(rowView["EventTypeID"]); 
```

# c# - 如何将流上传到 Azure 媒体服务

> ID：14987405
> 
> 赞同：8
> 
> 时间：2013-02-20T18:34:52.373
> 
> 标签：c#, azure, asp.net-mvc-4, azure-media-services

我们使用 ASP.NET MVC 4 来允许用户通过我们的网站上传视频和音频。我想使用 Azure 媒体服务作为后端。

在遵循[Azure 的教程](http://www.windowsazure.com/en-us/develop/Media-Services/how-to-guides/media-services-dotnet/)时，我遇到的问题是 Azure 媒体服务 SDK 似乎不允许上传原始数据流。相反，我能找到的唯一上传方法使用路径字符串参数。

我想避免将文件保存到磁盘（[默认情况下它已经流式传输到磁盘](http://msdn.microsoft.com/en-us/library/system.web.httppostedfile.aspx)），并且能够将请求发布的文件直接流式传输到 Azure。

到目前为止，这是我的代码：

```
public void SaveMedia(string fileName, System.IO.Stream stream)
{
    CloudMediaContext mediaCloud = new CloudMediaContext("account", "key");
    AssetCreationOptions assetOptions = new AssetCreationOptions();
    var asset = mediaCloud.Assets.Create(fileName, assetOptions);

    var assetFile = asset.AssetFiles.Create(fileName);

    var accessPolicy = mediaCloud.AccessPolicies.Create(fileName, TimeSpan.FromDays(3), AccessPermissions.Write | AccessPermissions.List);

    var locator = mediaCloud.Locators.CreateLocator(LocatorType.Sas, asset, accessPolicy);

    assetFile.Upload("????????????");

    locator.Delete();
    accessPolicy.Delete();
} 
```

如何做到这一点？这会与使用 ASP.NET MVC 4 和 Azure 媒体服务处理上传的任何“最佳实践”冲突吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-21T08:09:53.993

您不应该使用 Azure 媒体服务进行上传，它不是为 inbound-stream-to-azure-storage-blob 设计的，这就是您所描述的。

直接使用 Azure 存储 SDK（使用 v1.7 来避免重新绑定问题）。存储 SDK 允许流写入 blob。为此，您需要先获取一个 SAS 写入定位器（看起来就像在那儿一样），然后使用 locator.Path.Segments 来查找资产容器。然后使用它在 Storage SDK 中使用 ClouBlobClient 直接上传——它在某处提供了流写入功能。

请注意上面的代码：您没有指定 AssetCreationOptions.None，因此它将假定存储中的文件将被存储加密（默认传输机制是安全的，而不是不安全的）。我认为您不会在上传之前对文件流进行存储加密，因此您最好将其设置为 AssetCreationOptions.None。

就个人而言，我不会走这条路。阅读我关于“创建自己的 youtube”的博文： [http ://blog-ndrouin.azurewebsites.net/?p=1471](http://blog-ndrouin.azurewebsites.net/?p=1471)

在其中，有一个使用服务器端提供的 SAS url 的客户端上传内容的完整示例（其中包含您的帐户凭据，您可能不希望在客户端浮动！）。

但是，客户端必须能够使用该 SAS URL 执行 PUT 到存储。就我而言，我使用了 C# 命令行应用程序。除非您的网页托管在与目标存储帐户相同的域中，否则您将无法在 HTML5 中执行此操作。如果您的网页（或管理上传的 I-Frame）与您的存储帐户不在同一个域中，这将在 HTML5 中触发对 Azure 存储 REST 层的 CORS“OPTIONS”调用，该层尚不支持 CORS .

托管在您的存储帐户中的 HTML5 I-Frame 的替代方案是： Sliverlight 或 Flash 在您的存储帐户的 $root 中使用跨域文件上传 shims（或者可能是在您的存储帐户中托管的那些插件对象，以避免跨域-文件请求）。

我不鼓励在 POST 中将文件流上传到服务器。这使您的 Web 服务成为所有入站文件的瓶颈；并且长 POST 不是特别稳定：您的应用程序池可能会在上传过程中被回收，而您则干杯。

PS。我们的团队（Windows Azure 媒体服务）主要监控这个论坛：

[http://social.msdn.microsoft.com/Forums/en-US/MediaServices/threads](http://social.msdn.microsoft.com/Forums/en-US/MediaServices/threads)

# backbone.js - REST api 中的骨干和复合模型 - 有可能吗？

> ID：14987408
> 
> 赞同：3
> 
> 时间：2013-02-20T18:35:12.100
> 
> 标签：backbone.js, backbone-routing, backbone-model

首先，我很抱歉，因为我不确定问题标题是否准确地描述了我正在尝试做的事情。我喜欢/讨厌主干 REST api 结构，但我正在尝试添加一点并支持模型之间关系的“图表”。

所以最简单的终点是这样的：

```
/machines/:id 
```

或者

```
/projects 
```

但我想更进一步，展示关系的“图表”：

```
/machines/:machine_id/projects 
```

或者

```
/machines/:machine_id/projects/:project_id 
```

我正在尝试考虑采取的最佳方法，并想知道是否有人愿意在这方面分享任何经验。就目前而言，我已经为`machines`和`projects`非关系端点工作定义了模型。我想我的下一步是创建一个虚构的复合模型`MachinesProjects`- 但不确定我将如何破解模型的 url 连接以响应表示 id 的不同属性。此外，我希望有更好的东西，因为我真的不想为模型类型之间的图中的每个弧明确定义一个模型。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:40:45.900

像下面这样的东西怎么样？

```
var Machine = Backbone.Model.extend({
  urlRoot:"/machines"
});

var Project = Backbone.Model.extend({
  urlRoot:"/projects"
});

var MachineProject = Project.extend({
  url: function() {
    return this.machine.url() + Project.prototype.url.call(this);
  },
  initialize: function(options) {
    this.machine = options.machine;
  }
}); 
```

# java - Java 多态性数组的子类型彼此

> ID：14987410
> 
> 赞同：0
> 
> 时间：2013-02-20T18:35:15.573
> 
> 标签：java, arrays, polymorphism, subtype

我知道Java是静态语言，并且在涉及数组时有动态检查：但我不明白为什么会发生这种情况，有人可以在这两种情况下向我解释这个例子：A []是B的子类型[]，还是 B[] 是 A[] 的子类型？哪个会失败，为什么？

```
f(A[] as) {
  as[0] = new A(); // **?!**
}

B[] bs = new B[10];
f(bs); // **?!**
B b = bs[0]; // **?!** 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:42:56.953

Java 中的数组是[协变](http://en.wikipedia.org/wiki/Covariance_and_contravariance_%28computer_science%29)的。

这意味着 if`B`是`A`then的子类型，`B[]`也是 的子类型`A[]`。因此，您可以传递预期的`B[]`位置`A[]`，就像您可以传递预期的`B`位置一样`A`。

但是如果你走相反的路，那么你需要一个明确的演员，比如 -

```
 B b = (B) new A(); //bypasses the compiler but fails at runtime
 B[] bs = (B[]) new A[1]; //also bypasses the compiler but fails at runtime 
```

# html - 将a的内容居中

> ID：14987414
> 
> 赞同：2
> 
> 时间：2013-02-20T18:35:35.600
> 
> 标签：html, center

我已经搜索和搜索，但我似乎无法找到解决问题的方法。我正在尝试将`<div>`标签的内容集中在我的文档正文中。它是一个移动站点，因此在各种不同的视口和设备上，左右边距必须相等。

这是我要居中的 div：

```
<div id="nav">
<a href="http://m.usci.westondev.com/healthcare-certificates-2/">Healthcare/a
<a href="http://m.usci.westondev.com/business-certificates-2/">Business</a><br />
<a href="http://m.usci.westondev.com/wellness-certificates-2/">Wellness</a><br />
<a href="http://m.usci.westondev.com/technology-certificates/">Technology</a><br />
<a href="http://m.usci.westondev.com/legal-certificates/">Legal</a><br />
<a href="http://m.usci.westondev.com/services-certificates-2/">Services</a>
</div> 
```

我认为可行的 CSS 很简单：

```
#nav {
margin-right:auto;
margin-left:auto;
display:block;
text-align:center;
width:100%;
} 
```

但是，这并不能解决问题。这个 div 嵌套在许多其他`<div>`标签中，我尝试将其`{margin-right:auto, margin-left:auto}`应用于所有标签，但似乎没有任何效果。

一定有什么我错过了，但我没有想法。

我正在处理的页面位于： http: [//m.usci.westondev.com](http://m.usci.westondev.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:39:55.800

给你试图居中的 div 一个宽度。你所有的父 div 的宽度都是 100%，所以这个也是。

自动通过在您的宽度未占用的任何 LEFTOVER 空间左右留边来工作。所以如果你给你的导航一个宽度=它的内容，它会正确居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:41:22.627

尝试使用 Chrome 开发者工具之类的工具进行调试。你会看到你的 A 标签占据了包含 div 的全部宽度。为它们设置宽度应该修复：

```
#page-container .page .content #nav a:link {width: 280px;} 
```

# javascript - 使用 AJAX 时如何控制 JavaScript 函数的顺序

> ID：14987415
> 
> 赞同：1
> 
> 时间：2013-02-20T18:35:35.943
> 
> 标签：javascript, ajax, asynchronous

## 我的设置

```
function ajaxLoadSth(value, attribute) {

    $.post( url, value, function(response) {

        // interpreting the response
        var foobar = $('#foo') + $('.bar').find('.sth');

        // print interpretation into DOM
        container.append(foobar);

        // do some funky stuff
        doSomeFooWithDom();
        checkSomeBarHere();
        updateSomeValuesThere();

        // now call the function again with different values 

        // THIS IS WHAT MY QUESTION REFERS TO **************
        if ( true ) {
            ajaxLoadSth(newValue, newAttribute);
        }
    });
} 
```

## 我的问题

该函数**不能在***// do some funky stuff* -part，一些 DOM 操作，完成执行之前调用自己-**但它确实如此**。

## 我的问题

*   这是为什么？是因为那些“时髦的东西”位于外部函数中吗？这对同步执行有影响吗？
*   **我怎样才能让“自己调用”等到上面的东西完成？**

**我已经考虑过通过设置全局变量**和**触发处理程序**来告诉它们准备好的函数。每次触发处理程序时，一个函数都会**检查**所有变量是否设置正确，**然后执行函数调用**。那个怎么样？

非常感谢您提前抽出时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:48:59.803

尝试回调例如。

```
doSomeFunkyStuff(callback){
//DO SOME FUNKY
  callback();
}

function ajaxLoadSth(value, attribute) {

    $.post( url, value, function(response) {

        // interpreting the response
        var foobar = $('#foo') + $('.bar').find('.sth');

        // print interpretation into DOM
        container.append(foobar);

        // do some funky stuff
        doSomeFunkyStuff(function(){
           ajaxLoadSth(newValue, newAttribute);
        }

    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:49:01.727

1.  函数是外部的这一事实并不重要。它们将同步执行：如果您使用 DOM 检查器并在这些函数中放置断点，您应该会发现它们将在 AJaX 调用自行调用之前按顺序执行。

2.  我认为这里的关键是“等到上面的东西完成”——这些函数将按照你调用它们的顺序执行，但“完成”的结果可能是异步的。

我写了一个插件来处理这种叫做[Pendant.js](https://github.com/barneycarroll/pendant.js)的东西。这个想法是，您希望根据各种依赖关系推迟（a）给定函数的执行：a`dependency`是您传递给 Pendant 的函数，它获取一个额外的参数，`resolve`，这是一个您可以在依赖项时调用的函数已经满足。然后你将你的递归调用作为 a 传递`dependant`，它只会在所有 Pendant 的依赖项都已解决时执行。

jQuery 还实现了开箱即用的“ [Promises](https://gist.github.com/domenic/3889970) ”，这正是我想要的，但是使用了一种面向 XHR 的语言，这让我感到不舒服。话虽如此，它可能更健壮（并且有据可查！），因此您可能应该看一下。

# vb.net - VB net 使用 form.show 时最小化 webbrowser 的表单

> ID：14987418
> 
> 赞同：0
> 
> 时间：2013-02-20T18:35:52.447
> 
> 标签：vb.net, forms, browser

这是我的问题，我使用 form1 (me) 和 webbrowser 来显示自定义错误，我检查 INI 文件以查看我需要的屏幕，然后我执行 navagate.webbrowser1 和网址，然后显示表格，网络浏览器占据整个表格。当我运行它时，我得到一个黑屏或一个白屏，或者前面没有设置表单我调用一个程序，在这个过程中在后台安装打印机。

我希望表单在前面，而其他程序运行并完成，这是我的程序的结尾，这在网页上有一些动画，向用户显示程序仍在运行，但我无法获得表格显示。

这是我的代码：

```
 '*********************************************************************************************
        'this set the correct screen for Exit
        '*********************************************************************************************
        RBoot = reboot1
        If RBoot = "True" Then

            closeweb = "https://xxxxxxxxxxxxxxx/_report/enrollment.asp?page=completesuccess"
            WebBrowser1.Navigate("https://XXXXXXXXXXXX/_report/enrollment.asp?page=completesuccess")
            var1 = 0
            Form9.Hide()
            Form10.Hide()
            Do Until var1 = 5
                Me.Show()
                Me.Refresh()
                Thread.Sleep(400)
            Loop

        ElseIf RBoot = "False" Then

            closeweb = "https://XXXXXXXXXXXXXX/_report/enrollment.asp?page=completenoreboot&name=" & computername
            WebBrowser1.Navigate("https://XXXXXXXXXXXXXXX/_report/enrollment.asp?page=completenoreboot&name=" & computername)
            var1 = 0
            Form9.Hide()
            Form10.Hide()
            Do Until var1 = 5
                Me.Show()
                Me.Refresh()
                Thread.Sleep(400)
            Loop

        End If

        '*********************************************************************************************
        ' this runs the Printer Installer
        '*********************************************************************************************
        Dim Compini As String = My.Computer.FileSystem.ReadAllText("C:\temp\computerinfo.ini")
        logg = "Computer Info INI:" & vbCrLf & Compini
        Call logging()

        If Compini.Contains("Printer") Then

            If My.Computer.FileSystem.FileExists(current_DIR & "\ Printer Installer\Printerinstaller.exe") Then
                Me.Show()
             Dim printerinstall As New Process
                printerinstall.StartInfo.FileName = current_DIR & "\Printer Installer\PrinterInstaller.exe"
                printerinstall.StartInfo.Arguments = " -D C"
                printerinstall.StartInfo.WindowStyle = ProcessWindowStyle.Hidden
                printerinstall.Start()
                Try
                    While printerinstall.HasExited = False
                        Thread.Sleep(200)
                        Me.Show()
                    End While
                Catch ex As InvalidOperationException
                End Try
                logg = "Ran " & current_DIR & "\Printer Installer\PrinterInstaller.exe"
                Call logging()
            Else
                logg = "Can't Find " & current_DIR & "\Printer Installer\PrinterInstaller.exe"
                Call logging()
                WebBrowser1.Navigate("https://XXXXXXXXXXXXXXXX/_report/enrollment.asp?page=printerinstallernotfound&name=" & computername)
                Form9.Hide()
                Form10.Hide()
                Me.Show()
                Exit Sub
            End If
        Else
            logg = "No Printer Selected and Printer Installer didn't run"
            Call logging()
        End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:43:19.340

您可以通过以下方式使表格保持在前面：

```
Form1.TopMost = True 
```

您可以最小化表单：

```
Form1.WindowState = FormWindowState.Minimized 
```

（如果您在同一表格上引用，请更改`Form1`为）`Me`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T20:08:13.137

为什么那里有“closeweb”变量？它似乎没有任何目的

您是否在其他地方重新使用“rebo​​ot1”？如果不是，为什么要更改顶部的变量名称？

考虑不要隐藏 form9 和 form10 - 您确定它们不包含您要显示的内容吗？

删除循环，代码是不必要的 - 有更好的方法来完成你在那里尝试做的事情。尝试在没有循环的情况下显示你的“我”表单，看看会发生什么（不要刷新）

在打印机安装过程中，您将再次隐藏和显示表单。你应该给他们起名字，这样你就可以更好地跟踪你在做什么。似乎所有这些隐藏和显示都导致了黑/白屏幕。

# debugging - Visual Studio 2012 卡在调试中

> ID：14987420
> 
> 赞同：0
> 
> 时间：2013-02-20T18:36:08.020
> 
> 标签：debugging, visual-studio-2012, freeze

我正在`WPF .Net Application`使用 VisualStudio2012 开发一个。从今天开始，当我尝试`debug`（也当我选择了发布）时，进程在`window`甚至打开之前挂起。我在中看到的最后一条消息`output window`是：

```
'MyProjectvshost.exe' (Managed (v4.0.30319)): Loaded 'C:\windows\assembly\GAC_MSIL\Microsoft.SqlServer.Types\11.0.0.0__89845dcd8080cc91\Microsoft.SqlServer.Types.dll' 
```

正如我已经提到的那样，它`WPF application`使用`MVVM Light`和`EF 4`与数据库连接到`MSSQL Server 2012`...

我已经尝试过的事情：

*   删除 obj 文件夹和 bin 文件夹
*   重新启动 VisualStudio 2012
*   重新启动 SQL Server
*   重新启动计算机
*   取消选中`Enable property evaluation and other implicit function calls`我的`Debugging Options`
*   取消选中`Enable Just My Code`我的`Debugging Options`

请帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:54:34.320

点击 VS 中的暂停按钮以查看您的代码卡在哪里。此外，您可以在代码的主入口点和 F11 处放置断点，直到找到（最有可能的）无限循环。

如果您使用 Pause 方法，您可以查看您的调用堆栈以找出是什么让您到达该点以及它可能在哪里循环/卡住

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:54:48.980

可能是与 MSQSQl 服务器的连接吗？如果您提供了错误的凭据，或者您的帐户没有足够的权限，您可能会遇到类似的情况。检查你的 EventViewer 看看你是否也有东西。

尝试使一个新的 WPF 项目变得简单（没有 DB 的东西），尝试调试它以查看它是否可以工作。如果是这样，请在该项目中添加一些 Db 内容并重试。

希望有帮助。

# java - IBM J9 规范将不允许从非引导类访问文件创建

> ID：14987425
> 
> 赞同：0
> 
> 时间：2013-02-20T18:36:32.470
> 
> 标签：java, windows-mobile, j9, ibm-jvm

我正在将 J9 规范 (wm50-arm-midp20_6.1.2.2) 用于在 windows mobile 上运行的 java 应用程序，并且遇到了需要创建文件的障碍。

我从 com.ibm.oti.connection.file.FileOutputStream 的 J9 构造函数中的这一行得到一个安全异常

```
 if (!com.ibm.oti.vm.VM.callerIsBootstrap())
        throw new SecurityException(); 
```

现在，大多数其他输出流类型都有一个支持 connection.java 类，通过该类发送调用，但没有一个支持文件流实现。

为了解决这个问题，我预计需要编写自己的 DLL 文件并从 java 代码中调用它，但我想知道是否有人遇到过这个问题并且能够解决它而无需调用本机 dll。

提前致谢！JR

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T14:27:18.167

我找到了我的答案。

要解决此问题，您需要访问文件系统的任何类都必须位于 J9 文件夹下的 ext 文件夹中。

在我的情况下，我使用[microlog](http://microlog.sourceforge.net/site/index.html "J2ME 和 MIDP 的 log4j 风格解决方案")作为我的日志记录解决方案，并正在寻找创建文件。我的应用程序 jar 不在 ext 文件夹中，所以我重新打包了所有内容，以便附加程序的 java 类位于 ext 文件夹中，以便 j9 jvm 将它们视为引导类。

如果有人有任何问题，请在评论中提出。

感谢所有看过这个的人。

# c# - 通过 Windows 服务使用多个线程将多个文件发送到多个 FTP 帐户的理想方式？

> ID：14987430
> 
> 赞同：0
> 
> 时间：2013-02-20T18:36:44.233
> 
> 标签：c#, multithreading, windows-services

Windows 服务需要根据客户端 ID 将多个文件发送到多个 FTP 文件夹。我的基本操作是定时器每 5 分钟调用一次**PerformTimerOperation 。**

**客户端.xml**

```
<clients>
  <client>
    <id>1</id>
    <name>client 1</name>
    <ftp>FTP URL1</ftp>
    <username>FTP USer1</username>
    <password>FTP Pass1</password>
  </client>
  <client>
    <id>2</id>
    <name>client 2</name>
    <ftp>FTP URL2</ftp>
    <username>FTP USer2</username>
    <password>FTP Pass2</password>
  </client>
</clients> 
```

**客户端.cs**

```
public class Clients
    {
        public string ClientName { get; set; }
        public string ClientId { get; set; }
        public string FTP { get; set; }
        public string Username { get; set; }
        public string Password { get; set; }

        public Clients()
        {
            ClientName = string.Empty;
            ClientId = string.Empty;
            FTP = string.Empty;
            Username = string.Empty;
            Password = string.Empty;
        }

        public List<Clients> GetClientList()
        {
            List<Clients> result;
            // load data file
            using (XmlTextReader xmlReader = new XmlTextReader("clients.xml"))
            {
                XDocument xdoc = XDocument.Load(xmlReader);

                var Clients = from clientItem in xdoc.Root.Elements()
                              select new Clients
                              {
                                  ClientName = clientItem.Element("name").Value,
                                  ClientId = clientItem.Element("id").Value,
                                  FTP = clientItem.Element("ftp").Value,
                                  Username = clientItem.Element("username").Value,
                                  Password = clientItem.Element("password").Value
                              };

                result = Clients.ToList();
            }
            return result;
        }
    } 
```

**服务实现.cs**

```
 public void OnStart(string[] args)
            {
                System.Threading.Thread.Sleep(1000);
                keepLooping = true;

                //new System.Threading.Thread(PerformTimerOperation).Name = "Thread ";
                new System.Threading.Thread(PerformTimerOperation).Start();
            }

    PerformTimerOperation
            private void PerformTimerOperation(object state)
            {
                while (keepLooping)
                {
                    Clients objClient= new Clients();
                    List<Clients> objClientList = objClient.GetClientList();

                    foreach (var list in objClientList)
                    {
                        ConsoleHarness.WriteToConsole(ConsoleColor.Cyan, list.ClientId);
                        ConsoleHarness.WriteToConsole(ConsoleColor.Cyan, list.ClientName);
                        ConsoleHarness.WriteToConsole(ConsoleColor.Cyan, list.FTP);
                        ConsoleHarness.WriteToConsole(ConsoleColor.Cyan, list.Username);
                        ConsoleHarness.WriteToConsole(ConsoleColor.Cyan, list.Password);

***// Here I would like to call individual client database, get data, convert to XLS and send to appropriate FTP.
// So, if I have 2 clients in the XML file. This loop will call each client one by one and send files to corresponding FTP.
// Is it possible to assign each operation to separate thread so that multiple threads can start sending files to different FTP accounts simultaneously?***

                     }

                    System.Threading.Thread.Sleep(50000);
                }

            } 
```

最佳实践和性能非常重要。此外，对当前方法的建设性批评持开放态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:53:40.930

一些注意事项和建议：

*   **使用[计时器和事件订阅](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx)而不是线程睡眠。**
*   提取客户端的功能 - 获取文件列表、处理、发送 - 到单独的方法。`Clients`方法将从当前循环迭代中获取实例。
*   一旦它是一个单独的方法，您就可以[生成一个新线程（来自 ThreadPool）](http://msdn.microsoft.com/en-us/library/4yd16hza.aspx)，将此方法名称作为线程方法和任何相关参数传递。
*   将 GetClientList() 设为静态，这样您就不必实例化该类的实例来调用它。你会打电话给`Clients.GetClientList()`。

请注意，在 MSDN 站点上的示例中，他们使用 a`Thread.Sleep()`来模拟线程同步。在您的情况下，这不是必需的，因为您正在运行服务 - 主线程不会结束，直到您告诉它这样做。

* * *

假设你实现了一个方法，例如`SendFilesToClient(Clients currentClient)`，你会像这样将它排队：

```
ThreadPool.QueueUserWorkItem(new WaitCallback(SendFilesToClient), list); 
```

# c# - 使用应用程序打开和关闭大写锁定

> ID：14987431
> 
> 赞同：3
> 
> 时间：2013-02-20T18:36:45.030
> 
> 标签：c#, capslock

我有下面的代码来更改应用程序启动时 Caps Lock 键的状态。

我想在启动应用程序时将 Caps Lock 状态更改为 ON（如果它已经打开，那么它应该保持打开）。当应用程序关闭时，Caps Lock 状态应更改为 OFF。关于如何实现这一目标的任何建议？

```
namespace WindowsFormsApplication2
{

    public partial class Form1 : Form
    {
        [DllImport("user32.dll")]
        static extern void keybd_event(byte bVk, byte bScan, uint dwFlags,
        UIntPtr dwExtraInfo);

        public Form1()
        {
            InitializeComponent();

            const int KEYEVENTF_EXTENDEDKEY = 0x1;
            const int KEYEVENTF_KEYUP = 0x2;
            keybd_event(0x14, 0x45, KEYEVENTF_EXTENDEDKEY, (UIntPtr)0);
            keybd_event(0x14, 0x45, KEYEVENTF_EXTENDEDKEY | KEYEVENTF_KEYUP,
            (UIntPtr)1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:39:42.290

看看这篇文章，了解 API 是否打开了大写锁定：-

[如何在 .net 中找到 NumLock、CapsLock 和 ScrollLock 的状态？](https://stackoverflow.com/questions/577411/how-can-i-find-the-state-of-numlock-capslock-and-scrolllock-in-net)

请参阅示例以获取评论：-

```
AppDomain.CurrentDomain.ProcessExit += new EventHandler(OnExit);

public void OnExit(object sender, EventArgs e)
{
    // check and turn caps off if neccessary
} 
```

# mysql - mySQL 将字符串中的字符转换为大写

> ID：14987433
> 
> 赞同：0
> 
> 时间：2013-02-20T18:36:50.453
> 
> 标签：mysql

我对数据库比较陌生，在将字符转换为大写方面需要一些帮助，我可以将整个字符串更改为大写或第一个字母，但是当我需要转换包含在字符串中的字母时就会出现问题。例如，如果麦当劳个人的姓氏，我需要将其更改为 McDonald，或者如果他们的姓名后有 jnr 或 snr，则需要将其更改为 Jnr 或 Snr。任何指导都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:08:49.097

根据您的要求，您可以使用 REPLACE() 函数。就像是，

```
UPDATE items SET lastname = REPLACE(lastname, 'MC', 'Mc\' ' ); 
```

对于“MCDonalds”输入，这将返回“Mc' Donalds”。

[http://www.sqlfiddle.com/#!2/6c1da/2](http://www.sqlfiddle.com/#!2/6c1da/2)

# string - Bash：在点字符后获取子字符串，比较

> ID：14987436
> 
> 赞同：2
> 
> 时间：2013-02-20T18:37:05.220
> 
> 标签：string, bash, compare

我有：

```
string1="start1.MATCH.ext"
string2="start2.qwer.ext"
string3="start3.MATCH.ext" 
```

...

我想取出每个字符串并在第一个句点之后提取部分，所以

```
MATCH.ext
qwer.ext
MATCH.ext 
```

然后比较这些子字符串，如果它们匹配，我可以在 if 语句中做一些事情：

```
if (substr[i] == substr[j]) //now I can do something with string1 and string3 
```

我怎样才能在 Bash 中做到这一点？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T18:41:54.923

您可以使用 截断字符串的前面`${var#*.}`，并与 进行比较`if [[ ... ]]`：

```
string1="start1.MATCH.ext"
string2="start2.qwer.ext"
string3="start3.MATCH.ext"

if [[ ${string1#*.} = ${string3#*.} ]]; then
        echo They match
else
        echo No match
fi 
```

# ruby-on-rails - after_create 用于在 oauth 用户使用 has_secure_password 的情况下设置虚拟密码摘要

> ID：14987438
> 
> 赞同：0
> 
> 时间：2013-02-20T18:37:11.743
> 
> 标签：ruby-on-rails, callback, ruby-on-rails-3.2, after-create

我将 has_secure_password 与用户模型一起使用。如果用户通过 oauth 注册，我想将 password_digest 字符串设置为虚拟值。目前，我只在做 facebook 并使用 facebook_id 保存用户。我想添加以下类似的逻辑：

```
class User < ActiveRecord::Base
  has_secure_password
  attr_accessible :facebook_id
  after_create :update_password_digest_if_from_facebook

  def update_password_digest_if_from_facebook
    logger.info "here within update_password_digest_if_from_facebook" # this gets called
    if self.facebook_id # not seen?
      self.password_digest='oauth-account'
      self.save  
    end
    logger.info "there is a facebook_id" if self.facebook_id # this isn't called 
  end
  ...
end 
```

但是，没有正确调用 update_password_digest_if_from_facebook 中的部分。我可以在这里访问自我吗？

虽然这无疑是一种绕过 has_secure_password 的骇人听闻的方法，但为什么不执行对 self.facebook_id 的调用？看来我现在应该可以访问 self 了。

提前谢谢

# java - 硒不能与 chromedriver 一起使用

> ID：14987442
> 
> 赞同：0
> 
> 时间：2013-02-20T18:37:17.083
> 
> 标签：java, google-chrome, selenium

我的测试代码在 Firefox 和 IE 上运行良好，但它不适用于 chrome，当我运行测试文件时，chrome 窗口会打开一段时间，它在 url-bar 中显示 url，在状态栏中显示消息 Resolving...

然后chrome窗口关闭，测试失败。相同的测试适用于 IE 和 Firefox。

我的 chrome 版本是： `24.0.1312.57 m` 我使用了`http://code.google.com/p/chromedriver/downloads/list` 两者的最新驱动程序

```
chromedriver_win_23.0.1240.0.zip
chromedriver_win_26.0.1383.0.zip 
```

# html - 如何让浮动 div 直接中断到视口的左侧？

> ID：14987443
> 
> 赞同：0
> 
> 时间：2013-02-20T18:37:17.747
> 
> 标签：html, css, css-float

请看下面的例子，慢慢缩小你的视口宽度。

随着视口宽度的缩小，我希望第 4 个 div 直接位于第一个 div 下方，然后随着它进一步缩小，我希望第 3 个 div 在第 1 个下方，第 4 个在第 2 个下方。我明白为什么会发生这种情况，我只是不知道该怎么做才能得到我想要的行为。

请帮忙！

```
<html>
<head>
<style>

.columnClass
{
    float:left;
    border: 2px solid;
}

</style>
</head>
<body>

<div class="columnClass">
    <img src="http://thecybershadow.net/misc/stackoverflow.png" width="400" height="400"/>
</div>

<div class="columnClass">
    <img src="http://thecybershadow.net/misc/stackoverflow.png" width="200" height="600"/>
</div>

<div class="columnClass">
    <img src="http://thecybershadow.net/misc/stackoverflow.png" width="400" height="400"/>
</div>

<div class="columnClass">
    <img src="http://thecybershadow.net/misc/stackoverflow.png" width="200" height="600"/>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:58:29.250

将您的类参数更改为：

```
.columnClass
{
    display: inline-block;
    vertical-align: top;
    border: 2px solid;
} 
```

[http://jsfiddle.net/N7usG/](http://jsfiddle.net/N7usG/)
在这里，我减小了图像的宽度以使其正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:43:47.767

带有浮动的元素：左；会尽可能地向左漂浮，直到他们撞到什么东西。在你的情况下，你有交替长度的图片。当第四个的左上角碰到第二个的右下角时，它就停止了。你可以做的是：

```
<style>
.columnClass {
    height: 600px;
    float: left;
}
</style> 
```

这应该给容器一个恒定的高度，以便它们按照您想要的方式浮动。

# java - 来自可运行线程的返回值

> ID：14987444
> 
> 赞同：0
> 
> 时间：2013-02-20T18:37:21.453
> 
> 标签：java, multithreading

有 N 个线程，每个线程在自己的成员变量“status”中将状态设置为 0 或 1。在调用者中，如果任何一个线程的状态为 1，则整体状态必须变为 1。

这些线程以批处理模式运行。因此，如果任何失败都需要再次运行。我需要想出一些处理失败的方法，以便剩余的线程也立即停止。

然而，线程是可运行的，而不是可调用的。

我们可以使用 volatile 布尔变量在线程之间进行通信以发出故障信号。但是，我需要知道如何从调用者的可运行线程中读取单个状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:10:09.530

有几种方法可以做到这一点，我敢肯定。一种方法是使用完成服务。这是一些（粗略测试过的）代码：

```
public void allSucceed(final List<MyRunnable> tasks) {
    if (tasks == null || tasks.size() == 0)
        return;

    int status = 0;

    boolean success = true;
    do {
        final ExecutorService executorService = Executors
                .newFixedThreadPool(tasks.size());
        final CompletionService<MyRunnable> completionService = new ExecutorCompletionService<MyRunnable>(
                executorService);
        for (final MyRunnable task : tasks) {
            completionService.submit(task, task);
        }

        for (int i = 0; i < tasks.size(); i++) {
            try {
                status = completionService.take().get().getStatus();
            } catch (final Exception e) {
                success = false;
                break;
            }

            if (status == 0) {
                System.out.println("A task failed. All will be rerun");
                executorService.shutdownNow();
                success = false;
                break;
            }
        }
    } while (!success);
} 
```

将任务（Runnables）设计为可中断的至关重要，否则任何停止它们的尝试都是徒劳的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:04:08.920

您可以简单地要求线程在调用者的线程中设置一个值：

调用者中的字段：

```
int[] status = new int[NUM_THREADS]; 
```

然后给每个 Runnable 一个索引，这样它就可以在数组中设置它的状态，例如：

```
for (int i = 0; i < NUM_THREADS; i++) {
    final index = i;

    Runnable r = new Runnable() {
        void run() {
            // have your code stop occasionally to check for any failures
            if (>I failed>)
                status[index] = 1;
        }
    }
    // start thread using Runnable
} 
```

要检测停止，请让您的 Runnables 偶尔检查数组中的任何故障，或者您可以`boolean`向调用者类添加单独的标志：

```
volatile boolean failed = false;
Object lock = new Object(); 
```

然后在您的可运行文件中：

```
if (<I failed>) {
    synchronised (lock) {
        failed = true;
    }
} 
```

并且您在工作期间对失败的检查将是：

```
synchronised (lock) {
    if (failed) {
        // clean up resources
        status[index] = -1; // consider using a separate value for "halted"
        return;
    }
} 
```

# javascript - 为什么点击div后会形成循环？

> ID：14987445
> 
> 赞同：4
> 
> 时间：2013-02-20T18:37:21.640
> 
> 标签：javascript, jquery, html, click

我有样式文件输入：

```
<div class="fakeFileContainer">
 <div class="fakeFile">Dołącz brief</div>
 <input id="file" type="file" name="file"/>
</div> 
```

对于这部分代码，我有一些 js 行：

```
var fileInput = $('#contact #file')

fileInput.change(function(){
    $this = $(this);
    $('#contact form .fakeFile').text($this.val());
})

$('#contact form .fakeFileContainer').on('click', function () {
    fileInput.click(); //looping here
}).show(); 
```

单击后，`.fakeFileContainer`我在控制台中收到此错误消息：

```
Uncaught RangeError: Maximum call stack size exceeded 
```

它是由循环引起的，但我不知道为什么这里会形成这个循环。可以来解释一下这种情况的原因吗？

* * *

*PS 请原谅任何拼写或语法错误，英语不是我的第一语言*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:40:26.977

您的点击`fileInput`也由该功能处理（因为容器会冒泡）。所以代码说：“点击时，触发另一个点击事件”。第二次单击事件会导致再次询问相同的问题，答案是再次触发另一个单击事件。因此，一个无限循环。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T18:41:08.713

触发的点击事件会冒泡，您在父元素上捕捉到它以触发下一次点击 - 创建一个无限循环。为了防止这种情况，您可以

*   `stopPropagation`输入上的点击事件
*   如果在输入上发出已处理的事件，则不触发点击（通过检查`srcElement`）
*   或将点击处理程序放在`.fakeFile`div 而不是周围的容器上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:42:08.083

上的点击事件`fileInput`导致事件冒泡到`.fakeFileContainer`. 将您的点击事件更改为不冒泡：

```
$('#contact form .fakeFileContainer').on('click', function (e) {
    e.stopPropagation();
    fileInput.click();
}).show(); 
```

某种组合应该可以防止它循环到`.fakeFileContainer`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-08T07:41:55.453

```
 $("#fakeFileContainer").on('click', function (e) {

        e.stopPropagation();
        console.log(e);

        $("#file")[0].click();

    }); 
```

将类“fakeFileContainer”更改为 id“fakeFileContainer”并放入 $("#file")[0].click(); 这对我有用。

# c++ - 对象的显式声明

> ID：14987446
> 
> 赞同：1
> 
> 时间：2013-02-20T18:37:23.407
> 
> 标签：c++, constructor

如何在下面的代码中对对象进行显式初始化...

```
#include"iostream"
using namespace std;

class per{
    char *name;
    int a;
public:
    per(int x = 0,char *str = 0):a(x),name(str){}

    char* get()
    {
        return name;
    }
};
int main()
{

    per obj(100,"test"); // works fine
    // now if i want a explicit initialization for above how will i do?
    // example -- per obj = (100,"test");
    // but i am getting error or may be not aware how to use
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:38:19.467

怎么样

```
per obj = per(100,"test"); 
```

这些术语是**直接**和**复制初始化**。

您的初始化也是明确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T04:41:34.073

让我们讨论一下注释代码中的实际问题是什么，即`per obj = (100,"test");`. 这不会被初始化，因为首先对语句进行评估`100,`（我的意思是逗号运算符），然后进行初始化。

所以现在作业`per obj = (100,"test");`看起来像`per obj = "test";`. 这会导致编译错误，因为预期的第一个参数`int`不是 a `char *`。你应该很幸运能把这个天窗问题当作编译问题。只需更改构造函数中的初始化顺序，这就会消失..导致一个重大错误被忽视。基本上，在这种情况下，您所期望的以及编译器如何处理语句是不同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:03:37.553

如果你的编译器支持 C++11，你可以这样做：

```
per obj = { 100, "test" }; 
```

# angularjs - Angular.js 默认过滤

> ID：14987447
> 
> 赞同：0
> 
> 时间：2013-02-20T18:37:23.787
> 
> 标签：angularjs

我有一个带有表格和选择的简单页面。我需要使用在 html 选择中预选的默认值应用过滤。当页面完成加载阶段时，需要立即应用过滤器。这是我的代码：

选择：

```
<select class="span2" ng-model="fiASS">
        <option></option>
        <option>Ftse Mib</option>
        <option ng-selected="selected">Nasdaq</option>
        <option>Dow Jones</option>
        <option>Dax</option>
        <option>Cac40</option>
    </select> 
```

中继器和过滤器

```
<tr ng-repeat="obj in titoliASS | filter:filtroASS | filter:exchange| filter:poASS | orderBy:predicateASS:reverseASS">
            <td>{{obj.TITOLO}}</td>
            <td class="hidden-phone">{{obj.INDICE}}</td>
            <td>{{obj.POSIZIONE}}</td>
            <td class="hidden-phone">{{obj.PREZZO}}</td>
            <td class="hidden-phone">{{obj.S1}}</td>
            <td class="hidden-phone">{{obj.R1}}</td>
            <td class="hidden-phone">{{obj.S2}}</td>
            <td class="hidden-phone">{{obj.R2}}</td>
            <td><a href="Technical_Analysis.html?idtitolo={{obj.ID}}&titolo={{obj.TITOLO}}"><i class='icon-signal xmlcursor'></i></a></td>
        </tr> 
```

选择中默认值的预选有效，但未应用过滤器。仅当我更改选择的值时才应用过滤器。我希望问题很清楚。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:57:33.963

你有几个问题。首先，您的`ng-selected`表达式与您的模型不匹配。

其次，即使这样做了，它也不会从 html 中提取出来；该`fiASS`变量需要在控制器的范围内设置。

但是，假设 的数据`select`是静态的，您可以将其编码在控制器中而不是 HTML 中并使用`ng-options`：

```
<select ng-model='fiASS' ng-options='index for index in indices'></select> 
```

在你的控制器中：

```
$scope.fiASS = 'Nasdaq';
$scope.indices = ['Ftse Mib', 'Nasdaq', 'Dow Jones', 'Dax', 'Cac40']; 
```

这将在加载代码后正确设置模型，并且`fiASS`应该应用您的过滤器（假设它们依赖于 的值）。

[这是一个小提琴](http://jsfiddle.net/f49Fy/)。

# java - 使用 JTable 显示流数据时性能缓慢

> ID：14987449
> 
> 赞同：3
> 
> 时间：2013-02-20T18:37:32.110
> 
> 标签：java, performance, swing, jtable, event-dispatch-thread

我引用的代码是专有的，需要多播服务器，所以我不能发布 SSCCE 片段。我知道这可能会排除任何会引起可行响应的有用见解...

我正在使用 Java 7 u 9 进行编译。

我目前在一个 GUI 应用程序中使用 JTable 来侦听多播数据，并在它到达时显示它。滚动表格或调整列大小时，应用程序的响应速度极慢。

我认为我适当地构建了我的代码。

我使用了一个包装类，在它的 main() 函数中，它创建了一个自身的实例，该实例处理命令行参数、创建侦听器、创建 JFrame 并调用返回 JTable 的类。这一切都在事件分派线程之外完成。

然后，在下一行中，我使用 invokeLater() 方法创建了一个处理所有 GUI 呈现的线程。它创建一个 JScrollPane，将 JTable 添加到滚动窗格，设置滚动条，设置视口，设置滚动模式，并将 JScrollPane 添加到 JFrame 中。这一切都在事件调度线程中处理。

这些行通常会很快填充，偶尔会出现屏幕冻结（有些行包含 30 行或更多行），但响应性似乎可以接受。但是，当滚动或调整列大小时，响应非常慢。

我见过的所有示例，包括 SwingX SwingLabs 演示，都指的是预先加载的初始数据集。我需要一个将 JTable 与流数据一起使用的示例。

谁能指出我这样的例子/演示？

这是我的 main() 片段...

```
public static void main(String args[]) 
{
    final JXTrapTableGUI ttg = new JXTrapTableGUI(args);
    SwingUtilities.invokeLater(new Runnable()
    {
        public void run() 
        {
            ttg.createAndShowGUI();
        }
    });
} 
```

PS。我要感谢每一位做出回应的人。在 3 月 11 日之前，我已退出该项目，但我将在该日期审查所有回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:50:46.733

我认为 JTable 根本不能很好地处理流数据。如果 TableModel 不包含真实列表而是包含与数据流的某些连接，那么您提到的所有优化技术（例如使处理脱离事件调度线程）都是无关紧要的。

如果不了解您如何尝试处理此问题，则很难确切知道为什么它很慢。但这里是我如何使它具有响应性：创建一个存储列表的 ListModel - 不是对流的引用，只是一个普通的列表。让另一个线程从流中捕获多播数据，让我们调用它`DataStreamCollector`。然后启动一个在计时器 ( `javax.swing.Timer`) 上运行的线程，该计时器检查`DataStreamCollector`并根据需要更新 ListModel。

我在这里的设计是假设 UI 响应比 100% 与数据流同步更重要。调整计时器应该可以让您在拥有最新表格和拥有响应式 UI 之间进行权衡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T19:58:28.527

在`Oracles`清理垃圾中迷失的地方（旧的太阳队教程），

这个项目被称为`ChristmastTree`, 是关于`JTable`& `Performance`,

`SwingWorker`从黑洞调用疯狂和混乱之前的标准Java代码称为`Executor`

```
import java.awt.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.plaf.basic.*;
import javax.swing.table.*;

/**
 * CTTable extends JTable doing the following: <ul> <li>The UI is forced to be
 * CTTableUI so that a customer CellRendererPane can be installed.
 * <li>getCellRenderer is overriden to return the TableCellRenderer passed into
 * the constructor. <li>tableChanged is overriden to pass the call to super only
 * if the cell is visible. </ul>
 */
public class CTTable extends JTable {

    private static final long serialVersionUID = 1L;
    private CTTableCellRenderer renderer;

    public CTTable(CTTableCellRenderer renderer) {
        super();
        this.renderer = renderer;
        renderer.setFont(getFont());
    }

    @Override
    public void updateUI() {
        super.updateUI();
        //Force the UI to be an instanceof CTTableUI. This approach will not work
        //if you need to support more than one look and feel in your application.
        setUI(new CTTableUI());
    }

    @Override
    public void setFont(Font font) {
        super.setFont(font);
        if (renderer != null) {
            renderer.setFont(font);
        }
    }

    @Override
    public TableCellRenderer getCellRenderer(int row, int column) {
        return renderer;
    }

    @Override
    public void tableChanged(TableModelEvent e) {
        if (e instanceof VisibleTableModelEvent && !((VisibleTableModelEvent) e).isVisible(this)) {
            return;// Do nothing if this cell isn't visible.
        }
        super.tableChanged(e);
    }

    private static class CTTableUI extends BasicTableUI {

        @Override
        public void installUI(JComponent c) {        
            super.installUI(c);// Overriden to install our own CellRendererPane
            c.remove(rendererPane);
            rendererPane = new CTCellRendererPane();
            c.add(rendererPane);
        }
    }

    /**
     * CTCellRendererPane overrides paintComponent to NOT clone the Graphics
     * passed in and NOT validate the Component passed in. This will NOT work if
     * the painting code of the Component clobbers the graphics (scales it,
     * installs a Paint on it...) and will NOT work if the Component needs to be
     * validated before being painted.
     */
    private static class CTCellRendererPane extends CellRendererPane {

        private static final long serialVersionUID = 1L;
        private Rectangle tmpRect = new Rectangle();

        @Override
        public void repaint() {
            // We can safely ignore this because we shouldn't be visible
        }

        @Override
        public void repaint(int x, int y, int width, int height) {
        }

        @Override
        public void paintComponent(Graphics g, Component c, Container p, int x, 
        int y, int w, int h, boolean shouldValidate) {
            if (c == null) {
                if (p != null) {
                    Color oldColor = g.getColor();
                    g.setColor(p.getBackground());
                    g.fillRect(x, y, w, h);
                    g.setColor(oldColor);
                }
                return;
            }
            if (c.getParent() != this) {
                this.add(c);
            }
            c.setBounds(x, y, w, h);
            // As we are only interested in using a JLabel as the renderer, 
            //which does nothing in validate we can override this to do nothing,
            //if you need to support components that can do layout, this will 
            //need to be commented out, or conditionally validate.
            shouldValidate = false;
            if (shouldValidate) {
                c.validate();
            }
            boolean wasDoubleBuffered = false;
            JComponent jc = (c instanceof JComponent) ? (JComponent) c : null;
            if (jc != null && jc.isDoubleBuffered()) {
                wasDoubleBuffered = true;
                jc.setDoubleBuffered(false);
            }//Don't create a new Graphics, reset the clip and translate the origin.
            Rectangle clip = g.getClipBounds(tmpRect);
            g.clipRect(x, y, w, h);
            g.translate(x, y);
            c.paint(g);
            g.translate(-x, -y);
            g.setClip(clip.x, clip.y, clip.width, clip.height);
            if (wasDoubleBuffered) {
                jc.setDoubleBuffered(true);
            }
            c.setBounds(-w, -h, 0, 0);
        }
    }
} 
```

.

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.*;
import javax.swing.table.*;

/**
 * A custom TableCellRenderer that overrides a handful of methods: <ul>
 * <li>isOpaque and setBackground are overridden to avoid filling the
 * background, if possible. <li>firePropertyChange is overridden to do nothing.
 * If you need to support HTML text in the renderer than this should NOT be
 * overridden. <li>paint is overridden to forward the call directly to the UI,
 * avoiding the creation of a Graphics. This will NOT work if you need the
 * renderer to contain other childre or the Graphics is clobbered as part of
 * painting the UI. </ul>
 */
public class CTTableCellRenderer extends DefaultTableCellRenderer {

    private static final long serialVersionUID = 1L;
    private Color background;
    private Color foreground;
    private Color editableForeground;
    private Color editableBackground;
    private Border focusBorder;

    public CTTableCellRenderer() {
        focusBorder = UIManager.getBorder("Table.focusCellHighlightBorder");
        editableForeground = UIManager.getColor("Table.focusCellForeground");
        editableBackground = UIManager.getColor("Table.focusCellBackground");
    }

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value,
            boolean isSelected, boolean hasFocus, int row, int column) {
        boolean negative = (value != null && ((Integer) value).intValue() < 0);
        // Reset the background based on the sign of the value.
        if (isSelected) {
            setForeground(table.getSelectionForeground());
            setBackground(table.getSelectionBackground());
        } else {
            setForeground(table.getForeground());
            if (!negative) {
                setBackground(null);
            } else {
                setBackground(Color.red);
            }
        }//NOTICE that we do NOT set the font here, because CTTable knows about
         //us, it will set the font as appropriate.
        if (hasFocus) {
            setBorder(focusBorder);
            if (table.isCellEditable(row, column)) {
                setForeground(editableForeground);
                setBackground(editableBackground);
            }
        } else {
            setBorder(noFocusBorder);
        }
        setValue(value);
        return this;
    }

    @Override
    protected void firePropertyChange(String propertyName, Object oldValue, Object newValue) {
        // As long as you don't have any HTML text, this override is ok.
    }

    @Override// This override is only appropriate if this will never contain 
            // any children AND the Graphics is not clobbered during painting.
    public void paint(Graphics g) {
        ui.update(g, this);
    }

    @Override
    public void setBackground(Color c) {
        this.background = c;
    }

    @Override
    public Color getBackground() {
        return background;
    }

    @Override
    public void setForeground(Color c) {
        this.foreground = c;
    }

    @Override
    public Color getForeground() {
        return foreground;
    }

    @Override
    public boolean isOpaque() {
        return (background != null);
    }

    @Override // This is generally ok for non-Composite components (like Labels)
    public void invalidate() {
    }

    @Override // Can be ignored, we don't exist in the containment hierarchy.
    public void repaint() {
    }
} 
```

.

```
import javax.swing.table.*;
import java.util.*;

/**
 * CTTableModel, a TableModel, models a set of Datas as the rows. The data is
 * stored in a List of Lists. As the changes come in against a particular Data
 * object we also contain a map from Data to row. This can obviously be made
 * faster by pushing the row to the Data, but this may not be feasable in
 * applications of this sort.
 */
public class CTTableModel extends AbstractTableModel {

    private static final long serialVersionUID = 1L;
    /**
     * Maps from Data to an integer id giving the row of the data.
     */
    private Map rowMap;
    /**
     * Number of columns to display.
     */
    private int columns;
    /**
     * A List of Lists.
     */
    private java.util.List rowData;
    /**
     * If true, batch cell updates using sharedModelEvent.
     */
    private boolean batchChange;
    /**
     * Shared model event.
     */
    private VisibleTableModelEvent sharedModelEvent;

    public CTTableModel(int columns) {
        this.columns = columns;
        // Notice how they are not synchronized, we do NOT access this class
        // from another thread, and therefore do not have to worry about
        // synchronization.
        rowData = new ArrayList();
        rowMap = new HashMap();
    }

    public void addRow(Data rowID) {
        int row = rowData.size();
        rowMap.put(rowID, new Integer(row));
        ArrayList colData = new ArrayList();
        for (int counter = 0; counter < columns; counter++) {
            colData.add(null);
        }
        rowData.add(colData);
        fireTableRowsInserted(row, row);
    }

    /**
     * Toggles batch updates. When true and model changes are notified using a
     * VisibleTableModelEvent.
     *
     * @param batch
     */
    public void setBatchUpdates(boolean batch) {
        this.batchChange = batch;
        if (sharedModelEvent == null) {
            sharedModelEvent = new VisibleTableModelEvent(this);
        }
        sharedModelEvent.reset();
    }

    public boolean getBatchUpdates() {
        return batchChange;
    }

    /**
     * Sets the display value for a particular Data item at a particular cell.
     * If notify is true listeners are notified, otherwise no listeners are
     * notified.
     *
     * @param rowID
     * @param col
     * @param data
     * @param notify
     */
    public void set(Data rowID, int col, Object data, boolean notify) {
        int row = ((Integer) rowMap.get(rowID)).intValue();
        ((java.util.List) rowData.get(row)).set(col, data);
        if (notify) {
            if (batchChange) {
                sharedModelEvent.set(row, col);
                fireTableChanged(sharedModelEvent);
            } else {
                fireTableCellUpdated(row, col);
            }
        }
    }

    @Override
    public int getRowCount() {
        return rowData.size();
    }

    @Override
    public int getColumnCount() {
        return columns;
    }

    @Override
    public Object getValueAt(int rowIndex, int columnIndex) {
        return ((java.util.List) rowData.get(rowIndex)).get(columnIndex);
    }
} 
```

.

```
/**
 * Unique ID for the data.
 */
public class Data {

    /**
     * This is overriden to remind developers they should have an intelligent
     * equals and hashCode. You do not need to override either of them, but if
     * you override one you need to override the other. Additionaly, because
     * they are used extensively to map the data that has changed to the table,
     * equals and hashCode MUST be fast, cache data if you need to!
     *
     * @param x
     */
    @Override
    public boolean equals(Object x) {
        return (this == x);
    }

    /**
     * This is overriden to remind developers they should have an intelligent
     * equals and hashCode. You do not need to override either of them, but if
     * you override one you need to override the other. Additionaly, because
     * they are used extensively to map the data that has changed to the table,
     * equals and hashCode MUST be fast, cache data if you need to!
     */
    @Override
    public int hashCode() {
        return super.hashCode();
    }
} 
```

.

```
import java.util.ArrayList;

/**
 * DataChange is used to associate a Data Object with a column identifier that
 * has changed. To avoid loads of garbage per update DataChanges are cached and
 * reused.
 */
public class DataChange {

    private static ArrayList sharedDataChanges = new ArrayList();
    private Data data;
    private int col;
    private int hashCode;

    /**
     * Obtains a DataChange for the specified Data and column.
     *
     * @param data
     * @param col
     * @return
     */
    public static DataChange getDataChange(Data data, int col) {
        synchronized (sharedDataChanges) {
            int size = sharedDataChanges.size();
            if (size > 0) {
                DataChange change = (DataChange) sharedDataChanges.remove(size - 1);
                change.data = data;
                change.col = col;
                return change;
            }
        }
        return new DataChange(data, col);
    }

    /**
     * Indicates the DataChange is no longer needed and can be reused.
     *
     * @param change
     */
    public static void releaseDataChange(DataChange change) {
        synchronized (sharedDataChanges) {
            sharedDataChanges.add(change);
        }
    }

    DataChange(Data data, int col) {
        this.data = data;
        this.col = col;
        hashCode = (data.hashCode() | col);
    }

    public Data getData() {
        return data;
    }

    public int getColumn() {
        return col;
    }

    @Override
    public int hashCode() {
        return hashCode;
    }

    public boolean equals(DataChange dc) {
        if (dc == this) {
            return true;
        }
        DataChange o = (DataChange) dc;
        return (o.data == data && o.col == col);
    }
} 
```

.

```
import java.awt.*;
import java.awt.event.*;
import java.util.*;
import javax.swing.*;
import javax.swing.event.*;

/**
 * The Main controller, responsible for wiring everything together. Pressing
 * return in any of the fields will trigger recreation of everything.
 */
public class Main implements ActionListener {

    // properties: columnCount, rowCount, updateSleepTime, eqSleepTime, 
    // threshold, generateSleep, generatorBatchCount

    private static final Insets EMPTY_INSETS = new Insets(0, 0, 0, 0);
    private JTextField columnCount;
    private JTextField rowCount;
    private JTextField updateSleepTime;
    private JTextField eqSleepTime;
    private JTextField threshold;
    private JTextField generateSleep;
    private JTextField generatorBatchCount;
    private JFrame frame;
    static JLabel totalUpdateTime;
    static JLabel notifyTime;
    static JLabel paintTime;
    static JLabel updateCount;
    private JTable table;
    private UpdateThread updateThread;
    private GeneratorThread generatorThread;
    private CTTableModel tableModel;
    private static int NUM_COLUMNS = 40;// Initial values for the 7 properties.
    private static int NUM_ROWS = 3000;
    private static int UPDATE_SLEEP_TIME = 500;
    private static int EQ_SLEEP_TIME = 10;
    private static int UPDATE_ALL_THRESHOLD = 400000;
    private static int GENERATOR_SLEEP_TIME = 40;
    private static int BATCH_SIZE = 1000;

    Main() {
        frame = new JFrame();
        frame.getContentPane().setLayout(new GridBagLayout());
        columnCount = add("Columns: ", NUM_COLUMNS);
        rowCount = add("Rows: ", NUM_ROWS);
        updateSleepTime = add("Update Sleep: ", UPDATE_SLEEP_TIME);
        eqSleepTime = add("EQ Sleep: ", EQ_SLEEP_TIME);
        threshold = add("Update All Threshold: ", UPDATE_ALL_THRESHOLD);
        generateSleep = add("Generator Sleep: ", GENERATOR_SLEEP_TIME);
        generatorBatchCount = add("Batch Size: ", BATCH_SIZE);
        table = new CTTable(new CTTableCellRenderer());
        table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        JScrollPane sp = new JScrollPane(table);
        frame.getContentPane().add(sp, new GridBagConstraints(0, 3, 6, 1, 1, 1, 
                GridBagConstraints.WEST, GridBagConstraints.BOTH, EMPTY_INSETS, 0, 0));
        ChangeListener changeListener = new ChangeListener() {

            @Override
            public void stateChanged(ChangeEvent e) {
                BoundedRangeModel m = (BoundedRangeModel) (e.getSource());
                if (updateThread != null) {
                    updateThread.setUpdatesEnabled(!(m.getValueIsAdjusting()));
                }
            }
        };
        sp.getVerticalScrollBar().getModel().addChangeListener(changeListener);
        sp.getHorizontalScrollBar().getModel().addChangeListener(changeListener);
        totalUpdateTime = new JLabel(" ");
        notifyTime = new JLabel(" ");
        paintTime = new JLabel(" ");
        updateCount = new JLabel(" ");
        JPanel statusPanel = new JPanel(new GridBagLayout());
        frame.getContentPane().add(statusPanel, new GridBagConstraints(0, 4, 6, 1, 1, 0, 
                GridBagConstraints.WEST, GridBagConstraints.HORIZONTAL, EMPTY_INSETS, 0, 0));
        statusPanel.add(totalUpdateTime, new GridBagConstraints(0, 0, 1, 1, 1, 0, 
                GridBagConstraints.WEST, GridBagConstraints.HORIZONTAL, EMPTY_INSETS, 0, 0));
        statusPanel.add(notifyTime, new GridBagConstraints(1, 0, 1, 1, 1, 0, 
                GridBagConstraints.WEST, GridBagConstraints.HORIZONTAL, EMPTY_INSETS, 0, 0));
        statusPanel.add(paintTime, new GridBagConstraints(2, 0, 1, 1, 1, 0, 
                GridBagConstraints.WEST, GridBagConstraints.HORIZONTAL, EMPTY_INSETS, 0, 0));
        statusPanel.add(updateCount, new GridBagConstraints(3, 0, 1, 1, 1, 0, 
                GridBagConstraints.WEST, GridBagConstraints.HORIZONTAL, EMPTY_INSETS, 0, 0));
        frame.setTitle("Christmas Tree Demo Application");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setBounds(0, 0, 1000, 800);
        frame.setVisible(true);
        try {
            Thread.sleep(5000);
        } catch (InterruptedException ie) {
        }
        reset();
    }

    @Override
    public void actionPerformed(ActionEvent ae) {
        reset();
    }

    private JTextField add(String name, int defaultValue) {
        Container parent = frame.getContentPane();
        int row = parent.getComponentCount() / 6;
        int col = parent.getComponentCount() % 6;
        parent.add(new JLabel(name), new GridBagConstraints(col, row, 1, 1, 0, 0, 
                GridBagConstraints.WEST, 0, EMPTY_INSETS, 0, 0));
        JTextField tf = new JTextField(Integer.toString(defaultValue));
        tf.addActionListener(this);
        parent.add(tf, new GridBagConstraints(col + 1, row, 1, 1, 1, 0, 
                GridBagConstraints.WEST, GridBagConstraints.HORIZONTAL, EMPTY_INSETS, 0, 0));
        return tf;
    }

    private void reset() {
        System.out.println("Columns: " + getInt(columnCount));
        System.out.println("Rows: " + getInt(rowCount));
        System.out.println("Update Sleep: " + getInt(updateSleepTime));
        System.out.println("EQ Sleep: " + getInt(eqSleepTime));
        System.out.println("Update All Threshold: " + getInt(threshold));
        System.out.println("Generator Sleep: " + getInt(generateSleep));
        System.out.println("Batch Size: " + getInt(generatorBatchCount));
        if (updateThread != null) {
            System.out.println("interrupting!");
            updateThread.interrupt();
            generatorThread.interrupt();
        }
        int cols = getInt(columnCount);
        tableModel = new CTTableModel(cols);
        ArrayList<Data> data = new ArrayList<Data>();
        for (int counter = getInt(rowCount) - 1; counter >= 0; counter--) {
            Data dataID = new Data();
            data.add(dataID);
            tableModel.addRow(dataID);
            for (int colCounter = 0; colCounter < cols; colCounter++) {
                if (colCounter % 2 == 0) {
                    tableModel.set(dataID, colCounter, 
                            new Integer(counter * 100 + colCounter), false);
                } else {
                    tableModel.set(dataID, colCounter, 
                            new Integer(counter * -100 + colCounter), false);
                }
            }
        }
        table.setModel(tableModel);
        generatorThread = new GeneratorThread(data, getInt(generateSleep), 
                getInt(generatorBatchCount), getInt(columnCount));
        updateThread = new UpdateThread(generatorThread, tableModel, 
                getInt(updateSleepTime), getInt(eqSleepTime), getInt(threshold));
        generatorThread.start();
        updateThread.start();
    }

    private int getInt(JTextField tf) {
        try {
            return Integer.parseInt(tf.getText());
        } catch (NumberFormatException nfe) {
            System.out.println("exception getting int: " + nfe);
        }
        return 0;
    }

    public static void main(String[] args) {
        Main main = new Main();
    }
} 
```

...将继续

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T19:59:37.013

其余方法

```
import java.awt.*;
import java.lang.reflect.*;
import java.util.*;
import javax.swing.*;

/**
 * Thread responsible for publishing changes to the Model. Sleeps for a defined
 * amount of time, waits for no activity in the UI and then users invokeAndWait
 * to publish changes.
 */
public class UpdateThread extends Thread {

    private int sleepTime;
    private int eqSleepTime;
    private int threshhold;
    private boolean updatesEnabled;
    private Runnable publishRunnable;
    private Runnable emptyRunnable;
    private GeneratorThread generator;
    private CTTableModel model;
    private Map<?, ?> lastData;
    private long notifyTime;
    private long paintTime;
    private int updateCount;
    private boolean done;

    public UpdateThread(GeneratorThread generator, CTTableModel model, 
            int sleepTime, int eqSleepTime, int threshhold) {
        super();
        setPriority(Thread.MIN_PRIORITY);
        this.sleepTime = sleepTime;
        this.eqSleepTime = eqSleepTime;
        updatesEnabled = true;
        this.threshhold = threshhold;
        this.generator = generator;
        this.model = model;
        publishRunnable = new Runnable() { 
        // Runnable used to publish changes to the event dispatching thread
            @Override
            public void run() {
                publishChangesOnEventDispatchingThread();
            }
        }; 
        // Empty runnable, used to wait until the event dispatching thread 
        // has finished processing any pending events.
        emptyRunnable = new Runnable() {
            @Override
            public void run() {
            }
        };
    }

    @Override
    public void interrupt() {
        done = true;
        super.interrupt();
    }

    @Override
    public void run() {
        while (!isInterrupted() && !done) {
            try {
                sleep(sleepTime);
                publishChanges();
            } catch (InterruptedException ie) {
            }
        }
        System.out.println("UpdateThread done");
    }

    /**
     * Publishes changes on the event dispatching thread when the system isn't
     * busy. This blocks the caller until the changes have been published.
     */
    private void publishChanges() {
        synchronized (this) {// Wait until the user isn't scrolling
            while (!updatesEnabled) {
                try {
                    wait();
                } catch (InterruptedException ie) {
                }
            }
        }
        EventQueue queue = Toolkit.getDefaultToolkit().getSystemEventQueue();
        // And wait until there are no pending events.
        while (queue.peekEvent() != null) {
            try {
                sleep(eqSleepTime);
            } catch (InterruptedException ie) {
            }
        }
        final long start = System.currentTimeMillis();
        try {
            SwingUtilities.invokeAndWait(publishRunnable);
            // publish the changes on the event dispatching thread
        } catch (InterruptedException ie) {
        } catch (InvocationTargetException ite) {
        }
        try {
        // Wait until the system has completed processing of any events we 
        // triggered as part of publishing changes.
            SwingUtilities.invokeAndWait(emptyRunnable);
        } catch (InterruptedException ie) {
        } catch (InvocationTargetException ite) {
        }
        final long end = System.currentTimeMillis();
        try {// Update the display
            SwingUtilities.invokeAndWait(new Runnable() {
                @Override
                public void run() {
                    Main.totalUpdateTime.setText("Total: " 
                            + Integer.toString((int) (end - start)));
                    Main.notifyTime.setText("Notify: " 
                            + Integer.toString((int) notifyTime));
                    Main.paintTime.setText("Paint: " 
                            + Integer.toString((int) paintTime));
                    Main.updateCount.setText("Updated: " 
                            + Integer.toString((int) updateCount));
                }
            });
        } catch (InterruptedException ie) {
        } catch (InvocationTargetException ite) {
        }
    }

    /**
     * Does the actual publishing of changes.
     */
    private void publishChangesOnEventDispatchingThread() {
        long start = System.currentTimeMillis();
        model.setBatchUpdates(true);
        Map<?, ?> data = generator.getData();
        boolean notify = !(data.size() > threshhold || 
                (lastData != null && lastData.size() + data.size() > threshhold));
        updateCount = data.size();
        if (lastData != null) {
            updateCount += lastData.size();
        }//Reset the data for the last set of changes we did, this forces the cells to change color.
        if (lastData != null) {
            publishData(lastData, true, notify);
            Iterator<?> dataIterator = lastData.keySet().iterator();
            while (dataIterator.hasNext()) {
                DataChange.releaseDataChange((DataChange) dataIterator.next());
            }
            lastData.clear();
        }
        publishData(data, false, notify);// Publish the current set of data.
        model.setBatchUpdates(false);
        if (!notify) {
            model.fireTableDataChanged();
        }
        lastData = data;
        long end = System.currentTimeMillis();
        notifyTime = (end - start);
        start = System.currentTimeMillis();
        RepaintManager.currentManager(null).paintDirtyRegions();
        end = System.currentTimeMillis();
        paintTime = (end - start);
    }

    /**
     * Publish the passed in set of data.
     */
    private void publishData(Map<?, ?> data, boolean negate, boolean notify) {
        Iterator<?> dataIterator = data.keySet().iterator();
        while (dataIterator.hasNext()) {
            DataChange change = (DataChange) dataIterator.next();
            Object value = data.get(change);
            if (negate) {
                value = new Integer(((Integer) value).intValue() * -1);
            }
            model.set(change.getData(), change.getColumn(), value, notify);
        }
    }

    /**
     * If enable is true, we are allowed to publish changes, otherwise we
     * aren't.
     *
     * @param enable
     */
    public void setUpdatesEnabled(boolean enable) {
        synchronized (this) {
            updatesEnabled = enable;
            if (updatesEnabled) {
                notify();
            }
        }
    }

    public boolean getUpdatesEnabled() {
        return updatesEnabled;
    }
} 
```

.

```
import java.awt.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.table.*;

/**
 * VisibleTableModelEvent adds the method isVisible to test if the cell
 * identified by the event is visible.
 */
public class VisibleTableModelEvent extends TableModelEvent {

    private static final long serialVersionUID = 1L;
    private Point tmpPoint;
    // This implementation caches the information for one JTable, it is
    // certainly possible to cache it for more than one should
    // you have this need.
    private boolean valid;
    private int firstVisRow;
    private int lastVisRow;
    private int firstVisCol;
    private int lastVisCol;

    public VisibleTableModelEvent(TableModel source) {
        super(source, 0, 0, 0, UPDATE);
        tmpPoint = new Point();
    }

    /**
     * Resets the underlying fields of the TableModelEvent. This assumes no ONE
     * is going to cache the TableModelEvent.
     *
     * @param row
     * @param col
     */
    public void set(int row, int col) {
        firstRow = row;
        lastRow = row;
        column = col;
    }

    /**
     * Invoked to indicate the visible rows/columns need to be recalculated
     * again.
     */
    public void reset() {
        valid = false;
    }

    public boolean isVisible(JTable table) {
        if (!valid) {// Determine the visible region of the table.            
            Rectangle visRect = table.getVisibleRect();
            tmpPoint.x = visRect.x;
            tmpPoint.y = visRect.y;
            firstVisCol = table.columnAtPoint(tmpPoint);
            firstVisRow = table.rowAtPoint(tmpPoint);
            tmpPoint.x += visRect.width;
            tmpPoint.y += visRect.height;
            lastVisCol = table.columnAtPoint(tmpPoint);
            if (lastVisCol == -1) {
                lastVisCol = table.getColumnCount() - 1;
            }
            if ((lastVisRow = table.rowAtPoint(tmpPoint)) == -1) {
                lastVisRow = table.getRowCount();
            }
            valid = true;
        }
        return (firstRow >= firstVisRow && firstRow <= lastVisRow && column
                >= firstVisCol && column <= lastVisCol);
    }
} 
```

# android - 如何为离线模式缓存网页内容？

> ID：14987450
> 
> 赞同：2
> 
> 时间：2013-02-20T18:37:32.973
> 
> 标签：android, caching, offline

我正在开发应用程序的一部分，应用程序应该从在线存储（网站，仅为此目的而构建）读取产品图像和价格，在本地存储产品图像和价格，以便它可以离线时显示产品图片和价格。会有一个按钮；一旦按下它，它的工作就是同步本地缓存。我怎么能实现这个？任何帮助将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T12:32:59.440

您可以使用磁盘缓存从远程服务缓存位图，有关如何在 Google 开发人员网站[http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html上执行此操作的更多信息](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

这将允许您存储图像并在没有连接时立即显示，或者您想在加载远程图像的同时加载图像。

根据您需要存储的文本，您可以将文本与缓存中的图像相关联，或者使用数据设置一个 ArrayList 并存储到磁盘。这里有一些更多细节[在Android中缓存数据的最佳方式](https://stackoverflow.com/questions/2004040/best-way-to-cache-data-in-android)

还有一些工具可以确保您充分利用网络连接，例如 AT&T ARO 工具，运行该工具将帮助您通过将网络调用减少到最低限度来优化您的应用程序。见[http://developer.att.com/aro](http://developer.att.com/aro)

# css - 如何仅在 Bootstrap 的折叠导航栏上显示文本？

> ID：14987451
> 
> 赞同：4
> 
> 时间：2013-02-20T18:37:40.230
> 
> 标签：css, twitter-bootstrap, responsive-design

我想在导航栏切换按钮旁边的导航栏上显示一个电话号码。切换按钮仅在导航栏处于折叠状态时出现。我希望文本出现在它旁边。

这是我现在拥有的：

![折叠的导航栏](../Images/902d738e7447e5e202822e62964c3d78.png)

这就是我想要实现的目标：

![带有文本的折叠导航栏](../Images/7c723fc47afc00d8f7b942b3904ebe51.png)

来自相关 div 的 HTML：

```
<div class="header-centered"><img src="http://placehold.it/350x150"></div>
<div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <!-- Everything you want hidden at 940px or less, place within here -->
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li class="active"><a href="#">Home</a></li>
          <li><a href="#">Link1</a></li>
          <li><a href="#">Link2</a></li>
          <li><a href="#">Link3</a></li>
          <li><a href="#">Link4</a></li>
          <li><a href="#">Link5</a></li>
        </ul>
      </div>
    </div>
  </div>
</div> 
```

除非导航栏折叠，否则我不希望出现文本。如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T20:17:50.553

您可以通过 CSS 控制文本的可见性，如下所示：

```
.abcde .text {
  display: none;
}
.abcde.collapse .text {
  display: inline-block;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-20T06:47:14.310

简单 - 只需在“汉堡按钮”之前添加以下 HTML

```
<p class="navbar-text visible-xs-inline-block">Menu</p> 
```

然后设计适合的样式。

```
p.navbar-text {  
  font-size: 22px;
  margin-top: 8px;
  padding-bottom: 0;
  text-align: right;
  width: 70%;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-23T05:48:30.240

有太多方法可以处理这种情况。

1.  `Display: none;`这是一个浏览器友好的，他们不再假设任何元素，因为它处于永久隐藏状态。
2.  `Visibility: hidden;`它可以隐藏文档上的任何元素，但它仍然有一个限制，浏览器必须在页面上找到该元素，然后隐藏该元素。所以几毫秒，但他们必须努力隐藏这一点。
3.  通过保持`font-size: 0;`和折叠状态后使用`font-size: 1em;`。
4.  保持`opacity: 0`和以后`opacity: 1`。
5.  `postion: absolute;` `left:-99999em;`和后来`left:0;`
6.  如果您有定位元素，则可以使用 z-index。按顺序堆叠元素也可以。

所以，最后有一大堆方法可以隐藏和显示文档上的元素。这一切都取决于你选择什么。但在我看来`Display: none;`，这是最适合您项目的一个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-06T09:23:49.023

我搜索了答案，这就是我所做的 - 用您想要的文本替换 Menu

```
<div class="navbar-inner">
  <div class="container-fluid">
    <a class="btn btn-navbar btn-block" data-target=".navbar-inverse-collapse" data-toggle="collapse">
      <span class="icon icon-white icon-align-justify"></span>
    MENU</a>
    <div class="nav-collapse collapse navbar-inverse-collapse">
      <ul class="nav"> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-14T09:28:20.797

我正在为想要使用引导方式使用 grid-float-breakpoint 处理折叠元素的用户添加此答案，这是导航栏未折叠的点。

因此，如果您想要仅在栏折叠时可见的元素，请添加*collapsed-addon*类并包含此 css。

**默认 gird-float-breakpoint 值设置为 screen-sm-min 即 768px**

```
@media (min-width: 768px){
  .collapsed-addon {
    display: none;
} 
```

**如果您使用某些处理器，请使用 css 变量 grid-float-breakpoint**

```
@media (min-width: $grid-float-breakpoint){
  .collapsed-addon {
    display: none;
  }
} 
```

# c++ - 将 m 个字节的数组拆分为 n 个字节的块

> ID：14987461
> 
> 赞同：1
> 
> 时间：2013-02-20T18:38:05.387
> 
> 标签：c++, c, byte

我正在开发一个操纵大脑数据的程序。它接收一个值，代表 8 种公认的 EEG（脑电波）类型的当前幅度。该数据值以小端格式的 8 个 3 字节无符号整数系列输出。

这是我的一段代码：

```
 if (extendedCodeLevel == 0 && code == ASIC_EEG_POWER_CODE)     
    {
         fprintf(arq4, "EXCODE level: %d CODE: 0x%02X vLength: %d\n", extendedCodeLevel, code, valueLength );
         fprintf(arq4, "Data value(s):" );
         for( i=0; i<valueLength; i++ ) fprintf(arq4, " %d", value[0] & 0xFF );
      } 
```

值**value[0]**是我的输出。它是代表脑电波的一系列字节。当前输出文件包含以下数据：

```
EXCODE level: 0x00  CODE: 0x83 vLength: 24
Data value(s): 16 2 17 5 3 2 22 1 2 1 0 0 0 4 0 0 3 0 0 5 1 0 4 8 
```

我需要将上面的字节序列分成 3 个字节的块，以识别 EEG。wave delta 由第一个 3 字节序列表示，theta 由下一个字节表示，依此类推。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:04:12.037

假设您知道您的输入总是正好是 8 个 3 位整数，那么您所需要的只是一个简单的循环，它从输入中读取 3 个字节并将它们写成 4 个字节的值。最简单的方法是将输入视为一个字节数组，然后以三个一组的形式从该数组中提取字节。

```
// Convert an array of eight 3-byte integers into an array
//  of eight 4-byte integers.
void convert_3to4(const void* input, void* output)
{
   uint32_t   tmp;
   uint32_t*  pOut = output;
   uint8_t*   pIn = input;
   int        i;

   for (i=0; i<24; i+=3)
   {
      tmp  = pIn[i];
      tmp += (pIn[i+1] << 8);
      tmp += (pIn[i+2] << 16);
      pOut[((i+2) / 3)] = tmp;
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:45:11.107

像这样？如果未按 3 对齐，则不会打印最后一个字节。您需要它们吗？

```
for( i=0; i<valueLength; i+=3 ) fprintf(arq4, "%d %d %d - ", value[i] & 0xFF,
                                                             value[i+1] & 0xFF,
                                                             value[i+2] & 0xFF ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T19:00:25.023

将 8 个 3 字节 little endian 字符流转换为 8 个 4 字节整数相当简单：

```
for( int i = 0; i < 24; ++i )
{
    output[ i & 0x07 ] |= input[ i ] << ( i & 0x18 );
} 
```

我认为（未经测试的）代码会做到这一点。假设输入是一个 24 项的 char 数组，输出是一个 8 项的 int 数组。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T19:07:19.430

你可以试试…… 像这样：

```
union _32BitValue
{
    uint8_t bytes[4];
    uint32_t uval;
}

size_t extractUint32From3ByteSegemented(const std::vector<uint8_t>& rawData, size_t index, uint32_t& result)
{
    // May be do some checks, if the vector size fits extracting the data from it,
    // throwing exception or return 0 etc. ...

    _32BitValue tmp;
    tmp.bytes[0] = 0;
    tmp.bytes[1] = rawData[index + 2];
    tmp.bytes[2] = rawData[index + 1];
    tmp.bytes[3] = rawData[index];

    result = ntohl(tmp.uval);
    return index + 3;
} 
```

用于解析原始数据数组中的值的代码：

```
size_t index = 0;
std::vector<uint8_t> rawData = readRawData(); // Provide such method to read the raw data into the vector
std::vector<uint32_t> myDataValues;

while(index < rawData.size())
{
    uint32_t extractedValue;
    index = extractUint32From3ByteSegemented(rawData,index,extractedValue);
    // Depending on what error detection you choose do check for index returned
    // != 0, or catch exception ...
    myDataValues.push_back(extractedValue);
}

// Continue with calculations on the extracted values ... 
```

如其他答案所示，使用左移运算符和加法也可以解决问题。但恕我直言，这个样本清楚地显示了发生了什么。它用大端（网络）顺序的值填充联合字节数组，并用于`ntohl()`以可移植的主机使用的格式（大端或小端）检索结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T20:40:06.240

> 我需要的是，我需要分别获取 3 字节序列，而不是显示 24 字节的整个序列。

您可以轻松地将 1d 字节数组复制到所需的 2d 形状。

例子：

```
#include <inttypes.h>
#include <stdio.h>
#include <string.h>

int main() {
    /* make up data */
    uint8_t bytes[] = 
        { 16,  2, 17, 
           5,  3,  2, 
          22,  1,  2,
           1,  0,  0,
           0,  4,  0, 
           0,  3,  0,
           0,  5,  1,
           0,  4,  8 };
    int32_t n_bytes = sizeof(bytes);
    int32_t chunksize = 3;
    int32_t n_chunks = n_bytes/chunksize + (n_bytes%chunksize ? 1 : 0);

    /* chunkify */
    uint8_t chunks[n_chunks][chunksize];
    memset(chunks, 0, sizeof(uint8_t[n_chunks][chunksize]));
    memcpy(chunks, bytes, n_bytes);

    /* print result */
    size_t i, j;
    for (i = 0; i < n_chunks; i++)
    {
        for (j = 0; j < chunksize; j++)
            printf("%02hhd ", chunks[i][j]);
        printf("\n");
    }
    return 0;
} 
```

输出是：

```
16 02 17 
05 03 02 
22 01 02 
01 00 00 
00 04 00 
00 03 00 
00 05 01 
00 04 08 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-22T04:03:43.023

我在这里使用了一些示例来提出解决方案，所以我想我会分享它。它可以作为接口的基础，以便对象可以使用 hton 和 ntoh 函数通过网络传输自身的副本，这实际上是我正在尝试做的。

```
#include <iostream>
#include <string>
#include <exception>
#include <arpa/inet.h>

using namespace std;

void DispLength(string name, size_t var){
    cout << "The size of " << name << " is : " << var << endl;
}

typedef int8_t byte;

class Bytes {
public:
    Bytes(void* data_ptr, size_t size)
    : size_(size)
    { this->bytes_ = (byte*)data_ptr; }

    ~Bytes(){ bytes_ = NULL; } // Caller is responsible for data deletion.

    const byte& operator[] (int idx){
        if((size_t)idx <= size_ && idx >= 0)
            return bytes_[idx];
        else
            throw exception();
    }

    int32_t ret32(int idx) //-- Return a 32 bit value starting at index idx
    {
        int32_t* ret_ptr = (int32_t*)&((*this)[idx]);
        int32_t  ret     = *ret_ptr;
        return ret;
    }

    int64_t ret64(int idx) //-- Return a 64 bit value starting at index idx
    {
        int64_t* ret_ptr = (int64_t*)&((*this)[idx]);
        int64_t  ret     = *ret_ptr;
        return ret;
    }

    template <typename T>
    T retVal(int idx) //-- Return a value of type T starting at index idx
    {
        T* T_ptr = (T*)&((*this)[idx]);
        T  T_ret = *T_ptr;
        return T_ret;
    }

protected:
    Bytes() : bytes_(NULL), size_(0) {}

private:
    byte* bytes_; //-- pointer used to scan for bytes
    size_t size_;
};

int main(int argc, char** argv){
    long double LDouble = 1.0;
    Bytes bytes(&LDouble, sizeof(LDouble));
    DispLength(string("LDouble"), sizeof(LDouble));
    DispLength(string("bytes"), sizeof(bytes));
    cout << "As a long double LDouble is " << LDouble << endl;
    for( int i = 0; i < 16; i++){
        cout << "Byte " << i << " : " << bytes[i] << endl;
    }
    cout << "Through the eyes of bytes : " <<
            (long double) bytes.retVal<long double>(0) << endl;
    return 0;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-02-20T18:45:49.607

您可以使用位操作运算符

我会使用，不遵循实际代码，只显示示例

（对于我 =0 直到 7）{

temp val = Value && 111 //与 111 进行与运算

值 = 值 >> 3；//向右移动

}

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-20T19:20:08.600

一些自我记录、可维护的代码可能看起来像这样（未经测试）。

```
typedef union
{
    struct {
        uint8_t padding;
        uint8_t value[3];
    } raw;
    int32_t data;
} Measurement;

void convert(uint8_t* rawValues, int32_t* convertedValues, int convertedSize)
{
    Measurement  sample;
    int          i;

    memset(&sample, '\0', sizeof(sample));

    for(i=0; i<convertedSize; ++i)
    {
        memcpy(&sample.raw.value[0], &rawValues[i*sizeof(sample.raw.value)], sizeof(sample.raw.value));
        convertedValues[i]=sample.data;
    }
} 
```

# java - 如何删除指向数组中元素的指针java

> ID：14987462
> 
> 赞同：0
> 
> 时间：2013-02-20T18:38:15.197
> 
> 标签：java, stack

我是java新手，现在我想写一个数组Stack我想避免在pop（）函数中徘徊，

```
public class Stack {
private int[] s;
private int N=0;

public Stack(int capacity)
{
    s= new int [capacity];
}

public boolean IsEmpty ()
{
    return N==0;
}

public void push (int x)
{
    s[N++]=x;
}

public int pop ()
{
    int x=s[--N];
    s[N]=null;
    return x;
} 
```

当它递减该值时，仍然有指向已从堆栈中取出的元素的指针现在我尝试将删除的项目设置为 null 但编译器给了我异常

我该怎么做才能删除已删除项目的指针？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:42:15.333

您的数组存储`int`的值不是引用，并且`null`不是 type 的有效值`int`。当您处理引用类型的值时，您使用的技巧很方便，例如`Object`or `String`。在您的情况下，您可以将`0`or分配给空元素，但不能分配. 此外，我认为在您的情况下，您可以按原样保留价值：`-1``Integer.MIN_VALUE``null`

```
public int pop ()
{
    return s [--N];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:47:51.327

基元数组存储*值*，而不是指针，因此您不必担心内存泄漏。

这一行：

```
s[N]=null; 
```

在 java 中不需要（并且无论如何都不会编译，因为`null`它不是有效的原始值）。

Java 不是 C。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:43:12.357

使用 an`ArrayList`而不是数组。在那里，您可以删除指定位置的对象，如果是堆栈，这将始终是最后一个。

# sql - 将 24 小时制时间转换为 12 小时制加上 AM/PM 指示 Oracle SQL

> ID：14987473
> 
> 赞同：19
> 
> 时间：2013-02-20T18:38:53.287
> 
> 标签：sql, oracle, datetime

我需要做以下练习，我正在努力寻找解决方案：

编写一个 SELECT 语句，从 Invoices 表中返回这些列：

invoice_date 列

使用 TO_CHAR 函数返回 invoice_date 列及其完整日期和时间，包括 24 小时制的四位数年份

**使用 TO_CHAR 函数返回 invoice_date 列及其完整日期和时间，包括12 小时制**的四位数年份和 am/pm 指示符。

使用 CAST 函数将 invoice_date 列返回为 VARCHAR2(10)

我能得到的只有：

```
 select invoice_date, to_char(invoice_date, 'DD-MM-YYYY HH:MM:SS') "Date 24Hr"
    from invoices 
```

这得到了我的前两列，但是我想不出任何方法来选择第三列。任何帮助都会很棒，谢谢。（是的，这是来自我的学校教科书）

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-20T18:43:08.847

对于 24 小时制，您需要使用`HH24`而不是`HH`.

对于 12 小时时间，AM/PM 指示符写为`A.M.`（如果您想要结果中的句点）或`AM`（如果您不想要）。例如：

```
SELECT invoice_date,
       TO_CHAR(invoice_date, 'DD-MM-YYYY HH24:MI:SS') "Date 24Hr",
       TO_CHAR(invoice_date, 'DD-MM-YYYY HH:MI:SS AM') "Date 12Hr"
  FROM invoices
; 
```

有关可用于`TO_CHAR`日期的格式模型的更多信息，请参阅[http://docs.oracle.com/cd/E16655_01/server.121/e17750/ch4datetime.htm#NLSPG004](http://docs.oracle.com/cd/E16655_01/server.121/e17750/ch4datetime.htm#NLSPG004)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-05-14T13:36:26.447

'hh' 是 12 小时制，'HH' 是 24 小时制，'tt' 是 AM/PM

```
SELECT FORMAT(invoice_date, N'dd-MMM-yyyy hh:mm:ss tt') 
```

# php - wsdl 错误：没有正确分离标题和文档

> ID：14987476
> 
> 赞同：3
> 
> 时间：2013-02-20T18:39:09.670
> 
> 标签：php, soap, dynamics-crm-2011, nusoap

我正在使用 NUSOAP 来使用 microsoftdynamics 的肥皂接口。我收到此错误“wsdl 错误：获取[https://testserver2013.api.crm4.dynamics.com/XRMServices/2011/Organization.svc?wsdl=wsdl0](https://testserver2013.api.crm4.dynamics.com/XRMServices/2011/Organization.svc?wsdl=wsdl0) - HTTP 错误：没有正确分离标题和文档”，我我有点困惑。

我假设 xml 文档很好，标题是否有问题，或者我可能没有正确阅读它！谢谢。

文档的 xml 看起来像这样

```
 <ms-xrm:FailoverPolicy xmlns:ms-xrm="http://schemas.microsoft.com/xrm/2012/Contracts/Services">
      <ms-xrm:FailoverAvailable>false</ms-xrm:FailoverAvailable>
      <ms-xrm:EndpointEnabled>true</ms-xrm:EndpointEnabled>
    </ms-xrm:FailoverPolicy>
    <ms-xrm:AuthenticationPolicy xmlns:ms-xrm="http://schemas.microsoft.com/xrm/2011/Contracts/Services">
      <ms-xrm:Authentication>LiveId</ms-xrm:Authentication>
      <ms-xrm:SecureTokenService>
        <ms-xrm:Identifier>urn:federation:MicrosoftOnline</ms-xrm:Identifier>
        <ms-xrm:LiveTrust>
          <ms-xrm:AppliesTo>urn:crmemea:dynamics.com</ms-xrm:AppliesTo>
          <ms-xrm:TrustVersion>WSTrustFeb2005</ms-xrm:TrustVersion>
          <ms-xrm:SecurityMode>TransportWithMessageCredential</ms-xrm:SecurityMode>
          <ms-xrm:LivePolicy>MBI_FED_SSL</ms-xrm:LivePolicy>
          <ms-xrm:LiveIdAppliesTo>http://Passport.NET/tb</ms-xrm:LiveIdAppliesTo>
        </ms-xrm:LiveTrust>
      </ms-xrm:SecureTokenService>
    </ms-xrm:AuthenticationPolicy>
    <ms-xrm:FailoverPolicy xmlns:ms-xrm="http://schemas.microsoft.com/xrm/2012/Contracts/Services">
      <ms-xrm:FailoverAvailable>false</ms-xrm:FailoverAvailable>
      <ms-xrm:EndpointEnabled>true</ms-xrm:EndpointEnabled>
    </ms-xrm:FailoverPolicy>
    <ms-xrm:AuthenticationPolicy xmlns:ms-xrm="http://schemas.microsoft.com/xrm/2012/Contracts/Services">
      <ms-xrm:Authentication>OnlineFederation</ms-xrm:Authentication>
      <ms-xrm:SecureTokenService>
        <ms-xrm:Identifier>https://dynamicscrmemea.accesscontrol.windows.net/</ms-xrm:Identifier>
        <ms-xrm:OrgTrust>
          <ms-xrm:AppliesTo>urn:crmemea:dynamics.com</ms-xrm:AppliesTo>
          <ms-xrm:TrustVersion>WSTrustFeb2005</ms-xrm:TrustVersion>
          <ms-xrm:SecurityMode>TransportWithMessageCredential</ms-xrm:SecurityMode>
          <ms-xrm:LivePolicy>MBI_FED_SSL</ms-xrm:LivePolicy>
          <ms-xrm:LiveIdAppliesTo>http://Passport.NET/tb</ms-xrm:LiveIdAppliesTo>
          <ms-xrm:LiveEndpoint>https://login.microsoftonline.com/RST2.srf</ms-xrm:LiveEndpoint>
          <ms-xrm:Identifier>urn:federation:MicrosoftOnline</ms-xrm:Identifier>
        </ms-xrm:OrgTrust>
      </ms-xrm:SecureTokenService>
    </ms-xrm:AuthenticationPolicy>
    <ms-xrm:FailoverPolicy xmlns:ms-xrm="http://schemas.microsoft.com/xrm/2012/Contracts/Services">
      <ms-xrm:FailoverAvailable>false</ms-xrm:FailoverAvailable>
      <ms-xrm:EndpointEnabled>true</ms-xrm:EndpointEnabled>
    </ms-xrm:FailoverPolicy>
    <sp:TransportBinding xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy>
        <sp:TransportToken>
          <wsp:Policy>
            <sp:HttpsToken/>
          </wsp:Policy>
        </sp:TransportToken>
        <sp:AlgorithmSuite>
          <wsp:Policy>
            <sp:TripleDes/>
          </wsp:Policy>
        </sp:AlgorithmSuite>
        <sp:Layout>
          <wsp:Policy>
            <sp:Strict/>
          </wsp:Policy>
        </sp:Layout>
        <sp:IncludeTimestamp/>
      </wsp:Policy>
    </sp:TransportBinding>
    <sp:SignedSupportingTokens xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy>
        <sp:IssuedToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
          <Issuer xmlns="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
            <Address xmlns="http://www.w3.org/2005/08/addressing">https://login.microsoftonline.com/RST2.srf</Address>

            <Metadata xmlns="http://www.w3.org/2005/08/addressing">
              <Metadata xmlns="http://schemas.xmlsoap.org/ws/2004/09/mex" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <wsx:MetadataSection xmlns="">
                  <wsx:MetadataReference>
                    <Address xmlns="http://www.w3.org/2005/08/addressing">https://dynamicscrmemea.accesscontrol.windows.net/v2/wstrust/mex</Address>
                  </wsx:MetadataReference>
                </wsx:MetadataSection>
              </Metadata>
            </Metadata>
          </Issuer>
          <sp:RequestSecurityTokenTemplate>
            <trust:KeyType xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey</trust:KeyType>
            <trust:KeySize xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">192</trust:KeySize>
            <trust:Claims Dialect="http://schemas.xmlsoap.org/ws/2005/05/identity" xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">
              <wsid:ClaimType Uri="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier" xmlns:wsid="http://schemas.xmlsoap.org/ws/2005/05/identity"/>
            </trust:Claims>
            <trust:KeyWrapAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p</trust:KeyWrapAlgorithm>
            <trust:EncryptWith xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#tripledes-cbc</trust:EncryptWith>
            <trust:SignWith xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2000/09/xmldsig#hmac-sha1</trust:SignWith>
            <trust:CanonicalizationAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/10/xml-exc-c14n#</trust:CanonicalizationAlgorithm>
            <trust:EncryptionAlgorithm xmlns:trust="http://docs.oasis-open.org/ws-sx/ws-trust/200512">http://www.w3.org/2001/04/xmlenc#tripledes-cbc</trust:EncryptionAlgorithm>
          </sp:RequestSecurityTokenTemplate>
          <wsp:Policy>
            <sp:RequireInternalReference/>
          </wsp:Policy>
        </sp:IssuedToken>
      </wsp:Policy>
    </sp:SignedSupportingTokens>
    <sp:Wss11 xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy/>
    </sp:Wss11>
    <sp:Trust13 xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy>
        <sp:MustSupportIssuedTokens/>
        <sp:RequireClientEntropy/>
        <sp:RequireServerEntropy/>
      </wsp:Policy>
    </sp:Trust13>
    <wsaw:UsingAddressing/>
  </wsp:All>
</wsp:ExactlyOne> 
```

任何想法，谢谢！或者任何关于 microsoft dynamics crm online 2011 的好的工作教程都会很棒！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-21T18:00:20.717

我刚刚看到这个错误，它似乎是 nusoap 代码中的一个错误。在我们的例子中，这是由对 SOAP 调用的 401 错误响应引起的，但 301 和 302 响应似乎会触发相同的问题。

该错误似乎在以下代码行中：

if ($pos = strpos($data,"\r\n\r\n"))

当标头被剥离时，$pos 被设置为 0，这会评估为 FALSE，而开发人员似乎打算将其评估为 TRUE 以及标头完好无损的情况。

见： [https ://github.com/codecasts/nusoap-php7/blob/master/lib/class.soap_transport_http.php](https://github.com/codecasts/nusoap-php7/blob/master/lib/class.soap_transport_http.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-06T11:37:00.650

检查你的行尾。问题可能是由 PHP/源文件中的 LF 和 CR+LF 混合引起的

# ios - 如何将 ViewController 或 View 加载到另一个具有透明背景的 ViewController 中？

> ID：14987477
> 
> 赞同：2
> 
> 时间：2013-02-20T18:39:08.670
> 
> 标签：ios, xcode, uiviewcontroller, popup, subview

在我的应用程序中，我希望在从 UIButton 调用时出现自定义弹出窗口。目前我正在使用 TSAlertView，但我想实现更多的 UI 项目并拥有更多的自定义构建。所以我想做的是在另一个视图控制器中加载一个视图控制器或视图，并能够在它们之间传递信息。请参见下面的示例：

![视图控制器](../Images/61b0db043d735f6984e23949296d5ee8.png)

从我读过的内容来看，据说在另一个视图控制器中加载另一个视图控制器并不是一个好习惯。在这种情况下，我认为 uiview 将是推荐的方式。这个对吗？

我希望弹出窗口后面的视图控制器具有暗淡的外观，可能是不透明度设置为 70% 的深色。我怎样才能做到这一点？

本质上，我正在尝试构建类似于具有另一个视图外观的 AlertView 的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:47:09.623

如果您打算完全阻止背景视图，您可以设置`viewControllerB`为`Form Sheet`.

当你准备好展示`viewControllerB`时，使用：

```
[viewControllerA presentViewController:viewControllerB animated:TRUE completion:nil] 
```

您将需要一种方法来解雇`viewControllerB`；按钮、网络操作等

故事板的一个例子：

```
- (void)someMethod {
  UIStoryboard *storyboard = self.storyboard;
  ViewControllerB *viewCotrollerB = [storyboard instantiateViewControllerWithIdentifier:@"ViewControllerB"];
  [self presentModalViewController:viewControllerB animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-13T05:54:58.910

![在此处输入图像描述](../Images/afd7f249f9aa0fcfa30142bbc5d300b4.png)

嗨 SReca，我也有同样的要求（如上图所示）来创建像你所说的 UIalertview 的视图。

在这里，您必须创建一个新的 UIView 类而不是 UIViewController，而不需要 .xib。

在 init 方法中的新 UIView 类中，您将需要以编程方式创建用户界面。并根据需要保持其高度宽度。

而要加载这个新的 UIView，您只需创建该 uiview 的对象并调用 initwithframe，它将像 uialerview 一样以编程方式呈现该视图。

这是参考代码。

ModalPreviewViewController_iPhone.h

```
@interface ModalPreviewViewController_iPhone : UIView
@end 
```

ModalPreviewViewController_iPhone.m

只需根据您在 initWithFrame 中的需要修改此示例代码

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        popUpView  = [[UIView alloc] initWithFrame:CGRectMake(30,30,260,420)];

        popUpBgView = [[UIView alloc] init];
        popUpBgView.frame =CGRectMake(0,0,260,420);
        [popUpBgView setBackgroundColor:[UIColor colorWithRed:51.0/255 green:51.0/255 blue:51.0/255 alpha:1]];
        [popUpView addSubview:popUpBgView];

        imageGalleryView=[[UIWebView alloc]initWithFrame:CGRectMake(0, 0, 260, 360)];
        [imageGalleryView setBackgroundColor:[UIColor redColor]];

        CGRect btnTempFrame=CGRectMake(5, 385, 90, 30);
        btnTemp=[[UIButton alloc]initWithFrame:btnTempFrame];
        [btnTemp setBackgroundImage:[UIImage imageNamed:@"btn_plain_iphone.png"] forState:UIControlStateNormal];
        [btnTemp.titleLabel setFont:[UIFont boldSystemFontOfSize:13]];
        [btnTemp.titleLabel setTextColor:[UIColor whiteColor]];
        [btnTemp addTarget:self action:@selector(onDownloadClick:) forControlEvents:UIControlEventTouchUpInside];

        CGRect btnSubscribeFrame=CGRectMake(100, 385, 90, 30);
        UIButton *btnSubscribe=[[UIButton alloc]initWithFrame:btnSubscribeFrame];
        [btnSubscribe setBackgroundImage:[UIImage imageNamed:@"btn_plain_iphone.png"] forState:UIControlStateNormal];

        [btnSubscribe.titleLabel setFont:[UIFont boldSystemFontOfSize:13]];
        [btnSubscribe.titleLabel setTextColor:[UIColor whiteColor]];
        [btnSubscribe setTitle:@"Subscribe" forState:UIControlStateNormal];
        [btnSubscribe addTarget:self action:@selector(moveTosubscribe:) forControlEvents:UIControlEventTouchUpInside];

        CGRect closeButtonFrame=CGRectMake(195, 385, 60, 30);
        UIButton *closeButton=[[UIButton alloc]initWithFrame:closeButtonFrame];
        [closeButton setBackgroundImage:[UIImage imageNamed:@"btn_plain_iphone.png"] forState:UIControlStateNormal];
        [closeButton.titleLabel setFont:[UIFont boldSystemFontOfSize:13]];
        [closeButton.titleLabel setTextColor:[UIColor whiteColor]];
        [closeButton setTitle:@"Close" forState:UIControlStateNormal];
        [closeButton addTarget:self action:@selector(closeView:) forControlEvents:UIControlEventTouchUpInside];

        CGRect swipeLabelFrame=CGRectMake(0, 0, 140, 15);
        UILabel *swipeLabel=[[UILabel alloc]initWithFrame:swipeLabelFrame];

        [swipeLabel setBackgroundColor:[UIColor clearColor]];
        [swipeLabel setText:@"> SWIPE TO SEE MORE"];
        [swipeLabel setTextColor:[UIColor lightGrayColor]];
        [swipeLabel setFont:[UIFont systemFontOfSize:12]];

        CGRect dateLabelFrame=CGRectMake(5, 365, 100, 15);
        dateLabel=[[UILabel alloc]initWithFrame:dateLabelFrame];

        [dateLabel setBackgroundColor:[UIColor clearColor]];
        [dateLabel setText:@"July 2013 #93"];
        [dateLabel setTextColor:[UIColor whiteColor]];
        [dateLabel setFont:[UIFont systemFontOfSize:13]];

        CGRect priceLabelFrame=CGRectMake(155, 365, 100, 15);
        priceLabel=[[UILabel alloc]initWithFrame:priceLabelFrame];

        [priceLabel setBackgroundColor:[UIColor clearColor]];
        [priceLabel setText:@"$3.9"];
        [priceLabel setTextColor:[UIColor colorWithRed:71.0/255 green:191.0/255 blue:226.0/255 alpha:1]];
        [priceLabel setFont:[UIFont systemFontOfSize:13]];
        [priceLabel setTextAlignment:NSTextAlignmentRight];

        CGRect labelFrame=swipeLabel.frame;
        labelFrame.origin=CGPointMake(popUpView.frame.origin.x+popUpView.frame.size.width - labelFrame.size.width, popUpView.frame.origin.y - labelFrame.size.height);

        [swipeLabel setFrame:labelFrame];

        [popUpView addSubview:imageGalleryView];
        [popUpView addSubview:btnTemp];
        [popUpView addSubview:closeButton];
        [popUpView addSubview:btnSubscribe];
        [popUpView addSubview:dateLabel];
        [popUpView addSubview:priceLabel];

        [UIView beginAnimations:@"curlup" context:nil];
        [UIView setAnimationDelegate:self];
        [UIView setAnimationDuration:.5];
        [UIView setAnimationTransition:UIViewAnimationTransitionCurlUp forView:popUpView cache:YES];
        [self addSubview:popUpView];

        [self addSubview:swipeLabel];
        [UIView commitAnimations];

        UIColor *color = [[UIColor alloc] initWithRed:0.0 green:0.0 blue:0.0 alpha:0.5];
        self.backgroundColor = color;

        [[[UIApplication sharedApplication] keyWindow] addSubview:self];
        [self initializeVariables];
    }
    return self;
} 
```

在父视图控制器中，只需创建 UIView 类的对象并使用您想要的 initWithFrame 和大小调用它

```
ModalPreviewViewController_iPhone *mpvc=[ModalPreviewViewController_iPhone alloc];

        if(appDelegate.isIphone5)
            mpvc=[mpvc initWithFrame:CGRectMake(0,0,320,480)];
        else
            mpvc=[mpvc initWithFrame:CGRectMake(0,0,320,568)]; 
```

并解雇 UivewClass

只需在其（UIviewClass's）方法之一（如closeView）中编写以下句子即可将其关闭

```
[self removeFromSuperview]; 
```

如果您遇到任何问题，请告诉我

# playframework-2.0 - 如何让 SecureSocial 用户保持登录状态？

> ID：14987479
> 
> 赞同：5
> 
> 时间：2013-02-20T18:39:16.603
> 
> 标签：playframework-2.0, securesocial

我有一个 Play 2.0.4 网络应用程序，它使用 SecureSocial 允许用户通过 twitter、facebook 和 gmail 等第三方提供商登录。那时，我没有使用自己的 UsernamePasswordProvider；也许我稍后会添加它。

我需要我的用户长时间保持登录状态，可能是一周。就我而言，用户会话仅用于各种便利功能，例如自定义，因此与长期会话相关的风险肯定不如不必每次都登录的便利那么重要。

看起来当前会话存储在一个临时 cookie 中，当用户终止浏览器时该 cookie 就会消失。配置文件中有一个 sessionTimeOut 参数，但它的目的似乎是终止浏览器中长时间保持打开状态的会话。至少，当我关闭并重新打开浏览器时，即使此超时设置为很大，会话也会立即中断。

保持用户长时间登录的推荐方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T19:56:26.030

来自 master 的最新快照（适用于 Play 2.1）有一个新属性，如果您需要，它可以使身份验证器 cookie 持久化。在您的配置文件中，您可以添加：

```
securesocial.cookie.makeTransient=false
securesocial.cookie.absoluteTimeoutInMinutes=1440
securesocial.cookie.idleTimeoutInMinutes=1440 
```

这将使 cookie 持久化并使会话持续 24 小时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-30T11:11:42.047

对于 Play 2.2，您需要将 cookie 部分添加到 securesocial.conf 文件，例如：

```
cookie {
    name=id
    path=/
    httpOnly=true
    idleTimeoutInMinutes=1440
    absoluteTimeoutInMinutes=1440
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-22T03:14:28.523

配置在这里定义和使用： [CookieAuthenticator](http://www.codatlas.com/project/r7__9Oz3ziiXi93aKzNURw__/master/module-code/app/securesocial/core/authenticator/CookieAuthenticator.scala?line=179)

您可以将鼠标悬停在变量上并查看配置的使用方式。

两个配置：absoluteTimeout 和 idleTimeout 用于不同的目的，这一[行](http://www.codatlas.com/project/r7__9Oz3ziiXi93aKzNURw__/master/module-code/app/securesocial/core/authenticator/StoreBackedAuthenticator.scala?line=108)控制 cookie 何时被视为有效

所以我建议你为 absoluteTimeoutInMinutes 使用比另一个更大的值

# java - JavaFX 应用程序中的 NoClassDefFoundError

> ID：14987480
> 
> 赞同：0
> 
> 时间：2013-02-20T18:39:18.000
> 
> 标签：java, javafx

为什么我在启动 javafx 应用程序时出现以下异常？

```
Glass detected outstanding Java exception at -[GlassViewDelegate sendJavaMouseEvent:]:src/com/sun/mat/ui/GlassViewDelegate.m:541
Exception in thread "JavaFX Application Thread" java.lang.NoClassDefFoundError: org/apache/commons/beanutils/BeanMap 
```

我在 pom.xml 和想法项目配置中有 beanutils。

我启动控制台应用程序之类的应用程序

```
public class Main extends Application {

public static void main(String[] args) {
    launch(args);
}

@Override
public void start(Stage stage) throws Exception {
    Pane pane = FXMLLoader.load(Main.class.getResource("fxml/main.fxml"));
    stage.setScene(new Scene(pane));
    stage.show();
}
} 
```

upd：看起来这个库在类路径中丢失了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:03:22.670

这很简单 =) 在启动模块中，我的 lib 在 pom.xml 中被标记为“排除”

# python - Django m2m 字段与另一个 m2m 字段对称

> ID：14987486
> 
> 赞同：0
> 
> 时间：2013-02-20T18:39:27.203
> 
> 标签：python, django, django-models, django-admin, django-orm

我想在两个不同的 m2m 字段之间进行自动关系绑定。这是我想要的工作流程的示例：

1.  创建标签“绿色”
2.  创建标签“颜色”并将“绿色”标记为孩子
3.  现在，当我回到“绿色”标签面板时，父母之间需要有“颜色”

不幸的是，这并不是那么简单，我什么也想不出来。我尝试将对称设置为 True，但这只是造成不必要的循环（“绿色”不是“颜色”的父级！）

```
# my models.py
class Tag(models.Model):
    ...
    children = models.ManyToManyField(
        'self',
        blank=True,
        related_name="kids",
        symmetrical=False
    )
    parents = models.ManyToManyField(
        'self',
        blank=True,
        related_name="folks",
        symmetrical=False
    ) 
```

感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T01:30:40.783

我相信你想要做的事情可以通过一个 M2M 关系来完成。查看[对称的文档](https://docs.djangoproject.com/en/1.4/ref/models/fields/#django.db.models.ManyToManyField.symmetrical)。如果您定义一个不对称场，您可以使用`related_name`参数来定义另一个关系：

```
class Tag(models.Model):
  name = models.TextField()
  children = models.ManyToManyField(
      'self',
      blank=True,
      related_name="parents",
      symmetrical=False
  )

green = Tag.objects.create(name='green')
color = Tag.objects.create(name='color')
color.children.add(green)
color in green.parents.all() # True 
```

# javascript - jQuery 接管所有锚标签

> ID：14987488
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:39:33.397
> 
> 标签：javascript, jquery, html, popup, anchor

我已经为弹出窗口实现了 jQuery 和 jQuery mobile，但经过一些测试后，我注意到 jQuery 正在接管所有锚点。如果我注释掉指向 jQuery 脚本的链接，并且我的锚点按预期工作，如果我取消注释它们，这些锚点将再次被接管，并且不会允许 href 正确通过。任何人都知道如何解决这个问题，至少可以说很烦人。这是样本...

```
<div>
 <ul>
  <li><a href="http://www.somesite.com">Somesite</a></li>
 </ul>
</div>
<div>
 <a href="#popupVideo" data-rel="popup" data-position-to="window" data-inline="true">Click</a>
 <div data-role="popup" id="popupVideo" data-overlay-theme="a" data-theme="d" data-tolerance="15,15" class="ui-content">
  <iframe width="560" height="315" src="http://www.somevideo.com" frameborder="0" allowfullscreen></iframe>
 </div>
</div>

    $( document ).on( "pageinit", function() {
        winW = window.innerWidth;
        winH = window.innerHeight;

        $( "#popupVideo iframe" )
            .attr( "width", 0 )
            .attr( "height", 0 );

        $( "#popupVideo" ).on({
            popupbeforeposition: function() {
                var size = scale( winW, winH, 15, 1 ),
                    w = size.width,
                    h = size.height;

                $( "#popupVideo iframe" )
                    .attr( "width", w )
                    .attr( "height", h );
            },
            popupafterclose: function() {
                $( "#popupVideo iframe" )
                    .attr( "width", 0 )
                    .attr( "height", 0 );    
            }
        });
    }); 
```

然后我有来自 jQuery 的示例附带的正确代码，该代码中没有任何内容是特定于锚点和特定于 id 的。另外，如果我删除调整弹出窗口的那个脚本，它仍然不起作用，我唯一链接的是 jQuery 文件。如果对 1.9.1 和移动 1.3.0 有帮助，我也在使用最新的 jQuery。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:49:02.717

我很确定您指的是 jQuery mobile 的默认行为。jQuery mobile 中锚标记的默认行为是使用 ajax 请求：

> jQuery Mobile 旨在使用简单的页面链接约定。本质上，您可以像往常一样链接页面和资产，并且 jQuery Mobile 将在单页面模型中自动处理页面请求，并尽可能使用 Ajax。当 Ajax 不可用时（例如非同域 url，或者如果使用链接上的某些属性指定），则使用普通的 http 请求。
> 
> 该模型的目标是允许开发人员使用最佳实践来创建网站——普通链接无需任何特殊配置即可“正常工作”——同时创建标准 HTTP 请求无法实现的丰富的、类似原生的体验。

[http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html](http://jquerymobile.com/demos/1.2.0/docs/pages/page-links.html)

此外：

> 指向其他域或具有 rel="external"、data-ajax="false" 或 target 属性的链接将不会被 Ajax 加载。相反，这些链接将导致整个页面刷新而没有动画过渡。两个属性（rel="external" 和 data-ajax="false"）具有相同的效果，但语义不同：链接到另一个站点或域时应使用 rel="external"，而 data-ajax=" false" 对于简单地选择域中的页面不通过 Ajax 加载很有用。由于安全限制，框架总是选择链接到外部域的 Ajax 行为。
> 
> 在 1.1 版中，我们添加了对在父容器上使用 data-ajax="false" 的支持，这允许您从 Ajax 导航系统中排除大量链接。这避免了需要将此属性添加到容器中的每个链接。要激活此功能，必须将 $.mobile.ignoreContentEnabled 设置为 true。请在使用和设置此选项之前检查配置默认值。
> 
> 注意：在构建一个全局禁用 Ajax 导航系统或在单个链接上经常禁用 Ajax 导航系统的 jQuery Mobile 应用程序时，我们建议禁用 $.mobile.pushStateEnabled 全局配置选项以避免在某些浏览器中出现不一致的导航行为。

# c++ - 保存客户信息的安全数据结构

> ID：14987489
> 
> 赞同：1
> 
> 时间：2013-02-20T18:39:35.383
> 
> 标签：c++, linux, sockets, map, pthreads

我正在编写一个应用程序，其中服务器必须跟踪来自多个客户端的连接。每个客户端都分配有一个连接 ID，它在每个数据包中发送该连接 ID 以进行识别。我想将连接 ID 映射到客户端信息。早些时候，我使用的是 std::map 但我发现它不是线程安全的。我需要一个可以在纯 C++03 中支持此功能的容器。不允许第三方库（使用实验室设备）。如果做不到这一点，请告诉我如何使用 std::map 和某种锁定来实现这一点

让我们调用数据结构信息。有 2 个线程在运行，（分别用于发送和接收）。他们对信息执行以下操作：-

```
recv_thread {
  //read id
  if(id == 0) info.insert(0,clientdata);
  else {
       do stff, update info[id]
}

send_thread { 
     for each key in info:
       if (key==0) {
          delete info[0];
          info.insert(connid, clientdata);
       }
       else {
           update info[key]
           if(client taking too long) delete info[key];
       }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:51:34.257

请参阅示例：-

[http://en.cppreference.com/w/cpp/thread/mutex](http://en.cppreference.com/w/cpp/thread/mutex)

使用互斥体创建 std::map

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:07:06.583

使用 __sync_fetch_and_add 获取下一个 connid 并使用 pthread mutex 包装您的其他地图调用。

```
pthread_mutex_t mutex;
int nextConnid = 1;
...
pthread_mutex_init(&mutex, NULL);
...
recv_thread {
  //read id
  if(id == 0) 
    info.insert(__sync_fetch_and_add(&nextConnid, 1), clientdata);
  else {
       do stff, 
       pthread_mutex_lock(&mutex);
       update info[id]
       pthread_mutex_unlock(&mutex);
}

send_thread { 
     for each key in info:
           pthread_mutex_lock(&mutex);
           update info[key]
           pthread_mutex_unlock(&mutex);
           if(client taking too long) delete info[key];

 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:27:23.080

您必须通过互斥锁保护您的容器。根据您用于启动线程的 api，它将是 pthread_mutex_t 或 std :: mutex

# sql-server - sp_executesql 不使用索引？

> ID：14987495
> 
> 赞同：3
> 
> 时间：2013-02-20T18:39:49.530
> 
> 标签：sql-server, nhibernate, count

我在我的 Web 应用程序中使用 nHibnerate，但在生成的 sp_execute 中使用索引时遇到问题。我的表有 2.1 亿条记录，查询速度很慢。

首先，生成的列“kolumna1”类型存在问题。在数据库中，我有一列 varchar，但 nHibernate 生成了 nvarchar。我通过在强制使用 varchar 的代码中添加特殊属性来解决这个问题。在那个技巧 sp_executed 开始使用索引之后，一切都是正确的。现在问题又回来了 sp_executesql 需要 10 分钟才能完成。当我检查正常查询（没有 sp_executesql）时，只需要 1 秒。我检查了两者的执行计划： sp_executesql 没有使用索引，而普通查询使用的是索引。在不更改索引的情况下，我将 varchar 修改回 nvarchar 并且 sp_execute 在 1 秒内完成（使用的索引）。有人知道我在哪里犯了错误吗？为什么执行计划对于如此小的变化是不同的？以及如何解决？

在这里我附上了更多代码。以防万一有人需要。

**带 varchar(8000) 的 sp_executesql**

```
exec  sp_executesql N'SELECT count(*) as y0_  FROM tabela1 this_ WHERE ((this_.kolumna2 >= @p0 and this_.kolumna2 <= @p1)) and  
    (this_.kolumna3 in (@p2, @p3) and this_.kolumna1 like @p4)',N'@p0 datetime,@p1 datetime,@p2 int,@p3 int,@p4 varchar(8000)',
    @p0='2013-01-08 14:38:00' ,@p1='2013-02-08 14:38:00',@p2=341,@p3=342,@p4='%501096109%' 
```

![带 varchar 的 sp_executesql](../Images/664a1f00cd41320a53faad808f001151.png)

**sp_executesql 与 nvarchar(4000)**

```
exec  sp_executesql N'SELECT count(*) as y0_  FROM tabela1 this_ WHERE ((this_.kolumna2 >= @p0 and this_.kolumna2 <= @p1)) and  
    (this_.kolumna3 in (@p2, @p3) and this_.kolumna1 like @p4)',N'@p0 datetime,@p1 datetime,@p2 int,@p3 int,@p4 nvarchar(4000)',
    @p0='2013-01-08 14:38:00' ,@p1='2013-02-08 14:38:00',@p2=341,@p3=342,@p4='%501096109%' 
```

![sp_executesql 与 nvarchar](../Images/3461c30b074951467d9287178d891acc.png)

有趣的是，在 sql profiler 中，两个查询都给出了相同的结果：

```
exec sp_executesql N'SELECT count(*) as y0_ FROM tabela1 this_  
WHERE this_.kolumna3 in (@p2, @p3) and ((this_.kolumna2 >= @p0 and this_.kolumna2 <= @p1))  
and ( this_.kolumna1 like @p4)',N'@p0 datetime,@p1 datetime,@p2 int,@p3 int,@p4 varchar(8000)',  
@p0='2013-01-08 14:38:00' ,@p1='2013-02-08 14:38:00',@p2=341,@p3=342,@p4='%501096109%'  
--Declare @p0 datetime  
--set @p0 = '2013-01-08 14:38:00'  
--Declare @p1 datetime  
--set @p1 = '2013-02-08 14:38:00'  
--Declare @p2 int  
--set @p2 = 341  
--Declare @p3 int  
--set @p3 = 342  
--Declare @p4 varchar(8000)  
--set @p4 = '%501096109%'  
--SELECT count(*) as y0_  
 --FROM tabela1 this_  
 --WHERE ((this_.kolumna2 >= @p0 and  
 --this_.kolumna2 <= @p1)) and  
 --(this_.kolumna3 in (@p2, @p3) and this_.kolumna1 like @p4) 
```

以下是索引：

```
CREATE TABLE [dbo].[tabela1](
[id] [bigint] NOT NULL,
[kolumna1] [varchar](128) NOT NULL,
[kolumna2] [datetime] NOT NULL,
[kolumna3] [int] NOT NULL,
CONSTRAINT [PK__tabela1__4F7CD00D] PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

CREATE NONCLUSTERED INDEX [ind_tabela1_ kolumna2] ON [dbo].[tabela1] 
(
    [kolumna2] ASC

)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX [ind_ tabela1_ kolumna3] ON [dbo].[ tabela1] 
(
    [kolumna3] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO

CREATE NONCLUSTERED INDEX [IX_ tabela1_ kolumna1] ON [dbo].[ tabela1] 
(
    [kolumna1] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_ tabela1_ kolumna2_ kolumna3] ON [dbo].[ tabela1] 
(
    [kolumna2] ASC,
    [kolumna3] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO
CREATE NONCLUSTERED INDEX [IX_ tabela1_ kolumna3_ kolumna2_id_ kolumna1] ON [dbo].[ tabela1] 
(
    [kolumna3] ASC,
    [kolumna2] ASC,
    [id] ASC,
    [kolumna1] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO 
```

查询执行计划如下： select count(*) from [dbo].[tabela1] where [kolumna1] like N'%501096109%' ![查询的执行计划](../Images/1b28471dea059d803e939d2732577878.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T11:31:38.877

你能试试这个：

(1) 运行以下SQL：

```
select * from sys.dm_exec_cached_plans
cross apply sys.dm_exec_sql_text(plan_handle) t 
```

(2) 使用最后一列查找第一个查询的 SQL。它不包含 sp_executesql，但会从您的参数列表开始，最后一个是 varchar。获取`plan_handle`, 并在以下语句中使用它：

```
dbcc freeproccache (<your_plan_handle>) 
```

然后重试查询 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T07:04:19.160

Sql Server 查询优化器可以选择在以下情况下使用索引查找：

1.  除了 LIKE 之外，还有另一个过滤谓词。它应该是精确搜索或至少是 SARGable 谓词
2.  表非常大（数百万行）

但是当使用显式类型转换时无法进行查找操作 - 不同的排序规则/数据类型。您无法控制此行为的另一件事是，查询计划可能因不同的谓词集而异。为此，您需要使用提示 FORCESEEK（版本 2008+）。您可以在此处找到信息：http: [//msdn.microsoft.com/en-us/library/ms187373%28v=sql.100%29.aspx](http://msdn.microsoft.com/en-us/library/ms187373%28v=sql.100%29.aspx)

# google-chrome - 打印预览中未显示背景颜色

> ID：14987496
> 
> 赞同：273
> 
> 时间：2013-02-20T18:39:50.717
> 
> 标签：google-chrome, css, printing, webkit

我正在尝试打印一页。在该页面中，我为表格提供了背景颜色。当我在 chrome 中查看打印预览时，它不具有背景颜色属性...

所以我尝试了这个属性：

```
-webkit-print-color-adjust: exact; 
```

但它仍然没有显示颜色。

[http://jsfiddle.net/TbrtD/](http://jsfiddle.net/TbrtD/)

```
.vendorListHeading {
  background-color: #1a4567;
  color: white;
  -webkit-print-color-adjust: exact; 
}

<div class="bs-docs-example" id="soTable" style="padding-top: 10px;">
  <table class="table" style="margin-bottom: 0px;">
    <thead>
      <tr class="vendorListHeading" style="">
        <th>Date</th>
        <th>PO Number</th>
        <th>Term</th>
        <th>Tax</th>
        <th>Quote Number</th>
        <th>Status</th>
        <th>Account Mgr</th>
        <th>Shipping Method</th>
        <th>Shipping Account</th>
        <th style="width: 184px;">QA</th>
        <th id="referenceSO">Reference</th>
        <th id="referenceSO" style="width: 146px;">End-User Name</th>
        <th id="referenceSO" style="width: 118px;">End-User's PO</th>
        <th id="referenceSO" style="width: 148px;">Tracking Number</th>
      </tr>
    </thead>
    <tbody>
      <tr class="">
        <td>22</td>
        <td>20130000</td>
        <td>Jim B.</td>
        <td>22</td>
        <td>510 xxx yyyy</td>
        <td>zznn@abc.co</td>
        <td>PDF</td>
        <td>12/23/2012</td>
        <td>Approved</td>
        <td>PDF</td>
        <td id="referenceSO">12/23/2012</td>
        <td id="referenceSO">Approved</td>
      </tr>
    </tbody>
  </table>
</div> 
```

* * *

## 回答 #1

> 赞同：494
> 
> 时间：2013-03-06T17:08:26.820

Chrome CSS 属性`-webkit-print-color-adjust: exact;`可以正常工作。

但是，确保您有正确的 CSS 用于打印通常很棘手。可以做几件事来避免你遇到的困难。首先，将所有打印 CSS 与屏幕 CSS 分开。这是通过`@media print`and完成的`@media screen`。

很多时候，仅仅设置一些额外的`@media print`CSS 是不够的，因为在打印时您仍然包含所有其他 CSS。在这些情况下，您只需要注意 CSS 的特殊性，因为打印规则不会自动战胜非打印 CSS 规则。

在你的情况下，它`-webkit-print-color-adjust: exact`正在工作。但是，您的`background-color`和颜色定义正在被其他具有更高特异性的 CSS 击败。

虽然我几乎**不赞成**在任何情况下使用`!important`，但以下定义可以正常工作并暴露问题：

```
@media print {
    tr.vendorListHeading {
        background-color: #1a4567 !important;
        -webkit-print-color-adjust: exact; 
    }
}

@media print {
    .vendorListHeading th {
        color: white !important;
    }
} 
```

这是[小提琴](http://jsfiddle.net/TbrtD/15/)（为了便于打印预览而[嵌入）。](http://jsfiddle.net/TbrtD/15/embedded/result/)

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2013-02-28T17:29:50.480

该 CSS 属性就是您所需要的，它对我有用...在 Chrome 中预览时，您可以选择查看 BW 和颜色（*颜色：选项 - 颜色或黑白*），所以如果您没有该选项，那么我建议抓住这个 Chrome 扩展程序，让你的生活更轻松：

[https://chrome.google.com/webstore/detail/print-background-colors/gjecpgdgnlanljjdacjdeadjkocnnamk?hl=en](https://chrome.google.com/webstore/detail/print-background-colors/gjecpgdgnlanljjdacjdeadjkocnnamk?hl=en)

您在小提琴上添加的网站需要在您的媒体打印 css 中使用它（您只需添加它...

媒体在正文中打印 CSS：

```
@media print {
body {-webkit-print-color-adjust: exact;}
} 
```

**更新** 好的，所以你的问题是 bootstrap.css ......它和你一样有一个媒体打印 css ......你删除它，那应该给你颜色......你需要自己做或坚持引导打印 css。

当我点击打印时，我看到颜色.... [http://jsfiddle.net/rajkumart08/TbrtD/1/embedded/result/](http://jsfiddle.net/rajkumart08/TbrtD/1/embedded/result/)

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2017-09-27T21:28:48.140

如果背景图形设置关闭，Chrome 将不会在打印时呈现背景颜色或其他几种样式。

这与 css、@media 或特异性无关。您可能可以绕过它，但让 chrome 显示背景颜色和其他图形的最简单方法是在“更多设置”下正确选中此复选框。

[![在此处输入图像描述](../Images/6fb78fe2e2831a46c3a19949db11d438.png)](https://i.stack.imgur.com/qc1g6.png)

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2015-02-19T16:59:18.660

我只需要将`!important`属性添加到背景颜色标签上即可显示，不需要 webkit 部分：

`background-color: #f5f5f5 !important;`

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2015-08-06T22:02:53.233

你的 CSS 必须是这样的：

```
@media print {
   body {
      -webkit-print-color-adjust: exact;
   }
}

.vendorListHeading th {
   background-color: #1a4567 !important;
   color: white !important;   
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-12-16T09:51:22.057

如果您使用引导程序或任何其他 3rd 方 CSS，请确保仅在其上指定媒体屏幕，以便您可以在自己的 CSS 文件中控制打印媒体类型：

```
<link rel="stylesheet" media="screen" href="">
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2018-08-15T15:18:24.723

**对于那些使用 BOOTSTRAP.CSS 的人来说，这就是修复！**

我已经尝试了所有解决方案，但它们都不起作用......直到我发现 bootstrap.css 有一个超级烦人`@media print`的东西，它会重置你所有的颜色、背景颜色、阴影等......

```
@media print{*,:after,:before{color:#000!important;text-shadow:none!important;background:0 0!important;-webkit-box-shadow:none!important;box-shadow:none!important} 
```

因此，要么从 bootstrap.css（或 bootstrap.min.css）中删除此部分

或者在您要自己打印的页面的css中覆盖这些值`@media print`

```
@media print {
  body { 
    -webkit-print-color-adjust: exact; 
  }
  .customClass{
     //customCss + !important;
  }
  //more of your custom css
} 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2019-03-28T09:50:01.127

> 对于 IE

如果您使用的是 IE，请转到打印预览（右键单击文档 -> 打印预览），转到设置，然后有“打印背景颜色和图像”选项，选择该选项并尝试。

[![在此处输入图像描述](../Images/4b95e65e6415a0e7ce073a2474ae1291.png)](https://i.stack.imgur.com/rVryx.png)

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-05-24T16:08:09.343

`@media print`在您的样式表中使用以下内容。

```
h1 {
    background-color:#404040;
    background-image:url("img/404040.png");
    background-repeat:repeat;
    box-shadow: inset 0 0 0 1000px #404040;
    border:30px solid #404040;
    height:0;
    width:100%;
    color:#FFFFFF !important;
    margin:0 -20px;
    line-height:0px;
} 
```

这里有几点需要注意：

*   背景颜色是绝对的后备，主要是为了后代。
*   背景图像使用 #404040 的 1px x 1px 像素制成 PNG。如果用户启用了图像，它可能会工作，如果没有......
*   设置盒子阴影，如果这不起作用......
*   边框 = 1/2 您想要的盒子高度和/或宽度，实心，颜色。在上面的例子中，我想要一个 60px 高度的盒子。
*   根据您在边框属性中控制的内容，将高度/宽度归零。
*   除非您使用 !important，否则字体颜色将默认为黑色
*   将 line-height 设置为 0 以修复没有物理尺寸的框。
*   制作和托管您自己的 PNG :-)
*   如果块中的文本需要换行，请将其放入 div 并使用 position:relative 定位 div；并删除行高。

请参阅我的[小提琴](http://jsfiddle.net/buttonpresser/vqxMA/)以获得更详细的演示。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-10-23T04:33:59.423

如果您使用的是**Bootstrap**，请在您的自定义 css 文件中使用此代码。Bootstrap 会删除打印预览中的所有颜色。

```
@media print{
  .box-text {

    font-size: 27px !important; 
    color: blue !important;
    -webkit-print-color-adjust: exact !important;
  }
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-03-06T17:09:45.563

你确定这是一个css问题吗？谷歌上有一些关于这个问题的帖子： http://productforums.google.com/forum/#!category-topic/chrome/discuss-chrome/ [eMlLBcKqd2s](http://productforums.google.com/forum/#!category-topic/chrome/discuss-chrome/eMlLBcKqd2s)

可能与打印过程有关。在同样是 webkit 的 safari 上，有一个复选框可以在打印机对话框中打印背景图像和颜色。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-05-31T15:38:32.710

在@media print{*,:after,:before ....} 下的引导 css 文件中有一个样式，它具有标记为 !important 的颜色和背景样式，它会删除任何元素上的任何背景颜色。杀死这两个CSS，它会工作。

Bootstrap 正在做出执行决定，即您**永远不**应该在打印件中使用任何背景颜色，因此您必须编辑他们的 css 或拥有另一个优先级更高的 !important 样式。干得好引导...

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-08-10T17:16:32.997

我使用了[purgatory101 的答案](https://stackoverflow.com/a/15253634/2734202)，但无法保持所有颜色（图标、背景、文本颜色等），尤其是 CSS 样式表不能与动态更改 DOM 元素颜色的库一起使用。因此，这是一个脚本，它在打印之前更改元素的样式（`background-colour`和`colour`），并在打印完成后清除样式。避免在样式表中编写大量 CSS 很有用，`@media print`因为它适用于任何页面结构。

有一部分脚本专门用于保持 FontAwesome 图标颜色（或任何使用`:before`选择器插入彩色内容的元素）。

**[JSFiddle 显示正在运行的脚本](https://plnkr.co/edit/K43sFFx0Z7D3Z1z4pzLe?p=preview)**

**兼容性：**在 Chrome 中工作，我没有测试其他浏览器。

```
function setColors(selector) {
  var elements = $(selector);
  for (var i = 0; i < elements.length; i++) {
    var eltBackground = $(elements[i]).css('background-color');
    var eltColor = $(elements[i]).css('color');

    var elementStyle = elements[i].style;
    if (eltBackground) {
      elementStyle.oldBackgroundColor = {
        value: elementStyle.backgroundColor,
        importance: elementStyle.getPropertyPriority('background-color'),
      };
      elementStyle.setProperty('background-color', eltBackground, 'important');
    }
    if (eltColor) {
      elementStyle.oldColor = {
        value: elementStyle.color,
        importance: elementStyle.getPropertyPriority('color'),
      };
      elementStyle.setProperty('color', eltColor, 'important');
    }
  }
}

function resetColors(selector) {
  var elements = $(selector);
  for (var i = 0; i < elements.length; i++) {
    var elementStyle = elements[i].style;

    if (elementStyle.oldBackgroundColor) {
      elementStyle.setProperty('background-color', elementStyle.oldBackgroundColor.value, elementStyle.oldBackgroundColor.importance);
      delete elementStyle.oldBackgroundColor;
    } else {
      elementStyle.setProperty('background-color', '', '');
    }
    if (elementStyle.oldColor) {
      elementStyle.setProperty('color', elementStyle.oldColor.value, elementStyle.oldColor.importance);
      delete elementStyle.oldColor;
    } else {
      elementStyle.setProperty('color', '', '');
    }
  }
}

function setIconColors(icons) {
  var css = '';
  $(icons).each(function (k, elt) {
    var selector = $(elt)
      .parents()
      .map(function () { return this.tagName; })
      .get()
      .reverse()
      .concat([this.nodeName])
      .join('>');

    var id = $(elt).attr('id');
    if (id) {
      selector += '#' + id;
    }

    var classNames = $(elt).attr('class');
    if (classNames) {
      selector += '.' + $.trim(classNames).replace(/\s/gi, '.');
    }

    css += selector + ':before { color: ' + $(elt).css('color') + ' !important; }';
  });
  $('head').append('<style id="print-icons-style">' + css + '</style>');
}

function resetIconColors() {
  $('#print-icons-style').remove();
} 
```

然后修改该`window.print`功能，使其在打印前设置样式并在打印后重置​​样式。

```
window._originalPrint = window.print;
window.print = function() {
  setColors('body *');
  setIconColors('body .fa');
  window._originalPrint();
  setTimeout(function () {
    resetColors('body *');
    resetIconColors();
  }, 100);
} 
```

找到为 :before 元素创建 CSS 的图标路径的部分是[此 SO 答案的副本](https://stackoverflow.com/a/5708130/2734202)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2017-11-22T07:41:25.933

您也可以使用该`box-shadow`属性。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-04-09T05:59:22.747

您可以使用带有 !important 的内联 css 样式。例如。

```
<p style="background:red!important">ABCD</p> 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-06-17T19:54:08.697

如果您下载没有“打印媒体样式”选项的 Bootstrap，您将不会遇到此问题，并且不必在 bootstrap.css 文件中手动删除“@media print”代码。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-01-25T10:47:35.940

如果您使用的是引导程序，则最好的解决方案是做一件事，删除其中的**@media print {}**所有代码。并在进行打印预览时从更多设置中启用背景图形。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2016-12-19T12:51:20.147

我双重加载我的外部 css 源文件并将 media="screen" 更改为 media="print" 并显示了我的表格的所有边框

试试这个 ：

```
<link rel="stylesheet" media="print" href="bootstrap.css" />

<link rel="stylesheet" media="screen" href="bootstrap.css" /> 
```

# ruby-on-rails - rails find_by_object

> ID：14987498
> 
> 赞同：0
> 
> 时间：2013-02-20T18:39:56.910
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我知道 rails 方法 find_by_name 但是如果我有一个对象而不是名称怎么办？假设我有`@car`和`@brand`对象。我如何搜索所有`cars`具有特定对象的`brand`对象。

就像是`@cars = Car.find_by_brand(@brand)`

我试过`@cars = @brand.cars`了，但这似乎只拉了一个父模型。

**编辑 - 有关代码的更多信息**

汽车控制器：

```
has_and_belongs_to_many :brands 
```

品牌型号：

```
 attr_accessible :name
  has_and_belongs_to_many :cars 
```

品牌控制器

```
def create
@car = Car.find(params[:car_id])
@brand = Brand.create
@brand.assign_attributes({ :name => params[:brand][:brands][:name] })
@brand.cars << @car
if @brand.save
  redirect_to @car
else
  flash[:notice] = "Error!"
  redirect_to @car
end
end

def findcars
    @brand = Brand.find_by_name(params[:brand_name])
    @cars = @brand.cars
end 
```

**看法**

```
<%= link_to brand.name, findcars_car_brand_path(@car, brand_name: brand.name), method: "get" %> 
```

**路线**

```
resources :cars do    
    resources :brands do
        member { get :findcars }
    end
end 
```

**表**- 连接表没有模型

`brands (name:string)`

`cars (name:string)`

`brands_cars (brand_id:integer, car_id:integer)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:05:34.613

我们先来看看 findcars。**.joins(:brands)**是关键，因为它允许您在构建 Car 对象时通过品牌条件（ **'brands.attribute' => brand_value ）缩小查询范围。**

SQL 将如下所示：

```
SELECT "cars".* FROM "cars" INNER JOIN "cars_brands" ON "cars_brands"."car_id" = "cars"."id" INNER JOIN "brands" ON "brands"."id" = "cars_brands"."brand_id" WHERE "brands"."id" = 1 
```

和这样的实现：

```
# If all you care about is the @cars - as the method name indicates
def findcars
    @cars = Car.joins(:brands).where('brands.name' => params[:brand_name])
end
# If you need both variables
def findcars
    @brand = Brand.find_by_name(params[:brand_name])
    @cars = Car.joins(:brands).where('brands.id' => @brand)
end 
```

没有连接，你的 sql 看起来像这样：

```
SELECT "cars".* FROM "cars" WHERE "brands"."id" = 1 
```

这将打破，因为“品牌”在这种情况下毫无意义。您需要为 rails 提供更多详细信息，以便它可以正确构建查询。

现在**创建**方法：

```
# @brand = Brand.create
# @brand.assign_attributes({ :name => params[:brand][:brands][:name] })
# params[:brand][:brands][:name] indicates something fishy with your form
# since this form is in the context of Brand, params[:name] should suffice 
@brand = Brand.create(:name => params[:brand][:brands][:name]) 
```

**redirect_to @car**是否意味着该表单是以汽车为中心的表单？在正确的上下文中使用 *form_for* 将简化对象的创建。

有关 2 个精彩的概述，请查看：

1.  [http://guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)
2.  [http://guides.rubyonrails.org/association_basics.html](http://guides.rubyonrails.org/association_basics.html)

# java - 我正在使用 JSF 2.0 和 Primefaces 3.4.2 我在 JSF 页面中有以下内容 <p:selectonemenu value="#{mb.employee}"><f:s 4="" 10216="" 问问题="" 2013-02-20t18:40:10.823="" 次="" this="" question="" shows="" research="" effort;="" it="" is="" useful="" and="" clear="" does="" not="" show="" any="" unclear="" or="" bookmark="" question.="" activity="" on="" post.="" 我正在使用="" jsf="" 2.0="" 和="" primefaces="" 3.4.2="" 我在="" 页面中有以下内容="" <p:selectonemenu="" value="#{mb.employee}"><f:selectitems value="#{mb.employeeList}" var="emp" itemlabel="#{emp.employeeName}" itemvalue="#{emp.employeeCode}"><p:ajax listener="#{mb.changeMethod}"></p:ajax></f:selectitems></f:s></p:selectonemenu>问题是当我在 selectOneMenu 中选择一个值时，我在 ManagedBean 的 changeMethod 中得到空值，为此System.out.println("val "+employee.getEmployeeName()); 这可能是什么原因？我该如何解决这个问题？任何 hep 都是非常可观的。 ManagedBean代码 @Named("mb") @ViewAccessScoped public class MyBean implements Serializable { private Employee employee; private List <employee>employeeList; @Inject EmployeeService employeeService; @PostConstruct public void loadEmployees() { employeeList = employeeService.getEmployees(); } public void changeMethod() { System.out.println("val "+employee.getEmployeeName()); } /* getters and setters for employee and employeeList */ .... methods /* */ 您没有在<p:ajax>组件上指定要处理的表单元素，因此 ajax 请求可能会提交可能与其他字段验证冲突的多个值。请记住，如果一个值被提交并且它没有通过验证，那么没有一个请求值被设置到模型中。当您到达 Application(Event) 阶段时，模型值将不会反映任何提交的请求值。 试试这个： <p:selectonemenu value="#{mb.employee}"><f:selectitems value="#{mb.employeeList}" var="emp" itemlabel="#{emp.employeeName}" itemvalue="#{emp.employeeCode}"><p:ajax process="@this" partialsubmit="true" listener="#{mb.changeMethod}"></p:ajax></f:selectitems></p:selectonemenu>在上面，您将仅提交要应用于模型的当前组件请求值。 编辑： 实际上，它可能不是一个验证问题，因为没有在 ajax 事件上提交请求值。 根据 Primefaces 手册： 处理 null 字符串组件以在部分请求中处理。 更新空字符串组件以使用 ajax 进行更新。 第二列是默认值。在标准<f:ajax>中，execute属性默认为，@this但是对于<p:ajax>. 如果要提交当前组件，则必须在process属性中指定。 javajsfjsf-2primefaces 4 2 回答 2 This answer is useful 9 您没有在<p:ajax>组件上指定要处理的表单元素，因此 ajax 请求可能会提交可能与其他字段验证冲突的多个值。请记住，如果一个值被提交并且它没有通过验证，那么没有一个请求值被设置到模型中。当您到达 Application(Event) 阶段时，模型值将不会反映任何提交的请求值。 尝试这个： <p:selectonemenu value="#{mb.employee}"><f:selectitems value="#{mb.employeeList}" var="emp" itemlabel="#{emp.employeeName}" itemvalue="#{emp.employeeCode}"><p:ajax process="@this" partialsubmit="true" listener="#{mb.changeMethod}"></p:ajax></f:selectitems></p:selectonemenu>在上面，您将仅提交要应用于模型的当前组件请求值。 编辑： 实际上，它可能不是一个验证问题，因为没有在 ajax 事件上提交请求值。 根据 Primefaces 手册： 处理 null 字符串组件以在部分请求中处理。 更新空字符串组件以使用 ajax 进行更新。 第二列是默认值。在标准<f:ajax>中，execute属性默认为，@this但是对于<p:ajax>. 如果要提交当前组件，则必须在process属性中指定。 于 2013-02-20T19:17:35.030 回答 This answer is useful 2 您需要将转换器添加到p:selectOneMenu以让它知道您正在处理员工对象。创建转换器类并将其与转换器属性一起使用。这是示例转换器。 import javax.faces.component.UIComponent; import javax.faces.context.FacesContext; import javax.faces.convert.Converter; import javax.faces.convert.FacesConverter; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.beans.factory.annotation.Configurable; @FacesConverter("employeeConverter") @Configurable public class EmployeeConverter implements Converter { @Autowired EmployeeService employeeService; public Object getAsObject(FacesContext context, UIComponent component, String value) { if (value == null || value.length() == 0) { return null; } Long id = Long.parseLong(value); return employeeService.findUser(id); } public String getAsString(FacesContext context, UIComponent component, Object value) { return value instanceof Employee ? ((Employee) value).getId().toString() : ""; } } 于 2013-02-21T15:05:17.343 回答 Related 2 spring - Spring MVC中的数组@ModelAttribute扩展 1 php - Facebook 集成 - 您是否需要一个单独的页面来与自定义对象进行交互，或者页面上是否有多个对象？ 4 php - 用 mktime() 显示明天的日期； 1 xml - 从外部提供者调用数据但无法显示所需数据 3 ruby - Ruby：根据整数数组对对象数组进行排序 1 php - PHP：动态加载插件/模块列表 2 wix - 在 UI 上显示 ADDLOCAL 属性的值 1 php - 对用户提交的数据进行加盐和哈希处理 2 iphone - 如何将用户发送到 App Store 以安装应用程序，或从网站发送到带有变量的应用程序？ 2 java - 可视化 sqlite 数据库 schemaspy Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</p:ajax></f:ajax></p:ajax></p:ajax></f:ajax></p:ajax></employee>

> ID：14987501
> 
> 赞同：4
> 
> 时间：
> 
> 标签：java, jsf, jsf-2, primefaces

我正在使用 JSF 2.0 和 Primefaces 3.4.2

我在 JSF 页面中有以下内容

```
<p:selectOneMenu value="#{mb.employee}">
    <f:selectItems value="#{mb.employeeList}" var="emp"
    itemLabel="#{emp.employeeName}" itemValue="#{emp.employeeCode}"/>
    <p:ajax listener="#{mb.changeMethod}" />
</p:selectOneMenu> 
```

问题是当我在 selectOneMenu 中选择一个值时，我在 ManagedBean 的 changeMethod 中得到空值，为此`System.out.println("val "+employee.getEmployeeName());`

这可能是什么原因？我该如何解决这个问题？任何 hep 都是非常可观的。

**ManagedBean**代码

```
@Named("mb")
@ViewAccessScoped
public class MyBean implements Serializable {

private Employee employee;
private List<Employee> employeeList;

@Inject
EmployeeService employeeService;

@PostConstruct
public void loadEmployees() {
employeeList = employeeService.getEmployees();
}

public void changeMethod() {
System.out.println("val  "+employee.getEmployeeName());
}

/* getters and setters for employee and employeeList */
.... methods
/* */ 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T19:17:35.030

您没有在`<p:ajax>`组件上指定要处理的表单元素，因此 ajax 请求可能会提交可能与其他字段验证冲突的多个值。请记住，如果一个值被提交并且它没有通过验证，那么没有一个请求值被设置到模型中。当您到达 Application(Event) 阶段时，模型值将不会反映任何提交的请求值。

尝试这个：

```
<p:selectOneMenu value="#{mb.employee}">
    <f:selectItems value="#{mb.employeeList}" var="emp"
    itemLabel="#{emp.employeeName}" itemValue="#{emp.employeeCode}"/>
    <p:ajax process="@this" partialSubmit="true" listener="#{mb.changeMethod}" />
</p:selectOneMenu> 
```

在上面，您将仅提交要应用于模型的当前组件请求值。

**编辑：**

实际上，它可能不是一个验证问题，因为没有在 ajax 事件上提交请求值。

根据 Primefaces 手册：

> 处理 null 字符串组件以在部分请求中处理。
> 
> 更新空字符串组件以使用 ajax 进行更新。

第二列是默认值。在标准`<f:ajax>`中，`execute`属性默认为，`@this`但是对于`<p:ajax>`. 如果要提交当前组件，则必须在`process`属性中指定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-21T15:05:17.343

您需要将转换器添加到**p:selectOneMenu**以让它知道您正在处理**员工对象**。创建转换器类并将其与**转换器**属性一起使用。这是示例转换器。

```
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.convert.FacesConverter;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Configurable;

@FacesConverter("employeeConverter")
@Configurable
public class EmployeeConverter implements Converter {

    @Autowired
    EmployeeService employeeService;

    public Object getAsObject(FacesContext context, UIComponent component,
            String value) {
        if (value == null || value.length() == 0) {
            return null;
        }
        Long id = Long.parseLong(value);
        return employeeService.findUser(id);
    }

    public String getAsString(FacesContext context, UIComponent component,
            Object value) {
        return value instanceof Employee ? ((Employee) value).getId().toString() : "";
    }
} 
```

# c# - 在我的用户控件上调用方法时，如何更新主窗体上的按钮文本？

> ID：14987503
> 
> 赞同：0
> 
> 时间：2013-02-20T18:40:18.040
> 
> 标签：c#

在我的主要表格上：

```
public string updateButtonText
{
   get { return btnInbox.Text; }
   set { btnInbox.Text = value; }
} 
```

在我的用户控件上：

```
public void refreshInbox()
{
   try
   {
       mailboxLogic.constructInbox(lstViewInbox, StudentsData.studentUsername);
       frmMailbox.updateButtonText = "Inbox" + "(" + MailboxLogic.emailcounter + ")";
   }
   catch (Exception ex)
   {
       MessageBox.Show("1"+ex.Message);
   }
} 
```

每次我更新我的列表视图时，我都会尝试调用 updateButtonText 方法。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:45:27.113

如果您只想知道在选择列表视图项时如何更新文本框，那么您需要查看[ItemSelectionChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.itemselectionchanged%28v=vs.100%29.aspx)事件。[否则，请查看listview 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview%28v=vs.100%29.aspx)中的任何其他事件。

如果你不理解事件，那么我建议[这个 SO question](https://stackoverflow.com/questions/803242/understanding-events-and-event-handlers-in-c-sharp)

# jquery - Web2Py Ajax 附加到 DIV

> ID：14987504
> 
> 赞同：1
> 
> 时间：2013-02-20T18:40:21.337
> 
> 标签：jquery, python, ajax, append, web2py

我正在尝试使用 AJAX 将内容附加到 ID 为“this_div”的 div。

HTML：

```
<a href='#' onclick="ajax('append?what=first',
['content'],'this_div')">click</a>

<div id='this_div'></div> 
```

控制器：

```
def append():
    if request.vars.what == "first":
        something = "ABC"
    else:
        something = "DEF"

return "<script>jQuery('#this_div').append('"+something+"')</script>" 
```

这会将“某物”的内容加载到 div 中，但不会保留以前的内容。谁能解释一下为什么会这样？我是 Python/Web2Py/AJAX 组合的新手。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T20:07:01.130

The problem is that the `ajax()` function itself overwrites the contents of `this_div` because that is the target specified (i.e., it replaces the DIV contents with the returned `<script>` element, which then appends the text to the DIV). If you want to append instead of overwrite, you can do so via Javascript, but in that case you need to specify ":eval" as the target:

```
<a href='#' onclick="ajax('append?what=first', [], ':eval')">click</a>

<div id='this_div'></div> 
```

Controller:

```
def append():
    if request.vars.what == "first":
        something = "ABC"
    else:
        something = "DEF"
    return "jQuery('#this_div').append('%s');" % something 
```

Note, no need for the `<script>` tag in that case -- just return the Javascript to be executed. Also, if your `append()` function doesn't use the "content" input, the second argument to `ajax()` can just be an empty array (i.e., `[]`) instead of `['content']`.

# php - 如何分段上传大文件？不改变 php.ini

> ID：14987508
> 
> 赞同：0
> 
> 时间：2013-02-20T18:40:33.320
> 
> 标签：php

这是我的代码：

```
//Receive the data from android
$name = $_POST['name'];

//Receive the file
$file = $_FILES['image'];

$uploadfile="Media/".$name;
if(is_uploaded_file($_FILES['image']['tmp_name'])) {
if(move_uploaded_file($_FILES['image']['tmp_name'], $uploadfile)) {
 echo json_encode(
        array(
            'result'=>'success',
            'msg'=>'Media saved successfully.'
            )
        );
 }else{
     echo json_encode(
        array(
            'result'=>'The media can not be saved ',
            'msg'=>'Problems with the file.'
            )
        );
}
  }

?> 
```

这适用于 2 MB 以下的文件，我不想要这个限制，我也不想更改 php.ini（不是因为我），所以我如何将大文件部分发送到服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:44:19.247

您可以使用以下方法临时覆盖某些 php.ini 值`ini_set()`（仅在对脚本的请求的生命周期内）：您可以接受吗？

[http://php.net/manual/en/function.ini-set.php](http://php.net/manual/en/function.ini-set.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-26T02:37:47.657

我遇到了同样的问题，因为托管服务提供商不允许我更改`php.ini`，但我使用文件修复了问题`.user.ini`，在此处输入您应该在域的根文件夹中创建的代码。这个文件看起来像`php.ini`，但在本地运行（从 PHP 5.3 开始可用）。更多信息请访问[http://php.net/manual/en/configuration.file.per-user.php](http://php.net/manual/en/configuration.file.per-user.php)

然后例如上传最多100MB，应该写`.user.ini`：

```
upload_max_filesize = 100M
post_max_size = 100M
memory_limit = 105M 
```

# javascript - 按钮无法正确加载

> ID：14987511
> 
> 赞同：0
> 
> 时间：2013-02-20T18:40:55.417
> 
> 标签：javascript, popup, blogger, tumblr

我正在为 Tumblr 使用一个 JS 按钮，该按钮已针对[我的 blog](http://easytestcore.blogspot.com.au/)的变量进行了自定义。该按钮会加载一个弹出窗口，但它们不会出现在每个单独的帖子下，而是全部组合在一起。此外，它输出：`&quot;`到 Tumblr 共享屏幕标题而不是实际报价。

如何将弹出窗口居中单击？

```
<script src='http://platform.tumblr.com/v1/share.js'/>

<span id='tumblr_button_abc123'></span>
<script type='text/javascript'>
var strPostUrl = "<data:post.url/>";
var strPostTitle = '<data:post.title/>';
var tumblr_link_url = strPostUrl.replace("http://","");
var tumblr_link_name = strPostTitle.replace(/"/g, '"');
</script>
<script type='text/javascript'>
var tumblr_button = document.createElement("a");
tumblr_button.setAttribute("href", "http://www.tumblr.com/share/link?url=" + encodeURIComponent(tumblr_link_url) + "&name=" + encodeURIComponent(tumblr_link_name));
tumblr_button.setAttribute("title", "Share on Tumblr");
tumblr_button.setAttribute("style", "display:inline-block; text-indent:-9999px; overflow:hidden; width:81px; height:20px; background:url('http://platform.tumblr.com/v1/share_1.png') top left no-repeat transparent;");
tumblr_button.innerHTML = "Share on Tumblr";
document.getElementById("tumblr_button_abc123").appendChild(tumblr_button);
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:48:24.827

你有多个`span`id `tumblr_button_abc123`，所以当你向这个 id 添加一个按钮时，只有第一个`span`得到按钮

# c# - 从 cookie 中删除奇怪的字符 (VB)

> ID：14987512
> 
> 赞同：1
> 
> 时间：2013-02-20T18:41:02.250
> 
> 标签：c#, vb.net, cookies

我有一个标签 (Label1.Text)，其中包含我程序中所有计算器条目的历史记录。我找到了一种检索 cookie 的方法，但它包含以下奇怪的字符。如何删除它们？

%0d%0a5+5=10

```
 Sub Page_Load(s As Object, e As EventArgs)
        If Request.Cookies("Cookie") IsNot Nothing Then
            Label1.Text = Server.HtmlEncode(Request.Cookies("Cookie").Value)
        End If
    End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T22:49:31.287

利用：

```
Label1.Text = Uri.UnescapeDataString(Request.Cookies("Cookie").Value) 
```

# google-maps - 为什么我的地理编码调用缺少地址的一部分？

> ID：14987514
> 
> 赞同：0
> 
> 时间：2013-02-20T18:41:09.650
> 
> 标签：google-maps, geocoding, street-address

通过谷歌地理编码器邮政编码：**W11 2BQ**我希望看到英格兰作为返回地址的一部分，但事实并非如此。我错过了显而易见的事情吗？

这是电话：

```
http://maps.googleapis.com/maps/api/geocode/json?address=W11+2BQ&sensor=false 
```

# asp.net-mvc - 在 Orchard CMS 模块中使用 CKFinder

> ID：14987524
> 
> 赞同：1
> 
> 时间：2013-02-20T18:41:35.320
> 
> 标签：asp.net-mvc, orchardcms, ckfinder

在尝试将 CKsource CKFinder 控件集成到 Orchards CMS 中。我已经用一个普通的非果园项目做到了这一点，但是在果园 CMS 项目中遇到了困难。

当弹出查找器控件时，我收到以下 javascript 错误：

```
It was not possible to properly load the XML response from the web server.

Raw response from the server: 

<%@ Page Language="c#" Inherits="CKFinder.Connector.Connector" Trace="false"    
AutoEventWireup="false" %><%@ Assembly Name="AAA.CMS"%> <%@ Register       
Src="../../../config.ascx" TagName="Config" TagPrefix="CKFinder" %> <%-- * CKFinder * 
======== * http://cksource.com/ckfinder * Copyright (C) 2007-2013, CKSource - Frederico 
Knabben. All rights reserved. * * The software, this file and its contents are subject 
to the CKFinder * License. Please read the license.txt file before using, installing, 
copying, * modifying or distribute this file or part of its contents. The contents of 
* this file is part of the Source Code of CKFinder. * * --- * This is the ASP.NET 
connector for CKFinder. * * You must copy the CKFinder.Connector.dll file to your "bin" 
directory or * make a    reference to it in your Visual Studio project. --%> 
```

我已经验证我的 Config.ascx 是正确的。我可以访问 js 文件。是否可以将 ckfinder 集成到 Orchard 模块中？

# java - 从 Line2D 值添加多边形点

> ID：14987526
> 
> 赞同：1
> 
> 时间：2013-02-20T18:42:02.917
> 
> 标签：java, awt, polygon, java-2d, point-in-polygon

我有一小段代码从名为 lineList 的数组（在不同的类中）读取 Line2D 值，并将它们存储在名为 list 的新数组中。从这里开始，我一直在尝试将所有线值转换为多边形点（线端的每个 x、y 坐标的一个点）。

到目前为止，我已经让它工作了，但它不适用于添加的数组中第一行的第一个点（这就是我怀疑的），我无法找到解决方案，因为我已经尝试将它包含在第一个 if 语句。

我将非常感谢任何人能够为此提供的任何帮助。

下面是我用于从 Line2D 值添加点的代码：

```
Polygon p = new Polygon();
    ArrayList<Line2D> list = new ArrayList<Line2D>();
    Color pixel;
    boolean firstTime = true;

    list = segmentation.getLineList();

    //loop through lineList and add all x and y coordinates to relative x and y arrays
    for(int i = 0; i < list.size(); i++) {
        if(firstTime == true){
            Line2D line = list.get(i);
            Point2D startPoint = line.getP1();
            Point2D endPoint = line.getP2();
            int startX = (int) startPoint.getX();
            int startY = (int) startPoint.getY();
            int endX = (int) endPoint.getX();
            int endY = (int) endPoint.getY();
            p.addPoint(p.xpoints[i] = startX, p.ypoints[i] = startY);
            p.addPoint(p.xpoints[i] = endX, p.ypoints[i] = endY);
            startPoint = null;
            endPoint = null;
            line = null;
            firstTime = false;
        }
        else {
            Line2D line = list.get(i);
            Point2D endPoint = line.getP2();
            int endX = (int) endPoint.getX();
            int endY = (int) endPoint.getY();
            p.addPoint(p.xpoints[i] =  endX, p.ypoints[i] = endY);
            endPoint = null;
            line = null;    
        }
    } 
```

下面是第一个点（最低点）不包含在多边形点中的示例。 ![在此处输入图像描述](../Images/8432b35413f1b566f49750ac368b29de.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:12:07.860

对我来说似乎有很多重复的代码。在我们尝试更多调试之前，让我们重构代码并使其更易于理解和调试。

**重构**

我们可以提取的第一段代码是向多边形添加一个点的代码。这是新方法。

```
protected void addPoint(Polygon p, Point2D point) {
    int x = (int) point.getX();
    int y = (int) point.getY();
    p.addPoint(x, y);
} 
```

现在，我没有在一次重构中做到这一点。我先把端点代码拉出来，因为它是一样的。在对代码进行了更多思考之后，我对其进行了概括，以便可以将其用作起点代码。

当我第一次看到这行代码时

```
 p.addPoint(p.xpoints[i] = startX, p.ypoints[i] = startY); 
```

我想，WT​​F？我从未见过有人在方法调用中设置值。在 where 子句中，当然。

经过大约 5 分钟的思考，我意识到 Polygon 类的内部值是**在执行 addPoint 方法之后**设置的。虽然这可能对其他一些方法调用很有用，但这里没有必要。方法调用可以简化为

```
p.addPoint(x, y); 
```

Java 开发人员，如果您需要另一个理由来使您的类变量不公开，这是一个非常好的理由。在您在 setter 方法中设置类变量后，阻止人们设置它们。

**启动阅读**

如果我们使用一种称为启动读取的鲜为人知的算法，我们可以摆脱第一次切换和大量代码。

大多数 for 循环都将输入语句作为循环中的第一条语句。循环的`for (String s : stringList)`构造隐藏了输入语句是循环中的第一条语句的事实。

但有时，您有一种方法需要启动阅读。这种方法就是其中之一。

在伪代码中，启动读取的工作方式如下。

```
Read input
for loop
    process input
    read input
end loop
process last input 
```

通过使用启动读取，我能够大大简化 createPolygon 方法。

任何读到这篇文章的 Cobol 程序员都会想，“是的，读法是启动读法”。

Java 程序员，请记住这个启动读物的想法。您不会经常使用它，但正如您所见，它在某些情况下大大减少了您需要的代码量。

**重构代码**

```
public Polygon createPolygon(Segmentation segmentation) {
    Polygon p = new Polygon();
    List<Line2D> list = segmentation.getLineList();
    if (list.size() < 2) return p;

    Line2D line = list.get(0);
    addPoint(p, line.getP1());

    // loop through lineList and add all x and y coordinates to relative x
    // and y arrays
    for (int i = 1; i < list.size(); i++) {
        addPoint(p, line.getP2());
        line = list.get(i);
    }

    addPoint(p, line.getP2());
    return p;
}

protected void addPoint(Polygon p, Point2D point) {
    int x = (int) point.getX();
    int y = (int) point.getY();
    p.addPoint(x, y);
} 
```

我对代码做了两件事。

1.  我添加了少于 2 行的测试。基本上，创建一个三角形（多边形）至少需要 2 条线。对 1 行或 0 行执行该方法毫无意义。

2.  我将 ArrayList 引用更改为 List。在 Java 中，最好在具体类上使用接口。由于我们在代码中使用的唯一 List 方法是 get 方法，因此我们可以使用接口。使用该接口的优点是 createPolygon 方法不关心 getLineList 方法是否返回 ArrayList、LinkedList 或实现 List 的自定义类。这使得将来的修改更容易。

# sql - 在 Oracle 中计算条件累积和

> ID：14987534
> 
> 赞同：4
> 
> 时间：2013-02-20T18:42:22.337
> 
> 标签：sql, oracle

我正在尝试做的事情的广泛观点是找出在预订日期之前整个系统中有多少尚未发生的预订。这意味着计算存在于`redemption_date`之后或等于的所有记录的数量`booking_date`，分组依据`booking_date`。请参阅以下假设示例以获得更好的解释：

```
redemption_date      booking_date
2013-01-01           2013-01-01
2013-01-06           2013-01-01
2013-01-06           2013-01-01
2013-01-07           2013-01-02
2013-01-08           2013-01-03
2013-01-09           2013-01-04
2013-01-10           2013-01-05
2013-01-10           2013-01-05
2013-01-10           2013-01-05
2013-01-10           2013-01-05
2013-01-10           2013-01-05
2013-01-11           2013-01-05 
```

我想要结果：

```
booking_date         number_of_reservations
2013-01-01           3
2013-01-02           3
2013-01-03           4
2013-01-04           5
2013-01-05           11 
```

但是我的大脑完全不知道应该如何构造查询。有小费吗？谢谢！

编辑：为了澄清，number_of_reservations 应该是在该日期预订的预订数量，以及在该日期之后预订的预订数量。换句话说，number_of_reservations 是截至 booking_date 数据库中的预订数量（尚未发生）。我原来的结果确实有错误。对困惑感到抱歉

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-20T18:44:47.140

```
SELECT
    booking_date,
    COUNT(
        CASE WHEN redemption_date >= booking_date 
        THEN 1 END
    ) AS number_of_reservations
FROM
    Reservations
GROUP BY
    booking_date 
```

## [Sql 小提琴](http://sqlfiddle.com/#!4/e755a/5)

* * *

## 编辑：

根据更新的描述，我相信这应该会产生预期的结果：

```
SELECT DISTINCT
    r."booking_date",
    (SELECT COUNT(*) 
     FROM reservations r2 
     WHERE 
         r2."booking_date" <= r."booking_date"
         AND r2."redemption_date" >= r."booking_date"
    ) AS number_of_reservations
FROM
    Reservations r
ORDER BY r."booking_date" 
```

## [Sql 小提琴](http://sqlfiddle.com/#!4/e755a/20)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T18:44:03.620

您可以使用`case`with轻松完成此操作`sum`。

```
select booking_date,
       SUM(case when redemption_date >= booking_date then 1 else 0 end)
from bookings b
group by booking_date
order by booking_date 
```

顺便说一句，这并不是真正的累积总和。将具有以下语法：

```
sum(whatever) over (partition by . . . order by . . . ) 
```

它会在每一行上放置一个计算值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-20T18:45:12.707

这应该可以为您提供所需的东西

```
SELECT booking_date, SUM(CASE WHEN booking_date >= redemption_date THEN 1 ELSE 0 END) AS number_of_reservations
FROM yourtable
GROUP BY booking_date
ORDER BY booking_date 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-20T18:44:28.997

试试这个（我假设你想要所有这些，而不是出现超过一定数量的）

```
select booking_date, count(*) as number_of_reservations
from table_name
group by booking_date order by booking_date 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-09-27T11:16:05.187

这是一个简单的解决方案。

```
select a.trans_id,
  a.quantity+nvl((select sum(quantity) from table1 where trans_id<a.trans_id),0) quantity 
from table1 a 
order by a.sys_trans_id 
```

# c++ - const WCHAR * myVar 与 const char * myVar

> ID：14987537
> 
> 赞同：0
> 
> 时间：2013-02-20T18:42:34.710
> 
> 标签：c++, c, winapi

我开发了一个小的 bmp 到 jpg 转换器。以下代码正在工作并提供我需要的准确结果

```
BOOLEAN convertBMPtoJPG(const WCHAR *src_bmp_path,const WCHAR *dest_jpeg_path); 
```

然后调用函数，

```
const WCHAR *src_bmp_path = L"test.bmp";
const WCHAR *dest_jpeg_path= L"test.jpg";
convertBMPtoJPG(src_bmp_path,dest_jpeg_path); 
```

但是，我需要将函数更改如下（根据我给出的要求），但这样做会导致编译错误。

```
BOOLEAN convertBMPtoJPG(char *src_bmp_path,char *dest_jpeg_path); 
```

然后函数将被称为，（尽管我只需要遵循上面的原型），

```
char *src_bmp_path = "test.bmp";
char *dest_jpeg_path= "test.jpg";
convertBMPtoJPG(src_bmp_path,dest_jpeg_path); 
```

关于 stackover 的另一个问题提供了太多关于 Win32 类型的信息，但是我还不能解决这个问题。我在 Win32 API 方面不是很好，请指导我在以后的方法中出了什么问题。

**编辑：**

错误消息： **错误 C2664：'Gdiplus::Status Gdiplus::Image::Save(const WCHAR *,const CLSID *,const Gdiplus::EncoderParameters *)'：无法将参数 1 从 'char *' 转换为 'const WCHAR * ' 1> 指向的类型是不相关的；转换需要 reinterpret_cast、C-style cast 或 function-style cast**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:02:38.393

`Image::Save()`仅接受`WCHAR*`值，因此您的`char*`包装器必须转换为`WCHAR*`，例如 with `MultiByteToWideChar()`（就像 Win32 API Ansi 函数在内部调用 Win32 API Unicode 函数时所做的那样），例如：

```
std::wstring towstring(const char *src)
{
    std::wstring output;
    int src_len = strlen(src);
    if (src_len > 0)
    {
        int out_len = MultiByteToWideChar(CP_ACP, 0, src, src_len, NULL, 0);
        if (out_len > 0)
        {
            output.resize(out_len);
            MultiByteToWideChar(CP_ACP, 0, src, src_len, &output[0], out_len);
        }
    }
    return output;
}

BOOLEAN convertBMPtoJPG(char *src_bmp_path,char *dest_jpeg_path)
{
    return convertBMPtoJPG(towstring(src_bmp_path).c_str(), towstring(dest_jpeg_path).c_str());
}

BOOLEAN convertBMPtoJPG(const WCHAR *src_bmp_path, const WCHAR *dest_jpeg_path)
{
   // your existing conversion logic here...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:48:29.310

好吧，看起来您正在为 Unicode 支持进行编译。Win32 数据类型列表可以在[这里找到](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383751%28v=vs.85%29.aspx)

WCHAR 定义为 -

```
 A 16-bit Unicode character. For more information, see Character Sets Used By Fonts.
 This type is declared in WinNT.h as follows:
 typedef wchar_t WCHAR; 
```

这是一个链接，显示如何在各种字符串类型之间[转换字符串转换示例。](http://msdn.microsoft.com/en-us/library/ms235631%28v=vs.80%29.aspx)

# javascript - 服务器发送的事件是“忙等待”吗？

> ID：14987539
> 
> 赞同：2
> 
> 时间：2013-02-20T18:42:35.540
> 
> 标签：javascript, python, flask, server-sent-events

我正在使用烧瓶建立一个网站，我希望对客户端进行推送。我关注 [了 real-time-events-python](http://s-n.me/blog/2012/10/16/realtime-websites-with-flask/)并且能够创建网站。

我注意到的一件事是，当访问 Javascript 控制台时，每 500 毫秒有一个 GET，所以我想知道 javascript 的 EventSource 是否真的定期向服务器发送一个 GET 以查看是否有任何更新，导致它是一个忙碌的等待。

有关信息，我正在使用 Flask（python 框架）来开发网站并使用 chrome 来访问它。

[服务器发送事件规范](http://dev.w3.org/html5/eventsource/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:44:15.823

根据[您提供的链接](http://s-n.me/blog/2012/10/16/realtime-websites-with-flask/)，是的，浏览器发送 GET 作为服务器发送事件的实现：

> 服务器发送事件的实际协议非常简单。客户端将打开到服务器的标准连接并发出 GET 请求。它期望服务器保持打开套接字并通过在它们前面加上 data: 并以两个换行符终止来发送新事件。

因此，在服务器端，连接应该保持打开状态，而数据仍在通过它流式传输。请记住，服务器发送的事件允许自动重新连接，所以如果您遇到很多重新连接（我想这是所有这些都得到的，除非您的客户端代码没有正确编写），您应该检查以使确保您的服务器端没有关闭连接，这会导致浏览器重新打开连接。

至于“忙等”，如果我理解正确的话，你不必担心这个。这是由浏览器处理的，因此您的代码在等待时不会阻塞。

# java - Java：从类调用方法/空逻辑错误

> ID：14987543
> 
> 赞同：0
> 
> 时间：2013-02-20T18:43:01.807
> 
> 标签：java

我很难围绕基于对象的编程。我试图从一个类中调用一个方法。但是，我调用的只是一个已声明的变量，而我稍后会尝试提取该变量。（我确定我的术语是关闭的 - 随时更正）

我得到逻辑错误。而不是一个值，我得到“空”。

班上：

```
public class NumberOperations {
   int number;
   String oddsUnder;
   String powersTwoUnder;
   int isGreater;
   String toString;

public NumberOperations(int numberIn) {
   number = numberIn;

}

public int getValue() {
   return number;
}

public String oddsUnder() {
   String output = "";
   int i = 0;
   while (i < number) {
      if (i % 2 != 0) {
         output += i + "\t";
      }
      i++;   
   }
   return output;
}

public String powersTwoUnder() {
   String output2 = "";
   int powers = 1;
   while (powers < number) {
   output2 += powers + "\t";
   powers = powers * 2;
   }
   return output2;
}

public int isGreater(int compareNumber) {
   if (number > compareNumber) {
      return 1;
   }
   else if (number < compareNumber) {
      return -1;
   }
   else {      
      return 0;
   }   
}

public String toString() {
   return number + "";
}

} 
```

该程序：

```
import java.util.Scanner; import java.util.ArrayList;

/**  * Demonstrates the NumberOperations class.  */ public class NumberOpsDriver {

   /**
    * Reads a set of positive numbers from the user until the user enters 0\.     * Prints odds under and powers of 2 under for each number.      *
    * @param args - Standard commandline arguments
    */    public static void main(String[] args) {

      Scanner in = new Scanner(System.in);

      // declare and instantiate ArrayList with generic type <NumberOperations>
      ArrayList<NumberOperations> numOpsList = new ArrayList<NumberOperations>();

      // prompt user for set of numbers
      System.out.println("Enter a list of positive integers separated "
                        + "with a space followed by 0:");

      // get first user input using in.nextInt()
      int firstInput = in.nextInt();
      // add a while loop as described below:
      while (firstInput != 0) {

         numOpsList.add(new NumberOperations(firstInput));

         firstInput = in.nextInt();
      }     

    // while the input is not "0"
         // add NumberOperations object to array based on user input
         // get the next user input using in.nextInt()

      int index = 0;
      while (index < numOpsList.size()) {
         NumberOperations num = numOpsList.get(index);
         System.out.println("For: " + num);
         System.out.println("Odds under: " + num.oddsUnder);
         System.out.println("Powers of 2 under: " + num.powersTwoUnder);

        // add print statement for odds under num
        // add print statement for powers of 2 under num

         index++;
      }    } } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:49:20.250

1.  您永远不会分配给您的成员变量`oddsUnder`和`powersTwoUnder`. 因此，当您阅读它们时，它们当然是空的，当您尝试打印它们时，~~您会遇到 NullPointerException~~，它会打印“null”。

2.  您可能实际上想要调用同名的方法而不是获取变量

    ```
     System.out.println("Odds under: " + num.oddsUnder());
         System.out.println("Powers of 2 under: " + num.powersTwoUnder()); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:49:11.470

使您的属性`private`避免这种情况，并更改您的属性`System.out...`以调用方法而不是对象字段。例如

```
System.out.println("Odds under: " + num.oddsUnder()); //<-changed 
```

# knockout.js - 淘汰赛 - 访问变量属性

> ID：14987544
> 
> 赞同：0
> 
> 时间：2013-02-20T18:43:07.217
> 
> 标签：knockout.js

我有一个看起来像这样的视图模型。

```
function ViewModel()
{
    this.Regions = ['Europe', 'AsiaPac', 'Americas'];

this.Sales = { 
    EuropeRevenue: 100, 
    EuropeProfit: 100, 
    AsiaPacRevenue: 200, 
    AsiaPacProfit: 100,
    AmericasRevenue: 300,
    AmericasProfit: 250
};
} 
```

我必须打印出每个地区，然后是他们的收入和利润。

我怎么做？遍历区域并为每个区域执行 Sales.[Region]Revenue 和 Sales.[Region]Profit。

```
 <div data-bind="foreach: Regions }">
        Region:<span data-bind="text: $data"></span>
        Revenue:<span data-bind="text: $root.Sales.$dataRevenue???"></span>
        Profit:<span data-bind="text: $root.Sales.$dataProfit???"></span>
    </div> 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:29:51.813

您的数据设置非常奇怪，因此如果您可以更改它，我建议您使用 RegionSales 集合对其进行建模...

```
this.RegionSalesData = 
        [ 
            { Name: 'Europe', Revenue: 100, Profit: 100},
            { Name: 'AsiaPac',Revenue: 200, Profit: 100},
            { Name: 'Americas', Revenue: 300, Profit: 250}]; 
```

然后你可以在绑定中使用`Name`, `Revenue`,`Profit`属性。

但是要回答您的实际问题：在 JavaScript 中，您可以使用`[]`语法按名称访问属性，因此您可以使用简单的字符串 concat 在绑定中生成属性名称：

```
<div data-bind="foreach: Regions ">
    <div>
        Region:<span data-bind="text: $data"></span>
        Revenue:<span data-bind="text: $root.Sales[$data+'Revenue']"></span>
        Profit:<span data-bind="text: $root.Sales[$data+'Profit']"></span>
    </div>
</div> 
```

演示[JSFiddle](http://jsfiddle.net/ytbBX/)。

# c# - 在 C# 中使用 json.NET 反序列化数组中的数组

> ID：14987549
> 
> 赞同：0
> 
> 时间：2013-02-20T18:43:22.543
> 
> 标签：c#, .net, json

我有一个以 json 格式提供的 REST API。json看起来像这样

```
[{"user":{"name":"foo","url":"bar"}}
  ,[{"product":{"name":"banana","price":"85"}},
  {"product":{"name":"peach","price":"66"}},
  {"product":{"name":"strawberry","price":"78"}}]] 
```

如何使用 json.NET 传输它？

我尝试了一些变种

```
public class Product
{
    [JsonProperty("Name")]
    public string name { get; set; }

    [JsonProperty("price")]
    public string Price { get; set; }
}

public class RootObject
{
    public Product product { get; set; }
} 
```

但它不适用于`Product p = JsonConvert.DeserializeObject<Product>(e.Result);`

如何声明这两个类？抱歉，但[http://json2csharp.com/](http://json2csharp.com/)不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:51:17.050

你想用 C# 从 JSON 创建一个模型

```
public class User
{
   public string name { get; set; }
   public string url { get; set; }
   public List<Product> product { get; set; }

}

 public class Product
 {
    public string name { get; set; }
    public Decimal price { get; set; }
 } 
```

# java - 可扩展列表视图中的按钮不可点击

> ID：14987553
> 
> 赞同：3
> 
> 时间：2013-02-20T18:43:33.227
> 
> 标签：java, android, expandablelistview

我有包含按钮的可扩展列表视图，当我单击按钮时，未触发单击事件，因为按钮焦点设置为 false。首先，我在 xml 布局中将按钮焦点设置为 false，然后根据现有帖子，我对其进行了更改，并将可焦点动态设置为 false。但是在这两种情况下的按钮是不可点击的。在将 onclickListener 设置为 getGroupView 方法中的按钮后，我尝试设置 focusable false ，但按钮仍然没有单击。任何帮助 Appriciated。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:47:14.010

如果按钮在组行中，那么 1\. 在您的 xml 文件中为按钮设置 Focusable true 2\. 在为按钮设置 onClickListener 后将 focusable 设置为 false 3\. 重要的是在您的 grouprow.xml 文件中尝试设置

```
android:descendantFocusability="blocksDescendants" 
```

对于视图组。这应该有效。

# episerver - 空指针异常 (FunctionTypeList.ascx) i Composer 模块插件，用于 EPiServer

> ID：14987562
> 
> 赞同：0
> 
> 时间：2013-02-20T18:44:06.147
> 
> 标签：episerver

我已经在部署在 IIS 7 的 EPiServer CMS 6 R2 站点上安装了 EPiServer 的 Composer 模块。我已经根据说明配置了 web.config。我可以在“作曲家编辑”模式下查看页面。

当我尝试以管理员模式（用于注册 Composer 块）访问 Composer-plugin 时，出现以下错误。

我该如何解决这个问题？：“/”应用程序中的服务器错误。你调用的对象是空的。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

```
Exception Details: System.NullReferenceException: Object reference not set to an instance of an object.

Source Error:

Line 60:                             <ItemTemplate>
Line 61:                                 <nobr>  
Line 62:                                    <asp:Label ID="Label1" runat="server" 
Line 63:                                         ToolTip ='<%#DataBinder.Eval(Container.DataItem, "Description")%>'
Line 64:                                         Text = '<%# Utils.TrimDescription(DataBinder.Eval(Container.DataItem, "Description").ToString(),20).ToHtmlEncoded()%>'/>         

Source File: c:\EPiServer\Sites\Skien\Dropit\Plugin\Extension\UI\Admin\Controls\FunctionTypeList.ascx    Line: 62

Stack Trace:

[NullReferenceException: Object reference not set to an instance of an object.]
   ASP.dropit_plugin_extension_ui_admin_controls_functiontypelist_ascx.__DataBinding__control19(Object sender, EventArgs e) in c:\EPiServer\Sites\Skien\Dropit\Plugin\Extension\UI\Admin\Controls\FunctionTypeList.ascx:62
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +303
   System.Web.UI.Control.DataBindChildren() +12659735
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +321
   System.Web.UI.Control.DataBindChildren() +12659735
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +321
   System.Web.UI.WebControls.GridView.CreateRow(Int32 rowIndex, Int32 dataSourceIndex, DataControlRowType rowType, DataControlRowState rowState, Boolean dataBind, Object dataItem, DataControlField[] fields, TableRowCollection rows, PagedDataSource pagedDataSource) +295
   System.Web.UI.WebControls.GridView.CreateChildControls(IEnumerable dataSource, Boolean dataBinding) +4780
   System.Web.UI.WebControls.CompositeDataBoundControl.PerformDataBinding(IEnumerable data) +95
   System.Web.UI.WebControls.GridView.PerformDataBinding(IEnumerable data) +19
   System.Web.UI.WebControls.DataBoundControl.OnDataSourceViewSelectCallback(IEnumerable data) +222
   System.Web.UI.WebControls.DataBoundControl.PerformSelect() +313
   System.Web.UI.Control.DataBindChildren() +12659735
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +321
   System.Web.UI.Control.DataBindChildren() +12659735
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +321
   System.Web.UI.Control.DataBindChildren() +12659735
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +321
   System.Web.UI.Control.DataBindChildren() +12659735
   System.Web.UI.Control.DataBind(Boolean raiseOnDataBinding) +321
   Dropit.Extension.UI.Admin.Controls.FunctionTypeList.DataBind() +646
   System.Web.UI.Control.LoadRecursive() +71
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Control.LoadRecursive() +190
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3178

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.17929 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:11:07.247

[Mari Jørgensen](http://world.episerver.com/Blogs/Mari-Jorgensen/Dates/2010/8/Composer-and-PageTypeBuilder---continued/)的这篇文章描述了 Composer 中其他一些控件的相同问题。

> 基本上，如果没有设置描述，EPiServer 将返回一个空字符串，而 PageTypeBuilder 返回 null。

`string.Empty`解决方案是修改Description为null时返回的代码行：

```
<%# Utils.TrimDescription(DataBinder.Eval(Container.DataItem, "Description") as string ?? String.Empty,20).ToHtmlEncoded()%>'/> 
```

# c++ - 在 Win32 应用程序中添加状态栏

> ID：14987563
> 
> 赞同：3
> 
> 时间：2013-02-20T18:44:16.173
> 
> 标签：c++, winapi, statusbar

我想在我的 Win32 应用程序中添加一个状态栏。我发现我可以使用`CreateStatusWindow`函数。在我重新调整窗口大小之前，我工作正常。查看我的代码块的一部分：

```
BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)
{
   HWND hWnd;

   hInst = hInstance; // Store instance handle in our global variable

   hWnd = CreateWindow(szWindowClass, szTitle, WS_OVERLAPPEDWINDOW, CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, NULL, NULL, hInstance, NULL);

   if (!hWnd)
   {
      return FALSE;
   }

   CreateStatusWindow(WS_CHILD | WS_VISIBLE, _T("Welcome to SpyWindows"), hWnd, 9000);

   ShowWindow(hWnd, nCmdShow);
   UpdateWindow(hWnd);

   return TRUE;
} 
```

这是我的应用程序主窗口的两个打印屏幕：

![在此处输入图像描述](../Images/1b3ed248fb7e9ba1ea30260494b1a7ca.png)

我该怎么做才能拥有一个好的状态栏？（我也想分更多的区域）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T18:50:03.120

[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/bb760728.aspx#Size_and_Height)提到状态栏将在收到 WM_SIZE 消息时重新计算其适当的位置和[大小](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632646.aspx)：

> 窗口过程在收到`WM_SIZE`消息时会自动调整状态栏的大小。通常，当父窗口的大小发生变化时，父窗口会向`WM_SIZE`状态栏发送消息。

`WM_SIZE`因此，实现这一点的最简单方法是将父级（使用[SendMessage()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644950.aspx)，来自其窗口过程）收到的消息中继到状态栏。消息参数无关紧要，因为状态栏不会在其计算中使用它们。

# facebook - 应用程序配置不允许给定 URL

> ID：14987566
> 
> 赞同：0
> 
> 时间：2013-02-20T18:44:29.747
> 
> 标签：facebook

我一直在使用我公司的域（安装了 ssl）测试我的应用程序，并且工作起来就像一个魅力。

现在，我希望这个应用程序拥有自己的域、服务器和 SSL 证书。我购买了 Godaddy SSL 证书（标准（Turbo）SSL）并要求我的主机安装它，他们做了并且似乎工作正常......

现在，当我将 Facebook 应用程序设置更改为我的新服务器时，它只是无法加载，并且控制台只输出*“应用程序配置不允许给定 URL。：应用程序的设置不允许一个或多个给定 URL . 它必须与网站 URL 或画布 URL 匹配，或者域必须是应用程序域之一的子域。”*

我完全不知道该怎么做......设置是这样的

我使用 facebook-actionscript-api 1.8.1 加载 FB

命名空间：myfbapp

应用程序域：myfbapp.com www.myfbapp.com

沙盒：禁用

画布网址： [http ://www.myfbapp.com](http://www.myfbapp.com)

安全 c url：[https ://www.myfbapp.com](https://www.myfbapp.com)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:21:29.673

需要为我的游戏获取专用 IP 并将 SSL 附加到它

# xml - xml.tag！在 Ruby on Rails 3 链接中

> ID：14987572
> 
> 赞同：1
> 
> 时间：2013-02-20T18:44:41.450
> 
> 标签：xml, ruby-on-rails-3, debugging, hyperlink, custom-tag

我正在尝试创建一个 xml.builder 文件，该文件将链接放入单元格中，然后我使用 javascript 库将其呈现到表格中。

基本上我想将以下项目作为链接。

```
xml.tag!("cell", person.name) 
```

像这样的东西。

```
xml.tag!("cell", person_path(@person)) 
```

虽然我知道这行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T05:33:13.520

使用[XmlMarkup](https://github.com/jimweirich/builder/blob/master/lib/builder/xmlmarkup.rb)类：

```
xml.a(person.name, 'href' => person_path(@person) ) 
```

使用`.tag`括号中的标签名称和花括号中的属性来创建自定义标签：

```
xml.tag!("cell"){xml.a(person.name, 'href' => person_path(@person) )} 
```

**参考**

*   [建造者宝石](http://rubygems.org/gems/builder)

# javascript - 在javascript中构建哈希表和完善的哈希函数

> ID：14987587
> 
> 赞同：0
> 
> 时间：2013-02-20T18:45:37.277
> 
> 标签：javascript, google-maps, hash, perfect-hash

我正在使用 Google Maps API 并觉得有更好的方法来搜索全景图像而不是大量`switch`声明。我认为使用外部哈希表会更有效且更易于维护。每个图像都有一个唯一的`panoID`，我可以定义它。阅读哈希表，我相信我说我可以制作一个表和完美的函数来在恒定时间内获取我需要的数据是正确的。有没有关于如何构建它的好资源？我根本没有散列经验。

我的逻辑是这样的：每个图像都保存在一个目录中`sometext_panoID.jpg`，其中`sometext`是一个字符串，`panoID`是我想要的任何东西。在上述 switch 语句中初始化数据时，所有的切换都是根据 panoID 完成的，并在那里访问其他元数据。例如：

```
switch(panoID) {
    case "test1":
      links.push({
        description : "TEST2",
        pano : "test2",
        heading : 70
      });
      break;
    case "test2":
      links.push({
        description : "TEST1",
        pano : "test1",
        heading : 125
      });
      links.push({
        description : "TEST3",
        pano : "test3",
        heading : 0
      });
      break;
      case "test3":
      links.push({
        description : "TEST2",
        pano : "test2",
        heading : 0
      });
      break;
  } 
```

因为我会知道所有的`panoID`s，并且一旦构建表就不需要排序、添加或以其他方式更改任何内容，我觉得有一种方法可以制作完美的哈希，但不知道从哪里开始。有小费吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:51:33.667

实际上，简单的普通对象及其属性在下面实现为哈希表。所以没有必要阅读散列算法，你可以让你的 JS 引擎完成这项工作：

```
var table = {
    "test1": [
      {
        description : "TEST2",
        pano : "test2",
        heading : 70
      }
    ],
    "test2": [
      {
        description : "TEST1",
        pano : "test1",
        heading : 125
      },
      {
        description : "TEST3",
        pano : "test3",
        heading : 0
      }
    ],
    "test3": [
      {
        description : "TEST2",
        pano : "test2",
        heading : 0
      }
    ]
};

var itemstobepushed = table[panoID];
[].push.apply(links, itemstobepushed); 
```

# ruby-on-rails - 第一个 Google Drive API files.list 请求返回一个哈希数组，之后，后续请求返回一个文件资源数组。为什么？

> ID：14987596
> 
> 赞同：2
> 
> 时间：2013-02-20T18:46:39.437
> 
> 标签：ruby-on-rails, ruby, google-api, google-drive-api, google-api-ruby-client

我正在查询 Google API 以使用 ruby​​ 的 Google API 官方 gem 列出驱动器中的所有文件。我正在使用 Google 开发者页面中给出的示例 - [https://developers.google.com/drive/v2/reference/files/list](https://developers.google.com/drive/v2/reference/files/list)

我提出的第一个请求在“项目”中返回一个红宝石“哈希”数组。下一个请求在“项目”中返回“Google::APIClient::Schema::Drive::V2::File”或“Google::APIClient::Schema::Drive::V2::ParentReference”数组（每种类型背后的原因也困扰着我）。

有谁知道为什么会这样？在“files.list”的参考页面上，没有提到改变结果的类型。

```
def self.retrieve_all_files(client)
  drive = client.discovered_api('drive', 'v2')
  result = Array.new
  page_token = nil
  begin
    parameters = {}
    if page_token.to_s != ''
      parameters['pageToken'] = page_token
    end
    api_result = client.execute(
        :api_method => drive.files.list,
        :parameters => parameters)
    if api_result.status == 200
      files = api_result.data
      result.concat(files.items)
      page_token = files.next_page_token
    else
      puts "An error occurred: #{result.data['error']['message']}"
      page_token = nil
    end
  end while page_token.to_s != ''
  result
end 
```

编辑：

我还不能解决这个问题，但我设法更好地理解它：

当第一次向 API 发出请求时，在用户授权后，“file.list”会返回 File 资源的“Items”属性的 Hashes 数组。每个 Hashes 就像一个 File 资源，具有 File 的所有属性，只是访问的类型不同。例如：文件的标题可以这样访问“File['title']”。

在发出第一个请求后，所有后续请求都会返回一个文件资源数组，可以像“File.title”这样访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T22:41:28.370

仅供参考，这是客户端库中的错误。使用最新版本应该可以解决它。

# c# - 如何更改 datetimepicker 值（当它是只读时）

> ID：14987601
> 
> 赞同：0
> 
> 时间：2013-02-20T18:47:20.947
> 
> 标签：c#, datetimepicker

我正在尝试在表单加载事件中更改我的表单中 datetimepicker 的默认值（我的意思是我不希望 datetimepicker 的值在我的应用程序启动时为“现在”。我希望它等于某个字符串值我的应用程序应该从注册表中读取。）所以我尝试了这个：

```
 datepicker.Value.Date = //some string value converted to datetime 
```

但它给我一个错误，即日期选择器是只读的并且无法分配。我可以使用 add 方法作为我最后的解决方案。但我希望有一个更好的方法。在此先感谢。最好的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:51:47.993

您可以设置值。然而，Value.Date 没有设置器。

```
private void Form1_Load(object sender, EventArgs e)
{
     // this works
     dateTimePicker1.Value = dateTimePicker1.MinDate;

     // this does not
     dateTimePicker1.Value.Date = // Value.Date has no setter
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:53:38.597

DateTimePicker.Value.Date 是只读的，而是使用

```
DateTimePicker.Value = SomeDateTime 
```

# php - 使用 doPost 方法将 e.parameter 传递给数组

> ID：14987602
> 
> 赞同：0
> 
> 时间：2013-02-20T18:47:22.317
> 
> 标签：php, javascript, variables, google-apps-script, dopostback

你可以通过 DoPost 方法传递参数吗？我正在尝试将 e.parmaters 传递给我的数组。作为回报，我看到的只是空括号，没有我想要推送的参数的值。

代码：

```
function doPost(e) {
    createProcess(e);
    createStep();
}

function createProcess(e) {
    var app = UiApp.getActiveApplication(); //get the current UI application
    process = [];
    var sheet = SpreadsheetApp.openById("0AuCblud0Ss7BdHA1bXZgmjYXA0liY0IyekhUQm5vWG02MVE").getActiveSheet(    ); //opens spreadsheet 
    var row = sheet.getLastRow(); //grabs current row
    process.push(createStep([e.parameter.DivHeadEmail,]));
    process.push(createStep([e.parameter.Director]));
    saveProcess(process,sheet,row);
}

function createStep(approvers) {
    var sheet = SpreadsheetApp.openById("0AuCblud0Ss7BdHA1bXZjYXhkhkA0Y0IyekhUQm5vWG02MVE").getActiveSheet();
    var row = sheet.getLastRow(); 
    var  step = new Object();
    step['numberOfApprovers'] = approvers.length;
    step['approvers'] = approvers.slice(1);
    step['status'] =  "approved" ;
    return step;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:54:51.607

[是的，您可以像使用 doGet(e)](https://stackoverflow.com/questions/14914955/how-to-call-google-apps-script-from-web-page/14915184#14915184)一样将参数传递给 doPost( e) 。

您可以通过在其中使用 this 来检查将哪些参数传递给您的 doPost(e) 方法。

```
var parameters = "";
for (var i in e.parameter) {
  parameters += "e.parameter."+i+" = "+e.parameter[i];
}
Logger.log(parameters); 
```

# javascript - 在这段代码中，变量实际上并没有改变，为什么？

> ID：14987603
> 
> 赞同：0
> 
> 时间：2013-02-20T18:47:23.223
> 
> 标签：javascript, jquery

我有变量 playerTurn ，它只是没有改变值，有人可以告诉我为什么吗？我尝试使用警报来查找代码出错的地方我已经以多种方式编写了代码为什么不会更新这个 var？除了这个变量之外，其他一切都在正常工作。

```
 <div class="square p1">1</div>
    <div class="square p1">2</div>
    <div class="square p1">3</div>
    <div class="square p1">4</div>
    <div class="square p1">5</div>
    <div class="square">6</div>
    <div class="square" style="background-color: #ff0000;">7</div>
    <div class="square">8</div>
    <div class="square p2">9</div>
    <div class="square p2">10</div>
    <div class="square p2">11</div>
    <div class="square p2">12</div>
    <div class="square p2">13</div>
    <div class="square p1">14</div>
    <div class="square p1">15</div>
    <div class="square p1">16</div>
    <div class="square p1">17</div>
    <div class="square p1" style="background-color: #8b4513;">18</div>
    <div class="square">19</div>
    <div class="square" style="background-color: #ff0000;">20</div>
    <div class="square">21</div>
    <div class="square p2">22</div>
    <div class="square p2" style="background-color: #8b4513;">23</div>
    <div class="square p2">24</div>
    <div class="square p2">25</div>
    <div class="square p2">26</div>
    <div class="square p1" style="background-color: #008000;">27</div>
    <div class="square p1" style="background-color: #008000;">28</div>
    <div class="square p1">29</div>
    <div class="square p1">30</div>
    <div class="square p1" style="background-color: #8b4513;">31</div>
    <div class="square">32</div>
    <div class="square" style="background-color: #ff0000;">33</div>
    <div class="square">34</div>
    <div class="square p2">35</div>
    <div class="square p2" style="background-color: #8b4513;">36</div>
    <div class="square p2">37</div>
    <div class="square p2" style="background-color: #008000;">38</div>
    <div class="square p2" style="background-color: #008000;">39</div>
    <div class="square p1" style="background-color: #008000;">40</div>
    <div class="square p1" style="background-color: #008000;">41</div>
    <div class="square p1">42</div>
    <div class="square p1">43</div>
    <div class="square p1">44</div>
    <div class="square">45</div>
    <div class="square" style="background-color: #8b4513;">46</div>
    <div class="square">47</div>
    <div class="square p2">48</div>
    <div class="square p2">49</div>
    <div class="square p2">50</div>
    <div class="square p2" style="background-color: #008000;">51</div>
    <div class="square p2" style="background-color: #008000;">52</div>
    <div class="square p1" style="background-color: #008000;">53</div>
    <div class="square p1" style="background-color: #008000;">54</div>
    <div class="square p1">55</div>
    <div class="square p1" style="background-color: #8b4513;">56</div>
    <div class="square p1">57</div>
    <div class="square">58</div>
    <div class="square" style="background-color: #ff0000;">59</div>
    <div class="square">60</div>
    <div class="square p2" style="background-color: #8b4513;">61</div>
    <div class="square p2">62</div>
    <div class="square p2">63</div>
    <div class="square p2" style="background-color: #008000;">64</div>
    <div class="square p2" style="background-color: #008000;">65</div>
    <div class="square p1">66</div>
    <div class="square p1">67</div>
    <div class="square p1">68</div>
    <div class="square p1" style="background-color: #8b4513;">69</div>
    <div class="square p1">70</div>
    <div class="square">71</div>
    <div class="square" style="background-color: #ff0000;">72</div>
    <div class="square">73</div>
    <div class="square p2" style="background-color: #8b4513;">74</div>
    <div class="square p2">75</div>
    <div class="square p2">76</div>
    <div class="square p2">77</div>
    <div class="square p2">78</div>
    <div class="square p1">79</div>
    <div class="square p1">80</div>
    <div class="square p1">81</div>
    <div class="square p1">82</div>
    <div class="square p1">83</div>
    <div class="square">84</div>
    <div class="square" style="background-color: #ff0000;">85</div>
    <div class="square">86</div>
    <div class="square p2">87</div>
    <div class="square p2">88</div>
    <div class="square p2">89</div>
    <div class="square p2">90</div>
    <div class="square p2">91</div>

    <script type="text/javascript">
        var p1Setup = 9;
        var p2Setup = 9;
        var playersTurn = "p1";
        function update() {
            if(playersTurn == "p1") {
                p1PlaceUnits();
            }
            if(playersTurn == "p2") {
                p2PlaceUnits();
            }
        }
        function p1PlaceUnits() {
            $(".p1").click(function() {
                if(p1Setup > 0) {
                    if(!$(this).hasClass('unitPlaced-p1')) {
                        $(this).addClass("unitPlaced-p1");
                        p1Setup--;
                        //alert("Player 2's turn.");
                        playersTurn = "p2";
                        update();
                    }
                }
            });
        }
        function p2PlaceUnits() {
            $(".p2").click(function() {
                if(p2Setup > 0) {
                    if(!$(this).hasClass('unitPlaced-p2')) {
                        $(this).addClass("unitPlaced-p2");
                        p2Setup--;
                        //alert("Player 1's turn.");
                        playersTurn = "p1";
                        update();
                    }
                }
            });
        }
    </script> 
```

如果您想检查代码[War Pit ，这里是该站点的链接](http://timothy.techbytbone.com/war_pit.php)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:51:47.830

代码只评估一次，所以当你测试变量时`playersTurn`，它总是第一次为真。当您单击`.p1`或`.p2`测试变量的代码`playersTurn`不会再次评估时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:45:19.397

我已将您的 JS 修改为超级高效！超过9000！！！！！！

```
var setup = {
    p1: 9,
    p2: 9
}
var playersTurn = "p1";

$('.square').click(function () {
    if (setup[playersTurn] > 0 && !$(this).hasClass('unitPlaced-' + playersTurn) && $(this).hasClass(playersTurn)) {
        $(this).addClass('unitPlaced-' + playersTurn);
        setup[playersTurn]--;
        (playersTurn == "p1") ? playersTurn = "p2" : playersTurn = "p1";
    }
}); 
```

在这里你可以在 jsfiddle 中看到它：http: [//jsfiddle.net/SXjSe/4/](http://jsfiddle.net/SXjSe/4/)

# javascript - 关于 underscore.js 中的函数是异步或同步的一些担忧

> ID：14987604
> 
> 赞同：6
> 
> 时间：2013-02-20T18:47:28.140
> 
> 标签：javascript, asynchronous, underscore.js

我一直在写这样的代码，它工作正常。

```
var result = _.filter(array, function(item){return item[key] === k;});
... // logic using the variable result 
```

但是今天我突然意识到技术上这可能是错误的，因为过滤器可以异步运行，并且过滤器行下方的代码中无法获得结果。

过滤功能是否以同步方式实现？还是我必须记住过滤器功能是异步运行的？

提前致谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-20T18:51:27.537

你可以看看[**源代码** *^([github])*](https://github.com/documentcloud/underscore/blob/1.4.4/underscore.js#L169)：

```
// Return all the elements that pass a truth test.
// Delegates to **ECMAScript 5**'s native `filter` if available.
// Aliased as `select`.
_.filter = _.select = function(obj, iterator, context) {
  var results = [];
  if (obj == null) return results;
  if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);
  each(obj, function(value, index, list) {
    if (iterator.call(context, value, index, list)) results[results.length] = value;
  });
  return results;
}; 
```

**长话短说：** `_.filter`是同步的并且期望回调函数也是同步的（`if (iterator.call(context, value, index, list))`）。

更重要的是，该函数委托给本机[`.filter` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)函数，该函数也是同步的。

* * *

并非每个接受回调的函数都必须是异步的！

# c# - 实体框架在查询之外生成谓词函数

> ID：14987611
> 
> 赞同：1
> 
> 时间：2013-02-20T18:47:53.443
> 
> 标签：c#, entity-framework

我正在使用与 DTO 分离的模型的 EF，并且由于我需要为许多类（`GetByPrimarykey`、等）实现相同的功能`GetBy`，`GetAll`我认为拥有抽象类会很好：

```
 protected List<T> GetBy(Func<T, bool> func)
        {
            return WorkingSet.Where(func).ToList();
        }
        protected T GetFirstBy(Func<T, bool> func)
        {
            return WorkingSet.FirstOrDefault(func);
        }
        public virtual T GetByPrimaryKey(K key)
        {
           return WorkingSet.FirstOrDefault(GetByKeyPredict(key));
        } 
```

然后在实现类中简单地实现预测函数：

```
protected override Func<MyType, bool> GetByKeyPredict(int key)
{
   return (c=> c.MyTypeId==key);
} 
```

问题是当我运行 SQL Server Profiler 时，我看到选择没有 where 原因。如果我覆盖该`GetByPrimaryKey`功能：

```
public override MyTypeGetByPrimaryKey(int key)
{
    return WorkingSet.FirstOrDefault(s => s.MyTypeId== key);
} 
```

查询很好，但是我真的需要预测才能工作，因为我们的`GetBy`功能被证明非常有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:20:23.647

您需要使用 Expression 才能获得 SQL 翻译。例如

```
protected List<T> GetBy(Expression<Func<T, bool>> func)
        {
            return WorkingSet.Where(func).ToList();
        }
        protected T GetFirstBy(Expression<Func<T, bool>> func)
        {
            return WorkingSet.FirstOrDefault(func);
        } 
```

您的目标是使用 IQueryable 中的方法，而不是 IEnumerable，因为 IQueryable 的方法被转换为 SQL。我希望这会有所帮助。

# asp.net - 取决于下拉列表的来源

> ID：14987612
> 
> 赞同：0
> 
> 时间：2013-02-20T18:48:02.547
> 
> 标签：asp.net, linq

我的页面中有一个下拉列表，其来源来自以下代码。现在我喜欢在我的下拉列表中调整 1 个文本框，当我输入时，下拉列表的来源（DocumentNo）取决于我在文本框中输入的内容，当文本框为空时，下拉列表显示所有(DocumentNo) ，请帮助我如何更改我的代码，

```
protected void ddlProjectDocument_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {

        var query = from p in _DataContext.tblDocuments
                    orderby p.DocumentNo
                    select p;
        int maxs = 0;
        foreach (tblDocument v in query)
        {
            if (v.DocumentNo.Length > maxs)
                maxs = v.DocumentNo.Length;
        }

        foreach (tblDocument vv in query)
        {
            string doctitle = vv.DocumentNo;
            for (int i = vv.DocumentNo.Length; i < maxs; i++)
            {
                doctitle += "&nbsp;";

            }
            doctitle += "&nbsp;|&nbsp;";
            doctitle += vv.TITLE;
            // Use HtmlDecode to correctly show the spaces
            doctitle = HttpUtility.HtmlDecode(doctitle);
            ddlProjectDocument.Items.Add(new ListItem(doctitle, vv.DocId.ToString()));

        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:49:45.070

首先，我强烈建议在方法开始时将该查询的结果存储到会话变量之类的东西中，这样您就不必每次点击此页面时都不断地查询数据库。

其次，您应该使用 ASP.NET 中的[OnTextChanged](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.textchanged.aspx)事件来解决此问题。放入 OnTextChanged 属性以指向后面代码中的一个方法，该方法将获取查询结果值（现在在您的会话变量中找到）并将包含的内容重置为`ddlProjectDocument.Items`与使用正在写入的内容匹配的任何内容`String.StartsWith()`：

```
var newListOfThings = queryResults.Where(q => q.DocumentNo.StartsWith(MyTextBox.Value)); 
```

此时，您需要做的就是执行与上述方法结束时相同的循环，以引入正确的格式。

# jquery - 显示/隐藏选择元素选项的功能（按值）

> ID：14987614
> 
> 赞同：0
> 
> 时间：2013-02-20T18:48:03.327
> 
> 标签：jquery, select, show-hide, option

我有一个包含几百个 Select 元素的表单，为了节省用户的时间，我预先选择了最常用的值。我想区分用户未单击元素的时间与他们主动选择了值的时间，因此希望在单击元素时切换默认选项的值。

例如，此选择元素的默认值是`value="50_Default"`并且将更改为`value="50"`

```
<select name=min_jeans class="default_field">
<option value=0>$0</option>
<option value="50_Default" selected=selected>$50</option>
<option value="50" style="display:none">$50</option>
<option value=100>$100</option>
<option value=150>$150</option>
<option value=200>$200</option>
</select> 
```

我想创建一个函数来按值显示/隐藏选项*（因为许多元素具有相同的默认值）*并且我需要它在主要浏览器中工作，但是选择选项似乎有点复杂，我'在使 jquery 的显示/隐藏方法适应这种情况时遇到问题。

**我试过的功能不起作用**

```
$(function () {
    $(".default_field").click(function(){
      $('select option[value="50_Default"]').hide()  
      $('select option[value="50"]').show()  
    }
    });
}); 
```

我发现了一个更复杂的函数可以做到这一点*（并且在 FF 和 IE 中工作）*，但我不知道如何修改代码以便我可以显示/隐藏一个选项的默认值和常规值，并且引用特定值，以便我可以对具有相同默认值的所有元素使用一个函数。此代码的工作小提琴在这里：http: [//jsfiddle.net/chayacooper/YVMzt/18/](http://jsfiddle.net/chayacooper/YVMzt/18/)

```
<p id="choosetype">
     <select name="category" id="category">
     <option value="">All Food</option>
     <option value="Food1">Fruit</option>
     <option value="Food2">Veggies</option>
     </select>
     <select name="fileType" id="fileType" size="1">
     <option value="Fruit1" class="sub-Food1">Apples</option>
     <option value="Fruit2" class="sub-Food1">Pears</option>
     <option value="Veg1" class="sub-Food2">Peas</option>
     <option value="Veg2" class="sub-Food2">Carrots</option>
     </select>
<span id="optionstore" style="display:none;"></span>
</p>
$(document).ready(function() {
    $('#category').on("change", function() {
    var cattype = $(this).val();
    optionswitch(cattype);
});
});
function optionswitch(myfilter) {
if ($('#optionstore').text() == "") {
    $('option[class^="sub-"]').each(function() {
        var optvalue = $(this).val();
        var optclass = $(this).prop('class');
        var opttext = $(this).text();
        optionlist = $('#optionstore').text() + "@%" + optvalue + "@%" + optclass + "@%" + opttext;
        $('#optionstore').text(optionlist);
    });
}
$('option[class^="sub-"]').remove();
populateoption = rewriteoption(myfilter);
$('#fileType').html(populateoption);
}

function rewriteoption(myfilter) {
var options = $('#optionstore').text().split('@%');
var resultgood = false;
var myfilterclass = "sub-" + myfilter;
var optionlisting = "";

myfilterclass = (myfilter != "")?myfilterclass:"all";
for (var i = 3; i < options.length; i = i + 3) {
    if (options[i - 1] == myfilterclass || myfilterclass == "all") {
        optionlisting = optionlisting + '<option value="' + options[i - 2] + '" class="sub-' + options[i - 1] + '">' + options[i] + '</option>';
        resultgood = true;
    }
}
if (resultgood) {
    return optionlisting;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:53:04.267

这似乎是重复的，请在[此处查看答案](https://stackoverflow.com/questions/1271503/hide-options-in-a-select-list-using-jquery)

您可能要添加的一件事是删除选定的属性。无论您对显示/隐藏做什么，这都会导致选择显示该值（即使选择的选项现在已隐藏）。

在您的代码中，我唯一看到的是您的 () 和 {} 不匹配。

这是您的代码的有效[jsfiddle](http://jsfiddle.net/VN2Su/4/) ...

```
$(".default_field option[value='50_Default']").removeAttr("selected");
$(".default_field").click(function(){
    $("select option[value='50_Default']").hide();
    $("select option[value='50']").show();
}); 
```

如果您有能力添加到 HTML 中，那么我会给事物类并使用它们作为选择器。这比尝试按值选择更容易。恕我直言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-14T18:47:49.667

我接受了@kasdega 关于使用类的建议，而不是试图隐藏/显示一对我用来`replace`操纵元素值的选项。

```
$('select').focus(function () {
    var option = $(this).find("option[value*=Default]");
    option.attr('value', option.attr('value').replace(/_Default/g, ''));
}); 
```

我在这里发布了一个工作示例：http: [//jsfiddle.net/chayacooper/JHAPp/6/](http://jsfiddle.net/chayacooper/JHAPp/6/)

# c# - 当控件设置为透明时，控件中的黑色背景

> ID：14987615
> 
> 赞同：2
> 
> 时间：2013-02-20T18:48:07.497
> 
> 标签：c#, winforms, user-controls, elementhost, backcolor

我遇到了 WPF elementHost 背景色的问题。我有一个在面板中加载 UserControl(Winform) 的 winform。在该用户控件中，我有两个面板，在每个面板中，有一个 elementHost 承载 WPF 用户控件。

图片可能更有帮助： ![在此处输入图像描述](../Images/8a17cdcd8c47fcdbdb18fea9d11ec60c.png)

如您所见，它们中的每一个的背景色都是黑色，而元素应显示如下：

![在此处输入图像描述](../Images/bb8c8ce8ebe4fec2af0ee14ca1cd1311.png)

我注意到当我在面板中加载其他用户控件时发生了这种情况。我需要知道如何解决这个问题。

每个 elementHost 都将其背景颜色设置为透明，并将背景颜色透明设置为 True。另外，我尝试在运行时更改背景颜色，但仍然是同样的问题。

**更新：** 好的，我注意到如果我在表单的加载事件中加载面板中的用户控件，则 elementHost 加载正确。但是，如果我在按钮单击事件中将 UserControl 加载到面板中，我会得到黑色背景色。

作品：

```
private void frm_Configuracion_Load(object sender, EventArgs e)
    {
        /*ABM.frm_ABM_Banco_Sucursal banco_sucursal = new ABM.frm_ABM_Banco_Sucursal();
        panel1.Controls.Add(banco_sucursal);*/
    } 
```

不要工作：

```
private void button3_Click(object sender, EventArgs e)
    {
        ABM.frm_ABM_Banco_Sucursal banco_sucursal = new ABM.frm_ABM_Banco_Sucursal();
        panel1.Controls.Add(banco_sucursal);
    } 
```

显然，仅当我使用一个 UserControl 时，使用 Load 事件才是解决方案，但我不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T02:46:53.057

好的，这就是我解决它的方法：

我将此代码放在每个 UserControl 的 Load() 事件中：

```
elementHost.BackColorTransparent = true; 
```

成为 elementHost 每个遇到麻烦的 elementHost 元素。

它很好奇，但该属性在设计时使用视觉设计器设置为 true，我认为在执行过程中可能会出现一些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-21T19:42:28.950

我遇到了同样的问题，当我单击按钮更新我的 UI 时，我的用户控件变黑。

在不包含属性**BackColorTransparent的 TableLayoutPanel 中找到了我的用户控件**

为了解决我的问题，我**刷新**了控件。代码片段如下所示：

```
foreach (Control subControls in this.MainTableLayoutPanel.Controls)
{
    foreach (Control control in subControls.Controls)
    {
        control.Refresh();
    }
} 
```

# spring - Spring security/hibernate：即使是正确的凭据也不正确？

> ID：14987616
> 
> 赞同：3
> 
> 时间：2013-02-20T18:48:07.027
> 
> 标签：spring, hibernate, spring-security, hql

嘿，我的基于 springsecurity 的登录有点乱

我不断收到错误“凭据错误”

这是我的用户表：

![用户表][1]

这是来自applicationContext的我的数据源：

```
<!-- database driver/location -->
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver" />
    <property name="url" value="jdbc:mysql://localhost:3306/ams" />
    <property name="username" value="root" />
    <property name="password" value="root" />
</bean> 
```

和我的securityContext：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:security="http://www.springframework.org/schema/security"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
              http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
              http://www.springframework.org/schema/security 
              http://www.springframework.org/schema/security/spring-security-3.0.xsd">

    <!-- <security:http auto-config="true" access-decision-manager-ref="accessDecisionManager"> -->
    <security:http auto-config="true">
        <security:intercept-url pattern="/login/login.do" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/login/doLogin.do" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/lib/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/css/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/images/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/resources/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/**" access="IS_AUTHENTICATED_REMEMBERED" />
        <security:form-login login-page="/login/login.do" authentication-failure-url="/login/login.do?login_error=true" default-target-url="/test/showTest.do"/>
        <security:logout logout-success-url="/login/login.do" invalidate-session="true" />
        <security:remember-me key="rememberMe"/>
    </security:http>    

    <security:authentication-manager>
        <security:authentication-provider>
            <security:jdbc-user-service data-source-ref="dataSource" 
            users-by-username-query="select USERNAME as username, PASSWORD as password, DELETED as deleted from ams.user where USERNAME=?"
            authorities-by-username-query="
                select distinct user.USERNAME as username, permission.NAME as authority 
            from scu.user, scu.user_role, scu.role, scu.role_permission, scu.permission
            where user.ID=user_role.USER_ID AND user_role.ROLE_ID=role_permission.ROLE_ID AND role_permission.PERMISSION_ID=permission.ID AND user.USERNAME=?"/>
            <!-- security:password-encoder ref="passwordEncoder" /> -->
        </security:authentication-provider>
    </security:authentication-manager>

    <bean id="passwordEncoder"
        class="org.springframework.security.authentication.encoding.ShaPasswordEncoder">
        <constructor-arg value="256" />
    </bean>
</beans> 
```

当我尝试登录时：admin 和 init01

它给了我错误的错误凭据... =（

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:36:12.967

您的`password-encoder`引用`authentication-provider`已被注释掉。如果您使用散列密码（应该如此），则需要密码编码器。还要检查[这个答案](https://stackoverflow.com/a/9300899/241990)，特别是关于编写测试以确保您使用的密码编码器与您存储在数据库中的密码编码器相匹配的第 2 点。

您可能还想查看有关使用 bcrypt作为普通 SHA 哈希的更安全替代方案的[答案。](https://stackoverflow.com/a/8528804/241990)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:53:09.180

您的密码正在被散列。如果您添加密码“init01”，实际上意味着原始密码的哈希是“init01”，因为 Spring 对提供的密码进行哈希处理并与您输入的密码匹配。所以 SHA('init01') 不是 'init01'

# html - 浏览器不缓存图像。如果它有不同的alt，它会再次请求相同的图像

> ID：14987619
> 
> 赞同：0
> 
> 时间：2013-02-20T18:48:26.887
> 
> 标签：html, browser, image, browser-cache

这是情况

在同一页面中，对于第一个综合浏览量：

```
<img src="default_image.jpg" alt="john">
<img src="default_image.jpg" alt="george">
.
.
.
.
<img src="default_image.jpg" alt="you-name-it"> 
```

使用 firebug，我看到 Firefox 多次请求 default_image.jpg。在这个例子中，一个对 alt="John" 的请求，一个对 alt="George" 的请求......然后列表继续。

我希望浏览器只需要对文件“default_image.jpg”发出一个请求，然后用它来显示带有该 src 的每个 img。

我的问题：

为什么会发生这种情况，我该如何预防。我的目标是能够在一个页面中多次使用具有不同 alt 值的相同 img src="..." 但浏览器只会请求一次。

没有 JS/JQUERY。我正在寻找普通的 html 解决方案（我希望它不是一些 rfc 限制）

ps 当我看到这些图像的不同加载时间时，我第一次注意到它。我期待所有相同的 src img 一次加载，但他们没有。它们之间的唯一区别是 alt 标签，所以这就是我要责备的地方。

# jquery - jQuery 分类自动完成给 ui.item 是未定义的

> ID：14987623
> 
> 赞同：0
> 
> 时间：2013-02-20T18:48:47.460
> 
> 标签：jquery, jquery-autocomplete

我想在我的 Rails 3.2 应用程序中进行分类自动完成搜索，用 jQuery 1.9.1 编写。我有以下代码：

```
jQuery.widget( "custom.catcomplete", jQuery.ui.autocomplete, {
        _renderItemData: function( ul, item ) {
            return jQuery( "<li></li>" )
                .data( "item.autocomplete", item )
                .append( "<a>" + item.label + "</a>" )
                    .appendTo( ul );
        },

        _renderMenu: function( ul, items ) {
            var that = this,
            currentCategory = "";
            jQuery.each( items, function( index, item ) {
                if (item.category != currentCategory) {
                    if (item.category != undefined) {
                        ul.append( "<li>" + item.category + "</li>" );
                        currentCategory = item.category;
          }
                }
                that._renderItemData( ul, item );
            });
        },

    });

  jQuery('.search-query').catcomplete({
    appendTo: '#search_query_wrapper',
    source: '/some_url',
        select: function( event, ul ) {
            console.log(ul);
            jQuery.get(ul.item.value);
    }
    }); 
```

它实际上正确地呈现了它的项目，但是当我单击其中任何一个时，我在 Firebug 中收到以下错误：

```
TypeError: ul.item is undefined 

jQuery.get(ul.item.value) 
```

怎么了？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:05:07.720

您提供的代码有效！只需使用`jQuery UI 1.9.2`脚本。

演示：http: [//jsfiddle.net/yTMwu/53/](http://jsfiddle.net/yTMwu/53/)

需要帮助请叫我！

# python - 使用 python 连接到 .onion 网络

> ID：14987625
> 
> 赞同：2
> 
> 时间：2013-02-20T18:48:46.760
> 
> 标签：python, proxy, tor

我想让 python 从控制台进入 .onion 站点，下面的示例可以在 python 中使用 tor 但是当我尝试连接到 .onion 站点时，它会给出诸如“名称或服务未知”之类的错误，我该如何解决这个问题？

示例代码：

```
import socket
import socks
import httplib

def connectTor():
    socks.setdefaultproxy(socks.PROXY_TYPE_SOCKS5,"127.0.0.1",9050,True)
    socket.socket = socks.socksocket
    print "Connected to tor"

def newIdentity():
    HOST = '127.0.0.1'
    socks.setdefaultproxy()
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((HOST,9051))
    s.send("AUTHENTICATE\r\n")
    response = s.recv(128)
    if response.startswith("250"):
        s.send("SIGNAL NEWNYM\r\n"),
    s.close()
    connectTor()

def readPage(page):
    conn = httplib.HTTPConnection(page)
    conn.request("GET","/")
    response = conn.getresponse()
    print (response.read())

def main():
    connectTor()
    print "Tor Ip Address :"
    readPage("my-ip.heroku.com")
    print "\n\n"
    readPage("od6j46sy5zg7aqze.onion")
    return 0

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:16:36.420

我认为这是你的问题，但我可能错了。

您依靠猴子补丁`socket.socket`来强制`HTTPConnection`使用您的 SOCKS5 代理与 TOR 对话。但是`HTTPConnection`调用`socket.create_connection`，它会在调用创建套接字`socket.getaddrinfo`之前调用解析名称。`socket.socket`并且`getaddrinfo`不使用`socket`. 所以，它没有打补丁，所以它没有和你的 SOCKS5 代理对话，所以它使用你的默认名称解析器。

这对于代理与普通 Internet 主机的连接非常有效，因为 TOR 将为“my-ip.heroku.com”返回与您的普通名称解析器相同的 DNS 结果。但它不适用于“od6j46sy5zg7aqze.onion”，因为您的普通名称解析器中没有 .onion TLD。

如果您好奇，可以查看 、 和 的源代码[`HTTPConnection.connect`](http://hg.python.org/cpython/file/2.7/Lib/httplib.py#l769)（[`socket.create_connection`](http://hg.python.org/cpython/file/2.7/Lib/socket.py#l537)C[`getaddrinfo`](http://hg.python.org/cpython/file/2.7/Modules/socketmodule.c)中的最后一个，根据您的平台分散在整个模块中）。

那么，你如何解决这个问题？好吧，看看两个被调用的 SOCKS5 模块`socks`，一个有一个可以直接用猴子补丁代替的功能`create_connection`（它的 API 并不相同，但它已经足够`HTTPConnection`满足需要了）；另一个没有，但你可以很容易地写一个（只需调用`socks.socksocket`然后调用它的`connect`方法）。或者你可以修改`HTTPConnection`创建一个`socket.socket`并调用它的`connect`方法。

最后，您可能想知道为什么大多数不同的`socks`模块都有一个`setdefaultproxy`函数，该函数带有一个名为的参数，该参数`remote_dns`专门声称它会导致远程执行 DNS 解析，而实际上这并不起作用。好吧，如果您使用 a ，它*确实*`socks.socksocket`有效，但如果您使用`socket.getaddrinfo`.

顺便说一句，如果您还没有阅读[DnsResolver](https://trac.torproject.org/projects/tor/wiki/doc/DnsResolver)和[TorifyHOWTO](https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO)，请在继续阅读之前阅读它们，因为只是试图将有效的代码拼凑在一起却不知道它为什么有效几乎肯定会导致您（或您的用户）在以下情况下泄露信息你以为你是匿名的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T15:29:20.093

您可以将端口 80 添加到洋葱地址以避免 DNS 查找。例如 readPage("od6j46sy5zg7aqze.onion:80")

使用 urllib2 您还需要指定协议（即 http），例如

导入 urllib2

打印 urllib2.urlopen(" [http://od6j46sy5zg7aqze.onion:80](http://od6j46sy5zg7aqze.onion:80) ").read()

# javascript - 隐藏div点击其他

> ID：14987628
> 
> 赞同：0
> 
> 时间：2013-02-20T18:48:57.517
> 
> 标签：javascript, jquery, html, css

我上面有四个按钮和四个 div。我想一次只有一个 div ，但一直显示四个按钮。

这是按钮的html

**HTML**

```
<div id="container">
<a><p id="firstBtn" class="mediabutton"><span class="icon"></span>button1</p></a> <!-- 1st button -->
<div id="firstDiv" class="mediaoptions" >
... <!-- stuff of the div -->
</div>

 <a><p id="sndBtn" class="mediabutton active"><span class="icon"></span>button2</p></a> <!-- 2st button -->
<div id="sndDiv" class="mediaoptions" >
... <!-- stuff of the div -->
</div> 
```

这就是我如何识别单击了哪个按钮

**Javascript**

```
$("container").click(function(event){
var that = event.target.id;
 if(((that == "firstBtn") || (that == "sndBtn") || (that == "trdBtn") || (that == "fourBtn") )
    &&  !($("#"+that).hasClass("active"))
)
{
    //Here comes the stuff
}
}); 
```

现在。该类`active`让按钮被突出显示。我只想要一个按钮突出显示。`sndDiv`设置上，`display : block`其他设置上`display: none`。

回顾一下：我想按下一个按钮，显示它上面的 div 并隐藏其他所有人。我真的尝试了很多东西，但我失败了。

对不起我的英语，干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:02:17.790

只需替换`Btn`为`Div`，你就有了你想要展示的元素，其他元素有一个共同的类并且很容易定位：

```
$("#container").on('click', '.mediabutton', function(event){
    var that = event.target.id,
        elem = $('#' + that.replace('Btn','Div'));

    if( !$("#"+that).hasClass("active") ) {
        $('.mediaoptions').not(elem).hide();
        elem.show()
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:03:35.023

以下应该工作。

```
$("container").click(function(event){
    var that = event.target.id;
    if(((that == "firstBtn") || (that == "sndBtn") || (that == "trdBtn") || (that == "fourBtn") ) &&  !($("#"+that).hasClass("active")))
    {
        $('.mediaoptions').show();
        $('#'+that.replace('Btn','Div')).show();
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T19:14:42.483

我不想只给你一个链接，但我创建了一个非常轻量级的 jQuery 脚本来处理你可能会发现有用的东西： http: [//cferdinandi.github.com/tabby/](http://cferdinandi.github.com/tabby/)。

您可能会发现重新利用它比尝试修改现有代码更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T18:57:44.673

jQuery .hide() 和 .show() 不能完成这项工作吗？

[http://api.jquery.com/hide/](http://api.jquery.com/hide/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T19:01:58.303

请参阅此示例：[JsFiddle](http://jsfiddle.net/b2Mjm/)。我对javascript和html做了一些更新；

```
$(".mediabutton").click(function(event){
 $(".mediabutton").removeClass("active");
 $(this).addClass("active");

 $(".mediaoptions").hide();
 $("#"+$(this).data("target-div")).show();
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-20T18:59:09.643

将下面的第二行添加到您的 javascript 中，然后查看警报内容：

```
var that = event.target.id;
alert(that); 
```

我不确定您到底要完成什么，例如：

```
<a href="#" onclick="$('.mediaoptions').hide(); $('#sndDiv').show(); return false;"><p id="sndBtn" class="mediabutton active"><span class="icon"></span>button2</p></a> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-20T19:12:13.117

这是工作的 jsFiddle：http: [//jsfiddle.net/CtqUU/](http://jsfiddle.net/CtqUU/)

有了这个，您可以拥有任意数量的`<div>`元素`<button>`。根据需要更改`class`名称`id`以适应您的需要。

HTML：

```
<div class="hidden" id="box1">Box 1</div>
<button value="box1">Box 1</button>
<div class="hidden" id="box2">Box 2</div>
<button value="box2">Box 2</button> 
```

CSS：

```
 div {
        width: 200px;
        height: 200px;
        border: 1px solid #000000;
    }
    .hidden {
        display: none;
        visibility: hidden;
    } 
```

JS：

```
 $("button").click(function(){
        var val = $(this).val();
        $("div").addClass("hidden");
        $("#"+val).removeClass("hidden");
    }); 
```

# cordova - PhoneGap 和 jQuery Mobile：脚本不加载

> ID：14987629
> 
> 赞同：0
> 
> 时间：2013-02-20T18:48:59.403
> 
> 标签：cordova, jquery-mobile

我在以下问题面前度过了我的一天。我试图让 PhoneGap 和 jQuery-mobile 运行。该应用程序启动，但是，如果我提交表单，他会再次加载同一个站点，忽略 form.js 中的所有内容（参见下面的 html 代码）。我有这个 html 代码：

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.2.0.min.css" />
    <script type="text/javascript" src="js/jQuery/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/jQuery/jquery-migrate-1.0.0.js"></script>
    <script type="text/javascript" src="cordova-2.4.0.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/form.js"></script>
    <script type="text/javascript" src="js/jQuery.mobile/jquery.mobile-1.2.0.min.js"></script>
    <title>SecureBook</title>
</head>
<body onload="app.initialize();">
    <div data-role="page">
        <div data-role="header">
            <h1>Welcome</h1>
        </div>
        <div data-role="content">
            <form id="userdata">
                <input type="text" id="username" placeholder="Username"  autofocus>
                <input type="password" id="password" placeholder="Passoword">
                <input type="submit" value="Anmelden" data-icon="forward" data-theme="b">
            </form>
        </div>
        <script>
            gotLoaded();
            console.log("in HTML");
        </script>
    </div>
</body> 
```

似乎他没有加载 form.js，因为他没有调用函数 gotLoaded() 也没有 console.logging 任何东西。form.js 看起来像这样：

```
function gotLoaded(){
console.log("loaded form");
};
$('#userdata').submit(function(event){
    console.log("transmitted form");
    event.preventDefault();
    var user = $('#username').val();
    var password = $('#password').val();
    $.mobile.changePage("sites/contacts.html",{
        transition: "none"
    });
}); 
```

然而，他确实从 js 文件夹中加载了所有其他脚本，但没有执行 form.js 中的任何内容。至少不是在我的 Android 手机上，在浏览器中，他向我展示了我记录的内容。我希望你能帮助我。非常感谢， Stiller_leser

PS刚刚看到他也没有记录（“传输形式”）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T21:57:50.740

为我工作，如下所示。不知道为什么。似乎在最后添加我的表单脚本可以确保加载所有 jQuery-Stuff。这是最终的代码。

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.2.0.min.css" />

    <script type="text/javascript" src="cordova-2.4.0.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/jQuery/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/jQuery/jquery-migrate-1.0.0.js"></script>  
    <script type="text/javascript" src="js/jQuery.mobile/jquery.mobile-1.2.0.min.js"></script>       
    <title>SecureBook</title>
</head>
<body onload="app.initialize();">
    <div data-role="page">
        <div data-role="header">
            <h1>Welcome</h1>
        </div>
        <div data-role="content">
            <form id="userdata" onsubmit="gotLoaded();">
                <input type="text" id="username" placeholder="Username"  autofocus>
                <input type="password" id="password" placeholder="Passoword">
                <input type="submit" value="Anmelden" data-icon="forward" data-theme="b">
            </form>
        </div>
        <script>
            //WORKS
            console.log("in HTML");
            //JQUERY works here
            console.log($('title').html());
        </script>
    </div>

<!-- Put customs scripts here as it seems, that jQuery loads to slow in the head and scripts already run -->
<script type="text/javascript" src="js/form.js"></script>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T20:36:38.170

[您可以尝试在页面显示处理程序（ http://jquerymobile.com/demos/1.0rc3/docs/api/events.html](http://jquerymobile.com/demos/1.0rc3/docs/api/events.html) ）中添加提交事件处理程序，但您还需要为您的页面提供一个 id。

```
<script>
    $('#pageID').live("pageshow", function() {
        $('#userdata').submit(function(event){
            console.log("transmitted form");
            event.preventDefault();
            var user = $('#username').val();
            var password = $('#password').val();
            $.mobile.changePage("sites/contacts.html",{
                transition: "none"
            });
        });
    })
 </script> 
```

# ruby-on-rails - Rails 和 Heroku PGError：where 参数的列不存在

> ID：14987634
> 
> 赞同：1
> 
> 时间：2013-02-20T18:49:04.247
> 
> 标签：ruby-on-rails, sqlite, postgresql, heroku, rails-activerecord

我四处搜索，发现了一些类似的搜索，但没有一个真正详细说明我遇到的问题，所以我想我会分享我的发现。

**问题**
将 Ruby on Rails 项目推送到 Heroku ( *DB = PostgresQL* ) 时，我遇到了一些在开发环境 ( *DB = SQLite* ) 中没有收到的错误。

**详细***信息*
我有一个模型，**例如**`Message`，与模型中的布尔列）。`owner``User``Customer`***`customer``User`***

 ***使用查询数据库时，`ActiveRecord`我在模型中有一个方法，该方法`Message`检索与某个关联的消息`User`（重要的是要注意，在 a 的多态关联中`owner`，在这种情况下，模型将`Message`添加两列，`owner_id`并且是或)`owner_type``owner_type``User``Customer`

该方法定义如下：

```
 def self.getMessagesForUser(user)
      message_ids = "SELECT owner_id FROM messages WHERE owner_id = :user_id AND owner_type = \"User\""
      where("message_id IN (#{message_ids})", user_id: user.id)
    end 
```

如您所见，message_ids 字符串被定义为可以轻松插入到`where`模型的方法中（提示：这就是问题所在）。

**我收到的错误**
，以下错误：

```
 ActionView::Template::Error (PGError: ERROR:  column "Customer" does not exist) 
```

我知道有些地方出了问题，因为这个论点被认为是一个专栏，所以我做了一些修改并找到了解决方案。

**解决方案**
我没有意识到在查询中使用单引号或双引号时，某些查询语言（如 SQL、PostgresQL 等）不像 SQLite 那样宽容。具体来说，PostgresQL 不支持查询中的双引号，即字符串中的`User`参数！我只是将方法中的行从：`owner_type``message_ids`

```
 message_ids = "SELECT owner_id FROM messages WHERE owner_id = :user_id AND owner_type = \"User\"" 
```

至：

```
 message_ids = "SELECT owner_id FROM messages WHERE owner_id = :user_id AND owner_type = \'User\'" 
```

更简单地说：

`"User" needed to be 'User'`

事情进展顺利。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:49:04.247

**解决方案**
我没有意识到在查询中使用单引号或双引号时，某些查询语言（如 SQL、PostgresQL 等）不像 SQLite 那样宽容。具体来说，PostgresQL 不支持查询中的双引号，即字符串中的`User`参数！我只是将方法中的行从：`owner_type``message_ids`

```
 message_ids = "SELECT owner_id FROM messages WHERE owner_id = :user_id AND owner_type = \"User\"" 
```

至：

```
 message_ids = "SELECT owner_id FROM messages WHERE owner_id = :user_id AND owner_type = \'User\'" 
```

更简单地说：

`"User" needed to be 'User'`

事情进展顺利。***

# php - PHP循环通过JSON

> ID：14987635
> 
> 赞同：-3
> 
> 时间：2013-02-20T18:49:08.477
> 
> 标签：php, json

对其中的另一个感到抱歉。

json 以这种格式返回：

```
{
   "data":{
      "internalName":"hotshotgg",
      "name":"HotshotGG",
      "acctId":434582,
      "profileIconId":531,
      "revisionDate":"\/Date(1357002079809)\/",
      "summonerLevel":30,
      "summonerId":407750
   },
   "success":true
} 
```

也可以在这里看到：http: [//elophant.com/developers/docs/summoner](http://elophant.com/developers/docs/summoner)

数据正确返回：

```
Array ( 
    [data] => Array ( 
        [internalName] => nemonorm 
        [name] => nemonorm 
        [acctId] => 28685607 
        [profileIconId] => 544 
        [revisionDate] => /Date(1361354064000)/ 
        [summonerLevel] => 30 
        [summonerId] => 24286314 
    ) 
    [success] => 1 
) 
```

我似乎无法循环并打印出我想要的信息：

```
$decode= json_decode($url, true);

foreach($decode['data'] as $key => $value) {
    echo  $value['name'] . " <br />";
} 
```

很确定这是显而易见的……但我看不到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:50:52.703

您必须首先获取 URL 的内容，例如使用 curl：

```
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$json = curl_exec($ch);

$decode = json_decode($json, true); 
```

然后最重要的是，您似乎在预测错误的数据结构。如果您想回显，`data.name`那么您只需访问它。如果您想回显所有数据，则需要循环。

```
// echo the name only:
echo $decode['data']['name'];

// echo all data
foreach($decode['data'] as $key => $value) {
   echo $key . ": " . $value . "<br />";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:59:51.910

你的数组不够深。你所拥有的是：

```
Array (
    [data] => Array (
        [internalName] => nemonorm
        ...
    ) [success] => 1
) 
```

当您遍历 $decoded['data'] 时，您得到的值是单个变量，而不是数组。我的意思是 $value 是一个字符串，而不是一个数组，所以 $value['name'] 是没有意义的。你需要的是这样的：

```
Array (
    [data] => Array (
        [0] => Array (
            [internalName] => nemonorm
            ...
        )
    ) [success] => 1
) 
```

然后，您将循环遍历结果数组，而不是单个结果的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T18:51:57.050

很难用我们掌握的信息来判断，但是 $url 是 URL 的内容，还是只是实际的 URL？您需要先获取内容，然后再对它们调用 json_decode。

就像是：

```
$json = file_get_contents($url);
$decoded = json_decode($json, true); 
```

尝试查看 cURL [http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)以了解获取 URL 内容的另一种方法。

# iphone - ios 6 - 在应用程序中发布到 Facebook 无法在设备上运行

> ID：14987641
> 
> 赞同：1
> 
> 时间：2013-02-20T18:49:31.270
> 
> 标签：iphone, ios, xcode, facebook, ios6

我有一个按钮可以调出 Facebook 用户界面来发帖，但它在设备上没有任何作用。它在模拟器中运行良好，但在手机上根本不执行任何操作。

不知道我能做些什么来找出问题所在 -

这是我的 ViewController.h

```
- (IBAction)postToFacebook:(id)sender; 
```

视图控制器.m

```
- (IBAction)postToFacebook:(id)sender {
    if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {
        SLComposeViewController *controller = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];
        [controller setInitialText:@"Posted from IOS App Test -- It works!"];
        [self presentViewController:controller animated:YES completion:Nil];
    }} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:53:09.237

您的代码正在模拟器上工作，因为 isAvailableForServiceType 在模拟器中总是返回 1。在设备中，您需要从设置中设置一个 facebook 帐户。

或者最好只是删除此检查

```
[SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook] 
```

连同发布表一起，将出现操作系统警报，通知需要设置帐户才能发布。

# emacs - 永久添加到 emacs 加载路径

> ID：14987643
> 
> 赞同：4
> 
> 时间：2013-02-20T18:49:39.757
> 
> 标签：emacs

我正在尝试将“~/”添加到 emacs 加载路径，因为无论出于何种原因它都不存在。我设法找到添加到 emacs 加载路径的命令：

```
(add-to-list 'load-path "~/") 
```

当我执行此命令时，加载路径变量包含它之前所做的所有内容，并且“~/”被添加到列表中。问题是当我退出 emacs 时，下次启动时“~/”已从列表中删除，更改不会持久。如何将某些内容永久添加到 emacs 加载路径变量？

添加到 .emacs 文件在这里不起作用，因为问题是 ~/ 目录中的 .emacs 文件没有被加载，所以修改 .emacs 文件不会解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-22T07:11:26.583

我想菲尔斯的评论中有错字。正确的方法应该是 Ch v user-init-file RET。也许你在其他地方自定义了这个变量而你忘记了。尝试将此变量的值更改回默认值。

# java - Java 奇数包（）行为

> ID：14987646
> 
> 赞同：3
> 
> 时间：2013-02-20T18:49:46.467
> 
> 标签：java, swing, resize, jframe

我的主要问题是设置 JFrame 时使用以下代码：

```
public Frame(){
  JPanel panel = new JPanel();
  add(panel);
  panel.setPreferredSize(new Dimension(200, 200));

  pack(); // This is the relevant code
  setResizable(false); // This is the relevant code

  setVisible(true);
} 
```

通过以下打印声明，我们收到了错误的面板尺寸：

```
System.out.println("Frame: " + this.getInsets());
System.out.println("Frame: " + this.getSize());
System.out.println("Panel: " + panel.getInsets());
System.out.println("Panel: " + panel.getSize());

Output:
Frame: java.awt.Insets[top=25,left=3,bottom=3,right=3]
Frame: java.awt.Dimension[width=216,height=238]
Panel: java.awt.Insets[top=0,left=0,bottom=0,right=0]
Panel: java.awt.Dimension[width=210,height=210] 
```

我发现将相关代码修改为以下可以解决问题：

```
public Frame(){
  JPanel panel = new JPanel();
  add(panel);
  panel.setPreferredSize(new Dimension(200, 200));

  setResizable(false); // Relevant code rearranged
  pack(); // Relevant code rearranged

  setVisible(true);
} 
```

这将为我们的面板生成正确的尺寸（使用与之前相同的打印语句）：

```
Frame: java.awt.Insets[top=25,left=3,bottom=3,right=3]
Frame: java.awt.Dimension[width=206,height=228]
Panel: java.awt.Insets[top=0,left=0,bottom=0,right=0]
Panel: java.awt.Dimension[width=200,height=200] 
```

我查看了一些文档，但找不到这 10 个像素的来源。有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:28:54.717

JFrame 派生自 Frame，在 Frame 的源代码中，`setResizable(...)`您会看到以下注释：

```
 // On some platforms, changing the resizable state affects
    // the insets of the Frame. If we could, we'd call invalidate()
    // from the peer, but we need to guarantee that we're not holding
    // the Frame lock when we call invalidate(). 
```

`pack()` *因此，在调用之后*调用是有意义的`setResizable(false)`。

# javascript - 访问全局变量时遇到问题

> ID：14987647
> 
> 赞同：0
> 
> 时间：2013-02-20T18:49:48.757
> 
> 标签：javascript, character-encoding, error-handling

这是我的代码：

```
function Todo(id, task, who, dueDate) {
    this.id = id;
    this.task = task;
    this.who = who;
    this.dueDate = dueDate;
    this.done = false;
}

var todos = new Array();

window.onload = init;

function init() {
    var submitButton = document.getElementById("submit");
    submitButton.onclick = getFormData;
    var searchButton = document.getElementById("button");
    searchButton.onclick = search;       
}

//function to add todo items to the todos array

function search() {
  for (var i = 0; i < todos.legnth; i++) {
     var todoObj = todos[i];
     console.log(todoObj[0]);
    }
} 
```

这不是我的所有代码，但最后一个函数是我遇到问题的地方。我似乎无法访问全局 todos 数组。我尝试将它作为参数传递给搜索函数。我什至尝试过 i < window.todos.length。我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T18:50:58.293

问题是你有一个错字。

代替

```
todos.legnth 
```

和

```
todos.length 
```

# symfony - Symfony2 表单避免在每次提交时写密码

> ID：14987651
> 
> 赞同：0
> 
> 时间：2013-02-20T18:49:57.767
> 
> 标签：symfony, symfony-forms

我刚刚创建了一个 symfony2 表单，其中我有一个重复的密码类型。整个表单有一个独特的保存提交按钮，所以现在用户被迫在每次提交时输入密码。

如何避免每次都输入密码？

# android - 我知道我有正确的 KeyHash 但仍然得到 remote_app_id 与存储的 id 不匹配

> ID：14987653
> 
> 赞同：2
> 
> 时间：2013-02-20T18:50:04.120
> 
> 标签：android, facebook, login

我确信我有正确的**Key Hash**，使用了 facebook 的建议代码从 logcat 获取它，我已经删除了我编写的登录代码并直接从**facebook** `sessionloginsampleactivity`复制/粘贴代码，以确保我没有犯任何编程错误，但我仍然得到：

> W/fb4a:fb:OrcaServiceQueue(504): com.facebook.orca.protocol.base.ApiException: remote_app_id 与存储的 id 不匹配

登录屏幕出现并询问您是否要允许此应用程序权限，但按下**OK**后没有任何变化，登录按钮仍然可见，而不是说注销。我知道代码可以工作，因为它可以在模拟设备上正常工作，因为我也知道调试密钥哈希。我阅读了有关此错误的 facebook 文档，但它不会消失！帮助！

# java - (Java) 从文本文件中读取

> ID：14987657
> 
> 赞同：0
> 
> 时间：2013-02-20T18:50:12.813
> 
> 标签：java, io

我正在尝试使用以下代码从文本文件中读取一系列变量：

```
public static Book readBook(String pathname) throws IOException, InputMismatchException {
        Scanner fl = new Scanner (new FileInputStream (fn));
        int num = fl.nextInt();
        double thePrice = 0;
        String theAuthor = null;
        String theTitle = null;
        for (int i=0; i<=num; i++) {
            theTitle = fl.nextLine();
            theAuthor = fl.nextLine();
            thePrice = fl.nextDouble();
        }
        System.out.print(num);
        System.out.print(theTitle);
        System.out.print(theAuthor);
        fl.close();
        return new Book(theTitle, theAuthor, thePrice);
       } 
```

File 包含一个用于 while 循环的数字，用于说明需要多少遍。文件如下所示：

```
2
name
author
10.00
name2
author2
12.00 
```

但这会引发输入不匹配错误，由于某种原因将第一行读取为“name2”，从而弄乱了顺序并在代码达到双精度时导致错误。任何帮助，将不胜感激！

堆栈跟踪：

```
Exception in thread "main" java.util.InputMismatchException
    at java.util.Scanner.throwFor(Unknown Source)
    at java.util.Scanner.next(Unknown Source)
    at java.util.Scanner.nextDouble(Unknown Source)
    at Model.readBook(Model.java:36) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:39:35.573

当您调用 fl.nextInt() 或 fl.nextDouble() 时，对 fl.nextLine() 的以下调用实际上不会读取“下一行”。相反，它只是完成读取包含 int 或 double 值的行上剩余的“字符”（或“行分隔符”）。因此，在这种特定情况下，您需要在 for 循环的开头添加一个额外的 fl.readLine()。

另外，你会想说“ `i<num`”而不是“ `i<=num`”，否则你会得到一个不同的错误。

本质上，使 for 循环的开始和第一行如下：

```
 for (int i=0; i<num; i++) {
    fl.nextLine();
.....
..... 
```

# c# - 调用按钮的单击事件的正确方法是什么？

> ID：14987662
> 
> 赞同：0
> 
> 时间：2013-02-20T18:50:34.477
> 
> 标签：c#, visual-studio, button, compact-framework, windows-ce

在这里： http: [//msdn.microsoft.com/en-us/library/hkkb40tf](http://msdn.microsoft.com/en-us/library/hkkb40tf(v=VS.90).aspx) (v=VS.90).aspx ，它说，要从另一个按钮调用按钮的单击事件，您可以/应该这样做方式：

```
button1.PerformClick(); 
```

但是，在我的情况下（VS 2003.NET 1.1），它不能编译（诚然，上面的链接指定了 VS 2008，但它没有指向先前版本的相关信息的链接，就像 msdn 经常做的那样）。

这编译：

```
private void btnPrint_Click(object sender, System.EventArgs args)
{
    if (this.recordChanged)
    {
        //btnSave.Click();
        btnSave_Click(sender, args);
    }
    . . . 
```

...但我不知道这是否是这样做的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:58:13.283

将您想要执行的业务逻辑放在一个单独的方法中（例如 DoSave()），然后您的事件处理程序都可以只调用该内部方法，而不是直接相互调用。

通过直接调用事件处理程序方法来“伪造”事件是丑陋的并且可能导致错误（将来修改事件处理程序的任何程序员可能都没有意识到它可以在与预期/记录不同的条件下被调用，这可能导致打印选项尝试执行保存操作时行为异常甚至崩溃）

此外，您很有可能希望将来从其他地方进行保存操作 - 因此将业务逻辑与激活它的使用界面分开始终是一个非常好的主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:55:37.520

我会的`btnSave.Click(sender, args);`。这是 MSDN 上的页面：http: [//msdn.microsoft.com/en-us/library/aa645739 (v=VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa645739(v=VS.71).aspx)

# vb.net - 如何计算列表中的字符串出现次数（字符串）

> ID：14987663
> 
> 赞同：3
> 
> 时间：2013-02-20T18:50:35.350
> 
> 标签：vb.net

我希望从列表中动态计算项目发生的次数。如果我指定我正在寻找的值，我可以在下面执行此操作，但我真正想做的是遍历我的列表，计算出现次数并将它们总计。我当前的代码如下：

```
Dim itemlist As New List(Of String)
itemlist.add("VALUE1")
itemlist.add("VALUE2")
itemlist.add("VALUE3")

    Dim count As Integer = 0

    For Each value In itemlist

        If value.Equals("VALUE1") Then count += 1

    Next

 Msgbox(count.tostring) 
```

所以我的观点不是搜索值，而是让应用程序将它们汇总并向用户显示计数的出现次数，类似于 excel 中的“COUNTIF”。如果不使用 LINQ，我找不到太多关于此的内容，谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T19:18:16.620

您可以使用 LINQ 轻松完成此操作：

```
Msgbox(itemlist.Where(Function(value) value = "VALUE1").Count) 
```

要计算重复项，再一次使用 LINQ 很容易：

```
Dim itemlist As New List(Of String)
itemlist.Add("RED")
itemlist.Add("RED")
itemlist.Add("RED")
itemlist.Add("GREEN")

dim groups = itemList.GroupBy(Function(value) value)

For Each grp In groups
    Console.WriteLine(grp(0) & " - " & grp.Count )
Next 
```

输出：

```
RED - 3
GREEN - 1 
```

# .net - IT HIT WEBDAV Word 文档以只读方式打开

> ID：14987664
> 
> 赞同：2
> 
> 时间：2013-02-20T18:50:37.793
> 
> 标签：.net, c#-4.0, webdav, ithit-webdav-server

我们正在开发的网站使用 IT HIT WebDAV 来管理文档。

第一次从[http://website.com/document.docx](http://website.com/document.docx)访问文档时，会弹出一个对话框，其中包含 OPEN/SAVE/SAVE AS 等选项。

我希望此文档在 MS-WORD 中打开，而不是要求保存。

如果从弹出对话框中选择了 OPEN 选项，文档将下载并在 Word 文档中以只读方式打开。当文档关闭并从同一 URL 再次访问时，它可以正常工作 [在本地系统 MS-WORD 应用程序中打开 DOC]

问题是它第一次下载并打开以及随后在 ms-word 应用程序中打开。当它在 ms-word 应用程序中打开时，该文档按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-02T19:48:46.420

```
var openDocumentsObject = new ActiveXObject("SharePoint.OpenDocuments.3");
openDocumentsObject.EditDocument(url); 
```

注意：url 代表 docx 的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T12:50:32.860

所以你点击网页并期望文件直接从 WebDAV 服务器在 MS Word 中打开？为此，您需要使用 Java 小程序，该小程序将运行 MS Word，并将 URL 传递给它以打开。但在 Windows 系统上，您可以在 IE 中使用 ActiveXObject“SharePoint.OpenDocuments”，在 FF/Chrome/Safari 浏览器中使用“application/x-sharepoint”插件。您可以在此处找到工作示例：http: [//ajaxbrowser.com/](http://ajaxbrowser.com/)（上下文菜单中的“编辑文档”）。

# perl - 如何在没有清单测试或 makefile 抱怨的情况下为 Perl 分发动态创建文件？

> ID：14987665
> 
> 赞同：2
> 
> 时间：2013-02-20T18:50:41.140
> 
> 标签：perl, manifest

我正在创建一个 Perl 5 模块分发版，其源代码托管在 github 上。我[在这个问题中遇到了与用户 Anirvan 相同的问题](https://stackoverflow.com/q/13188404/1317372)：我希望 github 看到一个`README.md`文件，但`.tar.gz`要包含与plain*相同*`README`的文件。在这种情况下，这个问题的答案“`README.pod`两者都使用”有效，但我想知道我是否可以让我最初的尝试奏效：

*   我只有`README.md`在存储库中，没有`README`.
*   我的`MANIFEST`包含`README`（因为它进入了 tarball），但不是`README.md`（因为它不是）。
*   我的`MANIFEST.SKIP`contains `README.md`，因为我不想在 tarball 中使用它。
*   我的`Makefile.PL`(*) 在将 复制到文件`PL_FILES`的短脚本下有一个条目`README.md``README`

这会生成`README`, 但在此过程中：

*   `t/manifest.t`没有清单中的`make`抱怨，但缺少`README`
*   `perl Makefile.PL`还抱怨`README`失踪

我是误解了`MANIFEST`文件的目的还是这个测试？是否可以以某种方式表示应该打包的文件，但还没有？我已经尝试更改测试，但我只能找到一种方法`Test::CheckManifest`来忽略存在但“不应该”的文件，而不是忽略不存在但“应该”的文件。

[(*) 是的，我正在使用`ExtUtils::MakeMaker`，因为这是`module-starter`默认设置，并且它到目前为止有效。不过，我不确定其他工具是否会发生很大变化。]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:51:16.410

（在这里回答我自己的问题）：，`ExtUtils::MakeMaker`其他`Module::Build`主要是**安装**方法。您应该忽略 what`make`以及`Build`其他人在构建发行版时抱怨的内容。`make disttest`抱怨才是最重要的。

就此而言，不要放置代码来帮助构建您的发行版`Makefile.PL`。您应该只在其中放置要在**安装**期间运行的代码。所以如果你想`README.md`成为`README`，你最好`README.md`也分配。这显然不是你想要的（*）。

相反，看看[Dist::Zilla](http://dzil.org/)。这显然是一个分发创建系统，而**不是**一个安装系统。

[(*) 回答你自己的问题会变得非常奇怪...... :-/]

# objective-c - 如何清除 NSTableView 的数据源

> ID：14987678
> 
> 赞同：1
> 
> 时间：2013-02-20T18:51:12.593
> 
> 标签：objective-c, xcode, nstableview, nsarraycontroller

我正在尝试制作一种方法来清除我的 NATableView 的数据源，但我无法弄清楚如何在任何地方执行此操作。

这是我用来将名为 final 的数组发送到我的表格视图的代码。

```
// I want to clear it here before filling it again.  
for (int i = 0; i < [final count]; i++) {
    [myArrayController addObject: [NSMutableDictionary dictionaryWithObjectsAndKeys:final[i], @"File Name", nil]];
} 
```

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:08:55.300

如果您使用的是`NSMutableArray`并且`myArrayController`是您想要调用的可变数组

```
[myArrayController removeAllObjects]; 
```

在你进入之前`for-loop`。

# javascript - Highcharts - 如何绘制置信区间

> ID：14987681
> 
> 赞同：2
> 
> 时间：2013-02-20T18:51:18.033
> 
> 标签：javascript, graph, highcharts, intervals

我想知道是否可以绘制如下图所示的置信区间：

[![在此处输入图像描述](../Images/a1861ef8c262ad8f42e829f6695267e6.png)](https://i.stack.imgur.com/zsh6J.png)
[（来源：[tonarchiv.ch](http://tonarchiv.ch/dl/stack/indication.png)）]

即每个样本的间隔和“中间”中的点或小线。

X 轴应该只是一个数字（评级数）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T06:57:00.037

**列范围**就是答案！见：http:  [//jsfiddle.net/dmN3N/18/](http://jsfiddle.net/dmN3N/18/)

```
 series: [{
        type: 'columnrange',
        data: [
              [-0.547571175, 0.401498266],
              [-0.960011899, 0.444655955],
               ...
              ]
    }, {
        type: 'scatter',
        data: [-0.073036455, -0.257677972,
                0.100955985, 0.106734365,
               -0.12219027, -0.060577832
              ]
    }] 
```

如果需要，可以使用其他（比高宽）列范围生成列两端的破折号（参见示例图片）...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-03-02T15:39:19.187

这是一个示例 rantanplan 建议在每个条形的顶部和底部使用 columnranges 的破折号：

[![Highcharts 中的置信区间](../Images/05848a21c12171e1c9a05352b33b4e53.png)](https://i.stack.imgur.com/Gn9Z7.png)

水平线是使用 15 像素宽和 2 像素高的“列”创建的，位于数据范围的两端。例如，以下是每个栏顶部的行：

```
type: 'columnrange',
pointWidth: 15,
minPointLength: 2,
data: [
    [0.40, 0.40],
    [0.30, 0.30]
] 
```

另一个系列在底部创建线条，第三个附加系列（散点图）在中间创建菱形标记。

[https://jsfiddle.net/ecjohbg1/4/](https://jsfiddle.net/ecjohbg1/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-21T10:41:41.207

您可以尝试使用 plotBands：[http ://api.highcharts.com/highcharts#xAxis.plotBands](http://api.highcharts.com/highcharts#xAxis.plotBands)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-30T18:50:24.497

现在有一个名为“errorbar”的系列类型非常适合这个用例。虽然其他解决方案将三个不同的区间系列粘合在一起，但误差线系列只用一个来完成。平均值仍然需要一个单独的系列。

这是一个示例 [https://www.highcharts.com/docs/chart-and-series-types/error-bar-series](https://www.highcharts.com/docs/chart-and-series-types/error-bar-series)

这是 API 参考[https://api.highcharts.com/highcharts/series.errorbar](https://api.highcharts.com/highcharts/series.errorbar)

# html - IE 和 Chrome 特定问题 - Firefox 可以正常显示导航

> ID：14987685
> 
> 赞同：0
> 
> 时间：2013-02-20T18:51:34.137
> 
> 标签：html, css

当我调整浏览器窗口的大小时，我从 IE 和 Chrome 中得到了一些意想不到的行为。导航菜单不会保持锁定在原位。

我知道问题与与徽标正确对齐的长文本有关。在这种情况下，“漫画订阅...”文本。当此文本的“C”到达最后一个导航菜单项的边缘时，即导航菜单下降。

IE 截图： [Internet Explorer http://www.jaylefler.com/ie.png](http://www.jaylefler.com/ie.png)

Chrome 截图： [Chrome http://www.jaylefler.com/chrome.png](http://www.jaylefler.com/chrome.png)

火狐截图： [火狐 http://www.jaylefler.com/firefox.png](http://www.jaylefler.com/firefox.png)

```
<!DOCTYPE html>
 <html>

 <head>
 <title>Demolition Comics Subscription Management System</title>

 <style>

body {
    font-family: Arial, Helvetica, Verdana;
    margin: 0;
    padding: 0;
    background-repeat:no-repeat;
    background-color:#FAF8CC;
}

 nav {
    width: 100%;
    height: 30px;
    background-color:rgb(255,200,0); 
    border-bottom:1px solid #000; 
    font-weight: bold;
}

nav ul{
    padding:0;
    margin: 0;
    min-width: 755px;
    overflow: hidden;
}

nav ul li{
    float: left;
    margin:0;
    padding:0;
    list-style:none;
    background-color:rgb(255,200,0);
    border-right:1px solid #000;
}

nav ul li a{
    text-align:center;
    text-decoration:none;
    width:150px;
    height: 25px;
    padding-top: 5px;
    display:block;
    color:#000;
}

nav ul li ul{
    position:absolute;
    visibility:hidden;
    min-width: 150px;
    border-bottom: 1px solid #000;
    border-left: 1px solid #000;
    margin-left: -1px;  
}

 nav ul li:hover ul{
    visibility: visible;
}

nav ul li ul li {
    float: none;
    width:200px;
    border-bottom: 1px solid #000;
    border-top: 1px solid #000;
}

nav ul li ul li a {
    text-align:center;
    width:200px;
}

nav a:hover {
    background-color:#000;
    color:rgb(255,200,0);
}

#logo {
    background-color: black;
    width: 100%;
    min-width: 800px;
    color: rgb(255,200,0);
    height: 100px;
    margin:0px;
}

#logo img {
    padding: 10px;
    vertical-align: middle;
}

.left_part, .right_part {
    height: 100px;
}

.left_part {
    float: left;
}

.right_part {
    float:right;
    width:500px;
    margin-top: 10px;
    text-align: right;
}

.right_part a {
    line-height: 10x;
    color: rgb(255,200,0);
    vertical-align:middle;
    text-align:right;
    text-decoration:none;
    padding: 25px;
}

#contents, #footer {
    background:#fff;
    width:1024px;
    padding:20px;
    padding-top:5px;
}

#contents {
    margin:15px auto 0;
    border: 5px solid black;
    border-bottom: 0;
    border-radius: 15px 15px 0 0;
    /*box-shadow: 6px 6px 4px 4px #000;*/
    box-shadow: 10px 15px 5px #888888;
    min-height: 550px;
    background-color:#F0F7FF;
}

#footer {
    background-color: rgb(255,200,0);
    border-radius: 0 0 15px 15px;
    /*box-shadow: 6px 6px 4px 4px #000;*/
    box-shadow: 10px 10px 5px #888888;
    border: 5px solid black;
    border-top:1px dashed #000;
    color:#000;
    margin:0 auto 40px;
}

.bigHead {
    font-size: 2em;
    margin-top: 0px;
    margin-bottom: 10px;
    margin-right: 22px;
}

.littleNavi {
    font-size: 1em;
}

</style>

</head>

<body>

<div id="logo">

    <div class="left_part">
        <img src="demo.gif">
    </div>

   <div class="right_part"> 
        <div class="bigHead">Comic Subscription Management</div>
        <div class="littleNavi"><a href="index.php">CONTACT US</a> - <a href="#">FAQ</a> - <a href="index.php">ABOUT</a></div>
    </div>

</div>

<nav>
    <ul>

        <li><a href="index.php">HOME</a></li>
        <li><a href="index.php">PROFILE</a></li>
        <li><a href="#">MANAGE SUB</a>
            <ul>
                <li><a href="index.php">VIEW TITLES</a></li>
                <li><a href="index.php">ADD TITLE</a></li>
                <li><a href="index.php">MODIFY TITLE</a></li>
                <li><a href="index.php">REMOVE TITLE</a></li>
            </ul>
        </li>
        <li><a href="index.php">NEW RELEASES</a></li>
        <li><a href="index.php">E-MAIL</a></li>
    </ul>
</nav>

<div id="contents">

    <h2>Hello ladies and gentlemen!</h2>
</div>

<div id="footer">
    Text here
</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:15:56.430

添加`position: absolute;`到`nav`和`margin:45px auto;`到`#contents`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:01:00.533

问题似乎`<nav>`是没有清除浮动列表项。

添加`overflow:hidden;`到您的`<nav>`元素，问题应该得到解决。`overflow:hidden;`将强制容器扩展至其浮动子项的高度。

# r - 取矩阵 r 中各行的平均值

> ID：14987686
> 
> 赞同：3
> 
> 时间：2013-02-20T18:51:35.350
> 
> 标签：r, matrix, row, mean

我有以下深度和温度数据矩阵（855 行，2 列），并且想取每列中每 3 行的平均值。例如：

```
 [1,]  -6.7 18.91
 [2,]  -5.4 18.91
 [3,]  -4.0 18.59
 [4,]  -6.7 20.37
 [5,]  -6.7 20.05
 [6,]  -2.7 20.21
 [7,]  -4.0 21.03
 [8,]  -5.4 20.70
 [9,]  -4.0 20.87
[10,]  -2.7 21.37
[11,]  -2.7 21.37
[12,]  -2.7 21.37

mean(data[1:3,1])
mean(data[4:6,1]) 
```

对于整个矩阵。如果不为每 3 行的平均值手动编写代码，我怎样才能做到这一点？非常感谢任何想法或建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T18:53:23.530

使用`rollapply`zoo 包中的功能。有关`?rollapply`更多详细信息，请参阅。

```
library(zoo)
rollapply(matrix[,1], width=3, mean, by=3) 
```

例子：

```
> set.seed(1)
> Data <- matrix(rnorm(30, 100, 50), ncol=2)  # some random data
> rollapply(Data[,1], width=3, mean, by=3)  
[1]  78.69268 118.40534 130.02559 126.60393  71.48317
> # you could check this out by doing some verification as in:
> mean(Data[1:3, 1])
[1] 78.69268
> mean(Data[4:6, 1])
[1] 118.4053
> mean(Data[7:9, 1]) # and so on ...
[1] 130.0256 
```

如果您想要矩阵中所有列的平均值，则只需添加`by.column=TRUE`调用`rollapply`：

```
> rollapply(Data, width=3, mean, by=3, by.colum=TRUE)
          [,1]      [,2]
[1,]  78.69268 114.71187
[2,] 118.40534 138.90166
[3,] 130.02559  81.12249
[4,] 126.60393 106.79836
[5,]  71.48317  74.48399 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T18:56:29.220

尝试使用`tapply`和`apply`：

```
R > f <- rep(c(1:3), each = 3)
R > f
[1] 1 1 1 2 2 2 3 3 3
R > x <- matrix(1:27, 9, 3)
R > x
      [,1] [,2] [,3]
 [1,]    1   10   19
 [2,]    2   11   20
 [3,]    3   12   21
 [4,]    4   13   22
 [5,]    5   14   23
 [6,]    6   15   24
 [7,]    7   16   25
 [8,]    8   17   26
 [9,]    9   18   27
R > apply(x, 2, function(t) tapply(t, f, mean))
  [,1] [,2] [,3]
1    2   11   20
2    5   14   23
3    8   17   26 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T19:20:41.407

我真的很喜欢 'rollapply' 函数，因为它的语法与你想要做的非常匹配。但是，我想我会为后代贡献你将如何使用“plyr”包解决这个问题。

*注意：您可以在一个语句中完成所有这些，但我已将其分解以使其更易于理解。*

**第 1 步**：设置您的数据以具有排序变量。

```
data.plyr <- data.frame(test, group=floor((1:nrow(test)-1)/3)+1) 
```

我刚刚添加了一个“组”列，它为每三列分配一个组号。默认情况下，两个矩阵列现在是“X1”和“X2”。

**第 2 步**：为每个组运行“colMeans”函数。

```
library(plyr)
ddply(data.plyr, .(group), colMeans) 
```

对于这个特定的问题，我认为“plyr”包是次优的，但值得注意的是该方法以供将来参考。'apply' 系列和 'rollapply' 函数在数据的连续性和一致性方面效果最佳。在您需要更多灵活性的应用程序中，“plyr”系列函数在您的工具箱中很有用。

# jquery - 当元素“B”具有 cetain 类时，将 CSS 类应用于元素“A”

> ID：14987687
> 
> 赞同：0
> 
> 时间：2013-02-20T18:51:42.350
> 
> 标签：jquery, css

我在一个页面上有两个完全独立的 DIV 元素。仅当 div B 具有“标记”类时，我才希望 div A 具有“红色”类。Div B 是一个启用 AJAX 的“标记”按钮。基本上，我希望 div A 在其中一个 Div B 项目被单击/标记时变为红色。

当单击/标记时，我已经在 div B 上更改了类，所以现在我只需要代码（jquery？），当该 div B 项已被标记并因此具有类“标记”与它相关联。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T18:57:27.100

这是一个应该做你想做的事的 jQuery 例子。此示例假设您有一个`<div id="divA">`and `<div id="divB">`。

```
$(document).ready(function() {
    $('#divB').click(function() {
        $('#divA').addClass('myRedClass');
    });
}); 
```

第一行确保在执行 jQuery 之前加载的文档。第二行以#divB 的“点击”事件为目标。第三行实际上将类添加到#divA。所以 - 当点击#divB 时，将类添加到#divA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T18:57:30.790

您可以使用[.toggleClass()](http://api.jquery.com/toggleClass/)并传入一个条件。既然你没有发布你的代码，我只是把它变得很笼统

```
$('div.b').click(function(){ // <-- your click function 
   // changing of your div.b class
   $('div.a').toggleClass('red',$(this).hasClass('flagged');
   // now if div.b has class flagged - div.a will have class red also.. and vice/versa
}); 
```

# jpa - JPA 创建或扩展表

> ID：14987688
> 
> 赞同：1
> 
> 时间：2013-02-20T18:51:42.953
> 
> 标签：jpa, eclipselink, persistence.xml

DDL 生成“创建或扩展表”适用于 EclipseLink2.4。当我执行 JPA Tools-> Generate tables from entity 时，会创建一个额外的列。但是为什么在应用程序部署期间不会自动发生这种表的更改？仅当我手动使用 JPA 工具时才会发生。此外，文件中显示“无法解析列 XXX”的错误。有人可以解释在后台发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T05:55:56.107

我有一个类似的问题，你可以在这里看到答案以及一些讨论。

[EclipseLink“创建或扩展表”不起作用：“......未知列......”](https://stackoverflow.com/questions/13372213/eclipselink-create-or-extend-tables-not-working-unknown-column)

# linux - xmlstarlet - 连接多行值

> ID：14987691
> 
> 赞同：1
> 
> 时间：2013-02-20T06:10:51.703
> 
> 标签：linux, xml

拥有 xmlstarlet 1.3.1。

给定文件.xml：

```
<entry>
  <message>Line 1
  Line 2 and so on
  </message>
</entry> 
```

如何选择*消息*并在一行中显示其值，而新行替换为“@”如下：

```
Line 1@Line 2 and so on 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T08:59:34.880

`xmlstarlet sel -t -v "/entry/message" file.xml | tr -s "\n" "@"`

请注意，在您的示例中*，等等之后还有一个额外的换行符。*

# angularjs - Testacular 找不到网络应用程序

> ID：14987700
> 
> 赞同：2
> 
> 时间：2013-02-20T18:51:55.457
> 
> 标签：angularjs, xampp, karma-runner

我尝试在本地 Mac 上运行我的 e2e 测试。Testacular 找到所有测试并运行它们。他们都失败了，因为 testacular 没有使用正确的 URL。我所有的 browser().navigateTo() 都进入了必杀技，而不是正确的页面。它的接缝就像代理属性不起作用。目前我的配置如下所示：

```
basePath = '';

files = [
  ANGULAR_SCENARIO,
  ANGULAR_SCENARIO_ADAPTER,
  './e2e/*.js'
];

browsers = ['Safari'];

urlRoot = '/__testacular/';

proxies = {
    '/': 'http://localhost:80/test/index.html#/'
};

autoWatch = true;
singleRun = false; 
```

我很感激各种提示！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T09:27:23.757

它对我有用的方式（适应您的配置）是：

```
basePath = '..';

files = [
  ANGULAR_SCENARIO,
  ANGULAR_SCENARIO_ADAPTER,
  './test/e2e/*.js'
];

urlRoot = '/__testacular/';

proxies = {
    '/': 'http://localhost/'
}; 
```

# visual-studio-2010 - 如何获取存储过程标量输出并将其添加到管道中的每一行？

> ID：14987703
> 
> 赞同：0
> 
> 时间：2013-02-20T18:52:03.677
> 
> 标签：visual-studio-2010, ssis, sql-server-2012

我正在开发一个 SSIS 包，以将数据从 ERP 系统 ( *Microsoft Dynamics AX* ) 传输到自定义 CRM 解决方案。我需要转移/更新的一件事是客户。在CRM系统中，有一个叫做CustomerID的字段是CRM环境独有的，数据从ERP系统传输到CRM系统时必须设置。

问题是我必须调用一个存储过程来获取下一个要插入的客户的 CustomerID。如何在 SSIS 中执行此操作？我目前正在使用数据流来传输数据，我唯一能看到调用存储过程的地方是从 ADO NET 源任务中作为 SQL 命令查询，每次调用该过程时，它都会增加 ID，所以每次运行 SSIS 包时，它会更新 CRM 数据库中所有客户的 CustomerID 字段。

存储过程驻留在自定义 CRM 应用程序上。存储过程不接受任何输入参数。每次调用它时，它都会简单地输出一个标量值，如`CT000001`,等。`CT000002`

我还有哪些其他选择可以正确执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:41:02.273

您需要使用脚本组件为每一行调用存储过程，并将值添加到下游到目标的管道中。

### 说明示例的示例 SSIS 2012 包：

该示例使用以下数据库对象。

*   SQL Server 2012 数据库名为 PracticeDB。在这种情况下，CRM 和 ERP 表都在同一个数据库中以保持简单。

*   表*`dbo.CRM`*将包含目标 CRM 数据。

*   表*`dbo.ERP`*包含源 ERP 数据

*   表*`dbo.CustomerId`*是 CRM 系统中的一个假设表，将用于增加客户编号。

*   *`dbo.GetCustomerId`*每当调用存储过程时，都会增加客户编号。

### 创建上述数据库对象的脚本：

下面的脚本将创建上述对象并将一些行插入到源 ERP 表中。

```
USE PracticeDB;
GO

CREATE TABLE dbo.CRM(
    CRMId int IDENTITY(1,1) NOT NULL,
    CustomerId int NOT NULL,
    CustomerName varchar(50) NULL
);
GO

CREATE TABLE dbo.ERP(
    ERPId int IDENTITY(1,1) NOT NULL,
    CustomerName varchar(50) NOT NULL
);
GO

CREATE TABLE dbo.CustomerId(
    Id int NOT NULL
);
GO

CREATE PROCEDURE dbo.GetCustomerId 
AS
BEGIN
    SET NOCOUNT ON;

    IF NOT EXISTS(SELECT Id FROM dbo.CustomerId)
        INSERT INTO dbo.CustomerId (Id) VALUES(1);
    ELSE
        INSERT INTO dbo.CustomerId (Id)
            SELECT MAX(Id) + 1 FROM dbo.CustomerId;

    SELECT MAX(Id) AS CustomerId FROM dbo.CustomerId;   
END;
GO

INSERT INTO dbo.ERP (CustomerName) VALUES
        ('John Doe')
    ,   ('Jane Doe')
    ,   ('Stephen Smith')
    ,   ('Dean Jones')
    ;
GO 
```

*   创建一个 SSIS 包并创建一个 ADO.NET 连接管理器以连接到适当的数据源。

*   将数据流任务拖放到控制流选项卡上

*   在数据流任务中，拖放组件`ADO.NET Source`和`Script Component (Transformation)`ADO.NET 目标。

*   *ADO.NET Source*将从表*dbo.ERP中读取数据*

*   *ADO.NET Destination*将数据插入表*dbo.CRM*

脚本组件将涉及以下配置。

*   双击脚本组件以打开脚本组件编辑器。

*   点击`Connection Managers`标签页

*   选择 ADO.NET 连接管理器`ADONET_PracticeDB`并将其命名为**`PracticeDB`**. 此连接管理器将在脚本组件代码中使用。

![连接管理器](../Images/a511f8b63c1906fd5e6fab51653807e3.png)

*   点击`Inputs and Outputs`标签页

*   将*输入***`ERP`**和*输出*重命名为**`CRM`**

*   展开 CRM，选择输出列并单击*`Add Column`*。

*   将列名称重命名为 CustomerID。该示例使用整数类型的列。您需要根据需要更改数据类型。

*   点击`Script`标签页。

![脚本组件](../Images/e5ff5f4197936c9044e3491e1670aaad.png)

*   在脚本标签页，单击`Edit Script...`。

*   键入以下脚本组件部分中显示的代码。该脚本使用包上可用的 ADO.NET 连接管理器启动连接，然后启动*`PreExecute`*方法内的命令对象。

*   然后在*`ERP_ProcessInputRow`*方法中为管道中的每一行调用存储过程以生成新的客户 ID。

### C# 中的脚本组件代码

```
#region Namespaces
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;
using System.Data.OleDb;
using System.Data.SqlClient;
#endregion

[Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
public class ScriptMain : UserComponent
{
    IDTSConnectionManager100 manager;
    SqlConnection connection = null;
    SqlCommand command = null;

    public override void PreExecute()
    {
        manager = base.Connections.PracticeDB;

        connection = new SqlConnection();
        connection = (SqlConnection)manager.AcquireConnection(null);

        command = new SqlCommand();
        command.Connection = connection;
        command.CommandType = CommandType.StoredProcedure;
        command.CommandText = "dbo.GetCustomerId";

        base.PreExecute();
    }

    public override void PostExecute()
    {
        base.PostExecute();
    }

    public override void ERP_ProcessInputRow(ERPBuffer Row)
    {
        Row.CustomerID = Convert.ToInt32(command.ExecuteScalar());
    }
} 
```

![使用 C# 的脚本组件](../Images/fb92231835d2791b84b3bc00a2fd9e29.png)

*   关闭脚本组件

*   在执行包之前对数据执行以下查询以检查行。

### 表选择查询：

```
SELECT * FROM dbo.ERP;
SELECT * FROM dbo.CRM;
SELECT * FROM dbo.CustomerId; 
```

![执行前](../Images/396c09b01d0d6e5ed93251f2d0ed4b01.png)

首次执行包后，您会注意到已插入 4 行，并且成功调用了存储过程以添加客户 ID。

![执行 1](../Images/161d202cb32fd3b13f36aa675477ccfc.png)

在第二次执行包后，您可以注意到已经插入了 4 行，并且存储过程已成功增加客户 ID。

![执行 2](../Images/0ff60a64f1a62a3adde0e9f5a6de49f0.png)

希望能给你一个想法。

# oracle11g - oracle11g如何回滚impdp

> ID：14987705
> 
> 赞同：0
> 
> 时间：2013-02-20T18:52:07.803
> 
> 标签：oracle11g, rollback, impdp

我的任务是使用命令 impdp 导入 o​​racle 数据库（大数据）。我必须迁移需要很长时间的大数据。当导入作业中断时，有没有办法回滚数据库？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-27T18:54:28.647

通过在 import commnad 中使用 job_name 可以从它被中断的地方启动作业。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T02:15:00.717

闪回功能是您的朋友。

# c# - 存储库实现是否是基础架构的一部分？

> ID：14987712
> 
> 赞同：0
> 
> 时间：2013-02-20T18:52:22.173
> 
> 标签：c#, domain-driven-design, ddd-repositories

在 DDD 项目中，我有这样的结构：

**基础设施**

*   MyProj.Library（包含辅助方法）
*   MyProj.Factory（包含 IoC 和 DI 的方法）
*   MyProj.Data（包含 IUserRepository 的实现）

**领域**

*   MyProj.Domain（包含域聚合和存储库接口，即 IUserRepository）

**应用**

*   MyProj.WebAPI

我需要知道**MyProj.Data 是**属于 Infrastructure 层还是 Domain 层。我真的很困惑实现的存储库属于哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:03:23.920

通常，您将在基础设施层拥有存储库实现，在域层拥有存储库接口。

作为一个例子，看看[洋葱架构](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)，它指出

> 内层定义接口。外层实现接口

![洋葱架构](../Images/0671ee1db224daf89ee4f93a914ea66f.png)

在洋葱架构的这个[简单实现中](https://bitbucket.org/jeffreypalermo/onion-architecture/src)，VisitorRepository 驻留在基础设施层中，并实现在核心（域）层中找到的 IVisitorRepository。

# ios - 在我的应用程序上显示错误的启动图像。尝试通过多种方式替换它

> ID：14987713
> 
> 赞同：8
> 
> 时间：2013-02-20T18:52:26.693
> 
> 标签：ios, xcode

我的应用程序启动图像有问题。在开发的早期，我添加了一个示例图像作为启动图像。现在，当应用程序准备好发布时，我无法更改启动图像。

我尝试在项目摘要的 xcode 中更改它，从项目文件中删除文件并用具有正确名称的新图像替换文件。没运气。它仍然在所有设备上显示错误。

我什至没有项目中的图像了。

这里有没有人知道出了什么问题，或者经历过这样的事情？

发布图片适用于 iPhone 和 iPad，纵向。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T18:57:44.873

返回到您尝试替换图像之前。将图像文件替换为新文件。

啊，但这没有用，对吧？这是问题所在：

1.  清理你的构建文件夹。构建过程可能不会总是选择您的新启动映像。（查看 Product 菜单时按住 Option 键，或删除**~/Library/Developer/Xcode/DerivedData**的内容。）
2.  从模拟器和/或手机中删除应用程序。应用程序安装程序通常不会复制新映像。

（这些步骤并不总是都是必需的，但如果它们都需要，则必须按此顺序执行，所以我只是按照列出的方式执行它们。）

原因如下：

1.  当您构建时，Xcode 将作为产品一部分的各种文件复制到 DerivedData。这可能并不总是将更改的文件复制到现有文件上。
2.  当您安装到模拟器或设备进行调试时，这是另一个文件副本，它可能并不总是将更改的文件复制到现有文件上。

请注意，手机上的 App Store 安装程序在安装方面做得更好，您不会像这样获得部分安装。但是，除非您能够向自己证明您的应用程序是使用正确的映像构建的——即您在#2 中失败了，而不是在#1 中失败——我不会相信这一点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-28T15:39:48.560

除了作为清理的一部分删除派生数据之外，我发现从测试设备中删除应用程序是不够的，我还必须重新启动设备。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-28T17:10:37.537

在我执行以下步骤之前，没有什么对我有用：

*   转到 xcode 中的项目文件
*   打开产品文件夹
*   右键单击您的 *.app 产品
*   选择在取景器中显示
*   上升 3 级到构建文件夹
*   删除此 Build 文件夹
*   建造
*   就是这样

您可能还想尝试两种删除文件的方法

> ~/库/开发者/Xcode/DerivedData

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-23T21:31:45.107

我正在使用 XCode 8.2.1、大量目标和资产目录。我无法可靠地设置应用程序图标集或启动图像集以配置任何目标。

如果我的图像集在工作区中全局唯一地命名，那么我可以毫无问题地指定正确的图像集。

如果不同目录中的图像集具有相同的名称，即 AppIcon、LaunchImage、XCode 似乎会从按字母顺序排列的第一个资产目录中选择图像集。

因此，我的解决方案是为每个资产目录中的每个图像集命名，并以资产目录的名称为前缀。这样，它是有组织的和全球独一无二的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-29T09:39:51.980

对于 Xamarin 用户，我能找到的唯一解决方案是执行以下操作：

1.  从设备/模拟器中删除应用程序
2.  重启设备/模拟器
3.  部署并运行应用程序

删除应用程序、清理构建、删除 bin 和 obj 目录以及重建，都不起作用。必须重新启动设备/模拟器才能忘记旧的缓存图像。

正如 Steven Fisher 指出的那样，从 App Store 正确安装不会发生这种情况，因为它“在安装方面做得更好”。

# cakephp - cakephp 在 nginx 上运行访问插件

> ID：14987717
> 
> 赞同：0
> 
> 时间：2013-02-20T18:52:37.367
> 
> 标签：cakephp

我使用 cakephp 几年了，现在在 Apache 上运行。我正在运行 php 5.3 和 cakephp 2.2 我已经安装了 nginx 并且有一个非常简单的 cakephp 模型工作（很少有表使用脚手架），而且效果很好。

我刚刚在标准 APP/Plugin 目录下安装了 debug_kit 插件并访问了一个页面，日志显示它找不到文件访问日志显示它去获取 /debug_kit/css/debug_toolbar.css 并且错误仍然存​​在找不到 app/webroot/debug_kit/js/jquery.js

如果我尝试其他简单的插件 Chk 本质上它找不到 ChkController 但是日志显示重写的数据：“/index.php”，args：“url = Chk”

这似乎意味着对于标准模型，重写正在工作，但对于插件，当它查找文件时，插件的基本目录没有被计算

任何想法或样品

非常感谢

硅

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:48:45.230

我很确定这与您的重写规则有关。我不知道您的 nginx 重写规则是什么样的，但这些对于我使用任何版本的 cake 2.x 都可以正常工作。

```
if (-f $request_filename) { 
    break; 
}
if (!-f $request_filename) {
    rewrite ^/(.+)$ /index.php?url=$1 last;
    break;
} 
```

# jquery - jquery相册使用列表

> ID：14987719
> 
> 赞同：1
> 
> 时间：2013-02-20T18:52:42.597
> 
> 标签：jquery, html-lists, next

我使用 html 列表制作了一个 jquery 照片库。我在使用上一个和下一个按钮时遇到问题。当您在加载后立即打开照片时，它们可以正常工作。如果我关闭图库，转到另一张照片并单击它以打开我的下一个和上一个变量，有些变量不再正常工作，它们会跳过照片。我想要做的是使用变量和 jquery .next 和 .previous 作为箭头。

非常感谢您对此的任何帮助。

我在这里有一个演示[http://jsbin.com/uvikug/11/edit](http://jsbin.com/uvikug/11/edit)

打开照片、下一个和上一个按钮的代码具体是这样的，但您可以在该链接中看到所有这些：

```
$(".photo").click(function() {
  $("#loading_box_container").animate({
    height: "100%"
  }, 300, function() {
      $("#close").css({
        display: "block"
      });        
  });

  id = $(this).attr('id');
  $('#preload').prop('src', 'http://www.klossal.com/klossviolins/gallery/fulls/' + id + '.jpg');

  fadeIn('#' + id);

  $("#next").click(function() {  
    if (!$('#' + id).hasClass("last")) {
      $("#preload").fadeOut(500, function() {
      var id_a = $('#' + id).next().attr('id');
      id = id_a;

      $('#preload').prop('src', 'http://www.klossal.com/klossviolins/gallery/fulls/' + id_a + '.jpg');

      fadeIn('#' + id_a);
      });
    }
  });

  $("#prev").click(function() {
    if (!$('#' + id).hasClass("first")) {
      $("#preload").fadeOut(500, function() {
      var id_b = $('#' + id).prev().attr('id');
      id = id_b;  

      $('#preload').prop('src', 'http://www.klossal.com/klossviolins/gallery/fulls/' + id + '.jpg');

      fadeIn('#' + id); 
      });
    }
  }); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:15:36.737

基本上你的代码一点也不差，只是一个小问题，每次有人点击`<li class="photo" />`.

只需放置积木

`$("#prev").click(function() {..` 并且`"$("#next").click(function() { ..."`每个这样的代码都在块之外`"$(".photo").click(function() { ... })"`。

它会正常工作。

# list - 仅从 Prolog 的列表中输出悲伤的学生

> ID：14987721
> 
> 赞同：1
> 
> 时间：2013-02-20T18:52:47.580
> 
> 标签：list, prolog

我有以下声明：

```
calculate_sad_moods([]):-!.
calculate_sad_moods([X2|Rest2]) :- 
    (sad(X2),write(`One of our sad students is: `),write(X2),nl);
calculate_sad_moods(Rest2). 
```

当我这样称呼它时：

```
?- calculate_sad_moods([
    ivan, dragan, petkan, borislav, damyan, ani, petyr, ivo
]). 
```

我最终得到了一个非常长的列表（没关系，但它有重复的记录）：

```
One of our sad students is: ivan
Yes.
One of our sad students is: dragan
Yes.
One of our sad students is: dragan
Yes.
One of our sad students is: petkan
Yes.
One of our sad students is: petkan
Yes.
One of our sad students is: borislav
Yes.
One of our sad students is: borislav
Yes.
One of our sad students is: damyan
Yes.
One of our sad students is: damyan
Yes.
One of our sad students is: damyan
Yes.
One of our sad students is: ani
Yes.
One of our sad students is: ani
Yes.
One of our sad students is: ani
Yes.
One of our sad students is: petyr
Yes.
One of our sad students is: petyr 
```

当我将声明更改为：

```
calculate_sad_moods([]):-!.
calculate_sad_moods([X2|Rest2]) :- 
    write(`One of our sad students is: `),write(X2),nl,
calculate_sad_moods(Rest2). 
```

我最终得到了这个（这不好，因为不是每个人都很难过，但它没有重复记录）：

```
One of our sad students is: ivan
One of our sad students is: dragan
One of our sad students is: petkan
One of our sad students is: borislav
One of our sad students is: damyan
One of our sad students is: ani
One of our sad students is: petyr
One of our sad students is: ivo 
```

我怎样才能只输出悲伤的学生并且只输出一次？我试过添加括号和其他一些技巧，但仍然 - 没有。我没有其他想法可以去哪里看。

**PS：这是悲伤声明的样子**

```
[...]
sad(damyan) :- 
    (not(lovesExam(damyan,chemistry)),hasExam(damyan,chemistry));
    (not(lovesExam(damyan,biology),hasExam(damyan,biology)));
    (not(lovesExam(damyan,math),hasExam(damyan,math))).
sad(ani) :- 
    (not(lovesExam(ani,chemistry)),hasExam(ani,chemistry));
    (not(lovesExam(ani,biology),hasExam(ani,biology)));
    (not(lovesExam(ani,math),hasExam(ani,math))).
[...] 
```

它仍然很晦涩，但我仍在学习基础知识...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:28:22.240

你把切口放在无用的地方。尝试使用 if/then/else 代替 cut，这样会更清晰。

```
calculate_sad_moods([]).
calculate_sad_moods([X2|Rest2]) :-
    (   sad(X2)
    ->  write('One of our sad students is: '),
        write(X2),
        nl
    ;   true),
    calculate_sad_moods(Rest2). 
```

你有一些错字

```
...
    (not(lovesExam(damyan,chemistry)),hasExam(damyan,chemistry));
    (not(lovesExam(damyan,biology),hasExam(damyan,biology)));
... 
```

注意第二行应该是

```
 (not(lovesExam(damyan,biology)),hasExam(damyan,biology)); 
```

如果你想*收集*悲伤的学生，你应该使用 setof/3 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:26:43.883

我有点不清楚你想用你的谓词实现什么 - 它应该一次打印一个学生并在用户接受时中止，还是应该简单地打印出列表中所有悲伤的学生？这将是两个略有不同的谓词。

至于为什么你会得到重复，我猜你的`sad`谓词中的某些东西会导致回溯，这意味着它可以被多次评估 - 使用`trace`序言解释器的功能来找出回溯发生的位置。虽然最好的办法是将`sad`谓词修复为不回溯，但解决方法是在 the 之后使用 cut`sad`来防止回溯：

```
calculate_sad_moods([]):-!.
calculate_sad_moods([X2|Rest2]) :- 
    (sad(X2), !, write(`One of our sad students is: `),
     write(X2), nl, calculate_sad_moods(Rest2));
    calculate_sad_moods(Rest2). 
```

剪切意味着我们需要`calculate_sad_moods`在编写输出后递归到，因为我们无法再到达`or`子句的部分（它也被剪切掉了）。

如果您需要在第一个悲伤的学生发现后谓词评估为真的行为，您可以通过`;`在悲伤情况下的回溯之前使用另一个来实现这一点：

```
calculate_sad_moods([X2|Rest2]) :- 
    (sad(X2), !, write(`One of our sad students is: `),
    write(X2), (nl; calculate_sad_moods(Rest2))); %only recurse if user says 'no'
    calculate_sad_moods(Rest2). 
```

最后一点，谓词名称非常具有误导性，因为您实际上并没有计算任何东西；也许`print_sad_students`会是一个更合适的名字。

# android - 表示 SQLite 数据库中的 LinkedList

> ID：14987723
> 
> 赞同：1
> 
> 时间：2013-02-20T18:52:54.000
> 
> 标签：android, sqlite, data-structures, linked-list, simplecursoradapter

我想在我的 Android 应用中表示一个播放列表。如果播放列表为空，我的项目仅按日期显示。如果播放列表包含几个项目，则播放列表应按顺序显示，然后是其余项目（仍按日期）。

但是，我不确定如何有效地建模。我怎样才能以一种糟糕的方式构建我的数据库，以便在播放列表中插入项目（到任何位置）变得容易，并且仍然以快速（并且合理简单）的方式选择它们。

**示例**我有一个包含项目 A、B、C、D、E、F、G 的列表。首先，项目按顺序显示：

```
 A,B,C,D,E,F,G 
```

用户现在将 F 和 D 添加到他的播放列表中。这些项目现在应该按以下顺序显示：

```
 F,D,A,B,C,E,G 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-20T20:02:32.227

如果您想根据某种时间戳对项目进行排序（例如，您希望首先出现最新的），那么只需在表中添加一个时间戳列，例如创建日期或更新日期/时间。然后，在查询表时，使用它进行排序。

```
SELECT * FROM ITEMS_TABLE
ORDER BY CREATION_DATETIME DESC; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-20T19:03:11.867

> 我如何以这种方式构建我的数据库，以便轻松插入项目（到任何位置）

**`heap table`**创建提供快速插入的经典- *“在您可以插入的第一个位置插入”。*

> 并且仍然以快速（且合理简单）的方式选择它们。

所以很可能你需要创建[index](http://en.wikipedia.org/wiki/Database_index)。索引是在最常出现在后面的列上创建的**`where clause`**。通过创建索引也会**`b+ tree`**创建，所以当你想创建任何索引时应该小心。

还有更多方法，但它在很大程度上取决于数据源类型，例如 Oracle 提供了多种类型的表，具有各种优点和缺点。

此外，您将选择的具体方法还取决于数据库 - 对 db 的要求、表中的平均记录数等。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-08-02T18:04:50.907

我正在使用这个解决方案。我在表中添加了一个额外的列，说“序列”，它将具有要获取记录的订单号..同时通过“序列”获取表的顺序，您将获得所需的顺序。

但是插入一行或删除一行需要对序列进行大量更新。

# javascript - 在浏览器 javascript ftp 或其他本地文件托管中？

> ID：14987725
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:52:57.277
> 
> 标签：javascript, browser, ftp, hosting, local

这可以做到吗？如果是这样，我如何以及在哪里可以找到示例代码、库等？

澄清：我的意思是用js在浏览器中托管一个ftp服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:09:30.937

不，这不是您可以使用从 Web 文档执行的 JavaScript 执行的操作。没有可用于打开侦听 TCP 套接字的 JavaScript 程序的接口。

您可能能够从浏览器扩展内部执行此操作，具体取决于特定的浏览器，但您必须为您打算支持的每个浏览器发布不同的扩展。

# c# - .NET 的 3D 图形库

> ID：14987727
> 
> 赞同：21
> 
> 时间：2013-02-20T18:53:03.133
> 
> 标签：c#, graphics, 3d, directx

我想学习为 Windows 7 / 桌面制作简单的 3D 应用程序。我的意思是在 3D 空间中移动的球体、三角形或像素。到目前为止，它不必非常复杂。为此，我想将 C# 语言与 .NET 一起使用（Java/C++ 是我的第二要务）。

我知道这在互联网上已经被问过很多次了，但我觉得很多问题都已经过时了，很多 API 被弃用了，教程也太旧了。

我正在考虑学习 XNA，但后来我了解到[微软不打算再开发和支持它了。](http://indiegames.com/2013/02/its_official_xna_is_dead.html)SharpDX 似乎也是一个不错的选择，但这似乎是针对 Windows Store 和 Phone 应用程序的。

在 Internet 上查找时，Managed DirectX 似乎正是我正在寻找的东西（语法、复杂性），但同样，这对我来说**太不推荐**使用了。

您能否指导我应该学习什么来创建简单而可靠的 3D 应用程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T19:06:07.843

看看[SlimDX](http://slimdx.org/)。它是 DirectX (DirectX 11) 的开源、免费、托管库。每个版本都与 DirectX 版本同时发布，因此大多数时候它都是最新的。我已经使用了它，并且很容易上手。[这里（向下滚动）](http://slimdx.org/features.php)是与您提到的其他可能性的比较。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-20T19:04:09.577

最简单的可能是使用 WPF 3D。这是一个保留模式的图形系统，所以如果你没有很大的需求（即：特效着色器等），它很容易设置和直接使用。

否则，更精细的 3D 系统（例如 XNA）可能更合适。这将是更多的设置工作，但会给你更多的控制权。

1.  [教程 1：在屏幕上显示 3D 模型](http://msdn.microsoft.com/en-us/library/bb203897%28v=xnagamestudio.31%29.aspx)
2.  [WPF](http://www.codeproject.com/Articles/23332/WPF-3D-Primer)
3.  [XNA](http://msdn.microsoft.com/en-us/aa937791)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-20T19:32:38.267

在 OpenGL 世界中，我一直在使用[OpenTK](https://opentk.net/)。我必须在现有代码的基础上构建，`C#`才能显示没有阴影和逼真效果的平面几何对象。

这是一个例子：

![使成为](../Images/9f84aaf33dec5845b5418e5da2d98d46.png)

从代码生成：

```
void InitModels()
{
    Scene.CoordinateSystem cs1 = new Scene.CoordinateSystem(world.Ground)
    {
        DrawSize = 1,
        Visible = false
    };
    Scene.CoordinateSystem cs2 = new Scene.CoordinateSystem(world.Ground, 0.6 * vec3.J)
    {
        DrawSize = 0.5,
        Orientation = rot3.RotateXDegrees(-15)
    };
    Scene.Cube cube = new Scene.Cube(cs1)
    {
        CubeSize = 0.5
    };
    cs2.AddPoint(new point3(vec3.O,1), Color.Firebrick, 15);
    var line = cs2.AddLine(new line3(-vec3.I, vec3.I), 20, Color.SlateGray, 2);
    line.SetPattern(0xFF0F, GeometryTest.Scene.Stripple.Scale2);

    cube.BindTexture(5, GeometryTest.Properties.Resources.julia, true);
    cube.AddText(3, "OpenTK 1.0", Color.DarkMagenta, 0.5f, 0.5f, 1.0f);

} 
```

# macros - Cognos Report Studio 提示宏

> ID：14987731
> 
> 赞同：4
> 
> 时间：2013-02-20T18:53:16.980
> 
> 标签：macros, report, prompt, cognos

是否有使用提示宏的完整指南？

我使用了一些来过滤日期和文本字段（我发现它们环顾四周），我希望使用带有组合的宏提示（在本例中为静态字段）。

我使用的示例： ORGID=#prompt('OrganizationID')# to_date(#sq(prompt('Start_Date','DATE'))#,'YYYY-MM-DD') （顺便说一句，sq 是什么意思？）

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T02:32:13.933

sq() 表示用单引号括起来。

我找到的大部分信息都在 Framework Manager 指南中。这包含信息，包括 sq 的解释

[http://pic.dhe.ibm.com/infocenter/cfpm/v10r1m0/index.jsp?topic=%2Fcom.ibm.swg.im.cognos.ug_fm.10.1.0.doc%2Fug_fm_id10577using_macro.html](http://pic.dhe.ibm.com/infocenter/cfpm/v10r1m0/index.jsp?topic=%2Fcom.ibm.swg.im.cognos.ug_fm.10.1.0.doc%2Fug_fm_id10577using_macro.html)

我根据互联网上的所有片段构建了自己的文档。

# css - 如何让我的 css 类页脚从屏幕的左侧到右侧？

> ID：14987732
> 
> 赞同：0
> 
> 时间：2013-02-20T18:53:18.910
> 
> 标签：css, background, footer, background-repeat

我的 CSS 类页脚没有扩展页面的整个底部。如果浏览器窗口足够小，它可以正常工作，但如果窗口足够大，左右端和页面背景是可见的。该类没有嵌套在另一个类中，它的唯一父级是 and 标记。这是页脚的css：

```
.Footer { width: 100%; padding:10px 0; margin:0px 0 0 0; text-align:center; border-top:1px solid #b3b3b3; background-color:#d9d9d9;}
.Footer p { color:#959595; padding:0; margin:0; font:normal 10px 'Verdana';}
.Footer a { color:#959595; text-decoration:underline;} 
```

该页面位于 avidest.com，因此您可以了解我的意思。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T18:55:16.633

将`Footer`块移到主容器之外，`bgRasize`它应该跨越页面的宽度。它目前是其容器的 100% 宽度。

```
<div class="bgRasize">
  ... other content
</div>

<div class="Footer">
  ... footer content
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:58:18.323

检查三件事：

1.  该`.Footer`元素是`<body>`标签的直接子元素。
2.  如果您想确保您的元素将接触视口的边缘，则应该`<body>`有。`padding: 0; margin: 0;`
3.  如果`.Footer`默认情况下具有类的元素不是块元素，则应将其显示样式显式设置为`display: block;`.

标签层次结构应如下所示：

```
<body>
  <!-- Page content. -->
  <div class="Footer"></div>
</body> 
```

# java - Action_MOVE 在 Action_UP 后激活

> ID：14987733
> 
> 赞同：0
> 
> 时间：2013-02-20T18:53:19.797
> 
> 标签：java, android, ontouchlistener, motionevent

我正在创建一个游戏，我希望我的角色通过 Action_MOVE 向左或向右转，但前提是用户将手指从显示器上移开。我有一个类可以检测 MotionEvent 是 MOVE 还是 UP。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T07:37:00.353

是的，我认为您可以依靠 MotionEvent.ACTION_UP

# java - 正则表达式问题 - 匹配 API 名称

> ID：14987735
> 
> 赞同：2
> 
> 时间：2013-02-20T18:53:22.940
> 
> 标签：java, regex, matcher, regex-lookarounds

我目前正在处理一个大型代码库，最近其中一个 API 的签名发生了变化。所以我需要修改数千个文件才能获得新功能。所以开发了一个java程序来获取所有`*.java`文件并寻找旧的API模式。如果发现用新模式替换它。

### 旧 API

```
API(3,Utils.FIFTY,key1,key4) 
```

### 新 API

```
API(key1,key4) 
```

所以我创建了一个正则表达式模式来匹配旧 API，因为`API\([\d,\s\.\w]*(key[\.\w\s,]*)\)` 如果它匹配它将替换它

`replaceString = matcher.group(1) + "(" + matcher.group(2) + ")";`

因此，使用当前代码而不是预期`API(key1,key4)`，我得到了`API(key4)`. 我已经分析了这个问题，我的推断是`\w`捕获了第一个**关键**模式。如果我们需要匹配，我们需要做一个消极的展望。

任何人都可以分享解决正则表达式问题的最佳一致方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:22:30.200

FJ 的回答与这个测试用例不匹配：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class APIUpdater {
   public static void main( String[] args ) {
      String source = "\n" +
        "API( key.getValue( 18 ),call( key1 ).mth(),key1,key4);\n" +
        "API(\n" +
        "\t3,\n" +
        "\tUtils.FIFTY,\n" +
        "\tkey1,\n" +
        "\tkey4 );\n" +
        "API(3,Utils.FIFTY,key1,key4);\n";
      Pattern p =
         Pattern.compile( "API\\([.\\w\\s,]*?,\\s*(key[\\.\\w\\s,]*)\\)" );
      Matcher m = p.matcher( source );
      while( m.find())
      {
         System.err.println( m.replaceAll( "API(key1,key4)" ));
      }
   }
} 
```

输出是：

```
API( key.getValue( 18 ),call( key1 ).mth(),key1,key4);
API(key1,key4);
API(key1,key4); 
```

多行调用不匹配，但正确处理了空格。

解析 Java 需要具有语法的真正解析器，正则表达式无法完成这项复杂的工作，因为它们在词汇级别（单词，而不是句子）工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:00:12.173

像下面这样的东西应该可以工作：

```
API\([\.\w \t,]*?,\s*(key[\.\w \t,]*)\) 
```

这里的主要变化是将第一个字符类的重复从更改`*`为`*?`，这意味着它现在将匹配尽可能少的字符而不是尽可能多的字符，因此您的所有`key`参数都将包含在匹配组中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T19:43:26.503

您可能想尝试[Recoder](http://sourceforge.net/apps/mediawiki/recoder/index.php?title=Writing_transformations)，它允许您应用源代码转换。

# actionscript-3 - 动态文本字段中的 Adob e Air 桌面应用程序时间戳

> ID：14987738
> 
> 赞同：0
> 
> 时间：2013-02-20T18:53:31.837
> 
> 标签：actionscript-3, air, flash-cs5

如何添加另一个动态文本字段，在加载新文件时给出时间戳？实时不是毫秒？

我有一个内置 Flash CS5 应用程序的 Adob​​e Air 桌面应用程序，当文件是新文件时，它会将文本文件从网络加载到动态文本字段中，并在加载新文件时通知用户。

这是我的代码

```
NativeApplication.nativeApplication.startAtLogin=true

stage.nativeWindow.alwaysInFront=true;

//external text file load and recheck every 2 minutes

var myInterval:uint  = setInterval (loadUrl, 120000);
var loader:URLLoader = new URLLoader(newURLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);

function completeHandler(event:Event):void {
var loadedText:URLLoader = URLLoader(event.target);
if(myText_txt.htmlText!=loadedText.data){
   myText_txt.htmlText = loadedText.data;
     stage.nativeWindow.notifyUser(NotificationType.CRITICAL) 
}else {
  //do nothing
}
}

function loadUrl():void {
    loader = new URLLoader(new URLRequest("https://my_text_file.txt"));
loader.addEventListener(Event.COMPLETE, completeHandler);
   }

 // button control

Minimize_BTN.addEventListener(MouseEvent.CLICK, minimize);
function minimize(e:MouseEvent){
stage.nativeWindow.minimize();

}

drag_BTN.addEventListener(MouseEvent.MOUSE_DOWN, drag);
function drag(e:MouseEvent){
stage.nativeWindow.startMove();

}

stop(); //Stop on the frame you want 
```

# jaxb - 使用 MOXy 解组到不同的对象

> ID：14987741
> 
> 赞同：1
> 
> 时间：2013-02-20T18:53:49.603
> 
> 标签：jaxb, eclipselink, moxy, unmarshalling

我有一个带有根元素**SearchResourceResponse**的响应 xml 。我需要将其解组为不同的自定义（HSIDetails）对象。我开始使用 MOXy 作为我的 JAXB（JSR-222）实现。我的以下意图正确吗？MOXy 可以吗？

```
JAXBContext jc = JAXBContext.newInstance(HSIDetails.class);
Unmarshaller unmarshaller = jc.createUnmarshaller();
HSIDetails hsiDetails = (HSIDetails) unmarshaller.unmarshal(new StreamSource(new StringReader(responseXml))); 
```

和我的 HSIDetails 课程

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class HSIDetails implements Serializable{
    /**
     * 
     */
    private static final long serialVersionUID = -4352912510533245455L;

    @XmlPath("SearchResponseDetails/LogicalDevice/LogicalPhysicalResource/PhysicalResource[@*[local-name()='type' and contains(.,'icl:Slot')]]/commonName")
    private String slot;
    @XmlPath("SearchResponseDetails/LogicalDevice/LogicalPhysicalResource/PhysicalResource[@*[local-name()='type' and contains(.,'icl:PhysicalPort')]]/commonName")
    private String port;

    @XmlPath("SearchResponseDetails/SubNetwork/Pipe/commonName")
    private String telephone;

    @XmlPath("//SearchResponseDetails/SubNetwork/Pipe/lrStatus")
    private String lrStatus;

    public String getSlot() {
        return slot;
    }
    public void setSlot(String slot) {
        this.slot = slot;
    }
    public String getPort() {
        return port;
    }
    public void setPort(String port) {
        this.port = port;
    }
    public String getTelephone() {
        return telephone;
    }
    public void setTelephone(String telephone) {
        this.telephone = telephone;
    }
    public String getLrStatus() {
        return lrStatus;
    }
    public void setLrStatus(String lrStatus) {
        this.lrStatus = lrStatus;
    }
} 
```

我的xml的一部分是：

```
<tns:SearchResourceResponse xmlns:tns="http://www.ICLNBI.com/ICLNBI.xsd">
    <SearchResponseDetails>
        <SubNetwork>
            <Pipe xsi:type="icl:Trail" xmlns:icl="http://www.ICLNBI.com/ICLNBI.xsd"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
                <CommonName>XXXXX</CommonName>
                <objectID>1234567890</objectID>
                <description>512/2</description>
                <SourceSystem>YYYY</SourceSystem>
            </Pipe>
        </SubNetwork>
    </SearchResponseDetails>
</tns:SearchResourceResponse> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T22:09:24.223

您可以使用带`Class`参数的解组方法之一来告诉 MOXy 或任何 JAXB (JSR-222) 实现要解组到哪个类。

```
 JAXBContext jc = JAXBContext.newInstance(HSIDetails.class);
 Unmarshaller unmarshaller = jc.createUnmarshaller();
 HSIDetails hsiDetails = unmarshaller.unmarshal(
     new StreamSource(new StringReader(responseXml)), 
     HSIDetails.class).getValue(); 
```

# gtk3 - vala中对象实例和信号处理程序的分段错误

> ID：14987742
> 
> 赞同：0
> 
> 时间：2013-02-20T18:53:53.473
> 
> 标签：gtk3, vala

我正在编写一个小 http 客户端来测试 api 调用。这是学习vala和使用gtk3的机会。

我做了一个类来处理gtk接口和http请求。

```
using GLib;
using Gtk;

public class RequestHandler : Object
{
    public string uri { get; private set; default = ""; }

    // Constructor
    public RequestHandler ()
    {
    }

    [CCode (instance_pos = -1)]
    public void on_url_changed (Entry entry, Button button)
    {
        stderr.printf ("this#%p\n", this);
        if (entry.get_text_length () == 0)
        {
            button.set_sensitive (false);
            this.uri = "";
        }
        else
        {
            button.set_sensitive (true);
            this.uri = entry.get_text();
        }
    }

    [CCode (instance_pos = -1)]
    public void on_send_clicked (Button button)
    {
        assert (this.uri != null );
        stderr.printf ("Send request to : %s\n", this.uri);
    }
} 
```

线

```
stderr.printf ("this#%p\n", this);
// => fprintf (_tmp0_, "this#%p\n", self); in the C file 
```

每次显示“this#0x1”，程序因行分段错误而失败

```
this.uri = entry.get_text();
// _g_free0 (self->priv->_uri); in the C file 
```

用户界面是用

```
var builder = new Builder ();
builder.add_from_file (UI_FILE);
var signals_handler = new RequestHandler ();
builder.connect_signals (signals_handler); 
```

我真的是瓦拉的新手，我没有看到我的错误。

[编辑]

```
...
<object class="GtkEntry" id="entry2">
    <property name="visible">True</property>
    <property name="can_focus">True</property>
    <property name="receives_default">True</property>
    <property name="hexpand">True</property>
    <property name="invisible_char">●&lt;/property>
    <property name="input_purpose">url</property>
    <signal name="changed" handler="request_handler_on_url_changed" object="button1" swapped="no"/>
</object>
... 
```

ui 完全由 glade 生成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T19:46:19.220

您对 on_url_changed 方法有一个额外的参数。Gtk.Editable.changed信号应该有一个参数：改变的 Gtk.Editable [。](http://valadoc.org/gtk+-3.0/Gtk.Editable.changed.html)由于自动连接的信号没有类型安全，`public void on_changed (Gtk.Entry entry);`应该可以工作。

您在上面发布的代码发生的情况是正在生成这样的东西：

```
void request_handler_on_changed (GtkEntry* entry, GtkButton* button, RequestHandler* self) {
  fprintf (stderr, "this#%p\n", self);
} 
```

gtk+ 像这样称呼它

```
request_handler_on_changed (editable, request_handler); 
```

因此，当您的 Vala 代码获取信息时，它在按钮参数中有 RequestHandler，而 self（这是生成“this”变量的方式）是垃圾。

自动连接信号时必须非常小心，因为您基本上是在绕过 Vala 并直接连接到生成的 C。Vala 无法提供类型安全。

# r - head() 函数在“for”循环中不起作用？

> ID：14987743
> 
> 赞同：2
> 
> 时间：2013-02-20T18:53:56.877
> 
> 标签：r, for-loop

我尝试使用 for 循环打印出几行。这是代码。奇怪的是它不适用于 head() 函数。如果我替换`head()`为`print()`.

```
kw_id=c('a','b')
keyword_text=data.frame(col=c('a','b'), col2=c(1,2), row.names=(c('r1','r2')))

for (i in 1:2) { 
   plot_data<-subset(keyword_text,col==kw_id[i])
   print(plot_data)
   head(plot_data)
} 
```

有人可以帮忙吗？我怀疑它与`head()`功能有关。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-20T19:00:44.437

这是 R 新手遇到的相对常见的一类问题。这里的问题是 R 服务于两个情妇：交互式控制台工作和“真正的编程”。

当您在控制台键入返回值的命令时，控制台会*自动*调用 print 方法以显示结果。运行脚本时，除非您告诉它，否则不会发生这种情况。

因此，如果您将其更改为`print(head(plot_data))`它应该可以工作。

这些在 FAQ [7.16](http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-is-the-output-not-printed-when-I-source_0028_0029-a-file_003f)和[7.22中讨论](http://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f)

从评论中提取的附录：

正如 Josh 指出的那样，将 for 循环直接复制粘贴到控制台也无法打印任何输出。在这种情况下发生的情况是 for 循环（就像 R 中的大多数东西一样）实际上是一个函数，它的返回值 ( `NULL`) 是不可见地返回的，这意味着没有打印。（这在 中提到`?Control`。）

# listview - Listview 选择显示没有填充和没有复选标记

> ID：14987745
> 
> 赞同：5
> 
> 时间：2013-02-20T18:54:04.573
> 
> 标签：listview, windows-8, windows-runtime, winrt-xaml, c++-cx

我有这个在代码`XAML`中显示。将用作选择菜单。`ListView``C++/CX``ListView`

```
<ListView x:Name="itemsListView"
 ItemsSource="{Binding Source={StaticResource MenuDataSourceCVS}}"
 HorizontalAlignment="Stretch"
 Width="230"
 Margin="0,45,0,0"
 VerticalAlignment="Top"
 Grid.Row="1"
 SelectionChanged="itemsListView_SelectionChanged" SelectionMode="Single"
 HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
 FontFamily="Global User Interface">
 <ListView.ItemTemplate>
    <DataTemplate>
        <StackPanel Orientation="Horizontal" Height="40" Width="230">
            <TextBlock Text="{Binding Name}"
                Margin="10,5" Width="150" Height="30"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"/>
            <Border Height="30" Width="30" Margin="5">
                <Image Source="{Binding ImageSrc}" Stretch="Fill"/>
            </Border>
        </StackPanel>
    </DataTemplate>
 </ListView.ItemTemplate>
</ListView> 
```

正如您在下图中看到的那样，选择不会占据所有列，并且在选择时会显示一个复选标记。

![带有复选标记和填充的 ListView 选择](../Images/d86c84a886f87621576461b1eabfc255.png)

有没有办法消除这种填充和复选标记？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-20T21:26:45.723

您需要在 Blend 中打开您的视图，然后右键单击列表并选择“编辑其他模板”/“编辑生成的项目容器 (ItemContainerStyle)”/“编辑副本”。然后，您可以编辑由您的项目填充时`Style`生成`ListViewItem`的。`ListView`在左侧的“状态”选项卡中，您可以看到`ListViewItem`. 当您选择其中之一时 - 设计图面会显示 ListViewItem 在该状态下的样子，并且它还会切换到记录模式，您可以在其中定义模板的各种元素属性的属性值。然后您可以查看哪些元素受到视觉状态动画的影响，并修改这些动画或删除元素本身。如果您在 Blend 中删除一个元素 - 所有相关的视觉状态动画都将被自动删除，因此在您的情况下，您可以看到状态将元素更改为 1。您可以在所有将其修改为`SelectionStates` `VisualStatesGroup`的状态下修改该目标值另一个所需的值或简单地删除`Selected``SelectionBackground``Opacity``Opacity``SelectionBackground`通过在“对象和时间轴”面板中选择它来选择元素（它实际上会从所有状态的模板中删除它并删除影响它的所有动画）。然后你可能同样想删除`HintGlyphBorder, SelectingGlyph, SelectedCheckMarkOuter`.

要删除填充 - 请确保通过单击微小的红色录制按钮或将“状态”选项卡中当前显示的状态切换回“基本”来禁用状态的录制，然后在“属性”中选择`ContentBorder`并更改它`Margin`选项卡到 0,0,0,0 并对`SelectedBorder`.

这是来自 Blend 的带注释的屏幕截图： ![在此处输入图像描述](../Images/61b0e88b1d4abde4b7f851d4d9b9efbe.png)

# javascript - 在 ajax 请求中，url 中前面的 `/` 指定了什么？

> ID：14987747
> 
> 赞同：1
> 
> 时间：2013-02-20T18:54:42.737
> 
> 标签：javascript

我注意到它可以双向工作，但是您应该采用哪种方式呢？

**特殊案例**

```
$FOO.ajax({
    type:       'get',
    url:        src, // the src works with both a preceding / and with out
    // ... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T18:56:39.673

`/path/file.ext`相对于域，而`path/file.ext`相对于当前文件夹。

如果您在域的顶级文件夹中，则没有区别，但为了保持一致性，通常包含`/`并且让您的路径相对于根目录更安全。

# canvas - 如何减少 EaselJS 动画中矩形的宽度

> ID：14987748
> 
> 赞同：0
> 
> 时间：2013-02-20T18:54:43.577
> 
> 标签：canvas, easeljs

我想减少动画中每个刻度的矩形宽度。

在 init() 方法中，我最初使用以下命令创建矩形：

```
var graphics = new createjs.Graphics().beginFill("green").drawRect(650, 90, 280, 8);
var shape = new createjs.Shape(graphics);
stage.addChild(shape); 
```

如何在 tick() 中访问矩形的宽度？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:25:12.850

简单的答案：你不能直接这样做！

有两种方法可以做到这一点：

**1) 通过 scaleX 和 Tween**

```
var tween = createjs.Tween.get(shape).to({scaleX:0.5 }, 1000); 
```

**2）通过重绘每一帧**

保存一个具有初始宽度的附加变量，然后在每个刻度上从该宽度中减去一些东西，并用新宽度重新绘制矩形。

虽然方式**1)**可能更简单，但缩放**可能会**导致边缘模糊，您必须根据自己的情况进行测试。

# jquery - 单击相同链接时显示/隐藏 div

> ID：14987751
> 
> 赞同：1
> 
> 时间：2013-02-20T18:54:48.713
> 
> 标签：jquery, html

我有一个链接，单击该链接时会显示一个`<div>`包含`<form>`. 我想在再次单击链接时隐藏`<div>`包含`<form>`并在单击时再次显示它。我创建了一个简单的 Jquery 来隐藏 div。单击相同的链接时，如何实现它以显示/隐藏。

```
$("#customize").click(function(){
    $("#cust").hide('slow');
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-20T18:55:56.937

要切换可见性，请使用[toggle()](http://api.jquery.com/toggle/)：

```
$("#customize").click(function(){
    $("#cust").toggle('slow');
    return false;
}); 
```

# php - Mysql 字符串值不正确

> ID：14987758
> 
> 赞同：1
> 
> 时间：2013-02-20T18:55:22.070
> 
> 标签：php, mysql

我刚刚通过PHP向mysql db（版本5.0.83）添加一些文本时遇到了一个问题当我尝试添加包括土耳其语字符的文本时，Mysql会抛出错误“不正确的字符串值”。使问题更有趣的是，如果文本字符串中有一个土耳其字符，Mysql 会接受它，但如果字符串中的字符数多于一个，则会出错。

这个错误的可能原因是什么？

更新：

```
 CREATE TABLE IF NOT EXISTS `cat_communicative` (
`parent_id` int(10) NOT NULL auto_increment,
`child_of` tinytext,
`level_num` int(10) default NULL,
`category_title` tinytext,
`category_file_name` tinytext,
 PRIMARY KEY  (`parent_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=22 ; 
```

我正在尝试将文本添加到“类别标题”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:57:39.917

这似乎有效。

我已将列的字符集更改为 cp850，这是一个更适应的字符集，更重要的是接受土耳其字符。

```
 CREATE TABLE IF NOT EXISTS `cat_communicative` (
    `parent_id` int(10) NOT NULL auto_increment,
    `child_of` tinytext,
    `level_num` int(10) default NULL,
    `category_title` tinytext CHAR SET cp850,
    `category_file_name` tinytext,
     PRIMARY KEY  (`parent_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=22 ; 
```

[土耳其语兼容的字符集](http://www.eki.ee/letter/chardata.cgi?lang=tr+Turkish&script=latin)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T07:47:18.030

我发现如果你有多咬字符，php 的**strtolower()函数会导致问题。**使用**mb_strtolower**将解决问题。

# javascript - 如何等到异步步骤完成？

> ID：14987760
> 
> 赞同：1
> 
> 时间：2013-02-20T18:55:24.970
> 
> 标签：javascript, forms, validation, submit

我有一个表单，我需要在提交之前运行一些验证操作。这些操作涉及异步步骤，例如 ajax 调用。

如何告诉表单等到所有验证操作完成后再提交？

我的验证函数如下所示（伪代码）：

```
function preSubmit() {
    // validate field 1
    ajax({
        ...
        onSuccess:...
    });
    // validate field 2
    ajax({
        ...
        onSuccess:...
    });
    // fields 3, 4, etc.
} 
```

我当前的问题是表单在 onSuccess 回调完成之前被提交。

我当然可以使我的 ajax 调用同步，但由于性能影响，我试图避免它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:13:06.713

如果您使用的是 jQuery，那么您可能需要考虑`JQuery.Deferred or Promise`

当前一个调用完成（成功或失败）时，您调用每个 ajax 请求（或包含该请求的函数）。

如果您使用 $.when 您可以通过`.then`回调管理失败的请求。如果您使用承诺，那么您可以在各种场景中使用`.done` `.fail`和`.always`回调。

```
$.when($.ajax("...."), $.ajax("...."))
  .then(...); 
```

资源：

*   [http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/](http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/)
*   [http://api.jquery.com/jQuery.when/](http://api.jquery.com/jQuery.when/)
*   [http://api.jquery.com/promise/](http://api.jquery.com/promise/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:02:01.820

理想情况下，您应该只需要触发一个 ajax 事件。如果您必须包含多个 ajax 事件，您可以使用成功回调函数按顺序（同步）触发异步请求。这是一个例子。

```
 function preSubmit() {
        $.ajax({
            error: handleError,
            success: stepTwo
        });
    }
    function stepTwo() {
        $.ajax({
            error: handleError,
            success: stepThree
        });
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:21:47.553

您可以使用 JavaScript 的设置超时功能。代码会是这样的，

```
function preSubmit() {
 //set a variable which increments after each Ajax call success.
var successCount=0;
// validate field 1
ajax({
    ...
    onSuccess: function(){
       successCount++; 
    }
});
// validate field 2
ajax({
    ...
     onSuccess: function(){
       successCount++; 
    }
});

  var wait = function(){
      setTimeout(function(){
        // check whether "successCount" is equal to number of validations done
         //here it is 2
        if(successCount==2){
        //call function say,"submitForm" which submit the form
          submitForm();
        }else{
          //All validations are not completed, wait until it completes
          wait();
         }
        },1000);
     }
     wait();
} 
```

这样您就可以有效地使用异步 Ajax 调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T18:59:55.573

创建一个“errorMsg”变量并最初将其设置为“等待”，然后让您的 aynchc 代码更新它。

在您的表单提交代码中，检查该字段的值。它还没有“准备好”，不要提交。

# python - Python 简单的 for 循环逻辑（索引超出范围）

> ID：14987764
> 
> 赞同：0
> 
> 时间：2013-02-20T18:55:49.107
> 
> 标签：python, for-loop, wxpython, logic, wxwidgets

调用 DeleteButton 函数时出现错误“元组索引超出范围”。我正在尝试一次从列表中删除多个对象。有人能告诉我我的逻辑有什么问题吗？

```
def DeleteButton(self,event):
    sel = self.task_list.GetSelections()       

    length = len(sel)       

    for item in range (0, length):
        index = sel[item]
        self.task_list.Delete(index)
        sel = self.task_list.GetSelections()
        length = len(sel) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:00:44.743

您应该使用`while`带有手动递增计数器的循环，而不是尝试在`for`循环的每次迭代中重置范围的顶部，主要是因为这不起作用。

```
range(0, length) 
```

创建 a `list`，然后由循环对其进行迭代`for`，并且在循环期间可以认为是不可变的，因此尝试重置`length`不会像您认为的那样。为了更明确地说明问题，这里有一些等效代码：

```
i = 5
l = range(0, i) # l now set to list [0, 1, 2, 3, 4]
for v in l:
    i = v # this has no effect, as l is already instantiated and separate from i 
```

编辑：

为了回应您的评论，这里有一个`while`应该解决`for`循环问题的循环（尽管不是您的代码中可能存在的其他问题）。

```
sel = self.task_list.GetSelections()
i = 0
while i < len(sel):
    index = sel[i]
    self.task_list.Delete(index)
    sel = self.task_list.GetSelections()
    i += 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:36:15.790

从未有过使用 wxPython 的经验，我对此有点天真，但是从我从文档中可以看出，以下内容不是更有意义吗？

```
def DeleteButton(self, event):
    for id in self.task_list.GetSelections():
        self.task_list.Delete(id) 
```

如果所选项目的 id似乎`GetSelections`返回一个列表，那么为什么在您的示例中会增加额外的复杂性？

# asp.net - ASP.NET / WinForms 共享的业务逻辑：找到程序集的位置以访问与其相关的文件

> ID：14987769
> 
> 赞同：0
> 
> 时间：2013-02-20T18:56:03.043
> 
> 标签：asp.net, .net, wpf, winforms, configuration-files

我正在重构一些“继承”的业务逻辑代码，这些代码对于 ASP.NET 端需要使用绝对路径进行初始化，但在 WinForms / WPF 端仅使用[GetExecutingAssembly](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getexecutingassembly.aspx)目录的相对路径。

我想将这两者合并到存储在[Web.config](http://en.wikipedia.org/wiki/Web.config)或[App.config](https://stackoverflow.com/questions/1431742/what-is-app-config-for)中的相对设置中，这样我就可以对两者进行[xcopy 部署](http://www.codinghorror.com/blog/2005/03/make-mine-xcopy.html)，而不必对路径名进行硬编码。

有哪些方法可以找到程序集的位置以及与它一起部署的相关文件，而不必依赖于 ASP.NET 特定的[Server.MapPath](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)或[HostingEnvironment.MapPath](http://msdn.microsoft.com/en-us/library/system.web.hosting.hostingenvironment.mappath.aspx)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:06:05.443

您可以使用相对于`AppDomain.CurrentDomain.BaseDirectory`.

这将是包含客户端应用程序的可执行文件的目录，以及 ASP.NET 的网站根目录。

# jquery - jquery工具tps不显示

> ID：14987770
> 
> 赞同：0
> 
> 时间：2013-02-20T18:56:07.250
> 
> 标签：jquery, tooltip

我正在设计一个学习游戏。我有 6 个随机加载的类别，并希望显示该类别的动态描述。

```
function loadCategories() {
   var i = 0;
   var j = 0;

   $(".categoryname").each( function() {
    $(this).attr("title",descriptions[categoryIndex[i]]);
    $(this).text(category[categoryIndex[i]]).delay(500 * i);
    console.log("category "+ categoryIndex[i] + 
            ": "+category[categoryIndex[i]]+"\ttitle: " +
            descriptions[categoryIndex[i]]);
    $(this).fadeIn(2000,"blind");
    for(j = 0; j < 5; j++) {
       $(".value[index="+ (5*i + j) + "]").attr("answerid",categoryIndex[i]*5 + j);
    }

    i++;
   });

} 
```

我可以在控制台日志中看到每个类别的标题。但是，在运行时，我只能看到最后 3 个类别的工具提示。

我在

```
$(document).ready( function () {

    // other code to parse the xml data file

    $(document).tooltip();

    // 

}); 
```

每个类别名称都是一个跨度，如下所示：

```
<span class="categoryname" title=""></span> 
```

直到使用上面的代码设置标题。当我在运行时查看代码时，它正确显示如下：

```
<span class="categoryname" title="Tooltip">Category Name</span> 
```

关于为什么这不起作用的任何想法？

# knockout.js - 循环遍历同一个数组两次？

> ID：14987772
> 
> 赞同：0
> 
> 时间：2013-02-20T18:56:14.220
> 
> 标签：knockout.js

我有这样的视图模型，

```
 function viewModel() {
            this.Items = ['A', 'B', 'C'];
        }

        ko.applyBindings(new viewModel()); 
```

我想打印这样的东西，

```
 <div data-bind="foreach: {data: Items, as: 'item1' }">
        <span data-bind="text: item1"></span>
        <div data-bind="foreach: {data: Items, as: 'item2' }">
            <span data-bind="text: item2"></span>
        </div>          
    </div> 
```

上述方法不起作用，我收到一条错误消息，提示未定义项目（在我第二次尝试使用它的那一行）。

所以，我想我会试试这个，

```
 function viewModel() {
            this.Items1 = ['A', 'B', 'C'];
            this.Items2 = ['A', 'B', 'C'];
        }

        ko.applyBindings(new viewModel());

    <div data-bind="foreach: {data: Items1, as: 'item1' }">
        <span data-bind="text: item1"></span>
        <div data-bind="foreach: {data: Items2, as: 'item2' }">
            <span data-bind="text: item2"></span>
        </div>          
    </div> 
```

我收到语法错误。我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:27:11.137

您需要更改内部循环的上下文：（示例基于您的原始意图）

```
<div data-bind="foreach: {data: Items, as: 'item1' }">
    <span data-bind="text: item1"></span>
    <div data-bind="foreach: {data: $parent.Items, as: 'item2' }">
        <span data-bind="text: item2"></span>
    </div>          
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:02:35.483

如果您想要完成的只是吐出数组中的每个值，只需将您的标记更改为：

```
<div data-bind="foreach: {data: Items, as: 'item1' }">
    <span data-bind="text: item1"></span>        
</div> 
```

这是 jsFiddle：http: [//jsfiddle.net/dymAQ/1/](http://jsfiddle.net/dymAQ/1/)

# asp.net-mvc - asp net mvc 4 应用程序在添加时抛出内部服务器错误 xml web.config 上的标记

> ID：14987773
> 
> 赞同：0
> 
> 时间：2013-02-20T18:56:15.163
> 
> 标签：asp.net-mvc, iis

我需要使用我的 web.config xml 文件更改 maxRequestEntityAllowed 默认值所以我已将其添加到 xml：

```
<location path="gedaiapp">
   <system.webServer>
      <serverRuntime enabled="true" maxRequestEntityAllowed="524288000" />
   </system.webServer>
</location> 
```

gedaiapp是我在iis上配置的站点。这样做我在尝试加载一些 css 文件时遇到内部服务器错误

关于如何解决这个问题的任何想法？我遵循了微软文档：

[http://www.iis.net/configreference/system.webserver/serverruntime](http://www.iis.net/configreference/system.webserver/serverruntime)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:59:11.157

修复了添加的问题

```
<serverRuntime enabled="true" maxRequestEntityAllowed="524288000" /> 
```

直接到我在 c:\Windows\System32\inetsrv\config 找到的 applicationHost.config

# spring - 如何在 Spring 3 中自定义无效日期格式的错误消息？

> ID：14987775
> 
> 赞同：2
> 
> 时间：2013-02-20T18:56:27.913
> 
> 标签：spring, date, validation, message

我正在使用 Spring 3.1.1.RELEASE。我想在我的模型的 java.util.Date 字段中自定义为无效日期格式显示的错误消息。这是模型……</p>

```
public class ContractForm
{
    …
    private Date activationDate;

    private Date expirationDate;

    …

} 
```

我的属性包中有这个设置……</p>

```
typeMismatch.ContractForm.activationDate=The activation date format should be of the form MM/dd/yyyy
typeMismatch.ContractForm.expirationDate=The expiration date format should be of the form MM/dd/yyyy 
```

而且我已经在我的控制器中注册了一个自定义的 java.util.Date 编辑器……</p>

```
@InitBinder
public void initBinder(WebDataBinder binder) {
    final DateFormat dateFormat = new SimpleDateFormat(Contract.DATE_FORMAT);
    dateFormat.setLenient(false);
    binder.registerCustomEditor(Date.class, new CustomDateEditor(dateFormat, true));
    ...        
} 
```

但是，当我提交带有无效日期的表单时，我没有收到我想要的错误消息，而是收到类似“无法将 java.lang.String 类型的属性值转换为所需的 java.util.Date 类型的属性激活日期；嵌套异常是 java.lang.IllegalArgumentException：无法解析日期：无法解析的日期：“02012013”​​'

如何获得我想要的错误信息？

# windows-phone-7 - ScrollViewer 中的焦点文本框边距

> ID：14987777
> 
> 赞同：0
> 
> 时间：2013-02-20T18:56:39.133
> 
> 标签：windows-phone-7, xaml

例如：我有带有 ApplicationBar 的标准 Windows Phone 应用程序（重要！），并且在 ContentPanel 中有此代码：

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <ScrollViewer>
        <StackPanel>
            <TextBlock Margin="12,0" TextWrapping="Wrap" Text="..." />
            <TextBox AcceptsReturn="True" />
        </StackPanel>
    </ScrollViewer>
</Grid> 
```

并且当TextBox被聚焦时，键盘上方有很大的余量。这不是词流。

看截图：

![](../Images/36649392bc668a65552547c6e9f01c3d.png)

当没有 ApplicationBar 时——没有任何边距。什么问题？

# java - Servlet：黑屏

> ID：14987779
> 
> 赞同：0
> 
> 时间：2013-02-20T18:56:42.423
> 
> 标签：java, eclipse, servlets

我正在使用 Eclipse IDE，下面的代码在浏览器上显示了空白屏幕。我不知道为什么它显示空白屏幕。有什么想法吗？提前致谢。

```
/**
 * Servlet implementation class Ch1Servlet
 */
public class Ch1Servlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
        // TODO Auto-generated method stub
        PrintWriter out=response.getWriter();
        Date dat=new Date();
        System.out.println(dat);
        out.println("<html>" + "<body>" + "<h1>Heello world</h1>" + dat + "</body>" + "</html>");       
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

    }
} 
```

请找到部署描述符文件。网页.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>Monte</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>
  <servlet>
    <description></description>
    <display-name>Ch1Servlet</display-name>
    <servlet-name>Ch1Servlet</servlet-name>
    <servlet-class>Ch1Servlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>Ch1Servlet</servlet-name>
    <url-pattern>/Ch1Servlet</url-pattern>
  </servlet-mapping>
</web-app> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:30:54.893

尝试这样的事情：

```
 package package;

 /**
   *
   * @author 
   */
   public class Ch1Servlet  extends HttpServlet {

/**
 * Processes requests for both HTTP <code>GET</code> and <code>POST</code> methods.
 * @param request servlet request
 * @param response servlet response
 */
protected void processRequest(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    response.setContentType("text/html;charset=UTF-8");
    PrintWriter out = response.getWriter();
    try {
        //you code here
    } catch (Exception exc) {
        throw new MyException(exc);
    }finally{
            out.close()
        }
}

// <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">

/** 
 * Handles the HTTP <code>GET</code> method.
 * @param request servlet request
 * @param response servlet response
 */
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);
}

/** 
 * Handles the HTTP <code>POST</code> method.
 * @param request servlet request
 * @param response servlet response
 */
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
    processRequest(request, response);
}

/** 
 * Returns a short description of the servlet.
 */
@Override
public String getServletInfo() {
    return "Short description";
}
// </editor-fold>
} 
```

上面的代码接受 get 和 post

# c# - WPF 在调试停止时运行代码

> ID：14987780
> 
> 赞同：1
> 
> 时间：2013-02-20T18:56:42.520
> 
> 标签：c#, .net, wpf, debugging

好的，所以我有一个使用 COM 与 Quickboos (QBFC) 通信的应用程序。当我的应用程序关闭时，它会调用一个方法来确保已经与 quickbooks 建立的连接在退出之前确实已关闭。如果我不调用此方法，Quickbooks 可能不允许用户关闭他们的公司文件，因为它识别出与我的应用程序的打开会话，即使它不再运行。

现在，在使用 Quickbooks 执行各种操作后，我将关闭会话。我已经实现了 AppDomain.UnhandledException、Dispatcher.UnhandledException 和 Application.Exit 事件处理程序，以确保如果它们关闭应用程序或在我们使用 Quickbooks 打开会话时发生未处理的异常，则会话关闭。

这非常有效，但是现在我们在开发过程中遇到了一个问题，如果调试器在会话关闭之前停止，那么 quickbooks 文件就会被永久锁定，直到我们手动结束它的进程。未来与 Quickbooks 的任何通信都在新会话中。

当我点击“停止”时，是否可以在调试器完成终止应用程序之前执行一些代码，以便我们可以清理我们的会话？还是我们只是死在水里？我看了一下 Environment 类，我 99% 确定它的“退出”方法类似于当您点击“停止”时调试器调用的方法，所以我猜答案是“不”......但我认为确定肯定不会有什么坏处

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:27:46.467

我的建议是仅在需要时建立 QBFC 连接，并在操作完成后立即释放它。

您可以尝试的另一种方法是在应用程序启动期间或在获取新连接之前关闭先前的连接。如果涉及任何类型的会话标识符，请将其保存在文件中并使用它来关闭连接。

# matlab - 如何隐藏y轴？

> ID：14987781
> 
> 赞同：8
> 
> 时间：2013-02-20T18:56:48.960
> 
> 标签：matlab, matlab-figure, yaxis

我在 MATLAB -- 中绘制了一个水平箱线图`boxplot(y, group,'orientation','horizontal')`，然后使用隐藏 y 轴`set(gca,'box','off','ycolor','w')`。

它在屏幕上看起来很好 - 只有底部的 x 轴是可见的。但是，每当我使用`print()`函数 或将图形保存到文件时，`matlabfrag.m`左侧 y 轴都会重新出现在输出文件中（尽管它没有出现在 MATLAB 的图形可视化中）。

如何隐藏这个 y 轴？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-02-20T13:36:42.860

我知道这是一篇旧帖子，但以下内容也删除了可能是您想要的刻度线：

```
set(gca, 'YTick', []); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-07-05T15:52:54.467

尝试：

```
ax1 = gca;                   % gca = get current axis
ax1.YAxis.Visible = 'off';   % remove y-axis
ax1.XAxis.Visible = 'off';   % remove x-axis 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-28T18:05:02.910

在导出图形之前，请执行

```
set(gcf, 'InvertHardCopy', 'off'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-15T14:02:59.153

要从图中删除标签，请对 X 轴或 Y 轴使用以下命令：

```
set(gca,'XTickLabel',{' '})
set(gca,'YTickLabel',{' '}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-21T07:28:21.557

不久前，我在另一处房产上也发生了类似的事情。保留该属性的唯一方法是直接从图形菜单中保存！我知道这很无聊，但帮助了我！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-13T20:04:45.427

可能与旧版本无关，但这是我的做法。

```
plot(X,Y)                    
ylabel('Intensity [a.u.]');      %creates y axis label named 'Intensity [a.u.]'
yticklabels(' ');                %sets tick labels to ' ' (space) 
```

这可能是其他解释中所显示的，但这些对我来说毫无意义。我使用的是 2021a 版本。

# racket - 如何在球拍中保存 .bmp？

> ID：14987784
> 
> 赞同：1
> 
> 时间：2013-02-20T18:57:01.147
> 
> 标签：racket

我在 drracket 中创建了一个位图，我想将它作为 .bmp 保存在我的硬盘上。

```
#lang racket
(require racket/draw)

(define test-bitmap
  (let* ((target (make-bitmap 60 30))
         (dc (new bitmap-dc% [bitmap target])))
    (send dc set-font (make-font #:size 14 #:family 'roman
                                 #:weight 'bold))
    (send dc set-text-foreground "blue")
    (send dc draw-text "test" 5 1)
    target))

(send test-bitmap save-file "test.bmp" 'bmp) 
```

当我运行此代码时，drracket 报告“*位图中的保存文件％：尚未实现的种类保存：'bmp* ”文物）。

[bitmap%](http://docs.racket-lang.org/draw/bitmap_.html)的文档将 'bmp 列为此操作的有效类型。

这实际上是未实现的，还是我犯了一个愚蠢的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:13:38.980

目前，BMP 文件只能加载，不能保存。有关更多详细信息，请参见[racket/draw/private/bitmap.rkt](http://git.racket-lang.org/plt/blob/HEAD:/collects/racket/draw/private/bitmap.rkt)。

是的，这确实使文档`save-file`错误。我真的没有在源代码中发现任何暗示`save-file`实际上支持`bmp`.

# heroku - Facebook 登录导致 java.security.InvalidAlgorithmParameterException：trustAnchors 参数必须为非空

> ID：14987785
> 
> 赞同：2
> 
> 时间：2013-02-20T18:57:22.853
> 
> 标签：heroku, playframework, play-authenticate

我们正在开发一个使用 PlayFramework 构建的 Java 应用程序并将其部署到 Heroku。我们通过 Play Authenticate 将我们的登录机制与 Facebook 集成，但是从今天早上开始，我们无法登录。我们得到了一些看起来像附件的安全证书异常。

我们想知道这是否可能是由于环境发生了一些变化，因为我们不记得更改任何相关的应用程序代码。有什么我们可以检查的吗？

提前致谢，

```
2013-02-20T17:33:32+00:00 app[web.1]: play.api.Application$$anon$1: Execution exception[[RuntimeException: Unexpected error: java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be non-empty]]
2013-02-20T17:33:32+00:00 app[web.1]: 
2013-02-20T17:33:32+00:00 app[web.1]: at play.api.DefaultApplication.handleError(Application.scala:383) [play_2.10-2.1.0.jar:2.1.0]
2013-02-20T17:33:32+00:00 app[web.1]: at play.api.libs.concurrent.PlayPromise$$anonfun$extend1$1.apply(Promise.scala:113) [play_2.10-2.1.0.jar:2.1.0]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.SSLEngineImpl.checkTaskThrown(SSLEngineImpl.java:508) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.SSLEngineImpl.readNetRecord(SSLEngineImpl.java:759) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.SSLEngineImpl.unwrap(SSLEngineImpl.java:727) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at org.jboss.netty.handler.ssl.SslHandler.unwrap(SslHandler.java:1118) ~[netty-3.5.9.Final.jar:na]
2013-02-20T17:33:32+00:00 app[web.1]: at javax.net.ssl.SSLEngine.unwrap(SSLEngine.java:624) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: Caused by: java.lang.RuntimeException: Unexpected error: java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be non-empty
2013-02-20T17:33:32+00:00 app[web.1]: at play.core.server.netty.PlayDefaultUpstreamHandler$$anon$2$$anonfun$handle$1.apply(PlayDefaultUpstreamHandler.scala:132) [play_2.10-2.1.0.jar:2.1.0]
2013-02-20T17:33:32+00:00 app[web.1]: at play.api.libs.concurrent.PlayPromise$$anonfun$extend1$1.apply(Promise.scala:113) [play_2.10-2.1.0.jar:2.1.0]
2013-02-20T17:33:32+00:00 app[web.1]: Caused by: java.lang.RuntimeException: Unexpected error: java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be non-empty
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.validator.PKIXValidator.(PKIXValidator.java:75) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.validator.Validator.getInstance(Validator.java:178) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:270) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.X509TrustManagerImpl.checkServerTrusted(X509TrustManagerImpl.java:225) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: Caused by: java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be non-empty
2013-02-20T17:33:32+00:00 app[web.1]: at java.security.cert.PKIXParameters.setTrustAnchors(PKIXParameters.java:200) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at java.security.cert.PKIXBuilderParameters.(PKIXBuilderParameters.java:104) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at java.security.cert.PKIXParameters.(PKIXParameters.java:120) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.validator.PKIXValidator.(PKIXValidator.java:73) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.ClientHandshaker.serverCertificate(ClientHandshaker.java:1147) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.validator.Validator.getInstance(Validator.java:178) ~[na:1.6.0_27]
2013-02-20T17:33:32+00:00 app[web.1]: at sun.security.ssl.X509TrustManagerImpl.getValidator(X509TrustManagerImpl.java:129) ~[na:1.6.0_27] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T01:35:10.073

从 Naaman 的回答来看，这是由于 JDK 更新所致。

# c# - 重定向时会话重置

> ID：14987787
> 
> 赞同：0
> 
> 时间：2013-02-20T18:57:27.280
> 
> 标签：c#, asp.net, session-variables

我的代码实际上只是：
`Response.Redirect("~/SomeDirectory/Default.aspx");`

但是，它会在重定向时完全清除 Session。我什至在调试模式下检查以确保会话在重定向之前仍然具有其变量，并且确实如此。

从“~/SomeDirectory/Default.aspx”和其他页面使用的任何和所有重定向都会转到其正确的页面，而不会导致会话过期/重置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:06:57.997

尝试使用 Response.Redirect 的重载版本：

Response.Redirect("~/SomeDirectory/Default.aspx", false);

它不会终止当前线程，也许会解决您的问题（[http://msdn.microsoft.com/ru-ru/library/a8wa7sdt.aspx](http://msdn.microsoft.com/ru-ru/library/a8wa7sdt.aspx)）

# php - mysqli 返回所有相同的记录

> ID：14987789
> 
> 赞同：-1
> 
> 时间：2013-02-20T18:57:29.733
> 
> 标签：php, mysqli

以下代码应该从表中检索所有记录并将它们返回到数组。它确实返回正确数量的记录，但是所有记录都是相同的。有谁知道问题是什么？

```
function list_book() {
$username = "user";
$password = "pwd";
$conn =  mysqli_connect('localhost', $username, $password, 'db') or die('Could Not Connect' . mysql_error());
$stmt = $conn->stmt_init();
if ($stmt->prepare("SELECT * FROM book")) {
    $stmt->bind_result($r['book_id'], $r['book_title']);
    if (!$stmt->execute()) {
        echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
        exit();
    }
    while($stmt->fetch()){
        $book[] = $r;
    }
    print_r($book);     //**** added purposely to examine the content of the array
    exit();

    return $book;
}
mysqli_close($conn); 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:07:36.603

参数必须在语句执行后绑定......见[http://www.php.net/manual/en/mysqli-stmt.bind-result.php](http://www.php.net/manual/en/mysqli-stmt.bind-result.php)

另外，我不知道您是否可以绑定到数组的元素...

在你的 if 语句中试试这个......

```
if (!$stmt->execute()) {
    echo "Execute failed: (" . $stmt->errno . ") " . $stmt->error;
    exit();
}

$stmt->bind_result($book_id, $book_title);

while($stmt->fetch()){
    $book[] = array($book_id, $book_title);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:05:03.757

不要使用丑陋的mysqli。
使用一些可以在 2 行中完成所有工作的辅助类，luke [safemysql](https://github.com/colshrapnel/safemysql)可以

```
function list_book() {
    global $db; // NEVER connect in the function, connect once and then use ONE connection
    return $db->getAll("SELECT * FROM book");
} 
```

或者至少使用 PDO，如果你想坚持使用原始 API。
但是忘记mysqli，它无法使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:05:04.147

问题是，只有一个数组`$r`。每次调用`$stmt->fetch()`时，该数组的参数都会被覆盖，然后再次将其附加到`$book`-array。

**一种可能的解决方案：（**不一定是最好的）

```
$stmt->bind_result($book_id, $book_title);
...
while($stmt->fetch()){
    $book[] = array($book_id, $book_title);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T10:51:59.993

我想我通过在 while 循环中添加以下内容来解决问题。感谢大家的贡献！！！:)

```
foreach( $r as $key=>$value ) {
    $row_tmb[ $key ] = $value;
}

$book[] = $row_tmb; 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-20T19:06:44.473

该表是否有重复记录？

如果是这样，稍微修改 SQL 可能会有所帮助，例如： `SELECT DISTINCT book_id, book_title FROM book`

而不是显式的“绑定”，也许`$r = $stmt`->`fetch_assoc()`

然后您可以将（或任何字段）收集`$r['book_title']`到您的数组中。

# xml - 意外的 NodeRecorder 行为

> ID：14987792
> 
> 赞同：2
> 
> 时间：2013-02-20T18:57:31.180
> 
> 标签：xml, vtd-xml

给定以下 XML 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<InlinePurchaseOrder>
   <largeMessage>
      <BuyersID>20031234-1</BuyersID>
      <IssueDate>2003-01-23</IssueDate>
      <LineExtensionTotalAmount amountCurrencyID="USD" amountCurrencyCodeListVersionID="0.3">438.50</LineExtensionTotalAmount>
      <BuyerParty>
         <Party>
            <PartyName>
               <Name>Bills Microdevices</Name>
               <Name>BM</Name>
               <Name>BMic</Name>
            </PartyName>
         </Party>
      </BuyerParty>
   </largeMessage>
</InlinePurchaseOrder> 
```

我发出一个 XPath 来导航到`<PartyName>`节点，然后我想发出第二个 XPath 来获取所有`<Name>`节点，并记录它们的位置。

出于某种原因，`NodeRecorder.iterate()`即使节点被正确记录，我也立即返回 -1，我调用了`resetPointer()`，并且我正在向前移动。我有其他具有这种逻辑（但不同的 XPath）的文档有效，但这个不是。有任何想法吗？

演示代码：

```
File f = new File("noderecorder.xml");
FileInputStream fis = new FileInputStream(f);
byte[] b = new byte[(int) f.length()];
fis.read(b);
fis.close();

VTDGen vg = new VTDGen();
vg.setDoc(b);
vg.parse(false);

VTDNav vn = vg.getNav();

AutoPilot partyNameXPath = new AutoPilot(vn);
partyNameXPath.selectXPath("largeMessage/BuyerParty/Party/PartyName");

// Find PartyName
while (partyNameXPath.evalXPath() != -1) {
    System.out.println("Found: " + vn.getCurrentIndex() + " " + 
                       vn.toRawString(vn.getCurrentIndex()));

    NodeRecorder nr = new NodeRecorder(vn);

    // Find all Names and record their positions
    AutoPilot nameXPath = new AutoPilot(vn);
    nameXPath.selectXPath("Name");            

    while (nameXPath.evalXPath() != -1) {
        System.out.println("Found: " + vn.getCurrentIndex() + " " +
                           vn.toRawString(vn.getCurrentIndex()));
        nr.record();
    }

    nr.resetPointer();

    System.out.println("Index before nr.iterate: " + vn.getCurrentIndex());

    // Do some other work...

    // Now go and iterate over the nodes we recorded

    while (nr.iterate() != -1) {
        System.out.println("Re-found: " + vn.getCurrentIndex() + " " + 
                           vn.toRawString(vn.getCurrentIndex()));
    }

    System.out.println("Index after nr.iterate: " + 
                       vn.getCurrentIndex());

} 
```

输出：

```
Found: 19 PartyName
Found: 20 Name
Found: 22 Name
Found: 24 Name
Index before nr.iterate: 19
Index after nr.iterate: -1 
```

**编辑：**刚刚尝试了一个嵌套较少的修改文档，并且这个有效（将partyNameXPath更改为“PartyName”），问题似乎与深度相关：

```
<?xml version="1.0" encoding="UTF-8"?>
<InlinePurchaseOrder>
     <PartyName>
        <Name>Bills Microdevices</Name>
        <Name>BM</Name>
        <Name>BMic</Name>
     </PartyName>
</InlinePurchaseOrder> 
```

输出：

```
Found: 6 PartyName
Found: 7 Name
Found: 9 Name
Found: 11 Name
Index before nr.iterate: 6
Re-found: 7 Name
Re-found: 9 Name
Re-found: 11 Name
Index after nr.iterate: 11 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T03:53:31.463

这是一个刚刚修复的错误。感谢您的报告。你能从 CVS 中检查 NodeRecorder.java 并再试一次吗？

# java - StAX createXMLEventReader 我应该使用 BufferedReader 吗？

> ID：14987798
> 
> 赞同：1
> 
> 时间：2013-02-20T18:57:45.710
> 
> 标签：java, stax

```
xmlInputFactory.createXMLEventReader(new FileInputStream(myFile)); 
```

我应该为 FIS 使用 BufferedReader-decorator 还是 XMLInputFactory 足够聪明来装饰 FileInputStream 本身？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T21:32:51.557

看起来你应该能够很容易地测试这个。尝试使用和不使用 BufferedInputStream，看看哪个更快。通常，添加*额外的*BufferedInputStreams 通常不会增加太多开销，因为它们旨在优雅地处理这种情况。

# javascript - jQuery - 检测特定像素区域的点击，然后执行功能

> ID：14987805
> 
> 赞同：3
> 
> 时间：2013-02-20T18:58:19.000
> 
> 标签：javascript, jquery

我目前有一个 div，我们称它为`#videodiv`包含 HTML5 视频播放器（[SublimeVideo](http://sublimevideo.net)，但这可能是不相关的信息）。在页面加载时，`#videodiv`只有 100 像素。当用户单击 内的任何位置时`#videodiv`，我希望 jQuery 将 div 扩展为 250px。

你可能会说——这就像一个 jQuery 函数一样简单，只需使用点击然后动画！你是对的，除了...

**这就是问题所在：**包含在`#videodiv`其中并填充整个 div 的 HTML5 视频播放器会捕获所有发生的点击。这样做是为了触发播放器的播放/暂停功能，但随后不允许任何程序员为包含的 div 设置 jQuery 单击功能。

幸运的是，在这种情况下，`#videodiv`它是一个 100% 全身宽度的 div，并且具有 100 像素的精确高度。因此，考虑到上述问题，另一种方法是确定我们是否可以捕获**HTML 文档**（而不是 div）中发生在页面前 100 个像素中的任何点击，然后触发该函数。

*换句话说，我们如何使用 jQuery 来检测页面前 100 像素内的任何地方的鼠标点击，然后将 div 动画设置`videodiv`为 250 像素？*

替代/更好的解决方案*绝对*受欢迎，但 jQuery 是首选方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:02:58.130

像这样的东西应该可以工作 - 更改宽度和高度值以满足您的需求。`pageX`是横向的并且`pageY`是垂直的，所以我只是在左上角映射了一个 100x100 的空间。更改它以适应您的需求：

```
// Bind the click event to the body - any static parent container will do
$('body').on('click', function(e) {

    // Fire the callback if the click was in the top 100px by 100px
    if (e.pageX <= 100 && e.pageY <= 100) {

        // Prevent crazy animations and redundant handling
        $(this).off('click'); 

        // Scale the video to the appropriate size
        $('#videodiv').animate({
            width  : '250px',
            height : '250px'
         }, 1000);
    }
}); 
```

这是一个演示：http: [//jsfiddle.net/bKm4U/](http://jsfiddle.net/bKm4U/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T01:43:53.177

我已经通过一个单独的 StackOverflow 问题提供的以下答案解决了这个问题，位于此处：[检测 HTML5 视频何时完成](https://stackoverflow.com/questions/2741493/how-do-you-detect-html5-video-events)

只需两步：

1.  `onplay`用 jQuery检测
2.  运行 jQuery 函数

如您所见，HTML5 极其简单。我只希望文档更易于访问/搜索。

# mysql - 按非空值分组

> ID：14987808
> 
> 赞同：5
> 
> 时间：2013-02-20T18:58:32.087
> 
> 标签：mysql, sql

我有一个数据库：

```
+--+----+---------+
|id|name|source_id|
+--+----+---------+
|11|aaaa|null
+--+----+---------+
|12|bbbb|1
+--+----+---------+
|13|cccc|1
+--+----+---------+
|14|dddd|null
+--+----+---------+
|15|eeee|2
+--+----+---------+
|16|ffff|2
+--+----+---------+
|17|gggg|2
+--+----+---------+ 
```

我想选择所有条目，但有一个例外：

*   所有条目`source_id == somevalue(not null)`都应分组
*   **最后一个条目**`source_id == null`应该在之后存在

这是我期望的结果：

```
+----+--+----+---------+
COUNT|id|name|source_id|
+----+--+----+---------+
.....|11|aaaa|null
+----+--+----+---------+
.2...|13|cccc|1
+----+--+----+---------+
.....|14|dddd|null
+----+--+----+---------+
.3...|17|ffff|2
+----+--+----+---------+ 
```

到目前为止，我已经这样做了（注意：“change_count”= COUNT）：

```
SELECT *, (To_days(date_expires)-TO_DAYS(NOW())) as dayDiff, COUNT(id) AS change_count FROM mytable
GROUP BY source_id 
HAVING dayDiff < 4 
ORDER BY date_created DESC 
```

这就是我得到的：

```
+----+--+----+---------+
COUNT|id|name|source_id|
+----+--+----+---------+
.2...|11|aaaa|null
+----+--+----+---------+
.2...|12|bbbb|1
+----+--+----+---------+
.3...|15|eeee|2
+----+--+----+---------+ 
```

如您所见，结果有两个问题：

*   条目按第一次`source_id`出现分组（应该是最后一个（最新））
*   `nulls`也被分组（不应该被分组）

我上面描述的任务可以实现吗？我该怎么做？

编辑：

```
SELECT *, COUNT(id) AS change_count FROM 
(SELECT *, (To_days(date_return_due)-TO_DAYS(NOW())) as dayDiff FROM mytable 
WHERE owner_id='1' 
HAVING dayDiff < 100 
ORDER BY date_created DESC) AS newtable
GROUP BY (CASE WHEN source_id IS NULL THEN id ELSE source_id END)
ORDER BY (CASE WHEN source_id IS NULL THEN 1 ELSE 0 END), date_created DESC"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T19:08:49.943

我认为以下内容可以满足您的要求：

```
SELECT *, (To_days(date_expires)-TO_DAYS(NOW())) as dayDiff, COUNT(id) AS change_count
FROM mytable
GROUP BY (case when source_id is null then id else source_id end)
HAVING dayDiff < 4 
ORDER BY (case when source_id is null then 1 else 0 end), date_created DESC 
```

它是有条件`group by`的，因此不会对 NULL sourceid 进行分组。然后，它使用逻辑将它们放在最后`order by`。

没看懂你说的最后一次是什么意思。现在我想我做到了：

```
SELECT coalesce(s.id, mytable.id) as id,
       max(case when s.maxid is not null and s.maxid = myable.id then mytable.name
                when s.maxid is null then NULL
                else mytable.name
           end) as name,
       (To_days(date_expires)-TO_DAYS(NOW())) as dayDiff, COUNT(id) AS change_count
FROM mytable left outer join
     (select source_id, MAX(id) as maxid
      from mytable
      where source_id is not null
      group by source_id
     ) s
     on mytable.id = s.maxid
GROUP BY (case when source_id is null then id else source_id end)
HAVING dayDiff < 4 
ORDER BY (case when source_id is null then 1 else 0 end), date_created DESC 
```

这会加入来自最新记录的信息（基于最高 id）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-20T19:07:42.053

尝试将您的更改`group by`为：

```
GROUP BY coalesce(source_id, id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-25T12:26:21.090

尝试这个

SELECT *, IFNULL(source_id,UUID()) as unique_source FROM tablename WHERE (conditions) GROUP BY unique_source

# mysql - mysql 在 WHERE 和 GROUP BY 中使用索引

> ID：14987811
> 
> 赞同：0
> 
> 时间：2013-02-20T18:58:47.890
> 
> 标签：mysql, performance, indexing

这大约是一个多对多表，其两边都链接到每个表大约有 70000 条记录。多对多有大约 530 万条记录。

两个“side”表都有外键引用（一个是“tokens”，另一个是“paras”）。要找出包含给定标记的所有 paras，我需要按照以下行执行 SELECT 语句

```
SELECT para_id FROM many_to_many WHERE token_id = 3333 GROUP BY para_id; 
```

尽管“token_id”列是复合主键的“最左边”列，并且在 para_id 上有一个索引（由 para_id 外键使用），但这似乎运行得很慢。

我尝试使用 EXPLAIN 但这似乎从未提及使用 para_id 索引。我的问题是：是否可以让 MySQL 使用 para_id 索引？如果没有，如果我在查询中包含“JOIN paras ON paras.ID = many_to_many.para_id”，是否可以让它使用表“paras”的索引（在“ID”上）？这可能会导致性能提升吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:05:40.013

您可能需要`many_to_many`按`token_id`字段索引。复合主键在这里没有帮助。

# excel - 多重标准的公式

> ID：14987812
> 
> 赞同：2
> 
> 时间：2013-02-20T18:58:48.503
> 
> 标签：excel, spreadsheet, xls, xlsx, xlsm

美好的一天。有一个头痛的工作表。另外，我是 excel 的新手。我有一张不同范围的表格。要显示的每个值取决于在其他两个单元格中输入的值。例如：

```
Cell A14 = Item Description (drop down list)
Cell A18 = Item Weight
Cell C15 = Cost per Item (this varies depending on description & weight)
Cell D15 = Final calculated cost 
```

在单元格 C15 中，根据所订购商品的重量和描述，某些商品具有 3 到 6 个不同的价值/成本。例如：一个项目范围和成本：

```
1-44 = 1.52 per item
45-299 = 1.29 per item
300-499 = 1.25 per item
500-999 = 1.11 per item
1000- = 0.92 per item 
```

而另一个成本：

```
1-44 = 13.02 per item
45-99 = 4.02 per item
100-299 = 3.87 per item
300-499 = 3.70 per item
500-  = 3.59 per item 
```

还要记住，有 13 个不同的项目，如何根据单元格 A14 中的项目描述和单元格 A18 中的项目重量让单元格 C5 显示相应的值？我已经到了单元格 d5，它可以使用 Vlookup 公式根据项目描述进行计算：

```
=IF(A19*C15<VLOOKUP(A14,Sheet4!$B$1:$D$26,3,0),VLOOKUP(A14,Sheet4!$B$1:$D$26,3,0),A19*C15) 
```

我还创建了具有其他范围的其他工作表（1 和 4）。这是一个 IF 函数、另一个 VLookup 还是两者的组合？

提前致谢。

似乎我没有足够的代表来发布图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:05:31.993

You can use sumproduct:

![Example 1](../Images/bfc9d77c22b24602b4cae4d7320d0d00.png)

![Example 2](../Images/ff2e4fae55e4f7f1f0cd246fdc133546.png)

Just set up your table with the max and min ranges and the correspoding amounts.

**ADDENDUM:**

Here is how you would do it with SUMIFS()

![Example 3](../Images/6d632f04b29d75bd21c8417ebd82e06d.png)

![Example 4](../Images/cc271fa4d70dc27acbde090acafcefd3.png)

# ruby-on-rails - 表单提交在包含 Bootstrap 的 Rails 3 应用程序中停止工作

> ID：14987815
> 
> 赞同：0
> 
> 时间：2013-02-20T18:58:50.350
> 
> 标签：ruby-on-rails, twitter-bootstrap, simple-form, form-for

如果我不包含 Bootstrap，我在 Rails 3 应用程序中有一个 simple_form，它可以正常工作，但是当我添加 bootstrap 时，提交按钮似乎什么都不做。单击它时在 Firebug 控制台中显示的唯一内容是：

```
Empty string passed to getElementById().
elem = document.getElementById( match[2] ); 
```

我的联系人部分看起来像：

```
<div class="slide" id="contact" data-slide="6" data-stellar-background-ratio="0.5">
      <div id="contactText">
         <div id="contactHeader">
            Contact Us
         </div>
      <%= simple_form_for @message, :url => contact_path, :html => {:class => "form-horizontal"} do |form| %>
         <%= form.input :name %>
         <%= form.input :email %>
         <%= form.input :subject %>
         <%= form.input :body, as: 'text'%>
         <%= form.button :submit, :class => "btn-primary", :value => "Send Message" %>
      <% end %>
      </div> <!-- end contactText --> 
</div> <!--end contact--> 
```

我的布局如下：

```
<!DOCTYPE html>
<html>
<head>
   <title>Test App</title>

   <%= stylesheet_link_tag    "application", :media => "all" %>    
   <%= stylesheet_link_tag "http://fonts.googleapis.com/css?family=Oxygen", :rel => "stylesheet", :type => "text/css" %>
   <%= stylesheet_link_tag    "custom.css", :media => "all" %>
   <%= javascript_include_tag "application" %>
   <%= javascript_include_tag "my.js" %> 
   <%= javascript_include_tag "jquery.stellar.min.js" %>
   <%= javascript_include_tag "waypoints.min.js" %>
   <%= javascript_include_tag "jquery.easing.1.3.js" %>
   <%= csrf_meta_tags %>
</head>
<body>
   <%= yield %>
</body>
</html> 
```

似乎是引导程序导致了这个问题，因为我取出`<%= javascript_include_tag "application" %>`并用 jquery 和引导 CDN 替换它并经历了相同的结果，但是当我删除引导程序时，它按预期工作。

在使用 simple_form 之前，我遇到了与 form_for 相同的问题。我也相信我遵循了 simple_form 的引导指示。

如果有其他文件可能有助于澄清问题，请告诉我，我很乐意发布它们。

我错过了一些简单的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:06:09.517

更改`<%= form.button :submit, :class => "btn-primary", :value => "Send Message" %>`为

`<%= form.submit "send message", :class => "btn-primary"%>`

同时删除这些

```
<%= javascript_include_tag "my.js" %> 
<%= javascript_include_tag "jquery.stellar.min.js" %>
<%= javascript_include_tag "waypoints.min.js" %>
<%= javascript_include_tag "jquery.easing.1.3.js" %>` 
```

并将这些文件包含在`application.js`文件中

```
//= require jquery
//= require jquery_ujs
//= require "my.js"
//= require "jquery.stellar.min.js"
//= require "waypoints.min.js"
//= require "jquery.easing.1.3.js" 
```

包含 Jquery 后应该会出现引导程序。您可能希望使用 gem 在您的应用程序中包含引导程序。如果您想从 CDN 使用它，请确保在调用 bootstrap 的任何函数之前加载 bootstrap.js

# erlang - 芝加哥老板 从视图中参考序列/集合元素

> ID：14987816
> 
> 赞同：0
> 
> 时间：2013-02-20T18:59:06.830
> 
> 标签：erlang, chicagoboss

我是 CB 的新来者，我正在开展一个项目，在该项目中，我需要以年、月的方式将前 12 个月的列表从今天的日期传递给视图，以便视图将内容写为跟随每个。

```
<div class="date">
      <h4>2103</h4>
      <div<JAN</div>
 </div> 
```

为了正确引用视图上的元素，我无法找出变量模式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T20:04:58.580

这是[在别处](https://groups.google.com/forum/?hl=en&fromgroups=#!topic/chicagoboss/9441gAg0PKI%22elsewhere%22)回答的，所以我填写以供参考。

列表列表可以完成这项工作：

在控制器上：

```
Dates = [ [{year, "2013"}, {month, "JAN"}], [{year, "2013"}, {month, "FEB"}] ], 
```

并将 var 传递给模板：`{dates, Dates}`

观点：

```
{% for date in dates %}
    Year: {{ date.year }}<br>
    Month: {{ date.month }}<br>
{% endfor %} 
```

# magento-1.7 - 如何在 cakephp 中包含 Magento 的 mage.php

> ID：14987819
> 
> 赞同：1
> 
> 时间：2013-02-20T18:59:16.370
> 
> 标签：magento-1.7, cakephp-2.2, cakephp-2.3

我已经在 cakephp 2x 根目录中安装了磁电机 1.7，我想在用户控制器中包含 Mage 类。

我的 cakephp 根目录 stractucher 是：-

```
skinrevive/app
skinrevive/magento
skinrevive/lib
skinrevive/plugins
skinrevive/vendors 
```

我正在尝试下面的代码，但每次都说找不到 Mage 类。

```
App::build(array('Magento' => array($_SERVER['DOCUMENT_ROOT'].'/skinrevive/magento')));
App::uses('Mage', 'Magento/app'); 
```

或者

```
App::import('Magento','Mage',array('file' => 'app/Mage.php')); 
```

请帮忙。

# php - 如何处理数组数据中的 JSON/PHP 数组

> ID：14987820
> 
> 赞同：0
> 
> 时间：2013-02-20T18:59:19.080
> 
> 标签：php, json

我认为这很简单，但我当然遇到了障碍，我是处理 JSON 数据的新手，但这里是信息。

```
$new_item = '[2554560000, 18.26]';
$load = file_get_contents("json/graphlist.json");
$data = json_decode($load, true);
var_dump($data);
echo "<br /><br />";
echo ($data['product1']);
echo "<br /><br />";
echo json_encode($data);

$save = file_put_contents('json/graphlist.json', json_encode($data)); 
```

JSON数据：

```
{"product1":[[243500000,17.85],[245500000,14.65],[248500000,16.22]]} 
```

当我 var_dump 解码后的数据时，它显示为：

```
array(1) { ["product1"]=> array(3) { [0]=> array(2) { [0]=> int(243500000) [1]=> float(17.85) } [1]=> array(2) { [0]=> int(245500000) [1]=> float(14.65) } [2]=> array(2) { [0]=> int(248500000) [1]=> float(16.22) } } } 
```

然而，当我回显 product1 数组时，它只显示：

```
Array 
```

所以我的问题是如何访问第二个数组中的数据。然后将 $new_item 中的数据附加到现有字符串以保存回 JSON 文件。我到处寻找，但找不到任何有类似示例或错误的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:03:09.640

你可能想做

```
echo($data["product1"][0][0]); 
```

相反，要取出第一个数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:01:47.180

您不能调用`echo`数组，它只会正确显示`Array`.

如果要访问其中的数据，可以执行以下操作：

`echo $data['product1'][0][0] // echoes '243500000'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:02:38.683

您需要使用`print_r()`来显示整个数组。

```
 print_r($data['product1']); 
```

# ruby-on-rails-3 - 为什么 update_attribute 不更改我的时间戳列

> ID：14987821
> 
> 赞同：2
> 
> 时间：2013-02-20T18:59:24.860
> 
> 标签：ruby-on-rails-3, postgresql, activerecord, ruby-on-rails-3.2

我有一个带有时间戳列的模型 queued_at。

为什么不`update_attribute(:queued_at, Time.now)`写入数据库？这只是偶尔发生。这是一个经常更新的属性。update_column 似乎一直在工作。

我正在使用带有 postgres 的 rails 3.2.12。

这个问题在 rails 3.1.11 中不存在。

这些项目展示了“问题”：

1.  [https://github.com/johnnaegle/scratch/tree/feature/rails_3.2.12](https://github.com/johnnaegle/scratch/tree/feature/rails_3.2.12)
2.  [https://github.com/johnnaegle/scratch/tree/feature/rails_3.1.11](https://github.com/johnnaegle/scratch/tree/feature/rails_3.1.11)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-25T20:09:33.240

看起来 active_record 足够聪明，可以知道正在更新的值是否相同或足够接近（在时间戳的情况下），它将避免 SQL 写入 - 节省性能。我已经成功地通过在 update_attribute 调用之后“触摸”相关对象的模型来强制写入 updated_at 字段

```
foo.update_attribute :last_status, status
foo.touch
## log entry
##  UPDATE `foo` SET `updated_at` = '2013-07-25 19:56:36' WHERE `foo`.`id` = 55 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T18:59:24.860

似乎`update_attribute`只有在当前时间和您尝试设置的新时间相差至少一秒时才会看到变化。我在 activerecord 代码中找不到发生这种情况的位置，但这说明了问题所在。我创建了两次，100ms appart，第一次更新记录，但第二次更新没有提交到数据库。

```
[15] pry(main)> x=Time.now;sleep(0.1);y=Time.now
=> 2013-02-20 12:06:57 -0600

[16] pry(main)> x.strftime("%Y-%m-%d %H:%M:%S.%L")
=> "2013-02-20 12:06:57.185"

[17] pry(main)> y.strftime("%Y-%m-%d %H:%M:%S.%L")
=> "2013-02-20 12:06:57.286"

[18] pry(main)> kat = Kitten.first
  Kitten Load (1.2ms)  SELECT "kittens".* FROM "kittens" LIMIT 1
=> #<Kitten id: 1,  queued_at: "2013-02-13 20:38:00">

[19] pry(main)> kat.queued_at = x
=> 2013-02-20 12:06:57 -0600

[20] pry(main)> kat.save
   (0.5ms)  BEGIN
   (0.6ms)  UPDATE "kittens" SET "queued_at" = '2013-02-20 18:06:57.185870' WHERE "kittens"."id" = 1
   (1.3ms)  COMMIT
=> true

[21] pry(main)> kat.queued_at = y
=> 2013-02-20 12:06:57 -0600

[22] pry(main)> kat.save
   (0.2ms)  BEGIN
   (0.2ms)  COMMIT
=> true 
```

# sql - 使用 Sum 更新查询

> ID：14987824
> 
> 赞同：1
> 
> 时间：2013-02-20T18:59:33.373
> 
> 标签：sql, sql-server, select, sum

我有 2 个遇到问题的代码。我看了一些其他的答案，但完全糊涂了。这是SQL代码..（它是一个Access，SQL pass thru query）

```
UPDATE    TOP (500) InventorySuppliers
SET              BoydQuantityAvailable = SUM(Boyd0004Daily.QOH), Cost = Boyd0004Daily.Cost
FROM         Boyd0004Daily INNER JOIN
                      InventorySuppliers ON Boyd0004Daily.LocalSKU = InventorySuppliers.LocalSKU
WHERE     (InventorySuppliers.SupplierID = 4) AND (NOT (InventorySuppliers.BoydQuantityAvailable = SUM(Boyd0004Daily.QOH))) OR
                      (InventorySuppliers.SupplierID = 4) AND (NOT (InventorySuppliers.Cost = Boyd0004Daily.Cost)) 
```

它不喜欢 SUM(Boyd0004Daily.QOH) 上的更新，但在我的一生中，我无法弄清楚如何重写它，所以它进行选择，然后使用 1 个查询进行更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:01:08.880

您缺少一个`group by`. 任何时候使用聚合函数时，都必须包含一个分组依据，该分组依据包含所有未聚合的列。

你也在`SUM`你的`WHERE`子句中使用它不起作用。当您想根据聚合过滤结果时，您必须`HAVING`改用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:29:52.033

您要做的第一件事是让选择正确：

```
select *
from InventorySuppliers i
inner join (select LocalSKU, SUM(QOH) QOH_SUM, MAX(Cost) Cost --max or min
            from Boyd0004Daily
            group by LocalSKU) a 
        on a.LocalSKU = i.LocalSKU
where i.SupplierID = 4
and ((i.BoydQuantityAvailable != a.QOH_SUM))
    OR i.Cost != a.Cost)) 
```

然后将您的选择转换为更新：

```
update i
set i.BoydQuantityAvailable = a.QOH_SUM,
    i.Cost = a.Cost
from InventorySuppliers i
inner join (select LocalSKU, SUM(QOH) QOH_SUM, MAX(Cost) Cost --max or min
            from Boyd0004Daily
            group by LocalSKU) a 
        on a.LocalSKU = i.LocalSKU
where i.SupplierID = 4
    and ((i.BoydQuantityAvailable != a.QOH_SUM))
        OR i.Cost != a.Cost)) 
```

我认为这个查询应该适合你。我可能有错误，因为我无法测试您的数据。

# php - PHP Gearman - 没有可用工人时空闲

> ID：14987829
> 
> 赞同：0
> 
> 时间：2013-02-20T18:59:56.043
> 
> 标签：php, gearman

当所有工作人员都在工作时，是否可以让客户端空闲？

我有以下情况：

```
$client= new GearmanClient();
$client->addServer();

$data = array(thousands of entries);

foreach($data as $dt) {
    $client->doBackground('doFancy', $dt);
} 
```

当我运行它时，它会产生数千个队列，甚至会使内存过载。

在 foreach 循环继续分配新工作之前，是否可以等待工作人员空闲？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T11:36:16.030

您可以为队列大小创建计数器并为完成事件设置回调。在此回调中，您必须递减计数器并检查计数器，如果它的值小于 N - 将添加新的任务组并且计数器递增。

# full-text-search - 匹配项数

> ID：14987838
> 
> 赞同：1
> 
> 时间：2013-02-20T19:00:18.633
> 
> 标签：full-text-search, ravendb

我在几个不同的地方看了看，并没有找到这个问题的答案。我希望有人可以在这里找到答案。

使用 ravendb 时是否可以在查询中包含匹配的搜索词数量？

如果我有一些文档包含具有任意值组合的字符串列表：“黄色”、“蓝色”、“红色”。给定搜索词“黄色红色”，是否有可能返回结果说明：

```
X records matched 2 terms.
Y records matched 1 term. 
```

谢谢，

詹姆士

# android - Resources$ResourcesNotFound：资源不是可绘制的

> ID：14987841
> 
> 赞同：0
> 
> 时间：2013-02-20T19:00:39.710
> 
> 标签：android, android-layout, xml-parsing

我正在努力寻找解决此错误的方法：

```
02-20 19:50:36.027: E/AndroidRuntime(26842): FATAL EXCEPTION: main
02-20 19:50:36.027: E/AndroidRuntime(26842): android.view.InflateException: Binary XML file line #2: Error inflating class <unknown>
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.LayoutInflater.createView(LayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.LayoutInflater.onCreateView(LayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.LayoutInflater.inflate(LayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.LayoutInflater.inflate(LayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.LayoutInflater.inflate(LayoutInflater.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at Utility.AdapterListaLinee.getView(AdapterListaLinee.java:59)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.AbsListView.obtainView(AbsListView.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.ListView.makeAndAddView(ListView.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.ListView.fillDown(ListView.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.ListView.fillFromTop(ListView.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.ListView.layoutChildren(ListView.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.AbsListView.onLayout(AbsListView.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.RelativeLayout.onLayout(RelativeLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.layout(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.layout(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewRootImpl.performLayout(ViewRootImpl.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.Choreographer.doCallbacks(Choreographer.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.Choreographer.doFrame(Choreographer.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.os.Handler.handleCallback(Handler.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.os.Handler.dispatchMessage(Handler.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.os.Looper.loop(Looper.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.app.ActivityThread.main(ActivityThread.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at java.lang.reflect.Method.invokeNative(Native Method)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at java.lang.reflect.Method.invoke(Method.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at dalvik.system.NativeStart.main(Native Method)
02-20 19:50:36.027: E/AndroidRuntime(26842): Caused by: java.lang.reflect.InvocationTargetException
02-20 19:50:36.027: E/AndroidRuntime(26842):    at java.lang.reflect.Constructor.constructNative(Native Method)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at java.lang.reflect.Constructor.newInstance(Constructor.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    ... 51 more
02-20 19:50:36.027: E/AndroidRuntime(26842): Caused by: android.content.res.Resources$NotFoundException: Resource is not a Drawable (color or path): TypedValue{t=0x2/d=0x7f010070 a=-1}
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.content.res.Resources.loadDrawable(Resources.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.content.res.TypedArray.getDrawable(TypedArray.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.<init>(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.View.<init>(View.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.view.ViewGroup.<init>(ViewGroup.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    at android.widget.RelativeLayout.<init>(RelativeLayout.java)
02-20 19:50:36.027: E/AndroidRuntime(26842):    ... 53 more 
```

来自 styles.xml 的一些相关代码：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
    <style name="AppTheme" parent="Theme.Sherlock.Light.DarkActionBar">
        <item name="android:windowActionBarOverlay">true</item>
        <item name="android:windowActionModeOverlay">true</item>
        <item name="android:actionBarStyle">@style/ActionBar</item>
        <item name="ColSfondo">#00000000</item>
        <item name="ColSfondoVociListe">@drawable/SfondoVociListe</item>
        <item name="ColSfondoVoceInfotraffico">#00000000</item>
        <item name="ColTestoFields">#ff000000</item>
        <item name="ColTestoVociListe">@drawable/ColoreTestoVoci</item>
    </style>

    <style name="AppThemeDark" parent="Theme.Sherlock.Light.DarkActionBar">
        <item name="android:windowActionBarOverlay">true</item>
        <item name="android:windowActionModeOverlay">true</item>
        <item name="android:actionBarStyle">@style/ActionBar</item>
        <item name="ColSfondo">@drawable/holo_background_gradient</item>
        <item name="ColSfondoVociListe">#00000000</item>
        <item name="ColSfondoVoceInfotraffico">@drawable/holo_background_gradient</item>
        <item name="ColTestoFields">#ffffffff</item>
        <item name="ColTestoVociListe">@drawable/ColoreTestoVoci</item>
    </style>

    <attr name="ColSfondo" format="color|reference" />
    <attr name="ColSfondoVociListe" format="color|reference" />
    <attr name="ColSfondoVoceInfotraffico" format="color|reference" />
    <attr name="ColTestoFields" format="color|reference" />
    <attr name="ColTestoVociListe" format="color|reference" />

    <drawable name="ColoreTestoVoci">#ffffffff</drawable>
    <drawable name="SfondoVociListe">#dd212121</drawable>
    <color name="ColoreSecondarioVoci">#ffdddddd</color>

 [...]

</resources> 
```

这是导致问题的 xlm 布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="?attr/ColSfondoVociListe" >

    <ImageView
        android:id="@+id/ListaLineeImage"
        android:layout_width="36dp"
        android:layout_height="36dp"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:src="@drawable/ic_lista" />

    <TextView
        android:id="@+id/ListaLineeTitolo"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:layout_toRightOf="@+id/ListaLineeImage"
        android:gravity="center_vertical"
        android:text="Medium Text"
        android:textColor="?ColTestoVociListe"
        android:textSize="@dimen/Titolo" />

</RelativeLayout> 
```

如果我删除“？ColTestoVociListe”和“？attr/ColSfondoVociListe”，用#aarrggbb 之类的颜色替换它们就可以了。但我需要使用属性来改变颜色和主题。在其他 xml 文件中，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:background="?attr/ColSfondoVociListe" >

  [.....]

</RelativeLayout> 
```

没有错误被抛出！！！！为什么？？？？相同的属性，拼写完全相同。我尝试了很多次删除和重新创建 R.java 并清理项目。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-17T09:10:28.220

[这里](https://stackoverflow.com/questions/8041537/how-to-reference-style-attributes-from-a-drawable/13471695#13471695)有同样的问题

为了制作您的主题，您需要：

每个主题创建一个 xml drawable。使用@color 标签或#RGB 格式将所需的颜色直接包含到drawable 中。

```
<shape xmlns:android="http://schemas.android.com/apk/res/android">
  <stroke android:width="1dp" android:color="#123456" />
</shape> 
```

在 attrs.xml 中为您的可绘制对象创建一个属性。

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
   <!-- attributes mut be low case as we want to use them for drawables -->
   <attr name="my_drawable" format="reference" />
</resources> 
```

将您的可绘制对象添加到您的 theme.xml。

```
<style name="MyTheme" parent="@android:style/Theme.NoTitleBar">
   <item name="my_drawable">@drawable/my_drawable</item>
</style> 
```

使用您的属性在布局中引用您的可绘制对象。

```
<TextView android:background="?my_drawable" /> 
```

# linear-programming - .lp 格式到 .zpl

> ID：14987843
> 
> 赞同：0
> 
> 时间：2013-02-20T19:00:44.737
> 
> 标签：linear-programming

我正在尝试将程序从 .lp 格式转换为 .zpl，但在转换我的实际程序之前，我试图转换一个简单的问题以弄清楚 .zpl 格式将如何工作。使用 .zpl 让我很困惑，我可以使用一些帮助

这是.lp格式的程序

```
 Max : 3 x + 5 y;

 x <= 4;
 2 y <= 12;
 3 x + 2 y <= 18;
 x >= 0;
 y >=0; 
```

这是我尝试转换为 .zpl，第一行的分号出现错误

```
maximize cost : 3*x + 5*y;

subto 1 : x <= 4;
subto 2 : 2*y <= 12;
subto 3 : 3*x + 2*y <= 18;
subto 4 : x >= 0;
subto 5 : y >= 0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:35:20.833

如果我正确解释了[Zimpl 手册](http://zimpl.zib.de/download/zimpl.pdf)第 4 节，您需要在定义目标和约束之前声明变量，即您需要从以下内容开始：

```
# Variable definitions
var x >= 0;
var y >= 0; 
```

*LPsolve*显然支持使用特定驱动程序从*.lp文件生成**.zpl文件，请参阅*[此](http://lpsolve.sourceforge.net/5.5/Zimpl.htm)链接。

# c++ - 将派生自元组的对象放入 C++ 中的向量中

> ID：14987847
> 
> 赞同：6
> 
> 时间：2013-02-20T19:00:52.290
> 
> 标签：c++, inheritance, vector, c++11, tuples

我想创建一个具有 3 个值的结构：一个字符串和两个整数。该字符串是必需的，但其中一个（或两个）整数是可选的，如果未指定，则可以默认为 -1。

然而，与其使用结构，我想我会尝试一个 std::tuple。为了合并两个整数的可选性，我设置了一个继承自 std::tuple 的“Trio”类，如下所示：

```
#include <string>
#include <tuple>

class Trio : public std::tuple<std::string, int, int>
{
    public:

    explicit Trio(std::string const & name, int val1 = -1, int val2 = -1)
    :
        tuple(name, val1, val2)
    {
    }
}; 
```

然后我通过将一些 Trio 对象推入 std::vector 来测试 Trio 类：

```
#include <vector>
int main(void)
{
    std::vector<Trio> trios;

    Trio trio("trio1", 1, 1);
    trios.push_back(trio);

    return 0;
} 
```

它在 Visual Studio 2010 中给了我以下错误：

```
>c:\program files (x86)\microsoft visual studio 10.0\vc\include\tuple(127):
    error C2664: 'std::basic_string<_Elem,_Traits,_Ax>::basic_string(const
    std::basic_string<_Elem,_Traits,_Ax> &)' : cannot convert parameter 1
    from 'const Trio' to 'const std::basic_string<_Elem,_Traits,_Ax> &'
 with
 [
     _Elem=char,
     _Traits=std::char_traits<char>,
     _Ax=std::allocator<char>
 ]
 Reason: cannot convert from 'const Trio' to 'const
 std::basic_string<_Elem,_Traits,_Ax>'
 with
 [
     _Elem=char,
     _Traits=std::char_traits<char>,
     _Ax=std::allocator<char>
 ]
 No user-defined-conversion operator available that can perform
 this conversion, or the operator cannot be called 
```

有谁明白我在这里做错了什么？有什么我没有看到的明显的东西吗？我是不是严重滥用了 std::tuple 的使用？

谢谢，

亚伦

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-20T19:15:55.257

这是VC10的一个**bug**。

VC10 抱怨是因为你的类似乎没有*复制*构造函数。因此，为了复制 type 的值`Trio`，它会尝试将它们转换为`string`，这是您提供的构造函数所接受的（可以为其他参数提供默认值）。这就是您抱怨的错误：

> 无法将参数 1 从 'const Trio' 转换为 'const std::basic_string<_Elem,_Traits,_Ax> &'

您可以通过显式添加复制构造函数来验证这确实是发生了什么，并观察错误消失：

```
Trio(Trio const& t) { *this = t; } 
```

现在 VC10 很满意，因为它看到了一个复制构造函数，并且代码编译得很好。

然而，当用户没有明确提供复制构造函数时，您的编译器应该隐式生成一个。根据 C++11 标准的第 12.8/7 段：

> **如果类定义没有显式声明复制构造函数，则隐式声明一个**。如果类定义声明了移动构造函数或移动赋值运算符，则隐式声明的复制构造函数定义为已删除；否则，它被定义为默认值（8.4）。[...]

类`Trio`没有显式声明任何复制构造函数。根据 C++11 标准的第 12.8/2 段，实际上：

> 类 X 的非模板构造函数是复制构造函数**，如果它的第一个参数是 X&、const X&、volatile X& 或 const volatile X& 类型**，并且没有其他参数，或者所有其他参数都有默认参数（8.3.6 )

因此，您显式提供的构造函数*不是*复制构造函数，不应*禁止*隐式生成复制构造函数。

VC10 可能将您提供的构造函数误解为复制构造函数，因此不会隐式生成一个。然而，由于上面写的内容，这种行为是不正确的，属于**错误**。(*)

附带说明一下，您的代码在 Clang 3.2、GCC 4.7.2 和 ICC 13.0.1 上编译得很好。

**更新：**

*我试图用不涉及的更简单的数据结构来重现这个问题，但`std::tuple<>`我失败了。因此，该错误不仅仅是因为您的构造函数被 VC10 误解为显式复制构造函数。但是，这并不能改变 VC10 的行为不正确的事实。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:10:59.343

看起来这只是VS2010中的一个问题。我没有查看是否有关于它的错误。这将在 VS2012 和[gcc-4.7.2中编译](http://goo.gl/U3GEZ)

# vb.net - 自动拆分文本的数字

> ID：14987848
> 
> 赞同：0
> 
> 时间：2013-02-20T19:00:55.410
> 
> 标签：vb.net, textbox

我正在尝试输入 IP `1 textbox`，当我按 OK 时，必须分成 4 部分，例如：

> 123.123.123.123

并拆分为`textbox1`,2,3,4`[123] [123] [123] [123]`一切都可以，但如果我输入更多数字 123.123.123.123.123.123.123 我会出错。

```
 Dim str As String = TextBox1.Text
    Dim splitStr As String() = str.Split(".")
    TextBox1.Text = splitStr(0).ToString()
    TextBox2.Text = splitStr(1).ToString()
    TextBox3.Text = splitStr(2).ToString()
    TextBox4.Text = splitStr(3).ToString() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T23:11:09.150

这涵盖了大多数输入错误：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    TextBox2.Text = ""
    TextBox3.Text = ""
    TextBox4.Text = ""

    Dim str As String = TextBox1.Text
    str = str.Trim
    Dim splitStrs As String() = str.Split("."c)

    If splitStrs.Length <> 4 Then
        MsgBox("Not a valid IP format")
        Exit Sub
    End If

    For Each value As String In splitStrs
        If value.Length < 1 OrElse value.Length > 3 Then
            MsgBox("Not a valid IP format")
            Exit Sub
        End If

        If Not Integer.TryParse(value, 0) Then
            MsgBox("Not a valid IP format")
            Exit Sub
        End If

        If value.Contains(" ") Then
            MsgBox("Not a valid IP format")
            Exit Sub
        End If
    Next
    TextBox1.Text = splitStrs(0).ToString()
    TextBox2.Text = splitStrs(1).ToString()
    TextBox3.Text = splitStrs(2).ToString()
    TextBox4.Text = splitStrs(3).ToString()
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:02:59.120

将字符串的长度限制为 15 个字符

4 x 3 个字符“000”加上 3 个分隔符“.”

共 15 个字符

# matlab - 主动轮廓实现

> ID：14987849
> 
> 赞同：0
> 
> 时间：2013-02-20T19:00:58.227
> 
> 标签：matlab

嗨，我有兴趣学习主动轮廓。我在网上搜索了一些代码来理解，但似乎它们的示例是特定于应用程序的。任何人都可以提供一个简单实现的链接或示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-11T05:22:07.620

有两种活动轮廓模型：参数可变形模型和几何可变形模型。我从事参数化可变形模型的工作，想向您介绍一个很棒的代码：

参数化变形模型代码：

[iacl.ece.jhu.edu/Projects/gvf/](http://iacl.ece.jhu.edu/Projects/gvf/)

由GVF的作者徐写。他在自己的代码中完成了传统的主动模型、气球模型、距离图和 GVF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T16:11:35.733

抱歉，如果为时已晚。当我对活动轮廓几乎一无所知时，我查找了 Matlab Exchange，并发现下面链接中的代码很有帮助：

[http://www.mathworks.co.uk/matlabcentral/fileexchange/28149-snake-active-contour](http://www.mathworks.co.uk/matlabcentral/fileexchange/28149-snake-active-contour)

代码中有很多注释解释了每个选项的作用，如果您查看引用的论文（我强烈建议您这样做），您将能够调整这些选项以满足您的项目需求。那里也有一些简单的例子。

我只用过2D版本，所以无法评价3D版本的效果。我发现 2D 版本很容易介绍主动轮廓算法。

警告一句，代码中调用的 interp2 函数很慢，您可能想用更快的选项替换它。

# dart - 编写使用 DOM 的单元测试

> ID：14987852
> 
> 赞同：1
> 
> 时间：2013-02-20T19:01:02.703
> 
> 标签：dart

我有一些适用于 DOM 的功能，特别是处理调整元素的大小。[我在这里](http://www.dartlang.org/articles/dart-unit-tests/)查看了单元测试文档，找不到任何关于这样做的内容。是否可以？是否有任何现有的文档显示如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T17:23:25.773

试试 DumpRenderTree - 输出文本版布局的无头 chrome。

例如：

```
Content-Type: text/plain
layer at (0,0) size 808x820
  RenderView at (0,0) size 800x600
layer at (0,0) size 800x820
  RenderBlock {HTML} at (0,0) size 800x820
    RenderBody {BODY} at (8,8) size 784x804
      RenderHTMLCanvas {CANVAS} at (0,0) size 800x800 [bgcolor=#808080]
      RenderText {#text} at (0,0) size 0x0
#EOF
#EOF 
```

Kevin Moore 的博文[“使用 Dart 进行无头浏览器测试”](http://work.j832.com/2013/01/headless-browser-testing-dart.html)解释了细节（上面的片段取自该）

# javascript - 创建一个表并在弹出窗口中填充它

> ID：14987855
> 
> 赞同：4
> 
> 时间：2013-02-20T19:01:15.543
> 
> 标签：javascript, html

我有一个 HTML 文件。我想动态创建一个表格，在弹出窗口中填充它。表数据将来自本地数据库。有人可以告诉我如何解决这个问题吗？我是 javascript 的新手，所以非常感谢任何帮助。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T06:52:50.293

您可能还会发现 Knockout.JS [http://knockoutjs.com/](http://knockoutjs.com/)与以前的答案建议结合使用，有助于在您通过 jQuery 的 AJAX 获取数据后帮助填充和操作表中的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:26:34.477

如果你有 jQuery 和 Bootstrap 可供使用，那么这将是一个很好的例子，两个库可以协同工作来帮助你。

如果是这样，

通过 Ajax 请求您的数据将是您最好的选择。查看 jQuery $.post() 方法。在内部，jQuery ajax 实现有超过 800 行代码来获得跨浏览器的投诉。我建议利用其他开发人员的工作，而不是在没有 jQuery 的情况下编写 ajax 实现。

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

获得数据后，您可以使用 View 模板或 JavaScript 将其填充到表格中。

如果你有 Bootstrap，一个 CSS“框架”，你可以用它来真正给你的表格一个整洁的外观。将您的表格元素分配给“table”和“table-striped”类，这将使您的表格看起来整洁干净。这是 Bootstrap 的文档，

[http://twitter.github.com/bootstrap/base-css.html#tables](http://twitter.github.com/bootstrap/base-css.html#tables)

就弹出窗口而言，bootstrap 提供的模态窗口是用户友好的弹出窗口的一种非常简单的实现。

[http://twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)

如果您没有这些工具，那么我建议您使用它们或发起一个活动来使用它们。他们是跨浏览器的投诉，可以节省很多时间。

祝你好运！

# oracle - 甲骨文：只允许有评论的更新

> ID：14987856
> 
> 赞同：0
> 
> 时间：2013-02-20T19:01:28.790
> 
> 标签：oracle, triggers, comments, procedure

这个问题可能有点奇怪。但我正在寻找一种仅在用户发表评论时才允许更新表格的方法。更新普通表时，注释应保存在第二个审计表中。
我认为在 oracle 中，用户无法在执行“更新表集...”时发表评论。

所以我创建了自己的程序，用户可以在其中将语句和注释作为参数传递。没有此过程的更新会被触发器阻止。

```
create or replace
    PROCEDURE Update_Table(stmt varchar2, comment varchar2) AS 
    BEGIN
        Insert into audit_table values(stmt, comment);
        Execute immediate stmt;
END Update_Table; 
```

我对这个解决方案并不满意。所以也许有更简单的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T19:15:37.450

标准方法是防止用户`UPDATE`针对基表发出语句。通常，您会撤消`UPDATE`权限，然后创建一个存储过程（大概在一个包中，以及`INSERT`在该表上执行其他类型的 DML 操作的过程），您授予用户使用权限。然后，您的用户将调用存储过程，传入注释，并且存储过程将在实际更新表之前执行任何必要的验证。

如果出于某种原因您确实需要让用户能够发出显式`UPDATE`语句，您是否可以要求他们在发出`UPDATE`语句之前调用存储过程？如果是这样，您可以创建一个包，其中包含一个用于注释的包级变量和一个设置注释的过程，然后在表上创建一个触发器，从这个包级变量中读取数据，如果不是则抛出异常设置，并执行您需要的任何日志记录。

另一种选择是将`comment`列实际添加到表本身以存储最后修改的注释，然后创建一个语句级触发器，将注释写入单独的表，并在表上设置一个强制`comment`设置的约束。

正如@a_horse_with_no_name 建议的那样，您还可以撤消对表的访问权限，创建一个包含该`comment`列的视图，然后编写一个`INSTEAD OF UPDATE`触发器来检查该语句是否将`comment`列设置为适当的值，然后针对基础发出适当的 DML表。

# ssl - cacert.pem 到底是做什么用的？

> ID：14987857
> 
> 赞同：40
> 
> 时间：2013-02-20T19:01:40.767
> 
> 标签：ssl, curl, ssl-certificate

在我的 PayPal Pro 支付页面中，我使用 cURL 功能`curl_setopt_array(`）和以下选项：`cUIn CURLOPT_CAINFO => dirname(__FILE__) . '/cacert.pem'.`

工作正常，但即使经过一些研究，我也不明白究竟是什么`cacert.pem`。我不明白到处提到的“验证反对”的概念。`.csr/.crt`这个文件和我买给我的提供商的证书有什么关系？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-20T19:17:42.387

**cacert.pem**是一组 CA 证书，您可以使用它来验证服务器确实是您正在与之交谈的正确站点（当它在 SSL 握手中提供其证书时）。该捆绑包可以由 curl 或 wget 等工具以及其他使用 TLS/SSL 的软件使用。*该捆绑包应包含您信任*的 CA 的证书。此捆绑包有时称为“CA 证书存储”。

例子：

```
curl --cacert cacert.pem https://example.com 
```

在 curl 项目中，提供了一个[cacert.pem](https://curl.se/docs/caextract.html)，它是从 Mozilla 为 Firefox 提供的 ca 证书转换而来的。

它是通过使用数字签名来完成的。有关什么是 CA（[证书颁发机构](https://en.wikipedia.org/wiki/Certificate_authority)）的完整说明，请参阅 wikipedia。

# php - symfony i18n objects (Doctrine) 获取特定的文化

> ID：14987859
> 
> 赞同：0
> 
> 时间：2013-02-20T19:01:50.787
> 
> 标签：php, internationalization, doctrine, symfony-1.4

我遇到了无法从 i18n 教义对象中检索特定翻译的问题。如果我打电话`$object->getName();`，我会按预期得到当前文化中的名字。但是，如果我希望在不切换用户文化的情况下检索特定翻译......`$object->getName('fr');`在此示例中，我仍然获得当前文化而不是法语。不过，这`$object->getTranslation()->fr->name;`确实有效。我究竟做错了什么？这不是`$object->getName($culture);`正确的方法吗？

如果有帮助，这是我的架构的相关部分：

```
Object:
  actAs:
    Timestampable: ~
    I18n:
      fields:           [name, description]
  columns:
    name:               { type: string(255), notnull: true }
    description:        { type: string(1000) }
    user_id:            { type: integer }
  relations:
    User:               { class: sfGuardUser, local: user_id, foreign: id, type: one, foreignType: many, foreignAlias: Objects } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T07:47:32.867

```
$this->Translation['fr']->getName() 
```

或者：

```
$translations = $this->getTranslations();
$translations['fr']->getName(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T16:16:09.337

[这与您的其他问题](https://stackoverflow.com/q/14988309/569101)几乎相同，请使用：

```
$object->Translation['fr']->name;
$object->Translation['en']->name;
$object->Translation['it']->name;
// etc ... 
```

我引用我在另一个问题上发表的评论：

> `->getName()`如果您直接使用对象，则可以使用，例如 `$object->getName()`. 但是如果你点击 Translation 关系，我从不使用 getter 来检索值。

顺便说一句，我不记得我们可以将它`$object->getName('fr');`与 sf1.0 一起使用。

# mysql - mysql_real_escape-string 函数中的错误未转义特殊字符

> ID：14987862
> 
> 赞同：0
> 
> 时间：2013-02-20T19:02:02.577
> 
> 标签：mysql

我正在使用 mysql_real_escape_string 函数从文本中转义特殊字符以将数据插入到数据库中。如果我使用变量它不起作用。

```
echo  $ab=$_POST['textarea'];
when I print $ab it is showing like the following text;
$ab= ction throws js error we'll special charac
echo $av=mysql_real_escape_string($av); 
```

当我打印 $av 时，它显示以下字符串

```
ction throws js error we'll special charac 
```

当我在插入查询中使用 $av 值时，它仅在数据库中插入一半测试“操作引发 js 错误我们”。请让我知道我该如何解决。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:58:19.203

首先，请不要将`mysql_*`函数用于新代码。它们已被[弃用](http://php.net/manual/en/intro.mysql.php)。对[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)使用 [准备好的语句](http://goo.gl/vn8zQ)。

现在，如果您仍然坚持使用`mysql_*`扩展名，请执行以下操作

```
$ab="";
if (isset($_POST['textarea']) && $_POST['textarea']) {
    $ab = $_POST['textarea'];
}
if (!$db = mysql_connect('mysql_host', 'mysql_user', 'mysql_password')) {
    //connection error
} 
if (!mysql_select_db('dbname', $db)) {
    //error selecting db
}
if (!$ab = mysql_real_escape_string($ab)) {
    //error while escaping
}
$query = sprintf("INSERT INTO table VALUES('%s')", $ab);
if (!mysql_query($query)) {
    //error executing query
} 
```

*为简洁起见，故意省略了错误处理代码*

# autoit - 如何编写 AutoIt 脚本以将可执行文件从本地运行到另一个位置

> ID：14987864
> 
> 赞同：0
> 
> 时间：2013-02-20T19:02:05.127
> 
> 标签：autoit

这是我在 DOS 命令中运行的内容

```
c:\folder\a.exe d:\ E:\ 
```

但是如何使用[AutoIt](http://en.wikipedia.org/wiki/AutoIt)编写一个批处理文件来运行它呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-21T10:18:31.800

你的问题非常不清楚和模糊，所以它真的不符合伟大的提示......无论如何，一些帮助：

*   您可以通过 AutoIt 运行完全相同的命令，例如`Run("c:\folder\a.exe d:\ E:\")`.
*   或者您可以将此命令写入批处理文件**command.bat**，`FileWrite("command.bat", "c:\folder\a.exe d:\ E:\")`就像您要求的那样。最后，您可以使用 运行此批处理文件`Run("command.bat")`，这将为您打开一个命令提示符...最后您可以首先将文件名保存到变量中`$batchfile = "command.bat"`，其次是 `FileWrite($batchfile, "c:\folder\a.exe d:\ E:\")`在最后`Run($batchfile)`避免冗余。
*   最好的帮助是阅读[Run](http://www.autoitscript.com/autoit3/docs/functions/Run.htm)的文档。在那里你会找到一个关于如何运行 dos 命令的完美解释：`Run(@ComSpec & " /c " & 'commandName', "", @SW_HIDE)`- 如果你想看到命令提示符，你可以省略最后两个参数。如果您需要特定的工作目录，只需将其作为第二个参数输入即可。

# mobile - 如何切换移动版本以查看完整的网站..？但我的索引页上有这段代码

> ID：14987865
> 
> 赞同：0
> 
> 时间：2013-02-20T19:02:13.030
> 
> 标签：mobile, web, http-redirect

```
 <script type="text/javascript">
    if (screen.width <=600)
    {
      document.location = "http://www.manyweb.com/" 
        }    

    </script>   --> 
```

如何将移动网站重定向到桌面版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T09:33:09.737

不是很清楚的问题，但我建议使用 jQuery 之类的东西，而不是使用

```
$(document).width(); 
```

您可以使用调试（萤火虫或其他）来检查您的代码是否有效

# asp.net-mvc - 具有已定义范围的 .NET ASP.NET MVC 应用程序 Facebook OAuth

> ID：14987868
> 
> 赞同：3
> 
> 时间：2013-02-20T19:02:19.273
> 
> 标签：asp.net-mvc, facebook, asp.net-mvc-4, oauth

使用具有定义范围的 Facebook [OAuth](http://en.wikipedia.org/wiki/OAuth)创建[.NET](http://en.wikipedia.org/wiki/.NET_Framework) [ASP.NET MVC应用程序的最简单方法是什么？](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)

我尝试了很多例子。[OAuthWebSecurity.RegisterClient](http://www.asp.net/mvc/overview/getting-started/using-oauth-providers-with-mvc)不支持添加更多 Facebook 范围。[Facebook 应用程序模板](http://www.asp.net/vnext/overview/fall-2012-update/facebook-application-template-tutorial)创建一个画布，我需要非画布应用程序。FacebookScopedClient 未满，无法使用此修复程序。

你有什么建议？

我也开放 JavaScript/jQuery 解决方案。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-26T11:06:07.743

可能我来得太晚了，但是我几天前遇到了这个问题，我在网上发现只有几个糟糕的解决方案。所以我写了自己的解决方案，我现在只能发布它。

我利用了完成大部分工作的 DotNetOpenAuth.AspNet.Clients.OAuth2Client 类。我只是将其扩展到包括范围和额外的用户数据。

```
public class FacebookExtendedClient : DotNetOpenAuth.AspNet.Clients.OAuth2Client
{   
    protected FacebookClient facebookClient;
    protected string fields;
    protected string scope;
    protected Func<string, object, string> fieldTransformer;
    protected bool emailAsUsername;
    protected IDictionary<string, string> userData;

    private string[] splittedFields;
    private string[] splittedScope;

    protected const string serviceLoginBaseUrl = "https://www.facebook.com/dialog/oauth";
    protected const string serviceMeBaseUrl = "https://graph.facebook.com/me";
    protected const string serviceAccessTokenBaseUrl = "https://graph.facebook.com/oauth/access_token";

    /// <summary>
    /// Create an instrance of the class.
    /// </summary>
    /// <param name="appId">The App ID of the application used to connect to Facebook service.</param>
    /// <param name="appSecret">The App Secret of the application used to connect to Facebook service.</param>
    /// <param name="fields">
    /// String containing comma separated fields to add to the request.
    /// If empty the request will retrieve the default fields based of the specified scope.
    /// </param>
    /// <param name="fieldTransformer">
    /// Function to be applied to the values retrived from facebook.
    /// If null provided the method will try to cast values from object to string explicitly,
    /// an InvalidCastException will be thrown if the cast will not be possible.
    /// </param>
    /// <param name="scope">
    /// String containing comma separated permissions to add to the request.
    /// If empty the request will have the basic scope.
    /// </param>
    /// <param name="emailAsUsername">Makes the email of the facebook user used as authentication username.</param>
    public FacebookExtendedClient(string appId, string appSecret, string fields = "", Func<string, object, string> fieldTransformer = null, string scope = "", bool emailAsUsername = false)
        : base("facebook")
    {
        if (string.IsNullOrEmpty(appId))
            throw new ArgumentException("The appId argument can not be null or empty.", "appId");
        if (string.IsNullOrEmpty(appSecret))
            throw new ArgumentException("The appSecret argument can not be null or empty.", "appSecret");

        fields = fields.Replace(" ", "");
        scope = scope.Replace(" ", "");
        this.splittedFields = fields.Split(',');
        this.splittedScope = scope.Split(',');

        if (emailAsUsername == true && !this.splittedFields.Contains("email") && !this.splittedScope.Contains("email"))
            throw new ArgumentException("The scope argument must contain the 'email' permission and the 'email' field to allow emailAsUsername to true.", "scope");

        this.facebookClient = new FacebookClient();
        this.facebookClient.AppId = appId;
        this.facebookClient.AppSecret = appSecret;
        this.fields = fields;
        this.fieldTransformer = fieldTransformer;
        this.scope = scope;
        this.emailAsUsername = emailAsUsername;
    }

    public FacebookClient FacebookClient
    {
        get
        {
            return this.facebookClient;
        }
    }

    public IDictionary<string, string> UserData
    {
        get
        {
            return this.userData;
        }
    }

    protected override Uri GetServiceLoginUrl(Uri returnUrl)
    {
        Dictionary<string, object> parameters = new Dictionary<string, object>();
        parameters.Add("redirect_uri", returnUrl.AbsoluteUri);

        if (!string.IsNullOrEmpty(this.scope))
            parameters.Add("scope", this.scope);

        return this.facebookClient.GetLoginUrl(parameters);
    }

    protected override IDictionary<string, string> GetUserData(string accessToken)
    {
        // This method makes the AuthenticationResult's UserName property be the facebook username of the logged user,
        // but if the facebook username is missing the facebook id will be used.
        // If emailAsUsername is true then AuthenticationResult's UserName property is the email retrieved from facebook
        // and the facebook username can be retrieved by the key "fb_username" in this.userData

        FacebookClient facebookClient = new FacebookClient(accessToken);

        var getResult = facebookClient.Get<IDictionary<string, object>>("me", new { fields = this.fields });
        Dictionary<string, string> result = new Dictionary<string, string>();

        if (this.fieldTransformer != null)
        {
            foreach (var pair in getResult)
                result.Add(pair.Key, this.fieldTransformer(pair.Key, pair.Value));
        }
        else
        {
            foreach (var pair in getResult)
            {
                string value = pair.Value.ToString();

                if (value == null)
                    throw new InvalidCastException("Cast not possible for the object associate to the key '" + pair.Key + "'.");

                result.Add(pair.Key, value);
            }
        }

        if (this.splittedFields.Contains("username"))
            result["fb_username"] = result["username"];

        if (this.emailAsUsername)
            result["username"] = result["email"];

        this.userData = result;

        return result;
    }

    protected override string QueryAccessToken(Uri returnUrl, string authorizationCode)
    {
        UriBuilder builder = new UriBuilder(serviceAccessTokenBaseUrl);
        builder.Query = string.Format("client_id={0}&client_secret={1}&redirect_uri={2}&code={3}",
            this.facebookClient.AppId, this.facebookClient.AppSecret, HttpUtility.UrlEncode(Encoding.ASCII.GetBytes(returnUrl.AbsoluteUri)), authorizationCode);

        using (WebClient client = new WebClient())
        {
            string str = client.DownloadString(builder.Uri);

            if (string.IsNullOrEmpty(str))
                return null;

            return HttpUtility.ParseQueryString(str)["access_token"];
        }
    }
} 
```

您也可以像这样在 OAuthWebSecurity 中注册它（将 RegisterAuth 方法放在 Application_Start 中，就像在 InternetApplication 模板中一样）：

```
public static class AuthConfig
{
    public static void RegisterAuth()
    {
        configuration.LoadFromAppSettings();

        OAuthWebSecurity.RegisterClient(new FacebookExtendedClient(
            "##YOUR_APP_ID##",
            "##YOUR_APP_SECRET##",
            "id,first_name,last_name,link,username,gender,email,age_range,picture.height(200)",
            new Func<string, object, string>(fieldsTransformer),
            "email"));
    }

    private static string fieldsTransformer(string key, object value)
    {
        switch (key)
        {
            case "picture":
                var data = (value as IDictionary<string, object>)["data"] as IDictionary<string, object>;
                return data["url"].ToString();
            case "age_range":
                var min = (value as IDictionary<string, object>)["min"];
                return min.ToString();
            default:
                return value.ToString();
        }
    }
} 
```

正如您在上面的示例中看到的，方法 fieldsTransformer 将获取所选字段的键和值，在这种情况下，它将 facebook 为图片检索的对象转换为图片的 url。这是一种方便的方法，如果为 Func 参数提供了 null，则将保存 values 对象的 JSON 表示。

稍后检索客户端信息，登录后，可以这样做：

```
[Authorize]
public class HomeController : Controller
{
    public ActionResult Index()
    {
        IDictionary<string, string> userData = (OAuthWebSecurity.GetOAuthClientData("facebook").AuthenticationClient as FacebookExtendedClient).UserData;
        string email = userData["email"];

        // If leave null the fieldTransform of the client you can access to complex properties like this:
        JObject picture = JObject.Parse(userData["picture"]);
        string url = (picture["data"] as JObject)["url"].ToString();

        ViewBag.Email = userData["email"];
        ViewBag.PictureUrl = url;
        return View();
    }
} 
```

希望你喜欢这段代码，即使有点晚了！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-02T03:49:22.743

我正在 VS 2013 中使用 C# MVC 5 Web 应用程序编写我的第一个 Facebook 应用程序。

在 AppStart\StartupAuth.cs 文件中，我做了以下修改。

确保类中有以下 using 语句：

```
using Microsoft.AspNet.Identity;
using Microsoft.Owin;
using Microsoft.Owin.Security.Cookies;
using Microsoft.Owin.Security.Facebook;
using Owin;` 
```

然后，在 ConfigureAuth 方法底部附近的 Facebook 身份验证部分：

```
FacebookAuthenticationOptions fbOptions = new FacebookAuthenticationOptions();
fbOptions.AppId="YOUR_APP_ID";
fbOptions.AppSecret="YOUR_APP_SECRET";
fbOptions.Scope.Add("user_about_me");
fbOptions.Scope.Add("user_actions.books");
fbOptions.Scope.Add("user_actions.music");
//...more at the bottom
fbOptions.Scope.Add("video_upload");
fbOptions.Scope.Add("xmpp_login");
app.UseFacebookAuthentication(fbOptions); 
```

而已！以下是截至 2014 年 2 月 1 日的完整列表：

```
fbOptions.Scope.Add("user_about_me");
fbOptions.Scope.Add("user_actions.books");
fbOptions.Scope.Add("user_actions.music");
fbOptions.Scope.Add("user_actions.news");
fbOptions.Scope.Add("user_actions.video");
fbOptions.Scope.Add("user_activities");
fbOptions.Scope.Add("user_birthday");
fbOptions.Scope.Add("user_checkins");
fbOptions.Scope.Add("user_education_history");
fbOptions.Scope.Add("user_events");
fbOptions.Scope.Add("user_friends");
fbOptions.Scope.Add("user_games_activity");
fbOptions.Scope.Add("user_groups");
fbOptions.Scope.Add("user_hometown");
fbOptions.Scope.Add("user_interests");
fbOptions.Scope.Add("user_likes");
fbOptions.Scope.Add("user_location");
fbOptions.Scope.Add("user_notes");
fbOptions.Scope.Add("user_online_presence");
fbOptions.Scope.Add("user_photo_video_tags");
fbOptions.Scope.Add("user_photos");
fbOptions.Scope.Add("user_questions");
fbOptions.Scope.Add("user_relationship_details");
fbOptions.Scope.Add("user_relationships");
fbOptions.Scope.Add("user_religion_politics");
fbOptions.Scope.Add("user_status");
fbOptions.Scope.Add("user_subscriptions");
fbOptions.Scope.Add("user_videos");
fbOptions.Scope.Add("user_website");
fbOptions.Scope.Add("user_work_history");

fbOptions.Scope.Add("friends_about_me");
fbOptions.Scope.Add("friends_actions.books");
fbOptions.Scope.Add("friends_actions.music");
fbOptions.Scope.Add("friends_actions.news");
fbOptions.Scope.Add("friends_actions.video");
fbOptions.Scope.Add("friends_activities");
fbOptions.Scope.Add("friends_birthday");
fbOptions.Scope.Add("friends_checkins");
fbOptions.Scope.Add("friends_education_history");
fbOptions.Scope.Add("friends_events");
fbOptions.Scope.Add("friends_games_activity");
fbOptions.Scope.Add("friends_groups");
fbOptions.Scope.Add("friends_hometown");
fbOptions.Scope.Add("friends_interests");
fbOptions.Scope.Add("friends_likes");
fbOptions.Scope.Add("friends_location");
fbOptions.Scope.Add("friends_notes");
fbOptions.Scope.Add("friends_online_presence");
fbOptions.Scope.Add("friends_photo_video_tags");
fbOptions.Scope.Add("friends_photos");
fbOptions.Scope.Add("friends_questions");
fbOptions.Scope.Add("friends_relationship_details");
fbOptions.Scope.Add("friends_relationships");
fbOptions.Scope.Add("friends_religion_politics");
fbOptions.Scope.Add("friends_status");
fbOptions.Scope.Add("friends_subscriptions");
fbOptions.Scope.Add("friends_videos");
fbOptions.Scope.Add("friends_website");
fbOptions.Scope.Add("friends_work_history");

fbOptions.Scope.Add("ads_management");
fbOptions.Scope.Add("ads_read");
fbOptions.Scope.Add("create_event");
fbOptions.Scope.Add("create_note");
fbOptions.Scope.Add("email");
fbOptions.Scope.Add("export_stream");
fbOptions.Scope.Add("manage_friendlists");
fbOptions.Scope.Add("manage_notifications");
fbOptions.Scope.Add("manage_pages");
fbOptions.Scope.Add("photo_upload");
fbOptions.Scope.Add("publish_actions");
fbOptions.Scope.Add("publish_checkins");
fbOptions.Scope.Add("publish_stream");
fbOptions.Scope.Add("read_friendlists");
fbOptions.Scope.Add("read_insights");
fbOptions.Scope.Add("read_mailbox");
fbOptions.Scope.Add("read_page_mailboxes");
fbOptions.Scope.Add("read_requests");
fbOptions.Scope.Add("read_stream");
fbOptions.Scope.Add("rsvp_event");
fbOptions.Scope.Add("share_item");
fbOptions.Scope.Add("sms");
fbOptions.Scope.Add("status_update");
fbOptions.Scope.Add("video_upload");
fbOptions.Scope.Add("xmpp_login"); 
```

# c# - html敏捷包解析表

> ID：14987878
> 
> 赞同：0
> 
> 时间：2013-02-20T19:02:43.310
> 
> 标签：c#, html-agility-pack

我有一张这样的桌子：

```
<table border="0" cellpadding="0" cellspacing="0" id="table2">
    <tr>
        <th>Name
        </th>
        <th>Age
        </th>
    </tr>
        <tr>
        <td>Mario
        </td>
        <th>Age: 78
        </td>
    </tr>
            <tr>
        <td>Jane
        </td>
        <td>Age: 67
        </td>
    </tr>
            <tr>
        <td>James
        </td>
        <th>Age: 92
        </td>
    </tr>
</table> 
```

我正在使用 html 敏捷包来解析它。我已经尝试过这段代码，但它没有返回预期的结果：这是代码：

```
foreach (HtmlNode tr in doc.DocumentNode.SelectNodes("//table[@id='table2']//tr"))
            {
                //looping on each row, get col1 and col2 of each row
                HtmlNodeCollection tds = tr.SelectNodes("td");
                for (int i = 0; i < tds.Count; i++)
                {
                    Response.Write(tds[i].InnerText);
                }
            } 
```

我得到每一列是因为我想对返回的内容进行一些处理。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:36:44.437

您可以从外部 foreach 循环中获取单元格内容：

```
foreach (HtmlNode td in doc.DocumentNode.SelectNodes("//table[@id='table2']//tr//td"))  
{  
    Response.Write(td.InnerText);   
} 
```

另外我建议修剪和“取消实体化内部文本以确保它是干净的：

```
Response.Write(HtmlEntity.DeEntitize(td.InnerText).Trim()) 
```

在您的来源中，[Age: 78] 和 [Age: 92] 的单元格`<th>`在开头有一个标签，而不是`<td>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T22:25:12.567

这是我的解决方案。请注意您的 HTML 格式不正确，因为您应该`TH`在哪里`TD`：

```
<table border="0" cellpadding="0" cellspacing="0" id="table2">
    <tr>
        <th>Name
        </th>
        <th>Age
        </th>
    </tr>
        <tr>
        <td>Mario
        </td>
        <td>Age: 78
        </td>
    </tr>
            <tr>
        <td>Jane
        </td>
        <td>Age: 67
        </td>
    </tr>
            <tr>
        <td>James
        </td>
        <td>Age: 92
        </td>
    </tr>
</table> 
```

这是c#代码：

```
using HtmlAgilityPack;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {

            HtmlAgilityPack.HtmlDocument document = new HtmlAgilityPack.HtmlDocument();
            document.Load("page.html");

            List<HtmlNode> x = document.GetElementbyId("table2").Elements("tr").ToList();

            foreach (HtmlNode node in x)
            {
                List<HtmlNode> s = node.Elements("td").ToList();
                foreach (HtmlNode item in s)
                {
                    Console.WriteLine("TD Value: " + item.InnerText);
                }
            }
            Console.ReadLine();
        }
    }
} 
```

截屏： ![在此处输入图像描述](../Images/3f23e636ddcf217beeaadc108c3729f9.png)

编辑：我必须补充一点，如果您要使用`<th>`标签，则必须将它们包含在`<thead>`标签中，然后将行包含在`<tbody>`标签中，以便您的 html 格式正确:)

更多信息：[http ://www.w3schools.com/tags/tag_thead.asp](http://www.w3schools.com/tags/tag_thead.asp)

# javascript - 在 jQuery 插件中引用时使用哪个 - $(obj) vs obj

> ID：14987883
> 
> 赞同：3
> 
> 时间：2013-02-20T19:02:55.130
> 
> 标签：javascript, jquery

我正在自学，目前正在处理 jQuery 插件。

我发现了一个样板，用于迭代页面上的元素，将 $(this) 分配给全局变量“obj”。

```
var obj = $(this); 
```

因此，在我的功能中，我可以使用其中一个`$(obj).someFunc()`或`obj.someFunc()`两个工作，但老实说，我真的不明白有什么区别。

那么问题来了，这两种方法的性能差异/好处是什么，我应该使用哪种方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:05:09.343

如果`obj`已经是一个 jQuery 对象，当你这样做的时候就是这种情况`var obj = $(this);`，那么就没有必要*再次*将它传递给 jQuery 。

`$(obj)`与 相同`$($(this))`，这显然是多余的。

查看[`jQuery`的文档*^([docs])*](http://api.jquery.com/jQuery/)也有助于了解您可以传递给什么`jQuery`（别名`$`）：

*   `jQuery( selector [, context ] )`
*   `jQuery( element )`
*   `jQuery( elementArray )`
*   `jQuery( object )`
*   `jQuery( jQuery object )`
*   `jQuery()`

您会看到传递 jQuery 对象是完全有效的，但它会*克隆*传递的对象，这可能不是您打算做的。

* * *

但是，可能值得指出的是，***在*jQuery 插件方法**内部，`this`已经是一个 jQuery 对象，因此您也不必将它传递给 jQuery。

更多信息在这里：[http](http://docs.jquery.com/Plugins/Authoring) ://docs.jquery.com/Plugins/Authoring 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:05:28.203

如果`obj.someFunc()`and`$(obj).someFunc()`两者都有效并且`someFunc`是一个 jQuery 函数，那么这意味着它`obj`是一个 jQuery 对象。

在那种情况下`$(obj)`只是一个多余的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:09:45.463

区别非常简单 - 在第一种情况下**$(obj).someFunc()** 您每次都调用 $() 。在第二种情况下**obj.someFunc()**，您只调用它一次，并将其结果存储在一个名为**obj的变量中**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T19:16:55.167

`var obj = $(this);`

就像您创建了一个 Class 的实例，您可以访问和使用`obj`，使用时更好：

```
`$(obj)` 
```

是冗余初始化，就像您创建了另一个类实例并为其分配了相同的对象。所以没有使用或者我说使用它有什么好处。

# java - 传递（指向 UInt8 数组的指针）并访问 Objective-C 中的数组

> ID：14987897
> 
> 赞同：0
> 
> 时间：2013-02-20T19:03:48.027
> 
> 标签：java, iphone, objective-c, xcode

我需要使用 UInt8 数组，但我不确定如何正确执行此操作...

这是我的代码：

```
@interface MyClass : NSObject {
    __strong id * myArray; //private byte[] myArray;  <- Java code
}
@property   (nonatomic,readwrite) __strong id * myArray;
@end 
```

这是 MyClass 中的一个方法：

```
-(int) getArray: (__strong id *) bufferTmp {

    NSString* aString = @"theString";
    int bytes  = aString.length;

    //now I need to fill the passed in array with the chars of the String
    for (int i = 0; i < bytes; i++) {
            char c = [aString characterAtIndex:i];
            ??? bufferTmp[i] = (UInt8)c;   <----- what to write here?
        }
return bytes;
} 
```

这就是我计划调用此方法来填充 myBuffer 的方式：

```
UInt8 myBuffer[10000];
[xxx read: myBuffer];       <-      how to do this correctly ????? 
```

这是等效的工作 Java 代码：

```
public int getArray(byte[] bufferTmp) {
    String theString = "theString";
    for (int i = 0; i < bytes; i++) {
        char c = theString.charAt(i);
        bufferTmp[i] = (byte) c;
        }
     return bytes;

 } 
```

这就是我在 Java 中调用此方法的方式：

```
 byte[] myBuffer = new byte[10000]; 
 int n = read(myBuffer); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:21:44.057

在 Objective-C 中，您可以使用`NSData`对象作为字节缓冲区，并`dataUsingEncoding`获得字符串的字节表示：

```
NSString *aString = @"theString";
NSData *myBuffer = [aString dataUsingEncoding:NSUTF8StringEncoding];

const char *bytes = [myBuffer bytes]; // pointer to the bytes in the buffer
NSUInteger count = [myBuffer length]; // number of bytes in the buffer 
```

# android - Android 切换视图

> ID：14987899
> 
> 赞同：0
> 
> 时间：2013-02-20T19:03:55.717
> 
> 标签：android, animation, layout, view, switch-statement

好的，所以我已经处理了从内部淡出的内容`id`（感谢[https://stackoverflow.com/a/4570977/971392](https://stackoverflow.com/a/4570977/971392)）。

我有以下功能：

```
public void switchView(View view) {
        LayoutInflater inflater = LayoutInflater.from(getBaseContext());
        View to_load = inflater.inflate(R.layout.activity_register, null, false); 

        RelativeLayout rl = (RelativeLayout) findViewById(R.id.content_login);
        Animation fadeOutAnim = AnimationUtils.loadAnimation(LoginActivity.this, R.anim.fadeout);
        rl.startAnimation(fadeOutAnim);
        //rl.setVisibility(View.GONE);
        //rl.removeView(view);
        rl.addView(to_load);
} 
```

它执行所需的操作，**如果我评论** `rl.startAnimation(fadeOutAnim)`仅用于在更改视图上提供动画的目的。

随着动画的执行，该函数通过 改变视图，`rl.addView()`但随后应用`fadeOut`并且一切都消失了。

那么，我如何使用淡出而不删除我的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:13:20.120

您需要将`rl.addView(to_load);`呼叫延迟到淡出动画完成之后。做到这一点的方法是使用动画侦听器。

试试这样：

```
AnimationListener animListen = new AnimationListener() {
    public void onAnimationEnd(Animation animation) {
        rl.addView(to_load);
    }

    public void onAnimationRepeat(Animation animation) {
    }

    public void onAnimationStart(Animation animation) {
    }
});

Animation fadeOutAnim = AnimationUtils.loadAnimation(LoginActivity.this, R.anim.fadeout);
fadeOutAnim.setAnimationListener(animListen);
rl.startAnimation(fadeOutAnim); 
```

# c# - 如何从 MethodInfo (C#) 中获取对方法的引用

> ID：14987901
> 
> 赞同：4
> 
> 时间：2013-02-20T19:03:56.700
> 
> 标签：c#, reflection

我正在尝试构建一个索引类中每个静态方法的字典，以便可以使用字符串查找它们。我似乎无法找到一种方法来实际从 MethodInfo 中获取对该方法的引用。这可能吗？

```
delegate void SkillEffect(BattleActor actor, BattleActor target);

public static class SkillEffectLookup
{
    public static Dictionary<string, SkillEffect> lookup;

    public static void Build()
    {
        lookup = new Dictionary<string, SkillEffect>();
        Type type = typeof(SkillEffects);
        var methods = type.GetMethods(BindingFlags.Static | BindingFlags.Public);
        foreach (MethodInfo methodInfo in methods)
        {
            lookup.Add(methodInfo.Name, _____________);
        }
    }

public static class SkillEffects
{
    public static Attack(BattleActor actor, BattleActor target)
    {
        // Do Things
    }

    public static NonAttack(BattleActor actor, BattleActor target)
    {
        // Do Other Things
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:10:09.120

尝试使用 CreateDelegate 方法。仅当您知道方法的签名时，它才会起作用。

[http://msdn.microsoft.com/en-us/library/system.delegate.createdelegate.aspx](http://msdn.microsoft.com/en-us/library/system.delegate.createdelegate.aspx)

**UPD**（tnx 给 Chris Sinclair）：

使用示例

```
lookup.Add(methodInfo.Name
      , (SkillEffect)Delegate.CreateDelegate(typeof(SkillEffect), methodInfo)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T19:13:25.497

从代码看来，您正在寻找委托而不是对方法的引用。（这在 C# 中并不存在）

我会将字典更改为`Dictionary<string,Func<BattleActor,BattleActor> lookup` 尽管这是个人喜好问题，与您的问题无关。（您可以在下面的代码中`Func<BattletActor,BattlActor>`替换为）`SkillEffect`

然后做

```
Func<BattleActor,BattleActor> func = (Func<BattleActor,BattleActor>)
                     Delegate.CreateDelegate(typeof(Func<BattleActor,BattleActor>), methodInfo);

lookup.Add(methodInfo.Name,func); 
```

仿函数是一个委托，可以像任何其他委托一样被调用

```
 lookup["mymethod"](actor,target); 
```

您可以查看[此问题](https://stackoverflow.com/questions/2933221/can-you-get-a-funct-or-similar-from-a-methodinfo-object)以获取更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:07:39.587

MethodInfo 是方法的元数据。实际调用您调用的方法（惊喜！）MethodInfo.Invoke。

这是否回答你的问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T19:10:29.790

如果您希望保存对方法本身的引用以便可以调用它，我认为您不能。实际上，您所做的是通过以下[`Invoke`](http://msdn.microsoft.com/en-us/library/4k9x6bc0.aspx)方法调用它`MethodInfo`：

```
 foreach (MethodInfo methodInfo in methods)
        {
            lookup.Add(methodInfo.Name, _____________);
        } 
```

然后调用它：

```
lookup[methodName].Invoke(null, BindingFlags.Public | BindingFlags.Static, null, args, null); 
```

# c# - Windows 8 C# 强制桌面视图

> ID：14987903
> 
> 赞同：0
> 
> 时间：2013-02-20T19:04:03.703
> 
> 标签：c#, windows-8

我有一个 C# 程序，可以在用户桌面上显示基于 HTML 的通知。在 Windows 8 出现之前，这一直很有效。Windows 8 的问题是用户只能在使用桌面应用程序时才能看到这些消息。有谁知道强制窗口返回桌面视图的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:17:08.693

在以前的版本中，您可以使用 API 函数来设置最顶层的窗口。这充其量是烦人的，就好像您正在打字或专注于某事一样，弹出另一个窗口。因此，使用系统托盘通知成为这样做的更好方法。

Windows 8 提出了其他问题 - 当应用程序正在运行或开始屏幕打开时会发生什么。如果您要返回桌面，您可能会通过使其失去焦点来强制暂停其他应用程序，而用户不一定希望这样做。如果我是用户并且处于 Windows 应用商店应用体验的中间，我会认为这是一个糟糕的设计。特别是如果 WinRT 应用程序没有正确的代码来准确地从我离开的地方恢复。

那么接下来的问题就是如何通知用户。吐司通知适合这里的账单。您需要添加对 Windows.Winmd 的引用，确保在开始屏幕上注册应用程序的快捷方式（不必可见），然后只需创建通知并根据应用程序分配处理程序：

[快速入门：从桌面发送 toast 通知](http://msdn.microsoft.com/en-us/library/windows/desktop/Hh802768%28v=vs.85%29.aspx)

# asp.net-mvc - 如何查找页面加载时触发的操作

> ID：14987909
> 
> 赞同：0
> 
> 时间：2013-02-20T19:04:45.610
> 
> 标签：asp.net-mvc

我必须接管现有项目 ASP.NET MVC 应用程序的维护。当主页加载时，它会重定向到其他域并离开应用程序。我尝试跟踪以查看此重定向来自何处，但问题是我找不到正在触发的控制器操作甚至导致这种情况发生。在解决方案中搜索 URL 字符串的文件也不起作用，因为到处都有重定向。我尝试在站点上每个控制器的 Index() 方法中放置一个断点，但没有一个成功。当您从 VS2010 中加载 ASP.NET MVC 站点时，是否有一些更简单的方法可以找出正在执行的代码？

谢谢！

# java - Java -> Clojure -> Java

> ID：14987910
> 
> 赞同：8
> 
> 时间：2013-02-20T19:04:49.310
> 
> 标签：java, clojure

我正在尝试使用 Clojure 作为主机 Java 程序的脚本语言。这个想法是最终用户将能够编写将调用特定于域的 Java API 的 Clojure 脚本代码。在运行时，宿主 Java 程序将评估最终用户的 Clojure 脚本（该脚本将依次调用域 API）。所以我从一个非常简单的原型开始探索地形。

## 领域

```
package a.problem.domain;

public class Domain {

    public Domain() { }

    public String defaultMsg() {
        return "default";
    }

    public String passBackMsg(String s) {
        return s;
    }
} 
```

## 宿主 Java 程序

（为简单起见，对最终用户的 Clojure 脚本进行了硬编码）

```
String script = "(do                                    "+
                "  (import '(a.problem.domain Domain))  "+
                "  (.defaultMsg (Domain.))              "+
                ")                                      ";
System.out.println(RT.var("clojure.core", "eval").invoke(RT.var("clojure.core","read-string").invoke(script))); 
```

（取自[此处](http://blog.jayfields.com/2011/12/clojure-java-interop.html)的代码片段）

到现在为止还挺好。

但是我找不到调用第二种方法（需要参数的方法）的方法。相反，我求助于在运行时动态生成 Clojure 脚本，并用表示调用域方法**passBackMsg**的结果的文字替换占位符。显然，这是不能令人满意的，并且不会走得太远（如果我想将 java.sql.Connection 传递给我的 Clojure 脚本怎么办？）。

那么，如何从宿主 Java 程序调用**passBackMsg方法呢？**

当我尝试以下操作时：

```
String script = "(ns foo)                                   "+ 
                "(import '(a.problem.domain Domain))        "+
                "(defn numberToString [s]  (                "+
                "  (.passBackMsg (Domain.) s)               "+
                "))                                         ";
RT.var("clojure.core", "eval").invoke(RT.var("clojure.core","read-string").invoke(script)); // line-A
System.out.println(RT.var("foo", "numberToString").invoke(33)); // line-B 
```

我得到：

```
java.lang.IllegalStateException: Can't change/establish root binding of: *ns* with set 
```

...在线-A。当我尝试不使用 ns 并使用：

```
RT.var("user", "numberToString").invoke(33) 
```

（“用户”是一个疯狂的猜测，因为我没有看到没有命名空间参数的**var方法）**

我得到一个：

```
java.lang.IllegalStateException: Attempting to call unbound fn: #'user/numberToString" 
```

...在B线。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T08:18:13.433

试试这个：

```
String script = "(do                                    "+
                "  (import '(a.problem.domain Domain))  "+
                "  (fn [s]                " +
                "   (.passBackMsg (Domain.) s)               "+
                "))                                         ";

IFn fn = (IFn)RT.var("clojure.core", "eval").invoke(RT.var("clojure.core","read-string").invoke(script));

fn.invoke("hello"); 
```

**更新：** 下面的示例代码工作正常：

```
package hello_clj;

import clojure.lang.RT;
import clojure.lang.IFn;

public class Main {

    public String passBackMsg(String s) {
        return s;
    }

    public static void main(String[] args) {
        String script = "(do (import 'hello_clj.Main) (fn [s] " + 
                        "(.passBackMsg (Main.) s) ))";

        IFn fn = (IFn)RT.var("clojure.core", "eval").invoke(RT.var("clojure.core","read-string").invoke(script));
        System.out.print(fn.invoke("Hello"));
    }

} 
```

# android - 片段景观如何正确替换

> ID：14987916
> 
> 赞同：0
> 
> 时间：2013-02-20T19:05:07.257
> 
> 标签：android, android-layout, android-fragments

我有一个包含许多片段的应用程序。这是水平模式下的布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <fragment android:name="com.map.manager.ListUser"
          android:id="@+id/listuser_fragment"
          android:layout_weight="1"
          android:layout_width="0dp"
          android:layout_height="match_parent" />

    <fragment android:name="com.map.manager.DetailApp"
          android:id="@+id/detailapp_fragment"
          android:layout_weight="2"
          android:layout_width="0dp"
          android:layout_height="match_parent" />   

</LinearLayout> 
```

我可以看到我的片段是正确的，但如果我这样做：

```
 DetailUser appFrag = (DetailUser)
                    getSupportFragmentManager().findFragmentById(R.id.detailuser_fragment);

            if (appFrag != null) {
                // If article frag is available, we're in two-pane layout...

                // Call a method in the ArticleFragment to update its content
                appFrag.updateAppointmentView(position);

            } 
            else {
            DetailUser dtuser = new DetailUser();
            FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
            transaction.replace(R.id.detailapp_fragment, dtuser);
            transaction.commit(); 
```

我可以替换片段，但我可以在背景中看到旧片段..我读过[这个](https://stackoverflow.com/questions/5907673/android-cant-replace-one-fragment-with-another)我不能替换静态片段但是如何动态添加它？（不止一个进入水平模式..）我可以在不知道旧片段的情况下替换片段吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:34:58.237

片段容器：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:id="@+id/fragmentLayout"
    >

     <FrameLayout
        android:id="@+id/framelayout1"
        android:layout_width="313dp"
        android:layout_height="match_parent" >
     </FrameLayout>

    <FrameLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/framelayout2" >
    </FrameLayout>

</LinearLayout>

//Adding Detailuser fragment to framelayout1:

    DetailUser dtuser = new DetailUser();
            FragmentTransaction transaction =    getSupportFragmentManager().beginTransaction();
            transaction.add(R.id.framelayout1, dtuser);
            transaction.commit();
//Adding another fragment to framelayout1:

    Fragment frag = new Fragment();
            FragmentTransaction transaction =    getSupportFragmentManager().beginTransaction();
            transaction.add(R.id.framelayout2, frag);
            transaction.commit();

//Replacing fragment in framelayout:

    Fragment2 frag2 = new Fragment2();
                FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
                transaction.replace(R.id.framelayout1, frag);
                transaction.commit(); 
```

# java - 如何将对象从 jsp 页面传递到没有会话属性的 servlet

> ID：14987918
> 
> 赞同：0
> 
> 时间：2013-02-20T19:05:12.307
> 
> 标签：java, ajax, jsp

我正在尝试使用 request.setAttribute 方法将对象传递给servelt，如下所示：

jsp：

```
<%request.setAttribute(ResponsibilitiesCollectionRdg.RESPONSIBILITIES_COLLECTION, new ResponsibilitiesCollectionRdg());%> 
```

爪哇代码：

```
public class ResponsabilityHtmlCommand extends FrontCommand {

@Override
public void processRequest(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException 
{

    int id = new Integer(request.getParameter("ID")); //get the id of the module
    boolean toAdd = new Boolean(request.getParameter("toAdd")); // get if we need to add or remove the responsibilities
    ResponsibilitiesCollectionRdg respos = (ResponsibilitiesCollectionRdg) request.getAttribute(ResponsibilitiesCollectionRdg.RESPONSIBILITIES_COLLECTION);
    //add or remove the responsibilities
    if(id != -1)
    {
        if(toAdd)
            respos.addResp(id);
        else
            respos.removeResp(id);
    }

    response.getWriter().write(ResponsabilityFinder.findHtmlForRespDropDown(respos.getListOfResp())); //send the tag
} 
```

变量“respos”在 getAttribute 方法之后包含 null。任何想法如何解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:17:04.233

一旦 a`jsp`被处理，它就会被渲染为 html 并提交给`HttpResponse` `OutputStream`. `jsp`不再存在于 servlet 的上下文中，因此您不能以您可能认为的方式传递任何内容。

您可以做的是使参数可用于您发出的下一个 Http 请求，无论是从锚点还是在用作请求参数`<a href="/my/wtv/site?attr=myattribute">`的表单提交和输入元素中。`<form action="/my/wtv/site?attr=myattribute">`

# java - 在java中使用数组从文本文件中读取关键字

> ID：14987920
> 
> 赞同：0
> 
> 时间：2013-02-20T19:05:20.500
> 
> 标签：java, arrays, text-files

我正在创建一个程序，它从数组中读取关键字，然后将此关键字与文本文件中的句子进行匹配。我已经创建了数组，并将其转换为 arrayList。

```
String[] faults = { "Misspelled", "Error", "Fixed", "Change","Update", "Out of sync",
"Fail", "API Tooling","Unclear", "Charset", "Typos", "Fixed bug"};
 ArrayList newarray = new ArrayList(100);
newarray.addAll(Arrays.asList(faults)); 
```

我已经使用 while 循环和缓冲区读取器读取了文件，它逐行读取文件，因为每个句子都是一行。但是现在我被困在如何读取数组中的关键字，并将它们与包含句子的文本文件中的单词进行匹配。依次打印出与数组中所有单词匹配的所有句子。

我会很高兴得到任何帮助，或者关于我应该如何做到这一点的任何建议。

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:27:45.337

试试这个

```
String[] faults = { "Misspelled", "Error", "Fixed", "Change","Update", "Out of sync",
"Fail", "API Tooling","Unclear", "Charset", "Typos", "Fixed bug"};
        try {
            BufferedReader reader = new BufferedReader(new FileReader("Azad.txt"));
            String line = reader.readLine();
            while(line !=null)
            {
               for(int i = 0 ; i<faults.length;i++){
               if(line.contains(faults[i])){
                   // do something
                   System.out.println(faults[i]);
               }
               }
               line=reader.readLine();
            }
        } catch (Exception ex) {
            System.out.println(ex.getMessage());
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T20:23:21.153

是的，您可以通过添加计数器

```
//.....
    //.....

        int count=0;
         while(line !=null)
         {
          for(int i = 0 ; i<faults.length;i++){
           if(line.contains(faults[i])){
              // do something
              System.out.println(line);
              count++;
          }
         }
       line=reader.readLine();
    }
    System.out.println("Printed Lines   = "+count);
//.....
//..... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T20:04:38.180

同样的例子只是打印线而不是故障[i]

```
//....
//....

    if(line.contains(faults[i])){
     // do something
     System.out.println(line);
    }
//.....
//.... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T19:20:57.860

最简单的方法是使用 foreach 循环：

```
for (String fault : faults) {
    //check if current sentence contains fault    
} 
```

此循环也适用于 ArrayList。只需用 newArray 替换故障即可。

# c# - 单元测试属性持续时间格式

> ID：14987921
> 
> 赞同：1
> 
> 时间：2013-02-20T19:05:21.277
> 
> 标签：c#, visual-studio-2010, unit-testing

从 Visual Studio 2010 运行单元测试时，我看到我们能够右键单击特定测试并从“测试结果”窗口中选择“查看测试结果详细信息”。我的问题是使用什么格式来显示测试的持续时间属性？是 hh:min:secs:ms 吗？

![在此处输入图像描述](../Images/a9e50b6b4765b0b00c7dfbf2a1b169a9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:07:21.290

它是`hours:minutes:seconds.fractions of a second`。希望您的个人测试永远不需要那些额外的幅度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T19:08:18.947

在我看来更像`hour:minute:fractional-seconds`。

# python - 使用 py2exe 将 tkinter 编译为可执行文件，遇到 xlrd 问题

> ID：14987927
> 
> 赞同：1
> 
> 时间：2013-02-20T19:05:55.783
> 
> 标签：python, tkinter, py2exe, xlrd

我使用 tkinter 制作了一个 GUI。我的 GUI 链接到一个 Excel 文件，所以我使用了 xlrd 包。使用 py2exe 将 GUI 编译为可执行文件后，当我尝试打开可执行文件时，我得到一个带有以下错误消息的文本文件：

```
Traceback (most recent call last):
  File "main.py", line 2, in <module>
  File "xlrd\__init__.pyc", line 4, in <module>
IOError: [Errno 2] No such file or directory: 'C:\\Users\\dist\\library.zip\\xlrd\\version.txt' 
```

我不知道那个“version.txt”文件是什么或者为什么它不存在于目录中。我试图编译一个不需要 xlrd 包的可执行 GUI，一切正常。这是我的 setup.py 文件脚本：

```
from distutils.core import setup
import py2exe

setup(windows=['main.py'],options={'py2exe':{'includes':['xlrd']}}) 
```

我对 python 和制作可执行应用程序相当陌生。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T10:37:34.583

`xlrd`您使用的版本已过期；`version.txt`已被根除。

尝试以下满足您要求的第一个版本：

[0.9.0](https://github.com/python-excel/xlrd/archive/master.zip) -- XLS 和 XLSX 文件，Python 2.6。2.7、3.2+
[0.8.0](https://pypi.python.org/pypi/xlrd/0.8.0) -- XLS 和 XLSX 文件，Python 2.3 到 2.7
[0.7.9](https://pypi.python.org/pypi/xlrd/0.7.9) -- 仅限 XLS 文件，Python 2.1 到 2.7

注意：发布的 0.9.0 不是生产质量；master 分支中已经修复了几个错误，因此请使用上面的链接从 github 获取 ZIP 文件，而不是来自 PyPI 的 tar.gz。

# java - Jboss 5.1，休眠，当我指定 Oracle10gDialect 时使用 Oracle8gDialect

> ID：14987930
> 
> 赞同：0
> 
> 时间：2013-02-20T19:06:08.383
> 
> 标签：java, oracle, jakarta-ee, jboss

我继承了一个我试图在 jboss 5.1 上本地运行的应用程序。该应用程序正在使用休眠，我们正在为我们的数据库使用 Oracle 11g。

当我启动应用程序时，我收到此错误：

```
javax.persistence.PersistenceException: org.hibernate.HibernateException: Problem while trying to load or access OracleTypes.CURSOR value 
```

这个错误：

```
Caused by: java.lang.IllegalAccessException: Class org.hibernate.dialect.Oracle8iDialect can not access a member of class oracle.jdbc.driver.OracleTypes with modifiers "" 
```

在我的 persistence.xml 文件中，我设置了这个：

```
<persistence-unit name="DomainPU">
    <jta-data-source>java:/AuthorizationDS</jta-data-source>
    <properties>
         <property name="hibernate.dialect" value="org.hibernate.dialect.Oracle10gDialect"/>
    </properties>
</persistence-unit> 
```

关于导致这些错误的原因以及如何解决这些错误的任何建议？我什至不确定此时该尝试什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T21:26:18.433

我最终在 SVN repo 中找到了一个 jboss 版本，据我所知，它看起来可能有一个升级版的 hibernate。

# css - 使用 h:outputStylesheet 时未呈现图像

> ID：14987935
> 
> 赞同：0
> 
> 时间：2013-02-20T19:06:30.540
> 
> 标签：css, jsf-2

我正在使用 JSF 2.0 资源管理机制。在 /webapp/resources 下，我有 3 个子文件夹：图像、脚本、样式。在我的模板文件 myLayout.xhtml 中，我引用样式表如下

```
 <h:outputStylesheet name="styles/styles.css"/> 
```

我把我所有的背景图片放在我的 styles.css 文件中，如下所示：

```
 body {
           background: #fff url(../images/body_background.png) repeat -x;
    }

    #header {
           background: transparent url(../images/header_bg.png) no-repeat top right;
    } 
```

我所有的页面 facelets 都位于 /webapp/facelets 子文件夹下，而模板文件位于 /webapp/template 下。我的 facelet page.xhtml 引用模板如下：

```
 <ui:compsition .... template="/template/myLayout.xhtml"> 
```

然后页面布局正确，除了所有背景图像都丢失了。我检查了日志，发现以下错误：

```
 java.io.FileNotFoundException: SRVE0190: File not found: /javax.faces.resource/images/body_background.png
    java.io.FileNotFoundException: SRVE0190: File not found: /javax.faces.resource/images/header_bg.png 
```

然后我将css文件中的url引用从

```
 url(../images/body_background.png) 
```

到 url(/i

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:10:44.090

您需要通过`#{resource}`EL 引用 CSS 图像资源，以便打印正确的 JSF 资源 URL。

```
body {
    background: #fff url(#{resource['images/body_background.png']}) repeat -x;
}

#header {
    background: transparent url(#{resource['images/header_bg.png']}) no-repeat top right;
} 
```

# mongodb - MongoDB MapReduce 平均返回不正确的结果

> ID：14987936
> 
> 赞同：1
> 
> 时间：2013-02-20T19:06:35.057
> 
> 标签：mongodb, mapreduce

我在 MongoDB 上有一个非常简单的 Map/Reduce 函数，它旨在从集合中返回一组数据的平均值。一切似乎都很好，除了答案是错误的，在一种情况下是 2 倍。

这是我的 Map/Reduce 函数——我不得不混淆“diff”值的来源，但从日志中返回的打印语句中我已经验证它是正确的：

```
 var mapFunction = function() {
    if (this.fieldId==1234) {
        print(diff);    
    }
    emit(this.fieldId,diff);
};

var reduceFunction = function(keyId, viewTime) {
    var count = viewTime.length;
    var total = 0;
    for (idx = 0; idx < viewTime.length; idx++) {
        total+=viewTime[idx];
    }
    if (keyVidId==1234) {
        print('1234: ' + total/count);  
    }
    return total/count;
}; 
```

运行此之后，对于特定记录 1234，我得到的结果大约是我从 MySQL 迁移之前得到的结果的两倍*，*也是我在决定使用 Map/Reduce 以实现可伸缩性等之前使用的聚合框架得到的结果的两倍其他记录也有错误，但一般不会差那么多。

最初 reduceFunction 使用 Array.avg 但我转换为手动平均值来尝试调试。

有问题的数据大约是 23,000 个文档，每个 diff 往往是一个非常大的整数。

我浏览了日志，试图找出问题所在，实际上使用 LibreOffice Calc 手动平均了日志中吐出的 diff 值并得到了**正确**的结果，因此错误出现在 reduce 函数实现中。

我注意到在日志中有多行显示“1234：”，就好像单个keyId多次调用reduce函数一样-我不太清楚它在下面是如何工作的，但我想它会拆分将工作负载转换为多个函数调用，然后在最后组合，这意味着它必须对结果进行加权以获得正确的平均值……我想这可能是问题所在，但我不确定。我也担心它是一个 int32 溢出（因为所有差异的总和大于最大值），但在 python 中对有问题的数字进行一些修改似乎并非如此。

希望有人可以阐明MongoDB在后台做什么以及我做错了什么......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T22:50:39.237

你做错了什么是计算每个减少的东西（基于总数和总和的平均值），应该在 finalize 函数中完成（这是可选的，但如果提供的话，每个键值只会运行一次）。

因为reduce函数可能被调用0次、1次或多次，所以你永远不能假设你会在reduce中得到一个键的所有发射值的数组。

这意味着您应该为每个键发出一个对象 {total:1, value:diff} ，然后在 reduce 中只增加这些对象以累积每个键的所有值。

在 finalize 函数中，您可以进行除法以获得适当的平均值。

[这个例子](http://docs.mongodb.org/manual/tutorial/map-reduce-examples/#calculate-order-and-total-quantity-with-average-quantity-per-item)就是这样做的。

# db2 - 连接到 DB2 数据库

> ID：14987937
> 
> 赞同：0
> 
> 时间：2013-02-20T19:06:37.733
> 
> 标签：db2, toad

当我尝试连接 Toad for DB2 时出现以下错误：

> 错误 [08001] [IBM] SQL30081N 检测到通信错误。正在使用的通信协议：“TCP/IP”。正在使用的通信 API：“SOCKETS”。检测到错误的位置：“10.99.13.5”。检测错误的通信功能：“recv”。协议特定错误代码：“ *”、“* ”、“0”。SQLSTATE=08001

![在此处输入图像描述](../Images/3ee7e078363f6470f132de805787d49b.png)

附件是我的连接属性。任何帮助连接都会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T20:17:58.000

当客户端无法访问数据库时，这是典型的问题。可能有不同的原因：

*   本地（客户端）机器中的关闭端口。（防火墙出站）
*   如果使用本地目录，请检查一切是否正确（db2 目录数据库、db2 目录 tcpip 节点）。如果使用直接连接跳过此步骤。
*   路由问题（iptables ou 网络防火墙）
*   具有封闭端口的数据库服务器 (inbonud) - netstat -nato 检查端口。
*   实例关闭（ps -ef 或 windows 中的任务中心）
*   DB2COMM 注册表变量未设置为 tcpip
*   端口号未正确映射到服务名称（实例配置，请改用数字）
*   数据库名称不正确（在数据库服务器本地连接）

您可以通过 telnet 从 Windows（客户端）机器远程登录到服务器

```
telnet databaseServerIP portNumber 
```

甚至，如果 db2 服务器在同一台机器上，您可以做一个 localhost telnet 以查看该实例是否可以接收 TCP 连接

```
telnet localhost 50000 
```

一旦你能成功地做到这一点，你就可以连接到数据库。

# jquery - 清除间隔和范围

> ID：14987941
> 
> 赞同：1
> 
> 时间：2013-02-20T19:06:45.290
> 
> 标签：jquery, intervals

这里有一些间隔问题。

基本概念是我有一个进度条功能，每行 1 个，从后端脚本提供信息。我在 ajax 调用的间隔内每 5 秒 ping 一次这个脚本。

这可行，但是存在倍数问题（即，第二个进度条调用相同的函数）或当项目“关闭”（div 幻灯片）时它应该停止。这是一些非常复杂的代码，所以我会尽力提取必要的部分，但请注意，就目前而言，这可能不会运行。

一个完整的步行虽然 - 功能名称已更改以保护无辜者:)

onlcick，div 打开，调用这个 start 函数：

```
function start(ID){
var request = $.ajax({  
    url: "script?DO=Start&ID="+ID
    ,  type: "GET"              
    ,  cache: false
    ,  dataType: "text"
});
request.done(function(msg) {
    startLoop(ID);      

});
request.fail(function(jqXHR, textStatus) {
    //alert("Request failed: " + textStatus );      
});
} 
```

如您所见，这调用了 startLoop fnc，它继续 ping 更新信息脚本 (getInfo()) 以获取信息：

```
function startLoop(ID){
var i = setInterval(function(){
    var xstatus = getInfo(ID);
    //other stufff that works       
    if(xstatus=="done"){
        clearInterval(i);
    }

}, 5000);
} 
```

这本身就可以正常工作。

如果第二次点击事件打开第二个窗口，它只是有一个新的 ID 并调用相同的函数。

因此，我有一个 i 区间，而摧毁一个似乎可以停止一切。我应该将 i 转换为对象，例如 i.ID 吗？

此外，当停止时，我有一个 onclick =stop() 调用，并且从循环外部，我似乎无法停止它。

我如何重新安排它以使其工作？

它应该支持 1 个或多个同时项目的启动、停止和自动更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:17:48.477

为什么不使用`setTimeout`而不是`clearInterval`，因为您已经将杀死间隔的责任放在其回调中：

```
// using this approach might require changing the name of this function
function startLoop(ID) { 
   setTimeout(function(){
        var xstatus = getInfo(ID);

        //other stufff that works       
        if(xstatus!=="done"){
            startLoop(ID); // do it all over again if it's not complete
        }

    }, 5000);
} 
```

这会给你同样的行为，但有一些额外的好处。一方面，这不应该导致你的其他工作在完成时被杀死。另一个是它会异步运行，所以如果请求开始需要超过 5 秒才能完成，超时不会在它返回后 5 秒内再次 ping 它，而不是每 5 秒盲目触发一次，无论是否请求已完成。

# java - 实例化一个类并在不同的 JVM 中运行它的方法

> ID：14987946
> 
> 赞同：3
> 
> 时间：2013-02-20T19:07:01.683
> 
> 标签：java, reflection, jvm

假设我有一个`X`带有无参数构造函数的类和一个方法`m`，我需要在全新的 JVM 中运行以实现魔法目的。

我的第一个想法是从命令行（`org.apache.commons.exec.CommandLine`）调用它，但现在我坚持`X`没有`main()`方法的事实（我假设通过命令行调用 Java 代码的唯一方法是传递给`java`一个类包含一个静态`main`方法，对吧？）。`main()`我可以通过快速绕道在调用类中创建自己的方法，并将其作为其内容

```
public static void main(String[] args) {
  String classToInstantiate = args[some index];
  ...
} 
```

但我想知道是否有一些更清洁的方法来实现这一点。

**回顾一下，我需要知道在与我的主代码不同的 JVM 上实例化任意类以及在该类上调用任意方法的最简洁方法。**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-23T22:13:40.910

在 Java 9 中，[REPL](http://openjdk.java.net/projects/kulla/)包含在 OpenJDK 中。这样，您可以使用此 REPL 从控制台以编程方式调用代码。在即将到来的更新中，它甚至可能被移植回 Java 8。今天，在 Java 8 中，这可以通过运行 Nashorn REPL 进行一些干扰。

或者，您可以编写一个程序来为您完成这项工作，或者使用与 JVM 的其他语言（例如 Scala）打包的 REPL。

# reference - 对 cons 单元格的引用

> ID：14987949
> 
> 赞同：2
> 
> 时间：2013-02-20T19:07:07.677
> 
> 标签：reference, lisp, common-lisp, cons

如何设置变量以指向列表单元格？

我正在尝试编写一个宏来将列表中的所有值乘以一个值。这是我目前拥有的：

```
(defmacro scale (areas scale)
  `(dotimes (n (list-length ,areas))
     (setf (nth n ,areas) (* (nth n ,areas) ,scale)))) 
```

我担心这不是最有效的做事方式，因为我两次查找第 n 个单元格。我宁愿设置一个变量指向第 n 个单元格，以便`setf`可以修改该单元格的值并`*`可以在其计算中使用该单元格的值。

更好的是使用`dolist`并将变量设置为单元格引用。这是可能吗？

虽然我在这里，但当您有一个单元格时，是否也可以获取列表中的下一个单元格。有点像迭代器，这样我就可以执行以下操作：

```
(let ((area (car areas))
  (loop while area do
    (setf area (* area scale))
    (setf area (next area)))) 
```

但我不知道如何区分设置指针或设置引用单元格的值。

我希望我有道理:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:23:31.870

第一个代码示例的主要问题不是它`nth`两次找到单元格，而是它确实使用`nth`了。而不是获取`nth` 单元格，而是获取*下一个*单元格，它是`cdr`前一个单元格的。

你不需要宏，所以让我们实现一个函数。在列表的每个 cons 单元格上执行操作的方法有很多种：

```
(defun scale (areas scale)
  (do ((tail areas (cdr tail)))
      ((endp tail))
      (setf (car tail)
            (* (car tail) scale))))

(defun scale (areas scale)
  (loop for tail on areas
        do (setf (car tail)
                 (* (car tail) scale))))

(defun scale (areas scale)
  (mapl (lambda (cell)
          (setf (car cell)
                (* (car cell) scale)))
        areas)) 
```

有一个替代方案不涉及对`car`每个单元的显式操作：

```
(defun scale (areas scale)
  (map-into areas
            (lambda (area)
              (* area scale))
            areas)) 
```

作为奖励，这是一个类似`dolist`- 的宏，它使主体中“变量”的修改传播到列表中：

```
(defmacro dolistref ((var list &optional result) &body body)
  (let ((tail (gensym "TAIL"))
        (head (gensym "HEAD")))
    `(let ((,head ,list))
       (symbol-macrolet ((,var (car ,tail)))
         (do ((,tail ,head (cdr ,tail)))
             ((endp ,tail) ,result)
           ,@body)))))

;; usage example
(let ((a (list 1 2 3)))
  (dolistref (item a a)
    (incf item))) ;; => (2 3 4) 
```

# c# - 如果复选框在 C# 中未选中，则从列表框中删除元素

> ID：14987953
> 
> 赞同：-1
> 
> 时间：2013-02-20T19:07:19.810
> 
> 标签：c#, unchecked

我有一个 C# 应用程序需要两个列表框，但它们的内容是根据某些复选框的状态填充的。我已经想出了在选中复选框时如何将内容添加到列表框中，但是如果未选中相同的复选框，我希望应用程序删除相同的内容。

注意：列表框不是选中的列表框......它只是一个普通的列表框。我花了很多时间寻找（在错误的地方，我猜......）我在这里找不到任何关于我的具体问题的东西......

我拥有的功能如下所示：

```
private void cbCheckbox_CheckedChanged(object sender, EventArgs e)
        {
                if (cbCheckbox.Checked)  
                {
                    testlist.Add("Elemento1");
                    testlist.Add("Elemento2");
                    testlist.Add("Elemento3");
                    ltTestPool.DataSource = testlist;
                }

                else
                {                  
                    testlist.Add("Elemento1");
                    testlist.Add("Elemento2");
                    testlist.Add("Elemento3");
                    ltTestPool.DataSource = testlist;
                }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:42:56.633

试试这个代码：

```
private void cbCheckbox_CheckedChanged(object sender, EventArgs e)
        {
                if (cbCheckbox.Checked)  
                {
                    testlist.Items.Clear();
                    testlist.Items.Add("Elemento1");
                    testlist.Items.Add("Elemento2");
                    testlist.Items.Add("Elemento3");
                    ltTestPool.DataSource = testlist;
                }

                else
                {                  
                    testlist.Items.Clear();
                    ltTestPool.DataSource = testlist;
                }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:12:18.063

在设置为数据源之前清除您的列表应该会有所帮助。

```
private void cbCheckbox_CheckedChanged(object sender, EventArgs e)
            {
                    if (cbCheckbox.Checked)  
                    {   
                        testlist.Clear();
                        ltTestPool.DataSource = null;
                        testlist.Add("Elemento1");
                        testlist.Add("Elemento2");
                        testlist.Add("Elemento3");
                        ltTestPool.DataSource = testlist;
                    }

                    else
                    {   testlist.Clear();  
                        ltTestPool.DataSource =null;            
                        testlist.Add("Elemento1");
                        testlist.Add("Elemento2");
                        testlist.Add("Elemento3");
                        ltTestPool.DataSource = testlist;
                    }

} 
```

# actionscript-3 - AS3 在旋转的影片剪辑中查找点的 x 和 y

> ID：14987956
> 
> 赞同：0
> 
> 时间：2013-02-20T19:07:19.377
> 
> 标签：actionscript-3, flash

我有一个带有一点的电影剪辑：`.x = 20 .y = 20`当我这样做时，`trace("x="_root.movieclip.point.x)`它会跟踪`x=20`.

但如果我将movieclip 旋转到90 度，`x`则必须是`-20`，但它仍然会留下痕迹`x=20`。

有可能这样做吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:26:51.827

点对象是 MovieClip 的本地对象。如果您更改 MovieClip 的属性，则子对象在其“本地”空间中不会更改。就像您将 MovieClip 移动到 (100,100) 一样，点 Object 仍将是 (20,20)。您可以使用[localToGlobal](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#localToGlobal%28%29)和/或[globalToLocal](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#globalToLocal%28%29)方法来确定点的修改位置。

# c# - 使用带有实体框架的 .Net MVC3 将文件存储在 SQL Server 数据库中

> ID：14987958
> 
> 赞同：0
> 
> 时间：2013-02-20T19:07:21.390
> 
> 标签：c#, .net, asp.net-mvc-3, sql-server-2008

我想在 SQL Server 中存储和检索文件。

我的基础设施是：

*   SQL Server 2008
*   带有实体框架的 C# .Net MVC3。

请帮助我解决我必须在 SQL Server 和 C# 文件上使用的数据类型。如果可以在不刷新更接近我要求的页面的情况下存储文件。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T19:44:00.833

这是一些“示例代码”；）我省略了一堆声明、验证等，因此代码不会按原样运行，但您应该能够理解。如果您不想刷新页面，请使用 ajax 类型请求提交您的文件表单。

```
// model
public class UploadedImage
{
    public int UploadedImageID { get; set; }
    public string ContentType { get; set; }
    public byte[] File { get; set; }
}

// controller
public ActionResult Create()
{
    HttpPostedFileBase file = Request.Files["ImageFile"];

    if (file.ContentLength != 0)
    {
        UploadedImage img = new UploadedImage();
        img.ContentType = file.ContentType;
        img.File = new byte[file.ContentLength];

        file.InputStream.Read(img.File, 0, file.ContentLength);

        db.UploadedImages.Add(img);
        db.SaveChanges();
    }

    return View();
}

ActionResult Show(int id) 
{
    var image = db.UploadedImages.Find(id);
    if (image != null)
    {
        return File(image.File, image.ContentType, "filename goes here");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:36:13.230

Sql 数据类型是图像

这是一篇很棒的文章，讲述了如何做到这一点。

[http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)

祝你好运。

# android - 是否可以重新创建活动并保留运行时实例？

> ID：14987959
> 
> 赞同：3
> 
> 时间：2013-02-20T19:07:21.640
> 
> 标签：android, android-activity, android-preferences, android-theme

我创建了一个 SettingsActivity 让用户设置首选项。偏好之一是肤色。

```
 Intent settingIntent = new Intent(this, SettingsActivity.class);
    startActivity(settingIntent); 
```

一旦用户完成设置，他\她将点击“完成”按钮返回到 MainActivity。

```
 Intent intent = new Intent();
    intent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
    intent.setClass(this, MainActivity.class);
    startActivity(intent);
    finish(); 
```

但是 MainActivity 并没有真正改变。

我意识到我只应用 onCreate() 中的更改

```
 setTheme(SettingsActivity.getSkinColor()); // Get the preference from SharedPreference
    setContentView(R.layout.mylayout); 
```

在这种情况下，我认为我必须重新创建活动。所以我将**intent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT)**更改为**intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK)**。

但是，当用户点击“完成”按钮时，它将创建一个新的 MainActivity。

有没有办法在不重新创建活动的情况下应用 setTheme？或者至少在我创建一个新实例时保留所有运行时实例和状态？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:27:52.157

将 Extras 添加到 Intent 中，为新启动的 Activity 提供运行时状态和正确配置自身所需的主题信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T22:25:26.007

您无需强制重新创建活动。

在`onResume()`您的主要活动中，您可以检查主题是否已更改。如果是这样，只需调用`setTheme()`然后再调用`setContentView()`一次，这将使用新主题重新创建您的布局。请记住重做所有`findViewById()`调用，因为您的所有`View`对象都已重新创建。

# python - 在矩阵中检索上述元素（Python）

> ID：14987961
> 
> 赞同：2
> 
> 时间：2013-02-20T19:07:30.160
> 
> 标签：python, list, matrix

我有一个形式的矩阵：

```
 matrix = [[1,0,1],[0,1,0],[1,1,0]] 
```

（在我的实际问题中，它是一个更大的问题，但我会保持简单。重要的是只计算零和一。）

对于矩阵中的每个元素，我想为变量“alive”分配一个值，表示围绕它的元素的数量。对于水平，我是这样做的：

```
 alive = matrix[i+1] + matrix[i-1] 
```

但现在我也想考虑上面（和下面，但可以用同样的方法）的元素。

如何检索我正在计算的元素正上方的元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:19:22.117

我通常喜欢使用以下方式简单地访问多维列表：

```
matrix = [[1,0,1],[0,1,0],[1,1,0]]
valatpos = dict()
for row, inner in enumerate(matrix):
  for col, val in enumerate(inner):
    valatpos[row,col] = val 
```

然后，在比较时，您调用它来获取一个值，以任意组合向上或向下移动行或列。

```
valatpos[i + 1, j] # Below
valatpos[i - 1, j] # Above
valatpos[i, j - 1] # Left
valatpos[i, j + 1] # Right
valatpos[i + 1, j + 1] # Below, Right 
```

我更喜欢：

```
matrix[i + 1][j] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-20T19:29:18.120

您可以使用 numpy 的数组构造为整个矩阵计算存活：

```
import numpy as np

 # Your matrix defined as numpy array:
 matrix = np.array([[ 1, 0, 1 ], [ 0, 1, 1 ], [ 0, 0, 1 ]])

 # Get the size of the matrix
 nn = matrix.shape[0]

 # Create alive matrix by summing the four neighboring fields:
 alive = np.fromfunction(lambda i, j: matrix[(i+1)%nn, j] + matrix[(i-1)%nn, j]
    + matrix[i, (j+1)%nn] + matrix[i, (j-1)%nn], (nn, nn), dtype=int) 
```

使用 numpy 数组，您可以`alive[i, j]`直接访问元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T19:31:18.487

我认为您正在寻找以下内容：

```
def get_alive(matrix):
    empty = [0]*(len(matrix[0])+2)
    temp = [empty] + [[0]+row+[0] for row in matrix] + [empty]
    def count(i, j):
        return (sum(temp[i-1][j-1:j+2]) + temp[i][j-1] + temp[i][j+1] +
                sum(temp[i+1][j-1:j+2]))
    rows = range(1, len(temp)-1)
    cols = range(1, len(temp[0])-1)
    return [[count(i, j) for j in cols] for i in rows] 
```

例子：

```
>>> import pprint
>>> matrix = [[1,0,1],[0,1,0],[1,1,0]]
>>> alive = get_alive(matrix)
>>> pprint.pprint(matrix, width=20)
[[1, 0, 1],
 [0, 1, 0],
 [1, 1, 0]]
>>> pprint.pprint(alive, width=20)
[[1, 3, 1],
 [4, 4, 3],
 [2, 2, 2]] 
```

# glassfish - 通过 XML 配置在 Glassfish 中启用 gzip 压缩

> ID：14987967
> 
> 赞同：2
> 
> 时间：2013-02-20T19:07:43.257
> 
> 标签：glassfish, compression, gzip, http-compression

这个问题有[多种](https://stackoverflow.com/questions/5070924/enable-glassfish-compression)[答案](http://www.vikasing.com/2010/01/enable-gzip-compression-on-glassfish-v3.html)，可以通过管理控制台解决。我想通过 Glassfish 的 XML 配置启用此功能，但尚未找到有关此功能的任何文档。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T20:51:32.983

你可以在`domain.xml`下面设置`network-config`-->`protocols`

例子：

```
<protocol name="http-listener-1">
  <http default-virtual-server="server" max-connections="250" 
    compressable-mime-type="text/html,text/xml,text/plain,text/javascript" compression="on" compression-min-size-bytes="4096">
  <file-cache></file-cache>
  </http>
</protocol> 
```

# less - LESS 过渡混合

> ID：14987968
> 
> 赞同：12
> 
> 时间：2013-02-20T19:07:48.670
> 
> 标签：less, css-transitions, mixins

有人可以展示如何使用以下 LESS mixin 轻松地将以下属性转换**为****.25s**吗？

 ****边框顶部：6px 实心#ff3300；**

```
.transition-properties(...) {
@props: ~`"@{arguments}".replace(/[\[\]]/g, '')`;
-webkit-transition-property: @props;
-moz-transition-property: @props;
-o-transition-property: @props;
transition-property: @props;
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-20T19:40:29.270

## 更新：LESS 1.4+ 功能

使用 LESS 1.4，不需要逗号分隔参数的原始答案中使用的 javascript。相反，在参数字符串末尾使用“虚拟”分号会导致逗号被视为列表分隔符，而不是参数分隔符，因此现在在估算多个转换时可以使用：

### 少 1.4+

mixin 调用中的分号 ( `.transition-properties(border-top .25s linear, color .5s linear;);`) 非常重要。如果省略，则两个参数之间的逗号将被删除，最终导致无效的 css 规则。

```
.transition-properties(...) {
  -webkit-transition: @arguments;
  -moz-transition: @arguments;
  -o-transition: @arguments;
  transition: @arguments;
}

.yourClass {
  border-top: 1px solid black;
  .transition-properties(border-top .25s linear, color .5s linear;); /* semicolon is necessary */
}                                                                |
                                                          NOTE THIS SEMICOLON

.yourClass:hover {
  border-top: 6px solid #ff3300;
} 
```

### CSS 输出

请注意，逗号位于两个属性值之间：

```
.yourClass {
  border-top: 1px solid black;
  -webkit-transition: border-top 0.25s linear, color 0.5s linear;
  -moz-transition: border-top 0.25s linear, color 0.5s linear;
  -o-transition: border-top 0.25s linear, color 0.5s linear;
  transition: border-top 0.25s linear, color 0.5s linear;
}
.yourClass:hover {
  border-top: 6px solid #ff3300;
} 
```

## 原始答案 [Pre LESS 1.4]

显然，具体情况将取决于您的具体实施。但是，这通常说明了您将如何使用它：

### 较少的

```
.transition-properties(...) {
@props: ~`"@{arguments}".replace(/[\[\]]/g, '')`;
-webkit-transition: @props;
-moz-transition: @props;
-o-transition: @props;
transition: @props;
}

.yourClass {
  border-top: 1px solid black;
  .transition-properties(border-top .25s linear);
}

.yourClass:hover {
  border-top: 6px solid #ff3300;
} 
```

### CSS 输出

```
.yourClass {
  border-top: 1px solid black;
  -webkit-transition: border-top 0.25s linear;
  -moz-transition: border-top 0.25s linear;
  -o-transition: border-top 0.25s linear;
  transition: border-top 0.25s linear;
}
.yourClass:hover {
  border-top: 6px solid #ff3300;
} 
```

**[请参阅示例小提琴](http://jsfiddle.net/EZ6KT/4/)**

## 解释

什么

```
@props: ~`"@{arguments}".replace(/[\[\]]/g, '')`; 
```

允许您做的是放入多个逗号分隔的转换，例如：

```
.transition-properties(border-top .25s linear, color 1s linear); 
```

它将编译以使它们用逗号分隔（例如，仅显示一行）：

```
transition: border-top 0.25s linear, color 1s linear; 
```

如果您只使用直线，则`@arguments`最终***没有逗号分隔***：

```
transition: border-top 0.25s linear color 1s linear; 
```

这对于该属性是不正确的。**

# java - 在java中以相反的顺序在ArrayList中添加元素

> ID：14987971
> 
> 赞同：1
> 
> 时间：2013-02-20T19:08:03.717
> 
> 标签：java, arraylist

我得到数组列表：

```
ArrayList logs;
for(Logs log : getLogs()){           
    logs.add(log.getName();        
} 
```

如何以相反的顺序获取此列表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T19:11:02.680

使用类的`reverse`方法`Collections`来反转列表。请注意，这将影响列表本身。

```
ArrayList logs = new ArrayList(); //Initialize this list or your
                                  //code won't compile.

for(Logs log : getLogs()){           
    logs.add(log.getName();        
}

Collections.reverse(logs); 
```

如果您想要一个新列表，请创建一个新列表，使用 using 将所有元素添加到其中`addAll`，最后反转该列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-20T19:12:55.270

尝试使用[`add(int index, E element)`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html).

```
ArrayList logs;
for(Logs log : getLogs()){           
    logs.add(0,log.getName());        
} 
```

这将始终将元素作为第一个元素插入，而不是将其附加到列表的末尾，因此您的列表会反转。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-20T19:15:39.737

```
for ( int i = logs.size() - 1; i >= 0; --i )
    // do something with logs.get( i )
    ; 
```

不要浪费时间来反转可以以相反顺序迭代的东西。

更新： listIterator 也可以以相反的顺序使用，并且是更通用的解决方案：

```
for ( ListIterator< Logs > lit = logs.listIterator( logs.size() ); lit.hasPrevious(); )
    // do something with lit.previous()
    ; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-20T19:12:50.717

从 Java 5 开始（至少，可能更早），Collections 库中对此提供了支持。

```
 Collections.reverse(logs); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-20T19:19:45.797

反转集合不是必需的，并且可能会导致性能灾难（取决于大小）。最自然的 JDK 方式是涉及`listIterator`：

```
for (ListIterator<String> it = list.listIterator(list.size()); it.hasPrevious();) {
  ...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-28T05:40:24.770

```
/** ArrayList Elements Reverse Without Using Collections Reverse */
public static void main(String s[]) {

        ArrayList<Integer> alOrig = new ArrayList<Integer>();
        alOrig.add(210);
        alOrig.add(213);
        alOrig.add(214);
        alOrig.add(216);
        alOrig.add(217);

        System.out.println("ArrayList Elements in Normal Order");
        Iterator alOrigItr = alOrig.iterator();

        while (alOrigItr.hasNext()) {
            System.out.println("" + alOrigItr.next());
        }

        System.out.println("ArrayList Elements in Reverse Order ");

        ArrayList<Integer> alRev = new ArrayList<Integer>();

        for (int i = alOrig.size(); i > 0; i--) {
            alRev.add(alOrig.size() - i, alOrig.get(i - 1));
        }

        for (Integer alRevI : alRev) {

            System.out.println("" + alRevI);
        }

    }

} 
```

# spring - Quartz Clustering - 服务器启动时触发重复

> ID：14987972
> 
> 赞同：5
> 
> 时间：2013-02-20T19:08:05.307
> 
> 标签：spring, cluster-computing, quartz-scheduler, crontrigger

在集群设置（使用 JDBC 数据存储）中使用 Quartz 2.1.6 和 Spring 3.1 时，我们遇到了一个问题。当前上下文：

*   作业和 CRON 触发器在 spring 配置文件中定义（见下文）
*   在 SchedulerFactoryBean 中将 overwriteExistingJobs 属性设置为 true，因此我们不会在每次部署时将新作业定义添加到数据库中。
*   但是，在集群中每次部署之后，似乎每个节点都重新创建了触发数据。例如，如果我们有 2 个触发器指向 1 个作业和 4 个节点，则在集群部署后，数据库有 1 个作业定义和 4x2 触发器。每次重新部署都会添加 4x2 触发器。

这种行为正常吗？如果是：我们如何告诉 Quartz 不要在每次部署时重新创建触发器数据？（或覆盖该数据，如乔布斯）

```
<bean name="myJob" class="org.springframework.scheduling.quartz.JobDetailFactoryBean">
    <property name="jobClass" value="com.etc.MyJob" />
</bean>
<bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean"
    p:waitForJobsToCompleteOnShutdown="false" lazy-init="false">

    <property name="dataSource" ref="myDataSource" />
    <property name="transactionManager" ref="transactionManager" />
    <property name="overwriteExistingJobs" value="true" />
    <property name="autoStartup" value="true" />
    <property name="jobFactory">
                <bean class="org.springframework.scheduling.quartz.SpringBeanJobFactory"/>
            </property>
    <property name="triggers">
        <list>
            <bean class="org.springframework.scheduling.quartz.CronTriggerFactoryBean" p:cronExpression="0 0 0 * * ?"                   p:misfireInstruction="2">
                <property name="jobDetail" ref="myJob" />
            </bean>
            <bean class="org.springframework.scheduling.quartz.CronTriggerFactoryBean "
                p:cronExpression="0 0 20 * * ?"
                p:misfireInstruction="2">
                <property name="jobDetail" ref="myJob" />
            </bean>
        </list>
    </property>
    <property name="quartzProperties">
        <props>
            <prop key="org.quartz.scheduler.instanceName">fsbu_scheduler</prop>
            <prop key="org.quartz.scheduler.instanceId">AUTO</prop>

            <prop key="org.quartz.jobStore.misfireThreshold">60000</prop>
            <prop key="org.quartz.jobStore.class">org.quartz.impl.jdbcjobstore.JobStoreTX</prop>
            <prop key="org.quartz.jobStore.driverDelegateClass">org.quartz.impl.jdbcjobstore.oracle.weblogic.WebLogicOracleDelegate
            </prop>
            <prop key="org.quartz.jobStore.selectWithLockSQL">SELECT * FROM {0}LOCKS WHERE SCHED_NAME = {1} AND LOCK_NAME = ? FOR UPDATE
            </prop>
            <prop key="org.quartz.jobStore.tablePrefix">fsqrz_</prop>
            <prop key="org.quartz.scheduler.skipUpdateCheck">true</prop>
            <prop key="org.quartz.jobStore.isClustered">true</prop>
            <prop key="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</prop>
            <prop key="org.quartz.threadPool.threadCount">3</prop>
            <prop key="org.quartz.plugin.triggHistory.class">org.quartz.plugins.history.LoggingTriggerHistoryPlugin
            </prop>
            <prop key="org.quartz.plugin.triggHistory.triggerFiredMessage">Trigger {1}.{0} fired job {6}.{5} at {4, date,
                yyyy-MM-dd HH:mm:ss}
            </prop>
            <prop key="org.quartz.plugin.triggHistory.triggerCompleteMessage">Trigger {1}.{0} completed firing job {6}.{5} at {4,
                date, yyyy-MM-dd HH:mm:ss} with resulting trigger instruction code
                {9}
            </prop>
        </props>
    </property>
</bean> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-20T21:58:33.047

每个 Trigger 的 bean 定义没有“ **name** ”属性。因此，Spring 的 CronTriggerFactory 会在每次部署时动态生成一个新的触发器名称，这就是造成附加效应的原因（不同名称的触发器不会被覆盖）。

为每个触发器定义添加具有唯一值的**name="..."解决了该问题。**

# ruby-on-rails - Rails chomp方法不起作用

> ID：14987973
> 
> 赞同：0
> 
> 时间：2013-02-20T19:08:11.493
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rails-activerecord, chomp

我的模型方法中有以下代码行。

```
subjectsinlist='['
subjectlist.subjects.each do |subject|
     subjectsinlist=subjectsinlist+subject.subject_code+', '
end
subjectsinlist.chomp(', ')
subjectsinlist+="]" 
```

要附加的字符串的示例是：

```
CPE205 CPE206 CPE301 CPE302 HW0210 
```

我期望结果是：

```
[CPE205, CPE206, CPE301, CPE302, HW0210] 
```

但相反，我得到：

```
[CPE205, CPE206, CPE301, CPE302, HW0210, ] 
```

该`chomp`方法似乎不起作用。任何关于为什么会发生的建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-20T19:12:53.057

chomp 返回一个新字符串，请参见[此处](http://apidock.com/ruby/String/chomp)

但是您必须将新字符串分配给一个变量：

```
subjectsinlist = subjectsinlist.chomp(', ') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-20T19:13:23.967

这可以解决问题：

```
codes = "[#{subjectlist.subjects.map(&:subject_code).join(', ')}]" 
```

一些解释：

*   将在返回的数组的每个元素上`map(&:subject_code)`调用该方法`subject_code``subjectlist.subjects`

*   将在数组的每个元素**之间**`join(', ')`放置 ', '（逗号空格）（最后一个元素除外）。

 ****该`join`方法是您在这里需要的**；-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T19:10:05.083

`subjectsinlist = '[' + subjectlist.subjects.join(', ') + ']'`

那应该行得通。

chomp 不适合您的原因是因为它返回一个新字符串，而不是更改现有字符串：[http ://apidock.com/ruby/String/chomp](http://apidock.com/ruby/String/chomp)**

# wordpress - 指向停放域的内部链接 + SEO

> ID：14987976
> 
> 赞同：-2
> 
> 时间：2013-02-20T19:08:30.053
> 
> 标签：wordpress, seo, indexing, nofollow, parking

我正在一个客户拥有 2 个域的网站上工作，因为他想将他的诊所和他的教学材料分开，但两个网站都链接到另一个。客户还想自己管理网站，所以我选择了 WordPress 后端。

他的域名如下所示： www.myclinicinfo.com www.myteachinginfo.com

使用一个后端，我们虽然会在另一个上停放一个域，并拥有从 myclinicinfo.com 到 myteachinginfo.com 的链接。

从研究中，我发现我的页面应该被索引，但是 nofollow 会阻止搜索引擎标记我的内容，老实说，这对我来说似乎是合乎逻辑的。

这是好事还是坏事？这类问题还有其他解决方案吗？

谢谢你们 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:36:51.670

如果一个域停放在另一个域之上（因此键入任一 URL 会将您带到同一个地方）搜索引擎将考虑此重复内容。选择一个主域并在 htaccess 或类似中实现从辅助域到主域的 301 重定向，或者拆分两个站点，以便它们无缝链接，但没有内容重复（例如，不停车）。

# php - 如何使用准备好的语句获取 mysqli_result？

> ID：14987978
> 
> 赞同：1
> 
> 时间：2013-02-20T19:08:35.470
> 
> 标签：php

当我在寻找另一个问题的答案时，我遇到了这个线程：

[bind_result 成数组 PHP mysqli 准备好的语句](https://stackoverflow.com/questions/4496994/bind-result-into-an-array-php-mysqli-prepared-statement)

它回答了同样的问题。我不知道如何删除我自己的帖子，现在我将其视为与之前提出的问题的重复。版主，请随意删除此帖。谢谢。

* * *

我正在将我的 php 脚本转换为准备好的语句，但是我无法找出正确的语法来获取关联数组。以前构建的非准备版本可以工作，但我不知道如何检索 mysqli_result。我尝试了各种我认为可能有效的突变（其中一些在下面提到），但到目前为止没有一个有效。我要么得到“给定的对象”，要么得到“给定的布尔值”。我究竟做错了什么？如何检索 mysqli_result？

这是有效的 php 脚本的非准备版本（简化以演示工作版本与非工作准备状态版本之间的区别）：

```
// THIS WORKS
$dbh = mysqli_connect('localhost', $db_user, $db_password);
mysqli_select_db($dbh, $db_dbname);

$num = 123456; 
$num0 = 0; 
$num1 = 1; 
$i = 0; 
$myList = array(array()); 

$query = "SELECT col1, col2, col3, col4, col5, colB, colC 
    FROM tableOne LEFT OUTER JOIN tableTwo ON( tableOne.col3=tableTwo.colA )
    WHERE col6='" . $num . "' AND col7='" . $num1 . "'
    AND col8='" . $num1 . "' AND col9='" . $num0 . "'";

$data = mysqli_query($dbh, $query);

if ($data) { $dataCount = mysqli_num_rows($data); }

if ($dataCount > 0) {
    while( $row = mysqli_fetch_assoc($data) ) {
        $thisCol1 = $row['col1']; 
        $thisCol2 = $row['col2'];
        $thisCol3 = $row['col3']; 
        $thisCol4 = $row['col4'];
        $thisCol5 = $row['col5'];
        if ($thisCol1 > $thisCol2) {
            $myList[$i]["result1"] = "good"; 
        } else { 
            $myList[$i]["result1"] = "bad";
        }
        if ($thisCol3 > $thisCol4) { 
            $myList[$i]["result2"] = "good"; 
        } else { 
            $myList[$i]["result2"] = "bad"; 
        }
        $myList[$i]["thisCol5"] = $row['col5'];
        $myList[$i]["thisColB"] = $row['colB'];
        $myList[$i]["thisColC"] = $row['colC'];
        $i = $i + 1;
    }
    echo json_encode($myList);
} else {
    echo "no entry found";
} 
```

这是转换为给我错误的准备好的语句的尝试：

```
// THIS GIVES ME ERROR
$mysqli = new mysqli('localhost', $db_user, $db_password, $db_dbname);
$stmt = $mysqli->stmt_init();

$num = 123456; 
$num0 = 0; 
$num1 = 1; 
$i = 0; 
$myList = array(array()); 

$query = "SELECT col1, col2, col3, col4, col5, colB, colC 
    FROM tableOne LEFT OUTER JOIN tableTwo ON( tableOne.col3=tableTwo.colA )
    WHERE col6=? AND col7=? AND col8=? AND col9=?";

if($stmt->prepare($query)){

    $stmt->bind_param("iiii", $num, $num1, $num1, $num0);

    $stmt->execute() or trigger_error($mysqli->error);

    if ($stmt->store_result()) {

        $stmt->bind_result($col1,$col2,$col3,$col4,$col5,$colB,$colC);

        while mysqli_fetch_assoc($stmt) {
            $thisCol1 = $col1;  
            $thisCol2 = $col2;
            $thisCol3 = $col3;  
            $thisCol4 = $col4; 
            $thisCol5 = $col5;
            if ($thisCol1 > $thisCol2) { 
                $myList[$i]["result1"] = "good"; 
            } else { 
                $myList[$i]["result1"] = "bad";
            }
            if ($thisCol3 > $thisCol4) { 
                $myList[$i]["result2"] = "good"; 
            } else { 
                $myList[$i]["result2"] = "bad"; 
            }
            $myList[$i]["thisCol5"] = $col5;
            $myList[$i]["thisColB"] = $colB;
            $myList[$i]["thisColC"] = $colC;
            $i = $i + 1;
        }
        echo json_encode($myList);
    }
} else {
    echo $mysqli->error;
    echo "no entry found";
    $mysqli->close();  // close connection
} 
```

我尝试了 $rows=$stmt->execute() 和 mysqli_fetch_assoc($rows)，但没有成功。我也尝试了 $rows=$stmt->bind_result($col1,$col2,$col3,$col4,$col5,$colB,$colC)，但它也不起作用。然后我尝试了 $rows=$stmt->fetch()，还是不行。

我找不到从已执行语句中检索 mysqli_result 的正确语法。我非常感谢任何和所有的帮助。

**已解决：** 感谢 PeeHaa，我学会了如何使用准备好的语句来做到这一点。这是让 $myList 返回我正在寻找的数组的第一步。

```
// REPLACE THE if($stmt->prepare($query)){} SEGMENT WITH THE FOLLOWING 
// AND THE SOLUTION WILL BE STARING AT YOU:

if($stmt->prepare($query)){
    $stmt->bind_param("iiii", $num, $num1, $num1, $num0);
    $stmt->execute() or trigger_error($mysqli->error);
    $rows = $stmt->get_result();
    while ($row=mysqli_fetch_array($rows)){
        echo "<p>" . $row['col1'] . "</p>";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:53:18.197

根据[http://www.php.net/manual/en/mysqli-result.fetch-assoc.php](http://www.php.net/manual/en/mysqli-result.fetch-assoc.php) fetch_assoc() 接受 void 参数或 mysqli_result。但是您在 mysqli_statement 中发送：

```
while mysqli_fetch_assoc($stmt) { 
```

编辑：我看到你将结果绑定到变量。如果要填充变量，请改用此循环：

```
while ($stmt->fetch()) { 
```

( [http://www.php.net/manual/en/mysqli-stmt.fetch.php](http://www.php.net/manual/en/mysqli-stmt.fetch.php) )

# asp.net - 如何将 reCAPTCHA ASP.NET 插件放入 Razor (CSHTML) 文件中？

> ID：14987979
> 
> 赞同：4
> 
> 时间：2013-02-20T19:08:36.360
> 
> 标签：asp.net, razor, webmatrix, recaptcha, webmatrix-2

首先让我说我正在使用 WebMatrix。我正在尝试将 reCAPTCHA 插件添加到我的 ASP.NET 网站。我查看了他们的 ASP.NET 插件的[快速入门](https://developers.google.com/recaptcha/docs/aspnet "reCAPTCHA 文档")文档。这是他们示例的一部分：

```
<%@ Page Language="VB" %>
<%@ Register TagPrefix="recaptcha" Namespace="Recaptcha" Assembly="Recaptcha" %>
<script runat="server">
    Sub btnSubmit_Click(ByVal sender As Object, ByVal e As EventArgs)
        If Page.IsValid Then
            lblResult.Text = "You Got It!"
            lblResult.ForeColor = Drawing.Color.Green
        Else
            lblResult.Text = "Incorrect"
            lblResult.ForeColor = Drawing.Color.Red
        End If
    End Sub
</script>
<html>
  <body>
    <form runat="server">
      <asp:Label Visible=false ID="lblResult" runat="server" />
      <recaptcha:RecaptchaControl
          ID="recaptcha"
          runat="server"
          Theme="red"
          PublicKey="your_public_key"
          PrivateKey="your_private_key"
        />

      <!-- ... -->
    </form>
  </body>
</html> 
```

我知道我不需要“<%@ Page Language="VB" %>”，但我对 Razor 还是很陌生，所以我将如何添加对 reCAPTCHA 程序集的引用并在其中显示插件我的页面？我怀疑我是否可以将此行用作程序集参考：

```
<%@ Register TagPrefix="recaptcha" Namespace="Recaptcha" Assembly="Recaptcha" %> 
```

另外，我可以将`<asp:???>`来自 reCAPTCHA 程序集的标签和标签放在我的 CSHTML 文档中吗？这在 WebMatrix 网站中是否有效：

```
<recaptcha:RecaptchaControl
    ID="recaptcha"
    runat="server"
    Theme="red"
    PublicKey="your_public_key"
    PrivateKey="your_private_key"
  /> 
```

基本上我问的是如何将 reCAPTCHA 插件添加到 Razor C# 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T20:40:20.523

Microsoft.Web.Helpers 库中包含一个控件。基本用法是`@Microsoft.Web.Helpers.ReCaptcha.GetHtml(publicKey: "...")`

客户端（剃须刀）

```
@using (Html.BeginForm("Captcha", "Home", FormMethod.Post))
{
    @Microsoft.Web.Helpers.ReCaptcha.GetHtml(publicKey: "...")    
    <input type="submit" value="submit"/>
} 
```

在服务器端

```
public ActionResult Captcha()
{
    var valid = Microsoft.Web.Helpers.ReCaptcha.Validate(privateKey: "...");
    if (valid)
    {
        return RedirectToAction("Contact");
    }
    else
    {
        ModelState.AddModelError("Captcha", "Bad input in captcha");
        return View("Index");
    }            
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-17T05:53:43.463

到目前为止，这些都不起作用。OP 使用 WebMatrix 和 Razer，而上面/下面的示例适用于 MVC 和常规 ASP.NET。

WebMatrix IDE 在 NuGet 中包含一个用于 reCAPTCHA 的包，但没有关于如何使用它的说明。

编辑：以下是在 WebMatrix 中使用 reCAPTCHA 的说明

[http://www.asp.net/web-pages/tutorials/security/using-a-catpcha-to-prevent-automated-programs-%28bots%29-from-using-your-aspnet-web-site](http://www.asp.net/web-pages/tutorials/security/using-a-catpcha-to-prevent-automated-programs-%28bots%29-from-using-your-aspnet-web-site)

简而言之，您需要打开 NuGet，安装 MS Webhelper 库和 reCAPTCHA。然后按照建议添加/编辑 _AppStart.cshtml 并检查页面上的示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-11T10:50:22.813

在 Web.config 中

```
 <appSettings>
     <add key="webpages:Version" value="1.0.0.0"/>
     <add key="ClientValidationEnabled" value="true"/>
     <add key="UnobtrusiveJavaScriptEnabled" value="true"/>
     <add key="ReCaptchaPrivateKey" value="Your private key here" />
     <add key="ReCaptchaPublicKey" value="Your public key here" />
 </appSettings> 
```

在查看文件夹\Web.config

```
 <namespaces>
     <add namespace="System.Web.Mvc" />
     <add namespace="System.Web.Mvc.Ajax" />
     <add namespace="System.Web.Mvc.Html" />
     <add namespace="System.Web.Routing" />
     <add namespace="Recaptcha"/>
  </namespaces> 
```

在 cshtml 中

把这个放在上面

```
@using Recaptcha; 
```

把它放在你想显示的地方

```
 <div class="editor-label">
        Are you a human?
    </div>
    <div class="editor-field">
        @Html.DisplayFor(model => model.recap_errorRaise)
        @Html.Raw(Html.GenerateCaptcha("captcha", "red"))
        @Html.ValidationMessage("captcha")
    </div> 
```

在控制器中

```
 [HttpPost]
    [RecaptchaControlMvc.CaptchaValidator]
    public ActionResult Index(Home home, bool captchaValid, string captchaErrorMessage)
    {
        if (ModelState.IsValid)
        {
            if (captchaValid)
            {
                //return RedirectToAction("AnswerSecurityQuestion", new { username = model.Username });
                return View(home);
            }
            ModelState.AddModelError("", captchaErrorMessage);
            home.recap_errorRaise = captchaErrorMessage;
        }
        return View(home);
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-10T14:00:08.427

[将来自https://developers.google.com/recaptcha/docs/language](https://developers.google.com/recaptcha/docs/language)的语言值放入资源文件中。示例（@Resource.CaptchaLanguage 值 = 'en'）

```
<script src="https://www.google.com/recaptcha/api.js?hl=@Resource.CaptchaLanguage"></script> 
```

# macros - LibreOffice + Cell = 宏

> ID：14987983
> 
> 赞同：0
> 
> 时间：2013-02-20T19:08:48.107
> 
> 标签：macros, cell, libreoffice

我只需要这个：

```
 A     
    -------------------
 1 | =Macro(Parameter)| 
```

换句话说，我需要该字段从宏中获取值。

暂时谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T14:59:26.180

这看起来像您想要一个 UDF（用户定义的函数）。

[http://plan-b-for-openoffice.org/ooo-help/r2.1/en-US/WIN/calc/guide/userdefined_function](http://plan-b-for-openoffice.org/ooo-help/r2.1/en-US/WIN/calc/guide/userdefined_function)

# apache - apache ssl (443) node.js ssl (8081)。客户端找不到 socket.io.js

> ID：14987986
> 
> 赞同：1
> 
> 时间：2013-02-20T19:08:52.337
> 
> 标签：apache, node.js, ssl, amazon-web-services, socket.io

我在这上面花了两天时间。希望有人给出答案。

我有一个在端口 443 上运行 SSL 的 apache 服务器。我有一个在端口 8081 上运行 SSL 的 node.js 服务器。

在客户端中，我试图包含 socket.io/socket.io.js 文件，如下所示：

```
<script src="https://my_url.com:8081/socket.io/socket.io.js"></script> 
```

我没有得到 404（未找到）。在 Chrome javascript 控制台中，我得到 Status = (failed) 和 Type = undefined。我已经尝试过我找到的建议（使用 src="localhost.." 等，但它们也不起作用）。

它适用于我的 http 版本。我包括这样的文件：

```
<script src="http://my_url.com:8080/socket.io/socket.io.js"></script> 
```

不知道为什么 SSL 版本不起作用。有任何想法吗？提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:31:34.090

从你的评论我猜你有一个CORS问题：

[http://en.wikipedia.org/wiki/Cross-origin_resource_sharing](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

如果您更改协议，则遵循相同的源策略，源是不同的。您必须为此包含一个标题。

[https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript?redirectlocale=en-US&redirectslug=Same_origin_policy_for_JavaScript](https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript?redirectlocale=en-US&redirectslug=Same_origin_policy_for_JavaScript)

关于不安全内容的警告是导致问题的提示：您正在尝试通过不是脚本来源的脚本访问来源。这是一个安全问题，因为它可能会导致泄漏，从而允许将有害脚本注入页面

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-03T18:00:46.997

**不要将 ProxyPass 设置为 Localhost！那是行不通的！**

在您的 Apache 配置中执行此操作：

```
<VirtualHost *:443>
    ServerName domain.com
    SSLProxyEngine On
    RequestHeader set Front-End-Https "On"
    ProxyPass / https://domain.com:3000/ retry=1 acquire=3000 timeout=600 Keepalive=On
    ProxyPassReverse / https://domain.com:3000/

    SSLEngine on
    SSLCertificateKeyFile    /etc/ssl/private/domain.com.key
    SSLCertificateFile       /etc/ssl/certs/domain.com.crt
    SSLCertificateChainFile  /etc/ssl/certs/chaincert.crt
</VirtualHost> 
```

现在，Nodejs 也可以拥有 SSL：

```
var express = require('express');
var connect = require('connect');
var app = express();
var fs = require('fs');

var ssl_options = {
    key: fs.readFileSync('/etc/ssl/private/domain.com.key'),
    cert: fs.readFileSync('/etc/ssl/certs/domain.com.crt'),
    ca: fs.readFileSync('/etc/ssl/certs/domain.com.ca')
};

var server = require('https').createServer(ssl_options, app);
var port = process.env.PORT || 3000;

var io = require('socket.io')(server);

server.listen(port, function(err) {
    console.log(colors.green('https server running on port ' + port));
}); 
```

在您的客户中执行以下操作：

```
var socket = io.connect('https://domain.com:3000', { path: '/socket.io', 'flash policy port': 3000 }); 
```

对我来说，这很好用！

# .net - 如何在创建 PDF 文件的方法中使用 View 中的数据

> ID：14987989
> 
> 赞同：0
> 
> 时间：2013-02-20T19:09:02.870
> 
> 标签：.net, pdf, asp.net-mvc-4

我有一个从我的数据库中过滤数据的方法和一个显示数据的视图。

我想在视图中有一个按钮，它可以触发从过滤后的数据创建 PDF。

我怎么能那样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T19:16:41.000

实际上，不久前我不得不做一些类似的事情，并在这里写了一篇博客： [http ://www.megustaulises.com/2012/12/mvcnet-convert-html-to-pdf-with-pechkin.html](http://www.megustaulises.com/2012/12/mvcnet-convert-html-to-pdf-with-pechkin.html)

简而言之，主要思想是使用视图来显示您的数据，然后有一个控制器操作方法将呈现其 html，最后将其传递给将这个 html 呈现为 PDF 文件的工具。

# r - 使用 R 的 xtable 行名

> ID：14987991
> 
> 赞同：3
> 
> 时间：2013-02-20T19:09:04.740
> 
> 标签：r, latex, sweave, xtable

我正在使用 R 和 LaTeX 以及用于表格的 xtable 包。我有点困惑为什么我指定的行名没有出现在我的表格中。这是一个例子：

```
\documentclass[a4paper, 11pt]{article}
\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\begin{document}
\SweaveOpts{concordance=TRUE}
<<results=tex, fig=FALSE, echo=FALSE>>=
library(xtable)
table.matrix <- matrix(numeric(0), ncol = 5, nrow = 12)
colnames(table.matrix) <- c("$m_t$", "$p_t$", "$R^b_t$", "$R^m_t$", "$y^r_t$")
rownames(table.matrix) <- c("$m_{t-1}$", " ", "$p_{t-1}$", " ", "$R^b_{t-1}$", " ", "$R^m_{t-1}$", " ", "$y^r_t$", " ", "$c$", " ")

tex.table <- xtable(table.matrix)
align(tex.table) <- "c||ccccc"
print(tex.table, include.rownames = TRUE, hline.after = c(-1, 0, seq(0, nrow(table.matrix), by = 2)), sanitize.text.function = function(x){x})
@
\end{document} 
```

这对我来说似乎很简单。基本上我所拥有的是一个简单的 VAR 模型的估计，在行中我想要带有 (t-1) 下标的变量，并且每隔一行应该有 p 值（它们现在在名称向量中是空的）。有任何想法吗？

编辑：正如 nograpes 所指出的，一些行名重复的问题。有谁知道如何规避这个（不使用第一列作为名称列）？我只希望偶数行为空，或者某种指示它们是 p 值。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-20T19:28:42.370

尝试只运行 R 代码，你会得到一个警告，告诉你为什么行名没有出现：

```
library(xtable)
table.matrix <- matrix(numeric(0), ncol = 5, nrow = 12)
colnames(table.matrix) <- c("$m_t$", "$p_t$", "$R^b_t$", "$R^m_t$", "$y^r_t$")
rownames(table.matrix) <- c("$m_{t-1}$", " ", "$p_{t-1}$", " ", "$R^b_{t-1}$", " ", "$R^m_{t-1}$", " ", "$y^r_t$", " ", "$c$", " ")

xtable(table.matrix)
# Warning message:
# In data.row.names(row.names, rowsi, i) :
#  some row.names duplicated: 4,6,8,10,12 --> row.names NOT used 
```

So you can't have duplicated `rownames` in R. You could solve this by making a name "column" instead of using `rownames`.

# php - 在 CAutoComplete 字段中选择多个值

> ID：14987993
> 
> 赞同：0
> 
> 时间：2013-02-20T19:09:07.017
> 
> 标签：php, yii

我在我的表单中给出了一个 CAutoComplete 字段，它根据我的查询提出建议，现在我需要的是，在从建议框中选择一个项目后，如果我放一个逗号并寻求另一个项目建议，那么建议工作正常根据我已经这样编码，但是选择项目正在删除该字段中选择的第一个项目并取而代之。我想要的是，这些项目应该留在那里作为该字段的输入。

![在此处输入图像描述](../Images/70ee8a2b7af676d5f740bf3b0b579261.png)

在第一次选择字段包含诺基亚 100 之后。现在，如果我输入一个“，”并再次输入一些内容，那么就会出现建议，我也可以从中选择..

![在此处输入图像描述](../Images/5d46a25243c5cab2e8529eff60adcfac.png)

选择新产品将删除以前的产品。获取方式如下：Nokiaa 100、Micromax...、...输入框。这是我的代码

```
<?php $this->widget('CAutoComplete', array(
                            'name'=>'ListModel[indexIds]',
                            'id'=>'input-box',
                            'attribute'=>'search',
                            'url'=> $this->createAbsoluteUrl('list/suggestions'),
                            'value'=>'',
                            'minChars'=>2,
                            'scroll'=>false,
                            'resultsClass'=>'searchAutoComplete ac_results',
                            'htmlOptions'=> array('class'=>"searchClickClear",'id'=>'select'),
                            'methodChain'=>'.result(function(){$("form#search-form").submit();})'
               )); ?> 
```

这是输入字段

公共功能 actionSuggestions() {

```
 if(isset($_GET['q']) && ($keyword=trim($_GET['q']))!=='')
        {
            $what = $_GET['q'];
            $what = explode(',', $what);
            if(is_array($what))
                $what = end($what);
            $criteria = new CDbCriteria;
            $criteria->select = array("product_name");
            $criteria->condition = "product_name LIKE '%{$what}%' AND tagged = 1";
            $criteria->group = "product_name";
            $products = Production::model()->findAll($criteria);
            $result = array();

            if(count($products) > 0)
            {
                foreach($products as $p)
                    $result[] = $p->product_name;

                echo implode("\n",$result);
            }
        }
    } 
```

这是建议部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T07:24:03.523

默认的 CAutoComplete 目前无法处理此问题，但有一个[扩展](http://www.yiiframework.com/extension/multicomplete/)将其行为扩展为 CJuiAutotComplete 的包装器。它的工作方式类似于 jQuery UI 多标记演示。

通过在谷歌中输入你的问题找到了这个，第一个答案就是这个。

# ubuntu - 在 CDH4 集群上运行 Pig 时无法进入 mapreduce 模式（Hadoop 2 + MapReduce v1）

> ID：14987996
> 
> 赞同：1
> 
> 时间：2013-02-20T19:09:13.773
> 
> 标签：ubuntu, hadoop, mapreduce, apache-pig, cloudera

我想在 3 个 Amazon 实例的 CDH4 集群上运行 pig 脚本（非嵌入式和嵌入式）。我为位于 /home/ubuntu/core-site.xml 的 pig 创建了一个假配置文件（但地址是正确的），如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <property>
    <name>fs.default.name</name>
    <value>hdfs://server1:8020</value>
  </property>
  <property>
    <name>mapred.job.tracker</name>
    <value>server1:8021</value>
  </property>
</configuration> 
```

当我尝试运行时：

```
ubuntu@server1:~$ export HADOOP_CONF_DIR=/home/ubuntu
ubuntu@server1:~$ export PIG_CLASSPATH=/home/ubuntu
ubuntu@server1:~$ pig -x mapreduce -f test.pig 
```

该脚本运行并返回了正确的结果，但在控制台中我发现了很多“LocalJobRunner”，并且在 MapReduce 作业跟踪器 Web 界面中没有报告任何作业。谁能告诉我为什么它不在 mapreduce 模式下运行，为什么它不报告这种情况的任何错误？如何在 mapreduce 模式下运行它？

我的集群是 4.1.3（全新安装，所有配置均为默认）， Pig 0.10.0-cdh4.1.3。

```
2013-02-20 18:57:15,843 [main] INFO  org.apache.pig.Main - Apache Pig version 0.10.0-cdh4.1.3 (rexported) compiled Jan 26 2013, 17:35:45
2013-02-20 18:57:15,843 [main] INFO  org.apache.pig.Main - Logging error messages to: /home/ubuntu/epi-tre/pig_1361386635821.log
2013-02-20 18:57:16,519 [main] INFO  org.apache.pig.backend.hadoop.executionengine.HExecutionEngine - Connecting to hadoop file system at: hdfs://server1:8020
2013-02-20 18:57:16,524 [main] WARN  org.apache.hadoop.conf.Configuration - fs.default.name is deprecated. Instead, use fs.defaultFS
2013-02-20 18:57:17,249 [main] WARN  org.apache.hadoop.conf.Configuration - fs.default.name is deprecated. Instead, use fs.defaultFS
2013-02-20 18:57:17,826 [main] WARN  org.apache.hadoop.conf.Configuration - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.permissions.supergroup is deprecated. Instead, use dfs.permissions.superusergroup
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.max.objects is deprecated. Instead, use dfs.namenode.max.objects
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.replication.interval is deprecated. Instead, use dfs.namenode.replication.interval
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.data.dir is deprecated. Instead, use dfs.datanode.data.dir
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.access.time.precision is deprecated. Instead, use dfs.namenode.accesstime.precision
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.replication.min is deprecated. Instead, use dfs.namenode.replication.min
2013-02-20 18:57:17,827 [main] WARN  org.apache.hadoop.conf.Configuration - fs.checkpoint.dir is deprecated. Instead, use dfs.namenode.checkpoint.dir
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.http.address is deprecated. Instead, use dfs.namenode.http-address
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.replication.considerLoad is deprecated. Instead, use dfs.namenode.replication.considerLoad
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.write.packet.size is deprecated. Instead, use dfs.client-write-packet-size
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.permissions is deprecated. Instead, use dfs.permissions.enabled
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.block.size is deprecated. Instead, use dfs.blocksize
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.https.address is deprecated. Instead, use dfs.namenode.https-address
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.name.dir.restore is deprecated. Instead, use dfs.namenode.name.dir.restore
2013-02-20 18:57:17,828 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.https.need.client.auth is deprecated. Instead, use dfs.client.https.need-auth
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - topology.node.switch.mapping.impl is deprecated. Instead, use net.topology.node.switch.mapping.impl
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.backup.http.address is deprecated. Instead, use dfs.namenode.backup.http-address
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.secondary.http.address is deprecated. Instead, use dfs.namenode.secondary.http-address
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.safemode.extension is deprecated. Instead, use dfs.namenode.safemode.extension
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.df.interval is deprecated. Instead, use fs.df.interval
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - fs.checkpoint.edits.dir is deprecated. Instead, use dfs.namenode.checkpoint.edits.dir
2013-02-20 18:57:17,829 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.https.client.keystore.resource is deprecated. Instead, use dfs.client.https.keystore.resource
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.datanode.max.xcievers is deprecated. Instead, use dfs.datanode.max.transfer.threads
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.backup.address is deprecated. Instead, use dfs.namenode.backup.address
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - topology.script.number.args is deprecated. Instead, use net.topology.script.number.args
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.balance.bandwidthPerSec is deprecated. Instead, use dfs.datanode.balance.bandwidthPerSec
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.name.edits.dir is deprecated. Instead, use dfs.namenode.edits.dir
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.safemode.threshold.pct is deprecated. Instead, use dfs.namenode.safemode.threshold-pct
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - dfs.name.dir is deprecated. Instead, use dfs.namenode.name.dir
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - fs.checkpoint.period is deprecated. Instead, use dfs.namenode.checkpoint.period
2013-02-20 18:57:17,830 [main] WARN  org.apache.hadoop.conf.Configuration - hadoop.native.lib is deprecated. Instead, use io.native.lib.available
2013-02-20 18:57:18,102 [main] INFO  org.apache.pig.tools.pigstats.ScriptState - Pig features used in the script: GROUP_BY
2013-02-20 18:57:18,460 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MRCompiler - File concatenation threshold: 100 optimistic? false
2013-02-20 18:57:18,475 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.CombinerOptimizer - Choosing to move algebraic foreach to combiner
2013-02-20 18:57:18,507 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer - MR plan size before optimization: 1
2013-02-20 18:57:18,508 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MultiQueryOptimizer - MR plan size after optimization: 1
2013-02-20 18:57:18,530 [main] WARN  org.apache.hadoop.conf.Configuration - session.id is deprecated. Instead, use dfs.metrics.session-id
2013-02-20 18:57:18,531 [main] INFO  org.apache.hadoop.metrics.jvm.JvmMetrics - Initializing JVM Metrics with processName=JobTracker, sessionId=
2013-02-20 18:57:18,553 [main] INFO  org.apache.pig.tools.pigstats.ScriptState - Pig script settings are added to the job
2013-02-20 18:57:18,563 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - mapred.job.reduce.markreset.buffer.percent is not set, set to default 0.3
2013-02-20 18:57:18,566 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - creating jar file Job2458140745309154844.jar
2013-02-20 18:57:22,423 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - jar file Job2458140745309154844.jar created
2013-02-20 18:57:22,453 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.JobControlCompiler - Setting up single store job
2013-02-20 18:57:22,544 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 1 map-reduce job(s) waiting for submission.
2013-02-20 18:57:22,553 [Thread-4] INFO  org.apache.hadoop.metrics.jvm.JvmMetrics - Cannot initialize JVM Metrics with processName=JobTracker, sessionId= - already initialized
2013-02-20 18:57:22,581 [Thread-4] WARN  org.apache.hadoop.mapred.JobClient - Use GenericOptionsParser for parsing the arguments. Applications should implement Tool for the same.
2013-02-20 18:57:22,735 [Thread-4] WARN  org.apache.hadoop.conf.Configuration - fs.default.name is deprecated. Instead, use fs.defaultFS
2013-02-20 18:57:22,735 [Thread-4] WARN  org.apache.hadoop.conf.Configuration - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
2013-02-20 18:57:22,790 [Thread-4] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1
2013-02-20 18:57:22,790 [Thread-4] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1
2013-02-20 18:57:22,851 [Thread-4] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths (combined) to process : 1
2013-02-20 18:57:23,045 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 0% complete
2013-02-20 18:57:23,055 [Thread-4] WARN  org.apache.hadoop.conf.Configuration - fs.default.name is deprecated. Instead, use fs.defaultFS
2013-02-20 18:57:23,057 [Thread-4] WARN  org.apache.hadoop.conf.Configuration - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
2013-02-20 18:57:23,141 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - OutputCommitter set in config null
2013-02-20 18:57:23,178 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.df.interval is deprecated. Instead, use fs.df.interval
2013-02-20 18:57:23,178 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.max.objects is deprecated. Instead, use dfs.namenode.max.objects
2013-02-20 18:57:23,187 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - hadoop.native.lib is deprecated. Instead, use io.native.lib.available
2013-02-20 18:57:23,187 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.data.dir is deprecated. Instead, use dfs.datanode.data.dir
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.name.dir is deprecated. Instead, use dfs.namenode.name.dir
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - fs.default.name is deprecated. Instead, use fs.defaultFS
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - fs.checkpoint.dir is deprecated. Instead, use dfs.namenode.checkpoint.dir
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.block.size is deprecated. Instead, use dfs.blocksize
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.access.time.precision is deprecated. Instead, use dfs.namenode.accesstime.precision
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.replication.min is deprecated. Instead, use dfs.namenode.replication.min
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.name.edits.dir is deprecated. Instead, use dfs.namenode.edits.dir
2013-02-20 18:57:23,188 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.replication.considerLoad is deprecated. Instead, use dfs.namenode.replication.considerLoad
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.balance.bandwidthPerSec is deprecated. Instead, use dfs.datanode.balance.bandwidthPerSec
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.safemode.threshold.pct is deprecated. Instead, use dfs.namenode.safemode.threshold-pct
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.http.address is deprecated. Instead, use dfs.namenode.http-address
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.name.dir.restore is deprecated. Instead, use dfs.namenode.name.dir.restore
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.https.client.keystore.resource is deprecated. Instead, use dfs.client.https.keystore.resource
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.backup.address is deprecated. Instead, use dfs.namenode.backup.address
2013-02-20 18:57:23,189 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.backup.http.address is deprecated. Instead, use dfs.namenode.backup.http-address
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.permissions is deprecated. Instead, use dfs.permissions.enabled
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.safemode.extension is deprecated. Instead, use dfs.namenode.safemode.extension
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.datanode.max.xcievers is deprecated. Instead, use dfs.datanode.max.transfer.threads
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.https.need.client.auth is deprecated. Instead, use dfs.client.https.need-auth
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.https.address is deprecated. Instead, use dfs.namenode.https-address
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.replication.interval is deprecated. Instead, use dfs.namenode.replication.interval
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - fs.checkpoint.edits.dir is deprecated. Instead, use dfs.namenode.checkpoint.edits.dir
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.write.packet.size is deprecated. Instead, use dfs.client-write-packet-size
2013-02-20 18:57:23,190 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.permissions.supergroup is deprecated. Instead, use dfs.permissions.superusergroup
2013-02-20 18:57:23,191 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - topology.script.number.args is deprecated. Instead, use net.topology.script.number.args
2013-02-20 18:57:23,191 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - dfs.secondary.http.address is deprecated. Instead, use dfs.namenode.secondary.http-address
2013-02-20 18:57:23,191 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - fs.checkpoint.period is deprecated. Instead, use dfs.namenode.checkpoint.period
2013-02-20 18:57:23,191 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - topology.node.switch.mapping.impl is deprecated. Instead, use net.topology.node.switch.mapping.impl
2013-02-20 18:57:23,191 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
2013-02-20 18:57:23,193 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - OutputCommitter is org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigOutputCommitter
2013-02-20 18:57:23,246 [Thread-5] WARN  mapreduce.Counters - Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
2013-02-20 18:57:23,333 [Thread-5] INFO  org.apache.hadoop.util.ProcessTree - setsid exited with exit code 0
2013-02-20 18:57:23,344 [Thread-5] INFO  org.apache.hadoop.mapred.Task -  Using ResourceCalculatorPlugin : org.apache.hadoop.util.LinuxResourceCalculatorPlugin@3bfc47
2013-02-20 18:57:23,362 [Thread-5] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.PigRecordReader - Current split being processed hdfs://server1:8020/tmp/cf_rating.10000.csv:0+676168
2013-02-20 18:57:23,374 [Thread-5] INFO  org.apache.hadoop.mapred.MapTask - io.sort.mb = 100
2013-02-20 18:57:23,507 [Thread-5] INFO  org.apache.hadoop.mapred.MapTask - data buffer = 79691776/99614720
2013-02-20 18:57:23,507 [Thread-5] INFO  org.apache.hadoop.mapred.MapTask - record buffer = 262144/327680
2013-02-20 18:57:23,639 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - HadoopJobId: job_local_0001
2013-02-20 18:57:24,485 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - 
2013-02-20 18:57:24,488 [Thread-5] INFO  org.apache.hadoop.mapred.MapTask - Starting flush of map output
2013-02-20 18:57:25,059 [Thread-5] INFO  org.apache.hadoop.mapred.MapTask - Finished spill 0
2013-02-20 18:57:25,065 [Thread-5] INFO  org.apache.hadoop.mapred.Task - Task:attempt_local_0001_m_000000_0 is done. And is in the process of commiting
2013-02-20 18:57:25,087 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - 
2013-02-20 18:57:25,098 [Thread-5] INFO  org.apache.hadoop.mapred.Task - Task 'attempt_local_0001_m_000000_0' done.
2013-02-20 18:57:25,104 [Thread-5] WARN  mapreduce.Counters - Group org.apache.hadoop.mapred.Task$Counter is deprecated. Use org.apache.hadoop.mapreduce.TaskCounter instead
2013-02-20 18:57:25,130 [Thread-5] INFO  org.apache.hadoop.mapred.Task -  Using ResourceCalculatorPlugin : org.apache.hadoop.util.LinuxResourceCalculatorPlugin@461d318f
2013-02-20 18:57:25,130 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - 
2013-02-20 18:57:25,137 [Thread-5] INFO  org.apache.hadoop.mapred.Merger - Merging 1 sorted segments
2013-02-20 18:57:25,164 [Thread-5] INFO  org.apache.hadoop.mapred.Merger - Down to the last merge-pass, with 1 segments left of total size: 25 bytes
2013-02-20 18:57:25,164 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - 
2013-02-20 18:57:25,336 [Thread-5] INFO  org.apache.hadoop.mapred.Task - Task:attempt_local_0001_r_000000_0 is done. And is in the process of commiting
2013-02-20 18:57:25,337 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - fs.default.name is deprecated. Instead, use fs.defaultFS
2013-02-20 18:57:25,338 [Thread-5] WARN  org.apache.hadoop.conf.Configuration - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
2013-02-20 18:57:25,339 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - 
2013-02-20 18:57:25,341 [Thread-5] INFO  org.apache.hadoop.mapred.Task - Task attempt_local_0001_r_000000_0 is allowed to commit now
2013-02-20 18:57:25,371 [Thread-5] INFO  org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter - Saved output of task 'attempt_local_0001_r_000000_0' to hdfs://server1:8020/tmp/temp-1313079537/tmp188373172
2013-02-20 18:57:25,371 [Thread-5] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > reduce
2013-02-20 18:57:25,373 [Thread-5] INFO  org.apache.hadoop.mapred.Task - Task 'attempt_local_0001_r_000000_0' done.
2013-02-20 18:57:28,144 [main] WARN  org.apache.pig.tools.pigstats.PigStatsUtil - Failed to get RunningJob for job job_local_0001
2013-02-20 18:57:28,147 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 100% complete
2013-02-20 18:57:28,151 [main] INFO  org.apache.pig.tools.pigstats.SimplePigStats - Script Statistics: 

HadoopVersion   PigVersion  UserId  StartedAt   FinishedAt  Features
2.0.0-cdh4.1.3  0.10.0-cdh4.1.3 ubuntu  2013-02-20 18:57:18 2013-02-20 18:57:28 GROUP_BY

Success!

Job Stats (time in seconds):
JobId   Maps    Reduces MaxMapTime  MinMapTIme  AvgMapTime  MaxReduceTime   MinReduceTimeAvgReduceTime  Alias   Feature Outputs
job_local_0001  1   1   n/a n/a n/a n/a n/a n/a a,b,c   GROUP_BY,COMBINER   hdfs://server1:8020/tmp/temp-1313079537/tmp188373172,

Input(s):
Successfully read 0 records from: "/tmp/cf_rating.10000.csv"

Output(s):
Successfully stored 0 records in: "hdfs://server1:8020/tmp/temp-1313079537/tmp188373172"

Counters:
Total records written : 0
Total bytes written : 0
Spillable Memory Manager spill count : 0
Total bags proactively spilled: 0
Total records proactively spilled: 0

Job DAG:
job_local_0001

2013-02-20 18:57:28,151 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - Success!
2013-02-20 18:57:28,158 [main] INFO  org.apache.hadoop.mapreduce.lib.input.FileInputFormat - Total input paths to process : 1
2013-02-20 18:57:28,159 [main] INFO  org.apache.pig.backend.hadoop.executionengine.util.MapRedUtil - Total input paths to process : 1
(10000) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T14:45:51.850

原来是我忘记部署 MapReduce “客户端配置”，所以我的整个集群都在本地模式下运行：> 已解决。

# c# - 无法让我的服务调用 ServiceKnownType 辅助方法

> ID：14987998
> 
> 赞同：2
> 
> 时间：2013-02-20T19:09:16.253
> 
> 标签：c#, wcf, serviceknowntype

我在运行我的 ServiceKnownType 属性中指定的辅助方法时遇到问题。为简单起见，我有两个程序集：一个带有我的服务接口和数据合约的接口，另一个带有我的服务实现和具体的数据合约。

这是我的服务及其实现的简化/精简版本。

*我的服务接口.dll*

```
// IMyService.cs
[ServiceContract]
IMyService
{
    [OperationContract]
    IList<IMyData> GetData();
}

// IMyData.cs
public interface IMyData
{
    int Foo { get; set; }
} 
```

*MyService.dll（参考 MyService.Interface.dll）*

```
// MyService.svc.cs
public class MyService: IMyService
{
    public IList<IMyData> GetData()
    {
        // Instantiate List<IMyData>, add a new MyData to the list
        // return the List<IMyData>.
    }
}

// MyData.cs
[DataContract]
public class MyData : IMyData
{
    [DataMember]
    public int Foo { get; set; }
} 
```

问题的根源在于，要序列化 ​​的结果`GetData()`，必须告知服务具体`MyData`类和具体`List<IMyData>`泛型类，因为服务定义使用接口类型而不是具体类型。

简单的答案是用以下方式装饰 IMyService：

```
[ServiceKnownType(typeof(MyData))]
[ServiceKnownType(typeof(List<IMyData>))] 
```

但是，`MyData`在 MyService.Interface.dll 中未引用的程序集中定义（并且不能由于循环引用。）

我的下一个想法是使用`ServiceKnownType`MyService 本身的“辅助方法”形式：

```
[ServiceKnownType("GetDataContracts", MyService)]
public class MyService: IMyService
{
    public static IEnumerable<Type> GetDataContracts(ICustomeAttributeProvider provider)
    {
        // create a List<Type>, add MyData to it, and return it.
    }
    //...
} 
```

`GetDataContracts`据我所知，除了从未调用过之外，它应该可以工作。我尝试将它移动到一个单独的静态类中（与 MyService 平行并嵌套在其中），但在任何情况下我都无法获得一个断点来停在那里。

编辑：我还想说通过 web.config 添加已知类型也不起作用，因为我无法以这种方式添加泛型类型。您只能通过 web.config 添加简单、具体的类型：

```
<knownType type="TypeName, Assembly" /> 
```

我的混凝土`List<IMyData>`在程序集中没有完全限定的类型名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T21:07:11.670

固定的。答案是使用辅助方法形式将 ServiceKnownType 添加到服务接口，而不是服务实现，并添加一个反映我需要的类型的辅助类，而不是通过引用代码中的具体类型来添加它们。（回想一下，我不能这样做，因为我不能添加对该程序集的引用。）

```
[ServiceContract]
[ServiceKnownType("GetDataContractTypes", typeof(MyServiceHelper))]
public interface IMyService
{ ... } 
```

我在 Nightingale.Interface 中添加了一个新的 MyServiceHelper 类，但它不是公开的，所以我不担心从我只想成为“纯”接口的程序集中不必要地公开一个类。

```
// Not public outside of this assembly.
static class MyServiceHelper
{
    public static IEnumerable<Type> GetDataContractTypes(ICustomAttributeProvider paramIgnored)
    {
        // Get the assembly with the concrete DataContracts.
        Assembly ass = Assembly.Load("MyService");  // MyService.dll
        // Get all of the types in the MyService assembly.
        var assTypes = ass.GetTypes();
        // Create a blank list of Types.
        IList<Type> types = new List<Type>();
        // Get the base class for all MyService data contracts
        Type myDataContractBase = ass.GetType("MyDataContractBase", true, true);
        // Add MyService's data contract Types.
        types.Add(assTypes.Where(t => t.IsSubclassOf(myDataContractBase)));
        // Add all the MyService data contracts to the service's known types so they can be serialized.
        return types;
    }
} 
```

这个特殊的解决方案对我有用，因为我所有的 DataContract 类都扩展了一个公共基类。在我的情况下，可以对其进行重新设计以从具有 DataContract 属性的程序集中加载所有类型，这将导致相同的集合。