# StackOverflow 问答 15365000-15365999

# python - 为什么 subprocess.Popen 使用旧版本的 vim？

> ID：15365003
> 
> 赞同：2
> 
> 时间：2013-03-12T15:13:21.103
> 
> 标签：python, vim

当我运行时`vi --version`，我看到`VIM - Vi IMproved 7.3`了，但是当我运行以下脚本时，它打印出我有 7.2 版。为什么？

`pathname`是`vi`。_ `which vi`打印`/usr/local/bin/vim`，那`--version`就是`7.3`。 `which gvim`prints `/usr/bin/gvim`，并且也`--version`打印较新版本的 vim 。

`echo $EDITOR`打印`vi`。

```
#!/usr/bin/python
import os
import sys
import os.path
import subprocess
import tempfile

def exec_vimcmd(commands, pathname='', error_stream=None):
"""Run a list of Vim 'commands' and return the commands output."""
try:
    perror = error_stream.write
except AttributeError:
    perror = sys.stderr.write

if not pathname:
    pathname = os.environ.get('EDITOR', 'gvim')

args = [pathname, '-u', 'NONE', '-esX', '-c', 'set cpo&vim']
fd, tmpname = tempfile.mkstemp(prefix='runvimcmd', suffix='.clewn')
commands.insert(0,  'redir! >%s' % tmpname)
commands.append('quit')
for cmd in commands:
    args.extend(['-c', cmd])

output = f = None
try:
    try:
        print "args are"
        print args
        subprocess.Popen(args).wait()
        f = os.fdopen(fd)
        output = f.read()
        print "output is"
        print output
        print "that's the end of the output"
    except (OSError, IOError), err:
        if isinstance(err, OSError) and err.errno == errno.ENOENT:
            perror("Failed to run '%s' as Vim.\n" % args[0])
            perror("Please set the EDITOR environment variable or run "
                            "'pyclewn --editor=/path/to/(g)vim'.\n\n")
        else:
            perror("Failed to run Vim as:\n'%s'\n\n" % str(args))
            perror("Error; %s\n", err)
        raise
finally:
    if f is not None:
        f.close()

exec_vimcmd(['version']) 
```

打印的参数是

```
['vi', '-u', 'NONE', '-esX', '-c', 'set cpo&vim', '-c', 'redir! >/var/folders/86/062qtcyx2rxbnmn8mtpkyghs0r0r_z/T/runvimcmducLQCe.clewn', '-c', 'version', '-c', 'quit'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:19:36.297

找出分配给 的值`pathname`，并查看它是否同意`which vim`或`which gvim`在命令提示符处输入。您的脚本正在查看您的`$EDITOR`环境变量，但是当您从命令行运行时`(g)vim`，它会搜索您`$PATH`以找到第一个命中。例如，您可能`/opt/local/bin/vim`从 CLI 运行，但从`/usr/bin/vim`您的脚本运行。

# javascript - 拖动仍然突出显示文本

> ID：15365011
> 
> 赞同：0
> 
> 时间：2013-03-12T15:13:33.043
> 
> 标签：javascript, html, internet-explorer-8, drawing

在阅读了对[这个问题](https://stackoverflow.com/questions/891581/how-can-i-disable-text-selection-temporarily-using-javascript)的回复后，我已经实现了相同的功能，我检查`event.preventDefault`并运行`event.preventDefault()`或`event.returnValue = false`。这似乎已经解决了问题中用户的问题，但我的仍然突出显示文本。它**在**`event.returnValue = false`IE 7/8 中很受欢迎。它也适用于 Firefox、Chrome、IE 9+。

更多信息：我正在使用拉斐尔画布。我有画布的 mousedown、mousemove 和 mouseup 事件，它们都在做自己的事情。`event.preventDefault`我在`mousedown`回调函数中实现了检查。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:17:56.940

如果您习惯使用 jQuery，这将解决跨浏览器问题：

```
$(function (){
    $.fn.disableSelection = function() {
        return this
            .attr('unselectable', 'on')
            .css('user-select', 'none')
            .on('selectstart', false);
    };
})(); 
```

# java - 构造函数代码在创建对象之前不执行 JAVA

> ID：15365019
> 
> 赞同：0
> 
> 时间：2013-03-12T15:14:05.003
> 
> 标签：java, object, constructor, execution, creation

我最近在java中玩过代码，遇到了这个问题，构造函数中的代码似乎没有被执行，因为编译器抛出了NullPointerException。

```
public class ObjectA {

protected static ObjectA oa;
private String message = "The message";

public ObjectA() {

    oa = new ObjectA();

}

public static void main(String args[]) {

    System.out.println(oa.message);

}  } 
```

现在，当我将对象的创建移到构造函数之前，即我在一行中完成时，一切正常。

谁能向我解释为什么会发生这种情况，以及我对代码的理解是错误的？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T15:16:25.023

*除了*在构造函数中`ObjectA()`，您永远不会调用构造函数。如果你曾经*调用*过构造函数（例如 from ），你会得到一个堆栈溢出，因为你会永远递归。*`ObjectA`*`main`**

 **目前还不清楚您要做什么或为什么要使用静态变量，但您的代码会更简单：

```
public class ObjectA {
    private String message = "The message";

    public static void main(String[] args) {
        ObjectA oa = new ObjectA();
        System.out.println(oa.message);
    }
} 
```

另请注意，*编译器*从不抛出异常。区分编译时错误（语法错误等）和执行时错误（通常是异常）非常重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:16:41.653

您需要转到`ObjectA oa = new ObjectA()`您的主要方法。

此外，没有必要这样做：`protected static ObjectA oa;`

你应该从教程中复制/粘贴一个 Hello World 程序，看看它是如何工作的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:17:57.330

您定义了一个静态变量`oa`，但您只在类的构造函数中初始化它。您永远不会实例化您的类`ObjectA`，因此`oa`只能为空。

当您调用 main 方法时，它会尝试访问`message`空对象的变量，因此是 NPE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:20:27.500

1）你永远不会创建一个对象

放：

```
ObjectA oa = new ObjectA(); 
```

在您的 System.out.print 之前的 main 中。

2）将消息设置为公开而不是私有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T15:21:33.033

希望你需要这样的东西

```
public class ObjectA {

    protected static ObjectA oa;
    private String message = "The message";

    public ObjectA() {
    }

    public static ObjectA getInstance() {
        if (oa == null) {
            oa = new ObjectA();
        }
        return oa;
    }

    public String getMessage() {
        return message;
    }

    public static void main(String args[]) {
        System.out.println(ObjectA.getInstance().getMessage());
    }
} 
```**

# php - xDebug 和带有 MS VC6 的旧 wamp 服务器

> ID：15365023
> 
> 赞同：2
> 
> 时间：2013-03-12T15:14:23.477
> 
> 标签：php, debugging, wamp, xdebug, wampserver

你能告诉我，为什么我没有在 y PHP 扩展列表中获得 xDebug 扩展吗？Wamp>PHP>PHP 扩展不是 xDebug。

PHP版本：

```
Windows: yes - Compiler: MS VC6 - Architecture: x86
Zend Server: no
PHP Version: 5.3.5
Zend API nr: 220090626
PHP API nr: 20090626
Debug Build: no
Thread Safe Build: yes
Configuration File Path: C:\Windows
Configuration File: C:\wamp\bin\apache\Apache2.2.17\bin\php.ini
Extensions directory: c:\wamp\bin\php\php5.3.5\ext

The compiler (MS VC6) that this PHP was build with, is no longer supported. Please upgrade to a version that was built with MS VC9. 
```

* * *

所以我下载：Xdebug 2.1.2, PHP 5.3 VC6 (32 bit) (MD5: adb792dc75c79384f987061f12e0934a) 将文件复制到 ext 文件夹，将此行添加到 php.ini 文件中：

```
[Xdebug]
zend_extension = "c:/wamp/bin/php/php5.3.5/ext/php_xdebug.dll"
xdebug.remote_enable=1

;IP
xdebug.remote_host=127.0.0.1
xdebug.remote_port=9000
xdebug.remote_handler=dbgp
xdebug.auto_trace = On
xdebug.show_exception_trace = On
xdebug.remote_autostart = On
xdebug.collect_vars = On
xdebug.collect_return = On
xdebug.collect_params = On 
```

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-23T22:57:59.867

这对我很好：

```
[XDEBUG]
zend_extension="c:/path/to/your/extensions/php_xdebug-2.1.2-5.3-vc6.dll"
xdebug.remote_enable=true
xdebug.remote_host=localhost
xdebug.remote_port=9000
xdebug.remote_handler=dbgp 
```

对我来说最关键的部分是我使用`zend_extension_ts`而不是`zend_extension`.

您可能还想确保您正在更改正确的 php.ini 版本。对于命令行 PHP，可以通过运行以下命令获得：

```
php -i | findstr -i php.ini 
```

查找“加载的配置文件”行。

# web-services - 从 C# 中的 WebMethod 返回单个字符串值

> ID：15365025
> 
> 赞同：0
> 
> 时间：2013-03-12T15:14:25.620
> 
> 标签：web-services, c#-4.0, webmethod

我只想返回 messageID 但它不能正常工作。如何返回单个字符串值？

```
 [WebMethod]
    public string messageComeGetID(string from, string to)
    {
        try
        {
            sqlConn.Open();
        }
        catch (Exception e)
        {
            return null;
        }
        // select messageID from tblMessage where [from] = '2' AND [to] = '4' gibi.
        SqlCommand cmd3 = new SqlCommand("select messageID from tblMessage where [from]=@from AND [to]=@to", sqlConn);

        cmd3.Parameters.AddWithValue("@from", from);
        cmd3.Parameters.AddWithValue("@to", to);

        cmd3.Connection = sqlConn;
        object value = cmd3.ExecuteScalar();
        string messageID = Convert.ToString(value);
        cmd3.ExecuteNonQuery();
        cmd3.Dispose();
        sqlConn.Close(); 

        return messageID;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-28T06:12:27.840

我可以这样实现 **WebService1.asmx**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Script.Serialization;
using System.Web.Script.Services;
using System.Web.Services;

namespace StackOverflow_Solve.Services
{
    /// <summary>
    /// Summary description for WebService1
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [System.ComponentModel.ToolboxItem(false)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]
    public class WebService1 : System.Web.Services.WebService
    {

        [WebMethod]
        public string HelloWorld()
        {
            return "Hello World";
        }
        [WebMethod]
        [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
        public string GetMessage()   // Home.CS 
        {
            //return "GOGO";
            Context.Response.Output.Write("Hello World");
            Context.Response.End();
            return string.Empty;
        } 
    }
} 
```

全面实施是

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>
<body>
<head> //HTML and Ajax 
<title></title>

 <script>
     function GetMessage() {
         //Load jQuery($) to Use 
         $(function() {
             $.get("WebService1.asmx/GetMessage", function (data) {
                 console.log(data);
                 $("p").html(data);
             });
         });

     }
 </script>
</head>
<body>
    <input type="button" onclick="GetMessage()" value="Get Message" />
    <p></p>
</body>
</body>
</html> 
```

# javascript - Twitter Bootstrap Button Group Control Radio Buttons/Checkboxes

> ID：15365028
> 
> 赞同：51
> 
> 时间：2013-03-12T15:14:35.613
> 
> 标签：javascript, html, css, twitter-bootstrap

I am trying to use the [Twitter Bootstrap button group](http://twitter.github.com/bootstrap/javascript.html#buttons) as an actual set of form input controls. By default, these button groups can be made to function like a radio button or checkbox group, but since they use the `<button>` element, they cannot actually be used like a radio button or checkbox.

In my research, I found [this site](http://labs.thecssninja.com/bootleg/index.html#buttons) which uses CSS to make these bootstrap buttons actually control radio buttons and checkboxes. The only issue is they use rather recent features of CSS to work, and therefore, require IE9 or above to work.

I would like to extend support to IE8\. Is there another (perhaps JS controlled) solution which would offer the same features as the above link without the steep CSS requirements?

Thank you for your time.

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2013-09-18T23:49:06.073

**Bootstrap 3 has a "native" solution...**

There now is a "true" Bootstrap solution for this problem, which appears to work fine also on older browsers. Here's what it looks like:

```
// get selection
$('.colors input[type=radio]').on('change', function() {
    console.log(this.value);
});
```

```
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<div class="btn-group colors" data-toggle="buttons">
  <label class="btn btn-primary active">
    <input type="radio" name="options" value="red" autocomplete="off" checked> Red
  </label>
  <label class="btn btn-primary">
    <input type="radio" name="options" value="orange" autocomplete="off"> Orange
  </label>
  <label class="btn btn-primary">
    <input type="radio" name="options" value="yellow" autocomplete="off"> Yellow
  </label>
</div>

<!-- jQuery and Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
```

See [the relevant Bootstrap documentation](https://getbootstrap.com/docs/3.3/javascript/#buttons-checkbox-radio) for more information.

**Bootstrap 4**

Bootstrap 4 [supports component the same way as Bootstrap 3](https://getbootstrap.com/docs/4.1/components/buttons/#checkbox-and-radio-buttons), but Bootstrap 4 [does not support IE9](https://getbootstrap.com/docs/4.0/getting-started/browsers-devices/#internet-explorer). You might want to check out the [Bootstrap IE8](https://github.com/coliff/bootstrap-ie8) project.

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-03-12T18:24:39.640

**Bootstrap 2**

Try [this fiddle](http://jsfiddle.net/Eonasdan/KFKBD/1)

**HTML:**

```
<div class="btn-group" data-toggle="buttons-radio">
    <button type="button" class="btn btn-primary">Left</button>
    <button type="button" class="btn btn-primary">Middle</button>
    <button type="button" class="btn btn-primary">Right</button>
</div>
<input type="hidden" id="buttonvalue"/> 
```

**Script:**

```
$(".btn-group button").click(function () {
    $("#buttonvalue").val($(this).text());
}); 
```

then get `buttonvalue` server side

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-08-25T17:26:46.893

With Bootstrap 3.2 put the hidden input in the middle of your button group container. Instead of the text content we take the value of th data-value field.

```
<div id="test" class="btn-group checkit" data-toggle="buttons-radio">
    <button type="button" data-value="1" class="btn btn-default active">Yes</button>
    <input type='hidden' name="testfield" value='1'>
    <button type="button" data-value="0" class="btn btn-default ">No</button>
</div> 
```

Now insert a little javascript snippet into the onload part of your template.

```
$('.checkit .btn').click(function() {
    $(this).parent().find('input').val($(this).data("value"));
}); 
```

So you only need to add .checkit to your button group and insert a hidden input field.

With bootstrap 3.2 you can use button groups directly with radio- or checkbox-inputs

```
<div class="btn-group" data-toggle="buttons">
    <label class="btn btn-default">
        <input type="radio" name="options" id="option1" value="1" /> Yes
    </label>
    <label class="btn btn-default">
        <input type="radio" name="options" id="option2" value="0" /> No
    </label>
    <label class="btn btn-default">
        <input type="radio" name="options" id="option3" value="42" /> Whatever
    </label>
</div> 
```

See here: [http://jsfiddle.net/DHoeschen/gmxr45hh/1/](http://jsfiddle.net/DHoeschen/gmxr45hh/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T15:26:55.090

You can use hidden form elements and javascript to use the button state to trigger the form element states.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-21T19:03:54.527

CSS-only solution:

HTML:

```
<div class="btn-group">
    <label class="btn btn-primary"><input type="checkbox"><span>Button 1</span></label>
    <label class="btn btn-primary"><input type="checkbox"><span>Button 2</span></label>
</div> 
```

SCSS/LESS:

```
 label.btn {
    margin-bottom: 0;
    padding: 0;
    overflow: hidden;

    span {
      display: block;
      padding: 10px 15px;
    }

    input[type=checkbox] {
      display: none;
    }

    input:checked + span {
      display: block;
      color: #fff;
      background-color: #285e8e;
    }
  } 
```

[JSfiddle here](https://jsfiddle.net/oboshto/pbcxawfe/2/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-17T08:57:29.730

If you don't want to add JS code you can use this pure CSS solution:

HTML:

```
<div class="btn-group colors">
  <label class="btn btn-primary">
    <input type="radio" name="g1" value="red" autocomplete="off" checked> 
    <span class='active'></span>
    <span class='label'>RED</span>
    <span></span>
  </label>

  <label class="btn btn-primary">
    <input type="radio" name="g1" value="orange" autocomplete="off"> 
    <span class='active'></span>
    <span class='label'>ORANGE</span>
  </label>

  <label class="btn btn-primary">
    <input type="radio" name="g1" value="yellow" autocomplete="off"> 
    <span class='active'></span>
    <span class='label'>YELLOW</span>
  </label>
</div> 
```

CSS:

```
input {
  display:none;
}

input:checked + .active{
    background-color: #ff0000;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index:10;
}

.label{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 20;
} 
```

You may need to set a height and width for the buttons in CSS since the spans are positioned absolute.

See here [JSFiddle example](http://jsfiddle.net/jg41ksvh/1/)

# sql - 如何将 SQL 中的循环转换为基于集合的逻辑

> ID：15365029
> 
> 赞同：4
> 
> 时间：2013-03-12T15:14:39.037
> 
> 标签：sql, sql-server, sql-server-2008, tsql, stored-procedures

今天和昨天的大部分时间我都在尝试决定是否在 SQL 中使用循环或游标，或者弄清楚如何使用基于集合的逻辑来解决问题。我对设置逻辑并不陌生，但是这个问题似乎特别复杂。

## 问题

这个想法是，如果我有一个所有交易的列表（10 个，100 个数百万）和它们发生的日期，我可以开始将其中一些数据组合到每日总计表中，以便通过报告和分析更快地查看它系统。其伪代码如下：

```
foreach( row in transactions_table )
    if( row in totals_table already exists )
        update totals_table, add my totals to the totals row
    else
        insert into totals_table with my row as the base values
    delete ( or archive ) row 
```

如您所知，循环块实现起来相对简单，游标/循环迭代也是如此。但是，执行时间非常缓慢且笨拙，我的问题是：是否有一种非迭代的方式来执行这样的任务，或者这是我只需要“吸干”并使用光标的罕见例外之一?

关于这个话题已经有一些讨论，其中一些似乎相似，但由于 if/else 语句和对另一个表的操作而无法使用，例如：

[如何在基于列的逻辑上合并 SQL 数据行？](https://stackoverflow.com/questions/8979911/how-to-merge-rows-of-sql-data-on-column-based-logic) 这个问题似乎不适用，因为它只是返回所有总和的视图，实际上并没有就添加或更新另一个表做出逻辑决策

[SQL Looping](https://stackoverflow.com/questions/557734/sql-looping)似乎有一些关于使用几个 case 语句进行选择的想法，这似乎是可能的，但是我需要根据另一个表的状态完成两个操作，所以这个解决方案似乎不适合。

[不使用游标的每行的 SQL 调用存储过程](https://stackoverflow.com/questions/1656804/sql-call-stored-procedure-for-each-row-without-using-a-cursor) 这个解决方案似乎最接近我需要做的，因为它可以处理每行上的任意数量的操作，但似乎没有达成共识团体。

任何建议如何解决这个令人沮丧的问题？

## 笔记

我正在使用 SQL Server 2008

架构设置如下：

总计：（id int pk，totals_date 日期，store_id int fk，machine_id int fk，total_in，total_out）

交易：（transaction_id int pk，transaction_date datetime，store_id int fk，machine_id int fk，transaction_type（IN 或 OUT），transaction_amount 十进制）

总数应按商店、机器和日期计算，并且应将所有 IN 交易汇总到 total_in 并将 OUT 交易汇总到 total_out。目标是让一个伪数据立方体运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:21:56.917

您可以在两个基于集合的语句中执行此操作：

```
BEGIN TRANSACTION;

DECLARE @keys TABLE(some_key INT);

UPDATE tot
  SET totals += tx.amount
OUTPUT inserted.some_key -- key values updated
INTO @keys
FROM dbo.totals_table AS tot WITH (UPDLOCK, HOLDLOCK)
INNER JOIN 
(
  SELECT t.some_key, amount = SUM(amount)
  FROM dbo.transactions_table AS t WITH (HOLDLOCK)
  INNER JOIN dbo.totals_table AS tot
  ON t.some_key = tot.some_key
  GROUP BY t.some_key
) AS tx
ON tot.some_key = tx.some_key;

INSERT dbo.totals_table(some_key, amount)
  OUTPUT inserted.some_key INTO @keys
  SELECT some_key, SUM(amount)
  FROM dbo.transactions_table AS tx
  WHERE NOT EXISTS 
  (
    SELECT 1 FROM dbo.totals_table
    WHERE some_key = tx.some_key
  )
  GROUP BY some_key;

DELETE dbo.transactions_table
  WHERE some_key IN (SELECT some_key FROM @keys);

COMMIT TRANSACTION; 
```

（为简洁起见，省略了错误处理、适用的隔离级别、回滚条件等。）

您首先进行更新，这样您就不会插入新行然后更新它们，执行两次工作并可能重复计算。您可以在这两种情况下使用输出到临时表，然后从 tx 表中存档/删除行。

我提醒您在`MERGE`他们[解决了其中一些错误](http://www.sqlperformance.com/2013/02/t-sql-queries/another-merge-bug)之前不要太兴奋，并且您已经阅读了足够多的内容以确保您不会[对并发性和“更好”程度有任何错误的信心和没有额外提示的原子性](http://weblogs.sqlteam.com/dang/archive/2009/01/31/UPSERT-Race-Condition-With-MERGE.aspx)。您可以解决的竞争条件；你不能的错误。

**另一种选择，来自尼古拉的评论**

```
CREATE VIEW dbo.TotalsView
WITH SCHEMABINDING
AS
   SELECT some_key_column(s), SUM(amount), COUNT_BIG(*)
    FROM dbo.Transaction_Table
    GROUP BY some_key_column(s);
GO
CREATE UNIQUE CLUSTERED INDEX some_key ON dbo.TotalsView(some_key_column(s));
GO 
```

现在，如果您想编写获取总数的查询，您可以直接引用视图，或者 - 根据查询和版本 - 即使您引用基表，视图也可能会自动匹配。

*注意：如果您不在企业版上，则可能必须使用`NOEXPAND`提示来利用视图实现的预聚合值。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:23:29.117

我认为您不需要循环。

你可以

*   更新与您的过滤器/组匹配的所有行/总和存档/删除以前的。
*   插入与您的过滤器/组存档/删除以前不匹配的所有行。

SQL 应该使用大量数据而不是逐行使用。

# android - 使用robotium点击动态膨胀的视图

> ID：15365030
> 
> 赞同：0
> 
> 时间：2013-03-12T15:14:40.300
> 
> 标签：android, robotium

在我的应用程序中，当数据来自服务器时，我已经多次动态地扩展视图。例如，我`linearLayout`多次充气。现在我正在尝试使用robotium 测试对这些动态视图的点击。问题是动态添加的布局具有相同的 id，并且会被多次添加。如何单击每个动态膨胀的线性布局。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T18:14:31.280

这是一个静态函数，可以满足您的需求（我认为，我当前的机器上没有 android sdk 或任何东西，因此无法测试）。我自己不会将它用作静态函数，我会将它放在有意义的地方，但您可以随心所欲地使用它！

```
public static List<View> getViewsById(Solo solo, int id) {
    List<View> allViews = getViews();
    List<View> matchedViews = new ArrayList<View>();
    for(View view : allViews){
        if(view!=null && view.getId() == id){
            matchedViews.add(view);
        }
    }
    return matchedViews;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:47:01.757

用于`solo.getView(view.class,index).performClick();`获取特定索引中的视图并单击它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:04:00.800

它可以通过几种方式来完成。一个简单的解决方案是，当您膨胀视图时，应用一个点击监听器。就像您正在使用某个循环一样，在每次迭代中，在循环中添加点击侦听器。

# php - 删除数组中的所有唯一标题条目

> ID：15365032
> 
> 赞同：1
> 
> 时间：2013-03-12T15:14:43.587
> 
> 标签：php, arrays

我有一个“帖子标题”数据库，其中包含很多重复项，有时有超过 4 个具有相同标题的帖子。

我想构建一个数组来获取**每个**重复条目的 ID + Title。

```
$titles = array();
$duplicates = array(); //should be multi-dimensional array containing ID and title of each duplicate entry

//while statement
if (!in_array($post_title, $titles)){           
    array_push( $titles, $post_title) );
} else {
    array_push( $duplicates, $post_title) );
}
//end while 
```

问题在于我的`$duplicates`数组只包含“第二个”条目或“重复”-我想将两者存储在同一个数组中。我怎样才能使用类似`array_diff`或合并或类似的东西来做到这一点？

即，如果两个帖子包含相同的标题，我希望*这两个*最终都在我的 $duplicates 数组中，并将各自的 id 和标题放在一起。

还有 array_unique 函数，但我不太清楚如何在这种情况下使用它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:23:17.370

```
if (!in_array($post_title, $titles)){

      array_push( $titles, $post_title) );

}
array_push( $duplicates, $post_title) );

//end while 
```

这样，您将原始和重复存储在 $duplicates 数组中。

或者，您可以使用： `$titles = array_unique( $original_array );`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:28:49.093

假设`$titles[] = array( 'id' => integer, 'title' => string );`id:title 是 1:1 映射

```
$count = array();

foreach( $titles as $title ) {
  if( !isset($count[$title['id']]) ) {
    $count[$title['id']] = 1;
  } else {
    $count[$title['id']]++;
  }
}

foreach( $titles as $title ) {
  if( $count[$title['id']] > 1 ) {
    $duplicates[] = $title;
  }
} 
```

# properties - JBoss AS 7 应用程序特定的属性文件

> ID：15365036
> 
> 赞同：7
> 
> 时间：2013-03-12T15:14:51.267
> 
> 标签：properties, jboss7.x

我在 JBoss 7.1.1 AS 上部署了几个独立的 Java EE 模块（WAR Web 应用程序和 JAR EJB 模块）。我想要：

1.  将这些模块的配置集中在一个 *.properties 文件中。
2.  使该文件在类路径中可用。
3.  保持此文件的安装/配置尽可能简单。理想情况下只是将它放在一些 JBoss 文件夹中，例如：${JBOSS_HOME}/standalone/configuration。
4.  无需重新启动应用程序服务器即可使该文件的更改可用。

这可能吗？

我已经找到了这个链接：[How to put an external file in the classpath](https://community.jboss.org/wiki/HowToPutAnExternalFileInTheClasspath)，它解释了最好的方法是制作静态 JBoss 模块。但是，我必须在我部署的每个应用程序模块中都依赖这个静态模块，这是我试图避免的一种耦合。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-14T10:14:21.203

也许一个简单的解决方案是从单例或静态类中读取文件。

```
private static final String CONFIG_DIR_PROPERTY = "jboss.server.config.dir"; 

private static final String PROPERTIES_FILE = "application-xxx.properties";

private static final Properties PROPERTIES = new Properties();

static {
    String path = System.getProperty(CONFIG_DIR_PROPERTY) + File.separator + PROPERTIES_FILE;  
    try {  
        PROPERTIES.load(new FileInputStream(path));
    } catch (MalformedURLException e) {
       //TODO 
    } catch (IOException e) {
       //TODO
    } 
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-03-11T20:41:42.017

这是一个仅使用 CDI 的完整示例，取自此[站点](http://blog.chris-ritchie.com/2015/03/inject-external-properties-cdi-java-wildfly.html)。

此配置也适用于 JBoss AS7。

1.  在 WildFly 配置文件夹中创建并填充属性文件

    ```
    $ echo 'docs.dir=/var/documents' >> .standalone/configuration/application.properties 
    ```

2.  将系统属性添加到 WildFly 配置文件。

    ```
    $ ./bin/jboss-cli.sh --connect
    [standalone@localhost:9990 /] /system-property=application.properties:add(value=${jboss.server.config.dir}/application.properties) 
    ```

这会将以下内容添加到您的服务器配置文件（standalone.xml 或 domain.xml）中：

```
<system-properties>
    <property name="application.properties" value="${jboss.server.config.dir}/application.properties"/>
</system-properties> 
```

3.  创建加载和存储应用程序范围属性的单例会话 bean

    ```
    import java.io.File;
    import java.io.FileInputStream;
    import java.io.IOException;
    import java.util.HashMap;
    import java.util.Map;
    import java.util.Properties;

    import javax.annotation.PostConstruct;
    import javax.ejb.Singleton;

    @Singleton
    public class PropertyFileResolver {

        private Logger logger = Logger.getLogger(PropertyFileResolver.class);
        private String properties = new HashMap<>();

        @PostConstruct
        private void init() throws IOException {

            //matches the property name as defined in the system-properties element in WildFly
            String propertyFile = System.getProperty("application.properties");
            File file = new File(propertyFile);
            Properties properties = new Properties();

            try {
                properties.load(new FileInputStream(file));
            } catch (IOException e) {
                logger.error("Unable to load properties file", e);
            }

            HashMap hashMap = new HashMap<>(properties);
            this.properties.putAll(hashMap);
        }

        public String getProperty(String key) {
            return properties.get(key);
        }
    } 
    ```

4.  创建 CDI 限定符。我们将在我们希望注入的 Java 变量上使用这个注解。

    ```
    import java.lang.annotation.ElementType;
    import java.lang.annotation.Retention;
    import java.lang.annotation.RetentionPolicy;
    import java.lang.annotation.Target;

    import javax.inject.Qualifier;

    @Qualifier
    @Retention(RetentionPolicy.RUNTIME)
    @Target({ ElementType.METHOD, ElementType.FIELD, ElementType.CONSTRUCTOR })
    public @interface ApplicationProperty {

        // no default meaning a value is mandatory
        @Nonbinding
        String name();
    } 
    ```

5.  创建生产者方法；这将生成要注入的对象

    ```
    import javax.enterprise.inject.Produces;
    import javax.enterprise.inject.spi.InjectionPoint;
    import javax.inject.Inject;

    public class ApplicationPropertyProducer {

        @Inject
        private PropertyFileResolver fileResolver;

        @Produces
        @ApplicationProperty(name = "")
        public String getPropertyAsString(InjectionPoint injectionPoint) {

            String propertyName = injectionPoint.getAnnotated().getAnnotation(ApplicationProperty.class).name();
            String value = fileResolver.getProperty(propertyName);

            if (value == null || propertyName.trim().length() == 0) {
                throw new IllegalArgumentException("No property found with name " + value);
            }
            return value;
        }

        @Produces
        @ApplicationProperty(name="")
        public Integer getPropertyAsInteger(InjectionPoint injectionPoint) {

            String value = getPropertyAsString(injectionPoint);
            return value == null ? null : Integer.valueOf(value);
        }
    } 
    ```

6.  最后将属性注入您的 CDI bean 之一

    ```
    import javax.ejb.Stateless;
    import javax.inject.Inject;

    @Stateless
    public class MySimpleEJB {

        @Inject
        @ApplicationProperty(name = "docs.dir")
        private String myProperty;

        public String getProperty() {
            return myProperty;
        }
    } 
    ```

# python-2.7 - Python：使用 ArcPy：对访问表进行排序并转换为地理数据库表

> ID：15365037
> 
> 赞同：0
> 
> 时间：2013-03-12T15:14:52.310
> 
> 标签：python-2.7, arcpy

我喜欢将 access 数据库中的表（100+）转换为地理数据库表，对它们进行排序并同时删除每个表中不必要的字段。我想我使用 Sort_management 方法来转换和排序表，然后使用 DeleteFieldd_management 方法来删​​除字段。这是我写的代码，

```
import arcpy

from arcpy import env

env.workspace = "E:\Database Project\ACS Estimate 2011\ACS 2011 Tables.mdb"

tableList = arcpy.ListTables()

for table in tableList:

    out_dataset = "E:\Database Project\ACS Estimate 2011\Data\To Database\Seq Tables.gdb"

    #Process: Sort
    arcpy.Sort_management(table, out_dataset, "GEOID ASCENDING", "UR")

    #Process: Delete Field
    arcpy.DeleteField_management(out_dataset, "FILEID;FILETYPE;STUSAB;CHARITER") 
```

我收到以下错误消息，

![在此处输入图像描述](../Images/4c7f4e5d5eb3833f8571b2861f7986c7.png)

任何帮助是极大的赞赏。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:36:48.977

跟随@Evan，如果表格已经存在，您可以删除它。

```
if arcpy.Exists(out_dataset):
    arcpy.Delete_management(out_dataset) 
```

另外，如果我知道我将一遍又一遍地重新创建一个表并且我不想在我的代码中写这样的检查，我使用：

```
arcpy.env.overwriteOutput=True 
```

如果 arcpy 不能真正识别此表类型，那么您可以使用 python 的 os 模块或其他类似的东西来做一个类似的“如果存在”的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T17:30:28.727

在进入循环之前尝试设置`out_dataset`（紧接着`tableList = arcpy.ListTables()`看看它是否超过了“已经存在”的错误。

# c# - ProcessStartInfo.Argument 如何考虑参数

> ID：15365038
> 
> 赞同：6
> 
> 时间：2013-03-12T15:14:52.677
> 
> 标签：c#, process

我正在使用以下代码使用参数启动另一个进程，这里我将字符串路径作为参数传递，路径返回为*c:\documents 和 settings\\local settings:*：

```
string path = Directory.GetParent(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData)).FullName(); //path = c:\documents and settings\<username>\local settings

ProcessStartInfo startInfo = new ProcessStartInfo();
startInfo.Arguments = path;
Process.Start(startInfo); 
```

我想将路径作为一个参数传递，一个完整的字符串。但我发现路径已被多个参数分隔，它实际上被每个空格分隔。在这种情况下，它将*c:\documents*作为第一个参数，*第二*个参数和 *settings\\local*作为第三个参数...

我想将它们作为一个参数而不是 4 个参数传递。怎么能做到这一点`StartInfo.Argument`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T15:18:29.323

我不确定它是否有效，但请尝试`"`在您的路径周围使用：

```
startInfo.Arguments = "\"" + path + "\""; 
```

这将包含您的字符串`"`，因此空格将被忽略。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T15:20:14.067

Process 对象以与控制台完全相同的方式处理参数。使用双引号将任何包含空格的参数括起来：“\”c:\documents and settings\local settings\""。

一个好的提示是尝试使用您提供的任何参数从控制台运行该过程。这比从 Process 对象运行更容易理解错误反馈。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-12T15:18:28.713

将你的论点用引号括起来：

```
startInfo.Arguments = "\"" + path + "\""; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-10-30T21:55:58.993

**规则**

此处记录了解析转义的规则：[https ://msdn.microsoft.com/en-us/library/17w5ykft.aspx](https://msdn.microsoft.com/en-us/library/17w5ykft.aspx)

> Microsoft C/C++ 启动代码在解释操作系统命令行上给出的参数时使用以下规则：
> 
> 1.  参数由空格分隔，空格可以是空格，也可以是制表符。
>     
>     
> 2.  插入字符 (^) 未被识别为转义字符或分隔符。该字符在传递到程序中的 argv 数组之前完全由操作系统中的命令行解析器处理。
>     
>     
> 3.  由双引号 ("string") 包围的字符串被解释为单个参数，无论其中包含什么空格。带引号的字符串可以嵌入到参数中。
>     
>     
> 4.  前面有反斜杠 (\") 的双引号被解释为文字双引号字符 (")。
> 5.  反斜杠按字面意思解释，除非它们紧跟在双引号之前。
> 6.  如果偶数个反斜杠后跟双引号，则在 argv 数组中为每对反斜杠放置一个反斜杠，并将双引号解释为字符串分隔符。
> 7.  如果奇数个反斜杠后跟双引号，则每对反斜杠在 argv 数组中放置一个反斜杠，双引号被剩余的反斜杠“转义”，导致文字双引号（“ ) 放置在 argv 中。

**应用于生成**

不幸的是，没有关于如何正确转义参数的良好文档，即如何应用上述规则以确保将参数数组正确传递给目标应用程序。以下是我转义每个参数时遵循的规则：

1.  如果参数包含空格或制表符，请将其括在 "（双引号）字符中。

2.  如果参数包含 "（双引号），前面有 \（反斜杠）字符，则在附加转义的 "（双引号）之前用 \（反斜杠）转义前面的 \（反斜杠）字符。

3.  如果参数以一个或多个 \（反斜杠）结尾，并且包含空格，请在添加封闭的 "（双引号）之前使用 \（反斜杠）转义最后的 \（反斜杠）字符。

**编码**

```
/// <summary>
/// Convert an argument array to an argument string for using
/// with Process.StartInfo.Arguments.
/// </summary>
/// <param name="argument">
/// The args to convert.
/// </param>
/// <returns>
/// The argument <see cref="string"/>.
/// </returns>
public static string EscapeArguments(string argument)
{
    using (var characterEnumerator = argument.GetEnumerator())
    {
        var escapedArgument = new StringBuilder();
        var backslashCount = 0;
        var needsQuotes = false;

        while (characterEnumerator.MoveNext())
        {
            switch (characterEnumerator.Current)
            {
                case '\\':
                    // Backslashes are simply passed through, except when they need
                    // to be escaped when followed by a \", e.g. the argument string
                    // \", which would be encoded to \\\"
                    backslashCount++;
                    escapedArgument.Append('\\');
                    break;

                case '\"':
                    // Escape any preceding backslashes
                    for (var c = 0; c < backslashCount; c++)
                    {
                        escapedArgument.Append('\\');
                    }

                    // Append an escaped double quote.
                    escapedArgument.Append("\\\"");

                    // Reset the backslash counter.
                    backslashCount = 0;
                    break;

                case ' ':
                case '\t':
                    // White spaces are escaped by surrounding the entire string with
                    // double quotes, which should be done at the end to prevent 
                    // multiple wrappings.
                    needsQuotes = true;

                    // Append the whitespace
                    escapedArgument.Append(characterEnumerator.Current);

                    // Reset the backslash counter.
                    backslashCount = 0;
                    break;

                default:
                    // Reset the backslash counter.
                    backslashCount = 0;

                    // Append the current character
                    escapedArgument.Append(characterEnumerator.Current);
                    break;
            }
        }

        // No need to wrap in quotes
        if (!needsQuotes)
        {
            return escapedArgument.ToString();
        }

        // Prepend the "
        escapedArgument.Insert(0, '"');

        // Escape any preceding backslashes before appending the "
        for (var c = 0; c < backslashCount; c++)
        {
            escapedArgument.Append('\\');
        }

        // Append the final "
        escapedArgument.Append('\"');

        return escapedArgument.ToString();
    }
}

/// <summary>
/// Convert an argument array to an argument string for using
/// with Process.StartInfo.Arguments.
/// </summary>
/// <param name="args">
/// The args to convert.
/// </param>
/// <returns>
/// The argument <see cref="string"/>.
/// </returns>
public static string EscapeArguments(params string[] args)
{
    var argEnumerator = args.GetEnumerator();
    var arguments = new StringBuilder();

    if (!argEnumerator.MoveNext())
    {
        return string.Empty;
    }

    arguments.Append(EscapeArguments((string)argEnumerator.Current));

    while (argEnumerator.MoveNext())
    {
        arguments.Append(' ');
        arguments.Append(EscapeArguments((string)argEnumerator.Current));
    }

    return arguments.ToString();
} 
```

**测试用例**

这是我在验证上述代码时使用的测试用例（线束留给读者作为练习）

*注意：*我的测试用例是将以下情况的随机数作为输入 args 数组，将其编码为参数字符串，将字符串传递给将参数作为 JSON 数组输出的新进程，并验证输入 args数组匹配输出 JSON 数组。

```
+----------------------------------------+--------- ----------------------------------+
| 输入字符串 | 转义字符串 |
+----------------------------------------+--------- ----------------------------------+
| 引用的论点 | “引用的论点” |
| "报价 | \"报价 |
| "包装报价" | \"包装报价\" |
| “引用包装报价” | "\"引用包装的报价\"" |
| \反斜杠文字 | \反斜杠文字 |
| \\doubleBackslashLiteral | \\doubleBackslashLiteral |
| 尾随反斜杠\ | 尾随反斜杠\ |
| 双尾反斜杠\\ | 双尾反斜杠\\ |
| \ 带引号的反斜杠文字 | "\ 引用的反斜杠文字" |
| \\ 引用的双反斜杠文字 | "\\ 引用的双反斜杠文字" |
| 引用的尾随反斜杠\ | "引用尾随反斜杠\\" |
| 带引号的双尾反斜杠\\ | "引用的双尾反斜杠\\\\" |
| \"\backslashQuoteEscaping | "\\\"\backslashQuoteEscaping " |
| \\"\doubleBackslashQuoteEscaping | "\\\\\"\doubleBackslashQuoteEscaping " |
| \\"\\doubleBackslashQuoteEscaping | "\\\\"\\doubleBackslashQuoteEscaping " |
| \"\\doubleBackslashQuoteEscaping | "\\\"\\doubleBackslashQuoteEscaping " |
| \"\反斜杠引号转义 | "\\\"\反斜杠引号转义" |
| \\"\双反斜杠引号转义 | "\\\\\\"\双反斜杠引号转义" |
| \\"\\双反斜杠引号转义 | "\\\\\"\\双反斜杠引号转义" |
| \"\\双反斜杠引号转义 | "\\\"\\双反斜杠引号转义" |
| TrailingQuoteEscaping" | TrailingQuoteEscaping\" |
| TrailingQuoteEscaping\" | TrailingQuoteEscaping\\\" |
| TrailingQuoteEscaping\"\ | TrailingQuoteEscaping\\\"\ |
| TrailingQuoteEscaping"\ | TrailingQuoteEscaping\"\ |
| 尾随引号转义" | "尾随引号转义\"" |
| 尾随引号转义\" | "尾随引号转义\\\"" |
| 尾随引号转义\"\ | "尾随引号转义\\\"\\" |
| 尾随引号转义"\ | "尾随引号转义\"\\" |
+----------------------------------------+--------- ----------------------------------+

```

关于这个问题，这里还有其他答案。我只是更喜欢编码状态机而不是正则表达式（而且，它运行得更快）。 [https://stackoverflow.com/a/6040946/3591916](https://stackoverflow.com/a/6040946/3591916)很好地解释了如何做到这一点。

# binary-tree - 打印二叉树的叶节点

> ID：15365042
> 
> 赞同：0
> 
> 时间：2013-03-12T15:14:59.577
> 
> 标签：binary-tree

我正在编写一个递归函数，它打印出二叉树的叶节点。这是我到目前为止所拥有的：

```
public static void printLeafNodes(BinaryNode<AnyType> t)
{
      if(t == NULL)       
        return;
       if(t.left == NULL && t.right==NULL)      
          System.out.println(t.element); 
       else if(t.left != NULL && t.right == NULL) 
       printLeafNodes(t.left); 

       else 
             printLeafNodes(t.right);      
} 
```

如果有人能查明我的逻辑中的任何流程，我将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T15:17:32.460

```
public static void printLeafNodes(BinaryNode<AnyType> t)
{
      if(t == NULL)       
        return;
       if(t.left == NULL && t.right==NULL)      
          System.out.println(t.element); 
       printLeafNodes(t.left); 
       printLeafNodes(t.right);      
} 
```

# python - PYTHON：从 txt 文件中删除 POS 标签

> ID：15365046
> 
> 赞同：2
> 
> 时间：2013-03-12T15:15:05.027
> 
> 标签：python

我有以下 txt 文件，其中包含每个单词的 POS（[词性](http://en.wikipedia.org/wiki/Part-of-speech_tagging)）标签。

> 不用/jj 到/to 说/vb ,/, 我/ppss 被/bedz furious/jj at/in this/dt 无双/jj 侵/nn 上/in free/jj 企业/nn./。如何/wrb 敢/vbn 他们/ppss

有没有办法在没有 POS 标签的情况下读取文件，所以结果将是：

不用说，我对这种对自由企业的空前侵犯感到愤怒。他们怎么敢

所以，基本上我想删除`/`.

```
words = re.findall('\w+',open(input_file).read()) 
```

上面的代码将删除 / 但仍然出现 jj ， ppss 等缩写。那么，如何删除 / 后跟任何字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:18:46.033

这够好吗？

```
>>> import re
>>> s = 'Needless/jj to/to say/vb ,/, I/ppss was/bedz furious/jj at/in this/dt unparalleled/jj intrusion/nn upon/in free/jj enterprise/nn ./.'
>>> re.sub(r'/[^\s]+','',s)
'Needless to say , I was furious at this unparalleled intrusion upon free enterprise .' 
```

这只是删除任何以 开头的文本，`/`直到找到空格为止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:33:56.363

正如 Wooble 所建议的，您可以通过嵌套在列表理解中的两个拆分来执行此操作：

```
s = 'Needless/jj to/to say/vb ,/, I/ppss was/bedz furious/jj at/in this/dt unparalleled/jj intrusion/nn upon/in free/jj enterprise/nn ./.'
print " ".join(word.split("/")[0] for word in s.split()) 
```

输出：

```
Needless to say , I was furious at this unparalleled intrusion upon free enterprise . 
```

`s.split()`将句子拆分成单独的单词。`word.split("/")`将英语单词（或标点符号）与其词性分开。`word.split("/")[0]`只选择英文单词并丢弃 POS。`" ".join()`将生成的英语单词列表组合成一个字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T18:25:21.990

此代码考虑了 Wooble 的评论以及您需要处理字符串列表 afaiu：

```
li = [ ('//Needless/jj to/to say/vb ,/, '
        'I/ppss was/bedz fur/ious/jj at/in this/dt '
        'unparalleled/jj intrusion/nn upon/in '
        'free/jj enterprise/nn ./. '
        'How/wrb dared/vbn they/ppss'),
       '/Before/jj to/to say/vb ,/, /I/ppss am/bedz h/a/p/p/y/jj']

import re

def clean(s,r=re.compile('(?<![\s/])/[^\s/]+(?![\S/])')):
    return r.sub('',s)

x = map(clean, li)

print '\n\n'.join(x) 
```

结果

```
//Needless to say , I was fur/ious at this unparalleled intrusion upon free enterprise . How dared they

/Before to say , /I am h/a/p/p/y 
```

# .net - ADFS 2.0 单点登录说明

> ID：15365049
> 
> 赞同：2
> 
> 时间：2013-03-12T15:15:23.717
> 
> 标签：.net, silverlight, adfs2.0

我们有以下场景：使用表单身份验证的现有 .NET (Silverlight) 应用程序。我们希望扩展登录功能，以便已经登录 Active Directory 的用户在访问应用程序时无需再次登录。该应用程序将托管在 Active Directory 所在的另一个环境中。因此该应用程序无法直接访问 Active Directory。所以，我想要走的路是使用 ADFS 2.0，但我们希望澄清以下内容：

1.  是否可以实现“真正的单点登录”：一旦用户通过 AD 登录（通常是早上通过 windows 登录），他或她可以访问应用程序而不会被提示任何类型的对话框？

2.  如何在应用程序中实现它：是否“只是”将安全令牌提供给中间页面，该页面根据应用程序特定的用户列表验证域电子邮件地址，然后将用户重定向到应用程序的首页?

我浏览了以下资源

[如何配置 IIS 和 ADFS 以使用 Active Directory 作为声明提供程序](http://www.davidgiard.com/2012/12/23/HowToConfigureIISAndADFSToUseActiveDirectoryAsAClaimsProvider.aspx "如何配置 IIS 和 ADFS 以使用 Active Directory 作为声明提供程序")

[安装 ADFS 2 并联合应用程序](http://www.syfuhs.net/post/2010/08/13/Installing-ADFS-2-and-Federating-an-Application.aspx)

[如何安装 ADFS 2.0 并为 SSO 配置 SAML（自动登录/AD 登录集成）](http://www.thepicketts.org/2013/02/how-to-install-adfs-2-0-and-configure-saml-for-sso-auto-loginad-login-integration/)

- 但我仍然无法澄清上述内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-26T21:56:28.763

在挖掘和阅读了很多之后，我想出了以下内容：

术语“单点登录”有两种常见用法：

1）使用相同的身份登录多个应用程序。换句话说，您有一个身份，由单个身份存储定义，无论是活动目录还是其他任何东西，并且您在多个应用程序中使用该身份，直到并包括跨公司和网络边界。

2) 自动登录。这意味着网络、身份提供者和应用程序的组合共同创造了一种情况，即用户根本不需要提供他们的凭据，即使他们被检查过。通过能够获取和提交或测试计算机/网络凭据的应用程序，这有点神奇。Internet Explorer 可以使用 ADFS 执行此操作，但有人告诉我，它要求 AD 服务器与客户端位于同一林中。

不幸的是，我认为#2 是您所追求的，而且我很确定它不是 ADFS 的重要部分或考虑因素。我认为 ADFS 主要用于帮助“联合”登录，而不是“自动”登录。

# iphone - 如何在 iOS 中插入和覆盖音频文件

> ID：15365051
> 
> 赞同：0
> 
> 时间：2013-03-12T15:15:28.593
> 
> 标签：iphone, ios, objective-c, xcode, core-audio

我正在开发一个具有录音机的应用程序。用户应该能够播放音频文件并将录音插入其中..剪切不需要的音频..覆盖音频文件的某些部分。

你见过[如何插入，覆盖音频文件 - 音频编辑 iphone](https://stackoverflow.com/questions/1584035/how-to-insert-overwrite-audio-files-audio-editing-iphone)吗？但是没有人回答这个...

至少建议我一种方法来实现这个....

提前谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T08:56:32.660

你在说什么类型的音频文件？您几乎肯定需要将您正在使用的任何内容转换为 PCM WAV 数据以进行此类操作。幸运的是，其他人向您指出的 Core Audio 提供了一些方便的方法来执行此操作。

获得原始 PCM 数据后，您只需在数据中的所需点插入其他 PCM 数据即可插入。您要确保不要在立体声数据包的中间进行写入或类似的操作，但除此之外，大多数简单格式化的 PCM 数据都非常容易操作。把它想象成一个字符串——你可以从“Hello World”开始，然后把它改成“Hello, Beautiful World”，只是在中间插入数据。

覆盖是相同的原则。

完成编辑后，您需要将 PCM 数据转换回您之前保存的任何格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:55:19.840

看看[核心音频](https://developer.apple.com/library/ios/#documentation/MusicAudio/Conceptual/CoreAudioOverview/Introduction/Introduction.html)

> Core Audio 提供软件接口，用于在您为 iOS 和 OS X 创建的应用程序中实现音频功能。在底层，它处理每个平台上的音频的所有方面。在 iOS 中，Core Audio 的能力包括录音、播放、音效、定位、格式转换和文件流解析，以及：

# asp.net - FileUpload1.HasFile 为 False

> ID：15365052
> 
> 赞同：2
> 
> 时间：2013-03-12T15:15:28.970
> 
> 标签：asp.net, vb.net, file-upload

我试图在互联网上搜索问题，我看到每个人都在询问 UpdatePanel 中的 FileUpload 控件的问题。首先，我没有使用 UpdatePanel。下面是我的代码：

**HTML**

```
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" method="post" runat="server" enctype="multipart/form-data">
    <div>
        <asp:FileUpload ID="fuImport" runat="server" />
        <asp:Button ID="btnImport" runat="server" Text="Import" />
    </div>
    </form>
</body>
</html> 
```

**代码背后**

```
Protected Sub btnImport_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnImport.Click
    If (fuImport.HasFile) Then
        fuImport.SaveAs(My.Settings.FileImportPath & Path.GetFileName(fuImport.FileName))
    End If
End Sub 
```

我看到 fuImport.HasFile 是 False，但 fuImport.FileName 只给出了文件名。例如，如果我选择`c:\1.txt`，它只会给出`"1.txt"`。有人可以告诉我为什么 fuImport.HasFile 是 False 尽管我选择了一个文件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T18:33:07.563

我找到了答案。我上传的 txt 文件是空的。我编辑了文本文件，然后在其中输入了一些内容来保存。我在 msdn 中提到的任何地方都找不到这个，或者我不确定我是否看错了地方。Kasys 在[这篇文章](https://stackoverflow.com/a/13397573/740756)中的建议帮助了我。

# azure - 服务重启后无法连接到 Azure VM 实例

> ID：15365055
> 
> 赞同：1
> 
> 时间：2013-03-12T15:15:32.810
> 
> 标签：azure, remote-desktop, restart

我无法通过远程桌面（网站中的连接选项）连接到我的服务的 Azure VM 实例。我仅在服务重新启动后才注意到这一点。对这个问题有任何想法吗？以及如何修复它\解决方法？

# python - 使用 etree 从文件中解析 xml 在读取字符串时有效，但不是文件

> ID：15365056
> 
> 赞同：1
> 
> 时间：2013-03-12T15:15:38.207
> 
> 标签：python, xml, xml-parsing, xml.etree

我是 Python 和 SO 的相对新手。我有一个需要从中提取信息的 xml 文件。我已经为此苦苦挣扎了好几天，但我想我终于找到了可以正确提取信息的东西。现在我很难获得正确的输出。这是我的代码：

```
from xml import etree
node = etree.fromstring('<dataObject><identifier>5e1882d882ec530069d6d29e28944396</identifier><description>This is a paragraph about a shark.</description></dataObject>')
identifier = node.findtext('identifier')
description = node.findtext('description')
print identifier, description 
```

我得到的结果是“5e1882d882ec530069d6d29e28944396 这是一个关于鲨鱼的段落。”，这就是我想要的。

但是，我真正需要的是能够从文件而不是字符串中读取。所以我试试这段代码：

```
from xml import etree
node = etree.parse('test3.xml')
identifier = node.findtext('identifier')
description = node.findtext('description')
print identifier, description 
```

现在我的结果是“无无”。我有一种感觉，我要么没有正确获取文件，要么输出有问题。这是test3.xml的内容

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<response xmlns="http://www.eol.org/transfer/content/0.3" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dwc="http://rs.tdwg.org/dwc/dwcore/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:dwct="http://rs.tdwg.org/dwc/terms/" xsi:schemaLocation="http://www.eol.org/transfer/content/0.3 http://services.eol.org/schema/content_0_3.xsd">
  <identifier>5e1882d822ec530069d6d29e28944369</identifier>
  <description>This is a paragraph about a shark.</description> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:17:30.307

您的 XML 文件使用默认命名空间。您需要使用正确的命名空间来限定您的搜索：

```
identifier = node.findtext('{http://www.eol.org/transfer/content/0.3}identifier') 
```

让 ElementTree 匹配正确的元素。

你也可以给`.find()`,`findall()`和`iterfind()`方法一个显式的命名空间字典。这没有很好地记录：

```
namespaces = {'eol': 'http://www.eol.org/transfer/content/0.3'} # add more as needed

root.findall('eol:identifier', namespaces=namespaces) 
```

前缀*只会*在您传入的参数中查找`namespaces`。这意味着您可以使用任何您喜欢的命名空间前缀；API 将部分拆分出来`eol:`，在字典中查找相应的命名空间 URL `namespaces`，然后将搜索更改为查找 XPath 表达式`{http://www.eol.org/transfer/content/0.3}identifier`。

如果您可以切换到[`lxml`图书馆](http://lxml.de/)，那就更好了；`.nsmap`该库支持相同的 ElementTree API，但在元素的属性中为您收集命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:21:12.927

你有没有想过尝试beautifulsoup 用python 解析你的xml：

[http://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#Parsing%20XML](http://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#Parsing%20XML)

有一些很好的文档和一个健康的在线小组，所以支持非常好

一种

# css - 居中的相对 ap div 正好在顶部

> ID：15365057
> 
> 赞同：0
> 
> 时间：2013-03-12T15:15:41.517
> 
> 标签：css

我有一个位于页面中心的 ap div 容器。但是在我的容器顶部有一个小间隙，我希望它正好在 0px 的顶部，而没有那个烦人的小间隙。

```
#container {
position: relative;
margin: 0 auto;
width: 1024px;
height: 1930px; 
```

}

我希望有人能回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:17:30.230

添加这个：

```
body {
    margin: 0;
} 
```

# php - FOS UserBundle 和 Twig 错误

> ID：15365058
> 
> 赞同：1
> 
> 时间：2013-03-12T15:15:42.620
> 
> 标签：php, symfony, twig, fosuserbundle

最近我一直在尝试安装`FOSUserBundle`我的`Symfony 2.1`应用程序。我完成了安装和配置过程，没有任何错误。但是，当我`myapp/app_dev.php/login`在浏览器地址栏中输入路径时，出现以下错误：

```
ErrorException: Warning: array_key_exists() expects parameter 2 to be array, null given in /home/kasia/WWW/herold-statistik/vendor/symfony/symfony/src/Symfony/Bridge/Twig/NodeVisitor/Scope.php line 94 
```

这个错误似乎出现在每个使用`FOS templates`. 它仅在从文件`{% extends %}`中删除标签时才会消失。覆盖模板对我不起作用。`{% block %}``Twig`

我将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:51:59.270

问题不在于**FOSUserBundle**。它来自**TwigBridge**的修复。有一个待处理的 PR，但您可以手动修复它，请查看[此处](https://github.com/symfony/symfony/pull/7281)。

# ios - 从被拒绝的证书中清除 XCode 缓存

> ID：15365060
> 
> 赞同：0
> 
> 时间：2013-03-12T15:15:54.820
> 
> 标签：ios, xcode

我在苹果配置文件上创建并撤销了证书。如何让 xcode 只显示有效证书？现在它向我显示所有证书，即使是我撤销的证书！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:39:13.137

假设您确实想要摆脱 Xcode Organizer 中显示的过期配置文件，请选择每一个并单击键盘上的 Delete 键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-13T08:45:00.950

为此，您可以从 Xcode -> Preference -> Organizer -> Manage Certificate 中删除

**或者**

您可以直接从 Keychain Access -> Certificates 中删除，搜索过期/吊销的证书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-04T15:02:38.360

我使用此 Keychain Access -> Certificates 删除它们，搜索过期/吊销的证书。

但是，有一个问题需要注意。如果您打开了 xcode，则无法删除它们，也没有错误消息。它只是说删除证书，然后什么也没有发生，它仍然在你的钥匙串中。需要关闭 Xcode 才能删除它们。

# python - 连接时如何避免将整数转换为字符串

> ID：15365064
> 
> 赞同：2
> 
> 时间：2013-03-12T15:16:11.077
> 
> 标签：python

我知道在 python 中，你不能简单地这样做：

```
number = 1
print "hello number " + number 
```

你必须这样做：

```
print "hello number " + str(number) 
```

否则你会得到一个错误。

**那么，我的问题是**，作为 python 如此紧凑的语言，以及在许多其他语言中可用的从整数到字符串的自动转换/转换功能，是否避免`str()`每次都必须使用该功能？一些晦涩的导入，或者只是另一种方法？

**编辑：**当我说另一种方式时，我的意思是更简单更紧凑的编写方式。因此，例如，我不会真正考虑`format`替代方案。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:17:15.050

你可以避免`str()`：

```
print 'hello number {}'.format(number) 
```

反正，

```
'abc' + 123 
```

相当于

```
'abc'.__add__(123) 
```

而`__add__`strings的方法只接受字符串。

就像

```
123 + 'abc' 
```

相当于

```
(123).__add__('abc') 
```

整数方法只`__add__`接受数字（int/float）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T15:18:00.980

您可以使用[旧的](http://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting)字符串格式：

```
print "hello number %s" % number 
```

或[新的](http://docs.python.org/3/library/string.html#formatstrings)：

```
print "hello number {}".format(number) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T17:20:16.040

我倾向于使用更紧凑的格式

```
>>> print "one",1,"two",2
one 1 two 2 
```

或者，在 python 3 中，

```
>>> print("one",1,"two",2)
one 1 two 2 
```

但是请注意，这两个选项总是会在每个参数之间引入一个空格，这使得它不适合更复杂的输出格式，您应该使用其他一些解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T15:19:14.313

正如[这个](https://stackoverflow.com/a/6981532/1167234)答案所解释的，这在 Python 中不会发生，因为它是强类型的。这意味着 Python 不会转换您没有明确表示要转换的类型。

# vb.net - 通过 COM 接口向 VBA 公开 .NET DataTable 属性

> ID：15365065
> 
> 赞同：2
> 
> 时间：2013-03-12T15:16:14.007
> 
> 标签：vb.net, vba, excel, com, interop

我正在尝试创建一个.Net DLL，基本上作为数据库连接的抽象层；它将替换我们用 VB6 编写的当前 DLL，我正在尝试尽可能地匹配当前功能。

无论如何，我遇到的基本问题是我找不到一种方法来让像 DataColumnCollection 或 DataColumn 这样的 .Net 类显示在 VBA 解释器中——例如，它可能会说，类型为“MarshalByValueComponent”的“Column”， ”，但值为“无变量”。

如果我完全重新创建两个类（即字段作为字段的集合，它继承自 DataColumn，然后为两者定义一个接口），我可以让它工作，但这似乎增加了很多开销（应该是？）一个非常简单的想法。我觉得我只是在编组器处理 DataColumn 类的方式上遗漏了一些非常简单的东西。

我在网上找到的很多东西都是关于如何将 DataTable 或 DataReader 转换为旧版 ADODB 记录集，但这也会增加很多开销......我宁愿将它保留为 DataTable 并创建一个 COM 接口允许 VBA 与之交互；这样，例如，如果他们想将表写入 excel 表，我就不会重复工作（转换为 ADODB 记录集，然后读/写到 excel 表。您需要将整个表迭代两次。 ..)

很抱歉，对于本书长度的解释——我觉得这个问题需要澄清一下，因为根本原因是试图匹配遗留功能。这是我当前界面不起作用的示例：

```
Public Interface IDataTable
    ReadOnly Property Column As DataColumn
End Interface

<ClassInterface(ClassInterfaceType.None)> _
<System.ComponentModel.DesignerCategory("")> _
<ComDefaultInterface(GetType(Recordset.IDataTable))> _
<Guid("E7AFBBB6-CB20-44EC-9CD2-BC70B94CD8B7")> _
Public Class Recordset : Inherits Data.DataTable : Implements IDataTable

Public ReadOnly Property Column As DataColumn Implements IDataTable.Column
    Get
        Return MyBase.Columns(0)
    End Get
End Property 
```

注意：我最初尝试将属性 Columns 作为返回 MyBase.Columns 的 DataColumnCollection。它以对象的形式出现，而不是 MarshalByValueComponent，但也是空的。我知道 MyBase.Column(0) 有一个值，因为我可以将 Msgbox(MyBase.Columns(0).ColumnName) 放在 get 中的 return 正上方，它会很好地弹出（不要判断；这比为此使用调试器）...

我不介意同时定义它们，但我不能继承 DataColumnCollection 并且 COM 接口在处理泛型方面已经很烂了。在不重新发明轮子的情况下，有没有其他方法可以解决这个问题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:23:56.927

在过去的 3 周里，我刚刚做了一些非常相似的事情。

我最终制作了两个 .NET 程序集：

1.  与数据存储区对话的纯 .NET 程序集（供 .NET 应用程序使用）。
2.  包装第一个程序集并添加 COM 开销（ADODB 引用和 COM-Visible 接口）的“COM 互操作”程序集。

我使用 VSTO“AddIn.Object”属性从 Excel VBA 调用第二个程序集。

正如你提到的，我最终将 System.Data.DataTables 转换为 ADODB.Recordsets。让 .NET 和 VBA 谈论除原始类型之外的任何内容对我来说非常令人沮丧。事实上，我最终将一些对象序列化为 JSON，以便两个世界可以通信。

这看起来确实很疯狂，但我重新发明了轮子。

* * *

*   我按照这篇[MSDN](http://blogs.msdn.com/b/andreww/archive/2007/01/15/vsto-add-ins-comaddins-and-requestcomaddinautomationservice.aspx)文章使我的 .NET 代码可由 VBA 调用。
*   我使用此[代码项目](http://www.codeproject.com/Articles/10503/Simplest-code-to-convert-an-ADO-NET-DataTable-to-a)文章（我相信您已经看过）转换为 Recordset*。
*   我让框架处理字符串、整数等。
*   对于所有其他数据类型，我使用[Json.Net](http://json.codeplex.com/)和自定义 VBA 类来进行 JSON 序列化。

    *将文章转换为 VB.Net 并添加了一些额外的错误处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T01:24:32.243

好的，这可能不是最优雅（或目前最完整）的解决方案；但我认为这是我要走的路。

我没有将整个内容转换为 ADODB 记录集（并复制任何迭代），而是完全抛弃了 DataTable 类，并将我自己的 Recordset 类编写为通用数据读取器的 COM 包装器（通过 IDataReader 接口）并添加了一个新的 Field 类来管理类型转换并将 Fields 设置为 Field 数组（因为互操作讨厌泛型）

它基本上创建了一个只进的 ADODB 记录集（同样的限制），但它的好处是一次只加载一行，所以大部分数据可以作为托管代码处理，直到你知道他们想用它做什么（我'将为使用阅读器的 ToArray、ToAccessDB、ToFile 等添加方法），同时仍然允许从 excel/access/vbscript/vb6 迭代记录集的能力（如果这真的是他们想要做的.. 最需要无论如何都用于遗留支持）这是一个示例，以防其他人必须再次执行此操作；为简洁起见进行了一些修改：

```
Public Interface IRecordset
    ReadOnly Property CursorPosition As Integer
    ReadOnly Property FieldCount As Integer
    ReadOnly Property Fields As Field()

    Function ReadNext() As Boolean
    Sub Close()
End Interface

 <System.ComponentModel.DesignerCategory("")> _
 <ClassInterface(ClassInterfaceType.None)> _
 <ComDefaultInterface(GetType(IRecordset))> _
 <Guid("E7AFBBB6-CB20-44EC-9CD2-BC70B94CD8B7")> _
 Public Class Recordset : Implements IRecordset : Implements IDisposable
    Private _Reader = Nothing
    Private _FieldCount As Integer = Nothing
    Private _Fields() As Field
    Public ReadOnly Property CursorPosition As Integer Implements IRecordset.CursorPosition...
    Public ReadOnly Property FieldCount As Integer Implements IRecordset.FieldCount...
    Public ReadOnly Property Fields As Field() Implements IRecordset.Fields...

    Friend Sub Load(ByVal reader As IDataReader)
        _Reader = reader
        _FieldCount = _Reader.FieldCount
        _Fields = Array.CreateInstance(GetType(DataColumn), _FieldCount)
        For i = 0 To _FieldCount - 1
            _Fields(i) = New Field(i, Me)
        Next
    End Sub

    'This logic kinda sucks and is dumb.
    Public Function ReadNext() As Boolean Implements IRecordset.ReadNext
        _EOF = Not _Reader.Read()
        If _EOF Then Return False
        _CursorPosition += 1
        For i = 0 To _FieldCount - 1
            _Fields(i)._Value = _Reader.GetValue(i).ToString
        Next
        Return True
    End Function 
```

从这里您只需要定义一些类型，如 Field 或 Column 并为该类型添加一个互操作包装器：

```
Public Interface IField
    ReadOnly Property Name As String
    ReadOnly Property Type As String
    ReadOnly Property Value As Object
End Interface

<System.ComponentModel.DesignerCategory("")> _
<ClassInterface(ClassInterfaceType.None)> _
<Guid("6230C670-ED0A-48D2-9429-84820DC2BE6C")> _
<ComDefaultInterface(GetType(IField))> _
Public Class Field : Implements IField
    Private Reader As IDataReader = Nothing
    Private Index As Integer = Nothing
    Public ReadOnly Property Name As String Implements IField.Name
        Get
            Return Reader.GetName(Index)
        End Get
    End Property
    Public ReadOnly Property Value As Object Implements IField.Value
        Get
            Return Reader.GetValue(Index)
        End Get
    End Property
    Public ReadOnly Property Type As String Implements IField.Type
        Get
            Return Reader.GetDataTypeName(Index).ToString
        End Get
    End Property
    Sub New(ByVal i As Integer, ByRef r As IDataReader)
        Reader = r
        Index = i
    End Sub
End Class 
```

所有这些都是相当愚蠢的，但它似乎运作良好。

注意：我现在只使用 .Net 大约 4 天，所以这可能很糟糕，请随时评论我可能做的任何极其愚蠢的事情。

# php - 函数 CurrentPageURL() 响应操作表单的名称，而不是实际的 URL

> ID：15365070
> 
> 赞同：0
> 
> 时间：2013-03-12T15:16:21.913
> 
> 标签：php, forms, url, get, smarty

我在tellform表单的.php文件中有以下几行：

```
// Gets the current URL
function CurrentPageURL()
{
    $pageURL = $_SERVER['HTTPS'] == 'on' ? 'https://' : 'http://';
    $pageURL .= $_SERVER['SERVER_PORT'] != '80' ? $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"] : $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI'];
    return $pageURL;
}
$url = CurrentPageURL(); 
```

在下面的某个地方： `$message = "Hi! blahblahblah : $url";`

此外，在 .tpl 文件中，我有以下行：

```
<form id="tellform" action="tellafriend/processTell.php" method="post"> 
```

一切正常，除了发送的电子邮件包含 /tellafriend/processTell.php 的链接，而不是浏览器中显示的产品的实际链接。我应该怎么做才能纠正这个问题？谢谢！

编辑 1 这里是关于提交电子邮件的 .js 部分：

```
// Use Ajax to send everything to processTell.php
submitHandler: function(form) {
    $("#send").attr("value", "Slanje...");
    $(form).ajaxSubmit({
        success: function(responseText, statusText, xhr, $form) {
            $(form).slideUp("fast");
            $("#response-tell").html(responseText).hide().slideDown("fast");
        }
    });
    return false;
} 
```

**解决了所以，感谢IMSoP，我解决了这个问题**。**他解释了问题出在哪里，所以最后我明白了。我完全删除了这些`function CurrentPageURL`行，并在相关表单的 .tpl 页面中插入了以下代码：**

 **```
<input type="hidden" name="urlToPutInEmail" value="<?php echo $this->url->link('product/product', 'product_id=' . $product_id); ?>" /> 
```

在 tellform.php 文件中，我调用了 varible `$urlToPutInEmail`。简单的是......注意，这是在opencart框架上工作的。

再次感谢 IMSoP！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:13:21.320

您的 JS 没有发送电子邮件，而是将表单提交到另一个 PHP 文件（使用`ajaxSubmit`）。

就 PHP 而言，AJAX 请求就像任何其他页面请求一样——在这种情况下，它就像您的表单具有一个普通的“提交”按钮。

因此，如果是“tellafriend/processTell.php”接收表单数据并生成电子邮件，那么“当前 URL”将是“tellafriend/processTell.php”。

如果您真正想要的是*前*一页的 URL （即打开表单的那个），您需要将其作为表单中的一个额外字段传递（例如，`<input type="hidden">`使用您的 PHP 函数填充一个）。**

# .net - Excel 中的长时间运行操作

> ID：15365084
> 
> 赞同：2
> 
> 时间：2013-03-12T15:17:24.940
> 
> 标签：.net, vba, excel, excel-2010

我有一个 Excel 电子表格和一个 .Net 库，它可以进行一些相当复杂的计算。.Net 程序集通过 COM 公开给 Excel 中的 VBA 代码。

当我调用 .Net 库时，Excel UI 线程在计算过程中被阻塞。

这会阻止用户与 Excel 交互，并且在某些情况下会向用户指示 Excel 在标题栏中（未响应）。

我对 Excel 2010 中的 VBA 不太了解，但是有没有办法在不同的线程中产生对我的 .Net 库的调用并向用户显示“进行中”对话框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:38:09.920

这是可能的，但可能需要一些努力才能将所有内容连接起来。有很多方法可以解决这个问题，其中一种可能类似于：

*   VBA 在 UI 线程上调用 C# COM 对象
*   C# COM 对象启动一个[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)来运行计算。请注意，您不能从`BackgroundWorker`的 `DoWork`事件处理程序访问 Excel 对象模型。如果您想在计算过程中更新 Excel，`BackgroundWorker`则应使用该`ReportProgress`方法在 UI 线程上报告进度。
*   在`ProgressChanged`事件处理程序（在 UI 线程上运行）中，C# 代码可以直接更新 Excel 对象模型，也可以调用 VBA 代码来执行更新。
*   VBA 代码可以在 BackgroundWorker 运行时显示进度对话框，以避免任何重入问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:25:56.400

很可能不，你不能在 C# 中使用另一个线程。Excel 是一个单线程应用程序，该线程是 UI 线程，因此使用 Excel 的对象模型*会*阻塞 UI。

另一种方法是使用[OpenXmlSdk](http://www.microsoft.com/en-us/download/details.aspx?id=5124)并使用它在单独的线程上对 Excel 数据的副本执行操作，然后重新加载数据。根据数据的大小和计算时间，它可能非常值得。我在 Word 中对大约 100 页的文档使用了这种技术，它将处理时间从 10 分钟缩短到 <30 秒，其中大部分 30 秒用于从 Word 导出和导入数据。Excel 在该领域往往要快一些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:30:45.013

使用 VBA 很难做到这一点，因为 Excel VBA 几乎是单线程同步的。但 Excel 2010 确实支持异步 UDF：查看 Excel DNA 或 Addin Express 以获取有关从 .NET 执行此操作的一些帮助。
[http://exceldna.codeplex.com/wikipage?title=Performing%20Asynchronous%20Work&referringTitle=文档](http://exceldna.codeplex.com/wikipage?title=Performing%20Asynchronous%20Work&referringTitle=Documentation)
[http://www.add-in-express.com/add-in-net/index.php](http://msdn.microsoft.com/en-us/library/office/ff796219%28v=office.14%29.aspx)

[2](http://msdn.microsoft.com/en-us/library/office/ff796219%28v=office.14%29.aspx)： http: [//www.add-in-express.com/add-in-net/index.php](http://www.add-in-express.com/add-in-net/index.php)
您也可以从基于 C 的 XLL
[http://msdn.microsoft.com/en-us/执行此操作图书馆/办公室/ff796219%28v=office.14%29.aspx](http://msdn.microsoft.com/en-us/library/office/ff796219%28v=office.14%29.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T17:33:40.500

一种有点疯狂的替代方案（大多数 VBA 解决方案都是）并且没有被提及——您可以生成动态 VBScript，它们几乎可以作为线程工作并在后台工作并将它们连接到 Excel。我不久前在这个博客上读到了这个想法：[http ://www.databison.com/index.php/multithreaded-vba-an-approach-to-processing-using-vbscript/](http://www.databison.com/index.php/multithreaded-vba-an-approach-to-processing-using-vbscript/)

它不是很优雅，但它是一种选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-19T09:52:41.633

您应该使用 Excel-dna 来执行此操作。使用它调用异步操作将相当容易。

# android - 用于商业项目的 mapquest 社区版（开放数据）

> ID：15365088
> 
> 赞同：1
> 
> 时间：2013-03-12T15:17:31.120
> 
> 标签：android, android-maps

目前我正在开发一个使用地图和地理编码功能的应用程序。

我正在使用 mapquest api，它就像一个魅力。

作为一个非母语人士，我在理解 mapquest 术语时遇到了一些麻烦。

我可以将 mapquest android api/library 与 Community Edition（开放数据）一起用于商业项目吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T11:02:02.853

是的，它可以用于商业项目

这是我从 mapquest 得到的回复：

> 感谢您的查询。我很高兴回答您关于 MapQuest Community Edition 使用条款的问题。是的，您可以在用于商业用途的 Android 应用程序中使用社区版。您仍然拥有每天 5,000 个的地理编码限制和每天 5,000 个的行车方向限制。

# javascript - getElementById(x).value 总是未定义？

> ID：15365090
> 
> 赞同：0
> 
> 时间：2013-03-12T15:17:34.337
> 
> 标签：javascript, html, getelementbyid

好的，先写代码。页面代码可以在[https://dl.dropbox.com/u/2628118/SMCH%20Portal%20-%20Home%20Page.htm](https://dl.dropbox.com/u/2628118/SMCH%20Portal%20-%20Home%20Page.htm)查看，下面是我要运行的 JS。

```
 function checkClear(id){
        var place = document.getElementById(id);
        var gplace = document.getElementById(id+'check');
        var patt1=new RegExp("^[a-zA-Z]+$");
        if(patt1.test(id.value)==true){
            gplace.innerHTML='<img src="img/gcheck.png" style="height:15px; width:auto;">';
            alert(id.value);
        }
        else{
            gplace.innerHTML='<img src="img/redx.png" style="height:15px; width:auto;">';
            alert(id.value);
        }
    } 
```

我已经仔细检查了 DOM，我尝试过进行表单导航，我没有使用 JQuery，但我可能会将其添加到我正在构建的更高版本中。我必须重组我已经构建的所有东西才能合并它，我会这样做，只是还没有。

我的问题：我似乎无法获取输入表单的值。我一直不确定，我无法对其进行良好的 reg 检查以确保它只是基本文本。用户错误预防，我就是那样的偏执狂。我已经尝试这件事好几个小时了。我知道这可能很简单。请帮帮我！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:23:18.937

您无法获取 id 的值，您只能获取具有该 id 的元素的值，因此请`id.value`使用`place.value`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:32:28.953

试试这个：

```
function checkClear(id){
    var place = document.getElementById(id); 
    var gplace = document.getElementById(id+'check'); 
    var patt1=new RegExp("^[a-zA-Z]+$");
    if(patt1.test(place.value)==true){
        gplace.innerHTML='<img src="img/gcheck.png" style="height:15px; width:auto;">';
        alert(place.value);
    }
    else{
        gplace.innerHTML='<img src="img/redx.png" style="height:15px; width:auto;">';
        alert(place.value);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:33:21.607

如果您使用 jQuery 库，则可以轻松使用它。

`if(place.value.match(^[a-zA-Z]+$)==true){`

否则你可以创建正则表达式对象并使用它。

```
 function checkClear(id){
    var place = document.getElementById(id);
    var gplace = document.getElementById(id+'check');
    if(place.value.match(^[a-zA-Z]+$)==true){
        gplace.innerHTML='<img src="img/gcheck.png" style="height:15px; width:auto;">';
        alert(place.value);
    }
    else{
        gplace.innerHTML='<img src="img/redx.png" style="height:15px; width:auto;">';
        alert(place.value);
    }
} 
```

# java - 如何在没有错误警告的情况下在excel中输出id号

> ID：15365091
> 
> 赞同：2
> 
> 时间：2013-03-12T15:17:35.547
> 
> 标签：java, excel, apache-poi

我正在使用 POI 将产品 ID 输出到 Excel 单元格中。产品 ID 是一个数字字符串，例如“0000001”、“3212230”。

生成excel后，我发现保存这个id值的单元格有错误检查警告“**这个单元格中的数字格式为文本或前面有撇号**”。如果我在excel中双击这个单元格，它会自动将“0000001”更正为1，这不是我想要的。我知道我可以手动关闭 excel 中的错误检查选项，但这不是我想要的。

有没有办法让 excel 保持安静并将这个 id 视为文本？
这是代码片段：

```
 cell.setCellType(HSSFCell.CELL_TYPE_STRING);
   cell.setCellValue(new HSSFRichTextString( quote.getQuoteId() )); 
   cell.setCellStyle(styles.get("table_t")); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:34:05.770

POI似乎还不支持这一点。但是，低级实现似乎是作为[错误 46136](https://issues.apache.org/bugzilla/show_bug.cgi?id=46136)的一部分完成的。这个错误正在等待为这个特性指定一个接口的建议，所以我想说，有朝一日完成这项工作的最好办法是发表你的评论并可能投票给它。我现在才投票。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:20:56.827

你能在它前面加上一个单引号吗？

```
cell.setCellValue(new HSSFRichTextString("'" & quote.getQuoteId() )); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:23:11.193

并不真地。Excel 真的很喜欢它的数字，这就是为什么这被认为是错误的。唯一能让 Excel 满意的事情就是将 QuoteId 格式更改为以字母开头，而不是完全数字。

# jquery - 函数不返回布尔值

> ID：15365092
> 
> 赞同：0
> 
> 时间：2013-03-12T15:17:47.873
> 
> 标签：jquery

isUpdatable 方法在应该返回 true 或 false 时返回 undefined。这是一个范围问题。当我对 isUpdatable 方法进行日志记录时，我看到它输出 true 和 false，但 keyup 函数返回未定义。

```
$( function() {
var updatableEl = ['home', 'block', 'cat'];

inputFields.keyup(function(){
      var $input =  $(this);
      console.log("isUpdatable= ", isUpdatable( $input ));
    });

    function isUpdatable( el ){
        $.each( updatableEl, function( intIndex, objValue ){
           //console.log(" objValue = ", el.hasClass(objValue));
           return el.hasClass(objValue);
        });
    }

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:19:03.087

`$.each`返回原始的 jQuery 对象（用于链接）。
它忽略其回调的返回值。

无论如何，您的代码没有意义。
您正在计算三个不同的布尔值；你想返回这三个中的哪一个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:30:53.307

为任何可能遇到类似问题的人想办法。

```
function isUpdatable( el ){            
    for( var i=0; i< updatableEl.length; i++){
                if(el.hasClass(updatableEl[i])){
                    return true;
                }
            }
    } 
```

# svn - 如何设置一个简单的 SVN 服务器？

> ID：15365093
> 
> 赞同：5
> 
> 时间：2013-03-12T15:17:48.343
> 
> 标签：svn, version-control, svnadmin, svnserve, svn-checkout

我有一个很久以前创建的工作存储库，现在我正在尝试设置另一个，但我遇到了很大的困难。这是我为创建第二个所做的；我希望这能奏效：

```
U:\repos>svnadmin create repo1
U:\repos>echo password-db = passwd >> repo1/conf/svnserve.conf
U:\repos>echo auth-access = write >> repo1/conf/svnserve.conf
U:\repos>echo user1 = user >> repo1/conf/passwd
U:\repos>cd repo1
U:\repos\repo1>svnserve -d 
```

在另一个终端：

```
U:\>mkdir wc
U:\>cd wc
U:\wc>svn co svn://localhost/repo1
svn: E210005: Unable to connect to a repository at URL 'svn://localhost/repo1'
svn: E210005: No repository found in 'svn://localhost/repo1'
U:\wc> 
```

另一个存储库以相同的方式配置在`u:\repo`. 这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:17:48.343

首先，`cd repo1`是多余的：`svnserve`在这种情况下不关心工作目录。

要使您的示例正常工作，请更改`-d`为`-d -r \repos`.

或者，您可以将`co`命令更改为`svn co svn://localhost/repos/repo1`.

运行时`svn co`，它使用 URL 来告诉`svnserve`在哪里寻找 repo。默认情况下，此路径是相对于`/`，而不是启动的工作目录`svnserve`！现有存储库有效是因为存储库恰好位于 中`/`，而不是因为`svnserve`从`/repo`. 当您希望从 以外的其他地方引用您的存储库的路径时，请`/`使用.`-r [--root]``svnserve`

这意味着存储在 的存储库在`u:\repos\repo1`启动时`svnserve -r u:\repos`必须由 url `/repo1`( `svn://localhost/repo'`) 引用，而不是`/repos/repo1`. 卡皮什？

# objective-c - 在 IOS 6 应用程序上实现的最佳星级排名系统 (libs) 是什么？

> ID：15365101
> 
> 赞同：0
> 
> 时间：2013-03-12T15:18:04.130
> 
> 标签：objective-c, ios6, rank

我有[这个](https://github.com/dlinsin/DLStarRating)系统，但我是基于框架的，我想要另一种解决方案`views`或另一种解决方案来放置在确切位置。使用框架很难将星​​星放在正确的位置并处理它们。我想要一个有 5 颗星的系统，并且可以用半颗星来评价一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T03:23:11.273

以下是我知道的一些：

[http://www.cocoacontrols.com/controls/jsfavstarcontrol](http://www.cocoacontrols.com/controls/jsfavstarcontrol) [http://www.cocoacontrols.com/controls/edstarrating](http://www.cocoacontrols.com/controls/edstarrating) [http://www.cocoacontrols.com/controls/dyrateview](http://www.cocoacontrols.com/controls/dyrateview)

可可控制中心还有其他一些公司——顺便说一句，这是一个很棒的网站。看看并进行搜索。

祝你好运。

# ios - 如何从IOS中的UISwitch获取事件类型

> ID：15365102
> 
> 赞同：0
> 
> 时间：2013-03-12T15:18:06.940
> 
> 标签：ios

我想在单击开关时获取事件，因为我进行了如下编码，但我得到的事件始终为空。问题是什么？我们怎样才能实现？

```
UISwitch *simpleSwitch = [[UISwitch alloc] initWithFrame:(CGRect){ CGPointZero, { self.frame.size.width, self.frame.size.height }}];
        [simpleSwitch addTarget:self action:@selector(eventHandler:event:) UIControlEventValueChanged];
        [self addSubview:simpleSwitch];

#pragma mark -  handler event methods
- (void)eventHandler:(id)sender event:(UIEvent *)event  {
    NSLog(@"Event type: %@",[event class]);
} 
```

# vb.net - 没有接口的类

> ID：15365105
> 
> 赞同：1
> 
> 时间：2013-03-12T15:18:13.047
> 
> 标签：vb.net, design-patterns

我在这里阅读了几个问题，似乎普遍的共识是项目中的每个类都不需要接口。我读过这样的帖子：[为每个类提取接口是最佳实践吗？](https://stackoverflow.com/questions/3036749/is-it-the-best-practice-to-extract-an-interface-for-every-class).

我想知道这如何应用于 .NET 框架类。我相信我看过的所有类要么继承自抽象类，例如 SQLConnection 继承自 dbConnection，要么实现和接口，例如 Component 类实现 IComponent 接口。

我有一个 Reflector 的副本，我在两个月前下载了它，我正在等待许可证（最近支付了费用）。当我开始单步执行代码时（使用反射器）；我会看到这样的代码吗：

```
Public Class Foo
    Public Name As String
    Public Property NameProperty()
        Get
            Return Name
        End Get
        Set(value)
            Name = value
        End Set
    End Property

    Public Shared Sub Main()
        Dim f As Foo = New Foo
        f.NameProperty = "Ian"
    End Sub

End Class 
```

而不是这样的代码：

```
Public Class Foo
    Implements IFoo
    Public Name As String
    Public Property NameProperty() Implements IFoo.NameProperty
        Get
            Return Name
        End Get
        Set(value)
            Name = value
        End Set
    End Property

    Public Shared Sub Main()
        Dim f As IFoo = New Foo
        f.NameProperty = "Ian"
    End Sub

End Class

Public Interface IFoo
    Property NameProperty()
End Interface 
```

请注意，第二个代码片段中使用了一个接口。我仍然在努力理解什么时候不适合使用接口。一些开发人员说永远不会。我想其中一些是主观的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:01:48.290

作为一个努力以正确方式做事的人，每次我开始一个新项目时，我都会为此苦苦挣扎。我开始意识到这主要是主观的。比如说“哪些日子可以不洗澡”。

当然它提供了抽象，提高了可测试性等，但它会导致不必要的“类爆炸”。根据我的经验，向辅助内部类添加接口弊大于利。我偶尔会打开几年前做的一个小项目，并为我无穷无尽的课程列表感到震惊……过度设计！

*通常，我在类库中使用 API 接口*。除此之外，如果时间允许，我会添加它们，或者我特别需要澄清客户端代码应该如何调用一段代码。

# javascript - 主干.js 不适用于 Android 2.3

> ID：15365106
> 
> 赞同：1
> 
> 时间：2013-03-12T15:18:15.660
> 
> 标签：javascript, android, cordova, backbone.js

我一直在使用phonegap和backbone.js开发一个应用程序，它在iphone和Android（高于2.3）上运行良好，但是在2.3上它在使用backbone.view.extend创建主视图时停止。

```
alert("before calling mainview");
  var mainView = new Bkam.mainView();
  alert("After calling mainview, before mainview.render"); 
```

第一个警报正确完成，而第二个警报甚至没有显示。

mainView 功能的一部分：

```
Bkam.mainView = Backbone.View.extend({
  initialize: function(){
    alert("INITIALIZING MAINVIEW");
  },
  //the rest of function 
```

初始化中的警报也不显示。

这只发生在 Android 2.3 上，所有警报都显示在 Android 4 和 iphone 上。

有什么建议吗？

# php - 将图像文件发送到 php

> ID：15365107
> 
> 赞同：1
> 
> 时间：2013-03-12T15:18:24.677
> 
> 标签：php, extjs

我似乎无法在我的 php 文件中通过 isset($_FILES['formFile'])，它总是返回 false。我正在使用 Ext js 4.1 我的目标是将这些图像存储在一个 blob 中。

extjs 代码：

```
 var fi = new Ext.FormPanel({            
        fileUpload: true,
        width: 400,
        frame: false,            
        autoHeight: true,            
        labelWidth: 40,
        border: false,            
        margins: '10 0 0 10',
        defaults: {
            anchor: '95%',
            allowBlank: false,
            msgTarget: 'side',
            border: false
        },
        items: [{
            xtype: 'filefield',                
            emptyText: 'Select an image',
            fieldLabel: 'Image',
            id: 'formFile',
            buttonCfg: {
                text: '',
                iconCls: 'upload-icon'
            },
            border: false
        }],
        buttons: [{
            text: 'Upload',
            handler: function(){
                var form = this.up('form').getForm();                    
                if(form.isValid()){
                    form.submit({
                        url: 'php/picture-upload.php',
                        waitMsg: 'Uploading your image...',
                        success: function(fi, o){                                
                            alert('succes');
                        }
                    });
                }
            }
        }]
    }); 
```

php:

```
if (!isset($_FILES['formFile'])) {
echo '<p>Please select a file</p>';
echo '{"success": false}';
} else {
try {
    upload();
    echo '<p>Thank you for submitting</p>';
} catch (Exception $e) {
    echo $e->getMessage();
    echo 'Sorry, could not upload file';
}
} 
```

print_r($_FILES) 的输出；

```
Array
(
[formFile-inputEl] => Array
    (
        [name] => clicla.jpg
        [type] => image/jpeg
        [tmp_name] => /Applications/MAMP/tmp/php/phpnUxgV3
        [error] => 0
        [size] => 6772
    ) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:19:39.807

isset 应该根据您的输出检查 formFile-inputEl 。

```
if (!isset($_FILES['formFile-inputEl'])) {
} 
```

# windows-phone-8 - 将照片上传到 Web API 时始终为 0 字节

> ID：15365112
> 
> 赞同：1
> 
> 时间：2013-03-12T15:18:30.633
> 
> 标签：windows-phone-8, asp.net-web-api

我有以下内容，它上传没有错误，但图像始终为 0 字节。

Windows Phone App（在选择或拍照后调用）：

```
private void AddImage(PhotoResult e)
    {
      if (e.TaskResult == TaskResult.OK)
      {
        string serviceUri = Globals.GreedURL + @"API/UploadPhoto/test5.jpg";
        HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(serviceUri);
        request.Method = "POST";
        request.BeginGetRequestStream(result =>
        {
          Stream requestStream = request.EndGetRequestStream(result);
          e.ChosenPhoto.CopyTo(requestStream);
          requestStream.Close();
          request.BeginGetResponse(result2 =>
          {
            try
            {
              HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(result2);
              if (response.StatusCode == HttpStatusCode.Created)
              {
                this.Dispatcher.BeginInvoke(() =>
                {
                  MessageBox.Show("Upload completed.");
                });
              }
              else
              {
                this.Dispatcher.BeginInvoke(() =>
                {
                  MessageBox.Show("An error occured during uploading. Please try again later.");
                });
              }
            }
            catch
            {
              this.Dispatcher.BeginInvoke(() =>
              {
                MessageBox.Show("An error occured during uploading. Please try again later.");
              });
            }
            e.ChosenPhoto.Close();
          }, null);
        }, null);
} 
```

这是 Web API：

```
 public class UploadPhotoController : ApiController
      {
        public HttpResponseMessage Post([FromUri]string filename)
        {
          var task = this.Request.Content.ReadAsStreamAsync();
          task.Wait();
          Stream requestStream = task.Result;

          // Retrieve storage account from connection string.
          CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConfigurationManager.ConnectionStrings["StorageConnectionString"].ConnectionString);

          // Create the blob client.
          CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();

          // Retrieve reference to a previously created container.
          CloudBlobContainer container = blobClient.GetContainerReference("profilepics");
          container.CreateIfNotExists();

          var permissions = container.GetPermissions();
          permissions.PublicAccess = BlobContainerPublicAccessType.Blob;
          container.SetPermissions(permissions);

          string uniqueBlobName = string.Format("test.jpg");

          CloudBlockBlob blob = container.GetBlockBlobReference(uniqueBlobName);
          blob.Properties.ContentType = "image\\jpeg";

          blob.UploadFromStream(task.Result);

          HttpResponseMessage response = new HttpResponseMessage();
          response.StatusCode = HttpStatusCode.Created;
          return response;
        }
} 
```

有任何想法吗？任何帮助，将不胜感激。

# jsf - JSF2.0 注解@ManagedBean 不起作用

> ID：15365118
> 
> 赞同：4
> 
> 时间：2013-03-12T15:18:47.513
> 
> 标签：jsf, jakarta-ee, jsf-2, ejb, managed-bean

我尝试编写我的第一个 JSF2.0 项目（使用 EJB3.1）。我不明白为什么我的 @ManagedBean 注释不起作用。

在 Glassfish v3 上运行应用程序时总是出错

> 例外
> 
> javax.servlet.ServletException: /login.xhtml @34,133 value="#{loginBean.login}": 目标无法到达，标识符“loginBean”解析为空
> 
> 根本原因
> 
> javax.el.PropertyNotFoundException: /login.xhtml @34,133 value="#{loginBean.login}": 目标无法到达，标识符“loginBean”解析为空

如果我在 faces-config.xml 中定义一个托管 bean - 它会起作用。但我想使用注释。

可能是我在我的 poms 中使用了错误的库吗？

managedbean 示例（它将是一个传输对象）：

```
package edu.tsystems.vmmail.web.core.domain;

import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import java.io.Serializable;

@ManagedBean
@ViewScoped
public class LoginBean implements Serializable {
    private String login;
    private String password;

    public LoginBean() {}

    public String getLogin() {
        return login;
    }

    public void setLogin(String login) {
        this.login = login;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }
} 
```

login.xhtml（我可以尝试使用它）：

```
<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html   xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:p="http://primefaces.org/ui">
    <f:loadBundle var="common" basename="edu.tsystems.vmmail.web.ui.MessageResources" />
    <h:head>
        <title>Welcome to VMMail Web Interface</title>
        <link type="text/css" href="#{request.contextPath}/css/style.css" rel="stylesheet" />
    </h:head>
    <h:body>
        <f:view>
            <h:form id="loginForm" method="post">
                <p:panelGrid id="mainLogin" styleClass="noInnerBorderTable">
                    <f:facet name="header">
                        <p:row>
                            <p:column colspan="4">
                                <h:outputText value="#{common['login.welcome']}" /><br/>
                                <h:message for="loginBean" id="login1Error" />
                            </p:column>
                        </p:row>
                    </f:facet>
                    <p:row>
                        <p:column rowspan="2">
                            <div class="logoCell"></div>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{common['field.login']}" for="loginBean" />
                        </p:column>
                        <p:column>
                            <p:inputText id="loginBean" required="true" value="#{loginBean.login}" requiredMessage="#{common['field.login.required']}" />
                        </p:column>
                        <p:column rowspan="2">
                            <div class="submitButtonCell">
                                <p:commandLink styleClass="loginAnchor" title="#{common['field.loginButton']}"
                                        action="#{userController.loggingIn(login)}" ajax="false" />
                            </div>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <h:outputText for="password" value="#{common['field.password']}" />
                        </p:column>
                        <p:column>
                            <p:password id="password" required="true" value="#{loginBean.password}" requiredMessage="#{common['field.password.required']}" />
                        </p:column>
                    </p:row>

                    <f:facet name="footer">
                        <p:row>
                            <p:column colspan="4">
                                <h:outputText value="#{common['login.notHave']}" />
                                <a href="#{request.contextPath}/registration.xhtml">
                                    <h:outputText value="#{common['login.registerNow']}" />
                                </a>
                            </p:column>
                        </p:row>
                    </f:facet>
                </p:panelGrid>
            </h:form>
        </f:view>
    </h:body>
</html> 
```

用户控制器类：

```
package edu.tsystems.vmmail.web.core.controllers;

import edu.tsystems.vmmail.web.core.dao.UserDAO;
import edu.tsystems.vmmail.web.core.domain.LoginBean;
import edu.tsystems.vmmail.web.core.model.UserEntity;

import javax.ejb.EJB;
import javax.ejb.Stateless;
import javax.faces.application.FacesMessage;
import javax.faces.bean.ViewScoped;
import javax.faces.context.FacesContext;
import javax.servlet.http.HttpSession;

@Stateless
@ViewScoped
public class UserController {
    @EJB
    private UserDAO userDAO;
    private UserEntity user;

    public boolean isLoggedIn() {
        return user != null;
    }

    public String loggingIn(LoginBean loginBean) {
        FacesContext context = FacesContext.getCurrentInstance();

        if(userDAO == null) {
            context.addMessage("loginForm:login1Error", new FacesMessage("DAO IS NULL!"));
//          return "/loginBean.xhtml?faces-redirect=true&error=1";
        }

        user = userDAO.getUserByLoginAndPassword(loginBean.getLogin(), loginBean.getPassword());
        if (user != null) {
            FacesContext facesContext = FacesContext.getCurrentInstance();
            HttpSession session = (HttpSession) facesContext.getExternalContext().getSession(false);

            session.setAttribute("user", user.getId());
            return "/mail/mail.xhtml?faces-redirect=true";
        } else {
            return "/loginBean.xhtml?faces-redirect=true";
        }
    }

    public String logout() {
        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
        return "/login.xhmtl?faces-redirect=true";
    }
} 
```

我真的不明白为什么它不起作用:(我做错了什么？

UPD：堆栈跟踪： http: [//pastebin.com/istJmmHr](http://pastebin.com/istJmMHr)

源代码可以从我的谷歌驱动器下载：[https ://docs.google.com/file/d/0B4Am7SXJwmtKNVc0LVhWVlEyMVk/view](https://docs.google.com/file/d/0B4Am7SXJwmtKNVc0LVhWVlEyMVk/view)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:08:44.703

我认为你最好从一个非常小的例子开始来掌握事情。您的代码中有很多地方不太对劲。

首先，@Stateless bean 不能在视图范围内。对此稍加思考。拥有无状态视图范围 bean 究竟意味着什么？为什么你认为你首先需要一个？

一个视图应该有一个支持 bean，而这个通常是视图范围的。该视图可能需要的任何 DTO 都不应该是视图范围的，而应该只是主支持 bean 的实例变量。这样，它们将自动依赖于该范围。

在您的情况下，让 loginBean 成为一个实例变量，就像用户变量一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T09:12:18.593

发生这种情况是因为我的 @ManagedBean 放在 EJB 包中，而不是放在 WAR 包中。

当我将所有 @ManagedBeans 移到我的 WAR 模块中时，全部赚到了！

# php - Phonegap cordova.js 无法在安卓手机上运行

> ID：15365119
> 
> 赞同：0
> 
> 时间：2013-03-12T15:18:48.327
> 
> 标签：php, android, html, cordova

我正在用cordova.js phonegap 做一个应用程序。

我在加载时使用外部 url

```
super.clearCache();
super.loadUrl("http://EXTERNALURL.COM/"); 
```

在索引上我添加了这个：

```
<script type="text/javascript" src="file:///android_asset/www/cordova-2.5.0.js"></script>
<script type="text/javascript" src="js/statusbarnotification.js"></script> 
```

但是我的例子都不起作用，我做错了什么？

这是示例代码，只是为了测试是否添加了 PhoneGap：

```
 $(function() {
        setTimeout(function() {
            console.log(window.PhoneGap);
        }, 1000);
    }); 
```

在 PC 浏览器上返回一个数字，但在 android 手机浏览器上：

```
 03-12 15:12:37.279: I/Web Console(1382): undefined at http://EXTERNALURL.COM/:1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:55:46.843

PhoneGap 不是为加载外部网站而构建的，如果您打算将您的应用程序建立在外部 url 上并在 AppStore 上启动您的应用程序，那就别管它了——Apple 对这个问题确实有严格的限制。

请告诉我们更多关于您的应用程序以及您想对您的应用程序做什么，也许我们可以为您提供更好的解决方案，以避免您使用外部页面作为您的基础资源。

# visual-studio-2010 - 禁用部署时使用部署目录的单元测试框架 - 如何清除？

> ID：15365121
> 
> 赞同：1
> 
> 时间：2013-03-12T15:18:52.447
> 
> 标签：visual-studio-2010, unit-testing

环境：Visual Studio 2010 高级版

使用 MS 单元测试框架，我的解决方案中有许多项目运行良好，无论是否在 testsettings 文件中启用了部署。一个项目在部署禁用时运行时坚持在部署目录中查找文件，因此由于上下文没有部署而失败。我找不到 VS 为这 1 个项目（在众多项目中）决定的位置或方式，它应该使用部署目录（即 TestResults/......

任何人都可以建议如何让 VS 使该项目的行为与解决方案中的所有其他项目一样。此外，这组测试类没有使用部署项的类属性。

# php - Web 应用程序，基于权限的菜单（禁用与不可见）

> ID：15365127
> 
> 赞同：1
> 
> 时间：2013-03-12T15:19:04.347
> 
> 标签：php, web-applications, user-interface, user-controls

我已经开发了几个基于权限的 Web 应用程序，它们根据当前用户的权限或角色简单地消除了菜单和其他选项。我正在考虑禁用这些选项，而不是在我的最新项目中消除它们。这将允许该选项存在但不可用。我可以在应用程序文档（帮助等）中看到这将是一个更好的方法，但也可以看到它可能会更糟。我正在向使用这两种方法的人寻求一些指导。

# javascript - 使用可变纸张在 Raphael 中操作画布背景颜色

> ID：15365129
> 
> 赞同：10
> 
> 时间：2013-03-12T15:19:05.503
> 
> 标签：javascript, jquery, raphael

我想将背景颜色设置为特定颜色。我使用以下代码：

```
//JavaScript Code
var paper = Raphael(200, 350, 320, 200);
paper.attr("fill", "#f00"); 
```

不知何故，这段代码不起作用。请帮忙，如何设置纸张的背景颜色？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-12T16:43:35.583

实际上，完全可以为 SVG 画布设置背景颜色——这里需要注意的是，尽管 Raphael 控制画布内的所有元素，但它对画布本身的风格控制很少。

幸运的是，您可以通过其*canvas*属性访问与 Raphael 纸对象关联的 dom 节点。这使得做这样的事情变得容易：

```
var paper = Raphael(200, 350, 320, 200);
paper.canvas.style.backgroundColor = '#F00'; 
```

更好的是，您可以将画布背景/边框/填充定义为应用程序样式表的一部分，然后确保将画布设置为使用适当的样式：

```
var paper = Raphael(200, 350, 320, 200);
paper.canvas.className += ' my_svg_class'; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:27:29.403

请参阅下面的答案以获得更好的方法，但您可以制作一个填充整个画布区域的矩形：

```
var paper = Raphael(200, 350, 320, 200);
var rect = paper.rect(0, 0, 320, 200);
rect.attr("fill", "#f00");
rect.attr("stroke", "#f00"); 
```

# excel - Excel 2010 双变量运行时错误 16

> ID：15365130
> 
> 赞同：3
> 
> 时间：2013-03-12T15:19:14.147
> 
> 标签：excel, runtime-error, excel-2010, vba

我们在办公室的一台用户机器上运行此代码时遇到问题 - 所有其他用户机器都可以正常运行（Windows XP 操作系统、Excel 2010 Standard 或 Professional） - 这台机器是 Windows XP，运行 Excel 2010 Professional。运行时错误 16 出现在标记的行上 --> 问题似乎是变量 i - 高亮提示显示 i = -1.#IND

```
Sub FormatSheet(strResultSheet As String)
    Dim oCol As Excel.Range
    Dim i As Double
    Dim R As String
    Dim iColumn As Integer

    ' Special rountine to convert text column into numeric
    Sheets(strResultSheet).Select
    iColumn = 0
--> For i = 1 To Worksheets(strResultSheet).Cells.SpecialCells(xlLastCell).Column
        If UCase(Cells(1, i).Text) = "QUANTITY" Then
            iColumn = i
            Exit For
        End If
    Next
    Sheets(strResultSheet).Select
    If iColumn > 0 Then
        Columns(iColumn).Select
        Selection.NumberFormat = "#,##0.00"
        Selection.HorizontalAlignment = xlHAlignRight
        For i = 2 To Sheets(strResultSheet).Cells.SpecialCells(xlLastCell).Row
            If Cells(i, iColumn).Text <> "" Then
                Cells(i, iColumn).Value = Cells(i, iColumn).Value * 1
            End If
        Next
    End If

End Sub 
```

任何人都知道我们需要做什么来修复用户机器来处理？宏嵌入在第三方每日电子邮件中，因此无法调整代码来修复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:27:49.620

试试下面的代码：

```
Sub FormatSheet(strResultSheet As String)

    Dim rng As Range, lastRow As Integer

    With Sheets(strResultSheet)
        .Select
        Set rng = .Rows("1:1").Find("QUANTITY")

        If Not rng Is Nothing Then
            rng.EntireColumn.NumberFormat = "#,##0.00"
            rng.HorizontalAlignment = xlHAlignRight

            lastRow = Cells(65000, rng.Column).End(xlUp).Row
            For i = 2 To lastRow
                Cells(i, rng.Column).Value = Cells(i, rng.Column).Value * 1
            Next
        End If
    End With

End Sub 
```

# android - Asp.NET Apple Android Windows8 手机 GUI

> ID：15365146
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:20:02.490
> 
> 标签：android, asp.net, ios

我正在考虑在 ASP.NET 中开发一个程序。但我可以轻松移植到 Apple、Android 和 Windows 手机和平板电脑上。我还希望程序能够在 PC（MAC 的？）上运行。

这似乎很好。然而，Windows 的普通 GUI 看起来一点也不像 iOS 或 Android 的 GUI。这将是一个很大的阻碍。它至少应该针对触摸模式进行优化。所以屏幕上的所有小部件都应该更大一些。

是否有库，提供控件，看起来像操作系统上的正常控件？如果这能自动工作，那将是最好的。所以程序应该找出它在哪里运行并加载最适合设备的标准 GUI，它正在启动。

我当然可以开发自己的控件，但这可能有点太费劲了。

如果库可以处理不同的屏幕或模式，如纵向和横向，那也将非常好。这样它就可以根据平板电脑或手机的方向进行切换。

我正在寻找类似的东西，它提供了一个很好的结果，程序员不需要自己做太多事情。

如果有人可以推荐一个他已经被一个更大的程序使用的库，我也很喜欢。根据我自己的经验，随着时间的流逝，您会了解此类库的优势和劣势。

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T07:51:37.577

我已经发现了一些工具，比如 PhoneGap、Sencha、Mono。我不知道，这些是否适合我。我喜欢同时为所有平台创建一个应用程序。例如PhoneGap 就是这种情况吗？

我**不**熟悉 JavaScript、CSS 或 HTML 开发。

我是一位经验丰富的 C# 程序员，对 Java 非常熟悉。所以 VisualStudio 是我的日常工作环境，我也经常使用 Eclipse。

单核细胞增多症：

我只阅读了它并发现了这些方面：

1.  在 Visual Studio 中使用它需要 999 美元。希望这个价格包括所有平台的开发，而不仅仅是一个。还没有检查这个。
2.  编码看起来非常好。
3.  有适用于 Android、iOS 和 Windows Phone 的 API 来设置控件。因此，对于任何受支持的应用程序，都需要重写这些部分。可以创建一个可用于所有组件的核心库。这方面不太好。

但是，我更喜欢一个解决方案，其中甚至在另一个级别上描述了 GUI。如果不使用特定的库，则应自动将其带到当前平台。所以 HTML5 可能更灵活。

此致，

帕特里克

# xquery - 如何在 xquery 中生成随机 UUID

> ID：15365147
> 
> 赞同：0
> 
> 时间：2013-03-12T15:20:08.653
> 
> 标签：xquery, uuid

谁能帮我解决这个问题？我希望能够在 x-query 中生成随机 UUID。有什么功能可以做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T18:20:07.513

使用 Saxon，您应该能够链接到 Java 以生成 UUID，如下所示：

**XSLT**

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:uuid="java:java.util.UUID"> 
```

**XQuery**

```
declare namespace uuid = "java:java.util.UUID"; 
```

`uuid:randomUUID()`然后在样式表或 XQY 脚本中的任意位置调用该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-01T12:12:19.990

`fn-bea:uuid()`对于那些使用 BEA 的 xQuery 实现的人来说，这也是一种选择。例如，在为 Oracle Service Bus (OSB) 框架编写 xQuery 时。

# java - Wicket - Ajax PropertyListView

> ID：15365150
> 
> 赞同：3
> 
> 时间：2013-03-12T15:20:15.703
> 
> 标签：java, ajax, list, listview, wicket

我将一些数据输入到我的 propertyListview 中，周围有一个容器，但是当我想用 Ajax 更新它时，它什么也没做！如何使用 Ajax 更新我的 PropertyListview？

*在后台编辑* 我使用 JSON Parse 解析来自气象站的数据，该数据可以改变很多，所以我想更新 propertyListview 中的数据

```
public class WeerPanel extends Panel {

public WeerPanel(String id) throws IOException {
    super(id);

    final WeerService weerService = new WeerServiceImpl();

    PropertyListView<Weer> newview = new PropertyListView<Weer>("weer", weerService.getWeer()) {

        @Override
        protected void populateItem(ListItem<Weer> item) {
            item.add(new Label("temperatuur"));
            item.add(new StaticImage("type", String.format("images/%s.png", item.getModelObject().getType())));
            item.add(new Label("omschrijving"));
        }
    };

    final WeerVoorspellingService weerVoorspellingService = new WeerVoorspellingServiceImpl();

    PropertyListView<WeerVoorspelling> hateView = new PropertyListView<WeerVoorspelling>("weersvoorspelling", weerVoorspellingService.getWeerVoorspelling()) {

        @Override
        protected void populateItem(ListItem<WeerVoorspelling> item) {
            item.add(new Label("dag"));
            item.add(new StaticImage("typeVoorspelling", String.format("images/%s.png", item.getModelObject().getType())));
            item.add(new Label("minTemperatuur"));
            item.add(new Label("maxTemperatuur"));
        }
    };

    final WebMarkupContainer containerWeer = new WebMarkupContainer("containerWeer");
    containerWeer.setOutputMarkupId(true);
    containerWeer.add(hateView);
    containerWeer.add(newview);
    add(containerWeer);

    add(new AbstractAjaxTimerBehavior(Duration.seconds(10)) {

        @Override
        protected final void onTimer(AjaxRequestTarget target) {
            target.add(containerWeer);
        }
    });
} 
```

}

这是我在后台做的一些代码，它是一个虚拟的，每次都会通过一个随机数改变天气的温度。

```
 Random r = new Random();
            int randomInt = r.nextInt(100);
            weer.add(new Weer("rain", "Mooi bewolkt", randomInt, v.getVoorspellingen())); 
```

虚拟代码很好，但在我的页面上仍然没有任何变化......好像我的列表没有得到任何新数据......

*FIXED* here 是供人们使用的代码

```
public class WeerPanel extends Panel {

    public WeerPanel(String id) {

        super(id);

        add(createContainer());

        add(new AbstractAjaxTimerBehavior(Duration.seconds(10)) {
            @Override
            protected final void onTimer(AjaxRequestTarget target) {
                target.add(createContainer());
            }
        });
    }

    private final WebMarkupContainer createContainer() {
        final WeerService weerService = new WeerServiceImpl();

        PropertyListView<Weer> newview = null;
        try {
            newview = new PropertyListView<Weer>("weer", weerService.getWeer()) {

                @Override
                protected void populateItem(ListItem<Weer> item) {
                    item.add(new Label("temperatuur"));
                    item.add(new StaticImage("type", String.format("images/%s.png", item.getModelObject().getType())));
                    item.add(new Label("omschrijving"));
                }
            };
        } catch (Exception e) {
            e.printStackTrace();
        }

        WeerVoorspellingService weerVoorspellingService = new WeerVoorspellingServiceImpl();

        PropertyListView<WeerVoorspelling> hateView = null;
        try {
            hateView = new PropertyListView<WeerVoorspelling>("weersvoorspelling", weerVoorspellingService.getWeerVoorspelling()) {

                @Override
                protected void populateItem(ListItem<WeerVoorspelling> item) {
                    item.add(new Label("dag"));
                    item.add(new StaticImage("typeVoorspelling", String.format("images/%s.png", item.getModelObject().getType())));
                    item.add(new Label("minTemperatuur"));
                    item.add(new Label("maxTemperatuur"));
                }
            };
        } catch (Exception e) {
            e.printStackTrace();
        }

        WebMarkupContainer containerWeer = new WebMarkupContainer("containerWeer");
        containerWeer.setOutputMarkupId(true);
        containerWeer.add(hateView);
        containerWeer.add(newview);
        addOrReplace(containerWeer);

        return containerWeer;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T18:50:17.797

在您中，`onTimer`您将对象添加到自身而不更改它。我建议将视图/容器重新生成移动到一种新方法中。

然后`onTimer`像这样重新定义：

```
add(new AbstractAjaxTimerBehavior(Duration.seconds(10)) 
{
    @Override
    protected final void onTimer(AjaxRequestTarget target) 
    {   //createContainer() generates the views and container.
        target.add(createContainer()); 
    }
} 
```

**编辑：**
我会这样定义`createContainer()`：

```
private WebMarkupContainer createContainer()
{
  final WeerService weerService = new WeerServiceImpl();

  PropertyListView<Weer> newview = new PropertyListView<Weer>("weer", weerService.getWeer()) 
  {

    @Override
    protected void populateItem(ListItem<Weer> item) 
    {
        item.add(new Label("temperatuur"));
        item.add(new StaticImage("type", String.format("images/%s.png", item.getModelObject().getType())));
        item.add(new Label("omschrijving"));
    }
  };

  WeerVoorspellingService weerVoorspellingService = new WeerVoorspellingServiceImpl();

  PropertyListView<WeerVoorspelling> hateView = new PropertyListView<WeerVoorspelling>("weersvoorspelling", weerVoorspellingService.getWeerVoorspelling()) 
  {

    @Override
    protected void populateItem(ListItem<WeerVoorspelling> item) 
    {
        item.add(new Label("dag"));
        item.add(new StaticImage("typeVoorspelling", String.format("images/%s.png", item.getModelObject().getType())));
        item.add(new Label("minTemperatuur"));
        item.add(new Label("maxTemperatuur"));
    }
  };

  WebMarkupContainer containerWeer = new WebMarkupContainer("containerWeer");
  containerWeer.setOutputMarkupId(true);
  containerWeer.add(hateView);
  containerWeer.add(newview);
  add(containerWeer);

  return containerWeer;
} 
```

**编辑以匹配最终解决方案**

然后像这样定义你的`Panel`构造函数：

```
public WeerPanel(String id) throws IOException 
{
  super(id);

  final WebMarkupContainer container = createContainer();

  add(new AbstractAjaxTimerBehavior(Duration.seconds(10)) 
  {
    @Override
    protected final void onTimer(AjaxRequestTarget target) 
    {   //createContainer() generates the views and container.
        container.addOrReplace(createContainer());
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T06:25:49.870

你只得到一次“WeerVoorspelling”：

```
PropertyListView<WeerVoorspelling> hateView
  = new PropertyListView<WeerVoorspelling>("weersvoorspelling",
         weerVoorspellingService.getWeerVoorspelling()) { .. } 
```

因此，无论天气预报如何变化，您的 listView 仍会查看原始列表。你应该引入一个间接：

```
IModel<List<WeerVoorspelling>> weerVoorspelling = new AbstractReadOnlyModel<List<WeerVoorspelling>> {
  public List<WeerVoorspelling> getObject() {
    return weerVoorspellingService.getWeerVoorspelling();
  }
}

PropertyListView<WeerVoorspelling> hateView
  = new PropertyListView<WeerVoorspelling>("weersvoorspelling",
         weerVoorspelling) { .. } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:58:26.370

请查看 wicket ajax 控制台中的输出，它可能说明无法直接更新列表视图。另外，您可以在更新 Listview 的位置添加代码吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T17:02:44.727

根据文档 AjaxSelfUpdatingTimerBehavior 有一个方法 onTimer()。您需要实现此方法并将希望更新的视图添加到 AjaxRequestTarget。这将刷新您要更新的组件。ajax 事件目前什么都不做，这就是为什么你什么都看不到的原因。

基本上，从高层次的角度来看，您想要更新控制 listView 的后备模型对象，然后当 ajax 计时器触发时，您想要刷新该列表以显示最新数据。

代码看起来像这样：

```
`containerWeer.add(new AjaxSelfUpdatingTimerBehavior(Duration.seconds(5)){
  @Override
  protected final void onTimer(AjaxRequestTarget target) {
    target.addComponent(/**The component you wish to refresh**/);
  }
});` 
```

# php - PHP 投票限制

> ID：15365151
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:20:16.560
> 
> 标签：php, mysql

我正在建立一个评分系统，用户可以在其中“喜欢”或“不喜欢”东西。MySQL 更新一切正常。问题是我想添加限制，以便用户只能“喜欢”或“不喜欢”一次。基本上，我想用布尔值来做，但不能正确编写代码。有人可以帮我处理布尔值吗？这是代码：

```
<?php
$tries=0;
if (((isset($_POST['hidden']))&&$tries<2) {
    $tries++;
    $likes++;
    $up = mysql_query("Update videos SET Likes='$likes' WHERE Name='$name'");
}
?> 
```

希望这些信息足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:29:19.950

这个答案将告诉您您应该实现的目标。我不会编写代码来让您从现在的位置到此。但我相信它应该可以帮助您获得一个好主意。

首先，假设您有一个`likes`具有以下结构的表：

```
user_id INT(11) NOT NULL
video_id INT(11) NOT NULL
PRIMARY KEY(user_id, video_id) 
```

然后，在您的代码中，您可以（我在此示例中使用 PDO，因为我不会容忍使用`mysql_*`函数）：

```
$statement = $pdo->prepare('INSERT INTO likes (user_id, video_id) VALUES (:user_id, :video_id)');
$statement->bindValue(':user_id', $userId);
$statement->bindValue(':video_id', $videoId);

try {
    // The idea is that, if the user/video combination already exists - the above
    // query will throw an exception so you won't execute the code below this line
    $statement->execute();

    $likes = $pdo->prepare('UPDATE video SET likes = likes + 1 WHERE video_id = :video_id');
    $likes->bindValue(':video_id', $videoId);
    $likes->execute();
} catch (PDOException $exception) {
    // if it was a duplicate key exception, then the likes on the video 
    // have not been updated and you can print a friendly error message to your
    // users here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:25:40.723

您需要在用户上存储一些数据点，然后使用 PHP 会话、cookie 和/或任何其他方式通过某个数据点“了解用户”，以便当他们返回时，您可以知道他们已经在那里。

您想记住回来的用户的程度将决定您采取的行动方案。

# twitter - 你如何在 TweetSharp 中使用 StreamFilter？

> ID：15365152
> 
> 赞同：6
> 
> 时间：2013-03-12T15:20:24.827
> 
> 标签：twitter, tweetsharp

你如何在 TweetSharp 中使用 StreamFilter？

我得到的只是“未找到过滤器参数”，但我不知道如何输入过滤器参数。

谢谢！

# database - 为实时服务器选择 NoSQL 数据库

> ID：15365158
> 
> 赞同：1
> 
> 时间：2013-03-12T15:20:46.683
> 
> 标签：database, nosql, client-server, real-time, in-memory-database

我正在通过 Jetty 服务器编写 Java2EE WebServer 服务器管理一个实时操作，该操作适用于对模式进行大量读取和写入，

我决定使用内存中的 NoSQL 数据库，我想了解哪一个似乎适合我的用例，

我使用了 Stefan Edlich 教授的非常好的视频，[http://www.infoq.com/presentations/Choosing-NoSQL-NewSQL](http://www.infoq.com/presentations/Choosing-NoSQL-NewSQL)

并获得了一些满足我需求的基本准则

*   数据类型：事件数据、会话数据
*   存储模型：文档
*   数据量：~8,000 MB
*   数据导航：最小
*   数据复杂性：简单
*   架构灵活性：非常小
*   持久化设计：BTree + 持久性 + 列表
*   一致性：酸
*   吞吐量：10000 次查询/秒
*   QueryModel: Key/Value , Range of Keys, Map Reduce ,Secondary Indexes,Range Queries
*   架构：本地数据库，托管，必须在 Linux 上运行
*   访问方式：随机访问

最好的，

约西克莱斯勒

# node.js - 在哪里可以找到特定 API 版本的文档？

> ID：15365162
> 
> 赞同：7
> 
> 时间：2013-03-12T15:21:01.880
> 
> 标签：node.js

当前的 nodejs 版本不是 0.10.0 所以如果我去[http://nodejs.org/api/](http://nodejs.org/api/)网站，我只能看到最新的文档。我必须使用节点 0.8.21。我在哪里可以找到这个版本的文档？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-12T15:22:43.643

查看[http://nodejs.org/docs/](http://nodejs.org/docs/)，您可以看到列出的所有旧版本，包括 v0.8.21。

选择您的版本，它会将您带到该版本的站点，然后您可以选择“API Docs”并查看该版本的文档。

您也可以使用此链接：[http](http://nodejs.org/docs/v0.8.21/api/) ://nodejs.org/docs/v0.8.21/api/并替换为您的版本号。

# java - 在调用新的 Asynctask 时定义 onPostExecute

> ID：15365163
> 
> 赞同：0
> 
> 时间：2013-03-12T15:21:06.840
> 
> 标签：java, android, interface, abstract-class

我创建了一个扩展类`Asynctask`。此类从多个活动中调用。它从网页中获取一些数据。之后，根据url，在`onPostExecute`方法中处理数据。现在我正在使用多个`else if`语句，但它有点不方便。

有没有办法`onPostExecute`在 Activity 中定义创建新的`Asynctask`.

我认为它可能适用于接口或抽象方法，但不确定也不知道如何。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T15:38:16.770

你可以在没有任何额外工作的情况下做到这一点。

```
public class MyTask extends AsyncTask<Void, Void, Void>
{

    @Override
    protected Void doInBackground(Void... params)
    {
        // do some work
        return null;
    }

} 
```

在活动中：

```
MyTask t = new MyTask()
    {
        @Override
        protected void onPostExecute(Void result)
        {
            super.onPostExecute(result);
            // do some work             
        }
    }; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T15:32:38.540

您为 AsyncTask 注册一个事件侦听器，它将在`onPostExecute`运行时调用。

```
public class Example extends AsyncTask<Void, Void, Void> {

  public interface ExampleListener {
    public void onStart();
    public void onProgress();
    public void onFinish();
  }

  private ExampleListener listener;

  public Example(ExampleListener listener) {
    mListener = listener;
  }

  @Override
  public void onPreExecute() {
    ...
    mListener.onStart();
    ...
  }

  @Override
  public void onProgressUpdate(Void... v) {
    ...
    mListener.onProgress();
    ...
  }

  @Override
  public void onPostExecute(Void result) {
    ...
    mListener.onFinish();
    ...
  }
} 
```

自定义图案以适合您需要的任何设计。包括侦听器对每个事件所需的接口方法的任何参数。如果你有一个实现的类`Example.ExampleListener`，那么你只需要通过调用来启动它`new Example(this).execute()`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:47:54.027

另一种方法，更多的 java/generic，可以帮助改进你的代码是使用[策略](http://en.wikipedia.org/wiki/Strategy_pattern)模式。简而言之，对于每个不同的数据处理，您将创建一个实现相同接口的不同类。这样，添加新的“策略”就需要新的类，这样你的代码才会清晰。
例子：

```
 public void onPostExecute(String result){
ResponParser responseParser;

if (result.equals("http://..1"));
responseParser = new ResponParser1();
else if (result.equals("http://..2"));
responseParser = new ResponParser1();

responseParser.parse();
} 
```

其中 ResponParser 是由 ResponParser1 和 ResponParser1 实现的接口，它们是具体的类。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-12T15:59:18.883

使用接口是最好的选择，但为简单起见，您还可以将 Runnable 传递给 AsyncTask，您可以在 onPostExecute() 方法中执行它。

# java - 迭代器接口

> ID：15365165
> 
> 赞同：8
> 
> 时间：2013-03-12T15:21:10.147
> 
> 标签：java, iterator, linked-list, iterable

我有一个大学作业，要求我实现一个实现迭代器接口的内部类。迭代器适用于单链表超类。

目前我的内部类是这样的：

```
private class ListIterator implements Iterator<V>{

    Node temp;
    boolean nextCalled = false;

    ListIterator(Node fo){
        this.temp = fo;
    }

    @Override
    public boolean hasNext() {
        if(temp != null){
            return true;
        }
        return false;
    }

    @Override
    public V next() {
        nextCalled = true;
        return temp.getReprValue();
    }

    @Override
    public void remove() {
        if(nextCalled && hasNext()){
            nextCalled = false;
            removeElement(temp.getReprKey());
            temp = temp.getNext();
        }

    }

} 
```

现在我的问题是，即使列表实际上是空的，hasNext() 方法也会返回 true。其他一切似乎都有效。我可能在某个地方忽略了一个逻辑缺陷，但我自己找不到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:24:55.130

您需要跟踪您在列表中的位置，实现 a `cursor`，或者如果您的链表中的节点知道它们的`next`，只需询问它们是否有下一个元素。当光标大于长度/您的节点没有`next`时，您在 hasNext() 中返回 false。

用你的`hasNext()`方法做这一切。请记住，如果 next() 为`hasNext()`false，则可以抛出异常 - 因此您需要确保这是它唯一会抛出异常的时间。

由于我不知道您列表的底层数据结构，因此我无法告诉您其中哪一个会更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T15:45:23.660

更改了您的实现以反映迭代器合约的需求。您需要记住，您需要能够遍历集合的所有元素，即，`next()`应该从第一个元素开始，并且在每次调用之后，它必须将当前的下一个元素更改为列表中的下一个元素，或者如果出现异常则抛出异常没有。

最好阅读[Iterator 接口文档](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)以了解您需要实现它并从那里开始的方式。

```
private class ListIterator implements Iterator<V> {
    private Node next;
    private boolean alreadyDeleted = false;

    ListIterator(Node node){
        this.next = node;
    }

    @Override
    public boolean hasNext() {
        // because next is the current element. We need to iterate over all the elements
        // from the collection.
        return next != null;
    }

    @Override
    public V next() {
        if (next == null) {
           throw new NoSuchElementException();
        }

        Node current = next;

        this.next = current.getNext();
        this.alreadyDeleted = false; // it's better to try to elimate this state variable. You can try to do in another way, if yours removeElement returns something

        return current;
    }

    @Override
    public void remove() {
        if (alreadyDeleted || next == null) {
           throw new IllegalStateException();
        }
        removeElement(next.getReprKey());
        this.alreadyRemoved = true;
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T15:25:57.270

`hasNext`如果当前节点 ( `temp`) 不是，则返回 true `null`。

如果您的链表实现使用头节点，那么即使链表为空，构造函数也会始终接收`fo!=null`并`hasNext`返回。`true`你应该在你的实现中考虑这个事实。

根据您的代码，似乎

```
ListIterator(Node fo){
    this.temp = fo.getNext();
} 
```

可以解决问题（如果`header.getNext()==null`是空列表）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-12T15:59:43.640

减少一些代码，使其更具可读性

*   重命名`temp`为`next`,
*   使用快捷符号，
*   可能应该有一些`current`节点的概念，

这使得更新看起来像：

```
private Node next;
private Node current;    //track deletion

@Override
public boolean hasNext() {
    return next != null;
}

public Node getNext() {
  if (hasNext()) {
    current = next;
    next = next.getNextNode();
  }
  return current;
} 
```

删除可以将 current 设置为 null。我们不需要标志（假设如果有人在调用 first 之前删除，我们可以什么都不做`getNext()`。哎呀，如果我们真的想争取金牌，请`remove()`抛出`IllegalStateException`if `current == null`。

# android - 检测意图的类型android

> ID：15365169
> 
> 赞同：1
> 
> 时间：2013-03-12T15:21:22.643
> 
> 标签：android, android-intent

我有以下代码：

```
 AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("Share with...");
    final ShareAdapter adapter = new ShareAdapter(this, R.layout.share_adapter, activities.toArray());
    builder.setAdapter(adapter, new DialogInterface.OnClickListener() {
        @Override
        public void onClick(DialogInterface dialog, int which) {
            ResolveInfo info = (ResolveInfo) adapter.getItem(which);

         }
     } 
```

我要做的就是在 onClick 方法中添加一个 if 语句，我将在其中检查意图是否属于以下类型：message/rfc822。有没有办法做到这一点？我想这样做的原因是因为我想检测正在发送电子邮件的应用程序。然后通过以下方式发送电子邮件：

```
 Intent intent = new Intent(android.content.Intent.ACTION_SEND);
    intent.setType("text/html");
    intent.putExtra(Intent.EXTRA_TEXT, Html.fromHtml(.... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:24:46.790

Intents getType() 方法怎么样？请参阅：http: [//developer.android.com/reference/android/content/Intent](http://developer.android.com/reference/android/content/Intent.html#getType%28%29)

# mysql - 哪个数据库用于独立应用程序 Winforms

> ID：15365171
> 
> 赞同：3
> 
> 时间：2013-03-12T15:21:29.547
> 
> 标签：mysql, sql, winforms, ms-access

我需要使用 Visual Studio 在 WinForms 中开发一个简单的会计应用程序，如客户、供应商和会计资料（借方/贷方）等。

我从来没有用数据库开发过一个独立的应用程序，我一直在开发一个服务器端应用程序（现有的 SQL 服务器等）......

我喜欢用 DB 开发一个独立的应用程序。我的意思是：创建一个安装项目 (setup.exe/setup.msi) 并发送给客户，他/她应该安装在他的 windows pc 上

采用以下技术：带有 LINQ Windows 窗体的 VS 2012 Pro 实体框架。

我有一个问题：我需要使用哪个数据库？这些客户没有 SQL 服务器或其他任何东西。只是一个简单的 Windows 7/8 系统。所以我正在为选择哪个数据库而苦苦挣扎。我不能为每个客户在他的电脑上安装一个 sql server。所以需要自动化。

我会定期向他们发送更新，如 setup.msi/setup.exe 文件以更新应用程序。

因为我将使用 LINQ/Entity Framework，所以我不担心使用哪个 DB。

有人可以建议我使用哪个数据库并告诉我需要涵盖的棘手点吗？

所以实际上 Winforms 应用程序应该在带有 X 数据库（MDB、MDF、mysql 或其他）的独立 Windows PC 上运行。

请建议如何桥接数据库部分。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:28:12.280

你试过[SQLite](http://www.sqlite.org)吗？它有非常具体的用例，因为它是一个进程内 SQL DBMS（一般来说，它不适合多用户应用程序），但这听起来它可能非常适合您的应用程序，如果我了解您的使用的独立。

优点是性能，以及它的无服务器、零配置性质，. [查看SQLite 的适当用途](http://www.sqlite.org/whentouse.html)和[常见问题解答](http://www.sqlite.org/faq.html)，看看它是否适合您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:15:20.887

考虑 Microsoft [SQL 精简版](http://www.microsoft.com/en-us/sqlserver/editions/2012-editions/compact.aspx)；这是在您的应用程序中运行的嵌入式数据库。它不包括触发器和过程扩展等一些功能，但它比 SQLite 等 DBMS 更易于使用，并且不需要用户进行管理。

此外，Visual Studio 2010 附带了用于构建和部署 CE 数据库的工具；你不需要安装任何东西。

# jquery - datepicker - 错误 daySettings 未定义

> ID：15365177
> 
> 赞同：2
> 
> 时间：2013-03-12T15:21:42.067
> 
> 标签：jquery, jquery-ui, datepicker, undefined, jquery-ui-datepicker

我正在尝试禁用 jquery ui 的 datepicker 函数的某些日子，但是此代码返回错误：`daySettings is undefined` 在[http://code.jquery.com/ui/1.9.2/jquery-ui.js](http://code.jquery.com/ui/1.9.2/jquery-ui.js)中。这似乎是正确的，我不知道......请帮助！

```
 var $j = jQuery.noConflict(); 
     $j(document).ready(function() {
        var group_id = <? echo $bp->groups->current_group->id; ?>;
        var userid = <? echo $bp->loggedin_user->id; ?>;
        var myBadDates = new Array ();
    function checkAvailability(mydate){
    jQuery.post(  
        ajaxurl,
        {   
        action : 'check_date',
        verificadata: "true", userid: userid, group_id: group_id
        },
        function( response ) {
        obj = JSON.parse(response);
        var key, quanti = 0; 
            for(key in obj.prenotati) { 
                if(obj.prenotati.hasOwnProperty(key)) { 
                    var datafrom = obj.prenotati[quanti].datafrom;
                    var datato = obj.prenotati[quanti].datato;
                    myBadDates.push(datafrom);
                    myBadDates.push(datato);
                    quanti++;
                }
            }
            var ritorno = true;
            var returnclass ="available";
            checkdate = $j.datepicker.formatDate('yy-mm-dd', mydate);
                for(var i = 0; i < myBadDates.length; i++) { 
                    $j(myBadDates[i])
                        if(myBadDates[i] == checkdate) { 
                        ritorno = false; returnclass="unavailable"; 
                        } 
                }
                return [ritorno,returnclass]; 
        }
    )
}       

/* $myBadDates = new array("2013-03-03","2013-03-05");      
function checkAvailability(mydate){
        var $return=true;
        var $returnclass ="available";
        $checkdate = $j.datepicker.formatDate('yy-mm-dd', mydate);
        for(var i = 0; i < $myBadDates.length; i++) { 
            if($myBadDates[i] == $checkdate) { 
                $return = false; $returnclass= "unavailable"; 
            } 
        } 
        return [$return,$returnclass]; 
        } */
            $j('#datafrom').datepicker({
             dateFormat : 'yy-mm-dd',
             beforeShowDay: checkAvailability,
             onSelect: function(dateText, inst) {
                $j("#datafrom").val(dateText);
            }
        });
        $j('#datato').datepicker({
             dateFormat : 'yy-mm-dd',
             beforeShowDay: checkAvailability,
                onSelect: function(dateText, inst) {
                    $j("#datato").val(dateText);
                }
        }); 
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:34:11.513

您的问题在于范围，您正在尝试在成功方法中获得`return`结果，但这**实际上并不是您的函数返回的内容**。`post`

 **我在下面所做的只是将返回变量的声明移到函数作用域的顶部，然后我`return`还在函数作用域的顶部添加了语句

```
var $j = jQuery.noConflict(); 
     $j(document).ready(function() {
        var group_id = <? echo $bp->groups->current_group->id; ?>;
        var userid = <? echo $bp->loggedin_user->id; ?>;
        var $myBadDates = new Array ();
    jQuery.post(  
        ajaxurl,
        {   
        action : 'check_date',
        verificadata: "true", userid: userid, group_id: group_id
        },
        function( response ) {
        obj = JSON.parse(response);
        var key, count = 0; 
            for(key in obj.prenotati) { 
                if(obj.prenotati.hasOwnProperty(key)) { 
                    var datafrom = obj.prenotati[count].datafrom;
                    var datato = obj.prenotati[count].datato;
                    $myBadDates.push(datafrom); 
                    $myBadDates.push(datato);
                    count++;
                }
            }
            $j($myBadDates).appendTo("#item-meta");
        }
    )     
        function checkAvailability(mydate){
        var $return=true;
        var $returnclass ="available";
            checkdate = $j.datepicker.formatDate('yy-mm-dd', mydate);
                for(var i = 0; i < $myBadDates.length; i++) { 
                        if($myBadDates[i] == checkdate) { 
                    //  alert($myBadDates[i]);
                        $return = false; $returnclass= "unavailable"; 
                        } 
                }
        return [$return,$returnclass];  
        } 
```**

# iphone - 重置所有 iOS 模拟器的内容和设置

> ID：15365179
> 
> 赞同：19
> 
> 时间：2013-03-12T15:21:49.553
> 
> 标签：iphone, ipad, ios-simulator

是否有任何选项可以重置所有模拟器的内容和设置？在单个事件或通过命令行的单个命令中？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-10-22T15:57:57.483

根据 Jeremy Huddleston Sequoia 的回答，我编写了一个将重置所有模拟器的 shell 脚本。

对于**Xcode 7**，您可以使用：

```
#!/bin/sh

instruments -s devices \
| grep "(\d[.0-9]\+) \[[0-9A-F]\{8\}-[0-9A-F]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{12\}\]" \
| grep -o "[0-9A-F]\{8\}-[0-9A-F]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{12\}" \
| while read -r line ; do
    echo "Reseting Simulator with UDID: $line"
    xcrun simctl erase $line
done 
```

对于以前的版本，请使用：

```
#!/bin/sh

instruments -s devices \
 | grep Simulator \
 | grep -o "[0-9A-F]\{8\}-[0-9A-F]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{4\}-[0-9A-F]\{12\}" \
 | while read -r line ; do
    echo "Reseting Simulator with UDID: $line"
    xcrun simctl erase $line
done 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2014-10-13T13:38:16.300

使用 Xcode 6，您可以使用 simctl 命令行实用程序：

```
xcrun simctl erase <device UDID> 
```

使用 Xcode 7，您可以一次擦除所有内容：

```
xcrun simctl erase all 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-13T09:13:14.130

有请，

# [权威的 iOS 模拟器重置脚本（链接）](https://github.com/stianhoiland/The-Definitive-iOS-Simulator-Reset-Script/)

![在此处输入图像描述](../Images/e9b983ea4e9add43c75e94797f76ba33.png)

> 基于来自[这个 SO question](https://stackoverflow.com/questions/5125243/how-can-i-reset-the-ios-simulator-from-the-command-line)[的 Oded Regev 的代码](https://stackoverflow.com/a/14811280/659310)（基于[Jacob Rus 的精美“menu_click”代码](http://hints.macworld.com/article.php?story=20060921045743404)）

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2018-12-03T14:45:06.000

使用 Xcode 10：

```
#!/usr/bin/env sh

xcrun simctl shutdown all
xcrun simctl erase all 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-11-11T16:43:39.723

受丹尼尔伍德回答的启发，我想出了这个。

它解决了如何处理正在运行的模拟器的问题。我们的 CI 环境在测试运行后让模拟器继续运行，随着时间的推移，它变得越来越脏。

guid 检测并不准确，但我认为在可读性上进行权衡是值得的。

```
#!/bin/bash
xcrun simctl list | grep Booted | grep -e "[0-9A-F\-]\{36\}" -o | xargs xcrun simctl shutdown
xcrun simctl erase all 
```

使用 XCode 7 测试。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-11-16T18:49:59.903

使用最新版本的 Xcode 命令行工具，您可以调用`xcrun simctl erase all`

确保每次调用此函数时都退出 sim，否则会出现错误提示`An error was encountered processing the command (domain=com.apple.CoreSimulator.SimError, code=159): Unable to erase contents and settings in current state: Booted`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-10-18T22:09:25.573

你可以运行这个命令 `xcrun simctl erase all`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-10-11T20:51:58.067

只需转到`~/Library/Application Support/iPhone Simulator`并删除那里的所有内容。上述方法不适用于 iOS 7，所以这似乎对我有用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-10-18T17:15:17.543

我编写了一个脚本，它将重置 iOS 模拟器的所有版本和设备的内容和设置。它从菜单中获取设备名称和版本号，因此它将包括 Apple 为其发布模拟器的任何新设备或 iOS 版本。

它很容易手动运行或在构建脚本中使用。我建议在构建之前将其添加为 Pre-Action Run Script。

它主要基于上述 Stian 的脚本，但不会在新的 iOS 版本中变得陈旧，并且消除了对话框（更适合自动化构建脚本）。

[https://github.com/michaelpatzer/ResetAllSimulators](https://github.com/michaelpatzer/ResetAllSimulators)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2019-09-24T09:40:19.457

```
xcrun simctl erase all
xcrun simctl delete unavailable 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-24T03:40:41.587

有一个工具 xctool - [https://github.com/facebook/xctool](https://github.com/facebook/xctool)是 xcodebuild 的替代品。它允许从命令行构建应用程序并为其运行测试。除了运行测试之外，它还允许提供诸如 -freshSimulator 和 -freshInstall 之类的参数，以便在执行测试之前为目标模拟器重置内容。这简化了模拟器的大量重置，因为您可以避免使用 bash 脚本等各种魔法，以及封装在工具中的所有内容。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-05-15T07:12:59.493

1) 退出所有模拟器

2）在终端中运行以下命令 `xcrun simctl erase all`

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-03-12T15:38:10.527

要将模拟器的用户内容和设置设置为出厂状态并删除已安装的应用程序，请选择 iPhone Simulator > Reset Content and Settings。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2013-09-20T07:02:24.307

你可以调用这个命令：

```
rm -rf ~/Library/Application Support/iPhone Simulator 
```

# ruby-on-rails - 从 Ruby 连接到 vBulletin 数据库

> ID：15365181
> 
> 赞同：0
> 
> 时间：2013-03-12T15:21:57.837
> 
> 标签：ruby-on-rails, ruby, vbulletin

我在为这个问题找到正确的方法时遇到了一些麻烦。

**背景**
我正在使用 Ruby on Rails 开发一个应用程序，我必须查询一个 vBulletin 数据库以获取例如最后的帖子。
论坛不是我管理的，但我可以向版主索取信息。

**问题**
问题是我找不到允许连接到数据库的 vBulletin API 或 ruby​​ gem，而且我没有从我的谷歌搜索中获得有用的结果。

如果有人能指出我正确的方向，那就太棒了。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:27:03.937

[https://github.com/lloydpick/vbulletin](https://github.com/lloydpick/vbulletin)

希望这会有所帮助。检查 GitHub 始终是一个很好的起点。

# c# - 引用 COMVisible 对象的现有实例

> ID：15365184
> 
> 赞同：0
> 
> 时间：2013-03-12T15:22:07.247
> 
> 标签：c#, com, interop, add-in, shared-addin

我有两个 .NET 项目，我想在这些项目之间创建双向通信。ProjectA 是一个共享加载项，可在 MS Office 应用程序中创建功能区。ProjectB 是一个 WinForms 应用程序，它从/向服务器收集/发送信息。

我创建了一个接口，`IAddInCommunication`它定义了我想从 ProjectB 调用的方法。这个接口在一个单独的类库项目中。ProjectA 中的`Connect`类实现了`IAddInCommunication`接口（以及其他一些接口）。我还在 ProjectB 中添加了对接口 DLL 的引用。

例如，现在我正在尝试调用在 MS Word 中运行的共享加载项的方法。为此，我使用以下代码（在 ProjectB 中）：

```
const string ProgId="ProjectA.Connect";
//...
Type officeAddInType = Type.GetTypeFromProgID(ProgId);           
object obj = Activator.CreateInstance(officeAddInType);
_remoteAddIn = (IAddInCommunication)obj;
_remoteAddIn.TestMethod("Hello"); 
```

问题是，`_remoteAddIn`没有指向在 Office 中运行的实例。这只是一个新实例（正如人们所期望的那样）。如何连接到 Shared-AddIn 的实际运行实例？

我使用 SendMessage API 解决了从 ProjectA 到 ProjectB 的通信，因为无论如何我的应用程序中都需要它。如果真的没有更好的方法，我只会在我的加载项中实现 SendMessage 通信。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T12:59:59.460

您可能正在寻找：

```
(IAddInCommunication)System.Runtime.InteropServices.Marshal.GetActiveObject(Pro‌​gId); 
```

从正在运行的对象表中获取一些东西。

# .net - RegularExpressionValidator 只允许链接

> ID：15365189
> 
> 赞同：0
> 
> 时间：2013-03-12T15:22:26.917
> 
> 标签：.net, regex, reg-expressionvalidator

我的项目中有一个文本框。我希望用户在这里只写来自`Vimeo`. 我该怎么做`RegularExpressionValidator`？是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:25:16.223

这是一个正则表达式，可以让您验证 Vimeo 视频链接：

```
vimeo\.com/(?:.*#|.*/videos/)?([0-9]+) 
```

您可能希望在开头添加 http 或 https。

# jsf - 没有 faces-config.xml 的 CDI bean

> ID：15365190
> 
> 赞同：0
> 
> 时间：2013-03-12T15:22:34.920
> 
> 标签：jsf, jsf-2, cdi

我想在 JSF 应用程序中使用 CDI bean。我很感兴趣是否有任何可能的方法来避免将 bean 声明到 faces-config.xml 文件中。我想使用注释来声明类似于 JSF bean 的 bean。有没有可能的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:27:27.253

无需在任何地方声明 CDI bean（注入点上的相应注释除外）。您所需要的只是一个`beans.xml`- 它也可能是空的 - 在您的战争文件夹中`META-INF`或文件夹中。`WEB-INF`

对于 Web 应用程序，将 放在文件夹中是一种常见的`beans.xml`做法`WEB-INF`。

[**在这里**](http://www.seamframework.org/Documentation/WhatIsBeansxmlAndWhyDoINeedIt)你可以找到技术背景的一个很好的解释。

# ios - 两个相似的动画表现不同

> ID：15365191
> 
> 赞同：1
> 
> 时间：2013-03-12T15:22:35.873
> 
> 标签：ios, animation, views, coordinates

我有一个通过 Storyboard 配置的 UIView。这个视图 ( `self.view`) 有一个孩子，一个按钮 ( `self.cartButton`)。稍后在代码中我添加了`subview`一个`view`：

```
[self.view addSubview:self.cart.view]; 
```

我有以下方法：

```
- (void)openCart
{
    [UIView animateWithDuration:2 animations:^{
        self.cartButton.frame = CGRectMake(0.0f, 0.0f, self.cartButton.frame.size.width, self.cartButton.frame.size.height);
        self.cart.view.frame = CGRectMake(0.0f, 0.0f, self.cart.view.frame.size.width, self.cart.view.frame.size.height);
    }];
} 
```

我认为它应该将两个对象都移动到屏幕的顶部，但真正发生的是cartButton 动画到最底部的位置，而购物车视图到顶部。为什么会这样？我在某个地方搞砸了坐标系吗？

更新：如果我注释掉动画中的第二行（动画购物车视图），`cartButton`飞到顶部。

UPDATE2：它与我的`cartView`. 它是一个通用视图（在 Storyboard 中创建）。例如，当我尝试使用 a 做相同的动画时`NavigationController`，它可以工作。

UPDATE3：如果我的购物车视图没有子视图，它工作正常。如果它里面有任何东西（一个按钮，，`navigationBar`任何东西......），它就不起作用。

# magento - magento cookie 文本替换 google 中的描述

> ID：15365201
> 
> 赞同：1
> 
> 时间：2013-03-12T15:22:46.030
> 
> 标签：magento, cookies, seo, google-search

快速提问，因为我在 1.7.0.2 中添加了 magento cookie 选项，谷歌已经将我的描述（搜索结果中主链接下的文本位）替换为我在 cookie 确认框中的文本。这不仅对于通过谷歌找到我们的人来说很糟糕，我怀疑谷歌机器人会不会对此感到非常满意。我所有的页面都设置了描述，但由于某种原因它们没有被使用？而是使用 cookie 说明文本。有谁知道我可以如何改变这个？还是阻止它发生？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-29T20:13:37.637

我遇到了完全相同的问题：Google 在我的 Magento 商店的搜索结果中显示 cookie 警告文本作为描述。

问题原来是我的元描述太短了。对我来说，解决方案是让元描述更长，至少大约 150 个字符（包括空格）。

您的 <description> 标签中的内容可以在 Magento 的后台中找到：system>configuration>general>design，在 HTML head，Default Description 下。

保存后，我清除了缓存并检查了页面源以显示更新的元数据。为了让谷歌的事情变得更快，我使用他们的网站管理员工具来提交商店网址以供抓取。稍等片刻后，谷歌在搜索结果中显示了商店的描述，就像它应该做的那样。

希望这仍然可以帮助您！

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T16:53:09.933

您能否粘贴您的 cookie 确认框及其工作原理，以及您的一些元描述？

必要时空白，只需要结构的要点。

# jquery - 当我使用动态 html 两次应用绑定时，淘汰赛变得疯狂

> ID：15365202
> 
> 赞同：4
> 
> 时间：2013-03-12T15:22:47.153
> 
> 标签：jquery, knockout.js, single-page-application, dynamic-html

我正在创建一个带有淘汰赛的单页应用程序......

我有一个 GlobalViewModel 来管理所有动态页面（我通过 ajax 获取 html）。

这是我的问题的一个例子：

[http://jsfiddle.net/zWtrr/7/](http://jsfiddle.net/zWtrr/7/)

当我加载 2 次相同的模板（在“显示模板”中单击 2 次）时，淘汰赛变得疯狂并重复数据……如果您检查可观察数组，则没有重复数据。

HTML：

```
<div id="container">
    <button data-bind="click: showView">show template</button>
    <div data-bind="html: templateHtml"></div>
</div> 
```

脚本：

```
function GlobalViewModel(){
    var self = this;
    self.templateHtml = ko.observable();
    self.templateVM = ko.observable();

    self.showView = function(){
        //i get this html from ajax
        var pageHtml = "<div id='template' data-bind='with: templateVM'>"+
            "<button data-bind='click: showAll'>All</button>" +
            "<button data-bind='click: showNames'>Names</button>" + 
            "<button data-bind='click: showLastNames'>LastNames</button>" +
            "<button data-bind='click: showNickNames'>NickNames</button>" +
            "<ul data-bind='foreach: resultsToShow'>" +
            "    <li data-bind='text: $data'></li>" +
            "</ul>" +
            "</div>";
        self.templateHtml(pageHtml)
        self.templateVM(new ViewModel())
        ko.cleanNode(document.getElementById("template"))
        ko.applyBindings(window.gvm, document.getElementById("template"));
    }

}
function ViewModel(){
    var self = this;
    self.selected = ko.observable("All");
    self.resultsToShow = ko.observableArray([]);
    self.result1 = ["Facu", "Feli", "Juli"];
    self.result2 = ["Perez","Gonzales","Garcia"];
    self.result3 = ["Piti", "Tito", "Gato"];

    self.showAll = function (){
        self.resultsToShow(self.result1.concat(self.result2,self.result3));
        self.selected("All");
    }

    self.showNames = function (){
        self.resultsToShow(self.result1);
        self.selected("Names");
    }

    self.showLastNames = function (){
        self.resultsToShow(self.result2);
        self.selected("LastNames");
    }

    self.showNickNames = function (){
        self.resultsToShow(self.result3);
        self.selected("NickNames");
    }
    self.showAll();
}
window.gvm = new GlobalViewModel();
ko.applyBindings(window.gvm, document.getElementById("container")); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:45:14.403

清洁原来的“容器”似乎有效。

```
 self.showView = function(){
    ...
    ... 
        ko.cleanNode(document.getElementById("container"));
        ko.applyBindings(window.gvm, document.getElementById("container"));
    .....
  } 
```

[http://jsfiddle.net/zWtrr/8/](http://jsfiddle.net/zWtrr/8/)

# java - 如何将 textview 的值放在 if 语句中

> ID：15365204
> 
> 赞同：0
> 
> 时间：2013-03-12T15:23:01.490
> 
> 标签：java, android, if-statement

我正在编写一个 android 应用程序来计算某人的身高和体重之间的关系。一切正常，我设法做算术。

但是，当我想将 TextView 的结果放在 if 语句中时，无论结果大于或小于或等于，我都会收到第一个 if 语句的输出。很快，我希望我的程序根据计算给出三个不同的结果。这是我的代码：

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class Main extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // My Programming Begins Here
    final EditText editTextHeight = (EditText) findViewById(R.id.editTextHeight);
    final EditText editTextWeight = (EditText) findViewById(R.id.editTextWeight);
    Button calculateButton = (Button) findViewById(R.id.calculateButton);
    final TextView result = (TextView) findViewById(R.id.result);
    final TextView suggestionResult = (TextView) findViewById(R.id.suggestionResult);
    // Coding for the Button
    calculateButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            int heightValue = Integer.parseInt(editTextHeight.getText()
                    .toString());

            int weightValue = Integer.parseInt(editTextWeight.getText()
                    .toString());

            // Finding out the square of weightValue and then dividing the
            // heightValue by the sqaure of weightValue
            result.setText(String.valueOf(heightValue
                    / (Math.sqrt(weightValue))));
            if (result.getText().toString().length() >= 1
                    && result.getText().toString().length() < 18.5) {
                suggestionResult.setText("You have to gain weight");
            }
            if (result.getText().toString().length() >= 18.5
                    && result.getText().toString().length() < 24.9) {
                suggestionResult.setText("You are normal");
            } else {
                suggestionResult.setText("You have to lose      weight");
            }
        }
    });

}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:32:30.147

尝试这个

```
double d=Double.parseDouble(result.getText().toString());

 if ( d<=18.5) {
                suggestionResult.setText("You have to gain weight");
            }
            if (d >= 18.5 && d < 24.9) {
                suggestionResult.setText("You are normal");
            } else {
                suggestionResult.setText("You have to lose  weight");
            } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:26:43.553

> 结果.getText().toString().length() >= 18.5

你在这里做错了。它将给出editext中字符的长度而不是值，并且这个条件永远不会成立。

```
float rs = Float.parseFloat(result.getText().toString()); 
```

然后进行比较。

```
if (rs >= 1 && rs < 18.5f) {
    suggestionResult.setText("You have to gain weight");
}
if (rs >= 18.5f rs < 24.9f) {
    suggestionResult.setText("You are normal");
} else {
    suggestionResult.setText("You have to lose      weight");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:30:08.623

```
 if (Double.ValueOf(result.getText()) >= 1
                && Double.ValueOf(result.getText()) < 18.5) {
                    suggestionResult.setText("You have to gain weight");
                }
                if (Double.ValueOf(result.getText()) >= 18.5
                        && Double.ValueOf(result.getText()) < 24.9) {
                    suggestionResult.setText("You are normal");
                } else {
                    suggestionResult.setText("You have to lose      weight");
                } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:31:10.453

使用它从`TextView`

```
float f = Float.parseFloat(result.getText().toString()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T15:31:34.417

像这样做 ：-）

```
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class Main extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

// My Programming Begins Here
final EditText editTextHeight = (EditText) findViewById(R.id.editTextHeight);
final EditText editTextWeight = (EditText) findViewById(R.id.editTextWeight);
Button calculateButton = (Button) findViewById(R.id.calculateButton);
final TextView result = (TextView) findViewById(R.id.result);
final TextView suggestionResult = (TextView) findViewById(R.id.suggestionResult);
// Coding for the Button
calculateButton.setOnClickListener(new OnClickListener() {

    @Override
    public void onClick(View v) {
        int heightValue = Integer.parseInt(editTextHeight.getText()
                .toString());

        int weightValue = Integer.parseInt(editTextWeight.getText()
                .toString());

        // Finding out the square of weightValue and then dividing the
        // heightValue by the sqaure of weightValue
        result.setText(String.valueOf(heightValue
                / (Math.sqrt(weightValue))));
        if (Integer.parseInt(result.getText().toString()) >= 1
                && result.getText().toString().length() < 18.5) {
            suggestionResult.setText("You have to gain weight");
        }
        if (Integer.parseInt(result.getText().toString()) >= 18.5
                && result.getText().toString().length() < 24.9) {
            suggestionResult.setText("You are normal");
        } else {
            suggestionResult.setText("You have to lose      weight");
        }
    }
}); 
```

} }

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-12T19:56:41.320

您应该直接在 if 语句中使用计算结果。不要把它放在你必须检索它进行比较的文本视图中。

# ios - iOS EKEvent 到 NSString

> ID：15365207
> 
> 赞同：1
> 
> 时间：2013-03-12T15:23:09.643
> 
> 标签：ios, icalendar, ekevent

iOS 中是否有任何 API 可以获取[iCalendar](http://en.wikipedia.org/wiki/ICalendar)格式的对象`NSString`表示？`EKEvent`

# aspnet-regiis.exe - 无法使用提供程序“RsaProtectedConfigurationProvider”加密“connectionStrings”部分

> ID：15365210
> 
> 赞同：38
> 
> 时间：2013-03-12T15:23:14.043
> 
> 标签：aspnet-regiis.exe

无法使用提供程序“RsaProtectedConfigurationProvider”加密“connectionStrings”部分。来自提供者的错误消息：对象已经存在。

我遵循了[http://msdn.microsoft.com/en-us/library/2w117ede.aspx](http://msdn.microsoft.com/en-us/library/2w117ede.aspx)中的指南，但在授予 ASP.NET 身份访问 RSA 密钥容器的第 3 步中，它说我的身份是我的工作组\用户名，但我的 web.config 文件中没有模拟

我正在使用我的机器使用 asp_regiis 加密 web.config，然后使用 Visual Studio 进行调试，然后出现此错误

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2014-05-08T08:32:56.680

要使用**RsaProtectedConfigurationProvider**，您需要以**管理员**身份启动命令提示符或 Visual Studio 。

对于**DataProtectionConfigurationProvider**，它不需要在管理员权限下运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-27T10:11:19.630

您可以使用 RsaProtectedConfigurationProvider 创建自己的提供程序来加密您的 web.xml，而无需管理员权限。

1.  创建密钥库：

    aspnet_regiis -pc "MyKeyStore" -exp

2.  为任何用户授予读取权限：

    aspnet_regiis -pa "MyKeyStore" "域/用户"

3.  在您的 web.config 中放置一个提供程序部分

    ```
    <configProtectedData>
    <providers>
        <add name="MyRSAProvider" type="System.Configuration.RsaProtectedConfigurationProvider,System.Configuration, Version=2.0.0.0, Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL"keyContainerName="MyKeyStore"useMachineContainer="true" />
    </providers>
    </configProtectedData> 
    ```

4.  加密您的配置部分：

    aspnet_regiis -pef "configSection" "c:\pathToWebConf" -prov "MyRSAProvider"

资料来源：

[创建 RSA 密钥容器和提供程序](https://msdn.microsoft.com/en-us/library/yxw286t2.aspx)

[加密配置](https://msdn.microsoft.com/en-us/library/dtkwfdky.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-22T19:11:33.193

这发生在我的一台服务器上，整个服务器试图将 Web 应用程序从 c 驱动器移动到另一个驱动器。

因为我已经加密了驱动器 C 上的 web.config 部分并将其移动到另一个驱动器，所以它阻塞了提供程序，导致它无法加密该部分，因为它认为它已经存在。

我仍在努力修复它。

# jquery - 测试 jQuery Selectable capybara 或 selenium (ctrl + click)

> ID：15365217
> 
> 赞同：2
> 
> 时间：2013-03-12T15:23:32.313
> 
> 标签：jquery, selenium, capybara

我正在使用 jQuery Selectable 来管理日历。这个功能很好用，它只是进入测试自动化的问题。

我需要从日历网格中选择多个不连续的日期。

我已经尝试了一些东西，并没有真正期望它们能够工作

```
date = '2013-05-02'
page.execute_script %{
    var e = jQuery.Event("keydown");
    e.ctrlKey = true; // # Some key code value
    e.keyCode = 17
    $("body").trigger(e);
}
find("td[data-date='#{date}']").click 
```

我为一系列日期执行此操作，但似乎没有考虑 ctrl 键，因为实际上只有最后一个选择的日期被选中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:23:34.497

您可以使用 selenium-webdriver 的操作构建器。但是，firefoxdriver 中似乎存在一个错误，导致目前无法正常工作（可能是[issue 4863](http://code.google.com/p/selenium/issues/detail?id=4863)）。

这是使用 Chrome 的 JQuery 可选页面的工作示例：

```
require 'capybara'
require 'capybara/dsl'
include Capybara::DSL

#Use selenium-webdriver with chrome
Capybara.register_driver :selenium do |app|
  Capybara::Selenium::Driver.new(app, :browser => :chrome)
end
Capybara.current_driver = :selenium

#Go to the JQuery Selectable example page
Capybara.app_host = 'http://jqueryui.com/selectable/'
page.visit('')

#The controls are in a frame, so need to switch to it
within_frame 0 do
    #Create a selenium-webdriver action builder
    builder = page.driver.browser.action

    #Hold control key down
    builder.key_down(:control)

    #Click all elements that you want, in this case we click all lis
    #Note that you can retrieve the elements using capybara's
    #  standard methods. When passing them to the builder
    #  make sure to do .native
    elements = page.all('ol#selectable li')
    elements.each do |e|        
        builder.click(e.native)
    end

    #Release control key
    builder.key_up(:control)

    #Do the action setup
    builder.perform
end 
```

# perl - Perl IO::Handle 警告行为

> ID：15365218
> 
> 赞同：2
> 
> 时间：2013-03-12T15:23:33.437
> 
> 标签：perl

我刚刚在做某事时遇到了一个讨厌的小错误，因为我打开了一个输入文件而不是输出文件（这不是讨厌的部分）。发生这种情况是因为我使用的是 XML::Writer，它可以采用有福的 IO::Handle 引用或文件句柄作为输出（或标量引用，但这在这里并不重要）。在内部，XML::Writer 调用`->print`它使用的任何输出 ref。

出现问题的原因是可以调用`print`仅为输入而打开的文件句柄，而 IO::Handle 根本不会发出警告。这里有一些代码来说明：

```
open my $out, '<', 'out.txt';
say $out 'testing';         # warns, "Filehandle opened only for input"
$out->print('testing');     # doesn't do anything?!

open my $out2, '>', 'out2.txt';
$out2->print('testing');    # works fine 
```

这里发生了什么？这是预期的行为吗？我不经常使用 IO:: 类，所以我只是误解了一些东西吗？

为清楚起见进行编辑：

上面的代码肯定会产生一个警告（第 2 行）。我觉得第 3 行也应该产生警告，但事实并非如此。它不会向 打印任何内容`$out`，也不会警告它不会...它只是默默地失败（这似乎是错误的）。第 3 行不会对我拥有的任何 Perl 版本产生警告：5.8、5.10 或 5.16。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-10T10:05:02.563

所有版本 >=5.14 都会在第三行（FH 方法调用）上正确发出警告。

5.10 和 5.12 版本的警告不同： *无法通过包“IO::File”定位对象方法“print”。* 这是因为没有定义打印到仅输入句柄。您需要`print <$out>;`那里的语法来打印输入句柄读取的结果。

<5.10 的版本没有发言权，但会发出与 5.10 和 5.12 相同的警告。

# c# - GUI 控件上的线程访问

> ID：15365219
> 
> 赞同：2
> 
> 时间：2013-03-12T15:23:43.250
> 
> 标签：c#, multithreading, winforms

我的话题几乎就是这个问题。我知道线程访问 GUI 控件存在限制。似乎不可能从主线程以外的另一个线程在控件中写入/设置某些内容。

但是例如，当我尝试读取复选框是否被选中时，它可以工作。阅读组合框的文本不会。

我正在使用带有 .net 框架 4 的 Windows 窗体。

有人能告诉我线程的限制在哪里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:26:36.533

每当您访问 UI 元素时，您都必须在*UI 线程上。*您观察到的内容不取决于控件是复选框还是下拉列表，而是您从哪个线程访问。

Windows 窗体控件提供`Invoke`方法调度对 UI 线程的调用。还有一个*async* [`BeginInvoke`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx)。异步调用可能会加速您的系统（取决于您的设计）。

WPF中有一篇关于*Dispatcher*的文章：[Build More Responsive Apps With The Dispatcher](http://msdn.microsoft.com/en-us/magazine/cc163328.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:32:22.047

您可以调用一个操作来使用 UI 执行某些操作，但仅当您需要从工作线程访问某些内容时才需要它。

```
void UpdateMessage (string message)
{
  Action action = () => txtMessage.Text = message;
  this.Invoke (action);
} 
```

[这是一个关于线程的非常好的资源](http://www.albahari.com/threading/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:28:07.500

UI 元素只能在 UI 线程上更新 - 您可以检查是否[需要调用](http://msdn.microsoft.com/en-gb/library/system.windows.forms.control.invokerequired.aspx)来让您知道您是否在另一个线程上。

这是一个类似的问题，您可能会喜欢[GUI 对象何时需要调用？](https://stackoverflow.com/questions/5554981/when-is-invoke-required-on-gui-objects)

# java - 将数组插入 int 数组的 arraylist 的正确位置

> ID：15365221
> 
> 赞同：1
> 
> 时间：2013-03-12T15:23:59.847
> 
> 标签：java, search, arraylist

### 概述

我有一个 arrayList 包含多个 int 数组，这些数组有两个参数，键和值。（我知道存在一个地图库，但对于这个任务我希望使用一个数组列表）。

想象一下我的 arrayList 有以下数组：

[3, 99][6, 35][8, 9][20, 4][22, 13][34, 10]

如您所见，它们按索引排列，这是我第一次将它们添加到 arrayList 时完成的。

### 我的问题

如果我想向这个 arrayList 添加一个数组，它将附加到列表的末尾，而我想将它添加到列表中的正确位置。

我对arrayLists 相当陌生，因此想知道是否存在一个我没有遇到过的优雅解决方案来解决这个问题。

### 目前的想法

目前，我的解决方案是遍历arrayList，然后为每个数组临时存储键（array [0]），然后我将再次迭代并将我的数组添加到正确的位置（其中键在两个之间其他键）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:32:11.997

生成一个类来保存您的两个值并确保 implements 可能更优雅[`Comparable`](http://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html)，如下所示：

```
public class Foo implements Comparable<Foo> {

  private int x; // your left value
  private int y; // your right value

  // Constructor and setters/getters omitted

  public int compareTo(Foo o) {
    return Integer.compare(x, o.getX());
  }
} 
```

然后添加和排序如下：

```
List<Foo> listOfFoos = new ArrayList<Foo>;
// ...
listOfFoos.add(new Foo(33,55));
Collections.sort(listOfFoos); 
```

那将是最易读的解决方案。可能有更快的选择，但只有在你能证明这部分是瓶颈的情况下才进行优化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:33:07.603

您的迭代想法是正确的；但是不需要执行两次迭代。找到正确的索引并插入元素可以在一个循环中完成。ArrayList 有一个方法`add(int, E)`可以将元素插入到列表中的任何位置。试试这个：

```
//the value you want to insert
int[] toInsert = {someValue, someOtherValue};

//assume theList is the list you're working with
for(int index = 0; index < theList.size() -1; index ++)
{
     int key = theList.get(index)[0];
     int nextKey = theList.get(index + 1)[0];

     //if we've reached the correct location in the list
     if (toInsert[0] > key && toInsert[0] < nextKey)
     {
          //insert the new element right after the last one that was less than it
          theList.add(index + 1,toInsert);
     }
} 
```

请注意，此方法假定列表已排序开始。如果您想保证这一点，请查看描述排序和`Comparator`s 的其他一些答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:32:22.717

**第一个选项**

如果您希望能够对数组进行排序，则应该存储[Comparable](http://docs.oracle.com/javase/6/docs/api/java/lang/Comparable.html) Objects。

因此，您可以创建一个 Class 来保存您的两个值数组并实现 Comparable 接口。

如果您选择此选项，则在添加元素后，您需要做的就是调用`.sort()`您的`List`.

**第二种选择**

您可以定义可用于排序的[比较器。](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)这将是可重用的，并允许您保留二维数组。您还必须在每次添加后进行排序。

**第三个选项**

您可以动态定义 Comparator，如以下特定问题所示： [Java Comparator class to sort arrays](https://stackoverflow.com/questions/5393254/java-comparator-class-to-sort-arrays)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:32:33.547

您可以执行以下操作：

```
import java.util.ArrayList;

   public class AddElementToSpecifiedIndexArrayListExample {

  public static void main(String[] args) {
//create an ArrayList object
  ArrayList arrayList = new ArrayList();

//Add elements to Arraylist
   arrayList.add("1");
   arrayList.add("2");
   arrayList.add("3");

/*
  To add an element at the specified index of ArrayList use
  void add(int index, Object obj) method.
  This method inserts the specified element at the specified index in the
  ArrayList.  
*/
arrayList.add(1,"INSERTED ELEMENT");

System.out.println("ArrayList contains...");
for(int index=0; index < arrayList.size(); index++)
  System.out.println(arrayList.get(index));

    }
} 
```

/* 输出将是 ArrayList 包含... 1

插入元素

2

3

*/

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T15:33:51.603

还有一个版本`add`采用添加新项目的索引。

```
int i;
for(i=0; i<arr.size(); i++){
    if(arr.get(i)[0] >= newArr[0]){
        arr.add(i, newArr);
    }
}
if(i == arr.size())
    arr.add(i, newArr) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-12T15:40:41.463

使用 int[] 的 Comparator 和 binarySearch ：

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;

public class Main
{

    public static void main(String[] argv)
    {
        ArrayList<int[]> list = new ArrayList<int[]>();

        list.add(new int[] { 3, 99 });
        list.add(new int[] { 6, 35 });
        list.add(new int[] { 8, 9 });
        list.add(new int[] { 20, 4 });
        list.add(new int[] { 22, 13 });
        list.add(new int[] { 34, 10 });

        Compar compar = new Compar();

        addElement(list, new int[] { 15, 100 }, compar);

        for(int[] t : list)
        {
            System.out.println(t[0]+" "+t[1]);
        }

    }

    private static void addElement(ArrayList<int[]> list, int[] elem, Compar compar)
    {
        int index = Collections.binarySearch(list, elem, compar);

        if (index >= 0)
        {
            list.add(index, elem);
            return;
        }

        list.add(-index - 1, elem);
    }

    static class Compar implements Comparator<int[]>
    {
        @Override
        public int compare(int[] a, int[] b)
        {
            return a[0] - b[0];
        }
    }
} 
```

# python - 计算两个同步列表中数字和关联值的出现次数

> ID：15365223
> 
> 赞同：0
> 
> 时间：2013-03-12T15:24:20.333
> 
> 标签：python, python-2.6

我有两个长度相同的列表：

```
alist = ['XX', 'HH', 'GG', 'XX', 'II', 'PP', 'LL', 'TT', 'KK', 'XX']
blist = [2, 3, 5, 5, 9, 8, 9, 4, 7, 2] 
```

我想知道 alist 中的哪些值在 blist 中具有相同的数字。我希望结果如下所示：

2 = XX; 3 = 高；5 = GG，XX；9 = II，LL；8 = 聚丙烯；4 = TT；7 = KK

我是这样解决的：

```
from collections import defaultdict
adict = {}
a = zip(blist, alist)
for key, value in a:
    adict.setdefault(k, []).append(v) 
```

这给出了这个结果： adict:

```
{2: ['XX', 'XX'], 3: ['HH'], 4: ['TT'], 5: ['GG', 'XX'], 7: ['KK'], 8: ['PP'], 9: ['II', 'LL']} 
```

但我不想要两次相同的值，例如 2：['XX'，'XX'] - 我想改为 2：['XX']。

```
I tried this using 'set' before the list of values:
a = zip(blist, alist)
for key, value in a:
    a.setdefault(k, set[]).append(v) 
```

但它抱怨......有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:25:48.707

使用`defaultdict`您导入的类型，否则忽略：

```
from collections import defaultdict

a = defaultdict(set)
for k, v in zip(blist, alist):
    a[k].add(v) 
```

结果是：

```
>>> a
defaultdict(<type 'set'>, {2: set(['XX']), 3: set(['HH']), 4: set(['TT']), 5: set(['GG', 'XX']), 7: set(['KK']), 8: set(['PP']), 9: set(['II', 'LL'])}) 
```

`defaultdict`是的子类，`dict`并且在其他情况下的行为方式相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:42:18.837

我个人会使用 Martijn 的`defaultdict`方法，但我想我会用你当前的尝试解决这些问题。

您的代码的问题：

```
a = zip(blist, alist)
for key, value in a:
    a.setdefault(k, set[]).append(v) 
```

就是它：

*   之后`zip`，`a`现在是一个列表，所以它不支持`.setdefault`
*   `k`不在 for 循环中使用 - 它应该是`key`
*   `v`没有在 for 循环中使用 = 它应该是`value`
*   `set[]`无效的 synatx - 创建一个新的`set`- 使用`set()`
*   A`set`没有`.append`- 而是您想使用`add`

更正的代码：

```
d = {}
a = zip(blist, alist)
for key, value in a:
    d.setdefault(key, set()).add(value) 
```

根据需要调整以下内容以进行打印：

```
for k, v in d.iteritems():
    if k > 5:
        print '{0}: {1}'.format(k, ','.join(v)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:32:49.633

使用您的代码，然后添加：

```
a = {x: set(a[x]) for x in a } 
```

# maven-2 - Artifactory 忽略部署到 libs-release-local 中的工件

> ID：15365225
> 
> 赞同：0
> 
> 时间：2013-03-12T15:24:21.303
> 
> 标签：maven-2, artifactory

我们正在评估将 Artifactory 用作我们的本地/远程存储库。我们的应用程序使用自定义的**cxf-2.6.6 jar。** 我们已经手动将 cxf jar 部署到**libs-release-local**中。但是每次我们进行本地构建时，Artifactory 都会从远程 maven 存储库中下载一个 cxf 2.6.6 版本到**ext-release-local**中。结果将有两个 cxf 2.6.6.jar 副本，不幸的是，我们的本地构建只使用下载的 cxf 而不是我们部署的那个。

**libs-release-local**和**ext-release-local**都映射到同一个虚拟存储库**libs-release**，所以这很奇怪。即使我从 ext-release-local 中删除了 cxf，它也会再次下载。我该如何限制这个？我可能可以将 cxf 部署到 ext-release-local 中（我还没有尝试过）？

但是，这不是一个错误吗？请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T12:56:03.913

您可以控制虚拟存储库的解析顺序：Admin -> Repositories -> Edit (Virtual repository) -> 在“Selected Repositories”框中拖放存储库名称。
“Resolved Repositories”框将反映执行解析的顺序。
一般来说，从虚拟存储库请求工件时的搜索/解析顺序始终是：本地存储库、远程存储库缓存，最后是远程存储库本身。

如果您使用 Artifactory 2.6.0 或更高版本，则可以使用[Trace Artifact Retrieval](http://www.jfrog.com/confluence/display/RTF/Artifactory+REST+API#ArtifactoryRESTAPI-TraceArtifactRetrieval)功能来模拟来自指定位置的工件检索请求并返回有关解析过程的详细输出。

# knockout.js - 编辑淘汰赛 observableArray 中的项目

> ID：15365227
> 
> 赞同：1
> 
> 时间：2013-03-12T15:24:26.400
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-2.0

我正在寻找一个示例，我可以将 observableArray 显示为带有编辑/删除链接的普通文本。可以从单独的表单添加/编辑项目。我无法从添加新记录的编辑链接编辑记录！

> ```
>  self.editItem = function (p) {
>         //edit code
>         ////???????
>     }; 
> ```

[这是示例](http://jsfiddle.net/JnjFf/3/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T16:32:57.520

正如其他答案中提到的那样，您应该使用`with`绑定来编辑任何特定记录。在这里，我根据您的需要创建了一个演示。

[http://jsfiddle.net/85afB/1/](http://jsfiddle.net/85afB/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:53:21.713

您必须跟踪将要编辑的特定项目（使其可观察）并[与 binding 一起](http://knockoutjs.com/documentation/with-binding.html)使用。[请参阅此答案](https://stackoverflow.com/a/9356505/209459)（jsFiddle）中的完整示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:52:34.063

不完全确定您在问什么，但如果您想将值放回编辑框中，请尝试以下操作：

```
self.editItem = function (p) {
    self.FirstName(p.FirstName);
}; 
```

然后只需要编写你的逻辑来检查它是否已经存在

# python - matplotlib中的轴重叠线

> ID：15365228
> 
> 赞同：1
> 
> 时间：2013-03-12T15:24:27.090
> 
> 标签：python, matplotlib, graphing

我目前正在尝试在 matplotlib 图上绘制一系列任意线。这是我正在使用的代码：

```
import matplotlib.pyplot as pyplot

def center_origin(axis):
    '''Center the axis in the middle of the picture'''
    axis.spines['right'].set_color('none')
    axis.spines['top'].set_color('none')
    axis.xaxis.set_ticks_position('bottom')
    axis.spines['bottom'].set_position(('data',0))
    axis.yaxis.set_ticks_position('left')
    axis.spines['left'].set_position(('data',0))

def render(lines):
    figure = pyplot.figure(figsize=(4,4))
    axis = figure.add_subplot(1, 1, 1)

    center_origin(axis)        

    for (x1, y1), (x2, y2) in lines:
        axis.add_line(pyplot.Line2D((x1, x2), (y1, y2), color='red'))

    axis.set_xlim(-1.2, 1.2)
    axis.set_ylim(-1.2, 1.2)
    return figure

if __name__ == '__main__':
    render([((1, 0), (0, 1)),
            ((1, 0), (-1, 0)),
            ((1, 0), (0, -1))]).show()
    raw_input('block > ') 
```

它会生成一个如下所示的图表：

![坏图](../Images/1655629b6a53e187cdf5ee06c29d0cf7.png)

目前，x 轴覆盖了应该从 (1, 0) 到 (-1, 0) 的红线。`center_origin`我尝试在画线之前和之后放置函数，但没有任何改变。

如何让 matplotlib 在轴上画线？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T16:14:00.840

该属性`zorder`决定了线在彼此之上绘制的顺序。试试`pyplot.Line2D((x1, x2), (y1, y2), color='red', zorder = 1)`。玩弄价值，你可能需要更高的东西。

# regex - 在 R 中转义小于号的粘贴/系统命令

> ID：15365234
> 
> 赞同：0
> 
> 时间：2013-03-12T15:24:43.063
> 
> 标签：regex, r, escaping

我想`head <(cat file.txt)`在 R 中使用系统运行，但是转义`<`是一个问题。

```
system(paste("head <(cat file.txt)"))
sh: -c: line 0: syntax error near unexpected token `('
sh: -c: line 0: `head <(cat file.txt)'

I've tried escaping it, but its not working

system(paste("head /<(cat file.txt)"))
head: cannot open `/<(cat file.txt)' for reading: No such file or directory 
```

有人可以提出替代方案。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T15:34:58.643

问题不在于转义`<`。默认情况下，`system`使用 运行命令`/bin/sh`，并且您的命令与此 shell 不正确：

```
$ sh -c "head <(cat foo.txt)"
sh: 1: Syntax error: "(" unexpected 
```

但它适用于 bash。

在 R 下，您可以尝试以下操作：

```
system("bash -c 'head <(cat file.txt)'") 
```

# c# - 自定义会员提供者 + 自定义 CodeAccessSecurityAttribute

> ID：15365240
> 
> 赞同：1
> 
> 时间：2013-03-12T15:25:03.703
> 
> 标签：c#, security, asp.net-mvc-4, attributes

我的任务是为我们的 MVC 4.0 项目的方法创建一个自定义成员资格提供程序。

基于属性（`[Authorize]`？），它必须确定是否允许尝试的用户使用该方法。

目前我有这个：

```
[AttributeUsage(AttributeTargets.Method | AttributeTargets.Class, AllowMultiple = true, Inherited = false)]
public class TestAuthorize : CodeAccessSecurityAttribute
{
    public TestAuthorize(SecurityAction action)
        : base(action)
    {
    }

    public override IPermission CreatePermission()
    {
        throw new NotImplementedException();
    }
} 
```

当我添加时， `return new PrincipalPermission(null,null,true)`我希望权限有效并且用户可以访问该方法。

当我添加时， `return new PrincipalPermission(null.null,false)`我希望权限无效，并且用户将被拒绝访问该方法。

但是，它仅在我使用 a 时才停止继续，`throw new SecurityException("You are denied access")`这也强制 MVC 应用程序停止，除非在客户端处理此异常（使用 try catch）。

我们有可能在我们的 MVC 项目中处理这个异常吗？

作为我们希望通过使用属性来完成的示例：

```
[TestAuthorize(SecurityAction.Demand)]
public List<string> GetList()
{
    //if access, return new List();
    //if no access, return null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:07:42.933

很确定你想从[`AuthorizeAttribute`](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28System.Web.Mvc.AuthorizeAttribute%29;k%28AuthorizeAttribute%29;k%28TargetFrameworkMoniker-.NETFramework,Version%3Dv4.0%29;k%28DevLang-csharp%29&rd=true)这里继承，而不是`CodeAccessSecurityAttribute`. 在您的属性中，如果应该允许用户继续，并且如果他们无权执行该方法所做的任何事情，您将覆盖`AuthorizeCore`并简单地返回。结果将触发响应，ASP.NET 通过将用户重定向到登录页面来自动处理该响应，以便他们可以以具有正确访问权限的人身份登录，尽管您可以根据需要更改此行为。`true``false``false``HTTP-401 Unauthorised`

事实上，您甚至可能不需要创建自己的属性；如果您正在使用现有的 ASP.NET MVC mempership 提供程序，或者您可以获得任何您正在使用的东西来很好地使用它，那么现有的`AuthorizeAttribute`将为您工作。

# node.js - Node.js+Mongodb，两个ajax请求同时，一个被挂起

> ID：15365241
> 
> 赞同：0
> 
> 时间：2013-03-12T15:25:04.950
> 
> 标签：node.js, mongodb

这是我的环境：

1.  Mac OS X：10.7.5
2.  Node.JS：v0.8.14
3.  Mongodb：v2.0.6 + node-mongodb-native 驱动
4.  雷迪斯：2.6.3
5.  语言：咖啡脚本

事情是这样的：当索引页面加载时，将发送两个 ajax 请求：

```
var xhr1 = $.ajax({
    url: '/a',
    'dataType': 'json'
    'success': function(){}
);
xhr1.done(function(){...})
var xhr2 = $.ajax({
    url: '/b',
    'dataType': 'json'
    'success': function(){}
);
xhr2.done(function(){...}) 
```

然后两者都将查询 Mongodb，如下所示：

```
app.get('/a', functionA);
app.get('/b', functionB);

functionA = function() {
    var collectionA = new mongodb.Collection(client, 'a');
    collectionA.find().toArray(function(err, arrayA){
        var collectionB = new mongodb.Collection(client, 'b');
        collectionB.find().toArray(function(err, ArrayB) {
        });
    });
}
functionA = function() {
    var collectionB = new mongodb.Collection(client, 'b');
    collectionB.find().toArray(function(err, arrayB){
    });
} 
```

两个请求中的collectionB是同一个collection

每次，一个请求（第一个或第二个）被挂起，没有响应，没有错误。从日志中，我可以看到该请求被卡在 find() 方法中。大约两分钟后，页面再次发送了相同的请求（我猜是 JQuery 做到了），然后得到了响应。

在这两个请求中，没有redis请求。

是因为mongodb吗？并发问题？

# php - PHP 将多维数组打印到 HTML

> ID：15365243
> 
> 赞同：1
> 
> 时间：2013-03-12T15:25:13.027
> 
> 标签：php, html, multidimensional-array

我环顾四周，但我不确定我能找到具体的答案，所以如果我错过了合适的帖子，我深表歉意，请链接我:)

我正在创建一个脚本来在文件夹中搜索更多文件夹，并将每个文件夹中所有文件的列表编译成一个多数组。文件夹名称将是随机的，所以我对如何使用 foreach 循环提取它们有点迷茫。

我也对“ **[0] => Array** ”中的第二个数组感到困惑。我的脚本中的输出数据当前如下所示：

```
 Array
(
    [0] => Array
        (
            [folders] => Array
                (
                    [album 1] => Array
                        (
                            [0] => wallpaper-1089283.jpg
                            [1] => wallpaper-2549931.png
                            [2] => wallpaper-379108.jpg
                            [3] => wallpaper-38130.jpg
                        )

                    [album 2] => Array
                        (
                            [0] => ns75FqFLk1v6jEmecgu25IOk8yB.jpg
                            [1] => wallpaper-1627330.jpg
                            [2] => wallpaper-1629402.jpg
                        )

                    [album 3] => Array
                        (
                            [0] => wallpaper-1042083.jpg
                            [1] => wallpaper-176023.jpg
                            [2] => wallpaper-2624435.jpg
                        )

                )

        )

) 
```

所以我真的想让这些数据输出到下面的一些 html 中。我并没有真正对多数组做太多工作，我希望我能学到:)

```
<div>
    <img src="image.jpg"/>
    <img src="image.jpg"/>
    <img src="image.jpg"/>
</div>
<div>
    <img src="image.jpg"/>
    <img src="image.jpg"/>
    <img src="image.jpg"/>
</div>
<div>
    <img src="image.jpg"/>
    <img src="image.jpg"/>
    <img src="image.jpg"/>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:27:45.753

```
foreach ($array[0]['folders'] as $albumID => $images) {
    ... <div> ...
   foreach($images as $img) {
      .... <img> here ...
   }
   .... </div>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:29:32.280

```
foreach($array[0]['folders'] as $albumarray)
{
  echo "<div>";
   foreach(albumarray as $img)
   {
    echo '<img src="'.$img.'"/>'
   }
   echo "</div>";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:29:57.147

尝试这个：

```
foreach($data as $singleFolder) {
  echo '<div>';
   foreach($singleFolder as $img){
     echo "<img src='$img' />";
   }
  echo '</div>'
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:30:27.813

```
$array = array(
    0 => array(
        'folders' => array(
            'album 1' => array(
                0 => 'wallpaper1.jpg',
                2 => 'wallpaper1.jpg',
                3 => 'wallpaper1.jpg',
            ),
            'album 2' => array(
                0 => 'wallpaper1.jpg',
                2 => 'wallpaper1.jpg',
                3 => 'wallpaper1.jpg',
            ),
            'album 3' => array(
                0 => 'wallpaper1.jpg',
                2 => 'wallpaper1.jpg',
                3 => 'wallpaper1.jpg',
            )
        )
    )
);

$output = '';

foreach ($array[0]['folders'] as $key => $value) {
    $output .= '<div>\n';

    foreach ($value as $file) {
        $output .= '\t<img src="'.$file.'" />\n';
    }

    $output .= '</div>\n';
}

echo $output; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T15:31:10.570

尝试这样的事情。

```
$albums = $array[0]['folders'];
foreach ($album as $img_array)
{
  echo "<div>";
    foreach ($img_array as $img)
    {
       echo "<img src='".$img."'/>";
    }
  echo "</div>";
} 
```

# asp.net - asp.net/vb.nrt 仅选择本地 web.config 文件

> ID：15365245
> 
> 赞同：0
> 
> 时间：2013-03-12T15:25:22.310
> 
> 标签：asp.net, vb.net, web-config

我正在部署一个用 vb.net 编写的 asp.net 解决方案，该解决方案在 localhost 服务器和我的开发服务器上运行良好。在实时服务器上，该解决方案一直忽略本地 web.config 文件，并使用属于我无法控制的另一个人项目的文件。

这是我上传到实时服务器的文件夹中的文件列表：

*   图像文件夹
*   默认.htm
*   表单删除.aspx
*   表单删除.aspx.vb
*   谢谢你.htm
*   网络配置

我希望我的解决方案只查看与它位于同一文件夹中的 web.config，而不是从另一个 web.config 文件继承任何值。这可以做到吗？

谢谢先进

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:14:25.447

几天前这发生在我身上；因为我是它们的所有者，所以我删除了不需要的应用程序，然后重新启动了 IIS。

也许您的应用程序和另一个应用程序之间存在一些相似之处，或者存在一些错误的重定向，我不知道。就我而言，另一个应用程序只是链接到一个测试数据库，这就是我知道存在问题的方式。

# javascript - Typescript 中的导出函数

> ID：15365246
> 
> 赞同：2
> 
> 时间：2013-03-12T15:25:31.750
> 
> 标签：javascript, module, typescript

我有一个`.ts`包含模块和模块外部函数的文件，如下所示：

```
$(function () {
   populate()
});

function populate() {
...
}

module portfolio.charts {
   export function foo(){
   ...
   }
} 
```

使用 Typescript 编译器命令`tsc --declaration`创建声明文件。该`.d.ts`文件包含以下代码：

```
 function populate(): void;
 module portfolio.charts {
       function foo(): void;
 } 
```

为什么要导出`populate()`函数和模块？`portfolio.charts`我认为`export`导出函数或模块的关键字是必要的。如果我将`d.ts`文件添加为对另一个文件的依赖项，我可以使用所有函数和模块。我可以将它们声明为私有吗？谢谢和对不起我的英语。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T15:36:43.810

TypeScript 规范在这方面有点枯燥，所以这里有一些例子。

**示例 1**

```
module MyModule {
    class MyClass {
        myFunction() {
            alert('Test');
        }
    }

    function myOtherFunction() {
        alert('Test Again');
    }
} 
```

在本例中，`MyModule`是一个全局模块（它不在任何其他模块内），因此*它将*出现在定义文件中。`MyClass`,`myFunction`并且`myOtherFunction`在定义中是不可见的：

```
module MyModule {
} 
```

因此，要在您的声明中显示某些内容，它要么......

1.  需要在全局范围内，就像`MyModule`您`populate`的示例中的一样，或者

2.  需要以`export`关键字为前缀

在您的示例中，第 1 点适用。

# python - 使用 Mingw 和 gcc 构建 Python

> ID：15365249
> 
> 赞同：20
> 
> 时间：2013-03-12T15:25:44.623
> 
> 标签：python, gcc, mingw, mingw-w64

是否可以在 Windows 7 上使用 Mingw 和 gcc 从源代码构建 Python 解释器？我想构建一个 64 位版本。

如果有 64 位 Python (gcc Mingw) 版本可供下载，请告诉我，我也会使用它。最后我还是想用 gcc 和 mingw 编译它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T15:56:07.343

首先，您不需要使用 MinGW-w64 构建 Python 来链接到它并嵌入解释器。只需提取 msi 安装程序，并使用预构建的 DLL。请注意，您必须小心不要混合 msvcr[t|90].dll 对象，但我个人从未见过这是一个真正的问题。

MinGW-w64 gcc/ld 应该能够直接链接到 DLL，否则您将不得不使用`gendef` [创建 .def 文件](https://sourceforge.net/p/mingw-w64/wiki2/gendef/)并`dlltool` [创建导入库](https://sourceforge.net/p/mingw-w64/wiki2/Answer%20generation%20of%20DLL%20import%20library/)。

其次，有一个[使用 MinGW 构建 Python 的补丁集](http://bugs.python.org/issue3871)，但我不确定它的 64 位兼容性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-21T08:06:37.827

你可以试试这个仓库：

hg 克隆[https://bitbucket.org/puqing/python-mingw](https://bitbucket.org/puqing/python-mingw)

它是官方存储库的副本，但包含一些修改以使其与 mingw 一起编译。进入PC/MinGW目录：

cd PC/MinGW && 制作

不确定它是否在 win64 中编译，但使用 win32 和 msys 应该可以工作。

# string - 比较excel vba中的字符串

> ID：15365250
> 
> 赞同：1
> 
> 时间：2013-03-12T15:25:46.090
> 
> 标签：string, excel, vba

我有一堆由字符“A”，“B”...“Z”（没有其他）组成的字符串。一个典型的字符串看起来像`ABZYC`. 字符串是成对给我的，比如`ABC`, `ABDC`。如果一个字符串包含在另一个字符串中，则这些字符串是可比较的（即两个字符串中的一个包含另一个字符串的所有字母）。字符串出现的顺序无关紧要。

excel vba中是否有任何直接功能可以进行这种比较？

示例：
`ACBD`, `AC`- `Match`
`ACBD`, `CA`- `Match`
`ACBD`, `ADB`- `Match`
`AC`, `ABCD`- `Match`
`ABC`, `ABD`-`No Match`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T17:21:44.087

在工作簿的模块中添加以下函数：

```
Function allIn(str1, str2)
' check whether all elements of str1 occur in str2
' and vice versa
Dim l1, l2, ii As Integer
Dim isfound As Boolean

isfound = True

l1 = Len(str1)
l2 = Len(str2)

If l1 < l2 Then
' look for all the elements of str1 in str2
  For ii = 1 To l1
    If InStr(1, str2, Mid(str1, ii, 1), vbTextCompare) <= 0 Then
      isfound = False
      Exit For
    End If
  Next ii
Else
' look for all the elements of str2 in str1
  For ii = 1 To l2
    If InStr(1, str1, Mid(str2, ii, 1), vbTextCompare) <= 0 Then
      isfound = False
      Exit For
    End If
  Next ii
End If
allIn = isfound
End Function 
```

现在，您可以使用`result = inStr("ABD", "BAD")`- 或从电子表格本身从代码中的另一个位置调用它。在电子表格上，您将键入`=allIn(A3, B6)`以比较单元格中的字符串`A3`和`B6`.

这是我这样做时发生的事情（我输入`=allIn(A1, B1)`了 cell `C1`，然后将公式拖到接下来的四行）：

![电子表格的屏幕截图](../Images/4cadd561f0fedd9bd25ff1a2f3b4da89.png)

我相信这可以解决您的问题。

编辑：我刚刚注意到@Philip 对您的问题的评论 - 我似乎已经实施了他的建议，尽管我在开始编写它时没有看到它......但这里仍然是一个小技巧！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:28:57.600

INSTR 将在字符串中查找子字符串：

```
Typical_String = "ABZYC"

if instr(Typical_String,"ABC") > 0 then 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T17:41:38.883

如果您想要一个公式解决方案，**Excel 先生**论坛网站上一个名为*Schielrn*的用户想出了[这个崇高的杰作](http://www.mrexcel.com/forum/excel-questions/690910-formula-compare-two-strings.html#post3417179)（使用**ARRAY FORMULAS**）

 ****或者，如果你想要一个 VBA，试试这个......

```
Sub compare()

Dim iIndx As Integer
Dim str1 As String
Dim str2 As String
Dim sLetter As String
Dim bFound As Boolean

Range("A1").Select
bFound = False

Do

    str1 = VBA.Trim(ActiveCell.Text)
    str2 = VBA.Trim(ActiveCell.Offset(0, 1).Text)

    For iIndx = 1 To Len(str1)
        If VBA.InStr(str2, VBA.Mid(str1, iIndx, 1)) <> "" Then
            ' found it
            bFound = True
        Else
            bFound = False
            exit for
        End If
    Next

    If bFound = False Then
    ' check the other way!
        For iIndx = 1 To Len(str2)
            If VBA.InStr(str1, VBA.Mid(str2, iIndx, 1)) <> "" Then
                ' found it
                bFound = True
            Else
                bFound = False
            exit for
            End If
        Next
    End If

    If bFound = True Then ActiveCell.Offset(0, 2).Value = "MATCHED!"

    ActiveCell.Offset(1, 0).Select
Loop While Not ActiveCell.Offset(1, 0).Text = ""

End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-03T14:43:51.847

我看错了帖子！

使用功能`EXACT`

> 比较两个文本字符串，如果完全相同则返回 TRUE，否则返回 FALSE。EXACT 区分大小写，但忽略格式差异。

我通常添加函数 UPPER 即：

```
A1 = Some Place
B1 = some place 
```

和

```
=EXACT(UPPER(A1),UPPER(B1)) = EXACT(SOME PLACE, SOME PLACE) = TRUE 
```

不带 UPPER

```
=EXACT(A1,B1) = EXACT(Some Place, some place) = FALSE 
```****

# jakarta-ee - 关于开始使用 Enterprise Java Beans 的建议

> ID：15365256
> 
> 赞同：1
> 
> 时间：2013-03-12T15:26:24.630
> 
> 标签：jakarta-ee, ejb, ejb-3.1

由于我在刚开始`EJB`接触技术时遇到了一些问题，这些问题经常导致尴尬和耗时的情况，我正在考虑订购一本专门（或主要）专注于`Enterprise Java Beans`. 我一定想要这本书来处理`CDI`，因为它是该技术最强大的当代方面。你会推荐哪本书，它涵盖了我的最后一个要求，并且不局限于基础知识，而是深入探讨技术的潜力？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:54:20.830

推荐以下2本书：

[EJB 3.1 手册](https://rads.stackoverflow.com/amzn/click/com/1849682380), [Java EE 6 袖珍指南](https://rads.stackoverflow.com/amzn/click/com/144933668X)

我在曼宁看到一本新书，它将于 2013 年夏天到期：

[EJB 3 实战，第二版](http://www.manning.com/panda2/)

# php - 更好的方法 isset($variable) 并检查变量值

> ID：15365261
> 
> 赞同：0
> 
> 时间：2013-03-12T15:26:41.503
> 
> 标签：php

我想知道是否有比我总是做的更好的方法来检查可能未设置的变量的值？例如 ：

```
if(isset($_SESSION['super_user']) && $_SESSION['super_user'] == true) {
  echo 'hi super user';
} 
```

这样做会简单得多：

```
if($_SESSION['super_user']) {
  echo 'hi super user';
} 
```

但我最终会收到未定义索引的通知。有没有另一种方法来做这种简单的验证，或者我必须坚持我的实际做法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:29:18.917

```
if (!empty($_SESSION['super_user'])) {
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:29:25.890

您最初可以设置`$_SESSION['super_user']`为`false`并且仅`true`在用户是*超级用户*时才将其设置为。然后你可以随时使用`if ($_SESSION['super_user']) {}`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:30:44.073

对于特定示例，您当前的代码可以缩短为

```
if(!empty($_SESSION['super_user'])) 
```

但是，正确的方法是

```
if ($_SESSION['role'] == 'super_user') 
```

> 我想知道是否有比我总是做的更好的方法来检查可能未设置的变量的值？

是的。始终定义所有变量。就像我在上面发布的一样。始终`role`为所有用户提供一个元素，无需检查它是否存在。

# php - SQL : 从关注者中选择所有帖子

> ID：15365265
> 
> 赞同：2
> 
> 时间：2013-03-12T15:26:49.910
> 
> 标签：php, sql, pdo, mysqli

我试图找到一种有效的方法来显示登录帐户持有人正在关注的人的所有帖子。

有两个关键表：

1-帖子

表名：`posts`

`id`, `account_name`,`published, body`

2-关注

表名：`follows`

`id`, `account_name`,`followed_name`

**我正在尝试找到一种方法来显示所有正在关注的帐户中的所有帖子。**Posts 和 Follows 之间的联系是`Account_name`.

我知道它可能是一个连接，但这是我构造`WHERE`子句的方式。到目前为止，我有以下内容（帐户名称是通过 $_SESSION['account_name'] 设置的）：

```
$sql = "SELECT * FROM posts LEFT JOIN follows ON posts.account_name = follows.account_name WHERE  --- How would I only get the posts from the accounts being followed ?---" 
```

我确定这很简单，我的大脑只是感觉筋疲力尽，我似乎无法解决。

**在 PDO 中尝试更新**

目前返回NULL，

```
$sql = "SELECT * FROM share_posts WHERE account_name IN (SELECT followed_name FROM $this->account_follows WHERE account_name = :account_name)";
    return $this->AC->Database->select($sql, array('account_name' => $account_name)); 
```

转到我的数据库类：

```
 public function select($sql, $array = array(), $fetch_mode = PDO::FETCH_ASSOC)
    {

        $stmt = $this->AC->PDO->prepare($sql);

        foreach ($array as $key => $value) 
        {
            $stmt->bindValue("$key", $value);
        }

        $stmt->execute();

        return $stmt->fetchALL($fetch_mode);

    } 
```

即使登录的账户已经关注了其他账户，返回的数据目前为 NULL。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T15:32:18.720

```
$account = $_SESSION['account_name'];

//do some sql injection checking on $account here

$sql = "SELECT * FROM posts WHERE account_name IN (SELECT followed_name FROM follows WHERE account_name='".$account."')"; 
```

这将获得帐户名称与您关注的人匹配的所有帖子。我不确定谁在关注谁，但在这种情况下，followed_name 是 account_name 关注的人。如果情况相反，请切换值

```
$sql = "SELECT * FROM posts WHERE account_name IN (SELECT account_name FROM follows WHERE followed_name='".$account."')"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:33:06.100

我会按照我解释你的问题的方式写这个。

您需要做的是仅从您的登录用户所关注的用户中选择帖子。

要打破这一点，首先您要选择用户，然后是登录用户。为此，我们使用 Follows 表。

然后我们要选择这些用户的帖子。因此，我的查询将是这样的。

```
SELECT posts.* FROM follows
    LEFT JOIN posts ON posts.account_name = follows.follows_name
    WHERE follows.account_name = $logged_in_user 
```

# json - 读取 JSON 编码的数组形式 cakePHP 视图控制器

> ID：15365267
> 
> 赞同：0
> 
> 时间：2013-03-12T15:26:54.047
> 
> 标签：json, cakephp

您好，我有一个 JQuery/Ajax 函数，如下所示：

```
$.ajax({
    type : "POST",
    url  : "/posts/getids", 
    success: function(response){
        console.log(response);                                                                  
    },
    error: function() {
        alert('An unexpected error has occurred! Please try later.');
    }
}); 
```

在我的 cakePHP 脚本中，我使用 json_encode($array) 函数发送一个数组。

在萤火虫我得到这个结果：

```
[{"Post":{"id":1}},{"Post":{"id":2}},{"Post":{"id":4}},{"Post":{"id":3}}] 
```

所以我的问题是我怎样才能简单地打印这样的ID：1、2、3、4

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T17:45:39.627

```
// Convert JSON to JavaScript array.
var dataFromServer = JSON.parse(response);

// Creating an array of id's.
var idArray = [];

// Moving data to "idArray".
for(i = 0; i < dataFromServer.length; i++){
    idArray[i] = dataFromServer[i].Post.id;
}

// Checking the result.
console.log(idArray);

// [1, 2, 3, 4]. 
```

# python - color 在矩阵 matplotlib 上绘制不同的颜色

> ID：15365268
> 
> 赞同：0
> 
> 时间：2013-03-12T15:26:54.997
> 
> 标签：python, colors, matplotlib

![我创建的矩阵](../Images/7ef71819cb5bda8a405172cef545ea11.png)

我有一个矩阵，我使用 matplotlib 在 matplotlib 中绘制`self.ax.imshow(arr,cmap=plt.cm.Greys_r, interpolation = 'none')`如您所见，这些图都是相同的颜色。我怎样才能使情节，不同的颜色，而不仅仅是黑色

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:27:26.817

颜色图的正确链接是：[http](http://www.loria.fr/~rougier/teaching/matplotlib/#colormaps) ://www.loria.fr/~rougier/teaching/matplotlib/#colormaps 您可以像这样分配弹簧颜色图：

`self.ax.imshow(arr, cmap = plt.cm.spring, interpolation = 'none')`.

@tcaswell 当然是正确的，如果您的数据是二进制的，那么颜色也将是二进制的。颜色图为不同的 z 值提供不同的颜色。如果你想给右下部分与左下部分（或其他）不同的颜色，你需要一个不同的解决方案。我猜是带有散点图的东西。

# mysql - INSERT...SELECT FROM Mysql 语句错误

> ID：15365272
> 
> 赞同：-2
> 
> 时间：2013-03-12T15:27:04.157
> 
> 标签：mysql, sql, sql-insert

我有一个表中具有 id 的项目列表，我想将它们放入 item_to_group 表中，所有表都具有特定的组号。

我的 MySQL 代码是：

```
INSERT INTO `item_to_item_group` (`items`.`id`, 3476)
SELECT `id`
FROM `items` 
```

但是我收到了旧的“您的 SQL 语法有错误”消息。任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:27:49.120

不，它应该是列名而不是值，

```
INSERT  INTO item_to_item_group (id, columnameHere) -- <== define columnName here
SELECT  id, 3476
FROM    items 
```

# python - python中的for循环在每次迭代时初始化一个外部变量

> ID：15365273
> 
> 赞同：2
> 
> 时间：2013-03-12T15:27:05.240
> 
> 标签：python, for-loop, dictionary

我不明白为什么以下代码会给出不同的结果：

```
from datetime import datetime

def foo():
    return {datetime.now() : True}

a = {}
a.update(foo())
a.update(foo())
a.update(foo()) 
```

和：

```
a = {}
for i in xrange(3):
    a.update(foo()) 
```

前者`a`以三个元素结束，而后者`a`只以一个元素结束（来自上一次迭代）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:31:40.230

只是你的运气。第二个代码可能在一毫秒（或微秒，取决于您的操作系统）内执行，并给出三个相同的日期时间，第一个不太可能这样做（在您的系统/您执行代码的方式上）。继续尝试，你可能会得到两个元素。不要编写依赖于运气的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:32:14.240

最终得到的元素数量取决于`foo`在`datetime.now()`.

如果您在交互式控制台中运行它，那么在提示符处执行的语句之间，控制台将执行内务处理（例如，显示`>>>`提示符），这将显着延迟下一条语句，而对于`for`循环，循环将完整执行在控制台做任何事情之前。

# javascript - TD 作为 CKEditor 内联实例

> ID：15365275
> 
> 赞同：1
> 
> 时间：2013-03-12T15:27:06.943
> 
> 标签：javascript, ckeditor

是否可以使用 CKEditor 内联编辑 TD 标签的内容？

我写了代码：

```
<div contenteditable="true">
    this content IS editable
</div>

<table>
    <tr>
        <td contenteditable="true"> not IS NOT editable </td>
        <td contenteditable="true"> not IS NOT editable </td>
    </tr>
</table> 
```

测试：http: [//jsfiddle.net/martinba/JBFmd/1/](http://jsfiddle.net/martinba/JBFmd/1/)

我找不到它是错误还是功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T18:21:08.090

检查我的答案[Enable CKEditor4 inline on span and other inline tags](https://stackoverflow.com/questions/14575036/enable-ckeditor4-inline-on-span-and-other-inline-tags/14579281#14579281)。这是相同的情况 - CKEditor 不支持在 上对其进行初始化`td`。您可以尝试像 BenO 在此答案中所做的那样破解编辑器[Enable CKEditor4 inline on span 和其他内联标签](https://stackoverflow.com/questions/14575036/enable-ckeditor4-inline-on-span-and-other-inline-tags/15014459#15014459)，但结果是不可预测的。

# phpunit - 当我在布局中使用自定义视图助手时单元测试失败

> ID：15365278
> 
> 赞同：1
> 
> 时间：2013-03-12T15:27:21.190
> 
> 标签：phpunit, zend-framework2

所以我创建了我的自定义视图助手并在 layout.phtml 中使用它，如下所示：

```
<?php echo $this->applicationBar(); ?> 
```

它在浏览器中完美运行，但我之前运行的单元测试现在失败了：

```
1) UnitTests\Application\Controller\IndexControllerTest::testIndexActionCanBeAccessed
Zend\ServiceManager\Exception\ServiceNotFoundException: Zend\ServiceManager\ServiceManager::get was unable to fetch or create an instance for applicationBar 
```

当我在布局文件中注释掉视图助手时，测试再次通过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-12T20:51:33.050

我有同样的问题，我以不好的方式解决了它（但它解决了我的具体问题）。

phpunit 测试没有找到我的工厂视图助手，但它正在找到我的可调用对象。然后，我做了以下事情：

```
public function getViewHelperConfig() {
    return array(
        'factories' => array(
            'aplicationBar' => function($service) {
                $applicationBar = new ApplicationBar();
                return $applicationBar;
            },
        ),
        'invokables' => array(
            'applicationBar' => 'Application\View\Helper\ApplicationBar',
        ),
    ); 
```

当我使用浏览器时，它使用正确的工厂。当我使用 phpunit 时，它使用可调用对象。

当我需要设置一些参数时，就会出现问题。然后，我设置了一些默认参数，这些参数仅供 phpunit 使用。

```
namespace Application\View\Helper;

use Zend\View\Helper\AbstractHelper;

class ApplicationBar extends AbstractHelper {

    protected $parameter;

    public function __construct($parameter = 'something') {
        $this->parameter = $parameter;
    }

    public function __invoke() {
        return $this->parameter;
    }

} 
```

这不是最好的解决方案，但如果我以更好的方式解决它，我会在这里发布。

# sql-server - Win Form 应用程序每天都会运行一个方法，即使它没有运行

> ID：15365280
> 
> 赞同：1
> 
> 时间：2013-03-12T15:27:22.650
> 
> 标签：sql-server, vb.net, winforms

我有一个带有 MS SQL 服务器的 VB .Net Windows Form 应用程序作为数据库的一部分。我需要运行一种方法，该方法基本上取决于数据库中的某些日期敏感数据，可能会或可能不会创建要发送给一个或多个收件人的通知电子邮件。此应用程序可能不会每天使用。所以理想情况下，我不希望该方法被绑定到主表单的表单加载。如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:30:24.010

您可能不希望在您的客户端应用程序中使用该逻辑。想到了三种方法：

1.  将逻辑放入 SQL Server 并创建一个计划每天运行的作业
2.  创建一个小型实用应用程序并将其安排为每天一次
3.  创建一个始终运行并为您处理这些作业的 Windows 服务

如果确定是否发送通知电子邮件所需的所有数据都在数据库中可用，并且您有权在 SQL 服务器上创建作业，我会推荐该路线。

但是，如果您需要外部组件来进行确定或发送电子邮件，那么方法 2 或 3 将是可行的方法。创建一个应用程序并安排它每天运行会更容易实现，但服务的好处是不需要交互式登录会话（即不需要用户主动登录计算机），这在服务器。

# iphone - 为布局约束添加优先级

> ID：15365286
> 
> 赞同：16
> 
> 时间：2013-03-12T15:27:44.587
> 
> 标签：iphone, ios, objective-c, autolayout

我有一个这样`label`的。`button``superView`

```
|--------------[Label]-----[button]-| 
```

如果可能的话，我希望`label`有`centred`一个最小的间隙，然后`button`向左移动。

所以如果按钮很大，它看起来像......

```
|-[        LABEL!        ]-[button]-| 
```

因此，按钮保持在原来的位置并保持相同的大小。元素之间的间隙最小。

我可以添加`centerX`约束，但我似乎无法赋予它优先级，所以它仍然存在`Required`。

我怎样才能创造这种情况？我正在代码中进行所有自动布局。

我目前的限制是......

```
[self addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"|-[_label]-(>=8@1000)-[_button(==45)]-|"
                                                             options:NSLayoutFormatAlignAllCenterY
                                                             metrics:nil
                                                               views:views]];

[self addConstraint:[NSLayoutConstraint constraintWithItem:_label
                                                 attribute:NSLayoutAttributeCenterX
                                                 relatedBy:NSLayoutRelationEqual
                                                    toItem:self.contentView
                                                 attribute:NSLayoutAttributeCenterX
                                                multiplier:1.0
                                                  constant:0.0]]; 
```

但我不确定如何降低第二个约束的优先级。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-12T15:33:11.093

您只需设置`priority`约束的属性，如下所示：

```
NSLayoutConstraint *centeringConstraint = 
    [NSLayoutConstraint constraintWithItem:_label
                                 attribute:NSLayoutAttributeCenterX
                                 relatedBy:NSLayoutRelationEqual
                                    toItem:self.contentView
                                 attribute:NSLayoutAttributeCenterX
                                multiplier:1.0
                                  constant:0.0];

centeringConstraint.priority = 800; // <-- this line

[self addConstraint:centeringConstraint]; 
```

# combobox - extjs4 组合框中继值

> ID：15365290
> 
> 赞同：1
> 
> 时间：2013-03-12T15:27:50.387
> 
> 标签：combobox, extjs4.1

我在表单中有一个组合框，valueField 是 mongodb 中文档的 ObjectId 字段，它显示组合框中字段的正确值，但它只用 getValue 返回值的一部分，getRawValue 返回的值显示字段。这是组合框的代码：

```
{
        xtype: 'combo',
        fieldLabel:'Firm',
        store:Ext.data.StoreManager.lookup('bbCompaniesStore'),
        displayField: 'firm',
        valueField: '_id',
        name: 'country',
        labelAlign: 'top',
        cls: 'field-margin',
        flex: 1
    } 
```

这就是我从表单中获取值的方式：

```
var nomeField = formPanel.items.get(0).items.get(0);
var firmField = formPanel.items.get(0).items.get(1);
var noteField = formPanel.items.get(0).items.get(2);
var contact = Ext.ModelManager.create({nome: nomeField.getValue(), note: noteField.getValue(),'firm_id':firmField.getValue()}, 'Contact'); 
```

它可以工作，但它会中继_id的值，我用firebug检查过，服务器发送了正确的数据，我认为extjs做了某种规范化，在我使用getRawValue解决之前，但使用组合框它返回displayField。我不知道如何解决这个问题。

# azure - 表存储服务（Azure 的 nosql 实现）与 Windows Azure 缓存（非结构化内存缓存）

> ID：15365293
> 
> 赞同：4
> 
> 时间：2013-03-12T15:27:59.567
> 
> 标签：azure, nosql, azure-caching, azure-cdn

我们想在 Azure 中实现缓存有两个主要原因：

1.  加快重复数据访问
2.  减轻数据库压力

以下是我们计划缓存的数据的特征：

1.  相对较小（1 - 100 kb）
2.  针对每个客户
3.  不是私人的，但我们真的不希望随机的人浏览我们的整个缓存
4.  XML 或 JSON
5.  由 C# 使用（即不直接在 html 中链接）
6.  大多数星期数据不会改变，尽管有些日子数据可能会改变几次

对于这个特定目的，[表存储](http://www.windowsazure.com/en-us/develop/net/how-to-guides/table-services/)似乎比 Blob 存储更好（我们只是为图像、CSS 和 JavaScript 实现了 Blob 存储）并且[Windows Azure 缓存](https://www.windowsazure.com/en-us/develop/net/how-to-guides/cache/)似乎比 Windows Azure 共享缓存更好（也许几乎[总是更好](http://blogs.msdn.com/b/avkashchauhan/archive/2012/06/18/difference-between-windows-azure-cache-preview-and-windows-azure-share-cache.aspx)，并且共享缓存[主要是遗留的此时的功能](http://blogs.msdn.com/b/windowsazure/archive/2012/06/25/cloud-services-series-what-s-new-in-windows-azure-caching.aspx)）。

两者的编程 API 看起来很简单。与我们为云站点支付的费用相比，每个站点的成本似乎可以忽略不计。

到目前为止，由于我们认为 Azure 缓存的优缺点，我们倾向于表存储。作为老 .Net 人，我们对内存缓存比 NoSql 风格的解决方案更熟悉：

Windows Azure 缓存的问题：

1.  如果将 VM 移动到不同的服务器（由 Microsoft 出于负载平衡或其他原因），内存中的缓存是否会原封不动地移动？
2.  我们猜测，每当我们将更改发布到云时，它都会清除现有的内存缓存
3.  虽然用户在进行更改时很少对缓存数据进行更改，但他们可能会在几秒钟内进行多次更新，我们不确定这将如何处理位于运行 Web 角色的多个节点的缓存，尤其是在流量增加的情况下. （这可能也是表存储的一个问题！）
4.  表存储看起来更容易调试

Windows Azure 缓存的优势

1.  快一些

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T16:10:53.390

您对内存缓存的熟悉程度是您在 Windows Azure 上实现缓存所需了解的模型。“NoSql 风格”不是缓存，而是存储。因此，表存储代替了 SQL，而不是代替了缓存。表存储用于持久、可靠的存储——具有内存缓存不存在的所有延迟和其他持久性缺点。

写入缓存始终是次要的。当您的用户“对缓存数据进行更改”时，您将始终将数据写入磁盘（例如 SQL），然后将相同的数据写入缓存，因为您也可以这样做，因为您手头有数据（尽管对写入数据的次要影响可能意味着您应该使缓存项无效或重新读取）。

机器回收时清除数据应该不是什么大问题，因为数据存储在其他地方。每次从缓存中读取都应该跟一个“如果未找到则从数据库中读取”类型的语句。当角色开始预填充您知道将需要的项目时，您可以预热缓存。

Azure 上的缓存分布在节点上，更新现有项目将始终在它所在的节点上更新。快速更新可能没有您想象的那么严重。

对于内存缓存，请使用 Windows Azure 缓存（您说得对，共享缓存是遗留的），并且根据您的需要，查看其他缓存技术，例如 memcached。缓存和表存储没有可比性。表存储是为了长期持久化。不要不必要地破解表存储来进行缓存——使表存储成为临时存储会产生一大堆你需要自己担心的事情，比如过期和失效。

# eclipse - 热代码替换失败 - @Entity 类上的层次结构更改未实现

> ID：15365294
> 
> 赞同：3
> 
> 时间：2013-03-12T15:28:01.763
> 
> 标签：eclipse, glassfish, jvm, java

获取此特定错误消息

“热代码替换失败 - 未实现层次结构更改”

尝试更改现有*方法主体*时。

通常更改方法体有效 - 但在 JPA`@Entity`类中的方法体上经常中断。知道有什么问题吗？

环境：Glassfish 3.1.2.2、Eclipse Juno、JDK 1.6

与 DCEVM 没有区别

# android - 将数据插入 SQLite 数据库

> ID：15365297
> 
> 赞同：1
> 
> 时间：2013-03-12T15:28:02.657
> 
> 标签：android

当我将数据插入数据库时​​，它在模拟器上运行良好。但是当我使用真实设备插入它时，我得到了一个错误。我的示例代码是：

在按钮单击事件上：

```
btn_subcat_save.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        String subcat_name = ed_subcat_name.getText().toString();
        if (subcat_name.trim().length() == 0 || image_add.getTag() == d) {
            showDialog(0);
        } else {
            long subcat_idauto = db_add_subcat.insertSubCategory(
                        subcat_name, id, bmp_default);
                Toast.makeText(getBaseContext(), "Sub category added",
                        Toast.LENGTH_SHORT).show();
                Log.e("Id", ""+id);
            if (subcat_idauto != -1) {
                finish();
            }
        }
    }
}); 
```

在重新启动之前的活动时，应显示插入的数据。所以我写了，

```
protected void onRestart() {
    super.onRestart();

    custom_adapter.clear();
    if (custom_adapter.isEmpty()) {
        custom_adapter.notifyDataSetChanged();
    }
    checkMyReceipe();
} 
```

# sql-server - 更正 SQL 语法以检查更新过程中是否存在空值

> ID：15365298
> 
> 赞同：0
> 
> 时间：2013-03-12T15:28:03.213
> 
> 标签：sql-server, tsql

我有一个表格，其中包含有关联系人帐户余额的信息。它包含用于跟踪他们曾经拥有的第一张发票的日期、他们拥有的最后一张发票的日期以及当前余额的列。

在创建每张新发票时，打算通过一个简单的存储过程更新此表，如下所示：

```
CREATE PROCEDURE UpdateContactFinancialInformation
   @ContactId int,
   @InvoiceDate date,
   @Amount money
AS
   UPDATE Contacts.ContactsFinancialInformation
   SET LastInvoiceDate = @InvoiceDate,
       CurrentBalance = CurrentBalance + @Amount
   WHERE ContactId = @ContactId 
```

创建新联系人时，会在表中为他们创建默认条目，`ContactsFinancialInformation`并且该`FirstInvoiceDate`列的默认值为`NULL`。

我想在上面的基本 SQL 语句中添加一个检查，以便如果该`FirstInvoiceDate`列为 NULL，它也设置`@InvoiceDate`正在传递到存储过程的参数。

请问最有效的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:33:18.243

你的意思是

FirstInvoiceDate = COALESCE(FirstInvoiceDate, InvoiceDate)

coalesce 返回第一个不为空的值，因此如果它不为空，它将使用它已经存在的相同值进行更新

编辑：我不完全知道你有哪个 SQL，它并不总是合并

DB2，SQL 女士：COALESCE

MySQL：IFNULL

甲骨文：nvl

只需将我写的行中的 COALESCE 替换为您正在使用的 sql 的正确表达式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:38:28.143

```
UPDATE Contacts.ContactsFinancialInformation

SET LastInvoiceDate = @InvoiceDate,
    FirstInvoiceDate = CASE WHEN FirstInvoiceDate IS NULL THEN @InvoiceDate ELSE FirstInvoiceDate END,

CurrentBalance = CurrentBalance + @Amount

WHERE ContactId = @ContactId 
```

IMO，此解决方案与 COALESCE 相比的唯一优势是代码可读性更高。

# math - 如何将矢量曲线轮廓包络拟合到屏幕外位图？

> ID：15365301
> 
> 赞同：1
> 
> 时间：2013-03-12T15:28:09.833
> 
> 标签：math, drawing, vector-graphics, raster-graphics

我正在编写一个基于矢量的绘图程序，但应该具有更像基于光栅的工具的绘图工具。例如 - 当您使用绘图板笔进行绘图时，产生的矢量笔划，以及压力差和所有内容，实际上是一个填充。矢量曲线恰好适合笔划的外部。此外，如果您拿起橡皮擦并擦除该笔划的一部分，它只会擦除您擦除的确切位置。它不仅会删除矢量点，还会在必须的地方创建新的矢量点。这些笔和橡皮擦的笔触也可以是任何几何形状——不仅在外面有轮廓，而且在中间也有孔。

我对如何做到这一点困惑了很长时间，昨晚我想到了将笔输入绘制到屏幕外位图（其中每个像素都是一位 - 被笔触触摸或未触动），然后当笔触结束（笔被抬起）程序对该位图进行矢量化，然后用适当的颜色放置矢量填充，或者对下面的矢量执行布尔运算以擦除。

我可以使用光栅绘图工具来完成这项工作（这样你就不会一直在可见表面上画线，如果你用透明度绘图，这看起来不太好），但我不知道我会如何适合此一位位图的矢量曲线。操作必须快速但不是实时的，因为它是在抬起笔后完成的。它还必须创建优化的几何图形，以便只使用描述几何图形所需的最小数量的贝塞尔曲线点。

是否有人对如何执行此操作有任何建议、解决方案、指针或参考？或者，还有其他方法吗？

# javascript - ASP.net JavaScript MS Outlook

> ID：15365303
> 
> 赞同：0
> 
> 时间：2013-03-12T15:28:16.067
> 
> 标签：javascript, asp.net

我有一个 javascript 可以打开 MS Outlook 并使用文本框中的 Mailto。我想检查文本框是否为空显示警报“未找到电子邮件地址”，否则继续打开 MS Outlook。如何将此添加到我的 javascript？

```
function TriggerOutlook() {
            var to = document.getElementById("txtEmailAddress").value;
            window.location.href = "mailto:" + to;
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:31:05.407

您可以像这样检查“to”是否为空：

```
function TriggerOutlook() {
    var to = document.getElementById("txtEmailAddress").value;
    if(to=='') {
        alert("Invalid email address");
        return;
    }
    window.location.href = "mailto:" + to;
} 
```

# bash - 为什么在 bash 比较运算符周围添加空格会改变结果？

> ID：15365307
> 
> 赞同：8
> 
> 时间：2013-03-12T15:28:23.963
> 
> 标签：bash

有人可以解释为什么周围`==`的空格会改变比较结果吗？以下：

```
if [[ 1 == 2 ]] ; then echo ok ; fi 
```

什么都不打印，而

```
if [[ 1==2 ]] ; then echo ok ; fi 
```

印刷`ok`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-12T15:33:06.283

"1==2" 是单个 4 字符的字符串，不是涉及`==`运算符的表达式。在条件表达式的上下文中，非空字符串总是计算为真`[[ ... ]]`。运算符周围必须有空格`==`。

与 中的其他所有内容一样`bash`， 的内容`[[ ... ]]`只是一个以空格分隔的参数列表。`bash`语法不知道如何解析条件表达式，但它确实知道如何在复合命令的上下文中解释 3 个参数的列表，如、`1`和`==`。`2``[[ ... ]]`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T15:33:05.730

因为它只是一个字符串，所以考虑测试：

```
[[ foobar ]] 
```

会的`true`。

这对于测试是否设置了变量很有用，如下例所示：

```
x='foobar'
[[ $x ]] # true 
```

现在

```
x=''
[[ $x ]] # false 
```

## 最后

**空格**在测试表达式中是强制性的

# asp.net - SSRS 异常 由于对象的当前状态，操作无效。和 AspNetSessionExpiredException

> ID：15365308
> 
> 赞同：4
> 
> 时间：2013-03-12T15:28:25.197
> 
> 标签：asp.net, reporting-services

在我的 asp.net 应用程序中，当运行具有大量参数的报告时，我有一个连接到 ssrs 端点的报告视图（在参数列表中选择所有选项）我收到以下异常被抛出

```
Operation is not valid due to the current state of the object. 
```

我在这里看到了许多博客以及帖子，其中引用了 MS 应用的安全补丁作为造成此问题的原因，这将您可以在集合中拥有的项目数量限制为 1000。

我还看到了在 web.config 文件中为位于的 wcf 托管服务添加 appSettings 标记`C:\Program Files\Microsoft SQL Server\MSRS10_50.MSSQLSERVER\Reporting Services\ReportServer`并添加以下条目的建议

```
<appSettings>
    <add key="aspnet:MaxHttpCollectionKeys" value="20000" />
  </appSettings> 
```

我试过这个建议没有运气。运行 sql2008r2 的服务器没有提到任何安全更新，并且将 appSettings 值添加到 web.config（用于 ssrs 管理站点或端点的配置）对异常没有任何影响。如果我有超过 20k 的物品，我什至增加了价值（100000）。

我的第二个想法是 wsHttp 请求上的数据包大小可能太大，我也需要增加它。

**更新** 在挖掘了更多之后，我发现我在正确的轨道上。以上是根据 MS 条目[KB2661403](http://support.microsoft.com/kb/2661403)的部分解决方案 MaxCollectionKey 只是条目的一部分。第二部分是参数的序列化，需要将第二个条目添加到 appSettings 部分

```
<add key="aspnet:MaxJsonDeserializerMembers" value="1000" /> 
```

当我开始考虑这个问题时，我在需要输入的地方也是不正确的。它不需要在 SSRS 端点 web.config 上输入，而是在托管报表查看器控件的站点上输入。将这两个条目添加到 web.config 已导致对象成功传递。现在 SSRS 系统正在返回 ASP.NETSessionTimeOut 异常，因此我需要尝试延长此超时时间以查看是否可以在大型查询中取回数据。

有没有人有任何建议或建议？

-干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-18T22:07:49.003

您不能总是重新设计报告——当客户想要时，客户想要。

也就是说，对于越来越多的带有用于级联参数的大型数据集的报告，我们经常遇到这个错误。我们有一些包含多个参数的报告，下拉列表中有超过 1500 个值。上述解决方案对某些人有效，但对其他人无效。就在那时，一位同事（Pranay Papishetty）想出了一个很好的解决方法（我将所有字段名称保留原样，而不是换成通用描述。你应该仍然能够明白这一点）：

修复了 POS_08 的订阅问题：

报告 POS_08 有一个带有标签组织单位的参数：它的下拉值接近 1500。该报告还有几个其他参数，每个参数都有相当多的下拉值，这在报告上设置订阅时会产生问题。对于大量的参数下拉值，即使对报表服务器进行了一些架构更改，问题也没有得到解决。

我在数据集中提出了一种参数屏蔽。通常要将组织单位传递给主数据集查询，我们在 where 子句的主查询中使用以下过滤器

```
dbo.vw_orgunit.orgunit in @orgunit 
```

（@OrgUnit 是将组织单位传递给查询的参数。）

我没有对组织单位使用上述过滤器，而是使用了如下修改的过滤器：

```
((dbo.vw_orgunit.Orgunit IN ((SELECT item
FROM   [DW_Master].[dbo].fn_Split (@orgunit_d, ','))))
OR (@orgunit_d) IN ('All Org Units')) 
```

参数Organization Unit对应的数据集也修改如下，在下拉值中添加值“All Org Units”。

```
 SELECT DISTINCT 
       [OrgUnit] AS [OrgUnit_Code], 
       [OrgUnitDescription] AS [OrgUnit_Desc], 
       ([OrgUnit] + ' - ' + [OrgUnitDescription]) AS [OrgUnit_Label]
FROM dbo.vw_DimOrgUnit
WHERE (
        [OrgLevelAgency] = '73' 
        AND [OrgLevelFiscalYear] IN ( @FiscalYear )
        AND ([OrgLevel_1] + ' - ' + [OrgLevel_1_Description]) IN ( @OrgLevel_1_Label )
        AND ([OrgLevel_2] + ' - ' + [OrgLevel_2_Description]) IN ( @OrgLevel_2_Label )
        AND ([OrgLevel_3] + ' - ' + [OrgLevel_3_Description]) IN ( @OrgLevel_3_Label )
      ) OR [OrgUnitSKey] = '-1' OR ( [OrgUnit] = '5117' AND [OrgUnitFiscalYear] = '2013' /* A Special Case*/ )

UNION
SELECT '' , '', '(Blank)'
UNION
SELECT 'none' , 'none', 'None'
UNION 
SELECT '-100','All Org Units','All Org Units'
ORDER BY [OrgUnit]
; 
```

这样，当用户想要选择所有组织单位时，他们只需选择“所有组织单位”，而不是选择整个下拉值并将其传递给查询。这减少了报告的执行时间并提高了查询的性能。实施所有更改后，订阅也成功设置。

# gwt - GWT 序列化错误

> ID：15365314
> 
> 赞同：3
> 
> 时间：2013-03-12T15:28:37.677
> 
> 标签：gwt, serialization

在我的应用程序中，我在重新加载某些页面时遇到了问题。错误是：

```
com.google.gwt.user.client.rpc.SerializationException: java.lang.RuntimeException: Unable to find class com.google.gwt.user.client.rpc.core.java.lang.Long_FieldSerializer 
```

我已经下载了gwt源，发现错误是由这一行引起的：

```
Class<?> klass = ReflectionHelper.loadClass(typeHandlerClass); 
```

在文件中`com/google/gwt/user/client/rpc/impl/SerializerBase.java`

当我们导航到带有超链接的页面或手动输入 url 时，一切正常，上面的代码正在运行，类已加载。但是当我们在某些页面上按 F5 按钮时，就会出现异常。

# xml - 将非规范化数据从 excel 导出到 xml

> ID：15365320
> 
> 赞同：5
> 
> 时间：2013-03-12T15:28:58.437
> 
> 标签：xml, excel, xsd, denormalized

我们正在尝试将带有“非规范化数据”的 excel 表导出到 xml。表头如下：

```
| AssetManager Code | AssetManager Date | Portfolio Code | Portfolio Name | MarketValue | NetCashFlow | Field | Field Code | Field Name | 
```

AssetManager 代码和 AssetManager 日期始终相同，其余列包含可变数据。

这是我们想要的 xml 输出的示例：

```
<AssetManager Code="PFM" Date="20130117">                   
    <Portfolios>            
        <Portfolio Code="CC PSP" Name="Consilium Capital">      
            <MarketValue>5548056.51</MarketValue>   
            <NetCashFlow>0</NetCashFlow>    
            <UserFields>    
                <Field Code="AM UCGT" Name="AM daily Unrealised CG">4375</Field>
            </UserFields>   
        </Portfolio>        
        <Portfolio Code="MM (FC)" Name="Money Market UT (FC)">      
            <MarketValue>28975149.6500735</MarketValue> 
            <NetCashFlow>0</NetCashFlow>    
            <UserFields>    
                <Field Code="UCGT" Name="AM daily Unrealised CG">0</Field>
            </UserFields>   
        </Portfolio>        
    </Portfolios>           
</AssetManager> 
```

我们的 xsd 文件包含映射：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="AssetManager">
    <xs:complexType>
        <xs:sequence>
                    <xs:element ref="Portfolios" />
            </xs:sequence>
        <xs:attribute name="Code" type="xs:string"/>
            <xs:attribute name="Date" type="xs:string"/>
    </xs:complexType>
</xs:element>
<xs:complexType name="FieldType">
    <xs:simpleContent>
        <xs:extension base="xs:decimal">
            <xs:attribute name="Code" type="xs:string"/>
                <xs:attribute name="Name" type="xs:string"/>
        </xs:extension>
    </xs:simpleContent>
</xs:complexType>
<xs:element name="Portfolios">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="Portfolio">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="MarketValue" type="xs:decimal"/>
        <xs:element name="NetCashFlow" type="xs:decimal"/>
        <xs:element name="UserFields">
          <xs:complexType>
            <xs:sequence>
                    <xs:element name="Field" type="FieldType"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="Code" type="xs:string"/>
      <xs:attribute name="Name" type="xs:string"/>
    </xs:complexType>
              </xs:element>
            </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

至少我们想知道为什么 excel 认为数据是非规范化的？

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T16:44:46.687

首先，您发布的 XSD 有问题。投资组合应将 maxOccurs 设置为大于 1 的值 - 否则您与示例 XML 不匹配，并且在 Excel 中验证地图时不会出现“非规范化数据”错误。

[本文](https://support.office.com/en-us/article/Import-XML-data-6eca3906-d6c9-4f0d-b911-c736da817fa4)应解释您使用 Excel 地图时遇到的常见错误 - 包括您的错误。

我猜你所做的是拖放根 - 这不适用于重复元素。

您可以解决我在下面所做的事情；它可能不适用于您的具体示例，但它应该给您一个想法。

修改了 XSD 以考虑重复粒子：

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- XML Schema generated by QTAssistant/XSD Module (http://www.paschidev.com) -->
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <xs:element name="AssetManager">
        <xs:complexType>
            <xs:sequence>
                <xs:element ref="Portfolios"/>
            </xs:sequence>
            <xs:attribute name="Code" type="xs:string"/>
            <xs:attribute name="Date" type="xs:string"/>
        </xs:complexType>
    </xs:element>
    <xs:complexType name="FieldType">
        <xs:simpleContent>
            <xs:extension base="xs:decimal">
                <xs:attribute name="Code" type="xs:string"/>
                <xs:attribute name="Name" type="xs:string"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
    <xs:element name="Portfolios">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="Portfolio" minOccurs="0" maxOccurs="unbounded">
                    <xs:complexType>
                        <xs:sequence>
                            <xs:element name="MarketValue" type="xs:decimal"/>
                            <xs:element name="NetCashFlow" type="xs:decimal"/>
                            <xs:element name="UserFields">
                                <xs:complexType>
                                    <xs:sequence>
                                        <xs:element name="Field" type="FieldType"/>
                                    </xs:sequence>
                                </xs:complexType>
                            </xs:element>
                        </xs:sequence>
                        <xs:attribute name="Code" type="xs:string"/>
                        <xs:attribute name="Name" type="xs:string"/>
                    </xs:complexType>
                </xs:element>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

仅在第一张纸上拖动代码和日期；如果需要，将其重命名为其他名称。

![在此处输入图像描述](../Images/6d71f68b3af69ad0b1e7c67a765b2f33.png)

将投资组合拖到另一个工作表。

![在此处输入图像描述](../Images/605394cf7b783ba077302a5d635d8835.png)

填写一些数据并导出；这就是我得到的：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<AssetManager Code="a" Date="b">
    <Portfolios>
        <Portfolio Code="aa" Name="bb">
            <MarketValue>10</MarketValue>
            <NetCashFlow>100</NetCashFlow>
            <UserFields>
                <Field/>
            </UserFields>
        </Portfolio>
        <Portfolio Code="aa" Name="bb">
            <MarketValue>10</MarketValue>
            <NetCashFlow>100</NetCashFlow>
            <UserFields>
                <Field/>
            </UserFields>
        </Portfolio>
    </Portfolios>
</AssetManager> 
```

它看起来很接近。如果不是解决方案本身，它应该可以帮助您前进，然后是您的调查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T13:48:35.330

我编写了一些代码来将数据透视表写入原始 XML 格式。在这里，我没有遵循任何预设模式，只是将数据透视表层次结构写入 XML。为此，您必须使用大纲形式但不紧凑（每个新级别都应该开始一个新列）。此外，代码不需要小计或总计，并且只需要数据字段中的一级数字数据。

您的 PT 将采用可接受的 XML 格式，其中节点根据 PT 标题命名，但子组标题作为属性出现，无济于事，名称为“name =”。因此，您会得到类似于“此处的文件夹内容”的 XML。

请参阅下面的代码：另一个警告，这还没有很好地清理。有些行永远不会受到旧代码实现的影响。此外，在调试结束前会有一个停止 - 以防您需要更改输出并重做文件写入步骤。输出被写入 C: 驱动器中名为“txt.txt”的文本文件。

根据需要编辑和重复使用。

```
Private Sub XMLWriter()
Dim sht As Worksheet: Set sht = ActiveSheet
    'Debug.Print "The current Sheet is " & sht.Name
Dim pt As PivotTable: Set pt = sht.PivotTables(1)
    'Debug.Print "Pivot Table name is " & pt.Name
Dim begin As String: begin = pt.TableRange1.Cells(1, 1).Address

Dim rows As Integer: rows = pt.TableRange1.rows.Count
Dim LastCell As Range: Set LastCell = pt.TableRange1.Cells(rows, 1)

 If LastCell.PivotCell.PivotCellType = xlPivotCellGrandTotal Then Set LastCell = LastCell.Offset(-1, 0)
 If LastCell.PivotCell.PivotCellType = xlPivotCellSubtotal Then Stop 'not implemented routine does not expect subtotals in rows - (will not create good xml)

Dim LastRow As Integer: LastRow = LastCell.Row

Dim celly As Range: Set celly = sht.Range(begin)
Dim level As Integer: level = 1
Dim levels As Integer: levels = 0 ' PRECEEDING CODE INITIALIZED VARIABLES - Depends on Pivot table in active worksheet (first on sheet, assumes only one on sheet)

Do 'determines nesting depth
    If celly.Offset(0, levels + 1).Value = "" Then
        levels = levels + 1
        Exit Do
    Else: levels = levels + 1
    End If
Loop
'Stop
Dim dataFieldPresent As Boolean
Dim ShutDown As Boolean
If celly.Offset(levels - 1, levels - 1).PivotCell.PivotCellType = xlPivotCellValue Then
levels = levels - 1
dataFieldPresent = True
End If
'Stop

Dim ary() As String ' initializes array
ReDim ary(1 To levels, 7) As String ' based on nesting depth, seven placeholders set to accomadate data
Dim n As Integer
For n = LBound(ary) To UBound(ary)      ' populates 'folder' names from pivottable headings
    ary(n, 0) = celly.Offset(0, n - 1).Value  ' 0 based folder holds name, or already completed xml group's string/data
    ary(n, 1) = gettabs(n) & Cap(ary(n, 0))          ' 1 based folder holds node's'front cap' following xml syntax
    ary(n, 2) = Cap("/" & ary(n, 0)) & vbCrLf   ' 2 based folder holds 'end cap' to close node
    ary(n, 0) = ""
Next

Set celly = celly.Offset(1, 0)
If celly.Value = "" Then Stop ' error occurred, there must be a cell in first column position at first row under Row Heading

ary(level, 3) = nameElement(celly.Value) & vbCrLf ' get value in current cell to name folder   'ary(level, 4) = nameElement("/" & celly.Value) ' level 4 was created for old implementation, no longer used

Dim tabs As String
'Stop
'tabs = gettabs(level)
ary(level, 6) = ary(level, 2) & vbCrLf
ary(level, 5) = ary(level, 1) & ary(level, 3) & vbCrLf

Dim lvlref As Integer: lvlref = 1
Dim addcrlf As String: addcrlf = vbCrLf

Do
    Set celly = celly.Offset(1, -(celly.Column - 1))
'    If celly.Row = 780 Then Stop

    If celly.Row = LastRow Then ShutDown = True

    If celly.Value = "Liabilities" Then Stop
    If Not celly.Value = "" Then
        closetoplevel
        level = 1
        ary = levelup(ary, level, lvlref, levels)
            ary(level, 3) = nameElement(celly.Value) & vbCrLf
 '           ary(level, 4) = nameElement("/" & celly.Value)
            ary(level, 5) = ary(level, 5) & gettabs(level) & ary(level, 3)
            ary(level, 6) = ary(level, 3)
            ary(level, 7) = celly.Value
        writeout ary(1, 0)
'        Stop
    Else
        level = 2
        Do
            Set celly = celly.Offset(0, 1)
             On Error GoTo Term:
             Nam = celly.PivotCell.PivotCellType ' error trap - should always be in pivot table
            On Error GoTo 0
            If celly.Value = "" Then
                level = level + 1
            Else
                Exit Do
            End If
        Loop

        getPosition (celly.Cells(1))

'        If level = lvlref And level > 2 Then Stop ' update: seems to work fine after refactoring code originally ('not implemented - code does not expect given schema structure"
        If level < lvlref Then
            'Stop
            ary = levelup(ary, level, lvlref, levels)
            'getPosition (celly.Cells(1))
            'Stop
            lvlref = level - 1
            GoTo ReInsertionPoint:

        Else

ReInsertionPoint:

            If level = levels Then
                addcrlf = ""
            Else: addcrlf = vbCrLf
            End If

            ary(level, 3) = nameElement(celly.Value) & addcrlf
            If level = levels And dataFieldPresent = True Then
'                Stop
                ary(level, 3) = ary(level, 3) & CStr(celly.Offset(0, 1).Value)
            End If
            ary(level, 5) = ary(level, 5) & ary(level, 3)
            ary(level, 6) = ary(level, 3)
            ary(level, 7) = celly.Value

         If level = levels Then ' XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  not operating properly failing to add last item (number & accoiunt) of each section
'            Stop

                Dim nextlevel As Integer: nextlevel = 1
                'Stop
                Dim nextlvlcell As Range: Set nextlvlcell = celly.Offset(1, -(level - 1))
                Debug.Print nextlvlcell.Address
                Do
                    If nextlvlcell.Value = "" Then
                        If nextlvlcell.Row > LastRow Then
                            nextlevel = 1
                            GoTo Closure:
                        Else
                            Set nextlvlcell = nextlvlcell.Offset(0, 1)
                            nextlevel = nextlevel + 1
                        End If
                    Else: Exit Do
                    End If
                Loop
                Debug.Print nextlvlcell.Address
                If level - nextlevel > 1 Then
Closure:
                    'Stop
                    ary = pushup(ary(), level, levels, lvlref)
                    'Stop
                    ary = levelup(ary(), level - 1, levels, lvlref)
                Else

                    ary = pushup(ary, level, levels, lvlref)
                End If
            End If

        'Stop

        End If
    End If
lvlref = level
If ShutDown = True Then
    level = 1
    ary = levelup(ary, level, lvlref, levels)
    Exit Do
End If
Loop

writeout "<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?>" & vbCrLf & "<Root xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"">" & vbCrLf & ary(1, 0) & "</Root>"

Stop
End
Term:
Stop

writeout "<?xml version=""1.0"" encoding=""UTF-8"" standalone=""yes""?>" & vbCrLf & "<Root xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"">" & vbCrLf & "<xmldoc>" & vbCrLf & ary(1, 0) & "</xmldoc>" & vbCrLf & "</Root>"
'writeout (ary(1, 0))
Stop
Exit Sub
'created by derik bingner Jan 2014 www.dbexcelaccounting.blogspot.com

End Sub
Private Sub getPosition(x As Range)
Debug.Print "Cell addy is " & x.Address & ". Cell level and text is " & x.Column & " - " & x.Value
End Sub
Private Function gettabs(x As Integer, Optional y As Integer) As String
For n = 1 To (x) ' - y) old implementation allowed offsets
gettabs = vbTab & "" & gettabs
Next
'If ((x * 2) - y) = 8 Then Stop

End Function

Private Function cnam(c As Range)
cnam = c.Value
End Function
Private Function Cap(x As String) As String
If Left(x, 1) = "/" Then
Cap = "</" & Right(x, Len(x) - 1) & ">"
Else: Cap = "<" & x & " name="""
End If
End Function
Private Function nameElement(x As String) As String
nameElement = x & """>"
End Function

Private Sub closetoplevel()
'Stop
'not implemented
End Sub

Private Function pushup(r() As String, l As Integer, s As Integer, ref As Integer)
Dim x As Integer: x = ref - l - 1
'Stop

'If ref <> s Then
'    MsgBox "error, structure issue - not implemented"
'    Stop
'End If
Dim y As Integer
If x > 1 Then ' tests if this function needs to be run recursively to step up multiple levels
    For y = 1 To x - 1
    Dim groupnumber As Integer
    'Stop
    If y <> 2 And InStr(1, r(l + 1, 0), "<") > 0 Then
        groupnumber = 2
    Else: groupnumber = 2 + y - 1
    End If
    'If groupnumber = 2 Then Stop
    Call rlevelup(r, l + (x - y), s, ref, groupnumber) ' recursive section
    'Stop
    Next
End If
'Stop
If r(l, 5) = r(l, 3) Then ' this triggers for first item in group
    'Stop
    r(l, 5) = r(l, 1) & r(l, 5) & r(l, 2)
Else
    If y = 0 Then
    r(l, 5) = r(l, 1) & r(l, 5) & r(l, 2) & vbCrLf
    Stop
    Else
        r(l, 5) = r(l, 5) & vbCrLf & r(l + 1, 5) & vbCrLf & gettabs(l, -1) & r(l, 4) & vbCrLf
'        Stop
    End If
End If

'Debug.Print r(l, 5)
Dim PlaceHolder As String: PlaceHolder = r(l, 0)

    If Left(PlaceHolder, 1) = vbTab Or Left(PlaceHolder, 4) = "    " Or Left(PlaceHolder, 1) = "<" Then
        'Debug.Print PlaceHolder
    Else
        PlaceHolder = ""
    End If

r(l, 0) = PlaceHolder & r(l, 5)
'Stop
For n = LBound(r) To UBound(r)
    If n >= l Then
        For i = 3 To 7
            If r(n, i) <> r(l, 5) Then r(n, i) = ""
        Next
    End If
Next

r(l, 3) = r(l, 5)
r(l, 5) = ""

'Stop
'not implemented

pushup = r
End Function

Private Function levelup(r() As String, l As Integer, s As Integer, ref As Integer)
Dim x As Integer: x = s - l - 1
'If x > 3 Then Stop
'r = pushup(r(), s - 1, s, ref)

'If ref <> s Then
'    MsgBox "error, structure issue - not implemented"
'    Stop
'End If
Dim y As Integer
If x > 1 Then ' tests if this function needs to be run recursively to step up multiple levels
    For y = 1 To x - 1
    Dim groupnumber As Integer
    'Stop
    If y <> 2 And InStr(1, r(l + 1, 0), "<") > 0 Then
        groupnumber = 2
    Else: groupnumber = 2 + y - 1
    End If
'Stop
    'If groupnumber = 2 Then Stop
    Call rlevelup(r, l + (x - y), s, ref, groupnumber) ' recursive section
    'Stop
    Next
End If
'Stop
If r(l, 5) = r(l, 3) Then ' this triggers for first item in group
    'Stop
    r(l, 5) = r(l, 1) & r(l, 5) & gettabs(l) & r(l, 2) & vbCrLf
Else
    If y = 0 Then
    r(l, 5) = r(l, 1) & r(l, 5) & gettabs(l) & r(l, 2) & vbCrLf
    Stop
    Else
        r(l, 5) = r(l, 5) & vbCrLf & r(l + 1, 5) & vbCrLf & gettabs(l, -1) & r(l, 4) & vbCrLf
'        Stop
    End If
End If

'Debug.Print r(l, 5)
Dim PlaceHolder As String: PlaceHolder = r(l, 0)

    If Left(PlaceHolder, 1) = vbTab Or Left(PlaceHolder, 4) = "    " Or Left(PlaceHolder, 1) = "<" Then
        'Debug.Print PlaceHolder
    Else
        PlaceHolder = ""
    End If

r(l, 0) = PlaceHolder & r(l, 1) & r(l, 3) & r(l + 1, 0) & gettabs(l) & r(l, 2)
r(l + 1, 0) = ""
'Stop
For n = LBound(r) To UBound(r)
    If n >= l Then
        For i = 3 To 7
            If r(n, i) <> r(l, 5) Then r(n, i) = ""
        Next
    End If
Next

'r(l, 3) = r(l, 5)
r(l, 5) = ""

'Stop
'not implemented

levelup = r
End Function

Private Function rlevelup(r() As String, l As Integer, s As Integer, ref As Integer, Optional groupnumber As Integer)
Dim x As Integer: x = ref - l - 1
'Stop
'called by level up

'If ref <> s Then
'    MsgBox "error, structure issue - not implemented"
'    Stop
'End If
Dim y As Integer
If x > 1 Then ' tests if this function needs to be run recursively to step up multiple levels
    For y = 1 To x - 1
    'Dim groupnumber As Integer
    'Stop
    'If y <> 2 And InStr(1, r(l + 1, 0), "<") > 0 Then
        groupnumber = 2
    'Else: groupnumber = 2 + y - 1
    'End If
    'If groupnumber = 2 Then Stop
    'Call rpushup(r, l + (x - y), s, ref, groupnumber) ' recursive section
    'Stop
    Next
End If
'Stop
If r(l, 5) = r(l, 3) Then ' this triggers for first item in group
    'Stop
    r(l, 5) = r(l, 1) & r(l, 5) & gettabs(l) & r(l, 2) & vbCrLf
Else
    If y = 0 Then
    r(l, 5) = r(l, 1) & r(l, 5) & gettabs(l) & r(l, 2) & vbCrLf
    Stop ' delete this comment when stop hit programmatically - may be deletable
    Else
        r(l, 5) = r(l, 5) & vbCrLf & r(l + 1, 5) & vbCrLf & gettabs(l, -1) & r(l, 4) & vbCrLf
'        Stop
    End If
End If

'Debug.Print r(l, 5)
Dim PlaceHolder As String: PlaceHolder = r(l, 0)

    If Left(PlaceHolder, 1) = vbTab Or Left(PlaceHolder, 4) = "    " Or Left(PlaceHolder, 1) = "<" Then
        'Debug.Print PlaceHolder
    Else
        PlaceHolder = ""
    End If

r(l, 0) = PlaceHolder & r(l, 1) & r(l, 3) & r(l + 1, 0) & gettabs(l) & r(l, 2)
r(l + 1, 0) = ""
'Stop
For n = LBound(r) To UBound(r)
    If n >= l Then
        For i = 3 To 7
            If r(n, i) <> r(l, 5) Then r(n, i) = ""
        Next
    End If
Next

'r(l, 3) = r(l, 5)
r(l, 5) = ""

'Stop
'not implemented
'writeout (r(l, 0))
rlevelup = r
End Function

Private Sub writeout(s As String)

Dim fso As Object
Set fso = CreateObject("Scripting.FileSystemObject")
Dim oFile As Object
Set oFile = fso.CreateTextFile("c:/txt.txt")
oFile.WriteLine s
oFile.Close
Set fso = Nothing
Set oFile = Nothing

End Sub 
```

# ios - iOS导航栏setBackBarButtonItem到自定义按钮

> ID：15365321
> 
> 赞同：3
> 
> 时间：2013-03-12T15:29:06.897
> 
> 标签：ios, objective-c, cocoa-touch, uinavigationbar, backbarbuttonitem

我需要有关如何自定义“backBarButtonItem”的帮助，不，我不想使用 LeftBarButtomItem，因为我想继承样式并保持从“BackBarButtom”的过渡

好的，所以我得到的是：

```
UIBarButtonItem* barbtnItem = [[UIBarButtonItem alloc]initWithCustomView:  [ArrivalProto ArrivalBtnTypeBack]]; 
```

`[ArrivalProto ArrivalBtnTypeBack]`给了我一个自定义的 UIbutton，其中包含一个 setBackgroundImage 和一个 setImage。

然后我要做的就是添加这个来自定义 BackBarButton：

```
[self.navigationItem setBackBarButtonItem: barbtnItem]; 
```

但是不。只是普通的正常后退按钮:(((虽然这似乎有效：

```
//self.navigationItem setLeftBarButtonItem:barbtnItem]; 
```

这也是：

```
UIImage *btnTrnspBgrImg30 = [[UIImage imageNamed:@"trspBlackBtn30"]resizableImageWithCapInsets:UIEdgeInsetsMake(0, 5, 0, 5)]; 
 [[UIBarButtonItem appearance] setBackButtonBackgroundImage:btnTrnspBgrImg30      forState:UIControlStateNormal barMetrics:UIBarMetricsDefault]; 
```

信息：

```
[self.navigationItem setBackBarButtonItem: <#(UIBarButtonItem *)#>];
[self.navigationItem setLeftBarButtonItem:<#(UIBarButtonItem *)#>] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:35:02.427

从 iOS5 开始，我们有了一种*极好的新方法，可以使用*[外观代理](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAppearance_Protocol/Reference/Reference.html)自定义几乎所有控件的外观，即`[UIBarButtonItem appearance]`. 外观代理允许您在应用程序范围内对控件的外观进行更改。下面是使用外观代理创建的自定义后退按钮的示例。

![在此处输入图像描述](../Images/e1159cde1f0152cb67072ec314db60d6.png)

使用下面的示例代码创建一个带有自定义图像的后退按钮，用于正常和突出显示状态。从您的 appDelegate 调用以下方法`application:didFinishLaunchingWithOptions:`

```
- (void) customizeAppearance {

UIImage *i1 = [[UIImage imageNamed:@"custom_backButton_30px"]
                      resizableImageWithCapInsets:UIEdgeInsetsMake(0, 15, 0, 6)];
UIImage *i2 = [[UIImage imageNamed:@"custom_backButton_24px"] 
                      resizableImageWithCapInsets:UIEdgeInsetsMake(0, 15, 0, 6)];

[[UIBarButtonItem appearance] setBackButtonBackgroundImage:i1 
                              forState:UIControlStateNormal 
                              barMetrics:UIBarMetricsDefault];

[[UIBarButtonItem appearance] setBackButtonBackgroundImage:i2 
                              forState:UIControlStateNormal 
                              barMetrics:UIBarMetricsLandscapePhone];

[[UIBarButtonItem appearance] setBackButtonBackgroundImage:i1
                              forState:UIControlStateHighlighted 
                              barMetrics:UIBarMetricsDefault];

[[UIBarButtonItem appearance] setBackButtonBackgroundImage:i2 
                              forState:UIControlStateHighlighted 
                              barMetrics:UIBarMetricsLandscapePhone];
} 
```

这只是一个简单的例子。通常，您希望为正常和突出显示（按下）状态提供单独的图像。

如果您对自定义其他控件的外观感兴趣，可以在这里找到一些很好的示例：http: [//ios.biomsoft.com/2011/10/13/user-interface-customization-in-ios-5/](http://ios.biomsoft.com/2011/10/13/user-interface-customization-in-ios-5/)

# sql-server - 如何创建子查询的子查询，以获取行的 Count()，但只显示最新的行？Max()

> ID：15365322
> 
> 赞同：1
> 
> 时间：2013-03-12T15:29:09.457
> 
> 标签：sql-server

我有一个查询，它有几个关节非常复杂，我让它返回用户的所有消息，以及该消息的最新帖子（即消息帖子上的 max(id) 部分）。但我也想显示特定消息的帖子总数。我不想提取所有消息，而只是获取行的 count() 。

这是我的查询，现在可以使用，没有计数部分：

```
SELECT recipients.readmessage, messages.id AS id, messages.subject, messages.createdat AS messagecreated, messages.userid AS originalposterid, messages.usershortname AS opname, messageposts.id AS messagepostid, messageposts.usershortname AS repliername, messageposts.userid AS replierid, messageposts.updatedat AS messagepostcreated, userpictures.id AS pictureid, userpictures.createdat AS picturedate, userpictures.name AS picname, users.sex 
    FROM recipients 
        INNER JOIN messages ON recipients.messageid = messages.id 
        AND messages.deletedat IS NULL 
            LEFT OUTER JOIN messageposts
            ON messageposts.id =
                 (
                 // HERE IS WHERE I WANT A COUNT//
                 SELECT  max(id) 
                 FROM    messageposts
                 WHERE   messageid = messages.id
                 AND messageposts.deletedat IS NULL
                 )
                INNER JOIN users ON messageposts.userid = users.id 
                AND users.deletedat IS NULL 
                    LEFT OUTER JOIN userpictures 
                    ON userpictures.id =
                             (
                             SELECT  max(id)
                             FROM    userpictures
                             WHERE   userid = users.id
                             AND userpictures.deletedat IS NULL
                             )

    WHERE ( recipients.userid = #currentuser.id# ) 
    AND ( recipients.deletedat IS NULL ) 
    ORDER BY recipients.readmessage ASC,messageposts.updatedat DESC,messages.createdat DESC,userpictures.createdat DESC 
```

我需要插入的部分是这样的：

```
(
SELECT COUNT(id) as totalposts
FROM    messageposts
WHERE   messageid = messages.id
) 
```

这是我尝试过的：

```
(
 SELECT  max(id) 
 FROM       
    (
    SELECT COUNT(id) as totalposts
    FROM    messageposts
    WHERE   messageid = messages.id
    )
    messageposts
 WHERE      messageid = messages.id
 AND messageposts.deletedat IS NULL
 ) 
```

但这给了我一个**模棱两可的列名**错误。我尝试将其更改为：

```
(
 SELECT  max(id) 
 FROM       
    (
    SELECT COUNT(id) as totalposts
    FROM    messageposts
    WHERE   messageposts.messageid = messages.id
    )
    messageposts
 WHERE   messageposts.messageid = messages.id
 AND messageposts.deletedat IS NULL
 ) 
```

但后来我得到**无效的列名**messageid。

关于如何让它发挥作用的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T12:09:53.417

我认为您需要更改链接到`messageposts`子查询的方式：

老的：

```
LEFT OUTER JOIN messageposts
    ON messageposts.id =
             (
             // HERE IS WHERE I WANT A COUNT//
             SELECT  max(id) 
             FROM    messageposts
             WHERE   messageid = messages.id
             AND messageposts.deletedat IS NULL
             ) 
```

新的：

```
LEFT OUTER JOIN
    (
    SELECT 
        messageid AS postmessageid
        ,max(id) AS LatestPost
        ,count(id) AS TotalPosts
    FROM messageposts
    WHERE deletedat IS NULL
    GROUP BY messageid
    ) PostsOnMessage
ON messages.id = PostsOnMessage.postmessageid 
```

然后，您可以在上面的字段中添加`LatestPost`和。`TotalPosts`

# java - 与 FTPS 的 URL 连接

> ID：15365331
> 
> 赞同：0
> 
> 时间：2013-03-12T15:29:30.500
> 
> 标签：java, java-7, urlconnection, ftps

是否可以更改当前源代码以便我可以使用 FTPS？：

```
InputStream in = new URL(url).openStream();
OutputStream out = new     URL("ftp://"+user+":"+password+"@"+server+""+dir+""+filename_real_string).openConnection().get    OutputStream();
byte[] buffer = new byte[16384];
while ((r=in.read(buffer))>=0) {
  out.write(buffer, 0, r);
}
in.close();
out.close(); 
```

是否有可能没有任何额外的库，或者如果没有，哪个库最适合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:44:35.113

您可以使用：org.apache.commons.net.ftp.FTPSClient

使用它的示例：

```
public static void main(String[] args) {
    FTPSClient ftp = new FTPSClient();
    String host = "server.com";
    int port = 2121;
    String folderName = "dir";
    String username = "user";
    String password = "password";
    try {
        ftp.connect(host, port);
        ftp.login(username, password);
        InputStream fis = new FileInputStream("../filename_src.txt");

        ftp.storeFile("/" + folderName + "/filename_dest.xml", fis);
        fis.close();

        ftp.logout();
        ftp.disconnect();
    } catch (SocketException ex) {
        Logger.getLogger(FTPSendMessage.class.getName()).log(Level.SEVERE, null, ex);
    } catch (IOException ex) {
        Logger.getLogger(FTPSendMessage.class.getName()).log(Level.SEVERE, null, ex);
    }
} 
```

# c# - 检查 Excel 是否处于脏状态

> ID：15365333
> 
> 赞同：13
> 
> 时间：2013-03-12T15:29:33.543
> 
> 标签：c#, excel

有什么方法可以知道 Excel 是否处于脏状态。

脏状态是指：- 当您在 Excel 上执行任何操作并关闭保存按钮时 - Excel 会要求您保存文件。因此，在编辑文件时必须设置一些标志。

我可以通过 C# 代码知道 Excel 文件的状态吗？

搜索了很多，但没有太多帮助。有一个选项可以让您通过查看 Excel 是否处于编辑状态`GetRibbonControlEnabled("FileNewDefault")`

在这种情况下，您只能在执行此方法时查看 Excel 是否处于编辑状态。

如果我想知道 Excel 自打开以来是否被编辑/弄脏了怎么办？

请不要建议使用上述功能启动后台线程，该线程会一直查看 Excel 是否处于编辑模式。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T15:37:19.230

看看[`Workbook.Saved`](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.saved%28v=vs.110%29.aspx)物业。它会告诉您自上次打开文档以来用户是否修改了文档。

```
bool isDirty = !Globals.Application.ActiveWorkbook.Saved; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:37:28.190

在 Excel VBA 模块中，可以测试该`ActiveWorkbook.Saved`属性，如果是，`False`则工作簿具有未保存的更改（“脏”）。详情[在这里](http://support.microsoft.com/kb/213634)。看看您是否可以从 C# 代码中检查该属性。

# ember.js - 如何渲染 hasMany 关联，每个关联都有自己的控制器

> ID：15365335
> 
> 赞同：1
> 
> 时间：2013-03-12T15:29:39.360
> 
> 标签：ember.js, ember-data

所以我的模型是这样设置的：

```
App.Post = DS.Model.extend
  comments: DS.hasMany 'App.Comment'

App.Comment = DS.Model.extend
  post: DS.belongsTo 'App.Post' 
```

我正在尝试创建一个显示所有帖子和所有评论的视图，但我需要装饰评论对象。

这是我想做的，但无济于事：

```
<ul>
  {{#each post in controller}}
    <li>{{post.title}}</li>
    <ol>
      {{#each comment in post.comments itemController="comment"}}
        <li>{{comment.body}}</li>
      {{/each}}
    </ol>
  {{/each}}
</ul> 
```

`App.CommentController`模板根本找不到在 a 中定义的属性。

我怀疑`Ember.OrderedSet`没有实现`itemController`参数 - 是否有解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T17:35:04.653

您需要使用新的过期控制标签。这将加载指定类型的视图和控制器：

```
<ul>
  {{#each post in controller}}
    <li>{{post.title}}</li>
    <ol>
      {{#each comment in post.comments}}
        {{ control "comment" comment }}
      {{/each}}
    </ol>
  {{/each}}
</ul> 
```

您需要先启用此过期功能。在加载 ember 之前放置：

```
<script type='application/javascript'>
    ENV = {
        EXPERIMENTAL_CONTROL_HELPER: true
    };
</script> 
```

此外，您需要指定评论控制器不应是单例，否则将只有一个控制器为所有评论视图实例化：

```
// this is needed to use control handlebars template properly per
// https://github.com/emberjs/ember.js/issues/1990
App.register('controller:comment', App.CommentController, {singleton: false }); 
```

# adobe - Adobe Fireworks CS6 - JPEG 始终保存为 100% ？这是一个错误吗？

> ID：15365336
> 
> 赞同：0
> 
> 时间：2013-03-12T15:29:41.707
> 
> 标签：adobe, photoshop, fireworks

使用 Adob​​e Fireworks 6 在 OS X Mountain Lion 上工作。

每次我去另存为..并选择JPEG我去选项并修改然后去选项将质量从默认的99%调整到~80%，它永远不会保留这个值。

我将质量调整为 80%，单击“确定”，如果我返回选项，质量将恢复为 99%。

如果我将质量设置为 80%，点击确定，然后保存文件，我看到在检查后它再次以 99% 的质量保存（可以通过文件大小判断。）

为什么 Fireworks CS6 不保留我的 JPEG 质量选项设置？还有其他人遇到这种情况吗？

这令人沮丧，因为我记得几个月前我无法保存为 PNG32，因为选项总是恢复为 PNG24。这个问题似乎自行消失了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T20:12:35.983

看起来“另存为”JPG 选项从“优化”面板中设置的任何内容继承了它们的值（默认情况下，新文件中的 JPG 为 80%）。如果您更改优化面板中的值，“另存为”JPG 选项将使用新值，即使您将优化面板更改为其他格式也是如此。

这可能与您的 PNG24/PNG32 问题的根本原因相同——我在导出命令时遇到了同样的问题，该命令也关闭了优化面板设置。

# javascript - JavaScript：预加载图像功能 - 用法、DOM 就绪和 SEO？

> ID：15365345
> 
> 赞同：0
> 
> 时间：2013-03-12T15:30:01.553
> 
> 标签：javascript, jquery, preloader, preload, image-preloader

在 Google 的帮助下，我编写了一个小型预加载器脚本：

```
var i = 0;

function preloader() {

    imageObj = new Image();

    images = [
        'some/image1.jpg', 
        'some/image2.jpg',
        'some/image3.png',
        'and.png',
        'so.jpg',    
        'on.png'
    ];

    for (i = 0; i <= 20; i ++) {

      imageObj.src = images[i];

    }
} 
```

`head`必须在我的 HTML 文件中调用此函数才能获得最大效果，对吧？我真的需要申报`var i = 0;`吗？预加载完成后如何触发另一个功能？

另外，我想问一下如何在运行网站中实现这个功能。假设我有一个包含 100 个`img`标签的页面。我想我必须手动将源复制并粘贴到`images`数组中，对吧？因为要使用循环执行此操作，DOM 需要准备好，这再次意味着图像已经开始加载？

预加载会影响SEO吗？

如果有更好的 jQuery 预加载方式，我会同意的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:36:53.137

因为您将图像 SRC 分配给同一个变量，所以每个新请求都将取消前一个请求，因为它尚未完成加载。

您也可以为此使用数组：

```
imageObj = [];

...your code...

for (i = 0; i < images.length; i ++) {
      imageObj[i] = new Image()
      imageObj[i].src = images[i];
    } 
```

不，这不会影响 SEO，因为抓取工具查看的是您页面的文本，而不是图像。您可以在 DOM 准备好之前运行它，因为您没有操作 DOM - 所有图像都在内存中。

jQuery 只是由 JavaScript 组成，并没有任何东西可以提高这个简单代码块的效率。

# ios - CoreBluetooth [警告] 未知错误：311 在 iOS 中使用 CoreBluetooth 框架重复连接和断开连接时发生

> ID：15365348
> 
> 赞同：2
> 
> 时间：2013-03-12T15:30:03.697
> 
> 标签：ios, core-bluetooth

当我尝试连接蓝牙设备时，它反复连接失败并显示错误`CoreBluetooth[WARNING] Unknown error: 311`。我正在使用 2 个 iPod 5 Touch 设备。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T22:58:38.457

我也遇到过这个问题，这似乎是 Core Bluetooth 的 XPC 通信中的一个错误：

```
2013-03-22 14:49:24.652 Buggy[985:907] Connecting to peripheral <CBConcretePeripheral: 0x1dd4e150 UUID = (null), Name = "iPhone 5 #003014", IsConnected = NO>
2013-03-22 14:49:24.659 Buggy[985:907] CoreBluetooth[WARNING] Unknown error: 311
2013-03-22 14:49:24.661 Buggy[985:907] Failed to connect to peripheral <CBConcretePeripheral: 0x1dd4e150 UUID = (null), Name = "iPhone 5 #003014", IsConnected = NO>
2013-03-22 14:49:24.689 Buggy[985:907] Discovered peripheral <CBConcretePeripheral: 0x1dd644d0 UUID = (null), Name = "iPhone 5 #003014", IsConnected = NO> with advertisement data {
    kCBAdvDataLocalName = "iPhone 5 #003014";
    kCBAdvDataServiceUUIDs =     (
        "Unknown (<b2e74c08 96094371 a8f0978c 655700ea>)"
    );
}, RSSI: -50
2013-03-22 14:49:24.692 Buggy[985:907] Connecting to peripheral <CBConcretePeripheral: 0x1dd644d0 UUID = (null), Name = "iPhone 5 #003014", IsConnected = NO>
2013-03-22 14:49:45.035 Buggy[985:110b] CoreBluetooth[ERROR] XPC connection interrupted, resetting
2013-03-22 14:49:45.050 Buggy[985:907] Central manager updated state to: 1
2013-03-22 14:49:45.116 Buggy[985:907] Central manager updated state to: 4
2013-03-22 14:49:47.271 Buggy[985:907] Central manager updated state to: 5 
```

在此之后，事情又开始工作了，至少直到几分钟后再次出现错误 311 循环。

这是一个对我来说可靠的解决方法：

```
// In centralManager:didFailToConnectPeripheral:error:, ARC enabled
if (error.code == 0) {
    self.centralManager.delegate = nil;
    self.centralManager = nil;
    // Remove all references to any peripherals you've been interacting with
    [self.peripherals removeAllObjects];

    /* Some delay (more than the next iteration of the runloop, less than 2 seconds) is required in order to:
     * • Allow ARC to drain the autorelease pool, ensuring destruction of the centralManager
     * • Allow Core Bluetooth to turn off the radio.
     *
     * This means that this workaround might not work if:
     * • Your code has another active central manager somewhere
     * • Another app is using BLE (in theory; I haven't tested this)
     */
    double delayInSeconds = 2.0;
    dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));
    dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
        self.centralManager = [[CBCentralManager alloc] initWithDelegate:self queue:dispatch_get_main_queue()];
        [self startScanning];
    });
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-12T20:12:54.037

如果您在连接一段时间后遇到错误，那么此分析和解决方案似乎会有所帮助：

[http://lists.apple.com/archives/bluetooth-dev/2013/Jan/msg00069.html](http://lists.apple.com/archives/bluetooth-dev/2013/Jan/msg00069.html)

# php - facebook php 访问令牌

> ID：15365351
> 
> 赞同：0
> 
> 时间：2013-03-12T15:30:08.733
> 
> 标签：php, facebook

我在同一个目录中拥有所有文件（facebook.php、base_facebook.php、index.php）。我的服务器是 Apache，并且都支持 php。我的代码：

```
<html>
<body>
<?php
try
{
echo("STARTING<br>");
require("facebook.php");
}
catch(Exception $e)
{
echo("ERROR1: $e");
}

try
{
$facebook = new Facebook("***","###");
}
catch(Exception $e)
{
echo("ERROR2: $e");
}
$token = $facebook->getAccessToken();
echo("Access token: ".$token."<br>"); 
```

我的文本输出如下：

```
STARTING
ERROR1: Object id #1before create fb instance

Fatal error: Class 'Facebook' not found in /(FILE PATH)/index.php on line 16

Note: line 16 is: $facebook = new Facebook("***","###"); 
```

第一个 catch 语句正在打印：Object Id #1。然后它会执行我的下一个打印语句。然后它返回未捕获的致命错误。我在这里想念什么？

为什么服务器无法获得正确的访问令牌？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:33:47.163

您未能访问`require`facebook.php，因此`ERROR1: Object id #1`- 您试图回显异常错误对象。尝试

```
catch ($e) {
   die($e->getMessage());
} 
```

反而。

你不应该发现这种错误。如果要求失败，唯一有用的解决方案是中止执行，因为您还没有获得继续执行所需的内容。

基本上，您已经实现了 Visual Basic 的 PHP 化版本，以及随之而来的`on error resume next`所有令人讨厌的愚蠢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:40:59.607

您应该在发送标头之前放置代码：

去这里了解更多信息：[https ://developers.facebook.com/docs/reference/php/](https://developers.facebook.com/docs/reference/php/)

基本上，把它放在你的代码之上：

```
<?php
require_once("facebook.php");

$config = array();
$config[‘appId’] = 'YOUR_APP_ID';
$config[‘secret’] = 'YOUR_APP_SECRET';
$config[‘fileUpload’] = false; // optional

$facebook = new Facebook($config);
?> 
```

然后加载您的 HTML（在 MVC 样式中将更好地进行维护；-）

# javascript - 确定用户是否在移动设备上的最简单方法

> ID：15365352
> 
> 赞同：16
> 
> 时间：2013-03-12T15:30:10.297
> 
> 标签：javascript, mobile, desktop

我在我的网站上显示了一个通知栏，坦率地说，当它在移动设备上时效果不佳。我只想为桌面用户显示该栏。

确定用户是使用台式机还是移动设备的最简单方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T15:34:13.163

检查这个 [http://detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)

适用于 Javascript、jQuery 等。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-12T15:33:46.123

用户代理检查是“最简单的”，尽管您可以轻松使用[CSS3 媒体查询](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)

这是一个检查 iphone、android 和 blackberry 的示例；您可以轻松添加其他移动浏览器。

```
var is_mobile = !!navigator.userAgent.match(/iphone|android|blackberry/ig) || false; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-12T15:38:35.507

我发现最好使用特征检测。使用[Modernizr](http://modernizr.com/)来检测它是否是触摸设备。您可以执行以下操作：

```
var mousedown = 'mousedown';

if (Modernizr.touch) {
    mousedown = 'touchstart';
}

$('.foo').on(mousedown, handleMouseDown); 
```

然后使用 CSS 媒体查询来处理屏幕宽度（使用 javascript 也很容易检测屏幕宽度）。这样您就可以正确处理具有大屏幕的触摸设备或具有小屏幕的非触摸设备。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-27T22:49:56.593

如果您使用[modernizr](http://modernizr.com/download)。一个“无接触”类将被添加到元素中。如果“无触摸”类存在，您可以默认隐藏该栏并添加一个 CSS 规则以显示该栏。例子：

默认：

`.bar{display:none;}`

桌面：

```
.no-touch .bar{display:block;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-07T14:10:19.683

如果用户在移动设备上，则此 javascript 'if' 将返回 true。

if (navigator.userAgent.indexOf('Mobile') !== -1) { ...

另请参阅：[https ://deviceatlas.com/blog/list-of-user-agent-strings](https://deviceatlas.com/blog/list-of-user-agent-strings)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-27T17:26:08.453

区分触摸设备和非触摸设备的最简单方法是使用媒体查询。

1) 可以使用媒体查询编写针对移动/触摸设备的 CSS，

```
 @media (hover: none), (pointer: coarse) {} 
```

2) 针对桌面/非触控设备（仅限）的 CSS 可以使用媒体查询编写，

```
 @media not all and (pointer: coarse) {} 
```

在少数最新的移动设备（例如：IOS 10+、一加等）上检测到悬停，因此我们使用 (2) 来识别非触摸设备。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-17T12:17:53.943

```
 const is_mobile = navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/BlackBerry/i);

if (is_mobile != null){
    popup.modal('show');
} 
```

# ruby-on-rails - 如何让 fullcalendar 通过函数将开始日期动态传递给新事件？

> ID：15365356
> 
> 赞同：1
> 
> 时间：2013-03-12T15:30:26.867
> 
> 标签：ruby-on-rails, fullcalendar

在月视图中，我单击日期，然后视图变为日视图。当我单击新事件链接时，我希望开始日期是所选日期的日期，而不是默认的今天日期。

如果今天是 2013 年 3 月 12 日，并且我想在 2013 年 3 月 28 日创建一个事件，我将在月视图中单击 3 月 28 日的日期单元格。将出现 3 月 28 日的日视图。我将单击新事件，事件的开始时间将是 2013 年 3 月 12 日（显示当前日期），我需要手动选择 2013 年 3 月 28 日（或任何我想要的日期）。

我想出了硬编码的方法，但这在生产中是行不通的。有没有办法动态传递选定日期的开始日期，以便自动设置为选定月份的任何一天？

这是dayClick代码：

```
 dayClick: (date, allDay, jsEvent, view) ->
          if (allDay)
          # clicked entire day
            $('#calendar')
              .fullCalendar('changeView', 'agendaDay')
              .fullCalendar('gotoDate', date.getFullYear(), date.getMonth(), date.getDate()) 
```

我应该使用 select 方法吗？如果是这样怎么办？我不明白文档[http://arshaw.com/fullcalendar/docs/selection/select_method/](http://arshaw.com/fullcalendar/docs/selection/select_method/) [http://arshaw.com/fullcalendar/docs/selection/select_callback/](http://arshaw.com/fullcalendar/docs/selection/select_callback/)

在 events.js.coffee 中，我试图在以下位置动态创建一个新的事件链接：

```
 $('#new-event').append("<a>custom link built thru js</a>").attr('href', 'events/new?starts_at=2013-03-28') <-- How to set starts_at by obtaining the date from day selected dynamically? Use calendar's select method to obtain the date parameters? 
```

从dayClick中选择的日期的参数是如何传入的？或者我是否从 gotoDate 获取此信息？

事件控制器.rb：

```
 # GET /events/new
     # GET /events/new.json
     def new
       @event = Event.new
       @event.starts_at = (params[:starts_at]) # sets the date
       respond_to do |format|
         format.html # new.html.erb
         format.json { render :json => @event }
       end
     end 
```

Event.rb 模型：

```
 def as_json(options = {})
        {
         :id => self.id,
         :title => self.title,
         :description => self.description || "",
         :start => starts_at,
         :end => ends_at,
         :allDay => self.all_day,
         :recurring => false,
         :url => Rails.application.routes.url_helpers.event_path(id),
         :type_of => self.type_of
        }
      end 
```

意见/日历/show.html.erb：

```
 <%= link_to "new event", controller: "events", 
                     action: "new",
                     starts_at: "28-03-2013" %> This will set the starts_at param manually via Rails. How do I obtain this dynamically? Using jQuery see code above in  to create link that has the starts_at parameter (see code above). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T18:35:04.953

我不确定这是否是最好的解决方案，但这是我如何让它工作的。在 events.js.coffee 中：

```
 $('#calendar').fullCalendar
      dayClick:  (date, allDay, jsEvent, view) ->
        if (allDay)
        # clicked entire day
        $('#calendar')
          .fullCalendar('changeView', 'agendaDay')
          .fullCalendar('gotoDate', date.getFullYear(), date.getMonth(), date.getDate())
          $('#new-event').append("<a>custom link built thru js</a>").attr( 'href', 'events/new?starts_at=' + date ) 
```

# sql-server - 如何替换功能性（许多）OUTER APPLY（SELECT * FROM）

> ID：15365367
> 
> 赞同：3
> 
> 时间：2013-03-12T15:30:54.930
> 
> 标签：sql-server, sql-server-2008, pivot, unpivot

*适用于 Microsoft SQL Server 2008 R2。*

## 问题是

如果我们有几十`Outer Apply`(30) 个，那么它们开始工作得非常缓慢。在中间`Outer Apply`我有一些比简单的选择更复杂的东西，一个视图。

## 细节

我正在编写一种分配给表（在数据库中）的属性。通常，一些表包含对属性表（键、值）的引用。

伪结构如下所示：

```
DECLARE @Lot TABLE (
LotId INT PRIMARY KEY IDENTITY, 
SomeText VARCHAR(8))

INSERT INTO @Lot
OUTPUT INSERTED.*
VALUES ('Hello'), ('World')

DECLARE @Attribute TABLE(
AttributeId INT PRIMARY KEY IDENTITY, 
LotId INT, 
Val VARCHAR(8),
Kind VARCHAR(8))

INSERT INTO @Attribute
OUTPUT INSERTED.* VALUES 
(1, 'Foo1', 'Kind1'), (1, 'Foo2', 'Kind2'), 
(2, 'Bar1', 'Kind1'), (2, 'Bar2', 'Kind2'), (2, 'Bar3', 'Kind3')

LotId       SomeText
----------- --------
1           Hello
2           World

AttributeId LotId       Val      Kind
----------- ----------- -------- --------
1           1           Foo1     Kind1
2           1           Foo2     Kind2
3           2           Bar1     Kind1
4           2           Bar2     Kind2
5           2           Bar3     Kind3 
```

我现在可以运行查询，例如：

```
SELECT 
[l].[LotId]
  , [SomeText]
  , [Oa1].[AttributeId]
  , [Oa1].[LotId]
  , 'Kind1Val' = [Oa1].[Val]
  , [Oa1].[Kind]
  , [Oa2].[AttributeId]
  , [Oa2].[LotId]
  , 'Kind2Val' = [Oa2].[Val]
  , [Oa2].[Kind]
  , [Oa3].[AttributeId]
  , [Oa3].[LotId]
  , 'Kind3Val' = [Oa3].[Val]
  , [Oa3].[Kind]  
FROM @Lot AS l
OUTER APPLY(SELECT * FROM @Attribute AS la WHERE la.[LotId] = l.[LotId] AND la.[Kind] = 'Kind1') AS Oa1
OUTER APPLY(SELECT * FROM @Attribute AS la WHERE la.[LotId] = l.[LotId] AND la.[Kind] = 'Kind2') AS Oa2
OUTER APPLY(SELECT * FROM @Attribute AS la WHERE la.[LotId] = l.[LotId] AND la.[Kind] = 'Kind3') AS Oa3

LotId       SomeText AttributeId LotId       Kind1Val Kind     AttributeId LotId       Kind2Val Kind     AttributeId LotId       Kind3Val Kind
----------- -------- ----------- ----------- -------- -------- ----------- ----------- -------- -------- ----------- ----------- -------- --------
1           Hello    1           1           Foo1     Kind1    2           1           Foo2     Kind2    NULL        NULL        NULL     NULL
2           World    3           2           Bar1     Kind1    4           2           Bar2     Kind2    5           2           Bar3     Kind3 
```

获取属性值和结果的透视表的**简单**方法对于不具有此类属性的 Lot 行 Kind3。我知道 Microsoft [PIVOT](http://msdn.microsoft.com/pl-pl/library/ms177410%28v=sql.105%29.aspx)，它并不简单，不适合这里。

最后，什么会更快并给出相同的结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:53:22.757

为了获得结果，您可以*取消*透视然后*旋转*数据。

有两种方法可以执行此操作。首先，您可以使用`UNPIVOT`and`PIVOT`函数：

```
select *
from
(
    select LotId,
        SomeText,
        col+'_'+CAST(rn as varchar(10)) col,
        value
    from
    (
        select l.LotId, 
            l.SomeText,
            cast(a.AttributeId as varchar(8)) attributeid,
            cast(a.LotId as varchar(8)) a_LotId,
            a.Val,
            a.Kind,
            ROW_NUMBER() over(partition by l.lotid order by a.attributeid) rn
        from @Lot l
        left join @Attribute a
            on l.LotId = a.LotId
    ) src
    unpivot
    (
        value
        for col in (attributeid, a_Lotid, val, kind)
    ) unpiv
) d
pivot
(
    max(value)
    for col in (attributeid_1, a_LotId_1, Val_1, Kind_1,
                attributeid_2, a_LotId_2, Val_2, Kind_2,
                attributeid_3, a_LotId_3, Val_3, Kind_3)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/d41d8/10812)。

或者从 SQL Server 2008+ 开始，您可以使用`CROSS APPLY`with`VALUES`子句取消透视数据：

```
select *
from
(
    select LotId,
        SomeText,
        col+'_'+CAST(rn as varchar(10)) col,
        value
    from
    (
        select l.LotId, 
            l.SomeText,
            cast(a.AttributeId as varchar(8)) attributeid,
            cast(a.LotId as varchar(8)) a_LotId,
            a.Val,
            a.Kind,
            ROW_NUMBER() over(partition by l.lotid order by a.attributeid) rn
        from @Lot l
        left join @Attribute a
            on l.LotId = a.LotId
    ) src
    cross apply
    (
        values ('attributeid', attributeid),('LotId', a_LotId), ('Value', Val), ('Kind', Kind)
    ) c (col, value)
) d
pivot
(
    max(value)
    for col in (attributeid_1, LotId_1, Value_1, Kind_1,
                attributeid_2, LotId_2, Value_2, Kind_2,
                attributeid_3, LotId_3, Value_3, Kind_3)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/d41d8/10813)。

unpivot 过程为每个列获取多个列，`LotID`并将`SomeText`其转换为行，给出结果：

```
| LOTID | SOMETEXT |           COL | VALUE |
--------------------------------------------
|     1 |    Hello | attributeid_1 |     1 |
|     1 |    Hello |       LotId_1 |     1 |
|     1 |    Hello |       Value_1 |  Foo1 |
|     1 |    Hello |        Kind_1 | Kind1 |
|     1 |    Hello | attributeid_2 |     2 | 
```

我`row_number()`在内部子查询中添加了一个用于创建要透视的新列名。创建名称后，可以将枢轴应用于新列，给出最终结果

这也可以使用动态 SQL 来完成：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT ',' + QUOTENAME(col+'_'+rn) 
                    from 
                    (
                      select 
                        cast(ROW_NUMBER() over(partition by l.lotid order by a.attributeid) as varchar(10)) rn
                      from Lot l
                      left join Attribute a
                          on l.LotId = a.LotId
                    ) t
                    cross apply (values ('attributeid', 1),
                                 ('LotId', 2), 
                                 ('Value', 3), 
                                 ('Kind', 4)) c (col, so)
                    group by col, rn, so
                    order by rn, so
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT LotId,
                    SomeText,' + @cols + ' 
             from 
             (
                select LotId,
                    SomeText,
                    col+''_''+CAST(rn as varchar(10)) col,
                    value
                from
                (
                    select l.LotId, 
                        l.SomeText,
                        cast(a.AttributeId as varchar(8)) attributeid,
                        cast(a.LotId as varchar(8)) a_LotId,
                        a.Val,
                        a.Kind,
                        ROW_NUMBER() over(partition by l.lotid order by a.attributeid) rn
                    from Lot l
                    left join Attribute a
                        on l.LotId = a.LotId
                ) src
                cross apply
                (
                    values (''attributeid'', attributeid),(''LotId'', a_LotId), (''Value'', Val), (''Kind'', Kind)
                ) c (col, value)
            ) x
            pivot 
            (
                max(value)
                for col in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/b31af/12)

所有三个版本都会给出相同的结果：

```
| LOTID | SOMETEXT | ATTRIBUTEID_1 | LOTID_1 | VALUE_1 | KIND_1 | ATTRIBUTEID_2 | LOTID_2 | VALUE_2 | KIND_2 | ATTRIBUTEID_3 | LOTID_3 | VALUE_3 | KIND_3 |
-----------------------------------------------------------------------------------------------------------------------------------------------------------
|     1 |    Hello |             1 |       1 |    Foo1 |  Kind1 |             2 |       1 |    Foo2 |  Kind2 |        (null) |  (null) |  (null) | (null) |
|     2 |    World |             3 |       2 |    Bar1 |  Kind1 |             4 |       2 |    Bar2 |  Kind2 |             5 |       2 |    Bar3 |  Kind3 | 
```

# r - 使用多个参数循环而不使用 for 循环

> ID：15365371
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:31:08.027
> 
> 标签：r

下面是我的数据集的微缩版。我想在不使用“for”函数的情况下循环三个变量。

主题数据集的可重现版本

```
cat1 <- rep(c("A","S"),each=40)# First variable
cat2 <- rep(c("C","M","Y","K"), each=10, times=2) # Second variable
num1 <- rep(c(0,10,20,30,40,45,65,80,90,100),8) # Third variable
rspns <-structure(list(dataSet = c(0.2484375, 0.3959375, 0.4875, 0.57875, 0.6696875, 0.694375,
    0.816875, 0.879375, 0.9121875, 0.93125, 0.25125, 0.3796875, 0.4609375, 0.5396875, 0.6159375,
    0.6515625, 0.7696875, 0.8384375, 0.864375, 0.8865625, 0.271875, 0.39875, 0.4821875,
    0.5628125, 0.6284375, 0.650625, 0.7553125, 0.8003125, 0.8103125, 0.8125, 0.251875, 0.3775,
    0.4703125, 0.5725, 0.6996875, 0.7378125, 0.945, 1.055625, 1.1021875, 1.1140625, 0.25125,
    0.4203125, 0.5215625, 0.615625, 0.71, 0.74, 0.865625, 0.9246875, 0.9603125, 0.9734375,
    0.256875, 0.3953125, 0.4775, 0.5528125, 0.62875, 0.65875, 0.78375, 0.8384375, 0.8653125,
    0.8740625, 0.2790625, 0.4215625, 0.515, 0.6009375, 0.6665625, 0.693125, 0.7959375, 0.83875,
    0.8490625, 0.8575, 0.2571875, 0.3759375, 0.4665625, 0.56375, 0.68875, 0.725, 0.9259375,
    1.0328125, 1.085625, 1.1096875)), .Names = "rspns",
  class = "data.frame", row.names = c(NA, -80L))
gain <- data.frame(cat1,cat2,num1, rspns=rspns)

tint <-  function(x,y,z) gain[cat1 == x & cat2 == y & num1 == z, 4]
dgain <- function(x,y,z){(100* (1-10^-(tint(x,y,z) - tint(x,y,0))) / (1-10^-(tint(x,y,100)- tint(x,y,0)))) - z} 
```

如何在不使用循环的情况下获取需要三个参数的函数`dgain`来循环`cat1`和变量？`cat2``num1``for`

非常感谢您的帮助和技术专长。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T17:02:03.927

以下是我对我的评论的基本想法：

```
#With a basic for loop for reference
out1 <- rep(NA,80)
for (i in 1:80){
    out1[i] <- dgain(cat1[i],cat2[i],num1[i])
}

out2 <- mapply(dgain,x = cat1,y = cat2,z = num1)

out3 <- dgain(cat1,cat2,num1)

all.equal(out1,unname(out2))
[1] TRUE
> all.equal(out1,out3)
[1] "Mean relative difference: 0.2579067" 
```

可能可以重构您的代码，以便最终的成语 ( `dgain(cat1,cat2,num1)`) 将返回正确的结果，但这需要比我有时间更多的修补。问题是您正在使用 将全局环境中的数据框设置为子集`==`，如果您传递的是向量参数，它将不会返回您想要的内容。

没有什么特别的事情发生`mapply`。它几乎在字面上做与 for 循环相同的事情，只是效率可能稍高一些，而且可能以更美观的方式。

# c# - Roslyn 启动时间慢

> ID：15365376
> 
> 赞同：7
> 
> 时间：2013-03-12T15:31:14.243
> 
> 标签：c#, roslyn

我注意到 Roslyn 解析/编译的启动时间是相当可观的一次性成本。编辑：我正在使用 Roslyn CTP MSI（程序集在 GAC 中）。这是预期的吗？有什么解决方法吗？

运行以下代码所花费的时间几乎与 1 次迭代（约 3 秒）和 300 次迭代（约 3 秒）相同。

```
[Test]
public void Test()
{
    var iters = 300;
    foreach (var i in Enumerable.Range(0, iters))
    {
        // Parse the source file using Roslyn
        SyntaxTree syntaxTree = SyntaxTree.ParseText(@"public class Foo" + i + @" { public void Exec() { } }");

        // Add all the references we need for the compilation
        var references = new List<MetadataReference>();
        references.Add(new MetadataFileReference(typeof(int).Assembly.Location));

        var compilationOptions = new CompilationOptions(outputKind: OutputKind.DynamicallyLinkedLibrary);

        // Note: using a fixed assembly name, which doesn't matter as long as we don't expect cross references of generated assemblies
        var compilation = Compilation.Create("SomeAssemblyName", compilationOptions, new[] {syntaxTree}, references);

        // Generate the assembly into a memory stream
        var memStream = new MemoryStream();

        // if we comment out from this line and down, the runtime drops to ~.5 seconds
        EmitResult emitResult = compilation.Emit(memStream);

        var asm = Assembly.Load(memStream.GetBuffer());
        var type = asm.GetTypes().Single(t => t.Name == "Foo" + i);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-23T23:12:39.353

我认为一个问题是使用内存流，而不是您应该尝试使用动态模块和 ModuleBuilder。总体而言，代码执行得更快，但仍然有更重的首次加载场景。我自己对 Roslyn 很陌生，所以我不确定为什么这会更快，但这里是更改后的代码。

```
 var iters = 300;
        foreach (var i in Enumerable.Range(0, iters))
        {
            // Parse the source file using Roslyn
            SyntaxTree syntaxTree = SyntaxTree.ParseText(@"public class Foo" + i + @" { public void Exec() { } }");

            // Add all the references we need for the compilation
            var references = new List<MetadataReference>();
            references.Add(new MetadataFileReference(typeof(int).Assembly.Location));

            var compilationOptions = new CompilationOptions(outputKind: OutputKind.DynamicallyLinkedLibrary);

            // Note: using a fixed assembly name, which doesn't matter as long as we don't expect cross references of generated assemblies
            var compilation = Compilation.Create("SomeAssemblyName", compilationOptions, new[] { syntaxTree }, references);

            var assemblyBuilder = AppDomain.CurrentDomain.DefineDynamicAssembly(new System.Reflection.AssemblyName("CustomerA"),
            System.Reflection.Emit.AssemblyBuilderAccess.RunAndCollect);

            var moduleBuilder = assemblyBuilder.DefineDynamicModule("MyModule");

            System.Diagnostics.Stopwatch watch = new System.Diagnostics.Stopwatch();
            watch.Start();

            // if we comment out from this line and down, the runtime drops to ~.5 seconds
            var emitResult = compilation.Emit(moduleBuilder);

            watch.Stop();

            System.Diagnostics.Debug.WriteLine(watch.ElapsedMilliseconds);

            if (emitResult.Diagnostics.LongCount() == 0)
            {
                var type = moduleBuilder.GetTypes().Single(t => t.Name == "Foo" + i);

                System.Diagnostics.Debug.Write(type != null);
            }
        } 
```

通过使用这种技术，编译只需要 96 毫秒，在随后的迭代中大约需要 3 - 15 毫秒。所以我认为你在第一个负载场景方面可能是正确的，增加了一些开销。

抱歉，我无法解释为什么它更快！我自己只是在研究 Roslyn，今晚晚些时候会做更多的挖掘工作，看看我是否能找到更多关于 ModuleBuilder 通过内存流提供什么的证据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-09T19:55:23.043

[我使用 ASP.net 的Microsoft.CodeDom.Providers.DotNetCompilerPlatform](https://www.nuget.org/packages/Microsoft.CodeDom.Providers.DotNetCompilerPlatform/)包遇到了同样的问题。事实证明，这个包启动了 csc.exe，它使用 VBCSCompiler.exe 作为编译服务器。默认情况下，VBCSCompiler.exe 服务器的生存时间为 10 秒，其启动时间约为 3 秒。这解释了为什么运行代码一次或多次需要大约相同的时间。微软似乎也在 Visual Studio 中使用此服务器，以避免每次运行编译时支付额外的启动时间。

使用这个包，您可以监控您的进程，并会找到一个类似于 csc.exe /keepalive:10 的命令行

好的部分是如果该服务器保持活动状态（即使在您的应用程序的两个会话之间），您可以始终获得快速编译。

不幸的是，Roslyn 包并不是真正可定制的，我发现更改此 keepalive 常量的最简单方法是使用反射来设置非公共变量值。在我这边，我将它定义为一整天，因为即使我关闭并重新启动我的应用程序，它也始终保持相同的服务器。

```
 /// <summary>
    /// Force the compiler to live for an entire day to avoid paying for the boot time of the compiler.
    /// </summary>
    private static void SetCompilerServerTimeToLive(CSharpCodeProvider codeProvider, TimeSpan timeToLive)
    {
        const BindingFlags privateField = BindingFlags.NonPublic | BindingFlags.Instance;

        var compilerSettingField = typeof(CSharpCodeProvider).GetField("_compilerSettings", privateField);
        var compilerSettings = compilerSettingField.GetValue(codeProvider);

        var timeToLiveField = compilerSettings.GetType().GetField("_compilerServerTimeToLive", privateField);
        timeToLiveField.SetValue(compilerSettings, (int)timeToLive.TotalSeconds);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-21T19:03:33.977

当您调用 Compilation.Emit() 时，这是您第一次真正需要元数据，因此会发生元数据文件访问。之后，它的缓存。虽然这不应该只考虑 mscorlib 的 3 秒。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-02T10:39:22.227

tldr：NGEN-ing roslyn dlls 将初始编译/执行时间缩短了 1.5 秒（在我的情况下，从 ~2 秒到 ~0.5 秒）

* * *

刚刚调查了这个。

使用全新的控制台应用程序和对 的 nuget 引用`Microsoft.CodeAnalysis.Scripting`，一个小片段（“1+2”）的初始执行大约需要 2 秒，而随后的执行要快得多 - 大约 80 毫秒（我的口味仍然有点高，但这是一个不同的主题）。

Perfview 透露延迟主要是由于抖动：

[![在此处输入图像描述](../Images/42573fdfed9349aea18c5e878ea7748d.png)](https://i.stack.imgur.com/mVyQD.png)

*   Microsoft.CodeAnalysis.CSharp.dll：941ms（3,205 个方法 jitted）
*   Microsoft.CodeAnalysis.dll 426ms（1,600 个方法 jitted）

我在 Microsoft.CodeAnalysis.CSharp.dll 上使用了 ngen（由于 app.config 中的绑定重定向，请确保指定 /ExeCondig:MyApplication.exe）并获得了不错的性能改进，首次执行时间降至约 580 毫秒。

这当然需要在最终用户机器上完成。就我而言，我使用 Wix 作为我的软件的安装程序，并且在安装时[支持 NGEN-ing](http://wixtoolset.org/documentation/manual/v3/howtos/files_and_registry/ngen_managed_assemblies.html)文件。

# ajax - 用于 Codeigniter 验证的 Ajax 发布表单数据

> ID：15365378
> 
> 赞同：0
> 
> 时间：2013-03-12T15:31:16.397
> 
> 标签：ajax, codeigniter

我设置了一个 ajax 表单，我将字段传递给我的 Codeigniter 控制器进行处理。我的 ajax 看起来像这样：

```
...
dataType : 'json',
data : {
   'name' : $('#name_recipe').val(),
   'email' : $('#email').val(),   
   'town' : $('#town').val()
}, success : function (data, status){
   if(data.status != 'error') {
      $('#name').val('');
      $('#email').val('');
      $('#town').val('');
   }
   $('#response').html('<p>'+data.msg+'</p>');
} 
```

在我的控制器中，我分别处理它们，例如：

```
if(empty($_POST['name'])) {
   $status = "error";
   $msg = "The <b>Name</b> field is required.";
} else {
   $name = $_POST['name'];
}

echo json_encode(array('status' => $status, 'msg' => $msg)); 
```

但是，这会一一处理错误消息，而我真正想要的是将它们推送到一个数组中，这样我就可以一次将它们全部显示出来。我该怎么做呢？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:54:11.293

首先，您应该使用 codeigniters`input`对象访问您的表单变量。

我创建了一个数组来存储消息。如果遇到错误，则会将消息推送到阵列上。一旦所有检查完成，如果`$msg`数组大小大于零，我们就知道发生了错误。

**PHP**

```
$msg = array();

$name = $this->input->post('name');
$email = $this->input->post('email');
$town = $this->input->post('town');

if (!$name) {
    $msg[] = '<p>The <b>Name</b> field is required';
}
if (!email || !filter_var($email, FILTER_VALIDATE_EMAIL)) {
    $msg[] = '<p>The <b>Email</b> field is not valid';
}
if (!$town) {
    $msg[] = '<p>The <b>Town</b> field is required';
}

$status = count($msg) ? 'error' : 'success';

echo json_encode(array('status' => $status, 'msg' => $msg)); 
```

**成功回调中的 Javascript**

在客户端，我们为每个错误创建一个无序列表，并将其附加到`#response`.

```
var list = $('<ul />').appendTo($('#response').empty());
for (var e in data.msg) {
    $('<li />', {text: data.msg[e]}).appendTo(list);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:26:34.987

你的控制器：

```
# validate (recommend Ci validation)
$msg = '';
if (!$name) $msg .= 'The name field is required<br />';
if (!email || !filter_var($email, FILTER_VALIDATE_EMAIL)) $msg .= 'The Email field is not valid <br />';
if (!$town) $msg .= 'The Town field is required<br />';

if($msg != '') exit($msg);

# process
$this->my_model->process();

exit('success'); 
```

JS：

```
...
success : function (data) {
   if(data == 'success') {
      $('#name').val('');
      $('#email').val('');
      $('#town').val('');
   } else {
      $('#response').html(data);
   }
} 
```

# git - 拉上游合并后，奇怪的 git 行为恢复在本地分支中所做的更改

> ID：15365383
> 
> 赞同：2
> 
> 时间：2013-03-12T15:31:28.737
> 
> 标签：git, github, dvcs, git-workflow

我们有一个由大约 10 名开发人员组成的团队，我们经常遇到有人的更改意外恢复的情况。我们的工作流程非常简单。开发人员进行本地提交，从上游拉取，然后推送到上游（简而言之，这是我们的工作流程，但它也可能包括从开发人员的个人上游分支在 Github 上发出拉取请求）。奇怪的行为是开发人员进行本地提交，从上游拉取，然后发现他的更改已恢复。就好像 git 正在解决与`theirs`策略的冲突，尽管我们都没有这个设置，也没有涉及实际的合并冲突。变化更像是这样的：

本地提交：

```
.some_style {
-  width: 150px;
+  width: 100px;
  color: black;
} 
```

合并后：

```
.some_style {
  width: 150px;
  color: black;
} 
```

没有其他提交涉及这部分代码，也没有人手动解决合并冲突（无论如何都不应该存在）。在开发人员完成合并并将其推送到上游后，我们有时会看到另一个开发人员提交的差异日志，该日志似乎反转了第一个开发人员所做的更改。通常，此还原提交以其他人的名义出现，尽管他们没有触及相关文件。

其他一些开发人员的提交：

```
.some_style {
+  width: 150px;
-  width: 100px;
  color: black;
} 
```

我们不知道这是如何发生的或如何重新创建它。也许我们在某些方面缺乏 git 协作的知识，希望有人能指出我们正确的方向。

**编辑** 这个问题似乎只影响 css/scss 文件。我注意到差异标头显示了错误的信息：

```
@@ -359,10 +367,12 @@ img.badge-pic {

 #sampleProfileCover {
   float: left;
-  width: 200px;
+  width: 230px;
+  height: 150px;
   text-align: center;
   img {
     width: 200px;
+    height: 220px;
   }
 } 
```

请注意，标题将此样式标识为`img.badge-pic`. 这种风格实际上在文件中出现得更早。git 可能无法解析 css/sass 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T18:57:26.277

在`git`中，更改不会自动恢复；非常*小心*不要丢失任何东西。检查是否有人在做`git rebase`, `git push -f`（当他们的推动不起作用时，“让它起作用”，因为它不是快进），或`git reset`. 任何历史编辑都是危险的。让他们通读[git-scm](http://git-scm.com)链接的一些教程。

回顾你的工作流程，与标准的 git 工作流程和建议进行比较（周围有几个）。Git 是一个*工具*，在最好的 Unix 传统中：适用于知道自己在做什么的专家用户。所以它不会妨碍用户，并且不会试图对用户进行事后猜测。只要他们是新手，这偶尔会适得其反，但他们很快就会学会（或者沮丧地放弃;-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T05:04:53.207

我怀疑这可能是编辑器问题；也许名称在恢复提交上的开发人员的文本编辑器没有加载从上游提取的更改，因此当他保存、提交和推送他的更改时，文本编辑器最终会覆盖从 Git 引入的内容。由于它只是一种正在恢复的文件，因此这更加合理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T06:34:04.290

如果您`git push --force`向服务器发送有冲突的提交，就会发生这种情况。如果另一个冲突提交的作者立即拉取强制提交并将其合并，则这*可以*工作——他仍然附加了自己的提交，并且拉取将显示他身边的冲突（除了执行 fsck 时没有其他人会注意到 - - 有人必须进行合并。只是将其推到遗忘状态并不是解决方案，而且显然 git 的默认设置不适合普通开发人员！然后，冲突的提交将被推到一边并悬空而不是附加到提示或您的调用方式你可以通过运行 git fsck 来检查：

```
$ git fsck
Checking object directories: 100% (256/256), done.
dangling commit 4f851a97274917a1486f81833c6e96c4b1efeabc 
```

您还可以阻止您的开发人员使用`force`. 解决方案：将以下内容添加到您的存储库配置文件中：

```
[receive]
    denyNonFastForwards = true 
```

另请参阅[http://randyfay.com/content/avoiding-git-disasters-gory-story](http://randyfay.com/content/avoiding-git-disasters-gory-story)

# versioning - Neo4J 与时间限制的关系

> ID：15365387
> 
> 赞同：12
> 
> 时间：2013-03-12T15:31:33.537
> 
> 标签：versioning, neo4j, relationships, cypher

我在仅在特定时间有效的节点之间有关系。简单示例：人 P 从时间 t1 到时间 t2 住在地址 A。我可以在关系上放置一个 validFrom 和一个 validUntil 属性，但是当使用 cypher 时，我必须在 WHERE 子句中进行归档，但我希望它在 MATCH 子句中。

我希望在 MATCH 子句中使用它的原因是它可能会遍历一个大的子图，但后来才发现它的大部分可以被忽略。对于大量的历史关系尤其如此。

我可以将 validFrom 和 validUntil 关系与特定的日期节点分开。这样我就可以使用 MATCH。如果我有一组有限的此类时间节点，这将是可以的，但是当我必须存储时间戳时，这样做是不切实际的。

您如何针对此类查询优化 Cypher？如何对具有时间有效性指标的节点和关系的图形进行时间切片？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:48:36.367

您是否看过此处描述的时间线建模：http: [//docs.neo4j.org/chunked/milestone/cypher-cookbook-path-tree.html](http://docs.neo4j.org/chunked/milestone/cypher-cookbook-path-tree.html)

# php - PHP列表函数的可选参数

> ID：15365392
> 
> 赞同：11
> 
> 时间：2013-03-12T15:31:43.207
> 
> 标签：php, arrays, tuples

我的代码中有这样一行：

```
list($user_id, $name, $limit, $remaining, $reset) = explode('|', $user); 
```

最后 3 个参数可能存在也可能不存在。如果数组小于预期，是否有类似于 list 的函数会自动忽略这些最后的参数？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-03-12T15:36:54.083

```
list($user_id, $name, $limit, $remaining, $reset)
    = array_pad(explode('|', $user), 5, null); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-12T15:42:00.227

如果您担心 SDC 的解决方案会让人觉得“hacky”；然后您可以设置一些默认值并使用：

```
$user = '3|username';

$defaults = array(NULL, NULL, 10, 5, FALSE);
list($user_id, $name, $limit, $remaining, $reset) = explode('|', $user) + $defaults;

var_dump($user_id, $name, $limit, $remaining, $reset); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-12T15:33:24.073

只需在字符串的末尾添加一些备用管道：

```
list($user_id, $name, $limit, $remaining, $reset) = explode('|', $user.'||||'); 
```

问题解决了。

注意：如果您正在加载任意以管道分隔的数据，您可能希望使用[`str_getcsv()`](http://uk1.php.net/manual/en/function.str-getcsv.php)function 而不是`explode()`.

# c# - 根据键名选择枚举值

> ID：15365395
> 
> 赞同：7
> 
> 时间：2013-03-12T15:31:53.617
> 
> 标签：c#, linq, enums

我有一个像这样的枚举：

```
public enum Animals 
{ 
    CatOne = 12, 
    CatTwo = 13, 
    CatThree = 14, 
    DogOne = 21, 
    DogTwo = 22 
}; 
```

伟大的。

现在我想得到所有猫的价值。我想做的是：

```
public static int[] GetCatValues()
{

    List<int> catValues = new List<int>();

    foreach(var cat in Enum.GetNames(typeof(Animals)))
    {
        Animals animal;

        if(cat.StartsWith("Cat"))
        {
            Enum.TryParse(cat, out animal);
            catValues.Add((int)animal);
        }       
    }

    return catValues.ToArray();
} 
```

哪个工作正常。除了看起来很丑。为什么我不能做类似的事情

```
Animals
    .Select(r => (int)r)
    .Where(r => r.StartsWith("Cat"))
    .ToArray(); 
```

我知道那行不通。那么有没有更好的方法来获取以某个字符串开头的所有枚举值。

我知道我可能可以使用正则表达式来避免误报，但是，我现在保持简单。

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-12T15:38:33.670

这是一组折衷的代码 - 它不像您要寻找的那样干净，但它比 foreach 循环版本要好得多。

```
Enum.GetValues(typeof(Animals)).OfType<Animals>()
    .Where(x => x.ToString().StartsWith("Cat"))
    .Select(x => (int)x).ToArray(); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-12T15:34:06.447

那么最简单的方法就是使用以下方法获取名称`ToString`：

```
return ((Animals[]) Enum.GetValues(typeof(Animals)))
    .Where(r => r.ToString().StartsWith("Cat"))
    .Select(r => (int) r) // Assuming you want this
    .ToArray(); 
```

或使用`Cast<>`以避免强制转换为`Animals[]`：

```
return Enum.GetValues(typeof(Animals))
    .Cast<Animals>()
    .Where(r => r.ToString().StartsWith("Cat"))
    .Select(r => (int) r) // Assuming you want this
    .ToArray(); 
```

（我更喜欢`Cast<>`这里`OfType<>`，因为我们真的期望每个值都是*-*`Animals`如果有什么不是，例外是完全合适的！）

然而，这一切让我觉得有点恶心 - 重视枚举值的名称总是感觉有点毛茸茸，解析名称的特定位更是如此。您可能想尝试使用属性来装饰每个值以指定“组”。

我还建议调用枚举`Animal`而不是`Animals`- 只有基于标志的枚举通常应该是复数，并且“`Animals`值的集合”听起来很奇怪。

（另外，你可能想看看我的[Unconstrained Melody](https://code.google.com/p/unconstrained-melody/)项目，它允许通过在 IL 中合法但不能在 C# 中表达的泛型约束对枚举进行类型安全、高效的泛型访问...）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T15:38:42.477

更好的方法是使用标志。

```
[Flags]
public enum Animals 
{ 
    CatOne = 1, 
    CatTwo = 2, 
    CatThree = 4, 
    DogOne = 8, 
    DogTwo = 16,
    AllCats = Animals.CatOne | Animals.CatTwo | Animals.CatThree,
    AllDogs = Animals.DogOne | Animals.DogTwo 
}; 
```

当然，这只有在您能够重新编号您的枚举时才有效，并且在不确切知道您需要对这些值做什么的情况下，很难说它是否适合您。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T15:38:02.943

有点丑陋，但可能适合您的情况：

在这种情况下，猫将是实际的枚举而不是整数。

```
var cats = Enum.GetNames(typeof(Animals))
    .Where (e => e.StartsWith("Cat"))
    .Select (e => Enum.Parse(typeof(Animals), e)); 
```

# linux - 重新启动时忽略 SUID 位

> ID：15365397
> 
> 赞同：0
> 
> 时间：2013-03-12T15:31:56.480
> 
> 标签：linux, file-permissions

我在重启后遇到了一个 SUID 位被忽略的问题。这个问题很可能在于我对 SUID Bit 的理解。由于它们执行的功能，我需要提升目录中 python 文件的权限。这就是我所做的。

sudo find dir -type f -exec chmod u+s {} \; 这是在 python 脚本中使用 pexpect 提供密码来完成的。但是通过命令行完成时我遇到了同样的问题。

如果我然后运行 ​​ls -l -h 给出以下结果（在重新启动后完成时我得到相同的输出）

-rwsrwxrwx 1 根根。. . 文件名.py

-rwsrwxrwx 1 根根。. . 文件名.py~

-rwSr--r-- 1 用户用户。. . 文件名.pyc

在会话中设置 SUID 有效，但是一旦重新启动，SUID 位仍然存在，但似乎被忽略了。现在我认为通过 chmod 设置 SUID 位意味着用户以提升的 root 权限运行程序，并且 chmodding 通过重新启动是持久的。

我的问题是有没有办法让 SUID 位在重新启动后仍然存在而不被忽略？

对此的任何帮助都会很棒

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:26:59.093

> -rwsrwxrwx 1 根根。. . 文件名.py

真的吗？即使这是一个防火墙严密的工作站，没有其他人可以物理访问并且您是唯一的物理用户，将其留在您的文件系统上也是一个非常糟糕的主意。

> sudo find dir -type f -exec chmod u+s {} \;

这也是。

> 使用 pexpect 提供密码

...意味着root密码存储在非root用户可读的明文文件中？

我很怀疑你的分析。我经常使用 setuid 程序（尽管不是 python 脚本——我希望那时的[行为与任何其他 setuid 脚本一样](http://www.faqs.org/faqs/unix-faq/faq/part4/section-7.html)——尽管这[不能解释](https://stackoverflow.com/questions/8314012/setuid-bit-on-python-script-linux-vs-solaris)为什么它们*会*作为 setuid 工作）并且从未遇到过这样的问题。您认为重新启动时会发生什么变化？根据您的帖子，权限没有更改-因此，如果它们确实已停止以 root 身份运行，这意味着其他东西正在跟踪它是否可以以其他用户身份运行这些脚本-并且以无法生存的方式这样做重新启动 - 故事变得越来越不可能。

无论解决我提到的所有问题并可能解决您的所有问题的方法都是删除 setuid 位并通过 sudo 调用程序。

# php - ssh2 流包装器中的回调选项有什么作用？

> ID：15365402
> 
> 赞同：1
> 
> 时间：2013-03-12T15:32:16.173
> 
> 标签：php, stream, libssh2

[http://www.php.net/manual/en/wrappers.ssh2.php](http://www.php.net/manual/en/wrappers.ssh2.php)

上下文选项之一是回调，但它旁边没有描述。事实上，它是唯一旁边没有描述的上下文选项。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:42:34.170

通常回调是​​可以被 api 调用的用户函数，用于错误、异步 IO 等。更好的定义[在这里](http://en.wikipedia.org/wiki/Callback_%28computer_programming%29)。

[这里](http://board.phpbuilder.com/showthread.php?10369507-RESOLVED-Moving-files-to-and-from-remote-server-over-SSH)有一个以这种方式使用它们的代码片段。

也许[这里](http://php.net/manual/en/function.ssh2-connect.php)还有更多信息。

# ruby-on-rails - 以下链接可通过 feedzirra 获取 RSS 条目内容

> ID：15365404
> 
> 赞同：0
> 
> 时间：2013-03-12T15:32:18.743
> 
> 标签：ruby-on-rails, rss, feedzirra

我有一个 Rails 应用程序（3.2.11，Ruby 1.9.3），我正在尝试`http://www2c.cdc.gov/podcasts/createrss.asp?t=r&c=66`使用[feedzirra](https://github.com/pauldix/feedzirra)阅读提要。查看提要的源 XML，条目如下所示：

```
<item>
    <title>In the News - Novel (New) Coronavirus in the Arabian Peninsula and United Kingdom</title>
    <description>Novel (New) Coronavirus in the Arabian Peninsula and United Kingdom</description>
    <link>http://wwwnc.cdc.gov/travel/notices/in-the-news/coronavirus-arabian-peninsula-uk.htm</link>
    <guid isPermaLink="true">http://wwwnc.cdc.gov/travel/notices/in-the-news/coronavirus-arabian-peninsula-uk.htm</guid>
    <pubDate>Thu, 07 Mar 2013 05:00:00 EST</pubDate>
</item>
<item>
    <title>Outbreaks - Dengue in Madeira, Portugal</title>
    <description>Dengue in Madeira, Portugal</description>
    <link>http://wwwnc.cdc.gov/travel/notices/outbreak-notice/dengue-madeira-portugal.htm</link>
    <guid isPermaLink="true">http://wwwnc.cdc.gov/travel/notices/outbreak-notice/dengue-madeira-portugal.htm</guid>
    <pubDate>Wed, 20 Feb 2013 05:00:00 EST</pubDate>
</item> 
```

如您所见，此提要似乎并未公开条目内容，只是将 a 暴露`link`给基础文章。我的问题是，我可以使用`feedzirra`访问原始文章的内容吗？如果没有，有什么好的工具推荐吗？ `wget`? `mechanize`? `httparty`? 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T04:23:44.147

好吧，我不知道 feedzirra 是否有可能，但从我在 XML 中看到的，你能得到的只是标题和更多的片段，如描述、发布日期......，但是我可以推荐一个工具对此，您应该检查**[FeedsAPI](http://www.feedsapi.org)**，它有一个非常简单易用的 RSS Feeds API，并且可以完成您想要实现的目标。我希望这会有所帮助。

# python - Python - 查找 TTF 文件

> ID：15365405
> 
> 赞同：3
> 
> 时间：2013-03-12T15:32:18.910
> 
> 标签：python, truetype

有人可以改进吗？我对python相当陌生，正在尝试编写可移植的代码。我需要找到要传递给 ImageDraw.Draw.Text 的字体文件。

```
import matplotlib.font_manager as fontman

def findFontFile(searchFont):
    fList = fontman.findSystemFonts(fontpaths=None, fontext='ttf')
    targetFont = []
    for row in fList:
        try:
            if searchFont in row:
                targetFont.append(row)
        except TypeError:
            pass
    return targetFont[0] 
```

在我的系统上，这给了我：

```
>>> findFontFile('DejaVuSans.ttf')
'/usr/share/fonts/truetype/ttf-dejavu/DejaVuSans.ttf' 
```

这正是我需要的。这看起来是否适用于 Mac / Windows 系统以及 Linux（在 Linux 上测试）？可以更有效地完成吗？以更易读的风格？Mac / Windows 会有不同的字体文件命名格式吗？欢迎提出建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T18:39:05.470

我会做一些重写（一些变化只是风格问题，更像是python）：

```
 def find_font_file(query):
       matches = list(filter(lambda path: query in os.path.basename(path), fontman.findSystemFonts()))
       return matches 
```

然后调用者将决定要使用的元素（在检查权限等之后）。

至于兼容性，您可以[在此处](https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/font_manager.py)查看lib 使用一组“主要”操作系统的常用目录来搜索字体（X 窗口管理器（linux）、windows 和 os x）。但是，如果您有更多关于应用程序将运行的不同环境的信息，您始终可以传递要搜索的目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T05:33:50.610

做的时候要小心`if searchFont in row`。

如果某人的用户名是 marial，并且您正在搜索字体 arial，则使用`findFontFile('arial')`，您的代码将获取安装在用户主目录（即 /home/marial/.fonts）中的所有字体。

# python - 在线程中运行类方法（python）

> ID：15365406
> 
> 赞同：69
> 
> 时间：2013-03-12T15:32:19.943
> 
> 标签：python, multithreading, class, methods

我目前正在学习 Python 和类，我有一个基本问题，但我没有找到任何答案。假设我有这个虚拟课程

```
class DomainOperations:
    def __init__(self, domain):
        self.domain = domain
        self.domain_ip = ''
        self.website_thumbnail = ''

    def resolve_domain(self):
        #resolve domain to ipv4 and save to self.domain_ip

    def generate_website_thumbnail(self):
        #generate website thumbnail and save the url to self.website_thumbnail 
```

我想同时运行 resolve_domain 和 generate_website_thumbnail，当线程完成后，我想打印 IP 和缩略图。

**编辑：**我知道我应该使用线程，也许是这样的

```
r = DomainOperations('google.com')

t1 = threading.Thread(target=r.resolve_domain)
t1.start()

t2 = threading.Thread(target=r.generate_website_thumbnail)
t2.start() 
```

但是我应该在课堂之外使用它们吗？我应该写另一个类来处理线程吗？

这样做的**正确方法**是什么？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-03-12T15:39:04.610

如果你从课堂上调用它们，它很简单：

```
import threading

class DomainOperations:

    def __init__(self):
        self.domain_ip = ''
        self.website_thumbnail = ''

    def resolve_domain(self):
        self.domain_ip = 'foo'

    def generate_website_thumbnail(self):
        self.website_thumbnail= 'bar'

    def run(self):
        t1 = threading.Thread(target=self.resolve_domain)
        t2 = threading.Thread(target=self.generate_website_thumbnail)
        t1.start()
        t2.start()
        t1.join()
        t2.join()
        print(self.domain_ip, self.website_thumbnail)

if __name__ == '__main__':
    d = DomainOperations()
    d.run() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-09-06T19:06:06.707

您可以在 DomainOperation 中继承 Thread 类，这样代码会更干净，更容易理解。您必须覆盖*run()*方法。

```
from threading import Thread

class DomainOperations(Thread):
    def __init__(self, *args, **kwargs):
       super().__init__(*args, **kwargs)
       self.domain_ip = ''
       self.website_thumbnail = ''

   def resolve_domain(self):
       self.domain_ip = 'foo'

   def generate_website_thumbnail(self):
       self.website_thumbnail= 'bar'

   def run(self):
       #domain will be resolved on first thread
       self.resolve_domain()
       #thumbnail will be resolved on second OR newly created below thread
       thread2 = Thread(target=self.generate_website_thumbnail)
       thread.start()
       # thread1 will wait for thread2
       self.join()
       # thread2 will wait for thread1, if it's late.
       thread2.join()
       # here it will print ip and thumbnail before exiting first thread
       print(self.domain_ip, self.website_thumbnail) 
```

你将以这种方式开始你的线程。

```
if __name__ == '__main__':
   thread1 = DomainOperations()
   thread1.start() 
```

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2018-12-29T04:11:45.687

```
def post_test(tbid, line_num, response_time):
    """
    :param tbid: 参数id
    :return:
    """

    # 请求参数
    data = {'tbId': tbid, 'conditions': [{"key": "", "type": 1}], 'pageNum': 1, 'pageSize': 12}
    # 请求启动时间

    start = time.time()
    # post请求
    r = requests.post(url=url, data=json.dumps(data), headers=headers)
    # 请求结束时间
    end = time.time()
    # 保留两位小数
    finall_time = float('%.2f' % float(end - start))
    text = json.loads(r.text)
    # IO写入 只写入200的
    with open('text6.csv', 'a', newline='') as csvfile:
       if text['statusCode'] == '200':
        throughput = line_num * response_time / finall_time
        throughput = float('%.2f' % float(throughput))
        print('the perf_counter time of %s is %s and the content is %s ,throughput is %s' % (
            tbid, finall_time, json.loads(r.text), throughput))
        spamwriter = csv.writer(csvfile, dialect='excel')
        spamwriter.writerow([tbid] + [finall_time] + [throughput])
def start_thread(csv_name):
  tbid, response_time_sort, throughput_sort = read_csv(csv_name)
  print(tbid)
  line_num = len(tbid)
  response_times = 5

  for j in range(response_times):
    for i in tbid:
        t = threading.Thread(target=post_test, args=(i, line_num, response_times))
        t.start()
        t.join() 
```

我不知道如何调用类中的方法，特别是如果它有初始化参数，但你可以试试这个方法。我正在尝试使用多个进程来解决这个问题，对。</p>

# java - 如何在 Apache Camel 中创建多个和发送多个交换

> ID：15365408
> 
> 赞同：0
> 
> 时间：2013-03-12T15:32:20.757
> 
> 标签：java, jakarta-ee, apache-camel, eip

我有一种情况，我在我的骆驼生产者中生成一个任务列表，然后我需要发送包含这些单个任务中的每一个的多个交换，以便下一个组件可以处理它。

Camel中是否有任何模式或生产者可以满足我的目的。

我知道有 DefaultTemplateProducer，但我在路由中的下一部分是处理器，它没有指向的端点，所以它对我没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T04:45:02.957

您也许可以使用分切器模式来拆分列表并将其发送到路径上？

[阿帕奇骆驼分离器](http://camel.apache.org/splitter.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T08:13:38.970

它有点不清楚你想要什么。也许更详细地解释你的问题。还要确保了解并阅读 Camel 提供的企业集成模式：http: [//camel.apache.org/eip](http://camel.apache.org/eip)

正如 U2one 所说，根据您的问题，拆分器模式可能是一个好的开始。

# excel - 在指定列的最后一个单元格中找到一个值（根据其标题）

> ID：15365409
> 
> 赞同：0
> 
> 时间：2013-03-12T15:32:20.843
> 
> 标签：excel, vba

我有一个（对我来说）棘手的任务要做。我想创建一个宏，它将在指定列的最后一个单元格中找到一个值（根据其标题）。例如，它将在名为“test”的列中找到最后一个值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:50:50.227

对你来说很棘手是因为你没有尝试，还是因为你尝试了但无法弄清楚？如果您先提供您的代码总是很好的，这样我们就可以看到您到底在做什么以及我们如何帮助它工作。

无论如何，这是我放在一起的东西，可以满足您的要求。它假设我们将在 中搜索`Sheet 1`。在 中`Visual Basic Editor (VBE)`，打开`Sheet1`并粘贴此代码。然后，您可以像使用常规宏一样使用它（确保更改 headerrow 值和搜索字符串以满足您的需要）。

**代码**

```
Public Sub FindValueInColumn()

    Dim headerRow As Integer
    Dim totalColumnsInHeaderRow As Integer
    Dim searchColumn As Integer
    Dim lastRowInSearchColumn As Integer
    Dim columnSearchString As String

    headerRow = 1   'change this to correct header row
    totalColumnsInHeaderRow = Cells(headerRow, Columns.Count).End(xlToLeft).Column
    columnSearchString = "Test" 'change to the text to search
    searchColumn = 0

    'for every column that has a value in it in the header row
    Dim currentColumn As Integer
    For currentColumn = 1 To totalColumnsInHeaderRow
        'if that value equals what we're looking for (in this case, "Test")
        If StrComp(Cells(headerRow, currentColumn).Value, columnSearchString, vbTextCompare) = 0 Then
            'save the column that contains the value, then exit the loop
            searchColumn = currentColumn
            Exit For
        End If
    Next

    'if the column of interest exists in the header row
    If searchColumn > 0 Then
        'Set F2 equal to the last value in that column
        lastRowInSearchColumn = Cells(Rows.Count, searchColumn).End(xlUp).Row
        Range("F2").Value = Cells(lastRowInSearchColumn, searchColumn).Value
    End If

End Sub 
```

**前**

![在此处输入图像描述](../Images/85da66e16faec04179e35214bd1df9bd.png)

**后**

![在此处输入图像描述](../Images/e2389b4df92738e52cabb178557d08a8.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:13:09.503

我真的很喜欢看到不同的编码风格。显然，给这只猫剥皮的方法不止一种。

```
Sub Last_Cell_In_Column()
   Dim sh As Worksheet
   Dim col As Long

   Set sh = ThisWorkbook.ActiveSheet
   col = 0
   col = sh.Rows(1).Find("test").Column
   If col > 0 Then
      MsgBox (sh.Cells(sh.Rows.Count, col).End(xlUp).Value)
   End If
End Sub 
```

# directshow - DirectShow IBaseFilter EnumPins 不返回任何内容

> ID：15365415
> 
> 赞同：2
> 
> 时间：2013-03-12T15:32:31.450
> 
> 标签：directshow, directshow.net

使用 GraphEdit，我可以将过滤器添加到编辑器并使用它来渲染视频。当我通过 COM（使用 DirectShow.NET）创建实例时，方法 EnumPins（后跟 Next 检查）不返回任何引脚。

为什么 GraphEdit 会显示引脚而我无法通过 COM 接口获得对引脚的引用，这是有原因的吗？

编辑：这是我用来获取第一个可用引脚（任何类型）的方法。此过滤器没有返回任何内容，但我可以在图形编辑中看到 4 个引脚（两进两出）。

```
public static IPin GetPins(IBaseFilter vSource, int iIndex)
{
    IEnumPins pins;
    var ppPins = new IPin[1];
    if (vSource == null)
        return null;
    DsError.ThrowExceptionForHR(vSource.EnumPins(out pins));
    try
    {
        while (pins.Next(1, ppPins, IntPtr.Zero) == 0)
        {
            return ppPins[0];
        }
    }
    finally
    {
        Marshal.ReleaseComObject(pins);
    }
    return null;
} 
```

# c# - 默认参数 PageSize A4 C# 使用 itextsharp

> ID：15365416
> 
> 赞同：4
> 
> 时间：2013-03-12T15:32:32.040
> 
> 标签：c#, asp.net-mvc, visual-studio-2010, itextsharp, default-parameters

是否可以在 C# 中为 PageSize 的默认参数设置值？例如：

```
public virtual void Render(string reportTitle, Rectangle pageSize = PageSize.A4)
{
    foreach (Page p in pages)
    {
        p.Render(document);
        document.NewPage();
        document.AddCreationDate();
        document.AddTitle(reportTitle);
        document.SetPageSize(pageSize);
    }
} 
```

我在 Visual Studio 2010 中出现以下错误：

> “pageSize”的默认参数值必须是编译时常量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:39:11.233

当你写作时；

```
Rectangle pageSize = PageSize.A4 
```

您的`pageSize`值可以作为参数更改。

从[`Named and Optional Arguments`](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

> 默认值必须是以下表达式类型之一：
> 
> *   一个常量表达式；
>     
>     
> *   new ValType() 形式的表达式，其中 ValType 是值类型，例如枚举或结构；
>     
>     
> *   default(ValType) 形式的表达式，其中 ValType 是值类型。

该表达式`PageSize.A4`未被归类为*[编译时常量](https://stackoverflow.com/questions/4485682/c-what-does-compile-time-const-mean)*。

# php - 如何使变量发送不同的电子邮件？

> ID：15365420
> 
> 赞同：0
> 
> 时间：2013-03-12T15:32:49.453
> 
> 标签：php

我的网站上有不同的表格可以向我发送电子邮件。这些表单中的每一个都有自己单独的 .php 文件，所以我认为如果我只有一个 php 文件将电子邮件发送给我，那将是一个好主意。

我计划这样做的方式是在我的表单上隐藏具有唯一 ID 的输入。php 获取该 id 并根据 id 等于什么，php 将向我发送不同的电子邮件。

这是我正在使用的代码：

```
<?php
$to .= 'myemailadress@mydomain.com';

$feedback_page = "feedback.html";
$error_page = "error_message.html";
$thankyou_page = "thank_you.html";

$form_id = $_REQUEST['form_id'] ; /* This is what will determine the email message */

$first_name = $_REQUEST['first_name'] ; /*This is what picks up what the person wrote */
$last_name = $_REQUEST['last_name'];
$email_adress = $_REQUEST['emai_address'];

if (!isset($_REQUEST['email_address'])) {
header( "Location: $feedback_page" );
}

elseif (empty($email_adress)) {
header( "Location: $error_page" );
}

else {
    $mailmsg = "
    Name: $first_name $last_name
    Email: $email_address
    ";

$headers .= 'From: forms@mydomain.com' . "\r\n";
$headers .= 'Bcc: otheremail@mydomain.com' . "\r\n";

mail( "$to", $form_name , $mailmsg , $headers );
header( "Location: $thankyou_page" );
}
?> 
```

我可以添加什么到此代码中，以根据我提到的 ID 输入更改它发送的电子邮件？

当我输入代码时，我认为一种可能的方法是设置不同的电子邮件消息，如 $mailmsg1 或 $mailmsg2 并在 mail() 内部放入一些变量来确定发送的邮件消息。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:39:11.740

我将使用相应`switch`设置的 PHP 语句来实现它`$mailmsg`。像这样的东西（未经测试）：

```
switch ($form_id) {
    case "1":
        $mailmsg="Something"; // Message 1
        break;
    case "2":
        $mailmsg="Something else"; // Message 2
        break;
    default:
        $mailmsg="Default message";
        break; 
```

另外，请注意，您可能在下面的请求中有错字：

```
$email_adress = $_REQUEST['emai_address']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:37:30.917

您可以进行的最基本更改是`if..else`在设置消息正文文本的部分中放置一个，并测试`$form_id`您在隐藏的输入元素中设置的表单 ID。

我在这里只包括了最后一部分：

```
// ... first part of the code ommited
else
{
   if($form_id === SOME_ID_1)
   {
        // set here the message for form id 1

        $mailmsg = "
            Name: $first_name $last_name
            Email: $email_address
        ";
   }else if($form_id === SOME_ID_2)
   {
        // set here the message for form id 2
        $mailmsg = "
           ... WHATEVER MESSAGE YOU'D LIKE FOR FORM 2
        ";
   }else{
        // set here a default message if you want or redirect to error page

   }

   $headers .= 'From: forms@mydomain.com' . "\r\n";
   $headers .= 'Bcc: otheremail@mydomain.com' . "\r\n";

   mail( "$to", $form_name , $mailmsg , $headers );
   header( "Location: $thankyou_page" );
} 
```

但可能更好的抽象是将用于发送电子邮件的所有代码实际移动到一个函数中，并根据不同的消息和/或主题调用它`$form_id`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:39:41.170

您可以创建一个 switch case 语句，选择正确的电子邮件地址发送到：

```
$mailMessage = "";
switch ($form_id) {
    case 0:
        $mailMessage += "Hello Son,";
        $mailMessage += "Goodbye";
        break;
    case 1:
        //Same here as above
        break;
    case 2:
        //Same here as case 0
        break;
}

mail( "$to", $form_name , $mailMessage, $headers ); 
```

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:40:27.347

只发回您的同一个表单，验证表单并在那里生成消息会更干净。从那时起，您可以将消息发送到您决定使用的任何电子邮件处理脚本。

# sql - 我可以为另一个查询定义的不同值在 Oracle SQL 中重复联合联接吗？

> ID：15365422
> 
> 赞同：0
> 
> 时间：2013-03-12T15:32:50.807
> 
> 标签：sql, oracle, oracle10g, union

我有以下查询，它根据每个程序的标记返回一组用户的十分位数：

```
SELECT prog_code,
    user_code,
    user_mark,
  NTILE(10) over (order by user_mark DESC) DECILE
FROM grade_result
where user_mark IS NOT NULL
and prog_year = '2011'
AND prog_code = 'ALPHA' 
```

我需要同时运行总共 40 个不同的 prog_code 值，这些值可以通过 39 个联合连接连接在一起，但这似乎非常低效（我不能将它作为单个 select 语句运行，因为 decile 将是对于*所有*程序，而不是按程序）。有没有一种方法可以让查询重复（循环？）这 40 个值中的每一个作为一个联合，而不必自己输入每个值？

如果有任何用途，我可以在单独的查询或子查询中返回程序代码和 rownum：

```
ROWNUM         PROG_CODE

1              ALPHA
2              BETA
3              GAMMA
4              DELTA
5              ECHO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:43:44.833

Can you simply use the partition clause in your NTILE function?

```
SELECT prog_code,
    user_code,
    user_mark,
  NTILE(10) over (PARTITION BY prog_code ORDER BY user_mark DESC) DECILE
FROM grade_result
where user_mark IS NOT NULL
and prog_year = '2011'; 
```

# mysql - 对 200 万个条目表的慢 MySQL 查询

> ID：15365432
> 
> 赞同：1
> 
> 时间：2013-03-12T15:33:20.470
> 
> 标签：mysql, performance

我正在尝试以下查询：

```
SELECT post_id, meta_key, meta_value FROM wp_postmeta WHERE post_id IN (2167635,2167638,2182793,2182800,2195791,2195809,2208830,2208837,2212480,2212486) 
```

在 200 万个 wp_postmeta 表中。使用解释表明我正在使用现有的 post_id 索引。但是加载需要 5 秒（这几乎是不可接受的）。

关于如何优化该查询的任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:14:32.790

我认为你应该为`post_id`列添加一个索引，结果会更快，它们将被索引。

```
 ALTER TABLE `wp_postmeta` ADD INDEX `post_id` (`post_id`) 
```

# c# - Telerik：RadWindow IE 问题

> ID：15365437
> 
> 赞同：0
> 
> 时间：2013-03-12T15:33:27.900
> 
> 标签：c#, javascript, asp.net, telerik

我想展示 RadWindow2。它在 Chrome、Mozilla 中显示，但在 IE9 和 IE10 中不显示。如何解决这个问题？

js

```
function Show() 
{
    var oWnd = $find("<%= RadWindow2.ClientID %>");
    oWnd.show();
} 
```

aspx

```
 <asp:LinkButton ID="LinkButton1" runat="server" onClientclick="Show()">Change
 </asp:LinkButton> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:43:19.553

1）确保您取消回发：

```
<asp:LinkButton ID="LinkButton1" runat="server" 
OnClientclick="Show(); return false;">Change
 </asp:LinkButton> 
```

2) 确保您使用支持 IE9 和 IE10 的版本。那将分别是 2011 年第一季度和 2012 年第三季度。否则你会得到一个 JS 错误。

# types - 如何重用 VALUE= html 表单

> ID：15365438
> 
> 赞同：0
> 
> 时间：2013-03-12T15:33:40.633
> 
> 标签：types

以后可以在表单中重用类似人名的东西吗？

```
<p>Question 1.) Name:<input type="text" name="Applicant_Name" /></p>

<p>Question 45.) Re-type your name: <input type="????" value="Applicant_Name" /></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:18:29.370

好吧，为了填充到其他文本字段，重用在文本字段中输入的文本。你需要一点点`javascript`你`HTML`喜欢的波纹管：

```
<!DOCTYPE html>
<html>
   <head>
     <script type = "text/javascript">
       function myFunction(currElement, idOflname){
          var x=document.getElementById(idOflname);
          x.value=currElement.value;
       }
     </script>
  </head>
  <body>

      <form action="yourAction">
        Enter your name: <input type="text" id="fname" onkeyup='myFunction(this, "lname")'><br>
        Last name: <input type="text" id="lname" name="lname"><br>
        <input type="submit" value="Submit">
      </form>
 </body>
</html> 
```

您可以编写一个 javascript 函数（此处为`myFunction`），它将第一个文本字段的内容放到第二个文本字段中。您需要在`onkeyup`第一个文本字段中调用此函数。

希望这能回答你的问题！

# entity-framework - 如何使用 Code First 为实体框架设置 ProviderManifestToken？

> ID：15365439
> 
> 赞同：0
> 
> 时间：2013-03-12T15:33:45.310
> 
> 标签：entity-framework, ef-code-first

我们首先使用 EF 4.1 和代码。虽然我们的生产数据库是 SQL Server 2005，但我们的一些开发人员在本地拥有 SQL Server 2008。我们的 TFS 构建服务器也是 2008。在本地和构建服务器上运行单元测试时，由于 datetime 和 datetime2 之间的差异，我们遇到了问题。即使数据库上的列是“datetime”，使用 SQL Profiler 我们可以看到 EF 将该列视为“datetime2”。

我看到文章提到我们应该将 EDMX 文件中的 ProviderManifestToken 设置为 2005 来解决这个问题，但我们首先使用的是 EF 代码。有没有办法先使用代码解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T16:32:06.163

对于 EF5 Code First，它不仅仅是更改 xml 中的字符串。看看这篇博文[。](http://blog.oneunicorn.com/2012/04/21/code-first-building-blocks/)它包含一个显式设置提供者清单令牌的示例。在 EF6 中，您可以设置只配置返回提供程序清单令牌的解析器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-08T04:23:26.457

[看到这个](https://stackoverflow.com/a/8044310/8555245)

只需使用`datetime`而不是`datetime2`. 它适用于我的项目。

# jmeter - 从访问日志中复制关于时间戳差异的负载（Jmeter 或类似）

> ID：15365442
> 
> 赞同：2
> 
> 时间：2013-03-12T15:33:49.170
> 
> 标签：jmeter, load-testing, jmeter-plugins

**语境**

我正在使用 JMeter 和 JMeter-plugins 进行负载测试。到目前为止，我要么自己建模流量（加速期、突发等），要么只是进行全负载测试。但是，现在我需要重现与访问日志中完全相同的流量，例如，如果我在 13:00:01、13:00:03 和 13:00:06 有三个请求，我将需要采样器在相同的时间命中这些相应的请求，第二个是在第一个之后 2 秒，第三个是在第二个之后 3 秒。

我上网寻找解决方案，但我得到的唯一提示是编写自定义 LogParser 来提取时间戳和时间差。然而，这并没有涵盖样本发送请求的实际时间，因为它存储在 ThreadGroup 中。

**概括**

这引出了我的问题：如何重现与访问日志中相同的流量（关于请求之间的时间差异）？我不想模拟一个类似的模型（比如高斯等），我需要一个精确的流量副本。

如果在 JMeter 中不可能，请指导我使用正确的工具。

# c - 如何处理 libxml2 解析器错误

> ID：15365451
> 
> 赞同：0
> 
> 时间：2013-03-12T15:34:06.470
> 
> 标签：c, libxml2

我必须对 libxml2 使用 xsd（模式）验证，我可以为错误处理设置回调，用于模式验证错误，使用：xmlSchemaSetValidErrors()。

但在进行模式验证之前，我必须解析我的 xml，以获取 xmlDocPtr，例如使用 xmlParseMemory。但是：如果 xml 无效，如何设置错误处理程序以获取这些错误？（我不希望它们被打印到 stderr）我没有为解析函数找到类似于 xmlSchemaSetValidErrors 的函数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T18:38:19.563

您可以使用[`xmlSetStructuredErrorFunc`](http://www.xmlsoft.org/html/libxml-xmlerror.html#xmlSetStructuredErrorFunc)和[`xmlSetGenericErrorFunc`](http://www.xmlsoft.org/html/libxml-xmlerror.html#xmlSetGenericErrorFunc)。这些全局设置错误回调，因为正如您所指出的，此时不会有任何 xmlDocPtr 上下文。

[http://www.xmlsoft.org/html/libxml-xmlerror.html](http://www.xmlsoft.org/html/libxml-xmlerror.html)

# wordpress - 301重定向：删除中间文件夹结构但保留结束文件

> ID：15365452
> 
> 赞同：2
> 
> 时间：2013-03-12T15:34:07.133
> 
> 标签：wordpress, .htaccess, redirect, http-status-code-301

WordPress 安装。

索引文件 = [http://www.mydomain.com/blog/somecontent](http://www.mydomain.com/blog/somecontent)

新结构 = [http://www.mydomain.com/somecontent](http://www.mydomain.com/somecontent)

需要在 1000 个页面中删除 /blog/ 和 301 重定向到 /somecontent。

任何帮助将不胜感激，因为谷歌已经索引了以前的 /blog/ 网站结构，现在在新的 url 上给出了 404。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:40:36.473

您必须做的第一件事是转到 Wordpress 设置并更改 WP 安装路径，`/somecontent`然后将此代码放在**常规 WP 内容上方的**`.htaccess`目录`DOCUMENT_ROOT`中：

 **```
RewriteRule ^blog/(.*)$ /$1 [R=301,L,NC] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:36:43.027

假设您启用了 mod_rewrite，您可能会尝试类似于

```
RewriteRule ^blog/somecontent/(.*)$ http://example.com/somecontent/$1 [R=301,L] 
```

这假定两个文件夹下的结构相同。**

# ruby-on-rails - 如何为模型制作助手

> ID：15365454
> 
> 赞同：0
> 
> 时间：2013-03-12T15:34:11.073
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的用户模型中有这个私有方法

```
class User < ActiveRecord::Base
  attr_accessible :email, :fullname, :password, :username
  has_secure_password
  before_create { generate_token(:remember_token) }
  .
  .
  private
    def generate_token(col)
      begin
        self[col] = SecureRandom.urlsafe_base64
      end while User.exists?(col => self[col])
    end

end 
```

如何使 generate_token 在其他模型中可用？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:50:47.307

几种方法：

*   稍微依赖：

做：

```
class User < ActiveRecord::Base

  before_create { User::Helpers.new(self).generate_token(:remember_token) }

  class Helpers < Struct.new(:user)
    def generate_token(col)
      begin
        user.send("#{col}=", SecureRandom.urlsafe_base64)
      end while User.exists?(col => user.send(col))
    end
  end
end 
```

*   独立：不要将`user`对象传递给类，只需让方法渲染一个随机标记并从模型中分配它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:51:10.470

这里有很多选择：

*   使用简单的 ruby​​ 模块。

    ```
    module TokenRememberable
      private
      def generate_token(col)
        begin
          self[col] = SecureRandom.urlsafe_base64
        end while User.exists?(col => self[col])
      end 
    end

    class User < ActiveRecord::Base
      include TokenRememberable
      before_create { generate_token(:remember_token) }
    end 
    ```

*   对于更复杂的功能，使用 ActiveSupport::Concern ：

    ```
    module TokenRememberable
      extend ActiveSupport::Concern

      # thanks to Concern, this block wil be evaluated 
      # in the context of the including class
      included do 
        before_create { generate_token(:remember_token) }
      end

      private
      def generate_token(col)
        begin
          self[col] = SecureRandom.urlsafe_base64
        end while self.class.exists?(col => self[col])
      end 
    end

    class User < ActiveRecord::Base
      include TokenRememberable
    end 
    ```

*   在专用类中提取功能，并可能使用组合

    ```
    # we only need a class method here, but you can also build 
    # full-fledged objects as you need
    class TokenGenerator 
      def self.generate_token
        # your generation logic here
      end  
    end

    class User
      def after_initialize
        @token_generator = TokenGenerator # or TokenGenerator.new( self ), for instance
      end
      attr_reader :token_generator
      delegate :generate_token, to: :token_generator # optionnaly use delegation
    end 
    ```

**注意**：这不是真正的 Rails 问题，更多的是 Ruby 问题。你应该更多地记录你所使用的语言......模块是一个非常常见的习语。如果你需要，我可以给你一些很好的参考书

# python - 用 2 个键排序并结合两者

> ID：15365461
> 
> 赞同：0
> 
> 时间：2013-03-12T15:34:32.110
> 
> 标签：python, list, sorting, python-3.x, indexing

我有一个名为“name_score_smiles.csv”的文件，如下所示：

```
('VA00001', '64.11', '33.12', 'Cl.O=C1Nc2ccc(N)cc2C1')
('VA00002', '70.61', '54', 'CNCCC(=O)c1ccccc1')
('VA00003', '53.15', '57.76', 'O=c1[nH]c2cnccc2n1c1ccccc1')
('VA00004', '72.08', '41.82', 'CN1CCC(CC1)Nc1ccc(F)c(Cl)c1')
('VA00005', '67.11', '57.17', 'CCN1CCC(CC1)Nc1ccc(Cl)cc1')
('VA00006', '66.29', '48.66', 'O=C1Nc2cc3OCCOc3cc2C(C1)c1ccccc1')
('VA00007', '70.59', '40.31', 'C=CCC1(CCCCC1)NCCc1ccccc1')
('VA00008', '62.87', '43.29', 'Clc1cccc(CN2CCN(CC2)Cc2c[nH]c3ccccc23)c1')
('VA00009', '70.53', '27.3', 'Clc1cccc(CNCCc2c[nH]c3ccccc23)c1')
('VA00010', '67.15', '51.88', 'O=C(Nc1ccccc1)N1CCCCC1c1cccnc1')
... 
```

我已将其作为列表列表读入，并且我知道如何根据第二列或第三列对该文件进行排序。到目前为止，我的脚本如下所示：

```
with open('name_score_smiles.csv') as fin:
        lst = list(csv.reader(fin))

lst_20 = sorted(lst, key=lambda x:float(x[1]), reverse=True) 
```

我想做的是：我想根据第二列对我的列表进行排序并保存排名。然后按照第三列排序，保存排名。这样最后我就可以根据两列中的排名对整个文件进行排序。清楚我的意思吗？

谢谢大家的回答！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:36:49.280

通常你会使用一个`tuple`或其他一些序列作为排序键，如下所示：

```
sorted(lst, key=lambda x: (float(x[1]),float(x[2])), reverse=True) 
```

在排序结束时，您将通过递减第 2 列对项目进行排序。如果第 2 列中的值相等，则将使用第 3 列的比较。

# java - 无法在 java 代码中使用 wkhtmltopdf 属性

> ID：15365462
> 
> 赞同：2
> 
> 时间：2013-03-12T15:34:38.837
> 
> 标签：java, process, wkhtmltopdf, processbuilder

我正在使用 wkhtmltopdf 转换器将 html 文件转换为 pdf。它工作正常，只是输出不适合 pdf 中的页面。使用 --zoom 2 解决了命令行中的问题，但在我的代码中使用它并没有做任何事情。下面是我的代码。

```
String wkhtmltopdf = "C:/Program Files (x86)/wkhtmltopdf/wkhtmltopdf.exe ";
String switches = " --zoom 2 ";

ProcessBuilder pb = new ProcessBuilder(wkhtmltopdf, switches, f.getAbsolutePath(), pdfFileName);

Process process = pb.start(); 
```

在命令行中，这工作得很好。

```
C:\Program Files (x86)\wkhtmltopdf>wkhtmltopdf.exe --zoom 2 C:\Users\D
esktop\eclipse-jee-indigo-SR2-win32-x86_64\eclipse\temphtml1.htm C:\Users\Desktop\temp\test.pdf
Loading pages (1/6)
Counting pages (2/6)
Resolving links (4/6)
Loading headers and footers (5/6)
Printing pages (6/6)
Done 
```

有人可以让我知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-27T18:31:15.407

如[OSX 上的 ProcessBuilder 中](https://stackoverflow.com/questions/9826909/processbuilder-on-osx)所述，您需要将每个参数组作为单独的字符串传递。所以不是传递“--zoom 2”，而是传递[“--zoom”，“2”]。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T20:27:39.337

使用 Runtime 代替 processBuilder 修复了它。我仍然不知道为什么“--zoom 2”没有作为processBuilder中的参数除外。但是，下面是工作代码。

```
Runtime rt = Runtime.getRuntime();
Process p = rt.exec(
  "C:/Program Files (x86)/wkhtmltopdf/wkhtmltopdf.exe --zoom 2 " 
    + temphtmlfile.getAbsolutePath()
    + " " 
    + filePdf.getAbsolutePath()) ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-11T09:57:21.760

我对参数有同样的问题，`--cookie <name> <value>`我发现，使用`ProcessBuilder`我必须传递 3 个分隔的字符串值`--cookie, <name>, <value>`。

你将不得不更换

```
ProcessBuilder pb = new ProcessBuilder(wkhtmltopdf, switches, f.getAbsolutePath(), pdfFileName); 
```

经过

```
ProcessBuilder pb = new ProcessBuilder(wkhtmltopdf, "--zoom", "2", f.getAbsolutePath(), pdfFileName); 
```

* * *

请注意，ProcessBuilder 有一个更方便的构造函数，它可以采用`List<String>`

# css - Safari 中不显示背景颜色

> ID：15365463
> 
> 赞同：0
> 
> 时间：2013-03-12T15:34:51.840
> 
> 标签：css, safari

我一生都无法弄清楚为什么视频右侧顶部滑块上的灰色背景没有出现在 safari 中。css 看起来不错，可以在其他浏览器中使用。有人有聪明的主意吗？谢谢 [http://www.cope24.com/](http://www.cope24.com/) 这是 Safari 5.1.7。![火狐的截图](../Images/b60a85a106c32aeb33f191a86747b099.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:42:49.337

Reduce the width on `<div id="maintext">` by a few pixels and it shows up just fine on Chrome & Safari .. and FF 19 + IE 9

Also you're using the deprecated `iFrame` frameborder attribute .. get rid of that

* * *

420px (what it is currently):

[![](../Images/91f5ec8295788336aa2f3f7d7b75b44d.png)](https://i.stack.imgur.com/0ucr3.jpg)

418px:

[![](../Images/efe0b5b1b8e5552476773ca8ba53a37b.png)](https://i.stack.imgur.com/JqXEN.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:48:21.233

您只需要浮动 iframe 以便它和 DIV 并排显示。

只需添加：

```
.content iframe {float:left;} 
```

# algorithm - 从顶点初始化半边数据结构

> ID：15365471
> 
> 赞同：26
> 
> 时间：2013-03-12T15:35:12.557
> 
> 标签：algorithm, c++11, data-structures, polygon, computational-geometry

我正在实现各种细分算法（例如 catmull-clark）；要有效地做到这一点，需要一种很好的方法来存储有关镶嵌多边形网格的信息。我实现了[flipcode概述的半边](http://www.flipcode.com/archives/The_Half-Edge_Data_Structure.shtml)数据结构，但现在我不确定如何从顶点填充数据结构！

我最初的尝试是

*   创建顶点
*   将顶点分组为面
*   对面内的顶点进行排序（使用它们相对于质心的角度）
*   对于每个面，抓取第一个顶点，然后遍历排序的顶点列表以创建一个半边列表。

但是，这会创建一个没有关于相邻面的任何信息的面列表（带有半边）！这也感觉有点不对劲，因为看起来人脸真的是第一类对象，边缘提供了辅助信息；我真的觉得我应该从顶点创建边缘，然后从那里整理出面。但是同样，我不确定如何以这种方式进行 - 我想不出一种方法来创建半​​边列表而不先创建面。

关于将顶点（和面）的数据转换为半边的最佳方法有什么建议吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-12T16:16:59.403

首先，我想向您指出半边数据结构的一个出色的 C++ 实现：[OpenMesh](http://www.openmesh.org/)。如果您想使用它，请确保您按照教程进行操作。如果（且仅当）您这样做，使用 OpenMesh 将非常简单。它还包含一些不错的方法，您可以在这些方法之上实现细分或归约算法。

现在回答你的问题：

> 但是，这会创建一个没有关于相邻面的任何信息的面列表（带有半边）！这也感觉有点不对劲，因为看起来人脸真的是第一类对象，边缘提供了辅助信息

我认为这有点忽略了半边数据结构的要点。在半边结构中，承载信息最多的是半边！

从[OpenMesh 文档](http://openmesh.org/Documentation/OpenMesh-Doc-Latest/mesh_hds.html)中无耻地引用（另见那里的图）：

*   每个顶点引用一个输出半边，即从该顶点开始的半边。
*   每个面都引用围绕它的半边之一。
*   每个半边提供一个句柄
    *   它指向的顶点，
    *   它所属的脸
    *   面内的下一个半边（逆时针顺序），
    *   对面的半边，
    *   （可选：面中的前一个半边）。

如您所见，**大多数信息都存储在半边中**- 这些是主要对象。在这个数据结构中迭代网格就是巧妙地遵循指针。

> 但是，这会创建一个没有关于相邻面的任何信息的面列表（带有半边）！

这完全没问题！正如您在上面看到的，一个面**仅**引用一个边界半边。假设一个三角形网格，您遵循的指针链将 3 个相邻三角形指向给定面`F`如下：

`F -> halfEdge -> oppositeHalfEdge -> face`

`F -> halfEdge -> nextHalfEdge -> oppositeHalfEdge -> face`

`F -> halfEdge -> previousHalfEdge -> oppositeHalfEdge -> face`

或者，`nextHalfEdge -> nextHalfEdge`如果您不使用“以前的”指针，则可以使用。当然，这很容易推广到四边形或更高阶的多边形。

如果您在构建网格时正确设置了上面列出的指针，那么您可以像这样遍历网格中的各种邻接。如果你使用 OpenMesh，你可以使用一堆特殊的迭代器来为你追逐指针。

当从“三角形汤”构建半边结构时，设置“对边半边”指针当然是棘手的部分。我建议使用某种地图数据结构来跟踪已经创建的半边。

更具体地说，这里有一些**非常概念性的伪代码**，用于从面创建半边网格。顶点部分我省略了，比较简单，可以本着同样的精神来实现。我假设对面边缘的迭代是有序的（例如顺时针方向）。

我假设半边被实现为 type 的结构`HalfEdge`，其中包含上面列出的指针作为成员。

```
 struct HalfEdge
   {
      HalfEdge * oppositeHalfEdge;
      HalfEdge * nextHalfEdge;
      Vertex * vertex;
      Face * face;
   } 
```

让我们`Edges`成为从顶点标识符对到指向实际半边实例的指针的映射，例如

```
map< pair<unsigned int, unsigned int>, HalfEdge* > Edges; 
```

在 C++ 中。这是构造伪代码（没有顶点和面部分）：

```
map< pair<unsigned int, unsigned int>, HalfEdge* > Edges;

for each face F
{
   for each edge (u,v) of F
   {
      Edges[ pair(u,v) ] = new HalfEdge();
      Edges[ pair(u,v) ]->face = F;
   }
   for each edge (u,v) of F
   {
      set Edges[ pair(u,v) ]->nextHalfEdge to next half-edge in F
      if ( Edges.find( pair(v,u) ) != Edges.end() )
      {
         Edges[ pair(u,v) ]->oppositeHalfEdge = Edges[ pair(v,u) ];
         Edges[ pair(v,u) ]->oppositeHalfEdge = Edges[ pair(u,v) ];
       }
    }
 } 
```

**编辑：**使代码少一点伪，以便更清楚地了解`Edges`地图和指针。

# gradient - 沿路径渐变

> ID：15365473
> 
> 赞同：9
> 
> 时间：2013-03-12T15:35:13.683
> 
> 标签：gradient, inkscape

是否可以在inkscape中创建类似的东西？我一直在寻找和尝试很长一段时间，但到目前为止没有结果......

所以我正在寻找的是一个渐变，它遵循它所应用的路径的方向。

[沿路径渐变 http://coreldraw.com/cfs-filesystemfile.ashx/__key/CommunityServer.Components.PostAttachments/00.00.02.07.23/GradientBlend2.jpg](http://coreldraw.com/cfs-filesystemfile.ashx/__key/CommunityServer.Components.PostAttachments/00.00.02.07.23/GradientBlend2.jpg)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T15:55:31.033

我不知道有一种解决方案可以完全满足您的需求，但是这是一种接近的方法：

*   画一条线，打开`Fill and Stroke`对话框并将笔划的宽度（`Stroke style`选项卡）设置为 50。将笔划转换为路径（`Path > Stroke to Path`）。
*   `Fill and Stroke`使用线性渐变（对话框 > `Fill`> ）填充路径`Linear gradient`并选择您喜欢的任何颜色。
*   选择`node`工具（F2），一条线将出现在您的形状区域中（下图中标有感叹号）。调整这条线可以帮助您微调渐变（但是，严格来说，它不会跟随路径，而是由标记线的开始和结束标记定义的矩形）

这应该适用于不反转的简单形状。让我知道这是否足够好，或者您是否需要更详细的说明。

![在此处输入图像描述](../Images/2cdab1a9b7e71cbbd38947bbbc45da5d.png)

# ruby-on-rails - 使用动态变量渲染rails部分

> ID：15365474
> 
> 赞同：0
> 
> 时间：2013-03-12T15:35:14.713
> 
> 标签：ruby-on-rails, ruby, model-view-controller, variables, params

我正在尝试根据用户所在的分类群呈现部分内容。在我的 application.html.erb 布局中，我有以下代码行：

```
<%= render 'spree/shared/women_subnav' if @enable_women %> 
```

在分类单元控制器中，在 show 方法中，我有：

```
@taxon_id = params[:id].split('/').first 
```

在分类单元#show 我有：

```
<% if @taxon_id == params[:id].split('/').first %>
  <%= "@enable_#{@taxon_id}" = true %>
<% end %> 
```

当我运行它时，我得到一个 SyntaxError。但是在taxons#show中，如果我只是输入：

```
<% if @taxon_id == params[:id].split('/').first %>
  <%= "@enable_#{@taxon_id}" %>
<% end %> 
```

如果没有“= true”，则页面呈现，输出“@enable_women”。所以我知道它得到了正确的变量，我只需要将该变量设置为 true。我错过了什么？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:25:15.977

首先，我想给你一些提示：

*   首先调用用户可提交的输入不是一个好主意（如果我提交 ?id=，它将返回 nil），非 utf-8 编码也会使您的应用程序崩溃，例如：?id=Ж

*   控制器是野兽！我看到您正在视图中设置真/假 instance_variable 的值，请使用控制器在呈现其输出之前定义逻辑。特别是当参数依赖时。

所以解决方案：在你的控制器中作为 params[:id] 应该建议一个 INT(11) 值：

```
def action
  # returning a Taxon should be a good idea here
  @taxon = Taxon.find(params[:id])
  # as I would give a Taxon class an has_many relation to a User
  @users = @taxon.users
end 
```

在你的行动看来

```
<%= render :partial => "taxons/users", collection: @users %> 
```

当然，您将拥有强大的能力来确定返回的用户并相应地呈现想要的部分。

如果您想了解有关“Rails 方式”的更多信息，请阅读： http: [//guides.rubyonrails.org/](http://guides.rubyonrails.org/)

玩得开心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:36:18.827

利用`instance_variable_set`

```
instance_variable_set "@enable_#{@taxon_id}", true 
```

只是提醒一下，最好在控制器中执行这些操作。

# mongodb - 使用 Spring Data MongoDB 将现有 GridFS 文件替换为新内容

> ID：15365476
> 
> 赞同：2
> 
> 时间：2013-03-12T15:35:23.823
> 
> 标签：mongodb, spring-data, gridfs

我在 MongoDB GridFS 中有一些数据。我正在使用 Spring Data`GridFsOperations`类来执行我的 GridFS 读/写。

我需要替换现有 GridFS 文件的内容，即`_id`and`filename`应该保持不变，但文件内容应该更新。

Spring Data `[GridFsOperations]`( [API](http://static.springsource.org/spring-data/mongodb/docs/1.2.x/api/) ) 主要允许`find`返回一个 Mongo`GridFSDBFile`和`store`. `GridFSDBFile`( [API](http://api.mongodb.org/java/2.10.1/com/mongodb/gridfs/GridFSDBFile.html) ) 不允许更新内容。`store`如果先删除文件，然后与之前的文件一样存储，理论上可以使用该方法`_id`。但是`store`不允许指定`_id`字段。

到目前为止我找到的唯一解决方案是直接使用 Mongo API 删除现有文件，并使用相同的`_id`. 这种效果的答案没有用：这个问题特定于 Spring Data MongoDB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T16:59:18.737

尚未公开 API 的原因是 MongoDB GridFS 上不支持该 API。您基本上解决了这个问题，实现了[这里](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/-xuQ-dra5Ac)描述的模式。但由于这归结为非原子操作，我们决定一开始就不将其公开为操作。

如果您认为此模式有可靠的实现（以及对错误情况的适当处理），请随时在我们的[JIRA](https://jira.springsource.org/browse/DATAMONGO)中打开票证以讨论选项。

# java - Spring 3 安全性 j_spring_security_check

> ID：15365477
> 
> 赞同：13
> 
> 时间：2013-03-12T15:35:27.877
> 
> 标签：java, spring, spring-mvc, spring-security, spring-3

我正在尝试学习弹簧安全性的工作原理，因此我下载了一些示例项目，然后尝试将该解决方案实施到我的项目中。但是当我尝试登录时，我收到`404`错误，并且在地址栏中我有`http://localhost:8080/fit/j_spring_security_check`. 我试图在这里查看类似的问题，但我无法意识到如何将其应用于我的项目。如果有经验丰富的人可以帮助我，我将非常感激。

我的应用程序结构如下所示：

![在此处输入图像描述](../Images/173060702a2c2f16bdff8c29eacc1c0e.png)

应用程序上下文.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:security="http://www.springframework.org/schema/security"
   xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<context:annotation-config/>

<context:component-scan base-package="cz.cvut.fit"/>

<import resource="classpath:applicationContext-security.xml"/>

</beans> 
```

applicationContext-web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:mvc="http://www.springframework.org/schema/mvc"
   xmlns:context="http://www.springframework.org/schema/context"
   xmlns:security="http://www.springframework.org/schema/security"
   xsi:schemaLocation="
    http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<context:annotation-config/>

<context:component-scan base-package="cz.cvut.fit" />

<mvc:annotation-driven />

<security:global-method-security jsr250-annotations="enabled"
                                 proxy-target-class="true"/>
</beans> 
```

applicationContext-security.xml：

```
<beans xmlns:security="http://www.springframework.org/schema/security"
   xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans
             http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
             http://www.springframework.org/schema/security
             http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<security:http pattern="/css/**" security="none"/>
<security:http pattern="/views/login.jsp*" security="none"/>
<security:http pattern="/views/denied.jsp" security="none"/>

<security:http auto-config="true" access-denied-page="/denied.jsp" servlet-api-provision="false">
    <security:intercept-url pattern="/views/login.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
    <security:intercept-url pattern="/views/edit/**" access="ROLE_EDIT"/>
    <security:intercept-url pattern="/views/admin/**" access="ROLE_ADMIN"/>
    <security:intercept-url pattern="/**" access="ROLE_USER"/>
    <security:form-login login-page="/views/login.jsp" authentication-failure-url="/denied.jsp"
                         default-target-url="/home.jsp"/>
    <security:logout/>
</security:http>

<security:authentication-manager>
    <security:authentication-provider>
        <security:user-service>
            <security:user name="adam" password="adampassword" authorities="ROLE_USER"/>
            <security:user name="jane" password="janepassword" authorities="ROLE_USER, ROLE_ADMIN"/>
            <security:user name="sue" password="suepassword" authorities="ROLE_USER, ROLE_EDIT"/>
        </security:user-service>
    </security:authentication-provider>
</security:authentication-manager>

</beans> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-10-21T10:33:54.353

您正在尝试根据网页的当前上下文路径验证 uri。JSTL 标记库可用于确保您根据应用程序的上下文轻松生成正确的 url。如果你想快速实现它，你可以使用标签库来做到这一点。为此，您可以将 jstl 标记库添加到 jsp 的顶部：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

然后您可以使用以下内容发布到登录 servlet。

```
<form action="<c:url value="/j_spring_security_check"></c:url>" method="post" role="form"> 
```

这可确保您始终发布到 <your_application_context>/j_spring_security_check。

jstl 参考：http: [//docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/url.html](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/url.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-24T09:56:17.237

路径`/j_spring_security_check`已更改为`/login`spring 4 并在`UsernamePasswordAuthenticationFilter`

你可以在这里找到它的来源：[https ://github.com/spring-projects/spring-security/blob/master/web/src/main/java/org/springframework/security/web/authentication/UsernamePasswordAuthenticationFilter.java](https://github.com/spring-projects/spring-security/blob/master/web/src/main/java/org/springframework/security/web/authentication/UsernamePasswordAuthenticationFilter.java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-22T10:18:17.503

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>
        org.springframework.web.filter.DelegatingFilterProxy
    </filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

添加你的 web.xml 文件。它创建你的 springSecurityFilterChain 的 Bean。然后你得到响应

# youtube - YouTube API 分析 - 所有频道视频的视频维度报告

> ID：15365478
> 
> 赞同：0
> 
> 时间：2013-03-12T15:35:28.837
> 
> 标签：youtube, youtube-api, google-analytics-api

我们正在寻求一份报告： [https](https://developers.google.com/youtube/analytics/v1/available_reports) ://developers.google.com/youtube/analytics/v1/available_reports dimension:country filter:videoId 我们所有的视频。

为此，我们获取了所有视频（[https://developers.google.com/youtube/v3/docs/search/list](https://developers.google.com/youtube/v3/docs/search/list)）

并循环播放每个视频（我们需要每个视频的每个国家/地区的细分）

问题 1\. 这是最好的方法吗？2\. 我们没有得到私人视频，因为搜索没有返回它们，但 youtube 中的分析页面确实考虑了它们，所以我们有数据不匹配。

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:13:30.917

要获取您的视频，您可以使用[channels->list](https://developers.google.com/youtube/v3/docs/channels/list) 'with mine=true' 并获取相关播放列表

或者

[playLists->](https://developers.google.com/youtube/v3/docs/playlists/list)使用您的频道 ID 和 'mine=true'列出

然后

您可以使用[playlistItems->list浏览这些视频](https://developers.google.com/youtube/v3/docs/playlistItems/list)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-13T00:53:08.020

自 2014 年 8 月 28 日起，每个 API 调用现在可以获取多达 200 个视频的指标。在此处查看信息： [https ://developers.google.com/youtube/analytics/revision_history](https://developers.google.com/youtube/analytics/revision_history)

# eclipse - Tomcat：Eclipse Juno 中克隆的应用程序生成的上下文路径不同

> ID：15365479
> 
> 赞同：1
> 
> 时间：2013-03-12T15:35:30.623
> 
> 标签：eclipse, tomcat, maven-3, server.xml, contextroot

我一直在尝试将几个不同的项目合并到 Eclipse 中的一个项目中。在这次尝试中，我尝试了以下步骤，这会导致生成不同的上下文路径（不正确？）。

**核心问题：**

1.  在 Eclipse 中复制一个动态 Web 项目（Maven）并粘贴为一个新项目（克隆重复）
2.  将项目添加到 Eclipse 中的嵌入式 Tomcat 服务器。
3.  在eclipse中转到Tomcat Server项目并打开server.xml
4.  生成的<Context>标签包含以下内容

    ```
    <Context docBase="DuplicateApp" path="App" reloadable="true" source="org.eclipse.jst.jee.server:DuplicateApp"/> 
    ```

    我希望'path' 和'docBase' 都指向DuplicateApp，这是克隆应用程序的名称，但是它看起来不正确。这甚至是预期的行为吗？

相当多的搜索证实了我了解到“路径”和“文档库”都应该指向 Web 应用程序/war 文件名的名称。

**附加信息：**

1.  已安装 Eclipse Juno Java EE 版本
2.  安装在 Eclipse 中的 M2E 插件
3.  Tomcat 版本 7
4.  pom.xml 没有覆盖战争名称 - 交叉检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T13:27:25.813

在拼命地刷新以找到我的帖子没有答案之后，经过几个小时的艰苦跋涉，找到了我自己问题的答案！

似乎有一个名为“Web 项目设置”的属性，可以通过 Project > properties > 'Web Project Settings' 访问，其中可以更改上下文根。不确定它是如何填充的或它被保留在哪里。但至少这解决了我的问题！

# session - redirect_to 后会话丢失

> ID：15365480
> 
> 赞同：2
> 
> 时间：2013-03-12T15:35:32.453
> 
> 标签：session, redirect, ruby-on-rails-3.2, koala

在我的应用程序中重定向后，我遇到了会话丢失的问题。我们正在使用宝石“考拉”与 Facebook 集成。这个 gem 在 Rails 3.0 上运行良好，但我们没有升级到 Rails 3.2.12，它失败了，因为会话在重定向到 Facebook 后消失了。

我一直在调查和阅读很多关于类似问题的信息，但还没有得到任何解决方案。这里的关键是 2 个操作：

1) Publish_event 动作，我们设置 Koala 对象并连接 Facebook：

```
def publish_event
   ...
   ...
   callback = url_for(......................)
   @oauth = Koala::Facebook::OAuth.new(Facebook::APP_ID, Facebook::SECRET, callback)
   session[:oauth] = @oauth

   redirect_to @oauth.url_for_oauth_code(:permissions => ["offline_access", "publish_stream", "manage_pages"])
end 
```

该部分工作正常并成功连接到 Facebook。Facebook 重定向回我们的应用程序，然后调用第二个操作：

2）Facebook回调动作，我们发布我们想要的消息：

```
def facebook_callback  
  token = session[:oauth].get_access_token(params[:code])
  @graph = Koala::Facebook::API.new(token)
  .....
end 
```

这里的问题是，重定向到 Facebook 后，会话没有加载（Rack::Session::Abstract::SessionHash:0x30027e4 尚未加载），所以我们无法继续，因为我们需要创建的原始 oauth Koala 对象与 Facebook 的连接，应该在会话中。

我将会话配置为 active_record_store，它在应用程序的其余部分运行良好，所以我在这里很困惑。

有人遇到过类似的事情吗？或者你有什么建议如何以不同的方式做到这一点？

谢谢 ！

# xml - XSLT：在变量中模拟模板匹配

> ID：15365481
> 
> 赞同：2
> 
> 时间：2013-03-12T15:35:34.660
> 
> 标签：xml, xslt

**我想知道如何根据下面的代码在变量内模拟模板马赫。**

*这个 XSLT 代码的输出我想将它存储在一个变量中，稍后在脚本中使用它：*

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="*">
    <xsl:element name="{local-name(.)}">
      <xsl:apply-templates select="@* | node()"/>
    </xsl:element>
  </xsl:template>
  <xsl:template match="@*">
    <xsl:attribute name="{local-name(.)}">
      <xsl:value-of select="."/>
    </xsl:attribute>
  </xsl:template>
</xsl:stylesheet> 
```

我现在可以通过使用 2 个 XSLT 脚本来实现这一点，但我只想使用一个脚本。

XSLT 脚本应该给出相同的输出，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:variable name="InputNew">
  <xsl:template match="*">
    <xsl:element name="{local-name(.)}">
      <xsl:apply-templates select="@* | node()"/>
    </xsl:element>
  </xsl:template>
  <xsl:template match="@*">
    <xsl:attribute name="{local-name(.)}">
      <xsl:value-of select="."/>
    </xsl:attribute>
  </xsl:template>
  </xsl:variable>

  <xsl:template match="/">
     <xsl:copy-of select="$InputNew"/>
  </xsl:template>
</xsl:stylesheet> 
```

**我知道我不能在变量中使用模板匹配，我只能使用 call-template 但我无法为此执行正确的 XSLT 代码。**

***编辑：这是工作脚本：***

```
<xsl:stylesheet version="2.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" exclude-result-prefixes="xsl soap xsi">
<xsl:output method="xml" version="1.0" encoding="iso-8859-1" indent="yes" omit-xml-declaration="yes"/>
   <xsl:strip-space elements="*"/>

    <xsl:template match ="*" mode="stripNs">
        <xsl:element name ="{local-name()}" >
            <xsl:apply-templates select ="@* | node()" mode="stripNs"/>
        </xsl:element>
    </xsl:template>

    <xsl:variable name="noNamespaces">
       <xsl:apply-templates select="soap:Envelope/soap:Body/*" mode="stripNs" />
    </xsl:variable>

    <xsl:template match="/">
       <!-- Now I can do what I want with the variable $noNamespaces -->
       <xsl:copy-of select="$noNamespaces"/>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:09:25.050

如果您使用的是 Saxon，您应该能够使用该`exslt:node-set()`函数来执行此操作：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                              xmlns:exslt="http://exslt.org/common">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="*" mode="stripNs">
    <xsl:element name="{local-name(.)}">
      <xsl:apply-templates select="@* | node()" mode="stripNs"/>
    </xsl:element>
  </xsl:template>
  <xsl:template match="@*" mode="stripNs">
    <xsl:attribute name="{local-name(.)}">
      <xsl:value-of select="."/>
    </xsl:attribute>
  </xsl:template>

  <xsl:template match="/">
    <!-- Apply the stripNs templates and capture the result in a variable -->
    <xsl:variable name="noNamespaces">
      <xsl:apply-templates select="*" mode="stripNs" />
    </xsl:variable>

    <!-- Now use the variable -->
    <xsl:apply-templates select="exslt:node-set($noNamespaces)/*" />
  </xsl:template>
</xsl:stylesheet> 
```

再说一次，如果您使用的是 Saxon，您也可以使用 XSLT 2.0 并使用与上面相同的内容，但不需要使用`exslt:node-set()`around `$noNamespaces`：

```
<!-- Now use the variable -->
<xsl:apply-templates select="$noNamespaces/*" /> 
```

# php - 防止 PHP Tidy 将样式标签数据转换为 CDATA

> ID：15365484
> 
> 赞同：8
> 
> 时间：2013-03-12T15:36:02.067
> 
> 标签：php, html, tidy

我正在使用 php tidy 清理包含样式标记的用户生成的 HTML 页面：

```
<style type="text/css">
    body {
        padding-top: 60px;
        padding-bottom: 40px;
    }
</style> 
```

但是一旦我运行 Tidy，样式标签数据就会转换为 CData。我使用 Tidy 的主要目的是修复文件以及进行适当的缩进。

```
<style type="text/css">
/*<![CDATA[*/
    body {
            padding-top: 60px;
            padding-bottom: 40px;
    }
/*]]>*/
</style> 
```

我的 Tidy 配置选项是 -

```
$options = array(
    'preserve-entities' => true,
    'hide-comments' => true,
    'tidy-mark' => false,
    'indent' => true,
    'indent-spaces' => 4,
    'new-blocklevel-tags' => 'article,header,footer,section,nav',
    'new-inline-tags' => 'video,audio,canvas,ruby,rt,rp',
    'doctype' => 'omit',
    'sort-attributes' => 'alpha',
    'vertical-space' => false,
    'output-xhtml' => true,
    'wrap' => 180,
    'wrap-attributes' => false,
    'break-before-br' => false,
    'vertical-space' => false,
);

$buffer = tidy_parse_string($buffer, $options, 'utf8');
tidy_clean_repair($buffer); 
```

我尝试了很多搜索，但 PHP Tidy 库并不完全是一个“有据可查”的库！所以它归结为在 Tidy 清理/修复代码后手动删除 CDATA。

```
$buffer = str_replace("/*<![CDATA[*/","",$buffer);
$buffer = str_replace("/*]]>*/","",$buffer); 
```

现在我对这种方法的问题是样式标签数据的缩进仍然搞砸了（与页面的其余部分不完全对齐）

```
<style type="text/css">
    body {
        padding-top: 60px;
        padding-bottom: 40px;
    }
</style> 
```

再说一遍，我如何防止 TIDY 在页面上创建 CDATA！

非常感谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T18:08:36.770

关闭该`output-xhtml`选项。XHTML 需要 CDATA 包装，因为 CSS 可以包含非转义`>`字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T17:25:37.733

添加 CDATA 标记旨在帮助浏览器知道它们应该将 '<' 和 '&' 等字符解析为文字字符而不是 html 语法。Tidy 似乎没有任何记录的配置会阻止为内联 css/javascript 生成它们。唯一的选择是将 css 移动到单独的文件中。在这种情况下，它不需要 CDATA 标记。

有关更多信息，请参阅[http://tidy.sourceforge.net/docs/quickref.html](http://tidy.sourceforge.net/docs/quickref.html)和[https://en.wikipedia.org/wiki/CDATA](https://en.wikipedia.org/wiki/CDATA)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:38:13.553

处理它的一种方法是使用指向外部样式表的链接。

```
<link rel="stylesheet" type="text/css" media="screen, print" href="site.css"> 
```

# applescript - 将变量附加到 AppleScript 中的链接？

> ID：15365487
> 
> 赞同：0
> 
> 时间：2013-03-12T15:36:17.783
> 
> 标签：applescript, itunes

目前我有这个工作代码：

```
on run
set info to ""
tell application "System Events"
    set num to count (every process whose name is "iTunes")
end tell
if num > 0 then
    tell application "iTunes"
        if player state is playing then
            set albumName to (get album of current track)
        end if
    end tell
end if
return text 1 thru 10 of albumName
end run 
```

如果正在运行的 iTunes 和现场专辑的格式正确（YYYY-MM-DD） - 这将带回现场专辑的日期。我现在想获取“返回 text 1 thru 10 of albumName”的结果并将其添加到此代码中：

```
tell application "Firefox" to activate
tell application "Firefox"
open location "http://someband.com/showID=" &  *[insert code for "text 1 thr 10 of albumName" variable]*
end tell 
```

我知道“&”不正确，但我认为这是开始。这应该起作用的方式是，如果我正在收听“2013-03-12 Live on StackOverflow”，我希望脚本采用“2013-03-12”并将其附加到我的链接，以便 Firefox 打开网站地址：“ [http: //someband.com/showID=2013-03-12](http://someband.com/showID=2013-03-12) "

...说得通？任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:06:26.147

尝试：

```
if application "iTunes" is not running then return

tell application "iTunes"
    if player state is playing then
        set albumName to (get album of current track)
    end if
end tell

set myText to text 1 thru 10 of albumName

-- Assuming Firefox is your default browser…
open location "http://someband.com/showID=" & myText 
```

# java - 如何计算 GC 工作所需的 oldGen 大小？

> ID：15365491
> 
> 赞同：1
> 
> 时间：2013-03-12T15:36:28.117
> 
> 标签：java, garbage-collection, heap-memory

我有消耗 10G 堆内存（表示内存中的数据结构）的 java web (tomcat) 应用程序。但是当我将例如 Xmx 设置为 20G 时它会起作用。

当我将堆内存设置为 11G 时，我的应用程序无法加载所有数据 - 它进入连续的完整 gc。假设垃圾收集器也需要内存来使 full gc 高效。它正确吗？我应该为 gc 的有效工作添加多少内存？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T19:06:59.107

要找出**最佳 OldGen 大小**：

1.  启用**GC 日志记录** `-XX:+PrintTenuringDistribution -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput -XX:LogFile=jvm.log -XX:+HeapDumpOnOutOfMemoryError -Xloggc:gc.log -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -showversion`

2.  计算**Live Data Size** = FullGC 后旧 OldGen 的占用率（有关详细信息，请参阅[高级 JVM 调优）。](https://oracleus.activeevents.com/connect/sessionDetail.ww?SESSION_ID=7236)顺便提一句。尝试获得平均值。通过在几个 FullGC 周期后观察 OldGen 的占用情况。

3.  最佳**OldGenSize** == **Live Data Size**的**2**到**3 倍**。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:40:32.227

如果您设置永久代分配会更好，因为您有大量数据要加载。实际上，这个永久代用于保存 VM 本身的反射数据，例如类对象和方法对象。这些反射对象被直接分配到永久代，并且它的大小独立于其他代。

```
-Xms10G -Xmx20G -XX:PermSize=5G -XX:MaxPermSize=12G 
```**

# sql-server - Excel SSIS 查询在 Excel 中返 回空列，但在 Management Studio 中不返回

> ID：15365500
> 
> 赞同：1
> 
> 时间：2013-03-12T15:36:50.380
> 
> 标签：sql-server, stored-procedures, import, excel-2007, ms-query

我尽我所能环顾网络，但这个问题让我望而却步。我在 SSIS 中有一个可以正常工作的存储过程。它做了很多事情，最终返回了一些数字和文本。该过程本身使用 #temp 表，因为数据不需要存在于 proc 运行之外并返回约 931K 行。

下一步是将proc的输出导入excel。使用 MS 查询，我调用包含必要参数的 proc。它运行但我得到的唯一数据是带有数字的列。我缺少文本值。我认为这可能是从 SSIS 到 Excel 的文本翻译问题，所以我将输出从 nvarchar 更改为 varchar，问题仍然存在。我编写了proc，所以我可以进行任何必要的更改。另外，我认为这可能是一个临时表问题，所以我尝试构建一个表，使用 proc 在其中插入数据，然后将该表拉入 Excel，虽然我得到了更多的文本列，但数字仍然是空白的。

有什么建议吗？

问题的简短版本：SQL 在管理工作室中工作，但文本未返回到 Excel。当完成导入/更新时，proc 中的行数与 Excel 中的行数匹配。数字按预期返回。

版本：

Excel：2007 - SQL Server：2005 - Management Studio：2008R2 - 使用 MS 查询的 ODBC 连接 -

```
USE [cmdb]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER proc [estimate].[sp_calendar]( 
    @calendar_start char(8),
    @years as int   
    )
as

set nocount on;

declare @calendar_end char(8)
declare @actual_start_date datetime
declare @actual_end_date datetime
declare @loop_counter datetime

set @actual_start_date = CONVERT (datetime, @calendar_start, 112)
set @loop_counter = @actual_start_date
set @actual_end_date = dateadd(year,+@years,@actual_start_date)
set @calendar_end = cast(year(@actual_end_date) as char(4))+RIGHT('00'+ CONVERT(VARCHAR,month(@actual_end_date)),2)+RIGHT('00'+ CONVERT(VARCHAR,day(@actual_end_date)),2)

begin
create table #calendar (
    [yearmonth] nvarchar(8)
)
end

begin
    create table #results (
        [actual ExpectedActionDt] datetime
        ,[calc ExpectedActionDt] ntext
        ,ExpectedActionDt datetime
        ,[calc IntegratedReleasePlanDt] ntext
        ,IntegratedReleasePlanDt datetime
        ,[key] ntext
        ,projectid ntext
        ,projectnm ntext
        ,ParentChaseProjectNo ntext
        ,VersionTag ntext
        ,itemid ntext
        ,Qty float
        ,ItemNotes ntext
        ,CashflowType ntext
        ,frequency  ntext
        ,UnitPrice float
        ,[cost] float
        )
end

begin
    create table #baseline (
    [actual ExpectedActionDt] datetime
    ,[calc ExpectedActionDt] nvarchar(8)
    ,ExpectedActionDt datetime
    ,[calc IntegratedReleasePlanDt] nvarchar(8)
    ,IntegratedReleasePlanDt datetime
    ,[key] ntext
    ,projectid ntext
    ,projectnm ntext
    ,ParentChaseProjectNo ntext
    ,VersionTag ntext
    ,itemid ntext
    ,Qty float
    ,ItemNotes ntext
    ,CashflowType ntext
    ,frequency ntext
    ,UnitPrice float
    ,[cost] float)
end 

insert into #calendar (
        [yearmonth])
        select 
        distinct calendarid [yearmonth]
    from 
        [cmdb_core].[dbo].[Calendar] 
    where 
        calendarid between @calendar_start and @calendar_end

    insert into #baseline (
        [actual ExpectedActionDt]
        ,[calc ExpectedActionDt]
        ,ExpectedActionDt
        ,[calc IntegratedReleasePlanDt]
        ,IntegratedReleasePlanDt
        ,[key]
        ,projectid
        ,projectnm
        ,ParentChaseProjectNo   
        ,VersionTag
        ,itemid
        ,Qty
        ,ItemNotes
        ,CashflowType
        ,frequency
        ,UnitPrice
        ,[cost])        
    select  
        case
            when (ExpectedActionDt is not null)
                then ExpectedActionDt
            when (IntegratedReleasePlanDt is not null)
                then IntegratedReleasePlanDt
            else
                DATEADD(YEAR, DATEDIFF(YEAR, 0, GETDATE()), 0)
        end [actual ExpectedActionDt]
        ,case
            when (ExpectedActionDt is not null)
                then cast(year(ExpectedActionDt) as char(4))+RIGHT('00000'+ CONVERT(VARCHAR,month(ExpectedActionDt)),2)+RIGHT('00'+ CONVERT(VARCHAR,day(ExpectedActionDt)),2)
            when (IntegratedReleasePlanDt is not null)
                then cast(year(IntegratedReleasePlanDt) as char(4))+RIGHT('00000'+ CONVERT(VARCHAR,month(IntegratedReleasePlanDt)),2)+RIGHT('00'+ CONVERT(VARCHAR,day(IntegratedReleasePlanDt)),2)
            else
                cast(year(getdate()) as char(4))+'0101'
        end [calc ExpectedActionDt]
        ,ExpectedActionDt
        ,cast(year(IntegratedReleasePlanDt) as char(4))+RIGHT('00'+ CONVERT(VARCHAR,month(IntegratedReleasePlanDt)),2)+RIGHT('00'+ CONVERT(VARCHAR,day(IntegratedReleasePlanDt)),2) [calc IntegratedReleasePlanDt]
        ,IntegratedReleasePlanDt
        ,cast(ModelEstimateId as nvarchar(max))+cast(BucketId as nvarchar(max))+cast(ItemNo as nvarchar(max)) [key]
        ,projectid
        ,projectnm
        ,ParentChaseProjectNo   
        ,VersionTag
        ,itemid
        ,Qty
        ,ItemNotes
        ,CashflowType
        ,frequency
        ,UnitPrice
        ,case
            when frequency = 'OneTime'
                then Qty
            else
                cast(round((UnitPrice*Qty)/12,0) as int)
            end [cost]
    from 
        estimate.ComputedEstimates
    where
        [status] <> 'Hold'
        and CostCategory <> 'Assembly'
        and includeinforecast = 'Y'
        and case
            when (ExpectedActionDt is not null)
                then cast(year(ExpectedActionDt) as char(4))+RIGHT('00000'+ CONVERT(VARCHAR,month(ExpectedActionDt)),2)+RIGHT('00'+ CONVERT(VARCHAR,day(ExpectedActionDt)),2)
            when (IntegratedReleasePlanDt is not null)
                then cast(year(IntegratedReleasePlanDt) as char(4))+RIGHT('00000'+ CONVERT(VARCHAR,month(IntegratedReleasePlanDt)),2)+RIGHT('00'+ CONVERT(VARCHAR,day(IntegratedReleasePlanDt)),2)
            else
                cast(year(getdate()) as char(4))+'0101'
            end >= @calendar_start

WHILE (@loop_counter <= @actual_end_date)
BEGIN
insert into #results (
        [actual ExpectedActionDt]
        ,[calc ExpectedActionDt]
        ,ExpectedActionDt
        ,[calc IntegratedReleasePlanDt]
        ,IntegratedReleasePlanDt
        ,[key]
        ,projectid
        ,projectnm
        ,ParentChaseProjectNo
        ,VersionTag
        ,itemid
        ,Qty
        ,ItemNotes
        ,CashflowType
        ,frequency
        ,UnitPrice
        ,[cost])
select * from #baseline where [actual ExpectedActionDt] >= @loop_counter

set @loop_counter = dateadd(day,+1,@loop_counter)
END

select 
    c.[yearmonth]
    ,a.[calc ExpectedActionDt]
    ,a.[key]
    ,a.projectid
    ,a.projectnm
    ,a.ParentChaseProjectNo 
    ,a.VersionTag
    ,a.itemid
    ,a.ItemNotes
    ,a.CashflowType
    ,a.frequency
    ,a.Qty
    ,a.UnitPrice
    ,a.[cost]
from
    #calendar as c  
    left outer join
    #results a
    on c.[yearmonth] = a.[calc ExpectedActionDt]
order by 1,2,3

drop table #baseline
drop table #results
drop table #calendar 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T12:36:42.713

这个问题的解决方案归结为数据类型。如果您像我一样知道您的目标 Excel，那么您必须使用 Excel 可以转换的数据类型。我一直在使用没有被带到 Excel 中的 nvarchar(max)，当我将字段更改为文本和字符时，我很好。一旦我知道要寻找什么，我就从 Microsoft 找到了这个答案：[Microsoft Excel 数据类型](http://msdn.microsoft.com/en-us/library/windows/desktop/ms712640%28v=vs.85%29.aspx)。还有一个关于限制的页面：[数据类型限制](http://msdn.microsoft.com/en-us/library/windows/desktop/ms713521%28v=vs.85%29.aspx)。另一部分是我使用的是存储过程而不是纯 SQL，尽管直接从表中选择也存在问题。我试图加载一个表，而不是依赖具有类似故障的存储过程。没有任何错误返回，只是没有数据。通过我的测试，以下是文本/字符类型转换及其成功：

text - 工作
ntext - 工作
char - 工作
nchar - 工作
varchar - 失败
nvarchar - 失败

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T18:12:46.503

我猜该过程会从#results 中进行最终选择，并且在 SQL Server 管理工作室查询分析器中可以看到所需的结果；但是，当您在 SSIS 数据流中调用该过程时，文本数据会在进入 Excel 目标的途中消失吗？

这里有几件事可以尝试。使用数据查看器（位于步骤之间的箭头上）检查您的文本列是否包含过程调用下游的所需文本。使用派生列小部件将文本放入所需的数据类型（例如，VARCHAR 的代码页 1252）。SSIS 对数据类型很挑剔。

最后，尝试不同的目标，例如 csv 文件等纯文本文件。您可以使用派生列小部件进行连接并在文本周围添加逗号和双引号以及您想尝试的任何其他内容。然后您可以在记事本中查看是否获得了所需的输出，并且 Excel 应该能够打开一个 csv 文件。

Excel 记录曾经有 64,000 条限制，但我相信这在 Excel 2007 中早已不复存在。我不断达到 2000KB 的限制，将输出剪切并粘贴到记事本中（它默默地失败了，这令人沮丧，直到我记得为止）。但是您的 931K 记录可能会达到其他限制，因此请尝试较小的输出集，看看它们的工作方式是否有所不同。

# asp.net - asp.net 和跨站点请求伪造

> ID：15365501
> 
> 赞同：3
> 
> 时间：2013-03-12T15:36:50.487
> 
> 标签：asp.net, security, protect-from-forgery

我们最近运行了一个 Appscan 应用程序，报告显示在几页上：以下更改已应用于原始请求：

*   将 HTTP 标头设置为“ [http://bogus.referer.ibm.com](http://bogus.referer.ibm.com) ”
    推理：
    相同的请求在不同的会话中发送了两次，并收到了相同的响应。这表明没有一个参数是动态的（会话标识符仅在 cookie 中发送），因此应用程序容易受到此问题的影响。

我对如何处理这个问题有点困惑，我应该只查看 Request.UrlReferrer 并确保它与 URL 中的主机相同，还是有更好的方法来处理这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:49:22.127

Referrer 标头很容易被欺骗。您需要使用 CSRF 令牌（我推荐 Synchronizer 令牌模式）来证明请求的来源。[OWASP](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet)有一个很棒的资源，你绝对应该阅读。祝你好运！

# java - 如何舍入浮点精度，关于它的大小？

> ID：15365505
> 
> 赞同：0
> 
> 时间：2013-03-12T15:37:12.137
> 
> 标签：java, double, rounding

将值四舍五入到特定的小数位数很容易：

```
public static double round(double x, int n){
    n = (int)Math.pow(n, 10);
    return Math.round(x*n)/n;
} 
```

但是，您能否制定一个算法，根据数字的大小预先假定实际需要四舍五入的小数位数？

我的意思是，如果数字很大（比如`100000000.12345`），它不需要那么多的小数精度，所以它可以将它四舍五入到小数点后 1 位或 2 位，

而如果一个数字很小（比如`0.00012345`），它需要最大十进制精度
做这样的事情的想法是什么？

**编辑：** 示例：

```
 argument       returned   decnum           comment
123456789.9    123456789     0    //number is way too large so I don't need any decimal places
12345678.99    12345678      0    //number is still very large.
1234567.899    1234567       0    //still...
123456.7899    123456        0    //...
12345.67899    12345         0    //...
1234.567899    1234          0    //It's pretty large now. Still not small enough to get some decimals.
123.4567899    123.4         1    //Now, number is a little average, so 1 decimal place is included.
12.34567899    12.34         2    //The number is normal, so I want a normal 2 decimal places 
1.234567899    1.234         3    //Now it's kinda small, so it now gives 3 decimal places
.1234567899    0.1234        4    //Smaller number, thus greater number of decimal places (4).
.0123456789    0.01234       5    //Even smaller
.0012345678    0.0012345     7    //Larger number of decimal places.
.0001234567    0.0001234567  10   //Smaller and smaller number, greater and greater number of decimals. 
```

我只是在寻找一种方法，当数字接近零时，
我可以**增加**
小数位数， 并在数字远离零时**减少小数位数。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:43:50.740

You could use `BigDecimal`. Create a `BigDecimal` with your `double` value then check the scale with `bigDVariable.scale()` and round with the wanted scale depending on the value returned by it and its value. [BigDecimal](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html) doc.

Edit : You don't seem to worry about how many decimals you have in the first place, the value of your `double` looks to be the only information that matters. Checking `scale()` wouldn't matter then.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:48:03.740

If you want high precision (significant digits), you'll have to use `BigDecimal` instead of double. The `BigDecimal` round method gives you the number of significant digits you ask for.

Here's something I put together.

```
import java.math.BigDecimal;
import java.math.MathContext;
import java.math.RoundingMode;

public class Rounding {

    public static void main(String[] args) {
        BigDecimal number = new BigDecimal(100000000.12345);
        System.out.println("Number: " + number.toPlainString());
        System.out.println(" ");
        for (int precision = 8; precision < 17; precision++) {
            System.out.println("Precision: " + precision + ", result: "
                    + round(number, precision));
        }
    }

    public static String round(BigDecimal number, int precision) {
        MathContext mathContext = new MathContext(precision, 
                RoundingMode.HALF_UP);
        BigDecimal rounded = number.round(mathContext);
        return rounded.toPlainString();
    }

} 
```

And here are the results.

```
Number: 100000000.12344999611377716064453125

Precision: 8, result: 100000000
Precision: 9, result: 100000000
Precision: 10, result: 100000000.1
Precision: 11, result: 100000000.12
Precision: 12, result: 100000000.123
Precision: 13, result: 100000000.1234
Precision: 14, result: 100000000.12345
Precision: 15, result: 100000000.123450
Precision: 16, result: 100000000.1234500 
```

.

```
Number: 0.00012344999999999999203137424075293893110938370227813720703125

Precision: 8, result: 0.00012345000
Precision: 9, result: 0.000123450000
Precision: 10, result: 0.0001234500000
Precision: 11, result: 0.00012345000000
Precision: 12, result: 0.000123450000000
Precision: 13, result: 0.0001234500000000
Precision: 14, result: 0.00012345000000000
Precision: 15, result: 0.000123450000000000
Precision: 16, result: 0.0001234500000000000 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T16:18:13.423

从算法的角度来看，我将遵循以下步骤：

1.  转换基数为 10 格式的数字，例如 123456789.9 -> 1.234567899 * 10^8 和 0.0001234567 -> 1.234567 * 10^-4。

2.  `8`例如，在第一个示例和`-4`最后一个示例中查看 10 的功率因数。

3.  通过调整一个因子来计算精度位置要求。只是一个例子，功率因数`(-1*(p-3))`在哪里。`p`如果数字为负数，则使用“0”。

这将导致以下数字。

> ```
> argument       decnum      
> 123456789.9    -1*(8-3) = -5 -> 0
> 12345678.99    -1*(7-3) = -4 -> 0
> 1234567.899    -1*(6-3) = -3 -> 0
> 123456.7899    -1*(5-3) = -2 -> 0
> 12345.67899    -1*(4-3) = -1 -> 0
> 1234.567899    -1*(3-3) =  0 -> 0
> 123.4567899    -1*(2-3) = 1  -> 1
> 12.34567899    -1*(1-3) = 2  -> 2
> 1.234567899    -1*(0-3) = 3  -> 3
> .1234567899    -1*(-1-3) = 4 -> 4
> .0123456789    -1*(-2-3) = 5  -> 5
> .0012345678    -1*(-3-3) = 6  -> 6
> .0001234567    -1*(-4-3) = 7  -> 7 
> ```

这将非常接近您正在寻找的内容。如果您真的想要，请尝试调整因子和公式以更接近（这只是一种算法/方法）。

# python - 如何在 python 中将此列表转换为字符串？

> ID：15365507
> 
> 赞同：1
> 
> 时间：2013-03-12T15:37:14.740
> 
> 标签：python, string, list

我正在尝试在以下代码中加密消息。问题是我的结果以列表格式而不是字符串出现。我怎样才能把它变成一个字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:38:17.477

`finalArray`显然是一个列表：

```
finalArray = [] 
```

要将其转换为字符串，请使用`join`：

```
print ''.join(finalArray) 
```

但首先，您可能不想要这些嵌套列表。你应该使用`extend`，而不是`append`：

```
def stringEncrypter(A):
    length = len(A)
    finalArray = []

    if length%2 == 0:
            firstArray=[]*(length/2)
            secondArray=[]*(length/2)
    else:
            firstArray=[]*((length+1)/2)
            secondArray=[]*((length-1)/2)

    for x in range(0, length-1):
            if x%2 == 0:
                    firstArray.append(A[x:x+1])
                    secondArray.append(A[x+1:x+2])
    finalArray.extend(firstArray)
    finalArray.extend(secondArray)

    print ''.join(finalArray) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:47:22.530

您需要展平结果中的嵌套列表，然后将其转换为字符串。这是一种方法：

```
>>> import itertools
>>> result = [['I', 'R', 'A', ' ', 'O'], [' ', 'E', 'D', 'Y', 'U']]
>>> ''.join(itertools.chain(*result))
'IRA O EDYU' 
```

# c# - EF - 将泛型类映射到复杂类型

> ID：15365511
> 
> 赞同：6
> 
> 时间：2013-03-12T15:37:24.293
> 
> 标签：c#, entity-framework

可以将泛型类映射到复杂类型吗？我有 3 个属性的小类 - 字符串、int 和泛型类型，并且想要将字符串和 int（字符串实际上是序列化的泛型类型）映射到复杂类型。

我认为这是不可能的，因为泛型类“FQDN”`MyGenericClass<somclass>`和复杂类型概念类型只是`MyGenericClass`有聪明的解决方案，还是我必须为泛型类的每次使用定义 ComplexType？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:58:00.070

我不知道我是否理解正确，但你为什么不通过覆盖转换运算符来使用自定义强制转换。在以下示例中，我将通用复杂类隐式转换为非通用类。

阅读更多@[如何为我的班级提供自定义演员支持？](https://stackoverflow.com/questions/1407689/how-do-i-provide-custom-cast-support-for-my-class)

```
public class ClassComplex<T> 
{
    public T MyGenericValue { get; set; }
    public string MyStringValue { get; set; }
    public int MyIntValue { get; set; }

    public static implicit operator ClassComplex(ClassComplex<T> a)
    {
        return new ClassComplex() { MyIntValue = a.MyIntValue , MyStringValue = a.MyStringValue };
    }
}

public class ClassComplex
{
    public string MyStringValue { get; set; }
    public int MyIntValue { get; set; }
}

public class Test
{
    public Test()
    {
        ClassComplex<int> ccg = new ClassComplex<int>();
        ccg.MyGenericValue = 1;
        ccg.MyIntValue = 2;
        ccg.MyStringValue = "3";

        ClassComplex cc = ccg;
    }
} 
```

# python - python“全局”（模块）变量是线程本地的吗？

> ID：15365519
> 
> 赞同：7
> 
> 时间：2013-03-12T15:37:46.783
> 
> 标签：python, django

我想对数据库中的一个值使用内存中的线程本地缓存，该值在请求/响应周期内不会更改，但会被调用数百次（可能是数千次）。我有限的理解是，使用“全局”/模块变量是实现这种缓存的一种方法。

例如：

```
#somefile.py

foo = None

def get_foo(request):
  global foo
  if not foo:
    foo = get_foo_from_db(request.blah)
  return foo 
```

我想知道在 python 中使用这种类型的“全局”是否是线程安全的，因此我可以放心 get_foo_from_db() 在 django 中每个请求/响应周期都会被调用一次（使用 runserver 或 gunicorn+gevent ）。我的理解正确吗？这个东西被调用得足够多，即使使用 memcached 来存储值也会成为一个瓶颈（我正在分析它）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T15:39:47.003

不，对全局变量的访问不是线程安全的。线程没有自己的全局变量副本，全局变量在线程之间共享。

编码：

```
if not foo:
    foo = get_foo_from_db(request.blah) 
```

编译成几个 python 字节码语句：

```
 2           0 LOAD_FAST                1 (foo)
              3 POP_JUMP_IF_TRUE        24

  3           6 LOAD_GLOBAL              0 (get_foo_from_db)
              9 LOAD_FAST                0 (request)
             12 LOAD_ATTR                1 (blah)
             15 CALL_FUNCTION            1
             18 STORE_FAST               1 (foo)
             21 JUMP_FORWARD             0 (to 24) 
```

每次执行字节码后都可能发生线程切换，因此`foo` *在您测试后*另一个线程可能会发生变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:42:11.473

不，你在两个方面是错误的。

首先，“线程”的使用在这里有点模糊。根据其服务器的配置方式，可以使用线程或进程或同时使用两者来为 Django 提供服务（请参阅[mod_wsgi 文档](https://code.google.com/p/modwsgi/wiki/ProcessesAndThreading)以获取完整讨论）。如果每个进程只有一个线程，那么您可以保证每个进程只有一个模块实例可用。但这高度依赖于该配置。

即便如此，每个请求/响应周期都不会“完全”调用该函数。这是因为进程的生命周期与该周期*完全无关*。一个进程将持续多个请求，因此该变量将针对所有这些请求持续存在。

# html - 从超链接打开访问表单

> ID：15365521
> 
> 赞同：2
> 
> 时间：2013-03-12T15:37:55.680
> 
> 标签：html, ms-access, hyperlink

我们目前有一个 ASP/SQl 服务器系统，它可以选择向用户发送电子邮件。此电子邮件包含指向另一个 ASP 页面的超链接，该页面显示特定的数据库记录。

我目前正在开发基于 MS Access 的系统弹性版本。用户希望保留相同的功能，并拥有一封电子邮件，其中包含返回数据库的超链接，打开特定表单并将其过滤为记录。

我相信解决方案在于使用 Command() 从命令行获取参数，但实际上我目前在打开数据库本身时遇到了困难。我目前使用的代码是：

```
<a href="C:\Program Files\Microsoft Office\OFFICE11\MSACCESS.exe 
    H:\Access DB\11th March\Link to DB\Dealer 
    Startup Admin EU v10.mdb" > 
    TEST 
</a> 
```

我认为这应该打开经销商启动数据库，但是它没有说明找不到文件。如果我删除第二步，即 H:\Access DB 等，链接将打开 Access，所以我想知道我是否在做一些语法不正确的事情？文件路径绝对看起来正确。

还有人可以就在超链接中使用 /c 提供一些建议吗？我发现的少量信息似乎表明它不起作用，但如果有人可以澄清或给我一个如何做的例子，我将不胜感激

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T15:41:28.067

我设法为这个问题创建了一个解决方案。我找不到从超链接打开 Access DB 的直接方法，但是您可以超链接到快捷方式。因此，我使用的解决方法是使用以下语法创建数据库的快捷方式：

“ms 访问的文件路径”“数据库的文件路径”/cmd Args

例如：

"C:\Program Files\Microsoft Office\OFFICE11\MSACCESS.exe" "C:\Documents and Settings\Database.mdb" /cmd Args

创建此文件路径的快捷方式会打开数据库。然后我创建了一个 autoexec 宏，如果 Command() 函数返回 Args，它会打开一个指定的表单。这意味着在正常打开数据库时，您将被带到通常的表单，但是当从快捷方式打开时，您将被带到不同的表单。

然后，我创建了指向快捷方式的电子邮件超链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-18T08:53:08.263

我创建了一个批处理文件来删除 MSIE 的浏览器历史记录并将其保存在服务器端。当用户单击“删除浏览器历史记录”超链接时，我只是让他下载此文件，然后用户手动运行它。你也可以做类似的事情。

# knockout.js - Knockout isDirty 示例，使用映射插件中的动态视图模块

> ID：15365525
> 
> 赞同：2
> 
> 时间：2013-03-12T15:38:08.360
> 
> 标签：knockout.js, knockout-mapping-plugin

我正在使用[Ryan Niemeyer 的脏旗](http://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html)。他的方法的一个例子可以在这个[jsFiddle](http://jsfiddle.net/rniemeyer/dtpfv/)中看到。

他在 ViewModel 上有一个dirtyItems 方法

```
this.dirtyItems = ko.computed(function() {
  return ko.utils.arrayFilter(this.items(), function(item) {
    return item.dirtyFlag.isDirty();
  });
}, this); 
```

但是，我似乎无法让他的dirtyItems 方法处理我的数据。最大的不同是我使用的是映射插件。我尝试过的一切都是空的。

这是我的实现的[jsFiddle](http://jsfiddle.net/UcyDv/1/)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T21:42:58.643

您可以将 dirtyFlag 添加到 ProfilePropertyValue 中，例如：

```
var mappingOptions = {
    ProfilePropertyValue: {
        create: function (mappingoptions) {
            var data = mappingoptions.data;
            data.ProfilePropertyValue = data.ProfilePropertyValue || {
                "ID": null,
                    "Checkbox": ko.observable(false)
            };

            var result = ko.mapping.fromJS(data);
            result.dirtyFlag = ko.dirtyFlag(result);

            return result;
        }
    }
}; 
```

然后，您需要在构建脏项目列表时检查它，如果这是您需要的。

示例：http: [//jsfiddle.net/rniemeyer/7DGfs/](http://jsfiddle.net/rniemeyer/7DGfs/)

# tree - Erlang：从函数调用中返回一个变量（gb_trees）？

> ID：15365538
> 
> 赞同：1
> 
> 时间：2013-03-12T15:38:29.827
> 
> 标签：tree, erlang, return, return-value

我试图`Tree`在代码中返回变量，但似乎 Erlang 没有明确设置返回变量。我想像这样从 shell 运行代码：

```
3> {Pid,Tree} = gbtree:start().
{<0.41.0>,init}
4> 
4> gbtree:add_entry(2,Pid,Tree). 
** exception error: no function clause matching 
                    gb_trees:is_defined(2,init) (gb_trees.erl, line 221)
     in function  gb_trees:enter/3 (gb_trees.erl, line 335)
     in call from gbtree:add_entry/3 (gbtree.erl, line 13) 
```

请注意，该错误与`Tree`未正确传递到`gbtree:add_entry(Key,Val,Tree).`. 但是，以不同的方式执行此操作确实可以在 shell 中使用。函数调用`gbtree:start().`应该返回类似`{<#.#.#>,{0,nil}}`.

```
2> Tree = gb_trees:empty().   
{0,nil}
3>   
3> gbtree:add_entry(1,"something",Tree).
gbt_r lookup 1 "something"
 {1,{1,"something",nil,nil}} 
```

以下是测试代码gbtree.erl

```
-module(gbtree).
-export([start/0, init/0, add_entry/3]).

start() ->  
    register(?MODULE, Pid = spawn(?MODULE, Tree = init, [])),
        { Pid, Tree}.

init() ->   
    Tree = gb_trees:empty(),
    Tree.

add_entry(Key, Data, Tree1) ->
    Tree2 = gb_trees:enter( Key, Data, Tree1),
    io:format("gbt_r lookup ~p ~p~n ",[Key, Data]),
    Tree2. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:53:11.763

在函数 start() 中，当您生成新进程时，您传递模块名称？MODULE、函数名称“init”和参数 []。但是当你这样做时，你指定变量 Tree 等于第二个参数 - atom 'init'。

这意味着函数 start() 的返回值将是带有进程 ID 和原子“init”的元组。（不是 init 函数的结果）。

坦率地说，我不太明白你为什么在这里使用流程，所以，我会这样制作这个模块：

```
-module(gbtree).
-export([init/0, add_entry/3]).

init() -> gb_trees:empty().

add_entry(Key, Data, Tree1) ->
    Tree2 = gb_trees:enter( Key, Data, Tree1),
    io:format("gbt_r lookup ~p ~p~n ",[Key, Data]),
    Tree2. 
```

并使用它：

```
T = gbtree:init(),

T1 = gbtree:add_entry(2,this_is_data,T). 
```

# php - PHP mysqli 表查询给出了我想针对另一个表查询的多个结果

> ID：15365539
> 
> 赞同：0
> 
> 时间：2013-03-12T15:38:31.683
> 
> 标签：php, mysqli

我一直在研究一个社交网络，我有一个粉丝页面表，用户可以为他们最喜欢的乐队或名人创建个人资料，还有另一个名为朋友的表，他们可以订阅粉丝页面。然后，我希望请求出现在粉丝页面管理员的通知中，以除外。在第一个 sql 查询之后，它返回具有多个值的粉丝页面，但是如果我回显下一个 $sql 查询，它表明它只选择一个结果来查询而不是全部。

所以基本上我需要查询用户登录（$log_username）创建的所有粉丝页面的粉丝页面表，然后我需要获取这些粉丝页面并查询朋友表以了解是否有人请求订阅用户粉丝页面？

谢谢你的帮助迈克尔

```
 <?php
$fanpage_requests = '';

$fansql = "SELECT created_by, fanpage_name FROM `fanpages`  WHERE created_by = '$log_username' ";
$fanquery = mysqli_query($db_conx, $fansql);
$fannumrows = mysqli_num_rows($fanquery);

if($fannumrows < 1){
    $fanpage_requests = 'No friend requests';
} else {

    while($row = mysqli_fetch_array($fanquery, MYSQLI_ASSOC)) {
        $fanpage_name = $row["fanpage_name"];
        $created_by = $row["created_by"];

        $fansubSql = "SELECT * FROM friends WHERE user2='$fanpage_name' AND accepted='0' ORDER BY datemade ASC";
        $fansubQuery = mysqli_query($db_conx, $fansubSql);
        $fansubNumrows = mysqli_num_rows($fansubQuery);
        //print_r ($fansubNumrows);     
        if($fansubNumrows < 1){
            $fanpage_requests = "blah blah"; 
        }
        print_r ($fansubNumrows);
        while ($fansubRow = mysqli_fetch_array($fansubQuery, MYSQLI_ASSOC)) {
            $fansubreqID = $fansubRow["id"];
            $fansubuser1 = $fansubRow["user1"];
            $fansubdatemade = $fansubRow["datemade"];
            $fansubdatemade = strftime("%B %d", strtotime($fansubdatemade));

            $fansubthumbquery = mysqli_query($db_conx, "SELECT avatar FROM users WHERE username='$fansubuser1' LIMIT 1");
            $fansubthumbrow = mysqli_fetch_row($fansubthumbquery);
            $fansubuser1avatar = $fansubthumbrow[0];
            $fansubuser1pic = '<img src="user/'.$fansubuser1.'/'.$fansubuser1avatar.'" alt="'.$fansubuser1.'" class="user_pic">';

            if($fansubuser1avatar == NULL){
                $fansubuser1pic = '<img src="images/avatardefault.jpg" alt="'.$fansubuser1.'" class="user_pic">';
            }

            $fanpage_requests .= '<div id="friendreq_'.$fansubreqID.'" class="friendrequests">';
            $fanpage_requests .= '<a href="user.php?u='.$fansubuser1.'">'.$fansubuser1pic.'</a>';
            $fanpage_requests .= '<div class="user_info" id="user_info_'.$fansubreqID.'">'.$fansubdatemade.' <a href="user.php?u='.$fansubuser1.'">'.$fansubuser1.'</a> requests friendship<br /><br />';
            $fanpage_requests .= '<button onclick="fanReqHandler(\'accept\',\''.$fansubreqID.'\',\''.$fansubuser1.'\',\'user_info_'.$fansubreqID.'\')">accept</button> or ';
            $fanpage_requests .= '<button onclick="fanReqHandler(\'reject\',\''.$fansubreqID.'\',\''.$fansubuser1.'\',\'user_info_'.$fansubreqID.'\')">reject</button>';
            $fanpage_requests .= '</div>';
            $fanpage_requests .= '</div>';
        }
    }
}
?> 
```

print_r 输出现在是 001110 我得到了等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T09:35:58.313

好的，因此确定您需要稍后关闭循环，它无法正常工作的原因是因为现在您在不同的循环中使用相同的变量，因此值被覆盖（例如`$query`）。

您需要根据需要不同的所有变量清楚地区分循环：

```
<?php
    $friend_requests = '';

    $sql = "SELECT created_by, fanpage_name FROM `fanpages`  WHERE created_by = '$log_username' ";
    $query = mysqli_query($db_conx, $sql);
    $numrows = mysqli_num_rows($query);

    if($numrows < 1){
        $friend_requests = 'No friend requests';
    } else {

        while($row = mysqli_fetch_array($query, MYSQLI_ASSOC)) {
            $fanpage_name = $row["fanpage_name"];
            $created_by = $row["created_by"];

            $friendsSql = "SELECT * FROM friends WHERE user2='$fanpage_name' AND accepted='0' ORDER BY datemade ASC";
            $friendsQuery = mysqli_query($db_conx, $friendsSql);
            $friendsNumrows = mysqli_num_rows($friendsQuery);
            $fanpage_requests = "$friendsSql";

            if($friendsNumrows < 1){
                $fanpage_requests = "$fanpage_name"; **//this shows that only 1 query is being queried in this second sql statement**
            }

            while ($friendsRow = mysqli_fetch_array($friendsQuery, MYSQLI_ASSOC)) {
                $reqID = $friendsRow["id"];
                $user1 = $friendsRow["user1"];
                $datemade = $friendsRow["datemade"];
                $datemade = strftime("%B %d", strtotime($datemade));

                $thumbquery = mysqli_query($db_conx, "SELECT avatar FROM users WHERE username='$user1' LIMIT 1");
                $thumbrow = mysqli_fetch_row($thumbquery);
                $user1avatar = $thumbrow[0];
                $user1pic = '<img src="user/'.$user1.'/'.$user1avatar.'" alt="'.$user1.'" class="user_pic">';

                if($user1avatar == NULL){
                    $user1pic = '<img src="images/avatardefault.jpg" alt="'.$user1.'" class="user_pic">';
                }

                $fanpage_requests .= '<div id="friendreq_'.$reqID.'" class="friendrequests">';
                $fanpage_requests .= '<a href="user.php?u='.$user1.'">'.$user1pic.'</a>';
                $fanpage_requests .= '<div class="user_info" id="user_info_'.$reqID.'">'.$datemade.' <a href="user.php?u='.$user1.'">'.$user1.'</a> requests friendship<br /><br />';
                $fanpage_requests .= '<button onclick="fanReqHandler(\'accept\',\''.$reqID.'\',\''.$user1.'\',\'user_info_'.$reqID.'\')">accept</button> or ';
                $fanpage_requests .= '<button onclick="fanReqHandler(\'reject\',\''.$reqID.'\',\''.$user1.'\',\'user_info_'.$reqID.'\')">reject</button>';
                $fanpage_requests .= '</div>';
                $fanpage_requests .= '</div>';
            }
        }
    }
?> 
```

# objective-c - UILocalNotification 每周六上午 12:00

> ID：15365543
> 
> 赞同：3
> 
> 时间：2013-03-12T15:38:38.187
> 
> 标签：objective-c, nsdate, uilocalnotification, repeat, nsdatecomponents

我尝试每周六重复 UILocalNotification 但我没有成功。我尝试以下方法：

```
// Create notification for every saturday at 12:00 am
NSCalendar *gregorian = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
NSDateComponents *components = [gregorian components:NSUIntegerMax fromDate:[NSDate date]];
[components setWeekday:7]; // Saturday
[components setHour:12]; // 12 am
[components setMinute:0];
[components setSecond:0];

NSDate *fireDate = [gregorian dateFromComponents:components];         
NSLog(@"%@", fireDate);

[[NotificationsManager sharedManager] configureLocalAlertMessage:message
                                                                    fireDate:fireDate
                                                          repeatIntervalUnit:NSWeekCalendarUnit
                                                                        type:kNotificationTypeMoneyBox]; 
```

但是“fireDate”返回：“2013-03-12 11:00:00 +0000”，即今天。

有什么帮助吗？谢谢！

**编辑：**

配置通知的代码

```
- (void)configureLocalAlertMessage:(NSString *)message fireDate:(NSDate *)date repeatIntervalUnit:(NSCalendarUnit)repeat type:(NotificationType)type {

    // Local notification
    UILocalNotification *notification = [[UILocalNotification alloc] init];
    notification.timeZone = [NSTimeZone systemTimeZone];
    notification.fireDate = date;
    notification.repeatInterval = repeat;
    notification.soundName = UILocalNotificationDefaultSoundName;
    notification.hasAction = YES;
    notification.alertBody = message;
    notification.userInfo = @{kNotificationTypeKey : @(type)};
    notification.applicationIconBadgeNumber = [[UIApplication sharedApplication] applicationIconBadgeNumber] + 1;

    // Schedule
    [[UIApplication sharedApplication] scheduleLocalNotification:notification];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-13T06:48:09.930

```
 NSCalendar *gregorian = [[NSCalendar alloc]initWithCalendarIdentifier:NSGregorianCalendar];
    NSDateComponents *weekdayComponents =[gregorian components:(NSDayCalendarUnit |               NSWeekdayCalendarUnit | NSWeekCalendarUnit | NSYearCalendarUnit) fromDate:idate];

    int weekday = [weekdayComponents weekday];
    NSDate *nextdate ;
    NSDateComponents *offsetComponents = [[NSDateComponents alloc] init];
    if(weekday <= 5)
    {
       /* it is my case to check the weekday, if it is less or greater than 5*/
    }
    else
    {
        [offsetComponents setDay:7];
        [offsetComponents setHour:12];
        [offsetComponents setMinute:0];
        [offsetComponents setSecond:0];
        nextdate = [gregorian dateByAddingComponents:offsetComponents toDate:idate options:0];
    }
    [offsetComponents release];
    [gregorian release]; 
```

您可以将此**下一个日期**用作本地通知的触发日期。这里**idate**是 NSDate *idate = [NSDate date];

# sql - 访问插入错误：在访问号码字段中输入号码

> ID：15365545
> 
> 赞同：1
> 
> 时间：2013-03-12T15:38:39.743
> 
> 标签：sql, ms-access, sql-insert

我使用 Access 数据库编写了一个 java 程序，我可以记录字符串值，但是我使用数字字段列为数字值编写的查询会生成一个 INSERT INTO 错误。以下是查询和错误。

```
Level - Col in table with number field

Access Insert Statement:
INSERT INTO SystemEquipment(Level) Values (12);

Error:
[Microsoft][ODBC Microsoft Access Driver] Syntax error in INSERT INTO statement.

**Tried to run the query with and without single quotes and semicolons 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:40:31.137

因为`LEVEL`是保留关键字。您必须使用`[]`

```
INSERT INTO SystemEquipment([Level]) Values (12); 
```

*   [MS Access 保留关键字](http://office.microsoft.com/en-001/access-help/access-2007-reserved-words-and-symbols-HA010030643.aspx)

来自 MS Access Docs，

> 如果保留字已被使用，**您可以通过用括号 ([]) 将每个出现的字括起来来避免错误消息**。但是，最好的解决方案是将名称更改为非保留字。

# python - 识别 csv 文件中的排列（并计算它们）

> ID：15365549
> 
> 赞同：2
> 
> 时间：2013-03-12T15:38:52.297
> 
> 标签：python, csv

尝试从`csv`文件中获取数据这是我的 csv 文件的外观：

```
a,0,b,2,c,6,G,4,l,6,mi,2,m,0,s,4
a,2,b,2,c,0,G,4,l,6,mi,4,m,0,s,6
a,4,b,2,c,6,G,6,l,2,mi,4,m,0,s,0
a,2,b,0,c,2,G,6,l,4,mi,4,m,0,s,6
a,2,b,2,c,6,G,4,l,0,mi,6,m,0,s,4
a,2,b,6,c,0,G,6,l,0,mi,4,m,2,s,4
a,0,b,6,c,4,G,2,l,0,mi,6,m,4,s,2
a,6,b,6,c,4,G,0,l,0,mi,2,m,4,s,2 
```

因此，例如在行 [0] 中，根据`line 1,3,5,7,9,11,13,15` 我需要获取的数值`0,2,4,6,10,12,14`

更深层次的例子：从第 1 行开始：我需要得到

```
 a,m = 0
b,mi = 2
c,l = 6
G,s =4 
```

最后，我要补充一下，哪两个组合最高。所以本质上是每个的总和。

为此：

```
# Sanitize filelist to keep only *.csv files    
def sanitize_filelist(filelist):

    sanitized_filelist = []

    # Keep only the log file
    for file in range(len(filelist)):
        if string.lower(filelist[file][-4:]) == '.csv':
            sanitized_filelist += [filelist[file]]
#    print sanitized_filelist
    return sanitized_filelist

def parse_files(dataset_path,file):
    threads = [0,2,4,6,10,12,14]
    coreid  = [1,3,5,7,9,11,13,15]
    cores = [0,2,4,6]
    thread_data = [[],[],[],[],[],[],[]]
    #core = [[],[],[],[],[],[],[]]
        threadcorecount = [[0 for a in range(0,4)] for b in range(0,8)]
    dataset = csv.reader(open(dataset_path, 'rb'), delimiter=',')
    for line in dataset:
        #print line
        for thread in range(len(threads)):
            thread_data[thread] = line[threads[thread]]
        for core in range(len(threads)):
            if line[coreid[core]] == cores[0]:
                sub = core - 1
                print thread_data[sub],cores[0] 
```

我写了这个片段 - 仍然是一个测试版本。我无法获取值并打印。没有错误..我不明白错误是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:45:14.117

如果我理解了您的所有请求，下面的代码应该可以解决问题：`results`如果您想访问每行中的值（或将`counter`变量保存在某处），您可以使用该变量，并`sorted_results`获取可能排列的计数。

一些参考资料：

*   [lambda 函数](http://www.diveintopython.net/power_of_introspection/lambda_functions.html)（现在被更长的代码取代）
*   [柜台类](http://docs.python.org/dev/library/collections#collections.Counter)
*   [按值排序字典](https://stackoverflow.com/questions/613183/python-sort-a-dictionary-by-value)（在 sorted_results 中使用）
*   [运算符模块](http://docs.python.org/2/library/operator.html)（在 sorted_results 中使用）

这是代码：

```
import csv
from collections import Counter
import operator

def parse_files(dataset_path,f):  # please avoid using reserved words like file
    threads = range(0,16,2)
    dataset = csv.reader(open(dataset_path,'rb'), delimiter=',')
    results = []
    for line in dataset:
        counter = {str(x):[] for x in range(0,8,2)}
        # map(lambda x:counter[line[x+1]].append(line[x]), threads)
        # map(lambda ...) is just a more pythonic way to write the following two lines
        for index in threads:
            counter[line[index+1]].append(line[index])
        # now counter is something like 
        #{'0': ['c', 'l'], '2': ['a', 'm'], '4': ['mi', 's'], '6': ['b', 'G']}

        results.extend([','.join(v)+'='+k for k,v in counter.items()])
        # in results, I'm appending something like this:
        # {'c,l=6', 'a,m=0', 'b,mi=2', 'G,s=4'}

    sorted_results = sorted(dict(Counter(results)).iteritems(), key=operator.itemgetter(1), reverse=True)
    print '\n'.join(['The couple %s appears %d times'%el for el in sorted_results])

    # >>> The couple a,b=2 appears 2 times
    # >>> The couple c,m=4 appears 2 times
    # >>> The couple G,s=4 appears 2 times
    # >>> The couple c,mi=6 appears 1 times
    # >>> The couple a,m=2 appears 1 times
    # >>> ... 
```

# mule - Mule 如何使 jms 出站端点使用 ObjectMessage 而不是 StreamMessage

> ID：15365554
> 
> 赞同：1
> 
> 时间：2013-03-12T15:39:06.877
> 
> 标签：mule, mule-studio

我有一个带有自定义拦截器的 Mule 流，它构造一个对象并将其转发到 JMS 出站端点。JMS 端点在尝试将 Object 转换为 JMS StreamMessage 时抛出异常。我想要的是端点将 Object 转换为 JMS ObjectMessage。那怎么做？

这是我的流程；

```
<spring:beans>
    <spring:bean id="connectionFactoryFactory" name="connectionFactoryFactory"
        class="ConnectionFactoryFactory">
        <spring:property name="properties">
            <spring:props>
                <spring:prop key="imqAddressList">mqtcp://localhost:30001/jms</spring:prop>
                <spring:prop key="imqReconnectAttempts">-1</spring:prop>
            </spring:props>
        </spring:property>
    </spring:bean>

    <spring:bean id="connectionFactory" name="connectionFactory"
        factory-bean="connectionFactoryFactory" factory-method="createConnectionFactory" />
</spring:beans>

<jms:connector name="JMSConnector" connectionFactory-ref="connectionFactory"
    specification="1.1" doc:name="JMS" />

<flow name="Request" doc:name="Request">
    <quartz:inbound-endpoint responseTimeout="10000"
        doc:name="InfoRequest" jobName="InfoRequest" repeatInterval="5000">
        <quartz:event-generator-job />
    </quartz:inbound-endpoint>
    <custom-interceptor class="StateRequest"/>
    <jms:outbound-endpoint connector-ref="JMSConnector"
        doc:name="JMS" topic="requests"/>
</flow> 
```

我还尝试将对象添加到 JMS 消息转换器；

```
<jms:object-to-jmsmessage-transformer returnClass="javax.jms.ObjectMessage" name="Object_to_JmsMessage" doc:name="Object to JmsMessage"/>

    <jms:outbound-endpoint connector-ref="JMSConnector"
        doc:name="JMS" topic="requests" transformer-refs="Object_to_JmsMessage"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T21:46:43.747

因为`Request extends LinkedList<RequestId> implements Serializable`，Mule 会自动将此类型转换为`StreamMessage`.

不幸的是，这种行为是在一个静态类中，因此很难与另一个类交换。`ObjectMessage`从代码或子类创建您自己的 JMS`AbstractJmsTransformer`以创建您自己的风格，`ObjectToJMSMessage`这将需要`JmsMessageUtils.serializableToMessage`type 的有效负载`Request`。

# wpf - 将 Setter 值绑定到 DynamicResource

> ID：15365558
> 
> 赞同：6
> 
> 时间：2013-03-12T15:39:13.320
> 
> 标签：wpf, binding, setter, dynamicresource

我正在后面的代码中创建触发器，并且我正在尝试将 setter 的值绑定到在后面的代码中创建的动态资源，这样我就可以随时更新资源并且仍然更新 setter 的值。我到此为止

```
SolidColorBrush brush = Brushes.Red;
Resources.Add("NewBrush",brush);
Setter setter = new Setter();
setter.Property = Control.BackgroundProperty; 
```

但我不确定如何将设置器的值绑定到创建的动态资源。我不能简单地在 XAML 中创建资源，因为需要动态创建资源。如何将 Setter 的值绑定到动态资源，以便更改资源将改变 setter 的值。

更多信息需要澄清。这一切都在后面的代码中完成，因为一切都是动态生成的。触发器、设置器、格式化、控件都是基于 XML 结构创建的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T16:19:58.413

一些使用[ILSpy 的](http://www.ilspy.net/)反编译帮助解决了这个问题：

```
public partial class MainWindow : Window
    {
        public MainWindow()
        {
            this.InitializeComponent();

            var style = new Style(typeof (Button));

            var brush = new SolidColorBrush(Colors.Blue);

            Resources["TheColor"] = brush;
            var dynamicResource = new DynamicResourceExtension("TheColor");

            var setter = new Setter()
                {
                    Property = Control.BackgroundProperty,
                    Value = dynamicResource
                };
            style.Setters.Add(setter);

            button1.Style = style;
        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {
            var brush = new SolidColorBrush(Colors.Red);

            Resources["TheColor"] = brush;
        }
    } 
```

有趣的是，Setter.Value 需要一个 DynamicResourceExtension 的值。我最初认为由 DynamicResourceExtension.ProvideValue() 生成的表达式将是 setter 值应该采用的。无论如何，这似乎有效。

# ios - 特殊 iOS 对象的图形布局

> ID：15365559
> 
> 赞同：0
> 
> 时间：2013-03-12T15:39:18.953
> 
> 标签：ios

我想用一个像指南针一样的圆圈来构建一个 iPhone/iPad 视图。应该有在圈内触摸的能力。然后从圆圈的中间画一条线到您触摸的点。我喜欢测量这条线的长度和角度。

有没有像 Cocos2D 这样我应该学习和使用的库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:09:26.967

基本上，您只想绑定触摸事件。当有人在屏幕上触摸时，**检测他们触摸**的位置，并将其与您确定的要测量的中心点进行比较（如果该中心点显示可见，则对用户很有帮助）。之后，确定角度和长度是简单的数学运算。长度将在屏幕的分辨率中，因此您需要将其转换为您想要的任何度量单位。

这是找到接触点的代码，其他一切都应该很简单：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event 
{
    UITouch *touch = [[event allTouches] anyObject];
    CGPoint touchLocation = [touch locationInView:self.contentView];
} 
```

# javascript - 为什么这些随机数会慢慢趋向负值？

> ID：15365560
> 
> 赞同：4
> 
> 时间：2013-03-12T15:39:21.973
> 
> 标签：javascript, random, skew, chaos

该程序应该执行以下操作：

1.  初始化值网格，“ActualGridValues”，（X 行 X Y 列）等于 0。
2.  创建另一个值网格，“RandomGridValues”，（X 行 X 列），将网格中的每个单元格定义为等于 -Z 到 Z 范围内的 N 个随机数的平均值。
3.  将 RandomGridValues 中的数字添加到 ActualGridValues 中的相应单元格。
4.  对于 ActualGridValues 中的每个单元格，它还会添加相邻单元格的值。
5.  无限重复步骤 2-4。

结果是随机结构在网格内合并。高正值的分组会影响附近的单元格并导致它们偏高，而低负值的分组也会这样做但偏低。

所有单元格中所有值的和积应该为零。尽管存在高偏斜和低偏斜数字的局部组，但在足够大的样本量下，所有单元格的总数应该为零。

问题是，在说 1000 次迭代之后，这些值始终是负的。你有结构和本地化的高点和低点，但总值总是偏向负数。（这意味着随着时间的推移，整个网格变得只有负数）。

每次运行模拟时，这些值都会出现负偏斜。关于为什么的任何想法？

**编辑**：我已将问题隔离到以下功能。RandomGridValue 中所有数字的平均值几乎总是为负。

```
//For every cell value, this function generates a string of random numbers between -RandMax/2 and +RandMax/2\. It then takes the average of all of these numbers. It assigns that value to a cell in the RandomGridValue array. 

function AddChaos() {
     for (var l = 0; l < GridX; l++) {
         for (var m = 0; m < GridY; m++) {
             var RandomGrid = 0;
             for (var n = 0; n < RandNums; n++) {
                 RandomGrid = RandomGrid + Math.random() * RandMax * 2 - RandMax;
             }
             RandomGridValue[l][m] = RandomGrid / RandNums;
         }
     }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T18:16:43.450

由于 Javascript 实现的浮点标准，用十进制值进行算术运算至少可以说是错误的......

一种解决方法是通过乘以 100 将小数转换为整数，然后进行数学运算然后除以 100。

仅当您最多有 2 个小数位时，这才有效。如果您需要比这更高的精度，我会推荐 Javascript 以外的语言用于该部分。

# magento - 显示购物车数量的正确方法

> ID：15365564
> 
> 赞同：0
> 
> 时间：2013-03-12T15:39:34.507
> 
> 标签：magento

在标题中显示购物车数量时遇到问题。我只是在使用`Mage::helper('checkout/cart')->getSummaryCount()`. *有时*效果很好，但是在首页上无法正确显示。我感觉这与我们的整页缓存有关。

我联系了 Magento 支持，他们说我的做法与他们的做法不同。但不会给我答案。

任何人都可以阐明显示购物车数量的正确方法吗？

# asp.net - 在跨页面回发期间，用户输入被 page_load 覆盖

> ID：15365567
> 
> 赞同：0
> 
> 时间：2013-03-12T15:39:38.573
> 
> 标签：asp.net, cross-page-postback

1源页面具有如下页面加载方法：

```
protected void Page_Load(object sender, EventArgs e)
        {
                TextBox1.Text = DateTime.Today.AddDays(1).ToShortDateString();
        } 
```

它将产生一个 textbox1.text 以显示明天源页面呈现的日期。我将此源页面交叉回发到目标页面，并且在目标页面加载事件中我有

```
if (Page.PreviousPage != null && PreviousPage.IsCrossPagePostBack == true)
            {
              TextBox SourceTextBox1 = (TextBox)Page.PreviousPage.FindControl("TextBox1");
                if (SourceTextBox1 != null)
                {
                    Label1.Text = SourceTextBox1.Text;
                 }
              } 
```

问题是如果用户更改 textbox1 的内容，假设目标页面上的 label1 应该捕获用户输入并显示它，但现在它只显示我在源页面加载事件中设置的任何内容。我了解自我页面回发生命周期，但这是跨页面回发。IMO，源页面加载事件与此无关，但为什么它会覆盖用户输入？任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:42:22.643

Just surround this with a `if(!IsPostBack)` check:

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!IsPostBack)
    {
        TextBox1.Text = DateTime.Today.AddDays(1).ToShortDateString();
    }
} 
```

Otherwise the value will be overwritten on every postback. So when you `Server.Transfer` it to the other page it is already changed.

# java - 无法将 Eclipse 创建的 WAR 文件正确部署到 Tomcat

> ID：15365574
> 
> 赞同：6
> 
> 时间：2013-03-12T15:39:50.187
> 
> 标签：java, eclipse, tomcat, war

我会告诉你我已经完成的所有步骤。我还会提供一些图片，以使我的问题更容易理解。任何建议都会很好。

不得不说我用

Tomcat 6（安装在 C:\Program Files\Apache Software Foundation\Tomcat 6.0）

Eclipse 3.7（靛蓝）

Eclipse 3.7 的 Google 插件（用于使用 GWT）

在 Eclipse 中，我创建了一个服务器 ![在此处输入图像描述](../Images/3582763f531bd310402c83eb69a52986.png) ，我将 $CATALINA_HOME 设置在 C:\Program Files\Apache Software Foundation\Tomcat 6.0

我还应该说，当我尝试从 Eclipse 运行 Tomcat 时出现异常（我的意思是 R-click on server -> start）。

```
INFO: Starting Servlet Engine: Apache Tomcat/6.0.36
12 бер 2013 17:01:38 org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory docs
12 бер 2013 17:01:38 org.apache.jasper.EmbeddedServletOptions <init>
SEVERE: The scratchDir you specified: C:\Program Files\Apache Software Foundation\Tomcat 6.0\work\Catalina\localhost\docs is unusable.
12 бер 2013 17:01:38 org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory helloserver
12 бер 2013 17:01:38 org.apache.jasper.EmbeddedServletOptions <init>
SEVERE: The scratchDir you specified: C:\Program Files\Apache Software Foundation\Tomcat 6.0\work\Catalina\localhost\helloserver is unusable.
12 бер 2013 17:01:38 org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory manager
12 бер 2013 17:01:38 org.apache.catalina.startup.HostConfig deployDirectory
SEVERE: Error deploying web application directory manager
java.io.FileNotFoundException: C:\Program Files\Apache Software Foundation\Tomcat 6.0\conf\Catalina\localhost\manager.xml (The system cannot find the path specified)
    at java.io.FileOutputStream.open(Native Method)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:194)
    at java.io.FileOutputStream.<init>(FileOutputStream.java:145)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1051)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:1002)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:506)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1317)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:324)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:142)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1065)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
12 бер 2013 17:01:38 org.apache.catalina.startup.HostConfig deployDirectory
INFO: Deploying web application directory ROOT
12 бер 2013 17:01:38 org.apache.jasper.EmbeddedServletOptions <init>
SEVERE: The scratchDir you specified: C:\Program Files\Apache Software Foundation\Tomcat 6.0\work\Catalina\localhost\_ is unusable.
12 бер 2013 17:01:38 org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
12 бер 2013 17:01:38 org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
12 бер 2013 17:01:38 org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/28  config=null
12 бер 2013 17:01:38 org.apache.catalina.startup.Catalina start
INFO: Server startup in 722 ms 
```

我检查了 conf 目录中没有目录。

好的，看看我接下来要做什么（我使用本手册[http://courses.coreservlets.com/Course-Materials/pdf/ajax/GWT-Intro.pdf](http://courses.coreservlets.com/Course-Materials/pdf/ajax/GWT-Intro.pdf)）：

1) 创建一个新的 Web 应用程序项目 (GWT)。它在 Jetty 上运行良好

2）比我需要导出一个WAR文件。 ![在此处输入图像描述](../Images/11b32c30924837d122a9aa818044fe22.png)

3)**第一个问题（也是我认为的主要问题）：** WAR 文件没有转到 C:\Program Files\Apache Software Foundation\Tomcat 6.0\webapps。但它转到 c:\Users\username\AppData\Local\VirtualStore\Program Files\Apache Software Foundation\Tomcat 6.0\webapps\ 。此外，我尝试创建一个动态 Web 项目并尝试在服务器上运行它（r-click -> 运行方式 -> 在服务器上运行）。而且它部署在同一目录中（我的意思是 c:\Users\username\AppData\Local\VirtualStore\Program Files\Apache Software Foundation\Tomcat 6.0\webapps）。我不明白为什么！是什么原因？

4）然后我尝试在桌面上导出WAR文件（我的意思是GWT项目）。一切正常，然后我手动将战争文件放入 C:\Program Files\Apache Software Foundation\Tomcat 6.0\webapps （Tomcat 仍在工作）。

5）**另一个问题是**Tomcat没有解包WAR文件。`http://localhost:8080/helloserver`尝试将其加载到 Web 浏览器 ( )中时，我没有得到任何结果。然后我手动解包 WAR 文件并将 helloserver 目录放到 webapps 中，它就可以工作了！一切正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:39:42.107

日志文件中的初始错误往往表明您没有`manager`安装 tomcat 应用程序（或者可能已安装，但只是配置错误/禁用）。

尝试`manager`通过浏览来验证应用程序是否正常运行

[http://youmachine.domain:8080/manager/html](http://youmachine.domain:8080/manager/html)

如果您可以登录并查看已安装的 Web 应用程序列表，那么您就知道您的 Tomcat 管理器应用程序可以正常工作。

我将猜测并假设后续问题来自尝试使用文件复制部署方案（由您发起以尝试使其工作，或作为 Windows / eclipse 的后备启动）使用文件复制部署方案，它是被重定向，因为这是应用程序存储方案的本地。

您真的想通过管理器应用程序上传 WAR，不要费心尝试修复复制方案，因为它在后面的 Windows 系统上与虚拟应用程序存储配置方案一起运行。

# ios - 核心数据撤消特定记录

> ID：15365575
> 
> 赞同：0
> 
> 时间：2013-03-12T15:39:55.627
> 
> 标签：ios, core-data, nsundomanager

我有添加、更新的记录。然后将它们与服务器同步。根据服务器响应，如果其中一个更新失败，我希望将 NSManagedObject 设置为以前的值。在我研究时，UndoManager 作为堆栈工作，所以我找不到任何带有 Id 的记录并撤消该记录，对吗？

最后，您对这个问题有何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:30:36.017

您可以通过引入您自己的 ID 属性并将其与服务器同步来跟踪您的对象。我认为这是一个坚固而坚固的设计 - 我已经多次使用它而没有问题。

Apple 确实为每个托管对象提供了一个 objectID，但这实际上是为了确保跨不同托管对象上下文的数据的一致性。我不建议为外部系统“滥用”这个 ID。

您的服务器可以提供旧值（连同未更新的消息），您可以将其写回您的核心数据存储区，使用您的 ID 属性查找记录。对于更精细的更改和更新管理，您甚至可以使用时间戳属性。

# cordova - [PhoneGap][Check Connection] 不适用于 http://docs.phonegap.com 中的示例

> ID：15365577
> 
> 赞同：0
> 
> 时间：2013-03-12T15:39:57.527
> 
> 标签：cordova

```
<!DOCTYPE HTML>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Test</title>
<script type="text/javascript" charset="utf-8" src="cordova-2.3.0.js"></script>
<script type="text/javascript" charset="utf-8">

function load()
{
    checkConnection();
}

function checkConnection() 
{
    alert('0000');
    var networkState = navigator.network.connection.type;

    alert('111');

    var states = {};
    states[Connection.UNKNOWN]  = 'Unknown connection';
    states[Connection.ETHERNET] = 'Ethernet connection';
    states[Connection.WIFI]     = 'WiFi connection';
    states[Connection.CELL_2G]  = 'Cell 2G connection';
    states[Connection.CELL_3G]  = 'Cell 3G connection';
    states[Connection.CELL_4G]  = 'Cell 4G connection';
    states[Connection.NONE]     = 'No network connection';
    alert('2222');
    alert('Connection type: ' + states[networkState]);

    //if (networkState != Connection.NONE){
    // redirecting to index page

}

</script>

</head>
<body onload="load()">
</body>
</html> 
```

大家好，我知道有很多用于检查互联网连接的示例，我希望这不会被视为重复发布。

我想知道为什么无法处理警报 111

有什么问题吗`"var networkState = navigator.network.connection.type;"`

但是，我主要参考[http://docs.phonegap.com的编码](http://docs.phonegap.com)

谁能告诉我哪里出了问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T20:01:51.947

好像您在新版本的 PhoneGap 上使用旧代码。PhoneGap从 2.2.0 版本开始将连接 API 更改为使用**navigator.connection.type 。**

# configuration - 小型嵌入式设备的EEPROM参数结构

> ID：15365581
> 
> 赞同：4
> 
> 时间：2013-03-12T15:40:23.303
> 
> 标签：configuration, embedded, microcontroller, eeprom

我在小型嵌入式设备重新设计（PID 控制器）中解决的主要问题是设备参数存储。我在这里部分介绍的旧解决方案是节省空间的，但在添加新参数时维护起来很笨拙。它基于必须与 EEPROM 地址匹配的设备参数 ID，如下面的示例所示：

```
// EEPROM variable addresses

#define EE_CRC                       0          // EEPROM CRC-16 value

#define EE_PROCESS_BIAS              1          // FLOAT, -100.00 - 100.00 U
#define EE_SETPOINT_VALUE            3          // FLOAT, -9999 - 9999.9
#define EE_SETPOINT_BIAS             5          // CHAR, -100 - 100 U
#define EE_PID_USED                  6          // BYTE, 1 - 3
#define EE_OUTPUT_ACTION             7          // LIST, DIRE/OBRNU
#define EE_OUTPUT_TYPE               8          // LIST, GRIJA/MOTOR

#define EE_PROCESS_BIAS2             9          // FLOAT, -100.00 - 100.00 U
#define EE_SETPOINT_VALUE2          11          // FLOAT, -9999 - 9999.9
#define EE_SETPOINT_BIAS2           13          // CHAR, -100 - 100 U
#define EE_PID_USED2                14          // BYTE, 1 - 3
#define EE_OUTPUT_ACTION2           15          // LIST, DIRE/OBRNU
#define EE_OUTPUT_TYPE2             16          // LIST, GRIJA/MOTOR

#define EE_LINOUT_CALIB_ZERO        17          // FLOAT, -100.0 - 100.0
#define EE_LINOUT_CALIB_GAIN        19          // FLOAT, -2.0 - 2.0 
```

每个地址都是硬编码的，下一个地址是根据之前的数据大小定义的（注意地址之间的间距不均匀）。它很有效，因为没有浪费 EEPROM 数据存储，但很难在不引入错误的情况下进行扩展。

在代码的其他部分（即 HMI 菜单、数据存储...），代码将使用与刚刚给出的地址匹配的参数列表，如下所示：

```
// Parameter identification, NEVER USE 0 (zero) as ID since it's NULL
// Sequence is not important, but MUST be same as in setparam structure

#define ID_ENTER_PASSWORD_OPER             1 
#define ID_ENTER_PASSWORD_PROGRAM          2 
#define ID_ENTER_PASSWORD_CONFIG           3 
#define ID_ENTER_PASSWORD_CALIB            4 
#define ID_ENTER_PASSWORD_TEST             5 
#define ID_ENTER_PASSWORD_TREGU            6 

#define ID_PROCESS_BIAS                    7
#define ID_SETPOINT_VALUE                  8
#define ID_SETPOINT_BIAS                   9
#define ID_PID_USED                       10 
#define ID_OUTPUT_ACTION                  11
#define ID_OUTPUT_TYPE                    12

#define ID_PROCESS_BIAS2                  13

... 
```

然后在使用这些参数的代码中，例如在下面给出的用户菜单结构中，我使用我自己的 PARAM 类型（结构）构建了项目：

```
struct param {                      // Parametar decription
   WORD   ParamID;                    // Unique parameter ID, never use zero value
   BYTE   ParamType;                  // Parametar type
   char   Lower[EDITSIZE];            // Lowest value string
   char   Upper[EDITSIZE];            // Highest value string
   char   Default[EDITSIZE];          // Default value string
   BYTE   ParamAddr;                  // Parametar address (in it's media)
};                                  

typedef struct param PARAM; 
```

现在参数列表构建为结构数组：

```
PARAM code setparam[] = {
  {NULL, NULL, NULL, NULL, NULL, NULL},                   // ID 0 doesn't exist

  {ID_ENTER_PASSWORD_OPER, T_PASS, "0", "9999", "0", NULL},
  {ID_ENTER_PASSWORD_PROGRAM, T_PASS, "0", "9999", "0", NULL},
  {ID_ENTER_PASSWORD_CONFIG, T_PASS, "0", "9999", "0", NULL},
  {ID_ENTER_PASSWORD_CALIB, T_PASS, "0", "9999", "0", NULL},
  {ID_ENTER_PASSWORD_TEST, T_PASS, "0", "9999", "0", NULL},
  {ID_ENTER_PASSWORD_TREGU, T_PASS, "0", "9999", "0", NULL},  

  {ID_PROCESS_BIAS, T_FLOAT, "-100.0", "100.0", "0", EE_PROCESS_BIAS},
  {ID_SETPOINT_VALUE, T_FLOAT, "-999", "9999", "0.0", EE_SETPOINT_VALUE},
  {ID_SETPOINT_BIAS, T_CHAR, "-100", "100", "0", EE_SETPOINT_BIAS},
  {ID_PID_USED, T_BYTE, "1", "3", "1", EE_PID_USED},
  {ID_OUTPUT_ACTION, T_LIST, "0", "1", "dIrE", EE_OUTPUT_ACTION},
  {ID_OUTPUT_TYPE, T_LIST, "0", "1", "GrIJA", EE_OUTPUT_TYPE},

  {ID_PROCESS_BIAS2, T_FLOAT, "-100.0", "100.0", "0", EE_PROCESS_BIAS2}, 
```

...

本质上，每个参数都有其唯一的 ID，并且该 ID 必须与硬编码的 EEPROM 地址相匹配。由于参数大小不固定，我无法将参数 ID 本身用作 EEPROM（或其他媒体）地址。上例中的 EEPROM 组织是 16 位字，但原则上没关系（更多的空间被浪费在字符上，所以我将来更喜欢 8 位组织）

**问题：**

有没有更优雅的方法来做到这一点？一些哈希表，众所周知的模式，类似问题的标准解决方案？现在 EEPROM 的大小要大得多，我不介意使用固定参数大小（为布尔参数浪费 32 位）来换取更优雅的解决方案。看起来使用固定大小的参数，我可以使用参数 ID 作为地址。这种方法有我看不到的明显缺点吗？

我现在使用的是分布式硬件（HMI、I/O和主控制器是分开的），我想使用所有设备都知道这个参数结构的结构，例如远程I/O知道如何扩展输入值，HMI 知道如何显示和格式化数据，所有这些都仅基于参数 ID。换句话说，我需要一个定义所有参数的地方。

我做了我的谷歌研究，很少能找到不包括一些数据库的小型设备。我什至在考虑一些 XML 定义，它会为我的数据结构生成一些 C 代码，但也许有一些更适合小型设备（高达 512 K 闪存，32 K RAM）的优雅解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:16:06.890

如果您不担心更改或处理器之间的兼容性，您可以简单地在 RAM 和 EEPROM 之间复制结构，并且只访问 RAM 副本的单个成员。

如果您确实想直接在 EEPROM 中显式访问各个成员，您还可以相对轻松地创建一个工具，该工具将从编译器的结构和已知打包规则编译定义列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T16:09:22.913

这就是我要做的。

我将使用您希望在 EEPROM 中拥有的变量创建一个结构的 typedef。

使用您的示例，它看起来像这样：

```
typedef struct eeprom_st
{
    float process_biass;
    float setpoint_value;
    char setpoint_bias;
    ....
} eeprom_st_t; 
```

比我创建一个偏移量定义来标记结构在 EEPROM 中的存储位置。

我会添加一个指向该类型的指针以将其用作虚拟对象：

```
#define EEPROM_OFFSET 0
eeprom_st_t *dummy; 
```

比我会使用*offsetof*来获取我需要的特定变量的偏移量，如下所示：

```
eeprom_write( my_setpoint_bias, EEPROM_OFFSET + offsetof(eeprom_st_t,setpoint_bias),
sizeoff(dummy->setpoint_bias)); 
```

为了让它更优雅，我也会把 eeprom 写例程变成一个宏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T15:28:19.720

我不确定这是否真的比你所拥有的更好，但这是一个想法。为了便于维护，考虑将 EEPROM 地址的知识封装到“eeprom”对象中。现在你有一个参数对象，每个实例都知道它的数据存储在物理 EEPROM 中的什么位置。如果参数对象不知道 EEPROM，可能会更容易维护。相反，一个单独的 eeprom 对象负责物理 EEPROM 和参数对象实例之间的接口。

此外，请考虑将 EEPROM 数据的版本号添加到保存在 EEPROM 中的数据中。如果设备固件更新，EEPROM 数据的格式发生变化，那么这个版本号允许新固件识别和转换旧版本的 EEPROM 数据。

# jquery - 如何将数据存储在 JSON 对象中

> ID：15365589
> 
> 赞同：5
> 
> 时间：2013-03-12T15:40:40.070
> 
> 标签：jquery, json

我有以下结构的数据：

**唯一 ID (int) | 名字（字符串）| 姓氏（字符串）| 百分比（双）**

一组数据可能如下所示：

1 | 约翰 | 汉考克 | 49.5
2 | 约翰 | 汉考克 | 95.0
3 | 简 | 汉考克 | 89.5
4 | 简 | 汉考克 | 73.5
5 | 简 | 汉考克 | 96.5
6 | 弗雷德 | 燧石 | 45.8

我需要将这些数据存储在客户端，以便浏览器可以访问它并且可以使用 jQuery 进行操作。

例如，我在页面上有一个下拉菜单（选择），其中包含三个值：

1) 低百分位数
2) 中百分位数
3) 高百分位数

当用户在下拉列表中选择一个值时，我需要能够从我上面的数据中选择符合所选值的项目。例如，如果他们选择 Low Percentile 值，那么我需要从数据中检索百分比小于 60% 的所有项目。

我对 jQuery 相当多才多艺，但我从来没有用它来存储任何用于客户端检索的此类内容。我可以以某种方式将这些数据存储在客户端的 JSON 对象中，然后可以随意选择和操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:46:39.777

所以基本上：

```
var javascriptObject = $.parseJSON(jsonString);

var jsonString = JSON.stringify(javascriptObject); 
```

JavaScript 很像任何其他 OOP。

```
var foo = {}; //NEW Object
foo.bar = 1;
foo.bars = 2;
foo.bar.date = 3;
var jsonString = JSON.stringify(foo);
//jsonString is now a "JSON Object" that holds the data found in object foo.
console.log(jsonString); //To see what it looks like. 
```

但是，如果所有这些都是为了客户端使用，请坚持使用 JavaScript 对象。无需将它们转换为 JSON。JSON 对象实际上是用于将数据发送到其他源，因为它们是字符串。通常用于 AJAX 请求。

**根据评论进行编辑**

```
$(document).ready(function(){
    var globalObject = {};
    globalObject.foo = 1;
    globalObject.bar = 2;

    $(el).change(function(){
        globalObject.foo = $(this).val();
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:51:16.640

JSON 代表 Javascript 对象表示法。如果您熟悉 Objects，您应该能够使用它。

对于您的示例，我可能会将变量保存为对象数组（因为它首先编号）。希望您不介意将数字重新分配给从零开始的增量（0、1、2...）。

如果你想在客户端保存它，也许你可以做这样的事情：

```
var data = [
{ fname : "John", lname : "Hancock", value : 49.5 },
{ fname : "John", lname : "Hancock", value : 95.0 }
]; 
```

这只是前两个作为示例。然后，您可以使用 for 循环遍历数组`for(var i=0, count = data.length; i < count; i++)`，并对数据执行某些操作 if `data[i].value < 60`。

jQuery 有一个很好的函数，叫做[.each()](http://api.jquery.com/jQuery.each/)，你也可以很容易地使用它。此外，如果需要，您可以将 JSON 保存在 .json 文件中并由[jQuery.getJSON()](http://api.jquery.com/jQuery.getJSON/)调用。两者都可能是了解这一点的良好开端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:56:31.600

虽然我对这个答案并不感到自豪，但它可能会满足您的需求。它也不需要浏览器具有 HTML5 本地存储。

```
<input type="hidden" id="json_data" />

<script type="text/javascript>
    var theData = [
        {
            id: 1,
            firstName: 'John',
            lastName: 'Hancock',
            pct: 49.5
        },
        // other objects
        {
            id: 6,
            firstName: 'Fred',
            lastName: 'Flintstone',
            pct: 45.8
        }
    ];
    var dataAsJsonString = JSON.stringify(theData);
    $('#json_data').val(dataAsJsonString); // store data in hidden field

    // later on...
    var getDataBackOut = $.parseJSON($('#json_data').val());
    // you can now iterate over the array to find what you need
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T15:46:00.080

```
var foo = localStorage.getItem("bar");
// ...
localStorage.setItem("bar", foo); 
```

[使用 HTML5 本地存储](http://diveintohtml5.info/storage.html)

# iphone - 文件共享/在另一个应用程序中发送文件（在 iOS 中“打开”）

> ID：15365592
> 
> 赞同：10
> 
> 时间：2013-03-12T15:40:45.660
> 
> 标签：iphone, ios, xcode, file, share

我的应用程序制作了一个名为 log.txt 的简单文件

该文件的 URL（在 xcode 中查看）是 file://localhost/var/mobile/Applications/ *NUMBER OF THE APPLICATION* /Documents/log.txt

所以我可以在finder中看到这个文件......

我想在我的应用程序中添加“打开方式”功能，以便用户共享此文件（通过邮件或 imessage）或在另一个兼容的应用程序中打开此文件。

这是我所做的：

```
-(void) openDocumentIn {

NSURL *fileURL = [[NSURL alloc] initFileURLWithPath:docFile]; //docFile is the path
//NSLog(@"%@",fileURL); // -> shows the URL in the xcode log window

UIDocumentInteractionController *documentController = [UIDocumentInteractionController interactionControllerWithURL:fileURL];
documentController.delegate = self;
documentController.UTI = @"public.text";
[documentController presentOpenInMenuFromRect:CGRectZero
                                       inView:self.view
                                     animated:YES];
} 
```

然后调用这个函数：

```
-(IBAction)share:(id)sender {
    [self openDocumentIn];
} 
```

当我运行该应用程序时，我单击此“共享”按钮，但除了在日志窗口中显示 URL 的路径外，没有任何附加内容...

我错过了一些东西...

谢谢

编辑：最后，它适用于我真正的 iphone ......模拟器中没有文本查看器！--'

编辑2：它显示了可用的应用程序（页面，凹凸......）但最终崩溃:(((！[看到这里的崩溃图片](https://i.stack.imgur.com/dkoXF.png)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-17T10:14:13.570

它是一个内存管理问题。它崩溃的主要原因是对象没有被保留。这就是为什么如果您在 .h 文件中声明它并在您分配它时为保留写一个 @property 对象将被保留。

所以在你的接口文件（.h）中你应该有

```
@property (retain)UIDocumentInteractionController *documentController; 
```

然后在你的 .m （实现文件）你可以做

```
@synthesize documentController;

- (void)openDocumentIn{

    // Some code here

    self.documentController = [UIDocumentInteractionController interactionControllerWithURL:fileURL];
        documentController.delegate = self;
    documentController.UTI = @"public.text";
    [documentController presentOpenInMenuFromRect:CGRectZero
                                   inView:self.view
                                 animated:YES];
    // Some more stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T18:44:32.750

这是它对我的工作方式：

我只是将声明“UIDocumentInteractionController *documentController”放在 .h 文件中，它就可以工作了！

我真的不知道为什么，但是......

# excel - 为 Outlook/excel 结合 VBA 代码

> ID：15365594
> 
> 赞同：0
> 
> 时间：2013-03-12T15:40:49.040
> 
> 标签：excel, vba, outlook

我有两个单独的代码需要作为一个代码工作。我已经得到了第一个工作，但是在尝试添加第二部分时我犯了一个错误。如何将第二部分添加到第一个代码中？第一个代码是将文件夹中的电子邮件正文导出到 excel 中。第二部分应该将身体的某些部分分解成自己的细胞。

```
Sub ExportMessagesToExcel()
Dim olkMsg As Object, _
    excApp As Object, _
    excWkb As Object, _
    excWks As Object, _
    intRow As Integer, _
    intVersion As Integer, _
    strFilename As String
strFilename = InputBox("Enter a filename (including path) to save the exported messages to.", "Export Messages to Excel")
If strFilename <> "" Then
    intVersion = GetOutlookVersion()
    Set excApp = CreateObject("Excel.Application")
    Set excWkb = excApp.Workbooks.Add()
    Set excWks = excWkb.ActiveSheet
    'Write Excel Column Headers
    With excWks
        .Cells(1, 1) = "Subject"
        .Cells(1, 2) = "Received"
        .Cells(1, 3) = "Sender"
    End With
    intRow = 2
    'Write messages to spreadsheet
    For Each olkMsg In Application.ActiveExplorer.CurrentFolder.Items
        'Only export messages, not receipts or appointment requests, etc.
        If olkMsg.Class = olMail Then
            'Add a row for each field in the message you want to export
            excWks.Cells(intRow, 1) = olkMsg.Subject
            excWks.Cells(intRow, 2) = olkMsg.ReceivedTime
            excWks.Cells(intRow, 3) = GetSMTPAddress(olkMsg, intVersion)
            intRow = intRow + 1
        End If
    Next
    Set olkMsg = Nothing
    excWkb.SaveAs strFilename
    excWkb.Close
End If
Set excWks = Nothing
Set excWkb = Nothing
Set excApp = Nothing
MsgBox "Process complete.  A total of " & intRow - 2 & " messages were exported.", vbInformation + vbOKOnly, "Export messages to Excel"
    End Sub

Private Function GetSMTPAddress(Item As Outlook.MailItem, intOutlookVersion As Integer) As String
Dim olkSnd As Outlook.AddressEntry, olkEnt As Object
On Error Resume Next
Select Case intOutlookVersion
    Case Is < 14
        If Item.SenderEmailType = "EX" Then
            GetSMTPAddress = SMTP2007(Item)
        Else
            GetSMTPAddress = Item.SenderEmailAddress
        End If
    Case Else
        Set olkSnd = Item.Sender
        If olkSnd.AddressEntryUserType = olExchangeUserAddressEntry Then
            Set olkEnt = olkSnd.GetExchangeUser
            GetSMTPAddress = olkEnt.PrimarySmtpAddress
        Else
            GetSMTPAddress = Item.SenderEmailAddress
        End If
End Select
On Error GoTo 0
Set olkPrp = Nothing
Set olkSnd = Nothing
Set olkEnt = Nothing
 End Function

Function GetOutlookVersion() As Integer
Dim arrVer As Variant
arrVer = Split(Outlook.VERSION, ".")
GetOutlookVersion = arrVer(0)
 End Function

 Function SMTP2007(olkMsg As Outlook.MailItem) As String
Dim olkPA As Outlook.PropertyAccessor
On Error Resume Next
Set olkPA = olkMsg.PropertyAccessor
SMTP2007 = olkPA.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x5D01001E")
On Error GoTo 0
Set olkPA = Nothing
End Function 
```

我需要添加的部分是：

```
 Select 
    Range("B2").Formula = "=MID(Trim(Clean(A2)),FIND(""Risk Owner:"",Trim(Clean(A2)))+13,FIND(""Counterparty:"",Trim(Clean(A2)))-FIND(""Risk Owner:"",Trim(Clean(A2)))-13)" 
Range("C2").Formula = "=MID(Trim(Clean(A2)),FIND(""Counterparty:"",Trim(Clean(A2)))+15,FIND(""Trade ID:"",Trim(Clean(A2)))-FIND(""Counterparty:"",Trim(Clean(A2)))-15)" 
Range("D2").Formula = "=MID(TRIM(CLEAN(A2)),FIND(""Trade ID:"",TRIM(CLEAN(A2)))+11,FIND(""Fee Leg ID:"",TRIM(CLEAN(A2)))-FIND(""Trade ID:"",TRIM(CLEAN(A2)))-11)" 
Range("E2").Formula = "=MID(TRIM(CLEAN(A2)),FIND(""Fee Leg ID:"",TRIM(CLEAN(A2)))+13,FIND(""Termination Method:"",TRIM(CLEAN(A2)))-FIND(""Fee Leg ID:"",TRIM(CLEAN(A2)))-13)" 
Range("F2").Formula = "=MID(TRIM(CLEAN(A2)),FIND(""Termination Method:"",TRIM(CLEAN(A2)))+21,FIND(""Termination amount:"",TRIM(CLEAN(A2)))-FIND(""Termination Method:"",TRIM(CLEAN(A2)))-21)" 
Range("G2").Formula = "=MID(TRIM(CLEAN(A2)),FIND(""Termination amount:"",TRIM(CLEAN(A2)))+21,FIND(""Expected Recovery:"",TRIM(CLEAN(A2)))-FIND(""Termination amount:"",TRIM(CLEAN(A2)))-21)" 

 'Copy formulas
Sheets("Import").Select 
Range("B2").Select 
Selection.AutoFill Destination:=Range("B2:B" & LastUsedRow), Type:=xlFillDefault 
Range("C2").Select 
Selection.AutoFill Destination:=Range("C2:C" & LastUsedRow), Type:=xlFillDefault 
Range("D2").Select 
Selection.AutoFill Destination:=Range("D2:D" & LastUsedRow), Type:=xlFillDefault 
Range("E2").Select 
Selection.AutoFill Destination:=Range("E2:E" & LastUsedRow), Type:=xlFillDefault 
Range("F2").Select 
Selection.AutoFill Destination:=Range("F2:F" & LastUsedRow), Type:=xlFillDefault 
Range("G2").Select 
Selection.AutoFill Destination:=Range("G2:G" & LastUsedRow), Type:=xlFillDefault 

 'Paste values to remove formulas
Sheets(Array("Import")).Select 
Sheets("Import").Activate 
Cells.Select 
Selection.Copy 
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False 
```

添加 3/13

```
 Sub ExportMessagesToExcel()
    Dim olkMsg As Object, _
        excApp As Object, _
        excWkb As Object, _
        excWks As Object, _
        intRow As Integer, _
        intVersion As Integer, _
        strBuffer As String, _
        strFilename As String, _
        strTemp As String, _
        arrLines As Variant, _
        varLine As Variant, _
        bolComments As Boolean
    strFilename = InputBox("Enter a filename (including path) to save the exported messages to.", MACRO_NAME)
    If strFilename <> "" Then
        intVersion = GetOutlookVersion()
        Set excApp = CreateObject("Excel.Application")
        Set excWkb = excApp.Workbooks.Add()
        Set excWks = excWkb.ActiveSheet
        'Write Excel Column Headers
        With excWks
            .Cells(1, 1) = "Transaction Type:"
            .Cells(1, 2) = "Select One:"
            .Cells(1, 3) = "Area"
            .Cells(1, 4) = "Store"
            .Cells(1, 5) = "Date"
            .Cells(1, 6) = "Iar Date"
            .Cells(1, 7) = "Name of submitter"
            .Cells(1, 8) = "Key Rec"
            .Cells(1, 9) = "Issue"
            .Cells(1, 10) = "Vendor #"
            .Cells(1, 11) = "Vendor address"
        End With
        intRow = 2
        'Write messages to spreadsheet
        For Each olkMsg In Application.ActiveExplorer.CurrentFolder.Items
            'Only export messages, not receipts or appointment requests, etc.
            If olkMsg.Class = olMail Then
                'Add a row for each field in the message you want to export
                strBuffer = ""
                bolComments = False
                arrLines = Split(olkMsg.Body, vbCrLf)
                For Each varLine In arrLines
                    strTemp = Trim(varLine)
                    If bolComments Then
                    Else
                        If Left(strTemp, 17) = "Transaction Type: " Then
                            excWks.Cells(intRow, 4) = Mid(strTemp, 17)
                        Else
                            If Left(strTemp, 14) = "Select one: " Then
                                excWks.Cells(intRow, 5) = Mid(strTemp, 16)
                            Else
                                If Left(strTemp, 5) = "Area: " Then
                                    excWks.Cells(intRow, 6) = Mid(strTemp, 5)
                                Else
                                    If Left(strTemp, 8) = "Store #: " Then
                                        excWks.Cells(intRow, 7) = Mid(strTemp, 8)
                                    Else
                                        If Left(strTemp, 16) = "Date MM/DD/YYYY: " Then
                                             excWks.Cells(intRow, 8) = Mid(strTemp, 16)
                                       Else
                                        If Left(strTemp, 28) = "IAR Week End Date MM/DD/YYYY: " Then
                                             excWks.Cells(intRow, 9) = Mid(strTemp, 28)
                                          Else
                                            If Left(strTemp, 44) = "Name Title of Person Submitting Issue Sheet: " Then
                                                excWks.Cells(intRow, 10) = Mid(strTemp, 14)
                                            Else
                                                If Left(strTemp, 29) = "Keyrec#: " Then
                                                    excWks.Cells(intRow, 11) = Mid(strTemp, 29)
                                                Else
                                                    If Left(strTemp, 32) = "Detailed Description of Issue: " Then
                                                        excWks.Cells(intRow, 12) = Mid(strTemp, 32)
                                                    Else
                                                        If Left(strTemp, 9) = "Vendor #:" Then
                                                            bolComments = True
                                                        End If
                                                    End If
                                                End If
                                            End If
                                        End If
                                    End If
                                End If
                            End If
                        End If
                    End If
                End If
                Next
                 excWks.Cells(intRow, 10) = strBuffer
                intRow = intRow + 1
            End If
        Next
        Set olkMsg = Nothing
        excWkb.SaveAs strFilename
        excWkb.Close
    End If
    Set excWks = Nothing
    Set excWkb = Nothing
    Set excApp = Nothing
    MsgBox "Process complete."
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:35:55.620

尝试在**End Select**之后添加代码并去掉“Select”这个词

我的意思是，试试这个

```
...
End Select

Range("B2").Formula = "=M .... 
```

而**不是：**

```
...
End Select
Select 
Range("B2").Formula = "=MID( ... 
```

高温高压

菲利普

# javascript - jQuery，缩放和调整图像大小

> ID：15365597
> 
> 赞同：0
> 
> 时间：2013-03-12T15:40:56.613
> 
> 标签：javascript, jquery, css

我正在尝试使图像在大小为 198px 的方形 div 中缩放`overflow:hidden`

魔术类是指一个`img`

```
$('.magic').on('load', function(){
    var self = $(this);
    var width = self.width();
    var height = self.height();
    if(width>height){
        self.css('height', '198px');
        self.css('width', 'auto');
    }
    else{
        self.css('width', '198px');
        self.css('height', 'auto');
    }
}); 
```

现在它`img`正在填充`div`并且不会变得比它更大。

就像在风景照片中一样，它不能完美地缩放，而是拉伸。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:45:11.400

见小提琴：http: [//jsfiddle.net/powtac/VcLKL/19/](http://jsfiddle.net/powtac/VcLKL/19/)

```
$(document).ready(function() {
    $(".magic").each(function(){
        var self = $(this);
        var width = self.width();
        var height = self.height();

        if(width > height){
            self.css('height', '198px');
            var ratio = width / height;
            self.css('width', 198 * ratio);
            self.css('margin-left', ((198 - parseInt(self.css('width')))/2));
        }
        else{
            self.css('width', '198px');
            var ratio = height / width;
            self.css('height', 198 * ratio);
            self.css('margin-top', ((198 - parseInt(self.css('height')))/2));
        }
    });
}); 
```

# php - 无论处理脚本语言如何，如何编写可移植的 HTML 表单？

> ID：15365598
> 
> 赞同：2
> 
> 时间：2013-03-12T15:40:56.217
> 
> 标签：php, asp.net, html

每次我需要为网站进行表单处理时，我都会使用 PHP 进行编码。在编写包含数组的 HTML 表单时，我经常使用方括号表示法：

```
<input type="text" name="fav_food[]"/>
<input type="text" name="fav_food[]"/>
<input type="text" name="fav_food[]"/> 
```

我最近需要为来自ASP背景的受访者写一份表格处理的试卷。所以我去研究了一下“POST array to ASP”，发现很多文章描述了MVC模型的技巧和窍门等，这对于我的小脑袋和ASP知识水平来说过于复杂。

例如，这个[博客](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)展示了如何为 ASP 做这件事：

```
<input type="text" name="fav_food"/>
<input type="text" name="fav_food"/>
<input type="text" name="fav_food"/> 
```

不幸的是，这不适用于 PHP。这让我想知道是否有一种“action=”独立的方式来编写 HTML，这样无论处理脚本语言如何，它都可以工作。

另外，ASP 将如何查看 PHP 表单？它会变成“fav_food”或“fav_food []”的数组还是失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:49:13.543

ASP.NET MVC 还支持方括号表示法（尽管略有不同）。该主题的最佳来源：http: [//haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

如果您需要重用 HTML 表单，则必须调整服务器端处理。ASP.NET MVC 有一个非常灵活的绑定解决方案，可以用来适应任何类型的表单。您还可以在 PHP 中进行一些额外的处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:46:38.090

让它保持独立，我想说在 HTML 和服务器端代码之间添加一些 javascript/jquery。使用 jQuery 收集输入，根据需要格式化 JSON 并对 URL 执行 $.post()，无论是 PHP 还是 ASP，并在脚本代码中处理 JSON。

# php - PHPExcel 检查工作表是否存在

> ID：15365599
> 
> 赞同：14
> 
> 时间：2013-03-12T15:40:59.197
> 
> 标签：php, phpexcel

我正在使用 phpExcel，但找不到任何东西来检查工作表是否存在。我想要完成的是这样的：

```
if(!$excel->sheetExists(1)){
    $excel->createSheet(1);
    $sheet = $excel->setSheet(1);
}
// Do some stuff with the sheet 
```

所以。我的问题：如何检查工作表是否存在？

**编辑**

这行得通吗？

```
try{
    $sheet = $this->excel->setActiveSheetIndex(1);
}catch(Exception $e){
    $excel->createSheet(1);
    $sheet = $excel->setActiveSheetIndex(1);
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-12T15:47:51.657

如果您只是想知道索引 1 处是否存在工作表，那么

```
$sheetCount = $excel->getSheetCount(); 
```

将返回工作表的计数。由于工作表从 0 开始递增索引，因此只有当计数为 2 或更多时，索引 1 处的工作表才会存在。

如果您想知道是否存在命名工作表，那么

```
$sheetNames = $excel->getSheetNames(); 
```

将返回一个工作表名称数组（由它们的索引位置索引），然后您可以使用 in_array() 进行测试；

这

```
$excel->getSheet() 
```

如果请求的工作表（按索引）不存在，方法将抛出异常，因此将其包装在 try/catch 块中将是另一种方法

```
$excel->getSheetByName() 
```

如果命名的工作表不存在，则返回 NULL 值

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T15:48:36.287

[您可以使用sheetNameExists($pSheetName)](http://www.contao-docs.org/docs/php_excel/html/class_p_h_p_excel.html#a366496644a8542dea7d1ecb017aa6452)方法按名称检查工作表是否存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:45:22.010

`getSheet($sheetNumber)`是您检查工作表是否存在的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-23T20:27:20.203

是的，您的代码也可以使用：

```
try {
        $objWorksheet =  $objPHPExcel->setActiveSheetIndex(1); 
}
catch (Exception $e) {
    echo 'Sheet is not exists!';
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-26T08:38:16.570

```
$sheet=$excel->getSheet(1);
// or you can get sheet by name $sheet=$excel->getSheetByName("Sheet1");
if(!empty($sheet)&&is_object($sheet)){
      //sheet already exist
}else{
      //sheet does not exist. Write your code here!
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-09T05:46:34.560

“要知道当前的活动表编号（索引）” $this->activeSheet->getActiveSheetIndex()

注意：$loadExcel=PHPExcel_IOFactory::load("excelSheetName.xlsx"); $this->activeSheet=$loadExcel;

# css - 当设备改变方向时，如何使用 jQuery Mobile 和 CSS 媒体查询切换图像 src？

> ID：15365602
> 
> 赞同：0
> 
> 时间：2013-03-12T15:41:01.620
> 
> 标签：css, jquery-mobile, media-queries

我是媒体查询和 jQuery 的新手。我想做的是当用户切换方向时在移动网站上交换标题图像。奇怪的是，如果用户刷新页面，但在初始加载时出错，我到目前为止所得到的都是有效的。这是脚本：

```
$( document ).ready(function() {
    if($.mobile.media("only screen and (min-device-width: 320px) and (max-device-width: 480px) and (orientation: landscape)")) {
        $("#FlexgridHeader img").attr("src", "http://example.com/path/to/image/header-480x75+.png");
            } else {
                $("#FlexgridHeader img").attr("src", "http://example.com/path/to/image/headers/header-320x75+.png");
            }
    }); 
```

# codeigniter - CodeIgniter 有插件/扩展/模块吗？

> ID：15365603
> 
> 赞同：18
> 
> 时间：2013-03-12T15:41:08.090
> 
> 标签：codeigniter, plugins, reusability

我正在查看一些`PHP`框架，并注意到它们都以各种形式提供可重用、社区贡献的代码：

- **Symfony 2**（捆绑包）： http: [//knpbundles.com/](http://knpbundles.com/)
- **Zend Framework 2**（模块）： http: [//modules.zendframework.com/](http://modules.zendframework.com/)
- **CakePHP**（插件）： http: [//plugins.cakephp.org/](http://plugins.cakephp.org/)
- **Yii 框架**（扩展）：[http ://www.yiiframework.com/extensions/](http://www.yiiframework.com/extensions/)

但我找不到任何代码点火器（*我在[这篇 SO 帖子中看到代码点火器曾经有插件被助手替换](https://stackoverflow.com/questions/6036648/installing-plugins-in-codeigniter-2-0-2)，但是当我用谷歌搜索“代码点火器助手”或“代码点火器插件”时我不能找到任何存储库*）。

**Code Igniter 社区贡献的可重用库的名称是什么？你能分享一个指向他们主存储库的链接吗？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-12T16:15:24.030

你可以看看[sparks](http://getsparks.org/)和[HMVC](https://bitbucket.org/wiredesignz/codeigniter-modular-extensions-hmvc)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T16:22:15.220

你没找到这个？[https://github.com/EllisLab/CodeIgniter/wiki/_pages](https://github.com/EllisLab/CodeIgniter/wiki/_pages)

也检查[他们的论坛](http://ellislab.com/forums)。

codeigniter 中的前一个名称`plugin`与 Cake 的插件或 Symfony 的 Bundles 的含义并不相同

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-25T12:53:58.370

检查这个[很棒的 codeigniter](https://github.com/codeigniter-id/awesome-codeigniter)有 CodeIgniter 的不同资源列表

# python - pandas.DataFrame - 如何按组重新索引？

> ID：15365606
> 
> 赞同：1
> 
> 时间：2013-03-12T15:41:16.667
> 
> 标签：python, pandas

是否可以将新索引分别应用于 DF 进行分组`groupby`？准确地说 - 有没有一种优雅的方法可以做到这一点，并且可以通过`groupby`组更改原始 DF 吗？

UPD：我的数据如下所示：

```
 A  B         C
0  a  x  0.903343
1  a  z  0.982050
2  g  x  0.274823
3  g  y  0.334491
4  c  z  0.756728
5  f  z  0.697841
6  d  z  0.505845
7  b  z  0.768199
8  b  y  0.743012
9  e  x  0.697212 
```

我按列“A”和“B”分组，并且我希望该列的每对唯一值在原始 DF 中都具有相同的索引值。另外 - 原始 DF 可能很大，我试图弄清楚如何在不低效地形成全新 DF 的情况下制作这样的重新索引。

目前我正在使用这个解决方案：

```
df = pd.DataFrame({'A': [random.choice(ascii_lowercase[:5]) for _ in xrange(10)],
                    'B': [random.choice(['x', 'y']) for _ in xrange(10)],
                    'C': [random.random() for _ in xrange(10)]})

df['id'] = None
new_df = pd.DataFrame()
for i, (n, g) in enumerate(df.groupby(['A', 'B'])):
    g['id'] = i
    new_df = new_df.append(g)

new_df.set_index('id', inplace=True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T01:42:55.873

您可以使用 pandas 中的一些内部函数快速完成此操作：

首先创建测试DataFrame：

```
import pandas as pd
import random
random.seed(1)
df = pd.DataFrame({'A': [random.choice(ascii_lowercase[:5]) for _ in xrange(10)],
                    'B': [random.choice(['x', 'y']) for _ in xrange(10)],
                    'C': [random.random() for _ in xrange(10)]}) 
```

如果您希望新 id 与列 A 和 B 的顺序相同：

```
m = pd.MultiIndex.from_arrays((df.A, df.B))
df.index = pd.factorize(pd.lib.fast_zip(m.labels), sort=True)[0]
print df 
```

输出是：

```
 A  B         C
1  a  y  0.025446
7  e  x  0.541412
6  d  y  0.939149
2  b  x  0.381204
3  c  x  0.216599
4  c  y  0.422117
5  d  x  0.029041
6  d  y  0.221692
1  a  y  0.437888
0  a  x  0.495812 
```

如果您不关心新 id 的顺序：

```
m = pd.MultiIndex.from_arrays((df.A, df.B))
la, lb = m.labels
df.index = pd.factorize(la*len(lb)+lb)[0]
print df 
```

输出是：

```
 A  B         C
0  a  y  0.025446
1  e  x  0.541412
2  d  y  0.939149
3  b  x  0.381204
4  c  x  0.216599
5  c  y  0.422117
6  d  x  0.029041
2  d  y  0.221692
0  a  y  0.437888
7  a  x  0.495812 
```

# iphone - 为什么我不能在 Obj-C 中声明像“newVariable”这样的变量？

> ID：15365613
> 
> 赞同：16
> 
> 时间：2013-03-12T15:41:48.797
> 
> 标签：iphone, ios, objective-c, ipad, variables

我得到的错误

```
error: property's synthesized getter follows Cocoa naming convention for returning 'owned' objects
/Users/.../ViewController.h:12:40: 

note: property declared here
@property (nonatomic, retain)NSString *newString; 
```

为什么我不能在一开始的变量名中使用**new ？**（喜欢`newString`）

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-12T15:46:23.863

声明一个属性会综合两个访问器（getter/setter）方法：

```
-(NSString*)newString;
-(void)setNewString:(NSString*)newString; 
```

Objective-C 有一个由编译器强制执行的内存管理命名约定。以（还有“alloc”、“copy”、“mutableCopy”）开头的方法`new`需要返回一个将由调用者“拥有”的对象。请参阅[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)。生成的访问器方法不遵循规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:46:34.837

此命名约定已在 Objective-C 中使用。您将需要使用像普通旧的东西`myString`来完成这项工作。这是编译器的事情 - 编译器很*挑剔。*

# c# - 如何使这个 DataTemplateSelector 工作？

> ID：15365614
> 
> 赞同：1
> 
> 时间：2013-03-12T15:41:49.030
> 
> 标签：c#, wpf, datatemplateselector

在我的 Viewmodel 中，我具有`LoggedInAs`字符串`EditMode`类型和布尔类型的属性。我还有一个名为 List 的属性`ReaderList`，我将其绑定到 ItemsControl 用于显示目的，如下所示：

```
<ItemsControl Name="ReaderList" ItemTemplateSelector="{StaticResource drts}"/> 
```

我使用的是 Caliburn.Micro，所以绑定是通过命名自动完成的。我想使用 DataTemplateSelector 因为如果应用程序处于 EditMode 并且 Person 是登录的人，我想要一个完全不同的显示。所以这是我对资源的声明，

```
<UserControl.Resources>
    <DataTemplate x:Key="OtherPersonTemplate"> ... </DataTemplate>
    <DataTemplate x:Key="CurrentUserIsPersonTemplate"> ...  </DataTemplate>

    <local:DisplayReaderTemplateSelector x:Key="drts" 
           IsLoggedInAs="{Binding LoggedInAs}" 
           IsEditMode="{Binding EditMode}" 
           CurrentUserTemplate="{StaticResource CurrentUserIsPersonTemplate}"
           OtherUserTemplate="{StaticResource OtherPersonTemplate}"/>
</UserControl.Resources> 
```

这里是类的代码：

```
public class DisplayReaderTemplateSelector: DataTemplateSelector {
    public DataTemplate CurrentUserTemplate { get; set; }
    public DataTemplate OtherUserTemplate { get; set; }

    public string IsLoggedInAs {get; set;}
    public bool IsEditMode { get; set; }

    public override DataTemplate SelectTemplate(object item, DependencyObject container){
        var _r = item as Person;
        if (IsEditMode && _r.Name == IsLoggedInAs) return CurrentUserTemplate;
        else return OtherUserTemplate;
    }
} 
```

由于某种原因，应用程序在实例化 Viewmodel（分别是 View）时崩溃。错误在哪里，和/或我该如何解决这个问题？

编辑：崩溃是由于 DisplayReaderTemplateSelector 的构造中的绑定表达式 - 因为`IsLoggedIn`并且`EditMode`不是 DependencyProperties。

所以现在的问题是：如果我不能绑定到值，我怎么能有一个依赖于 ViewModel 状态的 DataTemplateSelector？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T11:08:00.057

虽然您可以使用`DataTemplateSelector`类似的东西，但您可能不会惊讶地发现在 Caliburn.Micro 中以`View.Context`和`ViewLocator`

在您的 VM 上，您可以创建一个属性，该属性提供 CM 将用于解析视图的上下文字符串 - 因为它使用命名约定，您只需要为子视图提供正确的命名空间/名称以及它的上下文字符串找到替代视图

在您的 VM 中，您可以创建一个使用用户详细信息来确定其值的上下文属性：

IE

```
public class SomeViewModel
{
    public string Context 
    {
        get 
        { 
            if (IsEditMode && _r.Name == IsLoggedInAs) return "Current";
            else return "Other";
        }
    }  

    // ... snip other code
} 
```

我看到的唯一问题（可能有解决方法）是您想从 a 内部确定视图`ViewModel`- 通常您确定更高的上下文并将其传递给 a`ContentControl`并且 CM 在定位该 VM 的视图时使用它

例如

你的主虚拟机：

```
public class MainViewModel
{
    public SomeSubViewModel { get; set; } // Obviously would be property changed notification and instantiation etc, I've just left it out for the example
} 
```

和相关视图

```
<UserControl>
    <!-- Show the default view for this view model -->
    <ContentControl x:Name="SomeSubViewModel" />
    <!-- Show an alternative view for this view model -->
    <ContentControl x:Name="SomeSubViewModel" cal:View.Context="Alternative" />
</UserControl> 
```

那么您的 VM 命名结构将是：

```
- ViewModels
|
----- SomeSubViewModel.cs
    |
    - SomeSubView.xaml
    |
    - SomeSubView
    |
    ----- Alternative.xaml 
```

CM 会知道在`SomeSubView`命名空间中查找`Alternative`基于原始 VM 名称和`Context`属性调用的控件（SomeSubViewModel 减去 Model 加上点加上`Context`SomeSubView.Alternative）

所以我必须玩一玩，因为这是标准的做法。如果您要这样做，您必须创建一个子视图模型并将 a 添加`ContentControl`到您的视图并将`View.Context`属性绑定到`Context`VM 上的属性，或者将`Context`属性添加到更高的位置（到父 VM）。

我将看看一些替代方案 - 如果无法让当前 ViewModel 使用标准 CM 根据属性决定其视图，您可以自定义并可能使用提供上下文`ViewLocator`的接口（IProvideContext 或类似的）`ViewLocator`立即 -（我认为您不能直接从 VM 连接到视图解析过程）

我很快就会回来提供另一个答案或替代方案！

编辑：

好的，这似乎是最直接的方法。我刚刚创建了一个`Context`直接从 VM提供的接口

```
public interface IProvideContext
{
    string Context { get; }
} 
```

然后，如果没有指定上下文，我自定义了`ViewLocator`实现（您可以在 中执行此操作）以使用它：`Bootstrapper.Configure()`

```
ViewLocator.LocateForModel = (model, displayLocation, context) =>
{
    var viewAware = model as IViewAware;

    // Added these 3 lines - the rest is from CM source
    // Try cast the model to IProvideContext
    var provideContext = model as IProvideContext;

    // Check if the cast succeeded, and if the context wasn't already set (by attached prop), if we're ok, set the context to the models context property
    if (provideContext != null && context == null)
         context = provideContext.Context;

    if (viewAware != null)
    {                    
        var view = viewAware.GetView(context) as UIElement;
        if (view != null)
        {
#if !SILVERLIGHT && !WinRT
            var windowCheck = view as Window;
            if (windowCheck == null || (!windowCheck.IsLoaded && !(new WindowInteropHelper(windowCheck).Handle == IntPtr.Zero)))
            {
                LogManager.GetLog(typeof(ViewLocator)).Info("Using cached view for {0}.", model);
                return view;
            }
#else
            LogManager.GetLog(typeof(ViewLocator)).Info("Using cached view for {0}.", model);
            return view;
#endif
        }
    }

    return ViewLocator.LocateForModelType(model.GetType(), displayLocation, context);
}; 
```

这应该对您有用，并允许您直接在目标上设置上下文`ViewModel`- 显然这可能仅适用于 View-First 方法

所以你需要做的就是像我上面展示的那样构建你的视图（正确的命名空间等），然后根据和`Context`的值在你的VM上设置属性`IsLoggedInAs``EditMode`

# entity-framework - 从虚拟集合中删除对象或移动到实体框架代码中的另一个对象

> ID：15365615
> 
> 赞同：0
> 
> 时间：2013-03-12T15:41:54.423
> 
> 标签：entity-framework, ef-code-first, parent-child, icollection

我有一个具有自引用父子关系的对象：

```
[Table("Content")]
public class Content
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int ContentID { get; set; }
    public string Text { get; set; }
    public int? ParentID { get; set; }
    public virtual Content Parent { get; set; }
    private ICollection<Content> _contents { get; set; }
    public virtual ICollection<Content> Contents
    {
        get { return _contents ?? (_contents = new HashSet<Content>()); }
        set { _contents = value; }
    }

} 
```

我正在尝试使用编辑功能，以便如果父 ID 发生更改，则该对象会从旧父级的子级中正确删除并添加到新的（或正确设置为 null）

为了使代码正确更改父 ID，我尝试了多种组合，但我无法在这里破解正确的操作。

```
 [HttpPost]
    public ActionResult Edit(Content content)
    {
        if (ModelState.IsValid)
        {
            Content oldContent = context.Contents
                                        .Where<Content>(c => c.ContentID == content.ContentID)
                                        .Single<Content>();

            // If the parent has changed.
            if (content.ParentID != oldContent.ParentID)
            {
                // if the old parent is not NULL remove from collection
                if (oldContent.ParentID != null) {
                    Content oldParent = context.Contents
                                               .Where<Content>(c => c.ContentID == oldContent.ParentID)
                                               .Single<Content>();
                    oldParent.Contents.Remove(content);
                    context.Entry(oldParent).State = EntityState.Modified;
                    context.SaveChanges();
                }

                // if the new parent is not NULL add to the new collection
                if (content.ParentID != null) {
                    Content parent = context.Contents
                                            .Where<Content>(c => c.ContentID == content.ParentID)
                                            .Single<Content>();
                    parent.Contents.Add(content);
                    context.Entry(parent).State = EntityState.Modified;
                    context.SaveChanges();
                }
            } 
            context.Entry(oldContent).CurrentValues.SetValues(content);
            context.SaveChanges();
            return RedirectToAction("Index");
        }
        ViewBag.PossibleParents = context.Contents;
        return View(content);
    } 
```

问题是数据表有两个与 ParentID 相关的字段 - 第一个`ParentID`正确更改，第二个`Parent_ContentID`未正确更改。第二个用于循环`.Contents`来自父级的属性。

我错过了什么？如何从父对象的“相关对象”集合中删除当前对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:44:38.420

```
 oldParent.Contents.Remove(oldContent); 
```

这对我有用。谢谢，@Slauma！

# iis - IIS Web Garden - 来自不同进程的文件访问/写入

> ID：15365618
> 
> 赞同：0
> 
> 时间：2013-03-12T15:42:00.960
> 
> 标签：iis, logging, log4net, application-pool, web-garden

我在 IIS 上托管我的 Web 应用程序。应用程序所在的池有 4 个工作进程。（网络花园）

为了进行测试，对于每个对 aspx 页面的请求，我将执行进程的进程 ID 写入 log.net 文件日志中。

当我打开文件日志时，我**只看到第一个进程的日志**。

我确信其他进程正在运行，因为我可以在任务管理器中看到它们。

由于第一个进程正在写入日志文件，其他进程可能无法访问日志文件吗？如何从同一应用程序池的不同进程写入同一日志文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:14:14.980

解决这个问题的方法是让每个工作进程写入不同的日志文件。

为此，您需要使用动态文件名。 有关示例，请参见[http://geekswithblogs.net/rgupta/archive/2009/03/03/dynamic-log-filenames-with-log4net.aspx 。](http://geekswithblogs.net/rgupta/archive/2009/03/03/dynamic-log-filenames-with-log4net.aspx)

# c# - Creating routes from DB records

> ID：15365625
> 
> 赞同：5
> 
> 时间：2013-03-12T15:42:15.433
> 
> 标签：c#, asp.net, routing, global-asax

Current ASAX code (simplified):

```
void Application_Start(object sender, EventArgs e) 
{        
    // Enable routing
    RegisterRoutes(RouteTable.Routes);
}

void RegisterRoutes(RouteCollection routes)
{
    routes.Add("ContactUsRoute",
               new Route("contact-us", 
               new PageRouteHandler("~/contactus.aspx")));
} 
```

**Question**

Is it safe to pull routes from the DB at this point? For example:

```
void RegisterRoutes(RouteCollection routes)
{
    routes.Add("ContactUsRoute",
               new Route("contact-us", 
               new PageRouteHandler("~/contactus.aspx")));

    // BusinessLogic.GetPageRoutes() returns a List<Route>
    var dbRoutes = BusinessLogic.GetPageRoutes();

    foreach (Route route in dbRoutes)
    {
        routes.Add(route);
    }
} 
```

**Additional Information**

This question is born out of a lack of knowledge concerning routing as well as a general unfamiliarity with `global.asax`. In the past, I've only used `global.asax` for extremely simple tasks; DB *feels* like I'm taking it to another level.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:14:01.710

> 是否安全

什么是“安全的”，为什么不这样呢？

路由是使用字符串构建的，代码与这些字符串的来源无关，无论是硬编码、资源文件、Web 服务、文本文件还是数据库。

只要您确保在数据库不可用时有一些默认路由来显示错误页面，我看不出（除了第一次命中时的性能损失）为什么不这样做.

# php - 回显随机数 0.5 到 1？

> ID：15365630
> 
> 赞同：0
> 
> 时间：2013-03-12T15:42:24.873
> 
> 标签：php, mysql

嗨，我正在尝试使用 php 来回显一组从 0.5 一直到 1 的随机数字；所以 05, 0.6, 0.7, 0.8 > 1

我目前正在回显一个用户列表，因此需要将这些数字与每个用户随机回显。

是否有捷径可寻？

```
<?php
    $local_set = get_local_users();
    $local_count = mysql_num_rows($local_set);
    while ($local = mysql_fetch_array($local_set)) {

        echo "<div class=\"sugarushcase\">
        <a href=\"profile.php?id={$local['id']}\"><img width=80px height= 80px src=\"data/photos/{$local['id']}/_default.jpg\" class=\"boxgrid\"/></a><div class=\"local_text\">about (RANDOM NUBER) mile</div>
        </div>";

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:44:17.323

使用[`mt_rand()`](http://php.net/mt_rand)：

```
$rand = mt_rand(5, 10) / 10; 
```

您可以在 之前为每次迭代计算此随机数，然后在您的示例中`echo`使用`$rand`而不是。`(RANDOM NUMBER)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:44:08.347

您可以使用[`rand`](http://php.net/manual/en/function.rand.php)传递最小值和最大值来实现此目的：

```
rand (5, 10) / 10 
```

您的代码将是：

```
echo "<div class=\"sugarushcase\">
    <a href=\"profile.php?id={$local['id']}\"><img width=80px height= 80px" + 
    "src=\"data/photos/{$local['id']}/_default.jpg\" class=\"boxgrid\"/></a><div class=\"local_text\">about" + 
    (rand (5, 10) / 10) + "mile</div></div>"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:52:47.027

是的，这是您编辑的代码。

```
<?php
$local_set = get_local_users();
$local_count = mysql_num_rows($local_set);
$random_number = mt_rand (0.5*10, 1.0*10) / 10; //Edit min/max values here
while ($local = mysql_fetch_array($local_set)) {

    echo "<div class=\"sugarushcase\">
    <a href=\"profile.php?id={$local['id']}\"><img width=80px height= 80px src=\"data/photos/{$local['id']}/_default.jpg\" class=\"boxgrid\"/></a><div class=\"local_text\">about {$random_number} mile</div>
    </div>";

} 
```

它是在没有经过测试的情况下编写的，所以如果它不起作用，请发表评论，我会调查它:)

# asp.net - Assigning Roles to Users When Registering

> ID：15365638
> 
> 赞同：0
> 
> 时间：2013-03-12T15:42:52.447
> 
> 标签：asp.net, visual-studio-2010

I have a role called 'Customer', I wish to add users who register automatically to that role. At the moment I can only assign users to roles by using ASP.net Web Site Administration Tool. I'm using the default LogOn.aspx and Register.aspx files from Account folder in vb web profile.

I have seen that other users have used:

```
Dim uName As String = registrationWizard.UserName.ToString   
Roles.AddUserToRole(uName, "Customer") 
```

I'm not sure exactly where this needs to go, or even if this would work?

Thanks for any help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:59:25.233

我在 AccountController 下方添加了以下代码，并且它有效。

```
Roles.AddUserToRole(model.UserName, "Customer") 
```

# php - Yii Framework with Twitter Bootstrap not loading

> ID：15365639
> 
> 赞同：1
> 
> 时间：2013-03-12T15:42:52.490
> 
> 标签：php, twitter-bootstrap, yii, yii-extensions

I'm new to Yii and wanted to implement the Twitter Bootstrap extension, I have followed [cniska](http://www.cniska.net/yii-bootstrap/setup.html) but apparently I'm doing something wrong.

When I load the page in the browser with extension code, the images/effects don't load.

In my html page I got this simple toggle button found [here](http://www.cniska.net/yii-bootstrap/index.html).

```
 <?php $this->widget('bootstrap.widgets.TbButton', array(
      'buttonType'=>'button',
      'type'=>'primary',
      'label'=>'Toggle me',
      'toggle'=>true,
  )); ?> 
```

The result with this is as if I have just done a simple HTML button with no classes applied to it, a 'bare' sytle button, so do speak.

My config/main.php:

```
Yii::setPathOfAlias('bootstrap', dirname(__FILE__).'/../extensions/bootstrap');

return array(
    'basePath'=>dirname(__FILE__).DIRECTORY_SEPARATOR.'..',
'name'=>'Test App',

// preloading 'log' component
'preload'=>array('log'),

// autoloading model and component classes
'import'=>array(
    'application.models.*',
    'application.components.*',
),

'modules'=>array(
    'gii'=>array(
        'class'=>'system.gii.GiiModule',
        'password'=>'<password>',
        'ipFilters'=>array('127.0.0.1','::1'),
    ),
),

'components'=>array(
    'user'=>array(
      'allowAutoLogin'=>true,
  ),
  'bootstrap'=>array(
    'class'=>'bootstrap.components.Bootstrap',
   ),

  'theme'=>'bootstrap', -// requires you to copy the theme under your themes directory
    'modules'=>array(
        'gii'=>array(
            'generatorPaths'=>array(
                'bootstrap.gii',
            ),
        ),
    ),

    'db'=>array(
        'connectionString' => 'mysql:host=localhost;dbname=<bdname>',
        'emulatePrepare' => true,
        'username' => '<bd username>',
        'password' => '<bd password>',
        'charset' => 'utf8',
    ),

    'errorHandler'=>array(
        'errorAction'=>'site/error',
    ),
    'log'=>array(
        'class'=>'CLogRouter',
        'routes'=>array(
            array(
                'class'=>'CFileLogRoute',
                'levels'=>'error, warning',
            ),

        ),
    ),
),

// application-level parameters that can be accessed
// using Yii::app()->params['paramName']
'params'=>array(
    // this is used in contact page
    'adminEmail'=>'webmaster@example.com',
),
); 
```

I also believe I have the latest versions as I downloaded Yii's framework this week as well as the extension. Any tips?

Thanks in advance

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T19:19:43.173

您需要注册 css 和 js 文件，在主布局中添加这一行

```
Yii::app()->bootstrap->register(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-17T13:27:22.730

您必须更新您的`main.config`，将其更改为在`preload`如下部分中加载引导程序：

```
'preload'=>array('log', 'bootstrap'), 
```

或者在您需要的每种情况下调用@neophile 编写的代码。

使用可以查看[官方](http://yiibooster.clevertech.biz/getting-started.html)初始设置指南（`Initialization options`部分）

# php - Soap header without header name php

> ID：15365641
> 
> 赞同：0
> 
> 时间：2013-03-12T15:42:57.453
> 
> 标签：php, soap, header

I'm having a problem in order to create a soap call. As one can see the header that is being supplied from a 3rd party client doesn't have a header name. I need to create a soap call by passing the username and password to the soap request which doesn't have a name in the header. I have tried several examples but no success. The call below works in soap UI but I'm having serious problems when it comes to php. Any help would be much appreciated

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:int="http://namespace.example.com/">
   <soapenv:Header>
      <int:password>123</int:password>
      <int:login>abc</int:login>
   </soapenv:Header>
   <soapenv:Body>
      <int:getEventTree>
         <!--Optional:-->
         <lang>en</lang>
      </int:getEventTree>
   </soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:01:16.627

请看一下[http://php.net/manual/en/soapclient.dorequest.php](http://php.net/manual/en/soapclient.dorequest.php)

您可以使用如下代码：

```
$response = $soapClient->__doRequest(
    $request,
    $endpoint,
    $soapAction,
    $soapVersion,
    $one_way       
); 
```

$request 可以定义为包含 xml 的字符串，例如：

```
$request = 
'<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/""xmlns:int="http://namespace.example.com/">
    <soapenv:Header>
        <int:password>123</int:password>
        <int:login>abc</int:login>
    </soapenv:Header>
    <soapenv:Body>
        <int:getEventTree>
            <!--Optional:-->
            <lang>en</lang>
        </int:getEventTree>
    </soapenv:Body>
</soapenv:Envelope>'; 
```

您可以根据您的配置在 __doRequest() 调用中定义其余参数。

# java - BufferedImage 超出范围

> ID：15365645
> 
> 赞同：0
> 
> 时间：2013-03-12T15:43:10.673
> 
> 标签：java, image, graphics, awt, bufferedimage

我目前正在尝试创建一个填充纯色的形状，然后将其输出为 PNG。这是我的代码。

```
void CreateRedImage(int xSize, int ySize, String FileName){
        BufferedImage bf = new BufferedImage(xSize, ySize, BufferedImage.TYPE_INT_RGB);
        Color color = new Color(225, 000, 000);
        File f = new File(FileName + ".png");
        bf.setRGB(xSize, ySize, color.getRGB());
        try {
            ImageIO.write(bf, "PNG", f);
        } catch (IOException e) {
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }
    } 
```

不幸的是，当我运行我的代码时，我收到了这个错误消息。

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Coordinate out of bounds!
    at sun.awt.image.IntegerInterleavedRaster.setDataElements(IntegerInterleavedRaster.java:301)
    at java.awt.image.BufferedImage.setRGB(BufferedImage.java:988)
    at ImageCreation.CreateBlueImage(ImageCreation.java:53)
    at Main.main(Main.java:12)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

现在，我知道问题出在以下行：

```
bf.setRGB(xSize, ySize, color.getRGB()); 
```

我无法弄清楚为什么我的代码不起作用。有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:54:45.770

如果您查看 's setRGB(int x, int y, int rgb) 的文档，**它**[会](http://docs.oracle.com/javase/6/docs/api/java/awt/image/BufferedImage.html)说：-`BufferedImage`

 **> 将此 BufferedImage 中的像素设置为指定的 RGB 值。假定像素位于默认 RGB 颜色模型 TYPE_INT_ARGB 和默认 sRGB 颜色空间中。

它还说

> 如果坐标不在范围内，则可能会引发 ArrayOutOfBoundsException。但是，不能保证明确的边界检查。

这意味着您的`xSize`and`ySize`不在`BufferedImage`.

**更新：-**

再次从文档中，如果您仔细查看`BufferedImage`您碰巧使用的构造函数的签名，您会看到：-

```
public BufferedImage(int width, int height, int imageType) 
```

这意味着，在您的情况下`xSize`and`ySize`是`width`and `height`，并且您的 , 没有必要`BI`具有**co-ordinates(xSize, ySize)**。我希望你明白这里的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:49:36.833

```
bf.setRGB(xSize, ySize, color.getRGB()); 
```

setRGB 设置单个像素，x 坐标为 0 .. xSize - 1，y 坐标同样明智。

```
int c = color.getRGB();
for (int x = 0; x < xSize; ++x) {
    for (int y = 0; y < ySize; ++y) {
        bf.setRGB(x, y, color);
    }
} 
```

或者

```
Graphics2D g = bf.createGraphics();
g.setColor(color);
g.fillRect(0, 0, xSize, ySize);
g.dispose(); 
```

或者更好的是使用 BufferedImage 的光栅。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T15:51:25.120

你可能想要 bf.getGraphics().fillRect(...)**

# json - 如何通过 JSON 对象为 ColumnChart 创建 DataTable？

> ID：15365647
> 
> 赞同：0
> 
> 时间：2013-03-12T15:43:21.037
> 
> 标签：json, visualization

我正在尝试为来自 Google 可视化 api 的 ColumnChart 创建一个以 JSON 作为参数的 DataTable。

我生成了以下 JSON 对象：

```
{
    "cols": [
        {"id":"date", "label":"date","pattern":"", "type":"date"},
        {"id":"jobsonstatus", "label":"jobsonstatus", "pattern":"", "type":"number"}
    ],
    "rows": [
        {
            "c": [
                {"v": "01-02-2013", "f": null},
                {"v": 128, "f": null}
            ]
        },
        {
            "c": [
                {"v": "08-02-2013", "f": null},
                {"v": 185, "f": null}
            ]
        },
        {
            "c": [
                {"v": "15-02-2013", "f": null},
                {"v": 142, "f": null}
            ]
        },
        {
            "c": [
                {"v": "22-02-2013", "f": null},
                {"v": 86, "f": null}
            ]
        }
    ]
} 
```

这有什么问题？

也许是别的东西。其余的代码是：

```
 var chart;      //The chart
var options;    //The options for the chart
var data;       //The data inside the chart

//This function will set up the actual chart but doesn't draw it.           
function init(){
    chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
    options = {
        width:600, height:450,      
        legend: {'position': 'top'},
        allowHtml: true
    };                      
}

function changeData(dataPar){
    data = new google.visualization.DataTable(dataPar);
    drawChart();                  
}

function drawChart(){   
    chart.draw(data, options);
} 
```

JSON 对象在函数 changeData() 中抛出。

我在ajax部分有这个：

```
 dataType: "json",       
    success: function(res, textStatus, jqXHR){
       changeData(res);
    } 
```

我收到带有红色背景的错误：

> a[dc] 不是函数

有谁知道出了什么问题，应该有什么解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T09:18:59.987

好吧，我自己想通了。

在 cols 中，我将“日期”列的类型设置为日期，但它必须是字符串，因为给定的值是字符串。

因此，如果您从[google 可视化图表](http://developers.google.com/chart/interactive/docs/reference#dataparam)中得到奇怪的错误，那么您的 json 部分可能有错误，这似乎对[JSONLint](http://www.jsonlint.com/)有效。

我对调试 json 部分的建议是首先使用函数 addColumn() 和 addRows() 制作一个虚拟数据表，然后执行

```
console.log([DataTable var].toJSON()). 
```

将此输出与您使用之前的脚本和调试创建的 JSON 进行比较。

我有以下 JSON 对象：

```
{
    "cols": [
        {"id": "date", "label": "date","pattern": "","type": "string"},
        {"id": "newjobs","label": "newjobs","pattern": "","type": "number"}
    ],
    "rows": [
        {"c": [
                {"v": "01-02-2013","f": null},
                {"v": 132,"f": null}
            ]},
        {"c": [
                {"v": "08-02-2013","f": null},
                {"v": 78,"f": null}
            ]},
        {"c": [
                {"v": "15-02-2013","f": null},
                {"v": 105,"f": null}
            ]
        },
        {"c": [
                {"v": "22-02-2013","f": null},
                {"v": 8,"f": null}
            ]}
    ]
} 
```

# c - compiling xkbcomp (Xorg App)

> ID：15365649
> 
> 赞同：4
> 
> 时间：2013-03-12T15:43:28.333
> 
> 标签：c, x11, cross-compiling, autotools, xorg

I'm trying to compile xkbcomp (from xorg App) but I got the following errors :

```
warning: libxcb.so.1, needed by /lib/libX11.so, not found (try using -rpath or -rpath-link)
/lib/libX11.so: undefined reference to `xcb_connection_has_error'
/lib/libX11.so: undefined reference to `xcb_poll_for_reply'
/lib/libX11.so: undefined reference to `xcb_get_maximum_request_length'
/lib/libX11.so: undefined reference to `xcb_get_file_descriptor'
/lib/libX11.so: undefined reference to `xcb_connect'
/lib/libX11.so: undefined reference to `xcb_wait_for_reply'
/lib/libX11.so: undefined reference to `xcb_get_setup'
/lib/libX11.so: undefined reference to `xcb_wait_for_event'
/lib/libX11.so: undefined reference to `xcb_poll_for_event'
/lib/libX11.so: undefined reference to `xcb_parse_display'
/lib/libX11.so: undefined reference to `xcb_generate_id'
/lib/libX11.so: undefined reference to `xcb_disconnect'
/lib/libX11.so: undefined reference to `xcb_take_socket'
/lib/libX11.so: undefined reference to `xcb_writev'
/lib/libX11.so: undefined reference to `xcb_connect_to_display_with_auth_info' 
```

Note: libX11 and libxcb are successfully been compiled (using autotools) and I got all my ".so" shared libraries and header files. But the problem still existing.

How can I solve that??

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T09:36:46.550

我已经解决了这个问题，我只需要在我的 LDFLAGS 中添加“-lxcb”。现在，它工作正常。谢谢——</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:01:09.040

在 Linux 中，使用 GCC，您可以使用标志

```
gcc input.c -o output -I/usr/lib/X11R6 -lX11 
```

# ruby-on-rails - Shortening File Upload Name in View - Rails/Paperclip/Bootstrap

> ID：15365650
> 
> 赞同：1
> 
> 时间：2013-03-12T15:43:31.970
> 
> 标签：ruby-on-rails, twitter-bootstrap, paperclip, jasny-bootstrap

I am using Jasny's Bootstrap plugin for file uploads in a rails app that is using paperclip. It is working fine, but I would like to truncate the file name that is previewed before uploading.

After selecting a file, I would like the file upload preview text to say something like 'example_fil...' instead of 'example_file_for_practice.jpg'.

Are there any techniques for doing this either in the view (doubtful) or in Bootstrap/Jasny?

Also, I know someone is going to tell me to check out the jquery file upload plugin - it is pretty awesome! I'd like to try to solve this problem before moving on, though.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:53:44.453

我正在做类似的事情，但我没有使用 Ruby 来缩短长度，而是使用 CSS。如果文本的长度超出了我的 div 标签的 span4 类所能容纳的长度，它将`...`在末尾添加 a 而不是换行到下一行。

```
li .text{
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
} 
```

所以，在我看来，我会有这样的事情：

`<li class="text"><%= video.name %></li>`

它会显示类似于下面的内容。

![在此处输入图像描述](../Images/1388a81f6ca8b1abba2b88e692516e62.png)

# c# - dropdown list - confirm - issue

> ID：15365651
> 
> 赞同：1
> 
> 时间：2013-03-12T15:43:34.753
> 
> 标签：c#, javascript, asp.net, .net

I have following code in my .aspx

```
<td>
  <script type="text/javascript" language="javascript">\
    function ShowConfirm() {
      if (confirm("Are you sure?") == true)
        return true;
      else
        return false;
    }
  </script>
  <asp:DropDownList ID="ddl1s"  runat="server"  
     onselectedindexchanged="ddl1_SelectedIndexChanged" AutoPostBack="True">
  </asp:DropDownList>
</td> 
```

I have following code in my aspx.cs

```
protected void ddlEnrollmentStatus_SelectedIndexChanged(object sender, EventArgs e)
{
   ddl1.Attributes.Add("onchange", "ShowConfirm();");
} 
```

I have two items in my dropdownlist (Yes and No)

When I select 2nd item from the list, my page refreshes and I get w/e I set up in Page_Load event.

What am I doing wrong? I am trying to create a confirmbox where it asks user to verify if the value they selected is what they intended to select. If they press Yes, change the value to w/e they selected. if they press no, revert back to original value.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:50:41.763

如果您有完全的客户端验证，最简单的方法是尽可能只在客户端代码中进行：

```
<asp:DropDownList ID="ddl1s"  runat="server" 
    onselectedindexchanged="ddl1_SelectedIndexChanged" 
    AutoPostBack="True" onchange="return ShowConfirm();">
</asp:DropDownList> 
```

服务器和客户端事件的混合变得非常混乱，因为首先发生所有服务器处理，然后将页面发送到用户的浏览器，然后运行所有客户端事件（并且在每次往返服务器之间丢失所有客户端上下文）。您当前的代码是说：

1.  用户更改 DropDown 值。
2.  往返服务器。
3.  服务器发送带有`onchange`.
4.  什么都没发生。 `onchange`当用户实际更改值 (1) 时它不存在，并且它现在不会触发，因为页面是在不知道更改的情况下重新加载的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:50:18.213

你可以这样使用。

```
ddl1.Attributes.Add("onchange", "return ShowConfirm();"); 
```

**在页面加载事件中使用它。**

或将其与您的 html (.aspx) 页面绑定。

```
<asp:DropDownList ID="ddl1s"  runat="server" onchange="return ShowConfirm();"
 onselectedindexchanged="ddl1_SelectedIndexChanged" AutoPostBack="True"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T15:47:16.103

我不是 100% 确定，但我认为你需要这个：

```
ddl1.Attributes.Add("onchange", "return ShowConfirm();"); 
```

看看我写的“return”。

你也可以用这个来简化你的javascript：

```
function ShowConfirm() {
  return confirm("Are you sure?") == true;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T16:14:32.763

`AutoPostBack="True"`是错误的代码行。这会导致控件回发；但是，它在回发时不会跟踪新值，而是跟踪旧值。

您只需要正确触发您的事件。首先将此属性设置为 False；然后确定您页面上的哪些内容负责执行 PostBack。

# java - Spring MVC 和 X-HTTP-Method-Override 参数

> ID：15365660
> 
> 赞同：6
> 
> 时间：2013-03-12T15:43:50.240
> 
> 标签：java, spring, http, spring-mvc

我正在使用 Spring MVC，并且具有更新用户配置文件的功能：

```
@RequestMapping(value = "/{userName}" + EndPoints.USER_PROFILE,
    method = RequestMethod.PUT)
public @ResponseBody ResponseEntity<?> updateUserProfile(
    @PathVariable String userName, @RequestBody UserProfileDto userProfileDto) {
    // Process update user's profile
} 
```

我已经开始使用 JMeter，由于某种原因，他们在发送带有正文的 PUT 请求时遇到问题（在请求正文中或使用请求参数破解）。

我知道在 Jersey 你可以添加一个过滤器来处理 X-HTTP-Method-Override 请求参数，这样你就可以发送一个 POST 请求并使用 header 参数覆盖它。

在 Spring MVC 中有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-12T17:46:55.173

Spring MVC 有[HiddenHttpMethodFilter](http://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/filter/HiddenHttpMethodFilter.html)，它允许你包含一个请求参数 ( `_method`) 来覆盖 http 方法。您只需要将过滤器添加到 web.xml 中的过滤器链中。

我不知道使用`X-HTTP-Method-Override`标头的开箱即用解决方案，但是您可以创建一个类似于您`HiddenHttpMethodFilter`自己的过滤器，它使用标头来更改值而不是请求参数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-12-01T10:04:34.010

您可以将此类用作过滤器：

```
public class HttpMethodOverrideHeaderFilter extends OncePerRequestFilter {
  private static final String X_HTTP_METHOD_OVERRIDE_HEADER = "X-HTTP-Method-Override";

  @Override
  protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
      throws ServletException, IOException {
    String headerValue = request.getHeader(X_HTTP_METHOD_OVERRIDE_HEADER);
    if (RequestMethod.POST.name().equals(request.getMethod()) && StringUtils.hasLength(headerValue)) {
      String method = headerValue.toUpperCase(Locale.ENGLISH);
      HttpServletRequest wrapper = new HttpMethodRequestWrapper(request, method);
      filterChain.doFilter(wrapper, response);
    }
    else {
      filterChain.doFilter(request, response);
    }
  }

  private static class HttpMethodRequestWrapper extends HttpServletRequestWrapper {
    private final String method;

    public HttpMethodRequestWrapper(HttpServletRequest request, String method) {
      super(request);
      this.method = method;
    }

    @Override
    public String getMethod() {
      return this.method;
    }
  }
} 
```

来源：http: [//blogs.isostech.com/web-application-development/put-delete-requests-yui3-spring-mvc/](http://blogs.isostech.com/web-application-development/put-delete-requests-yui3-spring-mvc/)

# dbvisualizer - 使用 DBVisualizer Free 内联编辑表数据

> ID：15365663
> 
> 赞同：0
> 
> 时间：2013-03-12T15:43:53.397
> 
> 标签：dbvisualizer

我正在尝试使用 DBVisualizer 9 免费版以内联模式编辑表数据，但我不能。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T11:54:20.340

使用免费版本无法编辑数据，因为它显示在 SQL 编辑器的功能列表中（比较免费和商业版本）。

[http://www.dbvis.com/features/feature-list/](http://www.dbvis.com/features/feature-list/)

# angularjs - Liferay Portlet 上的服务注入错误

> ID：15365664
> 
> 赞同：1
> 
> 时间：2013-03-12T15:43:56.407
> 
> 标签：angularjs, liferay, portlet

我已经开发了一个 Liferay portlet 并使用 AngularJS 来实现。通过在控制器中使用诸如**$scope**之类的服务注入将产生以下错误：-

> 错误：未知提供者：aProvider <- a

示例代码：-

```
<script>
function PayrollCalcCtrl($scope){
}
</script> 
```

如果**$scope**被删除，则不会发生错误。避免这种情况的任何解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:54:43.927

你的 JS 优化器/混淆器弄乱了你的依赖。看看[DI 文档](http://docs.angularjs.org/guide/di)。

您需要在 $inject 或内联注释中定义您的控制器：

```
var MyController = function(myScope) {
  ...
}
MyController.$inject = ['$scope']; 
```

或者

```
app.controller('MyCtrl', ['$scope', function($scope) {
  ...;
}]); 
```

# linux - 在 httpd.conf 中收集网站并获取文件夹大小的脚本

> ID：15365665
> 
> 赞同：0
> 
> 时间：2013-03-12T15:44:02.780
> 
> 标签：linux, perl, bash, sh

在此处输入代码我想做的是一个脚本，它将收集在我的`httpd.conf`. 获取`DoccumentRoot`和`ServerName`。然后`du -s`在文档根目录上执行 a 并将数据放入文件中。

现在我有这个命令：

```
grep -E "DocumentRoot|ServerName" /etc/httpd/conf/httpd.conf | grep -v "#" | awk '{print $2}' 
```

它在单独的行上给我输出，但我不知道如何解析输出，所以我可以在新文件的同一行上`du -s`执行`DocumentRoot`然后获取。`Size / DocumentRoot / ServerName`

所需的输出应该是这样的：

```
size - Folder -  Servername

3436712 /etc/www/htdocs/domain www.domain.qc.ca 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:49:31.163

尝试这样做：

```
grep -E "DocumentRoot|ServerName" /etc/httpd/conf/httpd.conf |
awk '!/#/{print $2}' |
xargs -n1 du -s 
```

或使用独特的管道：

```
grep -ioP '^\s*(?<!#)\s*(DocumentRoot|ServerName)\s+\K.*' /etc/httpd/conf/httpd.conf |
xargs -n1 du -s 
```

# c# - 如何强制标签填充 WrapPanel 行？

> ID：15365666
> 
> 赞同：0
> 
> 时间：2013-03-12T15:44:03.060
> 
> 标签：c#, wpf, wrappanel

假设您有一个带有标签的 WrapPanel：

```
<WrapPanel>
    <Label Content="My Label" HorizontalContentAlignment="Center" />
    <Label Content="My Label 2" HorizontalContentAlignment="Center" />
</WrapPanel> 
```

基本上，我希望这些中的每一个都在包装面板中填充一整行。这似乎是一件简单的事情，但是，我似乎无法找出方法。

我知道您可以使用“宽度”属性来做到这一点，但是，我不想要硬编码的宽度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:46:24.357

如果您希望每个标签都堆叠而不是包装，请使用[StackPanel](http://wpftutorial.net/StackPanel.html)而不是`WrapPanel`：

```
<StackPanel>
    <Label Content="My Label" HorizontalContentAlignment="Center" />
    <Label Content="My Label 2" HorizontalContentAlignment="Center" />
</StackPanel> 
```

# java - 在 LaTeX 文档、java 中查找错误

> ID：15365678
> 
> 赞同：1
> 
> 时间：2013-03-12T15:44:33.123
> 
> 标签：java, parsing, error-handling, command, latex

所以我有一堆 LaTeX 样式的文档，一个看起来像这样......

```
\documentclass{article}
\usepackage{amsmath, amssymb, amsthm}
\begin{document}
    {\Large \begin{center} Homework Problems \end{center}}\begin{itemize}\item\end{itemize}
    \begin{enumerate}
            \item Prove: For all sets $A$ and $B$, $(A - B) \cup
                    (A \cap B) = A$.
                    \begin{proof}
                            \begin{align}
                                    & (A - B) \cup (A \cap B) && \\
                                    & = (A \cap B^c) \cup (A \cap B) && \text{by
                                    Alternate Definition of Set Difference} \\
                                    & = A \cap (B^c \cup B) && \text{by Distributive Law} \\
                                    & = A \cap (B \cup B^c) && \text{by Commutative Law} \\
                                    & = A \cap U && \text{by Union with the Complement Law} \\
                                    & = A && \text{by Intersection with $U$ Law}
                            \end{align}
                    \end{proof}
            \item If $n = 4k + 3$, does 8 divide $n^2 - 1$?
                    \begin{proof}
                            Let $n = 4k + 3$ for some integer $k$. Then
                            \begin{align}
                                    n^2 - 1 & = (4k + 3)^2 - 1 \\
                                    & = 16k^2 + 24k + 9 - 1 \\
                                    & = 16k^2 + 24k + 8 \\
                                    & = 8(2k^2 + 3k + 1) \text{,}
                            \end{align}
                            which is certainly divisible by 8.
                    \end{proof}
    \end{enumerate}
 \end{document} 
```

现在首先我必须通读每个文档和行并找到所有“\begin{BLOCK}”和“\end{BLOCK}”命令并将BLOCK字符串添加到堆栈中，当我找到匹配的“\end”我会在我的堆栈上调用 pop() 命令。我几乎完成了所有这些工作，只是组织得不好，或者至少我认为有比我所有的“如果”陈述更好的方法来解决它。所以这是我的第一个问题，有什么比我做的更好吗？

接下来是我要查找错误并报告它们。例如，如果我从上面的文本中删除了“\begin{document}”行，我希望程序运行，做它应该做的一切，但是当它到达“\end{document}”行时它会报告缺少的“\begin”命令。我得到了处理其他示例的代码，例如删除用于枚举或逐项列出的“\begin”命令，但我无法让这种情况起作用。

最后，我希望能够处理丢失的“\end”命令。我已经尝试过了，但我不能完全正确地调节。假设我有这个文件......

```
\begin{argument}
\begin{Palin}No it can't. An argument is a connected series of statements intended to establish a proposition.\end{Palin}
\begin{Cleese}No it isn't.\end{Cleese}
\begin{Palin}\expression{exclamation}Yes it is! It's not just contradiction.\end{Palin}
\begin{Cleese}Look, if I argue with you, I must take up a contrary position.\end{Cleese}
\begin{Palin}Yes, but that's not just saying \begin{quotation}'No it isn't.'\end{Palin}
\begin{Cleese}\expression{exclamation}Yes it is!\end{Cleese}
\begin{Palin}\expression{exclamation}No it isn't!\end{Palin}
\begin{Cleese}\expression{exclamation}Yes it is!\end{Cleese}
\begin{Palin}Argument is an intellectual process.  Contradiction is just the automatic gainsaying of any statement the other person makes.\end{Palin}
\end{argument} 
```

你会注意到在第 6 行有一个没有“\end”的“\begin{quotation}”命令。我在浏览这个特定文档时的代码给了我这个作为输出......

```
PARSE ERROR Line 6: Missing command \begin{Palin}.
PARSING TERMINATED! 
```

这显然不是真的，但我不知道如何重组我的错误处理以使这些情况正常工作。任何人都可以提供任何帮助吗？尤其是在组织此代码以更好地适应这些问题的方式方面。

- - - - - - - - - - - - - - - - - - - - - -代码 - - - -------------------------------------

```
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.util.Scanner;
import java.util.Stack;
import java.util.StringTokenizer;

public class LaTeXParser{

public static void main(String args[]) throws FileNotFoundException{

    Scanner scan = new Scanner(System.in);

    Stack s = new Stack();

    int lineCount = 0;

    String line;
    String nextData = null;
    String title = null;

            String fname;

            System.out.print("Enter the name of the file (no extension): ");
            fname = scan.next();

            fname = fname + ".txt";

            FileInputStream fstream = new FileInputStream(fname);

            Scanner fscan = new Scanner(fstream);

            System.out.println();

            while(fscan.hasNextLine()){

                lineCount++;
                line = fscan.nextLine();
                StringTokenizer tok = new StringTokenizer(line);

                while(tok.hasMoreElements()){

                    nextData = tok.nextToken();
                    System.out.println("The line: "+nextData);

                    if(nextData.contains("\\begin") && !nextData.contains("\\end")){

                        if(nextData.charAt(1) == 'b'){

                            title = nextData.substring(nextData.indexOf("{") + 1, nextData.indexOf("}"));

                            s.push(title);

                        }
                    }//end of BEGIN if

                    if(nextData.contains("\\end") && !nextData.contains("\\begin")){

                        String[] theLine = nextData.split("[{}]");

                        for(int i = 0 ; i < theLine.length ; i++){

                            if(theLine[i].contains("\\end") && !s.isEmpty() && theLine[i+1].equals(s.peek())){

                                s.pop();

                                i++;

                            }

                            if(theLine[i].contains("\\end") && !theLine[i+1].equals(s.peek())){

                                System.out.println("PARSE ERROR Line " + lineCount + ": Missing command \\begin{" + theLine[i+1] + "}.");
                                System.out.println("PARSING TERMINATED!");
                                System.exit(0);

                            }
                        }
                    }//end of END if

                    if(nextData.contains("\\begin") && nextData.contains("\\end")){

                        String[] theLine = nextData.split("[{}]");

                        for(int i = 0 ; i < theLine.length ; i++){

                            if(theLine[i].contains("\\end") && theLine[i+1].equals(s.peek())){

                                s.pop();

                            }

                            if(theLine[i].equals("\\begin")){

                                title = theLine[i+1];

                                s.push(title);
                            }
                        }
                    }//end of BEGIN AND END if
                }
            }//end of whiles

            fscan.close();

    if(s.isEmpty()){

        System.out.println();
        System.out.println(fname + " LaTeX file is valid!");
        System.exit(0);

    }

    while(!s.isEmpty()){

    }
}
} 
```

# sql - 单字符插入的唯一约束违规

> ID：15365681
> 
> 赞同：0
> 
> 时间：2013-03-12T15:44:40.787
> 
> 标签：sql, sql-server, sql-server-2008, constraints, unique-constraint

我对 SQL Server 2008 数据库表有一个唯一约束，该约束包含 4 列。在输入一些测试数据时，我意外收到了一个独特的约束违规。对于四列，我只是输入一个数字，插入值集，增加数字，然后重复（即 (1,1,1,1) (2,2,2,2,)...等） . 当我到达 10 时发生违规。如果我现在输入任何数字，它将违反约束。然后我尝试只输入字母“A”，并尝试插入任何以“A”开头的单词，这导致了违规。我是否需要更改约束中的某些内容，或者它们实际上应该如何工作？

```
ALTER TABLE [dbo].[Table] ADD  CONSTRAINT [UC_Table_Column1_Column2_Column3_Column4] 
UNIQUE NONCLUSTERED 
(
    [Column1] ASC,
    [Column2] ASC,
    [Column3] ASC,
    [Column4] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF,    
IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON   
[PRIMARY] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:55:45.583

那应该工作得很好。实际的表定义是什么？你的排序是什么？

```
-- Working Example
CREATE TABLE dbo.[Table](
      Column1 VARCHAR(50)
    , Column2 VARCHAR(50)
    , Column3 INT
    , Column4 VARCHAR(25)
);

ALTER TABLE [dbo].[Table] ADD  CONSTRAINT [UC_Table_Column1_Column2_Column3_Column4] 
UNIQUE NONCLUSTERED 
(
    [Column1] ASC,
    [Column2] ASC,
    [Column3] ASC,
    [Column4] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF,    
IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON   
[PRIMARY]

DECLARE @iteration INT = 0;

WHILE @iteration < 20
BEGIN
    INSERT INTO [dbo].[Table]
    SELECT @iteration, @iteration, @iteration, @iteration;

    SET @iteration += 1;
END;

SELECT * FROM [dbo].[Table]; 
```

# python - 在 Python 2.7 中使用 format() 迷你语言将浮点数与小数点对齐

> ID：15365685
> 
> 赞同：4
> 
> 时间：2013-03-12T15:44:45.017
> 
> 标签：python, python-2.7, format

我想打印行，以便数字的小数点对齐。目前，它打印如下所示：

```
ydisp       0.176
xdisp       -0.509 
```

我想要的是这样的

```
ydisp        0.176
xdisp       -0.509 
```

我正在使用的代码是

```
print "{:{width}} {}".format(items,float_dict[items], width=12) 
```

但我现在有点迷茫，我在 Python 2.7 手册中找到了 Mini Language 格式下的以下部分

“在宽度字段前加一个零 ('0') 字符可以为数字类型启用符号感知零填充。这相当于填充字符为 '0' 且对齐类型为 '='。”

我真的无法让它与这个“0”字符一起工作。如果有人可以在这里给我一个提示，那就太好了。

注意：字典键是字符串类型，值是浮点类型。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T15:47:08.193

`' '`用作符号修饰符以包含符号的空格：

```
>>> '{:20} {: }'.format('ydisp', 0.176)
'ydisp                 0.176'
>>> '{:20} {: }'.format('xdisp', -0.509)
'xdisp                -0.509' 
```

`:`注意冒号后面的空格。这会导致正数在左侧用空格填充，而负数则显示 a `-`。

# xml - XML Twig 不缩进新添加的元素？

> ID：15365689
> 
> 赞同：2
> 
> 时间：2013-03-12T15:44:57.643
> 
> 标签：xml, perl, parsing, xml-twig

XML的相关部分看起来像

```
<?xml version="1.0" encoding="UTF-8"?>
<key name="home">
        <entry name="default">zzzzz</entry>
        <key name="ffffff"></key>
        <key name="plugin">
                <key name="pst">
                        <entry name="enable">true</entry>
                </key>
        </key>
        <key name="hover">
                <key name="doze">
                        <key name="eventmanager">
                                <key name="types"></key>
                        </key>
                        <key name="ips">
                                <key name="proto">
                                        <key name="dos">
                                                <key name="dop"></key>
                                        </key>
                                </key>
                        </key>
                </key>
        </key>
.
.
. 
```

我的代码：

```
#!/root/bin/perl
use strict;
use warnings;
use XML::Twig;

my $tree = XML::Twig->new(pretty_print => 'indented', keep_spaces => 1);

$tree->parsefile(shift);
my $msg =<<'MSG';
<key name="absy">
 <entry name="msg"></entry>
 <entry name="title"></entry>
</key>
MSG

my $client_plugin = XML::Twig::Elt->new( key => { name => 'client' } )->set_inner_xml($msg);

$client_plugin->paste(last_child => $tree->first_elt(sub {  $_[0]->tag =~ m/key/ and $_[0]->att('name') =~ m/plugin/i }));

$tree->print; 
```

问题是添加的元素出现在一行中，并且不像其他元素那样真正缩进。我也试过`$tree->print(pretty_print => 'indented')`没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T16:00:23.237

该模块正在从您的呼叫`XML::Twig::Elt`中丢弃无关紧要的空白。`inner_html`

同时，您已经`keep_spaces => 1`为`XML::Twig`模块指定了 , ，因此它保留了（缺少）空间。

删除`keep_spaces => 1`它应该对您有用。

**更新**

您可能希望查看与您自己的程序执行相同操作但使用 XPath 步骤而不是可读性较差的匿名子例程作为条件的代码。

```
use strict;
use warnings;

use XML::Twig;

my $tree = XML::Twig->new(pretty_print => 'indented');
$tree->parsefile(shift);

my $msg = <<'MSG';
<key name="absy">
    <entry name="msg"/>
    <entry name="title"/>
</key>
MSG

my $client_plugin = XML::Twig::Elt->new( key => { name => 'client' } );
$client_plugin->set_inner_xml($msg);

my $plugin = $tree->first_elt('key[@name="plugin"]');
$client_plugin->paste(last_child => $plugin);

$tree->print; 
```

**输出**

```
<?xml version="1.0" encoding="UTF-8"?>
<key name="home">
  <entry name="default">zzzzz</entry>
  <key name="ffffff"></key>
  <key name="plugin">
    <key name="pst">
      <entry name="enable">true</entry>
    </key>
    <key name="client">
      <key name="absy">
        <entry name="msg"/>
        <entry name="title"/>
      </key>
    </key>
  </key>
  <key name="hover">
    <key name="doze">
      <key name="eventmanager">
        <key name="types"></key>
      </key>
      <key name="ips">
        <key name="proto">
          <key name="dos">
            <key name="dop"></key>
          </key>
        </key>
      </key>
    </key>
  </key>
</key> 
```

# c++ - 从vs2010运行成功时运行.exe崩溃

> ID：15365695
> 
> 赞同：0
> 
> 时间：2013-03-12T15:45:21.433
> 
> 标签：c++, visual-studio-2010

我使用 Visual Studio 2010 开发了一个 c++ 程序，它运行良好，但是在尝试使用在调试文件夹而不是 VS2010 中创建的 .exe 文件启动它时，它崩溃了。它更新了我的数据库一次，但随后意外崩溃..

有谁知道为什么？为了能够在另一台 PC 上运行我的应用程序，我应该怎么做才能避免它。它使用 C 的 winsock 库和 mysql API，所以我想知道是否需要配置 VS2010 在链接时自己不做的其他事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:49:22.950

重新构建应用程序后，您应该将构建配置设置为`Release`，并使用`Release`文件夹中的 .exe。来自的可执行文件`Debug`夹中的可执行文件（原则上）仅由 Visual Studio 内部使用，因此重新分发它是没有意义的。

但是请注意，为了运行使用 Visual C++ 创建的任何应用程序，用户必须安装 Visual C++ 可再发行软件包，因此请确保用户已安装该软件包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:47:01.720

您是否依赖于当前目录？一旦出现问题，我们就有一个案例。

# c# - 嵌入 DLL 并从 XAML 引用

> ID：15365704
> 
> 赞同：0
> 
> 时间：2013-03-12T15:45:52.843
> 
> 标签：c#, wpf, xaml

我有一个使用 GMAP.Net 和扩展 WPF 工具包的 WPF 应用程序。我直接在我的 XAML 中引用这些库中的控件。我想将这些 dll 添加到我的项目中并将它们标记为嵌入式资源。

当我不再使用 dll 作为参考时，如何继续从 XAML 中引用控件？

编辑：没有多少代码可以显示。这在我使用 gmap 作为参考时有效。

```
xmlns:WindowsPresentation="clr-namespace:GMap.NET.WindowsPresentation;assembly=GMap.NET.WindowsPresentation" 
```

一旦我删除 gmap 作为参考并添加为嵌入式资源，就会出现错误消息：

`Error 1 The name "GMapControl" does not exist in the namespace "clr-namespace:GMap.NET.WindowsPresentation;assembly=GMap.NET.WindowsPresentation". Windows\MapWindow.xaml`

`xmlns`智能感知/下拉列表中不存在 gmap 引用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:08:36.417

保留引用的 dll，在构建最终版本时不要复制它们。此外，您是否向 AssemblyResolve 添加了代码以提取嵌入式资源？我的代码使用压缩程序集。

```
 AppDomain.CurrentDomain.AssemblyResolve += ( sender, args ) =>
        {
            try
            {
                String resourceName = String.Format( "Program.Libs.{0}.dll.gz", new AssemblyName( args.Name ).Name );
                using (var stream = new GZipStream( Assembly.GetExecutingAssembly().GetManifestResourceStream( resourceName ), CompressionMode.Decompress ))
                using (var outstream = new MemoryStream())
                {
                    CopyTo( stream, outstream );
                    return Assembly.Load( outstream.GetBuffer() );
                }
            }
            catch (Exception e)
            {
                System.Diagnostics.Debug.WriteLine( e.ToString() );
                return null;                    
            }
        };

    public static long CopyTo( Stream source, Stream destination )
    {
        byte[] buffer = new byte[ 2048 ];
        int bytesRead;
        long totalBytes = 0;
        while ((bytesRead = source.Read( buffer, 0, buffer.Length )) > 0)
        {
            destination.Write( buffer, 0, bytesRead );
            totalBytes += bytesRead;
        }
        return totalBytes;
    } 
```

# c++ - OpenCV中的resizeNN？

> ID：15365705
> 
> 赞同：0
> 
> 时间：2013-03-12T15:45:52.870
> 
> 标签：c++, opencv

我正在寻找一个快速版本`cv::resize()`，我试图在 OpenCV 源代码中挖掘并找到该函数`resizeNN`，我假设它使用 ARM Neon .. 我试图测试它，但 dst Mat 根本没有数据，或者我是对这个功能感到困惑？它甚至不在文档中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:10:31.833

有 cv::resize() [在大部分工作中调用 cv::reserve()]，

在 modules/core/src/matrix.cpp ~ L 599

* * *

并且有 resizeNN( const Mat& src, Mat& dst, double fx, double fy )

在模块/核心/src/imagewarp.cpp ~ L 355

（它甚至不在 api 中，所以这可能是一个私有 impl 函数）

* * *

他们看起来完全独立于我，我想，你想要第一个。

# dns - 使用外部 DNS 服务提供商设置 EC2

> ID：15365706
> 
> 赞同：1
> 
> 时间：2013-03-12T15:45:54.090
> 
> 标签：dns, amazon-web-services, amazon-ec2, amazon, instance

EC中有一个实例，我有使用弹性IP 54.244.XXX.XXX的公共IP

当我在 DNS 上设置配置时，它会询问主 NS 和 IP……所以 IP 已设置。而 NS？，我尝试使用实例的公共 DNS 没有结果。该站点仍然无法访问。

我正在尝试在 DNS 提供商中设置数据。提供商正在请求主名称服务器的 NS 和 IP。这是用于托管网站。

我相信我没有很好地解释自己。我在 nic.cl 购买了一个域，并且我在 ec2 中的实例配置了弹性 IP。从这里我有域和实例的 ip。但是，当我尝试配置 dns 以指向我的实例时，他们要求我提供 NS 和 IP。

来自这里的一些指示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:36:30.787

如果您被要求设置 NS，那么您不是在设置 DNS，而是向您的注册商提供名称服务器。

如果您的注册商不提供 DNS，您可以使用 Route53 作为 DNS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:36:35.827

您在 DNS 和您的 IP 之间混淆了。您的 IP（除非它正在运行 DNS 服务器）不是您需要输入这些名称服务器设置的内容。

您的名称服务器看起来像 ns1.dnsdomain.com 和 ns2.dnsdomain.com - 当有人加载您的域名时，会查询这两个名称服务器之一并将返回您的 EC 实例的 IP。

因此，这使我们了解了您可以做的事情。好吧，如果您的域注册商（您注册域的人）没有某种可以使用的默认名称服务器，我会感到惊讶。从那里，您应该能够为 www.yourdomain.com 和 yourdomain.com 创建 A 记录。

如果您的域注册商不提供此服务，您可以使用[cloudns 之](http://www.cloudns.net/)类的东西- 您需要注册，为您的域创建一个条目，然后使用他们为您提供的名称服务器。

# java - 如何获取 WAR 文件的大小？

> ID：15365708
> 
> 赞同：2
> 
> 时间：2013-03-12T15:45:58.557
> 
> 标签：java, servlets, war

我想获得在我的服务器上运行的 WAR 文件的大小。我试过谷歌搜索如何做到这一点，但我没有任何运气。如果我尝试 File.length()，它会返回 0（不是很有帮助）。

我注意到当我这样做时`request.getServletContext().getRealPath("/")`，它会返回：

`C:\Program Files\Apache Software Foundation\Tomcat 7.0\webapps\nameofmyapp\`

有什么方法可以使用此路径来查找已部署的 WAR 文件的大小？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:09:08.463

WAR 文件只是一个美化的 zip 文件，用于将 webapp 部署到 Tomcat。部署后，Tomcat 将 WAR 文件解压缩到同名目录（无`.war`扩展名）。

在您的应用程序中，`request.getServletContext().getRealPath("/")`表示解压后的 web 应用程序的根目录的路径，而不是 WAR 文件。（这可能是您的`File.length`调用返回 0[的原因——javadoc](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#length%28%29)说目录的长度未定义。）要获取 WAR 文件的路径和大小，请去掉尾部斜杠并添加`.war`扩展名：

```
File webappPath = new File(request.getServletContext().getRealPath("/"));
File warFile = new File(webappPath.getParent(), webappPath.getName() + ".war");
int warSize = warFile.length(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:08:30.407

你可以试试这个：

```
File file = new File("C:/Program Files/Apache Software Foundation/Tomcat 7.0/webapps/nameofmyapp.war");
if (file.exists()) {
    double bytes = file.length();
    double kiloBytes = (bytes / 1024);
    double megaBytes = (kiloBytes / 1024);
    double gigaBytes = (megaBytes / 1024);
    double teraBytes = (gigaBytes / 1024);
    double petaBytes = (teraBytes / 1024);
    double exaBytes = (petaBytes / 1024);
    double zettaBytes = (exaBytes / 1024);
    double yottaBytes = (zettaBytes / 1024);

    System.out.println("File Size: " + bytes + " B");
    System.out.println("File Size: " + kiloBytes + " KB");
    System.out.println("File Size: " + megaBytes + " MB");
    System.out.println("File Size: " + gigaBytes + " GB");
    System.out.println("File Size: " + teraBytes + " TB");
    System.out.println("File Size: " + petaBytes + " PB");
    System.out.println("File Size: " + exaBytes + " EB");
    System.out.println("File Size: " + zettaBytes + " ZB");
    System.out.println("File Size: " + yottaBytes + " YB");
} else {
    System.out.println("Oops!! File does not exists!");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:12:03.190

```
File file = new File(""C:/Program Files/Apache Software Foundation/Tomcat6.0/webapps/myapp.war"");
                long filesize = file.length(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T20:09:32.547

谢谢你们的建议。他们工作，但他们返回 WAR 本身的文件大小（WAR 文件大约 24 MB，它返回 4096 字节）。

无论如何，这是最终起作用的代码：

```
@Autowired
ServletContext context;  //because Tomcat 6 needs to have ServletContext autowired

String strWebAppName = context.getRealPath("/");
String strWarFile = new File(strWebAppName).getParent() + "/myappname.war";
File fileMyApp = new File(strWarFile);
long fileSize = 0;
if(fileMyApp.exists())
{
    fileSize = fileMyApp.length();
} 
```

它返回 24671122 个字节。谢谢你们的帮助。

编辑：刚刚看到你的帖子马茨。几乎正是我得到的。谢谢你=）。

# android - 使用 Android FacebookSDK v3 获取应用访问令牌

> ID：15365712
> 
> 赞同：2
> 
> 时间：2013-03-12T15:46:03.180
> 
> 标签：android, facebook, facebook-graph-api, access-token

这是我的第一个主题，我希望你能帮助我（请对我的英语很好，因为我的第一语言是法语）thx :)）

我有一个问题，我正在尝试使用 Facebook Android Facebook SDK v3 获取应用程序访问令牌，但到目前为止我还没有成功。

我在互联网上看到，要获取应用令牌，我们需要访问该链接：

```
https://graph.facebook.com/oauth/access_token client_id=*************&client_secret=***********************&%20grant_type=client_credentials 
```

所以我做了一个请求对象来获取应用令牌：

```
Bundle bundle = new Bundle();
bundle.putString("client_id", appId);
bundle.putString("client_secret", appSecret);
bundle.putString("grant_type", "client_credentials");

Request request = new Request(null, "oauth/access_token", bundle, HttpMethod.GET);
Response resp = request.executeAndWait(); 
```

对象“响应”返回给我一个 GraphObject，如下所示： `GraphObject{graphObjectClass=GraphObject, state={"FACEBOOK_NON_JSON_RESULT":"access_token"}}`

但是访问令牌不包含在请求返回的响应中。

但是，当我在浏览器中启动链接时，我会得到如下页面： `access_token=[the_access_token]`

为什么我不能得到与响应相同的东西？难道我做错了什么？有没有人有办法解决吗？

非常感谢 ！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-11-21T08:02:32.060

我有同样的问题。

访问令牌不是 JSON 类型。所以你不能使用facebook api的'request'和'response'。您将在链接下获得解决方案。

[显示此链接](https://stackoverflow.com/questions/10816773/facebook-access-token-storing-in-android-app)

或查看代码

* * *

```
public static void getAppAccessToken(){
    String url = "https://graph.facebook.com/oauth/access_token?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&grant_type=client_credentials";
    InputStream is;
    String result;
    HttpClient httpclient = new DefaultHttpClient();
    HttpGet httpget = new HttpGet(url);

    try{
        HttpResponse response = httpclient.execute(httpget);

        HttpEntity entity = response.getEntity();
        is = entity.getContent();

        BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
        StringBuilder sb = new StringBuilder();
        String line = null;

        while ((line = reader.readLine()) != null) {
             sb.append(line);
        }   

        is.close();
        result=sb.toString();
        result = result.split("=")[1];
        appAccessToken = result;
    }
    catch(Exception e)
    {

    }
} 
```

* * *

# forms - 查看传入页面并确定是否正在传递表单

> ID：15365717
> 
> 赞同：1
> 
> 时间：2013-03-12T15:46:10.467
> 
> 标签：forms, coldfusion, struct, cfml

我需要确定页面是否将表单传递到我们的内部站点。如果页面来自外部域，我们需要重定向。

一位同事想出了以下代码：

```
<cfif isDefined("form")>
  <cfif not findnocase("our_domain", http_referer)>
    <cflocation url="redirect_link">
  </cfif>
</cfif> 
```

我认为他没有`isDefined()`正确使用，因为`isDefined()`寻找变量。我们需要寻找表格本身。我也研究过`structKeyExists()`，但同样，这会在表单中查找变量。如何查找表单本身？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T16:01:22.733

有两种方法。您可以检查 CGI.REQUEST_METHOD 以检查是否正在发送 POST。

您还可以检查`structKeyExists(form,"fieldNames")`仅在实际提交表单时才会出现这种情况。

虽然不在问题中，但我也会避免在没有范围的情况下引用 http_referer。使用 CGI.http_referer 因为它更容易阅读。您还可以将 FORM 的测试和外部引用者合并到一个语句中：

```
<cfif structKeyExists(form,"fieldNames") AND NOT findnocase("our_domain", CGI.http_referer)>
   <cflocation url="redirect_link">
</cfif> 
```

另外，您知道重定向不会携带任何表单字段吗？我猜这就是你想要的，但值得一提。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T16:01:57.730

`isDefined()``structKeyExists`实际上会查看所有范围、变量、表单、url、应用程序、会话、客户端（如果它们都存在），但在这种情况下，您希望通过执行操作来使用`structKeyExists(form,'fieldnames')`您还可以检查特定的表单字段。

```
<cfif structKeyExists(form,'fieldnames')>
    <cfif not findnocase("our_domain", cgi.http_referer)> // scope http_referer
        <cflocation url="redirect_link" addtoken="false">
    </cfif>
</cfif> 
```

如果你不限定 cgi.http_referer 用户可以传入一个名为 http_referer 的 url 变量来欺骗页面。在这种情况下似乎不会有所作为，但仍然是一个很好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:01:14.277

他在表单范围上使用 isDefined 的方式将始终通过，因为表单范围是所有页面的预定义 CF 范围。您需要检查是否正在使用表单中的特定变量。如果您知道将从表单中传递哪些字段（换句话说，如果此登录页面上始终需要相同的表单），则会更有帮助。如果所有这些都为真，您可以使用 fieldnames 表单值，该值是在提交表单时附加到 ColdFusion 表单的值。

```
<cfif NOT structKeyExists(form, 'fieldnames') AND NOT findnocase("our_domain", http_referer)>
     <cflocation url="someurl" addtoken="false" />
<cfelse>
     <!--- Page Processing actions go here --->
</cfif> 
```

如果您知道字段名称是什么，那么您可以细化条件以检查字段名称值，然后以这种方式通过或失败；尽管在这种情况下我可能会使用标志并以编程方式检查条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T10:10:33.810

检查引用的域总是一个问题，因为它很容易被欺骗。您可以使用的一种方法是在您的站点生成的表单中传递一个变量，因此只有在您的站点提交表单时才能存在。脚的例子。每次加载页面时创建一个 uuid 将其存储在访问者会话中，并将其放入表单中。

提交表单时，将 form.uuid 与 session.page.uuid 进行比较，前提是它们匹配的是从您自己的站点提交的表单。

# python - Eclipse，jython：将 numpy 模块添加到 jython

> ID：15365720
> 
> 赞同：3
> 
> 时间：2013-03-12T15:46:21.977
> 
> 标签：python

我在安装 numpy-1.6.1 时遇到问题。它说`NotImplementedError`我使用 eclipse 和 jython 进行开发。

**命令窗口：**

```
C:\Program Files\jython2.5.3b3\bin\numpy-1.6.1>jython setup.py install 
```

从 numpy 源目录运行。Traceback（最近一次调用）：

```
File "setup.py", line 196, in <module>
    setup_package()

  File "setup.py", line 173, in setup_package
    from numpy.distutils.core import setup

  File "C:\Program Files\jython2.5.3b3\bin\numpy-1.6.1\numpy\distutils\__init__.py", line 7, in <module>
    import ccompiler
  File "C:\Program Files\jython2.5.3b3\bin\numpy-1.6.1\numpy\distutils\ccompiler.py", line 15, in <module>
    from numpy.distutils.exec_command import exec_command

  File "C:\Program Files\jython2.5.3b3\bin\numpy-1.6.1\numpy\distutils\exec_command.py", line 585, in <module>
    raise NotImplementedError('exec_command tests for ', os.name)

NotImplementedError: ('exec_command tests for ', 'java') 
```

你能帮我解决这个问题吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:48:24.260

遗憾的是，`numpy`Jython 不支持。从[常见问题解答](http://scipy.github.com/faq.html#does-numpy-scipy-work-with-jython)：

> NumPy/SciPy 是否与 Jython 一起使用？
> 
> 不。简单地说，Jython 运行在 Java 虚拟机之上，无法与标准 Python (CPython) 解释器用 C 语言编写的扩展接口。

# android - 用于控制多个 WebView 的 ViewPager 和 Actionbar Items

> ID：15365724
> 
> 赞同：0
> 
> 时间：2013-03-12T15:46:33.587
> 
> 标签：android, android-activity, android-webview, actionbarsherlock, android-viewpager

我在添加操作栏项来控制我的 Viewpager 屏幕时遇到了麻烦，我希望能够根据拉起的页面来控制 viewpager。我真的只有 3 个 web 视图，我想添加操作栏项以通过操作栏（刷新、后退、前进）控制 web 视图。提前感谢您提供的任何帮助。谢谢

## 代码

```
public class AwesomePagerActivity extends SherlockActivity {

private ViewPager awesomePager;
private static int NUM_AWESOME_VIEWS = 3;
private Context context;
private AwesomePagerAdapter awesomeAdapter;
LayoutInflater inflater ;

/** Called when the activity is first created. */

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    // Set up the action bar.
    getSupportActionBar().show();

    context = this;

    inflater = (LayoutInflater)
            context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    awesomeAdapter = new AwesomePagerAdapter();
    awesomePager = (ViewPager) findViewById(R.id.pager);
    awesomePager.setOffscreenPageLimit(3);
    awesomePager.setAdapter(awesomeAdapter);

    //Title Page
    //Get a reference to the TitlePageIndicator
    TitlePageIndicator awesomeIndicator = (TitlePageIndicator) findViewById(R.id.indicator);
    // Attach adapter to ViewPager
    awesomePager.setAdapter(awesomeAdapter);

    // Attach ViewPager to the indicator
    awesomeIndicator.setViewPager(awesomePager);

}

public boolean onCreateOptionsMenu(com.actionbarsherlock.view.Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    //super.onCreateOptionsMenu(menu);
    //getMenuInflater().inflate(R.menu.activity_enlighten_webview_secondary, menu);
    MenuInflater Inflater=getSupportMenuInflater();
    Inflater.inflate(R.menu.menu, menu);
    return true;
}

public boolean onOptionsItemSelected(MenuItem item)
{
    WebView webView = (WebView) awesomePager.getChildAt(awesomePager.getCurrentItem());

    switch (item.getItemId())
    {
        case R.id.menu_back:
            webView.goBack();
            Toast.makeText(AwesomePagerActivity.this, "Now ", Toast.LENGTH_SHORT).show();
            return true;
    }
    return super.onOptionsItemSelected(item);
}

private class AwesomePagerAdapter extends PagerAdapter{
    private String[] titles = new String[]{"Dashboard", "Community", "Support"};

    public int getCount() {
        return NUM_AWESOME_VIEWS;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return titles[position % titles.length];
    }

    public Object instantiateItem(View collection, int position) {

        WebView web = new WebView(AwesomePagerActivity.this);

        View layout = null; 
        switch (position) {
        case 0: {
            LayoutInflater mInflater =  (LayoutInflater)
                    context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        layout  = mInflater.inflate(R.layout.activity_main, null);

                // changed from WebView web = (WebView)layout.findViewById(R.id.webView1);
        layout.findViewById(R.id.webView);

        WebSettings websettings = web.getSettings();
        websettings.setBuiltInZoomControls(false);
        websettings.setUseWideViewPort(true);
        websettings.setJavaScriptEnabled(true);
        websettings.setAllowFileAccess(true);
        websettings.setDomStorageEnabled(true);
        websettings.setLoadWithOverviewMode(true);
        websettings.setSavePassword(true);
        web.requestFocusFromTouch();
        web.setWebViewClient(new WebViewClient());
        web.setWebChromeClient(new WebChromeClient());
        web.loadUrl("https://google.com");

        }
        break;

        case 1: {        LayoutInflater mInflater =  (LayoutInflater)
                context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        layout  = mInflater.inflate(R.layout.activity_community, null);

     //   WebView web = (WebView)layout.findViewById(R.id.webView2);
        WebSettings websettings = web.getSettings();
        websettings.setBuiltInZoomControls(true);
        websettings.setUseWideViewPort(true);
        websettings.setJavaScriptEnabled(true);
        websettings.setAllowFileAccess(true);
        websettings.setDomStorageEnabled(true);
        websettings.setLoadWithOverviewMode(true);
        websettings.setSavePassword(true);
        web.requestFocusFromTouch();
        web.setWebViewClient(new WebViewClient());
        web.setWebChromeClient(new WebChromeClient());
        web.loadUrl("http://developer.android.com");
        }
        break;

        case 2: {        LayoutInflater mInflater =  (LayoutInflater)
                context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        layout  = mInflater.inflate(R.layout.activity_support, null);

       // WebView web = (WebView)layout.findViewById(R.id.webView3);
        WebSettings websettings = web.getSettings();
        websettings.setBuiltInZoomControls(true);
        websettings.setUseWideViewPort(false);
        websettings.setJavaScriptEnabled(true);
        websettings.setAllowFileAccess(true);
        websettings.setDomStorageEnabled(true);
        websettings.setLoadWithOverviewMode(true);
        websettings.setSavePassword(true);
        web.requestFocusFromTouch();
        web.setWebViewClient(new WebViewClient());
        web.setWebChromeClient(new WebChromeClient());
        web.loadUrl("http://www.xda-developers.com");
        }
        break;

        }

((ViewPager) collection).addView((View)layout,0);

return layout;
}

public void destroyItem(View collection, int position, Object view) {
((ViewPager) collection).removeView((View) view);
}

public boolean isViewFromObject(View view, Object object) {
return view==((View)object);
}

public void finishUpdate(View arg0) {}

public void restoreState(Parcelable arg0, ClassLoader arg1) {}

public Parcelable saveState() {
return null;
}

public void startUpdate(View arg0) {}

}
} 
```

根据建议更新代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T06:44:17.573

我已将您的初始代码重写为应该执行您想要的操作：

```
public class AwesomePagerActivity extends Activity {

private ViewPager awesomePager;
private static int NUM_AWESOME_VIEWS = 3;
private Context context;
private AwesomePagerAdapter awesomeAdapter;
LayoutInflater inflater;

/** Called when the activity is first created. */
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    context = this;
    inflater = (LayoutInflater)
    context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    awesomeAdapter = new AwesomePagerAdapter();
    awesomePager = (ViewPager) findViewById(R.id.pager);
    awesomePager.setOffscreenPageLimit(3);
    awesomePager.setAdapter(awesomeAdapter);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {     
    MenuInflater Inflater = getSupportMenuInflater();
    Inflater.inflate(R.menu.menu, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem Item) {
    final int current = awesomePager.getCurrentItem();
    int currentId = current == 0 ? R.id.webView1
            : (current == 1 ? R.id.webView2 : R.id.webView3);
    WebView web = (WebView) findViewById(currentId);
    switch (Item.getItemId()) {
    case R.id.menu_back:
        web.goBack();
        return true;
    case R.id.menu_forward:
        web.goForward();
        return true;
    case R.id.menu_refresh:
        web.reload();
        return true;
    }
    return super.onOptionsItemSelected(Item);
}

private class AwesomePagerAdapter extends PagerAdapter {

    public int getCount() {
        return NUM_AWESOME_VIEWS;
    }

    public Object instantiateItem(View collection, int position) {
        View layout = null;
        LayoutInflater mInflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        WebView web = null;
        switch (position) {
        case 0:
            layout = mInflater.inflate(R.layout.activity_main, null);
            web = (WebView) layout.findViewById(R.id.webView1);
            web.loadUrl("http://developer.android.com");
            break;
        case 1:
            layout = mInflater.inflate(R.layout.activity_community, null);
            web = (WebView) layout.findViewById(R.id.webView2);
            web.loadUrl("http://www.xda-developers.com");
            break;
        case 2:
            layout = mInflater.inflate(R.layout.activity_support, null);
            web = (WebView) layout.findViewById(R.id.webView3);
            web.loadUrl("http://www.samsung.com");
            break;
        }
        WebSettings websettings = web.getSettings();
        websettings.setBuiltInZoomControls(position == 0 ? false : true);
        websettings.setUseWideViewPort(position == 0 ? true : false);
        websettings.setJavaScriptEnabled(true);
        websettings.setAllowFileAccess(true);
        websettings.setDomStorageEnabled(true);
        websettings.setLoadWithOverviewMode(true);
        web.requestFocusFromTouch();
        web.setWebViewClient(new WebViewClient());
        web.setWebChromeClient(new WebChromeClient());
        websettings.setSavePassword(true);
        ((ViewPager) collection).addView((View) layout);
        return layout;
    }

    public void destroyItem(View collection, int position, Object view) {
        ((ViewPager) collection).removeView((View) view);
    }

    public boolean isViewFromObject(View view, Object object) {
        return view == ((View) object);
    }

}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T18:28:48.823

将您`WebViews`的内容塞入每个`ViewPager`插槽可能会更简单。

```
@Override
public Object instantiateItem(ViewGroup viewPager, int position)
{
    WebView webView = new WebView(AwesomePagerActivity.this);

    switch (postion)
    {
        case 0:
            //All other necessary setup
            webView.loadUrl("http://developer.android.com");
        break;
        case 0:
            //All other necessary setup
            webView.loadUrl("http://xda-developers.com");
        break;
        case 0:
            //All other necessary setup
            webView.loadUrl("http://www.samsung.com");
        break;
    }
} 
```

这样，您的 Activity 可以简单地...

```
@Override
public boolean onOptionsItemSelected(MenuItem item)
{
    WebView webView = (WebView) awesomePager.getChildAt(awesomePager.getCurrentItem());

    switch (item.getItemId())
    {
        case R.id.menu_back:
            webView.goBack;
            return true;
    }
} 
```

当然，您仍然可以扩展您的`WebViews`from XML，只需将相关`findViewById()`调用插入`onOptionsItemSelected`.

# javascript - 将 cookie 设置为在用户离开网页时过期

> ID：15365728
> 
> 赞同：3
> 
> 时间：2013-03-12T15:46:46.460
> 
> 标签：javascript, cookies

目前，我的 cookie 设置为 0，当用户关闭浏览器时它就会过期。当用户离开我的网站时，有没有办法将 cookie 设置为过期？

```
Cookie.write('cookieName', 'true',{duration:0}); 
```

我将“离开我的网站”定义为：完全导航到另一个域，如果他们在我的网站周围导航，我想留下 cookie

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T15:48:22.640

由于您无法预测用户何时会离开该页面，因此您可能需要在`onbeforeunload`事件中使 cookie 过期。

```
window.onbeforeunload = deleteMyCookie; 
```

我还没有添加`deleteMyCookie`函数的实现——但本质上你可以用一个空字符串覆盖 cookie 并将过期日期设置为当前时间。

**更新**- 您的问题编辑使此答案无效。在您的情况下，您不知道他们何时离开您的域 - 因此您将不得不接受设置基于时间的到期。您可以设置一个相当短的持续时间（例如 5 分钟），并在他们每次在您的网站上加载页面时移动它 - 这样 cookie 在他们离开您的域后最多只能存在 5 分钟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-26T14:29:14.670

这是不可能的。cookie 标准并未设计为支持这种情况。Cookie 是关于 HTTP 请求和响应（无状态协议中的状态），而不是关于用户使用浏览器从一个页面到另一个域的另一个页面然后*过期*。

该*过期*基于时间（或浏览器会话），而不是浏览器选项卡会话，而不是用户导航模式等。

如果您的浏览器支持每个 Internet 域一个进程（可能作为一种安全功能），然后设置为每个进程只允许 cookie，则这*可能*无需执行任何其他操作即可工作。然而，正如本例所示，这是基于浏览器的 Cookie 实现，与如何在 Javascript 中设置 cookie 无关。

# r - 是否有模仿 ArcGIS 10.1 中的分组分析工具的 R 函数？

> ID：15365729
> 
> 赞同：3
> 
> 时间：2013-03-12T15:46:50.620
> 
> 标签：r, gis, cluster-analysis

我是 R 的初学者，但是使用 Esri 的 ArcGIS 的专家。

我想在[这里](http://resources.arcgis.com/en/help/main/10.1/index.html#/Grouping_Analysis/005p00000051000000/)使用 R 来运行探索性分组/聚类分析，例如 Arc 的 10.1 工具。

所需的最终产品必须是地图可视化。我在 SO上找到[了关于层次聚类分析的这个线程。](https://stackoverflow.com/questions/11489696/how-to-know-about-group-information-in-cluster-analysis-hierarchical)这与 Esri 的数据分组分析类型相同吗？ArcGIS 工具在参数方面提供了很大的灵活性，我希望用 R 复制这个功能。

同样，我是 R 初学者。非常感谢任何信息、建议或建议。

谢谢，迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:22:35.963

据我所知，这是一个简单的 KNN 分析。ESRI 帮助解释的替代“无距离矩阵”组件似乎非常不可取。基本上，他们使用 K-means 聚类和使用随机播种的区域增长方法。这似乎非常不稳定，并且可能返回高度可变的结果。似乎他们正在执行一些操作来避免诸如断开区域之类的问题，因此可能需要做一些事情才能准确地重新创建他们的结果。您可以近似 spdep 中的“空间受限”选项。这是一个距离分析的简短示例，它将为您提供一个起点。请记住，为了分配“类”，您需要设置某种类型的循环结构。

```
require(sp)
require(spdep)

data(meuse) 
coordinates(meuse) <- ~x+y

# Create distance matrix of specified range
meuse.dist <- dnearneigh(coordinates(meuse), 0.0001, 1000)

# Coerce distance object to a list object with distances for each observation
dist.list <- nbdists(meuse.dist, coordinates(meuse))

# Create a new column with the distance to the nearest observation using lapply and unlist
meuse@data <- data.frame(meuse@data, NNDist=unlist(lapply(dist.list, FUN=function(x) min(x))))

# Plot results
spplot(meuse, "NNDist", col.regions=colorRampPalette(c("blue","yellow","red"),
       interpolate="spline")(10)  ) 
```

您可能还想探索层次聚类。然而，对于较大的数据集，hclust 需要一个三角距离矩阵，而 dnearneigh 不需要。这是一个使用约束层次聚类的例子。

```
# SPATIALLY CONSTRAINED CLUSTERING
require(sp)
require(rioja)

data(meuse)
  coordinates(meuse) <- ~x+y
    cdat <- data.frame(x=coordinates(meuse)[,1],y=coordinates(meuse)[,2])
      rownames(cdat) <- rownames(meuse@data)

chc <- chclust(dist(cdat), method="conslink")

# KNN
  chc.n3 <- cutree(chc, k=3) 

# DISTANCE  
  chc.d200 <- cutree(chc, h=200) 

meuse@data <- data.frame(meuse@data, KNN=as.factor(chc.n3), DClust=chc.d200)

opar <- par
  par(mfcol=c(1,2))  
   cols <- topo.colors(length(unique(meuse@data$KNN)))  
    color <- rep("xx", nrow(meuse@data))
      for(i in 1:length(unique(meuse@data$KNN))) {
        v <- unique(meuse@data$KNN)[i] 
          color[(meuse@data$KNN == v)] <- cols[i]
        }
    plot(meuse, col=color, pch=19, main="KNN Clustering")

    cols <- topo.colors(length(unique(meuse@data$DClust)))  
    color <- rep("xx", nrow(meuse@data))
      for(i in 1:length(unique(meuse@data$DClust))) {
        v <- unique(meuse@data$DClust)[i] 
          color[(meuse@data$DClust == v)] <- cols[i]
        }
    plot(meuse, col=color, pch=19, main="Distance Clustering")  
par <- opar 
```

# c# - .rdlc 报告 - 无法为数据集“DataSet1”创建数据读取器

> ID：15365731
> 
> 赞同：32
> 
> 时间：2013-03-12T15:46:57.633
> 
> 标签：c#, .net, reporting-services, visual-studio-2012, report

我使用报告向导在 VS 2012 下创建了一个 .rdlc-Report 并添加了数据源和数据集。当我尝试使用下面的代码呈现报告时，我收到以下错误消息：

> 无法为数据集“DataSet1”创建数据读取器。

```
bytes = localReport.Render("PDF", sdeviceinfo, out smimetype, out sencoding, out sfilenameextension, out streamids, out myWarnings); 
```

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-06-11T02:51:44.927

我有同样的问题“无法为数据集'zzz'创建数据阅读器”

答案是`ReportDataSource(string xxx, DataTable yyy)`

您应该使用正确的名称。xxx 应该是 zzz

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-05-15T18:31:55.867

我的“陷阱”是发现 DataSet 与 Dataset 不同。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-09-07T23:52:24.473

[![在此处输入图像描述](../Images/86bea72349b9ac9e033a62dc5689b671.png)](https://i.stack.imgur.com/9q60t.jpg)

[![在此处输入图像描述](../Images/4faf2b04d4f777c28f3ec1976f37dc8d.png)](https://i.stack.imgur.com/88Gk1.jpg)

你必须给“DataSet1”，否则它不起作用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-09-11T12:48:13.897

您无法创建 ReportViewer 并提供真实数据集。由于参数提供技术，您可能会遇到错误

你可以这样试试；我用这种方式解决了：

```
 protected void btnPdf_Click(object sender, EventArgs e)
    {
    ReportViewer viwer = new ReportViewer();
    ObjectDataSource ob = new ObjectDataSource("dataset.YourTableAdapter", "GetData");
    dataset.YourTableAdapter ds = new dataset.YourTableAdapter();

    string PDF = "PDF";
    string ReportType = "ReportType";
    Warning[] warnings = null;
    string[] streamIds = null;
    string mimeType = string.Empty;
    string encoding = string.Empty;
    string extension = string.Empty;
    string filetype = string.Empty;

    viwer.SizeToReportContent = true;
    viwer.LocalReport.ReportPath = "reports/report/report.rdlc";
    viwer.ProcessingMode = ProcessingMode.Local;
    ob.SelectParameters.Clear();
    ob.SelectParameters.Add(QueryStringEnum.CompanyID, CurrentCompanyID.ToString());

    ReportDataSource rds = new ReportDataSource("datasetname", (object) ds.GetData((long?)CurrentCompanyID.ToInt64());

    viwer.LocalReport.DataSources.Add(rds);
    viwer.LocalReport.Refresh();

    byte[] bytes = viwer.LocalReport.Render("PDF", null,
     out mimeType, out encoding, out extension, out streamIds, out warnings);

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-12T17:14:27.280

1.  确保您在管理员模式下运行并且您可以访问 SSRS 服务器。

2.  验证您是否设置了正确的数据集名称，或者您是否正确加载和分配它。

请在 MSDN 上查看[此示例。](http://msdn.microsoft.com/en-US/library/ms251839%28v=VS.80%29.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-28T22:55:22.270

我解决了这个问题——我的编码错误——我从 SqlServerDataSource 的 aspx 代码中省略了“正确”参数值，如下所示......

请注意，参数名称=“p_CSV_VEHICLES”没有默认值

并且（事实证明）这两个参数（="p_CSV_VGROUPS" 和 ="p_CSV_VEHICLES"）无法将空字符串“”作为默认值传递——空字符串在这两个参数的选择上下文中无效。

在我添加 DefaultValue 并将 DefaultValue(s) 设置为每个参数的有效字符串值后，报告在我的网页上的 ReportViewer 控件中完美显示。

这是原始（不工作）aspx 代码。

```
 <asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionStrings:FCI_WebMainConnectionString %>" 
        SelectCommand="uspRPT_CostDetailFleet" SelectCommandType="StoredProcedure">
        <SelectParameters>
           <asp:Parameter DefaultValue="5" Name="p_UID_DIVISION" Type="Int32" />
           <asp:Parameter DefaultValue="85" Name="p_UID_CUSTOMER" Type="Int32" />
           <asp:Parameter DefaultValue="FCIFLEETGRP" Name="p_SORT_ORDER" Type="String" />
           <asp:Parameter DefaultValue="" Name="p_CSV_VGROUPS" Type="String" />
           <asp:Parameter Name="p_CSV_VEHICLES" Type="String" />
           <asp:Parameter DbType="Date" DefaultValue="#01/01/2013#" Name="p_dtStart0" />
           <asp:Parameter DbType="Date" DefaultValue="#12/31/2013#" Name="p_dtEnd0" />
        </SelectParameters>
     </asp:SqlDataSource> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-12T12:28:35.097

我也有同样的问题。经过我的观察，我发现，RDLC 报告确实需要数据集，要么它应该有一些记录，要么是空对象（空对象将有元数据）

所以最好的做法是总是返回一个带有空对象（不是`Null`或`nothing`）或其中有一些记录的数据集。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-07T04:58:00.173

确保这两件事没问题：

1) 在 Report1.rdlc[Design] 中（按 Alt+Ctrl+D）：

右键单击数据集并添加数据集，

在数据集属性表单中，选择名称：DataSet1

单击 DataSource combocox 旁边的 New... 按钮

点击对象

在你的项目上。选择 yourList1 或 ...

并完成。

现在选择组合框上的数据源和可用数据集。

重复这些步骤并创建 DataSet2 ...

单击确定并关闭表单。

2）在您的FormPrint代码中：

```
 private void frmPrint_Load(object sender, EventArgs e)
    {
        CreateReport1();
        System.Drawing.Printing.PageSettings ps = new 
               System.Drawing.Printing.PageSettings();
        ps.Margins.Top = CentimeterToPixel(0.9);
        ps.Margins.Left = CentimeterToPixel(0.9);
        ps.Margins.Right = CentimeterToPixel(0.9);
        ps.Margins.Bottom = CentimeterToPixel(0.9);
        ps.Landscape = false;
        ps.PaperSize =new PaperSize ("A4", 827, 1169);
        ps.PaperSize.RawKind = (Int32)(System.Drawing.Printing.PaperKind.A4);
        //psize.RawKind = (int)PaperKind.A4;
        //ps.PaperSize = psize;
        reportViewer1.SetPageSettings(ps);
        this.reportViewer1.RefreshReport();
        this.reportViewer1.SetDisplayMode(DisplayMode.PrintLayout);
        WindowState = FormWindowState.Maximized;
    }
    private int CentimeterToPixel(double Centimeter)
    {
        int  pixel = -1;
        using (Graphics g = this.CreateGraphics())
        {
            pixel =Convert.ToInt32 ( Centimeter * (g.DpiY / 2.54));
        }
        return pixel;
    }
    private void CreateReport1()
    {
        reportViewer1.LocalReport.DataSources.Clear();
        reportViewer1.ProcessingMode = 
                     Microsoft.Reporting.WinForms.ProcessingMode.Local;

        reportViewer1.LocalReport.ReportEmbeddedResource = 
                        "yourProjectName.Report1.rdlc";
        ReportDataSource RDS = new ReportDataSource();
        RDS.Name = "DataSet1";
        RDS.Value = yourPublicList1;
        reportViewer1.LocalReport.DataSources.Add(RDS);

        ReportDataSource RDS2 = new ReportDataSource();
        RDS2.Name = "DataSet2";
        RDS2.Value = yourPublicList2;
        reportViewer1.LocalReport.DataSources.Add(RDS2);
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-11T10:56:28.480

请检查您的数据集名称是否正确。

```
 reportDataSource = new ReportDataSource
    {
       Name = "DataSet1",// Check This Line. Are You Sure DataSet Name is Correct?
       Value = ListData 
    }; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-01-13T19:50:05.043

我无法分享源代码，但我想提交一个对我有帮助的答案。

我从现有代码库中复制了一份之前制作的报告。它已经在 Visual Studio 的“报表数据”视图中创建了数据集，因为我复制了一个现有报表。我需要这份已有报告的大部分内容；但是，我删除了其中一个数据集，并将其替换为我创建的一个新数据集，其中包含新报告所需的新数据。

我在这里犯的一个大错误是我认为我将新数据集重新命名为与旧数据集完全相同的名称。旧数据集被命名为“ReportDetail”。但是，我制作的新文件名为“ReportDetails”，带有“s”。

我需要旧数据集中的一些数据字段；但是，我没有意识到那些旧字段仍在旧数据集名称下的复制报告中。所以在报告中有一个字段仍然被称为“ReportDetail.{fieldName}”。最终这就是问题所在。

打开 .rdlc 报告的 XML 版本后，我可以清楚地看到旧的数据集名称仍在使用中。由于该旧数据集不再存在，因此引发了此错误。一旦我翻转该字段以使用新的数据集名称，它就可以正常工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-18T01:39:14.890

```
reportviewer1.LocalReport.DataSources.Add(New ReportDataSource("DataSet1", ObjectDataSource1)) 
```

最好发布代码，如何将数据源设置为报告。

# ios - iOS PhoneGap as Subview(cleaver) 在 Plugin 中获取 UIViewController

> ID：15365732
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:46:59.083
> 
> 标签：ios, cordova, phonegap-plugins

我根据此处的说明将PhoneGap用作子视图（切割器）：http: [//docs.phonegap.com/en/2.5.0/guide_cordova-webview_ios.md.html#Embedding%20Cordova%20WebView%20on%20iOS](http://docs.phonegap.com/en/2.5.0/guide_cordova-webview_ios.md.html#Embedding%20Cordova%20WebView%20on%20iOS)

我在 webview 之上有一个本机 UI。添加的 webview 与上面的链接指示相同：

```
vController = [CDVViewController new];
vController.view.frame = CGRectMake(0, 0, 768, 1024);
vController.wwwFolderName = @"www";
vController.startPage = @"index.html";
vController.useSplashScreen = NO;

[self.view addSubview:vController.view]; 
```

现在在我的插件中，我试图关闭部分本机 UI，当触摸 phonegap 视图中的按钮时，我使用：`self.viewController`它返回给我一个 CDVViewController 类型的视图控制器。这不是我要找的。我需要访问添加了 vController.view 的视图控制器作为子视图。我`self.viewController.parentViewController`也`presentingViewController`和其他人试过。

如何从 CDVPlugin 访问屏幕上的实际视图控制器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T10:49:23.910

尝试

```
UIViewController *rootViewController = [[[[UIApplication sharedApplication] delegate] window] rootViewController]; 
```

或者

```
id currentController = [[[delegate window] rootViewController] visibleViewController]; 
```

我在我正在开发的插件上使用了第二个，并且工作正常（我也在使用切割器）

# html - 是什么导致我的 div 被隐藏？

> ID：15365736
> 
> 赞同：1
> 
> 时间：2013-03-12T15:47:04.880
> 
> 标签：html, css, scrollbar, overflow

我正在写一个页面，由一个固定大小的内容组成。这就是为什么有一个滚动条（正常行为）。在滚动条之后，我想创建一个元素，这将允许更改其宽度（使可调整大小）。不幸的是，这个元素（“调整大小”）没有显示。为什么要隐藏？这是示例的链接 - [http://jsfiddle.net/ZYBHN/](http://jsfiddle.net/ZYBHN/)。

```
<html>
<head>
  <style type="text/css">
   #wrapper {
    float: left;
    height: 200px;
    position:relative;
    overflow: hidden;
    padding-bottom: 1px;
    padding-right: 1px;
    width: 500px;
    z-index: 200;
   }
   #resizer 
   {
    border:1px solid red;
    cursor: e-resize;
    height: 100%;
    position: absolute;
    right: -10px;
    top: 0;
    width: 10px;
    z-index: 1000;
   } 
   #content
   {
     width:100%; 
     height:100%;
     overflow:auto;
     position:relative;
   }
  </style>
</head>
<body>
<div id="wrapper" > 
<div id="content"> 
.....Lots of text here....
</div>
<div id="resizer"></div>
</div>  
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:18:39.007

你有你的`#resizer`元素在里面`#wrapper`，里面有`overflow: hidden`和`position: relative`。您已经将`#resizer`绝对定位，相对于右侧的`#wrapper`-10 像素（即，它的右侧位于包装器元素之外）。`overflow: hidden`of`#wrapper`是防止它显示在其边界之外。

# php - Magento 展示制造商的最新产品

> ID：15365737
> 
> 赞同：0
> 
> 时间：2013-03-12T15:47:06.697
> 
> 标签：php, magento, magento-1.7

我正在尝试从特定制造商那里获得最新的 3 种产品。我尝试这样做的地方是产品页面，因此我必须找到该产品与哪个制造商相关联并显示最新产品。

这是我到目前为止得到的代码，它可以工作，但显示随机产品取决于我输入的数字`->addAttributeToFilter()`。

真的`->addAttributeToFilter()`是能过滤的厂家吗？如果不是，还应该使用什么来使其工作？

```
<?php $_productCollection = Mage::getResourceModel('reports/product_collection')
                    ->addAttributeToSelect('*')
                    //->addAttributeToFilter('manufacturer', 23)
                    ->addAttributeToFilter(array(array('attribute'=> 'manufacturer', 18)))
                    ->setVisibility(array(2,3,4))                   
                    ->setOrder('created_at', 'desc')
                    ->setPage(1, 3); ?>

<?php foreach($_productCollection as $_product) : ?>

<li class="arrowksleeper">
  <div class="menugridprodcont">
    <div><a href="<?php echo $_product->getProductUrl(); ?>"><img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(170, 100); ?>" alt="" /></a></div>
    <div id="menugridprodtitle"><a href="<?php echo $_product->getProductUrl(); ?>" title="<?php echo $_product->getName(); ?>"><?php echo $_product->getName(); ?></a></div>
  </div>
</li>

<?php endforeach; ?> 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:52:40.077

addAttributeToFilter 的工作原理是传递属性名称，然后是一个描述您希望如何过滤它的数组（除非您传递的不是数组`'null'`或`'notnull'`）。你可能想要更多这样的东西。

```
addAttributeToFilter('manufacturer', array('eq' => 18)); 
```

完整的工作代码。这假定“18”是制造商的有效属性。实际上，您可以通过检查 Catalog->Attributes->ManageAttributes->Manufacturer->Labels 的表单来获得这些信息。

```
$col = Mage::getModel('catalog/product')->getCollection()
                ->addAttributeToSelect('*')
                ->addAttributeToFilter('manufacturer', array('eq'=> 18))     
                ->setOrder('created_at', 'desc')
                ->setPage(1, 3); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:42:18.347

为什么要使用报告集合？那不会加载制造商属性，请使用主要产品集合...

尝试这个：

```
$collection = Mage::getModel('catalog/product')->getCollection();
$collection->addAttributeToSelect('*');
$collection->addAttributeToSelect('manufacturer');

//$collection->addFieldToFilter(array(
//     array('name' => 'manufacturer', 'eq' => 'ibm'),
//));

$collection->addAttributeToFilter('manufacturer', array('eq' => 99));
$collection->setOrder('created_at', 'desc');
$collection->setCurPage(1)->setPageSize(5); // first 5 products..

foreach($collection as $product) {
    // ..
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T15:30:46.093

非常感谢 Andrew 和 Jared 花费他们的时间来帮助我。不幸的是，他们提供的脚本对我不起作用（这并不意味着他们的脚本对你不起作用）所以我也在下面发布，我是如何管理它的。

为了工作，下面的脚本应该放在`app/design/frontend/default/YOUR-THEME/template/catalog/product/view.phtml`

```
<?php 
$manuId = $_product->getManufacturer(); // getting manufacturer's id

$_productCollection = Mage::getResourceModel('reports/product_collection')
                    ->addAttributeToSelect('*')
                    ->addAttributeToFilter('manufacturer', array('eq'=> $manuId)) // $manuId: printing manufacturer's id
                    ->setVisibility(array(2,3,4))
                    ->setOrder('created_at', 'desc')
                    ->setPage(1, 3); ?>

<?php foreach($_productCollection as $_product) : ?>

  <div>
    <div><a href="<?php echo $_product->getProductUrl(); ?>"><img src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(170, 100); ?>" alt="" /></a></div>
    <div><a href="<?php echo $_product->getProductUrl(); ?>" title="<?php echo $_product->getName(); ?>"><?php echo $_product->getName(); ?></a></div>
  </div>

<?php endforeach; ?> 
```

# objective-c - 在 UIAElementArray 中搜索文本/元素

> ID：15365741
> 
> 赞同：0
> 
> 时间：2013-03-12T15:47:15.063
> 
> 标签：objective-c, arrays, ios6, ios-ui-automation

我正在处理 UIAElementArray 以实现 ios 自动化，并寻找一种更简单的方法在 UIAElementArray 中进行搜索。

下面是代码：

```
var textArray = this.myCollectionViews.staticTexts();

textArray.toArray() // Trying to convert UIAElementArray to a javascript array.

logger.logDebug('Array object is' + textArray); // Here the output is [object UIAElementArray]; which I guess should be Array and not UIAElementArray.

if (textArray.indexOf('Hello') > -1) 
{
       // do this
} 
```

在这里，我遇到了 textArray.indexOf 崩溃：

```
TypeError: '[object UIAElementNil]' is not a function (evaluating 'textArray.indexOf('Hello')') 
```

有没有人尝试使用 toArray() 方法将 UIAElementArray 转换为 javascript 数组？或者有什么想法可以更轻松地在 UIAElementArray 中进行搜索？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:44:36.603

您可以使用谓词进行搜索。我不太确定您要完成什么，但是如果存在文本标签，您似乎想要做某事。我会这样实现它：

```
if (textArray.withPredicate('name contains "Hello"').length > 0)
{
    // do this
} 
```

您可以构建适用于 a 的任何属性的谓词，在这种情况下`UIAElement`我们正在这样做`name()`。

这是[Apple](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html)关于谓词字符串格式基础的文档。

# php - 从 PHP 到 Javascript 到 PHP (xmlHTTPRequest) 的会话 ID 和令牌

> ID：15365746
> 
> 赞同：0
> 
> 时间：2013-03-12T15:47:23.147
> 
> 标签：php, javascript, sessionid

我目前正在开发一个使用 Javascript 通过 xmlhttprequest 发送文件的上传系统，效果很好。现在我想将文件信息与上传者的信息一起存储在数据库中。用户必须登录才能上传文件。因此，我将所有登录的成员存储在自己的表中（id、user_id、session_id、token）。

现在我的问题是我必须以某种方式确定上传者信息的用户名。我目前的解决方案是这样的：

```
var fd = new FormData();
 fd.append("file", document.getElementById('file').files[0]);
 fd.append("user", {{username}});
 var xhr = new XMLHttpRequest();
 xhr.open("POST", "/upload/local/handleUpload.php");
 xhr.send(fd); 
```

我正在使用 twig 模板系统来渲染模板文件（{{username}} 是 php 脚本发送的用户名）

现在我知道用户名可以很容易地更改为其他名称。这就是为什么我要确保在“logged_in”表中有一个具有此用户名和可能此 session_id 的用户。

我的第一种方法是仅附加用户的当前 session_id 并发送它。

```
fd.append("session_id", {{session_id}}); 
```

但这是我的问题：这是一种“安全”的方式吗？或者我应该如何处理这个？我感谢我能得到的每一个帮助！

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:00:19.367

没有必要发送会话 id，因为会话 cookie 无论如何都会被发送。为了确保用户存在，`handleUpload.php`必须根据您的数据库表检查会话。

# mongodb - 如何在我的流星应用程序数据库中使用 mongoimport？

> ID：15365747
> 
> 赞同：18
> 
> 时间：2013-03-12T15:47:24.107
> 
> 标签：mongodb, meteor

我可以用来`mongoimport`将 csv 数据导入非流星 mongodb 数据库，但我不知道如何将 csv 导入我的流星应用程序数据库。

我学会了如何为我的流星应用程序（`meteor mongo`）运行 mongo shell，但我无法`mongoimport`从 shell 运行。

mongodb 文档`mongoimport`说

> 在此示例中，mongoimport 将 /opt/backups/contacts.csv 中的 csv 格式数据导入到运行在 localhost 端口号 27017 上的 MongoDB 实例上的用户数据库中的联系人集合中。
> 
> mongoimport --db users --collection contacts --type csv --file /opt/backups/contacts.csv

但是当我运行时`mongod`，启动我的流星应用程序，并运行`mongoimport`它导入我的`test`数据库，而不是我的应用程序数据库。

我读了这个stackoverflow帖子评论：

> 使用 mongoexport 单独转储您的集合，然后使用 mongoimport 将文件导入到流星 mongodb 实例中名为 meteor 的数据库中。流星 mongo 实例运行在端口 3002 上，bind_address 为 127.0.0.1，数据文件位于流星项目子目录 .meteor/local/db

但我不明白如何连接到该实例或如何使用`mongoimport`命令定位它。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-12T15:52:08.963

看起来我刚刚在[Rahuls 的精彩回答](https://stackoverflow.com/questions/15363710/where-is-the-metoer-monogodb-database)中回答了您的评论。无论如何，从 mongodb.org 为您的操作系统（或像 macports 之类的包管理器）下载 mongodb，并使用 bin 文件夹中提供的工具。`mongoimport`不是 mongo shell 中的命令，它是一个单独运行的可执行文件。

也不要忘记将端口放入（通常*3001*如果你在*3000*运行你的流星实例），当你运行它时，数据库通常是*流星*而不是*用户*

```
mongoimport -h localhost:3001 --db meteor --collection contacts --type csv --file /opt/backups/contacts.csv 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-02T17:34:12.280

注意：上述方法对我来说不适用于端口 3002，但它确实适用于端口 3001。

要将外部 TSV 文件导入流星数据库，我启动了需要 TSV 数据的流星应用程序。这也启动了流星 mongodb 服务（在我的情况下是在主机上：localhost:3001），然后我在 OSX 中打开一个终端并通过终端导航到我之前下载的 mongodb 包 bin 文件夹，以获取二进制文件， “蒙戈进口”。进入 mongodb 包的 bin 文件夹后，在命令提示符下，我键入以下内容（一些开关选项会有所不同...但 --host、--localhost 和 --db 开关/值应如下所示）：

```
$  ./mongoimport --host localhost:3001 --db meteor --collection datarefs --type tsv --drop --headerline --file /PathToFile/DataRefs.tsv 
```

按回车后，mongoimport 在终端中回显成功导入。完成此操作后，我可以通过终端导航到流星应用程序并启动流星 mongo：$meteor mongo....并在流星数据库中查看此应用程序的导入集合“datarefs”。

```
$  meteor mongo
...
...
meteor:PRIMARY> show collections
datarefs
system.indexes
meteor:PRIMARY> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-15T16:17:06.900

首先像这样在流星应用程序中创建集合

```
Students = new Meteor.Collection("students"); 
```

然后添加一些虚拟值以确保流星初始化集合

`Students.insert({"name":"first"});` 例如，在某些点击事件中。要检查使用这个

`meteor:PRIMARY> show collections students system.indexes`

然后导入。 `mongoimport -h localhost:3001 -d meteor -c students < students.json` 不知何故，流星无法识别您需要的新导入集合，要么将它们全部删除，然后添加一些虚拟值然后再次导入，要么创建新的并用虚拟值初始化它然后导入。可能存在绑定错误，因为集合显示在 minimongo 中。

感谢 Akshat 和 Tom Kyler

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-29T19:02:40.483

一个用于运行 mongoimport 到 xxx.meteor.com 的小脚本（模板）

```
    #!/bin/sh

    # 将 csvfile 导入部署到免费流星.com 托管的流星应用程序的脚本。
    # 确保您的 mongo 版本与 metor.com 的 mongo 版本匹配。
    # 作为 2016 年 1 月，它似乎是 3.x 的东西。使用 mongoimport 3.12 测试。

    如果 [ $# -eq 0 ]
      然后
        echo "用法：$0 xxx.meteor.com 集合文件名.csv"
        1号出口
    菲

    网址=$1
    收藏=$2
    文件=$3

    echo 正在连接 $URL，请稍候.... collection=$COLLECTION file=$FILE

    PUPMS=`meteor mongo --url $URL | sed 's/mongodb:\/\// -u /' | sed 's/:/ -p /' | sed 's/@/ -h /' | sed 's/\// -d /'`

    mongoimport -v $PUPMS --type csv --headerline --collection $COLLECTION --file $FILE

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-01T09:10:17.007

现在我使用[mongochef](http://3t.io/mongochef/)在数据库之间移动数据。这非常简单——您只需连接到每个数据库（通常是本地和远程数据库），然后您就可以跨集合复制和粘贴文档。比命令行方法容易得多。

# html - 视口标签在 Chrome 上不起作用

> ID：15365750
> 
> 赞同：7
> 
> 时间：2013-03-12T15:47:29.693
> 
> 标签：html, responsive-design, viewport

我正在使用 Chrome 中的设备指标覆盖来测试响应式网站的较小分辨率（在本例中为 320x480）。

在这种情况下，我的视口元标记对页面没有任何影响。标志会显得很小，我完全看不懂。或多或少，我会说我看到的一切都是 0.5 级的。

这是我的 HTML 的头部：

```
<!DOCTYPE html>
<html>
<head>
<title>Title of the document</title>
<link rel="stylesheet" href="css/main.css" />
<link rel="stylesheet" href="css/mediaqueries.css" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" / >
<!--[if lte IE 8]>
    <style>
    .wrapper {min-width: 960px; padding: 0 10px;}
    .hovertext {background: #ccc;}
    </style>
<![endif]-->

<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.0.6-development-only.js"></script>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/main.js"></script> 
```

这确实适用于其他人的网站......我不知道我做错了什么......

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-13T20:00:36.043

试试这个代替你的元标记。祝你好运。

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi" /> 
```

# windows - 如何使用 diskpart 从 cygwin 获取非英语窗口的磁盘详细信息

> ID：15365755
> 
> 赞同：0
> 
> 时间：2013-03-12T15:47:43.997
> 
> 标签：windows, bash, shell, awk, cygwin

我有一个场景，其中有多种语言的 Windows 操作系统...我需要使用脚本获取磁盘详细信息，在 cygwin 中使用 diskpart .. 对于英语，我使用以下内容获取磁盘的详细信息

```
while :
do
    echo "rescan" > $wscript
    echo "list disk" >> $wscript
    disks=$($diskpart /s $wscript | tee ${logfile} | awk 'p{print $2}$1~/^---/{p=1}')
    disk=""
    if [ ! -z "$disks" ]; then
        > $wscript
        for disk in $disks
        do
            echo "select disk $disk" >> $wscript
            echo "detail disk" >> $wscript
        done
        disk=$($diskpart /s $wscript | awk '/is now the selected disk/ {disk=$2} /^Target/ {if ($3 == target) print disk}' target=$target)
    fi
done 
```

'target' 是我将脚本作为输入的磁盘编号。但是当我使用非英语的 Windows 操作系统时，文本比较“/现在是选定的磁盘/”确实可以使用，因为它使用的是不同的语言。有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:51:32.307

尝试将环境变量设置`LC_ALL`为`C`标准语言环境。

# php - 从地址栏或以前的程序中获取价值？

> ID：15365760
> 
> 赞同：-3
> 
> 时间：2013-03-12T15:47:53.887
> 
> 标签：php, html, mysql

这是我在地址栏上显示 id 值的地方...

```
<a href="view_topic.php?id=<?php echo $rows['id']; ?>"><?php echo $rows['topic']; ?></a> 
```

而且我通过表单传递这个值......（我没有附上整个表单代码）

```
<form name="form1" method="post" action="add_answer.php">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td width="18%"><strong>Name</strong></td>
<td width="3%">:</td>
<td width="79%"><input name="a_name" type="text" id="a_name" size="45"></td>
</tr>
<tr>
<td valign="top"><strong>Answer</strong></td>
<td valign="top">:</td>
<td><textarea name="a_answer" cols="45" rows="3" id="a_answer"></textarea></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>**<input name="id" type="hidden" value="<?php echo $id; ?>">**</td>
<td><input type="submit" name="Submit" value="Submit"> <input type="reset" name="Submit2" value="Reset"></td> 
```

在此之后，我们尝试从另一个程序中检索隐藏的值......

```
// get value of id that sent from address bar 
$id=$_GET['id'];
$sql="SELECT * FROM $tbl_name WHERE id='$id'"; 
```

哪个不起作用..即不显示选定的ID及其在表中的相应值...而是显示整个表

我错过了什么吗？？？请帮忙！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:18:51.397

如果您想要一种访问参数的方法，无论它是 POST 字段还是 URL 参数，请使用`$_REQUEST`：

```
$id = $_REQUEST['id']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:50:48.813

您正在使用 `method="post"`表单然后尝试`$id=$_POST['id'];`

# sql-server-ce - SQL Server 2012 和 SQL Server CE、3.5、sp2 之间的 SQL 合并复制

> ID：15365762
> 
> 赞同：0
> 
> 时间：2013-03-12T15:47:58.263
> 
> 标签：sql-server-ce, sql-server-2012, merge-replication

`SQLCESALOG.txt`尝试在 SQL Server CE 3.5 sp2 上创建订阅时收到“OpenDB failed getting pub version 28627” 。

`server1`正在运行 Win 2008、IIS 7.0、SQL Server CE 3.5 sp2、复制工具、客户端工具。此服务器还托管快照共享。合并客户端诊断页面 ( [http://server1.localhost/websync/sqlcesa35.dll?diag](http://server1.localhost/websync/sqlcesa35.dll?diag) ) 除“9.0 Database Reconciler”外全部检出，我认为这不是必需的，因为我没有使用 SQL Server 2005（请更正如果错了）。Web 同步向导 ( `connwiz.exe`)`/websync`使用集成身份验证设置 vdir - 禁用所有其他类型。

`server2`正在运行 Windows 7、SQL Server 2012。

我使用 TCP/IP 作为客户端和服务器协议。我已经尝试使用 SA 帐户以及用户帐户（我将其用作每个服务器上的服务帐户（也是管理员）。似乎没有任何效果。我在 SQL 2012 服务器上没有看到登录尝试. 防火墙已关闭。我运行 netmon 并且可以看到两台机器之间的端口 1433 流量。我已经阅读了 ErikEJ 的博客，但没有任何内容可以帮助我解决这个错误。我找到的唯一一个有解决方案的人解决了这个问题通过创建一个名为管道客户端协议的别名。这对我没有帮助。

我在 websync 目录的日志中看到的错误如上。GUI 实际呈现给我的错误是：

> *无法使用提供的信息连接到 SQL Server。SQL Server 不存在，访问被拒绝，因为 SQL 用户不是 SQL Server 上的有效用户，或者密码不正确。HRESULT 0x800040005 (29060)*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:00:33.817

我最近看到这个错误，它是由错误的SqlCeReplication参数引起的（具体来说，数据库名称（PublisherDatabase）错误。我使用SQL Server Profiler捕获了登录尝试中的参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T19:47:26.753

问题已解决。我有两个问题：

1.  我没有使用 SQL 2012 支持的 SQL CE SP2 版本（累积更新 7）。

2.  我没有安装 SQL 2012 复制组件。我安装了 SQL 2008 R2 复制组件。

Once I fixed all this, replication started working. However, I lost the ability to use SQL Management Studio to manage my CE database. I now have to use the SQL Server Compact Toolbox.

# c# - 使用“ApplicationData”或“LocalApplicationData”来存储所有用户通用的文件？

> ID：15365765
> 
> 赞同：10
> 
> 时间：2013-03-12T15:48:12.810
> 
> 标签：c#, .net, .net-3.5

**摘要：**几个不同的用户将在特定机器上使用我的应用程序。我希望应用程序将其数据存储在这台机器上的单个公共文件中，而不管哪个用户正在运行该应用程序。

为了实现我想要的，我想知道这个问题是否相关：['SpecialFolder.LocalApplicationData'和'SpecialFolder.ApplicationData'之间的区别？](https://stackoverflow.com/q/9709269/1497596)

从那个问题及其答案看来：

```
Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

*特定于*机器。我通过谷歌搜索得到的一些信息证实了这一点。`LocalApplicationData`但是，我还发现了*用户特定*的信息。

那么，哪一个是真的？谁能告诉我“特定于用户”和“特定于机器”的真正含义是什么？

这就是我的想法：如果`LocalApplicationData`是特定于机器的，那么我可以以此为基础，让我的应用程序将其所有数据保存到所有用户的单个公共文件中。

我也想知道`ApplicationData`文件夹：

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

我应该改为使用`ApplicationData`来获得我想要的东西吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-04-21T18:47:16.183

两者`ApplicationData`和`LocalApplicationData`都只能由当前登录的用户访问。这两者之间的区别在于`ApplicationData`复制和同步到用户在企业环境中使用的其他设备。它将用于存储用户的偏好。

正如 Raymond 所建议的（[请参阅文档](https://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)），您将要使用不同的文件夹。`CommonDocuments`在所有用户之间共享文档是一个不错的选择。`CommonMusic`如果您要存储音乐等...

如果您想存储特定于应用程序的文件，请使用：

```
Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData) 
```

# node.js - Socket.io + SSL + 自签名 CA 证书在连接时出错

> ID：15365772
> 
> 赞同：10
> 
> 时间：2013-03-12T15:48:28.027
> 
> 标签：node.js, ssl, socket.io

我正在使用使用自签名 CA 证书创建的证书运行 https 服务器。

现在我想将 Socket.io 客户端连接到附加到 https 服务器的 Socket.io 服务器。不幸的是，我收到一个错误，告诉我：

```
Error: UNABLE_TO_VERIFY_LEAF_SIGNATURE
    at SecurePair.<anonymous> (tls.js:1271:32)
    at SecurePair.EventEmitter.emit (events.js:92:17)
    at SecurePair.maybeInitFinished (tls.js:883:10)
    at CleartextStream.read [as _read] (tls.js:421:15)
    at CleartextStream.Readable.read (_stream_readable.js:293:10)
    at EncryptedStream.write [as _write] (tls.js:330:25)
    at doWrite (_stream_writable.js:211:10)
    at writeOrBuffer (_stream_writable.js:201:5)
    at EncryptedStream.Writable.write (_stream_writable.js:172:11)
    at write (_stream_readable.js:547:24)
    at flow (_stream_readable.js:556:7) 
```

基本上，这个错误告诉我证书无法成功验证。这是因为相应的 CA 证书是自签名的。使用 https 请求时，我可以指定我信任的 CA。

在这种情况下如何使 Socket.io 连接？

PS：我正在运行 Node.js 0.10.0 和 Socket.io 0.9.13。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2017-11-01T20:26:04.210

四年后，但对于任何像我一样发现这篇文章的人，如果您需要强制客户端套接字不拒绝您需要的自签名服务器证书， `rejectUnauthorized: false` 如 `const socket = require('socket.io-client')('https://192.168.0.31', { transports: ['websocket'], rejectUnauthorized: false })` 来自[https://github.com/socketio/engine.io-client#methods](https://github.com/socketio/engine.io-client#methods)

现在还有一个很好的免费证书来源，所以现在你甚至不必成为“便宜的 d*ck” [https://letsencrypt.org/](https://letsencrypt.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-06-16T01:02:29.860

对于 socket.io 1.0（不确定 0.9），这里有如何让节点客户端连接到无效证书的详细信息：[https](https://stackoverflow.com/a/24235426) ://stackoverflow.com/a/24235426 。（感谢@3rdEden 上面的评论。）我发现自签名 SSL 证书可以方便开发服务器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-12T19:06:06.507

[在此处](http://nodejs.org/api/tls.html#tls_tls_ssl)查看如何将自签名证书用于`Certificate Signing Request`. 您必须指定以下内容以允许使用自签名证书进行连接：

1.  key：包含客户端私钥的字符串或缓冲区，采用 PEM 格式。
2.  cert：一个字符串或缓冲区，包含 PEM 格式的客户端证书密钥。
3.  ca：受信任证书的字符串或缓冲区数组。如果省略，将使用几个众所周知的“根”CA，例如 VeriSign。这些用于授权连接。

要使用 CSR 创建自签名证书，请执行以下操作：

```
openssl x509 -req -in ryans-csr.pem -signkey ryans-key.pem -out ryans-cert.pem 
```

在客户端，套接字应该用作

```
var socket = io.connect('https://localhost', {secure: true}); 
```

* * *

## 回答 #4

> 赞同：-15
> 
> 时间：2013-03-13T14:28:10.340

> 不要使用自签名证书。只是不要，某些浏览器在使用 WebSockets 时无法让您接受它们。而且你看起来像一个没有购买合适证书的廉价d * ck。

从[他们看到我花粉，他们讨厌（第 23 页）](https://speakerdeck.com/3rdeden/they-see-me-pollin-they-hatin)。Socket.IO 的核心团队成员 Arnout Kazemier (3rdEden) 的演讲。

# css - CSS / HTML5 来对齐这个复选框和文本？

> ID：15365776
> 
> 赞同：0
> 
> 时间：2013-03-12T15:48:38.263
> 
> 标签：css

我很难让它看起来像这样（下面的截图）

![例子](../Images/3a0f5ac93b50e1494abde59830dbbbb1.png)

我对 CSS 很陌生。我可以将 .item 放在自定义 CSS 文件中的任何位置吗？

这是它现在看起来的 HTML 代码

```
<div class="item">Add a photo:<br>
  <%= f.file_field :image %>
  <br>
   <label for="a">Rename photo?</label>
  <input type="checkbox" id="a"></div><br> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:52:46.690

尝试将 a 添加`float: right`到您想要在右侧的元素，如下所示：

HTML：

```
<div class="item">Add a photo:<br>
  <%= f.file_field :image %>

   <label class="to_right" for="a">Rename photo?</label>
  <input class="to_right" type="checkbox" id="a"></div><br> 
```

CSS：

```
.to_right
{
    float: right;
} 
```

如这里所示：http: [//jsfiddle.net/7P7R5/](http://jsfiddle.net/7P7R5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:53:15.770

创建单独的 div html：

```
<div class="ItemContainer">
    <div class="ItemInput">Add a photo:<br>
        <%= f.file_field :image %>
    </div><div class="ItemCheckbox">
        <label for="a">Rename photo?</label>
        <input type="checkbox" id="a">
    </div>
</div> 
```

并使用`display:inline-block;`：

```
.ItemInput,.ItemCheckbox {
    display:inline-block;
    vertical-align:top;
}

.ItemCheckbox {
    margin-left:10px; /* Or whatever you want */
} 
```

这将使 div 彼此内联，同时保持您可以操作的块属性。这比浮动更有效，因为不需要用幻影div清除它们，而且它是一种所见即所得的显示类型。

此处提供了一个示例[jsFiddle](http://jsfiddle.net/jv5tS/4/)。

只是为了`vertical-align`让它出现在顶部，您可以将其设置为您想要的任何内容。我还设置了这样的类和容器，以防万一您需要此输入的多个实例。如果你只有一个，你可以给他们同样的类而没有容器。

**编辑：**包括在内`margin-left`以`.ItemCheckbox`提供一点分离。

# c# - 多线程序列化和同步

> ID：15365779
> 
> 赞同：0
> 
> 时间：2013-03-12T15:48:53.537
> 
> 标签：c#, multithreading

我有以下情况：

一个单例类，我们称它为 Coordinator，它有多个线程正在加入。该类的作用是以线程安全的方式“初始化”某个实体（EntityObject）。假设我们有 5 个线程试图初始化一个 EntityObject。应该只允许一个线程来初始化 EntityObject，而其他 4 个线程应该等到初始化完成。EntityObject 的名称是唯一的。

下面是一些代码来说明这一点：

```
public class EntityObject
{
    public EntityObject()
    {
        IsInitialized = false;
        Name = string.Empty;
    }

    public bool IsInitialized { get; set; }

    public string Name { get; set; }
}

public class InitializeArguments
{
    public EntityObject Entity { get; set; }
}

 public class Coordinator
{
    public void initialize(InitializeArguments args)
    {
        if (!args.Entity.IsInitialized)
        {
            //initializeCode goes here
            //only one thread is allowed to initialize an EntityObject with a certain Name
            //the other threads have to wait until initialization is done
            args.Entity.IsInitialized = true;
        }
    }
}

 class Program
{
    static void Main(string[] args)
    {
        List<Task> allTask = new List<Task>();

        Coordinator coordinator = new Coordinator();

        EntityObject entity1 = new EntityObject() { IsInitialized = false, Name = "entity1" };
        EntityObject entity2 = new EntityObject() { IsInitialized = false, Name = "entity2" };
        EntityObject entity3 = new EntityObject() { IsInitialized = false, Name = "entity3" };

        for (int i = 0; i < 4; i++)
        {
            var task = Task.Factory.StartNew(() =>
             {
                 InitializeArguments initArg = new InitializeArguments() { Entity = entity1 };
                 coordinator.initialize(initArg);
             });
            allTask.Add(task);
        }

        for (int i = 0; i < 4; i++)
        {
            var task = Task.Factory.StartNew(() =>
            {
                InitializeArguments initArg = new InitializeArguments() { Entity = entity2 };
                coordinator.initialize(initArg);
            });
            allTask.Add(task);
        }

        for (int i = 0; i < 4; i++)
        {
            var task = Task.Factory.StartNew(() =>
            {
                InitializeArguments initArg = new InitializeArguments() { Entity = entity3 };
                coordinator.initialize(initArg);
            });
            allTask.Add(task);
        }

        Task.WaitAll(allTask.ToArray());
        Console.ReadLine();
    }
} 
```

在这种情况下，entity1,entity2,entity3 应该只初始化一次。

我正在考虑使用 a `Dictionary<string, ManualResetEventSlim>`来实现这一点，但我无法让它发挥作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:53:22.727

获取一个[锁](http://msdn.microsoft.com/en-us/library/c5kehkcz.aspx)，只允许一个线程进入临界区：

```
public class Coordinator
{
    private static object lockObj = new Object();

    public void initialize(InitializeArguments args)
    {
        lock(lockObj)
        {
            if (!args.Entity.IsInitialized)
            {
            ...
            }
        }
    }
} 
```

考虑您的评论：您*可以*锁定实体本身，但这被认为是不好的做法（请参阅上面的链接并[记住这篇文章](https://stackoverflow.com/questions/6567567/c-sharp-lock-lock-instance-member-vs-lock-static-member)）：

> 通常，避免锁定公共类型或超出代码控制范围的实例。常见的构造 lock (this)、lock (typeof (MyType)) 和 lock ("myLock") 违反了本指南

所以也许你没问题

```
lock(args.Entity) 
```

而不是`lock(lockObj)`......但是不要锁定实体的名称——也许它在您的控制范围内是唯一的，但谁保证它在整个过程中是唯一的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:57:53.037

如何使用工厂并像这样实现双重锁定模式：

```
public class EntityFactory
{

    private static Dictionary<string, EntityObject> _entityObjects = new Dictionary<string, EntityObject>();
    private static readonly ReaderWriterLockSlim Lock = new ReaderWriterLockSlim();

    public EntityObject CreateEntity(string name)
    {
        EntityObject result = null;

        try
        {

            if (!_entityObjects.TryGetValue(name, out result))
            {
                Lock.EnterWriteLock();
                try
                {
                    if (!_entityObjects.TryGetValue(name, out result))
                    {
                        // initialisation code here
                        result = new EntityObject() {Name = name};
                        _entityObjects[name] = result;
                    }
                }
                finally
                {
                    Lock.ExitWriteLock();
                }
            }
        }
        finally
        {
            Lock.ExitUpgradeableReadLock();
        }

        return result;

    }
} 
```

工厂应该是单例的。它有一个实体对象的静态字典（按名称键）。它检查实体对象是否存在，如果存在则返回，否则获取写锁，然后再次检查字典。因为在维护写锁的同时，另一个线程可能已经创建了一个。如果字典中仍然没有它会创建一个，请将我在其中添加注释的代码替换为您的 EntityObject 初始化代码。然后它将实体对象存储在字典中并返回它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:20:52.173

修改@KevinHolditch 的代码以缓存对象创建过程与实际对象。摆脱了，`Lock.ExitUpgradeableReadLock();`因为它因为没有读锁而产生错误。除非明确要求引用相等，否则假设`EntityObject`实现应该没有问题。[`IEquatable`](http://msdn.microsoft.com/en-us/library/ms131187.aspx)

```
public class EntityFactory
{
    private static Dictionary<string, Func<EntityObject>> _entityObjects = new Dictionary<string, Func<EntityObject>>();
    private static readonly ReaderWriterLockSlim Lock = new ReaderWriterLockSlim();

    public EntityObject CreateEntity(string name)
    {
        Func<EntityObject> result = () => null;

        if (!_entityObjects.TryGetValue(name, out result))
        {
            Lock.EnterWriteLock();
            try
            {
                if (!_entityObjects.TryGetValue(name, out result))
                {
                    result = () =>
                        {
                            // initialisation code here
                            var entity = new EntityObject { Name = name };
                            return entity;
                        };
                    _entityObjects[name] = result;
                }
            }
            finally
            {
                Lock.ExitWriteLock();
            }
        }

        return result();
    }
} 
```

# python - 如何在 Django 中实现每个请求的内存“缓存”值

> ID：15365780
> 
> 赞同：1
> 
> 时间：2013-03-12T15:48:55.393
> 
> 标签：python, django

我想从数据库中存储一个值，该值在请求/响应周期内不会改变，但会被使用数百次（可能是数千次）。

例如：

```
#somefile.py

def get_current_foo(request): # this gets called a lot and is currently a bottleneck
  foo = get_foo_from_db(request.blah)
  return foo 
```

目前我使用 memcached 来存储值，但是这个东西被调用得足够多，即使使用 memcached 来存储值也是一个瓶颈（我正在分析它）。有没有办法“缓存”当前请求/响应周期的内存值？

（跟进[是python“全局”（模块）变量是线程本地的吗？](https://stackoverflow.com/questions/15365519/are-python-global-module-variables-thread-local)）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:53:25.893

如果是按请求数据，则将其存储在请求对象本身上。:-)

请参阅[Django 中的每个请求缓存？](https://stackoverflow.com/questions/3151469/per-request-cache-in-django)一些技术可以做到这一点。

# jquery - 使用 jQuery Each 从数组创建多个列表

> ID：15365781
> 
> 赞同：1
> 
> 时间：2013-03-12T15:48:56.417
> 
> 标签：jquery, arrays, append, each

我有一个元素数组，举个简单的例子，让我们只使用一些数字：

```
var items = new Array('1','2','3','4','5','6','7','8','9','10'); 
```

从这个数组中，我想创建 4 个无序列表，所以每个列表中有 3 个项目，如下所示：

```
<ul>
    <li>0</li>
    <li>1</li>
    <li>2</li>
</ul>
<ul>
    <li>3</li>
    <li>4</li>
    <li>5</li>
</ul>
... 
```

这是我到目前为止所得到的，但我被困在这里，我不知道如何继续：

```
var ul = $('<ul>',{'class':'test'});
$.each(items,function(index,value){
    if(index%3) {
        //...
    }
    var li = $('<li>').append(value);
    ul.append(li);
}); 
```

演示：http: [//jsfiddle.net/AzmZq/](http://jsfiddle.net/AzmZq/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:00:42.657

`$.each`被过度使用。我只会使用`for`嵌套在循环中的基本循环`while`，`Array.shift()`用于一次删除一个数组项：

```
while (items.length) {
    var ul = $('<ul>', { 'class': 'test' });
    for (var i = 0; i < 3; i++) {
        if (items.length) { // so we don't append empty list items at the end
            var li = $('<li>').append(items.shift());
            ul.append(li);
        };
    };
    $('body').append(ul);
}; 
```

[http://jsfiddle.net/mblase75/UwDdv/](http://jsfiddle.net/mblase75/UwDdv/)

* * *

`ul`但是，如果您坚持使用 jQuery 方法，则需要每次都附加并重新初始化`index%3==0`：

```
var items = new Array('1', '2', '3', '4', '5', '6', '7', '8', '9', '10');
var ul;
$.each(items, function (index, value) {
    if (index % 3 == 0)  {
        $('body').append(ul);
        ul = $('<ul>', {'class': 'test'});
    }
    var li = $('<li>').append(value);
    ul.append(li);
});
$('body').append(ul); 
```

[http://jsfiddle.net/mblase75/zUyRM/](http://jsfiddle.net/mblase75/zUyRM/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-17T12:42:25.877

使用`$.map`：

```
var $ul = $("<ul>").append($.map(items, function(s) { return $("<li>").text(s) }); 
```

[ES6](https://github.com/lukehoban/es6features)出现在所有浏览器的那一天，每个人都会更开心（现在，我们可以使用[Babel](https://babeljs.io/)）：

```
let $ul = $("<ul>").append(items.map(item => $("<li>").text(item))); 
```

# jquery - jQuery UI 选项卡加载锚”，以 href 形式给出

> ID：15365782
> 
> 赞同：1
> 
> 时间：2013-03-12T15:48:57.063
> 
> 标签：jquery, jquery-ui, tabs

我有一个奇怪的行为，我的标签会重新加载页面 #anchor-name，它是作为 href 给出的。不知道为什么，因为我还没有设置通过 ajax 获取内容。所有内容都在带有正常标记的页面上，但 thbs 对 domain/#ui-tabs-1 中的内容进行了分级

如果我在没有 # 的情况下设置了 href，我会在控制台中的 get 请求中看到 404 错误。

jQuery 和 jQuery UI 都是实际版本。

有没有人意识到这种行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-24T13:42:45.280

在标题中设置基本标签似乎是一个问题。

```
<base href="..."> 
```

根据我发现的一些非常古老的 JQuery 选项卡文档，如果您将选项卡链接的 url 设置为普通 URL 而不是锚点，它将通过 AJAX 加载选项卡内容，就像这里发生的那样（即使我们实际上有锚点）。

现在，如果您设置基本路径，浏览器可能会认为您必须进行真正的加载，因为锚链接与新的 bas 路径冲突......不确定浏览器为什么会这样认为。

但是，如果您删除基本标签，一切都会按预期工作。

FF中的错误？

见这里：http: [//forum.jquery.com/topic/problem-with-jquery-ui-tabs-and-base-tag](http://forum.jquery.com/topic/problem-with-jquery-ui-tabs-and-base-tag)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-26T12:19:33.273

要使其与基本标记一起使用，请将其放入您的 javascript 中：

```
$.fn.__tabs = $.fn.tabs;
$.fn.tabs = function (a, b, c, d, e, f) {
    var base = location.href.replace(/#.*$/, '');
    $('ul>li>a[href^="#"]', this).each(function () {
        var href = $(this).attr('href');
        $(this).attr('href', base + href);
    });
    $(this).__tabs(a, b, c, d, e, f);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T07:56:59.607

```
<div id="c2" class="csc-default">
<div id="tabs" class="ui-tabs ui-widget ui-widget-content ui-corner-all">
    <ul id="tab-menu" class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all" role="tablist">

            <li class="ui-state-default ui-corner-top ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="ui-tabs-1" aria-labelledby="ui-id-1" aria-selected="true">
                <a href="ui-tabs-1" class="ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-1">Übersicht<span class="squares"></span></a>
            </li>

            <li class="ui-state-default ui-corner-top" role="tab" tabindex="-1" aria-controls="ui-tabs-2" aria-labelledby="ui-id-2" aria-selected="false">
                <a href="ui-tabs-2" class="ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-2">Features<span class="squares"></span></a>
            </li>

            <li class="ui-state-default ui-corner-top" role="tab" tabindex="-1" aria-controls="ui-tabs-3" aria-labelledby="ui-id-3" aria-selected="false">
                <a href="ui-tabs-3" class="ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Service<span class="squares"></span></a>
            </li>

    </ul>

        <div id="ui-tabs-1" aria-live="polite" aria-labelledby="ui-id-1" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" style="" aria-expanded="true" aria-hidden="false">
            <section>
                ...
            </section>
        </div>

        <div id="ui-tabs-2" aria-live="polite" aria-labelledby="ui-id-2" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" style="" aria-expanded="true" aria-hidden="false">
            <section>
                ...
            </section>
        </div>

        <div id="ui-tabs-3" aria-live="polite" aria-labelledby="ui-id-3" class="ui-tabs-panel ui-widget-content ui-corner-bottom" role="tabpanel" style="" aria-expanded="true" aria-hidden="false">
            <section>
                ...
            </section>
        </div>

</div> 
```

这就是JS：

```
 jQuery('#tabs').tabs({
show: { effect: "fade", duration: 200 },
hide: { effect: "fade", duration: 200 },
spinner: false,
create: function( event, ui ) {
  jQuery('H1').addClass('tab-heading');
},
beforeActivate: function( event, ui ) {
  $('.layout-2 .column-right').height('auto');
  $('.layout-2 .column-right article').height('auto');
},
activate: function( event, ui ) {
  var heightLeft = $('.layout-2 .column-left').height();
  var heightRight = $('.layout-2 .column-right').height();
  if (heightRight < heightLeft) {
    $('.layout-2 .column-right').height(heightLeft);
    $('.layout-2 .column-right article').height(heightLeft - 80);
  };
} 
```

});

# php - codeigniter 中的路由不适用于非英文字符

> ID：15365783
> 
> 赞同：1
> 
> 时间：2013-03-12T15:48:58.093
> 
> 标签：php, codeigniter

我正在尝试创建一个包含非英文字符的路线。我正在使用类似的东西：

```
$route[rawurlencode('stringWithNonEnglishCharacters')] = "controller/method"; 
```

在我的本地服务器上这工作得很好，但是当我将它上传到服务器时，由于某种原因它只适用于英文字符。知道我做错了什么或需要配置什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T14:47:28.380

I used ASCII instead.

**Sample**

```
$route['%E0%B8%9A%E0%B8%97%E0%B8%84C'] = 'controller/method'; 
```

You will see the URL in ASCII format when copying URL and paste it into the text editor.

**Or**

```
$route[urlencode('Your languages String')] = "controller/method"; 
```

# python - 迭代函数的 Python 迭代器

> ID：15365790
> 
> 赞同：1
> 
> 时间：2013-03-12T15:49:13.177
> 
> 标签：python, iteration

所以我必须制作以下函数->迭代。在第一次调用时，它应该在第二个 func 和第三个 func.func 上返回标识。知道怎么做吗？我尝试查看**iter**和**下一个**方法 buf 失败：（

```
>>> def double(x):
        return 2 * x

>>> i = iterate(double)
>>> f = next(i)
>>> f(3)
3
>>> f = next(i)
>>> f(3)
6
>>> f = next(i)
>>> f(3)
12
>>> f = next(i)
>>> f(3)
24 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:15:36.567

可能是这样的：

```
>>> import functools
>>> def iterate(fn):
    def repeater(arg, _count=1):
        for i in range(_count):
            arg = fn(arg)
        return arg
    count = 0
    while True:
        yield functools.partial(repeater, _count=count)
        count += 1

>>> i = iterate(double)
>>> f, f2, f3, f4 = next(i), next(i), next(i), next(i)
>>> f(3), f2(3), f3(3), f4(3)
(3, 6, 12, 24)
>>> f(3), f2(3), f3(3), f4(3)
(3, 6, 12, 24) 
```

因此，您编写了一个函数，该函数以指定为参数的次数调用原始函数，并预先绑定了 count 参数。

# jquery - 如何将 Kendo DropDownList 绑定到 Observable 类？

> ID：15365792
> 
> 赞同：1
> 
> 时间：2013-03-12T15:49:13.900
> 
> 标签：jquery, json, data-binding, mvvm, kendo-ui

我在使 DropDownList 与 Observable 类一起工作时遇到问题。

这是可观察类的代码：

```
var viewModel = kendo.observable({
            dsMember: new kendo.data.DataSource({
                type: "json",
                serverFiltering: true,
                serverPaging: true,
                pageSize: 6,
                error: function (e) {
                    top.CustomError(e);
                },
                transport: {
                    read: {
                        contentType: "application/json; charset=utf-8",
                        type: "GET",
                        url: function () {
                            return "../api/Member/" + viewModel.MemberParam;
                        },
                        dataType: "json",
                        cache: false,
                        complete: function (e) {
                            viewModel.set("SelectedMember", viewModel.dsMember.view()[0]);
                        }
                    },
                    update: {
                        contentType: "application/json; charset=utf-8",
                        type: "POST",
                        url: "../api/Member",
                        dataType: "json",
                        cache: false,
                        complete: function (e, textStatus) { top.CustomSuccess(e, textStatus); }
                    },
                    destroy: {
                        contentType: "application/json; charset=utf-8",
                        url: "../api/Member",
                        type: "DELETE",
                        dataType: "json",
                        cache: false,
                        complete: function (e) {
                            viewModel.NewRecord();
                        }
                    },
                    create: {
                        contentType: "application/json; charset=utf-8",
                        type: "PUT",
                        url: "../api/Member",
                        cache: false,
                        complete: function (e, textStatus) {
                            if (typeof (e.responseText) != "undefined") {
                                var response = $.parseJSON(e.responseText);
                                var obj = viewModel.dsMember.view()[viewModel.dsMember.view().length - 1];
                                obj.MemberId = response.MemberId;
                                viewModel.set("SelectedMember", obj);
                                document.getElementById("tbMemberId").value = obj.MemberId;

                                top.CustomSuccess(e, textStatus);
                            }
                        }
                    },
                    parameterMap: function (data, operation) {
                        return kendo.stringify(data);
                    }
                },
                batch: true,
                schema: {
                    model: {
                        id: "MemberId",
                        fields: {
                            MemberId: {
                                type: "number",
                                editable: false // this field is not editable
                            },
                            MemberName: {
                                type: "text",
                                validation: { // validation rules
                                    required: true // the field is required
                                }
                            },
                            id_function_club: {
                                type:"number"
                            },
                            name_function_club: {
                                type: "text"
                            }
                        }
                    }
                }
            }),
            MemberParam: 0,
            SelectedMember: null,
            save: function () {
                this.dsMember.sync();
            },

            remove: function () {
                if (confirm("Are you sure you want to delete this record?")) {
                    this.dsMember.remove(this.SelectedMember);
                    this.set("SelectedMember", this.dsMember.view()[0]);
                    this.save();
                }
            },
            NewRecord: function () {
                var newRecord = new viewModel.dsMember.reader.model();
                newRecord.MemberId = null;
                viewModel.dsMember.add(newRecord);
                viewModel.set("SelectedMember", viewModel.dsMember.view()[viewModel.dsMember.view().length - 1]);
            }
        }); 
```

* * *

这是我的工作 DropDownList：

```
$("#ddFunctionClub").kendoDropDownList({
            height: 150,
            dataTextField: "name",
            dataValueField: "id_function_club",
            dataSource: {
                type: "json",
                transport: {
                    read: {
                        contentType: "application/json; charset=utf-8",
                        type: "GET",
                        url: function () {
                            return "../api/Function_Club";
                        },
                        dataType: "json",
                        cache: false
                    }
                }
            }
        }); 
```

* * *

这是我的 DropDownList 的 html：

```
<input id="ddFunctionClub" style="width: 100%;" /> 
```

* * *

最后，这就是我从可观察数据源请求中得到的结果：

```
{"MemberId":123,"MemberName":"Person","BirthDate":"10/01/1980","id_function_club":2,"name_function_club":"My Function","NameUnit":"My Unit"} 
```

* * *

我做了一些研究，但找不到任何合适的例子。

我查看了： [MVVM Widget Binding](http://demos.kendoui.com/web/mvvm/widgets.html)并玩弄了 data-bind、data-value-field、data-text-field 但无法得到我想要的结果。

因此，**我正在寻找的是**一种将常规 DropDownList（与数据源绑定的）绑定到 Observable 类的方法。例如，文本将绑定到 SelectedMember.name_function_club，值绑定到 SelectedMember.id_function_club。

你能帮我吗？

如果有什么不太清楚，请发表评论以获取更多信息。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:58:13.873

如果我正确理解了您的情况，您实际上并不需要两个`DataSources`. 一个就足够了，因为它们实际上是`Observable`并且任何更新都将传播到`DropDownList`.

让我们定义`kendoDropDownList`如下：

```
$("#ddFunctionClub").kendoDropDownList({
    height        : 150,
    dataTextField : "name_function_club",
    dataValueField: "id_function_club",
    dataSource    : dataSource
}); 
```

最低限度`DataSource`是：

```
var dataSource = new kendo.data.DataSource({
    type     : "json",
    transport: {
        read: "xyz"
    }
}); 
```

*注意：*我说的是*最低限度* `transport`，因为它可以根据您的需要复杂（就像包含许多操作的原始版本一样。

从服务器接收的数据（据我从 OP 了解到的）将是一组对象，就像您包含的对象一样。

```
var data = [
    {"MemberId": 123, "MemberName": "Person", "BirthDate": "10/01/1980", "id_function_club": 1, "name_function_club": "My Function 1", "NameUnit": "My Unit"},
    {"MemberId": 123, "MemberName": "Person", "BirthDate": "10/01/1980", "id_function_club": 2, "name_function_club": "My Function 2", "NameUnit": "My Unit"},
    {"MemberId": 123, "MemberName": "Person", "BirthDate": "10/01/1980", "id_function_club": 3, "name_function_club": "My Function 3", "NameUnit": "My Unit"},
    {"MemberId": 123, "MemberName": "Person", "BirthDate": "10/01/1980", "id_function_club": 4, "name_function_club": "My Function 4", "NameUnit": "My Unit"}
]; 
```

只要您更改 DataSource，`DropDownList`就会更改（例如，添加或删除元素或更改其内容）。

请参阅此处的示例：http: [//jsfiddle.net/OnaBai/DtbQY/#base](http://jsfiddle.net/OnaBai/DtbQY/#base)。如果您按下按钮`Change DataSource`，列表会自动更新（插入两个元素并更新第二个元素）。

# ios - AVAudioPlayer not playing sound IOS

> ID：15365796
> 
> 赞同：0
> 
> 时间：2013-03-12T15:49:28.330
> 
> 标签：ios

Good Morning,

I have the following iphone app that converts a string to audio using googleTTS, and am stuck on actually playing the downloaded data. Can someone please help me figure out why I cannot hear anything.

viewcontroller.h

```
#import <UIKit/UIKit.h>
#import <CoreLocation/CoreLocation.h>
#import "RJGoogleTTS.h"

@interface ViewController : UIViewController <CLLocationManagerDelegate>

@property (weak, nonatomic) IBOutlet UILabel *userLabel;
@property (strong, nonatomic) CLLocationManager *locationManager;
@property (strong, nonatomic) CLGeocoder *geoCoder;

@property (strong, nonatomic) RJGoogleTTS *googleTTS;

- (IBAction)geoCodeLocation:(id)sender;

- (IBAction)rjGoogleButton:(id)sender;
@end 
```

viewcontroller.m

```
- (IBAction)rjGoogleButton:(id)sender {

    googleTTS = [[RJGoogleTTS alloc]init];

    [googleTTS convertTextToSpeech:@"How are you today user?"];

} 
```

rjgoogletts.h

```
#import <Foundation/Foundation.h>

@protocol RJGoogleTTSDelegate <NSObject>

@required
- (void)receivedAudio:(NSMutableData *)data;
- (void)sentAudioRequest;

@end

@interface RJGoogleTTS : NSObject {
    id <RJGoogleTTSDelegate> delegate;
    NSMutableData *downloadedData;
}

@property (nonatomic, retain) id <RJGoogleTTSDelegate> delegate;
@property (nonatomic, retain) NSMutableData *downloadedData;

- (void)convertTextToSpeech:(NSString *)searchString;

@end 
```

rjgoogletts.m

```
#import "RJGoogleTTS.h"
#import <AVFoundation/AVFoundation.h>

@implementation RJGoogleTTS
@synthesize delegate, downloadedData;

- (id)init
{
    self = [super init];
    if (self) {
        // Initialization code here.
    }

    return self;
}

- (void)convertTextToSpeech:(NSString *)searchString {

    //NSString *search = [NSString stringWithFormat:@"http://translate.google.com/translate_tts?q=%@", searchString];
    NSString *search = [NSString stringWithFormat:@"http://translate.google.com/translate_tts?tl=en&q=%@", searchString];

    search = [search stringByReplacingOccurrencesOfString:@" " withString:@"%20"];
    NSLog(@"Search: %@", search);
    self.downloadedData = [[NSMutableData alloc] initWithLength:0];
    NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:search]];
    [request setValue:@"Mozilla/5.0" forHTTPHeaderField:@"User-Agent"];
    NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES];
    //[delegate sentAudioRequest];

}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    NSLog(@"did you receive response user");
    [self.downloadedData setLength:0];

}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    NSLog(@"did you receive data user");
    [self.downloadedData appendData:data];

}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    NSLog(@"Failure");
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {

    NSLog(@"it worked user!!!");
    [delegate receivedAudio:self.downloadedData];
    NSLog(@"here are the bytes downloaded, %d", [self.downloadedData length]);

    NSString *txt = [[NSString alloc] initWithData:downloadedData encoding: NSASCIIStringEncoding];
    NSLog(@"%@hello",txt);

    AVAudioPlayer *audioPlayer = [[AVAudioPlayer alloc]initWithData:self.downloadedData error:nil];
    [audioPlayer prepareToPlay];
    [audioPlayer play];

}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T17:47:04.627

Are you using ARC? If so, you will need to retain the audio so it doesn't automatically set to nil, add the following property into the header file of rjgoogletts and voila! **`@property (nonatomic, strong) AVAudioPlayer *audioPlayer;`** Hope this helps. Jim

# .htaccess - .htaccess 双重重定向

> ID：15365798
> 
> 赞同：2
> 
> 时间：2013-03-12T15:49:34.893
> 
> 标签：.htaccess, rewrite, double

我对 url 重写真的很陌生，并且完全不喜欢正则表达式，如果我的问题很愚蠢，很抱歉（因为我不完全理解这个主题）

这是我的重写规则

```
RewriteRule ^trends/conversion/([_a-zA-Z0-9-]*) trends/conversion.php?$1

RewriteRule ^trends/([_a-zA-Z0-9-]*)$ trends/index.php?$1 
```

基本上，我总是以 index.php 页面结束，当然，除非我删除第二条规则。我可以让 mod 重写在它到达conversion.php 后立即停止吗？

提前致谢

法比奥

ps 我忘了说我需要针对两个页面的查询字符串，这就是为什么第二个页面上也有一个正则表达式。不幸的是，我无法更改此 url 结构，这就是我被卡住的原因

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:52:19.980

您必须首先`L`在您的第一条规则中添加一个标志，然后在您的第二条规则中添加一个标志，`RewriteCond`以防止`conversion.php`再次被重写

```
RewriteRule ^trends/conversion/([_a-zA-Z0-9-]*) trends/conversion.php?$1 [L]

RewriteCond %{REQUEST_URI} !conversion\.php
RewriteRule ^trends/([_a-zA-Z0-9-]*)$ trends/index.php?$1 [L] 
```

您应该考虑将查询字符串更改为类似`id=$1`或类似的内容。否则，每个请求都没有相同的`GET`参数，而是任意字符串。

# c - 查找嵌套结构成员变量的地址

> ID：15365801
> 
> 赞同：2
> 
> 时间：2013-03-12T15:49:41.063
> 
> 标签：c

亲爱的stackoverflow爱好者，

首先我是stackoverflow的新手，所以我提前为我犯的任何错误道歉。

这是一个 C 谜题。或者至少我对此感到困惑。代码如下。

```
struct outer_str
{
  struct nest_str1
  {
     int mem1;
  };
  struct nest_str2
  {
     int mem2;
  }nest_var2;
}outer_var;

int main()
{
   outer_var.nest_var2.mem2 = 111;
   printf("\n\nThe value of mem2 is %d\n\n",outer_var.nest_var2.mem2);

   // Statement to assign mem1 of nest_str1 with a value say 333;
   // Statement to print the value of mem1 of nest_str1;

   return 0;
} 
```

正如评论所暗示的，您必须访问嵌套结构**nest_str1的成员变量****mem1**。另请注意，没有为嵌套结构nest_str1 声明结构变量。

 **寄希望于希望我尝试了以下代码，模仿了一点 C++。

```
outer_var.nest_str1.mem1=333; 
```

当我使用 GCC 4.6.3 编译程序时，显示以下错误

```
"struct outer_str has no member named 'nest_str1' ". 
```

**然后我想从嵌套结构nest_str2**的结构变量**nest_var2**的地址中找到nest_str1的地址。我尝试了以下代码，

 **```
int main()
{
 int offset;
 struct nest_str1 * addr; 
 offset=sizeof(int); // There is only one integer mem1 in nest_str1
 addr=(struct nest_str1 *)((int *) & (outer_var.nest_var2) - offset);
 addr->mem1=333;
 printf("\n\nThe value of mem1 is %d\n\n",addr->mem1);
 return 0;
} 
```

程序编译正常，但输出不是我预期的。我遇到了运行时错误。

```
Segmentation fault (core dumped) 
```

现在我什至不知道我的方法是否正确。所以希望大家给点建议。我也担心我可能忽略了一些明显简单的解决方案。

我还想知道我们是否可以在下面给出的代码中访问**mem1**。

```
struct outer_str
{

  struct nest_str1
  {
     int mem1;
  };

}outer_var; 
```

我提前感谢每一个人的时间和耐心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:53:51.983

其中没有任何成员`outer_var`允许您访问`mem1`（您没有声明一个，您只是定义了一个名为.）的*类型。*`nest_str1`

将其更改为：

```
struct outer_str
{

  struct nest_str1
  {
     int mem1;
  } nest_var1;  // now there is a member!

}outer_var; 
```

现在你可以：

```
outer_var.nest_var1.mem1 = 100; 
```

你的尝试是完全错误的，没有存储空间`mem1`，所以即使你的代码有效，你很可能最终会写入`mem2`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-11T02:25:53.880

你写的代码是绝对正确的。但是，在从第二个嵌套结构“outer_var.nest_var2”中减去“偏移”值时，尽管将其类型转换为 (int *)，但只需将其类型转换为 (char* ) 即“addr=(struct nest_str1 *)((char *) & ( outer_var.nest_var2) - (char *)offset);" 您将能够在第一个结构中填充变量。

```
#include<stdio.h>
#include<stdlib.h>

struct outer_str{
        struct nest_str1
  {
     int mem1;
  };
  struct nest_str2
  {
     int mem2;
  }nest_var2;
}outer_var;

int main()
{
    int offset;
    struct nest_str1 * addr;
    offset=sizeof(int); // There is only one integer mem1 in nest_str1
    addr=(struct nest_str1 *)((char *) & (outer_var.nest_var2) - (char          *)offset);
    addr->mem1=333;
    printf("\n\nThe value of mem1 is %d\n\n",addr->mem1);
    return 0;
} 
```****

# c++ - C++ 指向类名的指针数组

> ID：15365805
> 
> 赞同：1
> 
> 时间：2013-03-12T15:49:50.320
> 
> 标签：c++, arrays, pointers, dynamic-memory-allocation

我希望能够保存一个类名数组，并简单地将索引传递给将创建某个类的实例的函数。我有内存限制，所以我不想简单地创建一个对象数组。

这是我最具描述性的伪代码：

课程：

```
class Shape
{
public:
    Shape();
};

class Square : public Shape
{
public:
    Square();
};

class Triangle : public Shape
{
public:
    Triangle();
}; 
```

主要的：

```
int main()
{
    pointerToShapeClass arrayOfShapes[2];       // incorrect syntax - but
    arrayOfShapes[0] = pointerToSquareClass;    // how would i do this?
    arrayOfShapes[1] = pointerToTriangleClass;

    cin << myNumber;

    // Depending on input, create instance of class corresponding to array index
    if (myNumber == 0) { // create Square   instance }
    if (myNumber == 1) { // create Triangle instance }

    return 0;
} 
```

如果这令人困惑，我可以尝试阐明。提前致谢！

编辑：

真的，我认为我只需要一个指向类的指针，而无需实际实例化该类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T16:01:21.660

听起来你想要某种工厂：

```
class Shape
{
public:
    Shape();
    static Shape* create(int id);
};

Shape* Shape::create(int id) {
  switch (id) {
    case 0: return new Square();
    case 1: return new Triangle();
  }
  return NULL;
} 
```

然后，当您想要创建特定的`Shape`给定用户输入时，您可以执行以下操作：

```
int myNumber;
cin >> myNumber;
Shape* shape = Shape::create(myNumber); 
```

这是它最简单的形式。但是，我建议让`create`函数返回 a `std::unique_ptr<Shape>`，而不是原始指针。我还将设置静态常量来表示不同的 ID。

```
class Shape
{
public:
    Shape();
    static std::unique_ptr<Shape> create(int id);

    enum class Id { Square = 0, Triangle = 1 };
};

std::unique_ptr<Shape> Shape::create(Shape::Id id) {
  switch (id) {
    case Shape::Id::Square: return new Square();
    case Shape::Id::Triangle: return new Triangle();
  }
  return nullptr;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:53:10.403

创建一个`std::vector<Shape*>` 然后你可以`v.emplace_back(new Triangle());`在 C++11 中做。在 C++03 中，您可以使用`v.push_back(new Triangle());`

您可以使用原始数组

```
Shape* shapes[10]; // array of pointers;

shapes[0] = new Triangle(); 
```

你也可以去使用模板并创建一个模板

```
template<typename ShapeType>
class Shape
{
 public:
     ShapeType draw(); 
     //All common Shape Operations
};

class Triangle
{
};

//C++11
using Triangle = Shape<Triangle>;
Triangle mytriangle;

//C++03
typedef Shape<Square> Square;
Square mysquare; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T15:53:45.893

试试这个：

```
int main()
{
    std::vector<Shape*> shapes;

    cin << myNumber;

    // Depending on input, create instance of class corresponding to array index
    if (myNumber == 0) { shapes.push_back(new Square(); }
    if (myNumber == 1) { shapes.push_back(new Triangle(); }

    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T16:05:05.640

我会创建这个函数：

```
Shape getNewShape(int shapeId)
{
    switch (shapeId)
    {
        case 1: return new Square();
        case 2: return new Triangle();
    }
    //here you should handle wrong shape id
} 
```

然后像这样使用它：

```
int main()
{
    cin << myNumber;

    // Depending on input, create instance of class corresponding to array index
    shape tempShape = getNewShape(myNumber);

    return 0;
} 
```

# python - 将分层数据存储到 hdf5 - 如何构造它们

> ID：15365807
> 
> 赞同：2
> 
> 时间：2013-03-12T15:49:52.937
> 
> 标签：python, hdf5

我需要将分层数据结构存储到 hdf5 中，其中大多数叶节点是非数组类型（字符串或标量），其中只有少数是同构数组。这些数据看起来类似于：

```
/simulation-20130312_13:33p1435
   +- input
   |  +- gravity = 9.81
   |  +- timeScale = 1.0
   |  +- userTitle = 'real'
   |  +- flowRates = [ 1.1, 2.1 ]
   |  +- material
   |     +- density = 1234.2
   |     +- young = 1.123e6
   |     +- temp = 290.2
   +- finished = '20130312_16:21'
   +- host = 'efflux.local'
   +- series
      +- t = [0,1e-5,2e-5,...,3.4e-4]
      +- Ek = [0,...]
/simulation-20130312_13:55p1657
   ...
   ... 
```

每个模拟下的数据结构相似，但不一定相同，所以我认为使用表格是不可能的。

我是否应该为所有叶子创建组，并始终将值设置为附加到该叶子的数组，如果值为标量，则使用 1x1 数组？我应该对除真实数组之外的所有数据使用组属性吗？这不会让使用这些文件的人感到困惑吗？

我几乎没有使用 hdf5 的经验；数据的数量会比较少，此时对效率没有太多关注——重要的是能够轻松地将数据导入Matlab。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T13:39:11.693

HDF5 代表**Hierarchical Data Format**，它显然是存储像您这样的层次结构的正确工具。

我建议您将叶子存储为数据集：

*   对标量使用标量数据集（字符串、数字，`flowRates`也可以认为是*大小为 2 的数组*类型的标量）

*   对时间序列使用简单的数据集

并为所有其他节点创建组，如下所示：

```
/simulation-20130312_13:33p1435       # root group: /
   +- input                           # group: /input
   |  +- gravity = 9.81               # scalar double
   |  +- timeScale = 1.0              # scalar double
   |  +- userTitle = 'real'           # scalar string
   |  +- flowRates = [ 1.1, 2.1 ]     # scalar array[2]
   |  +- material                     # group: /input/material
   |     +- density = 1234.2          # scalar double
   |     +- young = 1.123e6           # scalar double
   |     +- temp = 290.2              # scalar double
   +- finished = '20130312_16:21'     # scalar string
   +- host = 'efflux.local'           # scalar string
   +- series                          # group: /series
      +- t = [0,1e-5,2e-5,...,3.4e-4] # simple dataset double
      +- Ek = [0,...]                 # simple dataset double 
```

Matlab 中的导入应该是小菜一碟。

# c++ - MSCV 2010 --someNumber 运算符的错误行为

> ID：15365808
> 
> 赞同：0
> 
> 时间：2013-03-12T15:49:53.467
> 
> 标签：c++, operators, visual-studio-2010

在我的代码中，我有一个看起来像这样的 for 循环：

```
for(unsigned int n=10; n > 1; --n)
{
  std::cout << n << std::endl;
} 
```

我期望输出：

> 9、8、7、6、5、4、3、2、1

我得到的输出：

> 10, 9, 8, 7, 6, 5, 4, 3, 2

我在使用 gnu/g++ 时得到了预期的输出，但在 MSVC 2010 中没有。

我知道我通过执行以下操作获得了该循环的预期结果：

```
for(unsigned int n=9; n > 0; n--)
{
  std::cout << n << std::endl;
} 
```

有没有其他人得到这种行为，或者我是否以某种方式意外地抛出了某种魔法开关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:50:42.950

那里没有魔法，递减发生在循环的第一次迭代之后。这就是`for`循环的工作方式。不管是`n--`还是都没有区别`--n`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:55:14.510

一个`for`循环可以（松散地）[1] 使用`while`：

```
for(A; B; C)
{
   content of loop;
} 
```

变成：

```
A;
while(B)
{
  content of loop;
  C;
} 
```

所以，换句话说：

```
unsigned int n=10;
while(n > 1)
{
  std::cout << n << std::endl;
  --n;
} 
```

现在，您可以清楚地看到为什么它正在做它正在做的事情。

[1] 当然，有了上面的“转换”，`n`变化的范围，这并不是要说明编译器如何为`for`循环生成代码——它只是为了解释循环是如何运行的。

# c# - 将 XmlNode 添加到 XmlWriter

> ID：15365809
> 
> 赞同：2
> 
> 时间：2013-03-12T15:49:54.057
> 
> 标签：c#, xml

我已经取出了一些 xml 节点，并且正在使用 XmlWriter 创建相关的 Xml 文件。

XmlNode 需要进入内部，但我不确定如何使用 XmlNode 在内部创建元素。

**Xml 格式如下**

```
<?xml version="1.0" encoding="UTF-8"?>
<tasks>
   <task Id="113" Date="2013-03-12T13:55:09" NodeId="1842" TotalWords="11">

   </task>
</tasks> 
```

**XmlWriter 代码**

```
using (XmlWriter writer = XmlWriter.Create(MapPath(xmlFilePath)))
                {

                    writer.WriteStartDocument();
                    writer.WriteStartElement("Tasks");

                    writer.WriteStartElement("Task");
                    writer.WriteAttributeString("Id", t.Id.ToString());
                    writer.WriteAttributeString("NodeId", t.Node.Id.ToString());

                    // The XmlNode needs to be inside here //

                    writer.WriteEndElement();

                    writer.WriteEndElement();
                    writer.WriteEndDocument();

                } 
```

**我提取的 XmlNode 的详细信息**

```
<Page id="1842" parentID="1840" level="5" writerID="14" creatorID="14" nodeType="1051" template="1839" sortOrder="0" createDate="2013-03-11T14:53:47" updateDate="2013-03-12T14:03:55" nodeName="Ujian sub-halaman" urlName="ujian-sub-halaman" writerName="John John" creatorName="John John" path="-1,1057,1631,1156,1840,1842" isDoc="">
         <pageContent />
         <heroHeaderImage />
         <topModule>-1</topModule>
         <bottomModule>-1</bottomModule>
         <rHTopModule />
         <headerQuickLinks>
            <data />
         </headerQuickLinks>
         <rHBottomModule>-1</rHBottomModule>
         <pageTitle>Ujian sub-halaman</pageTitle>
         <umbracoNaviHide>0</umbracoNaviHide>
         <pageHeader><![CDATA[Test sub-page]]></pageHeader>
         <showAddThis>0</showAddThis>
         <alternativeTitle>Test sub-page</alternativeTitle>
         <smallPrint>0</smallPrint>
         <pageImage />
         <siteName />
         <metaDescription />
         <metaKeywords />
         <metaCopyright />
         <defaultEmail />
         <googleUrchin />
         <facebook />
         <googlePlus />
         <linkedIn />
         <twitter />
         <youtube />
      </Page> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T15:54:13.647

我不确定这是否是您的意思，但假设您有一个 XmlNode - 让我们调用它，`the_node`那么您可以使用 XmlWriter 的[WriteRaw](http://msdn.microsoft.com/en-us/library/0755ytay.aspx)方法将节点的标记嵌入到`writer`.

```
using (XmlWriter writer = XmlWriter.Create(MapPath(xmlFilePath)))
{

   writer.WriteStartDocument();
   writer.WriteStartElement("Tasks");

   writer.WriteStartElement("Task");
   writer.WriteAttributeString("Id", t.Id.ToString());
   writer.WriteAttributeString("NodeId", t.Node.Id.ToString());

  // The XmlNode needs to be inside here //
   writer.WriteRaw(the_node.OuterXml);

   writer.WriteEndElement();

   writer.WriteEndElement();
   writer.WriteEndDocument();

} 
```

# grails - 从 GORM 中的查询中找不到任何内容时的解决方法

> ID：15365814
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:50:10.983
> 
> 标签：grails, grails-orm

我在我的一种方法中做这样的事情：

```
 def colorId = Store.findByName(color).id
    def shadeIds = Shades.findAllByColor(colorId).shadeId
    println "IDS" + shadeIds //sometimes this is empty ([])
    MyShop.getAll(shadeIds).shades 
```

从上面的代码中，每当`shadeIds`为空时，`[]`我在执行此操作时会收到 SQL 错误。`MyShop.getAll(shadeIds).shades`有解决方法吗？

我的临时解决方法是：

```
 def colorId = Store.findByName(color).id
    def shadeIds = Shades.findAllByColor(colorId).shadeId
    println "IDS" + shadeIds //sometimes this is empty ([])
    if (shadeIds.size() == 0)
      shadeIds << -1
    MyShop.getAll(shadeIds).shades 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:54:36.470

解决方法会导致不必要的数据库调用，您已保证不会返回任何内容。改用这个：

```
def shades = shadeIds ? MyShop.getAll(shadeIds).shades : [] 
```

# java - 对（Button）findViewById 的错误感到困惑

> ID：15365816
> 
> 赞同：2
> 
> 时间：2013-03-12T15:50:25.050
> 
> 标签：java, android, xml

我不明白`findViewById(R.id.spinner2)`语法。我搜索了解释，只找到了更高级的主题。

在线性布局中，`activity_main.xml`我添加了一个按钮并将 ID 编辑为

```
@+id/spinner2 
```

并将文本编辑为新字符串。

我假设某处记录了一个 ID，类似于保存字符串的 strings.xml。

但是当我这样做时，在 .java 文件中：

```
spinner2 = (Spinner) findViewById(R.id.spinner2); 
```

“id”显示错误（红色曲线）。

我只想知道我哪里错了？

**java文件**——

```
package com.example.test;

import java.util.ArrayList;
import java.util.List;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.Spinner;
import android.widget.Toast;

public class MainActivity extends Activity {
  Spinner spinner1, spinner2;
  private Button btnSubmit;

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    addItemsOnSpinner2();
    addListenerOnButton();
    addListenerOnSpinnerItemSelection();
  }

  // add items into spinner dynamically
  public void addItemsOnSpinner2() {
    spinner2 = (Spinner) findViewById(R.id.spinner2);
  }
} 
```

**Xml 代码 -**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Spinner
        android:id="@+id/spinner2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:entries="@array/country_arrays"
        android:prompt="@string/country_prompt" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:53:07.407

> “id”显示错误（红色曲线）

先试试这个

清理项目然后重建它。

如果它不能解决您的问题，那么它可能是`layout`或中的错误`AndroidManifest.xml`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:53:51.463

> “id”显示错误（红色曲线）。

所以很可能您在某些 XML 文件中有一些错误，并且您`R.java`的创建不正确。因此，首先检查错误，然后清理并重建您的项目将有助于解决您的问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-12T16:00:59.117

您尚未导入`R.java`文件。你必须使用`import com.example.test.R`.

# asp.net - 在asp.net c#中使用repeater或使用linqdatasource的datalist创建一个单独的列

> ID：15365817
> 
> 赞同：1
> 
> 时间：2013-03-12T15:50:28.287
> 
> 标签：asp.net, html, repeater, linqdatasource

我创建了一个带有 categoryId、CategoryName、parentId 和 CategoryImage 的表 Category 的数据库。

我正在使用 Linqconnect(LinqtoMySql)。

如何使用中继器显示类别和名称，或者我应该以这种方式使用 linq 数据源的数据列表：

![在此处输入图像描述](../Images/f3d6602245a45ade2f44649f80b0e7b1.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:53:12.557

DataList 就是为此目的而设计的。

使用 GridView 或 Repeater 会遇到很大的困难。

使用[重复方向](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.repeatdirection.aspx)属性和[重复列](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.repeatcolumns.aspx)属性。

```
 <asp:DataList id="MyDataList" RepeatDirection="Horizontal" RepeatColumns="4" runat="server"> 
```

当然，您需要设置 DatasourceID 并配置您的数据源。

如果您愿意，可以从代码隐藏中设置数据源。

```
 MyDataList.DataSource = MyDataTable 
```

或者

```
 MyDataList.DataSource = MyLinqQueryResults 
```

**参考**

*   [DataList 重复方向属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.repeatdirection.aspx)
*   [DataList 重复列属性](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datalist.repeatcolumns.aspx)
*   [数据列表 (MSDN)](http://msdn.microsoft.com/en-us/library/7efxhktc.aspx)

# django - 使用 django 将数据保存到数据库

> ID：15365820
> 
> 赞同：4
> 
> 时间：2013-03-12T15:50:34.813
> 
> 标签：django, django-forms, django-templates, django-views

**视图.py**

```
def addbook(request): 
    if request.POST:
        book_form = BookForm(request.POST)
    author_form = AuthorForm(request.POST)
        if (book_form.is_valid() and author_form.is_valid()):
        log.debug("test....")
            book=book_form.save()
            author=author_form.save()
        author.book=book
        author.save()

        return redirect('/index/')
    else:
    book_form=BookForm()
        author_form=AuthorForm()
        return render_to_response('addbook.html',{'form':book_form,'form':author_form},context_instance=RequestContext(request)) 
```

**表格.py**

```
from django import forms
from django.forms import ModelForm
from myapp.models import Book,Author

class AuthorForm(ModelForm):

    class Meta:
        model = Author

        fields=['author_id','first_name','last_name','email','age']        

class BookForm(ModelForm):

    class Meta:
        model = Book

        fields=['book_id','book_name','publisher_name','author'] 
```

**模型.py**

```
from django.db import models

class Author(models.Model):
    author_id = models.AutoField(primary_key=True)
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=40)
    email = models.EmailField()
    age=models.IntegerField()

    class Meta:
    db_table=u'Author'

    def __unicode__(self):
        return u"%d %s %s %s %d" % (self.pk, self.first_name, self.last_name, self.email,self.age)

class Book(models.Model):
    book_id=models.AutoField(primary_key=True,unique=True)
    book_name=models.CharField(max_length=30)
    publisher_name=models.CharField(max_length=40)
    author=models.ForeignKey(Author)

    class Meta:
        db_table = u'Book'

    def __unicode__(self):
        return u'%d %s %s' % (self.pk, self.book_name, self.publisher_name) 
```

**模板.html**

```
<div align="center">

  <form action="/addbook/" method="post">
     {% csrf_token %}
    {{ book_form.as_p }}
    {{ author_form.as_p }}
    <input type="submit" value="submit">
    </form> 
```

在这里，我使用作者作为 foriegnkey。在表单中，我已经为数据库中的所有字段提供了字段。当我单击提交按钮时，它会显示字段以及作者字段。这里 author 表中的 author_id 指向 book 表中的 author_id。在 views.py 中我们如何实现它。

我希望以这种方式将数据保存到数据库中。我也更改了我的模板。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-12T16:18:36.800

**模型.py**

```
class Author(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=40)
    email = models.EmailField()
    age = models.IntegerField()

    def __unicode__(self):
        return "{0} {1} {2} {3} {4}".format(
            self, self.first_name, self.last_name, self.email, self.age)

class Book(models.Model):
    book_name=models.CharField(max_length=30)
    publisher_name=models.CharField(max_length=40)
    author=models.ForeignKey(Author)

    def __unicode__(self):
        return "{0} {1} {2}".format(
            self.pk, self.book_name, self.publisher_name) 
```

**表格.py**

```
class AuthorForm(ModelForm):
    class Meta:
        model = Author     

BookFormset = inlineformset_factory(Author, Book, 
    fields=('book_name', 'publisher_name'), extra=1, 
    can_delete=False) 
```

**视图.py**

```
def addbook(request):
    form = AuthorForm()
    book_formset = BookFormset(instance=Author())

    if request.POST:
        form = AuthorForm(request.POST)
        if form.is_valid():
            author = form.save()
            book_formset = BookFormset(request.POST, instance=author)
            if book_formset.is_valid():
                book_formset.save()
            return redirect('/index/')

    return render_to_response('addbook.html',{
        'form': form, 'formset': book_formset
    },context_instance=RequestContext(request)) 
```

**模板**

```
<div align="center">
    <tr>
        <form method="POST"> 
            {% csrf_token %} 
            <h5>Author:</h5>
            {{ form.as_p }}

            <h5>Book:</h5>
            {{ formset.as_p }}
            <input type="submit" value="submit">
        </form>
    </tr>
</div> 
```

# sql - Django Queryset __in 列表中没有值

> ID：15365823
> 
> 赞同：9
> 
> 时间：2013-03-12T15:50:42.297
> 
> 标签：sql, django, django-models, django-orm

```
a = M.objects.filter(f__in=[None, 1])
a.query.__str__()
u'SELECT * FROM "app_m" WHERE "app_m"."f" IN (None, 1)' 
```

你不认为会`IN (NULL, 1)`吗？

喜欢：

```
a = M.objects.filter(f=None)
a.query.__str__()
u'SELECT * FROM "app_m" WHERE "app_m"."f" IS NULL' 
```

这是默认的 SQL 行为、django 错误还是我遗漏了什么`f__in=`？

先感谢您！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T16:24:22.637

```
a = M.objects.filter(Q(f__isnull=True) | Q(f__in=['1',...])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-14T18:34:02.293

这似乎是 Django 中的老错误（[https://code.djangoproject.com/ticket/13768](https://code.djangoproject.com/ticket/13768)）。

我刚刚用 Django 1.5 做了一些测试，它仍然存在：在应用于“__in”的列表中使用“无”时会被忽略（没有错误）。

凯瑟琳的方法就像一种魅力:)

# javascript - 如何选择 Javascript 数组中的所有值？

> ID：15365827
> 
> 赞同：1
> 
> 时间：2013-03-12T15:50:48.567
> 
> 标签：javascript, arrays, google-maps-api-3

我有一个称为标记的数组。我有一个填充了标记的谷歌地图，我想调用一个选择所有数组值的函数，这样我就可以将所有标记图像设置为原始图像，然后再将新图像设置为突出显示。除非有设置所有标记图像的 google api 方式。

```
 function show(i)
{
   markers[all].setIcon("lib/images/default.png");
   markers[i].setIcon("lib/images/default_h.png");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:52:11.760

尝试：

```
for(var i in markers)
{
   markers[i].setIcon("lib/images/default.png");
} 
```

如果你的数组键是递增的整数，你应该这样做

```
var size = markers.length;
for(var i=0; i<size; i++) { ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:59:45.730

您可以使用每个功能：

```
 function show(i) {
        markers.every(function(marker) {
            marker.setIcon("lib/images/default.png");
            return true;
        }

        markers[i].setIcon("lib/images/default_h.png");
    } 
```

# r - knitr 图的动态高度和宽度

> ID：15365829
> 
> 赞同：38
> 
> 时间：2013-03-12T15:50:49.877
> 
> 标签：r, knitr

在 knitr 中，可以通过简单地在块选项中指定绘图的大小来指定它。

例如：

```
```{r, fig.width=9,fig.height=3}
plot(x)
``` 
```

我希望能够根据`x`. 假设 x 是一个 data.frame：

```
x <- data.frame(x=factor(letters[1:3]),y=rnorm(3)) 
```

例如，假设我想将 fig.height 调整为等于`length(unique(x$x))`

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-12T16:00:36.527

例如，您可以在另一个块中定义宽度，然后使用它

```
```{r,echo=FALSE}
x <- data.frame(x=factor(letters[1:3]),y=rnorm(3))
len = length(unique(x$x))
```

```{r fig.width=len, fig.height=6}

plot(cars)
``` 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-11-16T21:30:16.263

我刚刚发现了一篇很棒的博客文章。

[在 Michael J Williams 的博客上](http://michaeljw.com/blog/post/subchunkify/)阅读更多信息——我无耻地盗取了代码，所以那里有更多细节。**请记住将块选项设置为 results = "asis"。**

假设您想使用循环输出一堆图，但您希望它们每个都有不同的大小。定义以下函数（*同样，我只是在这里复制粘贴*）：

```
subchunkify <- function(g, fig_height=7, fig_width=5) {
  g_deparsed <- paste0(deparse(
    function() {g}
  ), collapse = '')

  sub_chunk <- paste0("
  `","``{r sub_chunk_", floor(runif(1) * 10000), ", fig.height=",
   fig_height, ", fig.width=", fig_width, ", echo=FALSE}",
  "\n(", 
    g_deparsed
    , ")()",
  "\n`","``
  ")

  cat(knitr::knit(text = knitr::knit_expand(text = sub_chunk), quiet = TRUE))
} 
```

并使用这样的函数，定义您自己的图形大小：

```
```{r echo=FALSE, results='asis'}
g <- ggplot(economics, aes(date, unemploy)) + 
  geom_line()
subchunkify(g, 10, 3)
subchunkify(g, 7, 7)
``` 
```

或者让数据定义尺寸：

```
```{r echo=FALSE, results='asis'}
g <- ggplot(economics, aes(date, unemploy)) + 
  geom_line()
for (i in seq(2, 5)) {
  subchunkify(g, i / 2, i)
}
``` 
```

在帖子中，迈克尔警告您必须小心：

> 由于我们使用 results='asis'，如果我们想从块中输出文本或标题或其他任何内容，我们必须使用原始 HTML，而不是 Markdown，并且我们必须使用 cat() 来执行此操作，而不是 print() . 例如：

```
g <- ggplot(economics, aes(date, unemploy)) + 
  geom_line()

cat('<h2>A Small Square Plot</h2>')
subchunkify(g, 3, 3) 
```

再说一次，不是我的工作……请访问[那篇可爱的博客文章](http://michaeljw.com/blog/post/subchunkify/)以获取更多详细信息。希望这对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-04T07:10:50.297

解决此问题的一种方法，特别是如果您想在循环中更改图形参数，

1.  定义另一个块，一个执行循环的函数
2.  分别在以下块中定义图形细节

    ```
    ```{r, echo=FALSE}
    testFunction <- function (parameter) {
        x <- data.frame(x=c(1:parameter), y=rnorm(parameter))
        g1 <- ggplot(data=x, aes(x=x, y=y)) + geom_point()
        print(g1)
    }
    ```

    ```{r fig.width=10, fig.height=6}
    testFunction(10)
    ```

    ```{r fig.width=5, fig.height=4}
    testFunction(4)
    ``` 
    ```

# php - 表单输入名称，两个值

> ID：15365835
> 
> 赞同：0
> 
> 时间：2013-03-12T15:51:09.320
> 
> 标签：php, mysql

我不确定以前是否有人问过这个问题，我去。我有一个表格`<input name="name" value=<?php echo $myName; ?>`

我遇到的问题是：

1.  如果用户存在，我正在检查数据库，如果存在，这就是我所做的：

    $myName=$db->fields['name'];

所以这个名字在这里输出：`<input name="name" value=<?php echo $myName; ?>,`

但是，当我提交表单时，我也会验证它，所以如果：

```
original name in db was: John,

new name after form submit is: John Adam. 
```

但是由于我将 $myName 输出到表单，它会覆盖它吗？如何使用相同的变量名回显到输入？在这种情况下 $myName，下面的这个没有做到！

```
if($db->recordCount>0)
{
$myName=$db->fields['name'];
}
else
{
$myName=$_POST['name'];
}
<input name="name" value="<?php echo $myName; ?>"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:04:25.180

你能改变你的`if`陈述的顺序吗？

```
$myName = '';
if (isset($_POST['name']) {
    $myName = $_POST['name'];
} else {
    $myName = $db->fields['name'];
}
...
<input name="name" value="<?php echo $myName; ?>"> 
```

如果没有看到代码的整体结构，很难更好地回答，看看逻辑哪里出了问题。

# android - 如何正确创建对象列表，然后按索引使用这些对象？

> ID：15365837
> 
> 赞同：0
> 
> 时间：2013-03-12T15:51:11.667
> 
> 标签：android, object, arraylist

我正在尝试在我的程序中创建另一个类的对象列表。我希望能够访问列表中的特定对象，然后使用该对象从类中获取数据。这是我从中创建对象的类：

```
public class objectdata extends Activity {

    int number=0;
    String word="";
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
    }

    public objectdata(int num, String word){

        number = num;
        word = word;

    }
} 
```

这是将对象添加到列表中以及我希望访问对象的类：

```
public class MainActivity extends Activity {

    TextView tv;
    ArrayList<Object> objarray = new ArrayList<Object>(2);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        makeObjects();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    public void makeObjects(){

        //For loop creates two objects and adds them to the list
        for(int i = 0; i < 3; i++) {

            int number=1;
            String word="One";
            number++;

            objectdata o = new objectdata(number, word);
            objarray.add(o);
        }

        //THIS IS WRONG!
        //Access the second object in the list, so as to access the value in number
        objectdata o = objarray.get(1);
        tv.setText(o.number.toString());

    }

} 
```

在底部是我尝试访问索引 1 中的对象，所以创建的第二个对象，我想通过使用该对象从类中获取数字值并将其存储在文本视图中，以便我可以看到它有效. 基本上我正在尝试使用对象来存储数据，然后将这些对象存储在数组列表中。我完全被困在这一点上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T07:32:52.097

由于您想在 中存储您自己的类的对象，请`ArrayList`更改以下声明

```
ArrayList<Object> objarray = new ArrayList<Object>(2); 
```

到

```
ArrayList<objectdata> objarray = new ArrayList<objectdata>(2); 
```

然后你的代码应该可以工作。顺便说一句，`objectdata`对于一个类来说，这不是一个好名字，根据命名约定，一个好的名字应该以大写字母开头并使用驼峰式：`ObjectData`。希望这可以帮助。

# delphi - Delphi - 获取非本地时区的 TTimeZone 并在时区之间转换

> ID：15365842
> 
> 赞同：4
> 
> 时间：2013-03-12T15:51:24.403
> 
> 标签：delphi, timezone, utc, dst

我的主题可能措辞很糟糕，但这就是我所拥有的。

我有一个 Web 服务，它在本地时间报告时间戳，如果服务器位于受影响的区域，时间戳会反映白天时间。Web 服务还有第二次调用以检索 UTC 中的服务器时间，因此太平洋夏令时 (PDT) 中的服务器将其 UTC 偏移报告为 -08:00，即使由于 PDT 而实际上是 -07:00。

这是我调用返回服务器时区信息的结果。

太平洋标准时间;-480;(UTC-08:00) 太平洋时间（美国和加拿大）;太平洋标准时间;太平洋夏令时间;[01:01:0001;12:31:2006;60;[0;02: 00:00;4;1;0;];[0;02:00:00;10;5;0;];][01:01:2007;12:31:9999;60;[0;02: 00:00;3;2;0;];[0;02:00:00;11;1;0;];];

因此，如果从 Web 服务返回的时间戳是 2013 年 3 月 12 日上午 12:00 并且 UTC 偏移量是 -08:00，并且我住在亚利桑那州的一个夏令时豁免区域，我的 UTC 偏移量是 -07:00 怎么能我从返回的时间戳转换为我的本地时间？

这里的杀手锏是在时间戳中使用本地时间的 Web 服务。如果他们坚持通用格式，我的生活会很轻松。我目前的想法是，如果我可以在 TTimeZone 或等效结构中获取服务器的信息，那么我可以使用 TTimeZone.IsDaylightTime(Timestamp) 函数来知道我是否需要在使用 -08:00 服务器之前从时间戳中减去一个小时偏移量和 -07:00 本地偏移量以获得正确的本地时间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T17:11:18.603

您可以使用[delphi-tzdb](https://code.google.com/p/delphi-tzdb/)。伪代码：

```
uses
  ..., TZDB;

procedure Main;
var
  ServerTZID: string;
  TZ: TTimeZone;
  Stamp1, Stamp2: TDateTime;
begin
  // 1\. retrieve server timezone info
  ServerTZID := ... // MyServer.GetTimezoneInfo; e.g. 'Pacific Standard Time';
  // look up the retrieved timezone
  TZ := TBundledTimeZone.GetTimeZone(ServerTZID); // nil if not found
  // 2\. retrieve server timestamp
  Stamp1 := ... // MyServer.RetrieveTimestamp;
  // 3\. convert to UTC and back to local timezone
  Stamp2 := TZ.Local.ToLocalTime(TZ.ToUniversalTime(Stamp1));

  Writeln(Format('%s %s -> %s %s', [FormatDateTime('yyyy-mm-dd hh:nn:ss.zzz', Stamp1),
    TZ.DisplayName, FormatDateTime('yyyy-mm-dd hh:nn:ss.zzz', Stamp2),
    TZ.Local.DisplayName]));
end; 
```

# html - 如何修复渐变背景？

> ID：15365844
> 
> 赞同：0
> 
> 时间：2013-03-12T15:51:29.383
> 
> 标签：html, css, styles, gradient, styling

我想知道是否可以修复来自 html 标签的渐变：

```
html, body, .wrapper {
    height: 100%;
}
body > .wrapper {
    height: 100%;
    min-height: 100%;
}

html {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 14px;
    background-attachment: fixed !important;
    background-image: green;
    background-image: -webkit-gradient(linear, 0 0, 0 100%, from(green), color-stop(20%, #fff), color-stop(80%, #fff), color-stop(100%, green));
    background-image: -webkit-linear-gradient(left, green, #fff 20%, green 100%);
    background-image: -moz-linear-gradient(left, green, #fff 20%, green 100%));
    background-image: -o-linear-gradient(left, green, #fff 20%, green 100%));
    background-image: -ms-linear-gradient(left, green, #fff 20%, green 100%));
    background-image: linear-gradient(left, green, #fff 20%, green 100%));

} 
```

这样当您调整浏览器窗口的大小时，渐变不会移动。

这可能吗？

多谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:58:27.810

将其设置为特定的 px 值：

```
background: linear-gradient(to right, green 0%, #fff 300px, green 100%); 
```

[http://jsfiddle.net/GuMKd/](http://jsfiddle.net/GuMKd/)

考虑使用这个工具： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

# javascript - JS 对象结构和添加

> ID：15365848
> 
> 赞同：1
> 
> 时间：2013-03-12T15:51:39.143
> 
> 标签：javascript, arrays, object, push

只是一个关于 JS 对象结构的问题。我有一个名为`mainObject`我想将值推入的对象，因此它们以类似于第二部分代码的格式出现。这些值将在循环中添加。我希望能够按照以下方式做一些事情：-

```
mainObject.data.push({lat : val['lat'], lng: val['lng'], count: 40});} 
```

有人能告诉我我该怎么做吗？试图让我的头脑围绕 JS 对象。

```
var mainObject = {
    max: 46};

var mainObject = {
            max: 46,
            data: [{lat: 33.5363, lng:-117.044, count: 1},{lat: 33.5608, lng:-117.24, count: 1},{lat: 38, lng:-97, count: 1},{lat: 38.9358, lng:-77.1621, count: 1}]
    }; 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:55:54.553

在 javascript`.push`中是为数组保留的。要添加到已经具有属性的对象，您可以简单地执行此操作。

```
var mainObject = {
    max: 46
};

mainObject.data = [{lat : val['lat'], lng: val['lng'], count: 40}]; 
```

然后你会得到一个看起来像这样的对象：

```
mainObject{
    max : 46,
    data : [{lat : val['lat'], lng: val['lng'], count: 40}]
} 
```

这就是你想要的。

编辑：

@cristoph 指出，如果您更改初始 mainObject 的实例化，那么您可以这样做：

```
 var mainObject = {
     max : 46,
     data : [] 
 }

 mainObject.data.push({lat : val['lat'], lng: val['lng'], count: 40}); 
```

这会给你同样的结果。

无论您选择哪种方式，一旦它`data`是一个属性`mainObject`并且是一个数组，您就可以继续使用`.push`它来向其中插入更多元素。

所以对上面这样做：

```
 mainObject.data.push({foo : bar}); 
```

会产生：

```
 mainObject{
     max : 46,
     data : [{lat : val['lat'], lng: val['lng'], count: 40}, {foo : bar}]
 } 
```

# javascript - 似乎无法让 jQuery .on 触发

> ID：15365851
> 
> 赞同：1
> 
> 时间：2013-03-12T15:51:56.960
> 
> 标签：javascript, jquery, events

我正在尝试以特定方式设置客户端验证。我有一些动态的表单，在单击按钮或执行某些操作之前不会显示。所以，这就是我正在做的事情：

```
$(function() {
    $('#content').on('load', 'form', function(e) {
        /* every form will be inside of div#content */
        setUpStuff();
    });
}); 
```

然后，如果按下按钮：

```
$('#my-button').click(function() {
    displayForm();
    $('form').trigger('load');
}); 
```

问题是当该事件被触发时这个函数必然会触发永远不会触发。我知道页面加载后 div#content 就存在，因为它是静态的。形式是动态的。但是，即使将表单作为静态标记放入页面中并且在页面加载时可用，`$('form').trigger('load');`仍然不起作用。

这段代码我哪里出错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:59:11.257

尝试使用自定义事件名称，`load`已知事件不会正确冒泡，并且在这种情况下并不能真正描述正在发生的事情。

```
$(function() {
    $('#content').on('create', 'form', function(e) {
        /* every form will be inside of div#content */
        setUpStuff();
    });
    $('#my-button').click(function() {
        displayForm();
       $('form').trigger('create');
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:17:14.907

nvm，看起来你明白了:)

我想我知道你在做什么，你试过使用 .load() 方法吗？

```
$('#my-button').click(function() {
    displayForm();
    $('form').load(function(){
     setUpStuff();
  });
}); 
```

[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

# java - 大规模 MySQL 更新

> ID：15365856
> 
> 赞同：4
> 
> 时间：2013-03-12T15:52:06.490
> 
> 标签：java, mysql

我编写了一个服务器可以使用的应用程序。此应用程序收集信息，并将其发送到服务器。这是每 10 秒完成一次。数据量取决于玩家玩游戏，但让我们保持在大约 50 个服务器，每个服务器发送 100 条数据（每 10 秒总共 5000 条）。

这些数据片段包含`SQL`查询（在`PreparedStatement`语法中）、`Object[]`SQL 查询的值和 serverID。
现在，我想处理所有数据。这对我来说并不顺利。我有一个 MySQL 服务器，它有 5 个表。其中三个表在不断更新，跟不上数据流。这些表是 InnoDB 表，主要是因为我可以通过这种方式进行行级锁定，而不是表锁定。`UPDATE`无论如何，大多数查询都是查询，几乎没有任何`INSERT`语句。

我已经尝试立即执行所有查询，这只会导致糟糕的性能，因为连接服务器也必须等待它完成。
我还尝试将所有查询放在一个 big`ConcurrentLinkedQueue`中，并每隔几秒钟清空一次该队列。性能更好，但这太慢了。
然后我尝试了一个按表计算的解决方案，再次稍微好一点。还是太慢了。
目前，它使用每台服务器设置（`thread`为每台服务器创建一个新服务器并在那里执行所有查询）。这还是太慢了。它跟不上。

如您所见，我尝试了很多事情。我也尝试过使用`addBatch()`后跟`executeBatch()`，它也在当前设置中使用。当然，我也看过这里，Google 等。有*一些*有用的信息，但主要是关于添加 PreparedStatements 和使用 BatchUpdates。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T14:09:16.003

我使用 spring-jdbc，并使用 com.jolbox.bonecp 进行连接。我想建议你使用相同的。

我使用*multyPreparedValues*`jdbcTemplate.batchUpdate(query, multyPreparedValues)`所在的位置*`List<Object[]>`*

 *但您也可以使用 BatchPreparedStatementSetter — 示例[https://stackoverflow.com/a/8873528/814304](https://stackoverflow.com/a/8873528/814304)*

# c# - 需要帮助 - 带有自定义参数的动态点击事件处理程序 - Lambda 表达式

> ID：15365858
> 
> 赞同：0
> 
> 时间：2013-03-12T15:52:10.627
> 
> 标签：c#, lambda, event-handling

我正在尝试使用传递的自定义参数动态创建自定义事件处理程序。基本上，我有一个添加了点击事件的面板：

```
Panel awardButton = new Panel();
awardButton.Click += new EventHandler(PreviewAward); 
```

我想向我的 PreviewAward 函数发送一些变量。我尝试了我所知道的一切，但除了错误一无所获。我尝试寻求帮助，这是我能找到的最接近的：

[带有自定义参数的 EventHandler](https://stackoverflow.com/questions/6457474/c-sharp-eventhandler-with-custom-arguments)

我尝试使用该代码如下：

```
awardButton.Click += (sender, e) => PreviewAward(dtAward.Rows[0]["iconImage"].ToString()); 
```

lambda 右侧的所有内容都用红色下划线表示“方法 'PreviewAward' 没有重载需要 1 个参数”。我想我不明白 lambda 是如何工作的，因为我认为 (sender, e) 与我的“iconImage”字符串一起被传递到 PreviewAward 方法中，总共有 3 个参数，而不是一个。另外，我尝试将变量添加到我的方法中，但得到了同样的错误。这是方法：

```
 private void PreviewAward(object sender, EventArgs e, string slot)
    {
        string str = ((Panel)sender).Name;
        MemoryStream ms = new MemoryStream(Utils.StrToByteArray(str));
        MemoryStream preview = new MemoryStream(Utils.ImageMerge(((System.Drawing.Image)(Avatar.Properties.Resources.resizeButtonIn)), Image.FromStream(ms), 200, 200));
        Debug.Print("Show Preview for item: " + str);
    } 
```

当我将鼠标悬停在 lambda 右侧的函数上时，我会看到“PreviewAward”上的小下拉菜单，它希望我创建一个方法存根。如果我点击它，它会创建这个：

```
 private object PreviewAward(string p)
    {
        throw new NotImplementedException();
    } 
```

我不知道该怎么办，尤其是它没有我的“发件人”。我的印象是它会使用我已经创建的“private void PreviewAward”方法，而不是让我创建一个新的同名“私有对象”方法……我完全糊涂了！任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:03:05.843

(sender, e) 参数不会自动传递给您的 PreviewAward 方法。

它们被传递给您的 lambda，而在您的 lambda 中，您根本不使用它们，而是使用单个字符串参数手动调用 PreviewAward。

有几种方法可以解决此问题，但最简单的方法是稍微修改一下您的 lambda，以便它将所需的参数传递给 PreviewAward 方法。

```
awardButton.Click += (sender, e) => PreviewAward(sender, e, dtAward.Rows[0]["iconImage"].ToString()); 
```

编辑：也就是说，有一个需要额外参数的点击事件处理程序有点奇怪 - 这意味着该方法的签名与 EventHandler 签名不匹配。例如，可能值得重新考虑一下设计，以便在方法内部计算第三个参数。

# c++ - 在 C++ 函数中返回两个变量

> ID：15365860
> 
> 赞同：27
> 
> 时间：2013-03-12T15:52:12.420
> 
> 标签：c++

我想返回两个双变量：调用我创建的函数时。根据一些教程（涉及 C++ 的基础知识），我将无法做到这一点。

有没有办法这样做？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-03-12T15:54:47.457

您可以编写一个简单的结构来保存变量并返回它，或者使用`std::pair`or `std::tuple`：

```
#include <utility>

std::pair<double, double> foo()
{
  return std::make_pair(42., 3.14);
}

#include <iostream>
#include <tuple> // C++11, for std::tie
int main()
{
  std::pair<double, double> p = foo();
  std::cout << p.first << ", " << p.second << std::endl;

  // C++11: use std::tie to unpack into pre-existing variables
  double x, y;
  std::tie(x,y) = foo();
  std::cout << x << ", " << y << std::endl;

  // C++17: structured bindings
  auto [xx, yy] = foo(); // xx, yy are double
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-12T15:53:42.757

您可以将对两个双精度数的引用传递给函数，在函数内设置它们的值

```
void setTwoDoubles(double& d1, double& d2)
{
    d1 = 1.0;
    d2 = 2.0;
}

double d1, d2;
setTwoDoubles(d1, d2);
std::cout << "d1=" << d1 << ", d2=" << d2 << std::endl 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-03-12T16:08:20.087

如果您使用的是 C++11，我想说理想的方法是使用[`std::tuple`](http://en.cppreference.com/w/cpp/utility/tuple)and [`std::tie`](http://en.cppreference.com/w/cpp/utility/tuple/tie).

示例取自`std::tuple`我链接到的页面：

```
#include <tuple>
#include <iostream>
#include <string>
#include <stdexcept>

std::tuple<double, char, std::string> get_student(int id)
{
    if (id == 0) return std::make_tuple(3.8, 'A', "Lisa Simpson");
    if (id == 1) return std::make_tuple(2.9, 'C', "Milhouse Van Houten");
    if (id == 2) return std::make_tuple(1.7, 'D', "Ralph Wiggum");
    throw std::invalid_argument("id");
}

int main()
{
    auto student0 = get_student(0);
    std::cout << "ID: 0, "
              << "GPA: " << std::get<0>(student0) << ", "
              << "grade: " << std::get<1>(student0) << ", "
              << "name: " << std::get<2>(student0) << '\n';

    double gpa1;
    char grade1;
    std::string name1;
    std::tie(gpa1, grade1, name1) = get_student(1);
    std::cout << "ID: 1, "
              << "GPA: " << gpa1 << ", "
              << "grade: " << grade1 << ", "
              << "name: " << name1 << '\n';
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-12T15:53:53.163

例如，您可以使用[`std::pair`](http://www.cplusplus.com/reference/utility/pair/)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-12T15:55:30.633

从技术上讲，不，您不能以通常返回变量的方式返回两个变量。但是，您可以使用参考。这样，您可以将多个变量传递给一个函数，该函数将分配它们，而不是返回任何内容：

```
void function(double & param1, double & param2) {
    param1 = 6.28;
    param2 = 3.14;
} 
```

你会这样称呼它：

```
double var1, var2;
function(var1, var2); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-12T15:58:33.863

不，您不能通过引用方法返回两个需要使用的变量

```
 #include <iostream>
using namespace std;

// function declaration
void swap(int &x, int &y);

int main ()
{
   // local variable declaration:
   int a = 100;
   int b = 200;

   cout << "Before swap, value of a :" << a << endl;
   cout << "Before swap, value of b :" << b << endl;

   /* calling a function to swap the values using variable reference.*/
   swap(a, b);

   cout << "After swap, value of a :" << a << endl;
   cout << "After swap, value of b :" << b << endl;

   return 0;
}

// function definition to swap the values.
void swap(int &x, int &y)
{
   int temp;
   temp = x; /* save the value at address x */
   x = y;    /* put y into x */
   y = temp; /* put x into y */

   return;
} 
```

输出将是 100 // x 在调用交换函数之前 200 // y 在调用交换函数之前 200 // x 在调用交换函数之后 100 // y 在调用交换函数之后

这作为返回两个值

[这个链接可以帮助你](http://www.tutorialspoint.com/cplusplus/cpp_function_call_by_reference.htm)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-12T15:57:41.087

您不能直接执行此操作（因为返回值是单数）。
但是，您可以将一些值放入一个结构中，然后返回它（例如一对<>）。

一种常见的模式是通过引用返回输出变量：

```
ReturnVal Myfunction(/*in*/ BlahType _someParameters, /*out*/ ReturnType& _firstReturn, /*out*/ OtherReturnType& _secondReturn)
{
   _firstReturn = //someStuff
   _secondReturn = //someOtherStuff

return SUCCESS;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-12T15:54:16.777

您不能从一个函数返回两个值，但可以返回指向数组或包含两个双精度值的其他结构的指针。

# php - 在 php 中将选择的链接作为 GET 参数发送

> ID：15365861
> 
> 赞同：0
> 
> 时间：2013-03-12T15:52:12.873
> 
> 标签：php, html, forms

我正在编写一个表单，我在其中编写有关电影的信息，并将其发布到文本文件中。然后我在一个列表中回显它，其中包含指向同一文件的链接。我知道要给链接一个 GET 参数，以便选择的链接名称作为 GET 参数发送。我似乎无法正确处理。

```
<!DOCTYPE html>

<html>

<head>
<title>Inlämning3</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<script type="text/javascript" src="jQuery.js" >
</script>
<script type="text/javascript" src="valideraFilmer.js" >
</script>

</head>

<body>

<?php
// Skriva film och info till en textfil
if( isset ($_POST['name'])){
    $name = $_POST['name'];
    $grade = $_POST['options'];
    $link = $_POST['link'];
    $pic = $_POST['pic'];
    $story = $_POST['story'];

    $myFile = "filmer.txt";
    $handle = fopen($myFile, 'a');

    if(!empty($name)){
        fwrite($handle, $name. ";");
        fwrite($handle, $grade. ";");
        fwrite($handle, $link. ";");
        fwrite($handle, $pic. ";");
        fwrite($handle, $story. "\n");
        fclose($handle);
    }
}
?>

<div id="page">
    <?php
        include("header.php");
    ?>
    <div id="leftbar">
        <form id="form" method="post" action="Filmer-PHP.php" >
            <fieldset>
                <legend>Lägg till en film:</legend>
                Titel:
                <br><input type="text" name="name" id="name"><br>
                Betyg:
                <br><select id="options" name="options">
                    <option value="0">Välj betyg här...</option>
                    <option value="*"> *</option>
                    <option value="**"> **</option>
                    <option value="***"> ***</option>
                    <option value="****"> ****</option>
                    <option value="*****"> *****</option>                       
                </select>
                <br>
                Länk till imdb:
                <br><input type="text" name="link" id="link"><br>
                Länk till bild:
                <br><input type="text" name="pic" id="pic"><br>
                Filmens handling:
                <br><textArea cols="20" rows="3" name="story" id="story"></textarea><br>
                <br><input type="submit" name="button" value="Spara film" id="button">
            </fieldset>
        </form>
    </div>
    <div id="rightbar">
        <h2>Filmer</h2>

        <?php
        // Läsa av och visa titel och betyg
            $readin = file('filmer.txt');
            $ul = '<ul id="films">';
            echo $ul;
            foreach($readin as $fName){
                $lineSplit = explode(";", $fName);
                echo '<li>'.'<a href="Filmer-PHP.php?filmer=$lineSplit[0]">'.$lineSplit[0].'<span>'.$lineSplit[1].'</span>'.'</a>'.'</li>';
            }

        ?>

        <?php
        // Läsa av och visa detaljerad info om filmer
        ?>

    </div>
        <?php
            include("footer.php");
        ?>
</div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:56:35.580

单引号中的变量不会被扩展，所以如果你这样写：

```
echo '<a href="Filmer-PHP.php?filmer=$lineSplit[0]">' 
```

这将最终成为

```
<a href="Filmer-PHP.php?filmer=$lineSplit[0]"> 
```

您可能希望将 $lineSplit[0] 替换为该变量的值。使用双引号

```
echo "<a href='Filmer-PHP.php?filmer=$lineSplit[0]'>" 
```

或将其放在引号之外

```
echo '<a href="Filmer-PHP.php?filmer=' . $lineSplit[0] . '">' 
```

# c# - 使用 wkhtmltopdf 时为 PDF 页脚添加边距

> ID：15365867
> 
> 赞同：2
> 
> 时间：2013-03-12T15:52:26.213
> 
> 标签：c#, command-line-arguments, wkhtmltopdf, ashx

我正在使用`wkhtmltopdf`在文件系统上创建 pdf 文档。当我插入这样的参数时，PDF 生成良好：

```
psi.Arguments = "- --footer-html "http://localhost/pdf/footerpage.html" --footer-right "Page [page] of [toPage]" "C:\PDF\pdf.pdf"" 
```

问题是页脚包含不适合的图像。当我尝试像这样在底部添加边距时：

```
psi.Arguments = "- --margin-bottom 30 --footer-html "http://localhost/pdf/footerpage.html" --footer-right "Page [page] of [toPage]" "C:\PDF\pdf.pdf"" 
```

pdf无法生成。错误：“--margin-bottom specified in wrong location” 我在 wiki [https://code.google.com/p/wkhtmltopdf/issues/detail?id=957](https://code.google.com/p/wkhtmltopdf/issues/detail?id=957)上找到了这个，但它没有帮助。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:51:33.677

*评论太大了，所以将其发布为答案。*

我的实验表明，`wkhtmltopdf`指定参数的顺序是特别的。[此答案](https://stackoverflow.com/a/12422348/326543)中也指出了相同的内容。

听起来很奇怪，我很确信我做错了什么。

你可以试试这个 -

```
psi.Arguments = "- --footer-html \"http://localhost/pdf/footerpage.html\" --footer-right \"Page [page] of [toPage]\" --margin-bottom 30 \"C:\PDF\pdf.pdf\"" 
```

# entity-framework - 是否可以通过 EF 类访问成员资格表？迄今为止，我一直没有成功

> ID：15365868
> 
> 赞同：1
> 
> 时间：2013-03-12T15:52:27.170
> 
> 标签：entity-framework, entity-framework-4, entity-framework-5

我正在尝试做一些我认为很简单的事情。

基本上，我正在尝试从现有的“aspnet_Membership”表中创建一个 EF POCO 类以添加到我的 EF 数据模型中。我实际上正在使用 Devart 的 Entity Developer。我可以将表格信息导入设计器，并使用表格信息更新模型。但是，当我保存模型时，不会生成 POCO。我所有的自定义表都表现良好，但“aspnet_Membership”不会做任何事情。好像上面有一个秘密标志，上面写着“不要生成 POCO 类”！

最终，我正在干燥以实现以下目标：

组织 -< 组织用户 >- aspnet_Membership

任何想法都非常感谢。

谢谢。

# linux - 用于从 shell 脚本解析文件中的键/值的代码

> ID：15365871
> 
> 赞同：16
> 
> 时间：2013-03-12T15:52:31.650
> 
> 标签：linux, bash

我有一个文件，我需要使用 shell 脚本按键查找值。该文件如下所示：

```
HereIsAKey This is the value 
```

我该怎么做：

```
MyVar=Get HereIsAKey 
```

然后 MyVar 应该等于“这是值”。键没有空格，值应该是键后空格后面的所有内容。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-12T16:01:03.827

如果`HereIsAKey`在您的文件中是唯一的，请使用 grep 尝试此操作：

```
myVar=$(grep -Po "(?<=^HereIsAKey ).*" file) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-09-30T10:58:32.787

如果您没有支持与 Perl 兼容的正则表达式的 grep，则以下方法似乎有效：

```
VAR=$(grep "^$KEY " file | cut -d' ' -f2-) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-12T15:57:41.660

如果您一次只需要一个变量，您可以执行以下操作：

```
#!/bin/bash
cat file | while read key value; do
  echo $key
  echo $value
done 
```

此解决方案的问题：变量仅在循环内有效。所以不要尝试`$key=$value`在循环之后执行和使用它。

更新：另一种方式是 I/O 重定向：

```
exec 3<file
while read -u3 key value; do
  eval "$key='$value'"
done
exec 3<&-
echo "$keyInFile1"
echo "$anotherKey" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-12T15:57:22.287

如果文件未排序，查找会很慢：

```
my_var=$( awk '/^HereIsAKey/ { $1=""; print $0; exit}' value-file ) 
```

如果文件已排序，您可以使用

```
my_var=$( look HereIsAkey value-file | cut -d ' ' -f 2- ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T16:10:51.287

我使用跨多种语言共享的属性文件，我使用了一对函数：

```
load_properties() {
    local aline= var= value=
    for file in config.properties; do
        [ -f $file ] || continue
        while read aline; do
            aline=${aline//\#*/}
            [[ -z $aline ]] && continue
            read var value <<<$aline
            [[ -z $var ]] && continue
            eval __property_$var=\"$value\"
            # You can remove the next line if you don't need them exported to subshells
            export __property_$var
        done <$file
    done
}

get_prop() {
    local var=$1 key=$2
    eval $var=\"\$__property_$key\"
} 
```

`load_properties`从文件中读取为`config.properties`文件中的每一行填充一组变量`__property_...`，然后 get_prop 允许根据加载的属性设置变量。它适用于大多数需要的情况。

是的，我确实意识到那里有一个 eval ，这使得**用户输入不安全**，但它适用于我需要它做的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-12T17:09:48.583

```
get () {
    while read -r key value; do
        if [ "$key" = "$1" ]; then
            echo "$value"
            return 0
        fi
    done
    return 1
} 
```

这两个 return 语句不是绝对必要的，但提供了很好的退出代码来指示找到给定键的成功或失败。它们还可以帮助区分“键的值是空字符串”和“找不到键”。

# java - 安卓拼写校正器

> ID：15365878
> 
> 赞同：0
> 
> 时间：2013-03-12T15:52:47.427
> 
> 标签：java, android, autocomplete, spell-checking, prediction

有没有办法访问 android 的拼写纠正功能？例如，在 Android 手机上发送文本时，会出现一个单词列表，这可能是下一个最有可能是 men't 的单词。例如，如果用户输入字符串 circal，那么我将可以访问单词列表，例如 circle、circus ...

如果我提供一个字符串，我可以使用一个设施/类来访问这些单词吗？我听说使用自动完成文本视图可以做到，但不知道怎么做？还是需要创建一个全新的拼写校正器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:01:14.843

是的，您可以使用 Android 的[Spelling Checker Framework](http://developer.android.com/guide/topics/text/spell-checker-framework.html)。

与框架集成的最佳方法将根据您的具体需求而有所不同，但文档中有大量示例。

# iphone - UIScrollView 里面的 UIView 设置为 tableHeaderView 不滚动

> ID：15365879
> 
> 赞同：1
> 
> 时间：2013-03-12T15:52:53.820
> 
> 标签：iphone, xcode, uitableview, uiview, uiscrollview

我遇到了一个问题，底部有一个 uiview，我需要添加一些我想保持静态的标签。然后我在 uiview 顶部添加一个滚动视图，其中包含一些可滚动的内容。最后，我将原始 uiview 设置为表 headerView。尽管 contentSize 正确，但 scrollView 并没有滚动。

```
UIView *header=[[UIView alloc]initWithFrame:CGRectMake(0, 0, 100*objects.count, 150)];
        [header setBackgroundColor:[UIColor redColor]];

    //set up scroll view
    UIScrollView *scrollView=[[UIScrollView alloc]initWithFrame:CGRectMake(0, 20, 100*objects.count, 110)];
    scrollView.delegate=self;
    scrollView.contentSize=CGSizeMake(100*objects.count, scrollView.frame.size.height);
    [scrollView setUserInteractionEnabled:YES];
    [scrollView setScrollEnabled:YES];

    [header addSubview:scrollView];

    [scrollView setShowsHorizontalScrollIndicator:YES];
    [self.tableView setTableHeaderView:header];

    //add stuff to scroll view 
```

但是，当我将 scrollView 设置为 tableHeaderView 时，滚动效果很好

```
 [self.tableView setTableHeaderView:scrollView]; 
```

谁能建议我如何将原始 botton uiview 设置为标题视图并让 scrollView 仍然有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T00:45:42.697

解决方案是使用滚动视图的 scrollViewDidScroll 委托方法并通过滚动量调整内容偏移量。有点hacky，仍然不知道为什么会发生这个scrollview问题，但它现在有效。

好像

```
-(void)scrollViewDidScroll:(UIScrollView *)scrollView
{

    [self.featuredLabel setFrame:CGRectMake(5+scrollView.contentOffset.x, 5, self.view.frame.size.width, 18)];
    [self.recentLabel setFrame:CGRectMake(5+scrollView.contentOffset.x, 100, self.view.frame.size.width, 18)];

} 
```

找不到提到它的帖子

# sql-server - 将 OLE DB 查找与平面文件 SSIS 相结合

> ID：15365881
> 
> 赞同：1
> 
> 时间：2013-03-12T15:52:57.390
> 
> 标签：sql-server, sql-server-2008, visual-studio-2008, ssis, oledb

我需要从一组 csv 文件中读取行并将它们写入数据库中的现有表中。但是，为了做到这一点，我需要将平面文件数据与数据库中表中的 2 个选定值结合起来。我在 SSIS 中构建了一个设计，应该允许这样做，使用查找转换。但是，它不起作用:(

这是我的设计：

![在此处输入图像描述](../Images/201153a9e9e9ccd87e47a07ccc27dfa7.png)

当我调试时，我收到消息：

```
Error at Contacts [SSIS.Pipeline]: input column "ObjectId" (914) has lineage ID 709 that was not previously used in the Data Flow task.
Error at Contacts [SSIS.Pipeline]: "component "OLE DB Destination" (134)" failed validation and returned validation status "VS_NEEDSNEWMETADATA".
Error at Contacts [SSIS.Pipeline]: One or more component failed validation. 
Error at Contacts: There were errors during task validation.
(Microsoft.DataTransformationServices.VsIntegration) 
```

ObjectId 是我在 Lookup 中选择的一个 int。查找的整个查询是：

```
DECLARE @ObjectId int
Select @ObjectId = (SELECT TOP (1) [Value] as ObjectId
FROM  dbo.Sequences WHERE (Name = 'Contact'));
UPDATE Sequences SET Value = Value + 1 WHERE (Name = 'Contact');
SELECT ObjectId = @ObjectId, Reference = N'CU' + cast(@ObjectId as VARCHAR(20)) 
```

此查询在预览中完美运行。有人可以告诉我我做错了什么吗？为我的无知道歉，但这是我在 SSIS 做的第一件事。

**更新 1**（见@billinkc 答案）

新设计：

![在此处输入图像描述](../Images/adaa5f3964ac8a73e5eb49ef9a73a1fa.png)

新错误:(

```
Error at Contacts [Lookup Sequence [531]]: SSIS Error Code DTS_E_OLEDBERROR.  An OLE DB error has occurred. Error code: 0x80004005.
An OLE DB record is available.  Source: "Microsoft SQL Server Native Client 10.0"  Hresult: 0x80004005  Description: "Syntax error, permission violation, or other nonspecific error".
Error at Contacts [Lookup Sequence [531]]: OLE DB error occurred while loading column metadata. Check SQLCommand and SqlCommandParam properties.
Error at Contacts [SSIS.Pipeline]: "component "Lookup Sequence" (531)" failed validation and returned validation status "VS_ISBROKEN".
Error at Contacts [SSIS.Pipeline]: One or more component failed validation.
Error at Contacts: There were errors during task validation.
(Microsoft.DataTransformationServices.VsIntegration) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:52:04.860

您的查找应该在 Generate EntityGUID 步骤之后内联，而不是联合。但是，查看您的 Lookup 代码，这不是 Lookup 的工作方式。查找是一种只读类型的操作

相反，您需要将其更改为 OLE DB Command 对象。

最后，您必须生成这些 ID 的 SQL 代码。那是...如果您有兴趣，那可以更有效地完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:20:13.927

我有一个类似的错误 0x80004005 让我抓狂。我的调试指向 OLEDB 源，但实际上这是因为我在测试期间更改了连接以将 RetainSameConnection 设置为 true，并且需要将其设置回 false。因此，请检查您的所有连接，以及您可能已更改的任何其他内容。

# android - 如何使用 NDK 控制视图

> ID：15365892
> 
> 赞同：2
> 
> 时间：2013-03-12T15:53:20.117
> 
> 标签：android, android-layout, android-ndk, java-native-interface

我正在创建一个 Android 应用程序，其中有一个带有 FrameLayout 的布局，它显示了相机流和上面的 2 个图像。

我需要能够使用 NDK 控制 2 张图像的位置。即 - 将它们的位置和实例传递给 C++ 代码并允许它移动它们。

此外，当调用触摸（和移动）事件时，我想让 C++ 知道它并使用它来移动图像。

我知道我可以将位置参数传递给 C++ 代码，但要求将引用传递给 ImageView 本身并允许 C++ 代码控制它。

可能吗？如果是这样 - 如何允许 C++ 代码控制我的视图和布局？

非常感谢！

# hadoop - 如何在集群中的每台机器上检索 map 和 reduce 中的指标？

> ID：15365900
> 
> 赞同：0
> 
> 时间：2013-03-12T15:53:23.977
> 
> 标签：hadoop, mapreduce, monitoring, metrics

我需要有关集群的信息。事实上，我想检索集群中每台机器的指标。我想在运行作业后通过 Map 和 Reduce 获得指标（数字等）。可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:04:53.863

[Reporter](https://hadoop.apache.org/docs/r1.1.1/api/org/apache/hadoop/mapred/Reporter.html)正是用于这种操作。

通常，您使用 ToolRunner 以[这种方式](http://cs.smith.edu/dftwiki/index.php/Hadoop_WordCount.java)在 map 和 reduce 方法上接收 Reporter 实例。

此对象允许您的实例在集群的不同节点之间保留计数器并报告状态。

# android - 可以在 RadioGroup android 中选择多个 RadioButton

> ID：15365903
> 
> 赞同：4
> 
> 时间：2013-03-12T15:53:31.360
> 
> 标签：android, dynamic, view, radio-button

我在我的活动布局中以编程方式添加（必须作为单选组和单选按钮的数量是变量）单选组：

```
rg = new RadioGroup(this);
rg.setOrientation(RadioGroup.HORIZONTAL);
rg.setId(list_questions.get(i).getQuizz_questions_id()); // get from the DB
lrg.add(rg);
for (int j = 0; j < list_answers.size(); j++) {
    rb = new RadioButton(this);
    rb.setId(list_answers.get(j).getQuizz_answers_id());
    rb.setText(String.valueOf(list_answers.get(j).getQuizz_answers_id()) + "-" + String.valueOf(list_answers.size()) + "-" + String.valueOf(list_questions.get(i).getQuizz_questions_id())); // I added that to see if there was a problem on the indexes, but there's not
    rg.addView(rb, new LayoutParams(100,LayoutParams.WRAP_CONTENT));
}
tr.addView(rg, new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT)); 
```

完整的代码可以在这里找到：http: [//pastebin.com/d9zZjmuu](http://pastebin.com/d9zZjmuu)

我的问题是我可以在三个单选组中选择两个单选按钮。

我知道您很难提供帮助，因为您没有所有资源等问题出在哪里的想法将不胜感激！

感谢和抱歉我的英语不好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T16:30:05.920

我重新创建了您的问题并通过给每个 RadioButton 一个唯一的 id 来解决它，就像这样简单：

```
rb.setId(list_answers.get(j).getQuizz_answers_id() + i * list_questions.size()); 
```

我不确定*为什么*此时默认的 OnCheckedChangeListeners 会感到困惑，但这里有一个简单的解决方法。

# wpf - 修改 selecteditem 数据时，ListBox 失去更改 selecteditem 的能力

> ID：15365905
> 
> 赞同：10
> 
> 时间：2013-03-12T15:53:38.067
> 
> 标签：wpf

一两天以来，我一直试图找出一个奇怪的 WPF 错误。我有一个 ListBox 控件，它绑定到 PolicyId 的 ObservableCollection，它是一个实现 INotifyProperty 和 IEquatable 的类，并且只有一个字段，称为 Id（它是一个字符串）。PolicyId 是指向修改程序其他部分中的工作流的各种策略项的指针。

ListBox 绑定到集合，并且有一个添加和删除按钮，可以简单地将 Id 添加和删除到 ListBox。还有一个下拉 ComboBox 可用于将 ListBox 中 selectedItem 的 PolicyId 更改为另一个 Id（可供选择的 Id 在其他地方修改）。设置 ListBox.SelectedItem.Id 属性的值是在 ComboBox.SelectionChanged 事件触发时在后端完成的，并且在 ListBox.SelectionChanged 事件触发时更改 ComboBox 中的值，这样可以确保没有任何项目在ListBox 永远是相同的。

现在，这个实现在大多数情况下都有效。所有策略都列在列表框中，您可以添加新策略（在列表底部添加第一个以前未选择的可用策略）并选择和删除您喜欢的任何策略。

只要您没有使用组合框将一个策略替换为另一个策略，就是这样。一旦这样做，索引就会卡在您更改的那个上，并且您无法选择另一个策略（设置 ListBox.SelectedIndex 无效）。单击足够长的时间，最终引发以下异常：“System.ArgumentException：已添加具有相同键的项目。” 我怀疑该错误是由 WPF 试图将所选项目添加到 listBox 的“selectedItems”集合引起的，即使该项目已经存在或类似的东西。

我知道这个错误与 PolicyId 覆盖 Equals 有关（是的，我记得如果 Equals 说两个对象彼此相等，那么 GetHashCode 也应该为这两个对象返回相同的值，因此 GetHashCode 也被覆盖）因为在程序的其他地方使用了类似的设置而没有问题。我不知道这怎么搞砸了，特别是因为集合中从来没有任何重复。

这是列表框：

```
<ListBox Name="policyIdList" MinHeight="50" ItemsSource="{Binding Path=DataItem}" IsSynchronizedWithCurrentItem="True" SelectionChanged="policyIdList_SelectionChanged">
    <ListBox.Resources>
        <Style TargetType="ScrollViewer">
            <Setter Property="HorizontalScrollBarVisibility" Value="Hidden" />
        </Style>
    </ListBox.Resources>
    <ListBox.ItemTemplate>
        <DataTemplate>
            <TextBlock DataContext="{Binding Path=Id}" Text="{Binding Converter={StaticResource PolicyIdToName}}">
                <TextBlock.ToolTip>
                    <ContentControl Content="{Binding}" ContentTemplate="{StaticResource PolicyByOidListItem}" />
                </TextBlock.ToolTip>
            </TextBlock>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

而且，对于好的措施，组合框：

```
<ComboBox Name="policyIdCombo" Grid.Row="1" Grid.Column="0"
ItemTemplate="{StaticResource PolicyByOidListItem}" SelectionChanged="policyIdCombo_SelectionChanged" /> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-05-16T13:07:23.927

我认为问题在于，当您更改项目的 ID 时，您正在更改项目的哈希码，而 ListBox 并不期望这一点。[请参阅此处](http://connect.microsoft.com/VisualStudio/feedback/details/781876/items-with-changing-hashcodes-break-wpf-listview-selector-functionality-in-net-4-5-working-in-net-4-0)了解更多信息。

我刚刚将一个应用程序从 .NET 3.5 升级到 4.0 并遇到了这个问题。如果像我一样您无法使用固定的哈希码，那么解决方法是：

1.  从列表中删除要更改的对象
2.  **通知 UI 更改**
3.  更改对象的 ID（导致更改其哈希码）
4.  将您的对象添加回列表并通知 UI 更改。

# actionscript-3 - 如何在 Flash AS3 中解析日期

> ID：15365906
> 
> 赞同：3
> 
> 时间：2013-03-12T15:53:42.590
> 
> 标签：actionscript-3, flash, date, actionscript, date-format

我希望能够根据闪存中的 dd-MM-yyyy 解析我的日期，但是我不太明白。

这是我的代码：

```
 var arrivalDate = String(arrivalDateDay.text)+String(arrivalDateMonth.text)+String(arrivalDateYear.text);
    trace(arrivalDate);
    arrivalDate = Date.parse(Number(arrivalDate));
    trace(arrivalDate); 
```

第一个跟踪将显示日期，如“ddMMyyyy”，但在解析后我只得到 NaN。我也试过 trace(Number(arrivalDate));]

我希望能够解析日期的原因是我可以计算两个日期之间的天数。

谢谢，彼得

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T15:57:08.497

您需要将支持的格式传递给`Date.parse`

从[这里](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Date.html#parse%28%29)：

其他支持的格式包括：

```
 MM/DD/YYYY HH:MM:SS TZD
 HH:MM:SS TZD Day Mon/DD/YYYY 
 Mon DD YYYY HH:MM:SS TZD
 Day Mon DD HH:MM:SS TZD YYYY
 Day DD Mon HH:MM:SS TZD YYYY
 Mon/DD/YYYY HH:MM:SS TZD
 YYYY/MM/DD HH:MM:SS TZD 
```

正如文档所述，您可以省略小时分钟第二部分，而只使用日月年。现在，您在日、月和年之间传递，中间没有空格。

# javascript - 输入值更改时更新 HTML 的值

> ID：15365909
> 
> 赞同：2
> 
> 时间：2013-03-12T15:53:44.477
> 
> 标签：javascript, jquery

当其中一个因素的值发生变化时，我正在尝试更新总数。我创建了一个[jsFiddle](http://jsfiddle.net/aikaterine/dQKXt/)并对其进行了评论（第 16 行）。这可能是最容易看到问题的地方。

这是简单的总和，所以我有一个看起来像这样的表格。

```
Row 1  | 100 | 5 |
Row 2  | 200 | 10 |
Totals | 300 | 15 | 
```

第 1 行和第 2 行中的表格单元格包含文本字段。总行中的表格单元格包含 html。div / 输入的 id 和名称是自动生成的（例如，请参阅 jsFiddle 链接）。

第一次更改输入量时一切正常，但我很难将原始元素的值设置为新的总和。当我第二次更新该字段时，计算会考虑原始值 - 这会使我的总和消失。我已经尝试过 jQuery 和 javascript 方法，也尝试过使用特定的 id（不是 $(this)），但都无济于事。我是 javascript 新手，所以可能缺少一些简单的东西。

我的 javascript 看起来像这样

```
window.formTable = $('#def-inv-table');
$('input.form-text').change(function() {
  var currentId      = $(this).attr('id');
  var orgValue       = this.getAttribute('value');
  var newValue       = this.value;
  var changeAmount   = newValue - orgValue;
  var pieces         = currentId.split(/\s*\-\s*/g);
  var key            = pieces[1];
  var orgTotalString = window.formTable.find('#total-' + pieces[2]).html();
  var orgTotal       = Number(orgTotalString.replace(/[^0-9\.]+/g,""));
  var newTotal       = orgTotal + changeAmount;

  window.formTable.find('#total-' + pieces[2]).css("background", "blue");
  window.formTable.find('#total-' + pieces[2]).html(newTotal);

//Here is my problem. This is not updating. I have tried the javascript way
//with document.getElementbyId and the jQuery way. Neither sets the value.
  $(this).val(newValue);
  var testVal = $(this).val();
  //alert(testVal);
}); 
```

如果您希望我粘贴 html，请告诉我。我把它排除在外，因为它在 jsFiddle 中。

添加 HTML

```
<form name="test-form" id="test-form">
  <div id="def-inv-table">
    <table>
      <tr>
        <td>
          <input type="text" id="no-413-invreturned" name="investments[413][invreturned]" value="3000.00" class="form-text">
        </td>
        <td>
          <input type="text" id="no-413-commreturned" name="investments[413][commreturned]" value="23.42" class="form-text">
        </td>
      </tr>

      <tr>
        <td>
          <input type="text" id="no-414-invreturned" name="investments[414][invreturned]" value="1000.00" class="form-text">
        </td>
        <td>
          <input type="text" id="no-414-commreturned" name="investments[414][commreturned]" value="15.89" class="form-text">
        </td>
      </tr>
      <tr>
        <td id="total-invreturned">4,000.00</td>
        <td id="total-commreturned">39.31</td>
      </tr>
    </table>
  </div>
<form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:23:40.157

试试这个：http: [//jsfiddle.net/dQKXt/86/](http://jsfiddle.net/dQKXt/86/)

```
$('.form-text').change(function() {
    var columnIndex = $(this).parent().index() + 1;
    var sum = 0;
    $('tr td:nth-child(' + columnIndex + ')').find('input').each(function() {
        var floatValue = parseFloat($(this).val());
        $(this).val(floatValue.toFixed(2));
        sum += floatValue;        
    });    

    // here format your sum with , . etc to be the same as 4,000.00
    $('tr td:nth-child(' + columnIndex + '):last').html(sum.toFixed(2));

}); 
```

假设您想要一个带有总和行的普通表

# php - php curl没有提交按钮javascript

> ID：15365911
> 
> 赞同：-1
> 
> 时间：2013-03-12T15:53:44.777
> 
> 标签：php, javascript, curl

**我无法提交表格；！！**

```
function loginSubmit()
    {
        if(!isSubmitted){
            if(jQuery('#frmLoginStart').validationEngine('validate') != true)
                return false;
            isSubmitted = true;
            document.frmLoginStart.submit();
        }
    }   

    <form action="/esube/logon/loginend.jsp" method="post" name="frmLoginStart" id="frmLoginStart">     
                                                <input type="hidden" value="tr_TR" name="rdLng" >

<input type="text"  name="txtUsername" id="txtUsername">

<input type="password"  name="txtPassword" id="txtPassword">
    <a title="GİRİŞ" class="btnType2 button2" onclick="loginSubmit();return false;" name="btnSubmit" href="javascript:;"><span></span>GİRİŞ</a>
    </form> 
```

**卷曲错误** 卷曲提交点击链接 **没有提交按钮困难我说土耳其语请帮助**

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/19.0.2");
curl_setopt($ch, CURLOPT_COOKIEFILE, getcwd().'/cookie.txt');

curl_setopt($ch, CURLOPT_URL, "https://esube1.ziraatbank.com.tr/esube/logon/loginstart.jsp");

$postu = "rdLng=tr_TR&txtUsername=51253433&txtPassword=976035";

curl_setopt($ch, CURLOPT_URL, 'https://esube1.ziraatbank.com.tr/esube/logon/loginend.jsp'); 
```

bu nasıl bir 网站 anlamadım yazdığım kodları almıyor

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:14:57.397

最好使用事件绑定来提交表单，而不是触发它的链接。如果表单已提交并且存在验证错误，您正在尝试收集全局变量`isSubmitted`，我正确吗？

```
var isSubmitted = false;
$(document).ready(function () {
    $('form[name=frmLoginStart]').submit(function (e) {
        if ($(this).validationEngine('validate') != true) {
            e.preventDefault();
            isSubmitted = true;
        }
    });
});  

<form action="/esube/logon/loginend.jsp" method="post" name="frmLoginStart" id="frmLoginStart">     
    <input type="hidden" value="tr_TR" name="rdLng" autocomplete="off">
    <input type="text"  size="20" maxlength="10" value="" autocomplete="off" name="txtUsername" id="txtUsername">
    <input type="password" size="20" maxlength="5" autocomplete="off" name="txtPassword" id="txtPassword">
    <button type="submit" class="btnType2 button2" name="btnSubmit"><span></span>GİRİŞ</button>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:37:49.400

我认为您正在尝试自动登录到位于`https://esube1.ziraatbank.com.tr/esube/logon/loginstart.jsp?rdLng=EN`.

该登录表单使用 javascript。Curl 不执行 javascript。因此，您的方法将行不通。你至少需要一些可以执行 javascript 的东西。

PS。在发布到公共论坛之前，您可能希望剥离您银行帐户的用户 ID 和密码。

# android - ViewPager 嵌套在 ViewPager 中

> ID：15365915
> 
> 赞同：7
> 
> 时间：2013-03-12T15:53:50.593
> 
> 标签：android, animation

我真的是 android 的新手，我会很感激我的课程工作的任何帮助。

我需要去做：

1）一个Activity中的两个ViewPager（不嵌套）

2）两个ViewPager（一个ViewPager嵌套在另一个ViewPager中）

我发现了类似的问题，但我无法使用它。[ViewPager 内的 ViewPager](https://stackoverflow.com/questions/7098868/viewpager-inside-viewpager/7536735#7536735)

我添加了第一个 ViewPager，不知道下一步该做什么

```
LayoutInflater inflater = LayoutInflater.from(this); //this - context of my activity
List<View> pages = new ArrayList<View>();
View page = inflater.inflate(R.layout.activity_main, null);
//next I adding some buttons on page
pages.add(page);

page = inflater.inflate(R.layout.activity_main2, null);  //my second page
//some buttons
pages.add(page);

page = inflater.inflate(R.layout.activity_main3, null);  //my third page
//some buttons
pages.add(page);

SamplePagerAdapter pagerAdapter = new SamplePagerAdapter(pages);
ViewPager viewPager = new ViewPager(this);
viewPager.setAdapter(pagerAdapter);
viewPager.setCurrentItem(0);          
setContentView(viewPager); 
```

如果我添加 ViewPager2 并说 setContentView(viewPager2)，我失去了我的 viewPager1。我花了很多时间来解决这两个问题，请大家帮忙...

//这是我需要做的草图。抱歉，我无法附上我的草图...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-08T18:43:50.433

I added an `OnTouchListener` to the interior `ViewPager`:

```
private OnTouchListener mSuppressInterceptListener = new OnTouchListener() {

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        if(
                event.getAction() == MotionEvent.ACTION_DOWN &&
                v instanceof ViewGroup
        ) {
                ((ViewGroup) v).requestDisallowInterceptTouchEvent(true);
        }
        return false;
    }
}; 
```

This just detects ACTION_DOWN touch events on the inner `ViewPager` and prevents the outer one from intercepting it. Because it returns false, only the ACTION_DOWN event should be hit; all the other events will be ignored. You can add this listener to every element you want to "protect" from the outer `ViewPager`'s scrolling, though obviously if you want to pick up any other touch behaviour on those elements you'll need to deal with them inside the touch listener and possibly implement a better listener.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-07T13:39:38.557

我认为你应该重新考虑在另一个 viewpager 中有一个 viewpager。触摸事件会有很多问题，而且用户体验可能会令人困惑/棘手，我建议你重新考虑一下。

现在针对问题 1：

在活动的 xml 文件 (/layout/activity.xml) 中声明两个 viewpagers，例如：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <android.support.v4.view.ViewPager
            android:id="@+id/viewpager1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"/>

    <android.support.v4.view.ViewPager
            android:id="@+id/viewpager2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"/>

</LinearLayout> 
```

然后在您的活动的 onCreate 方法上膨胀 xml 并连接两个视图页面：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity);

    mViewpager1 = (ViewPager) findViewById(R.id.viewpager1);
    mViewpager2 = (ViewPager) findViewById(R.id.viewpager2);
} 
```

不要忘记声明这两个变量`private ViewPager mViewpager1, mViewpager2;`

然后你可以用 mViewpager1 和 mViewpager2 做任何你想做的事。还有一个提示，我建议您使用适配器来设置页面，而不是手动将它们一一添加到每个视图页面，这样操作起来会更干净，更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-07T18:18:44.103

关于拥有嵌套 Viewpager 并禁用嵌套 Viewpager 滑动的解决方案（如果您想在嵌套中设置带有按钮的选定页面）

对于嵌套的 You SubClass ViewPager 并添加以下内容：

```
 public boolean onInterceptTouchEvent(MotionEvent event) {
        //if you want to send the Touches to this Viewpager (the nested) //change true to false
      return true;    
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        // Never allow swiping to switch between pages on this inner 

        //send swipe to father instead of child
        if (this.getParent()!=null &&  this.getParent() instanceof ViewPager) {
            ((ViewPager) this.getParent()).onTouchEvent(event);
        }
        return false;
    } 
```

在布局中你把这个：

```
<com.mypackage.mycustomapp.myviews.MyViewPager
            android:id="@+id/myNestedviewpager"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-27T20:30:26.033

2.  将单个 viewPager 与`ConcatAdapter`

```
//sample usage
val strings = listOf("a", "b", "cde", "f", "g", "h")
viewPager.adapter = ConcatAdapter(
   strings.partition({ string -> string.length > 1 }, { string -> string.split("") })
     //{{a, b}, {c, d, e}, {f, g, h}}
      .map { StringAdapter(it) }.toList() 
)

/**
 * custom partition function as kotlin List extension
 */

fun <E> List<E>.partition(shouldFlatten: (e: E)->Boolean, flatten: (e: E)->List<E>) : List<List<E>>{
   val partitions = mutableListOf<List<E>>()
   var currentPartition = mutableListOf<E>()
   val listIterator = this.listIterator()
   while (listIterator.hasNext()) {
      val next = listIterator.next()
      if (shouldFlatten(next)) {
         if (currentPartition.isNotEmpty()) {
            partitions.add(currentPartition)
            currentPartition = mutableListOf()
         }
         partitions.add(flatten(next))
      } else {
         currentPartition.add(next)
      }
   }
   if (currentPartition.isNotEmpty()) {
      partitions.add(currentPartition)
   }
   return partitions
} 
```

# javascript - emberjs (1.0rc1) 嵌套路由，但在父级时呈现默认子路由

> ID：15365917
> 
> 赞同：4
> 
> 时间：2013-03-12T15:53:51.860
> 
> 标签：javascript, ember.js, url-routing, ember-router

我有一个 ember 应用程序，其主页显示两个链接：“登录”和“请求邀请”。

每个链接都转到父 ( `index`) 路由下的嵌套路由，渲染到`{{outlet}}`该`index`路由中。它是这样工作的：

*   `/`: 渲染`index`到应用程序出口
*   `/sign_in`: 渲染索引的东西然后渲染`index/sign_in`到索引模板的出口
*   `/request_invite`: 渲染索引的东西然后渲染`index/request_invite`到索引模板的出口

这很好用，但我想做的是`index`默认情况下将“登录”模板呈现到插座中。所以上面的第一个项目符号会变成这样：

*   `/`: 渲染`index`到`{{outlet}}` *并*渲染`index/sign_in`到索引模板的出口

**模板**

```
<script type="text/x-handlebars" data-template-name="application">
  <h1>application</h1>
  {{#linkTo "index"}}index{{/linkTo}}
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name='index'>
  <h2>index</h2>
  {{#linkTo "index.sign_in"}}Sign in{{/linkTo}}
  |
  {{#linkTo "index.request_invite"}}Request Invite{{/linkTo}}
  {{outlet}}
</script>

<script type="text/x-handlebars" data-template-name='index/sign_in'>
  <h3>index/sign_in</h3>
</script>

<script type="text/x-handlebars" data-template-name='index/request_invite'>
  <h3>index/request_invite</h3>
</script> 
```

**路线**

```
App = Ember.Application.create();

App.Router.map(function() {
  this.resource("index", function() {
    this.route("sign_in");
    this.route("request_invite");
  });
}); 
```

这是一个[带有上述代码的 jsbin](http://jsbin.com/isodas/3/edit)。

首次加载时，它不显示`index/sign_in`or`index/request_invite`模板。我会`index/sign_in`默认显示该模板。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T16:01:07.477

您可以显式声明 IndexRoute 并实现[重定向挂钩：](http://emberjs.com/guides/routing/redirection/)

```
App.IndexRoute = Ember.Route.extend({
  redirect : function(){
    this.transitionTo("index.sign_in");
  }
}); 
```

**更新：使用其他命名的路由然后索引（[JS Bin Link](http://jsbin.com/isodas/9/edit)）**

```
App = Ember.Application.create();

App.Router.map(function() {
  this.resource("main", function() {
    this.route("sign_in");
    this.route("request_invite");
  });
});
App.IndexRoute = Ember.Route.extend({
  redirect : function(){
    this.transitionTo("main");
  }
})
App.MainIndexRoute = Ember.Route.extend({
  redirect : function(){
    this.transitionTo("main.sign_in");
  }
}); 
```

# ruby-on-rails - 在 turbolink 之后保持引导模式窗口打开

> ID：15365920
> 
> 赞同：1
> 
> 时间：2013-03-12T15:53:54.587
> 
> 标签：ruby-on-rails, twitter-bootstrap, ruby-on-rails-4, turbolinks

我正在使用 twitter bootstrap 打开模式窗口而不使用 JavaScript：

在我的 www.domain.com/item/1 我有

```
<a data-toggle="modal" class="btn btn-custom" data-target="#myModal" >Add to list</a> 
```

这会触发以下模式：

```
<div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
              <h3 id="myModalLabel">Add to list</h3>
            </div>
            <div class="modal-body">
              <table>
<% @my_lists.each do |list| %>
    <tr>
      <td><%= list.name %></td>
      <td>
          <% if Listing.exists?(:item_id => @item.id, :list_id => list.id) %>
                <i class="icon-check"></i>  
          <% else %>
              <%= link_to listing_list_path(:item =>@item.id, :list=> list.id) do %>
                    <i class="icon-check-empty"></i>    
              <% end %>
          <% end %>
        </td>
       </tr>
    <% end %>
</table>
            </div>
            </div> 
```

在我的控制器中：

```
def listing
  @item = Item.find(params[:item])
  @list = List.find(params[:list])
  @list.add_item(@item)
  redirect_to [:back]
end 
```

当我单击列出该项目时，它会正确列出，但页面会返回

www.domain.com/item/1

模式窗口关闭。我希望它保持模式打开。我试过重定向到 www.domain.com/item/1#myModal 但这不起作用。

我正在使用启用了 Turbolinks 的 rails4。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:15:58.353

这可能是因为您没有阻止锚标记上的默认行为。

尝试添加此 JavaScript 以查看它是否有效

```
$('a[data-toggle=modal]').click (e) -> e.preventDefault() 
```

# database - 预定义和自定义项目

> ID：15365927
> 
> 赞同：0
> 
> 时间：2013-03-12T15:54:06.753
> 
> 标签：database, database-design, entity, relational-database

我有以下数据库：

```
project (id, name, color, ...)
unit (id, name, width, height, ...) 
```

*   每个项目由一个或多个单元组成
*   每个单元属于一个项目（与项目1:N关系）

现在是困难的部分：

保存了预定义的单位，我们可以简单地选择（具有固定的名称/宽度/高度）：

*   一个预定义的单元可以在多个项目中
*   一个项目可以有多个预定义单元（与项目的 M:N 关系）
*   预定义单元是单元的子类型（泛化）
*   备注：如果一个项目已经存在并且有一些默认单位，我不想更改单位设置中的任何值，以防我将来编辑默认单位的默认属性。

由于最后一部分，我无法找到一种合适且可行的方法来设计数据库。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T20:43:25.517

我认为您需要有一个单独的结构来保存预定义的单元，称为`templates`. `project`使用这种方法，通过将数据*复制*到 中，将预定义的单位分配给 a `units`。

无论如何都有一个标志或其他东西将`units`其标识为*预定义*，因此不能更改。

# php - 在php中转储数组，如何从数组中检索值

> ID：15365933
> 
> 赞同：1
> 
> 时间：2013-03-12T15:54:28.337
> 
> 标签：php

```
var_dump($products); 
```

输出：`array(7) { [0]=> array(5) { ["Product"]=> array(40) { ["id"]=> string(3) "726" ["wbb"]=> string(1) "1" ["abb"]=> string(1) "0" }`

但是当我这样做时，`var_dump($products['Product']['wbb']);`它给了我 NULL

我将如何使用 ["wbb"] 的值

```
if(!empty($product)) : 
```

如果我转储 $product，它会给我不同的产品以及每种产品的详细信息。
当我转储 $product 时，一种产品的简单输出

```
array(7) { [0]=> array(5) { ["Product"]=> array(40) { ["id"]=> string(3) "726" ["wbb"]=> string(1) "1" ["abb"]=> string(1) "0" }

{ [1]=> array(5) { ["Product"]=> array(40) { ["id"]=> string(3) "727" ["wbb"]=> string(1) "0" ["abb"]=> string(1) "1" } 
```

同样，我还有 10 种产品，其中一些是 wbb = 1，其中一些是 abb =1。我想根据提出的标志添加工具提示。但是当我喜欢这个 $i++;

```
if(!empty($product[$i]['Product']['wbb'])){ echo code here.....} 
```

因为它会迭代，所以它不会根据确切的产品给我。我应该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T15:55:43.243

看起来你应该使用`var_dump($products[0]['Product']['wbb']);`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T15:56:21.587

如果仔细观察，您会注意到该`$products`数组是一个多维数组，每个数据行都有一个数字键（从 0 开始）。任何额外的行都会得到 1、2 等等。为了获得`wbb`第一行（显然是唯一的）的上述值，请使用

```
var_dump($products[0]['Product']['wbb']); 
```

反而。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T15:56:47.870

`$products`是多个产品的数组。你应该使用：

```
var_dump($products[0]['Product']['wbb']); 
```

# python - 读取 Excel 文件并仅使用特定文件

> ID：15365940
> 
> 赞同：0
> 
> 时间：2013-03-12T15:54:53.570
> 
> 标签：python, excel, printing, xlrd

在我过去的问题中，我说过我是 python 新手。我只在工作中使用过一次。再说一次，我必须为工作做一个小项目。

我必须阅读一个 excel 文件，在那个 excel 文件中，有 3 列（col1、col2、col3）。大约有 100 行。

col1 有 2 个值 A 和 B。col2 的值范围仅为 1 - 10。 col3 有很多不同的值。

但我希望我的 python 程序查看 col1 中的每个不同值，然后查看 col2 中的每个不同值，然后计算 col3 的所有相应值的平均值。

希望输出看起来像这样：

```
A - 1 = 2.3
A - 2 = 6.2
A - 3 = 5.7
etc. etc.
B - 1 = 3.5
B - 2 = 4.1
B - 3 = 8.1
etc. etc. 
```

我知道，有很多问题要问，但到目前为止我已经做到了：

```
import xlrd #import package

#opening workbook and reading first sheet
book = xlrd.open_workbook('trend.xls')
sheet = book.sheet_by_index(0)

#print sheet name, number of rows and columns
#print sheet.name #print sheet name
#print sheet.nrows #print number of rows
#print sheet.ncols #print number of colums

#print cellname along with value in for loop
for row_index in range(sheet.nrows):
    for col_index in range(sheet.ncols):
        print xlrd.cellname(row_index,col_index),'-',
        print sheet.cell(row_index,col_index).value 
```

它开始打印每个单元格中的所有值，以及名称等。但后来我意识到它并没有做它应该做的事情。而且我找不到有关如何执行此操作的适当教程。

如果你们有任何建议，我将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:09:19.920

试试这个：

```
import xlrd

book = xlrd.open_workbook('trend.xls')
sheet = book.sheet_by_index(0)

unique_combinations = {}

for row_index in range(sheet.nrows):
    cell_1 = sheet.cell(row_index, 0)
    cell_2 = sheet.cell(row_index, 1)
    cell_3 = sheet.cell(row_index, 2)
    unique_combo = (cell_1.value, int(cell_2.value))
    if unique_combinations.has_key(unique_combo):
        unique_combinations[unique_combo].append(cell_3.value)
    else:
        unique_combinations[unique_combo] = [cell_3.value]

for k in unique_combinations.keys():
    values = unique_combinations[k]
    average = sum(values ) / len(values )
    print '%s - %s = %s' % (k[0], k[1], average) 
```

# android - 可绘制概念问题

> ID：15365942
> 
> 赞同：-2
> 
> 时间：2013-03-12T15:55:00.263
> 
> 标签：android, android-layout, android-drawable

我是android新手，我只有一个关于drawable概念的查询：- **“如果我把我项目的所有图像都放在一起——Drawable-hdpi、Drawable-mdpi、Drawable-ldpi，获取的图像是否会自动在屏幕尺寸和密度的基础”**。或者在所有可绘制的图像中制作多个图像副本没有任何意义..??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:00:12.953

这个概念是这样的：Android 可以并且会根据屏幕尺寸和像素密度放大/缩小图像，但它可能并不完美，而且这个过程会消耗计算能力。如果您使用照片编辑程序*正确地*创建更小/更大的照片，就像您想要的那样，您将获得更好的结果，并且您会更快地获得它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:02:51.563

[http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)。链接中的 android 文档提供了有关为 drawable 提供替代资源的详细信息。

我还找到了一个链接，其中接受的答案对该主题有很好的解释。[解释 drawable、drawable-ldpi、drawable-mdpi 和 drawable-hdpi 之间的区别](https://stackoverflow.com/questions/6373085/explain-the-difference-between-drawable-drawable-ldpi-drawable-mdpi-and-drawab)。

安卓系统根据屏幕大小和密度获取可绘制对象。如果您没有为每个密度提供特殊的可绘制对象，Android 将自动缩放最接近的可用对象。在某些设备上缩放可绘制对象可能看起来很奇怪。所以最好根据屏幕大小和密度提供不同的drawable。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:04:08.957

是的，这就是它根据将要获取的屏幕尺寸的工作原理，根据您设计应用程序的方式，图形资产有不同的方法，以下是不同文件夹的计算：

```
xlarge screens are at least 960dp x 720dp
large screens are at least 640dp x 480dp
normal screens are at least 470dp x 320dp
small screens are at least 426dp x 320dp
Generalised Dpi values for screens:

ldpi Resources for low-density (ldpi) screens (~120dpi)
mdpi Resources for medium-density (mdpi) screens (~160dpi). (This is the baseline density.)
hdpi Resources for high-density (hdpi) screens (~240dpi).
xhdpi Resources for extra high-density (xhdpi) screens (~320dpi).
Therefore generalised size of your resources (assuming they are full screen):

ldpi
Vertical = 426 * 120 / 160 = 319.5px
Horizontal = 320 * 120 / 160 = 240px
mdpi
Vertical = 470 * 160 / 160 = 470px
Horizontal = 320 * 160 / 160 = 320px
hdpi
Vertical = 640 * 240 / 160 = 960px
Horizontal = 480 * 240 / 160 = 720px
xhdpi
Vertical = 960 * 320 / 160 = 1920px
Horizontal = 720 * 320 / 160 = 1440px

px = dp*dpi/160 
```

另外，如果您使用opengl或surfaceview或类似的东西在屏幕上绘图，您可以在assets文件夹中制作一个图像副本并在绘制时拉伸到屏幕，并将您的图标存储在drawable文件夹中，根据方式不同有不同的方法你设计你的应用程序就是我想说的

# php - session_destroy(); 在使用 php 5.3.21 的服务器上无法正常工作

> ID：15365944
> 
> 赞同：0
> 
> 时间：2013-03-12T15:55:08.200
> 
> 标签：php, mysql

对不起，如果这是一个冗长的帖子，但我需要问这个问题。好吧，我已经在几台服务器上尝试过这段代码，但它不能正常工作！

到目前为止，我一直在尝试将我的 PHP 脚本从 mysql 更改为 mysqli，但失败多于成功。

注册表工作正常，它会将记录添加到 mysql 数据库，并且它也会向用户发送一封电子邮件，没有任何错误。我在我的所有页面上都有这个，以确保我没有收到任何错误：

```
<?php 
error_reporting(E_ALL);
ini_set('display_errors', '1');
?> 
```

登录表单也可以正常工作，它将用户登录到他们的帐户。

但这是问题，以及我一直面临的几个问题。

1-页面顶部有一个简单的顶部链接，如果用户未登录，它将显示登录和注册，一旦他们登录，它将显示他们的用户名和注销链接。这似乎有自己的想法在一台服务器上工作，在另一台服务器上不起作用。通过工作，我的意思是即使用户已登录，它也会在一台服务器上保持登录和注册链接。

2- 有一个 logout.php 文件应该注销用户并结束会话。但这又有了自己的想法。在较旧的 PHP 服务器上它可以正常工作，但是如果我再次刷新用户帐户 URL 上的页面，它会自动将用户重新登录。我在哪个浏览器中尝试以及清除缓存的次数都没有关系和饼干。它仍然会在页面刷新时将用户重新登录到帐户中。

此外，logout.php 文件在 php 版本 5.3.21 的服务器上不起作用，并且不会将用户从他们的帐户中注销！！

这是 member.php 代码：

```
<?php 
error_reporting(E_ALL);
ini_set('display_errors', '1');
?>
<?php
session_start(); // Must start session first thing
// See if they are a logged in member by checking Session data
$toplinks = "";
if (isset($_SESSION['id'])) {
    // Put stored session variables into local php variable
    $userid = $_SESSION['id'];
    $username = $_SESSION['username'];
    $toplinks = '<a href="member.php?id=' . $userid . '">' . $username . '</a> &bull; 
    <a href="member.php">Account</a> &bull; 
    <a href="logout.php">Log Out</a>';
} else {
    $toplinks = '<a href="join_form.php">Register</a> &bull; <a href="login.php">Login</a>';
}
?>
<?php
// Use the URL 'id' variable to set who we want to query info about
$id = preg_replace("[^0-9]", "", $_GET['id']); // filter everything but numbers for security
if ($id == "") {
    echo "Missing Data to Run";
    exit();
}
//Connect to the database through our include 
include_once "config/connect.php";
// Query member data from the database and ready it for display
$sql = "SELECT * FROM members WHERE id='$id' LIMIT 1";
$query = mysqli_query($db_conx, $sql);
$count = mysqli_num_rows($query);
if ($count > 1) {
    echo "There is no user with that id here.";
    exit(); 
}
while($row = mysqli_fetch_array($query, MYSQLI_ASSOC)){
$username = $row["username"];
$_SESSION['username'] = $username;
$userid = $row["id"];
$_SESSION['id'] = $userid;
// Convert the sign up date to be more readable by humans
$signupdate = strftime("%b %d, %Y", strtotime($row['signupdate']));
}
?> 
```

这是 logout.php 文件：

```
<?php
session_start(); 
session_destroy();
if( isset($_SESSION['id'])){ 
header("location: index.php");
} else {
exit('<h2>Could not log you out, sorry the system encountered an error.</h2>');
} 
?> 
<html>
<body>
<?php echo "$msg"; ?><br>
<p><a href="index.php">Click here</a> to return to our home page </p>
</body>
</html> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:00:23.537

session_destroy() 不会破坏会话变量。您可以使用“$_SESSION = array();” 如果你想这样做。此致

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-01-31T13:17:33.103

尝试：

```
session_destroy();
session_write_close(); 
```

# iphone - 为什么我的 nsurl 请求没有显示在控制台中？

> ID：15365945
> 
> 赞同：1
> 
> 时间：2013-03-12T15:55:13.380
> 
> 标签：iphone, ios, uiwebview, nsurlconnection

我正在尝试让重定向的 url 显示在控制台中。我可能在代码中的某个地方遗漏了一个小细节。任何帮助都会受到重视。

```
- (void)viewDidLoad {
 UIWebView *webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 119,     self.view.bounds.size.width, self.view.bounds.size.height - 165)];
webView.backgroundColor = [UIColor whiteColor];
//    webView.userInteractionEnabled = NO;
webView.opaque = NO;
[webView loadHTMLString:self.item.description baseURL:[NSURL URLWithString:self.item.link]];
[self.view addSubview:webView];
webView.delegate = self;
}

 - (NSURLRequest *)connection:(NSURLConnection *)connection
         willSendRequest:(NSURLRequest *)request
        redirectResponse:(NSURLResponse *)redirectResponse
{
//Make sure tinyurl is doing the redirection
if([[[redirectResponse URL] host] compare:@"bitly.com"
                                  options:NSCaseInsensitiveSearch] == NSOrderedSame)
{
    NSLog(@"Redirect Location: %@", [request URL]);
}

//call [connection cancel]; to cancel the redirect and stop receiving data
//return nil; to cancel redirect but continue receiving data
//return request; will continue the redirection as normal
    return request;
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:01:41.410

您正在使用[NSURLConnectionDelegate](http://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/connection%3awillSendRequest%3aredirectResponse%3a)的委托方法，它不是正确的方法`UIWebView`

您没有加载任何请求，`UIWebView`您希望`NSLog`如何打印出请求？如果您使用的是[UIWebViewDelegate](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html)，那么检查您的情况的正确方法应该是：

```
- (BOOL)webView:(UIWebView*)webView shouldStartLoadWithRequest:(NSURLRequest*)request navigationType:(UIWebViewNavigationType)navigationType  {

  NSLog(@"Redirect Location: %@",[request.URL absoluteString]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T16:00:01.220

```
- (NSURLRequest *)connection:(NSURLConnection *)connection
         willSendRequest:(NSURLRequest *)request
        redirectResponse:(NSURLResponse *)redirectResponse 
```

那不是 UIWebView 委托方法。因此，除非您没有显示所有代码，否则它永远不会被调用。

您需要创建一个 NSURLConnection 以像这样利用该调用。

```
NSURLConnection *connection = [NSURLConnection connectionWithRequest:request delegate:self]; 
```

# linq - C# Linq SelectMany，返回整个对象

> ID：15365950
> 
> 赞同：2
> 
> 时间：2013-03-12T15:55:22.133
> 
> 标签：linq, silverlight-5.0, generic-collections

我有这样的课：

```
public class FileCollection:ObservableCollection<IUserFile>. 
```

在课堂上，我想根据名称列表获取集合的子集。

我想它会是这样的：

```
List<IUserFile> selectedFiles = new List<IUserFile>;
foreach(string s in names)  
{  
    var matchingFiles = this.SelectMany(userFile => userFile.Name.Equals(s));  
    foreach(IUserFile uf in matchingFiles)  
    {  
        selectedFiles.Add(uf);    
    }  
 } 
```

在这一点上，我遇到了 Select 或 SelectMany 调用的问题；编译器错误消息没有那么有用。
任何有关如何从集合中提取子集的建议将不胜感激......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:57:32.600

使用 a[`Where`](http://msdn.microsoft.com/en-GB/library/bb534803.aspx)代替 - “根据谓词过滤一系列值” - 这样：

```
var matches = this.Where(userFile => userFile.Name.Equals(s)); 
```

而不是[`SelectMany`](http://msdn.microsoft.com/en-gb/library/bb534336.aspx)，它“将序列的每个元素投影到 IEnumerable 并将结果序列展平为一个序列。”

# html - CSS嵌套和悬停

> ID：15365951
> 
> 赞同：-5
> 
> 时间：2013-03-12T15:55:23.713
> 
> 标签：html, css, hover

我有以下 HTML

```
<li>
    <div>
         <div>
          ..
          ...
          <span class="A">text</span>
         </div>
   </div>
</li> 
```

当我使用 CSS 将鼠标悬停在 li 元素上时，如何更改文本的颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:56:49.840

尝试这个：

```
li:hover span.A {
   color: red;
} 
```

[例子](http://jsfiddle.net/x9WNc/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:58:46.000

这应该可以解决问题：

```
li:hover span.A {
    color: red;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T16:01:25.463

像这样：

```
li:hover .A
{
    color: red;
} 
```

如这里所示：http: [//jsfiddle.net/rZCwr/](http://jsfiddle.net/rZCwr/)

# c# - 找不到带有 xmlns 前缀的静态资源？

> ID：15365954
> 
> 赞同：2
> 
> 时间：2013-03-12T15:55:27.530
> 
> 标签：c#, wpf

鉴于下面的“部分”xaml：

```
<UserControl x:Class="MyProject.Views.SelectTestView"
             xmlns="http://schemas.microsoft.com etc... etc..."
             xmlns:converters="clr-namespace:MyProject.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="566" d:DesignWidth="1160">

<GridViewColumn Header="Status" Width="auto">
    <GridViewColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding StatusTypeName}"
                       Foreground="{Binding StatusTypeName, Converter={StaticResource StatusTypeNameToBrushConverter}}"/>
        </DataTemplate>
    </GridViewColumn.CellTemplate>
</GridViewColumn> 
```

我的转换器类“StatusTypeNameToBrushConverter.cs”在我上面声明的“转换器”命名空间中。当我在静态资源前面加上我的 xmlns 别名时，我仍然收到警告

> “找不到资源“StatusTypeNameToBrushConverter””。

我添加到前缀/解析我的静态资源的代码如下所示。

```
Foreground="{Binding StatusTypeName, Converter={StaticResource converters:StatusTypeNameToBrushConverter}}"/> 
```

为什么这是错误的，我需要添加什么来限定位置以便可以找到我的转换器？转换器代码旨在帮助转换由此 xaml 组成的视图。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:07:51.087

您必须包括：

```
<UserColtrol.Resources>
   <converters:StatusTypeNameToBrushConverter x:Key="statusTypeNameToBrushConverter"/>
</UserColtrol.Resources> 
```

静态资源是这样的：

```
Foreground="{Binding StatusTypeName, Converter={StaticResource statusTypeNameToBrushConverter}}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:18:33.523

您正在引用 StaticResource，但尚未定义任何内容。你可以这样做：

```
<UserControl x:Class="MyProject.Views.SelectTestView"
             xmlns="http://schemas.microsoft.com etc... etc..."
             xmlns:converters="clr-namespace:MyProject.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="566" d:DesignWidth="1160">
<UserControl.Resources>
        <ResourceDictionary>
           <converters:StatusTypeNameToBrushConverter x:Key="StatusTypeNameToBrushConverter" />
        </ResourceDictionary>
    </UserControl.Resources> 
```

然后像第一次一样使用它：

```
Converter={StaticResource StatusTypeNameToBrushConverter} 
```

# recommendation-engine - 大数据推荐系统

> ID：15365956
> 
> 赞同：2
> 
> 时间：2013-03-12T15:55:31.917
> 
> 标签：recommendation-engine, sparse-matrix, collaborative-filtering

我正在使用真实的用户数据实现电影推荐系统。我打算采用协同过滤的方法。然而，这种方法通常涉及存储用户评分电影的巨大矩阵。因为我有一万多部电影和十万用户。我不可能创建如此巨大的稀疏矩阵。不知道大家是怎么用这么大的数据实现协同过滤的？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T10:16:41.163

我会向您推荐分布式计算框架，但是，我认为仍然具有您可以在一台机器上轻松处理它的规模。

[Apache Mahout](http://mahout.apache.org)包含 Taste 协同过滤库，旨在在一台机器上进行扩展。一个模型——什么，10M 数据点？-- 应该以健康的堆大小放入内存中。看看 和 之类的`GenericItemBasedRecommender`东西`FileDataModel`。

（Mahout 也有基于 Hadoop 的分布式实现，但我认为你还不需要这个。）

我是那篇文章的作者，但后来开始将大规模推荐器商业化为[Myrrix](http://myrrix.com)。它还包含一个独立的单机版本，它是免费和[开源](http://myrrix.com/download/)的。它还可以在一台机器上轻松处理这么多的数据。例如，这是一个比[本示例](http://myrrix.com/example-performance/)中使用的数据集更小的数据集。Myrrix 也有一个分布式实现。

除了上述之外，还有其他快速*分布式实现，例如*[GraphLab](http://graphlab.org/)。其他非分布式框架也可能足够快，例如[MyMediaLite](http://mymedialite.net/)。

我建议只使用其中之一，或者如果您真的只是想知道它“如何”发生，请查看源代码并查看数据表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T19:36:40.677

我没有使用矩阵形式来存储我的数据。相反，我使用 C++ 并构建一些结构，例如 User、Rating、Item，其中包含我需要的变量和数组。这可能会增加算法的复杂性，但可以有效地节省内存。

# java - 复制特定的数组元素

> ID：15365960
> 
> 赞同：-3
> 
> 时间：2013-03-12T15:55:44.403
> 
> 标签：java, arrays, copy

我需要将特定元素从数组复制到新数组。例如：一个 Fruits 数组中包含苹果和橙子，我只想从中获取苹果到一个名为 Apples 的新数组中。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:04:40.840

全部在伪代码中：

你可以做的第一件事：

```
Fruit[] oArray = ....;
int noOfApple = 0;

for each Fruit f in oArray {
  if (f is apple) {
    noOfApple++;
  }
}

Fruit[] newArray = new Fruit[noOfApple];

int index = 0;
for each Fruit f in oArray {
  if (f is apple) {
    newArray[index++] = f;
  }
} 
```

好吧，因为您正在显式创建新数组，所以您必须先找出大小，然后才能实际创建新数组。为了使它更容易，你可以做类似的事情

```
List<Fruit> newFruits = new ArrayList<Fruit>();
for each Fruit f in oArray {
  if (f is apple) {
    newFruits.add(f);
  }
}
Fruit[] newArray = newFruits.toArray(); 
```

我认为提示应该已经绰绰有余

如果您想做一些更酷的事情，请尝试使用 Guava。您可以执行以下操作（大部分代码都是实际的，带有一些伪代码）：

```
Fruit[] result = 
  Iterables.filter(Array.asList(oArray), 
                   new Predicate<Fruit>(){
                     @Override
                     boolean apply(Fruit f) { return (f is apple);}
                   })
           .toArray(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T16:03:13.950

您可以使用`instanceof`运算符来检查水果是否是苹果。之后，只需对数组进行迭代，将所选元素添加到另一个数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T16:02:13.770

我建议使用 ArrayList。使用 ArrayList，您可以向其中动态添加项目。

```
for (int i = 0; i < fruits.size(); i++)
{
  if (fruits.get(i) instanceof apple)
     apples.add(fruits.get(i));
} 
```

如果你还想要一堆苹果。`Apple[] arrayOfApples = apples.ToArray();`

# php - file_get_contents 函数。它的路径是否支持反转目录？

> ID：15365964
> 
> 赞同：0
> 
> 时间：2013-03-12T15:55:52.460
> 
> 标签：php

基本上

```
file_get_contents('test.php') 
```

完美运行。然而，

```
file_get_contents('/../test.php') 
```

结果是`"file_get_contents(/../xx.php) [function.file-get-contents]: failed to open stream: No such file or directory"`

目录结构正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T15:58:05.423

你说目录结构是正确的，但读起来还是很奇怪：

```
file_get_contents('/../test.php') 
```

你确定它不应该如下没有前导斜杠：

```
file_get_contents('../test.php') 
```

# php - Zend Framework 2 - 重定向器动作助手

> ID：15365967
> 
> 赞同：0
> 
> 时间：2013-03-12T15:56:00.737
> 
> 标签：php, redirect, action, zend-framework2

我已经用谷歌搜索了很长一段时间，但无法为我的问题找到一个可行的解决方案。

当访问我的网站时，用户会看到一个登录屏幕。我`ZFCUser`将用户转发到我的应用程序/索引操作。从那里我想要一个“联结”，它将普通用户重定向到一个操作，并将后端/管理员用户重定向到另一个操作。

ZF1里好像有这个`Redirector`帮手……？

有人知道实现我想做的事情的方法吗？或者也许告诉我一种更 Zend-y 的方式来做到这一点？:)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:17:48.373

您可以在您的操作中使用重定向控制器插件，如下所示：

```
return $this->redirect()->toRoute('user-page'); 
```

user-page 是定义路由的键

或者

```
return $this->getController()->redirect()->toUrl("http://www.mysite.com"); 
```

# dust.js - 使用 Dust.js 从未编译的模板渲染部分

> ID：15365972
> 
> 赞同：0
> 
> 时间：2013-03-12T15:56:09.137
> 
> 标签：dust.js

我可以做类似的事情：

```
<script type="text/template" id="header">
  yo
</script>

<script type="text/template" id="body">
  {>"header"/}
  whats up
</script>

<script>
  // I'm just citing a backbone example...
  this.z = 'x';
  dust.loadSource(dust.compile($('#body').html(),this.z));
  dust.render(this.z, null, function(err, out) {
    _self.$el.html(out);
  });
</script>

<script src="dust-full-1.2.0.js"></script> 
```

是否可以在不预编译部分的情况下以类似的方式渲染部分？

使用时是否有一种递归方式来预编译依赖的部分`dust.render()`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T14:24:44.880

没有丹，你需要编译所有的模板。因为灰尘会在灰尘的缓存中寻找模板。因此，如果您不编译部分并将其加载到缓存中（使用 loadsource），它将找不到它。我一直在使用带有灰尘的骨干，并且我使用了一个 nodejs 脚本，当我保存它们时会自动编译我的所有模板。你可以在这里看到它：[https ://github.com/dmix/dusterjs](https://github.com/dmix/dusterjs)

# python - Python，根据调用者改变函数行为，有可能吗？

> ID：15365974
> 
> 赞同：0
> 
> 时间：2013-03-12T15:56:15.637
> 
> 标签：python, design-patterns

在这个 Python 代码片段中：

```
def get_something():
    return something

def do_staff():
    value = get_something()
    doit(value)

def test():
    # ?????
    doStaff() 
```

`get_something`根据 if 被调用来更改返回值的最佳方法是`test or not`什么？唯一的限制是我不想修改`do_staff`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:07:46.080

## 回答您提出的问题

您要么需要一个可选参数来更改函数的行为。这意味着您**还**需要一个可选参数 in `do_staff`，因为这里真正的问题是如何判断从（或其他地方）`get_something`调用的位置：`do_staff``test`

```
def get_something(test=False):
    if test:
        return something + test_var
    return something

def do_staff(test=False):
    value = get_something(test=test)
    return doit(value)

def test():
    return do_staff(test=True) 
```

如果你真的，真的因为某种原因反对修改`do_staff`，你将不得不查看堆栈以查看测试方法是否在上面，正如评论中提到的那样——但这很快就会变得丑陋。否则，判断函数如何被调用的唯一方法是传递一个指标。

## 实际解决您的问题

不过，从上下文来看，**我认为您真正想要**的是知道如何测试这个东西，而不必在测试/生产环境之间修改太多代码。在这种情况下，我会建议一种完全不同的方法：与其尝试查看您是否是从某个地方被调用的，不如定义/导入一个`is_debug_on`变量并使用它。

```
is_debug_on = False

def get_something():
    if is_debug_on:
        pass # Do testing stuff, print statements, etc.
    return something # Do normal stuff.

def do_staff():
    value = get_something()

def test():
    is_debug_on = True
    do_staff()
    is_debug_on = False 
```

显然，如果您可以将它们全部放在一个类中，或者使用`logging`包等，这会更干净，但这是基本思想。您可以通过这种方式测试您的所有代码，而不必在进入生产环境时删除任何内容，因为调试模式将被关闭。**奖励**：当生产中出现问题时，您将能够重新打开调试并（希望）立即获得一些有用的信息！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T15:59:09.353

可选参数？

```
def get_something(from_test=False):
    if from_test:
        return something_test
    else:
        return something

def test():
    get_something(True) 
```

# jquery - 无法弄清楚为什么 jQuery UI 1.10 在使用选项卡时既不尊重 ajaxSettings.error 也不尊重 jqXHR.fail

> ID：15365979
> 
> 赞同：1
> 
> 时间：2013-03-12T15:56:21.477
> 
> 标签：jquery, html, jquery-ui

我将 jQuery UI 库升级到 1.10 版本。根据文档，下面的代码假设可以工作，但事实并非如此。请告诉我是否是我在某处犯了错误，或者他们的新 jQuery UI 库只是充满了错误。

如果您想实时尝试下面的代码，我设置了[测试链接。](http://cl-t029-082cl.privatedns.com/public/test.html)

这些选项卡将提取以下 JSON 字符串：

对于“GOOD Json”选项卡：

```
{
 "html":"This is HTML text from good Json",
 "msgWarning":"This is message text from good Json",
 "msgSuccess":"","misc":[]
} 
```

对于“坏 Json”选项卡：

```
{
 "html":"This is HTML text from bad Json",
 "msgWarning":"This is message text from bad Json",
 "msgSuccess":"","misc":[]
}blablabla 
```

您会注意到“JSON Good”选项卡加载得很好。由于 JSON 格式错误，“JSON Bad”选项卡将永远不会加载。在以前的 jQuery UI 版本中，我使用 ERROR 设置来捕获此类错误。但是无论我尝试什么，新代码都不会触发这个错误。

```
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.10.1/themes/base/jquery-ui.css">

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>
</head>

<body style="padding: 10px 10px 10px 10px;" >

<script type="text/javascript">
    function myprofileShow()
    {
        $("#tabs-myProfile").show();
        $("#tabs-myProfile").tabs();
        $('<li><a href="http://cl-t029-082cl.privatedns.com/public/json-good.html">JSON Good</a></li>').appendTo("#tabs-myProfile .ui-tabs-nav");
        $('<li><a href="http://cl-t029-082cl.privatedns.com/public/json-bad.html">JSON BAD</a></li>').appendTo("#tabs-myProfile .ui-tabs-nav");
        $("#tabs-myProfile").tabs("refresh");
        $("#tabs-myProfile").tabs('destroy');

        $("#tabs-myProfile").tabs({
            beforeLoad: function( event, ui ) {
                ui.panel.html('working...');

                ui.ajaxSettings.dataType = "json";

                ui.ajaxSettings.dataFilter = function(data) {
                    var jsonData = $.parseJSON(data);
                    return  jsonData.msgWarning + jsonData.html;
                };

                ui.jqXHR.done(function(data, textStatus, jqXHR) {
                    //do nothing
                });

               ui.ajaxSettings.error = function(jqXHR, textStatus) {
                    ui.panel.html('<b>Something went wrong test 1</b>');
                };

                ui.jqXHR.error(function() {
                    ui.panel.html('<b>Something went wrong test 2</b>');
                });

                ui.jqXHR.fail(function(jqXHR) {
                    ui.panel.html('<b>Something went wrong test 3</b>');
                });
            }
        });

        $("#tabs-myProfile").tabs({selected: 1});
    }
</script>

<div id="tabs-myProfile" style="display: none;">
    <ul>
    </ul>
</div>

<div>
    <script type="text/javascript">
    myprofileShow();
    </script>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T18:16:58.033

我认为dataFilter()函数应该理解为 [这里解释的：](http://api.jquery.com/jQuery.ajax/)

> 用于处理 XMLHttpRequest 的原始响应数据的函数。这是一个预过滤函数，用于清理响应。您应该返回经过清理的数据。

似乎此函数中的代码超出了 Ajax 异常处理的范围，而是在控制台上抛出异常：查看控制台显示：

> 未捕获的 SyntaxError：意外的令牌 b

这是由您的代码行触发的：

```
var jsonData = $.parseJSON(data); 
```

我假设当您摆脱 dataFilter 函数并让 jQuery*隐式*处理 JSON 解析（当您的 dataType 设置为 'json' 时应该自动发生）然后 Ajax 异常处理（通过 error() / fail() ）将按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-15T13:36:22.680

看[这里](http://wadewalkeronline.com/post/2013/05/29/jQuery-UI-110-Tabs-Dynamically-load-User-Control.aspx)。

```
$("#MainContent_contentArea").tabs({
activate: function (event, ui) {
    if (ui.newPanel.is(':empty')) {
        ui.newPanel.append("<div class='tab-loading'>...Loading...<br /><img src='Images/ajax-loader.gif' /></div>");
    };
}
, show: {
    efect: 'slideDown',
    duration: 500
}
, beforeLoad: function (event, ui) {
    alert('beforeLoad');
    ui.ajaxSettings.accepts = { json: "application/json, text/javascript" };
    ui.ajaxSettings.contentType = "application/json; charset=utf-8";
    ui.ajaxSettings.type = "POST";
    ui.ajaxSettings.dataTypes[0] = "json";

    ui.jqXHR.setRequestHeader("Content-Type", ui.ajaxSettings.contentType);

    ui.jqXHR.error(function (data) { alert('error'); alert(data.status + ' - ' + data.statusText) });
    ui.jqXHR.success(function (data) { alert('success'); alert(data) });
} 
```

});

# actionscript-3 - 如何重新启动 AS 类动画

> ID：15365981
> 
> 赞同：1
> 
> 时间：2013-03-12T15:56:23.257
> 
> 标签：actionscript-3, flash, oop, air, main

我想在完成动画后删除并重新添加/“重新启动” Main 类。我所有的动画都发生在 Main 中，并被添加到 Main 中的显示树中。Program.as 通过添加/删除 Main 来处理所有这些。如何`finishNow()`在 Main.as 中运行该函数？一切正常，除了引发错误`program.finishNow();`：

TypeError：错误＃1009：无法访问空对象引用的属性或方法。

.fla 文件：

链接到 Program.as。

Program.as 文件：

```
package  {

    import flash.display.MovieClip;

    public class Program extends MovieClip {

        public function Program() {

            startNow();
        }

        function startNow() {
            var run:Main = new Main(this);
            addChild(run);
        }

        function finishNow() {
            removeChild(run);
            var run:Main = new Main(this);
            addChild(run);
        }

    }

} 
```

Main.as 文件：

```
package {

    import flash.display.Sprite;

    public class Main extends Sprite
    {

        var stageHolder:Object;
        public var program:Program;

        public function Main(stageHolderTemp) {
            stageHolder = stageHolderTemp; 
            trace(stageHolder);

            someFunctionsThatDrawGraphics();
        }

        function callFinishFunction():void {
            // how to call finishNow() function from Program.as file here?
            program.finishNow();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T16:12:06.600

你应该有你的`run`变量类范围，而不是函数范围。

```
package  {
    import flash.display.MovieClip;
    public class Program extends MovieClip {
    var run:Main; // <- THIS line
        public function Program() {
            startNow();
        }
        function startNow() {
            run = new Main(this); // and no 'var' here
            addChild(run);
        }
        function finishNow() {
            removeChild(run);
            run = new Main(this); // also no 'var' here
            addChild(run);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T14:04:15.957

`TypeError: Error #1009: Cannot access a property or method of a null object reference.`可以在下面找到修复程序。以前，该类指向一个空对象。

```
package {

    import flash.display.Sprite;

    public class Main extends Sprite
    {

        // var stageHolder:Object; <- REMOVE this line
        public var program:Program;

        public function Main(stageHolderTemp) {
            program = stageHolderTemp; // changed stageHolder to program
            trace(program); // changed stageHolder to program

            someFunctionsThatDrawGraphics();
        }

        function callFinishFunction():void {
            program.finishNow();
        }

    }
} 
```

# c++ - “弱”原子操作？

> ID：15365983
> 
> 赞同：6
> 
> 时间：2013-03-12T15:56:27.103
> 
> 标签：c++, stl, c++11, atomic

在新`C++11`标准中，许多原子操作以“强/弱”对定义：

```
template< class T >
bool atomic_compare_exchange_weak( std::atomic<T>* obj, 
                                   T* expected, T desired );
template< class T >
bool atomic_compare_exchange_weak( volatile std::atomic<T>* obj, 
                                   T* expected, T desired ); 
```

我知道较弱的可能更快，但偶尔可能会失败，因此需要将其放入`while`如下循环（取自 cppreference）：

```
void append(list* s, node* n)
{
    node* head;
    do {
        head = s->head;
        n->next = head;
    } while(! std::atomic_compare_exchange_weak(s->head, head, n));
} 
```

**但**

1.  弱操作到底是做什么的？为什么它们有时会失败，为什么它们更快？（我会喜欢一些核心微处理器架构细节。）

2.  什么时候推荐弱形式，什么时候推荐强形式？

# ruby-on-rails - RMagick 面具回形针图像附件

> ID：15365984
> 
> 赞同：1
> 
> 时间：2013-03-12T15:56:27.340
> 
> 标签：ruby-on-rails, paperclip, rmagick

我正在使用 Paperclip 将图像文件附加到一个对象上，一切都很好，但我还想在上传时屏蔽（最好只有一种图像样式 - main_feature）图像。我可以使用保存我的蒙版图像，`masked_image.write('result.png')`但似乎无法让它更新回形针的图像属性。使用以下代码，我收到此错误：

```
No handler found for /var/folders/q1/xf59whv514lgw_xr10hb208m0000gn/T/gaither-nomask20130312-80235-yaj1s7.png PNG 1020x470 1020x470+0+0 DirectClass 8-bit 
```

```
has_attached_file :image,
  :styles =>{
  :main_feature => "1020x470",
  :top_feature => "345x159",
  :smallest => "229x131"
},
:storage => :s3,
:s3_credentials => "#{Rails.root}/config/s3.yml",
:path => ":attachment/:id/:style.:extension",
:url => "/:id/:style/:basename.:extension",
:bucket => "bucketname"

after_image_post_process :post_process_image

def post_process_image
  require 'rubygems'
  require 'RMagick'
  require "open-uri"

  mask = Magick::ImageList.new  
  urlimage = open("http://bucket.s3.amazonaws.com/mask.png")
  mask.from_blob(urlimage.read)

  imgfile = Magick::Image.read(image.queued_for_write[:original].path).first

  mask.matte = true
  imgfile.matte = true

  masked_image = imgfile.composite(mask, Magick::CenterGravity, Magick::CopyOpacityCompositeOp)
  self.update_attribute(:image, masked_image)

end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:58:44.283

经过一些试验和错误后，我最终编写了一个回形针处理器：

模型：

```
:styles =>{
   :main_feature => {:geometry => "1020x470", :processors => [:masker] },
   :top_feature => "345x159",
   :smallest => "229x131"
} 
```

/lib/paperclip_processors/masker.rb：

```
module Paperclip
 class Masker < Processor
  def initialize file, options = {}, attachment = nil
    super
    @format = File.extname(@file.path)
    @basename = File.basename(@file.path, @format)
  end

 def make  

  src = @file
  dst = Tempfile.new([@basename, @format])
  dst.binmode

  begin
    parameters = []

    parameters << ':source'
    parameters << ':mask'
    parameters << '-alpha'
    parameters << 'on'
    parameters << '-compose'
    parameters << 'CopyOpacity'
    parameters << '-composite'
    parameters << ':dest'

    parameters = parameters.flatten.compact.join(" ").strip.squeeze(" ")

    mask_path = File.expand_path('lib/paperclip_processors/mask.png')
    success = Paperclip.run("convert", parameters, :source => "#{File.expand_path(src.path)}[0]", :mask => "#{mask_path}[0]", :dest => File.expand_path(dst.path))

     rescue PaperclipCommandLineError => e
       raise PaperclipError, "There was an error during the mask for #{@basename}" if @whiny
     end

     dst
   end

  end
 end 
```

# wordpress - get_template_directory() 不返回任何内容

> ID：15365991
> 
> 赞同：1
> 
> 时间：2013-03-12T15:56:42.693
> 
> 标签：wordpress, wordpress-theming

我第一次做一些自定义主题工作，我想使用

```
<?php get_template_directory(); ?>/main.css 
```

访问 CSS 文件。但是，当它在 html 中呈现时，它呈现为：

```
/main.css 
```

我可能删除了 Wordpress 用于派生此路径的任何设置或选项。Wordpress 使用什么逻辑来确定模板目录是什么？

作为测试，我添加了以下代码：

```
DIRS:

Plugins
<?php plugins_url(); ?>
<?php plugin_dir_url(); ?>
<?php plugin_dir_path(); ?>
<?php plugin_basename(); ?>
Themes
<?php get_template_directory_uri(); ?>
<?php get_stylesheet_uri(); ?>
<?php get_theme_root_uri(); ?>
<?php get_theme_root(); ?>
<?php get_theme_roots(); ?>
Site Home
<?php home_url(); ?>
WordPress
<?php admin_url(); ?>
<?php site_url(); ?>
<?php content_url(); ?>
<?php includes_url(); ?>
<?php wp_upload_dir(); ?>
Multisite
<?php get_admin_url(); ?>
<?php get_home_url(); ?>
<?php get_site_url(); ?>
<?php network_admin_url(); ?>
<?php network_site_url(); ?>
<?php network_home_url(); ?> 
```

它呈现为：

```
DIRS:
Plugins
Themes
Site Home
WordPress
Multisite 
```

所以很明显，我搞砸了一些 Wordpress 需要确定它的目录。但是我在 Google 中找不到任何关于 Wordpress 如何提供这些路径的信息，而且源代码对我来说也不明显。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T16:03:38.720

[`get_template_directory`](http://codex.wordpress.org/Function_Reference/get_template_directory) *返回*一个字符串。[它不回显该字符串](http://core.trac.wordpress.org/browser/tags/3.5.1/wp-includes/theme.php#L256)。对于以`get_`. 尝试：

```
<?php echo get_template_directory(); ?>/main.css 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-19T11:11:31.310

根据您的计划，您还可以使用：

```
<?php bloginfo('template_url'); ?> 
```

# proxy - 代理服务定义需要“名称”属性

> ID：15365993
> 
> 赞同：1
> 
> 时间：2013-03-12T15:56:48.620
> 
> 标签：proxy, wso2, wso2esb, synapse

我在 WSO2ESB 中部署一些代理配置时遇到问题。当我复制代理配置文件时，即使是像示例 151 这样的一些 Apache Synapse 示例，我也会收到此错误：“代理服务定义需要 'name' 属性”。

```
The full stack trace is as follows:

wso2esb-4.6.0/repository/deployment/server/synapse-configs/default/proxy-services/synapse_sample_151.xml failed - Continue in fail-safe mode
org.apache.synapse.SynapseException: The 'name' attribute is required for a Proxy service definition
    at org.apache.synapse.config.xml.ProxyServiceFactory.handleException(ProxyServiceFactory.java:369)
    at org.apache.synapse.config.xml.ProxyServiceFactory.createProxy(ProxyServiceFactory.java:79)
    at org.apache.synapse.deployers.ProxyServiceDeployer.deploySynapseArtifact(ProxyServiceDeployer.java:58)
    at org.wso2.carbon.proxyadmin.ProxyServiceDeployer.deploySynapseArtifact(ProxyServiceDeployer.java:73)
    at org.apache.synapse.deployers.AbstractSynapseArtifactDeployer.deploy(AbstractSynapseArtifactDeployer.java:172)
    at org.apache.axis2.deployment.repository.util.DeploymentFileData.deploy(DeploymentFileData.java:136)
    at org.apache.axis2.deployment.DeploymentEngine.doDeploy(DeploymentEngine.java:810)
    at org.apache.axis2.deployment.repository.util.WSInfoList.update(WSInfoList.java:144)
    at org.apache.axis2.deployment.RepositoryListener.update(RepositoryListener.java:377)
    at org.apache.axis2.deployment.RepositoryListener.checkServices(RepositoryListener.java:254)
    at org.apache.axis2.deployment.RepositoryListener.startListener(RepositoryListener.java:371)
    at org.apache.axis2.deployment.scheduler.SchedulerTask.checkRepository(SchedulerTask.java:59)
    at org.apache.axis2.deployment.scheduler.SchedulerTask.run(SchedulerTask.java:67)
    at org.wso2.carbon.core.deployment.CarbonDeploymentSchedulerTask.runAxisDeployment(CarbonDeploymentSchedulerTask.java:67)
    at org.wso2.carbon.core.deployment.CarbonDeploymentSchedulerTask.run(CarbonDeploymentSchedulerTask.java:112)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:351)
    at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:178)
    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:178)
    at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:722) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T10:12:27.170

问题是，如果您直接将代理配置部署到“代理”文件夹位置，proxy.xml 和代理服务名称应该相同。但是如果您尝试使用代理编辑器创建代理，您只需提供名称，然后系统将自动创建与代理服务名称相同的 proxy.xml

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T10:15:47.643

deploy into repository/deployment/server/default/synapseconfig/proxy and make sure all the necessary endpoints and sequences deployed into this

# jsf - 从枚举动态包含JSF中的文件？

> ID：15365995
> 
> 赞同：1
> 
> 时间：2013-03-12T15:56:53.473
> 
> 标签：jsf, enums, include, switch-statement, facelets

我想在一个类型之间切换，该类型在我的 Bean 中设置为枚举以动态包含 .xhtml 文件。

我有我的对象设备类型：

```
public static enum Type {
    Android, iOS, WP7, Windows, Blackberry;
} 
```

在这里我想动态包含不同的 .xhtml 文件：

```
<ui:include src="./preview/WelcomePreviewAndroid.xhtml" />
<ui:include src="./preview/WelcomePreviewiOS.xhtml" />
<ui:include src="./preview/WelcomePreviewBlackberry.xhtml" /> 
```

这应该取决于设备中设置的类型：

```
#{skinningBean.currentDevice.type} 
```

如何实现 switch 语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T16:08:07.687

使用渲染属性，您可以设置是否应显示项目。因为 不包含任何渲染属性，所以您必须用另一个 div 将其包围，例如：

```
<h:panelGroup layout="block" rendered="#{skinningBean.currentDevice.type == 'android'}">
    <ui:include src="./preview/WelcomePreviewAndroid.xhtml" />
</h:panelGroup> 
```

# gruntjs - gruntjs grunt-init grunfile 抛出错误致命错误：path.join 的参数必须是字符串

> ID：15365996
> 
> 赞同：5
> 
> 时间：2013-03-12T15:56:57.030
> 
> 标签：gruntjs

我正在尝试使用 gruntjs 0.4 建立一个新项目。我已经卸载了 0.3 并安装了 grunt-cli 并导入了 grunt-init gruntfile。当我运行“grunt-init gruntfile”时，它的运行方式与 0.3 中的运行方式相同，询问正常问题

> 请回答以下问题：[?] DOM 是否以任何方式参与？(Y/n) y [?] 文件会被连接或缩小吗？(Y/n) y [?] 你会有 package.json 文件吗？(Y/n) y [?] 在继续之前，您需要对上述内容进行任何更改吗？(是/否) n

但是在回答完所有问题后，我得到了错误

> 致命错误：path.join 的参数必须是字符串

有没有其他人处理过类似的事情，或者你能指出我正确的调试方向吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T20:09:27.510

这是由 Node 0.10.0 中的更改引起的错误，今天早些时候已[修复](https://github.com/gruntjs/grunt/commit/c6f83ca060e46a0e94160cd64e57cc80aa23917d)。即将发布。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T13:57:16.817

我刚刚更新了 grunt 和 grunt-cli

```
npm 安装 grunt-cli
.
.
.
npm 安装咕噜声

```

这为我解决了

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-14T20:08:29.287

如果您使用的是“凉亭”（网络包管理器），我遇到了同样的问题，当尝试安装 Angular 时，它变成了凉亭库错误。我像下面一样单独运行凉亭构建

```
bower install angular 
```

然后我选择了正确的版本，它对我有用。