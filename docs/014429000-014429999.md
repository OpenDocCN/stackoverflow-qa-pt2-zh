# StackOverflow 问答 14429000-14429999

# php - 从ajax返回值，返回给它的JS函数

> ID：14429009
> 
> 赞同：0
> 
> 时间：2013-01-20T20:37:39.230
> 
> 标签：php, javascript, ajax

这就是问题所在。

我有`HTML Form`，它有一个`submit`带有`onclick=validationFunction()`. 当我单击此按钮时，表单中的值将转到此功能。

现在，在这个函数中，检查表单的值`enter code here`是否`enter code here`正确。此外，它有 1 个`input Field`必须检查以进行验证，并且还从数据库中再次检查以查看那里存在的值。这部分是通过`ajax`. 在 ajax 调用下面，有一个`(boolen)`function的返回值`validationFucntion()`。

现在，我想要什么。我想要这两件事中的任何一件。

1) ajax 应在其内返回 true 或 false`success`

2) 或者 ajax 应该在 ajax 调用结束的地方发送值。到目前为止，我在做这两件事时都失败了。

这是一个示例伪代码。

```
 function validationFunction()
{

     validations checks in progress
     $.ajax({
     url:'checkIfNumberExists.php',
     data : {
             'number : num //this num is coming from above
            },

     method:'GET',
     success: function(data)
            {
                console.log("Return Value = "+this.toReturn);
                if(  (this.toReturn) > 0 )
                {
                     either return validationFunction from here or set a flag.
                }
                else
                {
                     either return validationFunction from here or set a flag.
                }

     });
} 
```

checkIfNumberExists.php

```
<?php

$num = $_GET['number'];
$toReturn = 0 ;

$queryCheckNo = mysql_query('SELECT * FROM `TABLE` WHERE `number_from_table`="'.$num.'" ');

while($row = mysql_fetch_assoc($queryCheckNo)){
    $toReturn++;
}
echo ($toReturn);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:44:02.520

试试这个插件

```
<script>
    // wait for the DOM to be loaded
    $(document).ready(function() 
    {
        // bind 'myForm' and provide a simple callback function
       $("#tempForm").ajaxForm({
       url:'../calling action or servlet',
       type:'post',
       beforeSend:function()
       {
         alert("perform action before making the ajax call like showing spinner image");
       },
       success:function(e){
        alert("data is"+e);
            alert("now do whatever you want with the data");
       }
       });
    });
</script> 
```

并将其保存在您的表格中

```
<form id="tempForm" enctype="multipart/form-data">
<input type="file" name="" id="" />
</form> 
```

[你可以在这里](http://www.malsup.com/jquery/form/#download)找到插件

# php - 使链接无需 http 即可点击

> ID：14429015
> 
> 赞同：2
> 
> 时间：2013-01-20T20:37:52.630
> 
> 标签：php, html

我制作了这个使用 XML 文件存储新闻条目的网站。所以基本上一个人会将他的姓名、日期和内容“提交”到文件中，然后我使用 DOM 和 for 循环来打印主页中的条目。

无论如何，我计划为发布部分添加 WYSIWYG 编辑器，但现在他们被迫使用“a”标签来使链接可点击。问题是我注意到以 http:// 开头的链接有效，但以 www 开头的链接。没有。有没有办法使用'a'标签使两者都工作？

我还是网络开发的新手，所以我想知道是否有人可以帮助我。

```
$doc->load('entries.xml');
$newsArray = $doc->getElementsByTagName ('entry');

for($i = $newsArray->length; $i > 0; $i--)
{               

$ent = $newsArray->item ($i-1); 

$title = $ent->childNodes->item (1)->nodeValue;
$message = $ent->childNodes->item (2)->nodeValue;
$name = $ent->childNodes->item (3)->nodeValue;
$date = $ent->childNodes->item (4)->nodeValue;

if (get_magic_quotes_gpc()) {

   $message1 = stripslashes($message);
}
else {
    $message1 = $message;
}

echo "<div id='newsSec'>";
echo "<p></p>";
echo "<div class='newsTitle'> <b> $title </b> </div>";
echo "<div class='newsMessage'> " .nl2br($message1) ."</div>";
echo "<div class='newsName'> <b>Posted by:</b> $name <b>$date</b> </div>";
echo "</div>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:41:40.423

将双斜杠附加到 URL 的开头。它将采用与主机页面本身相同的协议

```
<a href="//www.google.com">...</a> 
```

**参考**：[协议相关链接：rfc1808](http://www.ietf.org/rfc/rfc1808.txt)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T20:40:29.800

`$message1 = "http://".$message1;`在 s之前添加`echo`。这将`http://`在链接输出的前面添加。

# c# - 我可以通过 WebClient 阅读 iframe（我想要外部 html）吗？

> ID：14429023
> 
> 赞同：0
> 
> 时间：2013-01-20T20:38:34.233
> 
> 标签：c#, browser, html-parsing, webclient

好吧，我的程序正在读取一个 Web 目标，该目标在正文的某处有我想要阅读的 iframe。

**我的html源**

```
<html>
...
<iframe src="http://www.mysite.com" ></iframe>
...
</html> 
```

在我的程序中，我有一个方法将源作为字符串返回

```
public static string get_url_source(string url)
{
   using (WebClient client = new WebClient())
   {
       return client.DownloadString(url);
   }
} 
```

我的问题是我想在读取源代码时获取 iframe 的源代码，就像在正常浏览中一样。

我只能通过使用[**WebBrowser 类**](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)来做到这一点，还是有办法在 WebClient 甚至另一个类中做到这一点？

**真正的问题：** 我怎样才能得到给定网址的外部 html？欢迎任何方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T20:44:07.247

获取网站源码后，可以使用[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)获取iframe的url

```
HtmlAgilityPack.HtmlDocument doc = new HtmlAgilityPack.HtmlDocument();
doc.LoadHtml(html);

var src = doc.DocumentNode.SelectSingleNode("//iframe")
            .Attributes["src"].Value; 
```

然后打第二个电话`get_url_source`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T20:41:35.023

[使用HTML Agility Pack](http://htmlagilitypack.codeplex.com/)解析您的源代码，然后：

```
List<String> iframeSource = new List<String>();

HtmlDocument doc = new HtmlDocument();
doc.Load(url);

foreach (HtmlNode node in doc.DocumentElement.SelectNodes("//iframe"))
    iframeSource.Add(get_url_source(mainiFrame.Attributes["src"])); 
```

如果您的目标是单个 iframe，请尝试使用 ID 属性或其他内容来识别它，以便您只能检索一个来源：

```
String iframeSource;

HtmlDocument doc = new HtmlDocument();
doc.Load(url);

foreach (HtmlNode node in doc.DocumentElement.SelectNodes("//iframe"))
{
    // Just an example for check, but you could use different approaches...
    if (node.Attributes["id"].Value == 'targetframe')
        iframeSource = get_url_source(node.Attributes["src"].Value);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T17:07:06.260

好吧，经过一番搜索，我找到了答案，这就是我想要的

```
webBrowser1.Url = new Uri("http://www.mysite.com/");
while (webBrowser1.ReadyState != WebBrowserReadyState.Complete) Application.DoEvents();
string InnerSource = webBrowser1.Document.Body.InnerHtml; 
                            //You can use here OuterHtml too. 
```

# html - HTML：日志框控件？

> ID：14429036
> 
> 赞同：-2
> 
> 时间：2013-01-20T20:39:36.077
> 
> 标签：html, controls, edit

我希望在 HTML 页面中包含其中之一。

![这东西](../Images/2d6df77663891c72c8cff04ac5c58dd1.png)

F12 开发人员工具将此称为`wmd-edit`控件。我想这需要一些额外的库（wmd）。

我希望有这样的东西*（*不使用某些库）填满整个页面，并且只读..这可能吗，还是我必须使用库？

我对试验 HTML 很陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:06:08.750

您可以使用`<textarea>`. 有关演示，请参见[http://jsfiddle.net/7YVZX/ 。](http://jsfiddle.net/7YVZX/)

# java - ImageView.setOnTouchListener 没有检测到长动作

> ID：14429037
> 
> 赞同：0
> 
> 时间：2013-01-20T20:39:38.960
> 
> 标签：java, android, imageview

我想用 ImageView 制作一个操纵杆。用户将触摸视图并移动“棒”。

```
ivjoystick.setOnTouchListener(new View.OnTouchListener() {          
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            touch(event);
            return true;
        }
    }); 
```

当用户触摸视图时调用 touch 方法，检测到事件并且操纵杆按需要工作。一旦手指离开“起点”，就不再调用 onTouch 方法（在手指移动时）。欢乐者冻结了。

此行为与 touch 方法的作用无关。但是，这是它的代码：

```
private void touch(MotionEvent event) {
    if (!(event.getAction() == MotionEvent.ACTION_DOWN || event.getAction() == MotionEvent.ACTION_MOVE || event.getAction() == MotionEvent.ACTION_UP))
        return;
    double oldx = x;
    double oldy = y;

    x = (event.getX() - centerx) / rpad;
    y = (event.getY() - centery) / rpad;

    if (Math.sqrt(x * x + y * y) > 1) {
        x /= Math.sqrt(x * x + y * y);
        y /= Math.sqrt(x * x + y * y);
    }

    if (event.getAction() == MotionEvent.ACTION_UP) {
        x = 0;
        y = 0;
    }

    if (SystemClock.uptimeMillis() - last < minintervall && event.getAction() == MotionEvent.ACTION_MOVE)
        return;

    if (oldx != x || oldy != y) {
        draw();
        send();
    }

    return;     
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:58:38.270

我认为您需要将触摸方法连接到 ondraglistener

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T14:03:41.893

ImageView 在 ScrollView 中。滚动视图以某种方式采取了较长的运动进行滚动。

我删除了滚动视图。

# java - 没有这样的表问题

> ID：14429038
> 
> 赞同：0
> 
> 时间：2013-01-20T20:39:43.670
> 
> 标签：java, android, sqlite

我正在尝试查询数据库中第二个表的数据。

我能够插入数据库（或被引导相信它是成功的）

我已经更改了版本号，但这似乎仍然有效。

谁能看到我在这里做错了什么？

目前我收到以下错误：

日志猫：

```
01-20 20:32:15.076: E/AndroidRuntime(303): FATAL EXCEPTION: main
01-20 20:32:15.076: E/AndroidRuntime(303): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.flybase2/com.example.flybase2.ViewAppointments}: android.database.sqlite.SQLiteException: no such table: appointmentTable: , while compiling: SELECT _id, app_name, app_type, app_time, app_date, app_comments FROM appointmentTable ORDER BY app_name ASC
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.os.Handler.dispatchMessage(Handler.java:99)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.os.Looper.loop(Looper.java:123)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.ActivityThread.main(ActivityThread.java:4627)
01-20 20:32:15.076: E/AndroidRuntime(303):  at java.lang.reflect.Method.invokeNative(Native Method)
01-20 20:32:15.076: E/AndroidRuntime(303):  at java.lang.reflect.Method.invoke(Method.java:521)
01-20 20:32:15.076: E/AndroidRuntime(303):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
01-20 20:32:15.076: E/AndroidRuntime(303):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
01-20 20:32:15.076: E/AndroidRuntime(303):  at dalvik.system.NativeStart.main(Native Method)
01-20 20:32:15.076: E/AndroidRuntime(303): Caused by: android.database.sqlite.SQLiteException: no such table: appointmentTable: , while compiling: SELECT _id, app_name, app_type, app_time, app_date, app_comments FROM appointmentTable ORDER BY app_name ASC
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteCompiledSql.native_compile(Native Method)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteCompiledSql.compile(SQLiteCompiledSql.java:91)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteCompiledSql.<init>(SQLiteCompiledSql.java:64)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:80)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:46)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:42)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1345)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteDatabase.queryWithFactory(SQLiteDatabase.java:1229)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1184)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.database.sqlite.SQLiteDatabase.query(SQLiteDatabase.java:1301)
01-20 20:32:15.076: E/AndroidRuntime(303):  at com.example.flybase2.DBHandler.getAppointmentsData(DBHandler.java:325)
01-20 20:32:15.076: E/AndroidRuntime(303):  at com.example.flybase2.ViewAppointments.onCreate(ViewAppointments.java:34)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-20 20:32:15.076: E/AndroidRuntime(303):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627) 
```

列变量：

```
 public static final String KEY_ROWAPPID = "_appid";
public static final String KEY_NAMEAPP = "app_name";
public static final String KEY_TYPEAPP = "app_type";
public static final String KEY_TIMEAPP = "app_time";
public static final String KEY_DATEAPP = "app_date";
public static final String KEY_COMMENTAPP = "app_comments";
public static final String KEY_ALARM = "app_alarm"; 
```

表名和版本：

```
private static String DATABASE_TABLEAPP = "appointmentTable";
private static int DATABASE_VERSIONAPP = 1; 
```

这是我的创建方法：

```
 @Override
    public void onCreate(SQLiteDatabase db) {

        db.execSQL("CREATE TABLE " + DATABASE_TABLE + " (" +
                KEY_ROWID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                KEY_NAME + " TEXT NOT NULL, " +
                KEY_TEL + " TEXT NOT NULL, " +
                KEY_EMAIL + " TEXT NOT NULL, " +
                KEY_COMMENTS + " TEXT NOT NULL);"

                );

        db.execSQL("CREATE TABLE " + DATABASE_TABLEAPP + " (" +
                KEY_ROWAPPID + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
                KEY_NAMEAPP + " TEXT NOT NULL, " +
                KEY_TYPEAPP + " TEXT NOT NULL, " +
                KEY_TIMEAPP + " TEXT NOT NULL, " +
                KEY_DATEAPP + " TEXT NOT NULL, " +
                KEY_COMMENTAPP + " TEXT NOT NULL, " +
                KEY_ALARM + " BOOLEAN NOT NULL);"

                ); 
```

升级时：

```
@Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
        onCreate(db);

        db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLEAPP);
        onCreate(db);
    } 
```

查询表的方法：

```
 public Cursor getAppointmentsData() {
        String [] columns = new String[]{KEY_ROWAPPID, KEY_NAMEAPP, KEY_TYPEAPP, KEY_TIMEAPP, KEY_DATEAPP, KEY_COMMENTAPP};
        Cursor c = ourDatabase.query(DATABASE_TABLEAPP, columns, null, null, null, null, KEY_NAMEAPP + " ASC", null);
        return c; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:19:01.240

挂断第一个`onCreate( db )`电话。

```
@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE);
    db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLEAPP);
    onCreate(db);
} 
```

# mysql - 如何直接从 MySQL 查询中获取两个总和的百分比？

> ID：14429041
> 
> 赞同：0
> 
> 时间：2013-01-20T20:39:55.400
> 
> 标签：mysql

我首先使用以下查询计算数据库中男性和女性的百分比：

```
SELECT sum(case when `gender` = 'M' then 1 else 0 end) as male
     , sum(case when `gender` = 'F' then 1 else 0 end) as female
FROM userinfo 
WHERE id in (10,1,5) 
```

然后在php中我计算百分比。但我想知道，有没有办法直接从查询中获取百分比？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:45:17.187

```
SELECT sum(case when `gender` = 'M' then 1 else 0 end) as male
     , 100*sum(case when `gender` = 'M' then 1 else 0 end)/count(*) as malepct
     , sum(case when `gender` = 'F' then 1 else 0 end) as female
     , 100*sum(case when `gender` = 'F' then 1 else 0 end)/count(*) as femalepct
FROM userinfo 
WHERE id in (10,1,5) 
```

...假设您没有在空行集上运行它（除以零）

如果您想用 -1 替换无效（除以零）值，请使用

```
if(ifnull(count(*),0)>0,100*sum(case when `gender` = 'M' then 1 else 0 end)/count(*),-1) as malepct 
```

# java - 如何使用单个构建器构建多个对象？

> ID：14429043
> 
> 赞同：4
> 
> 时间：2013-01-20T20:40:02.187
> 
> 标签：java, effective-java

这个直接来自 Effective java 2。我不确定第 2 项中的这个陈述是什么意思

> Builder 模式很灵活。单个构建器可用于构建多个对象。构建器的参数可以在对象创建之间进行调整以改变对象。

我无法想出一个例子来做到这一点。请通过一个例子帮助我理解这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T21:23:33.547

[这篇](http://blog.netopyr.com/2012/01/24/advantages-of-javafx-builders/)博文提供了 JavaFX 2 API 使用的构建器对象的一个​​很好的示例。

> 单个构建器可用于构建多个对象。

builder 对象负责构造一个有效的对象，但是在调用该**方法****之前不会构造该对象。`build()`**这意味着可以多次使用同一个构建器来构建完全不同的对象。

**例子：**

```
final TextBuilder builder = TextBuilder.create()

final Text text1 = builder
    .text("Hello World!")
    .x(50).y(50)
    .fill(Color.WHITE)
    .font(MY_DEFAULT_FONT)
    .build();

final Text text2 = builder
    .text("Goodbye World!")
    .x(50).y(100)
    .fill(Color.WHITE)
    .font(MY_DEFAULT_FONT)
    .build(); 
```

这可以根据您想要创建不同的对象多次执行。只是为了重申在`build()`调用方法之前不会创建对象这一点，请考虑您可以执行以下操作：

```
final Text text1 = TextBuilder.create()
    .text("Hello World!")
    .text("Goodbye World!")
    .text("Hello There!")
    .build(); 
```

这将导致创建一个对象，文本设置为“Hello There”，因为这是`build()`调用方法之前的属性值。

> 构建器的参数可以在对象创建之间进行调整以改变对象。

下面的示例演示了这一点。

```
// Set the properties that are common to all objects.
final TextBuilder builder = TextBuilder.create()
    .x(50)
    .fill(Color.WHITE)
    .font(MY_DEFAULT_FONT);

// Use the builder to construct different objects that have the 
// properties set above as well as the additional ones set here.
final Text text1 = builder.text("Hello World!").y(50).build();
final Text text2 = builder.text("Goodbye World!").y(100).build();
final Text text3 = builder.text("JavaFX is fun!").y(150).build(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T20:52:08.687

如果你想建造你需要的房子：墙壁、地板、楼梯、窗户……当你创建一个 HouseBulder 类时，你可以在你的 HousBuilder 类中创建所有这些对象。因此，“想要房子的用户”不必知道对象：墙壁、地板……以及必须按什么顺序建造。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T22:18:13.970

构建器模式构建一个复杂对象（一个复杂对象是许多对象的组合，它一个一个地构建每个对象）并最终返回复杂对象。

一个物体的建造应该是非常通用的。“Micho”给出了一个非常好的房屋建造例子。您必须以这样一种方式制作 HouseBuilder 类，即任何新的 HouseBuilder 对象都可以与其他 HouseBuilder 对象不同。即一个人想在他家里面建造有楼梯的房子，而另一个人想要他的房子里面没有楼梯。所以你的复杂对象应该是非常通用的。

# jquery - Jquery Mobile 滚动拖拽

> ID：14429046
> 
> 赞同：1
> 
> 时间：2013-01-20T20:40:08.927
> 
> 标签：jquery, jquery-mobile, scroll

我想要实现的是在带有溢出的 div 中进行拖动滚动：隐藏。我正在制作棋盘游戏，希望客户端在手持设备上拖动滚动游戏板，如在 wordfeud 等中。我尝试了 kinect 插件，它可以完成这项工作，唯一的问题是我不允许点击，因为它会处理它作为拖累。有没有人基尔有一个很好的修复或其他方式来实现这一目标？如果缺少任何细节，请原谅。写电话。

提前致谢。乔纳斯

# mysql - Rails localtime 返回错误的时区

> ID：14429055
> 
> 赞同：0
> 
> 时间：2013-01-20T20:40:52.007
> 
> 标签：mysql, ruby-on-rails-3, datetime, timezone, datetimeoffset

我有一个问题，在保存日期时间属性时，表单返回 -04:00 而不是 -05:00

使用 Rails 3.2.3

在 application.rb 中：

```
config.time_zone = 'Eastern Time (US & Canada)' 
```

将 MySQL 与 mysql2 适配器一起使用

运行`@wine.released_at.localtime`返回`2008-05-15 00:00:00.000000000 -04:00`
运行`@wine.released_at`返回`2008-05-15 04:00:00.000000000 Z`
运行`Time.now.zone`返回`Eastern Standard Time`
运行`@wine.released_at.zone`返回`EDT`

我相当困惑。我虽然设置 config.time_zone 应该使 Rails 自动将所有数据库日期时间值转换为设置的 time_zone ......为什么没有发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:45:28.987

在我看来，该`zone`属性似乎返回了适用于指定时间的“区域间隔”的名称。因此，在夏季，它将返回“EDT”，但在冬季，它将返回“复活节标准时间”。（奇怪的是它使用一个缩写而不是另一个缩写，但是嘿......）

所以它对*两者*使用相同的时区 - 这些只是同一时区内的不同方面：有时是标准时间，有时是夏令时。

如果您打印`Time.now.localtime`它应该向您显示 -05:00 以显示东部时间与 UTC 的当前偏移量为 -5 小时（即东部时间目前比 UTC 晚 5 小时）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T20:46:50.613

您是否尝试过使用 in_time_zone？

# php - HTTP 身份验证的类型以及如何设计安全数据库？

> ID：14429057
> 
> 赞同：-2
> 
> 时间：2013-01-20T20:41:09.627
> 
> 标签：php, ios, xml, http, authentication

几个月前，我开发了一个 iOS(iphone) 应用程序，该应用程序允许用户创建某些类型的事件并将它们作为 XML/JSON 文件发布到 Web 服务器。然后通过他们的设备，他们能够查看来自不同用户的事件等。

构建整个事物的想法非常基本。当应用程序第一次启动时，应用程序连接到一个 URL 并要求提供一个用户 ID（每个用户都是唯一的）。然后每次用户想要发布内容时，我们使用 HTTP 基本身份验证并将用户 ID 和包含有关创建的事件的所有信息的 XML 文件作为标头发送。我从来没有在服务器端工作过，所以我不知道整个系统有多安全。

几天前我开始研究我的应用程序，这是相同的想法，所以我首先开始在服务器端（php）工作。在我开始之前，我想看看我以前的项目有多安全，我很震惊没有任何安全措施。只需使用一个简单的 Web 调试器（嗅探器），我就能够看到我的应用程序连接到何处以请求用户 ID，每个 xml 文件的格式如何发送到数据库以及服务器如何响应。

因此，如果有人只想用一百万个用户 ID 或一百万个事件来淹没数据库，那么创建一个 php 脚本来做到这一点将非常容易。在这种情况下，我们使用 HTTP 基本身份验证。

我现在的问题是，我应该使用什么样的身份验证，所以服务器和用户（XML）之间交换什么样的文件是不可见的，以及我如何设计注册机制以便有人无法创建一百万个 id用一个简单的脚本。

我不想构建一个超级安全的应用程序，但至少要有某种基本的安全性。由于我对 php 非常陌生，您可以给我一些链接来检查我应该使用哪些安全机制，甚至可以提供一些更好的教程。另外，如果您在使用哪种安全性之前开发了类似的东西，您会提出什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T20:47:56.807

*“我应该使用什么样的身份验证，所以服务器和用户之间交换什么样的文件（XML）是不可见的”*

唯一“真正”的答案是安装[ssl](http://en.wikipedia.org/wiki/Secure_Sockets_Layer)证书，然后使用[https](http://en.wikipedia.org/wiki/HTTP_Secure)协议

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:02:08.800

> 只需使用一个简单的 Web 调试器（嗅探器），我就能够看到我的应用程序连接到何处以请求用户 ID，每个 xml 文件的格式如何发送到数据库以及服务器如何响应。

使用 SSL 防止中间人攻击。

> 因此，如果有人只想用一百万个用户 ID 或一百万个事件来淹没数据库，那么创建一个 php 脚本来做到这一点将非常容易。

这就是网络通信的本质。使用启发式方法来限制不需要的数据量。一些例子：

1.  单个 user_id 每秒最多可以创建一个事件。
2.  让客户端对 user_id 的请求进行签名，并在服务器上验证签名。

这些不是防止滥用的万无一失的方法，但没有绝对的安全性。不过，建议的方法将阻止大多数脚本小子。

# html - HTML5 Shim 与 Shiv

> ID：14429061
> 
> 赞同：51
> 
> 时间：2013-01-20T20:41:33.800
> 
> 标签：html, internet-explorer, html5shiv

Rails 初学者。

我在我的示例应用程序中编写 CSS。我知道有 Javascript 代码可以帮助浏览器，即 Internet Explorer，支持 HTML5。

HTML5 Shim 和 HTML5 Shiv 有什么区别？有什么值得知道的吗？

[http://html5shim.googlecode.com/svn/trunk/html5.js](http://html5shim.googlecode.com/svn/trunk/html5.js)

[http://html5shiv.googlecode.com/svn/trunk/html5.js](http://html5shiv.googlecode.com/svn/trunk/html5.js)

我的代码，你们大家：

```
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js">
</script>
<![endif]--> 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-01-20T20:54:33.150

它最初被称为 html5-shiv。

Shiv 确实不是正确的术语，因为 shiv 是一种刺刀。

垫片是您用来平整事物（或支撑它们）的东西。如果一张桌子的一条腿太短，你可以用一块木头或电话簿把它垫起来……

所以 html5-shim 适合那些希望 html5shiv 被称为 shim 的人。

就差异而言，就是这样。

有点像`polyfill`涵盖了功能实现的差异。
在北美，Polyfill 可能被称为“Spackle”。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-10-16T09:04:31.397

来自[http://code.google.com/p/html5shim/](http://code.google.com/p/html5shim/)

> **shiv 还是垫片？**
> 
> **常见问题：** html5shim 和 html5shiv 有什么区别？
> **答：**没有，一个有m，一个有av——就是这样。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-07-30T05:29:11.127

答案是。

> shiv 这个词起源于[John Resig](https://github.com/jeresig)，他被认为使用这个词是因为它的俚语意思，一种用作刀状武器的锋利物体，用于 Internet Explorer。说实话，John 可能打算使用 [shim](http://en.wikipedia.org/wiki/Shim_(computing))这个词，它在计算中意味着应用程序兼容性解决方法。大多数熟悉 Internet Explorer 的开发人员并没有纠正他的拼写错误，而是对视觉图像表示赞赏。孩子们，这就是词源。

[来自https://github.com/aFarkas/html5shiv](https://github.com/aFarkas/html5shiv)的作者页面

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-16T14:27:27.427

这可能比您正在寻找的更简单，但对于其他可能感到困惑的人：

首先，这是一个 Shim 的非编程定义：

> **名词：用于对齐零件、使它们适合**或减少磨损的垫圈或薄条材料。
> 
> 动词：楔（某物）或用垫片填充（空间）。

要了解编程术语中的 shim，您需要了解 IE 对 Web 开发人员来说是什么/现在是什么痛苦：

IE 是最早的商用网络浏览器之一。它可能是第一个“免费”可用的。因此，它是在定义浏览器标准之前构建的，即定义如何处理 html 和 javascript。

因此，为了让网站和应用程序在 IE 中正常工作，随着标准的制定，IE 不能或（出于垄断原因）不会更新 IE（[这里有一篇很棒的帖子，其中包含更多信息](https://softwareengineering.stackexchange.com/questions/184449/why-does-internet-explorer-have-so-many-incompatibilities-with-other-browsers)）。这导致 IE 和其他浏览器之间的裂痕随着时间的推移而增长。这种裂痕经常出现在意想不到的错误、样式差异上，并且一些应用程序直接拒绝了用户从其他浏览器运行它的选项。

但是，如果产品要同时适用于两种类型的浏览器，开发人员通常不得不编写两组代码。一个适用于几乎所有现代浏览器，一个适用于 IE。显然，这种做法让保养成为了一场噩梦。但是，随着时间的推移，许多 JavaScript 框架/库开始添加代码来专门解决这些问题。这些代码被称为垫片。因为他们**让你的代码“适合”**在 IE 中。

例如，当[jQuery](https://jquery.com/)首次发布时，它相对于其前辈 - 或只是编写自己的库 - 的主要优势是它适用于每个浏览器，甚至 IE。当时 IE 仍然被大量使用，因此这为开发人员节省了大量时间。但是现在 jQuery 已经是第 3 版了。和以前版本的主要区别是它不再支持 IE。那是因为每个人，甚至微软都已经离开了 IE（Win10 的默认浏览器是 Edge）。但是，不幸的是，许多网站和 Web 应用程序是专门为 IE 设计的（出于安全原因）。尽管 IE 在大多数商业应用程序中已经走上了 Dodo 的道路，但它仍然提供其他浏览器没有的安全功能（但它们正在迅速追赶）。即使他们这样做了，更新这些应用程序的成本通常也太大而无法合理。

这基本上意味着很多人仍然被迫使用 IE，所以这些 shims 仍然是必要的。

# php - 正则表达式只允许选择字母字符

> ID：14429063
> 
> 赞同：0
> 
> 时间：2013-01-20T20:41:38.560
> 
> 标签：php, javascript, html, regex

有人可以定义一个只允许两个字母“E”和“P”的正则表达式集。

我有一个网络应用程序，其中某些文本区域需要只允许输入这两个字符。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:43:44.137

```
/^[ep]+$/ 
```

而已。

*   `^`意思是“字符串的开始”
*   `[ep]`是我们的字符“e”和“p”
*   `+`表示“重复 1 次或多次”
*   `$`意思是“字符串的结尾”

如果您还想接受 E 和 P，您可以添加一个`i`不区分大小写的修饰符：

```
/^[ep]+$/i 
```

在 javascript 中使用：

```
var testingRegex = /^[ep]+$/i;

if (testingRegex.match(myString)) {
    //Yes, it matches!
} else {
    //Error!
} 
```

# mysql - Mysql Rollup重复id字段

> ID：14429066
> 
> 赞同：1
> 
> 时间：2013-01-20T20:41:46.650
> 
> 标签：mysql, group-by, rollup

我使用 group by 和汇总有以下查询结果：

```
Divison Department      Section     Employee Name   Employee ID Hours

Assets  Asset Strategy  Not Defined Monty Mouse     480193      64.00
Assets  Asset Strategy  Not Defined Frank Flint     480165      67.50
Assets  Asset Strategy  Not Defined                 480165      131.50
Assets  Asset Strategy                              480165      131.50
Assets  Event Centre    Not Defined Sally Spoons    800192      72.00
Assets  Event Centre    Not Defined Randolph Smith  800199      37.50
Assets  Event Centre    Not Defined Petra Peters    800195      64.00
Assets  Event Centre    Not Defined                 800195      173.50
Assets  Event Centre                                800195      173.50 
```

我想要做的是阻止员工 id 在汇总行中复制：

```
Divison Department      Section     Employee Name   Employee ID Hours

Assets  Asset Strategy  Not Defined Monty Mouse     480193      64.00
Assets  Asset Strategy  Not Defined Frank Flint     480165      67.50
Assets  Asset Strategy  Not Defined                             131.50
Assets  Asset Strategy                                          131.50
Assets  Event Centre    Not Defined Sally Spoons    800192      72.00
Assets  Event Centre    Not Defined Randolph Smith  800199      37.50
Assets  Event Centre    Not Defined Petra Peters    800195      64.00
Assets  Event Centre    Not Defined                             173.50
Assets  Event Centre                                            173.50 
```

如果来自非汇总查询，我已经阅读了有关使用 union 尝试匹配员工的其他帖子，但这对我不起作用。

我还阅读了有关使用子选择（包装）来获取员工 ID 的信息，但这只会导致相同的结果。

我的汇总报表按部门、部门、部门和员工姓名分组。如果我尝试将员工 ID 添加到此子句中，我会汇总员工的每次变更。我还更改了名称和 if 字段的顺序，并尝试按 id 而不是名称进行分组，但这只是以与上面 id 相同的方式复制了名称。

我在这里追逐不可能的梦想吗？真的不能用这种方式显示数据吗？任何建议将不胜感激。

对于那些想要完整查询代码的人，这里是：

```
select distinct
  hr_func_desc('CD_DEPT_', p.department) as 'Department',
  hr_func_desc('CD_DIVN_', p.division) as 'Division',
  hr_func_desc('CD_SECT_', p.section) as 'Section',
  pe.payroll_name as 'Employee Name',
  pe.employee_id as 'Employee ID',
  max(e.termination_date) as 'Termination Date',
  sum(ph.ordinary_hours) as 'Ordinary Hours',
  sum(ph.overtime_1_hours) as 'Overtime 1 Hours',
  sum(ph.overtime_2_hours) as 'Overtime 2 Hours',
  sum(ph.overtime_1_hours) + sum(ph.overtime_2_hours) as 'Total Overtime Hours',
  sum(ph.ordinary_hours) + sum(ph.overtime_1_hours) + sum(ph.overtime_2_hours) as 'Total Hours Worked',
  sum(al.units) as 'Number of Standby Worked',
  sum(ph.statutory_hours) as 'Statutory Holidays',
  sum(ph.annual_leave_hours) as 'Annual Leave',
  sum(ph.long_service_leave_hours) as 'Long Service Leave',
  sum(ph.special_leave_hours) as 'Special Leave',
  sum(ph.time_in_alt_hours) as 'Alt Lieu',
  sum(ph.parental_leave_hours) as 'Parental Leave',
  sum(ph.sick_hours) as 'Sick',
  sum(ph.domestic_leave_hours) as 'Domestic',
  sum(ph.bereavement_hours) as 'Bereavement',
  sum(ph.acc_week_1_hours) as 'ACC Week 1',
  sum(ph.acc_hours) as 'ACC Unpaid',
  sum(ph.lwop_hours) as 'Leave Without Pay',
  sum(ph.sick_hours) + sum(ph.domestic_leave_hours) + sum(ph.bereavement_hours) + sum(ph.annual_leave_hours) + sum(ph.statutory_hours) +
sum(ph.special_leave_hours) + sum(ph.long_service_leave_hours) + sum(ph.time_in_lieu_hours) + sum(ph.time_in_alt_hours) + sum(ph.lwop_hours) +
sum(ph.standby_leave_hours) + sum(ph.parental_leave_hours) + sum(ph.acc_week_1_hours) + sum(ph.acc_hours) as 'Total Hours Absent',
  sum(ph.ordinary_hours) + sum(ph.overtime_1_hours) + sum(ph.overtime_2_hours) + sum(ph.statutory_hours) + sum(ph.annual_leave_hours) + 
sum(ph.long_service_leave_hours) + sum(ph.special_leave_hours) + sum(ph.time_in_alt_hours) + sum(ph.sick_hours) + sum(ph.domestic_leave_hours)  +
sum(ph.bereavement_hours) + sum(ph.acc_week_1_hours) as 'Total Hours Paid',
  hr_func_normal_hours(pe.employee_id) as 'Normal Hours Worked per Week',
  sum(cast(pt.pay_weeks as unsigned integer)) as 'Pay Weeks for Period Chosen',
  round((sum(ph.ordinary_hours) + sum(ph.overtime_1_hours) + sum(ph.overtime_2_hours) + sum(ph.sick_hours) + sum(ph.domestic_leave_hours) +
   sum(ph.bereavement_hours) + sum(ph.statutory_hours) + sum(ph.special_leave_hours) + sum(ph.time_in_lieu_hours) + sum(ph.time_in_alt_hours) +
   sum(ph.lwop_hours) + sum(ph.acc_week_1_hours) + sum(ph.acc_hours) + sum(ph.standby_leave_hours) + sum(ph.parental_leave_hours))
/sum(cast(pt.pay_weeks as unsigned integer)), 2) as 'Calculated FTE Hours',
  truncate(((sum(ph.ordinary_hours) + sum(ph.overtime_1_hours) + sum(ph.overtime_2_hours) + sum(ph.sick_hours) + sum(ph.domestic_leave_hours) +
   sum(ph.bereavement_hours) + sum(ph.statutory_hours) + sum(ph.special_leave_hours) + sum(ph.time_in_lieu_hours) + sum(ph.time_in_alt_hours) +
   sum(ph.lwop_hours) + sum(ph.acc_week_1_hours) + sum(ph.acc_hours) + sum(ph.standby_leave_hours) + sum(ph.parental_leave_hours))
/sum(cast(pt.pay_weeks as unsigned integer)))/hr_func_normal_hours(pe.employee_id), 3) as 'Calculated FTE'
from swpayroll.py_employees pe
  left outer join swhr_rails.hr_employees e on e.id = pe.employee_id
  left outer join swhr_rails.hr_employee_positions ep on pe.employee_id = ep.employee_id
  left outer join swhr_rails.hr_positions p on ep.position_id = p.id
  left outer join swpayroll.py_rep_hist_hours ph on pe.employee_id = ph.employee_id
  left outer join swpayroll.py_hist_dedns_allowances al
    on al.employee_id = pe.employee_id
       and al.pay_date = ph.pay_date
       and al.da_id in (33, 66, 67)
  left outer join swpayroll.py_hist_totals pt on pt.employee_id = pe.employee_id and pt.pay_date = ph.pay_date
where ep.position_id = (select min(x.position_id) from swhr_rails.hr_employee_positions as x 
                         where x.employee_id = pe.employee_id and x.position_end is null)
      and ph.pay_date between '2012-10-21' and '2012-11-04'
group by
  hr_func_desc('CD_DEPT_', p.department),
  hr_func_desc('CD_DIVN_', p.division),
  hr_func_desc('CD_SECT_', p.section),
  pe.payroll_name with rollup; 
```

更小的代码片段：

```
select distinct
  hr_func_desc('CD_DEPT_', p.department) as 'Department',
  hr_func_desc('CD_DIVN_', p.division) as 'Division',
  hr_func_desc('CD_SECT_', p.section) as 'Section',
  pe.payroll_name as 'Employee Name',
  pe.employee_id as 'Employee ID',
  sum(ph.ordinary_hours) as 'Ordinary Hours'
from swpayroll.py_employees pe
  left outer join swhr_rails.hr_employees e on e.id = pe.employee_id
  left outer join swhr_rails.hr_employee_positions ep on pe.employee_id = ep.employee_id
  left outer join swhr_rails.hr_positions p on ep.position_id = p.id
  left outer join swpayroll.py_rep_hist_hours ph on pe.employee_id = ph.employee_id
  left outer join swpayroll.py_hist_dedns_allowances al
    on al.employee_id = pe.employee_id
       and al.pay_date = ph.pay_date
       and al.da_id in (33, 66, 67)
  left outer join swpayroll.py_hist_totals pt on pt.employee_id = pe.employee_id and pt.pay_date = ph.pay_date
where ep.position_id = (select min(x.position_id) from swhr_rails.hr_employee_positions as x 
                         where x.employee_id = pe.employee_id and x.position_end is null)
      and ph.pay_date between '2012-10-21' and '2012-11-04'
group by
  hr_func_desc('CD_DEPT_', p.department),
  hr_func_desc('CD_DIVN_', p.division),
  hr_func_desc('CD_SECT_', p.section),
  pe.payroll_name with rollup; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T19:39:49.240

据我了解，在 mysql.com 论坛（[http://forums.mysql.com/read.php?10,577674,577674#msg-577674](http://forums.mysql.com/read.php?10,577674,577674#msg-577674)）上发布了相同的问题，没有办法消除这种重复在查询时。

它需要通过辅助程序语言以编程方式完成。

# javascript - 使用 easel.js 创建 10x10 图像网格，其中图像随机交叉溶解

> ID：14429069
> 
> 赞同：0
> 
> 时间：2013-01-20T20:42:00.707
> 
> 标签：javascript, easeljs

使用 Easel.js 创建我希望的东西很容易，但仍然是新手。只需创建一个 10X10 的图像网格，其中每个图像将以随机间隔交叉溶解到另一个配对图像。

谁能指出我任何类似的例子，或者我需要只使用javascript来硬编码吗？

最终我将从服务器加载这些图像，但首先我需要一个没有任何服务器 ajax 调用的工作演示，只需在本地加载图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T04:25:09.460

如果通过交叉溶解你的意思是淡入对方，那么你可能想看看[createjs.AlphaMaskFilter](http://www.createjs.com/Docs/EaselJS/AlphaMaskFilter.html)或[createjs.AlphaMapFilter](http://www.createjs.com/Docs/EaselJS/AlphaMapFilter.html)。要加载图像，请看这里：[图像不显示在画布](https://stackoverflow.com/questions/14324384/the-image-doesnt-show-up-on-the-canvas) 上服务器上的图像和本地图像之间确实没有区别，从服务器上可能更容易。

# lua - 将 API 函数移植到 Lua

> ID：14429071
> 
> 赞同：2
> 
> 时间：2013-01-20T20:42:02.953
> 
> 标签：lua

有人可以给我关于如何使用 Lua 中的这个功能的任何建议：

[HH_DISPLAY_TOPIC](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms670084%28v=vs.85%29.aspx) (MSDN)

我只是有点困惑如何调用函数，因为它是从 dll 中调用的，还是我需要制作 dll 或者这是 Luacom 类型的场景。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:08:12.693

Lua 无法进入随机 DLL 并开始调用随机 C 函数¹。如果要调用 DLL 中的某些代码，则需要用 C 编写适当的 Lua 模块，该模块将加载此 DLL 并将 Lua 的调用编组到 DLL。Lua 可以读取常规的 Lua 模块并采取相应的行动。

¹：如果你使用 LuaJIT，你可以通过他们的 FFI 东西来做到这一点。在某种程度上，您需要提供一个字符串来描述您要调用的函数的接口。

# ruby - 如何在 selenium-webdriver 中获取网页的当前 URL

> ID：14429075
> 
> 赞同：12
> 
> 时间：2013-01-20T20:42:38.843
> 
> 标签：ruby, selenium-webdriver, ruby-1.9.3

我正在使用 selenium webdriver 在浏览器上进行一些自动化操作。现在需要获取当前在浏览器中打开的页面的当前 url。

***我写了下面的代码，但给了我错误：***

```
element = driver.find_element :name => "btnSearch"
element.click

all_table_data = driver.find_elements(:tag_name, "td")

 all_table_data.each do |td|

   puts td.text

 end

 print driver.get_url 
```

***但这给了我一个错误：***

```
filedownload.rb:30:in `<main>': undefined method `get_url' for #<Selenium::WebDr
iver::Driver:0x4292df26 browser=:firefox> (NoMethodError) 
```

任何人都可以在这里帮我修复它吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-20T21:05:19.093

尝试`driver.current_url`代替`get_url`.

[https://groups.google.com/forum/?fromgroups=#!topic/selenium-users/zzP5IDgxP5A](https://groups.google.com/forum/?fromgroups=#!topic/selenium-users/zzP5IDgxP5A)

Selenium::WebDriver::Driver 类的文档：

[http://rubydoc.info/gems/selenium-webdriver/2.9.1/Selenium/WebDriver/Driver](http://rubydoc.info/gems/selenium-webdriver/2.9.1/Selenium/WebDriver/Driver)

# php - 用 JSON 显示撇号

> ID：14429086
> 
> 赞同：0
> 
> 时间：2013-01-20T20:43:57.423
> 
> 标签：php, mysql, json, apostrophe

我在用 JSON 显示撇号时遇到了一些问题。

我允许用户将数据插入到我的 mysql 数据库中，当他们使用撇号（例如 Rob 的表）时，它将作为 Rob 的表存储在 mysql 数据库中。

当我对这个数据进行 json 编码时，它会添加一个进一步的反斜杠，这样它就会在显示为：rob\'s table 时出现。如果我去掉斜线，那么我会遇到换行问题。有谁知道是否有一种方法可以对数据进行编码而不在撇号前添加反斜杠？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:55:00.690

从数据库中提取文本数据时使用[stripslashes() 。](http://php.net/manual/en/function.stripslashes.php)根据JSON 网站上[的状态机图](http://www.json.org/)，只允许转义的双引号字符，不允许使用单引号。单引号字符不需要转义：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T20:45:38.957

您可以将 nl2br() 与带斜杠结合使用，以防止出现换行问题。

# mysql - mysql查询 - 查找与给定日期范围匹配的列

> ID：14429087
> 
> 赞同：1
> 
> 时间：2013-01-20T20:43:58.263
> 
> 标签：mysql, left-join

好的，我已经搜索了帖子，但找不到我正在尝试执行的特定查询的答案。我有一个非常简单的表：

```
mysql> DESCRIBE offpeak_mccavg_raw;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| date  | date         | YES  |     | NULL    |       |
| node  | varchar(30)  | YES  |     | NULL    |       |
| price | decimal(6,4) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+ 
```

每天，给定节点和给定价格大约有 1700 个条目（注意，在下面的示例中，日期不是连续的。我一直在测试一些东西，所以这就是日期偏离的原因。通常情况下，会有每天都有条目。）

```
mysql> select * from offpeak_mccavg_raw order by node limit 10;
+------------+---------------+---------+
| date       | node          | price   |
+------------+---------------+---------+
| 2012-01-08 | AEC           | -0.4083 |
| 2013-01-18 | AEC           |  1.2125 |
| 2013-01-18 | AECI          | -1.7575 |
| 2012-01-08 | AECI          | -1.2488 |
| 2013-01-18 | AECI.ALTW     | -5.0950 |
| 2012-01-08 | AECI.ALTW     | -6.3258 |
| 2013-01-18 | AECI.AMMO     | -0.4725 |
| 2012-01-08 | AECI.AMMO     | -0.8117 |
| 2013-01-18 | AECI.APM_1.AZ | -0.9088 |
| 2012-01-08 | AECI.APM_1.AZ | -0.7729 |
+------------+---------------+---------+ 
```

我试图找到在给定日期范围内每天具有相同价格的节点对。如果我只有 1 天的数据，我已经能够编写一个查询来查找与该给定日期匹配的对 - 但不是在某个日期范围内。理想情况下，我想运行一个查询，显示过去 2 周、2 个月等匹配价格的所有节点对。

这是适用于给定日期的查询：

```
SELECT b1.node, b2.node FROM onpeak_mccavg_raw AS b1 LEFT JOIN onpeak_mccavg_raw AS b2 ON b1.price = b2.price WHERE b1.node < b2.node; 
```

我尝试扩展 WHERE 子句并添加日期范围，但它不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:57:35.583

```
SELECT   b1.node, b2.node
FROM     onpeak_mccavg_raw b1
    JOIN onpeak_mccavg_raw b2
      ON b1.date = b2.date
     AND b1.node < b2.node
GROUP BY b1.node , b2.node
HAVING   SUM(b1.price = b2.price) = COUNT(*) 
```

# jquery - 可以在 jquery 选择器中使用变量吗？

> ID：14429089
> 
> 赞同：0
> 
> 时间：2013-01-20T20:44:02.853
> 
> 标签：jquery

> **可能重复：**
> [如何在 jquery 选择器中使用 javascript 变量](https://stackoverflow.com/questions/5891840/how-to-use-javascript-variables-in-jquery-selectors)

我有这个代码

```
var commentid=123456

var signature=($("#commentid_" + commentid).attr("data")); 
```

但。它不起作用...我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:51:57.610

解决了..

```
$(window).load(function(){
[code]
} 
```

# html - Html链接改变颜色？没有解释

> ID：14429090
> 
> 赞同：1
> 
> 时间：2013-01-20T20:44:03.317
> 
> 标签：html, css, colors, hyperlink, hex

```
<style>
a.a:link,a.a:visited
{
display:block;
width:120px;
font-weight:bold;
color:#ff7100;
background-color:#98bf21;
text-align:center;
padding:4px;
text-decoration:none;
text-transform:uppercase;
}
</style>

<a class='a' href="">link</a> 
```

出于某种原因，当单击链接时 `color:#ff7100;`获得另一个`#`链接时，它变为橙色，然后将您发送到您链接到的页面，但如果没有额外`#`的链接，它只是另一个正常链接.. 我觉得这很奇怪，因为我以前从未见过这个有解释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T20:44:59.107

那应该`<style>`不是`<script>`。你不应该使用空`href`标签，通常是使用`#`（空标签）。

那可能是因为当你点击一个 lick 时它实际上处于它的`active`状态，所以你还必须`css`定义`a:active`

试试这个选择器：

```
a.a:link,a.a:visited,a.a:active,a.a:hover 
```

# ruby-on-rails - 登录/退出/注册页面应该是用户控制器的一部分吗？

> ID：14429096
> 
> 赞同：0
> 
> 时间：2013-01-20T20:44:32.380
> 
> 标签：ruby-on-rails, controller

对于用户控制器是否应该拥有登录、登录、注销页面或其他控制器是否应该参与这部分，人们有什么看法。我只是想知道，因为我可以两者兼得。我可以在 UsersController 中执行此操作，因为用户登录，并且他们以某种方式关联。或者我可以进行命名预通行证之类的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T20:51:58.030

我不会把它带入用户控制器..

制作一个新的会话控制器，它也有新的/销毁的动作..然后它更安静..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T20:59:43.567

我通常做的是有一个`UserSessionsController`安宁的行动。然后在我的路线中，是这样的：

```
get '/login' => 'user_sessions#new'
post '/login' => 'user_sessions#create'
get '/logout' => 'user_sessions#destroy' # or delete '/logout' 
```

我把注册的东西放在一个`RegistrationsController`.

例如，如果我需要在管理部分进行用户管理，我有一个`Admin::UsersController`（或只是一个`UsersController`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T20:49:29.227

我认为，在 UsersController 中执行此操作很常见。

# javascript - 如何正确处理多个异步请求？

> ID：14429099
> 
> 赞同：1
> 
> 时间：2013-01-20T20:44:47.337
> 
> 标签：javascript, ajax

有谁知道一些好的资源/书籍，我可以在其中找到如何处理多个异步请求？

让我们考虑下面的代码：

```
Payment.createToken = function(data) {
    var data = data;

    apiCall("POST", "api/createToken", data, function(success, response) {
        if (success) {
            data.token = response.id;

            // If there's coupon code passed in data object, check it's validity, else send payment request
            if (data.coupon) {
                // Check if coupon is valid
                Payment.verifyCoupon(data);
            } else {
                // Send payment request
                Payment.chargePlan(data);
            }
        } else {
            // Handle error
        }
    });
};

Payment.verifyCoupon = function(data) {
    var data = data;

    apiCall("POST", "/api/checkCoupon", data, function(success, response) {
        if (success) {
            Payment.chargePlan(data);
        } else {
            // Handle error
        }
    });
};

Payment.chargePlan = function(data) {
    apiCall("POST", "/api/chargePlan", data, function(success, response) {
        if (success) {
            Payment.changeUserType(data);
        } else {
            // Handle error
        }
    });
};

Payment.changeUserType = function(data, response) {
    apiCall("PUT", "api/users/", data, function(success, response) {
        if (success) {
            // User type changed successfully
        } else {
            // Handle error
        }
    });
}; 
```

如您所见，它很长，有 4 个步骤流程。我应该如何正确处理错误等？让我们考虑到这些调用应该尽可能地可重用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:38:29.793

在这种情况下，我通常会创建一个异步操作队列来连续执行和运行它们，只有在前一个成功时才调用下一个，如果没有，则直接调用最终回调，并将错误作为第一个参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:21:29.733

我已经成功地使用[了这个库](https://github.com/caolan/async)。它有助于减少混乱，并让您可以选择按顺序或同时运行各种进程（跟踪所有进程的实际完成时间）。

如果您需要知道是否出现问题，它会引用可选的错误处理回调。

我意识到这不是您正在寻找的确切答案，但它仍然可能会有所帮助。

# java - 从字符串 Java 的值调用函数

> ID：14429107
> 
> 赞同：1
> 
> 时间：2013-01-20T20:45:11.117
> 
> 标签：java, arrays, reflection, methods, invoke

> **可能重复：**
> [当将方法名称作为字符串给出时，如何调用 java 方法？](https://stackoverflow.com/questions/160970/how-do-i-invoke-a-java-method-when-given-the-method-name-as-a-string)

**我看过这个：[从字符串数组（Java或Groovy）调用一个函数](https://stackoverflow.com/questions/14023409/call-a-function-from-a-string-array-java-or-groovy)，它对我不起作用，也许这是我的场景*

我有一个带有一些值的字符串数组，我希望能够调用一个方法，它是这些值之一，当然这可以改变，我可能有 100 个值，所以使用 if/ 是不可行的else if 构造或 switch 语句。

有什么方法可以调用我想要的方法，如下面的代码所示？

```
private String[] = {"Hit","Slap","Blop"};
private String et = "Slap";

    public void Action(){

        for(int i = 0; i < arr.length;i++){
            if(et.equals(arr[i])){
                //Call method of that name ( Slap(); )

            }
        }   
    }

    public void Run(){
        ///
    }

    public void Slap(){
        ///
    }

    public void Blop(){
        ///
    } 
```

编辑：我尝试整合反射：

```
 for(int i = 0; i < arr.length;i++){
            if(et.equals(arr[i])){
                //Call method of that name
                 try {
                    method = this.getClass().getMethod(arr[i]);

                } catch (NoSuchMethodException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (SecurityException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                try {
                    return (String) method.invoke(this);
                } catch (IllegalAccessException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (IllegalArgumentException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (InvocationTargetException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

            }
        }
        return "FAIL"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:50:41.900

您将不得不使用反射。像这样的东西：

```
getClass().getMethod(arr[i]).invoke(this); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T20:53:24.513

您可以使用 ReflectionAPI 来实现这一点。只需从您想要的类（如果可用）中获取具有此名称的方法并使用您的 args 调用它，在本例中为 null。

**但这是一个糟糕的设计，您应该重新考虑您的应用程序流程！**

这是一个例子：

```
public class HelloWorld {

public static void main(String[] args) {
    HelloWorld hello = new HelloWorld();
    String[] calls = { "def", "abc", "ghi" };
    try {
        for (String call : calls) {
            Method method = HelloWorld.class.getMethod(call, null);
            method.invoke(hello, null);
        }
    } catch (Exception e) {
        // TODO: handle exception
    }
}

public void abc() {
    System.out.println("abc");
}

public void def() {
    System.out.println("def");
}

public void ghi() {
    System.out.println("ghi");
} 
```

}

# ios - 无法填充第二个 UITableView 控制器

> ID：14429109
> 
> 赞同：1
> 
> 时间：2013-01-20T20:45:18.497
> 
> 标签：ios, objective-c, json, uitableview, uiviewcontroller

**我无法填充第二个 UITableView 控制器，想知道是否有人可以提供帮助。**

我正在为数据使用网站 API、JSON 和 RestKit。我相信这部分工作正常，因为我的第一个 VC 加载正常。

但我不确定是否需要使用 prepareForSegue 和/或 didSelectRowAtIndexPath 以便我可以识别在第一个 VC 中选择的单元格/行，以便第二个 VC 填充（正确的）数据。

**第一个 VC 填充正确：**

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return sports.count;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    Sport *sport = [sports objectAtIndex:section];
    return sport.leagues.count;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 
{
    Sport *sport = [sports objectAtIndex:section];
    return sport.name;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"standardCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    Sport *sport = [sports objectAtIndex:indexPath.section];
    League *league = [sport.leagues objectAtIndex:indexPath.row];
    cell.textLabel.text = league.name;

    return cell;
} 
```

**第二个 VC 填充空白表：**

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return leagues.count;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    League *league  = [leagues objectAtIndex:section];
    return league.teams.count;
}

- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section 
{
    League *league = [leagues objectAtIndex:section];
    return league.name;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"standardCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    League *league = [leagues objectAtIndex:indexPath.section];
    Team *team = [league.teams objectAtIndex:indexPath.row];
    cell.textLabel.text = team.name;

    return cell;
} 
```

**或者，如果我尝试为第 1 个 VC 添加额外代码，应用程序会在到达第 2 个 VC 之前崩溃：**

```
 -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    TeamsViewController *teamsViewController = [[TeamsViewController alloc] initWithNibName:@"TeamsViewController" bundle:nil];
    teamsViewController.title = [[sports objectAtIndex:indexPath.row] objectForKey:@"sports"];

}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"leagueDetail"]) {
        TeamsViewController *tvc = [segue destinationViewController];
        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
        tvc.data = [self.navigationController objectInListAtIndex:indexPath.row]
} 
```

非常**感谢**任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:16:36.560

我对创建 UITableViewCell 对象的异常感到有点困惑。当您询问表视图以使单元格出列时，它会返回一个目前不需要的单元格，如果没有未使用的单元格，则必须创建一个新单元格。试试这样的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    // Create cell
    NSString *cellIdentifier = @"cell";
    UITableViewCell *cell = nil;
    cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                      reuseIdentifier:cellIdentifier];
        cell.selectionStyle = UITableViewCellSelectionStyleGray;
    }
    cell.textLabel.text = [NSString stringWithFormat:@"cell %d", indexPath.row];

    return cell;
} 
```

# javascript - 使用 html 搜索文本换行

> ID：14429111
> 
> 赞同：3
> 
> 时间：2013-01-20T20:45:36.637
> 
> 标签：javascript, jquery, html, replace

我有以下 HTML 代码：

```
<div id="Test">
  My selected Link
  <a href="link1.html">My Link 1</a>
  <a href="link2.html">My Link 2</a>
</div> 
```

我需要在里面**找到文本字符串**：

```
<div id="Test"></div> 
```

并**用标签包装它**。里面总是只有一个文本字符串

```
<div id="Test"></div> 
```

但是文本在代码中会有不同的位置，例如：

```
<div id="Test">
  <a href="link1.html">My Link 1</a> Another Selected Link
  <a href="link2.html">My Link 2</a>
</div>
```

我正在寻找的结果是这样的：

```
<div id="Test">
  <a href="link1.html">My Link 1</a>
  <h2>Another Selected Link</h2>
  <a href="link2.html">My Link 2</a>
</div>
```

所以总结一下：找到 div 内的唯一文本字符串（但不在子标签中）并用标签包装它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:52:30.320

希望这对您的具体情况有所帮助

**[jsBin 演示](http://jsbin.com/adabub/1/edit)**

```
$('#Test').contents(':not(a)').wrap('<h2/>'); 
```

[http://api.jquery.com/not-selector/](http://api.jquery.com/not-selector/)
[http://api.jquery.com/contents/](http://api.jquery.com/contents/)
[http://api.jquery.com/wrap/](http://api.jquery.com/wrap/)

# c# - 访问方法时释放的 StreamWriter

> ID：14429120
> 
> 赞同：0
> 
> 时间：2013-01-20T20:46:09.753
> 
> 标签：c#, .net, class

当我尝试使用一种方法在我的日志文件上写入时，我遇到了一个问题，即我声明的 StreamWriter 被处置。一切都按预期工作，除非我从另一个班级运行*AttachPink*或*AttachBlue*。然后处理 StreamWriter，我得到一个 nullPointerException

```
class Logs : IDisposable
    {

        //other declarations

        private StreamWriter HistoryWriter;
        private int ReportInterval = 0;

        public void NewHistory()
        {
            HistoryWriter = new StreamWriter(HistoryLocation + HistoryName + HistoryExtension);
            PrepareHistory();
        }

        private void PrepareHistory()
        {
            HistoryWriter.WriteLine("<html><body bgcolor='#000000'>");
            /*
             *  Insert initial HTML tags 
             */
        }

        public void SendHistory()
        {
            HistoryWriter.WriteLine("</body></html>");
            /*
             *  Final HTML tags
             */ 
            HistoryWriter.Close();
            if (ReportInterval > 0)
            {
                /*
                 *  Upload File
                 */
            }
            else
            {
                Debug.WriteLine("ERROR: Report Interval for History has not been set");
            }
            NewHistory();
        }

        public void AttachPink(String message, StreamWriter writer)
        {
            writer.Write(
                "<font color='DA1BE0'>" 
                + message
                + "</font>");
        }

        public void AttachBlue(String message, StreamWriter writer)
        {
            writer.Write(
                "<font color='0C93ED'>" 
                + message
                + "</font>");
        }

        public StreamWriter getHistoryWriter()
        {
            return HistoryWriter;
        }

        public void SetHistoryInterval(int interval)
        {
            ReportInterval = interval;
        }

        public void Dispose()
        {
            if (HistoryWriter != null)
            {
                HistoryWriter.Close();
                HistoryWriter.Dispose();
                HistoryWriter = null;
            }
        }

    } 
```

要使用这些方法，我只需在另一个类中声明 Logs 类的实例，如下所示：

```
class UsingLogs
    {
        Logs logs = new Logs();
        logs.NewHistory();
        logs.AttachBlue("my message", logs.getHistoryWriter());
    } 
```

我不知道在访问多个方法时应该如何保留类变量状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:06:28.633

我猜你正在寻找的是单例模式（[http://en.wikipedia.org/wiki/Singleton_pattern](http://en.wikipedia.org/wiki/Singleton_pattern)）

我的一个简单实现，每次需要单例时都可以重用

```
public class Singleton<T> where T : class, new()
{
    private static object sync = null;
    private static volatile T i;
    protected Singleton() { }

    public static T I
    {
        get
        {
            if (i == null)
                lock (sync)
                    if (i == null)
                        i = new T();

            return i;
        }
    }
} 
```

您可以像这样实现您的 Log 类：

```
class Logs : Singleton<Logs>
{
... your code goes here
} 
```

在您的代码中，当您想使用 Logs 类时，您只需使用：

```
Logs.I.AttachBlue(...); 
```

希望这可以帮助 ：）

# javascript - 如何在 JavaScript 中使用超链接？

> ID：14429122
> 
> 赞同：0
> 
> 时间：2013-01-20T20:46:34.720
> 
> 标签：javascript, image

这是我正在旋转的图像列表；

如何单独超链接这些图像中的每一个？

在理想的意义上，我想使用这样的东西来链接下面的每个图像，我将在下面使用一个 html 链接：

```
<a href="/banners/chiropractor/">banners/chiropractor.jpg></a> 
```

这是我的完整脚本

```
 <html>
<head>

<script type="text/javascript">
var interval = 2.5; // delay between rotating images (in seconds)
var random_display = 1; // 0 = no, 1 = yes
interval *= 1000;

var image_index = 0;
image_list = new Array();
image_list[image_index++] = new imageItem("banners/chiropractor.jpg");
image_list[image_index++] = new imageItem("banners/chiropody.jpg");
image_list[image_index++] = new imageItem("banners/fitness ball.jpg");
image_list[image_index++] = new imageItem("banners/Dietician.jpg");
image_list[image_index++] = new imageItem("banners/Alexander technique.jpg");
var number_of_image = image_list.length;
function imageItem(image_location) {
this.image_item = new Image();
this.image_item.src = image_location;
}
function get_ImageItemLocation(imageObj) {
return(imageObj.image_item.src)
}
function generate(x, y) {
var range = y - x + 1;
return Math.floor(Math.random() * range) + x;
}
function getNextImage() {
if (random_display) {
    image_index = generate(0, number_of_image-1);
} else {
    image_index = (image_index+1) % number_of_image;
}
var new_image = get_ImageItemLocation(image_list[image_index]);
return(new_image);
}
function rotateImage(place) {
var new_image = getNextImage();
document[place].src = new_image;
var recur_call = "rotateImage('"+place+"')";
setTimeout(recur_call, interval);
}
</script>

</head>

<div>
<img name="rImage" src="banners/chiropractor.jpg" width=222 height=218>
<img name="rImage2" src="banners/chiropractor.jpg" width=222 height=218>
<img name="rImage3" src="banners/chiropractor.jpg" width=222 height=218>
<img name="rImage4" src="banners/chiropractor.jpg" width=222 height=218>
</div>

<script>
rotateImage('rImage');
rotateImage('rImage2');
rotateImage('rImage3');
rotateImage('rImage4');
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:15:20.323

您的问题并不完全清楚，但是如果您希望将图像转换为链接，最简单的方法是像这样将 onClick 事件处理程序附加到每个图像...

```
var foo = new imageItem("banners/chiropractor.jpg");
//do whatever else you're doing with it...
foo.onclick = function(){
   self.location.href = "http://someplace.com";
   //or if you want to link to the image itself 
   self.location.href = this.src; //in this case "self" is the window and "this" is the image object.
} 
```

# java - 在OpenGL中绘制多个对象

> ID：14429124
> 
> 赞同：2
> 
> 时间：2013-01-20T20:46:50.333
> 
> 标签：java, opengl, lwjgl

我开始学习OpenGL。我可以加载一个 .obj 模型并用 elementBuffer 绘制它。但我坚持一次尝试两种不同的模型。我要绘制的模型在实体类中。我能找到的大多数关于这个的教程只显示了如何加载和绘制一个单一的模型。没有解释（以我至少可以找到/理解的方式）如何处理多个模型。

这是我的所有代码：

```
public static void main(String[] args) throws LWJGLException, IOException
{
    PixelFormat pixelFormat = new PixelFormat();
    ContextAttribs contextAtrributes = new ContextAttribs(3, 2);
    contextAtrributes.withForwardCompatible(true);
    contextAtrributes.withProfileCore(true);

    Display.setDisplayMode(new DisplayMode(WIDTH, HEIGHT));
    Display.setTitle("Textured quad!");
    Display.create(pixelFormat, contextAtrributes);

    Mouse.create();
    Mouse.setGrabbed(true);
    Keyboard.create();

    glEnable(GL_DEPTH_TEST);
    glEnable(GL_CULL_FACE);

    entity = new Entity("planeTex.obj");
    entity2 = new Entity("modelTex2.obj");

    Shaders.load();
    Textures.load();
    Camera.create(new Vector3f(0, 1, -0.75f), new Vector3f(-50, 0, 20), HEIGHT, WIDTH);

    while (!Display.isCloseRequested())
    {

        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        entity.draw();
        entity2.draw();

        Display.update();
        Display.sync(60);
    }

}

public class Entity
{
    private int vao, vbo, ebo;
    private int elementSize;

    public Entity(String name)
    {
        vao = glGenVertexArrays();
        glBindVertexArray(vao);
        vbo = glGenBuffers();
        *Load vertex data into buffer*
        glBindBuffer(GL_ARRAY_BUFFER, vbo);
        glBufferData(GL_ARRAY_BUFFER, buffer, GL_STATIC_DRAW);
        ebo = glGenBuffers();
        *load data into elementBuffer*
        *Set elementSize to the element count*
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ebo);
        glBufferData(GL_ELEMENT_ARRAY_BUFFER, elementBuffer, GL_STATIC_DRAW);
    }

    public void draw()
    {
        glBindVertexArray(vao);
        glBindBuffer(GL_ARRAY_BUFFER, vbo);
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ebo);

        glDrawElements(GL_TRIANGLES, elementSize, GL_UNSIGNED_INT, 0);
    }
}

public class Shaders
{

public static int vertexShader, fragmentShader;
public static int shaderProgram;
public static int uniTrans;

    public static void load()
    {
        vertexShader = glCreateShader(GL_VERTEX_SHADER);
        glShaderSource(vertexShader, loadFile("vertex.shader"));
        glCompileShader(vertexShader);

        fragmentShader = glCreateShader(GL_FRAGMENT_SHADER);
        glShaderSource(fragmentShader, loadFile("fragment.shader"));
        glCompileShader(fragmentShader);

        shaderProgram = glCreateProgram();
        glAttachShader(shaderProgram, vertexShader);
        glAttachShader(shaderProgram, fragmentShader);
        glBindFragDataLocation(shaderProgram, 0, "outColor");
        glLinkProgram(shaderProgram);
        glUseProgram(shaderProgram);

        // Specify the layout of the vertex data
        int posAttrib = glGetAttribLocation(shaderProgram, "position");
        glEnableVertexAttribArray(posAttrib);
        glVertexAttribPointer(posAttrib, 3, GL_FLOAT, false, (Float.SIZE / 8) * 8, 0);

        int colAttrib = glGetAttribLocation(shaderProgram, "color");
        glEnableVertexAttribArray(colAttrib);
        glVertexAttribPointer(colAttrib, 3, GL_FLOAT, false, (Float.SIZE / 8) * 8, (Float.SIZE / 8) * 3);

        int texAttrib = glGetAttribLocation(shaderProgram, "texcoord");
        glEnableVertexAttribArray(texAttrib);
        glVertexAttribPointer(texAttrib, 2, GL_FLOAT, false, (Float.SIZE / 8) * 8, (Float.SIZE / 8) * 6);

        uniTrans = glGetUniformLocation(Shaders.shaderProgram, "model");
    }
} 
```

结果是只会绘制最后创建的实体对象。不管抽奖顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T09:10:34.237

好吧，我通过放置这个块来修复它 // 指定顶点数据的布局 int posAttrib = glGetAttribLocation(Shaders.shaderProgram, "position"); glEnableVertexAttribArray(posAttrib); glVertexAttribPointer(posAttrib, 3, GL_FLOAT, false, (Float.SIZE / 8) * 8, 0);

```
 int colAttrib = glGetAttribLocation(Shaders.shaderProgram, "color");
    glEnableVertexAttribArray(colAttrib);
    glVertexAttribPointer(colAttrib, 3, GL_FLOAT, false, (Float.SIZE / 8) * 8, (Float.SIZE / 8) * 3);

    int texAttrib = glGetAttribLocation(Shaders.shaderProgram, "texcoord");
    glEnableVertexAttribArray(texAttrib);
    glVertexAttribPointer(texAttrib, 2, GL_FLOAT, false, (Float.SIZE / 8) * 8, (Float.SIZE / 8) * 6); 
```

在 glDrawElements 方法之前的实体类中绘制循环。将块放在其他任何地方都会导致程序崩溃：

> “禁用数组缓冲区对象时无法使用偏移量”

否则它根本就什么也画不出来。我从 NicolBolas 那里得到了我应该把它放在 Entity 构造函数中的感觉，但正如我所说，它在任何地方都不起作用。

# android - 在响铃期间更改响铃音量

> ID：14429133
> 
> 赞同：4
> 
> 时间：2013-01-20T20:47:12.093
> 
> 标签：android, settings, volume, android-audiomanager

我想在响铃期间更改响铃音量。下面的代码在响铃期间设置它（它在系统设置中更改）但它不会在实际响铃时生效（只有下一个响铃呼叫将使用新值）。我可以强制进行此更改以使其立即生效吗？

```
AudioManager audio = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);    
audio.setStreamVolume(AudioManager.STREAM_RING, volume, AudioManager.FLAG_ALLOW_RINGER_MODES | AudioManager.FLAG_PLAY_SOUND); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T21:14:26.560

经过一些研究和测试，我发现只有在来电检测的早期阶段才有可能改变音量。不要在`onReceive()`方法内部进行太多操作，这一点至关重要。

```
public class CallReceiver extends BroadcastReceiver   {

private boolean isRinging = false;
private boolean isInProgress = false;
private Listener mListener = null;

// interface declaration
 public interface Listener {
        public void onPhoneStateChange(boolean state);
    }

// registration of listener
 public void registerListener (Listener listener) {
        mListener = listener;
    }

@Override
public void onReceive(Context context, Intent intent) {

        String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);

        if(TelephonyManager.EXTRA_STATE_RINGING.equals(state))  {
            // do something while ringing BUT NOT TOO MUCH!

            isRinging = true;

            if (context instanceof StateChecker)
                  ((StateChecker) context).serviceDestroy();
                Log.v("phone", "ringing");

        }

        else if(TelephonyManager.EXTRA_STATE_IDLE.equals(state))    {
            //do something when the call ends
            if (context instanceof StateChecker)
                  ((StateChecker) context).serviceStart();
            Log.v("phone", "idle");
            isRinging = false;
        }

        // sending notification to listener
        if(mListener != null)   {
            mListener.onPhoneStateChange(isRinging);

            Log.v("listener", "notified");

        }

}

} 
```

以及服务中的一些代码：

```
// listeners callbacks
public void onPhoneStateChange(boolean state) {

    if (state) {

        if (!callInProgress)    {

       // Do the main task here
        callInProgress = true;
        serviceDestroy();

        }

    } else {

        callInProgress = false;
        serviceStart();

    }
} 
```

服务开始：

```
 // starting service
public void serviceStart()  {

    preferencesRead();

    //The intent to launch when the user clicks the expanded notification
    Intent intent = new Intent(this, MainActivity.class);
    intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);
    PendingIntent pendIntent = PendingIntent.getActivity(this, 0, intent, 0);

    if(settings.getBoolean("hide_noti_icon", false))    {
     Notification noti = new NotificationCompat.Builder(this)
     .setContentTitle("Intelligent Ringer")
     .setContentText(getString(R.string.is_running))
     .setSmallIcon(R.drawable.invisible)
     .setContentIntent(pendIntent)
     .setPriority(Notification.PRIORITY_MIN)
     .build();

     startForeground(12345, noti); 

    } else  {

         Notification noti = new NotificationCompat.Builder(this)
         .setContentTitle("Intelligent Ringer")
         .setContentText(getString(R.string.is_running))
         .setSmallIcon(R.drawable.ic_launcher)
         .setContentIntent(pendIntent)
         .setPriority(Notification.PRIORITY_MIN)
         .build();

         startForeground(12345, noti); 
    }

    Log.v("service", "started");
    // registering listener for CallReceiver
    if(isCRRegistered)  {
        unregisterReceiver(mCallReceiver);
        isCRRegistered = false;
    }

    if(!isCRRegistered) {

     IntentFilter filter2 = new IntentFilter("android.intent.action.PHONE_STATE");
     filter2.addAction("android.intent.action.PHONE_STATE");
     CallReceiver mCallReceiver = new CallReceiver();
     this.mCallReceiver = mCallReceiver;
       registerReceiver(mCallReceiver, filter2);
       mCallReceiver.registerListener(this);
       isCRRegistered = true;
    }

    if(isScreenRegistered)  {
        unregisterReceiver(mReceiver);
        isScreenRegistered = false;
    }

    if(!isPositionRegistered && proximityOn)    {

        Position mPosition = new Position(this.getApplicationContext());
        mPosition.registerListener(this);
        mPosition.isInPocket();
        this.mPosition = mPosition;
        mPosition.register();

        isPositionRegistered = true;
}

    if(!isScreenRegistered) {
        IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);
        filter.addAction(Intent.ACTION_SCREEN_OFF);
        ScreenReceiver mReceiver = new ScreenReceiver();
        registerReceiver(mReceiver, filter);
        this.mReceiver = mReceiver;

        mReceiver.registerListener(this);

        isScreenRegistered = true;
    }

} 
```

服务销毁（）

```
// stopping service
public void serviceDestroy()    {

    if (this.mPosition != null) {
    this.mPosition.unregister();
    }

    Log.v("service", "Destroyed");

    if(isScreenRegistered)  {
        unregisterReceiver(mReceiver);
        isScreenRegistered = false;
    }

} 
```

OnDestroy()

```
public void onDestroy () {
    serviceDestroy();

    if(isCRRegistered)  {

        unregisterReceiver(mCallReceiver);
        isCRRegistered = false;

        }
} 
```

# python - Tkinter - Canvas.move() 不会移动列表中的最后一项

> ID：14429134
> 
> 赞同：1
> 
> 时间：2013-01-20T20:47:13.747
> 
> 标签：python, canvas, tkinter, move

我正在尝试使用 Tkinter 编写一个蛇游戏程序 我的蛇由下面定义的圆圈列表组成。但是，当我调用 move 方法时，最后一个不会移动。问题是什么？

```
 class Circle:

   def __init__(self,canv,x,y,index,direc):
        self._x = x
        self._y = y
        self._index = index
        self._direction = direc
        self._canvas = canv
        coordinat = (self._x)-5,(self._y)-5,(self._x)+5,(self._y)+5

        if index==0:
            color = "gold"
        else:
            color = "green"

        self._circle = canv.create_oval(coordinat ,fill=color, tags=str(self._index))

   def _move(self):
      if self._direction == "up":
         delta = (0,-5)
      elif self._direction == "down":
         delta = (0,5)
      elif self._direction == "left":
         delta = (-5,0)
      elif self._direction == "right":
         delta = (5,0)

      tag = str(self._index)
      self._canvas.move(tag, delta[0],delta[1]) 
```

她就是我所说的

```
self._canvas = Canvas(self._playArea,width=750,height=450,bg="#1C1C1C")
    x = int(self._parent.winfo_width() / 4.)
    y = int(self._parent.winfo_height()/ 4.)
    circle = Circle(self._canvas,x,y,0,"right")
    self._circleList.append(circle)
    self._addCircle()
    self._addCircle()
    self._addCircle()
    self._addCircle()
    self._addCircle()

    self._canvas.place(x=0, y=0)

    for i in range(0,500):
       for x in self._circleList:
          x._move()
          root.update()
          root.after(10) 
```

这是 addCircle 方法

```
length = len(self._circleList)
    if self._circleList[length-1]._direction == "right":
        x = (self._circleList[length-1]._x)-10
        y = self._circleList[length-1]._y
        d = "right"
    elif self._circleList[length-1]._direction == "left":
        x = (self._circleList[length-1]._x) + 10
        y = self._circleList[length-1]._y
        d = "left"
    elif self._circleList[length-1]._direction == "up":
        x = self._circleList[length-1]._x
        y = (self._circleList[length-1]._y)+10
        d = "up"
    elif self._circleList[length-1]._direction == "down":
        x = self._circleList[length-1]._x
        y = (self._circleList[length-1]._y)-10
        d = "down"

    newCircle = Circle(self._canvas,x,y,length,d)
    self._circleList.append(newCircle) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:51:39.393

问题是您正在创建第一个项目`index=0`，然后使用它`index`作为标签来识别项目。你不应该使用整数作为标签，它是为项目的 id 保留的，但是，你毕竟可以使用它。除了`0`被 Tcl 评估为 false 之外，因此您没有有效地为它定义任何标签。事实证明，当您打电话时，`canvas.move(0, ...)`您不会移动任何创建的圆圈。但是您创建的下一个项目被分配了一个标签“1”，当您调用时，`canvas.move(1, ...)`您实际上是在移动您之前创建的项目（具有“金色”颜色的项目），因为它被 Tcl 自动分配了 id“1”。对创建的所有其他圆圈重复此操作。

解决它的快速方法是更改`index + 1`​​用于您传递的所有这些索引的代码。但是您包含的代码中有几个问题，所以这是一个修改后的代码，可以执行您所追求的：

```
import Tkinter

UP, RIGHT, DOWN, LEFT = range(4)

class Circle:
    def __init__(self, canv, x, y, direc, color):
        self.x, self.y = x, y
        self.direction = direc

        self._canvas = canv
        coord = (self.x)-5, (self.y)-5, (self.x)+5, (self.y)+5
        self._index = canv.create_oval(coord, fill=color)

    def move(self):
        y_sign = 1 if self.direction == DOWN else -1
        x_sign = 1 if self.direction == RIGHT else -1
        if self.direction in (UP, DOWN):
            delta = (0, y_sign * 5)
        else:
            delta = (x_sign * 5, 0)
        self._canvas.move(self._index, delta[0], delta[1])

def add_circle(canvas, l):
    d = l[-1].direction
    if d in (UP, DOWN):
        x = l[-1].x
        y = (1 if d == UP else -1) * 10 + l[-1].y
    else:
        x = (1 if d == LEFT else -1) * 10 + l[-1].x
        y = l[-1].y

    circle = Circle(canvas, x, y, d, "green")
    l.append(circle)

def move_circles(circle_l, root):
    for c in circle_l:
        c.move()
    root.after(50, lambda: move_circles(circle_l, root))

root = Tkinter.Tk()
width, height = 750, 450

canvas = Tkinter.Canvas(width=width, height=height, bg="#1C1C1C")
canvas.pack(fill=None, expand=False)

circle_l = []
circle = Circle(canvas, width / 4, height / 4, RIGHT, "gold")
circle_l.append(circle)
for _ in range(5):
    add_circle(canvas, circle_l)

move_circles(circle_l, root)

root.mainloop() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T09:30:31.897

不是一个真正的答案，但你可以让你的最后一段代码更短/更高效：

```
length = len(self._circleList)
    x = self._circleList[length-1]._x
    y = self._circleList[length-1]._y
    d = self._circleList[length-1]._direction

    if d == "right":
        x -= 10
    elif d == "left":
        x += 10
    elif d == "up":
        y += 10
    elif d == "down":
        y -= 10

    newCircle = Circle(self._canvas,x,y,length,d)
    self._circleList.append(newCircle) 
```

首先设置默认值，然后只修改`x`或`y`如果必须修改。

# visual-studio-2010 - Visual Studios 2010 程序无法启动，因为缺少 opencv_core243.dll

> ID：14429135
> 
> 赞同：4
> 
> 时间：2013-01-20T20:47:28.910
> 
> 标签：visual-studio-2010, opencv, dll

我正在学习如何使用 OpenCV，作为练习，我运行了一个程序（在发布模式下，x64）。我有 0 个编译器错误，但弹出屏幕显示：

> “程序无法启动，因为缺少 opencv_core243.dll”

但是，我确保我声明了正确的环境变量并指定了必要的库/目录。当我将以下 .dll 文件复制到 x64/Release 中时，我的问题得到了解决：

*   opencv_core243.dll
*   opencv_highgui243.dll
*   opencv_imgproc243.dll

我的程序现在编译得很好并且可以工作。但是，我想知道为什么。复制和粘贴这些 .dll 文件感觉很便宜。我是否错过了自动生成这些 .dll 文件的步骤？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T10:43:36.437

这个问题的实际解决方案是将opencv bin目录的路径附加到系统`PATH`环境变量中。

查看[此答案](https://stackoverflow.com/a/13231205/1231073)，描述在 Visual Studio 2010 中安装 OpenCV 的完整过程。

这种方法有一个缺点。预构建的 OpenCV x86 和 x64 二进制文件具有相同的名称。因此，通过将 OpenCV 的路径附加到`PATH`变量中，您可以一次执行 32 位版本或 64 位版本。要运行其他版本，您必须更改`PATH`变量。

对此的替代方案（我个人最喜欢的）还涉及将 dll 复制到输出目录，但这是在编译结束时自动完成的。我所做的是为 x86 和 x64 dll 路径创建新的环境变量。我创建用户变量`CV_BIN32`并`CV_BIN64`分别包含 x86 和 x64 dll 的路径。

创建用户变量后，打开您的 OpenCV 项目，转到`Project Properties`-> `Build Events`-> `Post-Build Event`-> `Command Line`。

在运行时为您需要的 dll 添加复制命令。

这个是针对 Win32 Release 配置的：

```
copy "$(CV_BIN32)\opencv_core243.dll" "$(OutDir)"
copy "$(CV_BIN32)\opencv_highgui243.dll" "$(OutDir)" 
```

您可以为所有 4 种配置更改它们，（调试/发布），（Win32/x64）

现在当项目构建过程完成时，指定的dll会自动复制到输出目录，并且不会显示错误。

# ios - UITabBar 无法更改选定的索引

> ID：14429140
> 
> 赞同：1
> 
> 时间：2013-01-20T20:47:50.347
> 
> 标签：ios, delegates, uitabbarcontroller, uitabbar

我无法更改我的 UITabBar 的索引。我正在尝试从 UITabBarController 子类中更改它。这就是我正在尝试的：

```
[self.tabBarController setSelectedIndex:1]; 
```

这就是我的 .h 的样子

```
#import <UIKit/UIKit.h>

@interface CustomTab : UITabBarController <UITabBarControllerDelegate>{
     IBOutlet CustomTab *bar;
}

@end 
```

我正在尝试使用 IBAction 设置索引，正在调用该方法，但索引没有改变。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:05:02.010

因为你在打电话

```
[self.tabBarController setSelectedIndex:1]; 
```

从 CustomTab 类本身内部。您需要将其替换为

```
[self setSelectedIndex:1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-25T22:01:24.537

为了迅速

```
override func viewWillAppear(_ animated: Bool) {
    self .selectedIndex = 3 // desired index
} 
```

# iphone - 从辅助线程使用 AVCaptureDevice

> ID：14429145
> 
> 赞同：0
> 
> 时间：2013-01-20T20:48:11.513
> 
> 标签：iphone, ios, ios5

我的应用程序正在 iphone 3g 和 ios 5.1 sdk 上进行测试，我正在使用`AVCaptureDevice`打开后置摄像头作为视频输入设备。我是从我使用创建的辅助线程执行此操作的`detachNewThreadSelector`。我还创建了一个预览层。我在屏幕上看不到任何东西，所以我想知道是否可以从辅助线程创建捕获会话。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:04:47.067

您无法在后台线程上执行具有您希望在 UI 中显示的效果的工作。

如果确实使用后台线程，则必须向主线程发出任何更改的信号并指示它显示它们。在视频捕获的情况下，这似乎不是解决此问题的可行方法。

# jquery - 使用 Fileupload asp.net mvc 和 Jquery 预览图像

> ID：14429149
> 
> 赞同：3
> 
> 时间：2013-01-20T20:48:51.403
> 
> 标签：jquery, asp.net-mvc

我正在尝试预览用户尝试上传的图像。这是我正在使用的代码。这在所有主要浏览器中都可以正常工作，但我想知道是否有更好的方法可以在不使用会话的情况下实现这一点（即使我正在清除会话）？我不想使用 Flash。

```
 @using (Html.BeginForm("UploadImage", "Home", FormMethod.Post, new { id = "fileuploadform", @enctype = "multipart/form-data" }))
    {
        <input id="fileupload" type="file" onchange="ChangeImage()" name="files" multiple>
        <div id="preview">
            <img src="#" id="imgThumbnail" alt="preview" />
        </div>

    }
            <script>
            $(function ChangeImage() {
                $('#fileuploadform').fileupload({
                    done: function (e, data) {
                        var d = new Date();
                        $('#imgThumbnail')[0].src = "/Home/ImageLoad?a=" + d.getTime();
                    }
                });
            });
        </script>

[HttpPost]
public ActionResult UploadImage(IEnumerable<HttpPostedFileBase> files, PostViewModel model)
{

    Session["ContentLength"] = Request.Files[0].ContentLength;
    Session["ContentType"] = Request.Files[0].ContentType;
    byte[] b = new byte[Request.Files[0].ContentLength];
    Request.Files[0].InputStream.Read(b, 0, Request.Files[0].ContentLength);
    Session["ContentStream"] = b;
    return Content(Request.Files[0].ContentType + ";" + Request.Files[0].ContentLength);
}

   public ActionResult ImageLoad(int? id)
    {
        byte[] b = (byte[])Session["ContentStream"];
        int length = (int)Session["ContentLength"];
        string type = (string)Session["ContentType"];
        Session["ContentLength"] = null;
        Session["ContentType"] = null;
        Session["ContentStream"] = null;
        return File(b, type);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T01:59:00.677

你试过这个解决方案吗？

> [在上传之前预览图像](https://stackoverflow.com/questions/4459379/preview-an-image-before-it-is-uploaded)

此解决方案是纯粹的客户端，在预览之前不需要上传到您的服务器。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-30T07:33:53.163

您可以通过这种方式改进您的操作代码：

```
HttpPostedFileBase picFile = Request.Files["fileUpload"];
if (picFile != null && picFile.ContentLength > 0)
{
     byte[] pic = new byte[picFile.ContentLength];
     picFile.InputStream.Read(pic, 0, picFile.ContentLength);
     // you can use pic ....
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-21T06:50:29.720

> 使用带有 Razor 框架和 jQuery 的 Fileupload Asp.Net C# MVC 预览图像？

这将一次预览多个文件作为缩略图图像。

**使用 Razor 框架查看 Asp.Net C# MVC**

```
<div class="form-group">
   @Html.LabelFor(model => model.ImageMedias)
   <div class="input-group">
      <div class="custom-file">
         @Html.TextBoxFor(model => model.ImageMedias, "", new { @class = "custom-file-input", @type = "file", @multiple = "multiple", @accept = ".jfif,.jpg,.jpeg,.png,.gif" })
         <label class="custom-file-label" for="InputFile">Choose file</label>
      </div>
   </div>
   @Html.ValidationMessageFor(model => model.ImageMedias)   
   <div id="divImageMediaPreview">
   </div>
</div> 
```

**脚本**

```
$("#ImageMedias").change(function () {
    if (typeof (FileReader) != "undefined") {
        var dvPreview = $("#divImageMediaPreview");
        dvPreview.html("");            
        $($(this)[0].files).each(function () {
            var file = $(this);                
                var reader = new FileReader();
                reader.onload = function (e) {
                    var img = $("<img />");
                    img.attr("style", "width: 150px; height:100px; padding: 10px");
                    img.attr("src", e.target.result);
                    dvPreview.append(img);
                }
                reader.readAsDataURL(file[0]);                
        });
    } else {
        alert("This browser does not support HTML5 FileReader.");
    }
}); 
```

我希望这将有所帮助。

# tfs - 在代码签入上运行代码分析

> ID：14429155
> 
> 赞同：2
> 
> 时间：2013-01-20T20:49:51.700
> 
> 标签：tfs, code-analysis, checkin

我正在使用 ac# mvc 4 项目，我在解决方案中的每个项目上都设置了代码分析。

我确实发现这会减慢构建项目所需的时间。但是，我确实发现该分析非常有益。

我使用 TFS 进行源代码控制。当项目正在构建但代码被检入源代码控制时，是否可以不进行此类分析？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:03:41.373

您可以在 TFS 构建定义中将执行代码分析设置为始终，但在项目文件中禁用它。

# javascript - 需要 JavaScript OOP 协助

> ID：14429159
> 
> 赞同：0
> 
> 时间：2013-01-20T20:50:04.890
> 
> 标签：javascript, oop

我有一些无法工作的 JavaScript 代码。我试过移动一些东西，改变一些关键词，但到目前为止没有任何效果。我让你们来试一试。

**这是 javascript 文件：**

```
 var GAME = {

  /////////////////////////////
  // GAME PROPERTIES         //
  /////////////////////////////

  /* LAYOUT PROPERTIES */
  ROWS: 3,
  COLS: 3,
  CELLS: {
    TOTAL: ROWS * COLS,
    CELL_SIZE: 25,
  },

  /////////////////////////////
  // GAME METHODS            //
  /////////////////////////////

  display: function() {

    alert( "ROWS: " + ROWS );
  }

}; 
```

**在单独的 HTML 网页上，我使用以下代码：**

```
<script type="text/javascript">
<!--
GAME.display();
//-->
</script> 
```

我已经在 firebug 上运行了代码，但出现以下错误：

*`TypeError: GAME is undefined`*

我已经尝试过了，但我无法让错误消失。帮助！

**提供完整的 HTML：**

```
<!doctype html>
<html>
  <head>

    <meta charset="utf-8">
    <title>JavaScript Canvas | Tic-Tac-Toe</title>

    <style type="text/css">
    #canvas01 {
      border: 1px solid #000;
    }
    </style>

    <!-- JQUERY -->

  </head>
<body>

<div id="canvas01"></div>

<script type="text/javascript" src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.3.1.min.js"></script>

<script type="text/javascript" src="game/core.js"></script>

<script type="text/javascript">

GAME.display();

</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:03:23.520

您不能在实例化点基于同一对象内的另一个属性定义对象的属性。现在，阻止 GAME 被定义的罪魁祸首是 TOTAL 的赋值（你的 JS 运行时会抛出一个 TypeError 说 ROWS 是未定义的，因为它首先出现）。您应该始终使用局部变量来定义对象的属性，因为谁知道您的游戏何时需要不同的要求？另外，请注意，`this`当您想要显示行数时，应该使用 指向对象的上下文。你必须做这样的事情：

```
var rows = 3, cols = 3, cellSize = 25;

var GAME = {

/////////////////////////////
  // GAME PROPERTIES         //
  /////////////////////////////

  /* LAYOUT PROPERTIES */
  ROWS: rows,
  COLS: cols,
  CELLS: {
    TOTAL: rows * cols,
    CELL_SIZE: cellSize,
  },

  /////////////////////////////
  // GAME METHODS            //
  /////////////////////////////

  display: function() {
    alert( "ROWS: " + this.ROWS );
  }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:14:31.720

@danronmoon 在正确的轨道上，在这里。

***首先，如果这将是一个充满嵌套对象的 BIG 对象，则在***创建对象之前，您无法访问分配给其他属性的值。

```
var obj = {
    a : 1,
    b : 2,
    c : a + b // won't work for 2 reasons
}; 
```

其次，如果不将属性分配给函数中的变量***或***引用完整链，则无法引用属性：

```
var obj = { a : 1, b : 2, c : null };

obj.c = obj.a + obj.b;
obj.c; // 3 
```

现在它起作用了。

或者：

```
var obj = {
    a : 1,
    b : 2,
    c : null,
    initialize : function () {
        obj.c = obj.a + obj.b;
    }
};

obj.initialize(); 
```

***或者***

```
var obj = {
    // ...
    initialize : function () {
        this.c = this.a + this.b;
    }
}; 
```

最后一种形式的一个警告： `this`指向比函数高一级，所以你只能访问函数的兄弟。

```
var obj = {
    level : 1,
    init : function () {
        // this === obj
    },
    nested : {
        level : 2,
        init : function () {
            // this === obj.nested
        },
        nested : {
            level : 3,
            init : function () {
                // this === obj.nested.nested
            }
        }
    }
}; 
```

`this`除非您在对象中存储对的引用或直接引用它，否则无法使用 访问链中更高的级别`parent`：

```
console.log( obj.nested.nested.level ); 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T21:36:09.847

以前的答案很好，但我只是想建议您*考虑*以这种方式制作游戏对象：

```
function Game() {
    var rows = 3,
        cols = 3,
        cells = {
            total: rows * cols, // no problem here
            cellSize: 25
        };
    this.display = function () {
        alert('ROWS: ' + rows); // or here
    };
}    
GAME = new Game(); 
```

这样，您可以按顺序编写程序逻辑，并定义变量和函数，而无需它们始终是对象的可公开访问的属性。当然，您可以使用复杂的设计模式走得更远，但对我来说，如果您刚刚开始使用 OO javascript，那么这是一个很好的起点，而且不那么违反直觉。

# php - phpexcel删除2个单元格之间的中间边界线？

> ID：14429162
> 
> 赞同：5
> 
> 时间：2013-01-20T20:50:08.157
> 
> 标签：php, phpexcel

在 phpexcel 中，我如何删除 2 个单元格之间的中间边界线？

像这张照片：![图片](../Images/e88cd25ef317bf7a75a722a88dd5b7a5.png)

它目前显示为：![在此处输入图像描述](../Images/0c7255f0040c40c1146d4934144d0719.png)

这是我当前的代码：

```
 $styleArray = array(
  'borders' => array(
    'allborders' => array(
      'style' => PHPExcel_Style_Border::BORDER_DOUBLE
    )
  )
);

$objPHPExcel->getActiveSheet()->getStyle("G".$rownum.":H".$rownum)->applyFromArray($styleArray);
unset($styleArray); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-19T18:09:18.713

虽然我同意您的方法有效@Dagon，但我觉得它有点混乱，但我建议使用“大纲”方法。像这样

```
'borders' => array(
   'outline' => array(
      'style' => PHPExcel_Style_Border::BORDER_DOUBLE
   ),
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T20:58:11.530

分别为单元格指定每一侧

```
 'borders' => array(
    'left' => array(
      'style' => PHPExcel_Style_Border::BORDER_DOUBLE,
    ),
    'right' => array(
      'style' => PHPExcel_Style_Border::BORDER_DOUBLE,
    ),
    'bottom' => array(
      'style' => PHPExcel_Style_Border::BORDER_DOUBLE,
    ),
    'top' => array(
      'style' => PHPExcel_Style_Border::BORDER_DOUBLE,
    ), 
```

一个单元格将有正确的“无”一个单元格将留下“无”

# java - 如果没有调用任何方法，我可以让对象返回默认值吗？

> ID：14429163
> 
> 赞同：3
> 
> 时间：2013-01-20T20:50:08.773
> 
> 标签：java

例如，我想模仿 String 对象的功能：

```
String mystring = new String ( "Hi there." );
System.out.println(mystring); // prints "Hi there." without calling any methods on String
                              // (that is what I want with my object)
System.out.println(mystring.toUpperCase()); // prints "HI THERE." 
```

从此开始：

```
class MyObject
{
    private Int value ;

    public MyObject ( Int value )
    {
        this.value = value ;
    }
    public Int getValue ( )
    {
        return this.value ;
    }
    public Int multiplyBy ( Int multiplier )
    {
        return this.value * multiplier ;
    }
} 
```

...如何（或我可以）做这样的事情：

```
MyObject myobject = new MyObject ( 6 ) ;
System.out.println( myobject ) ; // want to print myobject.value (6)
System.out.println( myobject.multiplyBy ( 2 ) ) ; // print 12 
```

我对 Java 很陌生，并意识到我可能缺少一些基本概念，但任何反馈都将不胜感激。谢谢你。

编辑：关于覆盖 toString 方法的响应很有帮助，但它并没有完全按照我的想法做，这是我想要的一个更好的例子：

```
Double mydouble = new Double ( 20.1 ) ;
System.out.println ( mydouble + 10.1 ) ; // prints 30.2 
```

我将如何使用我自己的对象执行此操作（假设我希望默认值为双精度）？

再次感谢。

最终编辑（希望如此）：您的回答足以让我了解更多有关 Primitive Wrappers 和 Autounboxing 的信息。我的理解是没有办法做我想做的事（在这一点上，我将其描述为将我的对象自动拆箱为双重），或者至少我会将其保存到另一个问题。干杯。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T20:51:41.587

是的，你可以做到：你需要做的就是覆盖`toString`：

```
public String toString() {
    return ""+this.value;
} 
```

这是有效的，因为`println`调用`toString`正在打印的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T20:53:10.867

`toString()method`在您的**MyObject 类**中覆盖。

```
private int value ;
public String toString() {
  return Integer.toString(this.value);
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T22:12:09.630

Java 总是首先执行“内部”语句。假设我们有一个 Double：

`Double db = new Double(20.1);`

然后你想这样做：

`System.out.println(db + 10)`

然后编译器将首先执行这部分`db + 10`，自动装箱/拆箱成为`db.doubleValue() + 10`评估为`30.1`. 然后用 评估外部函数 ( `System.out.println(x)`) `x=30`。

当您有以下代码`System.out.println(db + "hi")`时，编译器会看到您正在向`db`字符串添加一些东西 () ，`"hi"`因此会调用`.toString()`. `db`然后将（字符串）添加到“hi”，这将为您提供最终字符串：`"20.1hi"`

希望这可以帮助您了解幕后发生的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T20:52:15.903

只需让实例方法返回一个新实例：

```
public MyObject multiplyBy(int multipler)
{
    return new MyObject(value * multipler);
} 
```

（哦，那将是`int`，不是`Int`）

并实现 .toString()：

```
@Override
public String toString()
{
    return Integer.toString(value);
} 
```

# c++ - 将元素移出关联容器

> ID：14429167
> 
> 赞同：9
> 
> 时间：2013-01-20T20:50:27.553
> 
> 标签：c++, sorting, c++11, move-semantics, multiset

只是为了好玩，我实现了可以想象的最简单的排序算法：

```
template<typename Iterator>
void treesort(Iterator begin, Iterator end)
{
    typedef typename std::iterator_traits<Iterator>::value_type element_type;

    // copy data into the tree
    std::multiset<element_type> tree(begin, end);

    // copy data out of the tree
    std::copy(tree.begin(), tree.end(), begin);
} 
```

它只比`std::sort`我的测试数据慢 20 倍 :)

接下来，我想通过移动语义来提高性能：

```
template<typename Iterator>
void treesort(Iterator begin, Iterator end)
{
    typedef typename std::iterator_traits<Iterator>::value_type element_type;

    // move data into the tree
    std::multiset<element_type> tree(std::make_move_iterator(begin),
                                     std::make_move_iterator(end));
    // move data out of the tree
    std::move(tree.begin(), tree.end(), begin);
} 
```

但这并没有显着影响性能，即使我正在排序`std::string`s。

然后我记得关联容器从外部来看是恒定的，也就是说，`std::move`并且`std::copy`会在这里做同样的事情:(还有其他方法可以将数据移出树吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T21:11:09.287

`std::set`并且`std::multiset`只提供*`const`*对其元素的访问。这意味着您不能将某些东西移出集合。如果您可以将项目移出（或完全修改它们），则可以通过更改项目的排序顺序来破坏集合。所以 C++11 禁止它。

因此，您尝试使用该`std::move`算法只会调用复制构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T21:35:59.993

我相信您可以`multiset`为使用（第三个模板参数）创建一个自定义分配器，它实际上将其`destroy`方法中的元素移回用户的容器。然后擦除集合中的每个元素，并在销毁过程中将字符串移回原始容器。我认为自定义分配器需要有 2 阶段构造（将它传递给传递给您的`treesort`函数的开始迭代器以作为成员保存，但不是在构造期间，因为它必须是默认可构造的）。

`pop`显然，这会很奇怪，而且对于在 set/multiset 中没有方法是一种愚蠢的解决方法。但这应该是可能的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T00:44:14.780

我喜欢 Dave 的怪异分配器的想法，它可以记住每个移动构造对象的来源并在销毁时自动移回，我从没想过这样做！

但这里有一个更接近您最初尝试的答案：

```
template<typename Iterator>
void treesort_mv(Iterator begin, Iterator end)
{
    typedef typename std::iterator_traits<Iterator>::value_type element_type;

    // move the elements to tmp storage
    std::vector<element_type> tmp(std::make_move_iterator(begin),
                                  std::make_move_iterator(end));
    // fill the tree with sorted references
    typedef std::reference_wrapper<element_type> element_ref;
    std::multiset<element_ref, std::less<element_type>> tree(tmp.begin(), tmp.end());

    // move data out of the vector, in sorted order
    std::move(tree.begin(), tree.end(), begin);
} 
```

这是一种`multiset`参考，因此不需要将它们移出树。

但是，当移回原始范围时，移动分配对于自分配来说不一定是安全的，所以我先将它们移动到一个向量中，这样在将它们重新分配回原始范围时就不会出现自分配。

在我的测试中，这比您的原始版本*略*快。它可能会降低效率，因为它必须分配向量以及所有树节点。那以及我的编译器使用 COW 字符串的事实，所以移动并不比复制快多少。

# xml - JAXB / XJC - 从 XS:Group 生成一个类

> ID：14429168
> 
> 赞同：3
> 
> 时间：2013-01-20T20:50:35.223
> 
> 标签：xml, jaxb, xjc

我是第一次使用 JAXB，并且有一些我无法更改的非常糟糕的 XML，我想为其生成类。

XML 看起来像这样：

```
<root>
   <contacts>
      <name>...</name>
      <phone>...</phone>
      <address>..</address>
      <name>...</name>
      <phone>...</phone>
      <address>..</address>
      <name>...</name>
      <phone>...</phone>
      <address>..</address>
  </contacts>
</root> 
```

所以我想好吧，也许我可以将联系人元素称为一组组。相关部分：

```
<xs:group name="Contact">
    <xs:sequence>
        <xs:element name="name" type="xsd:string"/>
        <xs:element name="phone" type="xsd:string"/>
        <xs:element name="address" type="xsd:string"/>
    </xs:sequence>
</xs:group>

<xs:complexType name="ContactList">
    <xs:sequence><xs:group maxOccurs="unbounded" ref="Contact"/></xs:sequence>
</xs:complexType> 
```

但是，我的 ContactList 对象只有一个如下所示的 getter：

`public List<JAXBElement<?>> getContact()`

为什么没有声明 Contact 对象，我该如何解决这个问题？我认为我不能将 Contact 声明为复杂类型，因为它不包含在元素中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T00:23:48.020

我认为最好的办法是首先使用 XSLT 将坏的 XML 转换为好的 XML。然后用 Java 处理数据会容易得多。（谁知道呢，也许您可​​以完全在 XSLT 中处理数据并避免完全将其转换为 Java 格式。）如果没有合适的结构可以使用，Java 映射可能会非常糟糕。

# javascript - 流星模板不起作用

> ID：14429175
> 
> 赞同：3
> 
> 时间：2013-01-20T20:51:26.637
> 
> 标签：javascript, node.js, meteor

我对 Meteor 还是很陌生，所以我认为我搞砸了一些非常简单的事情。

我正在尝试使用模板制作一个超级简单的 hello world，然后将字符串输入其中。

```
## client/body.html ##
<body>
    <div>
        {{> greeter }}
    </div>
</body>

## client/templates/greeter.html ##
<template name="greeter">
    <h1>Hello {{ name }}</h1>
</template>

## client/greeter.js ##
Template.greeter({ name: "giodamelio" }); 
```

我的输出只是

```
<h1>Hello </h1> 
```

为什么我的模板不渲染？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:45:26.500

您的模板正在呈现，但存在三个问题：**（1）**更改`name`为`myName`或其他内容，因为它是保留字，**（2）**折叠`{{ name }}`成`{{myName}}`（没有空格）；( **3)**仍然是空白的`{{myName}}`，因为您的连线代码有点不对劲。用这个替换你在 greeter.js 中的内容：

```
Template.greeter.myName = function() {
   return "giodamelio"
}; 
```

# php - 在 php 中使用 GET 获取使用 jQuery 的 $.param(data) 生成的数据时，有 %5B 和 %5D

> ID：14429177
> 
> 赞同：0
> 
> 时间：2013-01-20T20:51:38.843
> 
> 标签：php, jquery, ajax

我在 ajax 调用中使用了名为 rowdata 的 JSON 数据。如果我使用：

```
JSON.stringify(rowdata) 
```

它如下所示：

```
{"Description":"qwerty","Code":"12345","Size":"11","Colour":"green"} 
```

我确实将它发送到 php 并使用 GET 语句（Joomla 的

```
JRequest::getVar("Description",  "", "", "") 
```

语句）来获取rowdata的元素，但我不能成功。

如果我查看已发送的 ajax 数据，我确实有以下内容：

```
rowdata%5BDescription%5D=qwerty 
```

等申请后：

```
$.param(data) 
```

我使用了许多版本而不是“描述”，但无济于事。我试图自己获取行数据并访问其元素，但没有成功。我无法找出 %5B 和 %5D 的含义，使用 % 符号进行搜索是有问题的。谁能帮助在php中获取Description、Code等的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T20:54:57.587

您正在发送 JSON，但试图将其解析为`application/x-www-form-urlencoded`数据。

不要将对象转换为 JSON。

```
$.get('example.php', {"Description":"qwerty","Code":"12345","Size":"11","Colour":"green"}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T20:55:03.403

我相信`%5B`是`[`和`%5D`是`]`。您的网址正在编码特殊字符。它被称为[URL 编码](http://en.wikipedia.org/wiki/Percent-encoding)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T20:56:56.613

如果您想使用 get... 推送数据，请不要使用 JSON，否则它将被编码以满足 JSON 格式，您将获得这些实体。

```
$.get('target.php', {"Description":"qwerty","Code":"12345","Size":"11","Colour":"green"}); 
```

# android - 如何从自己的应用程序中确定应用程序版本

> ID：14429187
> 
> 赞同：0
> 
> 时间：2013-01-20T20:51:59.600
> 
> 标签：android

场景是我的应用程序搜索所有已安装的应用程序以确定这些应用程序的版本。然后将应用程序的名称及其版本存储在同一文件中。如果有新版本的应用程序可用，则向用户发出通知。问题是“如何从我的应用程序中了解其他应用程序的版本？”

感谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:08:41.240

像这样的东西应该可以获取当前版本：

```
List<PackageInfo> packages = getPackageManager().getInstalledPackages();

for(int i=0;i<packages.size();i++)
{
    int version = packages.get(i).versionCode;
    // do whatever with it here
} 
```

不过，在 Play 商店中获取最新版本并没有真正起作用。就像 A--C 说的那样，您可以`versionName`改为检查，如果两者不完全相同，只需通知更新（不要担心更高/更低，只是不等式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:15:34.557

您可以执行以下操作（在 Activity 或任何其他上下文中）

```
getPackageManager().getPackageInfo(getPackageName(), 0).versionName
getPackageManager().getPackageInfo(getPackageName(), 0).versionCode 
```

# windows - xterm 转义序列（如“Esc | 112 m”）在哪里定义？

> ID：14429197
> 
> 赞同：6
> 
> 时间：2013-01-20T20:52:35.360
> 
> 标签：windows, vim, xterm, ansi-escape

在 ConEmu 中实现 xterm-256-colors 时，我发现了一些未知的转义序列（由 Vim 使用），例如

```
Esc | 7 m
Esc | 15 m
Esc | 112 m 
```

从 Vim 来源我意识到这些代码用于更改粗体或反转属性，但我找不到任何关于它们的文档。

`Esc | N m`序列有规范吗？[这里](http://invisible-island.net/xterm/ctlseqs/ctlseqs.html)没有提到它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T21:22:19.047

我相信这些只是内部处理的内部 vim 代码：​​第一组`\033|`被标记

```
/*
 * GUI pseudo term-cap.
 */ 
```

并且 AFAIR 在`gui.c`or中处理`gui_*.c`，第二组被标记

```
/*
 * These codes are valid for the pc video.  The entries that start with ESC |
 * are translated into conio calls in os_msdos.c. Default for MSDOS.
 */ 
```

第三组被标记

```
/*
 * These codes are valid for the Win32 Console .  The entries that start with
 * ESC | are translated into console calls in os_win32.c.  The function keys
 * are also translated in os_win32.c.
 */ 
```

（我说的是[`builtin_termcaps`数组](https://bitbucket.org/ZyX_I/vim/src/9e415188331c2f84e11fe759ca554b36fa62ec2e/src/term.c#cl-148)）。进一步提到：只有在[`update_tcap`function](https://bitbucket.org/ZyX_I/vim/src/9e415188331c2f84e11fe759ca554b36fa62ec2e/src/term.c#cl-5976)中，没有直接引用这些是由其他一些函数处理的，但不太可能是其他东西（不熟悉伪termcap处理代码）。除了`term.c`它只`\033|`在`screen.c`（两次）和`gui.c`（一次）中直接看到（即 grep 发现）。

而且，顺便说一句，我没有在使用`env TERM=xterm vim {args}`.

# multithreading - node.js 集群中的子进程间通信选项

> ID：14429203
> 
> 赞同：13
> 
> 时间：2013-01-20T20:53:00.363
> 
> 标签：multithreading, node.js, redis, zeromq, dnode

所以我现在正在开发一个 node.js 游戏服务器应用程序，我在这里遇到了一些障碍。我的问题是我正在使用 socket.io 接受来自游戏客户端的入站连接。这些客户端可能连接到游戏世界的几个区域或区域之一。

基本架构如下所示。主进程为运行 Zone Manager 进程的游戏的每个 Zone 派生一个子进程；专用于维护区域数据（3d 模型、玩家/实体的位置等）的过程。然后，主进程为它创建的每个区域管理器派生多个“通信线程”。这些线程创建一个 socket.io 实例并监听该区域的端口（多个线程监听一个端口）。这些线程将在自己的进程中处理大部分游戏逻辑，并与支持游戏服务器的数据库进行通信。唯一的问题是，在某些情况下，他们可能需要与区域管理员沟通以接收有关区域、玩家等的信息。

![建筑学](../Images/b416e48c1370da4bf6e7b687f676c9a3.png)

例如：玩家想要与区域中的非玩家角色 (NPC) 进行买卖/交易。区域通信线程需要询问区域管理器线程，如果玩家距离 NPC 足够近，可以进行交易，然后才允许交易发生。

我在这里遇到的问题是我打算利用 node.js 集群功能并使用进程的`send()`和`on()`方法来处理来回传递消息。这很好，除了我遇到的一个警告。由于所有子进程都与`cluster.fork()`只能与“主”进程通信。node.js 根进程成为所有通信的瓶颈。我使用一个脚本在我的系统上运行了一些基准测试，该脚本实际上只是使用集群的进程间通信 (IPC) 来回反弹一条消息，并跟踪每秒执行了多少次中继。就它可以中继的 IPC 数量而言，似乎最终节点的上限约为每秒 20k。这个数字在 Phenom II 1.8ghz 四核笔记本电脑和 FX-8350 4.0ghz 8 核台式机上都是一致的。

现在这听起来相当高，除了这基本上意味着无论有多少区域或通信线程，所有 IPC 仍然通过充当整个应用程序“中继”的单个进程成为瓶颈。这意味着虽然每个单独的线程似乎每秒可以中继 > 20k IPC，但整个应用程序作为一个整体永远不会中继超过这个数量，即使它在一些疯狂的 32 核系统上，因为所有通信都通过单个线程进行。

这就是我遇到的问题。现在进退两难了。我已经阅读了很多关于那里的各种其他选项的内容，并且在堆栈上阅读了关于这个主题的 20 个不同的问题，并且我经常看到一些事情弹出：

**[Redis](http://redis.io/)：** 我现在实际上在我的服务器上运行 Redis，并将其用作 socket.io 数据存储，以便多个线程中的 socket.io 可以共享连接数据，以便用户可以连接到 N 个 socket.io 中的任何一个区域的线程，以便服务器可以自动对传入连接进行负载平衡。

我对此的担心是它通过网络堆栈运行。几乎不适合同一服务器上的多个进程之间的通信。我觉得从长远来看，延迟将是一个主要问题。

**[0MQ (zeromq/zmq)](http://www.zeromq.org/)：** 我以前从未将这个用于任何事情，但我最近听到了一些关于它的消息。根据我所做的阅读，我发现了很多人将它与 TCP 套接字一起使用的例子，但关于人们将它用于 IPC 的讨论并不多。我希望也许这里有人曾经使用过 0MQ for IPC（甚至可能在 node.js 中？）并且可以为我提供一些关于这个选项的信息。

**[dnode](https://github.com/substack/dnode)：** 同样，我从未使用过它，但从我所见，它看起来像是另一种设计用于通过 TCP 工作的选项，这意味着网络堆栈再次受到阻碍。

**[node-udpcomm](https://github.com/SGF-Games/node-udpcomm)：** 有人在这里的另一个问题中链接了这个（不幸的是，我似乎无法再次找到）。我什至从未听说过它，它看起来像是一个非常小的解决方案，可以打开并侦听 UDP 连接。尽管这可能仍然比 TCP 选项更快，但我们仍然有网络堆栈，对吗？我绝对像这里一样在我的“程序员区”之外大约一英里，并且很好地进入了我不太了解的网络/计算机架构领域，哈哈

无论如何，底线是我完全被困在这里，不知道在这种情况下 IPC 的最佳选择是什么。我目前假设 0MQ 是我上面列出的那些选项中的最佳选择，因为它似乎是唯一一个为通信协议提供“IPC”选项的选项，我认为这意味着它使用的是 UNIX 套接字或其他东西没有通过网络堆栈，但我无法确认或任何事情。

我想我只是希望这里的一些人知道的足够多，可以为我指出正确的方向，或者告诉我我已经去那里了。我正在从事的项目是一个多人游戏服务器，旨在“开箱即用”地与多人游戏客户端一起使用 Three.js 为其 3D 图形/计算提供动力。一旦我让它们都工作到我满意，客户端和服务器就会对所有人开放源代码，我想确保架构尽可能可扩展，这样人们就不会在此基础上构建游戏然后再去扩展起来并最终撞到墙上。

无论如何，如果你真的阅读了所有这些，谢谢你的时间:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T02:07:06.880

我认为 0MQ 将是一个非常好的选择，但我承认我不认识其他人 :D

对于 0MQ，您决定使用什么传输是透明的，库调用是相同的。它只是在调用期间`zmq_bind`和`zmq_connect`开始时选择特定的端点（以及因此传输）。基本上你可以决定采取 4 条路径：

1.  `"inproc://<id>"`- 通过内存在线程之间进行进程内通信端点
2.  `"ipc://<filepath>"`- 系统相关的进程间通信端点
3.  `"tcp://<ip-address>"`- 清除
4.  `"pgm://..."`或`"epgm://..."`- Pragmatic Reliable Multicast 的端点

简而言之，您在列表中的位置越高，速度越快，并且考虑到您必须面对的延迟和可靠性问题就越少。所以你应该尽量保持尽可能高。由于您的组件是进程，因此您自然应该使用 IPC 传输。如果您以后需要更改某些内容，只需更改端点定义即可。

现在，实际上比您选择的传输更重要的是套接字类型，或者更确切地说是您决定使用的模式。您的情况是一种典型的请求-响应式通信，因此您可以这样做

1.  管理器：REP 套接字，线程：REQ 套接字；或者
2.  经理：ROUTER，线程：REQ 或 DEALER

然后线程将它们的套接字连接到分配给它们的单个管理器套接字，仅此而已，它们可以开始发送请求并等待响应。他们所要决定的只是他们用作端点的路径。

但是详细描述所有这些套接字类型和模式的含义绝对超出了本文的范围，但是您可以并且应该在[ZeroMQ 指南](http://zguide.zeromq.org)中阅读更多相关信息。在那里，您不仅可以了解所有套接字类型，还可以了解如何连接组件并让它们相互通信的许多不同方式。我提到的只是一个非常简单的。一旦你理解了，你就可以建立任意的层次结构。就像乐高;-)

希望对你有所帮助，加油！

# jquery - 带有哈希永久链接的 jQuery 循环

> ID：14429209
> 
> 赞同：0
> 
> 时间：2013-01-20T20:53:29.560
> 
> 标签：jquery, hash, cycle, jquery-cycle

我试图让 jQuery Cycle 使用每张幻灯片中的唯一名称，以便能够直接链接到每张幻灯片。我在 malsups 网站上找到了这个：http: [//jquery.malsup.com/cycle/perma2.html](http://jquery.malsup.com/cycle/perma2.html)

尝试将其合并到我的演示中，但无济于事，不确定我做错了什么？
**演示：http:** [//jsbin.com/uviram/1](http://jsbin.com/uviram/1)

即使我去`http://jsbin.com/uviram/1#slide2`它仍然引导我去`http://jsbin.com/uviram/1#slide1`..

```
$(function() {

    var h, 
        hash = window.location.hash, 
        hashes = {},
        index = 0;

    $('.slideshow slide').each(function(i) {
        h = $(this).data('hash');
        hashes[h] = i;
    });

    if (hash)
        index = hashes[hash.substring(1)] || index;

    $('.slideshow').cycle({
        fx: 'scrollHorz',
        timeout: 0,
        prev: $('.prev'),
        next: $('.next'),
        after: function(curr,next,opts) {
            h = $(this).data('hash');
            window.location.hash = h;
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:34:45.473

我已经更新了你的 jsbin 演示，所以它现在可以工作了。出现了三个问题：

*   首先，我改为`$('.slideshow slide')`正确`$('.slideshow .slide')`选择幻灯片。

*   其次，我将startingSlide选项放入循环调用中。

*   最后，我放入了一个 hashchange 监听器，这样如果用户在没有重新加载页面的情况下更改了 hash，它将循环到正确的幻灯片。

看看你更新的演示，看看它是否有效：

[http://jsbin.com/uviram/6#slide4](http://jsbin.com/uviram/6#slide4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:22:11.633

您没有包括将您传递给的`startingSlide`选项`index`

```
$('.slideshow').cycle({
        /* pass index to startingSlide*/
        startingSlide:index,
        fx: 'scrollHorz',
        timeout: 0,
        prev: $('.prev'),
        next: $('.next'),
        after: function(curr,next,opts) {
            h = $(this).data('hash');
            window.location.hash = h;
        }
}); 
```

# ios - 使用 OAuthConsumer 通过 iOS 访问 Yelp API

> ID：14429210
> 
> 赞同：2
> 
> 时间：2013-01-20T20:53:34.193
> 
> 标签：ios, api, oauth, hyperlink, yelp

Yelp 在他们的网站上有一个 API 链接：[http ://www.yelp.co.uk/developers/documentation/v2/authentication](http://www.yelp.co.uk/developers/documentation/v2/authentication)

我正在尝试使用 iOS 访问它（使用[此](https://github.com/Yelp/yelp-api/tree/master/v2/ios)API），但我对 OAuth 很陌生。

有人可以提供一些如何使用这个 API 的示例 Objective-C 吗？

我能找到的唯一需要一个“获取请求令牌”URL，而 Yelp 不需要这个，因为它使用签名。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T20:33:25.047

我不知道它是否有帮助，但是您看过他们的 github 示例吗？这应该会给你一些启发[https://github.com/Yelp/yelp-api/tree/master/v2/ios/YelpAPI](https://github.com/Yelp/yelp-api/tree/master/v2/ios/YelpAPI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-26T01:30:38.073

您提到的 github 示例有一个测试，该测试演示了如何查询纽约的餐馆，这对我有用。

您需要进行编辑`Tests/OAuthTest.m`以提供您的 OAuth 信息（即将字符串`"CONSUMER_KEY"`、`"CONSUMER_SECRET"`、`"TOKEN"`、替换为`"TOKEN_SECRET"`有效值）。

然后你需要确保你正在构建`Tests`目标。至少对我来说，默认值是`YelpAPI`目标。

# android - JNI 中的“jobject thiz”是什么，它的用途是什么？

> ID：14429213
> 
> 赞同：15
> 
> 时间：2013-01-20T20:53:45.310
> 
> 标签：android, android-ndk, java-native-interface

我很难找到答案。但是，JNI 函数调用中使用的“jboject thiz”是什么？例如：

```
jobjectArray Java_com_gnychis_awmon_Test( JNIEnv* env, jobject thiz ) { 
```

我`env`经常分配对象，但我从未使用过 thiz，我不确定它的用途。仅出于知识目的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-29T09:13:16.150

下面是一个 JNI 包装函数，它有两个参数，并返回一个原始对象数组：

```
jobjectArray Java_com_gnychis_awmon_Test( JNIEnv* env, jobject thiz ); 
```

从您给出的函数名称来看，我认为它并不完整，也就是说，您没有遵守强制性的函数名称约定，即：

1.  用Java_启动函数

2.  附加包名，用 _ 分隔（取消划线），即 com_company_awesomeapp。到目前为止，函数名由以下部分组成：Java_com_company_awesomeapp

3.  附加已定义本机方法的 Java 类名，后跟实际的函数名。所以此时我们应该有如下函数名：**Java_com_company_awesomeapp_MainActivity_Test**

第一个参数是一个指向存储所有 JNI 函数指针的结构的指针，即在您之后[可用的所有预定义函数](http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp9502)`#include <jni.h>`。

**第二个参数是对声明了该native方法的Java对象的引用。** [您可以使用它](http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/functions.html#wp16656)从当前JNI函数中调用Java对象的其他方法，即从C编写的JNI代码中调用Java实例方法或 C++。

例如，如果您在 MainActivity.java 文件中有以下 Java 类：

```
public class MainActivity extends Activity
{
    static
    {
        try
        {
            System.loadLibrary("mynativelib");
        }
        catch (UnsatisfiedLinkError ule)
        {
            Log.e(TAG, "WARNING: Could not load native library: " + ule.getMessage());
        }
    }

    public static native Object[] Test();
} 
```

然后，JNI 函数的**jobject thiz**参数将是对 MainActivity 类型对象的引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-10T01:50:11.037

我发现这个链接应该有助于澄清这个问题。

[https://library.vuforia.com/articles/Solution/How-To-Communicate-Between-Java-and-C-using-the-JNI](https://library.vuforia.com/articles/Solution/How-To-Communicate-Between-Java-and-C-using-the-JNI)

这是其中使用“jobject”的示例。

```
JNIEXPORT void JNICALL
Java_com_qualcomm_QCARSamples_ImageTargets_ImageTargets_initApplicationNative(
                            JNIEnv* env, jobject obj, jint width, jint height)
{
    ...
    jclass activityClass = env->GetObjectClass(obj);
    jmethodID getTextureCountMethodID = env->GetMethodID(activityClass,
                                                    "getTextureCount", "()I");
    if (getTextureCountMethodID == 0)
    {
        LOG("Function getTextureCount() not found.");
        return;
    }
    textureCount = env->CallIntMethod(obj, getTextureCountMethodID);
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T06:33:39.120

`jobject thiz`表示`this`in java 类。

有时，如果您创建这样的`static native`方法。

```
void Java_MyClass_method1 (JNIEnv *, jclass); 
```

`jclass`表示类本身。

# parsing - 没有替代的算术表达式的语法？

> ID：14429220
> 
> 赞同：1
> 
> 时间：2013-01-20T20:54:44.903
> 
> 标签：parsing, compiler-construction, grammar, context-free-grammar

如何为算术表达式编写明确的语法，例如 a+(b+c)*d

```
E -> E + T | T
T -> T * F | F
F -> ( E ) | i 
```

没有替代品 - 在我的情况下没有 |T 和 |F 和 |i

这应该可以通过在语法中添加更多句子来实现，但我很难弄清楚如何......注意：这是给大学的......所以可能不是一个好的现实世界语法:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:01:09.837

你要求的是不可能的。如果您的语法中没有替代产生式，那么就不可能决定使用哪些产生式。结果，您的语法要么不生成字符串，要么生成单个字符串。具有这些属性的文法称为[LL(0) 文法](https://stackoverflow.com/questions/5253816/are-there-such-a-thing-as-ll0-parsers)，根本不实用。

希望这可以帮助！

# data-structures - 链表运营成本

> ID：14429221
> 
> 赞同：0
> 
> 时间：2013-01-20T20:54:48.477
> 
> 标签：data-structures, linked-list, big-o

在链表中查找元素的成本是多少？我知道在平衡二叉搜索树中找到一个元素的成本是 O(log n)，但是链表呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:56:05.403

如果您对链表中的元素一无所知并且没有指向链表的指针，则在链表中搜索元素的成本在最好的情况下是 O(1)，在最坏的情况下是 O(n)。在最好的情况下，您会在最前面找到元素，而在最坏的情况下，您必须先查看所有元素，然后才能确定您要搜索的元素不存在。

在最坏的情况下，这比平衡二叉搜索树要慢得多，因此链表上有一些变体旨在加快访问速度。例如，[skip list](http://en.wikipedia.org/wiki/Skip_list)使用多个并行链表来“跳过”列表中的元素。这要求元素按排序顺序存储，但它确实将查找时间减少到预期的 O(log n)。

希望这可以帮助！

# java - Java中的十进制格式？

> ID：14429226
> 
> 赞同：5
> 
> 时间：2013-01-20T20:55:06.213
> 
> 标签：java

有人可以向我解释为什么这个输出：

```
 double y = 15/7;
    DecimalFormat first = new DecimalFormat("#.###");
    System.out.println(y); 
    String format_string = first.format(y);
    System.out.println(format_string); 
```

这是：

```
 2.0
   2 
```

（这是错的）

但是，当我将 15/7 更改为

```
 15.0/7.0 
```

它给了我正确的答案

```
 2.142857142857143
 2.143 
```

请解释一下？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T20:56:18.750

代替

```
double y = 15/7; 
```

和

```
double y = 15.0/7; 
```

当除以二`int`时，你得到一个`int`.

见[规格](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17.2)：

> 整数除法向 0 舍入。也就是说，在二进制数值提升（第 5.6.2 节）之后为整数的操作数 n 和 d 产生的商是一个整数值 q，其幅值尽可能大，同时满足 |d · q|。≤ |n|。此外，当 |n| 时 q 为正 ≥ |d| 并且 n 和 d 具有相同的符号，但是当 |n| 时 q 为负 ≥ |d| n 和 d 符号相反。

您`double`通过将其存储在`double`变量中将其转换为 a ，但为时已晚：您无法恢复丢失的精度。解决方案是让其中一个操作数为双精度，以便在除法时得到双精度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T20:56:59.750

没有点的数字是整数，所以 15/7 是整数运算，结果是 2（除法没有余数）。之后它被转换为双精度值，但保持它的值 2（完成操作后的转换）。

带点的数字首先是双精度数，因此 15.0/7.0 是双精度运算并导致您想要的结果（浮点除法）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-20T20:57:07.537

二`integers`除总是导致`integer`- 这就是你得到`2`（`2.0`格式化后）的原因。

至少一个除法`double`给你`double`

在您的情况下`15/7`，是两个整数的除法，结果是一个整数（*不正确的结果*）。如果您更改为`15/7.0`or`15.0/7`或`15.0/7.0`您的结果将是`double`（*正确的结果*）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T20:57:09.573

15/7 执行整数除法，向下舍入到最接近的整数。

15/7 = 2 + 1/7 -> 四舍五入为 2

将 y 定义为 double 并不重要，除法没有考虑到这一点，因为它使用了 2 个整数文字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-20T20:57:20.060

这是因为`15 / 7`它`2`返回除法运算的整数部分。如果您需要浮点值操作，请执行以下操作`15f / 7`：

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-20T20:57:50.637

这两个值都是整数，因此它们向下舍入为 7。由于整数除法的结果是整数，因此您需要确保除以双精度数/浮点数，因为这些除法的结果是可以处理小数的双精度数/浮点数部分数字

即使您指定了一个 double 以将除法的结果放入您实际输入的整数中，但除以 double 意味着结果是 double，因此答案包含正确的结果。

# c# - Windows 应用商店中的 SignalR

> ID：14429227
> 
> 赞同：-1
> 
> 时间：2013-01-20T20:55:31.487
> 
> 标签：c#, windows-runtime, signalr, windows-store-apps

我正在尝试通过 Nuget 在空白的 Windows Store 应用程序中安装 SignalR

```
Install-Package Microsoft.AspNet.SignalR -pre 
```

但我收到了这个错误消息：

```
Install-Package : Could not install package 'Microsoft.AspNet.SignalR.Core 1.0.0-rc2'. You are trying to install this package into a 
project that targets '.NETCore,Version=v4.5', but the package does not contain any assembly references that are compatible with that 
framework. For more information, contact the package author. 
```

如何在 Windows 应用商店应用中安装 SignalR？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T20:59:44.847

该错误提供了解决此问题所需的线索。您不能在 Windows App Store 应用程序（它是 SignalR 服务器）中使用整个 SignalR 包。

包/组件概述：

[https://github.com/SignalR/SignalR/wiki/Package-Overview](https://github.com/SignalR/SignalR/wiki/Package-Overview)

你需要客户端：

[http://nuget.org/packages/Microsoft.AspNet.SignalR.Client](http://nuget.org/packages/Microsoft.AspNet.SignalR.Client)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:22:57.053

您需要为 Windows 商店应用程序安装 Signalr 客户端。您可以通过安装以下软件包 Install-Package Microsoft.AspNet.SignalR.Client -pre 来做到这一点，它将安装

# php - 使用 PHP 和 MySQL 登录真的很慢

> ID：14429230
> 
> 赞同：2
> 
> 时间：2013-01-20T20:55:51.090
> 
> 标签：php, mysql, ajax

我正在开发一个旧网站广告，登录功能永远需要。我试图深入了解这只是我不确定是什么原因造成的。

登录功能使用 AJAX。

**AJAX**

```
$password = md5($_POST['thepassword']);
$user = $_POST['theusername'];

$loginVar = $usersClass->login($user, $password);

if(is_array($loginVar))
{
    $_SESSION['loggedIn'] = $loginVar; 
    @session_regenerate_id(true);

    print "success";

}else{
    print "Whoops, something went wrong! Try again.";
} 
```

**PHP 类**

```
public function login($username, $password)
{

    $rs = mysql_query("SELECT `id`,`active` from `$this->usersTable` WHERE 
        `username` = '".mysql_real_escape_string($username)."' AND 
        `password` = '".mysql_real_escape_string($password)."'");

    if($rs) {
        $row = @mysql_fetch_object($rs);

            return $this->userInfo($row->id);

    }else{
        return false;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:06:39.297

由于您没有索引，我建议在`username`and上添加一个复合索引`password`：

```
CREATE INDEX `idx_user_pass` ON `user_table` (`username`, `password`) 
```

查看[MySQL`CREATE INDEX`语法](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)以获取完整的详细信息。

正如我在评论线程中提到的那样，您的代码本身并没有什么慢的地方。

我会注意一些需要注意的事情（我怀疑你知道这一点，因为你已经是 SO 成员很长时间了）。建议去掉`@`错误抑制算子。您确实已经进行了错误检查`$rs`，因此这里不需要额外的抑制。

```
$row = @mysql_fetch_object($rs);
//----^^ 
```

而且我知道您已经熟悉 PDO 并从其他问题中准备了陈述，因此无需赘述...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:01:16.623

好吧，似乎代码本身一切正常，可能是服务器有问题，它会减慢脚本速度。另外，`$password = md5($_POST['thepassword']); $user = $_POST['theusername'];`：不要再使用 md5 散列，而是使用 sha2 和用户，请至少使用 mysql_real_escape_string 以确保其周围的安全性:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T21:03:32.047

1.  尝试使用 PDO 或 mysql_fetch_assoc，根据 PHP.net，此功能比 mysql_fetch_assoc 稍慢，

> 在速度方面，该函数与 mysql_fetch_array() 相同，并且几乎与 mysql_fetch_row() 一样快（差异不大）。

1.  回声比打印稍快；

但是，即使您的代码具有更好的性能，我也怀疑它与您的代码有关。我认为数据库有点慢，您是否在正在搜索的字段中使用带有索引的 INNODB？这个快很多。。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T21:07:37.543

首先，如评论中所述，您应该检查您的表是否有索引。为此，您可以通过运行以下查询来确定是否是这种情况：

`EXPLAIN SELECT id, active FROM [users_tables] WHERE `username` = '[username]' AND `password` = '[password]'`

（将 [...] 替换为权限值）

然后，我认为您应该避免在 session_generate_id 和 mysql_fetch_object 前面使用@。

此外，如果它没有执行另一个 MySQL 请求，请检查函数 userInfo，如果您有一个繁忙的表，最好在检查登录密码后获取所有数据而不是两次。

最后，将您的表（注意此过程，您可能会丢失数据）从 MyISAM 更改为 InnoDB，因为最后一个每行有一个锁，而 MyISAM 每个表都有一个锁。

# android - 通过 Google Drive API 从 MS Word doc 更新现有的本地 google drive doc

> ID：14429231
> 
> 赞同：1
> 
> 时间：2013-01-20T20:56:04.197
> 
> 标签：android, google-drive-api

要在我的 Android 应用程序上编辑 Google Drive 原生文档，我将文件下载为 .docx 格式（转换），在能够编辑 MS Word docx 文件的编辑器中编辑文件，然后将文件上传回它的原生谷歌文档格式。我正在使用以下代码：

```
File liveFileInfo = sService.files().get(mItem.getFileId()).execute();
mInputStream = new FileInputStream(pFile); //pFile is the java.io.File of the source XXX.docx file
InputStreamContent mediaContent = new InputStreamContent("application/vnd.openxmlformats-officedocument.wordprocessingml.document", 
                new BufferedInputStream(mInputStream));
mediaContent.setLength(pFile.length());

Drive.Files.Update update = sService.files().update(mItem.getFileId(), liveFileInfo, mediaContent);
update.setConvert(true);
MediaHttpUploader uploader = update.getMediaHttpUploader();
int chunkSize = getChunkSize(mItem);
uploader.setChunkSize(chunkSize);
uploader.setProgressListener(new MediaHttpUploaderProgressListener() {

            @Override
            public void progressChanged(MediaHttpUploader uploader)
                    throws IOException {
                // update UI
            }
        });
File uploadedFile = update.execute(); 
```

代码运行时没有错误，但文件内容包含您在上传错误格式或不正确文件类型时通常会看到的所有奇怪字符。

所以我的问题是是否可以使用此过程更新现有文件？还是仅 INSERTed 文件支持转换过程？上面的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T11:20:17.103

我弄清楚我错过了什么。将以下行添加到上面的代码中以解决问题：

```
liveFileInfo.setMimeType("application/vnd.openxmlformats-officedocument.wordprocessingml.document"); 
```

# java - JTable 模型侦听器过早检测到插入的行（在绘制之前）

> ID：14429242
> 
> 赞同：7
> 
> 时间：2013-01-20T20:57:07.740
> 
> 标签：java, swing, user-interface, jtable, listener

我有一个`JTable`可以由用户动态添加的行。它位于 a 中`JScrollPane`，因此当行数变得足够大时，滚动条就会变为活动状态。我的愿望是，当用户添加新行时，滚动条一直移动到底部，以便新行在滚动窗格中可见。我目前（下面的SSCCE）尝试使用表模型侦听器来检测何时插入行，并在进行检测时强制滚动条一直向下。然而，这种检测似乎“为时过早”，因为模型已经更新但新行实际上还没有被绘制，所以发生的情况是滚动条在插入新行**之前**一直移动到底部，并且然后将新行插入窗格末尾的正下方（不可见）。

显然，这种方法在某种程度上是错误的。什么是正确的方法？

```
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollBar;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTable;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;
import javax.swing.table.DefaultTableModel;

public class TableListenerTest {

    private JFrame frame;
    private JScrollPane scrollPane;
    private JTable table;
    private DefaultTableModel tableModel;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    TableListenerTest window = new TableListenerTest();
                    window.frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public TableListenerTest() {
        initialize();
    }

    private void initialize() {
        frame = new JFrame();
        frame.setBounds(100, 100, 450, 200);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.getContentPane().setLayout(new BoxLayout(frame.getContentPane(), BoxLayout.Y_AXIS));

        JSplitPane splitPane = new JSplitPane();
        frame.getContentPane().add(splitPane);

        scrollPane = new JScrollPane();
        scrollPane.setPreferredSize(new Dimension(100, 2));
        splitPane.setLeftComponent(scrollPane);

        tableModel = new DefaultTableModel(new Object[]{"Stuff"},0);
        table = new JTable(tableModel);
        scrollPane.setViewportView(table);
        table.getModel().addTableModelListener(new TableModelListener() {
            public void tableChanged(TableModelEvent e) {
                if (e.getType() == TableModelEvent.INSERT) {
                    JScrollBar scrollBar = scrollPane.getVerticalScrollBar();
                    scrollBar.setValue(scrollBar.getMaximum());
                }
            }
        });

        JButton btnAddRow = new JButton("Add Row");
        btnAddRow.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent e) {
                tableModel.addRow(new Object[]{"new row"});
            }
        });
        splitPane.setRightComponent(btnAddRow);
    }
} 
```

编辑：根据trashgod 的要求更新了下面的SSCCE。这个版本仍然不起作用，但是，如果我像他一样将滚动逻辑从表模型侦听器移动到按钮侦听器，那么它确实有效！

```
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Rectangle;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;

import javax.swing.BoxLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTable;
import javax.swing.event.TableModelEvent;
import javax.swing.event.TableModelListener;
import javax.swing.table.DefaultTableModel;

    public class TableListenerTest {

        private JFrame frame;
        private JScrollPane scrollPane;
        private JTable table;
        private DefaultTableModel tableModel;

        public static void main(String[] args) {
            EventQueue.invokeLater(new Runnable() {
                public void run() {
                    try {
                        TableListenerTest window = new TableListenerTest();
                        window.frame.setVisible(true);
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
            });
        }

        public TableListenerTest() {
            initialize();
        }

        private void initialize() {
            frame = new JFrame();
            frame.setBounds(100, 100, 450, 200);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.getContentPane().setLayout(new BoxLayout(frame.getContentPane(), BoxLayout.Y_AXIS));

            JSplitPane splitPane = new JSplitPane();
            frame.getContentPane().add(splitPane);

            scrollPane = new JScrollPane();
            scrollPane.setPreferredSize(new Dimension(100, 2));
            splitPane.setLeftComponent(scrollPane);

            tableModel = new DefaultTableModel(new Object[]{"Stuff"},0);
            table = new JTable(tableModel);
            scrollPane.setViewportView(table);
            table.getModel().addTableModelListener(new TableModelListener() {
                public void tableChanged(TableModelEvent e) {
                    if (e.getType() == TableModelEvent.INSERT) {
                        int last = table.getModel().getRowCount() - 1;
                        Rectangle r = table.getCellRect(last, 0, true);
                        table.scrollRectToVisible(r);
                    }
                }
            });

            JButton btnAddRow = new JButton("Add Row");
            btnAddRow.addMouseListener(new MouseAdapter() {
                @Override
                public void mouseClicked(MouseEvent e) {
                    tableModel.addRow(new Object[]{"new row"});
                }
            });
            splitPane.setRightComponent(btnAddRow);
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T21:12:28.523

此[示例](https://stackoverflow.com/a/7519403/230513)用于`scrollRectToVisible()`（有条件地）滚动到最后一个单元格矩形。作为一项功能，您可以单击拇指暂停滚动并释放以恢复。

```
private void scrollToLast() {
    if (isAutoScroll) {
        int last = table.getModel().getRowCount() - 1;
        Rectangle r = table.getCellRect(last, 0, true);
        table.scrollRectToVisible(r);
    }
} 
```

附录：我*在我的 SSCCE 中**尝试过，它仍然出现同样的问题。* `scrollRectToVisible`

 *这`Action`提供了鼠标和键盘控制：

```
JButton btnAddRow = new JButton(new AbstractAction("Add Row") {

    @Override
    public void actionPerformed(ActionEvent e) {
        tableModel.addRow(new Object[]{"new row"});
        int last = table.getModel().getRowCount() - 1;
        Rectangle r = table.getCellRect(last, 0, true);
        table.scrollRectToVisible(r);
    }
}); 
```

![在此处输入图像描述](../Images/57fbfc07351d6aca1d59c3750c8d3006.png)

附录：这是您示例的一个变体，说明了修改后的布局策略。

```
/** @see https://stackoverflow.com/a/14429388/230513 */
public class TableListenerTest {

    private static final int N = 8;
    private JFrame frame;
    private JScrollPane scrollPane;
    private JTable table;
    private DefaultTableModel tableModel;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                TableListenerTest window = new TableListenerTest();
                window.frame.setVisible(true);
            }
        });
    }

    public TableListenerTest() {
        initialize();
    }

    private void initialize() {
        frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new BoxLayout(frame.getContentPane(), BoxLayout.X_AXIS));
        tableModel = new DefaultTableModel(new Object[]{"Stuff"}, 0);
        for (int i = 0; i < N; i++) {
            tableModel.addRow(new Object[]{"new row"});
        }
        table = new JTable(tableModel) {

            @Override
            public Dimension getPreferredScrollableViewportSize() {
                return new Dimension(200, table.getRowHeight() * N);
            }
        };
        scrollPane = new JScrollPane();
        scrollPane.setViewportView(table);
        JButton btnAddRow = new JButton(new AbstractAction("Add Row") {

            @Override
            public void actionPerformed(ActionEvent e) {
                tableModel.addRow(new Object[]{"new row"});
                int last = table.getModel().getRowCount() - 1;
                Rectangle r = table.getCellRect(last, 0, true);
                table.scrollRectToVisible(r);
            }
        });
        frame.add(scrollPane);
        frame.add(btnAddRow);
        frame.pack();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T13:35:34.193

> 然而，这种检测似乎“为时过早”

为了强调（@trashgod 已经在评论中提到它）：这是真的 - 并且是 Swing 中一个相当普遍的问题 :-)

该表 - 以及任何其他具有任何模型的视图，不仅是数据，还有选择、调整…… - 正在监听模型以更新自身。因此，自定义侦听器只是该行中的另一个侦听器（服务序列未定义）。如果它想做一些依赖于视图状态的事情，它必须确保在所有内部更新都准备好*之后*这样做（在这个具体的上下文中，内部更新包括垂直滚动条的adjustmentModel的更新）推迟自定义处理在内部完成之前，通过包装 SwingUtilities.invokeLater 来实现：

```
TableModelListener l = new TableModelListener() {
    @Override
    public void tableChanged(TableModelEvent e) {
        if (e.getType() == TableModelEvent.INSERT) {
            invokeScroll();
        }
    }

    protected void invokeScroll() {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                int last = table.getModel().getRowCount() - 1;
                Rectangle r = table.getCellRect(last, 0, true);
                table.scrollRectToVisible(r);
            }
        });
    }
};
table.getModel().addTableModelListener(l); 
```*

# .htaccess - Htaccess 重定向不起作用

> ID：14429243
> 
> 赞同：2
> 
> 时间：2013-01-20T20:57:08.847
> 
> 标签：.htaccess, redirect

我只是想写一个简单的 url 重定向，我尝试使用下面的代码，除了以**Redirect 302**开头的行之外，Everyline 都可以工作，我想做的是让这条线工作。

```
# SEO URL Settings
RewriteEngine On
# If your opencart installation does not run on the main web folder make sure you folder it does run in ie. / becomes /shop/ 

RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/+taksit\.asp\?[^\s&]+ [NC]
RewriteRule ^ /? [R=301,L]

**Redirect 302 /mikrometreler/%C4%B0%C3%A7-%C3%A7ap-mikrometresi?sort=p.price&order=ASC http://www.hirdavatdeposu.com/mikrometre/ic-cap-mikrometresi**

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)\_(.*)$ $1-$2 [R=301,L] 
```

这不起作用的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:03:44.417

首先，重定向指令不是由[mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)管理，而是由我的[mod_alias](http://httpd.apache.org/docs/current/mod/mod_alias.html)管理。所以你不需要启动 RewriteEngine。

现在查看[重定向](http://httpd.apache.org/docs/current/mod/mod_alias.html#redirect)文档，我们可以看到语法是：

```
Redirect [status] /path http://full_uri 
```

所以尝试类似：

```
Redirect 302 /asdasd/asdasd http://www.mysite.com/newurl 
```

当它起作用时，尝试将 302 更改为 301，因为在第一次回答后浏览器不会请求 301，因此它们更难调试。

**编辑**

你的问题现在大不相同了:-)

尝试：

*   从 Redirect 命令的路径中删除查询字符串部分（查询字符串部分是 ? 之后的所有内容，路径不包含 ? 和这些参数）
*   如果要匹配表达式，请尝试 RedirectMatch 而不是 Redirect
*   如果您的问题没有通过前面的步骤转售，请尝试使用 mod rewrite 解决它（带有 [R=302] 部分的规则）。但是，如果您需要处理查询字符串部分，这将是复杂的重写规则，如[通过查询字符串使用重写规则](https://stackoverflow.com/questions/7828938/use-rewrite-rule-by-query-string)或[重写动态 URL中所见](https://stackoverflow.com/questions/7703552/rewriting-dynamic-urls)

# routes - Sinatra 路线冲突

> ID：14429249
> 
> 赞同：0
> 
> 时间：2013-01-20T20:57:22.440
> 
> 标签：routes, sinatra

在我的应用程序中，我有以下两条路线

```
get '/' do
   ...
   haml :home
end 
```

和

```
get '/:id' do
    @variable = Something.get(params[:id])
    somethingelse = @variable.some_method
    ...
    haml :show
end 
```

如果我使用执行我的应用程序`shotgun`并访问 localhost:9393（shotgun 的默认地址和端口），一切正常，即日志中不显示错误消息

如果我用通常的方式运行服务器（也安装了瘦服务器）`ruby app.rb`并访问 localhost:4567，那么它会抱怨 NilClass 没有方法“ `some_method`”...好像第二条路由后面跟着空字符串 as `id`。

在 Sinatra 文档中，据说路由是按顺序调用的，因此它甚至不应该遇到第二个。我错了吗？

作为测试，我将第二条路线更改为`'/:id/show'`，不再有错误。

在这两种情况下（我的意思是使用霰弹枪和普通服务器），网站都完美呈现，即`/`视图中正确的是 home.haml 而不是 show.haml。所以错误只存在于日志文件中。说实话，`@variable.some_method`直接在视图中调用，在浏览时`/`我从`/show.haml`.

做什么？为了不再遇到此错误，我应该做些什么吗？我应该明目张胆地忽略它吗？

编辑：代码的输出和相关部分可以在这里找到：[https ://gist.github.com/4585374](https://gist.github.com/4585374)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T11:52:56.530

显然这是我因 Chrome 而遇到的问题（请参阅[https://groups.google.com/forum/?fromgroups=#!topic/nodejs/A415fHudhhM](https://groups.google.com/forum/?fromgroups=#!topic/nodejs/A415fHudhhM)）

Chrome，只要它没有得到 favicon.ico 的正确响应，就会发送另一个请求，这与我过于通用的路由冲突`/:id`

**`favicon.ico`**在项目根目录中的**文件夹中****添加一个**（甚至是空的）**可以`public`****解决这个问题**，因为现在 chrome 在请求 favicon 时会得到 200 响应。使用 firefox 从一开始就没有出现此错误的迹象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T23:08:20.020

尝试编写不带斜杠的路线。（有关更多信息，请参阅[Sinatra 常见问题解答页面](http://www.sinatrarb.com/faq.html#slash)）

# c++ - std::string 没有 operator== 匹配？

> ID：14429251
> 
> 赞同：0
> 
> 时间：2013-01-20T20:57:25.223
> 
> 标签：c++, string, visual-c++

我的程序有一个奇怪的问题。所以在标题中我得到了这样的东西：

```
#ifndef SET1_INCLUDED
#define SET1_INCLUDED

#include <iostream>
using namespace std;

typedef std::string ItemType;
class Set1{
  public:
  ------some public constructor and method in here-------
  private:
  ItemType setMember[100];
} 
```

在 Set1.cpp 文件中我的函数的 1 部分中，我得到了如下内容：

```
if (setMember[i] == "foo") {exist = true;} 
```

在这种情况下，我收到一条错误消息，上面写着“没有找到采用'ItemType'类型的左操作数的运算符”。但是，如果我将 typedef 中的 std::string 更改为 int 或 unsigned long，并将“foo”更改为某个随机数，则代码可以完美运行。有什么建议吗？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T20:58:52.830

您缺少头文件`<string>`，这意味着您的程序中没有所有`operator ==`可见的全局定义。这很可能是您的问题。

要解决此问题，请尝试在此行中添加：

```
#include <string> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:04:48.030

您需要包含字符串头文件以将相关类型和运算符引入范围。

```
#include <string> 
```

注意：从头文件中的 std 命名空间中提取所有内容是不好的编码习惯。

```
//using namespace std; 
```

# php - 您是否在每个公共页面的控制器或控制器的多个方法中加载视图？

> ID：14429257
> 
> 赞同：0
> 
> 时间：2013-01-20T20:58:07.427
> 
> 标签：php, codeigniter

您是为每个将要公开的页面创建一个新控制器，还是只有一个名为 的控制器，例如 page 然后通过方法加载所有页面。

推荐哪种方法，为什么？

我正在构建一个电子商务/cms 应用程序并创建了一个名为 register 的控制器，用户在其中注册一个新帐户，它有大约 5 个视图通过这些方法显示。所有处理，如表单验证和支付处理都在一个模型中完成。就控制器而言，您是否看到我选择的方法存在长期问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:08:29.027

MVC 架构允许您使用控制器划分部分，然后使用方法划分该部分的低级别部分。对我来说，通常的方法是首先`Index`为我的前端创建一个控制器，然后将不同的部分（如用户登录、用户注册、新闻部分，甚至购物部分）分离到方法中。它会是这样的：

```
class Index_Controller extends CI_Controller
{
  public function index(){}

  public function login(){}

  public function register(){}

  ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:07:50.460

一点也不。控制器应包含与控制器相关的方法。例如控制器：成员-方法-登录-注销-注册-删除-viewprofile

这样你就可以在你的 mvc 中保持严格的顺序，并且你的 url 有意义。/会员/注册。/会员登入

在一个控制器单元中有多个视图是最常见的。

最好的问候乔纳斯

# java - 计算年数的功能

> ID：14429261
> 
> 赞同：1
> 
> 时间：2013-01-20T20:58:30.967
> 
> 标签：java

我有 2 个日期作为输入。我想数一数他们之间的岁月。当不到 1 年时，我希望得到一个双倍（即 0.xyz）作为输出。我尝试了以下功能：

```
private double getYearCount(Date startDate, Date endDate)
{
        long millisecondCount = endDate.getTime() - startDate.getTime();
        long yearMillisecondCount = 1000L * 60L * 60L * 24L * 365L;
        return millisecondCount / (double) yearMillisecondCount;
} 
```

但我在那里假设一年是 365 天。所以闰年不被重视。这两个日期可能有不同的年份（例如它们可能是`01.01.1987`和`07.01.2013`）。

我怎样才能解决它，让我也注意到闰年？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T20:59:49.673

只需使用正确的时间一年。也就是 365.2425 天。

但是，不建议这样做。使用时间/日期库来确定这两年的年份，然后减去它们。

为两个日期初始化一个 GregorianCalendar，并获取年份。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-09T12:29:17.823

我写了一个返回日期范围内的年数和天数的方法。正如[James K. Polk](https://stackoverflow.com/users/238704/james-k-polk)在他的评论中提到的那样，您可以将天除以 365、365.2425 或 366 以获得一年的小数部分。

以下是测试结果。

```
From 01 Jan 1987 to 01 Jul 2013 is an interval of 26 years and 182 days.
From 01 Jul 2012 to 01 Jul 2013 is an interval of 1 years and 1 days.
From 01 Jul 2012 to 31 Jul 2012 is an interval of 0 years and 31 days.
From 01 Apr 2012 to 31 Dec 2012 is an interval of 0 years and 275 days. 
```

这是代码。基本上，我是从开始日期到结束日期，逐年计算。

此代码适用于 Java 6、Java 7 及更高版本。

```
package com.ggl.testing;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;

public class DateRangeCalculator {

    private static final SimpleDateFormat format = new SimpleDateFormat(
            "dd MMM yyyy");

    public static void main(String[] args) {
        DateRangeCalculator dateRangeCalculator = new DateRangeCalculator();
        calculateDateInterval(dateRangeCalculator, "01 Jan 1987", "01 Jul 2013");
        calculateDateInterval(dateRangeCalculator, "01 Jul 2012", "01 Jul 2013");
        calculateDateInterval(dateRangeCalculator, "01 Jul 2012", "31 Jul 2012");
        calculateDateInterval(dateRangeCalculator, "01 Apr 2012", "31 Dec 2012");
    }

    private static void calculateDateInterval(
            DateRangeCalculator dateRangeCalculator, String startDateString,
            String endDateString) {
        try {
            Date startDate = format.parse(startDateString);
            Date endDate = format.parse(endDateString);
            DateInterval dateInterval = dateRangeCalculator.getDateInterval(
                    startDate, endDate);
            System.out.println("From " + format.format(startDate) + " to "
                    + format.format(endDate) + " is an interval of "
                    + dateInterval.getYears() + " years and "
                    + dateInterval.getDays() + " days.");
        } catch (ParseException e) {
            e.printStackTrace();
        }
    }

    public DateInterval getDateInterval(Date startDate, Date endDate) {
        Calendar startCalendar = createCalendar(startDate);
        Calendar endCalendar = createCalendar(endDate);

        int years = -1;
        while (!startCalendar.after(endCalendar)) {
            startCalendar.add(Calendar.YEAR, 1);
            years++;
        }

        startCalendar.add(Calendar.YEAR, -1);

        int days = 0;
        while (!startCalendar.after(endCalendar)) {
            startCalendar.add(Calendar.DAY_OF_YEAR, 1);
            days++;
        }

        return new DateInterval(years, days);
    }

    private Calendar createCalendar(Date date) {
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(date);
        return calendar;
    }

    public class DateInterval {
        private final int years;
        private final int days;

        public DateInterval(int years, int days) {
            this.years = years;
            this.days = days;
        }

        public int getYears() {
            return years;
        }

        public int getDays() {
            return days;
        }

    }

} 
```

# c++ - 如何使用 Boost UBLAS 计算二次型？

> ID：14429275
> 
> 赞同：0
> 
> 时间：2013-01-20T21:00:17.137
> 
> 标签：c++, boost, ublas

我正在尝试使用 Boost UBLAS 计算 (x-mu)^T*SigmaInverse*(x-mu)，其中 x 和 mu 是向量，SigmaInverse 是矩阵。代码如下所示：

```
#include <boost/numeric/ublas/vector.hpp>
#include <boost/numeric/ublas/matrix.hpp>

#include "matrixhelpers.h"

namespace ublas = boost::numeric::ublas;

class MultivariateNormalLogLikelihood
{
public:
  MultivariateNormalLogLikelihood(ublas::vector<double> &mu, ublas::matrix<double> &sigma) : mu(mu)
  {
    invertMatrix<double>(sigma, sigmaInverse);
    constElement = -std::log(2*M_PI)*0.5*mu.size()-0.5*std::log(determinant(sigma));
  }

  double operator()(ublas::vector<double> &x)
  {
    auto y = x-mu;
    double e = ublas::prod(ublas::prod(ublas::trans(y),sigmaInverse),y);
    return constElement-0.5*e;
  }
private:
  double constElement;
  ublas::matrix<double> sigmaInverse;
  ublas::vector<double> mu;
}; 
```

我得到这个错误：

```
/home/ga/PhD/cpp/grzesLib/multivariatenormalloglikelihood.h:23:71: error: no matching function for call to ‘prod(boost::numeric::ublas::matrix_vector_binary2_traits<double, boost::numeric::ublas::vector_unary<boost::numeric::ublas::vector_binary<boost::numeric::ublas::vector<double>, boost::numeric::ublas::vector<double>, boost::numeric::ublas::scalar_minus<double, double> >, boost::numeric::ublas::scalar_identity<double> >, double, boost::numeric::ublas::matrix<double> >::result_type, boost::numeric::ublas::vector_binary<boost::numeric::ublas::vector<double>, boost::numeric::ublas::vector<double>, boost::numeric::ublas::scalar_minus<double, double> >&)’ 
```

我做错了什么，我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-29T14:35:03.380

事实证明，您不能在 UBLAS 中转置向量，而是我应该明确使用 inner_product 。要修复代码，应将有问题的行更改为：

```
double e = ublas::prod(ublas::prod(ublas::trans(y),sigmaInverse),y);//WRONG 
```

到：

```
double e = ublas::inner_prod(y, ublas::prod(sigmaInverse,y));//fine 
```

# .net - CoverFlow 在 WPF 中如何包含？

> ID：14429281
> 
> 赞同：0
> 
> 时间：2013-01-20T21:01:17.583
> 
> 标签：.net, wpf, windows, vb.net, coverflow

我知道还有其他关于 WPF 中 CoverFlow 效果的问题。我最喜欢的是[WPF 是否有一个好的 iTunes 封面流类型控件？](https://stackoverflow.com/questions/163775/is-there-a-good-itunes-coverflow-type-control-for-wpf).

我下载了一个“第 7 部分”，它在 WPF 和 C# 中。

现在，我几乎从不使用第三方库，特别是 GUI 库，而且我不知道如何在我的项目中使用该模板。

那么，基本上，我怎样才能将它正确地包含在我的项目中？在References中取了图书馆后我该怎么办？

如果您知道更好的 CoverFlow 模板（并且免费），您能告诉我哪个吗？

请帮助（一个小提示，我的项目在 VB.NET 中，但我认为它在 .dll 中没有任何关系）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T01:30:04.663

您正在使用的示例`CoverFlow`组件不能完全作为独立控件工作。有一个调用接口`ThumbnailManager`需要实现。我能够通过首先右键单击工具箱并选择选择项目来使其在 VB 中工作，然后导航到包含该`Coverflow`组件的 .dll 文件`Ded.Tutorial.Wpf.CoverFlow.Part7.FlowComponent.dll`并选择它，之后我可以`FlowControl`从工具箱中将其放入我的 MainWindow . 然后我将作者用来创建的 C# 代码转换`ThumbnailManager`为 VB。

**缩略图管理器.vb**

```
Imports System.IO.IsolatedStorage
Imports System.IO
Imports System.Drawing
Imports System.Drawing.Imaging
Imports Ded.Tutorial.Wpf.CoverFlow.Part7.FlowComponent
Imports Ded.Tutorial.Wpf.CoverFlow.Part7.FlowComponent.FlowControl

Namespace Ded.Tutorial.Wpf.CoverFlow.Part7.FlowComponent
    Public Class ThumbnailManager : Implements IThumbnailManager
        Private ReadOnly store As IsolatedStorageFile

        Private Shared Function AmazonCut(myImage As Image) As Image
            If (myImage.Width <> myImage.Height) Then
                Return myImage
            End If
            Dim bmp As Bitmap = New Bitmap(myImage)
            Dim size As Integer = myImage.Height
            Dim white As Integer = System.Drawing.Color.FromKnownColor(KnownColor.White).ToArgb()
            Dim i As Integer = 0
            While (i < size / 2)
                If (Not bmp.GetPixel(i, i).ToArgb().Equals(white)) Then Exit While
                If (Not bmp.GetPixel(i, size - 1 - i).ToArgb().Equals(white)) Then Exit While
                If (Not bmp.GetPixel(size - 1 - i, i).ToArgb().Equals(white)) Then Exit While
                If (Not bmp.GetPixel(size - 1 - i, size - 1 - i).ToArgb().Equals(white)) Then Exit While
                i += 1
            End While
            If (i > 0) Then
                i += 8
                Dim zone As Rectangle = New Rectangle(i, i, size - 2 * 1, size - 2 * i)
                Return bmp.Clone(zone, System.Drawing.Imaging.PixelFormat.DontCare)
            End If
            Return bmp
        End Function

        Private Function GetThumbnail(path As String) As Byte()
            Dim source As Image = Image.FromFile(path)
            source = AmazonCut(source)
            Dim height As Integer = source.Height
            Dim width As Integer = source.Width
            Dim factor As Integer = (height - 1) \ 250 + 1
            Dim smallHeight As Integer = height \ factor
            Dim smallWidth As Integer = width \ factor
            Dim thumb As Image = source.GetThumbnailImage(smallWidth, smallHeight, Nothing, IntPtr.Zero)
            Using ms As New MemoryStream
                thumb.Save(ms, ImageFormat.Png)
                ms.Flush()
                ms.Seek(0, SeekOrigin.Begin)
                Dim result(CInt(ms.Length)) As Byte
                ms.Read(result, 0, CInt(ms.Length))
                Return result
            End Using

        End Function

        Public Sub New()
            store = IsolatedStorageFile.GetUserStoreForAssembly
        End Sub

        Public Function GetThumbnail(host As String, filepath As String) As System.Windows.Media.ImageSource Implements IThumbnailManager.GetThumbnail
            Dim thumbName As String = Path.GetFileName(filepath)
            If (store.GetFileNames(thumbName).Length = 0) Then
                Using Stream As New IsolatedStorageFileStream(thumbName, FileMode.CreateNew, store)
                    Dim data() As Byte = GetThumbnail(filepath)
                    Stream.Write(data, 0, data.Length)
                End Using
            End If
            Using Stream As New IsolatedStorageFileStream(thumbName, FileMode.Open, store)
                Dim myImage As BitmapImage = New BitmapImage()
                myImage.BeginInit()
                myImage.CacheOption = BitmapCacheOption.OnLoad
                myImage.StreamSource = Stream
                myImage.EndInit()
                myImage.Freeze()
                Return myImage
            End Using
        End Function
    End Class
End Namespace 
```

然后，我向 MainWindow.xaml.vb 添加了一个附加类和他正在使用的加载方法。在组件工作之后，我还必须更改`Ded.Tutorial.Wpf.CoverFlow.Part7.FlowComponent.FlowControl`为`Global.Ded.Tutorial.Wpf.CoverFlow.Part7.FlowComponent.FlowControl`in 。`MainWindow.g.vb`

**主窗口.xaml.vb**

```
Imports System.IO
Imports System.Drawing.Imaging
Imports WpfApplication1.Ded.Tutorial.Wpf.CoverFlow.Part7

Class MainWindow

    Public Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        FlowControl1.Cache = New FlowComponent.ThumbnailManager
        Load("C:\Users\Marks-6520\Pictures\Alaska Trip")
        slider.Minimum = 0
        slider.Maximum = FlowControl1.Count - 1
    End Sub

    Public Sub Load(imagePath As String)
        Dim imageDir As DirectoryInfo = New DirectoryInfo(imagePath)
        Dim images As List(Of FileInfo) = New List(Of FileInfo)(imageDir.GetFiles("*.jpg"))
        images.Sort(New FileInfoComparer)
        For Each f As FileInfo In images
            FlowControl1.Add(Environment.MachineName, f.FullName)
        Next
    End Sub

    Private Sub slider_ValueChanged(sender As System.Object, e As System.Windows.RoutedPropertyChangedEventArgs(Of System.Double))

        FlowControl1.Index = Convert.ToInt32(slider.Value)

    End Sub
End Class

Public Class FileInfoComparer : Implements IComparer(Of FileInfo)

    Public Function Compare(x As System.IO.FileInfo, y As System.IO.FileInfo) As Integer Implements System.Collections.Generic.IComparer(Of System.IO.FileInfo).Compare
        Return String.Compare(x.FullName, y.FullName)
    End Function
End Class 
```

# joomla - 无法在 joomla 上启用 mysqli

> ID：14429282
> 
> 赞同：1
> 
> 时间：2013-01-20T21:01:18.690
> 
> 标签：joomla, mysqli, shared-hosting, hostmonster

我在 Hostmonster 上有一个共享主机帐户，我刚刚安装了 Joomla CMS。我还添加了一个插件，我刚刚发现它需要 MySQLi 驱动程序才能正常运行。

所以我做了一些谷歌搜索，建议我在 PHP.ini 中更改一些最低要求的设置，并添加了 mysqli 扩展

```
extension=php_mysqli.dll 
```

但是当我将 Joomla 中的数据库设置更改为 MySQLi 时，保存按钮没有响应。

我已经检查了所有最低要求，并且非常确定我满足所有这些要求。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:41:06.637

我刚刚查看了[hostmonster 网站](http://www.hostmonster.com/cgi/info/hosting_features)，看起来他们只提供 linux 托管。如果是这种情况，那么您的延长线应该是

```
extension=php_mysqli.so 
```

“.dll”扩展名仅适用于 Windows。

# php - 为什么我嵌入在 PHP 中的 jQuery 不能正常执行？

> ID：14429283
> 
> 赞同：-3
> 
> 时间：2013-01-20T21:01:19.773
> 
> 标签：php, javascript, jquery, html

```
if ($_POST["name"] == "") { 
    array_push($errors, "Your PixelPal needs a name!");
    echo "<script>\$('#name').css({ 'border': 'none', 'box-shadow': 'inset 0px 0px 5px 3px rgba(128, 128, 128, 0.3), 0px 0px 10px rgba(255, 0, 0, 1)' });</script>";
} 
```

基本上，如果未设置名称变量，我希望它回显一个脚本，将其更改为以红色突出显示。为什么这行不通？

这是它的格式更好地阅读：

```
if ($_POST["name"] == "") { 
    array_push($errors, "Your PixelPal needs a name!");
    echo "<script>\$('#name').css({
        'border': 'none',
        'box-shadow': 'inset 0px 0px 5px 3px rgba(128, 128, 128, 0.3), 0px 0px 10px rgba(255, 0, 0, 1)'
     });</script>";
} 
```

如果推送到页面，JavaScript 不应该立即执行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:05:00.320

JQuery 脚本作用于页面上已经存在的元素，如果您在元素之前执行此脚本，则`id="name"`需要在`$(document).ready`语句中添加脚本。

```
if ($_POST["name"] == "") { 
    array_push($errors, "Your PixelPal needs a name!");
    echo "<script>
\$(document).ready({
\$('#name').css({
        'border': 'none',
        'box-shadow': 'inset 0px 0px 5px 3px rgba(128, 128, 128, 0.3), 0px 0px 10px rgba(255, 0, 0, 1)'
     });
 });</script>";
} 
```

# vb.net - 如何在 google visual basic 中自动点击搜索按钮。网

> ID：14429284
> 
> 赞同：2
> 
> 时间：2013-01-20T21:01:24.137
> 
> 标签：vb.net

我有一个带有文本框、按钮和选项卡控件的表单。

在按钮中我有这个代码：

```
[Dim browser As New WebBrowser()
TabPage1.Controls.Add(browser)
browser.Dock = DockStyle.Fill
browser.Navigate(New Uri("http://www.google.com"))] 
```

上面的代码有效，但我需要能够从我的文本框中进行搜索，当我点击按钮时，它会将我带到谷歌，然后自动输入我在我的文本框中搜索的单词，然后点击谷歌按钮上的搜索。我试过这个，但它不起作用。谢谢

```
Dim textElement. As HtmlElement = browser.Document.All.GetElementsByName("q")(0)
textElement.SetAttribute("value", textbox.text")
Dim btnElement As HtmlElement = browser.Document.All.GetElementsByName("btnG")(0)
btnElement.InvokeMember("click") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-09T05:15:11.737

我认为您可以在按钮单击处理程序中使用它...

```
browser.navigate("https://www.google.co.in/search?q="+textbox.Text) 
```

这将在 Google 中搜索您的文本框中的文本。您可以在不“自动单击搜索按钮”的情况下进行搜索，并且不必在 html 的文本元素中设置值。这对我有用。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:33:00.067

在单击按钮之前，您需要将焦点设置为 textElement。

```
textElement.Focus() 
```

否则，页面显然不会运行搜索。

您可以通过在控制台窗口中尝试上述相同的基本步骤来看到这一点。在该领域得到关注（根据我的测试）之前，它们不会起作用。

（我也使用了mshtml类型库，这样点击函数就直接暴露在下面的完整代码中了）

```
Imports mshtml

Public Class Form1
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        web.Navigate("http://www.google.com")
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim textElement As HtmlElement = web.Document.All.GetElementsByName("q")(0)
        textElement.SetAttribute("value", TextBox1.Text)
        textElement.Focus()
        Dim btnElement As HTMLButtonElement =
            CType(web.Document.All.GetElementsByName("btnG")(0).DomElement, 
                HTMLButtonElement)
        btnElement.click()
    End Sub
End Class 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-05T10:36:05.837

我还需要在谷歌浏览器中搜索用户想要的文本，并将下面的代码添加到按钮单击事件中，它完成了我想要的操作。

> 代码：

```
Dim sInfo As New ProcessStartInfo("https://www.google.co.in/search?q=" & TXT_Entidade.Text)

Try
    Process.Start(sInfo)
Catch ex As Exception
    Process.Start("iexplore.exe", sInfo.FileName)
End Try 
```

# http - 数字数组的 MIME 类型？

> ID：14429289
> 
> 赞同：0
> 
> 时间：2013-01-20T21:02:59.300
> 
> 标签：http, mime

我正在考虑一个应用程序，它将使用 HTTP 传输具有“network-endian，有符号 32 位整数”或“ieee binary64，network-endian”等数据类型的数字块。对于这个应用程序，我（可能）想要将此类型信息放在 HTTP 标头而不是消息正文中。

这似乎是 Content-Type 标头的工作，但我知道这类事情没有标准的 MIME 类型。有吗？如果没有，最好的选择是什么？发明内容类型？发明一个新的 HTTP 标头？毕竟放在消息正文中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:38:17.537

如果是header，header的字段名定义了它的内容，而不是Content-Type；它们应该是完全可分离的。即，与标头具有特定关系/要求的 Content-Type 是协议设计的味道。

我会将它放在消息正文中并创建一种新的媒体类型——但只有在对当前选项进行了非常长时间、认真的研究之后，其中有很多。格式很难。

# scala - Scala Singleton 没有按预期工作

> ID：14429296
> 
> 赞同：1
> 
> 时间：2013-01-20T21:03:37.340
> 
> 标签：scala, singleton

Main.scala：

```
package controler

object Main {
    def main(args: Array[String]) {
      import Utilites._
      isJavaUpToDate
    }
} 
```

实用程序.scala：

```
package controler

object Utilities {
  def isJavaUpToDate = { 
    val javaVersion = augmentString(System.getProperty("java.version").substring(2, 3))
    javaVersion >= 6 
  }
} 
```

为什么这不起作用？我已经找到了一堆不同的教程网站，这些网站没有问题。

我总是说找不到 val Utilites。

PS为什么它只是破坏代码时不断建议我用augmentString（）更改.toInt？

现在这给我带来了麻烦，关于隐式排序和方法 orderTOOrdered。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T21:52:36.760

在您的`main`方法中，您输入`Utilites`了您要输入的位置`Utilities`。

```
Correct: Utilities
Wrong:   Utilites 
```

注意遗漏`i`:) 因为你的大脑是一个强大的拼写纠正工具，它假装拼写是正确的。不过，Scala 编译器并不那么酷；）

* * *

另外，对我来说，以下不起作用：

```
scala> augmentString(System.getProperty("java.version").substring(2, 3)) >= 5
<console>:15: error: No implicit Ordering defined for AnyVal.
          augmentString(System.getProperty("java.version").substring(2, 3)) >= 5 
```

相反，我将其替换为

```
System.getProperty("java.version").substring(2, 3)).toInt >= 5 
```

您在以前的代码中遇到的隐式排序问题是因为 Scala 不知道如何将`>=`方法/运算符应用于返回的`scala.collection.immutable.StringOps`type `augmentString()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T21:59:42.840

请注意，通过调用`augmentString`您将字符串显式转换为[StringOps](http://www.scala-lang.org/api/current/index.html#scala.collection.immutable.StringOps)。StringOps 确实定义了一个`>=`方法，但它是用来比较字符串的（它的签名是`def >=(that: String): Boolean`）

如果你想比较 Ints，你应该`toInt`使用`StringOps`.

```
def isJavaUpToDate = { 
    val javaVersion = augmentString(System.getProperty("java.version").substring(2, 3)).toInt
    javaVersion >= 6 
  } 
```

此外，除非您需要`toInt`针对您定义的另一个隐式（或在您正在使用的库中的其他位置定义）消除歧义，否则不需要显式调用 augmentString。以下内容应该可以正常工作（除非编译器告诉您它不可以），并且它应该隐含地与上面将您转换`String`为 a的代码具有相同的效果`StringOps`。

```
def isJavaUpToDate = { 
    val javaVersion = System.getProperty("java.version").substring(2, 3)
    javaVersion.toInt >= 6 
  } 
```

编辑：根据@som-snytt 的评论你得到的错误（`No implicit Ordering defined for AnyVal`）是由于编译器的推理或多或少是这样的：

*   `javaVersion >= 6`意味着`javaVersion.>=(6)`，即我必须寻找一个`>=`在 javaVersion 上调用的方法，它需要一个整数
*   `javaVersion`是`StringOps`...在 StringOps 中有一个`>=`方法（由`StringLike`它扩展的特征提供，这反过来又 extends `Ordered[String]`）但它需要一个 String 参数，而不是 Int
*   让我们看看我是否有一个隐含的范围，它提供了一个适合`Ordering`的`StringOps`. 现在，由于您正在尝试将 a`String`与 a进行比较，因此`Int`您正在查看`Ordering`可以将两个值与可以包含两者的最近的共同祖先进行比较`String`的an `Int`，即`AnyVal`[编辑：虽然 String 是 AnyRef 所以我真的不明白这部分...]。
*   没有运气......放弃一个错误，说没有找到隐式排序比较`AnyVal`s

# c# - Datagrid 中的 Datagrid，将 Datagrid 的列之一作为 Datagrid 本身？

> ID：14429302
> 
> 赞同：0
> 
> 时间：2013-01-20T21:04:11.123
> 
> 标签：c#, wpf, xaml, datagrid

我有定义我的 itemsource 的当前代码（我想向用户显示的内容）：

```
public class View
{
public string Name { get; set; }
public string Quantity { get; set; }
public List<Item> items { get; set; }
}

public class Item
{
public string ItemName { get; set; }
public double ItemQuantity { get; set; }
} 
```

使用的数据集：

```
List<View> myViews 
```

所以你最终得到如下数据：

```
ViewA 50 {ItemA 50, ItemB 10, ItemC 20)
ViewB 10 {ItemC 10, ItemD 10, ItemE 10) 
```

现在在我的数据网格中，它完美地显示了前两列，但列表显示为“集合”（不是实际数据），我猜这是意料之中的。

这是我现在的 XAML

```
 <DataGrid Grid.Row="2" Margin="0,146,0,350"
              ItemsSource="{Binding myViews}"
              AutoGenerateColumns="False" Height="104">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name" Width="*" FontSize="16"
                                Binding="{Binding Path=Name}" />
                <DataGridTextColumn Header="Quantity" Width="*" FontSize="16"
                                Binding="{Binding Path=Quantity}" />
                <DataGridTextColumn Header="Items" Width="*" FontSize="16"
                                Binding="{Binding Path=items}" />
            </DataGrid.Columns>
        </DataGrid> 
```

我正在尝试找到一种向用户表示列表项的方法（如果这不是正确的方法，则在此数据网格中或其他方式中）。

我的想法是在第 3 列中实际上有另一个 Datagrid，它有自己的项目来源，但我似乎不知道如何使第 3 列成为 Datagrid（而不是像今天这样的文本）。有谁知道如何做到这一点（一些例子会很糟糕）。

或者，如果这确实不是解决此问题的正确方法，那么任何其他想法也将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:20:56.473

您可以使用`RowDetailsTemplate`来呈现 Item 对象的列表。

```
 <DataGrid Grid.Row="2"  Margin="0,146,0,350"
      ItemsSource="{Binding myViews}"
      AutoGenerateColumns="False" Height="104">
    <DataGrid.RowDetailsTemplate>
        <DataTemplate>
            <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding items}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Item Name" Width="Auto" FontSize="16"
                            Binding="{Binding Path=ItemName}" />
                    <DataGridTextColumn Header="Item Quantity " Width="Auto" FontSize="16"
                            Binding="{Binding Path=ItemQuantity }" />
                </DataGrid.Columns>
            </DataGrid>
        </DataTemplate>
    </DataGrid.RowDetailsTemplate>

    <DataGrid.Columns>
        <DataGridTextColumn Header="Name" Width="*" FontSize="16"
                        Binding="{Binding Path=Name}" />
        <DataGridTextColumn Header="Quantity" Width="*" FontSize="16"
                        Binding="{Binding Path=Quantity}" />                
    </DataGrid.Columns>
</DataGrid> 
```

如果您想在第三列中显示 Item 对象列表，您应该使用`DataGridTemplateColumn`.

```
<DataGrid Grid.Row="2" Margin="0,146,0,350"
      ItemsSource="{Binding myViews}"
      AutoGenerateColumns="False" Height="104">
    <DataGrid.Columns>
        <DataGridTextColumn Header="Name" Width="*" FontSize="16"
                        Binding="{Binding Path=Name}" />
        <DataGridTextColumn Header="Quantity" Width="*" FontSize="16"
                        Binding="{Binding Path=Quantity}" />
        <DataGridTemplateColumn Header="Items">
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding items}">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Item Name" Width="Auto" FontSize="16"
                            Binding="{Binding Path=ItemName}" />
                            <DataGridTextColumn Header="Item Quantity " Width="Auto" FontSize="16"
                            Binding="{Binding Path=ItemQuantity }" />
                        </DataGrid.Columns>
                    </DataGrid>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>               
    </DataGrid.Columns>
</DataGrid> 
```

# android - 无法使用谷歌地图 api 打开 android 应用程序

> ID：14429307
> 
> 赞同：-1
> 
> 时间：2013-01-20T21:04:42.293
> 
> 标签：android, google-maps

标题说明了一切。我不知道为什么avd无法打开应用程序。

图片： http: [//gyazo.com/860c43fcd216e324d1e2338c2836c704.png](http://gyazo.com/860c43fcd216e324d1e2338c2836c704.png)

**显现：**

```
 <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />
    <application   
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name">
        <uses-library android:name="com.google.android.maps" />
        <activity
            android:name="com.example.friendfinder.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <meta-data
            android:name="com.google.android.maps.v2.API_KEY"
            android:value="AIzaSyAJAx2Q7_ZHiQYBNnz41IgS0O9vmi7auXM" />
    </application>
    <user-permission android:name="android.permission.INTERNET" />
</manifest> 
```

**activity_main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<RealtiveLaout xmlns:android="http://schemas.android.com/apk/res/android"

    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <com.google.android.maps.MapView
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:clickable="true"
        android:enabled="true"
        android:apiKey="AIzaSyAJAx2Q7_ZHiQYBNnz41IgS0O9vmi7auXM"
        />
</RealtiveLaout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:17:50.210

[您在“在应用程序清单中指定设置”](https://developers.google.com/maps/documentation/android/start#specify_settings_in_the_application_manifest)部分遗漏了一些内容

1) 权限

```
 <uses-permission android:name="android.permission.INTERNET"/>
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
 <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
 <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
 <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/> 
```

2）您的应用权限

```
 <permission
      android:name="com.example.mapdemo.permission.MAPS_RECEIVE"
      android:protectionLevel="signature"/>
    <uses-permission android:name="com.example.mapdemo.permission.MAPS_RECEIVE"/> 
```

3）opengl要求

```
<uses-feature
    android:glEsVersion="0x00020000"
    android:required="true" /> 
```

# php - 如何使用 .htaccess 和 PHP 生成 seo 友好的 URL？

> ID：14429308
> 
> 赞同：-1
> 
> 时间：2013-01-20T21:04:46.203
> 
> 标签：php, .htaccess

我在 GET 中使用`index.php`：

```
$request=isset($_GET['m']) && $_GET['m']!='';
$requestFile=isset($_GET['files']) && $_GET['files']!=''; 
```

我的链接格式为：`localhost:81/Template/index.php?m=index&files=Acc`.

如何使用`.htaccess`文件或 PHP 重写为：`localhost:81/Template/Acc/index.html or php`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:10:57.537

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^Template/([^/]+)/([^/.]+)\.html$ /index.php?m=$2&files=$1 [L] 
```

从以下位置获取您的页面：

```
localhost:81/Template/Acc/index.html 
```

# java - 如何向该程序添加退出按钮？“清”怎么说？

> ID：14429310
> 
> 赞同：4
> 
> 时间：2013-01-20T21:04:47.207
> 
> 标签：java, swing, user-interface, jbutton, layout-manager

我需要在butPanel 上添加一个“清除计算器”按钮和一个退出程序的按钮。它还需要是非常基本的 Java 代码，因为我是初学者并且有一个糟糕的 comp.sci。老师。我有一个带有退出按钮的代码示例，但我不确定如何将它放入我的程序中。我已经尝试了很多。此外，如果有更好的“错误检查”方法，将不胜感激。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Calculator2 extends JFrame implements ActionListener
{
    JLabel heading = new JLabel ("2\. Calculator");
    JLabel intro1 = new JLabel ("This program stimulates a four-function calculator.");
    JLabel intro2 = new JLabel ("It takes an operator and a number. It can add, subtract,");
    JLabel intro3 = new JLabel (" multiply and divide. Enter in the format eg. '+35'. ");
    JLabel inLabel = new JLabel ("        Operation: ");
    JLabel outLabel = new JLabel ("       Total:           ");
    JTextField inOper = new JTextField (7);
    JTextField outTota = new JTextField (7); // intro

//panels
JPanel titlePanel = new JPanel ();
JPanel intro1Panel = new JPanel ();
JPanel intro2Panel = new JPanel ();
JPanel intro3Panel = new JPanel ();
JPanel operPanel = new JPanel ();
JPanel totaPanel = new JPanel ();
JPanel butPanel = new JPanel ();

String operTemp;
String totaTemp;

public Calculator2 ()
{
    setTitle ("C - 2.");
    inOper.addActionListener (this);
    outTota.setEditable (false);
    getContentPane ().setLayout (new FlowLayout ());

    titlePanel.add (heading);
    intro1Panel.add (intro1);
    intro2Panel.add (intro2);
    intro3Panel.add (intro3);
    operPanel.add (inLabel);
    operPanel.add (inOper);
    totaPanel.add (outLabel);
    totaPanel.add (outTota); //adds components to panels

    getContentPane ().add (titlePanel);
    getContentPane ().add (intro1Panel);
    getContentPane ().add (intro2Panel);
    getContentPane ().add (intro3Panel);
    getContentPane ().add (operPanel);
    getContentPane ().add (totaPanel); //Adds panels to Frame

    setDefaultCloseOperation (JFrame.EXIT_ON_CLOSE);
}

public static int isInteger (String input)
{
    try
    {
        Integer.parseInt (input);
        return Integer.parseInt (input);
    }
    catch (NumberFormatException nfe)
    {
        return 0;
    }
} //isInteger method

// The application
public String calculate (String operation, String newtotal)
{
    int total = isInteger (newtotal);
    String totalS;
    char operator;
    int number = 0;
    operator = operation.charAt (0);

    if (operator == '+')
    {
        number = isInteger (operation.substring (1));
        total = total + number;
        totalS = Integer.toString (total);
    }

    else if (operator == '-')
    {
        number = isInteger (operation.substring (1));
        total = total - number;
        totalS = Integer.toString (total);
    }

    else if (operator == '*')
    {
        number = isInteger (operation.substring (1));
        total = total * number;
        totalS = Integer.toString (total);
    }

    else if (operator == '/')
    {
        number = isInteger (operation.substring (1));
        total = total / number;
        totalS = Integer.toString (total);
    }
    else
    {
        totalS = ("ERROR");
    }

    if (number == 0)
    {
        totalS = ("ERROR");
    }
    return totalS;
} // calculate method

public void actionPerformed (ActionEvent evt)
{
    String userIn = inOper.getText ();
    String totalIn = outTota.getText ();
    try
    {
        totaTemp = calculate (userIn, totalIn);
        outTota.setText (totaTemp + "");
    }
    catch (Exception ex)
    {
        outTota.setText ("ERROR");
    }
    repaint ();
}

public static void main (String[] args)
{
    Calculator2 calc = new Calculator2 ();
    calc.setSize (350, 350);
    calc.setResizable (false);
    calc.setVisible (true);
}
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T21:15:39.113

首先声明按钮并初始化它们：

```
JButton exitButton = new JButton("Exit");
JButton clearButton = new JButton("Clear"); 
```

然后，确保 butPanel 具有布局并且面板已添加到内容窗格中：

```
butPanel.setLayout(new FlowLayout());
getContentPane().add(butPanel); 
```

然后在新按钮上添加动作监听器：

```
exitButton.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e) {
    System.exit(0);
  }
});
clearButton.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent e) {
    // TODO: clear the stuff here
  }
}); 
```

# x86 - TLB 和 PTE 中的引用和修改位

> ID：14429313
> 
> 赞同：2
> 
> 时间：2013-01-20T21:04:51.703
> 
> 标签：x86, virtual-memory, tlb

您可能知道这些为 Accessed 和 Dirty 位。现在 x86 [PTE](http://wiki.osdev.org/File%3aPage_table.png)包含这些位。假设 TLB 也包含这些位。在 TLB 命中的情况下，如果它们所引用的页框被访问或修改，这些位将由硬件设置。我的问题是这些位何时被硬件复制回 PTE 以及这究竟是如何完成的（尤其是在软件管理 TLB 的情况下）？

PS - 我想知道这一点，因为我正在尝试设计和测试页面替换算法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:31:01.267

x86 CPU 没有软件管理的 TLB。如果你想模拟这样的事情，你需要在普通 TLB 之上实现它，就像你将物理页面映射和取消映射到虚拟地址空间一样：在页面错误处理程序中拦截页面访问，修改 PDE/ PTE 在必要时使 TLB 条目无效，并在多处理器系统的情况下特别小心。

CPU 将访问位和脏位设置为 1 对软件是透明的，因此，一旦访问了页面，您应该立即看到更改。

有关详细信息，请参阅“英特尔® 64 和 IA-32 架构软件开发人员手册”。获取包含第 1 卷至第 3 卷的 pdf，以便您将所有必要的信息集中在一处。

# jquery - 如何在标签中获取带有选中标签的元素？

> ID：14429314
> 
> 赞同：0
> 
> 时间：2013-01-20T21:04:53.277
> 
> 标签：jquery, checkbox, html-table

在 javascipt/jquery 我怎样才能得到检查的元素名称。这些都在表中。而且我必须到达并检测 td 标签中选中复选框的标签。

```
$.each(value.Value, function (_, ObjElement) {
                    var tr = $('<tr>').appendTo(table);
                    $("<td>").appendTo(tr);
                    $("<td>", { id: 'clusterList' }).text(ObjElement.Name).append($('<input type=checkbox>').prop("checked", true)).appendTo(tr);

<td id="clusterList">Cluster1<input type="checkbox" checked="checked"></td>
<td id="clusterList">Cluster2<input type="checkbox" checked="checked"></td>
<td id="clusterList">Cluster3<input type="checkbox" checked="checked"></td> 
```

如果选中第一个和第二个复选框，结果应该是这样的。

Listcluster={Cluster1,Cluster2}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:11:02.483

ID 必须是*唯一的*，你应该使用类来代替。您可以使用方法将值存储在数组中`map`。

```
var listCluster = $('table td').has('input[type=checkbox]:checked').map(function(){
    return this.textContent || this.innerText;
    // return $.trim( $(this).text() );
}).get(); 
```

[http://jsfiddle.net/SUHsT/](http://jsfiddle.net/SUHsT/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:11:01.797

```
$('td input:checked').parent().text(); 
```

顺便说一句，ID 必须是唯一的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T21:16:14.047

1) ID 必须是唯一的。不能有多个具有相同 ID 的元素。

因此，除此之外，让我们假设您有以下 DOM：

```
<table id="myTable">
  <tr>
   <td id="clusterList1">Cluster1<input type="checkbox" checked="checked"></td>
   <td id="clusterList2">Cluster2<input type="checkbox" checked="checked"></td>
   <td id="clusterList3">Cluster3<input type="checkbox" checked="checked"></td></tr></table> 
```

而且，鉴于您的示例不包含名称属性，我假设当您说“名称”时，您的意思是“输入字段之前的文本”。然后您的 jquery 将如下所示：

```
 ListCluster = []
     $('table#myTable tr td input[type=checkbox]').on('change', function(){
           if($(this).attr('checked')=='checked'){
              if(ListCluster.indexOf($(this).parent().text()==-1){
                 ListCluster.push($(this).parent().text());
              }
           } else if(ListCluster.indexOf($(this).parent().text()>=-1){
              ListCluster.splice($(this).parent().text(), 1);
           }
      } 
```

这是它的工作原理。

您初始化一个数组 ListCluster。然后，您在所需的嵌套级别向所有复选框添加一个更改处理程序。使用更改处理程序而不是单击处理程序的原因是，更改处理程序将允许您根据在选中复选框后按下空格键来处理值更改，而单击事件不会选择它。

在更改处理程序内部，`$(this)`指的是已更改的复选框，同时`.parent()`向上一级以获取其包装 td。

`.text()`将获得一个丢弃所有 HTML 的 DOMElements 文本。

`indexOf()`将返回找到值的第一个索引，如果从未找到则返回 -1，因此将 indexOf 与 -1 进行比较相当于询问“此项目是否存在？”

`.push()`是一个将元素添加到数组末尾的函数，同时`.splice(x, y)`将删除从 x 的索引开始的 y 元素。

# java - 在java中测试看不见的字符

> ID：14429315
> 
> 赞同：4
> 
> 时间：2013-01-20T21:04:55.907
> 
> 标签：java, bufferedreader, carriage-return

我正在用 Java 编写一个程序来测试几个 FTP 命令的有效性。这些命令必须在回车和换行符中（序列“\r\n”）。我正在使用 BufferedReader 读取行，但我无法想出一种方法来检查行是否以此序列结束。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T07:15:55.070

不要使用，`BufferedReader`因为抽象级别对于您的特定任务来说似乎太高了。使用普通的[InputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/InputStream.html)，读入字节数组。InputStream 将按原样读取所有字节。您可以处理它们，稍后使用[new String(array, offset, length)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#String%28byte%5B%5D,%20int,%20int%29)自己生成字符串。也许它可以是其他无效字符，例如输入中的 0x0C。

# php - 如何检查 PHP 中是否存在已定义的常量？

> ID：14429321
> 
> 赞同：76
> 
> 时间：2013-01-20T21:05:19.530
> 
> 标签：php, if-statement, constants, fuelphp

所以我使用了一个名为**fuelphp**的 PHP 框架，并且我有这个页面是一个**HTML**文件，所以我不能在其中使用 PHP。我有另一个文件，其中有一个顶栏，我的 HTML 文件将通过 ajax 调用它。

如何检查 PHP 中是否存在常量？
我想检查fuelphp 框架文件的位置。

这些是我需要检查的常量（实际上，我只需要检查其中一个）：

```
define('DOCROOT', __DIR__.DIRECTORY_SEPARATOR);
    define('APPPATH', realpath(__DIR__.'/fuel/app/').DIRECTORY_SEPARATOR);
    define('PKGPATH', realpath(__DIR__.'/fuel/packages/').DIRECTORY_SEPARATOR);
    define('COREPATH', realpath(__DIR__.'/fuel/core/').DIRECTORY_SEPARATOR);                    
    require APPPATH.'bootstrap.php'; 
```

**编辑：**
我意识到这些不是变量，它们是常量......

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-01-20T21:08:09.477

首先，这些不是变量，而是常量。

您可以使用以下[`defined()`](http://php.net/manual/fr/function.defined.php)功能检查它们的存在：

```
bool defined ( string $name ) 
```

> 检查给定的常量是否存在并被定义。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2013-01-20T21:07:32.210

使用[`defined()`函数](https://secure.php.net/manual/en/function.defined.php)，例如：

```
if (defined('VAR_NAME')) {
    // Something
} 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-01-20T21:07:02.113

检查使用[`defined('CONSTANT')`](https://secure.php.net/manual/en/function.defined.php)功能。

手册中的一个例子：

> ```
> <?php
> /* Note the use of quotes, this is important.  This example is checking
>  * if the string 'TEST' is the name of a constant named TEST */
> if (defined('TEST')) {
>     echo TEST;
> }
> ?> 
> ```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2016-06-11T12:49:13.977

这是一种更酷、更简洁的方法：

```
defined('CONSTANT') or define('CONSTANT', 'SomeDefaultValue'); 
```

信用： neville dot tk 的丹尼尔 [https://www.php.net/manual/en/function.defined.php#84439](https://www.php.net/manual/en/function.defined.php#84439)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-20T21:08:18.180

我认为您的意思是常量而不是变量！功能是`defined();`

见这里： [定义](http://php.net/manual/en/function.defined.php)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-08T13:12:01.667

你`defined`必须做这样的事情：

```
if (defined("CONST_NAME"))
    $value = CONST_NAME; 
```

这将起作用，但是您可能会在代码编辑器（在我的情况下为带有 PHP Inteliphense 扩展的 Visual Studio Code）中收到一条恼人的错误消息，因为它不会找到`CONST_NAME`. 另一种选择是使用常量函数。它接受一个字符串作为常量名，如果常量没有定义则返回 null：

```
$value = constant("CONST_NAME");
if ($value != null)
{
    // Use the value ...
} 
```

由于您将 const 名称作为字符串传递，因此它不会在代码编辑器上生成错误。

# php - $user = $facebook->getUser() 每次都返回 0。我正在使用最新的 SDK

> ID：14429325
> 
> 赞同：0
> 
> 时间：2013-01-20T21:06:13.773
> 
> 标签：php, facebook, facebook-authentication

我正在使用下面的代码来检查用户是否登录到 Facebook。

```
<?php

// Awesome FB APP 
// Name: MyAPP 

require_once 'facebook.php';// this line calls our facebook.php file that is the 
//core of PHP facebook API
// Create our Application instance.

$facebook = new Facebook(array(

  'appId' => '250941738370233',

  'secret' => 'xxx',

  'cookie' => true,

)); // all we are doing is creating an array for facebook to use with our 

$user = $facebook->getUser();
echo $user;
//app id and app secret in and setting the cookie to true
if($user){
try {
  $user_profile = $facebook->api('/me');

} catch (FacebookApiException $e) {

  error_log($e);
  $user=null;

} // this code is saying if the session to the app is created use 
}
//the $me as a selector for the information or die

?> 
```

但是 $user 每次都响应 0 。在这一点上我被严重卡住了。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:13:03.223

> 我正在使用下面的代码来检查用户是否登录到 Facebook。

我怀疑那是你的问题。

您无法检查访问您的应用程序的*任何用户是否已登录 Facebook - 如果用户之前已**连接*到您的应用程序，您只会获得有关用户的信息。而且由于我在您的代码中没有看到类似的内容，因此我假设您之前没有以任何方式触发它。

所以请从这里开始阅读文档：[https ://developers.facebook.com/docs/technical-guides/login/](https://developers.facebook.com/docs/technical-guides/login/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T07:12:22.417

得到一个 0 是意料之中的。您应该在获得该信息后将用户重定向到登录网址。如果您这样做，用户将获得您看到的那些应用程序授权屏幕之一，之后他们将被重定向到您指定的 whatevef url。

查看提供的链接，但也可以查看[http://www.facebookanswers.co.uk/?p=229](http://www.facebookanswers.co.uk/?p=229)，因为我在那里提供了一些示例。

我的链接中的示例确实需要更新，但是如果您看一下，您会看到它会检查 getuser 是否返回 false，如果是则跳转到登录页面。

# ios - iOS - 如何使用自动布局调整视图大小？

> ID：14429326
> 
> 赞同：2
> 
> 时间：2013-01-20T21:06:14.483
> 
> 标签：ios, uiview, height, autolayout

我是自动布局的新手，需要在旋转到横向时调整一些视图的大小。

我从上到下的视图层次结构是：

1.  工具栏（用户信息）
2.  工具栏（滚动视图 #1 标题）
3.  滚动视图 #1
4.  工具栏（滚动视图 #2 标题）
5.  滚动视图 #2

所有视图彼此相邻，并且在旋转时保持相同的布局。

但是，我需要将两个滚动视图缩小一点，以便在横向模式下一切都适合屏幕。

这样做的正确方法是什么？我尝试在方向更改方法中手动更改滚动视图框架，但视图大小没有改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T23:32:00.160

1.  给工具栏明确的高度。
2.  将顶部工具栏固定到顶部和侧面。
3.  将底部滚动视图固定到侧面和底部
4.  使 2 个滚动视图的高度相同。
5.  使所有视图之间具有垂直间距约束（如果在将它们拖入时将它们放在彼此的顶部，则应该自动获得此约束）。

这应该足以定义每个视图的大小和位置。当视图在旋转时变小，唯一可以自由改变的就是滚动视图的高度。

# oracle - oracle - 多次插入类型表集合

> ID：14429327
> 
> 赞同：3
> 
> 时间：2013-01-20T21:06:17.567
> 
> 标签：oracle, collections, types, select-into, bulk-collect

我在 oracle 11g 中创建了以下对象。

```
CREATE OR REPLACE TYPE myObject as object(
fieldOne number,
fieldTwo number
); 
```

并创建了一个新的表类型 myObject；

```
CREATE OR REPLACE TYPE myTable IS TABLE OF myObject; 
```

我现在想创建一个新的 myTable 实例，并`myTable`在 SQL Plus 命令行上添加几个硬编码的行，然后将对象`myProcedure`作为参数传递给。

我尝试了以下方法；

```
declare newTable myTable;
begin
select myObject(50,5) bulk collect into newTable from dual;
select myObject(40,7) bulk collect into newTable from dual;
myProcedure(newTable);
commit;
end; 
```

`select into`尽管第二个语句覆盖了第一个语句，但哪种方法有效。

我的问题是；如何将多行添加到 newTable？

提前谢谢了 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:15:26.033

```
declare
    newTable myTable;
begin
    newTable := myTable();
    newTable.extend(2); -- The desired size of the collection

    -- Oracle collections begin at index 1, not 0
    newTable(1) := myObject(50, 5);
    newTable(2) := myObject(40, 7);

    myProcedure(newTable);
end; 
```

# django - 如何获取用户的地理位置并获取距离 - django

> ID：14429334
> 
> 赞同：0
> 
> 时间：2013-01-20T21:06:53.813
> 
> 标签：django, geolocation

我在谷歌上搜索了一个小时，但没有找到好的东西。我的目标是在搜索过程中获取用户的位置，并显示到用户正在寻找的地方的距离。我想在 django/python 中执行此操作

我问这个问题只是为了澄清我的想法并获得一些指导。到目前为止，我的想法是：

1.  获取用户的IP。并通过这个ip，得到城市，国家，甚至街道，是否有可能做准确的跟踪？
2.  在搜索结果中获取每个咖啡馆的地址，并要求谷歌计算距离。（不知道其他方式，有什么想法吗？）
3.  显示距离（例如：距离这里 3 公里）

我期待一些有用的 API 的指导，作为我步骤中我的小问题的答案和答案。

多谢

# c++ - 为什么我的基于范围的 for 循环会使我的 C++ 程序崩溃？

> ID：14429338
> 
> 赞同：2
> 
> 时间：2013-01-20T21:07:13.360
> 
> 标签：c++, for-loop, c++11, clang

我正在尝试使用基于 for 循环的新 C++11 范围。这是我的程序：

```
#include <iostream>
#include <string>
#include <sstream>
#include <fstream>

using namespace std;

ofstream logger("log.txt");
void log(string message)
{
    logger << message << std::endl;
    logger.flush();
}

int main( int argc, char* args[] )
{
    log("hello world");
    cout << "hello world\n";

    log("declare sort me");
    int sortMe[10];

    log("loop sortMe");
    for(int i : sortMe) {
        log("in loop " + i);
        sortMe[i] = i + 1;
    }
} 
```

我正在使用 clang++ 进行编译。它与警告一起编译：

```
clang++ -o mycpp mycpp.cpp
mycpp.cpp:24:12: warning: range-based for loop is a C++11 extension
      [-Wc++11-extensions]
        for(int i : sortMe) {
                  ^
1 warning generated. 
```

当它运行时，我得到这个输出：

```
hello world
Segmentation fault (core dumped) 
```

根据 log.txt 文件，程序进入 for 循环，但从未进入 for 循环。我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-20T21:11:48.387

这个循环：

```
for(int i : sortMe) {
    log("in loop " + i);
    sortMe[i] = i + 1;
} 
```

循环并返回存储在数组中的*值*，而不是数组的*索引*。结果，查找将跳转到数组的完全随机索引（可能方式，超出范围），从而导致段错误。`sortMe`*`sortMe``sortMe[i]`*

 *如果要将每个元素设置为等于其位置，只需使用普通的 for 循环：

```
for (int i = 0; i < 10; i++) {
    sortMe[i] = i + 1;
} 
```

此外，正如@hmjd 指出的那样，调用`log`将无法正常工作，因为您正在对字符串进行指针运算，而不是进行字符串连接。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-20T21:11:55.003

您正在使用基于范围的`for`循环，而您应该使用标准`for`循环。`int i`循环中的不是*当前*元素的索引，而是该元素的值。也就是说，如果您的数组包含`{1, 3, 3, 7}`，则`i`每次迭代的值将是`1`, then `3`, then `3`, then `7`。由于您的数组未初始化，因此您不知道的值`i`将是什么，并且您将获得未定义的行为。

如果您希望在 for 循环中使用索引，请使用标准 for 循环：

```
for(int i = 0; i < 10; i++) {
    log("in loop " + std::to_string(i));
    sortMe[i] = i + 1;
} 
```

请注意，要与 进行字符串连接`+`，您的操作数之一需要是`std::string`. 否则，您将添加`i`到指向第一个字符的指针`"in loop "`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-20T21:11:23.483

for 循环中对 log() 的调用不正确。参数是指针算术的结果，一个未知的 int 值被用作相对于字符串字面量基地址的偏移量。

使用 std::to_string() 将 int 转换为 std::string。

仅提及[std:iota](http://en.cppreference.com/w/cpp/algorithm/iota)，它可用于将范围的元素设置为基于初始值的递增值：

```
std::iota(std::begin(sortMe), std::end(sortMe), 1); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T21:21:42.947

我认为您希望基于范围的循环做一些不同于它所做的事情......

如果您编写`for (int var: array) { log(var); }`代码，那么代码将被执行的次数与数组中的元素一样多。每次，`var`将等于数组的元素之一。请注意，我`var`直接用作数组元素，而不是`array[var]`！

例如，如果您有`int[3] array = { 42, 69, 1337 };`，则 for 循环的先例将记录 42、69 和 1336。

因此，如果我只是这样做`int[3] array;`，则前面的 for 循环将循环三个已经在存储数组的内存中的随机整数......如果`var`我不直接使用`array[var]`它，那么它很可能会崩溃，因为 var 不是的有效索引`array`。

* * *

**解决方案：**

不要对数组元素和索引之间的区别感到困惑......

*   如果要直接操作数组的元素：

    ```
    for(int element : sortMe) {
        /* Do something with the element */
    } 
    ```

*   如果要使用索引，请不要使用基于范围的循环：

    ```
    for(int index = 0; index < 10; ++index) {
        /* Do something with the index */
    } 
    ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-20T21:23:02.390

请不要对此投赞成票或反对票。我只是添加一个我通常会作为评论添加的点，以帮助该人解决问题，但由于您无法格式化....

你可以用新的方式做你想做的事，但这是一个相当没有意义的练习，最好使用常规的 for 循环来完成。range 循环返回值，而不是引用。至少在你使用它的方式上。

```
 int count = 0;
 // Use a reference so we can update sortMe
 for (int& i : sortMe) {
    i = ++count;
 } 
```

看着它，它比普通的 for 循环更紧凑，奇怪的是我更喜欢它。;)*

# python - 使 SQLAlchemy 映射类分布在不同模块中的惯用方法

> ID：14429345
> 
> 赞同：2
> 
> 时间：2013-01-20T21:08:07.097
> 
> 标签：python, orm, import, sqlalchemy

如何让相关的 SQLAlchemy 映射类分布在不同的模块中的问题在[这里](https://stackoverflow.com/questions/3357825/python-sqlalchemy-how-to-relate-tables-from-different-modules-or-files)[出现](https://stackoverflow.com/questions/11720898/flask-sqlalchemy-relationships-between-different-modules)了[很多](https://stackoverflow.com/questions/7478403/sqlalchemy-classes-across-files)次。不过，没有一个提议的解决方案对我很有效，我很想知道这是如何正确处理的（即我不想让我的代码可运行，我想把它做对）。

我真的很喜欢[这个解决方案](https://stackoverflow.com/a/7479122/262271)：

## 基础.py

```
from sqlalchemy.ext.declarative import declarative_base
Base = declarative_base() 
```

## 一个.py

```
from sqlalchemy import *
from base import Base
from sqlalchemy.orm import relationship

class A(Base):
    __tablename__ = "A"
    id  = Column(Integer, primary_key=True)
    Bs  = relationship("B", backref="A.id")
    Cs  = relationship("C", backref="A.id") 
```

## b.py

```
from sqlalchemy import *
from base import Base

class B(Base):
    __tablename__ = "B"
    id    = Column(Integer, primary_key=True)
    A_id  = Column(Integer, ForeignKey("A.id")) 
```

## py

```
from sqlalchemy import *
from base import Base

class C(Base):
    __tablename__ = "C"    
    id    = Column(Integer, primary_key=True)
    A_id  = Column(Integer, ForeignKey("A.id")) 
```

## 主文件

```
from sqlalchemy import create_engine
from sqlalchemy.orm import relationship, backref, sessionmaker

import base

import a
import b
import c

engine = create_engine("sqlite:///:memory:")
base.Base.metadata.create_all(engine, checkfirst=True)
Session = sessionmaker(bind=engine)
session = Session()

# snip 
```

但是，如果我希望能够对a.py 中的 A 类*做一些事情，而不是定义它呢？*例如

## 一个.py

```
from sqlalchemy import *
from base import Base
from sqlalchemy.orm import relationship
import main

class A(Base):
    __tablename__ = "A"
    id  = Column(Integer, primary_key=True)
    Bs  = relationship("B", backref="A.id")
    Cs  = relationship("C", backref="A.id")

def populate_A(session):
    for i in range(10):
        new_A = A(id=i)
        session.add(new_A)
    session.commit()

if __name__ == '__main__':
    session = main.Session()
    populate_A(session) 
```

这就是我想要构建我的代码的方式 - 从语义上讲， A 和 populate_A 似乎它们应该存在于同一个模块中。但显然这在上面的示例中不起作用，因为循环 a -> main -> a 导入。

所以我通常会在某处定义 A (a.py)，然后在导入 main (a_functions.py ？) 的单独模块中做一些事情。或者，由于创建会话不需要导入映射类但创建表需要，我是否将这两个功能放在不同的模块中？还是我在 main.py 中做一些恶心的事情，比如

```
def create_tables():
    import a, b, c
    engine = create_engine("sqlite:///:memory:")
    base.metadata.create_all(engine) 
```

这样 a、b 和 c 仅在我需要创建表时有条件地导入，避免循环导入？

简而言之，使用 SQLAlchemy 的包的*惯用*高级组织是什么样的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:04:03.330

我认为这实际上是 Python 成语的问题，而不是 SQLAlchemy 成语的问题。[根据 Guido Van Rossum 的说法，在包中运行脚本是一种反模式](http://mail.python.org/pipermail/python-3000/2007-April/006793.html)（zzeek 在评论中暗示了这一点）。所以 a.py、b.py 和 c.py 不应该有`if __name__ == '__main__'`块。

# javascript - 为什么多选值显示为 csv 而不是数组？

> ID：14429348
> 
> 赞同：-1
> 
> 时间：2013-01-20T21:08:11.713
> 
> 标签：javascript, jquery, html, perl, cgi

这是我的html：

```
<select id="list" name="list" size=10 multiple>
  <option value="xx">opt-1</option>
  <option value="yy">opt-2</option>
  <option value="zz">opt-3</option>
</select> 
```

我得到这个的价值：

```
var list_v = $("#list").val(); 
```

使用 .post 调用提交如下：

```
'&mylist='+list_v 
```

在我收集的cgi中是这样的（perl）：

```
@list_values = $q->param('mylist'); 
```

我将所有选定的选项作为 @list_values 数组中的一个元素。我认为我应该将所有值作为数组的单独元素获取！！！

因此，例如，如果有人选择 opt-1 和 opt-2 我希望在 @list_values [xx yy] （两个值作为两个元素）

但是，我得到的是 [xx,yy ] （两个值作为一个元素）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:17:36.717

如果我理解正确，您应该使用[.serialize](http://api.jquery.com/serialize/)方法。`list[]=xx&list[]=yy`如果选择了两个选项，它会给你。然后您不再需要手动构建数据参数字符串：

```
$.ajax({
    url: '/post-collector',
    method: 'POST',
    data: $('#your-form').serialize()
}); 
```

你可以在这里看到不同之处：http: [//jsfiddle.net/QeqvF/](http://jsfiddle.net/QeqvF/)

# c# - C# 日志套接字连接

> ID：14429350
> 
> 赞同：0
> 
> 时间：2013-01-20T21:08:15.967
> 
> 标签：c#, sockets, logging, connection

我不知道我会怎么做，但我假设它以某种方式、形状或形式是可能的。

1.  如果我的服务器允许通过一个端口进行多个连接，有没有办法可以对连接进行某种记录，以便我可以选择某个连接来发送消息？此外，如果这是可能的。

2.  是否也可以通过*`different`*端口进行连接？

3.  我该怎么办？我对 C# 还很陌生，所以不是很有经验 - 非常感谢任何帮助！

基本上我希望`3`客户端连接到服务器。客户端都会向服务器发送一条消息，服务器将等待每个客户端的消息，然后再回复它们，按照消息发送的顺序。

我希望这现在更有意义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:44:55.207

如果您使用的是 TCP/IP，这很有可能 -`Socket`侦听传入连接的只是这样做 - 它不处理与每个单独套接字的通信。相反，`Accept()`and方法为每个连接的客户端`BeginAccept()`返回一个新实例。`Socket`

因此，`Socket`当客户端连接时获得的实例仅接收来自该客户端的消息，并且在该套接字上发送消息仅将其发送给该客户端。

跟踪哪个连接发送了什么 - 哪个先发送 - 将更具挑战，但绝对有可能。

如果您使用的是 UDP，尽管情况有些不同，您需要使用自定义方法来识别每个客户端。

# vb.net - 将 DateTime 转换为整数

> ID：14429352
> 
> 赞同：1
> 
> 时间：2013-01-20T21:08:22.757
> 
> 标签：vb.net, visual-studio-2010, time, integer

您如何将随机生成的时间转换为整数，这就是我格式化时间的方式；

```
StartTime = FormatDateTime(Now, DateFormat.LongTime)
EndTime = FormatDateTime(Now, DateFormat.LongTime)
Diff = (EndTime - StartTime.Subtract(TimeSpan)) 
```

所以例如`Diff = "08:30:12"`

我希望能够在 8 小时 30 分钟内将其转换为“8.30”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:09:44.983

8.30 不是`Integer`.

但是，如果您想要一个带有小时和分钟部分的字符串，您可以使用[`TimeSpan.Hours`](http://msdn.microsoft.com/en-us/library/system.timespan.hours.aspx)and[`TimeSpan.Minutes`](http://msdn.microsoft.com/en-us/library/system.timespan.minutes.aspx)属性：`String.Format`

```
String.Format("{0}.{1}", Diff.Hours, Diff.Minutes) 
```

[**演示**](http://ideone.com/IHM2nx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:57:03.810

您说您想要 Diff 结果的**整数**表示。
假设 Diff 是一个 TimeSpan 结构，为什么不简单地使用呢？

```
 Dim x as Integer 
 x = Convert.ToInt32(Diff.TotalMinutes) 
```

当然我假设差异永远不会大到溢出整数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T21:19:17.083

你可以做 ：

```
Dim d As Decimal
d = Diff.Hours + Diff.Minutes / 100D 
```

100D 给出了除法所需的小数。整数除法 30/100 给出 0

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-05T02:46:16.923

您可以使用 DateTime.DiffDate 函数，它返回一个 long

```
dim date1 as DateTime = Now
dim date2 as DateTime = Now.AddSeconds(-30600)  ' 8.5 hours ago
dim lHr as long = DateDiff(DateInterval.Hour, date1, date2) '=-8
dim lMn as long = DateDiff(DateInterval.Minute, date1, date2) '=-510
lHr = DateDiff(DateInterval.Hour, date2, date1)     ' = +8
lMn = DateDiff(DateInterval.Minute, date2, date1)   ' = +510 
```

（在 DateDiff 中还有其他时间间隔、天数、秒数等也会派上用场）请注意，您的值没有四舍五入。使一小时内的分钟数变得容易

```
num_Minutes_Past_Hour = lMn - lHr * 60     ' = 30 
```

# php - Wordpress 远程导致“此网页有重定向循环”错误

> ID：14429363
> 
> 赞同：6
> 
> 时间：2013-01-20T21:09:36.463
> 
> 标签：php, wordpress, redirect

我有一个在开发中运行良好的 Wordpress 站点（在`mysite.dev`），但是当我将它部署到我的远程服务器（`mysite.com`）时，它会抛出“**此网页有重定向循环**”错误。

我可以在加载栏中看到浏览器一次又一次地尝试 www.mysite.com 然后是 mysite.com 然后是 www.mysite.com，但是我不确定这是否相关。

如果我的 Wordpress 数据库配置不正确，我会收到**错误建立数据库连接**消息，但是当一切设置正确时，它会在这个重定向循环中中断。

我已更改数据库中的字段 ( `siteurl`) 以反映远程设置 ( `http://mysite.com/wordpress`)。

注意：我的 wordpress 文件存储在`wordpress`我的根目录中的一个文件夹中，除了`wp-config.php`,`index.php`和`.htaccess`.

有任何想法吗？

.htaccess 内容：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

索引.php：

```
<?php
/**
 * @package WordPress
 */
define('WP_USE_THEMES', true);

require('./wordpress/wp-blog-header.php');
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T12:25:08.837

我的托管服务器设置迫使 mysite.com 访问 www.mysite.com，这导致了问题。我关闭了这个设置，现在一切正常，不过我仍然想知道如何让它在这个设置打开的情况下工作！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-05T05:55:44.593

我遇到了完全相同的问题（迁移到新服务器后的重定向循环）。

但这**不是配置值 siteurl 和 home**的问题，也不是 .htaccess 文件的问题。我尝试了所有这些。而且**添加到 URL 中的“www”也不是问题**。

经过一些研究，我发现循环是由对 redirect_canonical 函数（在 wp-inclue/canonical.php 中）的无限调用引起的。但这不是 wordpress 的错误。当您访问根 url 时，一些 PHP 配置以“错误的方式”设置了 $_SERVER['REQUEST_URI']。示例：在我的服务器上，当我访问[http://example.com/](http://example.com/)时，$_SERVER['REQUEST_URI'] 被设置为 '/index.php' 而不仅仅是 '/' 这对于 redirect_canonical 来说是令人困惑的，因为这个函数总是尝试重定向到它知道的页面的“更好”网址。您网站根目录的更好的 url 是“/”。在我的服务器上，每次 redirect_canonical 尝试重定向到 '/' 都会失败，然后再次尝试，直到找到无限重定向循环。

要纠正这个错误，你可以修改你的服务器配置——我个人不知道怎么做，但我知道这是可能的——或者如果你不能改变它，只需在[自定义插件](http://codex.wordpress.org/Writing_a_Plugin)中添加这个代码：

```
/**
 * avoid redirection loop in redirect_canonical if REQUEST_URI 
 * contains '/index.php' 
 **/

/* remove the action set in the hook 'template_redirect' by wordpress */
remove_action('template_redirect', 'redirect_canonical');

/* set a custom action in the hook 'template_redirect' to check REQUEST_URI value */
add_action('template_redirect', 'correct_redirect_canonical');

/* Function to correct the behaviour of redirect_canonical */
function correct_redirect_canonical(){
    if(strstr($_SERVER['REQUEST_URI'],'/index.php')===false){
        redirect_canonical();
    }
} 
```

希望能帮助到你 ！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-20T21:16:45.563

1.- 由于“我的 wordpress 文件存储在一个名为 wordpress 的文件夹中”，您必须`RewriteBase`像`RewriteRule`这样进行编辑：

```
RewriteBase /wordpress/
RewriteRule . /wordpress/index.php [L] 
```

**更新**

2.- 尝试清理所有 cookie。这个简单的动作（通过 Firebug）有时已经解决了我这个问题。

**更新 3**

3.- 在你的根目录中试试这个 /index.php：

```
// index.php file in root directory
chdir('wordpress'); // change dir to WP
include 'index.php'; // execute WP with their normal `index.php` 
```

并像往常一样离开`/wordpress`目录（里面有正常的 index.php 和 .htaccess）。

**我的意思是不要改变`index.php`WP**的任何正常情况，它是这样的：

```
<?php
/**
 * Front to the WordPress application. This file doesn't do anything, but loads
 * wp-blog-header.php which does and tells WordPress to load the theme.
 *
 * @package WordPress
 */

/**
 * Tells WordPress to load the WordPress theme and output it.
 *
 * @var bool
 */
define('WP_USE_THEMES', true);

/** Loads the WordPress Environment and Template */
require('./wp-blog-header.php'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-20T07:34:13.130

***请注意，使用CloudFlare Flexible SSL***时也会出现无限重定向问题。要修复它，您需要安装以下插件：

[https://wordpress.org/plugins/cloudflare-flexible-ssl](https://wordpress.org/plugins/cloudflare-flexible-ssl)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-20T22:04:20.843

您是否使用像[重定向](http://wordpress.org/extend/plugins/redirection/)这样的插件来跟踪 URL 更改？这可能会创建一个循环，将 mysite.dev/page/ 重定向到 mysite.com/page/ 并将 mysite.com 重定向到 mysite.dev。以前发生在我身上！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-20T23:23:08.000

此错误可能发生在两个地方之一，用户端或管理员端。

当它发生在管理员端（wp-admin）时，您会发现您无法登录。

第 1 步：使用 ftp 连接到您的博客并导航到 wp-content/plugins/ 目录，然后将所有插件下载到桌面上的文件夹中。第 3 步：仍然在您的 FTP 程序中，删除 plugins 目录中的所有插件文件夹和 php 文件。你不想在这个目录中留下任何东西。第 4 步：尝试登录您的博客。它应该可以让您毫无问题地登录。访问您博客的插件部分。这应该会加载很多错误，告诉您每个插件都因错误而被停用。还行吧。第 5 步：使用您的 ftp 程序，您应该上传所有插件。上传后，您应该在 wordpress 中逐个激活每个插件，然后访问 wp-admin/ 登录地址，以确保登录后它将通过您的博客。步骤 6：当您激活插件并再次开始出现此错误时，您将知道应该归咎于哪一个。只需通过 ftp 删除该插件，然后开始寻找要使用的替代插件。

如果这些步骤不能解决您的问题，您应该备份所有的 wordpress 文件，然后删除它们。您应该让他们为最新版本上传干净的 wordpress 文件，并尝试在没有上传主题或插件的情况下登录。一旦您可以登录，您可以稍后上传这些。

如果您继续收到错误，请清除浏览器缓存，测试使用其他浏览器登录。

如果一切都失败了，请联系您的虚拟主机或在 wordpress 支持论坛上打开一个线程

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-27T23:06:57.160

首先，我只是一个初学者，所以......同时我认为我可能有这个问题的替代/捷径。

我建议不要删除每个插件然后一个一个地重新安装所有插件，而是从删除最后的插件开始，因为“重新发送的问题=最近的修改/插件”......

这只是我的建议。

马可·戴维德

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-06T15:37:39.143

虽然我发现这篇文章和解决方案真的很有帮助，因为这个问题让我发疯了，花了我很多时间才意识到。在我的情况下，它发生是因为我将文件移动到同一服务器内但使用另一个域，并且在完成所有配置和替换后，我无法查看页面并收到此错误。在我的**托管设置**中，有一个首选域字段被设置为 domain.ltd （我试图更改它，但最后还是这样），而不是在**设置-> 通用**wordpress 仪表板中，我有 WordPress 地址（URL）“mysite.com”在没有 www..bum 的情况下设置最后一个值后，站点地址 (URL) 设置为“www.mysite.com”，现在一切正常。希望这对其他人有帮助

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-05-17T06:40:09.463

在我的情况下，本地 - Openserver。

问题出现在地址中的大写字母中。例如，在站点设置中`http://local-Host`，是大写字母导致了问题，因为整个地址被简化为小写字母 - `http://local-host`，结果与canonical.php`$redirect_url`中的不同`$requested_url`

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-04-20T11:19:55.113

我有同样的问题，答案是`.htaccess`那里的文件和重定向。似乎我使用的主题/插件需要自己的代码，类似于 wordpress 网站上的`htaccess`. 我查看了插件，找到了它引用的代码并在`htaccess`文件中更改了它。现在它起作用了。

# c# - 执行的字符集

> ID：14429369
> 
> 赞同：0
> 
> 时间：2013-01-20T21:10:05.887
> 
> 标签：c#, javascript

我的项目有问题。我有一个 js`function sig7`生成我的哈希。

但是页面的字符集`html`必须是`utf-8`.

我尝试在我的应用程序中使用库执行这个[js](http://javascriptdotnet.codeplex.com)`C#`

一切正常，但生成的哈希无效。我认为这是因为代码的字符集不是`utf-8`.

我的应用程序：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using Noesis.Javascript;
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {

            StreamReader sr = new StreamReader("c://lib.js");
            string script = sr.ReadToEnd();

            JavascriptContext context = new JavascriptContext();
            context.Run(script);
            var sig = context.Run(@"sig7('057d194dd856d4f8cd15bc85fbbddbf136df809f72f5a435e6af41c1f82f950f,Id166084073,ldsclldscl');").ToString();
            richTextBox1.Text = sig;
        }
    }
} 
```

sig 必须是`1dbde1d62b6e0dca7d56f72e50c178132e236978d2dba1e2c3ada5b7b8973aeb`但不是`7211ed8fe85d750c26cb5abb499bfa88b7cecbe968fc6cc7efa69dc496c8ae12`由我的应用程序生成的。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:45:54.097

这行应该：

```
var sig = context.Run(@"sig7('057d194dd856d4f8cd15bc85fbbddbf136df809f72f5a435e6af41c1f82f950f,Id166084073,ldsclldscl');").ToString(); 
```

是：

```
var sig = context.Run(@"sig7('057d194dd856d4f8cd15bc85fbbddbf136df809f72f5a435e6af41c1f82f950f', 'Id166084073', 'ldsclldscl');").ToString() 
```

?

# css - 如何让 div 始终保持全宽？

> ID：14429372
> 
> 赞同：0
> 
> 时间：2013-01-20T21:10:56.340
> 
> 标签：css, html, zooming, fluid-layout, multiple-columns

有没有办法防止 DIV 从动态归档内容中删除？当内容足够大时，它会保持全宽并且可以很好地缩放，但是当它很小时，它会从顶部组中分离出来。

这是我的 html 和 css 的副本：

```
<style>
#title{
font-family: Arial;
font-size: 1.5em;
font-weight: bold;
text-align: center;
background: beige;
padding: 7px 50px 7px 50px;
margin: 10px 0px 0px 0px;       /* L&R margins need to be 0px */
}

#box1{                          /* Outer Box */
float: left;
font-size: 1em;
text-align: justify;
background: beige;
margin: 0px;            /* L&R margins need to be 0px */
padding: 0px 50px 10px 50px;
}

#box2{                  /* Inner Box */
font-family: Arial;
float: right;
width: 50%;
font-weight: bold;
font-size: 1em;
text-align: justify;
background: beige;
margin: 0px;            /* L&R margins need to be 0px */
padding: 0px 0px 0px 50px;
display: block;
}

#box3{                  /* Footnotes */
margin: 0px;            
float: left;
font-size: 1em;
text-align: justify;
background: beige;
padding: 0px 50px 30px 50px;
border-radius: 0px 0px 15px 15px;
}

#footnote_columns{
display: block;
overflow:hidden;
/*columns: auto auto;   /* column-count: auto column-width: auto; */
column-fill: balance;   /* not working!!! */
column-count: 3;
-moz-column-count: 3;
-webkit-column-count: 3;
column-width: auto;
-moz-column-width: auto;
-webkit-column-width: auto;
column-gap: 2em;
-moz-column-gap: 2em;
-webkit-column-gap: 2em;
}
</style>
<!-- ====================== Page Title ===================== -->
            <div id='title'>
                <HR>
                'Title' centered & full width
                <HR>
            </div>
<!-- ============ text box inside text box ================ -->
                <div id="box1">             <!-- Left Side -->
                    <div id="box2">         <!-- Right Side -->
                        <p>
                        INNER Box2 text: " Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas sed nibh eu velit iaculis auctor non ac magna. In at enim quis mi aliquam vestibulum imperdiet eu magna. Ut aliquet arcu at felis dapibus euismod. Suspendisse dolor turpis, faucibus quis mollis vitae, iaculis vel urna. Integer sit amet dui malesuada justo facilisis rutrum sed vel neque. Cras condimentum est sit amet mi dapibus convallis. Donec molestie euismod velit id pharetra. Praesent sit amet eros at quam ullamcorper sodales. Aenean ligula dui, ultricies quis commodo ut, lobortis eu justo. Nulla dolor augue, vulputate at placerat in, ornare et purus. " 
                        </p>
                        <HR>
                    </div>
                        <p>
                        OUTER Box1 text: " Etiam at pretium urna. Morbi condimentum consequat nisi, nec pulvinar tellus fermentum at. Cras ut sodales ante. Sed feugiat sem eget eros lobortis sit amet porttitor mauris tempus. Sed eros est, placerat at sollicitudin quis, scelerisque ac dolor. Proin mollis euismod condimentum. Morbi eget tortor justo, eu vestibulum orci. Pellentesque eu ante a nunc adipiscing sodales dictum vitae eros. Sed tellus mauris, volutpat non vulputate ut, vulputate ut orci. Vivamus facilisis ipsum a tellus gravida pellentesque. Nam risus magna, eleifend dignissim porttitor et, sagittis quis nisl.

                        Sed eget lorem magna. Sed sed imperdiet elit. Sed vulputate dapibus tellus, nec scelerisque risus hendrerit quis. Fusce aliquet erat non nibh egestas posuere. Aliquam ipsum velit, venenatis vel dictum ac, luctus nec sapien. In hac habitasse platea dictumst. Vivamus a elit augue. Integer pellentesque enim sit amet sem condimentum ut tincidunt nunc mollis. Cras in tellus eget dui pellentesque adipiscing. In varius ullamcorper felis, vitae sagittis turpis rutrum in. Aliquam consectetur consectetur erat, quis tristique magna laoreet id. Etiam orci arcu, ultricies eget interdum non, mollis quis est. Mauris odio lacus, tempus at porta quis, laoreet porta tortor. "
                    <HR>
                </div>
                <div id='box3'>
                        <div id='footnote_columns'>
                        <p>
                        FOOTNOTE Box3 text: " Vivamus egestas tempor molestie. Morbi scelerisque nunc non eros ultrices volutpat. Suspendisse potenti. Sed lobortis, odio vitae pharetra dapibus, risus turpis scelerisque risus, a dapibus dui ante sed ante.   "
                        </p>
                        </div>
                    <HR>
                </div>
<!-- ======================================================= --> 
```

示例 1 有效 - 有很多 txt -

示例 2 中断 - 缩放时 -

(1) [http://jsfiddle.net/NuxWD/1/](http://jsfiddle.net/NuxWD/1/) - 全文

(2) [http://jsfiddle.net/NuxWD/2/](http://jsfiddle.net/NuxWD/2/) - 尝试缩放，注意脚注

(3) [http://jsfiddle.net/NuxWD/3/](http://jsfiddle.net/NuxWD/3/) - 脚注中的少量txt

(4) [http://jsfiddle.net/NuxWD/4/](http://jsfiddle.net/NuxWD/4/) (5) [http://jsfiddle.net/NuxWD/5/](http://jsfiddle.net/NuxWD/5/) - 一切都崩溃了！

动态内容需要这个。如果我在示例 (4) 中删除 BR，则框架保持正常；

**即使段落很短，框架如何保持全宽？**

*   注意底行，脚注，尝试调整txt的数量；或缩小

IE 甚至根本不列脚注。

**为什么无论是文本量少还是缩小，标题都不受影响？**

# c# - 如何避免 Windows 8 上出现“Windows 保护您的 PC”警告？

> ID：14429377
> 
> 赞同：2
> 
> 时间：2013-01-20T21:11:20.953
> 
> 标签：c#, c++, windows-8, digital-signature, digital-certificate

> **可能重复：**
> [安装签名应用程序时如何在Win8上通过智能屏幕？](https://stackoverflow.com/questions/12311203/how-to-pass-the-smart-screen-on-win8-when-install-a-signed-application)

当我从我的网站下载我的可执行文件（打包在一个 ZIP 文件中）然后尝试在 Windows 8 中运行它时，操作系统显示以下覆盖：

![在此处输入图像描述](../Images/5034cf4bc0c10a92e0e9a14847a6bcc1.png)

请注意，我的 exe 文件是使用信誉良好**的数字证书签名的。**

所以我的问题是，我应该怎么做才能避免将这条消息显示给最终用户，因为微软的措辞和呈现方式，我的软件看起来像病毒？

**编辑：**我不确定它是否有所作为，我使用的是[Comodo](http://www.comodo.com)数字证书。它大约2个半月大。

# php - 仅在 Wordpress 中为博客初始化第二个主题

> ID：14429380
> 
> 赞同：0
> 
> 时间：2013-01-20T21:11:33.917
> 
> 标签：php, wordpress, wordpress-theming

我使用 wordpress 开发了一个带有博客的网站。在我准备好主题后，网站所有者要求我使用他仅为网站博客购买的其他主题。

如何在不将其设置为选项表上的网站主题的情况下初始化第二个主题？

我可以做到定义`TEMPLATEPATH`常数`wp-includes/default_constants.php`

```
function 'wp_templating_constants':
define('TEMPLATEPATH', get_theme_root() . '/theme-name'); 
```

并设置过滤器：

`pre_option_template`, `template`, `pre_option_current_theme`, `stylesheet_directory_uri`,`stylesheet_directory`在主题的functions.php中。

但是，当然，我想在知道用户是否在博客页面上之后动态地执行此操作。有谁知道该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T15:12:28.287

这是插件将主题设置为类别列表的代码，该类别列表不是数据库上定义的主题。

```
new SetTheme('[THEME_NAME]', array('[CAT_NAME]', [CAT_ID], [CAT_OBJECT]));

class SetTheme {
    private $theme_name = '';
    private $categories = array();

    public function __construct($theme_name, $categories) {
        // define original theme location for any reason
        define('ORIGTEMPLATEPATH', get_template_directory());
        define('ORIGTEMPLATEURI', get_template_directory_uri());

        // init class parameters
        $this->theme_name = $theme_name;

        foreach ($categories as $cat) {
            if (is_string($cat))
                $cat = get_category_by_slug($cat);

            $category = get_category($cat);
            $this->categories[$category->term_id] = $category;
        }

        // apply action to setup the new theme only on action 'setup_theme'
        // because some functions are not yet loaded before this action
        add_action('setup_theme', array($this, 'setup_theme'));
    }

    public function setup_theme() {
        // if the current post or category is listed, apply the new theme to be initialized
        if ($this->is_category_theme())
            $this->set_theme();
    }

    private function is_category_theme() {
        // get category from current permalink
        // and check if is listed to apply the new theme
        $current_cat = get_category_by_path($_SERVER["HTTP_HOST"] . $_SERVER['REQUEST_URI'], false);
        if (isset($this->categories[$current_cat->term_id])) return true;

        // get post from current permalink
        // and check if it belongs to any of listed categories
        $current_post = url_to_postid($_SERVER['REQUEST_URI']);
        $post_categories = wp_get_post_categories($current_post);
        foreach ($post_categories as $cat_id)
            if (isset($this->categories[$cat_id])) return true;

        return false;
    }

    private function set_theme() {
        // apply the filters to return the new theme's name
        add_filter('template', array($this, 'template_name'));
        add_filter('stylesheet', array($this, 'template_name'));
    }

    public function template_name() {
        // return new name
        return $this->theme_name;
    }
} 
```

类的参数是主题名称和类别数组（ids、slugs 或类别对象）。

当然，这是我需要的，可能对于其他主题，函数“set_theme”中需要其他过滤器。

它需要是一个插件，因为插件是在主题之前甚至在 WP 类之前加载的。

使用这个插件，原始插件将永远不会被调用（至少在我的情况下）。

# algorithm - 我可以少问多少个问题来猜一个数字？

> ID：14429384
> 
> 赞同：-3
> 
> 时间：2013-01-20T21:12:10.257
> 
> 标签：algorithm, math, puzzle, binary-search

如果我让一个人在他的脑海中选择一个介于 1 到 1200 之间的数字。如果我只能问他只会回答“是”或“否”的问题，我需要问多少个问题才能得到他在我脑海中选择的数字的答案？

我正在寻找尽可能少的问题。任何经过验证的解决方案都将是可观的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T21:19:39.373

要确定选择 1 和 n 之间的哪个数字，您需要至少询问 log [2] n 个问题。没有办法做得更好。

这个答案的直觉如下。假设你一共问了 k 个问题。对于这些问题，即使它们相互依赖，您可以收到的不同可能答案的最大数量是 2 ^k。由于可以选择 n 个可能的数字，因此您需要选择 k 使得

> 2 ^k ≥ n

这恰好发生在

> k≥log [2] n

换句话说，你必须至少问 log [2] n 个问题，才能获得足够多不同的可能结果，以便将每个可能的数字与一些可能的结果联系起来。由于问题的数量必须始终是自然数，因此您可以提出的最小问题数量必须至少为 ⌈log [2] n⌉

这纯粹是答案的下限。在这一点上，我们不能排除您可能需要比这更多的问题才能得到答案的可能性。然而，我们知道二分搜索算法这一事实意味着我们知道你永远不需要超过 ⌈log [2] n⌉ 个问题来获得答案，因为这是你在做二分搜索时会问的问题的数量搜索。这意味着二分搜索算法必须是最优的，因为不可能问出更少的问题。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:19:24.560

以 2 为底的 1200 的对数，四舍五入为整数：即 11。基本上，每个问题都将可能范围减半，因此您只需继续进行二分搜索，直到可能范围的长度为 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T22:49:53.713

这也是对抗性参数方法的经典示例，用于查找下限复杂度。在我们的例子中，知道号码的人就是对手。所以当你问一个新问题时，他会明智地改变他的真实答案。他如何确定每一步的答案？例如，数字在 1-100 之间。

你问：是n>=50吗？他可能会说“是”或“否”对他来说都一样好，因为间隔是相等的。假设他说是的。

然后你说一个介于 50<=N<=100 之间的数字，假设你问：is n>=80。那么即使他选择的数字大于 80，他也应该说 NO，因为 50<=n<=80 是更大的间隔。现在这个数字可能在 50 到 80 之间

保持这种方式，他将保证最大问题数，即 logn，因为间隔大小像二进制搜索一样减小

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T21:20:25.327

询问数字中的所有位。11个问题就足够了。编辑：我认为，由于二进制和十进制表示之间的双射性，不可能做得更好——至少在最坏的情况下是这样。

# javascript - Ti.Network.addConnectivityListener()

> ID：14429385
> 
> 赞同：0
> 
> 时间：2013-01-20T21:12:16.680
> 
> 标签：javascript, tidesdk

我是 TideSDK 的新手，我正在尝试使用 addConnectivityListener() 检查我的桌面应用程序上的互联网连接，阅读了很多信息，但仍然无法使其正常工作。你能帮我吗，我需要怎么开火，或者它不起作用？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T02:21:36.713

@Egor 对于连接，建议您使用以下内容：

```
if (navigator.onLine) {
  // do something
} else {
  // do something else
} 
```

这是一篇不错的文章，可以为您提供一些关于在线/离线应用程序的好主意：

[http://hacks.mozilla.org/2010/01/offline-web-applications/](http://hacks.mozilla.org/2010/01/offline-web-applications/)

# php - 将 Yii 控制器动作转移到 cron 作业中

> ID：14429387
> 
> 赞同：0
> 
> 时间：2013-01-20T21:12:27.473
> 
> 标签：php, mysql, yii, cron

我使用这个[站点](http://mintao.com/3-easy-steps-to-create-and-execute-cronjobs-with-yii)作为在 yii 中设置 cron 作业的指南。

当我将给定值（Value2）从“A”更改为“B”时，我在 TableA（更新）中的当前控制器操作将执行一个 sql 事务以在我的数据库中填充 TableB。

这是我目前用来完成此操作的代码。这是我在控制器 A 中的更新操作

```
$connection = yii::app()->db;
$sql1 = "INSERT INTO TableB (value1, value2, value3)
     VALUES(:val1, :val2, :val3)";
$command=$connection->createCommand($sql1);
$command->bindValue(":val1", $model->tableAId);
$command->bindValue(":val2", 'B');
$command->bindValue(":val3", $model->Attribute2);
$command->execute(); 
```

由于我使用的是 bindValue，因此很容易将我的值输入到不同的表中。将此逻辑移动到 cron 作业中，我不知道从哪里开始执行相同的事情。

那么在 cron 作业中使用类似的代码会不会同样有效？

```
public function run($args)
{
    $transactions = TableA::model()
    ->findBySql('SELECT * FROM `TableA` '.
    'WHERE `value2` = A '.
    'AND TO_DAYS(`DateCreated`)+3 < TO_DAYS(NOW())');
    foreach ($transactions as $transaction) {
        $connection = yii::app()->db;
        $sql1 = "INSERT INTO tableB (value1, value2, value3)
             VALUES(:val1, :val2, :val3)";
        $command=$connection->createCommand($sql1);
        $command->bindValue(":val1", $model->tableAId);
        $command->bindValue(":val2", 'B');
        $command->bindValue(":val3", $model->Attribute2);
        $command->execute();
    }
} 
```

我需要在 TableB 中创建一条新记录，还需要将 TableA 中的 value2 从“A”更新为“B”

我已经尝试过运行这个 cron 作业，但没有得到任何结果，也不知道如何进行故障排除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T04:25:42.977

可以使用 TableA 和 TableB 模型吗？

在控制器 A 中：

```
$model = $this->loadModel();
$model->value2 = 'B';
if ($model->save()) {
   $modelB = new TableB();
   $modelB->value1 = $model->value1;
   $modelB->value2 = $model->value2;
   $modelB->value3 = $model->value3;
   $modelB->save();
} 
```

在 cron 工作中

```
// find all
$transactions = TableA::model()->findAll(array('condition' => array(
  'value2 = :A',
  new CDbExpression('TO_DAYS(`DateCreated`)+3 < TO_DAYS(NOW())'),
), 'params' => array( ':A' => 'A')));
foreach ($transactions as $transaction) {
    $model->value2 = 'B';
    if ($model->save()) {
        $modelB = new TableB();
        $modelB->value1 = $model->value1;
        $modelB->value2 = $model->value2;
        $modelB->value3 = $model->value3;
        $modelB->save();
    }
} 
```

或者你也可以在modelA中创建函数：

```
public function createB()
{
    $modelB = new TableB();
    $modelB->value1 = $model->value1;
    $modelB->value2 = $model->value2;
    $modelB->value3 = $model->value3;
    $modelB->save();
} 
```

并在您需要时调用它

# c - 释放全局变量

> ID：14429389
> 
> 赞同：1
> 
> 时间：2013-01-20T21:12:55.303
> 
> 标签：c, malloc, c99

假设我有一个包含大型结构的全局变量：

```
typedef struct {
    char Big[1024]
} LARGE;

static LARGE x;

void main()
{
     free(x);
} 
```

当我不再需要它时，我可以安全地从 main 调用 free(x) 吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T21:14:22.897

不，您没有动态分配`x`，因此不需要（也不能）释放它。

如果您绝对需要在程序退出之前释放内存，请将指针声明为全局，按需分配它，使用`malloc`or `calloc`，然后`free`在完成结构时使用它。

```
static LARGE* x;

void main()
{
    x = malloc(sizeof(*x));
    // use x
    free(x);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-20T21:15:23.740

不，`free`只能用于解除分配已通过调用分配的对象`malloc`。

具有静态存储持续时间的对象只能在程序退出时释放。

# python - 试图从 django url 乘以一个值

> ID：14429396
> 
> 赞同：0
> 
> 时间：2013-01-20T21:13:55.080
> 
> 标签：python, django, django-urls

我有一个像

```
r'^(?P<num>)\d+)$ 
```

我正在尝试做类似的事情

```
kwargs['num']*3 
```

其中，当 num=2 给我一个奇怪的数字，比如 222222222...

但是，如果我尝试 int(kwargs['num'])*3 那么它会按预期工作。

谁能解释发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:15:39.043

该值不是整数而是字符串。先转换一下：

```
int(kwargs['num']) * 3 
```

将 python 字符串相乘意味着您要重复它：

```
>>> 'Hello ' * 3
'Hello Hello Hello ' 
```

URL 正则表达式匹配数字，但这不会自动将结果值转换为整数。

# javascript - 将元数据添加到 JavaScript 对象

> ID：14429398
> 
> 赞同：2
> 
> 时间：2013-01-20T21:13:56.960
> 
> 标签：javascript, metadata, metaprogramming

是否可以将元数据添加到 JavaScript 对象（包括字符串、数字和函数）？那是，

```
double = function(a){ return a*2; };
addMetadata(double,{desc:"Returns the double of a number."});
getMetadata(double).desc; 
```

addMetadata 和 getMetadata 如何实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:25:03.290

对于对象，包括函数，实现get/setMetadata最好的方式就是根本不去实现。

```
double = function(a){ return a*2; };
double.desc = "Returns the double of a number."
alert(double.desc); 
```

对于“原始”字符串/数字，您可以使用另一个答案中建议的字典方法：

```
metaStorage = {}

setMetaData = function(obj, data) {
    if(typeof obj == "object")
        obj._metaData = data;
    else
        metaStorage[obj] = data;
}

getMetaData = function(obj) {
    if(typeof obj == "object")
        return obj._metaData;
    else
        return metaStorage[obj];
}

setMetaData(1, "this is one");
console.log(getMetaData(1))

setMetaData(window, "my window");
console.log(getMetaData(window)) 
```

但是，我无法想象将元数据附加到字符串/数字文字会有多大用处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:21:52.243

你可以这样做：

```
var metaDataStorer = {};
function addMetadata(object, meta) {
    metaDataStorer[object] = meta;
}
function getMetadata(object) {
    return metaDataStorer[object];
} 
```

# c# - 选择列等于数组中字符串值之一的行

> ID：14429399
> 
> 赞同：0
> 
> 时间：2013-01-20T21:14:11.757
> 
> 标签：c#, sql, equals, rows

我正在尝试将相关行放入数据表中，我只想要列值等于其他 sql 表中的值之一的行，这是我的代码：

```
try
{
     sc.Open();
     for (int i = 0; i < queryTokens.Length; i++)
     {
          cmd = new SqlCommand("INSERT INTO QueryIndex (Term) Values ('" + queryTokens[i] + "')", sc);
          cmd.ExecuteNonQuery();
     }
     cmd = new SqlCommand("SELECT * FROM TermsIndex Where Term EXIST (Select Term From QueryIndex)");
     SqlDataAdapter da = neuw SqlDataAdapter(cmd);
     da.Fill(tempTable);
     da.Dispose();
     sc.Close();
}
catch (Exception e)
{
     Console.WriteLine(e.ToString());
} 
```

我敢肯定插入的第一部分进展顺利，但在第二部分，我希望你们都明白我想要做什么，我知道我在这里有语法错误，所以请纠正我，我明白了异常消息：{"Value cannot be null.\r\nParameter name: dataTable"} Null exception..

这是我的 sql 创建表：

```
CREATE TABLE [dbo].[TermsIndex]
(
    [ID] VARCHAR(35) NOT NULL,
    [Term] VARCHAR(35)  NOT NULL,
    [Frequency] int NOT NULL,
    [Offset] VARCHAR(MAX) NOT NULL,
)

CREATE TABLE [dbo].[QueryIndex]
(
    [Term] VARCHAR(MAX) NOT NULL,
) 
```

那么为什么我得到那个空错误呢？无论如何我正在创建一个表只是为了能够将它的条目与第一个列中的列进行比较，我已经有了它的字符串数组，任何机会能够将该列值与更改的字符串数（令牌）进行比较并返回行结果是否等于 sql 命令中的这些字符串之一？或者任何更优雅的方式来获得想要的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:20:59.820

我假设你`DataTable tempTable;`的代码中有。你初始化它。

```
DataTable tempTable = new DataTable(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:16:04.733

有几种方法可以进行查询：

```
SELECT DISTINCT T.* FROM TermsIndex T
INNER JOIN QueryIndex Q ON T.Term = Q.Term;

SELECT T.* FROM TermsIndex T
WHERE T.Term IN (SELECT Q.Term FROM QueryIndex Q);

SELECT T.* FROM TermsIndex T
WHERE EXISTS(SELECT Q.Term FROM QueryIndex Q WHERE Q.Term = T.Term);

SELECT T.* FROM TermsIndex T
WHERE T.Term IN('term1', 'term2', 'term3'); 
```

**注意：**您发布的代码中没有`dataTable`。

# xml - 为 Windows Phone 应用程序添加字体

> ID：14429400
> 
> 赞同：0
> 
> 时间：2013-01-20T21:14:20.930
> 
> 标签：xml, windows-phone-7, fonts, truetype

我正在尝试将我的字体更改为自定义 tff 文件。我已按照[本教程](http://blog.markarteaga.com/CustomFontsInWindowsPhone7Application.aspx)进行操作，但它似乎不起作用。我遵循了它的确切步骤，什么也没有。感谢您的帮助:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T03:17:11.347

如果没有看到您正在使用的代码，很难说可能出了什么问题。看看Jeff Blankenburg 的[这个示例](http://www.jeffblankenburg.com/2010/10/24/31-days-of-windows-phone-day-24-embedding-fonts/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T11:32:54.687

正如 Den 所说，我使用 Jeff 的示例来包含自定义字体。

当我将字体添加到我的应用程序时，最初它不起作用。这是因为我假设文件名是字体名称。后来打开ttf文件，第一行是字体名，和文件名不一样。

只是一个线索。

# ruby-on-rails - 我应该在助手中这样做吗？还是这会变慢？

> ID：14429408
> 
> 赞同：0
> 
> 时间：2013-01-20T21:14:52.960
> 
> 标签：ruby-on-rails, ruby-on-rails-3

在这种情况下，哪种模式会更快？
显然，带有助手的 Pattern1 看起来更加复杂并且看起来很干净。
但是每次调用 user_link 方法时它都会发送 SQL。
在这里，它在加载一页时最多调用 100 次。

哪种方式对基准性能更好？

**模式1。有帮手**

application_helper

```
def user_link(username)
    link_to User.find_by_username(username).user_profile.nickname, show_user_path(username)
end 
```

看法

```
<% @topics.order("updated_at DESC").limit(100).each do |topic| %>
    <%= user_link(topic.comment_threads.order("id").last.user.username) if topic.comment_threads.present? %>
<% end %> 
```

**模式2。没有帮手。只看**

```
<% @topics.order("updated_at DESC").limit(100).each do |topic| %>
    <%= link_to(topic.comment_threads.order("id").last.user.nickname, show_user_path(topic.comment_threads.order("id").last.user.username) ) if topic.comment_threads.present? %>
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:19:54.073

尝试

```
# Topics model
#via scope
scope :get_topic_list, lambda do
  order("updated_at DESC").joins(:comment_threads => :user).limit(100)
end

#via method
def self.get_topic_list
  Topic.order("updated_at DESC").joins(:comment_threads => :user).limit(100)
end

# in your controller or move to model itself (recommened)
@topics = Topic.get_topic_list

# in you view
<% @topics.each do |topic| %>
    <%= link_to(topic.comment_threads.order("id").last.user.nickname, show_user_path(topic.comment_threads.order("id").last.user.username) ) if topic.comment_threads.present? %>
<% end %> 
```

# javascript - 在 Python 应用程序中使用 WebKitGtk+ 时，有没有办法从 JS 调用 Python 函数？

> ID：14429409
> 
> 赞同：1
> 
> 时间：2013-01-20T21:14:56.483
> 
> 标签：javascript, python, webkit, gtk

我来自 Windows 窗体世界，他们拥有这个`ObjectForScripting`属性，可以轻松地将 C# 对象公开给在 WebView 中运行的 JavaScript。我希望在 Python 中做类似的事情，而 WebKitGtk+ 似乎是 WebView 的自然选择。但是似乎没有一种简单的方法可以将 Python 对象绑定到 JS 中。有没有一种我想念的简单方法，或者 WebKitGtk+ 的替代方法可以更好地做到这一点？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T01:09:30.213

这是一种解决方法：使用自定义方案拦截 URL。

*   处理[resource-request-starting](http://webkitgtk.org/reference/webkitgtk/stable/WebKitWebFrame.html#WebKitWebFrame-resource-request-starting)信号并检查 URL 是否以`python:`
*   如果是这样，以某种方式解析 URL（`eval`？允许函数的字典？由你决定）并调用适当的函数。
*   将请求的 URL 替换为`data:text/plain,<result of function call>`。
*   在 JavaScript 中，向`python:my_function()`.

这是非常有限的，但就我而言，它适用于 Haskell 绑定。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-26T19:06:26.760

我最终选择了 PyQt，因为它强烈支持将原生对象暴露给 JS。这里有一些很好的例子：

[http://pysnippet.blogspot.com/2010/01/calling-python-from-javascript-in-pyqts.html](http://pysnippet.blogspot.com/2010/01/calling-python-from-javascript-in-pyqts.html) [http://pysnippet.blogspot.com/2010/01/more-fun-with-qwebkit.html](http://pysnippet.blogspot.com/2010/01/more-fun-with-qwebkit.html)

# scala - Scala 嵌套集合赋值

> ID：14429410
> 
> 赞同：1
> 
> 时间：2013-01-20T21:15:04.130
> 
> 标签：scala, collections

我正在尝试在Scala中构建一个从整数到一组可变整数的可变映射。

例如，我希望拥有 1 -> (2,3) 形式的映射，并且以后能够使用键值更新它们。我使用的代码如下：

```
import scala.collection.mutable._

val map = Map[Int, Set[Int]]()
map: scala.collection.mutable.Map[Int,scala.collection.mutable.Set[Int]] = Map()

map += (1 -> Set(2,3))
res15: map.type = Map(1 -> Set(2, 3)) 
```

到目前为止很好，但是当我尝试做类似的事情时

```
map.get(1) += 4 
```

我得到了 val 错误的分配。令我困惑的是 map.get() 应该返回一个可以更新的 scala.collection.mutable.Set 类型的 Set。有人可以解释一下这里发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:17:55.030

这种情况下的问题是`get()`返回一个选项 ( `Option[scala.collection.mutable.Set[Int]]`)，您需要“解包”它：

```
map.get(1).get += 4 
```

Map 的`get()`函数返回一个选项的原因是任何给定的键都可能没有值，并且 Scala 不喜欢像它的 Java API 对应物那样抛出异常。

或者，您可以使用该`apply()`方法，该方法直接返回请求的值并在失败时抛出异常：

```
map(1) += 4 
```

* * *

不过，我还没有完全弄清楚为什么您尝试过的代码会出现“重新分配给 val”错误。在我的情况下（Scala 2.10），它说明了以下内容：

```
<console>:12: error: value += is not a member of Option[scala.collection.mutable.Set[Int]]
          map.get(1) += 1 
```

您使用的是哪个版本的 Scala？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T15:46:58.600

更优雅的方式是

```
map.get(1).map(_ += 4).getOrElse{map += 1 -> Seq(4)} 
```

# jquery - 在 jQuery 中仅滚动/滚动一个元素

> ID：14429420
> 
> 赞同：0
> 
> 时间：2013-01-20T21:16:04.060
> 
> 标签：jquery, rollovers

我对 jQuery 任务有疑问：我试图在滚动链接时显示“«”符号。问题是：一次只能“翻转”一个链接，但所有链接都显示“«”。

这是代码：

```
$(".list td a").hover(
  function() { $(".laquo").show(); },
  function() { $(".laquo").hide(); }
); 
```

因此，据我了解，在滚动“.list td”中的“a”元素后，应该显示我的类“.laquo”。这工作得很好。但是我如何告诉 jQuery 一次只定位一个 'a' 呢？

我已经尝试过类似问题的解决方案：

```
function() { $(".laquo", this).show(); }, 
```

但它不起作用 - '«' 根本没有显示。我做错了什么？

用 HTML 编辑：

```
<div class="list">
    <table>
        <tr>
            <td class="left">1.</td>
            <td>
                <a href="index.html">Circles</a>
                <span class="laquo" style="display:none;">&nbsp;&laquo;</span>
            </td>
        </tr>
    </table>
</div> 
```

如您所见，“.laquo”不是“a”的子代。那我该如何选择呢？

Aaaand，我明白了：D。只需要删除'a'，所以我从'td'中选择。

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:19:13.687

当`.laquo`是 的子级时`a`，使用当前`a`作为上下文：

```
$(".laquo",this).show(); 
```

如果没有，我们需要查看相关元素的 HTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:19:47.173

假设`.laquo`元素是链接元素的子元素：

```
$(".list td a").hover(function(){
    $(this).find('.laquo').toggle();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T21:26:19.263

您的代码基本上是正确的，所以我假设您只是在没有向我们展示的代码中搞砸了一些东西。

**悬停代码示例**

```
$(".list td a").hover(function(){
  $(".laquo", this).show();   
}, function(){
  $(".laquo", this).hide();  
}); 
```

[链接到它工作的 JS Fiddle](http://jsfiddle.net/C6rqR/4/)

然而，理想情况下，这个任务根本不应该在 Javascript 中完成，因为使用 :hover 伪选择器在纯 CSS 中实现它很容易。

[在纯 CSS 中链接到 JSFiddle](http://jsfiddle.net/C6rqR/5/)

# ios - 在 ios 上使用带有参数的 Xcode 运行 shell 脚本

> ID：14429426
> 
> 赞同：1
> 
> 时间：2013-01-20T21:17:02.330
> 
> 标签：ios, objective-c, shell, jailbreak

我有一个 bash 脚本，我想从应用程序的参数开始。目前我可以生成命令，但我该如何执行呢？此应用程序仅适用于越狱手机。有什么解决方案吗？我搜索了很多，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:41:52.427

如果这是一个越狱应用程序，您可以通过将命令传递给`system()` [作为 OS 一部分的](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/system.3.html)函数或其中一个函数来运行该命令`exec`。

因此，如果您决定将脚本安装在`/Applications/MyApp.app/myscript.sh`，那么在您的应用程序中，您可以使用：

```
int result = system("/Applications/MyApp.app/myscript.sh argument1 argument2"); 
```

您可以按照我的说明将脚本安装在您的应用程序文件夹中，作为资源安装，或安装在`/usr/bin`、 或`/bin`或任何您喜欢的位置。

您没有提及您是否`/Applications`像大多数越狱应用程序那样将您的应用程序安装在 ，或者在正常`/var/mobile/Applications/*`位置。

如果上述代码不起作用，请说明**您**要安装应用程序的位置。此外，根据您的脚本是否需要`root`特权，可能还需要做更多的工作。[如果您想以 root 身份运行 shell 脚本，](https://stackoverflow.com/a/6503158/119114)则会出现一些复杂情况。

# java - 找不到符号 [编译器错误]

> ID：14429431
> 
> 赞同：2
> 
> 时间：2013-01-20T21:17:36.990
> 
> 标签：java, find, symbols

我已经完成了这个尝试构建三角形并计算作业表面的小程序，并在 Eclipse 中对其进行了测试，但是当我尝试将其上传到我们的系统时，我得到了 6 个错误，都是相同的类型：

> > > /test/src/math.test/TestTriangleFunctionPublic.java:4：错误：找不到符号导入math.NotATriangleException；^ 符号：类 NotATriangleException
> > > 
> > > /test/src/math.test/TestTriangleFunctionPublic.java:5：错误：找不到符号导入math.Triangle；^ 符号：类三角形位置：包数学
> > > 
> > > /test/src/math.test/TestTriangleFunctionPublic.java:45：错误：找不到符号实际= Triangle.calculateArea（a，b，c）；^ 符号：变量三角形位置：类 TestTriangleFunctionPublic
> > > 
> > > /test/src/math.test/TestTriangleFunctionPublic.java:46：错误：找不到符号} catch (NotATriangleException e1) { ^ 符号：类 NotATriangleException 位置：类 TestTriangleFunctionPublic
> > > 
> > > /test/src/math.test/TestTriangleFunctionPublic.java:56：错误：找不到实际符号 = Triangle.calculateArea(a, b, c); ^ 符号：变量三角形位置：类 TestTriangleFunctionPublic
> > > 
> > > /test/src/math.test/TestTriangleFunctionPublic.java:57：错误：找不到符号} catch (NotATriangleException e) { ^ 符号：类 NotATriangleException 位置：类 TestTriangleFunctionPublic

这是两个类：

```
package math;

public class Triangle {
    static double s;
    double surface = 0;
    static double a;
    static double b;
    static double c;

    public double calculateArea(double a, double b, double c) throws NotATriangleException{
        if (a<= 0.0 || b <= 0.0 || c <= 0.0){
            throw new NotATriangleException("Cannot construct Triangle!");
        }
        else if( (a+b)<=c && (a+c)<=b && (b+c)<=a){
            throw new NotATriangleException("Cannot construct Triangle!"); 
        } 

        else {
            s = ((a + b + c)/2);
            surface = Math.sqrt(s * (s - a) * (s - b) * (s - c));
            return surface;
        }

    }
    public double getErgebnis (){
        return surface;
    }
} 
```

和异常类：

```
package math;

@SuppressWarnings("serial")
public class NotATriangleException extends Exception {
    public NotATriangleException(String message) {
        super(message);
    }
    public NotATriangleException(String message,Throwable throwable) {
        super(message, throwable);
    }
} 
```

我很失望，因为我不知道出了什么问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:31:39.107

你有一个名为`TestTriangleFunctionPublic`. 我想你在 Eclipse 的同一个包中拥有这个类`math`，但是当你上传它时，你将位置更改为一个名为 math.test 的目录。

# python - Python - 队列 - 为什么我的元组被切碎了？

> ID：14429433
> 
> 赞同：0
> 
> 时间：2013-01-20T21:17:47.863
> 
> 标签：python, string, multithreading, queue, tuples

为什么当我将一个元组放入这样的队列时：

```
myqueue.put(('Thread Started')) 
```

我这样调用 .get() ：

```
item = myqueue.get()
print item 
```

它打印这个：

```
('T', 'h', 'r', 'e', 'a', 'd', ' ', 'S', 't', 'a', 'r', 't', 'e', 'd') 
```

这种行为的原因是什么？我怎样才能找回我原来的元组？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T21:18:56.603

元组用逗号构造：

```
>>> (1,)
(1,) 
```

然而，这只是“1”：

```
>>> (1)
1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-20T21:19:03.777

那不是元组，那是一对括号中的字符串。这是一个元组：

```
myqueue.put(('Thread Started', )) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T21:34:00.397

`myqueue`如果是`Queue.Queue`实例，则编写的代码不应产生输出。

您的代码相当于：

```
myqueue.put('Thread Started')
item = myqueue.get()
print item 
```

它应该只产生：`Thread Started`.

使用逗号创建元组：

```
t = 1,
# -> (1,)
t = 'a', 'b', 'c'
# -> ('a', 'b', 'c') 
```

或者您可以显式调用构造函数：

```
t = tuple("abc")
# -> ('a', 'b', 'c') 
```

例外是使用以下命令创建的空元组`()`：

```
t = ()
# -> ()
t = tuple()
# -> () 
```

# c - 使用两个指针查找列表是否在 C 中是非循环的 - 为什么与更快->下一个比较？

> ID：14429436
> 
> 赞同：1
> 
> 时间：2013-01-20T21:18:02.503
> 
> 标签：c, pointers, linked-list

我知道，给定一个链表，如果我们想找出它是否是非循环的，我们可以有两个指针以不同的速度在链表中运行。然后如果我们比较快和慢的值并且两者相同，我们知道列表是循环的。但是，我看到人们还将较慢的指针与下一个较快的指针进行比较。像这样的代码：

```
bool findCircular(Node *head)
{
   Node *slower, * faster;
   slower = head;
   faster = head;
   while(true) {

     // if the faster pointer encounters a NULL element
     if( !faster || !faster->next)
       return false;
    //if faster pointer ever equals slower or faster's next
    //pointer is ever equal to slow then it's a circular list
     else if (faster == slower || faster->next == slower)
        return true;
     else{
       // advance the pointers
        slower = slower->next;
        faster = faster->next->next;
      }
   }
} 
```

为什么这个条件是必要的：`faster->next == slower`?? 仅此还不够：`faster == slower`

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:30:56.097

这不是必需的。如果`faster->next == slower`成立，`faster == slower`将在下一次迭代中成立。

但是，您发布的代码仍然不正确，因为在第一次迭代中两个指针总是相等的。正确的代码是：

```
bool findCircular(Node *head)
{
   Node *slower = head;
   Node *faster = head;
   while(true) {
     // if the faster pointer encounters a NULL element
     if( !faster || !faster->next)
         return false;
     slower = slower->next;
     faster = faster->next->next;

     //if both pointers are ever equal, it's a circular list
     if (faster == slower)
         return true;
   }
} 
```

# r - 在 Emacs ESS 中使用 download.file 时显示进度消息或进度条

> ID：14429437
> 
> 赞同：2
> 
> 时间：2013-01-20T21:18:03.533
> 
> 标签：r, emacs, dialog, ess

标题应该说明一切。R`download.file()`在 Emacs ESS 中不显示进度状态。

任何解决方法？

## 更新

根据要求举个例子：

```
download.file("http://path/to/file.zip", "myfile.zip", mode='wb', quiet=FALSE) 
```

`quiet=FALSE`是默认的

# java - 带标志的while循环

> ID：14429439
> 
> 赞同：1
> 
> 时间：2013-01-20T21:18:22.677
> 
> 标签：java, multithreading, loops, while-loop

```
public class Simulation extends Thread {
    private volatile boolean loopState = true;

    public void stopLoop() {
        loopState = false;
    }

    public void run() {     
        try {
            Robot r = new Robot();

            while (loopState) {
                r.keyPress(KeyEvent.VK_LEFT);
                r.keyRelease(KeyEvent.VK_LEFT);
                sleep(50);
            }
        } catch (AWTException | InterruptedException e) {}
    }
} 
```

当我启动下面`stopLoop()`的`while`循环时不会停止。`loopState`如果我在调用结束时打印它的值，`stopLoop()`它会返回`false`，但循环仍在执行。

我使用此代码来调用方法。

```
Simulation simulation = new Simulation();
    switch (PressedButtonID) {
        case 14:
            simulation.start();
            break;
        case 15:
            simulation.stopLoop();
            break;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:05:36.720

您发布的代码完美运行，如以下简单程序所示：如您所见，while 循环按预期停止。问题出在其他地方。

```
import java.awt.*;
import java.awt.event.KeyEvent;

public class Simulation extends Thread {
    private volatile boolean loopState = true;

    public void stopLoop() {
        loopState = false;
    }

    public void run() {
        try {
            Robot r = new Robot();

            while (loopState) {
                r.keyPress(KeyEvent.VK_LEFT);
                r.keyRelease(KeyEvent.VK_LEFT);
                System.out.println("Simulation loop: CALLED");
                sleep(50);
            }
        } catch (AWTException | InterruptedException e) {}
    }

    public static void main(String[] args) throws InterruptedException {
        Simulation simulation = new Simulation();
        simulation.start();
        Thread.sleep(1000);
        simulation.stopLoop();
    }
} 
```

# c# - 如何在 C# TextBox 中允许诸如 Ctrl-A 和 Ctrl-Backspace 之类的东西

> ID：14429445
> 
> 赞同：9
> 
> 时间：2013-01-20T21:19:06.087
> 
> 标签：c#, user-interface

我有一个多行的 System.Windows.Forms.TextBox，但它不接受像 Control-A 和 Control-Backspace 这样的命令。

Control-A 什么都不做，Control-Backspace 插入一个方框字符。

“启用快捷方式”属性设置为 true。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-20T21:26:10.267

从 MSDN 上的**[ShortcutsEnabled](http://msdn.microsoft.com/en-us/library/system.windows.forms.textboxbase.shortcutsenabled.aspx)**属性：

> 当 Multiline 属性值为 true 时，TextBox 控件不支持 CTRL+A 快捷键。

你必须自己实现它。

像这样的东西应该工作：

```
 private void textBox1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.Control & e.KeyCode == Keys.A)
        {
            textBox1.SelectAll();
        }
        else if (e.Control & e.KeyCode == Keys.Back)
        {
            SendKeys.SendWait("^+{LEFT}{BACKSPACE}");
        }
    } 
```

# django - 我可以通过两个相关模型上的中间模型声明多对多，以便我可以利用自动 ModelForm 吗？

> ID：14429457
> 
> 赞同：3
> 
> 时间：2013-01-20T21:20:15.570
> 
> 标签：django, many-to-many

这是我的代码：

```
class Resource(models.Model):
    [...]

class Theme(models.Model):
    [...]
    resource_set = models.ManyToManyField(Resource, through='Match', related_name='theme_set', blank=True)

class Match(models.Model):
    resource = models.ForeignKey(Resource)
    theme = models.ForeignKey(Theme)
    [...] 
```

我有意使用中间模型，因为我想为关系添加一些属性。现在...我知道在 Theme 中声明多对多关系时，我也从 Resource 获得了反向关系。看到我正在使用的related_name 了吗？这样，我在两个模型中都有“对称”字段名称（两个模型中的resource_set、theme_set 和 match_set）。

我的问题是，当我从两个模型（资源和主题）生成表单时，它们不是对称的。当我生成主题表单时，我会自动获得一个多项选择字段以从现有资源中进行选择。但是当我生成资源表单时，我不会。

**所以这就是为什么我想在两个模型中声明多对多关系 - 使它们真正相等（不像在 Pizzas 和 Toppings 示例中；）并生成这些额外的多项选择字段。问题是 - 是否有可能，还是我必须自己将多项选择字段添加到 ResourceForm 或使用我还不理解的 FormSets？**

顺便说一句 - 因为我无法使用 save() 从 ThemeForm 保存新主题（“无法在指定中间模型的 ManyToManyField 上设置值。”）我这样做：

```
[...]
theme = form.save(commit=False)
theme.save()
for resource in form.cleaned_data['resource_set']:
    match = Match()
    match.resource = resource
    match.theme = theme
    match.save()
return redirect([...] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T09:36:35.060

您可以简单地在两侧定义它。

一个问题是related_name - 据我所知，没有办法告诉ORM“我会自己处理反向关系”。因此，您需要更改相关名称，以免它们与真实字段名称发生冲突。在此示例中，我在related_names 中添加了下划线，因此资源对象现在同时具有theme_set 和_theme_set，它们是相同数据的两个句柄。

```
class Resource(models.Model):
    [...]
    theme_set = models.ManyToManyField('Theme',
        through='Match', 
        related_name='_resource_set', 
        blank=True)

class Theme(models.Model):
    [...]
    resource_set = models.ManyToManyField(Resource,
        through='Match',
        related_name='_theme_set',
        blank=True) 
```

此外，如果您使用 South，您可能需要将[_ignored_fields 添加](http://south.readthedocs.org/en/latest/customfields.html#field-name-patterns)到字段之一。

# windows - 嵌套三 (3) 个 for 循环和 EnableDelayedExpansion

> ID：14429459
> 
> 赞同：0
> 
> 时间：2013-01-20T21:20:20.850
> 
> 标签：windows, batch-file, dos

在尝试将第三个 for 循环和它的支持代码集成到现有代码中时，我已经达到了我理解的极限。我完全不知道如何在这个复杂的“EnableDelayedExpansion”环境中引用各种变量。

此外，应该在每个 For 循环中打开/关闭“EnableDelayedExpansion”/endlocal，还是在程序开始和结束时打开/关闭一次。

```
:: ------------------ Beg For #1
      For /L %%a in (%XBEG%,1,%XEND%) do (
      cls
      echo :    %%a
      set L=1
:: ------------------ Beg For #2
      For /F "delims=" %%b in (%XDRV%%XPATH%%%a\1dir%%a.txt) do (
        set XTITLE=%%b
        echo Line !L!: !XTITLE!
        If not {!XTITLE!}=={!XTITLE:%XDRV%%XPATH%%%a\!} set XTITLE=!XTITLE:~18,-4!
        ::
:: ------------------ Beg For #3 --- New code
::   Write title to the xtemp file.  Place the redirection
:: symbol, i.e., greater than sign, IMMEDIATELY after vari
:: to avoid a trailing space, i.e., ( %vari%> )
      echo !XTITLE!> %XDRV%%XPATH%xtemp.txt
::   Get the file size in bytes, each byte = one character
      For %%c in (%XDRV%%XPATH%xtemp.txt) do set /a XLEN=%%~zc
::   Subtract 2 bytes, 1 for CR, 1 for LF, from Length
      set /a XLEN -=2

      cls
      echo : ===[  Debug  ]======================================
      echo - !XTITLE! - has !XLEN! characters.
      set /a XPAD=50-!XLEN!
      echo - Xpad is !XPAD!

::    Build the Index entry
      set XENTRY=%XPADs%%XTITLE%%XPAD%%%a
      echo - %XENTRY%
      pause

:: remove the xtemp file
      del %XDRV%%XPATH%xtemp.txt
        set /a L=!L!+1
        pause
:: ------------------ end of New code
      ):: End For #2
    )
:: End For #1
::        Clean Up For3
      set XTITLE=
      set L=
     Goto DOS 
```

“EnableDelayedExpansion”/endlocal 当前放置在程序的开头和结尾。

我希望这种情况对社区有足够的兴趣，因为迫切需要您的帮助并且非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T03:38:52.270

你永远不会准确地说明你的问题是什么。你正在用文件路径做一些奇怪的事情，但我不知道你在做什么是否有意义。

我确实看到了一些明确的错误：

1)`If not {!XTITLE!}=={!XTITLE:%XDRV%%XPATH%%%a\!} ...` 看起来您正在尝试搜索和替换以测试变量是否包含路径字符串。但是你忘记了你的`=`. 此外，在 IF 测试中进行延迟扩展的搜索和替换或子字符串操作时，您应该使用引号。

更正：

```
if not "!XTITLE!"=="!XTITLE:%XDRV%%XPATH%%%a\=!" ... 
```

2) 此现有代码中需要额外的延迟扩展。此外，您还有一个多余的`s`. 我还喜欢使用引号来确保作业末尾没有隐藏空格。

```
set XENTRY=%XPADs%%XTITLE%%XPAD%%%a
echo - %XENTRY% 
```

更正：

```
set "XENTRY=!XPAD!!XTITLE!!XPAD!%%a"
echo - !XENTRY! 
```

一般来说，我认为您的代码可以在分配期间使用更多引号。

可能还有其他问题，但这是我在没有实际测试代码并且不知道它应该做什么的情况下看到的。

* * *

有一些可能的优化

1）无需每次迭代都删除临时文件。您只需要在外部循环之外的末尾删除它。

2）您可以消除第 2 个 SET /A 并在第 3 个循环中减去 2。

```
For %%c in (%XDRV%%XPATH%xtemp.txt) do set /a XLEN=%%~zc - 2 
```

3）最后不需要清除每个变量。只需在开头的 SETLOCAL 和结尾的 ENDLOCAL。

* * *

关于何时启用延迟扩展：很可能您可以在开始时简单地启用延迟扩展。但是，如果您的任何标题值包含，这将导致问题，因为如果启用延迟扩展，则`!`该值将在扩展时损坏。`%%b`

如果标题可能包含`!`，那么您必须在第二个循环中打开和关闭延迟扩展。但是你必须保留`L`ENDLOCAL 之后的值。您可以执行以下操作：

```
For /F "delims=" %%b in (%XDRV%%XPATH%%%a\1dir%%a.txt) do (
  set XTITLE=%%b
  setlocal enableDelayedExpansion
  :: ... do your work with delayed expansion
  :: Use a FOR loop to transport the value of L past ENDLOCAL
  for %%N in (!L!) do (
    endlocal
    set "L=%%N"
  )
):: End For #2 
```

# ruby - 使用带有匿名 TestCase 的测试/单元

> ID：14429467
> 
> 赞同：3
> 
> 时间：2013-01-20T21:21:13.843
> 
> 标签：ruby, unit-testing, anonymous, anonymous-class

## 本题属于zu test-unit 2.5.3版

# 测试单元版本 2.5.4 解决了问题

我有许多匿名测试用例的测试。它适用于测试单元 2.5.0，但实际版本 2.5.3 会产生错误。

当我运行这个测试时：

```
gem 'test-unit', ">=2.5.2"
require 'test/unit'
Class.new( Test::Unit::TestCase ) do
  def test_add
    assert_equal( 2, 1+1)
  end
end 
```

没有执行任何测试，并且出现错误`undefined method sub' for nil:NilClass (NoMethodError)`（`testrunner.rb:361`我使用实际的 test-unit-gem 2.5.3）。

使用 TestCase 的名称，问题就消失了：

```
gem 'test-unit'
require 'test/unit'
X = Class.new( Test::Unit::TestCase ) do
  def test_add
    assert_equal( 2, 1+1)
  end
end 
```

在我真正的问题中，我生成了许多测试用例。所以我有这样的情况：

```
gem 'test-unit'
require 'test/unit'
2.times {
  X = Class.new( Test::Unit::TestCase ) do
    def test_add
      assert_equal( 2, 1+1)
    end
  end
} 
```

如果我执行此操作，我会收到警告`already initialized constant X`和错误：（ `comparison of Array with Array failed (ArgumentError)`在 collector.rb:48:in sort_by' 中）。

我的问题：

*   我怎样才能避免错误？
*   或者：如何创建具有动态分配常量的测试用例？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T22:31:32.243

这似乎是由于最新版本的`test-unit`gem 发生了变化，它现在需要一个类的可读名称。

像这样的东西会起作用

```
gem 'test-unit', ">=2.5.2"
require 'test/unit'

Class.new( Test::Unit::TestCase ) do
  def test_add
    assert_equal( 2, 1+1)
  end

  def self.to_s
    "GeneratedClass"
  end

  def self.name
    to_s
  end
end 
```

# matlab - 如何使用 Matlab 按字母顺序对属性值对进行排序

> ID：14429468
> 
> 赞同：2
> 
> 时间：2013-01-20T21:21:22.340
> 
> 标签：matlab

我想向现有文件添加一个属性值对。同时，所有属性都应按字母顺序排列。例如 ：

```
[Info] % property 1
value 1 
[system] % property 2
value 2 
```

我如何添加其他属性，以便所有属性都按字母顺序排序。我能够使用将属性-值对添加到文件末尾， `fh = fopen(filename,'a')`但我无法按字母顺序对它们进行排序。

到目前为止，我按如下方式尝试了此操作，但使用此操作时，它只会打印新的属性-值对。我想在打印新属性后打印剩余属性。

```
function [] = myfun(filename ,propName,propvalue)
rfh = fopen(filename,'r');
tname = tempname();
wfh = fopen(tname,'w');
line = fgetl(rfh);

while ischar(line)

    if (line(1) == '[') && (line(end) == ']')
        property = lower(line(2:end-1)) % from ini file
        String2 = property;
        String1 = propName;
        [sat] = sor(String1,String2)% subfunction
        if sat == -1
            fprintf(wfh,'[%s]\r\n%s\r\n',propName,propvalue);
        else
            fprintf(wfh,'%s\r\n',line);
        end
    else
        fprintf(wfh,'%s\r\n',line);
    end
    line = fgetl(rfh);
end
fclose(rfh);
fclose(wfh);
movefile(tname,filename,'f')

function [sat] = sor(String1,String2)
Index = 1;

while Index < length(String1) && Index < length(String2) && String1(Index) == String2(Index)
    Index = Index + 1;
end

% Return the appropriate code
if String1(Index) < String2(Index)
    sat= -1
elseif String1(Index) > String2(Index)
    sat= +1
else % the characters at this position are equal -- the shorter of the two strings should be "less than"
    if length(String1) == length(String2)
        sat = 0
    elseif length(String1) <  length(String2)
        sat = -1
    else
        sat = +1
    end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:36:56.607

这是一个`.ini`文件吗？您可能想查看 MATLAB File Exchange 中的[INIConfig](http://www.mathworks.com/matlabcentral/fileexchange/24992-ini-config)，这是一组用于处理 INI 文件的例程，这些例程排列在一个方便的类中。我没有使用它，但也许它可以满足您的需求。

如果没有，您可以随时：

1.  读入文件
2.  逐行循环
3.  当您发现一行以 开头，`[`后跟按字母顺序排列的单词晚于您要插入的属性时，请插入您的属性和值
4.  包括文件的其余部分
5.  再次将整个文件写回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T06:59:57.107

如何将文件读入`struct`?

```
function fileData = readFileIntoStruct( fileName )
%
% read [property] value pairs file into struct
% 
fh = fopen( fileName, 'r' ); % read handle
line = fgetl( fh );
while ischar( line )
    % property
    tkn = regexp( line, '\[([^\]+)]\]', 'once', 'tokens' );
    % read next line for value
    val = fgetl( fh );
    fileDate.(tkn{1}) = val;
    line = fgetl( fh ); % keep reading
end
fclose( fh ); % don't forget to close the file at the end. 
```

现在，您将所有数据作为 a`struct`属性，`fieldnames`并将值作为`field`值。

现在您可以简单地通过以下方式更新属性：

```
function fileData = updateProperty( fileData, propName, newVal )
if isfield( fileData, propName )
    fileData.(propName) = newVal;
else
    warning( 'property %s does not exist - please add it first', propName );
end 
```

您可以添加一个属性：

```
function fileData = addProperty( fileData, propName, newVal )
if ~isfield( fileData, propName )
    fileData.(propName) = newVal;
else
    warning ( 'property %s already exists, use update to change its value', propName );
end 
```

您可以使用按字母顺序对属性进行排序[`orderfields`](http://www.mathworks.com/help/matlab/ref/orderfields.html)：

```
fileData = orderfields( fileData ); 
```

您可以`struct`使用以下方法将回写回文件：

```
function writeDataToFile( newFileName, fileData )
fopen( newFileName , 'w' ); %write handle
propNames = fieldnames( fileData );
for ii = 1:numel( propNames )
    fprintf( fh, '[%s]\r\n%s\r\n', propNames{ii}, fileData.(propNames{ii}) );
end
fclose( fh ); 
```

**假设：**

1.  属性的名称是合法的 Matlab 字段名称（有关详细信息，请参阅变量命名）。

2.  每个属性的值始终是一个字符串。

3.  我没有在这些示例中包含任何错误检查代码（未找到文件、格式​​错误的字符串等）

4.  我假设输入文件是严格的“[prop] val”对，没有任何额外的注释等。

# ruby-on-rails - gsub 并点击我不想在 rails helper 中使用的正则表达式

> ID：14429471
> 
> 赞同：0
> 
> 时间：2013-01-20T21:21:35.757
> 
> 标签：ruby-on-rails, ruby, regex, ruby-on-rails-3.1

这是一个非常简单的问题，但很少使用正则表达式，所以我很抱歉。我正在为一些简单的 UBBcodes 编写一个简单的视图助手

我希望能够打电话：

```
<%=arc_format "[quote]hello  you from me[\quote]" %> 
```

并让它返回：

```
<div class='start-quote'>
  hello you from me
</div> 
```

我的帮手：

```
def arc_format str
 str=str.gsub(/\[quote\]/,'<div class="start-quote">') # works but adds in second quote; seems to hit off second isntance
 str=str.gsub!(/\[\\quote\]/,'</div>')
 str.html_safe
end 
```

输出是

```
<div class='start-quote'>
 hello you from me
<div class='start-quote'>
</div> 
```

如何从不替换中获得第二个正则表达式？

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:31:43.017

反斜杠没有被结转。尝试：

```
> string = "[quote]hello  you from me[\quote]"

> puts string
[quote]hello  you from me[quote] 
```

应该：

```
> string = "[quote]hello  you from me[\\quote]"

> puts string
[quote]hello  you from me[\quote] 
```

它应该是`[\quote]`吗？我会认为`[/quote]`更有意义。

# xcode - 为什么在我安装 Mountain Lion 时 OpenGL 会降级？

> ID：14429473
> 
> 赞同：1
> 
> 时间：2013-01-20T21:21:43.773
> 
> 标签：xcode, opengl, osx-mountain-lion

**编辑：**已解决。这是一个 GLFW 问题，与 Mountain Lion 或 OpenGL 无关。

我之前在我的 2009 Macbook Pro 上使用过 Lion。在 XCode 中，以下工作没有问题：

```
 glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);       
 glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
 glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);
 glfwOpenWindowHint(GLFW_WINDOW_NO_RESIZE, GL_TRUE);
 glfwOpenWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);

 ALLEGE(glfwOpenWindow(SCREEN_SIZE.x, SCREEN_SIZE.y, 8, 8, 8, 8, 0, 0, GLFW_WINDOW) != GL_FALSE);    // msg = "glfwOpenWindow failed. Can your hardware handle OpenGL 3.2?"

 int major, minor, rev;
 glfwGetGLVersion(&major, &minor, &rev);
 fprintf(stderr, "OpenGL version recieved: %d.%d.%d\n", major, minor, rev); 
```

然后打印出来`OpenGL version received: 3.2`。在我升级到 Mountain Lion 之后，上面的代码将无法工作（挂断在ALLEGE，因为glfwOpenWindow 返回false）。去除所有 GLFW 窗口提示，例如：

```
 ALLEGE(glfwOpenWindow(SCREEN_SIZE.x, SCREEN_SIZE.y, 8, 8, 8, 8, 0, 0, GLFW_WINDOW) != GL_FALSE);    // msg = "glfwOpenWindow failed. Can your hardware handle OpenGL 3.2?"

 int major, minor, rev;
 glfwGetGLVersion(&major, &minor, &rev);
 fprintf(stderr, "OpenGL version recieved: %d.%d.%d\n", major, minor, rev); 
```

允许操作系统选择使用哪个版本的 OpenGL。上面的代码编译并运行，但打印`OpenGL version received: 2.1`到控制台。

我说：“wft？” 并查看系统信息应用程序以获取更多信息。框架部分告诉我，我拥有的 OpenGL 框架是 1.8.6。

现在，如果我的 OpenGL 框架确实被降级了，我会感到各种困惑和不安。我知道没有办法手动升级我的框架。**谁能帮我理解发生了什么？**

**Edit1**：使用 OpenGL 扩展 Viewer.app 通知我我的 OpenGL 版本是`2.1 NVIDIA-8.0.61`

**Edit2：**问题似乎与我的项目没有使用正确的配置文件（兼容性而不是核心）有关，但是当我使用 glfw 的提示来指定核心时，例如

```
 glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); 
```

随后的调用`glfwOpenWindow()`失败。我不知道如何诊断这个问题，因为 glGetError 直到窗口成功打开后才会起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T23:54:39.487

从源代码重新编译 GLFW 并将其与静态链接一起使用只能解决我的问题。一些内部错误导致`glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);`无法正常工作。

# sql - 分配结果时“.. AS @variable”附近的语法错误？

> ID：14429477
> 
> 赞同：1
> 
> 时间：2013-01-20T21:21:58.767
> 
> 标签：sql, sql-server, tsql

为什么我从以下代码中收到错误“关键字 'AS' 附近的语法不正确”？

```
DECLARE @FirstHole INTEGER

SELECT MIN(HoleId) FROM dbo.Holes WHERE CourseId = (
SELECT MAX(dbo.Holes.CourseId) FROM dbo.Registration 
LEFT JOIN dbo.Competitions ON dbo.Registration.CompetitionId = dbo.Competitions.CompetitionId 
LEFT JOIN dbo.Holes ON dbo.Competitions.CourseId = dbo.Holes.CourseId WHERE RegistrationId = 102
) AND dbo.Holes.MarkerId = 2 AS @FirstHole 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:24:12.223

That is not how you assign to a variable in TSQL.

I presume your intention is to do this

```
DECLARE @FirstHole INTEGER

SELECT  @FirstHole = MIN(HoleId) /* <-- Assignment here*/
FROM   dbo.Holes
WHERE  CourseId = (SELECT MAX(dbo.Holes.CourseId)
                   FROM   dbo.Registration
                          LEFT JOIN dbo.Competitions
                            ON dbo.Registration.CompetitionId = dbo.Competitions.CompetitionId
                          LEFT JOIN dbo.Holes
                            ON dbo.Competitions.CourseId = dbo.Holes.CourseId
                   WHERE  RegistrationId = 102)
       AND dbo.Holes.MarkerId = 2 
```

# ruby-on-rails - ajax 请求到公共文件夹？

> ID：14429478
> 
> 赞同：0
> 
> 时间：2013-01-20T21:22:00.073
> 
> 标签：ruby-on-rails

我有一个 JavaScript 文件向包含 json 数据的文件发出 ajax 请求。json 数据文件位于 Rails 的公共文件夹中，但是，ajax 请求返回 404 not found 错误。

```
GET http://localhost:3000/public/data/album1.json 404 (Not Found) 
```

任何人都可以建议为 ajax 请求设置什么 url，或者如果不在公共文件夹中，将 json 文件放在哪里？请注意，除了下面代码中显示的 url，我也尝试过`url: 'data/album1.json'`，但它给了我相同的结果。

```
if (this._index === null){
            $.ajax({
                url: 'public/data/album1.json',
                dataType: 'json',
                data: {}, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:25:25.590

Try not including the `public` in the url, but including the slash:

`/data/album1.json`

# batch-file - 用于登录 FTP 服务器并以特定格式重命名文件的批处理脚本

> ID：14429479
> 
> 赞同：1
> 
> 时间：2013-01-20T21:22:02.860
> 
> 标签：batch-file, ftp, rename

这是我的场景：

我在 FTP 服务器上有需要自动重命名的文件。我创建了一个脚本来重命名文件名，如下所示，这在我的计算机上运行良好：

```
 @echo off
setlocal
for /f "tokens=2-7 delims=_.-" %%A in ('dir /B TACOS_*') do (
  setlocal enabledelayedexpansion
  call :getmonth %%B
  ren TACOS*_*%%A-%%B-%%C*_*%%D-%%E-%%F_UTC.csv TACOS_%%A!mon!%%C_%%D%%E%%F.csv
  endlocal
)

:getmonth
if "%1" equ "Jan" set mon=01
if "%1" equ "Feb" set mon=02
if "%1" equ "Mar" set mon=03
if "%1" equ "Apr" set mon=04
if "%1" equ "May" set mon=05
if "%1" equ "Jun" set mon=06
if "%1" equ "Jul" set mon=07
if "%1" equ "Aug" set mon=08
if "%1" equ "Sep" set mon=09
if "%1" equ "Oct" set mon=10
if "%1" equ "Nov" set mon=11
if "%1" equ "Dec" set mon=12
goto :eof
endlocal 
```

现在我想通过登录服务器在 ftp 上运行这个功能。为此，我使用以下脚本：

```
FTP -s:ftpscript.txt 
```

文本文件是

```
open 192.168.1.5
ftp-user
ftpuser
cd reports/Don 
```

这些文件基本上在 Don 目录下，需要使用上面的脚本重命名。

问题：

1.  我们需要两个脚本来处理这个吗？

2.  如何通过登录 ftp 服务器来完成重命名

非常感谢帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T23:26:23.543

只需一个文件即可实现：

```
!cls&echo off&setlocal ENABLEDELAYEDEXPANSION
!cls&goto :ftp_border
open 192.168.1.5
ftp-user
ftpuser
cd reports/Don
lcd c:\direcotry_where_the_script_is
mget *.csv
bye

:ftp_border
@echo off
endlocal

ftp -s:%0

setlocal
for /f "tokens=2-7 delims=_.-" %%A in ('dir /B TACOS_*') do (
  setlocal enabledelayedexpansion
  call :getmonth %%B
  ren TACOS*_*%%A-%%B-%%C*_*%%D-%%E-%%F_UTC.csv TACOS_%%A!mon!%%C_%%D%%E%%F.csv
  endlocal
)

:getmonth
if "%1" equ "Jan" set mon=01
if "%1" equ "Feb" set mon=02
if "%1" equ "Mar" set mon=03
if "%1" equ "Apr" set mon=04
if "%1" equ "May" set mon=05
if "%1" equ "Jun" set mon=06
if "%1" equ "Jul" set mon=07
if "%1" equ "Aug" set mon=08
if "%1" equ "Sep" set mon=09
if "%1" equ "Oct" set mon=10
if "%1" equ "Nov" set mon=11
if "%1" equ "Dec" set mon=12
goto :eof
endlocal 
```

你能试试这个吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T03:20:45.590

打扰一下。这不是对您的 FTP 问题的回答，而是对您的批处理文件的讨论；我看到了一些细节：

根据您的 FOR 命令（“delims=_.-”）和 REN 命令中的名称，我假设您的文件格式是这样的：

```
TACOS_YYYY-Mon-DD_HH-MM-SS_UTC.csv 
```

其中“Mon”是一个由三个字母组成的月份名称，并且您要重命名为这种格式：

```
TACOS_YYYYMMDD_HHMMSS.csv 
```

如果这是真的，那么您的 REN 命令可能会导致错误，因为星号表示*多个*名称！如果要在 TACOS 之后、YYYY 之前、DD 之后和 HH 之前消除字符，那么这不是这样做的方法。也许您计算机中的文件名不会引起问题。尝试在其他地方创建两个或多个具有相同日期和时间以及不同字符的文件；在这种情况下，REN 命令尝试用一个新名称重命名两个或多个文件（除非您知道这不可能发生）。

你的 SETLOCAL/ENDLOCAL 对是没用的。如果要避免可能带有感叹号的名称出现问题，则必须在扩展 %%A..%%F 时禁用延迟扩展。如果你的名字可能有感叹号，那么你的程序必须被修改。

我可以建议您另一种将三个字母的月份转换为两位数的方法吗？该方法在*数组*元素中使用三个字母作为下标、两位数字作为值的数组，因此转换是立即的。

```
@echo off
setlocal EnableDelayedExpansion
rem Create the array for months conversion
set m=100
for %%A in (Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec) do (
  set /A m+=1
  set mon[%%A]=!m:~-2!
)
for /f "tokens=2-7 delims=_.-" %%A in ('dir /B TACOS_*') do (
  ren TACOS*_*%%A-%%B-%%C*_*%%D-%%E-%%F_UTC.csv TACOS_%%A!mon[%%B]!%%C_%%D%%E%%F.csv
) 
```

如果您想消除 REN 命令中放置星号的地方的几个字符，那么请告诉我们如何隔离这些字符。例如，如果一个名称以：

```
TACOSxyz_abcYYYY-Mon-DD... 
```

那么您必须意识到 FOR 命令中的 %%A 是“abcYYYY”，而不仅仅是“YYYY”！

编辑：下面有一个可能的解决方案：

```
@echo off
setlocal EnableDelayedExpansion
rem Create the array for months conversion
set m=100
for %%A in (Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec) do (
  set /A m+=1
  set mon[%%A]=!m:~-2!
)
for /f "tokens=2-7 delims=_.-" %%A in ('dir /B TACOS_*') do (
  set YYYY=%%A
  set DD=%%C
  set HH=%%D
  set SS=%%F
  ren TACOS*_*%%A-%%B-%%C*_*%%D-%%E-%%F_UTC.csv TACOS_!YYYY:~-4!!mon[%%B]!!DD:~0,2!_!HH:~-2!%%E!SS:~0,2!.csv
) 
```

# php - 在 Code Igniter 项目中访问多个应用程序

> ID：14429481
> 
> 赞同：1
> 
> 时间：2013-01-20T21:22:12.117
> 
> 标签：php, codeigniter, project

我在一个 Code Igniter 项目中有两个应用程序。

```
application
  --PW1
  --PW2 
```

这是目录结构。我更改了 index.php 中的 application_folder

```
$application_folder = 'application/PW2'; 
```

这工作正常。我按照[这个例子](https://stackoverflow.com/questions/11135711/codeigniter-multiple-applications-htaccess)。

我想做的是从第一个应用程序访问第二个应用程序。我怎样才能做到这一点。首先我尝试了简单的解决方案：

```
<a href="<?php echo base_url(); ?>application/PW1"> 
```

但是以这种方式禁止访问。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:34:54.820

看看[文档](http://ellislab.com/codeigniter/user-guide/general/managing_apps.html)。它指出

> 注意：您的每个应用程序都需要自己的 index.php 文件来调用所需的应用程序。index.php 文件可以任意命名。

所以根据您创建的文件夹结构，它应该看起来像这样

```
system
application
----PW1
----index.php (with $application_folder = 'application/PW1';)
----PW2
----index.php (with $application_folder = 'application/PW2';) 
```

# jquery - 评论系统设计的 JavaScript 问题

> ID：14429483
> 
> 赞同：1
> 
> 时间：2013-01-20T21:22:26.920
> 
> 标签：jquery, html

我正在构建一个评论系统，您只需在其中开始输入，然后 div 就会淡入以用文本区域和提交框填充您的屏幕。

但是，我遇到了一些问题，希望社区可以帮助我解决。

1.  这是我的 fadeIn 事件代码。由于某种原因，它不接受 AZ 之间的所有密钥，而是接受任何密钥。我怀疑这 (65<=e.keyCode<=90) 不是正确的格式，但我不知道如何格式化。

    ```
    $( document ).on( 'keydown', function ( e ) {
        if ( 65<=e.keyCode<=90) {
            $( elem ).fadeIn();
        }
    }); 
    ```

2.  此外，当 div 打开时，我希望他们按下打开 div 的键张贴在文本区域中。这样你就可以开始打字，一切都会如你所愿。我认为最好的方法是存储按键并更新 textarea 的 value 属性。之后，textarea 必须变为活动状态，这样他们就不必单击它来键入其余部分。

对于这两个问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:23:51.653

代替

```
if ( 65<=e.keyCode<=90) { 
```

和

```
if ( 65<=e.keyCode && e.keyCode<=90) { 
```

你在计算

```
if ( (65<=e.keyCode) <=90) { 
```

`true`为了进行比较，它总是`false`被转换为`0`和转换`true`为`1`（并且都小于 90）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:03:51.820

对于你问题的第二部分。

假设**text1**是您的 id`textarea`

```
 $("test1").val(String.fromCharCode(e.keyCode)); 
```

会将您按下的键的字符串字符存储到`textarea`

祝你好运

# java - 油藏采样算法

> ID：14429490
> 
> 赞同：1
> 
> 时间：2013-01-20T21:23:02.810
> 
> 标签：java, algorithm, random, reservoir-sampling

我想了解水库采样算法，我们从给定的 S 元素集合中选择 k 个元素，使得 k <= S。

在 wiki 上给出的算法中：

```
array R[k];    // result
integer i, j;

 // fill the reservoir array

for each i in 1 to k do
    R[i] := S[i]
done;

// replace elements with gradually decreasing probability

for each i in k+1 to length(S) do
    j := random(1, i);   // important: inclusive range
    if j <= k then
        R[j] := S[i]
    fi
done 
```

如果我理解正确的话，我们首先从集合中选择 k 个元素，然后不断解析 S 的 i 个元素，生成 1 到 i 范围内的随机 no j 并将元素 j 替换为 S[i]。

如果要采样的集合 K 非常大，它看起来很好，但是如果我想从无限大小（至少未知大小）的链表中随机选择 1 个元素，我将如何使用这个算法来做...... ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:25:50.133

The reservoir sampling algorithm works on any sized linked list, even one whose length is unknown in advance. In fact, one of the main selling points of reservoir sampling is that it works on data streams whose size is not known in advance.

If you set k = 1 and then run the normal reservoir sampling algorithm, then you should correctly get a uniformly random element from the list.

Hope this helps!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-23T17:08:50.430

我已经实现了一种不同的算法来解决这个问题，这是我的代码

```
static char[] solution2(String stream, int K) {
    HashSet<Integer> set = new HashSet();
    char[] list = new char[K];
    stream = stream.concat(stream2);
    Random ran = new Random();
    for (int i = 0; i < K; i++) {
        int y = ran.nextInt(stream.length());
        if (set.add(y)) {
            list[i] = stream.charAt(y);
        } else {
            i--; //skip this iteration since its duplicate number
        }
    }
    return list;
} 
```

无需遍历所有流值，只需选择一个随机值 J 并从流中获取 N[J]。

# datagridview - 删除在指定列上包含空值的行

> ID：14429491
> 
> 赞同：0
> 
> 时间：2013-01-20T21:23:02.637
> 
> 标签：datagridview

我有一个从`datagridview`我`winform`的数据库返回搜索结果的我。返回搜索后，我想从指定列中删除空行。这是一个例子：

![在此处输入图像描述](../Images/db35bb6d4e01754b0ead751bdec34e54.png)

假设我想删除类型`#2`列上具有空值的行。

我完全被困住了。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:53:51.573

```
var rowsNull = (from a in dataGridView1.Rows.Cast<DataGridViewRow>()
    where a.Cells[2].Value == null
    select a).ToList();
foreach (DataGridViewRow item in rowsNull)
{
    dataGridView1.Rows.RemoveAt(item.Index);
} 
```

# java - 在 JPA 中一次更新所有表数据

> ID：14429494
> 
> 赞同：0
> 
> 时间：2013-01-20T21:23:41.863
> 
> 标签：java, hibernate, jpa-2.0

是否可以在一个查询中更新所有表数据？

我有一个数据库表 Person 和相应的 Entiry PersonEntity，我可以通过 JPA 在 List personAll 等列表中获取所有 Person 数据。

我对 personAll 实例有几个 CRUD 操作，我想使用 Hibernate JPA 将所有这些更改反映到数据库中

换句话说，我希望将 Person 表的内容替换为 personAll 实例的新内容？

实际上这个问题的长期解决方法是执行几个插入，删除和更新操作。但是应该有一种简单的方法吗？

如果 eash other 之间存在 OneToMany 关系，当有两个表 Shool Student 表时，我可以做类似的事情吗？[Hibernate JPA 值删除 OneToMany 关系](https://stackoverflow.com/questions/14358188/hibernate-jpa-value-removing-onetomany-relation)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:28:52.650

这取决于表中有多少行。

如果您将所有行加载到 Hibernate 会话中并根据需要修改返回的实例，则在刷新会话时，任何更改都将由 Hibernate 自动保存到数据库中。

它取决于大小的原因是，如果您将一个巨大表的内容加载到 Hibernate 会话中，您将面临内存错误的风险，即使您没有耗尽内存，刷新也会非常慢，因为会话非常需要检查是否有修改。

# c++ - C++ 将类型作为未知类函数的参数？

> ID：14429495
> 
> 赞同：2
> 
> 时间：2013-01-20T21:23:41.360
> 
> 标签：c++

我试图让一个类函数采用另一个类未知函数。我希望这有任何意义。我想做的是......如果单击按钮1（或任何声明的按钮），它将执行输入到函数Event__MouseClicked的第一个参数中的任何函数（任何“无效函数”）。

```
bool MouseClicked( void ){ /**/ };

namespace XE
{
    class Window
    {
    public:
        const char* Title;
    };

    class Button
    {
    public:
        void Event__MouseClicked( void( *Function )( void ) ) {
            if( MouseClicked( ) )
                ( *Function )( );
        }
    };
};

class XorrWindow1 : public XE::Window
{
public:
    XorrWindow1( void ) {
        Initialize( );
    }
protected:
    ~XorrWindow1( void );
private:
    XE::Button Button1;
    XE::Button Button2;
private:
    // EVENT PROTOTYPES
    void DoSomething( void );
    void RandomFunction( void );

    void Initialize( void )
    {
        // INITIALIZE CONTROLS
        // AND OTHER STUFF BELOW
        this->Title = "XorrWindow1";

        // How can I resolve this problem?
        this->Button1.Event__MouseClicked( &XorrWindow1::DoSomething );
        this->Button2.Event__MouseClicked( &XorrWindow1::RandomFunction );
    };
};

void XorrWindow1::DoSomething( void ) {
    ::MessageBoxA( NULL, this->Title, "Button1 clicked!", MB_OK );
};

void XorrWindow1::RandomFunction( void ) {
    ::MessageBoxA( NULL, this->Title, "Button2 clicked!", MB_OK );
}; 
```

错误是这样的：

```
'XE::Button::Event__MouseClicked' : cannot convert parameter 1 from 'void (__thiscall XorrWindow1::* )(void)' to 'void (__cdecl *)(void)' 
```

我完全理解导致错误的原因。但我不知道如何修复它，因为它必须能够采用 Window1 类的任何未知功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:49:55.790

正如 Karel Petranek 所说，您需要模板来适应所有情况。这是*最*通用的方法（STL 到处使用）：

```
template<typename f>
void Event__MouseClicked(f&& func)
{
    if( MouseClicked( ) )
        func();
} 
```

基本上`Event__MouseClicked`接受一个可调用对象。在您的情况下，您可以像 Marcelo Cantos 所描述的那样称呼它：

```
Button1.Event__MouseClicked([&]{ DoSomething(); }); 
```

但是这种方法的好处是传递*任何*不带参数的可调用对象都`Event__MouseClicked`将编译并工作。您可以传递函数指针、结果`std::bind`、a `std::function`、lambda 等。

在某些情况下，这比强制接受 a 更优化`std::function`，例如在接受直接函数指针时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T21:44:26.470

您不能将成员函数指针作为自由函数指针传递，因为无法`this`根据需要捕获和传递它。

这个问题有很多不同的解决方案。如果你有 C++11，最优雅的方法是传递一个`std::function<void()>`：

```
virtual void Event__MouseClicked(const std::function<void()>& f) {
    if (MouseClicked()) f();
}
⋮
Button1.Event__MouseClicked([&]{ DoSomething(); }); 
```

> **编辑：**我几乎忘了提到使用 lambdas，你甚至可以取消回调成员函数：
> 
> ```
> Button1.Event__MouseClicked([&]{
>     ::MessageBoxA( NULL, this->Title, "Button1 clicked!", MB_OK );
> }); 
> ```

因为这不是模板函数，所以您可以在派生类中覆盖它。但是请注意，GUI 框架通常不要求您从类`Button`中派生来自定义它们的行为，并且它们也不会将回调作为事件的一部分传递。常见的模式是按钮保持回调函数并在适当的时候调用它。例如：

```
class Button {
⋮
public:
    void onClicked(std::function<void(Button*)>& f) { clicked_ = f; }
    void click() { clicked_(this); }
private:
    std::function<void(Button*)> clicked_;

    // Internal click handler responds to OS click events.
    void handleClickEvent(…) { clicked_(this); }
}; 
```

以上不是世界上最好的设计，但它应该让您了解我在说什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T21:39:47.247

您将需要使用模板来适应所有可能的类：

```
 template <typename T>
        void Event__MouseClicked(T *object, void( T::*Function )( void ) ) {
            if( MouseClicked( ) )
                ( object->*Function )( );
        } 
```

利用：

```
this->Button2.Event__MouseClicked( this, &XorrWindow1::RandomFunction ); 
```

请注意，您将失去在子类中覆盖此方法的能力，因为模板函数不能是虚拟的。您还需要将“this”指针与方法指针一起传递。

# asp.net-mvc - ASP.NET 用户未发布到 Azure

> ID：14429497
> 
> 赞同：1
> 
> 时间：2013-01-20T21:23:50.150
> 
> 标签：asp.net-mvc, azure, visual-studio-2012

我有一个简单的 MVC 4 应用程序，其用户和角色在 ASP.NET 配置中定义。它们在本地运行良好（使用 F5 运行），但是当发布到 Azure 网站时，用户不存在，或者至少在尝试登录时无法登录。可能是用户不存在或密码不匹配。

例如，我只有一个管理员页面，我有一个管理员用户。在本地，我在 ASP.NET 配置页面中创建了用户和角色，我可以以管理员身份登录并访问安全页面。发布到 Azure 网站后，我无法以管理员身份登录。

任何人都可以帮忙吗？如何发布我的 ASP.NET 配置？

我正在使用 Visual Studio Express 2012 for Web

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T01:28:57.287

正如@Sound 指出的那样，您可能缺少 Azure 上托管的数据库中的用户。通过 Azure 门户打开防火墙后，您可以使用 Sql Management Studio 访问 Sql Azure。从那里，您可以运行脚本来插入用户，或者通过 SSMS 手动执行。

迁移数据有很多选择，以上只是其中的几个。您还可以查看 EF Data Migrations，因为这也可能很合适。

# ios - 根据屏幕大小调整元素大小的更简单/正确的方法

> ID：14429498
> 
> 赞同：1
> 
> 时间：2013-01-20T21:23:51.553
> 
> 标签：ios, actionscript-3, button, air, resize

我有一个适用于所有设备的 iOS 应用程序。我已经为 iPad 完美地设计了它，但现在我在为更小的屏幕调整元素大小方面有点挣扎。我的数据网格可以完美地缩放和移动，但是当涉及到按钮时，它们就会变得扭曲和混乱。按钮上的向下状态是巨大且拉伸的，与向上状态不同。我的逻辑告诉我，如果我缩放按钮，它应该相应地缩放向上和向下状态，就好像你只是在舞台上调整大小一样。我只是想让按钮稍微大一点并将它们移动一点..

```
if (Capabilities.screenResolutionX < 700) {
    dg.move(120, 150);
    dg.width = 1120;
    dgPlace.move(70, 20);
    dgPlace.width = 260;
    dgPlace.height = 650;
    dgPlace.rowCount = 21;
    dgPlace.setRendererStyle("textFormat", myTextFormat3);
    dgPlace.setStyle("headerTextFormat", myTextFormat3);
    btnPlacesEditAdd.width = btnPlacesEditAdd.width+20;
    btnPlacesEditAdd.height = btnPlacesEditAdd.height+20;
    btnPlacesEditRemove.width = btnPlacesEditAdd.width+20;
    btnPlacesEditRemove.height = btnPlacesEditAdd.height+20;
    btnPlacesEditSet.width = btnPlacesEditAdd.width+20;
    btnPlacesEditSet.height = btnPlacesEditAdd.height+20;
    btnPlacesEditAdd.x = btnPlacesEditAdd.x+20;
    btnPlacesEditAdd.y = btnPlacesEditAdd.y+20;
    btnPlacesEditSet.x = btnPlacesEditSet.x+20;
    btnPlacesEditSet.y = btnPlacesEditSet.y+20;
    btnPlacesEditRemove.x = btnPlacesEditRemove.x+20;
    btnPlacesEditRemove.y = btnPlacesEditRemove.y+20;
} 
```

# python - 基于类的视图中的可选 url 参数

> ID：14429500
> 
> 赞同：3
> 
> 时间：2013-01-20T21:23:55.217
> 
> 标签：python, django, django-urls, django-class-based-views

如何使用基于类的视图为 url 参数创建默认值？例如 TemplateView

例如：

```
url(r'^(?P<num>\d+)|/$', MyView.as_view()) 
```

如果 num 未在 url 中指定，我想设置默认值 '4'

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T23:17:35.953

如果您指定包含名称的正则表达式，例如：

```
url(r'^(?P<num>\d+)|/$', MyView.as_view()) 
```

然后`num`将始终作为关键字参数传递给您的视图函数。如果正则表达式匹配但不`num`匹配，则将`num`作为 None 传递给您的视图。

给定以下视图函数：

```
def get(self, request, *args, **kwargs):
    print 'args %s' % repr(args)
    print 'kwargs %s' % repr(kwargs) 
```

runserver 打印的输出如下：

```
# url: /
args ()
kwargs {'num': None}

# url: /45/
args ()
kwargs {'num': u'45'} 
```

检测`None`值并酌情分配默认值由您决定。

```
def get(self, request, *args, **kwargs):
    num = kwargs.get('num', None)
    if num is None:
        num = 4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T22:02:02.407

如果`num`未在 URL 中指定，则 Django 不会使用该行`urls.py`来显示页面。您可以像这样修改您的 URL 配置来实现这一点：

```
url(r'^$', MyView.as_view())
url(r'^(?P<num>\d+)|/$', MyView.as_view()) 
```

在 中`MyView`，您可以通过以下方式获取参数：

```
def get(self, request, *args, **kwargs):
    my_url = request.GET.get('url', 4) 
```

它将 URL 中给定的值分配给`my_url`或 4 作为默认值。

# list - prolog - 从列表中提取术语

> ID：14429504
> 
> 赞同：0
> 
> 时间：2013-01-20T21:24:24.703
> 
> 标签：list, prolog

好吧，我有一些汽车的基本部件，例如：

```
elementary_part( spoke ).
elementary_part( rim ).
elementary_part( hub ). 
```

和一些子组件，例如：

```
subcomponent( wheel, [quant( spoke, 5 ), quant( rim, 1 ), quant( hub, 1)] ). 
```

我正在尝试编写一个“consists_of”程序来提供基本部分，例如

```
consists_of(wheel, P). 
```

到目前为止，我已经完成了这一点：

```
consists_of(wheel, P):- parts(wheel, P).
quant(X,Y):- write(Y), write(' piece(s) of '), write(X), write('.'), nl.
parts(X,Y):- subcomponent(X, [H|T]), print_a_list([H|T]).

print_a_list([]).
print_a_list([H | T]) :- nl, write(H), print_a_list(T). 
```

我得到的结果是：

```
?- consists_of(wheel,P).

quant(spoke,5)
quant(rim,1)
quant(hub,1)
true. 
```

...这不是我想要的。我尝试时得到正确的结果

```
consists_of(wheel, P):- quant( spoke, 5 ), quant( rim, 1 ), quant( hub, 1). 
```

但由于我正在为许多汽车零件这样做，我知道这不是解决方案。

我错过了什么吗？如何分别提取列表的元素，以便正确显示“quant(X,Y)”？或者至少只显示了元素，而不是带有函子的复合项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T07:56:04.060

您只需要将调用替换为`write(H)`调用`quant`：

```
print_a_list([]).
print_a_list([quant(X,Y) | T]) :- nl, quant(X,Y), print_a_list(T). 
```

如果您仍然希望尽可能保持`print_a_list`通用性

```
print_a_list([]).
print_a_list([H | T]) :- nl, write_q(H), print_a_list(T). 
```

和

```
write_q(H) :- H. 
```

有些人可能不喜欢最后一种解决方案，因此另一种选择是

```
write_q(quant(X,Y)):- write(Y), write(' piece(s) of '), write(X), write('.'), nl. 
```

# wordpress - 帖子类别与事件类别

> ID：14429505
> 
> 赞同：0
> 
> 时间：2013-01-20T21:24:28.040
> 
> 标签：wordpress

我有大约十几个事件类别和 1 个帖子类别

当我使用 get_categories($args) 时：

```
$args=array(
  'orderby' => 'name',
  'order' => 'ASC',
  'hide_empty' => 0
); 
```

我得到了帖子类别（我想要）和所有事件类别（我不想要）。

我不太清楚传递 get_categories 的参数，以便查看仅与帖子相关联的类别，而不是与事件相关联的类别。我已经阅读了一些关于使用 get_terms() 执行此操作的内容并尝试过：

```
$args = array('type'=> 'post', 'order' => 'ASC', 'hide_empty' => 0 );
$taxonomies = array('category');
$terms = get_terms( $taxonomies, $args); 
```

但这给了我完全相同的结果——我的 1 个帖子类别和我的十几个事件类别。

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T08:21:05.040

要从您的分类中获取类别（如评论中给出的） ，请`events_categories`使用

```
$categories = get_categories( array( 'hide_empty' => 0, 'taxonomy' => 'events_categories' ) ); 
```

老实说，我很惊讶您的原始查询返回了属于 events_categories 分类的类别。它应该只返回帖子类别。然而，这应该是故障安全的。它只能返回属于指定分类的类别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T13:33:06.257

事实证明，多合一事件日历可以选择包含/排除带有帖子类别的事件类别。

我的设置包括。我不知道这是否是默认值。

一旦我关闭它，以下内容：

```
get_categories($args=array'orderby' => 'name', 'order' => 'ASC','hide_empty' => 0); 
```

给了我想要的帖子类别。

非常感谢所有的帮助，这是最有启发性的。

# r - Running Median Curve instead of LOWESS

> ID：14429510
> 
> 赞同：3
> 
> 时间：2013-01-20T21:25:01.847
> 
> 标签：r, curve, median

I'm currently working on modifying some R-code I got provided to fit my needs.

The situation is the following:

We are plotting ~200 lines. They then used LOWESS to get a best-fit curve.

It looks like this right now:

```
lines(lowess(x.lowess, y.lowess), lwd = 3) 
```

where x.lowess and y.lowess are the corresponding coordinates, each in a vector, such as:

```
> dput(x.lowess)
c(0.268309377138946, 0.511978097193703, 0.785763175906913, 0.974674880219028, ... )
> dput(y.lowess)
c(0.8, 0.5, 0.8, 0.5, ... ) 
```

I am now looking the get a running median curve instead of a LOWESS best-fit curve.

Is there any simple way/function for doing this?

for an example of the plot, seee this on flickr (sorry, couldn't upload it directly, i'm new here and it's not allowed :) [plot with lowess smoothing curve in red](http://www.flickr.com/photos/blabbr/8399215443/in/photostream)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:51:25.850

生成一些示例数据：

```
set.seed(1001)
x <- runif(1000)
y <- runif(1000)
dat <- data.frame(x,y) 
```

使用`quantreg`包求中值作为 x 的函数：

```
library(quantreg)
q1 <- rq(y~x,data=data.frame(x,y))
xvec <- seq(0,1,length=101)
pq <- predict(q1,newdata=data.frame(x=xvec)) 
```

在基础图形中绘制：

```
plot(x,y,pch=".")
lines(lowess(x,y))
lines(xvec,pq,col=2) 
```

或使用`ggplot2`：

```
library(ggplot2)
theme_set(theme_bw())
qplot(x,y,data=dat,size=I(0.8),alpha=I(0.2))+
    geom_smooth(method="loess")+
    stat_quantile(quantiles=0.5,formula=y~x,colour="red") 
```

# c# - parsing xml returned by web service response

> ID：14429513
> 
> 赞同：4
> 
> 时间：2013-01-20T21:25:11.597
> 
> 标签：c#, web-services, xml-parsing

I have read many questions on SO about this topic but I can seem to related to what I am trying to do. Basically I am calling a web service to return information about a Vehicle Identification Number (VIN). It returns an xml stream that looks like this:

```
<VINquery Version="1.0.0" Date="5/25/2003">
  <VIN Number="1HGES15501Lxxxxxx" Status="SUCCESS">
    <Vehicle VINquery_Vehicle_ID="23261" Model_Year="2001" Make="Honda" Model="Civic" Trim_Level="LX Sedan">
      <Item Key="VINquery Vehicle ID" Value="23261" Unit=""/>
      <Item Key="Model Year" Value="2001" Unit=""/>
      <Item Key="Make" Value="Honda" Unit=""/>
      <Item Key="Model" Value="Civic" Unit=""/>
      <Item Key="Trim Level" Value="LX Sedan" Unit=""/>
      <Item Key="Manufactured in" Value="UNITED STATES" Unit=""/>
      <Item Key="Production Seq. Number" Value="xxxxxx" Unit=""/>
      <Item Key="Body Style" Value="SEDAN 4-DR" Unit=""/>
      <Item Key="Engine Type" Value="1.7L L4 SOHC 16V" Unit=""/>
      <Item Key="Transmission-short" Value="5M OD" Unit=""/>
      <Item Key="Transmission-long" Value="5-Speed Manual Overdrive" Unit=""/>
      <Item Key="Driveline" Value="FWD" Unit=""/>
      <Item Key="Tank" Value="13.20" Unit="gallon"/>
      <Item Key="Fuel Economy-city" Value="30 - 32" Unit="miles/gallon"/>
      <Item Key="Fuel Economy-highway" Value="38 - 39" Unit="miles/gallon"/>
      <Item Key="Anti-Brake System" Value="Non-ABS" Unit=""/>
      <Item Key="Steering Type" Value="R&P" Unit=""/>
      <Item Key="Standard Seating" Value="5" Unit=""/>
      <Item Key="Optional Seating" Value="No data" Unit=""/>
      <Item Key="Length" Value="174.60" Unit="in."/>
      <Item Key="Width" Value="67.50" Unit="in."/>
      <Item Key="Height" Value="56.70" Unit="in."/>
    </Vehicle>
  </VIN>
</VINquery> 
```

I want to take that data and parse it out for each key/value. This is my code I am using the get the xml data:

```
private string baseURL = "http://ws.vinquery.com/restxml.aspx?accessCode=xxxxxx&vin=xxxxxxxxx";
private string reportType = "&reportType=2";

public XmlDocument ExplodeVIN(string strVIN)
{
   DataTable dt = new DataTable();

   string url = baseURL + strVIN + reportType;

   HttpWebRequest req = WebRequest.Create(url) as HttpWebRequest;

   XmlDocument xmlDoc = new XmlDocument();
   using (HttpWebResponse resp = req.GetResponse() as HttpWebResponse)
   {
     xmlDoc.Load(resp.GetResponseStream());
   }
   return xmlDoc;
} 
```

After I get the xmlDoc I am not sure what to do next.

Thanks for your kind assistance.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T21:29:17.380

您可以`Dictionary<string, string>`使用 Linq to Xml 解析 xml：

```
var xdoc = XDocument.Parse(xml);
var items = xdoc.Descendants("Item")
                .ToDictionary(i => (string)i.Attribute("Key"),
                              i => (string)i.Attribute("Value")); 
```

用法：

```
string driveline = items["Driveline"]; 
```

或者

```
foreach(var kvp in items)
    // use key value pair 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T21:32:19.933

```
XmlDocument xmldoc = new XmlDocument();
XmlNodeList xmlnodelstTrack = xmldoc.GetElementsByTagName("Item");
foreach (XmlNode NodeObj in xmlnodelstTrack)
{
  //Do stuff with NodeObj.OuterXml

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-12-06T12:49:07.030

我通常使用另一种方式来处理 xml。

**第 1 步：**复制您的 xml 字符串并粘贴为类。

[![将 XML 粘贴为类](../Images/6e0af2583f7c058e2d8d36c7e404bf0a.png)](https://i.stack.imgur.com/EDWDd.png)

当您粘贴它时，将自动生成此代码：

```
 /// <remarks/>
        [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true)]
        [System.Xml.Serialization.XmlRootAttribute(Namespace = "", IsNullable = false)]
        public partial class VINquery
        {

            private VINqueryVIN vINField;

            private string versionField;

            private string dateField;

            /// <remarks/>
            public VINqueryVIN VIN
            {
                get
                {
                    return this.vINField;
                }
                set
                {
                    this.vINField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Version
            {
                get
                {
                    return this.versionField;
                }
                set
                {
                    this.versionField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Date
            {
                get
                {
                    return this.dateField;
                }
                set
                {
                    this.dateField = value;
                }
            }
        }

        /// <remarks/>
        [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true)]
        public partial class VINqueryVIN
        {

            private VINqueryVINVehicle vehicleField;

            private string numberField;

            private string statusField;

            /// <remarks/>
            public VINqueryVINVehicle Vehicle
            {
                get
                {
                    return this.vehicleField;
                }
                set
                {
                    this.vehicleField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Number
            {
                get
                {
                    return this.numberField;
                }
                set
                {
                    this.numberField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Status
            {
                get
                {
                    return this.statusField;
                }
                set
                {
                    this.statusField = value;
                }
            }
        }

        /// <remarks/>
        [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true)]
        public partial class VINqueryVINVehicle
        {

            private VINqueryVINVehicleItem[] itemField;

            private ushort vINquery_Vehicle_IDField;

            private ushort model_YearField;

            private string makeField;

            private string modelField;

            private string trim_LevelField;

            /// <remarks/>
            [System.Xml.Serialization.XmlElementAttribute("Item")]
            public VINqueryVINVehicleItem[] Item
            {
                get
                {
                    return this.itemField;
                }
                set
                {
                    this.itemField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public ushort VINquery_Vehicle_ID
            {
                get
                {
                    return this.vINquery_Vehicle_IDField;
                }
                set
                {
                    this.vINquery_Vehicle_IDField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public ushort Model_Year
            {
                get
                {
                    return this.model_YearField;
                }
                set
                {
                    this.model_YearField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Make
            {
                get
                {
                    return this.makeField;
                }
                set
                {
                    this.makeField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Model
            {
                get
                {
                    return this.modelField;
                }
                set
                {
                    this.modelField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Trim_Level
            {
                get
                {
                    return this.trim_LevelField;
                }
                set
                {
                    this.trim_LevelField = value;
                }
            }
        }

        /// <remarks/>
        [System.Xml.Serialization.XmlTypeAttribute(AnonymousType = true)]
        public partial class VINqueryVINVehicleItem
        {

            private string keyField;

            private string valueField;

            private string unitField;

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Key
            {
                get
                {
                    return this.keyField;
                }
                set
                {
                    this.keyField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Value
            {
                get
                {
                    return this.valueField;
                }
                set
                {
                    this.valueField = value;
                }
            }

            /// <remarks/>
            [System.Xml.Serialization.XmlAttributeAttribute()]
            public string Unit
            {
                get
                {
                    return this.unitField;
                }
                set
                {
                    this.unitField = value;
                }
            }
        } 
```

**第 2 步：** 将您的 xml 字符串反序列化为此生成的类。

```
public T DeserializeXML<T>(string xmlContent)
{
    XmlSerializer serializer = new XmlSerializer(typeof(T));
    MemoryStream memStream = new MemoryStream(Encoding.UTF8.GetBytes(xmlContent));
    return (T)serializer.Deserialize(memStream);
}

....
string resultXml = resp.GetResponseStream();
VINquery resultObject = DeserializeXML<VINquery>(resultObject); 
```

现在您可以轻松地操作和过滤您的结果。

PS：您必须删除 xml 字符串中的特殊字符 (&)，因为当您尝试将其粘贴为类时会导致问题。

# java - Why can "if (x != null);" be a statement in Java

> ID：14429514
> 
> 赞同：1
> 
> 时间：2013-01-20T21:25:21.627
> 
> 标签：java

> **Possible Duplicate:**
> [semicolon at end of if statement](https://stackoverflow.com/questions/14112515/semicolon-at-end-of-if-statement)

I was programming, and found a bug in my code, and it was because of a semi colon after an "if" statement, and its boxy "{ xxx }" was being executed as if it has its own scope -- so everything would get compiled.

This begs the question, why is:

```
if (x != null); 
```

A possible statement in Java, it seems like a useless line of code that could generate lots of bugs, etc.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:31:26.873

该行基本上等同于：

```
if (x != null) {
} 
```

但是，您可以创建如下行：

```
if (x != null) System.out.println(x); 
```

所以它的存在是为了支持这种代码的执行，但你的例子只是我第一个例子的简写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:31:44.770

从我所看到的（我可能错了）只有一个理由做这样的事情。

想象一下`x`是一个 getter，然后`x`从当前类中获取变量，然后执行另一段代码（或者可能只是缓存 的响应`x`）。

也就是说，如果是这样的话，我*认为*这`x;`也可以。

# css - 我可以只针对背景不透明度而不是其他吗

> ID：14429520
> 
> 赞同：0
> 
> 时间：2013-01-20T21:26:03.400
> 
> 标签：css

我想知道是否可以完成以下操作。查看此示例[http://jsfiddle.net/huhu/r7kSf/](http://jsfiddle.net/huhu/r7kSf/)，是否只能以不透明度级别为目标？让我们说`opacity:0.5;`正常条件和悬停以完全不透明？我知道当使用颜色时使用 alpha 系数更容易，但是只有图像呢？选项可以是使用两个不同的图标吗？在悬停下加载它的替代版本？我认为这不是一个好主意，因为对于许多 http 请求，除非在 sprite 中。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:26:39.693

是的，使用 CSS3 的`rgba`背景。例如，`#F7F8BD`用 50% opacity 变为`rgba(247,248,189,0.5);`注意兼容性还不是 100%，所以使用以下：

```
background: #F7F8BD; /* Browsers that don't support RGBa */
rgba(247,248,189,0.5); /* CSS3 */ 
```

有关详细信息，请参阅[http://css-tricks.com/rgba-browser-support/](http://css-tricks.com/rgba-browser-support/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:28:49.590

代替

```
opacity:0.5 
```

采用：

```
background-color:rgba(0,0,0,0.5); 
```

其中前 3 个数字是红色、绿色和蓝色值，最后一个是 alpha 值，它为您的背景提供透明度

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T21:30:49.777

如果我理解这个问题，那么不 - 你不能对子弹图像应用不透明度，但不能对整个图像应用不透明度`li`。

您最好的选择是将图像作为背景放入`span`：

```
<li><span class="bg"></span> Text</li> 
```

并将不透明度应用于`span`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T00:54:16.967

这是可能的，但需要一些棘手的 CSS3 hacking - 基本上，使用伪元素在每个项目前面创建一个新的 inline-block 元素`:before`，然后调整这些元素的不透明度。此外，您不会将背景图像分配给`<li>`元素本身，而是将其分配给`:before`伪元素。

```
#mainFeatures li:before {
    content: '\0000a0';
    display: inline-block;
    opacity: 0.5;
    width: 30px;
}

#mainFeatures li#[insert element ID here]:before { 
    background:url([image url]) no-repeat 0 5px;
} 
```

我已经修改并分叉了你的小提琴 - 看看:) [http://jsfiddle.net/teddyrised/QBGWf/1/](http://jsfiddle.net/teddyrised/QBGWf/1/)

# jquery - Why am I getting a "Security Error" from plupload on IE8/IE9 when uploading over HTTPS?

> ID：14429523
> 
> 赞同：2
> 
> 时间：2013-01-20T21:26:11.563
> 
> 标签：jquery, internet-explorer, https, iis-7.5, plupload

I'm using plupload to upload files to an ASP.NET WebAPI service. It works fine in Chrome, and it works fine in IE8/IE9 on my development machine. When I connect to the website on the actual server, however, uploading a file causes plupload's error handler to fire with an error code of -400 and an error message of "Security Error."

Looking at the response and request headers everything looks ok. The response even contains the correct return value! I'm guessing this has something to do with using https, but I'm not sure and it does work correctly in Chrome. (Firefox has a completely different issue, but seems to at least get the data back unlike IE.)

I'm wondering it has something to do with the request Accept header, which is:

```
Accept  application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */* 
```

The response header's Content-Type is text/html because application/json causes IE to want to save the response rather than pass it back to the script.

So what is this "Security Error" and why am I getting it? More importantly why am I getting it even though the response seems to be coming back correctly? Even more importantly, how do I fix it?

EDIT: OK, so more information. Apparently IE9 uses the html4 runtime for plupload, which uses an iframe to handle the file upload. When the data returns and it tries to access the HTMLIFrameElement IE9 gives an "Access is denied" error. I understand it's to help prevent xss errors, BUT it seems like reading from an iframe should be safe...

So anyone know a way around it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T16:41:10.293

事实证明，IE8 和 IE9 都使用 plupload 的 HTML4 运行时，而不是 HTML5 运行时。HTML4 正常运行时间通过呈现隐藏的 iframe 来处理上传。这里的问题是 IE8/9 不允许访问该 iframe 以防止 XSS 攻击，因此当 plupload 尝试读取上传结果时，我们会收到该安全错误。

解决方案基本上是让 Web 服务在与调用它的页面相同的 URL 上可用。就我而言，我只是在 IIS 中配置了一个指向 Web 服务站点的虚拟应用程序（它恰好在同一台服务器上，但我认为它也可以与两个不同的服务器一起使用。）

在同一站点中创建虚拟应用程序允许您在仍然从辅助站点获取内容的同时引用主站点的 URL。

# image - Saving and Loading Image to IsolatedStorage Requires Saving Twice

> ID：14429526
> 
> 赞同：5
> 
> 时间：2013-01-20T21:26:23.877
> 
> 标签：image, windows-phone-8, isolatedstorage

I am using [ImageTools](http://imagetools.codeplex.com) from codeplex in order to save a canvas as a png; however, I had the same problem when I was using a `writeableBitmap.SaveJpeg()`. Therefore, the problem is not with the image type, but rather with how I am saving or loading in `IsolatedStorage`.

When I save the image by pressing a save button the file exists, but when I load the image nothing appears. If I save the image twice then the image loads and is displayed correctly.

Below is my code.

Saving File:

```
ExtendedImage myImage = myCanvas.ToImage();

using (var isoStore = IsolatedStorageFile.GetUserStoreForApplication())
{
    if (isoStore.FileExists("image.png"))
       isoStore.DeleteFile("image.png");

    using (var fileStream = isoStore.CreateFile("image.png"))
    {
        myImage.WriteToStream(fileStream, "image.png");
        fileStream.Close();
    }
} 
```

Loading file

```
BitmapImage bi = new BitmapImage();

using (var isoStore = IsolatedStorageFile.GetUserStoreForApplication())
{
    if (isoStore.FileExists("image.png"))
    {
        using (var fileStream = isoStore.OpenFile("image.png", FileMode.Open))
        {
            bi.SetSource(fileStream);
            this.img.Height = bi.PixelHeight;
            this.img.Width = bi.PixelWidth;
            this.img.Source = bi;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-04T08:01:31.737

试试这个代码来检索图像`isoStore`。这个对我有用。

```
using (IsolatedStorageFile iso = IsolatedStorageFile.GetUserStoreForApplication())
{
      if (iso.FileExists(string.Format("image.png")))
         {
            string fileName = "image.png";
            string filePath = iso.GetType().GetField("m_RootDir", System.Reflection.BindingFlags.NonPublic |
            System.Reflection.BindingFlags.Instance).GetValue(iso).ToString() + fileName;
         }
} 
```

您可以将 Image 的来源设置为 filePath，访问它不会有任何问题。

如果这不起作用，那么问题出在您保存图像时。您可能必须找到将画布保存为 png 或 jpeg 的解决方法。

# c - Ansi C complains about array initializing

> ID：14429532
> 
> 赞同：0
> 
> 时间：2013-01-20T21:27:05.367
> 
> 标签：c, arrays, initialization, ansi

I have a simple C program that compiles fine under c99, but under ANSI it complains:

***missing braces around initializer***

The offending line is:

```
int myarr[3][3]={0}; 
```

Why is ANSI C complaining? I saw one posting saying to add additional { } around the { 0 } but that makes no sense to me...

(I'm compiling in CentOS in case it matters)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:29:12.863

```
int myarr[3][3]={0}; 
```

这是完全有效的 C，在这种情况下，警告只是编译器的一个指示。

如果你想摆脱警告，你可以这样做：

```
int myarr[3][3]={{0}}; 
```

或者`-Wno-missing-braces`如果您使用`gcc`with`-Wall`选项，也可以添加。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T21:32:45.123

严格来说（在 ANSI C 下），如果要初始化多维数组，则应该附加大括号。例如，如果将每个元素初始化为特定值，则可以执行以下操作：

```
int myarr[3][3] = {{1,2,3},{4,5,6},{7,8,9}}; 
```

# c++ - C++ - Error C4430: missing type specifier (for a constructor???)

> ID：14429533
> 
> 赞同：1
> 
> 时间：2013-01-20T21:27:05.383
> 
> 标签：c++

I've been stuck with this since last night, and for the life of me, I haven't been able to figure out why this is happening. I must be missing something very simple.

I'm making an OpenGL program. In this program, I'm making a DialogBox class. Below is the code:

```
//---------------------------------------------------------------
//DialogBox.h
//---------------------------------------------------------------

#include <vector>

class DialogBox
{
    private:

      float X; float Y; float Z;
      float Width;
      float Height;

      float RED;
      float GREEN;
      float BLUE;
      float ALPHA;

      int currentLine; 
      int maxLines;    //How many lines of text this dialog box can hold
      int maxChars;    //How many chars each line of text can hold

      std::vector< std::vector<char> >Text; //Text contents of the Dialog Box

      unsigned int vertexArray_DialogBox;
      unsigned int vertexBuffer_DialogBox;

   public:

      DialogBox();
      DialogBox(float width, float height);

      void draw();
      void draw(float x, float y, float z);

};

//------------------------------------------------------------------------
//DialogBox.cpp
//------------------------------------------------------------------------

#include <iostream>
#include "DialogBox.h"

DialogBox::DialogBox()
{
    X = 0.0f; Y = 0.0f; Z = 0.0f;

    Width = 1.0f;
    Height = 1.0f;

    RED = 0.0f;
    GREEN = 1.0f;
    BLUE = 1.0f;
    ALPHA = 1.0f;

    //For HELVETICA_18 ----------------------
    static const float letter_width = 0.03f;
    static const float letter_height = 0.04f;
    static const float line_height = 0.1f;
    //---------------------------------------

   maxLines = Height / line_height - 4; 
   maxChars = Width / letter_width - 2; 

   Text.resize(maxLines);
   for(int i = 0; i < maxLines; i++)
   {
       Text[i].resize(maxChars);
   }
}

DialogBox::DialogBox(float width, float height)
{
    Width = width;
    Height = height;
    //The rest of the initialization codes
}

void DialogBox::draw()
{
    //OpenGL Drawing codes
}

void DialogBox::draw(float x, float y, float z)
{
    X = x; Y = y; Z = z;
    draw();
} 
```

And the compiler threw this error message:

![enter image description here](../Images/5a60bd2aabdee6d8b7a07b4abd201a4f.png)

I have been pulling my hairs out, but I couldn't figure out what the compiler were referring to. It must be something really simple (like a typo in the codes or something like that). Thank you in advance for your help.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T21:30:33.067

同一行的警告是什么？

> 宏“DialogBoxA”的实际参数不足

是`DialogBox`-d`#define`宏吗？如果是这样，那可能会把事情搞砸。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T21:47:36.620

Microsoft 已经提供了一个名为 DialogBox 的函数（宏？）：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms645452%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645452%28v=vs.85%29.aspx)

它可能被拉进来了`<iostream>`，`<vector>`或者其他什么。将您的班级重命名为更原始的名称应该会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-20T21:29:49.920

当我编译你的代码时，我得到一个错误`DialogBox::draw()`，因为你没有在那里指定返回类型。具体来说，这是关于实现，而不是声明。这是我在您的代码中发现的唯一编译器错误。也许您的编译器只是标记了错误的行？

# sql - SQL SELECT from two tables - need join?

> ID：14429534
> 
> 赞同：1
> 
> 时间：2013-01-20T21:27:29.410
> 
> 标签：sql, select, join

How can i get all data from this 2 tables:

```
 Events
    cid   date
    1    1/12/2013
    2    2/2/2013
    1    5/5/2014

   Clients
    cid  name     gender
    1    david    male
    2    ashley   female
    3    barak    male 
```

And i want to make request to get all events with the cid data like:

```
Final
   cid   date         name    gender
   1     1/12/2013    david   male
   2     2/2/2013     ashley  female
   1     5/5/2013     david   male 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:14:19.983

假设您的要求是 SELECT *（为什么），那么您可以将所有先前的答案包装在一个子查询中。像这样的东西：

```
select * from 
(
  SELECT
  E.cid, 
  date, 
  name, 
  gender
FROM Events E
LEFT JOIN Clients C
  ON E.cid = C.cid) t 
```

还有[SQL 小提琴](http://sqlfiddle.com/#!2/830f4/4)。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:29:35.957

```
select * from Events join Clients on Clients.cid = Events.cid; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T21:30:36.983

```
SELECT
  E.cid, 
  date, 
  name, 
  gender
FROM Events E
LEFT JOIN Clients C
  ON E.cid = C.cid 
```

Left Join 负责处理在客户端表中没有事件 cid 条目的位置

如果表之间存在参照完整性，并且您可以保证 Clients 表中至少有一个条目，那么您可以将 LEFT JOIN 替换为 INNER JOIN。但这一切都取决于您拥有什么数据以及您的查询约束是什么。

**除非您确定不排除相关数据，否则切勿假设 INNER JOIN。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T21:31:04.737

您将需要`JOIN`以下表格：

```
select e.cid,
  e.date,
  c.name,
  c.gender
from clients c
inner join events e
  on e.cid = c.cid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/830f4/2)

如果您在学习连接语法方面需要帮助，这里有一个[关于连接的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)。

我使用 an`INNER JOIN`来连接表，这将返回`clients`表中具有匹配行的表中的所有行`events`。如果您想返回所有`clients`而不考虑表中的行，`events`那么您可以使用`LEFT JOIN`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-20T21:32:48.400

表格首字母大写

```
SELECT e.cid, e.date, c.name, c.gender
FROM Events AS e
LEFT JOIN Clients AS c
ON e.cid = c.cid 
```

# ruby-on-rails - Rails crushlovely / mobiscroll-rails 安装

> ID：14429535
> 
> 赞同：0
> 
> 时间：2013-01-20T21:27:29.863
> 
> 标签：ruby-on-rails

在 Rails 应用程序中，我添加了：

```
gem 'mobiscroll-rails' 
```

我跑了 $ bundle install

但是，我认为没有任何 mobiscroll 文件被加载到我的应用程序中。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:40:16.573

您可能必须添加`//= require mobiscroll`到您的`application.js`和`*= require mobiscroll`您的`application.css`.

# ajax - Ajax calls and security

> ID：14429537
> 
> 赞同：0
> 
> 时间：2013-01-20T21:27:31.637
> 
> 标签：ajax, jquery, security

I've created a php function that acts like a "router", meaning that it receives Ajax calls with some variables, loads the proper method and functions and then returns the data so that JS can handle it.

Most of the functions I'm making available use `$_SESSION` variables that are not passed through the call/response process, so in general terms without having the proper session loaded nothing should be returned. But as far as I know, I'm sure there must be a way around this, and, more importantly, I might have left out some function that will work even without any session loaded.

So I was wondering how to restrict access to the session. One way I thought would be to pass through the ajax call the user id, or some other unique identifier, and then compare it with the session, and proceed only if the two match.

But doing so would expose the user id, which, if possible, I would prefer to keep hidden as much as I can. And, in addition, I'm not even so sure that it would block any fraudulent ajax call.

So I was wondering, is there a better way?

Thank's!

PS for what matters, I'm making the calls with jQuery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:47:54.127

保护会话数据的最佳方法是使用仅存储在服务器上的密钥对其进行加密。每次您获得会话数据时都将其解密，进行所需的任何更改并对其进行加密，然后再将其放回`$_SESSION`. 只要客户端没有加密密钥，他们就无法解密数据（默认情况下，这些数据将存储在客户端的 cookie 中）。

如果恶意客户端尝试发送他们自己创建或修改的会话数据，则无法使用您的密钥解密（因为它未加密或使用不同的密钥加密），因此您可以假设会话数据无效并将其清除。

有关 PHP 加密的更多信息，请参阅[此问题](https://stackoverflow.com/questions/1788150/how-to-encrypt-string-in-php)。

# jquery-selectors - Jquery Selector :nth-child

> ID：14429538
> 
> 赞同：1
> 
> 时间：2013-01-20T21:27:40.063
> 
> 标签：jquery-selectors

I have a setup like this:

```
var count = 1;

function displayPoint(marker, index){
    $("#message").hide();

    var position = $($.goMap.mapId).data(marker).position;
    var markerOffset = overlay.getProjection().fromLatLngToDivPixel(position);

                    //console.log(count);
                    //console.log("li:not(:nth-child("+count+"))")
                        $("#message")
                            .fadeIn()
                            .css({ top:markerOffset.y, left:markerOffset.x })        
                            .children("li:not(:nth-child("+count+"))")
                            .hide();        
} 
```

In the line:

```
$("#message")
    .children("li:not(:nth-child(6))")
    .hide(); 
```

I am trying to remove everything except the needed child. And this works, But I need something like this:

```
.children("li:not(:nth-child("+count+"))") 
```

the selector needs to be variable. I have tried both double and single quotes, and it does not seem to work. Putting a constant selector works perfectly. I have even tried consoling out the `count` variable to see is that is the issue, `count` variable does what it should.
I can't see anything wrong in here. Any suggestions? Any other selectors perhaps? or some other elegant solution that I can't come up with. Any help is appreciated.

This is my code running [live][1]: When a variable is used, the first one seems to work fine, on second iteration, everything falls apart

This is the full code, it is a little big:

```
<!DOCTYPE html> 
<html> 
<head> 
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" /> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
<title>sideBar and create own infowindow / goMap</title> 

 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
 <script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>
<script type="text/javascript" src="js/jquery.gomap-1.3.2.min.js"></script> 

<script type="text/javascript" charset="utf-8">

            $(document).ready(function(){
                var c = 0;
                var count = 1;

                $("#map").goMap({
                    address :'San Francisco, CA',
                    zoom:9,
                    maptype: 'ROADMAP',
                    navigationControl: false,
                    scrollwheel: false,
                    mapTypeControl: false
                });

                setTimeout(function() {
                            // marker points
                var markers = [{  
                            address :'San Francisco, CA',
                            icon: 'img/pixel.png',
                        },{ 
                            address :'Sacramento, CA',
                            icon: 'img/pixel.png',                          
                        },{ 
                            address :'Berkeley, CA',    
                            icon: 'img/pixel.png',
                        },{ 
                            address :'Santa Rosa, CA',      
                            icon: 'img/pixel.png',
                        },{ 
                            address :'Palo Alto, CA',       
                            icon: 'img/pixel.png',
                        },{ 
                            address :'San Jose, CA',        
                            icon: 'img/pixel.png',      
                        },{ 
                            address :'Fremont, CA',     
                            icon: 'img/pixel.png',              
                        },{ 
                            address :'New York City,NY',        
                            icon: 'img/pixel.png',      
                        },{ 
                            address :'Philadelphia,PA',     
                            icon: 'img/pixel.png',  
                        },{ 
                            address :'Newark,NJ',       
                            icon: 'img/pixel.png',      
                        },{ 
                            address :'Trenton,NJ',      
                            icon: 'img/pixel.png',      
                        },{ 
                            address :'Washington,DC',       
                            icon: 'img/pixel.png',  
                        },{ 
                            address :'Baltimore,MD',        
                            icon: 'img/pixel.png',                              
                        }];

                    //set markers
                    for (var i = 0; i < 13; i++) {
                        $.goMap.createMarker(markers[i]);
                    }

                overlay = $.goMap.overlay;

                //  move through set points ( markers)
                    setInterval(function() {
                        if (c>12) c=0;
                        marker = $.goMap.markers[c];
                        displayPoint(marker, c);
                        c = c+1;    
                    },5000);

                    $("#message").appendTo(overlay.getPanes().floatPane);

                    $.post('tweetlist.php', function(response) {
                                        $("#message")
                                            .append(response)
                                            .hide();
                                    });

                    function displayPoint(marker, index){                                                           

                        var position = $($.goMap.mapId).data(marker).position;                      
                        var markerOffset = overlay.getProjection().fromLatLngToDivPixel(position);

                        //console.log(count);
                        console.log("li:not(:nth-child("+count+"))")
                            $("#message")
                                .fadeIn()
                                .css({ top:markerOffset.y, left:markerOffset.x })        
                                .children("li:not(:nth-child("+count+"))")
                                .hide();

                            $.goMap.map.panTo(position);
                            count = count +1;       
                    }

                },500);
            });
</script>
<style type="text/css" media="screen">
            #map { width:900px; height:500px; }
            #message {
                                        position:absolute;
                                        background:#555; 
                                        color:#fff;
                                        font-size:12px;
                                        width:300px;
                                        padding: 10px;
                                    }
            #twitter_container a{
                                        color:#0066CC;
                                        font-weight:bold;
                                        }   
            .twitter_status{
                                height:60px;
                                padding:6px;
                                border-bottom:solid 1px #DEDEDE;
                                }       
            .twitter_image{
                                float:left;
                                margin-right:14px;
                                margin-bottom:10px;
                                border:solid 2px #DEDEDE;
                                width:50px;
                                height:50px;
                                }                       
</style>
</head> 
<body> 
<div id="wrap">
    <div id="header">

    </div>
    <div id="content">

        <div id="map"></div>
        <ul id="message"></ul>
        <div id="footer"></div>
    </div>
</div> 
</body> 
</html> 
```

I use ajax here to get twitter data:

```
 $.post('tweetlist.php', function(response) {
                                    $("#message")
                                        .append(response)
                                        .hide();
                                }); 
```

And I get back this response:

```
 foreach ($json->results as $tweet )

{   
    $text = $tweet->text;
    $user = $tweet->from_user_name;
    $profile_image_url = $tweet->profile_image_url;
    echo "<li>";
    echo "<img src=".$profile_image_url." class = 'twitter_image' >";
    echo "<a href='http://www.twitter.com/".$user."'>".$user."</a>:";
    echo "<div class = 'twitter_status'>".$text."</div>";   
    echo "</li>";
}
  [1]: http://servernomics.com/map.html 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:50:40.167

使用以下`displayPoint`功能：

```
function displayPoint(marker, index) {
    var position = $($.goMap.mapId).data(marker).position;
    var overlay = $.goMap.overlay;
    var markerOffset = overlay.getProjection().fromLatLngToDivPixel(position);

    $.goMap.map.panTo(position);
    $("#message")
            .fadeIn()
            .css({ top: markerOffset.y, left: markerOffset.x });
    $("li", "#message").hide();
    $("li:nth-child(" + count + ")").show();
    count = count + 1;
} 
```

最初显示所有元素，但随后隐藏除第一个之外的所有元素，然后隐藏除第二个之外的所有元素，但未显示前一个元素，**因此**在第一次迭代后没有显示任何内容。

# scheme - What is ws in the big-bang function really representing?

> ID：14429540
> 
> 赞同：1
> 
> 时间：2013-01-20T21:27:59.627
> 
> 标签：scheme, racket, htdp

```
(big-bang ws
          (on-tick cth)
          (on-key keh)
          (on-mouse meh)
          ...) 
```

I know that the first parameter is a number and it's the described as the world state. But that just seems like vague terminology to me. Basically I don't understand what this number is really/actually supposed to represent. Two examples I've seen so far are: "countdown mechanism" and "number of pixels to be moved". What exactly is it doing?

I am working Chapter 2 on HtDP (2nd Edition)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:45:39.183

世界代表程序的当前状态。在某些程序中，整个状态可以表示为单个数字（例如，只能上下移动的 ufo）。但是很少有一个数字就足够了。要表示可以向所有方向移动的太空船的位置，您需要 x 坐标和 y 坐标。由于世界必须是单个值，因此将两个数字放入一个结构中。HtDP 中的以下章节将向您介绍结构以及如何将它们用作世界。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T08:45:06.577

我没有意识到any/c类型的第一个参数。对于初学者来说，这意味着第一个参数可以是任何类型（例如：整数、字符串、布尔值、结构、枚举等）。因此，在我正在处理的示例中，大爆炸函数使用整数作为最简单的状态形式。在使用整数作为状态时，该函数能够执行诸如操纵倒计时时钟并将火箭移动一定数量的像素之类的事情。

# qt - Why does QtWebkit depend on QtXmlPatterns in cmake?

> ID：14429544
> 
> 赞同：2
> 
> 时间：2013-01-20T21:28:18.897
> 
> 标签：qt, cmake

Using Qt 4.8.2.

When one uses the QtWebkit module in a cmake project, it seems to uselessly link with the QtXmlPatterns library. The offending line is `/usr/share/cmake-2.8/Modules/UseQt4.cmake:70`, which reads:

```
SET(QT_QTWEBKIT_MODULE_DEPENDS QTXMLPATTERNS QTGUI QTCORE) 
```

However, the webkit library does not seem to depend on the xmlpatterns library:

```
objdump -p /usr/lib/i386-linux-gnu/libQtWebKit.so | grep NEEDED
  NEEDED               libsqlite3.so.0
  NEEDED               libXrender.so.1
  NEEDED               libgstapp-0.10.so.0
  NEEDED               libgstinterfaces-0.10.so.0
  NEEDED               libgstpbutils-0.10.so.0
  NEEDED               libgstvideo-0.10.so.0
  NEEDED               libgstbase-0.10.so.0
  NEEDED               libgstreamer-0.10.so.0
  NEEDED               libgobject-2.0.so.0
  NEEDED               libglib-2.0.so.0
  NEEDED               libQtGui.so.4
  NEEDED               libQtNetwork.so.4
  NEEDED               libQtCore.so.4
  NEEDED               libpthread.so.0
  NEEDED               libX11.so.6
  NEEDED               libstdc++.so.6
  NEEDED               libm.so.6
  NEEDED               libgcc_s.so.1
  NEEDED               libc.so.6 
```

(In fact, you should notice that it depends on the QtNetwork library, which is not listed in UseQt4.cmake:70.) This causes my application to have a useless link to QtXmlPatterns. Is this a bug in UseQt4.cmake, or what am I missing?

# javascript - 2d 围绕一个点旋转 1000 个随机点

> ID：14429545
> 
> 赞同：0
> 
> 时间：2013-01-20T21:28:20.550
> 
> 标签：javascript, math, rotation, 2d

我生成 1000 个随机点，我想围绕由 x 和 y 定义的某个点旋转这些点。

我用过：

```
px = Math.cos(theta) * (px-ox) - Math.sin(theta) * (py-oy) + ox

py = Math.sin(theta) * (px-ox) + Math.cos(theta) * (py-oy) + oy 
```

但问题是点开始收敛，旋转一段时间后到旋转点。

这是javascript代码。 [http://www.kaotik.si/rotation1.html](http://www.kaotik.si/rotation1.html)

我做错了什么？

代码的迭代部分：

```
for (var i = 0; i < tocke.length; i++) 
{
    px = tocke[i]["x"];
    py = tocke[i]["y"];
    r = tocke[i]["r"];
    g = tocke[i]["g"];
    b = tocke[i]["b"];

    theta = 0.1;
    ox = centerX;
    oy = centerY;
    px = Math.cos(theta) * (px-ox) - Math.sin(theta) * (py-oy) + ox
    py = Math.sin(theta) * (px-ox) + Math.cos(theta) * (py-oy) + oy
    tocke[i]["x"] = px;
    tocke[i]["y"] = py;

    draw_point(px,py,r,g,b,1);
} 
```

**编辑：**感谢您解决问题：我确实必须更改为：

```
theta = 0.1;
ox = centerX;
oy = centerY;
tmpX = Math.cos(theta) * (px-ox) - Math.sin(theta) * (py-oy) + ox
tmpY = Math.sin(theta) * (px-ox) + Math.cos(theta) * (py-oy) + oy
tocke[i]["x"] = tmpX;
tocke[i]["y"] = tmpY;
draw_point(px,py,r,g,b,1); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:32:37.247

您在将其用于计算`px` **之前**`py`重新分配。

# c# - 模拟击键并不总是有效

> ID：14429547
> 
> 赞同：0
> 
> 时间：2013-01-20T21:28:23.887
> 
> 标签：c#, winapi, keyboard

我有一个应用程序，根据用户请求将一些键盘命令发送到另一个程序。为此，我使用[http://inputsimulator.codeplex.com/](http://inputsimulator.codeplex.com/)

问题是，目标应用程序时不时地不会收到键盘按下。

我写了一个模拟这个的测试程序，见下文。有些运行，它运行良好，有些运行它经常失败。这是什么原因造成的？我该如何预防？一种方法当然是在键盘按下之前添加延迟，但问题是延迟多长时间是合理的。理想情况下，我想避免延误。

```
private void SendKeyTest(IntPtr mainWindow, IntPtr receiverWindow)
{
    int index = 0;

    while (!_cancle)
    {
        // Set receiver application as active
        NativeMethods.SetForegroundWindow(receiverWindow);

        // Send the keyboard presses
        InputSimulator.SimulateTextEntry(string.Format("{0,5:N0}\n", index++));

        // Return to the main application
        NativeMethods.SetForegroundWindow(mainWindow);

        Thread.Sleep(500);
    }
} 
```

# android - HoloEverywhere 1.4.2 + Maven 未构建演示 Android 项目

> ID：14429549
> 
> 赞同：0
> 
> 时间：2013-01-20T21:28:28.830
> 
> 标签：android, maven-3, maven-plugin, m2eclipse, android-holo-everywhere

我在 Eclipse 中有 holoeveywhere“正在运行”，我可以成功构建“HoloEverywhere Build”，如此链接中所引用。[https://github.com/ChristopheVersieux/HoloEverywhere/wiki/Maven](https://github.com/ChristopheVersieux/HoloEverywhere/wiki/Maven)

但是，当我尝试构建“HoloEverywhere Demo Run”时，我收到了这个错误。请记住，我的目标与他完全相同，即`android:deploy`& `android:run`。我也选`Skip Tests`。我确保在安装的 jre 中引用了正确的库，并且在 jre 选项卡中为运行配置选择了最新的 jdk。

```
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building HoloEverywhere Demo 1.4.2
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- android-maven-plugin:3.5.0:deploy (default-cli) @ demo ---
[INFO] C:\Users\Akhil\Downloads\Development\adt-bundle-windows-x86\adt-bundle-windows-x86\sdk\platform-tools\aapt.exe [dump, xmltree, C:\Users\Akhil\HoloEverywhere\demo\target\demo-1.4.2.apk, AndroidManifest.xml]
[INFO] Found 0 devices connected with the Android Debug Bridge
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Skipping HoloEverywhere Demo
[INFO] This project has been banned from the build due to previous failures.
[INFO] ------------------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.801s
[INFO] Finished at: Sun Jan 20 16:22:07 EST 2013
[INFO] Final Memory: 7M/18M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal com.jayway.maven.plugins.android.generation2:android-maven-plugin:3.5.0:deploy (default-cli) on project demo: No online devices attached. -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException 
```

是不是因为我的模拟器没有启动？我试图通过 AVD Manager 本身启动模拟器，但它没有工作。我的配置有什么问题？我该如何解决？非常感谢任何提示。

谢谢！

**编辑**

这是我的 windows 环境路径变量名称：路径值：C:\Program Files\Intel\WiFi\bin\;C:\Program Files\Common Files\Intel\WirelessCommon\;C:\Program Files\Java\jdk1.7.0 _11\bin;C:\Users\Akhil\Downloads\Development\adt-bundle-windows-x86\adt-bundle-windows-x86\sdk\platform-tools

这是我的运行配置的屏幕截图。别担心，我用的是jdk。 ![HoloEverywhere 演示运行 - 运行配置](../Images/fbde5cbeb8c10d890fb98b32fcb89399.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:37:24.257

从[这里](https://stackoverflow.com/questions/12874305/android-maven-not-starting-emulator)

> 在 mvn android:deploy 之前运行 mvn android:emulator-start。maven 插件无法部署到不存在的模拟器。

# c# - 显示 2 个 datagridviews 一个依赖于另一个

> ID：14429556
> 
> 赞同：0
> 
> 时间：2013-01-20T21:29:25.347
> 
> 标签：c#, entity-framework

你好，我在 Entity Framework 2 表中做了

一个是学生，另一个是课程

我建立了一对多的关系

一个学生可以学习一门课程，而一个课程有一个或多个学生

在我的 GUI 表单中，我喜欢在一个 datagridview 中显示我的学生，并且课程（在另一个 datagridview 中）取决于所选学生。

我不知道如何表明这一点。有人可以帮我吗？

```
 SchoolContainer dbSchool = new SchoolContainer();
    private void frmSchool_Load(object sender, EventArgs e)
    {
        dgStudent.DataSource = dbSchool.Students.ToList();
        bnStudent.BindingSource = new BindingSource(dgStudent.DataSource, null);
    } 
```

这里不知道写什么：

```
 private void dgStudent_SelectionChanged(object sender, EventArgs e)
    {

        /*Dependent from selected student show the courses */
    } 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:35:18.937

您以错误的方式看待这个问题。

这个 YouTube 教程正是您想要实现的目标。您只需要通过设置行过滤器来过滤您的数据网格视图。

[http://www.youtube.com/watch?v=m_K__V0rIz4](http://www.youtube.com/watch?v=m_K__V0rIz4)

这会有所帮助。

# c++ - 如何将值从 NSMutableDictionary 复制到地图？

> ID：14429559
> 
> 赞同：1
> 
> 时间：2013-01-20T21:29:42.363
> 
> 标签：c++, objective-c, cocoa, stl, llvm

我需要接受字符串键值对的 NSMutableDictionary 并且需要复制到 stl 映射。有没有简单的方法可以做到这一点？我试过这个，但这不起作用。

```
NSMutableDictionary *dictionary = [[NSMutableDictionary alloc] init];
    [dictionary setObject:@"10" forKey:@"6"];
    [dictionary setObject:@"10" forKey:@"7"];
    [dictionary setObject:@"10" forKey:@"8"];

    NSEnumerator *enumerator = [dictionary keyEnumerator];
    NSString *key;
    while ((key = [enumerator nextObject])) {
        std::string *keyString = new std::string([key UTF8String]);
        std::string *valueString = new std::string([[dictionary objectForKey:key] UTF8String]);
        map[*keyString] = *valueString;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:45:40.277

你为什么要使用`new`？只需将结果`-UTF8String`直接传递给地图，它就会`std::string`为您将它们变成 s：

```
map[[key UTF8String]] = [[dictionary objectForKey:key] UTF8String]; 
```

您现有的`new`代码不仅没用，而且还会泄露字符串。

* * *

你也应该放弃`NSEnumerator`. 多年来，我们有更好的方法来枚举字典。具体来说，您可以使用快速枚举，也可以使用基于块的枚举。快速枚举循环如下所示：

```
for (NSString *key in dictionary) {
    map[[key UTF8String]] = [[dictionary objectForKey:key] UTF8String];
} 
```

基于块的枚举将如下所示：

```
// if map is a local variable it must be declared with __block
// like __block std::map<std::string,std::string> map;
// If it's static, global, or an instance or member variable, then it's fine as-is
[dictionary enumerateKeysAndObjectsUsingBlock:^(NSString *key, NSString *value, BOOL *stop){
    map[[key UTF8String]] = [value UTF8String];
}]; 
```

在这种情况下，我会推荐快速枚举循环，因为它不需要修改`map`.

# php - 在计划外的 mysql 表中创建报告

> ID：14429560
> 
> 赞同：0
> 
> 时间：2013-01-20T21:29:46.033
> 
> 标签：php, mysql, database, phpmyadmin

我创建了一个投票网站，用户是用来注册和投票的。我只为用户信息和评论创建了一个表。下面是表格的列和行：

用户：

列：用户名密码同意_1 原因_1 同意_2 原因_2

行：保罗测试是 NULL 否，因为我不喜欢它

我决定以这种方式制作这张表格，因为这些问题在一个（表格）中并且每个超过 100 行。再次，从表格中，如果您同意，您将不说明任何理由（这就是 null 的原因），但如果您不同意，则必须说明您的理由。我的问题是：

我如何为这样一个计划外的数据库准备标准报告？我如何计算同意的人数和拒绝的人数？对于那些说不的人，我该如何提取他们的理由？

我希望使用 php 提取和显示此报告。我正在使用 mysql 和 php。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:30:47.547

除非我误解了你，否则我认为你最好在考虑[标准化](http://en.wikipedia.org/wiki/Database_normalization)的情况下重组你的表：

```
users
- id
- email
- name

polls
- id
- name

questions
- id
- poll_id
- question
- order

answers
- id
- question_id
- user_id
- answer 
```

然后，希望您的要求和您需要的查询会变得更加清晰。例如，要查询对问题 #34 给出每个唯一答案的人数：

```
SELECT
    answer,
    count(*) AS 'people'
FROM answers
WHERE question_id = 34
GROUP BY answer 
```

将返回如下内容：

```
answer    people
yes       15
no        17
null      3 
```

# sql - SQL Select：获取两列或多列相同的行

> ID：14429561
> 
> 赞同：2
> 
> 时间：2013-01-20T21:29:49.497
> 
> 标签：sql, sql-server, tsql

我已经有一段时间不用处理 SQL 查询了，看起来很简单的查询让我发疯了。我有一个交易表，我试图根据各种标准从中选择重复。相关表结构如下：

```
[Transaction]
* ID          int
  Transacted  datetime
  Name        nvarchar(50)
  Description nvarchar(4000)
  size        bigint 
```

从这个表中，我需要找到名称/大小的重复项，并报告名称具有相同大小事务的所有记录，即使日期和描述不同。我可以通过以下名称获得计数：

```
SELECT   Name, COUNT(Name) AS Count
FROM     Transaction
GROUP BY Name 
```

然后我可以对其进行内部连接以获取其余数据：

```
SELECT data.ID, data.Transacted, data.Name, data.Description, data.Size, counts.Count
FROM (SELECT  Name, COUNT(Name) AS Count
      FROM  Transaction
      GROUP BY Name) AS counts 
INNER JOIN Transaction AS data ON counts.Name = data.Name
WHERE     (counts.Count > 1)
ORDER BY  data.Name, data.Transacted 
```

但显然这只是给我重复名称的交易 - 而不是重复名称和大小的地方。

我正在寻求帮助完成这篇文章，以便我报告所有数据，其中行显示相同名称和相同大小的重复。我可以轻松地将两列中的数据合并为一个结果并与之进行比较，但我不确定这是最佳方法。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:32:42.923

将其更改为

```
SELECT   Name, Size, COUNT(Name) AS Count
FROM     Transaction
GROUP BY Name, Size Having COUNT(Name) > 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:34:06.050

问题中的代码表明您还需要其他列。要返回所有重复的行，`Name, size`您可以使用

```
WITH CTE
     AS (SELECT *,
                COUNT(*) OVER (PARTITION BY Name, size) AS Cnt
         FROM   [Transaction])
SELECT ID,
       Transacted,
       Name,
       Description,
       size
FROM   CTE
WHERE  Cnt > 1 
```

# signalr - 试图查看 JabbR (signalR)

> ID：14429577
> 
> 赞同：0
> 
> 时间：2013-01-20T21:32:04.453
> 
> 标签：signalr

我尝试登录[http://jabbr.net/](http://jabbr.net/)或[http://jabbr-redis.apphb.com/](http://jabbr-redis.apphb.com/)以查看信号器是如何工作的，当我尝试 JabbR 登录时，我总是收到相同的消息。谁能帮我弄清楚我到底发生了什么以及如何尝试 Jabbr ...

![登录错误](../Images/708a49a9a84b5ab7255746dbe6112f56.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T23:04:38.890

这不是一个真正的 SignalR 问题。问题是 JabbR 的 Janrain 帐户已超过免费配额，因此他们已禁用该帐户，除非有人开始为此付费。

我相信@dfowler 正在努力摆脱 Janrain 并为 JabbR 进行自己的身份验证。

# ruby-on-rails - Ruby on Rails HTML 输出额外字符

> ID：14429586
> 
> 赞同：-2
> 
> 时间：2013-01-20T21:33:05.673
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

有人可以告诉我多余的字符是从哪里来的吗？

这是输出的样子：[http ://screencast.com/t/f0sgNPzMu](http://screencast.com/t/f0sgNPzMu)

我不太明白所有额外字符的来源。

这是我的文件：

```
 ##application.html.erb

    <!DOCTYPE html>
    <html>
    <head>
      <title><%= title %></title>
      <%= javascript_include_tag "application" %>
      <%= render 'layouts/stylesheets' %>
      <%= csrf_meta_tags %>
     </head>
     <body>
        <div class="container">
          <%= render 'layouts/header' %>
          <section class="round">
            <%= yield %>
          </section>
          <%= render 'layouts/footer' %>
          <%= debug(params) if Rails.env.development? %>
        </div>
      </body>
     </html>

##_header.html.erb
    <header>
     <%= link_to logo, root_path %>
     <nav>
       <ul>
        <li><%= link_to 'Home', root_path %></li>
        <li><%= link_to 'Help', help_path %></li>
        <li><%= link_to 'Sign in', '#' %></li>
       </ul>
     </nav>
     </header> 
```

## 主页.html.erb

```
 <h1>Sample App</h1>
 <p>
 This is the home page
 </p>
 <%= link_to "Sign up now!", signup_path, :class => "signup_button round" %> 
```

这是 HTML 页面源代码：

```
 </head>
     <body>
        <div class="container">
          <header>
       <a href="/"><img alt="Sample App" class="round" src="/assets/logo.png" /></a>
       <nav>
       <ul>
         <li><a href="/">Home</a></li>
         <li><a href="/help">Help</a></li>
         <li><a href="#">Sign in</a></li>
       </ul>
     </nav>
     </header>

          <section class="round">
            <h1>Sample App</h1>
      <p>
       This is the home page
      </p>
      <a href="/signup" class="signup_button round">Sign up now!</a>

          </section>
          <footer>
      <nav>
       <ul>
        <li><a href="/about">About</a></li>
        <li><a href="/contact">Contact</a></li>
       <li>
        <a href="http://news.railstutorial.org/news">News</a></li>
       <li>
        <a href='http://rails.tutorials.org'>Rails Tutorial</a>
      </li>
      </ul>
      </nav>
      </footer>

          <pre class='debug_dump'>--- !ruby/hash:ActiveSupport::HashWithIndifferentAccess
controller: pages
action: home
          </pre>
        </div>
        </body>
        </html> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:59:14.803

去除那个

```
<%= debug(params) if Rails.env.development? %> 
```

行，您的调试信息不​​应再可见

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T23:34:51.227

我认为，问题可能出在 CSS 中。

检查您是否为链接激活了内容属性。

也许这有帮助：[http](http://davidwalsh.name/optimize-your-links-for-print-using-css-show-url) ://davidwalsh.name/optimize-your-links-for-print-using-css-show-url或[http://www.alistapart.com/articles/improvingprint](http://www.alistapart.com/articles/improvingprint)

# javascript - 谷歌云端硬盘文件元数据读取

> ID：14429587
> 
> 赞同：1
> 
> 时间：2013-01-20T21:33:10.437
> 
> 标签：javascript, google-chrome-extension, google-drive-api

我正在尝试使用 Google Picker 在我的 web 应用程序上显示谷歌驱动器选择的图像。为了获取图像的网络内容，我需要读取元数据。但是我收到一个类似这样的错误

```
Uncaught TypeError: Cannot read property 'files' of undefined localhost:169
printFile localhost:169
pickerCallback localhost:156
K.Ld default.I.js:103
_.zc cb=gapi.loaded_0:57
_.Ib 
```

这是我正在使用的代码

```
 function printFile(fileId) {
    var request = gapi.client.drive.files.get({
        'fileId': fileId

        });
      request.execute(function(resp) {
        console.log('Title: ' + resp.title);
        console.log('Description: ' + resp.description);
        console.log('MIME type: ' + resp.mimeType);
      });
     } 
```

一旦我获得图像的元数据，我将使用 Webcontent 在 webapp 上显示图像，但它只是没有获得元数据。请告诉我如何解决此错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T00:53:22.013

使用另一段代码让它工作：

```
 function printFile(fileId) {
    var theID = fileId;
    var request = gapi.client.request({
        'path': '/drive/v2/files/'+theID,
            'method': 'GET',
        });
      request.execute(function(resp) {
        console.log('Title: ' + resp.title);
        console.log('Description: ' + resp.description);
        console.log('MIME type: ' + resp.mimeType);
        console.log('WebContent: ' + resp.webContentLink);
             });
    } 
```

# image - 设置图像视图的持续时间

> ID：14429590
> 
> 赞同：0
> 
> 时间：2013-01-20T21:33:46.770
> 
> 标签：image, duration

当我说没有关于这个话题的信息时，我没有撒谎。也许我没有使用正确的搜索词，但基本上我希望我的图像视图加载一段设定的持续时间，比如 5 秒。

或者，如何通过点击当前屏幕上的任意位置来弹出视图？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T07:40:46.853

我正在回答我自己的问题，所以我可以发布我的代码。

。H

```
IBOutlet UIImageView *lionCloseUp;

-(IBAction)lion; 
```

.m

```
-(IBAction)lion {
UIImage *lion = [UIImage imageNamed:@"lion-closeup.jpg"];
[lionCloseUp setImage:lion]; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T12:57:29.783

把它分解。要让图像消失，您需要使用计时器。所以研究如何在Objective-C中实现定时器。（注意：有很多关于计时器的信息，所以*不要*只是转身问这个问题，至少在你尝试过之前不要。）

（接下来，您需要定义“弹出视图”的含义。如果您的字面意思是这样，那么您可能想要使用导航控制器。同样，如果您寻找它，那里有很多信息，但是预计将花费几天的时间进行实验。）

（另一方面，如果您只想让图像消失，请将其设置为“隐藏”。）

# ios - 在每个请求中重新授权应用程序

> ID：14429594
> 
> 赞同：0
> 
> 时间：2013-01-20T21:34:15.660
> 
> 标签：ios, facebook-ios-sdk

我能够正确配置 Facebook 身份验证。为了测试我的应用程序的失败流程，我只是不允许应用程序授权 FB 用户。`FBSessionStateClosedLoginFailed`它按预期调用，这很好。

当我再次需要为用户授权该应用程序时，就会出现问题。即使我添加了`[FBSession.activeSession closeAndClearTokenInformation];`.

我相信应该有一种方法可以有问题地向用户提示授权对话框，因为这是一个登录功能。

但是，在第一次未经授权的访问之后，我永远无法授权该用户。只是它返回，

> 错误域=com.facebook.sdk 代码=2“操作无法完成。（com.facebook.sdk 错误 2。）”UserInfo=0x1c5e4430 {com.facebook.sdk:ErrorLoginFailedReason=com.facebook.sdk:ErrorLoginFailedReason }

为了重置东西，我删除了应用程序，删除了派生数据，重新设置了手机等。对我来说还没有任何效果。我确信我使用 FB SDK 的方式是正确的，因为我将它用于我的应用程序的免费版本。同样的东西被复制到这里。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:43:29.590

如果您使用的是 Facebook SDK，您在打电话吗？

```
[appDelegate openFacebookSessionWithAllowLoginUI:YES]; 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T01:14:10.023

您是否在 IOS6 上运行您的应用程序？如果是这样，您是否使用 iPhone 应用程序的捆绑 ID 配置了 Facebook 应用程序（在 facebook 上）？

# api - 如何使用 Heroku 和 MongoLab 使用 Twitter Streaming API？

> ID：14429595
> 
> 赞同：2
> 
> 时间：2013-01-20T21:34:20.440
> 
> 标签：api, mongodb, twitter, heroku, mlab

我正在寻找使用 Twitter Streaming API 来抓取所有推文以获取一些关键字并将它们存储在数据库中。我宁愿不在本地运行工作流，所以我一直在寻找将 API 与 Heroku 和 MongoLab 一起使用的方法。

我发现这个例子（使用红宝石）让我非常接近我想要做的事情：http: [//www.jefflinwood.com/2011/08/deploying-tweeter-keeper-on-the-heroku-cedar-stack /](http://www.jefflinwood.com/2011/08/deploying-tweeter-keeper-on-the-heroku-cedar-stack/) http://github.com/joslynesser/mongo-twitter-streaming

不幸的是，这个例子停止了对我的工作。似乎对我正在使用的 twitter gem 的支持已被删除。我尝试从第一步返回并再次安装所有内容，但是，当我尝试将文件推送到 Heroku 时，我不断收到消息：“在任何来源中都找不到 twitter-1.6.0”

我已经更新了 Gemfile 以引用每个 twitter 相关 gem 的最新版本，并且还运行了 bundle update。我似乎找不到 twitter-1.6.0 的任何其他依赖项，但仍然得到那个消息。

我很难在网上找到其他类似的例子来工作，但这似乎是一件很常见的事情。任何帮助都将不胜感激，无论是解决上述问题还是提供我可以使用的其他代码的线索。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T15:31:45.443

我已经成功使用 Ruby 模块[“tweetstream”](https://github.com/intridea/tweetstream)连接到流 API，它有很好的文档并支持更新的 v1.1 OAuth 连接协议。

如果有帮助，我有[一些代码](https://github.com/jhrrsn/tw_rb/blob/master/stream.rb)（GitHub）使用它来解析推文并将其写入本地 MongoDB 实例。

# macos - 在显示器休眠时使用启动代理打开 OS X 磁盘映像

> ID：14429596
> 
> 赞同：3
> 
> 时间：2013-01-20T21:34:24.993
> 
> 标签：macos, unix, launchd

我创建了一个`launchd`代理，它每天凌晨 2 点 45 分打开一个不受密码保护的稀疏磁盘映像（并安装其单独的卷），以准备备份软件写入该卷。代理的`launchd`plist 文件保存在`~/Library/LaunchAgents/`. 以下是 plist 文件的参数：

```
Label: my.DiskImageOpener
KeepAlive: NO
RunAtLoad: NO
StartCalendar:
    Hour: 2
    Minute: 45
ProgramArguments:
    hdiutil
    attach
    /path/to/MyDiskImage.sparseimage 
```

只要计算机的显示器处于唤醒状态，代理就会像宣传的那样工作，打开磁盘映像并在启动代理中指定的时间安装其卷。另一方面，如果显示器在启动代理中指定的时间处于睡眠状态，则磁盘映像将无法打开，直到显示器从睡眠中唤醒（即使是几个小时后），此时磁盘映像会立即打开并安装它的卷。如果我将`hdiutil attacj /path/to/MyDiskImage.sparseimage`命令替换为`open /path/to/MyDiskImage.sparseimage`，或者将命令放在启动代理执行的单独的可执行 shell 脚本中，也会发生同样的现象。

当显示器处于休眠状态时，如何让启动代理打开磁盘映像并安装其卷？

我正在使用运行 OS X 10.8.2 Mountain Lion 的 MacBook Pro 笔记本电脑。感谢您对此问题的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T13:34:34.433

我想我偶然发现了解决方案。只要我在“节能器”首选项窗格中将计算机设置为永不休眠，那么即使显示器处于休眠状态和/或硬盘驱动器尽可能设置为休眠状态，启动代理也会成功运行，打开磁盘映像并安装卷。令人费解的是，如果计算机设置为永不休眠以外的任何设置（即使它实际上可能是醒着的），启动代理就会失败。

# iframe - Chrome 扩展：从弹出窗口中的 iframe 中创建选项卡

> ID：14429598
> 
> 赞同：3
> 
> 时间：2013-01-20T21:34:32.527
> 
> 标签：iframe, google-chrome-extension, tabs, popup

在我的弹出页面中，我有一个 iframe 标签，里面有一个按钮。单击此按钮时，将调用包含在 iframe 脚本中的函数。此函数包含对 的调用`chrome.tabs.create({ url: "..."});`，但我不断收到*“Uncaught TypeError: Cannot call method 'create' of undefined”。*我想原因是我在 iframe 中，而不是在弹出页面本身中。

有没有办法克服这种晦涩难懂的问题并从 iframe 中创建一个新选项卡？

**编辑**

这是我的代码。

以下内容被加载到弹出页面的 iframe 中：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" type="text/css" href="style/frame_style.css" media="screen" />
  <script src='jquery-1.8.3.js'></script>
  <script src='scripts/frame_functions.js'></script>
</head>

<body>
  <div>
    <button value="Click to open Google in a new tab" class='new_tab_bt'></button>
  </div>
</body>
</html> 
```

frame_functions.js：

```
$(document).on("click", '.new_tab_bt', function(){
  openNewTab(); 
});

function openNewTab()
{
chrome.tabs.create({ url: "https://www.google.com" });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T08:33:52.687

您的代码无需任何更改即可工作，我已添加工作代码作为参考；您的目标源 html 页面在哪里，您是`iframe`如何从浏览器操作弹出窗口中引用它的？如果这不能解决分享，您是如何`iframe`从浏览器操作弹出窗口中引用您的。

# 工作版本

### 清单.json

简单的代码，注册`browser action`。

```
{
    "name": "Iframe Holder",
    "description": "http://stackoverflow.com/questions/14429598/chrome-extension-create-tab-from-within-an-iframe-in-popup",
    "version": "1",
    "manifest_version": 2,
    "browser_action": {
        "default_popup": "popup.html",
        "default_title": "Iframe."
    }
} 
```

### popup.html

`popup`在浏览器操作中包含目标页面。

```
<html>

    <body>
        <iframe width="300" height="300" src="iframe.html"></iframe>
    </body>

</html> 
```

### iframe.html

使用您的代码并消除不相关的 css 文件等

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <script src='jquery.js'></script>
        <script src='iframe.js'></script>
    </head>

    <body>
        <div>
            <button value="Click to open Google in a new tab" class='new_tab_bt'></button>
        </div>
    </body>

</html> 
```

### iframe.js

使用您的代码没有修改

```
$(document).on("click", '.new_tab_bt', function () {
    openNewTab();
});

function openNewTab() {
    chrome.tabs.create({
        url: "https://www.google.com"
    });
} 
```

# jquery - 自定义 jQuery 小部件在 Heroku 上不起作用

> ID：14429600
> 
> 赞同：0
> 
> 时间：2013-01-20T21:34:33.193
> 
> 标签：jquery, jquery-ui, heroku

我使用[小部件工厂模式](http://ajpiano.com/widgetfactory/#slide1)创建了一个小的 jQuery 小部件。它在本地工作得很好，但是当将代码推送到 Heroku 时，它就不再工作了。

如果我创建一个如下所示的小型测试应用程序：

```
(function ($, undefined) {
$.ui.mytest = {
  _create: function () {
      alert('test');
  },
  destroy: function () {
      // if using jQuery UI 1.8.x
      $.Widget.prototype.destroy.call(this);
      // if using jQuery UI 1.9.x
      //this._destroy();
  },
  options:{}
};
$.widget("ui.mytest", $.ui.mytest);

})(jQuery); 
```

它将在本地打印警报，但在生产中，当资产编译完成时，我收到以下错误：

```
Uncaught TypeError: Cannot read property 'length' of undefined application-2ecb4e7c4dcb5be5c5d9884cdb6c266c.js:14
Uncaught TypeError: Object [object Object] has no method 'mytest' 
```

奇怪的是，我在生产中可以调用`$.ui.mytest`我的控制台并且它确实存在。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T02:36:32.407

您是否在开发环境中包含任何其他 jQuery UI 小部件但未在生产环境中包含任何其他小部件，就像您在尝试定义之前没有使用 UI 命名空间的任何其他小部件一样，`$.ui.mytest`那么它将出错，因为`$.ui`不会被定义。命名空间仅在您调用`$.widget`.

将该对象作为第二个参数直接传递给您会更有意义，`$.widget()`因为您基本上是在尝试将成为小部件原型的内容存储在最终将成为构造函数名称空间的内容下。例如：

```
$.widget('ui.mytest', {
    _create: function () {
        alert('tesst');   
    }
}); 
```

上面将自动创建一个构造函数，如下所示：

```
new $.ui.mytest(options, element); 
```

但是您不太可能像那样直接实例化它，因为小部件工厂还定义了一个 jQuery 插件，它是上述内容的包装器。

# php - php变量导致while循环在无限循环中显示数据

> ID：14429606
> 
> 赞同：2
> 
> 时间：2013-01-20T21:35:16.910
> 
> 标签：php, loops, pdo, while-loop

我对这些代码片段在 while 循环中显示结果的不同之处感到困惑。第一段代码完美运行，但第二段显示结果，但在无限循环中这样做，只是重复结果。有人可以向我解释为什么吗？

```
$stmt = $db_conn->prepare($sql);

$stmt->execute(array("Lorna", 3));

while($result = $stmt->fetch()){
    echo $result["name"] . "<br />" . $result["description"] . "<br />";        
} 
```

如果我将 $stmt->fetch() 放入名为 $data 的变量中并尝试传递它而不是仅将 $stmt->fetch() 放入 while 循环中，我会得到一个无限循环。

```
$stmt = $db_conn->prepare($sql);

$stmt->execute(array("Lorna", 3));

$data = $stmt->fetch();

while($result = $data){
    echo $result["name"] . "<br />" . $result["description"] . "<br />";        
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:38:40.730

If 是[`fetch()`](http://php.net/manual/en/mysqli-stmt.fetch.php)使行前进的调用。

**情况1**

```
while($result = $stmt->fetch()){
    //every iteration executes fetch
    //advances it by one row
    //turns to false when no more rows
} 
```

**案例2**

```
$data = $stmt->fetch();
//now at first row
while($result = $data){
    //always at first row 
    //always evaluates to true (no calls to fetch)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T21:38:55.827

在第一个代码片段中，每次`while`调用时，查询结果指针都会移动到新行。最终指针将到达结果集的末尾，`$stmt->fetch()`并将返回 false 并结束循环。

在第二个循环中，您只迭代到下一行一次 - 在循环之前。然后循环将一遍又一遍地迭代同一个循环，因为没有任何变化，因此循环条件永远不会返回 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T21:39:37.157

第一个循环检查从函数返回的值，该值可能为空，导致循环结束。

第二个循环只是做一个分配。

# c# - 获得最小第 N 个元素的有效方法

> ID：14429609
> 
> 赞同：1
> 
> 时间：2013-01-20T21:35:53.160
> 
> 标签：c#, sorting, time-complexity

给定一个字符串，有什么有效的方法可以

*   返回其中的第 N 个最低字符（ASCII 方式）？
*   返回第 N 个 lowset char* *s* * 吗？

我曾想过使用插入排序对 N 次迭代进行排序，或者对快速排序进行排序，其中枢轴位于第 N 个位置，但我在分析时间复杂度时遇到了问题。还有其他更有效的方法吗？

解决方案是什么，它不是一个字符串，而是一个小数列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:42:12.577

如果您的字符串是 ASCII，您可以使用[计数排序](http://en.wikipedia.org/wiki/Counting_sort)样式算法来完成。创建一个包含 256 个计数器的数组，遍历字符串，并为在字符串中找到的每个字符的代码增加一个计数器。现在从零开始遍历数组，累积到目前为止您看到的计数。当为字符添加计数器`ch`导致您的累积结果交叉时，如果字符串已排序`N`，您知道这`ch`是第- 个字符。`n`该算法是`O(N)`，其中`N`是字符串中的字符数。这是构建计数数组所需的时间。

# qt - 使用滚动条拦截 QListWidget 的鼠标滚轮事件

> ID：14429613
> 
> 赞同：2
> 
> 时间：2013-01-20T21:36:27.020
> 
> 标签：qt, events, event-handling, mouseevent

我有`QListWidget`一些内容和活动滚动条。我想在它之前收到它的轮子事件，以便我可以根据需要做一些事情。我尝试在上面实现`eventFilter`和安装它`QListWidget`，但无济于事：如果它没有被滚动区域消耗，我只会收到所需的事件，即，如果它已经在鼠标滚轮旋转方向上滚动到它的极限。

我做错什么了吗？还是我应该做其他事情来正确拦截事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T12:33:04.507

如果我理解正确，您只需要从 QListWidget 继承一些类并像这样实现 wheelEvent 处理程序：

```
class EListWidget : public QListWidget
{
public:
    EListWidget(QWidget *parent);

private:
    virtual void wheelEvent(QWheelEvent *event);
}; 
```

...

```
void EListWidget::wheelEvent(QWheelEvent *event)
{
    // to do any processing here if you want to do something before scrolling

    // call base implementation
    QListWidget::wheelEvent(event);

   // to do some processing after scrolling.
} 
```

小心 event->isAccepted() 状态。

您还可以连接到滚动条（QAbstractSlider）插槽：

> void QAbstractSlider::sliderMoved ( int value ) [信号] 当sliderDown 为真且滑块移动时发出此信号。这通常发生在用户拖动滑块时。该值是新的滑块位置。即使在跟踪关闭时也会发出此信号。另请参见 setTracking()、valueChanged()、isSliderDown()、sliderPressed() 和 sliderReleased()。

# macos - $PATH 优先级没有被遵循？

> ID：14429615
> 
> 赞同：3
> 
> 时间：2013-01-20T21:36:38.547
> 
> 标签：macos, unix

不完全确定这是否应该在这里或另一个堆栈交换，但这里是：

从我的 shell 中查看以下输出：

```
$ echo $PATH
/opt/local/bin:/opt/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin

$ which vim
/usr/bin/vim

$ /opt/local/bin/vim --version
VIM - Vi IMproved 7.3 (2010 Aug 15, compiled Jan  9 2013 03:19:25)
MacOS X (unix) version
Included patches: 1-244, 246-762

$ vim --version
VIM - Vi IMproved 7.3 (2010 Aug 15, compiled Aug 22 2012 15:36:46)
Compiled by root@apple.com 
```

如您所见， /opt/local/bin/vim 应该优先于`which vim`$PATH 定义，但它没有。

有人有线索吗？

* * *

最后，我注意到我的`export PATH=....`.zshrc 中有一个。因此，如果有人有同样的问题，请先检查；）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T21:41:51.160

你在这个 shell 会话期间安装`vim`了吗？`/opt/local/bin`Bash（可能还有其他 shell）将路径查找的结果保存到哈希表中。您可以通过询问来验证这一点`type vim`。这就像`which`除了它是一个内置函数，如果它们存在，它将从这个哈希表返回结果。更有用的是，`type`精确返回 shell 将执行的内容。

您还可以使用`hash`内置函数专门查询保存的查找。用于`hash -t vim`查看哈希表中的条目是什么`vim`，并用于从该哈希表`hash -d vim`中删除，以便 shell下次再次`vim`查找它。`$PATH`

* * *

我刚刚重新检查了您的原始描述，发现`which vim`实际上返回了`/usr/bin/vim`。由于`which`不使用我上面描述的哈希表，这实际上表明您的问题有所不同。也许您`$PATH`在第一个组件中有某种隐形字符？

# linux - cookie 是如何工作的

> ID：14429616
> 
> 赞同：-1
> 
> 时间：2013-01-20T21:36:44.210
> 
> 标签：linux, http, cookies, curl

我正在尝试通过 curl 发送发布请求，所以我跑了

```
curl --cookie /tmp/cookies.txt --cookie-jar /tmp/cookies.txt --data "name=value" http://www.mysite.com > post_request.txt 
```

我将在我的 chrome 控制台中找到的 cookie 存储在 /tmp/cookies.txt 中。在后者中有一个名称和一个值。我应该使用特定格式在 /tmp/cookies.txt 中写入 cookie 参数吗？（因为我只放了值，没有用）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:50:26.807

查看[curl](http://curl.haxx.se/docs/manpage.html)的手册页，它说：

> 要从中读取 cookie 的文件的文件格式应该是纯 HTTP 标头或 Netscape/Mozilla cookie 文件格式。

查找您发现的 Mozilla 格式：

[http://xiix.wordpress.com/2006/03/23/mozillafirefox-cookie-format/](http://xiix.wordpress.com/2006/03/23/mozillafirefox-cookie-format/)

```
<domain> <TRUE|FALSE> <PATH> <TRUE|FALSE> <TIMESTAMP> <NAME> <VALUE> 
```

（制表符分隔）

> 域：设置 & 随后可以读取 cookie 的域。这可能包括子域，例如，.google.com 意味着 local.google.com、news.google.com、whatever.google.com 可能会根据下一个标志读取 cookie。
> 
> 标志：TRUE 或 FALSE，是否该域下的所有机器都可以读取 cookie 的信息。
> 
> 路径：cookie有效的域下的根路径。如果这是 /，则 cookie 对整个域都有效。
> 
> 安全标志：TRUE 或 FALSE，是否需要安全连接 (HTTPS) 才能读取 cookie。
> 
> 过期时间戳：cookie 设置为过期时的“Unix 时间”（以秒为单位）。
> 
> 名称：cookie 正在存储/保存的值的名称。
> 
> 价值：价值

（当然，您也可以只使用所述的普通 HTTP 标头。）

# php - 重写字符串中的多个链接 URL

> ID：14429617
> 
> 赞同：0
> 
> 时间：2013-01-20T21:36:44.813
> 
> 标签：php, preg-replace, replace

我有一个包含多个 HTML 链接的长字符串，如下所示：

```
<a href="example.com">My Link></a> 
```

或者

```
<a href="http://example2.com">A different Link</a> 
```

等等

我需要用 PHP 重写这些链接，以便它们通过我的重定向器发送流量，这样我就可以告诉用户他们现在要离开外部域等。我的重定向器位于 mydomain.com/leaving.php。我想要做的是将这些链接重写为如下内容：

```
<a href="http://www.mydomain.com/leaving.php/[URL ENCODED LINK FROM ABOVE]">My Link> 
```

由于并非所有网址都以 http:// 开头，因此我认为我需要首先从所有 href 链接中删除这些网址。

如何 grep 正确的 HTML 链接（忽略图像 src）和 url_encode 它们，并将它们放回原始字符串中。

编辑：为了清楚起见，我不是在寻求重定向部分的帮助，只是在有时有 http 时如何替换大字符串中的多个 URL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:41:39.737

这只是一个伪代码，您可以根据需要对其进行修改。

您首先需要一个包含以下内容的 .htaccess 文件；

```
RewriteEngine On
RewriteRule ^leaving/(.*)$ leaving.php?url=$1 [L] 
```

在`leaving.php`;

```
$url = trim(urldecode($_GET['url']));
// check url is exists
if ($url == '') {
    header('Location: http://www.mydomain.com/');
    exit;
}
// add http if needs
if (substr($url, 0, 7) != 'http://') {
    $url = 'http://'. $url;
}

// send it to target
header('Location: '. $url);
exit; 
```

更新：

如果你在服务器端尝试这个，它是没用的，因为如果 PHP 发送了一次输出，那么你就不能再使用`preg's`了。因此，如果想在客户端执行此操作，以下代码或类似的东西会对您有所帮助。

```
var links = document.getElementsByTagName("a"),
    link, href, i = 0;
while (link = links[i++]) {
    // get real url applying getAttribute with "2" params
    if ((href = link.getAttribute("href", 2)) !== null
            // skip non-href links
            && href.charAt(0) !== "#") {
        // add http if not exists
        if (href.substring(0, 7) !== 'http://') {
            href = "http://"+ href
        }
        link.href = "http://www.mydomain.com/leaving/"+ href;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T22:54:54.983

使用正则表达式编辑 XML 容易出错且笨拙，但周围有一些方便的工具。

编辑 HTML 最简单最可靠的方法是使用 DOM 和 XPath。找到所有链接并重写它们。

可能您想添加一些过滤器来排除内部 URL。您可以在 XPath 查询（可能更优雅、更快，因为需要处理的结果更少）或`foreach`循环中执行此操作。

```
<?php
    $html = <<< HTML
<p>
<a href="example.com">My Link>
<a href="http://example2.com">A different Link</a>
</p>
HTML;

    $dom = new DOMDocument;
    $dom->loadHTML($html);

    // Find all anchor elements containing a href attribute
    $xpath = new DOMXPath($dom);
    $anchors = $xpath->query('//a[@href]');

    // Replace all href attributes with redirection url
    foreach ($anchors as $anchor)
        // Possibly filter internal URLs?
        $anchor->setAttribute('href', 'http://www.mydomain.com/leaving.php/'.urlencode($anchor->getAttribute('href')));

    // Save html with replaced links
    $newHtml = $dom->saveXml($dom->documentElement);
?> 
```

# css - 为什么 DIVS 会随着窗口尺寸的减小而崩溃？

> ID：14429619
> 
> 赞同：1
> 
> 时间：2013-01-20T21:36:54.380
> 
> 标签：css, html, text, collapse

我不知道为什么我的 HTML 页面中的文本在菜单中折叠，在这里你可以在[jsfidle](http://jsfiddle.net/KXDZb/)中找到我的页面。

我的一些 HTML 文件：

```
<div class="menu">
    item 1
    item 2
    ...
</div>
<div class="content">
    text text text
</div> 
```

我的一些 CSS 文件：

```
.menu{
float: left;
padding-top: 100px;
width: 20%;
position: relative;
}
.content{
float: right;
padding-top: 100px;
width: 80%;
color: #dddddd;
position: relative;
} 
```

宽度％是CSS问题吗？或者是其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T21:42:31.780

您正在定义`.menu`and `.content`as being`20%`和*窗口*`80%`的宽度- 您的容器大小正确。

 *但是，您在节点上设置了宽度`150px`和填充，这会导致它们扩展到div 之外（如果窗口太小）`30px``.grezzo``.menu`

尝试删除宽度`.grezzo`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:47:25.623

这是因为您的左侧 div 的内容比容器更突出。因此，您的 text(right) div 实际上就像它应该的那样正对左 div，但是按钮从左 div 延伸出来。

要解决这个问题，您要么需要调整按钮图像的大小，要么让左侧 div 自动调整大小以容纳它们，而右侧 div 只占用所有剩余空间，如此[处](https://stackoverflow.com/questions/1032914/how-to-make-a-div-to-fill-a-remaining-horizontal-space-a-very-simple-but-annoyi)所述。

希望这对你有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T21:51:09.303

删除您`float: left;`的菜单元素。此外，如果您删除您`width`的`.content`and `.menu`，它们的文本将不会覆盖菜单。*

# php - 用于 PHP 的 Apache 配置解析器

> ID：14429621
> 
> 赞同：3
> 
> 时间：2013-01-20T21:37:16.747
> 
> 标签：php, apache

我正在寻找一些解析 Apache 配置文件的 PHP 实用程序，类似于这个 Perl 的模块： http://metacpan.org/pod/Apache:: [ConfigParser](http://metacpan.org/pod/Apache::ConfigParser)

有什么线索吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T21:56:55.340

[PEAR::Config](http://pear.php.net/package/Config/redirected)支持 Apache 风格的配置文件。
看看手册[http://pear.php.net/manual/en/package.configuration.config.avail-container.apache.php](http://pear.php.net/manual/en/package.configuration.config.avail-container.apache.php)

```
$conf = new Config();
$root = $conf->parseConfig("/etc/apache2/httpd.conf", "apache");
print current($root->getItem('directive', 'Listen'))->content; 
```

或类似的东西..

# c# - 如何切换表格高度？

> ID：14429625
> 
> 赞同：0
> 
> 时间：2013-01-20T21:37:34.413
> 
> 标签：c#, .net, winforms

我有一个表单和一个按钮，我如何切换窗口高度，所以当我第一次点击按钮时，窗口高度会增加166，当我第二次点击按钮时，高度将减少 166。

抱歉这个问题很愚蠢，但我真的很困惑；谢谢

```
 private void button2_Click(object sender, EventArgs e)
    {

        int  FormHeight = this.Height;
        int  FormHeightBefore = FormHeight;

        if (this.Height == FormHeightBefore)
        {//toggle off 
            this.Height = this.Height + 166;
        }
        else { 
        //toggle on
            this.Height = this.Height - 166;
        }

    } 
```

我尝试使用上面的代码，但它不起作用，每当我按下按钮时，表单高度仍在增加

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:40:47.703

注意你的前两行：

```
int  FormHeight = this.Height;
int  FormHeightBefore = FormHeight; 
```

您实际上*总是*将两个变量都设置为**当前**高度......

所以总是调用相同的 if 语句......

这将正常工作：

```
const int heightOffset = 166;
int  FormHeightBefore = this.Height
private void button2_Click(object sender, EventArgs e)
{
    if (this.Height == FormHeightBefore)
    {//toggle off 
        this.Height += heightOffset ;
    }
    else
    { 
       //toggle on
        this.Height = FormHeightBefore;
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:45:41.493

你可以做这样的事情。

```
bool isExpanded;

private void button2_click(object sender, EventArgs e) 
{
    Height += (isExpanded ? -166 : 166);

    isExpanded = !isExpanded;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T21:49:14.370

```
partial class Form1 {
    public int FormHeight;

    private void button2_Click(object sender, EventArgs e) {
        this.Height += (FormHeight = (FormHeight > 0 ? -1 : 1) * 166);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T21:41:02.297

您的代码失败，因为每次您输入该方法（通过按钮的点击），它会检查*当前*的表单高度并认为它是“初始高度”。

执行以下操作：

```
private readonly int initialHeight;

public Form1()
{
    InitializeComponent();
    initialHeight = this.Height;
}

private void button2_Click(object sender, EventArgs e)
{

    if (this.Height == initialHeight)
    {   // increase height
        this.Height = initialHeight + 166;
    }
    else { 
        // decrease height
        this.Height = initialHeight;
    }
} 
```

请注意，初始`initialHeight`声明*超出*了按钮单击事件的范围。

# php - PHP 邮件命令

> ID：14429627
> 
> 赞同：-3
> 
> 时间：2013-01-20T21:37:47.750
> 
> 标签：php, sql

我遇到了一个 PHP 邮件命令的问题当我去处理它时，它只是返回一个错误页面..（不是 SQL）

到目前为止，这是我的代码

```
$getdisputes = mysql_query("SELECT * FROM `disputedetails` WHERE `invno` = '$invoiceno'") or die(mysql_error());
//send email
$to = "".$disputeemail."";
$subject = "Dispute submitted";
$from = "NO_REPLY@noreply.dassdf.com"
$headers = "From:" . $from;
$message1 = "Store ".$username. " has submitted a dispute on invoice number ".$invoiceno;
// foreach line in disputedetails file for that invoice number, add to $message item, desc and 
while ($info = mysql_fetch_array($getdisputes)) {
    $message = $message1 + "\n <b>Invoice Number: </b>".$info['invno']." <b>Item ID:</b> ".$info['itemid']." <b>Description: </b>".$info['description']." <b>Disputed Quantity:</b> ".$info['disputeqty']." Reason: ".$info['reason'].".";
}
mail($to,$subject,$message,$headers); 
```

关于导致问题的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T21:42:43.227

```
$from = "NO_REPLY@noreply.dassdf.com" 
```

那行有错误。您需要以“;”结束它 分号

像这样：

```
$from = "NO_REPLY@noreply.dassdf.com"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:43:22.840

改变

```
$message1 = "Store ".$username. " has submitted a dispute on invoice number ".$invoiceno;
// foreach line in disputedetails file for that invoice number, add to $message item, desc and 
while ($info = mysql_fetch_array($getdisputes)) {
    $message = $message1 + "\n <b>Invoice Number: </b>".$info['invno']." <b>Item ID:</b> ".$info['itemid']." <b>Description: </b>".$info['description']." <b>Disputed Quantity:</b> ".$info['disputeqty']." Reason: ".$info['reason'].".";
} 
```

进入：

```
$message = "Store ".$username. " has submitted a dispute on invoice number ".$invoiceno;

while ($info = mysql_fetch_array($getdisputes))
    $message .= "\n <b>Invoice Number: </b>".$info['invno']." <b>Item ID:</b> ".$info['itemid']." <b>Description: </b>".$info['description']." <b>Disputed Quantity:</b> ".$info['disputeqty']." Reason: ".$info['reason']."."; 
```

# wso2 - WSO2 在 ESB 中添加 BAM 配置文件

> ID：14429628
> 
> 赞同：2
> 
> 时间：2013-01-20T21:37:56.083
> 
> 标签：wso2, wso2esb, wso2bam

我们在尝试按照手册将 BAM 配置文件添加到 ESB 时遇到问题：

[http://docs.wso2.org/wiki/display/BAM201/Setting+up+BAM+Mediator#SettingupBAMMediator-ConfigureBAMServerProfilesandStreams](http://docs.wso2.org/wiki/display/BAM201/Setting+up+BAM+Mediator#SettingupBAMMediator-ConfigureBAMServerProfilesandStreams)

BAM 2.0.1（最新版本）

ESB 4.5.1（最新版本）

p2-repo 来自[http://dist.wso2.org/p2/carbon/releases/p2-repo.zip](http://dist.wso2.org/p2/carbon/releases/p2-repo.zip) (15-01-2013)

如果您在单个主机中使用两个 WSO2 服务器，它会起作用，但如果 ESB 和 BAM 在单独的主机中运行，则不会。未发现通过端口 7611 传出或传入的日志或流量。

BAM thrift 端口 7611 已打开并在 BAM 主机中侦听，并且可从 ESB 端口访问。

详情如下：

```
# uname -a
Linux ESBHOST 2.6.32-220.el6.x86_64 #1 SMP Wed Nov 9 08:03:13 EST 2011 x86_64 x86_64 x86_64 GNU/Linux

# java -version
java version "1.7.0_11"
Java(TM) SE Runtime Environment (build 1.7.0_11-b21)
Java HotSpot(TM) 64-Bit Server VM (build 23.6-b04, mixed mode)

# /opt/esb_default/bin/wso2server.sh version
WSO2 Enterprise Service Bus v4.5.1
WSO2 Carbon Framework v4.0.2

# nc -zv BAMHOST 7611
Connection to BAMHOST 7611 port [tcp/*] succeeded! 
```

任何线索如何找到问题或从哪里开始解决它？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T21:31:10.130

问题解决了：

即使您不想使用安全连接，端口 7711 也必须可以访问并且将被使用。此外，当 7611 监听 BAM 服务器的所有 IP 地址时，7711 仅监听配置的管理 IP。

由于这两个功能（尚未）记录在案，因此值得在这里为可能面临类似问题的其他人提及。感谢 WSO2 团队的支持。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T06:21:19.040

确保在 UI 中创建**BAM 服务器配置文件时输入****BAM 服务器**的 IP 地址。如果您从**BAM 服务器配置文件**UI更改了一些此类信息，请确保您在 ESB 的调解器中正确更新**BAM 服务器配置文件信息。**完成后，您必须手动更新中介序列。

# gwt - GWT 的布局厘米标尺 DIV 导致 IOS 6 上的布局问题

> ID：14429629
> 
> 赞同：0
> 
> 时间：2013-01-20T21:38:00.807
> 
> 标签：gwt, ios6, mgwt

我正在使用**GWT 2.5**和**MGWT 1.12。**据我测试，这仅发生在 IOS 6 上。这是我的问题：我在为显示动画而编写的组件之一中使用了[LayoutPanel 。](http://docs.mgwt.googlecode.com/git/javadoc/latest/com/googlecode/mgwt/ui/client/widget/LayoutPanel.html)每当创建该组件时，GWT 都会将此 DIV 添加到 DOM 中：

![可怕的10cm div](../Images/7665ad77f1c7e1ec11310a53dab1eb79.png)

这个 div 不是我的代码的一部分，而是[LayoutPanels 用于以 cm 为单位进行大小计算的](https://code.google.com/p/google-web-toolkit/source/browse/tags/2.5.0/user/src/com/google/gwt/layout/client/LayoutImpl.java#46)东西）在 iOS 6 上造成了可怕的布局问题。当我从纵向到横向再回到纵向时，就会出现这个问题，这个巨大的 DIV 导致错误计算的宽度，其结果是我最终将所有身体都推到了左侧，看起来像是一个空白列。

我已经使用[WEINRE](http://people.apache.org/~pmuellr/weinre/docs/latest/)对其进行了调试，如果我将宽度更改为 0，问题就会消失，这意味着 div 并没有像它应该的那样真正隐藏。

所以我的问题是这个。有没有办法禁用这种支持，摆脱那个 div，或者实际上用纯 GWT 手段隐藏它？

**我知道我可以用JNI**代码摆脱 DIV但这不是我正在寻找的解决方法。我也知道这个相关的问题，但我不认为我在问同样的问题：[GWT div aria-hidden not hidden in IE](https://stackoverflow.com/questions/13365938/gwt-div-aria-hidden-not-hiding-in-ie)

一如既往，感谢您的宝贵时间...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T23:03:40.243

有点晚了，但我最近在 android 浏览器和 chrome for android 上遇到了这个问题，看到相同的 div 元素是根本原因。在我的例子中，div 被注入是因为我在同一个项目中拥有移动视图和完整的 GWT 视图。

针对常规桌面浏览器的完整视图也被初始化，因此将麻烦的 div 元素注入到根文档中。

对我来说，解决方案是将所有移动视图和完整视图简单地分离到单独的包中，并将这些视图包的范围限定在它们各自的移动和完整 gwt.xml 文件中。

如果在 MGWT 项目中使用标准 LayoutPanel，我认为无法解决此问题。

# java - 正确导入 Apache Commons 数学包

> ID：14429630
> 
> 赞同：2
> 
> 时间：2013-01-20T21:38:02.460
> 
> 标签：java, javac

我正在尝试使用 Apache Commons Math 包中的 SimplexSolver 类，但我似乎无法正确导入包；以下所有内容都发生在一个名为“Java”的固定目录中。我下载了 commons-math3-3.1.1 并将解压缩的文件夹放入“Java”目录。

下面是一些示例代码，HelloWorld.java，保存在“Java”目录中：

```
import org.apache.commons.math;

public class HelloWorld {
        public static void main (String[] args) {
                System.out.println("Hello World!");
                }
} 
```

然后我继续在终端中输入以下命令：

```
javac -cp ./commons-math3-3.1.1/commons-math3-3.1.1.jar:. HelloWorld.java 
```

我收到以下错误：

```
HelloWorld.java:1: package org.apache.commons does not exist
import org.apache.commons.math;
                         ^
1 error 
```

我确定我误解了导入下载包的正确方法，任何帮助将不胜感激。我尝试过 import 行的变体，例如 import org.apache.commons.math.*; 诸如此类的事情，但到目前为止，它们都没有奏效。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T21:41:55.060

正确的包名是

```
org.apache.commons.math3. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:42:02.827

你错过了 3 :-)

```
import org.apache.commons.math3; 
```

# php - 显示来自两个不同字段的数据

> ID：14429631
> 
> 赞同：0
> 
> 时间：2013-01-20T21:38:06.937
> 
> 标签：php, mysql

我正在我的网站上建立一个朋友系统，我在 PHP/MYSQL 方面做得很好，但我只是被这个系统难住了。我正在尝试创建某个用户的朋友列表。MYSQL 表“朋友”与两个字段 RelatingUser 和 RelatedUser 一起使用，当向 RelatedUser 发送朋友请求时，它们会创建一个包含两个用户名的行。

但基本上我正在运行一个基本查询，目的是从两个字段中获取特定结果，然后按 id 显示它们。通常我会使用 mysql_fetch_assoc 然后回显变量，但是有两个不同的变量，我希望它们按照它们的 ID 顺序排列。

有任何想法吗？

```
 $users = mysql_real_escape_string($_GET['username']);

      $other_friend_query = mysql_query("SELECT * FROM friend WHERE RelatingUser='$users' || RelatedUser='$users'");

       while( $other_friend_assoc = mysql_fetch_assoc($other_friend_query) ) {
$friend_related = $other_friend_assoc['RelatedUser'];
$friend_relating = $other_friend_assoc['RelatingUser'];  

      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:06:09.973

如果记录要按 RelatedUser/RelatingUser 中的 id 以外的 id 排序，并且唯一的问题是回显正确的字段，则应该这样做：

```
echo $friend_related == $users ? $friend_relating : $friend_related; 
```

否则，如果您想要由 RelatedUser 或 RelatingUser 排序的记录，这取决于哪个未知，这样的查询应该可以完成这项工作：

```
SELECT UserID FROM 
(SELECT RelatingUser AS UserID
 FROM friend
 WHERE RelatedUser = ...
 UNION
 SELECT RelatedUser AS UserID
 FROM friend
 WHERE RelatingUser = ...) AS friends
ORDER BY UserID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:53:23.993

为什么不使用查询来订购它们？

```
"SELECT * FROM friend WHERE RelatingUser='$users' OR RelatedUser='$users' ORDER BY id ASC" 
```

# ruby-on-rails - 无法确定在 Rails 中处理来自外部站点的缓存数据的好方法

> ID：14429632
> 
> 赞同：0
> 
> 时间：2013-01-20T21:38:18.370
> 
> 标签：ruby-on-rails, ruby, caching, rails-activerecord

所以我的应用程序（rails）的核心数据依赖于来自外部站点的数据。但是我对如何处理不重复查询外部站点的数据**以及**是否应该将数据转换为本地持久对象感到有点迷茫。我知道 Rails 和 ActiveRecord 都提供了缓存方式。

基本上，我以散列数组的形式检索 Classroom 课程信息，每个散列代表一个课程对象。此外，每个课程对象都保留一个 URI，用于从外部 REST 服务检索特定课程信息。

我目前正在考虑类似的事情：

*   将外部数据映射到持久化到本地数据库的对象
*   利用 Rails 缓存并设置过期日期。
*   更新（不确定）：当从 Rails 缓存中检索记录时，如果过期，以某种方式将其设置为使用外部站点提供的 URI 从外部源检索该课程。也许这就是服务？

以上有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:53:36.983

使用第一个选项——将外部数据映射到你自己的模型中，该模型会持久化到你的数据库中——只要你有一种同步数据的合理方式就可以了。

我和一些工作人员一起使用[sidekiq](https://github.com/mperham/sidekiq)来不断轮询更改并更新我的本地记录。如果外部服务提供某种方式来告知其数据何时发生更改（例如发布到[Superfeedr](http://superfeedr.com/)之类的服务，或者提供一些包含有关其他提要的元数据的提要），而不是强制客户端提取数据并检查更改，那会更好。无论哪种方式，您仍然需要更新已更改的内容，并且使用后台工作人员进行管理可能是要走的路。

# mysql - 如何更改 SQL 文件中的字符集？

> ID：14429633
> 
> 赞同：0
> 
> 时间：2013-01-20T21:38:26.517
> 
> 标签：mysql, sql, unicode

我有一个不是我编写的 SQL 文件，我对此一无所知。我试图将此文件上传到服务器，但字符串数据字符被打乱了。

```
INSERT INTO `Anstitu` (`Code_Anstitu`, `Name_Anstitu`)
VALUES (7, '?©?§?±U‡?§UŒ ?¹U…UˆU…UŒ ?³?§?®??U…?§U†'); 
```

有 1,000,000 条这样的记录，我必须找到真正的方法。我知道，`SET NAMES utf8`但没用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:42:51.633

你有没有尝试过

```
INSERT INTO Anstitu (Code_Anstitu, Name_Anstitu)
VALUES (7, N'?©?§?±U‡?§UŒ ?¹U…UˆU…UŒ ?³?§?®??U…?§U†'); 
```

假设 Name_Anstitu 是 nvarchar 列？

# css - 加载时和重定向前的 CSS 动画

> ID：14429635
> 
> 赞同：1
> 
> 时间：2013-01-20T21:38:38.137
> 
> 标签：css

我目前正在开发一个 HTML5 移动平台，我的应用程序有一个登录页面，该页面是平铺的，并在屏幕上布置为四个大小相同的平铺 (div)

我整个下午都在玩 CSS3 动画，我发现了一些我认为可以使用的东西，如果我能弄清楚使用它的后勤工作 (http://daneden.me/animate/)。

我想要实现的是让登录页面磁贴在用户登录并被重定向到登录页面时运行“反弹”动画，以提供与用户一起加载的磁贴效果。

其次，当用户单击特定磁贴时，我希望该磁贴运行“反弹”，然后重定向到用户指定的页面。

值得一提的是，我目前正在使用 JQuery mobile 来实现其他一些功能，但我不能完全让它工作，而且我不确定是否有更流畅、更轻量级的方法来实现这一点，因为我目前正在试验CSS 动画延迟属性无效。

非常感谢任何意见或建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T22:46:07.460

你的意思是这样的吗？

# [**演示**](http://dabblet.com/gist/4582171)

不是所有的 CSS，它使用 JavaScript 来延迟默认的点击动作（**更新**：使用 JavaScript 进行重定向，因为它现在使用`div`元素，而不是链接）。但是，动画由 CSS 处理。

**HTML**应该是这样的：

```
<div data-redirect='page1.html' class='tile'></div>
<div data-redirect='page2.html' class='tile'></div>
<div data-redirect='page3.html' class='tile'></div>
<div data-redirect='page4.html' class='tile'></div> 
```

相关**CSS**：

```
.tile {
    display: inline-block;
    opacity: 0;
    transform: scale(.3);
    background: lightblue;
    animation: bouncein 1s .5s cubic-bezier(0, 2.5, 1, -.25) forwards; 
}
@keyframes bouncein { 
    from { opacity: 0; transform: scale(.3); }
    to { opacity: 1; transform: scale(1); }
}
.bounceout {
    animation: bounceout 1s cubic-bezier(0, 2.5, 1, -.25) forwards;
}
@keyframes bounceout {
    from { opacity: 1; transform: scale(1); } 
    to { opacity: 0; transform: scale(.1); }
} 
```

*我用过的*所有***JavaScript ：***

 *```
document.body.addEventListener('click', function(e){
    var target = e.target;
    if(target.classList.contains('tile')) {
        target.classList.add('bounceout');
        setTimeout(function() {
            if(target.dataset) window.location = target.dataset.redirect;
            else window.location = target.getAttribute('data-redirect');
            }, 1000);
    }
}, false); 
```

如果您想了解更多关于 CSS3 动画与 jQuery 动画的信息，那么[这篇文章](http://dev.opera.com/articles/view/css3-vs-jquery-animations/)可能会有所帮助。*

# visual-c++ - gluProject 给出错误的坐标

> ID：14429641
> 
> 赞同：2
> 
> 时间：2013-01-20T21:39:01.197
> 
> 标签：visual-c++, opengl, 2d, glut, glu

我正在尝试在 2D 中绘制形状，并且正在尝试使用 gluProject 在 3D 和 2D 坐标之间进行转换。基本上我的目标是在 (200,200) 上画一个点，并且该点将被适当地绘制（假设起始位置是 0,0,0）。

我已经像这样初始化了 gluProject -

```
GLdouble modelView[16];
GLdouble projection[16];
GLint viewport[4];
glGetDoublev(GL_MODELVIEW_MATRIX,modelView);
glGetDoublev(GL_PROJECTION_MATRIX,projection);
glGetIntegerv(GL_VIEWPORT,viewport); 
```

我在这样的动画方法中调用它

```
double tx, ty, tz;
gluProject(0.0,0.0,0.0,modelView,projection,viewport,&tx,&ty,&tz);
cout<<"tx,ty,tz: "<<tx<<","<<ty<<","<<tz<<endl; 
```

我得到的值很奇怪（-9e61，-9e61，-9e61）。我猜这是因为我乘以一个不同的矩阵而不是我应该的。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T11:27:32.250

> 我已经像这样初始化了 gluProject -

你的错误就在那里。OpenGL是一个状态机。没有一次性初始化。您需要在 OpenGL 状态机处于您想要取消投影到的状态时获取矩阵和视口。例如，如果您在上下文创建之后立即获取它们，您将只获得身份矩阵和一个可能与您后来获得的不同的视口。

如果您只想在特定位置画一个点，请查看激进 7 的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T00:19:16.857

如图所示，您的代码是正确的。确保您有一个上下文绑定（通过调用您正在使用的窗口工具包中的`wglMakeCurrent`、或等效项），否则将不会定义`glxMakeCurrent`值（包括来自 的值）。`glGetError`

也就是说，我认为您没有尽可能地使用 OpenGL。例如，如果您这样做：

```
// Set up the projection transformation to match window coordinates
glMatrixMode( GL_PROJECTION );
glOrtho2D( 0, windowWidth, 0, windowHeight );

// No modeling transformation required for this rendering
glMatrixMode( GL_MODELVIEW );
glLoadIdentity();

glColor3f( 1.0, 1.0, 1.0 );  // set the current color to white
glBegin( GL_POINTS );
glVertex2i( 200, 200 );
glEnd(); 
```

您应该在窗口中的像素 (200,200) 处获得一个白点。

# ios - 变暗 UIImageView IOS

> ID：14429646
> 
> 赞同：1
> 
> 时间：2013-01-20T21:39:48.560
> 
> 标签：ios, xcode

我试图做的是使 UIImageView 更暗，以便图像结果顶部的按钮和视图。我想给它一个在 ios6 中用户使用 Facebook 分享时给出的效果。它后面的所有内容都变得更暗，但它是可见的。我尝试使用：

```
 UIImage *maskedImage = [self darkenImage:image toLevel:0.5];

- (UIImage *)darkenImage:(UIImage *)image toLevel:(CGFloat)level
{
// Create a temporary view to act as a darkening layer
CGRect frame = CGRectMake(0.0, 0.0, image.size.width, image.size.height);
UIView *tempView = [[UIView alloc] initWithFrame:frame];
tempView.backgroundColor = [UIColor blackColor];
tempView.alpha = level;

// Draw the image into a new graphics context
UIGraphicsBeginImageContext(frame.size);
CGContextRef context = UIGraphicsGetCurrentContext();
[image drawInRect:frame];

// Flip the context vertically so we can draw the dark layer via a mask that
// aligns with the image's alpha pixels (Quartz uses flipped coordinates)
CGContextTranslateCTM(context, 0, frame.size.height);
CGContextScaleCTM(context, 1.0, -1.0);
CGContextClipToMask(context, frame, image.CGImage);
[tempView.layer renderInContext:context];

// Produce a new image from this context
CGImageRef imageRef = CGBitmapContextCreateImage(context);
UIImage *toReturn = [UIImage imageWithCGImage:imageRef];
CGImageRelease(imageRef);
UIGraphicsEndImageContext();
return toReturn;
} 
```

但它并没有给出我想要的效果。它改变了颜色，而我只是想让它变暗，就像当你使用 ios facebook 共享时，背景变暗。这可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T00:19:29.760

要使 UIView 及其所有内容和子视图更暗，您只需在其上绘制另一个全黑且具有 alpha 透明度的 UIView，以便此“屏蔽视图”的黑色与下面视图的内容混合。如果 alpha 透明度为 0.5，则下面的所有内容看起来都会变暗 50%。

要获得褪色效果，只需使用“屏蔽视图”的过渡：

```
// Make the view 100% transparent before you put it into your view hierarchy.
[myView setAlpha:0];

// Layout the view to shield all the content you want to darken.
// Give it the correct size & position and make sure is "higher" in the view
// hierarchy than your other content.
...code goes here...

// Now fade the view from 100% alpha to 50% alpha:
[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:0.5];
[myView setAlpha:0.5];
[UIView commitAnimations]; 
```

您可以根据需要更改动画持续时间以使渐变变慢或变快。如果您没有设置任何动画持续时间，则使用默认持续时间（我猜您在 Facebook 分享时就是这种情况）。

# android - 在 Eclipse for Android 中使用新版本的开发工具等时出错

> ID：14429648
> 
> 赞同：1
> 
> 时间：2013-01-20T21:40:11.753
> 
> 标签：android, eclipse, compiler-errors

我有一个应用程序已经 1 年多了，到目前为止编译它完全没有问题。该应用程序使用看轮[http://code.google.com/p/android-wheel/downloads/list](http://code.google.com/p/android-wheel/downloads/list)

最后一个工作的开发环境显示在`N`ew 中并且总是产生这个错误

> 构建过程中发生错误。在项目“myProject”上运行构建器“Android Pre Compiler”时出错。java.lang.NullPointerException

而`O`ld 中显示的环境可以正常工作。

我不知道为什么在新的开发环境中会出现此编译错误。但很明显，新的 4 个 Android 更新之一是导致它的原因。一旦我让旧版本更新为新版本，我就会再次收到错误。所以我不能再更新我的 Eclipse 了:-(

我尝试了我能想到的一切，比如更新`.Metadata`文件、重新初始化任何库链接、更改使用的 Android SDK 版本，包括/排除 Android 依赖项，但都无济于事。

什么可能导致这个新的编译问题，或者更好的是我必须做什么才能再次使用新的开发工具？

![在此处输入图像描述](../Images/acd5ce16dd978bc649f1a74a519d9fd7.png)

这是我的eclipse.ini：

```
-startup
../../../plugins/org.eclipse.equinox.launcher_1.2.0.v20110502.jar
--launcher.library
../../../plugins/org.eclipse.equinox.launcher.cocoa.macosx.x86_64_1.1.101.v20120109-1504
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Xms768m
-Xmx1224m
-Xdock:icon=../Resources/Eclipse.icns
-XstartOnFirstThread
-Dorg.eclipse.swt.internal.carbon.smallFonts 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:44:33.480

请在此处查看我的答案：[AndroidPreCompiler build error after updates Android SDK Tools](https://stackoverflow.com/a/14363806/1820695)。

我很确定这就是原因。

# cakephp - cakephp 控制台没有找到 shell 尽管它显示可用

> ID：14429652
> 
> 赞同：0
> 
> 时间：2013-01-20T21:40:25.363
> 
> 标签：cakephp, console

我有一个 cakephp 2.2 的多应用程序安装。我无法使任何外壳工作：

错误信息：

```
patron@serveur01linux:/cakeapps/developpement/Console$ bash cake hello
Error: Shell class HelloShell could not be found.
#0 /cakephp/2.2/lib/Cake/Console/ShellDispatcher.php(191): ShellDispatcher->_getShell('hello')
#1 /cakephp/2.2/lib/Cake/Console/ShellDispatcher.php(69): ShellDispatcher->dispatch()
#2 /cakeapps/developpement/Console/cake.php(36): ShellDispatcher::run(Array)
#3 {main} 
```

欢迎画面：

```
Welcome to CakePHP v2.2.3 Console
---------------------------------------------------------------
App : developpement
Path: /cakeapps/developpement/
---------------------------------------------------------------
Current Paths:

 -app: developpement
 -working: /cakeapps/developpement
 -root: /cakeapps
 -core: /cakephp/2.2/lib

Changing Paths:

Your working path should be the same as your application path to change your path use the '-app' param.
Example: -app relative/path/to/myapp or -app /absolute/path/to/myapp

Available Shells:

[CORE] acl, api, bake, command_list, console, i18n, schema, test, testsuite, upgrade

[app] chaine, client, hello

To run an app or core command, type cake shell_name [args]
To run a plugin command, type cake Plugin.shell_name [args]
To get help on a specific command, type cake shell_name --help 
```

正如你所看到的，我工作并且我在正确的文件夹 app (/cakeapps/developpement) 中，核心路径是安装核心的位置 (/cakephp/2.2/lib)，欢迎屏幕显示我可用的 shell。但是，我一直在上面得到这个错误。

问题可能出在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-21T22:43:43.863

正如[马克](https://stackoverflow.com/users/461173/mark)在评论中提到的那样，您应该运行：

```
patron@serveur01linux:/cakeapps/developpement$ bash cake hello 
```

代替：

```
patron@serveur01linux:/cakeapps/developpement/Console$ bash cake hello 
```

# javascript - 在 ie8 中未调用图像的 onload 回调

> ID：14429656
> 
> 赞同：9
> 
> 时间：2013-01-20T21:40:54.147
> 
> 标签：javascript, jquery

我正在尝试预加载图像并将高度和宽度设置为容器。

问题似乎与 ie8 中的缓存有关，因为它无法在后续刷新时加载。

我查找并尝试了多种解决方案，但似乎没有任何效果，至少不是始终如一。

当前的Javascript：

```
 img = new Image();
    img.src = '/images/site/image.jpg';
    img.onload=function(){
        var width = img.width + 'px';
        var height = img.height + 'px';

        $('#container').css({'width':width,
                          'height':height
        });
    }; 
```

任何建议表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-20T21:41:50.473

您必须`onload`在设置之前设置回调`src`。

缓存图像时，不会使用您的代码调用 onload 回调，因为`load`事件是在设置回调之前生成的。

做这个 ：

```
img = new Image();
img.onload=function(){
    var width = img.width + 'px';
    var height = img.height + 'px';

    $('#container').css({'width':width,
                      'height':height
    });
};
img.src = '/images/site/image.jpg'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-05T21:11:01.380

这就是 ie7 和 ie8 的迟钝程度，即使在 onload 事件之后设置了 src，事件侦听器仍然会错过它。

看看这个，这就是我最终必须为我的一个项目做的事情——准备好了吗？设置超时。是的！这就是你必须编写代码才能让事情在 ie 中“工作”的程度。

```
myImage.onload = doSomething;

var slowMeDown = setTimeout(function(){
                      myImage.src = "img/somePic.jpg";
                 },300); 
```

令人难以置信的令人难以置信的......

# c++ - 初始化 Glew - Visual Studio 2012 中的链接器错误

> ID：14429659
> 
> 赞同：0
> 
> 时间：2013-01-20T21:41:02.973
> 
> 标签：c++, visual-studio, opengl, linker, glew

我不断收到链接器错误，试图让 GLEW 在 VS2012 中工作。我在网上搜索过，没有一个解决方案有效。

为了进行设置，我添加`glew\include`了 VC++ 包含目录和`glew\lib`VC++ 库目录。两者都保存在我的 glew 库文件夹中。我将 glew32.lib 添加到 Linker:Input:Additional Dependencies。我将 glew32 DLL (glew\lib) 文件夹添加到系统路径中，然后重新启动。

在此之前，我尝试将 include 和 lib 文件直接添加到 Visual Studio 安装目录中，默认情况下会在其中搜索它们，并将 .dll 放在 System32 中。该解决方案也未能奏效。

我的代码如下：

```
#pragma comment(lib, "glew32.lib")

#include <GL/glew.h>

int main(){
    glewInit();
} 
```

而已。`#pragma`无论我把它放在哪里，甚至当我完全删除它时，代码都会失败。这会出现以下错误：

```
main.obj : error LNK2019: unresolved external symbol __imp__glewInit@0 referenced in function _main 
```

操作系统：Windows 7 Ultimate 64 位

IDE：微软 Visual Studio 2012 4.5.50709

GLEW：版本 1.9.0

编辑：发布后，我尝试重新下载 GLEW .zip 文件，并意识到我下载的是 64 位版本。因此，我尝试下载 32 位版本，现在可以使用了。但是，我仍然很困惑为什么它不适用于 64 位版本，以及如何让它工作？当您尝试 64 位版本时，似乎没有任何效果！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T01:16:56.070

您是否将 VS 设置为在属性页上构建 64 位？

# c - 确定字节中的哪个单个位被设置

> ID：14429661
> 
> 赞同：7
> 
> 时间：2013-01-20T21:41:18.037
> 
> 标签：c, optimization, bit-manipulation, bitflags

我有一个`byte`我正在使用的位标志。我知道在任何给定时间都设置了***一个且只有一个***位。`byte`

前任：`unsigned char b = 0x20; //(00100000) 6th most bit set`

我目前使用以下循环来确定设置了哪个位：

```
int getSetBitLocation(unsigned char b) {
  int i=0;
  while( !((b >> i++) & 0x01) ) { ; }
  return i;
} 
```

如何最有效地确定设置位的位置？我可以在没有迭代的情况下做到这一点吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T21:54:25.903

> 我可以在没有迭代的情况下做到这一点吗？

这确实是可能的。

> 如何最有效地确定设置位的位置？

你可以试试这个算法。它将字符分成两半以搜索最高位，每次都转移到低半部分：

```
int getTopSetBit(unsigned char b) {
  int res = 0;
  if(b>15){
    b = b >> 4;
    res = res + 4;
  }
  if(b>3){
    b = b >> 2;
    res = res + 2;
  }

  //thanks @JasonD
  return res + (b>>1);
} 
```

它使用两个比较（三个用于`uint16`s，四个用于`uint32`s...）。它可能比你的循环更快。绝对不会更短。

* * *

基于 Anton Kovalenko 的想法（散列查找）和 6502 的评论（除法很慢），我还建议这种实现（使用[de-Bruijn](http://en.wikipedia.org/wiki/De_Bruijn_sequence)序列的 8 位 => 3 位散列）

```
int[] lookup = {7, 0, 5, 1, 6, 4, 3, 2};

int getBitPosition(unsigned char b) {
  // return lookup[(b | (b>>1) | (b>>2) | (b>>4)) & 0x7];
  return lookup[((b * 0x1D) >> 4) & 0x7];
} 
```

或（更大的 LUT，但仅使用三个术语而不是四个）

```
int[] lookup = {0xFF, 0, 1, 4, 2, 0xFF, 5, 0xFF, 7, 3, 0xFF, 0xFF, 6, 0xFF, 0xFF, 0xFF};

int getBitPosition(unsigned char b) {
  return lookup[(b | (b>>3) | (b>>4)) & 0xF];
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-20T22:01:42.650

查找表很简单，如果值集很稀疏，您可以减小它的大小。让我们尝试使用 11 个元素而不是 128 个元素：

```
unsigned char expt2mod11_bits[11]={0xFF,0,1,0xFF,2,4,0xFF,7,3,6,5};
unsigned char pos = expt2mod11_bits[b%11];
assert(pos < 8);
assert(1<<pos == b); 
```

当然，它不一定更有效，尤其是对于 8 位，但同样的技巧可以用于更大的尺寸，其中完整的查找表会非常大。让我们来看看：

```
unsigned int w; 
....
unsigned char expt2mod19_bits[19]={0xFF,0,1,13,2,0xFF,14,6,3,8,0xFF,12,15,5,7,11,4,10,9};
unsigned char pos = expt2mod19_bits[w%19];
assert(pos < 16);
assert(1<<pos == w); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-20T22:05:07.630

对于使用 64 位来表示位置的国际象棋程序来说，这是一个非常常见的问题（即，一个 64 位数字存储所有白棋在哪里，另一个存储所有黑棋在哪里，依此类推）。

使用这种表示，有时需要找到第一个或最后一个设置位的索引 0...63，并且有几种可能的方法：

1.  像你一样做一个循环
2.  使用二分搜索（即如果`x & 0x00000000ffffffffULL`为零，则无需检查低 32 位）
3.  如果处理器上可用，则使用特殊指令（例如`bsf`，`bsr`在 x86 上）
4.  使用查找表（当然不是针对整个 64 位值，而是针对 8 位或 16 位）

然而，更快的方法实际上取决于您的硬件和实际用例。对于仅 8 位和现代处理器，我认为**可能**具有 256 个条目的查找表是最佳选择......

但是你真的确定这是你算法的瓶颈吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-20T22:47:50.370

基于 [Find the log base 2 of an N-bit integer in O(lg(N)) operations 中的](http://graphics.stanford.edu/~seander/bithacks.html)log2 计算：

```
int getSetBitLocation(unsigned char c) {
  // c is in {1, 2, 4, 8, 16, 32, 64, 128}, returned values are {0, 1, ..., 7}
  return (((c & 0xAA) != 0) |
          (((c & 0xCC) != 0) << 1) |
          (((c & 0xF0) != 0) << 2));
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-20T21:55:21.087

```
unsigned getSetBitLocation(unsigned char b) {
  unsigned pos=0;
  pos = (b & 0xf0) ? 4 : 0; b |= b >>4;
  pos += (b & 0xc) ? 2 : 0; b |= b >>2;
  pos += (b & 0x2) ? 1 : 0; 
  return pos; 
} 
```

很难做到无跳跃。也许与 Bruin 序列有关？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-20T21:50:10.157

最简单的事情是创建一个查找表。最简单的将是稀疏的（有 256 个元素），但从技术上讲它会避免迭代。

这里的评论在技术上避免了迭代，但我们在开玩笑，它仍然在做同样数量的检查：[How to write log base(2) in c/c++](https://stackoverflow.com/questions/3064926/how-to-write-log-base2-in-c-c#comment3140466_3065433)

封闭形式将是[log2()](http://www.manpagez.com/man/3/log2/)，一个 la，`log2() + 1`但我不确定它的效率如何 - 可能 CPU 有一条指令用于以 2 为底的对数？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-20T21:55:45.167

如果你定义

```
const char bytes[]={1,2,4,8,16,32,64,128} 
```

并使用

```
struct byte{
char data;
int pos;
}
void assign(struct byte b,int i){

b.data=bytes[i];
b.pos=i
} 
```

您不需要确定设置位的位置

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-20T21:59:03.263

当 CHAR_BIT == 8 时，查找表又快又容易，但在某些系统上，CHAR_BIT == 16 或 32 并且查找表变得异常庞大。如果您正在考虑使用查找表，我建议将其包装起来；改为“查找表函数”，以便在需要优化时交换逻辑。

使用分治法，通过对排序数组执行二进制搜索，涉及基于 log2 的比较`CHAR_BIT`。该代码更复杂，涉及初始化数组`unsigned char`以用作开始的查找表。一旦你初始化了这样的数组，你就可以使用`bsearch`它来搜索它，例如：

```
#include <stdio.h>
#include <stdlib.h>
void uchar_bit_init(unsigned char *table) {
    for (size_t x = 0; x < CHAR_BIT; x++) {
        table[x] = 1U << x;
    }
}
int uchar_compare(void const *x, void const *y) {
    char const *X = x, *Y = y;
    return (*X > *Y) - (*X < *Y);
}
size_t uchar_bit_lookup(unsigned char *table, unsigned char value) {
    unsigned char *position = bsearch(lookup, c, sizeof lookup, 1, char_compare);
    return position ? position - table + 1 : 0;
}
int main(void) {
    unsigned char lookup[CHAR_BIT];
    uchar_bit_init(lookup);
    for (;;) {
        int c = getchar();
        if (c == EOF) { break; }
        printf("Bit for %c found at %zu\n", c, uchar_bit_lookup(lookup, c));
    }
} 
```

PS这听起来像是微优化。完成您的解决方案（将所需的操作抽象到这些函数中），然后担心基于您的分析的优化。如果您要专注于微优化，请确保您的分析针对您的解决方案将运行的系统，因为微优化的效率差异很大，因为硬件甚至略有不同......通常购买一个更好的主意更快的电脑；）

# iphone - 使用 Storyboard 向 UITableView 添加自定义标题

> ID：14429663
> 
> 赞同：3
> 
> 时间：2013-01-20T21:41:26.190
> 
> 标签：iphone, uitableview, header

我似乎无法使用 Storyboard 向 UITableView 添加标题。我有一个 UITableView ，其中有一些原型单元格正在显示并且工作正常。然后，我在这些原型单元格上方拖动了一个新的 UIView 并向其添加了一个标签以充当我的表格的标题（而不是作为部分标题）。我创建了一个新的 UIView 子类，它只有一个属性，即 UILabel。故事板中 UIView 的类设置为这个自定义 UIView，而 UILabel 的引用出口设置为我自定义 UIView 类的 UILabel 属性。

然后，在我的 UITableViewController 的 viewDidLoad 方法中，我正在执行以下操作：

```
DetailTableHeaderView *headerView = [[DetailTableHeaderView alloc] init];
headerView.entryNameLabel.text = @"TEST";
self.tableView.tableHeaderView = headerView;
[self.tableView reloadData]; 
```

但是当我运行我的应用程序时，表头根本没有出现。我还注意到 headerView.entryNameLabel 的 text 属性甚至没有设置为应有的“TEST”。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-13T14:46:09.693

Old question, but I am providing my answer for reference reasons since it's still a bit non trivial how to add a tableview header, using storyboard for the design part.

1.  Add a prototype cell in your tableview in your storyboard.
2.  Having your prototype cell selected, in the attributes inspector on your right, give it an identifier (ex headerViewCell), since this is how your will reference it in order to use it.
3.  Now click on the size inspector tab and give it a row height (this gonna be your header view height)
4.  In the code now, in the controller that handles the tableview:

    ```
    - (void)viewDidLoad {
        [super viewDidLoad];
        self.tableView.tableHeaderView = [self.tableView dequeueReusableCellWithIdentifier:@"headerViewCell"];
    } 
    ```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-12T19:36:47.933

这个问题已经很老了，但写下这个答案，希望这会对某人有所帮助。

处理表 headerView 的好方法是使用委托方法。实现`tableView:viewForHeaderInSection`和`tableView:heightForHeaderInSection`委托方法。`tableView:viewForHeaderInSection`从方法返回你的 UIView 。

```
-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {
}

-(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section {
} 
```

另一种选择是使用原型单元格（自定义单元格）作为标题视图并在 tableView:viewForHeaderInSection 方法中返回它。请参见下面的代码（我没有测试过这个）：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section 
{

    HeaderView *headerView = [self.TableView dequeueReusableHeaderFooterViewWithIdentifier:@"tableHeader"];

    // Set Text
    headerView.headerLabel.text = @"Some title";

    return headerView.contentView;
} 
```

**更新**

以上也适用于 tableView:viewForHeaderInSection: 方法。这是示例代码：

```
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    UITableViewCell *sectionHeader;
    CustomSectionHeaderCell *sectionHeaderCell = [tableView dequeueReusableCellWithIdentifier:@"sectionHeaderCell"];

    // do stuff here

    return sectionHeaderCell.contentView;
} 
```

# ruby-on-rails - 在 Rails 中生成书签的最佳方法是什么？

> ID：14429664
> 
> 赞同：2
> 
> 时间：2013-01-20T21:41:36.580
> 
> 标签：ruby-on-rails, bookmarklet

我有一个 Javascript，我想将它嵌入到这样的超链接中：

```
<a href="javascript:function() {...}();"> 
```

我创建了一个名为 _bookmarklet.html.erb 的部分，它生成 javascript，包括动态生成的指向 app/assets 中资产的链接。它不能是静态的，因为它创建了指向当前服务器上资产的 url，它必须是绝对的，因为在安装之后，书签可以在不同的 Web 主机上执行。

我的模板如下所示：

```
<a href="<%= render :partial => 'pages/bookmarklet' %>" 
```

我遇到的问题是javascript中的“（双引号”）。是否有转义引号的机制？我怎样才能正确嵌入这个？在 Rails 中公开小书签的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:47:39.320

你有几个选择。您可以使用[`link_to`](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)助手为您执行转义：

```
link_to "Bookmarklet!", render(:partial => 'pages/bookmarklet') 
```

或者通过以下方式[手动转义](http://api.rubyonrails.org/classes/ERB/Util.html#method-c-h)节点的属性：

```
<a href="<%=h render :partial => 'pages/bookmarklet' %>" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-09T15:12:54.140

有[几个](https://github.com/Octo-Labs/easymarklet) [gem](https://github.com/oliverfriedmann/rails-bookmarklet)可以让你创建一个书签。无论如何要在 href 上转义和呈现 JavaScript，您应该将部分视为字符串：

`<%= link_to "Bookmarklet", "#{render 'bookmarklet'}" %>`

[这里](http://as-cii.github.io/2014/03/bookmarklet-on-a-href-in-rails.html)也是在没有任何 gem 的情况下在 rails 中创建书签的分步指南。

# javascript - 从 JAVA 向 node.js/socket.io 服务器发送数据

> ID：14429670
> 
> 赞同：3
> 
> 时间：2013-01-20T21:41:56.340
> 
> 标签：javascript, java, node.js, socket.io

我正在尝试通过 Java 向我的 node.js/socket.io 服务器发送消息

这是我用来发送消息的代码

```
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;

class socketMessage {

    public socketMessage() {
    }

    public static void send(String string) throws Exception {
        System.out.println("Sending message to Socket Server!");

        URL url = new URL("http://<mysite>:8000");
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestMethod("POST");
        conn.setDoOutput(true);
        try (OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream())) {
            System.out.println("Data Sent!");
            writer.write(string);
            writer.flush();
        }
        conn.getResponseCode(); // Thanks to BGR
    }
} 
```

调用：`socketMessage.send("Admin|notification|Logged in elsewhere\n> Official Java App");`

这是服务器代码：

```
var http = require("http");
var io = require('socket.io');

var sessionsConnections = {};
var whereIsUserVisitingFrom = {};

console.log("\n\n-------------------------------- Server Started --------------------------------");

var server = http.createServer(function(req, res){ 
    var body = '';
    req.on('data', function(data){
        console.log('Received Data');
        body += data;
    });
    req.on('end', function() {
        // Emit the data to all clients
        ioServer.emit('message', { message: body });
    });
});
server.listen(8000);

var ioServer = io.listen(server, { log: false });

ioServer.on('connection', function(socket) {

    var currentUser;

    var parts;

    socket.on('started', function(data) {
        currentUser = data.username;
        sessionsConnections[currentUser] = socket.id;
        whereIsUserVisitingFrom[currentUser] = data.from;
        socket.emit("connected", { message: "Welcome, " + currentUser + "!" });

        socket.broadcast.emit("updateUsers", { message: sessionsConnections, from: whereIsUserVisitingFrom });
        socket.emit("updateUsers", { message: sessionsConnections, from: whereIsUserVisitingFrom });
    });

    socket.on('message', function(data) {
        var parts = data.message.split("|");

        socket.broadcast.emit("updateUsers", { message: sessionsConnections, from: whereIsUserVisitingFrom });
        socket.emit("updateUsers", { message: sessionsConnections, from: whereIsUserVisitingFrom });

        console.log("Message Recieved!");

        if( parts[0] == "*" ) {
            socket.broadcast.emit("display", { message: data.message });
        }else{
            if( parts[0] in sessionsConnections ) {
                io.sockets.socket(sessionsConnections[parts[0]]).emit("display", { message: data.message });
            }else{
                socket.emit("display", { message: "That user is not online!" });
            }
        }
    });

    socket.on('disconnect', function() {
        delete sessionsConnections[currentUser];
        socket.broadcast.emit("updateUsers", { message: sessionsConnections, from: whereIsUserVisitingFrom });
        socket.emit("updateUsers", { message: sessionsConnections, from: whereIsUserVisitingFrom });
    });

}); 
```

基本上我的服务器当前所做的是当我访问我的网站时，然后以“{user}|{action (ie notification)}|{text/extra_param(s)}”的形式从我的管理中心发送一个命令，它将发送向您设置为 {user} 的客户端发送一条消息，然后我在客户端有代码，该代码将该消息分成几部分并相应地更改网站 UI，但我也想从我的 Java 应用程序中执行此操作，并且它不工作:(

有任何想法吗

文尼

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T06:26:39.227

要完成 HTTP 连接，必须读取 HTTP 响应。

在块`conn.getResponseCode()`之后插入`try`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-06T07:58:20.557

添加后

```
conn.getResponseCode() 
```

仍然无法完成这项工作。最后我发现[socket.io-java-client](https://github.com/Gottox/socket.io-java-client)正是我​​们需要的。因为socket.io没有使用你使用的原始websocket，而是在上面添加了一个protocl，你的代码“数据”事件永远不会触发。

# android - android: ContentResolver 适用于 4.0 但不适用于 2.3

> ID：14429671
> 
> 赞同：0
> 
> 时间：2013-01-20T21:41:57.833
> 
> 标签：android, android-contentprovider, android-contentresolver, android-syncadapter

在我正在构建的联系人提供程序中，我想创建联系人组，然后将联系人添加到该组。如果一个不存在，这是我创建新组的代码：

```
if (groupId == 0) {
        // Sample group doesn't exist yet, so create it
        final ContentValues contentValues = new ContentValues();
        contentValues.put(Groups.ACCOUNT_NAME, account.name);
        contentValues.put(Groups.ACCOUNT_TYPE, account.type);
        contentValues.put(Groups.TITLE, Constants.GROUP_NAME);
        contentValues.put(Groups.GROUP_IS_READ_ONLY, true);

        final Uri newGroupUri = resolver.insert(Groups.CONTENT_URI, contentValues);
        Log.d(TAG, newGroupUri.toString());
        groupId = ContentUris.parseId(newGroupUri);
    } 
```

当我在 android 4.0 或 4.1 上运行它时它可以工作，但是当我在 2.3 上运行它时它`newGroupUri`是空的。2.3有什么问题。我在模拟器和手机上都试过了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:01:21.393

contentValues.put(Groups.GROUP_IS_READ_ONLY, true); 仅从 api 11 开始可用

# javascript - 如何测试一条线是否相对于另一条线顺时针旋转？

> ID：14429674
> 
> 赞同：1
> 
> 时间：2013-01-20T21:42:14.880
> 
> 标签：javascript, math, geometry, 2d, line

在下面的代码中，我想确保一条线相对于另一条线顺时针旋转。我想顺时针走的线有角度*targetAngle*。

```
var dX = line.start.x - someOtherPoint.x;
var dY = line.start.y - someOtherPoint.y;
var lastAngle = Math.atan2(dY, dX);

var dX = line.start.x - line.end.x;
var dY = line.start.y - line.end.y;
var targetAngle = Math.atan2(dY, dX);

if (targetAngle < lastAngle) {
    // is going counter clockwise
} else {
    // is going clockwise
} 
```

此代码在大多数情况下都有效，但在*targetAngle*低于 0 时会中断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:46:27.777

我只是粗略地看了一眼，但如果它只在 targetAngle 低于零时中断，请添加如下检查：

```
if (targetAngle < 0)
    targetAngle = targetAngle + 360 
```

这样，您就不必处理负角。或者无论如何都按照这些方式做一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:53:03.613

我认为你一般不能这样做，除非你也知道两次测量之间的差异不能超过 180°。您如何仅根据角度之间的差异来区分逆时针旋转 90° 的线与顺时针旋转 270° 的线之间的差异？否则，您只需要检查符号`atan2`- 逆时针为正，顺时针为负（取决于您的参考点）。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/atan2](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/atan2)

> atan2 方法返回一个介于 -pi 和 pi 之间的数值，表示 (x,y) 点的角度 theta。这是正 X 轴和点 (x,y) 之间的逆时针角度，以弧度为单位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T22:24:43.200

改变这个：

```
if (targetAngle < lastAngle) { 
```

对此：

```
if (targetAngle < lastAngle && !(targetAngle < 0 && lastAngle > 0)) { 
```

似乎可以解决问题。

# apache - Apache 化学查询文件夹

> ID：14429677
> 
> 赞同：1
> 
> 时间：2013-01-20T21:42:20.573
> 
> 标签：apache, cmis, opencmis, apache-chemistry

我正在使用 Apache 化学从 Java servlet 中的内容管理系统中写入和读取数据。我目前正在为 CMS 中的每个登录用户创建一个单独的文件夹。当用户登录时，我必须检查并获取用户文件夹的引用，以便我可以在会话中使用它。第一次创建文件夹时，我可以使用 createFolder 调用获取用户的文件夹：

```
 Folder userFolder = root.createFolder(newFolderProps); 
```

但是，如果该文件夹已经存在，我可以获得该文件夹的唯一方法是遍历所有子级。这可能非常低效。我想知道是否有任何方法可以将文件夹名称指定为查询参数，以便我可以直接获取用户文件夹而无需遍历所有子文件夹。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T19:03:07.863

尝试 getObject() 或 getObjectByPath()：

```
Folder userFolder = (Folder) session.getObject(folderId);
Folder userFolder = (Folder) session.getObjectByPath(folderPath); 
```

# actionscript-3 - 将 SWF 嵌入 FLEX 项目时出错

> ID：14429678
> 
> 赞同：0
> 
> 时间：2013-01-20T21:42:30.130
> 
> 标签：actionscript-3, flash, apache-flex, flash-builder

试图将 SWF 嵌入到 FLEX 项目中，从中导入符号，而不是整个 SWF

并且编译器显示如下错误：“无法转码资产 swf”，但 SWF 是正确的，它的版本是 10.2，actionscript 版本是 3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:45:10.420

错误是在闪存中制作符号

当您将对象转换为符号时，您应该选择“Export for Actionscript”选项

之后，这个符号将能够嵌入到 flex 应用程序中

# ajax - grails - Spring Security 核心插件 - ajax 调用 - 无效的记住我令牌不匹配。

> ID：14429682
> 
> 赞同：0
> 
> 时间：2013-01-20T21:42:58.893
> 
> 标签：ajax, grails, jqgrid, spring-security, remember-me

我在登录`ajax`后的第一次通话中收到以下错误。`remember-me`（导致手动登录。）

奇怪的是`persistent_login`记录被删除，然后它试图找到具有相同键的记录。

（使用 tomcat 和最新的 grails 版本和最新的插件）

**下面的完整调试日志：（感谢您的帮助！）**

```
2013-01-20 13:34:14,261 [http-bio-8080-exec-3] DEBUG hibernate.SQL  - 
    delete 
    from 
        grails_persistent_login 
    where 
        series=? 
2013-01-20 13:34:14,262 [http-bio-8080-exec-3] TRACE sql.BasicBinder  - binding parameter [1] as [VARCHAR] - 0V7Xge3Qqb0Nged8S9BeJQ== 
2013-01-20 13:34:14,270 [http-bio-8080-exec-3] DEBUG rememberme.PersistentTokenBasedRememberMeServices  - Cancelling cookie 
2013-01-20 13:34:14,270 [http-bio-8080-exec-3] DEBUG context.HttpSessionSecurityContextRepository  - SecurityContext is empty or anonymous - context will not be stored in HttpSession. 
2013-01-20 13:34:14,270 [http-bio-8080-exec-3] DEBUG context.SecurityContextPersistenceFilter  - SecurityContextHolder now cleared, as request processing completed 
| Error 2013-01-20 13:34:14,274 [http-bio-8080-exec-3] ERROR [/].[default]  - Servlet.service() for servlet [default] in context with path [] threw exception 
Message: Invalid remember-me token (Series/token) mismatch. Implies previous cookie theft attack. 
    Line | Method 
->> 1110 | runWorker in java.util.concurrent.ThreadPoolExecutor 
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    603 | run       in java.util.concurrent.ThreadPoolExecutor$Worker 
^    722 | run . . . in java.lang.Thread 
2013-01-20 13:34:14,295 [http-bio-8080-exec-7] DEBUG access.ExceptionTranslationFilter  - Chain processed normally 
2013-01-20 13:34:14,305 [http-bio-8080-exec-7] DEBUG context.HttpSessionSecurityContextRepository  - HttpSession being created as SecurityContext is non-default 
2013-01-20 13:34:14,305 [http-bio-8080-exec-7] WARN  context.HttpSessionSecurityContextRepository  - Failed to create a session, as response has been committed. Unable to store SecurityContext. 
2013-01-20 13:34:14,305 [http-bio-8080-exec-7] DEBUG context.SecurityContextPersistenceFilter  - SecurityContextHolder now cleared, as request processing completed 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - Converted URL to lowercase, from: '/grails-errorhandler'; to: '/grails-errorhandler' 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - Candidate is: '/grails-errorhandler'; pattern is / **; matched=true 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 1 of 9 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter' 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG context.HttpSessionSecurityContextRepository  - No HttpSession currently exists 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG context.HttpSessionSecurityContextRepository  - No SecurityContext was available from the HttpSession: null. A new one will be created. 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 2 of 9 in additional filter chain; firing Filter: 'MutableLogoutFilter' 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 3 of 9 in additional filter chain; firing Filter: 'RequestHolderAuthenticationFilter' 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 4 of 9 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter' 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 5 of 9 in additional filter chain; firing Filter: 'RememberMeAuthenticationFilter' 
2013-01-20 13:34:14,312 [http-bio-8080-exec-3] DEBUG rememberme.PersistentTokenBasedRememberMeServices  - Remember-me cookie detected 
2013-01-20 13:34:14,313 [http-bio-8080-exec-3] DEBUG hibernate.SQL  - 
    select 
        persistent0_.series as series23_0_, 
        persistent0_.last_used as last2_23_0_, 
        persistent0_.token as token23_0_, 
        persistent0_.username as username23_0_ 
    from 
        grails_persistent_login persistent0_ 
    where 
        persistent0_.series=? 
2013-01-20 13:34:14,313 [http-bio-8080-exec-3] TRACE sql.BasicBinder  - binding parameter [1] as [VARCHAR] - 0V7Xge3Qqb0Nged8S9BeJQ== 
2013-01-20 13:34:14,315 [http-bio-8080-exec-3] DEBUG rememberme.PersistentTokenBasedRememberMeServices  - No persistent token found for series id: 0V7Xge3Qqb0Nged8S9BeJQ== 
2013-01-20 13:34:14,315 [http-bio-8080-exec-3] DEBUG rememberme.PersistentTokenBasedRememberMeServices  - Cancelling cookie 
2013-01-20 13:34:14,315 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 6 of 9 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter' 
2013-01-20 13:34:14,316 [http-bio-8080-exec-3] DEBUG authentication.AnonymousAuthenticationFilter  - Populated SecurityContextHolder with anonymous token: 'org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS' 
2013-01-20 13:34:14,316 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 7 of 9 in additional filter chain; firing Filter: 'ExceptionTranslationFilter' 
2013-01-20 13:34:14,316 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 8 of 9 in additional filter chain; firing Filter: 'FilterSecurityInterceptor' 
2013-01-20 13:34:14,317 [http-bio-8080-exec-3] DEBUG intercept.FilterSecurityInterceptor  - Secure object: FilterInvocation: URL: /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc; Attributes: [IS_AUTHENTICATED_ANONYMOUSLY] 
2013-01-20 13:34:14,317 [http-bio-8080-exec-3] DEBUG intercept.FilterSecurityInterceptor  - Previously Authenticated: org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS 
2013-01-20 13:34:14,317 [http-bio-8080-exec-3] DEBUG hierarchicalroles.RoleHierarchyImpl  - getReachableGrantedAuthorities() - From the roles [ROLE_ANONYMOUS] one can reach [ROLE_ANONYMOUS] in zero or more steps. 
2013-01-20 13:34:14,317 [http-bio-8080-exec-3] DEBUG intercept.FilterSecurityInterceptor  - Authorization successful 
2013-01-20 13:34:14,318 [http-bio-8080-exec-3] DEBUG intercept.FilterSecurityInterceptor  - RunAsManager did not change Authentication object 
2013-01-20 13:34:14,318 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 9 of 9 in additional filter chain; firing Filter: 'SwitchUserFilter' 
2013-01-20 13:34:14,318 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails-errorhandler?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc reached end of additional filter chain; proceeding with original chain 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - Converted URL to lowercase, from: '/grails/error/development500.dispatch'; to: '/grails/error/development500.dispatch' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - Candidate is: '/grails/error/development500.dispatch'; pattern is /**; matched=true 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 1 of 9 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 2 of 9 in additional filter chain; firing Filter: 'MutableLogoutFilter' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 3 of 9 in additional filter chain; firing Filter: 'RequestHolderAuthenticationFilter' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 4 of 9 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 5 of 9 in additional filter chain; firing Filter: 'RememberMeAuthenticationFilter' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG rememberme.RememberMeAuthenticationFilter  - SecurityContextHolder not populated with remember-me token, as it already contained: 'org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS' 
2013-01-20 13:34:14,321 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 6 of 9 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter' 
2013-01-20 13:34:14,322 [http-bio-8080-exec-3] DEBUG authentication.AnonymousAuthenticationFilter  - SecurityContextHolder not populated with anonymous token, as it already contained: 'org.springframework.security.authentication.AnonymousAuthenticationToken@9055c2bc: Principal: anonymousUser; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@b364: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: null; Granted Authorities: ROLE_ANONYMOUS' 
2013-01-20 13:34:14,322 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 7 of 9 in additional filter chain; firing Filter: 'ExceptionTranslationFilter' 
2013-01-20 13:34:14,322 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 8 of 9 in additional filter chain; firing Filter: 'FilterSecurityInterceptor' 
2013-01-20 13:34:14,322 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc at position 9 of 9 in additional filter chain; firing Filter: 'SwitchUserFilter' 
2013-01-20 13:34:14,322 [http-bio-8080-exec-3] DEBUG web.FilterChainProxy  - /grails/error/development500.dispatch?brokerageOrderId=95&_search=false&nd=1358710454208&max=100000&page=1&sort=id&order=asc reached end of additional filter chain; proceeding with original chain 
2013-01-20 13:34:14,690 [http-bio-8080-exec-3] DEBUG access.ExceptionTranslationFilter  - Chain processed normally 
2013-01-20 13:34:14,755 [http-bio-8080-exec-3] DEBUG access.ExceptionTranslationFilter  - Chain processed normally 
2013-01-20 13:34:14,755 [http-bio-8080-exec-3] DEBUG context.HttpSessionSecurityContextRepository  - SecurityContext is empty or anonymous - context will not be stored in HttpSession. 
2013-01-20 13:34:14,755 [http-bio- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T04:01:59.647

从日志看来，用户`username:anonymousUser, role:ROLE_ANONYMOUS`身份验证成功，但`rememberme.PersistentTokenBasedRememberMeServices`不支持anonymousUser，它取消了为该用户创建cookie。

# gcc - mac 10.6.8 上的彩色 gcc 输出？

> ID：14429684
> 
> 赞同：1
> 
> 时间：2013-01-20T21:43:25.373
> 
> 标签：gcc, text-coloring

我听说过 colorgcc 用于在命令行上为 gcc 输出着色，但我找不到有关如何在 mac 上运行它的文档（如果它甚至可以？）。我不太愿意切换到 IDE，所以如果有任何 gcc 着色输出的替代方案，那就太棒了。

谢谢

# r - 循环更改多个数据帧

> ID：14429686
> 
> 赞同：3
> 
> 时间：2013-01-20T21:44:05.520
> 
> 标签：r, for-loop, dataframe

例如，我有这三个数据集（在我的例子中，它们更多并且有很多变量）：

```
data_frame1 <- data.frame(a=c(1,5,3,3,2), b=c(3,6,1,5,5), c=c(4,4,1,9,2))
data_frame2 <- data.frame(a=c(6,0,9,1,2), b=c(2,7,2,2,1), c=c(8,4,1,9,2))
data_frame2 <- data.frame(a=c(0,0,1,5,1), b=c(4,1,9,2,3), c=c(2,9,7,1,1)) 
```

在每个数据帧上，我想添加一个变量，该变量是对该数据帧上现有变量的转换产生的。我会通过一个循环来做到这一点。例如：

```
datasets <- c("data_frame1","data_frame2","data_frame3")
vars <- c("a","b","c")
for (i in datasets){
    for (j in vars){
        # here I need a code that create a new variable with transformed values
        # I thought this would work, but it didn't...
        get(i)$new_var <- log(get(i)[,j])
    }
} 
```

你对此有一些有效的建议吗？

此外，如果还可以`new_var`通过字符串分配新列名（在这种情况下），那对我来说会很棒，这样我就可以通过嵌套在其他两个中的另一个 for 循环来创建新变量。

希望我没有太纠结于解释我的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T22:01:52.507

您可以将数据框放在一个列表中，并使用`lapply`它们一一进行处理。所以在这种情况下不需要使用循环。

例如，您可以这样做：

```
data_frame1 <- data.frame(a=c(1,5,3,3,2), b=c(3,6,1,5,5), c=c(4,4,1,9,2))
data_frame2 <- data.frame(a=c(6,0,9,1,2), b=c(2,7,2,2,1), c=c(8,4,1,9,2))
data_frame3 <- data.frame(a=c(0,0,1,5,1), b=c(4,1,9,2,3), c=c(2,9,7,1,1))

ll <- list(data_frame1,data_frame2,data_frame3)
lapply(ll,function(df){
  df$log_a <- log(df$a)          ## new column with the log a
  df$tans_col <- df$a+df$b+df$c  ## new column with sums of some columns or any other           
                                 ##   transformation
  ###  .....
  df

}) 
```

dataframe1 变为：

```
[[1]]
  a b c     log_a tans_col
1 1 3 4 0.0000000        8
2 5 6 4 1.6094379       15
3 3 1 1 1.0986123        5
4 3 5 9 1.0986123       17
5 2 5 2 0.6931472        9 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-12T22:00:56.140

我有同样的需求，也想更改我的实际数据框列表中的列。

我在[这里](https://community.rstudio.com/t/simplest-way-to-modify-the-same-column-in-multiple-dataframes-in-a-list/13076)找到了一个很好的方法（`purrr::map2`问题中的方法适用于具有不同列的数据框），然后是

```
list2env(list_of_dataframes ,.GlobalEnv) 
```

# ruby - 我将如何从锚点列表中搜索“/aems/dic/list”？

> ID：14429687
> 
> 赞同：0
> 
> 时间：2013-01-20T21:44:07.940
> 
> 标签：ruby, mechanize, selenium-webdriver

我有以下代码，它是 html 的一部分：

```
<td><a href="http://youtube.com">YouTube</a></td>
<td><a data-category="news" href=http://kathack.com/party/aems/dic/list">Reddit</a></td>
<td><a href="http://kathack.com/party/aems">Kathack</a></td>
<td><a data-category="news" href="http://www.nytimes.com">New York Times</a></td> 
```

现在我将如何搜索`/aems/dic/list`并获取完整的 url 存储？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T02:14:02.600

假设您有一个 Mechanize::Page 对象`page`：

```
page.at('a[href*="/aems/dic/list"]')[:href]
#=> "http://kathack.com/party/aems/dic/list" 
```

**更新**

对于更长的示例：

```
require 'mechanize'
agent = Mechanize.new
page = agent.get 'http://www.example.com/'
page.at('a[href*="/aems/dic/list"]')[:href]
#=> "http://kathack.com/party/aems/dic/list" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T22:14:43.697

所以，有了`nokogiri`，像这样：

```
fragment = Nokogiri::HTML::DocumentFragment.parse text
fragment.css("a").each do |link|
  href = link['href']
  return href if href =~ /\/aems\/dic\/list/
end 
```

# node.js - 本地主机上的 Socket.io + Express CORS 错误（Access-Control-Allow-Origin 不允许）

> ID：14429691
> 
> 赞同：2
> 
> 时间：2013-01-20T21:44:29.727
> 
> 标签：node.js, socket.io

我有一个可以工作的 node.js Express 服务器，我想向它添加 socket.io 支持（允许 javascript 客户端通过 socket.io 连接）。我可以通过 Javascript $.get() 连接到 express 服务器，但是由于 CORS 错误，socket.io.connect() 命令失败。

我的测试机器是带有 Apache 的 OSX 为客户端提供服务，因此使用了 80 端口，所以我在 8888 端口上运行了 node.js/express。我根据文档添加了 socket.io：

```
var exp = express();
var server = require('http').createServer(api.server);
exp.listen(8888);

var io = require('socket.io').listen(server);
io.sockets.on('connection', function(socket) {
     console.log('connection'); 
}); 
```

我在我的 node.js 日志中正确地看到了“信息：socket.io 已启动”。

然后，在客户端，我尝试连接到服务器......

```
 this.socket = io.connect('http://localhost:8888');
    this.socket.on('connect',function() {
        socket.emit('install','test');
    }); 
```

但是，我在 Chrome 的控制台中收到了 CORS 错误：

```
XMLHttpRequest cannot load http://localhost:8888/socket.io/1/?t=1358715637192\. Origin http://localhost is not allowed by Access-Control-Allow-Origin. 
```

但是，这很好用！

```
 $.get('http://localhost:8888',function(e,d){
        console.log(e,d); 
    }); 
```

因此，我仔细检查了 localhost:8888 和 localhost 的标头 - 两者都正确返回了（应该）允许跨域请求的标头...

访问控制允许来源：*

![在此处输入图像描述](../Images/3b4aa2632d2300e6b615a4958736cfb5.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:01:40.097

CORS 是一件非常棘手的事情（或者至少对我来说是这样）。我在这里推荐这个资源：http: [//enable-cors.org/](http://enable-cors.org/)

遵循他们所做的非常仔细地帮助了我。我还发现不同的浏览器对 CORS 请求/响应提供了不同的可见性，这有帮助。

我发现 Chrome 比 firefox 更容易上手，但 firefox 工具（例如 firebug）使用起来非常好。

从您的信息中我的直觉是，您可能需要您的请求在请求属性中包含 X-Request-With。

我还发现使用提琴手发送 http 请求可以让我最初将问题缩小到服务器端并使其正常工作。你会发现浏览器强制执行 CORS，但像 fidler 这样的东西不会，因此提供了另一种检查正在发生的事情的方法。

我绝对建议尝试将问题分成两半，以便您可以查看是服务器端还是客户端的行为不符合您的预期。

我的问题与为 OPTIONS 标头返回与 POST 或 GET 相同的 CORS 响应有关。那是错误的。铬允许它。火狐没有。发出的任何选项请求都将被发送一次，然后在将来它将被缓存而不是重新发送（这最初给我造成了很多困惑）。对于选项请求，您只需要一个标准回复，说明可以继续，然后在帖子或获取回复中，我相信您只需要您的 cors 回复。

# windows - VB DLL 帮助 - 如何检测发件人

> ID：14429694
> 
> 赞同：-1
> 
> 时间：2013-01-20T21:44:45.433
> 
> 标签：windows, vb.net, dll

我创建了一个 VB.NET，里面有两个项目。一个是带有一个类文件的类库（比如说 Clas1.vb），另一个只是一种形式。我将 Class library 引用到另一种形式中，因此我可以在其中使用它的方法。但是，Class1.vb 无法获取正在使用它的项目。那么我将如何处理单击 Form1 上的按钮的位置，并且它背后的代码是 ClasslibraryInProject.Class1.MaximizeForm() Class1.vb 知道哪个项目/表单将该命令传递给它，然后它执行 Windowsstate = FormWindowState.Form1 上的最大化命令。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T23:26:40.347

一个稍微简单的方法就是将表单传递给您的 MaximizeForm 函数：

```
Public Class Class1
    Public Sub MaximizeForm(sender as Object)
        Select Case sender.Name
        Case "Form1"
            ' cast the sender as a form and maximize it
            Directcast(sender,Form).WindowState = FormWindowState.Maximized
        Case Else
            ' ...
        End Select
    End Sub
End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T23:16:23.567

一种方法是让您的构造函数要求父级与其关联：

```
Public Class Class1
    Private _parent as Form
    Public Sub New (form as Form)
        _parent = form
    End Sub
    '...
End Class 
```

在您的表单中，当您创建它时，您在构造函数中设置该属性：

```
'...
Dim myClass1 as New Class1 (Me) ' The parent form
'... 
```

然后，在 Class1 中，您可以测试该属性：

```
Public Class Class1
    Private _parent as Form
    Public Sub New (form as Form)
        _parent = form
    End Sub
    Public Sub DoStuff
        If _parent.Name = "whatever" Then
        '...
        End If
    End Sub

End Class 
```

这是相当标准的，您会在 .Net 框架内的对话框和消息框中看到类似的行为。

根据父表单的名称来做这件事有点恶心。但这是另一天的讨论；）

# c++ - 动态 3d 数组的声明和赋值

> ID：14429699
> 
> 赞同：1
> 
> 时间：2013-01-20T21:45:23.397
> 
> 标签：c++, arrays, class, 3d

我已经为 3d 数组制作了下一堂课。例如，将变量声明为

```
Grid3d n = Grid3d(2,2,2);
n(0,0,0) = 1; 
```

工作正常，但将其声明为

```
Grid3d n;
n = Grid3d(2,2,2);
n(0,0,0) = 1; 
```

给我一个分段错误，问题似乎是默认构造函数，但我不知道如何解决它，有什么线索吗？

```
#ifndef _GRID3D_
#define _GRID3D_

#include <iostream>
#include <cmath>
#include <cassert>  // assert()

using namespace std;

class Grid3d
{
private:
    int L;
    int M;
    int N;
    double *** G;

public:
    Grid3d(int,int,int);
    Grid3d();
    Grid3d(const Grid3d &);
    ~Grid3d();

    double & operator()(int,int,int);
};
#endif

//Constructor
Grid3d::Grid3d(int L,int M,int N)
    :L(L), M(M), N(N)
{
    int i,j,k;
    G = new double ** [L];
    for (i=0;i<L;i++){
        G[i] = new double * [M];
        for (j=0;j<M;j++){
            G[i][j] = new double [N];
            for (k=0;k<N;k++){
                G[i][j][k] = 0;
            }
        }
    }
}

//Constructor vacío
Grid3d::Grid3d()
    :L(0), M(0), N(0)
{
    G = NULL;
}

//Constructor copia
Grid3d::Grid3d(const Grid3d &A)
    :L(A.L), M(A.M), N(A.N)
{
    G = new double ** [L];
    int i,j,k;
    for (i=0;i<L;i++){
        G[i] = new double * [M];
        for (j=0;j<M;i++){
            G[i][j] = new double [N];
            for (k=0;k<N;k++){
                G[i][j][k] = A.G[i][j][k];
            }
        }
    }
}

//Destructor
Grid3d::~Grid3d()
{
    // Libera memoria
    for (int i=0;i<L;i++){
        for (int j=0;j<M;j++){
            delete [] G[i][j];
            G[i][j] = NULL;
        }
        delete [] G[i];
        G[i] = NULL;
    }
    delete G;
    G = NULL;
}

double& Grid3d::operator()(int i,int j,int k)
{
    assert(i >= 0 && i < L);
    assert(j >= 0 && j < M);
    assert(k >= 0 && k < N);
    return G[i][j][k];
} 
```

赋值运算符

```
Grid3d Grid3d::operator = (const Grid3d &A)
{
    if (this == &A) {return *this;};
    if (G != NULL){
        // Libera memoria
        for (int i=0;i<L;i++){
            for (int j=0;j<M;j++){
                delete [] G[i][j];
                G[i][j] = NULL;
            }
            delete [] G[i];
            G[i] = NULL;
        }
        delete G;
        G = NULL;
    }

    L = A.L;
    M = A.M;
    N = A.N;
    G = new double ** [L];
    int i,j,k;
    for (i=0;i<L;i++){
        G[i] = new double * [M];
        for (j=0;j<M;i++){
            G[i][j] = new double [N];
            for (k=0;k<N;k++){
                G[i][j][k] = A.G[i][j][k];
            }
        }
    }
    return *this;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:00:40.377

这是一个微不足道的错字。我会指出这条线，我会让你发现哪里出了问题：

```
for (j=0;j<M;i++) 
```

也就是说，除了丢失的赋值运算符之外，它`n = Grid3d(2,2,2);`会释放原始构造的对象，因此您正在使用`G[i][j][k]`NULL`operator()`指针进行访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T22:05:35.893

您已经动态分配了内存，但您没有遵循[三的规则](http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29)。您缺少赋值运算符，因此当您执行此操作时：

```
Grid3d n;
n = Grid3d(2,2,2); // both RHS temporary and n point to the same data.
n(0,0,0) = 1;      // Accessing deleted memory: undefined behaviour. 
```

您将尝试对同一内存进行两次取消分配，因为您的`n`' 指针指向与第二行中用于分配给它的临时内存相同的内存。当临时死亡时，它会取消分配它的内存。当`n`死亡时，它会尝试取消分配相同的内存。此外，在第二行之后对该内存的任何访问都是未定义的行为。

# ruby-on-rails - 如何使用 Model 和 controller not view 获取如下所示的记录？

> ID：14429702
> 
> 赞同：0
> 
> 时间：2013-01-20T21:45:32.787
> 
> 标签：ruby-on-rails, ruby-on-rails-3

如何使用 Model 和 controller not view 获取如下所示的记录？

**模式1。有帮手**

application_helper

```
def user_link(username)
    link_to User.find_by_username(username).user_profile.nickname, show_user_path(username)
end 
```

看法

```
<% @topics.order("updated_at DESC").limit(100).each do |topic| %>
    <%= user_link(topic.comment_threads.order("id").last.user.username) if topic.comment_threads.present? %>
<% end %> 
```

**模式2。没有帮手。只看**

```
<% @topics.order("updated_at DESC").limit(100).each do |topic| %>
    <%= link_to(topic.comment_threads.order("id").last.user.nickname, show_user_path(topic.comment_threads.order("id").last.user.username) ) if topic.comment_threads.present? %>
<% end %> 
```

**更新**

```
 <%  @community.topics.eager.recent.each do |topic| %>
    <%= user_link(topic.comment_threads.order("id").last.user.username) if topic.comment_threads.present? %>
  <% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:59:34.927

SQL 代码或 SQL 构建器永远不应该到达视图层。这应该在您的模型中。我什至不会在控制器中放置这样的查询。

我会将`topic`SQL 构建器提取到命名范围中。最重要的是，为了避免 n+1 查询，我将创建另一个命名范围`eager`：

```
# topic.rb

scope :eager, includes(comment_threads: :user)
scope :recent, lambda { |n = 100| order("updated_at DESC").limit(n) } 
```

然后我`comment_threads`会将 SQL 构建器移动到您的 comment_threads 模型中：

```
# comment_thread.rb

def self.last_user_nickname
  order("id").last.user.nickname
end 
```

我们现在可以整理您的意见：

```
<% @topics.eager.recent.each do |topic| %>
  <%= user_link(topic.comment_threads.last_user_nickname) if topic.comment_threads.present? %>
<% end %> 
```

请允许我把[Slim](http://slim-lang.com/)卖给你（erb 替代品）：

```
- @topics.eager.recent.each do |topic|
  = user_link(topic.comment_threads.last_user_nickname) if topic.comment_threads.present? 
```

我什至可能更进一步，将其提取`user_link`到`UserDecorator`. 有关详细信息，请参阅[https://github.com/drapergem/draper](https://github.com/drapergem/draper)。

# 概括

1.  提取 SQL builder for `topic`into`eager`和`recent`scopes 下`topic`
2.  提取 SQL builder for `comment_threads`into `last_user_nickname`under`comment_thread`
3.  研究提取`user_link`成`UserDecorator`
4.  使用苗条！:)

# python - 何时在进程上调用 .join()？

> ID：14429703
> 
> 赞同：36
> 
> 时间：2013-01-20T21:45:34.940
> 
> 标签：python, multiprocessing

我正在阅读有关 Python 中多处理模块的各种教程，并且无法理解为什么/何时调用`process.join()`. 例如，我偶然发现了这个例子：

```
nums = range(100000)
nprocs = 4

def worker(nums, out_q):
    """ The worker function, invoked in a process. 'nums' is a
        list of numbers to factor. The results are placed in
        a dictionary that's pushed to a queue.
    """
    outdict = {}
    for n in nums:
        outdict[n] = factorize_naive(n)
    out_q.put(outdict)

# Each process will get 'chunksize' nums and a queue to put his out
# dict into
out_q = Queue()
chunksize = int(math.ceil(len(nums) / float(nprocs)))
procs = []

for i in range(nprocs):
    p = multiprocessing.Process(
            target=worker,
            args=(nums[chunksize * i:chunksize * (i + 1)],
                  out_q))
    procs.append(p)
    p.start()

# Collect all results into a single result dict. We know how many dicts
# with results to expect.
resultdict = {}
for i in range(nprocs):
    resultdict.update(out_q.get())

# Wait for all worker processes to finish
for p in procs:
    p.join()

print resultdict 
```

据我了解，`process.join()`将阻塞调用进程，直到调用其 join 方法的进程完成执行。我也相信上述代码示例中启动的子进程在完成目标函数后，即在他们将结果推送到`out_q`. 最后，我相信这会`out_q.get()`阻止调用过程，直到有结果要提取。因此，如果您考虑以下代码：

```
resultdict = {}
for i in range(nprocs):
    resultdict.update(out_q.get())

# Wait for all worker processes to finish
for p in procs:
    p.join() 
```

主进程被`out_q.get()`调用阻塞，直到*每个工作进程*完成将其结果推送到队列。因此，当主进程退出 for 循环时，每个子进程都应该已完成执行，对吗？

如果是这种情况，此时是否有任何理由调用这些`p.join()`方法？不是所有的工作进程都已经完成，那么这如何导致主进程“等待所有工作进程完成”？我问主要是因为我在多个不同的示例中看到了这一点，并且我很好奇我是否无法理解某些内容。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-20T22:04:59.907

在您调用之前`join`，所有工作人员都已将他们的结果放入他们的队列中，但他们不一定会返回，他们的进程可能还没有终止。他们可能会也可能不会这样做，这取决于时间。

调用`join`确保所有进程都有时间正确终止。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-20T22:28:38.443

尝试运行这个：

```
import math
import time
from multiprocessing import Queue
import multiprocessing

def factorize_naive(n):
    factors = []
    for div in range(2, int(n**.5)+1):
        while not n % div:
            factors.append(div)
            n //= div
    if n != 1:
        factors.append(n)
    return factors

nums = range(100000)
nprocs = 4

def worker(nums, out_q):
    """ The worker function, invoked in a process. 'nums' is a
        list of numbers to factor. The results are placed in
        a dictionary that's pushed to a queue.
    """
    outdict = {}
    for n in nums:
        outdict[n] = factorize_naive(n)
    out_q.put(outdict)

# Each process will get 'chunksize' nums and a queue to put his out
# dict into
out_q = Queue()
chunksize = int(math.ceil(len(nums) / float(nprocs)))
procs = []

for i in range(nprocs):
    p = multiprocessing.Process(
            target=worker,
            args=(nums[chunksize * i:chunksize * (i + 1)],
                  out_q))
    procs.append(p)
    p.start()

# Collect all results into a single result dict. We know how many dicts
# with results to expect.
resultdict = {}
for i in range(nprocs):
    resultdict.update(out_q.get())

time.sleep(5)

# Wait for all worker processes to finish
for p in procs:
    p.join()

print resultdict

time.sleep(15) 
```

并打开任务管理器。您应该能够看到 4 个子进程在被操作系统终止之前进入僵尸状态几秒钟（由于加入调用）：

![在此处输入图像描述](../Images/1ffc6a479471491b540a1ba60adc9649.png)

在更复杂的情况下，子进程可能永远处于僵尸状态（就像您在另一个[问题](https://stackoverflow.com/questions/14423826/how-does-a-python-process-know-when-to-exit/14423951#14423951)中询问的情况一样），如果您创建足够多的子进程，您可以填充进程表，从而给操作系统带来麻烦（这可能会杀死避免失败的主要过程）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-09T22:12:58.827

我不完全确定实现细节，但 join 似乎也有必要反映一个进程确实已经终止（例如在调用 terminate 之后）。[在此处的示例](https://pymotw.com/2/multiprocessing/basics.html)中，如果您在终止进程后未调用 join ，`process.is_alive()`则会返回`True`，即使该进程已通过`process.terminate()`调用终止。

# php - 在 symfony 1.4 中配置 factory.yml

> ID：14429709
> 
> 赞同：0
> 
> 时间：2013-01-20T21:45:42.490
> 
> 标签：php, symfony-1.4, mailer

起初我有 emial`aaa@bbb.com`并且有另一封不属于我的电子邮件，例如`ccc@ddd.com`blabla@bla.com

`IN factories.yml`我用以下配置了邮件程序

```
mailer:
  class: sfMailer
  param:
    logging:           %SF_LOGGING_ENABLED%
    charset:           %SF_CHARSET%
    delivery_strategy: realtime
    transport:
      class: Swift_SmtpTransport
      param:
        host:       smtp.localhost.com
        port:       25
        username:   aaa@bbb.com
        password:   123456 
```

在代码中...发送我使用的电子邮件

```
 $message = Swift_Message::newInstance()->setSubject('sub')->setFrom('ccc@ddd.com')->setTo('yahoo@yahoo.com');
         sfContext::getInstance()->getMailer()->send($message); 
```

现在我 setFrom() --->`ccc@ddd.com`但是我`factories.yml`用另一封电子邮件配置了`aaa@bbb.com`！！！！

最后发送的邮件`ccc@ddd.com`实际上不是我的电子邮件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:51:56.000

该`factories.yml`文件详细说明 SMTP 详细信息

```
param:
    host:       smtp.localhost.com
    port:       25
    username:   aaa@bbb.com
    password:   123456 
```

这`username`是用于登录 smtp 服务器的用户名。不是发送电子邮件的电子邮件地址。

这条线

```
$message = Swift_Message::newInstance()
                  ->setSubject('sub')
                  ->setFrom('ccc@ddd.com') 
```

确定电子邮件的发件人地址。

[有关方法，请参阅 swift mailer 的文档](http://swiftmailer.org/docs/messages.html#the-structure-of-a-message)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T18:10:16.587

工厂参数仅用于 smtp 验证。以我的经验，大多数客户不接受从与电子邮件中定义的网站不同的网站发出的邮件。

例如，

```
param:
    host:       smtp.example.com
    port:       25
    username:   mail@example.com
    password:   123 
```

可以从any@example.com 发送没有问题的邮件，但不能从any@otherdomain.com 发送邮件。大多数情况下都会被拒绝。

当主机是 localhost 时也是如此，只有在您使用托管应用程序的域时它才能正常工作。

```
param:
        host:       localhost
        port:       25
        username:   mail@localorassociatedmail.com
        password:   123 
```

如果托管在 aaa.com 上，它只能与 From: 设置为anything@aaa.com 一起正常工作。

如果它被认为是垃圾邮件，我不介意，在某些情况下它甚至不会消失。

# java - 在使用存储在 amazon s3 上的数据运行 Map reduce WordCount 作业时需要帮助

> ID：14429714
> 
> 赞同：3
> 
> 时间：2013-01-20T21:46:30.290
> 
> 标签：java, hadoop, amazon-s3, mapreduce

我正在尝试对存储在 Amazon s3 上的存储桶中的文本文件运行 Map reduce WordCount 作业。我已经为 map reduce 框架设置了与 Amazon 通信所需的所有身份验证，但我继续运行此错误。知道为什么会这样吗？

```
13/01/20 13:22:15 ERROR security.UserGroupInformation:
PriviledgedActionException as:root
cause:org.apache.hadoop.mapred.InvalidInputException: Input path does
not exist: s3://name-bucket/test.txt
Exception in thread "main"
org.apache.hadoop.mapred.InvalidInputException: Input path does not
exist: s3://name-bucket/test.txt
    at org.apache.hadoop.mapred.FileInputFormat.listStatus(FileInputFormat.java:197)
    at org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:208)
    at org.apache.hadoop.mapred.JobClient.writeOldSplits(JobClient.java:989)
    at org.apache.hadoop.mapred.JobClient.writeSplits(JobClient.java:981)
    at org.apache.hadoop.mapred.JobClient.access$600(JobClient.java:174)
    at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:897)
    at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:850)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:416)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
    at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:850)
    at org.apache.hadoop.mapred.JobClient.submitJob(JobClient.java:824)
    at org.apache.hadoop.mapred.JobClient.runJob(JobClient.java:1261)
    at org.myorg.WordCount.main(WordCount.java:55)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:156) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T00:04:52.487

您实际上必须将协议替换`s3`为`s3n`. 这些是具有不同属性的 2 个不同的文件系统：

*   **s3n 是 s3 Native Filesystem**：用于在 S3 上读取和写入常规文件的本机文件系统。此文件系统的优点是您可以访问 S3 上使用其他工具编写的文件。相反，其他工具可以访问使用 Hadoop 编写的文件。缺点是 S3 对文件大小施加了 5GB 的限制。由于这个原因，它不适合作为 HDFS（支持非常大的文件）的替代品。
*   **s3 是块文件系统**：由 S3 支持的基于块的文件系统。文件存储为块，就像它们在 HDFS 中一样。这允许有效地实现重命名。此文件系统要求您为文件系统专用一个存储桶 - 您不应使用包含文件的现有存储桶，或将其他文件写入同一存储桶。此文件系统存储的文件可以大于 5GB，但它们不能与其他 S3 工具互操作。

（[来源](http://wiki.apache.org/hadoop/AmazonS3)）

在您的情况下，您的存储桶可能正在使用`s3n`文件系统，我相信这是默认设置，我使用的大多数存储桶也是`s3n`. 所以你应该使用`s3n://name-bucket/test.txt`

# php - 搜索表单发布数据和平面 URL

> ID：14429718
> 
> 赞同：3
> 
> 时间：2013-01-20T21:47:09.077
> 
> 标签：php, forms, url

我有一个基于标签过滤文章的表单。因此，用户可以`example.com/news`使用发布数据访问提交要过滤的标签（例如 tag1、tag2），这将使用过滤后的文章重新加载页面，但 URL 相同。

以下网址将带回相同的文章：`example.com/news/tag1+tag2`

两种方法都通过同一个控制器。我想让使用表单按标签过滤的用户重定向到`example.com/news/tag1+tag2`url 格式。

这样做的最佳方法是什么？是否会通过搜索控制器发送所有标签过滤器请求，然后创建重定向到`example.com/news/tag1+tag2`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:52:13.103

似乎您不应该根据过滤标签的初始提交进行任何搜索。如果您通过一次搜索控制器然后重定向，您最终会执行*两次搜索*。

如果用户提交标签进行过滤，则*仅*使用这些标签来构建 URL 并直接重定向到包含过滤标签的 URL。由于您说它转到同一个搜索控制器，因此随后只会启动*一次*正确的搜索，并且用户的 URL 已经是您想要的最终结果。

因此，只需从中检索过滤后的标签`$_POST`并立即重定向到触发正确搜索的最终结果 URL。

伪 PHP

```
$valid_tags = array_filter($_POST['tags'], function($t) {
   // validate tags as alphanumeric (substitute the appropriate regex for your tag format)
   // this discards non-matching invalid tags.
   return preg_match('/^[a-z0-9]+$/i', $t);
});
// Don't forget to validate these tags in the search controller!
// Implode the tags (assuming they are received as an array) as a space separated string
// and urlencode() it
$tags = urlencode(implode(" ", $valid_tags));
header("Location: http://example.com/news/$tags");
exit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:50:25.120

```
$tags = 'tag1+tag2';
header ('Location: /news/' . $tags);
exit; 
```

# java - 从 OnItemClick 膨胀菜单

> ID：14429719
> 
> 赞同：0
> 
> 时间：2013-01-20T21:47:15.627
> 
> 标签：java, android, menu

我正在尝试从 OnItemClick 膨胀菜单。我查看了 android 开发者网站，并能够使用下面的第一个代码为 toast 充气。但是，当我尝试用 Menu Inflater 替换它时，它不起作用。你能帮我解决问题吗？第一组代码是可以工作的 toast inflater，第二组代码是不能正常工作的 Menu Inflater。当我点击一个项目时会弹出吐司，但菜单不会。该程序将无法运行，并说我在菜单充气器中有多个语法错误。虽然我无法解决它们。

```
package com.carouseldemo.main;

import com.carouseldemo.controls.Carousel;
import com.carouseldemo.controls.CarouselAdapter;
import com.carouseldemo.controls.CarouselItem;
import com.carouseldemo.controls.CarouselAdapter.OnItemClickListener;
import com.carouseldemo.controls.CarouselAdapter.OnItemSelectedListener;
import com.carouseldemo.main.R;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;

import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity implements OnClickListener {
/** Called when the activity is first created. */
 @Override
 public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);
     setContentView(R.layout.main);

    MediaPlayer mp = MediaPlayer.create(this, R.raw.radio);
    mp.start();
    Carousel carousel = (Carousel)findViewById(R.id.carousel);
    carousel.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(CarouselAdapter<?> parent, View view,
                int position, long id) {    

            LayoutInflater inflater = getLayoutInflater();
            View layout = inflater.inflate(R.layout.toast_layout,
                                           (ViewGroup) findViewById(R.id.toast_layout_root));

            TextView text = (TextView) layout.findViewById(R.id.text);
            text.setText("Welcome to Power Source International");

            Toast toast = new Toast(getApplicationContext());
            toast.setGravity(Gravity.CENTER_VERTICAL, 0, 0);
            toast.setDuration(Toast.LENGTH_LONG);
            toast.setView(layout);

        }

    });

    carousel.setOnItemSelectedListener(new OnItemSelectedListener(){

        public void onItemSelected(CarouselAdapter<?> parent, View view,
                int position, long id) {

            final TextView txt = (TextView)(findViewById(R.id.selected_item));

            switch(position){
            case 0:
                txt.setText("Power Source International ");
                break;
            case 1:
                txt.setText("Power Source International");
                break;
            case 2:
                txt.setText("Power Source International");
                break;
            case 3:
                txt.setText("Power Source International.");
                break;
            case 4:
                txt.setText("Power Source International");
            case 5:
                txt.setText("Power Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source International");
                break;
            }

        }

        public void onNothingSelected(CarouselAdapter<?> parent) {
        }

    }
    );

}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

}

} 
```

这可以正常工作。但是，当我尝试为菜单而不是吐司膨胀时，它不会。这是不起作用的代码，并且在菜单充气器中有语法错误。无论我尝试做什么，我都无法更正代码。

```
package com.carouseldemo.main;

import com.carouseldemo.controls.Carousel;
import com.carouseldemo.controls.CarouselAdapter;
import com.carouseldemo.controls.CarouselItem;
import com.carouseldemo.controls.CarouselAdapter.OnItemClickListener;
import com.carouseldemo.controls.CarouselAdapter.OnItemSelectedListener;
import com.carouseldemo.main.R;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.MenuInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;

import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity implements OnClickListener {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    MediaPlayer mp = MediaPlayer.create(this, R.raw.radio);
    mp.start();
    Carousel carousel = (Carousel)findViewById(R.id.carousel);
    carousel.setOnItemClickListener(new OnItemClickListener(){

        private Object v;

        public void onItemClick(CarouselAdapter<?> parent, View view,
                int position, long id) {    

            @Override
            public void onCreateContextMenu (ContextMenu menu, View v,
                                            ContextMenuInfo menuInfo) {
                super.onCreateContextMenu(menu, v, menuInfo);
                MenuInflater inflater = getMenuInflater();
                inflater.inflate(R.menu.context_menu, menu);
            }

        }

    });

    carousel.setOnItemSelectedListener(new OnItemSelectedListener(){

        public void onItemSelected(CarouselAdapter<?> parent, View view,
                int position, long id) {

            final TextView txt = (TextView)(findViewById(R.id.selected_item));

            switch(position){
            case 0:
                txt.setText("Power Source International ");
                break;
            case 1:
                txt.setText("Power Source International");
                break;
            case 2:
                txt.setText("Power Source International");
                break;
            case 3:
                txt.setText("Power Source International.");
                break;
            case 4:
                txt.setText("Power Source International");
            case 5:
                txt.setText("Power Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source International");
                break;
            }

        }

        public void onNothingSelected(CarouselAdapter<?> parent) {
        }

    }
    );

}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

}

} 
```

对此有何建议？先感谢您。

更新代码：

```
package com.carouseldemo.main;

import com.carouseldemo.controls.Carousel;
import com.carouseldemo.controls.CarouselAdapter;
import com.carouseldemo.controls.CarouselItem;
import com.carouseldemo.controls.CarouselAdapter.OnItemClickListener;
import com.carouseldemo.controls.CarouselAdapter.OnItemSelectedListener;
import com.carouseldemo.main.R;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.MenuInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;

import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity implements OnClickListener {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    MediaPlayer mp = MediaPlayer.create(this, R.raw.radio);
    mp.start();
    Carousel carousel = (Carousel)findViewById(R.id.carousel);
    carousel.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(CarouselAdapter<?> parent, View view,
                int position, long id) {    
            openContextMenu(view);

        }

        @Override
        public void onCreateContextMenu(ContextMenu menu, View v,
                ContextMenuInfo menuInfo) {

            super.onCreateContextMenu(menu, v, menuInfo);
            MenuInflater inflater = getMenuInflater();
            inflater.inflate(R.menu.context_menu, menu);

            // TODO Auto-generated method stub

        }

    });

    carousel.setOnItemSelectedListener(new OnItemSelectedListener(){

        public void onItemSelected(CarouselAdapter<?> parent, View view,
                int position, long id) {

            final TextView txt = (TextView)(findViewById(R.id.selected_item));

            switch(position){
            case 0:
                txt.setText("Power Source International ");
                break;
            case 1:
                txt.setText("Power Source International");
                break;
            case 2:
                txt.setText("Power Source International");
                break;
            case 3:
                txt.setText("Power Source International.");
                break;
            case 4:
                txt.setText("Power Source International");
            case 5:
                txt.setText("Power Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source International");
                break;
            }

        }

        public void onNothingSelected(CarouselAdapter<?> parent) {
        }

    }
    );

}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

}

} 
```

更新 2：

```
package com.carouseldemo.main;

import android.app.Activity;
import android.media.MediaPlayer;
import android.os.Bundle;
import android.view.ContextMenu;
import android.view.ContextMenu.ContextMenuInfo;
import android.view.MenuInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.TextView;

import com.carouseldemo.controls.Carousel;
import com.carouseldemo.controls.CarouselAdapter;
import com.carouseldemo.controls.CarouselAdapter.OnItemClickListener;
import com.carouseldemo.controls.CarouselAdapter.OnItemSelectedListener;

public class MainActivity extends Activity implements OnClickListener {
 @Override
  public void onCreateContextMenu (ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
  }

/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    MediaPlayer mp = MediaPlayer.create(this, R.raw.radio);
    mp.start();
    Carousel carousel = (Carousel)findViewById(R.id.carousel);
    carousel.setOnItemClickListener(new OnItemClickListener(){

        public void onItemClick(CarouselAdapter<?> parent, View view,
                int position, long id) {    
            openContextMenu(view);

        }

        @Override
        public void onCreateContextMenu(ContextMenu menu, View v,
                ContextMenuInfo menuInfo) {
            // TODO Auto-generated method stub

        }

    });

    carousel.setOnItemSelectedListener(new OnItemSelectedListener(){

        public void onItemSelected(CarouselAdapter<?> parent, View view,
                int position, long id) {

            final TextView txt = (TextView)(findViewById(R.id.selected_item));

            switch(position){
            case 0:
                txt.setText("Power Source International ");
                break;
            case 1:
                txt.setText("Power Source International");
                break;
            case 2:
                txt.setText("Power Source International");
                break;
            case 3:
                txt.setText("Power Source International.");
                break;
            case 4:
                txt.setText("Power Source International");
            case 5:
                txt.setText("Power Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source InternationalPower Source International");
                break;
            }

        }

        public void onNothingSelected(CarouselAdapter<?> parent) {
        }

    }
    );

}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:57:32.733

您应该尝试将您的`onCreateContextMenu()`方法移动到 Activity 的根目录，使其看起来像这样：

```
public class MainActivity extends Activity implements OnClickListener {

  @Override
  public void onCreateContextMenu (ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.context_menu, menu);
  }

  @Override
  public void onCreate(Bundle savedInstanceState) {
    //implementation
  }
  //rest of code
} 
```

那么你可能会想要这样的东西：

```
 public void onItemClick(CarouselAdapter<?> parent, View view,
                int position, long id) {    
     openContextMenu(view);
 } 
```

请注意，一旦用户点击一个项目，这将弹出上下文菜单。

# python - python logging - 如何将路径名截断为最后几个字符或文件名？

> ID：14429724
> 
> 赞同：8
> 
> 时间：2013-01-20T21:47:36.810
> 
> 标签：python, logging

我正在使用 python 日志记录，并且我有一个如下所示的格式化程序：

```
formatter = logging.Formatter(
    '%(asctime)s - %(pathname)86s - %(lineno)4s - %(message)s', '%d %H:%M'
    ) 
```

如您所见，我喜欢日志文件中的信息在列中整齐排列。我为路径名保留 86 个空格的原因是因为我的程序中使用的某些文件的完整路径太长了。但是，我真正需要的是实际文件名，而不是完整路径。如何让日志记录模块只给我文件名？更好的是，因为我有一些长文件名，我想要文件名的前 3 个字符，然后是“~”，然后是最后 16 个字符。所以

```
/Users/Jon/important_dir/dev/my_project/latest/testing-tools/test_read_only_scenarios_happily.py 
```

应该成为

```
tes~arios_happily.py 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-20T22:00:20.410

您必须实现自己的 Formatter 子类，为您截断路径；格式化字符串不能这样做：

```
import logging
import os

class PathTruncatingFormatter(logging.Formatter):
    def format(self, record):
        if isinstance(record.args, dict) and 'pathname' in record.args:
            # truncate the pathname
            filename = os.path.basename(record.args['pathname'])
            if len(filename) > 20:
                filename = '{}~{}'.format(filename[:3], filename[-16:])
            record.args['pathname'] = filename
        return super(PathTruncatingFormatter, self).format(record) 
```

使用此类而不是普通`logging.Formatter`实例：

```
formatter = logging.PathTruncatingFormatter(
    '%(asctime)s - %(pathname)86s - %(lineno)4s - %(message)s', '%d %H:%M'
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T21:50:36.023

像这样：

```
import os

def shorten_filename(filename):
    f = os.path.split(filename)[1]
    return "%s~%s" % (f[:3], f[-16:]) if len(f) > 19 else f 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-07-26T14:34:13.757

您可以简单地使用文件名而不是路径名。有关详细信息，请参阅[https://docs.python.org/3.1/library/logging.html#formatter-objects](https://docs.python.org/3.1/library/logging.html#formatter-objects)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-12T09:34:47.047

以下是 @Martijn 编写的 Python 3 版本。正如@Nick 指出的那样，传递的**记录**参数是 Python 3 中的 LogRecord 对象。

```
import logging
import os

class PathTruncatingFormatter(logging.Formatter):
    def format(self, record):
        if 'pathname' in record.__dict__.keys():
            # truncate the pathname
            filename = os.path.basename(record.pathname)
            if len(filename) > 20:
                filename = '{}~{}'.format(filename[:3], filename[-16:])
            record.pathname = filename
        return super(PathTruncatingFormatter, self).format(record) 
```

# html - Z-index：使元素位于其父级的兄弟之下

> ID：14429728
> 
> 赞同：5
> 
> 时间：2013-01-20T21:48:52.320
> 
> 标签：html, css, z-index

想象一下这个 DOM：

```
<header>
    <h1> header </h1>
    <!-- other elements -->
    <nav>
        nav
    </nav>
</header>

<div>
    content
</div> 
```

header 和 nav 都定位为`fixed`. 内容 div 定位为`relative`. 我需要按以下顺序（从上到下）创建一个带有 z-index 的堆栈：

*   标题 *:not(nav)
*   内容
*   导航

我很难将 nav 放在底部（换句话说，在其父母的兄弟姐妹之下）。我在想所有标题的孩子都必须在其兄弟姐妹之上或之下......这是对的吗？如果是这样，是否有解决这种情况的方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T21:53:34.687

只有“定位”的内容，例如`position: absolute`or`position: fixed`或`position: relative`才会尊重`z-index`. 由于您的 HTML 是结构化的，因此您无法执行您要求的操作，因为父母/孩子也受到尊重，因此孩子必须在父母中（它不能是完全不同的 z-index 与父母） . 为了做你想做的事，你必须打破它们`nav`，`header`然后它们可以各自拥有自己的`z-index`，一个高于和低于默认的零 z-index 内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T21:55:23.110

对于 DOM 布局，唯一的解决方法是使用负 z-index 值。但是，不强烈建议使用负值，就像不建议使用负边距值一样。

更好的解决方案是重构 DOM。您可能会发现[这](http://www.impressivewebs.com/a-detailed-look-at-the-z-index-css-property/)很有用。它解释了使用 z-index 属性的推荐方法。

希望这对你有帮助！

# java - 在 JSF 2.0 中注入 Bean

> ID：14429729
> 
> 赞同：5
> 
> 时间：2013-01-20T21:49:06.573
> 
> 标签：java, jsf-2, dependency-injection, javabeans, cdi

我有一个会话范围的 bean

```
import javax.faces.bean.SessionScoped;
import javax.inject.Named;
@Named
@SessionScoped
public class SessionBean implements Serializable{ 
```

我在一个过滤器中注入对象...

```
public class FiltroSeguridad implements Filter{

@Inject
private SessionBean sessionBean;

@Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
  HttpServletRequest httpRequest = (HttpServletRequest) request;
  sessionBean.setRutaRedirect(httpRequest.getRequestURI());
}
} 
```

但是，我在下一次交互中注入 SessionBean ......

```
@Model
public class CuentaUsuarioWebBean implements Serializable{
 @Inject
 private SessionBean sessionBean;

public void loginUsuario() throws IOException{
   sessionBean.getRutaRedirect();
}

} 
```

但该属性`getRutaRedirect()`返回 null

我通过 CDI 注释更改导入它仍然不起作用（`javax.enterprise.context.SessionScoped`），与 JSF 注释（`javax.faces.bean.ManagedBean`和`@ManagedProperty`）相同。

谢谢。

PD：对不起我的英语！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-20T22:10:47.270

您不能混合`javax.faces.bean.SessionScoped`用于 JSF 和`import javax.inject.Named`CDI 的这两个包的注释。两者都反映了不同的注入机制，不能在同一个 bean 上混合使用。您必须从同一个包中选择两个注释（用于注入和 Bean 范围）。使用相应包中的以下集合

对于基于 CDI 的 bean 定义

```
javax.enterprise.context.SessionScoped //for bean scoping
javax.inject.Named //for bean declaration
javax.inject.Inject //for injection 
```

对于基于 JSF 的 bean 定义

```
javax.faces.bean.SessionScoped //for bean scoping
javax.faces.bean.ManagedBean //for bean declaration
javax.faces.bean.ManagedProperty //for bean injection 
```

编辑：现在我更好地了解您的要求，使用以下构造注入 JSF 托管 bean

```
 @ManagedProperty(value="#{yourBeanName}")
 SessionBean yourSessionBean; 
```

另请注意，在 JSF 中，您只能注入比目标范围更广的 bean，例如，您可以将`@SessionScoped`bean 注入`@RequestScoped`bean，而不是相反

但是由于 JSF 托管的 bean 已被弃用，最好使用 CDI 托管的。在这种情况下，您**可以**将更短范围的 bean 注入更大范围的 bean

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T18:52:58.313

忘记托管bean。它不会以这种方式与过滤器一起使用。如果您坚持使用它，请按照此处提供的答案正确执行：

[如何在 JSF 中实现登录过滤器？](https://stackoverflow.com/questions/8480100/how-implement-a-login-filter-in-jsf)

现在关于 CDI，如果您的问题是某个特定值是 null 并且您已经通过实际获取 NPE 左右来验证这一点（例如，Eclipse 调试器有时会出错）。然后仔细检查您是否使用了正确的 SessionScoped，如 kolossus 所述，并检查 BalusC 所说的内容（beans.xml）。

查看 CDI 是否正常工作的一个好方法是向经理要 bean。将此调试代码放在某处并尝试：

```
@Inject
BeanManager manager;

@PostConstruct
private void test() {
    Bean<?> bean = (Bean) manager.resolve(manager.getBeans("ANY_NAMED_BEAN_EL_NAME"));
        System.out.println(bean);

} 
```

# javascript - 在移动设备上多次触发按钮 OnClick

> ID：14429733
> 
> 赞同：0
> 
> 时间：2013-01-20T21:49:38.043
> 
> 标签：javascript, ajax, mobile

我有一个包含菜单和内容区域的页面。我通过 ajax 将内容动态加载到该区域。

```
 <div id="content"  style="visibility: visible; overflow: hidden; top: 0px;"></div> 
```

ajax 调用如下所示。

```
 $('#content').load('content/contactform.html',function(){ ...some code...} 
```

加载到内容框中的页面是一个表单，其中包含一个使用 onClick 方法定义的 Button

```
<div>
    <h2>Phone Numbers</h2>
    <div id="form">
    </div>
    <button id="addPhoneBtn"  onclick="alert('click')">Click Me</button>
</div> 
```

通常它会添加一个新的输入字段以允许用户输入更多的电话号码。但是为了测试它只是打印一个警报。

现在，当我在移动设备（如 iPad）上单击该按钮时，会触发该事件 3 次。我读过触摸设备上没有鼠标事件。他们有触摸事件。

但奇怪的是，如果我将该页面直接复制到内容中，onClick 事件只会触发一次。我错过了什么吗？

更新：我正在使用 Iscroll 使 div 内的内容可滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T19:33:11.417

我发现了问题。我正在使用**iscroll-4**来实现触摸设备上的滚动。删除这个库并切换到 dojo 框架，解决了这个问题。

# list - number_in_month 练习（计算列表中的元素）

> ID：14429734
> 
> 赞同：1
> 
> 时间：2013-01-20T21:49:46.413
> 
> 标签：list, sml

我一直在尝试计算整数 3 元组列表中的元素，这等于使用 SML 的给定整数，但它不起作用。谁能帮我弄清楚下面的代码有什么问题或为我整理一下？

```
 fun number_in_month(x : int*int*int list, m: int) =
    if null x then 0

         else
           let fun inc x = x + 1;
         in
             val counter = 0;
             if m = #2 (hd x) andalso m > 0 then inc counter
            number_in_month((tl x), m)
           `  else
             number_in_month((tl x), m)
        end 
```

这个函数应该返回 m 等于列表中每个元组的第二个元素的次数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T22:41:21.070

显然，你很难放弃你的命令式思维。

让我尝试解决您的一些问题

*   您应该使用模式匹配而不是使用`null x`,`hd x`和`tl x`. 这也适用于分解元组和记录。例如

    ```
    fun number_in_month ((x1, x2, x3) :: xs, m) = ... 
    ```

    或者，因为我们从不使用 x1 和 x3

    ```
    fun number_in_month ((_, x2, _) :: xs, m) = ... 
    ```

    这样可以清楚地看到第一个参数是一个三元组列表，不需要类型注释

    此外，当您省略显式类型注释时，这是拥有一个可以为您推断它们的类型系统的整个想法（见下一点），那么这段代码

    ```
    fun foo42 xs = map (fn x => #2 x) xs 
    ```

    会给你一些关于“未解决的弹性记录”的令人讨厌的错误（这个错误信息来自 SML/NJ）

    ```
    /tmp/sml20620PlF:105.5-105.44 Error: unresolved flex record
       (can't tell what fields there are besides #2) 
    ```

    这很容易通过分解三元组来解决

    ```
    fun foo42 xs = map (fn (_, x2, _) => x2) xs 
    ```

*   说到类型注释。它们（几乎总是）不需要，并且会混淆代码的可读性。更不用说它们不必要地限制了您可以使用函数的类型。

    根据您真正不想要的，您给出的类型注释也是错误的。您应该在`int * int * int`. 目前它被解释为两个 int 和一个 int list 的三元组`int * int * (int list)`。

    如果你真的坚持输入注释你的函数，那么你可以这样做

    ```
    val number_in_month : (int * int * int) list * int -> int = 
        fn ([]            , m) => 0
         | ((_,x2,_) :: xs, m) => 42 
    ```

    这“几乎”像 Haskell 一样，类型在函数声明之前给出。

*   尝试在缩进代码的方式上更加一致。这会给你更好的清晰度。在这里，我特别考虑了您缩进`else`部分结束`in ... end` 部分的方式。下面的部分显然在很多方面仍然是错误的，我无法开始想象，但它给出了如何做到这一点的想法

    ```
    fun number_in_month(x : int*int*int list, m: int) =
        if null x then 0
        else
          let fun inc x = x + 1;
          in
            val counter = 0;
            if m = #2 (hd x) andalso m > 0 then
               inc counter
               number_in_month((tl x), m)
            else
               number_in_month((tl x), m)
          end 
    ```

*   您不能在let 表达式的部分`val counter = 0`内声明变量。`in ... end`let 表达式的语义是

    ```
    let
      dec
    in
      exp_1; ...; exp_n
    end 
    ```

    因此所有声明（函数和值绑定等）都必须放在该`let ... in`部分中。

*   地球上不需要增量功能，它只会使可读性变得混乱。请记住，SML 使用单一赋值，因此变量在声明后是不可变的。

*   嵌套 if 表达式中的序列事物

    ```
    inc counter
    number_in_month((tl x), m) 
    ```

    完全没有意义。您可以在部件内拥有多个表达式 `then ... else`（实际上是任何需要单个表达式的地方）的唯一方法是使用序列 (exp_1; ...; exp_n)。然而，这仅在除最后一个表达式之外的所有表达式都有副作用时才可用，因为它们的结果被忽略/丢弃

    ```
    - (print "Foo\n"; print "Bar\n"; 42);
    Foo
    Bar
    val it = 42 : int 
    ```

如果您在 SO 上搜索一下，您会看到最近[提出](https://stackoverflow.com/q/14348568/577513)并[回答](https://stackoverflow.com/a/14350056/577513)了一个非常相似的问题。尽管最后一个参数的类型有所不同，但您仍然可能会得到一些有用的指针。

总而言之，解决方案可能看起来像

```
fun number_in_month ([], _) = 0
  | number_in_month ((_,x2,_) :: xs, m) = 
    if x2 = m then
      1 + number_in_month(xs, m)
    else
      number_in_month(xs, m) 
```

但是，由于您的问题比前面提到的问题更简单，您可以轻松地使用基础库中 list 模块中的一些高阶函数

```
fun number_in_month (xs, m) = length (List.filter (fn (_, x2, _) => x2 = m) xs) 
```

甚至（可以说）更简单，通过折叠列表并在每次匹配时沿途增加一个变量

```
fun number_in_month (xs, m) = foldl (fn ((_, x2, _), b) => if x2 = m then b+1 else b) 0 xs 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-24T17:30:46.770

```
fun number_in_month (L : (int*int*int) list, m : int) =
if L = nil
then 0
else
    (if #2 (hd L) = m then 1 else 0) + number_in_month (tl L,m); 
```

测试：

```
number_in_month ([] , 2);
number_in_month ([(1,2,3)] , 2);
number_in_month ([(1,2,3),(2,2,2)] , 2);
number_in_month ([(1,2,3),(2,2,2),(19,11,29)] , 2);
number_in_month ([(1,2,3),(2,2,2),(19,11,29),(10,28,19)] , 2);
number_in_month ([(1,2,3),(2,2,2),(19,11,29),(10,2,19)] , 2);
number_in_month ([(1,2,3),(2,2,2),(19,11,29),(10,28,19)] , 2);
number_in_month ([(1,2,3),(2,2,2),(19,11,29),(10,28,19)] , 2);
number_in_month ([(1,2,3),(2,2,2),(19,11,29),(10,28,19),(16,2,7)] , 2); 
```

参考：

[http://www.cs.sunysb.edu/~leo/CSE215/smllistexamples.txt](http://www.cs.sunysb.edu/~leo/CSE215/smllistexamples.txt)

[http://www.standardml.org/Basis/list.html](http://www.standardml.org/Basis/list.html)

# django - 确认后未执行 Django 管理操作

> ID：14429735
> 
> 赞同：3
> 
> 时间：2013-01-20T21:49:51.460
> 
> 标签：django, django-admin

在我的 Django 应用程序中，我想实现一个中间页面，在执行特定的管理操作之前要求确认。我以[这篇文章](https://stackoverflow.com/questions/6689741/problem-using-django-admin-actions-with-intermediate-pages)为例。

我使用现有`delete_confirmation.html`模板作为出发点，并部分使其正常工作。将显示确认页面并显示所选对象。但是，在单击“是的，我确定”后，我的管理操作永远不会被调用。

在我的 admin.py 中，我有：

```
def cancel_selected_bookings(self, request, queryset):
    """
    Cancel selected bookings.
    """
    if request.POST.get("post"):
        for booking in queryset:
            booking.cancel()
            message = "Booking %s successfully cancelled." % booking.booking_id
            messages.info(request, message)
    else:
        context = {
            "objects_name": "bookings",
            'title': "Confirm cancellation of selected bookings:",
            'cancellable_bookings': [queryset],
            'action_checkbox_name': helpers.ACTION_CHECKBOX_NAME,
        }
        return TemplateResponse(request, 'admin/bookings/confirm_cancel.html', context, current_app=self.admin_site.name) 
```

在我的模板中，我有（完整模板的剪辑）：

```
 <div class="grp-group">
            <h2>
                {% blocktrans %}
                    Are you sure you want to cancel the selected {{ objects_name }}?
                {% endblocktrans %}
            </h2>
            {% for cancellable_booking in cancellable_bookings %}
                <ul class="grp-nested-list">{{ cancellable_booking|unordered_list }}</ul>
            {% endfor %}
        </div>
        <form action="" method="post">{% csrf_token %}
            <div id="submit" class="grp-module grp-submit-row grp-fixed-footer">
                {% for obj in queryset %}
                    <input type="hidden" name="{{ action_checkbox_name }}" value="{{ obj.pk|unlocalize }}" />
                {% endfor %}
                <input type="hidden" name="action" value="cancel_selected_bookings" />
                <input type="hidden" name="post" value="yes" />
                <ul>
                    <li class="grp-float-left"><a href="." class="grp-button grp-cancel-link">{% trans "Cancel" %}</a></li>
                    <li><input type="submit" value="{% trans "Yes, I'm sure" %}" class="grp-button grp-default" /></li>
                </ul>
                <input type="hidden" name="post" value="yes" />
            </div>
        </form> 
```

**编辑：**

我在上面的模板中发现了一个问题。这些行：

```
{% for obj in queryset %}
  <input type="hidden" name="{{ action_checkbox_name }}" value="{{ obj.pk|unlocalize }}" />
{% endfor %} 
```

需要替换为：

```
{% for cancellable_booking in cancellable_bookings %}
  <input type="hidden" name="{{ action_checkbox_name }}" value="{{ cancellable_booking.id }}" />
{% endfor %} 
```

然而，出于某种神秘的原因，隐藏字段的值不是由`{{cancellable_booking.id}}`. 当我用现有的 id 对其进行硬编码时，一切都按预期工作。我究竟做错了什么？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T15:50:33.960

This will work:

In the action method:

```
context = {
    'objects_name': 'bookings',
    'title': 'Confirm cancellation of selected bookings:',
    'cancellable_bookings': [queryset],
    'ids': queryset.values_list("id"),
    'action_checkbox_name': helpers.ACTION_CHECKBOX_NAME,
} 
```

In the template:

```
{% for id in ids %}
    <input type="hidden" name="{{ action_checkbox_name }}" value="{{ id.0|unlocalize }}" />
{% endfor %} 
```

Not sure why iterating the `queryset` doesn't work but alas...

# ms-access-2010 - 如何编写宏来检查另一个表中的相关记录？

> ID：14429742
> 
> 赞同：2
> 
> 时间：2013-01-20T21:50:42.403
> 
> 标签：ms-access-2010

我想编写一个每次将记录输入某个表时都会运行的宏。我想要宏做的是检查不同表中是否有相关记录，如果有，将数据类型是/否的字段更改为是。如果尚未定义相关记录，我什么也不做，因为 Yes/No 字段的默认值为 No。

这两个表以[这种方式关联。](http://www.prayingmantesconcepts.com/access2010/relationships.png)

因此，当向 tblOrders 表中输入一条记录时，我需要检查 tblRecipes 表中是否存在相关记录，如果可能，我想使用宏来执行此操作，因为我将为每个 Order 重复此操作进入。

这可能吗，如果可以，请问宏语言是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:50:50.840

例如，通常的做法是使用表单进行数据输入，并在控件的更新前事件中检查食谱表。

```
Private Sub CustomerPartNumber_BeforeUpdate(Cancel As Integer)
    If Not IsNull(DLookup( _
     "CustPartNum", "tblRecipes", "CustPartNum=" & Me.CustomerPartNumber)) Then
        Me.AYesNoField = True
    Else
        Me.AYesNoField = False
    End If
End Sub 
```

但是，在 Access 2010 中，您可以使用[数据宏](http://office.microsoft.com/en-ie/access-help/create-a-data-macro-HA010378170.aspx)。只要在 Orders 中更改 CustomerPartNumber，此示例就会运行。

![更改数据宏之前](../Images/4445ba264fa6fb09c0638a1e8694f686.png)

# django - 在Django中，当JavaScript添加选择时，如何验证A（多个）乔利斯字段？

> ID：14429746
> 
> 赞同：3
> 
> 时间：2013-01-20T21:51:22.807
> 
> 标签：django, django-forms

我有一个`ChoiceField`在呈现 HTML 时不知道选择的地方；它们由用户动态定义并通过 Javascript 添加到表单中，但验证自然会失败，因为选定的选项不在选择属性中（这只是一个空列表）。我尝试将该字段设置为 a `CharField`，但是验证器只获取一个字符串值，该字符串值需要在使用之前转换为列表。啊，我想避免子类化字段类，因为它只是用于一个场合。

我希望这很清楚。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:55:30.420

不要子类化字段类，而是覆盖类中的`clean_<yourfield>`方法`Form`。[请参阅此处](https://docs.djangoproject.com/en/1.4/ref/forms/validation/#cleaning-a-specific-field-attribute)的文档。

# android - 启动时 PreferenceManager.getDefaultSharedPreferences 出现 NullPointerException

> ID：14429754
> 
> 赞同：4
> 
> 时间：2013-01-20T21:51:59.030
> 
> 标签：android, nullpointerexception, sharedpreferences

所以我正在重新制作几个月前的应用程序（找出错误，并让一些事情变得更好）但现在我遇到了一个我没有找到并且不知道它是什么的问题。如果我在手机上运行应用程序，则会出现此错误

```
01-20 22:37:46.595: E/AndroidRuntime(7350): FATAL EXCEPTION: main
01-20 22:37:46.595: E/AndroidRuntime(7350): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.stevedc.thinklogic/com.stevedc.thinklogic.TowerHanoi}: java.lang.NullPointerException
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1891)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.os.Looper.loop(Looper.java:137)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.ActivityThread.main(ActivityThread.java:4441)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at java.lang.reflect.Method.invokeNative(Native Method)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at java.lang.reflect.Method.invoke(Method.java:511)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at dalvik.system.NativeStart.main(Native Method)
01-20 22:37:46.595: E/AndroidRuntime(7350): Caused by: java.lang.NullPointerException
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.preference.PreferenceManager.getDefaultSharedPreferencesName(PreferenceManager.java:371)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.preference.PreferenceManager.getDefaultSharedPreferences(PreferenceManager.java:366)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at com.stevedc.thinklogic.TowerHanoi.<init>(TowerHanoi.java:42)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at java.lang.Class.newInstanceImpl(Native Method)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at java.lang.Class.newInstance(Class.java:1319)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
01-20 22:37:46.595: E/AndroidRuntime(7350):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1882) 
```

有人可以指出我需要查看故障所在的方向吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-21T06:18:57.617

从logcat看来，您调用的方法是

```
 PreferenceManager.getDefaultSharedPreferences(context); 
```

如果这里的上下文为空，那么就有可能出现这种异常。所以尝试传递一个有效的上下文作为参数。您可以使用以下方法。

```
Context context = getApplicationContext(); 
```

# facebook - 设置 Facebook Like 插件参数以发送和分享自定义数据

> ID：14429757
> 
> 赞同：0
> 
> 时间：2013-01-20T21:52:06.300
> 
> 标签：facebook, facebook-like, customization, social-networking, facebook-social-plugins

我在 XHTML 网站上实现了 Facebook Like 插件（无法将 doctype 更新为 html5）。假设每个“帖子”都有一个赞按钮。

我想创建一个包含“帖子”选择的页面，每个帖子都有一个“赞”按钮。

**2个问题：**

*   **当用户在这个页面点赞时，是否可以分享帖子的信息？** 显然，我不能使用开放图形元数据，因为它与页面相关，而不是与帖子相关。我想要在 Facebook 用户帐户上共享的标题、照片和简短描述。

*   **是否有可能知道/检索“喜欢”特定“帖子”的 Facebook 用户列表？** 编辑：答案是否定的。

感谢您的回答或建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:57:40.767

如果我理解正确，问题是如何将单个文章的点赞按钮添加到包含多篇文章列表的页面中。

在 Like 按钮代码中使用单个博客条目的 URL。例如，如果使用 HTML5 版本的 Like 按钮，则类似于：

```
<div class="fb-like" data-href="http://www.example.com/blog/1" data-send="false" data-width="450" data-show-faces="false"></div>
<div class="fb-like" data-href="http://www.example.com/blog/2" data-send="false" data-width="450" data-show-faces="false"></div> 
```

或者如果使用 XFMBL 版本，则：

```
<fb:like href="http://www.example.com/blog/1" send="false" width="450" show_faces="false"></fb:like>
<fb:like href="http://www.example.com/blog/2" send="false" width="450" show_faces="false"></fb:like> 
```

# java - ActiveJDBC 和 Dropwizard 集成

> ID：14429761
> 
> 赞同：0
> 
> 时间：2013-01-20T21:52:34.723
> 
> 标签：java, dropwizard, activejdbc

是否可以使用 ActiveJDBC 作为我的 ORM 而不是 Dropwizard 提供的 Hibernate。如果可能的话，我该如何设置它。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T01:07:33.677

不熟悉 Dropwizard，但是在查看了他们的文档之后，我完全没有看到 ActiveJDBC 不起作用的原因。他们使用迁移系统 Liquibase，我也将其用于一些 ActiveJDBC 项目。Dropwizard 似乎是一个不错的构建服务框架，但我们一直在使用 ActiveWeb：http: [//javalite.io/activeweb](http://javalite.io/activeweb)用于所有后端 JSON/XML/Rest Web 服务。

回到 Dropwizard：因为他们使用 Maven 作为构建工具，所以要引入 ActiveJDBC，您只需在 pom 中配置检测插件：http://javalite.io/instrumentation[并](http://javalite.io/instrumentation) 添加依赖项：

```
<dependency>
    <groupId>org.javalite</groupId>
    <artifactId>activejdbc</artifactId>
    <version>1.4.11</version>
</dependency> 
```

ActiveJDBC 是一种通用的 ORM，可以与任何 Java 框架一起使用。

干杯。

# redmine - 将 redmine 1.1.0 更新为 redmine 2.2.1

> ID：14429764
> 
> 赞同：0
> 
> 时间：2013-01-20T21:52:42.207
> 
> 标签：redmine, redmine-plugins

目前我正在使用 redmine 1.1，现在我需要将其更新为 redmine 2.2。我已经在 redmine 1.1 版本中添加了很多项目及其问题。我已经在其他端口安装了 redmine 2.2，并使用 redmine 1.1 数据库，并在 redmine 2.2 中进行了必要的更改，以维护我在数据库中的所有项目、问题和用户。但是当我连接到 redmine 2.2 并尝试登录时，它会显示一个内部错误。有谁知道我如何使用 1.1 redmine 数据库中存在的数据将 redmine 1.1 更新为 redmine 2.2？请让我知道它是否可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:30:14.560

通常，除了插件之外，您应该不会遇到迁移问题。

备份您的数据库，然后执行

```
$ RAILS_ENV=production rake db:migrate 
```

看看[官方程序](http://www.redmine.org/projects/redmine/wiki/RedmineUpgrade)。值得一读...

迁移时的主要问题通常是不兼容的插件。

# dropbox - dropbox 不再同步子文件夹？

> ID：14429769
> 
> 赞同：2
> 
> 时间：2013-01-20T21:53:08.010
> 
> 标签：dropbox

我最近注意到一个回归（？） - 我一直在 Dropbox 目录中使用指向数据目录的符号链接，就像这样 - my_dropout_dire/dir1 ====> /path1/data_dir1

/path1/data_dir1 下有一个目录树，每当有文件更新、添加新文件或添加新子目录时，我都可以在其他链接的计算机上自动同步。

但这最近停止工作，因为可能是几周前。我必须添加一个新的符号链接才能使其工作：

my_dropout_dir/dir1_sub1_sub11 ====> /path1/data_dir1/sub1/sub11

如果我不这样做，sub11 中的新文件不会同步到其他计算机，我也不会在 dropbox web repo 上看到它们。

有没有人也注意到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T09:54:07.793

根据此页面上的 Dropbox：[https ://www.dropbox.com/help/145/en](https://www.dropbox.com/help/145/en)

**连接点和别名**

*Dropbox 将遵循 Windows 连接点（Windows Vista 或更高版本）并同步它们链接到的文件或文件夹。但是，在重新启动 Dropbox 桌面应用程序之前，从 Windows 操作系统对这些文件或文件夹所做的任何更改都不会再次同步。要解决此问题，请将原始文件夹移动到您的 Dropbox，并从其先前位置添加一个连接点，以链接到其在 Dropbox 文件夹中的新位置。*

我也有路口，直到几天前它们都工作得很好，但显然他们不应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-19T13:00:14.440

tl;博士我将 Dropbox 与 Windows 符号链接和连接一起使用。虽然 Dropbox 客户端在白天不会检测到任何文件更改，但它会在启动或恢复时检查并同步子文件夹和文件。

文件在以下条件下同步：

1.  我每天早上重新启动笔记本电脑，当 Dropbox 客户端自动启动时，它会同步子文件夹和文件。
2.  如果我需要在白天同步文件，*我会在 Dropbox 客户端中“暂停同步”并立即恢复*- 这会同步子文件夹/文件。

不是理想的过程，但它有效。

PS：我只尝试了与本地机器上的文件夹的符号链接，而不是远程机器。

FWIW（截至几个月前）我尝试使用的其他客户端（Google Drive、Copy）都没有识别 Windows 符号链接和连接。

Dropbox 版本：v2.10.52；操作系统：Windows 8.1

# ruby - 木偶创建windows用户

> ID：14429772
> 
> 赞同：0
> 
> 时间：2013-01-20T21:53:17.183
> 
> 标签：ruby, windows, puppet

我正在尝试使用 Puppet 创建一个新的本地 Windows 用户，问题是文档似乎表明 Puppet for Windows 中可用的配置选项并不出色。

有没有人有更好的方法来做到这一点或使用 Ruby 来完成它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-11T17:26:51.477

[https://docs.puppetlabs.com/references/latest/type.html#user-provider-features](https://docs.puppetlabs.com/references/latest/type.html#user-provider-features)

对于 Windows，您需要将用户至少放在`Users`组中，将其设置`managehome => true`为以创建他们的配置文件，并为他们提供密码以启用它们（否则该帐户被禁用）。

```
user {'bob':
    name      => 'bob',
    ensure    => present,
    groups    => ['Users','Administrators'],
    password  => 'plaintext_I_know_gross-use-hiera-or-blackbox',
    managehome => true,
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T13:14:56.473

需要哪些配置选项？当我发现 puppet 用户资源不足时，我使用 exec 运行 windows 'net user' 命令来添加用户。

# admob - 错误 - 广告不可用 (NoFill) - AdMob SDK Windows Phone 7.1

> ID：14429774
> 
> 赞同：0
> 
> 时间：2013-01-20T21:53:32.473
> 
> 标签：admob

我正在尝试将 admob sdk 添加到我的 wp7 项目中，但是当我做得很好时，它给出了**错误 - 广告不可用（NoFill）**

Admob 应用/网站设置；广告样式 = 使用下面设置的颜色： 自动刷新：刷新：60 秒 测试模式：对所有请求禁用测试模式

并且红色圆圈中还写着：**无效：AdMob 从未收到您网站的广告请求。** 由于**错误 - 广告不可用 (NoFill)**

我还没有找到任何关于如何解决这个问题的文章，这是一个错误还是类似的东西？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T10:44:08.467

没有问题。没有错误。

Admob 在您所在地区没有您的应用的任何库存。一旦您在更大的地理区域拥有用户，您将获得广告填充。

# wordpress - 无法创建重写规则

> ID：14429776
> 
> 赞同：1
> 
> 时间：2013-01-20T21:53:36.573
> 
> 标签：wordpress

我尝试为我的自定义帖子类型创建重写规则。我需要它类似于“/%post_type_name%/%taxonomy_slug/%post_slug%”。这是我用来添加规则的代码：

```
add_action('init', 'episodes_rewrites_init');

function episodes_rewrites_init(){
    add_rewrite_rule(
        '^episodes/([^/]*)/([^/]*)/?$',
        'index.php?post_type=episodes&seasons=$matches[1]&episodes=$matches[2]', 'top'
    );
} 
```

它不起作用，我不知道为什么。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T00:40:28.547

好吧，伙计，我从未使用过`add_rewrite_rule`，WP codex 说是`It is most commonly used in conjunction with add_rewrite_tag()`。
因此，我只是向您展示退伍军人在过去是如何重写规则的。
但此外，如果您正在为大众构建插件，则必须避免使用`WP 3.5 features`很多人仍在使用 WP2.*。

这组操作可以帮助您：

```
add_action('init', 'flushRewriteRules');
function flushRewriteRules()
{
    global $wp_rewrite;
    $wp_rewrite->flush_rules();
}

add_filter('rewrite_rules_array', 'insertMyRewriteRules');
function insertMyRewriteRules($rules)
{
    $newrules['^episodes/([^/]*)/([^/]*)/?$'] = 'index.php?post_type=episodes&seasons=$matches[1]&episodes=$matches[2]';
    return $newrules + $rules;
}

add_filter('query_vars', 'insertMyRewriteQueryVars');
function insertMyRewriteQueryVars($vars)
{
    array_push($vars, 'episodes', 'seasons', 'post_type');
    return $vars;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T06:43:55.257

好吧，我刚刚安装了名为“Custom Post Type Permalinks”的插件，为我的自定义帖子添加了 url 模板，如“/%seasons%/%postname%/”，现在它可以像我想要的那样重写 url。但我仍然不知道如何在代码中做到这一点......

# ios - 其他引脚后面的标注弹出窗口

> ID：14429778
> 
> 赞同：3
> 
> 时间：2013-01-20T21:53:40.993
> 
> 标签：ios, ios6, mapkit, mkannotationview

我正在制作一张有 5000 多个图钉的地图。每次我更改区域时，我都会根据缩放程度添加或删除 annotationViews。

唯一的问题是这个（极端测试）：

![标注被活着吃掉](../Images/ff3ca4376271fb08d3c73ed05d75a9f9.png)

当引脚之间没有更多空间时，标注会移动到顶部，但通常红色引脚在顶部。
我只使用基本的 MKPinAnnotationView。没有自定义标注。我确实尝试通过[MKAnnotationViews 的 Aaron Z-ordering](https://stackoverflow.com/questions/1681565/z-ordering-of-mkannotationviews?lq=1)实现 Z-ordering-category，但似乎没有帮助。

编辑：

我还没有解决它，但我确实有一些想法。

MapKit 写得不好。MapView 有责任对视图进行排序，因此至少选定的视图保持在顶部。

也许 mapView 需要处理的注释太多了。

如何复制

只需添加 5000 个注释。

```
-(void)addAnnotations
{
   NSMutableArray *annotations = [NSMutableArray array];

   for(int i=0;i<5000;i++) {
       CGFloat latDelta = rand()*0.125/RAND_MAX - 0.02;
       CGFloat lonDelta = rand()*0.130/RAND_MAX - 0.08;

       CGFloat lat = 59.189358;
       CGFloat lng = 18.267839;

       CLLocationCoordinate2D newCoord = {lat+latDelta, lng+lonDelta};

       DTSAnnotation *annotation = [DTSAnnotation annotationWithCoord:newCoord];

       [annotation setTitle:@"."];

       [annotations addObject:annotation];
   }
   [[self mapView]addAnnotations:annotations];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-07-17T16:24:04.933

您可以通过在 didSelect 和 didDselect 地图视图委托方法中设置视图的 zPosition 来解决此问题：

```
public func mapView(mapView: MKMapView!, didSelectAnnotationView view: MKAnnotationView!)
    {
        view.layer.zPosition = 0
    }

    public func mapView(mapView: MKMapView!, didDeselectAnnotationView view: MKAnnotationView!)
    {
        view.layer.zPosition = -1
    } 
```

# binary - 带 2 补码的二进制减法

> ID：14429784
> 
> 赞同：3
> 
> 时间：2013-01-20T21:54:55.717
> 
> 标签：binary, subtraction, twos-complement

我需要帮助使用 2 的表示法减去二进制并为每个数字使用 5 位：

1) -9 -7 = ? 有溢出吗？

-9 = 01001（2 的补码 = 10111）和 -7 = 00111（2 的补码 = 11001）

现在我们需要添加，因为我们使用的是 2 的补码

10111 +11001 = 100000 但是这个答案没有意义。另外，我假设有溢出，因为答案中有超过 5 位。

2）6 - 10，与之前相同的过程。负二进制数对我来说没有意义

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T22:07:54.430

**1) -9 - 7**

-9 - 7 = -9 + -7

9（二进制）= 01001
-9（2 的补码）= 10111
7（二进制）= 00111
-7（2 的补码）= 11001

```
 10111 +
 11001 =
110000 
```

这不适合 5 位。消除溢出我们得到 10000，即 -16（二进制）。

**2) 6 - 10**

6 - 10 = 6 + -10

6（二进制）= 00110
10（二进制）= 01010
-10（2 的补码）= 10110

```
 00110 +
 10110 =
 11100 
```

这适合 5 位并且是 -4（二进制）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:05:37.240

10111 + 11001 不是 100000 而是 110000。

```
 1111
   10111
 + 11001
   -----
  110000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-26T18:45:17.653

第一个问题的答案是错误的。要使用二进制补码查找 -9-7，我们需要执行以下步骤：

```
STEP:1 第一个数字的转换

第1次9的二进制转换：01001

第二次找到二进制的补码：10110

二进制补码加 1：10110  
                                       +1
                                    -----
                                    10111  
第 2 步：转换第二个数字

第1次7的二进制转换：00111

第二次找到二进制的补码：11000

二进制补码加 1：11000
                                       +1
                                   --------
                                    11001
第 3 步：添加

现在添加两个输出 -9 + (-7)：10111
                                   +11001
                                  --------
                                   110000
最重要的是检查答案是否正确。
您可以对二进制数字使用索引：7 6 5 4 3 2 1 0
                                                   1 1 0 0 0 0

找到每个具有 1 位数字的指数的 2 次幂。
                                                (-)2^5 + 2^4
```

* 使用注 (-) 是因为在二进制补码中，最高有效位（具有最高索引的位）是符号位 -2^5 + 2^4 = -32 + 16 = -16 这是正确答案-9-7=-16。因此，2 的补码成为表示负数的流行方式。对于符号幅度，我们需要假设一个符号位，这在计算机中很难实现，对于 1 的补码，我们需要加 1 才能找到正确的答案。

# cygwin - 在 Windows7 64 位机器上的 Sicstus Prolog 4.2 中“save_program/1”是否损坏？

> ID：14429792
> 
> 赞同：0
> 
> 时间：2013-01-20T21:55:45.937
> 
> 标签：cygwin, windows-7-x64, sicstus-prolog

我在我的 Windows7 64 位安装中从 Cygwin 提示符启动 sicstus，并创建了一个 prolog 程序。然后我使用以下命令保存了它，该命令在我当前的文件夹中创建了文件“test.sav”。

```
save_program(test). 
```

当我尝试运行此文件时，我收到一条神秘的错误消息：

```
$ ./test.sav
! Existence error in argument 1 of restore/1
! file '%0.bat' does not exist
! goal:  restore('%0.bat')
SICStus 4.2.0 (x86-win32-nt-4): Mon Mar  7 20:21:12 WEST 2011
Licensed to SP4idi.ntnu.no
| ?- halt.
./test.sav: line 2: $'\032\r': command not found
./test.sav: line 8: x??xU?u/:?HBa?m[F?????ld?l???l?????./test.sav: line 9: syntax error near unexpected token `)'
./test.sav: line 9: `}?????????8?h????)}???C?qa?   ??.?????????/F??7W???yE?lL}>}L???????"???o%"?aac|S[G?????"W????'??K?1Q???????H??M?4??=???bE?
???t[<??????I??\)T?*????????N+?4??@h? ?'?{?1J?*????F?Q??q?<B?5@????l?(s?x?`r?????b?5??%:#I?Eb?@????1-???|a?????  ?D??G?)??O? 
```

当我查看文件的头部时，这就是我得到的：

```
$ head ./test.sav
sicstus-4.2.0 -r %0.bat -a %1 %2 %3 %4 %5 %6 %7 %8 %9

# META_INFO 1
# FILE: "c:/eclipse/workspace_prolog/busstuc/test.sav"
# FR: "timeout"
# META_INFO END
version=4 archmask=0x2c81a
x??xU?u/:?HBa?m[F?????ld?l???l?????head: write error: Permission denied
head: write error 
```

我还尝试以不同的方式加载文件：

```
$ sicstus -l ./test.sav
% loading c:/eclipse/workspace_prolog/busstuc/test.sav...
% c:/eclipse/workspace_prolog/busstuc/test.sav loaded, 0 msec 104 bytes
! Consistency error: memory and saved_state are inconsistent
! type 32-bit,BDD,GAUGE,ALL_BUT_PROLOG, saved state, type 32-bit,BDD,GAUGE, emulator
! goal:  ensure_loaded(user:'./test.sav')
SICStus 4.2.0 (x86-win32-nt-4): Mon Mar  7 20:21:12 WEST 2011
Licensed to SP4idi.ntnu.no
| ?- halt. 
```

有人可以向我解释为什么这不起作用吗？我在这里做错了吗？谢谢！

编辑：根据 Per 的建议，我将文件名从 test.sav 更改为 test.bat。有时候是这样的：

```
C:\eclipse\workspace_prolog\BussTUC>sicstus-4.2.0 -r C:\eclipse\workspace_prolog\BussTUC\test.bat.bat -a
! Existence error in argument 1 of restore/1
! file 'C:\\eclipse\\workspace_prolog\\BussTUC\\test.bat.bat' does not exist
! goal:  restore('C:\\eclipse\\workspace_prolog\\BussTUC\\test.bat.bat')
SICStus 4.2.0 (x86-win32-nt-4): Mon Mar  7 20:21:12 WEST 2011
Licensed to SP4idi.ntnu.no
| ?- halt.

C:\eclipse\workspace_prolog\BussTUC># META_INFO 1
'#' is not recognized as an internal or external command,
operable program or batch file.

C:\eclipse\workspace_prolog\BussTUC>The system cannot write to the specified device.
The system cannot write to the specified device.
 | The system cannot write to the specified device. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:23:57.557

这个未记录且不受支持的功能显然从未在 Windows 上运行过。

相反，您可以使用从包含可执行文件的文件夹加载 main.sav 的预构建运行时系统之一。例如，将您的 test.sav 保存为 main.sav，并将其与 sprti.exe 放在一个文件夹中，该文件夹包含适用于 SICStus 的正确文件夹结构，如手册中 Windows 目标机器上的运行时系统部分所述。

最常见的解决方案是使用 spld.exe 工具构建一个自包含的可执行文件，但这需要 Microsoft 提供的相应 C 编译器。

（我是 SICStus Prolog 开发人员之一）

# python - 将函数应用于返回值基于其他行的 pandas Dataframe

> ID：14429793
> 
> 赞同：5
> 
> 时间：2013-01-20T21:55:59.337
> 
> 标签：python, pandas

我有一个看起来像这样的数据框：

```
>>> import pandas
>>> df = pandas.DataFrame({'region' : ['east', 'west', 'south', 'west',
...  'east', 'west', 'east', 'west'],
...  'item' : ['one', 'one', 'two', 'three',
...         'two', 'two', 'one', 'three'],
...         'quantity' : [3,3,4,5,12,14,3,8], "price" : [50,50,12,35,10,10,12,12]})
>>> df
    item  price  quantity region
0    one     50         3   east
1    one     50         3   west
2    two     12         4  south
3  three     35         5   west
4    two     10        12   east
5    two     10        14   west
6    one     12         3   east
7  three     12         8   west 
```

我想要做的是修改数量列中的值。每个新的数量值都是根据该行的项目和价格组合存在的不同区域的数量来计算的。更具体地说，我想将每个数量乘以我编写的一个函数返回的区域权重，该函数采用一个区域和组成池的其他区域的列表：

`region_weight(region, list_of_regions)`. 对于这种想象的情况，让我们说：

*   东部地区值 1
*   西部地区价值 2
*   南方价值 3

则池中东、西的返回权重为0.3333333333333333（1/3）。池东、西、南中南的权重为 0.5（1/2）。

因此，对于第一行，我们看看还有哪些其他行是 item one 和 price 50。有 2 个与东部区域和一个与西部区域。第一行中的新数量为：3 *`region_weight("east", ["east", "west"])` 或 3 * 0.3333333333333333。

我想对整个数量列应用相同的过程。除了逐行循环遍历 Dataframe 之外，我不知道如何使用 pandas 库来解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T01:40:20.300

好的，我认为这可以满足您的要求：

制作您的区域权重字典：

```
In [1]: weights = {'east':1,'west':2,'south':3} 
```

以下函数将 Series 中的值映射到权重字典中的值。 `x`是区域的行值，`w`是映射到权重字典后的区域序列。

```
In [2]: def f(x):
   ...:     w = x.map(weights)
   ...:     return w / w.sum().astype(float) 
```

在这里，我们分组`['item','price']`并应用上面的功能。输出是项目和价格的独特组合的一系列相对权重。

```
In [3]: df.groupby(['item','price']).region.apply(f)
Out[3]:
0    0.333333
1    0.666667
2    1.000000
3    1.000000
4    0.333333
5    0.666667
6    1.000000
7    1.000000 
```

最后，您可以乘以`df.quantity`上述系列来计算您的体重调整量。

```
In [4]: df['wt_quant'] = df.groupby(['item','price']).region.apply(f) * df.quantity

In [5]: df
Out[5]:
    item  price  quantity region  wt_quant
0    one     50         3   east  1.000000
1    one     50         3   west  2.000000
2    two     12         4  south  4.000000
3  three     35         5   west  5.000000
4    two     10        12   east  4.000000
5    two     10        14   west  9.333333
6    one     12         3   east  3.000000
7  three     12         8   west  8.000000 
```

# jquery - HTML表单布局问题

> ID：14429794
> 
> 赞同：-1
> 
> 时间：2013-01-20T21:56:11.490
> 
> 标签：jquery, html, css, clone

我是 jQuery 和 PHP 的新手，所以我知道我的编码充其量是非常粗糙的，但我需要帮助。

我的 PHP 编码：

```
<td style="width: 39px; height: 30px;">

<select id="choice" name="choice" class="ddl" style="width: 150px">
<?php foreach($xml->children() as $pizza){ ?>
<option value="<?php echo $pizza; ?>" selected=""><?php echo $pizza; ?></option>
<?php }?>
</select></td>
        <td style="height: 30px; width: 32px;">
        <input id="num" name="num" class="dd2" style="width: 46px" 
        type="number"></td>
        <td style="height: 30px; width: 91px;">
        <input TYPE = "button" id="addbt" Name = "addbt" VALUE = "Add Pizza" class="auto-style1"></td>
        <td style="height: 30px">
        <input TYPE = "button" id="removebt" Name = "removebt" VALUE = "Remove A Pizza" class="auto-style1"></td>
    </tr>
    <tr>
        <td style="width: 131px; height: 30px;">&nbsp;</td>
        <td style="width: 39px; height: 30px;">

        &nbsp;</td>
        <td style="height: 30px; width: 32px;">
        &nbsp;</td>
        <td style="height: 30px" colspan="2">
        &nbsp;</td>
    </tr>
    <tr>
        <td style="width: 131px">

     <INPUT TYPE = "Submit" Name = "Submit1" VALUE = "Submit Order"></td>
        <td colspan="4"><input id="reset" type="button" value="Reset   Order"></td>
    </tr>
</table>
&nbsp;&nbsp;<p>&nbsp;</p> &nbsp;&nbsp;
</form> 
```

jQuery编码是：

```
<script type="text/javascript">

 $("#addbt").click(function () {
 $('#choice').clone()
     .attr('id', 'choice' + $('.ddl').length)
     .attr('name', 'choice' + $('.ddl').length)
     .insertAfter(".ddl:last");
 $('#num').clone()
     .attr('id', 'num' + $('.dd2').length)
     .attr('name', 'num' + $('.dd2').length)
     .insertAfter(".dd2:last");});

 $("#removebt").click(function () {
 $("#choice1").remove();
 $("#num1").remove();
 });    

 $('#reset').click(function() {
 location.reload();});
 </script> 
```

如何影响克隆的布局？当我创建超过五个克隆时，它们的高度不再相等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:30:04.780

您的输入和选择元素有不同的边距，因此添加此 CSS 规则可以修复它：

```
#table input, #table select {
    margin: 2px;
} 
```

[http://jsfiddle.net/A6h24/4/](http://jsfiddle.net/A6h24/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:14:00.873

将每个下拉列表/数字对包含在`<TD>`标签中以保持配对。您的 HTML 正文设计得不好，这就是您产生此错误的原因。现在您有一个`<TD>`用于选择和一个`<TD>`用于输入...所以您有两个独立的字符串 HTML 实体，包含不同的类别...这会导致不匹配，因为它们都是独立的。

```
<td style="width: 39px; height: 30px;">         
    <select id="choice" name="choice" class="ddl" style="width: 150px"></select>
    <input id="num" name="num" class="dd2" style="width: 46px" type="number">
</td> 
```

您还必须重写一点您的 JS 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T22:29:46.760

您可以采取以下方法：

```
<td colspan="2">
    <div class="pizza-order-line">
        <select ... ></select>
        <input ... />
    </div>
</td> 
```

在您的 CSS 中：

```
div.pizza-order-line select {
    margin-right: 4px;
}

div.pizza-order-line input {
    ....
} 
```

这样，您可以合理地确定浏览器“知道”需要排队的内容。但是，如果您将多个项目放在表格单元格中，除非它们有保证的高度，否则它们将无法正确排列。

# random - 只选择一次随机值

> ID：14429795
> 
> 赞同：0
> 
> 时间：2013-01-20T21:56:13.120
> 
> 标签：random, background-image

我的页面每次加载时都会加载一个随机背景图像：

```
<?php
    $input = array(1, 2, 3, 4, 5, 6, 7, 8);
    $num = array_rand($input, 1);
    $bg = "img/bg" . $num . ".jpg";
?> 
```

但我希望它只做一次。例如，我希望在访问者提交表单后图像保持不变，从而重新加载页面。

我试过 if($bg=NULL) 等，但无济于事 - 我猜每次重新加载页面时 $bg 都会再次变为空。

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:59:32.213

您可以使用[Session 变量](http://php.net/manual/en/features.sessions.php)或[cookie](http://www.w3schools.com/php/php_cookies.asp)如果未设置，则选择背景，如果已设置，则不执行任何操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:35:41.957

明白了（感谢里卡多）：

```
<?php
    session_start();
    if (!isset($_SESSION['num'])) {
        $input = array(1, 2, 3, 4, 5, 6, 7, 8);
        $_SESSION['num'] = array_rand($input, 1);
    }

    $bg = "img/bg" . $_SESSION['num'] . ".jpg";
?> 
```

# c++ - 编写一个函数来查找整数向量的中位数

> ID：14429796
> 
> 赞同：1
> 
> 时间：2013-01-20T21:56:41.443
> 
> 标签：c++, function, vector, median

我正在尝试编写第二个函数来计算主函数中的整数向量。我的向量是这样设置的。

```
int inputinfo;
cout << "\nPlease enter in scores: ";
cout << "\nEnd your input with ctrl-z\n";
vector<int> scores;
    while (cin >> inputinfo)
    {
        scores.push_back(inputinfo);
    } 
```

这是我的中值方程（我不确定它是否正确）。我想为中值创建一个函数，然后将其调用回主函数以查找向量的中值。

```
 double median;
  size_t size = scores.size();

  sort(scores.begin(), scores.end());

  if (size  % TWO == 0)
  {
      median = (scores[size / 2 - 1] + scores[size / 2]) / 2;
  }
  else 
  {
      median = scores[size / 2];
  } 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:03:36.510

如果您在向量中没有或只有一个数字，请检查您的代码是否失败。您可以使用以下方法解决此问题

```
if (size==0) throw "Vector empty";
if (size==1) return scores[0]; 
```

在 if (size % TWO == 0) 行之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-01T10:29:28.993

简单回顾一下：中位数表示排序列表中的中间条目，对吗？所以你搜索

```
//your array has a even size, so you want the middle of it
if (size  % TWO == 0)
{
median = scores[size / 2 - 1];
}
// your array has a odd size, so you average 
else 
{
median = (scores[size / 2 - 1] + scores[size / 2]) / 2;
} 
```

# javascript - 地图标记在本地显示，但不在实时站点上

> ID：14429799
> 
> 赞同：0
> 
> 时间：2013-01-20T21:56:59.867
> 
> 标签：javascript, google-maps

我已经处理了`Google Maps`几天，现在我得到了这个奇怪的“错误”。
我有一个听众，每次我在地图上按下时，都会出现一个蓝色标记...

但是，只有当我从硬盘运行我的 HTML 文件时才会发生这种情况。一旦我通过我的服务器运行它，蓝色标记就不会出现。我不知道为什么。

执行此操作的代码部分如下所示：

```
//the listener that activates the function if I click on the map
google.maps.event.addListener(map, 'click', function(event) 
{
    setAddress(event.latLng);
});  

//a global marker - because I want a different one if I press another time on the screen  
var marker2= new google.maps.Marker(
{
    map:map,
    title:"title",
    icon:'blue_markerA.png'
});  

//set the marker to the exact location...  
function setAddress(location) 
{
    var point = new google.maps.LatLng(
    parseFloat(location.lat()),parseFloat(location.lng()));

    marker2.setPosition(point);
} 
```

# php - CodeIgniter 应用程序启动的安全检查表

> ID：14429802
> 
> 赞同：1
> 
> 时间：2013-01-20T21:57:27.293
> 
> 标签：php, security, codeigniter, xss, csrf

在启动 CodeIgniter 应用程序之前，有谁知道一个好的安全清单。我们已经测试了已知的 PHP 安全漏洞，并且想知道在启动 CodeIgniter 应用程序时是否需要进行任何测量。

客户特别要求我们基于 CI 框架构建应用程序，我们已经完成了不错的 PHP 安全测试。

基本上，如果我们的 CI 配置设置中有配置，我们应该检查哪些可能会导致问题的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T23:07:23.637

主要的三种攻击是：

1.  SQL 注入攻击：确保不使用非参数化 SQL 查询
2.  XSS 攻击：确保最终`echo`在任何地方返回的所有用户内容都*正确*剥离了它们的标签（例如`xss_clean`用作格式修饰符）。
3.  CSRF 攻击：对所有发送的表单使用 CI 的 CSRF 保护令牌

还要确保身份验证机制到位。

如果它们没问题，请检查您的 PHP 版本的已知错误，并可能升级您的服务器以使用最新的可用版本。

# html - 将锚标记散列到特定的导航选项卡

> ID：14429805
> 
> 赞同：1
> 
> 时间：2013-01-20T21:57:39.723
> 
> 标签：html, tabs, navigation, hashtag

如何在锚标签中使用哈希来打开特定的导航选项卡？例如在我下面的代码中，我想在锚标签中使用哈希来打开我的第三个导航选项卡，但它没有跳到那里:(

```
<body>
   <div class="container">
      <section class="tabs"> <input id="tab-1" type="radio" name="radio-set" class="tab-selector-1" checked="checked" />

         <input id="tab-1" type="radio" name="radio-set" class="tab-selector-1" checked="checked" />
         <label for="tab-1" class="tab-label-1">Radio navigation tab 1</label>

         <input id="tab-2" type="radio" name="radio-set" class="tab-selector-2" />
         <label for="tab-2" class="tab-label-2">Radio navigation tab 2</label>

         <input id="tab-3" type="radio" name="radio-set" class="tab-selector-3" />
         <label for="tab-3" class="tab-label-3">Radio navigation tab 3</label>

         <div class="content">

            <a name="content-3" id="content-1"></a>
            <div class="content-1">
               <h1>Header 1</h1>
               <p>Hello world!</p>
            </div>

            <a name="content-3" id="content-2"></a>
            <div class="content-2">
               <h1>Header 2</h1>
               <p>Hello world!</p>
            </div>

            <a name="content-3" id="content-3"></a>
            <div class="content-3">
               <h1>Header 3</h1>
               <p>Hello world!</p>
            </div>

         </div>

      </section>
   </div>
</body> 
```

例如，我的网址：“www.example.com/#content-3”仍在打开第一个导航选项卡，因此我仍然很难知道如何使哈希锚标记跳转到另一个导航选项卡而不是第一个设置为默认选项卡的选项卡，希望我能得到帮助，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-07-30T05:13:58.593

首先像这样定义锚标签

```
 <a href="#main-slider"> 
```

然后将其重定向到特定区域

```
<li data-target="#main-slider" data-slide-to="0" class="active"></li>
<li data-target="#main-slider" data-slide-to="1"></li>
<li data-target="#main-slider" data-slide-to="2"></li> 
```

# android - Achartengine 条形标签...调用系列中的项目？

> ID：14429810
> 
> 赞同：2
> 
> 时间：2013-01-20T21:57:54.730
> 
> 标签：android, bar-chart, achartengine, labels, series

我正在使用 Achartengine 生成堆积条形图。它工作正常并显示条形底部的值。问题是，有时我需要关闭一些标签，但现在我需要关闭所有标签。看起来该软件可以打开所有标签或关闭所有标签。

```
setChartSettings(renderer, "Gym Attendance", "", "", 0.5, 12.5, 0,
            24000, Color.BLACK, Color.BLACK);
    renderer.getSeriesRendererAt(0).setDisplayChartValues(false);
    renderer.getSeriesRendererAt(1).setDisplayChartValues(true);
    renderer.setShowLegend(false);
    renderer.setMargins(new int[] { 80, 10, 60, 10 });
    renderer.addXTextLabel(1, "Rec. Hall" + "\n" + "(240 max.)");
    renderer.addXTextLabel(2, "White" + "\n" + "Building" + "\n"
            + "(210 max.)");
    renderer.addXTextLabel(3, "IM" + "\n" + "Building" + "\n" + "(60 max.)");
    renderer.addXTextLabel(4, "Fitness Loft" + "\n" + "(40 max.)");
    renderer.setXLabelsColor(Color.rgb(0, 0, 0));
    renderer.setYLabelsColor(0, Color.BLACK);
    renderer.setYLabels(10);
    renderer.setXLabels(0);
    renderer.setXAxisMin(0);
    renderer.setXAxisMax(5);
    renderer.setYAxisMin(0);
    renderer.setYAxisMax(250);
    renderer.setAxesColor(Color.BLACK);
    renderer.setXLabelsAlign(Align.CENTER);
    renderer.setYLabelsAlign(Align.LEFT);
    renderer.setPanEnabled(false, false);
    // renderer.setZoomEnabled(false);
    renderer.setZoomRate(1.1f);
    renderer.setBarSpacing(0.5f);
    renderer.setApplyBackgroundColor(true);
    renderer.getSeriesRendererAt(1).setGradientEnabled(true);
    renderer.getSeriesRendererAt(1).setGradientStart(0,
            Color.rgb(180, 180, 180));
    renderer.getSeriesRendererAt(1).setGradientStop(65,
            Color.rgb(25, 25, 112));
    renderer.setBackgroundColor(Color.rgb(220, 220, 220));
    renderer.setMarginsColor(Color.rgb(248, 248, 255));
    renderer.setOrientation(Orientation.HORIZONTAL);
    renderer.setZoomEnabled(false, false);

    return ChartFactory.getBarChartView(context,
            buildBarDataset(titles, values), renderer, Type.STACKED);

} 
```

这是问题线

```
renderer.getSeriesRendererAt(1).setDisplayChartValues(true); 
```

我需要能够为该系列的每个成员关闭标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:01:24.473

您不能只打开某些图表值。只要不重叠，就会全部显示出来。

但是，请注意最近添加了对注释的支持。您可以执行以下操作：

```
series.addAnnotation("text", x, y); 
```

这样您就可以只添加您想要的注释。

# java - JUnit 参数化 - 为每个参数创建一个实例

> ID：14429811
> 
> 赞同：9
> 
> 时间：2013-01-20T21:58:08.660
> 
> 标签：java, unit-testing, junit, junit4, parameterized

我很恼火地在[Parameterized 文档](http://junit.sourceforge.net/javadoc/org/junit/runners/Parameterized.html)中发现“在运行参数化测试类时，会为测试方法和测试数据元素的交叉产品创建实例。” 这意味着构造函数为每个测试运行一次，而不是在运行所有测试之前。我在构造函数中进行了一项昂贵的操作（1-5 秒），现在该操作重复了太多次，不必要地减慢了整个测试套件的速度。该操作只需一次即可设置所有测试的状态。如何使用参数化测试的一个实例运行多个测试？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T15:46:35.133

我会将昂贵的操作转移到一个`@BeforeClass`方法中，该方法在整个参数化测试中应该只执行一次。

一个愚蠢的例子如下所示：

```
@RunWith(Parameterized.class)
public class QuickTest {

  private static Object expensiveObject;  
  private final int value;

  @BeforeClass
  public static void before() {
    System.out.println("Before class!");
    expensiveObject = new String("Just joking!");
  }

  @Parameters
  public static Collection<Object[]> data() {
    return Arrays.asList(new Object[][] { { 1 }, { 2 } });
  }      

  public QuickTest(int value) {
    this.value = value;
  }

  @Test
  public void test() {
    System.out.println(String.format("Ran test #%d.", value));
    System.out.println(expensiveObject);
  }
} 
```

将打印：

```
Before class!
Ran test #1.
Just joking!
Ran test #2.
Just joking! 
```

# php - 如何选择行数乘以非零列？(mysql)

> ID：14429813
> 
> 赞同：3
> 
> 时间：2013-01-20T21:58:30.813
> 
> 标签：php, mysql, sql

假设我有一张桌子：

```
col1, col2, col3
1     0     1.3
0     0     0
0     1     0
1     1.5   1 
```

现在，假设每一行都有一个“权重”，计算如下：

```
(col1 > 0 ? 1 : 0) + (col2 > 0 ? 1 : 0) + (col3 > 0 ? 1 : 0) 
```

如何选择所有行的总重量？

根据我给出的数据，总权重是 2+0+1+3=6

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T22:01:36.033

`SUM()`您只需要一个围绕所有条件的聚合，没有`GROUP BY`.

```
SELECT
  SUM(
   (CASE WHEN col1 > 0 THEN 1 ELSE 0 END)
   + (CASE WHEN col2 > 0 THEN 1 ELSE 0 END)
   + (CASE WHEN col3 > 0 THEN 1 ELSE 0 END)
  ) AS total_weight
FROM your_table 
```

[http://sqlfiddle.com/#!2/b0d82/1](http://sqlfiddle.com/#!2/b0d82/1)

我在`CASE WHEN...`这里使用它，因为它可以跨任何 RDBMS 移植。由于 MySQL 会为条件返回布尔值 0 或 1，因此可以在 MySQL 中将其简化为：

```
SELECT
  SUM(
   (col1 > 0) /* returns 1 or 0 */
    + (col2 > 0)
    + (col3 > 0)
   ) AS total_weight
FROM your_table 
```

[http://sqlfiddle.com/#!2/b0d82/2](http://sqlfiddle.com/#!2/b0d82/2)

# database - 一个简单的clojure数据库实现

> ID：14429815
> 
> 赞同：3
> 
> 时间：2013-01-20T21:58:56.593
> 
> 标签：database, clojure

我正在学习 Clojure，我正在寻找一些实现简单数据库原则 (CRUD) 的现有项目（github 等）来学习。

不需要用户访问，甚至不需要保存文件，只需将列表\映射实现为表并解析查询的基础知识。

谢谢。

编辑：

这是最后的工作： [QuickDB](https://github.com/guypld/QuickDB)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T23:18:48.777

[FleetDB](http://fleetdb.org/)是一个用 Clojure 实现的简单数据库。

# css - 表溢出：滚动属性

> ID：14429817
> 
> 赞同：1
> 
> 时间：2013-01-20T21:59:11.840
> 
> 标签：css, html-table, overflow

我必须在表中的所有表列上创建一个具有滚动属性的表。但它没有固定表格的高度，也没有将滚动属性赋予数据。

```
<table>
    <tr>
        <td valign="top">
            <h3>Latest Reviews</h3>
            <p><b>This gives the latest riview posted on the website</b></br></p>       
            <p><b>This gives the latest riview posted on the website</b></br></p>
        </td>
        <td valign="top">
            <h3>Top Rated</h3>
            <p>9.3/10</br></p>
            <p>8.3/10</br></p>
        </td>
        <td valign="top">
            <h3>Recipes</h3>
            <p><b><a href="recipe.php">Recipe Title</a></b></p>
            <p><b><a href="recipe.php">Recipe Title</a></b></p>
        </td>
    </tr>
</table> 
```

相关的 CSS 代码在这里：

```
table{
   width:100%;
}
td{
   width:30%;
   height: 100px;
   display: block;
   overflow-y: auto;
} 
```

毕竟，表格的高度等于最大高度的列。有人请解决这个问题。

# android - 如何使用 Eclipse 更改 Android XML 的默认值

> ID：14429818
> 
> 赞同：0
> 
> 时间：2013-01-20T21:59:12.060
> 
> 标签：android, xml, eclipse, android-xml

正如你们所知，图形布局默认按钮、文本视图等 ID 显示为

```
android:id="@+id/Button1"
android:id="@+id/TextView1" 
```

当我命名我的 id 时，我更喜欢以“b”开头的按钮，“tv”开头的文本视图。

所以我的问题是可以将我的 id 的 b1,b2 , tv1 , tv2 等命名为默认值吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T23:26:06.490

Id 生成被硬编码到 ADT 中，它基于小部件的类名（也适用于用户定义的类）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:02:27.063

我认为您无法更改默认值，但您可以轻松更改视图 ID。在 GUI 编辑器中，右键单击元素并单击选项“编辑 ID ...”，然后输入您想要的内容

# c++ - C ++将字节转换为操作码？

> ID：14429820
> 
> 赞同：1
> 
> 时间：2013-01-20T21:59:19.410
> 
> 标签：c++, byte, opcodes

我不知道如何表达这个问题，但是我很想知道汇编程序和其他工具如何显示某些字节的操作码？

```
std::string BytesToOpcode( __in ::BYTE Bytes );

int main( void )
{
    std::cout << BytesToOpcode( ( ::PBYTE )"\x33\xC0" );
    std::cin.get( );
    return( EXIT_SUCCESS );
};

// I don't know what type soo I'll just set as std::string for an example.
std::string BytesToOpcode( __in ::BYTE Bytes )
{
    // Convert Bytes to opcode??
    return( "" );
};

Output should be:
XOR EAX,EAX 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T22:16:53.130

通常，反汇编器将具有表和“解码类型”（通常是函数指针或进入 switch 语句的东西）的组合 - 解码类型告诉指令是哪个类 - 例如，`xor, or, and, add, sub`将具有相同的解码，但`call, jmp`将是不同的解码。`jnz, jz, jnc, jc, ja, jb, jbe, etc`会有另一种解码类型。

所以第一级表将是 256 个条目表。然后，您有某些“前缀”条目，例如`0xff`，下一个字节告诉指令“真正是什么”。同样，您会得到一个包含 256 个`prefix0xff`条目的表。

某些条目可能无效，因为到目前为止并非所有组合都被采用 [尽管几乎全部]。

一个棘手的问题是“修饰符前缀”条目。例如，0x66 会将指令从 32 位操作数大小切换到 16 位操作数大小（如果处理器处于 16 位模式，反之亦然）。

每个类别中的许多实际解码将涉及旋转位并将“位 5-3”转换为寄存器编号或将“位 1-2”转换为地址模式（例如`eax`，是`[eax]`还是`[eax+esi]`）。

这是相当多的工作。我为 80186 编写了一个反汇编程序，我花了大约两天的时间几乎整天工作。然而，我已经知道我在做什么。将其转换为 386 又需要 2-3 天，而且我不想考虑为具有所有 SSE、MMX、3DNow 的现代 x86 处理器执行此操作！等说明。

[而且我花了太长时间解释如何做到这一点以获得“正确答案”——即使这是你如何做到这一点的正确答案——当然，使用现有的库显然是更简单的方法它]。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T22:05:22.907

这是一项非常艰巨的任务。x86 指令集非常复杂。你最好的选择是使用现有的 x86 反汇编库之一来做你想做的事。

这些链接应该可以帮助您入门。

*   [自由主义](http://bastard.sourceforge.net/libdisasm.html)
*   [鼻涕虫](http://www.nasm.us/)
*   [风暴](http://www.ragestorm.net/distorm/)
*   [X86 反汇编程序库](http://www.woodmann.com/collaborative/tools/index.php/Category%3aX86_Disassembler_Libraries)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T22:06:37.830

您可以使用按位运算，例如，如果您的指令是 XOR 并且您的操作码 = 4 位长，并且代码是 3，您需要执行 MASK 和 Shift 以获得该 3，为此，您：

```
your example in bin:   0011 0011 1100 0000
make a AND with:       1111 0000 0000 0000
Result:                0011 0000 0000 0000
Shift 12 places:       0000 0000 0000 0011 <-- This is 3, so you got the instruction 3 
```

对位的其他部分执行相同操作以获取每个函数的参数。

# xmpp - XMPP Smack 使用 openfire 聊天

> ID：14429823
> 
> 赞同：0
> 
> 时间：2013-01-20T21:59:39.177
> 
> 标签：xmpp, openfire, smack

关于让 Chat 与 Smack (3.2.1)/Openfire(3.7.1Alpha) 一起工作的几个问题。

我目前正在使用单元测试对其进行测试。我的单元测试创​​建连接、创建帐户、登录、将新用户添加到其名册、*尝试*向新用户发送聊天消息并最终删除用户。除了我对让聊天工作感到困惑之外，其他人似乎都在工作（使用 openfire 管理仪表板验证）。

**A.**当我执行以下操作时

```
public void sendChatMessage(String sender, String receiver, String message) {     
    Chat chat = chatManager.createChat(receiver, messageListener);     
    chat.sendMessage(message);
} 
```

当前连接是“发件人”（即发件人已登录），我的尝试是向“收件人”发送消息。当我在侦听器中获得回调时，message.getFrom() 返回“接收者”并且 message.getBody() 返回 null。我显然试图代表“发送者”向“接收者”发送消息。我错过了什么？

**B.**我的“发送者”和“接收者”只是唯一的“用户名”（没有任何@域），而我的服务器只是“本地主机”。

```
connection = new XMPPConnection("localhost"); 
```

我是否需要将“接收者”修改为具有不同的值以使其成为有效的 JID（目前没有错误）？如果我更改我的服务器（以及 openfire 服务器配置）怎么办？

**C.**我假设每个用户总会有一个 XMPPConnection？这个对吗？

**D.**

```
XMPPConnection.DEBUG_ENABLED = true; 
```

当我在调试模式下使用 XMPPConnection 时，会打开一个新窗口，但是它与我的 IDE 绑定。我怎样才能让它不绑定到 ide，以便在尝试调试代码时查看日志？

# ios - 实现类似于 Evernote 的同步功能

> ID：14429827
> 
> 赞同：2
> 
> 时间：2013-01-20T21:59:51.347
> 
> 标签：ios, web-services, google-app-engine, rest, amazon-web-services

内容的类型对于这个问题并不重要，但假设我想实现一个（本地移动）购物清单应用程序，允许多个用户在共享列表上进行协作。

像这样的同步功能通常如何实现自动工作（无需明确的用户交互）？每隔几秒钟拉一次以检查较新版本并在必要时进行更新的首选方法是，还是可以推送更改？

我猜想使用 AWS、Google App Engine 甚至从头开始在 LAMP 堆栈和 REST 上实现轮询解决方案（相对）容易。但我担心连续轮询导致的流量。

尝试使用推送更新来实现这一点是否可行？如果是这样，我应该研究哪些技术、服务或设计原则？AWS 或 Google App Engine 是否可以实现类似的功能？还是拉动（并尽可能减少流量）要走的路？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T00:48:16.097

在应用引擎上，您应该查看通道 API。从[概述](https://developers.google.com/appengine/docs/java/channel/)：

Channel API 在您的应用程序和 Google 服务器之间创建持久连接，允许您的应用程序在不使用轮询的情况下实时向 JavaScript 客户端发送消息。这对于旨在立即向用户更新新信息或将用户输入立即广播给其他用户的应用程序很有用。一些示例包括协作应用程序、多人游戏和聊天室。一般来说，在无法预测或编写脚本更新的情况下，例如在人类用户之间传递信息或来自非系统生成的事件时，使用 Channel API 比轮询更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T20:53:58.490

您可以使用一些 Amazon Web Services 来创建有效且响应迅速的服务。

如果您查看可以从[AWS 站点](http://aws.amazon.com/sdkforios)下载的 IOS SDK，您可以在其中找到使用此类服务​​的服务示例：S3_SimpleDB_SNS_SQS_Demo

首先，您可以使用 SQS，它是排队服务，它具有[长轮询](http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-long-polling.html)功能，可以帮助您减少请求数量。

其次，您可以使用 SNS，即通知（发布/订阅）服务。它与 SQS 集成，您可以[订阅队列以收听通知](http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqssubscribe.html)。

这些服务（和其他服务）可通过 iOS SDK 以及其他 SDK（Java、.NET、Android...）以及 REST 和 SOAP API 访问。

# macos - 如何在 64 位应用程序中从 QTKit 获取 PCM 音频？

> ID：14429828
> 
> 赞同：3
> 
> 时间：2013-01-20T21:59:59.113
> 
> 标签：macos, cocoa, 64-bit, quicktime, qtkit

我有一个 64 位 Mac OS X Cocoa 应用程序，它使用 AV Foundation 来满足其大部分媒体 I/O 需求，但是我希望它也能够读取其他格式，尤其是 AVI 容器内的 Motion JPEG，但是可能还有其他（第 3 方 QuickTime 插件支持的其他编解码器和格式）。这当然将我引向 QTKit，因为 QuickTime 本身不适用于 64 位应用程序。

这是一个视频处理和编辑应用程序，所以我需要抓取解码后的样本数据。

我已经解决了 QTKit 中帧抓取的最大性能问题。对于那些感兴趣的人，您希望将 QTMovie 步进到所需的帧采样时间，然后在启用 QTMovieFrameImageSessionMode 属性的情况下使用 QTMovie 的 -frameImageAtTime 抓取它，并设置 QTMovieFrameImageType 为您提供 CVPixelBufferRef 而不是 NSImage。

但是，在获取解码的 PCM 音频数据时，我不知所措。在 QuickTime 的 7 天里，这很容易，但我当然不能从 64 位应用程序调用 QuickTime API。我在 QTMovie 类中看不到任何相关内容，或者我也看不到 QTTrack 级别。那么... 64 位应用程序如何从 QTKit 或 QuickTime 获取 PCM 音频？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T08:45:57.253

我只是在为类似的问题而苦苦挣扎。提取音频数据所需的 QT API 部分对 64 位应用程序根本不可用。获取任何音频数据的所有相关帖子均参考**MovieAudioExtractionFillBuffer**等。

我的解决方案将是应用程序和项目拆分，因此我将有一个 32 位音频提取器进程和一个 64 位主应用程序进程，使用一些 IPC 内存传输来获取音频数据。

# r - 什么相当于Stata“。” 在 R 中

> ID：14429832
> 
> 赞同：2
> 
> 时间：2013-01-20T22:00:16.787
> 
> 标签：r, stata

我有一个`Stata`命令生成`y`具有值的新变量`.`

```
gen y=. 
```

我想知道以下是否是`R`“

```
y<-NA 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T22:28:44.730

使用[这个](http://data.princeton.edu/stata/dataManagement.html)

> 在 Stata 中，数字变量的基本缺失值由点表示。

在 R 中，缺失值由 NA 表示。

> 从版本 8 开始，有 26 个额外的缺失值代码，用 .a 到 .z 表示。这些值在内部表示为非常大的数字，因此 valid_numbers< 。< .a < ... < .z。

R没有这样的缺失数据表示。所有缺失数据由 表示 `NA`。

> 在 Stata 要检查是否丢失，您需要编写 var >= 。

在 R 中，我们`is.na`用来检查缺失的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T03:27:28.780

正如另一个答案所表明的那样，可以在 Stata 和 R 之间进行比较的对象中的缺失数据（例如 a `data.frame`）将被编码为`NA`。`NULL`是另一种可能。这是一个空矩阵：

```
> x = matrix(); x
     [,1]
[1,]   NA 
```

也可以有零长度的对象，比如一个空字符串：

```
> x <- ""; x
[1] "" 
```

回到答案的有用部分，`NA`是`is.na`你想要记住的部分。

# html - <%@LANGUAGE="JAVASCRIPT" CODEPAGE="65001"%> 显示在我的网页顶部

> ID：14429835
> 
> 赞同：0
> 
> 时间：2013-01-20T22:00:57.020
> 
> 标签：html, dreamweaver

我不是编码员，所以我使用 Dreamweaver CS5.5 创建我的网站。我使用（html 5）模板来创建页面，并注意到当在所有浏览器中呈现时，第一行代码显示在页面顶部。

它是顶部的第一行代码：

```
<%@LANGUAGE="JAVASCRIPT" CODEPAGE="65001"%> 
```

此行不会出现在 Dreamweaver 的“设计视图”或“实时视图”中，但会显示在“代码视图”中。如果我在“代码视图”中，然后按“实时代码”按钮，它就会从代码顶部消失。然后在我将其关闭时重新出现 - 所以我认为这是渲染时应该发生的事情，除非出于某种原因它出现了。

它重要吗？如果我删除它会影响什么吗？我认为它的存在是有原因的，因此在渲染时隐藏它的任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:11:27.263

> 它重要吗？如果我删除它会影响什么吗？

是的，但不是在 HTML 代码中。它是服务器端代码。如果你删除它，它不会影响任何东西。

# html - div背景不显示

> ID：14429845
> 
> 赞同：1
> 
> 时间：2013-01-20T22:01:54.313
> 
> 标签：html, css, positioning

为什么我的 div 的背景不能正常显示？这是代码：

```
<div style="
    width:676px; 
    height:230px; 
    display: inline; 
    margin: 0 0 0 0; 
    background-image: url('http://www.goodsstall.co.uk/ekmps/shops/goodsstall/resources/Design/becomefan.png');">    
</div> 
```

我的想法是制作宽度为 676 像素、高度为 230 像素的 div，其背景图像为 [http://www.goodsstall.co.uk/ekmps/shops/goodsstall/resources/Design/becomefan.png](http://www.goodsstall.co.uk/ekmps/shops/goodsstall/resources/Design/becomefan.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:04:07.083

去掉`display:inline`之后就可以看到了。[在这里工作小提琴](http://jsfiddle.net/WjHF4/)。

如果您需要它内联，请考虑使用`float: left`or `display: inline-block`。

[浮动参考。](https://developer.mozilla.org/en-US/docs/CSS/float)
[显示参考。](https://developer.mozilla.org/en-US/docs/CSS/display)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T22:14:33.680

`display: inline-block`代替`display: inline`

[演示](http://jsfiddle.net/Lufq8/)

# javascript - 在特定文本上动态定位 DIV

> ID：14429847
> 
> 赞同：0
> 
> 时间：2013-01-20T22:01:58.587
> 
> 标签：javascript, html, css, font-size

我在网页的一行中显示一个长而连续的文本片段（代表 DNA 序列）。我正在使用单宽字体，并希望使用 javascript 将 DIV 动态定位在文本中的某个字符（例如第 20 个字符、第 50 个字符等）。计算可用于定位 DIV 的坐标的最佳方法是什么？我需要该解决方案对用户在浏览器中更改字体大小具有鲁棒性。

编辑：

我添加了一个 jsfiddle 作为示例：http: [//jsfiddle.net/kQLqV/](http://jsfiddle.net/kQLqV/)并添加了下面的代码。

例如，在示例中，我希望能够将蓝色框定位在第 10-20 个字母上。我希望能够在 javascript 中动态执行此操作，以便可以将框移动到文本中的不同位置。我确实考虑过将每个字母放在一个跨度中，但考虑到可能有大约 1000 个字母，对于看起来*应该*微不足道的东西来说，开销似乎很高。

```
<style>
.sequence {
  font-family: Courier;
  font-size:12px;
  width: 70%;
  overflow: hidden;
  float: left;
  position: relative;
}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

<body>

<div id="my_seq" class="sequence">CAGCATCAGCATACGACTACGACGACTCAGCGACTACAGCATACGACGGGSCAAGGTACTGATCATAAATGCATAGACGATAAGACATAGAACGATAAGAGATTACGA...</div>

<script>
$("#my_seq").append("<div style='position:absolute; min-height: 100%; background-color:rgba(30,144,255,0.3); top:0; left:20px; width: 200px;'> </div>");
</script>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:09:25.253

我会避免对字符和字体范围进行数学计算。取而代之的是，将字符串由单个字符跨度组成，然后您可以使用跨度对象上的 offsetWidth 和 offsetLeft（如果需要，还包括 Height 和 Top）来获取元素大小和定位。

这种方法会有一些开销，所以如果你可以合并应该有帮助的跨度。

# jquery - 替代 window.find jquery

> ID：14429850
> 
> 赞同：1
> 
> 时间：2013-01-20T22:02:18.190
> 
> 标签：jquery

是否有替代方法可以在`div`except中查找文本

```
window.find(text) 
```

此命令会在 Firefox 中打开我想避免的搜索对话框。

我的目标是在搜索时突出显示 div 中的某些单词。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T22:05:02.653

您可以使用[jQuery Highlight 插件](http://bartaz.github.com/sandbox.js/jquery.highlight.html)，示例用法：

```
$(document).highlight("word"); 
```

或者

```
$(".div_class").hightlight("word"); 
```

`span`这将使用类在单词周围创建一个 DOM 元素 ( )，`hightlight`然后只需添加相关的 CSS 以突出显示单词，例如

```
.highlight {
    background-color: #FFFF88;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-20T22:05:27.880

$('div[text == "mysearch"]')

如果需要，您可以扩展它以在其上添加一个突出显示的 CSS 类。

# computer-vision - 单应性估计 - >产生仿射矩阵？

> ID：14429853
> 
> 赞同：4
> 
> 时间：2013-01-20T22:02:29.320
> 
> 标签：computer-vision, transformation, projection, homography

我正在从平面标记（使用 Matlab）开发姿势估计系统。为了做到这一点，我在使用网络摄像头捕获的图像中检测一个矩形，获取 4 个角点的坐标并计算这些角点在齐次坐标中的单应性，例如

```
 58     46     75     90
 M = 67    108    133     89
      1      1      1      1 
```

其中第一行是垂直坐标，第二行是水平坐标。

我用 DLT 计算这些点和参考点之间的单应性（使用我在网上找到的几种不同的单应性计算函数，以及 Matlab 的 cp2tform，它们都给出相同的结果），因为我知道标记是一个正方形,

```
 1     1   100   100
 m = 1   100   100     1
     1     1     1     1 
```

[**编辑**：它们都按~~逆时针~~顺序排序，所以我确保它们匹配。]

然后我绘制这些参考点的重投影

```
 m* = H*m 
```

回到网络摄像头图像，以查看单应性的拟合程度。

结果很好，因为我只围绕 z 轴旋转（即把它放在网络摄像头前面并手动倾斜它）标记（=标记的范数向量）；重新投影的点几乎完全投影到较早检测到的标记角点上，并且分解的 z 轴角度计算得很好。

但是，如果我围绕 x 和/或 y 轴旋转标记，则重新投影的点会逐渐偏离很多。然后我意识到计算出的单应矩阵 H 几乎是一个仿射矩阵，例如 H=

```
 0.2339   -0.0967   57.8362
H = 0.1339    0.4714   66.3639
   -0.0010    0.0005    1.0000 
```

（无论我如何倾斜标记，元素 h31 和 h32 几乎为零）这可以通过查看重新投影的点来确认，这些点看起来总是仿射变换的结果，而不是投影变换的结果。不出所料，x 轴和 y 轴的分解角度几乎为零/等于零。

显然我在网上找到的函数不能都得到单应性计算错误，Matlab的cp2tform也不能，但不幸的是我没有看到或理解我的错误是什么。它必须在像素坐标的使用中，但由于查看许多单应性解释并搜索“单应性估计结果仿射”没有产生任何结果，如果有人能指出我正确的方向，我会很高兴。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T15:29:09.327

正如我从评论中提供的值@mmpg 看到的那样，我的 y 轴和 x 轴仍然切换为匹配 Matlab 的图像坐标系（y 第一，x 秒），结果证明是问题所在。我没有想到这么基本的问题，因为我得到的 Homography 在很多角度都非常接近正确的。

# javascript - 加载某个div而不刷新查询中的页面

> ID：14429854
> 
> 赞同：2
> 
> 时间：2013-01-20T22:02:36.040
> 
> 标签：javascript, jquery, jquery-selectors, load

我在这里多次看到过类似的问题，但这个问题有点不同。我有一个帖子查询将内容显示为；

```
<div class="block1">
<a class="button" href="#">Button</a>
<div class="wholiked">content</div>
</div>
<div class="block2">
<a class="button" href="#">Button</a>
<div class="wholiked">content</div>
</div> 
```

我试图通过单击 .block1 中的按钮重新加载 .block1 中的 .wholiked 而不刷新页面。但在这种情况下，所有块中的所有 .wholiked 内容都会重新加载，而不是特定的内容。

```
$(function() {
      $('.button').click(function(evt) {
         $('.wholiked').load('index.php .wholiked');
         evt.preventDefault();
      })
    }); 
```

如何将其限制为仅在按钮所在的特定块内起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:07:28.187

您的选择器“.wholiked”正在加载该类的所有元素。假设您想要单击按钮旁边的那个，请使用：

```
$(this).next('.wholiked').load('index.php'); 
```

如果不能保证 sibign 关系，则需要以某种方式定义唯一关系。一个示例是在父 div 上使用公共父类，如下所示：

```
<div class="block1 block">
    <a class="button" href="#">Button</a>
    <div class="wholiked">content</div>
</div>
<div class="block2 block">
    <a class="button" href="#">Button</a>
    <div class="wholiked">content</div>
</div> 
```

那么JS将是：

```
$(this).closest('div.block').find('.wholiked').load('index.php'); 
```

或者您可以在按钮上放置一个数据属性来定位元素：

```
<div class="block1">
    <a class="button" data-contentselector="#content1" href="#">Button</a>
    <div id="content1" class="wholiked">content</div>
</div> 
```

JS：

```
$($(this).data('contentselector')).load('index.php'); 
```

# java - GWT 序列化中的 FieldSerializer 编译错误

> ID：14429855
> 
> 赞同：1
> 
> 时间：2013-01-20T22:03:00.507
> 
> 标签：java, gwt, serialization

我被这个错误困住了：

```
[DEBUG] [testgwt] - Rebinding org.stofkat.testgwt.client.GetTestsService
[INFO] [testgwt] - Module testgwt has been loaded
[ERROR] [testgwt] - Errors in 'generated://CB9089E742875E64C1F5E08E3E60A8B5        /org/stofkat/testgwt/shared/TestsWrapper_FieldSerializer.java'
[ERROR] [testgwt] - Line 9: The type TestsWrapper_FieldSerializer must implement the inherited abstract method TypeHandler.serial(SerializationStreamWriter, Object)
[ERROR] [testgwt] - Line 9: The type TestsWrapper_FieldSerializer must implement the inherited abstract method TypeHandler.deserial(SerializationStreamReader, Object)
[ERROR] [testgwt] - Line 36: Type mismatch: cannot convert from TestsWrapper to Object
[ERROR] [testgwt] - Line 40: Cannot cast from Object to TestsWrapper
[ERROR] [testgwt] - Line 44: Cannot cast from Object to TestsWrapper
[INFO] [testgwt] - See snapshot: C:\Users\Leejjon\AppData\Local\Temp\org.stofkat.testgwt.shared.TestsWrapper_FieldSerializer4210265464022362123.java 
```

我已经设法在[这里](https://sourceforge.net/projects/stofkatengine/files/Reproduce.zip/download?_test=updater&utm_expid=65835818-0)隔离了两个 Java 项目中的问题（只需在 Eclipse 上将项目作为 GWT Web 应用程序运行，然后按下页面上的按钮）。

我正在尝试使用 libgdx 创建一个游戏，其中可以将关卡从 XML 文件加载到 POJO 中。然后我将 POJO 传递给引擎，它会显示关卡。我正在使用 SimpleXML 进行 XML 解析，因为该库适用于 Android 和桌面 Java。但是我不能在游戏的 GWT (HTML5) 版本中使用它，因为 SimpleXML 框架使用来自 java.io 的类。（这是不允许的，因为 GWT 客户端的 Java 代码被编译成 javascript，并且不允许简单地从文件系统上的任何文件中读取内容）。因此，我现在将 XML 文件加载到 GWT 服务器上的 POJO 中，并尝试使用 RPC 将其传递给客户端。

POJO 类将位于桌面 (LWJGL)、Android 和 HTML5 (GWT) 版本正在使用的 Java 项目中，因此 POJO 类无法实现 IsSerializable，因为 GWT jar 不能在该项目中。[因此，我在另一个 stackoverflow 主题](https://stackoverflow.com/questions/138099/how-do-i-add-a-type-to-gwts-serialization-policy-whitelist)中遵循了 Glenn 的回答，并为每个 POJO 创建了一个包装器类，该包装器类扩展了原始 POJO 并实现了 IsSerializable。

请帮助我验证这是 GWT 中的错误还是我做错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T03:38:53.327

IsSerializable 不再是强制性的。您使用的 stackoverflow 参考确实很旧。请通过[https://developers.google.com/web-toolkit/doc/latest/tutorial/RPC](https://developers.google.com/web-toolkit/doc/latest/tutorial/RPC)

为你准备的相关部分**3\. 序列化 Java 对象**

```
A type is serializable and can be used in a service interface if one of the following is true:

All primitive types (int, char, boolean, etc.) and their wrapper objects are serializable by default.
An array of serializable types is serializable by extension.
A class is serializable if it meets these three requirements:
It implements either Java Serializable or GWT IsSerializable interface, either directly, or because it derives from a superclass that does.
Its non-final, non-transient instance fields are themselves serializable, and
It has a default (zero argument) constructor with any access modifier (e.g. private Foo(){} will work) 
```

**您的解决方案可能偏离了轨道。这种方法会消耗带宽和运行时性能。**

# scala - 在按名称参数传递的函数上使用apply（“（）”）：不强制评估？

> ID：14429857
> 
> 赞同：3
> 
> 时间：2013-01-20T22:03:20.657
> 
> 标签：scala, callbyname

我有一个功能：

```
def nanoTime() = {
    println("Getting nano time...")
    System.nanoTime // returns nanoTime
} 
```

和另一个函数，它接受一个函数

```
def printTime(time: => Long) = {  // indicates a by-name parameter
    println(">> delayed()")
    println("Param: " + time)
    time // returns time
} 
```

现在事情就是这样。当我做：

```
scala> printTime(nanoTime())
>> delayed()
Getting nano time...
Param: 546632085606127
Getting nano time...
res11: Long = 546632086131624 
```

当我这样做时，我得到了相同的结果：

```
scala> printTime(nanoTime)
>> delayed()
Getting nano time...
Param: 546622367510997
Getting nano time...
res10: Long = 546622368149903 
```

之间没有区别：

```
scala> printTime(nanoTime()) 
```

和

```
scala> printTime(nanoTime) 
```

所以传递函数名和传递函数名后跟（）是没有区别的。是不是一直都是这样，还是这个案子有什么特别之处？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T22:33:02.507

Scala 有*参数列表*的概念，其中一个方法可能需要多个参数。但是，为了方便起见，它也允许省略终端空参数列表。所以

```
f
f()
f()() 
```

可能都是一样的——你不知道，直到你看`f`. 别名参数的作用是延迟代码块的执行。现在，正式地，如果我们有

```
def f0: String = "salmon"
def f1(): String = "herring"
def f2()(): String = "halibut" 
```

`f0`那么如果转换为函数，您会期望匹配一个按名称参数，而其他参数则不匹配。具体来说，您会期望

```
f0   <==>   => String
f1   <==>   () => String
f2   <==>   () => () => String 
```

转换时。让我们看看通过以下方式请求时实际发生了什么`f _`：

```
scala> f0 _
res4: () => String = <function0>

scala> f1 _
res5: () => String = <function0>

scala> f2 _
res6: () => () => String = <function0> 
```

那好吧; `f0`实际上转换为一个带有一个空参数块而不是零的函数（这是一个名称参数的样子）。所以事实证明，你的 by-name 参数根本没有将你的方法转换为函数——类型签名不匹配！

因此，它的原因如下：

```
// I need a code block that returns a long
nanoTime             // Wait, there is no nanoTime exactly
nanoTime()           // Aha, that works!  Must have meant that
: => { nanoTime() }  // There, nicely packaged. 
```

您看不到区别的原因是，为了返回 a `Long`， by-name 参数已经填充了缺失的`()`，然后将整个内容包装在代码块中以供稍后执行。

（还要注意，名称参数*实际上*只是`Function0`在幕后——也就是说，`x: => A`真的是`x: () => A`——而“零参数块”只是编译器虚构的。实际上，所有参数块都是编译器虚构的——JVM只知道一个参数列表。正是这种无块虚构，加上 who-cares-about-empty-parens 虚构，导致了观察到的行为。）

如果你从一个空的参数块请求一个函数，那么事情就像这样：

```
def printF(f: () => String) = println(f())

scala> printF(f0)
<console>:23: error: type mismatch;
 found   : String
 required: () => String
              printF(f0)
                     ^

scala> printF(f1)
herring

scala> printF(f2)
<console>:23: error: type mismatch;
 found   : () => String
 required: String
              printF(f2)

scala> printF(f2())
halibut 
```

现在括号*确实很*重要，因为编译器正在尝试将方法签名与函数签名匹配。按名称参数情况的特殊情况不再适用。

# java - Java KeyListener 事件循环直到释放密钥

> ID：14429859
> 
> 赞同：2
> 
> 时间：2013-01-20T22:03:37.277
> 
> 标签：java, awt, keylistener

我正在用 java 开发一个简单的平台游戏，并且在播放器的跳跃时遇到了麻烦。正在发生的事情是，如果我按住空格键，播放器就会继续上升。我需要一些方法让玩家每次按下空格键跳一次。我当前用于跳跃的 KeyListener 设置如下。

```
public void keyPressed(KeyEvent e) {
    int key = e.getKeyCode();

    if (key == KeyEvent.VK_SPACE)
        Input.jump = true;
}

public void keyReleased(KeyEvent e) {
    int key = e.getKeyCode();

    if (key == KeyEvent.VK_SPACE)
        Input.jump = false;
} 
```

在我的 Player 课程中，我有以下用于切换跳跃

```
if(Input.jump == true) jump(); 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:12:09.083

问题不在于每次按键都会调用该事件 - 问题是`Input.jump`在您松开按键之前都是如此。

你可以尝试这样的事情：

```
public void keyPressed(KeyEvent e) {
    int key = e.getKeyCode();
    if (key == KeyEvent.VK_SPACE)
        if(!Input.jump) {
            velocity += jumpVelocity;
        }
        Input.jump = true;
}

public void keyReleased(KeyEvent e) {
    int key = e.getKeyCode();

    if (key == KeyEvent.VK_SPACE)
        Input.jump = false;
} 
```

然后使用速度向上移动你的角色。

或者你可以使用某种布尔值——这真的取决于你的情况。如果您使用的是布尔值，那么您需要类似以下代码：

```
public void keyPressed(KeyEvent e) {
    int key = e.getKeyCode();
    if (key == KeyEvent.VK_SPACE)

        if(!Input.jump) {
            isJumping = true;
        } else {
            isJumping = false;
        }
        Input.jump = true;
} 
```

# android - 如何从谷歌地图v2 android中的标记获取屏幕坐标

> ID：14429877
> 
> 赞同：35
> 
> 时间：2013-01-20T22:05:37.673
> 
> 标签：android, google-maps, google-maps-markers

我有一个小的 android 问题（谷歌地图 v2 api）

这是我的代码：

```
GoogleMaps mMap;
Marker marker =  mMap.addMarker(new MarkerOptions().position(new LatLng(20, 20))); 
```

我正在尝试找到一种方法来获取此标记对象的当前屏幕坐标 (x,y)。

也许有人有想法？我尝试了 getProjection 但它看不到工作。谢谢！:)

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-01-20T22:40:24.860

是的，使用`Projection`类。进一步来说：

1.  获取`Projection`地图：

    ```
    Projection projection = map.getProjection(); 
    ```

2.  获取标记的位置：

    ```
    LatLng markerLocation = marker.getPosition(); 
    ```

3.  将位置传递给`Projection.toScreenLocation()`方法：

    ```
    Point screenPosition = projection.toScreenLocation(markerLocation); 
    ```

就这样。现在`screenPosition`将包含标记相对于整个地图容器左上角的位置:)

## 编辑

请记住，`Projection`对象只会*在地图通过布局过程后*返回有效值（即它具有有效`width`和`height`设置）。您可能会得到，`(0, 0)`因为您试图过早地访问标记的位置，就像在这种情况下：

1.  通过扩展它从布局 XML 文件创建地图
2.  初始化地图。
3.  向地图添加标记。
4.  查询`Projection`地图上屏幕上的标记位置。

这不是一个好主意，因为地图没有设置有效的宽度和高度。您应该等到这些值有效。解决方案之一是将 a 附加`OnGlobalLayoutListener`到地图视图并等待布局过程解决。在扩展布局并初始化地图后执行此操作 - 例如在`onCreate()`：

```
// map is the GoogleMap object
// marker is Marker object
// ! here, map.getProjection().toScreenLocation(marker.getPosition()) will return (0, 0)
// R.id.map is the ID of the MapFragment in the layout XML file
View mapView = getSupportFragmentManager().findFragmentById(R.id.map).getView();
if (mapView.getViewTreeObserver().isAlive()) {
    mapView.getViewTreeObserver().addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
        @Override
        public void onGlobalLayout() {
            // remove the listener
            // ! before Jelly Bean:
            mapView.getViewTreeObserver().removeGlobalOnLayoutListener(this);
            // ! for Jelly Bean and later:
            //mapView.getViewTreeObserver().removeOnGlobalLayoutListener(this);
            // set map viewport
            // CENTER is LatLng object with the center of the map
            map.moveCamera(CameraUpdateFactory.newLatLngZoom(CENTER, 15));
            // ! you can query Projection object here
            Point markerScreenPosition = map.getProjection().toScreenLocation(marker.getPosition());
            // ! example output in my test code: (356, 483)
            System.out.println(markerScreenPosition);
        }
    });
} 
```

请通读评论以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-15T01:44:04.953

toScreenLocation 似乎已被 fromLatLngToPoint gmaps api doc 替换为投影：[https ://developers.google.com/maps/documentation/javascript/reference/image-overlay#Projection](https://developers.google.com/maps/documentation/javascript/reference/image-overlay#Projection)

# variables - 带有自动工具的动态目标

> ID：14429882
> 
> 赞同：2
> 
> 时间：2013-01-20T22:05:55.220
> 
> 标签：variables, dynamic, makefile, autotools, automake

我正在尝试使用 autotools 实现一些非常具体的东西 - 动态变量名。我的目标是根据某个配置文件创建动态目标，类似于 Linux 内核。

Linux 内核可以使用 make menuconfig 进行配置，最终生成一个 .config。Linux 内核的 Makefile 包含目标，例如`obj-$(CONFIG_DMA)`，根据 的值`CONFIG_DMA (y, n or m)`，相关的源文件将作为模块静态构建，或者根本不构建。我正在使用 kconfig-frontends，它可以让我生成一个 .config 文件，然后我可以将其包含在标准 GNU Makefile 中并成功使用。我想用 automake 实现相同级别的功能，但不幸的是 automake 拒绝根据外部环境变量设置变量名。我可以想出一些巧妙的方法来解决这个问题，但我确信必须有一种方法可以以一种清晰的方式实现这一点。谁能想到一个解决方案？

任何帮助表示赞赏，如果它解决了我的问题，我愿意使用 cmake。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:30:37.597

也许你可以使用`EXTRA_foo_SOURCES`？您可能无法在变量赋值的 LHS 中使用变量替换，但您当然可以在 RHS 上这样做。列出*所有*可能的来源`EXTRA_foo_SOURCES`，然后根据`.config`定义，设置`foo_SOURCES`- 并考虑使用`+=`for do to。

您可能必须发明一个文件扩展名约定以根据 y/m/n 获得所需的不同行为；也许`foo_SOURCES = mod.yo`对于内置模块（不要让 *.o 用于 *_SOURCES* 变量分散您的注意力 - 只需提供规则并让应该弄清楚）、`foo_SOURCES = mod.mo`可加载模块和`foo_SOURCES = mod.no`禁用模块。然后，您需要帮助将规则粘合在一起。给你一些想法的东西：

```
-include .config
EXTRA_foo_SOURCES = $(obj-y) $(obj-m)
.c.o: # No rule; disables implicit rule
.c.yo:
    $(COMPILE) -o $@ $<
.c.mo:
    $(COMPILE) -DTHIS_IS_A_MODULE -o $@ $<
.c.no:
    touch $@
.yo.o:
    cp $< $@
.mo.o:
    cp $< $@
.no.o:
    cp /path/to/null/object.o $@ 
```

希望你能有所作为。我把它作为汽车原子的汤，而不是成品，希望你能把它变成一个美丽的分子。

# matlab - 使用 FFT、PSD 和 STFT 进行音频特征提取并找到最强大的频率

> ID：14429885
> 
> 赞同：2
> 
> 时间：2013-01-20T22:06:14.330
> 
> 标签：matlab, fft, audio-processing, feature-extraction

1) 假设我有使用`F = fft(x)`和获得的 FFT 和 STFT 系数`S = spectrogram(x)`。这些系数如何用作音频特征？（这里音频特征用于模式识别）。

2) 以下代码是否给出了信号中的 PSD 和最强大的频率（以 kHz 为单位）？

```
Hs = spectrogram.periodogram;
p = psd(Hs, x, 'Fs', 22050);
[C, I] = max(p.data);
max_f = p.Frequencies(I); 
```

3) 如果 (2) 没问题，我如何`n`使用 PSD 找到信号中最强大的频率？

4) 如何使用类似于 PSD 的 FFT 和/或 STFT 找到最强大的频率？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T09:52:35.650

我认为您需要定义“音频功能”的含义。根据您要实现的目标，有许多不同类型的功能（例如，请参阅[这些论文](http://scholar.google.co.uk/scholar?q=audio%20features%20extraction&hl=en&as_sdt=0&as_vis=1&oi=scholart&sa=X&ei=qw39UIGKBpHY0QXOm4HgDA&ved=0CDAQgQMwAA)中的一些功能）。

当您谈论“最强大的频率”时，我假设您想要进行某种形式的音高检测？如果是这种情况，那么 PSD 的峰值确实会给出最主要的频率，但这不一定是您听到的音高。例如，乐器可能正在演奏 200Hz 的音符，其频谱峰值在 200、400、600、800 等处，而 200Hz 不一定是最高振幅。事实上，您可以应用一个低通滤波器来去除 200Hz 分量，您仍然会认为它是音高（如果您通过电话听到音乐，您会听到这种效果 - 它被称为[虚拟音高](http://jjensen.org/VirtualPitch.html)）。

如果您想检测音高，那么我建议您阅读[音高估计](http://en.wikipedia.org/wiki/Pitch_detection_algorithm)算法。

编辑：那里有很多关于音频分类研究的论文，所以请[搜索](https://www.google.co.uk/search?q=audio%20classification%20scheirer&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a#hl=en&client=firefox-a&hs=p9W&tbo=d&rls=org.mozilla%3aen-US%3aofficial&sclient=psy-ab&q=audio%20classification&oq=audio%20classification&gs_l=serp.3..0j0i30l3.167766.167766.0.167951.1.1.0.0.0.0.74.74.1.1.0.les;..0.0...1c.1.vfZ_-pdvBaw&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.41524429,d.d2k&fp=a0b2ec51e8be5bd5&biw=1094&bih=1040)Eric Sc​​heirer、George Tzanetakis 和 Martin McKinney 等人的工作。我还会注册[MIR 邮件列表](http://www.ismir.net/)，因为该列表中有很多该领域的核心人员，而且档案中有很多有用的东西。至于你关于“最强频率”的问题，我不太明白你的意思。当聆听不止一种乐器演奏的音乐时，通常没有一个主导频率。通常有一种可感知的旋律，由于混合而通常很突出，但我不确定这是否是你的意思。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T06:56:49.637

1)`S = spectrogram(x)`通过将信号 x 细分为多个部分并计算每个部分的 PSD，为您提供作为时间函数的 FFT。`fft(X)`一次性为您提供整个信号的 fft。前者更有可能跟踪频率内容的变化，而后者更有助于查看整体频率内容。我对音频处理不太熟悉，但即使两个信号具有相同的功率谱，FFT 复杂相位的微小变化也会导致时域中的信号截然不同。

2) 语法似乎与我在 Matlab 中习惯的有点不同，但答案是肯定的。频率的单位取决于您使用的确切语法。

3）您可以使用该`sort`功能来获得n个最强大的频率箱。例如，`[B,IX] = sort(p.data)`和`freq_maxn = p.Frequencies(IX(1:n))`

4) PSD = |FFT|^2/N。换句话说，PSD 只是 FFT 平方幅度的缩放版本。然而，对于实值信号，只使用了一半的 FFT，因为另一半只是一个复共轭。一旦你有了这个序列，最大频率和前 n 个频率的计算保持与 (2) 和 (3) 相同。有关详细信息，请参阅 [周期图] (http://www.mathworks.com/help/signal/ref/periodogram.html)。

# jquery - 附加输入值参数的 Jqgrid 问题

> ID：14429890
> 
> 赞同：0
> 
> 时间：2013-01-20T22:07:17.767
> 
> 标签：jquery, jqgrid

我有一个构建应用程序用户界面的 javascript 函数。

首先，我将所有需要的元素附加到一个 div 中，其中一个是 jqgrid。

这是一个例子：

```
 //Generate the controls
    var c = '';
        c += '<table>';
        c += '<tr>';
        c += '<td><label for="from_date">Start Date</label><td>';
        c += '<td><input type="text" id="from_date"/></td>';
        c += '<td><label for="to_date">End Date</label><td>';
        c += '<td><input type="text" id="to_date"/></td>';              
        c += '</tr>';
        c += '</table>';

    //Perform an ajax call update date pickers
    $.ajax({
        url: "php/daily_schedule/daily.schedule.get.date.limits.php",
        dataType: "json",
        success: function(data) {

        //Update the values of the inputs
        $("#from_date").val(data.MAX);
        $("#to_date").val(data.MAX);

        //Split json results to pass new date objects
        var max_array = data.MAX.split('-');

        var max_yy    = max_array[0];
        var max_mm    = max_array[1]-1;
        var max_dd    = max_array[2];

        var min_array = data.MIN.split('-');

        var min_yy    = min_array[0];
        var min_mm    = min_array[1]-1;
        var min_dd    = min_array[2];

        //Initiate the from date picker
        $( "#from_date" ).datepicker({
                        dateFormat :"yy-mm-dd",
                        defaultDate: new Date(max_yy, max_mm, max_dd),
                        maxDate: new Date(max_yy, max_mm, max_dd),
                        minDate: new Date(min_yy, min_mm, min_dd),                                                                                                           
                        changeMonth: false,
                        numberOfMonths: 1,
                        onClose: function( selectedDate ) {
                                        $( "#to_date" ).datepicker( "option", "minDate", selectedDate );
                        },
                        onSelect:function(){

                            load_FLT();

                        }

        });

        //Initiate the to date picker                                                       
        $( "#to_date" ).datepicker({
                        dateFormat :"yy-mm-dd",
                        defaultDate: new Date(max_yy, max_mm, max_dd),
                        maxDate: new Date(max_yy, max_mm, max_dd),
                        minDate: new Date(min_yy, min_mm, min_dd),                                                                                                                              
                        changeMonth: false,
                        numberOfMonths: 1,
                        onClose: function( selectedDate ) {
                                        $( "#from_date" ).datepicker( "option", "maxDate", selectedDate );
                        },
                        onSelect:function(){

                            load_FLT();

                        }

        });         

        }

    });

    //Append the controls
    $('#daily_schedule_core_filters_container').append(c)

    //Generate grid elements
    $('#daily_schedule_core_grid_container').append('<table id="daily_schedule_grid"></table>')
    $('#daily_schedule_core_grid_container').append('<table id="daily_schedule_grid_pager"></table>') 
```

然后我添加网格：

```
 //Create the daily schedule grid
    jQuery("#daily_schedule_grid").jqGrid({
        url:'php/daily_schedule/daily.schedule.grid.php',
        datatype: "json",
        hidegrid: false, 
```

等等等等

我的问题是我将它添加到我的网格中：

```
 postData: {
            df: function() { return $('#from_date').val()},
            dt: function() { return $('#to_date').val()}
        },
        mtype: 'POST', 
```

并且它不断发送 POST 作为未定义的值。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T15:40:08.130

通过在 ajax 调用上应用 .done() 并在 done 中包含网格创建来解决问题。不管怎么说，还是要谢谢你！

# api - Beanstream Recurring Billing API 请求 - 如何

> ID：14429891
> 
> 赞同：0
> 
> 时间：2013-01-20T22:07:26.473
> 
> 标签：api, recurring-billing, beanstream

Beanstream 限制了通过其 Web 应用程序查看和更新​​的内容。例如，如果您想更新其中一个自定义参考字段，则目前无法通过他们的网站进行更新。

唯一的选择是 API。由于这里没有很多与 beanstream 相关的信息，我想我会将这个解决方案传递给任何寻找的人

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:13:11.047

这是一个示例方法，其中必填字段包含在 Uri 中，然后添加了带有文本框值的可选 ref2 字段。响应以 XML 形式返回。如果以后需要，您可以对 XML 做一些事情。就我而言，我只是在标签中显示 xml 以检查它是否正常。

显然，用您自己的值替换其中带有 XXXXXX 的任何值。

```
 // formulate our request to the recurring billing api.
    string requestUri = "https://www.beanstream.com/scripts/recurring_billing.asp?merchantId=XXXXXXXXXX" +
                        "&serviceVersion=1.0" +
                        "&requestType=BACKEND" +
                        "&operationType=M" +
                        "&passCode=XXXXX - Look for this in the Order Settings page - XXXXXXXXXXXXXXX" +
                        "&rbAccountId=XXXXXX - This is the recurring account id. - XXXXXXXXX"  + 
                        "&ref2=" + Ref2TextBox.Text;

    WebRequest request = WebRequest.Create(requestUri);
    request.Method = "POST";
    request.ContentLength = 0;
    WebResponse response = request.GetResponse();
    Stream dataStream = response.GetResponseStream();
    StreamReader reader = new StreamReader(dataStream);
    string responseFromServer = reader.ReadToEnd();
    reader.Close();
    response.Close(); 
```

# ios - AmazonS3Client ios sdk 重命名存储桶中的文件

> ID：14429892
> 
> 赞同：2
> 
> 时间：2013-01-20T22:07:26.980
> 
> 标签：ios, amazon-web-services, amazon-s3

如何重命名 S3 存储桶中的现有文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T23:10:49.367

可以这么说，您不能“重命名”，因为键名的前几个字节用于在您的存储桶中进行分区，但您可以做的是复制您的对象以给您的副本提供另一个名称。这样的事情应该可以解决问题：

```
AmazonS3Client *s3 = [[[AmazonS3Client alloc] initWithAccessKey:MY_ACCESS_KEY_ID withSecretKey:MY_SECRET_KEY] autorelease];
[s3 copyObject:[[[S3CopyObjectRequest alloc] initWithSourceKey:MY_SOURCE_KEY sourceBucket:MY_BUCKET destinationKey:MY_DEST_KEY destinationBucket:MY_BUCKET] autorelease]]; 
```

# silverlight - 是否可以在 Silverlight OOB 安装之前收取费用

> ID：14429894
> 
> 赞同：0
> 
> 时间：2013-01-20T22:07:38.377
> 
> 标签：silverlight, silverlight-5.0

我在 Silverlight 5 中编写了一个应用程序，我想在其中附加到一个网站，用户可以在该网站上选择将应用程序的 OOB 版本安装到他们的机器上。应用程序的想法是三年来的，所以我想在安装应用程序之前向用户收取费用。为了编写 Silverlight 应用程序，我必须从一本书和在线教程（Silverlight 5 VB）中学习编程。如果有人可以就此事给我一些指示，我将不胜感激。

亲切的问候威尔。

# axis2 - 将对象发送到轴 2 Web 服务

> ID：14429895
> 
> 赞同：1
> 
> 时间：2013-01-20T22:07:39.407
> 
> 标签：axis2, axis

我正在尝试使用 Axis 2 创建一个 Java Web 服务，它获取一个自定义 MyClass 对象作为参数。例如：

```
public MyService{
    public String serviceMethod(MyClass myObject){
        return myObject.getUsername();
    }
} 
```

是否可以将 MyClass 对象发送到服务并获得响应？谢谢你。

# java - SQLexception 注册表单 servlet

> ID：14429897
> 
> 赞同：1
> 
> 时间：2013-01-20T22:07:52.333
> 
> 标签：java, sqlite, servlets, sqlexception

我正在创建一个注册表单，但在插入数据库时​​出现错误。我创建了以下代码：

```
 try {
                Class.forName("org.sqlite.JDBC");
                connection = DriverManager.getConnection("jdbc:sqlite:C:/apache-tomcat-7.0.33/bin/dbit.db");
                insertDB = "INSERT INTO users VALUES('" + username + "', '" + password + "');";

                Statement st = connection.createStatement();
                st.executeUpdate(insertDB);             
            } catch(ClassNotFoundException e){
                System.out.println("ClassNotFoundException");

            } catch (SQLException e){
                System.out.println("SQLException");
                e.printStackTrace();
            } 
```

我在 Apache 文件夹的 bin 文件夹中有一个名为 dbit 的数据库文件。这个数据库文件是用 Sqliteman-1.2.2 创建的，我有两个文件（dbit 文件 3kb 和 dbit.db 0kb）。

我想在数据库中插入用户名和密码，但我得到一个 SQLException。在堆栈跟踪中：SQLExcepton：没有这样的表：用户。但是该表确实存在于数据库中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T10:35:43.177

我找到了解决方案..

SQLiteman-1.2.2 创建两个数据库文件，一个 database.db 和一个 database（无扩展名）。我使用了 .db 文件，但是没有用，然后更改了行：

```
connection = DriverManager.getConnection("jdbc:sqlite:C:/apache-tomcat-7.0.33/bin/dbit.db"); 
```

到：

```
connection = DriverManager.getConnection("jdbc:sqlite:C:/apache-tomcat-7.0.33/bin/dbit"); 
```

解决了我的问题。

# facebook - 科尔多瓦 2.3 中的 FacebookAppID 问题

> ID：14429898
> 
> 赞同：0
> 
> 时间：2013-01-20T22:07:53.383
> 
> 标签：facebook, cordova

我刚刚在 Cordova 2.3 上实现了 Facebook SDK，但您知道 Cordova 2.3 中最重要的变化是他们将 info.plist 更改为 config.xml。在我以前的版本中，我已经在我的 .plist 文件中实现了我的 FacebookAppID，但现在我使用“bin/cordova_plist_to_config_xml”脚本生成了一个新的 config.xml，并且我在 config.xml 中将我的 appid 作为首选项 name="FacebookAppID" xcode向我返回该错误：

" ***由于未捕获的异常 'com.facebook.sdk:InvalidOperationException' 导致应用程序终止，原因：'FBSession: 未提供 AppID；要么将 AppID 传递给 init，要么将具有名为 FacebookAppID 的适当 ID 的字符串值键添加到包 * .plist'"

那么有没有人知道解决这个问题？

谢谢， 布拉克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T23:47:38.003

`config.xml`唯一替换，而`Cordova.plist`不是`<AppName>-Info.plist`您放置 FacebookID 的位置。

`<AppName>-Info.plist`仍然存在并正在使用中。

# java - 在 Android 蓝牙聊天中转换字符串

> ID：14429901
> 
> 赞同：-2
> 
> 时间：2013-01-20T22:08:00.057
> 
> 标签：java, android

我正在尝试从 TTL 输出设备获取串行数据，将其通过 JY-MCU 加密狗并在我的 Android 手机上读取。数据以 4 位 ASCII 十进制数字形式发送，后跟回车和换行。

使用 BluetoothChat，我可以在手机上正确看到传输的号码，但我想在应用程序中操纵号码，然后将操纵结果发送到屏幕。

我只需要读取数据，而不是发送它。

查看中的代码，`BluetoothChat.java`我想我需要将 MESSAGE_READ 中创建的字符串转换为一个`Integer`值，操作此整数，将其转换回字符串并将此结果发送到显示器。这是解决这个问题的正确方法吗？我曾尝试使用`Integer.parseInt()`and `String.valueOf`() 但没有成功。

我可以发布一段简单的代码，显示我正在尝试做的事情，但我认为我可能会犯一个简单的错误，有人可以先指出。

感谢大卫的任何建议

```
 byte[] readBuf = (byte[]) msg.obj;
 // construct a string from the valid bytes in the buffer
 String readMessage = new String(readBuf,0, msg.arg1);
 //remove any leading zero's
 String readMessages = readMessage.replaceAll("^0*", "");
 //remove any leading zero's
 // Declare Integer
 int newMessage;
 // give the integer a value
 newMessage = Integer.valueOf(readMessages);
 // try some simple division
 newMessage = newMessage / 100;
 // back to a string
 String finalMessage = Integer.toString(newMessage);
 // display the result
 mConversationArrayAdapter.add(mConnectedDeviceName+":  " + finalMessage); 
```

堆栈跟踪

01-25 18:09:12.905: E/AndroidRuntime(5413): 致命异常: main 01-25 18:09:12.905: E/AndroidRuntime(5413): java.lang.NumberFormatException: Invalid int: "" 01-25 18:09:12.905: E/AndroidRuntime(5413): 在 java.lang.Integer.invalidInt(Integer.java:138) 01-25 18:09:12.905: E/AndroidRuntime(5413): 在 java.lang.Integer .parseInt(Integer.java:359) 01-25 18:09:12.905: E/AndroidRuntime(5413): 在 java.lang.Integer.parseInt(Integer.java:332)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T23:14:00.010

您使用的正则表达式不正确，因为当输入“00”或“0”之类的内容时，它会返回“”（空字符串），您可能会想知道。我建议你在下面的代码中使用正则表达式。

为了您的方便，我给您一个简单的测试程序来检查正则表达式是否满足您的需求。如果您有疑问，请随意添加更多测试。

```
package stackoverflow.answers;

public class ParsingTest {

    public static void main(String[] args) {

        System.out.println("Result is " + extractInteger("010"));
        System.out.println("Result is " + extractInteger("1010"));
        System.out.println("Result is " + extractInteger("0001"));
        System.out.println("Result is " + extractInteger("0000"));
        System.out.println("Result is " + extractInteger("11A0"));

    }

    private static Integer extractInteger(String s) {
        Integer i = null;
        String t = s.replaceFirst("^0+(?!$)", "");
        try {
            i = Integer.valueOf(t);
        } catch (Exception e) {
            e.printStackTrace();
            // to be sure you return always something
            // null could be other value returned
            // in that case use a finally
            return 0;
        }
        return i;
    }

} 
```

请注意，当解析有问题时，我更喜欢返回 0，您可以决定返回 null 或不同的整数（-1？）。

# matlab - abs(sin(pi)) 用于减轻系统舍入误差

> ID：14429902
> 
> 赞同：0
> 
> 时间：2013-01-20T22:08:12.857
> 
> 标签：matlab, rounding

我输入`abs(sin(pi))`了MATLAB。我希望它能给我 pi 的绝对值，希望通过“abs”（绝对值）来减轻自然舍入误差。我仍然得到一个舍入错误。我应该怎么做，为什么我错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:34:17.697

浮点数总是会给你这样的问题。这就是为什么通常写成：

```
if (x - TestValue < 0.000001) 
```

代替

```
if (x == TestValue) 
```

我建议尝试使用以下方法将值四舍五入到小数位或两位小数：

```
x = floor(x * 1e15) / 1e15; 
```

将 x 向下舍入到最接近的 1e15。您也可以使用`round`或`ceil`。[本文](http://www.mathworks.com.au/matlabcentral/answers/16882)提供了有关舍入的类似策略的更多信息。

# mongodb - 如何摆脱 Doctrine MongoDB ODM 生成的过多更新查询？

> ID：14429903
> 
> 赞同：0
> 
> 时间：2013-01-20T22:08:35.100
> 
> 标签：mongodb, symfony, doctrine

我有以下文件： 使用 EmbedMany 订购 Orderlines 使用 EmbedOne 产品订购

我有一个现有的订单，我想在其中添加一个新的订单行，但是当我获取一个现有的订单并向其中添加新的订单行时，我添加了两个新的订单行。

来自我的控制器的代码：

```
$dm = $this->get('doctrine_mongodb')->getManager();

// Get the session id for current user
$sessionId = $this->get('session')->getId();

// Fetch an existing order
$order = $dm->getRepository('AcmeDemoBundle:Order')
    ->findOneBy(array('session_id' => $sessionId));

// Create a new product
$product = new Product();
$product->setTitle('Product title');

// Create an orderline
$orderline = new Orderline();
$orderline->setProduct($product);
$orderline->setQuantity(1);

// Add newly created orderline to the order
$order->addOrderlines($orderline);

$dm->persist($orderline);
$dm->flush(); 
```

Doctrine 生成的 MongoDB 查询：

```
use test_database;
db.Order.find({ "session_id": "ransbtpa63cdbp5vp7fqs2pma5" });
db.Product.insert({ "00000000723450f000000000b20415bf": { "_id":      ObjectId("50fc67348e97f4d119000002"), "title": "Product title" } });
db.Orderline.insert({ "000000007234500d00000000b20415bf": { "_id": ObjectId("50fc67348e97f4d119000003"), "product": { "_id": ObjectId("50fc67348e97f4d119000002"), "title": "Product title" }, "quantity": 1 } });
db.Order.update({ "_id": ObjectId("50fc62a18e97f44f1d000002") }, { "$set": { "orderlines.5.product.title": "Product title", "orderlines.5.quantity": 1 } });
db.Order.update({ "_id": ObjectId("50fc62a18e97f44f1d000002") }, { "$pushAll": { "orderlines": [ { "_id": ObjectId("50fc67348e97f4d119000003"), "product": { "_id": ObjectId("50fc67348e97f4d119000002"), "title": "Product title" }, "quantity": 1 } ] } }); 
```

并从 MongoDB 订购文档（查询添加的订单行 1 和 2）：

```
[_id] => MongoId Object (
    [$id] => 50fc62a18e97f44f1d000002
)
[orderlines] => Array (
    [0] => Array (
        [_id] => MongoId Object (
            [$id] => 50fc62a18e97f44f1d000001
        )
        [product] => Array (
            [_id] => MongoId Object (
                [$id] => 50fc62a18e97f44f1d000000
            )
            [title] => Product title
        )
        [quantity] => 1
    )
    [1] => Array (
        [product] => Array (
            [title] => Product title
        )
        [quantity] => 1
    )
    [2] => Array (
        [_id] => MongoId Object (
            [$id] => 50fc62d08e97f4f41d000002
        )
        [product] => Array (
            [_id] => MongoId Object (
                [$id] => 50fc62d08e97f4f41d000001
            )
            [title] => Product title
        )
        [quantity] => 1
    )
)
[session_id] => ransbtpa63cdbp5vp7fqs2pma5 
```

我认为问题是由第一个带有 $set 的 db.Order.insert 查询引起的，然后是 $pushAll。我怎样才能摆脱过多的查询，为什么 Doctrine 会生成它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T11:22:50.363

问题解决了。我在 Orderline 文档中缺少 EmbeddedDocument 注释，并添加了该注释来解决问题。

```
/**
* @MongoDB\EmbeddedDocument
*/
class Orderline
{
... 
```

# backbone.js - 延迟渲染索引直到初始化完成

> ID：14429904
> 
> 赞同：3
> 
> 时间：2013-01-20T22:08:45.627
> 
> 标签：backbone.js

我想知道为什么尝试呈现索引函数会给我一个`cannot call method render of null`错误。有没有办法让索引函数等待渲染，直到路由器的初始化完成。console.logs 似乎表明索引函数正在尝试在初始化中的 ajax 调用完成之前呈现

```
1.Uncaught TypeError: Cannot call method 'render' of null gallery.js:231
2\. XHR finished loading: "http://localhost:3000/readjsonfile". jquery.js:8241
3.success 
```

这是代码。我有路线

```
var Gallery = Backbone.Router.extend({

routes: {
        "": "index",

    }, 
```

它最初设置为 null

```
 _index: null, 
```

Gallery 路由器的初始化检查索引是否为空，如果是，则使用数据创建一个新视图。

```
initialize: function(options) {

        var ws = this;

        if (this._index === null){
            $.ajax({

                url: 'galleries',
                dataType: 'json',
                data: {},
                success: function(data) {
                    console.log("success");
                    console.log(data);
                    ws._data = data;
                    ws._photos = new PhotoCollection(data);
                    ws._index = new IndexView({model: ws._photos});
                    console.log(ws._index);

                    Backbone.history.loadUrl();

                }, 
                error: function(r){
                    console.log("error");
                    console.log(r);
                }
            });
            return this;
        }
        return this;
    }, 
```

这是在初始化之后立即放置的索引函数，它呈现在上面的初始化中创建的视图，但是，我得到了一个`Cannot call method 'render' of null`错误

```
index: function() {

        this._index.render();
    }, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T08:42:32.263

`Backbone.history.start`触发与当前 URL 匹配的路由，因此您需要延迟调用它，直到您的路由器准备好。

因此，不要调用成功回调`loadUrl`，而是`$.ajax`等到您的依赖项加载完毕并调用 history.start ：

```
success: function(data) {
    //...
    Backbone.history.start();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T10:03:11.390

XHR 请求默认是异步的，这意味着您的`$.ajax`调用不会阻塞，并且您的初始路由将立即匹配，`_index`此时尚未定义并且您会收到错误消息。

如果您的代码如下所示，

```
var r = new Gallery();
Backbone.history.start(); 
```

发生的事情是

1.  `router.initialize`叫做
2.  发出 XHR 请求
3.  `router.initialize`结束
4.  `Backbone.history.start`触发*索引*路由
5.  `router.index`叫做
6.  XHR 请求结束

检查此小提琴以重现您的问题[http://jsfiddle.net/nikoshr/krFtA/](http://jsfiddle.net/nikoshr/krFtA/)

你可以做的一些事情：

*   如果可能的话，[在您的页面加载中引导模型](http://backbonejs.org/#FAQ-bootstrap)，这将为您节省一个请求和一些麻烦，

*   强制同步请求`async: false`将阻塞，直到您的数据可用（基本上，我认为您的想法）：

    ```
    $.ajax({
        async: false,
        url: 'galleries',
        dataType: 'json',
        data: {},
        success: function(data) {
            ...
        }, 
        error: function(r){
            ...
        }
    }) 
    ```

    [http://jsfiddle.net/nikoshr/m3dW5/](http://jsfiddle.net/nikoshr/m3dW5/)

*   正如@fencliff 所说，延迟`Backbone.history.start`到你准备好。

*   或者使用 jQuery >= 1.5，您可以使用[延迟对象](http://api.jquery.com/category/deferred-object/)来同步您的请求和渲染

    ```
    var PhotoCollection = Backbone.Collection.extend({
        url: 'galleries',

        initialize: function() {
            this.loaded = $.Deferred();
        },

        fetch: function(opts) {
            var ld = this.loaded,
                xhr = Backbone.Collection.prototype.fetch.call(this, opts);
            xhr.always(ld.resolve);
        }
    });

    var IndexView = Backbone.View.extend({
        el: '#v',
        initialize: function() {
            _.bindAll(this);
        },
        render: function() {
            this.$el.html('rendered');
            console.log('render');
        }
    });

    var Gallery = Backbone.Router.extend({
        routes: {
            "": "index"
        },

        _index: null,

        initialize: function(options) {
            this._photos = new PhotoCollection();
            this._photos.fetch();
            this._index = new IndexView({model: this._photos});
            console.log(this._index);
        },

        index: function() {
            var view = this._index;
            view.model.loaded.always(view.render);
        }
    }); 
    ```

    [http://jsfiddle.net/nikoshr/m3dW5/1/](http://jsfiddle.net/nikoshr/m3dW5/1/)

# java - 在java中鼠标事件后不执行Prepare语句

> ID：14429906
> 
> 赞同：-1
> 
> 时间：2013-01-20T22:09:42.853
> 
> 标签：java, mysql, mouseevent, prepared-statement

执行以下代码，直到 String check = "select * from borrow where librarycardnumber = ?"; 在单击鼠标后的 try{} catch{} 块中，然后在控制台中停止而没有任何错误。可能是什么问题？是错误的准备语句还是其他？谢谢你。

```
import javax.swing.*;
import java.awt.FlowLayout;
import javax.swing.JLabel;
import java.awt.event.MouseAdapter;
import javax.swing.JTextField;
import java.awt.event.MouseEvent;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class libaryCard extends JFrame{

    public JLabel lclabel;
    public JTextField lcfield;
    public JButton lcbutton;

    public libaryCard(){
        super("Library Card Check");

        setLayout(new FlowLayout());
        setSize(300, 130);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        lclabel = new JLabel("Enter your Library Card Number:");
        add(lclabel);

        lcfield = new JTextField(20);
        add(lcfield);

        lcbutton = new JButton("Check");
        add(lcbutton);
        lcbutton.addMouseListener(new MouseAdapter() {

            @Override

            public void mouseClicked(MouseEvent e) {
                System.out.println("mouse clicked");
                try{

                    Class.forName("com.mysql.jdbc.Driver").newInstance();
                    java.sql.Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/"+libaryCheck.DBname+"", "root", libaryCheck.DBpass);
                    System.out.println("Connected ");
                    String LB = lcfield.getText();
                    PreparedStatement stmt= null;
                    ResultSet libCheck = null;
                    String check = "select * from borrow where librarycardnumber = ?";

                    System.out.print("String executed");

                    stmt=conn.prepareStatement(check);
                    stmt.setString(1, LB);
                    libCheck = stmt.executeQuery(check);

                    System.out.println("Query executed");

                    if(libCheck.next()) {
                        String number = libCheck.getString("libraryCardNumber");

                        ISBNcheck isbn= new ISBNcheck();
                        isbn.setVisible(true);

                        System.out.println("mouse action complete");
                    }
                    else {

                        JOptionPane.showInputDialog("Card Number not found!");
                    }

                } catch (Exception ed){

                }

            }
        });

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:13:36.730

代码的最大问题是您正在捕获异常并且在 catch 块中什么都不做。你至少必须做一个`e.printStackTrace()`可以帮助你弄清楚发生了什么的事情。

# python - getMouse 可以作用于 Python 中的一个特定对象吗？

> ID：14429909
> 
> 赞同：0
> 
> 时间：2013-01-20T22:10:02.760
> 
> 标签：python, python-3.3, zelle-graphics

我正在尝试使用 Zellegraphics 模块在 Python 中制作井字游戏。我想使用`getMouse`鼠标输入，但我无法弄清楚如何`getMouse`在电路板的一个单元上工作。我定义了 9 个不同的方格，我想做的是如果用户点击某个方格，我想在那里画 X 或 O。我不知道该怎么做，因为据我所知，`getMouse`它只作用于整个窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T00:19:07.880

如果您在窗口中有一些 X 和 Y 坐标（我们称它们为`window_x`和`window_y`）并且您想要获取网格上的坐标（我们称它们`grid_x`为 和`grid_y`），并且每个网格单元格的宽度和高度为`grid_size`，它计算起来相对容易，`grid_x`并且`grid_y`：只需将整数除以（向下舍入；在 Python 中，这将是`//`运算符）`window_x`除以`grid_size`得到`grid_x`。你大概能猜出来`grid_y`。

![一个 3x3 的网格在第一行用 (0, 0)、(1, 0)、(2, 0) 标记，在第二行用 (0, 1)、(1, 1) 和 (2, 1) 标记， 等等。 单元格的宽度标记为 grid_size。 一个特定的点被标记为一个红点。 该点的 X 和 Y 位置从网格的左上角标记。](../Images/f8d3ae342e77fd84bc99d5d92ebe2bfc.png)

# ruby-on-rails - rails Layouts, Rendering, Partials, Templates, and Views的另一种解释

> ID：14429910
> 
> 赞同：3
> 
> 时间：2013-01-20T22:10:03.907
> 
> 标签：ruby-on-rails, ruby-on-rails-3

编程新手，但我已经完成了一些巧妙的工作。但鉴于我的非传统方法，我有时会对涉及大量假设的“传统”教义感到沮丧和困惑。

所以我一直在学习rails，并且喜欢它的结构，但是一些[术语让我感到困惑](https://stackoverflow.com/questions/14373057/what-is-the-difference-between-render-and-yield-in-rails)，我[试图理解它](https://stackoverflow.com/questions/14412586/switch-partial-views-in-rails-based-on-which-button-is-clicked)，但无法理解它。很多人一直向我[推荐 RailsGuides on Layouts and rendering](http://guides.rubyonrails.org/layouts_and_rendering.html)，但我并不完全理解它，并认为它缺乏整体 Rails 结构的更广泛背景。

那么，您是否知道任何描述整个过程和术语的 Rails 解释站点/文档/视频/书籍，更具体地说，是那些说明布局、渲染、局部和视图如何工作的，相对于 Rails 处理？

规格：

当试图理解它们之间的关系时，术语会变得混乱。以[PJAX RailsCast 为例](http://railscasts.com/episodes/294-playing-with-pjax)，Bates 明确表明它们是布局和模板之间的差异。当我试图通过[这个 SO question来实现](https://stackoverflow.com/questions/14412586/switch-partial-views-in-rails-based-on-which-button-is-clicked)[这](http://fiddle.jshell.net/chrisfrisina/AzYLX/)一点时，我迷失在文件及其功能的常规结构和命名中（不是每个人，只是那些似乎在命名中超载的那些）。

以. `applicaiton.html.erb`_ `views/layouts`它的文件路径位置告诉我它是一个“布局”，但是那些也位于其中的`_navigation.html.erb`and`_left.html.erb`和etc....因为所有页面都共享这些，它们与它们处于同一级别 但这些具有前面的 _underscores在文件名中，所以 Rails 知道这些是“部分”，但它们也位于文件夹中，并且在文件夹中。那么它的名字是什么？ `_right.html.erb``views/layouts``application.html.erb``views``layout`

上面的问题导致我不明白某人在说什么，因为我也可能没有相应地构建文件。范围问题（据我所知，当您调用`render 'action'`或`render 'file'`等等时，rails 可以找到另一个控制器视图和操作）在使用`render`vs `content_for`/时发挥作用`yield`。看看我的[SO 问题](https://stackoverflow.com/questions/14373057/what-is-the-difference-between-render-and-yield-in-rails)，在 Geoff 的回答中，在他的评论中，当我问到“所以不可能使用其他观点的产量？”时，他的回答是“这当然不是意图”。

所以回到最初的问题，我不觉得这些是相互关联的。我对制作一个健壮的应用程序很感兴趣，并且我了解如何使用其他较小的框架来完成它，但我需要在更高的层次上了解 rails 如何使用布局、部分、模板和视图，以及应如何相应地构建文件。

我还想要描述它们的术语的图表或解释，以及它们与其他（用法、另一个的父/子）和常规放置的关系。这看起来像：

```
A view is what is presented to the user.   It is comprised of several parts.
  The following are required [ templates, layouts ].  
  These are not required, but very likely once you have a robust and
   flexible program [ partials, yields/content_for ].   

A layout is a framework ....

A Partial is content, but only "partial" of a page....

A rendered file is ... and is located in each model's view 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T20:22:22.077

好的...这是我对事物的看法（呵呵）...请注意，有时当我说“X 是 Y”时，我真正的意思是“与 Rails 喜欢做的事情保持一致 X 是 Y “.. 你可以违反这一点，但大多数人不会……此外，这些都没有触及在你的控制器中调用'render' 的工作方式。那是另一个蜡球。

*   app/views 中的所有内容都是“视图”。“视图”是最终将被编译/渲染并显示给客户端（浏览器、第 3 方 api 等）的东西。

*   任何以下划线开头的文件都是部分文件。它在应用程序/视图中的位置无关紧要......它是部分的。

*   任何 [其他] 文件都是诚实至善的观点。它可能是 HTML、XML、JSON、PDF……但它是一个视图。

*   app/views/layouts 中任何不以下划线开头的文件也是一个视图，但它是一个特殊的视图。这是一个布局。恕我直言，布局只是您要应用于所有视图的通用标记的“包装器”。*如果*您在“我为我的网站在线购买了一些高级 Web 模板”的意义上使用它们，您可以将它们视为“模板”。然而，“模板”在 Rails 中也有另一个含义。所以...尽量不要将这些布局文件视为模板。将它们视为“布局”。

*   这些布局文件的独特之处在于它们在某处包含对`<%= yield %>`. 就像在 Ruby 中一样，它产生了对其他事物的控制并被结果所取代。在 Rails 中，这意味着无论调用什么控制器/动作，该行都将被您的实际视图的结果替换（稍后会详细介绍）。

*   在你的布局目录中有部分是完全可以的。我一直都这样做。我这样做有两个原因。第一个是如果我想简单地使用我的 application.html.erb。一个很好的例子，我通常有一个 app/layouts/_google_analytics.html.erb 文件，其中包含用于设置 Google Analytics 的 JS/逻辑。有了这个，我可以调用`render :partial => 'layouts/google_analytics'`application.html.erb 并且很清楚发生了什么，但不那么混乱。这样做的另一个原因是如果我有多个布局。也许我有一个 mobile.html.erb ——但我仍然需要 Google Analytics。现在我可以轻松地将“通用布局代码”包含在每个中。它是干的。

*   至于其他文件的去向……把它们放在有意义的地方……这通常是相当明显的，当你构建更多的应用程序时你会感觉到它。您可以采用一些命名约定来使用更多的 Rails 魔法，但您不必这样做。例如..您可以进行类似的调用`render @widgets`，它会查找一个`_widget.html.erb`部分并为@widgets 中的每个元素渲染一次。不过，您不必这样做。

*   共享部分？他们可以去任何地方。真的取决于你喜欢如何组织事物。很多人会创建应用程序/视图/共享并将它们放在那里。有些人会让他们保持“主要”关注点。也就是说...假设您有一个 _recent_blog_posts 部分被全部使用。你可以把它放在 app/views/shared/_recent_blog_posts.html.erb 中。您也可以争辩说它应该放在 app/views/blog/_recent_posts.html.erb 中（注意文件名的细微变化）。哪个是对的？很难说。

*   产量和 content_for。默认情况下，Rails 在将视图标记插入布局时默认执行此操作。您可以假设 Rails`content_for :default`在处理您的视图时会自动执行（或类似的操作），这就是`yield`在您的布局中选择它的方式。但你也可以明确地做到这一点。假设您有一个网站部分（例如在右侧），您可能希望根据用户在您网站上的位置对其进行调整。在您的布局文件中，您可以执行以下操作：

    ...一些通用的右手边的东西...

然后，在您的视图文件中，您可以执行以下操作：

```
... my main view content...
<% content_for :right_side do %>
  ... specific right side content stuff...
<% end %> 
```

当这一切结合在一起时，Rails 会将特定的右侧内容放入布局的右侧。

无论如何...希望有帮助。

# java - 将数据从 wordpress 帖子中提取到 Android 的最佳选择是什么？

> ID：14429913
> 
> 赞同：1
> 
> 时间：2013-01-20T22:10:48.447
> 
> 标签：java, android, json, wordpress, rss

我需要从 wordpress 网站（帖子）获取数据并将其本地放入 android 应用程序。我尝试了一些方法，但我迷失了自己的头脑。我可以访问管理面板，因此我可以在需要时添加插件。

可能的方式（在我看来）：

RSS 解析器（android 的最佳选择？）wordpress 的 JSON api（我可以将它用于 android 吗？）???

我尝试使用 XMLPullParser，我可以将帖子放入 ListView，但我找不到解析文章文本的方法（XML 包含所有文章的全文）。

有任何想法吗？如有必要，我可以发布我当前的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:21:32.250

我用 Wordpress Json Api[链接做了类似的事情](http://wordpress.org/extend/plugins/json-api/)

只需发出请求，然后使用 Java 解析 JSON 格式的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:36:12.827

> 我找不到解析文章文本的方法（XML 包含所有文章的全文）。

将该 html 文本保存为字符串，然后将其提供给 WebView 以显示它。

> 可能的方法（在我看来）：RSS 解析器（android 的最佳选择？） wordpress 的 JSON api（我可以将它用于 android 吗？）???

两者都是有效的。JSON api 会给你更多的控制，但是因为 WordPress 生成的 RSS 是相当静态的（你可以要求一个类别的 RSS，存档，......但是 JSON API 将允许你获取任何由 WP 暴露的对象的数据JSON API 插件）

# c# - 是否使用 List 复制对象 .添加，还是简单地“映射”？

> ID：14429914
> 
> 赞同：3
> 
> 时间：2013-01-20T22:10:48.883
> 
> 标签：c#, collections

`Lists`在 C# 中使用时，我遇到了一些令人困惑的行为。如果我将一个给定类型的集合（我已经用`List<T>`和测试过`Array`）添加到一个`List`（即`List<List<int>>`），修改子也将修改它被添加到`List`的父的内容。`List`但是，如果我将一个不是集合的对象（即 a`bool`或 an `int`）添加到 a `List`，则修改对象本身不会修改`List`它添加到的内容。我在下面包含了一些示例代码：

```
List<List<int>> intList = new List<List<int>>();
List<int> ints = new List<int>();

ints.Add(12345);
intList.Add(ints);
Console.WriteLine(intList[0].Count); //intList[0].Count is 1

ints.Clear();
Console.WriteLine(intList[0].Count); //intList[0].Count is 0 
```

似乎在上面的例子中，`ints`集合只是简单地“映射”到`intList[0]`，所以当你修改`ints`集合本身时，你也在修改`intList[0]`，因为它们是同一个对象。这与下一个示例形成对比：

```
List<bool> boolList = new List<bool>();
bool bigBool = false;

boolList.Add(bigBool);
Console.WriteLine(boolList[0]); //boolList[0] is false

bigBool = true;
Console.WriteLine(boolList[0]); //boolList[0] is...still false?? 
```

在上面的示例中，似乎不是被映射到`boolList[0]`，而是被`bigBool`复制到`boolList[0]`。`boolList[0]`的副本也是如此`bigBool`，它们是两个独立的对象。

所以我的问题是：为什么似乎有两个独立的功能`List<T>.Add`，这取决于添加到的类型是什么`List`？我检查了 MSDN，但我找不到任何关于这种行为的提及。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-20T22:13:29.317

这取决于对象的种类。

值类型将被复制。对于引用类型，将使用引用。

整数、布尔值`DateTime`是值类型，例如（结构是值类型）和`string`，`List<T>`是引用类型（类是引用类型）。

有关详细信息，请参阅MSDN 上的[值类型和引用类型](http://msdn.microsoft.com/en-us/library/t63sy5hs.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T22:15:06.613

把它想象成平等，就像：

```
var added = myObject; 
```

如果对象是值类型（比如数字等），或者是不可变的，比如`string`，那么它会被复制。如果它是一个非不可变的引用类型，就像几乎所有的类实例一样，那么它只会获得对同一个对象实例的另一个引用。

有关详细的 MSDN 参考，请参见下文：

*   [传递参数（C# 编程指南）](http://msdn.microsoft.com/en-us/library/0f66670z.aspx)

# android - Admob 广告需要太多空间

> ID：14429916
> 
> 赞同：1
> 
> 时间：2013-01-20T22:11:39.427
> 
> 标签：android, admob

我试图将 admob 添加到我的应用程序中，但我认为它太大了。在文档中，最小尺寸为 320x50。同时在我的应用程序中它需要 426（这很奇怪，因为文档没有提到这种分辨率）：

```
Not enough space to show ad! Wants: <426, 66>, Has: <324, 628> 
```

有没有办法强制最小的？我试过 ads:adSize="BANNER" 和 ads:adSize="SMART_BANNER" 都太大了。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T23:36:14.843

您必须记住`BANNER`大小是 320x50dip，而不是像素。因此，在更高密度的设备上，它需要更多的像素。确保它具有正确大小的最简单方法是`AdView`在`320x50dp`创建它时调整横幅大小。

# c++ - 在 C++ 字符串文字中使用的可接受的自定义转义字符是什么

> ID：14429917
> 
> 赞同：0
> 
> 时间：2013-01-20T22:11:50.153
> 
> 标签：c++, escaping

我想以与“\n”和“\a”相同的样式在字符串文字中嵌入某些信号。我的程序查看字符串，查看转义字符，然后根据它后面的字符执行操作。

然而问题在于，作为其编译过程的一部分，C++ 使用“\”作为转义字符来解决任何问题。此外，我经常使用的 C 标准库也使用“%”作为转义字符。

所以不能同时使用“\”和“%”。正斜杠“/”看起来与“\”太相似了，目前，大多数其他字符要么太常用，要么看起来不像转义符。

我的问题是，用作转义字符的最佳字符是什么，它不会与依赖于它们自己的转义字符的常见 C++ 字符串实用程序发生冲突。从这个意义上说，“最佳”将客观地描述一个在正常对话和数学中不常使用的角色，并且一眼就可以识别为逃生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T22:17:38.827

没有理由你不能逃避你的反斜杠（例如`\\n`）。如果你觉得打字很难看，试试 C++11 中的原始字符串文字：

```
R"(hello\nfriend\a\b\c\d)" 
```

请注意，括号不是字符串的一部分。如果您的字符串将包含`)"`您可以将自己的分隔符放在左括号之前，它必须跟在右括号之后：

```
R"delim(hello\nfriend\a\b)"something)delim" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T22:20:20.510

我最喜欢的替代转义字符是```（反引号）。为什么？因为它在普通文本中不经常出现，所以 C 和 C++ 根本不使用它，它看起来像一个很小的反斜杠。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T22:14:39.603

我想你通常可以使用'\'，只要你将它作为两个字符保存到字符串中，例如'\'和'n'而不是'\n'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T22:18:23.083

bash 用于`$`将变量插入字符串：

```
"Hello $name! How are you?" 
```

Windows cmd 使用 % 相同：

```
"Hello %name%! How are you? 
```

C#`{}`用于字符串格式化：

```
String.Format("Hello {0}! How are you?", name) 
```

这些中的任何一个都很容易识别。

# java - 如果语句不适用于字符串

> ID：14429921
> 
> 赞同：0
> 
> 时间：2013-01-20T22:12:21.647
> 
> 标签：java, string, if-statement

```
import java.net.*;
import java.io.*;
import java.util.*;
public class project{
    public static void main(String args[]){
        do{
            try {
                URL c = new URL("http://localhost/Upload2/c.txt");
                URL cinfo = new URL("http://localhost/Upload2/cinfo.txt");
                Scanner c2 = new Scanner(c.openStream());
                Scanner cinfo2 = new Scanner(cinfo.openStream());
                String c3 = c2.nextLine();
                String cinfo3 = cinfo2.nextLine();
                if ("commandline".compareTo(c3) == 0){
                    Runtime.getRuntime().exec(cinfo3);
                    if ("idle".compareTo(c3) == 0){
                        System.out.println("Waiting for a command.");
                    }
                    if ("print".compareTo(c3) == 0){
                        System.out.println(cinfo3);
                    }
                }
            }
            catch(IOException ex) {
                ex.printStackTrace();
            }
        } while(true);
    }
} 
```

这是我当前的代码。但是，if 语句都不起作用！例如，即使文本文件显示“空闲”，也没有发生任何事情！我什至尝试打印文本文件的值并且它有效（它说空闲）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-20T22:15:45.777

第一个`if`:`if ("commandline"...)`将以下两个封装在里面。这意味着如果第一个`if`计算结果为`false`，则后面的将永远不会执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-20T22:16:51.613

这是因为第二个和第三个`if`语句嵌套在第一个语句下。这是相关部分，带有固定缩进：

```
if ("commandline".compareTo(c3) == 0){
  Runtime.getRuntime().exec(cinfo3);
  // here, we're still inside first if!
  if ("idle".compareTo(c3) == 0){
     System.out.println("Waiting for a command.");
  }
  if ("print".compareTo(c3) == 0){
     System.out.println(cinfo3);
  }
} 
```

因此，如果`c3 != "commandline"`，则不执行整个部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T22:34:44.570

为什么要使用 compareTo 来比较字符串？字符串类有一个类似的方法——equals() 或 equalsIgnoreCase()

您应该在 do-while 循环之外创建 URL 对象。每次程序循环时，它都会重新创建 c 和 cinfo 对象，这意味着它只查看每个文件的第一行。

此外，正如其他人所说，后两个 if 语句永远不会被执行，因为它们被封装在第一个 if 语句中。

# php - 使用 glob 的 php 回显文件夹名称

> ID：14429922
> 
> 赞同：3
> 
> 时间：2013-01-20T22:12:23.243
> 
> 标签：php, arrays, echo, shuffle, glob

下面**使用的代码**将从 GLOB_BRACE 中列出的 3 个文件夹中的任何一个中获取 10 个随机文件。

**例如：**

```
$files = (glob('../{folder1,folder2,folder3}/*.php', GLOB_BRACE)); 
```

我想在 $thelist 下面看到的 url 中回显文件夹名称

```
$thelist .= '<p><a href="../'.$folder 1 or 2 or 3.'/'.$file.'">'.$title.'</a></p>'; 
```

因此，当它显示在我的页面上时，它会显示。

```
<p><a href="../folder1/page-name.php">what ever</a></p>
<p><a href="../folder3/page-name.php">what ever</a></p>
<p><a href="../folder1/page-name.php">what ever</a></p>
<p><a href="../folder2/page-name.php">what ever</a></p>
<p><a href="../folder1/page-name.php">what ever</a></p>
<p><a href="../folder3/page-name.php">what ever</a></p>
<p><a href="../folder2/page-name.php">what ever</a></p>
<p><a href="../folder3/page-name.php">what ever</a></p>
<p><a href="../folder1/page-name.php">what ever</a></p>
<p><a href="../folder2/page-name.php">what ever</a></p> 
```

**使用的代码：**

```
<?php 
$files = (glob('../{folder1,folder2,folder3}/*.php', GLOB_BRACE)); /* change php to the file you require either html php jpg png. */
shuffle($files);
$selection = array_slice($files, 0, 11);

foreach ($selection as $file) {
    $file = basename($file);
    if ($file == 'index.php') continue;

    $title = str_replace('-', ' ', pathinfo($file, PATHINFO_FILENAME));
        $randomlist .= '<p><a href="../'.$folder 1 or 2 or 3.'/'.$file.'">'.$title.'</a></p>';
    }
?>
<?=$randomlist?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:28:35.200

将`glob()`返回目录和文件名。因此，如果您不重新分配`$file`到`basename($file)`，则整个字符串将保持不变以供输出。您仍然可以将条件签`basename()`入到。`if()``continue`

```
foreach ($selection as $file) { 
  // Call basename() in the if condition, but don't reassign the variable $file
  if (basename($file) == 'index.php') continue;

  $title = str_replace('-', ' ', pathinfo($file, PATHINFO_FILENAME));
  // Using the full `$file` in the HTML output. No need for basename() or dirname().
  // Using htmlentities to encode the file path for an HTML attribute
  $randomlist .= '<p><a href="' . htmlentities($file, ENT_QUOTES) . '">'.$title.'</a></p>';
} 
```

# php - Ajillion PHP-MySQLi-Database-Class 更新命令

> ID：14429929
> 
> 赞同：2
> 
> 时间：2013-01-20T22:13:44.460
> 
> 标签：php, class, mysqli

使用 Ajillion 制作的 MySQLi 类 :: [https://github.com/ajillion/PHP-MySQLi-Database-Class](https://github.com/ajillion/PHP-MySQLi-Database-Class)

我想执行以下命令

```
$command = "UPDATE sessions SET active = 0 WHERE DATE_ADD(last, INTERVAL life MINUTE) <= now()"; 
```

而且我不确定如何在课堂上做到这一点。有没有一种方法可以使用该类来管理这样的 WHERE 语句，尤其是对于 UPDATE 命令，因为普通查询我可以使用 $mysqli->rawQuery() 命令。

在上面的命令上运行 rawQuery() 的问题是我得到了一个

> PHP 致命错误：在非对象上调用成员函数 fetch_field()

因为它试图收集 UPDATE 命令没有给出的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T14:41:53.043

这似乎解决了这个问题。

更改第 101 行

```
$this->_query = filter_var($query, FILTER_SANITIZE_STRING); 
```

至

```
$this->_query = $this->_mysqli->real_escape_string($query); 
```

然后我继续添加

```
if(gettype($meta) == "boolean") return $results; 
```

401行之后

可能有更好的方法来做到这一点，但这就是我所做的，它似乎有效。

# javascript - 谷歌地图 api v3 , getBound(); 不返回当前视口的纬度/经度边界

> ID：14429943
> 
> 赞同：1
> 
> 时间：2013-01-20T22:15:03.570
> 
> 标签：javascript, google-maps, google-maps-api-3

我需要将我的 mashup 页面的代码从 google map api v2 升级到 v3。但是 getBound() 不适用于新代码！错误在哪里？提前谢谢你。

旧代码是：

```
 <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key= (my key api)"
      type="text/javascript"></script>

    <script type="text/javascript">

    function updateStatus() {
      var div = document.getElementById('mapinfo');
      div.innerHTML = map.getBounds();

      document.forms[0].lat0.value = map.getBounds().getSouthWest().lat();
      document.forms[0].lon0.value = map.getBounds().getSouthWest().lng();
      document.forms[0].lat1.value = map.getBounds().getNorthEast().lat();
      document.forms[0].lon1.value = map.getBounds().getNorthEast().lng();

      get_pictures();

    }

    function onMapMove() {
      //map.setCenter(map.getCenter());
      updateStatus();
    }

    function onMapZoom(oldZoom, newZoom) {
      //map.setCenter(map.getCenter(),newZoom)
      updateStatus();
    }

    function load() {
      if (GBrowserIsCompatible()) {
        var map = new GMap2(document.getElementById("map"));
        window.map = map
        map.setCenter(new GLatLng(41.879786443521795,12.427597045898438), 6);
        map.addControl(new GSmallMapControl());
        map.addControl(new GMapTypeControl());
        window.kh = new GKeyboardHandler(map);

        GEvent.addListener(map,'moveend',onMapMove);
        GEvent.addListener(map,'zoomend',onMapZoom);
        updateStatus();
      }
    }

    </script> 
```

新代码：

```
 <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key= (my api key)"
      type="text/javascript"></script>

       <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>

      <script type="text/javascript"
  src="https://maps.googleapis.com/maps/api/js?libraries=weather&sensor=true">
</script>

    <script type="text/javascript">

    function updateStatus() {
      var div = document.getElementById('mapinfo');
      div.innerHTML = map.getBounds();

      document.forms[0].lat0.value = map.getBounds().getSouthWest().lat();
      document.forms[0].lon0.value = map.getBounds().getSouthWest().lng();
      document.forms[0].lat1.value = map.getBounds().getNorthEast().lat();
      document.forms[0].lon1.value = map.getBounds().getNorthEast().lng();

      get_pictures();

    }

    function onMapMove() {
      //map.setCenter(map.getCenter());
      updateStatus();
    }

    function onMapZoom(oldZoom, newZoom) {
      //map.setCenter(map.getCenter(),newZoom)
      updateStatus();
    }

    function load() {
      if (GBrowserIsCompatible()) {

        var mapOptions = {
        zoom: 6,
        center: new google.maps.LatLng(41.879786443521795,12.427597045898438),
        mapTypeId: google.maps.MapTypeId.ROADMAP
        };

        var map = new google.maps.Map(document.getElementById("map_canvas"),
        mapOptions);

        var weatherLayer = new google.maps.weather.WeatherLayer({
        temperatureUnits: google.maps.weather.TemperatureUnit.CELSIUS
        });
        weatherLayer.setMap(map);

        var cloudLayer = new google.maps.weather.CloudLayer();
        cloudLayer.setMap(map);

        updateStatus();
      }
    }

    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:44:12.633

目前地图只能在初始化内部访问，使其全局可访问：

```
window.map = new google.maps.Map(/*.....*/); 
```

此外：getBounds() 无法在地图加载完成之前返回结果（地图异步加载，因此您不能立即调用 updateStatus()）。

您可能会观察到 tilesloaded-event：

```
google.maps.event.addListenerOnce(map,'tilesloaded',updateStatus); 
```

但是您似乎还想观察缩放和平移，您可以一次观察所有内容：

```
google.maps.event.addListener(map,'bounds_changed',updateStatus); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:45:06.093

`getBounds()`您没有从调用中返回任何内容的原因是因为您的`map`变量不在全局范围内。尝试在你的函数之外声明你的变量，它应该可以工作 - 因为你的声明`map`没有错。`getBounds()`

所以像...

```
var map;    //declaring map variable globally

function updateStatus() {
//code..  
}

function onMapMove() {
//code..  
}

function onMapZoom(oldZoom, newZoom) {
//code..
}

function load() {

    //using the global variable
    map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T22:46:46.187

*   v3 不包括 GBrowserIsCompatible。
*   除非您知道自己在做什么，否则不应在同一页面上包含 API 的两个版本。
*   在 bounds_changed 事件触发之前，map.getBounds() 不会返回有效值。您可能希望在 bounds_changed 的​​事件侦听器中运行 updateStatus 函数。

    google.maps.event.addListener(map, 'bounds_changed', updateStatus });

# objective-c - ARC 会处理这种情况而不会泄漏吗？如果是这样，怎么做？

> ID：14429946
> 
> 赞同：4
> 
> 时间：2013-01-20T22:15:11.130
> 
> 标签：objective-c, cocoa

ARC 看起来非常好，但有一两个典型的命名约定/规则对我来说不清楚的极端情况。查看以下围绕 NSThread 的类别实现：

```
@interface NSThread (BlockAdditions)
- (void)performBlock:(dispatch_block_t)block;
@end

@implementation NSThread (BlockAdditions)
- (void)internal_performBlock:(dispatch_block_t)block
{
    block();
}

- (void)performBlock:(dispatch_block_t)block
{
    [self performSelector:@selector(internal_performBlock:)
                 onThread:self
               withObject:[block copy]
            waitUntilDone:NO];
} 
```

我的问题是：`block`打电话后会泄漏`-copy`吗？编译器如何知道何时释放块？Instruments 没有检测到泄漏，但这并不能说服我，鉴于我对 ARC 的了解，这种情况得到了正确处理。感谢您提供任何信息！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T22:44:50.567

这会在保留/释放中泄漏，但不应该在 ARC 中泄漏。

编译器看到`-copy`and 这意味着`-release`需要 a。如果您查看生成的程序集，那应该正是您所看到的。

（嗯，正是你在完成装配后所看到的，这并不简单。）

请注意，您可以通过仅编译`[block copy];`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T01:34:10.587

编译器看到它`block`被复制到方法中`performBlock:`。这会在方法中创建一个新对象，并且在方法中创建的每个对象都必须在方法返回之前释放，除非返回此对象，在这种情况下它必须自动释放，因为一旦方法返回，编译器就不会引用变量在该方法中不再存在，因此永远无法释放它。

所以你的方法大致翻译为

```
- (void)performBlock:(dispatch_block_t)block
{
    dispatch_block_t blockCopy;

    blockCopy = [block copy];
    [self performSelector:@selector(internal_performBlock:)
                 onThread:self
               withObject:blockCopy
            waitUntilDone:NO];

    // If method returns, how shall the compiler access blockCopy any longer?
    // It can't! And since blockCopy is not returned by the method, it must
    // be destroyed before the method returns.
    [blockCopy release];
} 
```

您可能想知道，为什么这段代码不会崩溃，不会`blockCopy`被释放？不，因为`performSelector:onThread:withObject:waitUntilDone:`保留您作为`withObject:`参数传递给它的对象，直到它执行选择器回调，之后它再次释放该对象。所以当`release`在 结束时被调用时`performBlock:`，`blockCopy`有一个`retainCount`2 并且这个释放将它减少到 1，但不是 0，因此它不会被释放。只有在您的选择器在另一个线程上被调用后，`blockCopy`才会再次释放，并且由于您调用的选择器没有保留它，它最终会被释放。

# jquery - jquery 不能使用更新面板

> ID：14429950
> 
> 赞同：0
> 
> 时间：2013-01-20T22:15:29.380
> 
> 标签：jquery, updatepanel

我有以下标记；

```
 <fieldset style="width:40%;">
    <legend> Site User Role Management</legend>
    <asp:Label ID="lblSiteUserDDl" runat="server" AssociatedControlID="ddlSiteUsers"
         Text="Manage the roles in which a user is registered by selecting the user from the dropdown list below."></asp:Label>
    <asp:DropDownList ID="ddlSiteUsers" runat="server" CssClass="dropdowns" AutoPostBack="True" />
    <br /><br />
    <fieldset id="rolemanagement" style="width:80%;" runat="server" >
        <legend></legend>
        <asp:UpdatePanel runat="server">
            <ContentTemplate>
                    <asp:Label ID="lblCurrentRole" runat="server"  CssClass="literaltext"></asp:Label><br />
                    <asp:Label ID="lblSiteUserRole" runat="server" CssClass="literaltext"></asp:Label><br />
                    <asp:DropDownList ID="ddlUserRoles" CssClass="dropdowns" runat="server"/><br />
            </ContentTemplate>
            <Triggers>
                <asp:AsyncPostBackTrigger ControlID="ddlSiteUsers" EventName="SelectedIndexChanged"/>
            </Triggers>
        </asp:UpdatePanel>
   </fieldset>
</fieldset> 
```

以及页面底部的以下脚本

```
 <script>
    $(document).ready(function() {
        $('#<%= ddlSiteUsers.ClientID%> ').change(function () {
            $(this).css({ 'color': 'black', 'font-size': '1.1em', 'font-weight': 'bold' });
            var selecteditem = $(this).children("option:selected").text();
            $('#<%= lblCurrentRole.ClientID%>').html("You selected the user: <span style='color:black;font-weight:bold;'>" + selecteditem + "</span>");
        });
    });
</script> 
```

问题是第一个标签确实会正确更改，但在更新面板返回页面时会被删除。我已经尝试了通过谷歌找到的所有各种解决方案，但似乎都没有奏效。现在，带有两个标签和下拉列表的字段集始终可见，最终一旦我正确显示标签，该字段集将被隐藏，直到上方的下拉选择更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:22:43.697

将`lblCurrentRole`更新面板移到外部或填充它的值服务器端。由于问题在于它正在被替换，因此您需要将其保留在被替换的容器之外或设置值服务器端，以便返回的 HTML 将其设置正确。

在服务器端使用一组跨度来更新标签的值。

```
 lblCurrentRole.Controls.Clear();

 var textSpan = new HtmlGenericControl("span");
 textSpan.InnerText = "You selected the user: ";
 lblCurrentRole.Controls.Add(textSpan);

 var userSpan = new HtmlGenericControl("span");
 userSpan.InnerText = ddlSiteUsers.SelectedValue;
 userSpan.Attributes.Add("class","selected-user");
 lblCurrentRole.Controls.Add(userSpan); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-20T13:46:54.077

请按照这个方法。这可能会对您有所帮助。

Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function (evt, args) { //在这里写你的jquery函数 });

# android - 在 Android 平板电脑上使用 PPP

> ID：14429952
> 
> 赞同：2
> 
> 时间：2013-01-20T22:15:39.387
> 
> 标签：android, protocols, ppp, pppd

我一直在寻找一种在android应用程序中使用点对点协议的方法，但没有成功。我首先检查了我的平板内核是否支持该模块，因此，在通过 USB 与我的 PC (adb) 连接后，我使用正确的参数执行了“pppd”。android内核确实识别了该命令，但显示了以下消息：

```
This system lacks kernel support for ppp 
```

所以我寻找点对点协议的 Java 实现，我很惊讶我找不到它（除了 TINI 上的实现）。我有两个问题：第一个是是否有任何方法可以在 android 上使用 ppp 守护程序而无需 root 或使用 NDK。第二个是该协议是否有 Java 实现。谢谢大家的帮助，我真的很需要。

# jquery - jQuery Validate 插件 addMethod - 如何创建数字表单验证器

> ID：14429955
> 
> 赞同：0
> 
> 时间：2013-01-20T22:16:11.790
> 
> 标签：jquery, jquery-validate

我正在尝试使用 addMethod 创建一个 jQuery 验证器。这对我来说都是新的，所以我正在慢慢学习。我有一个基于英国手机号码的验证器。这工作正常。

我想创建一个新的数字，并且只允许表格中接受一小部分数字。例如，数字 1 到 5 将被接受，但任何更低或更高的数字都不会被接受。

另外，可以只接受一个号码吗？即5。

非常感谢任何帮助。就像我说的，我是这种编码的新手，所以我仍在寻找自己的方式。我尝试了无数次搜索，但我无法回答我的问题。

```
jQuery.validator.addMethod('mobileUK', function(phone_number, element) {
return this.optional(element) || phone_number.length > 9 &&
phone_number.match(/^((0|\+44)7(5|6|7|8|9){1}\d{2}\s?\d{6})$/);
}, 'Please specify a valid mobile number'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:26:06.600

> **引用 OP**：“我想创建一个新的数字，并且只允许在表格中接受小范围的数字。例如数字 1 到 5 将被接受，但任何更低或更高的数字都不会被接受。 "

您不需要创建新方法。默认情况下，`.validate()`插件[已经可以做到这一点](http://docs.jquery.com/Plugins/Validation/Methods/range#range)。

```
$(document).ready(function() {
    $('#myform').validate({
        rules: {
            fieldname: {
               range: [1, 5]
            }
        },
        messages: { // optional custom message
            fieldname: {
               range: "enter between {0} and {1}"
            }
        }
    });
}); 
```

HTML：

```
<input type="text" name="field1" /> 
```

**工作演示：**

[http://jsfiddle.net/uLSPU/](http://jsfiddle.net/uLSPU/)

> **引用 OP：** “另外，可以只接受一个数字吗？即 5。”

是的... [http://jsfiddle.net/aTf32/](http://jsfiddle.net/aTf32/)

```
range: [5, 5] 
```

# php - 在已请求的页面中创建 xmlhttprequest

> ID：14429959
> 
> 赞同：0
> 
> 时间：2013-01-20T22:16:34.893
> 
> 标签：php, javascript, ajax, xmlhttprequest

首先很抱歉，如果这真的很难理解，但我解释起来很复杂。而且我对这个 Ajax 事情也很陌生。

假设我有 page1.php，其中有以下脚本：

```
function change(str) {

    if (str=="") {
        document.getElementById("servicetxt").innerHTML="";
        return;
    }
    if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function() {
        if (xmlhttp.readyState==4 && xmlhttp.status==200) {
                document.getElementById("servicetxt").innerHTML=xmlhttp.responseText;
            }
    }
    xmlhttp.open("GET","change.php?a="+str,true);
    xmlhttp.send(); 
} 
```

在 change.php 上，我正在制作一个文本字段，因此当您在 page1.php 上调用 change 函数时它会出现。但是，如果我想在用户输入此文本字段时发出新请求（这样的建议响应：[w3schools ajax](http://w3schools.com/php/php_ajax_php.asp)）怎么办？我尝试在 change.php 中执行以下操作：

```
<script type="text/javascript">
function gethint(str) {

        if (str=="") {
            document.getElementById("hint").innerHTML="";
            return;
        }
        if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState==4 && xmlhttp.status==200) {
                    document.getElementById("hint").innerHTML=xmlhttp.responseText;
                }
        }
        xmlhttp.open("GET","gethint.php?a="+str,true);
        xmlhttp.send();

}
</script>
<?
echo "<input type=\"text\" name=\"varenummer\" onkeyup=\"gethint(this.value)\">";
echo "<p>Suggestions: <span id=\"hint\"></span></p>"; 
?> 
```

但这不起作用。可能没有一个快速简单的答案，如果是这样的话，请你指导我一篇好的文章/教程，它可以教我如何解决这个难题:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T22:58:17.743

首先，没有理由（除非您打算稍后进行重大更改）通过 AJAX 调用获取文本字段。该字段和控制它的脚本应该是您的主要 page1.php 文件的一部分，但该字段本身应该隐藏，直到`change()`被调用，可能是通过单击页面上的按钮。

您可以通过添加属性“隐藏”并将其设置为 true 来隐藏该字段，然后添加样式“显示：无”以使其在浏览器中工作：

```
<input type="text" name="varenummer" onkeyup="gethint(this.value)" hidden=true style="display:none"/> 
```

然后，在`change()`：

```
document.getElementByName("varenummer").setAttribute("hidden","false");
document.getElementByName("varenummer").style.display = "inline"; 
```

`gethint()`这样，让脚本运行没有问题。请注意，我只是显示了您的输入字段的 HTML，而不是您的 php 脚本回显的引用字符串。

## 编辑

好吧，所以，自从我尝试在没有 jQuery 的情况下做 JS 以来已经有很长时间了，但我发现我使用[jsFiddle](http://jsfiddle.net/amullins/SRs8k/2/)做错了什么。没有`.getElementByName()`功能。有一个`getElementsByName()`（复数），但由于某种原因它不能正常工作。因此，我添加了一个`id`参数并将其设置为等于原始名称参数。现在我们可以使用`getElementById`它了，它按预期工作。

```
function change() {
  document.getElementById("varenummer").setAttribute("hidden","false");
  document.getElementById("hintP").setAttribute("hidden","false");
  document.getElementById("varenummer").style.display = "inline";
  document.getElementById("hintP").style.display = "block";
} 
```

请注意，我还在“建议”段落中添加了类似的钩子，因此它会在文本字段出现时出现。我认为您不需要对您的`gethint()`功能进行任何更改，但我无法从这里进行测试。

# performance - 编译不安全的 Haskell

> ID：14429966
> 
> 赞同：20
> 
> 时间：2013-01-20T22:17:27.140
> 
> 标签：performance, haskell, llvm, ghc

似乎 Haskell 试图成为一种安全的语言，并试图帮助程序员避免错误。例如，如果在外面， `pred`/`succ`会抛出错误，`div 1 0`也会抛出。这些安全的 Haskell 计算是什么，它们会导致什么开销？

是否可以关闭 GHC 的这种安全性，因为在无错误的程序中它们不应该是必需的？这能带来更好的速度性能吗？

对于 C 后端，有一个选项`-ffast-math`. LLVM 后端或 LLVM 是否有任何此类性能选项？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-20T22:43:00.130

*该基准在此答案的先前版本中确实存在严重缺陷。我道歉。*

## 问题和解决方案，如果我们不深入挖掘

事实上，`pred`,`succ`和其他函数在发生各种错误时引发异常，例如溢出和被零除。普通算术函数只是低级不安全函数的包装；例如，看一下 for 的`div`实现`Int32`：

```
div     x@(I32# x#) y@(I32# y#)
    | y == 0                     = divZeroError
    | x == minBound && y == (-1) = overflowError
    | otherwise                  = I32# (x# `divInt32#` y#) 
```

您可以注意到在执行实际除法之前有*两次检查！*

然而，这些还不是最糟糕的。我们对数组进行了边界范围检查——有时它会大大减慢代码的速度。传统上，这个特定问题是通过提供禁用检查的特殊函数变体来解决的（例如`unsafeAt`）。

[正如 Daniel Fischer在这里](http://www.haskell.org/pipermail/haskell-cafe/2011-November/096747.html)指出的那样，有*一个*解决方案可以让您使用单个编译指示禁用/启用检查。不幸的是，这很麻烦：您必须复制[GHC.Int 的源代码](http://hackage.haskell.org/packages/archive/base/4.2.0.1/doc/html/src/GHC-Int.html)并删除每个函数的检查。当然，GHC.Int 并不是此类函数的唯一来源。

如果您真的希望能够禁用检查​​，则必须：

1.  编写所有你将要使用的不安全函数。
2.  要么编写一个包含重写规则的文件（如 Daniel 的帖子中所述）并导入它，要么只执行`import Prelude hiding (succ, pred, div, ...)`and `import Unsafe (succ, pred, div, ...)`. 但是，后一种变体不允许在安全和不安全功能之间进行简单的切换。

## 问题的根源和真正解决方案的指针

假设有一个已知不为零的数字（因此不需要检查）。现在，*谁*知道它？要么给编译器，要么给你。在第一种情况下，我们当然可以期望编译器不执行任何检查。但在第二种情况下，我们的知识毫无用处——除非我们能以某种方式告诉编译器。所以，问题是：如何编码我们拥有的知识？这是一个众所周知的问题，有多种解决方案。显而易见的解决方案是让程序员显式地使用不安全函数（`unsafeRem`）。另一个解决方案是引入一些编译器魔法：

```
{-# ASSUME x/=0 #-}
gcd x y = ... 
```

但是我们函数式程序员有*类型*。而且我们习惯于使用类型对信息进行编码。[我们中的一些人](http://okmij.org/ftp/Haskell/PeanoArithm.lhs)很擅长。因此，最聪明的解决方案是引入一系列`Unsafe`类型，或者切换到依赖类型（即学习 Agda）。

有关更多信息，请阅读[非空列表](http://www.haskell.org/haskellwiki/Non-empty_list)。与性能相比，人们对安全性的关注更多，但问题是一样的。

## 还不错

让我们尝试衡量 safe 和 unafe 之间的区别`rem`：

```
{-# LANGUAGE MagicHash #-}

import GHC.Exts
import Criterion.Main

--assuming a >= b
--the type signatures are needed to prevent defaulting to Integer
safeGCD, unsafeGCD :: Int -> Int -> Int
safeGCD   a b = if b == 0 then a else safeGCD   b (rem a b)
unsafeGCD a b = if b == 0 then a else unsafeGCD b (unsafeRem a b)

{-# INLINE unsafeRem #-}
unsafeRem (I# a) (I# b) = I# (remInt# a b)

main = defaultMain [bench "safe"   $ whnf (safeGCD   12452650) 11090050,
                    bench "unsafe" $ whnf (unsafeGCD 12452650) 11090050] 
```

差异似乎不是那么大：

```
$ ghc -O2 ../bench/bench.hs && ../bench/bench

benchmarking unsafe
mean: 215.8124 ns, lb 212.4020 ns, ub 220.1521 ns, ci 0.950
std dev: 19.71321 ns, lb 16.04204 ns, ub 23.83883 ns, ci 0.950

benchmarking safe
mean: 250.8196 ns, lb 246.7827 ns, ub 256.1225 ns, ci 0.950
std dev: 23.44088 ns, lb 19.06654 ns, ub 28.23992 ns, ci 0.950 
```

## 了解你的敌人

澄清增加了哪些安全开销。

首先，如果一个安全措施会导致异常，你可以[在这里](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Exception.html)了解一下。有一个可以抛出的所有异常类型的列表。

**程序员引起的异常（没有人为的开销）：**

*   `ErrorCall`: 造成的`error`:
*   `AssertionFailed`: 造成的`assert`。

**标准库抛出的异常（重写库，安全开销消失了）：**

*   `ArithException`：除以零就是其中之一。还包括溢出/下溢和一些不太常见的。
*   `ArrayException`: 当索引超出范围或尝试引用不受限制的元素时发生。
*   `IOException`：不用担心，与 IO 开销相比，开销是惨淡的。

**运行时异常（由 GHC 引起，不可避免）：**

*   `AsyncException`: 堆栈和堆溢出。只有很小的开销。
*   `PatternMatchFail`: 没有开销（就像`else`in`if...then...else...`不创建任何开销一样）。
*   `Rec*Error`：当您尝试处理记录的不存在字段时发生。由于必须检查字段是否存在，因此会导致一些开销。
*   `NoMethodError`: 没有开销。
*   许多关于并发的异常（死锁等）：我不得不承认我对它们一无所知。

其次，如果存在不会导致异常的安全措施，我真的很想听听它（然后针对 GHC 提交错误）。

## 一句话

到目前为止，`-ffast-math`并没有影响任何检查（它们是在 Haskell 代码中完成的，而不是在 C 中）。它只是在某些边缘情况下以牺牲精度为代价使浮点运算更快。

# c# - 停止有两个会话的用户打开 asp.net Intranet 应用程序

> ID：14429968
> 
> 赞同：0
> 
> 时间：2013-01-20T22:17:43.940
> 
> 标签：c#, asp.net

我刚刚被分配了一项工作，以阻止内部 Web 应用程序的用户打开多个会话。今晚阅读这个主题，我发现这是一个相当有争议的问题，有些人说你不应该阻止用户这样做，而其他人则建议使用 GUI 的简单 JavaScript 方法。只是想知道当前对此主题的想法是什么，以及是否有人对如何实现这一点有任何其他想法。干杯

# ruby - Sinatra 不理解 config.ru 中的设置？

> ID：14429970
> 
> 赞同：2
> 
> 时间：2013-01-20T22:18:02.190
> 
> 标签：ruby, sinatra, rack

我正在尝试为 Sinatra 编写一个 config.ru 文件，其中每个环境都有一组数据库凭据：开发和生产。我正在执行以下操作：

应用程序.rb：

```
require 'sinatra'
require 'data_mapper'
require 'dm-mysql-adapter'

DataMapper.setup(:default, "mysql://#{settings.db_user}:#{settings.db_password}@#{settings.db_host}/#{settings.db_name}")

# ... the rest of the app 
```

配置.ru：

```
require 'sinatra'
require './app.rb' # the app itself

configure :development do
  set :db_name, 'thedatabase'
  set :db_user, 'root'
  set :db_password, ''
  set :db_server, 'localhost'
end

run Sinatra::Application 
```

但是当我尝试使用 启动应用程序时`ruby app.rb`，我得到“Sinatra::Application:Class (NoMethodError) 的未定义方法 'db_user'”。

一般来说，我只是想将所有这些设置卸载到他们自己的文件中。如果 config.ru 不适合他们，那么合适的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T22:27:52.673

看起来这可能是一个订购问题。如果那条`DataMapper.setup(...)`线真的在 的顶层`app.rb`，它会在你`require './app.rb'`, before`configure`运行后立即调用。

加载文件时最好不要做任何工作。改用某种形式的显式或延迟初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T08:27:05.223

我同意托马斯的观点。这有时也让我感到困惑，因此我想向您展示为什么会这样。以下是 Ruby 解释需求和类开放的方式。

```
#user.rb
class User
  def hello
    puts "hello"
  end
end

#config.ru
require 'user' # Here we include the original User class

class User # on this line we reopen the user class
  def goodbye # We add a new method to the user class
   puts "goodbye"
  end
end 
```

如果我们在 config.ru 中的用户之后的某个地方调用 user `require`，但在重新打开类之前，我们无法访问该`goodbye`方法。但是，在重新打开类定义并添加它之后，我们可以。这也是 Sinatra`set`方法的功能，也是为什么它只能在开放的 Sinatra 类中调用的原因。这就是为什么您有时还会看到不使用该方法的替代`set`方法。在您的 config.ru 中要求或包含 Sinatra 类中的内容将在您的 Sinatra 应用程序中广泛使用。

另一个导致问题的常见事情是 Sinatra 是基于 Rack 构建的，因此打开 Rack 类并在那里配置东西也可以使这些更改在 Sinatra 中可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-05T05:25:23.997

config.ru 只有在你使用 rakeup 启动你的应用程序时才会被使用。如果您使用 'ruby app.rb' 启动您的应用程序，则 config.ru 不会发挥作用。

# google-chrome - Chrome mediaelement.js 流和下载链接冲突

> ID：14429971
> 
> 赞同：0
> 
> 时间：2013-01-20T22:18:08.873
> 
> 标签：google-chrome, media-player, audio-streaming, mediaelement.js, mediaelement

我在获取音频流和下载链接（对于同一文件）以在 Chrome 的页面上播放时遇到问题。

[http://500mixes.com](http://500mixes.com)

对于每个音频文件，我都有一个单独的播放器和下载链接。播放器是 mediaelement.js。**问题**是单击下载按钮会停止流。但相反（下载，然后流）工作正常。

我知道一种解决方案是使用模式弹出窗口将下载链接拉出页面。但我希望找到一个内联解决方案。mediaelement.js 是否具有本机下载功能？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T22:30:33.793

我也遇到了同样的问题，下载链接显示但无法点击。只需在 URL 中添加 target="_blank" 即可使链接可点击并使文件可下载。谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T13:46:34.950

我还没有看过你的代码，所以这假设你没有做任何奇怪的事情......

如果您链接到下载，浏览器通常会开始关闭当前页面以转到下一页的过程。这是一个合理的优化，因为大多数链接都指向其他页面，而不是下载。

要解决此问题，请将下载链接的目标设置为`_blank`. 这将在新窗口中打开下载链接。请注意，同一页面上的简单模式对话框将不起作用。您必须将目标设置到其他位置。

或者，将隐藏添加`<iframe>`到您的页面并将这些下载链接的目标设置为它。

# c# - 受保护的连接字符串真的不可能有人读取吗？

> ID：14429973
> 
> 赞同：0
> 
> 时间：2013-01-20T22:18:15.873
> 
> 标签：c#, encryption, ftp, obfuscation, sensitive-data

我刚刚看到这篇文章[隐藏重要数据](https://stackoverflow.com/questions/10269735/hiding-important-data)

我正在考虑使用 app.config 来保护我的 FTP 连接字符串，如上面链接中所述，但我想知道是否真的不可能有人通过反编译或通过反编译或通过某种方式发现 ftp 连接字符串使用其他逆向工程工具

软件中包含的数据非常敏感，不应该与用户共享，有人可以帮我看看我的方法是否正确吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:32:06.393

如果您在 App.Config 中存储一个值，则该值不会被硬编码或存储在任何已编译的代码中 - 它是在运行时从您的配置文件中读取的。因此，它不能通过反编译*直接*检索，尽管您的应用程序总是有可能被重新编译以在解密后或类似的情况下吐出字符串。显然，任何有权访问您的应用程序服务器的人都可以轻松访问配置值，因为他们可以简单地读取您的 App.Config。也就是说，当然，除非它按照您所链接问题的答案中的建议进行了加密。

# vb.net - 如何检查是否按下了某个键，然后对该值执行某些操作？

> ID：14429974
> 
> 赞同：0
> 
> 时间：2013-01-20T22:18:20.507
> 
> 标签：vb.net, visual-studio-2010, keypress

我想检查是否在表单中按下了某个键，然后使用该键执行子程序。下面的代码仅在表单中没有其他控件时才有效。我应该怎么办？

```
Private Sub MainForm_KeyPress1(sender As Object, e As System.Windows.Forms.KeyPressEventArgs) Handles MyBase.KeyPress
    MsgBox(e.KeyChar)
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T22:24:02.780

您可以将`KeyPreview`表单的属性设置为`True`. 这样，您将捕获表单上的所有 KeyPress 事件（如果您没有设置to的`Handled`属性，这些事件随后将由发生按键的控件处理）。`KeyPressEventArgs``True`

> 当此属性设置为 true 时，表单将接收所有 KeyPress、KeyDown 和 KeyUp 事件。在窗体的事件处理程序完成对击键的处理之后，击键被分配给具有焦点的控件。例如，如果 KeyPreview 属性设置为 true，并且当前选定的控件是 TextBox，则在表单的事件处理程序处理击键后，TextBox 控件将接收被按下的键。要仅在窗体级别处理键盘事件并且不允许控件接收键盘事件，请将窗体的 KeyPress 事件处理程序中的 KeyPressEventArgs.Handled 属性设置为 true。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.keypreview.aspx)

# c++ - 用 C++ 写入 stderr 时调用函数？

> ID：14429979
> 
> 赞同：4
> 
> 时间：2013-01-20T22:18:56.950
> 
> 标签：c++, c++11, assert, stderr

有没有办法执行回调函数，或者在将数据写入标准流（例如`stderr`或）时调用预定义函数`stdout`？理想情况下，这可用于允许应用程序在其他流的情况下正常输出，并`printf`有条件地执行附加任务，例如依赖于当前设置的断言。当其他库输出到流时，这可能具有自动触发此错误处理代码的好处。`stdout``fprintf``FILE`

我知道输出到`stderr`并且`stdout`可以`FILE`使用`std::freopen`. 实现提供这种行为的备用`FILE`流是否可行，还是需要重新实现大量标准库函数？

符合标准的 C++ 建议（包括 C++11）将是首选，但如有必要，我会只接受 Windows 解决方案。

* * *

从那以后，我尝试按照 doomster 的建议实现[流缓冲区](https://stackoverflow.com/a/14429990/1995485)，并在James Kanze的[Filtering Streambufs](http://gabisoft.free.fr/articles/fltrsbf1.html)提供了一点帮助。除非出现任何其他建议，否则这似乎是您可以获得的最接近原始建议的方法。它不会拦截 C 风格的输出，我怀疑这是不可能或不切实际的，但它提供了我想要的所有功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-20T22:20:19.823

您可以替换流缓冲区以拦截这些流的任何输出，请参阅 rdbuf() 函数。我想你只需要在streambuffer类中实现overflow()函数。

# android - 将 csv 文件作为附件发送

> ID：14429981
> 
> 赞同：0
> 
> 时间：2013-01-20T22:19:07.103
> 
> 标签：android, android-intent, email-attachments

我尝试了以下发送带有附件的电子邮件的代码。它在尝试发送时确实显示附件，但问题是它只发送带有主题和正文但没有附件的电子邮件。我会感谢你的帮助

```
 emailButton = (Button) findViewById(R.id.emailButton);

 textTo = (EditText) findViewById(R.id.txtenterserial);
 textSubject = (EditText) findViewById(R.id.txtenterseri);
 textMessage = (EditText) findViewById(R.id.txtenters);

 emailButton.setOnClickListener(new OnClickListener() {

     @Override
     public void onClick(View v) {

         String to = textTo.getText().toString();
         String subject = textSubject.getText().toString();
         String message = textMessage.getText().toString();

         Intent i = new Intent(Intent.ACTION_SEND);
         i.setType("text/plain");
         File data = null;
         try {
             Date dateVal = new Date();
             String filename = dateVal.toString();
             data = File.createTempFile("Report", ".csv");
             Log.d("vvvvvv", data.toString());
              FileWriter out = (FileWriter) GenerateCsv.generateCsvFile(data, "Name,Data1");
             //Log.d("SSSSHOOOOW", out.toString());
             i.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(data));
             i.putExtra(Intent.EXTRA_EMAIL, new String[] { to });
             i.putExtra(Intent.EXTRA_SUBJECT, subject);
             i.putExtra(Intent.EXTRA_TEXT, message);
             startActivity(Intent.createChooser(i, "E-mail"));
          } catch (IOException e) {
                e.printStackTrace();
          }
     }
 });

 public static  class GenerateCsv {
     public static  FileWriter generateCsvFile(File sFileName,String fileContent) {

         FileWriter writer = null;

         try {
             writer = new FileWriter(sFileName);
             writer.append(fileContent);
             writer.flush();

         } catch (IOException e) {
             // TODO Auto-generated catch block
             e.printStackTrace();
         } finally {
              try {
                  writer.close();
              } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
              }
          }
          return writer;
     }
 } 
```

这是 LogCat

```
01-20 22:07:26.998: E/Trace(8471): error opening trace file: No such file or directory (2)
01-20 22:07:27.929: D/gralloc_goldfish(8471): Emulator without GPU emulation detected.
01-20 22:07:46.538: D/vvvvvv(8471): /data/data/com.example.emailandroid/cache/Report1916903470.csv
01-20 22:07:46.998: D/dalvikvm(8471): GC_CONCURRENT freed 201K, 5% free 4318K/4544K, paused 78ms+82ms, total 292ms
01-20 22:07:47.458: I/Choreographer(8471): Skipped 94 frames!  The application may be doing too much work on its main thread.
01-20 22:07:51.828: W/IInputConnectionWrapper(8471): showStatusIcon on inactive InputConnection
01-20 22:07:52.718: I/Choreographer(8471): Skipped 58 frames!  The application may be doing too much work on its main thread.
01-20 22:09:40.928: I/Choreographer(8471): Skipped 33 frames!  The application may be doing too much work on its main thread. 
```

请告诉我我哪里出错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T14:03:48.360

这可能是因为您的 gmail 应用程序无权从您的私有数据文件夹中读取。尝试将文件存储在外部存储中。

# ruby-on-rails - 在购物车和订单之间建立关系

> ID：14429982
> 
> 赞同：0
> 
> 时间：2013-01-20T22:19:08.990
> 
> 标签：ruby-on-rails, ruby

我正在尝试将电子商务功能集成到我的 rails 应用程序中，但在创建新订单时遇到了麻烦。我从一个购物车开始，其中有_many 个订单，其中有_many 个交易。我的订单数据库中的第一个字段是 cart_id。我需要能够从 view/order/new.html.erb 访问购物车中的信息（例如 total_price）。

建立这种关系的最佳地点在哪里，如何建立？我可以通过会话 id 找到购物车，但我不知道如何建立关系。我在考虑订单模型，在新动作中，是这样的吗？

```
 def new
    @order = Order.new
    current_cart.@order.build 
```

在我的应用程序控制器中定义的是函数 current_cart

```
 def current_cart
    Cart.find(session[:cart_id])
  rescue ActiveRecord::RecordNotFound
    cart = Cart.create
    session[:cart_id] = cart.id
    cart
  end 
```

更新

这是我的新功能和创建功能，我需要该值

```
 def new
    @order = Order.new
    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @order }
    end
  end

  # POST /orders
  # POST /orders.json
  def create
    @order = Order.new(params[:order])

       # THIS IS WHERE I HAVE TRIED TO BUILD THE RELATIONSHIP
       # I have tried current_cart.orders.build, @order.cart = current_cart, and 
       # @order = current_cart.build_order(params[:order])

    @order.ip_address = request.remote_ip
    if @order.save
      if @order.purchase
        render :action => "success"
      else
        render :action => "failure"
      end
    else
      render :action => 'new'
    end
  end 
```

这是我需要访问模型中的购​​物车的地方

```
 def price_in_cents
    (cart.total_price*100).round
  end 
```

而且我总是会为未定义的函数捕获异常，无论是构建函数还是总价格函数

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T23:03:10.203

在 Order 模型中，您有 cart_id，因此在此处定义关系：

```
belongs_to :cart 
```

您还可以在 Cart 模型中定义关系，另外：

```
has_many :orders 
```

之后，您可以简单地将新订单添加到您当前的购物篮中：

```
@order = Order.new
@order.cart = current_cart 
```

编辑：

current_cart 方法可能还有其他问题。

尝试：

```
@order.cart_id = session[:cart_id] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T07:14:54.907

我为此制作了一个视频： [http ://www.ror-e.com/info/videos/6](http://www.ror-e.com/info/videos/6)

我实际上将购物车与订单分开。所以基本上购物车 has_many cart_item 和订单 has_many order_items。我很乐意提供更多帮助。请随时直接与我联系。我很想讨论不同方法的优缺点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-15T21:14:28.613

在您的创建操作中：

```
@order = current_cart.build_order(order_params) 
```

并添加强大的参数：

```
 private

  def order_params
    params.require(:order).permit(:first_name, :last_name, :card_type, :card_expires_on)
  end 
```

# python - Mathematica 到 Python/C 代码

> ID：14429984
> 
> 赞同：0
> 
> 时间：2013-01-20T22:19:12.393
> 
> 标签：python, c, wolfram-mathematica

我试图理解 Mathematica 中的一些代码，但不熟悉它的语法。我似乎无法理解这里的逻辑。

```
anamorph3[img_, angle_: 270 Degree, imgWidth_: 512] :=
Module[{data, f, matrix, dim, rOuter, rInner = 1.},
dim = ImageDimensions[img];
rOuter = rInner (1 + angle #2/#1 & @@ dim);
data = Table[
ListInterpolation[#[[All, All, i]], 
{{rOuter, rInner}, {-angle/2, angle/2}}], {i, 3}] &@ImageData[img];
f[i_, j_] := If[Abs[j] <= angle/2 && rInner <= i <= rOuter, 
Through[data[i, j]], {1., 1., 1.}];
Image@Table[f[Sqrt[i^2 + j^2], ArcTan[i, -j]], 
{i, -rOuter, rOuter, 2 rOuter/(imgWidth - 1)},
{j, -rOuter, rOuter, 2 rOuter/(imgWidth - 1)}]] 
```

可以在此处找到有关此代码的更多详细信息

[如何使 ImageTransformation 生成图像的变形版本](https://stackoverflow.com/questions/8235517/how-to-make-imagetransformation-produce-an-anamorphic-version-of-image)。

如果有人可以为此编写伪代码/ python 代码，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T23:56:53.990

我想它最终会是这样的：

```
def anamorph3(img, angle = math.radians(270), imgWidth = 512):
    rInner = 1.
    dim = ImageDimensions(img)
    rOuter = rInner * (1 + angle * dim[2]/dim[1])
    data = list()
    for i in range(3):
        channelData = [[x[i] for x in v] for v in ImageData(img)]
        data.append(ListInterpolate(channelData, [[rOuter, rInner],[-angle/2,angle/2]]))
    def f(i, j):
        if abs(j) <= angle/2 && rInner <= i <= rOuter:
            l = list()
            for fun in data:
                l.append(fun(i, j))
            return l
        else:
            return [1, 1, 1]
    newImageData = list()
    for i in range(-rOuter, rOuter, 2*rOuter/(imgWidth-1)):
        l = list()
        for j in range(-rOuter, rOuter, 2*rOuter/(imgWidth-1)):
            l.append(f(math.sqrt(i**2 + j**2), math.atan(i, -j)))
        newImageData.append(l)
    return Image(newImageData) 
```

这里`ImageDimensions`返回图像的尺寸，`ImageData`返回一个 3D 矩阵，其中每个像素的每个颜色通道的颜色数据归一化到范围 0-1，并`ListInterpolate`创建一个在指定 x 和 y 坐标范围内的一组数字之间进行插值的函数. `Image`采用 3D 矩阵并将其转换为 RGB 图像。

# css - Windows 上 Chrome 中的日期输入宽度

> ID：14429985
> 
> 赞同：0
> 
> 时间：2013-01-20T22:19:16.047
> 
> 标签：css, windows, google-chrome, windows-7, windows-xp

这个小提琴显示了我的问题：http: [//jsfiddle.net/jmTqk/2/](http://jsfiddle.net/jmTqk/2/)。蓝色块遮挡了旋转按钮和日期选择器下拉链接。但我认为你需要在 Windows Chrome 上才能看到它。这是一个没有蓝色块的版本[http://jsfiddle.net/jmTqk/1/](http://jsfiddle.net/jmTqk/1/)

这个 HTML

```
<input id='date1'   type="date" />  
<div id='abcd'>blue block</div> 
```

这个CSS

```
 #date1 {
    width:6em;
    border: 1px solid red;
  }
  #abcd {
    background-color:blue;
    height:150px;
    width:150px;
    display:inline-block;
  } 
```

如果您将输入的宽度更改为 11em 它适合。

在 Ubuntu Chrome 上，css 将日历下拉按钮限制在日期输入字段的内部。在 Windows（XP，7）上它没有。有没有办法让旋转按钮和下拉菜单尊重 Windows 上日期输入的范围并适合红框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:33:31.957

这是一个 chrome 错误，您可以在此处阅读：

[https://code.google.com/p/chromium/issues/detail?id=172029](https://code.google.com/p/chromium/issues/detail?id=172029)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-04T09:43:27.683

我通过禁用 Chrome 日期选择器控件来修复。这适合你吗？

```
input[type=date]::-webkit-inner-spin-button, 
input[type=date]::-webkit-outer-spin-button,
input[type="date"]::-webkit-calendar-picker-indicator { 
    display:none;
    -webkit-appearance: none;
    margin: 0;
} 
```

[jsFiddle 演示](http://jsfiddle.net/jmTqk/12/)

# batch-file - 在 CMD 批处理中使用默认值

> ID：14429986
> 
> 赞同：1
> 
> 时间：2013-01-20T22:19:20.197
> 
> 标签：batch-file, cmd

有人可以帮我处理我的批次吗？我试图在我的批次开始时逃脱，但它不起作用。我敢肯定这很简单，但我不是这种编程的普通用户。

```
cls
@echo off
set usr_out=y
set /p usr_out=Press [N] to cancel:

if NOT %usr_out% == Y goto myend
if NOT %usr_out% == y goto myend

echo in

pause
exit

:myend
echo out
pause 
```

**编辑：**对不起，我忘了详细说明上面的代码只有`echo out`在我不输入值时才会进入该行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-20T23:24:12.760

您将默认值设置`%usr_out%`为**小写** `y`：

```
set usr_out=y 
```

但然后检查变量是否**不**等于**大写** `Y`：

```
if NOT %usr_out% == Y goto myend 
```

由于`y`并且`Y`确实不相等，因此您的脚本会正确跳转到`:myend`此时。

你需要在这里修正你的逻辑。如果您想在不满足所有给定数量的条件时跳过代码块，则必须批量使用类似的东西：

```
if "%usr_out%"=="y" goto continue
if "%usr_out%"=="Y" goto continue
goto myend
:continue 
```

但是，在您的特定情况下，您可以使用更简单的方法，因为您只需要对一个字母进行不区分大小写的检查：

```
if /i not "%usr_out%"=="y" goto myend 
```

* * *

在不同的说明：而不是平原`exit`，我建议使用`goto :eof`（跳转到脚本的末尾）或`exit /b`（退出批处理脚本而不终止`cmd.exe`）。否则，在命令提示符下手动运行脚本可能会无意中终止命令提示符窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-25T12:53:23.620

简单的问题是您在“==”和其他命令或单词之间使用空格，例如：

```
if NOT %usr_out% == Y goto myend 
```

但你必须使用这个：

```
if NOT %usr_out%==Y goto myend 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-08T17:22:04.407

To the second half of your question:

> when I don't enter a value

You can add this check:

```
set /p usr_out=Press [N] to cancel:
if "x"=="x%usr_out%" set usr_out=y 
```

This checks whether the variable has no value, or the empty string as a value.

# c++ - C++ 编译器可以为 const 返回值执行 RVO 吗？

> ID：14429988
> 
> 赞同：11
> 
> 时间：2013-01-20T22:20:06.950
> 
> 标签：c++, return-value-optimization, nrvo

假设我有这个功能

```
#include <string>

std::string const foo()
{
    std::string s = "bar";
    return s;
}

int main()
{
    std::string t = foo();
} 
```

编译器能否为 执行（命名）返回值优化`t`，即使`s`和的类型由于-ness 差异而`t`与 的返回类型不同？`foo``const`

（如果 C++03 和 C++11 的答案不同，那么我肯定有兴趣知道 C++03 的答案。）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-20T22:24:34.597

RVO 优化无法打破 a 的承诺`const`，所以没有问题：可以执行 RVO。

* * *

但是，*移动语义*受`const`. 它有效地禁用了移动语义，即调用`T(T&&)`构造函数或移动赋值运算符。所以一般来说，不要`const`在返回值上使用。

Scott Meyers 最初建议`const`使用返回值，以获得更理智的编码。

然后 Andrei Alexandrescu 在他[为 DDJ 撰写的 Mojo 文章中](https://www.drdobbs.com/move-constructors/184403855)指出，从今以后，使用移动语义，`const`最好禁止返回值，并且忽略 Scott 之前的建议。

* * *

现在我从不费心去学习各种专门的 RVO 首字母缩略词，比如 NRVO 等等。一个主要原因是这些在中途*改变了含义，最初在 g++ 编译器中具有一些自定义功能的含义。*这里的术语只是一团糟。

所以，如果我的术语有误，我真的应该使用其他首字母缩写词，那么请随时纠正！:-)

# java - 解析文件输入中的数字

> ID：14429989
> 
> 赞同：1
> 
> 时间：2013-01-20T22:20:13.497
> 
> 标签：java, file, input

我正在使用 Scanner 方法来尝试获取文件输入。问题是我只得到名字和姓氏之后的第一个 int。这是文本文件：

```
John Doe 12 6 8 15 35 16 17 4 12 54
Mark Doe 16 67 8 12 35 19 78 3 12 101
Johnnie Smarts 20 10 10 20 40 100 20 10 20 100
Frank Noshow
Molly Guess 2 5 6 7 2 4 7 8 9 10 
```

到目前为止，我已经完成了这么多代码：

```
import java.io.*;
import java.util.*;
import static java.lang.Math.*; 
import static java.lang.System.out;

public class StudentTester
{
    public static void main ( String[] args ) throws IOException
    {
        Scanner kb = new Scanner(System.in);
        System.out.println("\tWelcome.. " );
        System.out.println(" Please enter the file name. " );
        String filename = kb.nextLine();
        Scanner fileReader = new Scanner(new File(filename));
        //created a scanner object with a file object.
        //Creat a String array to hold each lince of the file. 
        String [] s = new String [10000]; //prepared for a 100 lines of text.
        int linesOfText = -1;
        int score[] = new int[10];
        while (fileReader.hasNextLine())//while the file has any lines.
        {
            linesOfText++;

            s[linesOfText] = fileReader.nextLine();
            //This places the first line of the file in the s array.
            //System.out.println(s[linesOfText]);//for testing purposes..
        }
        fileReader.close();//close the Scanner.

        for(int i=0;i<=linesOfText;i++){
            Scanner sc = new Scanner(s[i]);
            String fN = sc.next();
            String lN = sc.next();

            if(sc.hasNext()){
                score[i] = sc.nextInt();                 
            }
            else {
                System.out.println(" opps, there is no score here... ");
            }
            Student stu = new Student(fN,lN,score);
            System.out.println(score[i]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T08:05:50.170

```
I think the following code can help you for your request :

package com.mongolhun.tech.basic.miscellaneous;
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class StudentTester
{
    public static void main ( String[] args ) throws IOException
    {
        Scanner kb = new Scanner(System.in);
        System.out.println("/tWelcome.. " );
        System.out.println(" Please enter the file name. " );
        String filename = kb.nextLine();
        Scanner fileReader = new Scanner(new File("D:/workspace/test/src/test/java/com/yxyy/tech/basic/miscellaneous/" +filename));
        //created a scanner object with a file object.
        //Creat a String array to hold each lince of the file. 
        String [] s = new String [10000]; //prepared for a 100 lines of text.
        int linesOfText = -1;
        int score[] = new int[10];
        while (fileReader.hasNextLine())//while the file has any lines.
        {
            linesOfText++;

            s[linesOfText] = fileReader.nextLine();
            //This places the first line of the file in the s array.
            //System.out.println(s[linesOfText]);//for testing purposes..
        }
        fileReader.close();//close the Scanner.

        for(int i=0;i<=linesOfText;i++){
            Scanner sc = new Scanner(s[i]);
            String fN = sc.next();
            String lN = sc.next();
            int a = 0;
            while(sc.hasNext()){
                score[i] = sc.nextInt();    
                System.out.print(score[i] + " ");
                a = 1;
            }

            if (a == 0) {
                System.out.print("opps, there is no score here... ");
            }
            System.out.println();
//            Student stu = new Student(fN,lN,score);

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T22:24:38.723

那是因为您先执行 a `next()`，`next()`然后执行 a `nextInt()`。

只需更换

```
if (sc.hasNext()) {...} 
```

和

```
while (sc.hasNext()) {...} 
```

# python - 我可以重命名 numpy 记录数组中的字段吗

> ID：14429992
> 
> 赞同：9
> 
> 时间：2013-01-20T22:20:20.300
> 
> 标签：python, numpy, matplotlib

我是 python 新手，所以这听起来很基础。我已经使用 csv2rec 导入了一个 csv 文件。第一行有标题。我想将标题更改为“x”、“y”、“z”。这样做的最佳方法是什么？

```
>>> import matplotlib
>>> import matplotlib.mlab as mlab
>>> r= mlab.csv2rec('HeightWeight.csv', delimiter= ',')
>>> names= r.dtype.names
>>> for i in names:
     print i

index
heightinches
weightpounds 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-20T22:23:15.233

您可以简单地分配给`.dtype.names`：

```
>>> d = np.array([(1.0, 2), (3.0, 4)], dtype=[('a', float), ('b', int)])
>>> d
array([(1.0, 2), (3.0, 4)], 
      dtype=[('a', '<f8'), ('b', '<i8')])
>>> d['a']
array([ 1.,  3.])
>>> d.dtype.names
('a', 'b')
>>> d.dtype.names = 'x', 'y'
>>> d
array([(1.0, 2), (3.0, 4)], 
      dtype=[('x', '<f8'), ('y', '<i8')])
>>> d['x']
array([ 1.,  3.]) 
```

同样的方式`recarray`：

```
>>> d
rec.array([(1.0, 2), (3.0, 4)], 
      dtype=[('a', '<f8'), ('b', '<i8')])
>>> d.dtype.names = 'apple', 'pear'
>>> d
rec.array([(1.0, 2), (3.0, 4)], 
      dtype=[('apple', '<f8'), ('pear', '<i8')]) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-01-25T10:56:59.113

为此目的有一种`rename_fields`方法。`numpy.lib.recfunctions`它也适用于掩码数组。

```
import numpy as np
import numpy.lib.recfunctions as rfn

ab = np.ma.zeros(3, dtype=[('a', 'f4'), ('b', 'i4')])
xy = rfn.rename_fields(ab, {'a': 'x', 'b': 'y'})

print(ab.dtype, ab.mask.dtype)
print(xy.dtype, xy.mask.dtype) 
```

输出：

```
[('a', '<f4'), ('b', '<i4')] [('a', '?'), ('b', '?')]
[('x', '<f4'), ('y', '<i4')] [('x', '?'), ('y', '?')] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T22:28:46.150

[mlab.csv2rec](http://matplotlib.org/api/mlab_api.html#matplotlib.mlab.csv2rec)有一个`names`参数，您可以使用它来设置列名：

```
r= mlab.csv2rec('HeightWeight.csv', delimiter= ',', 
                 names=['apple', 'pear'], 
                 skiprows=1) 
```

当`names`is not`None`时，`csv2rec`假定没有标题行。所以使用`skiprows=1`忽略标题行。

# sql - "user_role" 或 "role_user" - 命名连接表

> ID：14429995
> 
> 赞同：1
> 
> 时间：2013-01-20T22:20:35.620
> 
> 标签：sql, naming-conventions

通常，连接（多对多）表以它们连接的类型命名 - 如果一个表连接`users`到`roles`，它的名称将同时包含`user`和`role`（即`user_role`）。

是否有一个命名约定来定义哪个单词/类型应该放在第一位？

* * *

编辑：有一个约定意味着知道名字而不必记住它。请在投票结束这个不具建设性的问题之前尝试理解这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T22:33:16.593

在 1:n 中，它是 user_role。

在 m:n 中，我会先使用更重要的一个，在这种情况下，更强的术语是用户恕我直言，因为您通常将角色分配给用户，反之亦然。

没有用户，角色没有意义，但没有角色，用户才有意义。

# javascript - js模式问题

> ID：14429997
> 
> 赞同：1
> 
> 时间：2013-01-20T22:20:42.183
> 
> 标签：javascript, oop, design-patterns, functional-programming

我对正在阅读的 javascript 设计模式感到困惑：

```
var class = (function() {

  ...a bunch of code...

  return {

  .. some more code..

  ;

  // or, in some cases

  return function(constructorArgs) {

  };

})(); 
```

我的问题是：return 语句在做什么？为什么会在那里？我很困惑，因为没有人愿意提及或谈论它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T22:35:23.063

我认为你提到了两种不同的模式。

### 匿名闭包

第一种是使用匿名函数来包装代码块以创建[闭包](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)：

```
var outer = (function() {
  var inner = "now you see me!";

  return inner + " now you don't"
})() 
```

匿名函数为`var`-defined 变量创建了一个新范围。实际上，这允许您定义仅在该特定函数中可见的变量。

在上面的示例中，您可以`inner`在函数内部访问，但在函数外部没有定义。

### “课堂”

第二种是在 JavaScript 中定义“类”的常见模式：

```
var MyClass = (function() {
  function MyClass(arg) {
    this.arg = arg
  }

  return MyClass
})() 
```

通过在闭包中定义构造函数，您可以确保您的类被很好地包含。它还使您能够共享类范围的状态或私有帮助方法，而不会污染全局命名空间，或者将它们作为属性放置在类构造函数的原型上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-20T22:32:12.990

符号右边的`=`代码是这种形式：`(function(){})()`; 它的作用是编译一个函数 - 实际上与以下内容相同：

```
function temp() {
}

class = temp(); 
```

但是，在您的示例中的函数内部，会返回另一个函数。这意味着它`class`现在也是一个函数 -由于[vtortola](https://stackoverflow.com/users/307976/vtortola)引用的闭包效应，`class`该函数可以引用函数中声明的所有变量等。`temp`

这样做的想法是允许内部函数引用一些您不希望在“全局”（或半全局）范围内徘徊的状态 - 调用方法的位置无关紧要`class`，或者谁，它将*始终*可以访问该数据。

编辑：从代码中可以看出，在这种情况下，模式的目的是创建一个“类”类型的函数——这样你就可以使用以下代码调用它：

```
var myInstance = new class(); 
```

虽然我感觉没有任何代码可以工作，因为我有理由确定这`class`是一个保留字......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-20T22:36:28.020

这称为闭包。

```
var myVar = (function (param1, param2){
    //do things
}('myParam1','myParam2')): 
```

javascript 引擎将立即执行括号之间的内容。

的值`myVar`将是函数`function (param1, param2){ ... }`返回的值。

该函数将`('myParam1','myParam2')`用作参数。

您可以通过两种不同的方式编写闭包：

```
(function (receivedArgs){
  //do things
})(yourArguments); 
```

或者

```
(function (receivedArgs){
   //do things
}(yourArguments)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-20T22:28:28.300

这是一个封闭。一个函数返回一个在中间包含一些变量的内部函数。

[https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures)

干杯。

# java - 如何使用 Java netty 正确限制带宽使用？

> ID：14429998
> 
> 赞同：7
> 
> 时间：2013-01-20T22:20:49.463
> 
> 标签：java, netty, trafficshaping

对于我使用 netty nio lib 在 Java 中开发的下载客户端，我还实现了带宽限制功能。从技术上讲，我是通过 GlobalTrafficShapingHandler 对象来实现的。基于这个类的JavaDoc，我初始化nio客户端管道如下：

```
...
trafficHandler = new GlobalTrafficShapingHandler(
        new HashedWheelTimer(), 0, 0, 1000);
execHandler = new ExecutionHandler(
        new OrderedMemoryAwareThreadPoolExecutor(20, 0, 0));
...

public ChannelPipeline getPipeline() throws Exception
{
    // create default pipeline
    ChannelPipeline pipeline = pipeline(); 

    // traffic shaping handler
    pipeline.addLast("global-traffic-shaping", trafficHandler);

    // SSL support
    if(useSSL)
    {
        SSLEngine sslEngine = createSSLEngine();
        pipeline.addLast("ssl", new SslHandler(sslEngine));
    }

    // memory executor
    pipeline.addLast("memory-executor", execHandler);

    // business logic
    pipeline.addLast("data-processing", 
        new NettyNioClientHandler(
            nettyNioClient, localer, logger, ncMgr, username, useSSL));

    return pipeline;
} 
```

然后在运行时设置最大值。下载速度通过

```
public void setDlSpeedLimit(long limit)
{
    if(limit < 0)
        return;

    trafficHandler.configure(0, limit * 1000L);
} 
```

好的，所以基本上 netty nio 功能运行良好且快速。当我设置最大值时。在应用程序中下载速度，我还可以看到带宽使用确实被限制在最大值。等级。我通过以下方式监控带宽使用情况

```
trafficHandler.getTrafficCounter().getLastReadThroughput(); 
```

然而，不幸的是最大。我监控的速度不是我之前设置的，甚至没有接近。例如，我最初（无限制）的下载速度约为 2000 kb/s，然后如上所述将限制设置为 300 kb/s，但实际下载速度在 700-900 kb/之间变化s。

所以我在这种情况下的问题是：我可以看到流量整形器正在做某事，但不是我想要的。我在这里错过了什么吗，例如管道初始化中的任何步骤？

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T20:34:06.030

好的，所以似乎没有其他想法。
唯一对我有所帮助的是将计时计数器增加到 5-10 秒。

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T23:08:49.870

每次请求新管道时，您`getPipeline()`都会实例化。`GlobalTrafficShapingHandler`您应该只实例化一个并在所有管道中重用它。这也适用于其他类，例如`HashedWheelTimer`.

Netty 有很多类必须在管道之间共享。通常文档清楚地提到了这一点。您应该检查每个类的 javadoc 并确保您遵循它们。